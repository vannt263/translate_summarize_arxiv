{
  "article_text": [
    "longitudinal space charge ( lsc ) driven microbunching instability @xcite in electron linacs with bunch compressors ( used as drivers of short wavelength fels ) was a subject of intense theoretical and experimental studies during the past years @xcite .",
    "such instability develops in infrared and visible wavelength ranges and can hamper electron beam diagnostics and free electron laser ( fel ) operation .",
    "it was proposed in @xcite to use this effect for generation of vacuum ultraviolet ( vuv ) and x - ray radiation .",
    "a concept of a longitudinal space charge amplifier ( lsca ) was introduced , scaling relations for an optimized lsca were obtained , and its possible applications were analyzed .",
    "it was pointed out , in particular , that a broadband nature of lsca supports generation of attosecond pulses .",
    "there are many different schemes for generation of attosecond x - ray pulses from free electron lasers ( fels ) @xcite .",
    "most of the proposed schemes make use of a short intense laser pulse to manipulate electron energy in a small slice of an electron bunch and to select only this short slice with the help of fel mechanism .    in ref .",
    "@xcite a scheme was suggested that uses the longitudinal space charge amplifier in combination with laser manipulation of the electron beam to produce attosecond soft x - ray pulses . in this paper",
    "we describe the operation of the lsca - based attosecond scheme in details , exemplify it with the parameters of the soft x - ray free electron laser facility flash @xcite , perform thorough numerical simulations , and discuss a possible implementation at flash making use of the existing infrastructure .",
    "the scheme ( see fig .  [ scheme ] ) of the longitudinal space charge amplifier ( lsca ) @xcite is simple both conceptually and technically .",
    "an amplification cascade consists of a focusing channel and a dispersive element ( usually a chicane ) with an optimized momentum compaction @xmath0 . in a channel the energy modulations",
    "are accumulated , that are proportional to density modulations and space charge impedance of the drift space . in the chicane",
    "these energy modulations are converted into induced density modulations that are much larger than initial ones @xcite , the ratio defines a gain per cascade . in this paper",
    "we will consider the case when the amplification starts up from the shot noise in the electron beam .",
    "a number of cascades is defined by the condition that the total gain , given by the product of partial gains in each cascade , is sufficient for saturation ( density modulation on the order of unity ) after the start up from shot noise .",
    "the amplified density modulation has a large relative bandwidth , typically in the range 50 - 100 % . behind the last cascade a radiator undulator",
    "is installed , which produces a powerful radiation with a relatively narrow line ( inverse number of periods ) within the central cone .",
    "this radiation is transversely coherent , and the longitudinal coherence length is given by the product of the number of undulator periods by the radiation wavelength .",
    "when lsca saturates in the last cascade , a typical enhancement of the radiation power over that of spontaneous emission is given by a number of electrons per wavelength .",
    "first few cascades of lsca ( as in fig .",
    "1 ) operate as described above .",
    "a broadband density modulation is amplified around the optimal wavelength    @xmath1    where @xmath2 is a transverse size of the beam , and @xmath3 is relativistic factor .",
    "such a choice of the wavelength is optimal because the lsc impedance reaches its maximum , and , at the same time , transverse correlations of the lsc field are on the order of the beam size @xcite , what guarantees a good transverse coherence of the radiation in the end .",
    "length of a drift space , beta - function , momentum compaction @xmath0 of a chicane are optimized for the chosen wavelength .",
    "the last cascade is modified as shown in fig .  2 .",
    "a short two - period modulator undulator is installed in front of the last chicane . in this undulator",
    "the electron beam is modulated in energy ( modulation wavelength is much longer than @xmath4 ) by a few - cycle powerful laser pulse in the same way as it is suggested for fel - based attosecond schemes @xcite , see fig .",
    "[ atto - mod ] as an example . a short slice in the electron bunch ( between 0 and 0.3 @xmath5 m in fig .  [ atto - mod ] )",
    "gets the strongest energy chirp , and is being strongly compressed ( by a factor @xmath6 ) in the following chicane .",
    "the @xmath0 of this chicane and the chirp are adjusted such that a required wavelength compression within that slice is achieved , and , at the same time the amplification of the microbunching within the slice through the last chicane is optimal ( parameters of the whole amplification chain are adjusted such that saturation is reached in the last chicane ) .",
    "other parts of the electron bunch are either uncompressed or have much weaker compression than a slice with the strongest energy chirp .    the chicane is followed by a short radiator undulator of which resonance wavelength , @xmath7 , corresponds to the ( broadband ) wavelength spectrum within the strongly compressed slice .",
    "then only this short slice of the electron bunch produces undulator radiation within the central cone ( which is selected by a pinhole downstream ) , while modulation wavelengths in the rest of the electron bunch are much longer than the resonance wavelength of the undulator . in other words ,",
    "the rest of the electron bunch produces only spontaneous emission within the central cone , and this emission would define the contrast of generated attosecond pulses .",
    "note that the last part of the scheme ( modulator undulator , chicane , and radiator undulator ) operates in a similar way as the last part of the attosecond scheme proposed in ref .",
    "the two schemes differ essentially by mechanisms of the generation of microbunching before wavelength compression .",
    "the authors of @xcite considered echo - enabled harmonic generation @xcite , while our scheme is based on the longitudinal space charge amplifier , described above .        finally , let us note that broadband nature of lsca makes wavelength compression especially attractive @xcite .",
    "indeed , the compression factor is given by the formula :    @xmath8    where @xmath9 is the linear energy chirp ( the derivative of relative energy deviation ) .",
    "for a large @xmath10 a variation of the compression factor reads :    @xmath11    after the compression the bands of density modulations and of the radiator must overlap .",
    "this leads to the following requirement on the compression stability :    @xmath12    where @xmath13 , and @xmath14 and @xmath15 are bandwidths of the density modulation and of the radiator , respectively .",
    "thus , the stability of the chirp must satisfy the requirement :    @xmath16    for coherent fel - type modulations and an undulator as a radiator @xmath17 what might set very tight tolerance for the chirp stability and limit practically achievable compression factors . for an lsca , however , @xmath18 , so that for a given chirp stability one can go for much stronger compression . alternatively , for a given compression factor one can significantly loosen the tolerances .",
    "note also that nonlinearities of the longitudinal phase space do not play a significant role in the case of lsca .",
    "we exemplify an operation of the attosecond scheme with the parameters of the soft x - ray fel facility flash @xcite . in the section 6",
    "we will discuss a possible technical implementation of this scheme making use of the existing infrastructure at flash .    concerning the choice of parameters of the electron beam , we rely on the results of beam dynamics simulations @xcite .",
    "for the case of the bunch charge 100 pc we reduce compression by a factor of two ( with respect to the scenario considered in @xcite ) , thus ending up with the slice parameters presented in table  1 .",
    ".electron beam parameters [ cols= \" <",
    ", < \" , ]     number of lsca cascades , their parameters , and the operating wavelength range are chosen with the help of the guidelines of ref .",
    "@xcite . as a focusing structure",
    "we choose fodo - lattice with the period 1.4 m and the average beta - function also 1.4 m ( even smaller beta - function would be preferable , but the technical feasibility and operational issues have to be taken into account ) . for electron beam parameters from table 1 ,",
    "we calculate from ( [ opt - wl ] ) that the optimal wavelength for amplification in lsca is around 40 nm .",
    "the length of a drift in each cascade is chosen to be 2.8 m , or two fodo periods .",
    "this length should provide a sufficient gain per cascade , it is smaller than a reduced wavelength of plasma oscillations , and the longitudinal velocity spread due to emittance does not play any role @xcite .",
    "the optimal @xmath0 of the chicane for a given energy spread and wavelength range is about 50 @xmath19 m .",
    "the chicane in each cascade should fit in a space between two quadrupoles .",
    "thus , the total length of a cascade is about 3.5 m ( or 2.5 fodo periods ) .    according to our estimates ,",
    "we need three regular cascades with the parameters , described above , and a last special cascade ( see fig .",
    "[ atto - scheme ] ) , so that a total length of the system is about 14 m. in the last cascade we have a drift of the same length ( 2.8 m ) , followed by a two - period undulator and a chicane with reduced @xmath0 .",
    "the undulator has a period length of 10 cm and a peak field of 1.4 t , so that a resonance of 1.2 gev beam with the laser beam ( wavelength is 800 nm ) is provided . in the last cascade a final amplification and , at the same time , a wavelength compression ( down to 4 - 5 nm ) in a short slice",
    "take place . to estimate the required energy chirp and the @xmath0 of the last chicane",
    ", we have to take the following considerations into account .",
    "the amplitude of density modulation at the compressed wavelength should not be strongly suppressed by the uncorrelated energy spread during compression . for a gaussian energy distribution",
    "an amplitude gain per cascade is given by @xcite :    @xmath20    here @xmath21 is the modulation wavenumber before compression , @xmath22 is the impedance of a drift space ( per unit length ) , @xmath23 is the free - space impedance , @xmath24 is the length of the drift space , @xmath25 is the beam current , @xmath26 is the alfven current , @xmath3 is relativistic factor , and @xmath27 is rms uncorrelated energy spread ( in units of rest energy ) . the beam current and energy spread are taken before compression .",
    "the optimal @xmath0 from ( [ gain - wake ] ) is given by @xmath28 , where @xmath29 is the modulation wavenumber after compression .",
    "then the required energy chirp can be defined from ( [ comp - fac ] ) :    @xmath30    if the electron beam is modulated by a laser with the wavelength @xmath31 , and the modulation amplitude is @xmath32 , then the chirp at zero crossing is @xmath33 .",
    "thus , with the help of ( [ chirp - req ] ) we get an estimate of a required amplitude of energy modulation :    @xmath34    if the compression factor is about 8 - 10 , @xmath35 nm , @xmath36 nm , then the required energy modulation amplitude is about 20 mev , and the corresponding @xmath0 is 6 - 7 @xmath5 m .",
    "we should note that formula ( [ gain - wake ] ) is valid for a linear regime of amplification , while we deal with a saturation in the last cascade .",
    "moreover , energy modulations due to a short laser pulse are not sinusoidal .",
    "therefore , the above obtained estimate can only be used as a first guess . for our simulations",
    "we choose the modulation amplitude of 20 mev , and the @xmath0 was optimized in the simulations at 7.1 @xmath5 m . in order to get the desired energy modulations , we use a laser pulse with the duration of 5 fs ( fwhm ) and pulse energy 3 mj .",
    "the laser beam is focused into the modulator undulator , the spot size in the waist is @xmath37 m .    finally , we should choose parameters of the radiator undulator that should be tuned to the desired wavelength of 5 nm for the given beam energy of 1.2 gev .",
    "we take a planar undulator with the following parameters : undulator period is 2.5 cm , peak field is 0.67 t , number of periods is 5 .",
    "we assume that the undulator has a tunable gap which would allow us to change wavelength by changing the gap and/or the beam energy .",
    "the numerical simulations of the lsca operation were done as follows .",
    "self - interaction of electrons in the beam by space charge fields in the focussing channels was simulated with 3-d version of the space charge tracking code astra @xcite .",
    "all important aspects of the problem like betatron motion of particles in the fodo channel , three - dimensional calculation of the space charge field , start up from shot noise were included in the simulations . to properly treat the start up from noise",
    ", we took only a short part of the bunch with the length about 2 @xmath5 m , and used a real number of particles , @xmath38 , distributing them randomly in 6-d phase space .",
    "after the energy change of each particle in a drift was calculated , we simply applied @xmath0 to add the effect of a chicane ( later we checked that csr effects do not play any significant role , see below ) . in this way",
    "the evolution of the particle distribution through a single cascade was simulated .",
    "then the procedure was repeated for the next cascade , etc .",
    "the results of simulations of the first three cascades of lsca are shown in figs .",
    "[ fig : astra - time ] and [ fig : astra - spectr ] . in fig .",
    "[ fig : astra - time ] we show the amplified noisy modulations of beam current , and in fig .",
    "[ fig : astra - spectr ] the modulus of the bunch form factor ( fourier transform of the trace in fig .",
    "[ fig : astra - time ] , left ) is presented .",
    "note that a linear gain ( in amplitude ) per cascade is about 5 at 40 - 50 nm wavelength . in the third cascade",
    "the amplification becomes slightly nonlinear , so that the gain is reduced by about 10% .",
    "typical feature size in spectrum ( interval of spectral coherence ) can be estimated as @xmath39 @xcite , where @xmath40 m is the length of a part of the bunch in our simulations . converting this dependence to a wavelength interval",
    ", we get @xmath41 , i.e. one should expect a quadratic dependence of the coherence interval on the wavelength .",
    "also note that in case of simulations with astra we used only a short part of a 100 pc bunch , so that the fine structure in spectrum does not correspond to a real situation with much longer bunch .",
    "alternatively , we have developed a simple and fast 1-d code losca ( * lo*ngitudinal * s*pace * c*harge * a*mplifier ) .",
    "initially , particles are distributed randomly in the phase space time - energy .",
    "beam is then cut into short slices ( much shorter than @xmath42 ) , and the lsc interaction between the slices in a drift space is simulated with the help of the lsc wake function , averaged over beam cross - section @xcite .",
    "the drift is divided into pieces , and at the end of each piece the paricles change their positions depending on their energies .",
    "the change of particles distribution through a chicane is simply performed by applying @xmath0 .",
    "note that in our particular case the change of particles positions happens only in chicanes . in the drifts",
    "it is negligibly small because of a very small spread of the longitudinal velocities due to both energy spread and emittance , and also because the length of a drift is much smaller that the reduced wavelength of plasma oscillations @xcite .",
    "this means that for our parameter set it is sufficient to calculate only energy change of particles due to lsc interaction without dividing the drift into pieces .",
    "in fact , due to a simple model , used in losca , we were able to relatively quickly calculate the evolution of particles distribution through lsca cascades with real number of particles in a bunch ( with the charge of 100 pc ) , namely with @xmath43 particles . to have a representative set of data",
    ", we performed several simulation runs with different initial shot noise realizations .",
    "the results of simulations of the first three cascades of lsca for one of realizations are presented in figs .",
    "[ fig : losca-3rd - time ] and [ fig : losca-3rd - spectr ] .",
    "it is interesting to observe ( see right plots in figs .  [",
    "fig : astra - time ] and [ fig : losca-3rd - time ] ) that losca gives the same amplification of shot noise modulations as astra , despite the fact that essentially different models are used in these two codes .",
    "we propose the following explanation . for a considered parameter range",
    "a typical transverse size of the lsc field is comparable to the electron bunch transverse size .",
    "particles in astra execute betatron oscillations and sample different lsc fields , while in losca there is no transverse motion but the applied lsc wake is averaged over electron beam cross - section .",
    "our conclusion is that both approaches lead to very similar results for the lsca gain , so that a simplified approach is justified for a typical parameter range of lsca @xcite : amplified wavelength is in the range described by eq .",
    "( [ opt - wl ] ) , and beta - function is smaller than a length of a drift space in an amplification cascade .         in the forth amplification cascade",
    "the beam first moves in the 2.8 m long drift , accumulating energy modulation due to lsc field , and then it is modulated in energy by a short laser pulse .",
    "modulation of the beam by a laser pulse in two - period undulator was simulated in the same way as it was done in @xcite , namely by a direct integration of equations of motion in the combined field of laser and undulator .",
    "the resulting energy modulation is presented in fig .",
    "[ atto - mod ] , it was imposed on the phase space distribution of the particles coming from the last drift .",
    "then the effect of the last chicane was simulated by applying @xmath44 m . a typical current distribution for the beam , simulated with losca , is presented in fig .",
    "[ fig : losca - comp ] . of course , amplitudes and positions of peaks ( right plot in fig .",
    "[ fig : losca - comp ] ) are changing shot - to - shot .",
    "a similar distribution is obtained from the simulation with astra , see fig .",
    "[ fig : csr - nocsr ] .",
    "the next problem is a possible influence of coherent synchrotron radiation ( csr ) field in the chicane on extremely short high - current spikes .",
    "we have performed simulations with the code csrtrack @xcite .",
    "we took the particle distribution at the exit of the forth drift ( simulated with astra ) , imposed energy modulation by a laser , reduced number of particles ( still having representative ensemble ) , and transferred this distribution into csrtrack .",
    "finally , we did tracking through the chicane , taking into account csr wake with the help of the projected model @xcite .",
    "the results can be seen in fig .",
    "[ fig : csr - nocsr ] . as expected @xcite , no noticeable effects on longitudinal and transverse dynamics were observed ( except for a little time shift ) .",
    "the reason for this is a practically complete smearing of microstructures inside the chicane due to the coupling of transverse and longitudinal dynamics described by @xmath45 and @xmath46 elements of transfer matrix @xcite .",
    "ensemble - averaged spectrum of the beam current ( modulus of the bunch form factor ) after the last chicane is presented in fig .",
    "[ fig : losca - comp - spectr ] . within the spectral window , shown in this figure , the spectral components are dominantly coming from the fine structure within the main peak in fig .",
    "[ fig : losca - comp ] ( right ) .",
    "the fine structures within two side peaks ( which are significantly weaker compressed ) , contribute to the spectral density for wavelengths longer than 10 nm . if a resonance wavelength of the radiator undulator is within the range of 2 - 8 nm , one would get quite powerful radiation generated by fine structure within the main peak , i.e. very short pulses - depending also on the number of undulator periods . some small contribution from side peaks is , in principle , possible due to a nonlinear harmonic generation mechanism during lsc amplification and compression .        to illustrate the main properties of the radiation , we assume that the undulator is tuned to 5 nm , and the number of periods is 5 ( undulator parameters are presented in the previous section ) .",
    "the radiation process was simulated with the code fast @xcite .",
    "for this purpose , the particles distribution , simulated with the help of astra or losca , was transferred into fast input distribution .",
    "we should note that fast , as well as other fel codes , uses resonance approximation , i.e. it deals essentially with narrow - band signals .",
    "the question arises wether or not one can properly simulate a process if the input signal ( density modulation ) has a broad band . we can answer this question as follows ( see @xcite for more details ) : within the central cone of the undulator radiation the code produces correct results even if the incoming density modulation has a wide band ( in particular , if there is only shot noise having white spectrum ) .",
    "the accuracy of simulations of radiation properties within the central cone is on the order of inverse number of undulator periods , i.e. about 20 % in our case .",
    "main simulation results are presented in fig .",
    "[ fig : power-4shots ] . several typical realizations of attosecond pulses",
    "are shown , that were obtained from incoming particles distributions , simulated with astra ( solid line ) and losca .",
    "a typical duration of these pulses is 50 - 70 attosecons ( fwhm ) , the peak power is at 100 mw level , and the bandwidth is about 20% . ensemble - averaged pulse energy is 5 nj with the pulse - to - pulse rms fluctuations about 35 % .",
    "one can sometimes observe side peaks ( corresponding to those in density modulation in fig .",
    "[ fig : losca - comp ] , left plot ) , but they are typically below 1% of the power in the main peak .",
    "the rest of the bunch radiates only spontaneously ( amplified density modulations in the range 20 - 80 nm could have produced radiation into large angles , well beyond the central cone , but this radiation is totally suppressed due to a finite transverse size of the beam ) . as one",
    "can see from fig .",
    "[ fig : losca - comp ] , right plot , the half - angle of coherent radiation is about 50 @xmath5rad .",
    "selecting ( with the help of a pinhole ) a cone with half - angle 100 - 120 @xmath5rad would mean that one does lose not any power of attosecond x - ray pulses , while spontaneous radiation background is reduced to the level of 50 pj for 100 pc bunch .",
    "thus , we can state that a contrast ( defined as a ratio of radiation energy of attosecond pulses to the total pulse energy ) is high , above 98 % .",
    "flash ( free electron laser in hamburg ) is the soft x - ray fel user facility @xcite operating in the wavelength range from 4 to 50 nm .",
    "short vuv and soft x - ray pulses ( down to 10 fs @xcite ) are produced in a 27 m long undulator in self - amplified spontaneous emission ( sase ) mode @xcite .",
    "recently , radiation at water window wavelengths down to 4 nm was generated .",
    "flash layout is shown in fig .",
    "[ flash ] .",
    "the beam is produced by the laser - driven rf gun , compressed in two bunch compressors , and accelerated in superconducting rf modules up to 1.2 gev .",
    "then the beam is guided through the dogleg ( where it is collimated ) , moves about 50 m towards sase undulator , radiates there , and goes to the beam dump ( alternatively , it can go to the dump via bypass ) .    presently , there are two temporal experimental setups in the straight section between the dogleg and the undulator .",
    "optical replica synthesizer ( ors ) @xcite is placed ( not shown in fig .",
    "[ flash ] ) directly behind the dogleg / collimator .",
    "the ors is followed by sflash @xcite , the experimental setup for seeding the fel with the radiation produced by the generation of higher harmonics of ti : sa laser in rare gases .",
    "the laser beam together with high harmonics is sent from the laser laboratory to the tunnel , where it is in - coupled to the electron beam line through the dogleg . in the case of successful lasing of sflash",
    ", the amplified vuv radiation is supposed to be outcoupled by a mirror and transported to the experimental hutch ( at the same time laser beam for pump - probe experiments is transported there from the laser laboratory ) .",
    "the distance between the dogleg and the mirror is about 30 m.        we note that this infrastructure is well suited for production of attosecond pulses in the lsca and using them for experiments in the hutch .",
    "the total length of lsca is supposed to be about 14 m , so that it can substitute one of the two existing setups .",
    "experiments can be started with the existing ti : sa laser ( that delivers 35 fs long pulses with a pulse energy of up to 50 mj @xcite ) for modulation of the electron beam , in this case one will produce a train of attosecond soft x - ray pulses .",
    "we have simulated this situation with losca and fast , the results are presented in fig .",
    "[ fig : long - pulse ] . to get required amplitude of energy modulations , we used only 15 mj out of available laser pulse energy .",
    "later the laser can be upgraded in order to produce 5 fs long pulses with pulse energy about 3 mj what would allow to obtain an isolated attosecond x - ray pulse .",
    "the attosecond pulses with the help of the outcoupling mirror can be transported to the existing experimental hutch where they can be used together with synchronized few femtosecond long powerful laser pulses .    as a possible option one can consider seeding flash undulator with an attosecond pulse . in this case",
    "the outcoupling mirror is moved out , and the chicane at that position is used to slightly delay the electron bunch so that the radiation pulse is parked on the fresh part of the bunch . despite the transverse size of the radiation at the entrance of flash undulator is much larger than that of the electron beam , an effective seed power is still much larger than an effective power of shot noise . during amplification the radiation pulse would be stretched , so that finally pulse duration would be comparable to fel coherence time ( about 1 fs ) .    finally we note that the attosecond scheme , described in this paper , can also be used at flash ii @xcite , fermi@elettra @xcite and similar facilities , as well as at soft x - ray beamlines of large x - ray fel facilities like sase3 beamline of the european xfel @xcite ."
  ],
  "abstract_text": [
    "<S> a longitudinal space charge amplifier ( lsca ) , operating in soft x - ray regime , was recently proposed . </S>",
    "<S> such an amplifier consists of a few amplification cascades ( focusing channel and chicane ) and a short radiator undulator in the end . </S>",
    "<S> broadband nature of lsca supports generation of few - cycle pulses as well as wavelength compression . in this paper </S>",
    "<S> we consider an application of these properties of lsca for generation of attosecond x - ray pulses . </S>",
    "<S> it is shown that a compact and cheap addition to the soft x - ray free electron laser facility flash would allow to generate 60 attosecond ( fwhm ) long x - ray pulses with the peak power at 100 mw level and a contrast above 98% .    </S>",
    "<S> desy 11 - 040    march 2011    , </S>"
  ]
}