{
  "article_text": [
    "suppose we are given the population density  @xmath0 of a country or province , by which we mean the number of people per unit area as a function of geographical position  @xmath1 . and",
    "suppose we are charged with choosing the sites of @xmath2 facilities , such as hospitals , post offices , supermarkets , gas stations , or schools , so that the mean distance to the nearest facility averaged over the population is minimized . in most countries population density is highly non - uniform , in which case a uniform distribution of facilities would be a poor choice : it gains us little to build a lot of facilities in sparsely populated areas .",
    "a more sensible choice would be to distribute facilities in proportion to population density , so that a region with twice as many people has twice as many facilities .",
    "but this distribution too turns out to be suboptimal , because we also gain little by having closely spaced facilities in the highly populated areas  when facilities are closely spaced the typical person is not much further from their second - closest facility than from their closest , so one or the other can often be removed with little penalty and substantial savings .",
    "as we will see , the ideal solution to this problem lies somewhere between these two extremes , with the density of facilities increasing as the two - thirds power of population density , a prediction that we verify using simulations and visualizations based on cartograms , with actual population data for the united states .",
    "in addition , one is often interested in connections between facilities , such as flights between airports  @xcite or transmission lines between power stations  @xcite . in the second half of this paper",
    "we generate networks based on a simple model that optimizes network topology with respect to the cost of maintaining and traveling across the network . depending on the benefit function chosen ,",
    "we find structures ranging from completely decentralized networks to hub - and - spoke networks .",
    "we wish to distribute @xmath2 facilities over a two - dimensional area  @xmath3 such that the objective function @xmath4 is minimized . here",
    "@xmath5 is the set of positions of the facilities and @xmath0 is the population density within the region  @xmath3 of interest .",
    "this objective function is proportional to the mean distance that a person will have to travel to reach their nearest facility .",
    "seemingly simple , this so - called @xmath2-median problem has been shown to be np - hard  @xcite , so in practice most studies rely either on approximate numerical optimization or approximate analytic treatments  @xcite .",
    "a number of different approaches have been used  @xcite ; the calculation given here is essentially that of gusein - zade  @xcite .",
    "our @xmath2 facilities naturally partition the area  @xmath3 into voronoi cells .",
    "( the voronoi cell  @xmath6 for the @xmath7th facility is defined as the set of points that are closer to @xmath8 than to any other facility . )",
    "let us define @xmath9 to be the area of the voronoi cell to which the point @xmath1 belongs . in two dimensions a person living at point  @xmath1 will on average be a distance @xmath10^{1/2}$ ] from the nearest facility , where @xmath11 is a geometric factor of order  1 , whose exact value depends on the shape of the voronoi cell , but which will in any case drop out of the final result .",
    "the distance to the nearest facility averaged over all members of the population is proportional to @xmath12^{1/2}\\>{{\\rm d}}^2r,\\ ] ] where we are making an approximation by neglecting variation of the geometric factor  @xmath11 between cells .",
    "the value of @xmath9 is constrained by the requirement that there be @xmath2 facilities in total . noting that @xmath9 is constant and equal to @xmath13 within voronoi cell  @xmath6",
    ", we see that the integral of @xmath14^{-1}$ ] over @xmath6 is @xmath15^{-1 } \\>{{\\rm d}}^2r = [ s({\\mathbf{r}}_i)]^{-1 } \\int_{v_i } { { \\rm d}}^2r = 1.\\ ] ] summing over all  @xmath6 , we can then express the constraint on the number of facilities in the form @xmath16^{-1 } \\>{{\\rm d}}^2r = p. \\label{constraint}\\ ] ]    subject to this constraint , optimization of the mean distance  @xmath17 above gives @xmath18^{1/2}\\>{{\\rm d}}^2r    - \\alpha \\biggl ( p - \\int_a [ s({\\mathbf{r}})]^{-1 } \\>{{\\rm d}}^2r \\biggr ) \\biggr ] = 0,\\ ] ] where @xmath19 is a lagrange multiplier . performing the functional derivatives and rearranging for @xmath9",
    ", we find @xmath20^{2/3}$ ] .",
    "the lagrange multiplier can be evaluated by substituting into eq .",
    "( [ constraint ] ) and we arrive at the result @xmath21^{2/3}\\over\\int [ \\rho({\\mathbf{r}})]^{2/3 } \\>{{\\rm d}}^2r } , \\label{optimum}\\ ] ] where we have introduced the notation @xmath22^{-1}$ ] for the density of the facilities",
    ".     facilities located in the lower 48 united states , based on population data from the us census for the year 2000 . ]",
    "thus , if facilities are distributed optimally for the given population distribution , their density increases with population density but does so slower than linearly , namely as a power law with exponent  @xmath23  ; the corresponding exponent in that case is @xmath24 . ]",
    ". this density places most facilities in the densely populated areas where most people live while still providing reasonable service to those in sparsely populated areas where a strictly population - proportional allocation might leave inhabitants with little or nothing .",
    "the derivation above makes two approximations : it assumes that the geometric factor @xmath11 is the same for all voronoi cells and that @xmath9 is a continuous function .",
    "neither assumption is strictly true , but we expect them to be approximately valid if @xmath25 varies little over the typical size of a voronoi cell . as a test of these assumptions , we have optimized numerically the distribution of @xmath26 facilities over the lower 48 states of the united states ( fig .",
    "[ mapa ] ) using population data from the most recent us census  @xcite , which counts the number of residents within more than 8 million blocks across the study region . to create a continuous density function  @xmath25 , we convolved these data with a normalized gaussian distribution of width 20  km .",
    "the facility locations were then determined by optimizing the full @xmath2-median objective function  ( [ optimfunc ] ) by simulated annealing  @xcite .     from fig .",
    "[ mapa ] versus population density @xmath25 on a log - log plot .",
    "a least - squares linear fit to the data gives a slope of @xmath27 ( solid line ) .",
    "]    the relation @xmath28 can be tested as follows .",
    "first , we determine the voronoi cell around each facility",
    ". then we calculate @xmath29 as the inverse of the area of the corresponding cell and @xmath25 as the number of people living in the cell divided by its area .",
    "figure  [ mapb ] shows a scatter plot of the resulting data on doubly - logarithmic scales .",
    "if the anticipated @xmath23-power relation holds , we expect the data to fall along a line of slope  @xmath23 .",
    "and indeed a least - squares fit ( solid line in the figure ) yields a slope @xmath30 , in good agreement with the theoretical prediction .",
    "some statistical concerns might be raised about this method .",
    "first , we used the voronoi cell area to calculate both @xmath31 and  @xmath25 , so the measurements of @xmath32- and @xmath33-values in the plot are not independent , and one might argue that a positive slope could thus be a result of artificial correlations between the values rather than a real result  @xcite .",
    "second , it is known that estimating the exponent of a power law such as eq .",
    "( [ optimum ] ) from a log - log plot can introduce systematic biases  @xcite . in the next section ,",
    "we introduce an entirely different test of eq .",
    "( [ optimum ] ) that , in addition to being of interest in its own right , suffers from neither of these problems .",
    "if we neglect finite - size effects , it is straightforward to demonstrate that optimally located facilities in a uniformly populated space lie on the vertices of a regular triangular lattice  @xcite .",
    "it has been conjectured that for a non - uniform population there is a general class of map projections that will transform the pattern of facilities to a similarly regular structure  @xcite .",
    "the obvious candidate projections are population density equalizing maps or cartograms , i.e. ,  maps in which the sizes of geographic regions are proportional to the populations of those regions  @xcite .",
    "densely populated regions appear larger on a cartogram than on an equal - area map such as fig .",
    "[ mapa ] , and the opposite is true for sparsely populated regions . since most facilities are located where the population density is high , a cartogram projection will effectively reduce the facility density in populated areas and increase it where the population density is low .",
    "therefore , one might expect that a cartogram leads to a more uniform facility density than that shown in fig .",
    "[ mapa ] . and",
    "indeed some authors have used population density equalizing projections as the basis for facility location methods  @xcite .    in fig .",
    "[ cart]a we show the facilities of fig",
    ".  [ mapa ] on a population density equalizing cartogram created using the diffusion - based technique of  @xcite .",
    "although the _ population _ density is now equal everywhere , the _ facility _ density is obviously far from uniform . a comparison between fig .  [ mapa ] and",
    "[ cart]a reveals that we have overshot the mark since the facilities are now concentrated in areas where there are few in actual space .",
    "equation  ( [ optimum ] ) makes clear what is wrong with this approach . since @xmath31 grows slower than linearly with  @xmath25 , a projection that equalizes @xmath25 will necessarily overcorrect the density of facilities . on the other hand , based on our earlier result",
    ", we would expect a projection equalizing @xmath34 instead of @xmath25 to spread out the facilities approximately uniformly .",
    "hence , one way to determine the actual exponent for the density of facilities is to create cartograms that equalize  @xmath35 , @xmath36 , and find the value of  @xmath32 that minimizes the variation of the voronoi cell sizes on the cartogram .",
    "this approach does not suffer from the shortcomings of our previous method based on the doubly - logarithmic plot in fig .",
    "[ mapb ] , since we neither use the voronoi cells to calculate the population density nor take logarithms .",
    "one might argue that the voronoi cells on the cartogram are not equal to the projections of the voronoi cells in actual space , which is true  the cells generally will not even remain polygons under the cartogram transformation . the difference , however , is small if the density does not vary much between neighboring facilities .    in fig .",
    "[ cellstd ] we show the measured coefficient of variation ( i.e. ,  the ratio of the standard deviation to the mean ) for voronoi cell sizes on @xmath35 cartograms as a function of the exponent  @xmath32 ( solid curve ) . as the figure shows , the minimum is indeed attained at or close to the predicted value of @xmath37 .",
    "figure  [ cart]b shows the corresponding cartogram for this exponent .",
    "this projection finds a considerably better compromise between regions of high and low population density than either fig .",
    "[ mapa ] or  [ cart]a .    for comparison ,",
    "we have also made the same measurement for @xmath38 points distributed randomly in proportion to population .",
    "since the density of these points is by definition equal to  @xmath25 , we expect the minimum standard deviation of the cell areas to occur on a cartogram with @xmath39 . our numerical results for this case ( dotted curve in fig .",
    "[ cellstd ] ) agree well with this prediction . comparing the solid and the dotted curves in the plot",
    ", we see that not only the positions of the minima differ , but also the minimal values themselves .",
    "the lower standard deviation for the @xmath2-median distribution indicates that optimally located facilities are not randomly distributed with a density @xmath40 . instead , the optimally located facilities occupy space in a relatively regular fashion reminiscent of the triangular lattice of the uniform population case  @xcite .",
    "in many cases of practical interest , finding the optimal location of facilities is only half the problem .",
    "often facilities are interconnected forming networks , such as airports connected by flights or warehouses connected by truck deliveries . in these cases",
    ", one would also like to find the best way to connect the facilities so as to optimize the performance of the system as a whole .",
    "consider then a situation in which our facilities form the nodes or vertices of a network and connections between them form the edges .",
    "the efficiency of this network , as we will consider it here , depends on two factors . on the one hand ,",
    "the smaller the sum of the lengths of all edges , the cheaper the network is to construct and maintain . on the other hand , the shorter the distances through the network between vertices ,",
    "the faster the network can perform its intended function ( e.g. ,  transportation of passengers between nodes or distribution of mail or cargo ) .",
    "these two objectives generally oppose each other : a network with few and short connections will not provide many direct links between distant points and paths through the network will tend to be circuitous , while a network with a large number of direct links is usually expensive to build and operate .",
    "the optimal solution lies somewhere between these extremes .",
    "let us define @xmath41 to be the shortest geographic distance between two vertices @xmath7 and @xmath42 measured along the edges in the network .",
    "if there is no path between @xmath7 and  @xmath42 , we formally set @xmath43 . introducing the adjacency matrix @xmath44 with elements",
    "@xmath45 if there is an edge between @xmath7 and  @xmath42 and @xmath46 otherwise , we can write the total length of all edges as @xmath47 we assume this quantity to be proportional to the cost of maintaining the network .",
    "clearly this assumption is only approximately correct ; networked systems in the real world will have many factors affecting their maintenance costs that are not accounted for here .",
    "it is however the obvious first assumption to make and , as we will see , can provide us with good insight about network structure .",
    "the typical cost of shipping a commodity or traveling through the network depends on the distances  @xmath41 as well as the amount of traffic  @xmath48 ( e.g. ,  weight of cargo , number of passengers , etc . )  that flows between vertices @xmath7 and  @xmath42 . in a spirit similar to our assumption about maintenance costs , we assume that the total travel cost is given by @xmath49 we assume that @xmath48 is proportional to the product of populations in the voronoi cells @xmath6 and @xmath50 around @xmath7 and  @xmath42 , so that @xmath51 in appropriate units . and",
    "the total cost of running the network is proportional to the sum @xmath52 with @xmath53 a constant that measures the relative importance of the two terms .",
    "then the optimal network is the one minimizing this sum  @xcite .",
    "using again the conterminous united states as an example , we have first determined the optimal placement of @xmath54 facilities which we then try to connect together optimally .",
    "the number of edges in the network depends on the parameter  @xmath55 . if @xmath56 , the cost of travel  @xmath57 vanishes and the optimal network is the one that simply minimizes the total length of edges .",
    "that is , it is the minimum spanning tree , with exactly @xmath58 edges between the @xmath2 vertices .",
    "conversely , if @xmath59 then @xmath57  dominates the optimization , regardless of the cost  @xmath60 of maintaining the network , so that the optimum is a fully connected network or clique with all @xmath61 possible edges present . for intermediate values of  @xmath55 , finding",
    "the optimal network is a non - trivial combinatorial optimization problem , for which we can derive good , though usually not perfect , solutions using again the method of simulated annealing  @xcite .",
    "there is , however , another complicating factor . in eq .",
    "( [ z ] ) we assumed that travel costs are proportional to geometric distances between vertices , which is a plausible starting point . in a road network , for example , the quickest and cheapest route is usually not very different from the shortest route measured in kilometers .",
    "but in other networks travel costs can also depend on the number of legs in a journey .",
    "in an airline network , for instance , passengers often spend a lot of time waiting for connecting flights , so that they care both about the total distance they travel and the number of stopovers they have to make . similarly , the total time required for an internet packet to reach its destination depends on two factors , the propagation delay proportional to the physical distance between vertices ( computers and routers ) and the store and forward delays introduced by the routers , which grow with the number of intermediate vertices .    to account for such situations ,",
    "we generalize our definition of the length of an edge and assign to each edge an effective length @xmath62 with @xmath63 .",
    "the parameter @xmath64 determines the user s preference for measuring distance in terms of kilometers or legs .",
    "now we define the effective distance between two ( not necessarily adjacent ) vertices to be the sum of the effective lengths of all edges along a path between them , minimized over all paths .",
    "the travel cost is then proportional to the sum of all effective path lengths @xmath65 and the optimal network for given @xmath55 and @xmath64 is again the one that minimizes the total cost @xmath52 .",
    "( since the second term in eq .",
    "( [ efflngth ] ) is dimensionless , we normalize the length appearing in the first term by setting the average `` crow flies '' distance between a vertex and its nearest neighbor equal to one . )    in fig .",
    "[ netwpmed ] we show the results of the application of this process to the lower 48 united states .",
    "when @xmath66 passengers ( or cargo shippers ) care only about total kilometers traveled and the optimal network strongly resembles a network of roads , such as the us interstate network . as  @xmath64 increases the number of legs in a journey starts playing a more important role and the approximate symmetry between the vertices is broken as the network begins to form hubs .",
    "around @xmath67 we see networks emerging that constitute a compromise between the convenience of direct local connections and the efficiency of hubs , while by @xmath68 the network is dominated by a few large hubs in philadelphia , columbus , chicago , kansas city , and atlanta that handle the bulk of the traffic . on the highly populated californian coast , two smaller hubs around san francisco and los angeles are visible . in the extreme case @xmath69 , where the user cares only about number of legs and not about distance at all , the network is dominated by a single central hub in cincinnati , with a few smaller local hubs in other locations such as los angeles .",
    "we have in this paper studied the problem of optimal facility location , also called the @xmath2-median problem , which consists of choosing positions for @xmath2 facilities in geographic space such that the mean distance between a member of the population and the nearest facility is minimized .",
    "analytic arguments indicate that the optimal density of facilities should be proportional to the population density to the two - thirds power .",
    "we have confirmed this relation by solving the @xmath2-median problem numerically and projecting the facility locations on density - equalizing maps .",
    "we have also considered the design of optimal networks to connect our facilities together . given optimally located facilities , we have searched numerically for the network configuration that minimizes the sum of maintenance and travel costs .",
    "a simple two - parameter model allows us to take different user preferences into account .",
    "the model gives us intuition about a number of situations of practical interest , such as the design of transportation networks , parcel delivery services , and the internet backbone .",
    "the authors thank the staff of the university of michigan s numeric and spatial data services for their help .",
    "this work was funded in part by the national science foundation under grant number dms0234188 and by the james s. mcdonnell foundation .",
    "c.  cameron , s.  low , and d.  wei , `` high density model for server allocation and placement , '' in _ proceedings of the 2002 acm sigmetrics international conference on measurement and modeling of computer systems _ , ( marina del rey ) , pp .  152159 , 2002 .",
    "m.  t. gastner and m.  e.  j. newman , `` diffusion - based method for producing density - equalizing maps , '' _ proceedings of the national academy of sciences in the united states of america _ , vol .  101 , pp .",
    "74997504 , 2004 ."
  ],
  "abstract_text": [
    "<S> we consider the problem of constructing public facilities , such as hospitals , airports , or malls , in a country with a non - uniform population density , such that the average distance from a person s home to the nearest facility is minimized . </S>",
    "<S> approximate analytic arguments suggest that the optimal distribution of facilities should have a density that increases with population density , but does so slower than linearly , as the two - thirds power . this result is confirmed numerically for the particular case of the united states with recent population data using two independent methods , one a straightforward regression analysis , the other based on density dependent map projections . </S>",
    "<S> we also consider strategies for linking the facilities to form a spatial network , such as a network of flights between airports , so that the combined cost of maintenance of and travel on the network is minimized . </S>",
    "<S> we show specific examples of such optimal networks for the case of the united states . </S>"
  ]
}