{
  "article_text": [
    "quantum interferometry , a rapidly developing branch of modern physics , exploits some striking features of quantum mechanics in order to build ultraprecise measuring devices @xcite .",
    "it employs non - classical states of light @xcite or matter @xcite to beat the shot - noise limit ( snl ) @xmath2  the limit of precision of parameter estimation of a phase shift @xmath1 set by classical physics . here",
    "@xmath3 is the number of particles in the probe state .",
    "recent achievements in the preparation of entangled states of atoms have put atomic interferometry @xcite in the _ avant - garde _ for precise determination of electromagnetic @xcite and gravitational @xcite interactions .    a paradigmatic example and benchmark for",
    "every interferometer is the mach - zehnder interferometer ( mzi ) , where two `` beams '' propagating along separated paths accumulate a relative phase @xmath1 ( to be estimated ) and are subsequently recombined through a beam splitter .",
    "a similar protocol which uses internal states instead of separate paths is known as ramsey - spectroscopy @xcite .",
    "it has been recently realized with a bose - einstein condensate ( bec ) , employing two hyperfine states of the atoms @xcite .",
    "the beam - splitter was mimicked by coupling the two modes with a micro - wave pulse for a precisely chosen amount of time .",
    "atomic interferometers with spatially separated modes , which could for instance be used to measure forces decaying with the distance are more challenging in implementation due to the difficulty of performing the beam - splitter transformation @xcite .",
    "in this paper we consider a simple `` double - slit '' interferometer in which two beams are recombined through a free expansion of two initially localized clouds with the output signal obtained by measuring the positions of the particles .",
    "after preparation of a suitably entangled input state , sub shot - noise ( ssn ) interferometry requires thus refined particle detection at the output .",
    "some new techniques of atom - position measurements , like the micro - channel plate @xcite , the tapered fiber @xcite , the light - sheet method @xcite or techniques involving atomic fluorescence from the lattice @xcite , give hope for an almost 100% efficient single - atom detection in the nearby future .",
    "such a tool in principle could even give access to atom - atom correlations at all orders .",
    "it has been shown @xcite that the measurement of the @xmath3-th order correlation function is the best possible estimation strategy for inferring the phase between two interfering bec wave - packets , and allows to reach the heisenberg limit of phase uncertainty . however , even with small becs , the measurement of the @xmath3-th order correlation function would require substantial experimental effort , since a huge configurational space must be probed with sufficient signal to noise ratio .",
    "the difficulty of measuring high order correlation functions is the motivation for this work .",
    "we show that by measuring positions of particles the phase can be estimated with a ssn phase uncertainty using the simple one - body density .",
    "we consider two possible detection scenarios : the output signal consists of ( a ) the positions of single atoms , or ( b ) the number of atoms per pixel , which corresponds to the commonly employed least - squares estimation from the fit to the average density @xcite .",
    "for both cases , we compute the general asymptotic phase uncertainty of a maximum - likelihood phase estimation scheme using the one - body density only .",
    "we verify that in an mzi situation , estimating the phase from the one - body density is equivalent to estimation from the average population imbalance between the arms of the interferometer , and recover the known result that the sensitivity can saturate the heisenberg limit .",
    "we then apply this estimation protocol to our case of interest , namely , two interfering bec wavepackets .",
    "we provide an analytical expression for the phase uncertainty which shows ssn scaling with phase squeezed states in input .",
    "contrary to the mzi , the phase uncertainty does not depend on the phase @xmath1 , which could be an important advantage .",
    "we then analyze the full statistics of the phase estimation by numerically simulating experiments with a realistic number of particles .",
    "we find that already small statistical samples are sufficient to saturate the analytical asymptotic prediction for the phase uncertainty . finally , we discuss the main sources of noise affecting the interferometric precision , which we expect to concern the atom detection stage .",
    "we argue that including the effect of imperfect detection the snl can still be surpassed , and that the necessary amount of squeezing could be achieved in a realistic double - well setup .",
    "the paper is organized as follows . in section [ est ] we derive the general expression for the uncertainty of the phase estimated from the one - body density .",
    "we consider two possible detection scenarios .",
    "we assume either having access to positions of single particles or a coarse grained measurement due to a limited detection capability . in section [ mzi ] ,",
    "we apply the above results to the case of the mzi . in section [ interf ]",
    "we turn to our case study where the interferometer consists of a simple phase - imprint between the modes followed by the ballisitic expansion of the mode functions .",
    "we also show how the phase uncertainty for the phase estimation from the density of the inteference pattern is influenced by characteristic sources of noise .",
    "some details of analytical calculations are presented in the appendices .",
    "an interferometric estimation protocol can be divided in : ( i ) the interferometer transformation , ( ii ) the measurement at the output , and ( iii ) the phase inference through an estimator . in ( i ) , the interferometer imprints a relative phase @xmath1 on the @xmath3-particle input state @xmath4 . such transformation can be represented by a unitary evolution operator @xmath5 , where @xmath6 is linear ",
    "i.e. can be written as a sum of operators acting on each particle separately  and does not depend on @xmath1 . in the heisenberg picture , the field operator evolves as @xmath7 and @xmath4 is unchanged . in the following , we will specify our arguments to the case of particle position measurements at the output , although the results of sec .  [ sing_at_det ] are valid in general .",
    "we will thus consider next that in stage ( ii ) , upon leaving the interferometer , the positions of the particles are detected .",
    "as observed above , due to the difficulty of obtaining high order correlation functions , often only the lowest , namely the density , can be precisely measured .",
    "this density , when normalized , gives @xmath8 the probability density of measuring a single particle at position @xmath9 given @xmath1 .",
    "the average value is calculated for the input state @xmath4 .",
    "next , we assume having no access to the correlations , so the phase is inferred only using @xmath10 and the measurement outcomes obtained in stage ( ii ) .",
    "when in ( ii ) single - atom detection is performed , see fig .",
    "[ scheme ] , each experiment gives the positions of the @xmath3 atoms , @xmath11 , where the label @xmath12 indicates the particular iteration of the experiment .",
    "the accumulated set of data , @xmath3 times @xmath13 positions , is used to construct the likelihood function , @xmath14 the prescription of the maximum likelihood estimator ( mle ) is to infer the phase @xmath15 in stage ( iii ) as the value of @xmath16 which maximizes eq .",
    "( [ like ] ) . as demonstrated in the [ ap_lik ] ,",
    "this mle is consistent , i.e @xmath17 for @xmath18 .",
    "there , we also obtain the uncertainty of the estimator equal to @xmath19 where @xmath20 depends on the two - body probability density of detecting one particle at @xmath21 and the other at @xmath22 , @xmath23 and reads @xcite @xmath24 furthermore @xmath25 is the fisher information calculated with the probability @xmath26 , @xmath27 ^ 2}{p_1(x|\\theta)}.\\label{f1}\\ ] ] equation ( [ sens ] ) is the first important result of this paper .",
    "the phase , which is estimated from the single - body probability , depends on both @xmath26 and @xmath28 .",
    "if @xmath29 or neglected as in @xcite , eq .",
    "( [ sens ] ) provides a shot - noise limited phase uncertainty , since @xmath30 @xcite .",
    "yet , @xmath20 can assume negative values , allowing for ssn phase uncertainty , as will be demonstrated below .",
    "we also underline the generality of the above result , which is valid for any quantum state , where the parameter @xmath1 is estimated from the one - body density .",
    "in analogy , if two - body correlations can be measured in an experiment , four - body correlations would enter in the corresponding expression for the asymptotic phase uncertainty .",
    "it is also important to consider the possibility that the detectors can not resolve positions of individual particles . in this case , we need to use the coarse - grained density and assume that in stage ( ii ) in the @xmath31-th experiment the number of atoms @xmath32 in each of the @xmath33 bins is measured ( the bin size @xmath34 must be small to precisely sample the density variations ) .",
    "the measurement is repeated @xmath13 times and the phase is estimated from a least square fit of the one - body density to the accumulated data . as discussed in detail in @xcite ,",
    "the phase uncertainty of such fit is equivalent to the phase uncertainty of the mle with the likelihood function @xmath35 , where @xmath36 is the probability for detecting @xmath37 atoms on average in the @xmath38-th bin . for large @xmath13 , according to the central limit theorem , the probability @xmath36 is a gaussian with a mean @xmath39 and poissonian fluctuations , @xmath40 @xcite . for the phase uncertainty of this mle , we obtain similarly as in section [ sing_at_det ] that @xmath41 ^ 2}{\\langle n_k \\rangle}+      \\sum_{k\\neq l=1}^{n_{\\rm bin}}\\sigma_{k , l}^2\\frac{\\partial_\\theta\\langle n_k\\rangle}{\\langle n_k \\rangle}\\frac{\\partial_\\theta\\langle n_l\\rangle}{\\langle n_l \\rangle } }      { m\\left[\\sum_{k=1}^{n_{\\rm bin } } \\frac{\\left[\\partial_\\theta\\langle n_k\\rangle\\right]^2}{\\langle n_k \\rangle}\\right]^2},\\label{sens_fit}\\ ] ] where @xmath42.\\ ] ] in the continuous limit @xmath43 , the formulas ( [ sens ] ) and ( [ sens_fit ] ) coincide .",
    "as a benchmark for the phase estimation protocol introduced in sec .",
    "[ est ] , we first consider the case where in stage ( i ) the system acquires the phase @xmath1 in a mzi .",
    "the interferometric sequence of the mzi consists of three steps .",
    "first , the initial two - mode state @xmath44 passes a beam - splitter .",
    "then , a relative phase @xmath1 is imprinted between the modes . in the final stage of the interferometer ,",
    "another beam - splitter acts on the state .",
    "it can be easily shown that the evolution operator of the whole mzi sequence is @xmath45 @xcite .",
    "it is convenient to switch to the heisenberg picture .",
    "the initial field operator reads @xmath46 , where @xmath47/@xmath48 annihilates a particle from mode @xmath49 and the corresponding spatial mode function is @xmath50 . when passing the mzi ,",
    "this operator is transformed as follows @xmath51+\\psi_b(x)\\left[\\hat",
    "b\\cos\\frac\\theta2+\\hat a\\sin\\frac\\theta 2\\right].\\nonumber\\ ] ] we use this result to calculate the one - body [ cf .",
    "( [ single ] ) ] and two - body [ cf .",
    "( [ double ] ) ] probability densities that enter eq .",
    "( [ sens ] ) , assuming that both the mode functions are point - like and trapped in separate arms of the interferometer , i.e. @xmath52 for all @xmath9 . using an initial @xmath3-particle two - mode state @xmath53 , where @xmath54 is the probability of having @xmath55 atoms in mode @xmath56 and @xmath57 in @xmath58 , we get @xmath59 the details of the derivation are presented in [ ap_mzi ] .",
    "the above expression coincides with the phase uncertainty for the estimation of the phase @xmath1 from the average population imbalance between the two arms of the mzi .",
    "this coincidence can be explained as follows .",
    "when atoms are trapped in two separate arms of the interferometer , their positions can be directly translated to the number of particles in each arm , without any loss of information .",
    "it is then not surprising that the estimators basing on the average population imbalance and the average density are equivalent .",
    "note that for a particular case of @xmath60 , we get @xmath61 where @xmath62 is the spin - squeezing parameter @xcite related to number squeezing of the initial state . the expression ( [ mzi_0 ] ) can provide up to the heisenberg scaling of the phase uncertainty , once the interferometer is fed with a strongly number - squeezed state @xcite .",
    "we now turn the attention to our case of interest , to which we devote the rest of the manuscript .",
    "we consider the whole phase acquisition sequence as consiststing of two steps .",
    "first is the phase - imprint performed in absence of two - body interactions , which in the two - mode picture is represented by the unitary operator @xmath63 , and gives @xmath64 then , the trap is opened . since the two - body collisions are assumed to be not present , the two wave - packets freely spread and interfere .",
    "atom interactions can strongly influence the expansion at an early stage , when the density of the clouds is high @xcite .",
    "we assume that initially @xmath50 have identical shape , but are centered around @xmath65 .",
    "after long expansion time ( in the so - called `` far field '' ) @xmath66 , where @xmath67 ( @xmath68 is the atomic mass and @xmath69 is the expansion time ) and @xmath70 , @xmath71 is the fourier transform of the wave - packets at @xmath72 , the same for @xmath73 @xcite .",
    "note that we have dropped the common factor @xmath74 .",
    "some aspect of this simple interferometric sequence , which does not require the implementation of a beam splitter , have been discussed in @xcite .",
    "the field operator @xmath75 gives @xmath76 and @xmath77 presented in the [ ap_pat ] , which are put into eq .",
    "( [ sens ] ) .",
    "the integrals are performed analytically assuming that the interference pattern consists of many fringes , giving @xmath78,\\ ] ] where @xmath79 is the spin - squeezing parameter @xcite related to phase - squeezing of the initial state .",
    "also , we have introduced @xmath80  i.e. the visibility of the interference fringes , see eq .",
    "( [ p1 ] ) and below for details .",
    "one important property of eq .",
    "( [ fin ] ) is its independece of the actual value of the phase @xmath1 .",
    "this can be understood as follows .",
    "the probabilities ( [ single ] ) and ( [ double ] ) depend on @xmath1 in the same manner , i.e. via a sine or cosine function , see eqs ( [ p1 ] ) and ( [ p2 ] ) .",
    "since the integration in ( [ c ] ) and ( [ f1 ] ) runs over the whole space , the shift of the trigonometric functions by a common factor @xmath1 is irrelevant , since within the envelope @xmath81 there are many interference fringes . on the other hand ,",
    "the sensitivity of the mzi ( [ sens_mzi ] ) depends on @xmath1 and has some optimal `` working points '' because the wave - packets @xmath50 do not add up to a wide envelope and therefore the argument for @xmath1-independence valid for the interference pattern does not apply here . therefore , the @xmath1-independence of eq .",
    "( [ fin ] ) might be an advantage of this estimation protocol with respect to the momentum formula of the mzi , valid when the phase is estimated from the one - body density .",
    "note that the phase uncertainty of the mzi [ eq .  ( [ mzi_0 ] ) ] would closely resemble the above result if the second term of eq .  ( [ fin ] ) were absent . in the former case ,",
    "@xmath82 benefits from the number - squeezing because the estimator is equivalent to the average population imbalance between the arms of the interferometer , therefore a state with reduced population imbalance fluctuations decreases the uncertainty @xmath82 .",
    "analogously , in the latter case , the decreasing fluctuations of the relative phase between the two modes would improve the estimation precision .",
    "however , the situation complicates due to the presence of the second term in eq .",
    "( [ fin ] ) .",
    "namely , when @xmath83 drops , so does the fringe visibility @xmath84 and so the amount of information about the phase @xmath1 contained in the one - body density degrades . as a consequence , the phase uncertainty of the estimation from @xmath10 declines .",
    "it is now important to check whether , due to this interplay between improvement from the phase - squeezing and deterioration from the loss of visibility , eq .",
    "( [ fin ] ) can give ssn phase uncertainty at all . to this end",
    ", we calculate @xmath82 with phase - squeezed states for @xmath85 , which we generate by computing the ground state of the two - mode hamiltonian @xmath86 for negative values of the interaction - to - tunelling ratio @xmath87 . for a detailed study of the preparation of phase - squeezed states , including experimental sources of noise , see @xcite . for every value @xmath87",
    ", we find @xmath44 and calculate @xmath83 and @xmath84 .",
    "these values are substituted into eq .",
    "( [ fin ] ) and the resulting @xmath82 is plotted in fig .",
    "[ sq ] as a function of @xmath83 .",
    "clearly , the uncertainty drops below the snl .    )",
    " black solid line  as a function of @xmath83 for @xmath85 particles .",
    "the dashed red line is the phase uncertainty from the squeezing parameter ( in absence of the second term in eq .",
    "( [ fin ] ) ) , while the dotted blue line is given by the inverse of the qfi .",
    "the horizontal dashed line denotes the snl and the vertical dashed line indicates the position of the optimal point .",
    "the open green circles are the result of a numerical experiment ( see text ) for four values of @xmath88 and 0.86 with @xmath89 , @xmath90 . ]",
    "we notice the presence of an optimal point , where the gain from the spin - squeezing is balanced by the loss of visibility .",
    "the figure also shows that the phase uncertainty ( [ fin ] ) does not saturate the bound set by the quantum fisher information ( qfi ) , @xmath91 @xcite .    to support these analytical results for the asymptotics",
    ", we also study the full statistics of the protocol by simulating a phase - estimation experiment with @xmath85 particles .",
    "we generate the input state with a desired amount of phase - squeezing , evaluate the full @xmath3-body probability @xmath92 , with which we draw a single realization yielding the @xmath3 positions .",
    "we repeat the experiment @xmath13 times and obtain one value of the phase @xmath93 using mle with eq .",
    "( [ like ] ) .",
    "this cycle is performed @xmath94 times and the variance of the estimator is calculated on the resulting ensemble .",
    "the results , plotted ( empty circles ) in fig .",
    "[ sq ] for four values of @xmath83 , @xmath89 , and @xmath90 , agree with the theoretical value calculated with eq .",
    "( [ fin ] ) .",
    "an important information in view of an experimental implementation is that though formally the mle saturates ( [ fin ] ) when @xmath95 , in practice @xmath89 is sufficient to reach the bound , as shown in the upper panel of fig .",
    "[ statistics ] .",
    "the lower panel of fig .",
    "[ statistics ] shows instead the average value of the estimated phase plus uncertainties as a function of @xmath13 .",
    "here we have chosen the true value of @xmath1 to be zero , thus the figure show that the estimator is unbiased .",
    "and @xmath85 beats the snl ( which is equal to @xmath96 here , cf .",
    "[ sq ] ) already for @xmath97 and converges to the theoretical value ( dashed red line ) for @xmath89 .",
    "the lower panel depicts the corresponding average plus error bars indicating uncertainties , while the true value of @xmath1 is indicated by the dashed red line . ]",
    "our next step is to find the best scaling of eq .",
    "( [ fin ] ) with @xmath3 . in order to get an analytical estimate , we model @xmath44 with a gaussian , see [ ap_gaus ] , and find that at the optimal point @xmath98 .",
    "this prediction is compared with numerical results , where for every @xmath3 we evaluate the phase uncertainty ( [ fin ] ) at the optimal state . as shown in the inset of the fig .",
    "[ err ] , the agreement between the numerics and the gaussian approximation is very good .",
    "also , we numerically obtain the scaling of the qfi at the optimal state @xmath99 , which differs from @xmath100 just by a factor of 2 .",
    "next , we discuss some characteristic experimental imperfections which can spoil the phase uncertainty ( [ fin ] ) .      single - particle detection , which is the basis of the estimation scheme discussed in sec .",
    "[ sing_at_det ] , is affected by two dominant sources of noise : limited efficiency and finite spatial resolution , see fig .",
    "[ scheme ] .",
    "the former is incorporated by letting the index @xmath38 run from 1 to @xmath101 in eq .",
    "( [ like ] ) . in effect",
    ", @xmath102 replaces @xmath3 in eq .",
    "( [ sens ] ) .",
    "the finite spatial resolution modifies instead both @xmath20 and @xmath25 .",
    "we implement it by convoluting the probabilities @xmath76 and @xmath77 with @xmath103 ( and analogously for @xmath22 )  a gaussian probability of detecting an atom at @xmath21 given its true position @xmath104 .",
    "the convolutions are calculated analytically and the phase uncertainty becomes @xmath105,\\ ] ] where @xmath70 and @xmath67 were defined below eq .",
    "( [ impr ] ) . above",
    ", we assumed that @xmath106 , @xmath107 and the tilde denotes the phase uncertainty in presence of errors .",
    "note that for @xmath108 and @xmath109 we recover eq .",
    "( [ fin ] ) . in fig .",
    "[ err ] we plot eq .",
    "( [ sens_err ] ) as a function of @xmath110 for @xmath85 and @xmath111 and 70% .",
    "for instance , with resolution of 1/30-th of a fringe ( @xmath112 ) and @xmath113 , the ssn scaling is @xmath114 , shown in the inset .",
    "also note that even in presence of the noise , the phase uncertainty ( [ sens_err ] ) does not depend on @xmath1 .    ) , calculated for @xmath85 in the optimal state ( denoted by the vertical dashed line in fig . [ sq ] ) , as a function of @xmath110 for four different values of @xmath115 .",
    "the horizontal dashed line denotes the snl .",
    "the inset shows the phase uncertainty eq .",
    "( [ fin ] ) as a function of @xmath3 ( solid black line ) with the optimal state , compared to the scaling from the gaussian approximation , @xmath98 ( dashed red line ) , the scaling of the qfi @xmath116 ( dotted blue line ) and the scaling of eq .",
    "( [ sens_err ] ) with @xmath117 and @xmath113 , giving @xmath118 ( dash - dotted green line ) . ]    the two main sources of detection noise affecting the least - squares fit estimation protocol defined in sec",
    ".  [ mult_at_det ] , not shown in fig . [ scheme ] , are imperfect atom counting and the finite bin size . to model the former , we assume that the number of atoms in each bin is measured with some uncertainty , and convolute the probabilities entering the fit likelihood function with a gaussian error distribution , @xmath119 . as a result , the variance is increased by @xmath120 .",
    "very promising detection techniques based on the detection of fluorescence photons rely upon detection of on average @xmath121 fluorescence photons per atom , and this number fluctuates at the shot noise level . error propagation gives @xmath122 and the phase uncertainty ( [ sens_fit ] ) becomes @xmath123 ^ 2}{\\langle n_k \\rangle}}.\\ ] ] using @xmath85 and the optimal state denoted by the vertical line in fig .",
    "[ sq ] , for the bin size @xmath124 a ssn phase uncertainty is preserved for @xmath125  a condition well satisfied by the light - sheet technique , which can give @xmath126 photons per atom @xcite .",
    "we have derived an expression for the phase estimation uncertainty for a generic situation where the phase is inferred from the positions of probe particles , when only the one - body density is known . in a mach - zehnder type interferometer ,",
    "the sensitivity of this protocol coincides with the well known error propagation formula and we recover the known heisenberg limited phase uncertainty , @xmath127 .",
    "then we consider the simplest `` double - slit '' interferometer based on spatially interfering wave - packets suggested in ref .",
    "@xcite , which still scales at best as @xmath0 , limited by the loss of fringe visibility . nevertheless , the phase uncertainty for the interference pattern ( [ fin ] ) has a major advantage over the mzi ( [ sens_mzi ] ) .",
    "namely , it performs equally well for any value of @xmath1 , while ( [ sens_mzi ] ) can reach very high values around @xmath128 and @xmath129 .",
    "the interferometric protocol employing the interference pattern could be implemented with a bec trapped in a double - well potential .",
    "after imprinting the phase and switching the trap off , the two clouds would expand and interfere .",
    "the atoms could then be detected using for instance the light - sheet method @xcite , based on the fluorescence measurement of photons scattered by the atoms crossing a laser beam .",
    "another possible scheme relies upon letting the atoms fall onto an optical lattice .",
    "if the interference pattern is dilute so that there is no more than one atom per site , their positions could be detected by a fluorescence measurement @xcite with ultra - high efficiency and resolution .",
    "recent quantum interferometry experiments @xcite indicate that very important effects limitating the phase uncertainty are the detection imperfections , which we believe to have realistically taken into account in our proposal .",
    "another relevant constraint to the precision of a double - well interferometer comes from the noise present in the interferometric sequence i ) .",
    "a recent theoretical work @xcite shows that the amount of squeezing at the optimal point ( @xmath130 for @xmath85 particles ) could be reached with a double - well bec using a refocusing method even in presence of the latter source of noise .",
    "we gratefully acknowledge discussions with julian grond and aurlien perrin .",
    "we thank baltazar brukalski for preparing fig.[scheme ] .",
    "j. ch . acknowledges foundation for polish science international team program cofinanced by the eu european regional development fund and the support of the national science center .",
    "p.h . acknowledges support from the erc starting grant gedentqopt and chist - era quasar .",
    "f.p . acknowledges support by the alexander von humboldt foundation .",
    "a.s . acknowledges support of the eu - strep project qibec .",
    "the proof that the estimator taken as the phase @xmath131 which maximizes the likelihood function of eq .",
    "( [ like ] ) is unbiased and has the variance of eq .",
    "( [ sens ] ) asymptotically in @xmath13 can be performed along the lines of the standard proof that the maximum - likelihood method saturates the cramr - rao bound  @xcite for @xmath132 @xmath133 where @xmath134 is the fisher information to be defined below .",
    "the original proof was given in ref .",
    "recent formulation can be found in ref .",
    "@xcite , and a more accessible albeit less rigorous version is given in ref .",
    "@xcite .",
    "the proof consists of two steps .",
    "firstly , we show that the estimator is _ consistent _ , _ i.e. _ , for @xmath95 , the probability that @xmath135 goes to zero , which means that the estimator approaches the true value of the phase shift asymptotically .",
    "this demonstration follows ref .",
    "@xcite . secondly , we adapt the simplified proof of ref .  @xcite ( see also @xcite ) that a consistent ml estimator is also _ efficient _ , which means that it saturates the cramr - rao bound , eq .",
    "( [ eq : cr ] ) , for @xmath132 .",
    "in particular , the proof shows that for large @xmath13 , @xmath131 is distributed with a gaussian distribution with the variance of eq .",
    "( 2 ) and mean @xmath1 , hence it is also unbiased .    before we start , a remark is in order .",
    "it might seem surprising or even wrong to use the likelihood function of eq .",
    "( [ like ] ) .",
    "the reason is that we use only the single particle probabilities to estimate the phase , even though in a single shot of the experiment , the @xmath3 particles will be correlated in general .",
    "hence the probability that in a single shot the second particle arrives at a position @xmath22 generally depends on the position @xmath21 where the first particle was detected . in traditional ml estimation",
    ", one would therefore define the likelihood function as @xmath136 with the @xmath3-particle conditional probability density @xmath137 instead and define the estimator as the maximum of this function . as mentioned above it",
    "can be shown  @xcite that this estimator is consistent , unbiased , and that it saturates the cramer - rao bound with the fisher information @xmath138 this bound can not be overcome by any other estimator using the results of the measurement governed by the probability density @xmath92 or by any of its reductions .",
    "however , there are no restrictions on how an estimator can be defined , there will only be differences in the performance of different estimators .",
    "we define the estimator based on the single - particle probability density only . as the proof below shows , this estimator is consistent , unbiased , and",
    "has the variance of eq .",
    "the variance is ultimately limited ( but is generally larger than ) the ultimate limit from eq .",
    "( [ eq : cr ] ) with the fisher information from eq .",
    "( [ eq : f_n ] ) .",
    "however , it has the advantage that it is accessible experimentally and also allows for sub shot - noise phase estimation , as shown in the main article .    _",
    "consistency_. we recall the definition of @xmath131 , which is the value of the parameter @xmath16 which maximizes @xmath139 from eq .",
    "( 1 ) from the main article .",
    "equivalently , it maximizes @xmath140 where @xmath3 is the number of particles and @xmath13 the number of independent repetitions of the experiment .",
    "the events @xmath141 are distributed with the conditional probability density @xmath92 , where @xmath1 is the true value of the phase shift , and @xmath142 is obtained from @xmath92 by integrating over all @xmath143 .",
    "we assume _ identifiability _ , _ i.e. _ , that @xmath144 for all @xmath9 is equivalent to @xmath145 .",
    "consistency is then proved by showing that @xmath146 has a maximum at @xmath147 as follows : @xmath148 where we have used @xmath149 .",
    "the equality is obtained _ iff _ @xmath150 .",
    "hence the inequality eq .",
    "( [ eq : consistency ] ) is saturated _ iff _",
    "@xmath151 for all @xmath9 .",
    "it follows that @xmath147 by the identifiability assumption .",
    "hence @xmath152 for @xmath153 .    _",
    "efficiency_. we expand the first derivative of @xmath154 from eq .",
    "( 1 ) of the main article around @xmath1 , @xmath155 we now set @xmath156 . since this phase maximizes @xmath154 , the left - hand - side vanishes and we obtain @xmath157 the consistency of the estimator ensures that we can neglect terms of higher order in @xmath158 provided that @xmath13 is large enough .    in order to investigate how @xmath158 is distributed , we start by computing the average of the denominator , @xmath159    \\nonumber\\\\    & & \\rightarrow_{m\\gg1}m \\sum_{k=1}^n\\int d\\vec x_n p_n(\\vec x_n|\\theta)\\partial_\\varphi^2\\log \\big(p_1(x_k|\\varphi)\\big)\\big\\vert_{\\theta}\\nonumber\\\\    & & = -mnf_1.\\end{aligned}\\ ] ] the coefficient @xmath3 results from the indistinguishability of the particles and @xmath25 is the fisher information calculated with the single particle probability density , @xmath160 coming back to eq .",
    "( [ approx ] ) , we get @xmath161.\\ ] ] hence the difference @xmath158 is the average of @xmath13 random variables , which in the central limit are distributed with a gaussian probability . with a calculation similar to the one of eq .",
    "( [ denom ] ) one obtains that the average value vanishes , which means that the mle is _",
    "unbiased_. the variance of the distribution in the central limit is @xmath162 where @xmath163 therefore the fisher information from eq .",
    "( [ eq : cr ] ) is @xmath164 hence the correlations enter _ via _ the two - particle correlation function @xmath28 even though in the definition of the estimator only the single body density @xmath26 is used .",
    "the multiple - atom detection relies upon dividing the space into @xmath165 bins , each of size @xmath34 . in every bin ,",
    "the number of atoms is measured and this result is averaged over @xmath13 realizations , giving @xmath166 according to the central limit theorem , for large @xmath13 the probability of detecting @xmath167 is gaussian , @xmath168 here , @xmath169 and @xmath170 are the associated fluctuations and both depend on the value of @xmath16 .",
    "we construct the likelihood function as follows @xmath171 again , we follow the steps of the proof of fisher s theorem and expand the derivative of the logarithm of the likelihood function around the true value and set @xmath172 , @xmath173 for the following calculations we introduce the more compact notation @xmath174 used also in the main text .",
    "we start with calculating the denominator of eq .",
    "( [ diff ] ) which in the large @xmath13 limit reads , @xmath175        \\left(\\frac{\\partial^2_\\theta\\langle n_k\\rangle}{\\delta^2 n_k}+\\partial_\\theta\\langle n_k\\rangle\\partial_\\theta\\frac1{\\delta^2n_k}\\right)\\right.\\nonumber\\\\        + \\left.\\frac12\\left[\\bar n_k-\\langle n_k\\rangle\\right]^2\\partial^2_\\theta\\frac1{\\delta^2n_k}\\right ] .",
    "\\end{aligned}\\ ] ] according to ( [ def ] ) , both @xmath176 and @xmath170 in the above equation are a function of @xmath1 . in analogy to eq .",
    "( [ denom ] ) for @xmath18 above denominator is replaced with its average value . upon averaging ,",
    "the second term vanishes and the third term is proportional to @xmath177 , which is negligible in the limit of large @xmath13 . therefore we obtain @xmath178 the average of the square of the nominator of eq .",
    "( [ diff ] ) reads @xmath179 the second term vanishes and the last , after the average is calculated in the central limit , becomes @xmath13-independent , and thus can be dropped when compared to the first term .",
    "let us now separate the sum over @xmath180 into @xmath181 and @xmath182 parts .",
    "the first one simply gives @xmath183 the non - diagonal part @xmath182 depends on the two - site correlations @xmath184 . to justify eq .",
    "( 5 ) of the main text , we notice that the atom - number fluctuations read @xmath185 and thus in a small bin - size limit are poissonian , i.e. @xmath186 .",
    "therefore , @xmath41",
    "n_k \\rangle}+      \\sum_{k\\neq l=1}^{n_{\\rm bin}}\\sigma_{k ,",
    "l}^2\\frac{\\partial_\\theta\\langle n_k\\rangle}{\\langle n_k \\rangle}\\frac{\\partial_\\theta\\langle n_l\\rangle}{\\langle n_l \\rangle } }      { m\\left[\\sum_{k=1}^{n_{\\rm bin } } \\frac{\\left[\\partial_\\theta\\langle n_k\\rangle\\right]^2}{\\langle n_k \\rangle}\\right]^2}.\\label{sens_fita}\\ ] ] the last step is to calculate the cross - corelation term @xmath187\\\\    \\fl&=&(\\delta x)^2n\\left[(n-1)p_2(x_k , x_l|\\theta)-np_1(x_k|\\theta)p_1(x_k|\\theta)\\right],\\end{aligned}\\ ] ] where in the last line we used @xmath188 which is true for @xmath182 .",
    "when the two wave - packets are fully separated , so that @xmath52 for all @xmath9 , the one - body probability reads @xmath189,\\ ] ] where @xmath80 is the fringe visibility .",
    "this probability gives @xmath190 ^ 2}{p_1(x|\\theta ) }    = \\frac{\\nu^2\\cos^2\\!\\theta}2    \\int dx\\ \\frac{|\\psi_a(x)|^4+|\\psi_b(x)|^4}{|\\psi_a(x)|^2(1-\\nu\\sin\\theta)+|\\psi_b(x)|^2(1+\\nu\\sin\\theta)}\\\\    = \\frac{\\nu^2\\cos^2\\!\\theta}{1-\\nu^2\\sin^2\\!\\theta}.\\end{aligned}\\ ] ] now we calculate the second order probability and get [ cf .",
    "( [ double ] ) ] @xmath191\\\\    \\fl   + ( |\\psi_b(x_1)|^2-|\\psi_a(x_1)|^2)(|\\psi_a(x_2)|^2+|\\psi_b(x_2)|^2)\\frac n2\\sin\\theta\\langle\\hat j_x\\rangle.\\end{aligned}\\ ] ] we insert this function together with @xmath10 into the definition of @xmath20 and obtain @xmath192 where @xmath193 if we now combine expressions for @xmath25 and @xmath20 as in eq .",
    "( [ sens ] ) , we obtain eq .",
    "( [ sens_mzi ] ) .",
    "the explicit expression for the one - body probability comes directly from the definitons of @xmath10 and the angular momentum operators , @xmath194 clearly , the coefficent @xmath195 is the visibility of the interference fringes .",
    "the two body probability reads [ cf .",
    "( [ double ] ) ] @xmath196\\right.\\nonumber\\\\    \\fl&&\\left.+\\frac{4\\langle\\hat j_x^2\\rangle}{n(n-1)}\\cos(\\kappa x_1+\\theta)\\cos(\\kappa",
    "x_2+\\theta )    + \\frac{4\\langle\\hat j_y^2\\rangle}{n(n-1)}\\sin(\\kappa x_1+\\theta)\\sin(\\kappa x_2+\\theta)\\right]\\label{p2}.\\end{aligned}\\ ] ]",
    "to find the best possible scaling of the phase uncertainty ( [ fin ] ) with @xmath3 , we model @xmath44 with a gaussian state as follows @xmath197 the operator @xmath198 represents a beam - splitter which transforms the number- to the phase - squeezed state . for @xmath199",
    "the resulting state is spin - coherent , and by decreasing @xmath83 we increase the amount of phase - squeezing .",
    "this state is used to calculate the expectation values @xmath200 and @xmath201 from eq .",
    "( [ fin ] ) . for @xmath202",
    "the summation over @xmath55 can be approximated with an integral . this way we obtain analytical expressions",
    "@xmath203 which are then substituted into eq .",
    "( [ fin ] ) .",
    "taking @xmath204 , where @xmath205 , we get @xmath206 the phase uncertainty is optimal , when these two terms are equal , otherwise one of them would dominate at large @xmath3 .",
    "this condition gives @xmath207 and @xmath98 .",
    "40    mitchell m w , lundeen j s and steinberg a m 2004 _ nature _ * 429 * 726 walther p , pan j - w , aspelmeyer m , ursin r , gasparoni s and anton zeilinger 2004 _ nature _ * 429 * 158 afek i , ambar o and y. silberger 2010 _ science _ * 328 * 879 kacprowicz m , demkowicz - dobrzaski r , wasilewski w , banaszek k and walmsley i a 2010 _ nat . photonics _ * 4 * 357 leibfried d , barrett m d , schaetz t , britton j , chiaverini j , itano w m , jost j d , langer c and wineland d j 2004 _ science _ * 304 * 1476 appel j , windpassinger p j , oblak d , hoff u b , kjrgaard n and polzik e s 2009 _ pnas _ * 106 * 10960 schleier - smith m h , leroux i d and vuleti v 2010 073604 gross c , zibold t , nicklas e , estve and oberthaler m k 2010 _ nature _ * 464 * 1165 estve , gross c , weller a , giovanazzi s and oberthaler m k 2008 _ nature _ * 455 * 1216 riedel m f , bhi p , li y , hnsch t w , sinatra a and treutlein p 2010 _ nature _ * 464 * 1170 maussang k , marti g e , schneider t , treutlein p , li y , sinatra a , long r , estve j reichel j 2010 080403 cronin a d , schmiedmayer j and pritchard d e 2009 1051 pasquini t a , shin y , sanner c , saba m , schirotzek a , pritchard d e and ketterle w 2004 223201 lin yu - ju , teper i , chin ch and vuleti v 2004 050404 obrecht j m , wild r j , antezza m , pitaevskii l p , stringari s and cornell e. a. 2007 063201 anderson b p and kasevich m a 1998 _ science _ * 282 * 1686 fattori m , derrico c , roati g , zaccanti m , jona - lasinio m , modugno m , inguscio m and modugno g 2008 080405 baumgrtner , sewell r j , eriksson s , llorente - garcia i , dingjan j , cotter j p and hinds e a 2010 243003 wineland d j , bollinger j j , itano w m and heinzen d j 1994 a * 50 * 67 pezz l , smerzi a , berman g p , bishop a r and collins l a 2006 a * 74 * 033610 grond j , hohenester u , schmiedmayer j and smerzi a 2011 a * 84 * 023619 jeltes t _ et al .",
    "_ 2007 _ nature _ * 445 * 402 heine d , rohringer w , fischer d , wilzbach m , raub t , loziczky s , liu xiyuan , groth s , hessmo b and schmiedmayer j 2010 095005 bcker , perrin a , manz s , betz t , koller ch , plisson t , rottmann j , schumm t and schmiedmayer j 2009 103039 sherson j f , weitenberg c , endres m , cheneau m , bloch i and kuhr s 2010 _ nature _ * 467 * 68 lcke b _",
    "_ 2011 _ science _ * 334 * 773 cramr h 1946 _ mathematical methods of statistics _ , ( princeton univ . press , princeton , nj ) ferguson t s 1996 _ a course in large sample theory _ , ( chapman & hall , london , uk ) barlow r j 1989 _ a guide to the use of statistical methods in the physical sciences _ , ( wiley , chichester , uk )"
  ],
  "abstract_text": [
    "<S> we derive the asymptotic maximum - likelihood phase estimation uncertainty for any interferometric protocol where the positions of the probe particles are measured to infer the phase , but where correlations between the particles are not accessible . </S>",
    "<S> first , we apply our formula to the estimation of the phase acquired in the mach - zehnder interferometer and recover the well - know momentum formula for the phase sensitivity . </S>",
    "<S> then , we apply our results to interferometers with two spatially separated modes , which could be implemented with a bose - einstein condensate trapped in a double - well potential . </S>",
    "<S> we show that in a simple protocol which estimates the phase from an interference pattern a sub shot - noise phase uncertainty of up to @xmath0 can be achieved . </S>",
    "<S> one important property of this estimation protocol is that its sensitivity does not depend on the value of the phase @xmath1 , contrary to the sensitivity given by the momentum formula for the mach - zehnder transformation . </S>",
    "<S> finally , we study the experimental implementation of the above protocol in detail , by numerically simulating the full statistics as well as by considering the main sources of detection noise , and argue that the shot - noise limit could be surpassed with current technology . </S>"
  ]
}