{
  "article_text": [
    "random graphs  @xcite appeared in the mathematical literature as a convenient tool to prove the existence of graphs with a certain property : instead of a direct constructive proof exhibiting such a graph , one can construct a random ensemble of graphs and show that this property is true with a positive probability . soon afterwards the study of random graphs acquired interest on its own and led to many beautiful mathematical results .",
    "a large class of problems in this field can be formulated in the following generic way : a graph @xmath0 being given , what is the probability that a graph @xmath1 extracted from the random ensemble under consideration contains @xmath0 as a subgraph ? with a more quantitative ambition , one can define @xmath2 as the random variable counting the number of occurrences of distinct copies of @xmath0 in @xmath1 , and study its distribution .",
    "these problems are relatively simple when the pattern @xmath0 remains of a finite size in the thermodynamic limit , i.e. when the size of the random graph @xmath1 diverges .",
    "the situation can become much more involved when @xmath0 and @xmath1 have large sizes of the same order , as @xmath2 can grow exponentially with the system size .",
    "in this article we shall consider these questions when the looked for subgraph @xmath0 is a long circuit ( also called loop or cycle ) , i.e. a closed self - avoiding path visiting a finite fraction of the vertices of the graph .",
    "the level of accuracy of the rigorous results on this problem depends strongly on the random graph ensemble  @xcite .",
    "the regular case ( when all vertices of the graph have the same degree @xmath3 ) is the best understood one .",
    "it has for instance been shown that @xmath3-regular random graphs with @xmath4 have with high probability hamiltonian circuits ( circuits which visit all vertices of the graph ) and the distribution of their numbers is known  @xcite .",
    "this study has been generalized to circuits of all length in  @xcite .",
    "less is known for the classical erds - rnyi ensembles , where the degree distribution of the vertices converges to a poisson law of mean @xmath3 .",
    "most results concerns either the neighborhood of the percolation transition at @xmath5  @xcite , or the opposite limit of very large mean connectivity , either finite with respect to the size of the graph  @xcite or diverging like its logarithm  @xcite ( it is in this latter regime that the graphs become hamiltonian ) .",
    "we shall repeatedly come back in the following on this discrepancy between regular random graphs where probabilistic methods have been proved so successful and the other ensembles for which they do not seem powerful enough and might be profitably complemented by approaches inspired by statistical mechanics .",
    "we will discuss in particular a conjecture formulated by wormald  @xcite , according to which random graph ensembles with a minimal degree of 3 ( and bounded maximal degree ) should be hamiltonian with high probability .    besides this probabilistic point of view ( what are the characteristics of the random variable associated to the number of circuits ) , the problem has also an algorithmic side : how to count the number of circuits in a given graph ?",
    "exhaustive enumeration , even using smart algorithms  @xcite , is restricted to small graphs as the number of circuits grows exponentially with the size .",
    "more formally , the decision problem of knowing if a graph is hamiltonian ( i.e. that it contains a circuit visiting all vertices ) is np - complete  @xcite . a probabilistic algorithm for the approximate counting of hamiltonian cycles is known  @xcite , but is restricted to graphs with large minimal connectivity .",
    "random graphs have also been largely considered in the physics literature , mainly in the real - world networks perspective  @xcite , i.e. in order to compare the characteristics of observed networks , of the internet for instance , with those of proposed random models .",
    "empirical measures for short loops in real world graphs were for instance presented in  @xcite .",
    "long circuits visiting a finite fraction of the vertices were also studied in  @xcite .",
    "the behavior of cycles in the neighborhood of the percolation transition was considered in  @xcite , and the average number of circuits for arbitrary connectivity distribution was computed in  @xcite .    in this paper",
    "we shall turn the counting problem into a statistical mechanics model , which we treat within the bethe approximation .",
    "this will led us to an approximate counting algorithm , cf .",
    "[ sec_bethe ] .",
    "we will then concentrate on random graph ensembles and compute the typical number of circuits with the cavity replica - symmetric method  @xcite in sec .",
    "[ sec_typical ] .",
    "the next two sections will be devoted to the study of the limits of short and longest circuits , then we shall investigate the validity of the replica - symmetry assumption in sec .",
    "[ sec_stability ] .",
    "we perform a comparison with exhaustive enumerations on small graphs in sec .",
    "[ sec_enumerations ] and draw our conclusions in sec .  [ sec_conclusion ] .",
    "three appendices collect more technical computations .",
    "a short account of our results has been published in  @xcite .",
    "let us consider a graph @xmath1 on @xmath6 vertices ( also called sites in the following ) @xmath7 , with @xmath8 edges ( or links ) @xmath9 .",
    "the notation @xmath10 shall mean that the edge @xmath11 joins the vertices @xmath12 and @xmath13 .",
    "the degree , or connectivity , of a site is the number of links it belongs to .",
    "the graphs are assumed in the main part of the text to be simple , i.e. without edges from one vertex to itself or multiple edges between two vertices .",
    "we denote @xmath14 the set of neighbors of the vertex @xmath12 , and use the symbol @xmath15 to subtract an element of a set : if @xmath13 is a neighbor of @xmath12 , @xmath16 will be the set of all neighbors of @xmath12 distinct of @xmath13 .",
    "the same symbol @xmath14 will be used for the set of edges incident to the vertex @xmath12 , the context will always clarify which of the two meanings is understood .    a circuit of length @xmath17 is an ordered set of @xmath17 different vertices , @xmath18 , such that @xmath19 is an edge of the graph for all @xmath20 $ ] , as well as @xmath21 .",
    "two circuits are distinct if they do not share the same set of edges ( i.e. the starting point and the orientation of a tour along the vertices is not relevant ) , and we denote @xmath22 the number of distinct circuits of length @xmath17 in a graph @xmath1 .",
    "the degrees of freedom of our model are @xmath8 variables @xmath23 placed on the edges of the graph , with their global configuration called @xmath24 .",
    "we shall also use @xmath25 for the configuration of the variables on the links around the vertex @xmath12 .",
    "we introduce the following probability law on the space of configurations : @xmath26 where @xmath27 is the normalization constant , and the weights @xmath28 , @xmath29 are given by @xmath30 by convention @xmath31 if @xmath32 , that is to say if the vertex @xmath12 is isolated .",
    "the relevance of this model for the counting of circuits is unveiled by the following reasoning .",
    "each configuration @xmath33 can be associated to a subgraph of @xmath1 , retaining only the edges @xmath11 such that @xmath34 .",
    "the probability ( with respect to the law ( [ eq_law ] ) ) of such a subgraph is non zero only if the retained edges form closed circuits ( any site @xmath12 is constrained by @xmath29 to be surrounded by either 0 or 2 edges of the subgraph ) , and in that case it is proportional to @xmath35 with @xmath17 the number of its edges .",
    "this implies that the normalization factor @xmath27 is the generating function of the numbers @xmath22 , @xmath36 a precision should be made at this point : we defined above a circuit as a self - avoiding closed path . from the weights on the configurations defined by eqs .",
    "( [ eq_law],[eq_wi ] ) , @xmath22 counts in fact the number of configurations made of possibly several vertex disjoint circuits , of total length @xmath17 . in the following",
    "we shall concentrate on the limit of large graph and of long circuits , and we expect the leading order behaviour of @xmath37 not to be affected by this subtlety ( see app .",
    "[ app_disjoint ] for a combinatorial argument in favour of this thesis ) , that will be kept understood from now on to a potts - like spin , @xmath38 , with the weight @xmath29 enforcing that either all variables around @xmath12 are vanishing , or two are non zero and of the same colour @xmath39 . in the bivariate generating function @xmath40 @xmath41 is then conjugated to the number of disconnected circuits , and the limit @xmath42 should allow to eliminate configurations made of several disconnected circuits . however , the bethe approximation of this model is pathological , and we shall not pursue this road here . ] .",
    "note also that  @xcite proposed a monte carlo markov chain algorithm for the evaluation of such a partition function .",
    "we are thus performing a canonical computation where the length of the circuits is allowed to fluctuate around a mean value fixed by the conjugate external parameter @xmath43 . in the thermodynamic limit @xmath44",
    "the saddle - point method can be used to evaluate the sum ( [ eq_sumz ] ) . defining @xmath45 and @xmath46 , where @xmath47 is a reduced intensive length , one obtains : @xmath48 \\ . \\label{eq_legendre}\\ ] ] in this limit the fluctuations of the intensive circuit length in the canonical ensemble vanishes , @xmath49 is concentrated around its mean value @xmath50 .",
    "the ( concave hull of the ) microcanonical entropy can thus be obtained from the canonical free - energy ( with a slight abuse of terminology we shall use this denomination for @xmath51 ) by an inverse legendre transform , @xmath52 \\ . \\label{eq_legendre2}\\ ] ]    we shall now use the bethe approximation to obtain an estimation of the generating function @xmath27 .",
    "we sketch first the general strategy to derive bethe approximations of statistical models ( see  @xcite for a comprehensive discussion ) , before applying it to the present case .",
    "consider a ( non - negative ) weight function @xmath53 defined on a space of configurations @xmath54 .",
    "the computation of the partition function , @xmath55 , can be reformulated as an extremization problem .",
    "indeed , the gibbs functional free - energy , @xmath56 = \\sum_{\\underline{s } } p_{\\rm v}(\\underline{s } )   \\ln \\left ( \\frac{p_{\\rm v}(\\underline{s } ) } { w(\\underline{s } ) } \\right ) \\ , \\ ] ] is minimal ( in the space of normalized variational distributions ) for @xmath57 , where it takes the value @xmath58 . in general",
    "finding the minimum of this functional is not simpler than a direct computation of @xmath59 , however this formulation opens the way to variational approaches : the minimum of @xmath60 in a restricted set of trial distributions @xmath61 , more easily parametrized than generic ones , yields an upper bound on @xmath58 .",
    "the simplest implementation of this idea is the mean - field approximation , in which the trial distributions are factorized , @xmath62 .",
    "a natural refinement consists in introducing correlations between neighboring variables in the trial distributions .",
    "consider for instance a weight function of the form ( [ eq_law ] ) , for arbitrary @xmath28 and @xmath29 .",
    "one can easily show that if the underlying graph @xmath1 were a tree , the true probability distribution would be given by @xmath63 where @xmath64 and @xmath65 are the exact marginals ( for instance , @xmath66 ) of the law @xmath67 .",
    "when the graph is not a tree , this expression is not valid any more .",
    "the bethe approximation consists however in assuming that trial probability distributions can be approximately written under this form even if the graph contains cycles .",
    "this yields the so - called bethe free - energy , @xmath68 = \\sum_{i=1}^n \\sum_{\\underline{s}_i }   p_i(\\underline{s}_i ) \\ln \\left (   \\frac{p_i(\\underline{s}_i)}{w_i(\\underline{s}_i ) } \\right ) -   \\sum_{l=1}^m \\sum_{s_l } p_l(s_l ) \\ln \\left ( p_l(s_l ) \\widehat{w}_l(s_l)\\right ) \\ .\\ ] ] this free - energy is to be minimized with respects to the approximate marginals @xmath64 , @xmath65 , which have to respect two types of constraints :    * @xmath64 and @xmath65 are normalized . *",
    "they are consistent , i.e. for each link @xmath69 , one has @xmath70    this constrained minimization can be performed considering the @xmath71 as independent , at the price of the introduction of lagrange multipliers to enforce the conditions ( [ eq_consistency ] ) .",
    "it is well known that such a procedure amounts to look for a fixed point of the corresponding belief propagation ( bp ) equations  @xcite . in this setting the lagrange multipliers are interpreted as messages sent by variables to neighboring constraints , and vice - versa .",
    "let us now apply this formalism to the specific weights defined in eq .",
    "( [ eq_wi ] ) .",
    "a peculiarity of @xmath29 has to be kept in mind : it can be strictly vanishing when the geometrical constraint of having 0 or 2 present edges around each vertex is not fulfilled . as a consequence ,",
    "the approximate variational marginals @xmath72 have to respect this constraint , and vanish when @xmath73 .",
    "the bethe free - energy reads now @xmath68 = \\sum_{i=1}^n \\sum_{\\underline{s}_i }   p_i(\\underline{s}_i ) \\ln \\left (   p_i(\\underline{s}_i ) \\right ) -   \\sum_{l=1}^m \\sum_{s_l } p_l(s_l ) \\ln \\left ( p_l(s_l ) u^{s_l}\\right )   \\ , \\label{eq_f_bethe}\\ ] ] where the convention @xmath74 has been used , for the strictly forbidden configurations with @xmath73 not to contribute to @xmath75 .",
    "a possible parametrization of the marginals achieving the extremum of the bethe free - energy is @xmath76 where the @xmath77 and @xmath78 are normalization constants , and for each link @xmath79 of the graph a pair of directed ( real positive ) messages has been introduced , @xmath80 and @xmath81 .",
    "these messages obey the following bp equations , @xmath82 cf . fig .",
    "[ fig_eq_msg ] for a graphical representation . roughly speaking",
    ", @xmath80 is proportional to the probability that the edge @xmath79 would be present if the constraint @xmath83 and the weight @xmath84 were to be discarded . hence the form of eq .",
    "( [ eq_msgs ] ) : the numerator corresponds to the situation where @xmath79 is present , the constraint @xmath29 imposes then that exactly one of the edges of @xmath85 is also present .",
    "the denominator states on the contrary that if @xmath79 is absent , either none or two of the edges of @xmath85 are present .    )",
    ".,width=158 ]    the normalization constants of the marginals are easily computed , @xmath86 and one can check , using the bp equations , that the consistency conditions are indeed respected by these expressions of the marginals .",
    "moreover the value of @xmath75 at its minimum can be expressed in terms of the normalization constants @xmath78 and @xmath77 . using this value as an approximation for @xmath87",
    "the free energy in the bethe approximation can be written as : @xmath88 one should also compute the length of the circuits in the configurations selected at a given value of @xmath43 , @xmath89 .",
    "it is rather unwise to use eq .",
    "( [ eq_f ] ) to compute the derivative @xmath90 , as this expression involves the messages which are solution of the bp equations and hence have a non trivial dependence on @xmath43 . on the contrary the expression ( [ eq_f_bethe ] )",
    "being variational , it is enough to compute its explicit derivative with respects to @xmath43 to obtain : @xmath91 the first equality is natural , the average length of the circuits being equal to the sum of the probabilities of presence of all the edges of the graph .",
    "note also that the marginal probabilities contain individually some local information : for instance @xmath92 is the fraction of circuits of length @xmath93 which go through the particular link @xmath11 .",
    "let us now come back for an instant on the bp equations and underline two simple properties they possess . in eq .",
    "( [ eq_msgs ] ) we used the natural convention that sums on empty sets are null .",
    "the first consequence is that @xmath94 if @xmath13 is the only neighbor of @xmath12 , as @xmath95 .",
    "in such a situation @xmath12 is indeed a leaf of the graph , and no circuits can go through the edge @xmath96 .",
    "even if in general the directed message in the reverse direction @xmath81 is non zero , one can easily check that the edge @xmath96 does not contribute to the free energy .",
    "in other words the physical observables are unaffected by the leaf removal process , in which the graph @xmath1 is deprived of the dangling edge @xmath96 . moreover",
    "this simplification can be iteratively repeated , until no leaves are present in the remaining graph .",
    "an illustration of this process in terms of the null directed messages is given in the left part of fig .",
    "[ fig_leaf_and_chain ] .",
    "this property of the bp equations reflects the fact that the circuits of a graph are necessarily part of its 2-core , that is to say the largest of its subgraphs in which all sites have connectivity at least 2 .",
    "consider now a site @xmath12 with two neighbors @xmath13 and @xmath97 , for which the bp equations read @xmath98 and @xmath99 .",
    "this implies that along a chain of degree 2 sites , the directed messages follow a geometric progression , cf .",
    "the right part of fig .",
    "[ fig_leaf_and_chain ] , and in consequence one easily shows that the marginal probability of all edges in a chain are equal : if a circuit goes through one of the edges of the chain , it must go through all of it .",
    "the presentation of the bethe approximation in terms of messages  @xcite we followed in the previous section suggests in a very natural way the following algorithm for the approximate counting of long circuits in a given graph :    * initialize messages @xmath80 for each directed edge of the graph to some random positive values .",
    "* iterate the bp equations ( [ eq_msgs ] ) at a given value of @xmath43 until convergence has been reached .",
    "* using the messages solution of the bp equations , compute @xmath100 from eqs .",
    "( [ eq_f],[eq_ell ] ) , and @xmath101 ( cf .",
    "( [ eq_legendre2 ] ) ) . *",
    "repeat this procedure for different values of @xmath43 to obtain a plot of @xmath102 parametrized by @xmath43 .",
    "this algorithm is of course far from being exact .",
    "a first limitation is that the bp equations are not a priori convergent , on the contrary it is easy to construct counter - examples of small graphs on which they do not reach any fixed point",
    ". it would thus be interesting to determine under which conditions the convergence towards an unique ( non - trivial ) fixed point is ensured .",
    "this kind of question has been the subject of recent interest , see for instance  @xcite .",
    "another possible criticism is that even in the case of convergence of the bp equations , the prediction for the number of loops relies on the bethe approximation , which is an uncontrolled one .",
    "this being said , one should however keep in mind that for large graphs with numerous circuits , an exact enumeration  @xcite is computationally very expensive and reaches very soon the limitations of present time computers .",
    "the approximate algorithm we introduced here can then serve as an efficient alternative , even if its predictions should be treated with caution .",
    "we presented in  @xcite the results of such a procedure when applied to a real - world network of the autonomous system level description of the internet  @xcite , allowing to estimate the total number of circuits , the length of the most numerous circuits and the maximal length circuits , obtaining numbers which are far beyond the possibilities of exhaustive counting .",
    "we also checked the compatibility of our results with the direct enumeration of very short circuits .",
    "the rest of the paper shall be devoted to the study of the number of circuits in graphs @xmath1 belonging to random ensembles . in the regime",
    "we are interested in ( long circuits of large graphs with finite mean degree ) , the common wisdom about the statistical mechanics of disordered systems is that the random variable @xmath103 should be concentrated around its average , the quenched entropy @xmath104 . more formally , one expects the existence of a constant @xmath105 $ ] and a function @xmath106 defined on @xmath1070,\\ell_{\\rm max}]$ ] such that for any sequence @xmath108 with @xmath109 , @xmath110 \\to 0 \\ , \\\\ { \\rm if } \\    \\ell \\in ] 0,\\ell_{\\rm max } ] \\ , & & \\forall \\epsilon > 0 \\ \\ \\ { \\rm prob}\\left[\\left| \\frac{1}{n}\\log { \\cal n}_{l_n } - \\sigma_{\\rm q}(\\ell ) \\right| \\ge \\epsilon \\right ] \\to 0   \\ . \\label{eq_cvp}\\end{aligned}\\ ] ] in the second line @xmath111 should be interpreted as @xmath112 , i.e. outside of any finite interval .    the standard probabilistic methods for proving this kind of results rely essentially on the combinatorial computation of the average and variance of @xmath37 , which are then used in the markov and chebyshev inequalities ( first and second method ) .",
    "the rigorous results on the number of circuits in regular random graphs  @xcite have indeed be obtained through a refined version of the second moment method ( see theorem 4.1 in  @xcite ) . in this context",
    "this approach is limited to cases where the second moment of @xmath37 is not exponentially larger than the square of its first moment - satisfiability formulae , this limitation has been overcome by a weighted second moment method  @xcite . ] .",
    "the quenched entropy is then shown to be equal to the annealed one , @xmath113 , where the overline denotes the average over the random graph ensemble .",
    "we believe that in all ensembles of graphs which are not strictly regular and have a fastly decaying connectivity distribution , the second moment of the number of long circuits is exponentially larger that the square of the first moment ( details of the combinatorial computations leading to this belief are presented in app .",
    "[ sec_app_combinatorial ] ) , thus ruling out the main probabilistic techniques used so far .",
    "the annealed entropy  @xcite is in this case strictly larger than the quenched one , as it is dominated by exponentially rare graphs which have exponentially more circuits than the typical ones .",
    "we shall now follow the cavity method  @xcite , which is particularly well suited to tackle this problem , ubiquitous in the field of disordered statistical mechanics models  @xcite . according to this view , the quenched entropy controlling the leading behaviour of the number of circuits in the typical graphs depends on the graph ensemble only through its limiting degree distribution @xmath114   and @xmath115 have the same poisson degree distribution but distinct annealed entropies , see sec .",
    "[ sec_enumerations ] and app .",
    "[ sec_app_combinatorial ] . ] .",
    "we can for instance assume that the graphs are drawn uniformly among all graphs on @xmath6 vertices which have this degree distribution .",
    "let us recall the existence in this case of a percolation transition  @xcite between a low connectivity regime where the connected components of the graph are essentially trees of finite size , to a percolated phase where one giant component contains a finite fraction of the vertices .    before proceeding with the computations , we introduce some notations used in the following .",
    "@xmath116 denotes the mean connectivity of the graph , hence the number of edges is in the thermodynamic limit @xmath117 .",
    "@xmath118 will be the offspring probability , that is to say the probability of finding a site of degree @xmath119 when selecting at random an edge of the graph and then one of its two vertices . as a site is encountered in such a selection with a probability proportional to its degree , @xmath118 is proportional to @xmath120 . by normalization , @xmath121 to simplify notations we shall also define the factorial moments of @xmath114 and @xmath118 as @xmath122 where the last relation is a simple consequence of eq .",
    "( [ eq_qtilde_q ] ) .",
    "the condition for percolation  @xcite reads with these notations @xmath123 .",
    "we shall assume in the following that this condition is met : the long circuits we are studying can not be present if the graph has no giant component .",
    "we restrict ourselves to fastly ( i.e. faster than any power law ) decaying distributions of connectivities , such that all their moments are finite . after stating the results for arbitrary @xmath114 we shall often specialize to poissonian graphs of mean connectivity @xmath3 , i.e. such that @xmath124 .",
    "in essence the computation of the quenched entropy we undertake now amounts to perform the bethe approximation of the statistical model defined by eqs .",
    "( [ eq_law],[eq_wi ] ) for graphs generated according to the connectivity distribution @xmath114 .",
    "the solution of the bp equations ( [ eq_msgs ] ) , which depends on the particular graph on which they are applied , leads then to a random set of messages @xmath125 .",
    "taking at random a graph of the ensemble , and a directed edge of this graph , one finds a message @xmath125 with probability distribution @xmath126 . in the so - called cavity method at the replica - symmetric level  @xcite",
    ", one assumes that the incoming messages on this directed edge are independent random variables with the same probability law @xmath126 . using eq .",
    "( [ eq_msgs ] ) , this is turned into a self - consistent equation , @xmath127 where we have defined @xmath128    the quenched free - energy is then expressed in terms of this @xmath126 as ( cf .",
    "( [ eq_f ] ) ) : @xmath129 in a similar way the length of the circuits in the configurations selected by a given value of @xmath43 , and the corresponding quenched entropy read : @xmath130    as appears clearly when considering eq .",
    "( [ eq_py ] ) , the distribution @xmath126 contains a dirac s delta in @xmath131 , that is to say a finite fraction of the messages are strictly vanishing .",
    "let us call @xmath132 the fraction of non - trivial messages was denoted @xmath133 in  @xcite . ] , and @xmath134 their ( normalized ) distribution , i.e. @xmath135 where @xmath136 does not contain a dirac s delta in @xmath131 . inserting this definition in eq .",
    "( [ eq_py ] ) , one obtains the equation satisfied by @xmath132 , @xmath137 besides the trivial solution @xmath138 , this equation has another positive solution as soon as @xmath139 , i.e. when the graph is in the percolating regime .",
    "one also realizes that @xmath136 satisfies the equation obtained from eq .",
    "( [ eq_py ] ) by replacing the offspring distribution @xmath140 by @xmath141 , defined as @xmath142 finally the free - energy and the typical length of circuits ( cf",
    "( [ eq_fbeta],[eq_lbeta ] ) ) can also be expressed in terms of the simplified distribution @xmath136 , if one replaces @xmath41 by the following distribution @xmath143 : @xmath144 it is easily verified that this modified distribution has mean @xmath145 , and that a relation similar to eq .",
    "( [ eq_qtilde_q ] ) holds between @xmath143 and @xmath141 , @xmath146 let us now give the interpretation of this simplification process .",
    "we have shown the equality of the quenched entropy of the circuits in the two ensembles defined one by @xmath114 , the other by @xmath147 . as we explained at the end of sec .",
    "[ sec_bethe ] , the circuits of a graph @xmath1 necessarily belong to its 2-core , that is to say the largest subgraph of @xmath1 in which all vertices have a degree at least equal to two . on",
    "the dangling ends , i.e. the edges that do not belong to the 2-core , at least one of the two directed messages @xmath125 is equal to zero .",
    "it is thus very natural to interpret the elimination of null messages in terms of the typical properties of the 2-core of graphs drawn from the ensemble defined by the distribution @xmath114 .",
    "the fraction of edges in the 2-core should be @xmath148 , as both directed messages have to be non - zero for the edge to belong to the 2-core , @xmath147 ( resp .",
    "@xmath149 ) should be the connectivity ( resp .",
    "offspring ) distribution of the 2-core .",
    "this interpretation is indeed confirmed by a direct study of a leaf - removal algorithm which iteratively removes the dangling ends of a graph , that we present in app .",
    "[ sec_app_leaf ] . in the following",
    "we shall use the distribution @xmath41 or @xmath143 , depending on which is simpler in the encountered context .    for future use",
    "we give the explicit expressions in the case of poissonian random graphs , @xmath150    we now come back to the predictions of the quenched entropy and consider as a first example the case of regular graphs of connectivity @xmath3 , for which @xmath151 .",
    "equation ( [ eq_py ] ) on the distribution of messages has then a very simple solution , @xmath152 , with @xmath153 it is then straightforward to express @xmath93 and @xmath154 from this solution .",
    "one can also eliminate the parametrization by @xmath43 to obtain the entropy , @xmath155 which corresponds to the known results mentioned above  @xcite .",
    "the peculiarity of the regular case for which annealed and quenched averages coincide is hinted to by the simplicity of this solution @xmath126 with a single dirac peak .",
    "as soon as @xmath118 is positive for more than one connectivity , the distribution @xmath126 acquires a non vanishing support , which we expect to show up as larger fluctuations in the numbers of circuits , and hence a difference between quenched and annealed computations .",
    "the equation on @xmath126 is not solvable analytically for an arbitrary connectivity distribution .",
    "two complementary roads can then be followed : this distributional equation can be easily solved with a population dynamics algorithm  @xcite .",
    "one represents @xmath126 by a sample of a large number of @xmath125 s , at each time step one draws a number @xmath97 following the law @xmath149 , extracts @xmath97 values @xmath156 randomly from the population , computes the new value @xmath157 , and replace one of the representant of the population by this new value .",
    "starting from a random sample of messages , the population converges to a sample of message distributed according to the fixed point solution of eq .",
    "( [ eq_py ] ) .",
    "the corresponding physical observables are then computed from this sample of messages , which yields the prediction for @xmath104 . as an illustration , we present in fig .",
    "[ fig_ex_poisson ] the results of such a numerical computation for poissonian graphs of mean degree @xmath158 .    on the analytical side , we present in the next sections a study of two limits , for the short and longest circuits , in which the analytical predictions can be pushed forward .",
    "we shall investigate in this section the behaviour of the quenched entropy in the limit of small circuits , computing analytically its first two derivatives at the origin , @xmath159 and @xmath160 .",
    "let us first show the existence of a critical value @xmath161 below which the typical configurations are deprived of any circuit .",
    "this transition is signaled by an instability of the trivial solution of eq .",
    "( [ eq_py ] ) , @xmath162 . perturbing this distribution infinitesimally",
    ", one can expand @xmath163 as @xmath164 . in this limit , if one inserts in the r.h.s . of eq .",
    "( [ eq_py ] ) some @xmath165 with an infinitesimal mean @xmath166 , one obtains another distribution with a mean @xmath167 , with @xmath168 if @xmath169 , the mean of the perturbed distributions decrease upon iteration , so @xmath170 is a stable solution . on the contrary",
    "if @xmath171 this solution is unstable and must flow to a non - trivial stable fixed point .",
    "we shall now set up an expansion around the stability limit , @xmath172 with @xmath173 . in this limit",
    "the messages @xmath125 are supported on a scale which vanishes with @xmath174 , we shall consequently define @xmath175 with @xmath176 finite , and @xmath177 a positive exponent to be determined in a few lines .",
    "let us denote @xmath178 the distribution of the rescaled messages and relate the moments of @xmath179 and @xmath180 as @xmath181 expanding eq .",
    "( [ eq_def_f ] ) as @xmath182 we obtain at the lowest order @xmath183 this fixes the scale @xmath184 and the values of @xmath185 and @xmath186 , the first two moments of the distribution solution of @xmath187    let us now consider the consequences of this scaling on the observables @xmath188 , @xmath49 , @xmath189 in the limit @xmath190 .",
    "taking into account both their explicit dependence on @xmath43 and the implicit one through the distribution @xmath126 , one finds after a short computation that :    * the expansion of @xmath191 starts at the second order , @xmath192 * the intensive length @xmath49 is , at its first non - trivial order , @xmath193 * the first two derivatives of @xmath104 in @xmath194 can be obtained from the previous expressions : @xmath195    solving for @xmath196 and plugging their values in the expression ( [ eq_derivsq ] ) of the derivatives of the entropy one finally obtains : @xmath197    we can now turn to the discussion of these results , and in particular to the comparison with the annealed computation of bianconi and marsili  @xcite . expanding their result ( reproduced in eq .",
    "( [ eq_sigmaa ] ) ) in powers of @xmath49 , one obtains @xmath198 let us first consider a large but non extensive circuit length , @xmath199 .",
    "the number @xmath37 of such circuits is , in the thermodynamic limit , a poisson distributed random variable with a mean equal to @xmath200 when @xmath201 the most probable value of this random variable is equal to its mean , in which one can neglect the polynomial prefactor @xmath202 ( we recall that we assume @xmath123 to be in the percolated regime ) .",
    "consequently the quenched and annealed computation of the first derivative of the entropy at @xmath194 coincide and match the result for @xmath199 : @xmath203 on the contrary the second derivatives differ , in general , in the two computations : @xmath204 as expected the annealed entropy is always greater than the quenched one at this order of the expansion .",
    "moreover it is straightforward to show from the above expression that @xmath205 vanishes only if the distribution @xmath118 is supported by a single integer , in other words in the random regular graph case .",
    "we performed this computation using the degree distribution @xmath114 of the graph , however the reader will easily verify that eq .",
    "( [ eq_short ] ) remains unchanged if one replaces @xmath114 by the connectivity distribution @xmath147 of its 2-core ( the factorial moments @xmath206 gets multiplied by @xmath207 , the mean connectivity @xmath3 by @xmath148 ) .    for completeness we state here the results for poissonian graphs of average degree @xmath3 , @xmath208",
    "a more interesting limit case is the one of maximal length circuits .",
    "some questions arise naturally in this context : what is the maximal length , @xmath209 , for which circuits of @xmath210 edges are present with high probability in a given random graph ensemble ?",
    "in particular , under which conditions these graphs are hamiltonian , that is to say @xmath211 ? finally , what is the number of such longest circuits , measured by the corresponding quenched entropy @xmath212 ?",
    "from the properties of the legendre transform ( cf .",
    "( [ eq_legendre ] ) ) , these quantities can be determined by investigating the limit @xmath213 of the free - energy  : @xmath214 this corresponds , in the jargon of the statistical mechanics approach to combinatorial optimization problems , to a zero temperature limit , where @xmath215 ( resp .",
    "@xmath212 ) is the ground - state energy ( resp .",
    "entropy ) density .",
    "it turns out that the answers to the above questions crucially depend on the presence or not of degree 2 sites in the 2-core of the random graphs under study , we shall thus divide the rest of this section according to this distinction .",
    "before that we state an equivalent expression of the free - energy which will prove more convenient in this limit , @xmath216 where we have defined some logarithmic moments of the distribution @xmath179 , @xmath217 this form of @xmath218 is obtained from eq .",
    "( [ eq_fbeta ] ) by using the equation ( [ eq_py ] ) on @xmath126 and the identity @xmath219      one can gain some intuition on the limit @xmath213 by inspecting the behaviour of the messages in the regular case . indeed , the expansion of eq .",
    "( [ eq_y_regular ] ) shows a scaling of the form @xmath220 , with @xmath176 ( an evanescent field in the jargon of optimization problems ) finite .",
    "consider now the more general case of random graph ensembles with a minimal connectivity of 3 , i.e. @xmath221 , which consequently implies @xmath222 .",
    "thanks to the vanishing of @xmath223 , the equations ( [ eq_py],[eq_def_f ] ) have a solution with the above scaling of @xmath125 with @xmath43 .",
    "one can also check numerically in particular cases that the distributions @xmath165 concentrate according to this behaviour for large but finite values of @xmath43 .    denoting @xmath224",
    "the distribution of the evanescent fields , one easily obtains the integral equation it obeys : @xmath225 moreover the logarithmic moments defined in eq .  ( [ eq_ibeta ] )",
    "have the following scaling in this limit , @xmath226",
    "plugging this equivalent in the expression ( [ eq_fbeta_i ] ) for the quenched free - energy , and identifying the maximal length of the circuits with the coefficient of order @xmath227 , and their entropy with the constant term , we obtain : @xmath228    the identity @xmath211 ( of which we present an alternative derivation in app .  [ app_lmax ] ) reproduces the conjecture of wormald ( conjecture 2.27 in  @xcite ) that random graphs with a minimum connectivity of 3 are , with high probability , hamiltonian .",
    "obviously the methods we used are far from rigorous and do not provide a valid proof of the conjecture .",
    "however they give it a quantitative flavour with the prediction of @xmath229 , the typical entropy of such hamiltonian circuits .",
    "we performed a numeric resolution of eq .",
    "( [ eq_rx ] ) , again by a population dynamics algorithm , to compute the moments @xmath230 and from them the quenched entropy @xmath229 . as an illustrative example , fig .",
    "[ fig_ex_3p4_ent_hamiltonian ] presents the results of such a computation in the case of random graphs with a fraction @xmath174 of degree 3 vertices , and @xmath231 of degree 4 . as a function of @xmath174",
    "the entropy interpolates between the rigorously known values at @xmath232 , @xmath233 , for which the graphs are regular .",
    "note that the quenched and annealed entropies , even if strictly different when @xmath234 , are found to be numerically close .",
    "for instance when @xmath235 , one has @xmath236 and @xmath237 .     of degree",
    "3 vertices , and @xmath231 of degree 4.,width=340 ]      let us now consider the question of the longest cycles in random graph ensembles with connectivity distribution @xmath114 which do not fulfill the condition @xmath221 we assumed in the previous subsection .",
    "we first present simple combinatorial arguments which lead to bounds on @xmath209 and to an asymptotic expansion when there are very few degree 2 sites in the 2 core , before coming back to the limit @xmath213 of the cavity approach .",
    "let us call @xmath238 a graph drawn at random from such an ensemble , and @xmath239 its 2-core , determined for instance by the leaf removal algorithm detailed in app .",
    "[ sec_app_leaf ] .",
    "@xmath239 has the connectivity distribution @xmath147 defined and computed in sec .",
    "[ sec_quenched ] and app .",
    "[ sec_app_leaf ] .",
    "the number of sites in the 2-core is @xmath240 ( cf .",
    "eq .  [ eq_lcore ] ) , with @xmath241 unless the original graph was deprived of any isolated sites and of leaves ( i.e. @xmath242 ) .",
    "this @xmath243 is clearly an upper bound on @xmath209 , as circuits can not be longer that the number of available sites in the 2-core .",
    "one can derive a lower bound on @xmath209 with the following reasoning . from @xmath239 , the 2-core of @xmath238 , eliminate recursively sites of degree 2 , identifying the two edges which were previously incident to it ( see fig .",
    "[ fig_elim_chain ] ) .",
    "when all sites of degree 2 have been removed , one ends up with a graph , call it @xmath244 , on @xmath245 sites , where the minimal connectivity is 3 . using the result of the previous section",
    ", this reduced graph typically contains circuits of length @xmath245 .",
    "each of the circuits of @xmath244 can be unambiguously associated to a circuit of @xmath239 , reinserting the edges which were simplified during the construction of @xmath244 .",
    "obviously the reconstructed circuits of @xmath239 are longer than the ones of @xmath244 , hence @xmath246 should be a lower bound for @xmath209 .",
    "these bounds have been used under a stronger form in the case of erdos - renyi random graphs very close to the percolation threshold ( for @xmath247 with @xmath248 ) in  @xcite .",
    "one can then wonder if the upper bound is saturated , in other words if the 2-core is hamiltonian .",
    "in general the answer is no , as explained by the following remark .",
    "consider a site of degree strictly greater than 2 , surrounded by at least three neighbors of degree 2 : obviously , no circuit can go through more than two of these neighbors .",
    "as soon as @xmath249 there will be an extensive number of such forbidden vertices , hence in such a case @xmath250 .",
    "the equality is possible only if @xmath251 , which was the case investigated in the previous section .",
    "note that the gap between the lower and upper bound closes when @xmath252 vanishes , as the 2-core becomes hamiltonian in this limit .",
    "a conjecture on the behaviour of @xmath209 in the limit @xmath253 can be formulated as @xmath254 this expression has a very simple interpretation : a forbidden site in the above argument appears if a vertex of degree greater than 3 is surrounded by at least three vertices of degree 2 . at the lowest order these forbidden sites",
    "are far apart from each other , @xmath210 is thus reduced by one unit each time this appears .",
    "this conjecture will come out of the cavity analysis of next subsection , we preferred to anticipate it here because of its simple combinatorial interpretation .     to @xmath244 ) used in sec .",
    "[ sec_binf_with].,width=264 ]    let us exemplify the bounds and the conjecture in two particular cases .",
    "consider ensemble of graphs where a fraction @xmath231 of vertices have degree @xmath255 , the others being of degree 2 , with @xmath256 .",
    "the above bounds and estimation read @xmath257    as a second example we consider poissonian random graphs of mean degree @xmath3 , for which the bounds read ( cf . eq .",
    "( [ eq_r_poisson ] ) ) @xmath258 where @xmath132 is the solution of @xmath259 . in the limit",
    "@xmath260 the fraction of degree 2 vertices in the 2-core vanishes , the above conjecture reads then @xmath261 where @xmath262 is some positive integer .",
    "most of these terms come from the expansion of @xmath243 , the only non - trivial one being @xmath263 .",
    "this is in agreement with a rigorous result of frieze  @xcite , @xmath264      we come back to the cavity approach and investigate the large @xmath43 limit in this case .",
    "the simple ansatz @xmath220 is not compatible with eqs .",
    "( [ eq_py],[eq_def_f ] ) any longer , because of the non vanishing value of @xmath265 .",
    "the most natural generalization which allows to close this set of equations is then @xmath266 , where @xmath67 is a relative integer ( hard field ) .",
    "we denote @xmath267 the probability distribution of the evanescent fields @xmath176 associated to hard fields @xmath67 . for notational simplicity",
    "we take the @xmath268 to be unnormalized , with @xmath269 , and impose the condition @xmath270 .",
    "expanding eqs .",
    "( [ eq_py],[eq_def_f ] ) with this ansatz , one finds @xmath271 in order to simplify the expression of @xmath272 and @xmath273 , we shall denote @xmath274 $ ] a permutation of the indices which orders the hard fields in decreasing order , @xmath275 } \\ge p_{[2 ] }",
    "\\ge \\dots p_{[k]}$ ] . then @xmath276},-p_{[2 ] } ) \\quad { \\rm for } \\ k \\ge 2 \\ .\\ ] ] we also define @xmath277 } + p_{[2 ] } < -1 \\\\ 1 + \\hat{d}_k(p_1,x_1,\\dots , p_k , x_k ) & { \\rm if } \\ p_{[1 ] } + p_{[2 ] } = -1 \\\\ \\hat{d}_k(p_1,x_1,\\dots , p_k , x_k ) & { \\rm if } \\ p_{[1 ] } + p_{[2 ] } > -1 \\end{cases } \\ , \\\\",
    "\\hat{d}_k(p_1,x_1,\\dots , p_k , x_k ) & = & \\begin{cases } \\underset{i < j |",
    "p_i = p_j = p_{[1]}}{\\sum } x_i x_j & { \\rm if }",
    "\\ p_{[1]}=p_{[2 ] } \\\\ x_{[1 ] } \\underset{i | p_i = p_{[2]}}{\\sum } x_i & { \\rm if } \\ p_{[1 ] } > p_{[2 ] } \\end{cases }   \\ , \\end{aligned}\\ ] ] in terms of which the evanescent contribution reads @xmath278}}{\\sum } x_i}{d_k(p_1,x_1,\\dots , p_k , x_k ) } \\quad { \\rm for }",
    "\\ k \\ge 2 \\ .\\ ] ] within this ansatz the logarithmic moments ( cf .",
    "( [ eq_ibeta ] ) ) behave as @xmath279 @xmath280}+p_{[2]},0 ) \\ , \\label{eq_jkh}\\ ] ] @xmath281 from the behaviour of @xmath188 we thus obtain @xmath282 obviously this set of expressions reduces to the ones of sec .  [ sec_binf_without ] when all the hard fields are null , which is a solution if and only if @xmath283 .",
    "let us first discuss the computation of @xmath209 .",
    "this quantity can be obtained from the distribution @xmath284 of the hard fields , independently of the evanescent ones .",
    "integrating away the evanescent fields in eq .",
    "( [ eq_vpx ] ) , one obtains : @xmath285 besides the population dynamics method , a faster and more precise method can be devised to solve this equation .",
    "let us for this purpose define @xmath286 , the integrated form of the distribution , and @xmath287 the generating function of the @xmath149 s : @xmath288 one can then rewrite eq .",
    "( [ eq_vp ] ) , after a few lines of computation based on the expression of @xmath289 , under the form @xmath290 it is easy to solve them numerically by iteration ( both @xmath291 and @xmath292 vanish exponentially fast when @xmath293 , a cutoff on @xmath67 can thus be safely introduced ) , and to deduce @xmath209 from the solution @xmath284 ( see eqs .",
    "( [ eq_jkh],[eq_lmax ] ) ) .",
    "we present the results of this procedure for poissonian graphs in the left panel of fig .",
    "[ fig_lmax_poissonian ] , along with the bounds discussed above .",
    "we now sketch the way to compute the expansion of @xmath209 stated in eq .",
    "( [ eq_lmax_expansion ] ) . in the limit @xmath294",
    ", the distribution @xmath284 tends to @xmath295 .",
    "a more precise inspection reveals that @xmath296 , @xmath297 for @xmath298 . in order to obtain eq .",
    "( [ eq_lmax_expansion ] ) , it is thus enough to find @xmath299 at order @xmath300 , in function of the connectivity distribution @xmath149 .",
    "the result follow by collecting the terms of order @xmath300 in eqs .",
    "( [ eq_jkh],[eq_lmax ] ) .",
    "this expansion could be in principle pursued at any higher order , at the price of more tedious computations .",
    "if one is not only interested in the length of the longest circuits , but also in the associated entropy @xmath212 , one has to solve the complete equation ( [ eq_vpx ] ) on the distribution of both hard and evanescent fields .",
    "this is easily done by a population dynamics algorithm , following population of couples @xmath301 , see the right panel of fig .",
    "[ fig_lmax_poissonian ] for the results in the poissonian case .",
    "however , when the value of @xmath265 is too large , there appears an instability in the resolution of eq .",
    "( [ eq_vpx ] ) . for",
    "the sake of definiteness let us consider the poissonian case and postpone a more general discussion to the next section .",
    "for values of @xmath3 larger than a critical value @xmath302 , the evanescent fields distributions converge , whereas below @xmath303 , the iteration brings some of them towards diverging or vanishing values .",
    "the origin of this instability can be traced back to the behaviour of the original messages @xmath125 at large but finite @xmath43 .",
    "a closer inspection of numerically obtained histograms of the @xmath125 s reveals that in this limit they indeed obey a scaling of the form @xmath266 , but @xmath67 is a relative integer only for @xmath304 . for lower connectivities , a continuously growing fraction of the hard fields",
    "are half - integers .",
    "this fraction reaches one at @xmath305 , below which all @xmath67 s are half - integers . if one allows the hard fields to be both integers and half - integers in eqs .",
    "( [ eq_vpx],[eq_jkh],[eq_jk ] ) , this instability problem is cured , which allowed us to obtain the ( dashed ) low connectivity part of the curves in fig .",
    "[ fig_lmax_poissonian ] .",
    "we shall come back in the next section on the interpretation of this phenomenon .",
    "( left ) and the associated quenched entropy ( right ) .",
    "dotted lines in the left panel are the bounds of eq .",
    "( [ eq_bounds_poissonian ] ) .",
    "the dashed part of the curves corresponds to the regime @xmath306 , where we expect the replica symmetry to be broken .",
    "the inset of the right figure shows a blow - up for small connectivities , the replica symmetric entropy presents a local maximum ( resp .",
    "minimum ) at @xmath307 ( resp .",
    "@xmath308 ) . , title=\"fig:\",width=302 ]   ( left ) and the associated quenched entropy ( right ) .",
    "dotted lines in the left panel are the bounds of eq .",
    "( [ eq_bounds_poissonian ] ) .",
    "the dashed part of the curves corresponds to the regime @xmath306 , where we expect the replica symmetry to be broken .",
    "the inset of the right figure shows a blow - up for small connectivities , the replica symmetric entropy presents a local maximum ( resp .",
    "minimum ) at @xmath307 ( resp .",
    "@xmath308 ) . , title=\"fig:\",width=302 ]",
    "the cavity computations we have presented so far were based on the assumption of replica symmetry ( rs ) , valid if the space of configurations is smooth enough . in disordered systems",
    "this assumption can be violated , we shall thus investigate its validity in the present model .",
    "more precisely , we consider the local stability of the rs ansatz in the enlarged space of one step replica symmetry breaking ( 1rsb ) order parameters  @xcite ( we leave aside the possibility of a discontinuous transition ) . in the 1rsb setting ,",
    "the messages @xmath125 are replaced by probability distributions @xmath309 over the states , and the recursion @xmath310 becomes @xmath311 where @xmath312 is a normalization constant , @xmath313 is the parisi 1rsb parameter , and @xmath314 is a reweighting factor whose explicit form is not needed here .",
    "the distributions @xmath180 are themselves drawn from a distribution over distributions , @xmath315 $ ] .",
    "the replica symmetric solution studied in the main part of the text is recovered by taking the distributions @xmath180 concentrated on a single value @xmath125 . to investigate its local stability ,",
    "one gives them an infinitesimal variance @xmath316 .",
    "expanding eq .",
    "( [ eq_1rsb ] ) in the limit of vanishing @xmath316 s , one obtains the following relation : @xmath317 for the rs solution to be stable against this perturbation , the variances of the 1rsb order parameters should decrease upon iterations of the above relation .",
    "this can be studied numerically for any random graph ensemble , by iterating the above relation on a population of couples @xmath318 , the value of @xmath97 being drawn from @xmath149 .",
    "the variances @xmath316 can be initially all taken to 1 ( note that eq .",
    "( [ eq_rsb_recur ] ) is linear in the @xmath316 s ) , in the course of the dynamics the @xmath316 s are periodically divided by a number @xmath319 , chosen each time to maintain the average value of @xmath316 constant . after a thermalization phase @xmath319 converges ( in order to gain numerical precision one computes the average over the iterations of @xmath320 ) , its limit being @xmath321 ( resp @xmath322 ) if the rs solution is unstable ( resp .",
    "this method , pioneered in the context of the instability of the 1rsb solution in  @xcite , can be replaced by the computation of the associated non - linear susceptibility , see for instance  @xcite .    for regular random graphs of connectivity @xmath3 , where all rs messages take the same value @xmath323 given in eq .",
    "( [ eq_y_regular ] ) , one can readily compute the value of the stability parameter , @xmath324 it is easy to check that @xmath325 when @xmath43 lies in its allowed range @xmath326 , confirming the validity of the rs ansatz .",
    "it would have been anyhow surprising to discover an instability in this case where the annealed computation is exact .",
    "another case which is analytically solvable is the limit @xmath327 ( i.e. @xmath190 ) .",
    "indeed , we have seen that the messages scales then as @xmath328 , and it turns out that @xmath329 , independently of the rescaled messages @xmath176 . recalling that @xmath330 , one finds @xmath331 in this limit : for any connectivity distribution , the rs ansatz is always stable in the small @xmath49 regime .",
    "all the numerical investigations of @xmath319 we conducted for ensembles with minimal connectivity 3 suggest that in this case the replica symmetric solution is stable for all values of @xmath43 .",
    "note that here the zero temperature limit of @xmath319 can be studied directly at the level of evanescent fields , as @xmath332 .",
    "we thus conjecture that the whole function @xmath104 computed with the rs cavity method is correct for these ensembles , and in particular the quenched entropy of hamiltonian circuits @xmath229 stated in eq .",
    "( [ eq_wormald_refined ] ) .",
    "the situation is less fortunate for poissonian graphs .",
    "the reader may have anticipated the appearance of non integer hard fields in the zero temperature limit for mean connectivities lower than @xmath303 as an hint of rsb .",
    "the datas presented in the left panel of fig .",
    "[ fig_sketch_sigma ] shows indeed that for small @xmath3 , the stability parameter @xmath319 crosses 1 when @xmath43 is increased above some finite value @xmath333 .",
    "this critical value of @xmath43 increases with the mean connectivity , and an educated guess makes us conjecture that it diverges at @xmath303 .",
    "the rightmost curve for @xmath158 shows indeed @xmath334 for all the values of @xmath43 we could numerically study .",
    "a precise extrapolation of @xmath333 turned out however to be rather difficult .",
    "note also that the study directly at @xmath335 is largely complicated here by the fact that the hard fields do not take a finite number of distinct values as is often the case in usual optimization problems  @xcite , but extend on the contrary on all relative integers . in summary ,",
    "the conjectured scenario is that at high enough connectivities the whole curve @xmath104 , and in particular its zero temperature limit , is correctly described by the rs computation . for lower connectivities there will be a critical length above which replica symmetry breaks down .",
    "we also believe that this scenario , sketched in the right part of fig .",
    "[ fig_sketch_sigma ] , is valid not only in the poissonian case , but for all families of random graph ensembles ( with a fastly decaying connectivity distribution ) with a control parameter which drives the graphs towards a continuous percolation transition , the fraction of degree 2 sites in the 2-core growing as the transition is approached .",
    "let us finally propose an interpretation for the occurrence of replica symmetry breaking for the largest circuits in presence of a large fraction of degree 2 sites in the 2 core , by relating it to an underlying extreme value problem  @xcite . in the discussion of sec .",
    "[ sec_bounds ] , one could indeed tag the edges @xmath11 of the reduced graph @xmath244 with a strictly positive integer , by counting the number of edges of @xmath239 which were collapsed onto @xmath11 .",
    "the length of a circuit of @xmath239 is thus the weighted length of the corresponding circuit of @xmath244 , i.e. the sum of the labels on the edges it visits .",
    "these weighted lengths are correlated random variables , because of the structural constraint defining a circuit : for a given graph @xmath244 , not all the sums of @xmath17 tags correspond to circuits of length @xmath17 .",
    "when the fraction of degree 2 site is small enough , these correlations are sufficiently weak for the rs ansatz to treat them correctly , when long chains of degree 2 vertices become too numerous they somehow pin the longest circuits , which cluster in the space of configurations and cause the replica symmetry breaking .     for poissonian random graphs , from left to right @xmath336 , @xmath337 , @xmath338 .",
    "right : sketched behaviour of the quenched entropy for generic families of random graphs . from top to bottom a control parameter drives the graphs towards a continuous percolation transition , the maximal length of the circuits is reduced . in the neighborhood of the percolation transition replica symmetry breaking takes place for large enough circuits , and should be taken into account to compute the dashed part of the curve . ,",
    "title=\"fig:\",width=302 ]   for poissonian random graphs , from left to right @xmath336 , @xmath337 , @xmath338 .",
    "right : sketched behaviour of the quenched entropy for generic families of random graphs . from top to bottom a control parameter drives the graphs towards a continuous percolation transition , the maximal length of the circuits is reduced . in the neighborhood of the percolation transition replica symmetry breaking takes place for large enough circuits , and should be taken into account to compute the dashed part of the curve .",
    ", title=\"fig:\",width=302 ]",
    "we present in this section the results of the numerical experiments we have conducted in order to check our analytical predictions .",
    "these experiments are based on the exhaustive enumeration algorithm of  @xcite which allows to generate all the circuits of a given graph @xmath1 , and in particular to compute the numbers @xmath22 of circuits of a given length .",
    "this algorithm runs in a time proportional to the total number of circuits , hence exponential in the size of the graphs for the cases we are interested in , which obviously puts a strong limitation on the sizes we have been able to study .",
    "let us begin with the investigation of the erds - rnyi ensembles @xmath339 and @xmath340 . in the former ,",
    "each of the @xmath341 potential edges between the @xmath6 vertices of the graph is present with probability @xmath67 , independently of each other , in the latter a set of @xmath8 among the @xmath341 edges is chosen uniformly at random . with @xmath342 and @xmath343 , these two ensembles are expected to be equivalent in the large - size limit . in particular the vertex degree distribution converges in both cases to a poisson law of mean @xmath3 , the cavity computation thus predicts that their typical properties should be the same in the thermodynamic limit .",
    "this is not true for the the annealed entropies @xmath344 which are easily computed exactly even at finite sizes , see app .",
    "[ sec_app_combinatorial ] , and which remain distinct in the thermodynamic limit . in the left part of fig .",
    "[ fig_sigmas_c3 ] we present the annealed and quenched entropies for both ensembles , computed from 10000 graphs of size @xmath345 and mean connectivity @xmath158 . the finite size",
    "quenched entropy has been estimated using the median of the random variables @xmath37 .",
    "the annealed entropies are very different in both ensembles ( and in perfect agreement with the computation of app .",
    "[ sec_app_combinatorial ] ) , and clearly different from the quenched ones .",
    "the striking feature of this plot is the almost perfect coincidence of the median in the two ensembles ; this was expected in the thermodynamic limit , but is already very clear at this moderate size . on the right panel of fig .",
    "[ fig_sigmas_c3 ] , the quenched entropy is plotted for two graph sizes , along with its extrapolated values in the thermodynamic limit , which agrees with the cavity computation .     and @xmath340 of mean connectivity @xmath158 , for graphs of size @xmath345 , computed from the mean and the median of @xmath37 on samples of 10000 graphs .",
    "right : the quenched entropy for @xmath340 at @xmath345 , and @xmath346 , symbols are the extrapolation in the limit @xmath44 from several values of @xmath6 , solid line is the replica symmetric cavity computation .",
    ", title=\"fig:\",width=302 ]   and @xmath340 of mean connectivity @xmath158 , for graphs of size @xmath345 , computed from the mean and the median of @xmath37 on samples of 10000 graphs .",
    "right : the quenched entropy for @xmath340 at @xmath345 , and @xmath346 , symbols are the extrapolation in the limit @xmath44 from several values of @xmath6 , solid line is the replica symmetric cavity computation .",
    ", title=\"fig:\",width=302 ]    as argued above , the difference between annealed and quenched entropies can be also seen in the exponentially larger value of the second moment of @xmath37 with respect to the square of the first moment .",
    "this fact is illustrated in fig .",
    "[ fig_2nd_moment ] , where the analytic computation of the ratio @xmath347 presented in app .",
    "[ sec_app_combinatorial ] is confronted with its numerical determination .     for @xmath340 at @xmath158 ,",
    "the symbols are numerically determined values which converge in the large size limit to the solid line , analytically computed in app .",
    "[ sec_app_combinatorial ] .",
    "right : finite size analysis for @xmath348 , solid line is a best fit of the form @xmath349 , where @xmath177 is constrained to its analytic value ( dashed line ) , and the form of the fit is justified in app .",
    "[ sec_app_combinatorial].,title=\"fig:\",width=302 ]   for @xmath340 at @xmath158 , the symbols are numerically determined values which converge in the large size limit to the solid line , analytically computed in app .",
    "[ sec_app_combinatorial ] .",
    "right : finite size analysis for @xmath348 , solid line is a best fit of the form @xmath349 , where @xmath177 is constrained to its analytic value ( dashed line ) , and the form of the fit is justified in app .",
    "[ sec_app_combinatorial].,title=\"fig:\",width=302 ]    we also considered the largest circuits in each graph , of length @xmath350 and degeneracy @xmath351 , and computed the averages @xmath352 and @xmath353 for various connectivities .",
    "their extrapolated values in the thermodynamic limit are compatible with the predictions @xmath209 and @xmath212 of the cavity method , within the numerical accuracy we could reach .",
    "this is true also for connectivities smaller than @xmath303 , where we argued above in favor of a violation of the replica symmetry hypothesis : the corrections due to rsb should be smaller than the numerical precision we reached .",
    "another set of experiments concerned uniformly generated graphs with an equal number of degree 3 and 4 vertices .",
    "we checked that the probability for such graphs to be hamiltonian converges to 1 when increasing their size .",
    "the values for the annealed and quenched entropies for the hamiltonian circuits are too close to be distinguished numerically .",
    "however the study of the ratio of the first two moments of @xmath354 ( see fig .  [ fig_2nd_moment_3p4 ] ) indicates that they should be strictly distinct in the thermodynamic limit .     for graphs with an equal fraction of degree 3 and 4 vertices .",
    "solid line is a best fit of the form @xmath349 , with @xmath355 , as found in app .",
    "[ sec_app_combinatorial].,width=302 ]",
    "let us summarize the main results presented in this paper .",
    "we have proposed an approximative counting algorithm that runs in a linear time with respects to the size of the graph .",
    "we also presented an heuristic method to compute the typical number of circuits in random graph ensembles , which yields a quantitative refinement of wormald s conjecture on the typical number of hamiltonian cycles in ensembles with minimal degree 3 ( eq .",
    "( [ eq_wormald_refined ] ) ) and a new conjecture on the maximal length of circuits in ensembles with a small fraction of degree 2 vertices in their 2 cores ( eq .  ( [ eq_lmax_expansion ] ) ) .",
    "several directions are opened for future work .",
    "first of all we believe that a rigorous proof of wormald s conjecture , which seems difficult to reach by variations around the second moment method , could be obtained by statistical mechanics inspired techniques . in recent years",
    "there has been indeed a series of mathematical achievements in the formalization of the kind of method used in this article .",
    "one line of research is based on guerra s interpolation method  @xcite , and culminated in talagrand s proof of the correctness of the parisi free - energy formula for the sherrington - kirkpatrick model  @xcite .",
    "these ideas have also been applied to sparse random graphs in  @xcite . alternatively the local weak convergence method of aldous  @xcite has been successfully applied to similar counting problems in random graphs  @xcite",
    ".    there has also been a recent interest  @xcite in the corrections to the bethe approximation for general graphical models .",
    "it would be of great interest to implement these refined approximations for the counting problem considered in this paper .",
    "this should lead on one hand to a more precise counting algorithm , and on the other hand give access to the finite - size corrections of the quenched entropy .",
    "we expect in particular that the difference between circuits and unions of vertex disjoint circuits will become relevant for these corrections .    the convergence in probability of @xmath356 expressed by eq .",
    "( [ eq_cvp ] ) can a priori be promoted to a stronger large deviation principle : according to the common wisdom , the finite deviations of this quantity from @xmath189 are exponentially small .",
    "a general method for computing these rate functions has been presented in  @xcite and could be of use in the present context",
    ". an interesting question could be to compute the exponentially small probability that a random graph is not hamiltonian in ensembles where typical graphs are so .    in the algorithmic perspective",
    ", one could try to take advantage of the local informations provided by the messages .",
    "in particular they could be useful to explicitly construct long cycles , in a `` belief inspired decimation '' fashion  @xcite : most probable edges in the current probability law would be recursively forced to be present , and the bp equations re - runned in the new simplified model .",
    "the neighborhood of the percolation transition should also be investigated more carefully , in particular the effects of replica - symmetry breaking onto the structure of the configuration space .",
    "the case of heavy - tailed ( scale - free ) degree distributions deserves also further work .",
    "the assumption of fast decay we made here is indeed crucial for some of our results : bianconi and marsili showed in  @xcite that scale - free graphs , even with a minimal connectivity of 3",
    ", can fail to have hamiltonian cycles . other random graph models ( generated by a growing process  @xcite , or incorporating correlations between vertex degrees  @xcite ) could also been investigated .",
    "let us finally mention two closely related problems which are currently studied with very similar means .",
    "circuits can be defined as a particular case of @xmath97-regular graphs , with @xmath357 . replacing the number of allowed edges around any site from 2 to @xmath97 in eq .",
    "( [ eq_wi ] ) , one can similarly study the number of @xmath97-regular subgraphs in random graph ensemble .",
    "the case @xmath358 corresponds to matchings , which was largely studied in the mathematical literature  @xcite and have been reconsidered by statistical mechanics methods in  @xcite .",
    "the appearance of @xmath359-regular subgraphs in random graphs was first considered in  @xcite , see  @xcite for a statistical mechanics treatment .",
    "we warmly thanks rmi monasson with whom the first steps of this work have been taken .",
    "we also acknowledge very useful discussions with ginestra bianconi , andrea montanari , andrea pagnani , federico ricci - tersenghi , olivier rivoire , martin weigt and lenka zdeborov .",
    "the work was supported by evergrow , integrated project no .",
    "1935 in the complex systems initiative of the future and emerging technologies directorate of the ist priority , eu sixth framework .",
    "we collect in this appendix the combinatorial arguments for the computation of the first and second moment of the number of circuits in various random graph ensembles .",
    "let us denote @xmath22 the number of circuits of length @xmath17 in a graph @xmath1 , and @xmath360 the set of circuits of length @xmath17 in the complete graph of @xmath6 vertices , its cardinality being @xmath361 indeed , choosing such a circuit amounts to select an ordered list of the @xmath17 vertices it will visit , modulo the orientation and the starting point of the tour .",
    "introducing @xmath362 the indicator function equal to @xmath363 if @xmath0 is a subgraph of @xmath1 , @xmath364 otherwise , we can write @xmath365 let us now describe the random graph ensembles we shall consider in the following .",
    "the first two are the classical erds - rnyi random graph ensembles . in @xmath339 ,",
    "each of the @xmath341 edges is present with probability @xmath67 , independently of the others . in @xmath340 ,",
    "a set of @xmath8 distinct edges is chosen uniformly at random among the @xmath341 possible ones .",
    "we shall concentrate on the thermodynamic limit @xmath44 , @xmath366 and @xmath343 with the mean connectivity @xmath3 kept finite . in this regime @xmath339 and @xmath340 are essentially equivalent : drawing at random from @xmath339 amounts to draw @xmath8 from a binomial distribution of parameters @xmath367 , and then drawing at random a graph from @xmath340 . in the limit described above",
    ", the number of edges in @xmath339 is weakly fluctuating around @xmath343 .",
    "moreover the degree of a given vertex in the graph converges in both cases to a poisson random variable of parameter @xmath3 .    for an arbitrary degree distribution @xmath114 of mean @xmath3",
    ", one can define the uniform ensemble of graphs obeying this constraint of degree distribution .",
    "a practical way of drawing a graph from this ensemble is the so - called configuration model  @xcite , defined as follows .",
    "each of the vertices is randomly attributed a degree , in such a way that @xmath368 vertices have degree @xmath97 ( we obviously skip some technical details  @xcite : @xmath114 should be a function of @xmath6 , such that @xmath368 is an integer ) . @xmath369",
    "half - links goes out of each vertex of degree @xmath97 .",
    "then one generates a random matching of the @xmath370 half - links and puts an edge between sites which are matched . in general",
    "one obtains in this way a multigraph , i.e. there appear edges linking one vertex with itself , or multiple edges between the same pair of vertices .",
    "however , discarding the non - simple graphs leads to an uniform distribution over the simple ones  @xcite . to compute averages over the graph ensemble",
    ", one can thus use the configuration model and condition on the multigraph to be simple . for clarity",
    "we shall denote @xmath371 the number of circuits in the unconditioned multigraph ensemble .",
    "note also that regular random graphs are a particular case of this ensemble , with @xmath372 .",
    "taking the average over the graphs of eq .",
    "( [ combin_def_n ] ) leads to @xmath373 for the ensembles we are considering , where the probability @xmath374 for a circuit @xmath375 to be present is independent of @xmath376 . before inspecting the various cases ,",
    "let us state the asymptotic behaviour of @xmath377 in the limit @xmath378 , @xmath47 finite , obtained with the stirling formula : @xmath379 in the first formula we have introduced the function @xmath380 .",
    "in @xmath339 the probability @xmath381 has a very simple expression , @xmath382 . the mean number of circuits thus reads @xmath383 where the first expression is valid for any @xmath384 , and the second one has been obtained in the thermodynamic limit with @xmath385 the annealed entropy for this first ensemble is : @xmath386 note that if @xmath387 , the algebraic prefactor in ( [ eq_er1_ann ] ) is slightly different , @xmath388    in @xmath340 the probability @xmath381 reads @xmath389 obviously this expression has a meaning only for @xmath390 , as there can not be circuits longer than the total number of edges .",
    "this gives an exact expression for @xmath391 for any @xmath6 and @xmath392 .",
    "the expansion in the thermodynamic limit with @xmath393 leads to @xmath394 with the annealed entropy @xmath395 again the different algebraic prefactor in ( [ eq_er2_ann ] ) can be easily computed also for @xmath396 .",
    "let us now make a few comments on these results .",
    "first , when @xmath397 , both annealed entropies are negative for all values of @xmath398 where they are well defined .",
    "consequently @xmath399 is exponentially small in the thermodynamic limit , and thanks to the so - called markov inequality ( or first moment method ) valid for positive integer random variables , @xmath400 \\le \\overline{{\\cal n}_l(g ) } \\ , \\ ] ] with high probability there are no circuits of extensive lengths in these graphs .",
    "this could be expected : the percolation transition occurs at @xmath5 , in this non percolated regime the size of the largest component is of order @xmath401 , and thus extensive circuits can not be present .",
    "as a second remark , let us note that for @xmath402 , the annealed entropy of the first ensemble is strictly positive for @xmath4030,\\ell_{\\rm a}(c)[$ ] , with @xmath404 an increasing function which reaches the value @xmath363 in @xmath405 .",
    "the average number of such circuits is in consequence exponentially large .",
    "however one can easily convince oneself that this can not be the typical behaviour .",
    "indeed , it turns out that @xmath404 is larger than the typical number of vertices in the 2-core of the graphs @xmath406 .",
    "when @xmath49 belongs to the interval @xmath107\\ell_{\\rm",
    "core}(c),\\ell_{\\rm a}(c)[$ ] , typically the graphs can not contain circuits of @xmath407 edges , however an exponentially small fraction of the graphs have 2-core larger than their typical sizes .",
    "these untypical graphs contribute with an exponential number of circuits to the annealed mean @xmath399 , which is in consequence not representative of the typical behaviour of the ensemble .",
    "finally , let us underline that the annealed entropies ( [ eq_er1_sigma],[eq_er1_sigma ] ) for the two ensembles are definitely different .",
    "for instance , in the second ensemble , the entropy is defined only for @xmath408 : the number of edges in the graph being fixed at @xmath117 , no circuits can be longer than the number of edges . on the contrary , in the first ensemble ,",
    "arbitrary large deviations of the number of edges from its typical value are possible , even if with an exponential small probability .",
    "the expectation of the number of circuits of length @xmath17 in the multigraph ensemble extracted with the configuration model was presented in  @xcite . for the sake of completeness and to make the study of the second moment simpler we reproduce the argument here . in this case one has @xmath409 where the sum is over @xmath410 positive integers constrained by @xmath411 , and we used the classical notation @xmath412 .",
    "the @xmath413 s are the number of sites of degree @xmath97 in the circuit , which are to be distributed among the @xmath368 sites of degree @xmath97 .",
    "the term @xmath414 accounts for the choice of the half links around each site , and finally the ratio of the double factorials is the probability that the matching of half - links contains the desired configuration . introducing the integral representation of the kronecker symbol , @xmath415 , where @xmath416 is a complex variable integrated along a closed path around the origin , this expression can be simplified in @xmath417 in the thermodynamic limit the integral",
    "can be evaluated by the saddle - point method , combining the expansion with the one of @xmath377 yields @xmath418 \\ ,   \\label{eq_sigmaa}\\end{aligned}\\ ] ] where here and in the following @xmath419 stands for equivalence upto subexponential terms , i.e. @xmath420 means @xmath421 as @xmath44 .    in the regular case",
    "one has @xmath422 from which the prefactors are more easily computed @xmath423 moreover the conditioning on the multigraph being simple can be explicitly done in the regular case  @xcite , thanks to the relative concentration of @xmath371 .",
    "this yields @xmath424 \\quad { \\rm for } \\",
    "0<\\ell \\le 1 \\ .\\ ] ] we checked that the numerical findings of  @xcite were in perfect agreement with these exact results .",
    "note that in the regular case , this conditioning modifies the value of @xmath425 only by a constant factor , thus the annealed entropy is the same in the graph and in the multigraph ensemble .",
    "it is not clear to us whether this fact should remain true for arbitrary connectivity distributions .",
    "we now turn to the computation of the second moment of the number of circuits , which has been inspired by  @xcite .",
    "taking the square of eq .",
    "( [ combin_def_n ] ) and averaging over the ensemble leads to @xmath426 we have indeed isolated the term @xmath427 in the sum , which is readily computed , from the off - diagonal terms .",
    "the last expression is more easily understood after having a look at fig .",
    "[ fig_union ] , where we sketched the shape of the union of two distinct circuits .",
    "this pattern is characterized by @xmath428 , the number of common paths shared by @xmath429 and @xmath430 , @xmath431 , the number of edges in these paths , and @xmath59 , the number of vertices which belongs to both circuits but are not neighbored by any common edge .",
    "one finds @xmath432 vertices at the extremities of the common paths , @xmath433 vertices in the interior of the common paths , hence @xmath434 vertices belong to both circuits , @xmath435 to none of them . in consequence the sum is over @xmath436 non - negative integers subject to the constraints : @xmath437 @xmath438 is the number of pairs of distinct circuits of the complete graph whose union has the characteristics @xmath439 , and @xmath440 is the ( ensemble - dependent ) probability that such pattern appears in a random graph .",
    "let us show that @xmath441 where the combinatorial factor @xmath442 is by convention set to @xmath363 .",
    "to construct such a pattern , one has to choose among the @xmath6 vertices those which are in @xmath429 but not in @xmath430 , in @xmath430 but not in @xmath429 ( both of these categories contain @xmath443 vertices ) , those in the common paths ( @xmath444 ) and those shared by the circuits but with no adjacent common edges ( @xmath59 ) .",
    "this can be done in @xmath445 distinct ways .",
    "let us call @xmath446 the number of common paths of @xmath12 edges , for @xmath447 , which obey the constraints @xmath448 and @xmath449 .",
    "the @xmath444 sites can be distributed into such an unordered set of unorientated paths in @xmath450 distinct ways .",
    "we have to sum this expression on the values of @xmath446 satisfying the above constraints . by picking up the coefficient of @xmath451 in @xmath452",
    "one finds that @xmath453 when @xmath454 this factor should be one , in agreement with the above convention .",
    "finally @xmath429 is formed by choosing an ordered list of the @xmath443 vertices which belongs only to it , the @xmath59 isolated common vertices , and of the @xmath428 orientated common paths , modulo the starting point and the global orientation of this tour , hence a factor @xmath455 and the same arises when constructing @xmath430 .",
    "( [ eq_combin_mlxyz ] ) is obtained by multiplying the various contributions .    in the thermodynamic limit with @xmath456",
    "kept finite , stirling formula yields @xmath457   \\ , \\\\",
    "m(l , x , y , z)&= & y - 2 \\ell +",
    "x\\ln 2 - 2 h(x ) + h(y ) - h(z ) - h(y - x ) \\nonumber \\\\ & + & 2 h(\\ell -y ) - 2 h(l - x - y - z ) - h(1- 2 \\ell + x+y+z ) \\ . \\label{eq_combin_m2}\\end{aligned}\\ ] ]     are on and above the horizontal central line , those of @xmath430 on and below . in this drawing @xmath458 ,",
    "@xmath459 , @xmath460 , @xmath461 , @xmath462.,width=302 ]      for both @xmath339 and @xmath340 ensembles , the probability @xmath440 depends only on the number of edges present in the union of the two circuits , @xmath463 . for the non trivial range of parameters @xmath464 where the first moment is exponentially large , the first term in eq .",
    "( [ eq_combin_2nd ] ) can be neglected .",
    "the sum over @xmath439 can be evaluated with the saddle - point method , yielding @xmath465 \\",
    ", \\quad \\tau(\\ell ) = \\underset{y}{\\max } [ p(2 \\ell -y ) + \\widehat{m}(\\ell , y ) ] \\ , \\ ] ] where @xmath466 and we introduced @xmath467 \\label{eq_m2 } \\ .\\end{aligned}\\ ] ] the range of parameters in the various optimizations are such that @xmath468 .",
    "the step between eqs .",
    "( [ eq_m1 ] ) and ( [ eq_m2 ] ) amounts to maximize @xmath313 over @xmath469 , which can be done analytically .",
    "it is then very easy to determine the function @xmath470 numerically .",
    "finally , defining @xmath471 , we determined numerically this function ( see fig .",
    "[ fig_2nd_moment ] ) and found that @xmath472 for all parameters such that @xmath473 : the second moment of @xmath22 is then exponentially larger than the square of the first moment , which forbids the use of the second moment method to determine the typical value of @xmath37 .      the computation of @xmath440 in the configuration model can be done similarly to the one of @xmath381 ( cf .",
    "( [ eq_combin_pl_arb ] ) ) . to simplify notations",
    "let us define @xmath474 , @xmath475 , and the multinomial coefficient @xmath476 for @xmath477 .",
    "we also use @xmath478 . with these conventions",
    "one finds @xmath479 indeed , @xmath480 ( resp .",
    "@xmath481 , @xmath59 ) is the number of vertices with two ( resp .",
    "three , four ) half - edges involved in the pattern , and @xmath482 the number of such vertices among the ones of degree @xmath97 . in consequence",
    "the sum is over non - negative integers with @xmath483 , @xmath484 , and @xmath485 , @xmath486 , @xmath487 .",
    "these last three constraints can be implemented using the complex integral representation of kronecker s delta , themselves evaluated by the saddle point method in the thermodynamic limit : @xmath488   \\ , \\\\",
    "p(\\ell , x , y , z ) & = & \\frac{1}{2 } h(c-4 \\ell + 2 y ) - \\frac{1}{2 } h(c ) + 2 \\ell -y + h(2 \\ell - 3x -y -2 z ) +",
    "h(2x ) + h(z ) + h(1 - 2\\ell+x+y+z ) \\nonumber \\\\ & + &   \\underset{\\theta_1,\\theta_2,\\theta_3}{{\\rm ext } } \\left [ \\sum_{k=2}^\\infty q_k \\ln(1 + ( k)_2 \\theta_1 + ( k)_3 \\theta_2 + ( k)_4 \\theta_3 ) - ( 2\\ell -3x - y -2x)\\ln \\theta_1 - 2x \\ln \\theta_2 - z",
    "\\ln \\theta_3 \\right ] \\ .",
    "\\nonumber\\end{aligned}\\ ] ] once this function has been determined for a given degree distribution , the exponential order of @xmath489 can be computed as @xmath490 \\",
    ", \\quad \\tau(\\ell ) = \\underset{x , y , z}{\\max } [ p(\\ell , x , y , z ) + m(\\ell , x , y , z ) ] \\ , \\ ] ] where @xmath313 is given in eq .",
    "( [ eq_combin_m2 ] ) .    in the regular case",
    ", the maximization over the 6 parameters can be performed analytically , and yields @xmath491  @xcite , proving the concentration ( at the exponential order ) of @xmath22 around its mean .",
    "we expect that for any ( fastly decaying ) connectivity distribution not strictly concentrated on a single integer , @xmath492 when @xmath493",
    ". a proof of this conjecture would be a quite painful exercise in analysis that we did not undertake .",
    "we however verified numerically this statement for the hamiltonian circuits of random graphs with an equal mixture of vertices of degree 3 and 4 , yielding @xmath494 .",
    "we have been rather loose in treating the algebraic prefactor hidden in @xmath419 for the various expressions of @xmath495 .",
    "however it is rather simple to determine the power of @xmath6 in this prefactor , collecting the contributions which arise from the stirling expansions , the transformation of sums into integrals , and the evaluation of the latter with the saddle point method .",
    "this leads to @xmath496 \\ , \\ ] ] as we observed numerically in sec .",
    "[ sec_enumerations ] .",
    "note also that some informations on the structure of the space of configurations can be obtained from this kind of computations .",
    "the average number of pairs of circuits at a given `` overlap '' ( number of common edges ) is indeed obtained from the second moment computations if the parameter @xmath125 is kept fixed .      in the statistical mechanics treatment of the main part of the text we used a model which counts the number @xmath497 of subgraphs of @xmath1 made of the union of vertex disjoint circuits of total length @xmath17 .",
    "we want to show in this appendix that , at the leading exponential order , the average of @xmath497 equals the one of @xmath22 in the various ensembles considered in this appendix .",
    "let us denote @xmath498 the set of subgraphs of the complete graph on @xmath6 vertices made of unions of vertex disjoint circuits of total length @xmath17 , and @xmath499 its cardinality .",
    "as such subgraphs are still made of @xmath17 edges connecting @xmath17 vertices , @xmath500 , where the probability @xmath381 is the one defined previously for the computation of @xmath22 .",
    "let us define @xmath501 the cardinality of the subset of @xmath498 where the subgraphs are made of @xmath502 disjoint circuits .",
    "a short reasoning leads to @xmath503 where the integers @xmath504 are the number of circuits of length @xmath12 in the subgraph . from this expression",
    "it is easy to check that @xmath505 , and that as long as @xmath502 is finite in the thermodynamic limit , @xmath506 .",
    "more precisely , one can show that the leading behaviour of @xmath507 is not modified by contributions with @xmath502 growing with @xmath6 .",
    "indeed , @xmath508\\",
    "\\exp\\left [ \\frac{1}{2}\\left ( \\frac{t^3}{3 } + \\dots \\frac{t^l}{l } \\right ) \\right ] \\ , \\ ] ] where @xmath509 f(t)$ ] denotes the coefficient of order @xmath176 in the series expansion of @xmath510 . evaluating the right hand side with the saddle point method",
    "when @xmath511 , one can conclude that @xmath512 and from the above remark @xmath513 .",
    "as far as annealed computations are concerned , the distinction between circuits of ( extensive ) length @xmath17 and union of disjoint circuits of total length @xmath17 does not modify the entropy .",
    "the hypothesis made in the main part of the text is that this remains true for the quenched computations .",
    "we want to justify in this appendix the geometric interpretation of the null messages elimination we gave in sec .",
    "[ sec_quenched ] .",
    "consider a random graph drawn uniformly among the ones with the connectivity distribution @xmath114 .",
    "the 2-core of a graph is the largest subgraph in which all vertices have connectivity at least two .",
    "it can be determined using the following leaf removal algorithm , which reduces iteratively the graph . at each time step , if there is at least one vertex of degree 1 , choose randomly one of them , and remove the unique edge to which it belongs .",
    "when there is no vertex of degree 1 , the algorithm stops . at this point",
    "either all the edges have been removed and one is left with @xmath6 isolated vertices , or there remains some isolated vertices and a subgraph in which all vertices have at least degree 2 , i.e. the 2-core of the initial graph .",
    "one can define more generally the @xmath41-core of a graph as the largest subgraph with minimal degree @xmath41 . for erds - rnyi random graphs ,",
    "the thresholds for the appearance of giant @xmath41-cores have been obtained in  @xcite .",
    "these results have been recently extended to random graphs with arbitrary connectivity distributions in  @xcite , this appendix can thus be viewed as an informal presentation of these mathematical works , with the emphasis put on the quantitative results instead of the mathematical rigor ( see also @xcite for an heuristic derivation in the arbitrary connectivity distributions case , and @xcite for new mathematical treatments of the problem ) . in the following we shall study the behaviour of the leaf removal algorithm through differential equations for the evolution of the average connectivity distribution along the execution of the leaf removal .",
    "this method is widely used in mathematics and computer science , see in particular @xcite for a general presentation , and a detailed derivation of the equations ( [ eq_dotr ] ) .",
    "we shall denote @xmath514 the number of steps ( elimination of one edge ) already performed by the algorithm , and @xmath515 the reduced time variable .",
    "let us call @xmath516 the average ( over the choice of the initial graph and the random decisions taken by the algorithm ) number of sites of connectivity @xmath97 in the residual graph obtained after @xmath517 time steps of the algorithm .",
    "the initial condition reads obviously @xmath518 . if one calls @xmath519 the probability that the neighbor of the selected degree 1 vertex has connectivity @xmath119 , the average evolution of the @xmath520 s during the time - step @xmath521 reads @xmath522 \\ . \\label{eq_rk}\\ ] ] to close this set of equations we have to express the offspring probabilities @xmath519 in terms of the connectivity distribution @xmath523 .",
    "as the graph is sequentially exposed by the algorithm , the residual graph at time @xmath524 is still uniformly distributed according to the connectivity distribution @xmath523 , hence @xmath525 in the last equality @xmath3 is the initial mean connectivity @xmath526 , which is reduced by @xmath527 at each time - step . in the thermodynamic limit",
    "the discrete time relations ( [ eq_rk ] ) become ordinary differential equations , @xmath528 where dotted quantities are derivatives with respects to time , and we introduced the notation @xmath529 .    for simplicity",
    "let us first assume the existence of a cutoff @xmath530 in the original distribution @xmath114 , @xmath531 for @xmath532 . as the leaf removal procedure never increases the connectivity of one site , this cutoff remains present in @xmath523 for all times .",
    "the equations of rank @xmath530 in the hierarchy ( [ eq_dotr ] ) is then closed on @xmath533 .",
    "using the fact that @xmath534 , it can be written as @xmath535 and easily integrated with the initial condition @xmath536 as @xmath537 now one can prove by a decreasing recurrence on @xmath97 from @xmath530 down to 2 that @xmath538 solves the hierarchy of equations ( [ eq_dotr ] ) .",
    "note also that the initial conditions @xmath539 are enforced by eq .",
    "( [ eq_solr ] ) as @xmath540 .",
    "once @xmath523 has been computed for @xmath541 , the equation on @xmath542 yields @xmath543 finally @xmath544 can be obtained from the normalization condition of the @xmath147 s .",
    "we introduced the cutoff @xmath530 to have an explicit starting point of the downwards recurrence on @xmath97 .",
    "however , the expression ( [ eq_solr ] ) formally solves the hierarchy of equations ( [ eq_dotr ] ) even for unbounded distributions @xmath114 , we shall therefore send the cutoff to infinity from now on , assuming that all the sums remain convergent .",
    "the 2-core is found when the leaf - removal algorithm stops , at the smallest time @xmath545 for which the number of degree 1 vertices vanishes , @xmath546 .",
    "this equation always admits @xmath547 as a solution ( the graph has then been emptied ) , however if there is a smaller solution the 2-core is non trivial and the algorithm stops before having removed all edges .",
    "calling @xmath548 , one obtains if @xmath549 : @xmath550 which is nothing but eq .  ( [ eq_eta ] ) on the fraction of non vanishing messages obtained in the main part of the text .",
    "the confirmation of the interpretation given in sec .",
    "[ sec_quenched ] follows easily :    * the number of edges in the 2-core is equal to the initial number of edges minus the number of steps performed by the algorithm before stopping , @xmath551 .",
    "* the distribution of the connectivities of the sites in the 2-core is @xmath552 , as expected from eq .",
    "( [ eq_r ] ) .    for completeness",
    "we also give the number of sites in the 2-core : @xmath553 as it should , this number is smaller than the size of the giant component , which reads  @xcite : @xmath554 moreover the fraction of sites which are in the giant component but out of the 2-core is proportional to @xmath555 .",
    "indeed , the corresponding edges bear exactly one non null directed message , in the formalism of sec .",
    "[ sec_quenched ] : if both messages were non null the edge would be in the 2-core , if both vanished the edge would be out of the giant component .",
    "this appendix presents , as a consistency check , another derivation of the identity @xmath211 for random graph ensemble with minimal connectivity of 3 . in the main part of the text ( sec .",
    "[ sec_binf_without ] ) , we obtained it by inspection on the behaviour of the free - energy in the large @xmath43 limit , because of the absence of hard fields .",
    "there exists however another expression of @xmath209 , in terms of the distribution of evanescent fields , obtained by taking the large @xmath43 limit in eq .",
    "( [ eq_lbeta ] ) : @xmath556 let us introduce the following functional of any probability distribution law @xmath502 , @xmath557(x ) = \\int_0^\\infty dx_1 \\ , a(x_1 ) \\dots dx_k \\ , a(x_k ) \\ , \\delta(x - h_k(x_1,\\dots , x_k ) ) \\ , \\ ] ] such that eq .",
    "( [ eq_rx ] ) can be rewritten in a compact way as @xmath558 $ ] , and a bilinear form on the space of probability distribution functions , @xmath559 consider now this form with its arguments being a distribution @xmath502 and its image through the functional @xmath560 : @xmath561 \\rangle = \\int_0^\\infty dx_0 \\ , a(x_0)\\ , dx_1 \\ , a(x_1 ) \\dots dx_k \\ , a(x_k )   \\frac{x_0 h_k(x_1,\\dots , x_k)}{1+x_0 h_k(x_1,\\dots , x_k ) } \\ .\\ ] ] the rational fraction in the integral can be transformed in the following way : @xmath562 both the denominator of this fraction and the integration measure @xmath563 being invariant under the permutations of the @xmath119 @xmath564 s , the integral can be computed by symmetrizing the numerator of the fraction .",
    "the normalization of @xmath502 then gives @xmath561 \\rangle = \\frac{2}{k+1 } \\ .",
    "\\label{eq_id_ps}\\ ] ] the proof of @xmath211 is now straightforward : @xmath565",
    "\\rangle \\ .\\ ] ] using the identity ( [ eq_id_ps ] ) and the relation between @xmath140 and @xmath41 ( cf .",
    "( [ eq_qtilde_q ] ) ) , @xmath209 is found to be the sum of @xmath114 for @xmath359 , and hence is equal to 1 by normalization .",
    "we also verified numerically that in presence of degree 2 vertices , and hence of non trivial hard fields , the limit of eq .",
    "( [ eq_lbeta ] ) which involves both evanescent and hard fields , coincide with the expression eq .",
    "( [ eq_lmax ] ) in terms of hard fields only .",
    "we believe this could be proved analytically , yet we did not find a simple way to do it ."
  ],
  "abstract_text": [
    "<S> we apply in this article ( non rigorous ) statistical mechanics methods to the problem of counting long circuits in graphs . </S>",
    "<S> the outcomes of this approach have two complementary flavours . on the algorithmic side </S>",
    "<S> , we propose an approximate counting procedure , valid in principle for a large class of graphs . on a more theoretical side , </S>",
    "<S> we study the typical number of long circuits in random graph ensembles , reproducing rigorously known results and stating new conjectures . </S>"
  ]
}