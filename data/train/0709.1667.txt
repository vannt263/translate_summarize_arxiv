{
  "article_text": [
    "an instance of a constraint satisfaction problem @xcite consists of @xmath1 variables @xmath2 and @xmath3 constraints among them .",
    "solving such an instance amounts to finding an assignment of the variables that satisfies all the constraints , or proving that no such assignment exists .",
    "a remarkable example in this class is provided by @xmath0-satisfiability , where variables are binary , @xmath4 , and each constraint requires @xmath0 of the variables to be different from a specific @xmath0-uple .",
    "explicitly , the @xmath5-th constraint ( clause ) , @xmath6\\equiv\\{1,\\dots , m\\}$ ] is specified by @xmath0 variable indexes @xmath7 $ ] , and @xmath0 bits @xmath8 .",
    "clause @xmath5 is satisfied by assignment @xmath9 if and only if @xmath10 .",
    "a constraint satisfaction problem admits a natural factor graph  @xcite representation , cf .",
    "[ fig : factor ] . given an instance",
    ", each variable can be associated to a variable node , and each constraint to a factor node .",
    "edges connect factor node @xmath11 $ ] to those variable nodes @xmath12 $ ] such that the @xmath5-th constraint depends in a non - trivial way on variable @xmath13 .",
    "for instance , in the case of @xmath0-satisfiability , clause @xmath5 is connected to variables @xmath14 .",
    "if the resulting graph is sparse , fast message passing algorithms can be defined on it .",
    "although constraint satisfaction problems are generally np - hard , a large effort has been devoted to the development of efficient heuristics .",
    "recently , considerable progress has been achieved in building efficient ` incomplete solvers ' @xcite .",
    "these are algorithms that look for a solution but , if they do not find one , can not prove that the problem is unsolvable .",
    "a particularly interesting class is provided by _ message passing - guided decimation _ procedures .",
    "these consist in iterating the following steps :    1 .",
    "run a message passing algorithm .",
    "2 .   use the result to choose a variable index @xmath15 , and a value @xmath16 for the corresponding variable .",
    "3 .   replace the constraint satisfaction problem with the one obtained by fixing @xmath13 to @xmath16 .",
    "the iteration may stop for two reasons . in the first case",
    "a contradiction is produced : the same variable @xmath13 appears in two constraints whose other arguments have already been fixed , and that are satisfied by distinct values of @xmath13 .",
    "if this does not happen , the iteration stops only when all the variables are fixed and a solution is found . notice that earlier algorithms , such as unit clause propagation ( ucp ) @xcite did not used message passing in step 2 , and were not nearly as effective .",
    "random constraint satisfaction problems are a useful testing ground for new heuristics . for instance , _ random @xmath0-satisfiability _ is the distribution over @xmath0-sat formulae defined by picking a formula uniformly at random among all the ones including @xmath3 clauses over @xmath1 variables . decimation procedures of the type sketched above proved particularly successful in this context . in particular _",
    "survey propagation_-guided decimation  @xcite outperformed the best previous heuristics based on stochastic local search @xcite .",
    "more recently _ belief propagation_-guided decimation was shown empirically to have good performances as well @xcite .",
    "unfortunately , so far there exists no analysis of message - passing guided decimation .",
    "our understanding almost entirely relies on simulations , even for random instances .",
    "consequently the comparison among different heuristics , as well as the underpinnings of their effectiveness are somewhat unclear . in this paper",
    "we define a simple class of randomized message passing - guided decimation algorithms , and present a technique for analyzing them on random instances .",
    "the technique is based on the identification of a process on infinite trees that describes the evolution of the decimation algorithm .",
    "the tree process is then analyzed through an appropriate generalization of density evolution @xcite .",
    "our approach is close in spirit to the one of  @xcite .",
    "while it applies to a large class of random constraint satisfaction problems ( including , e.g. coloring of random graphs ) , for the sake concreteness , we will focus on random @xmath0-sat .",
    "we expect the tree process to describe exactly the algorithm behavior in the limit of large instances , @xmath17 .",
    "while we could not prove this point , numerical simulations convincingly support this conjecture .",
    "further , non - rigorous predictions based on tree calculations have been repeatedly successful in the analysis of random @xmath0-satisfiability .",
    "this approach goes under the name of ` cavity method ' in statistical mechanics  @xcite .",
    "the paper is organized as follows .",
    "section [ sec : back ] contains some necessary background and notation on random @xmath0-sat as well as a synthetic discussion of related work . in section [ sec : decimation ]",
    "we define the decimation procedure that we are going to analyze .",
    "we further provide the basic intuition behind the definition of the tree model .",
    "the latter is analyzed in section [ sec : tree ] , and the predictions thus derived are compared with numerical simulations in section [ sec : numerical ] . finally , some conclusions and suggestions for future work are presented in section [ sec : conclusions ] .",
    "proofs of several auxiliary lemmas are omitted from this extended abstract and deferred to technical appendices .",
    "as mentioned above , _",
    "random @xmath0-sat _ refers to the uniform distribution over @xmath0-sat instances with @xmath3 constraints over @xmath1 variables .",
    "more explicitly , each constraint is drawn uniformly at random among the @xmath18 possible ones .",
    "we are interested here in the limit @xmath19 with @xmath20 fixed .",
    "consider the factor graph @xmath21 of a random @xmath0-sat formula , endowed with the graph - theoretic distance .",
    "namely , the distance of two variable nodes @xmath22 is the length of the shortest path leading from @xmath23 to @xmath24 on @xmath21 .",
    "it is well known @xcite that , in the large size limit , any finite neighborhood of a random node @xmath23 converges in distribution to a well defined random tree .",
    "this observation will be the basis of our tree analysis of the decimation process , and is therefore worth spelling it out in detail .",
    "let @xmath25 be the subgraph induced by all the vertices @xmath26 , such that @xmath27 .",
    "then @xmath28 as @xmath29 , where @xmath30 is the random rooted ( factor ) tree defined recursively as follows . for @xmath31",
    ", @xmath30 is the graph containing a unique variable node . for any @xmath32 , start by a single variable node ( the root ) and add @xmath33 clauses , each one including the root and @xmath34 new variables ( first generation variables ) . if @xmath35 , generate an independent copy of @xmath36 for each variable node in the first generation and attach it to them .",
    "the values @xmath37 that violate clause @xmath5 are independently chosen in @xmath38 with equal probability .",
    "it is easy to see that the limit object @xmath39 is well defined and is an infinite tree with positive probability if @xmath40 .",
    "we let @xmath41 be the largest value of @xmath42 such that random @xmath0-sat instances admit with high probability a solution .",
    "it is known  @xcite that @xmath43 .",
    "a sharp conjecture on the value of @xmath41 has been put forward in  @xcite on the basis of statistical physics calculations , implying @xmath44 , @xmath45 , @xmath46 for ( respectively ) @xmath47 and @xmath48 for large @xmath0  @xcite .",
    "simple heuristics have been analyzed thoroughly @xcite and proved to find a solution with probability bounded away from @xmath49 if @xmath50 . here",
    "the proportionality constant depends on the specific heuristic .    to the best of our knowledge ,",
    "the first application of message passing algorithms to @xmath0-satisfiability is reported in @xcite . in this early study bp",
    "was mostly applied in a _",
    "one - shot fashion _ ( as in iterative decoding of sparse graph codes @xcite ) , without decimation . by this",
    "we mean that belief propagation is run , and resulting marginal probabilities are used to guess the values of all variables at once .",
    "however the probability of success of the one - shot algorithm is exponentially small : there are @xmath51 isolated constraints , whose variables have non - trivial marginal probabilities , each of them is hence violated with finite probability in the one - shot assignment .    statistical mechanics methods allowed to derive a very precise picture of the solution set  @xcite .",
    "this inspired a new message passing algorithm dubbed _",
    "survey propagation _  @xcite . in conjunction with decimation , this algorithm allowed to solve random instances of unprecedentedly large sizes , in difficult regimes of @xmath42 and @xmath0 .    a natural way of introducing belief propagation for @xmath0-satisfiability is to consider the uniform distribution over solutions ( assuming their existence ) .",
    "let us denote by @xmath52 the set of variable nodes on which the @xmath5-th constraint effectively depends , for any subset @xmath53 of the variable nodes their partial assignment @xmath54 , and @xmath55 the indicator function of the event clause @xmath5 is satisfied. the uniform distribution over the solutions can thus be written @xmath56 in  @xcite it was proved that for @xmath57 $ ] , bp computes good approximations of the marginals of @xmath58 , irrespective of its initialization .",
    "it is clear from empirical studies  @xcite that the ` worst case ' argument used in this estimate ( and in other papers on belief propagation @xcite ) is far too pessimistic .    in ref .",
    "@xcite a simple message passing algorithm , warning propagation ( see below ) , was analyzed for a modified ( ` planted ' ) ensemble of random formulae .",
    "the algorithm was proved to converge and find solutions for large enough density @xmath42 ( see also  @xcite ) .",
    "both the ensemble and the algorithm are quite different from the ones treated in this paper .",
    "further , the definition and analysis of a ` maxwell decoder ' in  @xcite , is closely related to the approach in this paper .",
    "let us recall that the maxwell decoder was a ( mostly conceptual ) algorithm for implementing maximum likelihood decoding of ldpc codes over the erasure channel .",
    "the treatment in  @xcite applies almost verbatim to a simple constraint satisfaction problem known as xorsat .",
    "the generalization in the present paper is analogous to the one from the erasure to a general binary memoryless symmetric channel .",
    "finally , let us mention that bp decimation can be an interesting option in engineering applications , as demonstrated empirically in the case of lossy source coding @xcite .",
    "let us recall the definition of bp for our specific setup ( @xcite are general references ) .",
    "bp is a message passing algorithm : at each iteration messages are sent from variable nodes to neighboring clause nodes and vice versa . to describe the message update equations , we need some more notation . as in the case of factor nodes ,",
    "we shall call @xmath59 the set of factors that depends on the variable @xmath13 .",
    "if @xmath60 , say @xmath61 , we denote @xmath62 the value of @xmath13 which does not satisfy the @xmath5-th clause . for a pair of adjacent variable ( @xmath23 ) and factor ( @xmath5 ) nodes ( i.e. @xmath63 ) ,",
    "let us call @xmath64 ( resp .",
    "@xmath65 ) the set of factor nodes adjacent to @xmath23 , distinct from @xmath5 , that agrees ( resp .",
    "disagrees ) with @xmath5 on the satisfying value of @xmath13 . in formulae , @xmath66 and @xmath67 .",
    "it is convenient to use log - likelihood notations for messages as is done in iterative decoding @xcite , with two caveats : @xmath68 we introduce a factor @xmath69 to be consistent with physics notation ; @xmath70 the message from variable node @xmath23 to factor node @xmath5 corresponds to the log - likelihood for @xmath13 to satisfy / not - satisfy clause @xmath5 ( rather than to be @xmath71 ) .",
    "let @xmath72 , @xmath73 denote the messages that are passed at time @xmath74 along the directed edges @xmath75 and @xmath76 , for @xmath15 , and @xmath77 .",
    "the update equations read @xmath78 where we define the function @xmath79 as @xmath80 with @xmath81 ( this parameter is introduced for the discussion in sec .",
    "[ sec : numerical ] ) .    for @xmath15 ,",
    "let @xmath82 be the subset of clauses that are satisfied by @xmath83 , and @xmath84 the subset satisfied by @xmath85 .",
    "then the bp estimate for the marginal of @xmath13 under the measure @xmath86 is @xmath87 , where @xmath88      during the decimation procedure a subset @xmath53 of the variables are _ fixed _ to specific values , collectively denoted as @xmath89 .",
    "this has some",
    "_ direct implications_. by this we mean that for some other variables @xmath90 , @xmath91 , it follows from ` unit clause propagation ' ( ucp ) that they take the same value in all of the solutions compatible with the partial assignment @xmath89 .",
    "we will say that these variables are directly implied by the condition @xmath92 .",
    "let us recall that unit clause propagation corresponds to the following deduction procedure .",
    "for each of the fixed variables @xmath13 , and each of the clauses @xmath5 it belongs to , the value @xmath16 can either satisfy clause @xmath5 , or not . in the first case clause @xmath5",
    "can be eliminated from the factor graph . in the second a smaller clause with one less variable is implied . in both cases variable",
    "@xmath13 is removed .",
    "it can happen that the size of a clause gets reduced to @xmath93 , through this procedure . in this case",
    "the only variable belonging to the clause must take a definite value in order to satisfy it .",
    "we say that such a variable is directly implied by the fixed ones .",
    "whenever a variable is directly implied , its value can be substituted in all the clauses it belongs to , thus allowing further reductions .",
    "the process stops for one of two reasons : @xmath68 all the fixed or directly implied variables have been pruned and no unit clause is present in the reduced formula . in this case",
    "we refer to all variables that appeared at some point in a unit clause as _ directly implied _ variables . @xmath70",
    "two unit clauses imply different values for the same variable .",
    "we will say that a _ contradiction _ was revealed in this case : no solution @xmath9 of the formula can verify the condition @xmath92 .",
    "a key element in our analysis is the remark that ucp admits a message passing description .",
    "the corresponding algorithm is usually referred to as _ warning propagation _ ( wp )  @xcite .",
    "the wp messages ( to be denoted as @xmath94 , @xmath95 ) take values in @xmath96 .",
    "the meaning of @xmath97 ( respectively @xmath98 ) is : ` variable @xmath13 is ( resp . is not ) directly implied by clause @xmath5 to satisfy it . ' for variable - to - factor messages , the meaning of @xmath99 ( respectively @xmath100 ) is : ` variable @xmath13 is ( resp .",
    "is not ) directly implied , through one of the clauses @xmath101 , not to satisfy clause @xmath5 . '",
    "we want to apply wp to the case in which a part of the variables have been fixed , namely @xmath102 for any @xmath103 . in this case",
    "the wp rules read @xmath104 in the following we shall always assume that wp is initialized with @xmath105 , @xmath106 for each edge @xmath107 .",
    "it is then easy to prove that messages are monotone in the iteration number ( according to the ordering @xmath108 ) .",
    "in particular the wp iteration converges in at most @xmath109 iterations .",
    "we denote @xmath110 the corresponding fixed point messages , and say that @xmath111 is _ wp - implied _ by the fixed variables if there exist @xmath112 such that @xmath113 . then the equivalence between ucp and wp can be stated in the form below .",
    "assume a partial assignment @xmath89 to be given for @xmath114",
    ". then    1 .",
    "the fixed point wp messages @xmath110 do not depend on the order of the wp updates ( as long as any variable is updated an _ a priori _ unlimited number of times ) .",
    "2 .   @xmath111 is directly implied iff it is wp - implied .",
    "ucp encounters a contradiction iff there exists @xmath15 , @xmath115 , @xmath116 such that @xmath117 .    for",
    "the clarity of what follows let us emphasize the terminology of _ fixed _ variables ( those in @xmath53 ) and of _ directly implied _ variables ( not in @xmath53 , but implied by @xmath89 though ucp or wp ) . finally , we will call _ frozen _ variables the union of fixed and directly implied ones , and denote the set of frozen variables by @xmath118 .",
    "the bp - guided decimation algorithm is defined by the pseudocode of table [ tab : algo ] .",
    "ll + 1 : & initialize bp messages @xmath119 ; + 2 : & initialize wp messages @xmath120 ; + 3 : & initialize @xmath121 ; + 4 : & * for * @xmath122 + 5 : & run bp until the stopping criterion is met ; + 6 : & choose @xmath111 uniformly at random ; + 7 : & compute the bp marginal @xmath123 ; + 8 : & choose @xmath16 distributed according to @xmath124 ; + 9 : & fix @xmath125 and set @xmath126 ; + 10 : & run wp until convergence ; + 11 : & if a contradiction is found , * return * fail ; + 12 : & * end * + 13 : & * return * @xmath127 .",
    "+    there are still a couple of elements we need to specify .",
    "first of all , how the bp equations ( [ eq : bpupdate1 ] ) , ( [ eq : bpupdate2 ] ) are modified when a non - empty subset @xmath53 of the variables is fixed . one option would be to eliminate these variables from the factor graph , and reduce the clauses they belong to accordingly .",
    "a simpler approach consists in modifying eq .",
    "( [ eq : bpupdate1 ] ) when @xmath128 .",
    "explicitly , if the chosen value @xmath16 satisfies clause @xmath5 , then we set @xmath129 . if it does not , we set @xmath130 .",
    "next , let us stress that , while wp is run until convergence , a not - yet defined ` stopping criterion ' is used for bp .",
    "this will be precised in section [ sec : numerical ] .",
    "here we just say that it includes a maximum iteration number @xmath131 , which is kept of smaller order than @xmath109 .",
    "the algorithm complexity is therefore naively @xmath132 .",
    "it requires @xmath1 cycles , each involving : @xmath68 at most @xmath131 bp iterations of @xmath109 complexity and @xmath70 at most @xmath1 wp iterations of complexity @xmath109 .",
    "it is easy to reduce the complexity to @xmath133 by updating wp in sequential ( instead of parallel ) order , as in ucp .",
    "finally , natural choice ( corresponding to the assumption that bp converges exponentially fast ) is to take @xmath134 , leading to @xmath135 complexity .    in practice",
    "wp converges after a small number of iterations , and the bp updates are the most expensive part of the algorithm .",
    "this could be reduced further by using the fact that fixing a single variable should produce only a small change in the messages .",
    "@xcite uses this argument for a similar algorithm to argue that @xmath136 time is enough .      analyzing the dynamics of bp - decimation",
    "seems extremely challenging .",
    "the problem is that the procedure is not ` myopic ' @xcite , in the sense that the value chosen for variable @xmath13 depends on a large neighborhood of node @xmath23 in the factor graph . by analogy with myopic decimation algorithms",
    "one expects the existence of a critical value of the clause density @xmath137 such that the algorithm finds a solution with probability bounded away from @xmath49 for @xmath138 , while it is unsuccessful with high probability for @xmath139 .",
    "notice that , if the algorithm finds a solution with positive probability , restarting it a finite number of times should yield a solution with probability arbitrarily close to @xmath93 .",
    "we shall argue in favor of this scenario and present an approach to analyze the algorithm evolution for @xmath42 smaller than a _",
    "_ @xmath140 .",
    "more precisely , our analysis allows to compute the asymptotic fraction of ` directly implied ' variables after any number of iterations .",
    "further , the outcome of this computation provides a strong indication that @xmath141 . both the analysis , and the conclusion that @xmath141 are confirmed by large scale numerical simulations .",
    "our argument goes in two steps . in this section",
    "we show how to reduce the description of the algorithm to a sequence of ` static ' problems .",
    "the resolution of the latter will be treated in the next section .",
    "both parts rely on some assumptions on the asymptotic behavior of large random @xmath0-sat instances , that originate in the statistical mechanics treatment of this problem @xcite",
    ". we will spell out such assumptions along the way .    as a preliminary remark ,",
    "notice that the two message passing algorithms play different roles in the bp - decimation procedure of table [ tab : algo ] .",
    "bp is used to estimate marginals of the uniform measure @xmath86 over solutions , cf .",
    "( [ eq : uniform ] ) , in the first repetition of the loop . in subsequent repetitions ,",
    "it is used to compute marginals of the conditional distribution , given the current assignment @xmath142 .",
    "these marginals are in turn used to choose the values @xmath143 of variables to be fixed .",
    "wp is on the other hand used to check a necessary condition for the current partial assignment to be consistent .",
    "namely it checks if it induces a contradiction on directly implied variables .",
    "in fact , it could be replaced by ucp , and , in any case , it does not influence the evolution of the partial assignment @xmath144 .",
    "let us introduce some notation : @xmath145 is the order in which variables are chosen at step @xmath146 in the algorithm , @xmath147 the set of fixed variables at the beginning of the @xmath148-th repetition of the loop , and @xmath149 the frozen variables at that time ( i.e. the union of @xmath150 and the variables directly implied by @xmath151 ) .",
    "we begin the argument by considering an ` idealized ' version of the algorithm where bp is replaced by a black box , that is able to return the exact marginal distribution of the measure conditioned on the previous choices , namely @xmath152 .",
    "let us point out two simple properties of this idealized algorithm .",
    "first , it always finds a solution if the input formula is satisfiable ( this will be the case with high probability if we assume @xmath153 ) .",
    "in fact , assume by contradiction that the algorithm fails .",
    "then , there has been a last time @xmath154 , such that the @xmath0-sat instance has at least one solution consistent with the condition @xmath155 , but no solution under the additional constraint @xmath156 for @xmath157 .",
    "this can not happen because it would imply @xmath158 , and if this is the case , we would not have chosen @xmath159 in step @xmath160 of the algorithm .",
    "the second consequence is that the algorithm output configuration @xmath127 is a uniformly random solution .",
    "this follows from our assumption since @xmath161 therefore , the distribution of the state of the idealized algorithm after any number @xmath154 of decimation steps can be described as follows . pick a uniformly random solution @xmath127 , and a uniformly random subset of the variable indexes @xmath162 , with @xmath163 .",
    "then fix the variables @xmath164 to take value @xmath165 , and discard the rest of the reference configuration @xmath127 ( i.e. the bits @xmath166 for @xmath167 ) .",
    "we now put aside the idealized algorithm and consider the effect of fixing the @xmath154-th variable @xmath168 to @xmath169 .",
    "three cases can in principle arise : @xmath170 @xmath171 was directly implied to be equal to @xmath172 by @xmath173 and a contradiction is generated .",
    "we assume that bp is able to detect this direct implication and avoid such a trivial contradiction ; @xmath174 @xmath171 was directly implied to @xmath169 by @xmath173 .",
    "the set of frozen variables remains the same , @xmath175 , as this step is merely the actuation of a previous logical implication ; @xmath176 @xmath168 was not directly implied by @xmath173 .",
    "this is the only interesting case that we develop now .",
    "let us call @xmath177 the set of newly frozen variables after this fixing step .",
    "a moment of reflection shows that @xmath178 contains @xmath168 and that it forms a connected subset of @xmath179 in @xmath21 .",
    "consider now the subgraph @xmath180 induced by @xmath178 ( i.e. @xmath181 where @xmath182 is the set of factor nodes having at least one adjacent variable in @xmath178 , and @xmath183 is the set of edges between @xmath178 and @xmath182 ) . a crucial observation is the following :    if @xmath184 is a tree , no contradiction can arise during step @xmath154 .    from this lemma , and",
    "since the factor graph of a typical random formula is locally tree - like , one is naturally lead to study the size of @xmath178 , i.e. of the cascade of newly implied variables induced by fixing the @xmath154-th variable .",
    "if this size remains bounded as @xmath17 , then @xmath184 will typically be a tree and , consequently , contradictions will arise with vanishingly small probability during one step .",
    "if on the other hand the size diverges for infinitely large samples , then @xmath184 will contain loops and opens the possibility for contradictions to appear .    in order to compute the typical size of @xmath178",
    ", we notice that @xmath185 , and consider a @xmath154 of order @xmath1 , namely @xmath186 . if we let @xmath187 denote the fraction of frozen variables when a fraction @xmath188 of variables have been fixed , then under mild regularity conditions we have @xmath189 = \\frac{\\de\\phi(\\theta)}{\\de\\theta}\\ , . \\ ] ] of course @xmath190 will be an increasing function of @xmath188 .",
    "the argument above implies that , as long as its derivative remain finite for @xmath191 $ ] , then the algorithm finds a solution .",
    "when the derivative diverges at some point @xmath192 , then the number of direct implications of a single variable diverges as well .",
    "the spinodal point @xmath140 is defined as be the smallest value of @xmath42 such that this happens .",
    "the expectation in the definition of @xmath193 is with respect to the choices made by the real bp algorithm in the first @xmath194 steps , including the small mistakes it necessarily makes .",
    "our crucial hypothesis is that the location of @xmath140 does not change ( in the @xmath17 limit ) if @xmath193 is computed along the execution of the idealized decimation algorithm . in other words",
    "we assume that the cumulative effect of bp errors over @xmath1 decimation steps produces only a small bias in the distribution of @xmath127 .",
    "for @xmath195 this hypothesis is no longer consistent , as the real bp algorithm fails with high probability .    under this hypothesis , and recalling the description of the state of the idealized algorithm given above",
    ", we can compute @xmath193 as follows .",
    "draw a random formula on @xmath1 variables , a uniformly random ` reference ' solution @xmath127 , a subset @xmath53 of @xmath196 variable nodes limit one can equivalently draw @xmath53 by including in it each variable of @xmath179 independently with probability @xmath188 . ] .",
    "let @xmath197 be the probability that a uniformly random variable node @xmath23 is frozen , i.e. either in @xmath53 or directly implied by @xmath144",
    ". then @xmath198 . in the next section",
    "this computation will be performed in the random tree model @xmath30 of sec .",
    "[ sec : back ] .",
    "let us consider a @xmath0-satisfiability formula whose factor graph is a finite tree , and the uniform measure @xmath58 over its solutions ( which always exist ) defined in eq .",
    "( [ eq : uniform ] ) .",
    "it follows from general results  @xcite that the recursion equations  ( [ eq : bpupdate1],[eq : bpupdate2 ] ) have a unique fixed - point , that we shall denote @xmath199 .",
    "further the bp marginals @xmath200 , cf .",
    "( [ eq : bpmarginal ] ) , are the actual marginals of @xmath58 . drawing a configuration @xmath9 from the law @xmath58 is most easily done in a recursive , broadcasting fashion .",
    "start from an arbitrary variable node @xmath23 and draw @xmath13 with distribution @xmath124 .",
    "thanks to the markov property of @xmath58 , conditional on the value of @xmath13 , @xmath201 can be generated independently for each of the branches of the tree rooted at @xmath23 .",
    "namely , for each @xmath202 , one draws @xmath203 from @xmath204 here @xmath205 is a normalization factor and @xmath206 denotes the marginal of the variable @xmath13 in the amputated factor graph where factor node @xmath5 has been removed ( this is easily expressed in terms of the message @xmath207 ) . once all variables @xmath24 at distance @xmath93 from @xmath23 have been generated , the process can be iterated to fix variables at distance @xmath208 from @xmath23 , and so on .",
    "it is easy to realize that this process indeed samples a solution uniformly at random .    following the program sketched in the previous section",
    ", we shall study the effect of fixing a subset of the variables to the value they take in one of the solutions .",
    "we first state the following lemma .",
    "suppose @xmath53 is a subset of the variables of a tree formula , and let @xmath127 be a uniformly random solution .",
    "the probability that a variable @xmath209 is directly implied by @xmath89 reads @xmath210 where the new messages @xmath211 are solutions of @xmath212    we consider now a random tree factor graph and a random set of fixed variables @xmath53 .",
    "consider a random tree formula @xmath30 obtained from the construction of section [ sec : back ] , and a random subset @xmath53 of its variable nodes defined by letting @xmath213 independently with probability @xmath188 for each @xmath24 .",
    "finally , let @xmath127 be a uniformly random solution of @xmath30 .",
    "then the probability that the root of @xmath30 is frozen ( either fixed or directly implied by @xmath89 ) is @xmath214 \\ , \\label{eq : phi_ell_tree}\\ ] ] where @xmath215 $ ] denotes expectation with respect to the distribution of @xmath216 .",
    "this is a ( vector ) random variable defined by recurrence on @xmath217 as @xmath218 with initial condition @xmath219 with probability 1 . in this recursion @xmath220 and",
    "@xmath221 are two independent poisson random variables of parameter @xmath222 , @xmath223 is a random variable equal to @xmath49 ( resp .",
    "@xmath93 ) with probability @xmath188 ( resp .",
    "@xmath224 ) , the @xmath225 and @xmath226 are independent copies of , respectively , @xmath227 and @xmath216 .    to obtain a numerical estimate of the function @xmath228 we resorted to sampled density evolution ( also called ` population dynamics ' in the statistical physics context @xcite ) , using samples of @xmath229 elements and @xmath230 as a working example , see fig .",
    "[ fig : phi_of_eta ] . for small values of @xmath42",
    ", @xmath231 is smoothly increasing and slightly larger than @xmath188 .",
    "essentially all frozen variables are fixed ones , and very few directly implied variables appear .",
    "moreover the maximal slope of the curve is close to 1 , implying that the number of new frozen variables at each step , @xmath178 , remains close to 1 .",
    "as @xmath42 grows , @xmath231 becomes significantly different from @xmath188 , and the maximal slope encountered in the interval @xmath232 $ ] gets larger . at a value @xmath233",
    "the curve @xmath231 acquires a vertical tangent at @xmath234 , signaling the divergence of the size of the graph of newly implied variables .",
    "density evolution gives us @xmath235 , with an associated value of @xmath236 .",
    "for @xmath237 the curve @xmath231 has more than one branch , corresponding to the presence of multiple fixed points for @xmath238 $ ] . in analogy with @xcite",
    ", we expect the evolution of the algorithm to be described by picking ( for each @xmath188 ) the lowest branch of @xmath231 .",
    "the resulting curve has a discontinuity at @xmath239 , which is a slowly decreasing function of @xmath42 .",
    "we expect the tree computation to provide the correct prediction for the actual curve @xmath193 ( i.e. @xmath240 ) for a large range of the satisfiable regime , including @xmath241 $ ] . as a consequence ,",
    "we expect @xmath242 and bp decimation to be successful up to @xmath140 .",
    "similar tree computations are at the basis of a number of statistical mechanics computations in random @xmath0-sat and have been repeatedly confirmed by rigorous studies .",
    "the relation between tree and graph can be formalized in terms of aldous  @xcite local weak convergence method . fix a finite integer @xmath217 and consider the finite neighborhood @xmath243 of radius @xmath217 around an arbitrarily chosen variable node of an uniformly drawn factor graph @xmath21 on @xmath1 variables .",
    "denote by @xmath244 the law of @xmath245 when @xmath9 is a uniformly random solution .",
    "we proceed similarly in the random tree ensemble .",
    "draw a random tree @xmath246 with @xmath247 , let @xmath30 its first @xmath217 generations , and @xmath248 the distribution of @xmath249 .",
    "considerations building on the field of statistical mechanics of disordered systems leads to the following hypothesis .",
    "there exists a sequence @xmath250 such that @xmath251 for all @xmath252 , i.e. @xmath253 and @xmath254 have the same weak limit .",
    "a precise determination of @xmath250 was presented in  @xcite , yielding @xmath255 for , respectively , @xmath256 , and @xmath257 at large @xmath0 .",
    "local weak limits of combinatorial models on random graphs were recently considered in  @xcite . for a generalized conjecture in the regime",
    "@xmath258 $ ] see @xcite .",
    "a slightly stronger version of this conjecture would imply that @xmath259 .",
    "as a consequence ( following the discussion in previous section ) the tree model would correctly describe the algorithm evolution .",
    "in order to test the validity of our analysis we performed numerical simulations of the pseudo - code of table [ tab : algo ] . let us give a few further details on its implementation .",
    "the bp messages are stored as @xmath260 .",
    "ambiguities in the update rule ( [ eq : bpupdate2 ] ) arises when @xmath261 with @xmath262 and @xmath263 . because of numerical imprecisions this situation can occur even before a contradiction has been detected by wp ;",
    "such ambiguities are resolved by recomputing the incoming messages @xmath264 using the regularized version of eq .",
    "( [ eq : fdefinition ] ) with a small positive value of @xmath265 ( in practice we used @xmath266 ) .    as for the stopping criterion used in step 5 ,",
    "we leave the bp iteration loop if either of the two following criteria is fulfilled : @xmath68 , @xmath267 , i.e. bp has converged to a fixed - point within a given accuracy ; @xmath70 a maximal number of iterations @xmath131 fixed beforehand has been reached .",
    "in our implementation we took @xmath268 and @xmath269 .    a first numerical check is presented in fig .",
    "[ fig : phi_of_eta ] .",
    "the two dashed curves represent the fraction of frozen variables along the execution of the bp guide decimation algorithm , for two formulas of the @xmath270-sat ensemble , of moderate size ( @xmath271 ) .",
    "the first formula had a ratio of constraints per variable @xmath272 . in agreement with the picture obtained from the analytical computation , the algorithm managed to find a solution of the formula ( no contradiction encountered ) and",
    "the measured fraction of frozen variables follows quite accurately the tree model prediction .",
    "the second formula was taken in the regime @xmath273 . the algorithm halted because a contradiction was found , after roughly the fraction @xmath192 ( computed from the tree model ) of variables has been fixed . the portion of the curve before this event exhibits again a rather good agreement between the direct simulation and the model .",
    "figure [ fig : bpconvprob ] shows the probability of success of bp decimation in a neighborhood of @xmath274 for random formulae of size @xmath275 , @xmath276 , @xmath277 .",
    "each data point is obtained by running the algorithm on @xmath276 to @xmath278 formulae .",
    "the data strongly suggest that the success probability is bounded away from @xmath49 for @xmath279 , in agreement with our argument .    finally , in figure [ fig : halttime ] we consider the number of variables @xmath280 fixed by bp decimation before a contradiction is encountered . according to the argument in section [ sec : intuitive ]",
    ", @xmath281 should concentrate around the location @xmath192 of the discontinuity in @xmath193 .",
    "this is in fact the point at which the number of variables directly implied by a fixed one is no longer bounded .",
    "the comparison is again encouraging .",
    "notice that for @xmath279 we do not have any prediction , and the estimate of @xmath280 concerns only a small fraction of the runs .    to summarize , our simulations support the claim that , for @xmath279 the success probability is strictly positive and the algorithm evolution follows the tree model . for @xmath282",
    "the main failure mechanism is indeed related to unbounded cascades of directly implied variables , after about @xmath283 steps .",
    "let us conclude by highlighting some features of this work and proposing some directions for future research .",
    "it is worth mentioning that , as was also found in  @xcite , random 3-sat has a qualitatively different behavior compared to random @xmath0-sat with @xmath284 .",
    "in particular we did not found any evidence for the existence of a vertical tangent point in the @xmath285 function @xmath193 in the regime we expect to control through the tree computation , namely @xmath286 .",
    "our analysis suggests that bp guided decimation is successful with positive probability for @xmath287 .",
    "further we argued that this threshold can be computed through a tree model and evaluated via density evolution . despite these conclusions are based on several assumptions , it is tempting to make a comparison with the best rigorous results on simple decimation algorithms . for @xmath230",
    "the best result was obtained by frieze and suen  @xcite who proved scb ( shortest clause with limited amount of backtracking ) to succeed for @xmath288 .",
    "this is far from the conjectured threshold of bp decimation that is @xmath289 . for large @xmath0",
    ", an asymptotic expansion suggests that @xmath290 whereas scb is known from  @xcite to reach clause densities of @xmath291 , with @xmath292 as @xmath293 . a rigorous version of our analysis would lead to a constant factor improvement . on the other hand ,",
    "the quest for an algorithm that provably solves random @xmath0-sat in polynomial time beyond @xmath294 , is open .    from a practical point of view the decimation strategy studied in this paper",
    "is not the most efficient one . a seemingly slight modification of the pseudo - code of table  [ tab : algo ] consists in replacing the uniformly random choice of the variable to be fixed , privilegiating the ones with the most strongly biased marginals .",
    "the intuition for this choice is that these marginals are the less subject to the small errors of bp .",
    "the numerical results reported in  @xcite suggest that this modification improves significantly the performances of the decimation algorithm ; unfortunately it also makes its analysis much more difficult .",
    "this work was partially supported by evergrow , integrated project no .",
    "1935 in the complex systems initiative of the future and emerging technologies directorate of the ist priority , eu sixth framework .",
    "f.  krzakala , a.  montanari , f.  ricci - tersenghi , g.  semerjian and l.  zdeborova , `` gibbs states and the set of solutions of random constraint satisfaction problems , '' proc .",
    "104 ( 2007 ) 10318 - 10323 .",
    "f. altarelli , r. monasson and f. zamponi , `` can rare sat formulae be easily recognized ?",
    "on the efficiency of message - passing algorithms for k - sat at large clause - to - variable ratios '' , j. phys .",
    "a : math . theor .",
    "* 40 * , 867 - 886 ( 2007 ) .",
    "the statement is completely analogous to the equivalence between message passing and peeling versions of erasure decoding for ldpc codes @xcite .",
    "since the proof follows the same lines as well , we will limit ourselves to sketch its main points .",
    "\\1 ) let @xmath297 and @xmath298 be two fixed points of wp . then @xmath299 is a fixed point as well .",
    "it follows that the ` minimal ' fixed point is well defined and that it coincides with the limit of @xmath300 irrespective of the order of wp updates .",
    "\\2 ) consider the ordering @xmath301 according to which variables are declared as directly implied within ucp . for each @xmath302",
    "there is at least one unit clause involving only variable @xmath303 before this was declared .",
    "call this @xmath304 . then use the same update order for wp , namely update , in sequence message @xmath305 , and all the messages @xmath306 for @xmath307 .",
    "it is immediate to show that this leads to a fixed point , and the resulting wp - implied variables coincide with the directly implied variables . the proof is completed by using point @xmath93 .",
    "\\3 ) consider the same ordering of variables used in point 2 above .",
    "if there exists @xmath15 , @xmath308 , @xmath116 as in the statement , then ucp must have reduced both clauses @xmath5 and @xmath309 to a unit clause involving @xmath13 and requiring it to take different values .",
    "viceversa if ucp produces such a situation , in the wp updates @xmath310 after some time @xmath74 .      first of all the only wp messages changing from step @xmath311 to step @xmath154 ( call these the ` new ' messages ) are the ones on the edges of the tree @xmath184 , and directed outwards . as a consequence , no contradiction can arise because of two contradicting new messages , because no variable node has two incoming new messages",
    ".    there could be , in line of principle , a contradiction between a new and an old message .",
    "the crucial observation is that indeed any factor node in @xmath182 has at most two adjacent variable nodes in @xmath178 ( because otherwise if could not ` transmit ' an implication ) .",
    "if a variable node @xmath23 already receives some @xmath312 message at time @xmath311 from clause @xmath5 , then it can not receive any new message at time @xmath154 from a different clause @xmath309 .",
    "this because the message @xmath313 must already be @xmath312 , and therefore clause @xmath309 is already effectively ` reduced ' .",
    "since we are dealing with a tree graph , equations ( [ eq : ud_to_hd_single],[eq : hd_to_ud_single ] ) admit a unique solution , determined from the boundary condition @xmath314 ( resp .",
    "@xmath315 ) if @xmath23 is a leaf in @xmath53 ( resp . a leaf outside of @xmath53 ) . the newly introduced messages have the following interpretation .",
    "imagine running wp , cf .",
    "( [ eq : wpupdate1 ] ) , ( [ eq : wpupdate2 ] ) to find which variables are directly implied by @xmath144 .",
    "then @xmath316 is the probability that @xmath317 when @xmath144 is drawn conditional on @xmath90 satisfying @xmath5 .",
    "further , @xmath318 is the probability that @xmath319 when @xmath144 is drawn conditional on @xmath90 not satisfying clause @xmath5 .    now , suppose @xmath13 has been fixed to @xmath16 drawn according to its marginal ( hence the two terms in eq .",
    "( [ eq : proba_frozen_single ] ) ) and a configuration @xmath9 has been generated conditional on @xmath13 , through the broadcast construction .",
    "then the configuration of the variables in @xmath53 is retained , @xmath320 , and the rest of @xmath127 is discarded . the status ( directly implied or not ) of @xmath13",
    "is read off from the values of the messages @xmath321 it receives .",
    "it is easy to convince oneself that @xmath13 can not be implied to take the value opposite to the one it took at the beginning of the broadcasting : by definition @xmath89 is compatible with it",
    ". equation ( [ eq : proba_frozen_single ] ) follows by computing the probability that at least one of the messages @xmath322 is equal to @xmath312 among the ones from clauses @xmath5 that are satisfied by @xmath16 .",
    "equation ( [ eq : ud_to_hd_single ] ) is derived by applying the same argument to the branch of the tree rooted at @xmath24 and not including factor node @xmath5 . finally , to derive eq .",
    "( [ eq : hd_to_ud_single ] ) notice that , in order for variable @xmath323 to be directly implied to satisfy clause @xmath5 , each of the variables @xmath324 must be implied by the corresponding subtree not to satisfy @xmath5 . from the above remark , this can happen only if none of the @xmath325 satisfies @xmath5 .",
    "the probability of this event is easily found from ( [ eq_broadcast ] ) to be @xmath326    denote by @xmath327 the root of @xmath30 .",
    "conditional on the realization of the tree and of the set @xmath53 , the probability of a direct implication of the root is obtained by solving ( [ eq : bpupdate1 ] ) , ( [ eq : bpupdate2 ] ) , ( [ eq : ud_to_hd_single ] ) , ( [ eq : hd_to_ud_single ] ) for the edges directed towards the root , which leads to couples of messages @xmath328 and @xmath329 along the edges of @xmath30 . since @xmath30 and @xmath53 are random these couples of messages are random variables as well .",
    "we claim that for @xmath32 , the messages @xmath330 sent to the root of @xmath30 by the adjacent constraint nodes are distributed as @xmath227 .",
    "similarly for @xmath331 , @xmath216 has the distribution of the messages sent from the first generation variables to their ancestor constraint node in a random @xmath332 .",
    "this claim is a direct consequence of eqs .",
    "( [ eq : bpupdate1 ] ) , ( [ eq : bpupdate2 ] ) , ( [ eq : ud_to_hd_single ] ) , ( [ eq : hd_to_ud_single ] ) and of the definition of @xmath30 and @xmath53 .",
    "the random variables @xmath333 have , for instance , the distribution of the cardinalities of @xmath334 for an arbitrary edge of the random tree , as @xmath335 and unsatisfying values @xmath336 of the variables are chosen independently with equal probability .    finally the expression of @xmath337 is obtained from ( [ eq : proba_frozen_single ] ) by noting that the cardinalities of @xmath338 for the root of @xmath30 are distributed as the ones of @xmath334 and using the global symmetry between @xmath339 and @xmath340 , which implies that on average the two terms of ( [ eq : proba_frozen_single ] ) yield the same contribution .",
    "note that the dependence on @xmath188 of @xmath341 arises through the distribution of @xmath216 , the bias of the coin @xmath223 used in ( [ eq : uud_to_hhd ] ) being @xmath188 .",
    "the numerical procedure we followed in order to determine @xmath337 amounts to approximating the distribution of the random variable @xmath227 by the empirical distribution of a large sample of couples @xmath342 .",
    "a sample @xmath343 is then generated according to eq .",
    "( [ eq : uud_to_hhd ] ) : for each @xmath344 $ ] one draws two poisson random variables @xmath220 and @xmath221 , @xmath345 indexes @xmath346 uniformly in @xmath347 $ ] , and a biased coin @xmath223",
    ". the @xmath24-th element of the sample is thus computed as @xmath348 subsequently the sample @xmath349 is updated from @xmath350 by a similar interpretation of eq .",
    "( [ eq : hhd_to_uud ] ) .",
    "after @xmath217 iterations of these two steps , starting from the initial configuration @xmath351 for all @xmath352 $ ] , the estimate of @xmath337 is given by @xmath353 when @xmath217 gets large this quantity is numerically found to converges to a limit we denoted @xmath231 .",
    "consider the function @xmath354 defined , for @xmath232 $ ] , as the smallest solution in @xmath355 $ ] of the equation @xmath356 \\right ) \\ .",
    "\\label{eq : hphi}\\ ] ] it can be shown that @xmath354 is a smoothly increasing function of @xmath188 as long as @xmath357 , while for larger values of @xmath42 a discontinuous jump develops in its curve .",
    "this threshold can be explicitly computed and reads @xmath358 we believe this simple to determine function @xmath354 to be equivalent to the true @xmath193 in the large @xmath0 limit , up to exponentially small in @xmath0 corrections .",
    "in fact ( [ eq : phi_ell_tree],[eq : uud_to_hhd],[eq : hhd_to_uud ] ) implies the following exact equation , @xmath359 = \\theta + ( 1-\\theta )   \\left(1 - \\exp\\left[-\\frac{\\alpha k}{2^k } \\phi(\\theta)^{k-1 } \\right ] \\right )   \\ , \\label{eq : hd_exact}\\ ] ] where the expectation is taken in the @xmath360 limit . for large values of @xmath0 one can show the random variable @xmath361 to be exponentially close to @xmath49 , hence @xmath193 and @xmath362 $ ]",
    "coincide at the leading order , and by comparing ( [ eq : hphi ] ) and ( [ eq : hd_exact ] ) they also coincide with @xmath354 . the conjecture stated in eq .",
    "( [ eq : conj_thr ] ) was obtained by expanding ( [ eq : halpha ] ) at the leading order ."
  ],
  "abstract_text": [
    "<S> message passing algorithms have proved surprisingly successful in solving hard constraint satisfaction problems on sparse random graphs . in such applications , variables are fixed sequentially to satisfy the constraints . </S>",
    "<S> message passing is run after each step . </S>",
    "<S> its outcome provides an heuristic to make choices at next step . </S>",
    "<S> this approach has been referred to as ` decimation , ' with reference to analogous procedures in statistical physics .    the behavior of decimation procedures is poorly understood . </S>",
    "<S> here we consider a simple randomized decimation algorithm based on belief propagation ( bp ) , and analyze its behavior on random @xmath0-satisfiability formulae . </S>",
    "<S> in particular , we propose a tree model for its analysis and we conjecture that it provides asymptotically exact predictions in the limit of large instances . this conjecture is confirmed by numerical simulations . </S>"
  ]
}