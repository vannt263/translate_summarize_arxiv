{
  "article_text": [
    "in this paper we study a stochastic optimization problem for energy storage management over a finite time horizon . in order to incorporate unobservable changes of the economy into our model",
    ", we allow the energy price to depend on exogenous factors that can not be observed directly .",
    "our model extends existing approaches from the literature in the following way : we allow for regime switching and partial information about the energy price process . assuming the agent has only incomplete information about the energy market makes the model more realistic and relevant for real application .",
    "the aim of the agent is to maximize the profit from an energy storage facility by choosing the optimal rate of charging , or discharging the energy storage facility .",
    "this is achieved by buying at low- and selling at high prices .",
    "+ @xcite point out the necessity of `` _ investment analysis and optimization methodologies capable of accurately accounting for the various operating characteristics of real storage facilities _ '' and mention `` _ enormous profit opportunities for storage operators _ '' .",
    "this is confirmed by @xcite : `` _ with the growing importance of energy commodities , sophisticated valuation of energy storage becomes an integral aspect of functioning financial markets .",
    "`` _ storage allows for inter - temporal transfer of the commodity and permits exploitation of the fluctuating market prices._''@xcite + the motivation for solving the optimal control problem of an energy storage manager is two - fold .",
    "the storage manager wants to act optimally in the market . for this",
    ", she needs to know the optimal storage policy .",
    "hence she essentially aims to buy energy when prices are low , and sell energy when prices are high .",
    "furthermore , an agent in the energy market wants to know the value of the optimally controlled energy storage facility , which corresponds to the outcome of this optimization problem .",
    "+ stochastic optimization problems for energy storage facilities are studied by , e.g. , @xcite , @xcite , @xcite , and @xcite .",
    "they consider natural gas storages and study the problem of determining the optimal charging / discharging strategy maximizing the expected discounted reward over a finite time horizon .",
    "in contrast to that @xcite and @xcite study a stochastic optimal control problem for a pump - storage facility over a finite time horizon .",
    "they control the optimal amount of water that should be pumped / released in order to maximize the expected discounted reward from consuming / producing energy .",
    "all these models assume a fixed economic environment as well as full information about the energy price process .",
    "@xcite extend @xcite to allow for changes in modelling the drift .",
    "for this they assume the drift to be driven by an observable two - state markov chain .",
    "+ the energy price clearly depends on exogenous factors , which determine supply and demand , where exogenous means , that these factors are independent of the driving source of uncertainty in the energy price process .",
    "permanent energy demand and supply shifts lead to structural changes in the energy price",
    ".    a reason for such changes can be seasonal differences .",
    "for example , energy is consumed in winter for cooling and in summer for heating .",
    "furthermore , there are intraday fluctuations .",
    "however , @xcite find that `` _ storage value extracted from the seasonal spreads significantly underestimates the value obtained by optimal injection / withdrawal strategies .",
    "_ '' seasonalities can not explain all of the energy price changes , which justifies to concentrate on additional determinants of price fluctuations .",
    "whereas seasonalities are clearly observable , other kinds of effects may not be .",
    "the energy price depends on the economic environment , and on the geo - political situation .",
    "these are the kind of effects we would like to focus on in our model .",
    "it is thus necessary to allow for a state dependence in the model for the energy price process .",
    "furthermore , as the energy market is liberalized , the energy price also depends on financial risks .",
    "for this reason , we use a modelling approach from mathematical finance .",
    "+ we model the energy price as a diffusion process the drift of which is driven by a markov chain with non - observable state .",
    "there are economical as well as statistical reasons why it is more realistic to assume the underlying state process to be unobservable .",
    "a shift in the economic environment is often not trackable at the moment it happens , but only over time .",
    "hence , we want to allow for uncertainty concerning the current state of the economy . from the statistical point of view",
    "the drift of a diffusion process is particularly hard to estimate over time , see , e.g. , ( * ? ? ?",
    "* chapter 4.2 ) .",
    "+ stochastic optimization problems under partial information , especially those where the state process is influenced by an exogenous hidden markov chain , have been studied intensively in the literature of mathematical finance and also in insurance mathematics , see , e.g. , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite .",
    "@xcite model a pumped hydro storage in a changing economic environment , and assume partial information about the energy price process .",
    "however , for studying their optimization problem , they need to regularize their underlying process for technical reasons . herein , we are able to spare out this step .",
    "+ one of the outcomes of our model is that the candidate for the optimal control policy is of threshold type , i.e. , there are certain levels of the energy price where the energy storage manager changes her behaviour .",
    "thus , the controlled underlying process has a discontinuous drift coefficient .",
    "additionally , due to the structure of the model , the diffusion coefficient is degenerate .",
    "therefore , standard results about existence and uniqueness of solutions to stochastic differential equations ( sdes ) do not apply .",
    "hence , to prove admissibility of the resulting control policy , we need to prove an existence and uniqueness theorem extending the result of @xcite to the time - inhomogeneous case . a more detailed introduction to this issue is contained in section [ sec : existence ] . + the main contribution of this paper is that we study a stochastic optimization problem under partial information in a model that allows for a changing economic environment for an energy storage facility and present an extensive numerical study of the outcomes of this model , namely the value function as well as the candidate for the optimal policy . on the technical side",
    "we contribute that although our problem leads to a degenerate underlying process , all our results are obtained without any regularization techniques .",
    "( for examples where regularization was applied , we refer to @xcite . ) for verifying the candidate for the optimal strategy it is essential that the underlying controlled process exists .",
    "we prove a theoretical result about existence and uniqueness to a class of time - inhomogeneous sdes with discontinuous drift and degenerate diffusion coefficient , which generalizes the result from @xcite .",
    "+ the paper is organized as follows . in section [ sec : opt ] we formulate the energy storage optimization problem , describe the target function together with the underlying state process and derive the associated hamilton - jacobi - bellman ( hjb ) equation .",
    "then we solve the optimization problem numerically in section [ sec : num ] .",
    "the goal is to present an extensive study of the outcomes of our model . in section [ sec : existence ]",
    "we present an existence and uniqueness result for a class of time - inhomogeneous sdes with discontinuous drift and degenerate diffusion coefficient .",
    "the ( constructive ) proof is moved to appendix [ app : proof ] .",
    "note that section [ sec : existence ] and appendix [ app : proof ] are self contained and hence can be read isolated from section [ sec : opt ] . in section [ sec : energy ]",
    "we apply our result to prove admissibility of the candidate for the optimal control policy presented in section [ sec : num ] , i.e. , we show that the system of underlying state processes controlled by this policy has a unique global strong solution .",
    "section [ sec : outlook ] contains an outlook onto different fields of applied mathematics where the result on sdes presented herein can potentially be applied .",
    "let the filtered probability space @xmath0 , where the filtration satisfies the usual conditions , carry all stochastic variables appearing herein .",
    "further , let @xmath1 be a standard brownian motion .",
    "+ we model the energy price process @xmath2 as an ornstein - uhlenbeck ( ou ) process ,    @xmath3    with constant mean reversion speed @xmath4 , ( seasonality free ) mean reversion level @xmath5 , seasonality function @xmath6 \\longrightarrow \\mathbb{r}$ ] , and constant diffusion parameter @xmath7 .",
    "@xmath8 is the long - term equilibrium price .    for the seasonality function",
    "we assume @xmath9)$ ] , and satisfies a linear growth condition , i.e. , there exist constants @xmath10 such that @xmath11 for all @xmath12 $ ] .",
    "an example for the choice of this cyclical component is @xmath13 where @xmath14 determines the seasonal price trend , @xmath15 represents the time of the seasonal peak of the equilibrium price , and @xmath16 is the length of one season , c.f .",
    "* section 2.2 ) and ( * ? ? ?",
    "* section 3 ) .",
    "@xmath17 is an exogenous markov chain with a @xmath18-dimensional state space , which is w.l.o.g .  given by @xmath19 , where @xmath20 is the @xmath21-th unit vector in the @xmath22 , @xmath23 .",
    "we denote the given intensity matrix of @xmath24 as @xmath25 and assume knowledge of the initial distribution of @xmath24 .",
    "we assume @xmath26 , @xmath23 , i.e. , @xmath27 is constant for each state .",
    "w.l.o.g .",
    "we assume @xmath28 .",
    "the energy price is observable on the spot market , while the mean - reversion level is hard to estimate .",
    "therefore , we assume that the information available to the energy storage manager is contained in the augmented filtration generated by the energy price process @xmath29 , where @xmath30 .",
    "we choose an ou process to model the energy price , since on the energy market it is necessary to allow for negative prices , and since mean - reversion is a stylized fact for energy prices .",
    "+ based on this energy price",
    "the manager of an energy storage facility has to decide when to charge , or discharge the storage and at which rate .",
    "therefore , the rate of charging @xmath31 serves as the control . for discharging",
    "the quantity is negative .",
    "we model the energy storage level @xmath32 as @xmath33    since @xmath27 is not directly observable , we are in a situation of partial information . to overcome this issue",
    ", we apply filtering theory .",
    "[ [ filtering - problem . ] ] filtering problem .",
    "+ + + + + + + + + + + + + + + + + +    since @xmath27 is not adapted to the observation filtration @xmath34 , it follows that the whole drift of @xmath35 is not adapted to @xmath34 . for convenience",
    "we denote this drift as @xmath36 let the initial distribution of @xmath24 be denoted as @xmath37 and let @xmath38 for all @xmath23 .",
    "now , we estimate the drift @xmath39 given the information generated by the energy price process @xmath35 following @xcite : @xmath40 where @xmath41 , @xmath23 , @xmath42 , is the conditional probability for @xmath24 being in state @xmath21 at time @xmath43 .",
    "we further denote @xmath44 and @xmath45 .",
    "the following proposition can be found in ( * ? ? ?",
    "* theorem 9.1 ) .",
    "[ prop : filter ] the conditional probabilities @xmath46 solve the following system of sdes : @xmath47 where @xmath48 is an @xmath49-adapted brownian motion given by @xmath50 often referred to as innovation process .",
    "in particular this means that @xmath51 is markovian , and @xmath52 finally , we find an equivalent representation for the energy price process in terms of the innovation process @xmath53 : @xmath54 where @xmath51 is defined in .",
    "the advantage in this representation is that now all ingredients of our model are adapted to the observation filtration and hence the optimization problem is well - defined .",
    "+ thus , we have transformed the original model under partial information to the following model under full information : @xmath55 if @xmath56 are started at time @xmath57 $ ] , we denote the starting values by @xmath58 , respectively .",
    "in the end we remark that we can reduce the dimension of by one by setting @xmath59 for all @xmath42 .",
    "therefore , the correct state space for the filter is the simplex @xmath60 with closure @xmath61^{d-1 } : \\sum_{i=1}^{d-1 } \\nu_i \\le 1\\}$ ] .",
    "hence the cost for obtaining full information are @xmath62 additional dimensions for the filter .",
    "[ [ the - optimization - problem . ] ] the optimization problem .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    we introduce lower and upper capacity bounds of the energy storage facility @xmath63 and say that the energy storage is full , or empty at @xmath64 , or @xmath65 , respectively . for the control @xmath66 we assume @xmath67 , where @xmath68 is the set of admissible controls imposing that @xmath66 is progressively measurable and of feedback type ( cf .",
    "* section 2.1 ) and ( * ? ? ?",
    "* section 2 ) ) .",
    "furthermore , the process @xmath69 controlled by @xmath66 needs to exist , i.e. , system needs to have a solution .",
    "additionally we impose conditions on the control such that the energy storage facility is modelled properly from an operational point of view . concretely , charging and discharging should not be possible at the maximum rate , if the energy storage facility is nearly full or empty , respectively . for technical reasons",
    "these bounds are modelled in a continuous way , i.e. , we impose smooth transition ( cf .",
    "* section 2.1 ) , ( * ? ? ?",
    "* section 3 ) , and ( * ? ? ? * section 4.1 ) ) .",
    "so we have @xmath70 $ ] for @xmath12 $ ] , where @xmath71 , with @xmath72 , @xmath73 , and @xmath74 are sufficiently smooth and bounded functions describing the maximal rates at which energy is sold or bought , respectively , and @xmath75 is constant .",
    "figure [ fig : admcontrols ] illustrates the functions @xmath76 on @xmath77 $ ] .",
    "note that for certain energy storage facilities , e.g. , gas storages , @xmath76 are falling for all levels of @xmath78 .",
    "however , as we study a general energy storage facility , we do not lay down on a specific physical law determining these bounds .",
    "the interested reader may consult , e.g. , @xcite .",
    "+     and @xmath79 . ]",
    "our choice of @xmath80 guarantees that the process @xmath81 is reflected at the boundary and stays inside @xmath77 $ ] , if started inside .",
    "note that our model includes the most important operational conditions from a physical point of view , but neglects detailed modelling of some technical requirements , as the main purpose of this paper is to gain an impression of the effect of unobservable exogenous impacts .",
    "+ the aim of the energy storage manager is to maximize the profit from the energy storage facility .",
    "define @xmath82 \\times [ -m_u , m_u ] \\longrightarrow \\mathbb{r}$ ] by @xmath83 -u \\ , \\bigl(s - d_-   \\bigr)-c_0 \\,q , & u < 0 & \\text{(discharging ) } \\ , , \\end{array } \\right.\\end{aligned}\\ ] ] with fixed costs @xmath84 and with storage costs @xmath85 . for the definition of @xmath86 , cf .",
    "* section 2.3 ) , ( * ? ? ?",
    "* section 2 ) , ( * ? ? ?",
    "* section 2 ) , and ( * ? ? ?",
    "* section 2 ) .",
    "+ at the end of the planning horizon @xmath87 , the value of the energy remaining in the storage facility is the reward that would be gained on immediately selling everything on the market at price @xmath88 , @xmath89 .",
    "@xmath90 is a scrap rate that has to be paid by the storage manager .",
    "hence we define the _ terminal reward function _",
    "@xmath91 \\longrightarrow \\mathbb{r}$ ] by @xmath92    now we are ready to formulate the stochastic optimization problem under study . denote @xmath93 \\times \\bar { { \\cal s}}\\times [ 0,t]$ ] .",
    "we would like to maximize the expected discounted profit @xmath94 given by @xmath95\\ ] ] by finding the optimal control @xmath96 , where @xmath97 is a constant discount rate and @xmath98 is the expectation with the starting values @xmath99 .",
    "the aim is to find the optimal value function @xmath100 given by @xmath101 and ( if it exists ) the optimal control policy @xmath102 . +    the value function @xmath103 is continuous and satisfies a linear growth condition , i.e. , there are constants @xmath10 such that @xmath104",
    ".    follows directly from ( * ? ? ?",
    "* chapter 3 , theorem 5 ) and from the construction of @xmath86 and @xmath105 .",
    "the value function @xmath103 is also associated as the fair price of the real option , which represents the value of the energy storage facility at time @xmath43 , if sold at time @xmath87 .    applying the dynamic programming principle ( cf .",
    "* section 3.3 , theorem 3.3.1 ) ) , we derive the hjb equation associated with system and optimization problem , @xmath106}\\bigl(u \\",
    ", v_{q}+ { f}\\bigr ) & = 0 \\ , , \\\\",
    "v(s , q,\\nu , t)&=\\phi(s , q ) \\end{aligned}\\ ] ] for all @xmath107 where @xmath108    solving the pointwise optimization problem results in the following candidate for the optimal charging policy : @xmath109 where @xmath110 are the boundaries at which the strategy switches between buying energy , waiting , and selling energy . + as the hjb equation is degenerate parabolic , we have little hope to find an analytic solution , or to show existence of a classical solution . for a problem under full information @xcite bring up the possibility to prove verification in terms of viscosity solutions , which is a concept of weak solutions that only requires continuity of the solution , but is still strong enough to prove uniqueness and furthermore , to build the basis of numerical experiments . for the concept of viscosity solutions",
    "we refer the interested reader to @xcite , @xcite , and to @xcite for numerics .",
    "+ let @xmath111 denote the boundary of the closure of @xmath112 , respectively .",
    "we start with a definition of viscosity solutions to .",
    "[ def : viscosity ]    1 .",
    "a function @xmath113 is a _ viscosity subsolution _ to , if @xmath114}\\bigl(u \\ , \\phi_{q}(\\bar{s},\\bar q,\\bar{\\nu},\\bar t)+ f(\\bar{s},\\bar q , u)\\bigr ) \\ge 0\\ ] ] for all @xmath115 and for all @xmath116 such that @xmath117 attains a maximum at @xmath118 with @xmath119 .",
    "2 .   a function @xmath113 is a _ viscosity supersolution _ to , if @xmath120}\\bigl(u \\ , \\psi_{q}(\\bar{s},\\bar q,\\bar{\\nu},\\bar t)+ f(\\bar{s},\\bar q , u)\\bigr ) \\le 0\\ ] ] for all @xmath115 and for all @xmath121 such that @xmath122 attains a minimum at @xmath118 with @xmath123 .",
    "3 .   @xmath113 is a _ viscosity solution _ to , if it is both a viscosity sub- and supersolution .    from ( * ?",
    "* theorem 4.3.1 ) we know that the value function @xmath103 is a viscosity solution of .",
    "the standard argument for proving uniqueness is to conclude from the fact that two viscosity solutions are equal on the boundary of the domain , that they are also equal in the interior .",
    "however , we neither have boundary conditions in the direction of @xmath78 , nor in the direction of @xmath124 .",
    "since @xmath81 can never leave @xmath77 $ ] , if started inside , we can as well define @xmath81 on the whole @xmath125 .",
    "( in practice we will always start with a value inside the capacity bounds of the energy storage facility . ) for this reason and since @xmath81 is decoupled from @xmath126 , we do not require boundary conditions in the direction of @xmath78 , cf .",
    "* and p.  431 ) .    further on , from ( *",
    "* corollary 2.2 ) we know that the hmm filter reaches the boundary @xmath127 with probability zero in finite time .",
    "hence we can argue in terms of ( * ? ? ? * theorem ii.2 and theorem ii.3 together with remark ii.4 ) to get uniqueness of the viscosity solution to .",
    "it remains to prove that if has a smooth solution , then this is the optimal value function .",
    "[ prop : verification ] let @xmath128 be a viscosity supersolution of , and @xmath129 almost everywhere",
    ". then @xmath130 .",
    "+ furthermore , if there is a strategy @xmath131 such that @xmath132 is a viscosity supersolution with @xmath133 almost everywhere , then @xmath134 , and @xmath135 is the optimal charging policy .",
    "let @xmath136 , where @xmath137 is the area of a circle with radius @xmath138 and @xmath139 where @xmath140 . for @xmath141 , @xmath142 and @xmath143 , see @xcite .",
    "+ let @xmath144 be an admissible strategy . then @xmath145\\,dr + m_t\\,,\\end{aligned}\\ ]",
    "]    where @xmath146 is a martingale . since @xmath128 is a viscosity supersolution which is of class @xmath147 a.e .",
    ", it satisfies @xmath148 which allows us to choose @xmath149 sufficiently large such that @xmath150 taking expectations we get @xmath151\\right)\\,.\\end{aligned}\\ ] ]    as @xmath152 we obtain @xmath153 by dominated convergence and as @xmath154 was arbitrary .",
    "thus , @xmath155 by taking the supremum over all @xmath156 $ ] in the derivation we get @xmath157 .",
    "in this section we solve the hjb equation numerically .",
    "the focus of this paper lies on unobservable factors influencing the energy price .",
    "as seasonalities are clearly observable , these effects can be identified and we may assume that energy prices in our model are already made free from them .",
    "hence , for the numerical part  in order to be able to identify the effects from unobservable factors  we set @xmath158 .",
    "we apply the semi - lagrangian approach with fully implicit timestepping , see ( * ? ? ?",
    "* section 3 ) , together with a finite difference method , see ( * ? ? ?",
    "* chapter 3 , section 5.3 ) , to obtain approximations to the value function as well as the optimal charging policy .",
    "the method converges to the viscosity solution of the hjb equation , since the conditions from ( * ? ? ?",
    "* section 4 ) are satisfied .    our numerical study is conducted for a markov chain with two states , i.e. , @xmath159 and for the following parameter set : @xmath160 , @xmath161 , @xmath162 , @xmath163 , @xmath164 , @xmath165 , @xmath166 year , @xmath167 , @xmath168 , @xmath169 , @xmath170 , @xmath171 , and @xmath172 .",
    "+ figure [ fig : value ] shows the resulting value function and the charging policy for @xmath173 , and @xmath174 .",
    "the optimal control is of threshold type with two threshold levels . for low energy prices ,",
    "energy is bought at the maximum rate ( red area ) .",
    "then , if the energy price exceeds the lower threshold level , which is at a price of @xmath175 ( depending on @xmath78 ) , the optimal policy is to wait ( green area ) .",
    "if the energy price further also exceeds the higher threshold level at @xmath176 , then energy is sold ( blue area ) . for the value function",
    "we observe that @xmath103 grows in @xmath78 .",
    "so the more energy is inside the storage facility , the more the storage facility is worth .",
    "furthermore , @xmath103 grows in @xmath177 for intermediate and high energy prices , but falls in @xmath177 for low energy prices , if @xmath78 is small , too .",
    "this is directly related to the resulting control policy . for low energy prices",
    ", energy is bought , and hence an increasing price while still in the area of buying decreases the value .",
    "furthermore , note that on extending the figure to negative values of @xmath177 , the behaviour proceeds in the same way as for small values of @xmath177 .",
    "+        figure [ fig : entwicklung ] shows the value function and the associated control for @xmath173 and for three different filter values , @xmath178 .",
    "we observe that the higher @xmath179 , the higher the value function .",
    "this has the following reason .",
    "since @xmath180 , it means that if the probability for being in the state with the higher mean reversion level of the price process grows , then also the value of the energy storage facility grows . for the optimal control",
    "higher @xmath179 implies that the lower threshold level , i.e. , the one that separates the area of buying energy and waiting ( between the red and the green areas ) and also the higher threshold level , between the area of waiting and the area of selling energy ( between the green and the blue areas ) are shifted upwards , and hence in sum the area of buying ( red area ) grows and the area of selling ( blue area ) shrinks .",
    "this means for growing @xmath179 the storage manager will buy more energy since she expects a growing energy price .",
    "then she could sell at higher prices later .",
    "+     ( from up to down).,title=\"fig : \" ]   ( from up to down).,title=\"fig : \" ]   ( from up to down).,title=\"fig : \" ]   ( from up to down).,title=\"fig : \" ]   ( from up to down).,title=\"fig : \" ]   ( from up to down).,title=\"fig : \" ]    in figure [ fig : spiqfix ] , where we set @xmath173 , and fix @xmath181 , this effect becomes even more clear .",
    "while the value function grows gently in @xmath179 , the levels between the buy- and wait region , and the wait- and sell region grow in @xmath179 .",
    "so for higher @xmath179 the storage manager will buy more energy , since she expects to be able to sell it at higher prices later .",
    "note that growing @xmath179 does not necessarily imply a growing value in all parameter sets .",
    "for example , consider the case of @xmath182 .",
    "if the storage level is very low and the energy price is high ( around @xmath183 ) , then small @xmath179 implies falling prices such that in the future one can buy cheaper , whereas growing @xmath179 means that prices will probably stay high , making charging expensive and hence leading to a falling value .",
    "this effect is illustrated in figure [ fig : fallval ] , where we fix @xmath184 and compare the value function for @xmath185 ( red ) and @xmath186 ( blue ) in dependence of @xmath179 .",
    "already for our parameter set , @xmath103 falls moderately in @xmath179 for @xmath185 .",
    "+         ( dashed red ) and @xmath187 ( blue ) . ]    in figure [ fig : tsqfix ] we fix @xmath181 , and @xmath174 .",
    "we observe that the value function falls in @xmath43 since as @xmath43 grows , there is less time left to control the system and hence to earn money . furthermore , at the end of the planning horizon , there is a multiplicative scrap rate @xmath90 , which amplifies this effect . for the charging policy growing @xmath43 means that the levels between buying and waiting , and waiting and selling sink to avoid the penalty .",
    "+        finally , we change the planning horizon in our parameter set to @xmath188 and compare it to the case where @xmath166 for @xmath173 , and @xmath174 , see figure [ fig : stationar ] . for longer planning horizon",
    "the value function is especially higher for small prices , because a longer time horizon increases the chance that prices grow .",
    "the effect becomes more clear on regarding the charging policy .",
    "the lower threshold level is higher for @xmath188 , so more energy will be stored to sell it at higher prices later .",
    "additionally , for high values of @xmath78 and growing planning horizon the higher threshold level is higher and hence the energy storage manager will start selling at higher prices .    for @xmath189 value function and charging policy will converge to the stationary case , in which the value is autonomous .",
    "+     above , @xmath188 below).,title=\"fig : \" ]   above , @xmath188 below).,title=\"fig : \" ]   above , @xmath188 below).,title=\"fig : \" ]   above , @xmath188 below).,title=\"fig : \" ]    in all our examples we observe that the candidate for the optimal control attains three states , namely the state of selling energy , the state of waiting , and the state of buying energy .",
    "the functions @xmath190 from describe the critical energy prices at which the optimal rate of charging switches between these states .",
    "hence , the resulting strategy is of threshold type .    in ( * ? ? ?",
    "* section 7 ) it is shown that the value function is the unique viscosity solution of their hjb equation with fixed threshold strategy , if a condition implying concavity in a weak sense is satisfied . a related result can also be obtained in our case .",
    "then , threshold strategies are optimal , if they lead to a smooth reward function , see proposition [ prop : verification ] .",
    "it remains to check whether threshold type strategies are admissible .",
    "the question of admissibility of the resulting strategies reduces to the question of whether the underlying processes exist , or equivalently , whether the system of sdes which describes the underlying processes has a solution .",
    "it turns out that this issue is not straightforward .",
    "remember the underlying system    @xmath191    the drift of system is discontinuous , hence we can not apply the classical theory as mentioned in section [ sec : introduction ] .",
    "therefore , we study this issue in detail . in section [ sec :",
    "existence ] we consider a more general setup .",
    "we consider the following @xmath192-dimensional time - inhomogeneous sde :    @xmath193    where @xmath194 , @xmath195 , and @xmath196 is a @xmath192-dimensional standard brownian motion . + it is well - known that if @xmath197 and @xmath198 are ( locally ) lipschitz in @xmath199 and satisfy linear growth , then there exists a unique global strong solution . for",
    "@xmath197 only bounded and measurable and @xmath198 bounded , lipschitz , and uniformly non - degenerate , i.e. , there exists a constant @xmath200 such that for all @xmath201 and all @xmath202 we have @xmath203 , @xcite and @xcite prove that there still exists a unique global strong solution .",
    "a generalization is @xcite , where @xmath198 only needs to be non - degenerate in those components in which the drift is not lipschitz .",
    "another generalization is @xcite , where only a locally integrable drift is required . a first idea to handle",
    "a discontinuous drift would be to approximate @xmath197 by smooth functions and analyze the approximation limit , see , e.g. , @xcite .",
    "a further existence and uniqueness result for the situation where the drift is only measurable is proven in @xcite with techniques from malliavin calculus .",
    "however , all of these results heavily depend on a non - degenerate diffusion coefficient . for the degenerate situation @xcite prove an existence and uniqueness result for an sde with an increasing drift coefficient by approximation with sub- and supersolutions .    a more recent result for the degenerate situation",
    "is @xcite , where the condition that the diffusion coefficient needs to be uniformly non - degenerate is replaced by a condition on the geometrical relation between the diffusion coefficient and the hypersurface along which the drift is discontinuous .",
    "their proof extends the idea from @xcite , however , it is neither required that the coefficients are bounded , nor that the drift is increasing .",
    "@xcite consider a time - homogeneous sde .",
    "we extend the result from @xcite to the time - inhomogeneous case , in which conditions on the coefficients can be relaxed .",
    "@xcite generalize the result from @xcite for the one - dimensional setting .",
    "the most general result for time - homogeneous sdes with discontinuous drift and possibly degenerate diffusion coefficient is @xcite , which is a generalization of @xcite to multidimensional sdes .",
    "+ proving that the @xmath192-dimensional sde has a unique global strong solution is equivalent to proving that @xmath204 has a unique global strong solution , where @xmath205 , with @xmath206 for @xmath207 , and @xmath208 , @xmath209 , with @xmath210 for @xmath211 , and @xmath212 for @xmath213 .",
    "+ it seems a bit artificial to study system instead of , but we would like to apply results from @xcite and hence have to fit our problem into the setup therein .",
    "+    [ ass : f ] consider a function @xmath214 satisfying    1 .",
    "@xmath215 ; 2 .",
    ".    under these assumptions there exists @xmath217 such that @xmath218    later , we will allow @xmath197 to be discontinuous along the hypersurface @xmath219 . for this",
    ", we define @xmath220 and @xmath221 where all missing arguments are @xmath222 .",
    "+ we make the following assumptions :    [ ass : coefficients ] let    1 .",
    "@xmath223 ; 2 .",
    "@xmath198 is such that @xmath224 is lipschitz ; 3 .",
    "@xmath225 for some constant @xmath226 and for all @xmath227 ; 4 .",
    "@xmath197 is such that there exist functions @xmath228 such that @xmath229 5 .",
    "@xmath230 are such that @xmath231 satisfy linear growth , i.e. , there exist constants @xmath232 such that @xmath233 .",
    "[ rem : asscoeff ] the following conditions on @xmath234 and the coefficients @xmath235 imply that items ( c2 ) and ( c5 ) in assumptions [ ass : coefficients ] hold .",
    "however , assumptions [ ass : f ] and [ ass : coefficients ] contain less restrictive conditions on the coefficients .    1 .   @xmath236 is bounded and lipschitz for @xmath207 , and there exist constants @xmath10 such that @xmath237 ; 2 .",
    "there exist constants @xmath10 such that @xmath238 for all @xmath211 ; 3 .",
    "@xmath239 is bounded and lipschitz ; 4 .",
    "@xmath240 satisfies linear growth , i.e. , there exist constants @xmath232 such that @xmath241 .",
    "assumption [ ass : coefficients ] ( c3 ) is a crucial condition , which , in the case of a degenerate diffusion coefficient @xmath198 , has a nice geometrical interpretation .",
    "it means that the diffusion must not be parallel to the hypersurface along which the drift is discontinuous .",
    "we refer to @xcite for more details .",
    "[ thm : ex ] let assumptions [ ass : f ] and [ ass : coefficients ] hold .",
    "then has a unique global strong solution .    for the proof we refer to appendix [ app : proof ] .",
    "now we apply the result from section [ sec : existence ] to prove admissibility of the resulting threshold strategies for the energy storage optimization problem studied in section [ sec : opt ] .",
    "we consider the case of @xmath159 as in the numerical study to allow for more intuition , but remark that the result from section [ sec : existence ] can be applied to the general case as well .",
    "the question of admissibility of the resulting strategies reduces to the question of whether the underlying processes exist , or equivalently , whether the system of sdes , which describes the underlying processes , has a solution . in the notation of section [ sec : existence ] , using @xmath242 , this system has the following form @xmath243 @xmath244 @xmath245 , @xmath246 , and @xmath247 is a three - dimensional standard brownian motion . + from the study in section",
    "[ sec : opt ] we get that the optimal control attains three states , namely the state of selling energy , the state of waiting , and the state of buying energy .",
    "@xmath190 describe the critical energy prices at which the optimal rate of charging switches between these states .    for applying our existence and uniqueness result , we need the following relation : @xmath248 where @xmath249 are the resulting levels where the strategy switches between the states , i.e. , the switching levels are actually functions of @xmath250 . in figure",
    "[ fig : barriers ] , @xmath251 is the boundary between the green and the blue areas , and @xmath252 is the boundary between the green and the red areas .     and @xmath252 .",
    "]    theoretically , the existence of the functions @xmath249 can be proven by applying the implicit function theorem , where the crucial conditions are @xmath253 , or equivalently @xmath254 for @xmath255 \\times[0,1]\\times [ 0,t]$ ] , and @xmath256 for @xmath257 in a neighbourhood of the switching levels .",
    "figure [ fig : vmixed ] shows the mixed derivative of the resulting value function @xmath103 . in our numerical examples",
    "the condition was always satisfied globally .    . ]",
    "[ [ existence - and - uniqueness - proof . ] ] existence and uniqueness proof .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    now we prove the existence of a unique solution to system using the result from section [ sec : existence ] . + first of all",
    ", we define the functions @xmath258 and @xmath259 . with this , we can rewrite system such that @xmath260 now we are ready to check whether assumptions [ ass : f ] and [ ass : coefficients ] are fulfilled .",
    "we begin with checking whether @xmath197 is of class @xmath261\\times[0,1 ] ) \\times [ 0,t])$ ] outside the discontinuities .",
    "this holds since by assumption @xmath9)$ ] , and since the functions @xmath80 are sufficiently smooth .",
    "furthermore , @xmath262\\times[0,1])\\times [ 0,t])$ ] for @xmath263 .",
    "for the next condition we have to check whether @xmath264\\times[0,1 ] ) \\times [ 0,t ]   ) $ ] . clearly , @xmath265 .",
    "however , for this condition to be satisfied , we also need that @xmath266\\times[0,1 ] ) \\times [ 0,t])$ ] .",
    "furthermore , @xmath267 .",
    "it is crucial that the non - parallelity condition holds for both @xmath268 : @xmath269 is positive , if @xmath270 for all @xmath271\\times ( 0,1)\\times[0,t]$ ] , where @xmath239 is an extension of @xmath198 by a zero line and a zero row .",
    "note that we checked this condition in all our numerical examples and it was always satisfied . + further we need @xmath224 to be lipschitz , and that the linear growth condition holds for @xmath272 and @xmath224 , which is both fulfilled , if @xmath249 are sufficiently smooth functions on a bounded domain and since @xmath273 satisfies linear growth by assumption .",
    "if for both @xmath274 , @xmath275 \\times[0,1])\\times [ 0,t])$ ] and @xmath270 for all @xmath276\\times ( 0,1)\\times[0,t]$ ] , then system has a unique global strong solution .",
    "it remains to extend the result from section [ sec : existence ] to the situation with two discontinuities .",
    "as @xmath249 are distinct , i.e. , they do not cross or converge to each other in @xmath77\\times [ 0,1 ] \\times [ 0,t]$ ] , we can find a hypersurface @xmath277 which lies between @xmath278 .",
    "furthermore , due to theorem [ thm : ex ] , a unique global strong solution to system exists in the area below @xmath279 as well as in the area above @xmath279 . in @xmath279",
    "the coefficients are the same for the limit from above and from below .",
    "therefore , due to the strong markov property , the solution from above and from below may be pasted together in @xmath279 .",
    "thus , the resulting strategies are indeed admissible .",
    "+ note that on studying practical observations we found that the optimal value function is relatively invariant w.r.t .",
    "small changes in @xmath249",
    ". therefore , we are optimistic that we can find @xmath280 \\times[0,1])\\times [ 0,t])$ ] functions which are sufficiently close to the true  possibly less smooth  switching barriers such that the strategy switching at these @xmath280 \\times[0,1])\\times [ 0,t])$ ] functions produces a reward function that is very close to the optimal one .",
    "on the one hand we have studied an optimization problem for an energy storage facility under partial information . on the other hand",
    "we have shown how the issue of existence of uniqueness of processes controlled by policies of threshold type can be handled in general .",
    "we emphasize that such kinds of sdes appear in a wide range of applied mathematics .",
    "we will list some further fields in which our result or the results presented in @xcite are applicable .",
    "+ a question arising in inventory management is the optimal stock holding problem , see , e.g. , @xcite .",
    "there the stockpile @xmath281 is modelled as @xmath282 \\ , , \\end{aligned}\\ ] ] where @xmath283 is the demand for the good in the stock , which can be modelled as a diffusion process independent of @xmath284 .",
    "@xmath285 $ ] is the amount of goods ordered for the stock at time @xmath43 , bounded by @xmath75 , which serves as the control . for the resulting threshold type controls ,",
    "our result is necessary to prove existence and uniqueness of the two - dimensional process @xmath286 .",
    "+ in @xcite the valuation of swing options on electricity markets is studied . there",
    ", a similar sde as in section [ sec : energy ] appears : @xmath287 \\ , , \\end{aligned}\\ ] ] where @xmath288 is the amount of energy available at time @xmath43 .",
    "@xmath285 $ ] is again the control , bounded by @xmath75 , which describes the amount of energy that is bought in case the option is exercised , and which in addition to @xmath289 also depends on the energy price , cf .",
    "section [ sec : energy ] . in this setup",
    ", the control is again of threshold type with one threshold level .",
    "thus , again our result is potentially applicable there .",
    "+ overall we saw that threshold strategies appear in a wide range of fields of applied mathematics and hence the result presented herein potentially solves a large variety of problems .",
    "in principle we would like to apply the results from @xcite , where only the time - homogeneous case is considered , to prove existence and uniqueness in the time - inhomogeneous case . herein , the conditions on the time dimension are less restrictive . to prove theorem [ thm : ex ] we need to adapt the techniques presented in @xcite to our situation . for this , we prove two lemmas .",
    "+ first of all , we assume @xmath197 to be discontinuous only along @xmath290 , i.e. , the special case @xmath291 .",
    "for this case and coincide .",
    "then we seek to remove the discontinuity from the drift in a way such that the remaining coefficients are locally lipschitz .    for this",
    "we define a transformation @xmath292 with @xmath293 by @xmath294 and choose @xmath295 in a way such that @xmath296 for @xmath297 .",
    "then @xmath298 is locally invertible with local inverse @xmath299 .",
    "thus , we can now consider the transformed sde @xmath300    [ lem : lip ] let assumption [ ass : coefficients ] hold . then there exist functions @xmath301 such that the coefficients of are locally lipschitz , and such that @xmath298 is locally invertible around @xmath290 .",
    "the following proof is constructive , but note that the presented construction is not unique .",
    "the construction of @xmath302 is done like in @xcite . for @xmath303 consider @xmath304 d",
    "t+   \\sum_{i=2}^d \\alpha_i \\frac{\\partial g_1}{\\partial x_i } dt   + \\frac{\\partial g_1}{\\partial t } dt    \\\\ & + \\frac{1}{2 } \\sum_{i , j=1}^d(1-\\delta_{11}(i , j ) ) ( \\beta \\beta^\\top)_{ij } \\frac{\\partial^2 g_1}{\\partial x_i \\partial x_j } dt +   \\sum_{i , j=1}^d   \\beta_{ij } \\frac{\\partial g_1}{\\partial x_i } dw_t^j\\ , .",
    "\\end{aligned}\\ ] ] now choose @xmath305 which ensures that @xmath306 vanishes globally and that for @xmath307 , @xmath308 are locally lipschitz since @xmath309 is locally bounded and @xmath310 vanishes on @xmath290 .",
    "furthermore , @xmath311 is locally lipschitz , since @xmath303 is @xmath147 in the time dimension due to assumption [ ass : coefficients ] .",
    "the terms in the second line of are locally lipschitz , which follows from assumption [ ass : coefficients ] together with ( * ? ? ?",
    "* lemma 2.7 ) . + for @xmath307 consider @xmath312 d t+   \\sum_{{i=2}}^d \\alpha_i \\frac{\\partial g_k}{\\partial x_i } dt   \\\\ & + \\frac{\\partial g_k}{\\partial t } dt + \\frac{1}{2 } \\sum_{i , j=1}^d(1-\\delta_{11}(i , j ) ) ( \\beta \\beta^\\top)_{ij } \\frac{\\partial^2 g_k}{\\partial x_i \\partial x_j } dt +   \\sum_{i , j=1}^d   \\beta_{ij}\\left ( 1+\\frac{\\partial g_k}{\\partial x_i}\\right ) dw_t^j\\,,\\end{aligned}\\ ] ] where we choose @xmath313 with @xmath314 this guarantees that also the drift of @xmath315 is locally lipschitz .",
    "+ in the time - direction we set @xmath316 .",
    "this closes the proof .",
    "since @xmath317 we need to show that it s formula nevertheless holds for a class of functions including @xmath299 .",
    "[ lem : ito ] let @xmath318 , @xmath319 , @xmath320 for all @xmath321 , @xmath322 , @xmath323 . for an it process",
    "@xmath324 , let @xmath325 .",
    "then for all @xmath326 @xmath327_s\\,.\\end{aligned}\\ ] ]    the proof runs along the same lines as in @xcite .",
    "additionally , we use the fact that for the regular it formula , we only require @xmath328 in the time - direction .",
    "now , we are ready to prove the main theorem of section [ sec : existence ] .",
    "we start with the case where @xmath197 is discontinuous along @xmath290 . due to lemma",
    "[ lem : lip ] the coefficients of are locally lipschitz , which guarantees that the transformed sde has a unique local solution .",
    "+ furthermore , due to lemma [ lem : ito ] , it s formula holds for the inverse @xmath299 of the transformation . by setting @xmath329 and applying it s formula to @xmath299",
    ", we get that has a unique local solution .",
    "+ now , we can directly apply ( * ? ? ?",
    "* theorem 3.2 ) which , by concatenating local solutions , guarantees existence and uniqueness of a unique maximal local solution to",
    ". + additionally , we can directly apply ( * ? ? ? * theorem 3.3 ) to obtain that explosion does not happen in finite time .",
    "hence , has a unique global strong solution in case @xmath197 is discontinuous along @xmath290 .",
    "+ for the general case , where @xmath197 is discontinuous along @xmath330 , we have that due to assumptions [ ass : f ] and [ ass : coefficients ] , system has a unique global strong solution @xmath331 . setting @xmath332 and applying the classical it formula",
    ", we get that has a unique global strong solution .",
    "the authors thank rdiger frey ( wu vienna ) , gunther leobacher ( johannes kepler university linz ) , and ralf wunderlich ( btu cottbus - senftenberg ) for valuable discussions that improved this paper .",
    "+ m. szlgyenyi is supported by the vienna science and technology fund ( wwtf ) : project ma14 - 031 . + a part of this paper was written while m. szlgyenyi was member of the department of financial mathematics and applied number theory , johannes kepler university linz , 4040 linz , austria .",
    "+ during this time , m. szlgyenyi was supported by the austrian science fund ( fwf ) : project f5508-n26 , which is part of the special research program `` quasi - monte carlo methods : theory and applications '' .",
    "z.  chen and p.  a. forsyth .",
    "_ pricing hydroelectric power plants with / without operational restrictions : a stochastic control approach _ ,",
    "pages 275304 .",
    "nonlinear models in mathematical finance : new research trends in option pricing .",
    "nova science publishers , 2008 ."
  ],
  "abstract_text": [
    "<S> in this paper we consider an energy storage optimization problem in finite time in a model with partial information that allows for a changing economic environment . </S>",
    "<S> the state process consists of the storage level controlled by the storage manager and the energy price process , which is a diffusion process the drift of which is assumed to be unobservable . </S>",
    "<S> we apply filtering theory to find an alternative state process which is adapted to our observation filtration . for this alternative state process </S>",
    "<S> we derive the associated hamilton - jacobi - bellman equation and solve the optimization problem numerically . </S>",
    "<S> this results in a candidate for the optimal policy for which it is a - priori not clear whether the controlled state process exists . </S>",
    "<S> hence , we prove an existence and uniqueness result for a class of time - inhomogeneous stochastic differential equations with discontinuous drift and singular diffusion coefficient . finally , we apply our result to prove admissibility of the candidate optimal control . </S>",
    "<S> + keywords : energy storage optimization , hidden markov model , stochastic differential equation , discontinuous drift , degenerate diffusion + mathematics subject classification ( 2010 ) : 93e20 , 93e11 , 60h10 + jel classification : c61 , g1    a.  a.  shardin + mathematical institute , btu cottbus - senftenberg , 03044 cottbus , germany + m.  szlgyenyi + institute of statistics and mathematics , vienna university of economics and business , 1020 vienna , austria + michaela.szoelgyenyi@wu.ac.at </S>"
  ]
}