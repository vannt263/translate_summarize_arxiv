{
  "article_text": [
    "in the last few years most cosmological parameters have been determined up to a few percent .",
    "the values of @xmath1 , @xmath2 , @xmath3 and @xmath4 can now be constrained with an unprecedent degree of accuracy ( see , for example , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) .",
    "the next challenge to cosmologists is to test the predictions of cosmological models at a few hundred kpc scales .",
    "it turns out that these are just the relevant scales involved in galaxy formation and evolution .",
    "galaxy formation and evolution are intriguing open questions whose resolution in connection with the global cosmological model will very likely advance considerably in this decade . even though the field is at its beginnings",
    ", the use of numerical methods to study how galaxies are assembled within a cosmological scenario from the field of primordial fluctuations , seems a convenient approach .",
    "the main advantage of these approaches ( i.e. , self - consistent hydrodynamical simulations ) , is that the physics is introduced at a very general level , and the system evolves as a consequence .",
    "we can follow the evolution of the dynamical and hydrodynamical properties of matter in the universe ; galaxy - like objects ( glos ) appear as a consequence of this evolution . and ,",
    "so , the building - up of objects ( cosmic network structure formation at high @xmath5 , collapse , interactions , mergers , accretions ) , as well as their hydrodynamical consequences ( instabilities , gas infall from halos to discs at hundred of kpc scales , gas inflow along discs at tens of kpc scales , shocks , cooling , piling - up of gas necessary for star formation ) , can be accurately followed .",
    "we get not only the _ properties _ of objects at any @xmath5 , but also an _ insight _ into the _ physical processes _",
    "responsible for their formation and evolution .",
    "moreover , numerical hydrodynamical simulations using particles permit very convenient comparisons of glos that form in simulations with observational data .",
    "simulations _ directly _ provide us , at each @xmath5 , with the structural and dynamical properties of each individual glo ( position and velocity of each of its particles , gas density and temperature of each of its baryonic constituents ) and with their individual star formation rates histories ( sfrhs ) .",
    "chemical abundance and spectrophotometrical data are the current standard to compare models of galaxy formation .",
    "it is expected that the next generation of astronomical facilities will make possible a new science : mass measurements for distant galaxies ( see , for example * ? ? ?",
    "glos formed in numerical simulations are particularly suited to be compared to this new kind of data .",
    "pre - prepared numerical experiments are adequate to describe in detail a particular phase of the formation or evolution of galaxies ( for example , merger events or orbital motions of satellites within halos ) , from initial conditions set by the experimenter .",
    "these initial conditions try to model conditions that would have arisen along the evolution of the systems under consideration .",
    "they are useful to study basic aspects of the physical processes relevant to evolution .",
    "for example , the works by barnes , hernquist and mihos @xcite , which have fundamental importance to understand the role played by mergers in galaxy evolution , have been carried out with this technique . however , in pre - prepared simulations , contrary to the self - consistent approach , the process under consideration is studied _ in isolation _ , and not in connection with the other relevant processes involved in galaxy formation and evolution (",
    "already mentioned ) that , moreover , could interact among themselves in a non - trivial way .",
    "these considerations stress the ability of self - consistent hydrodynamical simulations as a tool to learn how galaxies form from the field of primordial fluctuations and evolve into the objects we observe today . to properly handle this problem",
    ", a numerical code has to allow for enough mass , time and space resolution as well as a convenient dynamical range",
    ". they should be as fast as possible and with memory requirements within the current computer capabilities .",
    "a very important issue when designing a numerical code to study galaxy formation and evolution , is to make sure that conservation laws are accurately verified , and , particularly , i ) , that angular momentum is conserved at the scales relevant to disc formation ; otherwise , galaxy disc formation could meet with some difficulties ; and , ii ) , that entropy is conserved in reversible adiabatic processes , because the violation of this physical principle could produce spurious effects at galaxy scales . by the moment , star formation ( sf ) processes have to be modelled , either inspired in kpc or pc scale hydrodynamical simulations @xcite or other considerations @xcite .    the first choice to be made when designing this kind of codes is the gravity solver . among current numerical methods , those that employ adaptive techniques in regions of high density , either from a lagrangian ( as ap3 m , * ? ? ?",
    "* ; * ? ? ?",
    "* ) or eulerian ( as the art and mlapm codes , * ? ? ?",
    "* ; * ? ? ?",
    "* ) approach , are the most suitable to meet the requirements of resolution and large dynamical range , accuracy and rapidity . a detailed comparison between ap3",
    "m and art codes has been carried out by @xcite .",
    "they have found out that these codes produce results that are consistent within a 10% , provided that @xmath6 ( @xmath7 is the number of integration steps ; @xmath8 stands for the dynamical range ) .",
    "the choice of the gravity solver in a cosmological simulation depends on its purpose . to study galaxy formation and evolution ,",
    "lagrangian codes have the advantage over eulerian codes that they permit to go backwards and forwards in time in a very easy way .",
    "for example , the constituent particles of a given object can be identified at a given redshift , @xmath9 , and one can then analyze their positions in phase space and the properties of the objects or structures they form at a different redshift , @xmath10 .",
    "this is a very convenient method to study evolutionary processes and it motivates our choice of an ap3m - based method as gravity solver for our simulations .    to solve the hydrodynamical equations ( and , in general , any hyperbolic system of equations in partial derivatives )",
    ", there are also two basic different techniques : i ) , eulerian methods , and , ii ) , lagrangian methods .",
    "eulerian methods are based on the so - called godunov algorithm @xcite .",
    "their new formulations , using adaptive mesh refinements @xcite , are particularly well suited to combine with art - like codes when both gravitational and hydrodynamical forces are considered . for a comparison of the performances of a number of hydrodynamical codes of both kinds see @xcite .",
    "most of the lagrangian methods used in astrophysics are based on the sph ( smooth particle hydrodynamics ) technique @xcite .",
    "given the convenience of this technique to be applied to cosmological simulations , a number of authors developed sph codes to be used in a cosmological context .",
    "some of them follow .",
    "@xcite first used sph techniques in cosmological simulations ( a p3m - sph code ) .",
    "@xcite , as well as @xcite , coupled a sph code to the @xcite tree algorithm .",
    "@xcite modelled their treesph code after @xcite and @xcite introduced a parallel version of this code , while @xcite makes use of a special purpose hardware to compute the gravitational forces by direct summation ( grape ) .",
    "@xcite coupled sph with a pp algorithm in a code designed to be run on a connection machine , and @xcite incorporated in a tree - sph code the so - called @xmath0 terms ( see below ) .",
    "gadget @xcite uses either a tree scheme or grape , with individual integration timesteps , and both , serial and parallel versions .",
    "another parallel tree - sph code is gasoline @xcite .",
    "as already mentioned , ap3m - based codes are particularly well suited to study galaxy formation through self - consistent cosmological simulations .",
    "the first ap3m - sph code was introduced by @xcite ( hydra code , see also * ? ? ?",
    "@xcite carried out a second implementation . in these implementations ,",
    "the integration timestep is _ global _",
    "( i.e. , at a given time , the same for all particles ) . in cosmological simulations ,",
    "however , multiple time scales appear , due to their very large dynamical ranges from very dense volumes to very rarefied zones . to get an accurate enough integration scheme , and , at the same time , to avoid that particles in denser volumes slow down the simulations",
    ", it is advantageous to introduce _ individual _ integration timesteps , i.e. , at each time , different timesteps for each particle , depending on the density of the region it samples .",
    "this is the optimal design of the code to increase the mass resolution .",
    "another shortcoming of conventional sph formulations concerns the entropy violation of the dynamical equations , related to the space dependence of the smoothing length of sph particles , @xmath11 , as noted by some authors @xcite .",
    "a rigorous formulation of sph requires that additional terms must be included in the particle equations of motion which account for the variability of @xmath12 , usually termed as `` the @xmath0 terms '' . until very recently , they were considered as having a negligible effect on the global dynamics of systems @xcite and , therefore , sph codes ignored such additional terms and focused on energy conservation .",
    "alternatively , treatments of hydrodynamics based on the lagrange equations can be formulated that are well behaved in their conservation properties of both , energy and entropy , as that introduced recently by @xcite .",
    "the effects of entropy violation in sph codes are not completely clear and they need to be analyzed in much more detail , specially in simulations where galaxies are formed in a cosmological framework .",
    "previous works have analyzed this question in the case of the collapse of isolated objects and have found that , if such correction terms are neglected , the density peaks associated to central cores or shock fronts are overestimated at a @xmath1330@xmath14 level @xcite .    to make up for these shortcomings",
    "when dealing with problems related to galaxy formation and evolution , we introduce a new code , deva , where gravity is solved by means of an ap3m - like technique , and hydrodynamics with a sph technique , with individual integration timesteps .",
    "the space dependence of the sph resolution scale , @xmath11 , has been taken into account , in order to ensure the conservative character of the equations of motion , as long as entropy and energy is considered .",
    "another important particularity of deva is the attention paid to angular momentum conservation , a key point to enable disc formation in simulations ( * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) .",
    "our choice has been to put the stress into conservation laws rather than into saving cpu time . but saving cpu time has also been one of our concerns , so that the code is fast enough that cosmological self - consistent simulations can be run on a modest computer machine .",
    "the paper is organized as follows : @xmath151 is the introduction . in @xmath152 ,",
    "the sph method is briefly reviewed and we present the sph equations when the @xmath0 terms are considered .",
    "@xmath15 3 is devoted to the particularities of the deva code , and @xmath15 4 to test whether the code integrates correctly the hydrodynamical and n - body equations ( standard tests ) . in @xmath15 5",
    "we introduce some self - consistent simulations run with deva , compare to one standard of reference for hydrodynamical simulations in a cosmological framework ( the santa barbara cluster comparison project * ? ? ?",
    "* ) , and analyze the effects of the @xmath0 terms in these simulations . finally , in @xmath15 6 , we give a summary of the work and discuss deva performances .",
    "the basic idea of the sph method @xcite lies in representing the fluid elements by @xmath16 particles which act as interpolation centers to determine the local value of any macroscopic variable @xmath17 . in order to smooth out local statistical fluctuations ,",
    "this interpolation is performed by convolving the field @xmath17 with a smoothing ( or kernel ) function @xmath18 .",
    "for example , the smoothed estimate of the local density is @xmath19 where @xmath20 , @xmath21 is the mass of particle @xmath22 , and @xmath23 is the smoothing length for particle @xmath24 , which specifies the size of the averaging volume .    ideally , the individual particle smoothing lengths @xmath23 must be updated so that each particle has a constant number of neighbors @xmath25 . by neighbors",
    "we mean those particles @xmath22 with distances @xmath26 .",
    "such a condition can be exactly implemented by constructing , for each particle @xmath24 , a list of its @xmath25 nearest neighbors .",
    "the smoothing length of @xmath24 is then defined to be @xmath27 where @xmath28 is the position vector of particle @xmath24 s most distant neighbor .",
    "since each particle has its own @xmath12 value , it is possible to find couples of particles @xmath29 such that @xmath22 is a neighbor of @xmath24 , but @xmath24 is not a neighbor of @xmath22 . in these cases",
    ", it is obvious that the reciprocity principleth particle belongs to the neighbor list of the @xmath30th particle , then it is mandatory that , at this same time , the @xmath30th particle belongs to the neighbor list of the @xmath22th particle ] is not satisfied and , therefore , simulations will not conserve momentum . in order to solve this problem",
    ", it is necessary to symmetrize the sph equations by using , for example , averaged kernels @xcite : @xmath31\\;.\\ ] ]    a first consequence of the adopted symmetrization procedure is the specific form for the kernel derivatives . as a matter of fact ,",
    "( [ wij ] ) implies that @xmath32 is a function of three variables : @xmath33 , @xmath34 and @xmath35 .",
    "consequently , its gradient @xmath36 is given by : @xmath37 \\nonumber \\\\   + \\frac{1}{2}\\left[\\frac{\\partial w(r_{jk},h_j)}{\\partial h_{j}}{{\\mathbf{\\nabla}}}_i h_{j } + \\frac{\\partial w(r_{jk},h_k)}{\\partial h_{k } } { { \\mathbf{\\nabla}}}_i h_{k}\\right]\\end{aligned}\\ ] ] the first part of eq .",
    "( [ nablawij ] ) , which does not involve derivatives of the smoothing lengths , is the usual symmetrized form of @xmath36 .",
    "the second part , which involves derivatives of the smoothing lengths , arises because of the spatial and temporal variability of @xmath12 .",
    "we shall refer to terms of this type as @xmath0 terms. most implementations of the sph algorithm consider only the first one and neglect the @xmath0 terms .",
    "the motion of particle @xmath30 is determined by the momentum and energy equations : @xmath38 where @xmath39 is the local gravitational potential , @xmath40 is the acceleration due to pressure forces , @xmath41 is the acceleration due to viscosity forces , @xmath42 is the specific internal energy , @xmath43 is the pressure ( with @xmath44 being the constant heat ratio ) , and @xmath45 is the power due to non - adiabatic heating or cooling processes .",
    "a fully consistent sph expression for pressure forces , satisfying all conservations laws ( including entropy conservation in reversible adiabatic problems ) , was obtained by @xcite : @xmath46    using eqs .",
    "( [ rho ] ) and ( [ nablawij ] ) to compute @xmath47 , one obtains @xmath48 \\frac{{\\mbox{\\it{\\bf r}}}_{ij}}{r_{ij } } \\nonumber\\\\ & -&\\frac{1}{4}\\tilde{r}_i \\sum_j m_j\\left(\\frac{p_i}{\\rho_{i}^{2}}+ \\frac{p_j}{\\rho_{j}^{2}}\\right ) \\frac{\\partial w(r_{ij},h_i)}{\\partial h_{i}}\\\\ & + & \\frac{1}{4}\\sum_j \\tilde{r_j}\\delta_{ij_f } \\sum_k \\frac{m_j m_k}{m_i } \\left(\\frac{p_j}{\\rho_{j}^{2}}+",
    "\\frac{p_k}{\\rho_{k}^{2}}\\right ) \\frac{\\partial w(r_{jk},h_j)}{\\partial h_{j}}\\ ; , \\nonumber\\end{aligned}\\ ] ] where @xmath49 .",
    "on the other hand , using eqs .",
    "( [ rho ] ) and ( [ nablawij ] ) to compute the @xmath50 derivative appearing in eq .",
    "( [ dedt ] ) , the energy equation becomes : @xmath51   \\frac{\\textbf{r}_{ij}\\cdot\\textbf{v}_{ij}}{r_{ij}}\\nonumber\\\\   & + & \\frac{1}{4}\\frac{p_i}{\\rho_{i}^{2}}\\sum_j m_j   \\left[\\frac{\\partial w(r_{ij},h_i)}{\\partial h_i }   \\breve{r}_i+ \\frac{\\partial w(r_{ij},h_j)}{\\partial h_j }   \\breve{r}_j\\right ] + { \\cal{h}}_i\\;,\\end{aligned}\\ ] ] where @xmath52    note that eqs .",
    "( [ accpress ] ) and ( [ energy ] ) have been deduced by using both spatial and time derivatives of the sph density as defined by eq .",
    "( [ rho ] ) _ with the symmetrization specified in eq .",
    "( 3 ) _ , because compatibility with the conservation laws requires that the sph force and energy equations are evaluated in consistency with the density definition .",
    "in the case of deva , this requirement increases the cpu time per integration step .",
    "in fact , since the density @xmath53 associated to a particle @xmath30 depends on both @xmath34 and @xmath35 , for @xmath54 , ( i.e. , for its @xmath25 nearest neighbors , see eq .",
    "[ rho ] ) , the computation of @xmath53 at a given integration step requires the knowledge of @xmath35 for these @xmath25 nearest neighbors at its beginning .",
    "value must be kept fixed all along the integration step in order to avoid violating the reciprocity principle ] this can be achieved either by using the @xmath35 values predicted in the previous integration step or by performing , at each step , a first loop over the particles to compute their @xmath35 values and , once it is over , a second loop to compute their hydrodynamical properties .",
    "since we look for a high accuracy rather than a high computational speed , we have adopted this latter possibility .    as usual in sph , to account for dissipation at shocks , the above equations must be completed by adding an artificial viscous pressure term , @xmath55 . when the @xmath0 terms are considered , @xmath55 is added only to the leading term of equations ( [ accpress ] ) and ( [ energy ] ) , that is , those not involving @xmath0 terms @xcite : @xmath56 where we have adopted the standard viscous pressure proposed by @xcite : @xmath57 where @xmath58 and @xmath59 are constant parameters of order unity , @xmath60 is a softening parameter to prevent numerical divergences , @xmath61 is the local sound speed , and @xmath62",
    "the simulation of a system constituted by @xmath63 particles usually requires a computational effort which considerably varies from some regions ( or particles ) to other .",
    "for example , regions of high density and submitted to strong shocks need to be simulated with timesteps much shorter than the rest of the system . in the ap3m+sph codes described in the literature , all the particles in the system",
    "are simultaneously advanced at each timestep .",
    "the particle needing the highest time resolution determines the timestep length of all the others .",
    "consequently , some few particles can slow down the simulation of a system . to make a code more efficient in handling with problems with multiple time scales ,",
    "the computational effort must be centered on those particles that require it , avoiding useless computations for the remaining particles . in other words , it is necessary to allow for different timesteps for each particle .",
    "a pec ( predict - evaluate - correct ) scheme with individual timesteps has been developed and implemented on our code in the following way :    1 .",
    "we enter the step @xmath64 ( which corresponds to the time @xmath65 ) with known positions @xmath66 , velocities @xmath67 , and accelerations @xmath68 , for all the @xmath63 particles .",
    "furthermore , any integration scheme with individual timesteps needs some information to identify , at each step , those particles needing a recomputation of their acceleration .",
    "this information is stored in two vectors @xmath69 and @xmath70 , where @xmath69 is the time at which the last update of @xmath71 was performed , while @xmath72 is the time at which a recomputation of @xmath71 will be necessary in the future .",
    "@xmath73 2 .",
    "a list is constructed with those particles @xmath22 which will be advanced at the current step .",
    "such particles are labelled as _",
    "active_. obviously , the particle @xmath74 with the smallest prediction time , @xmath75 , must be included in this list , and fixes the timestep of the remaining active particles : @xmath76 since each step requires the update of many auxiliary arrays , it is impractical to advance only a single particle . for this reason , we label as _ active _ all particles within a cubic box around @xmath74 .",
    "the size of the activation box is chosen , at each position , so that it contains a small fraction of the total number of particles .",
    "3 .   for all particles , active or",
    "not , we predict the value of @xmath77 and @xmath78 at @xmath79 @xmath80 4 .",
    "only for active particles , we compute their accelerations and correct @xmath77 and @xmath78 using : @xmath81 where the choice @xmath82 and @xmath83 maintains accuracy to second order both in positions and velocities . in these expressions",
    ", @xmath84 represents the time interval elapsed from the last evaluation of @xmath85 to that performed in the current timestep @xmath86 note that , unlike @xmath87 , the @xmath84 value is different for each active particle .",
    "we update the global time @xmath88 , as well as the @xmath89 and @xmath90 values of each active particle . here , in order to maintain the numerical stability of the ap3 m algorithm , the individual timestep @xmath91 must be smaller than the time scale for significant displacements or changes in velocity due to accelerations : @xmath92 where @xmath93 is the gravitational softening .",
    "the above integration scheme may easily be extended to include hydrodynamics .",
    "the sph processes involve three new independent variables in addition to those listed in eq .",
    "( [ variables ] ) : @xmath94 where @xmath95 is the smoothing length , @xmath96 the specific internal energy , and @xmath97 its derivative . for all particles",
    ", we must then predict the value of @xmath98 at @xmath79 @xmath99 and compute , for active particles , both their total acceleration ( @xmath100 and @xmath101 ) as well as their hydrodynamical variables ( @xmath102 , @xmath103 , @xmath104 and @xmath105 ) .",
    "these quantities are then used to correct the internal energy of active particles : @xmath106 where the choice @xmath107 maintains accuracy to second order in internal energies .",
    "now , the numerical stability requires additional limits on the timestep of each gas particle .",
    "a first timestep control is that concerning the time scale for significant displacements or changes in velocity due to accelerations : @xmath108 a second limit on @xmath109 is usually given by a timestep control which combines the courant and the viscous conditions : @xmath110\\;.\\label{dtcv}\\ ] ]    when required , radiative cooling is implemented in an integral form @xcite using the fact that , due to the courant condition , the density field is nearly constant over a time - step : @xmath111 where @xmath112 is the power radiated per unit volume and @xmath113 is the change in @xmath114 due to cooling processes .",
    "this integral procedure circumvents the need of a control time for cooling , and , hence , it never limits the timestep .",
    "the numerical stability of our code requires that cooling effects must be updated at each step for all particles , active or not .",
    "otherwise , the simultaneous presence of already cooled and not yet cooled particles in a given object would break the local pressure equilibrium and , as a result , cold particles would fall to the object center causing a non - physical core of very high density ( see @xmath155.2 for an example ) .",
    "fig [ cpu ] shows , for a typical cosmological simulation , the ratio of the cpu time consumed by an algorithm with individual timesteps to that consumed when all particles are simultaneously advanced .",
    "we see that the use of individual timesteps typically reduces the cpu time per step in a factor of five . in a pentium",
    "iv 1.7ghz personal computer , the cpu time typically consumed by our code in a @xmath115 cosmological simulation without the @xmath0 terms is : a ) 25 seconds per step in simulations without radiative cooling ( such as the santa barbara cluster test of  5.1 ) , b ) from 25 ( at high redshifts ) to 70 ( at low redshifts ) seconds per step in cosmological simulations with radiative cooling ( such as those of  5.2 ) .",
    "these cpu times are increased by about 150% when the @xmath0 terms are taken into account .",
    "deva has been applied to different problems with known analytical or numerical solutions .",
    "the aim of such simulations was not only to test our code , but also to analyze the effects of the @xmath0 terms included in it .",
    "the one - dimensional shock tube problem proposed by @xcite has become a standard test of all transport and source terms ( including artificial viscosities ) of hydrodynamic algorithms .",
    "it considers a perfect gas distributed on the @xmath116-axis .",
    "a diaphragm at @xmath117 initially separates two regions which have different densities and pressures .",
    "all particles are initially at rest . at time",
    "@xmath118 the diaphragm is broken and both regions start to interact .",
    "nonlinear waves are then generated at the discontinuity and propagate into each region : a shock wave which moves from the high to the small pressure region , while the associated rarefaction wave moves in the inverse sense .",
    "the analytical solution to this problem has been given by @xcite and @xcite . in our simulation",
    ", we have considered @xmath119 gas particles initially distributed in the interval @xmath120 according to : @xmath121 dissipational effects , other than those associated with the artificial viscosity ( with @xmath122 and @xmath123 ) , were ignored , as well as gravitational interactions .",
    "[ shocktube ] shows our results at @xmath124 .",
    "we see from this figure that our results are in excellent agreement with the analytical solutions .",
    "the resulting profiles both in the shock wave ( located at @xmath125 ) and in the contact discontinuity ( located at @xmath126 ) are much less rounded than in previous sph computations ( see , e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) as a result of having used a larger number of particles and , hence , a better resolution .",
    "we also note the almost complete suppression of post - shock oscillations in our results .",
    "these oscillations can be seen in the previous sph simulations of this problem , especially in the velocity field , while no high - frequency vibrations are perceptible in our results .",
    "the weak blip observed in the pressure profile at the contact discontinuity ( @xmath126 ) is normal in sph codes .",
    "such non - physical blip has been explained by @xcite as due to the fact that the smoothed estimate of pressure is computed by using discontinuous quantities .",
    "it is then inevitable that @xmath127 has some slight perturbation at the contact discontinuity , but it has a negligible effect on the motion . in this test , simulations including the @xmath0 terms gave exactly the same results as those neglecting such terms .      a 3d - problem usually considered to test hydrodynamical codes",
    "is that concerning the adiabatic collapse of a non - rotating gas sphere . this problem has been studied from a finite - difference method by @xcite , and from sph simulations by @xcite and @xcite",
    "in order to facilitate the comparison of our results to those obtained by these authors , we have taken their same initial conditions : a gas sphere of radius @xmath128 and total mass @xmath129 , with density profile @xmath130 all the @xmath119 gas particles are initially at rest and have the same specific internal energy @xmath131 .",
    "units were taken so that @xmath132",
    ". initially far from equilibrium , the system collapses converting most of its kinetic energy into heat .",
    "a slow expansion follows and , at late times , a core - halo structure develops with nearly isothermal inner regions and the outer regions cooling adiabatically .",
    "we show in fig .",
    "[ hkfig ] different system profiles at end of the simulation .",
    "the solid line represents the numerical solution obtained when the @xmath0 terms have been included , the dashed line represents the numerical solution obtained when these terms have been neglected , and the points represent the numerical solution obtained by @xcite .",
    "we see that , although the solid and dashed lines are not exactly superposed , both solutions are coincident within the error bars .",
    "we can understand why the @xmath0 terms have a negligible effect in the two standard tests reported in this section .",
    "the effect of the @xmath0 terms on the thermal energy can be expressed by a time scale defined by @xmath133 where @xmath134 is the ratio of the specific thermal energy @xmath114 of particle @xmath30 to the change in @xmath114 due to the @xmath0 terms @xmath135 when the time elapsed , @xmath136 , is longer than this time scale , the @xmath0 terms will produce a non - negligible effect on the thermal energy .",
    "this condition can be expressed as @xmath137 where @xmath138 represents the area contained by the @xmath139 curve between @xmath140 and @xmath141 .",
    "when these timescales are computed for the non - adiabatic tests reported in this paper , one obtains @xmath142 ( in the shock tube problem ) , and @xmath143 ( in the collapse of a non - rotating gas sphere ) .",
    "the effect of the @xmath0 terms are then expected to be small .",
    "testing the effects of the @xmath144 terms on hydrodynamical evolution can be better worked out in isentropic processes .",
    "it is not easy , however , to get such kind of processes in simulations of gas evolution because gas easily develops shocks where dissipation must occur .",
    "a possibility is considering the adiabatic expansion of a gas sphere from a situation of equilibrium . using expansion rather than collapse has the advantage that shell crossing decreases substantially , so that viscous force terms can be removed and the evolution is isentropic .",
    "such simulations as that shown in  [ collapse ] lead at late times , @xmath145 , to equilibrium spheres with density profiles as that displayed in fig .",
    "[ hkfig ] .",
    "we use the adiabatic expansion of such spheres to test the effects of the @xmath0 terms in deva .",
    "initial conditions were generated by performing a simulation as that described in ",
    "[ collapse ] , using different numbers of particles . at @xmath146 , we switched - off its viscous pressures ( by setting @xmath147 ) to ensure that the subsequent evolution conserves the total entropy .",
    "the self - gravity was also switched - off at @xmath146 . in absence of gravitational interactions ,",
    "this system expands fast and , at @xmath148 , its central density has decreased by a factor of @xmath149 .",
    "the evolution from @xmath146 to @xmath148 must conserve both the total energy and entropy .",
    "table 1 shows the results for this series of simulations .",
    "we see that , when the @xmath0 correction terms are neglected , energy is conserved very accurately but there exists a considerable violation of the total entropy ( about @xmath150 in the time interval we have considered ) . in the opposite case , when such correction terms are taken into account , both total energy and total entropy are conserved very accurately ( about @xmath151 ) .",
    "these results appear to be independent on the number of particles .",
    "we then conclude that the @xmath0 correction terms cure entropy violation , allowing , at the same time , a very good energy conservation .",
    "the deva code is particularly well suited to numerically follow , in a cosmological context , the assembly from the field of primordial fluctuations of collapsed objects , such as galaxy clusters or galaxies . to illustrate deva performances in this situation",
    ", we briefly analyze some results of self - consistent simulations .",
    "self - consistency means that initial conditions are set at high @xmath5 as a montecarlo realization of the field of primordial fluctuations ( i.e. , perturbations , characterized by a spectrum , to a given cosmological model ) , and then they are left to evolve according with newton s laws and the hydrodynamical equations .",
    "the santa barbara cluster problem was proposed by @xcite to compare the results obtained from different codes .",
    "the formation of a x - ray cluster in a cold dark matter ( cdm ) universe has been simulated using most of the hydrodynamic codes available at that time , setting a standard of reference to test newly proposed hydrodynamic codes .",
    "the initial conditions of this test correspond to a @xmath152 peak of the density field smoothed with a gaussian filter of radius @xmath153 mpc according to the algorithm of @xcite .",
    "the perturbation was centered on a periodic cubic region of side @xmath154 mpc .",
    "the cosmological scenario is a flat cdm universe with @xmath155 km s@xmath156 mpc@xmath156 for the hubble constant ; @xmath157 for the present - day linear rms mass fluctuation in spherical top hat spheres of radius 16 mpc ; and @xmath158 for the baryon density ( in units of the critical density ) .",
    "64@xmath159 dark matter and 64@xmath159 baryon particles have been used with a softening length of 20 kpc .    to test the influence of the @xmath0 terms ,",
    "two different simulations were run with deva . in one of these simulations ,",
    "the @xmath0 terms have been considered ( sbgh ) while in the other they have been neglected ( sbnogh ) . in figure",
    "[ stbfig ] , the density , temperature and entropy profiles of the cluster are plot .",
    "the stars represent the results obtained @xcite by jenkins from a high - resolution sph simulation using a parallel version of the hydra code @xcite , while the circles represent the results obtained by bryan & norman from a high - resolution adaptive mesh refinement shock - capturing code , samr , @xcite .",
    "as previously remarked by @xcite , we see that the sph and mesh results differ at the central region .",
    "this figure also shows the results obtained from our code both when the @xmath0 terms are included ( solid line ) and neglected ( dashed line ) .",
    "error bars correspond to the standard deviation of the individual sph data .",
    "we see that , now , our results differ slightly depending on whether the @xmath0 terms have been included or not ( the slope of the density profile flattens more rapidly in sbgh than in sbnogh ; the temperature profile is flat in sbgh and decreases within 100 kpc in sbnogh ; the entropy profile is almost flat within 100 kpc in sbgh and decreases continuously in sbnogh ) . moreover , when the @xmath0 terms are neglected , we obtain results that are similar to those of previous sph simulations , and very close to jenkins results , obtained with a much higher resolution .",
    "when these terms are taken into account , the results are intermediate between previous sph and grid results .",
    "this suggests that , at least in part , the difference between the sph and grid results could be due to the non - physical entropy introduced by sph codes .",
    "this non - physical entropy is negative @xcite and , therefore , it produces objects with a smaller central temperature and a higher central density .",
    "particular attention deserves the comparison of deva results with those obtained from the entropy conserving sph - tree formulation by springel & hernquist ( 2002a ) , hereafter s - gadget . in figure [ comparison ]",
    "we give a comparison of the santa barbara cluster entropy profiles obtained in the sbgh run and s - gadget , kindly provided by y. ascasibar and g. yepes @xcite .",
    "both have been run with the same number of particles and gravitational resolution .",
    "we see that the agreement is very good within the error bars .",
    "so , both techniques compare very well in terms of entropy conservation .",
    "the differences found between sbgh and sbnogh simulations can be understood on the basis of the timescale for the @xmath0 terms ( section 4.3 ) .",
    "the time integral of @xmath160 ( see eq .",
    "[ ts ] ) for this test is now larger than unity ( @xmath161 ) .",
    "we now report on several self - consistent simulations run in the context of flat @xmath162cdm cosmological models with the aim of studying galaxy assembly ( see table 2 for a summary ) .",
    "we have considered two different @xmath162cdm models with parameters whose values are consistent with their recent determinations from observations : simulations @xmath162cdm1 ( @xmath162cdm2 ) have @xmath163 ( 0.7 ) , @xmath164 ( 0.04 ) , @xmath165 ( 1.00 ) and @xmath166 ( 0.70 ) ( * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) .",
    "both simulations share the same seed for the montecarlo realization of the initial fluctuation field , so that each object formed in one simulation has its counterpart in the other simulation . in each case , we have used @xmath167 dm particles and @xmath167 gas particles , in a periodic box of 10  mpc comoving side .",
    "the gravitational softening is @xmath168  kpc , and the minimum allowed smoothing length , @xmath169 , as usual . for each cosmological model , two simulations",
    "have been run that are identical ( they have exactly the same initial conditions and the same values of the cosmological parameters ) except that in one case the @xmath0 terms have been included ( simulations @xmath162cdm1-h and @xmath162cdm2-h hereafter ) , while in the second case these terms have not been taken into account ( simulations @xmath162cdm1-noh and @xmath162cdm2-noh hereafter , see table 2 ) . note that in these simulations the cosmological volume is homogeneously sampled , in the sense that no resampling multimass technique has been used to study glo assembly .",
    "this work can be considered as an extension of previous works in standard cdm models @xcite , where cosmological simulations had been run with a different code based on a different numerical approach with fixed integration timesteps and particle masses @xcite .",
    "relative to these previous works , deva opens the possibility of considering the effects of the @xmath0 terms at scales of galaxies in self - consistent simulations .",
    "moreover , the simulations we report here represent an improvement of the baryonic mass resolution by factors of @xmath170 in the number of baryonic particles sampling a glo of a given total mass .",
    "also , the time resolution allowed by the multistep technique has been improved by a factor of @xmath171 in the denser areas of the box .",
    "cooling has been implemented as described in @xmath15 3.4 , where the cooling curve is that from @xcite and @xcite for an optically thin primordial mixture of h and he ( @xmath172 , @xmath173 ) in collisional equilibrium and in absence of any significant background radiation field .    concerning star formation , in this work we report on _ direct _ results ( i.e. , no spectrophotometric ) obtained with the simplest implementation of star formation in the code : through a parameterization , similar to those used by @xcite and @xcite , see @xcite for details , based on the jeans criterion for a collapsing region .",
    "gas particles are turned into stars according with an inefficient schmidt - law - like transformation rule ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ) , @xmath174 where @xmath175 is a dimensionless star - formation efficiency parameter , and @xmath176 is a characteristic time - scale chosen to be equal to the maximum of the local gas - dynamical time @xmath177 , and the local cooling time , @xmath178 .",
    "equation ( [ star - rate ] ) implies that the probability @xmath179 that a gas particle forms stars in a time @xmath87 is @xmath180    as usual , we compute @xmath179 at each time step for all eligible gas particles and draw random numbers to decide which particles actually form stars .",
    "stellar feedback processes have not been explicitly considered , but a tuning of the efficiency parameters can mimic these feedback effects .",
    "galaxy - like objects of different morphologies appear in the simulation : disk - like objects ( dlos ) , early - type - like objects ( etlos ) and irregular objects .",
    "dlos contain gas in an extended disk , and most stars in a massive compact central concentration . in simulations with lower @xmath181 values ( not reported here ) , stars form also in the disks , along arms .",
    "etlos are very poor in gas and their stellar component have relaxed regular ellipsoidal shapes .",
    "irregulars have not defined shapes , and , in most cases , they are the product of a recent merger or interaction event .",
    "we note that glos formed in @xmath162cdm2-noh and @xmath162cdm2-h tend to be of later type than their @xmath162cdm1-noh or @xmath162cdm1-h counterparts , because of the lower values the parameters @xmath3 and @xmath182 take in @xmath162cdm2 simulations @xcite .",
    "first analyses of glo formation and evolution in simulations run with the deva code are reported in @xcite ; more details will be given elsewhere ( siz el al .",
    "2003 , in preparation ) . here",
    "we focus on different aspects related with deva performances .",
    "one important issue related to disc formation in hydrodynamical simulations is specific angular momentum conservation at kpc scales @xcite . in fig .",
    "[ jespmass ] , the specific total angular momentum at @xmath183 is represented versus mass for dlos identified in @xmath162cdm2-noh and @xmath162cdm2-h with @xmath184 150 km s@xmath156 ( @xmath185 is the disc scalelength , see * ? ? ?",
    "the specific total angular momentum is plot for dark haloes , @xmath186 ( open symbols ) , for the inner 83 per cent of the disc gas mass ( i.e. , the mass fraction enclosed by @xmath187 in a purely exponential disc ) , @xmath188 ( filled symbols ) , and for the stellar component of the dlos in our simulations , @xmath189 ( starred symbols ) .",
    "we see that , except for the three more massive objects , @xmath190 is of the same order as @xmath186 , so that these gas particles have collapsed conserving , on average , their angular momentum .",
    "moreover , dlos formed in our simulations are inside the box defined by observed spiral discs in this plot @xcite .",
    "in contrast , @xmath189 is much smaller than either @xmath186 or @xmath190 , meaning that the stellar component in the central parts has formed out of gas that had lost an important amount of its angular momentum in catastrophic events or that had never acquired it .",
    "we note that this result is similar to those obtained in simulations run with the code by @xcite , even if the codes are different , as explained above , and that the global cosmological models are also different .    the smoothed estimate of the local gas density given by eq .",
    "( 2 ) and the ensuing formulation of sph equations , symmetrized to ensure the reciprocity principle , has made possible @xmath190 conservation in an axisymmetric potential .",
    "this is a delicate crucial point in sph codes . as stated in @xmath152.2 ,",
    "its accurate implementation requires that the individual smoothing lengths must be completely updated at the beginning of each integration step , what increases the cpu time requirements .",
    "this complication can not be avoided , however , when an accurate @xmath190 conservation is a key point in the physical processes under study .",
    "a different approach to saving cpu time is then necessary . using different timesteps for each particle , useless computations for particles that do not require high time resolution",
    "are avoided .",
    "this saves considerable amounts of cpu time .",
    "multistepping has allowed us to run these simulations , that have a considerable dynamical range , in a modest computing machine ( a pentium iv 1.7ghz personal computer , see above ) .",
    "let us now turn to the effects of the @xmath0 terms at kpc scales .",
    "as stated in @xmath154.3 , their general effect is to correct the spurious negative entropy introduced in their absence by sph codes , mainly at the central regions of collapsed objects . as a consequence , when the @xmath0 terms are taken into account , dissipation by the gaseous component of a given glo increases , so that they are more disordered or dynamically hotter at their central regions .",
    "equilibrium is then attained with lower central baryon concentrations or densities , decreasing the amount of gas infall . but this is not the unique effect of @xmath0 terms on mass distribution .",
    "it is a well known effect that dark matter is pulled in by baryons as they lose their energy and fall onto these central volumes of collapsed configurations @xcite . decreasing the amount of gas infall translates , as a consequence , into a decreasing of the amount of dark matter at the glo centers . as an illustration of this effect on both the gaseous and dark components , in figure [ velcir ] ( upper panel )",
    "we show the circular velocity curves for the most massive etlo formed in @xmath162cdm1-h ( thick lines ) and its counterpart formed in @xmath162cdm1-noh ( thin lines ) . in the lower panel ,",
    "the corresponding circular velocity curves are represented for a dlo formed in @xmath162cdm2-h ( thick lines ) and its counterpart in @xmath162cdm2-noh ( thin lines ) . in these figures",
    ", @xmath191 is the radial distance to the glo center of mass , solid lines are the circular velocities , @xmath192 , short - dashed lines and long - dashed lines stand for the dark matter ( dm ) and the baryonic ( bar , both stellar and luminous ) contributions , respectively , given by : @xmath193 with @xmath30 = bar and dm . as can be clearly seen in these figures , the central distributions of both , dark matter and baryons , are different and in any case the concentrations are lower when the @xmath0 terms are included .",
    "these central concentrations are often quantitatively estimated in literature through the @xmath194 parameter ( the maximum or peak circular velocity , see * ? ? ?",
    "glos in @xmath162cdm1-h or @xmath162cdm2-h have lower @xmath195 values than their @xmath162cdm1-noh and @xmath162cdm2-noh counterparts , respectively .",
    "this can be seen in figure [ velcir ] for an etlo and a dlo , but the behavior is general for any glo . other useful parameter to quantitatively characterize circular velocity curves is the logarithmic slope ( ls ) , observationally defined for disc rotation curves as the slope of the straight line that fits @xmath196 in log - log scale from @xmath197 up to the last measured point in the rotation curve ( * ? ? ?",
    "* and references therein ; @xmath185 is the disk scalelength ) .",
    "lss are a measure of the glo halo compactness at the scales of 10 - 30 kpcs .",
    "as illustrated in figure [ velcir ] for an etlo and a glo , a tendency for glos to be less compact also at these scales when the @xmath0 terms are taken into account has been found in the simulations .    a second effect of the @xmath0 terms is related to the amounts of stars formed in a given glo at its formation and all along its evolution until @xmath183 . in these simulations ,",
    "many stars form at the shock fronts , where gas is compressed to very high densities .",
    "softer shocks mean less star formation with the same efficiency parameters . to illustrate this effect , in figure [ massstar ] the ratios of the total stellar masses for the 8 ( 7 ) more massive etlos produced in @xmath162cdm1-h ( @xmath162cdm2-h ) over the total stellar masses of their @xmath162cdm1-noh ( @xmath162cdm2-noh ) counterparts , are plot versus their total virial masses , @xmath198 .",
    "we see that , except in one case , these ratios are smaller than the unity , as expected .",
    "concerning sizes , for etlos we define the intrinsic or 3d cold baryon effective radius , @xmath199 , as the radius of the sphere enclosing half the total etlo mass in cold baryons ( i.e. , cold gas or stars ) , @xmath200 .",
    "this is a measure of the etlo size at scales of the baryonic objects . in figure [ restar ]",
    "we plot @xmath199 for the @xmath162cdm1-h ( @xmath162cdm2-h ) etlos in units of those of their @xmath162cdm1-noh ( @xmath162cdm2-noh ) counterparts .",
    "as expected , @xmath162cdm1-h ( @xmath162cdm2-h ) etlos have larger baryonic sizes than their @xmath162cdm1-noh ( @xmath162cdm2-noh ) counterparts , except for one case .",
    "finally , shocks heat the gas , producing an extended diffuse hot component .",
    "the effect of the @xmath0 terms in this case is to lower the temperature of this diffuse gaseous halo component of glos relative to the case when these terms are not considered .",
    "histograms for the temperature distribution of the gaseous component of two of the most massive glos in @xmath162cdm1-h ( thick lines ) and in @xmath162cdm1-noh ( thin lines ) are shown in figure [ temphist ] . to draw these histograms , all the gas particles within a sphere of radius @xmath201 , centered at the glo center of mass ,",
    "have been considered ( @xmath201 is the radius where the curve of integrated plasma emission luminosity reaches its asymptotic value ) . as illustrated in the histograms for these two glos , the temperature distributions of the gaseous component for @xmath162cdm1-h and @xmath162cdm1-noh objects do not differ substantially . in both cases ,",
    "the gas is close to biphasic , but @xmath162cdm1-h objects are slightly colder within @xmath202 than @xmath162cdm1-noh objects .",
    "they are also slightly more extended at @xmath201 scales , with the small excess of colder particles placed at the outskirts of the gaseous configurations .",
    "the differences found between @xmath162cdm1-h and @xmath162cdm1-noh or between @xmath162cdm2-h and @xmath162cdm2-noh simulations can be understood on the basis of the timescale for the @xmath0 terms ( section 4.3 ) .",
    "the time integral of @xmath160 ( see eq .",
    "[ ts ] ) is now much larger than unity ( @xmath203 ) , indicating that the @xmath0 terms can not be neglected in this kind of simulations .    as remarked in @xmath15[incsph ] , cooling implementation in multistep codes has to be handled with caution : cooling processes need to be updated at each timestep for all particles .",
    "otherwise , gas particles involved in shocks suffer from a spurious cooling and non - physical cores of high density appear , giving rise to extremely compact objects . as an example , in figure [ restar ] we plot the 3d cold baryon half - mass radii for a variant of @xmath162cdm1-noh , termed @xmath162cdm1-mcool ( see table 2 for details ) , where only active particles at each timestep have been allowed to cool . in figure [ restar ]",
    "( starred symbols ) we see that now the effective radii for the most massive objects are significantly smaller than in @xmath162cdm1-noh ; the difference becomes less important as the mass of the objects decreases and , as a consequence , the fraction of their constituent particles involved in shocks also decreases .",
    "note that , as the comparison of filled points and starred symbols in figure [ restar ] shows , the combined effects of entropy violation and spurious cooling can produce unphysically very small objects , a factor of ten smaller , in some cases , than the values found when these effects are circumvented ( i.e. , the @xmath162cdm1-h simulation ) .",
    "we present deva , a multistep ap3m - like - sph code designed to study galaxy formation and evolution in connection with the global cosmological model , that uses a formulation of sph equations ensuring both energy and entropy conservation .",
    "multistepping is introduced to save cpu time . in",
    "self - consistent cosmological simulations multiple time scales appear , due to their large dynamical ranges . to avoid that particles in denser zones slow down the simulation , and , at the same time , to get a properly accurate integration algorithm ,",
    "it is then advantageous to use individual time steps . a comparison of the cpu time used in a self - consistent cosmological simulation when it is run with a _",
    "global _ timestep or with a _ multistep _ scheme indicates that in the second case results at an equivalent level of accuracy are produced @xmath2045 times faster .",
    "when a multistep scheme is adopted , a delicate issue in the study of galaxy assembly in a cosmological context is the _ cooling _ implementation . in deva , as no cooling timescale is taken into consideration to fix the individual timestep for each particle , cooling must be calculated in a non - multistep way .",
    "otherwise , particles involved in strong shocks would spuriously cool and form dense objects characterized by unphysically small baryon half - mass radii .",
    "on writting deva , particular attention was paid that conservation laws of physics ( energy , entropy , momentum ) are correctly implemented in the code , so that they hold at scales and under physical conditions relevant for galaxy assembly in a cosmological context .",
    "the usual formulations of sph equations focus on energy conservation and they violate , by construction , entropy conservation . as a consequence ,",
    "a negative entropy is numerically produced in shocks that might ( or might not ) spuriously pollute the results , depending on the problem one studies .",
    "different authors have addressed the issue of entropy violation in sph codes @xcite and have given different alternative formulations of its equations .",
    "we have implemented a formulation that considers explicitly the effects of the @xmath0 terms in sph equations @xcite . by taking advantage of the structure of the ap3 m algorithm in the neighbor search ,",
    "the implementation of @xmath0 terms in the code is simple and noiseless .    to test the relevance of entropy violation at shock locations under different physical conditions ,",
    "we have studied problems and run simulations ( namely , the adiabatic santa barbara cluster formation test , @xcite , and fully self - consistent cosmological simulations to study galaxy formation including cooling an star formation ) using identical initial conditions and two different versions of deva , one that takes into account the @xmath0 terms in sph equations and one that does not take them into account . we show that entropy violation has consequences on the thermodynamical properties of the very central regions of the santa barbara cluster and on the structure at kpc scales of galaxy - like objects ( glos ) formed in simulations , but it does not have any appreciable consequence on the standard non - cosmological tests of hydrodynamical codes . to understand the origins of these different behaviors , a criterion is introduced that allows to elucidate when entropy violation is expected to have appreciable consequences on the results . in standard tests , only moderate shocks and time scales are involved .    as a consequence of the non - physical negative entropy numerically produced when the @xmath0 terms are neglected , both glos and the cluster present more concentrated baryon density profiles ( either star or gas ) .",
    "concerning the santa barbara cluster test , when the @xmath0 terms are not included , we get results that are similar to those of previous sph simulations that focus on energy conservation . however , when these terms are considered , the results are intermediate between those sph and grid results .",
    "for example , the temperature profile is decreasing within about 100 kpc of the cluster center when the simulation is run with standard sph codes ( including deva without @xmath0 terms ) , it increases when it is run with grid codes and it is flat when deva + @xmath0 is used .",
    "we would like to note that the accuracy figure of entropy conservation obtained with deva + @xmath0 and the entropy - conserving sph - tree code by springel & hernquist ( s - gadget , 2002a ) compare quite satisfactorily , as indicated by the good agreement between the santa barbara cluster entropy profiles obtained with both codes .",
    "in cosmological simulations , negative entropy causes galaxy - like objects ( glos ) to be dynamically less hot and gas infall onto their central regions is artificially increased , causing , also , an increase of the amount of dark matter at the glo centers . these results qualitatively agree with those obtained with s - gadget by @xcite in their simulation of a @xmath162cdm cosmological model .",
    "no quantitative comparisons are possible by the moment , because a standard of comparison for self - consistent cosmological simulations is unfortunately not available .",
    "an important result of this work is that the combined effects of entropy violation and multi - step cooling implementation in cosmological simulations can be particularly dramatic concerning the concentration of mass distribution in the galaxy - like objects they produce .",
    "for example , their baryon half - mass radii can be up to a factor of ten smaller than half - mass radii of glos produced in entropy - conserving non - multistep runs with deva .    concerning momentum conservation , we have used a formulation of sph equations that is consistent with the smoothed estimate of the local gas density ( eqs ( 1 ) and ( 3 ) ) .",
    "equations are symmetrized to ensure that the reciprocity principle holds ( that is , if at a given time the @xmath22th particle belongs to the neighbor list of the @xmath30th particle , then it is mandatory that , at this same time , the @xmath30th particle belongs to the neighbor list of the @xmath22th particle ) , so that momentum and angular momentum are conserved .",
    "the implementation of this principle in a sph code increases considerably the cpu time per integration step , because a double loop on gas particles is necessary to evaluate smoothing lengths . to test angular momentum conservation ,",
    "we have measured the specific angular momentum of discs formed in self - consistent simulations .",
    "it has been found that conservation is good enough to obtain simulated discs with observational counterparts , without any need of previous heating , as already @xcite have shown ( see also * ? ? ?",
    "the use of a very high number of particles could ensure angular momentum conservation in sph - tree codes @xcite . in this paper",
    "it has been shown that codes paying a particular attention to the implementation of conservation laws of physics at the scales of interest can attain a good level of accuracy in conservation laws with more limited resources .",
    "it is a pleasure to thank a. knebe , m. norman , v. quilis , j. silk , j. sommers - larsen , p. tissera and g. yepes for useful information and discussions on the topics addressed in this paper .",
    "particular thanks are due to h.m.p .",
    "couchman for making public his ap3 m code , on which the gravitational part of deva is based , and to y. ascasibar and g. yepes for allowing us to use their results on the santa barbara cluster test .",
    "this project was partially supported by the mcyt ( spain ) through grant aya-0973 from the programa nacional de astronoma y astrofsica .",
    "we also thank the iberdrola foundation for financial support , and the centro de computacin cientfica ( uam , spain ) for computing facilities .    50 alimi j .- m .",
    ", serna a. , pastor c. & bernabeu g. 2002 , j. comput .",
    "( in press ) ascasibar , y. 2003 , phd thesis , universidad autnoma de madrid avila - reese , v. , & vzquez - semadeni , e. 2001 , , 553 , 645 barnes , j.e .",
    "1989 , , 338 , 123 barnes , j.e . , 1992 , , 393 , 484 barnes , j.  e.  & hernquist , l.  e.  1991 , , 370 , l65 barnes , j.  e.  & hernquist , l.  1992 , , 30 , 705 barnes j. , & hut p. 1986 , 324 , 446 benz , w.  & hills , j.  g.  1987 , , 323 , 614 bond , j.  r. , centrella , j. , szalay , a.  s. , & wilson , j.  r.  1984 , , 210 , 515 borgani , s. , governato , f. , wadsley , j. , menci , n. , tozzi , p. , quinn , t. , stadel , j. , & lake , g.  2002 , , 336 , 409 bryan , g.l . , norman , m.l . , stone , j.m . ,",
    "cen , r. , & ostriker , j.p .",
    "1995 , comput .",
    "comm . , 89 , 149 bryan , g.l . , & norman , m.l .",
    "1995 , baas , 187 , 9504 couchman , h.  m.  p.  1991",
    ", , 368 , l23 couchman , h.m.p . , thomas , & pierce , f.r . , 1995 , apj , 452 , 797 courteau , s.  1997 , , 114 , 2402 dalcanton , j.  j. , spergel , d.  n. , & summers , f.  j.  1997 , , 482 , 659 dave , r. , dubinski , j. , & hernquist , l.  1997 , new astronomy , 2 , 277 domnguez - tenreiro , r. , serna , a. , siz , a. , & sierra - gonzlez de buitrago , m. m. 2003 , , in press dom ' inguez - tenreiro , r. , tissera , p.  b. , & s ' aiz , a.1998 , , 508 , l123 elmegreen , b. 2003 , , in press evrard , a.  e.  1988 , , 235 , 911 fall , s.m .",
    "1983 , in athanassoula e. , ed , iua symp . 100 , internal kinematics and dynamics of galaxies .",
    "reidel , dordrecht , p. 391",
    "frenk , c.  s.  et al .  1999 , , 525 , 554 gingold r.  a. & monaghan j.  j.  1977 , , 181 , 375 gingold r.  a. & monaghan j.  j. 1982 , j. comput .",
    "46 , 429 godunov , s.  k.  1959 , matematicheskii sbornik , 47 , 271 governato , f. , mayer , l. , wadsley , j. , gardner , j.p . , willman , b. , hayashi , e. , quinn , t. , stadel , j. , & lake , g. 2002 , astro - ph/0207044 preprint hawley , j.  f. , smarr , l.  l. , & wilson , j.  r.  1984 , , 277 , 296 hernquist , l.  1993 , , 404 , 717 hernquist , l.  & katz , n.  1989 , , 70 , 419 hoffman , y.  & ribak , e.  1991 , , 380 , l5 kang , h. , ostriker , j.  p. , cen , r. , ryu , d. , hernquist , l. , evrard , a.  e. , bryan , g.  l. , & norman , m.  l.  1994 , , 430 , 83 katz n.  1992 , 391 , 502 katz , n. , weinberg , d.  h. , & hernquist , l.  1996 , , 105 , 19 kennicutt , r. 1998 , , 498 , 541 klein , r.i . , fisher , r.t . , mckee , c.f . & truelove , j.k . 1998 , in proceedings of the international conference of numerical astrophysics , ed .",
    "s .. m. miyama et al .",
    "( boston : kluwer academic ) , p. 131 knebe , a. , green , a. , & binney , j.  2001 , , 325 , 845 knebe , a. , kravtsov , a.  v. , gottl \" ober , s. , & klypin , a.  a.2000 , , 317 , 630 kravtsov , a.  v. , klypin , a.  a. , & khokhlov , a.  m.  1997 , , 111 , 73 kritsuk , a.  g.  & norman , m.  l.  2002 , , 569 , l127 lahav , o. 2002 , in proceedings of the xxxviith rencontres de moriond on the cosmological model , astro - ph/0208297 preprint lahav , o. , bridle , l. , percival , w.j . , et al .",
    "2002 , astro - ph/0112162 preprint lucy , l.  b.  1977 , , 82 , 1013 mihos , j.  c.  & hernquist , l.  1994 , , 425 , l13 mihos , j.  c.  & hernquist , l.  1996 , , 464 , 641 monaghan , j.  j.  1992 , , 30 , 543 monaghan j.  j. & gingold r.  a.  1983 , j. comput .",
    "phys . , 52 , 374 monaghan , j.  j.  & lattanzio , j.  c.  1985 , , 149 , 135 navarro , j.  f.  & white , s.  d.  m.  1993 , , 265 , 271 nelson , r.  p.  & papaloizou , j.  c.  b.  1993 , , 265 , 905 nelson , r.  p.  & papaloizou , j.  c.  b.  1994 , , 270 , 1 netterfield , c.  b.  et al .",
    "2002 , , 571 , 604 norman , m.  l. & bryan , g.l . 1998 , in proceedings of the international conference of numerical astrophysics , ed .",
    "miyama et al .",
    "( boston : kluwer academic ) , p. 19",
    "padoan , p. , jimenez , r. , nordlund , a. , & boldyrev , s. 2003 , astro - ph/0301026 preprint padoan , p. , juvela , m. , goodman , a. & nordlund , a. 2001 , , 553 , 227 pearce , f.  r.  & couchman , h.  m.  p.  1997",
    ", new astronomy , 2 , 411 rasio , f.  a.  & shapiro , s.  l.  1991 , , 377 , 559 siz a. , domnguez - tenreiro r. , & serna , a. 2002 , , 281 , 309 siz a. , domnguez - tenreiro r. , & serna , a. 2003 , , in press siz , a. , domnguez - tenreiro , r. , tissera , p.  b. , & courteau , s. 2001 , , 325 , 119 serna a. , alimi j .-",
    "m . , & chize j .- p .",
    "1996 , , 461 , 884 silk , j.  2001 , , 324 , 313 sod , g.  a.  1978 , j. comput .",
    "phys . , 27 , 1 sommer - larsen j. , & dolgov a. 2001 , , 551 , 608 spergel d. n. et al .",
    "2003 , astro - ph/0302209 preprint springel , v.  & hernquist , l.  2002 , , 333 , 649 springel , v.  & hernquist , l. 2002b , astro - ph/0206393 preprint springel , v. , yoshida , n. & white , s. 2001 , new astronomy , 6 , 79 steinmetz , m. 1996 , , 278 , 1005 steinmetz , m. & navarro , j. 1999 , , 513 , 555 teyssier , r. 2002 , a & a , in press thacker , r.  j. & couchman , h.  m.  p. 2000 , , 545 , 728 thomas p.  a. 1987 , ph.d .",
    "thesis , cambridge univ .",
    "thomas p.  a. & couchman h.  m.  p. 1992",
    ", , 257 , 11 tissera p.  b. , lambas d.  g. , & abadi m.  g. , 1997 , , 286 , 384 tissera p.  b. , & domnguez - tenreiro , r. 1998 , , 297 , 177 tissera p.  b. 2001 , , 540 , 384 tissera , p.b .",
    ", domnguez - tenreiro , r. , scannapieco , c. , & siz , a. 2002 , mnras , 333 , 327 tucker w.  h. 1975 , radiation precesses in astrophysics ( new york , wiley ) vzquez - semadeni , e. , ostriker , e.  c. , passot , t. , gammie , c.  f. , & stone , j.  m. 2000 , protostars & planets iv , ed . v. mannings et al .",
    "( tucson : univ . of arizona press ) , in press vedel , h. , hellsten , u. , & sommer - larsen , j. 1999 , , 271 , 743 verheijen , m. , bershady , m. , & andersen d. 2002 , mass galaxies at low and high redshift ( eso workshop , venice ) pp .",
    "24 - 26 wada , k. & norman , c.  a. 2001 , , 547 , 172 yepes , g. , kates , r. , khokhlov , a. , & klypin , a. 1997 , , 284 , 235"
  ],
  "abstract_text": [
    "<S> we describe deva , a multistep ap3m - like - sph code particularly designed to study galaxy formation and evolution in connection with the global cosmological model . </S>",
    "<S> this code uses a formulation of sph equations which ensures both energy and entropy conservation by including the so - called @xmath0 terms . </S>",
    "<S> particular attention has also been paid to angular momentum conservation and to the accuracy of our code . </S>",
    "<S> we find that , in order to avoid unphysical solutions , our code requires that cooling processes must be implemented in a non - multistep way .    </S>",
    "<S> we detail various cosmological simulations which have been performed to test our code and also to study the influence of the @xmath0 terms . </S>",
    "<S> our results indicate that such correction terms have a non - negligible effect on some cosmological simulations , especially on high density regions associated either to shock fronts or central cores of collapsed objects . </S>",
    "<S> moreover , they suggest that codes paying a particular attention to the implementation of conservation laws of physics at the scales of interest , can attain good accuracy levels in conservation laws with limited computational resources . </S>"
  ]
}