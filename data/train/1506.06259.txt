{
  "article_text": [
    "characterizing the metastable ( long - lived ) states , their equilibrium probabilities and the transition rates between them are essential aims of molecular dynamics ( md ) simulation . due to increasing availability of high - performance computing resources for mass production of md data",
    ", there is an increasing interest in systematic and automatic construction of models of the metastable dynamics , such as markov state models ( msms ) @xcite and diffusion maps @xcite .",
    "alternative methods to analyze the space explored by md simulations include sketchmap @xcite , pca @xcite , kernel - pca @xcite , and likelihood maximization @xcite .",
    "see @xcite for a more extensive review .",
    "critical component in any analysis of metastable dynamics from md data are ( 1 ) the choice of suitable coordinates and ( 2 ) a distance metric on these coordinates , such that slowly - interconverting states are distinguished .",
    "the first question has been answered : building on conformation dynamics theory @xcite it has been shown that the eigenfunctions of the backward markov propagator underlying the md are the optimal reaction coordinates : projecting the dynamics upon these eigenfunctions will give rise to a maximum estimate of the timescales @xcite and an optimal separation of metastable states .",
    "a number of approaches are available to approximate these reaction coordinates from md data : diffusion maps @xcite , markov state models @xcite and markov transition models @xcite , tica @xcite and kernel tica @xcite . the variational approach for conformation dynamics ( vac ) @xcite is a generalization to all aforementioned models except for diffusion maps and describes a general approach to combine and parametrize basis functions so as to optimally define the true eigenfunctions of the backward propagator .    the second question , i.e. the choice of a distance metric has been answered in the context of diffusion maps .",
    "diffusion maps model the observed data as emerging from a diffusion process @xcite .",
    "this approach has been used to model molecular conformation dynamics @xcite and to guide further sampling @xcite .",
    "the diffusion distance , introduced in @xcite defines a distance metric that measures how slowly conformations interconvert .",
    "however , the definition of the diffusion distance is not limited to diffusion processes or even to reversible markov processes .    here",
    "we define the kinetic distance for markov processes that have a unique equilibrium distribution , such as md simulation . for reversible",
    "markov processes the kinetic distance takes the same simple form as the diffusion distance and can be computed from any model that provides an approximation to the eigenvalues and eigenfunctions of the md backward propagator . here",
    "we employ the time - lagged independent component analysis ( tica ) @xcite which approximates these eigenvalues and eigenfunctions in terms of a linear combinations of molecular coordinates such as atomic positions , distances or angles .",
    "while tica does not provide the best possible approximation to the true eigenfunctions , it can be directly applied to molecular dynamics data , requires few modeling decisions to be made , and is readily available in the markov modeling packages emma @xcite ( www.pyemma.org ) and msmbuilder @xcite .    using the tica eigenvalues and eigenvectors we employ the kinetic distance as a distance metric . as in diffusion maps",
    ", the approximate eigenvectors can be rescaled so as to define a kinetic map in which the euclidean distance is equivalent to the kinetic distance .",
    "this provides an optimal space to perform clustering , markov modeling , and diffusion map , or to use the variational approach for conformation dynamics and performing other analyses of the metastable dynamics .",
    "the kinetic map gives a clear answer to the previously arbitrary decision on how many dimensions should be kept in the tica transformation : in principle all dimensions are kept , but as a result of the scaling the dimensions with small eigenvalues contribute very little to the kinetic distance . in order to reduce the computational cost , we can choose to keep only the eigenvectors that account for a certain fraction of the total variation in kinetic distance , as it is commonly practiced in principal component analysis @xcite .",
    "we demonstrate the approach using tica and msm analyses for illustrative models , protein conformation dynamics in bovine pancreatic trypsin inhibitor and protein - inhibitor association in trypsin and benzamidine . by invoking the variational principle @xcite as a means of model comparison",
    ", it is shown that the kinetic map generally provides better msms than by using unscaled tica with manually selected dimension .",
    "suppose we have a dynamical system ( here molecular dynamics ) with a state space @xmath3 .",
    "@xmath3 formally includes positions , momenta and if needed other state variables such as the simulation box size , although we will later make approximations such as working with only a subset of the configuration coordinates .",
    "our dynamics generates a time sequence of states @xmath4 by means of a markovian algorithm , i.e. some implementation of time - step integrator , thermostat , etc .",
    "that allows us to compute the system state in the subsequent time step as a function of the current state . in this framework",
    "there is a transition density @xmath5 , the probability density of finding the system at state @xmath6 at time @xmath7 given that we have started it at state @xmath8 at time 0 .",
    "given these preliminaries we can write the propagation of a probability density of states @xmath9 in time as : @xmath10 where @xmath11 is the dynamical propagator , i.e. the markov operator describing the action of the integral in ( [ eq : propagator_1 ] ) .",
    "finally , we require that there is a unique equilibrium distribution ( usually the boltzmann distribution ) defined by : @xmath12 the above requirements are minimal as they are fulfilled by almost every implementation of molecular dynamics .",
    "there is an alternative description to ( [ eq : propagator_1 ] ) by using the backward propagator , @xmath13 , ( also known as transfer operator @xcite ) , which propagates the weighted densities @xmath14 .",
    "thus : @xmath15    we define the kinetic distance @xmath16 as the diffusion distance introduced in @xcite in the more general context of the above irreducible markov processes .",
    "@xmath16 is a distance measure between any of the two states @xmath17 and parametrically depends on a lag time @xmath7 .",
    "@xmath16 is defined as the distance between the system s probability densities at time @xmath7 , given that we have initialized the system either at state @xmath18 or at state @xmath19 at time @xmath20 : @xmath21 the above definition is identical to the concept of the diffusion distance except for the fact that in principle we allow @xmath18 , @xmath19 and @xmath6 to be not only positions but also momenta and other state variables .",
    "this modification is needed in order to derive expressions of the kinetic distance that also apply to nonreversible dynamics .",
    "furthermore , the original name diffusion distance comes from the fact that it has been derived in a context where the dynamics @xmath5 come from a diffusion process . here",
    "we will apply ( [ eqn : diffdist1 ] ) to a wider class of markovian dynamics , and therefore use the term kinetic distance rather than diffusion distance throughout the article .      in order to derive practically useful expressions of the kinetic distance",
    ", we need to conduct a spectral decomposition of ( [ eq : propagator_1 ] ) .",
    "given the propagator @xmath11 with eigenfunctions @xmath22 and the backward propagator @xmath13 with eigenfunctions @xmath23 , and we suppose that our propagator has a number of @xmath24 discrete eigenpairs .",
    "the rest of the spectrum is bounded by the ball with radius @xmath25 and it will be called @xmath26 .",
    "we can write the propagation of densities @xmath27 as follows : @xmath28 the norm of all eigenvalues decay exponentially with increasing lag time .",
    "we suppose that we operate at a lag time @xmath7 such that @xmath29 , and thus @xmath30 is approximately 0 everywhere .",
    "then we can effectively describe the dynamics as : @xmath31 and for the choice @xmath32 this becomes : @xmath33    we sort the eigenvalues by non - increasing norm : @xmath34 the eigenfunction @xmath35 corresponding to the eigenvalue @xmath36 is given by the boltzmann equilibrium distribution .",
    "note that we have not made any restriction with respect to the reversibility of the dynamics as it is usually done in markov modeling @xcite .",
    "thus the eigenvalues @xmath37 can either be all real - valued , or consist of a mix of real eigenvalues and complex conjugate pairs . for the calculation of the kinetic distance these cases need to be treated slightly differently .      [",
    "[ nonreversible - dynamics ] ] nonreversible dynamics + + + + + + + + + + + + + + + + + + + + + +    inserting ( [ eqn : spectral_decomposition ] ) into ( [ eqn : diffdist1 ] ) yields : @xmath38 as a result of @xmath39 , the first term with @xmath40 disappears . evaluating the square norm leads to the following double sum : @xmath41 the above expression is applicable to any markov process with a unique stationary distribution .",
    "unfortunately ( [ eq : diffdist_nonrev ] ) requires both the propagator and the backward propagator eigenvectors , and there are only few models for nonreversible dynamics that provide both sets of eigenvectors .",
    "markov state models provide both eigenvectors ( as left and right eigenvectors of the transition matrix ) .",
    "moreover it is possible to design markov transition models @xcite such that both sets of eigenvectors can be computed",
    ".    for nonreversible dynamics , there can be complex eigenvalues and eigenvectors which come in complex conjugate pairs @xmath42 and @xmath43 .",
    "these are handled as follows : a complex conjugate pair is rewritten into a real pair of eigenvalues / eigenvectors by separating their real and imaginary parts : @xmath44 note that the sign is irrelevant , so it does nt matter if we use @xmath42 or @xmath43 for the imaginary part .",
    "the transformed eigenvalue / vector set which is still the same rank but now real - valued is inserted into eq .",
    "( [ eq : diffdist_nonrev ] ) to compute the diffusion distance .    [",
    "[ reversible - dynamics ] ] reversible dynamics + + + + + + + + + + + + + + + + + + +    for reversible dynamics the detailed balance equations hold . in that case every pair of points @xmath8 , @xmath6 satisfies : @xmath45 in this case all eigenvalues @xmath46 are real and can be associated with relaxation rates @xmath47 and timescales @xmath48 as : @xmath49 moreover , all associated eigenvectors @xmath50 are real and related by : @xmath51    given eq . (",
    "[ eq : eigenvectors - l - r - rev ] ) , we have @xmath52 where @xmath53 is the dirac delta .",
    "thus , only the @xmath54 terms survive in eq .",
    "( [ eqn : spectral_decomposition ] ) , which simplifies to : @xmath55 which is identical to the expression for the diffusion distance @xcite",
    ". note , however , we can apply it to any dynamics which is reversible in the state space used in our model .",
    "diffusion maps employ smoluchowski or brownian dynamics which are reversible .",
    "langevin dynamics , which is more commonly used for thermostatting md simulations fulfills a generalized detailed balance in phase space with respect to momentum inversion .",
    "moreover , it has been recently shown that langevin dynamics fulfills ( [ eq : db ] ) in position space when integrating over momenta @xcite . since kinetic models for estimating eigenvalues and eigenvectors",
    "are usually estimated in position space ( or a subset thereof ) , langevin dynamics is consistent with the reversible diffusion distance eq .",
    "( [ eq : diffdist_rev ] ) .    based on eq .",
    "( [ eq : diffdist_rev ] ) , we can define the weighted coordinates @xmath56 which define the kinetic map : @xmath57 the kinetic map is a new set of coordinates in which data points @xmath8 have been transformed such that their euclidean distance corresponds to their diffusion distance : @xmath58 when the transition density @xmath59 originates from a diffusion process , then @xmath60 is called a diffusion map @xcite .",
    "if the number of available eigenvectors @xmath24 is large , then evaluating distances in ( [ eq : kinetic_map ] ) is computationally costly .",
    "however , this is often unnecessary because many eigenvalues may be small and the corresponding dimensions in the kinetic map contribute little to the overall distance .",
    "we can employ an approach commonly used in principal component analysis with geometric distances : we compute the variance of the diffusion distance along each coordinate : @xmath61 and the cumulative variance fraction ( remember the eigenvalues are sorted by decreasing norm ) by : @xmath62 we can then decide to truncate the distance after @xmath63 terms where a certain cumulative variance threshold ( e.g. 95% ) . the approximate diffusion distance is then given by : @xmath64      in order to apply the kinetic distance and kinetic maps , we need an algorithm that will approximate the eigenvalues @xmath65 and eigenfunctions @xmath66 . as described in the introduction",
    "a number of methods are available for this . here",
    "we choose to use the tica method as implemented in pyemma .",
    "although tica only provides only a rather rough approximation to eigenvalues and eigenfunctions , it is very easy to use , very robust , and has few parameters to choose .",
    "given md data , we chose a ( usually large ) set of input coordinates @xmath67 , such as cartesian coordinates ( if there is a reference to orient the solute molecule(s ) to ) or internal coordinates ( inter - residue distances , rotamer dihedral angles , etc . ) .",
    "we define the mean - free coordinates : @xmath68 and compute the covariance matrix and time - lagged covariance matrix for a given lag time @xmath7 : @xmath69 in practice , means and covariances are computed by their empirical estimators , and the time - lagged covariance matrix is symmetrized .",
    "we then solve the generalized eigenvalue problem : @xmath70 we have the following approximations for the eigenvalues and eigenfunctions of the backward propagator : @xmath71 the approach above is a special case of the variational approach of conformation dynamics @xcite , using the choice ( [ eq : tica_basis_set ] ) as a basis set . according to the variational principle @xcite , the eigenvalues @xmath72 will only be exactly @xmath65 if @xmath73 and otherwise will be underestimated . for finite data",
    "there are statistical errors on top of these approximation errors , and therefore the underestimation is denoted as an approximation in eq .",
    "( [ eq : tica_eig_estimate ] ) .",
    "we then apply the following approach :    1 .",
    "perform tica and compute the eigenvectors @xmath74 and eigenvalues @xmath72 .",
    "2 .   define the * kinetic map * by scaling all coordinates as @xmath75 3 .",
    "the kinetic distance is defined by @xmath76    note that tica already projects the stationary eigenvector @xmath77 out as a consequence of its construction with mean - free coordinates ( [ eq : tica_basis_set ] ) . as a result",
    ", all approximated eigenvectors and eigenvalues are kept and the diffusion distance ( [ eq : diffdist_rev ] ) runs through all terms @xmath78 .",
    "we demonstrate the behavior of the proposed kinetic distance using time - series of two pedagogical and two real molecular systems .",
    "all analyses are run with pyemma ( www.pyemma.org ) .    in all examples , we conduct the following data analysis :    1 .",
    "transformation of the input coordinates to an approximation of eigenvalues and eigenfunctions @xmath79 using tica .",
    "cluster discretization of ( i ) the transformed space @xmath80 , ( ii ) dimension - reduced versions of it ( tica projections ) as previously practiced @xcite , and ( iii ) the full - dimensional kinetic map ( scaled tica transformation ) proposed here .",
    "we use the same clustering method and equal number of clusters for the same system to get comparable results .",
    "3 .   compute markov models using these different discretization and compare them using the variational principle @xcite .    in order to compare different markov models we employ the variational principle of conformation dynamics @xcite , which states that the approximated eigenvalues computed via ( [ eq : gev ] ) underestimate the true eigenvalues : @xmath81 and that equality is only obtained when the corresponding eigenfunction is correct ( @xmath82 ) . as a consequence",
    ", we can make the same statement about approximated relaxation timescales : @xmath83 straightforward fitness functions to compare markov models obtained in different ways are then the partial eigensum ( sum over the first @xmath84 eigenvalues ) or the partial timescales sum .",
    "here we use the mean relaxation timescale : @xmath85 as we are doing only one tica projection per molecular system we do not use the tica timescales but rather the final msm timescales in ( [ eq : timescale_sum ] ) .",
    "this will compare the quality of the different projections / metrics ( full tica , truncated tica or scaled tica / kinetic map ) with respect to their ability to resolve the metastable dynamics using a fixed clustering approach .",
    "* two - state hidden markov models *    we start by illustrating two pedagogical examples that are realized by hidden markov models ( hmms ) with gaussian output . in the first example , our approach works especially well and in the second example it fails as the result of a poor tica approximation .    in order to have a known reference for the timescales we fix a transition matrix between two metastable states : @xmath86\\ ] ] which leads to a single relaxation timescale of @xmath87 steps . in order to generate coordinates",
    "we let each of the two states sample from two - dimensional gaussian distributions using means @xmath88 and covariance matrices @xmath89 given by :    @xmath90    in order to analyze systematic rather than statistical behavior we simulated this model for an extensive 250,000 steps starting from state 1 . in every simulation step",
    "we take a step using the transition matrix @xmath91 ( on average transitioning to the other state every 100 steps ) , and generate a point from gaussian distribution 1 or 2 , depending which state we are in . fig .",
    "[ fig : hmm1]a shows a scatterplot for the resulting simulation .",
    "additional details on how to construct a hmm can be found in @xcite .    in this example",
    ", tica works especially well .",
    "[ fig : hmm1]a shows that while the main geometric variance is along the @xmath92-direction ( pca would find that as principal component ) , the slow process is along the @xmath93-direction .",
    "indeed the first independent component ( ic ) points exactly along the @xmath93-direction , while the second ic points towards a mixtures of @xmath93 and @xmath92 directions ( note that the ics are not orthogonal in cartesian space but rather in the space weighted by the equilibrium distribution ) .",
    "the arrows are drawn proportional to the tica eigenvalues which are @xmath94 and @xmath95 .",
    "we compare two metrics : euclidean distance in the two - dimensional tica space @xmath96 and the kinetic map @xmath97 .",
    "we conduct regular space clustering @xcite using 27 clusters in both cases .",
    "[ fig : hmm1]b shows the mean relaxation timescales as a function of the lag time for the two cases .",
    "it is seen that euclidean distance in the kinetic map performs much better than the unscaled tica space .",
    "the reason for this behavior is that the second eigenvalue is about zero , and thus the kinetic map effectively ignores @xmath98 .",
    "hence , in the kinetic map version , the 27 clusters perform a fine discretization of the slow reaction coordinate , which has been accurately found by tica .",
    "in contrast , in the unscaled tica version , the 27 clusters are scattered over a two - dimensional space , leading to a much poorer resolution of the reaction coordinate @xmath93 .",
    "thus , the kinetic map is better because tica has already identified the right coordinates - all we needed to do was to adjust the metric .",
    "let us look at a counterexample , where the current approach fails .",
    "although the theory of kinetic distance and kinetic map is correct , the crucial point is that we have to be able to generate a sufficiently good approximation of eigenfunctions and eigenvalues @xmath99 in order to apply it .",
    "tica does that by finding a linear combination of input coordinates and will fail when the true eigenfunctions @xmath23 are still highly nonlinear in these coordinates .",
    "so let s design a pathological example .",
    "we use the four - state transition matrix : @xmath100\\ ] ] and define gaussian distributions that output into two - dimensional cartesian space : @xmath101    the simulation is run again for 250,000 steps and the coordinates from the tica transformation or the kinetic map are discretized with 25 clusters using @xmath102-means .",
    "[ fig : hmm2]a shows the distribution of simulated points .",
    "the slow transition occurs between the two interlaced t motives and requires a zigzag path .",
    "thus , the reaction coordinate is highly nonlinear in the given input coordinates and tica can not find a linear combination that approximates the true reaction coordinate @xmath103 well .",
    "consequently , both tica coordinates are needed in order to resolve the reaction coordinate .",
    "unfortunately , tica projects the stationary process @xmath103 out by construction and the corresponding approximated eigenvalue @xmath104 becomes approximately zero .",
    "since there are only two eigenvalues in this example , the second coordinate is lost . as a result ,",
    "the kinetic map is poor and gives rise to a much poorer msm than the discretization of the unscaled tica coordinates ( fig .",
    "[ fig : hmm2]b ) .    note that this example is extremely pathological and is only supposed to show that there are rare combinations of poor choices in which the current approach can break down .",
    "the kinetic map has one dimension less than the original input space , as the first eigenfunction is constant ( in tica this coordinate is projected out as a result of removing the mean in the basis functions ( [ eq : tica_basis_set ] ) ) .",
    "since in our example tica needed both input coordinates for a good approximation of the reaction coordinate , a poor kinetic map was obtained .",
    "when a third input coordinate is added , this problem disappears .",
    "molecular problems are usually high - dimensional and are thus not expected to cause the observed problem . however , a general lesson from this example is that kinetic map will only be a good approximation of the real kinetic map @xmath105 , and thus lead to near - optimal distance metric , if we have a good approximation of the eigenvalues and eigenfunctions @xmath106 .",
    "although tica and more general the method of linear variation @xcite only find linear combinations of input coordinates we can turn these methods into excellent approximators of nonlinear eigenfunctions by providing suitable input coordinates . in md simulations , coordinates such as interaction distances , contacts or torsion angles are expected to play a role in the optimal reaction coordinates .",
    "fortunately we do not need to make a restrictive choice of coordinates , but can simply add all promising coordinates to the input set and then run tica or the method of linear variation in order to find good combinations .",
    "[ [ bovine - pancreatic - trypsin - inhibitor - bpti ] ] bovine pancreatic trypsin inhibitor ( bpti ) + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us turn to protein simulations .",
    "we analyzed a one - millisecond simulation of bpti produced by d. e. shaw research using the anton supercomputer @xcite ( see there for simulation setup ) .",
    "the trajectory was subsampled every 10 ns , providing 100,000 frames that are sufficient for our analysis .",
    "we then used the 174 coordinates of the 58 @xmath107-atoms after aligning them to their means as an input data set .",
    "we consider four metrics : ( i ) euclidean metric in the full tica space , projection onto the first two ( ii ) and the first six ( iii ) ic s , where gaps are found in the tica timescales , and ( iv ) the kinetic map of all scaled tica - coordinates .",
    "@xmath102-means clustering with 100 clusters was used in all cases .",
    "[ fig : bpti]a , b ) show that the results using two and six ic s are similar , but the msms built on all tica coordinates are much worse .",
    "the space is so high - dimensional that the clusters can not efficiently discretize the slow reaction coordinates .",
    "in contrast , the kinetic map results are significantly better than all other setups , in particular in terms of finding a converged slowest relaxation timescale .    in order to get an idea of the effective dimensionality of the kinetic map , fig .",
    "[ fig : bpti]c shows the cumulative kinetic variance as a function of the kinetic map dimension .",
    "95% of the variance are obtained after only 13 dimensions , indicating that the data analysis pipeline can work with relatively low - dimensional data after the tica step .",
    "[ fig : bpti]d shows the first two dimensions of the bpti kinetic map with correctly scaled coordinates .",
    "three metastable states are apparent in this projection whose structures are depicted in fig .",
    "[ fig : bpti]e.1 - 3 .",
    "the slowest conformational transition between the pair ( 1,2 ) and state ( 3 ) ( about 60 @xmath108s ) involves an outward motion of the loop around residue 10 ( top right in the structure ) .",
    "the second - slowest transition ( about 20 @xmath108s ) involves minor concerted motions in the loop region and an exchange between an ordered set of structures ( 1 ) and a less ordered set of structures ( 2 ) .",
    "qualitatively , this analysis agrees with previous analyses of that system @xcite , but the relaxation timescale found here are larger than previously estimated . following the variational principle this means a better model was found here .",
    "[ [ trypsin - benzamidine ] ] trypsin - benzamidine + + + + + + + + + + + + + + + + + + +    finally , we analyzed protein - ligand association in benzamidine and trypsin using 491 trajectories of length 100 ns each that have been generated on gpugrid @xcite ( see there for simulation details ) .",
    "the trajectories were saved every 100 ps , providing 491,000 frames for the analysis . as coordinates we chose the distance between the @xmath109 atom of benzamidine with the @xmath107 atoms of trypsin , providing 223 distances .",
    "we consider four metrics : ( i ) euclidean metric in the full tica space , projection onto the first two ( ii ) and the first ten ( iii ) ic s , and ( iv ) the kinetic map of all scaled tica - coordinates .",
    "@xmath102-means clustering using 100 clusters was used in all cases .",
    "[ fig : trypsin]a , b ) show that the msms using two dimensions converge nicely to timescales of about 500 ns and 50 ns . for larger number of ics ( 10 and all ) the results",
    "become worse . on one hand",
    "100 clusters are no longer sufficient to discretize these higher - dimensional spaces , and on the other hand it seems that a different second - slowest process is found when looking at higher numbers of dimensions .",
    "the kinetic map results show significantly larger timescales than any of the other metrics .",
    "these timescales do not converge within the range of lagtimes shown , but it is known from @xcite that the benzamidine coordinates relative to trypsin are actually not sufficient to characterize the slowest processes in the system which are comprised of trypsin conformational switches .",
    "[ fig : bpti]c shows the cumulative kinetic variance as a function of the kinetic map dimension .",
    "95% of the variance are obtained after 52 out of 233 dimensions , indicating that the data can be reduced by a factor of about 4 - 5 with little losses .",
    "[ fig : bpti]d shows the first two dimensions of the trypsin - benzamidine kinetic map with correctly scaled coordinates .",
    "three metastable states are apparent in this projection whose structures are depicted in fig .",
    "[ fig : bpti]e.1 - 3 . according to the msm on the input",
    "coordinates used here , the slowest conformational transition is the binding unbinding transition , although we know that slower transitions exist in the protein conformation @xcite .",
    "the second - slowest process involves exchange with a binding intermediate where the ligand interacts with trypsin residues close to the binding site .",
    "qualitatively , this analysis agrees with previous analyses of that system that used the trypsin coordinates @xcite , but the kinetic map shows larger relaxation timescales . following the variational principle",
    "this means a better model was found here .",
    "the kinetic distance defined here is the optimal distance metric for analyzing metastable molecular dynamics . in practice ,",
    "the kinetic distance can only be computed approximately and requires a method that approximates the eigenvalues and eigenfunctions of the markov backward propagator underlying the md simulation . here",
    "we suggest to use the time - lagged independent component analysis ( tica ) as a fast and convenient method to transform a large set of cartesian or internal coordinates of the molecule into such an approximation .",
    "subsequently , the kinetic distance can be computed .",
    "the tica coordinates can be transformed into a kinetic map by weighting them with their eigenvalues . in this kinetic map , kinetic distances and euclidean distances",
    "are approximately equivalent , which makes it an excellent space for visualization and further analyses such as clustering , markov modeling , or diffusion map .",
    "we have shown that as long as pathological cases are avoided , the kinetic distance provides a distance metric that builds better markov models , because the tica components are weighted in such a way that the clustering algorithm can optimally concentrate on the slow coordinates .",
    "instead of projecting onto an arbitrary number of tica dimensions as in previous work , or trying to select optimal values using machine learning techniques , the present theoretical insights lead to a unique and indisputable choice of using all coordinates in a weighted form . to reduce computational effort ,",
    "a controlled truncation of the tica space can be made by defining the percentage of the cumulative variation in kinetic distance ( e.g. 95% ) .",
    "the method can be improved by using methods that provide better approximations of the true eigenvalues and eigenfunctions .",
    "much can be done here by choosing a more suitable set of input coordinates for the tica calculation , but a host of other related methods such as the variational approach for conformation dynamics , diffusion maps , and markov transition models are available that may further improve this estimate .",
    "the approach described herein is implemented in the development version of pyemma ( available at github.com/markovmodel/pyemma ) , and will be included in the next official release ( see www.pyemma.org for download instructions , documentation and examples ) .",
    "we have made kinetic maps the default setting when computing a tica transform .",
    "we thank kyle beauchamp ( mskcc new york ) , john chodera ( mskcc new york ) , benedict leimkuhler ( university of edinburgh ) and alessandro laio ( sissa trieste ) for inspiring discussions .",
    "special thanks to ben for organizing a great workshop which was the starting point for this paper .",
    "we are grateful to gianni de fabritiis for sharing the trypsin - benzamidine data and d. e. shaw research for sharing the bpti data .",
    "cc is supported by national science foundation ( grants che-1152344 and che-1265929 ) and the welch foundation ( grant c-1570 ) .",
    "fn is supported by european commission erc starting grant 307494-pccell and deutsche forschungsgemeinschaft ( grant no 825/3 - 1 ) .",
    "j.  d. chodera , n.  singhal , v.  s. pande , k.  a. dill , and w.  c. swope",
    ". automatic discovery of metastable states for the construction of markov models of macromolecular conformational dynamics .",
    ", 126(15 ) , april 2007 .",
    "r.  r. coifman , s.  lafon , a.  b. lee , m.  maggioni , b.  nadler , f.  warner , and s.  w. zucker .",
    "geometric diffusions as a tool for harmonic analysis and structure definition of data : diffusion maps .",
    ", 102:74267431 , 2005 .",
    "b.  nadler , s.  lafon , r.  r. coifman , and i.  g. kevrekidis .",
    "diffusion maps , spectral clustering and eigenfunctions of fokker  planck operators . in _ neural information processing systems ( nips ) _ , volume  18 , 2005 .",
    "mary  a. rohrdanz , wenwei zheng , and cecilia clementi . discovering mountain passes via torchlight : methods for the definition of reaction coordinates and pathways in complex macromolecular reactions .",
    ", 64:295316 , 2013 .",
    "a)comparison of markov models using scaled and unscaled tica .",
    "( a ) the data was generated by a two - state hidden markov model with gaussian output distributions .",
    "( b ) implied relaxation timescales using scaled and unscaled tica followed by regular - space clustering with 28 clusters each .",
    ", title=\"fig : \" ]    b)comparison of markov models using scaled and unscaled tica .",
    "( a ) the data was generated by a two - state hidden markov model with gaussian output distributions .",
    "( b ) implied relaxation timescales using scaled and unscaled tica followed by regular - space clustering with 28 clusters each .",
    ", title=\"fig : \" ]    a)comparison of markov models using scaled and unscaled tica .",
    "( a ) the data was generated by a two - state hidden markov model with gaussian output distributions .",
    "( b ) implied relaxation timescales using scaled and unscaled tica followed by regular - space clustering with 28 clusters each .",
    ", title=\"fig : \" ]    b)comparison of markov models using scaled and unscaled tica .",
    "( a ) the data was generated by a two - state hidden markov model with gaussian output distributions .",
    "( b ) implied relaxation timescales using scaled and unscaled tica followed by regular - space clustering with 28 clusters each .",
    ", title=\"fig : \" ]    a)comparison of markov models of bpti ( 1 millisecond anton trajectory @xcite ) using different tica projections and the kinetic map .",
    "tica using the c@xmath110 coordinates of oriented bpti configurations .",
    "msms built based on projections onto 2 , 6 and all dimensions and the kinetic map were compared .",
    "( a ) the two slowest implied relaxation timescales .",
    "( b ) mean of the two slowest relaxation timescales .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 13 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e.1 - 3 ) structures of the metastable states indicated in ( d).,title=\"fig : \" ] b)comparison of markov models of bpti ( 1 millisecond anton trajectory @xcite ) using different tica projections and the kinetic map .",
    "tica using the c@xmath110 coordinates of oriented bpti configurations .",
    "msms built based on projections onto 2 , 6 and all dimensions and the kinetic map were compared .",
    "( a ) the two slowest implied relaxation timescales .",
    "( b ) mean of the two slowest relaxation timescales .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 13 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e.1 - 3 ) structures of the metastable states indicated in ( d).,title=\"fig : \" ] c)comparison of markov models of bpti ( 1 millisecond anton trajectory @xcite ) using different tica projections and the kinetic map .",
    "tica using the c@xmath110 coordinates of oriented bpti configurations .",
    "msms built based on projections onto 2 , 6 and all dimensions and the kinetic map were compared .",
    "( a ) the two slowest implied relaxation timescales .",
    "( b ) mean of the two slowest relaxation timescales .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 13 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e.1 - 3 ) structures of the metastable states indicated in ( d).,title=\"fig : \" ]    d)comparison of markov models of bpti ( 1 millisecond anton trajectory @xcite ) using different tica projections and the kinetic map .",
    "tica using the c@xmath110 coordinates of oriented bpti configurations .",
    "msms built based on projections onto 2 , 6 and all dimensions and the kinetic map were compared .",
    "( a ) the two slowest implied relaxation timescales .",
    "( b ) mean of the two slowest relaxation timescales .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 13 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e.1 - 3 ) structures of the metastable states indicated in ( d).,title=\"fig : \" ]    e.1 ) comparison of markov models of bpti ( 1 millisecond anton trajectory @xcite ) using different tica projections and the kinetic map .",
    "tica using the c@xmath110 coordinates of oriented bpti configurations .",
    "msms built based on projections onto 2 , 6 and all dimensions and the kinetic map were compared .",
    "( a ) the two slowest implied relaxation timescales .",
    "( b ) mean of the two slowest relaxation timescales .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 13 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e.1 - 3 ) structures of the metastable states indicated in ( d).,title=\"fig : \" ] e.2)comparison of markov models of bpti ( 1 millisecond anton trajectory @xcite ) using different tica projections and the kinetic map .",
    "tica using the c@xmath110 coordinates of oriented bpti configurations .",
    "msms built based on projections onto 2 , 6 and all dimensions and the kinetic map were compared .",
    "( a ) the two slowest implied relaxation timescales .",
    "( b ) mean of the two slowest relaxation timescales .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 13 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e.1 - 3 ) structures of the metastable states indicated in ( d).,title=\"fig : \" ] e.3)comparison of markov models of bpti ( 1 millisecond anton trajectory @xcite ) using different tica projections and the kinetic map .",
    "tica using the c@xmath110 coordinates of oriented bpti configurations .",
    "msms built based on projections onto 2 , 6 and all dimensions and the kinetic map were compared .",
    "( a ) the two slowest implied relaxation timescales .",
    "( b ) mean of the two slowest relaxation timescales .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 13 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e.1 - 3 ) structures of the metastable states indicated in ( d).,title=\"fig : \" ]    a)comparison of markov models of trypsin - benzamidine dynamics ( 491 gpugrid trajectories of 100 ns each @xcite ) using different tica projections and scaled tica .",
    "tica using the distances from benzamidin to all trypsin - c@xmath110 coordinates had 135 usable eigenvalues .",
    "projections onto 2 , 5 , 10 and all 135 dimensions ( unscaled ) were compared to scaled tica .",
    "( a ) implied relaxation timescales .",
    "( b ) mean relaxation timescale .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 50 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e ) md configurations sampled from the three metastable states visible in d ( 1 : bound , 2 : dissociated , 3 : pre - bound).,title=\"fig : \" ] b)comparison of markov models of trypsin - benzamidine dynamics ( 491 gpugrid trajectories of 100 ns each @xcite ) using different tica projections and scaled tica .",
    "tica using the distances from benzamidin to all trypsin - c@xmath110 coordinates had 135 usable eigenvalues .",
    "projections onto 2 , 5 , 10 and all 135 dimensions ( unscaled ) were compared to scaled tica .",
    "( a ) implied relaxation timescales .",
    "( b ) mean relaxation timescale .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 50 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e ) md configurations sampled from the three metastable states visible in d ( 1 : bound , 2 : dissociated , 3 : pre - bound).,title=\"fig : \" ] c)comparison of markov models of trypsin - benzamidine dynamics ( 491 gpugrid trajectories of 100 ns each @xcite ) using different tica projections and scaled tica .",
    "tica using the distances from benzamidin to all trypsin - c@xmath110 coordinates had 135 usable eigenvalues .",
    "projections onto 2 , 5 , 10 and all 135 dimensions ( unscaled ) were compared to scaled tica .",
    "( a ) implied relaxation timescales .",
    "( b ) mean relaxation timescale .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 50 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e ) md configurations sampled from the three metastable states visible in d ( 1 : bound , 2 : dissociated , 3 : pre - bound).,title=\"fig : \" ]    \\d ) comparison of markov models of trypsin - benzamidine dynamics ( 491 gpugrid trajectories of 100 ns each @xcite ) using different tica projections and scaled tica .",
    "tica using the distances from benzamidin to all trypsin - c@xmath110 coordinates had 135 usable eigenvalues .",
    "projections onto 2 , 5 , 10 and all 135 dimensions ( unscaled ) were compared to scaled tica .",
    "( a ) implied relaxation timescales .",
    "( b ) mean relaxation timescale .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 50 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e ) md configurations sampled from the three metastable states visible in d ( 1 : bound , 2 : dissociated , 3 : pre - bound).,title=\"fig : \" ] e.1)comparison of markov models of trypsin - benzamidine dynamics ( 491 gpugrid trajectories of 100 ns each @xcite ) using different tica projections and scaled tica .",
    "tica using the distances from benzamidin to all trypsin - c@xmath110 coordinates had 135 usable eigenvalues .",
    "projections onto 2 , 5 , 10 and all 135 dimensions ( unscaled ) were compared to scaled tica .",
    "( a ) implied relaxation timescales .",
    "( b ) mean relaxation timescale .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 50 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e ) md configurations sampled from the three metastable states visible in d ( 1 : bound , 2 : dissociated , 3 : pre - bound).,title=\"fig : \" ]    e.2)comparison of markov models of trypsin - benzamidine dynamics ( 491 gpugrid trajectories of 100 ns each @xcite ) using different tica projections and scaled tica .",
    "tica using the distances from benzamidin to all trypsin - c@xmath110 coordinates had 135 usable eigenvalues .",
    "projections onto 2 , 5 , 10 and all 135 dimensions ( unscaled ) were compared to scaled tica .",
    "( a ) implied relaxation timescales .",
    "( b ) mean relaxation timescale .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 50 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e ) md configurations sampled from the three metastable states visible in d ( 1 : bound , 2 : dissociated , 3 : pre - bound).,title=\"fig : \" ] e.3)comparison of markov models of trypsin - benzamidine dynamics ( 491 gpugrid trajectories of 100 ns each @xcite ) using different tica projections and scaled tica .",
    "tica using the distances from benzamidin to all trypsin - c@xmath110 coordinates had 135 usable eigenvalues .",
    "projections onto 2 , 5 , 10 and all 135 dimensions ( unscaled ) were compared to scaled tica . ( a )",
    "implied relaxation timescales .",
    "( b ) mean relaxation timescale .",
    "( c ) cumulative variance of the diffusion distance .",
    "95% is reached by using 50 eigenvectors .",
    "( d ) kinetic map ( first two dimensions ) .",
    "( e ) md configurations sampled from the three metastable states visible in d ( 1 : bound , 2 : dissociated , 3 : pre - bound).,title=\"fig : \" ]"
  ],
  "abstract_text": [
    "<S> characterizing macromolecular kinetics from molecular dynamics ( md ) simulations requires a distance metric that can distinguish slowly - interconverting states . </S>",
    "<S> here we build upon diffusion map theory and define a kinetic distance for irreducible markov processes that quantifies how slowly molecular conformations interconvert . </S>",
    "<S> the kinetic distance can be computed given a model that approximates the eigenvalues and eigenvectors ( reaction coordinates ) of the md markov operator . here </S>",
    "<S> we employ the time - lagged independent component analysis ( tica ) . </S>",
    "<S> the tica components can be scaled to provide a kinetic map in which the euclidean distance corresponds to the kinetic distance . as a result , </S>",
    "<S> the question of how many tica dimensions should be kept in a dimensionality reduction approach becomes obsolete , and one parameter less needs to be specified in the kinetic model construction . </S>",
    "<S> we demonstrate the approach using tica and markov state model ( msm ) analyses for illustrative models , protein conformation dynamics in bovine pancreatic trypsin inhibitor and protein - inhibitor association in trypsin and benzamidine .    </S>",
    "<S> @xmath0 : fu berlin , department of mathematics , computer science and bioinformatics , arnimallee 6 , 14195 berlin    @xmath1 : rice university , center for theoretical biological physics , and department of chemistry , houston , tx 77005    @xmath2 : correspondence to frank.noe@fu-berlin.de or cecilia@rice.edu </S>"
  ]
}