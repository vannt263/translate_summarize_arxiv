{
  "article_text": [
    "the gas dynamics of many astrophysical systems is affected by radiation from an external source - planets and moons are irradiated by their host star , white dwarves can be evaporated by their companion , outflows are radiatively driven by agn and the outer layers of accretion discs are irradiated by their inner regions .",
    "it is therefore important to develop very general yet robust numerical methods for simulating the heating of hydrodynamic systems by external radiation fields .",
    "we developed such a method using the photoionization code xstar ( bautista & kallman 2001 ) and mhd code athena++ ( gardiner & stone 2005 , 2008 ) and applied it to study how different spectral energy distributions ( seds ) of external radiation fields affect the observable properties of thermally driven spherical winds .",
    "one possible mechanism for launching winds observed in agns and ysos is thermal driving . in a thermally driven wind ,",
    "the thermal energy of the gas comes to dominate the gravitational binding energy of the central object and the wind launches .",
    "if the thermal energy at the base is insufficient to launch the wind this scenario can still operate provided an external radiation source , such as the central object , heats the gas to sufficiently high temperatures .",
    "the innermost regions of agn and xrbs are known to be strong emitters of x - rays .",
    "these can heat the gas and provide the thermal energy required for wind launching .",
    "an interesting question therefore is how the sed of the external source affects the outflowing wind ?",
    "this has observational implications because it can provide a link between the x - ray spectra emitted by the central region and the lines produced further out in the wind .    in the most basic physical picture ,",
    "gas at the base of the wind is cold and slow and thermal processes dominate over the dynamical processes .",
    "the external radiation source heats the wind and the gas evolves along the radiative equilibrium curve . once the gas is hot enough , dynamical processes become important and the gas departs from equilibrium .",
    "precisely when this occurs depends on the flux of incident radiation .",
    "this is observationally interesting because the line emission and absorption depends on the temperature and ionization state of the wind .",
    "we consider various external radiation seds and determine their heating and cooling rates using the xstar photoionization code as a function of gas temperature and ionization",
    ". observed seds are typically a superposition of more basic spectra , such as a low temperature blackbody and high frequency powerlaw .",
    "therefore we first consider more basic seds such as bremsstrahlung and blackbody to elucidate the basic physics at play .",
    "we then use observational seds from type 1 and type 2 agn and soft state and hard state xrbs and generate the corresponding heating rates .",
    "these heating rates are used to find spherically symmetric wind solutions using the mhd code athena++ .",
    "these are used to determine the effects of radiation flux and driving sed on the observationally interesting wind properties such as mass flux and absorption measure distribution .",
    "the structure of this paper is as follows . in  [",
    "sec : numerical_methods ] we describe our numerical methods including the photoionization code xstar , the mhd code athena++ and our implementation of the heating / cooling module . in ",
    "[ sec : general_results ] we apply these methods to find spherically symmetric winds thermally driven by different types of external radiation fields and explore their observational features . in  [ sec : discussion ] we summarize our findings and discuss the limitations and future applications of these methods , in particular their relevance to 2d and 3d simulations .",
    "we are interested in performing hydrodynamic simulations where the radiative heating / cooling is calculated self - consistently using a photoionization code .",
    "we implement a heating / cooling module into athena++ where the energy equation is sourced by a net cooling rate @xmath0 that accounts for the radiative heating and cooling of the gas by an external source . the rate is calculated self - consistently using the xstar photoionization code as a function of temperature @xmath1 and ionization parameter @xmath2 . since xstar calculations",
    "are computationaly expensive , we precalculate @xmath3 on a grid @xmath4 .",
    "we then interpolate between points on this grid within athena++ to calculate the net heating .",
    "below we briefly describe our xstar simulation , athena++ simulation and implementation of the heating / cooling term .",
    "xstar is an atomic database ( bautista & kallman 2001 ) and corresponding photoionization modelling code xstarv2.35 . by assuming a certain sed of incident flux of radiation on a box of gas containing known species of gas",
    ", it calculates the heating / cooling rate as a function of temperature and ionization fraction in the gas . for a review of methods for modelling photoionized plasmas",
    "see kallman ( 2010 ) .    for ease in comparing results for different seds",
    "@xmath5 we relate the mean photon energy @xmath6 to the x - ray temperature @xmath7 via @xmath8 where @xmath9 is the boltzman constant and we use @xmath10 as the low energy x - ray cutoff .",
    "this ensures that at large ionization fractions , when compton processes dominate , the equilibrium curves will match up for all seds .",
    "though we find that the gas never reaches this compton temperature of @xmath11 in transonic solutions , our goal was to have the greatest possible uniformity across our runs .    within our xstar simulation",
    "we assume the heating / cooling in the gas is due to compton , x - ray , bremsstrahlung and line processes .",
    "our main model dependent assumptions are * 1 ) * composition of the gas . *",
    "2 ) * available atomic transitions . *",
    "3 ) * source sed .",
    "we use the elemental abundances described in verner , barthel & tytler ( 1994 ) where elements with abundances @xmath12 of hydrogen were set to zero .",
    "we found that gas composition can play an important role in determining the equilibrium curve .",
    "the agn cases exhibited an unphysical downwards dip at low ionization parameter . for these cases",
    "we therefore used the abundances in lodders , palme & gail ( 2009 ) .",
    "we expect most variations due to composition to occur at low ionization / temperature where line processes are important . because we are mainly interested in the relationship between the equilibrium curve and the wind we chose to leave a detailed study of the gas composition on the equilibrium curve for future work .",
    "comprehensive atomic data is crucial for determining the thermal properties of gases hotter than @xmath13 .",
    "xstarv2.35 incorporates over 200 000 lines for gas at a given @xmath14 .",
    "as photoionization codes improve by incorporating better atomic data and more comprehensive lists on atomic transitions our methods for calculating net heating will only improve .",
    "our main focus within this study is how the source sed affects the net heating rate and in turn affects the driven wind .",
    "we describe our philosophy regarding choice of seds in [ subsub : sed ] .",
    "the basic equations for single fluid hydrodynamics are    @xmath15    @xmath16    @xmath17    [ eq : hydro ]    where @xmath18 is the fluid density , @xmath19 the velocity , @xmath20 the pressure , @xmath21 is the gravitational potential of the central object and @xmath22 is the energy where @xmath23 is the internal energy .",
    "@xmath0 is the net cooling rate described in  [ sub : heating ] and is assumed to be a function of temperature @xmath1 and ionization parameter @xmath24 where @xmath25 is the x - ray flux which we assume to be uniform , @xmath26 is the mean molecular weight and @xmath27 is the proton mass .",
    "we take an equation of state @xmath28 where @xmath29 .",
    "the isothermal sound speed is @xmath30 and the adiabatic sound speed @xmath31 .",
    "we can compute the temperature from the internal energy via @xmath32 .",
    "we choose parameters for our different runs to be able to consistently compare simulations between different classes of seds .",
    "a useful measure for thermally driven winds is the hydrodynamic escape parameter @xmath33 , which measures the ratio of gravitational to thermal energy . at the base of the wind , for @xmath34",
    "the gas is gravitationally bound and no thermally driven outflow is expected .",
    "however for @xmath35 thermally driven hydrodynamic winds will be produced ( stone & proga 2009 ) we choose a central object mass @xmath36 . at the base of the wind , for most runs , we set the initial temperature @xmath37 and set @xmath38 .",
    "this sets the inner radius @xmath39 .",
    "the exception is for the blackbody sed , because the equilibrium curve is thermally unstable at this temperature , we set @xmath40 which corresponds to a @xmath41 and is still in the regime where winds can be thermally driven .",
    "these temperatures ensure that we are on the flat part of the s curve in the cold phase for all seds and also slightly away from any thermally unstable region . by initializing the gas in equilibrium near the star",
    ", the ionisation parameter @xmath42 is fixed for each sed .",
    "a physically relevant length scale for this problem is the compton radius @xmath43 which is the radius at which gas at @xmath44 has internal energy equal to its gravitational potential energy . for a stellar mass central object and our fiducial choice of compton temperature",
    "this corresponds to a compton radius @xmath45 .",
    "near the compton temperature , radiative processes will be dominated by compton heating and cooling .",
    "the compton heating rate can be used to define a critical radiation flux @xmath46 this corresponds to the flux at which x - rays can heat the gas to @xmath47 via compton processes in the sound crossing time of @xmath48 .",
    "this is the analogue of the critical luminosity of begelman , mckee & shields ( 1983 ) ( eq 2.12 ) for a uniform radiation field .",
    "we explore simulations where the flux ranges from @xmath49 .",
    "we are interested in wind solutions that have been launched due to heating .",
    "therefore we set the radius @xmath50 and the gas is initially at @xmath51 which are favourable conditions for radiative wind launching . by varying the flux we can study the effects of the particular sed on the launched winds .",
    "assuming a uniform radiation field allows us to define a fiducial density @xmath52 at the base of the wind for each sed via @xmath53 because the ionization parameter is fixed , a change in flux is equivalent to a change in density of the gas .",
    "a summary of our simulation parameters for all runs are shown in table [ table : run_summary ] .    [ cols=\"<,^,^,^,^,^,^,^,^ \" , ]      the simulation region extends from @xmath54 . by definition of the critical flux ,",
    "we expect the wind to heat to roughly @xmath47 over these length scales .",
    "we use a logarithmically spaced grid of @xmath55 points and a scale factor @xmath56 that defines the grid spacing recursively via @xmath57 .    at the inner boundary",
    "we impose outflow boundary conditions on @xmath19 and @xmath58 while keeping the density fixed at @xmath59 in the first active zone . as a result",
    "the ionization parameter @xmath42 is fixed in the first active zone .",
    "hence we do not enforce radiative equilibrium in the first active zone except at the initial time because the temperature can evolve away from its initial equilibrium value . at the outer boundary",
    "we impose outflow boundary conditions on @xmath18 , @xmath19 and @xmath58 .          within athena++",
    "we assume that all the microphysics incorporated into xstar is captured by a net cooling rate @xmath3 that depends only on the macroscopic gas properties , temperature @xmath1 and ionization parameter @xmath2 .",
    "we have implicitly assumed that the microphysical processes occur on much shorter time scales than the dynamical time governing the hydro simulation which justifies this approach .",
    "we give a brief description of our athena++ heating module in  [ subsub : athena++ ] and provide a detailed description along with some numerical testing in appendix [ sec : heating_appendix ] .",
    "we describe our different choices of sed providing this heating in  [ subsub : sed ] .",
    "first we calculate @xmath3 on a logarithmically spaced grid @xmath60 of size @xmath61 over the range @xmath62 and @xmath63 using xstar .",
    "this takes roughly one week running on 12 cores for each sed .    at every timestep in the hydro simulation",
    "we must calculate the rate of change in energy of the gas from radiative processes , the @xmath64 term appearing in the energy equation ( [ eq : energy ] ) .",
    "this is related to the heating rate @xmath65 and cooling rate @xmath66 calculated by xstar via @xmath67 where @xmath68 = [ \\lambda ] = \\rm{erg \\ cm^{3 } \\",
    "s^{-1 } } $ ] at every cell center location we calculate the ionization parameter @xmath2 using ( [ eq : xi_def ] ) .",
    "we then bilinearly interpolate over the nearest grid points in @xmath60 from our xstar grid .",
    "a backwards euler method was used to solve for the heating rate under the assumption that the change in internal energy is due solely to the net heating and not the dynamics of the gas . using",
    "the backwards euler method ensures that the gas reaches equilibrium smoothly .",
    "this is important in this problem because the base of the wind is in equilibrium and this prevents any transients from entering the solution .",
    "a detailed description of this method is provided in appendix [ sec : heating_appendix ] .",
    "our goal is to use observed seds to generate net heating rates to generate realistic hydrodynamics models .",
    "we first use simpler heating and cooling models , derived from idealized sed s that have equilibrium curves with progresively more complicated features .",
    "we first consider the analytic heating model proposed by blondin ( 1994 ) as a fit to thermal bremsstrahlung where @xmath69 \\\\ & + \\bigg [ a_b \\times 3.3 \\times 10^{-27 } \\sqrt{t } \\\\ & + \\left ( a_l \\times 1.7 \\times 10^{-18 } \\frac{e^{-t_l / t}}{\\xi \\sqrt{t } } + 10^{-24}\\right ) \\bigg ]   \\end{aligned } \\label{eq : heating_cooling}\\ ] ] where we have used an x - ray temperature @xmath70 and a line temperature @xmath71 .",
    "we have chosen the x - ray temperature so that @xmath72 . above the terms",
    "represent the parametrized heating and cooling from compton processes ( @xmath73 ) , x - rays ( @xmath74 ) , bremsstrahlung ( @xmath75 ) and lines ( @xmath76 ) .",
    "they depend only on the temperature of the gas t and the ionization parameter @xmath2 .    in our _ modified blondin _",
    "( mbl ) model we set @xmath77 , @xmath78 .",
    "this corresponds to the parametrization of  model c \" in higginbottom & proga ( 2015 ) but with an increased x - ray temperature .",
    "these parameters were chosen so that the equilibrium curve is free of thermal instabilities ( ti ) ( field 1965 ) . in the _ blondin _ ( bl ) model we set @xmath79 which is the original fit proposed by blondin ( 1994 ) but with increased x - ray temperature .",
    "the equilibrium curve is unstable to isobaric perturbations .",
    "these analytic models were also used to test our interpolative heating scheme ( see appendix [ sec : heating_appendix ] ) .",
    "the _ bremsstrahlung _",
    "( brem ) model uses an sed of the same name as input to xstar for generating net heating rates .",
    "the _ blackbody _",
    "( bb ) model provides a case where the equilibrium curve is thermally unstable to isochoric perturbations ( kallman & mccray 1982 ; buff & mccray 1974 ) .",
    "it can be viewed as either a true blackbody source from optically thin emission or as a proxy for an sed with a low energy cutoff say from absorption by cold gas near the source .",
    "the remaining models are based on seds obtained from observations .",
    "we consider an _ x - ray binary _ in a soft state ( xrb1 ) and a hard state ( xrb2 ) ( trigo et al .",
    "2013 ) and _ active galactic nuclei _",
    "seds from type 1 ( agn1 ) and type 2 ( agn2 ) agn ( mehdipour et al .",
    "we note that the shape of the equilibrium curve is highly dependent on the atomic abundances used , in particular at low values of the ionization parameter where the cooling is largely dominated by lines .",
    "we show plots of these seds and the corresponding equilibrium curves output by xstar in fig .",
    "[ fig : observed_sed ] .",
    "we indicate the initial conditions at the base of the wind for each sed with a dot .",
    "at the base of the wind the velocity is subsonic and gravitational energy dominates over thermal energy ( @xmath80 ) so basic energy considerations require that energy be added for a transonic wind to launch .",
    "this energy is provided by an external radiation field which differs according to each sed .",
    "irrespective of sed , the flows follow qualitatively similar behaviour - near the base of the wind they are in radiative equilibrium and follow the equilibrium curve until dynamical processes become important and they begin to radiatively heat .",
    "we briefly describe the dynamics of the flow in  [ sec : dynamical_variables ] for completenesss . however , we are primarily interested in the bulk properties of the flow - the mass flux and efficiency of momentum and energy tranfer to the wind .",
    "in particular , we compare how the different radiation fields affect these bulk observable properties in  [ sec : bulk ] .",
    "we then discuss the spectroscopic properties of these flows by exploring their signatures on the absorption measure distribution ",
    "[ sec : amd ]          for each sed we find stationary wind solutions for a range of subcritical radiation fluxes .",
    "the density is monotonically decreasing and velocity almost always monotonically increasing yielding a constant mass flux at all radii as expected for a stationary flow .",
    "the exception is at thermally unstable points where there is a drop in outwards pressure , leading to a dip in the velocity profile and a dip in the mass flux .",
    "the flows are qualitativly similar whereby they follow the equilibrium curve near the base of the wind before dynamical processes become important and they begin to heat .",
    "we summarize this for all sed models in fig .",
    "[ fig : xit-1_t_summary ] where we show the phase space evolution of each solution .",
    "each color corresponds to a fixed fraction of the critical radiation flux for each model @xmath81 = @xmath82 ( purple ) , @xmath83 ( blue ) , @xmath84 ( green ) , @xmath85 ( orange ) , @xmath86 ( red ) , @xmath87 ( pink ) and @xmath88 ( black ) . for larger incident flux",
    ", equilibrium is maintained for larger ionizations allowing the flow to reach higher temperatures .",
    "our definition of critical flux ( [ eq : f_critical ] ) appears consistent with these results since simulations with critical flux ( purple ) asymptotically approaches the compton temperature .",
    "when dynamical processes become important adiabatic cooling forces the flow off of equilibrium and the flow begins to heat .",
    "when this occurs there is a large spike in the heating rate @xmath89 with most of the energy going into thermal energy .",
    "this thermal energy is used by the flow to first exit the gravitational potential well .",
    "the kinetic energy then dominates over the gravitational energy and thermal energy goes to further increase the velocity of the wind . at large distances",
    "the flow is well developed with total energy equipartitioned between thermal and kinetic energy .",
    "we note in particular that at the sonic point the rate of heating @xmath90 , as expected from general energetic arguments for externally heated transonic winds ( holzer & axford 1970 ; lamers & cassinelli 1999 ) .",
    "we are interested in how the bulk properties of the flow are affected by the radiation field .",
    "in particular , we are interested in the flux of mass , particles , momentum and kinetic energy at the outer boundary and the corresponding efficiencies    @xmath91    @xmath92    @xmath93    @xmath94    the efficiencies @xmath95 have been defined by normalizing each of the bulk wind fluxes @xmath96 by the corresponding flux of the radiation field .",
    "we interpret @xmath97 as an efficiency because it is a measure of the coupling strength between the radiation field and the gas flow for that particular flux .",
    "we plot each of the above fluxes and efficiencies in fig .",
    "[ fig : efficiency_summary ] .",
    "first we notice that for a given sed , kinematic fluxes scale with radiative flux @xmath98 .",
    "averaging over seds we find @xmath99 , @xmath100 and @xmath101 . from the heating rate argument used to derive the critical flux we expect @xmath102 .",
    "if there is an equipartition of kinetic and thermal energy we would therefore expect @xmath103 .",
    "however , we see this dependence is in fact much weaker with @xmath104 starting with the particle flux , each subsequent quantity carries an additional power of v which from the basic scaling argument is expected to add an additional power of @xmath105 . comparing different seds we notice that there are two classes of sed - the main group and the bb sed which is somewhat of an outlier .",
    "we note that the bb sed lacks soft photons relative to all the other models , which leads to an overall decrease in the dynamical fluxes .",
    "this is a general trend with the other seds whereas the agn seds have dynamical fluxes roughly an order of magnitude larger for fixed total flux . as a figure of merit @xmath106 for agn , @xmath107 for brem and @xmath108 for bb .",
    "the bb fluxes resemble those of the other seds if we plot @xmath109 instead of total flux .",
    "this reflects the microscopic properties of the heating i.e. in the subsonic part of the wind , where dynamical fluxes are determined , it is the soft x - ray photons which play a dominant role in heating the wind .",
    "this can also be seen from the equilibrium curves where the base of the s - curve is determined by line cooling and heating due to photoionization , which are sensitive to photons from uv to soft x - rays .",
    "the efficiencies also have a powerlaw scaling @xmath110 with @xmath111 , @xmath112 and @xmath113 .",
    "unlike the dynamical fluxes , the efficiencies are relatively independent of the radiation flux . in particular , increasing the efficiency of mass , particle and momentum flux is easier to achieve by changing the external sed rather than increasing the radiative flux .",
    "the efficiency in driving the wind is more complex than the basic parameters characterizing the radiation field .",
    "for instance 5 models have the same x - ray temperature ( mbl , bl , brem , bb and xrb1 ) . even ignoring ( bb ) , the outlying sed , which is much weaker in soft photons ,",
    "the remaining seds still show a spread of roughly half an order of magnitude in efficiency .",
    "this suggests that accurately modeling the gross wind properties requires accurate modeling of the radiation field . in particular , simply knowing the x - ray temperature and total flux is insufficient because as we have shown , efficiencies are weakly dependent on flux . for a fixed x - ray temperture ,",
    "the efficiency can vary by almost an order of magnitude .",
    "the dynamical fluxes at large distances are a consequence of those same fluxes at the sonic point . however , because the sonic point occurs far away from the compton radius , the primary heating mechanism is not compton heating but rather photoionization .",
    "this heating rate is sensitive to the soft x - ray part of the radiation field and therefore a careful modeling of the gas is necessary .       corresponding to the blue colored points in fig .",
    "2 . the x indicates the sonic point .",
    "dips occur when there is rapid heating of the flow .",
    "this adjustment to the radiation field happens in the subsonic regions .",
    "the above models have the same @xmath7 but exhibit qualitatively different behaviour .",
    "mbl has a dip despite the equilibrium curve being stable .",
    "brem has two closely spaced dips from a ti and when adiabatic cooling becomes important .",
    "xrb1 has two dips for the same reason but has an intermediate temperature stable phase between these two dips .",
    ", scaledwidth=45.0% ]    one may test the validity of theoretical wind solution by comparing wind densities , velocities and photoionization with observed values .",
    "however , in addition to finding that solutions have gas in the observed @xmath114 parameter space one should ensure that a sufficiently high column density of gas with those properties is present to in fact be observable .",
    "one such measure is the absorption measure distribution ( amd ) ( holczer , behar & kaspi 2007 ) which measures the absorbing column of gas at a particular ionization state along a line of sight .",
    "it is defined as @xmath115 where @xmath116 is the total hydrogen column density along the line of sight and @xmath117 is the characteristic length for particle number variations and we have used our uniform ionizing flux model ( see eq .",
    "( [ eq : xi_def ] ) ) .",
    "this is observationally interesting because particular lines will only be absorbed by a gas in a particular ionization state ( see for example adhikari et al .",
    ". however , if the gas density or characteristic length or both are too low any such spectral features will be absent .",
    "we emphasize that important comparisons can be made to observations by detecting individual lines at a particular ionization state and that comparison with the entire distribution is unnecessary .",
    "we find that all our models exhibit dips in the amd where they experience rapid heating .",
    "this can occur in two ways - 1 ) when the equilibrium curve is formally unstable or 2 ) dynamical processes in the flow become important , triggering heating .",
    "the amd behaves qualitatively differently in these different flows . in the case of a formally stable equilibrium curve ( mbl )",
    ", a dip occurs when dynamical processes become important and the flow falls out of equilibrium . at large radii",
    "the amd follows a powerlaw , largely independent of any dips at smaller radii .",
    "the thermal instability leads to sharper dips because of the larger heating rates experienced by the gas .",
    "after the thermal instability , the gas can reach a new stable intermediate temperature state ( see xrb1 for example ) .",
    "the amd then reaches a level commensurate to where it was before the unstable zone .",
    "if no such phase exists ( see brem for example ) then the amd will remain small at these ionizations .",
    "this is because along the equilibrium curve the dynamical time scales are less important so higher densities of the gas can exist .",
    "the amd can therefore probe several interesting features of the equilibrium curve .",
    "it can tell us about what parts of the gas are thermally unstable and also indicate that parts of the gas exist along an intermediate stable temperature . these predictions require both accurate modeling of the heating rates ( to find the thermally unstable regions ) and hydrodynamic flow ( to see what parts of the equilibrium curve",
    "are probed ) .",
    "using the photionization code xstar we used both idealized and observed seds to generate the heating / cooling rates of a gas as a function of temperature and ionization parameter .",
    "we implemented this into a heating module in the hydrodynamics code athena++ to model spherically symmetric , thermally driven winds .",
    "the general behaviour and evolution can be characterized as follows .",
    "* 1 ) * we find stationary solutions that follow the classic picture of thermally driven winds - energy is added to the base of the wind in the subsonic region to overcome the gravitational potential and to accelerate the wind to supersonic velocities .",
    "the mass loss rate is determined by amount of energy deposited at and below the sonic point , whereas other properties such as the wind velocity and energy flux are determined by the total amount of energy deposited in the supersonic part of the flow .    * 2 ) * the mass , particle , momentum and kinetic energy fluxes are functions of the radiation field flux and the nature of the radiation field .",
    "the efficiency of driving the wind is a weak function of radiation flux but strongly dependent on the details of the sed .    *",
    "3 ) * the amd provides a useful tool for determining the behaviour of the gas .",
    "when the gas experiences rapid heating there is a steep drop in the amd .",
    "if gas exists at a stable intermediate temperature the amd will have a bump at that ionization state .",
    "to lowest order , one can assume that heating is dominated by compton processes and the heating rate is simply parametrized by the x - ray temperature .",
    "this is a valid approximation at high temperatures and correctly predicts that the flow heats to the compton temperature for a critical flux of incident radiation .",
    "however , at low temperatures , @xmath118 , compton processes are subdominant to photoionization heating and cooling due to line and free - free emission .",
    "therefore the x - ray temperature is insufficient to predict the state of the gas .",
    "one may then go one step further and compute the equilibrium curve for a given sed .",
    "the state of the flow is approximated by traversing the equilibrium curve .",
    "regions where the equilibrium temperature is very sensitive to the photoionization parameter indicate highly efficient net heating that can lead even to catastrophic heating with ti being an example . a high energy deposition rate results in a flow acceleration and that in turn leads to adiabatic cooling .",
    "consequently , the state of the flow is not properly captured by the equilibrium solution .",
    "our simulations show that this non - equilibrium physics has several interesting effects on the flow and these have important observational consequences .",
    "let us first compare how models with the lowest level of complexity behave .",
    "the mbl , bl , brem and xrb1 models all have the same @xmath119 .",
    "they also begin with the same gravitational and thermal energy at the base of the wind .",
    "however they have nearly an order of magnitude difference in the various fluxes and corresponding efficiencies as shown in fig .",
    "[ fig : efficiency_summary ] . for all cases",
    ", the sonic point occurs at a temperature @xmath118 , hence the relevant temperature scale for determining mass flux at the critical point is not the x - ray temperature .",
    "models with the same x - ray temperature therefore will not necesarily have similar mass flux , as our simulations show .",
    "the other wind fluxes are proportional to the mass flux times additional powers of the velocity @xmath120 .",
    "therefore they differ by roughly an order of mangitude as well between the various models .",
    "what about a model where we simply traverse the equilibrium curve ?",
    "this is equivalent to assuming we provide a large enough flux for the radiative processes to dominate over any hydrodynamics . as a proxy for this model we will use the critical luminosity cases .",
    "however , as was shown in ",
    "[ sec : bulk ] the various wind fluxes have power - law scaling @xmath121 and the efficiencies @xmath122 .",
    "furthermore , it fails to predict when the flow falls out of equilibrium .",
    "this means that certain intermediate stable temperature branches which would naively be expected to exist from the equilibrium curve might never be visited because insufficient flux is heating the flow .",
    "this is observationally one of the most interesting features of this type of system because it provides a link between the macroscopic gas properties ( temperature and ionization parameter ) and the underlying microphysics .",
    "our results suggest that complete spectral information is important when modeling radiative heating and thermally driven flows .",
    "this is especially imprtant for systems like agn .",
    "besides the type 1 and type 2 agn cases , we may also interpret the bb case as an agn which has nearby cold gas that absorbs the soft photons .",
    "the agn1 and agn2 cases have a difference of a few in their various wind fluxes and efficiencies . however the bb case is several orders of magnitude smaller , primarily due to highly suppressed soft photons . when modeling observed agn outflows this is important because any uncertainty in the observed flux will result in an uncertainty in the modeled outflow .",
    "we found numerical artifacts affecting our solution in several ways .",
    "this suggests the need for new physics to properly resolve the flow . when the wind becomes non - adiabatic and falls of the equilibrium curve , there is a drop in the length scale associated with the dynamical variables",
    "this becomes more pronounced at higher radiation fluxes and can lead to not finding a stationary numerical solution .",
    "likewise when solutions are thermally unstable there is a decrease in the length scale of dynamical variables - if it falls below the grid scale the ti is not numerically well resolved .",
    "this can not be adressed with additional resolution as the regions are geometrically thin .",
    "future studies of wind solutions should include the effects of thermal conduction because of relatively steep temperature gradients ( see for example rozanska & czerny 1996 ) .",
    "our future studies will include 2d and 3d simulations of disc winds driven by the radiation force .",
    "if the disc is irradited by a central source or the inner parts of the disc , the outer disc will heat .",
    "this affects the strength of the radiation force and therefore the radiatively driven wind . if line driving is important , calculating the force multiplier resulting from the lines responsible for the heating / cooling as well as additional lines that are negligible energetically but important for momentum transfer . by using observed seds as an input to xstar we will model self - consistently the heating / cooling in the system .",
    "we also note that this method is quite general and can be applied to other radiatively heated systems for which an sed has been observed .",
    "for example one could consider the net heating of planetary atmospheres by the host star .",
    "this work was supported by nasa under atp grant nnx14ak44 g .",
    "we thank maria diaz trigo for providing the xrb seds and missagh mehdipour for providing the agn seds used in our work .",
    "we also thank tim kallman for providing us with xstar and many valuable discussions .",
    "99    adhikari , t.p . ,",
    "rozanska , a. , sobolewsa , m. , czerny , b. , 2015 , apj    bautista , m.a . ,",
    "kallman , t.r . , 2001 ,",
    "apj , 134:139 - 149 .",
    "begelman , m.c . , mckee , c.f . , shields , g.a . , 1983 ,",
    "apj 271:70 - 88 .",
    "blondin , j.m . , 1994 ,",
    "apj , 435 , 756 .",
    "buff , j. , mccray , r. , 1974 , apj 188:l37    field , g.b .",
    ", 1965 , apj 142:531 .",
    "gardiner , t.a . , stone . j.m .",
    ", 2005 , j. comput .",
    "phys . , 205 , 509    gardiner , t.a . , stone . j.m . , 2008 , j. comput .",
    ", 227 , 4123    higginbottom , n. , proga , d. , 2015 , apj , 807:107 .",
    "holczer , t. , behar , e. , kaspi , s. , 2007 , apj 663 : 799 - 807 .",
    "holzer , t.e .",
    ", axford , w.i . , 1970 , an rev .",
    "kallman , t.r . ,",
    "mccray , r. , 1982 , apj 50 : 263 - 317 .",
    "lamers , h.j.g.l.m .",
    ", cassinelli , j.p . , 1999 ,",
    "introduction to stellar winds , cambridge up .",
    "lodders , k. , palme , h. , gail , h.p . , 2009 , landolt b@xmath123rnstein ( springer ) , 44    mehdipour , m. , kaastra , j.s . , miller , m.c . ,",
    "et al . , 2015 , a&a 575:a22    press , w.h . , teukolsky , s.a . , vetterling , w.t . ,",
    "flannery , b.p .",
    ", numerical recipes in c , cambridge up , 1992 .",
    "rozanska , a. , czerny , b. , 1996 . , acta astron . , 46 , 233 .    stone , j.m . ,",
    "proga , d. , 2009 , apj 694:205 - 213 .",
    "trigo , m.d . ,",
    "boirin , l. , migliari , s. , miller - jones , j. , parmar , a. , sidoli , l. , 2013 , iaus 290:25 t    verner , d.a . , barthel , p.d .",
    ", tytler , d. , 1994 , a&a 108:287 - 340",
    "for n = 10 ( red ) , 50 ( orange ) , 100 ( green ) & 500 ( blue ) . , scaledwidth=45.0% ]",
    "our athena++ simulation calculates radiative heating rates self consistently by interpolating the net heating rates precalculated using the xstar photoionization code for a range of temperatures and ionization parameters .",
    "we describe this interpolation scheme in  [",
    "sec : hcmodule_methods ] and the results of various performance tests in  [ sec : hcmodule_tests ] .",
    "we calculate the net heating rate using xstar for an @xmath124 logarithmically spaced grid @xmath4 in a domain @xmath125 and @xmath126 .",
    "we take @xmath127 , @xmath128 , @xmath129 and @xmath130 .",
    "we will refer to this as our heating table .    within athena++ , at every cell and timestep , the net heating must be calculated .",
    "this requires two interpolations : * 1 ) * in @xmath131 phase space to determine the nearest points in the heating table * 2 ) * in t space to implicitly solve for the heating rate consistent with the hydro time step .",
    "when we require the heating rate for ionization and temperature @xmath14 we * 1 ) * determine the ( i , j ) location in the heating table for the four pairs of points @xmath60 , @xmath132 , @xmath133 and @xmath134 nearest to @xmath14 . * 2 ) * bilinearly interpolate between these points to estimate @xmath3 .",
    "we have generated the heating table uniformally in logarithmic space according to @xmath135 @xmath136 therefore when we are finding the indices @xmath137 we do not have to traverse the entire table we can simply invert the above expressions .",
    "we then use the standard bilinear interpolation scheme on these four points .",
    "we discretize the energy evolution equation ( [ eq : energy ] ) under the assumption that changes in internal energy are due to the heating / cooling and express this in terms of the implicit relation @xmath138 this is the backward euler method where the heating rate during the @xmath139th time step is calculated using the temperature at the @xmath140th time step .",
    "the alternative forward euler method calculates the heating rate during the @xmath139th time step using the temperature at the @xmath139th time step .",
    "the advantage of backward euler method is that as the equilibrium temperature is reached the contribution from the heating will also be decreasing so equilibrium is reached more smoothly .",
    "the disadvantage is @xmath141 is now implicitly defined by ( [ eq : backward_euler ] ) and a root finder is needed to solve for it .",
    "we implemented a two step bisection root finder .",
    "the process of finding a zero of a function @xmath142 i.e solving for @xmath143 such that @xmath144 consists of two steps - * 1 ) * bracketing the zero , i.e. finding numbers a , b such that @xmath145 .",
    "a zero will then lie in the interval [ a , b ] . *",
    "2 ) * refining this interval such that @xmath146 so that we can say that we have located the location of the zero @xmath143 to a precision @xmath147 .",
    "step * 1 ) * consists of checking for the existence of a root in progresively larger intervals @xmath148 $ ] where @xmath149 and @xmath150 where @xmath151 and t is the current temperture .",
    "we then check the condition @xmath152 and if it is not satisfied continue decreasing ( increasing ) @xmath153 ( @xmath154 ) until it is satisfied .",
    "step * 2 ) * uses the * zbrent * rootfinding algorithm ( press et al . 1992 ) to solve for the root to an accuracy @xmath155 .",
    "we compared how both methods performed when calculating the heating ( cooling ) of a box of uniformally ionized gas at temperature below ( above ) its equilibrium temperature .",
    "the backwards euler method did not oscillate above / below the equilibrium temperature as with forward euler .",
    "this is an important property because we expect wind solutions to be at equilibrium near their base .",
    "a comparable level of performance by the forward euler method requires decreasing the timestep , which in practice entails more computational expense than employing the root finder .",
    "to test our algorithm and implementation we use the analytic heating / cooling rates given by ( [ eq : heating_cooling ] ) ( blondin 1994 ) .",
    "we compare simulation results where this forumula is used explicitly and simulations where our algorithm is used to interpolate over heating / cooling rates calculated on an @xmath156 grid .",
    "we perform two main tests * 1 ) * compute the relative error in the heating / cooling rate at different locations in the ( @xmath157 ) phase space to test the bilinear interpolation scheme . *",
    "2 ) * compute the relative error in the kinematic quantities and heating rates for radiatively heated 1d stationary winds in athena++ .",
    "we consider @xmath156 grids of points @xmath60 , logarithmically spaced in the @xmath14 plane .",
    "we consider grids of size n = 50 , 100 & 200 .",
    "we then evaluate the heating / cooling rate in a logarithmically spaced grid of size @xmath158 in the @xmath14 plane using the analytic expression ( [ eq : heating_cooling ] ) and by using our bilinear interpolation scheme on the @xmath156 grid .",
    "we ensure this grid is shifted relative to the grid used to calculate heating rates so we are testing the interpolation scheme .",
    "we show results for n = 50 , 100 & 200 in fig .",
    "[ fig : summary_xit_modela ] .",
    "we have plotted the relative error in the numerically interpolated net heating rate ( subscript n ) , normalized to the average analytic heating and cooling ( subscript a ) @xmath159 we normalize the error in this way to not exagerate the importance of numerical errors near or at equilibrium where @xmath160 .",
    "we note that the error contours are stratified , particularly at small n. this is because near the calculated points @xmath4 the bilinear approximation will perform best . as we distance ourselves from this point and before we approach the next point on the grid the approximation will worsen .",
    "we consider @xmath156 grids of points @xmath60 , logarithmically spaced in the @xmath14 plane .",
    "we consider grids of size n = 10 , 50 , 100 & 500 .",
    "we perform athena++ simulations where the heating / cooling rate is determined by the bilinear interpolation scheme on this grid .",
    "after athena++ has found a stationary solution , where the hydrodynamic time step @xmath163 becomes constant , we compare these to the stationary solutions found when heating / cooling is computed analytically .",
    "we plot the relative % error in the late time density , velocity , temperature and heating rate in fig .",
    "( [ fig : summary_stationary ] ) .",
    "relative errors are large near the star where the solution is subsonic",
    ". however , past the sonic point the relative error shows a clear trend in the accuracy of the simulations .",
    "in particular a @xmath161 grid yields roughly 1% accuracy while a @xmath162 grid yields a 0.1% accuracy .",
    "interestingly the accuracy in the final solution is comparable to the accuracy in the @xmath14 plane discussed above .",
    "we note that the solution follows the equilibrium curve near the star before falling off and staying slightly below it in the heating regime .",
    "the location where the wind is no longer in equilibrium corresponds to the radius at which the relative % error converges to its large radius value .",
    "it makes sense that inside this radius the % error has large variations , because the analytic value should be near zero and therefore the relative errors are amplified ."
  ],
  "abstract_text": [
    "<S> we develop a general method for the self consistent calculation of the hydrodynamics of an astrophysical object irradiated by a radiation field with an arbitrary strength and spectral energy distribution ( sed ) . using the xstar photoionization code </S>",
    "<S> we calculate heating and cooling rates as a function of gas photoionization parameter and temperature for several examples of seds : bremsstrahlung , blackbody , hard and soft state xrbs , type 1 and type 2 agn . </S>",
    "<S> we numerically investigate the properties of a spherical object heated by a uniform radiation field using the mhd code athena++ . </S>",
    "<S> we find that in all cases explored a wind settles into a transonic , steady state . </S>",
    "<S> the wind evolves along the radiative heating equilibrium curve until adiabatic cooling effects become important and the flow departs from radiative equilibrium . </S>",
    "<S> the efficiency with which the radiation field transfers energy to the wind is dependent on the sed of the external source , particularly the relative flux of soft x - rays . if the flow is heated very rapidly , for example as in a thermally unstable regime , the corresponding column density of gas is low . </S>",
    "<S> these results suggest that detailed photoionization calculations are essential not only to predict spectra but also to properly capture the flow dynamics .    </S>",
    "<S> [ firstpage ]    hydrodynamics - radiation : dynamics - methods : numerical - stars : winds , outflows - galaxies : active - x - rays : binaries </S>"
  ]
}