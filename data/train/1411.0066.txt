{
  "article_text": [
    "many systems in materials science , chemistry and other areas are greatly influenced by the electronic structure , which requires the full quantum - mechanical description . however , directly solving the quantum many - body problem for real systems is impractical even with the present supercomputers since a @xmath0-dimensional antisymmetric wave function is needed to describe a system with @xmath1 electrons .",
    "lots of electronic structure models , which aim at approximating the solution of many - body schrdinger equations , have been proposed .",
    "kohn - sham density functional theory ( dft ) @xcite is one of the most popular and successful tools for electronic structure analysis , in which @xmath1 one - particle wave functions are used to describe the n - electron system with properly approximated energy functionals .",
    "the corresponding kohn - sham equations are a system of nonlinear eigenvalue problems . to solve the nonlinear eigenvalue equation , the self - consistent field iteration is often used .",
    "the electron density is updated at each iteration until self - consistency is achieved .",
    "the computational cost of each iteration step for conventional algorithm scales as @xmath2 due to diagonalization and orthogonalization . for different systems , the required number of iterations might scale differently and depends on the choice of mixing techniques .",
    "the total cost of solving the kohn - sham equations scales at least as @xmath2 .",
    "such computational scaling is prohibitively expensive when the number of electrons is large .",
    "many efforts have been devoted to design linear scaling methods , i.e. , @xmath3 methods , for electronic calculations within the framework of kohn - sham dft over the past twenty years ( see e.g.  @xcite ) .",
    "these methods share the common ground of exploiting the locality , or nearsightedness @xcite to reduce the computational complexity .",
    "locality here means the dependence of the electron density on the environment decays in distance .",
    "the first linear scaling method is the divide - and - conquer ( dac ) method proposed by weitao yang @xcite , where the global system is divided into several subsystems , and each subsystem is solved separately with atomic orbitals .",
    "the electron density of the global system is then found by getting a global equilibrium condition for the fermi energy . in each self - consistent iteration ,",
    "the cost of dac method depends on the number of subsystems which is proportional to the number of electrons .",
    "the dac method scales as @xmath3 naturally if the self - consistent field iteration is independent of the considered system .    in this article",
    ", we aim at understanding the accuracy of the dac method , as one of the popular approaches of linear scaling algorithms .",
    "we note that the main idea of the algorithm is quite similar to the domain decomposition type method , commonly used in numerical solutions to pdes .",
    "the goal is to understand the accuracy of the method and the conditions under which the method works .",
    "a key component of the analysis is to understand the locality of electronic structure from a mathematical point of view .",
    "the main ingredients are geometric resolvent identity and a combes - thomas type decay estimate of the green s function .    in the dac method of electronic structure calculations ,",
    "the subsystem can be understood as the global system under certain ( not necessarily small ) perturbations .",
    "it turns out that the accuracy of the method depends crucially on the gap structure of the system and of the subsystem .",
    "we examine the gap assumption in cases when it is valid and invalid carefully with numerous examples .",
    "let us also point out that our analysis does not assume any particular way of restriction of the hamiltonian onto a sub - domain ( besides that the gap assumption is satisfied ) .",
    "this flexibility allows the analysis to be generalized to a variety of methods in electronic structure calculations based on the domain decomposition idea .",
    "the outline of the paper is as follows . the detailed description of the dac method is presented in  [ dd ] . the accuracy of the method is analyzed in  [ accuracy ] . by examples in one dimension and two dimensions ,",
    "we demonstrate the accuracy of the method when the gap assumption is valid , and the loss of the accuracy when the gap assumption is invalid in  [ gap ] .",
    "consider a system of @xmath4 nuclei and @xmath1 electrons . a set of one - particle wave functions @xmath5 is employed to represent the interacting electrons in kohn - sham dft . at zero temperature , the kohn - sham energy functional can be written as ( for simplicity of the presentation , we will ignore the spin degeneracy here and in sequel ) @xmath6 &    = \\sum_{k=1}^{n}\\int_{{\\mathbb{r}}^3}\\dfrac12{\\lvert{\\nabla}\\psi_k\\rvert}^2{\\mathrm{d}x}+ \\int_{{\\mathbb{r}}^3}v(x)\\rho(x){\\mathrm{d}x}\\\\    & \\quad+\\dfrac12\\iint_{{\\mathbb{r}}^3 \\times { \\mathbb{r}}^3 }    \\dfrac{{\\bigl(\\rho - m\\bigr)}(x){\\bigl(\\rho - m\\bigr)}(x')}{{\\lvertx - x'\\rvert}}{\\mathrm{d}x}{\\mathrm{d}x } '    + e_{\\mathrm{xc}}[\\rho ] , \\end { aligned}\\ ] ] where the electron density is given by @xmath7 and the ionic function takes the form @xmath8 where @xmath9 is a localized smooth function and @xmath10 are the positions of nuclei , i.e. , we have taken a local pseudopotential for the electron - nucleus interaction @xcite for simplicity .",
    "our results can be generalized to nonlocal pseudopotential , but we will not go into the details .",
    "the kohn - sham energy functional is minimized with the orthonormal constraints of the orbitals @xmath11 the euler - lagrange equation , known as the kohn - sham equation , can be written as @xmath12 where @xmath13 with @xmath14 $ ] and @xmath15 = \\frac{\\delta e_{\\mathrm{xc}}[\\rho]}{\\delta\\rho}$ ] . here",
    ", @xmath16 are a set of eigenvalues , increasingly ordered , and @xmath17 are the associated eigenfunctions of the effective hamiltonian .",
    "note that this is a nonlinear eigenvalue problem as the effective hamiltonian @xmath18 depends on the density , which in turn , depends on the eigenfunctions .    to solve the kohn - sham equation ,",
    "a self - consistent iteration is usually employed . at each iterate , for the current guess of the density @xmath19 , we solve for the eigenvalue problem of @xmath20 to find the first @xmath1 eigenpairs @xmath21 . from the eigenfunctions , we form a new density @xmath22 . the nonlinear iteration is used to find a fixed point of the map from @xmath19 to @xmath23 , which is known as the kohn - sham map ( see e.g. , @xcite ) .",
    "the algorithmic bottleneck of the above procedure is to evaluate the density @xmath23 given a hamiltonian : for a fixed hamiltonian @xmath24 with some effective potential @xmath25 ( consequently , we will take @xmath26 ) , we look for the square sum of its first @xmath1 eigenfunctions , @xmath27 which is a linear eigenvalue problem . a conventional diagonalization of the discretized hamiltonian to solve leads to computational cost that scales cubicly with respect to the number of electrons .",
    "however , the eigenfunctions @xmath17 are just an intermediate step for the electron density @xmath28 .",
    "it is therefore possible to design efficient algorithms that avoid the eigenvalue problem on the whole computational domain .",
    "one such strategy is the dac method , which aims to achieve linear scaling cost for computing the density .",
    "the idea of using the dac method to study electron structures was firstly proposed by weitao yang in @xcite , which was based on a localized hamiltonian formulation .",
    "it was then generalized to a density - matrix formulation @xcite .",
    "some recent developments of the dac method , or more generally , domain decomposition type method , can be found in @xcite .",
    "a great advantage of the method lies on the intrinsic parallel properties between subdomains , which has been investigated for large scale calculations with more than @xmath29 atoms and @xmath30 electronic degrees of freedom @xcite . in what follows",
    ", we describe the main idea of the dac method , in the spirit of @xcite . to clearly present the method",
    ", we will stay on the pde level and formulate the algorithm in terms of operators , rather than first imposing a discretization of the hamiltonian .",
    "this way , we can separate the error caused by the dac method and by a numerical discretization of the continuous problem .",
    "the dac method for electronic structure calculations involves the following steps .",
    "let us denote the whole computational domain as @xmath31 .",
    "our goal is to find its corresponding density of the hamiltonian @xmath18 on the whole domain .",
    "* define a partition of domain , @xmath32 , and a partition of unity subordinate to the open covering @xmath33 .",
    "usually neighboring subdomains intersect , i.e. , @xmath34 when @xmath35 .",
    "nonnegative partition functions @xmath36",
    "satisfy @xmath37 .",
    "* restrict the hamiltonian on the domain @xmath38 with certain boundary conditions and solve the eigenvalue problem in each subsystem @xmath39 where @xmath40 denotes the restriction of the hamiltonian , whose domain is a subset of the sobolev space @xmath41 with prescribed boundary conditions . * determine the fermi energy @xmath42 by solving the equation of charge equilibrium @xmath43 where @xmath44 is the fermi - dirac function and @xmath45 with @xmath46 boltzmann constant and @xmath47 absolute temperature .",
    "* construct the electron density @xmath48 where @xmath49 , and total energy @xmath50\\rho^{\\mathrm{dac}}(x){\\mathrm{d}x}+e_{\\mathrm{xc}}[\\rho^{\\mathrm{dac } } ] .",
    "\\end { aligned}\\ ] ]    note that the above formulation corresponds to a finite temperature calculation , as considered in the original dac method @xcite . in practice ,",
    "if interested in the zero temperature calculation , we may choose @xmath51 so large that the fermi - dirac function becomes approximately a heaviside function .",
    "in the following analysis and numerical examples , we will consider the zero temperature case to focus on the key idea .",
    "our analysis can be extended to finite temperature situation .      from an analytical point of view , we can just focus on one subsystem problem from the divide - and - conquer method .",
    "the analysis for other subdomains proceeds in the same fashion and the error of the method over the whole domain can be controlled by those of the sub - domains using triangle inequality and observing that @xmath52 is a partition of unity .",
    "more specifically , note that the global density in the dac method is obtained by @xmath53 where @xmath54 is the electron density calculated in @xmath38 . denoting @xmath19 the true density",
    ", we have @xmath55 error estimate in other norms can be similarly obtained .",
    "let us reformulate the dac idea for a single domain .",
    "let @xmath56 be a subdomain and let @xmath57 be a buffer region surrounding @xmath56 . in terms of the algorithm in the previous section , @xmath57 corresponds to one of the @xmath58 , and @xmath56 is the support of @xmath52 , which we choose to be strictly inside .",
    "later in the analysis , we will also need a slightly smaller buffer region @xmath59 inside of @xmath57 .",
    "these sets satisfy @xmath60 with some distance separating their boundaries , see figure  [ fig : domain1 ] for a schematic picture .    for a prescribed fermi energy @xmath42 , we are interested in the density over the domain @xmath56 , calculated by solving the eigenproblem on @xmath57 .",
    "namely , we define @xmath61 where the eigenpairs @xmath62 are obtained by solving the following eigenvalue problem in @xmath57 @xmath63 to understand the accuracy of the dac method , it then suffices to understand the difference between @xmath64 and the exact density @xmath19 restricted on @xmath56 .",
    "the main tool we will use is the geometric resolvent identity and the decay estimate of the green s functions .",
    "the geometric resolvent identity relates the green s function defined on a subdomain to the green s function on a larger domain . for a domain @xmath56",
    ", we will denote @xmath65 its complement ; and for two sets @xmath66 and @xmath67 , @xmath68 .",
    "[ lem : gri ] consider four open sets @xmath69 and @xmath70 that satisfy @xmath71 and @xmath72 ( see figure  [ fig : domain2 ] for an illustration of these sets ) .",
    "let @xmath73 be a smooth function which is identically @xmath74 on a neighborhood of @xmath75 and identically @xmath76 on a neighborhood of @xmath77 . given any restriction @xmath78 and @xmath79 of @xmath18 to @xmath70 and @xmath80 , respectively",
    ", we have @xmath81(h_{{\\omega}}-{\\lambda})^{-1}\\ ] ] for any @xmath82 for which both resolvents exist . also @xmath83(h_{{\\omega}}-{\\lambda})^{-1}1_{{\\lambda}_2},\\ ] ] under the same conditions .",
    "the lemma is well - known in the analysis of schrdinger operators and its proof is standard ( see e.g. , @xcite*lemma 4.2 ) .",
    "we include the short proof here for completeness .",
    "first note the identity @xmath84 = ( h_{\\lambda } - \\lambda ) \\theta - \\theta ( h_{\\omega } - \\lambda)\\ ] ] since @xmath85 .",
    "the identity follows from multiplying on the left by @xmath86 and on the right by @xmath87 .",
    "the identity follows from by applying @xmath88 on the right on both hand sides .",
    "let us recall the spectral representation of the electron density ( see e.g. , @xcite ) @xmath89 where the right hand side stands for the diagonal of the kernel of the operator @xmath90 . here",
    "@xmath91 is a contour in the complex plane that separates the occupied spectrum of @xmath18 ( the eigenvalues below the fermi energy @xmath42 with the rest of the spectrum ) . in the dac method",
    ", this is approximated by @xmath92 where @xmath57 is a buffer region surrounding @xmath56 . without loss of generality",
    ", we will assume that the buffer satisfies @xmath93 .",
    "we will also define the region @xmath94 by construction , it is clear that we have @xmath95 .",
    "we note that the distances @xmath74 and @xmath96 are chosen here merely for convenience , any finite @xmath97 distance will work , though the final constants in the estimate depend on how separated the domains are",
    ".    we may proceed to compare the pointwise values of @xmath19 and @xmath64 by using results on regularity estimate of green s function for elliptic operators ( e.g. ,  @xcite and @xcite*lemma 6.4 ) . here",
    ", for simplicity of presentation and to better convey the key idea , we will instead work with the following locally mollified version of the densities ( with slight abuse of notations , we still denote them as @xmath19 and @xmath64 ) @xmath98 where @xmath99 is a fixed numerical delta function centered at @xmath100 .",
    "for simplicity of notation , we will also abuse the notation by writing @xmath101 for a set @xmath66 .",
    "note that the mollification is in agreement with practical numerical implementations , since some discretization will be used for the hamiltonian operator .",
    "other forms of @xmath99 , such as averaging in a small ball around @xmath100 , can also be used .",
    "accuracy of the method is the same with a possibly different constant .    in general ,",
    "the restriction of @xmath18 onto the domain @xmath57 might dramatically change the spectrum of the operator .",
    "as will be shown in the numerical examples , without any assumption on the spectral properties of the truncated operator @xmath102 , the accuracy of the method is not guaranteed , in particular , the difference between @xmath103 and @xmath104 might be quite large and decay very slowly when @xmath100 is moving inside @xmath56 away from the boundary @xmath105 . to guarantee the fast decay of the error",
    ", we make the following gap assumption for the truncated system @xmath102 .",
    "[ assump ] let @xmath106 and @xmath107 be the occupied and unoccupied spectra of @xmath18 respectively .",
    "we assume that there exists @xmath42 and @xmath108 such that @xmath109    note that , @xmath110 might be smaller than the spectral gap between occupied and unoccupied spectra of @xmath18 .",
    "physically , the assumption means that the restriction of the hamiltonian operator on the subsystem preserves the gap around the fermi energy .",
    "in particular , the assumption implies the existence of a contour @xmath91 such that @xmath111    if assumption  [ assump ] is satisfied by all the sub - domains , we can then find a uniform gap in the spectra of all sub - domain hamiltonians .",
    "this means that the fermi level can be chosen uniformly for all the sub - domain , which gives the choice of the global fermi energy in step 3 of the dac algorithm .",
    "[ thm : accuracy ] under assumption  [ assump ] , there exist constants @xmath112 and @xmath113 such that @xmath114 the constants @xmath112 and @xmath113 depend only on @xmath42 , @xmath110 and @xmath115 .",
    "the estimate guarantees that with a fixed buffer region , the error we make by restricting to a local problem decays exponentially away from the boundary .",
    "as the constants depend only on the spectral gap and the @xmath116 norm of the potential , if we fix a point @xmath100 and enlarge the buffer region @xmath57 , the error will also decay exponentially , as long as the gap assumption is uniformly satisfied for the increasing buffer regions .",
    "this point would be further demonstrated in the numerical examples .",
    "before we prove the theorem , let us recall the decay estimate of green s function from @xcite*theorem 9 and its proof ( see also @xcite where such estimates are used for the macroscopic limit of kohn - sham density functional theory ) .",
    "we also remark that the exponential decay property of the green s function and the density matrix also holds at the discrete level @xcite and hence our analysis can be also done for the discretized hamiltonian .",
    "[ prop : greendecay ] given a hamiltonian @xmath117 with @xmath25 .",
    "for any @xmath118 , there exist constants @xmath119 and @xmath120 , depending only on @xmath121 , @xmath122 and @xmath115 , such that for all @xmath123 and any @xmath124 , we have @xmath125 where @xmath126 is the dimension , and @xmath127 is the multiplication operator given by @xmath128    applying the result to our current setting , since @xmath91 is compact and by the gap assumption , @xmath129 , the @xmath130 and @xmath120 can be chosen for both @xmath18 and @xmath102 as constants depending only on @xmath131 , and @xmath115 .",
    "moreover , the choice of the contour only depend on the location of the spectral gap and the bottom of the spectra of @xmath18 and @xmath102 , which can be controlled by @xmath42 and @xmath115 .",
    "hence , the constants only depend on @xmath42 , @xmath110 and @xmath115 .",
    "let us now proceed to prove the theorem .",
    "using the resolvent identity , we write the difference in density as the difference in operators . for @xmath132",
    ", we have @xmath133 \\varphi_x \\bigr\\rangle { \\,\\mathrm{d}}\\lambda\\ ] ] since the contour @xmath91 is compact , we obtain @xmath134 \\varphi_x \\bigr\\rangle \\bigr\\rvert.\\ ] ] let @xmath135 denote the support of @xmath99 , using lemma  [ lem : gri ] , we have the geometric resolvent identity @xmath136 1_{\\lambda_x }        =   1_{\\lambda_x } ( \\lambda - h_{\\lambda_b})^{-1 }        [ h , \\theta ] ( \\lambda -        h)^{-1 } 1_{\\lambda_x } ,      \\end{aligned}\\ ] ] where we take @xmath73 such that @xmath137 in @xmath59 and @xmath138 outside @xmath57 .",
    "the commutator @xmath139 $ ] can be calculated as @xmath84 = - ( \\delta \\theta ) - 2 \\nabla \\theta \\cdot \\nabla.\\ ] ] note that both @xmath140 and @xmath141 are supported on @xmath142 by the choice of @xmath73 . by the construction of the set @xmath59",
    "as in , we can choose @xmath73 such that @xmath143 and @xmath144 are both @xmath97 quantities .",
    "applying , we hence arrive at @xmath145 \\varphi_x \\bigr\\rangle      \\bigr\\rvert \\leq \\bigl\\lvert \\bigl\\langle \\varphi_x , ( \\lambda -      h_{\\lambda_b})^{-1 } ( \\delta \\theta ) ( \\lambda - h)^{-1 }      \\varphi_x \\bigr\\rangle \\bigr\\rvert \\\\      + 2 \\bigl\\lvert \\bigl\\langle \\varphi_x , ( \\lambda -      h_{\\lambda_b})^{-1 } ( \\nabla \\theta \\cdot \\nabla ) ( \\lambda -      h)^{-1 } \\varphi_x \\bigr\\rangle \\bigr\\rvert .",
    "\\end{gathered}\\ ] ] the proof then concludes by estimating the two terms on the right hand side .",
    "these decay estimates are given by the next lemma  [ lem : decay ] .",
    "[ lem : decay ] let @xmath146 be a @xmath116 function such that @xmath147 there exist constants @xmath119 and @xmath112 such that for any @xmath148 and @xmath124 , we have @xmath149 where @xmath146 is interpreted as a multiplication operator on the left hand sides .    by inserting the exponential weight @xmath150 centered at @xmath100 , we can estimate @xmath151 where the last inequality uses proposition  [ prop : greendecay ] for the operators @xmath18 and @xmath102 .",
    "note that @xmath152 is a multiplication operator @xmath153 hence , @xmath154 the proof of is analogous and will be omitted .",
    "in this section , we validate the dac algorithm and also our analytical results by numerical examples . by several examples in one dimension and two dimensions ,",
    "we show the accuracy of the subsystem if assumption  [ assump ] is valid .",
    "moreover , the loss of accuracy for the subsystem is observed if assumption  [ assump ] fails .",
    "while in practice , we do not have easy criteria of selection of subdomains that guarantees  , numerical results show that they are essential for the accuracy of the method .",
    "[ ex : insulator1d ] consider an infinite array of atoms on a line with @xmath155 , for @xmath156 .",
    "each atom has one valence electron and spin degeneracy is ignored .",
    "we adopt an example from @xcite , where @xmath157 is chosen with the following form @xmath158}.\\ ] ]    figure  [ fig : bandstructure ] shows band structures when @xmath159 , @xmath160 , and @xmath159 , @xmath161 .",
    "we will assume one electron per atom ( note that spin degeneracy is ignored ) .",
    "as studied in @xcite , the gap is very small when @xmath159 , @xmath161 and the system behaves like a metal .",
    "therefore , it is clear that for selected parameters , the corresponding system has a gap in the spectrum ( insulator ) as in figure  [ fig : bandstructureinsulator ] , while it does not have a gap ( metal ) as in figure  [ fig : bandstructuremetal ] . in other words ,  are valid in figure  [ fig : bandstructureinsulator ] , and invalid in figure  [ fig : bandstructuremetal ] .",
    "-0.6 in    choose @xmath162 and @xmath163 $ ] . from the left column of figure [ fig : insulator ] , one can see is valid for @xmath164 with three different boundary conditions , including dirichlet boundary condition ( dbc ) , neumann boundary condition ( nbc ) , and periodic boundary condition ( pbc ) .",
    "-0.8 in +   +    fix @xmath165 and @xmath166 $ ] . note that @xmath167 , satisfying the assumption on the subdomain and the buffer region .",
    "this condition holds true for all examples in the section .",
    "we compare @xmath168 as a function of @xmath100 for three boundary conditions in the right column of figure  [ fig : insulator ] .",
    "density differences are plotted in the log scale and decay exponentially , which verifies .",
    "quantitatively , the method has the best performance when pbc is used .",
    "moreover , for the self - consistent fermi level , density differences behave in the same manner . furthermore , for @xmath169 $ ] and a series of enlarged buffer regions @xmath170 $ ] ( @xmath171 ) , we compare @xmath172 as a function of @xmath100 in figure [ fig : insulatorbuffer ] .",
    "density differences are plotted in the log scale and decay exponentially , since is valid for the series of @xmath173 .",
    "-0.5 in    [ ex : metal1d ] we now choose @xmath159 and @xmath161 such that  are invalid as shown in figure  [ fig : bandstructuremetal ] .",
    "set @xmath163 $ ] and @xmath174 $ ] . from the left column of figure",
    "[ fig : metal ] , one can see is invalid for @xmath164 with all three boundary conditions .",
    "-0.8 in +   +    fix @xmath165 .",
    "we compare @xmath168 as a function of @xmath100 in the log - log scale for three boundary conditions in the right column of figure [ fig : metal ] .",
    "density differences decay algebraically since assumption  [ assump ] fails .",
    "quantitatively , the method has the best performance when pbc is used .",
    "furthermore , for @xmath175 $ ] and a series of enlarged buffer regions @xmath176 $ ] ( @xmath171 ) , we compare @xmath172 as a function of @xmath100 in the log - log scale in figure [ fig : metalbuffer ] .",
    "density differences decay algebraically as a result of the invalidity of for the series of @xmath173 .",
    "-0.5 in    [ ex : insulatormetal ] for the next example , consider @xmath177 we take @xmath159 and @xmath178 and plot the band structure of this problem in figure [ fig : insulatormetalenergylevelentire ] .",
    "it is clear that this system is an insulating system .",
    "-1.0 in    first , we fix @xmath179 $ ] and choose @xmath180 $ ] .",
    "since @xmath181 , the subsystem is essentially an eigenvalue problem of the laplacian operator , which means is not valid ; see figure  [ fig : insulatormetalenergylevelsub ] .",
    "figure [ fig : insulatormetaldensitydifference1 ] shows that only algebraic decay rate is observed , since  are valid while is invalid .",
    "second , for the fixed @xmath182 $ ] , we choose a series of enlarged buffer regions @xmath183 $ ] ( @xmath184 ) by varying @xmath100 .",
    "@xmath185 as a function of @xmath100 is shown in figure  [ fig : insulatormetaldensitydifference2 ] .",
    "algebraic decay rate is also observed since is invalid in this case .",
    "finally , we fix @xmath186 $ ] and choose a series of enlarged buffer regions @xmath187 $ ] ( @xmath184 ) by varying @xmath100 .",
    "@xmath188 as a function of @xmath100 is shown in figure [ fig : insulatormetaldensitydifference3 ] .",
    "exponential decay rate is observed since becomes valid in this case .",
    "-0.5 in    [ ex:2d ] consider an infinite array of atoms on a two - dimensional lattice with @xmath189 , for @xmath190 .",
    "each atom has one valence electron and spin degeneracy is ignored .",
    "@xmath157 is of the following form @xmath191}.\\ ] ]    figure [ fig : bandstructure2d ] shows band structures when @xmath192 , @xmath160 , and @xmath192 , @xmath161 .",
    "it is clear that for selected parameters , the corresponding system is an insulator in figure [ fig : bandstructure2dinsulator ] , while it is a metal in figure [ fig : bandstructure2dmetal ] .",
    "-0.9 in    first , we fix @xmath193\\times[0.1,5.9]$ ] and choose @xmath194\\times[0 , 6]$ ] .",
    "all three boundary conditions are tested .",
    "@xmath168 is plotted in the centered row of figure [ fig : dendiff2d ] for dbc and pbc .",
    "second , for the fixed @xmath195\\times[2,4]$ ] , we consider a series of enlarged buffer regions @xmath196\\times[2-x,4+x]$ ] ( @xmath184 ) .",
    "@xmath197 is plotted in the bottom row of figure [ fig : dendiff2d ] .",
    "the left column of figure [ fig : dendiff2d ] is for the insulator case , while the right column is for the metal case .",
    "results here are consistent with theoretical estimates .",
    "-0.8 in +   +    [ ex : insulatormetal2d ] consider @xmath198\\times[0,12]\\}/\\{3 < x < 9 , 3 < y < 9\\ } ; \\\\ \\text{periodic extension } , & \\text{otherwise}. \\end{cases}\\ ] ] choose @xmath159 and @xmath178 and plot the band structure of this problem in figure [ fig : insulatormetalenergylevelentire2d ] .",
    "it is clear that  are valid .",
    "-1.0 in    now we fix @xmath199\\times[3.1,8.9]$ ] and choose @xmath200\\times[3,9]$ ] .",
    "since @xmath181 , the subsystem is essentially the eigenvalue problem of the laplacian operator , which implies the invalidity of . as a consequence , only algebraic decay rate is observed in figure [ fig : insulatormetaldensitydifference2d1 ] .",
    "furthermore , we fix @xmath201\\times[5,7]$ ] and choose a series of enlarged buffer regions @xmath202\\times[5-x,7+x]$ ] ( @xmath184 ) by varying @xmath100 . @xmath203 as a function of @xmath100 is shown in figure [ fig : insulatormetaldensitydifference2d2 ] .",
    "algebraic decay rate is also observed again due to the invalidity of .",
    "finally , we fix @xmath204\\times[3,9]$ ] and choose a series of enlarged buffer regions @xmath205\\times[3-x,9+x]$ ] ( @xmath184 ) . @xmath206 as a function of @xmath100 is shown in figure [ fig : insulatormetaldensitydifference2d3 ] . exponential decay rate is observed since becomes valid in this case .",
    "in this work , we identify the crucial gap assumption for both the global system and the subsystem for the accuracy of the dac method for electronic structure calculations . under the gap assumption , we prove that the pointwise difference between electron densities of the global system and the subsystem decays exponentially as a function of the distance away from the boundary of the subsystem .",
    "this analytic conclusion is verified by numerical examples .    from a physical point of view",
    ", our result suggests that while the dac method works quite well for insulating systems , one still needs to be careful in the choice of subdomain and restrictions to guarantee the gap assumption .",
    "moreover , for heterogeneous systems with large local fermi energy variations , such as metal - insulator - metal bilayer devices or systems involving long range charge transfer , application of the dac method might need extra care .    finally , let us emphasize that our accuracy estimate only depends on the size of the gap and the @xmath116 norm of the effective potential .",
    "hence , even though the discussion here focuses on the dac method , the analysis allows for general restriction of hamiltonian , and hence can be applied to a variety of methods in electronic structure calculations using the domain decomposition idea",
    ".    * acknowledgment .",
    "* we thank professor weinan e for suggesting the problem and for his encouragement .",
    "j.l . would also like to thank professor weitao yang for helpful discussions .",
    "the work of j.c . was supported in part by the national science foundation via grant dms-1217315 .",
    "the work of j.l . was supported in part by the alfred p.  sloan foundation and the national science foundation under grant no ."
  ],
  "abstract_text": [
    "<S> we study the accuracy of the divide - and - conquer method for electronic structure calculations . </S>",
    "<S> the analysis is conducted for a prototypical subdomain problem in the method . </S>",
    "<S> we prove that the pointwise difference between electron densities of the global system and the subsystem decays exponentially as a function of the distance away from the boundary of the subsystem , under the gap assumption of both the global system and the subsystem . </S>",
    "<S> we show that gap assumption is crucial for the accuracy of the divide - and - conquer method by numerical examples . </S>",
    "<S> in particular , we show examples with the loss of accuracy when the gap assumption of the subsystem is invalid . </S>"
  ]
}