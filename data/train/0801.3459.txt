{
  "article_text": [
    "@xcite presented an analytical expression for the unconditional mass function of dark matter halos at redshift @xmath0 , @xmath1 , based on the spherical collapse model .",
    "this function is closely related to the first - crossing distribution of random walks with a barrier in the excursion set framework @xcite . in this framework",
    ", the linear over - density computed at a given point in the lagrangian space fluctuates as a markovian process when smoothed on successively smaller scales , and a dark matter halo is identified at the point when the random walk of the linear over - density crosses a critical value , or a barrier @xmath2 . in the spherical collapse model ,",
    "this barrier depends only on time and is independent of mass : @xmath3 , where @xmath4 and @xmath5 is the standard linear growth factor .",
    "although analytically simple , the spherical collapse model has been found to over - predict the abundance of small halos and under - predict that of massive ones ( , @xcite ) .",
    "the reason is mainly that halo collapses are generally triaxial rather than spherical ( , @xcite ) .",
    "based on @xcite , @xcite use the ellipsoidal collapse model and obtain fitting functions that provide a closer match to the unconditional halo mass function in n - body simulations . unlike the spherical collapse model in which the condition for the virialization of a dark matter halo is solely determined by the linear over - density on the scale of the halo mass , the virialization condition in the ellipsoidal collapse model also depends on halo ellipticity and prolateness . by assuming that a dark matter halo becomes virialized",
    "when its third axis collapses , @xcite find a new criterion for the virialization of dark matter halos , which involves all three parameters .",
    "they further simplify the virialization condition by fixing the ellipticity and the prolateness at their most likely values for a given over - density , and obtain a fitting formula for the barrier @xmath2 that is mass - dependent , in contrast to the constant @xmath6 of the spherical collapse model . a mass - dependent barrier is commonly referred to as a _ moving _ barrier , and it is this mass - dependence that suppresses the abundance of small halos while increasing that of massive ones in the ellipsoidal collapse model .",
    "physically , this is because a smaller halo typically has a larger ellipticity and therefore a longer collapsing time .",
    "the relationship between the unconditional mass function and the first crossing distribution associated with barrier - crossing random walks has been extended to obtain the _ conditional _ mass function of halos @xcite . in this so - called extended press - schechter ( eps ) model ,",
    "the conditional mass function @xmath7 gives the average number of progenitor halos ( of mass @xmath8 at redshift @xmath9 ) per unit mass associated with a descendant halo of mass @xmath10 at redshift @xmath11 @xmath12 .",
    "once determined , it can be used to generate merger trees of halos for many applications ( e.g. , galaxy formation , growth of the central black hole , reionization ) using monte carlo simulations .",
    "the conditional mass function has a simple analytic form in the constant barrier spherical collapse model @xcite . for a moving barrier ( such as the ellipsoidal collapse model )",
    ", however , exact analytic forms have been found only for the special case of a linear barrier ( @xcite , st02 hereafter ) ; while the same authors have proposed a taylor - series - like approximation for a general moving barrier .",
    "we find that none of these formulae work well for @xmath13 , which is important for generating accurate merger trees in most monte carlo methods ( , @xcite ) and for relating halo merger rates to the conditional mass function (   2 below ) .",
    "@xcite compare the halo merger rates determined from the millennium simulation ( @xcite ) with the prediction of the spherical collapse eps model , finding the latter to overpredict the major merger rates by up to a factor of @xmath14 and underpredict the minor merger rates by up to a factor of @xmath15 .",
    "recently , various other fitting forms for the conditional mass function have been proposed that are calibrated to the results from particular @xmath16-body simulations , e.g. , @xcite .",
    "an alternative way of deriving the conditional mass function that does not rely explicitly on fitting to simulations is to solve the integral equation proposed by @xcite ( zh06 hereafter ) .",
    "this method , which is based on the conservation of probability in the excursion set formalism , is accurate but computationally expensive .    in  2",
    ", we derive almost exact analytic forms for the first crossing distribution , the conditional mass function , and the halo merger rate in the ellipsoidal collapse model in the limit of small look - back times ; a limit where earlier work breaks down .",
    "our method is based on zh06 , but our results are expressed in simple analytic forms .",
    "we compare the predictions of this improved ellipsoidal collapse model with those from the spherical collapse model and the millennium simulation in  [ millennium ] .",
    "we assume the cosmological parameters used in the millennium simulation : @xmath17 , @xmath18 , @xmath19 , @xmath20 , @xmath21 , @xmath22 .",
    "we use @xmath7 to denote the conditional mass function of dark matter halos , defined in  1 .",
    "we use @xmath23 to denote the merger rate of halos , which is defined to be the number of mergers between halos of mass @xmath24 and @xmath25 per unit volume and unit redshift at redshift @xmath0 . if halo mergers are assumed to be binary and mass conserving such that the consequence of each merger is the formation of a descendant halo of mass @xmath26",
    ", then we can relate the merger rate to the ( number - weighted ) conditional mass function through a simple relation ( see @xcite for a detailed discussion , or @xcite for an earlier discussion ) : @xmath27 where @xmath1 is the ( unconditional ) halo mass function at redshift @xmath0 , and @xmath28 is assumed to be small .    to study how many progenitors at @xmath9",
    "are associated with a descendant halo of mass @xmath10 at @xmath11 , we let the random walk of the linear over - density start from the scale of the descendant halo @xmath29 with an over - density of @xmath30 $ ] , where @xmath31 is the variance of the linear density field smoothed with a window function containing mass @xmath32 .",
    "a progenitor of mass @xmath8 is then identified once the random walk crosses @xmath33 $ ] on the scale of @xmath34 .",
    "the conditional mass function can then be written as @xmath35 where @xmath36 , and @xmath37 is the first - crossing distribution of random walks with a barrier of the form @xmath38-\\mathcal{b}[s(m_0),z_0]$ ] .    as mentioned in   1 , analytic solutions for @xmath37 have only been found when the barrier is a constant or a linear function of @xmath39 .",
    "here we propose an almost exact analytic solution for the first - crossing distribution in the limit of @xmath13 .",
    "we use the fact that the barrier @xmath40 is a weakly nonlinear function of @xmath39 to approximate it by @xmath41 where @xmath42 is assumed to be subdominant in comparison with the other two terms is very large .",
    "but we find that in practice , the relevant range of @xmath43 is rarely large enough to invalidate the assumption . ] .",
    "the first - crossing distribution can then be written as @xmath44 . when @xmath45 , @xmath46 has the analytic form ( see st02 ) : @xmath47\\ ] ] for nonzero @xmath48 , we approximate @xmath49 as @xmath50 and derive the second term on the right side of eq .",
    "( [ approxi1 ] ) next .    for notational simplicity ,",
    "we denote @xmath39 as @xmath51 and @xmath52 as @xmath53 .",
    "the first - crossing @xmath53 in general satisfies the integral equation ( see zh06 for the derivation ) : @xmath54 where @xmath55p_0\\left[b(s),s\\right]\\\\ \\nonumber    g_2(s , s')&=&\\left[2\\frac{db}{ds}-\\frac{b(s)-b(s')}{s - s'}\\right]p_0        \\left[b(s)-b(s'),s - s'\\right]\\\\ \\nonumber    p_0(\\delta , s)&=&\\frac{1}{\\sqrt{2\\pi s}}\\exp \\left(-\\frac{\\delta^2}{2s}\\right)\\end{aligned}\\ ] ] from eq .",
    "( [ f ] ) and after some algebra , we find @xmath56 where @xmath57 \\end{aligned}\\ ] ]    @xmath58 \\ , .\\ ] ]    the two terms in @xmath59 come from @xmath60 and @xmath61 respectively , and a number of terms have been cancelled out using the relation @xmath62= p_0((b_0+b_1s , s)$ ] that follows from eq .",
    "( [ f ] ) for @xmath45 .    the complicated form of @xmath59 in eq .",
    "( [ g1prime ] ) makes it difficult to solve eq .",
    "( [ dfdb2_2 ] ) . however , we are interested in the limit of small look - back times for the conditional mass function , which corresponds to a small barrier difference @xmath63 .",
    "we can thus neglect the terms of @xmath64 and simplify @xmath65 as ) is derived by neglecting the first term on the right side of eq.([g1prime ] ) and approximating @xmath66 ( eq.([flinear ] ) ) as @xmath67 .",
    "these approximations introduce errors of order @xmath68 to @xmath69 and of order @xmath70 to @xmath71 .",
    "similarly , the error on @xmath72 is of order @xmath68 when @xmath73 , and of order @xmath70 when @xmath74 .",
    "we find that this error is negligible when @xmath70 is small . ] : @xmath75 we then solve for @xmath72 by combining eqs .",
    "( [ dfdb2_2 ] ) , ( [ g2prime ] ) , and ( [ g1_analytic ] ) and using the laplace transform : @xmath76   \\,.\\ ] ] substituting this expression back into eq .",
    "( [ approxi1 ] ) , we obtain the first - crossing distribution for a barrier of the form @xmath77 : @xmath78\\\\       \\nonumber   & -&\\frac{b_0b_2}{4}\\exp\\left(-\\frac{b_1 ^ 2\\ds}{2}\\right)\\left[1+\\frac{b_1\\sqrt{\\ds } }     { \\gamma(3/2)}\\right ]   + { \\cal{o}}(b_0 ^ 2 ) \\,.\\end{aligned}\\ ] ] this is our main result .",
    "we note that this equation reduces to the analytic expressions of eq .",
    "( [ flinear ] ) in the spherical collapse model ( i.e. a constant barrier with @xmath79 ) and the ellipsoidal model with a linear barrier ( i.e. @xmath45 ) . the second term on the right hand side of eq .",
    "( [ f_complete ] ) is a new term arising from the quadratic part of @xmath80 .",
    "this term is absent in the taylor series approximation proposed in eq .",
    "( 7 ) of st02 .",
    "the latter is obtained by replacing the barrier @xmath81 and the variance @xmath82 in their unconditional mass function in the ellipsoidal model with @xmath83 and @xmath84 , respectively ; that is , they assume that the unconditional and conditional mass functions have the same form .",
    "this assumption holds exactly in the spherical case but is not so for ellipsoidal collapse . as we illustrate in fig .  1 below",
    ", their expression for the conditional mass function becomes inaccurate for small look - back times .",
    "we can now use eq .",
    "( [ dndm_f ] ) to convert our first - crossing distribution in eq .",
    "( [ f_complete ] ) into the conditional mass function .",
    "we first need to specify the coefficients @xmath85 , and @xmath48 for the barrier @xmath86-\\mathcal{b}[s(m_0),z_0]$ ] .",
    "to do so , we use the barrier shape from @xcite and st02 that has been shown to provide close fits for the _ unconditional _ mass function : @xmath87=\\sqrt{\\gamma}\\omega(z)\\left[1+\\beta(\\gamma\\nu)^{-\\alpha}\\right]\\ ] ] where @xmath88 , @xmath89 , @xmath90 , @xmath91 , @xmath92 , @xmath4 , and @xmath5 is the linear growth factor .",
    "when @xmath13 , it is straightforward to show that @xmath93 , @xmath94 , and @xmath95^{1/2}$ ] , where @xmath96 , @xmath97 , @xmath98 , @xmath99 , and @xmath100 .",
    "the resulting conditional mass function in our ellipsoidal collapse model for @xmath13 is : @xmath101\\right\\}\\end{aligned}\\ ] ] where @xmath102 is the standard spherical model result , @xmath103 , and @xmath104 are related to @xmath105 defined above , and @xmath106 .",
    "we find that neglecting the @xmath104 term in eq.([nm ] ) ( or @xmath48 in eq .",
    "( [ f_complete ] ) ) leads to a systematic error of @xmath107 for @xmath108 .",
    "it is also worth noting that since the barriers at different redshifts can intersect in the moving barrier model ( see appendix a of st02 for more details ) , @xmath109 in eq .",
    "( [ nm ] ) can be negative .",
    "this occurs very rarely , however , since @xmath110 only when @xmath111 , when the descendant mass is much smaller than the typical halo mass at @xmath11 .",
    "we can now use eqs .",
    "( [ relation ] ) and ( [ nm ] ) to write down an analytic expression for the halo merger rate . following the notation of @xcite",
    ", we express the merger rate in terms of the total descendant mass @xmath26 and the mass ratio of the two progenitors @xmath112 ( assuming @xmath113 ) , and use @xmath114 to relate the two rates . by treating the average merger rate _ per descendant halo _ , @xmath115 , as a single physical quantity , we find @xmath116\\right\\ } \\end{aligned}\\ ] ] @xmath117 , @xmath118 , and the prediction from the spherical collapse model is @xmath119 where @xmath120 can be either of the progenitors @xmath8 or @xmath121 .",
    "we recall that the conditional mass function and the merger rate in the eps model is not symmetric with respect to the two progenitor masses .",
    "this remains an unsolved problem .",
    "below we simply show the results for both choices . according to the notation of @xcite",
    ", we call the merger rate `` option a '' when @xmath120 is assigned to the smaller progenitor @xmath121 , and `` option b '' when @xmath122 .",
    "in fig .  [ nm_compare ] , we illustrate the accuracy of eq .",
    "( [ nm ] ) by comparing it with the exact solution from zh06 and the analytic approximation based on eq .",
    "( 7 ) of st02 .",
    "the figure shows the conditional mass functions at four different look - back times ( @xmath123 ) for a descendant halo of mass @xmath124 at redshift zero .",
    "the approximation of st02 is seen to overpredict the number of lower mass progenitors by up to a factor of 2 to 10 for @xmath125 , whereas eq .",
    "( [ nm ] ) of this paper is accurate when @xmath28 is as small as 0.003 .    for the halo merger rate ,",
    "we compare the predictions of our ellipsoidal model with the millennium simulation merger rate determined by @xcite using the `` stitching '' method .",
    "they find that the halo merger rate in the simulation converges well when the look - back time @xmath28 approaches zero and can be described by a simple universal fitting formula : @xmath126           \\left[\\frac{d\\omega(z)}{dz}\\right]^{\\alpha_4}\\ ] ] where @xmath127 , @xmath128 , @xmath129 , @xmath130 , @xmath131 , @xmath132 , and @xmath133 .",
    "their fig .",
    "15 illustrates the large discrepancy between eq .",
    "( [ b_mi ] ) and the prediction of the standard spherical eps model .    figs .",
    "[ mr1 ] ( for option a ) and [ mr2 ] ( option b ) show the ratio between the halo merger rate @xmath134 of our ellipsoidal collapse model ( eq .  ( [ b0 ] ) ) and that of the millennium simulation ( eq.([b_mi ] ) ) for three descendant halo masses and four redshifts .",
    "the spherical collapse model ( eq .  ( [ b0_spherical ] ) ) is also shown for comparison .",
    "the minimum halo mass is chosen to be @xmath135 as set by the halo mass resolution in the millennium simulation .",
    "comparison of the two figures shows that the two choices of @xmath120 give similar results for major mergers but yield very different predictions for @xmath136 , where option a ( fig .  [ mr1 ] ) agrees better with the millennium than option b ( fig .  [ mr2 ] ) .",
    "we note that the two options predict different power - law dependencies on @xmath137 at @xmath136 : for @xmath138 , option a gives @xmath139 , but option b gives @xmath140 , which is independent of the density variance on the scale of the smaller progenitor mass .",
    "it is also interesting to note that option a is implicitly used in some monte carlo methods ; for example , @xcite select the mass of the first progenitor from the lower half of the conditional mass function ( i.e. @xmath141 ) .    according to fig .",
    "[ mr1 ] , the discrepancy between our ellipsoidal collapse model and the millennium simulation is typically @xmath142 , but can reach up to about @xmath143 when @xmath144 . on the other hand ,",
    "the relative difference between the spherical collapse model and millennium is typically @xmath145 , and reaches up to @xmath146 for the major mergers .",
    "therefore in almost every case , the new ellipsoidal collapse model improves the agreement with the millennium simulation .",
    "we have derived new analytic formulae for the first - crossing distribution ( eq.([f_complete ] ) ) , the conditional mass function ( eq.([nm ] ) ) , and the merger rate of dark matter halos ( eq.([b0 ] ) ) in the ellipsoidal collapse model in the limit of small look - back times .",
    "our method is based on solving the first - crossing distribution of random walks with a moving barrier using the exact integral equation of zh06 .",
    "this method results in extra terms in eqs .",
    "( [ f_complete ] ) , ( [ nm ] ) , and ( [ b0 ] ) that are absent in the spherical collapse model and different from those in the ellipsoidal model of st02 .",
    "1 illustrates how these terms correct the discrepancies of st02 in the conditional mass function for small look - back times @xmath147 .",
    "( [ relation ] ) relates the conditional mass function at small @xmath28 to the halo merger rate . the halo merger rate of our ellipsoidal collapse model generally agrees better with the millennium result reported in @xcite than that of the spherical collapse model ( red vs blue curves in figs .",
    "[ mr1 ] and [ mr2 ] ) .",
    "the discrepancy between our ellipsoidal collapse model and the millennium simulation is typically @xmath148 , which is about a factor of two smaller than that of the spherical collapse model . a comparison between figs .",
    "[ mr1 ] and [ mr2 ] shows a better agreement between model and simulation when the progenitor mass @xmath120 in the analytic formulae is assigned to be the smaller progenitor ( option a ) .",
    "a number of factors not considered in this paper nor in earlier eps work can contribute to the remaining 20 - 30% discrepancy between the model and simulation .",
    "these include the statistical importance of non - binary mergers , diffuse accretion and tidal stripping of halo mass ( such that @xmath149 ) , and the impact of a halo s environment on merger rates that can lead to non - markovian processes in the excursion set model ( st02 , @xcite ) .    our conditional mass function in eq.([nm ] )",
    "can be easily incorporated into monte carlo simulations to study halo merger histories over a large look - back time .",
    "this is done in a companion paper , in which we compare several existing monte carlo algorithms ( , @xcite ) that are all based on the spherical collapse model , and propose a more accurate method using eq.([nm ] ) .",
    "several groups have recently proposed accurately parameterized forms of the conditional mass function based on fits to the millennium results and incorporated them into different monte carlo simulations ( @xcite ) . as we will show in the companion paper ( also see @xcite for a different method ) , a similar level of accuracy can be achieved using eq.([nm ] ) of this paper and our monte carlo method without a priori knowledge of n - body simulations .",
    "we thank james bullock , joanne cohn , lam hui , ravi sheth , martin white , and simon white for useful discussions .",
    "this work is supported in part by nsf grant ast 0407351 . the millennium simulation databases used in this paper and the web application providing online access to them were constructed as part of the activities of the german astrophysical virtual observatory ."
  ],
  "abstract_text": [
    "<S> analytic models based on spherical and ellipsoidal gravitational collapse have been used to derive the mass functions of dark matter halos and their progenitors ( the _ conditional _ mass function ) . </S>",
    "<S> the ellipsoidal model generally provides a better match to simulation results , but there has been no simple analytic expression in this model for the conditional mass function that is accurate for small time steps , a limit that is important for generating halo merger trees and computing halo merger rates . </S>",
    "<S> we remedy the situation by deriving accurate analytic formulae for the first - crossing distribution , the conditional mass function , and the halo merger rate in the ellipsoidal collapse model in the limit of small look - back times . </S>",
    "<S> we show that our formulae provide a closer match to the millennium simulation results than those in the spherical collapse model and the ellipsoidal model of sheth & tormen ( 2002 ) .    </S>",
    "<S> [ firstpage ]    galaxies : clusters : general - cosmology : theory - dark matter </S>"
  ]
}