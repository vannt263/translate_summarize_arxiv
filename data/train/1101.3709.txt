{
  "article_text": [
    "the elegant principles of symmetry and invariance appear in many areas of statistical research [ e.g. , @xcite , @xcite , @xcite , @xcite ] .",
    "symmetry restrictions in the multivariate gaussian distribution have a long history [",
    "@xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ] and have recently been combined with conditional independence relations [ @xcite , @xcite , @xcite , @xcite ] .",
    "this article is concerned with graphical gaussian models with symmetry constraints introduced by @xcite .",
    "the types of restrictions are : equality between specified elements of the concentration matrix ( rcon ) , equality between specified partial correlations ( rcor ) and restrictions generated by permutation symmetry ( rcop ) , a special instance of the former two .",
    "the models can be represented by vertex and edge colored graphs , where parameters associated with equally colored vertices or edges are restricted to being identical .",
    "we consider maximum likelihood estimation of a nonzero mean @xmath0 subject to specific equality constraints , assuming the covariance matrix @xmath1 satisfies the restrictions of one of the above models .",
    "this could be relevant , for example , if treatment effects are to be estimated in an experiment where the basic error structure in the units exhibits conditional independencies in a  symmetric pattern .    for the gaussian distribution , maximum likelihood estimation of @xmath0 under an unknown covariance structure",
    "is generally nontrivial , as the maximizer of the likelihood function in @xmath0 for fixed @xmath1 may depend on @xmath1 .",
    "the least - squares estimator @xmath2 , however , is defined by minimizing the sum of squares so that in case of equality of @xmath3 and @xmath2 , the former is independent of @xmath4 .",
    "@xcite showed that for for fixed @xmath1 , and @xmath0 in an affine space @xmath5 , @xmath3 and @xmath2 agree if and only if @xmath5 is stable under @xmath1 , or equivalently under @xmath6 ; see also @xcite and @xcite . here",
    "we derive a necessary and sufficient condition on the graph coloring representing a model and the symmetry constraints on the mean vector @xmath0 which ensures this stability and hence equality of estimators .",
    "we let @xmath7 denote the dependence graph of the model and let its colored version be denoted by @xmath8 , where @xmath9 denotes a partition of @xmath10 into vertex color classes and @xmath11 a partition of @xmath12 into edge color classes .",
    "the symbol @xmath13 is to denote a partition of @xmath10 such that whenever two vertices are in the same set of @xmath13 , the corresponding means are restricted to being equal .",
    "the necessary and sufficient condition for equality of @xmath3 and @xmath2 in the symmetry model represented by @xmath14 is twofold : ( i ) the partition @xmath13 must be finer than @xmath15 ; and ( ii ) the partition must be _ equitable _ with respect to every edge color class in @xmath11 as defined by @xcite .",
    "for example , the graph in figure  [ fig : frets ] represents a graphical gaussian symmetry model for data concerning the head dimensions of first and second sons known as _ frets s heads _",
    "[ @xcite , @xcite ] ; here @xmath16 denotes the length and breadth of the head of the first son , and similarly for @xmath17 .",
    "this model has previously been found to be well supported by the data [ @xcite , @xcite , @xcite ] when no constraints were considered on the means .",
    "we may , for example , be interested in the hypothesis that the two lengths have the same mean , and the two breadths have the same mean , indicating that head dimensions do not generally change with the parity of the son .",
    "we shall demonstrate that this hypothesis is simple in the sense that the maximum likelihood estimator , or mle for short , of the mean under this hypothesis can be found by a simple average .",
    "also , we shall demonstrate that this is not the case if we consider lengths and breadths separately .",
    "let @xmath7 be an undirected graph with vertex set @xmath10 and edge set @xmath12 and let @xmath18 be a multivariate gaussian random vector . then the _ graphical gaussian model",
    "_ represented by @xmath19 is the set of gaussian distributions for which @xmath20 is conditionally independent of @xmath21 given the remaining variables , denoted @xmath22 , whenever there is no edge between @xmath23 and @xmath24 in @xmath19 .    for a multivariate gaussian @xmath25 distribution with concentration matrix @xmath26",
    ", it holds that @xmath27 if and only if @xmath28 . thus letting @xmath29 denote the set of symmetric positive definite matrices indexed by @xmath10 whose @xmath30-entry is zero whenever @xmath31 , the graphical gaussian model represented by @xmath19 assumes @xmath32 for further details , see , for example , @xcite , chapter  5 .      for general graph terminology we refer to @xcite . following",
    "@xcite we define the following notation for graph colorings .",
    "let @xmath7 be an undirected graph .",
    "then a _ vertex coloring _ of @xmath19 is a partition @xmath33 of @xmath10 , where we refer to @xmath34 as the _ vertex color classes_. similarly , an _ edge coloring _ of @xmath19 is a  partition @xmath35 of @xmath12 into @xmath36 _ edge color classes _ @xmath37 .",
    "we call a color class containing one element a _ singleton _ and a partition containing only singletons as elements a _",
    "singleton partition_.    then @xmath38 denotes the _ colored graph _ with vertex coloring @xmath9 and edge coloring @xmath11 ; we also say that @xmath14 is a _",
    "graph coloring_. we indicate the color class of a vertex by the number of asterisks we place next to it .",
    "similarly we indicate the color class of an edge by dashes .",
    "color classes which are singletons are displayed in black and without asterisks or dashes .",
    "as we shall be considering constraints on the mean vector defined by partitions of the mean vector into groups of equal entries , we introduce the following notation . for @xmath13 a partition of @xmath10 and @xmath39",
    ", we write @xmath40 to denote that @xmath23 and @xmath24 lie in the same set in  @xmath13 and let @xmath41 be the linear space of vectors which are constant on each set of the partition @xmath13 : @xmath42    for two partitions @xmath43 and @xmath44 of the same set , we shall say that @xmath43 is _ finer than _ @xmath44 , denoted by @xmath45 , if every set in @xmath44 can be expressed as a union of sets in @xmath43 .",
    "we equivalently say that @xmath46 is _ coarser than _ @xmath43 .    if @xmath47 is a set of edges in a graph @xmath19 , for @xmath48 we shall write @xmath49 to denote the set of vertices which are connected to @xmath23 by an edge inside @xmath47 .",
    "we further adopt the following notation from @xcite . for a colored graph @xmath38 and @xmath50 we let @xmath51 denote the @xmath52 diagonal matrix with @xmath53 if @xmath54 and 0 otherwise .",
    "similarly , for each edge color class @xmath55 we let @xmath51 be the @xmath52 symmetric matrix with @xmath56 if @xmath57 and 0 otherwise .",
    "letting @xmath58 as above , the density of @xmath59 is given by @xmath60 so that the likelihood function based on a sample @xmath61 where @xmath62 are independent , and @xmath63 becomes @xmath64    if @xmath0 is unrestricted , so that @xmath65 , the likelihood function @xmath66 in ( [ eq : likfunction ] ) is maximized over @xmath0 for fixed @xmath67 by the least squares estimator @xmath68 , and inference about @xmath67 can be based on the profile likelihood function @xmath69 where @xmath70 is the matrix of sums of squares and products of the residuals . however , inference about @xmath0 when @xmath67 is unknown and needs to be estimated is generally not possible , a classic example being known as the _ behrens  fisher problem _ [ see @xcite and @xcite ] , where @xmath1 is bivariate and diagonal whereas the mean vector satisfies the restriction @xmath71 .",
    "@xcite found the following necessary and sufficient condition for the two estimators to agree for fixed @xmath1 :    [ thm : kruskal ] let @xmath72 be a random vector in an inner product space with unknown mean @xmath0 in a linear space @xmath5 and known covariance matrix  @xmath4 .",
    "then the estimators @xmath2 and @xmath3 coincide if and only if @xmath5 is invariant under @xmath73 , that is , if and only if @xmath74    consequently , if ( [ eq_kruskal ] ) is satisfied by all @xmath67 in a model , the likelihood function can be maximized for fixed @xmath67 by @xmath75 , and inference on @xmath67 can be based on the profile likelihood ( [ eq : proflik ] ) .",
    "as stated earlier , we consider three model types introduced in @xcite , which can be represented by colored graphs . these are discussed briefly here , and we refer to @xcite for further details .",
    "rcon models place constraints on the concentration matrix @xmath67 .",
    "they restrict off - diagonal elements of @xmath67 separately from those on the diagonal , so that the restrictions can be represented by a graph coloring @xmath14 of @xmath19 , with @xmath9 representing the diagonal and @xmath11 the off - diagonal constraints .",
    "the corresponding set of positive definite matrices is denoted by @xmath76 .",
    "rcor models combine restrictions on the diagonal of @xmath67 with equality constraints on partial correlations , given by @xmath77 constraints of rcor models may also be represented by a graph coloring @xmath14 , and we denote the corresponding set of positive definite matrices by @xmath78 .",
    "rcop models are determined by distribution invariance under a group of permutations of the vertices which preserve the edges of the graph , that is , a subgroup of @xmath79 , the group of _ automorphisms _ of @xmath19 . for @xmath80 ,",
    "let @xmath81 be the permutation matrix representing @xmath82 , with @xmath83 if and only if @xmath82 maps @xmath24 to @xmath23 , for @xmath39 .",
    "then a gaussian @xmath84 distribution is preserved by @xmath82 if and only if @xmath85 the rcop model generated by a group @xmath86 assumes @xmath87 where @xmath88 denotes the set of positive definite matrices satisfying ( [ cond ] ) for all @xmath89 [ @xcite ] .      under certain conditions on the coloring , rcon and rcor models , which are determined by the same colored graph , coincide in their model restrictions .",
    "first we define edge regularity of a graph coloring .",
    "[ def_edge_reg ] let @xmath38 be a colored graph .",
    "we say that @xmath14 is _ edge regular _ if any pair of edges in the same color class in @xmath11 connects the same vertex color classes .",
    "the relevant result in @xcite then becomes :    [ prop_rcon_rcor ] the rcon and rcor models , that are determined by the colored graph @xmath38 , yield identical restrictions , that is , @xmath90 if and only if @xmath14 is edge regular .",
    "rcop models fall into the class of models which satisfy the condition in proposition  [ prop_rcon_rcor ] , as we show below :    [ rcop_edge ] if a colored graph @xmath38 represents an rcop model , then @xmath14 is edge regular",
    ".    let @xmath38 represent an rcop model , generated by permutation group @xmath91 , say , and let @xmath55 and @xmath92 . by definition ,",
    "there exists @xmath89 mapping @xmath93 to @xmath94 while leaving @xmath14 invariant .",
    "this implies that the colorings of the end vertices of @xmath93 and @xmath94 must be identical .",
    "thus , if for a graph @xmath7 we let @xmath9 and @xmath11 denote the vertex orbits and edge orbits of a group @xmath95 , then @xmath96 [ @xcite ] .",
    "for example , since the coloring of the graph in figure  [ fig : frets ] is generated by the group @xmath97 with @xmath82 simultaneously permuting @xmath98 with @xmath99 and @xmath100 with @xmath101 , the corresponding two sets @xmath102 and @xmath78 coincide .",
    "by theorem  [ thm : kruskal ] , the maximum likelihood estimator @xmath103 and least - squares estimator @xmath2 agree for @xmath0 in a linear subspace @xmath104 if and only if @xmath5 is stable under all @xmath67 in the model . below we show that for rcon and rcor models , and thus also for rcop models , invariance of @xmath5 under @xmath67 is equivalent to invariance under @xmath105 .",
    "[ invar_rcon ] let @xmath106 be a colored graph representing the rcon model with @xmath107 .",
    "then for @xmath104 , @xmath108    by definition of rcon models , all @xmath109 can be written as @xmath110 with @xmath111 such that the expression in ( [ k_restrictions ] ) is positive definite .",
    "suppose first that we have @xmath112 since @xmath5 is a linear space this implies invariance under all @xmath113 .",
    "next suppose @xmath114 for all @xmath109 .",
    "@xmath115 is an open convex cone , so that for all @xmath116 and @xmath117 there exists @xmath118 such that @xmath119 by assumption , @xmath114 and @xmath120 , which gives @xmath121 and thus the desired result .",
    "although the cone @xmath122 is not in general convex , the same holds for rcor models , as shown below .",
    "[ invar_rcor ] let @xmath38 be a colored graph .",
    "then for @xmath104 , @xmath123    let @xmath124 denote the diagonal matrix with entries equal to the inverse partial standard deviations , that is , @xmath125 and let @xmath126 have all diagonal entries equal to 1 and all off - diagonal entries be given by the negative partial correlations @xmath127 .",
    "then , by ( [ rho ] ) , all @xmath128 can be uniquely expressed as @xmath129 where for @xmath130 and @xmath55 , we let @xmath131 and @xmath132 denote @xmath133 , @xmath134 and @xmath135 , @xmath136 , respectively . as for @xmath137 , @xmath138 is zero unless @xmath139 , when it equals @xmath140 , and equation ( [ k_repar ] ) simplifies to @xmath141 suppose first that we have @xmath142 as before , since @xmath5 is a linear space , ( [ eq : k_in_rcor_expr ] ) implies invariance under all @xmath128 .",
    "so suppose @xmath143 for all @xmath144 .",
    "then , in particular , @xmath5 is invariant under all @xmath67 of the form @xmath145 represented by the graph coloring @xmath146 , which has the same edge coloring as @xmath14 , but with all vertices of the same color .",
    "this graph coloring is clearly edge regular ( as all edges connect the only vertex color class back to itself ) , which gives that the represented model is also of type rcon",
    ". we may therefore apply proposition  [ invar_rcon ] , giving @xmath147    for the vertex coloring , consider the submodel @xmath148 this submodel is represented by the independence graph with no edges and vertex coloring @xmath9 , which is also edge regular , so that by proposition  [ invar_rcon ] , @xmath149 completing the proof .",
    "let  @xmath13 be a partition of @xmath10 and consider @xmath150 as in ( [ omega_m ] ) . in the following we derive a necessary and sufficient condition on @xmath13 and @xmath14 for @xmath150 to be invariant under all @xmath107 or all @xmath151 . by propositions  [ invar_rcon ] and  [ invar_rcor ] we may consider vertex and edge color classes of the colored graph representing the model separately .",
    "we begin with the vertex coloring .",
    "[ prop_finer_par ] let @xmath13 and @xmath9 be partitions of @xmath10 .",
    "then @xmath41 is invariant under @xmath152 if and only if @xmath153 .",
    "the action of @xmath140 for @xmath130 on @xmath154 is given as @xmath155 let @xmath156 , and suppose that @xmath157 for all @xmath158 . in order for @xmath159 for all @xmath160 , we must have @xmath161 whenever @xmath162 , or equivalently @xmath153 .",
    "conversely , suppose @xmath163 .",
    "then @xmath161 whenever @xmath162 , which gives @xmath164 for all @xmath130 .",
    "note that the above result implies that the likelihood can not be maximized in @xmath0 independently of the value of @xmath67 in the behrens  fisher setting , which is the rcon and rcor model on two variables specified by @xmath165 , @xmath166 together with the restriction @xmath167 on the means , as the mean partitioning is then coarser than the vertex coloring .",
    "also , for the model of frets s heads in figure  [ fig : frets ] , the mle of the mean is not simple if we , for example , wish to estimate the mean under the hypothesis that the heads tend to be square - shaped , that is , if mean lengths are equal to mean breadths , as this partition would not be finer than the vertex coloring .    for the edge coloring , we require the concept of an _ equitable partition _ ,",
    "first defined by @xcite .",
    "[ equitable_def ] let @xmath7 be an undirected graph . then",
    "a  partition , or equivalent coloring , @xmath9 of @xmath10 is called _ equitable with respect to  @xmath19 _ if for all @xmath130 , @xmath168 , @xmath169    @xcite proved the following .",
    "[ prop_chan ] let @xmath7 be an undirected graph with adjacency matrix @xmath170 , and let @xmath13 be a partition of @xmath10 .",
    "then @xmath41 is invariant under @xmath170 if and only if @xmath13 is equitable with respect to @xmath19 .",
    "the notion of an equitable partition for vertex colored graphs can be naturally extended to graphs with colored vertices and edges .",
    "we term the corresponding graph colorings _ vertex regular _ , defined below .",
    "[ palette ] let @xmath38 be a colored graph , and let the subgraph induced by the edge color class @xmath171 be denoted by @xmath172 .",
    "we say that @xmath173 is _ vertex regular _ if @xmath9 is equitable with respect to @xmath174 for all @xmath55 .",
    "combining definition  [ palette ] with proposition  [ prop_chan ] yields vertex regularity to be a  necessary and sufficient condition for @xmath41 to be invariant under @xmath175 :    [ prop_edge_invariance ] for @xmath38 a colored graph and @xmath13 a partition of  @xmath10 , @xmath41 is invariant under @xmath176 if and only if @xmath177 is vertex regular .    for @xmath55",
    ", @xmath51 is the adjacency matrix of @xmath174 . by proposition  [ prop_chan ] ,",
    "@xmath150 is stable under @xmath176 if and only if @xmath13 is equitable with respect to @xmath174 for all @xmath171 , or equivalently if and only if @xmath178 is vertex regular .    for the frets s heads model in figure  [ fig : frets ] , this implies that restricting the mean breadths and mean lengths on their own does not ensure @xmath179 , as the corresponding partitions @xmath180 and @xmath181 do not give rise to vertex regular colorings @xmath182 .",
    "combining proposition  [ prop_finer_par ] and proposition  [ prop_edge_invariance ] establishes our main result :    [ means ] let @xmath38 be a colored graph , let @xmath13 be a partition of @xmath10 and consider a sample from a multivariate gaussian @xmath183 distribution with @xmath156 and @xmath184 , both unknown .",
    "it then holds that @xmath185 the same conclusion holds if @xmath186 is replaced by @xmath187 .",
    "in fact , for any colored graph @xmath8 there is always a coarsest partition @xmath13 satisfying the conditions in ( [ thm_cond ] ) [ @xcite ] .",
    "the finest variant of such a coarsest equitable refinement @xmath13 of @xmath9 is given by the singleton partition .",
    "clearly it is finer than any vertex coloring , and further naturally gives a vertex regular coloring @xmath182 .",
    "note that in this case @xmath188 corresponds to the unrestricted case considered in section  [ mle_section ] , conforming with the fact that then @xmath189 .",
    "the coarsest possible @xmath13 for rcon and rcor models , by ( [ thm_cond ] ) , is @xmath9 , for which @xmath190 if and only if @xmath14 is vertex regular .",
    "this always holds for rcop models .",
    "[ rcop_palette ] if a colored graph @xmath38 represents an rcop model , then @xmath14 is vertex regular .",
    "let @xmath38 represent an rcop model , generated by a subgroup @xmath86 , say . by proposition  [ rcop_edge ] , @xmath173 is edge regular .",
    "thus whenever two edges @xmath191 are of the same color , they connect the same vertex color classes .",
    "let @xmath39 be two equally colored vertices in @xmath15 .",
    "then , by definition of rcop models , there exists a permutation @xmath89 which maps @xmath23 to @xmath24 leaving @xmath14 invariant .",
    "this implies that the degree in each edge color class of @xmath23 and @xmath24 must be identical .",
    "the previous two statements imply @xmath192 for all @xmath130 and all pairs @xmath39 with @xmath161 , which is precisely the criterion of vertex regularity for the graph coloring @xmath193 .",
    "we mention in passing that proposition  [ rcop_edge ] and proposition  [ rcop_palette ] combined establish that colorings of graphs which represent rcop models are _ regular _ in the terminology of @xcite .",
    "we conclude from theorem  [ means ] and proposition  [ rcop_palette ] :    [ cor ] let @xmath7 be an undirected graph , and let @xmath193 represent the constraints of an rcop model generated by group @xmath194 .",
    "then for a sample from a multivariate gaussian @xmath183 distribution with @xmath195 and @xmath196 , both unknown , we always have @xmath190 .",
    "we first consider the example in figure  [ fig : frets ] on head dimensions for first and second sons .",
    "representing an rcop model , by proposition  [ rcop_palette ] , the graph in figure  [ fig : frets ] has a vertex regular coloring .",
    "it follows from corollary  [ cor ] that the maximum likelihood estimate of the mean under the hypothesis that the mean length and mean breadth are equal for the two sons is simply the total average of the head lengths and the head breadths , respectively .",
    "similarly , it follows from theorem  [ means ] that the only hypotheses about the mean that have a simple solution are this one and the one where the means are completely unrestricted .",
    "the empirical means of the dimensions @xmath197 are equal to @xmath198 , so that the mle of the means under the hypothesis that the mean lengths and breadths are independent of the parity of the son then become @xmath199 . the likelihood ratio test is obtained by comparing the maximized profile likelihoods ( [ eq : proflik ] ) calculated with appropriate residual covariance matrices @xmath200 under the two hypotheses . using the ` r`-package ` grc ` [ @xcite ] this yields @xmath201 on 2 degrees of freedom",
    ", so there is no evidence for the sizes depending on the parity of the son .",
    "our second example is concerned with the examination marks of 88 students in five mathematical subjects [ @xcite ] . the rcop model represented by @xmath38 in figure  [ fig_math ]",
    "was demonstrated to be an excellent fit in @xcite .",
    "the model is given by invariance of @xmath67 under simultaneously permuting mechanics with statistics , and vectors with analysis . in their fit",
    ", @xcite implicitly assumed an unconstrained mean .",
    "the mle  @xmath3 is then given by the sample averages @xmath202 in the obvious notation , which corresponds to @xmath13 being the singleton partition .",
    "however , it could be natural to assume @xmath0 subject to the same invariance as @xmath67 , meaning @xmath203 , or in this case @xmath204 and @xmath205 . then , by corollary  [ cor ] , @xmath206 . the likelihood ratio statistic for this mean structure relative to the model in figure",
    "[ fig_math ] with unconstrained mean takes the value of 11.9 on 2 degrees of freedom , and the hypothesis about symmetry in the means is therefore clearly rejected with @xmath207 .    note",
    "that the sample averages for vectors and algebra are almost identical . however , combining the constraints on @xmath67 represented by the graph in figure  [ fig_math ] with any hypothesis on the means implying @xmath208 will require joint maximization in @xmath0 and @xmath67 of the likelihood function in ( [ eq : likfunction ] ) to obtain @xmath3 .",
    "the main result of this article is a necessary and sufficient condition on the pattern of equality constraints on the mean vector @xmath0 in a  graphical gaussian symmetry model with colored graph @xmath209 which ensures the identity of the least squares estimate @xmath2 and the maximum likelihood estimate @xmath3 , given in theorem  [ means ] .",
    "the derived necessary and sufficient condition is formulated in terms of vertex and edge colored graphs and is easily testable , so that any set of equality constraints on @xmath0 together with constraints on either @xmath67 or the partial correlations can be verified for estimability of @xmath0 by @xmath2 .",
    "the result is , for example , useful if one set of constraints , either on the mean or the independence structure , is assumed to be given and the other may be varied .",
    "a setting which falls into this category is the design of experiments seeking to estimate mean treatment effects under the assumption of correlations with inherent symmetries in the error structure at experimental sites .",
    "a systematic arrangement of the sites may enforce a symmetry pattern in the concentrations or partial correlations , and thus restrict the concentration matrix as in one of models considered here .",
    "allocation of treatments then effectively restricts the mean response at sites with the same treatment to be identical , and the condition derived can be used to find treatment allocations which ensure estimability of mean treatment effects without knowledge of the value of @xmath1 .",
    "an interesting question directly emerging from our work is concerned with the exact distributions of likelihood ratio test statistics for hypotheses about the mean in rcon , rcor and rcop models . in the examples discussed in this paper we have relied on asymptotic theory to judge the significance of test statistics , but it is likely that their distributions can be derived explicitly , for example when the mean hypothesis is given by the natural symmetry of an rcop model . @xcite developed explicit likelihood ratio tests for decomposable mean - zero rcop models generated by compound symmetry [ @xcite ] , and it would be interesting to extend these results to models with nonzero means and more general symmetry constraints .",
    "we note that if our condition is not satisfied , we would expect phenomena similar to those in the behrens  fisher problem implying the general nonuniqueness of the mle [ @xcite ] and the nonexistence of an @xmath23-similar test of the mean hypothesis [ @xcite ] ."
  ],
  "abstract_text": [
    "<S> we study the problem of estimability of means in undirected graphical gaussian models with symmetry restrictions represented by a colored graph . following on from previous studies , </S>",
    "<S> we partition the variables into sets of vertices whose corresponding means are restricted to being identical . </S>",
    "<S> we find a necessary and sufficient condition on the partition to ensure equality between the maximum likelihood and least - squares estimators of the mean .    .    </S>"
  ]
}