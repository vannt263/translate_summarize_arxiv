{
  "article_text": [
    "minimum @xmath0 algorithms for the alignment of tracking detectors generally come in two flavours , namely those that ignore and those that do not ignore the correlations between hit residuals .",
    "the former are sometimes called _ local _ or _ iterative _ methods while the latter are called _ global _ or _ closed - form _ methods  @xcite .",
    "the advantage of the closed - form methods is that for an alignment problem in which the measurement model is a linear function of both track and alignment parameters the solution that minimizes the total @xmath0 can be obtained with a single pass over the data .",
    "the covariance matrix for the track parameters is an essential ingredient to the closed - form alignment approach  @xcite .",
    "if the track fit is performed using the standard expression for the least - squares estimator ( sometimes called the _ standard _ or _ global _ fit method ) , the computation of the covariance matrix is a natural part of the track fit .",
    "this is why previously reported implementations of the closed - form alignment procedure ( e.g.  @xcite ) make use of the standard fit .",
    "in contrast most modern particle physics experiments rely on a kalman filter track fit  @xcite for default track reconstruction .",
    "the kalman filter is less computationally expensive than the standard fit and facilitates an easy treatment of multiple scattering in the form of process noise .",
    "however , the computation of the covariance matrix in the common kalman track fit is not complete : the correlations between track parameters at different position along the track are not calculated . in the presence of process noise",
    "these correlations are non - trivial .",
    "consequently , the result of the common kalman track fit can not be used directly in a closed - form alignment procedure .    in this paper",
    "we present the expressions for the computation of the global covariance matrix  the covariance matrix for all parameters in the track model  in a kalman filter track fit .",
    "we show how this result can be used in an alignment procedure .",
    "furthermore , using similar expressions we demonstrate how vertex constraints can be applied in the alignment without refitting the tracks in the vertex . to illustrate that our approach leads to a functional closed - form alignment algorithm , we present some results obtained for the alignment of the lhcb vertex detector with monte carlo simulated data .",
    "an important motivation for extending the kalman track fit for use in a closed - form alignment approach is that the estimation of alignment parameters is not independent of the track model .",
    "typically , in closed - form alignment procedures the track model used in the alignment is different from that used in the track reconstruction for physics analysis , which in practise is always a kalman filter .",
    "sometimes the track model in the alignment is simplified , ignoring multiple scattering corrections or the magnetic field .",
    "the imperfections in the track model used for alignment will partially be absorbed in calibration parameters .",
    "consequently , in order the guarantee consistency between track model and detector alignment , it is desirable to use the default track fit in the alignment procedure .",
    "the kalman filter has also been proposed for the estimation of the alignment parameters themselves  @xcite .",
    "this method for alignment is an alternative formulation of the closed - form alignment approach that is particularly attractive if the number of alignment parameter is large .",
    "our results for the global covariance matrix of the kalman filter track model and for vertex constraints can eventually be applied in such a kalman filter alignment procedure .",
    "to show that the global covariance matrix of the track parameters is an essential ingredient to the closed - form alignment approach , we briefly revisit the minimum @xmath0 formalism for alignment .",
    "consider a track @xmath0 defined as @xmath1^t \\ : v^{-1 } \\ : \\left [ \\rule{0ex}{1.7ex } m - h(x ) \\right ] ,    \\label{equ : trackchisquare}\\ ] ] where @xmath2 is a vector of measured coordinates , @xmath3 is a ( usually diagonal ) covariance matrix , @xmath4 is the measurement model and @xmath5 is the vector of track parameters .",
    "note that  eq.[equ : trackchisquare ] is a matrix expression : @xmath2 and @xmath6 are vectors and @xmath3 is a symmetric matrix , all with dimension equal to the number of measurements .    for a linear expansion of the measurement model around an initial estimate @xmath7 of the track parameters , @xmath8 where",
    "@xmath9 is sometimes called the derivative or projection matrix , the condition that the @xmath0 be minimal with respect to @xmath5 can be written as @xmath10 .",
    "\\label{equ : minchisq}\\ ] ] the solution to this system of equations is given by the well known expression for the least squares estimator @xmath11 ,    \\label{equ : lsm}\\ ] ] where the matrix @xmath12 is the covariance matrix for @xmath5 @xmath13 if the measurement model is not linear , _ i.e. _ if @xmath14 depends on @xmath5 , expression  eq.[equ : lsm ] can be applied iteratively , until a certain convergence criterion is met , for example defined by a minimum change in the @xmath0 . in that case",
    "it makes sense to write  eq.[equ : lsm ] in terms of the first and second derivative of the @xmath0 at the current estimate @xmath7 @xmath15 and regard the iterative minimization procedure as an application of the newton - raphson method .",
    "we now consider an extension of the measurement model with a set of calibration parameters @xmath16 , @xmath17 the parameters @xmath16 are considered common to all tracks in a particular calibration sample .",
    "we estimate @xmath16 by minimizing the sum of the @xmath0 values of the tracks simultaneously with respect to @xmath16 and the track parameters @xmath18 of each track @xmath19 , @xmath20 please , note that the index @xmath19 refers to the track and not to a component of the vector @xmath5 .",
    "we will omit the index from now on and consider only the @xmath0 contribution from a single track .",
    "the number of parameters in the minimization problem above scales with the number of tracks .",
    "if the number of tracks is large enough , a computation that uses an expression for the least squares estimator analogous to  eq.[equ : lsm ] is computationally too expensive .",
    "a more practical method relies on a computation in two steps .",
    "first , track parameters are estimated for an initial set of calibration parameters @xmath21 .",
    "subsequently , the total @xmath0 is minimized with respect to @xmath16 taking into account the dependence of @xmath18 on @xmath16 , _",
    "e.g. _ through the total derivative @xmath22    the derivative matrix @xmath23 in  eq.[equ : ddalphaa ] follows from the condition that the @xmath0 of the track remains minimal with respect to @xmath5 , which can be expressed as @xmath24 and results in @xmath25 note that if the problem is linear this derivative is independent of the actual value of @xmath5 or @xmath16 .",
    "consequently , in this limit this expression remains valid even if the track @xmath0 was not yet minimized with respect to @xmath5 .",
    "the condition that the total @xmath0 of a sample of tracks be minimal with respect to both track and alignment parameters can now be expressed as @xmath26 for @xmath27 alignment parameter this defines a system of @xmath27 coupled non - linear equations . in analogy with the procedure introduced for the track @xmath0 minimization above we",
    "search for a solution by linearizing the minimum @xmath0 condition around an initial value @xmath21 and solving the linear system of @xmath27 equations @xmath28 for @xmath29 . in the remainder of this section",
    "we derive the expressions for these derivatives .    to simplify the notation we define the residual vector of the track @xmath30 and its derivative to @xmath16 @xmath31 we linearize @xmath32 around the expansion point @xmath33 , and using  eq.[equ : dxdalpha ] obtain for any total derivative to @xmath16 @xmath34 ( the minus sign appears because @xmath14 is the derivative of @xmath6 and not of @xmath32 . ) in this expression we have substituted the covariance matrix for @xmath12 for @xmath5 .",
    "the first and second derivatives of the @xmath0 contribution of a single track are now given by @xmath35 @xmath36 the matrix @xmath37 that appears in these expressions is the covariance matrix for the residuals @xmath32 .",
    "this matrix is in general singular and its rank is the number of degrees of freedom of the fit .",
    "if the track parameters @xmath5 for which the residuals @xmath32 and @xmath14 are calculated , are actually those that minimize the track s @xmath0 for the current set of alignment constants @xmath21 , the residuals satisfy the least squares condition @xmath38 and the first derivative to @xmath16 reduces to @xmath39 consequently , if @xmath3 is diagonal , the derivative to a particular parameter @xmath40 only receives contributions from residuals for which @xmath41 does not vanish .",
    "is an alignment parameter of module @xmath42 , only hits in module @xmath42 contribute to the first derivative of the @xmath0 to @xmath43 . ] an important consequence of this is that if there are additional contributions to the tracks @xmath0 , in particular hits in subdetectors that we do not align for , constraints from a vertex fit or multiple scattering terms , then these terms only enter the derivative calculation through the track covariance matrix @xmath12 .",
    "we will exploit this property in the next section when we discuss the use of a kalman filter track model for alignment .",
    "the expressions  eq.[equ : firstdchisqdaminchisq ] and  eq.[equ : seconddchisqda ] can now be used to evaluate the first and second derivative for an initial calibration @xmath21 over a given track sample and inserted in  eq.[equ : globalequation ] to obtain an improved calibration .",
    "if the residuals are non - linear in either track parameters or alignment parameters , several iterations may be necessary to minimize the @xmath0 .    if the alignment is sufficiently constrained , the second derivative matrix can be inverted and the covariance matrix for the alignment parameters is given by @xmath44 ignoring higher order derivatives in @xmath16 , the change in the total @xmath0 as the result of a change @xmath29 in the alignment parameters can be written as @xmath45 consequently , the change in the total @xmath0 is equivalent to the significance of the alignment correction .",
    "the quantity @xmath46 is a useful measure for following the convergence of an alignment .",
    "in the global method for track fitting a track is modelled by a single @xmath47 parameter vector ( usually @xmath48 ) at a fixed position along the track .",
    "multiple scattering can be incorporated in this model by introducing explicit parameters for the kinks at scattering planes .",
    "the parameters that minimize the @xmath0 and the corresponding covariance matrix follow from the application of the least squares estimator  eq.[equ : lsm ] .    in the kalman filter method for track fitting  @xcite a track",
    "is modelled by a separate @xmath47 dimensional track parameter vector ( or _ state vector _ ) at each measurement ( or _ node _ ) .",
    "the state vectors are related by a _ transport _",
    "function , which follows from the equation of motion of the charged particle . in the absence of multiple scattering",
    "the state vectors are one - to - one functions of one - another and hence fully correlated . in the presence of multiple scattering the correlation is reduced by introducing so - called process noise in the propagation of the state vector between neighbouring nodes .    as we have seen in the previous section the closed - form method for alignment uses the vector of residuals @xmath32 and a corresponding covariance matrix @xmath49 .",
    "the covariance matrix for the residuals can be computed from the global covariance matrix of the track parameters .",
    "however , the correlations between the state vectors at different nodes are normally not calculated in the kalman filter : they are either not computed at all ( if the smoothing is done as a weighted average of a forward and backward filter ) or ( if the rauch - tung - striebel smoother formalism is applied ) only implicitly and only between neighbouring nodes .    to derive an expression for the covariance matrix of all parameters in the kalman filter track model we use the notation of reference  @xcite for the linear kalman filter , in particular    *",
    "@xmath50 is the state vector at node @xmath51 after accumulating the information from measurements @xmath52 ; * @xmath53 is the covariance of @xmath50 ; * @xmath54 is the state vector at node @xmath51 after processing all @xmath55 measurements .    in the following",
    "we first calculate the correlation between @xmath56 and @xmath50 , which we denote by @xmath57 . from this",
    "we proceed with the correlation matrix between @xmath58 and @xmath59 .",
    "the correlation between any two states @xmath51 and @xmath60 then follows from the observation that the correlation between these states occurs via intermediate states .    in the notation of  @xcite we have for the prediction of state @xmath51 from state @xmath61 , @xmath62 where @xmath63 is the jacobian or transport matrix .",
    "the covariance of the prediction is given by @xmath64 where @xmath65 is the process noise in the transition from state @xmath61 to @xmath51 .",
    "the full covariance matrix for the pair of states @xmath66 is then given by @xmath67 in the kalman filter track fit we now proceed by adding the information of measurement @xmath51 to obtain a new estimate for the state in procedure that is called _ filtering _ and leads to state vector @xmath68 .",
    "the remaining measurements @xmath69 are processed with prediction and filter steps in the same fashion . afterwards a procedure called _ smoothing _ can be applied to recursively propagate the information obtained through measurements @xmath69 back to node @xmath51 . the smoothed state vector at node @xmath51 is labelled by @xmath70 and its covariance by @xmath71 .",
    "to derive the expression for the covariance matrix of the smoothed states @xmath70 and @xmath58 we first present the following lemma .",
    "suppose we have two observables @xmath72 and @xmath73 with covariance matrix @xmath74 now suppose we have obtained a new estimate of @xmath75 with variance @xmath76 by adding information .",
    "we can propagate the new information to @xmath73 with a least squares estimator , which gives @xmath77 this expression also holds if @xmath72 and @xmath73 are vectors .",
    "it can be derived by minimizing the following @xmath0    @xmath78 ( where @xmath2 with variance @xmath79 is the additional information for @xmath72 ) with respect to @xmath75 and @xmath80 .",
    "substituting @xmath56 for @xmath73 , @xmath68 for @xmath72 and @xmath70 for @xmath75 in  eq.[equ : propagation ] we obtain for the correlation between the smoothed states @xmath81 where we have used the definition of the smoother gain matrix  @xcite @xmath82 for the smoothed state @xmath58 and its covariance we find @xmath83 these are the rauch - tung - striebel smoothing expressions as found in  @xcite .",
    "the gain matrix in  eq.[equ : smoothergain ] can be written in different forms , _ e.g. _ @xmath84",
    "this expression shows explicitly that @xmath85 if there is no process noise ( @xmath86 ) .",
    "therefore , as one expects , without process noise the smoothed states in the kalman filter are just related by the transport equation .",
    "once we have the calculated the off - diagonal element @xmath87 , we proceed to the next diagonal @xmath88 .",
    "the correlation between states @xmath89 and @xmath51 can be calculated by performing a simultaneous smoothing of states @xmath89 and @xmath61 : in the argument above we substitute a new vector @xmath90 for @xmath73 , rather than just the state @xmath56 .",
    "the result for the correlation @xmath88 is @xmath91 this expression can also be derived with a simpler argument : the origin of the correlation between state vectors is the transport .",
    "therefore , the correlation @xmath88 occurs only through the correlations @xmath92 and @xmath87 .",
    "following the same reasoning the next diagonal becomes @xmath93 which shows that the calculation can be performed recursively . by substituting the smoother gain matrix we can write this in the following compact form @xmath94",
    "if the gain matrices are temporarily stored , then if @xmath47 is the dimension of the state vector , the calculation of each off - diagonal element in the full covariance matrix of state vectors requires about @xmath47 multiplications and @xmath47 additions .",
    "the total number of operations by far exceeds the numerical complication of the standard kalman filter .",
    "however , we have found that for tracks traversing the entire lhcb tracking system , with a total of about 30 measurement coordinates , the computational cost for the global covariance matrix with the procedure above was smaller than that of the kalman filter track fit itself .",
    "this is because the lhcb track fit is largely dominated by integration of the inhomogeneous magnetic field and the location of intersections with detector material .",
    "now that we have calculated the full covariance matrix of all states @xmath95 , the elements of the covariance matrix @xmath49 of the residuals are simply given by @xmath96 this completes the recipe for using a kalman filter track model in the alignment of tracking detectors .",
    "we have argued below  eq.[equ : firstdchisqdaminchisq ] that the cancellation that takes place between  eq.[equ : firstdchisqda ] and  eq.[equ : firstdchisqdaminchisq ] is important when considering the kalman track fit for alignment .",
    "this can be explained as follows .",
    "if we were to use the kalman filter track model in a global @xmath0 fit , the @xmath0 would contain explicit contributions for the difference in the state vectors at neighbouring nodes , @xmath97 these contributions are equivalent to the terms that constrain scattering angles in the conventional track model for a global track fit .",
    "as they represent additional constraints to the @xmath0 , they must also appear in the matrix @xmath3 and the residual vector @xmath32 in  eq.[equ : firstdchisqda ] .",
    "it is only because of the minimum @xmath0 condition for the track parameters that their contribution in the derivatives to the alignment parameters vanishes .",
    "the expressions in  eq.[equ : propagation ] can also be used to include vertex or mass constraints in an alignment procedure .",
    "first , we propagate the track parameters to the estimated position of the vertex .",
    "we label the track parameters at that position with @xmath98 and its covariance by @xmath99 .",
    "the correlations between these track parameters and those at the position of each measurement can be computed with the procedure outlined in the previous section .    for clarity",
    "we now drop the superscript @xmath55 and replace it with a superscript @xmath100 that labels the track in the vertex : the state of track @xmath19 at the vertex is @xmath101 with covariance @xmath102 . as a result of the vertex fit ( which we can implement as the billoir - frhwirth - regler algorithm  @xcite ) we obtain the new ` constrained ' track parameters @xmath103 with covariance @xmath104 .",
    "the change in the track parameters can be propagated to the track states at each measurement using  eq.[equ : propagation ] , which gives for the state vector at node @xmath51 @xmath105 and for the covariance @xmath106 the constrained residuals for track @xmath107 then become @xmath108 and the covariance matrix @xmath49 in  eq.[equ : kalmanfullr ] can be computed using the new track state covariance @xmath109 .",
    "the vertex fit also gives us the covariance @xmath110 between any two tracks @xmath19 and @xmath107 in the vertex .",
    "this allows to compute the correlation between any two states in any two tracks as follows @xmath111 inserting this into the multi - track equivalent of  eq.[equ : kalmanfullr ] gives the full correlation matrix for the residuals on _ all _ tracks .",
    "if the number of tracks in the vertex is large , the computation of the global covariance matrix for all states on all tracks is rather cpu time consuming .",
    "therefore , in practical applications it makes sense to compute the correlation only for a subset of hits close to the vertex .",
    "this completes the ingredients for including vertex constraints in the calculation of the alignment derivatives .",
    "eventual mass constraints or other kinematic constraints are included implicitly if they are applied during the vertex fit .",
    "the lhcb tracking system consists of a silicon vertex detector ( velo ) and a spectrometer  @xcite . for the track based alignment of this system",
    "a closed - form alignment algorithm has been implemented in the lhcb software framework .",
    "this algorithm , which uses the standard lhcb kalman filter track fit , will be described in detail in a future publication  @xcite . here",
    "we briefly illustrate the effect of correlations between residuals and the applications of vertex constraints , using the alignment of the velo system as an example .",
    "the velo system consists of 21 layers of double sided silicon detectors with radial strips on one side and concentric circular strips on the other .",
    "each layer consist of two half circular disks called _",
    "modules_. the modules are mounted onto two separate support structures , the _ left _ and _ right _ velo halves .",
    "the two halves can be moved independently in the direction perpendicular to the beam ( @xmath112 ) axis in order to ensure the safety of the detectors during beam injection .",
    "the alignment of the velo system is of crucial importance to the physics performance of the lhcb experiment .",
    "for the analysis described here we have simulated deformations in the velo detector in such a way that it bows along the @xmath112-axis : we introduced a bias in the @xmath5 and @xmath113 position of each module that was approximately proportional to @xmath114 , where was the @xmath112 position of the module relative to the middle of the velo .",
    "the reason to choose this particular misalignment is that it corresponds to a correlated movement of detector elements : such deformations  sometimes called ` weak modes '  are inherently difficult to correct for with an alignment method that ignores the correlations between residuals in the track fit",
    ".    tracks from a sample of simulated minimum bias interactions were reconstructed using a ` cheated ' pattern recognition , assigning velo hits to a track based on the monte carlo truth .",
    "we required at least 8 hits per track .",
    "the tracks were fitted with the standard lhcb track fit , taking scattering corrections into account as process noise .",
    "tracks were accepted for alignment if their @xmath0 per degree of freedom was less than 20 . in a perfectly aligned detector",
    "this cut only excludes a tiny fraction of reconstructed tracks , namely those with a kink due to a hadronic interaction .",
    "primary vertices were reconstructed using the standard lhcb primary vertex finder .    to validate the implementation of the algorithm we have performed two tests .",
    "first , we have checked the calculation of the residual covariance matrix @xmath49 by comparing it to a numerical computation .",
    "a single track was refitted after changing one measurement coordinate @xmath115 by a numerically small value .",
    "the @xmath19-th row of @xmath49 follows from ( for @xmath116 ) @xmath117 where @xmath118 is the change in residual @xmath119 .",
    "( the computation of the diagonal element @xmath120 is part of the standard kalman fit procedure . )",
    "this test has shown that the numerical uncertainty in the correlations coefficients of @xmath49 is typically of order @xmath121 , which is good enough for the purpose of detector alignment .",
    "second , we have analyzed the eigenvalue spectrum of the second derivative matrix  eq.[equ : seconddchisqda ] . without an external reference system the global translations and rotations of a tracking system",
    "are unconstrained in the alignment procedure .",
    "such unconstrained degrees of freedom lead to vanishing eigenvalues in the derivative matrix and , if left untreated , result in a poorly converging alignment .",
    "( see _ e.g. _  @xcite . )",
    "unconstrained degrees of freedom can be removed with lagrange constraints or by omitting the corresponding eigenvector from the solution to the linear system in  eq.[equ : globalequation ] .",
    "however , to test the implementation of the calculations in the global alignment algorithm , the identification of the vanishing eigenvalues is a powerful tool : if the zero eigenvalues corresponding to the global movements are observed , we can be confident that the computation of both the matrix @xmath49 and the alignment derivatives @xmath122 is correct ( or at least consistently wrong ) .",
    "figure  [ fig : evhalves ] shows the eigenvalues for the alignment of the position and rotation of the two velo halves .",
    "( the eigenvalues are plotted versus an arbitrary index that increases with the size of the eigenvalue . )",
    "the total number of alignment parameters is 12 . to define",
    "the scale of the eigenvalues the derivative matrix was rescaled following the recipe in  @xcite : the numerical value of the eigenvalue is roughly equal to the number of hits contributing to the corresponding linear combination of alignment parameters .",
    "as can be seen in the figure the eigenvalue distribution splits in two : the six smaller eigenvalues correspond to the global rotation and translation , whereas the six larger eigenvalues correspond to the relative alignment of the two detector halves . note that if correlations between residuals are ignored , the linear equations  eq.[equ : globalequation ] split in independent parts for the two aligned objects and all eigenvalues are of about the same size .",
    "one may wonder why the eigenvalues corresponding to the global movements are not ` numerically ' zero , in contrast with the analysis reported in  @xcite .",
    "the reason for this is a feature of the kalman filter : in the kalman filter the state vector is seeded with a finite variance even before a single measurement is processed .",
    "the variance must be large enough to have negligible weight in the variance of the state vector after all measurements are processed , but it must be small enough to make the computation of the filter gain matrix numerically stable .",
    "the finite value of the seed variance essentially fixes the track in space .",
    "we have observed that the value of the small eigenvalues is indeed sensitive to the variance of the seed . for practical purposes",
    "the bias from the kalman filter seed is not important .        to test the alignment procedure for the misalignment scenario presented above we aligned the position of each module in @xmath5 and @xmath113 , corresponding to a total of 84 alignment parameters .",
    "we omitted the @xmath112 translation and rotations to simplify the analysis .",
    "the eigenvalue distribution , shown in figure  [ fig : evmodules ] , reveals 4 unconstrained degrees of freedom .",
    "these correspond to the global translation in @xmath5 and @xmath113 and  originating from the planar geometry of the detector  shearings in the @xmath123 and @xmath124 plane .",
    "we constrain these degrees of freedom with lagrange constraints .",
    "we report here two figures of merit that we use to judge the convergence of the alignment procedure , namely the number of selected tracks and the average @xmath0 of selected tracks , both as a function of the alignment iteration .",
    "the results are shown in figure  [ fig : convergence ] for 3 different scenarios : first , we entirely ignore correlations between residuals , which means that off - diagonal elements in the matrix @xmath49 in equation  eq.[equ : residualcovariance ] are assumed zero .",
    "second , we compute these correlations with the recipe outlined in section  [ sec : kalmancorrelation ] . finally , we also include vertex constraints with the expressions given in section  [ sec : vertexconstraints ] .",
    "as can be seen in the figure the scenario with correlations converges faster than the scenario without .",
    "furthermore , in the scenario without correlations less tracks survive the @xmath0 cut even after 5 iterations .     per track ( left ) as a function of the number of alignment iterations for 3 alignment scenarios , namely ignoring correlations between residuals , not ignoring those correlations and including vertex constraints .",
    "the dashed line represents the result for a perfectly aligned detector.,title=\"fig:\",scaledwidth=48.0% ]   per track ( left ) as a function of the number of alignment iterations for 3 alignment scenarios , namely ignoring correlations between residuals , not ignoring those correlations and including vertex constraints .",
    "the dashed line represents the result for a perfectly aligned detector.,title=\"fig:\",scaledwidth=48.0% ]    the difference in convergence behaviour is mostly because there are two kinds of tracks .",
    "though most tracks pass only through a single velo half , there is a small fraction that passes through small regions in which detectors from both halves overlap .",
    "when correlations between hit residuals are taken into account , tracks that pass through a single half do not carry any weight in determining the relative positions of the two halves , because the contribution to the @xmath0 is invariant to the global position of the detector half .",
    "therefore , the relative position of the two halves is fully sensitive to the tracks that pass through both halves . on the contrary , if correlations are ignored , every track fixes the position of any detector element in space . as a result",
    "the overlap tracks get a much smaller weight in determining the relative position and convergence becomes poor .",
    "this problem can be partially overcome by explicitly enhancing the fraction of overlap tracks in the sample , _",
    "e.g. _ by down - sampling the tracks that do not pass through the overlap regions .",
    "such a strategy is applied in the alignment of the babar vertex detector  @xcite .",
    "an important advantage of the closed - form algorithm is that it is not necessary to remove tracks with a small weight in the alignment as the algorithm inherently weights the information contained in the residuals correctly .",
    "in this paper we have presented how the most popular track fitting method , the kalman filter , can be used in a closed - form alignment procedure for tracking detectors .",
    "our contribution is summarized in expression  eq.[equ : recursivecorrelation ] which shows how the correlations between state vectors can be computed recursively by using the smoother gain matrix . we have also shown how vertex constraints can be included without refitting the tracks .",
    "using an implementation of this formalism in the lhcb software framework we have illustrated for a simple misalignment scenario of the lhcb vertex detector the importance of correlations between residuals in the track fit .",
    "a more detailed analysis of the performance of the alignment algorithm to the lhcb tracking system will be reported in due course  @xcite .",
    "the author would like to thank g.  raven for posing the question concerning correlations between residuals in the kalman filter and for his patient proof reading of this manuscript .",
    "the alignment software that was used for the analysis in section  [ sec : application ] was developed in close collaboration with j.  amoraal , a.  hicheur , m.  needham and l.  nicolas and g.  raven ,      for an overview , see v.  blobel , `` software alignment for tracking detectors '' , nucl .",
    "instrum .  meth .",
    "a * 566 * ( 2006 ) 5 .",
    "v.  blobel and c.  kleinwort , phystat02 proceedings , `` a new method for the high - precision alignment of track detectors , '' , arxiv : hep - ex/0208021 .",
    "i.  belotelov , a.  lanyov and g.  ososkov , `` data - driven alignment of the hera - b outer tracker '' , phys .",
    "nucl .  lett .",
    "* 3 * ( 2006 ) 335 . c.  kleinwort ,",
    "`` h1 alignment experience '' , proceedings of the first lhc detector alignment workshop , geneva ( 2006 )    p.  brckman , a.  hicheur and s.  j.  haywood , `` global @xmath0 approach to the alignment of the atlas silicon tracking detectors '' , atl - indet - pub-2005 - 002 ; p. brckman de renstrom , s. haywood , in : l. lyons , m.k .",
    "nel ( eds . ) , phystat05 proceedings , ic press , 2006 .",
    "a.  bocci and w.  hulsbergen , `` trt alignment for sr1 cosmics and beyond '' , atl - com - indet-2007 - 011 .",
    "g.  flucke , p.  schleper , g.  steinbruck and m.  stoye , `` a study of full scale cms tracker alignment using high momentum muons and cosmics , '' , cern - cms - note-2008 - 008 . s.  viret , c.  parkes and m.  gersabeck , `` alignment procedure of the lhcb vertex detector , '' nucl .",
    "instrum .",
    "a * 596 * ( 2008 ) 157 .",
    "r.  kalman , `` a new approach to linear filtering and prediction problems '' , journal of basic engineering , 35 ( 1960 ) .",
    "r.  fruhwirth , `` application of kalman filtering to track and vertex fitting , '' nucl .",
    "instrum .  meth .",
    "a * 262 * ( 1987 ) 444 .",
    "r. fruhwirth , t. todorov , m. winkler 2003 j. phys .",
    "g : nucl . part .",
    "29 561 ; e.  widl and r.  fruhwirth , `` a large - scale application of the kalman alignment algorithm to the cms tracker , '' j.  phys .",
    "* 119 * ( 2008 ) 032038 .",
    "p.  billoir , r.  frhwirth and m.  regler , `` track element merging strategy and vertex fitting in complex modular detectors '' , nucl .",
    "instrum .",
    "a * 241 * , 115 ( 1985 ) a.  augusto  alves _ et al . _",
    "[ lhcb collaboration ] , jinst * 3 * ( 2008 ) s08005 .",
    "j.  amoraal _ et al .",
    "_ , `` alignment of the lhcb tracking system '' , _ in preparation_."
  ],
  "abstract_text": [
    "<S> we present an expression for the covariance matrix of the set of state vectors describing a track fitted with a kalman filter . </S>",
    "<S> we demonstrate that this expression facilitates the use of a kalman filter track model in a minimum @xmath0 algorithm for the alignment of tracking detectors . </S>",
    "<S> we also show that it allows to incorporate vertex constraints in such a procedure without refitting the tracks . </S>"
  ]
}