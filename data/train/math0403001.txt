{
  "article_text": [
    "this paper derives an exact deterministic nonlinear observer to compute the continuous state of an inertial navigation system based on partial discrete measurements .",
    "the main analysis tool is nonlinear contraction theory @xcite .",
    "recent work on nonlinear observer design for mechanical systems based on nonlinear contraction theory can be found in @xcite .",
    "specifically , we consider the classical strap - down problem in inertial navigation @xcite , where angular position ( euler angles ) @xmath0 and inertial position * r * are computed from the body turn rate @xmath1 and inertial acceleration @xmath2 , measured continuously in intrinsic ( body - fixed ) coordinates , @xmath3 with @xmath4\\ ] ] and @xmath5\\ ] ] as made precise in @xcite such a system lies at the boundary between convergence and divergence , much like a triple integrator .    in this paper ,",
    "the continuous measurements of @xmath1 and @xmath2 are augmented by _",
    "discrete _ measurements of @xmath6 and @xmath7 , leading to a globally exponentially convergent nonlinear observer design .",
    "such combinations of measurements are typical in inertial navigation , whether for vehicles or robots ( see e.g. @xcite for a recent discussion ) .",
    "the human vestibular system also features a similar structure , with otolithic organs measuring linear acceleration and semi - circular canals estimating angular velocity through heavily damped angular acceleration signals , an information then combined with visual data at much slower update rate .",
    "section [ sec : general ] introduces the basic observer designs .",
    "we build simple observers to compute @xmath8 based on partial discrete measurements @xmath9 and @xmath10 . in section [ sec : extension ] we discuss extensions , such as the use of nonlinear measurements , and the effects of system disturbance and measurement disturbance @xcite .",
    "we also study the case where the inertial navigation system is expressed in quaternion form @xcite .",
    "section [ sec : simulation ] presents simulation results on a 3-dimensional system .",
    "brief concluding remarks are offered in section [ sec : conclusion ] .",
    "a very brief review of basic results in contraction theory is presented in the appendix .",
    "in this section , we construct a discrete observer for system ( [ eq : system ] ) , which consists of a hierarchy of three sub - systems , mirroring the hierarchical nature of systems physics ( [ eq : system ] ) . the observer is based on the partial - measurements of the state * x * and * r * at a series of instants @xmath11 .",
    "+   + * first * , based on the discrete measurement @xmath12 , compute * x * with the observer @xmath13 where the first equation describes a continuous update between measurements , and the second equation a discrete measurement incorporation .",
    "virtual displacements , which are systematically used in mathematical physics and optimization theory , also represent basic tools in contraction theory ( see appendix ) .",
    "computing virtual displacements in ( [ eq : observer_ep1 ] ) leads to @xmath14 based on @xcite , define @xmath15 with @xmath16 .",
    "this implies that @xmath17 + from ( [ eq : delta_x_hat ] ) , we have @xmath18 from hybrid contraction condition ( [ eq : hybrid_condition ] ) in the appendix , if @xmath19 where @xmath20 , then both @xmath21 and @xmath22 tend to zero exponentially .",
    "so @xmath23 tends to * x * exponentially .",
    "+   + * second * , based on the discrete measurement of @xmath24 , compute * v * with the observer @xmath25 from ( [ eq : observer_ep2 ] ) and the first step , we get @xmath26 since @xmath27 tends exponentially to a constant , we have @xmath28 using ( [ eq : dp_delta_v ] ) , this implies that @xmath29 , which by continuity implies that the constant which @xmath27 tends to must be zero .",
    "we thus have , exponentially , @xmath30 since by design @xmath31 is a particular solution of ( [ eq : observer_ep2 ] ) , this implies that @xmath32 tends to @xmath33 exponentially .",
    "+   + * third * , based on the discrete measurement @xmath34 , use the observer @xmath35 since we know @xmath27 tends to zero exponentially , we have @xmath36 if @xmath37 , i.e. @xmath38 where @xmath39 is the largest eigenvalue of @xmath40 .",
    "so @xmath41 tends to * r * exponentially .",
    "+ * extension 1 * : when we compute * v * and * r * , we only use the discrete - time measurement @xmath34 without @xmath42 .",
    "this allows @xmath42 and @xmath34 to be measured at different instants , with the same computation .",
    "+   + * extension 2 * : the metric can also be written @xmath43 since * a * is orthogonal .",
    "so we can simply use @xmath44 .",
    "+   + * extension 3 * : assume that in ( [ eq : observer_ep1 ] ) we replace the discrete update law by the more general @xmath45 where @xmath46 and @xmath47 commute .",
    "then @xmath48 the hybrid contraction condition ( [ eq : condition_ep1 ] ) becomes @xmath49 where @xmath50 is the largest eigenvalue of @xmath51 .",
    "note that because the generalized jacobians are zero at each step of the hierarchy , the hybrid contraction conditions simply define the _ metrics _ in which the discrete measurement incorporation steps should be contracting . as we shall see later",
    ", the flexibility offered within this constraint will allow us to trade - off model error vs measurement error , similarly in spirit to a standard kalman filter .",
    "discussions about full discrete measurements , use of a linear observer , nonlinear measurement , disturbance effects , and quaternion representation are offered in this section . an observer based on full measurement",
    "is described in section [ sec : full ] .",
    "effects of system disturbance and measurement disturbance are discussed in section [ sec : error ] .",
    "section [ sec : nonlinear ] we develop a more general discrete observer applicable to nonlinear measurements .",
    "use of quaternions is studied in section [ sec : quaternion ] .",
    "assume that _ all _ states * x * , * v * , and * r * are actually measured , at a series of discrete instants @xmath52 .",
    "then steps 1 and 3 are unchanged , but we can replace step 2 ( the estimation of @xmath33 ) by the observer @xmath53 since we know @xmath22 tends to zero exponentially , we have @xmath54 with @xmath55 , we have @xmath56 where @xmath57 is the largest eigenvalue of @xmath58",
    ". so @xmath32 tends to * v * exponentially .",
    "note that in some cases one only needs to estimate orientation @xmath6 and velocity @xmath33 , and that the discrete measurement of @xmath33 may be obtained from optical flow , which can be computationally `` expensive '' and thus infrequent .",
    "effects of bounded inputs and measurement disturbances can be quantified and obeserver gains chosen accordingly .",
    "consider input disturbance @xmath59 and measurement disturbance @xmath60 , with @xmath61 and @xmath62 , leading to the modified system @xmath63    using the basic robustness result in  @xcite , we can quantify the corresponding quadratic bounds @xmath64 on the estimation error @xmath65 where @xmath66 is the largest eigenvalue of the symmetric part of @xmath67 .",
    "define the objective function ( @xmath68 ) @xmath69 then , @xmath70 , where @xmath71 and @xmath72 .",
    "we know @xmath73 should also satisfy @xmath74 define @xmath75 as an upper bound of @xmath73 .",
    "therefore , @xmath76 where @xmath77 .",
    "finally , we obtain the minimum of @xmath78 @xmath79 where @xmath71 and @xmath72 .",
    "when different measurements are available , the above formulas can also be used to select _ a priori _ the most informative measurement .",
    "this can be the case for instance for selecting the direction of gaze of the eyes in hopping robot @xcite .",
    "this can also be the case when the measurements are `` expensive '' , for instance computationally . + * extension * : the discussions above will still work when the bounds of input disturbance and measurement disturbance are time - varying . if @xmath80 and @xmath81 when @xmath82 .",
    "similar to the above , we have @xmath83 where @xmath71 and @xmath84 .",
    "for the system @xmath85 , consider the observer @xmath86 where @xmath87 we have @xmath88    defining @xmath89 , we have @xmath90 .   using equation ( [ eq : nonlinear_delta ] ) yields @xmath91 where @xmath92 and @xmath93 .",
    "the sufficient contraction condition on hybrid systems can be written @xmath94 where @xmath95 and @xmath66 is the largest eigenvalue of the symmetric matrix @xmath96 .",
    "if condition ( [ eq : condition_gn ] ) is satisfied by an appropriate choice of @xmath97 , then @xmath98 will tend to * x * exponentially .    a a simple illustration , consider using distance measurements instead of direct cartesian position measurements . in the 3-dimensional space ,",
    "measure the distances from one point @xmath99 to four time - varying reference points @xmath100^t$ ] , @xmath101^t$ ] , @xmath102^t$ ] , and @xmath103^t$ ] , @xmath104 the discrete - update part of observer ( [ eq : nonlinear_observer ] ) can be built up as below , @xmath105",
    "= \\left [ \\begin{array}{l } \\hat{x}_{1,i}^- \\\\ \\hat{x}_{2,i}^- \\\\ \\hat{x}_{3,i}^- \\end{array } \\right ] -\\frac{1}{2 } { \\bf k}_i \\left [ \\begin{array}{l } ( \\hat{y}_{1,i}^-)^2-(\\hat{y}_{2,i}^-)^2-(y_{1,i}^2-y_{2,i}^2 ) \\\\ ( \\hat{y}_{2,i}^-)^2-(\\hat{y}_{3,i}^-)^2-(y_{2,i}^2-y_{3,i}^2 ) \\\\ ( \\hat{y}_{3,i}^-)^2-(\\hat{y}_{4,i}^-)^2-(y_{3,i}^2-y_{4,i}^2 ) \\end{array } \\right]\\ ] ] where @xmath106 is a 3 by 3 time - varying gain matrix . using equation ( [ eq : nonlinear_y ] ) yields @xmath107 @xmath108\\ ] ] where subscript @xmath109 refers to the value at time @xmath110 .",
    "+ assume @xmath111 is non - singular .",
    "then we can choose @xmath112 with equation ( [ eq : nonlinear_dvarying ] ) , we have @xmath113 by choosing @xmath114 , we can make @xmath115 satisfy the following contraction contidion that makes @xmath21 tends to zero exponentially.@xmath116 where @xmath117 and @xmath66 is the largest eigenvalue of the symmetric matrix @xmath96 .",
    "therefore , @xmath22 will tend to zero , and @xmath98 will tend to * x * exponentially .",
    "+ * remark *   when @xmath111 is singular , one has @xmath118 + equation ( [ eq : nonlinear_singular1 ] ) is equivalent to @xmath119 \\cdot   \\left| \\begin{array}{ccc } { \\bf i } & { \\bf j } & { \\bf k } \\\\   ( c_{1i}-b_{1i } ) & ( c_{2i}-b_{2i } ) & ( c_{3i}-b_{3i } ) \\\\   ( d_{1i}-c_{1i } ) & ( d_{2i}-c_{2i } ) & ( d_{3i}-c_{3i } ) \\end{array } \\right|=0\\ ] ] + which we can write @xmath120 this means that points a , b , c , and d are in the same plane , and therefore that the geometry does not contain enough information to infer position .",
    "+ to compute velocity , one can rewrite observer ( [ eq : observer_ep2 ] ) as @xmath121 - { \\bf k}_i \\left [ \\begin{array}{c } ( \\hat{y}_{1,i}^+)^2-(\\hat{y}_{2,i}^+)^2-(y_{1,i}^2-y_{2,i}^2 ) \\\\ ( \\hat{y}_{2,i}^+)^2-(\\hat{y}_{3,i}^+)^2-(y_{2,i}^2-y_{3,i}^2 ) \\\\ ( \\hat{y}_{3,i}^+)^2-(\\hat{y}_{4,i}^+)^2-(y_{3,i}^2-y_{4,i}^2 ) \\end{array } \\right ] \\ } \\end{array } \\right.\\ ] ] where @xmath122 and @xmath123^{-1 } ~~\\textrm{and}~~ { \\bf k}_{i+1}= \\left [ \\begin{array}{ccc } ( b_{1i+1}-a_{1i+1 } ) & ( b_{2i+1}-a_{2i+1 } ) & ( b_{3i+1}-a_{3i+1 } ) \\\\   ( c_{1i+1}-b_{1i+1 } ) & ( c_{2i+1}-b_{2i+1 } ) & ( c_{3i+1}-b_{3i+1 } ) \\\\   ( d_{1i+1}-c_{1i+1 } ) & ( d_{2i+1}-c_{2i+1 } ) & ( d_{3i+1}-c_{3i+1 } ) \\end{array } \\right]^{-1}\\ ] ]",
    "we then have @xmath124 which is the same as equation ( [ eq : dp_delta_v ] ) . similarly to the second step of section [ sec : general ] , this shows that @xmath125 tends to * v * exponentially .",
    "+ note that the geometry problem of going from distances to positions is solved by a dynamic system , the observer , rather than explicitly at each instant .",
    "in general , one may also use linear measurements at some instants and nonlinear ones at others .    note that",
    "if a measurement is delayed , the algorithms work similarly but the actual information is available after the delay ( i.e. the measurement is incorporated at some past time and the forward simulation runs instantly to the current time ) .",
    "consider now , extending section [ sec : error ] , the effect of model and measurement errors .",
    "for the system @xmath126 , with the following nonlinear observer , @xmath127 where@xmath128 and @xmath129 +   + so we have @xmath130 we know the quadratic bounds @xmath64 on the estimation error @xmath131 where @xmath132 , @xmath133 , and @xmath134 is the largest eigenvalue of the symmetric part of @xmath67 .",
    "+   + we can choose the most relevant discrete update function @xmath135 which will best contribute to improving the estimate @xmath98 ( i.e. , to minimize @xmath136 ) .",
    "angular position can be expressed in quaternion form , avoiding representation singularities @xcite .",
    "quaternions express a rotation of angle @xmath137 about the unit vector @xmath138 as @xmath139 . with @xmath140",
    "the quaternion vector , this leads to @xmath141 where @xmath142\\ ] ] and @xmath143\\ ] ] in this representation , the fact that the dynamics of * q * is indifferent is obvious , since @xmath144 is skew - symmetric .",
    "the observers can be derived as earlier , simply by replacing ( [ eq : observer_ep1 ] ) by @xmath145 based on the discrete measurements @xmath146 .",
    "computing virtual displacements @xmath147 and because the dynamics of * q * is indifferent , we only need @xmath148 where @xmath50 is the largest eigenvalue of @xmath149 . under condition ( [ eq :",
    "condition_qp1 ] ) , @xmath150 tends to zero exponentially , and @xmath151 tends to * q * exponentially .",
    "the other two steps are unchanged , with @xmath152 being replaced by @xmath153 .",
    "all the above variations and extensions can of course be combined .",
    "in this section , we will do a 3-dimentional simulation about system ( [ eq : system ] ) based on the discrete measurement @xmath42 and the nonlinear distance measurements @xmath154 , @xmath155 , @xmath156 , and @xmath157 , as in section [ sec : nonlinear ] .",
    "consider system ( [ eq : system ] ) in the 3-dimensional case . where @xmath158~~\\textrm{and}~~ { \\bf \\gamma}=~ \\left [ \\begin{array}{c } \\cos(2 t ) \\\\",
    "\\frac{1 + 2\\sin t}{3 } \\end{array } \\right]\\ ] ] four time - varying reference points are chosen as below ( all move on circular trajectories ) , @xmath159 @xmath160    observer ( [ eq : observer_ep1 ] ) with @xmath161 is used to compute * x*. observer ( [ eq : observer_ep2_distance ] ) with gain ( [ eq : nonlinear_gain ] ) is used to compute * v*. using observer ( [ eq : nonlinear_observer],[eq : nonlinear_od1 ] ) and gain ( [ eq : nonlinear_k_i ] ) , we choose @xmath162 to satisfy condition ( [ eq : condition_gn ] ) , thus we can compute * r*. figure [ fig : example_ep ] shows @xmath163 tends to @xmath164 exponentially .",
    "observers similar to those developed in this paper can in principle be applied to other continuous nonlinear systems besides inertial navigation systems , although much simplification was afforded by exploiting the hierarchical structure of the system physics .",
    "an animation of the basic observer as applied to head stabilization @xcite in a simulated robot hopper @xcite can also be found in _ http://web.mit.edu / nsl / www / hopping_robot.mpg_.    * acknowledgement *   this paper benefited from stimulating discussions with dr .",
    "agostino martinelli .",
    "0    aghannan , n. , rouchon , p. , an intrinsic observer for a class of lagrangian systems , _",
    "i.e.e.e . trans .",
    "control _ ,",
    "* 48(6 ) * ( 2003 ) .",
    "berthoz , a. , the brain s sense of movement , _ harvard university press , cambridge , massachusetts _ ( 2000 ) .",
    "egeland , o. , kristiansen , e. , and nguyen , t.d . , observers for euler - bernoulli beam with hydraulic drive , _",
    "i.e.e.e . conf .",
    "( 2001 ) .",
    "goldstein , h. , classical mechanics , _ addison - wesley _ ( 1980 ) .",
    "grassia , f.s . , practical parameterization of rotations using the exponential map , _ the journal of graphics tools _ , vol . 3.3",
    "( 1998 ) .",
    "hestenes , d. , new foundations for classical mechanics , _ kulwer academic publishers , dordrecht , the netherlands _ ( 1986 ) .",
    "jouffroy , j. , and j. opderbecke , underwater vehicle trajectory estimation using contracting pde - based observers , _ american control conference , boston , massachusetts _ ( 2004 ) .",
    "kristiansen , d. , and egeland , o. , time and spatial discretization methods that preserve passivity properties for systems described by partial differantial equations , _ in proceedings of the 2000 american control conference , chiago , illinois _ ( 2000 )    lohmiller , w. , and slotine , j.j.e .",
    ", on contraction analysis for nonlinear systems , _ automatica _ , * 34(6 ) * ( 1998 ) .",
    "lohmiller , w. , contraction analysis of nonlinear systems , _ ph.d .",
    "thesis , department of mechanical engineering , mit _ ( 1999 ) .",
    "lohmiller , w. , and slotine j.j.e . , nonlinear process control using contraction theory , _ a.i.ch.e",
    ". journal _ ( 2000 ) .",
    "lohmiller , w. , and slotine j.j.e . , control system design for mechanical systems using contraction theory , _",
    "i.e.e.e . trans .",
    "control _ ,",
    "* 45(5 ) * ( 2000 ) .",
    "slotine , j.j.e . , and li , w. , applied nonlinear control , _ prentice - hall _ ( 1991 ) .",
    "slotine , j.j.e . , and lohmiller , w. , modularity , evolution , and the binding problem : a view from stability theory , _ neural networks _ , * 14(2 ) * ( 2001 ) .",
    "raibert , m.h .",
    ", legged robots that balance , _ the m.i.t . press , cambridge , massachusetts _ ( 1986 ) .",
    "ryu , j. , rossetter e.j . , and gerdes , j.c . , vehicle sideslip and roll parameter estimation using gps . _",
    "the proceedings of avec 2002 , hiroshima , japan _ ( 2002 ) .",
    "varshalovich , d.a . ,",
    "moskalev , a.n . , and khersonskii , v.k . ,",
    "description of rotation in terms of the euler angles , _ singapore : world scientific _ ( 1988 ) .",
    "the main theorem of contraction analysis  @xcite can be stated as            is uniformly negative definite , then all system trajectories then converge exponentially to a single trajectory , with convergence rate @xmath169 , where @xmath170 is the largest eigenvalue of the symmetric part of @xmath171 .",
    "the system is said to be contracting .",
    "[ th : theoremf ]    it can be shown conversely that the existence of a uniformly positive definite metric with respect to which the system is contracting is also a necessary condition for global exponential convergence of trajectories . in the linear time - invariant case , a system is globally contracting if and only if it is strictly stable , with @xmath171 simply being a normal jordan form of the system and @xmath172 the coordinate transformation to that form . furthermore , since      where is @xmath174 the symmetric part of @xmath171 , all transformations @xmath175 corresponding to the same @xmath176 lead to the same eigenvalues for @xmath177 , and therefore to the same contraction rate @xmath169 .",
    "consider now a hybrid case @xcite , consisting of a continuous system @xmath178 which is switched to a discrete system @xmath179 every @xmath180 for one discrete step .",
    "letting , in the _ same coordinate system @xmath172 _",
    ", @xmath66 be the largest eigenvalue of the symmetric matrix @xmath96 , and @xmath181 be the largest eigenvalue of @xmath182 ( the corresponding discrete - time quantity , where @xmath183 , see  @xcite ) , a sufficient condition for the overall system to be contracting is @xmath184    contraction theory proofs and this paper make extensive use of _ virtual displacements _ , which are differential displacements at fixed time borrowed from mathematical physics and optimization theory .",
    "formally , if we view the position of the system at time @xmath185 as a smooth function of the initial condition @xmath186 and of time , @xmath187 , then @xmath188 ."
  ],
  "abstract_text": [
    "<S> we derive an exact deterministic nonlinear observer to compute the continuous state of an inertial navigation system based on partial discrete measurements , the so - called strapdown problem . </S>",
    "<S> nonlinear contraction is used as the main analysis tool , and the hierarchical structure of the system physics is sytematically exploited . </S>",
    "<S> the paper also discusses the use of nonlinear measurements , such as distances to time - varying reference points . </S>"
  ]
}