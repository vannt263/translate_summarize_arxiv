{
  "article_text": [
    "in recent years single photon states of light and superpositions of coherent states have become increasingly important due to applications in quantum technology , in particular , quantum computing and quantum information systems , @xcite , @xcite , @xcite , @xcite , @xcite .",
    "for instance , the light may interact with a system , say an atom , quantum dot , or cavity , and this system may be used as a quantum memory , @xcite , or to control the pulse shape of the single photon state @xcite . when light interacts with a quantum system , information about the system is contained in the scattered light .",
    "this information may be useful for monitoring the behavior of the system , or for controlling it .",
    "the topic of this paper concerns the extraction of information from the scattered light when the incoming light is placed in a single photon state @xmath0 , or a superposition of coherent states @xmath1 , as illustrated in figure [ fig : filter - one-1 ] .",
    "coupled to a field in a state @xmath2 ( single photon or superposition of coherent states ) .",
    "the output field is continuously monitored by homodyne detection ( assumed perfect ) to produce a classical measurement signal @xmath3 .",
    "the output @xmath3 is filtered to produce estimates @xmath4 of system operators",
    "@xmath5 at time @xmath6 . ]",
    "the problem of extracting information from continuous measurement of the scattered light is a problem of _ quantum filtering _ , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite .",
    "the current state of the art for quantum filtering considers incoming light in a vacuum or other gaussian state , with quadrature or counting measurements .",
    "both single photon states of light , and superpositions of coherent states of light , are highly non - classical , and are fundamentally different from gaussian states . in view of the increasing importance of these non - gaussian states of light ,",
    "the purpose of this paper is to solve a quantum filtering problem for systems driven by fields in single photon states and superpositions of coherent states .    in the case of single photon fields ,",
    "the master equation describing unconditional dynamics was shown to be a system of coupled equations in @xcite , a feature of non - markovian character .",
    "markovian embeddings were used in @xcite to derive quantum trajectory equations ( quantum filtering equations ) for a class of non - markovian master equations . in recent work ,",
    "the authors have shown how to construct ancilla systems to combine with the system of interest to form a markovian extended system driven by vacuum from which quantum filtering results may be obtained for single photon states and superpositions of coherent states from the standard filter for the extended system , @xcite , @xcite . however , depending on the complexity of the non - classical state , it may possibly be difficult to determine suitable ancilla systems , and indeed the superposition case was not straightforward .",
    "in this paper we present an alternative approach to the embedding that also allows for the derivation of the quantum filter .",
    "the extended system forms a non - markovian system , with the ancilla , system and field initialized in a superposition state .",
    "while standard filtering results do not apply , the quantum stochastic methods can nevertheless be applied to determine the quantum filters . in this way",
    ", we expand the range of methods that may be applied to derive quantum filters for non - classical states .",
    "the paper is organized as follows . in section [ sec : problem ] the idealized filtering problem to be solved in this paper is formulated .",
    "the continuous mode single photon states are defined in section [ sec : photon - state ] .",
    "the master equation for the single photon field state is derived in section [ sec : master ] using the model presented in section [ sec : problem ] .",
    "this leads naturally to section [ sec : the - matrix ] , where the system is embedded in a larger model , inspired by the approach used in @xcite but differing in the details .",
    "this extended system provides a compact and transparent description of the problem , and may readily be generalized to @xmath7-photon states , and indeed , multiple channels of @xmath7-photon states .",
    "the quantum filter for the extended system is presented in section [ sec : matrix - filter ] , with a derivation extending the reference method appearing in section [ sec : extended - filter ] .",
    "the filtering results for the extended system are used to find the filtering equations for the original problem involving a single photon field in section [ sec : single - photon - filter ] .",
    "the superposition of coherent field states is defined in section [ sec : cat - super ] , and a suitable embedded system for this case is described in section [ sec : cat - embed ] .",
    "the corresponding master and filtering equations are presented in sections [ sec : cat - master ] and [ sec : cat - super - filter ] , respectively .",
    "some concluding remarks are made in section [ sec : conclusion ] .    in this paper we are not concerned with technical issues concerning domains of unbounded operators and related matters , and indeed , we assume that the system operators are bounded , and that all quantum stochastic integrals are well - defined in the sense of hudson - parthasarathy , @xcite .    _",
    "notation : _ we use the standard dirac notation @xmath8 to denote state vectors ( vectors in a hilbert space ) @xcite , @xcite .",
    "the superscript @xmath9 indicates hilbert space adjoint or complex conjugate .",
    "the inner product of state vectors @xmath10 and @xmath11 is denoted @xmath12 .",
    "the expected value of an operator @xmath5 when the system is in state @xmath8 is denoted @xmath13 = \\langle \\psi \\vert x \\vert \\psi \\rangle$ ] . for operators",
    "@xmath14 and @xmath15 we write @xmath16 .",
    "we consider a quantum system @xmath17 coupled to a quantum field @xmath15 , as shown in figure [ fig : filter - one-1 ] . the field @xmath15 has two components , the input field @xmath18 and the output field , @xmath19 . in this paper",
    "we consider two non - classical cases for the state @xmath20 of the input field ( i ) a single photon state @xmath0 , where @xmath21 is a complex valued function such that @xmath22 ( representing the wave packet shape ) , or ( ii ) a superposition of coherent states @xmath23 , where @xmath24 are coherent states and the complex numbers @xmath25 ( @xmath26 ) are normalized weights .",
    "as illustrated in figure [ fig : filter - one-1 ] , the field interacts with the quantum system @xmath17 , and the results of this interaction provide information about the system that may be obtained through continuous measurement of an observable @xmath3 of the output field @xmath27 .",
    "the filtering problem of interest in this paper is to determine the conditional state from which estimates @xmath28 of system operators @xmath5 may be determined at time @xmath6 based on knowledge of the observables @xmath29 , @xmath30 .    in what follows the system @xmath17 is assumed to be defined on a hilbert space @xmath31 , with an initial state denoted @xmath32 .",
    "the input field @xmath18 is described in terms of annihilation @xmath33 and creation @xmath34 operators defined on a fock space @xmath35 , ( * ? ? ?",
    "* chapter ii ) , ( * ? ? ?",
    "* section 4 ) .",
    "quantum expectation will be denoted by the symbol @xmath36 , and when we wish to display the underlying state , we employ subscripts ; for example , @xmath37 denotes quantum expectation with respect to the state @xmath38 .",
    "the dynamics of the system will be described using the quantum stochastic calculus , @xcite , @xcite , @xcite , @xcite , @xcite .",
    "quantum stochastic integrals are defined in terms of fundamental field operators @xmath39 , @xmath40 and @xmath41 , ( * ? ? ?",
    "* chapter ii ) , ( * ? ? ?",
    "* section 4 ) . that satisfy singular commutation relations @xmath42=\\delta(t - s)$ ] , the fundamental field operators are given by @xmath43 , @xmath44 , and @xmath45 . also , we may write @xmath46 . ]",
    "the non - zero ito products for the field operators are @xmath47    the dynamics of the composite system is described by a unitary @xmath48 solving the schrdinger equation , or quantum stochastic differential equation ( qsde ) , @xmath49 with initial condition @xmath50 . here",
    ", @xmath51 is a fixed self - adjoint operator representing the free hamiltonian of the system , and @xmath52 and @xmath17 are system operators determining the coupling of the system to the field , with @xmath17 unitary . in this paper , for simplicity we assume that the parameters @xmath53 are bounded operators on the system hilbert space @xmath31 .",
    "however , we remark under some suitable additional conditions the results and equations obtained in this paper should also be extendable to some special classes of qsdes with unbounded parameters , exploiting the results in @xcite .",
    "a system operator @xmath5 at time @xmath6 is given in the heisenberg picture by @xmath54 and it follows from the quantum ito calculus that @xmath55 ) db(t ) ^{\\ast }    \\notag \\\\ & &   + j_{t}([l^{\\ast } , x]s ) db ( t ) + j_{t}(\\mathcal{l}(x ) ) dt , \\label{eq : x - dyn}\\end{aligned}\\ ] ] where @xmath56+\\frac{1}{2}[l^{\\ast } , x]l - i [ x , h ] .\\ ] ] the map @xmath57 is known as the _ lindblad generator _ , while the quartet of maps @xmath58 , \\ , [ l^\\ast , x ] s$ ] are known as _ evans - hudson maps_.    the output field is defined by @xmath59 . is the input field .",
    "] in this paper we consider the output field observable @xmath3 defined by @xmath60 where @xmath61 is a quadrature observable of the input field ( the counting case @xmath62 is discussed briefly in section [ sec : conclusion ] ) .",
    "note that both @xmath63 and @xmath3 are self - adjoint and self - commutative : @xmath64=0 $ ] and @xmath65=0 $ ] .",
    "we write @xmath66 and @xmath67 for the subspaces of commuting operators generated by the observables @xmath68 , @xmath69 , @xmath70 , respectively . and",
    "@xmath67 are commutative von neumann algebras .",
    "they are also filtrations , e.g. @xmath71 whenever @xmath72 . ]",
    "they are related by the unitary rotation @xmath73 .",
    "physically , @xmath3 may represent the integrated photocurrent arising in an idealized ( perfect ) homodyne photodetection scheme , as in figure [ fig : filter - one-1 ] .",
    "for further information on homodyne detection , we refer the reader to the literature ; for example , @xcite , @xcite , @xcite .",
    "the primary goal of this paper is to determine the _ quantum filter _ for the quantum conditional expectation ( see , e.g. ( * ? ? ?",
    "* definition 3.13 ) ) @xmath74 .",
    "\\label{eq : cond - exp}\\ ] ] this conditional expectation is well defined , since @xmath75 commutes with the subspace @xmath76 ( non - demolition condition ) .",
    "the conditional estimate @xmath28 is affiliated to @xmath67 ( written in abbreviated fashion as @xmath77 ) and is characterized by the requirement that @xmath78 = \\mathbb{e}_{\\eta\\psi } [ x(t ) k ] \\label{eq : c - exp - def}\\ ] ] for all @xmath79 .",
    "in this section we consider the continuous - mode single photon state @xmath0 defined by @xcite , ( * ? ? ?",
    "( 9 ) ) @xmath80 where @xmath21 is a complex valued function such that @xmath22 , and @xmath81 is the vacuum state of the field",
    ". expression ( [ eq : xi - create ] ) says that the single photon wavepacket with temporal shape @xmath21 is created from the vacuum using the field operator @xmath34 .",
    "the hilbert space for the composite system is @xmath82 } \\otimes \\mathfrak{f}_{(t},\\ ] ] where here we have exhibited the continuous temporal tensor product decomposition of the fock space @xmath83 } \\otimes \\mathfrak{f}_{(t}$ ] into past and future components , which is of basic importance in what follows .",
    "write @xmath84 = \\langle \\eta 1_\\xi \\vert   ( x \\otimes f ) \\vert \\eta 1_\\xi \\rangle = \\langle \\eta   \\vert x \\vert \\eta \\rangle \\langle 1_\\xi \\vert   f   \\vert 1_\\xi \\rangle\\ ] ] for the expectation with respect to the product state @xmath85 , where the field is in the single photon state .",
    "here and in what follows @xmath5 is a bounded system operator acting on @xmath31 , and @xmath86 is a field operator acting on the fock space @xmath35 .",
    "similarly , we may define the expectation when the field is in the vacuum state , @xmath87 = \\langle   \\eta 0 \\vert   ( x \\otimes f ) \\vert \\eta 0   \\rangle = \\langle \\eta \\vert x \\vert \\eta \\rangle \\langle 0 \\vert   f \\vert 0   \\rangle .\\ ] ] we will also have need for the cross - expectations @xmath88 = \\langle \\eta 1_\\xi \\vert   ( x \\otimes f )   \\vert \\eta 0 \\rangle , \\",
    "\\text{and } \\",
    "\\mathbb{e}_{01 } [ x \\otimes f ] = \\langle \\eta 0   \\vert ( x \\otimes f ) \\vert   \\eta 1_\\xi \\rangle.\\end{aligned}\\ ] ]    a crucial difference between the single photon state and the vacuum state is that the later state factorizes @xmath89 } \\rangle \\otimes \\vert 0_{(t } \\rangle $ ] with respect to the temporal factorization @xmath83 } \\otimes \\mathfrak{f}_{(t}$ ] of the fock space , with @xmath90 } \\rangle \\in \\mathfrak{f}_{t ] } $ ] and @xmath91 , while the former does not .",
    "rather , we have @xmath92 } \\rangle \\otimes \\vert 0_{(t } \\rangle + \\vert 0_{t ] } \\rangle \\otimes \\vert { 1_\\xi}_{(t } \\rangle ,   \\label{eq : factor - additive-1}\\ ] ] where @xmath93 } \\rangle = b^{-\\ast}_t(\\xi ) \\vert 0_{t ] } \\rangle , \\ \\text{and } \\ \\vert { 1_\\xi}_{(t } \\rangle = b^{+\\ast}_t(\\xi ) \\vert 0_{(t } \\rangle , \\ ] ] and @xmath94 } ) , \\ \\",
    "b^+_t(\\xi ) = b(\\xi \\chi_{(t,\\infty ] } ) , \\ \\",
    "b(\\xi ) = b^-_t(\\xi ) + b^+_t(\\xi ) .",
    "\\label{eq : b - xi - decomp-1}\\ ] ] here , @xmath95}$ ] is the indicator function for the time interval @xmath96 $ ] .",
    "note that while @xmath97 has unit norm , we have @xmath98 } \\rangle \\parallel^2 = \\int_0^t \\vert \\xi(s ) \\vert^2 ds , \\",
    "\\text{and } \\",
    "\\parallel \\vert { 1_\\xi}_{(t } \\rangle \\parallel^2 = \\int_t^\\infty \\vert \\xi(s ) \\vert^2 ds .\\ ] ]    a consequence of the additive decomposition ( [ eq : factor - additive-1 ] ) and the definitions ( [ eq : b - xi - decomp-1 ] ) is the following .",
    "let @xmath99 be a bounded operator acting on the full hilbert space @xmath100 that is adapted , i.e. @xmath99 acts trivially on @xmath101 , the field in the future .",
    "then the expectation with respect to the single photon field may be expressed in terms of the vacuum state as follows : @xmath102 & = & \\mathbb{e}_{00 } [ b^-_t(\\xi ) k(t ) b^{-\\ast}_t(\\xi ) + r(t ) k(t ) ]    \\label{eq : xi - phi}\\end{aligned}\\ ] ] where @xmath103 .      before deriving the quantum filter , we work out dynamical equations for the unconditioned single photon expectation , @xcite . to assist us in evaluating this expectation ,",
    "we make use of the following lemma .    [ lemma : expectation - basic ] let @xmath99 be a bounded quantum stochastic process defined by @xmath104 where",
    "@xmath105 , @xmath106 and @xmath107 are bounded and adapted .",
    "then we have @xmath108 & = & \\mathbb{e}_{11 } [ \\int_0^t m_0(s ) ds ] + \\mathbb{e}_{10 } [ \\int_0^t m_- ( s ) \\xi(s ) ds ]   \\notag \\\\ & & + \\mathbb{e}_{01 } [ \\int_0^t m_+(s ) \\xi^\\ast(s ) ds ] + \\mathbb{e}_{00 } [ \\int_0^t m_1 ( s ) \\vert \\xi(s ) \\vert^2 ds ] ,   \\label{eq : kt-11 } \\\\",
    "\\mathbb{e}_{10 } [ k(t ) ] & = & \\mathbb{e}_{10 } [ \\int_0^t m_0(s ) ds ] + \\mathbb{e}_{00 } [ \\int_0^t m_+ ( s ) \\xi^\\ast(s ) ds ] ,   \\label{eq : kt-10 } \\\\",
    "\\mathbb{e}_{01 } [ k(t ) ] & = & \\mathbb{e}_{01 } [ \\int_0^t m_0(s ) ds ] + \\mathbb{e}_{00 } [ \\int_0^t m_- ( s ) \\xi(s ) ds ] ,   \\label{eq : kt-01 } \\\\",
    "\\mathbb{e}_{00 } [ k(t ) ] & = & \\mathbb{e}_{00 } [ \\int_0^t m_0(s ) ds ] .",
    "\\label{eq : kt-00}\\end{aligned}\\ ] ]    using ( [ eq : xi - phi ] ) , the expressions @xmath109 , @xmath110 , and the ito rule we have @xmath111 & = & \\mathbb{e}_{00 } [ d ( b^-_t ( \\xi ) k(t ) b^{-\\ast}_t ( \\xi ) + r(t ) k(t ) ) ]   \\notag \\\\ & = & \\mathbb{e}_{00 } [ b^-_t ( \\xi ) m_0(t ) b^{-\\ast}_t ( \\xi ) + r(t )",
    "m_0(t ) \\notag \\\\ & & + m_+(t ) b^{-\\ast}_t(\\xi ) \\xi^\\ast(t ) + b^-_t ( \\xi )",
    "m_-(t ) \\xi(t ) + m_1(t ) |\\xi(t)|^2 ] dt \\notag \\\\ & = & \\mathbb{e}_{11 } [ m_0(t ) ] dt + \\mathbb{e}_{00 } [ m_+(t ) b^{\\ast } ( \\xi ) \\xi^\\ast(t ) + b(\\xi ) m_-(t ) \\xi(t ) + m_1 |\\xi(t)|^2 ] dt .\\end{aligned}\\ ] ] this last line is justified since @xmath106 are adapted and @xmath112 = 0 $ ] .",
    "that is , @xmath113 = \\mathbb{e}_{11 } [ m_0(t ) ] dt + \\mathbb{e}_{01 } [ m_+(t ) ] \\xi^\\ast(t ) dt + \\mathbb{e}_{10 } [ m_-(t ) ] \\xi(t ) dt +   \\mathbb{e}_{00 } [ \\int_0^t m_1 ( s ) \\vert \\xi(s ) \\vert^2 ds ] .\\ ] ] this proves ( [ eq : kt-11 ] ) .",
    "the remaining expressions are proven in a similar manner .",
    "@xmath114    we will first express the master equation in heisenberg form using the expectations @xmath115.\\ ] ] note that for all @xmath116 we have @xmath117    [ thm : master ] the master equation in heisenberg form for the system when the field is in the single photon state @xmath97 is given by the system of equations @xmath118 ) \\xi^\\ast(t ) + \\mu^{10}_t ( [ l^\\ast , x ] s ) \\xi(t )   \\notag \\\\ & & + \\mu^{00}_t ( s^\\ast x s - s ) \\vert \\xi(t ) \\vert^2 , \\label{eq : rho - dyn - a-11 } \\\\ \\dot{\\mu}^{10}_t ( x ) & = & \\mu^{10}_t(\\mathcal{l}(x ) ) + \\mu^{00}_t ( s^\\ast [ x , l ] ) \\xi^\\ast(t ) ,   \\label{eq : rho - dyn - a-10 } \\\\ \\dot{\\mu}^{01}_t ( x ) & = & \\mu^{01}_t(\\mathcal{l}(x ) ) + \\mu^{00}_t ( [ l^\\ast , x ] s ) \\xi(t ) ,   \\label{eq : rho - dyn - a-01 } \\\\",
    "\\dot{\\mu}^{00}_t ( x ) & = & \\mu^{00}_t(\\mathcal{l}(x ) ) .",
    "\\label{eq : rho - dyn - a-00}\\end{aligned}\\ ] ] the initial conditions are @xmath119    equations ( [ eq : rho - dyn - a-11])- ( [ eq : rho - dyn - a-00 ] ) are obtained by applying lemma [ lemma : expectation - basic ] to the heisenberg equation ( [ eq : x - dyn ] ) .",
    "@xmath114    it is apparent from theorem [ thm : master ] that the single photon expectation @xmath120 $ ] can not be determined by a single differential equation , and that instead a system of coupled equations is required , equation ( [ eq : rho - dyn - a-11])-([eq : rho - dyn - a-00 ] ) .",
    "note that the unitary matrix @xmath17 appearing in the schrdinger equation ( [ eq : unitary ] ) does appear in the single photon master equations ( [ eq : rho - dyn - a-11])-([eq : rho - dyn - a-00 ] ) , in contrast to the vacuum case ( which corresponds to ( [ eq : rho - dyn - a-00 ] ) ) .",
    "in this section we construct a suitable embedding for the system and single photon field , and show how the system of master equations from section [ sec : master ] can be compactly represented as a single equation for a larger system .",
    "this embedding will be used in subsequent sections to derive the quantum filter .",
    "we should emphasize , however , that our embedding is not the same as that used in @xcite , @xcite , @xcite .",
    "the embedding is illustrated in figure [ fig : extend-1 ] .",
    "defined in equation ( [ eq : super ] ) . ]",
    "recall that the system and field are defined on a hilbert space @xmath121 .",
    "we define an extended space @xmath122 which includes the system , field and an ancilla two - level system .",
    "let @xmath123 and @xmath124 be an orthonormal basis for @xmath125 , @xmath126 , \\ \\",
    "\\vert e_1 \\rangle   = \\left [ \\begin{array}{c } 1 \\\\ 0 \\end{array } \\right],\\ ] ] and",
    "let @xmath14 be an operator acting on @xmath125 , i.e. a complex @xmath127 matrix @xmath128.\\ ] ] it may be helpful to think of operators @xmath129 on the extended space @xmath130 represented in the kronecker product form @xmath131.\\ ] ]    we allow the extended system to evolve unitarily according to @xmath132 , where @xmath48 is the unitary operator for the system and field , given by the schrdinger equation ( [ eq : unitary ] ) .",
    "note in particular that the system is not coupled to the ancilla @xmath125 , and observables of this two - level system are static .",
    "we initialize the extended system in the superposition state @xmath133 where @xmath134 .",
    "this state evolves according to @xmath135 for notational convenience we write @xmath136 and note that @xmath137 is a density matrix for @xmath138 .",
    "the expectation with respect to the superposition state @xmath139 is given by @xmath140 = \\langle \\sigma \\vert ( a \\otimes x(t ) ) \\vert \\sigma \\rangle = \\sum_{jk } w_{jk } a_{jk } \\mu^{jk}_t(x ) .",
    "\\label{eq : master - mu - rep1}\\ ] ] this expectation is correctly normalized , @xmath141 , and the expectations @xmath142 defined in section [ sec : master ] are scaled components of @xmath143 : @xmath144 for @xmath145 , otherwise it can be set to , say , 0 .",
    "we also have @xmath146    note that in the extended space the schrdinger and heisenberg pictures are related by @xmath147 = \\mathbb{e}_{\\sigma } [ a \\otimes u^\\ast(t ) ( x \\otimes f ) u(t ) ] .\\ ] ]    in order to derive the equation for expectations in the extended system , we need the following lemma , which follows from lemma [ lemma : expectation - basic ] , and makes use of the matrices @xmath148 , \\ \\",
    "\\sigma_- =   \\vert e_0 \\rangle \\langle e_1 \\vert   = \\left [ \\begin{array}{cc } 0 & 0 \\\\ 1 & 0 \\end{array } \\right].\\ ] ]    [ lemma : expectation - basic - extended ] assume @xmath149 , and let @xmath150 be bounded and adapted .",
    "then @xmath151 & = & \\nu \\mathbb{e}_\\sigma [ \\int_0^t ( a \\sigma_+)\\otimes m(s ) \\xi(s ) ds ] , \\\\ \\mathbb{e}_\\sigma",
    "[ \\int_0^t a \\otimes m ( s ) db^\\ast(s ) ] & = & \\nu^\\ast \\mathbb{e}_\\sigma [ \\int_0^t ( \\sigma_-a ) \\otimes m(s ) \\xi^\\ast(s ) ds ] , \\\\ \\mathbb{e}_\\sigma",
    "[ \\int_0^t a \\otimes m(s ) d\\lambda(s ) ] & = & \\vert \\nu \\vert^2 \\mathbb{e}_\\sigma [ \\int_0^t ( \\sigma_- a \\sigma_+ ) \\otimes m(s ) \\vert \\xi(s ) \\vert^2 ds ] , \\end{aligned}\\ ] ] where @xmath152    in lemma [ lemma : expectation - basic - extended ] , expectations of stochastic integrals with respect to the superposition state @xmath139 are expressed in terms of expectations of non - stochastic integrals again with respect to @xmath139 with the aid of the matrices @xmath153 acting on the ancilla system @xmath125 .",
    "the action of the field annihilation , creation and gauge operators is therefore captured algebraically and all expectations in these relations are with respect to the same state .",
    "we now have    [ thm : master - matrix ] assume @xmath149 .",
    "then the expectation @xmath154 ( defined by ( [ eq : master - mu - rep1 ] ) ) evolves according to @xmath155 where @xmath156 s \\nu \\xi(t ) + ( \\sigma_- a ) \\otimes s^\\ast [ x , l ] \\nu^\\ast \\xi^\\ast(t )   \\notag \\\\ & & + ( \\sigma_- a \\sigma_+ ) \\otimes ( s^\\ast x s - x ) ) \\vert \\nu \\xi(t ) \\vert^2.\\end{aligned}\\ ] ]    the reader may easily verify that the system of master equations ( [ eq : rho - dyn - a-11])-([eq : rho - dyn - a-00 ] ) for @xmath142 , @xmath157 , follows from equation ( [ eq : matrix - master ] ) by setting @xmath158 .",
    "the extended system provides a convenient framework for quantum filtering , since all expectations can be expressed in terms of the superposition state @xmath139 .",
    "our immediate goal in this section is to determine the equation for the quantum conditional expectation @xmath159 , \\label{eq : matrix - c - exp - def}\\ ] ] and in section [ sec : single - photon - filter ] we will explain how the quantum filter for the single photon field may be obtained from this equation .",
    "the continuously monitored field observable that corresponds to the conditional expectation ( [ eq : matrix - c - exp - def ] ) is @xmath160 , and from ( [ eq : y - out ] ) we have the corresponding output equation for the extended system : @xmath161 in what follows we will make use of the following lemma concerning expectations of the process @xmath162 with respect to the single photon state .",
    "[ lemma : z - compensated - mtg ] for any @xmath163 , we have @xmath164 & = & \\mathbb{e}_{10 } [ \\int_s^t s(r ) \\xi(r)dr k ] + \\mathbb{e}_{01 } [ \\int_s^t s^\\ast(r ) \\xi^\\ast(r)dr k ] .",
    "\\label{eq : v - compensated } \\end{aligned}\\ ] ]    equation ( [ eq : v - compensated ] ) is obtained using the additive decomposition ( [ eq : factor - additive-1 ] ) and lemma [ lemma : expectation - basic ] .",
    "@xmath114    note that an operator @xmath165 in the unital commutative algebra @xmath166 has the form @xmath167 , where @xmath168 . by the spectral theorem , ( * ? ? ?",
    "* theorem 3.3 ) , we may identify @xmath165 and @xmath169 , both of which are equivalent to a classical stochastic process @xmath170 , @xmath171 . in the remainder of this paper",
    ", we use these identifications without further comment .",
    "the quantum conditional expectation @xmath172 is well defined because @xmath173 is in the commutant @xmath174 of the algebra @xmath166 , and is characterized by the requirement that @xmath175 = \\mathbb{e}_{\\sigma } [ ( a \\otimes x(t ) ) ( i \\otimes k ) ]   \\label{eq : c - exp - def - matrix}\\ ] ] for all @xmath79 , see , e.g. ( * ? ? ?",
    "* definition 3.13 ) .",
    "[ thm : matrix - filter ] assume @xmath176 .",
    "the conditional expectation @xmath177 defined by ( [ eq : matrix - c - exp - def ] ) for the extended system satisfies @xmath178 where @xmath179 and @xmath180 the process @xmath181 defined by ( [ eq : innovation - matrix ] ) is a @xmath166 wiener process with respect to @xmath139 and is called the _",
    "innovations process_.    we follow the characteristic function method @xcite , @xcite , @xcite , whereby we postulate that the filter has the form @xmath182 where @xmath183 and @xmath184 are to be determined .",
    "let @xmath185 be square integrable , and define a process @xmath186 by @xmath187 then @xmath188 is adapted to @xmath166 , and the defining relation ( [ eq : c - exp - def - matrix ] ) implies that @xmath189 = \\mathbb{e}_\\sigma [ \\tilde \\pi_t ( a \\otimes x ) i \\otimes c_f(t ) ) ] \\ ] ] holds for all @xmath185 . by calculating the differentials of both sides , taking expectations and conditioning",
    "we obtain @xmath190 & = & \\mathbb{e}_\\sigma [ ( i \\otimes c_f(t ) ) \\tilde \\pi_t ( \\mathcal{g}(a \\otimes x ) ) \\\\ & & + ( i \\otimes f(t ) c_f(t ) ) \\{\\tilde   \\pi_t ( a \\otimes ( xl+l^\\ast x ) )   \\notag \\\\ & & + \\tilde \\pi_t ( a \\sigma_+ \\otimes xs ) \\nu \\xi(t ) + \\tilde \\pi_t ( \\sigma_-a \\otimes s^\\ast x ) \\nu^\\ast \\xi^\\ast(t ) \\ } ] dt   \\notag\\end{aligned}\\ ] ] and @xmath191   \\\\   & = & \\mathbb{e}_\\sigma [ ( i \\otimes c_f(t ) \\ { \\mathcal{f}_t(a\\otimes x ) + \\mathcal{h}_t(a\\otimes x ) \\tilde \\pi_t ( i \\otimes ( l+l^\\ast))\\nonumber   \\\\ & & + \\mathcal{h}_t(a\\otimes x ) \\pi_t ( ( \\sigma_+ \\otimes s ) \\nu \\xi(t ) + ( \\sigma_- \\otimes s^\\ast ) \\nu^\\ast \\xi^\\ast(t ) ) \\ }   \\notag \\\\ & & + ( i \\otimes f(t ) c_f(t ) ) \\",
    "{ \\tilde \\pi_t ( a \\otimes x ) \\tilde \\pi_t ( i \\otimes ( l+l^\\ast ) ) + \\mathcal{h}_t   \\notag \\\\ & & + \\tilde \\pi_t ( a \\otimes x)\\tilde   \\pi_t ( \\sigma_+ \\otimes s \\nu \\xi(t ) + \\sigma_- \\otimes s^\\ast \\nu^\\ast \\xi^\\ast(t ) ) \\ } ] dt .",
    "\\notag\\end{aligned}\\ ] ] now equating coefficients of @xmath192 and @xmath193 we solve for @xmath194 and @xmath195 to obtain the filter equation .",
    "we now prove the martingale property @xmath196 = 0 $ ] , that is , @xmath197 = 0   $ ] for all @xmath79 .",
    "now @xmath198   \\notag \\\\ & = & \\mathbb{e}_{\\sigma } [ \\ { i \\otimes ( y(t ) - y(s ) )   \\notag \\\\ & & - \\int_s^t \\pi_r ( i \\otimes ( l+l^\\ast ) + \\sigma_+ \\otimes s \\xi(r ) + \\sigma_- \\otimes s^\\ast \\xi^\\ast(r ) ) dr \\ } i \\otimes k ]   \\notag \\\\ & = & \\mathbb{e}_{\\sigma } [ \\ { i \\otimes ( y(t ) - y(s ) )   \\notag \\\\ & & - \\int_s^t ( i \\otimes ( l(r)+l^\\ast(r ) ) + \\sigma_+ \\otimes s(r ) \\xi(r ) + \\sigma_- \\otimes s^\\ast(r ) \\xi^\\ast(r ) ) dr \\ } i \\otimes k ]   \\notag \\\\ & = & \\mathbb{e}_{\\sigma } [ \\ { i \\otimes ( v(t ) - v ( s ) ) - \\int_s^t ( \\sigma_+ \\otimes s(r ) \\nu \\xi(r ) + \\sigma_- \\otimes s^\\ast(r ) \\nu^\\ast \\xi^\\ast(r ) ) dr \\ } i \\otimes k ] = 0 .",
    "\\notag\\end{aligned}\\ ] ] to see that this last expression is zero , we make use of lemma [ lemma : z - compensated - mtg ] , the multiplicative factorization of the vacuum state , the fact that @xmath199 has zero expectation in the vacuum state , to find that @xmath200 & = & w_{11 } \\mathbb{e}_{11 } [ ( v(t ) - v(s ) ) k ] + w_{00 } \\mathbb{e}_{00 } [ ( v(t ) - v(s ) ) k ]   \\notag \\\\ & = & w_{11 } ( \\int_s^t \\mathbb{e}_{10 } [ s(r)k ] \\xi(r)dr + \\int_s^t \\mathbb{e}_{01 } [ s^\\ast(r ) k ] \\xi^\\ast(r)dr ) ,   \\notag\\end{aligned}\\ ] ] and @xmath201   \\notag \\\\ & = & w_{11 } ( \\int_s^t \\mathbb{e}_{10 } [ s(r ) k ] \\xi(r ) dr + \\int_s^t \\mathbb{e}_{01 } [ s^\\ast ( r ) k ] \\xi^\\ast(r ) dr ) .",
    "\\notag\\end{aligned}\\ ] ] finally , since @xmath202 , levy s theorem implies that @xmath181 is a @xmath67 wiener process .",
    "this completes the proof .",
    "notice the terms involving @xmath153 in the filter ( equation ( [ eq : matrix - filter ] ) ) and in the innovations process ( equation ( [ eq : innovation - matrix ] ) ) .",
    "these terms arise from expectations involving the single photon state .",
    "note that due to the martingale property of the innovations process @xmath181 we see that if we take the expected value of equation ( [ eq : matrix - filter ] ) we recover equation ( [ eq : matrix - master ] ) , consistent with @xmath203 = \\tilde \\mu_t(a\\otimes x ) $ ] and the definition of conditional expectation .",
    "we return now to the main goal of the paper , namely the determination of the quantum filter for the conditional state when the field is in the single photon state , as stated in equation ( [ eq : cond - exp ] ) .",
    "as discussed earlier , our strategy is to make use of the filtering results obtained in section [ sec : matrix - filter ] for the extended system .",
    "assume @xmath176 .",
    "define the conditional quantities @xmath204 by @xmath205 where @xmath177 is the conditional state for the extended system defined by ( [ eq : matrix - c - exp - def ] ) .",
    "then for all @xmath206 we have @xmath207=\\mathbb{e}_{jk}[j_{t}(x)k ] .",
    "\\label{eq : pi - jk - c - exp-0}\\ ] ]    we have @xmath208 & = &   \\frac{1}{w_{11 } } \\mathbb{e}_{\\sigma } [   \\vert e_1 \\rangle \\langle e_1 \\vert \\otimes ( \\pi^{jk}_t(x)k ) ] \\\\ & = & \\frac{1}{w_{11 } } \\mathbb{e}_{\\sigma } [   \\pi_t ( \\vert e_1 \\rangle \\langle e_1 \\vert \\otimes i )   ( i \\otimes   \\pi^{jk}_t(x)k ) ] \\\\ & = & \\frac{1}{w_{jk } } \\mathbb{e}_{\\sigma } [   \\pi_t ( \\vert e_j \\rangle \\langle e_k \\vert   \\otimes x )   ( i \\otimes   k ) ]   \\\\ & = & \\frac{1}{w_{jk } } \\mathbb{e}_{\\sigma } [ (   \\vert e_j \\rangle \\langle e_k \\vert \\otimes j_t(x ) )   ( i \\otimes   k ) ]   \\\\ & = & \\mathbb{e}_{jk } [ j_t(x ) k ] \\end{aligned}\\ ] ] as required .",
    "@xmath114    we can now present our main theorem for the quantum filter for the single photon field state .",
    "[ thm : main ] the quantum filter for the conditional expectation with respect to the single photon field is given in the heisenberg picture by @xmath209 = \\pi^{11}_t(x),\\ ] ] where @xmath210 is defined by ( [ eq : pi - jk - def ] ) ( for @xmath211 ) , and is given by the system of equations @xmath212 ) \\xi^\\ast(t ) + \\pi^{10}_t ( [ l^\\ast , x ] s ) \\xi(t )   \\notag \\\\ & & + \\pi^{00}_t ( s^\\ast x s - x ) \\vert \\xi(t ) \\vert^2)dt   \\notag \\\\ & & + ( \\pi^{11}_t ( xl + l^\\ast x ) + \\pi^{01}_t(s^\\ast x ) \\xi^\\ast(t ) + \\pi^{10}_t ( xs ) \\xi(t )   \\notag \\\\ & & - \\pi^{11}_t(x ) ( \\pi^{11}_t(l+l^\\ast ) + \\pi^{01}_t(s ) \\xi(t ) + \\pi^{10}_t(s^\\ast ) \\xi^\\ast(t ) ) ) dw(t ) ,    \\label{eq : pi - dyn - a-11 }   \\\\ d\\pi^{10}_t ( x ) & = & ( \\pi^{10}_t(\\mathcal{l}(x ) ) + \\pi^{00}_t ( s^\\ast [ x , l ] ) \\xi^\\ast(t ) ) dt   \\notag \\\\ & & + ( \\pi^{10}_t ( xl + l^\\ast x ) + \\pi^{00}_t(s^\\ast x ) \\xi^\\ast(t )   \\notag \\\\ & & - \\pi^{10}_t(x ) ( \\pi^{11}_t(l+l^\\ast ) + \\pi^{01}_t(s ) \\xi(t ) + \\pi^{10}_t(s^\\ast ) \\xi^\\ast(t ) ) ) dw(t ) ,    \\label{eq : pi - dyn - a-10 }   \\\\ d\\pi^{01}_t ( x ) & = & ( \\pi^{01}_t(\\mathcal{l}(x ) ) + \\pi^{00}_t ( [ l^\\ast , x ] s ) \\xi(t ) ) dt   \\notag \\\\ & & + ( \\pi^{01}_t ( xl + l^\\ast x ) + \\pi^{00}_t ( xs )",
    "\\xi(t )   \\notag \\\\ & & - \\pi^{01}_t(x ) ( \\pi^{11}_t(l+l^\\ast ) + \\pi^{01}_t(s ) \\xi(t ) + \\pi^{10}_t(s^\\ast ) \\xi^\\ast(t ) ) ) dw(t ) ,    \\label{eq : pi - dyn - a-01 }   \\\\ d\\pi^{00}_t ( x ) & = & \\pi^{00}_t(\\mathcal{l}(x ) ) dt + ( \\pi^{00}_t ( xl + l^\\ast x )   \\notag \\\\ & & - \\pi^{00}_t(x ) ( \\pi^{11}_t(l+l^\\ast ) + \\pi^{01}_t(s ) \\xi(t ) + \\pi^{10}_t(s^\\ast ) \\xi^\\ast(t ) ) ) dw(t ) .",
    "\\label{eq : pi - dyn - a-00}\\end{aligned}\\ ] ] here , the innovations process @xmath181 is a @xmath67 wiener process with respect to the single photon state and is defined by @xmath213 the initial conditions are @xmath214    suppose first that @xmath176 .",
    "setting @xmath211 in equation ( [ eq : pi - jk - c - exp-0 ] ) above , and noting that @xmath215 was otherwise arbitrary , we deduce that @xmath216 is the desired conditional expectation for the single photon field state , as characterized by equation ( [ eq : c - exp - def ] ) . the differential equations ( [ eq : pi - dyn - a-11])-([eq : pi - dyn - a-00 ] )",
    "follow from the definition ( [ eq : pi - jk - def ] ) , the filter ( [ pi_filter ] ) for the extended system , and the ito rule .",
    "next , we note that the coefficients of the qsdes ( [ eq : pi - dyn - a-11])-([eq : pi - dyn - a-00 ] ) , the initial conditions , and @xmath217 do not depend on @xmath218 and @xmath219 . hence , the solutions @xmath220 of this system of equations are independent of @xmath218 and @xmath219 .",
    "therefore , @xmath220 can be defined for @xmath221 , @xmath222 , and is in fact identical for all @xmath223 .",
    "we now prove that @xmath181 is a @xmath67-martingale , that is , @xmath224=0 $ ] . to this end , let @xmath225 .",
    "then @xmath226 & = & \\mathbb{e}_{11}[\\{y(t)-y(s )   \\notag \\\\ & & -\\int_{s}^{t}(\\pi _ { r}^{11}((l+l^{\\ast } ) + \\pi _ { r}^{10}(s)\\xi ( t)+\\pi _ { r}^{01}(s^{\\ast } ) \\xi ^{\\ast } ( t))dr\\}k ]   \\notag \\\\ & = & \\mathbb{e}_{11}[\\{\\int_{s}^{t}(l(r)+l^{\\ast } ( r))dr+v(t)-v(s )   \\notag \\\\ & & -\\int_{s}^{t}(\\pi _ { r}^{11}((l+l^{\\ast } ) + \\pi _ { r}^{10}(1)\\xi ( t)+\\pi _ { r}^{01}(1)\\xi ^{\\ast } ( t))dr\\}k ]   \\notag \\\\ & = & \\mathbb{e}_{11}[\\{\\int_{s}^{t}(l(r)+l^{\\ast } ( r)-\\pi _ { r}^{11}((l+l^{\\ast } ) ) dr\\}k ]   \\notag \\\\ & & + \\mathbb{e}_{11}[\\{v(t)-v(s)-\\int_{s}^{t}(\\pi _ { r}^{10}(s)\\xi ( t)+\\pi _ { r}^{01}(s^{\\ast } ) \\xi ^{\\ast } ( t))dr\\}k]\\end{aligned}\\ ] ] however , this vanishes from ( [ eq : pi - jk - c - exp-0 ] ) , lemma [ lemma : z - compensated - mtg ] , and @xmath227 \\\\ & & = \\mathbb{e}_{10}[\\int_{s}^{t}s(r)\\xi ( r)dr k]+\\mathbb{e}_{01}[\\int_{s}^{t}s^{\\ast } ( r)\\xi ^{\\ast } ( r)dr k ] .\\end{aligned}\\ ] ]    finally , since @xmath202 , levy s theorem implies that @xmath181 is a @xmath67 wiener process . @xmath114",
    "the reference method is one of the standard approaches to filtering theory , with its origins in the work of duncan , mortensen , zakai , holevo and belavkin , see @xcite , @xcite , @xcite , @xcite , @xcite . in this section",
    "we apply this approach , as described in @xcite , to the filtering problem in the extended system , giving an independent derivation of the fundamental filtering equation .",
    "our first step is the following .",
    "[ lemma : matrix - f - rep ] assume @xmath176",
    ". then we have",
    "@xmath228 = \\mathbb{e}_{\\sigma } [ f^\\ast(t ) ( a \\otimes x ) f(t ) ] \\ ] ] where @xmath229 is given by @xmath230 @xmath231 , and @xmath232    let us suppose that @xmath233 satisfies ( [ df ] ) with coefficients @xmath234 , @xmath235 which both commute with @xmath236 , that is , @xmath237 then @xmath238 = \\mathbb{e}_{\\sigma } \\left [ f\\left ( t\\right ) ^{\\ast } \\left\\ { t_t ( a \\otimes x ) dt + q_t ( a \\otimes x)dz(t ) \\right\\ } f\\left ( t\\right ) \\right ] , \\ ] ] where @xmath239 using lemma [ lemma : expectation - basic - extended ] we see that this equals @xmath240dt.\\ ] ] we now require that this equals @xmath241 dt$ ] .",
    "this implies the four identities @xmath242s   \\label{id2 } \\\\",
    "g_{11}^{\\ast } xg_{10}+g_{01}{}^{\\ast } x+\\nu ^{\\ast } \\xi ^{\\ast } g_{10}{}^{\\ast } x+\\nu ^{\\ast } \\xi ^{\\ast } xg_{10 } & = & \\nu ^{\\ast } \\xi ^{\\ast } s^{\\ast } [ x , l ]   \\label{id3 } \\\\",
    "g_{10}^{\\ast } xg_{10}+g_{00}^{\\ast } x+xg_{00 } & = & \\mathcal{l}\\left ( x\\right ) .",
    "\\label{id4}\\end{aligned}\\ ] ] the first identity ( [ id1 ] ) is satisfied if @xmath243 .",
    "substituting @xmath244 into ( [ id2 ] ) we deduce that @xmath245 and thus @xmath246s.\\ ] ] therefore ( [ id2 ] ) is satisfied if @xmath247 , and consequently @xmath248 .",
    "it then follows that ( [ id3 ] ) will be automatically satisfied , while ( [ id4 ] ) then only requires that @xmath249 in order to obtain the lindblad generator @xmath250 .",
    "this leads us precisely to the coefficients @xmath251 stated in the lemma , and the identity @xmath252    the following bayes relation is proven along similar lines to ( * ? ? ?",
    "* theorem 6.2 ) .",
    "[ lemma : matrix - bayes ] for @xmath176 , define @xmath253 ( i \\otimes u(t ) ) .",
    "\\label{eq : varsigma - def}\\end{aligned}\\ ] ] then @xmath254    in order to determine the differential equation for @xmath255 , we first define , for @xmath256 the process @xmath257,\\ ] ] so that @xmath258 .",
    "we then have    [ lemma : matrix - ref - c - exp ] let @xmath176 .",
    "the process @xmath259 satisfies the qsde @xmath260 where @xmath261 , are given by @xmath262 with @xmath263.\\ ] ]    setting @xmath264 , we have that @xmath265 and our aim is compute @xmath266 $ ] . in particular ,",
    "@xmath267 = 0\\ ] ] for every @xmath268 and we now apply a technique similar to the characteristic function method , this time using the input process @xmath269 and taking the process @xmath270 to satisfy the qsde @xmath271 with @xmath272 , for given integrable @xmath185 . from the ito product rule",
    "we then have @xmath273\\ ] ] and making the ansatz that @xmath274 for unknown coefficients @xmath275 and @xmath276 we see that @xmath277   \\\\ & & + \\mathbb{e}_{\\psi } \\left [ \\left ( r_{t}-\\gamma _ { t}\\left ( a\\otimes x \\right ) \\right ) d_{t}f\\left ( t\\right ) dz(t)\\right ]   \\\\ & & + \\mathbb{e}_{\\psi } \\left [ \\left [ f(t)^{\\ast } q_{t}\\left ( a\\otimes x \\right ) f(t)-\\beta _ { t}\\left ( a\\otimes x \\right ) \\right ] d_{t}f\\left ( t\\right ) dt\\left ( t\\right ) \\right ] .\\end{aligned}\\ ] ] we now make use of lemma [ lemma : expectation - basic - extended ] again and apply the commutation relations @xmath278 , @xmath279 .",
    "( note that @xmath280 will not commute with @xmath281 . ) inserting @xmath282 $ ] under the expectation sign , then separating coefficients of @xmath283 and @xmath284 , we obtain the equations @xmath285 , \\\\ 0 & = & \\gamma _ { t}\\left ( q_t\\left ( a\\otimes x \\right ) \\right ) -\\beta _ { t}\\left ( a\\otimes x \\right ) \\\\ & & + \\nu \\xi ( t)\\gamma _ { t}\\left ( a\\otimes x \\left ( \\sigma _ { + } \\otimes i\\right ) \\right ) + \\nu ^{\\ast } \\xi ( t)^{\\ast } \\gamma _ { t}\\left ( \\left ( \\sigma _ { -}\\otimes i\\right ) a\\otimes x \\right )   \\\\ & & -\\gamma _ { t}\\left ( a\\otimes x \\right ) \\mathbb{e}_{\\sigma } \\left [ \\nu \\xi ( t)\\sigma_{+}\\otimes i+\\nu ^{\\ast } \\xi ( t)^{\\ast } \\sigma _ { -}\\otimes i|i\\otimes \\mathscr{z}_t \\right ] .\\end{aligned}\\ ] ] rearranging these expressions yields the relations in the statement of the lemma .",
    "let @xmath176 .",
    "the unnormalized conditional expectation @xmath286 defined by ( [ eq : varsigma - def ] ) satisfies the equation @xmath287 where @xmath288    we remark that by inspection the coefficients in the qsde for @xmath289 simplify to @xmath290 and therefore @xmath291 .\\ ] ] the qsde for @xmath292 is then readily deduced from the unitary rotation noting that @xmath293 and @xmath294 .    for @xmath176 ,",
    "the conditional expectation @xmath295 defined by ( [ eq : matrix - c - exp - def ] ) and given by ( [ eq : matrix - bayes ] ) satisfies equation ( [ pi_filter ] ) derived in theorem [ thm : matrix - filter ] .",
    "we see that @xmath296 and so @xmath297 however , we note from ( [ eq : def_lambda_t ] ) that @xmath298 by an application of the ito product rule , the normalized filter therefore satisfies @xmath299   \\\\ & = & \\pi _",
    "{ t}(\\mathcal{g}_{t}(a \\otimes x))dt+ \\ { \\pi _ { t}\\left ( a \\otimes x \\tilde{l}_{t}+\\tilde{l}_{t}^{\\ast } a \\otimes x \\right )   \\\\ & & -\\pi _ { t}\\left ( a \\otimes x \\right ) \\pi _ { t}\\left ( \\tilde{l}_{t}+\\tilde{l}_{t}^{\\ast } \\right ) \\ }   \\left [ dy(t)-\\pi _ { t}\\left ( \\tilde{l}_{t}+\\tilde{l}_{t}^{\\ast } \\right ) dt\\right ]   \\\\ & \\equiv & \\pi _ { t}(\\mathcal{g}_{t}(a \\otimes x))dt+\\mathcal{h}_{t}(a \\otimes x)dw\\left ( t\\right),\\end{aligned}\\ ] ] since we have from ( [ ltilde ] ) , ( [ eq : matrix - filter ] ) and([eq : innovation - matrix ] ) @xmath300 therefore we recover equation ( [ pi_filter ] ) .",
    "in this section we take the field to be in a superposition state @xmath301 where @xmath24 are coherent states and the complex numbers @xmath25 ( @xmath26 ) are non - zero normalized weights ( described further below ) .",
    "coherent vectors @xmath302 may be expressed in terms of the vacuum vector using the weyl ( or displacement ) operator @xcite @xmath303 which serves as a : @xmath304 while the collection of all coherent vectors is dense in the fock space , they are not orthogonal , and indeed the inner product ( in the fock space ) is given by @xmath305 here , @xmath306 and @xmath307 are the @xmath308 norm and inner product respectively . the superposition state @xmath8 given by ( [ eq : super - state ] )",
    "is specified by a choice of coherent vectors @xmath24 , with weights @xmath25 ensuring normalization : @xmath309 , where @xmath310 .    for a system operator",
    "@xmath5 acting on @xmath31 , and @xmath86 is a field operator acting on the fock space @xmath35 , the expectation with respect to the state @xmath311 is defined by @xmath312 & = &   \\langle \\eta \\psi   \\vert   ( x \\otimes f)\\vert \\eta\\psi \\rangle = \\langle \\eta \\vert   x \\vert \\eta \\rangle \\langle \\psi \\vert   f \\vert   \\psi \\rangle \\nonumber \\\\ & = & \\langle \\eta \\vert x \\vert \\eta \\rangle \\sum_{jk } \\alpha_j^\\ast \\alpha_k \\langle f_j \\vert   f   \\vert f_k \\rangle \\nonumber \\\\ & = & \\sum_{jk } \\alpha_j^\\ast \\alpha_k \\mathbb{e}_{jk } [ x \\otimes f ] , \\label{eq : expect - def}\\end{aligned}\\ ] ] where @xmath313 = \\langle \\eta \\vert   x \\vert \\eta \\rangle \\langle   f_j \\vert   f   \\vert   f_k \\rangle\\ ] ] for @xmath314",
    ". we write @xmath315 = \\langle \\eta \\vert   x \\vert \\eta \\rangle \\langle   0 \\vert   f \\vert   0 \\rangle $ ] for the vacuum case .",
    "consider now the expectation of an adapted operator @xmath99 on the composite system @xmath316 } ) \\otimes \\mathfrak{f}_{(t}$ ] ; this means that @xmath99 acts trivially on the future component @xmath101 .",
    "let @xmath95}$ ] is the indicator function for the time interval @xmath96 $ ] .",
    "now coherent vectors and weyl operators factorize as @xmath317 } \\rangle \\otimes \\vert f \\chi_{(t,\\infty ) } \\rangle$ ] and @xmath318 } )   \\otimes w(f \\chi_{(t,\\infty ) } ) $ ] , respectively .",
    "write @xmath319 } ) , \\",
    "\\ w^+_t(f)=w(f \\chi_{(t,\\infty ) } ) .\\ ] ] then we can express the coherent expectations of adapted processes @xmath99 in terms of the vacuum : @xmath320 & = & \\mathbb{e}_{00 } [ w^{-\\ast}_t(f_j ) k(t ) w^-_t(f_k ) ] r^{jk}(t ) \\label{eq : kt-00 - 0}\\end{aligned}\\ ] ] where @xmath321 satisfies @xmath322 note that @xmath323 is the standard coherent expectation , in which case @xmath324 .",
    "the following lemma shows how expectations of stochastic integrals with respect to the superposition state can be evaluated .",
    "[ lemma : expectation - basic - cat ] let @xmath99 be a bounded quantum stochastic process defined by ( [ eq : kt - def ] ) , where @xmath105 , @xmath106 and @xmath107 are bounded and adapted .",
    "then we have @xmath325 & = & \\mathbb{e}_{jk } [ \\int_0^t m_0(s ) ds ] +   \\int_0^t m_- ( s ) f_k(s ) ds   \\nonumber \\\\ & &   +   \\int_0^t m_+ ( s ) f^\\ast_j(s ) ds + \\int_0^t m_1 ( s ) f_j^\\ast(s ) f_k(s ) ds ]   .",
    "\\label{eq : kt-00-cat}\\end{aligned}\\ ] ]    equation ( [ eq : kt-00-cat ] ) follows from the following eigenstate property of coherent vectors : @xmath326 @xmath114      for the superposition of @xmath7 coherent states , we use an @xmath7-level ancilla system , leading to the extended space @xmath327    as in the single photon case , we allow the extended system to evolve unitarily according to @xmath132 , where @xmath48 is the unitary operator for the system and field , given by the schrdinger equation ( [ eq : unitary ] ) .",
    "let @xmath328 , @xmath26 , be an orthonormal basis for @xmath329 .",
    "we initialize the extended system in the state @xmath330 where @xmath331 for all @xmath332 and @xmath333 ( so that @xmath334 ) .",
    "this state evolves according to @xmath335 .",
    "let @xmath14 be an operator acting on @xmath336 , i.e. a complex @xmath337 matrix , @xmath338 , @xmath314 .",
    "then expectation in the extended system is defined by @xmath339 = \\langle \\sigma \\vert ( a \\otimes x \\otimes f ) \\vert \\sigma \\rangle = \\frac{1}{\\vert \\alpha \\vert^2 } \\sum_{jk } a_{jk } \\alpha_j^\\ast \\alpha_k \\mathbb{e}_{jk } [ x \\otimes f ] .",
    "\\label{eq : expect - extended - def}\\ ] ]    expectations of quantum stochastic integrals can be compactly expressed in the extended system , as the following lemma shows .",
    "[ lemma : expectation - basic - extended - cat ] let @xmath150 be adapted . then @xmath340 & = &    \\mathbb{e}_{\\sigma }   [ \\int_0^t ( a c(s ) ) \\otimes m(s )   ds ] ,   \\label{eq : extended - expect-1 } \\\\ \\mathbb{e}_{\\sigma }   [ \\int_0^t a \\otimes m ( s ) db^\\ast(s ) ] & = &    \\mathbb{e}_{\\sigma }   [ \\int_0^t ( c^\\dagger ( s ) a ) \\otimes m(s ) ds ] ,    \\label{eq : extended - expect-2 }   \\\\ \\mathbb{e}_{\\sigma }   [ \\int_0^t a \\otimes m(s ) d\\lambda(s ) ] & = &    \\mathbb{e}_{\\sigma }   [ \\int_0^t ( c^\\dagger(s ) a c(s )   ) \\otimes m(s ) ds ] ,   \\label{eq : extended - expect-3}\\end{aligned}\\ ] ] where @xmath341.\\ ] ]    notice that the expectations of the stochastic integrals are expressed in terms of the action of the matrix @xmath342 on the ancilla factor @xmath14 .      in this section",
    "we show how the the unconditional expectation @xmath343 \\label{eq : mu - def}\\ ] ] may be computed from a collection of differential equations .",
    "we do this through a differential equation for the unconditional expectation @xmath344 \\label{eq : mu - tilde - def}\\ ] ] for the extended system .",
    "let @xmath345 be an @xmath346 matrix defined by @xmath347 for all @xmath348 , and define @xmath349 s    + ( c^\\dagger(t ) a ) \\otimes s^\\ast [ x , l ]    \\notag \\\\ & & + ( c^\\dagger(t ) a c(t ) ) \\otimes ( s^\\ast x s - x ) ) .\\end{aligned}\\ ] ]    [ lemma : master-1-cat ] the unconditional expectation ( [ eq : mu - def ] ) with respect to the superposition state @xmath20 ( defined by ( [ eq : super - state ] ) ) is given by @xmath350 and the master equation for the expectation ( [ eq : mu - tilde - def ] ) in the extended system is @xmath351 with initial condition @xmath352 .    by definitions ( [ eq : expect - extended - def ] ) and ( [ eq : expect - def ] ) we have @xmath353 & = &     \\frac{1}{\\vert \\alpha \\vert^2 } \\sum_{jk }   \\alpha_j^\\ast \\alpha_k \\mathbb{e}_{jk } [ x(t )   ] \\\\ & = &   \\frac{1}{\\vert \\alpha \\vert^2 }   \\mathbb{e}_{\\eta\\psi } [    x(t ) ] , \\end{aligned}\\ ] ] and in particular @xmath354 =   \\frac{1}{\\vert \\alpha \\vert^2 }    .\\ ] ] from these expressions , we see that @xmath355   = \\vert \\alpha \\vert^2 \\mathbb{e}_{\\sigma } [   r\\otimes x(t ) ]   = \\frac{\\mathbb{e}_{\\sigma } [   r\\otimes x(t ) ]   } { \\mathbb{e}_{\\sigma } [   r\\otimes i ] } , \\ ] ] which proves ( [ eq : mu - relation ] ) .",
    "the differential equation ( [ eq : mu - master ] ) follows from the qsde ( [ eq : x - dyn ] ) for @xmath356 and relations ( [ eq : extended - expect-1])-([eq : extended - expect-3 ] ) upon evaluating the differential @xmath357 $ ] . @xmath114",
    "[ thm : master - cat ] the unconditional expectation @xmath358 when the field is in the superposition state @xmath20 ( defined by ( [ eq : super - state ] ) ) is given by @xmath359 where @xmath142 is given by the system of equations @xmath360 and where @xmath361 f_j^\\ast(t ) + [ l^\\ast , x ] s f_k(t ) + ( s^\\ast x s - x ) f_j^\\ast(t ) f_k(t ) .\\ ] ] the initial conditions are @xmath362    define @xmath115.\\ ] ] then as in the proof of lemma [ lemma : master-1-cat ] we may show that @xmath363 the the relation ( [ eq : mu - cat - rep ] ) follows from ( [ eq : mu - relation ] ) .",
    "the differential equation ( [ eq : dot - mu - jk - c ] ) follows from equation ( [ eq : mu - master ] ) with @xmath158 .",
    "@xmath114      in this section we show how the conditional expectation @xmath4 defined by ( [ eq : cond - exp ] ) can be evaluated using a system of conditional equations .",
    "this will make use of the conditional expectation @xmath364.\\ ] ] for the extended system .",
    "[ lemma : filter - extended - cat ] the conditional expectation @xmath4 defined by ( [ eq : cond - exp ] ) with respect to the superposition state @xmath365 is given by @xmath366 the quantum filter for the conditional expectation @xmath367 is @xmath368 with initial condition @xmath369 , where @xmath370 and @xmath181 is a @xmath67-wiener process given by @xmath371 the initial condition is @xmath372 .",
    "let @xmath79 .",
    "then we have @xmath373 & = &   \\mathbb{e}_{\\sigma } [ ( r \\otimes x(t ) ) ( i \\otimes k ) ] \\notag \\\\ & = &   \\frac{1}{\\vert \\alpha \\vert^2 } \\sum_{jk }   \\alpha_j^\\ast \\alpha_k \\mathbb{e}_{jk } [ x(t ) k ] \\notag \\\\ & = &   \\frac{1}{\\vert \\alpha \\vert^2 }   \\mathbb{e}_{\\eta\\psi } [ x(t)k ]   \\notag   \\\\   & = &   \\frac{1}{\\vert \\alpha \\vert^2 }   \\mathbb{e}_{\\eta\\psi } [ \\pi_t(x ) k ]   \\notag   \\\\   & = &   \\mathbb{e}_{\\sigma } [ r \\otimes \\pi_t(x ) k ]    \\notag   \\\\   & = &   \\mathbb{e}_{\\sigma } [   \\mathbb{e}_{\\sigma } [ r \\otimes \\pi_t(x ) k \\vert i \\otimes \\mathscr{y}_t ] ]   \\notag \\\\   & = &   \\mathbb{e}_{\\sigma } [ \\tilde\\pi_t(r\\otimes i ) ( i \\otimes \\pi_t(x ) ) ( i \\otimes k ) ] .\\end{aligned}\\ ] ] this proves ( [ eq : pi - relation ] ) .    the filtering equation ( [ eq : super - filter ] ) is derived using the characteristic function method @xcite , @xcite , @xcite .",
    "we postulate that the filter has the form @xmath374 where @xmath183 and @xmath184 are to be determined .",
    "let @xmath185 be square integrable , and define a process @xmath192 by @xmath187 then @xmath188 is adapted to @xmath166 , and the definition of quantum conditional expectation @xcite implies that @xmath189 = \\mathbb{e}_\\sigma [ \\tilde \\pi_t ( a \\otimes x(t ) ) ( i \\otimes c_f(t ) ) ] \\ ] ] holds for all @xmath185 . by calculating the differentials of both sides , taking expectations and conditioning we obtain @xmath190 & = & \\mathbb{e}_\\sigma [ ( i \\otimes c_f(t ) ) \\tilde\\pi_t ( \\mathcal{g}(a \\otimes x ) )   \\\\ & & + ( i \\otimes f(t ) c_f(t ) )    \\tilde \\pi_t ( ( a \\otimes x)(i \\otimes l + c(t ) \\otimes s )   \\notag \\\\ & & +   ( i \\otimes l + c^\\dagger(t ) \\otimes s^\\ast ) ( a \\otimes x )   ) ] dt     \\ \\ \\   \\notag\\end{aligned}\\ ] ] and @xmath191   \\\\   & = & \\mathbb{e}_\\sigma [ ( i \\otimes c_f(t ) \\ { \\mathcal{f}_t(a\\otimes x ) + \\mathcal{h}_t(a\\otimes x )    \\tilde \\pi_t ( i\\otimes l+ c(t)\\otimes s   + i\\otimes l^\\ast + c^\\dagger(t ) \\otimes s^\\ast ) \\ }   \\notag \\\\ & & + ( i \\otimes f(t ) c_f(t ) ) \\ { \\   \\tilde \\pi_t(a\\otimes x ) \\tilde \\pi_t ( i\\otimes l+ c(t)\\otimes s   + i\\otimes l^\\ast + c^\\dagger(t ) \\otimes s^\\ast)+ \\mathcal{h}_t(a\\otimes x )     \\ } ] dt .",
    "\\notag\\end{aligned}\\ ] ] now equating coefficients of @xmath192 and @xmath193 we solve for @xmath194 and @xmath195 to obtain the filtering equation ( [ eq : super - filter ] ) .",
    "we now show that @xmath181 is a @xmath67-martingale , and since @xmath375 , then by levy s theorem @xcite we have that @xmath181 is a @xmath67-wiener process .",
    "indeed , for any @xmath79 we have @xmath376   \\notag \\\\ & = & \\mathbb{e}_{\\sigma } [   ( i\\otimes dy(t )     - \\tilde\\pi_t(i\\otimes l+ c(t)\\otimes s   + i\\otimes l^\\ast + c^\\dagger(t ) \\otimes s^\\ast ) dt)(i\\otimes k ) ] \\notag \\\\ & = & \\mathbb{e}_{\\sigma } [   i\\otimes ( l(t)+l^\\ast(t ) )    + c(t ) \\otimes s + c^\\ast(t ) \\otimes s^\\ast   \\notag \\\\ & & - \\tilde\\pi_t ( i\\otimes l+ c(t)\\otimes s   + i\\otimes l^\\ast + c^\\dagger(t ) \\otimes s^\\ast ) dt)(i\\otimes k ) ] dt = 0.\\end{aligned}\\ ] ] this completes the proof .",
    "@xmath114    [ thm : filter - cat ] the unconditional expectation @xmath358 when the field is in the superposition state @xmath20 ( defined by ( [ eq : super - state ] ) ) is given by @xmath377 where the conditional quantities @xmath378 are given by @xmath379 the innovations process @xmath181 is a @xmath67 wiener process with respect to the superposition state @xmath20 and is given by @xmath380 the initial conditions are @xmath381    these assertions follow upon substitution of @xmath382 into the relevant expressions from lemma [ lemma : filter - extended - cat ] .",
    "in this paper we have derived the master equation and quantum filter for a class of open quantum systems that are coupled to continuous - mode fields in non - classical states : ( i ) single photon states , and ( ii ) superpositions of coherent states . the quantum filter in both of the cases we consider consists of coupled equations that determine the evolution of the conditional state of the system under continuous ( weak ) measurement performed on the output field , in contrast to the familiar single filtering equation for open markov quantum systems that are coupled to coherent boson fields .",
    "this coupled equations structure of the master and filter equations is a reflection of the non - markov nature of systems coupled to the non - classical fields .",
    "indeed , a key feature of our approach is the embedding of the system into a larger extended system , a technique often employed in the analysis of non - markov systems , providing an elegant framework within which to study the the dynamics , both unconditional and conditional , of the system .",
    "in contrast to markovian embeddings @xcite , @xcite , @xcite , the extended system ( including the field ) is initialized in a superposition state .",
    "this embedding provides a framework within which the tools of the quantum stochastic calculus may be efficiently applied to determine quantum filtering equations .",
    "we expect that the use of suitable embeddings , both markovian and non - markovian , could be adapted to study quantum systems that are coupled to other types of highly non - classical fields .",
    "the authors wish to thank j.  hope for helpful discussions and for pointing out reference @xcite to us .",
    "we also wish to thank a.  doherty , h.  wiseman , e.  huntington and j.  combes for help discussions and suggestions ."
  ],
  "abstract_text": [
    "<S> the purpose of this paper is to determine quantum master and filter equations for systems coupled to fields in certain non - classical continuous - mode states . </S>",
    "<S> specifically , we consider two types of field states ( i ) single photon states , and ( ii ) superpositions of coherent states . </S>",
    "<S> the system and field are described using a quantum stochastic unitary model . </S>",
    "<S> master equations are derived from this model and are given in terms of systems of coupled equations . </S>",
    "<S> the output field carries information about the system , and is continuously monitored . </S>",
    "<S> the quantum filters are determined with the aid of an embedding of the system into a larger non - markovian system , and are given by a system of coupled stochastic differential equations .    </S>",
    "<S> keywords : quantum filtering , continuous - mode single photon states , continuous - mode superpositions of coherent states , quantum stochastic processes </S>"
  ]
}