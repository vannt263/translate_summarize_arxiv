{
  "article_text": [
    "we are predominantly interested in understanding the basic physics and deriving a few simple analytic expressions for the time response of bragg forward scattering from temporally short incident and laterally confined pulses .",
    "to simplify the subsequent analysis and avoid notational complications , we assume that the crystal is symmetric , meaning that the crystal planes responsible for bragg scattering are parallel to the crystal surface .",
    "this restriction is most relevant to the fel monochromator we subsequently study .",
    "we take the optical axis of the incident radiation to make an angle @xmath3 from the surface as shown in fig .",
    "[ fig:1](a ) .",
    "maxwell s wave equation for the electric field @xmath14 in the crystal is    ( , t ) = - - ( ) , & [ eqn : maxwellwave ]    where @xmath15 is the current density induced in the crystal by the radiation and @xmath16 is the speed of light .",
    "the linear response of the medium is given by the crystal polarizability @xmath17 . denoting the polarization components by a superscript @xmath18 , in the linear approximation for x - ray energies far above any atomic resonances we have @xmath19 where in the second line",
    "we have used the periodicity of the crystal to expand the polarizability @xmath20 as a fourier series .",
    "we decompose the electric field vector as a sum of two orthogonal polarizations , @xmath21 , with @xmath22 parallel and @xmath23 perpendicular to the scattering plane . in this case , the non - diagonal components ( namely , @xmath24 for @xmath25 ) vanish and the polarization components decouple . for simplicity , we assume @xmath26-polarization and subsequently drop the polarization dependence .",
    "the electronic polarizability in strongly couples electromagnetic waves whose wave - vectors differ by @xmath27 , which results in strong bragg reflection .",
    "we assume that this condition is satisfied for one reciprocal lattice vector , which in the symmetric geometry implies that @xmath28 .",
    "since the @xmath29 are assumed to be time independent , it is natural to take a fourier transform with respect to @xmath30 ; however , our goal is to compute the temporal response , and we find it more convenient to remain in the time domain . instead , we introduce the slowly varying eikonal field amplitudes associated with two interacting waves , writing the electromagnetic wave as    e ( , z , t ) & = e^-ick_0 t e^i k_0[z + x ] + & , [ eqn : eikonal ]    where @xmath31 is the carrier frequency and @xmath32 is the reference wave - vector .",
    "we assume that the field envelope functions have slow spatiotemporal variations with respect to the carrier frequency @xmath31 , with @xmath33 the reference carrier frequency @xmath31 can be freely chosen provided that hold , with any additional slow temporal dependence being accounted for by @xmath34 ; we choose @xmath35 to satisfy bragg s condition : @xmath36 .",
    "we have oriented our axes such that the scattering plane defined by the reciprocal lattice vector and the optical axis lie in the @xmath37 plane , and we assume that the crystal is uniform in the @xmath38 plane .",
    "thus , the fundamental field solutions are plane waves in the directions parallel to the crystal surface . for simplicity we will neglect the trivial @xmath39-dependence , with the general electric field",
    "@xmath40 being written as the superposition e_0,h(x , z , t ) = dq e^i q x _ 0,h(q , z , t ) .",
    "[ eqn : transft ]     with respect to the crystal surface .",
    "( b ) plots the geometry in the characteristic coordinate plane @xmath41-@xmath42 , with the crystal entrance and rear surfaces located at @xmath43 ( the line @xmath44 ) and @xmath45 ( the line @xmath46 ) , respectively .",
    "we also include the integration contours @xmath47 and @xmath48 that are used to obtain the solution for the reflected and transmitted waves . ]",
    "we now use the slowly - varying assumption to reduce the second order wave equation to two first - order equations for the field amplitudes @xmath49 and @xmath50 , an approach that was first developed in this context by takagi @xcite .",
    "since we assume that the crystal lattice is perfect , we find it convenient to use @xmath51 and @xmath30 as the relevant coordinates rather than the standard spatial coordinates along the wave - vectors ( see , e.g. , @xcite ) ; thus , our approach is similar to those of @xcite .",
    "we insert the forms and into the wave equation , and drop the term @xmath52 since the field remains approximately transverse in the crystal . by neglecting higher - order derivatives of the field amplitudes and matching fast phases , we obtain the following set of slowly - varying equations : @xmath53      \\mathcal{e}_0 & = \\frac{ik_0\\chi_{\\bar{h}}}{2 } \\mathcal{e}_h   \\label{eqn : e0 }   \\\\    \\left [ \\frac{\\partial}{\\partial ct } - \\sin\\theta \\frac{\\partial}{\\partial z }      + ik_0\\left(\\tilde{\\alpha}_h - \\frac{\\chi_0}{2}\\right ) \\right ]       \\mathcal{e}_h & = \\frac{ik_0\\chi_{\\vphantom{\\bar{h}}h}}{2 } \\mathcal{e}_0 ,     \\label{eqn : eh}\\end{aligned}\\ ] ] where for convenience we define @xmath54",
    ". we have attached tildes to @xmath55 because while they appear similar to the usual deviation from bragg s condition @xmath56 , they have a slightly different definition and interpretation in the present context .",
    "@xmath57 represents the incidence wave - vector s difference from the vacuum condition due to @xmath58 , while @xmath59 is the deviation of the reflected carrier wave from bragg s condition , with @xmath60   \\\\",
    "\\tilde{\\alpha}_h & \\equiv \\frac{1}{2k_0 ^ 2}\\big [ k_0 ^ 2 - ( k_0\\sin\\theta - h)^2 - ( k_0\\cos\\theta + q)^2 \\big];\\end{aligned}\\ ] ] our choice @xmath36 implies that _ 0 = _ h = + .",
    "note that the central wavenumber @xmath35 and the crystal parameters @xmath61 , @xmath62 , and @xmath63 are all functions of angle @xmath3 . to solve -",
    ", we introduce the characteristic coordinates @xmath64 and the reduced field amplitudes @xmath65 and @xmath66 via @xmath67 then , the coupled wave system - reduces to @xmath68 here , we see that if the coupling @xmath69 , the forward - going wave @xmath65 is a function of @xmath70 only , while the reflected wave @xmath66 is a fixed function of @xmath71 . in the crystal ,",
    "the two waves interact as shown , with each obeying the associated second - order equation = - - , where the extinction length @xmath72 is approximately independent of the angle @xmath3 for any given reflection [ this can be seen by using @xmath73 and @xmath74 .",
    "the linear system can be solved for specified boundary conditions using the riemann method as was done in @xcite , and which is reviewed in , e.g. , @xcite and in the appendix . for bragg scattering ,",
    "the reduced fields satisfy subject to the constraints that the forward - going wave @xmath65 is a prescribed function along the front crystal surface at @xmath75 while the reflected wave vanishes along the rear surface defined by @xmath76 . in terms of the characteristic",
    "coordinates shown in fig .",
    "[ fig:1](b ) , we have @xmath77    in the following two sections we solve the system subject to assuming a gaussian incident pulse that is temporally short and confined laterally in space .",
    "we will find relatively simple , approximate analytic expressions for the electric field when we can neglect multiple scattering of the waves off the crystal surfaces , meaning that we only consider the time interval following the main pulse that is smaller than @xmath78 .",
    "for a crystal of thickness @xmath79 mm this time interval is @xmath80 fs .",
    "the field at longer times can be built up by inserting these solutions into the riemann integrals in an iterative manner @xcite , but this is beyond the scope of the present study .      in the appendix we use riemann s method to show that on the front crystal surface the reflected field is given by _",
    "d _ ( , ) r_h ( , ;  ,  ) , [ eqn : refl_intsol ] where @xmath81 is the initially incident wave and the riemann function @xmath82 for the reflected wave satisfies the adjoint equation associated with the ( formally self - adjoint ) system r_h ( , ;  ,  ) = - r_h ( , ;  ,  ) , [ eqn : adjoint ] along with the auxiliary conditions @xmath83 the riemann function satisfying - is given by @xcite ; for the solution we need @xmath82 along the front crystal surface defined by the line @xmath44 ; here , we have @xmath84 with point @xmath85 located at @xmath86 , for which r_h ( , ;  ,  ) = 2 .",
    "[ eqn : reflriemannline ]     and the optical axis coordinates @xmath87 for both the reflected ( top ) and transmitted ( bottom ) wave . ]    the physical electric field amplitude of the reflected wave can be obtained by applying the field definitions - to the solution once we specify the incident field",
    ". we will be interested in the response from a temporally short incident wave directed along the optical axis shown in fig .",
    "[ fig:1](a ) .",
    "we model the incident wave by a gaussian field both longitudinally and transversely that propagates along the optical axis defined by @xmath88 :    e _ & = \\ { -[ct - ( z+ x)]^2 } + & .",
    "if the incident pulse length @xmath89 is much shorter than the penetration length , we can approximate the temporal profile as a delta - function ; taking the limit @xmath90 and using the definitions , , and , the incident field along the crystal surface @xmath75 in terms of the characteristic coordinates is @xmath91 upon inserting the initial condition into the solution for @xmath66 , the integral over @xmath41 can be trivially performed . to get",
    "the physical reflected field @xmath92 requires the inverse fourier transform as indicated by .",
    "the transform with respect to @xmath93 is a gaussian integral that can be taken analytically , so that    e_h & = dx + & e^i_0 k_0(ct - x)/2e^-x^2 ^ 2 ^ 2/4_x^2 + & + & .",
    "[ eqn : ereflsolved ]    equation expresses the reflected wave from the temporally short incident field . before attacking the integral",
    ", we must first relate the coordinates @xmath94 to those along the new optical axis defined by the reflected wave . as depicted in fig .",
    "[ fig:2 ] , these comprise the coordinate transverse to the optical axis @xmath12 and the orthogonal time delay @xmath0 defined at @xmath75 .",
    "note that the time difference is defined such that lines of constant @xmath0 are parallel to the @xmath12-axis .",
    "since the time @xmath30 is measured with respect to lines of constant @xmath51 , the reflected wave optical axis coordinates are related to @xmath95 via @xmath96 and @xmath97 as shown in fig .",
    "[ fig:2 ] .    to make further analytic progress",
    ", we can approximate this integral using the method of stationary phase .",
    "computation of the stationary points is greatly simplified if we assume that @xmath98 and that the transverse size @xmath99 is sufficiently large .",
    "specifically , we assume that @xmath100 physically , the first condition means that we consider distances behind the incident pulse @xmath101 that are much less than the rayleigh range associated with the beam spot size projected onto the crystal surface , while the second condition is equivalent to requiring the beam angular divergence is much less than @xmath102 ; these conditions are typically well - satisfied for all but extreme grazing angles . under these assumptions ,",
    "the stationary point is x_s = = - , [ eqn : stationarypt ] and the reflected wave is given by    e_h & = e^i_0 ck_0 /2 ^ 2 + & \\ { - } .",
    "[ eqn : reflectedfinalsol ]        from , the temporal profile of the reflected wave oscillates over the time - scale @xmath103 according to the bessel function @xmath104 ; we graph the sequence of power peaks associated with @xmath105 in fig .",
    "[ fig:3](a ) . additionally , the field profile is laterally displaced along @xmath12 as the time delay increases according to @xmath106 .",
    "we plot a specific example of this behavior in fig .",
    "[ fig:3](b ) for the c(004 ) reflection at @xmath107 , for which @xmath108 and @xmath109  .",
    "figure [ fig:3](b ) plots the reflected amplitude @xmath110 to more clearly identify the trailing pulses , which are displaced as predicted by eq .  .",
    "in the next section we apply a similar analysis to forward scattering .",
    "we will show that while the behavior of the transverse envelope is quite similar , the temporal profile of bragg forward scattering is distinct , in that it depends importantly on the crystal thickness @xmath11 .",
    "having found the spatiotemporal dependence of the reflected wave , we now turn to obtaining the transmitted wave @xmath111 at the rear surface of the crystal .",
    "the solution can again be determined by riemann s method ; restricting ourselves to @xmath112 , in the appendix we show that the transmitted wave is given by    _ 0_p & = r_0 _ 0_q - _",
    "a^q d r_0(,;,)_h + & -_a^q d ._0(, ) r_0(,;,)_= , [ eqn : transsol ]    where the riemann function that satisfies the relevant boundary conditions and the adjoint equation is @xcite    r_0 ( , ;  ,  ) = j_0 + + j_2",
    ".    along the exit crystal surface @xmath46 we have @xmath113 , so that the second integrand in involves = .",
    "[ eqn : transriemann ]    the first term in is merely the initial condition evolved along the characteristics , which is not the focus of this study , and we will henceforth drop it from our expressions . of the remaining two terms ,",
    "the one on the second line in is generated by the reflected wave that is directly excited by the incident pulse , which can be shown to dominate the second term from the first line in the following way . since @xmath114 , upon integration the second line scales as the product of @xmath115 and the x - ray path length through the crystal @xmath116 . using the expressions and for @xmath66 , it is easily shown that the integral on the first line in scales as @xmath115 times a highly oscillatory function integrated over the time @xmath117 ; for the times @xmath118 that we are considering , the first line of is therefore negligible with respect to that of the second line .",
    "thus , the transmitted wave of interest is given by the second line in .",
    "an expression for the transmitted electric field envelope is obtained by proceeding as we did for the reflected wave ; we use the definitions of the reduced fields - , insert the function , and use the initially short incident pulse .",
    "the integration over @xmath41 is then trivial , and we find",
    "_ 0_p = - dx e^-iqx e^-x^2 ^ 2/4_x^2 e^-ik_0 ( - _ 0/2)(2/+ d/- x ) .",
    "_ =(x/2 ) .",
    "[ eqn : transsol2 ] while this expression is difficult to interpret , we can make further progress by considering the field @xmath111 in physical space . we apply @xmath119 to both sides of ; again , the integral over @xmath93 is a gaussian one that can be taken analytically , leading to    e_0_p & = - dx \\ { } + & e^i_0 k_0[(d + 2)/- x]/2 .",
    "[ eqn : transsolnasty ]    finally , the expression should be written in term of the coordinates along the optical axis illustrated in fig .",
    "[ fig:2 ] , where @xmath120 again labels the transverse position with respect to the transmission optical axis , while @xmath0 is the relative time along the axis . from the figure",
    ", we see that at the rear surface @xmath76 we have @xmath121 , and @xmath122 ; these coordinates will be used in the final results .",
    "while the expression does nt look any more appealing than , we can begin to make sense of it by considering the limit of exact backscattering , i.e. , @xmath123 , in which case the integral over @xmath124 is merely the gaussian integral associated with paraxial evolution .",
    "furthermore , the transverse crystal coordinate equals its optical axis counterpart @xmath125 , while @xmath126 . in the limit of exact backscattering @xmath127 ,",
    "simplifies to    e_0_p = - e^i_0 k_0(d + c)/2 & + . &",
    "[ eqn : transsolbackscatter ]        in this form , the output field has a simple physical interpretation .",
    "the first factor shows that the amplitude scales as the product of the propagation distance and square of the coupling @xmath128 , since the incident wave must effectively be first scattered into the reflected wave and then back to the transmitted to produce the trailing pulse .",
    "additionally , the amplitude is altered by both the phase difference and loss due to the crystal index of refraction and by the natural transverse spreading of the pulse : in the limit @xmath129 , namely , that the rayleigh range is much greater than the total propagation distance @xmath130 , it yields the transverse envelope @xmath131 .",
    "finally , the second line gives the transmission temporal profile or the `` wake '' of the incident pulse .",
    "we plot the temporal power profile @xmath132 as a function of @xmath133 for two crystal thicknesses in fig .",
    "[ fig:4](a ) . doubling the crystal thickness from @xmath134 to @xmath135 decreases the time between maxima while increasing the peak power of each pulse by a factor of four .",
    "note that the entire domain of the graph lies in the region of the first reflection maximum plotted in fig  [ fig:3](a ) ; the characteristic time scale of the forward - scattered wave is much shorter than that of the reflected wave for @xmath136 .",
    "additionally , the temporal profile of forward scattering depends strongly on the crystal thickness @xmath11 .",
    "equation implies that the successive power maxima of the transmitted field are given by the maxima of the function @xmath137 , which correspond to the zeroes of the bessel function @xmath138 .",
    "we denote the positions of the @xmath137 maxima by @xmath139 for integer @xmath140 , with the @xmath141 peak at @xmath142 and the first trailing maximum of @xmath137 given by @xmath143 . setting the argument @xmath144",
    ", we find ^_n(= /2 ) = - [ eqn : maxima0 ] if the crystal thickness is much greater than the extinction length , @xmath145 .",
    "the time delay of the power maxima are inversely proportional to the crystal thickness @xmath11 .",
    "this can be understood in a heuristic manner by considering fig .",
    "[ fig:4](b ) .",
    "an initially sharp incident wave @xmath111 , indicated in fig .",
    "[ fig:4](b ) by the thick , red vertical arrow at @xmath146 , generates a reflected wave shown schematically as the blue horizontal lines directed along the @xmath71 characteristics . as the reflected wave amplitude grows , it in turn couples to the transmitted wave ( the red dotted lines ) , which increases its amplitude as it extracts energy from @xmath92 .",
    "in this way , energy alternates between the reflected and transmitted waves , as evidenced by the oscillatory profiles and .",
    "the position of the first transmission maximum , for example , should be given by the integrated amplitude of the reflected wave just behind the incident pulse , which is proportional to the interaction volume given by the green shaded area in fig .",
    "[ fig:4](b ) .",
    "if we denote the first transmission maximum as @xmath147 , we have @xmath148 or @xmath149 .",
    "equation is rigorously valid but limited to @xmath127 .",
    "we derive an approximate expression for that is valid for arbitrary @xmath3 excluding grazing incidence by again using the method of stationary phase .",
    "first , we insert the optical axis coordinates shown in fig .",
    "[ fig:2 ] , which along the exit surface yield the replacements @xmath150 and @xmath151 .",
    "next , we again assume that @xmath98 , and that the transverse spot size is sufficiently large so that the rayleigh range associated with the projected beam size is much shorter than the propagation length through the crystal , @xmath152 .",
    "finally , we assume that the transverse size of the beam projected onto @xmath51 is much smaller than the crystal thickness , so that @xmath153 .",
    "these conditions typically apply for all but small grazing incidence angles @xmath154 , and when satisfied result in a stationary point that is identical to that of bragg reflection : @xmath155 .",
    "thus , the transmitted field amplitude is    e_0_p & = - e^i_0 k_0(d + c/)/2 + & \\ { - } + & .",
    "[ eqn : transsolapprox ]    from , we see that the longitudinal time profile is nearly the same as that for exact backscattering with @xmath156 [ this identification is exact for delays @xmath157 if we assume that the rayleigh range is sufficiently long ] . additionally , we recall that the extinction length @xmath10 is nearly independent of @xmath3 , so that the temporal envelope @xmath158 can be obtained from that evaluated at @xmath127 eq .   by replacing @xmath159 .",
    "thus , the maxima at arbitrary @xmath3 can be written in terms of those at @xmath160 eq .   via ^_n",
    "( ) = ^_n(/2)[eqn : tmaxgeneral ] with , when @xmath161 , ^_n(/2 ) = .",
    "[ eqn : tmaxpih ]    we show in fig .  [ fig:4](c ) the time response of bragg forward diffraction at three different incidence angles from the ( 004 ) bragg reflection in diamond .",
    "the crystal thickness has been fixed at @xmath162 mm , and we plot the power profiles as a function of @xmath163 .",
    "the position of the intensity maxima is invariant on the normalized time scale , while the power scales as @xmath164 .",
    "the temporal profile is modified as indicated in , while also shows that the transverse envelope is translated from the optical axis at @xmath165 by the amount @xmath166 .",
    "this shift can be related to the distance along @xmath167 that the reflected wave travels during the time @xmath0 .",
    "we show this geometrically in fig .",
    "[ fig:5](a ) : much like how the delay arises because of the induced bragg scattering in the crystal , the representative rays are now directed along both @xmath51 and @xmath124 , so that as energy oscillates between waves the field is displaced in @xmath120 . here",
    ", the relevant shift can be found by comparing the times @xmath0 and transverse coordinates @xmath120 after the rays propagate along the characteristics some fixed distance . from fig .",
    "[ fig:5](a ) , we see that while the incident ray propagates a distance @xmath168 , the reflected wave is displaced in time by an amount @xmath169 and transversely by @xmath170 .",
    "taking the ratio , we find that corresponding to a time delay @xmath0 , we have the displacement @xmath171 .",
    "we show the spatiotemporal profile of a bragg forward scattered pulse from the c(004 ) crystal at @xmath172 in fig .",
    "[ fig:5](b ) .",
    "we assume a temporally short input pulse with rms transverse width @xmath173 .",
    "again , we plot the magnitude @xmath174 to more clearly show all the trailing pulses , and we scale the amplitude so that the first delayed maxima has unit magnitude .",
    "the temporal profile closely mirrors that shown of the same crystal in fig .",
    "[ fig:4](c ) , while each subsequent pulse is more distantly displaced from the optical axis @xmath175 . the cyan line is drawn along the theoretically predicted line @xmath176 , which closely predicts the transverse displacement . in this case , the first trailing pulse is displaced from the optical axis by a small amount @xmath177 m , while the second maxima is shifted by an amount @xmath178 m , which is of the order of the rms width .",
    "we have seen that bragg forward scattering gives rise to a sequence of delayed power maxima from temporally short incident radiation .",
    "reference @xcite proposed using the first trailing maximum to seed an fel at hard x - ray wavelengths : an initially short sase pulse generates the radiation `` wake '' depicted in fig .",
    "[ fig:5](b ) that is then used to coherently seed the fel interaction in downstream undulators . in the preceding discussion , we computed the spatiotemporal field profile generated by an initially short and coherent incident pulse ; since sase is temporally incoherent ( chaotic light ) , however , some additional considerations are necessary to determine the relevant radiation seed power .",
    "the longitudinal structure of sase can be well modeled as a sum of gaussian modes that have random temporal positions and phases .",
    "for @xmath179 longitudinal modes , we approximate the sase field as e_(t ) = u(t ) _ j=1^m e^-c^2(t - t_j)^2/4_^2 , [ eqn : incisase ] where @xmath180 is the total envelope of the field determined by the electron beam current and fel gain , @xmath181 are a random set of times , and @xmath182 are a set of random complex amplitudes such that @xmath183 is proportional to the ensemble - averaged sase energy .",
    "the temporal width @xmath89 is dictated by the fel physics while the number of modes @xmath179 is determined by @xmath89 and the characteristic length of the envelope @xmath180 that we denote @xmath184 . assuming that @xmath89 is sufficiently short , the incident pulse generates a trailing electromagnetic field that is merely a sum of @xmath179 wakes discussed previously , with each one beginning at the time @xmath181 and having the relative complex amplitude given by @xmath182 .",
    "first , we consider the case when the duration of the incident sase length @xmath184 is much shorter than the characteristic time - scale of the trailing wake , which is the typical situation for self - seeding of few - fs pulses . in this case , the @xmath179 bragg forward - diffracted beams generated by have the same temporal shape , but differ with random phases and amplitudes . the ensemble - averaged total power in the trailing pulse scales as @xmath179 times the average power in an individual wake .",
    "if we consider the power maxima of , the ratio of the ensemble - averaged power in the first trailing seed to that in the sase is @xmath185 ^ 2 ,          \\label{eqn : pratio }   \\ ] ] where again @xmath186 is the position of the first maxima of @xmath137 with @xmath187 .",
    "the temporal width of each mode and number of modes is dictated by the fel process , and as such will depend on the electron beam quality and profile . in order to get an approximate expression , we use the analytic results that are available for a long electron beam with zero initial energy spread @xcite . in this case , the rms width of a sase mode is related to the fel coherence length @xmath188 by @xmath189 while the number of longitudinal modes for a pulse of total length @xmath184 is @xmath190 ; inserting this into yields ~ l _ l _ ^2 . finally , the sase coherence length generated by an electron beam of vanishing energy spread is l _ = , [ eqn : lcohsase ] where @xmath191 is the number of gain lengths in the upstream undulator . combining and , we have @xmath192 ^ 2   \\nonumber   \\\\    & \\approx 0.0058 \\sqrt{\\frac{n_g}{2\\pi } } \\frac{\\lambda_0 l_{\\text{pulse}}}{6\\rho }      \\left[\\frac{\\pi^2 d}{\\lambda^2\\sin\\theta}\\right]^2 .      \\label{eqn : pratiofin }    \\ ] ] due to the various approximations made",
    ", we only expect to be correct to within a factor of two or so .",
    "nevertheless , this yields a useful estimate and has the appropriate scaling when @xmath184 is much less than the time scale of variation of the forward bragg diffraction signal ; if we use - to eliminate the crystal parameters in favor of the delay , becomes = .",
    "[ eqn : pratioalt ] for example , for the approximate parameters proposed in @xcite for use at the linac coherent light source ( lcls ) , the low charge operation has @xmath193 and after the suggested interaction length we find that @xmath194 ; for a 0.1-mm diamond crystal at an angle @xmath172 , the c(004 ) planes have @xmath195 , and implies that a 1-gw sase pulse would produce a seed whose ensemble - averaged peak power is 2.3 mw ; the same result obtains from for the associated delay @xmath196 fs .",
    "these estimates compare quite favorably with the quoted result of about 2.5 mw @xcite .    to demonstrate the scaling predicted in holds in general ( assuming that @xmath197 ) , we used a simple 1d fel code to generate sase output for several different pulse lengths @xmath184 and over two different number of gain lengths to compute the seeding wake after the monochromator for lcls - type parameters cited above .",
    "we show the results in fig .",
    "[ fig:6 ] , where we scale the seed power with the ratio , so if our results are exact all the lines should overlap with the theory line .",
    "we note that the seed power is correctly predicted within 10% or so , while the delay of the seed increases over that predicted by the theory by an amount approximately equal to @xmath184 .",
    "for short pulses , this shift is a minor correction .     and",
    "@xmath191 listed in the key .",
    "we have used a flat - top electron beam profile to more accurately determine @xmath184 ; more realistic distributions can be expected to yield power deviations from the theory by a factor of two .",
    "the position of the first maximum linearly increases as the pulse duration increases , and therefore varies by a few femtoseconds . ]",
    "the power statistics of the seeding wake are identical to that of a single sase intensity mode / spike , meaning that the effective seed power fluctuates 100% . in the frequency domain , this reflects the fact that the power fluctuations of chaotic light within a bandwidth much less than @xmath198 approach unity .",
    "finally , we wish to make a few statements in the application of bragg forward scattering to the seeding of relatively long pulses . by long pulses , we mean those for which @xmath199 ; for the lcls parameters used herein , this applies for pulses longer than about 10 fs . in this case",
    ", the temporal modes in are spread over a time that is longer than that associated with bragg forward scattering .",
    "thus , we expect that the effective number of modes contributing to the seed amplitude to be @xmath200 . while the peak power in this trailing monochromatic seed is therefore of order that in the short pulse case , one must confront the fact that as the delay @xmath0 is increased to accommodate the longer pulse , the wake is displaced transversely according to @xmath201 .",
    "since a typical fel - produced radiation beam has @xmath202 and @xmath203 to allow variations in the central wavelength , this limits the applicability of this self - seeding scheme to @xmath204 fs .",
    "we have used the dynamical theory of x - ray diffraction to calculate approximate , analytic expressions for both the reflected and forward scattered electric field amplitudes resulting from bragg diffraction of an initially short x - ray pulse incident on a crystal .",
    "both field profiles are characterized by a temporal envelope that oscillates in time @xmath158 , where @xmath205 for the reflected wave while @xmath206 for the forward diffracted field . the delayed output is also displaced transversely by an amount @xmath207 , which can be associated with the coupled wave interaction in the crystal . finally , we used the developed theory to analyze in detail the dynamics of the `` wake monochromator '' as applied to self - seeding for hard x - ray free - electron lasers .",
    "we found simple relationship for the induced delay and output power in terms of the crystal and sase parameters .    in the future we plan to extend this treatment to asymmetrically cut crystals in both bragg and laue scattering geometries , which can be used to analyze the field output generated by temporally short x - ray pulses from a wide variety of x - ray optical elements .",
    "the authors would like to thank a.  a.  zholents in particular and the lcls hard x - ray self - seeding collaboration in general for stimulating interest in this topic and k .- j .",
    "kim for useful discussions .",
    "work supported by u.s .",
    "dept .  of energy office of sciences under contract no",
    ".  de - ac02 - 06ch11357 .",
    "any linear second - order differential operator @xmath208 that is also hyperbolic can be written as acting on the function @xmath209 via ( see , e.g. , @xcite ) ( ) + a + b + c , where @xmath210 are the characteristic coordinates .",
    "we additionally consider the adjoint @xmath211 of the operator @xmath208 , which is defined through the inner product relationship @xmath212 .",
    "this definition implies that @xmath213 can be written as the divergence of a vector function r ( ) - ^(r ) = = + [ eqn : diffadjointdef ] with @xmath214 vanishing at the endpoints .",
    "thus , @xmath211 is completely specified by both the equation and by a set of boundary conditions . ignoring for the moment these boundary conditions",
    ", one can easily show that the differential identity is satisfied if the action of adjoint @xmath211 is given by @xcite ^(r ) r + ( ar ) + ( br ) + cr = 0 , and the components of @xmath215 are @xmath216 riemann s method is obtained by integrating the differential identity over an arbitrary closed region @xmath217 in the @xmath218 plane . using green s identity on the right - hand side",
    ", we find _ d [ r ( ) - ^(r ) ] = _ d , [ eqn : riemannseqn ] where the integration proceeds along the boundary @xmath219 and @xmath220 is its outward - facing normal . now , if we assume that @xmath209 is a solution to @xmath221 , and @xmath222 solves the adjoint equation @xmath223 , then @xmath224 vanishes . by inserting @xmath214",
    ", we have an expression that can be used to find the solution to @xmath225 ( assuming it exists ) in terms of its values along the boundary and the riemann function @xmath222 .    for the problem of bragg scattering , @xmath226 , so that @xmath208 and @xmath211 satisfy the same partial differential equation , and @xmath208 is formally self - adjoint .",
    "now , we can find the solution by determining an appropriate curve @xmath219 and riemann function @xmath222 which , due to the differing boundary conditions , will depend on whether we consider forward or backward scattering . in the latter case ,",
    "the triangle @xmath47 is a convenient choice to obtain the reflected wave @xmath66 at point @xmath85 , which is chosen such that @xmath227 meaning that the solution is given only over the time interval @xmath228 .",
    "if we further assume that the fields @xmath65 , @xmath66 vanish along the line @xmath229 , we can integrate by parts to write it as      here , the riemann function @xmath230 satisfies the adjoint equation associated with the ( formally self - adjoint ) system : r ( , ;  ,  ) = - r ( , ;  ,  ) .",
    "[ eqn : adjointappend ] if @xmath222 additionally satisfies @xmath231 along @xmath44 ( the line @xmath232 ) and @xmath233 along @xmath234 ( when @xmath235 ) , then gives the solution for the reflected wave in terms of the incident wave @xmath236 .",
    "the riemann function that satisfies these requirements and also @xmath237 is @xcite        to determine the equation for the transmitted wave at point @xmath238 on the rear surface of the crystal @xmath46 , we choose the contour @xmath219 to be the parallelogram @xmath48 , which is restricted to @xmath239 to exclude the effects of surface reflections . again assuming that the fields @xmath65 and @xmath66 vanish along the line @xmath229 , can be partially integrated to yield      along the front surface the incident wave @xmath65 is prescribed while the reflected wave @xmath66 is given by . on the other hand ,",
    "the reflected wave @xmath240 vanishes along the rear surface @xmath46 .",
    "thus , to reduce to a closed form solution , we require that the riemann function @xmath241 solving also satisfies the auxilliary conditions @xmath242 the riemann function satisfying the boundary conditions and the adjoint equation associated with the transmitted wave is @xcite"
  ],
  "abstract_text": [
    "<S> free - electron lasers ( fels ) can now generate temporally short , high power x - ray pulses of unprecedented brightness , even though their longitudinal coherence is relatively poor . </S>",
    "<S> the longitudinal coherence can be potentially improved by employing narrow bandwidth x - ray crystal optics , in which case one must also understand how the crystal affects the field profile in time and space . </S>",
    "<S> we frame the dynamical theory of x - ray diffraction as a set of coupled waves in order to derive analytic expressions for the spatiotemporal response of bragg scattering from temporally short incident pulses . </S>",
    "<S> we compute the profiles of both the reflected and forward scattered x - ray pulses , showing that the time delay of the wave @xmath0 is linked to its transverse spatial shift @xmath1 through the simple relationship @xmath2 , where @xmath3 is the grazing angle of incidence to the diffracting planes . </S>",
    "<S> finally , we apply our findings to obtain an analytic description of bragg forward scattering relevant to monochromatically seed hard x - ray fels .    </S>",
    "<S> free - electron lasers ( fels ) based on self - amplified spontaneous emission ( sase ) @xcite are a new source of x - rays whose brightness is many orders of magnitude larger than those of more traditional third - generation synchrotrons . nevertheless , because sase radiation is initialized ( or seeded ) by the shot noise of the electron beam , it comprises many temporal / longitudinal modes @xcite . </S>",
    "<S> the bandwidth of this chaotic light is limited to that of the fel process , which for high - gain fels means that the normalized frequency bandwidth @xmath4 , where @xmath5 is the fel pierce parameter that is typically between @xmath6 and @xmath7 for hard x - ray fels .    while sase fels are limited to @xmath4 </S>",
    "<S> , one can decrease the output bandwidth and increase the longitudinal coherence by seeding the fel with coherent radiation from an external source . for hard x - rays where an external source is not available </S>",
    "<S> , it was proposed that one could improve the longitudinal coherence through self - seeding  by putting the sase light through an x - ray monochromator one can obtain a narrow bandwidth source with which to generate longitudinally coherent fel radiation . the primary difficulty with the scheme proposed in @xcite was that the monochromator delayed the radiation by several picoseconds , which in turn required a long ( @xmath8 m ) magnetic chicane to delay the electron beam by the same amount . </S>",
    "<S> one way of alleviating this is to use two separate electron bunches @xcite .    </S>",
    "<S> recently , an alternative seeding method was proposed @xcite that takes advantage of the time response of bragg forward scattering to generate the seed . in this scheme , </S>",
    "<S> dubbed the `` wake monochromator , '' a single bragg crystal is employed in transmission to generate a delayed , monochromatic signal ( the wake ) that is then used to seed the fel . since the wake follows the sase pulse by @xmath910 fs , a modest chicane is sufficient to induce the required delay in the electron beam . </S>",
    "<S> the physics discussed in @xcite was in terms of a band - stop filter whose sharp spectral feature naturally gave rise to a long , monochromatic temporal signal that was delayed due to causality . </S>",
    "<S> here , we give a more thorough analysis of the process , obtaining analytic expressions for the spatiotemporal shape and power of the monochromatic wake generated by an incident sase pulse .    the temporal dependence of x - ray bragg diffraction in crystals has been studied previously in several publications @xcite by fourier transforming the frequency domain bragg diffraction amplitudes , which are well - known from the classical dynamical theory of x - ray diffraction @xcite . here </S>",
    "<S> , our focus is on the spatiotemporal dynamics that play an essential role in the efficacy of the fel self - seeding . for this reason </S>",
    "<S> , the problem is solved directly in time and space using a system of space - time coupled wave equations .    </S>",
    "<S> we begin sec .  </S>",
    "<S> [ sec : braggscatter ] by deriving the coupled wave system relevant to symmetric bragg scattering , and subsequently solve for the field profiles in both reflection and transmission . </S>",
    "<S> we show that the temporal profile consists of a sequence of power maxima whose location depends on the crystal extinction length @xmath10 and grazing incidence angle @xmath3 in reflection , while in transmission the time delay also varies inversely with the crystal thickness @xmath11 . in addition , the profiles are displaced along the transverse direction @xmath12 by an amount proportional to the delay @xmath0 : @xmath13 . </S>",
    "<S> finally , we use some well - known fel physics to apply the theory of forward scattering to the fel self - seeding scheme , obtaining analytic results associated with the wake monochromator of ref .  @xcite . </S>"
  ]
}