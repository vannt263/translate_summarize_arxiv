{
  "article_text": [
    "many superconducting quantum circuits rely on microwave photons to measure or couple quantum systems , such as superconducting qubits or micro - mechanical resonators@xcite .",
    "the ability to process microwave fields with minimal degradation is crucial to the observation of truly quantum behavior .",
    "for example , quantum - limited amplification maximizes measurement fidelity , a crucial metric in quantum computing @xcite , quantum feedback @xcite , observation of quantum trajectories @xcite , and position measurements @xcite .",
    "similarly , the efficient routing of microwave photons enables long distance entanglement @xcite and is an important tool in proposals for quantum networks @xcite .",
    "recent developments in josephson junction - based parametric amplifiers have led to an order of magnitude improvement in measurement efficiency compared to commercially available high - electron - mobility transistor ( hemt ) amplifiers @xcite . however , these amplifiers are _ reciprocal _ devices , _",
    "i.e. _ , their scattering parameter amplitudes are symmetric under the exchange of source and detector @xcite . as a consequence , in order to protect the device - under - test ( dut ) from amplifier backaction and to control signal flow , they require the use of microwave circulators to separate input signals from amplified output onto different physical ports .",
    "these components drastically reduce quantum measurement efficiencies @xcite .",
    "in addition to their intrinsic loss , circulators are relatively large and require large dc magnetic fields , preventing direct integration into modern superconducting circuits .",
    "the limitations outlined above have motivated the development of nonreciprocal , non - magnetic , lossless circuits @xcite .",
    "many of these approaches seek to provide highly efficient routing or amplification solutions that can be tightly integrated with superconducting circuits .",
    "for example , josephson traveling - wave parametric amplifiers were specifically designed to achieve high directional gain over several gigahertz of bandwidth , with a large dynamic range @xcite . in this work",
    "we demonstrate a wider range of nonreciprocal behavior , using parametrically coupled multi - mode circuits to build an interferometer in frequency space@xcite . due to the directional phase shift inherent to parametric",
    "interaction , different interferences occur in the forward and backward directions .",
    "complex networks of coupled modes can be programmed _ in situ _ by choosing a set of applied parametric microwave drives , leading to a variety of nonreciprocal scattering parameters .",
    "the versatility of this approach was recently demonstrated in a josephson parametric converter @xcite . in this work we present a alternative circuit design , based on lumped - element niobium components coupled via a single gradiometric squid , insensitive to flux noise .",
    "experimental measurements of both the scattering parameters and noise performance show quantitative agreement with theoretical calculations .",
    "here we focus on cases in which two or three modes are coupled and demonstrate four basic functions : frequency conversion , circulation , phase - preserving amplification , and directional phase - preserving amplification . in the following",
    "we discuss the device and measurement setup and then describe each mode of operation .",
    "detailed calculations , noise calibrations , and device fabrication details are given in appendices .    ,",
    "@xmath9 and @xmath10 , as a function of the flux bias to the squid .",
    "( c ) table of device parameters for @xmath11 , showing the resonance frequency @xmath12 , total linewidth @xmath13 , and coupling efficiency @xmath14 of each mode @xmath15 .",
    "[ figsetup ] ]",
    "the device shown in fig . [ figsetup ] consists of three lumped - element resonant circuits in parallel connected to a single squid",
    ". the squid acts as a tunable linear inductor that can be modulated at microwave frequencies .",
    "the device is mounted in a dilution refrigerator and measured in reflection , see fig .",
    "[ figsetup](a ) .",
    "the scattering parameters are measured using a vector network analyzer with a frequency conversion option .",
    "a separate broadband pump line is used to thread flux through the squid loop .",
    "the circuit exhibits three resonances at frequencies , @xmath16 , @xmath9 and @xmath10 .",
    "each of these resonances shows a dependence on the squid inductance which is in turn modulated by the applied squid flux @xmath17 , as shown in fig .",
    "[ figsetup](b ) .",
    "the circuit components were designed to place all three resonances within the @xmath18 to @xmath19 band , while ensuring that all the possible frequency combinations @xmath20 , where @xmath21 , are well separated a critical property for well - controlled parametric interactions ( see appendix b ) .",
    "coupling capacitors to ground and to the @xmath22 environment set the external coupling rates to the single measurement line , @xmath23 .",
    "the use of a low - loss dielectric for the capacitors ( amorphous silicon , loss tangent @xmath24 ) ensures that these rates exceed the internal loss rates @xmath25 by more than an order of magnitude and dominate the total linewidths @xmath26 . in the following",
    "we will fix the dc flux bias to @xmath11 , where @xmath27 is a flux quantum , and the measured frequencies and linewidths are summarized in fig . [",
    "figsetup](c ) .",
    "currents from the three resonators of the fpja flow through the squid , effectively linearly coupling their dynamics .",
    "these dynamics occur at vastly different frequencies , and to first order can be treated independently .",
    "however , the modulation of the coupling element , here the squid inductance , can lead to parametric coupling between the resonators @xcite , as discussed in appendix b. in presence of such a _ pump _ , the time - dependent coupling strength between modes @xmath15 and @xmath28 is @xmath29 where @xmath30 is the flux modulation with an amplitude @xmath31 , a frequency @xmath32 and phase @xmath33 .",
    "the coupling term in the hamiltonian of the system depends on the modulation frequency .",
    "in particular the pump can mediate two kinds of parametric coupling between two modes . for pump frequencies of the form @xmath34 , where @xmath35 , the creation or annihilation of a pump photon enables the coherent exchange of a photon between modes @xmath15 and @xmath28 , leading to frequency conversion . for pump frequencies of the form @xmath36",
    ", the annihilation of a pump photon creates a correlated pair of photons in modes @xmath15 and @xmath28 , leading to amplification .",
    "importantly , multiple pumps can be simultaneously applied to program an arbitrary set of coupling terms between the modes .",
    "a network of modes and couplings can be built , defining the behavior of the circuit .",
    "we utilize a graph - based analysis @xcite that emphasizes the topology of the coupling network , which is crucial to build intuition and leading to a good agreement with the data .",
    "the general methodology consists in solving the heisenberg - langevin coupled equations of motions ( eoms ) of the circuit , for a given pump configuration . using input - output formalism we calculate the scattering parameters and the output noise of the system .",
    "detailed calculation are available in appendix b.       converts an input signal at the frequency @xmath37 to a output signal frequency @xmath38 , and vice versa .",
    "( b ) graph representation of the eom [ eq : eom_fc ] .",
    "( c ) ideal signal flow diagram .",
    "( d ) measured scattering parameters ( dots ) and fits to eq .",
    "[ eq : eom_fc ] ( lines ) , for a fixed pump strength @xmath39 , as a function of the detuning @xmath40 . the device exhibits good impedance matching ( low return loss ) , and near unity transmission .",
    "[ figfc ] ]    we start with the first building block : frequency conversion between two modes , here chosen to be @xmath41 and @xmath42 .",
    "we modulate the flux through the squid with a pump at a frequency @xmath43 .",
    "an input signal of amplitude @xmath44 , driving the mode amplitude @xmath41 at a frequency @xmath45 , is coupled to the mode amplitude @xmath42 , leading to an output signal of amplitude @xmath46 at a frequency @xmath47 , and vice versa ( see fig .",
    "[ figfc](a ) ) .",
    "the eoms in the signal frame reduce to @xmath48 with @xmath49 the normalized detuning for mode @xmath50 and @xmath51 the normalized coupling between the mode amplitudes @xmath41 and @xmath42 .",
    "importantly , this coupling term is complex , with its phase @xmath52 and amplitude @xmath53 inherited from the pump . we show in fig . [",
    "figfc](b ) a graph representation of the eoms in eq .",
    "[ eq : eom_fc ] , where vertices represent the mode amplitude and arrows represent the detuning and coupling terms . in the ideal resonant case , defined as @xmath54 and @xmath55 , and neglecting internal loss , @xmath56 , the scattering matrix @xmath57 for the system is @xmath58    close examination of the scattering matrix reveals that unity transmission coincides with impedance matching ( zero reflection ) at @xmath59 , and the corresponding signal flow diagram @xcite is shown in fig . [",
    "figfc](c ) .",
    "we note here that @xmath60 , navely providing gyration .",
    "while this will be crucial later for establishing directionality , on its own this is not unconditionally nonreciprocal due to an ambiguity in the reference frame when describing scattering between two different frequency modes@xcite .",
    "the measured scattering parameters in our device are shown in fig .",
    "[ figfc](d ) as a function of the detuning @xmath61 .",
    "we fit the measured response using the full solutions of eq .",
    "[ eq : eom_fc ] , finding very good agreement with the data .",
    "in particular , we measure only @xmath62 of insertion loss , fully captured by including the internal loss of the resonators so that @xmath63 ( see appendix b ) .",
    "the circuit is well matched , with @xmath64 of return loss .",
    "the bandwidth of conversion is @xmath65 .",
    "we now describe the second building block : amplification between two modes , here chosen to be @xmath41 and @xmath42 .",
    "we modulate the flux through the squid with a pump at the sum frequency @xmath66 .",
    "an input signal at a frequency @xmath45 is amplified and generates an idler at @xmath67 ( see fig . [ figpa](a ) ) .",
    "in contrast with the frequency conversion case in eq .",
    "[ eq : eom_fc ] the dynamics of the mode amplitude @xmath41 are now coupled to the conjugated mode amplitude @xmath68 and the eoms in the signal frame reduce to    @xmath69    with @xmath49 and @xmath70 . again , when comparing with the frequency conversion case , one can notice the sign change for the detuning term and the coupling term in the equation for @xmath68 .",
    "these subtle differences lead to a very different scattering matrix @xmath57 , which in the ideal resonant case ( @xmath71 and @xmath55 ) , and neglecting internal loss ( @xmath56 ) , is    @xmath72    close examination of the scattering matrix in eq .",
    "[ eq : s_pa_0 ] reveals a divergence for @xmath59 , in stark contrast with the frequency conversion case ( eq . [ eq : s_fc_0 ] ) . in the limit @xmath73",
    "each scattering parameter has an amplitude gain related to @xmath74 , and the full signal flow is shown in fig .",
    "[ figpa](c ) . as in the frequency conversion case , note that @xmath75 . in fig .",
    "[ figpa](d ) we show the measured scattering parameters for various values of @xmath76 , _",
    "i.e. _ , for various pump powers .",
    "as @xmath76 increases , so does the gain , at the expense of a typical reduction in linewidth @xcite .",
    "good agreement is found with a fit to the solutions of eq .",
    "[ eq : eom_pa ] .    the noise performance of the amplifier is shown in fig .",
    "[ figpa](e ) . in a separate experiment we calibrated an upper bound for the system added noise of the measurement setup at the reference plane of the fpja , as explained in detail in appendix c. when the fpja is operated as an amplifier we measure a noise rise , and the knowledge of the noise floor in photon units allows us to extract the system added noise referred to the input of the fpja . for @xmath77 ,",
    "we observe a slight degradation of the system added noise due to the internal loss of the resonators , up to @xmath78 at @xmath16 and @xmath79 at @xmath9 . as the gain increases , the noise contribution of the measurement chain is overwhelmed and the system added noise decreases , down to @xmath80 at @xmath16 and @xmath9 , approaching the standard quantum limit ( sql ) of @xmath81 .",
    "the system added noise plateaus at high gain , remaining slightly above the sql .",
    "this could originate from excess thermal population of the resonators , potential excess loss in the fpja packaging or simply from an offset in the reference plane of the noise calibration .          by connecting all three resonators via frequency conversion",
    ", we can build the first nontrivial mode of operation : the circulator . using three pumps",
    ", we modulate the flux through the squid at the difference frequencies @xmath82 , where @xmath83 , satisfying the condition @xmath84 ( see fig .",
    "[ figcirculator](a ) ) .",
    "effectively , this forms a closed loop in frequency space connecting input and output signals at @xmath85 , where @xmath86 .",
    "the eoms in the signal frame reduce to :    @xmath87    with @xmath88 and @xmath89 , where @xmath83 .",
    "the graph representation of this equation is shown in fig . [ figcirculator](b ) .",
    "this loop topology is at the heart of the nonreciprocal behavior of this mode of operation . indeed , by closing this loop",
    "we build an interferometer , where the phase shift in each arm is direction dependent .",
    "the interference is controlled by the loop phase @xmath90 , where @xmath33 is the phase of the pump connecting modes @xmath50 and @xmath91 . in the ideal resonant case @xmath92 and @xmath55 ,",
    "neglecting internal loss , tuning each coupling strength to produce ideal frequency conversion ( @xmath93 ) , and for @xmath94 , the scattering matrix @xmath57 for the system is    @xmath95    in this case the system is matched , with @xmath96 , and nonreciprocal , @xmath97 , corresponding to the signal flow diagram in fig . [",
    "figcirculator](c ) .",
    "an input signal in mode @xmath41 circulates to mode @xmath42 then @xmath98 . the direction of circulation is controlled by the loop phase and can be reversed by setting @xmath99 .",
    "experimentally we start by tuning the pumps to produce ideal frequency conversion between each pair of modes separately , and then simultaneously turn on all three pumps .",
    "the measured scattering parameters for @xmath94 are shown in fig .",
    "[ figcirculator](d ) . the full dependence with the loop phase @xmath100 is shown in fig .",
    "[ figsicirculator ] .",
    "very good agreement is obtained with solutions of eq .",
    "[ eq : eom_circ ] . with return loss exceeding 20",
    "db the device exhibits excellent impedance match at all three modes .",
    "we measure a transmission efficiency of more than @xmath0 and an isolation exceeding @xmath101 over a @xmath102 bandwidth .",
    "a transmission efficiency of more than @xmath103 and an isolation exceeding @xmath104 is maintained over a @xmath105 bandwidth .",
    "when operated as a two - mode amplifier the fpja is non - directional ( see fig .",
    "[ figpa ] ) , and requires a circulator to separate the input and output signals . in this section we circumvent this requirement by operating the fpja as a directional amplifier .",
    "using three pumps , we modulate the flux through the squid at frequencies @xmath106 , @xmath107 and @xmath108 , satisfying the overall loop closure condition @xmath109 ( see fig . [ figdelta](a ) ) .",
    "this corresponds to simultaneously connecting modes @xmath41 and @xmath98 via frequency conversion , while connecting modes @xmath41 and @xmath42 and modes @xmath42 and @xmath98 via amplification , forming a loop in frequency space .",
    "the resulting eoms are    @xmath110    the graph representation of these eoms is shown in fig .",
    "[ figdelta](b ) .",
    "similarly to the circulator case , the loop phase @xmath111 controls the direction of the amplification . in the ideal resonant case , neglecting internal loss , tuning the coupling strength to produce ideal frequency conversion between modes @xmath41 and @xmath98 , @xmath93 , for symmetric amplification coupling strength @xmath112 , and for @xmath94 , the scattering matrix @xmath57 is    @xmath113    where @xmath114 . in this configuration ,",
    "mode @xmath41 serves as the input port and is impedance matched ( no reflection ) .",
    "an input signal is amplified toward both output modes @xmath42 and @xmath98 . the amplified signal at each output is added to the amplified vacuum seeded into mode @xmath42 , resulting in the same minimum system added noise as for a standard two - mode amplifier . finally , vacuum noise seeded into mode @xmath98 is routed to mode @xmath41 with unity gain .",
    "the measured scattering parameters for @xmath99 are shown in fig . [ figdelta](d ) . the full dependence with the loop phase @xmath100 is shown in fig .",
    "[ figsidelta ] .",
    "good agreement is obtained with numerical solutions of eq .",
    "[ eq : eom_delta ] .",
    "we obtain a forward gain of @xmath115 while maintaining good impedance matching ( return loss in excess of @xmath104 ) and isolation ( in excess of @xmath116 ) .",
    "the noise performances are shown in fig .",
    "[ figdelta ] ( e ) , ( f ) and ( g ) , corresponding to the respective output of mode @xmath41 , @xmath42 and @xmath98 .",
    "the system added noise measured at the output of mode @xmath42 and @xmath98 , referred to the input of mode @xmath41 , approaches the quantum limit with @xmath117 .",
    "moreover , due to the directionality of the amplifier , we do not observe any noise rise at the output of mode @xmath41 , and therefore do not expect any backaction on a future dut a crucial property for the integrated measurement of a microwave quantum system .",
    "we have demonstrated the ability to program _ in situ _ a low - loss superconducting device to perform reciprocal and nonreciprocal analog microwave signal processing close to the quantum limit .",
    "this technology is compatible with most superconducting quantum computation systems , opening the way to full integrability and scalability .",
    "finally , we emphasize that we have shown here only a small subset of all the possible networks of parametrically coupled modes .",
    "other networks , using three or more modes , could for eample lead to phase sensitive directional amplification , or alleviate the gain - bandwidth product .",
    "we note that it would be straightforward to design a circuit with bare resonance frequencies placed between @xmath118 and @xmath119 and with linewidths individually set between @xmath120 and @xmath121 .",
    "finally , routing the different mode frequencies to separate physical ports relies simply on the design of a low - loss on - chip microwave multiplexer , directly compatible with the device fabrication .",
    "this work was supported by the nist quantum information program .",
    "this article is a contribution of the u.s .",
    "government , not subject to copyright .",
    "the device is fabricated with optical lithography by using a nb / al - alo@xmath8/nb trilayer process to form josephson junctions , and by utilizing amorphous silicon ( a - si ) as a low - loss interlayer dielectric .",
    "the circuit layout and pictures are shown in fig .",
    "[ figsidevice ] .",
    "the device fabrication is summarized in fig .",
    "[ figsidevice](c ) :    * a nb / al - alo@xmath8/nb trilayer is prepared on a high - resistivity intrinsic silicon wafer ( @xmath122 ) by subsequently sputtering a @xmath123 @xmath124 layer ( red ) , a @xmath125 @xmath126 layer which is then oxidized to form a tunnel barrier ( black ) , and finally a @xmath127 @xmath124 ( yellow ) .",
    "the preparation of the trilayer is performed _ in situ _ in a sputtering deposition tool without breaking vacuum . *",
    "the trilayer is patterned top - down in three iterations of optical lithography followed by material etching .",
    "first , the josephson junctions ( jj ) areas are defined by etching the top nb layer ( yellow ) using a vertical plasma etch ( sf@xmath128/o@xmath129 ) .",
    "second , the excess al - alox ( black ) is removed away from the junctions by a wet etch ( mf-26a , which is also the optical resist developer ) .",
    "finally , we define the bottom wiring layer in nb ( red ) using a sloped plasma etch ( cf@xmath130/o@xmath129 ) . *",
    "the josephson junctions and bottom wiring layer are covered by a @xmath131 amorphous silicon layer ( a - si ) deposited by plasma enhanced chemical vapor deposition ( pecvd ) .",
    "vias are then defined by etching into the a - si layer using a sloped plasma etch ( sf@xmath128/o@xmath129 ) . * after an in situ rf clean , a @xmath131 @xmath124 layer is sputtered and patterned by a vertical plasma etch ( sf@xmath128 ) to define the top wiring layer ( blue ) .",
    "this etch also removes any uncovered a - si .",
    "the properties of the a - si were characterized by independent measurements of lumped - element lc resonators fabricated on the same wafer than the fpja , yielding a relatively high dielectric constant ( @xmath132 ) and low loss tangent ( @xmath133@xmath134 ) .",
    "this allows for the design of compact and low - loss lumped - element capacitor and inductors .",
    "the josephson junctions have an area of @xmath135 , and the oxidation parameters lead to a critical current @xmath136 per junction .",
    "the squid loop has a gradiometric design , first - order insensitive to magnetic fields .",
    "the design of the device is based on a circuit with three discrete poles , each tunable by a single squid inductance .",
    "this is achieved here by connecting three lc resonators in parallel ( @xmath137 , @xmath138 and @xmath139 ) , as shown in fig .",
    "[ figsidevice ] .",
    "alternatively this device can be understood as two lc resonators , @xmath138 and @xmath139 , coupled via a resonant coupling element ( formed by the squid shunted by @xmath140 ) .",
    "the resonances of this circuit , denoted @xmath41 , @xmath42 and @xmath98 , tune with the squid flux , as shown in fig .",
    "[ figsetup ] . throughout this work we use the squid as a tunable linear coupling element , neglecting the intrinsic non - linearity of the squid . to understand the origin of the bilinear coupling between the three modes",
    ", one can consider the energy stored in the squid , @xmath141 .",
    "for each mode @xmath15 , a fraction @xmath142 of the mode current @xmath143 flows through the squid such that @xmath144 .",
    "this results in @xmath145 , effectively producing linear coupling of modes @xmath15 and @xmath28 .",
    "in this section we describe our approach to solving the equations of motion ( eoms ) for a system of parametrically coupled modes .",
    "we aim at deriving the resulting scattering parameters ( section b.1 to b.4 ) and output noise ( section b.5 ) .",
    "we begin with the case of a single damped and driven oscillator to introduce the concepts and our notation .",
    "we then describe the building blocks of parametric physics , namely frequency conversion and amplification between two modes .",
    "combining these processes in three - mode systems allows us to describe the circulator and directional amplifier .",
    "we largely reproduce concepts and style from ranzani and aumentado @xcite , with minor changes of notation and normalization .",
    "the hamiltonian for a driven harmonic oscillator with resonant frequency @xmath16 and loss rate @xmath146 , after tracing over bath modes in the rotating wave approximation , is @xmath147 where @xmath148 is the external coupling to the drive port , and @xmath149 and @xmath150 are the time - dependent annihilation operators for the internal mode and input drive respectively . to simplify the notation we choose ( 1 ) to include the loss as an imaginary component of the resonant frequency , making the hamiltonian non - hermitian and ( 2 ) to have the phase quadrature of the drive coupled to the amplitude quadrature of the internal mode .",
    "note that to preserve quantum commutators , eq .",
    "[ eq : h_ho ] needs an extra noise input term proportional to @xmath151 so that @xmath152 ( see section b.4 ) .",
    "the heisenberg - langevin eom is @xmath153 $ ] . to analyze the eom",
    ", we consider an input signal at the signal frequency @xmath154 and move to a rotating frame at that frequency by defining new annihilation operators @xmath155 , and @xmath156 , so that @xmath149 and @xmath150 are time - independent in this frame .",
    "additionally , we will study the dynamics of the expectation values , defining @xmath157 .",
    "the equation of motion reads @xmath158 where @xmath159 is a normalized complex detuning parameter . in the above",
    "we have applied the rotating wave approximation ( rwa ) , neglecting a term with explicit time - dependence in the signal frame .",
    "we assume that the frequency of this term , @xmath160 , is much larger than the relevant linewidth of the oscillator , @xmath146 , so that the susceptibility , @xmath161 , at those frequencies is small enough to not cause any appreciable dynamics .    to introduce the graph representation that we will use in the following cases , fig .",
    "[ figsitheory](c ) shows the graph corresponding to the single - oscillator eom  .",
    "it consists of a single vertex for the mode amplitude @xmath41 , with a _ self - loop _ associated with the complex detuning @xmath162 .",
    "the output field at the signal frequency @xmath45 is obtained via the input - output relation @xmath163 , finally leading to the familiar lorentzian form of the reflection coefficient : @xmath164      let us now consider two oscillators with resonant frequencies @xmath16 and @xmath9 , loss rates @xmath146 and @xmath165 , and a time - dependent coupling rate @xmath166 .",
    "the hamiltonian of the system is @xmath167 where @xmath148 and @xmath168 are the coupling rates to the external port , and @xmath149 , @xmath169 , @xmath150 and @xmath170 are the time - dependent annihilation operators for the internal mode and input drives for each oscillator , respectively .",
    "we consider the oscillators to be driven at the frequencies @xmath154 and @xmath171 , related to each other by the pump frequency of @xmath172 .",
    "we move to a co - rotating frame , and define new ( time - independent ) annihilation operators @xmath155 , @xmath173 , @xmath156 , and @xmath174 .    in the case of resonant coupling",
    ", @xmath175 is time - independent , so @xmath176 . in this case , if the two oscillators are detuned from one another ( @xmath177 ) , then the large detuning ( small susceptibility ) prevents appreciable energy transfer between the oscillators .",
    "if the pump frequency is near the sum or difference of the two resonant frequencies , however , then both detunings can be small ( with corresponding large susceptibility ) to allow energy transfer between the two oscillators .",
    "when @xmath178 , a pump photon can bridge the energy gap between the two oscillators allowing for frequency conversion .",
    "when @xmath179 , a pump photon can be down - converted into a photon in each oscillator , amplifying each oscillator s amplitude .",
    "[ [ frequency - conversion ] ] frequency conversion + + + + + + + + + + + + + + + + + + + +    consider the case where the coupling term is modulated near the difference frequency @xmath178 . to simplify notation ,",
    "let us choose @xmath180 , such that @xmath181 .",
    "the eoms after the rwa become @xmath182 where @xmath49 are normalized complex detunings , and @xmath183 is the normalized complex coupling between the mode amplitudes @xmath41 and @xmath42 .",
    "when working with multiple modes it becomes useful to adopt a matrix representation of these equations .",
    "we define a vector of intra - cavity mode amplitudes @xmath184 , input mode amplitudes @xmath185 , output mode amplitudes @xmath186 , diagonal matrices for the total loss rates @xmath187 , and external couplings @xmath188 , and finally the mode - coupling matrix @xmath189 so that eq .",
    "become @xmath190 , where @xmath191    the graph representation of the mode - coupling matrix @xmath189 is shown in fig .",
    "[ figsitheory](d ) .",
    "each vertex corresponds to a mode amplitude , with self - loops associated with the complex detuning @xmath192 .",
    "the vertices are connected by coupling edges associated with the coupling terms @xmath193 and @xmath194 .",
    "we can solve these eoms to calculate the scattering matrix @xmath195 , resulting in @xmath196 where we introduce the matrix @xmath197 , where @xmath198 are coupling efficiency parameters characterizing the degree to which each mode is overcoupled . expanding eq .",
    "results in @xmath199 on resonance ( @xmath200 ) and neglecting internal loss ( @xmath201 ) one recovers eq .  :",
    "@xmath202 unity transmission coincides with impedance matching ( zero reflection ) for @xmath59 .",
    "note that when @xmath193 is complex , @xmath203 ( although @xmath204 ) .",
    "however , for modes at different frequencies , the phase shift between @xmath205 and @xmath206 must be measured relative to some reference whose phase is arbitrary . in a two - mode system , there can always be found a reference phase such that @xmath193 is real and @xmath57 is reciprocal .",
    "yet , the phase dependence of @xmath57 will become crucial when discussing three - mode systems , in which the phase reference is built into the system .",
    "finally , note that for resonant coupling , where @xmath193 is required to be real , the scattering matrix is unambiguously reciprocal .    [ [ parametric - amplification ] ] parametric amplification + + + + + + + + + + + + + + + + + + + + + + + +    we now consider the case where the coupling is modulated near the sum frequency @xmath179 , such that @xmath207 .",
    "the eoms after applying the rwa become @xmath208 or , in matrix form @xmath190 , where @xmath209 and @xmath210 , @xmath211 , @xmath212 . here",
    "note that for parametric amplification @xmath70 , where the sign of the phase comes from the convention in eq .",
    "[ eq : h_2modes ] .",
    "the corresponding graph representation is shown in fig .",
    "[ figsitheory](b ) .",
    "when comparing to the eoms for frequency conversion , one notices three differences : ( 1 ) the mode amplitude @xmath41 is now coupled to the conjugate mode amplitude @xmath213 , ( 2 ) the complex detuning term for the conjugate mode is conjugated and with a minus sign , and ( 3 ) the coupling term for the conjugate mode has a minus sign .",
    "these subtle differences lead to the following scattering matrix : @xmath214 on resonance ( @xmath215 ) and neglecting internal loss ( @xmath216 ) we recover eq .  : @xmath217 the scattering parameters diverge for @xmath59 , in stark contrast with the frequency conversion case . in the limit",
    "@xmath73 each scattering parameter has an amplitude gain , @xmath74 .",
    "similar to the frequency conversion case , we observe @xmath218 for @xmath193 complex .",
    "parametric frequency conversion and parametric amplification are the building blocks from which we can construct complex coupled - mode networks .",
    "both processes exhibit a directional phase shift , which is the first ingredient to build nonreciprocal devices like isolators and circulators .",
    "the second ingredient required is an interferometer to unambiguously define the reference phase . here",
    "we will build such an interferometer in frequency space by parametrically coupling three modes to form a loop .",
    "we will use the matrix formalism and its graph counterpart , which become very useful when extending the mode basis to three or more modes .",
    "indeed , the coupling network is well captured by the mode - coupling matrix @xmath189 alone .",
    "let us now consider three oscillators with resonant frequencies @xmath219 and loss rates @xmath13 , driven at the signal frequencies @xmath85 , for @xmath220 .    [ [ circulation ] ] circulation +",
    "+ + + + + + + + + +    to build a circulator we will connect these three modes via frequency conversion .",
    "for that , we simultaneously modulate the coupling between the modes at the difference frequencies @xmath178 , @xmath221 , and @xmath222 , satisfying the condition @xmath84 . the resulting equations of motion for the internal modes @xmath223 are described by the mode - coupling matrix @xmath224 where @xmath49 is the complex detuning for mode @xmath15 , and @xmath89 is the normalized coupling between the modes @xmath15 and @xmath28 .",
    "the graph representation of this langevin matrix is shown in fig .",
    "[ figsitheory](e ) , which highlights the loop structure of the coupling network .",
    "each pair of modes is now coupled via two different paths .",
    "this leads to interferences , controlled by the loop phase @xmath90 . solving for the scattering matrix using eq .",
    "we obtain    @xmath225    where @xmath226 .",
    "importantly , compared to the two - mode cases , the _ magnitudes _ of the scattering parameters are now nonreciprocal , @xmath227 . maximum isolation from mode @xmath42 to mode @xmath41 ( @xmath228 ) is achieved for @xmath229 . on resonance ( @xmath230 ) and neglecting internal loss ( @xmath201 ) , this condition coincides with unity transmission from @xmath41 to @xmath42 , @xmath231 for @xmath232 and for a loop phase @xmath94 . setting @xmath233 ,",
    "one recovers the ideal circulator scattering matrix from eq .  :",
    "@xmath234    in fig .",
    "[ figsicirculator ] we show the measured and simulated scattering parameters as a function of the total loop phase @xmath100 for the fpja operating as a circulator . excellent agreement is found between data and theory . for the opposite loop phase @xmath99 , the direction of circulation is reversed .",
    "[ [ directional - phase - preserving - amplification ] ] directional phase - preserving amplification + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to build a directional amplifier we will connect two pairs of modes via amplification and close the interferometer using frequency conversion . for that",
    ", we simultaneously modulate the coupling between the modes at the frequencies @xmath235 , @xmath236 , and @xmath237 , satisfying the condition @xmath109 .",
    "the resulting equations of motion for the internal modes @xmath238 are described by the matrix @xmath239 the detuning and coupling terms for the frequency conversion and amplification processes are defined using the same convention than in the two - mode cases , with @xmath49 , @xmath240 and @xmath241 , where @xmath242 . the graph representation of this mode - coupling matrix is shown in fig .",
    "[ figsitheory](f ) , forming again an interferometer . solving for the scattering matrix using eq .",
    "we obtain    @xmath243    where @xmath244 and @xmath111 .",
    "similar to the circulation case , the _ magnitude _ of the scattering parameters are nonreciprocal .",
    "the condition for maximum isolation from port @xmath42 to port @xmath41 , @xmath228 , is achieved for @xmath245 . on resonance",
    ", this condition leads to a loop phase @xmath94 .",
    "we further neglect internal loss and require an input match @xmath246 on resonance , which can be accomplished by choosing the matching condition for the frequency conversion branch ( @xmath247 ) and letting the two amplification branches be equal @xmath112 .",
    "to fix the phases of the scattering matrix elements , we choose @xmath248 to arrive at the scattering matrix of eq .  :",
    "@xmath249 where @xmath250 .",
    "let s consider a coherent signal at the input of mode @xmath41 , while modes @xmath42 and @xmath98 are seeded by vacuum fluctuations .",
    "both the signal in mode @xmath41 and the vacuum fluctuations in mode @xmath42 are amplified towards modes @xmath42 and @xmath98 .",
    "this leads to the same minimum system noise as a standard two - mode amplifier .",
    "finally , the vacuum fluctuations in @xmath98 are routed to mode @xmath41 with unity gain .",
    "the measured and simulated scattering parameters as a function of the total loop phase @xmath100 for fpja operation as a directional amplifier are shown in fig .",
    "[ figsidelta ] .",
    "excellent agreement is found between data and theory for @xmath251 . for @xmath252 degrees",
    "the system undergoes free oscillations . while for a two - mode amplifier ( see eq .",
    "[ eq : s_pa ] ) the free oscillation threshold is simply @xmath59 , the threshold for a three - mode directional amplifier becomes phase dependent .",
    "a general method to calculate if the system will free oscillate is to look for signal frequencies solutions of @xmath253 and with a positive imaginary part .          in this section",
    "we generalize the formalism to include multiple input ports for each mode , crucial for accurate noise calculation in next section .    in section b.1 to b.3",
    "we have considered each mode @xmath15 to be coupled to a single external port and accounted for internal loss using the coupling efficiency parameter @xmath254 .",
    "this is sufficient for calculating the scattering parameters between the external ports of interest .",
    "however , to describe system with multiple external ( or internal ) ports per mode , and to reach accurate noise calculations , one need to generalize this formalism .",
    "intuitively , if a fraction of the input signal can be lost in the environment , then , conversely , noise from this environment enters the system . in other word , in order to preserve the commutators of the input and output fields , one must account for all the ports contributing to the total loss rates of each mode .    the generalization to multiple ports per mode consist in a straightforward redefinition of the input and ouput field , @xmath255 and @xmath256 , and of the matrix @xmath257 .",
    "note that because the network of coupled internal modes stays unchanged , so does the mode - coupling matrix @xmath189 .",
    "each mode @xmath15 can be coupled to multiple ports ( which can include `` ports '' to the thermal environment ) , so that @xmath258 , where @xmath28 indexes all ports to which mode @xmath15 is coupled . for a system of @xmath259 modes coupled to a total of @xmath260 ports , @xmath255 and @xmath256 become vectors of length @xmath260",
    ", @xmath257 becomes a matrix of size @xmath261 where @xmath262 , and @xmath189 remains a matrix of size @xmath263 .",
    "the condition @xmath264 ensures that all noise sources are accounted for .",
    ".   becomes @xmath265    as an example , we consider the directional amplifier shown in b.3.a and include a single additional port per mode to describe the coupling to the environment at a rate @xmath266 , so that @xmath267 .",
    "we define the input field as @xmath268 where @xmath269 is the input field for the environment of mode @xmath15 .",
    "similarly we define @xmath270 .",
    "the matrix @xmath257 becomes : @xmath271      in this section we use the generalized scattering parameters ( eq .",
    "[ eq : s_gen ] ) to calculate the output noise of a system of parametrically coupled mode .",
    "the quantum noise spectral density of the output fields @xcite , @xmath272 $ ] , is defined as @xmath273\\delta(\\omega-\\omega ' ) = \\left<\\mathbf{a}_\\text{out}^\\dagger[\\omega]\\mathbf{a}_\\text{out}^t[\\omega']\\right > ,",
    "\\label{eq : psdfromcov}\\ ] ]    where @xmath274\\mathbf{a}_\\text{out}^t[\\omega']\\right>/2\\pi \\delta(\\omega-\\omega')$ ] is the covariance matrix of the output field , in units of photons .",
    "one can then express the spectral density of the output field using eq .",
    "[ eq : psdfromcov ] and the relation between input and output covariance matrices : @xmath275\\mathbf{a}_\\text{out}^t[\\omega]\\right > = \\mathbf{s}^*[\\omega']\\left<\\mathbf{a}_\\text{in}^\\dagger[\\omega']\\mathbf{a}_\\text{in}^t[\\omega]\\right > \\mathbf{s}^t[\\omega ] .",
    "\\label{eq : s_cov}\\ ] ]    the input covariance matrix contains all information about the input noise , like bath temperatures or correlations , and can describe both classical and non - classical noise source . for example , if the environment of mode @xmath15 is in a thermal state , the corresponding input noise follows @xmath276\\hat{\\xi}_{j,\\text{in}}[\\omega]\\right > = 2\\pi n_{j,\\text{th}}\\delta(\\omega-\\omega')$ ] and @xmath277\\hat{\\xi}_{j,\\text{in}}^\\dagger[\\omega']\\right > = 2\\pi ( n_{j,\\text{in}}+1)\\delta(\\omega-\\omega')$ ] , where @xmath278 is the mean thermal occupation number at the resonator frequency @xmath12 at a temperature @xmath279 ( @xmath280 is the boltzmann constant ) .    note that in this work , we perform linear measurements of the output field quadratures . therefore we access the symmetrized ( classical ) spectral density @xcite , @xmath281 $ ] : @xmath282 = \\frac{1}{2}\\left(\\mathcal{n}[\\omega]+\\mathcal{n}[-\\omega]\\right)\\ ] ]    the theoretical predictions for the output noise made in figs [ figpa](e ) , [ figdelta](f ) and [ figdelta](g ) are based on our best guess for the scattering parameters , shown in [ figpa](d ) and [ figdelta](d ) , and assume the each port is seeded by vacuum noise .",
    "the agreement between theory and experiment is primarily due to a clean mode basis .",
    "indeed , the eoms rely on the rotating wave approximation to eliminate dynamics at any spurious frequencies .",
    "if the approximation can not be made , new modes appear in the coupled network , leading for example to losses or added noise . the device presented here was carefully designed so that all first order parametric processes would be separated in frequency . in fig .",
    "[ figsitheory](a ) we show the mode frequencies @xmath219 and all the modulation frequencies @xmath283 for @xmath83 as a function of flux .",
    "the shaded areas represent a bandwidth three times larger than the largest mode width ( @xmath284 ) , necessary to ensure a good rotating wave approximation . at the flux bias chosen in this work , @xmath11 ,",
    "all these processes are well separated .",
    "the calibration of the noise performance of an amplifier at milli - kelvin temperature and close to the standard quantum limit is not a trivial task .",
    "most commonly used is the so - called y - factor method .",
    "it requires a calibrated noise source , such as a variable - temperature resistor @xcite , a circuit qed system @xcite , or a biased metallic tunnel junction @xcite .",
    "while each technique is subject to various experimental and conceptual challenges , they all share a common problem : they calibrate the system added noise to a reference plane that is usually not the one of the amplifier . for a simplistic but concrete and general example , consider that the noise source and the amplifier are connected by a transmission line with unknown loss : the calibrated noise at the output of the source is now uncalibrated at the input of the amplifier .",
    "this leads to the following general consideration when calibrating the noise of an amplifier : all components necessary for the proper operation of the amplifier ( circulators , filters , couplers , cables , etc . ) should be included in the system noise calibration .    in this work",
    "we choose a slightly different approach . in a separate cooldown",
    "we replace the fpja by a metallic tunnel junction and a bias tee , leaving every other component of the measurement chain identical ( including the hemt amplifier bias parameters ) , as shown in fig . [",
    "figsishotnoise](a ) .",
    "this allows for the calibration of the system noise down to the junction s reference plane , which only differs from the fpja reference plane by the loss of the bias tee ( @xmath285 ) .",
    "we therefore obtain an upper bound for the system noise temperature at the reference plane of the fpja .",
    "the power spectral density of the noise emitted by a metalic tunnel junction , at a frequency @xmath286 and temperature @xmath279 , as a function of the voltage @xmath287 across the junction is @xmath288 ( unit of @xmath289 ) , where      @xmath280 is the boltzmann constant , @xmath291 is the electron charge and @xmath292 is the reduced planck constant .",
    "the gain of the full measurement chain , @xmath293 , and the noise _ added _ by that chain , @xmath294 ( unit of @xmath295 ) , is extracted from the measured power spectral density , @xmath296 , following :      the power spectral density in photon units , @xmath298 , measured at the frequencies @xmath299 , @xmath300 and @xmath301 , corresponding to the resonance of the fpja , are shown respectively in figs .",
    "[ figsishotnoise](b ) , [ figsishotnoise](c ) and [ figsishotnoise](d ) . from a fit",
    "[ eq : shotnoise ] , we extract a constant temperature of @xmath302 and a system added noise of @xmath303 respectively at @xmath304 , @xmath305 and @xmath306 .",
    "similar measurements are performed over the @xmath18 to @xmath19 band and the measured system noise as a function of frequency is shown in fig .",
    "[ figsishotnoise ] .",
    "one can see oscillations , due to slight impedance mismatches and component imperfections throughout the chain .",
    "the temperature is consistently measured at @xmath302 , probably due to imperfect thermalisation of the sample box .",
    "l. sun , a. petrenko , z. leghtas , b. vlastakis , g. kirchmair , k.m .",
    "sliwa , a. narla , m. hatridge , s. shankar , j. blumoff , l. frunzio , m. mirrahimi , m.h .",
    "devoret and r.j .",
    "schoelkopf , _ tracking photon jumps with repeated quantum non - demolition parity measurements _ , nature * 511 * , 444 ( 2014 )    r. vijay , c. macklin , d. h. slichter , s. j. weber , k. w. murch , r. naik , a. n. korotkov and i. siddiqi , _ stabilizing rabi oscillations in a superconducting qubit using quantumfeedback _ , nature * 490 * , 77 ( 2012 )    d. rist , m. dukalski , c. a. watson , g. de lange , m. j. tiggelman , ya .",
    "m. blanter , k. w. lehnert , r. n. schouten and l. dicarlo , _ deterministic entanglement of superconducting qubits by parity measurement and feedback _ , nature * 502 * , 350 ( 2013 )        j.d .",
    "teufel , t. donner , m.a .",
    "castellanos - beltran , j.w .",
    "harlow , and k.w .",
    "lehnert , _ nanomechanical motion measured with an imprecision below that at the standard quantum limit _ , nature nanotechnology * 4 * , 820 ( 2009 )    n. roch , m. e. schwartz , f. motzoi , c. macklin , r. vijay , a. w. eddins , a. n. korotkov , k. b. whaley , m. sarovar and i. siddiqi , _ observation of measurement - induced entanglement and quantum trajectories of remote superconducting qubits _ , phys .",
    "lett . * 112 * , 170501 ( 2014 )          n. bergeal , f. schackert , m. metcalfe , r. vijay , v. e. manucharyan , l. frunzio , d. e. prober , r. j. schoelkopf , s. m. girvin and m. h. devoret , _ phase - preserving amplification near the quantum limit with a josephson ring modulator _ , nature * 465 * , 64 ( 2010 )            n. roch , e. flurin , f. nguyen , p. morfin , p. campagne - ibarcq , m.h . devoret and b. huard ,",
    "_ widely tunable , nondegenerate three - wave mixing microwave device operating near the quantum limit _ ,",
    "108 * , 147701 ( 2012 )          b. abdo , k. sliwa , s. shankar , m. hatridge , l. frunzio , r. schoelkopf , and m. devoret , _ josephson directional amplifier for quantum measurement of superconducting circuits _ , phys .",
    "* 112 * , 167701 ( 2014 )          c. macklin , k. obrien , d. hover , m. e. schwartz , v. bolkhovsky , x. zhang , w. d. oliver and i. siddiqi , _ a near - quantum - limited josephson traveling - wave parametric amplifier _ , science * 350 * , 307 ( 2015 )      a. j. sirois , m. a. castellanos - beltran , m. p. defeo , l. ranzani , f. lecocq , r. w. simmonds j. d. teufel and j. aumentado , _ coherent - state storage and retrieval between superconducting cavities using parametric frequency conversion _ , appl .",
    "lett . * 106 * , 172603 ( 2015 )"
  ],
  "abstract_text": [
    "<S> we report on the design and implementation of a field programmable josephson amplifier ( fpja ) a compact and lossless superconducting circuit that can be programmed _ in situ _ by a set of microwave drives to perform reciprocal and nonreciprocal frequency conversion and amplification . in this work </S>",
    "<S> we demonstrate four modes of operation : frequency conversion ( @xmath0 transmission , @xmath1 reflection ) , circulation ( @xmath0 transmission , @xmath1 reflection , @xmath2 isolation ) , phase - preserving amplification ( gain @xmath3 , @xmath4 of added noise ) and directional phase - preserving amplification ( @xmath5 reflection , @xmath6 forward gain , @xmath7 reverse isolation , @xmath4 of added noise ) . </S>",
    "<S> the system exhibits quantitative agreement with theoretical prediction . </S>",
    "<S> based on a gradiometric superconducting quantum interference device ( squid ) with nb / al  alo@xmath8/nb josephson junctions , the fpja is first - order insensitive to flux noise and can be operated without magnetic shielding at low temperature . due to its flexible design and compatibility with existing superconducting fabrication techniques , </S>",
    "<S> the fpja offers a straightforward route toward on - chip integration with superconducting quantum circuits such as qubits or microwave optomechanical systems . </S>"
  ]
}