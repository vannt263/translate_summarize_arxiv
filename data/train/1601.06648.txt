{
  "article_text": [
    "in many physical systems , interesting and important behaviour is associated with rare events ",
    "examples include crystal nucleation , slow transitions in biomolecules  @xcite , rare transitions in turbulent flows  @xcite , and extreme events in climate dynamics  @xcite .",
    "many computational methods for sampling these events have been proposed and exploited  @xcite .",
    "one family of methods is based around population dynamics  @xcite , in which several copies of a system evolve in parallel : the copies which exhibit the rare behaviour of interest are copied ( or _ cloned _ ) while other copies are discarded .",
    "the result is that _ typical _ copies within the population dynamics reproduce the desired rare events in the original system .",
    "one such method has recently been employed to characterise a particular class of rare events  @xcite , in which time - averaged physical quantities exhibit _ large deviations _",
    "@xcite from their typical values in the large time limit .",
    "studies of such events have revealed new and unexpected features in glass - formers  @xcite , biomolecules  @xcite , non - equilibrium transport  @xcite and integrable systems  @xcite . in this article",
    ", we identify a pitfall that limits the computational efficiency of the population dynamics method , and we show that the method can be modified so as to avoid this problem .",
    "the issue at stake is the number of copies of the system that must be considered in order to obtain accurate results  if very many copies are required then the method is difficult to apply , especially if even a single system is complex or contains many degrees of freedom .",
    "in some relevant cases then the standard population dynamics method requires an exponentially large population to be effective  @xcite .",
    "however , the method that we propose here , which is an improved version of the population dynamics , inspired by multicanonical methods in equilibrium systems  @xcite ( or adaptive importance sampling @xcite ) , can still be effective in these cases",
    ". the intuitive description of the problem that we identify is the following .",
    "the population dynamics is characterised by two different distributions , which describe the state of the system at some fixed final time , and its state at intermediate times .",
    "we show that in situations where the two distributions have a small overlap , the population dynamics is affected by a serious sampling problem , in which statistical estimators of the quantities of interest become dominated by just a few samples .",
    "one relevant case is that of systems with weak noise , for which the two distributions become more and more concentrated around their most likely values , so that they quite generally have zero overlap : this leads to an unavoidable failure of the population dynamics . in this article",
    ", we describe how to modify the population dynamics so as to maintain the two distributions close to each other , thus solving the sampling problem .",
    "we argue that this new method will provide a step - change in the complexity of the systems for which large deviation computations can be performed .",
    "the structure of the paper is as follows : we introduce our model and the population dynamics algorithm in section  [ sec : setup ] .",
    "we discuss sampling problems associated with this algorithm in section  [ sec : samplingerrors ] . in section",
    "[ sec : fb_pd ] , we introduce our main idea , which is to combine a controlling force with the population dynamics algorithm , in order to resolve the sampling issues . in section  [ sec :",
    "numex ] , we numerically demonstrate this method in a simple brownian particle model .",
    "finally , in section  [ sec : outlook ] , we describe the potential for future applications and extensions of this work .",
    "the rare events that we consider can take place in a variety of models . to illustrate the method , consider a particle moving in @xmath0-dimensions , whose position @xmath1 obeys a langevin equation @xmath2 where @xmath3 is a @xmath0-dimensional gaussian white noise of unit variance , @xmath4 a deterministic force , and the matrix @xmath5 specifies the action of the noise on the particle .  @xcite .",
    "we use the it convention @xcite for stochastic calculus throughout this paper , although one can also work with the stratonovich convention by using a transformation formula to relate one convention to the other  @xcite .",
    "we restrict to ergodic systems , and we focus on rare events in which a time averaged quantity @xmath6 takes some non - typical value . here",
    "@xmath7 is the long time period over which the average is taken , and @xmath8 consists of a `` scalar '' contribution @xmath9 and a `` vector '' one @xmath10 where @xmath11 are arbitrary functions of the particle position @xmath12 .",
    "the first contribution @xmath13 is a time - average of a quantity @xmath14 that depends only on the position @xmath12 ( i.e. a time - average of a static function such as a particle density or an energy density ) , whereas the second contribution @xmath15 includes transitions of @xmath12 as seen from the form @xmath16 ( i.e.  @xmath15 is an average of a dynamic function such as a particle current or an energy current @xcite ) . see also the explanation around eq.(34 ) in @xcite for a pedagogical introduction of @xmath6 .",
    "this class of observable includes many physically and mathematically interesting examples , and fluctuations of these quantities have been intensively studied recently , where examples are entropy production  @xcite , dynamical activity  @xcite , and particle fluxes  @xcite .    in the limit of large @xmath7 , ergodicity of the system",
    "means that the observable @xmath6 is almost surely equal to its typical value @xmath17 .",
    "our aims are ( i ) to estimate the ( small ) probability of deviations from this value , and ( ii ) to generate the rare trajectories that lead to these deviations .",
    "this is an important problem because these non - typical trajectories can exhibit interesting and unusual structures , including misfolded proteins  @xcite , stable glass states  @xcite and travelling waves in models of particle transport  @xcite .    to achieve these aims ,",
    "the standard theoretical route  @xcite is to introduce a _ biasing field _",
    "@xmath18 , which controls deviations of @xmath6 from its typical value .",
    "specifically , we consider an ensemble of paths @xmath19 with ( unnormalised ) probability density @xmath20 = \\pi_0(x_0 ) \\exp\\left [ -\\int_0^\\tau { \\cal l}(x_t,\\dot{x}_t ) { \\mathrm{d}}t + h \\tau\\lambda(\\tau ) \\right],\\ ] ] where @xmath21 \\cdot \\kappa(x)^{-1 } [ \\dot{x } - f(x ) ] \\label{eq : lagrangian}\\ ] ] is a lagrangian density that describes the ( unbiased ) model ( [ equ : dx ] ) ; @xmath22 is the initial condition for the trajectories , that can be arbitrary and which we take to be the stationary probability distribution of the unbiased model in the numerical examples . also , @xmath23 where the notation @xmath24 indicates a matrix transpose  @xcite .",
    "normalised averages with respect to @xmath25 are denoted by @xmath26 and we use these averages to characterise the rare trajectories associated with deviations of @xmath6 from @xmath27 , for the model in eq .  .",
    "we define the scaled cumulant generating function ( cgf ) : @xmath28 in the limit of large @xmath7 , the probability distribution of @xmath6 satisfies a large deviation principle , and can be obtained by a legendre transformation of @xmath29 , ( for which we assume that the large deviation function of @xmath6 is convex  @xcite . ) in the same limit , for a given deviation @xmath30 from @xmath27 , there exists a bias @xmath31 for which @xmath32 is equivalent to a conditional average over trajectories with @xmath33 @xcite .",
    "biased averages with respect to the biased distribution @xmath25 , which are numerically evaluated through the population dynamics , thus enable to characterise the trajectories of the original dynamics for which time - averaged physical quantities exhibit large deviations from their typical values in the large time limit .",
    "there are several computational methods that allow evaluation of averages with respect to @xmath25  @xcite . in the population dynamics method  @xcite",
    ", one considers @xmath34 copies ( or clones ) of the system .",
    "these clones evolve independently as a function of the time @xmath35 , except that ( for @xmath36 ) clones with small @xmath37 are periodically removed ( eliminated ) from the system , while clones with large @xmath37 are duplicated ( cloned ) , to maintain a constant population .",
    "the algorithm is illustrated in fig .",
    "[ fig : traj ] and described fully in appendix  [ pdsection_algorithm ] .",
    "this method biases the dynamics towards the rare events of interest . for sufficiently large @xmath34 ( and large enough @xmath7 ) , the method provides accurate estimates of @xmath29 and it generates sample paths consistent with the biased distribution @xmath25 .",
    "( color online ) * ( a ) * trajectories @xmath38 generated by population dynamics at fixed total population  @xmath39 for the model system described in section  [ subsec : numericalexample ] ( @xmath40 ) .",
    "the different colours or line types , which are the green ( dark grey in the printed version ) solid line , green dashed line , yellow ( light grey in the printed version ) solid line and yellow dashed line , represent different copies . at certain times , some copies of the system are removed ( @xmath41 symbols ) and others are duplicated  ( @xmath42 symbols ) .",
    "the time interval @xmath43 for the cloning procedure is set to be 0.05 , and the time step for solving the langevin equation is 0.001 ( see appendix  [ pdsection_algorithm ] for the details of the algorithm ) . *",
    "( b ) * representative sample paths @xmath44 for the distribution @xmath45 $ ] , derived from those in ( a ) by keeping only trajectories surviving up to final time @xmath46 . for each cloning event",
    ", we also copy the history of the trajectory , which replaces the history of the eliminated trajectory .",
    "this means that the trajectories @xmath47 overlap , especially for early times .",
    "for example , in panel ( b ) , the point a appears in the past of the four points b1,@xmath48,b4 . for any point @xmath38 ( such as a , b1,b2,@xmath48 ) , we define the multiplicity @xmath49 as the number of trajectories that include this point , and survive until the final time @xmath7 .",
    "so for point @xmath50 , the multiplicity is @xmath51 but for b1,@xmath48,b4 then @xmath52 .",
    "( for all points in the trajectories who die before @xmath7 , which are not drawn in the panel ( b ) , @xmath53 . ) , title=\"fig : \" ] +   ( color online ) * ( a ) * trajectories @xmath38 generated by population dynamics at fixed total population  @xmath39 for the model system described in section  [ subsec : numericalexample ] ( @xmath40 ) .",
    "the different colours or line types , which are the green ( dark grey in the printed version ) solid line , green dashed line , yellow ( light grey in the printed version ) solid line and yellow dashed line , represent different copies . at certain times , some copies of the system are removed ( @xmath41 symbols ) and others are duplicated  ( @xmath42 symbols ) .",
    "the time interval @xmath43 for the cloning procedure is set to be 0.05 , and the time step for solving the langevin equation is 0.001 ( see appendix  [ pdsection_algorithm ] for the details of the algorithm ) . *",
    "( b ) * representative sample paths @xmath44 for the distribution @xmath45 $ ] , derived from those in ( a ) by keeping only trajectories surviving up to final time @xmath46 . for each cloning event",
    ", we also copy the history of the trajectory , which replaces the history of the eliminated trajectory .",
    "this means that the trajectories @xmath47 overlap , especially for early times .",
    "for example , in panel ( b ) , the point a appears in the past of the four points b1,@xmath48,b4 . for any point @xmath38 ( such as a , b1,b2,@xmath48 ) , we define the multiplicity @xmath49 as the number of trajectories that include this point , and survive until the final time @xmath7 .",
    "so for point @xmath50 , the multiplicity is @xmath51 but for b1,@xmath48,b4 then @xmath52 .",
    "( for all points in the trajectories who die before @xmath7 , which are not drawn in the panel ( b ) , @xmath53 . ) ,",
    "title=\"fig : \" ]      to show the operation of the population dynamics method , we introduce a simple model of diffusion in a quartic potential .",
    "that is , @xmath54 and @xmath55 , where @xmath56 is the noise strength ( or temperature ) .",
    "we take @xmath57 and @xmath58 . for @xmath59 the distribution @xmath25 is concentrated on trajectories with small values of @xmath14 , which tend to localise near @xmath60 . here",
    "we focus on the case @xmath36 , which leads to unusually large values of @xmath14 .",
    "those can be realised either for @xmath61 or @xmath62 but at large @xmath7 this rare event is almost always realised by trajectories that have @xmath61 ( as illustrated in fig .",
    "[ fig : traj ] ) .",
    "this simple problem can be solved exactly in the zero - noise limit ( see appendix  [ appendix : instantonresults ] ) .",
    "the operation of the population dynamics method is illustrated in fig .",
    "[ fig : traj ] . fig .  [ fig : traj](a ) shows four copies of the system that evolve in time , except that some trajectory segments stop and others branch , as the cloning operates . fig .",
    "[ fig : traj](b ) shows four representative trajectories ( sample paths ) for the distribution @xmath45 $ ] , which have been reconstructed from panel ( a ) , by tracing backwards in time from the clones that survived up to the final time  @xmath7 .",
    "the accuracy of the population dynamics is limited by the number of clones @xmath34 used in its numerical implementation , as we now explain .",
    "consider the distribution @xmath65 which indicates the fraction of time spent at position @xmath12 , within the biased ensemble .",
    "we also define @xmath66 which indicates the fraction of trajectories for which the particle s final position is @xmath12 . for the stationary state of the dynamics  , which corresponds to @xmath67",
    ", time - translational invariance ensures that @xmath68 .",
    "however , this is not the case for biased ensembles where @xmath69 , as illustrated in  @xcite and in fig .",
    "[ kappa01computationalefficiencyfeedback ] .",
    "the population dynamics method provides estimates of both @xmath64 and @xmath63 .",
    "let the position of clone @xmath70 at time  @xmath35 be @xmath38 , with @xmath71 .",
    "recalling fig .",
    "[ fig : traj](a ) , note that the functions @xmath38 are not continuous in time and do not represent sample paths for the distribution @xmath45 $ ] .",
    "however , from the definition of the population dynamics algorithm ( as explained in appendix  [ pdsection_algorithm ] ) , the distribution of @xmath38 can be used to estimate @xmath72 , as @xmath73     +     in order to construct sample paths , which we denote by @xmath74 , we trace backwards in time from the clones that survive up to @xmath7 , as shown in fig .  [",
    "fig : traj](b ) .",
    "there are still @xmath34 paths @xmath75 , but these overlap , particularly at early times .",
    "since these trajectories correspond to @xmath45 $ ] , the distribution of @xmath75 gives an estimate of @xmath76 , as : @xmath77 the approximate equalities in the relations ( [ eq : pendestimation ] ) and ( [ eq : paveestimation ] ) become exact in the limit @xmath78 and @xmath79 , in which the population dynamics gives exact results .",
    "we show numerical examples of these functions in fig .",
    "[ kappa01computationalefficiencyfeedback ] , for a particle moving in a quartic potential , as introduced in section  [ subsec : numericalexample ] .",
    "we estimate @xmath64 and @xmath63 from ( [ eq : pendestimation ] ) and ( [ eq : paveestimation ] ) , and show them in fig .",
    "[ kappa01computationalefficiencyfeedback ] . in the same figure",
    ", we also plot the numerically exact distributions , obtained by numerical solution of a modified fokker - planck equation ( see  @xcite and appendix  [ sec : fp ] ) .",
    "the population dynamics converges to the exact result as @xmath34 is increased .",
    "also shown in fig .",
    "[ kappa01computationalefficiencyfeedback ] are results using the control - with - feedback method that we introduce in this paper : these results will be discussed in later sections .",
    "the population dynamics method gives accurate results in the limit of large @xmath34 .",
    "the central idea is that in a large population , short - lived rare fluctuations will occur .",
    "based on these short - lived fluctuations , we duplicate some of the clones : repeated application of this procedure generates the _ long - lived _ fluctuations that are relevant for large deviation theory .",
    "for this to be effective , the population on which the cloning operates must be large enough to capture the relevant short - lived fluctuations .",
    "that is , the cloning part of the algorithm can allocate extra statistical weight to configurations that are already present in the population , but new configurations are only generated by the natural ( unbiased ) dynamics of the system .    assuming that @xmath34 is large enough for efficient operation of the algorithm , the configurations that are associated with long - lived dynamical fluctuations are distributed as @xmath64 , but the cloning step operates on a population distributed as @xmath63 . from the argument above",
    ", it is clear that if _ typical _",
    "samples from @xmath64 are rare with respect to @xmath63 , then a large population is required in order to obtain accurate results . to quantify this , it is useful to define the multiplicity @xmath49 of clone @xmath70 at time @xmath35 as the number of its descendants that survive until the final time @xmath7 ( see fig .  [",
    "fig : traj ] ) . rewriting ( [ avep ] ) as @xmath80 and comparing with ( [ endp ] )",
    ", one sees that for a clone with position @xmath81 , the _ expected value _ of its future multiplicity is @xmath82 . since the clone positions @xmath38 are distributed as @xmath63 , averaging this future multiplicity over configurations @xmath12 yields @xmath83 , which reflects the fact that the population size is constant in time . in practice ,",
    "the distribution of the multiplicity @xmath49 is very broad , and _ typical _ multiplicities are far from their _ average _ values .",
    "there are many clones for which no descendants survive until time @xmath7 ( see fig .",
    "[ fig : traj](a ) ) , in which case @xmath53 . in order to maintain an average multiplicity of @xmath84 ,",
    "these zero - multiplicity clones are balanced by a small number of clones with larger multiplicity .",
    "it is useful to define @xmath85 as the number of clones that are present in the population at time @xmath35 , for which @xmath86 .",
    "numerical results for @xmath87 are shown in fig .",
    "[ fig : ntgh ]  this quantity decreases rapidly as @xmath35 decreases away from @xmath7 , showing that many clones have no surviving descendants : it follows that the multiplicities of the surviving clones must be large . from ( [ eq : paveestimation ] )",
    ", one sees that if @xmath85 is small , numerical estimates of @xmath64 contain only a small number of independent samples , which can lead to large numerical uncertainties within the algorithm .",
    "moreover , the presence of large multiplicities within the cloning scheme can lead to large _",
    "systematic errors _ , which can not be reduced by averaging over repeated runs of the same algorithm . on running the system with a fixed population , the future multiplicity of any clone is bounded above by the population size @xmath34 .",
    "we will show in the next section that this constraint has serious implications for systems in the small noise limit .",
    "more generally , in order to characterise whether a system requires a large population or not , it is useful to define two numbers that measure how different are the distributions @xmath64 and @xmath63 .",
    "these are @xmath88 { \\mathrm{d}}x \\label{equ : m2def}\\ ] ] and @xmath89 given that @xmath82 is the expected future multiplicity of a clone at @xmath12 , we recognise @xmath90 as the variance of this multiplicity , with respect to the distribution @xmath63 of clone positions ( recall that the average multiplicity with respect to this distribution is equal to unity ) . similarly @xmath91 is the relative entropy of @xmath64 with respect to @xmath63  @xcite : this is related to the controlling forces that will be introduced in section  [ sec : fb_pd ] .",
    "large values of @xmath90 and @xmath91 indicate that @xmath63 and @xmath64 are different from each other , in which case larger values of @xmath34 will be required for accurate results within population dynamics .",
    "for the two cases @xmath92 shown in fig .",
    "[ kappa01computationalefficiencyfeedback ] , we have for @xmath93 that @xmath94 while for @xmath95 , @xmath96 , reflecting the larger populations required for accurate results when @xmath95 .",
    "obtaining general estimates of the actual population size @xmath34 required for convergence is an important goal for future work .     obtained from the normal population dynamics method ( green line or dark grey line in the printed version ) for @xmath93 ( a ) and @xmath97 ( b ) .",
    "the line type corresponds to the value of noise intensity : @xmath98 ( solid line ) and @xmath99 ( dashed line ) .",
    "we set @xmath100 and @xmath46 . when the distributions @xmath64 and @xmath63 are very different from each other , we expect that @xmath101 decreases rapidly as @xmath35 decreases from @xmath7 : to illustrate this , note that ( for @xmath102 ) @xmath103 for @xmath93 and @xmath104 for @xmath97 : the same ordering is preserved for smaller @xmath56 .",
    "we also plot @xmath101 obtained from the controlled population dynamics ( yellow line or light grey line in the printed version ) with the control - with - feedback explained in section  [ subsec : iteafeed ] and section  [ sec : numex ] .",
    "the larger values of @xmath101 obtained with the control - with - feedback method lead to smaller statistical uncertainties in the results .",
    ", title=\"fig : \" ] +   obtained from the normal population dynamics method ( green line or dark grey line in the printed version ) for @xmath93 ( a ) and @xmath97 ( b ) .",
    "the line type corresponds to the value of noise intensity : @xmath98 ( solid line ) and @xmath99 ( dashed line ) .",
    "we set @xmath100 and @xmath46 .",
    "when the distributions @xmath64 and @xmath63 are very different from each other , we expect that @xmath101 decreases rapidly as @xmath35 decreases from @xmath7 : to illustrate this , note that ( for @xmath102 ) @xmath103 for @xmath93 and @xmath104 for @xmath97 : the same ordering is preserved for smaller @xmath56 .",
    "we also plot @xmath101 obtained from the controlled population dynamics ( yellow line or light grey line in the printed version ) with the control - with - feedback explained in section  [ subsec : iteafeed ] and section  [ sec : numex ] .",
    "the larger values of @xmath101 obtained with the control - with - feedback method lead to smaller statistical uncertainties in the results .",
    ", title=\"fig : \" ]      the effect described in the previous section is particularly severe for systems where the random ( noise ) force in ( [ equ : dx ] ) is small . to illustrate this case , we set @xmath105 , consistent with the numerical example of sec .",
    "[ subsec : numericalexample ] ( for which @xmath106 ) .",
    "the small noise limit is then @xmath107 .",
    "we define @xmath108 $ ] as the most likely value of @xmath12 , within the distribution @xmath64 .",
    "the population dynamics requires that the typical multiplicity of a clone with position @xmath109 should be ( at least ) of order @xmath110 .",
    "this clearly can not be achieved unless @xmath111 , which provides an estimate of the number of clones required for accurate results .",
    "this multiplicity @xmath112 increases exponentially as the noise intensity of the system becomes small . in this limit , the dynamics of the system runs increasingly slowly so it is natural to rescale either the time variable or ( equivalently ) the biasing field @xmath18 as @xmath113 with @xmath114 .",
    "( this scaling also appears in the hydrodynamic limit of microscopic models  @xcite . ) in this limit , @xmath64 and @xmath63 satisfy a large deviation principle with respect to the noise intensity @xmath56 : @xmath115 and @xmath116 .",
    "hence , @xmath117 , where we used @xmath118 .",
    "this indicates that we need an exponentially large @xmath34 as @xmath56 becomes small .",
    "more quantitatively , we define a characteristic noise intensity @xmath119 by @xmath120 for @xmath121 , we expect that population dynamics can not be used practically , because of the exponentially large @xmath34 required .    as a numerical example",
    ", we again consider the brownian particle introduced in section  [ subsec : numericalexample ] .",
    "we numerically estimate @xmath119 by using a quadratic approximation of the large deviation function @xmath122 .",
    "we plot it as a green vertical line in fig .",
    "[ fig : gh_eps ] . in the same figure",
    ", we show the result of the population dynamics for @xmath123 as @xmath56 is reduced , with a red constant line corresponding to the analytical value of @xmath123 in the @xmath124 limit ( see appendix  [ appendix : subsectioncumulant ] for its determination ) .",
    "below the characteristic value  @xmath119 , the population dynamics method converges very poorly as @xmath34 increases .",
    ", as @xmath56 is varied .",
    "we compare results from the normal population dynamics and from the control - with - feedback method explained in section  [ subsec : iteafeed ] and section  [ sec : numex ] . the analytical result for @xmath125",
    "is shown as a red dashed line , and the characteristic value of the noise intensity @xmath126 , defined in  , is plotted as a green vertical solid line .",
    "the standard method fails for @xmath56 smaller than @xmath119 but the control - with - feedback method ( black continuous line and black circles ) converges to the correct value even for @xmath127 .",
    ", title=\"fig : \" ] +",
    "to resolve the sampling issues described in the previous section , we introduce a `` control strategy '' , which modifies the original model ( [ equ : dx ] ) , in order to make the rare events of interest more likely .",
    "( these large deviation problems have dual representations in terms of optimal control problems  @xcite , which provide a natural interpretation of the method presented here . )",
    "the modified model is @xmath128 where @xmath129 is a controlling force which we write as @xmath130 where @xmath131 acts as a potential .",
    "a straightforward calculation shows that averages with respect to the biased distribution @xmath25 can be rewritten as averages with respect to this modified dynamics , but with a bias on a different observable @xmath132 , which replaces @xmath30 .",
    "that is , by defining @xmath133 with @xmath134,\\ ] ] in which @xmath135 is a hessian matrix with elements @xmath136 , we have @xmath20 = p_w[x ] { \\mathrm{e}}^ { v(x_\\tau ) - v(x_0 ) }   \\label{equ : phw}\\ ] ] with @xmath137 = \\pi_0(x_0 ) \\exp\\!\\big[\\!-\\!\\!\\int_0^\\tau\\!\\!\\ ! { \\cal l}^w(x_t,\\dot{x}_t )   { \\mathrm{d}}t + h \\tau \\lambda^w(\\tau ) \\big],\\ ] ] where @xmath138 is the action corresponding to the controlled langevin equation ( [ modifiedsystemdef ] ) obtained by replacing @xmath139 in  .",
    "see appendix  [ sec : app_derivation ] for details of the derivation .",
    "we stress that these relations are satisfied for _ any _ control @xmath140 .",
    "averages with respect to @xmath141 are denoted by @xmath142 , and can be calculated using the population dynamics method with the modified model  ( [ modifiedsystemdef ] ) .",
    "physically , equation ( [ equ : phw ] ) says that rare events for the system ( [ equ : dx ] ) have an alternative characterisation as rare events for the controlled system ( [ modifiedsystemdef ] ) .",
    "more precisely , from ( [ equ : phw ] ) , the averages @xmath26 and @xmath142 are not equal , but their associated probability distributions differ only through boundary terms at initial and final times . for large @xmath7",
    ", we focus on properties far from initial and final times , in which case the averages @xmath26 and @xmath142 are equivalent .",
    "this equivalence implies that @xmath143 where @xmath144 is defined as in ( [ avep ] ) but for the controlled population dynamics  . on the other hand , when we consider properties close to the final time @xmath7 ( which are not relevant for the large deviations of time - averaged quantities ) , the two averages @xmath26 and @xmath142 are different in general .",
    "for example , the end - time distribution @xmath145 for the controlled dynamics differs from its uncontrolled counterpart as @xmath146 as read from   ( or see appendix  [ sec : fp ] for a detailed derivation of   and  ) .",
    "thus the control @xmath140 allows @xmath147 to be varied , while always keeping @xmath148 constant ( and hence leaving unchanged the bulk properties of @xmath25 , which are relevant for the large deviations of time - averaged quantities ) .",
    "these results apply for any control force @xmath140 , but a ( unique ) optimal choice @xmath149 can be defined by the condition @xmath150from ( [ equ : m2def],[equ : d2def ] ) , this result implies that for the controlled population dynamics , @xmath151 : all clones have expected future multiplicity of unity , regardless of their position .",
    "in fact , this case also implies that @xmath152 is independent of @xmath12 ( see appendix  [ sec : fp ] ) , so that there is no cloning or deletion of clones in the optimally - controlled population dynamics algorithm .",
    "that is , all multiplicities are equal to unity ( not just their expected values ) .",
    "the result is that the optimally - controlled process  @xcite generates directly the path measure @xmath25 , up to the corrections given in  ( [ equ : phw ] )  @xcite .",
    "note also that @xmath91 , as defined in ( [ equ : d2def ] ) for the original population dynamics , is also related to an average of the optimal control potential @xmath153 ( where @xmath153 is the potential @xmath131 corresponding to the optimal control @xmath149 ) , since @xmath154 = -v^*(x ) - \\log [ \\int { \\mathrm{e}}^{-v^*(x ' ) } p_{\\rm end}(x')\\mathrm{d}x']$ ] .",
    "the optimal control can be estimated by using the population dynamics with _ any _ non - optimal control force @xmath140 ( or its corresponding potential @xmath131 ) .",
    "we perform the population dynamics and generate sample paths from @xmath141 . from the definition of the optimal force ( [ eq : def_optimalcontrol ] ) with the relations between @xmath155 and @xmath156 ( [ eq : pave_pavew ] ) , ( [ eq : pend_pendw ] )",
    ", we obtain @xmath157 since all terms on the right - hand side of ( [ equ : pwv ] ) can be measured from the population dynamics with a non - optimal control @xmath140 , this allows an estimate of @xmath153 , and hence of  @xmath149 .",
    "based on ( [ equ : pwv ] ) , we arrive at the following iteration and feedback scheme for efficient analysis of large deviations of @xmath6 . starting with the original population dynamics of  @xcite",
    ", we obtain estimates @xmath158 and @xmath159 of @xmath63 and @xmath64 , and we use ( [ equ : pwv ] ) to obtain an estimate of the optimal control potential @xmath153 , which we denote by @xmath160 .",
    "we then repeat the population dynamics calculation with a control force @xmath161 derived from the potential @xmath160 .",
    "we use results from this new calculation together with ( [ equ : pwv ] ) to obtain a new ( more accurate ) estimate of the optimal control .",
    "iterating this scheme , the estimate of @xmath153 at iteration @xmath162 is @xmath163 . as @xmath164",
    ", we have from ( [ equ : pwv ] ) that @xmath165 , and hence the sampling problems described in sec .  [ subsec : multiplicity ]",
    "are reduced .",
    "this improves the accuracy of the population dynamics method .",
    "given sufficiently many clones @xmath34 , the original method of  @xcite can already provide accurate results , but we have demonstrated that for finite @xmath34 there may be large systematic errors .",
    "the strength of our scheme is that on repeated iteration , the control potential @xmath131 approaches the optimal control @xmath153 , and the errors within the method are reduced .",
    "thus , the numerical accuracy of the method increases as the scheme is iterated .    for the implementation of this iteration scheme",
    ", we require a computational representation of the function @xmath166 , and its gradient @xmath167 . from ( [ equ : pwv ] )",
    ", a natural choice might be to represent @xmath64 and @xmath63 by histograms , based on a discretisation of the configuration space .",
    "however , this choice does not facilitate estimation of @xmath167 , and it is also unfeasible in high - dimensional systems .",
    "we therefore use a potential @xmath131 that is defined in terms of a set of basis functions @xmath168 , with coefficients @xmath169 : @xmath170 where @xmath171 is the size of the basis set .    at stage @xmath162 of our iterative scheme , the coefficients @xmath172",
    "are denoted by @xmath173 . in the absence of prior information about the optimal control @xmath153 , the first stage of the method ( @xmath174 ) uses the original population dynamics , so @xmath175 for all @xmath176 . in stage @xmath177",
    ", we update these coefficients according to ( [ equ : pwv ] ) so that the potential @xmath178 in the next stage is the best available estimate of @xmath153 .",
    "there is considerable freedom in how to obtain this estimate : we take @xmath179 ^ 2 { \\mathrm{d}}x , \\label{eq : sim_definition}\\end{gathered}\\ ] ] where @xmath180 is the numerical estimate for @xmath181 obtained at iteration @xmath162 , and similarly @xmath182 .",
    "the state space @xmath183 is defined as the space where @xmath184 ( note that @xmath185 whenever @xmath186 , from the definition of how to construct @xmath44 as shown in fig .  [ fig : traj](b ) ) .",
    "we emphasise that , for _ any _ basis set @xmath168 ( with _ any _ truncation number @xmath171 ) , eq .",
    "( [ equ : phw ] ) is satisfied , meaning that if the number of clones @xmath34 and the time @xmath7 are large enough , the result of _ any _ controlled population dynamics always leads to the same results , which can also be obtained from the original ( uncontrolled ) population dynamics .",
    "however , the choice of the expansion functions @xmath187 ( and the value of the truncation number @xmath171 ) does affect the computational cost , through the number of clones required for convergence , as discussed in section  [ subsec : multiplicity ] .",
    "compared to the original population dynamics method , the addition of control forces and the use of iteration and feedback increase the complexity of the method presented here . here , we summarise the improvements that these changes achieve .",
    "typically , existing methods either exploit an ensemble ( population ) of copies of the system  @xcite , or they use modified ( controlled ) dynamical rules to drive the system towards rare events of interest  @xcite , or they use path - sampling methods  @xcite .",
    "all these methods are useful , but the population - based methods can suffer convergence problems , due to the very large populations required in some problems . on the other hand ,",
    "the controlled methods require accurate estimation of an optimal control force that is typically a high - dimensional and complex object , which can be difficult to represent computationally ( see for example  @xcite ) .",
    "path sampling methods are most effective when the ensemble @xmath25 has time - reversal symmetry , which limits their applicability in non - equilibrium settings .",
    "the method proposed here is a mixture of the population - based and control - based methods , as illustrated schematically in fig  [ fig : schematicfig ] .    in terms of the applicability of this new method",
    ", we expect the following general behaviour . for complex high - dimensional problems , accurate representation of the optimal control",
    "@xmath153 is likely to be difficult , but we expect even approximate representations of @xmath153 to significantly improve the performance of the population dynamics method .",
    "thus , the controlled method should reduce the computational cost of problems that are already tractable using population dynamics , allowing access ( for example ) to larger system sizes and larger values of the bias parameter @xmath18 . on the other hand , for relatively simple problems such as the particle in a quartic potential of sec .",
    "[ subsec : numericalexample ] , the original population dynamics fails for small noise ( fig .",
    "[ kappa01computationalefficiencyfeedback ] ) but we would expect that a solution by the controlled method of  @xcite might already be possible . however , for a similar model in three or more dimensions , we expect that the method of  @xcite would already be challenging , due to the difficulty of representing exactly the effective potential . here",
    ", we combine that control strategy with population dynamics : we arrive at a flexible method that exploits the strengths of both approaches , and which we anticipate will be effective in a wide variety of problems .",
    "to illustrate the control - with - feedback method , we consider the numerical example from section [ subsec : numericalexample ] , and we take the effective description in ( [ eq : effective_definition ] ) to be a quartic polynomial : @xmath188 ( that is , `` @xmath12 raised to the power @xmath176 '' ) and @xmath189 . for the first iteration of the method we take @xmath190 . note that this potential - parametrisation of @xmath131 can not capture the exact @xmath153 , neither for @xmath191 nor in the limit @xmath124 ( see appendix  [ appendix : instantonresults ] ) .",
    "this emphasises that the control - with - feedback method does not require a perfect representation of the optimal control in order to improve the convergence of the population dynamics method .",
    "[ kappa01computationalefficiencyfeedback ] shows estimates of the distribution @xmath64 obtained using the original cloning method ( fig .",
    "[ kappa01computationalefficiencyfeedback](a - d ) ) , compared with the results obtained using control - with - feedback procedure proposed here ( fig .  [ kappa01computationalefficiencyfeedback](e ) ) .",
    "( two iterations of the feedback were used , which allow an accurate estimate of the optimal control potential @xmath153 . ) the comparison between fig .",
    "[ kappa01computationalefficiencyfeedback](d ) and fig .",
    "[ kappa01computationalefficiencyfeedback](e ) shows that the number of clones required to obtain convergence to the exact result is much reduced using the control - with - feedback method .    in the weak - noise limit @xmath124",
    ", one can see this advantage more clearly . in this limit ,",
    "a sampling issue arises because of the exponential increase of the required number of copies @xmath34 , as discussed in section  [ subsec : smallnoiseproblem ] .",
    "[ fig : ntgh](a ) shows numerical results for @xmath123 , as @xmath56 is reduced .",
    "the normal population dynamics converges very poorly for small noise , @xmath121 .",
    "however , the controlled population dynamics does not fail at small @xmath56 because it maintains @xmath192  @xcite .",
    "we then consider _ statistical _ errors .",
    "[ fig : ntgh](b ) shows the number of distinct clone positions in the population , @xmath193 .",
    "again , the control - with - feedback method performs better than the original method , in that it averages over a larger sample of distinct positions , reducing the statistical errors .    finally , in order to illustrate how the control - with - feedback method improves the standard population dynamics method , in fig .",
    "[ fig : multiplicitiesdiscussions ] , we show the integrands of @xmath90 and @xmath91 defined in ( [ equ : m2def ] ) and ( [ equ : d2def ] ) @xcite . as discussed in section  [ subsec : multiplicity ] and",
    "section  [ subsec : smallnoiseproblem ] , the standard population dynamics has sampling issues , which are captured by the deviations of @xmath90 and @xmath91 from 0 . in the figure",
    ", we can see that the control - with - feedback method greatly reduces the values of @xmath90 and @xmath91 close to 0 , ensuring that @xmath147 and @xmath64 are closer than in the original cloning , thus yielding better performances as seen throughout this section .     and",
    "@xmath91 defined as ( a ) @xmath194 $ ] and ( b ) @xmath195 , ( see ( [ equ : m2def ] ) and ( [ equ : d2def ] ) ) , for the standard ( normal ) population dynamics method ( @xmath196 ) and for the control - with - feedback method ( @xmath140 : obtained from the control - with - feedback method ) ) . for the control - with - feedback method , we set @xmath100 . in the legends of the figures",
    ", we put the values corresponding to @xmath90 and @xmath91.,title=\"fig : \" ] +   and @xmath91 defined as ( a ) @xmath194 $ ] and ( b ) @xmath195 , ( see ( [ equ : m2def ] ) and ( [ equ : d2def ] ) ) , for the standard ( normal ) population dynamics method ( @xmath196 ) and for the control - with - feedback method ( @xmath140 : obtained from the control - with - feedback method ) ) . for the control - with - feedback method , we set @xmath100 . in the legends of the figures",
    ", we put the values corresponding to @xmath90 and @xmath91.,title=\"fig : \" ]",
    "we have shown that the performance of the population dynamics algorithm for sampling large deviations  @xcite can be improved by introducing a controlling force @xmath140 . given the optimal choice for this force , the rare events of interest in large deviation theory can be characterised as typical trajectories of the controlled system without any cloning . in complex systems with many degrees of freedom",
    "it is likely that the optimal @xmath140 can not be determined exactly , but even non - optimal controls can still significantly improve both the statistical and the systematic errors associated with the population dynamics method ( see section  [ sec : numex ] ) .",
    "it is straightforward to improve existing population dynamics codes to include this approach : we expect that it will significantly expand the range of systems for which numerical calculations can be performed , including open quantum systems  @xcite , or more complex molecular dynamics models than those considered so far  @xcite .",
    "the authors gratefully acknowledge the support of fondation sciences mathmatiques de paris ",
    "eotp nemot15rpo , peps labs and laabs inphyniti cnrs project .",
    "the research leading to these results has received funding from the european research council under the european union s seventh framework programme ( fp7/2007 - 2013 grant agreement no",
    ".  616811 ) ( f.  bouchet and t.  nemoto )",
    ". v.  lecomte acknowledges support by the national science foundation under grant no .",
    "nsf phy11 - 25915 during a stay at kitp , uscb .",
    "in this appendix , complementing section  [ subsec : populationdynamics ] and section  [ subsec : pend_pave ] , we explain the details of the population dynamics algorithm .",
    "the population dynamics is a numerical technique designed to evaluate a large deviation function associated to the cumulant generating function ( cgf ) of a time - averaged observable  @xmath37 .",
    "each step of the algorithm consists of a first sub - step in which the normal ( unbiased ) dynamics of the system is simulated for a time @xmath43 , followed by an elimination - multiplication sub - step .",
    "( the elimination - multiplication sub - step is also called a cloning step , or a mutation - selection step . ) in detail , the method is :    1 .",
    "generate @xmath34 initial conditions , for example , drawn from the stationary state of the unbiased ( @xmath67 ) dynamics .",
    "repeat the following procedure @xmath197 times .",
    "( the iteration index is @xmath198 . ) 1 .",
    "for each copy of the system , perform the normal dynamics from @xmath199 to @xmath200 .",
    "we denote each trajectory by @xmath38 .",
    "( throughout this section , @xmath201 . ) during the simulation , for each trajectory , calculate @xmath202\\big \\}.\\ ] ] 2 .   for each trajectory @xmath70",
    ", calculate an integer @xmath203 as @xmath204 where @xmath205 is a random number uniformly distributed on [ 0,1 ] and @xmath206 denotes the lower integer part .",
    "calculate and store the quantity @xmath207 .",
    "3 .   multiply or eliminate each trajectory @xmath70 so that it appears @xmath203 times in the new population .",
    "( for example , if @xmath208 then trajectory @xmath70 is deleted .",
    "if @xmath209 then we retain trajectory @xmath70 and we introduce 4 new copies of that trajectory . )",
    "eliminate or multiply trajectories within the population , chosen randomly and uniformly , so that the total number of surviving trajectories is @xmath34 .",
    "go back to ( a ) , using the current set of configurations @xmath210 as initial conditions for the next iteration of the normal dynamics .",
    "note that if the population were not kept constant in step 2c above , then the population would expand by a factor of @xmath211 .",
    "it follows that the cgf can be estimated as @xmath212 also , averages over the population at the final time @xmath7 are estimates of averages with respect to @xmath63 : @xmath213 which follows from the definition of @xmath63 .",
    "when estimating @xmath63 , we can improve the statistics by using the history of @xmath38 .",
    "that is , assuming an ergodicity property , we can replace @xmath214 by its time average , leading to @xmath215 this means that the empirical distribution of @xmath216 is an estimator for @xmath63 , as announced in ( [ eq : pendestimation ] ) .    in order to generate the sample paths corresponding to the biased measure @xmath25",
    ", we also need to copy the history of trajectory ( not just the current configuration of @xmath12 ) in the selection - mutation procedure in step 2.(b ) of the algorithm .",
    "this fact is directly derived from the definition of @xmath25 .",
    "thus , the @xmath38 defined above do not correspond to sample paths of @xmath25 .",
    "the paths are obtained as @xmath44 , which are defined as those trajectories that survive until the final time @xmath7 ( see fig .  [",
    "fig : traj ] ) . in numerical simulations , there are several ways to generate ( or reconstruct ) these trajectories , as we now explain .",
    "a simple way to characterise @xmath44 is the following : if we do not require full sample paths but only wish to evaluate the biased average of an additive observable @xmath217 , a simple method  @xcite consists in attaching a value of the observable  @xmath50 to every trajectory and , at every time step , to update its value and copy / delete it together with the trajectory .",
    "then , an evaluation of the biased average of  @xmath50 is given by an average of the numerical values of  @xmath50 : this average runs over all trajectories that are present _ at the final time_. for example , when we divide the configuration space into small bins and take @xmath218 if @xmath219 is in bin @xmath176 , @xmath220 is an estimate of @xmath64 , integrated across the @xmath176th bin . for the small systems where we can store all of the trajectories in the population dynamics , we can generate full sample paths corresponding to @xmath221 .",
    "the procedure is as follows : we first generate all the trajectories , and then select those that survive until the final time @xmath7 . considering the @xmath34 copies at final time , indexed by @xmath222 , one can follow the ancestors of every copy . upon every coalescence",
    "observed backwards in time ( corresponding to multiplications of clones in the original forwards simulation ) , one increments a counter @xmath49 by the number of trajectories which have coalesced . at the end of the procedure , the counters @xmath223 represent , at time @xmath35 , the number of descendants of a copy @xmath70 at final time @xmath7 .",
    "in this appendix , complementing section  [ sec : fb_pd ] we derive the relation between @xmath224 $ ] and @xmath225 $ ] , eq.([equ : phw ] ) .",
    "we show the derivation in two ways , one based on path probability densities ( stochastic differential equations ) and the other on fokker - plank equations .",
    "we denote a trajectory of the system by @xmath226 . from the definitions of @xmath224 $ ] and @xmath225 $ ]",
    ", we have @xmath227{\\mathrm{e}}^{-h\\tau \\lambda^w(\\tau)}}{p_{h}[x]{\\mathrm{e}}^{-h\\tau \\lambda(\\tau ) } }    =   \\exp \\bigg [   \\int_{0}^{\\tau }   \\left ( \\dot x - f \\right ) \\cdot \\kappa^{-1 }     w { \\mathrm{d}}t   \\\\ - \\frac{1}{2}\\int_{0}^{\\tau }    w \\cdot \\kappa^{-1 }      w { \\mathrm{d}}t \\bigg ] \\label{supp : eq:9}\\end{gathered}\\ ] ] the integrand on the right - hand side is written as @xmath228 where we have used the expression of @xmath129 as given in the main text ( @xmath229 $ ] ) .",
    "we then consider the integral of the first term on the right hand side : @xmath230 since the trajectory @xmath231 is generated from the stochastic differential equation ( [ modifiedsystemdef ] ) and we use the it convention , the time - derivative of @xmath232 is given by it s formula @xmath233 .",
    "\\label{supp : eq:12}\\ ] ] here @xmath234 is a hessian matrix defined as @xmath235 . combining ( [ supp : eq:12],[supp : eq:11 ] )",
    "we have @xmath236 { \\mathrm{d}}t .",
    "\\label{supp : eq:13}\\end{gathered}\\ ] ] thus , from ( [ supp : eq:9 ] ) , ( [ supp : eq:10 ] ) and ( [ supp : eq:13 ] ) , we get @xmath227{\\mathrm{e}}^{-h\\tau \\lambda^w(\\tau)}}{p_{h}[x]{\\mathrm{e}}^{-h\\tau \\lambda(\\tau ) } }   =   { \\mathrm{e}}^{-v(x(\\tau))+v(x(0 ) ) }    \\\\",
    "\\times \\exp \\bigg \\ {   \\int_{0}^{\\tau }   \\big [ \\frac{1}{2}{\\rm tr}\\left [ b^t   h_v b \\right ]     +   h \\dot x \\cdot     \\lambda_{\\rm c } \\\\ - \\left ( f +   \\frac{w}{2 }   \\right ) \\cdot \\kappa^{-1 }    w \\big ] { \\mathrm{d}}t \\bigg \\ } \\label{supp : eq:14 } \\ ] ] finally , by noticing @xmath237 = { \\rm tr}\\left [ h_v \\kappa \\right ] $ ] and using the definitions of @xmath238 and @xmath30 , the right hand side is @xmath239 hence one arrives at eq .",
    "( [ equ : phw ] ) .",
    "an alternative derivation of ( [ equ : phw ] ) is obtained by using a ` tilted ' generator ( or master operator ) for the biased ensemble of trajectories .",
    "let @xmath240 be the ( unnormalised ) probability density at time @xmath7 , obtained as a marginal of the path distribution @xmath25 .",
    "as discussed , for example , in appendix a.2 of @xcite , this distribution evolves in time according to a generalised feynman - kac formula as @xmath241 , \\label{supp : eq:18}\\ ] ] with @xmath242   \\equiv &   l_{\\rm fp}^{f}[f ] +   h \\left ( \\lambda_{\\rm d } + \\lambda_{\\rm c}\\cdot f \\right ) f \\\\ & + \\frac{h^2}{2 } \\left ( \\lambda_{\\rm c}\\cdot \\kappa \\lambda_{\\rm c } \\right )   f- h \\nabla \\cdot \\left ( \\kappa   \\lambda_{\\rm c } f \\right ) .",
    "\\label{equ : lh } \\end{split}\\ ] ] here , the fokker - planck operator @xmath243 is @xmath244 = - \\nabla \\cdot \\left [    f f \\right ] + \\frac{1}{2 } \\sum_{i , j } \\frac{\\partial ^2}{\\partial x_i\\partial x_j } \\kappa_{ij } f , \\label{supp : eq:21}\\ ] ] where the superscript @xmath245 on @xmath243 indicates that the particle feels the physical force @xmath245 introduced in ( [ equ : dx ] ) .    for the controlled population dynamics ,",
    "the analogue of @xmath246 is @xmath247 , which evolves as @xmath248 $ ] , with @xmath249   \\equiv   l_{\\rm fp}^{f+w}[f ] +   h \\lambda^w f \\label{equ : lw}.\\ ] ]    the relation ( [ equ : phw ] ) follows from a duality relation between @xmath250 and @xmath251 : @xmath252= { \\mathrm{e}}^{v } l^w[f { \\mathrm{e}}^{-v } ] .",
    "\\label{supp : eq:21_1}\\ ] ] this relation may be verified directly from ( [ equ : lh],[equ : lw ] ) , noting that the potential @xmath131 is related to the control @xmath140 via the definition @xmath253 .    from ( [ supp : eq:18 ] ) , we note that the operator @xmath254 corresponds to integration forward in time over a duration @xmath7 . similarly @xmath255 , and from ( [ supp : eq:21_1 ] ) we have @xmath256 = { \\mathrm{e}}^{v } u^w_\\tau[f { \\mathrm{e}}^{-v}]$ ] . setting @xmath257 ,",
    "then @xmath258 $ ] is the ( unnormalised ) probability density at @xmath12 , for a particle that was at @xmath259 a time @xmath7 earlier . defining similarly @xmath260 , ( [ supp : eq:21_1 ] ) implies @xmath261",
    "hence one arrives at ( [ equ : phw ] ) of the main text .",
    "this approach also provides insight into the distributions @xmath64 and @xmath63 , as discussed in  @xcite .",
    "one easily sees that @xmath262 which is independent of @xmath259 .",
    "similarly , @xmath263 for large @xmath7 , the propagator @xmath246 is dominated by the largest eigenvalue of @xmath250 , as @xmath264 where @xmath72 is the dominant right eigenvector of @xmath250 ( required for consistency with ( [ equ : pend - ev ] ) ) , the associated eigenvalue is @xmath29 , and @xmath265 is the dominant left eigenvector .",
    "the approximate equality in ( [ equ : eh - ev ] ) is valid for large times , up to corrections of order @xmath266 , where @xmath267 is the spectral gap of @xmath250 . combining ( [ equ : pend - ev]-[equ : eh - ev ] ) we have @xmath268 .",
    "this approach also shows why @xmath64 is not affected by the control force @xmath140 : the dominant left and right eigenvectors of @xmath250 are @xmath269 and @xmath63 so ( [ supp : eq:21_1 ] ) means that the dominant eigenvectors of @xmath251 are @xmath270 and @xmath271 .",
    "hence it is clear that @xmath272 .    in the special case where @xmath140 is given by the optimal control @xmath149 ( that is defined as the control @xmath140 satisfying the condition @xmath273 in the main text )",
    ", one can show that the controlled system is described by the auxiliary process  @xcite ( or the `` driven process ''  @xcite ) , which is a markov process whose path probability density is equivalent to @xmath25 in its stationary regime .",
    "( indeed , @xmath274 implies @xmath275 , which expresses that @xmath276 conserves probability . ) in this case , one has  @xcite @xmath277=   l_{\\rm fp}^{f+w^*}[f ] + g(h ) f,\\ ] ] where @xmath29 is a constant ( independent of @xmath12 ) : this is the cumulant generating function . comparing with ( [ supp : eq:21_1 ] )",
    "one sees that @xmath152 is independent of @xmath12 , from which it follows that the population dynamics in this case has no cloning or deletion of clones ( this property is true for all finite @xmath34 : all clones have equal weights at all times ) .",
    "here , in order to complement section  [ subsec : iteafeed ] , we explain the algorithm used within the feedback population dynamics .",
    "the procedure is a combination of the population dynamics and an iterative construction of a control potential @xmath166 that is close to the optimal control @xmath153 .",
    "there is considerable flexibility in the precise definitions of the estimators used in this algorithm , but these choices have proven effective in the simple model problem considered here .    1 .",
    "generate @xmath34 initial conditions , for example , drawn from the stationary distribution of the original ( unbiased ) system .",
    "2 .   repeat the following feedback procedure @xmath278 times ( the iteration index is @xmath279 ) .",
    "we denote by @xmath280 the control potential @xmath166 for iteration @xmath162 and we take @xmath281 . 1 .",
    "perform the population dynamics for the system as explained in appendix  [ pdsection ] , using a time interval @xmath282 . the unbiased evolution within the method includes the control force @xmath283 that is obtained from the control potential @xmath163 , and the elimination - multiplication step uses the corresponding biasing factor @xmath284 .",
    "the time @xmath285 between elimination - multiplication steps should be larger than the correlation time of the system . from each time segment",
    "( indexed by @xmath286 ) , estimate the distributions @xmath287 \\mathrm{d}t\\ ] ] and @xmath288 \\mathrm{d}t ,     \\end{gathered}\\ ] ] where the trajectories @xmath289 are defined on the time interval @xmath290 $ ] , as specified in appendix  [ auxiliarypopulationdynamics ] .",
    "the shift parameter @xmath291 is chosen so that @xmath292 is an accurate estimator for @xmath64 , by excluding times @xmath35 that are too close to the final time @xmath293 .",
    "if @xmath285 is large enough , all results should depend weakly on @xmath291 .",
    "2 .   having completed @xmath197 time segments within the population dynamics , evaluate @xmath294 and @xmath295 as @xmath296 3 .",
    "finally , from these distribution functions , calculate @xmath297 in terms of a sum of basis functions , according to eq .",
    "( [ eq : sim_definition ] ) . in practice ,",
    "note that it is not necessary to keep track of the full distributions @xmath292 and @xmath298 , but only those statistics that are required to solve the minimisation in ( [ eq : sim_definition ] ) . also , it is sometimes convenient to take @xmath299 , where @xmath300 is the control potential specified by the right hand side of ( [ eq : sim_definition ] ) , and @xmath301 is a parameter ( with @xmath302 ) that acts to suppress large fluctuations in @xmath131 .",
    "3 .   go back to step @xmath303 and perform the next iteration @xmath304 , with the control potential @xmath178 , and initial conditions for the clones given by their current states @xmath305 .",
    "in this final appendix , in order to complement section  [ sec : numex ] , we explain the property of the system we considered there : the parameters are given by @xmath306 , @xmath307 , @xmath55 , @xmath308 and @xmath309 .",
    "we focus on the small - noise limit @xmath107 . throughout this section",
    ", @xmath18 corresponds to @xmath310 in the main text ( see below ) .      *",
    "the distribution @xmath76 concentrates on a point @xmath311 that is a root of the polynomial @xmath312 this function is sketched in fig .",
    "[ stationaryinstanton_quariticpotential ] . for @xmath36 ,",
    "the concentration is at the positive root ( @xmath313 ) ; for @xmath67 one has @xmath314 . for negative @xmath18 ,",
    "the point @xmath311 decreases quickly from zero and localises at @xmath315 .",
    "* there is a second - order dynamical phase transition at @xmath67 , which appears as divergence of the second derivative of the dynamical free energy , @xmath316 ( see fig .",
    "[ k0m1a1b1cumulant ] , below ) . *",
    "the distribution @xmath72 concentrates on a point @xmath317 , with @xmath318 in general .",
    "this leads to poor convergence of the population dynamics method for small @xmath56 , as discussed in the main text . * even though the system is simple , the analytical expressions of @xmath64 and @xmath63 are not straightforward . in particular , the perfect potential @xmath319 corresponding to @xmath320 is not expressed exactly as the quartic polynomial expansion used to perform a numerical evaluation of @xmath129  however , as described in the main text , this does not affect the effectiveness of the numerical procedure .",
    "( color online ) plots of the polynomial @xmath321 for several @xmath18 .",
    "the roots of this polynomial determine the concentration points of @xmath76 for @xmath107 in the model system considered below.,width=302 ]      we consider the following finite time cumulant generating function : @xmath322 where @xmath323 means the average with respect to the path with a stationary initial condition .",
    "( hereafter , we denote this initial distribution function by @xmath324 . )",
    "the function @xmath325 corresponds to @xmath123 in the main text . by taking @xmath124",
    ", we obtain the following variational principle : @xmath326 \\label{variationalprinciple_epsilon0 } \\end{split}\\ ] ] with the lagrangian @xmath327 defined as @xmath328 and also the free energy function @xmath329 defined as @xmath330 then , the corresponding euler - lagrange equation ( hamilton equation ) , which is obtained from minimising this action , is @xmath331 @xmath332 with the required initial and the final conditions as @xmath333 @xmath334 we analyse these equations numerically and analytically in @xcite . the following results are based on that study .      here , we consider the steady solutions of these instantons , which is defined as the solution obtained from @xmath335 in ( [ lagrange_x_2 ] ) and ( [ lagrange_p ] ) .",
    "these conditions lead to @xmath336 and @xmath337 we plot the left - hand side of ( [ xst_determine_quartic2 ] ) as a function of @xmath12 in fig .",
    "[ stationaryinstanton_quariticpotential ] for several fixed @xmath18 .",
    "the figure shows that this equation has three solutions , when @xmath18 is larger than a certain value ( larger than 0 ) .        from the variational principle ( [ variationalprinciple_epsilon0 ] ) , even in the case where there are multiple instanton solutions , the cumulant generating function can be calculated .",
    "this is based on the observation that the instanton solution corresponding to the minimum is time - independent @xcite .",
    "more precisely , by combining this observation with the variational principle ( [ variationalprinciple_epsilon0 ] ) , we get @xmath338 with @xmath339    we plot the @xmath124 result , @xmath340 , in fig .",
    "[ k0m1a1b1cumulant ] , from which we can see that the generating function has a kink at the origin , which is the sign of the dynamical phase transition in this system , appearing in the zero - temperature limit.asymptotic analysis allows to find @xmath341 with @xmath342 depending on the sign of @xmath18 , as illustrated on fig .",
    "[ k0m1a1b1cumulant ] .    [",
    "[ analytical - expressions - of - p_rm - endx - and - p_rm - avex - in - epsilon - rightarrow-0 ] ] analytical expressions of @xmath72 and @xmath76 in @xmath124 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    finally , we write the explicit analytical expressions of @xmath72 and @xmath76 in the @xmath124 limit .",
    "we consider the biased ( unnormalised ) probability density @xmath343 introduced in the beginning of section  [ sec : fp ] .",
    "we also consider the same function but with fixed initial condition @xmath344 . by using these function",
    ", we introduced two logarithmic functions defined as @xmath345 @xmath346 from the generalised feynman - kac formula ( [ supp : eq:18 ] ) , we obtain the time evolution equation for them as @xmath347 and @xmath348 these equations can be solved in @xmath349 with @xmath35 large limit .",
    "indeed , by setting @xmath350 and @xmath351 with @xmath352 in these expressions , we obtain the equations to determine @xmath353 and @xmath354 as @xmath355 }   \\bigg ] , \\label{wffinal } \\end{split}\\ ] ] and @xmath356 }   \\bigg ] .",
    "\\label{wbfinal } \\end{split}\\ ] ] with @xmath357 @xmath358 where @xmath359.\\ ] ]    equations ( [ wffinal ] ) and ( [ wbfinal ] ) are the key result in this subsection . from them",
    ", we indeed get @xmath360 }   \\big ] { \\mathrm{d}}y \\bigg ] \\label{distributionppop } \\end{split}\\ ] ] and @xmath361 } \\ : { \\mathrm{d}}y   \\bigg ] .",
    "\\label{distributionpaux } \\end{split}\\ ] ] also from the same equations , we get the most probable @xmath12 in @xmath72 and @xmath76 with @xmath124 .",
    "we denote them by @xmath317 and @xmath311 , respectively .",
    "then , from ( [ distributionppop ] ) and ( [ distributionpaux ] ) , we find that these values satisfy @xmath362 where @xmath363 is defined in ( [ steadyassumption ] ) , and @xmath364 since @xmath365 , @xmath311 and @xmath317 are different from each other .",
    "in other words , @xmath64 and @xmath63 concentrate on different values of their argument in the @xmath366 limit , as announced in the main text .    for checking the validity of the obtained expressions",
    ", we numerically solve the equations ( [ wftimeevolution ] ) and ( [ wbtimeevolution ] ) during a sufficiently large time interval @xmath35 .",
    "we set @xmath97 ( fig .",
    "[ forwardh1](a ) and fig .",
    "[ forwardh1](c ) ) and @xmath93 ( fig .  [ forwardh1](b ) and fig .",
    "[ forwardh1](d ) ) .",
    "the different colours represent the different values of @xmath56 : yellow , blue , red lines correspond to @xmath367 , respectively . in the same figure , we plot the analytical lines ( [ wffinal ] ) and ( [ wbfinal ] ) , with @xmath368 ( for all @xmath12 ) ( black solid line ) and @xmath369 ( for all @xmath12 ) ( black dashed line ) .",
    "we can see the convergence of the numerical lines ( with decreasing @xmath56 ) towards the analytical lines ( [ wffinal ] ) and ( [ wbfinal ] ) , where @xmath370 sign is chosen for @xmath371 and @xmath372 sign is chosen for @xmath373 .",
    "r. j. allen , p. b. warren , and p. r. ten wolde , phys .",
    "lett . * 94 * , 018104 ( 2005 ) .",
    "p. g. bolhuis , d. chandler , c. dellago , and p. l. geissler , annu . rev .",
    "phys . chem . * 53 * , 291 ( 2002 ) .",
    "t. nemoto and s .-",
    "sasa , phys . rev .",
    "lett . * 112 * , 090602 ( 2014 ) .    b. a. berg and t. neuhaus ,",
    "physics letters b * 267 * , 249 ( 1991 ) . f. wang and d.p .",
    "landau , phys .",
    "* 86 * , 2050 ( 2001 ) .",
    "l. ortiz and l. kaelbling , proceedings of the sixteenth annual conference on uncertainty in artificial intelligence ( uai-2000 ) , 446 , ( 2000 ) .",
    "h. touchette , phys . rep .",
    "* 478 * , 1 , ( 2009 ) .",
    "a. dembo and o. zeitouni , _ large deviations techniques and applications _",
    "( springer , new york , 1998 ) . l. o. hedges ,",
    "r. l. jack , j. p. garrahan and d. chandler , science * 323 * 1309 ( 2009 ) .",
    "p.  i.  hurtado , c.  p.  espigares , j.  j.  del pozo , p.  l.  garrido , j. stat .",
    "phys . * 154 * , 214 ( 2014 ) .",
    "b. derrida , j. stat .",
    "2007 , p07023 ( 2007 ) .",
    "p.  i.  hurtado and p.  l.  garrido , j. stat .",
    "( 2009 ) p02032 .",
    "all the results presented here can be generalised to models with @xmath374 interacting particles , by replacing @xmath375 and including interaction forces in @xmath376 .",
    "markov jump processes are also workable",
    ". c. w. gardiner , _ handbook of stochastic methods for physics , chemistry , and the natural sciences _ ( springer - verlag , berlin , 1983 ) .",
    "more precisely , when the langevin equation ( [ equ : dx ] ) and the time - averaged quantity ( [ observe_vector ] ) are written in stratonovich convention , one first transforms these equations to ones in it by using a transformation formula @xcite , and then re - define @xmath245 and @xmath377 so that these transformed equations have the same forms as ( [ equ : dx ] ) , ( [ observe_general ] ) , ( [ observe_scalar ] ) and ( [ observe_vector ] ) ( and can be analysed by the same method that is discussed throughout this paper ) .                        @xmath91 is also called the kullback  leibler divergence  @xcite . it is positive and measures the distance between the distributions @xmath64 and @xmath63 .",
    "it is zero if and only if those distributions are equal almost everywhere .",
    "w.  h.  fleming , _ stochastic control and large deviations _",
    ", in _ future tendencies in computer science , control and applied mathematics _ , pages 291 - 300 ( springer , berlin , 1992 ) . c.  hartmann and c.  schtte , j. stat .",
    "( 2012 ) , p11004 .",
    "v.  y.  chernyak , m.  chertkov , j.  bierkens and h.  j.  kappen , j. phys .",
    "a * 47 * , 022001 ( 2013 ) .",
    "r. m. l. evans , phys .",
    "lett . * 92 * , 150601 ( 2004 ) .",
    "r. l. jack and p. sollich , prog .",
    "phys . suppl . *",
    "184 * , 304 ( 2010 ) .",
    "t. nemoto and s .-",
    "sasa , phys .",
    "e * 84 * , 061113 ( 2011 ) . c.  maes and k.  netocny , epl",
    "* 82 * , 30003 ( 2008 ) .",
    "the numerical calculations exploit an `` annealing procedure '' in which @xmath56 is reduced in steps of size @xmath381 , with the best estimate of @xmath149 from the each step being used as the first guess for @xmath149 in the subsequent step .",
    "these integrands , which we denote by @xmath382 and @xmath383 , are proportional to each other when @xmath384 is small . indeed ,",
    "these satisfy @xmath385 .",
    "this is the reason why fig .",
    "[ fig : multiplicitiesdiscussions](a ) and fig .",
    "[ fig : multiplicitiesdiscussions](b ) show similarities ."
  ],
  "abstract_text": [
    "<S> we discuss the giardin - kurchan - peliti population dynamics method for evaluating large deviations of time averaged quantities in markov processes [ phys . </S>",
    "<S> rev . lett . * 96 * , 120603 ( 2006 ) ] . </S>",
    "<S> this method exhibits systematic errors which can be large in some circumstances , particularly for systems with weak noise , with many degrees of freedom , or close to dynamical phase transitions . </S>",
    "<S> we show how these errors can be mitigated by introducing control forces within the algorithm . </S>",
    "<S> these forces are determined by an iteration - and - feedback scheme , inspired by multicanonical methods in equilibrium sampling . </S>",
    "<S> we demonstrate substantially improved results in a simple model and we discuss potential applications to more complex systems . </S>"
  ]
}