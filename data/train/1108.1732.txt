{
  "article_text": [
    "the ability to compute the response of periodic systems to homogeneous electric fields , strain and atomic displacements is a key ingredient in our current understanding of dielectric materials ( also ferroelectrics , piezoelectrics ) : from first principles,@xcite one obtains easily the polarization , dielectric constants , piezoelectric coefficients , phonon band structure , etc .",
    "compared to the treatment of such responses for molecules , the handling of periodic boundary conditions has raised numerous challenges : for instance , the linear potential associated with a static homogeneous electric field breaks the translational symmetry . while such problems have been successfully addressed for the above - mentioned perturbations ,",
    "the treatment of _ homogeneous magnetic fields _ is not as mature . with the current interest in multiferroc materials,@xcite and the long - term interest in magnetic field - based spectroscopies , a unified framework for all these responses",
    "is highly desirable .",
    "the first strategy followed to treat a periodicity breaking was to consider perturbations with specific commensurate wavevectors and corresponding supercells . for atomic displacements ,",
    "this approach is known as the `` frozen - phonon '' method.@xcite homogeneous magnetic fields can be treated in this spirit , with an artificial modulation,@xcite although ( 1 ) working with supercells is cpu time - consuming , ( 2 ) the study of couplings is tedious in this approach .",
    "more powerful formalisms , based on perturbation theory , that do not rely on supercells or long - wavelength limits , have been developed for atomic displacements and electric fields.@xcite for phonons , the long - wavelength phases can be factorized , such that a purely periodic treatment is recovered . for the electric field , the position operator can be replaced by the differentiation with respect to the wavevector .",
    "the berry phase approach to the electrical polarization is probably the most striking consequence of the latter link.@xcite owing to these advances , linear and nonlinear responses can be addressed , as well as couplings between different perturbations , in a purely periodic primitive cell framework .    for homogeneous magnetic fields in insulators",
    "the difficulties outlined above are more severe .",
    "we focus only on the orbital coupling ; coupling to spin is not affected by periodicity issues .",
    "the presence of the magnetic field not only breaks the periodicity of the hamiltonian but also induces a vector coupling to the electron dynamics . in a pioneering work , mauri and louie",
    "proposed a method to compute the orbital magnetic susceptibility ( oms ) from the long wavelength limit of an oscillating perturbation.@xcite the theory has been adapted to the computation of the chemical shielding tensor and related quantities.@xcite although relying on perturbation theory concepts to avoid the use of supercells , this formalism introduces auxiliary oscillating quantities that are not consistent with the periodicity of the lattice and that break the rotational invariance of the global system .",
    "thus for example the tensorial structure of the expression of the oms could not be recovered.@xcite in a related alternative approach , by sebastiani and parrinello,@xcite the position operator is replaced by localized sawtooth potentials , one for each orbital . in practice , the use of supercells , needed to deal with the spatially localized wannier functions , is still necessary in this approach .",
    "recently , a theory of orbital magnetization has been proposed , in which only periodic bloch wavefunctions and hamiltonian are used,@xcite bringing the understanding of this ( bulk ) quantity to the same formal level as the electric polarization .",
    "based on this result , the orbital magnetoelectric coupling has been derived from density - matrix perturbation theory.@xcite no use of a supercell or long - wavelength limit is needed in this approach .    in the present contribution , we show how to apply the density operator approach of ref .",
    ", to _ arbitrary orders of perturbation _ in the magnetic field .",
    "focusing on the second order in this expansion , we obtain a new formula for the oms , based on the first - order response of the density operator to magnetic field and wavevector , in a _ purely periodic _ framework .",
    "the present approach is compatible with the similar treatment of electric fields , of atomic displacements and of their couplings , to arbitrary orders .",
    "we then check the theory by considering a two - dimensional ( 2d ) periodic tight - binding ( tb ) model , for which , thanks to the new approach , the oms can be obtained as an integral over the brillouin zone ( bz ) of an analytical expression .",
    "alternatively , we numerically solve this model for clusters of increasing size , considering explicitly the magnetic field .",
    "essentially exact agreement is obtained between the two approaches .",
    "alternative oms formulae were proposed already fifty years ago,@xcite in the context of effective hamiltonians or tb models . however , none of them seem compatible with the currently used formalisms for electric or atomic displacement responses .",
    "the present approach is actually considerably simpler .",
    "furthermore , to our knowledge , no oms formula for a periodic insulator has ever been validated by comparison with numerical results on a solvable cluster model in the large size limit .",
    "let us recall the first steps in the approach of ref .  . in atomic units ,",
    "the hamiltonian @xmath0 for an electron in a vector potential @xmath1 is @xmath2 , where @xmath3 is the speed of light , and the potential @xmath4 is periodic for lattice vectors @xmath5 , that is , @xmath6 .",
    "choosing the gauge @xmath7 , the hamiltonian does not possess the translation symmetry of the lattice , but does have magnetic translation symmetry.@xcite the kernel of operators @xmath8 possessing this symmetry can be related to a periodic kernel @xmath9 : @xmath10 with @xmath11 .",
    "crucially , the periodic counterpart of the hamiltonian in this approach has no vector potential dependence ( nor magnetic field dependence ) : @xmath12 .",
    "the density operator corresponding to an hamiltonian , for an insulator at @xmath13 kelvin , can be obtained by the minimization of the expectation value of the energy of the system on the ensemble of idempotent density matrices ( _ i.e. _ @xmath14 ) with fixed electron number : @xmath15 \\ } .",
    "\\label{eq : e(b)}\\ ] ] at the minimum , @xmath16=0 $ ] .",
    "the density operator also possesses magnetic translation symmetry , so that eq .",
    "( [ eq : e(b ) ] ) can be recast in terms of @xmath17 and @xmath18 provided that the product of the two operators is transformed according to eq .",
    "( [ eq : transform ] ) . in real space",
    "the product of two operators @xmath19 becomes@xcite @xmath20 where @xmath21 is proportional to the magnetic flux through triangle 123 .",
    "based on eq .",
    "( [ eq : productbar ] ) , @xmath18 is no longer idempotent , due to the appearance of the @xmath22 phase factor . in ref .",
    ", @xmath18 is expanded to first order in @xmath23 , before considering the decomposition of the operators in the bz , in order to obtain the orbital magnetoelectric coupling .",
    "we find that the idempotency problem can be avoided by transforming eq .",
    "( [ eq : productbar ] ) to a combined bz and primitive cell integral , _ before _ any expansion in @xmath23 . to obtain this result",
    ", we decompose periodic operators @xmath24 into operators that are separately periodic in each argument and characterized by a wavevector : @xmath25 with @xmath26 , and @xmath27 for all reciprocal - lattice vectors @xmath28 . under this decomposition ,",
    "( [ eq : productbar ] ) becomes @xmath29 where @xmath30 is the primitive cell volume and @xmath31 is a position- and magnetic field- dependent increment of the wavevector @xmath32 .",
    "such an increment defines an @xmath33-dependent kernel , and hence , an @xmath33-dependent operator .",
    "although unusual , these expressions are mathematically well - defined .",
    "the transformation proceeds with the taylor expansion of @xmath34 with respect to @xmath23 , followed by multiple integrations by parts with respect to @xmath32 .",
    "this procedure yields the full expansion of @xmath35 to all orders in @xmath23 . for simplicity",
    ", we denote the derivatives with respect to @xmath32 in direction @xmath36 by @xmath37 , omit real - space arguments , and use the summation convention with @xmath38 the totally antisymmetric unit tensor .",
    "the expansion is then @xmath39 and explicitly to second order , @xmath40 the density - matrix perturbation theory valid for arbitrary orders of perturbation , as developed in @xmath41-space for homogeneous electric fields,@xcite can now be generalized to magnetic fields . defining perturbation orders by @xmath42 such that @xmath43 , we expand a generic quantity @xmath44 as @xmath45 . the periodic counterpart of the hamiltonian , @xmath46 has no magnetic field dependence , as outlined before , hence , @xmath47 while for @xmath48 , @xmath49 .",
    "the density operator at any order can be decomposed into different blocks , acting inside the occupied subspace ( denoted @xmath4 for valence ) , or inside the unoccupied subspace ( @xmath50 for conduction ) , or coupling different subspaces @xmath51 ( we refer to the subspaces obtained at zero @xmath23 ) . as @xmath52 is block - diagonal in these subspaces , the expansion of the energy yields @xmath53 .",
    "\\label{eq : eccvv}\\ ] ] the first order term is related to the magnetization @xmath54 , @xmath55 , while the second order term is related to the oms @xmath56 , @xmath57 .",
    "the @xmath58 can be found recursively from the @xmath59 , with @xmath60 , by an adaptation of the density - matrix perturbation theory of ref .  .",
    "the block - diagonal parts of density matrices are given by @xmath61 where , for first and second orders , @xmath62   \\nonumber \\\\ - \\frac{1}{8c^2 } & &     \\left(\\prod_{n=1}^2 \\varepsilon_{\\alpha_n \\beta_n \\gamma_n } b_{\\alpha_n}\\right )      \\partial_{\\beta_1 } \\partial_{\\beta_2 } \\tilde{\\rho}^{(0)}_{\\mathbf{k}}.      \\partial_{\\gamma_1 }   \\partial_{\\gamma_2 } \\tilde{\\rho}^{(0)}_{\\mathbf{k}}.      \\label{eq : rho2d}\\end{aligned}\\ ] ] for the full @xmath63 , the off - diagonal @xmath64 blocks are needed in addition to the first - order @xmath65 and @xmath66 blocks , and are obtained by solving the equation @xmath67= \\frac{i}{2c}\\varepsilon_{\\alpha\\beta\\gamma}b_\\alpha(1-\\tilde{\\rho}^{(0)}_{\\mathbf{k } } )    \\nonumber \\\\ \\times [ ( \\partial_{\\beta } \\tilde{\\rho}^{(0)}_{\\mathbf{k } } ) ( \\partial_{\\gamma } \\tilde{h}_{\\mathbf{k } } ) - ( \\partial_{\\beta } \\tilde{h}_{\\mathbf{k } } ) ( \\partial_{\\gamma } \\tilde{\\rho}^{(0)}_{\\mathbf{k } } ) ] \\tilde{\\rho}^{(0)}_{\\mathbf{k } } , \\label{eq : rho1cv}\\end{aligned}\\ ] ] where the r.h.s expression is a @xmath64 projection of the angular - momentum operator times the magnetic field , in reciprocal space.@xcite    for @xmath68 , these equations reduce to eqs .  (",
    "21 ) , ( 23 ) , and ( 28 ) of ref .  , where they have been further expressed in terms of bloch wavefunctions for _ occupied states _ and their first @xmath69-derivatives .",
    "when substituted into the first - order term of eq .",
    "( [ eq : eccvv ] ) , the multi - band formula derived in ref .   for the magnetization",
    "is obtained ( as @xmath70 ) .",
    "likewise , the second - order equations can be expressed in terms of the bloch wavefunctions for occupied states only , their first - order changes , and their first- and second- @xmath69-derivatives , yielding an explicitly periodic formulation of the oms .",
    "these rather lengthy expressions will be detailed elsewhere .",
    "the tensorial structure of eqs .",
    "( [ eq : eccvv][eq : rho1cv ] ) is obvious , as the terms depend on @xmath71 factors of @xmath72 in different directions .",
    "the oms is seen from eq .",
    "( [ eq : eccvv ] ) to arise from both the valence and the conduction subspaces , like the magnetization . for both subspaces , from eq .",
    "( [ eq : rho2d ] ) , there are three contributions : a term quadratic in the density - operator response @xmath73 , a term linear in this response , and a term that is independent of the response of the electrons . the quadratic and linear @xmath64 contributions can be linked to each other on the basis of eq .",
    "( [ eq : rho1cv ] ) .",
    "their sum , being always negative and due to density matrix relaxation , yields the van vleck paramagnetic contribution in the present formalism.@xcite alternative decompositions of the oms eq .",
    "( [ eq : rho2d ] ) exist , similarly to the different expressions for the dielectric susceptibility in density functional perturbation theory , see , _ e.g. _ , eqs .",
    "( 37 ) and ( 38 ) of ref .  .",
    "the expression for the oms presented here can be shown to be variational , and delivers eq .",
    "( [ eq : rho1cv ] ) from euler - lagrange conditions .",
    "the predictions of the theory were checked using a tight - binding model ( fig .  [ tbmodel ] ) .    tight - binding model used to check the theory",
    ". a square lattice of @xmath74 sites and @xmath72 sites are coupled by energies @xmath75 ( a - b nearest - neighbors ) and @xmath76 ( a - a nearest neighbors ) . ]",
    "this model consists of a 2d square lattice with @xmath74 sites at the vertices and @xmath72 sites at the center of each square , with on - site energies @xmath77 .",
    "nearest - neighbor @xmath78 pairs are coupled by energy @xmath75 , and nearest - neighbor @xmath79 pairs by energy @xmath76 ( fig .",
    "[ tbmodel ] ) .",
    "the @xmath74 sites are defined as initially occupied and the b sites empty .",
    "the two different types of couplings are necessary to exhibit non - trivial behavior from all three contributions to the susceptibility ; with only the more obvious @xmath75 couplings , only the frozen - density - operator contribution is non - zero .",
    "following ref .  , the presence of a magnetic field perpendicular to the plane of the model is included by multiplying the hamiltonian matrix elements by @xmath80 , where @xmath81 and @xmath82 describe the locations of the coupled sites .",
    "this model is simple enough for eqs .",
    "( [ eq : eccvv][eq : rho1cv ] ) to lead to analytical expressions , apart for a global integral over the 2d bz .",
    "the occupied ( valence ) band eigenenergies @xmath83 are given by @xmath84 with @xmath85 the periodic part of the bloch eigenfunctions for the valence band are @xmath86 where @xmath87 with these definitions ,",
    "the frozen , linear , and quadratic density operator contributions to @xmath56 are respectively @xmath88 , \\nonumber   \\\\ \\chi_{\\mathrm{lin } } & = & -2 \\chi_{\\mathrm{quad } }   = -2 ( 2\\pi)^{-3 } \\int_{\\rm bz } d{\\mathbf{k}}r^2_{\\mathbf{k}}d_{\\mathbf{k}}^{-5},\\end{aligned}\\ ] ] with @xmath89 .\\end{aligned}\\ ] ] these integrals were carried out numerically to @xmath90 convergence .    the susceptibility of the model was also computed directly , by diagonalization of the hamiltonian matrix for finite size lattices . for an @xmath91 grid",
    "the energy converged roughly like @xmath92 . for a given parameter triple @xmath93 the energy was computed for a range of lattice sizes ( @xmath94 ) , and the resulting values fit to a fourth order polynomial in @xmath92 .",
    "this procedure yielded an estimate of the infinite - size limit accurate to about 1 part in @xmath95 . to compute the second order energy change with magnetic field , energies as a function of mesh size",
    "were computed for parameter triples @xmath96 , where @xmath72 was one of @xmath97 , @xmath98 , and @xmath99 , and @xmath76 and @xmath75 were fixed .",
    "then @xmath100 was estimated from a finite - difference formula , valid when @xmath101 : @xmath102/(3b^2)$ ] , for @xmath103 .",
    "[ t2s ] shows the agreement between the theoretical prediction of @xmath100 and that obtained by exact diagonalization .",
    "magnetic susceptibility for the tight - binding model with ( a ) @xmath104 and a range of @xmath76 values , and ( b ) @xmath105 and a range of @xmath75 values . in both cases , the full theory ( solid line ) is composed of three terms ( dashed line : frozen wavefunction ; dotted : linear in @xmath63 ; dash - dot : quadratic in @xmath63 ) . squares : exact diagonalization values . ]",
    "note that at large @xmath76 or @xmath75 , @xmath100 has substantial contributions from the linear and quadratic components , in addition to the frozen term . in all cases agreement between theory and numerical diagonalization is on the order of a few parts in @xmath106 or better .    beyond the oms , the knowledge of the first - order density matrix allows computation of _ every _ coupling between a magnetic field and other ( regular ) perturbations of the system , as well as the orbital current as needed for the nuclear magnetic resonance ( nmr ) shielding .",
    "indeed , the mixed derivative of the energy with respect to the magnetic field ( indexed by @xmath42 ) and another perturbation ( indexed by @xmath107 ) is given by @xmath108 .",
    "\\label{eq : mixed}\\ ] ] where , crucially , the derivative of the first - order density matrix with respect to @xmath107 is not needed .",
    "the present approach to the oms through expansion of the total energy , eq .",
    "( [ eq : eccvv ] ) , places it in a new framework , in which its link with the orbital magnetization ( from the first - order term ) is clear , and higher - order susceptibilities can be computed as well .",
    "of course , the interest in higher - order derivatives of the total energy with respect to the magnetic field is purely academic .",
    "however , electric fields and vibrational effects can be treated on the same footing , at linear and non - linear orders , so that the path is opened to a unified approach to coupled magnetic , electric and thermodynamic effects in insulators , expected to help understanding multiferrocs , materials for spintronics applications , as well as temperature - dependent responses to magnetic fields , as needed for nmr experiments .",
    "although we have focused on insulators at zero kelvin , a generalization to metals at finite temperatures likely exists , as in the case of the orbital magnetization ( the @xmath109 term in our expansion ) , as outlined in ref .  .",
    "note , however , that the density matrix idempotency relationship @xmath14 is not valid for such cases , so the density - matrix perturbation theory as developed in ref .   can not be applied straightforwardly .",
    "x.  g. acknowledges financial support from the walloon region ( wall - etsf ) , the communaut franaise de belgique ( arc 07/12 - 003 ) , the belgian state - iap program ( p6/42 ) .",
    "j.  z. acknowledges financial support from the canada research chairs program .",
    "r.  w.  nunes and x.  gonze , phys .",
    "b * 63 * , 155107 ( 2001 ) ; i.  souza , j.  iiguez , and d.  vanderbilt , phys .",
    "lett . * 89 * , 117602 ( 2002 ) ; p.",
    "umari and a.  pasquarello , phys .",
    "rev . lett . *",
    "89 * , 157602 ( 2002 ) .",
    "the standard para / dia - magnetism splitting is gauge - dependent . the redefinition of the operators , eq .",
    "( 1 ) , further obscures it , _",
    "e.g. _ , the diamagnetic contribution is negative in our 2d model , in contrast with usual results ."
  ],
  "abstract_text": [
    "<S> the theoretical treatment of homogeneous static magnetic fields in periodic systems is challenging , as the corresponding vector potential breaks the translational invariance of the hamiltonian . </S>",
    "<S> based on density operators and perturbation theory , we propose , for insulators , a periodic framework for the treatment of magnetic fields up to arbitrary order of perturbation , similar to widely used schemes for electric fields . </S>",
    "<S> the second - order term delivers a new , remarkably simple , formulation of the macroscopic orbital magnetic susceptibility for periodic insulators . </S>",
    "<S> we validate the latter expression using a tight - binding model , analytically from the present theory and numerically from the large - size limit of a finite cluster , with excellent numerical agreement . </S>"
  ]
}