{
  "article_text": [
    "point defects can affect the properties of solids in a dramatic way.@xcite they determine , for example , the conductivity of semiconductors , the color of natural crystals , and the mechanical properties of materials . equally important , defects influence or govern the performance and the long - term stability of a wide range of semiconductor devices , such as metal - oxide - semiconductor field - effect transistors , photovoltaic cells , solid fuel cells , to name a few .",
    "the theoretical characterization of defects , especially in wide band - gap materials , has become increasingly important in the attempt to understand and control the performance of these devices.@xcite in the last decades , density functional theory ( dft ) has grown into the standard theoretical model to describe the electronic and atomic structure of solids .",
    "the common approximations to dft , _ viz .",
    "_  the local density approximation ( lda ) and the generalized gradient approximation ( gga ) , systematically underestimate band gaps of semiconductors and insulators .",
    "since the band gap is the relevant energy scale in the study of defects , this so - called `` band - gap problem '' of lda and gga severely affects the predictive power of these approximations when applied to defect levels .",
    "recently there have been lots of efforts to assess the importance of band gap corrections @xcite and to use theoretical models giving a much more appropriate description of the bulk band structure .",
    "the choice of methods is large and includes the lda+@xmath0 method,@xcite approximate self - interaction correction schemes,@xcite hybrid density functionals , @xcite the use of modified pseudopotentials,@xcite empirical schemes,@xcite and more advanced theoretical tools , such as the many - body perturbation theory within the @xmath1 and higher approximations .",
    "@xcite    it appears evident to assume that a good theoretical model must at least satisfy two conditions , namely _ (",
    "i ) _ give an accurate electron density of the defect system and _ ( ii ) _ yield a good band gap of the host material . while these two requirements form a necessary prerequisite to obtain reliable results concerning defect formation energies and associated charge transition levels,@xcite it has recently become apparent that it is by no means sufficient .",
    "this is best exemplified in the case of defect energy levels in zno.@xcite this is a particularly severe case , because the lda and the gga yield a bulk band - gap of 0.6 - 0.8 ev , severely underestimating the experimental value of 3.44 ev . for the case of the ( + 2/0 ) charge transition level of the oxygen vacancy ( v@xmath2 )",
    "theoretical models yield levels either as low as 0.6 ev above the valence band maximum ( vbm ) or as high as 2.4 ev above vbm .",
    "these results differ significantly despite the fact that in all these theoretical models the `` band - gap problem '' was accounted for .",
    "in addition , other critical issues , such as finite - size effects associated to the supercell treatment , were presumably under control in these studies .",
    "furthermore , the first condition concerning the accuracy of the electron density was clearly also fulfilled since the involved electronic state corresponds to the fully symmetric @xmath3 state which is already correctly described via a semilocal functional .",
    "the second condition concerning the band gap was fulfilled by construction .",
    "recently , lany and zunger provided a very detailed overview of the way various theoretical and computational approximations affect the determination of defect formation energies and charge transition levels.@xcite they concluded that , in addition to the two requirements discussed above , a reliable theoretical model should correctly describe the relative positions of all relevant electronic states . for zno",
    ", this condition mainly concerns the position of the zn 3@xmath4 states with respect to the conduction and valence band edges .",
    "the importance of this requirement becomes evident when considering shallow defects , the wavefunctions of which can be always thought as arising from a linear combination of bulk bands .    in this work ,",
    "we show that that there is yet another crucial requirement that the theoretical model must fulfill . in order to yield an appropriate description of defect formation energies and associated charge transition levels ,",
    "the positions of the vbm and the conduction band minimum ( cbm ) with respect to a suitably defined reference potential should also be accurately described . to demonstrate this",
    ", we first calculate the ( + 2/0 ) charge transition level of the v@xmath2 in zno and compare our result with those available in the literature .",
    "our study adds to a series of studies,@xcite in which conflicting results were found .",
    "however , we show that these seemingly incompatible findings agree reasonably with each other when an alternative alignment scheme is used .",
    "we provide theoretical arguments to rationalize this finding .",
    "similar results are expected for other atomically localized defects and for other materials in which the `` band - gap problem '' of semilocal calculations is particularly severe .",
    "our investigation thus leads to a deeper understanding of the `` band - edge problem '' in the theoretical study of defect levels and provides a requirement for the theoretical model in addition to the conditions mentioned above .",
    "this paper is organized as follows . in sec .",
    "[ comp ] , we summarize our computational approach for calculating defect formation energies and charge transition levels . the obtained results are discussed and compared to other calculations in sec .  [ ov ] .",
    "an alignment scheme with respect to the average electrostatic potential is introduced and found to bring all the calculated results in good agreement with each other .",
    "the significance of this alignment of bulk band structures is discussed in more detail in sec .",
    "[ alignment ] . to understand our findings about defect charge transition levels ,",
    "fundamental differences between localized and extended states in approximate dft formulations are discussed in sec .",
    "[ states ] . in sec .",
    "[ edge ] , two different theories reproducing the experimental band gap but differing in the positions of the bulk band edges with respect to the vacuum level are taken under consideration to complete our rationale .",
    "we summarize our work and draw conclusions in sec .",
    "[ conclusions ] .",
    "in the present calculations , the electronic structure was treated using two different functionals .",
    "first , we employed the gga functional proposed by perdew , burke , and ernherhof ( pbe ) .",
    "@xcite for comparison with previous calculations in the literature , we obtained for bulk zno a band gap of 0.83 ev , to be compared with the experimental value of 3.44 ev . to obtain an improved band gap",
    ", we used a hybrid density functional @xcite defined by a single parameter @xmath5 corresponding to the fraction of nonlocal fock exchange admixed to the gga exchange : @xmath6 a hybrid functional with @xmath7 and with the pbe for the gga part @xcite is referred to as pbe0 , pbeh , or pbe1pbe . for zno , we obtained a band gap of 2.82 ev using this functional .",
    "the experimental band gap is reproduced with @xmath8 . in the following ,",
    "we refer to this functional as to pbeh-32 .",
    "while this adjustment of @xmath5 is empirical , it can be justified to a certain extent.@xcite it can be shown that the optimal value of @xmath9 , i.e.  the one which reproduces the experimental band gap , is approximately given by @xmath10 . here",
    ", @xmath11 is the electronic part of the static dielectric constant . for a large number of materials",
    "this relationship is approximately fulfilled.@xcite the adjustment of @xmath5 can also be justified in some cases by comparison with more accurate @xmath1 calculations.@xcite the main quantity that needs to be calculated is the formation energy of the oxygen vacancy in a charge state @xmath12 , which is given as:@xcite @xmath13 here @xmath14 is the total energy of the defect system containing a single o vacancy in the supercell , @xmath15 is the total energy of the host material without any defect , @xmath16 is the atomic chemical potential of oxygen , and @xmath17 is the electron chemical potential .",
    "the latter is referred to the vbm @xmath18 . except for semiconductors with degenerate doping",
    ", @xmath17 varies between zero and the band gap of the material @xmath19 .    the atomic chemical potentials @xmath16 and @xmath20 are bound by the condition that zno is in thermal equilibrium with the reservoir of o and zn atoms , i.e.  @xmath21 .",
    "oxygen - rich conditions are defined by the onset of spontaneous formation of o@xmath22 molecules , i.e.  by @xmath23 .",
    "oxygen - poor ( zn - rich ) conditions are correspondingly defined by the onset of spontaneous formation of bulk zn crystallites , i.e.  via @xmath24 .",
    "the formation of oxygen vacancies in zno is hindered in o - rich conditions , and facilitated in o - poor conditions .",
    "the calculation of the o chemical potential in o - poor conditions poses some difficulties when hybrid density functionals are used , because this involves the calculation of the total energy of bulk zn . in hartree - fock theory",
    "the description of metals leads to divergences , and the same problem is also found with hybrid functionals . to overcome this problem",
    ", we assume that the cohesive energy of bulk zn , which is well described in the gga , does not change significantly in the hybrid functional calculation.@xcite alternatively , one could define the o chemical potential in o - poor conditions by assuming that the separation between the o - rich and o - poor chemical potentials in gga is preserved in the hybrid functional calculation ; this condition corresponds to assuming equal formation energies for zno in gga and in the hybrid functional scheme .",
    "these two ways of determining the o chemical potential in o - poor conditions lead to formation energies differing by about 0.4 ev .",
    "charge transition levels correspond to the specific value of the electron chemical potential for which two charge states have equal formation energies .",
    "the ( + 2/0 ) charge transition level is thus given by : @xmath25 charge transition levels do not depend on atomic chemical potentials .",
    "the calculations were performed within a plane - wave pseudopotential formulation .",
    "soft norm - conserving pseudopotentials @xcite were generated at the pbe level and used in all subsequent calculations .",
    "the plane - wave kinetic energy cutoff , determined by the much harder o pseudopotential , was set to 80 ry .",
    "the calculations in the present paper were performed with the code cpmd.@xcite we explicitly treated the singularity in the nonlocal exchange potential.@xcite    we used the experimental lattice parameters for bulk zno , since these were found to be very close to theoretical lattice parameters obtained with hybrid functionals.@xcite we also used experimental lattice constants in our gga calculations , finding results which did not differ in any significant way from gga calculations performed with theoretical lattice parameters.@xcite upon defect formation , geometry relaxations were performed with both the gga and the pbeh-32 functionals .",
    "the defect structures achieved in the two cases were found to be very similar : in pbeh-32 , for example , pbe - optimized defect structures are only 0.08 ev higher in energy than those optimized consistently at the pbeh-32 level . hence , geometry optimization at the pbeh-32 level has no effect on the position of the ( + 2/0 ) charge transition level [ eq .  ( [ ctl1 ] ) ] .",
    "vs inverse number of atoms contained in the supercell @xmath26 , ( a ) for the pbe calculation ( @xmath27 and @xmath28 @xmath29-point meshes ) and ( b ) for the pbeh-32 calculation ( @xmath27 mesh ) .",
    "@xmath30 is referred to the respective vbm .",
    "[ conv ] , width=264 ]    for the defect structures we used the supercell approach .",
    "this gives rise to finite - size effects which need to be accounted for .",
    "first , as suggested by van de walle and neugebauer , @xcite the total energies of charged defects were corrected by @xmath31 , @xmath32 being the shift needed to align the local potential of the _ neutral _ system far from the defect to that of a separate unperturbed bulk calculation , which was used to determine @xmath18 .",
    "this term was found to be quite small for the supercells employed in our calculations .",
    "second , the total energies of charged defect states are subject to spurious electrostatic contributions associated to the periodic boundary conditions and to the compensating background charge in our supercell calculations . to evaluate these effects , we used an extrapolation scheme based on supercell calculations of increasing size , containing 96 , 192 , and 384 atoms , as shown in fig .",
    "when using the pbe functional , the convergence of formation energies and charge transition levels is accelerated when using the @xmath28 monkhorst - pack mesh instead of a sampling at the sole @xmath33 point [ fig .",
    "[ conv](a ) ] . hence , finite - size corrections are sizeable for the pbe calculation and a careful extrapolation of the results is needed , as previously shown by oba _",
    "_ @xcite at variance , a denser @xmath29-point mesh turned out to be unnecessary for a calculation with the hybrid functional pbeh-32 [ fig .",
    "[ conv](b ) ] . indeed , in the latter case , the bulk band gap is substantially larger and the dispersion of the defect state is already negligible for the smallest supercells considered .",
    "this behavior is in line with observations in a previous study on defects in zno.@xcite a notable difference between finite size effects in pbe and pbeh-32 calculations suggests that unphysical defect - defect interactions mediated by bulk bands could be operative in the former case.@xcite for the largest supercell considered here , we obtain a conservative estimate of 0.20 ev for the residual finite - size error by considering the monopole correction proposed by makov and payne.@xcite",
    "for the neutral oxygen vacancy , we obtained , at the pbe level , formation energies of 3.17 ev in o - rich conditions and of 0.50 ev in o - poor conditions . in the pbeh-32 calculation ,",
    "the corresponding value is 3.57 ev in o - rich conditions . in o - poor conditions , we found 0.50 and 0.90 ev depending on whether the cohesive energy of zn or the formation energy of zno is taken from the gga , respectively .",
    "our values agree well with the value of 0.8 ev found in ref .   and that of 0.9 - 1.0 ev in ref .",
    "thus , our results confirm that the formation energy of the o vacancy in o - poor conditions is small enough to lead to a noticeable concentration of these defects .    at variance with these results ,",
    "janotti and van de walle reported much higher formation energies for the neutral v@xmath2.@xcite they used an extrapolation procedure based on lda+@xmath34 and an additional assumption about the behavior of the formation energy of the _ charged _ vacancy upon the band - gap correction . while the former extrapolation has been criticized due to the unphysical values to which the @xmath34 parameter extrapolates to,@xcite we argue here that it is the latter assumption that is inconsistent with the hybrid functional calculations .",
    "indeed , the extrapolation procedure adopted in ref .   leads to charge transition levels that agree well with those obtained with hybrid functionals .",
    "the dependence of the formation energy on the electron chemical potential is shown fig .",
    "[ format ] for oxygen - poor conditions . for simplicity ,",
    "the oxygen chemical potential was set to the average value derived from the two definition schemes described above .",
    "the ( + 2/0 ) charge transition level occurs at @xmath35 ev .",
    "this result agrees well with other calculations based on hybrid functionals .",
    "et al_.  found the ( + 2/0 ) charge transition level at @xmath36 ev,@xcite using the heyd - scuseria - ernzerhof ( hse ) hybrid functional based on screened exchange@xcite in which the fraction of non - local exchange was set to 0.375 ( hse-37.5 ) . using the same functional but with @xmath5 set to 0.40 ( hse-40 ) , clark _",
    "et al_.   obtained the transition level at @xmath37 ev.@xcite thus , it appears that when @xmath5 in either pbeh or hse functionals is tuned to reproduce the experimental band gap , one consistently obtains the ( + 2/0 ) charge transition level at 2.23@xmath382.38 ev from the vbm .",
    "the occurrence of such an agreement has recently been rationalized in general terms.@xcite janotti and van de walle,@xcite who adopted an extrapolation method based on lda+@xmath34 , found this charge transition level at 2.17 ev , in a fair agreement with the hybrid functional calculations .",
    ", width=188 ]    as already noted in the literature , @xcite the charge transition level at @xmath39-@xmath40 ev is in stark disagreement with calculations based on other methods for correcting the band gap .",
    "for example , adopting a lda@xmath41 scheme,@xcite lany and zunger obtained the charge transition level at @xmath42 ev.@xcite in the lda@xmath41 method , the hubbard @xmath34 term acts on the zn 3@xmath4 states and the band - gap problem is not fully corrected .",
    "when one tunes the @xmath34 parameter so that the position of zn 3@xmath4 states are correctly positioned with respect to the vbm , one obtains a band gap of 1.5 ev , considerably smaller than the experimental one .",
    "the remaining band - gap error was corrected by an upward shift of the cbm.@xcite    in another study , paudel and lambrecht adopted a lda@xmath43 scheme , in which the hubbard @xmath0 term was applied to both zn 3@xmath4 and zn 4@xmath44 states.@xcite while this scheme brings the theoretical band gap in agreement with experiment , the ( + 2/0 ) charge transition level is found at @xmath45 ev .",
    "some of the results obtained in ref .",
    "have recently been reviewed and improved by boonchun and lambrecht.@xcite we here mainly elaborate on the original results , but the conclusions that we draw are independent of this choice . using a similar method as that of paudel and lambrecht , lany and zunger have obtained a level at @xmath46 ev .",
    "@xcite        the charge transition levels obtained with different methods are compared in fig .  [ ov](a ) .",
    "we note that the observed differences do not stem from different electron densities of the defect state , as the oxygen vacancy is characterized by a fully symmetric state of @xmath3 symmetry which is well described in all schemes .",
    "the origin of this apparent disagreement between various methods has lately been discussed to some extent.@xcite however , it remains unclear whether the observed differences originate from failures of some specific methods or whether they point to a more fundamental problem common to all approximate electronic structure methods .",
    "a clue to the understanding why different methods seemingly differ so much is provided by the realization that the band edges of bulk zno calculation undergo drastically different shifts when going from lda / gga calculations @xcite to band - gap corrected schemes . such shifts between two different electronic structure calculations are properly defined through the alignment of the average electrostatic potential .",
    "for example , the lda@xmath41 method of ref .",
    "yields a shift in the vbm , @xmath47 ev . the lda@xmath43 method of ref .   gives a shift of @xmath48 ev , while our calculations yield @xmath49 ev .    in fig .",
    "[ ov](b ) we show the comparison of the ( 2+/0 ) charge transition level obtained with various methods , when the vbms in the lda / gga calculations are aligned .",
    "this is equivalent to aligning the electrostatic potential of all calculations ( see sec .  [ alignment ] ) . with this alignment , the various methods yield charge transition levels differing by at most 0.4 ev .",
    "this is to be contrasted to the variation of up to 1.8 ev achieved when the electronic structures are aligned via their respective vbm [ fig .",
    "[ ov](a ) ] . thus",
    ", these theoretical calculations do not in fact differ as much as has been previously claimed .",
    "our conclusion is that , when a suitably defined common reference level is adopted , the charge transition levels are more accurately described than the bulk band edges.@xcite in secs .",
    "[ states ] and [ edge ] below , we give a detailed explanation of this behavior and address its general consequences for theoretical studies of defects .",
    "the previous discussion relied on the assumption that the bulk band structures of two theoretical calculations can be aligned with respect to each other , as done in fig .",
    "[ ov](b ) .",
    "this alignment allows one to determine the shifts in the valence band @xmath50 and in the conduction band @xmath51 for a given theoretical scheme with respect to another one . in this section",
    ", we discuss the meaning of such an alignment.@xcite    the alignment between the electronic structures of the same bulk material within different theoretical schemes could in principle be achieved through the identification of a common reference potential .",
    "for instance , the vacuum level could serve this purpose , requiring the explicit consideration of the surface between the considered material and vacuum within both theoretical schemes .",
    "since the surface dipole depends on the specific crystal surface which is considered , the same orientation has to be chosen for both theoretical schemes . in this way ,",
    "properly defined bulk levels in the two schemes , such as @xmath18 and @xmath52 , can be positioned with respect to the vacuum level and thus aligned . by constructon ,",
    "the alignment achieved in this way is _ not _ an intrinsic bulk property of the two theoretical schemes .",
    "indeed , differences between the surface dipoles in the two surface calculations directly affect the alignment .",
    "while such a procedure can always be carried out , we note that the alignment between different electronic structures for the same bulk material is a meaningful concept only as long as their associated electron densities are identical ( or very close )",
    ". indeed , different electron densities at surfaces of the material could yield different surface dipoles and thus the achieved alignment would depend on the particular surface adopted and give rise to ambiguity .",
    "moreover , different surface dipoles could result from different electron densities in the bulk , for instance because of different theoretical equilibrium lattice parameters .",
    "in such a case , the alignment with respect to the vacuum level would again be surface dependent .",
    "when comparing electronic structures of bulk materials as achieved within different theoretical schemes , we will thus additionally assume that their electron densities do not differ essentially . in practical calculations involving semilocal and hybrid density functionals ,",
    "this condition is close to being satisfied .",
    "indeed , surface and interface dipoles in a variety of cases were found to differ by at most a few tenths of an ev.@xcite    under the assumption of yielding close electron densities , two different theoretical schemes can be expected to give similar surface dipoles .",
    "this implies that an alignment to the vacuum level is equivalent to an alignment to the average electrostatic potentials within the bulk of the materials.@xcite this consequence is particularly convenient and allows us to compare different bulk calculations without the necessity of performing surface calculations.@xcite note , however , that it is implicitly understood that alignment shifts resulting from slight differences in the electron density are negligible when compared to the shifts undergone by the band edges .    to produce fig .",
    "[ ov](b ) , we relied on shifts @xmath50 and @xmath51 calculated in the respective papers . indeed , the position of the vbm and the cbm in the more advanced theory were generally given with respect to the ( semi-)local density functional calculation ( lda or gga ) for an alignment with respect to the average electrostatic potential .",
    "for instance , the lda@xmath43 and lda band structures obtained in ref .  , corresponding to the left column in fig .",
    "[ ov](b ) , were aligned through the average electrostatic potential in the bulk . in refs .  , corresponding to the results in the middle column in fig .",
    "[ ov](b ) , the authors determined the shifts of the bulk bands in the lda@xmath41 with respect to the lda by referring the energies to o 2@xmath44 states which do not directly couple to the @xmath4 states on which the hubbard correction was applied .",
    "this is again equivalent to the alignment to the average electrostatic potential in the bulk . in our own calculations ,",
    "presented in the right column in fig .",
    "[ ov](b ) , we aligned the two band structures through the average electrostatic potential in the bulk .",
    "unfortunately , the reported data did not allow us to establish the relative alignment for all the studies referred to in fig .",
    "[ ov](a ) .",
    "however , we can assume that similar theories yield close @xmath50 and @xmath51 .",
    "for instance , the lda@xmath43 calculations of lany and zunger @xcite are expected to yield similar shifts as those found by paudel and lambrecht @xcite [ fig .  [ ov](a ) ] .",
    "as far as the screened hybrid functionals are concerned [ fig .",
    "[ ov](a ) ] , a recent study has shown that these functionals yield very similar shifts as the unscreened functionals used in our calculations , as long as the fraction of nonlocal exchange is tuned to reproduce the experimental band gap.@xcite hence , although the results in fig .  [ ov](b ) are restricted to those studies which explicitly give the shifts in the band edges , the present considerations are expected to carry a much broader validity and to equally hold for all other calculations reported in fig .",
    "[ ov](a ) .",
    "we showed above that different theoretical models give quite consistent results concerning the description of the ( + 2/0 ) charge transition level of the o vacancy in zno provided they are aligned through the average electrostatic potential , taken as a common reference level . to understand why this happens",
    ", we first discuss fundamental differences between localized ( atomic - like ) and extended ( bulk - like ) states in approximate density functional schemes .    for ( approximate )",
    "density functionals janak s theorem @xcite applies : @xmath53 i.e.  the derivative of the total energy with respect to the change of occupation number @xmath54 of the highest - occupied state @xmath55 is equal to the single - particle eigenvalue of this state @xmath56 , when the latter is referred to the average local potential.@xcite    the integral form of janak s theorem is @xmath57 where @xmath58 is the total energy of the system with @xmath59 electrons . in the above expressions , we suppressed the spin variable . while in the original derivation of janak s theorem the functionals were implicitly assumed to be continuous , eq .",
    "( [ janak1 ] ) equally applies to functionals which possess a discontinuity @xcite at integer number of electrons . in this case one",
    "has to distinguish between left and right derivatives and the corresponding single particle eigenvalues .",
    "the integral form of janak s theorem , eq .",
    "( [ janak2 ] ) , applies to discontinuous functionals without modifications .    in the case of localized states , such as ,",
    "e.g. , in molecules and atoms , the single particle eigenvalue in approximate density functional schemes depends sensitively on the fractional occupation .",
    "accordingly , total energy differences pertaining to the change of number of electrons are given by eq .",
    "( [ janak2 ] ) .",
    "in particular , the ionization potential ( ip ) of a system is given by @xmath60 where @xmath61 is the highest occupied orbital of the @xmath59-electron system .",
    "similarly , the electron affinity ( ea ) can be expressed as @xmath62 where @xmath63 is the lowest unoccupied state of the @xmath59-electron system .",
    "it has been known for some time that total energy differences pertaining to the change of charge state of a localized state are quite accurately described in approximate density functional schemes , both in semilocal and hybrid ones .",
    "for example , curtiss _",
    "et al_.  calculated ips and eas for a large set of molecules using gga and hybrid functionals.@xcite they calculated these quantities via total energy differences ( @xmath64scf method ) , yielding an average deviation with respect to experiment lower than @xmath65-@xmath66 ev for both gga ( blyp ) and hybrid ( b3lyp ) functionals .",
    "this accuracy is achieved despite the fact that the single - particle eigenvalues of the highest - occupied molecular orbital ( homo ) @xmath67 and of the lowest - unoccupied molecular orbital ( lumo ) @xmath68 are substantially different in the gga and in hybrid functional schemes .",
    "a similar agreement with experiment also holds for screened hybrid functionals.@xcite however , plain lda yields slightly larger errors , of the order of @xmath69-@xmath70 ev for the same quantities.@xcite    we illustrate this property in the case of the pentacene ( c@xmath71h@xmath72 ) molecule in fig .",
    "[ molecules].@xcite pentacene is a convenient example because , unlike several smaller acenes , it possesses a positive electron affinity .",
    "the single - particle homo and lumo levels , calculated with the semilocal pbe functional ( left , solid lines ) , do not agree well with the negative of the experimental ip and ea ( right ) .",
    "in particular , the single - particle gap @xmath73 of 1.12 ev is severely underestimated with respect to the experimental gap @xmath74 of 5.29 ev .",
    "the use of the hybrid pbe0 ( i.e.  pbeh-25 ) functional ( left , dashed lines ) gives some improvement , but the calculated single - particle homo - lumo gap of 2.34 ev remains much smaller than the experimental one . at variance ,",
    "when calculated via total energy differences , the ips and eas in both pbe and pbe0 are much closer to their corresponding experimental values , 6.64 ev@xcite and 1.35 ev,@xcite respectively .",
    "the two theoretical values ( fig .",
    "[ molecules ] ) differ by less than 0.10 ev , with the hybrid functional calculation in slightly better agreement with the experimental results .",
    "the residual differences between calculated and measured values ( @xmath750.45 ev for the ip and @xmath750.25 ev for the ea ) can be accounted for by the quite large electron correlation effects in the pentacene molecule.@xcite in any case , the present result shows that these theoretical schemes yield total energy differences in good agreement with experiment and with each other , while the single - particle levels in the two schemes are very different .",
    "this is consistent with the general trend found by curtiss _",
    "for a large set of smaller molecules.@xcite        thus , we conclude that total energy differences pertaining to the change of charge state of localized states are accurately described with approximate density functionals . approximating the integrals appearing in eqs .",
    "( [ janak_ip ] ) and ( [ janak_ea ] ) through the trapezoidal rule , we arrive at the following expressions for the ip and the ea : @xmath76 and @xmath77 here , @xmath78 and @xmath79 . electronic states at half - filling correspond to slater - transition states.@xcite since eqs .",
    "( [ slater_ip ] ) and ( [ slater_ea ] ) apply equally well to various semilocal and hybrid functionals , the generally good agreement with experiment implies that the respective eigenvalues @xmath80 defined as a function of filling all approximately cross at half - filling .",
    "this has indeed already been observed.@xcite    the reason for this good performance of approximate density functionals should be ascribed to the fact that such functionals fulfill several exact constraints of the many - body fermionic system.@xcite in particular , the most relevant in this context is the generalized sum - rule of the exchange - correlation hole .",
    "this rule holds for systems with an _ integer _ number of electrons , i.e.  for closed systems in which no exchange of electrons with the environment occurs.@xcite this condition is enforced for most approximate functionals , including the lda and various ggas .",
    "furthermore , since this constraint is naturally fulfilled in the hartree - fock theory , it also holds for any hybrid functional with an exchange energy of the type given in eq .",
    "( [ hb ] ) .",
    "the situation is very different in the case of infinitely extended bulk - like states .",
    "indeed the band - gap problem pertaining to ( generalized ) kohn - sham eigenvalues _ can not _ be overcome by considering total - energy differences .",
    "when a fraction @xmath81 of an electron or even a full electron is added to or removed from an extended state , the total electron density changes negligibly .",
    "thus , the local potential , both the hartree and the approximate exchange - correlation potential remain unaffected . as a result ,",
    "the single - particle eigenvalues do not depend on the filling @xmath81 of this state . using the integral form of janak s theorem given in eq .",
    "( [ janak2 ] ) , we get for the valence band maximum : @xmath82 and for the conduction band minimum : @xmath83 to illustrate this property , we show in fig .",
    "[ extended ] the vbm and cbm of @xmath84-quartz calculated via total energy differences as a function of the supercell size .",
    "the considered cells contain 72 , 144 , 288 , and 576 atoms , and their brillouin zones are sampled at the sole @xmath33 point .",
    "the semilocal pbe functional was used . in the case of @xmath84-quartz ,",
    "total energy differences are very close to single particle eigenvalues already for the smallest cells . for the 72-atom cell ,",
    "the difference is 0.015 ev for the vbm and 0.035 ev for the cbm , while for the 576 cell these are 0.003 ev and 0.004 ev , respectively .",
    "the particular case of hybrid functionals has been addressed in detail in ref .  .",
    "hence , unlike for the localized states in fig .",
    "[ molecules ] , the consideration of total - energy differences in the case of extended states is not useful to improve the comparison with experiment and the same limitations pertaining to the single - particle eigenvalues ( band - gap problem ) are encountered .",
    "@xcite a similar comparison involving extended states of gaas and localized states of the f atom can be found in ref .  .",
    "( @xmath84-quartz ) calculated via total energy differences as a function of @xmath85 , where @xmath86 is the total number of atoms in the supercell .",
    "calculations have been performed with the semilocal pbe functional.,width=321 ]    the above discussion highlights an important difference between localized and extended states as described within approximate density functional schemes .",
    "while the band - gap problem associated to single particle eigenvalues can be circumvented by considering total - energy differences for localized states , such a solution does not apply to extended states for which the band - gap problem remains a fundamental obstacle .",
    "recently , a clear explanation has been put forward for justifying this different behavior.@xcite the inaccurate total energies for large systems with _",
    "number of electrons stems from the failure of approximate density functionals in describing small systems with _",
    "charges.@xcite indeed , approximate functionals generally do not reproduce the property of the exact density functional by which the total energy depends linearly on the number of electrons .",
    "there is at present an on - going effort to achieve improved descriptions on the basis of these ideas.@xcite the degree of localization required for achieving an accurate description with current density functionals is still to a large extent an open question .",
    "we refer the reader to the interesting debate on this issue in refs .  .",
    "having stressed the different properties of localized and extended states with respect to a change in electron occupation , we return in this section to the discussion of charge transition levels . for",
    "the sake of simplicity , let us consider the @xmath87 transition of a point defect characterized by an atomically localized wave function .",
    "using eq .",
    "( [ ted_ev ] ) , we write the charge transition level @xmath88 as the difference between two terms , each of them corresponding to a total - energy difference : @xmath89 the second term clearly describes the total energy difference pertaining to a delocalized bulk state , while the first term can to a very good approximation be related to the total energy difference pertaining to a localized state .",
    "formally , the first term describes the total energy of the whole manifold of states involving both defect and bulk states , but can be related to the localized defect state through the slater transition - state approximation.@xcite for atomically localized defect states , this is a very good approximation.@xcite in view of the following discussion , it is convenient to rewrite eq .",
    "( [ ted2 ] ) as @xmath90 where the charge transition level @xmath91 and the vbm @xmath92 are referred to the average electrostatic potential @xmath93 of the unperturbed bulk material .",
    "let us assume that we study the @xmath87 charge transition level of the same defect using two different theories : theory i and theory ii .",
    "the first theory severely underestimates the band gap , while the second one gives a band gap in a much closer agreement with experiment .",
    "the two theories differ only by the exchange - correlation potential . according to eq .",
    "( [ ted3 ] ) , the corresponding charge transition levels referred to the respective valence band maxima are : @xmath94 and @xmath95 we further assume that the two theories produce a sufficiently accurate representation of the electron density so that it is justified to align the two bulk band structures through the average electrostatic potential @xmath93 in the two theories , as discussed in sec .  [ alignment ] . under the assumption that the defect wave function @xmath96 differs very little in the two theories",
    ", we can express the difference between the two charge transition levels @xmath91 making use of the slater transition state:@xcite @xmath97 where the exchange - correlation potentials are evaluated with the defect state at half occupation .",
    "only the difference in the exchange - correlation potentials enters the expression in eq .",
    "( [ janak_defect ] ) . indeed , if the electron density and the single - particle wave functions are very similar in the two calculations , the interaction between the defect and the ionic cores , the long - range electrostatic electron - electron interaction , and the kinetic energy are the same in the two theories and cancel .    to understand the behavior of defect levels , it is convenient to focus first on defects with extremely localized wave functions . hence , according to eq .",
    "( [ janak_defect ] ) , the difference @xmath98 can then be expressed in terms of an expectation value involving the sole localized defect state.@xcite however , we know from sec",
    ".  [ states ] that total energy differences pertaining to localized states , or , equivalently , slater transition - state eigenvalues of localized states , are almost the same , independent of the functional .",
    "thus , we get : @xmath99 this means that charge transition levels for such defects are almost equal in the two theories , when the energy scales are aligned through the average electrostatic potential @xmath93 . at variance , the charge transition levels are substantially different when the energy scales in the two theories are aligned through the respective valence band maxima , i.e.  through @xmath100 in eqs .",
    "( [ rw1 ] ) and ( [ rw2 ] ) , because of the different positions of the bulk band edges with respect to the potential @xmath93 .",
    "this scenario pertaining to a defect with an extremely localized wave function is illustrated in fig .",
    "[ th2 ] by the defect state @xmath5 .",
    "the validity of the ideal alignment illustrated by this type of defect has been demonstrated for a wide class of defects encompassing various host materials.@xcite     schematic illustration of energy levels of various type of defect states differing by the extent of their wave function : ( a ) defect level with an atomically localized wave function , ( b ) an intermediate case , and ( c ) an effective - mass - like defect .",
    "the results of two electronic structure theories ( theory i and theory ii ) giving different band gaps are compared to illustrate the band - gap problem .",
    "the alignment is made through the average electrostatic potential.,width=321 ]    figure [ th2 ] also illustrates the shifts of other type of defects . in the opposite limit ,",
    "defect @xmath101 corresponds to an effective - mass - like defect with a spatially extended wave function . in this case , the defect level is anchored to the bulk band to which it pertains and rigidly follows the band edge upon the opening of the band gap in theory ii .",
    "defect @xmath102 has an intermediate extension compared to defects @xmath5 and @xmath101 , and is partially affected by the shift of the band edges .",
    "the relation between the departure from ideal alignment and the spatial extension of the defect wave functions has been documented for various defects and host materials in ref .  . however , the detailed behavior of such defects is intrinsically system - dependent , and no universal considerations can be made .    in this section , we limited the discussion to defects states occurring in the band gap for both theories .",
    "more complex situations occur when defect states are resonant with the band states for one of the theories.@xcite however , the physical description of the defect state is altered in such cases .",
    "the main motivation of the present work is to understand the effect of the band gap opening under the assumption that the defect wave function remains essentially unmodified .      in the previous section",
    ", we compared defect charge transition levels as obtained within two different theories giving different band gaps .",
    "we found that the energy levels of defects states described by atomically localized wave functions are already well described in theories with a pronounced `` band - gap problem '' , provided those levels are referred to a relevant reference level . for such defects , the problem of finding the defect level",
    "is essentially decoupled from that of finding the band edges .",
    "schematic illustration of energy levels of various type of defect states differing by the extent of their wave function : ( a ) a deep defect level with an atomically localized wave function , ( b ) an intermediate case , and ( c ) an effective - mass - like defect .",
    "the results of two electronic structure theories ( theory i and theory ii ) giving the same band gap but different band edge positions are compared to illustrate the `` band - edge problem '' .",
    "the alignment is made through the average electrostatic potential.,width=321 ]    let us thus consider two different theories , theory i and theory ii , yielding this time the same band gap ( taken to coincide with the experimental one ) , but giving different positions of the vbm and the cbm with respect to the average electrostatic potential @xmath93 of the bulk .",
    "we assume that the two theories are sufficently accurate yielding in particular close electron densities , so that the energy scales of the two theories can be aligned through @xmath93 , as discussed in sec .",
    "[ alignment ] .",
    "for instance , theory i could be lda+@xmath0 in which the remaining band - gap underestimation is corrected by a rigid shift of the conduction band , while theory ii could be a hybrid functional scheme in which the fraction of fock exchange is tuned to reproduce the experimental band gap . for an atomically localized defect , the same argument holds as in the previous section and the charge transition levels obtained within the two theories",
    "are expected to fall very close to each other , as illustrated in fig .",
    "[ th3 ] for defect @xmath5 . in fig .",
    "[ th3 ] , a departure from the ideal alignment is seen for defects @xmath102 and @xmath101 , corresponding to defect wave functions of intermediate and effective - mass - like extensions , respectively . figure [ th3 ] summarizes the principal finding of the present work . in a condensed form , the following statement can be formulated concerning the comparison of charge transition levels of atomically localized defects . despite the good description of the experimental band gap in both theories , the defect levels differ when referred to their respective vbm , because the band edges in the two theories are located differently with respect to the common electrostatic potential @xmath93 .",
    "this occurs even when the defect wave function is almost identical in the two theories .",
    "this alignment property deteriorates with the extension of the defect wave function .",
    "thus , the correct description of band edges relative to the average electrostatic potential is a crucial prerequisite for an accurate location of charge transition levels within the band gap .",
    "we refer to this issue as to the `` band - edge problem '' for the calculation of defect levels .",
    "in other words , there is not only a `` band gap problem '' related to the underestimation of the band gap but also a `` band - edge problem '' related to the position of the band edges with respect to the average electrostatic potential , ultimately corresponding to an absolute alignment with respect to an external vacuum level .",
    "as far as the determination of the ( + 2/0 ) charge transition level of the oxygen vacancy in zno is concerned , the present considerations appear confirmed [ cf .",
    "[ ov](b ) ] .",
    "this defect level behaves like the defect state @xmath102 in fig .",
    "[ th3 ] , showing a shift which does not depart in a significant way from the case of ideal alignment ( defect state @xmath5 ) . indeed ,",
    "when referred to a common reference level , all previous calculations yield the ( + 2/0 ) level within 0.4 ev,@xcite which corresponds to just one ninth of the band gap of bulk zno . hence",
    ", contrary to previous claims , we find that all previous defect calculations agree quite well with each other .",
    "in fact , these calculations differ in the positions of the bulk band edges with respect to the average electrostatic potential .",
    "these considerations lead to the question about which theoretical description should be adopted for positioning the band edges .",
    "this corresponds to determining the shift @xmath50 of the valence band and the shift @xmath51 of the conduction band , when taking the lda or the gga as a starting point .",
    "a direct comparison between theory and experiment is in principle possible .",
    "the bulk band structure can for instance be referred to the vacuum level through a surface calculation .",
    "the vbm and the cbm determined in this way could then be compared with ionization potentials and electron affinities , as obtained by means of photoelectron and inverse photoelectron spectroscopy .",
    "however , such measurements are often shrouded by very pronounced effects associated to charged native defects and impurities which influence the electrostatics and alter the alignment .",
    "more practically , the validity of a given theoretical scheme can be examined addressing band offsets at interfaces.@xcite band offsets are well - defined quantities and can generally be measured through a large set of experimental techniques .",
    "the comparison between theoretical and experimental band offsets then allows one to determine the overall accuracy with which such shifts are obtained within various theoretical schemes .    in the absence of experimental data ,",
    "the validity of the shifts @xmath50 and @xmath51 could also be assessed by comparing with electronic structure calculations of higher accuracy , such as those based on many - body perturbation theory ( mbpt ) in the @xmath1 approximation or beyond.@xcite indeed , such calculations not only provide improved relative positions of bulk bands , but also shifts of those bands with respect to theoretical schemes of lower level .",
    "however , recent work has shown that the shifts of the band edges with respect to the average electrostatic potential are more difficult to converge than relative positions of bands.@xcite furthermore , such shifts are sensitive to various levels of approximation , such as , e.g. , the use of different models for the plasmon pole to describe the frequency dependence of the dielectric function , the inclusion of vertex corrections @xmath33 , and various levels of self - consistency on @xmath103 , @xmath104 , @xmath33 , and the electron wave functions .",
    "@xcite to illustrate this point , we quote a recent work , @xcite in which the relative shift of the valence band with respect to the overall band gap correction , i.e.  @xmath105 , was found to range from @xmath380.68 to @xmath380.42 in the case of sio@xmath22 , depending on the level of approximation in the @xmath1 scheme . even for a material as simple as si the value of @xmath105 as predicted by different @xmath1 schemes ranges from @xmath380.75 to + 0.17.@xcite thus ,",
    "clearly more work is needed to clarify these issues .",
    "a systematic study of the effects of different levels of approximation in mbpt on the shifts in the band edges is thus vital for the study of defect levels .",
    "in this work , we carried out a theoretical analysis of the ( + 2/0 ) charge transition level of the oxygen vacancy in zno . in recent years , this defect has grown into a benchmark case to assess the quality of various advanced electronic - structure theories . indeed , common approximations to density functional theory , such as the lda and the various ggas , severely underestimate the band gap of bulk zno , and the treatment at a more advanced level thus becomes crucial even for drawing qualitative conclusions .",
    "however , different advanced theoretical methods applied hitherto yielded conflicting results regarding the position of the defect level in the band gap .",
    "we here showed that apparently conflicting theoretical results are in a much better agreement with each other when the charge transition levels are aligned with respect to the average electrostatic potential rather than to the respective valence band maximum .",
    "we showed that the former alignment is equivalent to the choice of a common external potential such as the vacuum level , provided the electron densities are sufficiently accurately described .",
    "we have rationalized our finding by considering fundamental differences between the ways approximate density functionals describe localized and delocalized states . for localized states , the `` band - gap problem ''",
    "can generally be overcome through the consideration of total energy differences . on the other hand ,",
    "such a solution is not applicable to delocalized states , for which the `` band - gap problem '' remains an intrinsic shortcoming .",
    "in particular , the present study highlights a specific criterion that needs to be fulfilled in order to properly describe charge transition level and formation energies of defects .",
    "we clearly demonstrated that the band structure of the host material needs to be correctly positioned with respect to an external potential , such as the vacuum level .",
    "when the electron density is accurately described , this alignment condition can equivalently be replaced by the alignment with respect to the average electrostatic potential in the bulk .",
    "this condition is additional with respect to the accurate reproduction of the band gap .",
    "our analysis of the oxygen vacancy in zno shows that conflicting theoretical results arise for theories yielding an accurate band gap , but differing positions for the band edges .",
    "we particularly thank p. broqvist for his contribution to a wider research project from which the present study takes its origin .",
    "we also acknowledge fruitful interactions with a. carvalho , h .-",
    "komsa , and o. a. vydrov .",
    "partial financial support from the swiss national science foundation is acknowledged under grant no .",
    "200020 - 111747 .",
    "we used computational resources at dit - epfl ( bluegene ) , csea - epfl , and cscs .                                                                                                            in the case of zno lda yields a band gap of about 0.6 ev , which is yet smaller that the one in the gga calculation .",
    "however , for the sake of simplicity we assume that bulk band edges are described similarly in lda and gga .",
    "the error this assumption introduces is of the order of 0.1 ev ( ref .  ) and thus unsubstantial for our consideration .",
    "the calculations of the pentacene molecule were performed with cubic supercells of increasing side ( 30  , 40  , and 50  ) and extrapolated to infinity .",
    "single particle eigenvalues were aligned to the vacuum level far from the molecule . for charged systems ,",
    "this vacuum level was preserved at the same energy and the total energies were consistently corrected .",
    "in addition , the electrostatic monopole - monopole correction reflecting the interaction of an array of charges with the neutralizing background was included ."
  ],
  "abstract_text": [
    "<S> calculations of formation energies and charge transition levels of defects routinely rely on density functional theory ( dft ) for describing the electronic structure . since bulk band gaps of semiconductors and insulators are not well described in semilocal approximations to dft , band - gap correction schemes or advanced theoretical models which properly describe band gaps need to be employed . </S>",
    "<S> however , it has become apparent that different methods that reproduce the experimental band gap can yield substantially different results regarding charge transition levels of point defects . </S>",
    "<S> we investigate this problem in the case of the ( + 2/0 ) charge transition level of the o vacancy in zno , which has attracted considerable attention as a benchmark case . for this purpose , </S>",
    "<S> we first perform calculations based on non - screened hybrid density functionals , and then compare our results with those of other methods . while our results agree very well with those obtained with screened hybrid functionals , they are strikingly different compared to those obtained with other band - gap - corrected schemes . </S>",
    "<S> nevertheless , we show that all the different methods agree well with each other and with our calculations when a suitable alignment procedure is adopted . </S>",
    "<S> the proposed procedure consists in aligning the electron band structure through an external potential , such as the vacuum level . when the electron densities are well reproduced , this procedure is equivalent to an alignment through the average electrostatic potential in a calculation subject to periodic boundary conditions . </S>",
    "<S> we stress that , in order to give accurate defect levels , a theoretical scheme is required to yield not only _ band gaps _ in agreement with experiment , but also _ band edges _ correctly positioned with respect to such a reference potential . </S>"
  ]
}