{
  "article_text": [
    "given a binary image consisting of object and background grid points , the distance transform assigns to each object grid point its distance value to the closest background grid point .",
    "the distance transform provides valuable information for shape analysis and is widely used in several applications @xcite , such as , for example , skeleton extraction @xcite , template matching @xcite , shape based interpolation @xcite or image registration @xcite .",
    "computing the distance from each object grid point to each background grid point would lead to a far too high computational cost .",
    "numerous authors have thus investigated alternative ways of computing distance maps .",
    "to do so , they use the spatial consistency of a distance map , which allows propagation of local information . in this paper , we focus on one such algorithm , the chamfer algorithm , which computes the _ weighted distance transform _ ( wdt ) . when using the chamfer algorithm , only a small neighborhood of each grid point is considered .",
    "a weight , a _ local distance _ , is assigned to each grid point in the neighborhood . by propagating the local distances in the two - scan algorithm ,",
    "the correct distance map is obtained .",
    "for example , the well - known two dimensional city - block ( @xmath0 ) and chessboard ( @xmath1 ) distances can be obtained in this way by using unit weights for the neighbors .",
    "it has been shown that in two dimensions , the hexagonal grid is in many ways to prefer over the usual square grid , @xcite .",
    "for example , since the hexagonal grid constitutes the closest sphere packing @xcite , only @xmath2 of the number of samples needed in the square grid can be used without information loss , @xcite . extending this to three dimensions ,",
    "the face - centered cubic ( fcc ) grid is the lattice with the highest packing density , resulting in that less samples are needed for the fcc grid without loosing information , compared to the cubic grid , @xcite .",
    "the reciprocal grid of the fcc grid is the body - centered cubic ( bcc ) grid .",
    "this means that if the fcc grid is used in the spatial / frequency domain , then the bcc grid is used to represent the image in the frequency / spatial domain .",
    "the fcc grid has the highest packing density , so this grid is preferably used in frequency domain resulting in that only @xmath3 of the samples are needed for an image on the bcc grid compared to the cubic grid . if the fcc grid is used in spatial domain instead , @xmath4 of the samples can be used without loosing information , @xcite .",
    "this reasoning requires that it is possible to acquire images directly to the grids with non - cubic voxels . in theory , any tomography - based technique for acquiring volume images ( i.e. , that gives a sequence of 2d slices ) such as magnetic resonance imaging ( mri ) , computed tomography ( ct ) , single photon emission computed tomography ( spect ) , or positron emission tomography ( pet ) can be adjusted to work on the fcc or bcc grids .    for spect and ct , using the filtered back - projection method or direct fourier methods , the fact that the fourier transform for the fcc and bcc grids ( and for two - dimensional planes that correspond to the 2d slices ) exists is enough .",
    "images on the fcc and bcc grids acquired using the algebraic reconstruction technique for spect or ct is found in @xcite .",
    "they use spherically - symmetric volume elements ( blobs ) , @xcite . with the pet - technique ,",
    "the origin of gamma - rays ( produced by annihilation of an emitted positron and an electron ) are computed .",
    "the technique does not depend on the underlying grid except in the digitization step , which just as well can be performed on the fcc and bcc grids .",
    "dealing with digital images means dealing with discrete grids .",
    "indeed , digital images are discrete representation of the continuous world . two kind of approaches",
    "can be adopted to deal with discrete grids .",
    "the first one applies continuous methods to the discrete grid .",
    "this is the case of the euclidean distance transform ( edt ) which aims at computing exact euclidean distance on discrete images . the second approach , called discrete geometry , consists in developing tools directly devoted to digital images and discrete grids .",
    "this is the case of the wdt which can , for example , be computed using a two - scan algorithm , a _ chamfer algorithm _ in the usual square grid @xcite .    since computing the wdt is less memory demanding and faster than computing the edt , the wdt is preferable in situations where the data set is too big to fit into the central memory ( such as in @xcite ) or the computational time",
    "should be minimized ( recent contributions involve speedup of level - set methods , @xcite , and real - time tele - operated force - feedback , @xcite ) . it should be mentioned that there are linear - time ( or almost linear ) algorithms for computing the edt obtained by sequentially propagating vectors , @xcite , and dimensionality reduction , @xcite .",
    "these algorithms are , however , not as fast as the chamfer algorithm since the edt requires a larger number of arithmetic operations .",
    "also , the vector propagation algorithm is never guaranteed to be error - free , @xcite .",
    "the wdt has other properties which makes it useful in applications .",
    "it consists of only integers without loosing the metric property which is not the case for the edt ( real - valued distances ) or the squared edt ( does not satisfy the triangular inequality ) .",
    "this leads to nice properties , e.g. , when extracting the centers of maximal balls for computing skeletons which is fast and simple for the most common wdts , @xcite , in contrast to the case for edt , @xcite . observe that , when using large neighborhoods in the wdt , then the situation can be complex also for wdts , @xcite . in general ,",
    "the weighted distances are well - suited for morphological operations , @xcite .    to allow image processing on images on the non - standard grids",
    ", algorithms must be designed to work directly on these grids . weighted distances and",
    "the chamfer algorithm has been applied to non - standard grids such as the two - dimensional hexagonal grid , @xcite and the fcc and bcc grids , @xcite . in this paper , the weighted distance and the chamfer algorithm are considered on _ modules_.",
    "this gives a very general framework in which @xmath5 , the hexagonal , fcc , and bcc grids are all considered in parallel .",
    "the general framework implies that the theory also applies to the higher - dimensional generalizations of these grids .",
    "this paper is organized as follows : we first summarize weighted distance definitions and properties that can be found in the literature and generalize them to sub - modules of @xmath6 . then we exhibit conditions for the chamfer algorithm to work on our framework .",
    "finally , we propose examples of chamfer masks for the body - centered cubic ( bcc ) grid and the face - centered cubic ( fcc ) grid .",
    "this section generalizes definitions and weighted distance properties found in literature to our general framework of modules .",
    "we denote the set of real numbers , the set of integers , and the set of natural numbers , with @xmath7 , @xmath8 , and @xmath9 , respectively .",
    "let @xmath10 be an abelian group ( @xmath11 could be , for example , @xmath6 or @xmath12 for @xmath13 ) . to define weighted distances , we need not only an internal operator ( here @xmath14 ) , but also an external operation : @xmath15 with @xmath16 and @xmath17 .",
    "vector spaces ( as for example @xmath18 ) handle external operations , but are too restrictive ( @xmath19 , for example , is not a vector space ) .",
    "to be general enough , we use modules .",
    "let @xmath20 be a commutative ring ( for example @xmath21 ) with two neutral elements @xmath22 and @xmath23 .",
    "a set @xmath11 is called a _",
    "module on @xmath20 _ ( or @xmath20-module ) if @xmath11 has a commutative group operation @xmath14 , an external law @xmath24 , and satisfies the following properties : @xmath25    we now consider sub - rings @xmath26 of @xmath27 .",
    "given an abelian group @xmath10 we consider the @xmath20-module @xmath28 .",
    "[ rem : vspace_module ] the main difference between a module and a vector space is the non - invertibility ( with respect to the external law ) of the elements of its associated ring @xmath20 ( e.g. @xmath29 but @xmath30 ) . a basis of a module @xmath11 of dimension @xmath31 is a family of @xmath31 independent vectors @xmath32 ( @xmath33 \\textrm { , } \\alpha_{i } = 0 $ ] ) . but a linearly independent family of @xmath31 vectors may not be a basis of @xmath11 .",
    "for example , @xmath34 is a family of two independent vectors of @xmath35 but is not a basis of @xmath35 ( @xmath36 can not be reached by a linear combination of @xmath37 and @xmath38 with coefficients taken in the ring @xmath8 ) .    a _ distance _ on a group @xmath11 , having values in @xmath20 , called @xmath39 is a function @xmath40 which satisfies the following properties : @xmath41    given a distance @xmath39 , @xmath42 is called a _",
    "metric _ if it also satisfies the following property : @xmath43    given a metric @xmath39 , @xmath42 is called a _ norm _ on the module @xmath28 if it also satisfies the following property : @xmath44    an _ image _ is a function @xmath45 , where @xmath46 is a finite subset of @xmath11 .",
    "[ def : dist - map ] given a binary image @xmath47 , i.e. , @xmath48,let @xmath49 be the foreground and @xmath50 be the background . given a distance @xmath51 , the _ distance map _",
    ", @xmath52 , of @xmath47 is a grey level image , @xmath53 , where the value of each point of the foreground corresponds to its shortest distance to the background , i.e. @xmath54    given a module ( i.e. a set of vectors ) @xmath55 and an affine space ( i.e , a set of points in @xmath47 ) @xmath56 , we say that @xmath56 is equivalent to @xmath11 in the the following sense : @xmath57 this vector @xmath58 is denoted @xmath59 . for every module @xmath11 , there exists an equivalent affine space @xmath56 and vice versa .",
    "these spaces always have the same dimension . given a point @xmath60 of @xmath56",
    ", @xmath61 is an affine space with an origin .",
    "an origin is required to build a basis of @xmath56 and allows to define the following operations .",
    "@xmath62 in the following , we will consider @xmath56 and @xmath11 as the same set and denote @xmath63 .",
    "we now consider more particularly sub - modules of @xmath64 , ( for example @xmath65 and @xmath66 ) equivalent to the affine space @xmath6 , with the origin @xmath67 and the canonical basis @xmath68 . for any vector or point @xmath69",
    ", we denote @xmath70 the decomposition of @xmath71 in this canonical basis .    among numerous other methods ,",
    "distance maps can be computed by propagation of local distances using a chamfer mask .",
    "the latter is defined as follows :    [ def : chamfer - mask ] a _ chamfer mask _",
    "@xmath72 is a finite set of weighted vectors @xmath73 } \\in \\mathcal{g } \\times \\mathcal{r } \\}$ ] which contains a basis of @xmath55 and satisfies the following properties : @xmath74    intuitively , we speak about a distance between two points as the length of the shortest path between these points . in the case of weighted distances",
    ", we restrict the possible paths to those allowed by the chamfer mask . in this case , a path is an ordered sequence of chamfer mask vectors @xmath75 with @xmath76 having its origin at @xmath77 , @xmath78 having its end at @xmath79 , and @xmath80 $ ] .",
    "in other words , @xmath81 { { \\overrightarrow{\\mathbf { v}}}}_{i_{j } } \\in \\mathcal{c}$ ] and @xmath82 . as @xmath11 is an abelian group and a module on @xmath20 , the order of the vectors does not matter , and we can bring together the different vectors @xmath83}$ ] of the path equal to the same mask vector @xmath84 $ ] . observe that @xmath85 is the number of vectors within the path and @xmath86 is the size of the chamfer mask . moreover , as for each vector @xmath87 , @xmath88 , we can consider only positive coefficients .",
    "we obtain the following definition :    [ def : chamfer - path ] given a chamfer mask + @xmath89 } \\in \\mathcal{g } \\times \\mathcal{r}\\}$ ] and two points @xmath90 , a path @xmath91 from @xmath77 to @xmath79 is a sequence of vectors @xmath92 of the mask @xmath72 such that : @xmath93 \\textrm { , } \\alpha_{k } \\in \\mathcal{r}^{+}\\ ] ]    [ def : chamfer - cost ] the cost @xmath94 of a such a path @xmath91 is defined by : @xmath95    since a mask @xmath72 contains a basis of @xmath11 , and is symmetric , such a path always exists for any couple of points @xmath96 with positive coefficients .    [",
    "def : weighted - distance ] a weighted distance @xmath97 associated with a chamfer mask @xmath72 between two points @xmath77 and @xmath79 in @xmath11 is the minimum of the costs associated with paths @xmath91 linking @xmath77 to @xmath79 .",
    "@xmath98      a weighted distance is invariant under translation .",
    "this proof can be found in @xcite .",
    "given any three points @xmath99 in @xmath56 , @xmath100 .",
    "indeed , @xmath101 and any path @xmath102 from @xmath103 to @xmath104 is also a path from @xmath77 to @xmath79 , with the same cost : @xmath105 .",
    "a property of a weighted distance between any two points @xmath106 of @xmath11 can be expressed as a property of a weighted distance between the origin @xmath60 and a point @xmath77 .",
    "taking @xmath107 leads to @xmath108 .    in the following",
    ", we will express the properties of weighted distances from the origin to any point @xmath77 of @xmath11 and denote @xmath109 .    to be able to forecast the weighted distance map , from a single point , from the chamfer mask @xmath72",
    ", we divide @xmath72 into several sectors spanning the points of @xmath11 such that the distance to the origin of a point lying within a sector will only depend on a restricted number ( actually @xmath31  the dimension ) of mask weights .",
    "we define the following objects :    given a family of @xmath31 independent vectors of @xmath11 , @xmath110}$ ] , the _ @xmath7-sector _ @xmath111 is the region of @xmath6 spanned by the vectors @xmath112 i.e. : @xmath113",
    "the _ @xmath11-sector _",
    "@xmath114 is the set of points belonging to @xmath11 which are included in the @xmath7-sector @xmath115 .",
    "example of @xmath7-sector and @xmath11-sector in @xmath116 . ]",
    "it is possible that a @xmath11-sector does not correspond to the set of points @xmath77 such that @xmath117 .",
    "for example , as illustrated in figure [ fig : r - g - sectors ] , if we take the module @xmath118 , the point @xmath119 lies in the @xmath7-sector @xmath120 @xmath121 and as it is a point of @xmath122 , it also lies in the @xmath11-sector @xmath123 .",
    "but it can not be written as @xmath124 with @xmath125 .",
    "[ remark : r - g - sectors ]    we call a _ wedge _ of a chamfer mask @xmath72 , a @xmath11-sector formed by a family @xmath126 of @xmath31 vectors of @xmath72 which does not contain any other vector of @xmath72 .",
    "to avoid the situation illustrated in remark 2.2 we consider only @xmath11-sectors based on a basis of @xmath11 .",
    "we call a @xmath11-sector @xmath127 where + @xmath128 is a basis of @xmath129 a @xmath11-basis - sector .    by definition of a basis , a @xmath11-basis - sector corresponds exactly to the the set of points @xmath77 such that @xmath130 .    given a family @xmath131}$ ] of @xmath31 independent vectors ,",
    "we denote @xmath132 @xmath133    and @xmath134",
    "$ ] , we consider the function @xmath135 such that :    @xmath136    [ lemma : value ] a family @xmath137}$ ] is a basis of @xmath138 , iff @xmath139 \\textrm {   } \\frac{1}{\\delta_{\\mathcal{f}}^{0 } } \\times \\delta_{\\mathcal{f}}^{k}({{\\overrightarrow{\\mathbf { x } } } } ) \\in \\mathcal{r}.\\ ] ]    the proof in @xmath140 can be found in @xcite .",
    "+ by definition of a basis , a family @xmath141}$ ] is a basis of @xmath142 iff @xmath143 , @xmath144 such that @xmath145 .",
    "+ as we consider sub - modules of @xmath6 , @xmath146 and @xmath134 $ ] , @xmath147 .",
    "if the vectors of @xmath148 are not independent , @xmath148 is not a basis of @xmath11 , and as @xmath149 , @xmath150 . if @xmath148 is an independent family of vectors , as @xmath6 is a vector space , @xmath148 is a basis of @xmath151 and @xmath152 such that @xmath145 .",
    "this can be written : @xmath153 as @xmath148 is an independent family , @xmath154 and the matrix @xmath155 can be inverted such that @xmath156 inverting @xmath155 using cramer s rule leads to @xmath157 \\textrm { , } \\alpha_{k } = \\frac{1}{\\delta_{\\mathcal{f}}^{0 } } \\times \\delta_{\\mathcal{f}}^{k},\\ ] ] and @xmath148 is a basis of @xmath158 iff @xmath134 $ ] , @xmath159 .    when @xmath160 we obtain the condition @xmath161 for cone regularity defined in @xcite .",
    "we can always organize @xmath72 as a set of wedges ( taking @xmath31-tuples of vectors that do not contain any other vectors ) .",
    "to avoid the situation in remark 2.2 and to be able to forecast the final weighted distance from the chamfer mask , we choose masks whose wedges are all @xmath11-basis .",
    "when @xmath162 , taking every couple @xmath163 of adjacent vectors of @xmath72 in clockwise ( or counter - clockwise ) order gives such an organization .",
    "if , for each couple @xmath164 , then , they are a @xmath11-basis ( cf .",
    "@xcite ) . for example , in figure [ fig : shortestpath ] of remark [ rem : shortestpath ] , @xmath165 , @xmath166 , @xmath167 , @xmath168 , @xmath169 , @xmath170 is an organization of @xmath72 in @xmath171-basis wedges . for @xmath172",
    ", this organization may be more complicated .",
    "indeed several ways of organizing @xmath173 independent vectors into two wedges may exist : for example , if we take the vectors @xmath174 , @xmath175 , @xmath176 , @xmath177 and their symmetric vectors , the wedges @xmath178 and @xmath179 are a @xmath11-basis , but we can also consider the wedges @xmath180 and @xmath181 . in @xcite , an automatic recursive method is given ; it is based on farey series to organize chamfer masks of @xmath182 with @xmath11-basis wedges . in the general case ,",
    "considering a mask @xmath72 containing only a @xmath11-basis @xmath183 and their symmetric wedges @xmath184 , leads to two @xmath11-basis wedges ( if @xmath185 , \\frac{1}{\\delta_{\\mathcal{f}}^{0 } } \\delta_{\\mathcal{f}}^{k}({{\\overrightarrow{\\mathbf { x } } } } ) \\in \\mathcal{r}$ ] , @xmath186 as @xmath20 is a group ) .",
    "moreover , the other wedges are @xmath187 for @xmath188 $ ]",
    ". they all are @xmath11-basis wedges as @xmath189 , \\frac{1}{\\delta_{\\mathcal{f}_{l}}^{0 } }   \\delta_{\\mathcal{f}_{l}}^{k}(x ) = \\pm \\frac{1}{\\delta_{\\mathcal{f}}^{0 } } \\delta_{\\mathcal{f}}^{k}(x)\\in \\mathcal{r}$ ] as @xmath20 is a group .",
    "we can then add vectors to this mask , taking care of keeping an organization in @xmath11-basis wedges .",
    "[ rem : shortestpath ] given a chamfer mask @xmath190 } \\in \\mathcal{g } \\times \\mathcal{r}\\}$ ] which is organized in @xmath11-basis wedges , and given any point @xmath77 lying in a wedge @xmath191 of @xmath72 , there exist a path @xmath192 with @xmath134 $ ] ( i.e. the point @xmath77 can by reached by a linear combination of only @xmath31 vectors among the @xmath86 vectors of the mask @xmath72 with coefficients in @xmath193 ) .",
    "however , the final weighted distance at this point may not be a linear combination of the @xmath31 weights corresponding to _ these _",
    "@xmath31 vectors in the chamfer mask .",
    "for example , in @xmath194 , let us consider the mask @xmath72 containing the weighted vectors @xmath195 , @xmath196 , @xmath197 and their symmetric vectors . the families @xmath198 and @xmath199 , generating the wedges @xmath200 and @xmath201 respectively , are a basis of @xmath202 .",
    "indeed , @xmath203 and @xmath204 , @xmath205 , @xmath206 and : @xmath207 @xmath208 in the same way for @xmath209 , we have : @xmath210 and @xmath211 , @xmath205 , @xmath206 and : @xmath212 @xmath213     example where the weighted distance does not depend on @xmath11-basis sector vectors . ]",
    "however , as illustrated in figure [ fig : shortestpath ] the point @xmath214 lying in the @xmath11-basis - sector @xmath215 can be reached only by the path @xmath216 containing only vectors of @xmath217 and @xmath218 . but",
    "@xmath77 can also be reached by the following path @xmath219 belonging neither to the sector @xmath215 nor to the sector @xmath220 with a cost @xmath221 .",
    "as the weighted distance of a point ( with respect to the origin ) is the minimum cost of all paths allowed by the mask , we have @xmath222 and thus @xmath223 .",
    "to avoid the situation mentioned in remark [ rem : shortestpath ] , we add restrictions to the mask weights .",
    "these restrictions rely on the fact that the polytope formed by the chamfer mask vectors normalized by their weights is convex .",
    "we call the polytope of @xmath6 whose faces are the @xmath224-dimensional pyramids formed by the @xmath31 vectors of each wedge of a chamfer mask @xmath225 } \\in \\mathcal{g } \\times \\mathcal{r}\\}$ ] normalized by their weights , i.e. @xmath226 $ ] for each wedge @xmath227 of @xmath72 the _ normalized chamfer mask polytope _",
    ", denoted @xmath228 .",
    "note that as @xmath28 is a module but not a vector space , these points may not be in @xmath11 .",
    "[ lemma : wedge : convex ] if the normalized polytope @xmath228 is convex , the weighted distance of any point @xmath77 lying inside a wedge @xmath229 of a chamfer mask @xmath230 } \\in \\mathcal{g } \\times \\mathcal{r } \\}$ ] depends only on the weights @xmath231 .",
    "this proof can be found in @xcite for @xmath202 .",
    "+ if @xmath232 , the proof is obvious .",
    "let a point @xmath233 , @xmath234 be given .",
    "as @xmath235 is a @xmath11-basis , there exists a path @xmath236 from @xmath237 to @xmath77 containing only vectors of @xmath148 having positive coefficients ( @xmath238 , \\alpha_{k } \\geq 0 $ ] ) .",
    "the cost of this path is @xmath239 .",
    "we can write @xmath240 as @xmath241 with @xmath242 since @xmath243 is a convex combination of the @xmath31 normalized vectors of @xmath244 $ ] , @xmath245 and @xmath246 , @xmath243 lies on @xmath228 . moreover , as the faces of @xmath228 are convex ( @xmath224-dimensional polytope with @xmath31 vertices ) @xmath243 also lies on the face formed by the family @xmath148 of @xmath228 , i.e. on the boundary of @xmath228 .",
    "+ let us now consider another path @xmath247 from @xmath237 to @xmath77 containing arbitrary vectors of @xmath72 . as @xmath72 is symmetric , we can take @xmath134 , \\beta_{k } \\geq 0 $ ] without loss of generality",
    ". then @xmath248 .",
    "indeed , @xmath249 with @xmath250 @xmath251 is a convex combination of @xmath86 normalized vectors of @xmath72 , and lies thus within the convex polytope @xmath228 .",
    "moreover , we have @xmath252 with @xmath243 and @xmath251 having the same direction ( @xmath253 ) with positive coefficients .",
    "@xmath254 . as @xmath251 lies within @xmath228 and @xmath243 lies on the boundary of @xmath228 , @xmath255 ( as @xmath228 is centered in @xmath237 , if @xmath256 , @xmath257 would be farther from the origin than a point of the boundary , and thus outside @xmath228 ) thus @xmath258 and @xmath259 .",
    "figure [ fig : convex : proof ] shows an example of vectors @xmath243 and @xmath251 of a mask @xmath260 .",
    "example where @xmath228 is convex .",
    "we consider the vectors @xmath261 and the mask @xmath262 , @xmath263 , @xmath264 , @xmath265 , @xmath266 , @xmath267 .",
    "we consider the path @xmath268 and @xmath269 from @xmath237 to @xmath270 .",
    "we then have @xmath271 . ]",
    "[ corollary : convexhull ] if the vertices of each face of the convex hull @xmath272 of @xmath228 are normalized vectors corresponding to @xmath11-basis sectors of @xmath72 , then the vectors of @xmath72 whose corresponding normalized vectors do not lie on the convex hull of @xmath228 are not used to compute the final weighted distance .",
    "the proof can be found in @xcite for vectorial spaces .",
    "suppose there exists a vector @xmath273 such that @xmath274 does not lie on the convex hull of @xmath228 ( i.e. @xmath275 lies within @xmath228 ) .",
    "let us consider the @xmath11-basis sector @xmath276 in which @xmath277 lies and whose corresponding normalized vectors form a face @xmath148 of @xmath278 .",
    "there exists a path @xmath279 from @xmath237 to @xmath280 and with @xmath281 .",
    "indeed , @xmath282 with @xmath283 a convex combination of @xmath31 vectors of @xmath148 lying within @xmath148 .",
    "we thus have @xmath284 and @xmath285 .",
    "finally , as a weighted distance is the minimum of the costs of all possible path , in any path containing @xmath277 , @xmath277 will be replaced by @xmath240 whose cost is lower .",
    "note that this is what happens in remark [ rem : shortestpath ] .",
    "[ rem : convexhull ] if there exist faces of @xmath278 formed by normalized vectors whose corresponding mask vectors are not @xmath11-basis , the vectors of @xmath72 which does not lie on @xmath278 may be used , but this leads to a final weighted distance which may not be homogeneous along some directions , and we also may not be able to forecast the weighted distance inside a wedge with the only vectors generating the wedge .",
    "for example , if we consider the mask @xmath72 with the weighted vectors : @xmath286 , @xmath287 , @xmath288 , @xmath289 and their symmetric vectors , as shown in figure [ fig : nonconvex ] , @xmath290 .",
    "moreover , @xmath291 does not only depend on @xmath292 and @xmath293 or only on @xmath293 and @xmath294 .",
    "note that the vectors @xmath292 and @xmath294 generating the corresponding face of @xmath278 do not form a @xmath122 basis ( @xmath295 ) .",
    "when @xmath296 the weighted distance may not be homogeneous . ]    in the following , we consider only chamfer masks whose normalized polytope is convex . indeed ,",
    "if this is not the case , the mask may be redundant ( corollary  [ corollary : convexhull ] ) , or even if not , we may not be able to forecast the final weighted distance , ( remark  [ rem : convexhull ] ) .",
    "we can note that this condition implies that collinear vectors ( which are note opposite vectors ) are removed from the mask .",
    "considering previous lemmas and remarks , we can re - define a chamfer mask with stronger conditions as follows :    [ def : chamfer - mask : restricted ] a _ chamfer mask _",
    "@xmath297 is a finite set of weighted vectors @xmath73 } \\in \\mathcal{g } \\times \\mathcal{r } \\}$ ] which satisfies the following properties : @xmath298    [ theorem : value ] given a chamfer mask @xmath299 } \\in \\mathcal{g } \\times \\mathcal{r } \\right\\}$ ] , defined as in definition [ def : chamfer - mask : restricted ] , the weighted distance of any point @xmath77 lying in a wedge @xmath229 can be expressed by : @xmath300    this formula was given for @xmath182 in @xcite without the entire proof .",
    "let @xmath77 be a point of @xmath11 lying in the wedge @xmath301 of @xmath297 .",
    "as @xmath302 is a basis of @xmath55 ( condition [ maskcond : wedges ] of definition [ def : chamfer - mask : restricted ] ) there exists a path @xmath240 from @xmath237 to @xmath77 and @xmath303 such that @xmath304 .",
    "the proof of lemma  [ lemma : value ] gives @xmath134 , \\alpha_{k } = \\frac{1}{\\delta_{\\mathcal{f}}^{0 } } \\times \\delta_{\\mathcal{f}}^{k}({{\\mathbf { p}}})$ ] and the proof of lemma [ lemma : wedge : convex ] gives that the weight of @xmath240 is minimal .",
    "thus @xmath305 .",
    "a weighted distance computed with a chamfer mask + @xmath306 } \\in \\mathcal{g } \\times \\mathcal{r}\\}$ ] as defined in definition [ def : chamfer - mask : restricted ] is a _ norm _ on @xmath307 .    here , we have to show that @xmath308 is definite , positive and symmetric and satisfies the triangular inequality and the positive homogeneity properties . by definition of a weighted distance ( definition [ def : weighted - distance ] ) , given any points @xmath309 ,",
    "there exist @xmath310 , @xmath311 , ... , @xmath312 @xmath313 such that @xmath314 and @xmath315 ( cf .",
    "definitions [ def : chamfer - path ] , [ def : chamfer - cost ] and [ def : weighted - distance ] ) .    1 .",
    "_ positivity _ ( needs conditions [ maskcond : positiveweights ] and [ maskcond : symmetry ] of definition [ def : chamfer - mask : restricted ] ) + by condition [ maskcond : symmetry ] of definition [ def : chamfer - mask : restricted ] we can choose @xmath316 for all @xmath317 $ ] . by condition [ maskcond : positiveweights ]",
    "we also have @xmath318 for all @xmath317 $ ] .",
    "we thus have @xmath319 .",
    "_ definitivity _ ( needs conditions [ maskcond : positiveweights ] and [ maskcond : symmetry ] of definition [ def : chamfer - mask : restricted ] ) + if @xmath232 , then the path @xmath320 is a path from @xmath237 to @xmath77 and its cost is @xmath321 .",
    "thus , @xmath322 . by positivity",
    ", we also have @xmath323 .",
    "it follows that @xmath324 .",
    "+ conversely , if @xmath324 , as @xmath325 $ ] , @xmath326 , we have @xmath327 $ ] , @xmath328 and @xmath329",
    ". thus @xmath232 .",
    "symmetry _ ( needs the condition [ maskcond : symmetry ] of definition [ def : chamfer - mask : restricted ] ) + by condition [ maskcond : symmetry ] of definition [ def : chamfer - mask : restricted ] , we have that @xmath330 is a path from @xmath77 to @xmath237 and @xmath331 .",
    "moreover , this cost is minimal .",
    "indeed , let us consider a path @xmath332 such that @xmath333 .",
    "then @xmath334 is a path from @xmath237 to @xmath77 and @xmath335 which is impossible by definition of a weighted distance ( definition [ def : weighted - distance ] ) .",
    "thus @xmath336 .",
    "4 .   _ triangular inequality _ ( needs conditions [ maskcond : positiveweights ] and [ maskcond : symmetry ] of definition [ def : chamfer - mask : restricted ] ) + the proof can be found in @xcite for @xmath337 and in @xcite ( corollary 3.4 ) for a general module .",
    "we want @xmath338 , @xmath339 .",
    "let @xmath340 be the minimum cost path between @xmath237 and @xmath79 ( i.e. @xmath341 ) , and by eq .",
    "( [ alpha - form ] ) , @xmath342 . as",
    "the mask is symmetric , @xmath343 can be written @xmath344 for some @xmath345 and @xmath346 .",
    "let us suppose @xmath347 .",
    "the path @xmath348 is a path from @xmath77 to @xmath79 . as @xmath349 is an abelian group , @xmath350 which is impossible by definition of a weighted distance ( definition [ def : weighted - distance ] ) . by contradiction",
    ", we have @xmath351 . + + note that a decomposition in @xmath11-basis wedges is not needed for this condition .",
    "the only condition needed is to be able to extract a basis among all mask vectors .",
    "this is the case , for example , for masks containing only vectors corresponding to knight displacements .",
    "indeed , each wedge of this mask is not a @xmath8-basis ( see figure  [ fig : r - g - sectors ] and remark  2.2 .",
    "however , this mask induces a metric , @xcite .",
    "+ the triangular inequality does not depend on the choice of the weights . 5 .",
    "_ positive homogeneity _ ( needs conditions [ maskcond : positiveweights ] , [ maskcond : symmetry ] , [ maskcond : wedges ] and [ maskcond : convex ] of definition [ def : chamfer - mask : restricted ] ) + the proof can be found in @xcite for @xmath352 and in @xcite for a general module .",
    "let be @xmath353 .",
    "let @xmath354 be the wedges of @xmath297 in which @xmath77 lies . by theorem  [ theorem : value ] , we have @xmath355 .",
    "+ if @xmath356 , the point @xmath357 also lies in the wedge @xmath302 ( it is a point of @xmath11 , and @xmath358 with @xmath134 , \\lambda \\times \\alpha_{i_{k } } \\in    \\mathcal{r}^{+}$ ] ) . by theorem  [ theorem : value ]",
    "we have : @xmath359 + if @xmath360 , @xmath361 with @xmath362 ( symmetry property ) and thus , @xmath363 .",
    "@xmath364      in addition to their metric and norm properties , weighted distances can be made more invariant to rotation . as a weighted distance",
    "is obtained by computing the smallest weight of several paths between two points , the first improvement to obtain a weighted distance with high rotational invariance is to allow a larger number of allowed directions for the paths .",
    "this means increasing precision by increasing the number of weighted vectors of the chamfer mask .",
    "to increase accuracy , another way is to choose suitable weights for mask vectors .",
    "this more challenging issue as been often addressed in the literature .",
    "the first optimal chamfer weights computation was performed for a 2-d @xmath365 mask in a square grid @xcite .",
    "then authors computed optimal weights with different optimality criteria @xcite , for larger masks @xcite and for anisotropic grid @xcite .",
    "authors of @xcite proposed an automatic computation of optimal chamfer weights for rectangular grids .",
    "observe that computing the distance transform and finding optimal weights is not directly related to the problem of estimating the length of straight lines in a discrete image @xcite . for optimal weights for such estimations ,",
    "see @xcite .    in all of the previous papers , the computation of optimal chamfer weights",
    "is performed the same way :    1 .",
    "first , a chamfer mask is built and decomposed in wedges .",
    "then , the final weighted distance from the origin to an arbitrary point of the grid is expressed .",
    "the variables corresponding to the mask weights are unknown , but variables corresponding to vector coordinates are known . in the general case , given a chamfer mask defined as definition [ def : chamfer - mask : restricted ] , and a point @xmath17 lying in the wedge @xmath366 the value of the weighted distance at this point is @xmath367 3 .   in the same way , the euclidean distance from the origin to this point @xmath77 is expressed . in the general case ,",
    "given a grid which is a sub - module of @xmath6 with an elongation of @xmath368 in each canonical direction , the euclidean distance between the origin and the point @xmath77 can be expressed in the following way : @xmath369 4 .",
    "after these three steps , the error between the weighed distance and the euclidean one can be expressed for any point @xmath17 .",
    "this error can be either absolute ( the difference between these two values ) @xcite or relative ( the difference is divided by the euclidean distance ) @xcite .",
    "the error can be expressed as follows : @xmath370 the general relative error can be expressed as follows : @xmath371 5 .",
    "the previous errors are @xmath31-dimensional functions of the coordinates @xmath372 , ... @xmath373 of @xmath77 . to reduce the number of these variables and be able to find extrema ,",
    "the maximal error is computed either on a hyperplane or on a sphere .",
    "for example , in three dimensions , the error can be computed on a plane @xmath374 @xcite or on the sphere of radius @xmath375 @xcite .",
    "this error function is continuous on a compact set ( the @xmath224 pyramid formed by the @xmath31 vectors of each wedge ) .",
    "thus it is bounded and attains its bounds .",
    "these bounds can be located either at the vertices of the pyramid or inside ( including other bounds such as edges ) the pyramid .",
    "computing the derivatives of the error function gives the point @xmath376 at which the error is maximum ( due to the sign of the derivatives ) inside the wedge . in this way",
    ", the maximum error within the wedge @xmath377 can be obtained ( if @xmath376 lies within the wedge ) .",
    "7 .   the other extrema ( minima ) @xmath378 are obtained for the @xmath31 vectors delimiting the wedge ( the vertices of the @xmath224 pyramid ) .",
    "when computing the error on a sphere of radius @xmath379 , in the general case , the extrema can be expressed in the following way ( @xmath380 $ ] ) : @xmath381 with @xmath382 being the euclidean norm of the vector @xmath277 expressed in the world coordinate .",
    "8 .   minimizing the maximum error leads to computing optimal real weights with the following equation : @xmath383 .",
    "9 .   a depth - first search in an integer weights tree taking the error into account can lead to optimal integer weights set for a given mask @xcite .    we have generalized weighted distance properties found in the literature to modules .",
    "these properties are true for the well - known cubic grid , but can also be applied to other grids such as the fcc and bcc grids as we will see in section  [ sec : bccfcc ] . in applications ,",
    "an efficient algorithm for computing distance transforms is is needed . in the following section ,",
    "we discuss such an algorithm : the two - scan chamfer algorithm .",
    "we prove that the algorithm produces correct result for images on general point lattices .",
    "there are basically three families of algorithms for computing weighted distance transforms  bucket - sort ( also known as wave - front propagation ) , parallel , and sequential algorithms .",
    "initially in the bucket - sort algorithm @xcite , the border points of the object are stored in a list .",
    "these points are updated with the distance to the background .",
    "the distances are propagated by removing the updated points from the list and adding the neighbors of these points to the list .",
    "this is iterated until the list is empty .",
    "the parallel algorithm @xcite is the most intuitive one . given the original image ,",
    "a new image is obtained by applying the chamfer mask simultaneously to each point of the image giving the minimum distance value at each of these points .",
    "this process is applied to the new image . by applying the procedure iteratively until stability",
    ", the distance map is obtained ( a proof using infimal convolution is found in @xcite ) .",
    "rosenfeld & pfaltz @xcite showed that this is equivalent to two sequential scans of the image for grids in @xmath35 and a @xmath384 mask .",
    "sequential means that we use previously updated values of the same image to obtain new updated values .",
    "two advantages are that a two - scan algorithm is enough to construct a distance map in any dimension and that the complexity is known ( @xmath385 , where @xmath386 is the number of points in the image )",
    ". the worst case complexity of the parallel algorithm is @xmath387 ",
    "@xmath386 iterations of operations on @xmath386 points .",
    "this result is now generalized and proved to be correct on any grid for which all grid point coordinates can be expressed by a basis .    in this section",
    ", @xmath46 is a _",
    "finite _ subset of @xmath11 and @xmath388 .",
    "the cardinality of @xmath46 is denoted @xmath389 .",
    "observe that the chamfer weights are in @xmath390 ( definition  [ def : chamfer - mask : restricted ] , condition  [ maskcond : positiveweights ] ) and that the weighted distance have values in @xmath391 ( definition  [ def : weighted - distance ] ) .",
    "given @xmath392 , where @xmath393 and @xmath394 .",
    "let @xmath395 where @xmath396 is one of the relations @xmath397 or @xmath398 .",
    "for example , @xmath399 is a hyperplane and @xmath400 , @xmath401 , @xmath402 , and @xmath403 are half - spaces separated by the hyperplane @xmath399 .",
    "[ def : scanningmasks ] let a chamfer mask @xmath72 be given .",
    "let also @xmath404 defining the hyperplane @xmath405 such that @xmath406 be given .",
    "the _ scanning masks with respect to @xmath72 _ are defined as @xmath407 @xmath408    in the following , the notation @xmath409 and @xmath410 , @xmath411 , means that the pair @xmath412 will be used .",
    "a _ scanning order _ is an ordering of the @xmath389 points in @xmath46 , denoted @xmath413 .",
    "for a scanning mask to propagate distances efficiently , it is important that , in each step of the propagation , the values at the points in @xmath46 from which the mask can propagate distances have already been updated .",
    "this is guaranteed if each point that can be reached by the scanning mask either has already been visited or is outside the image .",
    "let @xmath413 be a scanning order and @xmath414 a scanning mask .",
    "the scanning mask @xmath414 _ supports the scanning order _",
    "if @xmath415    given a scanning mask @xmath414 and an image @xmath46 , there is a scanning order such that @xmath414 supports the scanning order .",
    "let @xmath405 such that @xmath406 be the hyperplane defining @xmath416 and @xmath417 ( we consider @xmath416 here , the proof for @xmath417 is similar ) .",
    "now we consider two sets , @xmath418 and @xmath419 , where @xmath420 is the complement of @xmath46 and the elements in @xmath421 are the already visited points in @xmath46 .",
    "let @xmath422 , @xmath423 .",
    "for every @xmath424 , there is a @xmath425 ( @xmath426 ) such that @xmath427 .",
    "since @xmath418 is finite , there is a point @xmath428 with corresponding @xmath429 such that @xmath430 , @xmath431 , and @xmath432 .",
    "thus , @xmath433 and @xmath434 , so @xmath435 and thus @xmath436 which has an empty intersection with @xmath418 , so @xmath437 .",
    "let this @xmath77 be @xmath438 , assign it to @xmath421 and repeat until @xmath439 .",
    "[ chamfer_alg ] let the scanning masks @xmath416 and @xmath417 and scanning orders @xmath413 and @xmath440 such that the masks support these scanning orders be given .    * initially , @xmath441 and @xmath442 . *",
    "the image is scanned two times using the two scanning orders .",
    "* for each visited point @xmath443 in scan @xmath85 , @xmath444    usually , in the first scan @xmath445 is omitted , as @xmath445 is only computed for @xmath446 , so we know @xmath447 .",
    "now we prove that , in a distance map @xmath448 , for any point @xmath449 on a path defining the distance between @xmath450 and its closest background point @xmath451 , the value in the distance map at point @xmath449 is given by @xmath452 . in other words , the closest point in the background from @xmath449 is @xmath79 .",
    "[ chamfer_lemma ] let @xmath450 and @xmath453 be such that @xmath454 and @xmath455 .",
    "there is a set @xmath456 such that the point @xmath77 can be written @xmath457 and @xmath458 .",
    "for any set @xmath459 , if @xmath460 , then @xmath461",
    ".    let @xmath462 . since @xmath463 is the length of a path between @xmath464 and @xmath79 , the weighted distance can not be larger than this .",
    "assume that @xmath465 .",
    "then there is a @xmath466 such that @xmath467 now , @xmath468 since @xmath469 is the length of one path ( we can not assume that it is a shortest path ) between the points @xmath464 and @xmath470 , it follows that @xmath471 and thus @xmath472 which contradicts @xmath473 .    to assure that the propagation does not depend on points outside the image",
    ", the definition of border points _ or _ of wedge preserving images defined below can be used .",
    "[ def : borderpoint ] given a chamfer mask @xmath72 , a point @xmath424 is _ a border point _ if @xmath474    [ border_lemma ] if for all border points @xmath475 , then for all @xmath476 such that @xmath477 , all points in any shortest path between @xmath77 and @xmath79 are in @xmath46 .",
    "assume that a point @xmath449 in a shortest path between @xmath77 and @xmath79 is not in @xmath46 .",
    "then , since all border points are in the background , there is a background grid point in all paths between @xmath77 and @xmath449 . since @xmath478",
    ", it follows that there must be a border point @xmath479 such that @xmath480 which contradicts the assumption @xmath481 .",
    "[ def : wedge_pres ] given a chamfer mask @xmath72 and @xmath394 , @xmath482 such that @xmath483 .",
    "the half - spaces @xmath403 and @xmath401 are _ wedge - preserving _ if @xmath484 where @xmath302 denotes wedges in @xmath72 .",
    "[ wedge_pres_halfspace ] given a chamfer mask @xmath72 , the image @xmath46 is _ wedge - preserving _ if it is the intersection of wedge - preserving half - spaces .",
    "[ lem_wedge_equival ] if an image @xmath46 is wedge - preserving , then for all @xmath485 , all points in any shortest path between @xmath77 and @xmath79 are in @xmath46 .",
    "let @xmath46 be wedge - preserving and let @xmath486 such that @xmath487 with @xmath488 , where @xmath302 is a wedge .",
    "assume that there is a fixed @xmath489 and a set @xmath490 such that @xmath491 but @xmath492 .",
    "in other words , if there is a point not in @xmath46 in the shortest path between @xmath77 and @xmath79 , then some point @xmath449 in @xmath46 has a neighbor @xmath493 that is not in @xmath46 .",
    "since @xmath46 is wedge - preserving , there is a plane defined by @xmath494 such that @xmath495 and @xmath496 . since @xmath497 @xmath498 @xmath499 taking any @xmath500 , @xmath501 , which by definition  [ wedge_pres_halfspace ] implies that @xmath502 .",
    "this implies that @xmath503 now , @xmath504 , but @xmath505",
    "@xmath506 @xmath507 @xmath508 since @xmath496 , @xmath509 if @xmath510 and @xmath511 , and using eq .  [ geqvect ] .",
    "we have @xmath512 , i.e. @xmath513 . contradiction .",
    "as the image generally is given first , a mask can often be built with preserved wedges and then cut into two scanning masks .",
    "then the points in the image can be ordered such that the masks support the scanning directions and then the distance map can be computed using our algorithm .",
    "[ chamf - alg - conditions ]    [ chamf - alg - theorem ] if either    * for all border points @xmath514 or * @xmath46 is wedge - preserving ,    then the chamfer algorithm in definition  [ chamfer_alg ] produces distance maps as defined in definition  [ def : dist - map ] .",
    "let @xmath450 and @xmath453 be such that @xmath454 and @xmath455 .",
    "there is a set @xmath456 such that the point @xmath77 can be written @xmath457 and @xmath458 .",
    "let @xmath515 be the image after the first scan .",
    "by lemma  [ chamfer_lemma ] , using that the masks support the scanning order , the local distances are propagated in the following way . also , by lemma  [ border_lemma ] and lemma  [ lem_wedge_equival ] , all points below are in @xmath46 .",
    "@xmath516 let @xmath517 be the image after the second scan . using the notation @xmath518",
    ", we get @xmath519 this proves that all steps of a shortest path between @xmath77 and @xmath79 have been processed . indeed , after the second scan",
    ", the value of the point @xmath77 is @xmath520 .    in figure  [ chamf - alg - conditions ] , the need for the conditions in theorem  [ chamf - alg - theorem ] are shown in example images .",
    "the bcc grid ( @xmath521 ) and the fcc grid ( @xmath522 ) are defined as follows : @xmath523 @xmath524 a voxel is defined as the voronoi region of a point @xmath77 in a grid .",
    "figure  [ neighborhoods ]  ( a ) shows a voxel of a bcc grid .",
    "a bcc voxel has two kinds of face - neighbors ( but no edge- or vertex - neighbors ) , which results in the 8-neighborhood ( figure  [ neighborhoods ]  ( b ) ) and the 14-neighborhood ( figure  [ neighborhoods ]  ( c ) ) . on the fcc grid ,",
    "each voxel ( see figure  [ neighborhoods ]  ( d ) ) has 12 face - neighbors and 6 vertex - neighbors . the resulting 12- and 18-neighborhoods are shown in ( figure  [ neighborhoods ]  ( e ) ) and ( figure  [ neighborhoods ]  ( f ) ) , respectively .",
    "note that the high number of face neighbors ( 12 for the fcc grid and 14 for the bcc grid ) implies these grids are more compact than the cubic grid , which has only @xmath525 face neighbors .",
    "to apply the results of sections  [ sec : wdp ]  and  [ sec : chamferalgo ] to the bcc grid , we should check that :    * @xmath521 is a sub - module of @xmath526 * masks decomposed in @xmath521-basis wedges can be created * a scanning order can be defined on the bcc lattice .",
    "[ lemma : bccsubmodule ] let @xmath527 , then @xmath528 is a sub - module of @xmath6 .",
    "let us prove first that @xmath529 is an abelian group .",
    "given @xmath77 , @xmath530 , there exist @xmath531 , and @xmath532 such that @xmath533\\ p^{k } = p^{1 } + 2 \\alpha_{k}$ ] and @xmath534 .",
    "the point @xmath535 also belongs to @xmath529 .",
    "indeed , @xmath533 $ ] , @xmath536 with @xmath537 .",
    "moreover , @xmath538 as @xmath539 with @xmath540 .",
    "we now have to prove that @xmath541 , @xmath542 , @xmath543 .",
    "indeed , @xmath134 , \\lambda p^{k } \\in    \\mathbb{z}$ ] and @xmath533 \\lambda p^{k } = \\lambda p^{1 }   + 2 ( \\lambda \\alpha_{k } ) \\textrm { with } ( \\lambda \\alpha_{k } ) \\in     \\mathbb{z}$ ] .",
    "this result is true for all @xmath544 and obviously for @xmath545 .",
    "[ lemma : bccbasis ] a family @xmath546 is a basis of @xmath521 iff @xmath547    first , we prove that any determinant of 3 vectors @xmath548 of @xmath521 is a multiple of @xmath549 .",
    "indeed , given a vector @xmath550 , @xmath551 iff there exists @xmath552 such that @xmath553 and @xmath554 .",
    "then the determinant of @xmath555 and @xmath293 is @xmath556    with the notations of paragraph [ sec : wdp ] we obtain for any vector @xmath557 of @xmath521 : @xmath558    and @xmath559 iff @xmath560 which means @xmath561 .",
    "the same result applies for @xmath562 and @xmath563 . by lemma [ lemma : value ] we obtain",
    "@xmath148 is a basis of @xmath521 iff @xmath561 .    to compute a weighted distance map on an image stored on a bcc grid",
    ", one can consider a mask built using 8-neighbors : @xmath564 this mask contains only one type of weight as the euclidean distance between each face - sharing neighbor to the central voxel is the same .",
    "this mask can be decomposed into @xmath521-basis sectors .",
    "indeed , let us consider the wedge @xmath565 , and its symmetric wedges .",
    "@xmath566 and from lemma [ lemma : bccbasis ] , @xmath567 is a @xmath521-basis sector .",
    "if we want larger masks , we can split the wedge @xmath567 and its symmetric wedges according to the farey triangulation technique @xcite . to do so , given a @xmath521-basis wedge @xmath568 , choose an edge to be split , say the edge between @xmath569 and @xmath292 .",
    "we create @xmath570 such that @xmath571 defined by @xmath572 , @xmath573 and @xmath574 .",
    "the two obtained wedges @xmath575 and @xmath576 are @xmath521-basis sectors . indeed , @xmath577 in the same way , @xmath578 .",
    "if we apply the first steps of this method , we can retrieve the chamfer mask using the 14-neighborhood proposed by @xcite .",
    "but we can also build larger masks by splitting the new wedges .      to compute optimal integer chamfer weights for bcc grid the depth - first search method of @xcitetc18/code - data - set ]",
    "can be used .",
    "this method computes weights sets leading to weighted distance maps with small relative error with respect to the corresponding euclidean map .",
    "moreover , it keeps a weights set only if the normalized polytope of the corresponding mask is convex , which allows application of the results from section  [ sec : wdp ] .",
    "the following tables give sets of integer chamfer mask weights for bcc grids with the scale factor allowing comparison of the final weighted distance map with an euclidean one composed with real numbers .",
    "they also give the maximum relative error that can occur between the weighted distance map and the euclidean one .",
    "for the two first cases , we also give the optimal real weights computed using the equations of section  [ sec : coeffsopt ] .",
    "balls obtained by using different number of weights ( shown in bold below ) are shown in figure  [ balls ] .    1",
    ".   one weight + for the mask corresponding to the 8-neighborhood , using only one weight , the equations of section [ sec : coeffsopt ] give the following result : + + [ cols= \" < , < \" , ]    +   +",
    "we have presented a general theory for weighted distances .",
    "this allows application of the weighted distance transform to any point - lattice . the optimal weight calculation and the construction of a chamfer algorithm to produce distance maps are straight - forward by the procedure in section  [ sec : coeffsopt ] and theorem  [ chamf - alg - theorem ] . for the chamfer algorithm to construct correct distance - maps ,",
    "the only limitation is that the image must be wedge - preserving , definition  [ def : wedge_pres ] , or have all border points in the background , definition  [ def : borderpoint ] . with these conditions which can easily be satisfied ,",
    "images in any dimension can be considered .",
    "it is also worth mentioning that despite its popularity , to our knowledge , no proof of the correctness of the two - scan algorithm has been published until now , except for the 2d 3 @xmath579 3 mask algorithm proof from 1966 @xcite . also , the important general formula for the weighted distance between two grid points in theorem  [ theorem : value ] is new .",
    "the application of these properties and of the chamfer algorithm are numerous for the cubic and parallelepiped grids in the literature . to illustrate how this theory can be applied",
    ", section  [ sec : bccfcc ] gives examples for the fcc and bcc grids .",
    "but it can be applied to any point - lattice , for example the 3d grid where the voxels are hexagonal cylinders as suggested in @xcite or 4d a grid as in @xcite , or even other grids as long as they satisfy the module conditions .",
    "j.  cai , j.  chu , d.  recine , m.  sharma , c.  nguyen , r.  rodebaugh , v.  saxena , a.  ali , ct and pet lung image registration and fusion in radiotherapy treatment planning using the chamfer - matching method . ,",
    "international journal of radiation oncology biology physics 43  ( 4 ) ( 1999 ) 883891 .",
    "l.  ibanez , c.  hamitouche , c.  roux , determination of discrete sampling grids with optimal topological and spectral properties , in : proceedings of @xmath580 conference on discrete geometry for computer imagery , lyon , france , vol .",
    "1176 of lecture notes in computer science , springer , 1996 , pp . 181192 .    c.  o.  s. sorzano , r.  marabini , j.  velzquez - muriel , j.  r. bilbao - castro , s.  h.  w. scheres , j.  m. carazo , a.  pascual - montano , xmipp : a new generation of an open - source image processing package for electron microscopy , journal of structural biology 148 ( 2004 ) 194204 .        c.  fouard , g.  malandain , s.  prohaska , m.  westerhoff , f.  cassot , c.  mazel , d.  asselot , j .-",
    "marc - vergnes , skeletonization by blocks for large datasets : application to brain microcirculation , in : international symposium on biomedical imaging : from nano to macro ( isbi04 ) , ieee , arlington , va , usa , 2004 .              c.  r. maurer , r.  qi , v.  raghavan , a linear time algorithm for computing exact euclidean distance transforms of binary images in arbitrary dimensions , ieee transactions on pattern analysis and machine intelligence 25  ( 2 ) ( 2003 ) 265270 .",
    "e.  remy , e.  thiel , look - up tables for medial axis on squared euclidean distance transform , in : proceedings of @xmath581 conference on discrete geometry for computer imagery , naples , italy , vol .",
    "2886 of lecture notes in computer science , springer , 2003 , pp . 224235 .",
    "l.  dorst , p.  w. verbeek , the constrained distance transformation : a pseudo - euclidian , recursive implementation of the lee - algorithm , in : proc .",
    "european signal processing conference 1986 , the hague , the netherlands , 1986 , pp ."
  ],
  "abstract_text": [
    "<S> this paper presents the generalization of weighted distances to modules and their computation through the chamfer algorithm on general point - lattices . </S>",
    "<S> a first part is devoted to the definitions and properties ( distance , metric , norm ) of weighted distances on modules , with a presentation of weight optimization in the general case , to get rotation invariant distances . </S>",
    "<S> a general formula for the weighted distance on any module is presented . </S>",
    "<S> the second part of this paper proves that , for any point - lattice , the sequential 2-scan chamfer algorithm produces correct distance maps . </S>",
    "<S> finally , the definitions and computation of weighted distances are applied to the face - centered cubic ( fcc ) and body - centered cubic ( bcc ) grids .    </S>",
    "<S> weighted distance , distance transform , chamfer algorithm , non - standard grids </S>"
  ]
}