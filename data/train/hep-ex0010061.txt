{
  "article_text": [
    "the general theory of confidence bounds ( or fiducial intervals ) was developed by fisher  @xcite , neyman and pearson  @xcite .",
    "we consider a particular problem which is of interests when cuts are used to analyze high energy physics data . typically , a neural network or some other method of performing the cuts results in probabilities ( efficiencies ) to tag signals more likely than background events .",
    "for instance by means of monte carlo ( mc ) simulations , these probabilities can normally be calculated .",
    "let @xmath3 be the probability to tag a signal and @xmath5 be the likelihood to tag a background event , @xmath7 . out of a total number of @xmath1 data",
    "one gets in this way @xmath8 it is easy to find from this the mean expectation for the signal probability .",
    "assume that there are @xmath0 signals and @xmath9 background events in the data .",
    "then we have @xmath10 and these two equations solve for @xmath11 the question is , what are the implied confidence limits on the signal probability ?",
    "the special case @xmath12 and @xmath13 ( sure signal detection ) has been treated by clopper and pearson  @xcite in 1934 .",
    "after briefly reviewing their approach in the next section , we derive and illustrate the general case in section  3 .",
    "this is , in part , based on ref.@xcite . in particular , the method is valid when the number of tagged data is small and returns the probability @xmath14 for the case that there is no signal , i.e. that the exact signal probability is @xmath15 .",
    "this is of interest for the statistical analysis of the ongoing higgs search at lep  @xcite .",
    "discovery of the higgs particle on the @xmath16 level would mean @xmath17 .",
    "subsection  [ fortran ] explains the use of the corresponding fortran programs and how to download them from the web .",
    "conclusions follow in the final section  [ conclusions ] .",
    "let @xmath18 be the likelihood that a data point is a signal . for @xmath1 measurements the probability to observe @xmath19 signals",
    "is given by the binomial coefficient @xmath20 the probability to observe @xmath21 signals is given by @xmath22 and the probability to observe @xmath23 signals by @xmath24 for @xmath25 and @xmath26 the functional forms of @xmath27 and @xmath28 are depicted in figure  [ fig_cp1 ] .",
    "assume that @xmath0 signals are found in @xmath1 measurements and that a probability @xmath29 ( typical values are @xmath30 or @xmath31 ) is given .",
    "we can solve equation ( [ plarge ] ) for @xmath32 and @xmath33 is a lower bound on the true signal probability @xmath2 , such that the likelihood to find @xmath21 signals in @xmath1 measurement is smaller than @xmath34 for every @xmath35 .",
    "correspondingly , we can solve equation ( [ psmall ] ) for @xmath36 and @xmath37 is an upper bound on the true signal probability @xmath2 , such that the likelihood to find @xmath23 signals in @xmath1 measurement is smaller than @xmath34 for every @xmath38 .",
    "together , this combines into the clopper ",
    "pearson bounds : the probability to find the true signal probability in the range @xmath39 in more details the meaning of the inequality is discussed in  @xcite . for @xmath40 ( @xmath30 )",
    "the @xmath41 values are indicated in figure  [ fig_cp1 ] .",
    "approximately , this range corresponds to the confidence of a @xmath42 error bar .",
    "similarly the confidence range corresponding to a @xmath43 error bar , etc . , can be found .",
    "we are interested in the situation where signal and background data can no longer be distinguished unambiguously . instead , a neural network or other device yields statistical information by tagging signals with efficiency @xmath3 and background data with probability @xmath5 , as discussed in the introduction .",
    "applying the cuts to all @xmath1 data results in @xmath6 tagged data ( @xmath44 ) , composed of @xmath45 , where @xmath46 is the number of tagged signals and @xmath47 is the number of tagged background data .",
    "of course , the values for @xmath46 and @xmath47 are not known .",
    "our task is to determine confidence limits for the signal probability @xmath18 from the sole knowledge of @xmath6 .",
    "we proceed by writing down the probability density of @xmath6 for given @xmath18 and , subsequently , generalizing the clopper - pearson method .    first , assume fixed @xmath0 .",
    "the probability densities of @xmath46 and @xmath47 are binomial and thus the probability density for @xmath6 is given by the convolution @xmath48 proof : for a signal event the probability to be tagged is @xmath3 , so @xmath49 is the probability to tag @xmath46 out of the @xmath0 signals .",
    "similarly , the probability for a background event to become tagged is @xmath5 and @xmath50 is the probability to tag @xmath47 of the @xmath51 background events . as these two probabilities are independent , the likelihood that precisely @xmath46 of the signals and @xmath47 of the background events are tagged becomes the product @xmath52 .",
    "summing over all possibilities which add up to @xmath53 gives the result .",
    "summing over @xmath0 in ( [ pys ] ) removes the constraint of fixed @xmath0 and , with @xmath1 , @xmath18 fixed , the probability to tag @xmath19 events becomes @xmath54 fourier transformation of the convolution  ( [ pys ] ) allows for an efficient numerical calculation of the @xmath55 coefficients . in analogy with equations  ( [ plarge ] ) and  ( [ psmall ] )",
    "we find the probabilities to tag @xmath56 and @xmath57 events to be @xmath58 for @xmath59 , @xmath60 , @xmath61 and @xmath62 the functions  @xcite @xmath63 and @xmath64 are depicted in figure  [ fig_cp2 ] .",
    "the 68% confidence range ( [ cp_bounds ] ) is also indicated in figure  [ fig_cp2 ] , where the bound values @xmath65 are now defined as solutions of the equations @xmath66 the range @xmath67 $ ] , obtained with @xmath30 , guarantees the standard one error bar confidence probability of 68% for every true signal probability @xmath2 . for almost all values the actual confidence will be better . however , the bounds can not be improved without violating the requested confidence probability for the case that @xmath2 happens to agree with either @xmath33 or @xmath37 . in the same way ,",
    "bounds calculated with @xmath68 ensure the standard two error bar confidence level of 95.4% or better , and so on .",
    "as outlined , data sets with few signals are of of particular interest in high energy physics .",
    "let us replace @xmath60 of figure  [ fig_cp2 ] by @xmath69 .",
    "the resulting graph is depicted in figure  [ fig_cp3 ] . from the @xmath63 curve we read off the finite probability @xmath70 for the likelihood that the true signal probability @xmath15 generates @xmath71 tags . due to this probability the lower 68% confidence bound",
    "@xmath33 disappears , whereas the upper @xmath37 bound does still exist . in passing",
    "let us note that for the data of figure  [ fig_cp2 ] we have @xmath72 , i.e. there @xmath15 is ruled out on the @xmath16 level .      to avoid frequentist objections , the cumulative signal distribution function @xmath73 is , in the opinion of the author , best defined as the _ expectation of the researcher _ to find the true signal probability @xmath2 in the range @xmath74 .",
    "our approach allows to estimate upper and lower bounds for the cumulative signal distribution function @xmath75 equation  ( [ ny_bounds ] ) implies @xmath76 and note that @xmath77 .",
    "figure  [ fig_cp4 ] shows the result for the same data which were used in figure  [ fig_cp2 ] .",
    "any reasonable bayesian estimates ( which involves additional _ a - priori _ assumptions ) should give a function @xmath73 which is sandwiched between @xmath78 and @xmath79 .",
    "it is instructive to define peaked distribution functions  @xcite by @xmath80 using the same data as in figure  [ fig_cp4 ] , @xmath81 and @xmath82 are depicted in figure  [ fig_cp5 ] .",
    "the advantages of using peaked distribution functions instead of conventional cumulative distribution functions are :    1 .",
    "the ordinate becomes enlarged by a factor of two .",
    "the estimated medians are located at the peaks and the probability content of the distribution is instructively displayed .",
    "bounds like those of figure  [ fig_cp1 ] are easily read off .",
    "the probability densities corresponding to the cumulative distribution functions  ( [ fpbounds ] ) are the derivatives of the @xmath83 with respect to @xmath18 @xmath84 their numerical calculation is straightforward when analytical expressions for the derivatives of the binomial coefficients in equation  ( [ pyp ] ) are used .",
    "figure  [ fig_cp6 ] exhibits the results for @xmath85 and @xmath86 corresponding to @xmath78 and @xmath79 of figure  [ fig_cp4 ] . at @xmath87",
    "the probability densities have @xmath88-function contributions @xmath89 in case of figure  [ fig_cp6 ] the @xmath90 coefficients are practically zero .",
    "however , for the probability densities corresponding to figure  [ fig_cp3 ] there would be a substantial contribution : @xmath91 and @xmath92 in that case .",
    "the fortran code which produces the illustrations of this paper is available on the web .",
    "start at the author s homepage  @xcite www.hep.fsu.edu/~@xmath93berg and follow the research and from there the clopper - pearson hyperlink .",
    "load down all files of the fortran  programs subdirectory into an empty directory .",
    "any standard fortran  77 compiler should then be able to compile the cp1.f , cp2.f and cp3.f programs .",
    "be aware that the program files include ( via include fortran statements ) some of the other files you downloaded .",
    "running one of the programs produces a data files with the name of that program and a .d extension .",
    "subsequently , gnuplot users can produce the graphical presentations of this paper by using the .plt driver files , as listed in the following .",
    "@xmath94 here , the gnuplot file number corresponds to the figure number of this paper .",
    "to get encapsulated postscript files , the comment signs in front of the first two rows of each gnuplot file have to be eliminated .",
    "we have calculated confidence limits , and corresponding limits of the entire cumulative distribution function , for an unknown true signal likelihood @xmath2 .",
    "the only input used are the efficiencies @xmath3 for tagging signals , the probabilities @xmath5 for tagging background events , the number @xmath6 of tagged data and the total number of data @xmath1 .",
    "in particular , the method allows to deal with the situation where only few signals occur and yields then a finite probability for the likelihood that @xmath56 tags are observed if the true signal probability is @xmath15 . in real life",
    "the probabilities @xmath3 and @xmath5 are most likely estimators by themselves , i.e. quantities with error bars .",
    "this causes no major problem , one just has to apply our confidence calculations to an appropriate sample and to average over the results ."
  ],
  "abstract_text": [
    "<S> for the measurement of @xmath0 signals in @xmath1 events rigorous confidence bounds on the true signal probability @xmath2 were established in a classical paper by clopper and pearson [ biometrica 26 , 404 ( 1934 ) ] . here </S>",
    "<S> , their bounds are generalized to the hep situation where cuts on the data tag signals with probability @xmath3 and background data with likelihood @xmath4 . </S>",
    "<S> the fortran program which , on input of @xmath3 , @xmath5 , the number of tagged data @xmath6 and the total number of data @xmath1 , returns the requested confidence bounds as well as bounds on the entire cumulative signal distribution function , is available on the web . </S>",
    "<S> in particular , the method is of interest in connection with the statistical analysis part of the ongoing higgs search at the lep experiments . </S>"
  ]
}