{
  "article_text": [
    "the habitats of many animal populations are geographically divided into numerous small patches , either because of human activities or because the animals natural habitats are patchy .",
    "understanding the dynamics of such populations is a problem of great theoretical and practical interest .",
    "isolated small habitats are often extinction prone , because of , e.g. , inbreeding in combination with demographic and environmental stochasticity @xcite . when the habitats are connected into a network by migration , local populations may still be extinction prone , but the whole population can be sustained because empty habitats are recolonized by migrants from surrounding occupied habitats .",
    "when the migration rate is high , also the local populations are stabilized by an inflow of immigrants ( the rescue effect ) .",
    "there are two main approaches to modeling such populations : first , simplified models that may be treated analytically , and , second , more detailed models where simulations are necessary . in the framework of @xcite , the full population dynamic is simplified by treating each patch as either occupied or empty .",
    "the rates of patch colonization and extinction are expressed as functions of the total fraction of occupied patches in the population , or as functions of the number of neighbouring patches in spatially explicit models .",
    "this reduction is generally motivated by a separation of time scale between colonization and extinction of habitats and the population dynamics within the habitats @xcite .",
    "many of the mechanisms that can be observed in natural populations ( e.g. allee and rescue effects ) have correspondences in levin s framework , and the qualitative behaviour of such models is well understood ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "more detailed models incorporate e.g. the effect of correlations between neighbouring patches , leading to non - uniform patterns of colonized patches @xcite , and of demographic stochasticity within the local habitats @xcite .",
    "the study of such models generally requires computer simulations ( but see * ? ? ?",
    "* for an exception ) .",
    "models that describe the metapopulation dynamic as a function of the fraction of occupied patches have no explicit connection to the population dynamic within each patch , i.e. it is not apparent how individual births , deaths , or migration events translate into effective colonization and extinction rates . starting with @xcite , several authors have attempted to bridge the gap between detailed local population dynamic and the dynamic at the overall population level ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this paper contributes to these efforts by deriving , from first principles , how the global stochastic dynamic leads to an effective deterministic time evolution of the habitats population size distribution .",
    "this gives additional insight in the dynamics of fragmented populations .",
    "the only critical assumption in this derivation is that the number of habitats is large enough .",
    "especially , the method can be used for any local stochastic population dynamic .",
    "the rest of the paper is organized as follows : in section  [ sec : pop_model ] the stochastic population model is presented ; in section  [ sec : approx_dynamic ] the method is developed from the full stochastic dynamic of the population ; in section  [ sec : example ] the method is compared to stochastic simulations of a model with local density dependent recruitment and mortality . finally , section  [ sec : discussion ] discusses the general implications of the results , and possible extensions of the method .",
    "consider a population with @xmath0 habitats ( patches ) , all equal . in each patch , the population changes according to a poisson process , where the rate of transition from @xmath1 individuals to @xmath2 individuals is given by @xmath3 . as an important special case , we have the standard birth - death dynamic , where individuals are born and die according to poisson processes with rates @xmath4 and @xmath5 , respectively , where @xmath1 is the number of individuals in the patch . in the general model",
    ", this corresponds to taking @xmath6 in addition to the local population dynamic , the number of individuals in each habitat can change because some individuals emigrate from the habitat to other patches , or because immigrants arrive from other patches . following @xcite ,",
    "the migration process is modeled as follows : individuals emigrate from a patch at rate @xmath7 , where @xmath1 is the patch population size .",
    "if the individuals migrate independently and with constant rate , @xmath7 is proportional to @xmath1 , but more complex migration patterns can be incorporated .",
    "if for example individuals move to avoid overcrowding , the migration rate becomes density dependent .",
    "the emigrants enter a common dispersal pool , containing the migrants from all patches that have not yet reached their target patch .",
    "each migrant stays an exponentially distributed time in the pool , with expected value @xmath8 , before reaching the target habitat , which is chosen with equal probability among all habitats .",
    "this process is illustrated in figure  [ fig : pop_illustr ] .",
    "migration may fail if the individuals die before reaching the new habitat ; this is modeled by the rate @xmath9 of dying per unit of time during dispersal . in practice , the probability of successful migration depends on the background mortality of the individuals , on the time it spends in the dispersal pool , and on additional perils that the individuals may be exposed to during dispersal ( e.g. increased risk of predation due to lack of cover , etc . ) .",
    "thus , if there are @xmath10 migrants , @xmath11 individuals leave the dispersal pool per unit of time , and the rate of immigration to a given patch is @xmath12 .",
    "illustration of the population dynamic of a patchy population . in each habitat , there are @xmath13 individuals in habitat @xmath14 , and @xmath10 emigrants in the dispersal pool . ]",
    "since the local population dynamic is assumed to be the same within all habitats , it is sufficient to count the number of habitats with a given number of individuals rather than keeping track of the number of individuals in each habitat .",
    "let @xmath15 denote the number of habitats with @xmath1 inhabitants at a given time .",
    "since the total number of patches is constant , we have @xmath16 at all times .",
    "when the number of individuals change from @xmath1 to @xmath2 in some habitat , @xmath15 decreases with one and @xmath17 increases with one . from the model in section",
    "[ sec : pop_model ] , we can write down a set of master equations for the probability @xmath18 of observing counts @xmath19 and @xmath10 individuals in the dispersal pool ( see the appendix ) . in principle",
    ", these equations can be integrated analytically . in practice , however , because the number of possible configurations grows exponentially with the number of patches , it is not possible to use the full master equation except when the number of habitats and the maximum population size are both small .",
    "when the number of habitats is large enough that the total population size is large , even though the number of individuals per habitat may be small , we can use a different approach . in this case",
    ", we can expect that the probability @xmath18 of observing a given distribution of habitat population sizes and number of migrants changes only a little when a single habitat ( or a habitat and the migration pool ) changes its population size .",
    "it is important here to emphasize that we make no assumptions on the size of the changes to the population size of any single habitat , only on that there are sufficiently many habitats that they form a statistical ensemble .",
    "hence , on the level of the population , this leads only to a single increment and decrement in the count of the number of patches with a given number of individuals .",
    "for instance , it is perfectly possible to have big jumps in the population number of individual patches in the model without violating the smoothness of the distribution of habitat population size .",
    "it is now convenient to express the frequency of habitat population sizes in terms of the scaled frequency @xmath20 and the patch immigration rate @xmath12 .",
    "the probability @xmath21 of observing @xmath22 and @xmath23 is related to the probability @xmath18 by @xmath24 in contrast to @xmath15 and @xmath10 , the distribution of @xmath25 and @xmath23 can be expected to become approximately independent of @xmath0 for a large number of habitats .",
    "a change of a single count @xmath15 leads only to the change @xmath26 in @xmath25 .",
    "similarly , a single increment of @xmath10 leads to the change @xmath27 in @xmath23 . since for large @xmath0",
    "the probability @xmath21 is an approximately continuous function of @xmath25 and @xmath23 , we can expand the full master equation of @xmath21 in terms of @xmath28 to obtain a partial differential equation for @xmath21 ( see appendix ) . taking only the leading term ( ignoring terms of order @xmath28 or higher )",
    ", we obtain a deterministic dynamic for @xmath25 and @xmath23 , given by @xmath29 + i(t ) f_{i-1 } +     e_{i+1}f_{i+1 } - \\big [ e_i + i(t ) \\big ] f_i      \\nonumber\\\\      & \\partial_t i = - ( \\alpha + \\nu ) i + \\alpha \\sum_{k=0}^\\infty e_k f_k .\\end{aligned}\\ ] ] in the limit of infinitely many patches , eq .",
    "( [ eq : nme1 ] ) gives an exact description of the dynamic .",
    "when the migrants spend a short time in the dispersal state compared to the normal birth - death dynamic , i.e. when @xmath30 is large , @xmath23 rapidly adjusts so that @xmath31 becomes approximately zero , i.e. @xmath32 at each moment in time . inserting this into eq .",
    "( [ eq : nme1 ] ) yields a nonlinear master equation for the patch dynamic ,",
    "@xmath33 +     e_{i+1}f_{i+1 } - e_i   f_i \\nonumber\\\\     & + \\ , \\frac{\\alpha}{\\alpha + \\nu } \\sum_{k=0}^\\infty e_k f_k \\left(f_{i-1 } - f_i\\right).\\end{aligned}\\ ] ] in this equation , @xmath34 is the probability that a migrant successfully reaches a new habitat . depending on the biological details of the dispersal , which are not explicitly modeled ,",
    "@xmath9 may depend on @xmath30 . the stationary solution of eq .",
    "[ eq : master_mig2 ] is similar to the result by @xcite .",
    "he does not , however , derive the equations from the full stochastic dynamic . in the next section ,",
    "i investigate the accuracy of this approximation by comparing the solution of the non - linear master equation to explicit stochastic simulations of a population where the local dynamic is governed by simple growth and density dependent mortality .",
    "as a simple but illustrative example , we consider a population with constant birth rate and migration rate per capita , and density dependent mortality .",
    "the birth , death , and migration rates of a patch with @xmath1 individuals are @xmath35 respectively , where @xmath36 is the carrying capacity .",
    "the parameters where chosen to give modest positive growth rate ( @xmath37 and @xmath38 ) at low numbers .",
    "we will assume that births and deaths during migration can be ignored ( @xmath39 ) , so that eq .",
    "( [ eq : master_mig2 ] ) applies . in order to investigate the accuracy of the theory , we will compare stochastic simulations of this dynamic to the solution of eq .",
    "( [ eq : master_mig2 ] ) , first with respect to the stationary states , for different @xmath40 and @xmath36 , and then to the full time evolution .       a : the average patch population size @xmath41 at equilibrium , as a function of migration rate @xmath40 from theory ( solid line ) , and from simulations for @xmath42 ( circles ) , @xmath43 ( triangles ) , and @xmath44 ( diamonds ) .",
    "the parameters are @xmath45 , @xmath46 , and @xmath47 .",
    "b : the fraction of colonized patches as a function of migration rate @xmath40 from theory ( solid line ) , and from simulations ( symbols ) .",
    "c : the average patch population size for an infinite number of habitats ( dashed line ) compared to simulations of finite number of habitats for @xmath42 ( circles , 95% approximate confidence intervals ) . ]    fig .",
    "[ fig : n_p_of_m ] shows the average patch population size , @xmath41 , and the fraction of occupied patches as a function of the migration rate , from explicit simulations of the stochastic dynamic of @xmath48 patches and from numerical solution of eq .",
    "( [ eq : master_mig2 ] ) , for three different values of the carrying capacity @xmath36 . the initial state for each simulation point",
    "was generated by distributing @xmath49 individuals randomly among the patches , so that the initial average number of individuals per patch is @xmath36 .",
    "the populations were simulated to time @xmath50 , and the mean population size and the fraction occupied patches were calculated as time - averages over the interval @xmath51 . if the population went extinct before the end of the simulation interval , the mean population size and fraction of occupied patches were taken to be zero .",
    "@xcite analyzed a deterministic version of this model , where the local dynamic is replaced with the deterministic counterpart . using the technique of @xcite",
    ", they found that the dynamic converges to @xmath52 and all patches occupied .",
    "when the migration rate @xmath40 is large , the average patch population size and the fraction of occupied patches are close to the values predicted by the deterministic local dynamic , but for small @xmath40 the differences are significant ; especially , with stochastic local dynamic both patch population size and the fraction of occupied patches decrease with decreasing migration rate , and for each value of @xmath36 there is a critical migration rate below which the population can not sustain itself and becomes extinct .",
    "for all values of @xmath40 , the stationary solution to eq .",
    "( [ eq : master_mig2 ] ) is in excellent agreement with the simulations .",
    "this illustrates the importance of accounting for stochasticity in the local dynamic , even though the global population changes deterministically .",
    "[ fig : n_p_of_m]c shows how the average patch population size typically depends on the number of patches ( see caption for parameter values ) , compared to the theoretical value in a population with an infinite number of patches .",
    "the average is increasing with increasing number of patches , but also for small @xmath0 the relative difference is not large .",
    "an import advantage of the theory presented in this paper is that it not only gives the equilibrium points of the stochastic population dynamic , but the complete time evolution of the population . in this section ,",
    "we compare the time evolution of the full stochastic simulations to the solution of eq .",
    "( [ eq : master_mig2 ] ) .",
    "[ fig : avg_n_ex1]a shows the time evolution of the average patch population size from simulations of @xmath48 patches ( black lines ) , with migration rate @xmath53 , starting from populations with three values of the average patch population size [ @xmath54 , @xmath55 , and @xmath56 .",
    "the initial populations were produced by distributing @xmath57 individuals randomly over the islands . also shown",
    "are the corresponding solutions to the nonlinear master equation , ( eq .  [ eq : master_mig2 ] , grey lines ) , starting from the same initial patch population size distribution as the corresponding simulations .",
    "simulations and theory are in close agreement , except some fluctuations in the simulations from the finite number of patches . these fluctuations become more pronounced around the stationary point of the dynamic .",
    "this can be expected since away from the equilibrium , relatively strong deterministic forces dominate the dynamic , but close to the equilibrium the dynamic is dominated by the stochastic components",
    ".     a : comparison of the average patch population size in simulation trajectories of @xmath58 patches ( black lines ) to the solution of the nonlinear master equation , eq .",
    "( [ eq : master_mig2 ] ) , starting from the same initial distribution of patch population sizes as the simulations ( grey lines ) , for three initial average patch population sizes ( @xmath59 , @xmath60 , and @xmath61 ) .",
    "the parameters are @xmath46 , @xmath47 , @xmath42 , and @xmath62 .",
    "b : time evolution of the fraction of empty patches , for the same trajectories as panel a. for @xmath63 and @xmath64 the fraction empty patches is approximately zero at all times . ]",
    "panel b of the same figure shows the time evolution of the fraction of empty patches for @xmath65 ( for the other values of @xmath66 , the fraction of empty patches is approximately zero at all times ) , from simulations and the nonlinear master equation . as before ,",
    "there are small differences from the stochastic fluctuations in the simulation .",
    "the number of patches is initially increasing , before reaching a maximum and eventually decreasing towards zero .",
    "this is a marked difference from the deterministic theory , that predicts a steady decrease towards zero .",
    "[ fig : m_0.01 ] shows the time evolution for a smaller migration rate , @xmath67 .",
    "this value is close to the critical migration rate for these parameters ( c.f .",
    "[ fig : n_p_of_m ] ) . as a consequence ,",
    "the average patch population size at the stationary point is much lower than for @xmath53 ( @xmath68 compared to @xmath69 ) , and the fluctuations in the population are larger .",
    "therefore , the simulation curves in fig .",
    "[ fig : m_0.01 ] are averages over ten independent realizations of the stochastic dynamic , starting from the same initial distribution",
    ".     a : comparison of the average patch population size in simulation trajectories of @xmath58 patches ( black lines ) to the solution of the nonlinear master equation , eq .",
    "( [ eq : master_mig2 ] ) , starting from the same initial distribution of patch population sizes as the simulations ( grey lines ) , for three initial average patch population sizes ( @xmath59 , @xmath70 , and @xmath71 ) .",
    "the parameters are @xmath46 , @xmath47 , @xmath42 , and @xmath72 .",
    "b : the time evolution of the fraction of empty patches . ]    as a final comparison , fig .",
    "[ fig : distr_n_ex1 ] shows the distribution of patch sizes in the simulations to the solution of the nonlinear master equation at different times , from the simulations in fig .  [",
    "fig : avg_n_ex1 ] and fig .",
    "[ fig : m_0.01 ] . because of the finite number of patches ( @xmath58 ) there is significant spread around the prediction of eq .",
    "( [ eq : master_mig2 ] ) , but as can be seen in the right column , where the distribution is averaged over ten independent realizations , eq .  ( [ eq : master_mig2 ] ) predicts the expected distribution quite well .",
    "normalized histogram of patch population sizes from simulations ( black lines ) compared to the solution of the non - linear master equation ( grey lines ) . left column : @xmath53 , started from @xmath73 , for @xmath74 , @xmath75 , and @xmath76 ( from the simulation in fig .",
    "[ fig : avg_n_ex1 ] ) .",
    "right column : @xmath67 and @xmath77 , for @xmath78 , @xmath79 , and @xmath80 ( from the simulation in fig .",
    "[ fig : m_0.01 ] ) . for increased legibility",
    ", the simulation histograms where binned in groups of two . ]",
    "the model presented in this article makes several assumptions that are idealizations of more realistic scenarios .",
    "most of these are not necessary , but were introduced in order to simplify the description of the method .",
    "for example , it is assumed that all habitats have the same size , availability of food etc .",
    ", so that the dynamic is the same . in many cases ,",
    "habitats are not equal but can vary significantly in terms of size and quality @xcite .",
    "it is straightforward to extend the model presented in this paper to incorporate population structure , where the parameters governing the local patch dynamic may vary between patches .",
    "in addition , it is assumed that individuals migrate independently of others , although the rate of migration can have an arbitrary dependence on the local patch population size . in biologically more realistic situations ,",
    "several individuals could leave and arrive together .",
    "in addition , it may happen that both emigration and immigration leads to ( or is caused by ) a disruption of the local population , e.g. a conflict @xcite .",
    "it is possible to include such processes directly into the equations of motion by modeling them with a probability transition matrix that connects the states before and after the event .    local colonization and extinction events",
    "are correctly captured by eq .",
    "( [ eq : nme1 ] ) , and if the dynamic is such that the population is driven to extinction in a deterministic manner , e.g. because deaths are systematically more frequent than births , these equations will show this as well .",
    "the risk of extinction of the whole population from demographic stochasticity can not be calculated , however , since the derivations assume that the number of migrants in the dispersal pool is large . in order to study such events",
    "it is necessary to extend the calculation in the appendix to terms of the order @xmath28 .",
    "the resulting partial differential equation is a diffusion approximation for the distribution of habitat population sizes , which can be used to approximately calculate the expected time to extinction of the whole population and more accurately estimate average population sizes .",
    "one of the main conceptual difficulties in modeling the population dynamic in terms of population extinction and colonization events is in defining when an empty patch is ` colonized ' : is it when the first individuals arrives at the path , as in @xcite , or should the patch be considered colonized first when the number of individuals is typical of a non - empty patch , as in @xcite ?",
    "the method in this paper avoids this issue completely , since it deals directly with the distribution of the number of individuals in the habitats .",
    "this is especially important when habitats are small but many . in this case",
    ", there may not be a clear separation between colonized and empty patches , but rather a continuum of patch population sizes ( c.f .",
    "[ fig : distr_n_ex1 ] ) .",
    "the standard perception of the population dynamic of fragmented populations has been that the local birth and death dynamic is much more rapid than the rate of extinction and recolonization of patches , so that the number of individuals in the occupied patches approaches a value determined by the number of occupied patches between each patch colonization or extinction event .",
    "the derivations presented in this paper show that this view can be slightly misleading ; rather than resulting from a separation of time scale between local dynamic and patch colonization and extinction , the effective population dynamic stems from a law of large numbers , where local fluctuations are buffered through a common migration pool so that the global dynamic remains smooth .",
    "hence , the change in the fraction of occupied patches and in the average number of individuals on occupied patches are coupled through their shared dependence on the rate of immigration .    finally , since the only critical assumption behind these results is that the number of habitats is large , the theory is especially suited to further elucidating the interplay of local stochastic dynamics and environmental factors in populations undergoing change .",
    "this work was funded by the centre for theoretical biology , gothenburg university .",
    "i am indebted to karin harding for introducing me to the metapopulation concepts and to the work by hanski and gyllenberg , and to andrea morf and david kleinhans for proofreading and comments .",
    "our starting point is the time evolution of the probability @xmath18 of having @xmath15 habitats with @xmath1 individuals , for @xmath81 and @xmath10 individuals in the dispersal pool , with the total count normalized as @xmath16 .",
    "this gives an exact description of the full stochastic population dynamic .",
    "taking into account the local dynamic in each patch , the migration process and the mortality due to migration , we obtain the master equation @xmath82 \\nonumber\\\\    &    + \\sum_{i=0}^\\infty e_{i+1 } ( n_{i+1 } + 1 ) \\ , \\rho(\\ldots , n_i - 1 , n_{i+1 } + 1 , \\ldots , m-1 )   \\nonumber\\\\    &    + \\sum_{i=1}^\\infty \\alpha ( m+1 ) \\frac{n_{i-1 } + 1}{n } \\",
    ", \\rho(\\ldots , n_{i-1 } + 1 , n_i-1 , \\ldots , m+1 ) \\nonumber\\\\    &    - \\sum_{i=0}^\\infty \\left(e_i n_i +   \\alpha m \\frac{n_i}{n } + \\nu m \\right ) \\rho   \\end{aligned}\\ ] ] for these probabilities . for brevity , we show only the variables date differs from the left - hand side in these expressions .",
    "we now express the state in terms of the normalized frequencies @xmath20 and the rate of immigration to a given patch , @xmath12 . when the number of habitats is large , each event leads only to a small change in the probability @xmath83 ( each change is of the order @xmath26 ) .",
    "expanding @xmath21 to order @xmath26 , and ignoring terms of order @xmath84 and higher , leads to the deterministic equations of motion for @xmath25 and @xmath23 .",
    "@xmath85 \\nonumber\\\\     & + n \\sum_{i=0}^\\infty e_{i+1 } \\left(f_{i+1 } + \\frac{1}{n}\\right ) \\left(\\tilde\\rho - \\frac{1}{n}\\partial_{f_i}\\tilde\\rho + \\frac{1}{n}\\partial_{f_{i+1 } }   \\tilde\\rho - \\frac{\\alpha}{n}\\partial_{i}\\tilde\\rho \\right ) \\nonumber\\\\      & + n \\sum_{i=1}^\\infty \\left(i + \\frac{\\alpha}{n}\\right ) \\left(f_{i-1 } + \\frac{1}{n}\\right )       \\left(\\tilde\\rho + \\frac{1}{n}\\partial_{f_{i-1}}\\tilde\\rho -\\frac{1}{n}\\partial_{f_{i}}\\tilde\\rho   + \\frac{\\alpha}{n}\\partial_{i}\\tilde\\rho \\right ) \\nonumber\\\\ & +",
    "n \\frac{\\nu}{\\alpha } \\left(i + \\frac{\\alpha}{n}\\right ) \\left(\\tilde\\rho + \\frac{\\alpha}{n}\\partial_{i}\\tilde\\rho\\right )   -    n \\sum_{i=0}^\\infty \\left ( e_i f_i +   f_i i + \\frac{\\nu}{\\alpha } i \\right ) \\tilde\\rho.\\end{aligned}\\ ] ] collect terms in increasing order of @xmath28 , we find that the coefficients of the leading term ( proportional to @xmath0 ) cancel , and the remaining terms can be written as @xmath86    + \\partial_i \\left [   ( \\alpha + \\nu ) i \\tilde\\rho - \\alpha \\sum_{i=1}^\\infty e_i f_i \\tilde\\rho \\right ] \\nonumber\\\\     \\hspace{-0.5 in } & & + \\sum_{i=0}^\\infty \\partial_{f_i } \\left [ \\left(e_i + i\\right ) f_i \\tilde\\rho - i f_{i-1 } \\tilde\\rho - e_{i+1 } f_{i+1 } \\tilde\\rho   \\right]\\end{aligned}\\ ] ] where we have ignore all terms of order @xmath28 or higher .",
    "hence , the probability obey a transport equation .",
    "rearranging the terms , we obtain eq .",
    "( [ eq : nme1 ] ) ."
  ],
  "abstract_text": [
    "<S> understanding the time evolution of fragmented animal populations and their habitats , connected by migration , is a problem of both theoretical and practical interest . </S>",
    "<S> this paper presents a method for calculating the time evolution of the habitats population size distribution from a general stochastic dynamic within each habitat , using a deterministic approximation which becomes exact for an infinite number of habitats . </S>",
    "<S> fragmented populations are usually thought to be characterized by a separation of time scale between , on the one hand , colonization and extinction of habitats and , on the other hand , the local population dynamics within each habitat . </S>",
    "<S> the analysis in this paper suggests an alternative view : the effective population dynamic stems from a law of large numbers , where stochastic fluctuations in population size of single habitats are buffered through the dispersal pool so that the global population dynamic remains approximately smooth . for illustration , </S>",
    "<S> the deterministic approximation is compared to simulations of a stochastic model with density dependent local recruitment and mortality . </S>",
    "<S> the article is concluded with a discussion of the general implications of the results , and possible extensions of the method .    </S>",
    "<S> fragmented populations , stochastic population dynamics , metapopulation dynamics , dispersal pool , migration </S>"
  ]
}