{
  "article_text": [
    "time - distance helioseismology @xcite is a local helioseismological technique that has been used to study meridional flows , flows and sound speed perturbations beneath sunspots ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "it measures the time for a wavepacket to travel between any two points on the solar surface , by computing a temporal cross - covariance between the doppler time series at the two points .",
    "the travel time is then inverted to infer various properties that are useful to map local structures of the sun .",
    "these results are interesting , as they complement the results obtained from global helioseismology based on inversion of normal mode frequencies .",
    "however , many aspects of time - distance helioseismology are still not fully understood .",
    "in particular , it has been observed that sunspots suppress the @xmath0-mode amplitude appreciably , but its consequences on travel times and the properties derived by inverting them has largely remained unexplored .    the commonly used procedure of measuring the phase and group travel times of acoustic waves is based a gabor - wavelet fitting formula derived by @xcite for cross - covariance of randomly excited oscillation modes of the quiet sun ( represented by a spherically symmetric model ) .",
    "initially , this procedure included only a broad - band frequency filtering of the solar oscillation signal , centered at the peak of acoustic power .",
    "later , it was modified by adding a phase - speed filtering procedure in order to isolate the first - bounce signals ( direct waves without additional reflections from the surface ) and to improve the signa - to - noise ratio @xcite .",
    "the phase - speed filtering is important for the analysis of acoustic - wave packets traveling short travel distances , e.g. less than @xmath1 heliographic degree ( @xmath2 mm ) . for larger distances the travel times",
    "can be measured without the phase - speed filtering , and it is found that the use of the phase - speed filtering does not significantly affects the measurement results . for shorter distances",
    "the influence of the phase - speed filtering may be significant , and has to be taken account .",
    "in this paper we study the effects of the phase - speed filtering and local spatial suppression of doppler velocity signals from a quiet patch on the sun , on the travel times . in this ` masking ' procedure suggested by @xcite to simulate this effect in sunspots the oscillation signal of a quiet sun region is multiplied by an inverted modulation function of spatial coordinates with azimuthal symmetry .",
    "this function is called a mask , and is not a function of time .",
    "one should note that while this procedure models a spatial modulation of acoustic power , it does not represent the modulation observed in sunspots , where the amplitude of acoustic changes due do several physical factors , such as reduced excitation , absorption , changing wave speed , and spectral line formation observing conditions .",
    "recently , @xcite attempted to quantify these contributions using observational data .",
    "the variations of the oscillation power in sunspots have not been explained by theory or simulations ( e.g. * ? ? ?",
    "* ) . nevertheless , it is interesting to investigate the effects of the variations on the helioseismic travel times by using the simple ` masking ' model bearing in mind that it may not represent the the real situation in sunspots .",
    "one advantage of the ` masking ' model is that it allows relatively simple analytical investigation .    to understand the results of amplitude suppression or enhancement we theoretically model the effect of masking by computing the cross - covariance of a masked signal that has been filtered by an appropriately designed phase speed filter .",
    "analytical expressions for the cross - covariance are derived in terms of the mask , the filter parameters , the properties of the signal and the dispersive nature of the solar medium , when the the mask is azimuthally symmetric .",
    "this analysis will be useful to study the effect of masking on travel time measurements and the properties that are inferred from inverting the travel times .",
    "this will be especially valuable in artificially mimicking how the sunspots influence the travel times of @xmath0 modes , and also other instrumental effects that corrupt the observed signal .",
    "consider a doppler signal from a quiet patch on the sun .",
    "travel time maps for this region are computed by fitting the observed cross - covariance by a gabor wavelet @xcite .",
    "now this region is masked by a spatial function to induce an artificial suppression in amplitude .",
    "one could alternatively enhance the amplitude in a similar manner .",
    "maps for both mean and difference travel times are computed , also by fitting a gabor wavelet . taking the difference between the quiet and masked travel time maps , one sees appreciable shifts in the travel times around the masked region .",
    "this is illustrated in the paper of @xcite .",
    "it is generally observed that the difference travel times show appreciable shifts compared to the mean travel times in the masked region .    in time - distance helioseismology",
    "we deal with acoustic waves near the solar surface , that are observed by measuring the line of sight doppler velocity signal on the solar surface that has both radial and horizontal components of displacement . without loss of generality",
    ", the line of sight direction is taken along the x axis .",
    "the signal is a sum of normal modes , and at a position @xmath3 on the solar surface and time @xmath4 is written as , @xmath5 ( * ? ? ?",
    "* e.g. ) . for each mode ,",
    "@xmath6 where , the spatial part is given by projecting along the x - axis .",
    "@xmath7 \\right \\}\\nonumber \\label{eq2}\\ ] ] where , @xmath8 where , @xmath9 is the co - latitude , @xmath10 is the longitude , @xmath11 is the solar radius , @xmath12 , the mode amplitude @xmath13 , the phase @xmath14 , and @xmath15 and @xmath16 are the radial and horizontal components of the eigenfunctions respectively evaluated at @xmath11 , and are therefore numbers .",
    "the spherical coordinate system is specified by unit vector @xmath17 in the radial direction @xmath18 , and two unit vectors @xmath19 and @xmath20 in the horizontal directions @xmath9 and @xmath10 respectively",
    ". each normal mode is specified by a 3-tuple @xmath21 of integer parameters , corresponding angular frequency @xmath22 , the mode amplitude @xmath13 , the phase @xmath14 .",
    "the integer @xmath23 denotes the degree and @xmath24 the azimuthal order , @xmath25 , of the spherical harmonic @xmath26 , which is a function of the co - latitude @xmath9 and longitude @xmath10 .",
    "these describe the angular structure of the eigenfunctions .",
    "the third integer @xmath27 of the 3-tuple @xmath28 is called the radial order . for a spherically symmetric sun ,",
    "all modes with the same @xmath27 and @xmath23 have the same eigenfrequency @xmath29 , regardless of the value of @xmath24 .    in time - distance helioseismology",
    "we measure the travel time of wave packets by forming a temporal cross - covariance between the oscillation signals at two locations separated by an angular distance on the solar surface . to model this we represent the solar oscillations on the solar surface as a linear superposition of normal modes , that are band - limited in angular frequency @xmath30 .",
    "this is achieved by replacing @xmath31 in equation ( [ eq2 ] ) by the gaussian frequency function @xmath32 , which models the amplitude of the solar modes , @xmath33 where , @xmath34 is a coefficient of @xmath23 , which is discussed in @xcite .",
    "this function groups modes within a certain range of frequencies , which is controlled by the width @xmath35 , about a central frequency @xmath36 in the @xmath37 diagram .",
    "a phase speed filter is applied , and modes are selected from the @xmath37 diagram to construct the cross - covariance wave packet .",
    "it is specified by a gaussian centered around a phase speed @xmath38 and a width @xmath39 as parameters , and is given by @xmath40 where , the phase speed @xmath41 , @xmath42 , @xmath43 is the horizontal wave number .",
    "the role of the phase speed filter is to select waves with a small range of phase speeds , the range is specified by the width @xmath39 .",
    "all these waves travel approximately the same horizontal distance on the solar surface , and sample the same vertical depth in the solar interior .",
    "hence , it is crucial to select @xmath39 appropriately so as to make the cross - covariance more robust , and hence be able to resolve the sub - surface structures in the sun .    due to the band - limited nature of the oscillation amplitudes , only values of @xmath44 which are close to @xmath45",
    "contribute to the sum of equation ( [ eq1 ] ) , and hence , following @xcite , we taylor expand @xmath44 about the central frequency @xmath36 , up to the first order : @xmath46   \\approx l(\\omega_o ) + \\frac{dl}{d\\omega}(\\omega - \\omega_o )   \\label{eq6}\\ ] ] the equation ( [ eq6 ] ) can be written in terms of the group velocity @xmath47 and phase velocity @xmath48 , evaluated at @xmath49 , and using the fact @xmath50 , we have @xmath51 likewise , the phase velocity @xmath52 can be expanded about the point @xmath53 in the @xmath37 diagram to yield @xmath54 where , @xmath55 , and the filter width @xmath39 is evaluated at @xmath56 , and is a constant .",
    "the taylor expansion is valid when the second order effects are small .",
    "these may not be small for small distances @xmath57 , when the waves spend most of the time in the outer layers of the sun .",
    "in these layers all the solar properties change abruptly and there are large gradients present , so higher order terms in the taylor expansion should be retained .",
    "this could make the analytical calculation formidable .",
    "the cross - covariance @xmath58 for the phase speed filtered doppler signal + @xmath59 as a function of the time lag @xmath60 is defined as @xmath61 and involves integrating the product of the projected line of sight filtered doppler signals at the two locations @xmath62 and @xmath63 on the solar surface over a time interval @xmath64 , that is related to the period of the time series being cross correlated .",
    "here we have replaced @xmath31 by the gaussian frequency envelope function @xmath32 in equation ( [ eq4 ] ) .    the cross - covariance from equation ( [ eq11 ] )",
    "is therefore , @xmath65 \\label{eq12}\\ ] ] where , @xmath66 corresponds to the positive time lag and @xmath67 , corresponds to the negative time lag . since @xmath68 is an even function , @xmath69 .",
    "this approximation is valid for large @xmath23 , small @xmath57 , such that @xmath70 is large .",
    "the phase term @xmath71 and the factor @xmath72 are due to the horizontal component of the displacement , and depend on the location of the points @xmath73 and @xmath74 , and are discussed in @xcite .",
    "the inner sum over @xmath29 is replaced by an an integral over @xmath30 , and we drop the negative lag term by extending @xmath30 to negative values to get @xmath75   \\cos(\\omega\\tau - l\\delta - \\zeta + \\frac{\\pi}{4 } ) \\label{eq13}\\ ] ] evaluating the integral @xcite , we get @xmath76 the shifted phase travel time @xmath77 due to the phase speed filter and horizontal component is therefore , @xmath78 and the shifted frequency , @xmath79 . the amplitude scaling term is @xmath80 summing equation ( [ eq14 ] ) over phase velocities we get the final cross - covariance . @xmath81 the dimensionless quantities @xmath82 and @xmath83 represent the relative deviation of the group travel time @xmath84 and phase travel time @xmath85 respectively from the filter phase travel time , @xmath86 .",
    "the filter widths appear in a dimensionless parameter @xmath87 .",
    "the dispersive characteristics of the solar medium and the filter properties are related through the dimensionless parameter @xmath88 .",
    "equations ( [ eq14]-[eq16 ] ) provide a generalization of the gabor wavelet fitting formula of @xcite for the phase - speed filtering procedure .",
    "obviously , the filter width @xmath39 is very large , so that parameter @xmath89 these equations are reduced to the standard fitting formula .",
    "in this section , we derive a formula for the time - distance cross - covariance function in the presence of a localized amplitude masking .",
    "this provides estimates of the masking effect on the time - distance helioseismology measurements for various wave properties and observational parameters , including phase - speed filtering which is the major factor affecting the measurements .",
    "we consider a modulation function @xmath90 with azimuthal symmetry so as to simplify the analytical derivation .",
    "it can therefore be expanded as    @xmath91    where , the approximation is valid for large @xmath23 , small @xmath9 , such that @xmath92 is large @xcite . it should be noted that due to the azimuthal symmetry the mask function is independent of @xmath10 , and hence on @xmath24 in this expansion in equation ( [ eq30 ] ) . using orthonormality of @xmath93 , we can compute the coefficient @xmath94 as @xmath95 since the masking is carried out in a localized region we define the mask function that we apply to the signal as @xmath96 where , @xmath97 scales the mask function @xmath90 , and is positive for enhancing the signal and negative for suppressing it .",
    "the coefficient @xmath98 is @xmath99 masking takes place in the spatial domain and is independent of time .",
    "it consists of multiplying the signal @xmath100 with the mask function @xmath101 .",
    "the mask function @xmath101 given in equation ( [ eq32 ] ) , and it is used to spatially modulate the signal @xmath102 resulting in the masked signal @xmath103 , @xmath104d^x(\\vec r , t )   = d^x(\\vec r , t ) + s ~",
    "q(\\theta)d^x(\\vec r , t ) =   d^x(\\vec r , t ) + s ~ d_q^x(\\vec r , t ) \\label{eq34}\\ ] ] where , @xmath105 is the spatially modulated signal .",
    "the effect of masking is seen when we phase speed filter the masked signal . in the absence of a phase speed filter",
    "we do not observe any masking effect in the time - distance cross - covariance .",
    "phase speed filtering of the masked signal leads to @xmath106 the cross - covariance of the masked filtered signal is @xmath107 substituting the expression for @xmath108 from equation ( [ eq35 ] ) into equation ( [ eq36 ] ) and using equation ( [ eq32 ] ) leads to @xmath109 this is the final expression for the time - distance cross - covariance function with amplitude masking .",
    "it contains terms that result from the interaction of the phase speed filter and the mask function .",
    "the term @xmath58 is due to the phase speed filter alone , and does not contain the effect of the mask . the term @xmath110 is obtained by cross correlating the filtered signal with the modulated filtered signal , @xmath111 is the cross covariance of the modulated filtered signal with the filtered signal .",
    "the last term @xmath112 is got by cross correlating the modulated filtered signal at both the points @xmath73 and @xmath74 .",
    "the cross - covariance from equation ( [ eq11 ] ) is therefore , @xmath113 @xmath114 where , @xmath115 is the @xmath24-averaged part of the spatial signal in the cross covariance @xcite .",
    "we have on combining the cosine terms , @xmath116 \\label{eq40}\\ ] ] the phase factor @xmath71 is due to the horizontal component of the displacement , and depends on the location of the points being cross correlated .    in equation ( [ eq40 ] )",
    "we replace the dummy variable @xmath29 by @xmath30 , and drop the negative time lag term by extending the sum over @xmath30 to negative frequencies , we get @xmath117 the inner sum in equation ( [ eq41 ] ) is written as @xmath118 multiplying with the mask function the different cross covariance are , @xmath119 @xmath120 where @xmath121 is colatitude of @xmath74 .    substituting the expansion for @xmath122 into equation ( [ eq44 ] ) we get @xmath123    substituting the asymptotic expansion for @xmath124 into equation ( [ eq45 ] ) and combining the cosine terms we get @xmath125 \\nonumber \\label{eq46}\\ ] ]    combining the cosine terms in equation ( [ eq46 ] ) and letting @xmath126 , @xmath127 , @xmath128 , @xmath129 , @xmath130 , @xmath131 , we get @xmath132 in equation ( [ eq47 ] ) the functions @xmath133 are evaluated at @xmath29 .",
    "the sum can be converted into an integral over @xmath30 as before after dropping the negative lag terms @xmath134 and @xmath135 , and extending @xmath30 to take negative values we get a sum of two gabor wavelets .",
    "this shifts , the various travel times to @xmath136 , @xmath137 , @xmath138 , @xmath139 and @xmath140 , @xmath141 .",
    "these shifts in travel times are related to the mask position .",
    "hence , @xmath142 , @xmath143 and @xmath144 change to @xmath145 , @xmath146 and @xmath147 respectively , with the usual definitions .",
    "similarly we have travel times for @xmath148 : @xmath149 , @xmath150 , @xmath151 .",
    "therefore , @xmath152 @xmath153 similarly for the other terms @xmath154 @xmath155 \\label{eq50}\\ ] ] simplifying in a similar manner the inner sum of equation ( [ eq50 ] ) is , @xmath156 where subscript 1 in the travel times corresponds to the mask position @xmath157 of @xmath73 .",
    "therefore , @xmath158 finally , @xmath159 @xmath160\\nonumber \\label{eq54}\\ ] ] combining the various cosine terms in the inner sum of equation ( [ eq54 ] ) we obtain , @xmath161/4 , \\label{eq55}\\ ] ] where @xmath162 , @xmath163 , @xmath164 , @xmath165 , @xmath166 , @xmath167 , @xmath168 , @xmath169 , @xmath170 , @xmath171 , @xmath172 , @xmath173 . the sum can be converted into an integral as before , and the resulting expression is a sum of four gabor wavelets given by @xmath174 @xmath175 @xmath176 @xmath177 this shifts , the various travel times to @xmath178 and @xmath179 .",
    "these shifts in travel times are related to the mask position .",
    "hence , @xmath180 and @xmath144 change to @xmath181 and @xmath182 respectively , with the usual definitions .",
    "similarly , the other combinations can be defined .",
    "therefore , @xmath183 the cross covariance @xmath184 is the sum of the four gabor wavelets that depend on the masking parameters and is given by @xmath185 similarly , the cross covariance for the masking function @xmath101 can be found with @xmath94 repalced by @xmath98 , and is given by @xmath186 where the coefficient @xmath98 can be calculated from equation ( [ eq33 ] ) for the mask function @xmath101 .",
    "these equations which are nothing but the sum of gabor wavelets can be used for the fitting . comparing the different equations we find that the form of the gabor wavelet is retained when a mask function with azimuthal symmetry is used . however , masking introduces shifts in the group and phase travel time by modifying the angular distance @xmath57 .",
    "the formula in equation ( [ eq57 ] ) is the masked cross - covariance .",
    "there are few extra parameters that represent the shifts in the phase and group travel times , due to the masking process that depend on the angular positions of the mask function .",
    "the coefficients @xmath94 and @xmath98 represent the functional form of the mask functions .",
    "similar dependence is seen in @xcite .",
    "a detailed numerical investigation of the amplitude modulation effects is outside the scope of this paper . in figure",
    "[ fg1 ] , we just give an example of the expression in equation ( [ eq57 ] ) plotted for a particular mask position and compared with equation ( [ eq14 ] ) without masking .",
    "we observe shifts in the cross covariance and hence the travel times change due to the masking process .",
    "to investigate to effect of the shape of the mask function , different values of @xmath98 need to be included when computing the sum in equation ( [ eq58 ] ) . in this derivation",
    "we assumed that the modulation function exhibits azimuthal symmetry .",
    "for a general modulation function , the analytical approach becomes difficult , and numerical methods must be employed .    in the model presented here",
    ", we assumed that the solar p modes have a narrow gaussian amplitude function , that is peaked at @xmath36 .",
    "using this fact we evaluate the phase shift factor due to the horizontal component at this frequency @xcite . hence",
    "to a first order approximation , the phase shift is not affected by the masking procedure . in order to see the effect of masking on the horizontal component",
    ", we have to retain the frequency dependence of the phase shift factor when evaluating the integral in @xmath30 .",
    "this will make the analytical approach intractable and the integral will have to be evaluated numerically .      in the previous section",
    "the signal @xmath102 was first masked by @xmath101 and then phase speed filtered by @xmath187 .",
    "the signal is , @xmath188 expanding @xmath101 from equation ( [ eq32 ] ) leads to @xmath189 we immediately see that this corrupts the eigenfunction due to the @xmath93 term in the sum in equation ( [ eq60 ] ) .",
    "the resulting cross - covariance was @xmath190 .",
    "we now reverse the order , first phase speed filter the signal @xmath191 to get @xmath192 and then mask to get @xmath193 . computing the cross - covariance @xmath194 for @xmath195 ,",
    "@xmath196 this results in @xmath197 , which is different from the expression for @xmath198 in equation ( [ eq37 ] ) .",
    "hence the order of masking and phase speed filtering are not interchangeable .",
    "also we observe that phase speed filtering followed by masking results in the cross - covariance being just scaled in amplitude by the product of the mask functions @xmath199 , the travel times being unaffected by the process of masking .",
    "this is because masking changes the mode eigenfunctions due to the presence of an additional term @xmath93 in equation ( [ eq60 ] ) . of course",
    ", the modified eigenfunctions no longer satisfy the original wave equation for solar oscillations .",
    "thus , this procedure can not be considered as a physical model of the amplitude variations observed in sunspots .",
    "our calculations show that the phase - speed filtering procedure of the masked signal leads to spurious shifts in travel times due to mixing of different @xmath23 modes by the phase - speed filter .",
    "these shifts can occur if the masking is attributed to instrumental effects .",
    "however , this does not mean that the amplitude modulation due to the physical effects in sunspots results in similar effects in the travel - time measurements .",
    "this must be studied using realistic mhd models of sunspots .",
    "masking is observed only when the data is phase speed filtered after multiplying the signal with the mask function . in this section",
    "we show that just using a gaussian frequency filter without a phase speed filter leads to no masking .",
    "consider a masked signal @xmath103 that is filtered by a gaussian frequency filter @xmath200 .",
    "the mask function @xmath101 is independent of @xmath23 , and since the gaussian frequency filter @xmath201 does not depend on @xmath23 , unlike the phase speed filter , the mask function @xmath101 can be pulled out of the sum in equation ( [ eq62 ] )    @xmath202    where , @xmath203 is the signal filtered by a gaussian frequency filter .",
    "we see that the frequency filtered signal @xmath204 is scaled by the mask function @xmath101 , hence the cross - covariance @xmath205 of @xmath206 is @xmath207 where , @xmath208 is the cross - covariance of the gaussian filtered signal @xmath204 .",
    "we see that the effect of masking on the travel times is not observed in @xmath205 .",
    "it only undergoes a scaling of its amplitude by @xmath209 .",
    "so the effect of masking is not observed when the phase speed filter is absent , and we apply only a gaussian frequency filter to the data .",
    "in this paper we give an explanation as to why the localized spatial suppression or enhancement ( masking ) of the acoustic signal followed by phase speed filtering can appreciably shift the measured travel times , and cause systematic errors in time - distance inversions .",
    "using only a frequency filter or reversing the operation of suppression ( or enhancement ) and phase speed filtering does not shift the travel times , but merely scales the cross covariance .",
    "hence , the operations of masking and phase speed filtering are non - commutative .",
    "to explain this we develop a model and derive a new analytical formula for the cross - covariance in terms of the masking parameters , when the mask function has azimuthal symmetry .",
    "the reason for this is due to the fact that masking changes the spatial mode eigenfunctions , which when phase speed filtered , leads to a mixing of spatial modes , and is responsible for the travel time shifts",
    ". this may be useful to mimic amplitude changes in sunspots due to pure observational reasons , such as caused by altering the height of formation of the spectral line used for helioseismology measurements , and also to correct for the shifted travel times due to such effects .",
    "however , contrary to @xcite suggestion , the procedure of masking oscillations of the quite sun can not model the amplitude reduction in sunspot due to physical mechanisms ( e.g. changes in emissivity or wave absorption ) , and thus their recommendations of correcting the amplitude reduction by reversed masking may cause artificial shifts in observed travel times , and thus must be taken with caution .",
    "kosovichev , a. g. , & duvall , t. l. jr . , 1997 , in f. pijpers , j. christensen dalsgaard and c. s. rosenthal ( eds . ) , solar convection and oscillations and their relationship , proceedings of score96 workshop , pp 241 - 260 , kluwer , dordrecht ."
  ],
  "abstract_text": [
    "<S> correct interpretation of acoustic travel times measured by time - distance helioseismology is essential to get an accurate understanding of the solar properties that are inferred from them . </S>",
    "<S> it has long been observed that sunspots suppress @xmath0-mode amplitude , but its implications on travel times has not been fully investigated so far . </S>",
    "<S> it has been found in test measurements using a masking procedure , in which the solar doppler signal in a localized quiet region of the sun is artificially suppressed by a spatial function , and using numerical simulations that the amplitude modulations in combination with the phase - speed filtering may cause systematic shifts of acoustic travel times . to understand the properties of this procedure </S>",
    "<S> , we derive an analytical expression for the cross - covariance of a signal that has been modulated locally by a spatial function that has azimuthal symmetry , and then filtered by a phase speed filter typically used in time - distance helioseismology . comparing this expression to the gabor wavelet fitting formula without this effect , we find that there is a shift in the travel times , that is introduced by the amplitude modulation . </S>",
    "<S> the analytical model presented in this paper can be useful also for interpretation of travel time measurements for non - uniform distribution of oscillation amplitude due to observational effects . </S>"
  ]
}