{
  "article_text": [
    "the complexities of quantum optics , with its multiple integrals over frequency and wave vectors , tempt one to simplify , and indeed the groundbreaking equations that launched quantum key distribution ( qkd ) were simplified rather drastically , often leaving out altogether the frequency spectrum of the light involved .",
    "while on one hand the qkd equations have involved simplifications , on the other hand they invoke concepts of quantum decision theory , little used in quantum optics , such as trace distances between density operators as a measure of their distinguishability .",
    "the motivation for putting the complications of frequency spectra back into the equations by which we model the faint light used in qkd comes from recognizing that both in implementing qkd systems and in designing eavesdropping attacks against them , frequency spectra play a crucial role .",
    "this report adapts quantum optics to deal as directly as possible with pulses of weak light propagating though optical fibers .",
    "the equations introduced here to model faint light give expression to frequency spectra , including frequency - entanglement ; they also define and show examples of relevant partial traces of density operators for entangled , frequency - dependent light , needed to make use of an exceedingly useful relation between entangled - state qkd and qkd implemented without entanglement .",
    "the report grew from notes on techniques , some borrowed , others developed from scratch , needed to model a version of bb84 that uses polarization - entangled light .",
    "polarization - entangled light from available sources is also frequency - entangled , and the driving question was how this frequency entanglement modulates the dependence of polarization - entangled qkd detection probabilities on mean photon number .",
    "some subsequent papers dealing with frequency effects in polarization - entangled qkd , such as ref .",
    "@xcite , use the techniques and results of this report , and , in particular use certain convolution integrals that are described in sec .",
    "[ sec:10 ] and investigated in detail in appendix  [ app : c ] , with accompanying matlab programs given in appendix  [ app : f ] .      by definition ,",
    "quantum modeling invokes equations constrained in form to those of quantum mechanics , expressing a joint probability distribution of ( theoretical ) outcomes in terms of an initial density operator @xmath1 at time @xmath2 , a hamiltonian evolution operator @xmath3 , and a resolution of the identity consisting of a set of non - negative operators @xmath4 satisfying @xmath5 .",
    "these engender a probability of a ( theoretical ) outcome @xmath6 @xcite : @xmath7 .",
    "\\label{eq : form}\\ ] ] whether or not one makes it explicit , at @xmath1 , @xmath3 , and @xmath4 are functions of parameters that one views as under experimental control ; all that a model can say is said in terms of how the probabilities depend , via @xmath1 , @xmath3 , and @xmath4 , on these parameters .",
    "a system of equations for modeling particular devices includes equations that specify properties of the @xmath3 , @xmath1 , and @xmath4 , thus specializing the probability distribution @xmath8 .",
    "the outcome @xmath6 can be a list of components , _",
    "e.g. _  one component for each of several detectors , in which case @xmath8 is viewed as a joint probability for the components of the outcome .    in choosing quantum equations to model experiments with light",
    ", one expresses light by one or another density operator @xmath1 , and one expresses detecting devices by operators @xmath4 , possibly augmented by probe particles , as discussed in @xcite .",
    "as is well known , the boundary between preparation of light and its detection is chosen by the modeler , and can be pushed around @xcite .",
    "different choices of @xmath1 , @xmath3 , or @xmath4 set up different quantum models . implicitly or explicitly , @xmath1 is a function of variables that express the setting of various knobs on the laser and/or other devices that generate the light , and @xmath4 is a function of variables that express knob settings on the detectors , such as those that control polarizing filters . to claim that a set of equations of quantum mechanics describes an arrangement of devices is to claim that the probabilities calculated from the equations more or less fit relative frequencies of experimental outcomes obtained , for some range of knob settings , from the arrangement of devices .",
    "as discussed in @xcite , choosing equations to model an experiment takes guesswork , indeed , two layers of guesswork . from experiments with devices and a first layer of guesswork @xcite , one abstracts experimental relative frequencies that can be compared with modeled probabilities .",
    "demanding an approximate fit to experimental relative frequencies puts a constraint on probabilities of outcomes as functions of knob settings , and hence establishes a property of states and operators that can be judged as fitting an experimental situation .",
    "still , diverse systems of equations can always be found to agree with any given set of experimental relative frequencies and yet disagree among themselves in probabilities that they generate for arrangements of devices not yet explored .",
    "for this reason , arriving at equations of quantum mechanics by which to describe the measured behavior of qkd devices requires reaching beyond logic to make what may as well be called a guess . for this reason ,",
    "the sensible use of equations in modeling qkd is hardly to ` prove security ' but instead to help in achieving transmission of keys in the face of practical obstacles and to design eavesdropping attacks .    by recognizing an irreducible freedom in choosing systems of equations to describe an arrangement of devices",
    ", we can clarify the mathematics of modeling , unencumbered by physical interpretations that are always subject to choice . besides helping with qkd",
    ", the techniques of modeling presented here can also serve other uses of faint light that generate interesting joint detection statistics expressible in quantum mechanics but unknown to classical physics , correlations that allow the invention of new kinds of `` cameras '' with which to see and respond to the physical world .",
    "picture an experimental network involving light sources and detectors linked by fibers as shown in fig .",
    "[ fig:1 ] , where the blob in the middle can include phase shifters , fiber couplers , and attenuators , as well as conversions from fiber to free space and back again to fiber .",
    "mainly i discuss so - called single - mode fibers ; ( most of these actually support two polarizations ) .",
    "the various fibers of a network need not be alike ; for instance they can vary in their propagation constants and in their attenuation .",
    "although most of the discussion is in terms of fiber , free - space links can also be included .",
    "the mathematical framework offered allows modeling the variety of responses encountered experimentally in light detection @xcite ; in particular , the response to single - photon states need not be binary .",
    "the aim in developing this framework for the analysis of optical networks is this :    1 .   provide equations to express violations of bell inequalities .",
    "2 .   provide for modeling networks assembled from smaller pieces , like tinker toys , by splicing fibers of one to fibers of another .",
    "3 .   provide for convenient expression of pieces of networks that are free of frequency conversion but that have diverse fibers with diverse propagation constants at any single frequency .",
    "i.e provide mathematics convenient for expressing single - frequency modes for networks ( or parts of networks ) containing fibers that differ in their propagation constants .",
    "we split up the task of modeling a quantum network into the following modules :    1 .",
    "develop mathematics for the quantum mechanics of a set of uncoupled , lossless transmission lines , each line expressed by a set of modes , where each mode supports a range of frequencies propagating in two directions , denoted `` @xmath9 '' and `` @xmath10 ''",
    "corresponding to each mode , introduce a creation operator , and define single - mode quantum states as the vacuum state acted on by superpositions of these operators over some frequency band .",
    "2 .   extend to many modes .",
    "3 .   define projection operators , each of which corresponds to a subspace of @xmath11 photon states on a hilbert space that is a tensor product of some number of modes",
    "use lattice of projections to define subspaces .",
    "4 .   define detection operators on such states .",
    "perform calculations by use of commutation relations .",
    "use scattering theory to approximate interacting transmission lines by operators that convert an in - state on non - interacting lines to an out - state on non - interacting lines .",
    "( see fig .",
    "[ fig:1 ] . )",
    "model loss and dispersion by introducing coupling of desired modes to extraneous modes , as illustrated in fig .",
    "[ fig:2 ] .",
    "4 .   model frequency preserving interactions among transmission lines by unitary transformations acting on creation operators for all desired and extraneous modes .",
    "sketch two applications to a network for quantum key distribution , in which these concepts and techniques work together .",
    "in analogy with classical electromagnetics , we will model a path , such as an optical fiber , as a system of modes , with each mode supporting a continuous range of frequencies .",
    "we assume a vacuum state @xmath12 , normalized so that @xmath13 other states are defined by various creation operators acting on the vacuum state .",
    "these in turn are defined in terms of more singular single - frequency creation operators , as follows . for modes",
    "@xmath14 , @xmath15 , ",
    ", one could introduce annihilation operators @xmath16 , @xmath17 ,  ; however we avoid the clutter of the `` hats , '' so that , for example , @xmath15 expresses a mode name in some contexts but in other contexts expresses an annihilation operator for that mode .",
    "each mode is bi - directional ; we call one direction `` @xmath9 '' and the other `` @xmath10 '' . let @xmath18 be the creation operator for excitation at an angular frequency @xmath19 in the `` @xmath9 '' direction , and let @xmath20 be the creation operator for propagation in the `` @xmath10 '' direction .",
    "the operators @xmath21 and @xmath22 are defined for non - negative @xmath19 .",
    "it is often convenient to combine the `` @xmath9 '' and `` @xmath10 '' operators into a single operator .",
    "since these are both defined for @xmath23 , we can define @xmath24 for @xmath25 by @xmath26    for any given mode , a single - photon state is any state of the form @xmath27 where the creation operator @xmath28 is defined by @xmath29 and @xmath30 is any square - integrable complex - valued function of @xmath19 , normalized so that @xmath31 where in this and the following integrals , the integration limits are @xmath32 and @xmath33 unless otherwise specified ; the role of negative frequencies will be discussed shortly . for the given mode",
    ", @xmath34 is the creation operator for excitation at an angular frequency @xmath19 .",
    "it is the adjoint of an annihilation operator @xmath24 , and the commutation relation between the two is @xmath35 &   = &   \\delta(\\omega - \\omega ' ) , \\label{eq : comm0 }   \\\\ { } [ a(\\omega ) , a(\\omega ' ) ] & = & 0 .",
    "\\label{eq : comm1}\\end{aligned}\\ ] ] this relation is a simplification appropriate to fiber modes of the commutation relation in @xcite . the annihilation operator is required to satisfy the rule @xmath36 which from the adjoint of eq .",
    "( [ eq : afdef ] ) implies that @xmath37 from eq .",
    "( [ eq : comm0 ] ) follows the commutation rule for any functions @xmath30 and @xmath38 : @xmath39 & = & \\int\\!\\ !",
    "\\int d\\omega\\ ,    d\\omega'\\ ,   g^*(\\omega)f(\\omega')[a(\\omega),a^\\dag(\\omega')]\\nonumber\\\\ & = & \\int\\!\\ ! \\int d\\omega\\ , d\\omega'\\ , g^*(\\omega)f(\\omega')\\delta(\\omega - \\omega ' ) \\nonumber \\\\ & = & \\int d\\omega\\ , g^*(\\omega)f(\\omega ) , \\label{eq : commf}\\end{aligned}\\ ] ] where the asterisk denotes the complex conjugate .",
    "this can be written more compactly as @xmath40 = ( g , f ) , \\label{eq : commabr}\\ ] ] where we define the inner product of functions @xmath41 from this with normalized functions @xmath42 , it follows that @xmath43 by eq .",
    "( [ eq : normf ] ) , and we see that @xmath28 and @xmath44 are boson creation and annihilation operators satisfying @xmath45=1 $ ] . as a result , we can calculate the norm of a single - photon state @xmath46 to be @xmath47^{1/2 }   = \\langle 0|0\\rangle^{1/2 } = 1,\\end{aligned}\\ ] ] where the next - to - last equality follows from eq .",
    "( [ eq : kill ] ) . for probabilities to make sense",
    ", we must require a finite inner product on quantum states , which requires normalizable states .",
    "this makes some bandwidth necessary : there can be no normalizable states at a single frequency . because @xmath48 has no norm , we call @xmath34 an _ improper _ operator",
    ".    the hamiltonian operator for the mode ( without zero - point energy ) is @xmath49    example 1 : the expectation energy of a single - photon state @xmath50 defined by the energy operator of eq.([eq : energy1 ] ) is : @xmath51 where the second equality is obtained using eq.([eq : comm0 ] ) and integrating out the @xmath52-functions .",
    "thus if @xmath53 is concentrated around some @xmath54 , one finds by this prescription a photon energy of about @xmath55 ) .",
    "for instance , for a pure state , the right - hand side of eq .",
    "( [ eq : form ] ) takes the form @xmath56 where @xmath57 is a polynomial in creation and annihilation operators subject to @xmath52-function commutation relations , and every annihilation operator acting from the left on the vacuum state @xmath12 gives 0 , as does every creation operator acting on the right of @xmath58 .",
    "the standard method of evaluating such a probability is to use the commutation relations to put @xmath57 in normal order . in the cases of interest ,",
    "every power of every creation operator is paired with the same power of the corresponding annihilation operator , so that the only terms that contribute after the commutations have the form @xmath59 where @xmath60 is a sum of products of @xmath52-functions , and the equality follows from eq .",
    "( [ eq : norm0 ] ) .",
    "two modes @xmath14 and @xmath15 are called orthogonal if and only if .",
    "superpositions of single - photon states across orthogonal modes @xmath14 and @xmath15 have the form @xmath61 where @xmath62 .      to construct the most general single - mode @xmath11-photon states , we introduce notation for multi - photon operators in which there are as many frequency variables as there are operator factors : @xmath63 because the creation operators commute with one another , all that matters about @xmath64 is the part of it symmetric under interchange of arguments , denoted @xmath65 where @xmath66 denotes the permutation group of order @xmath11 .",
    "thus we have @xmath67    the normalization condition @xmath68 assures unit norm for the single - mode @xmath11-photon state @xmath69 the adjoint works according to @xmath70      consider two modes that need not be orthogonal , such as two linearly polarized modes @xmath14 and @xmath15 with an angle @xmath71 between them , so the commutation relation between them is @xmath72 = \\cos \\theta\\,\\delta(\\omega-\\omega')$ ] . for symmetric functions @xmath64 of @xmath11 arguments and @xmath73 of @xmath74 arguments ,",
    "the usual manipulations show that @xmath75 where we define the inner product of the multi - variable functions @xmath64 and @xmath73 as @xmath76 thus for @xmath77 and @xmath64 normalized per eq .",
    "( [ eq : nnorm ] ) , the inner product of the two @xmath11-photon states is just @xmath78 .",
    "for @xmath64 normalized per eq .",
    "( [ eq : nnorm ] ) and the energy operator @xmath3 of eq .",
    "( [ eq : energy1 ] ) , the expectation energy for the state @xmath79 is @xmath80 where we define an average angular frequency @xmath81      as a special case of a two - photon state , one can choose any normalized function @xmath30 and define @xmath82 to produce a two - photon state @xmath83 .",
    "this immediately generalizes to higher powers of @xmath28 , leading to a ` broad - band ' coherent state . from eq.([eq : commf ] ) we see that @xmath28 and @xmath44 are boson creation and annihilation operators satisfying @xmath45=1 $ ] , so that louisell s discussion of coherent states [ , sec .  3.2",
    "] applies to them .",
    "hence we can define @xmath11-photon @xmath30-states by powers of @xmath28 acting on the vacuum state @xmath11 times , producing the normalized state @xmath84 .",
    "coherent @xmath30-states can be defined as superpositions of these states , just as in louisell [ , p.  104",
    "] : @xmath85 this is an example of a calculation that proceeds exactly as if frequency dependence were collapsed , so that @xmath44 works like a simple oscillator annihilation operator .",
    "in contrast , frequency dependence matters in the commutation rule @xmath86 = \\int d\\omega\\ ,      g^*(\\omega)f(\\omega),\\ ] ] which follows from eqs .",
    "( [ eq : comm0 ] ) and ( [ eq : comm1 ] ) .    to calculate the energy of the coherent state , note first that the commutation rules eqs .",
    "( [ eq : comm0 ] ) and ( [ eq : comm1 ] ) imply for the coherent state defined by eq .",
    "( [ eq : coh ] ) @xmath87 from this and eqs .",
    "( [ eq : energy1 ] ) and ( [ eq : normf ] ) follows the expectation energy @xmath88 where we have defined a mean absolute angular frequency @xmath89      the general state is a sum of terms , not necessarily normalized , each of the form @xmath90 symmetries under interchange of variables are best expressed in a notation intermediate between that of writing out the integrals and the compact `` colon '' notation .",
    "we expand the shorthand @xmath91 to @xmath92 , understanding that with an exponent @xmath11 involved , @xmath93 is short for a list of @xmath11 frequency variables and @xmath94 is short for @xmath95 . written in this notation , eq .  ( [ eq : formterm ] ) becomes @xmath96 where @xmath97 is a list of @xmath98 frequency variables .",
    "symmetry under interchange of creation operators implies , as in eq .",
    "( [ eq : sym1 ] ) , @xmath99\\!:\\!a^{\\dag    n}(\\bm{\\omega}),\\ ] ] where the symmetry operator @xmath100 is defined in eq.([eq : sdef ] ) ; this generalizes to @xmath101\\!:\\!\\prod_{j=1}^ja_j^{\\dag    n_j}(\\bm{\\omega}_j)|0\\rangle.\\ ] ] sometimes we write such expressions a little more compactly , using the convention that @xmath102 as @xmath103\\!:\\!\\prod_{j=1}^ja_j^{\\dag    n_j}(\\bm{\\omega}_j)|0\\rangle.\\ ] ] we can distinguish one set of modes from another by replacing some of the @xmath104 by other labels , such as @xmath105 .",
    "for example , @xmath14-modes can refer to alice while @xmath15-modes refer to bob .",
    "this leads to a general term in a state expansion of the form @xmath106      a density matrix is a sum @xmath107 where the @xmath108 are unit vectors , @xmath109 , and @xmath110 ; or an integral @xmath111 with the @xmath112 unit vectors , @xmath113 and @xmath114 .",
    "more generally , a density matrix can be any convex sum of these discrete and continuous types .",
    "we need the trace of a density operator multiplied by a bounded operator @xmath115 .",
    "although in the context of infinite - dimensional spaces the trace is sometimes defined only for positive operators @xcite , we want to apply a trace to terms that occur when a pure - state density operator is expanded ( i.e. , @xmath116 . for this",
    "we define @xmath117 = \\langle\\phi|m|\\psi\\rangle,\\ ] ] and define more general traces by linearity .",
    "we then find @xmath118      probabilities for detection of light states often involve _ partial traces _ , defined for an operator on a tensor - product space @xmath119 by linearity from the following special case . for @xmath120 and @xmath121 , @xmath122 from this",
    "it follows that for any bounded operator @xmath123 that acts only on @xmath124 , we have @xmath125 = ( \\langle a'|m_a|a\\rangle)|b\\rangle\\langle b'| .",
    "\\label{eq : aop}\\ ] ] here is an example .",
    "if a detection operator is of the form @xmath126 , then @xmath127   = \\mbox{tr}_a(\\rho ' m_{a , j}),\\ ] ] @xmath128 the partial trace over @xmath15-modes of any light state @xmath1 is calculated from the commutation relations applied to the inner product of @xmath15-mode factors in the usual way , supported by the notation developed in the preceding subsection . for example , one can deal with the case of a single @xmath14-mode and a single @xmath15-mode as follows .",
    "suppose we have @xmath129 where we abbreviate @xmath130 , @xmath131 , @xmath132 , etc .",
    "similarly , suppose @xmath133 then , for an operator @xmath134 that commutes with @xmath135 and @xmath136 , @xmath137 = \\mbox{tr}_a[\\rho'm_j(a)],\\vadjust{\\kern-6pt}\\ ] ] where @xmath138a^{\\dag m}(\\bm{\\omega})|0_a\\rangle \\langle0_a|a^{m'}(\\bm{\\omega } ' ) \\nonumber \\\\ & = & n !",
    "d\\bm{\\omega } d\\bm{\\omega } ' \\left[\\int\\!\\ !",
    "d\\tilde{\\bm{\\omega}}\\,g(\\bm{\\omega},\\tilde{\\bm{\\omega } } ) \\mathcal{s}(\\tilde{\\bm{\\omega}})h^*(\\bm{\\omega } ' , \\tilde{\\bm{\\omega}})\\right]a^{\\dag m}(\\bm{\\omega})|0\\rangle \\langle0|a^{m'}(\\bm{\\omega}'),\\end{aligned}\\ ] ] where the second equality follows from lemma ( b16 ) of appendix  [ app : b ] applied to the @xmath15-modes .",
    "similarly , one calculates for the trace over the @xmath14-modes @xmath139b^{\\dag n}(\\tilde{\\bm{\\omega}})|0_b\\rangle \\langle0_b|b^{n'}(\\tilde{\\bm{\\omega } } ' ) \\nonumber \\\\ & = & m !",
    "! d\\tilde{\\bm{\\omega } } d\\tilde{\\bm{\\omega } } ' \\left[\\int\\!\\ !",
    "d\\bm{\\omega}g(\\bm{\\omega},\\tilde{\\bm{\\omega } } ) \\mathcal{s}(\\bm{\\omega})h^*(\\bm{\\omega } , \\tilde{\\bm{\\omega}}')\\right]b^{\\dag n}(\\tilde{\\bm{\\omega}})|0\\rangle \\langle0|b^{n'}(\\tilde{\\bm{\\omega}}').\\end{aligned}\\ ] ]    the more general case involves complications , but here it is .",
    "let @xmath140 and @xmath141 and similarly for primed quantities ; let @xmath142 on expanding the ` colon ' notation and abbreviating using @xmath143 for @xmath144 and @xmath145 for @xmath146 , one finds @xmath147 [ the last equation follows from lemma ( b15 ) of appendix  [ app : b ] .",
    "] because the @xmath15-creation operators commute among themselves , as do the @xmath15-annihilation operators , there is one more symmetry : @xmath148\\right .",
    "\\nonumber \\\\ & & \\times\\left.\\!\\ !",
    "\\left[\\left(\\prod_{k=1}^{k'}\\mathcal{s}(\\tilde{\\bm{\\omega}}'_k)\\!\\right ) \\!\\left(\\prod_{j=1}^j\\mathcal{s}(\\bm{\\omega}_j)\\!\\right ) h^{\\prime * } ( \\bm{\\omega}_{n},\\tilde{\\bm{\\omega}}'_{m ' } ) \\right]\\right\\ } \\!\\left(\\prod_{k=1}^kb_k^{\\dag m_k}(\\tilde{\\bm{\\omega}}_k)\\!\\right)|0_b\\rangle \\langle 0_b|\\left(\\prod_{k=1}^{k ' } b_k^{m'_k}(\\tilde{\\bm{\\omega}}'_k)\\!\\right)\\!.\\ \\nonumber\\\\\\end{aligned}\\ ] ]      for a state that exhibits a single photon in each of two orthogonal modes , @xmath14 and @xmath15 , whether in a single fiber or in different fibers , the general form is @xmath149 where we extend our notation by defining @xmath150 with the normalization requirement that @xmath151 note : the normalization requirement rules out @xmath152 of the form @xmath153 .",
    "other states , including multi - mode , multi - photon states will be introduced after we have the machinery of projections .",
    "to deal efficiently with polarization - entangled states , we need to characterize subspaces of states by the projections that leave them invariant .",
    "these are provided here .",
    "it is instructive to compare and contrast the projections for the function space of states used here with the case of a single oscillator with its basis states @xmath154 , @xmath155 , 1 ,   @xcite . with our range of frequencies",
    "there are countless 1-photon states ( and countless @xmath11-photon states ) , as described in sec .",
    "[ subsec:2b ] , in contrast to the single @xmath11-photon state @xmath154 for given @xmath11 of an oscillator ; however , there is a one - to - one correspondence between a set of projection operators for photon number and the projections @xmath156 for the oscillator .    for both the single oscillator and the states that are characterized by functions of frequency",
    ", one writes @xmath157 for the vacuum projector . to the oscillator projection @xmath158",
    "corresponds the projection that leaves invariant single - photon states while killing all states of more or fewer photons : @xmath159 it is easy to check that for any @xmath30 one gets @xmath160 , and that for any of the @xmath11-photon states @xmath161 with @xmath162 , one finds @xmath163 .",
    "similarly the projection for two - photon states is @xmath164 the general case is @xmath165 it follows that any state in the space of superpositions over all @xmath11 is unchanged by the operator obtained by summing over all @xmath166 , and hence this sum is the unit operator @xmath167 equation ( [ eq : pndef ] ) implies a relation among the projections for adjacent values of @xmath11 @xmath168 although this mirrors the situation for a single oscillator , the projections @xmath166 _ can not _ be expressed as the outer product of a vector with its adjoint ; indeed the @xmath11-photon subspaces are infinite dimensional .    from the commutation eqs .",
    "( [ eq : comm0 ] ) and ( [ eq : comm1 ] ) it follows that @xmath169 furthermore , this holds if one inserts into both sides of the product the same polynomial in operators for modes orthogonal to @xmath14 . also from eq .",
    "( [ eq : projn ] ) follows the relation @xmath170      in the context of two orthogonal modes @xmath14 and @xmath15 , the symbol @xmath166 is re - used as shorthand for @xmath171 , where @xmath172 is the unit operator on the @xmath15-factor of a tensor product .",
    "two projections for differing values of @xmath11 for a given mode are mutually orthogonal , but not when one projection is for one mode and the other projection for another ; _",
    "e.g. _ @xmath173 but @xmath174 .",
    "similar remarks apply to the case of more than two mutually orthogonal modes .      to study polarization",
    "we will need the idea of an @xmath11-photon state that can be distributed over two modes .",
    "we denote the projector for @xmath11 photons distributed arbitrarily among modes @xmath176 and @xmath177 by @xmath178    * note * : all these projectors can be subdivided into `` @xmath9 '' and `` @xmath10 '' parts , _",
    "@xmath179      similarly to the single oscillator case , one constructs an operator that has as its expectation value for a given state the mean photon number for that state .",
    "this is the number operator for the mode under discussion : @xmath180 by use of eqs.([eq : pn1 ] ) and ( [ eq : unit ] ) , this is transformed into the more convenient form : @xmath181 it is also useful to express the number operator for the `` @xmath9 '' and `` @xmath10 '' directions : @xmath182    for a space ( or subspace ) spanned by two modes @xmath176 and @xmath177 , define @xmath183 as sketched in lemma ( [ eq : b7 ] ) of appendix  [ app : b ] , a calculation similar to that for one mode shows @xmath184 .",
    "\\label{eq : n2def}\\ ] ] here again , we can pick out directions , as in eq .",
    "( [ eq : ndir ] ) .",
    "there is no difficulty in extending to more than two modes .",
    "we partition the modes to be analyzed into `` desired modes '' and `` extraneous modes , '' as illustrated in fig .",
    "[ fig:2 ] . by considering coupling of desired modes to extraneous loss modes",
    ", one can model a wide variety of loss mechanisms .",
    "the choice of model for loss is tied to the choice of model of detection .    to model loss of a mode to be detected by a binary detector , neglecting memory effects in the detector , for now we succumb to the charm of simplicity in the approach of mandel [ , p.  640 ] . in this approach a mode @xmath185 prior to loss is related to a mode @xmath15 after loss by the following equation for the respective annihilation operators : @xmath186 where @xmath187 expresses an undetected mode into which all the @xmath185-energy spills except for a fraction . in the case where @xmath188 is independent of frequency , this un - lost fraction is just @xmath189 .    an alternative is to consider the coupling of desired modes to a heat bath .",
    "this leads to so - called master equations .",
    "the simplest form that expresses the essential features makes the markhoff approximation [ , p.  347",
    "( 6.2.61 ) ] . with further simplifications , including that of a zero - temperature heat bath , we obtain the time behavior of a density operator that at time @xmath190 expresses the state @xmath46 to be , in the schrdinger picture ( sp ) , a density operator of the form=-1 @xmath191 t\\ } \\,f(\\omega)f^*(\\omega')e^{i(\\omega - \\omega')t}a^\\dag(\\omega)|0\\rangle \\langle 0|a(\\omega ' ) \\nonumber",
    "\\\\ & & { } + \\left(1-\\int d\\omega \\,\\exp\\{-[\\gamma(\\omega)+\\gamma(\\omega ' ) ] t\\}\\ , |f(\\omega)|^2\\right)|0\\rangle \\langle 0| .",
    "\\label{eq : diss}\\end{aligned}\\ ] ]    [ need to work this out for multi - photon states . ]",
    "i believe ( and need to check ) that coupling of desired modes to thermal modes can not make two states more distinguishable . more formally ,",
    "suppose the desired modes are @xmath192 and the extraneous modes are @xmath193 , and the in - state is expressed by either some tensor product @xmath194 or by @xmath195 . after a unitary evolution @xmath196 acting on the tensor - product space of @xmath192 and @xmath193 , the out - state is @xmath197 , with @xmath198 or  2 .",
    "the reduced density matrix for @xmath192 is obtained by the partial trace over @xmath193 : @xmath199 ( note that , unlike traces , partial traces of a product depend on the order of the factors . )",
    "my guess is that in all cases @xmath200    for this it is necessary and sufficient to prove for all density operators @xmath201 and @xmath202 acting on the tensor - product space of @xmath192 and @xmath193",
    "that @xmath203 \\ge \\mbox{tr}(\\rho_1^{1/2}\\rho_2^{1/2}).\\ ] ]",
    "improper operators introduced so far have been integrated over frequency to produce proper operators .",
    "we want also to construct proper operators by integrating over space and/or time , which leads us to take fourier transforms , as outlined in appendix  [ app : d ] .",
    "in analogy with quantum electrodynamics for propagation in vacuum , we introduce ( improper ) local annihilation field operators in the heisenberg picture : @xmath204 } , \\nonumber \\\\",
    "a_-(x , t ) & = & \\frac{1}{\\sqrt{2\\pi}}\\int_0^\\infty d\\omega\\ , a_-(\\omega)e^{-i[\\omega t+ k(\\omega)x ] } ,   \\label{eq : loca}\\end{aligned}\\ ] ] where @xmath205 is an experimentally determined propagation factor , defined so that @xmath206 .",
    "we assume @xmath207 @xmath208 @xmath209    \\4 .",
    "kramers - kronig relations connect this @xmath205 to the loss coefficient @xmath210 of eq .",
    "( [ eq : diss ] ) @xcite.=1    the operator @xmath211 is ` improper ' in that it takes a normalized state to an unnormalizable state ; a proper operator can be defined by averaging @xmath211 over a spacetime region .",
    "( this averaging takes place automatically in time - dependent perturbation theory [ , p.  257 ] . )",
    "drawing on eq .",
    "( [ eq : adef ] ) , we can define @xmath212},\\end{aligned}\\ ] ] and from eqs .",
    "( [ eq : loca ] ) and ( [ eq : comm0 ] ) follows the commutation relation @xmath213 = \\frac{1}{\\sqrt{2\\pi}}\\exp\\{-i[|\\omega| t -k(\\omega)x]\\}.\\ ] ]      from the non - hermitian operator @xmath214 can be constructed the two non - commuting hermitian quadrature operators @xmath215 } + a(\\omega ) e^{-i [ |\\omega| t- k(\\omega)x]}\\ } , \\\\",
    "p(x , t ) & \\defeq   & i[a^\\dag(x , t ) - a(x , t ) ] \\nonumber \\\\ & = & \\frac{i}{\\sqrt{2\\pi}}\\int_{-\\infty}^\\infty d\\omega\\ ,   \\{a^\\dag(\\omega ) e^{i [ |\\omega| t- k(\\omega)x ] } - a(\\omega ) e^{-i [ |\\omega| t- k(\\omega)x]}\\}. \\end{aligned}\\ ] ] note @xmath216 is like louisell s voltage operator .",
    "fourier - transforms show @xmath217 this will be used in constructing operators to model detection .      because the variation of @xmath205 with @xmath19 is non - linear , the operator that is convenient for space localization must differ from that which is convenient for time localization .",
    "consider operators such as the hamiltonian and the number operator ( shortly to be introduced ) of the form @xmath218 . in the case of the number operator defined as @xmath219 ,",
    "the local operator @xmath220 acts as a kind of density in time for @xmath221 ; however , the space integral of @xmath220 is something else:=-1 @xmath222,\\ ] ] which , with the relation @xmath223 =      \\left|\\frac{dk(\\omega)}{d\\omega}\\right|^{-1 } \\delta(\\omega - \\omega'),\\ ] ] becomes @xmath224 note that the `` extra factor '' @xmath225 expresses a group velocity @xcite .    with this in mind",
    ", we construct an energy density operator @xmath226 by @xmath227}.\\ ] ] one can check that this has the property @xmath228 there are lots of other possibilities .",
    "for instance , define a field @xmath229};\\ ] ] then @xmath230 so that the two distinct fields @xmath14 and @xmath231 both enter .    in order to deal with finite fibers ,",
    "we explore the operator obtained by making the limits of integration over @xmath232 finite ; however , the resulting integral is no longer independent of @xmath233 .",
    "further , while the integral obtained from putting finite @xmath232-limits in ( [ eq : h1 ] ) is at least hermitian , even this modest property fails for the integral obtained by putting finite @xmath232-limits in ( [ eq : h2 ] ) .",
    "nonetheless , in some cases such a truncated operator can be a useful approximation to the hamiltonian",
    ".      it will be interesting to examine approximations to projections in terms of operators that are , so to speak , confined in time and space . for reference , here we express some projections in terms of local operators . from eq .",
    "( [ eq : p1 ] ) and the inverse fourier transform in time of eq .",
    "( [ eq : loca ] ) , one computes @xmath234 ( independent of @xmath232 ) . similarly , from eq .",
    "( [ eq : p2 ] ) one computes @xmath235 and one can keep on going .",
    "this procedure also works to express the number operator of eq .",
    "( [ eq : number ] ) in terms of local operators : @xmath236",
    "couplers and other networks can be analyzed in terms of a scattering matrix .",
    "for this , one supposes that there is time @xmath237 before which the network acts as a set of uncoupled fibers and perhaps a quantum memory uncoupled to these fibers ; one supposes a later time @xmath238 after which the interaction is over , so that again one has a set of uncoupled fibers and a quantum memory in isolation .",
    "prior to @xmath237 , the light is modeled by an in - state as an integral over frequency of a polynomial in in - mode creation operators acting on the vacuum . for time",
    "@xmath239 the light is modeled by an out - state , again as an integral over frequency of a polynomial in out - mode creation operators acting on the vacuum .",
    "for example , to analyze a coupler , we typically express state preparation in terms of in - state creation operators while we express detection in terms of out - state creation operators . hence calculating the probability of an outcome",
    "calls for expressing in - state operators in terms of out - state operators , or vice - versa , according to whichever is more convenient .",
    "the use of scattering theory in this context is to relate the creation operators for in - state modes to creation operators for out - state modes , and this relation is constrained to be a unitary transformation . because of unitarity , commutation relations are preserved and so are inner products .",
    "a complication is that unitarity holds only for a transform over all the modes involved , `` extraneous '' as well as `` desired . ''    in general the creation operator for an out - mode at one frequency depends on creation operators for in - modes at all frequencies ; i.e. , the operator mixes frequencies , as in parametric down conversion . for linear networks we get the major simplification that out - mode operators for a given frequency @xmath19 are unitary transforms of in - mode operators for the same frequency .    after a scattering transformation",
    "is obtained , either by guessing or by calculating it from some more detailed model , one can check whether the in - states and out - states are consistent with particular values of @xmath237 and @xmath238 .",
    "( for a network with strong internal reflections , the interval @xmath240 must be large enough to allow reverberations to die out . )      for the special case of a network that is linear in that it mixes no frequencies , if the extraneous modes are accounted for , then the out - state annihilation operators @xmath241 , @xmath198 , 2 ,  , are some unitary transform of the in - state annihilation operators .",
    "that is , let @xmath242,\\ ] ] and similarly define @xmath243 .",
    "then there is some frequency - dependent , unitary matrix @xmath244 , having dimension equal to the number of out - modes ( by assumption equal to the number of in - modes ) , such that @xmath245 taking hermitian conjugates and multiplying the result by @xmath244 on the right gives a relation between the row vectors @xmath246 and @xmath247 : @xmath248    to understand the application of scattering formalism to modeling fiber interactions illustrated in fig .",
    "[ fig:1 ] , first model light pulses as quantum states expressed by creation operators acting on vacuum .",
    "we think of an interaction that , to some approximation , starts at @xmath237 or later and is complete by @xmath238 or earlier . prior to @xmath237",
    ", the incoming light is modeled as involving only in - state creation operators .",
    "after @xmath238 , the light is modeled as a different state , involving only out - state creation operators , related to the in - state creation operators by an equation of the form ( [ eq : scattdag ] ) .",
    "it is possible to make a fiber , for instance with an elliptical cross section , that propagates only a single mode ; however , the fibers used in the quantum network all carry two polarization modes .",
    "we follow convention by misnaming fibers , so that when we say a ` single - mode ' fiber we mean a fiber that propagates not a single spatial mode @xmath14 but one that propagates two polarized modes @xmath176 and @xmath177 , mutually orthogonal in that the @xmath249 = 0 $ ] , with propagation constants @xmath250 and @xmath251 , respectively .",
    "this means that for a network ( as in fig .",
    "[ fig:1 ] ) with @xmath11 ` single - mode ' fibers there are @xmath252 in - modes and @xmath252 out - modes , so that , neglecting extraneous modes , the single - frequency scattering matrix @xmath244 has dimension @xmath252 .",
    "( for special materials , one may need to separate out the two directions to allow @xmath253 . )",
    "note that a linear superposition of the two modes with different propagation constants has no definable propagation constant .",
    "in describing modeling approaches for fibers that support two polarizations we make ( and try to state ) various simplifying assumptions ; throughout we assume frequency conservation .",
    "taking polarization into account doubles the number of modes relative to the number of so - called single - mode fibers , for the simple reason that these are misnamed .    for a polarized fiber having orthogonal modes @xmath176 and @xmath177 , the form of a single - photon state is [ see eq .",
    "( [ eq : mulmode ] ) ] : @xmath254 for any normalized @xmath30 and @xmath38 , assuming numerical constants @xmath255 .",
    "the same operator generates the coherent state of the form of eq .",
    "( [ eq : coh ] ) : @xmath256 where the second equation follows from @xmath257 = \\exp(c_1 a_{1,f}^\\dag)\\exp(c_2 a_{2,g})^\\dag$ ] , which is a consequence of the commutativity @xmath258 = 0 $ ] .    [ * * the whole business seems to assume a reference position @xmath259 ; other values of @xmath232 involve @xmath232-dependent phase factors . ]",
    "consider the situation shown in fig .",
    "[ fig:3 ] , where a fiber @xmath14 on the left is spliced to a fiber @xmath15 on the right .",
    "we suppose the splice is centered at @xmath260 .",
    "for such a heterogeneous spliced fiber , the local field operator @xmath214 can not satisfy a field equation that exhibits translational symmetry ; instead , the field equation stems from a hamiltonian that has a change at the splice ; the situation is reminiscent of a potential problem in quantum mechanics .    without trying to model the details , and neglecting coupling to extraneous modes , the effect of the splice is to convert in - mode operators to out - mode operators , as expressed by a unitary matrix @xmath244 . recognizing polarizations",
    ", we have modes @xmath176 and @xmath177 in the @xmath14-fiber and modes @xmath261 and @xmath262 in the @xmath15-fiber , with propagation constants @xmath263 , @xmath264 , @xmath265 , and @xmath266 , respectively .",
    "this makes the four in - modes @xmath267 and @xmath268 , @xmath269 , along with the four out - modes @xmath270 and @xmath271 ; hence if we neglect loss , the scattering matrix @xmath244 is 4-by-4 : @xmath272 = [ b_{1-}^\\dag(\\omega),\\,a_{1+}^\\dag(\\omega),\\ , b_{2-}^\\dag(\\omega),\\,a_{2+}^\\dag(\\omega)]u^\\dag(\\omega ) .",
    "\\label{eq : splice}\\ ] ]    under the simplifying assumption that the splice has no coupling between polarizations , the equation factors into two 2-by-2 pieces , one piece for each polarization . with @xmath244",
    "defined this way , the perfectly homogeneous situation in which @xmath273 , thus making the splice invisible , corresponds to @xmath274 .",
    "( to account for loss , we can add extraneous dimensions and then trace them out , thereby getting a matrix that is not unitary , so that the out - power can be less than the in - power . ) [ * for single - frequency matrices , we use power rather than energy , because energy is definable only for non - zero bandwidth . ]",
    "fiber couplers , analogous to beam splitters , have four fibers , @xmath275 , with @xmath276 ( see fig .  [ fig:4 ] ) .",
    "each of the eight modes comes in two directions , `` @xmath9 '' and `` @xmath10 '' . without loss , @xmath277 .          whether entangled in frequency or in polarization or in both",
    ", entangled states have to do with tensor products of vector spaces .",
    "let a vector space @xmath278 be a tensor product of vector spaces @xmath279 , where @xmath280 ranges over some index set .",
    "relative to this factorization , a generic vector in @xmath281 is a sum of tensor products of vectors @xmath282 ; unless it can be written as a single product , not a sum of products , @xmath283 is called _ entangled _ (",
    "relative to the factorization ) .",
    "we stress _ relative to a factorization _ because vector spaces for light states can be factored in more than one way , and to speak sensibly of ` entangled states ' one must know which factorization is meant .",
    "the vector space for a single mode involves tensor products over subspaces for frequency bands ; this factorization is relevant to frequency - entangled states . within any frequency band , there is an infinite tensor product over single frequencies , which will not be used here in speaking of ` entanglement ' .",
    "polarization - entanglement involves a vector space for several modes , factored by mode .",
    "frequency - preserving , unitary transformations of the single - frequency creation operators carry an in - state that is a tensor product of broad - band coherent states to an out - state that is also a tensor product of broad - band coherent states .",
    "this is a special property ; indeed the only case i know in which it works is that of coherent states .",
    "[ * work out proof ] ( in generic cases , a tensor product of single - photon in - states is carried to an entangled , multi - photon state . )",
    "this makes broad - band coherent states of special interest as an ( overcomplete ) basis for studying light in the context of frequency - preserving splices and couplers .",
    "see appendix [ app : e ] .",
    "a polarization - entangled state involves four modes ; we think of two orthogonal modes @xmath176 and @xmath177 in a left fiber to alice and two orthogonal modes @xmath261 and @xmath262 in a right fiber to bob .",
    "( one can think of 1 as horizontal and 2 as vertical . )",
    "then there are four creation operators @xmath284 , @xmath285 , @xmath286 , and @xmath287 ; everything commutes except that @xmath288 = \\delta_{i , j}\\delta(\\omega -\\omega')$ ] , where @xmath289 if @xmath290 and otherwise is 0 .",
    "the defining property of a state @xmath291 characterized by a single @xmath14-photon combined with a single @xmath15-photon is @xmath292 a necessary and sufficient condition for this is that @xmath291 have the form @xmath293 where @xmath294 where we use the definition stated in eq .",
    "( [ eq : twofac ] ) , and the four otherwise arbitrary functions @xmath295 satisfy the normalization condition ( in which no symmetry is assumed ) : @xmath296    to think about quantum key distribution , we will need to consider states of both fewer and more photons . a state with @xmath74 photons in @xmath14-modes ,",
    "@xmath6 of which are in mode @xmath176 , and with @xmath11 photons in @xmath15-modes , @xmath297 of which are in mode @xmath261 , has the form @xmath298 there is no loss of generality in requiring @xmath64 to be symmetric under each interchange @xmath299 for which @xmath300 and @xmath301 pertain to the same mode . when @xmath64 with this symmetry is normalized as in eq .",
    "( [ eq : nnorm ] ) , the state defined by eq .  ( [ eq : multst ] ) has unit norm .",
    "the most general state is a weighted sum of such states .",
    "a light detector as used in an experimental setup will be modeled by a positive operator - valued measure ( povm ) , @xmath302 , so the probability of outcome @xmath6 is @xmath303 , where @xmath1 is a density operator , and @xmath304 with @xmath305 . in the simplest models to be discussed here ,",
    "the density operator is for the light ; in more complex models discussed elsewhere @xcite , the density operator can be for a pure or mixed state of not only light to be detected but also probe particles .",
    "one could also include the generation of backward - propagating light , but here we do not get into this level of complication .",
    "example 2 : as a first theoretical example , a detector as narrow - band as possible that will register outcome 1 with certainty , given the one - photon state @xmath306 , has latexmath:[$m_1 = a^\\dag_g    against any other one - photon state @xmath50 if @xmath30 is unlike @xmath38 ; i.e. , the probability for outcome 1 for a state @xmath50 is @xmath308",
    ".    given a set of mutually orthogonal functions @xmath309 , @xmath198 ,  , @xmath310 , there can be a detector with @xmath310 possible outcomes , with @xmath311 .",
    "thus a single - photon detector is certainly not restricted to giving a yes - no outcome , and discrimination among different single - photon states is possible . herein lies a caution to designers who hope that distinct lasers generate distinct states that differ in polarization .",
    "example 3 : an example of a model of detectors preceded by filters used for joint detection of a two - mode state is @xmath312",
    ". then outcome 1 would be described as ` finding the state @xmath313 in measuring mode @xmath14 jointly with finding the state @xmath314 in measuring mode  @xmath15 . ' for the two - mode state ( [ eq : two ] ) , the probability of this outcome is readily calculated to be @xmath315 .",
    "example 4 : an interesting and perhaps novel application of probe particles involves detection at two coordinated locations using probe particles that have previously become entangled .",
    "this can produce an example that swaps the detection operator @xmath316 and the state of example 2 , leaving the probability invariant .",
    "i.e. , the same probabilities and outcomes arise from measuring an entangled state with an unentangled detector as from measuring an unentangled state with an entangled detector @xcite .      for multi - photon states ,",
    "a simple approach is to model a detector as a povm for a state involving only the light to be detected .",
    "this assumes that memory effects in the detector , such as those often attributed to trapped carriers in photo - diodes , are insignificant ( for instance because the network design enforces enough hardware dead time ) ; it also assumes teetering in the detector plays no significant role @xcite . for simplicity",
    ", here we add the assumption that the detector and its pulse - shaping circuitry choose an outcome of ` yes ' or ` no ' without any additional detail . with these assumptions",
    ", all one has left is dark - count and efficiency ; one obtains a class of detector models that respond to @xmath11 photon states according to @xmath317 with @xmath318 . with the additional assumption that the detector is flat in its frequency response over the bandwidth of the light pulses to be detected , the detection operator that generates these probabilities is @xmath319 where @xmath166 is defined in eq .",
    "( [ eq : pndef ] ) and we use @xmath320 in place of @xmath24 , so the integrals are over positive frequencies only . [ for a detector of both polarization modes @xmath176 and @xmath177 of a fiber , one has instead , @xmath321 with @xmath322 defined by eq .",
    "( [ eq : pdist ] ) with @xmath320 in place of @xmath24 . ]    to model the use of avalanche photo - diode ( apd ) detectors in the darpa quantum network , we explore in detail a specialization of this type of model .",
    "we will use this model in sec .",
    "[ sec:9 ] to study the variation in detection statistics as the energy of transmitted pulses is raised above that of a single - photon state .",
    "an apd detector for an optical fiber responds to both polarization modes of the fiber ; however , by placing a polarizing beam splitter before the detector , one can effectively eliminate the light from one mode .",
    "we assume this case , so that only one polarization mode is relevant .",
    "then we suppose that the probability of the detector responding to any single - photon state is @xmath323 , assumed independent of frequencies over the range of frequencies relevant to the light state . we need to model the probability of detecting multi - photon states . by the assumption already made",
    ", the probability of failing to detect any single - photon state is @xmath324 .",
    "assume that the probability of failing to respond to an @xmath11-photon state is just the single - photon failure probability raised to the @xmath11-th power : @xmath325 .",
    "then the probability assigned by this model to registering a detection , given an @xmath11-photon state and temporarily ignoring dark counts , is @xmath326 to allow for dark counts we replace this by @xmath327 to deal with states that are superpositions over varying numbers of photons , we recall that the operator for an ideal detector that responds always to any @xmath11-photon state , with no probability of detection for a state that has no @xmath11-photon component , is the projection @xmath328 defined in sec .",
    "[ sec:5 ] .",
    "the following detection operator @xmath329 invokes @xmath328 to provide the desired probabilities for a detector of a single @xmath14-mode @xcite : @xmath330p_{n,+}(a ) , \\label{eq : m1}\\ ] ] where @xmath166 is defined in eq .",
    "( [ eq : pndef ] ) and we use @xmath320 in place of @xmath24 , so the integrals are over positive frequencies only . [ for a detector of both polarization modes @xmath176 and @xmath177 of a fiber , one has instead , @xmath331p_{n,+}(a_1,a_2 ) , \\label{eq : m1old}\\ ] ] with @xmath322 defined by eq .",
    "( [ eq : pdist ] ) with @xmath320 in place of @xmath24 . ]    as applied to states with photon - number components negligible except when @xmath332 , we notice @xmath333 from which we obtain for this case an approximation that simplifies eq .",
    "( [ eq : m1 ] ) @xmath334p_{n,+}(a ) \\nonumber \\\\ & = & p_{\\rm dark}(a ) + ( 1-p_{\\rm dark}(a))\\eta_{\\rm det}\\int_0^\\infty d\\omega\\ , a^{\\dag}(\\omega)a(\\omega ) .",
    "\\label{eq : mapprox}\\end{aligned}\\ ] ]      the most general state involving @xmath297 modes can be written as @xmath335 where @xmath336 is a function of @xmath11 frequency variables and @xmath337 is a homogeneous polynomial of degree @xmath11 in the @xmath297 creation operators _ without any annihilation operators_.    let @xmath232 stand for any of the modes @xmath104 .",
    "the operator for ` detect ' for mode @xmath232 is @xmath338 and the operator for ` no - detect ' is obtained from eqs .",
    "( [ eq : m1 ] ) and ( [ eq : unit ] ) as @xmath339 any theoretical outcome produced by apd detectors as modeled here is specified by two lists of modes , a list @xmath340 for which apd detectors register ` no - detect , ' and a list @xmath341 for which apd detectors register ` detect . '",
    "the operator for ` detect ' for modes in the list @xmath341 and ` no - detect ' for modes in the list @xmath340 is @xmath342 , where we define @xmath343 the corresponding probability is then @xmath344    for @xmath345 expressed in the form of eq .",
    "( [ eq : general ] ) and the apd model that invokes @xmath316 as defined in eq .",
    "( [ eq : m1 ] ) , calculating this probability is surprisingly simple . from eqs.([eq : m0 ] ) and ( [ eq : projn ] ) we obtain the effect of @xmath346 on a state vector defined by an integral over frequencies of a monomial in creation operators @xmath347|0\\rangle .",
    "\\label{eq : m0eff}\\end{aligned}\\ ] ]    from this we arrive at the following important    * proposition * : the effect of an operator @xmath348 for ` no - detection ' on a general state @xmath345 is to multiply the state by @xmath349 and to replace every instance of a creation operator @xmath34 by @xmath350 .",
    "further this holds if creation operators for modes orthogonal to @xmath14 enter the polynomial @xmath337 .",
    "this generalizes to ` no - detection ' of more modes .",
    "* proposition * : the effect of a product of creation operators @xmath351 on a general state @xmath352 is to multiply the state by @xmath353 and to replace every instance of a creation operator @xmath354 , for @xmath198 ,  , @xmath355 , by @xmath356 @xmath357 .    for purposes of calculating probability terms @xmath358 , where @xmath359 is an arbitrary list of mode names ( as in sec .",
    "[ sec:9 ] ) , we can put this in a symmetric form .",
    "because only like powers of creation and annihilation operators appear in terms that contribute to probabilities , we can distribute the factor @xmath360 evenly between the creation and the annihilation operators , as follows .",
    "* proposition * : for any list @xmath359 of mode names , one has @xmath361 where @xmath362 is the expression obtained from @xmath345 defined in eq .",
    "( [ eq : general ] ) by replacing every instance of a creation operator @xmath354 , for @xmath198 ,  , @xmath355 , by @xmath363^{1/2}a_j^\\dag(\\omega_j)$ ] , and @xmath364 is obtained from @xmath365 by the corresponding replacement of @xmath24 by @xmath366^{1/2}a_j(\\omega_j)$ ] .    * caution : * this and the preceding two propositions require that the polynomial in eq .",
    "( [ eq : general ] ) contain no annihilation operators .    for evaluating @xmath367 ,",
    "the story is more complicated .",
    "what makes proposition ( [ eq : probeff ] ) work is that the substitution of @xmath363^{1/2}a_j^\\dag(\\omega_j)$ ] for @xmath357 commutes with products , and this does not hold for the analogous rule for @xmath368 . from eqs .",
    "( [ eq : m0eff ] ) and ( [ eq : m0 ] ) we find @xmath369\\prod_{j=1}^n a^\\dag(\\omega_j)|0\\rangle .",
    "\\label{eq : m1eff}\\ ] ] this proves useful in sec .",
    "[ sec:9 ] ; however its use is constrained because it can not be interchanged with the taking of products of operators .",
    "for this reason we benefit from the following method of evaluating @xmath370 in terms of terms of the form @xmath371 . equations ( [ eq : m0 ] ) and ( [ eq : mbfdef ] ) imply , for any set @xmath359 of mode names , @xmath372.\\ ] ] with this , we express the product of @xmath316 factors in eq.([eq : mbfdef ] ) by @xmath373 where for any set @xmath374 , @xmath375 denotes the number of elements in @xmath374 , the sum is over all subsets of @xmath359 , including both @xmath359 itself and the empty set @xmath376 , and we adopt the convention that @xmath377 example : @xmath378 thus we arrive at an equation for the detection operators in eq.([eq:96 ] ) : @xmath379 where @xmath380 denotes the concatenation of the two lists of mode names .",
    "this implies @xmath381      in many applications a detector is gated on only briefly .",
    "approximating the turn - on and turn - off as perfectly abrupt , we model the effect of gating the detector on for a duration @xmath382 centered at a time @xmath383 by use of eq .",
    "( [ eq : dt ] ) with the infinite limits replaced by finite times @xmath384 and @xmath385 .",
    "for instance in eq .",
    "( [ eq : mapprox ] ) we replace @xmath386 by @xmath387 for whichever sense of the @xmath388 sign corresponds to propagation toward the detector . substitution from eq .",
    "( [ eq : loca ] ) and carrying out the time integration yield @xmath389}\\,\\frac{1}{\\pi}\\,\\frac{\\sin[(\\omega -    \\omega')t/2]}{\\omega- \\omega'}.\\qquad \\label{eq : gated}\\end{aligned}\\ ] ]    [ * look at mandel @xcite , first at pp .  573ff ; then pp .  691ff .",
    "check in mandel , p.  696",
    "( 14.217 ) , for arguments that dark counts are in principle unavoidable , due to vacuum fluctuations . ]",
    "let @xmath390 be the vector space of light states generated by integrals over monomials in creation operators acting on the vacuum state @xmath12 .",
    "then for a mode @xmath14 , @xmath391 is the subspace of states generated by a weighted integral over @xmath11 factors , @xmath392 , along with any number of factors of creation operators for modes orthogonal to @xmath14 , all acting on the vacuum state @xmath12 .",
    "any vector @xmath393 in @xmath390 can be written as a sum over terms in mutually orthogonal subspaces : @xmath394 with @xmath395 and of unit norm .",
    "then we have @xmath396 .",
    "further , we have @xmath397 and , for @xmath398 , @xmath399 .",
    "it follows that @xmath400 that is , there are no cross terms .",
    "the probability of detection of a mode @xmath14 , as well as the energy in the mode , are often expressed by integrals over products @xmath401 or , per eqs.([eq : tdetect ] ) and ( [ eq : gated ] ) , @xmath402 , with the result that both the energy for the mode @xmath14 and the probability of detection can be expressed as sums with no cross terms between terms with differing numbers of @xmath14 photons . that is , the expectation energy for energy in the @xmath14-mode is latexmath:[$\\hbar \\sum_{n=0 } n    frequency that is straightforward to work out .",
    "similarly , using any of the detection models discussed above , the probability of detecting the state @xmath393 by use of a detector involving only the mode @xmath14 is @xmath404 .",
    "the simplest model of beam splitting ( which neglects frequency dependence , reflection , and mixing of polarizations ) expresses an in - mode @xmath14 in terms of mutually orthogonal out - modes @xmath15 and @xmath187 by an su(2 ) transformation : @xmath405    consider an @xmath11-photon @xmath14-mode in - state defined in eq.([eq : nphot ] ) , @xmath406 where , without loss of generality , @xmath336 is symmetric under permutations of its @xmath11 arguments , normalized as in eq.([eq : nnorm ] ) .",
    "the out - state from the su(2 ) transformation expresses the state downstream of a beam - splitter as @xmath407 where we define the unnormalized state vector @xmath408    now calculate the probability of ` no - detect ' for this state by a detector of the @xmath15 mode , described by the operator @xmath409 per the preceding apd model : @xmath410 by proposition ( [ eq : probeff ] ) , this becomes @xmath411 from lemmas ( [ eq : nkrelation ] ) , ( [ eq : normhn ] ) of appendix  [ app : b ] , along with the normalization of @xmath336 we have @xmath412 whence we obtain @xmath413^k(1-\\eta_{\\rm trans})^{(n - k ) } \\nonumber \\\\ & = & ( 1-p_{\\rm dark})[\\eta_{\\rm trans}(1-\\eta_{\\rm det } ) + 1-\\eta_{\\rm trans}]^n \\nonumber \\\\ & = & ( 1-p_{\\rm dark})(1 -\\eta_{\\rm trans}\\eta_{\\rm det})^n.\\end{aligned}\\ ] ] this is just the probability of ` no - detect ' for the in - state by an @xmath14-mode detector , modified by replacing @xmath323 by the product @xmath414 .",
    "thus we have arrived at the    * proposition * : for the apd model described above , we consider a beam splitter for which the free input is a vacuum state , and which passes a frequency - independent fraction of energy @xmath415 ; then the probability ` no - detect ' downstream of the splitter is obtained from the expression for the probability upstream by replacing the detector efficiency @xmath323 by a reduced efficiency @xmath414 .",
    "* caution * : this proposition holds specifically for the apd model ; there are certainly other models , such as photon counting , to which it does not apply .",
    "some early models of quantum key distribution assumed bi - photon states @xcite .",
    "a year ago john schlafer asked how the energy of the light pulse ",
    "its multi - photon content  affects the statistics of detection . as preparation for sec .",
    "[ sec:10 ] , where we start to answer this question , here we show some of the possible multi - photon states that have to be considered .",
    "the general bi - photon light state is given by eq .",
    "( [ eq : biphot ] ) .",
    "here we confine ourselves to a special case in which detection statistics are invariant whenever the same polarization transform is performed on both the @xmath14 and @xmath15 fibers leaving the source .",
    "( it will be interesting to check experimentally for this invariance . )",
    "the polarization transformations are the group su(2 ) , and we refer to bi - su(2 ) invariance as invariance of detection probabilities under the following frequency - independent transformation , for arbitrary complex @xmath416 such that @xmath417 , @xmath418\\!\\ !    \\rightarrow\\!\\ !",
    "\\left[\\begin{array}{c } u a_1(\\omega ) + v   a_2(\\omega ) \\\\ -v^ * a_1(\\omega ) + u^ * a_2(\\omega ) \\end{array}\\right]\\ ! , \\qquad \\left[\\begin{array}{c}b_1(\\tilde{\\omega } )   \\\\b_2(\\tilde{\\omega } ) \\end{array}\\right]\\!\\ !",
    "\\rightarrow\\!\\ !",
    "\\left[\\begin{array}{c } u b_1(\\tilde{\\omega } ) + v b_2(\\tilde{\\omega } )   \\\\ -v^ * b_1(\\tilde{\\omega } ) + u^ * b_2(\\tilde{\\omega } )   \\end{array}\\right]\\!.   \\label{eq : biinv}\\ ] ]    by analyzing the case @xmath419 , @xmath420 , one sees that bi - su(2 ) invariance requires that @xmath64 in eq .",
    "( [ eq : biphot ] ) satisfy @xmath421 = g(\\omega,\\tilde{\\omega})\\left [   \\begin{array}{rr } 0&\\quad 1 \\\\-1   & \\quad 0 \\end{array}\\right],\\ ] ] where @xmath422 but @xmath38 is an otherwise arbitrary function .",
    "any such state is a single @xmath14-photon together with a single @xmath15-photon .",
    "sufficiency of this condition to assure bi - photon invariance is shown by the substitution defined in eq.([eq : biinv ] ) .    to explore the dependence of detection probabilities on energy",
    ", we need to analyze multi - photon states .",
    "we confine ourselves to an opening step in this direction by choosing multi - photon states that have bi - su(2 ) invariance of the form @xmath423 where @xmath424 because the factors under the product all commute with one another , what matters about @xmath30 is the part that is invariant under permutations that swap @xmath425 with @xmath426 .",
    "we think of a vector @xmath427 and denote the average of @xmath30 over permutations of these vectors by @xmath428 this is the first of several symmetries that will be seen to couple polarization entanglement to frequency entanglement in a way that affects how detection statistics depend on light energy .",
    "the terms @xmath161 have the further decomposition @xmath429 where the unnormalized states @xmath430 are defined by @xmath431 \\nonumber \\\\ & & { } \\times \\left(\\prod_{j=1}^m a_1^\\dag(\\omega_j ) b_2^\\dag(\\tilde{\\omega}_j)\\right)\\left(\\prod_{j= m+1}^n",
    "a_2^\\dag(\\omega_j ) b_1^\\dag(\\tilde{\\omega}_j ) \\right)|0\\rangle,\\qquad \\label{eq : gnm}\\end{aligned}\\ ] ] with the convention on products defined in eq .",
    "( [ eq : conven ] ) , and with the additional symmetry operations that act on @xmath300 without acting on @xmath432 , so that @xmath433 is defined for @xmath434 by @xmath435 similarly , @xmath436 operates on the arguments @xmath300 for @xmath437 .    * remark * : although @xmath100 as defined in eq.([eq : sdef ] ) is not a quantum operator , it is a linear operator on a function space , indeed a projection , so that , as an operator , @xmath438 . if @xmath64 is a function with arguments operated on by @xmath100 then @xmath439 is invariant under the group of permutations over which @xmath100 averages . in particular",
    ", @xmath439 is invariant under the swapping of any two of the arguments listed in @xmath100 .",
    "that is the first point .",
    "the second point is that a transposition of @xmath440 and @xmath441 followed by a transposition of @xmath300 and @xmath301 is a transposition of @xmath432 and @xmath442 .",
    "generalizing on eq .",
    "( [ eq : b1b2 ] ) , if we neglect loss , reflections , and unwanted polarization couplings , we model the effect of a non - polarizing beam splitter ( or fiber coupler ) that splits say mode @xmath104 into modes @xmath443 and @xmath444 by @xmath445 for some complex @xmath416 such that @xmath417 . to see the effect of this splitting of @xmath176 on the state @xmath430 ,",
    "one makes the substitution for @xmath176 in eq.([eq : gnm ] ) defined by eq .",
    "( [ eq : splita ] ) .",
    "the important observation is that no further permutation symmetries enter , so the effect is only to replace @xmath446 by @xmath447      unlike beam splitting , the effect of a polarization rotation involves an added permutation symmetry , and accounting for this symmetry is essential in calculating the inner products needed to arrive at probabilities of detection .",
    "this additional symmetry occurs because polarization rotation mixes , for example , an @xmath176-mode with an @xmath177-mode ."
  ],
  "abstract_text": [
    "<S> we formulate quantum optics to include frequency dependence in the modeling of optical networks . </S>",
    "<S> entangled light pulses available for quantum cryptography are entangled not only in polarization but also , whether one wants it or not , in frequency . </S>",
    "<S> we model effects of the frequency spectrum of faint polarization - entangled light pulses on detection statistics . </S>",
    "<S> for instance , we show how polarization entanglement combines with frequency entanglement in the variation of detection statistics with pulse energy .    </S>",
    "<S> attention is paid not only to single - photon light states but also to multi - photon states . </S>",
    "<S> these are needed ( 1 ) to analyze the dependence of statistics on energy and ( 2 ) to help in calibrating fiber couplers , lasers and other devices , even when their desired use is for the generation of single - photon light .    </S>",
    "<S> # 1#2#3=.5 in to .5in#1 .  </S>",
    "<S> # 2#3 # 1#2#3=.72 in to .5into .22in#1 .  </S>",
    "<S> # 2#3 # 1#2#3=1.04 in to .125inappendix   # 1 .  </S>",
    "<S> @xmath0#2#3 # 1#2=.875 in to .125in#1#2    * contents *    part i    part ii    * part i * </S>"
  ]
}