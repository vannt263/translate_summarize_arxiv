{
  "article_text": [
    "solutions to integrable differential equations in terms of theta - functions were introduced at the beginning of the seventies , see @xcite for an account of the history . in general , they describe periodic or quasi - periodic solutions .",
    "in contrast to the well - known solitonic solutions in terms of elementary functions , the theta - functions are special transcendental functions defined on some riemann surface . all quantities entering the solution",
    "are given in explicit form via integrals which depend implicitly on the branch points of the riemann surface .",
    "a full understanding of the functional dependence on these parameters seems to be only possible numerically .",
    "algorithms have been developed to establish such relations for rather general riemann surfaces as in  @xcite or via schottky uniformization ( see @xcite ) , which have been incorporated successively in numerical and symbolic codes , see  @xcite and references therein ( the first two references are distributed along with maple  6 , respectively maple  8 , and as a java implementation  @xcite ) .",
    "these codes are convenient to study theta - functional solutions on a given surface .",
    "to establish the dependence of the characteristic quantities of a riemann surface on the branch points , an efficient calculation of the periods is necessary .",
    "this is especially true if the modular dependence of the theta - functions is of interest as in the case of theta - functional solutions to the ernst equation  @xcite in @xcite .    in @xcite",
    ", henceforth referred to as i , we have presented a code for the numerical treatment of hyperelliptic solutions to the ernst equation on a surface of genus  2 .",
    "the integrals entering the solution are calculated by expanding the integrands as a series of chebyshev polynomials using a fast cosine transformation in matlab and then integrating the polynomials in an appropriate way . in the present article , this code",
    "is extended to hyperelliptic surfaces of arbitrary genus and of branch points in general position . as an example we consider hyperelliptic solutions to the kadomtsev - petviashvili ( kp ) equation and the korteweg - de vries ( kdv ) equation .",
    "the precision of the numerical evaluation is tested by checking identities for periods on riemann surfaces and the differential equations .",
    "we show that an accuracy of the order of machine precision ( @xmath0 ) can be achieved for branch points in general position with 32 polynomials and in the case of almost degenerate surfaces which occurs e.g.  in the well - known solitonic limit with at most 256 polynomials .",
    "consequently the solitonic limit can be carried out numerically with machine precision which will be shown at the example of the 2-soliton solution to the kdv equation .",
    "this makes it possible to study the parameter space for hyperelliptic surfaces numerically .",
    "this paper is a sequel to i which was devoted to genus 2 solutions to the ernst equation .",
    "we will only briefly repeat the methods already outlined there and refer the reader to i for details .",
    "the article is organized as follows : in section  [ sec : kp ] we collect useful facts on the kp and the kdv equation and hyperelliptic riemann surfaces , in section  [ sec : spectral ] we summarize basic features of spectral methods and explain our implementation of various quantities .",
    "the calculation of the periods of the hyperelliptic surface is performed together with tests of the precision of the numerics .",
    "the theta - series is approximated as in @xcite as a finite sum .",
    "it is checked numerically how well the theta - functional solution solves the differential equation . in section  [ sec : examples ] we present several examples of hyperelliptic solutions to the kp and the kdv equation in general cases and in almost solitonic situations . in section  [ sec : concl ] we add some concluding remarks .",
    "the kp equation for the real valued potential @xmath1 depending on the three real coordinates @xmath2 can be written in the form @xmath3 the completely integrable equation has a physical interpretation as describing the propagation of weakly two - dimensional waves of small amplitude in shallow water as well as similar physical processes , see @xcite .",
    "we note that there is a variant of the kp equation having a different sign of the @xmath4-term which will not be considered here .",
    "algebro - geometric solutions to the kp equation can be given on an arbitrary riemann surface .",
    "here we will only consider hyperelliptic surfaces @xmath5 of genus @xmath6 corresponding to the plane algebraic curve @xmath7 where we have defined the symmetric ( in the branch points ) functions @xmath8 , @xmath9 .",
    "we will concentrate on real surfaces with real branch points @xmath10 , @xmath11 .",
    "the branch points are ordered , @xmath12 .",
    "hyperelliptic riemann surfaces are important since they show up in the context of algebro - geometric solutions of various integrable equations such as kdv , sine - gordon and ernst . whereas it is a non - trivial problem to find a basis for the holomorphic differentials on general surfaces ( see e.g.  @xcite ) , it is given in the hyperelliptic case ( see e.g.  @xcite ) by @xmath13 which is the main simplification in the use of these surfaces .",
    "we introduce on @xmath5 a canonical basis of cycles @xmath14 , @xmath15 as in fig .",
    "[ fig : cut - system ] .",
    "the holomorphic differentials @xmath16 are another basis in the space of holomorphic differentials which is normalized by the condition on the @xmath17-periods @xmath18 this fixes the @xmath16 uniquely given the system of cycles .",
    "the corresponding matrix of @xmath19-periods is given by @xmath20 .",
    "the matrix @xmath21 is a so - called riemann matrix , i.e.  it is symmetric and has a negative definite real part .",
    "the surfaces we consider here are real , i.e.  they have an anti - holomorphic involution @xmath22 with @xmath23 .",
    "the basis of the homology is chosen to have the property @xmath24 this implies for the normalized holomorphic differentials @xmath25 the reality condition @xmath26 the matrix of @xmath19-periods is real in this case .",
    "the theta - function with characteristics corresponding to the curve @xmath5 is given by @xmath27 where @xmath28 is the argument and @xmath29 are the characteristics .",
    "we will only consider half - integer characteristics in the following .",
    "the theta - function with characteristics is , up to an exponential factor , equivalent to the theta - function with zero characteristic ( this is the riemann theta - function , denoted with @xmath30 ) and shifted argument , @xmath31 it has the periodicity properties @xmath32 where @xmath33 is the @xmath6-dimensional vector consisting of zeros except for a 1 in jth position .",
    "the differentials of the second kind needed here have a pole of order @xmath34 at infinity .",
    "they will be denoted by @xmath35 .",
    "the laurent expansion of the corresponding integrals is of the form @xmath36 where @xmath37 is the local parameter in the vicinity of infinity .",
    "the singularity structure characterizes the differentials only up to an arbitrary linear combination of holomorphic differentials .",
    "this arbitrariness is eliminated by imposing the condition that all @xmath17-periods vanish .",
    "the normalized differentials satisfy the reality conditions @xmath38 .",
    "the vectors of @xmath19-periods of these differentials are denoted by @xmath39 the periods are real under the above conditions . for later use",
    "we define the constant @xmath40 via the expansion of the integral @xmath41 , @xmath42    the differentials of the second kind @xmath43 are given explicitly on @xmath5 by @xmath44 where the @xmath45 are determined by the condition of vanishing @xmath17-periods , @xmath46 and @xmath47 where @xmath48 denotes the holomorphic differentials leading to vanishing @xmath17-periods . for the constant @xmath40 ,",
    "we get @xmath49 it is well known that the @xmath19-periods of normalized differentials of the second kind can be expressed in terms of expansions of the holomorphic differentials in the vicinity of the singularity ( see e.g.  @xcite ) .",
    "we write the holomorphic differentials in the vicinity of some point @xmath17 in the form @xmath50 where @xmath51 is the local parameter in the vicinity of @xmath17 .",
    "if we choose @xmath52 ( the infinite point in the upper sheet ) , we have @xmath53 thus , the periods @xmath54 , @xmath55 and @xmath56 can be calculated as the @xmath19-periods of the differentials @xmath43 , @xmath57 , or via an expansion of the holomorphic differentials .",
    "solutions to the kp equation on the above riemann surfaces are given by the generalization of the its - matveev formula for the kdv equation ( see e.g.  @xcite ) @xmath58 where @xmath59 is an arbitrary real vector .",
    "because of ( [ theta2 ] ) and the second logarithmic derivative in ( [ eq : solution ] ) , the vector @xmath60 can always be absorbed in the form of a real characteristic . by a coordinate change @xmath61",
    "one can change a solution @xmath1 to the kp equation by @xmath62 .",
    "the reality of the argument of the theta - function implies that the theta - function which is an entire function does not vanish .",
    "this can be seen from the following argument for the elliptic case : @xmath63 a generalization of the argument to higher genus is straightforward .",
    "probably the most elegant way to show that ( [ eq : solution ] ) provides a solution to the kp equation is the use of fay s trisecant identity @xcite .",
    "this is an identity for theta - functions which holds for four arbitrary points on a riemann surface , see @xcite for details .",
    "here we need the identity in the limit that all four points coincide which leads to an identity for derivatives of theta - functions .",
    "we introduce the directional derivatives on @xmath64 ( @xmath65 acts on @xmath66 ) @xmath67 then for an arbitrary vector @xmath68 the following identity holds : @xmath69 here the constants @xmath70 , @xmath71 turn up in the taylor expansion of the differential @xmath72 from above ( @xmath52 ) , @xmath73 we put @xmath74 and get for relation ( [ eq : fay ] ) after differentiation with @xmath75 @xmath76 because of ( [ eq : bperiods ] ) this equation is for @xmath77 equivalent to the kp equation .",
    "if the hyperelliptic surface @xmath5 is branched at infinity , i.e.  if @xmath78 in ( [ hyper1 ] ) , the integral @xmath79 is single valued . thus , all its @xmath17- and @xmath19-periods vanish which implies that there is no @xmath80-dependence in the formula ( [ eq : solution ] ) .",
    "then the kp equation reduces to the kdv equation , @xmath81 the hyperelliptic surface is now defined by the algebraic curve @xmath82 all definitions apply as before .",
    "we use a cut - system of the form fig .",
    "[ fig : cut - system ] where all @xmath19-cycles start at the cut @xmath83 $ ] along the positive real axis .    as a local parameter at infinity",
    "we can use @xmath84 .",
    "the differentials of the second kind we need here read @xmath85 and @xmath86 where the constants @xmath87 and @xmath88 are again defined by the condition that all @xmath17-periods of the above differentials vanish .",
    "writing the normalized holomorphic differentials as @xmath89 we get for the @xmath19-periods of the differentials of the second kind @xmath90 the constant @xmath40 reads @xmath91    an interesting limiting case of the theta - functional solutions on a genus @xmath6 surface is the so - called solitonic limit , see @xcite . in this case",
    "@xmath92 for @xmath93 which leads to the @xmath6-soliton solution . since @xmath6 of the cuts collapse to double points , the diagonal elements of the riemann matrix diverge in the used cut - system as @xmath94 whereas all other @xmath17- and @xmath19-periods remain finite .",
    "the theta - series thus breaks down to a sum containing only elementary functions . to obtain the standard form of the @xmath6-soliton",
    ", we choose the vector @xmath60 in ( [ eq : solution ] ) to correspond to the half - integer characteristic @xmath95      \\label{eq : chars}.\\ ] ]    on an elliptic surface we get with the above relations for ( [ eq : solution ] ) the 1-soliton solution of kdv equation , @xmath96 where @xmath97 similarly we get for the 2-soliton @xmath98 where @xmath99 and @xmath100 a generalization to higher genus is straight forward , see @xcite",
    ". formulas ( [ eq : soliton1 ] ) and ( [ eq : sol23 ] ) hold also for the kp equation with the appropriate definition of @xmath68 and @xmath54 .",
    "the numerical task in this work is to approximate and evaluate analytically defined functions as accurately and efficiently as possible . to this end",
    "it is advantageous to use ( pseudo-)spectral methods which are distinguished by their excellent approximation properties when applied to smooth functions . here",
    "the functions are known to be analytic except for isolated points . in this section",
    "we explain the basic ideas behind the use of spectral methods and describe in detail how the theta - functions and its derivatives can be obtained to a high degree of accuracy .",
    "the basic idea of spectral methods is to approximate a given function @xmath101 globally on its domain of definition by a linear combination @xmath102 where the functions @xmath103 are taken from some class of functions which is chosen appropriately for the problem at hand .",
    "the spectral coefficients are determined by a so - called collocation method , i.e.  by the condition that @xmath104 at selected points @xmath105 . since we are interested in an approximation of functions defined on a finite interval , orthogonal polynomials , in particular chebyshev @xmath106 polynomials will be chosen .",
    "they are defined on the interval @xmath107 $ ] by the relation @xmath108.\\ ] ] the chebyshev polynomials are used because they have very good approximation properties and because one can use fast transform methods when computing the expansion coefficients from the function values provided one chooses the collocation points @xmath109 ( see  @xcite and references therein ) .",
    "let us briefly summarize here some basic properties of chebyshev polynomials : the addition theorems for sine and cosine imply the recursion relations @xmath110 for their derivatives .",
    "the chebyshev polynomials are orthogonal on @xmath111 with respect to the hermitian inner product @xmath112 we have @xmath113 where @xmath114 and @xmath115 otherwise .    the fact that @xmath101 is approximated globally by a finite sum of polynomials allows us to express any operation applied to @xmath101 approximately in terms of the coefficients .",
    "let us illustrate this in the case of integration .",
    "so we assume that @xmath116 , and we want to find an approximation of the integral for @xmath117 , i.e. , the function @xmath118 so that @xmath119 . we make the ansatz @xmath120 and obtain the equation @xmath121 expressing @xmath122 in terms of the @xmath123 using   and comparing coefficients determines all @xmath124 in terms of the @xmath125 except for @xmath126 .",
    "this free constant is determined by the requirement that @xmath127 .",
    "thus , to find an approximation of the definite integral @xmath128 we proceed as described above , first computing the coefficients @xmath125 of @xmath101 , computing the @xmath129 and then calculating the sum of the necessary coefficients .",
    "the quantities entering formula  ( [ eq : solution ] ) are the periods of certain differentials on the riemann surface .",
    "the value of the theta - function is then approximated by a finite sum .",
    "the periods of a hyperelliptic riemann surface can be expressed as integrals between branch points .",
    "since we need in our example the periods of the holomorphic differentials and differentials of the second kind with poles at @xmath130 , we have to consider integrals of the form @xmath131 where the @xmath132 , @xmath133 denote the branch points of @xmath5 .",
    "we parametrize the straight line between the two branch points @xmath134 and @xmath135 by @xmath136 to obtain the integral  ( [ period1 ] ) in the normal form @xmath137 where the @xmath138 are complex constants and where @xmath139 is a continuous ( in fact , analytic ) complex valued function on the interval @xmath140 $ ] .",
    "this form of the integral suggests to express the powers @xmath141 in the numerator in terms of chebyshev polynomials and to approximate the function @xmath139 by a linear combination of chebyshev polynomials @xmath142 the integral is then calculated with the help of the orthogonality relation  ( [ eq : ortho ] ) of the chebyshev polynomials .",
    "this is the procedure used in i for general position of the branch points which can also be applied here for low genus .",
    "the problem is that there does not seem to be a direct way to express the terms @xmath143 in ( [ period1 ] ) after the linear transformation in terms of chebyshev polynomials in @xmath51 .",
    "this is an obstacle to the determination of the periods for general genus .",
    "another problem are situations close to the solitonic limit . since the cut - system fig .",
    "[ fig : cut - system ] is adapted to this case , the @xmath17-periods do not lead to problems .",
    "for the @xmath19-periods , the function @xmath144 in the expression for @xmath145  ( [ eq : int_aperiod ] ) behaves like @xmath146 near @xmath147 .",
    "for @xmath148 this behavior is only satisfactorily approximated by a large number of polynomials .",
    "the use of a large number of polynomials however does not only require more computational resources but has the additional disadvantage of introducing larger rounding errors .",
    "it is therefore worthwhile to reformulate the problem since a high number of polynomials would be necessary to obtain optimal accuracy in this case .",
    "it is possible to address both problems in one approach .",
    "the idea is to use substitutions in the integrals ( [ period1 ] ) leading to a regular integrand . to determine the @xmath17-periods , we use @xmath149 after a linear transformation which transforms the integration path to the interval @xmath140 $ ] , the integral",
    "is computed with the chebyshev integration routine sketched above .",
    "this also works in situations close to the solitonic limit . to treat the @xmath19-periods in this case",
    ", we split the integral from @xmath11 to @xmath150 in two integrals from @xmath11 to @xmath151 and from @xmath151 to @xmath150 . in the former case",
    "we use the substitution ( [ eq : apers ] ) and @xmath152 in the latter .",
    "these substitutions lead to a regular integrand even in situations close to the solitonic limit . after a linear transformation ,",
    "the integrals are computed with the chebyshev integration routine .",
    "the disadvantage of this approach is that the definition of the square root adapted to the cut - system in i via monomials can not be used in the case of the above non - linear transformations . here",
    "the root is chosen in a way that the integrand is a continuous function on the path of integration .",
    "this can be achieved in general for real branch points .    to test the numerics we use the fact that in our case the integral of any holomorphic differential along a contour surrounding the cut @xmath153 $ ] in positive direction is equal to minus the sum of all @xmath17-periods of this integral .",
    "since this condition is not implemented in the code it provides a strong test for the numerics .",
    "the symmetry of the riemann matrix ( the matrix of @xmath19-periods of the holomorphic differentials after normalization ) can be used to estimate the error in the numerical evaluation of the @xmath19-periods .",
    "we define the function @xmath154 as the maximum of the norm of the difference in the @xmath17-periods discussed above and the difference of the off - diagonal elements of the riemann matrix .",
    "additional tests for the periods @xmath54 , @xmath55 and @xmath56 follow from ( [ eq : bperiods ] ) .",
    "we show in fig .",
    "[ fig : kperr ] a genus 2 situation with the branch points @xmath155 $ ] .",
    "it can be seen that 32 polynomials are sufficient in general position ( @xmath156 ) to achieve optimal accuracy .",
    "since matlab works with 16 digits , machine precision is in general limited to 14 digits due to rounding errors .",
    "these rounding errors are also the reason why the accuracy drops slightly when a higher number of polynomials is used .    in an almost degenerate situation ( @xmath157 ) ,",
    "optimal accuracy is achieved with 128 polynomials .",
    "note that all quantities entering ( [ eq : solution ] ) are within @xmath158 and better equal to the limits given in ( [ eq : pers1 ] ) and ( [ eq : pers2 ] ) .",
    "thus the solitonic limit can be reached numerically with machine precision .",
    "the above procedure to determine the periods can be directly implemented within matlab for arbitrary genus . due to the efficient vectorization algorithms of matlab ,",
    "the calculation of the periods with optimal accuracy takes only a second even for genus 10 on the used low - end computers .",
    "the limiting factor is here whether the matrix @xmath159 of @xmath17-periods is ill conditioned .",
    "this is the case if a considerable number of the entries of @xmath159 are of the order of the rounding error ( @xmath160 ) .",
    "thus due to the limited number of digits , the inversion of the matrix @xmath159 which is necessary to determine the riemann matrix can only be carried out with reduced accuracy which is independent of the number of polynomials used in the spectral expansion . for large genus",
    ", this becomes the limiting factor in the determination of the riemann matrix .",
    "for instance in the case of the genus 20 surface with branch points @xmath161 $ ] , the identity for @xmath17-periods is satisfied with 32 polynomials up to @xmath162 , the symmetry of the riemann matrix only up to @xmath163 since the matrix @xmath159 is badly scaled .",
    "the calculation of the periods takes less than a second in this case .",
    "the calculation of the theta - functions below is applicable for arbitrary riemann surfaces , it is not limited to the hyperelliptic case .",
    "the theta - series  ( [ theta ] ) for the riemann theta - function ( the theta - function in ( [ theta ] ) with zero characteristic , theta - functions with characteristic follow from ( [ theta2 ] ) ) is approximated as the sum @xmath164 where @xmath165 is a vector in @xmath166 with the components @xmath167 .",
    "we use the periodicity properties of the theta - function ( [ eq : periodicity ] ) to minimize the absolute value of @xmath168 .",
    "the value of @xmath169 is determined by the condition that terms in the series  ( [ theta ] ) for @xmath170 are strictly smaller than some threshold value @xmath171 which is taken to be of the order of @xmath160 . to this end",
    "we determine the eigenvalues of @xmath21 and demand that @xmath172 where @xmath173 is the real part of the eigenvalue with maximal real part ( @xmath21 is negative definite ) .",
    "similar formulas can be obtained for theta - derivatives . for a more sophisticated analysis of theta summations",
    "see  @xcite . in the studied examples we found values of @xmath169 between 2 and 40 .",
    "if the eigenvalues of @xmath21 differ by more than an order of magnitude which can happen close to partial degeneration of the surface , a summation over an ellipse rather than over a sphere in the hypercube @xmath174 , i.e.  different limiting values for the @xmath175 as in  @xcite could be more efficient .",
    "the summation over the hypercube has , however , the advantage that it can be implemented in matlab for arbitrary genus .",
    "in addition it makes full use of matlab s vectorization algorithms outlined below .",
    "thus it is questionable whether a summation over an ellipse would be more efficient in terms of computation time in this setting .",
    "here we made use of matlab s efficient way to handle matrices .",
    "we generate a @xmath176-dimensional array containing all possible index combinations and thus all components in the sum ( [ eq : thetasum ] ) which is then summed . to illustrate this we consider the simple example of genus 2 with @xmath177 .",
    "the summation indices are written as @xmath178-matrices since @xmath179 .",
    "each of these matrices contains @xmath176 copies of the vector with integers @xmath180 .",
    "@xmath181 is the transposed matrix of @xmath182 .",
    "explicitly , we have @xmath183 the terms in the sum ( [ eq : thetasum ] ) can thus be written in matrix form @xmath184 where the operation @xmath185 denotes that each element of @xmath182 is multiplied with the corresponding element of @xmath181 .",
    "thus , the argument of @xmath186 is a @xmath178-dimensional matrix .",
    "furthermore , the exponential function is understood to act not on the matrix but on each of its elements individually , producing a matrix of the same size .",
    "the approximate value of the theta - function is then obtained by summing up all the elements in ( [ eq : thetasum2 ] ) .    the most time consuming operations are the determination of the bilinear terms involving the riemann matrix .",
    "if one wants to calculate solutions to the kp equation , these terms only have to be determined once for a given surface .",
    "the integer @xmath169 is in this case fixed for the largest @xmath187 in the plot .",
    "we note that the summation is very fast even though the used determination of @xmath169 is rather crude .",
    "for instance in the case of genus @xmath188 with @xmath189 , the calculation of the theta - function takes 0.1s on the used computers .",
    "the limiting factor is here the available memory since arrays of the order @xmath190 have to be multiplied with each other . on the used low - end computers we could deal with rather general genus 4 situations , but the limit was reached for genus 6 and @xmath191 .",
    "the summation is still very efficient , the calculation of the bilinear terms and the determination of the coefficients took 16s in the latter case , the subsequent calculation of the linear terms in ( [ eq : thetasum2 ] ) and the summation , which have to be carried out for each value of @xmath168 and @xmath51 , took roughly 4s .",
    "thus the limitations we had to face were not due to the computing time but due to missing memory .",
    "the quality of the theta summation can be checked directly by putting the approximate solution into the differential equation .",
    "the necessary derivatives of the theta - function entering the function @xmath1 and its derivatives can be calculated directly , e.g.@xmath192 where @xmath193 is determined as @xmath169 for the theta - series .",
    "the differential equations could be satisfied to the order of @xmath194 and better .",
    "for the plots in the next section we use an accuracy of the order of @xmath195 .",
    "the error is mainly due to the fact that we did not choose @xmath169 big enough that also the terms in 6th derivative of the form ( [ eq : thetader ] ) are of the order of the rounding error .",
    "for the solution only the second derivative is important .",
    "the accuracy of the solution is thus in general much higher as can be seen for instance in the solitonic example where the differential equation is satisfied to the order of @xmath194 , but the difference to the solitonic solution is smaller than @xmath162 .",
    "in this section we present plots of hyperelliptic solutions to the kdv and the kp equation as examples for the previously discussed code .",
    "such plots can already be found in @xcite and @xcite .",
    "we will show general situations as well as almost degenerate surfaces which are identical to their corresponding solitonic solution up to numerical accuracy . in all plots , the vector @xmath60 in ( [ eq : solution ] )",
    "is chosen to correspond to the characteristic ( [ eq : chars ] ) .",
    "it turns out that almost solitonic solutions take less computational resources .",
    "the calculation of the periods requires the use of more polynomials , but the most time - consuming part is the theta summation . since the diagonal elements of the riemann matrix diverge in this limit , less terms have to be considered in the summation .",
    "the generation of the plots is thus considerably faster than in general position of the branch points .",
    "to begin we want to discuss plots of genus 2 solutions to the kdv equation .",
    "we consider a hyperelliptic surface of the form ( [ eq : hyper2 ] ) with branch points @xmath196 $ ] . in fig .",
    "[ fig : kdv2s ] we show the case for @xmath157 which is identical to the @xmath188-soliton solution within machine precision .",
    "the difference between the shown plot and the solution ( [ eq : sol23 ] ) is actually less than @xmath162 .",
    "the one dimensional waves in shallow water are depicted in dependence on @xmath168 and @xmath51 .",
    "it can be seen that a soliton coming from the right and traveling in negative @xmath168-direction has a collision with a soliton traveling in positive @xmath168-direction . at the collision",
    "the typical phase shift can be observed , otherwise the solitons are unaffected .    in fig .",
    "[ fig : kdv2 ] we show the case @xmath156 .",
    "the almost periodic nature of the solution is clearly recognizable .",
    "the solution can be interpreted as an infinite train of solitons .    to obtain solutions on a surface of genus 6 we considered the surface with the branch points",
    "@xmath197 $ ] .",
    "the situation for @xmath156 is shown in fig .",
    "[ fig : kdv4 ] .",
    "the depicted situation is at the limit imposed by memory on the used computer .    in fig .",
    "[ fig : kdv6s ] we show a solution of genus 6 in an almost solitonic situation .",
    "one can see the collision of 6 solitons at the center of the plot .",
    "a genus 4 solution of the kp equation is shown for fixed @xmath51 on the hyperelliptic surface with branch points @xmath198 $ ] . in fig .",
    "[ fig : kp4 ] we show the almost periodic situation for @xmath156 .    the almost solitonic case with @xmath199 is shown in fig .",
    "[ fig : kp4s ] .",
    "in this article we have presented a scheme based on spectral methods to treat hyperelliptic theta - functions of in principle arbitrary genus numerically .",
    "it was shown that an accuracy of the order of machine precision could be obtained with an efficient code .",
    "as shown , spectral methods are very convenient if analytic functions are approximated . close to singularities such as the degeneration of the riemann surface",
    ", analytic techniques must be used to obtain analytic integrands as in the discussed example .",
    "this made it possible to study the solitonic limit numerically within machine precision .    to consider the case that more than 2 branch points coincide , a higher number of polynomials or additional analytical techniques have to be used .",
    "as shown in i this makes it possible to study the parameter space of hyperelliptic surfaces including almost degenerate cases with at most 512 polynomials with maximal accuracy ( here we used at most 128 polynomials ) .",
    "both the calculation of the periods and the theta summation are very efficient .",
    "the limiting factor for the periods is the finite number of digits ( 16 in matlab ) which leads to a drop of accuracy if the matrix of @xmath17-periods is ill - conditioned .",
    "the theta summation is limited by the available memory .",
    "the presented numerical code is able to treat general hyperelliptic surfaces .",
    "the used method can in principle be extended to more general riemann surfaces if the differentials are known explicitly as e.g.  in the case of @xmath200-curves .",
    "we thank a.  bobenko and d.  korotkin for helpful discussions and hints .",
    "ck is grateful for financial support by the schloessmann foundation ."
  ],
  "abstract_text": [
    "<S> this is the second in a series of papers on the numerical treatment of hyperelliptic theta - functions with spectral methods . </S>",
    "<S> a code for the numerical evaluation of solutions to the ernst equation on hyperelliptic surfaces of genus 2 is extended to arbitrary genus and general position of the branch points . </S>",
    "<S> the use of spectral approximations allows for an efficient calculation of all characteristic quantities of the riemann surface with high precision even in almost degenerate situations as in the solitonic limit where the branch points coincide pairwise . as an example we consider hyperelliptic solutions to the kadomtsev - petviashvili and the korteweg - de vries equation . </S>",
    "<S> tests of the numerics using identities for periods on the riemann surface and the differential equations are performed . </S>",
    "<S> it is shown that an accuracy of the order of machine precision can be achieved . </S>"
  ]
}