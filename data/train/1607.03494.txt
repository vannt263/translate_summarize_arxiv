{
  "article_text": [
    "flares occur on nearly all main sequence stars with outer convective envelopes as a generic result of magnetic reconnection @xcite .",
    "these events occur stochastically , and are most frequently observed on low - mass stars with the deepest convective zones such as m dwarfs .",
    "solar and stellar flares are believed to form via the same mechanism : a magnetic reconnection event that creates a beam of charged particles which impacts the stellar photosphere , generating rapid heating and the emission we observe at nearly all wavelengths .",
    "numerical simulations are now able to describe much of the physics for solar and stellar flares and their effect on a star s atmosphere @xcite .    flare occurrence frequency and event energy are connected to the stellar surface magnetic field strength .",
    "reconnection events on the sun typically occur around a sunspot pair ( or bipole ) or between a group of spots .",
    "surface magnetic field strength deceases over the life a star , due to a steady loss of angular momentum which quiets the internal dynamo @xcite .",
    "older , slowly rotating stars like our sun exhibit smaller and fewer starspots , while young , rapidly rotating stars can produce starspots that are long lived and cover a significant portion of the stellar surface .",
    "flares are known to follow this same basic trend @xcite .",
    "for example , young t tauri systems are known to be highly active with frequent flares @xcite .",
    "maximal flare energies have also been proposed as a means for constraining the age of field stars ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the duration of a star s life that it produces frequent large spots and flares may dramatically affect planetary , atmospheric , and biological processes , and thus impact planet habitability .",
    "this is particularly important for planets around low - mass stars , whose flares can produce extremely high amounts of uv and x - ray flux , and whose active lifetimes are much longer than solar - type stars @xcite . to better understand the impact flares might pose for habitability , @xcite modeled the affect of a single large stellar flare on a earth - like planet s atmosphere . for a single large flare this study found only a short timescale increase in biologically harmful uv surface flux , and full planetary atmosphere recovery within two years",
    "however , due to the possibility of repeated flaring and constant quiescent uv emission , concerns remain about uv flux from active and flaring stars , and their impact on planetary atmosphere chemistry @xcite .",
    "given the variety of possible exoplanetary system configurations , it may also be possible for stellar activity and planetary dynamics to conspire to improve planetary habitability conditions @xcite . while the impact flares have to",
    "planet habitability is an ongoing topic of research , they pose a clear difficulty in exoplanet detection and characterization @xcite .    due to their short timescales and stochastic occurrences ,",
    "generating a complete sample of flares for a single star has been very resource intensive , and has only been accomplished for a handful of active stars .",
    "contrast between flares and the quiescent star is also greatest for cooler stars such as m dwarfs , and has led to fewer flare studies for field g dwarfs .",
    "flare rates for `` inactive '' stars like the sun are largely unconstrained .",
    "however , recent space - based planet hunting missions like _",
    "kepler_@xcite have started to collect some of the longest duration and most precise optical light curves to date .",
    "these unique datasets are ideal for developing complete surveys of stochastic events like flares from thousands of stars , and have begun to revolutionize the study of stellar flares .",
    "for example , @xcite gathered the largest sample of flares for any single star besides the sun using 11 months of _ kepler_data , and used this homogeneous sample to develop an empirical template for single flare morphology . to help characterize the environments of planets found using _ kepler _",
    ", @xcite have investigated the rates of very large flares for 13 stars that host planets near their habitable zones . @xcite",
    "have used _",
    "kepler_data to show a connection between flare rate and stellar rotation in field g dwarfs , in general agreement with activity  age models .",
    "in this paper i present the first automated search for stellar flares from the full _ kepler_dataset .",
    "the flare event sample generated here is unique in carefully combining both long and short cadence data to accurately measure each star s flare rate over the entire _ kepler_mission .",
    "i have also performed extensive flare injection tests for multiple portions of each light curve , quantifying the completeness limits for flare recovery over time .",
    "i demonstrate the utility of this large sample by comparing the flare activity level with stellar rotation and rossby number , which reveals a clear connection between flares and the evolution of the stellar dynamo as stars age .",
    "_ kepler_is a space - based telescope , launched in 2009 as nasa s 10th discovery - class mission , with the goal of constraining the rates of transiting earth - like planets around sun - like stars . achieving this science goal required observing a single large field of view of 115 sq deg with a few parts - per - million photometric accuracy , monitoring @xmath0150,000 stars simultaneously with a fairly rapid cadence , and observing continuously for nearly 4 years . while the exoplanet yield has been wildly successful ( e.g. * ? ? ?",
    "* ) , _ kepler_has been equally fruitful in studying the astrophysics of field stars . for the first time , asteroseismology with _",
    "kepler_has provided information on the internal structure of stars besides our sun , which places powerful constraints on their masses , radii , and ages @xcite .",
    "kepler _ s precision light curves have also enabled stellar rotation to be characterized for tens of thousands of stars @xcite , shedding new light on angular momentum and dynamo evolution .",
    "the unique sample size , light curve duration , and photometric precision makes _",
    "ideal platform for studying stellar flares .",
    "@xcite observed many k and m dwarfs with prominent flare events in the preliminary _ kepler_data release , finding correlations between flare rates , spectral type ( or temperature ) , and quiescent variability levels . defining the rate of large energy `` superflares '' on solar - type stars from _ kepler_is an important aspect for characterizing exoplanet habitability and understanding the early life of the sun @xcite .",
    "flares have been observed across a wide range of spectral types with _",
    "kepler_@xcite , and the details of flare morphology in these data are now an active area of research ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "kepler_observed targets using two cadence modes .",
    "the vast majority of stars were observed using the `` long '' , 30-minute cadence mode , and were observed continuously for most of the _ kepler_mission . a small number of targets were selected for `` short '' , 1-minute cadence observations , often for only a fraction of the _ kepler_mission .",
    "kepler_flare studies to date have focused on the long cadence light curves , which provide the best data for complete samples of large energy events such as superflares .",
    "however , flare occurrence frequency is inversely proportional to the event energy , and short cadence data is critical for detecting smaller energy , shorter timescale events , as well as characterizing the temporal morphology of superflares .",
    "for this study i analyzed every available long and short cadence light curve from the primary _ kepler_mission , obtaining the most recently available version of the quarter 017 light curves , known as data release 24 .",
    "light curves are stored as .fits tables that contain both the simple aperture photometry ( sap ) data , as well as the pre - search data conditioning ( pdc ) de - trended data .",
    "since the pdc light curve de - trending can be affected by the flares being searched for , the sap light curves were used instead , as was done in @xcite . note that additional errors have recently been uncovered in the short cadence data processing , which impact both the sap and pdc data for nearly half of short cadence targets .",
    "the amplitude of these calibration errors is typically small , but since the impact for each affected target is not yet known some caution is urged when interpreting the rates of the smallest energy flares .",
    "future versions of this work will utilize data release 25 when available in late 2016 .    the short and long cadence light curve files were analyzed for every star independently , processing a total of 3,144,487 light curve files from 207,617 unique targets . since the results from each light curve file are totally independent , this analysis was ideal for parallel computing . to facilitate this large number of light curves",
    "i utilized the western washington university computer science department s compute cluster .",
    "this linux - based cluster has 480 cores , and uses the htcondor scheduling system @xcite .",
    "the process of detecting flares in the _",
    "kepler_light curves consists of two steps : 1 ) building a model for the quiescent stellar brightness over the course of the light curve , and 2 ) selecting significant outliers from this model as flare event candidates . all light curves from _",
    "kepler_contain significant systematic variability due to e.g. spacecraft adjustments and calibration errors .",
    "given the high precision of _",
    "kepler_data , astrophysical variability from a variety of physical processes is also observed for many targets on timescales of minutes to days .",
    "this combined systematic and astrophysical variability results in a complex variety of light curve morphologies that must be carefully modeled to accurately detect flares . building this quiescent light curve model for each target , including both long- and short - cadence data ,",
    "therefore is the most difficult component of this endeavor .",
    "the complex , iterative de - trending scheme laid out here has been arrived at from manual experimentation . however , each step in the procedure is designed to remove specific forms of systematic or astrophysical variability .    the entire codebase for this analysis , including all code to generate each figure , is open source and available online .      throughout the description of this procedure",
    "each step is numbered for clarity . * ( 1 ) * first , any data points with the sap_quality flag bits 5 , 8 , or 12 set were discarded , which removed epochs with a reaction wheel zero crossing , cosmic ray in aperture , or impulsive outlier detected when co - trending , respectively .",
    "the light curve modeling approach begins by subtracting long term variations , which are typically due to systematic errors in the data .",
    "each light curve file , consisting of either an entire quarter of long cadence data or one month of short cadence data , is smoothed via the rolling_median filter from the python package pandas @xcite , using a kernel size of 1/100@xmath3 the size of the light curve segment . additionally , a minimum smoothing kernel size is set at 10 data points , which corresponds to 10 minutes for short - cadence or 5 hours for long cadence data . with this heavily smoothed light curve",
    "a 3@xmath4 order polynomial is fit , which is then subtracted from the original light curve .    *",
    "( 2 ) * each light curve is then segmented in to regions of continuous observation , breaking the light curve in to individual portions if there are gaps of data of 0.125 days or larger .",
    "each continuous segment was required to be at least 2 days in duration , and any segment less than 2 days in duration was discarded from analysis .",
    "these sections are the fundamental regions of data for the analysis because the systematic noise properties of the _ kepler_data can change between them due to spacecraft adjustments . as such , the light curve modeling , flare finding , and later the artificial flare injection tests , are all performed on these continuous sections of the light curves .    *",
    "( 3 ) * the light curve modeling approach within these continuous segments of data was arrived at through manual experimentation . within each continuous region",
    "the light curve is smoothed using the same rolling_median filter procedure as for the whole light curve , again with a kernel of 1/100@xmath3 the continuous segment or 10 data points , whichever is larger .",
    "this smoothed light curve segment is fit with a 3@xmath4 order polynomial , which is again subtracted from the original data .    * ( 4 ) * a series of iterative smoothing steps is then preformed to robustly fit the quiescent light curve shape .",
    "a 2-pass smoothing with the rolling_median filter with a 2 day kernel is applied , iteratively rejecting flux values residuals that are more than 5 times the _ kepler_photometric uncertainty or outside of the 5 - 95 percentile of the residual distribution .    *",
    "( 5 ) * using this iteratively smoothed light curve segment , which should have most large amplitude flares _ removed _ , i search for periodic signals in the data that are typically due to starspot modulations ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "i use the lombscarglefast procedure from @xcite to search for periodicity .",
    "the largest significant ( lomb - scargle power @xmath5 0.25 ) peak in the periodogram is first chosen . if present , the sine function corresponding to this periodic signal is subtracted from the smoothed data .",
    "this process is repeated until no significant peak in the periodogram is found , up to a maximum of 5 times .",
    "the search is limited to 20,000 periods spaced logarithmically between 0.1 and 30 days .",
    "this multi - period model approach is similar to that used by @xcite to search for signals of differential rotation in _ kepler_data .",
    "the sine curves fit to this data segment are subtracted from the polynomial - smoothed data from step * ( 3 ) * , which still has flares present .    *",
    "( 6 ) * a 3-pass iterative rolling_median filter approach is then used on the sine - subtracted data , smoothing with a 0.3 day kernel , and iteratively removing outlier points as in step * ( 4 ) * above .",
    "this again removes the largest energy flares from the light curve .    *",
    "( 7 ) * using this smoothed light curve segment , which should have the starspots mostly removed via the sine - fitting and the flares removed from the median filtering , i perform a 10-pass least squares spline fitting . rather than removing data points after each pass ,",
    "the data is iteratively re - weighted ( e.g. see * ? ? ?",
    "* ) using the per - datum @xmath6 statistic multiplied by a penalty factor , @xmath7 , which is set to a very high value of 400 .",
    "this results in outliers that increasingly have less and less weight .",
    "a similar iterative re - weighting least squares ( irls ) approach was described in the de - trending module of the exoplanet data analysis package , bart .",
    "smaller amplitude flares , and the decay phases of larger flares previously removed , are smoothed out at this step .",
    "the final model used to represent the quiescent light curve is defined as the addition of the irls smoothed light curve from step * ( 7 ) * , and the multi - sine component from step * ( 5)*. examples of this model compared with the original data is shown in figure [ fig : lc ] .      the model generated above is then subtracted from the original data in each continuous light curve segment .",
    "i then cross correlated the model - subtracted light curve with a flare profile , using the analytical flare template defined in @xcite .",
    "the flare template is generated with an amplitude arbitrarily set to 1 , and a characteristic timescale @xmath8 of 2 times the local cadence , 60 minutes for long cadence data and 2 minutes for short cadence data . by cross",
    "correlating the model - subtracted data with a flare filter we are effectively taking a matched filter approach in detecting flares against the noisy data .",
    "since the cross correlation smooths the flare events out longer in duration , only flare _ detection _ is performed using the matched filter version of the model - subtracted data , and not flare energy measurements .",
    "candidate epochs belonging to flares are found in this matched filter light curve using a slightly modified version of the findflare algorithm , defined by equations 3a3d in @xcite .",
    "this algorithm chooses candidate flares as consecutive epochs are positively offset from the quiescent model by more than the local scatter in the data , as well as being offset by more than the formal errors , where each of these three criteria is governed by scaling factors .",
    "i found that adjusting the scale factor n3 , defined in @xcite as the number of consecutive points that satisfied the model offset requirements , to n3=2 improved flare recovery for long cadence data and did not negatively impact recovery for short cadence data .",
    "the local scatter within each model - subtracted light curve segment in my implementation of findflare is determined by computing the median of a rolling 7 data point standard deviation . to avoid spurious flare detections due to spacecraft reheating , as well as erroneous de - trending ,",
    "flares are not selected within 0.1 days of the edges of continuous regions of data .",
    "candidate flare events within 3 data points of each other are combined .",
    "every candidate flare event has several statistics measured and saved for future analysis .",
    "these include the start , stop , and peak times of the flare , the maximum amplitude in the original light curve , and the full width at half maximum ( in days ) .",
    "start and stop times of the flare are defined as the first and last epochs that pass the findflare algorithm .",
    "this algorithm can under - report the actual flare duration , typically due to the slow decay portion of the flare being mistaken for the quiescent background .",
    "while the matched filtering approach mitigates this , the flare durations reported are not exact or based on model fits .",
    "the normalized @xmath6 of the flare is then measured , defined as : @xmath9 where @xmath10 is the @xmath11th flux value of the flare ( using the de - trended fluxes ) , @xmath12 is the @xmath11th photometric uncertainty , @xmath13 is the @xmath11th value from the same region of the iterative quiescent light curve model , and @xmath14 is the number of data points contained in the flare .",
    "i also compute the 2d kolmogorov - smirnov ( ks ) statistics for the flare , which defines the probability that the flares and some background sample of data are drawn from the same population .",
    "the ks test is computed for both the flare data versus an equal sized continuum region around the flare , and the flare versus the de - trended quiescent model .",
    "finally i calculate the flare equivalent duration ( ed ) , which is the integral under the flare in fractional flux units .",
    "the ed has units of time ( seconds in this case ) , similar to how equivalent widths of spectral lines have units of wavelength ( e.g. see * ? ? ?",
    "the ed is computed using a trapezoidal sum of the flare data between the start and stop times defined by the findflare algorithm .",
    "the ed s measured above provide a relative energy for each flare event without having to flux calibrate the _",
    "kepler_light curves . as a result",
    "the ed s are robust against the observed variability , both systematic and astrophysical .",
    "the actual energy of the flare emitted in the _ kepler_bandpass ( units of ergs ) can be determined from the ed ( units of seconds ) by multiplying by the quiescent luminosity ( units of erg s@xmath15 ) .    for each star the quiescent luminosity",
    "is estimated in order to place the relative flare energies on an absolute scale .",
    "@xcite accomplish this by assuming blackbody radiation from both the star and flare , as well as a fixed flare temperature of @xmath16 k. however , flare spectra are known to have both non - thermal emission , and changing effective temperatures throughout the event @xcite .",
    "for this reason it better to not assume a single flare spectrum , and instead i estimate the distance and luminosity for each star to determine it s quiescent luminosity .",
    "the kepler input catalog provides ground - based photometry for all available stars in the _ kepler_field of view . using version 10 of this catalog",
    ", i obtained the @xmath17 , @xmath18 , and @xmath19 ( _ kepler _ ) photometry for every star in the sample .",
    "the @xmath20 color is then used to place each star on to a stellar isochrone model , which gives an absolute magnitude and mass for each star .",
    "typical photometric uncertainties from the @xmath20 color propagate to mass uncertainties of @xmath00.02 @xmath21 .",
    "this assumes that all stars in the sample are on the isochrone s main sequence .",
    "a 1-gyr isochrone from the parsec models @xcite with z=0.019 and no dust extinction is used .",
    "note this will yield an incorrect distance for giant and sub - giant stars .",
    "the star s absolute @xmath22 and @xmath19 ( _ kepler _ ) magnitudes are determined by linearly interpolating the observed @xmath23 color to the gridded values from the isochrone .",
    "the apparent @xmath18 magnitude for each star is used to determine the distance modulus .",
    "the isochrone - derived absolute @xmath19 magnitude is finally converted from ab magnitudes to a quiescent luminosity , which is denoted @xmath24 , and is used to convert flare ed s to energies .",
    "the resulting flare energy that is calculated does not correct for the spectrum of the flare through the _",
    "kepler_bandpass , or for the flare energy emitted outside the _ kepler_bandpass , as discussed more in ",
    "[ sec : rot ] .",
    "each continuous section of light curve , defined in step 2 of  [ sec : find1 ] above , has unique properties of both systematic noise and astrophysical variability .",
    "the accuracy of the de - trending in each light curve section is naturally dependent on the local photometric noise and variability .",
    "comparing flare rates from both long and short cadence data requires knowing the flare completeness for both cadences , as the sampling rate strongly affects the smallest detectable flares .",
    "flare recovery efficiency therefore varies between light curve segments , and must be determined within each to accurately characterize the true total flare rate for each star .    given the variable noise and sampling within each light curve , and the iterative approach of the de - trending procedure used in flare finding , the uncertainty in flare finding can not be analytically computed . instead ,",
    "flare recovery efficiency is empirically determined using artificially injected flares .",
    "this is analogous to the work of @xcite , who robustly tested the efficiency in detecting planetary transits from _ kepler_data using artificially injected transits .",
    "unlike @xcite i do not utilize the pixel - level data , and instead inject flares directly in to the raw sap_flux light curves .",
    "the temporal profile of the artificial flares is the empirical flare model determined in @xcite .",
    "the analytic form of this model ( their equations 1 and 4 ) describes the flare shape using three free parameters : the impulsive timescale @xmath8 , the flare s peak amplitude , and the time of flare maximum @xmath25 . within each continuous light curve segment",
    "100 fake flares are injected .",
    "the @xmath25 times for the artificial flare events are spaced randomly throughout the quiescent , non - flaring portions of each light curve segment .",
    "each set of 100 fake flares have @xmath8 timescales chosen randomly in the range @xmath26 minutes , and amplitudes between 0.1 and 100 times the median photometric error of the respective light curve segment . while @xcite show their empirical flare model can be used to identify and decompose complex , multi - peaked flare events , only classical single - peaked events are injected for the artificial flare tests here .",
    "the decay phase of the injected flares may partially overlap real or other artificial flares , and as such may create serendipitous complex events .    the light curve segment with added fake flares",
    "is then processed using the same iterative de - trending and flare - finding algorithm from  [ sec : find1 ] and [ sec : find2 ] , respectively .",
    "artificial flares are considered recovered if the flare peak time is contained within the start and stop times of any resulting flare event candidates . for this study",
    "i do not keep track of how accurately each artificial flare was recovered , either in duration or event energy .",
    "a detailed analysis of the flare energy recovery will be used for evaluating and improving future versions of the code .    the fraction of recovered flares as a function of energy is then computed for each light curve segment .",
    "simulated flares are binned as a function of the event energy , using 20 bins of equivalent duration ( ed ) .",
    "the locations of these bins were not fixed , and varied between light curve segments due to the simulated flare amplitudes being a function of the local photometric uncertainty .",
    "examples of the recovery fraction for two light curve segments for the m dwarf gj 1243 ( kic 9726699 ) are shown in figure [ fig : fake1 ] .",
    "the recovery fraction is then smoothed using a wiener filter with a kernel of 3 ed bins , and from this smoothed version the 68% and 90% flare recovery ed is measured for each light curve segment .",
    "these local ed limits are saved along side each recovered flare for use as completeness limits in later analysis . in cases",
    "where the 68% or 90% recovery rate is not met , a value of -99 is saved for these limits .",
    "in this section i describe the flare sample , including selecting high probability flare event candidates from each light curve , and how to combine both the long and short cadence data to determine robust flare rates .",
    "this analysis of every short- and long - cadence light curve from the _ kepler_mission produced 2,304,930 flare event candidates .",
    "this large number of events includes event candidates below the 68% completeness threshold for each light curve segment , spurious detections of non - flares that the iterative de - trending and flare finding algorithm did not remove , and may have detections of real brightening events that are not flares .",
    "the distribution of total number of flare event candidates per star is shown in figure [ fig : flarehist ] .",
    "this distribution reveals that most stars have very few flare event candidates , e.g. only 8149 stars have 25 or more candidate flare events in their light curves .",
    "stars with very few flares are likely to be spurious detections .        given the large number of light curves and flare events the entire sample could not be manually validated .",
    "instead , further selection criteria was imposed on the sample to analyze only likely flare stars .",
    "specifically each star in the flare rate analysis was required to have :    * at least 100 total flare event candidates ; * at least 10 flare event candidates with energies above the local 68% completeness threshold ;    note that these criteria are conservative and will exclude stars with a small number of significant flare detections throughout their light curves .",
    "the kepler input catalog @xcite does provide an estimate of each _ kepler_target s surface gravity ( @xmath27 ) , which nominally could be used to remove any giants or sub - giants from the sample .",
    "however , this @xmath27 estimate has been shown to be unreliable for many stars .",
    "i carried out the final analysis including both a cut @xmath28 and with no cut on @xmath27 .",
    "the population statistics explored in the following sections were not strongly affected by this cut , but several known dwarf flare stars from @xcite were erroneously tagged as giants and removed .",
    "therefore i opted to not include the @xmath27 cut in the final analysis , but note the sample may include some targets that are not bona fide dwarf stars .",
    "horizontal bars show the range of color within each bin .",
    "vertical uncertainties shown are computed using the 1-@xmath29 ( 68% ) binomial confidence interval .",
    "a general , but weak trend of increasing total flare occurrence with decreasing stellar temperature ( redder @xmath2 ) is seen .",
    ", width=312 ]    the final sample of flare stars included 4041 targets , or 1.9% of the stars in the _ kepler_data , that passed these selection criteria , with a total of 1,390,796 flare event candidates recovered .",
    "from these candidates , 851,168 events ( 61% ) had energies over the local 68% recovery threshold determined from the artificial flare injection tests in  [ sec : fakeflares ] .",
    "summary statistics for all 4041 stars in this final sample are provided in table [ tbl : datatable ] .",
    "figure [ fig : nvsgi ] shows the fraction of _ kepler_stars that have detected flares from the final sample of 4041 stars in bins of @xmath2 color , which is a proxy for stellar temperature @xcite .",
    "the overall fraction of flare stars in the sample ( 1.9% ) agrees well with total rates from previous studies of _ kepler_data , e.g. 1.6% from @xcite .",
    "a general trend of increasing rates of flare stars with decreasing stellar mass ( redder @xmath2 color ) is seen . flaring",
    "m dwarfs , seen in the reddest two color bins make up 2.1% of the m dwarfs in the _ kepler_field .",
    "the large , asymmetric uncertainties on flare star occurrence rates in figure [ fig : nvsgi ] are calculated using the 1-@xmath29 ( 68% ) confidence interval from the binomial distribution ( e.g. see * ? ? ?",
    "these are consistent with the confidence intervals that would be computed from previous _ kepler_studies of flare star occurrence rates .",
    "the average flare energy detected in the sample is @xmath30 erg , very close to the @xmath31 erg reported as the average f star flare energy by @xcite .",
    "figure [ fig : maxcolor ] shows the highest energy flare recovered as a function of stellar @xmath2 color for each star in the final sample .",
    "the striping seen is due binning of the flare energy .",
    "this binning is used to keep track of flare rates between light curve segments and for comparing flare energies between stars . for comparison ,",
    "the sun has a @xmath2 color of @xmath00.6 , and a maximum observed flare energy of @xmath0@xmath32 erg @xcite . assuming this is the _ maximum _ flare energy the sun is currently capable of producing , a dearth of objects with similarly low activity levels is recovered in this sample .",
    "the sample does contain , however , many g dwarfs that produce super flares .",
    "most g dwarfs show a peak flare energy of @xmath33 erg , consistent with the maximum flare energy found by @xcite .",
    "however , the highest energy flares in the sample appear to be nearly two orders of magnitude larger than this limit .",
    "note that dust extinction has not been accounted for in the broadband color isochrone - fitting approach for determining the quiescent luminosities .",
    "dust has the effect of making star appear fainter , and thus the distance becomes over - estimated .",
    "this may be why larger flare energies are found than in previous studies such as @xcite .",
    "the gaia mission @xcite will provide vastly improved distance estimates for nearly all of these nearby stars , which will help determine the true maximum flare energy observed by _",
    "kepler_.     color for the 4041 stars in the final sample .",
    "the discretization of flare energies , apparent as `` stripes '' in flare energy in the figure , is due to binning of the flare sample used to combine flare rates between light curve segments .",
    ", width=336 ]      flare rates for stars and the sun have long been described using the cumulative flare frequency distribution ( e.g. * ? ? ?",
    "the `` ffd '' is preferred because flares occur stochastically and span many orders of magnitude in energy and duration .",
    "flare frequency is typically modeled with a power - law function , which shows many small energy flares and very few large energy events . in the the case of the sun this power - law",
    "is traced over @xmath08 orders of magnitude in observed flare energy @xcite .",
    "for all 4041 stars in the final sample a ffd is generated .",
    "unlike @xcite and references therein , i do not produce combined flare frequency distributions for aggregates of stars within spectral type bins , and instead study each star individually .",
    "figure [ fig : ffd ] shows two examples of ffds for previously known _",
    "kepler_flare stars .    correctly combining data from different continuous light curve segments ( including long- and short - cadence data ) to make",
    "a single ffd is non - trivial .",
    "the varying completeness limits and noise properties mean each light curve segment can potentially probe different flare energy regimes .",
    "the artificial flare injection tests allow us to analyze only the range of energies that each light curve segment can detect .",
    "any effort to search for changes in flare rates over time must take this varying efficiency in to account , or non - physical turnovers or breaks in the ffd may appear .    for each month of short - cadence or quarter of long - cadence data",
    "i compute a ffd that is truncated at the low energy end by the average of the local 68% flare recovery limits defined within that portion of the light curve .",
    "these are shown in the two examples in figure [ fig : ffd ] color - coded by cadence type . to combine data from these different cadence modes ,",
    "every ffd is sampled at a fixed set of energies using log - uniform bins of @xmath34 erg .",
    "the mean flare rate is computed in each ffd bin that has _ any _ valid data ( flares above the 68% completeness threshold ) .",
    "this result in a single ffd for each star , which is overlaid for the two examples in fig [ fig : ffd ] .",
    "uncertainties in the flare frequency in this combined ffd are computed for each energy bin using the asymmetric poisson confidence interval approximations from @xcite .",
    "each combined ffd is then fit with a weighted least squares power - law , and the coefficients saved for future ensemble analysis .",
    "the ffd for the highly active , rapidly rotating m4 dwarf , gj 1243 , has been previously studied using _",
    "kepler_data @xcite .",
    "these studies have found a constant power law slope describes the ffd up to energies of @xmath35 erg using only the short - cadence _ kepler_data . in figure",
    "[ fig : ffd ] i find this power - law extends more than an order of magnitude higher in energy due to the addition of studying the 14 quarters of long cadence data .",
    "unfortunately the iterative flare finding algorithm does not sufficiently recovery flares with energies lower than @xmath36 erg for gj 1243 . the break in the power - law reported in the human - validated sample from @xcite below @xmath37 erg can therefore not verified .",
    "the ffd for the flaring g dwarf , kic 11551430 , shows a remarkable rate of super - flares of nearly 1 per day in the analysis .",
    "the highest energy flares for this star are in excess of @xmath38 erg .",
    "interestingly , the weighted least squares power - law fit to the ffd for kic 11551430 in figure [ fig : ffd ] shows a significant deviation from a single power - law at the high energy end .",
    "such a break has been suggested for super flare stars previously @xcite , and lends weight to the indication by @xcite of a maximum flare energy around @xmath39 erg for g dwarfs .",
    "rotation is directly linked to the generation and strength of stellar magnetic fields .",
    "stars lose angular momentum as they age via magnetic braking , which in turn decreases the strength of the stellar magnetic dynamo over time .",
    "this age  rotation ",
    "activity connection was first illustrated by @xcite . as a result",
    ", the use of rotation periods to infer or constrain stellar ages has recently become popular ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the decay in magnetic field strength with stellar rotation evolution has also been explored using various magnetic activity indicators .",
    "@xcite , for example , measured a decrease in the x - ray luminosity as low mass stars spun down , demonstrating a clear connection between the magnetically driven coronal activity and stellar rotation .",
    "similar decay profiles of chromospheric activity with rotation have been observed using indicators such as h@xmath40 line emission strength @xcite .",
    "flares are a highly localized manifestation of stellar surface magnetic fields .",
    "the evolution of stellar flare rates and properties with stellar rotation has been explored with limited ground - based flare samples @xcite .",
    "recent work with _",
    "kepler_flares has indicated a decreasing rate of superflares for solar - type stars with increasing rotation periods @xcite .",
    "total flare frequency for _ kepler_g , k , and m dwarfs that _ have _ superflares has also been shown to decay with slowing stellar rotation @xcite . though a detailed analysis of flare rates with stellar age is beyond scope of this paper , in this section i will point out interesting trends with rotation seen in this sample .    to compare flare rates between stars , the information content within the ffd must be reduced from the two parameters in the power - law fit to a single quantity that describes the star s total flare activity level .",
    "such a metric can be constructed in varying ways .",
    "for example , the cumulative rate of flares per day ( vertical axis in fig [ fig : ffd ] ) could be measured at a fixed , standard energy .",
    "while this standardized flare rate metric is not used for the analysis shown here , it is briefly described here for use in future ensemble flare studies . using the average flare energy from the _ kepler_sample presented here",
    ", a benchmark flare rate could be evaluated at @xmath1 erg for all stars .",
    "the interpretation of this rate is simple and potentially useful for observers , and its measurement benefits from the careful investigation of flare completeness for each star described in  [ sec : fakeflares ] .",
    "however , there are several important limitations in measuring such a quantity .",
    "many stars do not exhibit flares at this particular energy , either for their rarity at such high energies ( e.g. flaring m dwarfs ) , or from faint stars where only the largest super flares are detected .",
    "the power - law_fit _ to the ffd can be evaluated at this benchmark energy , extrapolating the flare rate estimation beyond the observed energy range .",
    "however the accuracy of this fit flare rate is limited due to the possible presence of significant breaks in the ffd power - law shape as shown in figure [ fig : ffd ] at the high energy end , or by @xcite at lower flare energies .",
    "also , errors in the quiescent luminosity calculation for each star due to factors like interstellar dust correction and isochrone fitting will impact the flare energy estimates , possibly giving inaccurate flare rates at the specified standard energy .",
    "+       instead , the total fractional flare luminosity in the _ kepler_bandpass , @xmath41 , is used to characterize each star s flare activity level .",
    "this quantity was previously introduced in @xcite to compare the flare yields from the two members of a wide m+m dwarf binary system observed with _ kepler_.",
    "this metric is calculated by summing up all the flare equivalent durations for each star , and gives the relative luminosity a star produces in flares across the _ kepler_bandpass within the observed energy range .",
    "this quantity has the advantage of being easily calculated without the need for flux calibrating the light curve or assuming a stellar distance , and is qualitatively similar to other classical indicators of stellar magnetic activity , such as @xmath42 and @xmath43 .",
    "note that this quantity could be normalized to the stellar bolometric luminosity , by computing @xmath44 .",
    "generating this normalization would be analogous to the creation of the `` @xmath45 factor '' used to convert h@xmath40 equivalent widths in to @xmath43 .",
    "the h@xmath40 @xmath45 factor accounts for the changes in the spectral continuum shape and contrast between stars of different spectral types .",
    "a comparable `` flare @xmath45 '' to convert @xmath41 in to @xmath46 would require both a correction for the stellar spectrum across the _",
    "kepler_bandpass , as well as an estimation of the spectral energy distribution of the flare throughout the event .",
    "this latter term requires a unified model of white light emission for both simple ( single - peaked ) and complex ( multi - peaked ) stellar flares @xcite .",
    "the uncertainty for @xmath41 is calculated by adding in quadrature the uncertainties on the equivalent duration from every flare .",
    "this uncertainty on equivalent duration for each flare is computed as : @xmath47 where ed@xmath48 is the flare s equivalent duration , and @xmath49 the number of data points contained in the flare .",
    "the @xmath6 here is the typical reduced goodness - of - fit metric computed for each flare in equation [ eqn : chisq ] . in this way , which may be counter - intuitive , larger values of @xmath6",
    "indicate _ more _ certainty in flare detection , and in turn yield a smaller error on the total @xmath41 computed for a star .    from the final sample of 4041 flare stars , 402 targets had rotation periods of at least 0.1 days measured from the ensemble analysis of @xcite .",
    "these rotation periods were determined using the auto - correlation function , which is less prone to detecting period aliases as compared to lomb - scargle approaches .",
    "these periods have been well vetted , and compared against independent measures of rotation in the _",
    "kepler_data @xcite .",
    "additionally , the sample of stars with reported rotation periods from @xcite are not known to have significant contamination from giant stars . while the de - trending and flare detection algorithm featured in this work (  [ sec : find1",
    "] ) does fit sine curves to the the continuous portions of the light curve , at present it does not report a characteristic period for each object .",
    "future work with updated version of the algorithm and newer releases of _ kepler_data will investigate the possible correlation between the @xcite rotation periods and the periods determined by this de - trending algorithm .    in figure",
    "[ fig : ratecolor ] i show the relative flare luminosity versus rotation period for the 402 stars with valid periods , separated in to six bins of the stellar @xmath2 color .",
    "using table 4 from @xcite , these @xmath2 color bins correspond to spectral type ranges of g0g8 , g8k2 , k2k5 , k5m0 , m0m2 , and m2m4 , respectively . in total 357 stars fall within the color bins shown in figure [ fig : ratecolor ] .",
    "there were 45 additional objects with kic colors bluer than @xmath50 , i.e. with spectral types of a and f. while it is surprising to detect flares or flare - like events from such early type stars given their lack of deep convection zones , they have been reported previously in the _ kepler_data @xcite .",
    "the earliest spectral type ( bluest ) bin in figure [ fig : ratecolor ] shows only a weak correlation between relative flare luminosity and stellar rotation period . the large scatter in this diagram , especially for the stars with very high levels of flare activity",
    ", may be due to outliers in the sample from binary stars , or stars with anomalous flare - like events as seen in the a and f stars noted above .",
    "however , stars in this mass range with rotation periods less than @xmath010 days are also considered to be in the `` super - saturated '' dynamo regime ( e.g. * ? ? ?",
    "stars with saturated dynamos have a high level of magnetic activity , and show a decoupling between magnetic activity indicators and their rotation periods .",
    "the mechanism behind the observed magnetic activity saturation is debated .",
    "given the lack of g dwarfs with long rotation periods in @xcite , and thus in the sample of 402 stars presented here , it is not clear that any strong or coherent evolution in flare activity with rotation should be expected for this bluest bin .        for stars with @xmath51 ( spectral types later than approximately g8 ) in figure [ fig : ratecolor ] , a significant trend in flare activity is seen with rotation period . a saturation - like regime is seen at short periods , and power law decay for rotation periods longer than @xmath01 day . for stars in the reddest bin ( @xmath52 , spectral type m2m4 ) , the paucity of targets with very short rotation periods means only a power law decay is observed .",
    "there are too few stars with spectral types later than m4 to investigate the evolution of flare activity with rotation across the `` fully convective boundary '' .",
    "this form of saturation and decay profile of magnetic activity has been observed using several other metrics .",
    "x - ray luminosity for low - mass stars saturates at rotation periods of a few days @xcite .",
    "ultraviolet excess emission appears to follow x - ray luminosity for young stars , with a similar saturation regime @xcite .",
    "stellar activity indicators are often compared between low - mass stars with a range of masses by normalizing the rotation period to a dimensionless rotation indicator .",
    "the rossby number is commonly used for this purpose , and is defined as ro = p@xmath53 , where @xmath54 is the ( model derived ) convective turnover timescale that is a function of stellar mass .",
    "in this way rossby number gives a mass - independent metric for the star s rotation , which is useful for comparing to manifestations of magnetic activity .",
    "for example , @xcite have investigated superflare rates in _",
    "kepler_as a function of rossby number .",
    "masses for stars in the final flare sample presented here are determined using the isochrone fits described in  [ sec : find3 ] .",
    "the @xmath54 values are computed using eqn .",
    "11 from @xcite , which are then used to convert rotation periods from @xcite in to rossby number .    in figure",
    "[ fig : rossby ] i present the relative flare luminosity as a function of rossby number for stars with spectral types later than g8 .",
    "a clear decay in flare activity with increasing rossby number ( or rotation period ) is seen .",
    "following other studies of activity evolution with rossby number ( e.g. * ? ? ?",
    "* ) , a simple piecewise model can be used to fit the data in figure [ fig : rossby ] , with a constant ( flat ) level of activity up to a critical rossby number , and a single power law decay for larger values of ro .",
    "the data in figure [ fig : rossby]were fit using this piecewise function and a weighted least squares fitting routine , yielding saturated relative flare luminosity , critical rossby number , and power law slope values of : @xmath55_{\\rm sat } = & -2.99 \\pm 0.03 \\notag \\\\",
    "\\rm{ro_{sat } } = & 0.036 \\pm 0.004 \\notag \\\\",
    "\\beta = & -0.97 \\pm 0.06 \\end{aligned}\\ ] ] respectively .",
    "the critical rossby number separating the saturated and decay regimes of ro@xmath56 is much smaller than the typical value of 0.1 found using x - ray activity , indicating stellar flares become coupled to a star s angular momentum evolution _ sooner _ than the coronal x - ray emission @xcite .",
    "@xcite point out that the saturation threshold rossby number is not universal among chromospheric and coronal activity indicators , and that @xcite find a break as low as ro@xmath00.08 using ca ii emission .",
    "the power law decay in flare luminosity shown in figure [ fig : rossby ] is slower than for x - ray luminosity or @xmath57 , which typically is found to decay with a power law slope of @xmath58 @xcite .",
    "a similarly shallow decay with rossby number of @xmath59 was indicated for chromospheric h@xmath40 emission in two open clusters by @xcite .",
    "flare activity has been suspected as a cause for the heating of both the stellar chromosphere and coronae @xcite , and flares have repeatedly been shown to be a probable cause of quiescent coronal emission ( e.g. * ? ? ?",
    "the similar evolution of h@xmath40 emission and flare activity found in this work is further suggestion towards a connection between flares and chromospheric heating .    the data in figure [ fig : rossby ]",
    "can also be fit using a single power law decay , with no saturation regime . using this model a power law decay slope of @xmath60 is found .",
    "this single power law has nearly the same quality of fit as broken power law model using the reduced @xmath6 parameter .",
    "the bayesian information criterion ( bic ) can be used to determine which model is preferred by penalizing additional degrees of freedom or parameters in the model . a more complicated model is typically preferred if the bic improves by at least 2 .",
    "i calculated the bic for both the single and broken power law models as : bic = @xmath61 , where @xmath62 is the number of free parameters in the model and @xmath63 the number of data points contained in figure [ fig : rossby ] .",
    "the broken power law model had a bic value 6% _ larger _ than the single power law , indicating the simpler model is slightly preferred for this data .",
    "interestingly , when each sub - sample shown in figure [ fig : ratecolor ] is fit with these two models , the picture becomes less clear .",
    "the broken power law model is preferred by from the bic for the two bluest ( highest mass ) samples , while the single power law model is slightly preferred for the reddest two ( lowest mass ) samples . as the statistical errors on @xmath41 are far smaller than the scatter shown in figures [ fig : ratecolor ] or [ fig : rossby ] , it is not clear if the change in flare activity with ro can be described by either the single or broken power law model for all stars .",
    "i have presented a homogeneous search for stellar flares using every available light curve from the primary 4-year _ kepler_mission .",
    "a final sample of 4041 flare stars was recovered , with 851168 flare events having energies above the locally determined completeness limit .",
    "this analysis included extensive completeness testing , using artificial flare injection and recovery tests throughout each light curve to determine the flare recovery efficiency as a function of time .",
    "while these tests provide a robust and straightforward means to estimate the event recovery efficiency , they currently do not estimate how accurately artificial flare event energies were reproduced .",
    "future improvements to the flare finding algorithm could keep track of the recovered energy and duration for every simulated flare .",
    "the light curve de - trending algorithm may also be simplified by using more advanced techniques , such as continuous autoregressive moving average - type models to describe the many forms and timescales of variability at once ( e.g. * ? ? ?",
    "* ) .    as a demonstration , in figure [ fig : ffd ]",
    "i have shown one example of a deviation or break from a single power law in flare occurrence at large flare energies .",
    "however , many other active stars show similar breaks at large flare energies in this sample . a systematic follow - up study of ffds is needed to determine if this break is common among young solar - type or low - mass stars , which will be impact detailed studies of superflare occurrence .",
    "the maximum flare energies recovered in this work are also much higher than previous studies , with a small number of stars in figure [ fig : maxcolor ] exhibiting up to @xmath64 erg events .",
    "these events may be the result of errors in either the light curve de - trending leading to spurious flare events , or the quiescent luminosity determination yielding incorrect energies for real events .",
    "note also that small offsets between flare energies calculated with short- and long - cadence data are seen , as in figure [ fig : ffd ]",
    ". this may be largely an effect of the respective light curve sampling ( e.g. see * ? ? ?",
    "* ) .    from the final sample of 4041 flare stars ,",
    "402 were found to have published rotation periods from @xcite .",
    "a striking evolution of flare activity with stellar rossby number is seen .",
    "this evolution includes a possible saturated flare regime for rapidly rotating ( low rossby number ) stars , and power - law decay that is qualitatively similar to previous results for chromospheric h@xmath40 emission .",
    "the tentative discovery of a flare saturation regime gives credence to the model of magnetic activity reaching a peak level due to a maximum filling factor of small scale active regions on the surface @xcite .",
    "however , the rossby saturation limit ( ro@xmath65 ) and the power - law decay slope do not match expected values from most previous studies of magnetic activity saturation and evolution . since the sample of flare stars is biased more towards k and m dwarfs than most studies of coronal or chromospheric saturation , the smaller ro@xmath65 value may indicate lower mass stars have different saturation limits than solar - type stars @xcite .",
    "alternatively , this result may indicate flare activity traces a fundamentally different component of the stellar surface magnetic field .",
    "the connection between white light flares , chromospheric emission , coronal heating , and the generation of the magnetic dynamo clearly deserves further observational investigation . given the varied dependance on rossby number that these related manifestations of magnetic activity have shown , the dependence of rossby number as the fundamental metric for tracing dynamo evolution is uncertain @xcite .    the large sample of flares observed by _ kepler_enables a new generation of statistical studies of magnetic activity",
    "this may yield power advances in constraining stellar ages via flare rates or maximum flare energies , known as `` magnetochronology '' .",
    "the uniformity of flare activity evolution can be tested using wide binary stars or stellar clusters , many of which are being observed by the _ kepler_and k2 missions . beyond the total flare activity levels for ensembles of stars , the temporal morphology of individual flare events may shed new light on the formation of `` classical '' versus `` complex '' , multi - peaked flares , as discussed by @xcite , @xcite , and @xcite . modeling the detailed structure of these complex events will help in detecting rare `` quasi - periodic pulsations '' in flares @xcite . finally , the statistical knowledge we gain from _",
    "kepler_will enable more accurate predictions of flare yields from future photometric surveys .",
    "i wish to thank austin c. boeck , riley w. clarke , and jonathan cornet for their help in manually inspecting several flare light curves in the creation of this codebase .",
    "suzanne l. hawley and kevin r. covey provided invaluable discussions of magnetic activity , and feedback that greatly improved this work .",
    "i thank d. foreman - mackey and d. hogg for making their various light curve de - trending algorithms publicly available , and for their extensive discussions and resources on using statistics in astrophysics .",
    "special thanks to the anonymous referee whose comments greatly improved this manuscript .",
    "lccccccccc 10000490 &  & 1.38 &  & 241 & 45 & 4.31@xmath66 & 1.48@xmath67 & 18.83 & -0.55 + 10001145 & 0.013 & 1.60 &  & 271 & 61 & 5.18@xmath66 & 1.43@xmath68 & 48.85 & -1.40 + 10001154 & 1.404 & 0.72 &  & 118 & 115 & 1.43@xmath66 & 1.64@xmath68 & 17.34 & -0.56 + 10001167 & 1.151 & 0.77 &  & 147 & 131 & 7.24@xmath66 & 2.67@xmath68 & 12.79 & -0.41 + 10002792 & 1.393 & 0.73 & 1.165 & 225 & 210 & 4.10@xmath69 & 3.38@xmath67 & 16.81 & -0.52 + 10002897 & 0.079 & 1.49 &  & 155 & 146 & 6.35@xmath66 & 4.56@xmath67 & 11.18 & -0.28 + 10004510 & 1.449 & 0.71 & 1.373 & 142 & 128 & 7.23@xmath69 & 2.40@xmath67 & 13.82 & -0.43 + 10004660 & -0.252 & 1.88 &  & 135 & 68 & 2.19@xmath66 & 6.49@xmath70 & 64.71 & -1.83 + 10005966 & 1.318 & 0.74 &  & 175 & 143 & 3.26@xmath66 & 1.27@xmath68 & 25.21 & -0.79 + 10006158 & 1.184 & 0.77 &  & 279 & 237 & 5.61@xmath66 & 1.40@xmath68 & 27.63 & -0.85 [ tbl : datatable ]"
  ],
  "abstract_text": [
    "<S> a homogeneous search for stellar flares has been performed using every available _ kepler_light curve . </S>",
    "<S> an iterative light curve de - trending approach was used to filter out both astrophysical and systematic variability to detect flares . </S>",
    "<S> the flare recovery completeness has also been computed throughout each light curve using artificial flare injection tests , and the tools for this work have been made publicly available . </S>",
    "<S> the final sample contains 851,168 candidate flare events recovered above the 68% completeness threshold , which were detected from 4041 stars , or 1.9% of the stars in the _ kepler_database . </S>",
    "<S> the average flare energy detected is @xmath0@xmath1 erg . </S>",
    "<S> the net fraction of flare stars increases with @xmath2 color , or decreasing stellar mass . for stars in this sample with previously measured rotation periods , </S>",
    "<S> the total relative flare luminosity is compared to the rossby number . </S>",
    "<S> a tentative detection of flare activity saturation for low - mass stars with rapid rotation below a rossby number of @xmath00.03 is found . a power law decay in flare activity with rossby number </S>",
    "<S> is found with a slope of -1 , shallower than typical measurements for x - ray activity decay with rossby number . </S>"
  ]
}