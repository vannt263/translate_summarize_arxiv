{
  "article_text": [
    "r3.0 cm      [ [ problem - statement - and - results ] ] problem statement and results + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we consider the partition of the @xmath0-dimensional cube into axis - parallel @xmath0-dimensional hyper - rectangles ( or boxes ) with disjoint interiors which we call _ hyper - rectangular partitions_. the dual complex of such a partition is an abstract simplicial complex of dimension @xmath0 and represents the connectivity of the boxes in the partition , possibly after a slight distortion if more than @xmath1 boxes meet in a common point .",
    "each vertex of the dual represents a box of the partition .",
    "we pose the question of whether a partition permits a `` nice '' drawing of its dual in @xmath2 .",
    "we impose three conditions for niceness : first of all , the drawing must be straight , that is , a face must be drawn as the convex hull of the vertices that are on its boundary .",
    "that means that the drawing is completely determined by the positions of the vertices .",
    "second , we disallow improper intersections of faces ; for instance , edges are not allowed to cross except at their endpoints .",
    "the first two conditions can be summarized to that the drawing must yield a simplicial complex in @xmath2 .",
    "the final condition is that each vertex must be placed in the box that it represents ; that guarantees some minimal amount of geometric closeness between a primary cell of the partition and its dual counterpart .",
    "if a drawing with these three conditions is possible , we call it an _ embedding_. see the figure on the right for an illustration of a rectangular partition in @xmath3 and an embedding of its dual .",
    "we will see that not every hyper - rectangular partition permits an embedding of the dual , so a natural question to ask is how fast can the existence of an embedding be decided for a given partition .",
    "our first main contribution is to show that this decision problem is np - hard already in the planar case .",
    "more precisely , we restrict to the case that the boxes of a partition and the vertices of the dual are snapped to a uniform grid , and we prove that the problem is np - complete under this constraint ; see section  [ sec : np ] for the precise statement .",
    "the most natural choice for placing a vertex of the dual ( for arbitrary dimension @xmath0 ) is the center of the corresponding box .",
    "we call a partition _ center - embeddable _ if this vertex placement extends to an embedding of the dual . for instance , if all boxes are @xmath0-dimensional cubes of same size , the partition is center - embeddable because its dual is simply a triangulation of the uniform grid defined by the box centers .",
    "we ask for simple , but less restrictive sufficient conditions on a partition to be center - embeddable .",
    "we call a partition _ @xmath4-balanced _",
    "( with @xmath5 ) , if for any intersecting pair of boxes , the ratio of the longest side of the boxes divided by the shortest side of the boxes is at most @xmath4 .",
    "as our second main contribution , we investigate the relationships between @xmath4-balanced and center - embeddable partitions : in the planar case , we show that center embeddability is guaranteed if the partition is @xmath6-balanced , for any @xmath7 .",
    "however , in @xmath8 ( and higher dimensions ) we can construct a @xmath9-balanced partition that is not center - embeddable .",
    "the situation changes if we restrict to _ cubical partitions _",
    ", consisting only of @xmath0-dimensional cubes : in this case , @xmath6-balanced partitions are center - embeddable in @xmath8 , and we can construct a cubical @xmath4-balanced partition in @xmath2 that is not center - embeddable for any @xmath10 .",
    "it remains open whether cubical @xmath4-balanced partitions with @xmath11 are center - embeddable in dimensions larger than @xmath12 .    [ [ related - work ] ] related work",
    "+ + + + + + + + + + + +    rectangular partitions in @xmath3 have a lot of applications , for instance in vlsi design  @xcite , cartography  @xcite , and database - related applications  @xcite ; we refer to the survey by eppstein  @xcite for more examples . in this context",
    ", rectangular partitions sometimes appear as the _ rectangular dual _ of a triangulated planar graph .",
    "linear - time algorithms have been presented for the computation of such a rectangular dual  @xcite .",
    "our situation , however , is different as the rectangular partition is the input object and we ask for a straight - line embedding of its dual where the vertices are constrained to lie inside rectangles .",
    "this can be seen as an instance of planar graph embedding with constraints ; np - hardness has been shown for other constraints , such as when fixing the length of each edge  @xcite , and , more related to our approach , when restricting the placement of each vertex to a disc  @xcite .",
    "furthermore , the problem of simultaneously embedding a planar graph and its dual on the integer grid has received some interest , e.g.  @xcite .",
    "most related to our approach is the variant where the embedding of the primal graph is fixed and an embedding of the dual is sought for , such that only primal - dual pairs of edges intersect .",
    "bern and gilbert  @xcite show that the problem is linear - time solvable if all faces are convex and four - sided , and becomes np - hard for convex five - sided faces .",
    "the latter is proven with a reduction from planar 3sat and is similar to the proof presented in this work . however , although rectangular partitions can be seen as planar graphs with convex faces , there is no direct reduction from our problem because we allow the dual graph to intersect the partition arbitrarily , not just at primal - dual pairs .",
    "the higher dimensional equivalent of rectangular partitions ( and their dual complexes ) apparently has not been investigated from a theoretical point of view .",
    "our motivation for this topic is originated in the approximation and simplification of @xmath0-dimensional image data  @xcite .",
    "the idea is to identify rectangular regions in which the image looks `` similar '' .",
    "in the simplest case , similarity means that the image values inside a region are similar , but different measures can be defined .",
    "the regions define a hyper - rectangular partition which can consist of substantially less elements than the original @xmath13 image cells . in some situations ,",
    "a piecewise linear approximation of the image is required , e.g. , for computing a level set of the image .",
    "standard techniques like bilinear interpolation can not be applied because the non - uniformity of the partition leads to discontinuities ; see  @xcite for a discussion with references .",
    "the standard approach is to triangulate the rectangular regions separately , such that triangulations of adjacent regions agree on their common boundary .",
    "this results in many simplices for regions with a large number of neighbors .",
    "our dual complex construction constitutes an alternative to this standard approach ; however , it does not necessarily embed in the ambient space nicely , which leads to the question considered in this work .",
    "a special case of rectangular partitions are _ hierarchical cubical subdivisions _ ; they arise from the initial box by a sequence of subdivisions , where a box in the partition is replaced with @xmath14 sub - boxes of half the side length . in @xmath15 and @xmath12 dimensions ,",
    "these subdivisions are called _ quad - trees _ and _ oct - trees _ , respectively . a hierarchical cubical subdivisions is called _ balanced _ if adjacent boxes differ at most by a factor of @xmath15 in side length .",
    "note that balanced subdivisions are special cases of @xmath15-balanced partitions in our notation . in  @xcite",
    ", the dual complex of an oct - tree is used to approximate the _ persistent homology _ ( see  @xcite for a definition ) of the underlying image .",
    "it was also shown that the dual complex is center - embeddable , provided that the oct - tree is balanced . in  @xcite ,",
    "that result is generalized to general hierarchical cubical subdivisions ; our results show that the hierarchical structure is crucial for obtaining this result , as for all @xmath16 , we can construct a non - hierarchical @xmath15-balanced partition that is not center - embeddable .",
    "[ [ outline ] ] outline + + + + + + +    we introduce hyper - rectangular partitions and their dual complexes formally in section  [ sec : definitions ] . section  [ sec : np ] is devoted to the np - completeness proof of finding an embedding in the planar case .",
    "we study center - embeddability in section  [ sec : balancing ] .",
    "section  [ sec : conclusion ] concludes the paper .",
    "this section introduces the most important concepts needed for the results of this work .",
    "we call a point set of the form @xmath17\\times\\ldots\\times [ a_d , b_d]$ ] with @xmath18 and @xmath19 an _ integral hyper - rectangle _ , or just a _ box _ , with _ lengths _ @xmath20 .",
    "an _ integral hyper - square _ , or _ square box _ is a box where all lengths are equal .",
    "we can think of a box to be composed out of _ hyper - pixels _ , or _",
    "unit boxes _ which are integer translates of @xmath21^d$ ] .",
    "let @xmath22^d$ ] be a square box with an arbitrary @xmath23 .",
    "a _ hyper - rectangular partition _",
    "@xmath24 ( with @xmath25 ) of @xmath26 is a collection of boxes @xmath27 such that their union equals @xmath26 and their interiors are disjoint .",
    "if the union of the @xmath27 is only a subset of @xmath26 , we call the collection a _ partial hyper - rectangular partition_. we usually omit the term `` hyper - rectangular '' and just talk about a _ partition_. a partition is called _ generic _ if not more than @xmath1 boxes intersect in a common point .",
    "we associate an abstract @xmath0-dimensional _ dual complex _",
    "@xmath28 to a partition @xmath29 . for a generic partition",
    ", @xmath28 is just the _ nerve _ of @xmath29 , that is , each box @xmath27 is represented by a vertex @xmath30 , and the simplices of @xmath28 correspond to subsets of @xmath31 with non - empty intersection .",
    "this construction fails for non - generic partitions because intersections of @xmath32 rectangles give rise to a @xmath33-simplex in the nerve . to circumvent this problem ,",
    "we slightly perturb the boxes to obtain a generic situation , following the construction from  @xcite : the union of unit boxes can be seen as the voronoi diagram of the pixel centers @xmath34 . for an arbitrary @xmath35 , we define the _ distortion _ of a point @xmath36 as @xmath37 we consider the voronoi diagram of the distorted pixel centers . for a pixel @xmath38 ,",
    "we define its distortion @xmath39 as the voronoi cell of its distorted pixel center . for a box consisting of pixels @xmath40",
    ", we define its distortion as the union of the distorted pixels @xmath41 . finally , we define the dual complex @xmath28 of a partition @xmath29 to be the nerve of the distorted boxes in the partition .",
    "see figure  [ fig : distortion ] for an example in the plane .",
    "we remark that the dual complex does not depend on the choice of @xmath42 .",
    "informally , the distortion is a way to remove high - dimensional simplices from the nerve in non - generic situations , thereby `` preferring '' connections between hyper - rectangle in the diagonal direction @xmath43 ; we refer to  @xcite for more details .    for a hyper - rectangular partition @xmath44 ,",
    "let @xmath30 denote the vertex of the dual complex @xmath28 that represents @xmath27 .",
    "we call a mapping from @xmath45 to @xmath2 a _ projection_. the _ barycentric refinement _ of the integer grid is the grid whose vertices are of the form @xmath46 with @xmath47 .",
    "a projection is _ half - integral _ if each @xmath30 is mapped to a vertex of the barycentric refinement of the integer grid .",
    "a projection is _ faithful _ if each @xmath30 is mapped in the interior of @xmath27 .",
    "we assume in this work that projections are half - integral and faithful , unless otherwise stated .",
    "a projection @xmath48 extends to the whole dual complex @xmath28 by mapping a higher - dimensional simplex to the interior of the convex hull of the projected boundary vertices .",
    "abusing notation , we let @xmath48 also denote the extended mapping .",
    "we call a projection an _ embedding _ , if this mapping is injective , or in other words , if the image is a simplicial complex in @xmath2 .",
    "[ [ seed - configurations ] ] seed configurations + + + + + + + + + + + + + + + + + + +    consider a @xmath0-simplex @xmath49 of @xmath28 , dual to the intersection point @xmath50 of the boxes @xmath51 . by definition of @xmath28 , there is a _",
    "unique _ collection of unit boxes @xmath52 with @xmath53 such that the distorted unit boxes @xmath54 intersect _ in a common point _ as well . by definition , the @xmath55 intersect in @xmath50 .",
    "let @xmath56 be the center of @xmath55 .",
    "we call @xmath57 the _ seed configuration _ of @xmath49",
    ".    in @xmath2 , a sequence of @xmath1 points @xmath58 has the _ orientation _",
    "@xmath59    r4 cm     we say that a projection @xmath48 of @xmath28 to @xmath2 _ preserves the orientation of the @xmath0-simplex @xmath49 _ , if @xmath60 , where @xmath61 is the seed configuration of @xmath49 . for an equivalent formulation in the plane ,",
    "assume that @xmath62 , @xmath63 , @xmath64 are arranged counterclockwisely around @xmath50 .",
    "then @xmath48 preserves the orientation of @xmath49 , if the cycle @xmath65 is counterclockwisely arranged , too . in the picture on the right , the seed configuration of the dual @xmath15-simplices @xmath66 and",
    "@xmath67 is illustrated ; note that the given projection does not preserve the orientation of the former @xmath15-simplex , but does preserve the orientation of the latter .",
    "the following result is a generalization of the `` geometric realization theorem '' from  @xcite .",
    "in there , it was proven that for balanced hierarchical cubical subdivisions , the projection that maps a vertex to the center of the cube is always an embedding .",
    "the main property exploited in the proof is the `` orientation lemma '' , stating that the orientation of each @xmath0-simplex is preserved for such subdivisions .",
    "this is no longer true for arbitrary partitions , but the same proof idea can be used to show :    [ thm : embedding ] let @xmath29 be a partition .",
    "let @xmath48 be a projection of @xmath28 that preserves the orientation of at least one @xmath0-simplex .",
    "then , @xmath48 is an embedding if and only if it preserves the orientation of each @xmath0-simplex .",
    "the proof in  @xcite relies on some topological concepts ; appendix  [ app : embedding ] repeats the argument for the convenience of the reader .",
    "the constraint that @xmath48 preserves at least one @xmath0-simplex is required to rule out pathological cases such as a partition in @xmath3 with only @xmath12 rectangles , whose dual is always an embedding regardless of the orientation of the dual triangle ( unless the triangles degenerate to a line ) .",
    "all our results are eventually reduced to investigate the orientation of projected @xmath0-simplices : embedability results will be proved by showing that each @xmath0-simplex preserves orientation , non - embedability results by constructing examples where some @xmath0-simplex does not preserve orientation . in all these constructed examples , it will be easy to verify that at least one @xmath0-simplex preserves orientation ; therefore we will tacitly ignore that assumption when applying theorem  [ thm : embedding ] .",
    "in this section , we concentrate on the planar case @xmath68 .",
    "we adapt our notation by leaving out the prefix `` hyper- '' on all defined terms .",
    "[ fig : counter ]    [ [ thin - rectangles - and - l - joints ] ] thin rectangles and l - joints + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we call an integral rectangle _ thin _ if one of its side has length @xmath69 , and the other side has length at least @xmath70 .",
    "the _ length _ @xmath71 of a thin rectangle is the length of its longer side .",
    "clearly , any projection has to map the vertex of a thin rectangle to one of the @xmath71 pixel centers .",
    "three intersecting rectangles are called an _",
    "l - joint _ if two of the rectangles are thin and their union is l - shaped ( up to rotation and reflection ) , and the third rectangle is the pixel in the bulge of the l - shape ; see figure  [ fig : l - joint ] ( left ) .",
    "if the l - joint belongs to a partition , it induces a @xmath15-simplex in @xmath28 .",
    "l - path _ is a sequence of thin rectangles such that two consecutive elements form an l - joint .",
    "such an l - path can be cyclic , in which case we call it an _ l - cycle_. it is convenient to think of the thin rectangles in an l - joint being directed consistently towards one end of the l - shape .",
    "if the direction is fixed , it makes sense to talk about the _ front rectangle _ and _ back rectangle _ of the l - joint , about the _ front half _ and _ back half _ of each thin rectangle , and about the _",
    "front pixel _ and the _ back pixel _ which are the extremal pixels in a thin rectangle .",
    "[ lem : l - joint ] let @xmath72 be a directed l - joint , with @xmath73 being the back rectangle , @xmath74 being the front rectangle , and @xmath38 being the bulge pixel .",
    "let @xmath48 be a projection that preserves the orientation of the @xmath15-simplex induced by the l - joint .",
    "then , if @xmath48 maps the vertex of @xmath73 to to its back half , it also maps the vertex of @xmath74 to its back half .",
    "figure  [ fig : l - joint ] ( left ) displays the two possible connections of @xmath73 and @xmath74 , if both are of length @xmath70 . recall that @xmath48 is assumed to be half - integral and , therefore , has only @xmath70 choices to place the vertex for both @xmath73 and @xmath74 .",
    "we can see that , if @xmath48 preserves the orientation and maps the vertex of @xmath73 into its back half it must map the vertex of @xmath74 below the dashed line , so this vertex must go into the back half in both cases . the situation does not change if we extend @xmath73 to the left or @xmath75 to the top .",
    "we can use l - joints to show that dual complexes can not always be embedded : consider the ( partial ) rectangular partition in figure  [ fig : counter ] ( right ) .",
    "let @xmath48 be any projection of @xmath28 .",
    "assume for a contradiction that @xmath48 preserves the orientation of all @xmath15-simplices induced by the partial partition .",
    "assume w.l.o.g .",
    "that the vertex of @xmath76 is projected to the left half of @xmath76 ( otherwise , the symmetric argument applies ) .",
    "direct the thin rectangles according to the arrows in the figure . by the l - joint lemma",
    ", the vertices of @xmath73 and @xmath74 must be placed in their back halves , and by repeating the argument , the same holds for the rectangles @xmath77 and @xmath78 . using the l - joint lemma again",
    ", the vertex of @xmath79 must be placed in the upper half of @xmath79 ( caused by the l - joint with @xmath77 ) and also in the lower half of @xmath79 ( caused by the l - joint with @xmath78 ) , a contradiction . filling out the partial partition with pixels , we obtain a full partition @xmath29 such that no projection preserves the orientation of all triangles .",
    "the embedding theorem ( theorem  [ thm : embedding ] ) asserts that there is no embedding .",
    "[ [ the - reduction ] ] the reduction + + + + + + + + + + + + +    we define the decision problem ` faithful_embed ` as follows : for a partition @xmath80 of @xmath81\\times [ 0,n]$ ] , is there an embedding of @xmath28 ?",
    "our goal is to show np - completeness of this problem .",
    "first of all , the problem is clearly in np : given a partition @xmath29 , we can compute @xmath28 and check whether a specific projection causes an orientation switch for any triangle in polynomial time .    for the reduction",
    ", we define the ` grid3sat ` problem in the same way as in  @xcite :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ ` grid3sat ` : given some @xmath82 grid ( with @xmath83 linear in @xmath84 ) in which some grid points are labeled as clauses and some as variables .",
    "variables are connected with clauses by vertex - disjoint paths on the grid .",
    "a sign is associated to every such path indicating whether the corresponding variable is negated in the clause or not .",
    "every clause is incident to exactly three paths .",
    "is the formula described in this way satisfiable or not ? _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    see figure  [ fig : grid3sat ] ( left ) for an example .",
    "a consequence of the formulation is that every variable appears in at most four clauses .",
    "therefore , the problem is a variant of the _ planar 3,4-sat _ problem ( see  @xcite ) with the restriction that all paths follow grid edges .    .",
    "right : a corresponding representation as a partial integral rectangular partition , with l - path connections.,title=\"fig:\",width=158 ] .",
    "right : a corresponding representation as a partial integral rectangular partition , with l - path connections.,title=\"fig:\",width=294 ]    as stated in  @xcite , ` grid3sat ` is np - complete .",
    "consider an instance @xmath85 of ` grid3sat ` , which is a graph on the integer grid representing a formula @xmath86 ( in 3-cnf form ) .",
    "based on this graph , we will construct a rectangular partition @xmath29 such that the existence of a satisfying assignment for @xmath86 is equivalent to the existence of an embedding of @xmath28 .",
    "we barycentrically refine ( see section  [ sec : definitions ] ) the grid given by @xmath85 a constant number of times ( in fact @xmath87 barycentric refinements suffice ) and construct our partition inside this base grid . for that , we first replace vertices representing variables or clauses by boxes of sufficient size ( which we fill later ) , and we replace paths connecting variables and clauses by disjoint l - paths .",
    "each path inherits the sign of the corresponding path in @xmath85 .",
    "we think of l - paths being directed from variables to clauses .",
    "see figure  [ fig : grid3sat ] ( right ) .     from figure",
    "[ fig : grid3sat ] . right : the clause gadget for @xmath88 from figure  [ fig : grid3sat ] .",
    "note that @xmath63 , @xmath64 , @xmath89 are precisely of length 4 ; the dashed lines and the red lines are drawn for illustration purposes in lemma  [ lem : clause_lemma ] . , title=\"fig:\",width=264 ]    from figure  [ fig : grid3sat ] .",
    "right : the clause gadget for @xmath88 from figure  [ fig : grid3sat ] .",
    "note that @xmath63 , @xmath64 , @xmath89 are precisely of length 4 ; the dashed lines and the red lines are drawn for illustration purposes in lemma  [ lem : clause_lemma ] .",
    ", title=\"fig:\",width=264 ]    inside each box representing a variable @xmath90 , we place a * variable gadget * ( figure  [ fig : gadgets ] ( left ) ) . in its center",
    ", it has an l - cycle with 4 thin rectangles of length @xmath91 , which we direct in clockwise direction .",
    "we call this cycle the _ variable cycle for @xmath90_. each l - path to a clause box that starts at a boundary side of the gadget is extended into the interior of the box and forms an l - joint with the corresponding side of the variable cycle . if the path is associated with a plus sign ( that is , the variable appears in non - negated form in the corresponding clause ) , the path is connected to the front pixel . if it is associated with a minus sign , it is connected to the back pixel .    inside each box representing a clause , we place a * clause gadget * ( figure  [ fig : gadgets ] ( right ) ) . the three l - paths arriving at the boundary of the gadget are extended to connect to the _ clause rectangle _ ( rectangle @xmath62 in figure  [ fig : gadgets ] ( right ) ) ,",
    "with the last rectangle being exactly @xmath70 base squares long .",
    "if the l - paths arrive at different sides than displayed in figure  [ fig : gadgets ] , we can just rotate the gadget by a multiple of @xmath92 .",
    "the gadget is designed to satisfy the following two properties :    [ lem : clause_lemma ] let @xmath93 be the vertices of @xmath94 , respectively , as in figure  [ fig : gadgets ] ( right ) , and let @xmath48 be a partial projection that maps @xmath30 to a point @xmath95 for @xmath96 .    1 .",
    "if @xmath97 , @xmath98 , and @xmath99 are in the back half of @xmath63 , @xmath64 , and @xmath89 , respectively , then @xmath48 can not be completed to an embedding .",
    "if at least one of the @xmath95 is in the front pixel of @xmath27 , for @xmath96 , then there exists an extension of @xmath48 to @xmath100 such that @xmath48 preserves the orientation of all triangles incident to @xmath100 .",
    "consider figure  [ fig : gadgets ] ( right ) ; for the first part , let @xmath101 be the projection of @xmath100 in a completion of @xmath48 .",
    "if @xmath48 is an embedding , @xmath101 is left of @xmath102 , right of @xmath103 and below @xmath104 , which is impossible . for the second part , if @xmath97 or @xmath98 are in the front pixel , we can set @xmath101 to be the center of the rightmost or leftmost dashed base square in figure  [ fig : gadgets ] ( right ) , respectively .",
    "if @xmath99 is in the front pixel , we can choose the center of the topmost blue base square for @xmath101 .",
    "from the red line originating in @xmath63 in figure  [ fig : gadgets ] ( right ) , it can be seen that the triangle induced by @xmath62 , @xmath63 , and the pixel adjacent to both has the correct orientation .",
    "the same is true for the triangle spanned by @xmath62 , @xmath64 and the pixel adjacent to both .    to summarize ,",
    "we have constructed a partial integral rectangular partition , consisting of variable cycles , clause rectangles , and l - paths connecting them .",
    "we finally complete the partition by filling the empty spots with pixels .",
    "let @xmath29 denote this partition .",
    "we can construct @xmath29 in polynomial time in @xmath84 .",
    "the following lemma is sufficient to prove np - hardness of ` faithful_embed ` .",
    "[ lem : sat_emb_equi ] there exists an embedding of @xmath28 if and only if @xmath86 has a satisfying assignment .",
    "`` @xmath105 '' : let @xmath48 be an embedding .",
    "we define an assignment as follows : for every variable @xmath90 , consider its variable cycle ( which is clockwisely arranged ) .",
    "note that the l - joint lemma implies that @xmath48 either projects all vertices of the variable cycle to the front half , or it projects all vertices to the back half of the corresponding rectangles .",
    "we set @xmath90 to ` true `  if @xmath48 projects to the front half and to ` false `  otherwise .",
    "we show that this assignment satisfies @xmath86 :    let @xmath106 be a clause of @xmath86 where @xmath107 or @xmath108 , and consider the corresponding clause gadget .",
    "let @xmath27 , @xmath109 , @xmath110 the last rectangles of the l - paths connecting the variable gadgets of @xmath90 , @xmath111 , and @xmath112 , respectively , to the clause rectangle .",
    "since @xmath48 is an embedding , at least one of the vertices of @xmath27 , @xmath109 , or @xmath110 is placed in the corresponding front half by the clause lemma .",
    "assume w.l.o.g .  that the vertex of @xmath27 is placed in the front half . by iteratively applying the l - joint lemma , all vertices in the l - path from @xmath90 to @xmath113",
    "must therefore be placed in the front half .",
    "if @xmath107 , the path was associated with a plus sign , and therefore , the l - path is connected with the variable cycle of @xmath90 at a front pixel ( as for instance the left and right paths originating from the variable cycle in figure  [ fig : gadgets ] ( left ) ) .",
    "since @xmath48 preserves orientations , it follows again from the l - joint lemma that the vertices in the variable cycle must also have been placed in the front half .",
    "hence , our assignment sets @xmath90 to @xmath114 and therefore , the clause is satisfied . if @xmath108 , the argument is analogous .",
    "`` @xmath115 '' : we construct a projection based on a satisfying assignment .",
    "we start with the variable gadgets : if @xmath116 , we place the vertices in its variable cycle at the front pixel , otherwise at the back pixel . for every l - path that leaves a variable cycle , we distinguish two cases : if the path has a plus sign and @xmath116 , or if the path has a minus sign and @xmath117 , we place all vertices in the path in the front pixel ; otherwise , we place all vertices in the back pixel .",
    "it is straight - forward to verify that this projection preserves the orientation for each @xmath15-simplex induced by l - joints .",
    "finally , let @xmath106 be a clause as above .",
    "consider the corresponding clause gadget and let @xmath27 , @xmath109 , @xmath110 denote the connecting ( thin ) l - path rectangles . by our construction ,",
    "the vertex of @xmath27 is in the front pixel if and only if @xmath118 , same for @xmath119 and @xmath120 .",
    "since we have a satisfying assignment , at least one literal is satisfied , so one of the vertices is in the front pixel . by the clause lemma",
    ", we can therefore place the vertex of the clause rectangle such that all triangles preserve their orientation .",
    "our projection preserves all orientations of the constructed partial partition .",
    "it is not difficult to see that the additional @xmath15-simplices caused by filling the empty spots with base squares preserve their orientation as well ( in fact , any projection preserves their orientation ) .",
    "therefore , the constructed projection is an embedding by the embedding theorem .    in conclusion",
    ", we can summarize    ` faithful_embed ` is np - complete .",
    "a slight variation of our proof shows that the problem remains np - hard when allowing projections that are not half - integral ( see appendix  [ app : non - half - integral ] ) .",
    "however , it is unclear whether this variant of the problem also remains in np .",
    "we turn back to arbitrary dimensions .",
    "we define the _ center _ of a box @xmath17\\times\\ldots\\times [ a_d , b_d]$ ] to be the point @xmath121 .",
    "the _ center projection _ is the projection of @xmath28 that maps each vertex to the center of the corresponding box . clearly , this projection is half - integral and faithful .",
    "we call @xmath29 _ center - embeddable _ if the center projection is an embedding .",
    "we define the _ balance _ of a set of boxes @xmath122 to be the length of the longest side among all boxes @xmath123 divided by the length of the shortest side among all boxes @xmath123 .",
    "we define the balance of a @xmath120-simplex @xmath49 of @xmath28 to be the balance of the set of dual boxes .",
    "the _ aspect ratio _ of a box @xmath124 is the balance of @xmath125 .",
    "obviously @xmath124 has aspect ratio @xmath69 if and only if @xmath124 is a square box .",
    "we call @xmath28 _ @xmath4-balanced _ for some @xmath5 , if each simplex of @xmath28 has balance at most @xmath4 .",
    "has balance at most @xmath4 , which is the definition given in the introduction . ] informally , @xmath4-balanced partitions have the property that boxes are not too skinny , but also neighboring boxes do not differ too much in side lengths .",
    "the simplest sufficient condition for a partition to be center - embeddable is that all boxes are square boxes of same size .",
    "we investigate several generalizations of this trivial criterion .",
    "[ [ planar - results ] ] planar results + + + + + + + + + + + + + +    it is not hard to prove that a partition in @xmath3 consisting only of squares is always center - embeddable , because the edge connecting the centers of two squares does not leave the union of the squares .",
    "however , if we only bound the aspect ratio of any rectangle by @xmath126 ( with @xmath7 ) , this property does not hold in general , and we can construct a counterexample for center - embeddability . for @xmath4-balanced partitions ,",
    "we prove a tight bound for center - embeddability .    .",
    "the drawing assumes that @xmath127 . in this case",
    ", we can find a line that touches @xmath128 , @xmath129 , and @xmath130 , leading to a counterexample for center - embeddability . right : illustration of the construction in the proof of theorem  [ thm : beta_balanced_high].,title=\"fig:\",width=226 ] .",
    "the drawing assumes that @xmath127 . in this case , we can find a line that touches @xmath128 , @xmath129 , and @xmath130 , leading to a counterexample for center - embeddability . right : illustration of the construction in the proof of theorem  [ thm : beta_balanced_high].,title=\"fig:\",width=283 ]    [ fig : beta_balanced_plane ]    [ thm : planar_balancing ] a @xmath4-balanced partition of @xmath3 is center - embeddable for @xmath131 , and there exists a @xmath12-balanced partition that is not center - embeddable .",
    "consider a @xmath4-balanced partition .",
    "for the first part , it is enough to prove that the center projection preserves the orientation of each @xmath15-simplex for @xmath131 according to the embedding theorem .",
    "so , let @xmath49 be a @xmath15-simplex , caused by the intersection of three rectangles @xmath62 , @xmath63 , @xmath64 . w.l.o.g . , we assume that the intersection point is the origin , that @xmath62 is completely contained in the lower - left quadrant , @xmath63 is contained in the upper - left quadrant , and @xmath64 is contained in the halfplane @xmath132 ; all other cases are obtained by suitable rotations and reflections .",
    "let @xmath133 denote the length of the shortest side among the @xmath27 , and let @xmath134 denote the length of the longest side ; we have @xmath135 .",
    "we let @xmath136 denote the set of possible positions of the center of @xmath27 . by the imposed constraints , it is straight - forward to verify that @xmath136 are rectangles as illustrated in figure  [ fig : beta_balanced_plane ] ( left ) .",
    "note that the lower side of @xmath130 does not belong to the set of possible centers , while the other boundary sides do .",
    "recall that the orientation of @xmath49 is preserved if @xmath137 , where the @xmath56 define the seed configuration of @xmath49 ; in our case , @xmath138 , @xmath139 , and @xmath140 .",
    "we scale each @xmath56 by @xmath133 , obtaining the points @xmath141 , @xmath142 , @xmath143 ; obviously , @xmath144 .",
    "assume that the orientation of @xmath49 is not preserved .",
    "then , if we continuously move the points @xmath145 to the points @xmath95 along the connecting line segment ( which lies in @xmath136 ) , there must be a time where the three points become collinear .",
    "it follows that there must be a line in @xmath3 which intersects each @xmath136 .",
    "such a line , however , exists if and only if @xmath146 , as can be seen by elementary geometric arguments .",
    "it follows that the orientation of @xmath49 is preserved if @xmath131 .",
    "the construction also yields the counterexample for @xmath127 : consider the rectangles intersecting in the origin with centers @xmath147 , @xmath148 , @xmath149 .",
    "we can fill the bounding box by pixels to obtain a @xmath12-balanced partition .",
    "the @xmath15-simplex dual to the origin is projected to a line segment because @xmath101 , @xmath97 , @xmath98 are collinear .",
    "therefore , the partition is not center - embeddable .",
    "the counterexample constructed in the proof of theorem  [ thm : planar_balancing ] yields a non - generic partition .",
    "if we assume genericity , the set @xmath130 defined in the proof loses the upper boundary side , and a line intersecting each @xmath136 can only be found if @xmath150 .",
    "it follows that generic @xmath12-balanced partitions are center - embeddable .",
    "however , generic @xmath4-balanced partitions that are not center - embeddable can be constructed for any @xmath151 .",
    "[ [ higher - dimensions ] ] higher dimensions + + + + + + + + + + + + + + + + +    restricting to square boxes ( that is , aspect ratio @xmath69 ) does not guarantee center - embeddability for any @xmath152 : in @xmath8 , the triangle spanned by the centers of three intersecting cubes might leave the union of the three cubes , and a counterexample can be constructed ; see  @xcite and  @xcite .",
    "we show that also restricting to @xmath4-balanced partitions does not guarantee embeddability , unless @xmath153 :    [ thm : beta_balanced_high ] for any @xmath154 , there exists a @xmath4-balanced partition in @xmath2 that is not center - embeddable .",
    "we restrict to @xmath155 for the simplicity of presentation although our construction generalizes to any dimension : for simplicity , we talk about _ cubes _ and _ voxels _ instead of square boxes and unit boxes throughout the proof .",
    "choose @xmath156 such that @xmath157 .",
    "consider four cubes of length @xmath134 having the origin as a corner , such that the centers lie in a common plane ( the black boxes in figure  [ fig : worst_case_3d ] ( right ) ) .",
    "then , extend the cubes by a layer of voxels at two opposite faces , such that all voxels around the origin are covered by the four boxes ( the blue boxes in figure  [ fig : worst_case_3d ] ( right ) ) .",
    "this ensures that the @xmath12-simplex induced by the four boxes belongs to the dual complex of the partition .",
    "the extension does not change the centers , consequently , the center projection can not preserve the orientation of that simplex .",
    "moreover , all boxes have side length @xmath134 and @xmath158 .",
    "it remains to show that the arrangement of the four boxes can be completed to a partition without destroying @xmath4-balancing .",
    "we give details of this step in appendix  [ app : puzzle ] .",
    "[ [ the - cubical - case ] ] the cubical case + + + + + + + + + + + + + + + +    we finally consider @xmath4-balanced partitions in @xmath2 where all boxes are square boxes .",
    "we call such partitions _ cubical_. we first construct counterexamples in arbitrary dimension to show :    [ thm : counter_beta_balanced_dd ] for @xmath159 and @xmath160 , there exists a @xmath4-balanced cubical partition in @xmath2 that is not center - embeddable .    for @xmath159 ,",
    "@xmath161 positive , and @xmath162 consider the @xmath163-matrix @xmath164 it can be shown by elementary row operations ( appendix  [ app : determinant ] ) that @xmath165 in particular , note that the determinant is positive if @xmath166 , vanishes if @xmath167 , and is negative if @xmath168 .",
    "let @xmath133 and @xmath134 be such that @xmath169 , so that @xmath170 .",
    "if we choose @xmath133 and @xmath134 large enough , it follows that @xmath171 as well , just because @xmath172 constitutes a small perturbation of @xmath173 for large @xmath133 and @xmath134 .",
    "the rows of @xmath172 define @xmath1 points @xmath174 in @xmath2 ( ignoring the first column ) .",
    "we define the square box @xmath27 with center @xmath95 and side length @xmath133 for @xmath62 , and length @xmath134 for @xmath175 . by this choice",
    ", it can be seen easily that all @xmath14 unit boxes around the origin are covered by the @xmath27 , so @xmath51 form a @xmath0-simplex @xmath49 in the dual complex .",
    "moreover , @xmath176 , @xmath177 , @xmath178 , and so on , thus @xmath61 form a seed configuration and it is easily seen to that @xmath179 . because @xmath180 by construction , the center projection does not preserve the orientation of @xmath49 .",
    "the last step of the proof is to show that we can complete the initial configuration @xmath51 to a complete @xmath4-balanced cubical partition in @xmath2 .",
    "the details of this step are skipped for brevity .",
    "see appendix  [ app : puzzle ] for details .",
    "we are able to show that the constructed counterexample is the worst case in @xmath8 .",
    "precisely , we state :    [ thm : cubical_partition_bound_3d ] cubical @xmath4-balanced partitions in @xmath8 are center - embeddable for @xmath131 .    for simplicity ,",
    "we restrict to generic partitions in the proof ; the general case works with the same methodology , but requires closer investigation of the distortion defined for the dual complex construction . as in theorem",
    "[ thm : beta_balanced_high ] , we use the terms cube and voxel instead of square box and hyper - pixel .",
    "consider @xmath70 cubes @xmath181 intersecting in a point @xmath182 .",
    "let @xmath133 be the length of the shortest and @xmath134 be the length of the longest side among the @xmath181 .",
    "assume w.l.o.g .",
    "that @xmath183 .",
    "by genericity , the union of the @xmath27 covers all @xmath91 voxels adjacent to @xmath182 , and each cube covers at least one voxel .",
    "represent these voxels by the 3-bit numbers @xmath184 where the @xmath69st/@xmath15nd/@xmath12rd bit of voxel @xmath119 is set to @xmath69 if and only if the @xmath185-/@xmath186-/@xmath187-coordinate of the voxel is positive .",
    "assign to each @xmath27 a subset of @xmath188 , denoting the voxels that it occupies .",
    "only three cases are possible , namely that @xmath27 covers a single voxel , that @xmath27 covers two voxels which are face adjacent , or four voxels which lie in a common halfspace .",
    "we consider @xmath136 , the set of possible centers for @xmath27 .",
    "if @xmath27 covers only one voxel adjacent to the origin , say voxel @xmath189 , then @xmath136 is the line segment connecting @xmath190 and @xmath191 . if @xmath27 covers two voxels which are face adjacent , say voxels @xmath189 and @xmath69 , @xmath136 is the trapezoid spanned by the four points @xmath192 , @xmath193 ; more precisely , the center can not lie on either of the two non - parallel lines because this would prevent the cube to span over both voxels , so @xmath136 is the trapezoid with those two sides excluded .",
    "finally , if @xmath27 covers four voxels in a common hyperplane , say voxels @xmath194 , @xmath136 is the polytope spanned by the @xmath91 points @xmath195 , @xmath196 ; the polytope has 6 faces , two of them being parallel .",
    "more precisely , the center can not lie on a boundary face except for the two parallel sides , so @xmath136 is that polytope with the other @xmath70 faces excluded .",
    "assume for a contradiction that the center projection does not preserve the orientation of the simplex spanned by @xmath181 .",
    "scaling the seed configuration of the simplex by a factor of @xmath133 , we obtain a simplex spanned by @xmath197 with @xmath145 in the closure of @xmath136 with the same orientation as the seed configuration . because this orientation is not preserved , there are points @xmath198 with @xmath199 such that the orientation is different .",
    "it follows that there are points @xmath200 with @xmath201 whose orientation is zero . in other words",
    ", there exists a plane which intersects @xmath202 .",
    "however , @xmath202 are completely determined by the way of how the boxes @xmath27 decompose the voxels @xmath188 adjacent to the origin , and there are only two configurations possible , up to rotations and reflections : the _ regular configuration _ @xmath203 and the _ singular configuration _",
    "@xmath204 consequently , there must be a plane intersecting the two line segments , the trapezoid and the polytope defined by the regular configuration , or a plane intersecting the four trapezoids defined by the singular configuration .",
    "it can be verified , however , that such a plane does not exist by formulating the statement in terms of a quantified system of inequalities and using a quantifier elimination program  @xcite ( see appendix  [ app : qe ] ) .",
    "hence , the center - projection preserves the orientation of every simplex and is an embedding .",
    "the proof idea can in principle be extended to higher dimensions . however , there are two problems : first , the number of configurations to check increases ; for instance , there are already 3 configurations to check in @xmath205 .",
    "second , and more seriously , the complexity of the quantifier elimination increases dramatically for higher dimensions ; in fact , we were not able to verify that @xmath4-balanced cubical partitions in @xmath205 are center - embeddable for @xmath206 .",
    "we have proven positive and negative results about partitions and their duals in this paper ; it is np - hard to decide whether an embedding exists already in the plane ; if we project vertices to centers of rectangles , there are some simple balancing conditions that ensure embeddability in the plane , namely , if all rectangles are squares or if the partition is @xmath6-balanced with @xmath7 . in higher dimensions , however , we need to combine both properties , that means , consider cubical @xmath6-balanced partitions to get a guarantee that partitions can be embedded .",
    "we are posing the question whether another simple condition could guarantee center - embeddability as well .",
    "quad - tree decompositions and their higher - dimensional analogues have the nice property that they can be balanced with a greedy strategy , without granulating the partition too much .",
    "it seems unclear , however , how a planar partition can be turned into a @xmath12-balanced partition efficiently by subdividing rectangles .",
    "this work has considered hyper - rectangular partitions in general   can better embeddability results be derived for certain restrictions , in particular for partitions that arise from a sequence of hyperplane cuts ( sometimes also called guillotine constructions ) ?",
    "we expect the answer to be negative in the plane ; however , the situation might be different in higher dimensions .    on a technical side",
    ", a natural improvement would be to replace the computer - assisted proof in theorem  [ thm : cubical_partition_bound_3d ] with a geometric argument ; this would hopefully extend into higher dimensions and prove our conjecture that @xmath4-balanced partitions in @xmath2 are center - embeddable for @xmath207 .",
    "a second question is about a variant of ` faithful_embed ` : while it is clear that deciding the existence of an embedding remains hard in three dimensions , it is not clear whether the restriction to cubical partitions simplifies the problem .",
    "the author thanks herbert edelsbrunner for fruitful discussions , david eppstein for pointing out related work , and the anonymous referees for their extremely valuable feedback .",
    "let @xmath29 be a partition .",
    "let @xmath48 be a projection of @xmath28 that preserves the orientation of at least one @xmath0-simplex . then , @xmath48 is an embedding if and only if it preserves the orientation of each @xmath0-simplex .",
    "we give some more details about its proof which is based on  @xcite .",
    "a set is called _ contractible _ if it is can be reduced to a single point by a continuous deformation  @xcite .",
    "[ lem : fractual_distortion ] any intersection of @xmath120 distorted boxes of @xmath29 is either empty or contractible .    the proof given in the `` fractual distortion lemma '' in  @xcite extends to arbitrary partitions ( it is neither exploited that the boxes are cubes , nor that they are arranged hierarchically ) .",
    "we now give a proof of the embedding theorem which works similar to the proof of the `` geometric realization theorem '' from  @xcite .",
    "assume first that @xmath48 preserves the orientation of all @xmath0-simplices of @xmath28 .",
    "let @xmath208 be the box that is partitioned by @xmath29 .",
    "we attach two layers of unit boxes at the boundary of @xmath26 , obtaining an extended box @xmath209 .",
    "note that this yields a partition @xmath210 , which is an extension of @xmath29 .",
    "we extend the projection @xmath48 of @xmath29 to @xmath211 of @xmath210 by mapping vertices in the new layers to the corresponding box centers .",
    "we compactify @xmath2 to the @xmath0-dimensional sphere @xmath212 by adding a vertex at infinity .",
    "similarly , we compactify the dual complex @xmath213 by adding a new vertex at infinity and connecting it to every simplex of the boundary of @xmath213 .",
    "because of the lemma  [ lem : fractual_distortion ] , we can apply the nerve theorem  @xcite to @xmath213 , which states that @xmath213 triangulates a @xmath0-dimensional ball , and therefore , its compactification triangulates @xmath212 .",
    "hence , the extended projection @xmath211 defines a continuous mapping @xmath214 .",
    "the _ degree of @xmath215 _ at a point @xmath185 not in any @xmath216-simplex is the number of @xmath0-simplices that contain @xmath217 , counting a @xmath0-simplex positive or negative depending on the orientation of its image under @xmath215 .",
    "this degree is @xmath69 in between the two outside layers , because all boxes are of unit size and therefore , the orientation of all @xmath0-simplices can be chosen positive . however , the degree of a map is a global property that does not depend on the specific location of @xmath185 .",
    "hence , it is @xmath69 for any @xmath185 .",
    "we can assume that the orientation of all seed configurations is positive ; because all orientations are preserved by @xmath48 , the orientation of all @xmath0-simplices is positive .",
    "because the degree of @xmath215 is @xmath69 , it follows that every point is in the interior of exactly one projected @xmath0-simplex .",
    "this implies injectivity , so @xmath48 is an embedding .",
    "and @xmath218 are not the same ; indeed , if we map @xmath56 to @xmath30 for @xmath219 , the line @xmath220 is mapped to the line @xmath221 , but the halfspace left of @xmath220 is mapped to the halfspace right of @xmath221 .",
    "the same kind of argument can be applied in higher dimensions , replacing the dashed lines by hyperplanes and defining a notion of `` left '' and `` right '' by a common direction , for instance the vector from the center of @xmath100 to the center of @xmath222.,width=283 ]    for the opposite direction , assume that @xmath48 does not preserve the orientation of some @xmath0-simplex of @xmath28 . because there exists at least one @xmath0-simplex",
    "whose orientation is preserved , there exists some @xmath216-simplex @xmath223 in @xmath28 incident to one simplex @xmath224 whose orientation is preserved and to one simplex @xmath225 whose orientation is not preserved .",
    "it suffices to prove that @xmath224 and @xmath225 are mapped to the same side of the supporting @xmath216-hyperplane of @xmath223 .    to see that ,",
    "let @xmath226 and @xmath227 denote the seed configurations of @xmath224 and @xmath225 , respectively .",
    "w.l.o.g . , we assume that the seed configurations are ordered such that @xmath228 and @xmath229 are the pixels that belong to boxes in @xmath223 , and furthermore , for all @xmath230 , @xmath56 and @xmath30 belong to the same box of the partition . by these choices",
    ", we have that @xmath231 see figure  [ fig : orient_fig ] for an illustration in @xmath3 ; the general case can be derived with an argument similar to  @xcite .",
    "now , let @xmath232 denote the projections of the boxes of @xmath223 , and let @xmath233 and @xmath234 denote the projections of the boxes corresponding to @xmath222 and @xmath100 , respectively . w.l.o.g .",
    ", let @xmath224 be spanned by @xmath233 and @xmath232 and @xmath225 be spanned by @xmath234 and @xmath232 . because the orientation of @xmath224 is preserved , and the orientation of @xmath225 is not preserved , we have that @xmath235 it follows that @xmath233 and @xmath234 are mapped to side of the hyperplane spanned by @xmath232 .",
    "in this section , we reconsider the decision problem ` faithful_embed ` without the restriction that our projections are half - integral .",
    "we show that the problem remains np - hard in this relaxed setup .",
    "the proof strategy follows the same steps as in section  [ sec : np ] .",
    "we require , however , slightly more skinny rectangles : we call a rectangle _ thin _ if one of its sides has length one , and the other has length at least @xmath91 ( as opposed to length @xmath70 in section  [ sec : np ] ) .",
    "the definitions of l - path , l - joint , front pixel , front half etc .  directly carry over .",
    "also , the l - joint lemma remains true for arbitrary projections ; see figure  [ fig : l - joint - mod ] .",
    "is set in the back half , the pixel of @xmath74 must also be set in the back half , regardless of where the vertex of @xmath38 is placed.,width=226 ]    the np - hardness proof uses the same gadgets as in the half - integral case , with minor modifications : the variable gadget now consists of rectangles of length @xmath91 , and all paths to clauses are also formed by rectangles of at least this length .",
    "the clause gadget is modified as illustrated in figure  [ fig : clause - gadget - mod ] .",
    "it has three incoming paths , connecting variables to the clause , and the last rectangle is of length @xmath236 .",
    "the gadget is designed to satisfy the following properties similar to the clause lemma in section  [ sec : np ] :    1 .",
    "if all three incoming thin rectangles have their vertices in the back half , the projection can not be completed to an embedding .",
    "if the projection is half - integral , and at least one of the incoming rectangles has its vertex in the front pixel , we can place a vertex in the clause rectangle such that the orientation of all incident triangles is preserved .",
    ", right of @xmath103 and below @xmath104 , which is impossible .",
    "if the projection is integral and at least one of the incoming rectangles has its vertex in the front pixel , we can choose the center of one of the dashed pixels as projection for the clause rectangle.,width=226 ]    we can show that a formula encoded in a ` grid3sat ` instance is satisfiable if and only if the corresponding partition has an embedding .",
    "the proof is the same as for lemma  [ lem : sat_emb_equi ] : given an embedding , all vertices in a variable cycle must be either mapped to the front half or the back half , and we set the variable to @xmath69 or @xmath189 accordingly .",
    "this is a satisfying assignment , because for any clause , one of the incoming rectangles must have its vertex in the front half , and applying the l - joint lemma backwards ensures that the corresponding literal satisfies the clause .",
    "vice versa , given a satisfying assignment , we can construct a half - integral projection in exactly the same way as in the proof of lemma  [ lem : sat_emb_equi ] which yields an embedding .",
    "we have created configurations in theorems  [ thm : beta_balanced_high ] and  [ thm : counter_beta_balanced_dd ] which lead to a simplex whose orientation is not preserved under the center projection .",
    "we have to show that those initial configurations can be completed to a @xmath4-balanced partition . for theorem  [ thm : beta_balanced_high ] , this is relatively straight - forward . for the proof ,",
    "we need the following definition : let @xmath29 be a partition in @xmath2 , @xmath26 a box in the partition with corners @xmath237 ( with @xmath238 ) , and @xmath182 a point in the interior of @xmath26 . _",
    "splitting _ @xmath26 at @xmath182 means to replace @xmath26 in @xmath29 with @xmath239 boxes defined by the corners @xmath182 and @xmath240 , with @xmath241 .",
    ".,width=283 ]    [ lem : first_filling_lemma ] the partial partition @xmath181 from theorem  [ thm : beta_balanced_high ] can be completed to a @xmath4-balanced partition in @xmath8 .",
    "let @xmath156 as in theorem  [ thm : beta_balanced_high ] , such that @xmath242 .",
    "we will construct a partition of @xmath243 ^ 3 $ ] , consisting of exactly @xmath244 boxes , with @xmath181 among them .",
    "fix a corner @xmath145 of @xmath26 ( with @xmath245 ) .",
    "it lies in an octant of @xmath8 with respect to the origin , and there is exactly one box @xmath109 ( with @xmath246 ) that extends into this octant .",
    "let @xmath247 denote the corner of @xmath109 that is closest to the origin ( by construction , it is one unit length away from the origin ) .",
    "note that @xmath247 does not necessarily lie in the same octant as @xmath145 .",
    "we consider the box @xmath248 with ( opposite ) corners @xmath145 and @xmath247 .",
    "observe that the side lengths of @xmath248 are @xmath249 , @xmath250 , or @xmath251 .",
    "also , @xmath252 form a partition of @xmath26 , and each @xmath109 ( with @xmath246 ) lies in the corner of some @xmath253 .",
    "we split each @xmath248 into @xmath91 boxes : if @xmath248 contains some @xmath109 ( with @xmath246 ) , we let @xmath254 denote the corner of @xmath109 opposite to @xmath247 , and split @xmath248 at @xmath255 ; clearly , one of the @xmath91 created boxes is @xmath109 .",
    "see figure  [ fig : completion ] for an illustration .",
    "if @xmath248 does not contain any @xmath109 , we simply split at an integer point closest to its center .",
    "it is simple to verify that all boxes created by these operations have side lengths of at least @xmath256 and at most @xmath158 .",
    "since @xmath257 by assumption , the rectangular partition is @xmath4-balanced , but not center - embeddable , because it contains @xmath181 .    for theorem  [ thm : counter_beta_balanced_dd ]",
    ", the completion of the initial configuration is technically more challenging than in theorem  [ thm : beta_balanced_high ] because we can only use square boxes to fill the empty space .",
    "indeed , our construction needs much more filling space to `` balance out '' the differences between the square boxes , and it requires square boxes of many different size , all close to @xmath134 .",
    "the construction needs two preparatory lemmas .",
    "the first is a basic fact from elementary number theory    [ lem : coprime_lemma ] let @xmath258 and @xmath259 be the first @xmath120 prime numbers ( starting with @xmath260 ) .",
    "let @xmath156 such that @xmath261 with some @xmath262 .",
    "then , the @xmath263 numbers @xmath264 are pairwise coprime .",
    "assume for a contradiction that @xmath265 and @xmath266 have a common prime factor @xmath182 .",
    "then @xmath267 for @xmath268 , because the two numbers differ by less than @xmath269 .",
    "moreover , @xmath270 is a multiple of @xmath271 .",
    "it follows that @xmath271 divides both @xmath272 and @xmath273 , which is a contradiction .",
    "the next lemma proves that we can fill arbitrary large boxes in @xmath2 just using square boxes with @xmath14 pairwise coprime side lengths .",
    "[ lem : square_filling ] let @xmath274 and let @xmath275 be pairwise coprime integers .",
    "then there exists some @xmath276 such that every box with smallest side length at least @xmath277 can be partitioned into square boxes of side lengths @xmath278 .",
    "moreover , the partition can be chosen such that a box of side length @xmath279 is in one of its corners .",
    "set @xmath280 .",
    "choose @xmath277 such that for any integer @xmath281 , and any two disjoint subsets @xmath282 of @xmath26 , @xmath283 can be represented as @xmath284 with @xmath285 non - negative numbers .",
    "we prove inductively that any box with minimal side length at least @xmath277 can be partitioned . if @xmath286 , the statement is trivial .",
    "let @xmath26 be such a box in @xmath2 with @xmath287 and let @xmath288 denote the same box projected into @xmath289 .",
    "using the induction hypothesis with the numbers @xmath290 , we can partition @xmath288 with square boxes in @xmath289 . if we carry this partition into @xmath2 with the lower side of every box being in the plane @xmath291 , this does not yield a box because the square boxes have different heights in @xmath292-direction ; however , we can stack up boxes to match their heights .",
    "formally , define @xmath293 and place @xmath294 vertical copies for a square box of length @xmath295 . in this way",
    ", we construct a box whose projection to @xmath289 is @xmath288 , and whose length in @xmath292-direction is @xmath296 .",
    "we can do exactly the same construction using the integers @xmath297 , which yields a box of length @xmath298 in @xmath292-direction .",
    "let @xmath299 be the length of @xmath26 in @xmath292-direction . by assumption",
    ", we can find non - negative integers @xmath285 with @xmath300 .",
    "thus , placing @xmath301 copies of the box of first type and @xmath302 copies of the box of second type gives the desired box .",
    "the partial partition @xmath51 from theorem  [ thm : counter_beta_balanced_dd ] can be completed to a @xmath4-balanced cubical partition in @xmath8 .",
    "the first step is to choose @xmath133 and @xmath134 appropriately .",
    "note that the proof of theorem  [ thm : planar_balancing ] requires that @xmath303 , and such that @xmath304 is negative .",
    "we impose additional conditions : let @xmath274 and @xmath305 be the sequence of the first @xmath306 prime numbers ( note that the magnitude of @xmath307 only depends on @xmath0 ) .",
    "we choose @xmath133 and @xmath134 such that @xmath308 for some @xmath262 , such that @xmath309 and such that @xmath304 is negative .",
    "in particular , applying lemma  [ lem : coprime_lemma ] yields @xmath239 pairwise coprime integers @xmath310 .",
    "lemma  [ lem : square_filling ] applied on the sequence @xmath278 asserts the existence of some @xmath277 such that any box with side lengths at least @xmath277 can be filled .",
    "we choose some @xmath311 that is a multiple of @xmath133 , and set @xmath312^d$ ] .",
    "we have to show that we can construct a partition of @xmath26 containing @xmath51 with square boxes of sizes @xmath313 only . by our choice of @xmath133 and @xmath134",
    ", the so - obtained cubical partition is @xmath4-balanced , and the claim is proven .",
    "the construction works similar as in lemma  [ lem : first_filling_lemma ] .",
    "we first partition @xmath26 into @xmath239 boxes @xmath314 ( which are not square boxes in general ) , each anchored at one corner of @xmath26 , and with @xmath1 of them containing one of the initial square boxes @xmath27 .",
    "each @xmath314 has side lengths of at least @xmath315 ; therefore , it can be filled with squares boxes of lengths @xmath278 according to lemma  [ lem : square_filling ] .",
    "if @xmath314 contains some @xmath27 , we can enforce that @xmath27 is in the corner of the filling , as required .",
    "a special case is that @xmath314 contains @xmath62 which is of length @xmath133 .",
    "however , by construction , this @xmath314 is a square box of length @xmath283 , and we can simply fill it with square boxes of length @xmath133 because @xmath283 is a multiple of @xmath133 .",
    "we prove in this section that for the @xmath163 matrix @xmath316 it holds that @xmath317    indeed , we subtract the @xmath318-st row from the @xmath319-th row for @xmath320 to obtain @xmath321 where empty spots are zero .",
    "we simplify further by factoring out @xmath322 in the second row , factoring out @xmath134 in rows @xmath323 , and shifting the second row to the bottom , thereby changing the sign of every row that goes up . with these steps ,",
    "we obtain @xmath324 it is straight - forward to verify that the determinant of the rightmost @xmath325-matrix equals the sum of its last row , which is @xmath326 .",
    "the proof of theorem  [ thm : cubical_partition_bound_3d ] relies on the non - existence of planes that intersect certain point sets in @xmath8",
    ". we will give some details on how we prove this non - existence .",
    "recall from the proof that we defined @xmath133 and @xmath134 to be the shortest and longest sides among the cubes @xmath181 . by scaling",
    ", we can just assume that @xmath327 .",
    "because of the assumption , it follows that @xmath328 .",
    "the regular configuration @xmath203 induces the point sets @xmath329 where @xmath330 stands for the convex hull of a point set .",
    "assume for a contradiction that @xmath331 is a plane intersecting @xmath332 .",
    "since @xmath333 , @xmath331 intersects @xmath334 as well .",
    "let @xmath331 be defined by @xmath335 via the equation @xmath336 we first claim that @xmath337 .",
    "indeed , if @xmath338 , the projection of @xmath331 into the @xmath339-plane is a line .",
    "this line has to intersect the projections of the @xmath340 .",
    "however , these projections give the subsets of the rectangles defined in figure  [ fig : beta_balanced_plane ] ( left ) , and it can be seen with similar methods as in theorem  [ thm : planar_balancing ] that no such line exists for @xmath131 .",
    "moreover , it can be easily verified that @xmath331 is not parallel to any coordinate plane .    since @xmath337",
    ", we can normalize such that @xmath341 .",
    "we define the induced mapping @xmath342 clearly , @xmath343 , and if for two points @xmath344 , @xmath345 , then @xmath97 and @xmath98 are separated in different halfspaces by @xmath331 . from this property",
    ", we can immediately deduce        the @xmath115-direction is simple to proof . for the @xmath105-direction ,",
    "note that the first two statements are trivially satisfied .",
    "for the third statement , note first that @xmath331 can not contain the whole line segment from @xmath349 to @xmath350 , neither the line segment from @xmath351 to @xmath352 ( because this would contradict @xmath337 ) .",
    "let @xmath353 be the plane that contains @xmath354 .",
    "the intersection of @xmath331 and @xmath353 is a line on @xmath353 that intersects the boundary of @xmath354 in exactly two points .",
    "it is therefore clear that this line separates two opposite vertices in two halfplanes .",
    "thus , this pair is separated into two halfspaces by @xmath331 and this is precisely what is checked by the third statement .    for the last statement , note that @xmath331 can not completely contain any boundary face of @xmath355 , because this would mean that @xmath331 is parallel to a coordinate plane which is easily checked to be impossible .",
    "therefore , @xmath331 intersects through the interior of @xmath355 .",
    "therefore @xmath331 separates at least one of the four pairs of opposite vertices of the polytope , and this is checked in the forth statement .    with lemma  [ lem : formula_1 ]",
    ", we can formulate a quantified formula in the real variables @xmath356 which is true if and only if a plane @xmath331 as required exists .",
    "however , using a quantifier elimination program , we can easily compute that the formula is in fact false ."
  ],
  "abstract_text": [
    "<S> a rectangular partition is the partition of an ( axis - aligned ) rectangle into interior - disjoint rectangles . </S>",
    "<S> we ask whether a rectangular partition permits a `` nice '' drawing of its dual , that is , a straight - line embedding of it such that each dual vertex is placed into the rectangle that it represents . </S>",
    "<S> we show that deciding whether such a drawing exists is np - complete . </S>",
    "<S> moreover , we consider the drawing where a vertex is placed in the center of the representing rectangle and consider sufficient conditions for this drawing to be nice . this question is studied both in the plane and for the higher - dimensional generalization of rectangular partitions . </S>"
  ]
}