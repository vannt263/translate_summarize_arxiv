{
  "article_text": [
    "metastable structures are found in a variety of physical systems , _ e.g. _ glasses , amorphous solids of colloids  @xcite , stalk intermediate structures in biological membrane fusion process  @xcite , and so on .",
    "metastable states correspond to regions of the local free energy minima in phase space . in conventional simulation of the canonical ensemble ,",
    "once the system is captured in these regions , the system often remain in these non - equilibrium states for enormously long time .",
    "such metastable states are frequently found in macromolecular and colloidal systems , and make the simulation studies on equilibrium states difficult . even if the system can escape from the non - equilibrium states to the ordered equilibrium state , the constant number of particles and the constant system size cause defects in the ordered structure .",
    "this situation breaks , in a global scale , the anisotropy of the ordered structure and forces the periodicity of the ordered structure to be commensurate to the system size . in order to find defect - free",
    "equilibrated ordered structures , we should finely tune the system box size @xmath0 as well as the number of particles @xmath1 so that both the anisotropy and the periodicity of the ordered structure , which are not known _ a priori _ , are not violated by the periodic boundary conditions .",
    "this fine tuning for the ordered structure is in general a tedious task .",
    "advanced simulation techniques , _",
    "e.g. _ multicanonical ensemble method  @xcite and umbrella sampling  @xcite , allow us to almost homogeneously sample the whole phase space at constant @xmath1 and @xmath0 , with the help of artificial weights that reduce the occurrence probability of non - equilibrium states .",
    "however , microscopic states in equilibrium , sampled by these advanced techniques , are restricted to microstates with the given set of constant @xmath1 and constant @xmath0 .",
    "free energy landscapes of the system with different sets of @xmath1 and @xmath0 at the same particle density are not searched .",
    "these extensive variables simultaneously need manual fine tuning for the purpose of finding the most stable state in these free energy landscapes .",
    "for example , both @xmath1 and @xmath0 of perfect crystals should be integer multiples of the unit structure .",
    "furthermore these advanced methods also require an advanced programming and large amounts of complicated preparation , _",
    "e.g. _ accurate calculation of free energy  @xcite and the precise adjustments of the artificial weights , prior to the production simulation runs .",
    "in addition , such unphysical sampling processes with the artificial weights make it difficult to trace physical trajectories in the phase space .    here",
    "we devise molecular monte carlo simulation method of systems connected to three reservoirs ( hereafter we call it `` three - reservoirs method '' )  @xcite , chemical potential @xmath2 , pressure @xmath3 , and temperature @xmath4 , for seeking the most stable states of the target systems , _",
    "i.e. _ the equilibrium structures . due to gibbs - duhem equation , @xmath5 where @xmath6 is the entropy and",
    "@xmath7 is the volume , the number of reservoirs is thermodynamically limited to no more than 2 for single component systems .",
    "however , we connect the three reservoirs in order to overcome the above difficulties of the other conventional and advanced simulation techniques . in order to perform this ,",
    "we introduce a method for adjusting these three reservoirs and obtaining thermodynamically stable states .    the total number of particles @xmath1 and the system box size @xmath0 are additional degrees of freedom of the system connected to these three reservoirs .",
    "these additional degrees of freedom correspond to additional dimensions of the phase space , which provide shortcuts from the non - equilibrium state to the equilibrium state .",
    "in addition , unlike the other simulation techniques utilizing 2 or fewer reservoirs , these degrees of freedom allow the system itself to simultaneously tune @xmath1 and @xmath0 , so that the system reaches the true equilibrium ordered structure . furthermore , our method requires fewer efforts for the preliminary simulation prior to the production simulation runs .",
    "guggenheim formally introduced boltzmann factor ( statistical weight ) of the ensemble with the three reservoirs  @xcite .",
    "prigogine and hill also studied the same ensemble later  @xcite .",
    "these early works , however , focused on mathematical aspects of the partition function , _",
    "i.e. _ mathematical formalism of the ensemble , since their goal was to discover a universal and generalized expression for a partition function applicable to any thermodynamically acceptable ensembles  @xcite .",
    "by contrast , physical aspects of the ensemble were wholly left for the future . in the present work ,",
    "we study the physical aspects of this ensemble intuitively and thought - experimentally .",
    "in addition , we also analytically solve maximization problems of entropy densities , which corroborates our intuitive and thought - experimental study . finally , we design three - reservoirs method based on these physical aspects of the ensemble and show simulation results on non - trivial globally - anisotropic defect - free ordered structures of colloidal systems .    in spite of gibbs - duhem equation",
    ", a system connected to the three reservoirs can be realized in experiments .",
    "for example , we can imagine a system that obeys the grand canonical ensemble ( _ i.e. _ constant @xmath2 , @xmath7 , and @xmath4 ) , and replace one of its walls with a free piston facing to a reservoir of pressure @xmath3 , _ i.e. _ the 3rd reservoir . in the present article ,",
    "we theoretically construct thermodynamics and statistics of the system connected to the three reservoirs .",
    "based on euler equation of thermodynamics , we also propose a method for measuring entropy and free energy directly from the simulations of the systems connected to the three reservoirs .",
    "this measurement needs fewer computational efforts than the other free energy calculation methods using molecular simulation .",
    "we design the algorithms of the three - reservoirs method based on conventional monte carlo ( mc ) simulation methods of the grand canonical ensemble ( @xmath8-ensemble ) and the isothermal - isobaric ensemble ( @xmath9-ensemble ) .",
    "we give a brief description of these conventional molecular mc techniques in appendix  [ sec : molecularmctechniqueinmuvtandnpt - ensembles ] .",
    "thermodynamics , statistical mechanics , and simulation methods of the system with the three reservoirs are studied in section  [ sec : muptensemble ] .",
    "finally , we summarize the present work in section  [ sec : conclusions ] .",
    "here we discuss the basic formalism of the three - reservoirs method , where the method for adjusting the three reservoirs is also developed .",
    "thermodynamic properties of this system are discussed in section  [ subsec : thermodynamicsinmuptensemble ] .",
    "a microscopic formulation of three - reservoirs method based on statistical mechanics will be given in section  [ subsec : statisticalmechanicalpropertiesofparticlesinmuptensemble ] , where we solve the maximization problem of the statistical entropy per volume .",
    "algorithms for the simulation based on this statistical formulation are constructed in section  [ subsec : mcsimulationmethodinmuptensemble ] .",
    "simulation results to demonstrate efficiency and stability of three - reservoirs method are given in section  [ subsec : examinationof3-reservoirsmethod ] .",
    "finally , a new and simple technique to measure the entropy and the free energy of the system is proposed in section  [ subsec : entropyandfreeenergycalculationinmuptensemble ] .      as an example of thermodynamic systems , we consider a gas contained in a diathermal box with a free piston .",
    "this box is placed in an environment at constant @xmath4 and constant @xmath3 .",
    "these two intensive variables @xmath11 determine the other intensive variables of this system , _",
    "e.g. _ the chemical potential @xmath2 , the number density of particles @xmath12 , and the free energy per particle @xmath13 .",
    "this means that thermodynamic degrees of freedom of this system are equal to 2 , which results from gibbs - duhem equation , eq .  .",
    "in conventional simulation methods , @xmath1 is also fixed at some value ( @xmath9-ensemble ) , whereas states and phases of the system are independent of @xmath1 , a change of @xmath1 only scales the extensive variables of the system . in other words ,",
    "phase diagrams constructed in @xmath14-plane are independent of the extensive variables . instead of fixing this insignificant @xmath1 , we connect this system to a reservoir of @xmath2 , whose value is determined by @xmath11 through gibbs - duhem equation , eq .  .",
    "since gibbs - duhem equation is satisfied , this third reservoir does not affect the equilibrium state of the system .",
    "this condition corresponds to a thermodynamically stable point based on gibbs - duhem equation , which results in an equation of state that links @xmath15 , and @xmath2 . at a thermodynamically stable point of this ensemble , the extensive variables of the system , _",
    "e.g. _ @xmath7 and @xmath1 , are freely scaled , _",
    "i.e. _ indeterminate and fluctuating , while the system keeps all the intensive variables fixed . in simulating systems connected to the three reservoirs at the thermodynamically stable points , we can choose simulation runs at small @xmath1 , which are computationally advantageous .",
    "gibbs free energy per particle , which must be minimized in @xmath9-ensemble before adding the 3rd reservoir of constant @xmath2 , is unchanged even after this 3rd reservoir is connected to the system .    in the above example",
    ", @xmath11 is given from the outside of the system ; @xmath2 is adjusted according to @xmath11 and connected to the system as an additional reservoir .",
    "two other combinations @xmath16 and @xmath3 , and @xmath17 and @xmath4 also work in a similar manner .",
    "therefore , in addition to gibbs free energy per particle , both grand potential per volume and the thermodynamic potential of @xmath18-ensemble per @xmath6 , _ i.e. _ @xmath19 , are simultaneously minimized in the system connected to the three reservoirs , where @xmath6 and @xmath20 are entropy and internal energy respectively .",
    "gibbs - duhem equation explains this simultaneous minimization of the 3 free energy densities .",
    "when we add the 3rd reservoir to the system and set the system at the thermodynamically stable point , the intensive variable of the 3rd reservoir needs to be adjusted , in advance of the connection of this additional reservoir . through this adjustment of the 3rd intensive variable ,",
    "the corresponding free energy density is minimized .",
    "the same system at the same thermodynamically stable point is also constructed by the two other combinations of the 3 intensive variables . in other words , @xmath9 , @xmath8 , and @xmath18-ensembles simultaneously underlie the ensemble with the three reservoirs .",
    "this results in the simultaneous minimization of the 3 free energy densities . in the other ensembles ,",
    "however , any sets of corresponding 3 external parameters , _",
    "e.g. _ @xmath21 in the canonical ensemble ( @xmath22-ensemble ) , can be selected arbitrarily and the adjustment of the external parameters is not demanded .",
    "therefore , the corresponding free energy , _ e.g. _ helmholtz free energy in @xmath22-ensemble , is minimized in a conventional ensemble , whereas other free energies are not minimized due to the absence of underlying ensembles .",
    "a system connected to the three reservoirs is sketched in fig .",
    "[ fig : sketchmuptreservoirs ] .",
    "the reservoirs 1 and 2 define the values of @xmath2 and @xmath3 of the system respectively .",
    "the particle density of these 2 reservoirs , denoted by @xmath23 and @xmath24 respectively , determine the @xmath2 and @xmath3 .",
    "the system and the reservoirs 1 and 2 are connected to a thermostat at @xmath4 , the reservoir 3 . in appendix",
    "[ sec : molecularmctechniqueinmuvtandnpt - ensembles ] , we give a derivation of this @xmath2 , and its explicit expression is given in eq .  .    ,",
    "where @xmath1 of the system is a dynamic variable . between the reservoir 2 and the system ,",
    "a free piston is placed . this piston moves and changes the volume @xmath7 to fix the pressure of the system at @xmath3 .",
    "the system and these reservoirs are connected to a thermostat at @xmath4 , the reservoir 3 . ]    as another simple example , we thermodynamically consider a system composed of a single - component ideal gas . in this example , we assume that the reservoirs are also composed of the same ideal gas . at the thermodynamically stable point ,",
    "a relation @xmath25 holds and the particle number density of the system , @xmath26 , also equals these particle number densities of the reservoirs ; _ i.e. _ @xmath27 . however , when @xmath28 , both @xmath1 and @xmath7 diverge , since the reservoir 1 continues to increase @xmath1 of the system aiming for a large @xmath26 value and the reservoir 2 increases @xmath7 aiming for a small value of @xmath26 .",
    "when @xmath29 , both @xmath1 and @xmath7 vanish .",
    "therefore , the system reaches equilibrium only at the thermodynamically stable point .",
    "in other words , outside the thermodynamically stable point , the system is always in non - equilibrium and both the intensive and the extensive variables are indeterminate .",
    "these results also apply to systems composed of interacting particles ( _ e.g. _ non - ideal gases ) .",
    "we utilize these divergence and vanishment of the target system as a criterion for the equilibration , which can be used for the automatic adjustment of the three intensive variables , _",
    "e.g. _ by a bisection method , to determine the thermodynamically stable point .",
    "the system quickly diverges or vanishes outside the vicinity of the thermodynamically stable points  @xcite .",
    "the speed of the divergence and the vanishment increases with the difference in the intensive parameter sets from the thermodynamically stable point .",
    "on the other hand , when we need a long simulation run in the vicinity of the thermodynamically stable point , indeterminate @xmath1 could cause a computational problem , since the extensive variables could become extremely large or vanish .",
    "however , an appropriate choice of @xmath1 and @xmath7 makes the system last for a long time , within which good statistics of simulation results , _ e.g. _ particle density and lattice constants of crystals , are obtained  @xcite .",
    "we can determine such simulation results with accuracy enough to obtain the equilibrated structure of the system with the three reservoirs .",
    "if we need a far longer simulation run , the ensemble can be switched to one of the conventional methods , _",
    "e.g. _ @xmath9-ensemble or @xmath22-ensemble . as these switched ensembles",
    "are free from the problem of the indeterminate @xmath1 , they allow us to perform a longer simulation run of the equilibrated structure obtained via three - reservoirs method .    in the present article",
    ", we tentatively call the ensemble of the systems connected to the three reservoirs @xmath10-ensemble , since this is obtained as an equilibrium condition between the three intensive variables and as a combination of @xmath8 , @xmath9 , and @xmath18-ensembles .      here",
    "the statistical mechanical properties of particles in @xmath10-ensemble are discussed . according to gibbs - duhem equation",
    ", the thermodynamic potential of @xmath10-ensemble is identically equivalent to zero in the thermodynamic limit , whereas systems obeying this ensemble have certain degrees of freedom in the phase space .",
    "this means that boltzmann factor fluctuates in statistical mechanics and that the partition function of this ensemble , _ i.e. _ summation of statistical weights over the whole phase space , is defined .",
    "this boltzmann factor is calculated in the present section as a natural extension of those for @xmath8 and @xmath9-ensembles , and determines detailed balance conditions necessary for designing three - reservoirs simulation method .    for determining this boltzmann factor",
    ", we solve a maximization problem of the statistical entropy per volume in @xmath10-ensemble .",
    "the statistical entropy is defined as  @xcite , @xmath30 where the suffix , @xmath31 , represents microstates of the system , @xmath32 denotes corresponding occurrence probability , and @xmath33 is boltzmann constant . because the extensive variables of @xmath10-ensemble is indeterminate ,",
    "we choose the entropy density to be maximized . with the use of eq .",
    ", the statistical entropy per volume is given by , @xmath34 the equilibrium probability distribution , @xmath35 , which maximizes eq .",
    "under the constraints in @xmath10-ensemble , is determined by : @xmath36 where @xmath37 is the thermal average specified according to the reservoirs .",
    "the constraint of eq .   represents the normalization condition .",
    "the two constraints given by eq .   instead of three constraints",
    "are due to the thermodynamic degrees of freedom , which equal 2 . with the use of lagrange multipliers , @xmath38 , @xmath39 , and @xmath40 ,",
    "this maximization problem is reduced to  @xcite , @xmath41.\\end{aligned}\\ ] ] this reduced problem , eq .",
    ", is solved by a partial derivative with respect to @xmath32 .",
    "the solution is : @xmath42,\\ ] ] where @xmath43 , @xmath44 , and @xmath45 .",
    "equations   - , and give the statistical entropy per volume determined as thermal average as : @xmath46 equating eq .   with the thermodynamic relation for the thermodynamic potential of @xmath10-ensemble , denoted by @xmath47 , @xmath48",
    "we obtain : @xmath49 in the thermodynamic limit , the right - hand side of eq .",
    "is essentially zero compared with the other extensive variables in eq .  .",
    "this result coincides with the euler equation in thermodynamics .",
    "furthermore , for finite @xmath7 , the last term of eq .   is monotonically increasing with decreasing @xmath7 .",
    "this indicates that due to the principle of maximizing entropy a finite size system as is used in the computer simulation has a tendency to shrink even at the thermodynamically stable point . finally , from eq .",
    ", the probability distributions of the microstates are obtained as , @xmath50.\\ ] ] we confirmed that these results are also obtained by maximizing the statistical entropy per particle or the statistical entropy per internal energy instead of the statistical entropy per volume as has been done in eq .  .",
    "the boltzmann factor of @xmath10-ensemble is , @xmath51,\\ ] ] where @xmath52 denotes the total kinetic energy of the system , @xmath53 the potential energy of the system , and @xmath54 is the spatial coordinates of the particle @xmath55 . as we have seen above ,",
    "this is a result of a natural extension of @xmath8 and @xmath9-ensembles .",
    "this boltzmann factor determines the statistical properties of systems equilibrated with the three reservoirs and is equivalent to the boltzmann factor of @xmath9-ensemble at fixed @xmath1 , and is equivalent to the boltzmann factor of @xmath8-ensemble at fixed @xmath7 .",
    "guggenheim formally derived the boltzmann factors ( statistical weight ) of various ensembles  @xcite . assuming that the ensemble averages of extensive variables , e.g. @xmath7 and @xmath1 , were determined in @xmath10-ensemble",
    ", guggenheim also introduced statistical weight of this ensemble , based on analogy between other conventional ensembles  @xcite .",
    "however , in the calculation of the maximization of entropy density discussed in section  [ subsec : statisticalmechanicalpropertiesofparticlesinmuptensemble ] , guggenheim s assumption corresponds to keeping the averages @xmath56 and @xmath57 fixed , instead of the constraints eq .  .",
    "guggenheim s assumption contradicts the indetermination of the extensive variables , as was pointed out by prigogine and further discussed by sack  @xcite .",
    "prigogine showed that the summation of the resulting boltzmann factor over the phase space diverges and therefore concluded that the resulting partition function of @xmath10-ensemble does not have any physical meanings  @xcite .",
    "the thermodynamic potential of @xmath10-ensemble , @xmath47 , determined from such partition function could be indefinite while it should identically equal zero in the thermodynamic limit .",
    "the true thermodynamic potential that dominates this ensemble , similar to the helmholtz free energy in @xmath22-ensemble , remains unknown since guggenheim s article . in the following",
    ", we will answer prigogine s criticism and give an explicit expression of the thermodynamic potential for @xmath10-ensemble .    in conventional ensembles ,",
    "the statistical weight takes non - zero values only in the vicinity of the averages @xmath57 or @xmath58 in the phase space . outside this vicinity",
    ", the statistical weight quickly decreases to zero .",
    "this suppresses the divergence of the partition functions , _",
    "i.e. _ the summation of the statistical weights , in the case of conventional ensembles . on the other hand , in @xmath10-ensemble , there is no such limitation because of the indeterminate extensive variables .",
    "the statistical weight of @xmath10-ensemble at each microstate keeps non - zero values at any @xmath1 or @xmath7 .",
    "this results in the divergence of the partition function of @xmath10-ensemble .",
    "however , ratios of the statistical weights between any pair of microstates are still defined .",
    "this feature guarantees the physical validity of @xmath10-ensemble . in this case , the trajectory of the system in the phase space is similar to a free random walk in infinitely large space without boundaries .",
    "moreover , in the present study , equations   and calculated with the constraints eqs .   and indicate that the summation of the statistical weights equals @xmath59 for @xmath10-ensemble .",
    "therefore , the corresponding thermodynamic potential @xmath47 , eq .  , is negligibly small compared with the other extensive variables in eq .   and vanishes in the thermodynamic limit .",
    "furthermore , by the thermodynamic consideration given in section  [ subsec : thermodynamicsinmuptensemble ] , we have shown that @xmath10-ensemble is obtained by combining 3 underlying ensembles each with 2 reservoirs , _",
    "i.e. _ @xmath9 , @xmath8 , and @xmath18-ensembles .",
    "this thermodynamic consideration means that free energy densities of these underlying ensembles , _",
    "i.e. _ gibbs free energy per particle , grand potential per volume , and @xmath19 , are simultaneously minimized in @xmath10-ensemble , rather than @xmath47 .",
    "this corresponds to the minimization of helmholtz free energy in @xmath22-ensemble .",
    "the present simulation method is constructed based on conventional simulation methods in the grand canonical ensemble ( @xmath8-ensemble ) and @xmath9-ensemble .",
    "the simulation algorithms of the particle insertion and deletion in @xmath8-ensemble ( see appendix  [ subsec : mcsimulationmethodinmuvtensemble ] ) and the system size change in @xmath9-ensemble ( see appendix  [ subsec : mcsimulationmethodinnptensemble ] ) are directly utilized in our method .",
    "this compatibility between the present method and the conventional methods demonstrates that the algorithms of the present method satisfy detailed balance condition .",
    "one simulation step of the present method is composed of the following 4 trial steps :    a.   with probability @xmath60 , trial particle insertion into the system , b.   with probability @xmath60 , trial particle deletion from the system , c.   with probability @xmath61 , trial system size change , d.   with probability @xmath62 , trial displacement by metropolis algorithm _",
    "i.e. _ perturbation of one particle ,    is chosen , where @xmath63 and @xmath61 are constants fixed in an interval @xmath64 .    with the use of the simulation algorithms of trial particle insertion and deletion in @xmath8-ensemble , the insertion and deletion of the present method ,",
    "steps i ) and ii ) , are performed . during this particle exchange between the system and the reservoir 1 ,",
    "the system size @xmath65 is fixed .",
    "this particle exchange in the present method satisfies the detailed balance condition because it is guaranteed in @xmath8-ensemble .",
    "the trial system size change , step iii ) , is performed with use of the simulation algorithms in @xmath9-ensemble , during which @xmath1 is fixed .",
    "this system size change in the present method also satisfies the detailed balance condition . unlike the conventional mc simulations in @xmath9-ensemble based on mcdonald s method  @xcite , @xmath66 , and @xmath67",
    "are independently changed in the present method .    the trial move of one particle , step iv ) ,",
    "is performed by metropolis algorithm in @xmath22-ensemble , which also satisfies the detailed balance condition .",
    "therefore , the present mc simulation method for @xmath10-ensemble fulfills the principle of detailed balance .",
    "see also section  [ subsubsec : detailedbalanceconditionandergodicityof3-reservoirsmethod ] .",
    "our algorithm indicates that a short - time average of an intensive physical quantity in @xmath10-ensemble is approximated by ensemble averages of @xmath8 and @xmath9-ensembles at corresponding @xmath1 and @xmath7 , which is discussed in appendix  [ sec : ensembleaverageateachnandvinmuptensemble ] .",
    "our simulation is performed in a rectangular system box with independently changing system size @xmath65 . since any crystals fit into rectangular boxes with periodic boundary conditions",
    ", we do not have to introduce parrinello - rahman method  @xcite , which allows the change in the shape of the simulation box .",
    "our simulation algorithm is similar to gibbs ensemble technique , which is utilized for simulation of phase equilibria in @xmath22-ensemble  @xcite , where the phases coexisting in the same system box in @xmath22-ensemble exchange both volume and particles .",
    "a system connected to the three reservoirs at a thermodynamically stable point corresponds to this gibbs ensemble , when one of the coexisting phases in gibbs ensemble is assumed to be infinitely large that plays the role of the two reservoirs @xmath2 and @xmath3 .      in this section",
    ", the detailed balance condition and the ergodicity of three - reservoirs method are discussed .",
    "steps i ) and ii ) change @xmath1 according to the detailed balance condition as in the same way that the @xmath8-ensemble does .",
    "step iii ) changes @xmath65 according to the detailed balance condition as in the @xmath9-ensemble .",
    "the particle coordinates are updated in step iv ) , by the standard metropolis algorithm of @xmath22-ensemble . as a result ,",
    "three - reservoirs method satisfies the principle of detailed balance and ergodicity , based on the conventional ensembles which fulfill ergodicity .",
    "this indicates that @xmath1 , @xmath0 , and the particle coordinates are simultaneously updated in the phase space , so that the system realizes the equilibrium state .",
    "this also means that statistics of @xmath10-ensemble contradicts none of the three underlying ensembles with 2 reservoirs , _",
    "i.e. _ @xmath8 , @xmath9 , and @xmath18-ensembles .      in this section",
    ", we demonstrate the efficiency and stability of the three - reservoirs method using several examples .",
    "the first example is a model polymer - grafted colloidal system , which was observed to show various exotic metastable phases each of which has a long life time  @xcite .",
    "colloidal particles are made from metals , polymers , _ etc .",
    "_ and are often modeled with hard spheres  @xcite . on the other hand ,",
    "owing to van der waals attraction acting on particle surfaces , colloids are aggregating and make precipitates after a long time .",
    "for the purpose of stabilizing colloidal dispersions against the precipitation , linear polymer chains are often grafted onto the surfaces of the colloids .",
    "these are called polymer - grafted colloids . depending on the physical and chemical properties of the grafted polymers , interaction between polymer - grafted colloids",
    "changes significantly  @xcite .",
    "polymer - grafted colloids have several industrial applications due to such useful characteristics , for example filler particles immersed in a polymer matrix , and the particles in electro and magnet rheological fluids .    in our previous work",
    "@xcite , we studied the phase behavior of colloidal particles onto which diblock copolymers are grafted .",
    "pair interaction potential between these polymer - grafted colloids was numerically determined via self - consistent field calculation  @xcite as a function of the distance between centers of the particles , @xmath68 .",
    "this potential has been approximated by spherically symmetrical repulsive square - step potential with a rigid core of diameter @xmath69 and a square - step repulsive potential of diameter @xmath70 and height @xmath71 as : @xmath72 where the step potential is originated from the grafted polymer brushes .",
    "this interaction potential @xmath73 is purely repulsive . simulating particles interacting via @xmath73 in @xmath22-ensemble ,",
    "we have studied phase behavior of these colloidal systems .",
    "these mc simulation results  @xcite show that , at low temperature , high pressure , and @xmath74 , our particles self - assemble into string - like assembly .",
    "the positions and the mean - square displacement of the particles show that the string - like assembly is observed in disordered solid phases .",
    "actually , such a string - like assembly has been observed recently in experiments  @xcite .",
    "in addition to such string - like assembly , various structures , _ e.g. _ dimers and lamellae  @xcite , and also glass transition  @xcite are observed in the same model system .",
    "it was also shown that the particles interacting via continuous repulsive potential similar to the above @xmath73 show these string - like and other various assemblies  @xcite . in these recent studies using @xmath22-ensemble at finite @xmath4 in both 2 and 3-dimensions",
    ", it was shown that this string - like assembly with a local alignment in the same direction but with a global isotropy is a metastable structure .",
    "although a variety of ground states of the same model system at zero temperature have been discovered via genetic algorithms  @xcite , equilibrium states at finite temperature have not been understood yet .",
    "we simulate the equilibrated states of our model system at finite @xmath4 via three - reservoirs method . in the present simulation work , @xmath69 and @xmath75",
    "are taken as the unit length and the unit energy , respectively .",
    "simulation is performed on 2 dimensional systems .",
    "we define dimensionless chemical potential as  @xcite , @xmath76 the thermal de broglie wave length @xmath77 , defined in eq .   in appendix",
    "[ sec : molecularmctechniqueinmuvtandnpt - ensembles ] , is removed from @xmath2 in eq .",
    ", since simulation results are independent of @xmath77 , which is discussed in appendix  [ sec : molecularmctechniqueinmuvtandnpt - ensembles ] . in the present article",
    ", @xmath78 is fixed .",
    "in the initial state , @xmath79 particles are arranged on a homogeneous triangular lattice in a square system box , @xmath80 , with the periodic boundary condition . for the trial move of the particles , _",
    "i.e. _ metropolis algorithm , a particle is picked at random and given a uniform random and isotropic trial displacement within a square whose sides have length @xmath81 .",
    "@xmath82 is fixed at @xmath83 .",
    "the probability @xmath84 and @xmath85 . with this @xmath61 ,",
    "the computational time for the simulation is about twice as long as the simulation in @xmath22-ensemble",
    ". 1 monte carlo step ( mcs ) is defined as @xmath79 simulation steps .",
    "the mersenne twister algorithm  @xcite is adopted as a uniform random number generator for our simulation .      in our previous @xmath22-ensemble simulation with the potential step width , @xmath78",
    ", we found  @xcite that the string length diverges at @xmath86 and @xmath87 . at this low @xmath88 , using three - reservoirs method , we simulate the system . in the present simulation , the density @xmath89 is initially set at 0.451 for @xmath90 system .",
    "first , simulating the system at various values of @xmath91 , we search for the thermodynamically stable point at fixed @xmath92 .",
    "the given @xmath91 is , 1 ) : @xmath93 , 2 ) : @xmath94 , 3 ) : @xmath95 , 4 ) : @xmath96 , and 5 ) : @xmath97 . as an example",
    ", a snapshot of the system at 1 ) is presented in fig .",
    "[ fig : frog2dmupts20snapshots](a ) . despite different @xmath91 ,",
    "all the systems of 1 ) to 5 ) show similar well - aligned globally - anisotropic defect - free string - like assembly , though the system in @xmath22-ensemble at @xmath98 and @xmath99 presents the globally - isotropic string - like assembly as is shown in fig .",
    "[ fig : frog2dmupts20snapshots](c )  @xcite . only small and short - lived defects caused by the thermal fluctuation",
    "can be generated in the systems simulated with @xmath10-ensemble , whereas many long - lived defects are observed in @xmath22 simulation .",
    "time evolutions of @xmath89 and @xmath1 at 1 ) to 5 ) are given in fig .",
    "[ fig : frog2dmupts20t012forarticle - rhoandn ] . all the data for the time evolution of @xmath89 shown in fig .",
    "[ fig : frog2dmupts20t012forarticle - rhoandn](a ) are fluctuating in the vicinity of @xmath87 , regardless of @xmath91 .",
    "it would be worth noting that the simulations started from different initial conditions , _",
    "e.g. _ different initial particle density @xmath89 and different system aspect ratio of the simulation box @xmath100 , also reach the same results as long as the intensive variables of the reservoirs , @xmath91 , @xmath101 , and @xmath88 are the same . furthermore , outside this range of @xmath91 from 1 ) to 5 ) , the system diverges ( @xmath102 ) or vanishes ( @xmath103 ) just after the simulation starts .",
    "these results illustrate that this region of @xmath91 is located in the vicinity of the thermodynamically stable point at this pressure , @xmath92 .    , ( a ) , and time evolution of @xmath1 , ( b ) , simulated at @xmath86 and various @xmath104 , @xmath105 .",
    "lines 1 ) to 5 ) are simulation results at @xmath92 .",
    "1 ) : @xmath93 .",
    "2 ) : @xmath94 .",
    "3 ) : @xmath95 .",
    "4 ) : @xmath96 .",
    "5 ) : @xmath97 . lines 6 ) to 8) are simulation results at @xmath94 .",
    "6 ) : @xmath106 .",
    "7 ) : @xmath107 .",
    "8) : @xmath108 . ]",
    "on the other hand , time evolution of @xmath1 , plotted in fig .",
    "[ fig : frog2dmupts20t012forarticle - rhoandn](b ) , indicates that the total system size depends on @xmath91 in a systematic manner . at small mcs , line 1 )",
    "indicates the tendency of the vanishment and lines 2 ) to 5 ) the tendency of the divergence .",
    "this means that , in a short computational time , the thermodynamically stable point is expected to lie between 1 ) : @xmath93 and 2 ) : @xmath94 , which corresponds to a relative error of some percent .",
    "the abrupt time evolution of @xmath1 stops at less than @xmath109 mcs , whereas the system slowly continues diverging or vanishing at larger mcs .",
    "the mcs needed for the divergence or the vanishment becomes larger when we choose parameter sets close to the exact values at the thermodynamically stable point .",
    "this is utilized as a criterion for measuring the convergence of the thermodynamic intensive variables in @xmath10-ensemble .",
    "although we stop the simulation with this relative error of some percent , the accuracy of the thermodynamically stable point could be raised , _",
    "e.g. _ by the bisection method improving the accuracy of @xmath91 .",
    "lines 6 ) to 8) in fig .",
    "[ fig : frog2dmupts20t012forarticle - rhoandn ] show the results of a similar series of simulations for a fixed value of @xmath94 ( the same value as that for line 2 ) ) and changing the value of @xmath101 .",
    "this @xmath91 is consistent with the thermodynamically stable point at @xmath92 obtained above within the relative error of some percent .",
    "the given @xmath101 of lines 6 ) to 8) ranges @xmath106 to 1.1 . a snapshot of the system at 8) is presented in fig .  [ fig : frog2dmupts20snapshots](b ) .",
    "despite different intensive parameter sets , all the systems of 6 ) to 8) show the globally - anisotropic defect - free string - like assembly similar to fig .",
    "[ fig : frog2dmupts20snapshots](a ) .",
    "long - lived defects are absent in these systems .",
    "all the lines 6 ) to 8) in fig .",
    "[ fig : frog2dmupts20t012forarticle - rhoandn](a ) are fluctuating around lines 1 ) to 5 ) , _ i.e. _ the vicinity of @xmath87 .",
    "for the values of @xmath101 outside this range , @xmath1 quickly diverges or vanishes . from these data , we recognize that the present thermodynamically stable point lies between 7 ) : @xmath107 and 8) : @xmath108 .",
    "this thermodynamically stable point is equal to the one we obtained above within a relative error of some percent , as is expected .",
    "once the thermodynamically stable point is determined accurately in @xmath10-ensemble , we can exchange the ensemble to a conventional one , _ e.g. _ @xmath9-ensemble or @xmath22-ensemble , and can perform a longer simulation run , which is free from the divergence or the vanishment of @xmath1 .",
    "as is expected , we can perform longer simulation runs even with the @xmath10-ensemble if the thermodynamically stable point is determined with higher accuracy .",
    "next , we check the stability of our simulation method . starting from the instantaneous microstate shown in fig .",
    "[ fig : frog2dmupts20snapshots](a ) , we resume simulation runs after disconnecting the reservoirs 1 or 2 , which corresponds to simulations with @xmath9 or @xmath8-ensemble .    snapshots of the system and the time evolution of @xmath89 in these resumed simulation runs are given in figs .",
    "[ fig : frog2dmupts20snapshotsinvariousensembles ] and [ fig : frog2dmupts20rd001e14p10t012innptmuvt - rho ] respectively .",
    "both of these simulation runs preserve the same string - like assembly . in @xmath9-ensemble case",
    ", a value of @xmath89 that is close to that for three - reservoirs method is also obtained .",
    "therefore , the equilibrium state obtained via three - reservoirs method does not change even after the ensemble is switched .",
    "these results justify our method for determining the thermodynamically stable point with @xmath10-ensemble .    .",
    "black dots represent the centers of the particles and grey lines denote networks of overlaps between the particles . from the instantaneous state of fig .",
    "[ fig : frog2dmupts20snapshots](a ) , simulations are resumed after disconnecting the reservoir 1 or 2 , i.e. simulations are resumed with @xmath9 or @xmath8-ensemble .",
    "( a ) : simulation result at @xmath110 mcs , after resuming the simulation with @xmath9-ensemble .",
    "( b ) : simulation result at @xmath111 mcs , after resuming the simulation with @xmath8-ensemble . ]     in simulations with @xmath9 and @xmath8-ensembles that are resumed from the instantaneous state shown in fig .",
    "[ fig : frog2dmupts20snapshots](a ) . in these simulation runs ,",
    "the number of the particles is @xmath112 with minor fluctuations . for reference ,",
    "the result of the simulation with @xmath10-ensemble is also shown . ]    here , one can recognize occurrence of a few defects and undulation of the string - like assemblies after switching the ensembles .",
    "this should be attributed to the difference in the nature of the thermal fluctuations of a finite system between different ensembles .",
    "for example , when a particle is removed from a perfect triangular crystal in @xmath10-ensemble and simultaneously the ensemble is exchanged to @xmath9-ensemble , long - lived defects are created in the crystal .",
    "figure  [ fig : frog2dmupts20snapshotsinvariousensembles](a ) shows this finite size effect . in the thermodynamic limit where the system size becomes infinitely large",
    ", such a difference should vanish .",
    "we also recognize a slight drop in @xmath89 in @xmath8-ensemble by approximately 2% .",
    "this is also related to the finite size effect of the @xmath8-ensemble , which will be further discussed in section  [ subsubsec : aldertransitionoftheoutercores ] .",
    "the undulation of the string - like assembly shown in fig .",
    "[ fig : frog2dmupts20snapshotsinvariousensembles](b ) corresponds to zigzag instability typically observed in convection rolls in a fluid slab when its natural periodicity is suddenly changed  @xcite .",
    "this zigzag instability is consistent with the slight drop in @xmath89 , _",
    "i.e. _ a slight increase in the system size , in @xmath8-ensemble shown in fig .",
    "[ fig : frog2dmupts20rd001e14p10t012innptmuvt - rho ] .",
    "these simulation results show that the physical properties of the system , in conventional ensembles , sensitively depend on @xmath1 and the system box size while they do not strongly depend on @xmath1 in @xmath10-ensemble .      at extremely low temperature ,",
    "the repulsive square - step of @xmath73 becomes far higher than the thermal energy , @xmath113 . due to this extremely high potential energy barrier ,",
    "the phase behavior of the system is almost identical to the behavior of hard particle systems with diameter @xmath70 if the system volume @xmath7 exceeds the close - packed volume ( area ) of the outer cores of the particles , denoted by @xmath114 ( @xmath115 in 2 dimensions )  @xcite .",
    "therefore , crystalization of the hard particles at high density , called alder transition  @xcite , occurs in our system at @xmath116 and low temperature  @xcite . here",
    "we simulate this triangular crystal of the outer cores of our colloids with the diamter @xmath70 at low temperature @xmath117 , where we fixed the parameters @xmath118 that are determined via the iterative refinement of @xmath3 and @xmath2 .",
    "the stability of this thermodynamically stable point is discussed later in the present section .",
    "-ensemble at @xmath119 and @xmath120 at @xmath121 mcs .",
    "the initial system volume is set at @xmath122 .",
    "black circles represent the inner cores of the particles and white ones denote the outer cores . ]    , ( a ) , and @xmath1 , ( b ) and ( c ) , in the simulations with the @xmath10-ensemble at @xmath119 .",
    "black lines denote the results of that are started from the initial condition with @xmath122 and @xmath120 and grey lines from that with @xmath123 and @xmath124 . ]    simulation with the @xmath10-ensemble is started from an initial state with @xmath122 and @xmath120 .",
    "we prepared this initial configuration by removing the particles from the equilibrium configuration with @xmath125 particles arranged on a homogeneous triangular lattice , which results in an inhomogeneous particle configuration .",
    "such an inhomogeneous configuration is swiftly equilibrated in @xmath10-ensemble as is shown in fig .",
    "[ fig : frog2dmupts20rd01e09p045t01inin1089iniv4778.38_009000000mcs ] . a snapshot of the system simulated with the @xmath10-ensemble , which is presented in fig .",
    "[ fig : frog2dmupts20rd01e09p045t01inin1089iniv4778.38_009000000mcs ] , shows the defect - free triangular crystal .",
    "temporary small defects due to thermal fluctuation are sometimes found in the system , whereas long - lived defects are absent .",
    "time evolution of @xmath89 and @xmath1 is plotted in fig .",
    "[ fig : frog2dmupts20rd01e09p045t01inin1089iniv4778.38inin1221iniv5647.18-rhoandn ] . small fluctuation in @xmath1 indicates the high stability of this defect - free crystalline state .",
    "different initial particle configuration also results in a similar defect - free crystalline state with the same average @xmath89 .",
    "time evolutions of @xmath89 and @xmath1 for simulation on the system with different @xmath79 and initial @xmath126 are also plotted in fig .",
    "[ fig : frog2dmupts20rd01e09p045t01inin1089iniv4778.38inin1221iniv5647.18-rhoandn ] , which show the same defect - free structure .",
    "this demonstrates the high stability of the defect - free crystalline state obtained via three - reservoirs method .",
    "next , we compare physical characteristics of @xmath10-ensemble with these of the conventional ensembles . for this purpose , we perform simulations also with the conventional ensembles , _ i.e. _ @xmath9 and @xmath8-ensembles , with the same parameters @xmath119 .    different from the @xmath10-ensemble case , in the present @xmath9-ensemble case , we have to manually tune the value of @xmath1 so that the perfect ordered equilibrium structure can be obtained .",
    "for this reason , we perform a series of simulations with @xmath9-ensemble for all the values of @xmath1 within an interval @xmath127 , where @xmath128 and 1 mcs = @xmath1 simulation steps are fixed and the initial system volume is still @xmath122 .",
    "the only parameter that is changed from the above @xmath10-ensemble simulation is @xmath1 .",
    "typical examples of the time evolution of @xmath89 in these simulation runs are plotted in fig .",
    "[ fig : frog2dnpts20p045t01n - rho ] . for reference ,",
    "the result with the parameter optimized in @xmath10-ensemble , @xmath129 , is also plotted in this figure .",
    "the system with this optimized parameter shows the defect - free triangular crystal and its value of @xmath89 is close to the results of the @xmath10-ensemble .",
    "however , with any value of @xmath1 in the above interval , long - lived defects , mostly point defects , appear in the system , as is shown in fig .",
    "[ fig : frog2dnpts20p045t01n1082n1089_020000000mcs ] .",
    "moreover , the average value of @xmath89 changes with the change in @xmath1 slightly , nonmonotonically , and sensitively .",
    "this behavior is different from the results of the @xmath10-ensemble .",
    "this means that , although the external intensive variables @xmath11 are fixed , physical properties of the system in @xmath9-ensemble sensitively depend on the external extensive variable , @xmath1 .     in @xmath9-ensemble at @xmath130 .",
    "]        in @xmath8-ensemble , the system size has to manually be tuned .",
    "actually , we try such a manual tuning by performing the @xmath8-ensemble simulation with various system sizes in an interval @xmath131 .",
    "aspect ratio of the system box is kept at a typical value for molecular simulation , @xmath80 .",
    "simulation parameters that are changed from those of the corresponding @xmath10-ensemble simulation are @xmath7 and @xmath132 .",
    "we assume that 1 mcs = @xmath79 simulation steps .",
    "all the systems we have simulated show the defect - free triangular crystals , since point defects are directly removed by the particle insertion and deletion processes .",
    "long - lived defects are not found in these simulation runs with @xmath8-ensemble . however , the average value of @xmath89 sensitively and nonmonotonically depends on the value of @xmath126 .",
    "typical examples of time evolution of @xmath89 are given in fig .",
    "[ fig : frog2dmuvts20rd01e09t01iniv - rho ] . although the intensive variables @xmath16 are specified by the reservoirs , physical properties of the system in @xmath8-ensemble significantly depend on the extensive variable @xmath7 . the data for the simulation with @xmath133 , which is the optimized value obtained in the three - reservoirs method , are also plotted by a black line .",
    "we can confirm that the optimized value of @xmath89 is preserved during the simulation run .",
    "this result justifies the simulation results obtained using three - reservoirs method .",
    "obtained with @xmath8-ensemble at @xmath134 .",
    "the black line denotes the result at @xmath133 , which is the optimized value obtained with three - reservoirs method . ]    in the @xmath8-ensemble simulations , the particle density @xmath26 can be adjusted only discretely because of the discrete nature of @xmath1 , and therefore the behavior of @xmath26 in @xmath8-ensemble is rather abrupt and sensitive to the other parameters .",
    "however , in this @xmath8-ensemble case , the point defects can rather easily be removed even in high - density states _",
    "e.g. _ in a triangular crystal . on the other hand in @xmath9-ensemble , @xmath26 is changed by the change in the continuous dynamic variables , @xmath65 .",
    "this results in a smaller change in the average @xmath26 compared with that in @xmath8-ensemble .",
    "however , long - lived defects are frequently found in @xmath9-ensemble .",
    "three - reservoirs method overcomes these disadvantages of @xmath8 and @xmath9-ensembles and , at the same time , it inherits the advantages of these ensemble methods . in @xmath10-ensemble ,",
    "both point defects and line defects can be removed easily , and the extensive variables can finely and spontaneously be tuned .",
    "the simulation results in section  [ subsec : examinationof3-reservoirsmethod ] show that it is a tedious task to perform the manual tuning of @xmath1 and the system size in conventional ensembles , whereas these extensive variables are automatically and finely tuned in our @xmath10-ensemble . in the conventional ensembles where",
    "at least one extensive variable is fixed , physical properties of the system are significantly dependent on the value of such a fixed extensive variable .",
    "this illustrates that , for example , the equilibrium state of a system in @xmath9-ensemble depends on @xmath1 even though the intensive variables @xmath4 and @xmath3 are fixed . as another example , the equilibrium state of a system in @xmath22-ensemble changes with @xmath1 and @xmath65 even though the external intensive variables @xmath4 and @xmath12 are fixed .",
    "the equilibrium state in conventional ensembles is specified by the parameter sets of the external extensive variables as well as the external intensive variables . in the present article",
    ", we tentatively define the local equilibrium state as the equilibrium state at each parameter set of the external extensive variables with the fixed external intensive variables .    in @xmath10-ensemble ,",
    "however , the extensive variables are finely and spontaneously tuned and the most stable state over the local equilibrium states at the given @xmath135 is automatically obtained . in the present article , we tentatively call this equilibrium state in @xmath10-ensemble the global equilibrium state .",
    "as these dependences of the physical properties on the external extensive variables in conventional ensembles are regarded as a finite size effect , the three - reservoirs method is a technique to remove the finite size effect of the conventional ensemble methods .",
    "any local equilibrium states are , in the thermodynamic limit , identical to the global equilibrium state .      in molecular simulations , physical quantities of the simulation system are defined through the ensemble average over the probability distribution of the microstates in the phase space .",
    "the evaluation of the free energy of such a system , however , is equivalent to the evaluation of its partition function . as the partition function is not an averaged quantity over the ensemble , its evaluation demands a high dimensional integral over the whole phase space , resulting in unrealistically large amounts of computational cost .    instead of evaluating the partition function directly , a derivative of the free energy with a control parameter , _",
    "e.g. _ pressure in the canonical ensemble , is calculated for the sake of evaluating the free energy in standard molecular simulation  @xcite .",
    "this technique , which is usually called the thermodynamic integration , gives the free energy difference between two different thermodynamic states .",
    "however , with this technique one can not go across a first - order phase transition .",
    "for example , when the two thermodynamic states are located in a solid phase and in a fluid phase respectively , a first - order transition occurs in the middle of the integration path . due to",
    "possible hysteresis at this transition point , forward and backward integration paths between the two states in general gives different values for the free energy difference .",
    "this problem also affects the other free energy calculation techniques , _",
    "e.g. _ histogram reweighting technique  @xcite and the method of expanded ensembles  @xcite . in order to overcome this difficulty",
    ", we need to find appropriate reference states , whose free energy values are already known  @xcite , _",
    "einstein solid for the free energy calculation of crystals  @xcite .",
    "these reference states provide reversible integration paths .",
    "if we can not find such reference states , we have to find integration paths that bypasses the first - order transition line , _",
    "e.g. _ an integration path that is arranged with the help of artificially introduced external fields  @xcite . after setting a reversible integration path using these techniques , we run simulations at a large number of state points along the integration path , and integrate the derivative of the free energy along this path .",
    "in addition to the discretization error in the integration along the path , occurrence of defects in the system also affects the accuracy of the free energy evaluation of the ordered structures .",
    "here we propose , based on euler equation in thermodynamics , a convenient method for the free energy calculation using the systems connected to the three reservoirs .",
    "the entropy of the system per particle , denoted by @xmath136 , satisfies euler equation , @xmath137 where @xmath138 denotes the total kinetic energy of the system , @xmath53 denotes the total potential energy , and @xmath139 is the ensemble average at @xmath140 . in the right - hand side of this equation , the 3 intensive variables , @xmath4 , @xmath3 , and @xmath2 of the system , relax to the equilibrium values that are equal to those given by the reservoirs .",
    "@xmath141 is determined via the equipartition theorem , _ e.g. _",
    "@xmath142 for monatomic molecules .",
    "the ensemble averages @xmath143 and @xmath144 can directly and readily be evaluated through the simulation runs of the three - reservoirs method .",
    "therefore , according to this euler equation , @xmath145 is determined from our simulation at one state point @xmath140 , which means that this free energy evaluation method requires far smaller amounts of computation than the other standard methods do .",
    "the free energy of the system , _",
    "e.g. _ helmholtz free energy , gibbs free energy , and grand potential , is also obtained from this result in a similar manner . since",
    "our entropy and free energy calculation method is free from any thermodynamic integration paths , the first - order phase transition does not affect our evaluation method .",
    "in addition , with the three - reservoirs method we can easily eliminate the defects which is the main origin of the error in the free energy evaluation for the ordered phases .",
    "this raises the accuracy of the evaluation .    in our molecular simulation",
    ", @xmath2 includes the thermal de broglie wave length @xmath77 , as is discussed in appendix  [ sec : molecularmctechniqueinmuvtandnpt - ensembles ] , _ i.e. _ eq .  . @xmath146 and @xmath147 in @xmath77",
    "cancel when the free energy difference between two different state points is calculated .",
    "therefore , we do not have to take care of these @xmath146 and @xmath147 .",
    "although the above method based on euler equation is , in principle , applicable to simulations with the other ensembles , _",
    "e.g. _ @xmath22 and @xmath9-ensembles , one has to measure intensive variables @xmath3 and/or @xmath2 as ensemble averaged values .",
    "such a procedure requires a computationally expensive analysis .",
    "for example , the measurement of @xmath2 , _",
    "i.e. _ gibbs free energy per particle , demands a vast amount of simulation , especially in high particle density regions  @xcite .",
    "however , in the @xmath8-ensemble or @xmath10-ensemble , we do not have to evaluate @xmath2 because it is already given by the reservoir .",
    "same is true for the evaluation of the pressure @xmath3 . as a result , with the use of the @xmath10-ensemble",
    ", we can skip tedious evaluations of the intensive variables because all the essential intensive variables @xmath2 , @xmath3 , and @xmath4 are already specified by the reservoirs .",
    "in addition , metastable structures and defects , which frequently appear in conventional ensembles , affect the results of this entropy and free energy evaluation .",
    "when the system is in metastable states or outside the global equilibrium state , the intensive variables given from the reservoirs are inconsistent with the values of these variables in the simulation system .",
    "this means that both @xmath2 and @xmath3 need to be analyzed in the simulation rather than to use the specified value by the reservoirs .",
    "however , as the defects are quickly eliminated and the system reaches the global equilibrium in the simulations with the @xmath10-ensemble , the evaluation of the free energy is free from the above problem associated with the metastable states and the local equilibrium states .      when one tries to construct the equilibrium phase diagrams using conventional simulation methods , candidates for the equilibrium structure have to be chosen prior to the simulation and the free energy of each candidate should be measured and compared with each other with high accuracy , for example , with a typical error level  @xcite of @xmath148 to @xmath149 . a variety of phases , _",
    "e.g. _ crystals , the string - like assemblies , and the other ordered and disordered structures should be considered the candidates for the equilibrium phase . in actual calculation",
    ", we empirically select some of these potential candidates and discard the others .",
    "however , we can not deny the possibility that we have discarded the true equilibrium structure in this selection process .",
    "in addition , there is another possibility that the equilibrium structure is a totally new structure which has not been discovered yet .    with the use of @xmath10-ensemble ,",
    "however , one can obtain the global equilibrium structure directly as a result of the fine tuning of the extensive variables .",
    "therefore , the above - mentioned problem encountered in the construction of the phase diagram using the standard ensembles can be avoided when we use @xmath10-ensemble .",
    "we have studied thermodynamics , statistical mechanics , and molecular mc simulation algorithms of @xmath10-ensemble .",
    "guggenheim formally introduced boltzmann factor ( statistical weight ) of this ensemble with an assumption that the averages of extensive variables can be determined  @xcite . however",
    ", this assumption contradicts the indetermination of extensive variables in @xmath10-ensemble .",
    "in addition , other characteristics of this ensemble were totally absent in guggenheim s discussion and other early works  @xcite .",
    "these early researchers concentrated on the formalism , i.e. mathematical aspects of the partition function of this ensemble , only at the thermodynamically stable point  @xcite .",
    "physical aspects of the ensemble have not seriously been discussed . in the present work ,",
    "we have shed light on these problems and have discovered thermodynamic and statistical mechanical characteristics of @xmath10-ensemble , _",
    "e.g. _ the thermodynamically stable point , thermodynamic degrees of freedom , thermodynamics outside the thermodynamically stable point , maximization of entropy density , quick equilibration due to shortcuts in the phase space , _ etc .",
    "_ we have also shown that @xmath10-ensemble is built as a combination of the 3 ensembles each of which is combined to 2 reservoirs , _",
    "i.e. _ @xmath9 , @xmath8 , and @xmath18-ensembles .",
    "the 3 corresponding free energy densities , _",
    "i.e. _ gibbs free energy per particle , grand potential per volume , and @xmath19 , are simultaneously minimized in @xmath10-ensemble , rather than the thermodynamic potential of @xmath10-ensemble , denoted by @xmath47 .",
    "we have proposed a molecular mc simulation method based on @xmath10-ensemble ( three - reservoirs method )  @xcite .",
    "we can show that this three - reservoirs method gives a physically acceptable ensemble , which allows us to trace the physical trajectories in the phase space . since three - reservoirs method is built as a combination of conventional @xmath9 and @xmath8-ensembles , programming is lighter than other advanced techniques .",
    "in addition , the thermodynamically stable point is determined according to gibbs - duhem equation in a short computational time .",
    "these features mean that three - reservoirs method requires a small amount of preparation and that we can quickly start production simulation runs , although other advanced techniques demand a large quantity of complicated preparation , _",
    "e.g. _ advanced programming , the precise adjustments of the artificial weights necessary for multicanonical technique , and accurate free energy measurement essential for the expanded ensemble technique  @xcite .",
    "these advantages over other simulation techniques facilitate and reduce the total work flow of our three - reservoirs method compared with the conventional methods such as @xmath9 , @xmath8 , or multicanonical method .",
    "furthermore , only with the three - reservoirs method , we can _ simultaneously _ and _ automatically _ tune the number of particles @xmath1 and the system size to obtain the equilibrium ordered state . this unique advantage of the three - reservoirs method could enhance the understanding of those systems that were obtained via the other standard simulation techniques .",
    "for example , for perfect crystals , both @xmath1 and @xmath0 must be integer multiples of the unit structure of the crystal structure , which is in general not known _ a priori_. in principle , by measuring the free energy density of various structures at each set of @xmath1 and @xmath0 ,",
    "these extensive parameters can manually be tuned in simulation of @xmath9-ensemble , @xmath8-ensemble , multicanonical ensemble , _ etc .",
    "_ in practice , however , this manual tuning requires much computational effort . on the other hand , with the use of our three - reservoirs method",
    ", we can automatically achieve such optimization .    for a solid at finite temperature @xmath4 ,",
    "the system with the @xmath10-ensemble reaches a globally - anisotropic defect - free ordered state as the equilibrium state by crossing the metastable states through the shortcuts in the phase space due to the additional degrees of freedom . on the other hand , in conventional ensembles , physical properties of the system",
    "sensitively and discretely depend on @xmath1 and/or @xmath0 even though external intensive variables are fixed .",
    "this results in a requirement of the manual tuning of these extensive variables to obtain the global equilibrium state .",
    "these results illustrate that our method can be applied to a variety of physical systems for the sake of studying ordered structures in equilibrium at finite @xmath4 , _",
    "e.g. _ lamellae composed of diblock copolymers , smectic phase of liquid crystals , and fluid bilayer membranes .",
    "three - reservoirs method can also be applied to numerical calculation of the equation of state that relates @xmath2 , @xmath3 , and @xmath4 .",
    "we have also shown that the entropy and the free energy can quickly be evaluated in @xmath10-ensemble based on euler equation .",
    "this feature is essentially important in the construction of the phase diagram of condensed materials .",
    "the authors wish to thank professor komajiro niizeki and mr masatoshi toda for helpful suggestions and discussions .",
    "we also thank the anonymous referees for their valuable suggestions and comments .",
    "this work is partially supported by a grant - in - aid for science from the ministry of education , culture , sports , science , and technology , japan .",
    "in this appendix , we show molecular mc simulation technique  @xcite for single component systems based on the @xmath8 and @xmath9-ensembles .",
    "we use the following notations : @xmath54 denotes the spatial coordinates of the particle @xmath55 , @xmath147 mass of a particle , @xmath113 the thermal energy , @xmath53 the potential energy of the system , and @xmath146 planck s constant .",
    "the chemical potential of a system consisting of real particles in the canonical ensemble ( @xmath22-ensemble ) is given by , @xmath150 where @xmath151 and @xmath152 here , @xmath153 denotes the chemical potential of an ideal gas in @xmath22-ensemble and @xmath77 is called the thermal de broglie wave length .",
    "the quantity @xmath154 denotes the excess chemical potential that is originated from the interaction between the real particles  @xcite .",
    "simulation results in @xmath8-ensemble are independent of @xmath77 .",
    "this means that @xmath77 only appears in the chemical potential @xmath2 at the reference point in @xmath8-ensemble simulation , which is discussed in section  [ subsec : mcsimulationmethodinmuvtensemble ] .      in the present section ,",
    "we discuss the mc method of a single component system in the grand canonical ensemble , which is also called @xmath8-ensemble because @xmath2 , @xmath7 , and @xmath4 are kept fixed .    in simulation with the @xmath8-ensemble  @xcite , particles are inserted into and deleted from the system in addition to metropolis trial displacement of particles . in one simulation for this ensemble",
    ", these steps are included in :    a.   with probability @xmath60 , trial particle insertion into the system b.   with probability @xmath60 , trial particle deletion from the system c.   with probability @xmath155 , trial displacement based on metropolis algorithm , _",
    "i.e. _ perturbation to one particle    is chosen , where @xmath63 is a constant fixed in an interval @xmath156 .",
    "algorithms of trial particle insertion and deletion are discussed in the following .",
    "we assume that one particle is inserted into the system that is composed of @xmath1 particles .",
    "the position of this inserted particle @xmath157 is chosen uniformly over the system box .",
    "the coordinates of the @xmath1 particles , @xmath158 , are fixed during this particle insertion step .",
    "the state after the insertion , _",
    "i.e. _ the state of @xmath159 particles , is accepted as a new state with the probability , @xmath160",
    "\\right ) ,   \\\\      & u^{\\text{ins}}_{\\text{excess } } : = u \\left ( \\rvector_1 , \\dots , \\rvector_{n+1 } \\right ) - u \\left ( \\rvector_1 , \\dots , \\rvector_n \\right ) .   \\notag\\end{aligned}\\ ] ] a function @xmath161 returns the smaller of two arguments , @xmath162 and @xmath163 .",
    "if the trial insertion is rejected , the state before the insertion is kept for the next simulation step .",
    "we assume that one particle is randomly chosen and attempts to be removed from the present system composed of @xmath1 particles .",
    "this chosen particle , denoted by index @xmath31 , is removed from the system with the probability , @xmath164 } \\right ) ,   \\\\",
    "u^{\\text{del}}_{\\text{excess } } : = u \\left ( \\rvector_1 , \\dots , \\rvector_n \\right ) - u \\left ( \\rvector_1 , \\dots , \\rvector_{j-1 } , \\rvector_{j+1 } , \\dots , \\rvector_n \\right ) .",
    "\\notag\\end{gathered}\\ ] ] if the trial deletion is rejected , the state before the deletion is kept for the next simulation step .",
    "when @xmath165 is substituted for @xmath2 in eqs .   and , these acceptance criteria are independent of @xmath77 .",
    "this illustrates that simulation results in @xmath8-ensemble are free from the actual value of @xmath77 .",
    "therefore , @xmath77 appears only in the chemical potential @xmath2 at the reference point in the @xmath8-ensemble simulation  @xcite .",
    "mc simulation method in isobaric - isothermal ensemble  @xcite , also called @xmath9-ensemble , is briefly summarized in this section .",
    "in addition to @xmath1 and @xmath4 , the system pressure , denoted by @xmath3 , is given from the outside , in this ensemble .",
    "in simulation of @xmath9-ensemble , the system size is changed , in addition to the trial move of particles . in one simulation step , we include the following steps :    a.   with probability @xmath61 , trial system size change b.   with probability @xmath166 , trial displacement based on metropolis algorithm , _ i.e. _ perturbation of one particle    is chosen , where @xmath61 is a constant fixed in an interval @xmath167 .",
    "algorithms of trial system size change are discussed in the following .",
    "to change the system box size , we use the following 4-step algorithm .",
    "we assume that the system box size , denoted by @xmath0 , is changed to a new system size , @xmath168 .",
    "unlike the conventional mc simulations in @xmath9-ensemble based on mcdonald s method  @xcite , each element of the system size @xmath0 is independently changed in our algorithm .    1 .",
    "the new system size is chosen , @xmath169 where @xmath82 is a small constant length , @xmath170 , and @xmath171 are random numbers uniformly distributed over an interval @xmath172 , and @xmath173 denotes the volume of the new system box .",
    "coordinates of all the particles before the system size change , @xmath174 , are homogeneously scaled , @xmath175 this is new particle coordinates after the change .",
    "3 .   the potential energies of the systems before and after the system size change , @xmath176 and @xmath177 respectively , are calculated .",
    "the new system size and particle coordinates are accepted with the probability , @xmath178",
    "\\right ) .      \\end{gathered}\\ ] ] if this trial system size change is rejected , the state before the trial is kept for the next simulation step .",
    "the ensemble average at each @xmath1 in @xmath10-ensemble is equivalent to the average in @xmath9-ensemble at the same @xmath1 .",
    "we illustrate this in the present section .",
    "we assume that a finitely long simulation run is performed in @xmath10-ensemble at a thermodynamically stable point .",
    "after the equilibration of the simulation system , a finitely large number of microstates of the system are visited .",
    "unnormalized boltzmann factor of the system is denoted by @xmath179 , where the suffix @xmath55 represents these microstates .",
    "@xmath180 is kronecker delta . @xmath181 .",
    "after the equilibration of the system , the ensemble average of an intensive physical quantity , @xmath182 , obtained in the present simulation run is : @xmath183 }   { \\sum_i \\delta_{n_i , n } \\frac{1 } { \\varlambda^{3n } \\ , n ! } \\exp \\left [ - \\beta \\left ( p v_i - \\mu n + u_i \\right ) \\right ] }   \\notag \\\\      & \\quad = \\sum_{n=0}^{\\infty } f(n ) \\frac { \\sum_i \\delta_{n_i , n } a_i \\exp \\left [ - \\beta \\left ( p v_i + u_i \\right ) \\right ] }   { \\sum_i \\delta_{n_i , n } \\exp \\left [ - \\beta \\left ( p v_i + u_i \\right ) \\right ] }   \\notag \\\\      & \\quad \\cong \\sum_{n=0}^{\\infty } f(n ) \\ , \\langle a \\rangle _ { t , p , n},\\end{aligned}\\ ] ] where the summation @xmath184 runs over the microstates visited in the simulation , and @xmath185 is defined as , @xmath186 and @xmath187 denotes the ensemble average of @xmath182 in @xmath9-ensemble .",
    "@xmath185 denotes the occurrence probability of @xmath1 in the simulation run .",
    "an expression similar to eq .   also holds for the ensemble average of @xmath182 in @xmath8-ensemble .",
    "this result illustrates that the short - time average of @xmath182 in @xmath10-ensemble is approximated by the ensemble average in @xmath9-ensemble or @xmath8-ensemble .",
    "when the finite size effect of the system , which has been discussed in sections  [ subsec : examinationof3-reservoirsmethod ] and [ subsec : globalequilibrium ] , is small , @xmath187 is dependent on @xmath11 and independent of @xmath1 .",
    "therefore , eq .   yields @xmath188 .",
    "a similar relation , @xmath189 , also holds , where @xmath190 denotes the ensemble average of @xmath182 in @xmath8-ensemble .",
    "therefore , @xmath191 .",
    "53ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1038/nmat2404 [ * * ,   ( ) ] link:\\doibase { 10.1209/epl / i2005 - 10288 - 6 } [ * * ,   ( ) ] link:\\doibase 10.1126/science.1142614 [ * * ,   ( ) ] link:\\doibase { 10.1038/nsmb.1455 } [ * * ,   ( ) ] link:\\doibase { 10.1039/b901657k } [ * * , ( ) ] _ _ ,  http://webdoc.sub.gwdg.de/diss/2010/norizoe/norizoe.pdf[ph.d .",
    "thesis ] , , ( ) , + http://webdoc.sub.gwdg.de/diss/2010/norizoe/ + \\doibase doi : 10.1016/0370 - 2693(91)91256-u [ * * , ( ) ] @noop _ _  ( ,  ,  ) \\doibase doi : 10.1016/0021 - 9991(77)90121 - 8 [ * * ,   ( ) ] @noop _ _  ( , ,  ) link:\\doibase 10.1063/1.462133 [ * * ,   ( ) ] @noop ( ) ,   link:\\doibase 10.1063/1.1750386 [ * * , ( ) ] \\doibase doi : 10.1016/0031 - 8914(50)90070-x [ * * ,   ( ) ] @noop _ _  ( ,  ,  ) \\doibase doi:10.1080/00268975900100021 [ * * ,   ( ) ] link:\\doibase 10.1021/jp951819f [ * * ,   ( ) ] @noop _ _  ( , ,  ) link:\\doibase 10.1103/physrevlett.45.1196 [ * * ,   ( ) ] link:\\doibase 10.1063/1.328693 [ * * , ( ) ] link:\\doibase 10.1016/0036 - 9748(83)90283 - 1 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1103/physreve.80.061403 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.99.248301 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * , ( ) link:\\doibase    10.1063/1.2965880 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.3006065 [ * * ,   ( ) ] \\doibase http://doi.acm.org/10.1145/272991.272995 [ * * ,   ( ) ] \\doibase http://doi.acm.org/10.1145/146382.146383 [ * * ,   ( ) ] \\doibase http://doi.acm.org/10.1145/189443.189445 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.65.851 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.63.1195 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.448024 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.51.r3795 [ * * ,   ( ) ] link:\\doibase { 10.1039/b818111j } [ * * ,   ( ) ] link:\\doibase 10.1063/1.1734110 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.1741967 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.462658 [ * * ,   ( ) ]  and ,  eds .",
    ", @noop _ _  ( ,  ,  ) @noop _ _  ( ,  ,  ) @noop * * ,   ( ) link:\\doibase 10.1063/1.1667938 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1673047 [ * * ,   ( ) ] @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> in conventional molecular simulation , metastable structures often survive over considerable computational time , resulting in difficulties in simulating equilibrium states . in order to overcome this difficulty , </S>",
    "<S> here we propose a newly devised method , molecular monte carlo simulation of systems connected to three reservoirs : chemical potential , pressure , and temperature . </S>",
    "<S> gibbs - duhem equation thermodynamically limits the number of reservoirs to 2 for single component systems . </S>",
    "<S> however , in conventional simulations utilizing 2 or fewer reservoirs , the system tends to be trapped in metastable states . even if the system is allowed to escape from such metastable states in conventional simulations , the fixed system size and/or the fixed number of particles result in creation of defects in ordered structures </S>",
    "<S> this situation breaks global anisotropy of ordered structures and forces the periodicity of the structure to be commensurate to the system size . </S>",
    "<S> here we connect the such three reservoirs to overcome these difficulties . </S>",
    "<S> a method of adjusting the three reservoirs and obtaining thermodynamically stable states is also designed , based on gibbs - duhem equation . unlike the other conventional simulation techniques utilizing no more than 2 reservoirs , our method allows the system itself to simultaneously tune the system size and the number of particles to periodicity and anisotropy of ordered structures . </S>",
    "<S> our method requires fewer efforts for preliminary simulations prior to production runs , compared with the other advanced simulation techniques such as multicanonical method . a free energy measurement method , suitable for the system with the three reservoirs , is also discussed , based on euler equation of thermodynamics . </S>",
    "<S> this measurement method needs fewer computational efforts than other free energy measurement methods do . </S>"
  ]
}