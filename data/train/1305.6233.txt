{
  "article_text": [
    "plasma oscillations in solids are possibly the simplest manifestation of collective effects in condensed matter , and their understanding in terms of _ plasmon _ modes one of the earliest triumphs of quantum many - body theory .",
    "@xcite on the experimental side , collective charge - density fluctuations can be probed through electron energy - loss ( eel ) or inelastic x - ray scattering ( ixs ) spectroscopies , two techniques that have been steadily producing a wealth of data since the early 60s and 70s , respectively.@xcite in the present day the engineering of novel materials down to the nanometer scale makes it possible to design devices where electromagnetic fields interact with collective oscillations of structures of sub - wavelength size .",
    "the strong dependence of plasmon dynamics on the size and shape of these nanostructures holds the promise of an extraordinary control over the optical response of the resulting devices , with applications to such diverse fields as photovoltaics,@xcite proton beam acceleration,@xcite or biosensing,@xcite to name but a few .",
    "this is plasmonics , _",
    "i.e _ photonics based on collective electronic excitations in strongly heterogeneous systems , where surface effects play a fundamental role .",
    "plasma oscillations at surfaces have recently aroused a renewed attention by themselves , since it was shown that some metal surfaces unexpectedly exhibit _ acoustic _",
    "plasmons.@xcite these are collective charge excitations localized at the surface , whose frequency vanishes linearly with the wavevector , and are not damped by the bulk electron - hole continuum.@xcite it is thought that these modes may offer the possibility of light confinement at designated locations on the surface , with possible applications in photonics and nano - optics.@xcite    most of the theoretical understanding of the optical response in nano - plasmonic systems relies on a classical approach : the nanostructure is usually described as an assembly of components , each characterized by an effective macroscopic dielectric function , and separated from the others by abrupt interfaces . the overall optical response",
    "is then computed by solving maxwell s equation for the resulting heterogeneous system.@xcite when distances between the nanoscale components are themselves nanometric , however , quantum effects must be accounted for , and a fully quantum - mechanical description is called for .    early quantum - mechanical approaches to the dynamics of charge - density fluctuations@xcite were based on the random - phase approximation as applied to the jellium model that , albeit exceedingly successful in simple metals and semiconductors , is not suitable for more complex materials , nor can it capture the fine , system - specific , features of even simple ones .",
    "the effects of crystal inhomogeneities on plasmon resonances in semiconductors ( the so called _ local - field _ effects ) were first addressed in the late 70s,@xcite using the empirical pseudopotential method,@xcite along similar lines as previously followed for the optical spectra.@xcite in the present day the method of choice for describing charge dynamics in real materials ( as opposed to simplified models , such as the jellium one ) is time - dependent ( td ) density - functional theory ( dft).@xcite although some attempts to investigate eel and ixs spectra using many - body perturbation theory have been made,@xcite the vast majority of the studies existing to date relies on tddft , which in fact has been successfully used to study plasmons in a number of bulk@xcite and surface@xcite systems .",
    "the conventional tddft approach to plasmon dynamics relies on the calculation of the charge - density susceptibility , @xmath0 ( or , equivalently , inverse dielectric matrix , @xmath1 ) , starting from the independent - electron susceptibility , @xmath2 , via a dyson - like equation.@xcite although successful in ( relatively ) simple systems that can be described by unit cells of moderate size , this methodology can hardly be applied to more complex systems , such as low - index or nano - structured surfaces , because of its intrinsic numerical limitations .",
    "in particular : _ i _ ) the calculation of @xmath2 requires the knowledge of a large number of empty states , which is usually avoided in modern electronic - structure methods ; _ ii _ ) the solution of the dyson - like equation requires the manipulation ( multiplication and inversion ) of ( very ) large matrices , and _",
    "iii _ ) all the above calculations have to be repeated independently for each value of the frequency to be sampled .    in this paper",
    "we introduce a new method , based on td density - functional perturbation theory ( dfpt),@xcite that allows to calculate eel and ixs cross sections avoiding all the above drawbacks , and thus lending itself to numerical simulations in complex systems , potentially as large as several hundred independent atoms .",
    "although the new methodology is general in principle , our implementation relies on the pseudopotential approximation , which limits its applicability to valence ( or shallow - core ) loss spectra .",
    "inner - core loss spectra are currently addressed using different methods , as explained _ e.g. _ in refs .  .",
    "the salient features of our method are : _ i _ )  the adoption of a representation from time - independent dfpt@xcite allows to avoid the calculation of kohn - sham ( ks ) virtual orbitals and of any large susceptibility matrices ( @xmath0 or @xmath2 ) altogether ; and _ ii _ ) thanks to the use of a lanczos recursion scheme , the bulk of the calculations can be performed only once for all the frequencies simultaneously .",
    "the numerical complexity of the resulting algorithm is comparable , for the _ whole _ spectrum in a wide frequency range , to that of a _ single _ standard ground - state ( or static response ) calculation .",
    "the paper is organized as follows . in sec .",
    "[ sec : theory ] we describe our basic theoretical and algorithmic frameworks , including the implementation of the newly proposed methodology for the response of a periodic system to a monochromatic perturbation , relevant to the calculation of eel and ixs cross sections ; in sec .",
    "[ sec : applications ] we benchmark our technique on the prototypical examples of bulk silicon and aluminum , for which many experimental and well established theoretical results already exist ; finally , our conclusions are presented in sec .",
    "[ sec : conclusions ] .",
    "electron energy - loss spectroscopy probes the diffusion of a beam of fast electrons through a solid . according to van hove,@xcite the corresponding double - differential cross section for inelastic scattering reads:@xcite @xmath3 where @xmath4 and @xmath5 are the electron charge and mass , @xmath6 , @xmath7 , and @xmath8 are the incoming , outgoing , and transferred momenta , respectively , and @xmath9 is the dynamic structure factor per unit volume .",
    "while eel spectroscopy is not suitable for samples enclosed in high - pressure cells , plasmon dynamics under pressure can be probed by ixs spectroscopy.@xcite the double - differential cross - section reads in this case : @xmath10 where @xmath11 and @xmath12 are the incoming and scattered photon polarization directions , and @xmath13 and @xmath14 are the corresponding frequencies . according to the fluctuation - dissipation theorem@xcite @xmath9 is proportional to the imaginary part of the charge - density susceptibility , @xmath15 : @xmath16 in periodic solids the transferred momentum can be split into a component in the first brillouin zone , @xmath17 , and a reciprocal - lattice vector , @xmath18 , as @xmath19 , and @xmath0 is often expressed in terms of the inverse dielectric matrix , defined as:@xcite @xmath20 where @xmath21 .",
    "the function @xmath22 $ ] is usually referred to as the _ loss function_.      in tddft electron dynamics is described by td one - electron equations for the occupied molecular orbitals .",
    "these td ks equations read:@xcite @xmath23 where @xmath24 and @xmath25 are the td ks orbitals and hamiltonian ( quantum mechanical operators are indicated with a caret ) , respectively , the index @xmath26 spans the @xmath27 occupied ( _ valence _ ) states , and atomic units ( @xmath28 are used henceforth .",
    "the ks hamiltonian reads : @xmath29 where @xmath30 and @xmath31 are the external and hartree - plus - exchange - correlation ( hxc ) potentials , respectively .",
    "let us assume that the external potential can be split into a static term , plus a small td perturbation : @xmath32 where @xmath33 is the td strength of the perturbation .",
    "the total ks potential is perturbed accordingly : @xmath34 , @xmath35 being the response hxc potential .",
    "the response of the ks orbitals is defined as @xmath36 @xmath37 and @xmath38 being the unperturbed ground - state ks orbitals and energies , respectively .",
    "the charge - density susceptibility is the response of the electron charge density , which only depends on the projection of the response of the valence ks orbitals onto the empty - state ( conduction ) manifold .",
    "the fourier transforms ( indicated by tilde @xmath39 hereafter ) of such projected response orbitals are obtained from standard first - order perturbation theory via the linear systems : @xmath40 where @xmath41 is the projector over the unperturbed conduction - state manifold .",
    "expressing the latter in terms of valence orbitals ( @xmath42 ) allows one to compute response ks orbitals without making any reference to unoccupied states , much in the same way as it is done in time - independent dfpt.@xcite the solution of eq .",
    "( [ eq : lin - resp_w_eq1 ] ) requires one to express the total response potential , @xmath43 , in terms of its own solutions , through the response charge density , which is the diagonal of the response density matrix , @xmath44 , whose fourier transform is defined as : @xmath45 where the factor two accounts for spin degeneracy in a non - polarized system . note that @xmath46 , as a consequence of the reality of @xmath47 .",
    "the equation for the complex conjugate of @xmath48 reads : @xmath49 where use has been made of the reality of the perturbing potential ( @xmath50 ) .",
    "equations   and describe the _ resonant _ and _ anti - resonant _ contributions to charge - density response , respectively .",
    "their left - hand sides just differ by the sign of the frequency , while , by using time - reversal symmetry of the unperturbed system ( @xmath51 ) their right - hand side can be made look alike .",
    "the equations for the resonant and anti - resonant components of the charge - density response are coupled by the hxc potential , which is determined self - consistently by the density response itself , through the relation : @xmath52 where @xmath53 is the hxc kernel , which we assume to be independent of frequency , consistently with the adiabatic dft approximation.@xcite    the td ks equations  ( [ eq : td - ks_equation ] ) can be equivalently expressed in terms of a quantum liouville equation for the one - particle density matrix , @xmath54:@xcite @xmath55 .",
    "\\label{eq : liouville_eq_1}\\ ] ] upon linearization and fourier transformation , eq .",
    "( [ eq : liouville_eq_1 ] ) takes the form : @xmath56 ,    \\label{eq : liouville_eq_ft_1_general}\\ ] ] where @xmath57 is the unperturbed density matrix and @xmath58 is the liouvillian super - operator , defined by the relation:@xcite @xmath59 +    \\left [ \\hat v'_{\\mathrm{hxc}}[\\hat{\\rho } ' ] , \\hat{\\rho}^\\circ \\right ] .",
    "\\label{eq : liouvillian_def}\\ ] ] the response of an arbitrary one - electron hermitian operator , @xmath60 , to an external perturbation , @xmath61 , is described by the generalized susceptibility : @xmath62 \\bigl ) , \\label{eq : susceptibility_def_2}\\end{aligned}\\ ] ] where @xmath63 indicates a scalar product in an abstract operator manifold.@xcite equation   states that , within tddft , the most general susceptibility can be expressed as an off - diagonal element of the resolvent of the liouvillian .",
    "the calculation of susceptibilities from eq . requires the explicit representation of the response density matrix and of the liouvillian super - operator acting on it .",
    "the minimum dimension of such a representation is @xmath64 , where @xmath65 is the number of virtual ( conduction ) orbitals and @xmath66 the dimension of one - electron basis set.@xcite the inversion of the liouvillian appearing in eq . is a formidable task in typical large - scale plane - wave calculations , where the number of occupied states can be as large as several hundreds to a few thousands , and the number of virtual orbitals a hundred times as large .",
    "the recursion method by haydock , heine , and kelly @xcite offers an elegant solution to a similar problem , namely the calculation of a diagonal element of the resolvent of a hermitian matrix , in terms of a continued fraction , whose coefficients are frequency - independent . the _ lanczos bi - orthogonalization algorithm_,@xcite allows one to generalize this procedure to the calculation of _ off - diagonal _ elements of the resolvent of a _ non - hermitian _ matrix . the resulting numerical workload for calculating the full spectrum in a whole wide frequency range is comparable to that of a _ single _ ground - state ( or static response ) calculation .",
    "other flavours of the lanczos - type algorithm can be found in refs .  .",
    "we want to calculate matrix elements such as : @xmath67 where @xmath68 is a @xmath69 non - hermitian matrix , and @xmath70 and @xmath26 are generic @xmath71-dimensional arrays . to this end",
    "we define two sets of _ lanczos vectors _ , @xmath72 and @xmath73 , through the recursive relations:@xcite @xmath74 where one defines @xmath75 , @xmath76 , and the @xmath77 , @xmath78 , and @xmath79 _ lanczos coefficients _",
    "are determined by the _ bi - orthogonality _ conditions @xmath80 , and @xmath81 .",
    "the set of vectors and coefficients generated through the recursion relations ( [ eq : lanczos_chain_1]-[eq : lanczos_chain_2 ] ) is often referred to as a _ lanczos chain_. the details of this algorithm are reviewed _",
    "e.g. _ in ref .",
    "[ ] , and its specialization to tddft is presented in refs .",
    "[ ] . for the purposes of the present paper ,",
    "we limit ourselves to observe that the lanczos vectors thus generated have the property that they provide a tridiagonal representation of the @xmath68 matrix . more specifically ,",
    "if we define the @xmath82 matrices @xmath83 and @xmath84 ( @xmath85 being the number of lanczos iterations ) , one has : @xmath86 where @xmath87 is the tridiagonal matrix @xmath88 in this lanczos representation , the matrix element of eq .",
    "can be expressed as:@xcite @xmath89 where @xmath90 and @xmath91 is the @xmath85-dimensional vector defined as:@xcite @xmath92 the right - hand side of eq .",
    "( [ eq : resolvent_g ] ) can be conveniently computed by solving , for any given value of @xmath93 , the equation : @xmath94 and calculating the scalar product : @xmath95 the vector @xmath91 , eq .",
    "( [ eq : zeta_coef_for_g ] ) , can be computed on the fly during the lanczos recursion , through the relation @xmath96 . in practice ,",
    "the procedure outlined above is performed in two steps . in the first step , which is by far the most time consuming , one generates the tridiagonal matrix @xmath87 , eq .",
    "( [ eq : tridiagonal_matrix ] ) , and the vector @xmath97 , eq .",
    "( [ eq : zeta_coef_for_g ] ) . in the second step @xmath98",
    "is calculated from eq .",
    "( [ eq : resolvent_liouvillian_lanczos_2_for_g ] ) upon the solution of eq .",
    "( [ eq : eta_post_processing_for_g ] ) , for different frequencies @xmath93 . in practice",
    ", a small imaginary part @xmath99 is added to the frequency argument , @xmath100 , so as to regularize the function @xmath98.@xcite setting @xmath99 to a non - zero value amounts to broadening each individual spectral line or , alternatively , to convoluting the function @xmath98 with a lorentzian . because of the tridiagonal form and the small dimension of the matrix @xmath87 ( a few hundreds to a few thousands ) , the second step is essentially gratis .",
    "different responses to a same perturbation can be computed simultaneously from a same lanczos recursion , by computing different @xmath101 vectors on the fly .",
    "equation   shows that the response density matrix is uniquely determined by the two sets of functions @xmath102 and @xmath103 .",
    "it is convenient to consider a linear combination of these functions , defined as : @xmath104 the two sets @xmath105 and @xmath106 are called respectively the _ upper _ and _ lower _ component of the _ standard batch representation _ ( sbr)@xcite of the response density matrix _ super - vector _ : @xmath107.@xcite the sbr of a hermitian operator , @xmath108 , has vanishing lower component , @xmath109 , while that of its commutator with the unperturbed density matrix [ see eq .",
    "( [ eq : liouville_eq_ft_1_general ] ) ] has vanishing upper component , @xmath110 \\sbr \\bigl\\ { 0 , \\ { \\hat{p}_c \\ , \\hat a \\ , \\varphi_v^\\circ(\\mathbf{r } ) \\ } \\bigr\\}$ ] .",
    "the sbr of the liouvillian super - operator has the block form:@xcite @xmath111 where the @xmath112 and @xmath113 super - operators are defined by their action on response batches , @xmath114 @xmath115 is the hxc kernel of eq .",
    "( [ eq : hxc_kernel ] ) , and @xmath116 is the hxc potential ( see eq .  ) generated by the response charge density distribution whose sbr is ( see eq .  ):",
    "@xmath117 according to the above equations , operating with the liouvillian on a test super - vector essentially requires the calculation of the hxc potential response , its application to each valence ks orbital , as well as the operation of the unperturbed hamiltonian onto twice the number of valence ks states .    the starting super - vector of the lanczos recursion is the right - hand side of eq .",
    "whose sbr is : @xmath118 because of the special block structure of the liouvillian , eq .",
    "( [ eq : liouvillian_sbr ] ) , the sbr of odd lanczos iterates have vanishing upper components , whereas the even ones have vanishing lower components . as a consequence",
    ", the number of response wavefunctions onto which the unperturbed hamiltonian must operate per lanczos iteration is halved .",
    "also , the diagonal elements of the resulting tridiagonal matrix ( the @xmath119 coefficients ) are all vanishing .",
    "it was previously noted that the components of the vector @xmath97 , eq .",
    "( [ eq : zeta_coef_for_g ] ) , decrease rather rapidly to zero , whereas the @xmath78 ( and @xmath79 ) coefficients oscillate around two distinct values for odd and even iterations , whose average is approximatively equal to one half of the kinetic - energy cutoff ( in a plane - wave implementation ) , and whose difference is approximately twice as large as the excitation gap in insulating or semiconducting materials.@xcite this finding can be used to speed up considerably the calculation by adopting a suitable extrapolation technique . in practice , the lanczos recursion is stoped after @xmath120 iterations , such that the components of the @xmath101 array are small enough .",
    "the dimension @xmath85 of the linear system , eq .",
    ", is then set to a very large ( and to a large extent arbitrary ) value .",
    "the @xmath101 components from @xmath121 to @xmath85 are set to zero , whereas the corresponding @xmath122 and @xmath123 coefficients are set to the average of the values that have been actually computed .",
    "the accuracy of the calculated spectrum is then checked _ a posteriori _ with respect to the value of @xmath120 .",
    "in many applications it turns out that @xmath120 may vary from a few hundreds up to a few thousands ( depending on the plane - wave kinetic energy cutoff ) , and @xmath85 is a ( to a large extent arbitrary ) number reaching up to several thousands . as the solution of tridiagonal systems",
    "can be performed very efficiently via standard factorization techniques , the numerical overhead of this procedure is negligible .",
    "more on lanczos extrapolation can be found in refs .  .      in a periodic solid the unperturbed ks orbitals are @xmath124 , where @xmath125",
    ", @xmath126 is a band index and @xmath127 a point in the brillouin zone .",
    "these ks orbitals can be cast into the bloch form : @xmath128 where @xmath129 is the lattice - periodic function .",
    "similarly , the total perturbing potential can be conveniently decomposed into _ bloch components _ : @xmath130 where @xmath131 is also lattice - periodic , and the sum extends over the first brillouin zone .",
    "a similar decomposition can be applied to the external and hxc response potentials .",
    "the response of each ks orbital can be correspondingly expressed as a linear combination of the responses to each bloch component of the perturbing potential : @xmath132 where @xmath133 is a lattice - periodic response orbital that satisfies the equation : @xmath134 in eq .",
    ", as well as in the rest of this paper , quantum - mechanical operators bearing a wave - vector subscript ( such as @xmath135 ) or superscript ( such as @xmath136 ) are thought to operate on lattice - periodic functions , and are defined in terms of their coordinate representations as : @xmath137 the projector onto the conduction manifold in eq .   can be expressed in terms of the periodic parts of the unperturbed bloch functions as : @xmath138 where the sum extends over all the occupied bands .",
    "a similar decomposition into bloch components holds for the response density matrix , which reads in this case : @xmath139 where @xmath140 the anti - resonant contribution to the density - matrix response in eq .   satisfies the equation : @xmath141 which can be obtained from eq .   by complex conjugation and simple manipulations deriving from time - reversal invariance of the unperturbed system ( @xmath142 ) and the reality of the perturbing potential ( @xmath143 ) .      in analogy with eq .",
    ", eq .   shows that the response density matrix of a periodic solid to a perturbation of wave - vector @xmath144 is uniquely determined by the two sets of response orbitals @xmath145 and @xmath146 . note that @xmath126 and @xmath127 are running indices , whereas @xmath144 is fixed .",
    "the sbr can in this case be defined as : @xmath147 the two sets of response orbitals , @xmath148 and @xmath149 satisfy the coupled set of equations : @xmath150 where @xmath151 , and @xmath152 and @xmath153 are the super - operators defined by the relations : @xmath154 and @xmath155 is the hxc potential generated by the response charge density : @xmath156 equations  , , and are closely parallel to eqs .",
    ", , and of sec .",
    "[ sec : batch_repr_general ] .    in practice ,",
    "the sum over @xmath127 points is limited to the portion of the brillouin zone that is irreducible with respect to the small group of @xmath144 and the resulting function symmetrized accordingly , in close analogy with time - independent dfpt for lattice - dynamical calculations.@xcite more about the exploitation of crystal symmetry in the calculation of dynamical charge - density susceptibilities can be found in ref . .",
    "the @xmath157 component of the charge - density susceptibility is obtained from eq .   as the response of the @xmath158 fourier component of the charge - density operator , whose coordinate representation reads @xmath159 , to a monochromatic perturbation , @xmath160 .",
    "the sbr of the periodic part of @xmath161 is @xmath162 .",
    "the final expression for the susceptibility is : @xmath163 where @xmath164 is the solution of eq .",
    ", obtained when the periodic part of the external perturbing potential is @xmath165 .    in practice the susceptibility in eq .",
    "is computed following the procedure outlined in sec .",
    "[ sec : lanczos_method ] ( see eq .  ):",
    "@xmath166 where @xmath167 is a tridiagonal matrix of dimension @xmath85 of the form ( [ eq : tridiagonal_matrix ] ) , and @xmath168 is an @xmath85-dimensional array whose coefficients @xmath169 are defined as : @xmath170      the liouville - lanczos approach for eel and ixs spectroscopies can be extended to metals by a suitable generalization of the smearing technique introduced by de gironcoli in the static case for lattice - dynamical calculations.@xcite in the smearing approach , each ks energy level is broadened by a smearing function @xmath171 , which is an approximation to the dirac @xmath172-function in the limit of vanishing smearing width @xmath173 .",
    "the monochromatic @xmath144 component of the charge - density response eq .",
    "( [ eq : sbr_charge - density_2 ] ) can then be cast into the form : @xmath174 where the functions @xmath175 and @xmath176 satisfy the equations : @xmath177 ( cf . with eqs .   and ) , where @xmath178 @xmath179 $ ] and @xmath180 $ ] being smooth approximations to the step - function , and @xmath181 is the fermi energy .",
    "it can be easily verified that the coefficients @xmath182 vanish when any of its indices refers to an unoccupied state .",
    "therefore , the operator @xmath183 involves only a small number of partially occupied bands , and the first - order variation of the wavefunctions and of the charge density can be computed avoiding any explicit reference to unoccupied states , much in the same way as for insulating materials .",
    "more details about the liouville - lanczos approach for metals can be found in ref .  .",
    "the technique described above has been implemented in the quantum espresso suite of computer codes,@xcite and is scheduled to be distributed in one of its future releases .",
    "we now proceed to validate it by calculating the loss function in bulk silicon and aluminum , for which several tddft studies exist , and whose spectra are known to be accurately described within the adiabatic local density ( lda ) and generalized gradient ( gga ) approximations ( see , _",
    "e.g. _ , refs .   for si , and for al ) .",
    "all the calculations have been performed within the lda approximation , using the perdew - zunger parameterization of the electron - gas data,@xcite norm - conserving pseudopotentials from the quantum espresso database@xcite and plane - wave basis sets up to a kinetic - energy cutoff of 16 ry .",
    "the first brillouin zone has been sampled with a monkhorst - pack ( mp ) @xmath127 point mesh , supplemented , in the case of al , by the methfessel - paxton smearing technique@xcite with a broadening parameter @xmath184  ry .",
    "the frequency argument of the susceptibility has been assumed to have a small imaginary part , @xmath99 , thus resulting in a lorentzian smearing of the spectra ( see sec .  [",
    "sec : lanczos_method ] ) . for",
    "both si and al we have used the experimental lattice parameters ( 10.26 a.u.@xcite and 7.60 a.u.,@xcite respectively ) , which is very close to the theoretical one and resulting in no appreciable difference in the computed spectra .",
    "figure  [ fig : si_conv_iter ] shows the convergence of the loss spectrum of si , as calculated for a transferred momentum @xmath185  a.u . along the [ 100 ] direction , as a function of the number of lanczos iterations .",
    "after 400 iterations the spectrum displays spurious wiggles , which disappear by increasing the number of iterations up to 1500 .",
    "also displayed are results obtained by the extrapolation procedure outlined at the end of sec .",
    "[ sec : batch_repr_general ] , performed with @xmath186 lanczos iterations and extrapolating the results up to a linear system of dimension @xmath187 .",
    "we see that the numerical workload can be considerably reduced without any appreciable loss of accuracy . in fig .",
    "[ fig : si_conv_k ] we show the convergence of the loss function with respect to the @xmath127 point sampling of the brillouin zone .",
    "the @xmath188 mp @xmath127 point mesh is not dense enough to obtain a well - converged spectrum , due to the presence of spurious wiggles , which disappear by increasing the size of the mp mesh up to @xmath189 .    in fig .",
    "[ fig : si_theor_vs_exp ] we compare our present results with those obtained from the conventional approach based on the dyson - like equation for the susceptibility@xcite and with experiment.@xcite the agreement is excellent in both cases .",
    "all the salient features observed in the experiments at small transferred momentum ( panel ( a ) ) are correctly predicted : the main plasmon peak around 20 ev , a shoulder around 15 ev , and a weak peak around 6.5 ev .",
    "we attribute the slight differences between the two theoretical spectra to the slightly different technical details used in the two works . in particular , the authors of ref .   mimicked electron- and hole - lifetime effects with an energy - dependent broadening , in contrast to the constant lorentzian broadening , @xmath190  ry , used in our calculations . at larger momentum transfer ( panel ( b ) )",
    "the interaction of the plasmon with the electron - hole continuum broadens the spectrum.@xcite the agreement with experiment,@xcite remarkable also in this case , is enhanced by increasing the lorentzian broadening up to @xmath191  ry , which allowed us to reduce the size of the mp mesh down to @xmath192 without any appreciable loss of accuracy .",
    "figure  [ fig : al_conv_iter ] shows the convergence of the loss function of al , calculated at a transferred momentum @xmath193  a.u . along the [ 100 ] direction , as a function of the number of lanczos iterations .",
    "although the qualitative behavior is similar to that observed in si ( wiggles showing up for a small number of iterations disappear by increasing this number ) , the convergence appears to be faster in the present case . as for the large - iterate behavior of the lanczos coefficient",
    ", we observe that , in contrast to si , in al the odd and even coefficients oscillate around a same value , which is also in this case of the order of one half the plane - wave kinetic - energy cutoff .",
    "this is due to the vanishing of the gap , as discussed in ref . .",
    "figure  [ fig : al_conv_k ] shows the convergence with respect to the size of the @xmath127 point mesh : very satisfactory convergence is achieved with @xmath189 mp mesh and a broadening parameter @xmath194  ry .    in fig .",
    "[ fig : al_theor_vs_exp ] we compare the loss function of al as calculated by the present method for two different values of the transferred momentum along the [ 100 ] direction , with ixs experiments and with previous theoretical work . at",
    "small transferred momentum ( panel ( a ) ) theoretical predictions agree remarkably well with each other ( the slight discrepancies being attributable to the usual small differences between the technical details of the calculations ) and with experiment . both theoretical spectra display a small blueshift ( @xmath195 ev ) of the plasmon peak with respect to experiments . at larger transferred momentum ( panel ( b ) ) the theoretical spectra display a feature at @xmath196 ev , which is not observed experimentally .",
    "we attribute the remaining discrepancies to the lifetime effects,@xcite which have been treated in our calculations by a constant lorentzian broadening parameter ( @xmath197  ry , requiring a @xmath198 mp mesh ) .",
    "we believe that the liouville - lanczos approach introduced in this paper will open new perspectives in the calculation of loss spectra in extended systems .",
    "its main features are the adoption of a representation for the charge - density response borrowed from density - functional perturbation theory , and of a lanczos recursion scheme for computing selected elements of the inverse of ( very ) large matrices . the combination of these two elements permits to compute the loss spectrum of a given system , for a given transferred momentum , and for an _ entire wide frequency range _ , with a numerical workload of the same order as needed for a standard ground - state calculation for a same system ( the pre - factor being only a few times larger ) . in principle , the convergence of the computed loss spectra with respect to the length of the lanczos chains depends on the spectral range : the lower the frequency , the faster the convergence , as it was already observed for optical spectra in finite systems.@xcite in practice , however , adoption of the extrapolation techniques explained in sec .",
    "[ sec : extrapolation ] substantially alleviates this dependence .",
    "also , the spectral range accessible to eel / ixs spectroscopies is limited by the so - called @xmath199-sum rule:@xcite @xmath200 \\omega \\ ,     d\\omega = - \\frac{\\pi}{2 } \\ , \\omega_p^2 ,    \\label{eq : f_sum_rule}\\ ] ] where @xmath201 is the plasma frequency , @xmath202 being the average electron density , _ i.e. _ the number of electrons ( _ valence _ electrons , in a pseudopotential calculation ) per unit volume.@xcite of course , the spectral range that needs to be sampled by lanczos recursion is correspondingly limited .",
    "the liouville - lanczos approach introduced in this paper also lends itself to an easy generalization to those methods ( such as hybrid functionals or the static bethe - salpeter equation ",
    "bse ) that require the full density - matrix ( rather than just charge - density ) response , which is in fact as easily accessible to the batch representation utilized here.@xcite further generalization to frequency - dependent xc kernels ( or to the bse with dynamical screening ) may simply require computing the loss function at shifted frequencies ( @xmath203 ) , as proposed _",
    "e.g. _ in ref . , or further methodological developments .",
    "further work is required to clarify this issue .",
    "all in all we believe that the advances presented in this paper will allow for the simulation of complex , possibly nano - structured , surfaces , as well as of systems where valence and shallow - core loss spectra overlap .",
    "examples of the former include low miller index surfaces or plasmonic materials , while bulk bismuth is an example of the latter .",
    "work is in progress on both lines .",
    "we thank s.  de  gironcoli , a.  dal  corso , and l.  reining for valuable discussions .",
    "support from the anr ( project pnano accattone ) and from dga are gratefully acknowledged .",
    "computer time was granted by genci ( project no .",
    "2210 ) . the work of i.t . and n.v",
    "has been performed under the auspices of the _ laboratoire dexcellence en nanosciences et nanotechnologies labex nanosaclay_. n.v .",
    "thanks marco saitta for discussions about tddfpt at an early stage of the project .",
    "s.b . gratefully acknowledges hospitality at the _ laboratoire des solides irradis _ of the cole polytechnique , where this paper was written ."
  ],
  "abstract_text": [
    "<S> the liouville - lanczos approach to linear - response time - dependent density - functional theory is generalized so as to encompass electron energy - loss and inelastic x - ray scattering spectroscopies in periodic solids . </S>",
    "<S> the computation of virtual orbitals and the manipulation of large matrices are avoided by adopting a representation of response orbitals borrowed from ( time - independent ) density - functional perturbation theory and a suitable lanczos recursion scheme . </S>",
    "<S> the latter allows the bulk of the numerical work to be performed at any given transferred momentum only once , for a whole extended frequency range . </S>",
    "<S> the numerical complexity of the method is thus greatly reduced , making the computation of the loss function over a wide frequency range at any given transferred momentum only slightly more expensive than a single standard ground - state calculation , and opening the way to computations for systems of unprecedented size and complexity . </S>",
    "<S> our method is validated on the paradigmatic examples of bulk silicon and aluminum , for which both experimental and theoretical results already exist in the literature . </S>"
  ]
}