{
  "article_text": [
    "we solve for capacitance using a green function approach , which is based on the linearity of electromagnetism . in general",
    ", the charge @xmath7 for a small area @xmath8 is computed from a voltage source @xmath9 with area @xmath10 using @xmath11 where @xmath12 is a function of the charge and voltage coordinates , as well as the positions @xmath13 of all other ( infinitesimal ) elements of the conductors .",
    "the solution for @xmath14 is typically quite complex , as it can in general only be found using numerical techniques of matrix inversion , starting from a potential matrix having elements like @xmath15 .",
    "however , for the simple geometry considered here of a ground plane sheet with infinitesimally thin cuts , this function turns out to be easy to calculate since the effects of the thin cuts can be neglected .",
    "we thus need to find the green s function solution for the charge distribution in an infinite ground plane coming from a infinitesimal electrode with a voltage @xmath9 .",
    "we first consider a simpler situation with a point source of charge @xmath16 at distance @xmath17 above the plane .",
    "the problem can be solved using an image charge , which gives for radius @xmath18 and distance @xmath19 above the plane the potential @xmath20 \\\\ & = \\frac{m}{4\\pi\\epsilon } \\frac{z}{(r^2+z^2)^{3/2 } }   \\ , \\end{aligned}\\ ] ] where in the last equation we have made set @xmath21 but kept the total moment constant @xmath22 .",
    "the surface charge density in the ground plane is given by @xmath23    we are interested in the charge distribution not from a charge dipole , but from an infinitesimal electrode of area @xmath10 at voltage @xmath9 . the fields from this electrode can be equivalently described as arising from a spatial distribution of charge moments , which produce voltages equivalent to that coming from the electrode . although this distribution of moments could be found in principle , we need only solve a simpler problem of calculating the total moment , since we are only interested in the resulting surface charge density at large radius .    to proceed , we need to relate this total moment to the electrode voltage .",
    "we first consider the simpler problem of a single dipole , where we sum the voltage coming from a dipole over the plane a distance @xmath19 above the ground @xmath24 where in the last equation we note the integral does not depend on the height @xmath19 . from linearity",
    ", we can relate the total moment @xmath25 to the integral of the voltage an infinitesimal distance above the ground plane , which gives @xmath26 since the ground plane at zero voltage gives no contribution to the integral .",
    "combining eqs.([eq : sigma ] ) and ( [ eq : m - v ] ) gives the charge distribution from the electrode at large radius @xmath27    the capacitance can now simply be calculated by summing the charge over all infinitesimal elements of the capacitors .",
    "the general formula for capacitance between electrodes 1 and 2 is @xmath28 where @xmath29 and @xmath30 are the coordinates of differential areas @xmath31 and @xmath32 .",
    "here we have included capacitance from both above and below the ground plane , which increases the result by a factor of two .",
    "for the case of a substrate and air with different dielectric constants @xmath33 and @xmath34 , the capacitance is still given by the sum over the substrate and air capacitances , which is accounted for using the replacement @xmath35 .",
    "this theory may be tested against analytic results for the geometry of a coplanar waveguide with centered width @xmath36 and separation @xmath5 , as illustrated in fig.[fig : capl ] . for this case",
    "the capacitance per unit length of the line is given by analytic results @xcite",
    "@xmath37 \\label{eq : cl } \\\\ & \\simeq ( 4\\epsilon/\\pi ) \\ln(4w / s ) \\ , \\label{eq : cla}\\end{aligned}\\ ]",
    "] where @xmath38 and @xmath39 is the complete elliptic integral of the first kind .",
    "the second equation is an excellent approximation for typical geometries , having errors greater than @xmath40 only for @xmath41 , whereas the last is valid for @xmath42 .",
    "this predicts a weak ( logarithmic ) dependence of capacitance on parameters of the line .",
    "plot of centerline capacitance versus @xmath43 for a coplanar waveguide of separation @xmath5 , centered width @xmath36 , and grounds extending to infinity .",
    "the analytical result eq.([eq : cl ] ) is the black curve , whereas the blue line is the area integration formula eq.([eq : clint ] ) .",
    "scaling of @xmath5 to @xmath44 , illustrated in upper inset ( red ) , shifts the integral prediction upward by @xmath45 ; when doing so , we find the analytical results are well matched even for small to moderate @xmath5 .",
    "arrow indicates @xmath46 .",
    "the lower inset defines the coordinates @xmath47 and @xmath48 used in eqs.([eq : cp2a ] ) and ( [ eq : cp2b ] ) . ]",
    "the capacitance from the area integral of eq.([eq : area ] ) may be calculated directly for two coplanar electrodes @xmath49 ( @xmath50 ) , as illustrated in the lower inset of fig.[fig : capl ] .",
    "for left and right edge coordinates @xmath51 and @xmath52 ( @xmath53 and @xmath48 ) , the capacitance is @xmath54 \\label{eq : cp2a } \\\\ & = ( 2\\epsilon/\\pi ) \\ln \\big[\\,\\frac{a_l - b_l}{a_r - b_l}\\ , \\big ] \\ \\ \\ \\ ( \\textrm{for } b_r \\rightarrow \\infty ) \\ .",
    "\\label{eq : cp2b}\\end{aligned}\\ ] ]    this expression can be readily be extended to the case of three electrodes . for the coplanar line",
    "the self capacitance is @xmath55    as shown in fig.[fig : capl ] , the slope of this prediction matches the analytic formula eq.([eq : cla ] ) , so the curves asymptotically match as @xmath56 .",
    "this justifies the idea that eq.([eq : area ] ) is exact for separation @xmath56 .",
    "however , there is significant error for practical values of @xmath5 comparable in magnitude to @xmath36 .",
    "figure[fig : capl ] also shows the analytic formula can be matched for @xmath57 by keeping @xmath36 constant but scaling @xmath6 : of course , this identification can be obtained by simply comparing eqs.([eq : cla ] ) and ( [ eq : clint ] ) .",
    "we conclude here that when computing self capacitance , eq.([eq : area ] ) is only accurate for exponentially small separations , but a simple rescaling to @xmath44 corrects the formula quite well for edge effects .",
    "plot of ground capacitance @xmath58 ( red to black electrodes ) and coupling capacitance @xmath59 ( red to blue ) versus @xmath43 .",
    "exact numerical results are points , whereas lines are results eqs.([eq:2cpg ] ) and ( [ eq:2cpc ] ) from area integration theory with scaling @xmath60 .",
    "arrow indicates @xmath46 .",
    "the small shift between points and line are believed to arise from numerical errors . ]",
    "although we can accurately calculate self capacitance for small separations , calculation of coupling capacitance should be even more reliable since the area elements are typically spaced by larger distance , so edge effects will be small . to test this case ,",
    "we next compare coplanar geometries with a second electrode . for fig.[fig",
    ": cps ] where the two coplanar centerlines are separated by @xmath5 , the ground and coupling capacitance is computed to be @xmath61 where we have explicitly included the scaling @xmath6 .    for fig.[fig : cpd ] where there is an additional intermediate ground electrode of length @xmath17 , the capacitances are @xmath62 \\label{eq : dcpc } \\\\ & \\simeq \\frac{2\\epsilon}{\\pi }   \\big ( \\frac{w}{d } \\big ) ^2 \\ \\ \\ \\ \\ ( \\textrm{for } s/4 \\ll w \\ll d ) \\ . \\label{eq:2dpca}\\end{aligned}\\ ] ] comparison of these formulas with an exact numerical solution shows excellent agreement .",
    "plot of capacitance versus @xmath63 , as for fig.[fig : cps ] but with additional ground electrode of centered width @xmath17 .",
    "theoretical predictions are from eqs.([eq : dcpg ] ) and ( [ eq : dcpc ] ) , where black and blue ( green and red ) lines are for @xmath64 .",
    "the dashed line is the asymptotic prediction from eq.([eq:2dpca ] ) . ]",
    "we next show results for a feedline coupled to a rectangular electrode , as illustrated in fig.[fig : numer1 ] .",
    "we consider a semi - infinite feedline of width @xmath65 coupled to a rectangular box of width @xmath66 and length @xmath67 , separation @xmath5 , and where the end of the feedline is separated from the center of the rectangle by distance @xmath68 . here , we plot as points the results of numerical calculations from sonnet , for cases of parallel and perpendicular orientations .",
    "we also show the predictions from the area integral formula eq.([eq : area ] ) , which gives @xmath69 \\ , \\label{eq : rect}\\\\ x_\\pm & = x \\pm l/2 \\ , \\\\ y & = w/2 \\ .\\end{aligned}\\ ] ] as shown in fig.[fig : numer1 ] , we see excellent agreement between this formula and the numerical data . for the case",
    "@xmath70 the geometry is for two colinear lines , and we use a line integral version of eq.([eq : area ] ) to find @xmath71 for the perpendicular case , we find .",
    "@xmath72   \\ \\ \\ \\ ( \\textrm{for } \\omega \\ll x ) \\label{eq : perp } \\ .\\end{aligned}\\ ] ]    note that eq.([eq : rectsm ] ) is written as the product of areas divided by a distance cubed to match the form of the area integral formula . here",
    ", it is seen that the effective length of the feedline is half the spacing @xmath68 .",
    "we will express the following formulas in this manner to emphasize this basic form .",
    "plot of coupling capacitance versus feedline distance @xmath68 for a rectangle with parallel or perpendicular orientations , and a cross .",
    "symbols are from sonnet numerical simulations , whereas lines are obtained from the numerical integration formulas eqs.([eq : rect ] ) or ( [ eq : par ] ) . the rectangle has dimensions of length @xmath73 and width @xmath66 , and has a separation @xmath74 from electrode to ground .",
    "the feedline has width @xmath75 , and has its end a distance @xmath68 from the rectangle center .",
    "rectangle capacitance is @xmath76 . ]    for a rectangle separated from a small area @xmath77 with center to center distance @xmath68 , the coupling capacitance is @xmath78 \\\\ & = \\frac{\\epsilon}{\\pi}\\frac{a(wl)}{x^3 } \\big [ 1-\\frac{1}{8}\\big(\\frac{w}{x}\\big)^2+\\frac{1}{2}\\big(\\frac{l}{x}\\big)^2 + ... \\ \\big]\\end{aligned}\\ ] ] as the correction terms are second order in @xmath36 and @xmath79 , there is less than 10% change in the simple area formula even for relatively large size @xmath80 and @xmath81 .",
    "for the condition @xmath82 , eq.([eq : par ] ) can be used to calculate the coupling capacitance between two colinear semi - infinite lines separated by a gap @xmath83 , giving @xmath84 for the case of perpendicular geometry with coupling between a semi - infinite and infinite line separated by gap @xmath83 , we find @xmath85 for the case of an infinite line coupled to a rectangle of width @xmath36 and length @xmath79 , parallel to the infinite line but offset by a gap @xmath83 , the coupling capacitance is @xmath86",
    "isolation of capacitance is an important issue , so an obvious question is whether the electrode geometry of a square or rectangle gives better isolation from one qubit to another . since the coupling capacitance scales as the area of each electrode @xmath77 , but the self capacitance scales as their perimeter @xmath87 , the ratio of the coupling to self capacitance is @xmath88 . assuming equal self capacitance",
    ", this result implies that the lowest stray coupling will come from a rectangle of small aspect ratio @xmath89 .",
    "smaller coupling arises because the ground plane around the narrow dimension of the rectangle better screens the electric fields .",
    "the integral solution developed in this paper can be also applied to other important cases , such as for a metal plane on top of a substrate of finite thickness @xmath90 and dielectric constant @xmath33 .",
    "since the symmetry in the x and y directions is preserved , we expect a green s function with only a radial dependence @xmath91 , which has @xmath92 for @xmath93 , but then changes for @xmath94 due to screening effects .",
    "we consider the geometry shown in the inset of fig.[fig : sb ] , where a dielectric with @xmath34 is below the substrate . for the case of an air dielectric",
    ", we expect @xmath95 , whereas the case of the substrate on a metal ground plane can be solved using @xmath96 .",
    "the radial scaling of the green function can be solved by considering a charge source @xmath16 just below the origin .",
    "the metal plane gives an image charge of @xmath97 just above the origin , whereas the @xmath33-@xmath34 boundary produces an image charge at the z - coordinate @xmath98 with charge @xmath99 and @xmath100 .",
    "the effect of the two boundaries is to produce a series of image dipoles in the z direction each spaced by @xmath101 , with moments that are repeatedly reduced by the factor @xmath102 away from the origin .",
    "since the charge on the metal plane is proportional to the electric field in the z - direction from these dipoles , the screening factor is given by a sum @xmath103 over the images @xmath104^{3/2 } } \\big [ 1-\\frac{3}{1+(r/2tn)^2 } \\big]\\end{aligned}\\ ] ]     plot of screening factor @xmath14 versus normalized radius @xmath105 for a metal plane on top of a substrate of thickness @xmath90 and dielectric constant @xmath33 .",
    "underneath the substrate is another dielectric with @xmath34 .",
    "we consider the substrate - air case with @xmath106 ( black ) , as well as for a metal ground plane underneath the substrate @xmath96 ( blue ) . ]",
    "this screening factor @xmath107 is plotted in fig.[fig : sb ] for the case of a substrate - air interface with @xmath108 ( @xmath109 ) , and for a metal ground plane below the substrate @xmath110 ( @xmath111 ) . for the air case",
    ", the screening factor reduces to 1/10 for @xmath94 , as expected since the effective dielectric constant should be that of air . for the metal case",
    ", the screening factor drops rapidly to zero , as expected for charge screening .",
    "the summation generally converges taking a maximum @xmath103 of about @xmath112 .",
    "however , the sum is slowly convergent for the case @xmath111 and @xmath113 , so one should then use the fit function @xmath114 $ ] . for practical implementation , it is suggested to compute @xmath107 once and then use an interpolation function for the area integration .    the total charge on the metal plane comes from electric fields above and below the substrate .",
    "this can be directly summed , which changes the integral of eq.([eq : area ] ) by the following replacement @xmath115    an interesting calculation considers the coupling capacitance to the substrate ground plane , which we take as the charge @xmath116/r^3 $ ] that is no longer accumulating at the top plane . for a source disk of radius @xmath117 and area @xmath77",
    ", we find @xmath118 \\,dr\\\\ & = \\frac{\\epsilon_s   a}{t } \\label{eq : cgz}\\end{aligned}\\ ] ] where we have ignored the rise in charge density at @xmath119 since @xmath120 for @xmath93 .",
    "it is possible to simply estimate this result by computing an integral with a step - function cutoff to the coupling for @xmath121 , which also gives the same result .",
    "this equation shows a relatively slow dependence @xmath122 on the thickness , so capacitance to this ground can not obviously be ignored .",
    "equation([eq : cgz ] ) was derived for a disk of small area @xmath77 , so it represents the green function for this ground - plane geometry . for an electrode of any area and shape ,",
    "the ground capacitance @xmath123 can be obtained by integrating over all the area , also giving the result of eq.([eq : cgz ] ) where now @xmath77 is the area of an arbitrary electrode . as expected , the ground capacitance is the parallel plate result @xmath124 for large area , where the extent of the electrode is much larger than @xmath90 .",
    "perhaps surprisingly , the parallel plate formula is also good for the case of small area .    this parallel plate result can be used to estimate capacitance from more complicated geometries .",
    "for example , if the dielectric stackup was substrate , air and then a ground plane , the formula for the ground capacitance would simply be the parallel plate formula corresponding to the substrate and air ."
  ],
  "abstract_text": [
    "<S> we show how capacitance can be calculated simply and efficiently for electrodes cut in a 2-dimensional ground plane . </S>",
    "<S> these results are in good agreement with exact formulas and numerical simulations .    </S>",
    "<S> the calculation of capacitance for complex electrode shapes is generally performed with numerical programs such as sonnet or hfss . </S>",
    "<S> long run times are typical because of the need to segment the electrodes into many elements , especially if ground planes are included . </S>",
    "<S> although capacitance is computed , there is usually little intuition gained as to how changing geometry will affect the result , except by running many iterations with different design parameters .    here </S>",
    "<S> we show that for the geometry of a 2-dimensional ground plane with thin cuts that define the electrodes , the capacitance can be calculated with a simple formula . </S>",
    "<S> for example , the coupling capacitance between two electrodes of arbitrary shape is given by @xmath0 where @xmath1 is the average dielectric constant of the material above and below the ground plane , @xmath2 and @xmath3 are the areas of the electrodes 1 and 2 , and @xmath4 is the distance between their centroids , assumed to be much greater than the extend of the electrodes . </S>",
    "<S> although this relation for the capacitance is formally exact only as the separation @xmath5 of the cuts go to zero , we show here that the scaling @xmath6 allows accurate calculation of self capacitance using simple area integrals .    </S>",
    "<S> this work was motivated by the design of superconducting qubits , where it is necessary to set capacitance coupling elements between qubits , resonators , and control circuitry . </S>",
    "<S> we believe this theory will also help with other design problems with integrated circuits , since computing capacitance in circuits with a ground plane is a common need .    in planar circuits </S>",
    "<S> , it is tempting to think that capacitance primarily arises at the electrode cuts . in this note </S>",
    "<S> , it will be clear that this notion is incorrect , as a significant amount of capacitance comes from charge coupling to metal electrodes quite far from the cut . </S>",
    "<S> the fundamental issue with planar circuits is that although there is a ground plane to shield the electric fields , the ground plane does not enclose all the electric fields coming from an electrode , so that the fields out of the plane give charge coupling at long distances . </S>",
    "<S> this implies that stray coupling must be carefully considered and engineered so that these strays do not adversely affect device performance . </S>"
  ]
}