{
  "article_text": [
    "though the universe seems to be dominated by the dark sides of both matter and energy ( turner , 2002 ) , the observed luminous universe has been existing in the form of baryonic matter , whose mass density , constrained by the primordial nucleosynthesis ( walker , et al . , 1991 ) , only occupies a small amount of the total density . to account for the observational features revealed by the baryonic matter , i.e. , x - ray emitting gas in galaxies and clusters ( mulchaey , 2000 ) , intergalactic medium inferred from ly@xmath1 forest ( rauch , 1998 ) , x - ray background radiation ( giacconi et al",
    ". 1962 ) and distorted spectrum of the cosmic background radiation due to the sunyaev - zeldovich effect ( zeldovich & sunyaev 1969 ; ostriker & vishniac 1986 ) etc .",
    ", it would be necessary to incorporate hydrodynamics into cosmological investigations .",
    "this motivation has stimulated great efforts to apply a variety of gas dynamics algorithms to cosmological simulations .",
    "for a general review of the state - of - the - art on this topic , we refer to bertschinger ( 1998 ) .",
    "due to the high non - linearity of gravitational clustering in the universe , there are two significant features emerging in cosmological hydrodynamic flow , which pose more challenges than the typical hydrodynamic simulation without self - gravity .",
    "one significant feature is the extremely supersonic motion around the density peaks developed by gravitational instability , which leads to strong shock discontinuities within complex smooth structures .",
    "another feature is the appearance of an enormous dynamic range in space and time as well as in the related gas quantities .",
    "for instance , the hierarchical structures in the galaxy distribution span a wide range of length scales from a few kpc resolved by individual galaxy to several tens of mpc characterizing the largest coherent scale in the universe .",
    "a variety of numerical schemes for solving the coupled system of collisional baryonic matter and collisionless dark matter have been developed in the past decades .",
    "they fall into two categories , particle methods and grid based methods .",
    "the particle methods include variants of the smooth - particle hydrodynamics ( sph ; gingold & monagham 1977 , lucy 1977 ) such as those of evrard ( 1988 ) , hernquist & katz ( 1989 ) , navarro & white ( 1993 ) , couchman , thomas & pierce ( hydra , 1995 ) , steinmetz ( 1996 ) , owen et al .",
    "( 1998 ) and springel , yoshida & white ( gadget , 2001 ) .",
    "the sph method solves the lagrangian form of the euler equations , and could achieve good spatial resolutions in high density regions , but works poorly in low density regions .",
    "it also suffers from degraded resolution in shocked regions due to the introduction of sizable artificial viscosity .",
    "the grid based methods are to solve the euler equations on structured or unstructured grids .",
    "the early attempt was made by cen ( 1992 ) using a central difference scheme .",
    "it uses artificial viscosity to handle shocks and has first - order accuracy .",
    "the modern approaches implemented for high resolution shock capturing are usually based on the godunov algorithm .",
    "the two typical examples are the total - variation diminishing ( tvd ) scheme ( harten 1983 ) and the piecewise parabolic method ( ppm ) ( collella & woodward 1984 ) .",
    "both schemes start from the integral form of conservation laws of euler equations and compute the flux vector based on cell averages ( finite volume scheme ) .",
    "the tvd scheme modifies the flux using an approximate solution of the riemann problem with corrections added to ensure that there are no postshock oscillations . while in the ppm scheme , the riemann problem is solved accurately using a quadratic interpolation of the cell - average densities that is constrained to minimize postshock oscillations . in the cosmological",
    "setting , the tvd based codes include those of ryu et al .",
    "( 1993 ) , the moving - mesh scheme ( pen , 1998 ) , and the smooth lagrangian method ( gnedin , 1995 ) ; and the ppm based codes include those of stone & norman ( zeus ; 1992 ) , bryan et al .",
    "( 1995 ) , sornborger et al .",
    "( 1996 ) , ricker , dodelson & lamb ( cosmos ; 2000 ) .",
    "the grid - based methods suffer from the limited spatial resolution , but they work extremely well both in low and high density regions as well as in shocks . to reach a large dynamical range ,",
    "the godunov methods have also been implemented with adaptive mesh refinement ( ramses : teyssier , 2002 ; enzo : norman & bryan , 1999 ; oshea et al . , 2004 ) , which is more adequate to explore the fine structures in the hydrodynamic simulation .",
    "we describe in this paper an alternative hydrodynamic solver which discretizes the convection terms in the euler equations by the fifth order finite difference weno ( weighted essentially non - oscillatory ) method , first developed in jiang & shu ( 1996 ) , with a low storage third order runge - kutta time discretization , which was proven to be nonlinearly stable in gottlieb & shu ( 1998 ) .",
    "the weno schemes are based on the essentially non - oscillatory ( eno ) schemes first developed by harten et al .",
    "( 1987 ) in the form of finite volume scheme for hyperbolic conservative laws .",
    "the eno scheme generalizes the total variation diminishing ( tvd ) scheme of harten ( 1983 ) .",
    "the tvd schemes typically degenerate to first - order accuracy at locations with smooth extrema while the eno scheme maintains high order accuracy there even in multi - dimensions .",
    "weno schemes further improve upon eno schemes in robustness and accuracy .",
    "both eno and weno schemes use the idea of adaptive stencils in the reconstruction procedure based on the local smoothness of the numerical solution to automatically achieve high order accuracy and non - oscillatory property near discontinuities . for weno schemes , this is achieved by using a convex combination of a few candidate stencils , each being assigned a nonlinear weight which depends on the local smoothness of the numerical solution based on that stencil .",
    "weno schemes can simultaneously provide a high order resolution for the smooth part of the solution , and a sharp , monotone shock or contact discontinuity transition .",
    "weno schemes are extremely robust and stable for solutions containing strong shocks and complex solution structures .",
    "moreover , a significant advantage of weno is its ability to have high accuracy on coarser meshes and to achieve better resolution on the largest meshes allowed by available computer memory .",
    "we will describe the fifth order weno scheme employed in this paper briefly in  3 . for more details , we refer to jiang & shu ( 1996 ) and the lecture notes by shu ( 1998 , 1999 ) .",
    "weno schemes have been widely used in applications .",
    "some of the examples include dynamical response of a stellar atmosphere to pressure perturbations ( zanna , velli & londrillo , 1998 ) ; shock vortex interactions and other gas dynamics problems ( grasso & pirozzoli , 2000a ; 2000b ) ; incompressible flow problems ( yang et al . , 1998 ) ; hamilton - jacobi equations ( jiang & peng , 2000 ) ; magneto - hydrodynamics ( jiang & wu , 1999 ) ; underwater blast - wave focusing ( liang & chen , 1999 ) ; the composite schemes and shallow water equations ( liska & wendroff , 1998 , 1999 ) ; real gas computations ( montarnal & shu , 1999 ) , wave propagation using fey s method of transport ( noelle , 2000 ) ; etc .    in the context of cosmological applications ,",
    "we have developed a hybrid n - body / hydrodynamical code that incorporates a lagrangian particle - mesh algorithm to evolve the collisionless matter with the fifth order weno scheme to solve the equations of gas dynamics .",
    "this paper is to detail this code and assess its accuracy using some numerical tests .",
    "we proceed as follows . in  2 , we present the basic cosmological hydrodynamic equation for the baryon - cdm coupling system .  3 gives a brief discussion of the numerical scheme for solving the hydrodynamic equations , especially about the implementation of the finite difference fifth order weno scheme and the tvd time discretization . in ",
    "4 , we validate the code using a few challenging numerical tests .",
    "concluding remarks are drawn in  5 .",
    "the hydrodynamic equations for baryons in the expanding universe , without any viscous and thermal conductivity terms , can be written in the following compact form , @xmath2 where @xmath3 and the fluxes @xmath4 , @xmath5 and @xmath6 are five - component column vectors , @xmath7 here t is the cosmic time , @xmath8 is the proper coordinates , which is related to comoving coordinates @xmath9 via @xmath10 ; the subscripts ( @xmath11 ) in equation ( [ hydro ] ) denote spatial derivatives , e.g. @xmath12 ; @xmath13 is the expansion scale factor , @xmath14 is the comoving density , @xmath15 is the proper peculiar velocity , e is the total energy including both kinetic and internal energies , p is comoving pressure , which is related to the total energy e by @xmath16 where we assume an ideal gas equation of state , @xmath17 , where @xmath18 is the total internal energy and @xmath19 is the ratio of the specific heats of the baryon ; for a monatomic gas , @xmath20 . the left hand side of equation ( [ hydro ] ) is written in the conservative form for mass , momentum and energy , the `` force '' source term on the right hand side includes the contributions from the expansion of the universe and the gravitation : @xmath21 where @xmath22 represents the net energy loss due to the radiative heating - cooling of the baryonic gas , and @xmath23 is the peculiar acceleration in the gravitational field produced by both the dark matter and the baryonic matter .",
    "the motions of the collisionless dark matter in comoving coordinates are governed by a set of newtonian equations , @xmath24 where @xmath25 and @xmath26 are the comoving coordinates and the proper peculiar velocity respectively , and the subscript @xmath27 refers to the dark matter .",
    "the peculiar gravitational potential obeys the poisson equation , @xmath28/a\\ ] ] in which @xmath29 is the gravitational constant , @xmath30 is a sum of the comoving baryon and dark matter density , and @xmath31 is the uniform background density at time @xmath32 .",
    "the fifth order weno finite difference spatial discretization to a conservation law such as @xmath33 approximates the derivatives , for example @xmath34 , by a conservative difference @xmath35 along the @xmath36 line , with @xmath37 and @xmath38 fixed , where @xmath39 is the numerical flux . @xmath40 and @xmath41 are approximated in the same way . hence finite difference methods have the same format for one and several space dimensions , which is a major advantage . for the simplest case of a scalar equation ( [ 1.1 ] ) and if @xmath42 , the fifth order finite difference weno scheme has the flux given by @xmath43 where @xmath44 are three third order accurate fluxes on three different stencils given by @xmath45 notice that the combined stencil for the flux @xmath39 is biased to the left , which is upwinding for the positive wind direction due to the assumption @xmath42 .",
    "the key ingredient for the success of weno scheme relies on the design of the nonlinear weights @xmath46 , which are given by @xmath47 where the linear weights @xmath48 are chosen to yield fifth order accuracy when combining three third order accurate fluxes , and are given by @xmath49 the smoothness indicators @xmath50 are given by @xmath51 and they measure how smooth the approximation based on a specific stencil is in the target cell .",
    "finally , @xmath52 is a parameter to avoid the denominator to become 0 and is usually taken as @xmath53 in the computation .",
    "the choice of @xmath52 does not affect accuracy , the errors can go down to machine zero with mesh refinement while @xmath53 is kept fixed .",
    "this finishes the description of the fifth order finite difference weno scheme in jiang & shu ( 1996 ) in the simplest case .",
    "as we can see , the algorithm is actually quite simple and the user does not need to tune any parameters in the scheme .",
    "we briefly summarize the properties of this weno finite difference scheme .",
    "for details of proofs and numerical verifications , see jiang & shu ( 1996 ) and the lecture notes of shu ( 1998 , 1999 ) .    1 .",
    "the scheme is proven to be uniformly fifth order accurate including at smooth extrema , and this is verified numerically .",
    "2 .   near discontinuities",
    "the scheme produces sharp and non - oscillatory discontinuity transition .",
    "3 .   the approximation is self - similar .",
    "that is , when fully discretized with the runge - kutta methods in next section , the scheme is invariant when the spatial and time variables are scaled by the same factor .",
    "this is a major advantage for approximating conservation laws which are invariant under such scaling .",
    "we then indicate how the scheme is generalized in a more complex situation , eventually to 3d systems such as the euler equations :    1 .   for scalar equations without the property @xmath54 ,",
    "one uses a flux splitting @xmath55 and apply the above procedure to @xmath56 , and a mirror image ( with respect to @xmath57 ) procedure to @xmath58 .",
    "the only requirement for the splitting is that @xmath59 should be smooth functions of @xmath60 . in this paper",
    "we use the simple lax - friedrichs flux splitting @xmath61 where the maximum is taken over the relevant range of @xmath60 .",
    "this simple lax - friedrichs flux splitting is quite diffusive when applied to first and second order discretizations , but for the fifth order weno discretization we adopt , it has very small numerical viscosity .",
    "2 .   for systems of hyperbolic conservation laws , the nonlinear part of the weno procedure ( i.e. the determination of the smoothness indicators @xmath50 and",
    "hence the nonlinear weights @xmath46 ) is carried out in local characteristic fields .",
    "thus one would first find an average @xmath62 of @xmath63 and @xmath64 ( we use the roe average , roe ( 1978 ) , which exists for many physical systems including the euler equations ) , and compute the left and right eigenvectors of the jacobian @xmath65 and put them into the rows of a matrix @xmath66 and the columns of another matrix @xmath67 , respectively , such that @xmath68 where @xmath69 is a diagonal matrix containing the real eigenvalues of @xmath70 .",
    "one then transforms all the quantities needed for evaluating the numerical flux @xmath39 to the local characteristic fields by left multiplying them with @xmath66 , and then computes the numerical fluxes by the scalar procedure in each characteristic field .",
    "finally , the flux in the original physical space is obtained by left multiplying the numerical flux obtained in the local characteristic fields with @xmath67 .",
    "3 .   if one has a non - uniform but smooth mesh , for example @xmath71 where @xmath72 is uniform and @xmath73 is a smooth function of @xmath74 , then one could use the chain rule @xmath75 and simply use the procedure above for uniform meshes to approximate @xmath76 .",
    "using this , one could use finite difference weno schemes on smooth curvilinear coordinates in any space dimension .",
    "weno finite difference schemes are available for all odd orders , see liu , osher & chan ( 1994 ) and balsara and shu ( 2000 ) for the formulae of the third order and seventh through eleventh order weno schemes .",
    "the finite difference weno scheme we use in this paper is formulated first as method of lines , namely discretized in the spatial variables only .",
    "it is still necessary for us to discretize the time variable .",
    "often it is easier to prove stability ( e.g. for tvd schemes ) when the time variable is discretized by the first order accurate forward euler , however time accuracy is as important as spatial accuracy , hence we would like to have higher order accuracy in time while maintaining the stability properties of the forward euler time stepping .",
    "we use a class of high order nonlinearly stable runge - kutta time discretizations .",
    "a distinctive feature of this class of time discretizations is that they are convex combinations of first order forward euler steps , hence they maintain strong stability properties in any semi - norm ( total variation norm , maximum norm , entropy condition , etc . ) of the forward euler step , with a time step restriction proportional to that for the forward euler step to be stable , this proportion coefficient being termed cfl ( courant - friedrichs - levy , referring to stability restrictions on the time step ) coefficient of the high order runge - kutta method .",
    "thus one only needs to prove nonlinear stability for the first order forward euler step , which is relatively easy in many situations ( e.g. tvd schemes ) , and one automatically obtains the same strong stability property for the higher order time discretizations in this class .",
    "these methods were first developed in shu & osher ( 1988 ) and shu ( 1988 ) , and later generalized in gottlieb & shu ( 1998 ) and gottlieb , shu & tadmor ( 2001 ) .",
    "the most popular scheme in this class is the following third order runge - kutta method for solving @xmath77 where @xmath78 is a spatial discretization operator ( it does not need to be , and often is not , linear ) : @xmath79 which is nonlinearly stable with a cfl coefficient 1 .",
    "however , for our purpose of 3d calculations , storage is a paramount consideration .",
    "we thus use a third order low storage nonlinearly stable runge - kutta method , which was proven to be nonlinearly stable with a cfl coefficient 0.32 ( gottlieb & shu , 1998 ) .",
    "although the time step of this low storage method must be smaller for stability analysis , in practice the time step can be taken larger ( for example with a cfl coefficient 0.6 used in this paper ) without observing any instability . in appendix",
    "a , the algorithm of the third - order low storage runge - kutta method is given .",
    "this method is to be applied to the numerical tests presented in the following section (  4 ) .      in cosmological hydrodynamic simulations ,",
    "one main challenge is to track precisely the thermodynamic evolution in supersonic flows around the density peaks due to gravitational collapse .",
    "the supersonic flow could have a high mach number , as large as @xmath80 , at which the ratio of the internal thermal energy @xmath81 to the kinetic energy @xmath82 is as small as @xmath83 . in an eulerian numerical scheme for hydrodynamics ,",
    "the thermal energy is obtained by subtracting the kinetic energy from the total energy @xmath84 .",
    "this calculation leads to a significant error if the thermal energy is negligibly small comparing with the kinetic energy .",
    "even though there is an improvement of the quality when weno scheme is used , due to its high order accuracy near shock fronts , the problem still remains .",
    "this is what is referred to in the literature as the high mach number problem .    to tackle the high mach number flow that frequently appears in cosmological hydrodynamic simulations , the current common practice is to solve the thermal energy accurately using a complementary equation in the unshocked region , either a modified entropy equation ( ryu et al . , 1993 ) or the internal energy equation ( bryan et al . , 1995 )",
    ". in this paper",
    ", we combine these two approaches .",
    "that is , we take the dual energy approach of bryan et al . , but instead of solving the internal energy equation , we follow ryu et al .",
    "( 1993 ) to solve the modified entropy equation . without taking account of the energy loss across shocks , the conservative form of",
    "the modified entropy is , @xmath85 where @xmath86 is the modified entropy defined by @xmath87 .",
    "it is noted that the entropy equation is only valid in unshocked regions , and can be solved numerically by the standard weno finite difference scheme . with the entropy equation ( [ entropy ] ) , the thermal energy is updated from the results of either total energy inside shocks or modified entropy outside shocks according to an ad hoc criterion , which operates on each cell using @xmath88 where @xmath89 is a free parameter .",
    "we take @xmath90 in our calculations in order to have no noticeable dynamical effect on the system . to incorporate the pressure obtained from the modified entropy equation into the total energy equation , we reset the total energy @xmath91 or the entropy @xmath86 at each time loop .",
    "namely , according to the criterion equation ( 10 ) , if the pressure is determined by the total energy equation , we update the entropy by @xmath92 ; and if the pressure is given by the entropy equation , we reset the total energy by @xmath93 .",
    "these procedures enable us to track both the thermal energy and total energy correctly in the shocked and unshocked regions .      in practical cosmological simulations",
    ", the code proceeds according to the following stages :    1 .   under the gaussian assumption of the primordial density fluctuations ,",
    "we initialize a simulation using the zeldovich approximation to set up a distribution of cdm particles . the baryonic density and velocity fields",
    "are then given as in cen ( 1992 ) ; 2 .",
    "the weno scheme is applied to compute the advection fluxes for the hydrodynamic variables as described in  3.1 ; 3 .",
    "the gravitational field is solved by the standard particle - mesh n - body technique ( see hockney & eastwood , 1988 ; efstathiou et al . 1985 ) .",
    "namely , for the dark matter particles , the density is assigned to the grid with a cloud - in - cell ( cic ) method and then subjected to a fast fourier transform ( fft ) to generate the discretized density field ; the gravitational potential to the poisson equation is then obtained by a convolution technique , in which we make use of the optimized green function appropriate to the seven - point finite difference approximation to the laplacian ; 4 .",
    "the positions and velocities of cdm particles as well as the hydrodynamic variables are updated with the third order low storage runge - kutta method , which ensures third order accuracy in the time integration of the system .",
    "the time step is chosen by the minimum value among three time scales .",
    "the first is from the courant condition given by @xmath94 where @xmath95 is the cell size , @xmath96 is the local sound speed , @xmath97 , @xmath98 and @xmath99 are the local fluid velocities and @xmath100 is the courant number for the stability of time discretization .",
    "the analysis for nonlinear stability allows the courant number to be up to 1 for the regular third order nonlinearly stable runge - kutta time discretization given by equation ( [ s1 ] ) , and up to 0.32 for the low storage third order nonlinearly stable runge - kutta time discretization given by equations ( [ s2])-([s3 ] ) , that we use in this paper .",
    "typically , we take @xmath101 in our computation and observe stable results .",
    "the second constraint is imposed by cosmic expansion which requires that @xmath102 within a single time step .",
    "this constraint comes from the requirement that a particle moves no more than a fixed fraction of the cell size in one time step . in cosmological simulations ,",
    "the time step is always controlled by the cosmological expansion at the early stage of evolution , but most of the cpu time is spent in courant time steps at the later nonlinear clustering regimes .",
    "our hybrid cosmological hydrodynamic / n - body code has been written in fortran 90 . compiling on a dell precision 530 workstation with one intel(r ) xeon(tm ) processor 2.8ghz/533mhz , it runs at the speed of @xmath103 zones per second without the n - body / gravity solver and @xmath104 zones with the n - body / gravity solver . for the benchmark of the weno code with the same implementation as ours but without gravity , performed on an ibm sp parallel computer , we refer to tables ( 1 ) and ( 2 ) of shi , zhang & shu ( 2003 ) for details",
    "the weno scheme in application to both compressible and incompressible gas hydrodynamics has been subjected to a variety of numerical tests , e.g. , shock tube problem , double mach reflection , 2-dimensional shock vortex interactions , etc .",
    "all of these tests work very well , especially for the situation when both shocks and complicated smooth flow features co - exist , demonstrating the advantages of high order schemes . for these test results of weno schemes ,",
    "see , e.g. shu ( 2003 ) and the references therein . in this section",
    ", we are going to run the following tests : ( 1 ) the sod shock tube tests in one- , two- and three - dimensions ; ( 2 ) the sedov spherical blast wave in 3-dimensions ; ( 3 ) the zeldovich pancake which characterizes the structure formation in the universe by the single - mode analysis ; and ( 4 ) finally , we demonstrate the code by simulating the adiabatic evolution of the universe in a @xmath0cdm model .      the sod shock tube problem ( sod , 1978 ) has been widely used to test the ability of hydrodynamic codes for shock capturing . under a specifically chosen initial condition",
    ", it could produce all of three types of fluid discontinuity : shock , contact and rarefaction .",
    "the sod problem is set as a straight tube of gas divided by a membrane into two chambers .",
    "the initial state of the gas are specified by uniform density and pressure on both chambers respectively . on the left chamber",
    ", we set @xmath105 , @xmath106 , and on the right , @xmath107 , @xmath108 .",
    "the gas is assumed to be at rest everywhere initially .",
    "the polytropic index is @xmath109 .",
    "the sod shock tube is actually a 1-dimensional problem . to find",
    "how well the shock structure is resolved in high dimensions , we perform the test in one- , two- and three - dimensional cases . in 1-dimension , the shock propagates along the line of the x - axis . for two- and three - dimensional cases , the shock propagates along the main diagonal of the calculation region , i.e. , along the line ( 0,0 ) to ( 1,1 ) in the square and along the line ( 0,0,0 ) to ( 1,1,1 ) in the cube .",
    "1 compares the numerical results at @xmath110 with the analytical solution in one- , two- and three - dimensions respectively , in which 64 cells in each direction have been used .",
    "comparable to the calculations done with ppm or tvd schemes ( e.g. ryu et al . 1993 , pen 1998 , ricker et al . , 2000 )",
    ", the shock and contact discontinuity can be resolved within two to three cells in the multidimensional calculations , and moreover , each quantity gets some improvements with the increase of spatial dimensions .",
    "another challenging test for the 3-dimensional hydrodynamic code is the sedov blast wave ( sedov , 1993 ) .",
    "we initialize the simulation by setting up a point - like energy release in a homogeneous medium of density and negligible pressure",
    ". this explosion will develop a spherical blast wave that sweeps material around as it propagates outward along the radial direction .",
    "the derivation of the full analytical solutions can be found in landau & lifshitz ( 1987 ) .",
    "it has been currently used for modeling the supernova explosion .",
    "the shock front propagates according to @xmath111 where @xmath112 for an ideal gas with a polytropic index @xmath20 .",
    "the velocity of the shock is given by @xmath113 .",
    "behind the shock , the density , momentum and pressure are given by @xmath114    we apply the 3-dimensional weno scheme to run the sedov - taylor blast test .",
    "the simulation is performed in a cubic box with a @xmath115 grid , and initialized by setting up a uniform density @xmath116 and negligible pressure with a very small value @xmath117 to match a numerical approximation to zero .",
    "a point - like energy @xmath118 is injected at the center of the box , and the medium is at rest initially .",
    "the challenging nature of the spherical sedov - taylor blast wave stems from the fact that a cartesian grid is used . to minimize the anisotropic effects due to the cartesian coordinates , we convolve the initial condition with a spherical gaussian filter with a window radius of 1.5 grids .",
    "the full three - dimensional numerical solutions for density , momentum and pressure are displayed in fig . 2 by projecting onto the radial coordinate .",
    "as can be seen in fig .",
    "2 , the numerical solution captures the spatial profile of the shock well , although there is still some scattering around the analytical solution .",
    "obviously , the scattering originates from the geometric effect of the projection from the cartesian grid onto the spherical coordinate .",
    "such geometric anisotropy also leads to the shock front being not fully resolved within one cell as described by the analytical solution .",
    "accordingly , in the widened shock front of the numerical solution , both density and pressure have been underestimated in comparison with their predicted maximum values .",
    "3 presents the density distributions in a slice across the explosion point .",
    "the anisotropy could be clearly seen in this figure .",
    "the zeldovich pancake problem ( zeldovich , 1970 ) provides a stringent numerical test for cosmological hydrodynamic codes .",
    "it involves the basic physics underlying in cosmological simulation , namely , hydrodynamics , self - gravity , cosmic expansion , and strong shock formed in smooth structure with high mach numbers . in the one - dimensional case , the problem can be formulated by placing a sinusoidal perturbation along the axis and tracking its evolution . in the linear or quasi - linear regime",
    ", there exists an exact solution in the lagrangian coordinate if the pressure is neglected . for a flat cosmology",
    ", the solution can be written in the following forms @xmath119^{-1 } \\\\",
    "v(x_l)&=&-h_0\\frac{1+z_c}{(1+z)^{1/2}}\\frac{\\sin(kx_l)}{k}\\end{aligned}\\ ] ] where @xmath120 is a redshift at which the gravitational collapse results in the formation of caustics , i.e. , zeldovich pancake .",
    "@xmath121 is the huuble constant , @xmath122 , and @xmath123 specifies the comoving perturbation wavelength .",
    "@xmath124 is the lagrangian coordinate which is related to the eulerian position @xmath125 by @xmath126    for the numerical model , we adopt the same parameters as those used in bryan et al .",
    "( 1995 ) , which are given by @xmath127 , @xmath128 , @xmath129 , @xmath130 .",
    "the simulation is performed from the initial redshift @xmath131 for the purely baryonic gas with a uniform temperature distribution @xmath132 .",
    "it is noted that the analytical solution given by equation ( [ za ] ) holds until the redshift @xmath133 of caustic formation . in fig .",
    "4 , we compare the numerical solution using a @xmath134 grid to the zeldovich pancake with the analytical solution at z=10 and z=1.05 .",
    "we can clearly see an excellent agreement between the numerical and analytical solutions . to access the accuracy to which our weno / pm code is able to reach , we run the code with a fixed perturbation wavelength but a varying number of zones @xmath135 . using the exact solution ( 16)-(18 ) , we define the @xmath136 error norms for the density as @xmath137 where @xmath138 is the numerical solution on the grid , and @xmath139 is the zeldovich solution given by equation ( 16 ) .",
    "the @xmath136 error norm for the velocity fields are defined similarly .",
    "the results at different redshifts ranging from the linear regime @xmath140 to the highly nonlinear collapsing phase @xmath141 are displayed in fig .",
    "usually , the @xmath136 error should be scaled with @xmath135 according to a power law @xmath142 or with spatial resolutions as @xmath143 , where @xmath144 is defined as the convergence rate . for the density field",
    ", the @xmath136 error declines rapidly with @xmath145 at @xmath140 . with decreasing redshifts",
    ", the convergence rate slows down , e.g. , the error varies approximately as @xmath146 at @xmath141 , namely , roughly a linear convergence law with the spatial resolution .",
    "the velocity at @xmath140 converges somewhat faster than the density with convergence rate @xmath147 , but somewhat slower at @xmath141 with @xmath148 .",
    "the non - linear evolution subsequent to the caustics formation is more difficult to track numerically than that in the linear phase .",
    "the formation of the caustics is due to the head - on collision of two cold bulk flows and gravitational collapsing , which result in a strong shock and large gradients in the involved physical fields .",
    "moreover , a large range of variation in the temperature distribution is also difficult to capture numerically . in fig .",
    "6 we plot the solution for the density , velocity and temperature distribution at @xmath149 obtained from a 256 zone run .",
    "it should be noted that , in the unshocked region , the temperature is solved from the entropy equation and remains with a uniform temperature 1k , which is the artificial minimum temperature .    to determine how well the shock is resolved by the weno scheme at different resolutions , we also make runs with 32 , 64 , 128 zones and compare with a high resolution run with 512 zones . unlike the similar comparison done by bryan using the ppm scheme , we have not degraded the solution at the high resolution to appropriate scales .",
    "the results are shown in fig .",
    "clearly , the shock structure is well resolved by approximately equal number of zones for the three low resolution solutions , although the width of the shock is widened with reduced resolution correspondingly .",
    "moreover , we see that the solution with 128 zones has already converged to that with 512 zones , which is likely to be the real physical solution to the problem .",
    "this demonstrates the rapid convergence rate of the high order weno scheme even in the highly nonlinear phase of the caustics .",
    "we run the hybrid hydrodynamic / n - body weno / pm code to track the cosmic evolution of the coupled system of both dark matter and baryonic matter in a flat low density cdm model ( @xmath0cdm ) , which is specified by the density parameter @xmath150 , cosmological constant @xmath151 , hubble constant @xmath152 , and the mass fluctuation within a sphere of radius 8h@xmath153mpc , @xmath154 .",
    "the baryon fraction is fixed using the constraint from primordial nucleosynthesis as @xmath155 ( walker et al . , 1991 ) .",
    "the initial condition has been generated by the gaussian random field with the linear cdm power spectrum taken from the fitting formulae presented by eisenstein & hu ( 1998 ) .",
    "the simulation is performed in a periodic box of side length of 25h@xmath153mpc with a 192@xmath156 grid and an equal number of dark matter particles .",
    "the universe is evolved from @xmath157 to @xmath149 .",
    "the initial temperature is set to @xmath158 and the polytropic index takes the value @xmath20 . for comparison ,",
    "two sets of simulation have been performed by using the weno - e and weno - s schemes , which update the energy and entropy respectively outside the shocked regions , see section 3.3 .",
    "8 plots density contours for the baryonic matter ( lower panel ) and the cold dark matter ( upper panel ) in a slice with 2-cell thickness of 0.26h@xmath159mpc at @xmath160 . in fig .",
    "9 , we compare the cell temperature contours drawn from the simulations using the weno - e ( lower panel ) and weno - s ( upper panel ) codes . obviously , the two simulations coincide in the high temperature @xmath161 regions , but in the low temperature regions , the weno - e simulation gives less fractions of the volume than those from weno - s .",
    "this phenomenon is due to the artificial numerical errors , which heats up significantly the regions with temperature @xmath162k to @xmath163k in the weno - e calculation .",
    "in contrast , since the entropy equation is capable of tracking the temperature field with high accuracy and hence the spurious heating is minimized , the cold unshocked regions occupy more volumes in the weno - s calculation .",
    "10 gives an example of density , velocity and temperature distributions along a randomly chosen lines of sight . to demonstrate further the difference between the weno - e and weno - s codes , we plot the results from both calculations in each panel .",
    "once again , the numerical heating in the pre - shock or unshocked regions is clearly seen in this plot .",
    "our result is compatible with that of ryu et al .",
    "( 1993 ) for a purely baryonic universe .",
    "moreover , it is also noted from fig .",
    "10 that there are not significant differences between the density and velocity fields in the weno - s and weno - e calculations , while for the temperature distribution , the difference occurs in the regions of cold gas , @xmath164k .",
    "this demonstrates that the internal energy corrections made in cold regions ( mostly in unshocked gas ) by the modified entropy equation have little dynamical effect on the flow structure except for the internal energy or temperature fields .    in fig .",
    "11 , we present an alternative view of the difference between the weno - e and weno - s codes by plotting histograms of the volume - weighted ( upper panel ) and mass - weighted ( lower panel ) temperature on the @xmath165 grids . clearly , the artificial numerical heating is serious in the regions occupied by the low - temperature gas in the weno - e calculation , however it is less significant in the fraction of mass .",
    "another illustration indicating such a difference can be given by contour plots of the volume fraction with given temperature and density .",
    "as displayed in fig .",
    "12 , the volume difference only occurs in the low - density / low temperature regions with @xmath166 and @xmath164k , typically around @xmath167 , @xmath168k .",
    "it should be noted that , although the spurious heating does exist also in the standard weno code , it is weaker than those in low - order schemes , e.g. , the second order tvd code of ryu et al .",
    "this benefit clearly comes from the higher order accuracy acquired in our fifth - order weno scheme , which leads to smaller numerical errors in the calculations",
    ". however , for realistic cosmological simulations , such a difference may not be significant while the radiation field is taken into account .",
    "for instance , in the presence of ionizing uv background , the baryonic intergalactic medium could be heated up to @xmath169k .",
    "the simulation including the radiative heating - cooling and ionization and relevant statistical analysis will be presented elsewhere .",
    "in this paper , we have described a newly developed hybrid cosmological hydrodynamic code based on weighted essentially non - oscillatory ( weno ) schemes for the euler system of conservation laws .",
    "we implement the fifth order finite difference weno to solve the inviscid fluid dynamics on a uniform eulerian grid combining with a third order low storage runge - kutta tvd scheme for advancing in time . in order to solve the cosmological problem involving both collisional baryonic matter and collisionless dark matter",
    ", we incorporate the particle - mesh method for computing the self - gravity into our cosmological code .",
    "the code has been subjected to a number of tests for its accuracy and convergence .",
    "as expected , the weno scheme demonstrates its capacity of capturing shocks and producing sharp and non - oscillatory discontinuity transition without generating oscillations . in comparison with other existing hydrodynamic codes such as the tvd or ppm schemes , one striking feature of the weno code",
    "is that it retains higher order accuracy in smooth regions including at smooth extrema even in multidimensions , and yet it is still highly stable and robust for strong shocks . in performance ,",
    "the weno scheme needs more floating point operations per cell than those of the ppm and tvd schemes .",
    "however , in compensating for twice or more loss of the computational speed , the weno scheme achieves both higher order accuracy and convergence rate than ppm and tvd codes according to our numerical tests .    in the presence of gravity ,",
    "the hydrodynamics become more challenging than that without gravity due to the highly non - linearity of gravitational clustering .",
    "one serious problem encountered in many cosmological applications is the so called high mach number problem . to address this problem ,",
    "we have incorporated an extra technique into our cosmological weno / pm code , which is actually a combination of the dual energy algorithm ( bryan et al .",
    "1995 ) and the energy - entropy algorithm ( ryu et al . 1993 ) .",
    "namely , instead of solving the internal energy equation in regions free of shocks as was done in the dual energy algorithm ( bryan et al .",
    "1995 ) , we solve the modified entropy equation ( ryu et al . 1993 ) , which takes a conservative form and can be easily solved using the standard weno scheme .",
    "this improvement over our hydrodynamic weno code ensures an accurate tracking of the temperature field in regions free of shocks .",
    "it is pointed out that the high order weno discretization , e.g. , the fifth order weno scheme adopted in this paper , introduces a quite small numerical viscosity , which does not lead to a significant violation of energy conservation in the presence of gravitational fields . while for a second - order tvd scheme",
    ", the numerical diffusion is no longer negligible . in order to have a better conservation of the total energy , it is usually corrected by adding a compensation term in the gravitational force term ( ryu et al , 1993 ) .",
    "the euler hydrodynamics on fixed meshes have several distinct advantages which includes simplicity for implementation , easy data parallelization , relatively low floating point cost , large dynamic range in mass and high resolution of shock capturing .",
    "in particular , the weno scheme can also achieve a higher accuracy on coarse meshes and a better resolution on the largest meshes allowed by available memory . to suit for large simulations of the cosmological problem , further improvement of the hydrodynamic weno code",
    "is needed in its implementation on distributed memory computers .",
    "the parallel version of the code based on the message - passing interface ( mpi ) has been under development .",
    "llf acknowledges support from the national natural science foundation of china ( nnsfc ) and national key basic research science foundation .",
    "cws and mz acknowledge the support by nnsfc grant 10028103 while cws is in residence at the department of mathematics , university of science and technology of china , hefei , anhui 230026 , p.r . china .",
    "additional support for cws is provided by aro grant daad19 - 00 - 1 - 0405 and nsf grant dms-0207451 .",
    "general low - storage runge - kutta schemes can be written in the form @xmath170 only @xmath60 and @xmath171 must be stored , resulting in two storage units for each variable , instead of three storage units for equation ( [ s1 ] ) .",
    "the third order nonlinearly stable version we use , gottlieb & shu ( 1998 ) , has @xmath172 in ( [ s2 ] ) with @xmath173 where @xmath174 .",
    "oshea , b.w . ,",
    "bryan , g. , bordner , j. , norman , m.l . ,",
    "abel , t. , harkness , r. , & kritsuk , a. , 2004 , in adaptive mesh refinement - theory and applications , eds .",
    "plewa , t. , linde t. & weirs , v.g .",
    "( springer )                        shu , c .- w .",
    ", 1998 , in _ advanced numerical approximation of nonlinear hyperbolic equations _ , b. cockburn , c. johnson , c .- w .",
    "shu and e. tadmor ( editor : a. quarteroni ) , lecture notes in mathematics , 1697 , 325 ( springer )"
  ],
  "abstract_text": [
    "<S> we present a newly developed cosmological hydrodynamics code based on weighted essentially non - oscillatory ( weno ) schemes for hyperbolic conservation laws . </S>",
    "<S> weno is a higher order accurate finite difference scheme designed for problems with piecewise smooth solutions containing discontinuities , and has been successfully applied for problems involving both shocks and complicated smooth solution structures . </S>",
    "<S> we couple hydrodynamics based on the weno scheme with standard poisson solver - particle - mesh ( pm ) algorithm for evolving the self - gravitating system . </S>",
    "<S> the third order low storage total variation diminishing ( tvd ) runge - kutta scheme has been used for the time integration of the system . to test accuracy and convergence rate of the code , we subject it to a number of typical tests including the sod shock tube in multidimensions , the sedov blast wave and formation of the zeldovich pancake . </S>",
    "<S> these tests validate the weno hydrodynamics with fast convergence rate and high accuracy . </S>",
    "<S> we also evolve a low density flat cosmological model ( @xmath0cdm ) to explore the validity of the code in practical simulations . </S>"
  ]
}