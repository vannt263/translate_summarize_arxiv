{
  "article_text": [
    "the human visual system can easily identify perceptually salient edges in an image . endowing machine vision systems with similar capabilities",
    "is of interest as edges are useful for diverse tasks such as optical flow  @xcite , object detection  @xcite , and object proposals  @xcite . however , edge detection has proven challenging . early approaches  @xcite relied on low - level cues such as brightness and color gradients .",
    "reasoning about texture  @xcite markedly improved results , nevertheless , accuracy still substantially lagged human performance .",
    "the introduction of the bsds dataset  @xcite , composed of human annotated region boundaries , laid the foundations for a fundamental shift in edge detection . rather than rely on complex hand - designed features , dollr et al .",
    "@xcite proposed a data - driven , supervised approach for learning to detect edges .",
    "modern edge detectors have built on this idea and substantially pushed the state - of - the - art forward using more sophisticated learning paradigms @xcite .    however , existing data - driven methods require strong supervision for training .",
    "specifically , in datasets such as bsds  @xcite , human annotators use their knowledge of scene structure and object presence to mark semantically meaningful edges .",
    "moreover , recent edge detectors use imagenet pre - training  @xcite . in this paper",
    ", we explore whether this is necessary : _ is object - level supervision indispensable for edge detection ? and moreover , can edge detectors be trained entirely without human supervision ? _        we propose training edge detectors using motion in place of human supervision .",
    "motion edges are a subset of image edges , see figure  [ fig : teaser ] .",
    "therefore motion edges can be used to harvest positive training samples . on the other hand",
    ", locations away from motion edges may still contain image edges .",
    "fortunately , as edges are sparse , simply sampling such locations at random can provide good negative training data with few false negatives .",
    "thus , assuming accurate motion estimates , we can potentially harvest unlimited training data for edge detection .    while it would be tempting to assume access to accurate motion estimates ,",
    "this is arguably an unreasonably strong requirement . indeed , optical flow and edge detection are tightly coupled .",
    "recently , revaud et al .  proposed epicflow  @xcite : given an accurate edge map  @xcite and semi - dense matches between frames  @xcite , epicflow generates a dense edge - respecting interpolation of the matches .",
    "the result is a state - of - the - art optical flow estimate .",
    "this motivates our approach . we begin with only semi - dense matches between frames  @xcite and a rudimentary knowledge of edges ( simple image gradients ) .",
    "we then repeatedly alternate between computing flow based on the matches and most recent edge maps and retraining an edge detector based on signal obtained from the flow fields . specifically , at each iteration , we first estimate dense flow fields by interpolating the matching results using the edge maps obtained from the previous iteration . given a large corpus of videos , we next harvest highly confident motion edges as positives and randomly sample negatives , and use this data to train an improved edge detector .",
    "the process is iterated leading to increasingly accurate flow and edges .",
    "an overview of our method is shown in figure  [ fig : overview ] .",
    "we experiment with the structured edge ( se )  @xcite and holistic edge ( he )  @xcite detectors .",
    "se is based on structured forests , he on deep networks ; se is faster , he more accurate .",
    "both detectors achieve state - of - the - art results .",
    "the main result of our paper is that both methods , trained using our unsupervised scheme , approach the same performance as when trained in a fully supervised manner .",
    "finally , we demonstrate that our approach can serve as a novel unsupervised pre - training scheme for deep networks  @xcite .",
    "specifically , we show that when fine - tuning a network for object detection  @xcite , starting with the weights learned for edge detection improves performance over starting with a network with randomly initialized weights . while the gains are modest , we believe this is a promising direction for future exploration .",
    "* edge detection : * early edge detectors were manually designed to utilize image gradients  @xcite and later texture gradients  @xcite . of more relevance to this work are edge detectors trained in a data - driven manner . since the work of  @xcite , which formulated edge detection as a binary classification problem , progressively more powerful learning paradigms have been employed , including mulit - class classification  @xcite , feature learning  @xcite , regression  @xcite , structured prediction  @xcite , and deep learning  @xcite .",
    "recently , weinzaepfel et al .",
    "@xcite extended  @xcite to motion edge estimation .",
    "these methods all require strong supervision for training . in this work",
    "we explore whether unsupervised learning can be used instead ( and as discussed select @xcite for our experiments ) .",
    "* optical flow : * the estimation of optical flow is a classic problem in computer vision  @xcite .",
    "a full overview is outside of our scope , instead , our work is most closely related to methods that leverage sparse matches or image edges for flow estimation  @xcite . in particular , like  @xcite , we utilize edge - respecting sparse - to - dense interpolation of matches to obtain dense motion estimates .",
    "our focus , however , is not on optical flow estimation , instead , we exploit the tight coupling between edge and flow estimation to train edge detectors without human supervision .    * perceptual grouping using motion : * motion plays a key role for grouping and object recognition in the human visual system  @xcite",
    ". in particular , ostrovsky et al .",
    "@xcite studied the visual skills of individuals recovering from congenital blindness and showed that motion cues were essential to help facilitate the development of object grouping and representation .",
    "our work is closely inspired by these findings : we aim to learn an edge detector using motion cues .    * learning from video : * there is an emerging interest for learning visual representations using video as a supervisory signal , for example by enforcing that neighboring frames have a similar representation  @xcite , learning latent representations for successive frames  @xcite , or learning to predict missing or future frames  @xcite . instead of simply enforcing various constraints on successive video frames , wang and gupta",
    "@xcite utilize object tracking and enforce that tracked patches in a video should have a similar visual representation .",
    "the resulting network generalizes well to surface normal estimation and object detection .",
    "as we will demonstrate , our approach can also serve as a novel unsupervised pre - training scheme .",
    "however , while in previous approaches the training objective was used as a surrogate to encourage the network to learn a useful representation , our primary goal is to train an edge detector and the learned representation is simply a useful byproduct .",
    "we start with a set of low level cues using standard tools in computer vision , including point correspondences and image gradients .",
    "we use deepmatching  @xcite to obtain semi - dense matches @xmath0 between two consecutive frames @xmath1 . deepmatching computes correlations at different locations and scales to generate the matches . note that contrary to its name , the method involves no deep learning . for the rest of the paper",
    ", we fix the matching results @xmath0 .    our proposed iterative process is described in figure  [ fig : overview ] and algorithm  [ fig : algorithm ] .",
    "we denote the edge detector at iteration @xmath2 by @xmath3 . for each image @xmath4 , we use @xmath5 and @xmath6 to denote its image edges and motion edges at iteration @xmath2 .",
    "we initialize @xmath7 to the raw image gradient magnitude of @xmath4 , defined as the maximum gradient magnitude over color channels .",
    "the gradient magnitude is a simple approximation of image edges , and thus serves as a reasonable starting point .    at each iteration @xmath2",
    ", we use epicflow  @xcite to generate edge - preserving flow maps @xmath8 given matches @xmath9 and previous edges @xmath10 .",
    "we next apply @xmath11 on a colored version of @xmath8 to get an estimate of motion edges @xmath6 .",
    "@xmath6 is further refined by aligning to superpixel edges .",
    "next , for training our new edge detector @xmath3 , we harvest positives instances using a high threshold on @xmath6 and sample random negatives away from any motion edges .",
    "the above process is iterated until convergence ( typically 3 to 4 iterations suffice ) . at each iteration",
    "the flow @xmath8 and edge maps @xmath5 and @xmath6 improve . in the following sections we describe the process in additional detail .",
    "pairs of frames @xmath12 , matches @xmath9 @xmath13 = gradient magnitude operator , @xmath14 estimate flow @xmath8 using previous edge maps @xmath10 + @xmath15 detect motion edges @xmath6 by applying @xmath11 to @xmath8 + @xmath16 train new edge detector @xmath3 using motion edges @xmath6 + @xmath17 apply edge detector @xmath3 to all frames + @xmath18 @xmath19 and @xmath20      * epicflow : * epicflow  @xcite takes as input an image pair @xmath1 , semi - dense matches @xmath0 between the images , and an edge map @xmath21 for the first frame .",
    "it efficiently computes approximate geodesic distance defined by @xmath21 between all pixels and matched points in @xmath0 .",
    "for every pixel , the geodesic distance is used to find its @xmath22 nearest matches , and the weighted combination of their motion vectors determines the source pixel s motion .",
    "a final optimization is performed by a variational energy minimization to produce an edge - preserving flow map with high accuracy .",
    "we refer readers to  @xcite for additional details .     on the input images .",
    "( c ) motion edges @xmath23 computed by applying an edge detector @xmath24 to the colorized flow .",
    "( d ) motion edges @xmath23 after alignment , non - maximum suppression , and aggressive thresholding .",
    "the aligned motion edge maps @xmath23 serve as a supervisory signal for training an edge detector . ]    * motion edge detection : * detecting motion edges given optical flow estimates can be challenging , see figure  [ fig : motion ] .",
    "weinzaepfel et al .",
    "@xcite showed that simply computing gradients over a flow map produces unsatisfactory results and instead proposed a data - driven approach for motion edge detection ( for a full review of earlier approaches see  @xcite ) . in this work",
    "we employ a simpler yet surprisingly effective approach .",
    "we use an edge detector trained on image edges for motion edge estimation by applying the ( image ) edge detector to a color - coded flow map . the standard color - coding scheme for optical flow maps 2d flow vectors into a 3d color space by encoding flow orientation via hue and magnitude via saturation  @xcite .",
    "motion edges become clearly visible in this encoding ( [ fig : motion]b ) . running an edge detector @xmath24 on the colored flow map",
    "gives us a simple mechanism for motion edge detection ( [ fig : motion]c ) .",
    "moreover , in our iterative scheme , as both our edge detector @xmath11 and flow estimate @xmath25 improve with each iteration @xmath2 , so do our resulting estimates of motion edges @xmath26 .",
    "* motion edge alignment : * motion edges computed from flow exhibit slight misalignment with their corresponding image edges .",
    "we found that this can adversely affect training , especially for he which produces thick edges . to align the motion edges",
    "we apply a simple heuristic : after applying non - maximum suppression and thresholding , we align the motion edges to superpixels detected in the color image .",
    "specifically , we utilize slic super - pixels  @xcite , which cover over 90% of all image edges , and greedily match motion and superpixel edge pixels ( using a tolerance of 3 pixels ) . matched motion edge pixels are shifted to the superpixel edge locations and unmatched motion edges are discarded .",
    "this refinement , illustrated in figure [ fig : motion]d , helps filter out edges with weak image gradients and improves localization .",
    "we emphasize that our goal is not to detect all motion edges .",
    "a subset with high precision is sufficient for training .",
    "given a large video corpus , high - precision motion edges should provide a dense coverage of image edges .",
    "however , due to our alignment procedure our sampling is slightly biased . in particular ,",
    "motion edges with weak corresponding image edges are often missing . this limitation and its impact on performance",
    "is discussed in section  [ sec : exps ] .",
    "* training @xmath24 : * the aligned motion edge maps @xmath27 serve as a supervisory signal for training an edge detector @xmath3 .",
    "positives are sampled at locations with high scoring motion edges in @xmath27 .",
    "negatives are uniformly sampled from location with motion edges below a small threshold .",
    "note that locations with ambiguous motion edge presence ( @xmath27 with intermediate scores ) are not considered in training .",
    "as we will demonstrated , samples harvested in this manner provide a strong supervisory signal for training @xmath24 .    * video dataset : * for training , we combine videos from two different datasets : the video segmentation benchmark ( vsb )  @xcite and the youtube object dataset  @xcite .",
    "we use all hd videos ( @xmath28 ) in both datasets .",
    "we drop all the annotations for youtube object dataset . our collection of videos ( @xmath29 ) contains more than @xmath30 frames and has sufficient diversity for training an edge detector .",
    "* frame filtering : * given the vast amount of available data , we apply a simple heuristic to select the most promising frames for motion estimation .",
    "we first fit a homography matrix between consecutive frames using orb descriptor matches  @xcite ( which are fast to compute ) .",
    "we then remove frames with insufficient matches , very slow motion ( max displacement @xmath312 pixels ) , very large motion ( average displacement @xmath3215 pixels ) , or a global translational motion .",
    "these heuristics remove frames where optical flow may be either unreliable or contain few motion edges . for all experiments we used this pruned set of @xmath33 frames .",
    "we experiment with the structured edge ( se )  @xcite and holistic edge ( he )  @xcite detectors , based on structured forests and deep networks , respectively .",
    "se has been used extensively due to its accuracy and speed , e.g.  for flow estimation  @xcite and object proposals  @xcite .",
    "he is more recent but achieves the best reported results to date .",
    "when trained using our unsupervised scheme , both methods approach similar performance as when trained with full supervision .",
    "* structured edges ( se ) : * se extracts low - level image features , such as color and gradient channels , to predict edges .",
    "the method learns decision trees by using structured labels ( patch edge maps ) to determine the split function at each node . during testing",
    ", each decision tree maps an input patch to a local edge map .",
    "the final image edge map is the average of multiple overlapped masks predicted by each tree at each location , leading to a robust and smooth result .",
    "we use the same parameters as in  @xcite for training .",
    "the forest has 8 trees with maximum depth of 64 .",
    "each tree is trained using a random subset ( 25% ) of @xmath34 patches , with equal number of positives and negatives . during training ,",
    "we convert a local edge map to a segmentation mask as required by se by computing connected components in the edge patch .",
    "we discard patches that contain edge fragments that do not span the whole patch ( which result in a single connected component ) . during each iteration of training",
    ", the forest is learned from scratch . during testing , we run se over multiple scales and with sharpening for best results .",
    "* holistic edges ( he ) : * he uses a modified vgg-16 network  @xcite with skip - layer connections and deep supervision  @xcite .",
    "our implementation generally follows  @xcite .",
    "we remove all fully connected layers and the last pooling layer resulting in an architecture with 13 conv and 5 max pooling layers .",
    "skip - layers are implemented by attaching linear classifiers ( @xmath35 convolutions ) to the last conv layer of each stage , their outputs are averaged to generate the final edge map . in our implementation",
    "we remove the deep supervision ( multiple loss functions attached to different layers ) as we found that a single loss function has little performance penalty ( @xmath36 vs @xmath37 in ods score ) but is easier to train .",
    "we experimented with both fine - tuning a network pre - trained on imagenet  @xcite and training a network from scratch ( random initialization ) . for fine - tuning",
    ", we use the same hyper - parameter as in  @xcite with learning rate @xmath38 , weight decay @xmath39 , momentum @xmath40 , and batchsize @xmath41 . when training from scratch , we add batch normalization  @xcite layers to the end of every conv block .",
    "this accelerates training and also improves convergence .",
    "we also increase learning rate @xmath42 and weight decay @xmath43 when training from scratch .",
    "we train the network for @xmath44 epochs in each iteration , then reduce learning rate by half .",
    "unlike for se , we can reuse the network from previous iterations as the starting point for each subsequent iteration .",
    "the somewhat noisy labels , in particular missing positive labels , prove to be challenging for training he .",
    "the issue is partially alleviated by discarding ambiguous samples during back propagation .",
    "furthermore , unlike in  @xcite , we randomly select negative samples ( @xmath45 as many negatives as positives ) and discard negatives with highest loss ( following the same motivation as in  @xcite ) . without these steps for dealing with noisy labels convergence",
    "our method produces motion edges @xmath27 , image edges @xmath46 , and optical flow @xmath25 at each iteration @xmath2 .",
    "we provide an extensive benchmark for each task tested with two different edge detectors ( se and he ) .",
    "our main results is that the image edge detectors , trained using videos only , achieve comparable results as when trained with full supervision . as a byproduct of our approach",
    "we also generate competitive optical flow and motion edge results .",
    "finally , we show that pre - training networks using video improves their performance on object detection over training from scratch .",
    ".motion edge results on the vsb benchmark .",
    "see text . [",
    "cols=\"<,^,^,^,^\",options=\"header \" , ]",
    "in this work , we proposed to harvest motion edges to learn an edge detector from video without explicit supervision .",
    "we developed an iterative process that alternated between updating optical flow using edge results , and learning an edge detector based on the flow fields , leading to increasingly accurate edges and flows .",
    "the main result of our paper is that edge detectors , trained using our unsupervised scheme , approach the same performance as when trained in a fully supervised manner .",
    "we additionally demonstrated our approach can serve a novel unsupervised pre - training scheme for deep networks . while the gains from pre - training were modest",
    ", we believe this is a promising direction for future exploration .",
    "in the long run we believe that unsupervised learning of edge detectors has the potential to outperform supervised training as the unsupervised approach has access to unlimited data .",
    "our work is the first serious step in this direction .",
    "we would like to thank saining xie for help with the he detector and ahmad humayun , yan zhu , and yuandong tian and many others for valuable discussions and feedback ."
  ],
  "abstract_text": [
    "<S> data - driven approaches for edge detection have proven effective and achieve top results on modern benchmarks . </S>",
    "<S> however , all current data - driven edge detectors require manual supervision for training in the form of hand - labeled region segments or object boundaries . specifically , human annotators mark semantically meaningful edges which are subsequently used for training . </S>",
    "<S> is this form of strong , high - level supervision actually necessary to learn to accurately detect edges ? in this work we present a simple yet effective approach for training edge detectors without human supervision . to this end </S>",
    "<S> we utilize motion , and more specifically , the only input to our method is noisy semi - dense matches between frames . </S>",
    "<S> we begin with only a rudimentary knowledge of edges ( in the form of image gradients ) , and alternate between improving motion estimation and edge detection in turn . using a large corpus of video data , </S>",
    "<S> we show that edge detectors trained using our unsupervised scheme approach the performance of the same methods trained with full supervision ( within 3 - 5% ) . </S>",
    "<S> finally , we show that when using a deep network for the edge detector , our approach provides a novel pre - training scheme for object detection . </S>"
  ]
}