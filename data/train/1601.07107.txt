{
  "article_text": [
    "in many problems , such as homogenization and long time behavior of first and second order hamilton - jacobi equations , weak kam theory , ergodic mean field games and dislocation dynamics , an essential step for the qualitative analysis of the problem is the computation of the effective hamiltonian .",
    "this function plays the role of an eigenvalue and in general it is unknown except in some very special cases .",
    "hence the importance of designing efficient algorithms for its computation , taking also into account that the evaluation at each single point of this function requires the solution of a nonlinear partial differential equation .",
    "moreover , the problem characterizing the effective hamiltonian is in many cases ill - posed .",
    "consider for example the cell problem for a first order hamilton - jacobi equation @xmath0 where @xmath1 , @xmath2 and @xmath3 is the unit @xmath4-dimensional torus .",
    "it involves , for any given @xmath5 , two unknowns @xmath6 in a single equation .",
    "moreover , despite the effective hamiltonian @xmath7 is uniquely identified by , the corresponding viscosity solution @xmath8 is in general not unique , not even for addition of constants .    in the recent years , several numerical schemes for the approximation of the effective hamiltonian have been proposed ( see @xcite,@xcite,@xcite,@xcite,@xcite,@xcite,@xcite ) , and they are mainly based on two different approaches .",
    "the first approach consists in the regularization of the cell problem via well - posed problems , such as the stationary problem @xmath9 for @xmath10 , or the evolutive one @xmath11 indeed , it can be proved that both @xmath12 and @xmath13 converge to @xmath14 , respectively for @xmath15 and @xmath16 ( see @xcite ) . in @xcite",
    ", these regularized problems are discretized by finite - difference schemes , obtaining respectively the so called small-@xmath17 and large-@xmath18 methods . in the limit for @xmath15 or @xmath16 , and",
    "simultaneously for the discretization step @xmath19 , one gets an approximation of @xmath14 ( the convergence of this method is proved in @xcite ) . hence the computation of an approximation of @xmath14 , for any fixed @xmath5 ,",
    "requires the solution of a sequence of nonlinear finite - difference systems , which become more and more ill - conditioned when @xmath17 is small or @xmath18 is large .",
    "it is worth noting that the idea of approaching ergodic problems via small-@xmath17 or large-@xmath18 methods has been applied to several other contexts , for example in mean field games theory @xcite , @xmath8-periodic homogenization problems @xcite and dislocation dynamics @xcite .",
    "the second approach for computing the effective hamiltonian is based on the following @xmath20-@xmath21 formula : @xmath22 in @xcite , this formula is discretized on a simplicial grid , by taking the infimum on the subset of piecewise affine functions and the supremum on the barycenters of the grid elements .",
    "the resulting discrete problem is then solved via standard minimax methods .",
    "an alternative method is suggested in @xcite , where it is shown that the solution of the euler - lagrange equation @xmath23 approximates , for @xmath24 , the infimum in the @xmath20-@xmath21 formula .",
    "a finite difference implementation of this method is presented in @xcite , for the special class of eikonal hamiltonians .",
    "+    in this paper we propose a new approach which allows to compute solutions of ergodic problems _ directly _ , i.e. , avoiding small-@xmath17 , large-@xmath18 or @xmath20-@xmath21 approximations .",
    "all these problems involve a couple of unknowns @xmath6 , possibly depending on some parameter , where @xmath8 is either a scalar or vector function and @xmath25 is a constant . after performing a discretization of the ergodic problem ( e.g. , using finite - difference schemes )",
    ", we collect all the unknowns @xmath26 of the discrete problem in a single vector @xmath27 of length @xmath28 and we recast the @xmath29 equations of the discrete system as functions of @xmath27 , for some @xmath30 . we get a nonlinear map @xmath31 and the discrete problem is equivalent to find @xmath32 such that @xmath33 where the system can be inconsistent , e.g. , _ underdetermined _ ( @xmath34 ) as for the cell problem , or",
    "_ overdetermined _ ( @xmath35 ) as for stationary mean field games ( see section [ meanfieldgames ] ) .",
    "note that this terminology is properly employed for linear systems , but it is commonly adopted also for nonlinear systems . in each case",
    ", can be solved by a generalized newton s method involving the moore - penrose pseudoinverse of the jacobian of @xmath36 ( see @xcite ) , and efficiently implemented via suitable @xmath37 factorizations .",
    "this approach has been experimented by the authors in the context of stationary mean field games on networks ( see @xcite ) and , to our knowledge , this is the first time a cell problem in homogenization of hamilton - jacobi equations is solved directly , by interpreting the effective hamiltonian as an unknown ( as it is ! ) .",
    "we realized that , once a consistent discretization of the hamiltonian is employed to correctly approximate viscosity solutions , all the job is reduced to computing zeros of nonlinear maps .",
    "moreover , despite the cell problem does not admit in general a unique viscosity solution , the ergodic constant defining the effective hamiltonian is often unique .",
    "this `` weak '' well - posedness of the problems , and also the fact that the effective hamiltonian is usually the main object of interest more than the viscosity solution itself , encouraged the development of the proposed method .",
    "the paper is organized as follows . in section [ newtonlike ]",
    "we introduce our approach for solving ergodic problems , and we present a newton - like method for inconsistent nonlinear systems , discussing some basic features and implementation issues . in the remaining sections ,",
    "we apply the new method to more and more complex ergodic problems , arising in very different contexts .",
    "more precisely , section [ eikonal ] is devoted to the eikonal hamiltonian , which is the benchmark for our algorithm , due to the availability of an explicit formula for the effective hamiltonian .",
    "section [ qnorms ] concerns more general convex hamiltonians , while section [ nonconvex ] is devoted to a nonconvex case and section [ 2ndorder ] to second order hamiltonians . in section [ wcs ]",
    "we solve some vector problems for weakly coupled systems , whereas section [ dislocations ] is devoted to a nonlocal problem arising in dislocation dynamics .",
    "finally , in section [ meanfieldgames ] we solve some stationary mean field games and in section [ multipopmfg ] an extension to the vector case with more competing populations .",
    "in this section we introduce a new numerical approach for solving ergodic problems arising in the homogenization of hamilton - jacobi equations",
    ". then we present a newton - like method for inconsistent nonlinear systems and we discuss some of its features , also from an implementation point of view .",
    "we assume that a generic continuous ergodic problem is defined on the torus @xmath3 and we denote by @xmath38 a numerical grid on @xmath3 .",
    "we also assume that the discretization scheme for the continuous problem results in a system of nonlinear equations of the form @xmath39 where    * @xmath40 is the discretization parameter ( @xmath41 is meant to tend to @xmath42 ) ; * @xmath43 is the point where the continuous problem is approximated ; * @xmath44 is a real valued mesh function on @xmath38 and @xmath45 is a real number , meant to approximate respectively the continuous solution @xmath8 of the ( possibly vector ) ergodic problem and the corresponding ergodic constant @xmath25 ; * @xmath46 represents a generic numerical scheme ; * @xmath28 and @xmath29 are respectively the length of the vector @xmath26 and the number of equations in .",
    "we remark that our aim is to efficiently solve the nonlinear system .",
    "therefore , we do not specify the type of grids or schemes employed in the discretization . in particular , we do not consider properties of the scheme itself , such as consistency , stability , monotonicity and , more important , the ability to correctly select approximations of viscosity solutions , assuming that they are included in the form of the operator @xmath46 .",
    "we just point out that , in our tests , we always perform finite difference discretizations on uniform grids . moreover , if not differently specified , we mainly employ the well known engquist - osher numerical approximation for the first order terms in the equations , due to its simple implementation . for instance , in dimension one , we use the following upwind approximation of the gradient : @xmath47    here , the only assumption on the discrete ergodic problem is the following : @xmath48 to compute a solution of , we collect the unknowns @xmath49 in a single vector @xmath27 of length @xmath28 and we recast the @xmath29 equations as functions of @xmath27 .",
    "hence we get the nonlinear map @xmath50 defined by @xmath51 , and is equivalent to the nonlinear system @xmath52 the system is said _ underdetermined _ if @xmath34 and _ overdetermined _ if @xmath53 . as already remarked , this terminology applies to linear systems , nevertheless it is commonly adopted , with a slight abuse , also in the nonlinear case .    assuming that @xmath36 is frchet differentiable",
    ", we consider the following generalized newton - like method @xcite : given @xmath54 , iterate up to convergence @xmath55 where @xmath56 is the jacobian of @xmath36 and @xmath57 denotes the moore - penrose _ pseudoinverse _ of @xmath58 . as in the case of square systems",
    ", we can rewrite in a form suitable for computations , i.e. , for @xmath59 @xmath60 where the solution of the system is meant , for arbitrary @xmath29 and @xmath28 , in the following generalized sense .",
    "+    ( @xcite ) the vector @xmath61 is the unique vector of smallest euclidean norm which minimizes the euclidean norm of the residual @xmath62 .     + it is easy to see that the generalized solution is given +    * for square systems ( @xmath63 ) by @xmath64 provided that the jacobian is invertible .",
    "+ * for overdetermined systems ( @xmath35 ) by the _ least - squares _",
    "solution @xmath65 provided that the jacobian has full column rank @xmath28 .",
    "+ * for underdetermined systems ( @xmath34 ) by the _ min euclidean norm least - squares _",
    "solution @xmath66 provided that the jacobian has full row rank @xmath29 .",
    "+    in each case , the generalized solution @xmath67 can be efficiently obtained avoiding the computation of the moore - penrose pseudoinverse .",
    "indeed , it suffices to perform a @xmath37 factorization of the jacobian @xmath68 in the overdetermined case ( or its transpose in the underdetermined case ) , i.e. , a factorization of the form @xmath69 in which @xmath70\\ ,   & \\text{is an $ m\\times m$ orthogonal matrix with $ q_1 $ of size $ m\\times n$,}\\\\ & \\text{$q_2 $ of size $ m\\times(m - n)$;}\\\\   r=\\left[\\begin{array}{c}r_1 \\\\ 0\\end{array}\\right ] \\ , & \\text{is an $ m\\times n$ matrix with $ r_1 $ upper triangular of size $ n\\times n$}\\\\ & \\text{and the null matrix of size $ ( m - n)\\times n$.}\\end{aligned}\\ ] ] more precisely : +    * in the square case , factoring @xmath69 , we get @xmath71 and therefore @xmath72 where the last step is readily computed by back substitution ; + * in the overdetermined case , factoring @xmath69 , we get by @xmath73 d+\\left[\\begin{array}{c }                     q_1^t \\\\",
    "q_2^t                    \\end{array }      \\right]f(x^k)\\right\\|_2 ^ 2\\\\[4pt ]      & = \\|q_2^t f(x^k)\\|_2 ^ 2+\\displaystyle\\arg\\min_{d\\in\\r^n}\\|r_1 d+q_1^t f(x^k)\\|_2 ^ 2\\end{aligned}\\ ] ] so that , minimizing the second term , we get @xmath74 which is computed again by back substitution . + * in the underdetermined case , factoring @xmath75 ( note that now @xmath29 and @xmath28 are exchanged ) , we have @xmath76 .",
    "moreover , setting @xmath77 we get @xmath78 since @xmath79 by the orthogonality of @xmath80 , we obtain the constraint @xmath81 it follows that we can minimize ( see ) @xmath82 just taking @xmath83 , and we conclude that @xmath84 where @xmath85 is computed by again via back substitution .",
    "+    from now on we will refer to the generalized solution for arbitrary @xmath29 and @xmath28 as to the _ least - squares _ solution .",
    "+ summarizing , we consider the following algorithm for the solution of : +   +   +    in the actual code implementation of the algorithm above , we employ several well known variants and modifications of the classical newton method , as discussed in the following remarks .",
    "+   + @xmath86 the convergence of newton - like methods is in general local . nevertheless in some cases , as in , if @xmath87 is convex and a proper discretization preserving this property is performed , the map @xmath36 in is also convex and therefore the convergence is global .",
    "moreover , in every example we consider ( except for multi - population mean field games , see section [ multipopmfg ] ) the ergodic constant is unique .",
    "+   + @xmath86 sometimes newton - like methods do not converge , due to oscillations around a minimum of the residual function @xmath88 .",
    "this situation can be successfully overcome by introducing a _ dumping parameter _ in the update step , i.e. , by replacing @xmath27 in the step @xmath89 of the algorithm with @xmath90 for some @xmath91 .",
    "usually a fixed value of @xmath92 works fine , possibly affecting the number of iterations to obtain convergence .",
    "a more efficient ( but costly ) selection of the dumping parameter can be implemented using _ line search _ methods , such as the _ inexact backtracking _ line search with _ armijo - goldstein condition_. especially when dealing with _",
    "_ residual functions , the newton step can be trapped into a local minimum . in this case a re - initialization of the dumping parameter to a bigger value can resolve the situation , acting as a thermalization in _ simulated annealing _ methods .",
    "+   + @xmath86 it may happen ( usually if the initial guess is @xmath93 ) that @xmath94 is nearly singular or rank deficient , so that the least - squares solution can not be computed . in this case , in the spirit of the _ levenberg - marquardt _ method or more in general quasi - newton methods",
    ", we can add a regularization term on the principal diagonal of the jacobian , by replacing @xmath94 with @xmath95 , where @xmath96 is a tunable parameter and @xmath97 denotes the identity ( not necessarily square ) matrix .",
    "this correction does not affect the solution , but it may slow down the convergence if @xmath98 is not chosen properly .",
    "this depends on the fact that the method reduces to a simple gradient descent if the term @xmath99 dominates @xmath94 . in our implementation , we switch - on the correction ( with a fixed @xmath98 ) only at the points @xmath27 where @xmath94 is nearly singular or rank deficient . in this way we can easily handle , for instance , second order problems with very small diffusion coefficients .",
    "+   + @xmath86 newton - like methods classically require the residual function to be frchet differentiable .",
    "nevertheless , this assumption can be weakened to include important cases , such as cell problems in which the hamiltonian is of the form @xmath100 with @xmath101 .",
    "note that the derivative in @xmath5 is given by @xmath102 , so that the jacobian in the corresponding newton step is not differentiable at the origin for @xmath103 .",
    "in this situation , in the spirit of nonsmooth - newton methods , we can replace the usual gradient with any element of the sub - gradient .",
    "typically we choose @xmath104 for @xmath105 .",
    "+   + @xmath86 it is interesting to observe that in the overdetermined case , the iterative method - coincides with the _ gauss - newton _ method for the optimization problem @xmath106 . indeed , defining @xmath107 , the classical newton method for the critical points of @xmath108",
    "is given by @xmath109 computing the gradient @xmath110 and the hessian @xmath111 of @xmath108 we have @xmath112 where the second order term is given by @xmath113 since the minimum of @xmath114 is zero , we expect that @xmath115 is small for @xmath116 close enough to a solution @xmath117 .",
    "hence we approximate @xmath118 , obtaining the gauss - newton method , involving only first order terms : @xmath119 applying again @xmath37 decomposition to @xmath68 we finally get the iterative method - , with @xmath17 given by the least - squares solution .",
    "this is the approach we followed for solving stationary mean field games on networks in @xcite . + throughout the next sections we present several ergodic problems , that can be set in our framework and solved by the proposed newton - like method for inconsistent systems .",
    "each section contains numerical tests in dimension one and/or two , including some experimental convergence analysis and also showing the performance of the proposed method , both in terms of accuracy and computational time .",
    "all tests were performed on a lenovo ultrabook x1 carbon , using 1 cpu intel quad - core i5 - 4300u 1.90ghz with 8 gb ram , running under the linux slackware 14.1 operating system .",
    "the algorithm is implemented in c and employs the library _ suitesparseqr _",
    "@xcite , which is designed to efficiently compute in parallel the @xmath37 factorization and the least - squares solution to very large and sparse linear systems .",
    "we start considering the simple case of the eikonal equation in dimension one , namely the cell problem @xmath120 where @xmath121 , @xmath1 and @xmath122 is a @xmath123periodic potential .",
    "this is a good benchmark for the proposed method , since a formula for the effective hamiltonian is available ( see @xcite ) : @xmath124 where @xmath125 .",
    "note that the effective hamiltonian @xmath126 has a plateau in the whole interval @xmath127 $ ] . with a slight abuse of notation , in what follows we will refer to this interval as to _ the _ plateau .",
    "following @xcite , in our first test we choose @xmath128 , for which @xmath129 and @xmath130 . as initial",
    "guess we always choose @xmath131 and we set to @xmath132 the tolerance for the stopping criterion of the algorithm .",
    "figure [ lambda - vs - iterations ] shows the computed @xmath133 as a function of the number of iterations to reach convergence .    [ cols=\"^,^ \" , ]",
    "we presented a new approach for the numerical solution of ergodic problems involving hamilton - jacobi equations .",
    "the proposed newton - like method for inconsistent nonlinear systems is able to solve first and second order nonlinear cell problems arising in very different contexts , e.g. , for scalar convex and nonconvex hamiltonians , weakly coupled systems , dislocation dynamics and mean field games , also in the case of more competing populations .",
    "a very large collection of numerical simulations shows the performance of the algorithm , including some experimental convergence analysis .",
    "we reported both numerical results and computational times , in order to allow future comparison .",
    "the authors would like to thank f.j .",
    "silva who , talking about mean fields games , pronounced the magic words `` gauss - newton method '' , and also m. cirant for fruitful discussions on the multi - population extension .",
    ", _ homogenization of first order equations with @xmath134-periodic hamiltonian : rate of convergence as @xmath135 and numerical approximation of the effective hamiltonian _ , math .",
    "models methods appl .",
    ", 21 ( 2011 ) , pp .",
    "13171353 .        , _ convergence of numerical methods and parameter dependence of min - plus eigenvalue problems , frenkel - kontorova models and homogenization of hamilton - jacobi equations _",
    ", math . model .",
    ", 35 ( 2001 ) , pp ."
  ],
  "abstract_text": [
    "<S> we propose a new approach to the numerical solution of ergodic problems arising in the homogenization of hamilton - jacobi ( hj ) equations . </S>",
    "<S> it is based on a newton - like method for solving inconsistent systems of nonlinear equations , coming from the discretization of the corresponding ergodic hj equations . </S>",
    "<S> we show that our method is able to solve efficiently cell problems in very general contexts , e.g. , for first and second order scalar convex and nonconvex hamiltonians , weakly coupled systems , dislocation dynamics and mean field games , also in the case of more competing populations . </S>",
    "<S> a large collection of numerical tests in dimension one and two shows the performance of the proposed method , both in terms of accuracy and computational time .    </S>",
    "<S> hamilton - jacobi equations , homogenization , effective hamiltonian , newton - like methods , inconsistent nonlinear systems , dislocation dynamics , mean field games .    35b27 , 35f21 , 49m15 . </S>"
  ]
}