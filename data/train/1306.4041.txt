{
  "article_text": [
    "in a rich variety of applications , prior knowledge is available on the shape of a surface , with examples including monotonicity , unimodality and convexity .",
    "incorporating such shape constraints can often substantially improve estimation efficiency and stability , while producing results consistent with prior knowledge .",
    "we propose two novel approaches based on gaussian process projections .",
    "gaussian processes are routinely applied but have the disadvantage of not allowing constraints .",
    "although we focus on monotone curves and surfaces , the approach can be applied directly in much broader settings including additive models , multivariate regression with monotonicity constraints only in certain directions , and other types of shape constraints .",
    "there is a rich frequentist literature on monotone curve and isotonic regression estimation , with a common approach minimizing a least squares loss subject to a restriction ( barlow et al .",
    "1972 , robertson et al . , 1988 ) .",
    "for more recent references , refer to @xcite and bhattacharya @xmath0 lin ( 2010 , 2011 ) .",
    "alternatively , restricted kernel ( @xcite , dette et al .",
    "( 2005 ) and mammen ( 1991 ) ) and spline ( ramsay ( 1988 ) and @xcite ) methods have been proposed .    from a bayesian perspective ,",
    "one specifies a prior on the regression function and inference is based on the posterior distribution .",
    "@xcite use an ordered dirichlet prior on a strictly monotone dose - response function .",
    "@xcite use an additive model with a prior imposed on the slope of the piecewise linear functions .",
    "shively et al .",
    "( 2009 ) and shively et al .",
    "( 2011 ) use restricted splines .",
    "@xcite adopt mixture modeling .",
    "although there is a rich existing literature on bayes monotone curve estimation , our work has two key motivations : ( 1 ) there is a lack of theory supporting these methods beyond consistency ; ( 2 ) current approaches involve basis expansions and challenges arise in multivariate cases .",
    "gaussian processes have a rich theoretical foundation , can easily incorporate prior information , and can be implemented routinely in multivariate settings .",
    "we define a class of projective gaussian processes which inherit these advantages .",
    "let @xmath1 denote the sample path of a ` mother ' gaussian process indexed on @xmath2 , with @xmath3 the mean function and @xmath4 the covariance kernel .",
    "let @xmath5 be a subset of the space of continuous functions mapping from @xmath6 to @xmath7 having some constraint .",
    "we define the projective gaussian process @xmath8 on the constrained space @xmath5 as @xmath9    let @xmath10^p$ ] denote the space of monotone functions on @xmath11^p$ ] . focusing initially on the @xmath12 case , has the solution @xmath13.\\ ] ] the existence and uniqueness of the projection follow from theorem 1 in rychlik ( 2001 ) .",
    "the projection in can be well approximated using the pooled adjacent violators algorithm ( barlow et al .",
    "( 1972 ) ) .",
    "some properties of the projection function include :    * @xmath14 if @xmath15 is a monotone function .",
    "therefore , @xmath8 is surjective . *",
    "@xmath16 if @xmath15 is a decreasing function where @xmath17 which is the slope of the line joining @xmath18 and @xmath19 .",
    "* @xmath20 is a continuous function given @xmath15 is continuous ( @xcite ) .",
    "hence , in projecting the gaussian process from @xmath21 $ ] to @xmath22 $ ] one induces a valid measure on the set of continuous monotone functions @xmath22 $ ] .",
    "the following lemma on the continuity of the projection as an operator is key to showing the projective gaussian process inherits concentration and approximation properties of the mother gaussian process .    [ lemma - projection ] let @xmath23 be continuous functions on [ 0,1 ] .",
    "then the following holds : @xmath24}|p_{w_1}(x)-p_{w_2}(x)|\\leq \\sup_{x \\in [ 0,1]}|w_1(x)-w_2(x)|.\\end{aligned}\\ ] ]    monotone curve estimation under the projective gaussian process is easily extended to monotone surface estimation . as an illustration , suppose that @xmath25 ^ 2 $ ] is a monotone continuous function on @xmath11 ^ 2 $ ] with respect to partial orderings , so that given @xmath26 and @xmath27 , @xmath28 . since @xmath22 ^ 2 $ ] is a closed convex cone , equation ( 1 ) can be solved to obtain @xmath8 from the sample path @xmath29 of a two - dimensional gaussian process .",
    "apply algorithm 1 to obtain the solution .",
    "+    given any fixed @xmath30 , @xmath31 is a function of @xmath32 and apply to obtain @xmath33 by projecting @xmath15 along the @xmath32 direction .",
    "letting @xmath34 , project @xmath35 onto @xmath22 $ ] with respect to the @xmath30 direction to obtain @xmath36 .",
    "let @xmath37 .",
    "letting @xmath38 , in the @xmath39th step we obtain @xmath40 by projecting @xmath41 along the @xmath32 direction for any @xmath30 and @xmath42 as the projection of @xmath43 along the @xmath30 direction for any @xmath32 .",
    "the algorithm terminates when @xmath40 or @xmath42 is monotone with respect to both @xmath32 and @xmath30 for some step @xmath39 .",
    "theorem 1 characterizes the solution to algorithm 1 .",
    "[ th - surfsol ] let @xmath44 be the projection of @xmath15 solving .",
    "then one has @xmath45 and @xmath46    theorem [ th - surfsol ] implies that higher dimensional projections can be obtained by sequentially projecting the adjusted @xmath15 along each of its directions .",
    "this approach can be trivially extended to @xmath47 dimensional problems with monotonicity constraints in one or more directions .",
    "we carry out bayesian inference under the projective gaussian process , focusing on estimation of the @xmath48-dimensional monotone function @xmath49 assuming the following model @xmath50 where @xmath51 and @xmath49 is monotone increasing under partial orderings in the sense that @xmath52 whenever @xmath53 . without loss of generality ,",
    "assume @xmath54 lies in the compact set @xmath11^p$ ] .",
    "the design of @xmath55 can be fixed or random where @xmath56 for some distribution @xmath57 .",
    "although we focus on gaussian residuals for simplicity , the methods can be automatically applied in general settings .",
    "we first define some notions of neighborhoods .",
    "let @xmath58 , @xmath59 denote the true value , and @xmath60 denote the prior on @xmath61 , which is expressed as @xmath62 , where @xmath63 and @xmath64 are independent priors on @xmath65 and @xmath66 respectively . as shorthand ,",
    "let @xmath67 denote the conditional density @xmath68 with @xmath69 the true conditional density . for random design , hellinger distances @xmath70",
    "are defined as @xmath71 with @xmath72 .",
    "we let @xmath73 denote an @xmath74 hellinger neighborhood around @xmath75 with respect to @xmath76 .",
    "the kullback - leibler divergence between @xmath61 and @xmath75 is @xmath77 an @xmath74 kullback - leibler neighborhood around @xmath75 is denoted by @xmath78 .",
    "we first use a projective gaussian process , @xmath79 , as a prior on the monotone regression function @xmath49 for @xmath80 $ ] .",
    "we assume the mother gaussian process @xmath81 is continuous , with @xmath82 $ ] the closure of the reproducing kernel hilbert space corresponding to @xmath83 .",
    "our proofs assume @xmath84 .",
    "the following theorems show posterior consistency and convergence rates under our projective gaussian process prior in the @xmath12 special case ; these theorems can be generalized to arbitrary @xmath48 .",
    "[ th - consist1 ] let @xmath85 be in the pre - image of @xmath86 so that @xmath87 .",
    "let @xmath63 be the projective gaussian process prior on @xmath22 $ ] .",
    "assume @xmath64 has a positive continuous density including @xmath88 in its support .",
    "then under a random design , for all @xmath89 , @xmath90 where @xmath91 is the complement of @xmath73 in @xmath22 $ ] .",
    "a similar consistency theorem holds for the case of fixed designs .",
    "[ th - consist2 ] we maintain the same conditions as in theorem [ th - consist1 ] . for the case of a fixed design ,",
    "the posterior under the projective gaussian process prior is consistent , that is , for all @xmath89 @xmath92 where @xmath73 is the average ( empirical ) hellinger neighborhood .",
    "for the rates theorem , we assume a fixed design and that @xmath93 follows a log - uniform prior @xmath94 on a compact interval @xmath95 $ ] including @xmath96 with @xmath97 . let @xmath98 denote the gaussian process concentration function defined in the appendix .",
    "[ th - rates1 ] let @xmath86 be the true monotone function and @xmath85 be any element in the pre - image of @xmath86 .",
    "let @xmath99 . if @xmath100 , @xmath101 and @xmath102 for some constants @xmath103 and @xmath104 , the posterior distribution of @xmath61 satisfies @xmath105 for @xmath106 large enough where @xmath107 is the empirical hellinger distance .",
    "let @xmath108 with squared exponential covariance kernel @xmath109 .",
    "define a scaled gaussian process @xmath110 . as an example",
    ", we consider the rate of contraction for the projection prior using @xmath111 with @xmath112 having a gamma prior as in van der vaart @xmath0 van zanten ( 2007 , 2009 ) .",
    "[ coro1 ] let @xmath113 with @xmath63 the projective gaussian process prior induced from the projection of @xmath111 .",
    "one has the following results on the convergence rate of the posterior .    * if the true monotone function @xmath114\\bigcap \\mathcal{m}[0,1]$ ] for some @xmath115",
    ", then the posterior converges at rate at least @xmath116 . *",
    "if @xmath117\\bigcap \\mathcal{m}[0,1]$ ] which is continuous but not differentiable , then the convergence rate is at least @xmath116(@xmath118 ) , if there exists @xmath119 $ ] such that @xmath120 .",
    "[ rem - norm ] if the covariates are random from @xmath57 , the rates hold with norm @xmath121^{1/2}+|\\sigma-\\sigma_0|$ ] .      in this section we propose an alternative approach that relies on projecting draws from the posterior under a gaussian process prior onto the space of monotone functions @xmath22^p$ ] .",
    "this approach is easy to implement and has excellent performance in applications we have considered .",
    "we first impose a gaussian process on @xmath65 and a prior @xmath64 on @xmath66 , and then project the posterior of @xmath65 onto @xmath22^p$ ] .",
    "this induces a probability measure on @xmath22^p$ ] based on which the inference is carried out .",
    "we denote by @xmath122 the induced distribution on @xmath123^p\\times ( 0,\\infty)$ ] .",
    "we first present the following theorem which shows the existence of a prior on @xmath124 whose posterior is @xmath122 .",
    "hence , our inference scheme fits in the bayesian paradigm .",
    "assume @xmath66 is compactly supported .",
    "given @xmath122 , a probability measure on @xmath124 obtained by projecting the posterior of a gaussian process onto @xmath22^p$ ] , there exists a prior @xmath125 on @xmath124 whose posterior is @xmath122 .",
    "let @xmath126^p$ ] be the true monotone function .",
    "let @xmath127 and @xmath128 . in proving the theory , we consider the random design with the covariates sampled from a distribution @xmath57 with distance @xmath129 the same as in remark [ rem - norm ] .",
    "theory is shown for the special case @xmath12 which can be generalized to arbitrary @xmath48 .",
    "since the covariates are from a distribution @xmath57 , we consider the projection of the function @xmath130 onto the monotone space by minimizing @xmath131 the solution to is given by @xmath132,\\ ] ] which is a weighted version of . in terms of implementing the projection",
    ", one can use the pooled adjacent violators algorithm with non - constant weights .",
    "the following lemma shows continuity of the projection .",
    "[ lemma - contragcm ] let @xmath133 and @xmath134 be two functions on [ 0,1 ] .",
    "then one has @xmath135 where @xmath136 .",
    "given the scaled gaussian process @xmath111 with @xmath112 from some gamma distribution , the convergence rates of @xmath137 with respect to @xmath138 are given as follows :    * if the true monotone function @xmath114\\bigcap \\mathcal{m}[0,1]$ ] , then the posterior converges at rate at least @xmath116 . * if @xmath86 is a flat function , so that @xmath139 for some constant @xmath140 , then the rate of convergence is at least @xmath141    our theory of projecting the posteriors applies naturally to the higher dimensional cases .",
    "we apply the approach proposed in  3@xmath1423 by projecting the posterior of a gaussian process .",
    "let @xmath143 with @xmath144 , where @xmath145 , @xmath146 and @xmath147 . in a first stage ,",
    "we run a markov chain monte carlo algorithm to obtain draws from the joint posterior of covariance parameters @xmath148 and the pre - projection curve evaluated at the data points @xmath149 . this can proceed using any of a wide variety of algorithms developed for gaussian process regression models ; we use vanhatalo et al .",
    "( 2012 , arxiv:1206.5754v1 ) .",
    "the number of markov chain monte carlo iterations is taken to be 5,000 with a burn in of 1,000 .",
    "after convergence , sample paths @xmath150 are then projected to the monotone space using the pooled adjacent violators algorithm .",
    "data of size @xmath151 are simulated from a normal error model with standard deviation @xmath152 .",
    "the true mean functions given below are proposed by @xcite and @xcite and are also used in a comparative study in @xcite .",
    "* @xmath153 , @xmath154 $ ] ( flat function ) . * @xmath155 , @xmath154 $ ] ( sinusoidal function ) .",
    "* @xmath156 if @xmath157 $ ] and @xmath158 if @xmath159 $ ] ( step function ) .",
    "* @xmath160 , @xmath154 $ ] ( linear function ) . * @xmath161 , @xmath154 $ ] ( exponential function ) . * @xmath162 , @xmath154 $ ] ( logistic function ) .",
    "the @xmath54 values are taken to be equidistant in the interval @xmath163 $ ] .",
    "the root mean squared error of the estimates is calculated in the simulation study for the gaussian process with and without projection , with the results shown in table 1 .",
    "the results presented in the following table are the average root mean squared error of 50 samples of data .",
    "we compare our results with the root mean squared error results of the regression spline provided in @xcite .",
    ".root mean square error for simulated data with @xmath151 and the results averaged across 50 simulation replicates in each case [ cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]     [ tfit ]     and its estimate.,title=\"fig:\",width=302 ]   and its estimate.,title=\"fig:\",width=302 ] [ figs1 ]     and its estimate.,title=\"fig:\",width=302 ]   and its estimate.,title=\"fig:\",width=302 ] [ figs2 ]    we illustrate the application to non - gaussian data through analyzing pneumoconiosis risk in mine workers ( @xcite ) . in epidemiology and toxicology studies , it is often of interest to assess joint risk as a function of multiple exposures , with risk increasing as dose of each exposure increases . under this assumption ,",
    "the probability of pneumoconiosis is a monotone function .",
    "the data were collected for coal miners who had been employed only as coal getters on the coal face and haulage workers in the underground roadways .",
    "the exposures are defined as the length of time spent at these two types of work , @xmath164 , with records obtained on whether each miner developed pneumoconiosis .",
    "we let @xmath165 which is the probability for a worker to develop pneumoconiosis under level @xmath30 , with @xmath65 a real - valued bivariate monotone function and @xmath166 the standard normal cumulative distribution function . we give @xmath65 a gaussian process prior as described in the simulation examples , with the draws from the posterior projected to the constrained space .    we apply our method in estimating the monotone surface of response probability .",
    "the dose - response surface is estimated by projecting @xmath167 where @xmath15 is the posterior sample path of of a gaussian process and @xmath166 is the probit link function .",
    "the likelihood is given by the binomial model instead of the normal model .",
    "the estimated dose - response surface and its corresponding 95@xmath168 pointwise credible intervals are plotted in figure [ figmine ] .",
    "credible intervals.,title=\"fig:\",width=302 ]   credible intervals.,title=\"fig:\",width=302 ] [ figmine ]",
    "let @xmath54 be any real number in @xmath169 $ ] .",
    "we see that @xmath170 for each @xmath171 , there exists an element @xmath172 such that @xmath173 and hence @xmath174 it follows from @xmath175 that @xmath176 note that @xmath177 for all @xmath178 . in particular , this implies that the inequality above holds for @xmath179 .",
    "hence we see from @xmath180 that @xmath181 for each @xmath182 , there exists an element @xmath183 such that @xmath184 since @xmath183 , we have @xmath185 thus it follows from @xmath186 that @xmath187}|w_1(t ) - w_2(t)| dt + \\epsilon + \\delta \\\\ & <",
    "\\sup_{t \\in [ 0,1]}|w_1(t ) - w_2(t)| + \\tau,\\end{aligned}\\ ] ] where @xmath188 , and @xmath74 and @xmath189 are arbitrarily positive numbers . therefore , for every @xmath190 and @xmath80 $ ] , we have @xmath191}|w_1(t ) - w_2(t)| + \\tau.\\end{aligned}\\ ] ] thus we see that latexmath:[\\ ] ] upon letting @xmath195 in the above inequality , the lemma follows .",
    "we first prove a lemma which is used in proving theorem [ th - surfsol ] .",
    "[ lem - apen ] let @xmath196 be the cone of continuous functions @xmath197 which are monotone with respect to @xmath32 for any @xmath30 and @xmath198 be the cone of continuous functions which are monotone with respect to @xmath30 for any @xmath32 .",
    "define their dual cones @xmath199 and @xmath200 as @xmath201 ^ 2 : \\int f(s , t)g(s , t)ds\\leq 0,\\;\\text{for all}\\ ; t \\;\\text{and}\\ ; f\\in c_s   \\right\\},\\ ] ] and @xmath202 ^ 2 : \\int f(s , t)g(s , t)dt\\leq 0,\\;\\text{for all}\\ ; s \\;\\text{and}\\ ; f\\in c_t   \\right\\}.\\ ] ] denote @xmath203 as the projection of @xmath15 over @xmath196 by minimizing @xmath204 for all @xmath205 and any fixed @xmath30 .",
    "denote @xmath206 as the projection of @xmath15 over @xmath198 by minimizing @xmath207 for all @xmath208 and any fixed @xmath32 .",
    "then @xmath209 furthermore , @xmath210 turns out to be the solution to the projection by minimizing @xmath211 over all @xmath205 and @xmath212 is the solution to the projection by minimizing @xmath211 over all @xmath213    first note that @xmath203 is obtained by minimizing @xmath204 for all @xmath205 and any fixed @xmath30 .",
    "then according to theorem 1 of @xcite , one has @xmath214 and @xmath215 by the properties of @xmath203 .",
    "the first property implies @xmath216 . for any @xmath217",
    ", one has @xmath218 .",
    "one can then deduce that @xmath219 with a similar argument , one can show that @xmath220 .    since @xmath221 for any fixed @xmath30 , then one has @xmath222",
    ". therefore , @xmath210 minimizes @xmath211 for all @xmath205 and @xmath212 minimizes @xmath211 for all @xmath208 by the same argument .    define the norm @xmath223^{1/2}$ ] with @xmath224 denoting the inner product .",
    "one has @xmath225 where the last equality follows from lemma a1 . here",
    "@xmath226 denotes the projection of @xmath227 onto @xmath196 and @xmath228 is the projection onto @xmath199 .",
    "therefore @xmath229 minimizes @xmath230 for all @xmath231 and @xmath232 minimizes @xmath233 for all @xmath234 .",
    "then one concludes that @xmath235 for all @xmath236 .",
    "therefore , one has @xmath237 .",
    "now we wish to show that @xmath238 and @xmath239 are bounded and that @xmath240 and @xmath241 as @xmath242 .",
    "assume that @xmath238 or @xmath239 is not bounded .",
    "take an arbitrary large number @xmath243 .",
    "then there exists an integer @xmath244 such that @xmath245 or @xmath246 .",
    "one then partitions @xmath11\\times [ 0,1]$ ] into @xmath247 squares of equal areas .",
    "the vertices of the squares are of the form @xmath248 , where @xmath249 and @xmath250 with @xmath251 and @xmath252 .",
    "let @xmath253 be the point such that @xmath245 or @xmath246 over the square between @xmath253 and @xmath254 for the first time with respect to the partial ordering .",
    "without loss of generality , assume @xmath245 .",
    "for @xmath255 , let @xmath256 be the monotone function such that @xmath257 for @xmath258 , @xmath259 for @xmath260 and @xmath256 is linearly interpolated between @xmath253 and @xmath254 .",
    "note that for any @xmath89 , one can also partition @xmath11\\times [ 0,1]$ ] finely enough such that @xmath261 and @xmath262 . by the properties of the dual cones and our construction of the function @xmath256 , one can partition @xmath11\\times [ 0,1]$ ] finely enough such that @xmath263 , which implies that @xmath264 in the square between @xmath253 and @xmath254 up to an arbitrary small number @xmath74 .",
    "since the norm of @xmath265 is bounded , it follows from the continuity of the estimates that @xmath266 up to an arbitrary small number @xmath74 over the square of @xmath253 . on the other hand , we know that @xmath267 , which contradicts the fact that @xmath266 and @xmath268 is the point such that @xmath245 or @xmath246 over the square between @xmath253 and @xmath254 for the first time .",
    "since @xmath238 and @xmath239 are bounded , then there exists convergent subsequences indexed by @xmath269 such that @xmath270 and @xmath271 .",
    "then one has for @xmath272 , @xmath273 denote the limit as @xmath274 one claims that @xmath275 is the projection of @xmath15 which is the solution to under the partial ordering constraint .",
    "first note that @xmath276 since @xmath277 and @xmath278 since @xmath279 .",
    "this implies that @xmath280 which says that @xmath275 is monotone with respect to the partial ordering on @xmath281 .",
    "now , @xmath282 let @xmath283 be any element in @xmath284 , one looks at @xmath285 then by theorem 1 in @xcite , @xmath275 is indeed the projection of @xmath15 .",
    "now we will show that @xmath286 and @xmath287 with which we can conclude that @xmath288 , @xmath289 and both @xmath290 and @xmath291 converge to @xmath275 .",
    "first by the projection property , one can show that @xmath292 therefore , @xmath293 and @xmath294 converge to the same limit .",
    "assume on the contrary that @xmath295 does not converge to zero .",
    "then over some lebesgue measure non - zero set @xmath296 , there exists @xmath89 such that for @xmath297 @xmath298 note that @xmath299 and the last term on the right hand side of the above equation is non - negative .",
    "therefore , one can conclude that @xmath300 by a similar argument , one has @xmath301 subtracting from , one has @xmath302 this implies that there exist @xmath303 large enough with @xmath304 finite such that @xmath294 can be made arbitrarily close to @xmath305 .",
    "however this contradicts and the fact that @xmath239 is bounded such that there exists constant @xmath140 such that @xmath306 for all @xmath39 , @xmath307 . by the same argument , one can show that @xmath287 .",
    "therefore , @xmath288 , @xmath289 which implies @xmath308 and @xmath309 .",
    "the inequality in the theorem can be shown combining lemma [ lemma - projection ] and the properties of the projection .",
    "we wish to find a probability @xmath137 , say , on the space @xmath124 ( thought of as a ` prior ' for @xmath310 , but which may depend on the data @xmath311 ) such that the projection of the posterior @xmath312 of a gaussian process is the posterior on @xmath124 with prior @xmath137 .",
    "let @xmath313 denote this probability .",
    "since the ( conditional ) density of the observations @xmath314 , given @xmath310 , is the joint normal density as before , say @xmath315 , one needs to have @xmath313 satisfy @xmath316    let @xmath317 which is well - defined since @xmath318 .",
    "first note that @xmath319 is a density on @xmath124 with respect to the measure @xmath320 since one can easily check that @xmath321 .",
    "define @xmath322 we will show that @xmath125 satisfies equation above which is equivalent to showing @xmath323 one has @xmath324 then our contention follows .",
    "lizhen lin thanks professor rabi bhattacharya for useful discussions .",
    "this work was supported by grant r01es017240 from the national institute of environmental health sciences ( niehs ) of the national institute of health .",
    "gelfand , a.e . & l. kuo ( 1991 ) .",
    "nonparametric bayesian bioassay including ordered polytomous response .",
    "_ biometrika _ * 78 * , 657666 .",
    "ghosal , s. & van der vaart , a.a .",
    "convergence rates of posterior distributions for noniid observations .",
    "_ * 35*(1 ) 192 - 223 ."
  ],
  "abstract_text": [
    "<S> shape constrained regression analysis has applications in dose - response modeling , environmental risk assessment , disease screening and many other areas . </S>",
    "<S> incorporating the shape constraints can improve estimation efficiency and avoid implausible results . </S>",
    "<S> we propose two novel methods focusing on bayesian monotone curve and surface estimation using gaussian process projections . </S>",
    "<S> the first projects samples from an unconstrained prior , while the second projects samples from the gaussian process posterior . </S>",
    "<S> theory is developed on continuity of the projection , posterior consistency and rates of contraction . </S>",
    "<S> the second approach is shown to have an empirical bayes justification and to lead to simple computation with good performance in finite samples . </S>",
    "<S> our projection approach can be applied in other constrained function estimation problems including in multivariate settings .    * keywords * : asymptotics ; bayesian nonparametrics ; isotonic regression ; projective gaussian process ; shape constraint . </S>"
  ]
}