{
  "article_text": [
    "our analysis of the expected reward in a finite qbd process is motivated by the problem of computing the expected amount of lost revenue in a _ map / ph/1/c _ queue over a finite time horizon @xmath0 $ ] , given its initial occupancy . since maps and ph distributions",
    "are the most general matrix extensions of poisson processes and exponential distributions , respectively , we can think of this problem as a matrix generalisation of the similar analysis for the @xmath1 model considered in chiera and taylor @xcite and the @xmath2 model in braunsteins , hautphenne and taylor @xcite . in these queueing models ,",
    "customers are lost when they arrive to find @xmath3 customers already present . assuming that each arriving customer brings a certain amount of revenue , we are interested in calculating the expected amount of revenue that the queue will lose over a finite time horizon @xmath0 $ ] , as well as exploring the limit of the rate of losing revenue in the asymptotic regime .    solving the expected lost revenue problem is important , for example ,",
    "if we wish to find a way of managing a system where a number of , possibly different , queues share a number of servers .",
    "if it is feasible to reallocate servers from one queue to another every @xmath4 time units , then a rational method for performing the allocation is for each queue to observe its occupancy at time 0 , calculate the expected revenue lost in time @xmath0 $ ] for a range of capacities , given its initial occupancy , and then to allocate the servers to minimise the total expected amount of lost revenue over @xmath0 $ ] . at time @xmath4",
    ", the calculation can be performed again , based upon the occupancies at that time and a reallocation performed if it is optimal to do so .",
    "the _ map / ph/1/c _ queue can be modelled as a finite qbd process with generator matrix @xmath5 , and levels @xmath6 corresponding to the possible queue lengths .",
    "if @xmath7 is a vector containing the expected revenue lost in @xmath0 $ ] conditional on the initial state ( level and phase ) of the system , then computing @xmath7 reduces to solving a special case of the time - dependent version of poisson s equation of the form @xmath8 where @xmath9 is a column vector of @xmath10 s , and @xmath11 is a column vector containing the reward ( loss ) per unit of time in each state of the system . since the _ map / ph/1/c _ system loses revenue only when it is at full capacity , the only non - zero entries of @xmath11 in our motivating example are those corresponding to level @xmath3 .    the solution of , given by @xmath12 where @xmath13 is the stationary vector of the qbd process and @xmath14 denotes the column vector of 1 s , involves the transient deviation matrix ,",
    "@xmath15 see @xcite .",
    "as @xmath16 , @xmath17 converges to the deviation matrix @xmath18 discussed in coolen - schrijner and van doorn @xcite , which corresponds to the group inverse of @xmath19 , and the expected lost revenue function has a linear asymptote , @xmath20    after providing more detail on the reward function @xmath7 associated with a qbd process in section 2 , we tackle the computation of @xmath7 in transient and asymptotic regimes , and the corresponding matrices @xmath17 and @xmath18 , using two different approaches , each having some advantages in comparison to the other . in the first approach , developed in section 3 , we assume that the qbd process is non null - recurrent , and we place ourselves in the general context where the reward vector @xmath11 is not restricted to any particular structure .",
    "we use systems of matrix difference equations to gain insight into the block - structure of the vector @xmath7 and of the matrices @xmath17 and @xmath18 .",
    "in addition , this method also provides us with the blocks of the matrix of the mean first passage times in the qbd process .",
    "we obtain simple expressions for the relevant quantities that highlight the role of the maximal capacity @xmath3 .",
    "we also derive limiting results when the maximal capacity increases to infinity .",
    "this approach is effective if one wants to focus on particular blocks of @xmath7 , @xmath17 and @xmath18 rather than on the full matrices , as is the case in our motivating example . in practice",
    ", it also avoids dealing with large matrices : the size of the matrices involved in the expressions is at most twice the size of the phase space of the qbd process , regardless the value of @xmath3 .",
    "the second approach , described in section 4 , relies on some elegant results from the perturbation theory of markov chains , and leads to a recursive formula expressing the full deviation matrices @xmath17 and @xmath18 for a given value of @xmath3 in terms of the corresponding matrices for a system with capacity @xmath21 .",
    "the two approaches complement each other and their use may depend on the context : the first method is algebraic because we solve matrix difference equations , but the solutions have a probabilistic interpretation , while the second method is probabilistic but leads to a solution with an algebraic flavour .",
    "in section 5 , we provide numerical illustrations , starting with our motivating _",
    "map / ph/1/c _ example which loses revenue only at full capacity , and moving on to look at a case where the reward function @xmath11 is non - zero for all levels of the system .",
    "we compare the computational complexity of the two approaches and show that there is always a threshold value of @xmath3 at which one method surpasses the other in terms of cpu time .",
    "let @xmath22 be an ergodic continuous - time markov chain on a finite state - space , with generator @xmath5 and stationary distribution @xmath13 .",
    "the _ deviation matrix _ of @xmath23 is the matrix @xmath24 whose components may be written as @xmath25,$ ] where @xmath26 is the expected time spent in state @xmath27 during the interval of time @xmath0 $ ] given that the initial state is @xmath28 , and @xmath29 is the same quantity but conditional on the initial state having the distribution @xmath13 ( see da silva soares and latouche @xcite ) .    the _ group inverse _ @xmath30 of a matrix @xmath31 , if it exists , is defined as the unique solution to @xmath32 , @xmath33 , and @xmath34 . from campbell and meyer (",
    "* theorem 8.5.5 ) , the group inverse @xmath35 of the infinitesimal generator @xmath5 of any finite markov chain is the unique solution of the two equations @xmath36 where @xmath37 $ ] .",
    "when it exists , the deviation matrix is related to the group inverse @xmath35 of @xmath5 by the relation @xmath38 if @xmath5 is irreducible , then @xmath18 is also the unique solution of the system @xmath39 see @xcite for more detail .",
    "in addition , @xmath18 also satisfies @xmath40    we see that @xmath41 , where @xmath17 is the transient deviation matrix defined by ( [ eq : dt ] ) .",
    "properties of the transient deviation matrix are discussed in @xcite .",
    "let @xmath42 be the expected cumulative time spent in state @xmath27 in the time interval @xmath0 $ ] , given that the process starts in state @xmath28 at time @xmath10 , and define the matrix @xmath43 .",
    "it follows that @xmath44 and @xmath45 has the linear asymptote @xmath46 if we associate a reward ( or loss ) @xmath47 per time unit when the markov chain @xmath23 occupies state @xmath27 , and define the vector @xmath48 , then the expected cumulative reward up to time @xmath4 , given that the chain starts in state @xmath28 , is given by @xmath49 so that the vector @xmath50 satisfies @xmath51 and @xmath7 has the linear asymptote @xmath52 observe that is the solution of a finite horizon version of poisson s equation , @xmath53with @xmath54 . in the laplace",
    "transform domain where , for @xmath55 , @xmath56 and become respectively @xmath57where @xmath58 is the laplace transform of the transient deviation matrix , given by @xmath59 another equivalent expression , obtained after some algebraic manipulations , is given by @xmath60    in this paper , we are interested in computing the expected reward function @xmath7 , and the associated deviation matrices @xmath17 and @xmath18 , for any @xmath61 , when the markov chain corresponds to a finite ( level - independent ) qbd process .",
    "such a process is a two - dimensional continuous - time markov chain @xmath62 , where the variable @xmath63 , taking values in @xmath64 , is called the _ level _ of the process at time @xmath4 , and the variable @xmath65 taking values in @xmath66 is called the _ phase _ of the process at time @xmath4 .",
    "the generator of the qbd process has a block - tridiagonal form given by @xmath67where the block matrices are of size @xmath68 .",
    "the vectors @xmath7 and @xmath11 corresponding to the qbd process are of length @xmath69 and can be structured into block sub - vectors @xmath70 and @xmath71 of length @xmath72 , for @xmath73 , corresponding to each level of the qbd process .",
    "the same block decomposition holds for the deviation matrices @xmath17 and @xmath18 , and we write @xmath74 ( @xmath75 respectively ) for the @xmath76th block of these matrices .",
    "the next two sections address the following questions :    * how do we use the structure of the qbd process to compute the blocks of @xmath77 , @xmath17 and @xmath18 ? * how do the deviation matrices @xmath17 and @xmath18 differ for two successive values of the capacity @xmath3 ?",
    "[ questiondeux ]",
    "in this section , we answer question _ ( i)_. we deal with the transient regime first , followed by the asymptotic regime .",
    "we analyse the transient behaviour of the expected reward function in the laplace transform domain . an explicit expression for @xmath78",
    "is given in but this expression does not give any insight in the structure of the blocks @xmath79 , which are conditional on the initial queue length , nor in the role of the maximum capacity @xmath3 in the solution .",
    "instead , we rewrite as a system of second - order matrix difference equations @xmath80where @xmath81 , and we focus on the computation of the blocks @xmath79 , for @xmath73 .    for any @xmath82 ,",
    "let @xmath83 be the minimal nonnegative solution to the matrix quadratic equation @xmath84 and let @xmath85 be the minimal nonnegative solution to @xmath86 the matrices @xmath83 and @xmath85 can be computed numerically using any of the linear or quadratic algorithms discussed in latouche and ramaswami @xcite . assuming that the process is not restricted by an upper boundary , for @xmath87 , the @xmath88 entry of the matrix @xmath83 contains the laplace transform @xmath89\\ ] ] where @xmath90 and @xmath91 denotes the indicator function .",
    "similarly , assuming that the process is not restricted by a lower boundary , the @xmath88 entry of the matrix @xmath92 contains the laplace transform @xmath93.\\ ] ] both @xmath83 and @xmath85 are sub - stochastic , and therefore have a spectral radius strictly less than 1 , as long as @xmath87 .",
    "the first passage probability matrices @xmath94 and @xmath95 correspond to @xmath96 and @xmath97 . when the unrestricted qbd process is transient , @xmath94 is sub - stochastic and @xmath95 is stochastic , and conversely , when the unrestricted qbd process is positive recurrent , @xmath94 is stochastic and @xmath95 is sub - stochastic . finally , we let @xmath98 which is well defined for any @xmath87 , and @xmath99 which is well defined in the non null - recurrent case .    in the sequel",
    ", we use the convention that an empty sum , such as @xmath100 or @xmath101 , is zero .",
    "[ solhomu]for any @xmath102 and @xmath103 , the general solution of the second - order matrix difference equation @xmath104 is given by @xmath105 where @xmath106 and @xmath107 are arbitrary vectors , and @xmath108    _ proof .",
    "_ first , using , and we can show that is a solution to for any arbitrary vectors @xmath109 . it remains to show that all solutions of can be expressed in the form of .",
    "observe that there exists a nonsingular matrix @xmath110 such that @xmath111with @xmath112,\\ ] ] where @xmath113 is a non - singular square matrix of order @xmath114 , and @xmath115 is a square matrix of order @xmath116 with @xmath117 and sp@xmath118 .",
    "for instance , we may choose @xmath110 such that @xmath119 is the jordan normal form of @xmath95 ; in this case , @xmath113 contains all the blocks for the non - zero eigenvalues of @xmath95 ( which lie within the unit circle ) , and @xmath115 contain all the blocks for the zero eigenvalues .",
    "the matrices @xmath110 and @xmath120 may be partitioned as @xmath121,\\qquad m^{-1}=\\left[\\begin{array}{c}e\\\\\\hline f\\end{array}\\right],\\ ] ] where @xmath122 has dimension @xmath123 , @xmath124 has dimension @xmath125 , and @xmath126 , @xmath127 .",
    "lemma 10 in bini _ et al . _",
    "@xcite states that the general solution of is given , for @xmath128 , by @xmath129 where @xmath130 and @xmath131 are arbitrary vectors , and @xmath132 with @xmath133and @xmath134 the smallest integer such that @xmath135 ( @xmath136 if @xmath95 is invertible ) .",
    "since the eigenvalues of @xmath113 lie within the unit circle , the negative powers of @xmath113 appearing in and have entries that can take unbounded values , which can lead to numerical instabilities .",
    "next , we rewrite in a more convenient form in order to get rid of any negative power of @xmath113 .",
    "first observe that is equivalent to @xmath137where the negative powers of @xmath113 appear in the term @xmath138 letting @xmath139 , where @xmath140 is an arbitrary vector , we obtain @xmath141 let us fix a vector @xmath142 .",
    "then , for any @xmath143 , @xmath144 can be equivalently written as @xmath145 with @xmath146 . indeed , @xmath147lv^{-c}{\\boldsymbol{y}}\\\\&=&l v^{c - k}v^{-c}{\\boldsymbol{y}}\\\\&=&l v^{-k}{\\boldsymbol{y}}.   \\end{aligned}\\]]therefore , we have @xmath148 and the general solution takes the form @xmath149 where @xmath150finally , note that @xmath151 is defined for @xmath152 only , so we can set @xmath153 for any @xmath154 . with this , we have @xmath155which shows that any solution to can be written in the form . @xmath156",
    "the advantage of the solution over the solution from @xcite is that it does not require any spectral decomposition of the matrix @xmath95 , nor any matrix inversion ( as long as @xmath157 ) . since the spectral radii of @xmath94 and @xmath95",
    "are bounded by 1 , all matrix powers involved in are bounded , and the computation of the solution is therefore numerically stable .",
    "lemma [ solhomu ] naturally extends to the laplace transform domain , as stated in the next corollary .",
    "[ gensolr ] for any @xmath87 , @xmath102 , and @xmath158 , the general solution of the second - order matrix difference equation @xmath159 is given by @xmath160 where @xmath161 and @xmath162 are arbitrary vectors , and @xmath163 @xmath156    we use corollary [ gensolr ] to obtain a closed - form expression for @xmath79 in terms of the matrices @xmath83 and @xmath85 of the qbd process .    [ prop26 ] for any @xmath87 , @xmath102 , and @xmath73 , the laplace transform of the expected reward function , conditional on the initial level @xmath164 , is given by @xmath165 where @xmath166 is given by , and @xmath167=(-z(s , c))^{-1}\\left[\\begin{array}{c}{\\boldsymbol{g}}_0(s)+(b_0-si)\\,{\\boldsymbol{\\nu}}_0(s)+a_1\\,{\\boldsymbol{\\nu}}_1(s)\\\\{\\boldsymbol{g}}_c(s)+a_{-1}\\,{\\boldsymbol{\\nu}}_{c-1}(s)+(c_0-si)\\,{\\boldsymbol{\\nu}}_c(s)\\end{array}\\right]\\]]with @xmath168.}\\qquad\\]]in addition , @xmath169 can be written as@xmath170,\\ ] ] where @xmath171 is the generator of the transient markov chain obtained from the qbd process in which absorption can happen from any state at rate @xmath87 , and restricted to levels 0 and @xmath3 .",
    "_ we apply corollary [ gensolr ] to and obtain that the general solution of the second - order difference equation is given by for @xmath172 .",
    "we then specify the arbitrary vectors @xmath173 and @xmath174 using the boundary conditions and . injecting the general solution into and leads to the system of equations @xmath175 which can be rewritten as @xmath176=-\\left[\\begin{array}{c}{\\boldsymbol{g}}_0(s)+(b_0-si)\\,{\\boldsymbol{\\nu}}_0(s)+a_1\\,{\\boldsymbol{\\nu}}_1(s)\\\\{\\boldsymbol{g}}_c(s)+a_{-1}\\,{\\boldsymbol{\\nu}}_{c-1}(s)+(c_0-si)\\,{\\boldsymbol{\\nu}}_c(s)\\end{array}\\right],\\]]where @xmath169 is given by . to prove that the matrix @xmath169 is invertible , we now show that it can be written as the matrix product @xmath177,\\]]where @xmath171 is the generator of the transient markov chain obtained from the qbd process in which absorption can happen from any state at rate @xmath87 , restricted to levels 0 and @xmath3 , and is therefore invertible , and the matrix inverse @xmath178^{-1}\\ ] ] exists because sp@xmath179 and sp@xmath180 for any @xmath87 .",
    "the generator @xmath171 of the transient markov chain in which absorption can happen from any state at rate @xmath87 , restricted to levels 0 and @xmath3 , can be written as @xmath181 with @xmath182,\\quad \\mathcal{b}=\\left[\\begin{array}{cccc } a_1 & 0&\\ldots&0\\\\0&\\ldots & 0 & a_{-1}\\end{array}\\right],\\ ] ] @xmath183,\\quad \\mathcal{d}=\\left[\\begin{array}{cc } a_{-1 } & 0\\\\0&\\vdots \\\\\\vdots&0\\\\0 & a_1\\end{array}\\right].\\ ] ] we then have @xmath184}\\\\&=&\\mathcal{a}(s)\\left[\\begin{array}{cc } i & \\hat{g}(s)^{c } \\\\g(s)^{c}&i \\end{array}\\right]+\\mathcal{b } ( -\\mathcal{c}(s))^{-1 } \\mathcal{d } \\left[\\begin{array}{cc } i & \\hat{g}(s)^{c } \\\\g(s)^{c}&i \\end{array}\\right],\\end{aligned}\\ ] ] and to show that this is equal to @xmath169 given by , it suffices to show that @xmath185= \\left[\\begin{array}{cc } a_1 g(s ) & a_1\\hat{g}(s)^{c-1 } \\\\a_{-1}g(s)^{c-1}&a_{-1}\\hat{g}(s ) \\end{array}\\right].\\ ] ] observe that @xmath186=\\left[\\begin{array}{cc } a_{-1 } & a_{-1 } \\hat{g}(s)^c\\\\0&0\\\\\\vdots&\\vdots \\\\0&0\\\\a_1 g(s)^c & a_1\\end{array}\\right]=-\\mathcal{c}(s)\\left[\\begin{array}{cc } g(s ) & \\hat{g}(s)^{c-1 } \\\\",
    "g(s)^2 & \\hat{g}(s)^{c-2 } \\\\\\vdots&\\vdots\\\\g(s)^{c-2 } & \\hat{g}(s)^2\\\\ g(s)^{c-1 } & \\hat{g}(s)\\end{array}\\right]}\\]]where we have used and .",
    "this directly leads to @xmath187=\\left[\\begin{array}{cc } g(s ) & \\hat{g}(s)^{c-1 } \\\\",
    "g(s)^2 & \\hat{g}(s)^{c-2 } \\\\\\vdots&\\vdots\\\\ g(s)^{c-1 } & \\hat{g}(s)\\end{array}\\right],\\]]which , pre - multiplied by the matrix @xmath188 , provides .",
    "@xmath156    observe that the expression ( [ sol2 ] ) for @xmath189 involves matrices of at most twice the size of the phase space ( such as @xmath169 ) .",
    "the function @xmath70 is obtained by taking the inverse laplace transform of @xmath189 , which can be done numerically using the method of abate and whitt @xcite and the function @xmath190 in matlab .    the next corollary provides us with the limit as @xmath191 of the result stated in proposition [ prop26 ] .",
    "it is a direct consequence of the fact that the matrices @xmath83 and @xmath192 are sub - stochastic for any @xmath87 .",
    "[ cor_prop26 ] assume that the series @xmath193 converges for any @xmath194 . then , for any @xmath87 , and @xmath194 , the limit as @xmath191 of the laplace transform of the expected reward function , conditional on the initial level @xmath164 , is given by @xmath195 where @xmath196and @xmath197@xmath156    note that we can write @xmath198    in addition to the blocks @xmath189 of the expected reward function , proposition [ prop26 ] provides us with an explicit expression for the blocks @xmath199 of the laplace transform of the transient deviation matrix , as we show now .",
    "[ proptdev ] for @xmath73 ,    * if @xmath200 , + @xmath201 with @xmath202=(-s\\,z(s , c))^{-1}\\left[\\begin{array}{c } i\\\\0\\end{array}\\right],\\ ] ] * if @xmath203 , @xmath204 with @xmath202=(-s\\,z(s , c))^{-1}\\left[\\begin{array}{c}(b_0-si ) \\hat{g}(s)^\\ell + a_1\\hat{g}(s)^{\\ell-1}\\\\a_{-1}g(s)^{c-1-\\ell}+(c_0-si)g(s)^{c-\\ell}\\end{array}\\right],\\ ] ] * if @xmath205 , @xmath206 with @xmath202=(-s\\,z(s , c))^{-1}\\left[\\begin{array}{c}(b_0-si ) \\hat{g}(s)^c+a_1 \\hat{g}(s)^{c-1 } \\\\(c_0-a_0)-a_1 g(s)\\end{array}\\right],\\ ] ]    where @xmath169 is given by .",
    "_ we use and proposition [ prop26 ] with , for @xmath152 and @xmath207 , @xmath208 and @xmath209 for @xmath210 . @xmath156    the limit as @xmath191 of proposition [ proptdev ] again follows easily , and provides us with an analytical expression for the blocks of the infinite matrix @xmath58 corresponding to a qbd with no upper bound on the levels .    for @xmath194 ,    * if @xmath200 , @xmath211 * if @xmath212 , @xmath213 with @xmath214@xmath156      next , we concentrate on the asymptotic properties of the expected reward function @xmath215 for large values of @xmath4 . by decomposing into blocks",
    ", we have @xmath216 we determine now an explicit expression for the blocks @xmath217 of the deviation matrix for @xmath218 , together with the mean first passage times to any level @xmath219 in the qbd process .",
    "our method is based on the relationship between the entries of the deviation matrix and mean first passage times , and involves the solution of finite systems of matrix difference equations similar to the ones we solved in section [ tr ] .",
    "indeed , we can write @xmath220,\\ ] ] where @xmath221 is the mean first entrance time to @xmath222 from @xmath223 , and @xmath224 is the mean first entrance time to @xmath222 if the state at time 0 has the stationary distribution @xmath13 .",
    "define the block - matrices @xmath225 , for @xmath218 . in matrix form",
    ", we have @xmath226\\mbox{diag}({\\boldsymbol{\\pi}}_\\ell).\\ ] ]    let us fix level @xmath219 and define @xmath227 , the @xmath27th column of @xmath228 , for @xmath229 and @xmath73 .",
    "so @xmath230 .",
    "since the diagonal of @xmath231 is null we must have @xmath232 .",
    "we introduce the notation @xmath233 and @xmath234 for the matrices obtained by replacing the @xmath27th row in @xmath235 and @xmath236 , respectively , by @xmath237 , and @xmath238 , @xmath239 , @xmath240 for the matrices obtained by replacing the @xmath27th row in @xmath241 , @xmath242 and @xmath243 , respectively , by @xmath244 .",
    "[ mj ] for any fixed level @xmath152 and any phase @xmath229 , the vectors @xmath245 satisfy the system of matrix second - order difference equations @xmath246 for @xmath247 and @xmath248 , with the following boundary conditions , depending on the value of @xmath219 :    * for @xmath200 , @xmath249 * for @xmath203 , @xmath250 * for @xmath205 , @xmath251    _ proof .",
    "_ for a fixed value of @xmath219 , let @xmath252 , for @xmath207 . by conditioning on the epoch where the process first leaves the state @xmath223 , we obtain for @xmath172 , @xmath248 , and @xmath229 , @xmath253which in matrix form gives .",
    "a similar argument leads to the boundary equations , , , and .",
    "finally , the boundary equations , , and are obtained by adding the constraint that when @xmath254 , @xmath255 .",
    "@xmath156    for @xmath73 , define the vectors @xmath256 the next theorem provides an explicit expression for the columns of the mean first passage time matrices @xmath228 .",
    "[ prop2 ] in the non null - recurrent case , for any @xmath73 , the vector @xmath245 has the following explicit expression , depending on the value of @xmath219 :    * if @xmath200 , @xmath257 where @xmath258 is given by and @xmath259=(-z^{(j)}(c))^{-1}\\left[\\begin{array}{c}{\\boldsymbol{1}}-{\\boldsymbol{e}}_j+\\bar{b}_0^{(j ) } { \\boldsymbol{\\mu}}_0(c ) + \\bar{a}_1^{(j)}{\\boldsymbol{\\mu}}_1(c)\\\\{\\boldsymbol{1}}+{a}_{-1}{\\boldsymbol{\\mu}}_{c-1}(c)+{c}_{0}{\\boldsymbol{\\mu}}_c(c)\\end{array}\\right]\\]]with @xmath260\\\\&=&\\mathring{q}^{(j)}(c ) \\left[\\begin{array}{cc } i & \\hat{g}^{c } \\\\g^{c}&i \\end{array}\\right],\\end{aligned}\\]]where @xmath261 is the generator of the transient markov chain obtained from the qbd process in which absorption can happen from state @xmath262 at rate @xmath263 , and restricted to levels 0 and @xmath3 . * if @xmath264 , @xmath265 where @xmath258 is given by and @xmath266=(-z^{(j)}(\\ell , c))^{-1}\\left[\\begin{array}{c}{\\boldsymbol{1}}+b_0 { \\boldsymbol{\\mu}}_0(c ) + a_1{\\boldsymbol{\\mu}}_1(c)\\\\{\\boldsymbol{1}}-{\\boldsymbol{e}}_j+\\bar{a}_{-1}^{(j)}{\\boldsymbol{\\mu}}_{\\ell-1}(c)+\\bar{a}_{0}^{(j)}{\\boldsymbol{\\mu}}_\\ell(c)+\\bar{a}_{1}^{(j)}{\\boldsymbol{\\mu}}_{\\ell+1}(c)\\\\{\\boldsymbol{1}}+a_{-1}{\\boldsymbol{\\mu}}_{\\ell}(c)+a_0{\\boldsymbol{\\mu}}_{\\ell+1}(c)+a_{1}{\\boldsymbol{\\mu}}_{\\ell+2}(c)\\\\ { \\boldsymbol{1}}+ a_{-1}{\\boldsymbol{\\mu}}_{c-1}(c)+c_0{\\boldsymbol{\\mu}}_c(c)\\end{array}\\right]}\\]]with @xmath267}\\\\\\normalsize & = & \\mathring{q}^{(j)}(\\ell , c)\\left[\\begin{array}{cccc } i & \\hat{g}^{\\ell } & 0 & 0 \\\\g^{\\ell}&i & 0 & 0\\\\0 & 0 & i & \\hat{g}^{c-\\ell-1}\\\\ 0&0&g^{c-\\ell-1 } & i \\end{array}\\right],\\end{aligned}\\ ] ] where @xmath268 is the generator of the transient markov chain obtained from the qbd process in which absorption can happen from state @xmath222 at rate @xmath263 , and restricted to levels 0 , @xmath219 , @xmath269 , and @xmath3 . * if @xmath270 , @xmath271 where @xmath258 is given by and @xmath272=(-z^{(j)}(c))^{-1}\\left[\\begin{array}{c}{\\boldsymbol{1}}+b_0 { \\boldsymbol{\\mu}}_0 ( c)+ a_1{\\boldsymbol{\\mu}}_1(c)\\\\{\\boldsymbol{1}}-{\\boldsymbol{e}}_j+\\bar{a}_{-1}^{(j)}{\\boldsymbol{\\mu}}_{c-2}(c)+\\bar{a}_{0}^{(j)}{\\boldsymbol{\\mu}}_{c-1}(c)+\\bar{a}_{1}^{(j)}{\\boldsymbol{\\mu}}_{c}(c)\\\\{\\boldsymbol{1}}+a_{-1}{\\boldsymbol{\\mu}}_{c-1}(c)+c_0{\\boldsymbol{\\mu}}_{c}(c)\\end{array}\\right]}\\]]with @xmath273\\\\&=&\\mathring{q}^{(j)}(c ) \\left[\\begin{array}{ccc } i & \\hat{g}^{c-1 } & 0 \\\\g^{c-1}&i & 0\\\\0&0 & i \\end{array}\\right],\\end{aligned}\\]]where @xmath261 is the generator of the transient markov chain obtained from the qbd process in which absorption can happen from state @xmath274 at rate @xmath263 , and restricted to levels 0 , @xmath21 and @xmath3 . * if @xmath205 , @xmath275 where @xmath258 is given by and @xmath259=(-z^{(j)}(c))^{-1}\\left[\\begin{array}{c}{\\boldsymbol{1}}+b_0 { \\boldsymbol{\\mu}}_0(c ) + a_1{\\boldsymbol{\\mu}}_1(c)\\\\{\\boldsymbol{1}}-{\\boldsymbol{e}}_j+\\bar{a}_{-1}^{(j)}{\\boldsymbol{\\mu}}_{c-1}(c)+\\bar{c}_{0}^{(j)}{\\boldsymbol{\\mu}}_c(c)\\end{array}\\right]\\]]with @xmath276\\\\&=&\\mathring{q}^{(j)}(c ) \\left[\\begin{array}{cc } i & \\hat{g}^{c } \\\\g^{c}&i \\end{array}\\right],\\end{aligned}\\]]where @xmath261 is the generator of the transient markov chain obtained from the qbd process in which absorption can happen from state @xmath277 at rate @xmath263 , and restricted to levels 0 and @xmath3 .    _ proof . _",
    "the result follows from lemma [ solhomu ] applied to the system of difference equations .",
    "the arbitrary vectors are then determined using the boundary conditions given in proposition [ mj ] .",
    "when @xmath200 and @xmath205 , there are two boundary equations , determining two arbitrary vectors .    when @xmath278 , the solution depends on whether @xmath279 or @xmath280 .",
    "there are four boundary conditions , namely the three equations described in proposition [ mj ] , in addition to one boundary equation obtained by taking @xmath281 in .",
    "this determines the four arbitrary vectors .    when @xmath270 the solution depends on whether @xmath282 or @xmath283 .",
    "there are three boundary equations , as described in proposition [ mj ] , which determine the three arbitrary vectors .",
    "the decomposition of the matrices @xmath284 and @xmath285 into the product of a non - conservative generator and the matrices involving @xmath94 and @xmath95 follows from the same arguments as those used in the proof of proposition [ prop26 ] . absorption from state @xmath222 at rate 1 comes from the definition of @xmath238 , @xmath239 , and @xmath286 .",
    "the matrices involving @xmath94 and @xmath95 are invertible because sp@xmath287 or sp@xmath288 in the non null - recurrent case .",
    "@xmath156    observe that in the transient case the series @xmath289 diverges , and the limit as @xmath191 of @xmath258 given in is infinite , while in the positive recurrent case , @xmath290 this leads to the following corollary to proposition [ prop2 ] for the mean first passage times in an unrestricted positive recurrent qbd process :    in the positive recurrent case , for any @xmath194 , depending on the value of @xmath219 , the vector @xmath245 has the explicit expression :    * if @xmath200 , @xmath291 where @xmath292 is given by , and @xmath293 * if @xmath212 , @xmath294 where @xmath292 is given by and @xmath295=(-w^{(j)}(\\ell))^{-1}\\left[\\begin{array}{c}{\\boldsymbol{1}}+b_0 { \\boldsymbol{\\mu}}_0(\\infty ) + a_1{\\boldsymbol{\\mu}}_1(\\infty)\\\\{\\boldsymbol{1}}-{\\boldsymbol{e}}_j+\\bar{a}_{-1}^{(j)}{\\boldsymbol{\\mu}}_{\\ell-1}(\\infty)+\\bar{a}_{0}^{(j)}{\\boldsymbol{\\mu}}_\\ell(\\infty)+\\bar{a}_{1}^{(j)}{\\boldsymbol{\\mu}}_{\\ell+1}(\\infty)\\\\{\\boldsymbol{1}}+a_{-1}{\\boldsymbol{\\mu}}_{\\ell}(\\infty)+a_0{\\boldsymbol{\\mu}}_{\\ell+1}(\\infty)+a_{1}{\\boldsymbol{\\mu}}_{\\ell+2}(\\infty)\\end{array}\\right]}\\]]with @xmath296.\\end{aligned}\\ ] ]    @xmath156    to complete the characterisation of the block matrices @xmath217 using , it remains for us to compute the blocks @xmath297 of the stationary distribution of the qbd process for @xmath298 .",
    "this can be done following theorem 10.3.2 in @xcite or hajek @xcite , adapted to the continuous - time setting .",
    "this involves the matrices @xmath299 and @xmath300 of rates of sojourn in level @xmath301 , respectively @xmath302 , per unit of the local time in level @xmath164 in the corresponding unrestricted qbd process .",
    "these matrices can be expressed in terms of @xmath94 and @xmath95 as @xmath303 and @xmath304 , see @xcite .    in the non null - recurrent case ,",
    "the stationary distribution of the qbd process with transition matrix is given by @xmath305 where @xmath306 is the solution of the system @xmath307={\\boldsymbol{0}},\\ ] ] and @xmath308",
    "in this section , we answer question _ ( ii ) _ on page   and we provide an expression for the deviation matrix of a qbd with maximal level @xmath3 in terms of the deviation matrix of the same qbd with capacity @xmath21 , in transient and asymptotic regimes . to highlight the number of levels in the qbds",
    ", we shall denote by @xmath309 the generator of a qbd with maximum level @xmath3 , and by @xmath310 , @xmath311 , and @xmath312 the corresponding deviation matrices , for @xmath102 .",
    "the key idea behind the derivation of the recursions is the decomposition of the generator @xmath309 into a sum of another generator and a perturbation matrix , so that @xmath309 can be seen as a block - element updating problem , the block version of the element - updating problem described in langville and meyer @xcite .",
    "precisely , we write @xmath313 where @xmath314,\\\\e_{c-1}^{(c ) } & = & \\left[\\begin{array}{ccccc } 0 & \\cdots & 0 & i & 0\\end{array}\\right]^{\\top},\\nonumber \\\\\\label{eq : delta } \\delta^{(c)}&= & [ \\begin{array}{cccccc } 0 & \\cdots & 0 &   & a_{0}-c_{0 } & a_{1}\\end{array}],\\end{aligned}\\]]where @xmath315 has dimensions @xmath316 and @xmath317 has dimensions @xmath318 . observe that @xmath319 is the generator of a reducible transient structured markov chain , and its stationary distribution is given by @xmath320,\\ ] ] where @xmath321 is the stationary distribution of @xmath322 .",
    "the group inverse of @xmath323 exists by ( * ? ? ?",
    "* theorem 8.5.5 ) , and may be expressed as a function of @xmath321 and the deviation matrix @xmath324 , as shown in the next lemma .    [ devtc]the group inverse of @xmath323 is given by @xmath325,\\label{eq : qsharpetilde}\\]]where @xmath326 is an @xmath327 matrix defined as @xmath328 .",
    "\\label{vectm}\\ ] ]    _ proof .",
    "_ we check that @xmath329 is the group inverse of @xmath323 by direct verification of ( [ cesaro ] , [ cesaro2]).@xmath156    first , we use the decomposition to derive an expression for @xmath330 in terms of @xmath321 .    [ pirec ] the stationary distribution of @xmath309 may be expressed in terms of the stationary distribution of @xmath322 as @xmath331(i+e_{c-1}^{(c)}\\delta^{(c ) } ( t^{(c)})^{\\#})^{-1}.\\ ] ]    _ proof . _",
    "our argument is a slight modification of the proof of rising ( * ? ? ?",
    "* lemma 5.1 ) , which deals with irreducible markov matrices .",
    "let @xmath31 and @xmath332 be two generators on the same state space , assume that each has a single irreducible class of states , not necessarily the same , so that each has a unique stationary probability vector . denote the stationary distribution vectors as @xmath333 and @xmath334 , respectively .    by , @xmath335 and so @xmath336 since @xmath337 .",
    "if @xmath31 and @xmath332 are irreducible , it results from ( * ? ? ?",
    "* lemma 5.1 ) that @xmath338 is non - singular .",
    "a key argument in @xcite is that the kernel of both @xmath31 and @xmath332 is limited to span(@xmath339 ) , and so we repeat it verbatim to conclude that @xmath338 is non - singular in our case as well .",
    "thus , @xmath340 and the lemma is proved , once we set @xmath341 and @xmath342 .",
    "@xmath156    we thus see that @xmath330 can be expressed in terms of @xmath321 and @xmath343 through @xmath329 . in the next two sections",
    ", we use the decomposition to derive recursive formulae for @xmath311 and @xmath312 .",
    "recall that the laplace transform of the transient deviation matrix of @xmath309 is given by @xmath344 we can express @xmath311 in terms of @xmath345 thanks to the fact that @xmath346 can be expressed in terms of @xmath347 via the sherman - morrison - woodbury ( smw ) formula , which we restate here .",
    "let @xmath110 be a finite non - singular matrix of order @xmath348 and let @xmath349 and @xmath113 be matrices of dimension @xmath350 and @xmath351 , respectively . if @xmath352 is non - singular , then @xmath353 is non - singular as well and @xmath354 as a direct consequence of this formula , we have the following    the inverse of @xmath355 satisfies the recursive equation @xmath356where @xmath317 is given in , and @xmath357\\left[\\begin{array}{c|c}(si - q^{(c-1)})^{-1}&0\\\\\\hline0 & i\\end{array}\\right],\\end{aligned}\\ ] ] where @xmath326 is given in .",
    "_ we use the decomposition and apply with @xmath358 , @xmath359 , and @xmath360 .",
    "the expression for @xmath361 can be checked by verifying that @xmath362 using .",
    "@xmath156    the inverse @xmath346 is expressed in terms of @xmath347 and , by , @xmath363 furthermore , since @xmath330 can be expressed in terms of @xmath321 and @xmath343 by lemmas [ devtc ] and [ pirec ] , we conclude that @xmath311 may be expressed in terms of @xmath345 , @xmath321 , and @xmath343 .",
    "the recursive computation of the transient deviation matrices @xmath311 may therefore be done together with the recursive computation of the stationary distribution vectors @xmath330 and the deviation matrices @xmath364 , for @xmath102 .",
    "now , we focus on obtaining an expression for @xmath312 in terms of @xmath343 using the decomposition .",
    "we start from theorem 3.1 in @xcite , which gives an expression for the group inverse of a one - element updated markov chain generator , and we extend it to a one - block update . starting from a generator @xmath5 , we consider a new generator @xmath365 where @xmath31 is a matrix with one non - zero block - row only .",
    "we denote by @xmath366^\\top$ ] the block - column with identity as @xmath367-th block and @xmath3 zero blocks elsewhere , and by @xmath368 a block - row vector containing @xmath369 blocks , then @xmath370 for some @xmath367 .",
    "[ qsharpeexpress ] let @xmath5 be the generator of a markov process with deviation matrix @xmath18 and with stationary distribution @xmath371 .",
    "suppose that @xmath372 is the generator of an irreducible markov process .",
    "the deviation matrix @xmath373 of @xmath374 is given by @xmath375 where @xmath376 is the stationary distribution of @xmath374 .",
    "_ observe first that the inverse in is well defined by ( * ? ? ?",
    "* lemma 5.1 ) .",
    "we first show by direct verification of ( [ eq : deveq2 ] , [ eq : deveq1 ] ) . replacing @xmath373 with the right - hand side of ( [ qsharpeexpr ] )",
    ", we obtain @xmath377 since @xmath378 by ( [ stationperturbed ] ) , where @xmath31 is replaced by @xmath5 and @xmath332 by @xmath379 .",
    "next , @xmath380 by the smw formula ( [ eq : smw ] ) , and injecting ( [ simpl3 ] ) into ( [ qsharpeexpr ] ) provides ( [ qsharpeexpr2 ] ) .",
    "@xmath156    equation ( [ qsharpeexpr2 ] ) can be seen as an extension of the smw formula ( [ eq : smw ] ) to singular matrices .    as observed in @xcite , the cost of straightforward computation of ( [ qsharpeexpr ] ) may be high if one updates more than one row , as it requires the inversion of the matrix @xmath381 whose size is the same as @xmath374 .",
    "equation ( [ qsharpeexpr2 ] ) reduces the computational cost because the size of @xmath382 is just one block .    since",
    "the decomposition of @xmath309 given in ( [ sumdecompo ] ) is a block - element - updating of the matrix @xmath323 by @xmath383 , the recursive formula for the deviation matrix @xmath312 of @xmath309 follows from proposition [ qsharpeexpress ] .    [ prop_recur_dev ] the deviation matrix @xmath384 of the qbd process with generator @xmath385\\ ] ] is given by @xmath386 for @xmath387 , the deviation matrix @xmath312 of the qbd process with generator @xmath309 is recursively given by @xmath388 where @xmath317 is defined in ( [ eq : delta ] ) , and where @xmath329 is given in terms of @xmath343 in .",
    "_ the group inverse of @xmath389 comes directly from the relationship between the group inverse of a generator and kemeny and snell s fundamental matrix @xcite , given in theorem 3.1 in @xcite .",
    "for any @xmath387 , equation ( [ qsharpen+1 ] ) corresponds to equation ( [ qsharpeexpr2 ] ) in proposition [ qsharpeexpress ] with @xmath390 , @xmath391 , @xmath392 , @xmath393 , and @xmath394 .",
    "in this section , we compute the expected loss revenue function for various _ map / ph/1/c _ queues using the results of section [ mda ] .",
    "we then compare the performance of the two different approaches developed in sections [ mda ] and [ pta ] by computing the deviation matrix of arbitrary finite qbd processes with different numbers of phases and levels .",
    "recall that our motivation behind the computation of the expected reward function and the deviation matrices of a finite qbd process stems from our desire to compute of the expected amount of revenue lost in a _ map / ph/1/c _ queue .",
    "in such a process ,    * the arrival _",
    "map _ is characterised by the matrices @xmath395 and @xmath396 with @xmath397 phases ; * the service time is distributed according to a _ _ ph__@xmath398 distribution of order @xmath399 , with @xmath400 .    the _ map / ph/1/c _ system is a finite qbd process @xmath401 where    * @xmath402 represents the number of customers in the system at time @xmath4 , * @xmath403 where @xmath404 is the phase of the _ map _ at time @xmath4 , and @xmath405 is the phase of the _ ph _ distribution at time @xmath4 .",
    "the generator of that qbd process has a block - tridiagonal form given by where the block matrices are of size @xmath406 and are given by @xmath407 and @xmath408where @xmath409 and @xmath410 denote the kronecker product and sum , respectively .",
    "we consider a simple example where the _ map _ of arrivals corresponds to a _ ph _",
    "renewal process with @xmath411,\\quad d_1=\\left[\\begin{array}{c}8 \\\\",
    "5\\end{array}\\right]\\cdot [ 0.8,0.2],\\ ] ] and the service time is _ _ ph__@xmath412 with @xmath413,\\quad t=\\left[\\begin{array}{cc}-3 & 2\\\\      1 & -4\\end{array}\\right].\\ ] ] let @xmath414 be the phase transition matrix associated with the qbd process , and let @xmath333 be the stationary vector of @xmath31 . since in this example @xmath415 , we are in a _ high - blocking system_. this would correspond to a transient qbd process if there were no bound on the number of levels @xcite .",
    "we first assume that each customer accepted in the system generates @xmath416 units of revenue .",
    "the system loses revenue when it is in level @xmath3 and a customer arrives , who is rejected , and does not lose any revenue otherwise .",
    "the expected reward function @xmath7 records the total expected amount of lost revenue over the finite time horizon @xmath0 $ ] . in this particular case ,",
    "the reward vector @xmath11 records the _ loss _ per unit time , per state , and we have @xmath417 for @xmath418 and @xmath419 .",
    "results when @xmath420 and @xmath421 are shown in the upper panel of figure [ fig1 ] where we have assumed that the initial phase follows the distribution @xmath333 .    swapping the _",
    "ph _ distribution of the arrival process and service time leads to a _ low - blocking system _ , whose results are shown in the lower panel of figure [ fig1 ] .",
    "we clearly see that the expected lost revenue is much lower in the low - blocking system than in the high - blocking system , and in both cases it increases with the initial queue size , as expected .    expected lost revenue functions corresponding to a high - blocking system ( top ) and a low - blocking system ( bottom ) with @xmath420 and @xmath421 , for different initial queue lengths.,title=\"fig:\",width=377 ] expected lost revenue functions corresponding to a high - blocking system ( top ) and a low - blocking system ( bottom ) with @xmath420 and @xmath421 , for different initial queue lengths.,title=\"fig:\",width=377 ]    we now consider a case where each customer brings a fixed amount of revenue @xmath422 per time unit when in the system , in addition to the fixed @xmath416 units of revenue when entering the system .",
    "the reward vector then becomes @xmath423 for @xmath282 and @xmath424 , and we are now interested in the expected amount of revenue _ gained _ in @xmath0 $ ] .",
    "the results are shown in figure [ fig3 ] for a high - blocking system ( upper panel ) and a low - blocking system ( lower panel ) .",
    "expected gained revenue functions corresponding to a high - blocking system ( top ) and a low - blocking system ( bottom ) with @xmath420 , @xmath421 , and @xmath425 , for different initial queue lengths.,title=\"fig:\",width=377 ] expected gained revenue functions corresponding to a high - blocking system ( top ) and a low - blocking system ( bottom ) with @xmath420 , @xmath421 , and @xmath425 , for different initial queue lengths.,title=\"fig:\",width=377 ]      the matrix difference approach developed in section [ mda ] allows us to obtain the blocks of the expected reward vector and of the deviation matrices , with the advantage that the matrices involved in the expressions are at most twice the size of the phase space .",
    "however , that method requires the numerical computation of the matrices @xmath83 and @xmath85 for @xmath82 ; in addition , if we wish to compute the blocks of the deviation matrix , we first need to compute the blocks of the mean first passage time matrix , column by column .",
    "in contrast , the perturbation theory approach developed in section [ pta ] allows us to obtain recursively the whole deviation matrix , but at the cost of dealing with operations on larger matrices .",
    "we measured the numerical efficiency of the two approaches by comparing the cpu time corresponding to the computation of the last block - column of the deviation matrix for arbitrary qbd processes with a different number of phases and a different maximal level @xmath3 .",
    "to that aim , we generated qbd processes with random entries , with @xmath426 and @xmath427 , and for each process , we ran the two methods 100 times and took the average cpu time .",
    "we repeated the same simulation several times and observed similar behaviour .",
    "the results of one experiment are shown in figure [ fig5 ] .",
    "the cpu time increased linearly with @xmath3 for the matrix difference approach , while the growth is exponential for the perturbation theory approach .",
    "we see that there is always a threshold value @xmath428 such that the perturbation theoretical approach outperforms the matrix difference approach when @xmath429 , and conversely when @xmath430 .",
    "note that the threshold value does not seem to show a monotonic behaviour when the number of phases @xmath72 increases .    in conclusion ,",
    "if the objective is to compute parts of the deviation matrix , the perturbation theory approach is preferable for relatively small values of the maximal capacity , while the matrix difference approach is clearly more efficient for large values of @xmath3 .",
    "comparison if the cpu time corresponding to the computation of the last block - column of the deviation matrix of a qbd process with @xmath72 phases and maximum level @xmath3 , using the two approaches.,width=377 ]",
    "sophie hautphenne and peter taylor would like to thank the australian research council ( arc ) for supporting this research through discovery early career researcher award de150101044 and laureate fellowship fl130100039 , respectively .",
    "in addition , they both acknowledge the support of the arc center of excellence for mathematical and statistical frontiers ( acems ) . + sarah dendievel and guy latouche thank the ministre de la communaut franaise de belgique for funding this research through the arc grant auwb-08/13-ulb 5 .",
    "sarah dendievel would also like to thank the methusalem program of the flemish community of belgium for supporting this work in part ."
  ],
  "abstract_text": [
    "<S> deriving the time - dependent expected reward function associated with a continuous - time markov chain involves the computation of its transient deviation matrix . in this paper </S>",
    "<S> we focus on the special case of a finite quasi - birth - and - death ( qbd ) process , motivated by the desire to compute the expected revenue lost in a map / ph/1/c queue .    </S>",
    "<S> we use two different approaches in this context . </S>",
    "<S> the first is based on the solution of a finite system of matrix difference equations ; it provides an expression for the blocks of the expected reward vector , the deviation matrix , and the mean first passage time matrix . </S>",
    "<S> the second approach , based on some results in the perturbation theory of markov chains , leads to a recursive method to compute the full deviation matrix of a finite qbd process . </S>",
    "<S> we compare the two approaches using some numerical examples . + </S>",
    "<S> * keywords : * finite quasi - birth - and - death process ; expected reward ; deviation matrix ; matrix difference equations ; perturbation theory . </S>"
  ]
}