{
  "article_text": [
    "by the classical nielsen - schreier theorem every subgroup of a free group is again a free group .",
    "one of the goals of this paper is to study how one finitely generated free group @xmath0 can be embedded into another free group @xmath1 .",
    "clearly , the type of embedding of a subgroup @xmath0 into a group @xmath1 affects left and right cosets , and double cosets of type @xmath2 , @xmath3 .",
    "a description of combinatorial and formal language properties of these complexes is the second goal of the present paper .",
    "similar questions have been studied widely as auxiliary ones , for example , in papers @xcite , @xcite , @xcite in relation to hyperbolicity of amalgamated products of groups , and in @xcite , @xcite , @xcite in connection with the conjugacy problem in amalgamated products .",
    "there exist a lot of papers about the characterization of embeddings of a subgroup @xmath0 in a group @xmath1 , but we shall mention only the closest to the subject of our paper . in @xcite was shown that the property of a finitely generated subgroup @xmath0 to be malnormal is algorithmically decidable in a free group @xmath1 , meanwhile @xcite provides an example of the undecidability of this problem in the class of hyperbolic groups .",
    "another related result was proved in @xcite , where it was shown that a random finitely generated subgroup of a free group @xmath1 is malnormal .    the essential role in these studies is played by the structure of a cayley graph of a group and schreier graphs for a subgroup @xmath0 in @xmath1 . in particular , the embedding of @xmath0 in @xmath1 can be described in terms of equations @xmath4 and @xmath5 ( see section [ sub_basic ] ) , lemmas [ le : e(gg ) ] , [ le : e(fg ) ] ) .",
    "in this paper we obtain results on double cosets in a free group @xmath1 with respect to the type of embedding of a subgroup @xmath0 in @xmath1 .",
    "the main results are the following theorems :    * theorem [ th : bounded ] .",
    "*    _ let @xmath1 be a free group with a finite basis @xmath6 , and @xmath0 be a finitely generated subgroup of @xmath1 with a nielsen set of generators @xmath7 .",
    "suppose @xmath8 and @xmath9 is of minimal length in a double coset @xmath2 .",
    "then there exists a natural number @xmath10 which can be effectively determined by @xmath0 and @xmath7 such that _    * if @xmath11 , then multiplication in the complex @xmath2 is @xmath12reduced , which means @xmath13 , where @xmath14 and @xmath15 is the length of elements in @xmath16 . * if @xmath17 , then @xmath18 is @xmath12reduced , where @xmath19 is a relative schreier transversal of @xmath0 in @xmath1 relative to @xmath20",
    ".    * theorem [ th : cfcreg ] . * _ let @xmath0 be a finite rank subgroup of a free group @xmath16 .",
    "then the set of all @xmath21reduced words representing elements of @xmath2 is regular in @xmath16 .",
    "moreover , an automaton which accepts this set can be constructed effectively by @xmath0 and @xmath9 if @xmath0 is @xmath22malnormal , or by @xmath23 and a relative schreier transversal @xmath19 of @xmath0 with respect to @xmath20 , otherwise . _",
    "in this section , following @xcite , we give some basics on regular subsets , cosets , and schreier representatives of finitely generated subgroups of a finite rank free group @xmath1 .",
    "we shall use the following notation throughout the paper .",
    "let @xmath24 be a free group with basis @xmath25 .",
    "we identify elements of @xmath1 with reduced words in the alphabet @xmath26 ( i.e. _ @xmath21reduced _ words ) , and let @xmath27 denote the length of an element @xmath3 , i.e. the number of letters of the reduced word @xmath9 in @xmath26 .",
    "fix a subgroup @xmath28 of @xmath1 generated by finitely many elements @xmath29 and an arbitrary element @xmath3 .",
    "the set @xmath30 is called a _",
    "double coset _ and @xmath9 is a _ representative _ of this coset .",
    "suppose we are given a finite set @xmath6 , which we shall call the _",
    "state set_. an _ arrow _ is a triple @xmath31 , where @xmath32 are elements of @xmath33 and @xmath34 is an element of @xmath35 and is called the _ label _ of the arrow .",
    "the _ source _ of the arrow is @xmath36 and its _ target _ is @xmath37 .",
    "an arrow labelled @xmath34 is sometimes called an @xmath38_transition_.    a _ non - deterministic finite state automaton _ @xmath39 is a quintuple @xmath40 , where @xmath33 is a finite set of _ states _ , @xmath6 is a finite set called the _ alphabet _ , @xmath41 is the ( non - empty ) set of _ initial states _ , @xmath42 is the set of _ final states _ , and @xmath43 is a set of arrows with labels in the enlarged alphabet @xmath44 . here",
    "@xmath45 is assumed not to lie in @xmath6 .    by a path of arrows in @xmath39 we mean a sequence @xmath46 , where @xmath47 and each @xmath48 is an arrow with source @xmath49 and target @xmath50 , for @xmath51 .",
    "we call @xmath36 the source and @xmath52 the target of the path of arrows",
    ". let @xmath53 be the label of @xmath48 , i.e. a letter of @xmath6 or @xmath45 .",
    "let @xmath54 be the concatenation @xmath55 ; if @xmath56 , set @xmath57 . then @xmath54 is called the _ label _ of the path .",
    "let @xmath58 be a monoid of strings over @xmath6 with identity @xmath45 .",
    "the _ language _ @xmath59 over @xmath6 assigned to a non - deterministic automaton is the set of elements of @xmath58 obtainable from the labels of all possible paths of arrows with source in @xmath60 and target in @xmath61 ; in this case we say that @xmath62 is a language _ accepted _ by @xmath39 .",
    "we say @xmath54 is _ readable _ in @xmath39 from @xmath36 to @xmath37 , where @xmath63 , if there is a path of arrows from @xmath36 to @xmath37 with the label @xmath54 .",
    "a _ deterministic finite state automaton _ can be considered a special case of a non - deterministic finite state automaton , for which the following conditions are satisfied : there are no arrows labelled @xmath45 ; each state is the source of exactly one arrow with any given label from @xmath6 ; and @xmath60 has exactly one element .    by the kleene - rabin - scott theorem a regular language over @xmath6",
    "may be identified with the language accepted by some non - deterministic finite state automaton , or , equivalently , by some deterministic finite state automaton .",
    "if @xmath64 is a subset of a group @xmath1 , then @xmath6 is supposed to be a set of group generators for @xmath1 , i.e. elements of @xmath65 are meant to be reduced strings over @xmath66 .",
    "we shall sometimes identify an automaton @xmath39 with a finite connected oriented labelled graph @xmath67 with a distinguished vertex in natural way .",
    "namely , take vertex set @xmath68 ; edge set @xmath69 corresponding to the arrows , with induced labelling , and form subsets @xmath70 from distinguished vertices .",
    "we shall also ascribe properties of automata to graphs .",
    "one can associate with a subgroup @xmath0 two graphs : _ the subgroup graph _ @xmath71 and the schreier graph @xmath72 ; we refer reader to @xcite for more details on this subject .",
    "recall , that @xmath67 is a finite connected digraph with edges labelled by elements from @xmath6 and a distinguished vertex ( based - point ) @xmath73 ( so @xmath74 ) , satisfying the following two conditions .",
    "firstly , @xmath67 is folded , i.e. , there are no two edges in @xmath67 with the same label and having the same initial or terminal vertices .",
    "secondly , @xmath67 accepts precisely the reduced words in @xmath26 that belong to @xmath0 . to explain the latter observe , that walking along a path @xmath75 in @xmath67 one can read a word @xmath76 in the alphabet @xmath66 , the label of @xmath75 , ( reading @xmath34 in passing an edge @xmath77 with label @xmath34 along the orientation of @xmath77 , and reading @xmath78 in the opposite direction ) .",
    "we say that @xmath67 accepts a word @xmath54 if @xmath79 for some closed path @xmath75 that starts at @xmath73 and has no backtracking .",
    "clearly , @xmath67 can be identified with a deterministic finite state automata with @xmath73 as the unique initial and final state .    the _ schreier graph _",
    "@xmath80 of @xmath0 is a connected labelled digraph with the set @xmath81 of the right cosets of @xmath0 in @xmath1 as the vertex set , and such that there is an edge from @xmath82 to @xmath83 with a label @xmath84 if and only if @xmath85 .",
    "one can describe the schreier graph @xmath86 as obtained from @xmath67 by the following procedure .",
    "let @xmath87 and @xmath84 such that there is no outgoing or incoming edge at @xmath88 labelled by @xmath34 .",
    "for every such @xmath88 and @xmath84 we attach to @xmath88 a new edge @xmath77 ( correspondingly , either outgoing or incoming ) labelled @xmath34 with a new terminal vertex @xmath89 ( not in @xmath67 ) . then we attach to @xmath89 the cayley graph @xmath90 of @xmath1 relative to @xmath6 ( identifying @xmath89 with the vertex @xmath73 of @xmath90 ) , and then we fold the edge @xmath77 with the corresponding edge in @xmath90 ( that is labelled @xmath34 and is incoming to @xmath89 ) .",
    "observe , that for every vertex @xmath91 and every reduced word @xmath54 in @xmath26 there is a unique path @xmath86 that starts at @xmath88 and has the label @xmath54 . by @xmath92",
    "we denote such a path that starts at @xmath73 , and by @xmath93 the end vertex of @xmath92 .",
    "the resulting graph @xmath94 is the schreier graph of @xmath0 in @xmath1 .",
    "notice that @xmath95 if and only if the subgroup @xmath0 has finite index in @xmath1 .",
    "a spanning subtree @xmath19 of @xmath67 with the root at the vertex @xmath73 is called _ geodesic _ if for every vertex @xmath96 the unique path in @xmath19 from @xmath73 to @xmath88 is a geodesic path in @xmath67 . for a given graph @xmath67 one can effectively construct a geodesic spanning subtree @xmath19 .    from now on",
    "we fix an arbitrary spanning subtree @xmath19 of @xmath67 .",
    "it is easy to see that the tree @xmath19 uniquely extends to a spanning subtree @xmath97 of @xmath86 .",
    "let @xmath98 be the set of vertices of @xmath86 . since , in general , @xmath86 is infinite , we need to extend terminology from subsection [ subs_reg ] .",
    "for a subset @xmath99 and a subgraph @xmath100 of @xmath86 , we define the _ language accepted by _",
    "@xmath100 and @xmath7 as the set @xmath101 of the labels @xmath76 of paths @xmath75 in @xmath100 that start at @xmath73 and end at one of the vertices in @xmath7 , and have no backtracking .",
    "notice that the words @xmath76 are reduced since the graph @xmath86 is folded .",
    "notice , that @xmath102 and @xmath103 .    sometimes we shall refer to a set of right representatives of @xmath0 as the _ transversal _ of @xmath0 .",
    "recall , that a transversal @xmath104 of @xmath0 is termed _ schreier _ if every initial segment of a representative from @xmath104 belongs to @xmath104 .",
    "further , let @xmath104 be a transversal of @xmath0 .",
    "a representative @xmath105 is called _ internal _ if the path @xmath106 ends in @xmath67 , i.e. , @xmath107 . by @xmath108",
    "we denote the set of all internal representatives in @xmath109 it follows from definition , that @xmath110    a representative @xmath111 is called _ geodesic _ if it has minimal possible length in its coset @xmath112 .",
    "the transversal @xmath104 is _ geodesic _ if every @xmath111 is geodesic .",
    "clearly , if @xmath113 is a geodesic subtree of @xmath114 ( and hence @xmath19 is a geodesic subtree of @xmath67 ) , then @xmath104 is a geodesic transversal .",
    "in this section we study double cosets from different points of view .",
    "let @xmath115 , @xmath0 as above .",
    "fix an element @xmath116 and consider the double coset @xmath2 for this element .",
    "clearly , the following conditions are equivalent :    @xmath117    denote by @xmath118 the equation @xmath119 over @xmath0 . due to the latter equivalence",
    ", an element @xmath120 belongs to @xmath2 iff the equation @xmath118 is solvable over @xmath0 , i.e. exist @xmath121 such that @xmath122 .",
    "lemma [ le : e(gg ) ] describes some properties of solutions of the uniform equation @xmath4 .",
    "we assign to @xmath9 a subgroup @xmath123 such that @xmath124 , where @xmath125 is the set of all elements of the form @xmath126 .",
    "it turns out that @xmath20 plays a special role in the whole theory of double cosets .",
    "this subgroup is one of the most important characteristics of the embedding of @xmath0 in @xmath1 .",
    "further , a subgroup @xmath0 is called",
    "_ @xmath22malnormal _ if @xmath127 . recall that a subgroup @xmath0 is said to be _ malnormal _ if it is @xmath22malnormal for all @xmath128 .",
    "if , on the contrary , @xmath20 is nontrivial then , following @xcite , we call @xmath9 _ potentially normalizing _ ( or _ pn _ for short ) .",
    "[ le : e(gg ) ] let @xmath129 and @xmath128 .",
    "let @xmath130 be the set of all solutions of equation @xmath4 . in the notation above",
    "* @xmath131 consists of pairs @xmath132 for all @xmath133 ; + * if @xmath0 is @xmath22malnormal ( malnormal _ a fortiori _ ) , then @xmath134 ; + * if @xmath135 , then @xmath136 is isomorphic to @xmath20 .    to show ( 1 ) take an arbitrary @xmath137 ; then by definition @xmath138 .",
    "therefore , exists an element @xmath139 such that @xmath140 .",
    "evidently , @xmath141 provide a solution of @xmath4 and all such elements can be obtained analogously .",
    "let us show ( 2 ) .",
    "suppose there exist two different solutions of @xmath4 , say @xmath142 and @xmath143 in @xmath144 .",
    "then @xmath145 , @xmath146 and therefore @xmath147 .",
    "from this it follows that @xmath148 .",
    "thus @xmath149 and @xmath150 and the set @xmath131 consists of only one pair .    to prove claim ( 3 ) , suppose @xmath151 for some @xmath152 .",
    "by definition @xmath153 .",
    "this concludes the proof .    if an element @xmath9 is pn , then every other representative in @xmath2 is also potentially normalizing by lemma [ le : e(gg ) ] .",
    "a double coset @xmath2 is called _ essential _ if @xmath17 for some representative @xmath3 ( and so for all representatives of this coset ) .",
    "[ le : essential ] the number of different essential cosets is finite .",
    "the union of all essential double cosets forms so called generalized normalizer of @xmath0 in @xmath1 , i.e. the set @xmath154 .",
    "this union is known to be finite ( see , for example , @xcite , proposition 3.5 . ) .",
    "[ le : e(fg ) ] let @xmath129 and @xmath155 .",
    "if the equation @xmath118 has a solution @xmath156 over @xmath0 , then the set @xmath157 of all solutions of this equation consist of all pairs @xmath158 , where @xmath159 .",
    "in particular , if @xmath0 is @xmath22malnormal , then there exists a unique solution @xmath156 with @xmath14 such that @xmath160 for @xmath135 .",
    "notice that @xmath118 is consistent by assumption and therefore exists a pair @xmath156 such that @xmath161 .",
    "if @xmath0 is @xmath22malnormal , then @xmath162 and @xmath157 satisfies the desired conclusion .",
    "denote by @xmath163 the set of all such pairs and suppose there exists another pair of solutions , say @xmath164 . then @xmath165 and @xmath166 , and therefore @xmath167 and @xmath168 .",
    "this implies @xmath169 and @xmath170 , but @xmath171 and @xmath172 .",
    "the opposite inclusion @xmath173 is straightforward .",
    "now suppose that @xmath0 is supplied by a nielsen generating set . in this subsection",
    "we analyze how this affects the cancellation in cosets and double cosets of @xmath0 .",
    "we also introduce here the notion of a relative schreier transversal of @xmath0 with respect to its subgroup @xmath174 .",
    "since an arbitrary set of generators for @xmath0 can be carried into a nielsen set ( see , for example , @xcite or @xcite ) , without loss of generality it can be assumed that @xmath0 is presented by such a set @xmath175 .",
    "let @xmath104 be the geodesic schreier transversal for @xmath0 in @xmath1 such that the nielsen set of generators @xmath7 has the following properties with respect to @xmath104 .",
    "* properties of a nielsen set of generators : *",
    "* each @xmath176 can be written in the form @xmath177 where @xmath178 are written as reduced @xmath21words , @xmath179 is an element of @xmath26 and @xmath180 * if @xmath181 are distinct elements of @xmath7 , then the letters @xmath182 and @xmath183 do not cancel on computing the @xmath21reduced form of @xmath184 ; * if @xmath185 are elements of @xmath186 such that @xmath187 and @xmath188 , then the letter @xmath189 does not cancel on computing the @xmath21reduced form of @xmath190 .",
    "clearly , such @xmath104 always exists ; and the letter @xmath179 is called the central letter of @xmath176 .",
    "set @xmath191 + 1.$ ]    the following material ( up to lemma [ le:5 ] ) can be extracted from @xcite .",
    "[ le:35 ] ( * ? ? ?",
    "* lemma 2 ) suppose @xmath3 is pn and has minimal length in @xmath2 . if @xmath192 , where @xmath193 , then at least one of the letters of @xmath194 appears in the reduced form of @xmath195 , i.e. , in @xmath139 .    [ le:34 ] ( * ? ?",
    "* lemma 3,4 ) suppose @xmath9 is of minimal length in @xmath196 and that @xmath197 ( where @xmath198 ) is @xmath199reduced .",
    "* then either @xmath200 remains in @xmath201 and in this case the cancellation with @xmath9 in @xmath202 is exactly that of @xmath9 in @xmath203 ; or the central letter @xmath200 cancels in the product @xmath202 , and in this case @xmath204 is of even length and exactly half of @xmath204 cancels with @xmath9 ;",
    "* suppose that @xmath205 cancels in the product @xmath206 , but @xmath207 does not .",
    "then * * @xmath208 ; * * for any @xmath209 the length @xmath210 is even and @xmath211 cancels in product @xmath202 ; * * for any @xmath212 exactly the right half @xmath213 of @xmath214 cancels completely in @xmath215 ; * * @xmath216 ; * * if the right half of @xmath217 does not cancel completely with @xmath218 , then @xmath219 is precisely the part of @xmath220 that cancels with @xmath9 and @xmath221 ; * * if the right half of @xmath217 does cancel with @xmath218 , then @xmath222 is precisely the part of @xmath220 that cancels with @xmath9 for some @xmath223 and @xmath224 .",
    "[ le:5 ] ( * ? ? ?",
    "* lemma 5 ) suppose that the equation @xmath4 is satisfied for @xmath14 , and @xmath9 is of minimal length in @xmath2 .",
    "then there exists @xmath225 of the same length as @xmath9 which is a product of two pieces of generators from @xmath226 .",
    "lemma [ le:5 ] allows us to obtain an algorithm which lists all essential double cosets :    [ cor : listessential ] there exists an algorithm @xmath227 , which given a subgroup @xmath0 of @xmath1 and a nielsen set of generators @xmath175 lists all essential double cosets @xmath2 of @xmath1 ( finite in their number by lemma [ le : essential ] ) .",
    "moreover , @xmath227 runs in polynomial time in @xmath228 + 1 $ ] .",
    "the number of different pieces of generators in @xmath226 can be estimated as @xmath229 , and therefore one can form a list of all possible products @xmath225 ( as in [ le:5 ] ) in time at most @xmath230 .",
    "let us fix an element @xmath231 of this list . by ( * ? ? ?",
    "* theorem 1.6 ) , we can construct subgroup graphs @xmath232 and @xmath233 in time @xmath234 and @xmath235 , respectively , where @xmath236 and @xmath237 . here",
    "the function @xmath238 is given by @xmath239 , where @xmath240 .",
    "the product @xmath241 can be constructed in time @xmath242 , which is bounded above by @xmath229 .",
    "if now the component of @xmath241 containing @xmath243 is not an isolated vertex , then @xmath9 is essential .",
    "using properties of sets of nielsen generators and lemmas [ le:35 ] , [ le:34 ] , we want to introduce a notion of the relative schreier transversal .",
    "we shall use this to simplify multiplication and representation of elements in double cosets .    for",
    "every pair @xmath244 , @xmath245 , define @xmath246 to be the initial subword of @xmath247 that does not cancel on forming the product @xmath248 , and let @xmath249 be the terminal subword of @xmath250 that does not cancel on forming @xmath248 .",
    "denote also @xmath251 the subword of @xmath250 that does not cancel on forming the triple product @xmath252 , where @xmath253 .",
    "notice that by definition of a nielsen set of generators all words @xmath246 , @xmath249 and @xmath251 in @xmath16 are nontrivial .",
    "denote by @xmath254 this new alphabet @xmath255 obtained from all such generators , their pairs @xmath256 and triples @xmath257 .",
    "we also use an additional subdivision of @xmath251 .",
    "namely , let @xmath258 for some @xmath259 ( not necessarily non - trivial ) .",
    "( in section [ subs_weakred ] we subdivide @xmath260-s and @xmath261 s into smaller pieces : @xmath262 ) .",
    "a nontrivial @xmath263reduced word @xmath89 is called _",
    "@xmath0-admissible _ if it has one of the following forms @xmath264 @xmath265    clearly , there is one - to - one correspondence between @xmath0-admissible words and nontrivial @xmath21reduced words @xmath266 .",
    "further , let @xmath174 be a nontrivial subgroup of @xmath0 and suppose @xmath174 is given by a finite nielsen set of generators @xmath267 , where @xmath268 are @xmath199reduced words .",
    "consider a subgroup graph @xmath269 , and take a maximal subtree @xmath270 of @xmath269 such that the corresponding schreier transversal @xmath19 respect the choice of central letters @xmath271 .",
    "denote by @xmath272 the set of all inner representatives from @xmath19 . combining properties ( i ) ,",
    "( ii ) , ( iii ) of a nielsen set of generators with formulae ( [ hihj1 ] ) - ( [ hihj2 ] ) above , we get @xmath273    where @xmath274 , and @xmath275 .    the system @xmath276 of all @xmath277admissible words @xmath278 is called the _ relative schreier transversal _ of @xmath0 in @xmath1 with respect to @xmath174 and @xmath270 .    consider an example of a relative schreier transversal for a subgroup @xmath279 .",
    "let @xmath280 be a nielsen set of generators of @xmath0 .",
    "the subgroup graph @xmath281 is shown on figure [ fig_subgrc ] , the edges entering maximal subtree are highlighted .     recognizing @xmath282    further ,",
    "represent elements of @xmath226 in the form @xmath283 ( uniquely determined by @xmath104 ) :    @xmath284 @xmath285 @xmath286    taking all suitable products of @xmath256 and @xmath287 for @xmath288 , one can easily construct @xmath254 .",
    "for instance , @xmath289 , @xmath290 , @xmath291 , @xmath292 , @xmath293 etc .",
    "the element @xmath294 is pn and a subgroup @xmath295 is generated by a nielsen generating set @xmath296 .",
    "then , taking a maximal subtree @xmath270 as shown on figure [ fig_subgrd ] , obtain @xmath297    therefore , @xmath298 and @xmath299 are central words and @xmath300 forms the inner part of the relative schreier transversal for @xmath0 in @xmath1 with respect to @xmath295 and @xmath270 .",
    "this relative transversal in terms of @xmath301 is shown on figure [ fig_consd ] ( and we refer reader to @xcite for more details on consolidated graphs ) .    in the sequel ,",
    "we omit a maximal subtree @xmath270 from the notation assuming it fixed for every relative schreier transversal .    in lemma [ le : e(fg ) ] we showed that every representative @xmath302 has a unique presentation in the form @xmath303 , @xmath304 when @xmath305 .",
    "however , this is not the case for essential cosets and such a presentation is not unique in general .",
    "nevertheless , the representatives of essential cosets can be uniquely written in a similar way :    [ le : ess ! ]",
    "let @xmath2 be an essential coset and let @xmath19 be a schreier transversal for @xmath0 in @xmath1 with respect to @xmath20 .",
    "then every @xmath135 has a unique presentation @xmath306    let @xmath307 be a representative of a some essential double coset @xmath2 , @xmath308 . by definition of a relative schreier transversal there is an element @xmath309 such that @xmath310 .",
    "now suppose that @xmath311 is another presentation for @xmath120 , @xmath312 .",
    "then @xmath313 implies @xmath314 and since @xmath315 we have @xmath316 and @xmath317 . but @xmath318 are both representatives of @xmath20 in @xmath0 and since they are in the same coset , @xmath319 and hence @xmath320 .      in this subsection",
    "we estimate the size of cancellations in a double coset depending on a subgroup @xmath20 .",
    "let @xmath175 be some fixed set of nielsen generators for @xmath0 . recall that @xmath321 + 1 $ ] and set @xmath75 equal to the number of elements in the ball of radius @xmath322 in @xmath16 .",
    "we shall use this notation in what follows .",
    "the following technical lemma turns out to be crucial in the proof of theorem [ th : bounded ] .",
    "[ le : key ] let @xmath323 be a sequence of elements in @xmath16 such that @xmath324 are elements of @xmath226 ; @xmath325 and @xmath326 are @xmath199reduced words , and @xmath327 for all @xmath328 .",
    "then for all @xmath329 there exist @xmath330 and nontrivial @xmath331 such that @xmath332 , and @xmath333 , and @xmath334    fix a number @xmath10 ; notice that @xmath163 is at least @xmath73 so @xmath335 for a free group @xmath1 of rank @xmath336 and therefore @xmath337 in particular , @xmath338 .",
    "the number of all elements of length not greater then @xmath322 is equal to @xmath75 by definition , and so by dirichlet s drawer principle there are at least two equal elements among @xmath339 elements of such length , say @xmath340 and @xmath341 with @xmath342 .",
    "the statement of the lemma is obvious for @xmath343 , so suppose @xmath344 are non - trivial . since    @xmath345 one can take @xmath346 , @xmath347 and @xmath348 , @xmath349 .",
    "clearly , @xmath350 are non - trivial ( as they are @xmath199reduced products of non - trivial elements ) and @xmath351 , @xmath352 .",
    "indeed , let , for instance , @xmath353 ; then the product @xmath354 is equal to @xmath355 . but",
    "@xmath356 can not be trivial as a @xmath199reduced word in nielsen generators .",
    "therefore , @xmath357 and other equalities are straightforward .",
    "let @xmath358 be a finite number of subsets in @xmath16 and consider the function @xmath359 which computes the total amount of @xmath21cancellations in the product @xmath360 :    @xmath361    observe that for @xmath362 the function @xmath363 coincides with the notion of lyndon - chiswell - gromov product @xmath364 in a group @xmath1 with respect to canonical length function @xmath365 ( see @xcite for details on length functions , and in @xcite this definition was adapted to hyperbolic metric spaces ) .",
    "we say that the product @xmath366 is _",
    "@xmath12reduced _ if there is a constant @xmath367 such that for every @xmath368 the following holds @xmath369 for instance , two singletons @xmath370 such that @xmath371 form a @xmath372reduced set , but we shall omit the prefix @xmath372 below ( saving `` @xmath12 '' only for @xmath373 ) .",
    "[ th : bounded ] let @xmath1 be a free group with a finite basis @xmath6 and @xmath0 be a finitely generated subgroup of @xmath1 with a nielsen set of generators @xmath7 .",
    "suppose @xmath8 and @xmath9 is of minimal length in a double coset @xmath2 , and let @xmath374 .",
    "* if @xmath0 is @xmath22malnormal , then @xmath2 is @xmath12reduced . *",
    "if @xmath2 is essential , then @xmath18 is @xmath12reduced , where @xmath19 is the relative schreier transversal of @xmath0 in @xmath1 relative to @xmath20 .",
    "let @xmath135 .",
    "if @xmath9 does not cancel completely in @xmath375 , then by lemma [ le:34 ] the length of cancellations @xmath376 is bounded above by @xmath163 ( and also @xmath377 ) .",
    "hence @xmath378 and both ( 1 . ) and ( 2 . ) follows . if , on the other hand , @xmath9 cancels completely then there are the two cases @xmath305 and @xmath17 to be considered .",
    "* suppose @xmath379 and @xmath135 such that the total amount of cancellations in @xmath380 is greater than @xmath10 for @xmath381 .",
    "let @xmath382 , where @xmath383 cancels completely in @xmath384 and @xmath385 cancels in @xmath386 .",
    "below we list all possible forms of pieces @xmath383 and @xmath385 . by lemma [ le:34 ]",
    "@xmath385 possesses the following properties :    * either @xmath387 , where @xmath388 and @xmath389 is an initial segment of @xmath390 .",
    "then @xmath391 and @xmath392 is an initial segment of @xmath393 of length @xmath394 , and @xmath395 ; + * or @xmath396 . then @xmath397 and @xmath398 , @xmath395 ; + * or @xmath399 , in which case @xmath400",
    "; recall that @xmath401 are elements of @xmath16 such that @xmath402 . here",
    "the length @xmath395 ( see lemma [ le:34 ] , ( e ) ) and @xmath403 ; + * or @xmath404 , where @xmath405 ; and @xmath406 are such that @xmath407 . here",
    "the length @xmath395 ( see ( f ) of lemma [ le:34 ] ) and @xmath408 .    similarly , @xmath383 and @xmath409 have one of the forms :    * either @xmath410 , where @xmath388 and @xmath389 is a terminal segment of @xmath411 .",
    "then @xmath412 and @xmath392 is a beginning of @xmath214 of length @xmath413 , and @xmath414 ; + * or @xmath415 . then @xmath416 and @xmath417 , @xmath414 ; + * or @xmath418 , in which case @xmath419 ; here @xmath401 are such that @xmath420 . here the length @xmath421 and @xmath422 ; + * or @xmath423 , where @xmath424 ; and @xmath425 are such that @xmath426 . here the length @xmath414 and @xmath427 .",
    "summarizing conditions ( 1.1 )  ( 2.4 ) and renumbering @xmath428 for notational simplicity if necessary , we obtain    @xmath429    where @xmath430 and    @xmath431    if @xmath432 , then again @xmath433 and the total cancellations in @xmath434 are bounded above by @xmath322 , in contradiction with assumption @xmath435 . therefore , @xmath436 is not reduced . notice that @xmath437 implies @xmath438 and",
    "therefore @xmath439 .",
    "suppose @xmath436 cancels to @xmath440 , where @xmath441 is an initial part of @xmath442 and @xmath443 is a terminal part of @xmath444 .",
    "without loss of generality one can assume that all @xmath445 cancel in @xmath446    by definition of the function @xmath447 we have    @xmath448    where @xmath449 @xmath450 and @xmath451 .",
    "rearranging summands in ( [ cn(cfd ) ] ) and ( [ q1q2 ] ) we get @xmath452 @xmath453    @xmath454    further , formulae ( 1.1 ) - ( 2.4 ) imply @xmath455 , @xmath456 , and @xmath457 . by definition of a nielsen set of generators @xmath458 and @xmath459 for all @xmath460 . therefore",
    ",    @xmath461    moreover , the assumption that all @xmath445 cancel in ( [ q1q2 ] ) implies @xmath462 and    @xmath463    where @xmath464 is an initial segment of @xmath465 , @xmath466 is a terminal segment of @xmath467 and @xmath120 is not @xmath277admissible .",
    "hence , @xmath468 and since @xmath469 , we have @xmath470    consider the sequence    @xmath471    here @xmath472 and by ( 1.1 ) - ( 2.4 ) we have @xmath473 and from formula ( [ g = ab ] ) one can easily deduce @xmath474 .    further , since @xmath475 , and @xmath476 are @xmath199reduced words in the nielsen set of generators @xmath7 ( see properties ( i ) - ( iii ) ) , the equality ( [ g = ab ] ) is possible only if all lengths @xmath477 are bounded above by @xmath322 .    observe that @xmath478 due to ( [ lp ] ) , and @xmath479 represent the same double coset . hence by lemma [ le : e(gg ) ] , ( 3 . )",
    "we have @xmath480 .",
    "therefore , @xmath481 satisfy the assumptions of lemma [ le : key ] and hence there exist elements , say @xmath482 and @xmath483 such that @xmath484 , but @xmath485 , a contradiction to the uniqueness of the representation of @xmath486 in @xmath2 ( see lemma [ le : e(fg ) ] ) .",
    "* 2 . * let @xmath17 . then by lemma",
    "[ le : ess !",
    "] there is a unique presentation @xmath375 for @xmath266 and @xmath487 for the relative schreier transversal @xmath488 ( recall that we fixed a maximal subtree @xmath270 in @xmath232 ; hence @xmath19 is unique ) .",
    "then considering elements @xmath487 and arguing as above , we obtain the equality @xmath489 for different indexes @xmath490 again , a contradiction with lemma [ le : ess ! ] .",
    "notice that for essential double cosets the complex @xmath2 might not be @xmath12reduced for any @xmath10 .",
    "indeed , let @xmath54 be a primitive element of an arbitrary finite rank free group @xmath1 , and let @xmath0 be the subgroup of @xmath1 generated by @xmath491 for some @xmath492 . then @xmath493 is pn and does not belong to @xmath0 .",
    "however , the total amount of cancellations in the product @xmath494 can be arbitrary large .      in this subsection",
    "we investigate connections between bounded cancellation and regularity of subsets of @xmath16 .",
    "we establish the regularity of all reduced words representing elements of a double coset @xmath2 in a free group @xmath16 using this relation .",
    "[ rem : weakred ] suppose @xmath495 are two regular subsets in @xmath1 .",
    "then the set @xmath496 of all reduced words in @xmath497 is regular in @xmath16 .",
    "the set @xmath497 is regular by benois theorem ( see @xcite ) , but we also need an automaton accepting @xmath496",
    ". we shall show below how to construct this automaton for the case where the product @xmath497 is @xmath12reduced .",
    "let @xmath498 be a deterministic automaton accepting @xmath499 ; in particular , it means @xmath500 , @xmath501 .",
    "one can easily form a ( non - deterministic ) automaton @xmath39 , which accepts the concatenation @xmath497 .",
    "namely , take the same alphabet @xmath6 , @xmath502 , the new start state to be @xmath503 , the final states to be @xmath504 , the transition function to be @xmath505 ; and add additional arrows labelled @xmath45 from all states of @xmath506 to @xmath507 .",
    "since @xmath497 is @xmath12reduced , the length of cancellations between the elements @xmath508 , where @xmath509 is bounded by @xmath10 . therefore , the set @xmath510 of words @xmath511 such that @xmath512 , @xmath513 , and @xmath514 , where @xmath515 , @xmath516 , is finite . since @xmath517 is a finite state automaton , for every @xmath518 there is a finite set @xmath519 ; by the same argument the set @xmath520 is finite .",
    "add @xmath521transitions from the states of @xmath522 to the states of @xmath523 for all @xmath524 .",
    "clearly , @xmath525 by construction , and moreover , @xmath526 .",
    "thus @xmath496 is an intersection of regular sets , so is itself regular .    the _ double - based cone _ with bases",
    "@xmath527 is the set of all reduced words @xmath528 in @xmath16 , starting with @xmath529 and ending with @xmath530 .    [ cor : cones_reg ]",
    "every double - based cone @xmath531 in a finite rank free group is a regular set .",
    "one can prove this statement using benois theorem , but we are interested in it s direct proof and corresponding automaton .",
    "let @xmath532 , @xmath533 .",
    "then by definition an element @xmath534 is an @xmath21reduced word of the form @xmath535 , with @xmath536 , and @xmath537 .",
    "thus , it is sufficient to prove the regularity of a cone with bases @xmath538 and @xmath539 .",
    "indeed , if @xmath540 is regular , then so is @xmath541 as it is a concatenation of regular sets in @xmath16 . for notational simplicity",
    "we construct a deterministic automaton @xmath39 recognizing the cone @xmath540 in @xmath542 , for bases equal to @xmath294 and @xmath543 respectively .",
    "an automaton @xmath39 recognizing @xmath544 is shown in figure [ fig_cab ] ( the tailed arrow corresponds to the initial state plus @xmath545transition , and the final state is labelled by double circle ) .     recognizing the cone @xmath544.,title=\"fig:\",width=226 ] +",
    "if now the rank of the free group @xmath1 is greater than @xmath546 , @xmath39 can be easily modified to recognize @xmath544 in @xmath115 .",
    "namely , it is necessary to add a new state @xmath547 corresponding to each element of @xmath26 ( except @xmath548 ) . from every new state @xmath549",
    "we add a @xmath550transition to every other state @xmath551 , including @xmath547 , but excluding @xmath552 .",
    "the arrows from basis @xmath294 and to basis @xmath543 can be added in similar way .",
    "[ th : cfcreg ] let @xmath0 be a finite rank subgroup of a free group @xmath16 .",
    "then the set of all @xmath21reduced words representing elements of @xmath2 is regular in @xmath16 .",
    "moreover , an automaton which accepts this set can be constructed effectively by @xmath0 and @xmath9 if @xmath0 is @xmath22malnormal , or by @xmath23 and a relative schreier transversal @xmath19 of @xmath0 with respect to @xmath20 , otherwise .",
    "if @xmath305 , then every @xmath21reduced word in @xmath2 has a unique representation in terms of this complex , by lemma [ le : e(fg ) ] . if @xmath17 , then every word in @xmath2 can be represented by an element of the complex @xmath18 , for a relative schreier transversal @xmath19 of @xmath0 with respect to @xmath20 , by lemma [ le : ess ! ] . in both cases the sets @xmath2 and @xmath18 are regular : it follows either from benois theorem , or from the following direct construction .",
    "the sets @xmath2 and @xmath18 are @xmath12reduced in @xmath16 , by theorem [ th : bounded ] .",
    "further , since @xmath0 , @xmath196 and @xmath553 are regular in @xmath16 and corresponding automata can be constructed effectively ( see , for example , @xcite ) , the result follows from remark [ rem : weakred ] and it s proof .",
    "the first author is grateful to a.  duncan , a.  a.  klyachko and v.  a.  romankov for useful remarks .",
    "the second author was partially supported by rffi grant 11 - 01 - 00081 .",
    "e.  frenkel , a.  g.  myasnikov and v.  n.  remeslennikov , regular sets and counting in free groups , in _ combinatorial and geometric group theory _",
    ", series `` trends in mathematics '' , ( birkhauser verlag basel / switzerland , 2010 ) , pp .  93118 .                  k.  v.  mikhajlovskii and a.  yu .  olshanskii , some constructions relating to hyperbolic groups , in _ geometry and cohomology in group theory , _ london math . soc .",
    "lecture notes series , vol .",
    "252 ( cambridge university press , cambridge , 1998 ) , pp .  263290 ."
  ],
  "abstract_text": [
    "<S> in this paper we study double cosets of finite rank free groups . </S>",
    "<S> we focus our attention on cancellation types in double cosets and their formal language properties .    </S>",
    "<S> mathematics subject classification 2010 : 20e05 , 20f10 , 20f65    key words : double cosets , subgroups of free groups , regular subsets , bounded cancellations . </S>"
  ]
}