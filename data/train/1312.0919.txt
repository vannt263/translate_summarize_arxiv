{
  "article_text": [
    "reverberation mapping ( rm ) is a key technique for the study of active galactic nuclei ( agn ) .",
    "the technique is based on the temporal fluctuations of the central continuum source , and the subsequent response of the broad line region ( blr ) emission .",
    "the time delay between the continuum and the broad line fluctuations provides an estimate of the size of the blr , and can also be used to estimate the black hole mass @xcite .",
    "rm is a observationally intensive , requiring observations of an agn over a period of a few tens of days @xcite . as a result , many authors have studied the data analysis techniques involved in rm , and substantial advances have been made in recent years .",
    "the data analysis methods introduced range from those that attempt to infer the transfer function ( the distribution of lags in a single object , e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , the velocity - resolved transfer function @xcite , or the physical structure of the blr itself @xcite .",
    "there are many subtleties and challenges involved in reverberation mapping , that we will ignore for the purposes of this letter .",
    "we note two of them here for completeness .",
    "firstly , the mean lag @xmath2 , where @xmath3 is the normalised transfer function , is not equal to @xmath4 times the mean radius of the blr matter distribution , @xmath5 .",
    "secondly , the mean lag @xmath6 is not equivalent to the peak of the cross - correlation function , except in the case of very narrow transfer functions .",
    "direct physical modelling of the blr resolves these issues @xcite .",
    "recently , @xcite introduced an innovative approach to reverberation mapping where the results from multiple agn can be combined to yield inferences about the entire sample of agn , despite the fact that the constraints on any individual agn are poor . rather than accurately measuring @xmath0 in a single object ,",
    "it is possible to roughly measure @xmath0 for a large number of objects ( for example , by only measuring the blr emission line flux at two epochs ) , and to infer properties about the distribution of @xmath0 values in the sample of objects ( and hence in a broader population , if the sample can be considered representative ) .",
    "the data analysis approach of @xcite was based on an extension of the traditional cross - correlation method to @xmath7 separate objects . by `` stacking '' the cross - correlation functions ( ccfs ) from the @xmath7 objects in the sample , a peak appears which indicates a typical lag value in the sample of agn .",
    "however , this peak is difficult to interpret .",
    "specifically , the width of the peak may be influenced either by uncertainty ( due to the sparse data ) or due to a wide range of lags being present in the sample ( i.e. the sample of agn is diverse ) .    in this letter",
    ", we revisit the idea of `` stacked '' reverberation mapping ( i.e. using a sample of agn with sparse data to infer something about the sample ) from a bayesian perspective .",
    "we develop a bayesian hierarchical model @xcite . which allows us to calculate the posterior distribution for hyperparameters which describe the typical lag , and the diversity of the lags .",
    "in section  [ sec : multiple ] we discuss the general principles needed to combine information from multiple poorly - measured objects . in section  [ sec : single_object ] we discuss the methods used to infer the lag @xmath0 using rm data for a single agn .",
    "we then demonstrate the technique on simulated data in section  [ sec : data ] , and conclude in section  [ sec : conclusions ] .",
    "consider a sample of @xmath7 objects , each of which has parameters @xmath8 .",
    "if the @xmath9th object is analysed on its own , the inference about its parameters @xmath8 is described by a posterior distribution @xmath10 where @xmath11 is the prior distribution and @xmath12 is the likelihood function .",
    "if @xmath7 objects are analysed separately , inferences can be made about the diversity of @xmath8 across the sample .",
    "however , these inferences may be incorrect due to the implicit assumption that the prior for all of the @xmath13 is independent @xcite .",
    "a hierarchical model may be used to overcome this problem .    in a hierarchical model , the prior for the parameters @xmath13",
    "is created by introducing hyperparameters @xmath14 such that the joint prior for @xmath14 and the @xmath13 is : @xmath15 the implied prior on the @xmath13 parameters is then @xmath16 which may imply that the @xmath17 values are `` clustered '' around some typical value .",
    "the posterior distribution for @xmath13 and the hyperparameters @xmath14 given the data @xmath18 , is then @xmath19    it is possible to consider the data for all @xmath7 objects as one big data set and infer the hyperparameters @xmath14 and the parameters of all objects @xmath13 simultaneously .",
    "however , this can be computationally prohibitive . in some circumstances",
    "it is tractable to analyse each object s data separately ( using a common prior @xmath11 ) and then post - process the results , reconstructing what the results of the hierarchical model would have been . in this letter",
    "we use this latter approach .",
    "the marginal posterior distribution for the hyperparameters @xmath14 is @xmath20\\label{eq : combine}\\end{aligned}\\ ] ] where the expectation is taken with respect to the individual object posterior of equation  [ eq : individual ] , and thus can be estimated using posterior samples from the posterior distributions for the individual objects .",
    "this result enables us to reconstruct the posterior distribution for the hyperparameters even though the individual object inferences were made without the hierarchical structure in the prior .",
    "this is essentially an importance sampling approximation to the full hierarchical model .",
    "one drawback of this approach is that it implies an independent ( non - hierarchical ) prior on any per - object nuisance parameters , which can sometimes adversely affect the results ( e.g. * ? ? ?",
    "* ) .    in section  [ sec",
    ": single_object ] we define a simple model for inferring the lag of a single agn from sparse rm data .",
    "we will use markov chain monte carlo ( mcmc ) to produce posterior samples for the lags of the @xmath7 objects , which can then be combined using equation  [ eq : combine ] to yield the posterior distribution for some hyperparameters describing the distribution of lags in the sample .",
    "if the continuum light curve of an agn is described by a function @xmath21 , then the line light curve @xmath22 is given by @xmath23 \\ , d\\tau\\end{aligned}\\ ] ] where @xmath3 is the transfer function ( assumed to be normalised ) , and @xmath24 and @xmath25 are response coefficients .",
    "the idea of reverberation mapping is to use noisy measurements of @xmath21 and @xmath22 to infer the transfer function @xmath3 or a summary of it such as the mean lag @xmath26 . throughout this letter",
    "we consider @xmath21 and @xmath22 in flux units , as opposed to magnitudes , and consider @xmath6 as the definition of `` the lag '' of an agn .",
    "the posterior distribution for the lag @xmath6 of a single object @xmath9 may be obtained by fitting the following model .",
    "we assume , for simplicity , that the transfer function is uniform between limits @xmath27 and @xmath28 , where @xmath29 : @xmath30\\\\ 0 , & \\textnormal{otherwise } \\end{array}\\right.\\end{aligned}\\ ] ] and our goal is to measure the mean lag : @xmath31 note that inferring @xmath6 from the data requires that we marginalise over an infinite number of nuisance parameters describing the behaviour of @xmath21 at unobserved times @xcite .",
    "the prior for the underlying time variation of the continuum emission is a continuous autoregressive process of order 1 , or a car(1 ) model .",
    "these models have been studied extensively for agn variability ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this marginalisation can be done either analytically or inside mcmc .",
    "we used the latter approach for simplicity .",
    "we discretised time using ten time bins per day , and have a discrete continuum light curve @xmath32 , included in the model as a set of unknown parameters .",
    "the prior for these parameters is : @xmath33 for @xmath34 .",
    "this is the discrete ar(1 ) model from time series theory .",
    "@xmath35 describes the mean level of the continuum light curve , @xmath36 controls the size of the short - term fluctuations , and @xmath37 controls the correlation timescale ( the timescale itself is given by @xmath38 ) .    for the likelihood ( or sampling distribution , really the prior for the data given the parameters ) we made the conventional assumption of `` gaussian noise '' : @xmath39    we used vague priors for the parameters of the single - object model . in practice",
    "these could be made substantially narrower .",
    "we chose a log - uniform prior for @xmath40 ( the agn variability timescale ) between @xmath41 and @xmath42 days , a log - uniform prior for @xmath36 ( the size of the short - term fluctuations ) between @xmath43 and @xmath44 flux units , a cauchy(0 , 100 ) prior for @xmath35 ( the mean flux level of the agn ) , a log - uniform prior for @xmath28 ( the upper limit of the transfer function ) between @xmath45 and @xmath46 days , a uniform prior for @xmath27 ( the lower limit of the transfer function ) between 0 and @xmath28 , a log - uniform prior between @xmath43 and @xmath44 for the response coefficient @xmath24 and a cauchy(0 , 100 ) prior for the second response parameter @xmath25 .    to implement the mcmc for a single object",
    ", we implemented our model in the stan sampler @xcite and diffusive nested sampling @xcite . due to the large number of parameters , multiple modes , and strong correlations in the posterior distribution",
    ", we found that diffusive nested sampling was more effective than stan .",
    "note that our single - object model is already an improvement over standard cross - correlation techniques and is similar to the approach used by @xcite .",
    "to test our hierarchical model , and compare it to the stacked cross - correlation function , we simulated data from a sample of 100 agn .",
    "we assumed the continuum flux for each object fluctuates around a mean value @xmath47 in arbitrary units .",
    "the variability timescales @xmath40 were simulated from a very broad log - uniform distribution ( i.e. a uniform distribution for @xmath48 ) with a lower limit of 10 days and an upper limit of @xmath49 days .",
    "the variability amplitudes @xmath36 were also simulated from a log - uniform distribution with lower limit of 0.2 flux units and an upper limit of 1 flux unit .",
    "this implies some objects are more variable than others , as is typical in reverberation mapping .",
    "each object in the sample had its own transfer function parameters .",
    "the upper limit @xmath28 of the transfer function was simulated using a log - normal distribution with a median value of 10 days , and the standard deviation of @xmath50 was 0.3 .",
    "given @xmath28 , @xmath27 was simulated from a uniform distribution between @xmath51 and @xmath28 .",
    "the resulting distribution of lags @xmath52 is very well approximated by a lognormal distribution with a median of 7.4 days and width ( quantified by the standard deviation of @xmath53 ) of 0.157 ( these two quantities are the ones we will infer using the hierarchical model ) .",
    "the response amplitudes @xmath24 and @xmath25 were set to 0.5 and 0 respectively , for all objects .",
    "note that the distribution of the parameters of the 100 objects is not the same as the priors used when analysing them with the single - object model .",
    "the measured data for each of the 100 agn was continuum flux measurements , once per day , for 100 days .",
    "the standard deviation of the measurement noise is 1 flux unit ( i.e. 2% ) .",
    "the line data is measured on only two days , with times selected from a uniform distribution between @xmath54 and @xmath55 days ( i.e. corresponding to the latter half of the continuum data ) .",
    "the flux of the line data is typically about half that of the continuum data ( since @xmath56 for all objects ) , and the measurement noise for the line data is 0.25 flux units , or about 1% . see figure  [ fig : data ] for three illustrative data sets from the sample .     for any of these objects",
    "( although there is some information available ) . see figure  [ fig : example_posteriors ] for the @xmath6 posterior distributions for these three data sets .",
    "[ fig : data ] ]    we computed the stacked cross - correlation function for the 100 data sets .",
    "the cross - correlation function for a single object is defined as in @xcite . for a lag bin between @xmath0 and @xmath57 the amount of cross correlation",
    "is calculated by looping over pairs of points ( one selected from the continuum data set , and another from the line data set ) , and accumulating mass when the lag between the two points is between @xmath0 and @xmath57 .",
    "@xmath58\\right ) } { \\sum_{i=1}^{n_y}\\sum_{j=1}^{n_l } \\mathds{1}\\left((t_{l_j } - t_{y_i } ) \\in [ \\tau , \\tau + \\delta]\\right)}\\end{aligned}\\ ] ] the denominator is the number of pairs of points that fall within the lag range being considered , @xmath59 $ ] , denoted @xmath60 by @xcite .",
    "the stacked cross - correlation function for @xmath7 objects is sum of the ccfs of the individual objects . in figure",
    "[ fig : ccf ] , we show the stacked ccf ( on a log scale ) from our 100 simulated agn data sets . there is a clear peak around 10 days , and the full width at half maximum , while not strictly well defined , is roughly 0.25 dex .",
    "days , but the stacked ccf has a large width .",
    "it is difficult to interpret the cause of this width , and to determine whether the width is due to uncertainty or diversity in the sample of agn .",
    "these difficulties motivate the hierarchical bayesian model .",
    "[ fig : ccf ] ]    as the data does not contain measurements at all possible time lags , the stacked ccf will always require some smoothing . here",
    ", the smoothing is supplied by the choice of a bin width @xmath61 .",
    "the stacked ccf has a substantial width .",
    "one weakness of the stacked ccf method is that it is not clear whether this width is caused by real diversity in the sample of agn , or whether it is simply caused by the difficulty in measuring the lag @xmath6 of an object with such sparse data .",
    "by contrast , the hierarchical bayesian approach clearly separates these two concepts .    to implement the hierarchical bayesian approach on the simulated data",
    ", we first used the single - object model on each object .",
    "the results for three objects ( the same three objects shown in figure  [ fig : data ] ) are plotted in figure  [ fig : example_posteriors ] . due to the sparse data",
    ", there is a large amount of uncertainty about the value of @xmath6 for each system .",
    "some objects do not allow any real measurement of @xmath6 , but some do , as a result of fortuitous variability of the continuum .     for three objects whose",
    "data sets are shown in figure  [ fig : data ] .",
    "these posteriors were obtained by analysing each object separately with the single - object model . for the first object , there is a moderate `` detection '' of a lag at about 10 days ( although there is a small second mode above 100 days , which can be understood by inspecting the data in figure  [ fig : data ] ) .",
    "the second object s lag was not well constrained , and the third object s data only provided an upper limit on its lag .",
    "[ fig : example_posteriors ] ]    finally , we combined the results from the single - object model into an inference about hyperparameters @xmath62 and @xmath63 describing the central value and the diversity of @xmath6 respectively , using the result of equation  [ eq : individual ] .",
    "this requires us to know the prior @xmath64 implied by the simple - object model , since we did not assign the prior directly to @xmath6 but indirectly through @xmath27 and @xmath28 .",
    "the prior for @xmath6 in the single - object model is very well approximated by a log - uniform distribution .    since lags",
    "@xmath6 are positive , our assumption for the prior on @xmath6 given the hyperparameters is a lognormal distribution with median @xmath62 and width ( standard deviation of @xmath53 ) @xmath63 : @xmath65    the joint posterior distribution for @xmath62 and @xmath63 , given the data from @xmath66 agn , is shown in figure  [ fig : posterior ] .",
    "the prior for @xmath62 and @xmath63 was uniform inside the rectangle shown , and the posterior distribution covers a much smaller area , indicating that the data contained a lot of information about the hyperparameters .",
    "the true values used to generate the simulated data are denoted by the star symbol in figure  [ fig : posterior ] , and is typical of the posterior distribution , as it should be .     and @xmath63 , hyperparameters describing the distribution of @xmath6 values in the sample .",
    "the prior distribution was uniform over the area shown .",
    "the true solution @xmath67 is indicated by the white star symbol .",
    "@xmath68 corresponds to a typical lag of 7.4 days.[fig : posterior ] ]    the marginal posterior distribution for @xmath62 is shown in figure  [ fig : posterior2 ] along with the posterior predictive distribution for the `` next '' @xmath6 value .",
    "the inference about @xmath62 can be summarised as @xmath69 ( consistent with the known input value of @xmath70 ) , and the prediction about @xmath53 may be summarised as @xmath71 . the bayesian approach has clearly separated the uncertainty about @xmath62 from the diversity of the sample , described by @xmath63 .    , the hyperparameter describing the center of the distribution for @xmath72 ,",
    "is plotted as the solid line .",
    "[ fig : posterior2 ] ]    note that our method for combining individual object results into an inference about the population ( section  [ sec : multiple ] ) assumes that the hierarchical prior applies to only a single parameter ( in our case @xmath6 ) .",
    "if we incorporate additional information by using a hierarchical prior for the other model parameters , allowing us to detect ( for example ) that all of the response amplitudes @xmath24 were equal to 0.5 , we may be able to make more accurate inferences .",
    "however , this would increase the complexity of the method and the computational expense .",
    "reverberation mapping campaigns are observationally intensive , yet potentially very informative .",
    "this has led to research into rm data analysis techniques , as well as less costly observing strategies .",
    "the recent approach of @xcite demonstrated that it is possible to combine information from many sparsely - measured agn and infer properties of the sample rather than insisting on accurate results about a particular object .    in this letter",
    "we extended the approach of @xcite by implementing a bayesian hierarchical model for the data analysis .",
    "the main advantage of this approach is a clear interpretation of the output , which is a posterior distribution for hyperparameters describing the sample of agn .",
    "we demonstrated this approach on a simulated data set consisting of 100 agn with well - measured continuum light curves but sparsely measured ( two epochs per agn ) broad line light curves .",
    "for the simulated data set we were able to obtain an inference on @xmath62 , a hyperparameter describing the typical value of the lag , to within 0.047 dex ( 1-@xmath63 uncertainty ) , whereas the stacked cross - correlation function had a fwhm of @xmath73 0.25 dex .",
    "this is possible because a subset of the objects in the sample will have a measureable lag .",
    "we hope this approach will facilitate informative studies of samples of agn .",
    "it is a pleasure to thank tommaso treu , anna pancoast ( ucsb ) , and brandon kelly ( ucsb ) for many useful conversations about reverberation mapping .",
    "the stan ( mc-stan.org ) team provided helpful advice about the use of their software .",
    "bjb is partially supported by the marsden fund ( royal society of new zealand ) .",
    "we are grateful to the referee , stephen fine , for his helpful comments ."
  ],
  "abstract_text": [
    "<S> reverberation mapping ( rm ) is an important technique in studies of active galactic nuclei ( agn ) . </S>",
    "<S> the key idea of rm is to measure the time lag @xmath0 between variations in the continuum emission from the accretion disc and subsequent response of the broad line region ( blr ) . </S>",
    "<S> the measurement of @xmath0 is typically used to estimate the physical size of the blr and is combined with other measurements to estimate the black hole mass @xmath1 . </S>",
    "<S> a major difficulty with rm campaigns is the large amount of data needed to measure @xmath0 . </S>",
    "<S> recently , @xcite introduced a new approach to rm where the blr light curve is sparsely sampled , but this is counteracted by observing a large sample of agn , rather than a single system . </S>",
    "<S> the results are combined to infer properties of the sample of agn . in this letter </S>",
    "<S> we implement this method using a hierarchical bayesian model and contrast this with the results from the previous stacked cross - correlation technique . </S>",
    "<S> we find that our inferences are more precise and allow for more straightforward interpretation than the stacked cross - correlation results .    </S>",
    "<S> [ firstpage ]    galaxies : active  methods : data analysis </S>"
  ]
}