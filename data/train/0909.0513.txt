{
  "article_text": [
    "eulerian methods have been the tool of choice in computational fluid dynamics for over five decades .",
    "many successful eulerian methods in popular use descended from the @xcite scheme that combines the analytical riemann solution of the euler equations with the upwind scheme of @xcite to numerically evolve fluid systems on a discretized mesh .",
    "these godunov - type schemes , as such methods are commonly called , have been further engineered to include higher - order spatial reconstructions of the fluid distribution based on piecewise linear ( e.g. , * ? ? ?",
    "* ) , parabolic ( e.g. , ppm , * ? ? ?",
    "* ) , or , more generally , higher - order weighted essentially non - oscillatory interpolation schemes @xcite .",
    "eulerian methods have also become quite popular for addressing problems in newtonian astrophysics ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , especially in the framework of adaptive mesh refinement ( amr , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "given their wide - spread use in computational astrophysics , an understanding of the fundamental limitations of such codes is important for interpreting the astrophysics of hydrodynamical systems that can not be accessed through laboratory experiments .    while eulerian astrophysical simulation codes routinely demonstrate excellent performance on idealized test cases , some shortcomings of these methods are known ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "recently , several studies have focused on the differences produced by eulerian codes in reference frames moving with different velocities with respect to the computational grid .",
    "@xcite emphasized the role of diffusion in altering the development of kelvin - helmholtz instabilities in the flash code @xcite simulations of bouyant , hot bubbles .",
    "@xcite simulated the advection of otherwise static , self - gravitating gas clouds , and showed that the performance of flash and the ppm version of enzo @xcite in maintaining the centroid and density profile of the gas cloud depended on its velocity with respect to the static computational grid .",
    "most recently , @xcite motivated the development of the new lagrangian - eulerian moving - mesh code arepo by demonstrating that with fixed grid godunov solvers kelvin - helmholtz instabilities may not develop and evolve properly when the interface between the two fluids has a large bulk velocity with respect to the grid .",
    "these apparent failures of eulerian codes have been discussed in terms of `` galilean non - invariance , '' which in this context means that for initial conditions that move with different uniform bulk velocities with respect to the computational grid but are otherwise identical , numerical solutions obtained with eulerian codes may depend on the chosen bulk velocity .    given the ubiquity of supersonic bulk motions in astrophysical scenarios , these results are potentially damning for the application of stationary mesh eulerian codes to galaxy and structure formation .",
    "the purpose of this work is to critically examine the performance of eulerian hydrodynamical codes for simulating systems with supersonic bulk motions , and to clarify both the nature and meaning of the velocity - dependent differences highlighted in previous studies .",
    "specifically , we use the eulerian mesh codes art @xcite and enzo @xcite to simulate the development of kelvin - helmholtz instabilities in test calculations similar to those presented in @xcite .",
    "we employ statistical measures to quantify convergence and error of the calculations in addition to an extensive visual comparison of the solutions .",
    "we show that the effects discussed above are not a consequence of galilean non - invariance of riemann solvers , but rather a result of diffusive errors accumulated during advection of fluid through the computational grid .",
    "the effects of these errors are thus particularly acute in systems where perturbations and the interface between fluids are under - resolved .",
    "we demonstrate that with a proper initial setup the eulerian methods produce a convergent solution at large bulk velocity as the resolution of the simulation is increased .",
    "the paper is organized as follows . in ",
    "[ section : diffusion ] , we discuss the origin of numerical diffusion in the eulerian method and illustrate its effects using simulations of contact discontinuities .",
    "readers familiar with the effects of numerical diffusion should proceed to  [ section : kh ] , where we review previous simulations of kelvin - helmholtz instabilities and the related claims of galilean non - invariance in eulerian methods . in ",
    "[ section : kh_abel ] , we present a new , better - behaved test calculation of kelvin - helmholtz instability and study the development of the instability over a range of resolutions and supersonic bulk motions .",
    "we study the statistical and error properties of the kelvin - helmholtz simulations and use these statistics to critically examine the apparent galilean non - invariance of eulerian simulation codes .",
    "we discuss our results in  [ section : discussion ] and present a summary in  [ section : summary ] .",
    "computational eulerian hydrodynamical codes calculate the evolution of fluid systems using a discretized approximation to euler s equations .",
    "when modeling the conservative form of euler s equations , the change in quantities like density or energy integrated over cell units of size @xmath0 in the discretized mesh over a time step @xmath1 will correspond to the flux of those quantities across the cell boundaries over the same time interval .",
    "fluid interactions between cells then fundamentally involve calculations of the fluxes , which can be approximated using solutions to the riemann problem ( i.e. , * ? ? ?",
    "* ) or through other means ( e.g. , the flux corrected methods of * ? ? ? * and @xcite , see also chapter 21 of @xcite ) .",
    "since these numerical approximations to the physical fluxes exchanged between fluid volumes during the time interval @xmath1 are discretized , there is a truncation error associated with the numerical approximation . missing or extraneous higher order terms in the discretized numerical approximation can appear as an effective viscosity or thermal conductivity and lead to the smearing or dispersion of features in fluid flow",
    ". we will refer to smearing effects as numerical diffusion , while effects that change the wave speed of features in the fluid will be labeled numerical dispersion .",
    "clear discussions about the effects of numerical diffusion can be found in @xcite and @xcite .",
    "the strength of numerical diffusion depends on the method chosen to model fluid systems .",
    "lagrangian methods integrate the convective derivative form of the mass conservation equation directly , and therefore suffer from small diffusive truncation errors .",
    "eulerian methods calculate the advective term in the mass conservation equation explicitly , which can lead to an appreciable diffusive truncation error upon discretization . some eulerian methods , such as flux - corrected transport algorithms ( e.g. , * ?",
    "* ) , include an explicit numerical diffusion term proportional to a second spatial derivative that owes to their forced conservative and non - negative properties ( the `` flux correction '' refers to the explicit artificial anti - diffusion used to correct this truncation error term ) .",
    "for godunov - type methods based on riemann solvers , differences in the amount of numerical diffusion can arise from the approximations made in constructing the discrete representation of the local fluid flow on the computational mesh . in godunov - type methods ,",
    "the numerical flux between cells is determined by the known solution of the piecewise - constant riemann problem . the resulting flux across the cell face",
    "is then determined by the properties of fluid states on either side of the face , the cell size , and the time step size .",
    "resolution determines the region used to average the fluid properties for finding the initial states in the riemann problem .",
    "the averaging procedure introduces numerical diffusion , and can be counter - acted by higher spatial resolution . improving",
    "the quality of the approximation to the fluid states used in the riemann problem can also decrease the amount of numerical diffusion , so the method used to model the shape of the fluid flow on the grid can change the diffusivity of the method . for instance , the local flow can be approximated by constant @xcite , linear @xcite , parabolic @xcite , or higher - order piecewise polynomial @xcite interpolations on the discrete mesh .",
    "higher - order interpolations improve the local approximations used in reconstructing the fluid flow and calculating the initial states to the riemann problem , and therefore will suffer from less numerical diffusion . in general ,",
    "the strength of numerical diffusion will also depend on the local flow velocity .",
    "this velocity dependence arises because , in the presence of a large advective flow , more time steps are used and more local averages are performed .",
    "additionally , with a large bulk velocity a larger ( lagrangian ) region of the fluid is averaged to calculate the input states for the riemann problem .",
    "we can illustrate how numerical diffusion affects the shape of the local fluid distribution by simulating the advection of contact discontinuities . in the absence of numerical diffusion ,",
    "the square wave should be perfectly advected and the contact discontinuities would remain sharp .",
    "however , as these simple tests will illustrate , numerical diffusion will act to soften the contact discontinuities in a resolution- and velocity - dependent manner .",
    "the effects of numerical diffusion in these tests will prove to be informative for simulations of the kelvin - helmholtz instability in  [ section : kh ] and [ section : kh_abel ] .",
    "for the simple problem of the advection of a waveform with a constant velocity @xmath2 , the advected quantity @xmath3 ( e.g. , the density ) obeys the partial differential advection equation @xmath4 as a function of position @xmath5 and time @xmath6 .",
    "the solution of this equation is simply @xmath7 , as the initial waveform advects with a constant velocity @xmath2 .",
    "however , as discussed by ( * ? ?",
    "* see , e.g. , his ",
    "5.2.1 ) , numerical methods for solving the advection equation ( or euler s equations ) actually solve a slightly _ modified _ equation ( to some approximate order ) .",
    "for example , in the case of the simple first - order upwind scheme of @xcite the modified equation solved by the numerical method is @xmath8 in this advection - diffusion equation the right - hand side acts as a form of numerical diffusion with a diffusion constant @xmath9 .",
    "the solution of equation [ equation : advection_modified ] will differ from the solution of equation [ equation : advection ] if @xmath10 , and will be characterized by a progressive smearing of the original waveform .",
    "the detailed behavior of the solution to equation [ equation : advection_modified ] will then depend on the diffusion constant @xmath9 .",
    "for the first - order upwind scheme of @xcite , the diffusion constant is @xmath11 where @xmath12 is the courant number ( numerical stability requires @xmath13 ) , @xmath1 is the timestep , and @xmath0 is the spatial grid size .",
    "one then expects that the diffusive error induced through the truncation of equation [ equation : advection ] into equation [ equation : advection_modified ] by the discretization of the numerical scheme will decrease with the grid size but increase with the advective velocity . as @xmath14 or @xmath15 , the pure advection equation ( [ equation : advection ] ) is recovered .",
    "higher - order eulerian methods ( such as those used in this paper ) can change the form of equations [ equation : advection_modified ] or [ equation : diffusion_constant ] , and also introduce dispersive terms that scale as high - order odd - power spatial derivatives . however , as we will show , in higher - order methods the strength of numerical diffusion will still increase with advection velocity and decrease with increasing spatial resolution . in the remainder of this section , we will use square wave advection simulations to illustrate these numerical features of eulerian methods .    unless otherwise noted",
    ", the simulations presented in this paper use the eulerian code art with piecewise - linear reconstruction and an exact riemann solver @xcite , based on the adaptive refinement strategy developed by @xcite . for the following square wave advection simulations ,",
    "time steps were determined using the courant - friedrichs - lewy condition with a parameter @xmath16 .",
    "art uses a dual - energy formulation similar to that of @xcite , such that the internal energy equation is followed separately when the local flow is kinetic - energy dominated and effectively pressureless .",
    "we have checked that similar results can be obtained using an entropy equation instead of the internal energy in the dual - energy formulation , as discussed by @xcite and @xcite .",
    "the one - dimensional square wave density is initialized with @xmath17 for positions @xmath18 and @xmath19 for @xmath20 .",
    "the system has a constant pressure @xmath21 and an adiabatic index @xmath22 . in a first set of tests ,",
    "the wave is advected to the right with a velocity @xmath23 in a periodic box such that the wave travels through the box ten times over the final simulation time @xmath24 . to illustrate the role of resolution on the strength of numerical diffusion ,",
    "the simulation is performed with grid resolutions of @xmath25 $ ] .",
    "the left panel of figure [ fig : cd ] shows the final square wave density distribution at time @xmath24 as a function of resolution , compared with the initial distribution ( thin solid line ) . at low resolution ( @xmath26 ,",
    "red dashed dotted line ) , numerical diffusion smears out each contact discontinuity over approximately twelve cells , or roughly @xmath27 of the computational volume .",
    "as the resolution increases , the contact diffuses out over more cells ( @xmath28 cells for @xmath29 , black solid line ) but less of the computational volume ( @xmath30 for @xmath29 ) .",
    "the contact is physically better resolved with increasing grid size and the diffusive error reduced .",
    "the right panel illustrates the additional error induced by increasing the velocity by a factor of @xmath31 ( for @xmath29 , blue dotted line ) .",
    "the highest - resolution simulation has an increased error that degrades the effective resolution of the simulation by a factor @xmath32 ( comparable to the @xmath33 simulation with @xmath23 shown in the left panel ) .    in these one dimensional simulations , the diffusive error can be mitigated through the use of an artificial compression ( ac ) technique .",
    "similar in spirit to explicit anti - diffusion terms added to the flux corrected methods , ac simply increases the slopes used in the reconstruction of the fluid on the mesh near contact discontinuities .",
    "this approach reduces the effective second order truncation error by limiting the influence of the outer cells in the computational stencil .",
    "we use the slope steepening approach of @xcite , as implemented by @xcite for linear reconstruction , and refer the reader to  2.2 of @xcite for details ( see also * ? ? ?",
    "* for an implementation of slope steepeners for ppm ) .",
    "the right panel of figure [ fig : cd ] shows the results for a @xmath26 grid with bulk velocity @xmath23 and ac ( solid black line ) . with ac the @xmath26",
    ", @xmath23 results improve to be comparable to the @xmath33 , @xmath23 results without ac .",
    "if the same @xmath26 simulation with ac is performed but with the bulk velocity increased to @xmath34 ( or mach @xmath35 , green dashed line ) , the results are striking .",
    "remarkably , with artificial compression the diffusive error becomes almost independent of the bulk velocity and the @xmath26 , @xmath34 simulation has almost the same diffusive error as the @xmath26 , @xmath23 simulation ( and is superior to the @xmath29 , @xmath36 simulation at @xmath37 smaller bulk velocity ) , even as the @xmath26 , @xmath34 simulation has traversed the computational volume @xmath38 times and executed @xmath39 individual timesteps . however , a dispersive error has been introduced that changes the square wave period by @xmath40 and that we have removed in figure [ fig : cd ] .",
    "while this fractional dispersive error is only @xmath41 , the error grows to an appreciable fraction of the period by @xmath24 ( as discussed by @xcite , this dispersive error may also depend on the frequency of the wave form ) .",
    "these simulations demonstrate the salient effects of numerical diffusion on the properties of fluid distributions simulated with eulerian codes .",
    "diffusion limits the sharpness of fluid distributions , and the averaging of fluid properties within cells does not preserve local discontinuities .",
    "the effects of diffusion can be mitigated through the use of higher spatial resolution to improve the local reconstruction of the fluid distribution , or through intrinsically less - diffusive methods .",
    "the presence of a bulk advective velocity in the fluid also increases numerical diffusion by increasing the number of time steps and local averages of the fluid distribution , and can degrade the effective resolution of the computational grid .",
    "however , the simulation results naturally improve with increasing grid resolution . with these diffusive properties of eulerian simulations in mind",
    ", we will now examine simulations of the development of fluid instabilities in shearing flows .     for positions @xmath18 and @xmath19 for @xmath20 , and a constant pressure @xmath21 ( thin black line ) .",
    "the left panel shows the contact discontinuity advected with velocity @xmath23 simulated with resolutions @xmath26 ( red dash - dotted line ) , @xmath33 ( green dashed line ) , @xmath42 ( blue dotted line ) , and @xmath29 ( thick black line ) after time @xmath24 .",
    "the numerical diffusive error increases with decreasing resolution , and tends to smear out the contact discontinuities .",
    "the right panel shows the same square wave advected for a time @xmath24 using a resolution of @xmath26 with advective velocities of @xmath23 ( thick black line ) and @xmath34 ( dashed green line ) , but including artificial compression in the form of slope steepeners @xcite . a phase error of @xmath43 in the @xmath26 , @xmath34 has been corrected .",
    "artificial compression limits makes numerical diffusive error roughly independent of velocity , even for advective flows with mach number @xmath35 .",
    "also shown is the @xmath34 simulation with @xmath29 ( blue dotted line ) , which has been completely smeared away by diffusive error .",
    ", width=317 ]",
    "the kelvin - helmholtz ( kh ) instability ( * ? ? ? * ; * ? ? ? * see especially chapter xi of @xcite ) is the unstable growth of perturbations at the interface between two fluid flows driven by shearing motions .",
    "perturbations between these fluid phases that grow and become unstable typically form waves that crest owing to the shearing motion in the fluid .",
    "the kinetic energy of the shearing motion powers the instability , and larger shear velocity gradients typically increase the proclivity for instabilities to develop . in the absence of viscosity and gravity , only inertia can exert a stabilizing influence on perturbations and damp oscillations before growth commences .",
    "numerical simulations of the kh instability previously studied in astrophysical contexts include the stability of interstellar clouds in a shearing flow @xcite , the stripping of gas from galaxies by an intercluster medium @xcite , the formation and ionization state of the magellanic stream @xcite , and the survivability of high - velocity clouds @xcite . here , we focus on numerical experiments of the kh instability in an idealized setting for testing the performance of static mesh eulerian codes in the presence of bulk flows , but our conclusions will weigh on the validity of the results of many such astrophysical studies .",
    "a common choice for the initial inhomogeneity that gives rise to the kh instability is two uniform fluids separated by a surface where the density and shearing velocities change discontinuously .",
    "the kh instability arising from perturbations about these initial conditions is studied in detail by @xcite and @xcite . for a surface discontinuity , the growth of any perturbations about the surface can be calculated from the euler equations by separating the solution into normal modes . as discussed by @xcite",
    ", instability will occur at a perfectly discontinuous interface regardless of the magnitude of the shearing velocity .",
    "for such initial conditions , this result holds generally for some minimum wavenumber , and in the absence of gravity or surface tension applies to _ all wavenumbers . _    the discontinuous , two - fluid kh instability has been used as a test simulation in recent years for evaluating the performance of hydrodynamical codes .",
    "@xcite studied the relative performance of smoothed particle hydrodynamics and eulerian grid codes in calculating the development of kh instabilities from two - fluid initial conditions .",
    "@xcite also studied kh instabilities in shearing , sharp interface between two fluids in two - dimensional simulations to test the performance of the eulerian scheme in the presence of bulk flows .",
    "the discontinuous , two - fluid kh instability simulations of @xcite were performed in a unit computational volume in the @xmath44 plane with periodic boundaries .",
    "the initial conditions consisted of a central fluid slab at @xmath45 with density @xmath46 and @xmath47 ( mach @xmath48 ) surrounded by a second fluid at @xmath49 with density @xmath50 and @xmath51 ( mach @xmath52 ) .",
    "the fluids were initialized in pressure equilibrium with @xmath53 and an adiabatic index of @xmath22 .",
    "a sinusoidal velocity perturbation in the @xmath54-direction of the form @xmath55\\right\\}\\nonumber,\\end{aligned}\\ ] ] with parameters @xmath56 , @xmath57 , and @xmath58 was added to provide a seed for the instability . for reference ,",
    "figure [ fig : kh_ics ] shows the density and shearing velocity initial conditions .",
    "we will refer to these discontinuous , two - fluid kh instability initial conditions as `` ics a '' . when discussing the mach number of any bulk motions",
    ", we will refer to the mach number relative to the sound speed in the dense fluid unless otherwise noted .",
    "-direction shear velocity ( right panel ) as a function of @xmath54-position . shown",
    "are the initial conditions for the springel ( 2009 ) kh simulations ( `` ics a '' , black line ) , as well as a new kh simulation with a smoothly - varying density and shear velocity ( `` ics b '' , dashed gray line ) .",
    "both simulations have additional @xmath54-direction velocity perturbations to seed the instability ( see text ) .",
    "the system has a constant pressure @xmath53 and adiabatic index @xmath22.,width=317 ]    @xcite evolved the system for a time @xmath59 using the new moving - mesh code arepo using an exact riemann solver @xcite in a fixed - mesh mode , and with the eulerian ppm code athena @xcite using the linearized solver of @xcite .",
    "the kh simulations presented in this paper use the eulerian code art , with the method described in ",
    "[ section : diffusion ] , unless otherwise noted . as is customary , the art code uses @xcite dimensional splitting to numerically integrate the multidimensional euler equations , but we have checked that using the unsplit solver of @xcite produces similar results .",
    "for the presented kh simulations , time steps were determined using the courant - friedrichs - lewy condition with a parameter @xmath16 , except near snapshot times where time steps were determined by requiring a simulation output every @xmath60 time interval .",
    "figure [ fig : kh_sequence ] shows the temporal evolution of this simulation calculated on a fixed mesh of size @xmath61 ( first row ) , @xmath62 ( second row ) , @xmath63 ( third row ) , and @xmath64 ( fourth row ) at times @xmath65 ( first column ) , @xmath66 ( second column ) , @xmath67 ( third column ) , and @xmath68 ( fourth column ) .",
    "a kh instability develops in each simulation , but the detailed structure of the growing instability differs between simulations with different grid size .",
    "the dominant structure in the kh instability is the @xmath56 mode seeded by the initial perturbations ( following equation [ equation : volker_perturbation ] ) .",
    "however , a secondary set of small - scale eddies that _ have not been seeded _ in the initial conditions also develop .",
    "the development of these small - scale instabilities that increase in complexity with increasing numerical resolution can be directly related to the chosen fluid interface . as noted by @xcite ,",
    "the discontinuous density and shearing velocity distributions of the initial conditions allow for perturbations of all wavenumbers to be unstable to growth .",
    "an increase in the resolution broadens the range of unstable wavelengths available for excitation by , e.g. , secondary waves generated by the seeded @xmath56 instability or numerical noise , and we further discuss these mechanisms below .",
    "as demonstrated by @xcite , the simulation of the initial conditions ics a changes dramatically if a uniform bulk flow is added to the fluid .",
    "figure [ fig : kh_vel_sequence ] shows the results of the simulation at @xmath59 of ics a with a bulk flow of @xmath23 ( mach @xmath69 ) in the @xmath54-direction with resolutions of @xmath26 ( left panel ) , @xmath33 ( middle panel ) , and @xmath70 .",
    "each of these panels can be compared directly with the results at @xmath59 for the same resolution in figure [ fig : kh_sequence ] and are clearly quite different .",
    "@xcite states that these differences are `` direct evidence for a violation of galilean invariance of the eulerian approach . ''",
    "although our results clearly confirm that the kh instability does not develop in the @xmath26 simulation , figure [ fig : kh_vel_sequence ] shows that the instability does develop at higher resolution and hints at a convergence toward a single prominent @xmath56 mode instability .",
    "while qualitative differences between the results of the kh instability simulation using initial conditions ics a are apparent in figures [ fig : kh_sequence ] and [ fig : kh_vel_sequence ] , a quantitative comparison would be preferable .",
    "a common characterization of a simulation with a known solution is the error norm , such as the @xmath71 error norm given by @xmath72 where @xmath73 is the number of computational cells , @xmath74 is a property of the @xmath75th cell , and @xmath76 is the `` true '' property of same cell in the known solution , and the summation runs over all @xmath73 cells .",
    "unfortunately , error norms are useless for evaluating the kh simulation of ics a because there is no convergence with increasing @xmath73 and no known solution .",
    "however , other useful statistical measures can be constructed to provide a quantitative gauge of the qualitative differences . for instance , the global correlation of the simulations at fixed time could be compared using , e.g. , pearson s product - moment coefficient .",
    "however , the instabilities develop over a limited range of the computational volume and simulations of ics a with qualitatively very different development of the instability would be highly correlated .",
    "a more useful , targeted statistic would track the growth and amount of mixing in the instability , but discriminate between the sharp features present in the simulations of figure [ fig : kh_sequence ] and the diffusive features present in figure [ fig : kh_vel_sequence ] .",
    "after some experimentation , a unit - free measure of the root - mean - squared fluctuations in the simulation at fixed @xmath54-position was found to provide a useful description of instability growth and complexity . for a property @xmath77 , the average @xmath78 and variance @xmath79 for each row in the computational mesh",
    "is calculated .",
    "the ratio @xmath80 is then averaged over the computational volume as @xmath81 / \\left [ \\int \\mathrm{d}y \\right].\\ ] ] we will refer to the quantity defined by equation [ equation : mixing_statistic ] as the `` mixing statistic '' .",
    "analogous mixing measures were used by @xcite . throughout the rest of the paper , when the @xmath71 error norm or mixing statistic are used to compare simulations of differing resolutions ,",
    "the simulations are rebinned to the minimum resolution ( usually @xmath26 ) using the idl function `` congrid '' with the cubic interpolation value set to @xmath82 @xcite .",
    "simulations with bulk flows are shifted to align with the computational grid as if the measurements were performed in the moving frame .    ) .",
    "shown is a dimensionless measure of the root - mean - squared density ( left panel ) and entropy ( right panel ) fluctuations from the growing kh instabilities in simulations with @xmath26 ( black ) , @xmath33 ( blue ) , and @xmath70 ( red ) resolution and without bulk flows , as well as @xmath26 ( black dashed ) , @xmath33 ( blue dashed ) , and @xmath70 ( red dashed ) simulations with @xmath23 ( mach @xmath69 ) velocity bulk flow along the @xmath54-direction . in the simulations without bulk flows , the instabilities grow at different rates and by different amounts . in the simulations with bulk flows , the instabilities become better defined with increasing resolution but have yet to converge at @xmath70 resolution .",
    "the instability mostly fails to develop for the lowest resolution ( @xmath26 ) simulation with @xmath23 bulk flows , as noted by springel ( 2009 ) .",
    ", width=317 ]    figure [ fig : kh_statistics ] shows the mixing statistic for the kh instability simulation of ics a as a function of time .",
    "shown are the mixing statistics for the density @xmath3 and the entropy function @xmath83 for simulations with @xmath26 , @xmath33 , and @xmath70 both with and without a bulk flow velocity of @xmath23 ( mach @xmath69 ) in the @xmath54-direction .",
    "the mixing statistic quantifies the qualitative impression that less mixing occurs in the simulations with a large bulk flow , and that the vertical extent of the instabilities is less than in the simulations without a bulk flow .",
    "the instabilities grow at different rates depending on the resolution , which occurs because perturbations with different wavenumbers @xmath84 grow at different rates .",
    "the characteristic kh instability growth time scales as @xmath85 , so the instabilities in the highest resolution simulation ( with larger available wavenumbers ) grow the fastest . in the @xmath33 and @xmath70 simulations without bulk flows ,",
    "the primary @xmath56 instabilities seeded in the initial conditions actually crest and meld with smaller scale instabilities resulting from interactions with waves that have traveled across the computational volume .",
    "the cresting of the waves corresponds to the decrease in the mixing statistic for the @xmath33 and @xmath70 near time @xmath24 . for the simulations with bulk flows , the instability is greatly suppressed for @xmath26 but does develop at higher resolutions . in the @xmath33 and @xmath70 simulations with bulk flows",
    "the development of the instability is somewhat slower than in the simulations without the bulk flows , but faster than in the static @xmath26 simulation .            given these results , one may ask is there a correct solution to which the simulations should converge with increasing resolution for any bulk velocity ? the simulations shown in figure [ fig : kh_sequence ] cover a factor of @xmath86 in resolution , and each increase in resolution is followed by a corresponding increase in the complexity of the small - scale structure of the instability .",
    "details of the structures , however , are quite different in each case as is their overall evolution shown in fig .",
    "[ fig : kh_abel_sequence ] . as such",
    ", the solution does not converge with increasing resolution to any well - defined configuration in the simulations with this setup .",
    "this result is not surprising as the initial conditions with the sharp interface allow all perturbation modes , both real and numerical , to grow @xcite .",
    "the modes excited by wave interactions or seeded by numerical noise depend on the actual numerical resolution of the simulation and will be different at different resolutions .",
    "this result is true not only for the static mesh eulerian calculations but also for the calculations with the moving mesh code presented by @xcite .",
    "we therefore conclude that the system ics a can not reliably be used for convergence studies or for the tests studying the development of a kh instability in the presence of a uniform bulk flow .",
    "the change in the evolution in the presence of a bulk flow has been characterized as evidence for galilean non - invariance of the eulerian methods @xcite .",
    "however , the cause of the differences has not been unambiguously identified .",
    "first , as stated above , the simulations without bulk flows do not converge with increasing resolution .",
    "the cause of this lack of convergence is the excitation of small - scale modes by secondary waves driven by the initially seeded @xmath56 perturbation .",
    "these waves travel through the low - density fluid , cross the computational volume , and interact with the dense fluid .",
    "the interaction between the waves and the dense fluid drives high - frequency oscillations that quickly become unstable . at high resolution",
    ", numerical noise can contribute additional small scale structure to these perturbations .",
    "these high - frequency modes can become unstable owing to the sharp transition between the two fluids in the initial conditions .",
    "if these small - scale instabilities were suppressed , only the initially seeded @xmath56 mode would grow .    in the simulations with a bulk flow , the sharp transition between the two fluids",
    "is smeared owing to diffusive errors generated as fluid is advected through the grid  an inherent property of all eulerian schemes , including those not based on riemann solvers . as discussed by @xcite ,",
    "the stability of kelvin - helmholtz perturbations of different wavenumbers depends strongly on the density and shearing velocity gradient present between the two fluids .",
    "while the connection between the instability of a given mode and the nature of the gradient can be extremely complicated , as a rule of thumb in the absence of gravity and surface tension shallower gradients lead to an effective maximum unstable wavenumber of order the inverse of the spatial scale of the gradient ( see the discussion in  102 of * ? ? ?",
    "the numerical diffusion in the eulerian scheme is strong in the simulations with a large bulk flow and simply imposes stability on small - scale perturbations . in the simulations with large bulk flows ,",
    "only the initially seeded @xmath56 mode grows with time .",
    "the lowest resolution ( @xmath26 ) simulation with a bulk flow has strong enough numerical diffusion that the @xmath56 is not well resolved and diffuses away before the shearing flow can cause the wave to crest .",
    "the results of these kelvin - helmholtz simulations suggest that numerical diffusion leads to change in the available modes that can grow into instabilities for the chosen initial conditions .",
    "the approximation of the physical laws does not explicitly change , but the error induced by numerical diffusion simply alters the physical system being modeled . while this new interpretation of the origin of the differences in this kelvin - helmholtz simulation is straightforward , it is unwieldly to test in this case because of the somewhat pathological choice of initial conditions .",
    "if the advection - related diffusion is the origin of the `` galilean non - invariance '' of the eulerian schemes , then the error of a numerical solution will depend on the bulk velocity ( because the integration to a given time will be carried out with more time steps ) , but should decrease with increasing resolution .",
    "we discuss this behavior further in ",
    "[ section : discussion ] .",
    "since the error norm of ics a is ill - defined in the case without bulk flows a useful error analysis would be difficult .",
    "we will need to choose a different set of initial conditions for a detailed error analysis of kh instabilities in the presence of strong bulk flows .",
    "as discussed in  [ section : kh ] , the numerical study of kelvin - helmholtz instabilities can be complicated by the choice of initial conditions .",
    "if large wavenumber perturbations are unstable , the growth of the instabilities can be strongly influenced by the development of small scale modes seeded or affected by resolution . as a result ,",
    "the simulation may not converge with increasing resolution .",
    "a reasonable solution to this problem is to choose the initial conditions such that the stratification of the two fluids is not sharp but gradual .",
    "such a setup approximates the interfaces that can arise in simulations of real astrophysical systems where boundaries between fluids are not perfectly discontinuous .",
    "we therefore alter the kelvin - helmholtz initial conditions from those used by @xcite through the use of a `` ramp '' function @xmath87}\\frac{1}{1 + \\exp [ 2(0.75-y)/\\delta_{y}]},\\ ] ] where we set the parameter @xmath88 .",
    "the new density distribution is initialized to @xmath89,\\ ] ] and the shearing velocity distribution is changed to @xmath90.\\ ] ] the parameter values remain @xmath46 , @xmath50 , @xmath47 , and @xmath91 , with a constant pressure @xmath53 and adiabatic index @xmath22 .",
    "the initial velocity perturbation is set to @xmath92 with @xmath93 as before and @xmath94 .",
    "a lower frequency perturbation is chosen to minimize the interaction between instabilities after they become nonlinear , but we have checked that our conclusions are not affected by this choice of perturbation ( e.g. , using @xmath56 leads to similar conclusions , see  [ section : discussion ] for a discussion ) .",
    "we will refer to these initial conditions as `` ics b '' , and the corresponding density and shearing velocity distributions are compared with ics a in figure [ fig : kh_ics ] .     for resolution and @xmath54-direction bulk velocities of @xmath95=[64,10]$ ] ( upper left panel ) , @xmath95=[128,10]$ ] ( upper right panel ) , @xmath95=[256,10]$ ] ( lower left panel ) , and @xmath95=[512,0]$ ] ( lower right panel ) .",
    "the error convergence rate for ppm reconstruction , measured relative to the @xmath95=[512,0]$ ] simulation , shows the expected improvement over the linear reconstruction results ( see figure [ fig : final_sequence ] ) as less diffusive methods should perform better in the presence of large advective flows .",
    ", width=317 ]    ) .",
    "shown is a dimensionless measure of the root - mean - squared density ( left panel ) and entropy ( right panel ) fluctuations from the growing kh instabilities in simulations with @xmath26 ( black ) , @xmath33 ( blue ) , and @xmath70 ( red ) resolution and without bulk flows , as well as @xmath26 ( black dashed ) , @xmath33 ( blue dashed ) , and @xmath70 ( red dashed ) simulations with @xmath23 ( mach @xmath69 ) velocity bulk flow along the @xmath54-direction . in the simulations without bulk flows , the instabilities grow at nearly the same rate . in the simulations with @xmath23 bulk flows ,",
    "the instability growth improves with increasing resolution and is comparable to the simulations with no bulk flow with a resolution @xmath70 or better . , width=317 ]     error norm for the kelvin - helmholtz instability simulation of the initial conditions ics b with time .",
    "shown is the @xmath71 error norm of simulations with no bulk flow and grid resolutions @xmath26 ( black ) , @xmath33 ( blue ) , and @xmath70 ( red ) , and simulations with bulk flow velocity @xmath23 ( mach @xmath69 ) with resolutions @xmath26 ( black dashed ) , @xmath33 ( blue dashed ) , @xmath70 ( red dashed ) , and @xmath29 ( orange dashed ) . in each case , the @xmath71 error norm is measured relative to a @xmath29 simulation with no bulk flow . for a bulk flow of velocity @xmath23 , the effective resolution of the simulation",
    "is degraded by numerical diffusion a factor @xmath96 compared with simulations with no bulk flows .",
    ", width=317 ]    the inclusion of a finite gradient in the density and velocity distribution in ics b leads to a dramatic suppression of small scale features in the growing kh instability .",
    "figure [ fig : kh_abel_sequence ] shows the temporal evolution of the kh instability arising from ics b with no bulk flow , simulated with grid resolutions of @xmath26 ( first row ) , @xmath33 ( second row ) , @xmath70 ( third row ) , and @xmath97 ( fourth row ) .",
    "the density distribution of the computational volume is plotted at times @xmath65 ( first column ) , @xmath66 ( second column ) , @xmath67 ( third column ) , and @xmath68 ( fourth column ) , and is directly comparable to the simulations of ics a shown in figure [ fig : kh_sequence ] .",
    "the evolution of the kh instability is completely dominated by the seeded @xmath94 perturbation . as with ics a , the velocity perturbation drives secondary waves that cross the computational volume .",
    "these waves travel through the low density fluid and collide with the high density fluid after traversing the box .",
    "in contrast to the evolution of the instability in ics a , these waves do not excite other , higher frequency modes in the high density fluid .",
    "the transition region between the fluids oscillates after interacting with these waves , but the density distribution is overstable at large wavenumbers and the oscillations damp away . as a result , the evolution of the kh instability is nearly independent of the simulation resolution when no bulk flow is included and converges to a well - defined solution .    in an attempt at a comprehensive study of the kh instability resulting from ics",
    "b , we perform a suite of 24 simulations with resolutions @xmath98 $ ] , with each resolution simulation calculated with bulk flow velocities of @xmath99 $ ] ( mach @xmath100 $ ] ) in the @xmath54-direction .",
    "the simulations were performed in a manner identical to the simulations of ics a , with the courant - freidrichs - lewy condition parameter @xmath16 and simulation outputs recorded at time intervals of @xmath60 .",
    "figure [ fig : final_sequence ] shows the results of these 24 simulations at time @xmath68 , arrayed with resolution increasing to the right and bulk flow velocity increasing from @xmath101 ( top row ) to @xmath36 ( mach @xmath102 , bottom row ) .",
    "the influence of a bulk flow on the evolution of the kh instability growing from ics b is much less dramatic than for ics a. the diffusive error induced by the bulk flow has little influence on the physical development of the instability , and only limits the growth of the instability for the lowest resolution simulation ( @xmath26 ) for bulk flow mach numbers of @xmath103 ( @xmath104 ) .",
    "the diffusive error clearly decreases and the simulations visually appear to converge with increasing resolution at each bulk flow velocity .",
    "the result is dramatic considering the extreme supersonic bulk flow velocities ( up to mach number @xmath105 ) considered",
    ". note that for the run with the largest bulk velocity and the highest resolution , the interface has been advected through @xmath106 computational cells .",
    "since the degradation of the computed solution by numerical diffusion in the presence of a bulk motion can be ameliorated by increasing the resolution , the performance should also improve at fixed resolution when a higher - order method is used .",
    "the use of ppm reconstruction should then result in less diffusion than when linear reconstruction is utilized . to test this intuition",
    ", we use the ppm version of the code enzo @xcite , which uses an exact riemann solver and @xcite dimensional splitting , and perform exactly the same ramp kh instability simulation .",
    "figure [ fig : enzo ] shows the results for the density at time @xmath59 for simulations with resolutions and @xmath54-direction bulk velocities of @xmath25 $ ] and @xmath107 $ ] using the enzo ppm code with @xmath108 .",
    "first , the results of the enzo ppm and art simulations are remarkably similar ( figures [ fig : final_sequence ] and [ fig : enzo ] are directly comparable , with the same color scaling ) .",
    "second , the final density distributions in the lower resolution ( @xmath109 ) simulations with @xmath23 bulk flows quickly converge with increasing resolution to the reference high - resolution ( @xmath95=[512,0]$ ] ) simulation results .",
    "as expected , at fixed resolution the enzo ppm results are clearly less diffusive than the art results ( e.g. , the @xmath110 simulation results in figures [ fig : final_sequence ] and [ fig : enzo ] )",
    ".      the apparent convergence of the simulation with increasing resolution for each bulk flow can be quantified .",
    "statistical measures of the instability evolution , including both the @xmath71 error norm ( equation [ equation : l1_error ] ) and the mixing statistic ( equation [ equation : mixing_statistic ] ) , are well - defined for the ics b simulation if one substitutes the results of a high - resolution simulation for the `` true '' solution .",
    "we adopt this approach and define the error norm relative to a @xmath111 simulation with no bulk flow ( upper right corner of figure [ fig : final_sequence ] ) , and calculate all statistical measures by rebinning simulations to @xmath112 resolution when necessary .    for comparison with the results from simulations of ics a",
    ", figure [ fig : kh_abel_statistics ] shows the time evolution of the density ( left panel ) and entropy ( right panel ) mixing statistics for the simulation of ics b with resolutions @xmath113 $ ] and bulk flow velocities @xmath114 $ ] ( mach @xmath115 $ ] ) . in dramatic contrast to results of ics a , the mixing statistic for ics b is roughly independent of resolution for the simulations with no bulk flow and clearly converges at resolution @xmath70 for a bulk flow velocity @xmath23 .",
    "further , the instability grows in both simulations with and without a @xmath23 bulk flow for all the resolutions studied . for simulations with a @xmath23 bulk flow the growth rate of the instability changes with resolution , but the growth rate agrees with the @xmath101 simulations by resolution @xmath70 .",
    "figure [ fig : kh_abel_error_norm ] shows the time evolution of the @xmath71 error norm for density ( left panel ) and entropy ( right panel ) of the ics b simulations with @xmath116 $ ] with no bulk velocity ( @xmath101 , shown as black , blue , and red lines , respectively ) and simulations with @xmath25 $ ] and bulk velocity @xmath23 ( shown as black , blue , red , and orange dashed lines , respectively ) .",
    "as expected , the error declines rapidly with increasing resolution and increases with increasing time of the simulation . for the @xmath23 ( mach @xmath69 ) bulk flow simulations",
    "the numerical diffusion degrades the effective resolution of the simulation , with the @xmath70 , @xmath23 simulation performing comparably to the @xmath26 , @xmath101 simulation and the @xmath29 , @xmath23 simulation performing comparably to the @xmath33 , @xmath101 simulation .",
    "the time dependence of the @xmath71 error norm in figure [ fig : kh_abel_error_norm ] appears to be self - similar for fixed bulk flow velocity .",
    "further , the logarithmic separation of the @xmath71 error norm for simulations with differing resolution appears to be approximately constant . with some experimentation",
    ", we find that the @xmath71 error norm of these simulations scales approximately as @xmath117}.\\ ] ] figure [ fig : error_scaling ] shows the @xmath71 error norm of all 24 simulations from figure [ fig : final_sequence ] normalized by the scaling given by equation [ equation : l1_scaling ] ( left panel ; the @xmath111 , @xmath101 simulation error norm is @xmath118 by definition ) .",
    "the right panel of figure [ fig : error_scaling ] shows the normalized @xmath71 error norm curves from the left panel divided by the normalized @xmath71 error norm for the @xmath70 , @xmath101 simulation .",
    "figure [ fig : error_scaling ] demonstrates that equation [ equation : l1_scaling ] accounts for the dependence of the @xmath71 error norm on simulation resolution and velocity . at fixed time , the @xmath71 error norm dependence on resolution scales as @xmath119 as expected for the spatially second - order accurate eulerian method used by art .",
    "the velocity dependence of the error norm is @xmath120 , which is remarkably similar to the @xmath121 expected from numerical diffusion .",
    "we therefore suggest that the velocity - dependence of the @xmath71 error norm at fixed time is consistent with numerical diffusion alone .",
    "the time - dependence of the @xmath71 error norm scaling has only a very weak apparent dependence on velocity @xmath122 , and a moderate dependence on the resolution as @xmath123 . for a given bulk flow velocity , equation [ equation : l1_scaling ]",
    "can be used to calculate the necessary resolution required in simulations of this kh instability to reach an equivalent error for the same simulation without a bulk flow . for the setup of ics b , although results of runs with and without bulk velocity have different errors ( expectedly , given the different number of time steps and different amount of advection ) , calculations converge to the same galilean invariant result as the resolution is increased .",
    "error norm dependence on resolution and velocity .",
    "shown is the @xmath71 error norm for all 24 simulations in figure [ fig : final_sequence ] , normalized by their common dependence on resolution ( @xmath119 ) and velocity [ @xmath120 ] ( left panel ) .",
    "this functional dependence is common to all the simulations ( right panel ) , as demonstrated by dividing out the time - dependence of the @xmath70 , @xmath101 simulation described by equation [ equation : l1_scaling ] .",
    ", width=317 ]    the same error analysis can be performed for the enzo results as for the art results above .",
    "we use the @xmath29 , @xmath101 enzo ppm simulation , rebinned to @xmath26 resolution , to define the reference solution in equation [ equation : l1_error ] .",
    "the @xmath71 error norms are then measured for the @xmath116 $ ] , @xmath23 enzo ppm simulations .",
    "we find that at early times the error norm improves with resolution faster than quadratically , as expected for a ppm code .",
    "compared with the results from the art code , these error convergence rates are consistent with the precision increase afforded by the ppm reconstruction .",
    "we therefore suggest that the comparison of the art and enzo ppm results demonstrate that both codes converge correctly with increasing resolution for their formal order .",
    "we therefore expect that other eulerian codes will also produce galilean invariant solutions to within a specified error tolerance for similar hydrodynamical problems .",
    "the simulations of kh instabilities presented in this paper suggest that the apparent galilean non - invariance in eulerian hydrodynamical calculations owes to numerical diffusion associated with advection of the fluid through the computational grid .",
    "the diffusive errors arise from the truncation errors associated with discretization of spatial and temporal derivatives in the computational method .",
    "the traditional meaning of galilean invariance is that the formulation of a specified physical law in two different inertial frames is related by a galilean transformation . while the euler equations are galilean - invariant , discretized approximations to the euler equations are not guaranteed to obey the same transformational properties .",
    "however , with increasing spatial resolution simulations converge to the galilean invariant numerical solution ( at least for problems that have convergent solutions ) .    in kh instability simulation",
    "initial conditions with discontinuously sharp boundaries between shearing fluids , all modes down to the cell scale are unstable .",
    "secondary waves driven by the seeded perturbation and numerical noise can then generate small - scale instabilities that affect the long - term evolution of the system .",
    "for such initial conditions , numerical diffusion can both alter the frequency range of unstable wavenumbers and smear out small - scale features in the flow . in the presence of a large bulk flow , the increased numerical diffusion can thereby suppress the growth of small - scale instabilities through these effects .",
    "in such tests eulerian methods can produce qualitatively different results compared with simulations of the same initial conditions that do not include a bulk flow .",
    "we emphasize that these differences arise because the development of both real and numerical small - scale perturbations in the flow are affected by diffusive errors associated with advection through the grid .    for physical systems in which all of the perturbations are well - resolved ,",
    "our results show that calculations quickly converge to a well - defined , galilean invariant solution .",
    "this result holds even in the presence of highly supersonic bulk motions , although in this case spatial resolution needs to scale approximately as @xmath125 to counteract increased diffusive errors owing to advection .",
    "supersonic bulk flows therefore pose no serious problem for eulerian simulations as convergence studies  the final arbiter of any quantitatively credible numerical calculation  will allow one to test for a converged solution regardless of the magnitude of the bulk flow for realistic initial conditions . although the required increase of resolution may seem like a large price to pay , adaptive mesh refinement makes it considerably easier to achieve such resolution increases in the relevant regions around the fluid interface .",
    "we have calculated some of the tests presented in the paper with adaptive mesh refinement using refinement conditions based on density and entropy gradients and obtained results similar to those achieved with a uniform grid of higher resolution .",
    "we caution that numerical diffusion may limit what physical systems can be accurately modeled by eulerian methods with arbitrary flow velocities if the resolution is poor .",
    "since numerical diffusion can alter the physical system being modeled ( for instance , in the presence of unrealistic discontinuities ) , simulation results in the eulerian method can depend irrevocably on the local flow velocity in fixed , low - resolution calculations .",
    "our studies suggest that hydrodynamical systems altered by numerical diffusion ( like ics a ) are galilean invariant to within a specified error tolerance , but these calculations would model a different system in the effective absence of numerical diffusion ( since , e.g. , the frequency range of unstable modes has changed ) .",
    "the failure of kh instabilities to develop in low - resolution simulations with large bulk velocities can be directly rectified with sufficient resolution .",
    "we therefore suggest that knowledge of the bulk velocity , local density and shear velocity gradients , or other gauges of the potential impact of numerical diffusion be incorporated into resolution criteria and , for adaptive mesh codes , into refinement conditions .    when eulerian methods are used to model the growth of instabilities in the presence of a bulk velocity , care should be exercised to ensure that the perturbations of interest are not made overstable by numerical diffusion at low resolution .",
    "for instance , if the perturbation frequency @xmath126 in equation [ equation : abel_velocity_perturbation ] was greatly increased such that the perturbation wavenumber was close to the maximum unstable wavenumber permitted by the system , then numerical diffusion could , in principle , artificially alter the growth of the perturbation if the mode was not properly resolved .",
    "we have repeated simulations of ics b with @xmath56 and find similar convergence properties to those reported for @xmath94 . however , the typical error norm at fixed resolution and velocity is larger for @xmath56 than for @xmath94 .",
    "sensibly , smearing in the solution owing to numerical diffusion will affect small scales more so than large scale modes .",
    "techniques exist for reducing numerical diffusion in eulerian methods , and an appropriate application of such techniques could help mitigate velocity - dependent behavior of calculated solutions .",
    "we demonstrated that intrinsically less diffusive eulerian methods , such as ppm , show improved results over codes using linear reconstruction .",
    "the art simulations presented in this paper use the @xcite slope limiter , but the use of less - diffusive slope limiters during reconstruction , such as the superbee limiter @xcite , improve results for some physical systems .",
    "artificial compression in the form of slope steepeners might also help for some problems .",
    "for instance , our tests presented in  [ section : diffusion ] show that the one dimensional advection of square wave contact discontinuities can be made insensitive to even ultrasonic ( mach @xmath127 ) advective velocities if the the slope steepening method of @xcite is used .",
    "however , when applied to multidimensional problems , such as the kh instability simulations presented here , we have found that the @xcite slope steepener produces oddly angular features in the fluid flow when used with a @xcite dimensionally split solver ( we have not tested slope steepeners with unsplit solvers ) . similarly , the @xcite subcell resolution method produces excellent results in one dimension but is unwieldly in multiple dimensions .",
    "other approaches for reducing numerical diffusion in eulerian methods are discussed at length by @xcite .",
    "the strength of numerical diffusion can differ on the upwind and downwind side of an initially symmetrical waveform being advected using godunov - type eulerian codes .",
    "the results of  [ fig : kh_vel_sequence ] show clear evidence for larger numerical diffusion in the high - to - low density transition than for the low - to - high density transition , and for an alteration of the piecewise reconstruction of the initially symmetrical waveform by numerical diffusion .",
    "it should be noted that some reconstruction methods intrinsically do not produce symmetrical piecewise approximations to smooth functions , depending on the number of samples of the waveform .",
    "for instance , average - quadratic interpolations of sine and square waves using essentially nonoscillatory reconstruction are not always symmetrical ( see  9.2 of * ? ? ?",
    "numerical diffusion may depend on the flow velocity and direction in such cases .",
    "while our study has focused on idealized hydrodynamical systems , real astrophysical systems where the kelvin - helmholtz instability operates will be influenced by gravitational fields .",
    "mixing in a stratified fluid in the presence of gravity must overcome gravitational potential energy with kinetic energy from the shearing motion .",
    "the stabililty of the fluid against kelvin - helmholtz modes can therefore be characterized by the richardson number that measures the relative strength of buoyancy in the fluid and inertia supplied by the shearing velocity gradient @xmath128 as @xmath129 where @xmath130 is the local gravitational acceleration along the @xmath131-direction and @xmath3 and @xmath132 are the local density and density gradient in the fluid .",
    "@xcite shows that since the kinetic energy of the shearing motion powers the instability , if the shearing kinetic energy is too small to overcome the gravitational potential energy of the fluid then the kh instability will not occur . in terms of the richardson number ,",
    "it is straightforward to show that the corresponding necessary ( but not sufficient ) condition for stability is @xmath133 . , and stability depends on whether individual modes can be excited . in the presence of other effects , such as a coriolis force , instability may require higher richardson numbers ( see , e.g. , * ? ? ? * ) . ]    in the context of modeling astrophysical systems , our results suggest that numerical diffusion may act to change the richardson number by altering the local density and shear velocity gradients",
    ". since the numerical diffusion will smooth density and velocity gradients by similar amounts , the effect of numerical diffusion will typically be to increase the stability of kh modes .",
    "simulations of systems with modes that have @xmath134 should therefore be checked to gauge the influence of any artificial stabilization from numerical diffusion on the global evolution of the system .",
    "in this paper we have presented hydrodynamical simulations of kelvin - helmholtz ( kh ) instabilities to study the behavior of the numerical solution in the presence of uniform bulk motion .",
    "we perform these calculations to verify and evaluate previous claims in the literature that godunov - type eulerian mesh calculations are inherently galilean non - invariant .",
    "the kh instability study of @xcite was performed using the art @xcite hydrodynamical code over a range of numerical resolutions and bulk flow velocities .",
    "we confirm the results of @xcite that for low - resolution simulations kh instabilities may not develop in the presence of bulk flows , but show that such instabilities do develop with sufficient resolution .",
    "we also explain why the @xcite kh instability simulation results generally depend on whether a bulk flow is included .",
    "diffusion in the presence of a bulk flow softens the sharp discontinuity between fluids in these initial conditions , thereby changing the frequency range of unstable modes . as a result ,",
    "the small - scale structure of the solution changes significantly with resolution and in the presence of large advective velocity .",
    "however , we emphasize that this velocity dependence owes to numerical diffusion associated with advection of the fluid , not because the analytical riemann solution is somehow galilean non - invariant ( it is invariant ) .",
    "we test this explanation by simulating another kelvin - helmholtz instability that grows from initial conditions that have a gradual interface between fluids , in contrast to the sharp interface used in the @xcite kh test . in the new kh simulation",
    ", the stability of the fluid to growing small - scale modes allows the seeded @xmath94 perturbation to develop unimpeded as a kh instability , and the simulation demonstrates convergence with increasing resolution .",
    "furthermore , the development of the kh instability occurs in the same manner for all bulk flows examined ( including supersonic bulk flows with mach numbers @xmath105 ) .",
    "an analysis of the @xmath71 error norm suggests that numerical diffusion accounts for the entire error budget of the simulations that include bulk flows .",
    "we support this conclusion by demonstrating that the intrinsically less diffusive piecewise parabolic method code enzo @xcite exhibits more rapid convergence than codes using linear reconstruction , and that the simulation results produced by art and enzo are consistent . for this kh instability",
    ", the galilean non - invariance can therefore be entirely accounted for by numerical diffusion and can be effectively eliminated with increasing numerical resolution .",
    "our results suggest that physical systems where numerical diffusion does not significantly alter the frequency range of unstable modes , godunov - type eulerian methods will be galilean invariant to within a specified numerical error and that this error will decrease with increasing resolution .",
    "we have demonstrated this result explicitly in the case of a kh instability , but we suspect our conclusions will generalize to other hydrodynamical instabilities .",
    "similar conclusions can be drawn from test calculations by other authors ( e.g. , the gresho vortex tests by * ? ? ?",
    "these results show that there is no generic problem of using the eulerian methods for modeling complicated astrophysical systems with large bulk flows .",
    "however , overcoming diffusive errors will require more stringent resolution when modeling systems with large bulk fluid motions .    as with most numerical calculations ,",
    "convergence studies are essential for evaluating how numerical diffusion introduces velocity - dependent error into the presented simulations",
    ". if a full convergence study is difficult or impossible , such as for the @xcite kh instability simulation , caution needs to be exercised in interpreting results in the presence of high - mach number flows .",
    "ber would like to thank the staff of the neonatal intensive care unit at the comer childrens hospital and the mitchell transitional care unit at the university of chicago medical center for their hospitality while this work was completed .",
    "we also thank anatoly klypin , brian oshea , eve ostriker , volker springel , and romain teyssier for helpful discussions .",
    "ber gratefully acknowledges support from a spitzer fellowship through a nasa grant administrated by the spitzer science center during the majority of this work .",
    "avk is supported by the nsf under grants ast-0239759 and ast-0507666 and by nasa through grant nag5 - 13274 .",
    "ber and avk were also partially supported by the kavli institute for cosmological physics at the university of chicago .",
    "d.h.r . gratefully acknowledges the support of the institute for advanced study and the nsf through grant ast-0807444 . some of the simulations used in this work have been performed on the joint fermilab - kicp supercomputing cluster , supported by grants from fermilab , kavli institute for cosmological physics , and the university of chicago .",
    "o. , moore b. , stadel j. , potter d. , miniati f. , read j. , mayer l. , gawryszczak a. , kravtsov a. , nordlund  . , pearce f. , quilis v. , rudd d. , springel v. , stone j. , tasker e. , teyssier r. , wadsley j. , walder r. , 2007 , mnras , 380 , 963                                                                                          p.  l. , pike j. , 1984 , in glowinski r. , lions j .-",
    ", eds , computing methods in applied sciences and engineering vol .  6 , efficient construction and utilization of approximate riemann solutions ."
  ],
  "abstract_text": [
    "<S> eulerian hydrodynamical simulations are a powerful and popular tool for modeling fluids in astrophysical systems . in this work </S>",
    "<S> , we critically examine recent claims that these methods violate galilean invariance of the euler equations . </S>",
    "<S> we demonstrate that eulerian hydrodynamics methods do converge to a galilean - invariant solution , provided a well - defined convergent solution exists . </S>",
    "<S> specifically , we show that numerical diffusion , resulting from diffusion - like terms in the discretized hydrodynamical equations solved by eulerian methods , accounts for the effects previously identified as evidence for the galilean non - invariance of these methods . </S>",
    "<S> these velocity - dependent diffusive terms lead to different results for different bulk velocities _ when the spatial resolution of the simulation is kept fixed , _ but their effect becomes negligible as the resolution of the simulation is increased to obtain a converged solution . in particular , we find that kelvin - helmholtz instabilities develop properly in realistic eulerian calculations regardless of the bulk velocity provided the problem is simulated with sufficient resolution ( a factor of 2 - 4 increase compared to the case without bulk flows for realistic velocities ) . </S>",
    "<S> our results reiterate that high - resolution eulerian methods can perform well and obtain a convergent solution , even in the presence of highly supersonic bulk flows .    </S>",
    "<S> [ firstpage ]    hydrodynamics  instabilities  methods : numerical </S>"
  ]
}