{
  "article_text": [
    "cosmological gravitational microlensing refers to the regime of gravitational lensing where individual stars within a lensing galaxy act to magnify a background source , usually a quasar .",
    "the most obvious effect of microlensing is to produce an uncorrelated brightness change with time in a single image of a multiply - imaged source ; an intrinsic variation in source flux would appear in all images separated by the individual image time delays .",
    "cosmological microlensing was first observed in the lensed quasar by @xcite , and it is likely to be taking place on some level in all quasars multiply imaged by a foreground galaxy . for recent summaries , see @xcite and @xcite .    while gravitational microlensing is achromatic",
    ", the magnitude of microlensing - induced fluctuations depends strongly on the size of the emission region .",
    "small sources ( relative to the einstein radius of the microlenses ) are affected more strongly than larger sources .",
    "detections of microlensing signals in a single waveband can therefore be used to constrain the size of the quasar emission region .",
    "for example , optical observations of suggest a v - band accretion disc radius of @xmath4 cm @xcite .",
    "multi - wavelength observations present an opportunity to constrain the wavelength - dependent structure of quasar emission regions .",
    "first constraints on the temperature profile of quasar accretion discs have already been published ( @xcite ; @xcite ; @xcite ; @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) .",
    "interpretation of broad emission line region ( belr ) signals are more complex , however some early attempts have been made .",
    "@xcite and @xcite measured the relative sizes of the ciii]/mgii belr and continuum emission region in q2237 + 0305 using microlensing observations .",
    "@xcite proposed a biconical belr as a possible explanation for a recurrent blue - wing enhancement in the emission lines of sdss j1004 + 4112 ( @xcite ; @xcite ) .",
    "@xcite compared a differential microlensing signal observed across the ciii ] emission line in q2237 + 0305 with various belr geometries , and @xcite studied the broad emission lines in 39 epochs of q2237 + 0305 data obtained with the vlt .    while @xmath5 multiply imaged quasars",
    "have now been discovered , only @xmath6 of these have measured light travel time delays between lensed images ",
    "see @xcite for a recent compilation .",
    "new , high - cadence , all - sky surveys such as those planned for the skymapper telescope @xcite and the large synoptic survey telescope ( lsst ; @xcite ) are likely to discover a large number of gravitationally lensed quasars .",
    "for example , @xcite predict that lsst will find approximately 8000 new lensed quasars across its 10-year 20000-deg@xmath7 survey , 3000 of which will have good measurements of the time delays between images .    the anticipated increase in the number of known lensed quasars",
    "will take measurements of quasar structure beyond the realm of single - object studies and into that of statistically meaningful samples .",
    "for example , we can test whether a single accretion mechanism is consistent with all observations , examine scaling relations between black hole mass and accretion disc radii [ see @xcite for such an analysis with a sample of 11 lensed quasars ] , and investigate secondary parameters such as eddington ratio ( e.g * ? ? ?",
    ".    analysis and interpretation of this wealth of new information regarding quasar emission regions will require extensive simulations .",
    "the basic tool for microlensing is the magnification map : a pixellated approximation to a region of the ( background ) source plane , with a magnification value defined at each physical source location . by convolving magnification maps with wavelength - dependent geometric model profiles , both simulated lightcurves and statistical magnification distributions",
    "can be extracted , ready for comparison with observational data .",
    "the characteristic caustic structure of a magnification map depends on the convergence and shear ( described in section [ sec : survey ] ) .",
    "these parameters are local properties of the global macro - lens model at the position of each lensed image .",
    "since each lensing environment is unique , potentially @xmath8 new combinations of convergence and shear will need to be simulated [ @xcite predict @xmath9 per cent of @xmath10 lsst - discovered systems will be quadruply imaged , with the remaining systems dominated by double images , resulting in a mean image number of 2.28 ] . moreover , macro - lens models are not uniquely determined . for example , @xcite modeled lensing systems with three different lens potentials and @xcite contains a compilation of lens models for by eight different authors : each of which predicts different convergence and shear values for the lensed images .",
    "the potential need for multiple models , and hence mangification maps , for each newly discovered system further increases the expected coverage of convergence - shear parameter space .",
    "although the computational time needed for analysis of magnification maps can be considerable ( e.g. * ? ? ?",
    "* ) , generating sufficient high - resolution , statistically useful magnification maps is itself a computationally - demanding task . over the last two decades ,",
    "the most widely - used approaches to generating magnification maps are based on backwards ray - shooting ( described in more detail in section 2 ) . here , light rays are propagated from the observer , through the lens plane , requiring the calculation of deflections by @xmath11 individual lenses , and mapped onto the pixellated source plane .",
    "this computation is repeated for a sufficiently large number of light rays , typically @xmath12 or higher , in order to achieve statistically significant coverage per pixel in the source plane .    in the hierarchical tree method ( @xcite ; @xcite ) , individual lenses are approximated by higher - mass pseudo - lenses , depending on their distance from a given light ray , thus avoiding the requirement for @xmath11 deflection calculations per light ray .",
    "@xcite describes a computationally - efficient approach to reducing the @xmath11 effect , where the lens and source planes are treated as spatially periodic , allowing the use of fourier methods ( similar to the p@xmath13 m methods used for many - particle gravitational force computations ) . @xcite and @xcite adaptively tessellate the lens plane , with the lens equation used to map the lattice of polygons from the image to source plane , where the polygons are efficiently mapped onto source pixels .",
    "this approach reduces the total number of light rays required to reach a given statistical accuracy by over three orders of magnitude .",
    "the emergence of the graphics processing unit ( gpu ) as a means of accessing low cost , high performance , massively parallel computing , presents an alternative opportunity for speeding - up deflection angle calculations with an algorithmically - simple solution .",
    "astronomers have been amongst the early adopters of gpus for scientific computation , reporting typical speed - ups between @xmath14 to @xmath15 over what they can achieve on single ( or few ) core cpus .",
    "while further work is required to fully understand which types of computations are best suited for gpus [ see @xcite and @xcite for a discussion of these issues specifically aimed at astronomers ] , algorithms that exhibit the properties of high arithmetic intensity and a high - level of data parallelism are the most promising targets .",
    "@xcite demonstrated that by taking advantage of the highly parallel gpu - architecture , a `` brute force '' implementation of ray - shooting is now a practical alternative .",
    "moreover , bate et al .",
    "( 2010 ) have shown that on current generation multi - gpu systems ( e.g. the 4-gpu nvidia tesla s1070 unit with a processing peak of @xmath16 teraflop / s for single precision computation floating point operations per second . ] ) , the direct code on gpu executes in runtimes comparable too , and often faster than , the single - core tree code .",
    "our target system is the australian gpu supercomputer for theoretical astrophyiscs research ( gstar ) , a hybrid cpu+gpu cluster containing 102 @xmath17 nvidia c2070 gpus and 21 @xmath17 m2090 gpus , connected via qdr infiniband , with a ( theoretical , single - precision ) peak of @xmath18 teraflop / s . throughout this work ,",
    "we estimate run - times for two different gpu cluster configurations : we assume a slightly more conservative 100 teraflop / s mode of operation for the phase one gstar system , gstar@xmath19 , and a somewhat optimistic future upgrade with a peak of 600 teraflop / s , gstar@xmath20 , based on the original system design goals . in both cases",
    ", we expect to achieve at least 50 per cent of the theoretical peak , based on the benchmarking in @xcite .    our goal in this paper is to demonstrate that a high resolution , large - scale , microlensing parameter survey is feasible on a gpu - enabled computing cluster .",
    "this requires generating statistically useful samples of high - resolution magnification maps over the entire range of convergence - shear parameter space  a theoretical equivalent of an `` all - sky '' survey . by providing * @xmath21 * pre - computed magnification maps as a web - accessible resource , rapid first look computations would be possible as new microlensed quasars are discovered .",
    "high - resolution coverage of parameter space enables investigation of degeneracies between macro - model parameters and inferred plausible models for quasar emission regions , and presents new opportunities to test ( e.g. via mock observations ) theoretical models of the accretion disc and belr well before the new era of microlensed quasar discoveries begins .",
    "a parameter survey does not remove the need for detailed modelling of individual systems : for example , simultaneous multi - image fits to light curves including dynamical motions of the stellar lens populations , requiring generation of magnification maps for each observation epoch , as per @xcite .",
    "this paper is organised as follows . in section",
    "[ sec : survey ] , we discuss the theoretical considerations for a survey of the entirety of convergence - shear parameter space on a gpu - based computing cluster .",
    "we discuss magnification map size and resolution considerations , and use simulation time estimates based on the results of @xcite to inform a realistic simulation strategy . in section [ sec : first_app ] we illustrate one possible use for our survey by examining the systematic effects on accretion disc constraints in the lensed quasar when the lens macro - model is varied .",
    "we present our conclusions in section [ sec : conc ] .    throughout this paper ,",
    "a cosmology with @xmath22 , @xmath23 and @xmath24 is assumed .",
    "in this section , we discuss the theoretical considerations that inform the choices of parameters for a high - resolution , cosmological microlensing parameter space survey . we discuss the ways in which observational constraints shape the magnification map sizes and resolutions that are required to produce a useful resource for the microlensing community .",
    "there are two techniques for constraining quasar structure from microlensing observations : analysis of time - dependent light curves ( e.g. @xcite ; @xcite ) , or single epoch observations ( @xcite ; @xcite ) .",
    "both rely upon a lens model , which is used to generate magnification maps that describe the fluctuation of magnification induced by the microlenses , projected onto the source plane .",
    "the lens model is defined in terms of the ( external ) shear , @xmath25 , and the convergence , @xmath26 .",
    "shear describes the distortion applied to images and is assumed to be dominated by matter in the host galaxy , however any matter along the line of sight to the source can contribute .",
    "convergence describes the focussing power of the ( macro-)lens , and includes contributions from both smooth matter , @xmath27 , and compact objects , @xmath28 , according to @xmath29 .",
    "we define the smooth matter fraction to be @xmath30    once a set of model parameters have been defined , a magnification map can be generated using the gravitational lens equation in the following form : @xmath31 which relates the two - dimensional location of a light ray , @xmath32 , with a source position , @xmath33 , for @xmath34 compact lenses distributed in an ellipse of area @xmath35 , at lens plane coordinates , @xmath36 , and with mean lens mass , @xmath37 .",
    "using equation ( [ eqn : sigma ] ) to shoot light rays at known positions backwards through the lens plane to the source plane , we can count the number of rays reaching each pixel , @xmath38 . comparing these values to the average number of light rays per pixel",
    "if there were no lensing , @xmath39 , we obtain estimates for the per pixel magnification : @xmath40    for large @xmath11 and large total number of light rays , the direct computation of equation ( [ eqn : sigma ] ) on a single - core cpu is not feasible .",
    "the hierachical tree - code ( @xcite ; @xcite ) overcomes this limitation by replacing the @xmath11 lenses with a reduced number of higher - mass pseudo - lenses .",
    "a similar approach is used in the fourier method @xcite , where the lens and source planes are treated in a periodic fashion , which helps reduce the total number of light rays required , and also removes the edge effects , making more of the magnification map usable for analysis .",
    "the tessellation approach ( @xcite ; @xcite ) reduces the total number of light rays by using a sophisticated mapping of polygonal regions from the lens plane to the source plane .    while all of these algorithms lead to improved computational efficiency , they do this at the expense of algorithmic ( and hence implementation ) simplicity .",
    "the high level of parallelism in the direct ray - shooting algorithm , coupled with the arithmetic intensity inherent in equation ( [ eqn : sigma ] ) , are ideal attributes for implementation on a gpu . for details of the gpu - d code , including optimisation issues and timing tests ,",
    "see @xcite . for timing and accuracy comparisons between gpu , hierarchical tree codes and",
    "parallel large data codes , see @xcite .",
    "@xcite report on a timing comparison between an improved implementation of the tessellation method and the gpu - d results from @xcite : they find a two order of magnitude improvement in computational efficiency , but the total run - times of the two approaches were comparable .    as the three ( currently ) cpu - only approaches for generating magnification maps share a high - degree of parallelism , particularly through the need to calculate deflections of many light rays , opportunities exist for their implementation on massively parallel architectures .",
    "such work is beyond the scope of this present paper .",
    "we adopt the viewpoint that we have a working gpu ray - shooting code , and have access to a @xmath41 teraflop / s supercomputing facility , gstar , and hence present what could be achieved now .",
    "any progress in reducing the total computation time should be traded off with the additional amount of time required to implement an alternative , more complex , solution @xcite .      in microlensing simulations",
    ", we run into the usual conflict between map size ( measured in units of the einstein radius ) and map resolution .",
    "we need maps that have sufficient resolution to resolve the very inner regions of quasar accretion discs ( @xmath42 cm ; see for example the analysis of rxj1131 - 1231 in @xcite ) , and sufficient size to map out quasar broad emission lines ( @xmath43 cm for the ciii]/civ / mgii lines ; see for example the microlensing analysis of @xcite , or the reverberation mapping analysis of @xcite ) .",
    "one option is to provide two sets of maps with sizes and resolutions tuned to the extreme physical scales for the accretion disk and belr . in light of recent multi - wavelength studies of accretion disk sizes and structures",
    "( @xcite ; @xcite ; @xcite ; @xcite ) , the approach we adopt is a single map that spans both physical scales .",
    "this permits the use of self - consistent quasar models for studying future , simultaneous multi - wavelength observations extending from accretion disk to belr scales .    to set the pixel resolution required ,",
    "we take the last stable orbit of a schwarzschild black hole of mass , @xmath44 : @xmath45 where @xmath46 is the gravitational constant and @xmath47 is the speed of light .",
    "we define this value for a @xmath48 black hole as the fiducial radius , @xmath49 . for a fixed map size",
    ", the pixels required to reach exactly this resolution will vary from system to system , as the einstein radius depends on the angular diameter distances , @xmath50 , between the observer , @xmath51 , lens , @xmath52 , and source , @xmath53 .",
    "projected onto the source plane , the einstein radius is : @xmath54 for a microlens with mean mass , @xmath37 . for a background quasar at redshift @xmath55 , a lens at @xmath56 , and a mean microlens mass @xmath57 , the einstein radius is @xmath58 .",
    "how , then , do we determine the required number of pixels ?",
    "we start by considering 59 of the currently known lensing systems with redshifts available for both source and lens using data from the castles survey ( this is a more conservative choice than @xcite , who used estimates of lens redshifts to build up a sample consisting of 87 systems ) . choosing @xmath59 ,",
    "we calculate the mean einstein radius @xmath60 and its standard deviation to be : @xmath61 the einstein radius of each system , along with the mean and standard deviation , are plotted in figure [ fig : mean_er ] . to achieve our target pixel resolution , @xmath49",
    ", our maps would require an average of @xmath62 pixels per @xmath63 .",
    "the two systems with unusually large einstein radii are q2237 + 0305 and mg1549 + 3047 . in both cases ,",
    "the large einstein radii are a result of lensing galaxies at unusually low redshifts : @xmath64 for q2237 + 0305 , and @xmath65 for mg1549 + 3047 .",
    "the latter is also an extended source seen as a radio ring @xcite , and is not known to exhibit microlensing , so it is an atypical object . removing these two systems essentially does not change the measured mean einstein radius , but reduces the standard deviation by a factor of 1.79 .",
    "we make no comment here on selection effects that might bias this measurement ; we simply note that the known sources are a reasonable place to start .",
    "existing gravitationally lensed quasars have been discovered using a wide variety of techniques ( see @xcite ) , which are likely to be developed and refined in the era of large synoptic surveys .",
    "next , we determine the preferred physical size for the magnification maps .",
    "there are two main considerations here : that they be large enough to conduct simulations of quasar belrs , and that they are wide enough to allow long light curves to be simulated .",
    "assuming the quasar h@xmath66 belr radius - luminosity relation @xcite , @xmath67 , holds for high - luminosity , high - redshift quasars ( see @xcite ) , we can estimate the expected belr radius .",
    "@xcite performed this calculation for their sample of 87 lensed quasars ; for the 44 that overlap with our sample , the estimated mean h@xmath66 belr and its standard deviation are @xmath68 , or @xmath69 .    under the usual criterion",
    "that sources with sizes smaller than or approximately equal to the einstein radius can be significantly microlensed , this suggests that h@xmath66 belrs are generally too large to undergo significant microlensing .",
    "however , the belr is known to be stratified , with higher ionisation lines emitted closer to the central source . in ngc 5548 , for example , the civ line is emitted from a region a factor of two smaller than the h@xmath66 line ( see for example @xcite ; @xcite ) .",
    "microlensing estimates of the size of the ciii ] emission region in the lensed quasar q2237 + 0305 suggest a radius similar to the einstein radius for that source ( @xcite ; @xcite ; @xcite ) . in line with the microlensing analyses of @xcite and @xcite",
    ", we therefore assume an approximate outer radius for the high ionisation belr of @xmath70 .    a map with side length @xmath71 , convolved with a @xmath70 radius belr , would provide @xmath72 statistically independent data points [ taking into account edge effects due to convolution ",
    "these can be avoided using the fourier method @xcite ] .",
    "this drops dramatically if the belr is much larger than @xmath70 , however repeat generation of statistically independent maps allows us to compensate for this drop off .",
    "a @xmath73 map would require @xmath74 pixels in order to resolve @xmath49 .",
    "fortunately , it appears that the effective velocities of lensed quasars are likely to be small enough that a map large enough to enable simulations of quasar belrs will also be large enough to allow adequate sampling of microlensing lightcurves .",
    "@xcite estimated that the average einstein radius crossing time ( the time taken for a source to travel a single einstein radius ) for a sample of 90 gravitationally lensed quasars peaks at @xmath75 years , with a range of 8 to 44 years , assuming a mean microlens mass of @xmath76 .",
    "we can therefore simulate observations of duration @xmath77 years comfortably with a magnification map large enough for belr simulations .      to further refine our choice of parameters , we investigate anticipated run times . using the empirical relationship , @xmath78 , in @xcite for a 4-gpu nvidia s1070 tesla unit : @xmath79",
    "we can estimate the likely run time for any given magnification map .",
    "we have not estimated times for the hierarchical code , but note that we expect them to be longer overall based on figure 3 of @xcite .",
    "@xcite obtained a sustained processing performance of 1.28 teraflop / s on the s1070 , which is approximately half the nominal peak performance ( 2.488 teraflop / s ) .",
    "we note that quoted peaks are rarely achieved in scientific computations , as they typically require more than a dual - issued multiply and addition per gpu clock cycle . assuming this half - peak performance",
    "can also be obtained with gstar@xmath19 ( gstar@xmath20 ) , we can expect approximately 50 ( 300 ) teraflop / s performance utilising the entire facility  an optimistic viewpoint that ignores real - world scheduling issues and the needs of other gstar users .",
    "following bate et al .",
    "( 2010 ) , we set @xmath80 , as this was found to be sufficient for the parameters explored in that paper , and @xmath81 is allowed to vary in line with the discussion in section [ sec : determine ] . the remaining unknown in equation ( [ eqn : time ] ) is the number of microlenses , @xmath11 , for each ( @xmath82 ) pair , which we calculate from equation ( [ eqn : nstar ] ) .",
    "we also need to determine the total number of ( @xmath26 , @xmath25 ) combinations to cover parameter space .",
    "to avoid making any assumptions about the particular lens system each parameter combination represents , we suggest that unifom tiling of @xmath26@xmath25 parameter space is the most conceptually appealing approach .",
    "it is likely that a single ( @xmath82 ) combination will be relevant for more than one lensing system due to degeneracies in @xmath63 . by examining published macromodel parameters for known microlensed quasars ( see table [ tab : models ] and red symbols in figure [ fig : time_contour ] )",
    "we see that choosing a maximum @xmath83 gives us good coverage .",
    "we choose uniform increments @xmath84 , consistent with the accuracy of most of the quoted macrolens models .",
    "this results in a @xmath85 sampling of @xmath26@xmath25 parameter space ( @xmath86 is excluded , as in this case there are no microlenses ) .",
    "we obtain timing results for 10 values of the smooth matter fraction @xmath87 per ( @xmath26 , @xmath25 ) combination .",
    "the smooth matter fraction ranges from @xmath88 in increments of @xmath89 . for a given ( @xmath26 , @xmath25 ) combination , increasing the smooth matter fraction decreases the number of stars @xmath11 .",
    "this is accounted for in our timing results .",
    "we note that although we have attempted to collate all the ( @xmath26 , @xmath25 ) combinations in the literature for table [ tab : models ] , the list may not be complete .",
    "in addition , many authors publish enough information on lens macromodels to extract convergences and shears , but do not quote the values explicitly ( see for example table 6 in @xcite ) .",
    "we do not include such models in our analysis .",
    "timing contour plots are provided in figures [ fig : time_contour ] and [ fig : time_mask ] .",
    "the grayscale in both figures ranges from 0 hours ( white ) to greater than or equal to 24 hours ( black ) .",
    "note that these are actual hours , not device hours .",
    "( gstar@xmath20 ) hour corresponds to @xmath43 ( @xmath90 ) computations in one real hour . ]",
    "overplotted in both figures ( red stars ) are the models from the literature ( see table [ tab : models ] ) .",
    "figure [ fig : time_contour ] shows the complete timing ; the white line indicating points where @xmath91 or @xmath92 equal zero corresponds to magnification maps that are formally infinite in size , and hence are excluded from our computation . figure [ fig : time_mask ] shows timing coverage with regions requiring @xmath93 gstar@xmath19 day to process masked out .    in table",
    "[ tab : options ] , we present six possible strategies for a gpu - enabled microlensing parameter survey .",
    "the first , labelled ` complete ' , assumes that there are no limitations on the time we can run the survey .",
    "parameter space is completely covered , at the map size and resolution that best suits the large microlensing simulations we would ideally like to run ( see section [ sec : determine ] ) .",
    "obviously , this parameter set is impractical ; it would require running gstar@xmath19 ( gstar@xmath20 ) non - stop for @xmath94 ( @xmath95 ) years !    in the ` realistic ' strategy ,",
    "we sacrifice both map size and pixel resolution in order to speed up the time to complete the simulations . in addition , we exclude from this strategy any magnification map that requires more than 1 gstar@xmath19 ( gstar@xmath20 ) day to simulate .",
    "this amounts to 739 ( 215 ) excluded combinations of @xmath26 and @xmath25 , or @xmath96 ( @xmath97 ) percent of the total number of simulations .",
    "the simulation time is a more reasonable @xmath98 gstar@xmath19 days ( @xmath99 gstar@xmath20 days )",
    ".    simulation strategy ` stage 1 ' gives an indication of the time required to produce one magnification map for each of the model parameters in table [ tab : models ] .",
    "all of the models in that table , representing most ( if not all ) microlensing models in the literature , would be simulated in @xmath100 gstar@xmath19 days ( @xmath101 gstar@xmath20 days ) using gpu - d . starting with this strategy , successive processing stages",
    "can then fill in the rest of parameter space , moving outwards in regions centred around the current known models ( stages 24 ) .",
    "we note that a significant amount of simulation time is spent in maps where @xmath91 or @xmath92 are close to zero .",
    "we have chosen not to include maps with simulation times greater than 1 gstar day in our timing .",
    "if this cutoff were reduced to 1 gstar hour , the ` realistic ' strategy would take @xmath102 gstar@xmath19 days ( @xmath103 gstar@xmath20 days ) , with 1617 ( 657 ) fewer ( @xmath26 , @xmath25 ) combinations .      considering the total ( unmasked ) @xmath26@xmath25 parameter space sampled @xmath104 times for a single smooth matter value , and with no repeat maps ,",
    "the total uncompressed data volume is @xmath105 tb . with consideration of appropriate data types , file formats , the use of compression , and an appropriate database infrastructure to handle queries and map retrieval",
    ", we assert that data storage and service is reasonable .",
    "magnification maps do not have negative values , so we can use an unsigned data type . for",
    "the parameters we propose , an unsigned short integer ( 16-bit ) should be sufficient in most cases ( for typical @xmath106 ) , as this gives us a range from @xmath107 discrete values .",
    "if there are cases where individual pixel values are @xmath108 , it is unlikely that there are @xmath109 distinct magnification values .",
    "in such a case , pixel values can be remapped into the range @xmath110 , and an index array can be built and stored as metadata . in uncompressed form , and writing maps in a binary file format , a single @xmath111 map requires 191 mb of storage .    to examine the likely effects of compression , we generate ten maps with randomly assigned values ( up to @xmath109 ) for each pixel .",
    "we then trial two standard unix compression tools , gzip and bzip2 , and record the compression ratio and the times to compress and decompress .",
    "we find that gzip compresses the random maps consistently to 171 mb with compression and decompression times below 16 sec and 5 sec respectively .",
    "compare this with 157 mb file sizes for bzip2 , and @xmath112 sec for compression and @xmath113 sec for decompression .",
    "we expect compression of real maps to be somewhat better than random pixels , as the range of per pixel values should be lower than a uniform distribution over @xmath114 .",
    "the presence of caustic structures means that there are sequences of repeated values in the maps , which tends to aid with the run - length encoding of gzip , and the block - based compression of bzip2 .",
    "we tested compression of a magnification map with @xmath115 , @xmath116 , corresponding to the @xmath117 model for image @xmath35 in in @xcite . for a @xmath2-pixel map , and @xmath118 ,",
    "the count range was @xmath119 . in this case ,",
    "gzip and bzip2 reduced the file size to 113 mb and 80 mb respectively .",
    "times to compress and uncompress the map were 23 sec and 5 sec for gzip and 26 sec and 13 sec for bzip2 . despite the slightly longer decompression times , which is actually the more critical factor for accessing data stored on disk in compressed form",
    ", our testing suggests that bzip2 is the preferred alternative , with likely compression ratios between @xmath120 per cent and @xmath121 per cent .",
    "these estimates are consistent with the compression ratios of 2.5 ( 40 per cent ) to 3 ( 33 per cent ) for ogle data reported by @xcite .",
    "the overhead in decompressing any given map for analysis is small compared to the time taken to generate the map or to transfer large numbers of maps over ethernet . as the cost per tb of data storage continues to decrease at a rapid rate ,",
    "we conclude that data storage and access , even with repeat maps and sampling of smooth matter values , is not a significant concern .",
    "an efficient , web - based data delivery mechanism would be required to serve sets of maps on the basis of user requests , and we are currently considering options .",
    "we now present an example of one possible use for a microlensing parameter survey . in this section",
    "we analyse the effect of varying lensing parameters ( specifically @xmath26 and @xmath25 ) on accretion disc constraints .    as discussed in section 1 , lens macro - models are not uniquely determined . in systems where a wealth of observational data is available , complex models of the mass distribution in the lensing galaxy can be constructed ( see for example the q2237 + 0305 model of @xcite ) . more often , relatively simple parametric models are used to describe the lens mass distribution .",
    "these models are typically found to fit the lensed image positions adequately within observational errors , although additional mass components ( perhaps due to other nearby galaxies , e.g. @xcite ) are sometimes required .",
    "the main uncertainty in these models is the percentage of the surface density in smoothly distributed matter .",
    "this uncertainty has been included in many microlensing analyses , either as a free parameter in accretion disc measurements , or as the parameter of interest in analyses of lens dark matter fractions ( see especially @xcite ; @xcite ; @xcite ) .",
    "this uncertainty is typically confronted in one of two different ways . in the first technique ,",
    "the galaxy is modelled with a de vaucoulers profile embedded in a navarro - frenk - white ( nfw ) halo ( e.g. @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) .",
    "the mass to light ratio is varied , typically from 1 ( no nfw halo ) to 0.1 ( nfw halo dominates the mass distribution ) .",
    "this results in a sequence of lens macro - models , from which microlensing convergences and shears can be extracted .    in the second technique ,",
    "a single macro - model is produced ( usually a singular isothermal ellipse with external shear ) to describe the lensing galaxy ( e.g. @xcite ; @xcite ; @xcite ) .",
    "a single set of microlensing convergences and shears are obtained from this model .",
    "the unknown smooth matter fraction is then accounted for by allowing the smooth @xmath27 and stellar @xmath28 components of the convergence to vary , subject to the constraint @xmath29 .",
    "we have assumed this second technique in our discussion on survey design , however we note that the magnification maps generated by such a survey are equally useful regardless of lens modelling technique .",
    "since a variety of lens modelling techniques are used , each providing acceptable fits to lensed image positions , it is reasonable to ask whether source quasar parameters can be uniquely determined from microlensing observations .",
    "we present a first attempt at a comparison between accretion disc constraints obtained using different lens models here .",
    "we obtain our accretion disc constraints using a single - epoch imaging technique very similar to that presented in @xcite and @xcite .",
    "a similar analysis could ( and should ) be undertaken for the lightcurve technique @xcite , but is beyond the scope of this paper .",
    "as an additional benefit , this analysis offers the first opportunity for a direct comparison between accretion disc parameters obtained using the lightcurve technique and the single - epoch imaging technique .",
    "the observational data we use , consisting of pseudo - broadband photometry of the lensed quasar , was presented and analysed using the lightcurve technique in @xcite .",
    "the single - epoch microlensing simulation technique we use here was first presented in @xcite .",
    "the goal is to constrain both the radius of the accretion disc @xmath122 ( at a particular wavelength @xmath123 ) , and the power - law index @xmath124 relating accretion disc radius @xmath125 to observed wavelength @xmath126 . in other words , we model the quasar accretion disc of using the following relationship :    @xmath127    where @xmath123 is taken to be the central wavelength of the bluest filter in which observations were taken .",
    "the full simulation technique will not be repeated here ; it is described in full detail in section 3 of @xcite .",
    "there are three key differences between the analysis presented in that paper , and the analysis presented here .",
    "first , our magnification maps have a fixed microlens mass of @xmath128 .",
    "secondly , we use logarithmic bayesian priors for source radius @xmath125 , rather than the constant priors used in our previous analyses .",
    "logarithmic priors ensure that the ratio of prior probability for two values of source size does not depend on the units chosen .",
    "this choice also allows us to compare more directly with previous work by other authors .",
    "and thirdly , we set the smooth matter percentage in the lensing galaxy at the image positions to zero .",
    "this is reasonable because the lensed images lie in the bulge of the lensing galaxy , where stars are expected to dominate the mass distribution .",
    "the result of this analysis technique is an a posteriori probability distribution for radius of the quasar accretion disc in the bluest filter @xmath122 , and power - law index @xmath124 relating accretion disc radius to observed wavelength . for our purposes here , we will compare the extracted 68 per cent confidence limits on those two parameters .",
    "we used lensing models for from two sources : @xcite and @xcite . in @xcite ,",
    "the authors modelled four lensing systems with a simple family of lensing galaxy models , parameterised by the power - law index @xmath66 of the lensing potential with respect to radius @xmath129 .",
    "microlensing parameters were quoted for three values of @xmath66 : 0.5 , 1.0 ( the commonly used singular isothermal sphere model ) and 1.5 .",
    "these three models allow us to test the effect of varying microlensing parameters on our accretion disc constraints .",
    "we also use the microlensing parameters from @xcite , where the lensing galaxy was modelled as a singular isothermal ellipsoid ( sie ) with external shear .",
    "this allows us to directly compare results obtained using our single - epoch imaging technique with results obtained using the lightcurve technique in @xcite .",
    "the parameters are found in table [ tab:2237_models ] .",
    "the observational data were obtained from @xcite , who conducted spectroscopic monitoring of using the vlt across a three year time period .",
    "the data , originally fors1 spectra , were deconvolved into a broad emission line component , a continuum emission component , and an iron pseudo - continuum .",
    "the continuum emission was fit with a power law of the form @xmath130 .",
    "@xcite then split the continuum into six wavelength bands , each with a width of 250  in the quasar rest frame , and integrated the continuum power - law in each band .",
    "the result is pseudo - broadband photometry in six wavebands , with contamination from broad emission lines and the iron continuum removed .",
    "@xcite contains analysis of 39 of their 43 epochs using the lightcurve fitting technique of @xcite .    here , we use two epochs of the @xcite data , separated by a year , and presented in table [ tab:2237_ratios ] .",
    "we analyse one image combination : @xmath131 .",
    "there is no reason in principle why the other images could not also be analysed .",
    "here we choose @xmath131 both to cut down on simulation time , and to allow direct comparison with the @xcite results ( which also only use the @xmath131 image combination ) .",
    "probability distributions for @xmath122 and @xmath124 are obtained for each epoch separately , and then combined together to obtain our final results .",
    "results are quoted in units of the einstein radius @xmath63 ( see equation [ eqn : er ] ) . for , this is @xmath132 cm .",
    "we present 68 per cent confidence limits on @xmath124 and @xmath122 for all three models in table [ tab : results ] .",
    "the @xcite results for their two cases ( with and without a velocity prior ) are provided for comparison .",
    "the first thing to note is that within their errors , the constraints on both @xmath122 and @xmath124 agree for all models .",
    "this suggests that at the current level of accuracy , microlensing - based measurements of accretion disc parameters are likely to be consistent even when different lensing models are used .",
    "however , there are some trends in our results which are worth discussing .",
    "if we look first at the three @xcite models , we see that as @xmath66 is increased from 0.5 to 1.5 , so the peak value of @xmath124 increases .",
    "it is difficult to disentangle what is causing this , however the most striking variation in the magnification maps as @xmath66 increases is an increase in the number of microlenses .",
    "the @xmath133 magnification maps are much more densely packed with caustic structure than their @xmath134 counterparts .",
    "if we compare now the results obtained using the single - epoch imaging technique ( the @xcite lens model ) to results obtained using the lightcurve technique ( the @xcite results ) , there are a few differences .",
    "firstly , the lightcurve technique produces smaller errors .",
    "this is nt surprising ; we analysed two epochs of data for the single - epoch imaging technique , whereas eigenbrod and collaborators analysed 39 epochs of data .",
    "secondly , for the same microlensing parameters the single - epoch technique results in slightly lower ( although still consistent ) values for @xmath124 than the lightcurve technique .",
    "whether this last effect is generically true would require more systems for comparison .",
    "as a crucial step in preparing for this influx of new lensed systems that the synoptic survey era promises to deliver , a large - scale exploration of microlensing convergence - shear parameter space is warranted . in this paper , we have described how a such a parameter space survey could be achieved using a modern gpu - based supercomputing facility , and our experiences with the gpu - d code ( @xcite ; @xcite ) .",
    "this results in a @xmath85 sampling of @xmath26@xmath25 parameter space for each @xmath53-value .",
    "the number of rays shot per pixel @xmath39 was found to be sufficient to produce accurate magnification maps using the gpu - d code in @xcite .",
    "the pixel resolution and map size represent an acceptable compromise between the need to resolve the last stable orbit of a schwarzschild supermassive black hole @xmath49 , and the need for large enough maps to conduct microlensing simulations of quasar broad emission line regions and long light curves .",
    "we collated microlensing models from the literature , and used them to suggest ways in which @xmath26@xmath25 parameter space could be masked to reduce simulation time .",
    "in addition , a large portion of simulation time is spent in relatively few maps , where @xmath91 or @xmath92 are close to zero . masking out any maps with projected simulation times greater than 1 day using the entire facility",
    "enables swifter completion of the survey , at the risk of missing some interesting areas of parameter space . with these restrictions in place",
    ", we estimate a total simulation time of @xmath98 days utilising the entirety of a 100 teraflop / s facility ( gstar@xmath19 ) , or @xmath99 days on a 600 teraflop / s facilty ( gstar@xmath20 ) .",
    "realistic scheduling requirements for a high - demand supercomputer will increase the total wall - time required , so a staged strategy starting with parameters for the currently known microlensed quasars , would support early science usage .",
    "finally , we have provided an example of one possible application for a large microlensing parameter survey .",
    "we used four different microlensing parameter sets to take a preliminary look at the systematic effects of varying lens models on accretion disc constraints in the lensed quasar q2237 + 0305 .",
    "although all of the lens models produce results that are consistent within their errors , we note that there are suggestions that models with denser microlensing environments lead to shallower accretion disc temperature profile predictions .",
    "this research was supported under australian research council s discovery projects funding scheme ( project number dp0665574 ) .",
    "we are grateful to alex thompson for his work on the gpu - d code .",
    "our referee provided very helpful suggestions , that improved the quality of the work .",
    "keller , s. c. , schmidt , b. p. , bessell , m. s. , conroy , p. g. , francis , p. , granlund , a. , kowald , e. , oates , a. p. , martin - jones , t. , preston , t. , tisserand , p. , vaccarella , a. , waterson , m. f. 2007 , , 24 , 1                                                                                       for each of the 59 lensing systems with both source and lens redshifts on the castles survey webpage ( http://cfa-www.harvard.edu/glensdata/ ) .",
    "the einstein radius is calculated for a @xmath141 lens .",
    "the solid line indicates the mean @xmath63 , and the dashed lines the standard deviation.[fig : mean_er ] ]    lcc & 1 & ( 4 ) + & 10 & ( 7 ) + & 3 & ( 13 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 2 & ( 4 ) , ( 5 ) + & 13 & ( 2 ) , ( 4 ) , ( 6 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 11 & ( 4 ) , ( 7 ) + & 5 & ( 4 ) , ( 8) , ( 13 ) + & 11 & ( 1 ) , ( 4 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 4 & ( 4 ) , ( 13 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 1 & ( 4 ) + & 12 & ( 3 ) , ( 9 ) , ( 10 ) , ( 11 ) , ( 12 ) , ( 13 ) +    lccccl complete & 50 & 16500 & 115 years & 19 years & full parameter space simulation + realistic & 25 & 10000 & 414 days & 167 days & + stage 1 & 25 & 10000 & 122 days & 40 days & one map at each table [ tab : models ] model position + stage 2 & 25 & 10000 & 177 days & 59 days & maps at table [ tab : models ] model positions @xmath142 + stage 3 & 25 & 10000 & 332 days & 140 days & maps at table [ tab : models ] model positions @xmath143 + stage 4 & 25 & 10000 & 392 days & 157 days & maps at table [ tab : models ] model positions @xmath144 +    lccccl @xmath145 & @xmath35 & 0.228 & 0.603 & 4.3 & ( 1 ) + & @xmath146 & 0.223 & 0.582 & 3.8 & + & @xmath147 & 0.289 & 0.964 & -2.4 & + & @xmath148 & 0.261 & 0.880 & -4.4 & + @xmath117 & @xmath35 & 0.471 & 0.416 & 9.4 & ( 1 ) + & @xmath146 & 0.464 & 0.406 & 8.1 & + & @xmath147 & 0.552 & 0.617 & -5.6 & + & @xmath148 & 0.515 & 0.579 & -10.0 & + @xmath133 & @xmath35 & 0.728 & 0.215 & 36.5 & ( 1 ) + & @xmath146 & 0.723 & 0.212 & 31.3 & + & @xmath147 & 0.789 & 0.296 & -23.3 & + & @xmath148 & 0.761 & 0.286 & -40.7 & + sie@xmath149 & @xmath35 & 0.394 & 0.395 & 4.7 & ( 2 ) + & @xmath146 & 0.375 & 0.390 & 4.2 & + & @xmath147 & 0.743 & 0.733 & -2.1 & + & @xmath148 & 0.635 & 0.623 & -3.9 & +    lrrlll 1 & @xmath150 & @xmath151 & @xmath152 & @xmath153 & 2005 november 11 + 2 & @xmath154 & @xmath155 & @xmath156 & @xmath157 & 2005",
    "november 11 + 3 & @xmath158 & @xmath159 & @xmath160 & @xmath161 & 2005 november 11 + 4 & @xmath162 & @xmath163 & @xmath164 & @xmath165 & 2005 november 11 + 5 & @xmath166 & @xmath167 & @xmath168 & @xmath169 & 2005",
    "november 11 + 6 & @xmath170 & @xmath171 & @xmath172 & @xmath173 & 2005 november 11 + 1 & @xmath150 & @xmath151 & @xmath174 & @xmath175 & 2006 november 10 + 2 & @xmath154 & @xmath155 & @xmath176 & @xmath177 & 2006 november 10 + 3 & @xmath158 & @xmath178 & @xmath179 & @xmath180 & 2006 november 10 + 4 & @xmath162 & @xmath163 & @xmath181 & @xmath174 & 2006 november 10 + 5 & @xmath166 & @xmath167 & @xmath173 & @xmath176 & 2006 november 10 + 6 & @xmath170 & @xmath171 & @xmath182 & @xmath183 & 2006 november 10 +    lcc @xmath134 & @xmath184 & @xmath185 + @xmath117 & @xmath184 & @xmath186 + @xmath133 & @xmath187 & @xmath188 + @xcite model & @xmath189 & @xmath190 + @xcite velocity prior & @xmath191 & @xmath192 + @xcite no velocity prior & @xmath193 & @xmath194 +"
  ],
  "abstract_text": [
    "<S> in the era of synoptic surveys , the number of known gravitationally lensed quasars is set to increase by over an order of magnitude . </S>",
    "<S> these new discoveries will enable a move from single - quasar studies to investigations of statistical samples , presenting new opportunities to test theoretical models for the structure of quasar accretion discs and broad emission line regions ( belrs ) . </S>",
    "<S> as one crucial step in preparing for this influx of new lensed systems , a large - scale exploration of microlensing convergence - shear parameter space is warranted , requiring the computation of * @xmath0 * high resolution magnification maps . </S>",
    "<S> based on properties of known lensed quasars , and expectations from accretion disc / belr modelling , we identify regions of convergence - shear parameter space , map sizes , smooth matter fractions , and pixel resolutions that should be covered . </S>",
    "<S> we describe how the computationally time - consuming task of producing * @xmath1 * magnification maps with sufficient resolution ( @xmath2 pixel / map ) to probe scales from the inner edge of the accretion disc to the belr can be achieved in @xmath3 days on a 100 teraflop / s high performance computing facility , where the processing performance is achieved with graphics processing units . </S>",
    "<S> we illustrate a use - case for the parameter survey by investigating the effects of varying the lens macro - model on accretion disc constraints in the lensed quasar q2237 + 0305 . </S>",
    "<S> we find that although all constraints are consistent within their current error bars , models with more densely packed microlenses tend to predict shallower accretion disc radial temperature profiles . with a large parameter survey such as </S>",
    "<S> the one described here , such systematics on microlensing measurements could be fully explored . </S>"
  ]
}