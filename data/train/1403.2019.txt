{
  "article_text": [
    "at sufficiently high temperatures , such as existed in the early universe and reproduced in modern day relativistic heavy ion collider studies of the hot , ultra - dense state of matter called quark gluon plasma ( qgp ) , both particle creation and annihilation ( i.e. chemical ) processes and momentum exchanging ( i.e. kinetic ) scattering processes can occur sufficiently rapidly to establish complete thermal equilibrium . the most probable canonical distribution function @xmath3 of fermions ( + ) and bosons ( - ) in both chemical and kinetic equilibrium",
    "is found by maximizing microcanonical entropy subject to energy being conserved @xmath4 where @xmath5 is the particle energy , @xmath6 the temperature , and @xmath7 the chemical freeze - out temperature .",
    "for a physical system comprising _ interacting _ particles whose temperature is decreasing with time , there will be a period where the temperature is greater than the kinetic freeze - out temperature , @xmath8 , but below chemical freeze - out . during this period ,",
    "momentum exchanging processes continue to maintain an equilibrium distribution of energy among the available particles , which we call kinetic equilibrium , but particle number changing processes no longer occur rapidly enough to keep the equilibrium particle number yield . for @xmath9 the particle number changing processes have ` frozen - out ' . in this condition",
    "the momentum distribution , which is in kinetic equilibrium but chemical non - equilibrium , is obtained by maximizing microcanonical entropy subject to particle number and energy constraints and thus two parameters appear @xmath10 the need to preserve the total particle number within the distribution introduces an additional parameter @xmath11 called fugacity .",
    "a fugacity different from @xmath12 implies an over - abundance ( @xmath13 ) or under - abundance ( @xmath14 ) of particles compared to chemical equilibrium and in either of these situations one speaks of chemical non - equilibrium .",
    "we emphasize that in our context , the appearance of a dynamical fugacity @xmath15 is not related to conserved quantum numbers",
    ". conserved quantum numbers such as baryon number and charge introduce , through chemical potentials , fugacities that enhance e.g particles and deplete antiparticles . in the presence of conservation laws",
    "one has for particles @xmath16 and antiparticles @xmath17 where the quantity @xmath18 is the dynamical fugacity . for fermions ( + ) the distribution eq.([k_eq ] )",
    "always satisfies the fermi - dirac constraint @xmath19 , however the distribution of particles can approach much more closely the quantum degeneracy condition @xmath20 for @xmath21 .",
    "once the temperature drops below the kinetic freeze - out temperature @xmath8 we reach the free streaming period where particle scattering processes have completely frozen out and the resultant distribution is obtained by solving the collisionless boltzmann equation with initial condition as given by the chemical non - equilibrium distribution eq.([k_eq ] ) .",
    "as already indicated , the two transitions between these three regimes constitute the freeze - out process ",
    "first we have at @xmath7 the chemical freeze - out and at lower @xmath8 the kinetic freeze - out .",
    "exact chemical and kinetic equilibrium and sharp freeze - out transitions at @xmath7 and @xmath8 are only approximations .",
    "the boltzmann equation is a more precise model of the dynamics of the freeze - out process and furthermore , given the collision dynamics it is capable of capturing in a _ quantitative manner _ the non - thermal distortions from equilibrium , for example the emergence of actual distributions and the approximate values of @xmath7 , @xmath8 , and @xmath11 . indeed , in such a dynamical description",
    "no hypothesis about the presence of kinetic or chemical ( non ) equilibrium needs to be made , as the distribution similar to eq.([k_eq ] ) with @xmath22 emerges naturally as the outcome of collision processes , even when the particle system approaches the freeze - out temperature domain in chemical equilibrium .    considering this physical situation",
    "it is striking that the literature on boltzmann solvers does not reflect on the accommodation of emergent chemical non - equilibrium into the method of solution .",
    "for an all - numerical solver this may not be a necessary step as long as there are no constraints that preclude development of a general non - equilibrium solution .",
    "however , when strong chemical non - equilibrium is present either in the intermediate time period or / and at the end of the evolution a brute force approach can be very costly in computer time .",
    "motivated by this circumstance and past work with physical environments in which chemical non - equilibrium arose , we introduce here a spectral method for solving the boltzmann equation that utilizes a dynamical basis of orthogonal polynomials which is adapted to the case of emerging chemical non - equilibrium .",
    "we validate our method via a model problem that captures the essential physical characteristics of interest and use it to highlight the type of situation where this new method exhibits its advantages .    in the cosmological neutrino freeze - out context",
    ", the general relativistic boltzmann equation has been used to study neutrino freeze - out in the early universe and has been successfully solved using both discretization in momentum space @xcite and a spectral method based on a fixed basis of orthogonal polynomials @xcite . in refs.@xcite",
    "the non - relativistic boltzmann equation was solved via a spectral method similar in one important mathematical idea to the approach we present here . for near equilibrium solutions ,",
    "the spectral methods have the advantage of requiring a relatively small number of modes to obtain an accurate solution , as opposed to momentum space discretization which in general leads to a large highly coupled nonlinear system of odes irrespective of the near equilibrium nature of the system .",
    "the efficacy of the spectral method used in @xcite can largely be attributed to the fact that , under the conditions considered there , the true solution is very close to a chemical equilibrium distribution eq.([ch_eq ] ) where the temperature is controlled by the dilution of the system .",
    "however , the recent planck cmb results @xcite indicate the possibility that neutrinos participated in reheating to a greater degree than previously believed . as we discussed recently  @xcite this can also lead to a more pronounced chemical non - equilibrium . efficiently obtaining this emergent chemical non - equilibrium within realm of kinetic theory",
    "motivates the development of a new numerical method that adapts to this new circumstance .    with this novel boltzmann solver we present here it is also possible to return to the exploration of the emergent chemical non - equilibrium in processes governing laboratory qgp physics .",
    "indeed , the study of chemical non - equilibrium as a separate process from kinetic equilibrium has its roots in the field of laboratory qgp formation and observation , of which one of the proposed observables is the newly produced strange quark flavor  @xcite .",
    "the chemical non - equilibrium analysis method  @xcite is today the only successful statistical hadronization model for experimental results  @xcite confirming chemical non - equilibrium for all strongly interacting particles produced by a qgp fireball  @xcite .",
    "this paper establishes our new method for the case of ultra - relativistic particles does not address the pertinent physical applications in neutrino cosmology or quark - gluon plasma physics .",
    "the former is treated in our paper @xcite and the later will be a subject of future work . while in this work we address the case where the mass - scale of particles is entirely irrelevant , we have also developed a similar method for the case that the particle mass is non - negligible .",
    "introduction of a mass scale presents no major conceptual modifications , but requires detailed technical modifications from the simpler scheme we present here that do nt lend themselves well to a simultaneous presentation of both methods .",
    "the method including mass will be introduced and addressed in the context of specific applications of the method in future publications .    in section [ boltzmann_basics ]",
    "we give a basic overview of the relativistic boltzmann equation in the format aiming to address the early universe neutrino freeze - out process , but which can be easily recast into the format appropriate for other applications . in section [ the_method ]",
    "we discuss our modified spectral method in detail . in subsection [ free_stream_approach ]",
    "we recall the orthogonal polynomial basis used in @xcite and in subsection [ kinetic_eq_approach ] we introduce our modified basis and characterize precisely the differences in the method we propose .",
    "we compare these two bases in subsection [ basis_comparison ] . in subsection [ dynamics_sec ]",
    "we use the boltzmann equation to derive the dynamics of the mode coefficients and identify physically motivated evolution equations for the effective temperature and fugacity . in section [ validation ]",
    "we validate the method using a model problem . in [ orthopoly_app ]",
    "we give further details on the construction of the parametrized family orthogonal polynomials we use to solve the boltzmann equation .",
    "consider the relativistic bolzmann equation for systems of fermions under the assumption of homogeneity and isotropy .",
    "we assume that the particle are effectively massless i.e. the temperature is much greater than the mass scale and use the sign convention @xmath23 .",
    "homogeneity and isotropy in a given reference frame imply that the distribution function of each particle species under consideration has the form @xmath24 in that frame .",
    "here @xmath25 is the magnitude of the relativistic momentum , related to the relativistic energy @xmath5 by the usual relation @xmath26 , where @xmath27 is the particle mass . under such assumptions",
    ", the boltzmann equation reduces to @xmath28,\\hspace{2 mm } h=\\frac{\\dot{a}}{a}\\ ] ] where @xmath29 is the particle distribution function and we drop from now on the upper fermi index ( + ) .    in eq.([boltzmann_p ] ) we have allowed for a dilution of the system , encoded in the linear scale factor @xmath30 . in cosmological applications it represents the scale factor of the universe and @xmath31 a dilution rate called the hubble parameter .",
    "we do not specify its dynamics here , as that is application specific .",
    "when validating our method , we will use an externally prescribed function motivated by applications to cosmology . for a more in depth discussion of the relativistic boltzmann equation",
    "see for example @xcite .",
    "the term @xmath32 $ ] on the right hand side of the boltzmann equation is called the collision operator and models the short range scattering processes that cause deviations from geodesic motion . for @xmath33 reactions between fermions , such as neutrinos",
    ", the collision operator takes the form @xmath34=&\\frac{1}{2}\\int f(p_1,p_2,p_3,p_4 ) s |\\mathcal{m}|^2(2\\pi)^4\\delta(\\delta p)\\prod_{i=2}^4\\frac{d^{3}p_i}{2(2\\pi)^3e_i},\\\\ f=&f_3(p_3)f_4(p_4)f^1(p_1)f^2(p_2)-f_1(p_1)f_2(p_2)f^3(p_3)f^4(p_4),\\hspace{2 mm } f^i=1- f_i.\\notag\\end{aligned}\\ ] ] here @xmath35 is the process amplitude and @xmath36 is a numerical factor that incorporates symmetries and prevents over - counting .",
    "there are many references that discuss the matrix elements required to simulate various application domains , such as neutrino freeze - out @xcite , or strong interaction processes in qgp and hadron gas  @xcite . in the analysis of our method in this work",
    ", we will use an idealized version of the collision operator in order to avoid the details of any particular application domain .",
    "for an example of an application of the here presented method to a physically realistic problem see @xcite , where we study the freeze - out of cosmological neutrinos .",
    "the distribution @xmath37 is normalized so that the particle number density is given by @xmath38 where @xmath39 is the degeneracy of the particle species .",
    "the energy density and pressure associated with the distribution function @xmath37 are obtained from the stress energy tensor @xmath40 we emphasize that all momenta appearing in this work are the physical momenta and not , for example , the coordinate momenta in coordinates where the cosmological metric tensor takes the form @xmath41 ( i.e. we work in an orthonormal basis for the tangent spaces ) . in particular",
    "this means the usual relation familiar from special relativity , @xmath42 , holds .",
    "the only essential difference between using these results in a special relativistic versus cosmological context is whether or not @xmath30 is allowed to change in time . because of this",
    ", the energy density @xmath43 is @xmath44    the boltzmann equation eq.([boltzmann_p ] ) can be simplified by the method of characteristics .",
    "writing @xmath45 and reverting back to call the new distribution @xmath46 , the 2nd term in eq.([boltzmann_p ] ) cancels out and the evolution in time can be studied directly .",
    "this transformation implies for the rate of change in the particle number density and energy density @xmath47 \\frac{d^3p}{e}.\\\\ \\label{rho_div } \\frac{1}{a^4}\\frac{d}{dt}(a^4\\rho_1)=&\\frac{g_p}{(2\\pi)^3}\\int c[f_1 ] d^3p .\\end{aligned}\\ ] ] for free - streaming particles the vanishing of the collision operator implies conservation of ` comoving ' particle number of species 1 . from the associated powers of @xmath48 in eq.([n_div ] ) and eq.([rho_div ] ) we see that the energy per free streaming particle as measured by an observer scales as @xmath49 .",
    "here we outline the approach for solving eq.([a_vars ] ) used in @xcite in order to contrast it with our approach as presented in subsection [ kinetic_eq_approach ] . as just discussed , the boltzmann equation is a linear first order partial differential equation and can be reduced using a new variable @xmath50 via the method of characteristics and exactly solved in the collision free ( @xmath32=0)$ ] limit .",
    "this motivates a change of variables from @xmath25 to @xmath51 which eliminates the momentum derivative , leaving the simplified equation @xmath52.\\ ] ]    we let @xmath53 be the orthonormal polynomial basis on the interval @xmath54 with respect to the weight function @xmath55 constructed as in [ orthopoly_app ] .",
    "@xmath56 is the fermi - dirac chemical equilibrium distribution for massless fermions and temperature @xmath57 .",
    "therefore this ansatz is well suited to distributions that are manifestly in chemical equilibrium ( @xmath58 ) or remain close and with @xmath59 , which we call dilution temperature scaling .",
    "assuming that @xmath37 is such a distribution motivates the decomposition @xmath60    using this ansatz equation eq.([a_vars ] ) becomes @xmath61dy.\\ ] ] because of eq.([free_stream_ansatz ] ) , we call this the chemical equilibrium method",
    ".    we also have the following expressions for the particle number density and energy density @xmath62    note that the sums truncate at @xmath63 and @xmath64 terms respectively , due to the fact that @xmath65 is orthogonal to all polynomials of degree less than @xmath66 .",
    "this implies that in general , at least four modes are required to capture both the particle number and energy flow .",
    "more modes are needed if the non - thermal distortions are large and the back reaction of higher modes on lower modes is significant .",
    "our primary interest is in solving eq.([t_vars ] ) for systems close to the kinetic equilibrium distribution eq.([k_eq ] ) but not necessarily in chemical equilibrium , a task for which the method in the previous section is not well suited in general . for a general kinetic equilibrium distribution ,",
    "the temperature does not necessarily scale as @xmath59 i.e. the temperature is not controlled solely by dilution .",
    "for this reason , we will find it more useful to make the change of variables @xmath67 rather than the scaling used in eq.([a_vars ] ) . here",
    "@xmath0 is to be viewed as the time dependent effective temperature of the distribution @xmath37 , a notion we will make precise later . with this change of variables , the boltzmann equation becomes @xmath68.\\ ] ]    to model a distribution close to kinetic equilibrium at temperature @xmath6 and fugacity @xmath11 , we assume @xmath69 where the kinetic equilibrium distribution @xmath70 depends on @xmath71 because we are assuming @xmath11 is time dependent ( with dynamics to be specified later ) .    we will solve eq.([t_boltzmann ] ) by expanding @xmath72 in the basis of orthogonal polynomials , @xmath73 , generated by the parametrized weight function @xmath74 on the interval @xmath54 .",
    "see [ orthopoly_app ] for details on the construction of these polynomials and their dependence on the parameter @xmath11 .",
    "this choice of weight is physically motivated by the fact that we are interested in solutions that describe massless particles not too far from kinetic equilibrium , but far from chemical equilibrium .",
    "we call this the chemical non - equilibrium method .",
    "we emphasize that we have made three important changes as compared to the chemical equilibrium method :    1 .",
    "we allow a general time dependence of the effective temperature parameter @xmath6 , i.e. we do not assume dilution temperature scaling @xmath57 .",
    "we have replaced the chemical equilibrium distribution in the weight eq.([free_stream_weight ] ) with a chemical non - equilibrium distribution @xmath70 , i.e. we introduced @xmath11 .",
    "we have introduced an additional factor of @xmath75 to the functional form of the weight as proposed in a different context in refs.@xcite .",
    "we note that the authors of @xcite did consider the case of fixed chemical potential imposed as an initial condition .",
    "this is not the same as an emergent chemical non - equilibrium , i.e. time dependent @xmath11 , that we study here , nor do they consider a @xmath75 factor in the weight .",
    "we borrowed the idea for the @xmath75 prefactor from ref.@xcite , where it was found that including a @xmath75 factor along with the non - relativistic chemical equilibrium distribution in the weight improved the accuracy of their method .",
    "fortuitously , this will also allow us to capture the particle number and energy flow with fewer terms than required by the chemical equilibrium method . a suitably modified weight and method allows us to maintain these advantages when a particle mass scale becomes relevant .",
    "we return to this problem in a subsequent work .      before deriving the dynamical equations for the method outlined in section [ kinetic_eq_approach ]",
    ", we illustrate the error inherent in approximating the chemical non - equilibrium distribution eq.([k_eq ] ) with a chemical equilibrium distribution eq.([ch_eq ] ) whose temperature is @xmath57 . given a chemical non - equilibrium distribution @xmath76 we can attempt to write it as a perturbation of the chemical equilibrium distribution , @xmath77 as we would need to when using the method of section [ free_stream_approach ] .",
    "we expand @xmath78 in the orthonormal basis generated by @xmath56 and , using @xmath79 terms , form the @xmath79-mode approximation @xmath80 to @xmath81 .",
    "the @xmath82 are obtained by taking the @xmath83 inner product of @xmath84 with the basis function @xmath53 , @xmath85 figures [ fig : free_stream_f0_approx_ups_5 ] and [ fig : free_stream_f0_approx_ups_1_5 ] show the normalized @xmath86 errors between @xmath80 and @xmath81 , computed via @xmath87    we note the appearance of the reheating ratio @xmath88 in the denominator of eq.([zeroth_approx ] ) , which comes from changing variables from @xmath89 in eq.([weight ] ) to @xmath90 in order to compare with eq.([free_stream_weight ] ) .",
    "physically , @xmath91 is the ratio of the physical temperature @xmath6 to the dilution controlled temperature scaling of @xmath49 . in physical situations , including cosmology , @xmath91 can vary from unity when dimensioned energy scales influence dynamical equations for @xmath48 . from the error plots we see that for @xmath91 sufficiently close to @xmath12 , the approximation performs well with a small number of terms , even with @xmath92 .    ) as a function of number of modes , @xmath93 . ]    ) as a function of number of modes , @xmath93.,height=226 ]    for non - degenerate systems ( i.e. @xmath11 small ) the chemical non - equilibrium weight is close to the weight that generates the laguerre polynomials , @xmath94 . in figures [ fig : free_stream_mode_coeff ] and [ fig : laguerre_mode_coeff ] we show the mode coefficients for the expansion of @xmath95 in term of the the basis generated by @xmath56 and laguerre polynomials respectively .",
    "the hat denotes that we divide by the corresponding @xmath96 norm of @xmath81 in order to properly compare the two spaces .     in terms of the basis of laguerre polynomials . ]     in terms of the basis of laguerre polynomials.,height=226 ]    for @xmath97 and @xmath98 we have @xmath99 and so one expects the chemical equilibrium basis to provide a better approximation than laguerre polynomials .",
    "the mode coefficients are significantly higher in figure [ fig : laguerre_mode_coeff ] as compared to figure [ fig : free_stream_mode_coeff ] for the case @xmath100 , @xmath101 .",
    "this indicates a larger truncation error and hence a worse approximation using laguerre polynomials , as expected .",
    "we note that the regime in which the chemical equilibrium method was employed in @xcite was very close to @xmath58 , @xmath102 , making their use of the chemical equilibrium method an appropriate choice .",
    "in contrast , when the system is non - degenerate or when there is significant reheating we see that there is little to no advantage in using the chemical equilibrium basis over the basis of laguerre polynomials , as seen by the similar truncation errors between the two plots when @xmath103 and , to a slighly lesser degree , @xmath104 .",
    "it is in these situations where the chemical non - equilibrium method we present becomes most advantageous , being superior to both the laguerre and chemical equilibrium methods .    ) for @xmath58 and @xmath105 using the first @xmath106 basis elements generated by eq.([free_stream_weight ] ) . ]    ) for @xmath58 and @xmath105 using the first @xmath106 basis elements generated by eq.([free_stream_weight ] ) . ]    in the case of large reheating , we find that when @xmath91 approaches and surpasses @xmath107 , large spurious oscillations begin to appear in the expansion and they persist even when a large number of terms are used , as seen in figures [ fig : free_stream_f0_approx_ups_1_t_r_1_85 ] and [ fig : free_stream_f0_approx_ups_1_t_r_2 ] , where we compare @xmath108 with @xmath109 for @xmath58 and @xmath110 .",
    "the poor behavior arises from the fact that for @xmath111 , the perturbation @xmath84 from eq.([chi_def ] ) is no longer contained in the hilbert space @xmath83 .",
    "this can be seen as follows .",
    "the squared norm of @xmath84 is @xmath112 for @xmath51 large , the integrand can be approximated by @xmath113 which is not integrable for @xmath111 .",
    "this demonstrates that the chemical equilibrium method with dilution temperature scaling will perform poorly in situations that experience a large degree of reheating ( and so will laguerre polynomials for the same reason ) .",
    "the dynamical effective temperature that we introduce in the chemical non - equilibrium method will allow us to handle such cases without issue .    for @xmath98 ,",
    "the benefit of including fugacity is not as striking , as the chemical equilibrium basis is able to approximate eq.([zeroth_approx ] ) reasonably well .",
    "however , for more stringent error tolerances including @xmath11 can reduce the number of required modes in cases where the degree of chemical non - equilibrium is large .      in this section",
    "we derive the dynamical equations for the method outlined in section [ kinetic_eq_approach ] .",
    "in particular , we identify physically motivated dynamics for the effective temperature and fugacity . using eq.([t_boltzmann ] ) and the definition of @xmath72 from eq.([kinetic_approx ] ) we have @xmath114.\\end{aligned}\\ ] ] denote the monic orthogonal polynomial basis generated by the weight eq.([weight ] ) by @xmath115 , @xmath116 where @xmath115 is degree @xmath117 and call the normalized versions @xmath118 .",
    "recall that @xmath119 depend on @xmath71 due to the @xmath11 dependence of the weight function used in the construction .",
    "consider the space of polynomial of degree less than or equal to @xmath79 , spanned by @xmath119 , @xmath120 .",
    "for @xmath72 in this subspace , we expand @xmath121 and use eq.([near_equilib_eq ] ) to obtain @xmath122 . \\notag\\end{aligned}\\ ] ] from this we see that the equations obtained from the boltzmann equation by projecting onto the finite dimensional subspace are @xmath123,\\hat\\psi_k\\rangle\\notag\\end{aligned}\\ ] ] where @xmath124 denotes the inner product defined by the weight function eq.([weight ] ) @xmath125",
    "the term in brackets comprises the linear part of the system , while the collision term contains polynomial nonlinearities when multiple coupled distribution are being modeled using a @xmath107-@xmath107 collision operator eq.([coll ] ) .    to isolate the linear part ,",
    "we define matrices @xmath126 with these definitions , the equations for the @xmath127 become @xmath128,\\hat\\psi_k\\rangle.\\end{aligned}\\ ] ] see [ ortho - general ] for details on how to recursively construct the @xmath129 .",
    "we show how to compute the inner products @xmath130 in [ ortho - polynom - fam ] . in [ lower_triang ] we prove that that both @xmath131 and @xmath132 are lower triangular and show that the only inner products involving the @xmath133 that are required in order to compute @xmath131 and @xmath132 are those the above mentioned diagonal elements , @xmath130 .",
    "we fix the dynamics of @xmath6 and @xmath11 by imposing the conditions @xmath134 in other words , @xmath135 this reduces the number of degrees of freedom in eq.([b_eq ] ) from @xmath136 to @xmath137 .",
    "in other words , after enforcing eq.([b_ics ] ) , eq.([b_eq ] ) constitutes @xmath137 equations for the remaining @xmath137 unknowns , @xmath138 , @xmath11 , and @xmath6 .",
    "we will call @xmath6 and @xmath11 the first two  modes \" , as their dynamics arise from imposing the conditions eq.([b_ics ] ) on the zeroth and first order coefficients in the expansion .",
    "we will solve for their dynamics explicitly below .",
    "to see the physical motivation for the choices eq.([b_ics ] ) , consider the particle number density and energy density .",
    "using orthonormality of the @xmath139 and eq.([b_ics ] ) we have @xmath140 using these together with the definition of the weight function eq.([weight ] ) we find @xmath141    equations ( [ th_eq_moments ] ) and ( [ th_eq_moments2 ] ) show that the first two modes , @xmath6 and @xmath11 , with time evolution fixed by eq.([b_ics ] ) combine with the chemical non - equilibrium distribution @xmath70 to capture the particle number density and energy density of the system exactly .",
    "this fact is very significant , as it implies that within the chemical non - equilibrium approach as long as the back - reaction from the non - thermal distortions is small ( meaning that the evolution of @xmath0 and @xmath1 is not changed significantly when more modes are included ) , _ all the effects relevant to the computation of particle and energy flow are modeled by the time evolution of @xmath6 and @xmath11 alone _ and no further modes are necessary .",
    "this gives a clear separation between the averaged physical quantities , characterizing the time evolution of @xmath70 , and the momentum dependent non - thermal distortions as contained in @xmath142    one should contrast this chemical non - equilibrium behavior with the chemical equilibrium situation , where a minimum of four modes is required to describe the number and energy densities , as shown in eq.([free_stream_moments ] ) .",
    "moreover we will show that convergence to the desired precision is faster in the chemical non - equilibrium approach as compared to the chemical equilibrium . due to the high cost of numerically integrating realistic collision integrals of the form eq.([coll ] ) , this fact can be very significant in applications .",
    "we remark that the relations eq.([th_eq_moments ] ) are the physical motivation for including the @xmath75 factor in the weight function .",
    "all three modifications we have made in constructing our new method , the introduction of an effective temperature i.e. @xmath143 , the generalization to chemical non - equilibrium @xmath70 , and the introduction of @xmath75 to the weight , eq.([reheat ] ) , were needed to obtain the properties eq.([th_eq_moments ] ) , but it is the introduction of @xmath75 that reduces the number of required modes and hence reduces the computational cost .    with @xmath144 and @xmath145 fixed as in eq.([b_ics ] ) we can solve the equations for @xmath146 and @xmath147 from eq.([b_eq ] ) for @xmath148 and @xmath149 to obtain @xmath150,\\hat\\psi_0\\rangle-(ab)^0\\langle\\frac{1}{f_\\upsilon e}c[f],\\hat\\psi_1\\rangle } { [ \\upsilon\\partial_\\upsilon \\langle1,1\\rangle/(2||\\psi_0||)+(bb)^0](ab)^1-(ab)^0(bb)^1},\\\\[0.5 cm ] \\dot{t}/t = & \\frac{(bb)^1\\langle\\frac{1}{f_\\upsilon e}c[f],\\hat\\psi_0\\rangle-\\langle\\frac{1}{f_\\upsilon e}c[f],\\hat\\psi_1\\rangle[\\upsilon\\partial_\\upsilon \\langle1,1\\rangle/(2||\\psi_0||)+(bb)^0]}{[\\upsilon\\partial_\\upsilon \\langle1,1\\rangle/(2||\\psi_0||)+(bb)^0](ab)^1-(ab)^0(bb)^1}-h\\notag\\\\[0.3 cm ] = & \\frac{1}{(ab)^1}\\left((bb)^1\\dot{\\upsilon}/\\upsilon-\\langle\\frac{1}{f_\\upsilon e}c[f],\\hat\\psi_1\\rangle\\right)-h.\\label{t_eq}\\end{aligned}\\ ] ] here @xmath151 and similarly for @xmath132 and @xmath152 is the norm induced by @xmath124 . in deriving this",
    ", we used @xmath153 which comes from differentiating eq.([b_ics ] ) .",
    "it is easy to check that when the collision operator vanishes , then the above system is solved by @xmath154 i.e. the fugacity and non - thermal distortions are ` frozen ' into the distribution and the temperature satisfies dilution scaling @xmath59 .    when the collision term becomes small , eq.([free_stream_sol ] ) motivates another change of variables .",
    "letting @xmath155 gives the equation @xmath156,\\hat\\psi_1\\rangle\\right).\\ ] ] solving this in place of eq.([t_eq ] ) when the collision terms are small avoids having to numerically track the free - streaming evolution .",
    "in particular this will ensure conservation of comoving particle number , which equals a function of @xmath11 multiplied by @xmath157 , to much greater precision in this regime as well as resolve the freeze - out temperatures more accurately .",
    "the following calculation shows that , for a distribution initially in kinetic equilibrium , the determinant factor in the denominator of eq.([ups_t_eqs ] ) is nonzero and hence the dynamics for @xmath6 and @xmath11 , as well as the remainder of the projected system , are well - defined , at least for sufficiently small times .",
    "kinetic equilibrium implies the initial conditions @xmath158 , @xmath159 , @xmath160 . defining @xmath161 and",
    "using the definition eq.([a_b_matrices ] ) for @xmath132 we have @xmath162\\notag\\\\[0.3 cm ] \\equiv & k_1+k_2.\\notag\\end{aligned}\\ ] ] using the definitions of @xmath163 and @xmath164 from eq.([a_b_matrices ] ) we find @xmath165 inserting the formula for @xmath166 from eq.([poly_recursion ] ) we find @xmath167.\\end{aligned}\\ ] ] the cauchy - schwarz inequality applied to the inner product with weight function @xmath168 together with linear independence of @xmath12 and @xmath169 implies that the term in brackets is positive and so @xmath170 at @xmath171 . for the second term , noting that @xmath172 by orthogonality and using eq.([norm_deriv_eq ] ) , we have    @xmath173\\upsilon a_0 ^ 1||\\psi_0||\\\\ = & 0.\\notag\\end{aligned}\\ ] ]    this proves that @xmath174 is nonzero at @xmath171 .",
    "we will validate our numerical method on an exactly solvable model problem @xmath175 where @xmath176 is a constant with units of energy and we choose units in which it is equal to @xmath12 .",
    "this model describes a distribution that is attracted to a given equilibrium distribution at a prescribed time dependent temperature @xmath177 and fugacity @xmath11 .",
    "this type of an idealized scattering operator , without fugacity , was first introduced in @xcite . for an application of this method involving more complex collision terms of the form in eq.([coll ] ) see @xcite .    by changing coordinates",
    "@xmath50 we can rewrite eq.([toy_eq ] ) as @xmath178 + 1}-f(y , t).\\ ] ] which has as solution @xmath179 + 1}ds+\\frac{e^{-t}}{\\exp[y/(a(0)t_{eq}(0))]+1}.\\ ] ] we now transform to @xmath67 where the temperature @xmath6 of the distribution @xmath37 is defined as in section [ dynamics_sec ] .",
    "recalling that @xmath180 , we have the exact solution to @xmath181 given by @xmath182 + 1}ds\\\\ & + \\frac{e^{-t}}{\\exp[a(t)t(t)z/(a(0)t_{eq}(0))]+1}.\\notag\\end{aligned}\\ ] ] we use this to test the chemical equilibrium and chemical non - equilibrium methods under two different conditions .",
    "first we test the two methods we have outlined in a scenario that exhibits reheating .",
    "motivated by applications to cosmology , we choose a scale factor evolving as in the radiation dominated era , a fugacity @xmath58 , and choose an equilibrium temperature that exhibits reheating like behavior with @xmath183 increasing for a period of time , @xmath184 where @xmath91 is the desired reheating ratio .",
    "note that @xmath185 and @xmath186 as @xmath187 .",
    "qualitatively , this is reminiscent of the dynamics of neutrino freeze - out , but the range of reheating ratio for which we will test our method is larger than found there .",
    "we solved eq.([free_stream_toy ] ) and eq.([k_eq_toy ] ) numerically using the chemical equilibrium and chemical non - equilibrium methods respectively for @xmath188 $ ] and @xmath189 and the cases @xmath101 , @xmath190 , as well as the more extreme ratio of @xmath105 .",
    "the bases of orthogonal polynomials were generated numerically using the recursion relations from [ orthopoly_app ] .",
    "for the applications we are considering , where the solution is a small perturbation of equilibrium , only a small number of terms are required and so the numerical challenges associated with generating a large number of such orthogonal polynomials are not an issue .",
    "we solved eq.([free_stream_toy ] ) using the chemical equilibrium method , with the orthonormal basis defined by the weight function eq.([free_stream_weight ] ) for @xmath191 modes ( mode numbers @xmath192 ) and prescribed single step relative and absolute error tolerances of @xmath193 for the numerical integration , and with asymptotic reheating ratios of @xmath101 , @xmath190 , and @xmath105 .    in figures [ fig : free_stream_num_err ] and [ fig : free_stream_e_err ] we show the maximum relative error in the number densities and energy densities respectively over the time interval @xmath194 $ ] for various numbers of computed modes .",
    "the particle number density and energy density are accurate , up to the integration tolerance level , for @xmath63 or more and @xmath64 or more modes respectively .",
    "this is consistent with eq.([free_stream_moments ] ) which shows the number of modes required to capture each of these quantities .",
    "however , fewer modes than these minimum values lead to a large error in the corresponding moment of the distribution function .            to show that the numerical integration accurately captures the mode coefficients of the exact solution , eq.([exact_sol ] ) , we show the error between the computed coefficients and actual coefficients , denoted by @xmath195 and @xmath196 respectively @xmath197 in figure [ fig : free_stream_b_err ] , where the evolution of the system was computed using @xmath198 modes",
    ".     error between computed and exact solutions to @xmath199 norm of the exact solution.,height=226 ]     error between computed and exact solutions to @xmath199 norm of the exact solution.,height=230 ]    in figure [ fig : free_stream_l1_err ] we show the error between the exact solution @xmath37 , and the numerical solution @xmath200 computed using @xmath191 modes over the solution time interval , where we define the error by @xmath201 for @xmath102 and @xmath190 the chemical equilibrium method works reasonably well ( as long as the number of modes is at least 4 , so that the energy and number densities are properly captured ) but for @xmath105 the approximate solution exhibits spurious oscillations , as seen in figure [ fig : free_stream_approx_t_r_2 ] , and has poor @xmath199 error .",
    "this is expected based on the prior results obtained in section [ basis_comparison ] , as the exact solution is not in the hilbert space used by this method for @xmath111 .",
    "this is even clearer in figure [ fig : free_stream_l1_err_time ] where we show the @xmath199 error ratio as a function of time for @xmath198 modes . in the @xmath105 case",
    "we see that the error increases as the reheating ratio approaches its asymptotic value of @xmath105 as @xmath187 .",
    "as we will see , our methods achieves a much higher accuracy for a small number of terms in the case of large reheating ratio due to the replacement of dilution temperature scaling with the dynamical effective temperature @xmath6 .",
    "error ratio as a function of time for @xmath198 modes.,height=230 ]     error ratio as a function of time for @xmath198 modes.,height=230 ]      we now solve eq.([free_stream_toy ] ) using the chemical non - equilibrium method , with the orthonormal basis defined by the weight function eq.([weight ] ) for @xmath191 modes , a prescribed numerical integration tolerance of @xmath193 , and asymptotic reheating ratios of @xmath101 , @xmath190 , and @xmath105 .",
    "recall that we are referring to @xmath6 and @xmath11 as the first two modes ( @xmath202 and @xmath203 ) .    in figures [ fig : keq_num_err ] and [ fig : keq_e_err ]",
    "we show the maximum relative error over the time interval @xmath194 $ ] in the number densities and energy densities respectively for various numbers of computed modes . even for only @xmath107 modes ,",
    "the number and energy densities are accurate up to the integration tolerance level .",
    "this is in agreement with the analytical expressions in eq.([th_eq_moments ] ) .            to show that the numerical integration accurately captures the mode coefficients of the exact solution , eq.([exact_sol ] ) , we give the error in the computed mode coefficients eq.([mode_err_def ] ) , where the evolution of the system was computed using @xmath198 modes , in figure [ fig : keq_b_err ]",
    ".     error between computed and exact solutions to @xmath199 norm of the exact solution.,height=226 ]     error between computed and exact solutions to @xmath199 norm of the exact solution.,height=230 ]    in figure [ fig : keq_l1_err ] we show the error between the approximate and exact solutions , computed as in eq.([f_err ] ) for @xmath191 and @xmath101 , @xmath190 , and @xmath105 respectively . for most mode numbers and @xmath91 values ,",
    "the error using @xmath107 modes is substantially less than the error from the chemical equilibrium method using @xmath64 modes .",
    "the result is most dramatic for the case of large reheating , @xmath105 , where the spurious oscillations from the chemical equilibrium solution are absent , as seen in figure [ fig : keq_approx_tr_2 ] , as compared to the chemical equilibrium method in figure [ fig : free_stream_approx_t_r_2 ] .",
    "note that we plot from @xmath204 $ ] in comparison to @xmath205 $ ] in figure [ fig : keq_approx_tr_2 ] due to the relation @xmath206 as discussed in section [ basis_comparison ] .",
    "additionally , the error no longer increases as @xmath187 , as it did for the chemical equilibrium method , see figure [ fig : keq_l1_err_time ] .",
    "in fact it decreases since the exact solution approaches chemical equilibrium at a reheated temperature and hence can be better approximated by @xmath81 .    in summary ,",
    "in addition to the reduction in the computational cost when going from @xmath64 to @xmath107 modes , we also reduce the error compared to the chemical equilibrium method , all while still capturing the number and energy densities .",
    "we emphasize that the error in the number and energy densities is limited by the integration tolerance and _",
    "_ n__ot the number of modes ( so long as the neglected , higher modes have a negligible impact on the first two modes , as is often the case ) .     error ratio as a function of time for @xmath207 modes.,height=234 ]     error ratio as a function of time for @xmath207 modes.,height=234 ]      the model problem in the previous subsections with @xmath58 is reminiscent of the way that chemical equilibrium can emerge from chemical non - equilibrium in practice ; the distribution of interest is attracted to some chemical equilibrium distribution but the particle creation / annihilation processes are not able to keep up with the momentum exchange and maintain an equilibrium particle yield , and so a fugacity @xmath14 develops .",
    "however , in order to isolate the effects of the fugacity on the solutions , we will now solve eq.([toy_eq ] ) under the condition where our distribution is attracted to a fixed chemical non - equilibrium distribution .",
    "more specifically , we take @xmath208 and fugacities @xmath93 , @xmath100 , @xmath209 , and @xmath104 with @xmath30 defined as in eq.([a_t_def ] ) .",
    "the behavior of the energy and particle number density errors are essentially the same as in the reheating test presented above and the mode coefficients are accurately captured , so we do not show these quantities here .",
    "instead we show the maximum @xmath199 error , computed as in eq.([f_err ] ) in figure [ fig : free_stream_l1_err_ups ] for the chemical equilibrium method and in figure [ fig : k_eq_l1_err_ups ] for the chemical non - equilibrium method .",
    "the error when using the latter method with only two terms is comparable to the former with four terms .",
    "error between computed and exact solutions to @xmath199 norm of the exact solution using the chemical non - equilibrium method.,height=230 ]     error between computed and exact solutions to @xmath199 norm of the exact solution using the chemical non - equilibrium method.,height=230 ]     error between computed and exact solutions to @xmath199 norm of the exact solution using the chemical non - equilibrium method.,height=230 ]    in figure [ fig : k_eq_l1_err_ups_final ] we show the final value of the relative @xmath199 error , @xmath210 where the distribution functions are evaluated at @xmath211 .",
    "this figure is for the chemical non - equilibrium method applied to the chemical non - equilibrium attractor .",
    "the error tolerance for numerical integration was chosen small enough that the error is determined by the number of modes .",
    "the chemical non - equilibrium ansatz is able to represent the final asymptotic state accurately and so the final error is much smaller than the maximum error in figure [ fig : k_eq_l1_err_ups ] .",
    "for the chemical equilibrium ansatz the final error is nearly the same as the maximum error and so we do nt show it here .",
    "we have presented a spectral method for solving the relativistic boltzmann equation for a system of massless fermions diluting in time based on a dynamical basis of orthogonal polynomials .",
    "the method is adapted to systems evolving near kinetic equilibrium , but allows for potentially strong chemical non - equilibrium in a transient and/or final state as well as strong reheating i.e. decoupling of temperature scaling from dilution scaling .",
    "the method depends on two time dependent parameters , the effective temperature @xmath0 and phase space occupancy or fugacity @xmath1 , whose dynamics are isolated by the requirement that the lowest modes capture the energy and particle number densities .",
    "this gives the method a natural physical interpretation .",
    "in particular , the dynamical fugacity is capable of naturally expressing the emergence of chemical non - equilibrium during the freeze - out process while the effective temperature captures any reheating phenomenon .",
    "any system in approximate kinetic equilibrium that undergoes reheating and/or transitions to chemical non - equilibrium is a good match for this method .",
    "in fact it is almost assured that our method will be considerably more computationally economical than the chemical equilibrium spectral method for any physical system in which the cost of computing the collision terms is high .",
    "we validated the method on a model problem that exhibits the physical characteristics of reheating and chemical non - equilibrium .",
    "we demonstrated that particle number and energy densities are captured accurately using only two degrees of freedom , the effective temperature and fugacity .",
    "in general , this will hold so long as the back reaction from non - thermal distortions is small i.e. as long as kinetic equilibrium is a good approximation .    the method presented here should be compared to the spectral method used in @xcite , which uses a fixed basis of orthogonal polynomials and is adapted to systems that are close to chemical equilibrium ( or with a non - dynamical chemical potential in @xcite ) with dilution temperature scaling .",
    "in addition to more closely mirroring the physics of systems that exhibit reheating and chemical non - equilibrium , the method presented here has a computational advantage over the chemical equilibrium method .",
    "even when the system is close to chemical equilibrium with dilution temperature scaling , as is the case for the problem studied in @xcite , the method presented here reduces the minimum number of degrees of freedom needed to capture the particle number and energy densities from four to two . in turn , this reduces the minimum number of collision integrals that must be evaluated by more than half .    numerical evaluation of collision operators for realistic interactions is a costly operation and so the new ` emergent chemical non - equilibrium ' approach we have presented here constitutes a significant reduction in the numerical cost of obtaining solutions . moreover , even if the chemical equilibrium approach were to be properly modified to gain mathematical advantages we show in our chemical non - equilibrium approach , it is not at all clear that the chemical equilibrium method can , with comparable numerical effort , achieve a precise solution under conditions where transient or final chemical non - equilibrium and reheating are strong .    looking to future applications",
    ", the gain in numerical efficiency we achieved should allow both space and time evolution to be considered in non - trivial dynamical models such as evolution of quark - gluon plasma fireball formed in relativistic heavy ion collisions .",
    "we expect to be able to explore within the realm of boltzmann dynamics the question of ` ideal ' quark flow occurring at minimum viscosity  @xcite and the shape of momentum distributions which systematically deviate from a thermal distribution  @xcite .",
    "for study of the ensuing hadron flow it is of relevance that we have been able to find suitable weights defining a spectrum of basis states capable of addressing the case of particles where the mass scale is relevant and chemical non - equilibrium is strong while retaining some of the advantages presented here for massless particles .",
    "we will discuss the extension to the massive case in a future work .",
    "jb would like to acknowledge government support under and awarded by dod , air force office of scientific research , national defense science and engineering graduate ( ndseg ) fellowship , 32 cfr 168a .",
    "jw was supported in part by the us department of energy , office of science , applied scientific computing research , under award number de - ac02 - 05ch11231 , and by the national science foundation under award number dms-0955078 .",
    "jr was supported by a grant from the u.s .",
    "department of energy , de - fg02 - 04er41318 .",
    "let @xmath212 be a weight function where @xmath213 is a ( possibly unbounded ) interval and consider the hilbert space @xmath214 .",
    "we will consider weights such that @xmath215 for all @xmath216 .",
    "we denote the inner product by @xmath124 , the norm by @xmath152 , and for a vector @xmath217 we let @xmath218 .",
    "the classical three term recurrence formula can be used to define a set of orthonormal polynomials @xmath219 using this weight function , for example see @xcite , @xmath220.\\end{aligned}\\ ] ] in an effort to reduce the operation count for evaluation of the @xmath139 s , one could use the above recurrence relation to generate the coefficients of the @xmath73 s in the monomial basis and use evaluation schemes based these coefficients , however this can lead to accuracy issues . for a comparison of the recursive formula to horner s scheme for evaluating orthogonal polynomials see , for example , @xcite which considers legendre polynomials . in the sections of this work where accuracy is paramount",
    "we have used the recursive formula given above .",
    "one can also derive recursion relations for the derivatives of @xmath115 with respect to @xmath221 , denoted with a prime , @xmath222.\\end{aligned}\\ ] ] since @xmath223 is a degree @xmath224 polynomial , we have the expansion @xmath225 using eq.([deriv_rec ] ) we obtain a recursion relation for the @xmath226 @xmath227 @xmath228 this can be used to compute some of the inner products appearing in eq.([a_b_matrices ] ) .",
    "our method requires not just a single set of orthogonal polynomials , but rather a parametrized family of orthogonal polynomial generated by a weight function @xmath229 that is a @xmath230 function of both @xmath231 and some parameter @xmath71 . to emphasize this , we write @xmath232 for @xmath124",
    "we will assume that @xmath233 is dominated by some @xmath86 function of @xmath221 only that decays exponentially as @xmath234 ( if the interval is unbounded ) .",
    "in particular , this holds for the weight function eq.([weight ] ) .",
    "given the above assumption about the decay of @xmath233 , the dominated convergence theorem implies that @xmath235 is a @xmath230 function of @xmath71 for all polynomials @xmath25 and @xmath236 and justifies differentiation under the integral sign . by induction",
    ", it also implies implies that the @xmath139 have coefficients that are @xmath230 functions of @xmath71 .",
    "therefore , for any polynomials @xmath25 , @xmath236 whose coefficients are @xmath230 functions of @xmath71 we have @xmath237 where a dot denotes differentiation with respect to @xmath71 and we use @xmath238 to denote the inner product with respect to the weight @xmath239 .    ostensibly ,",
    "eq.([b_eq ] ) for the mode coefficients requires us to compute @xmath240 for all @xmath241 .",
    "however , as we will show in the following section , only the result for @xmath242 is needed .",
    "this can be obtained quite easily by differentiating the relation @xmath243 yielding @xmath244 for @xmath242 we obtain @xmath245    though they will not be needed , we give the results for @xmath246 for completeness .",
    "since @xmath247 is orthogonal to all polynomials of degree less than @xmath248 , for @xmath249 @xmath250 and for @xmath251 we have @xmath252      here we prove that the matrices that define the dynamics of the mode coefficients @xmath127 are lower triangular .",
    "recall the definitions @xmath253 using integration by parts , we see that @xmath254 since @xmath139 is orthogonal to all polynomials of degree less than @xmath255 we have @xmath256 for @xmath257 . for @xmath258 the second term in eq.([app : a_def ] )",
    "vanishes and so the only terms involving @xmath129 that are needed are the diagonal entries @xmath259 which , using eq.([app : psi_prime_exp ] ) and eq.([app : psi_prime_coeff ] ) , can be simplified to @xmath260    @xmath261 can be simplified as follows .",
    "first differentiate @xmath262 with respect to @xmath11 to obtain @xmath263 therefore @xmath264 @xmath265 is a degree @xmath66 polynomial , hence @xmath266 for @xmath257 as claimed . for @xmath258 the second term in the definition of @xmath267 , eq.([app : b_def ] ) , vanishes by the same reasoning .",
    "therefore , the only inner products involving @xmath133 that are required are @xmath268 we showed how to compute these in [ ortho - polynom - fam ] .",
    "b.  muller , acta phys .",
    "b * 43 * , 761 ( 2012 ) j.  rafelski , phys .  lett .",
    "b * 262 * , 333 ( 1991 ) .",
    "m.  petran , j.  letessier , j.  rafelski and g.  torrieri , `` share with charm , '' comput .",
    ".  commun . * 185 * , 2056 ( 2014 ) + g.  torrieri , s.  jeon , j.  letessier and j.  rafelski , comput .",
    "commun .   * 175 * , 635 ( 2006 ) + g.  torrieri , s.  steinke , w.  broniowski , w.  florkowski , j.  letessier and j.  rafelski , comput .",
    "commun .",
    "* 167 * , 229 ( 2005 )"
  ],
  "abstract_text": [
    "<S> we present a novel method to solve the spatially homogeneous and isotropic relativistic boltzmann equation . </S>",
    "<S> we employ a basis set of orthogonal polynomials dynamically adapted to allow for emergence of chemical non - equilibrium . </S>",
    "<S> two time dependent parameters characterize the set of orthogonal polynomials , the effective temperature @xmath0 and phase space occupation factor @xmath1 . in this first paper </S>",
    "<S> we address ( effectively ) massless fermions and derive dynamical equations for @xmath0 and @xmath1 such that the zeroth order term of the basis alone captures the particle number density and energy density of each particle distribution . </S>",
    "<S> we validate our method and illustrate the reduced computational cost and the ability to easily represent final state chemical non - equilibrium by studying a model problem that is motivated by the physics of the neutrino freeze - out process in the early universe , where the essential physical characteristics include reheating from another disappearing particle component ( @xmath2-annihilation ) .    </S>",
    "<S> relativistic boltzmann equation , chemical non - equilibrium , orthogonal polynomial spectral method </S>"
  ]
}