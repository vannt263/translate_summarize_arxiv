{
  "article_text": [
    "investment decisions are governed by weighing risk vs. reward , that is possible loss against expected return .",
    "markowitz classical portfolio theory  @xcite assumes that the underlying stochastic process is multivariate normal with known returns and covariances . in practice",
    ", these parameters have to be determined from observations on the market .",
    "since the number of observations is necessarily limited , empirically determined parameters will always contain a certain measurement error . even if we disregard the notoriously hard problem of estimating returns and concentrate solely on the covariances , we still run into a problem of serious information imbalance : the size @xmath0 of typical bank portfolios is too large compared to the amount of information contained in the finite - length time series available for the assets in the portfolio . as the number of input data is @xmath1 , where @xmath2 is the length of the time series , whereas the number of data needed for the construction of the covariance matrix is @xmath3",
    ", we expect that the quality of the estimate depends essentially on the ratio @xmath4 and that the error goes to zero only in the limit of very small @xmath4 .",
    "now the problem is that @xmath4 is never sufficiently small in practice , in fact , it may easily become larger than unity , the threshold value where the covariance matrix becomes singular and the portfolio selection problem meaningless .    over the past decades a large number of different techniques",
    "have been developed to tackle this problem and reduce the effective dimension of large bank portfolios  @xcite .",
    "our purpose here is to apply a recently introduced filtering procedure  @xcite in a well controlled simulation setting where the efficiency of the method can be reliably tested .    in order to determine the optimal portfolio , one has to invert the covariance matrix . since this has , as a rule , a number of small eigenvalues , any measurement error will get amplified and the resulting portfolio will be sensitive to the noise . in order to study the effect of noise ,",
    "we start from a known correlation matrix , dress it with noise , and reestablish the results of  @xcite .",
    "next , we apply the cleaning procedure of  @xcite to the empirical covariance matrix , and investigate the improvement of the result compared with the original , unfiltered theory .",
    "let us start from a known covariance matrix , @xmath5 , of size @xmath6 , representing the true correlation between @xmath0 instruments making up the portfolio .",
    "the portfolio weights @xmath7 , ( @xmath8 ) , satisfy the constraint @xmath9 , and we assume that short - selling is allowed , i.e. some of the weights can be negative . for the sake of simplicity , we do not impose any further conditions on the weights ( like e.g. the usual constraint on expected returns , which can not be determined on a daily horizon with any reliability anyhow ) , and concentrate on the minimal risk portfolio . in a gaussian world",
    "the natural measure of risk is the portfolio variance which is then our objective function to be minimized , r^2 = _ i , j=1^n  w_i * c*_ij w_j .",
    "after some trivial algebra one finds the optimal weights as w_i^ * = _ i , j=1^n * c*^-1_ij .",
    "it is natural to assume that stocks of companies belonging to a given industrial sector are more strongly correlated than those belonging to different sectors .",
    "accordingly , we expect that the covariance matrix displays a block diagonal structure .",
    "for simplicity , we assume that the elements outside the diagonal blocks ( that describe some general correlation with the whole market ) are all equal and non - negative , @xmath10 , and the elements @xmath11 , ( @xmath12 ) , describing intra - sector correlations in the diagonal blocks are constants within each block , and larger than those outside the blocks , @xmath13 .",
    "the model just described is the same as the one introduced by noh  @xcite .",
    "for the sake of simplicity again , we study a case when the correlation and covariance matrices are the same , i.e. we set the variance of individual instruments to unity .",
    "the structure of the correlation matrix , which we will refer to as the market - plus - sectors - model in the following , is then given by the pattern shown in figure  [ fig - sector ] .",
    ", while the correlation inside sector @xmath14 is @xmath11 ( @xmath12).,scaledwidth=40.0% ]    such a matrix , containing @xmath15 sectors , possesses @xmath15 small eigenvalues given by @xmath16 , @xmath12 .",
    "the corresponding eigenvectors will be strongly localized , having only two nonzero elements ( of equal absolute value but opposite sign ) .",
    "their multiplicity is @xmath17 , @xmath12 ( where @xmath18 is the number of entries within sector @xmath14 ) , i. e. the total multiplicity of the small eigenvalues is @xmath19 .",
    "in addition , there are @xmath15 large eigenvalues ( @xmath20 ) , typically singlets , that depend on all the parameters of the model : @xmath21 , @xmath11 , and @xmath18 .",
    "that is , an @xmath15 sector matrix has @xmath22 different eigenvalues . by virtue of the frobenius - perron theorem , the largest eigenvalue will necessarily be a singlet of @xmath23 , with an eigenvector having all positive components .",
    "this mode can then be identified with the whole market .    on the whole",
    ", this simple model reproduces all the main features observed in the spectra of real - life empirical covariance matrices  @xcite .",
    "it will also be useful to consider two special cases of the model : when all the @xmath11 s are the same and equal to @xmath21 , the block structure disappears , and we are left with a one - factor model , where only covariances with the market matter .",
    "the spectrum of the corresponding covariance matrix consists of merely two values , a large eigenvalue of order @xmath0 , and an @xmath24-fold degenerate small eigenvalue , @xmath25 . as a further simplification ,",
    "we can even drop @xmath21 , and end up with the unit matrix as the most trivial covariance matrix conceivable .      assuming that we have chosen one of the above models , the market - plus - sectors model , the one - factor model , or just the unit matrix",
    ", we can construct the corresponding empirical correlation matrix from them as follows : we generate finite time series from the true correlation matrix @xmath5 , x_it = _ j * a*_i , j  y_jt t=1, .. ,t , where @xmath26 is the cholesky decomposition of the true correlation matrix @xmath27 , and @xmath28 is a random gaussian variable with mean zero and variance 1 at time @xmath29 .    then the empirical correlation matrix is given by the usual estimator as ^(e ) = 1 t _",
    "t=1^t  x_it x_jt .",
    "the resulting empirical covariances will fluctuate from sample to sample .",
    "the main effect of this noise will be to resolve the degeneracy of the small eigenvalues , so that for a large enough matrix they form a quasi - continuous band . for @xmath0 and @xmath2 going to infinity so that @xmath30 is fixed and smaller than one",
    ", the spectral density of the small eigenvalues will be given by the marchenko - pastur spectrum  @xcite .",
    "( for @xmath31 larger than one , an additional dirac - delta appears at the origin . ) for small enough @xmath31 s the large eigenvalues remain relatively unaffected by the noise , but as @xmath31 grows and approaches unity , the effect of noise becomes dramatic , as we demonstrate below .",
    "the markowitz - weights corresponding to the empirical covariance matrix are w_i^(e ) = _ i , j=1^n * c*^(e)^-1_ij .",
    "now we can evaluate the risk associated with this choice of the portfolio . a possible way to characterize the effect of measurement error",
    "is to evaluate the variance by using the true correlation matrix @xmath32 with the weights calculated from the empirical one , @xmath33 , ^2 = _ i , j=1^n  w_i^(e ) * c*_ij w_j^(e ) .",
    "since the empirical weights are not optimal , we always have @xmath34 .    in the following we will use q_0 ^ 2 = 1 as a measure of the effect of noise on portfolio selection .",
    "@xmath35 can be easily evaluated for the special case when the true covariance matrix is just the unit matrix .",
    "then the empirical covariance matrix will be a random matrix with a spectral density fast converging to the marchenko - pastur spectrum  @xcite : ( ) = 12r [ eq : wishart ] where @xmath30 , @xmath36 .",
    "evaluating @xmath35 in the diagonal representation , we get q_0 ^ 2 = ( d  1())^2 = 11-r .    this strikingly simple result ,",
    "dating back to a discussion between the present authors , was first published in  @xcite .",
    "it remains valid up to @xmath37 corrections also for the one - factor model , and , within corrections controlled by the size of the sectors , also for the market - plus - sectors model .",
    "it tells us that as the size @xmath0 of the portfolio grows and approaches the length of the time series @xmath2 , the error in the portfolio diverges .",
    "while it is a commonplace that at the threshold @xmath38 the portfolio problem becomes meaningless ( the covariance matrix looses its positive definite character ) , it does not seem to have been noticed in the quantitative finance literature earlier that the error can be given by such a simple exact formula .",
    "a comparison between the theoretical prediction and the simulation is displayed in figure  [ fig - q0 ] : the agreement is perfect .",
    "concerning the relevance of our simple result for real markets , one has to realize that it has been derived on the basis of idealized conditions : perfect stationarity of the process and gaussian distribution of returns .",
    "neither of these holds true on real markets , therefore we believe that our formula is a lower bound for the error in real - life portfolios .",
    "given the fact that @xmath31 is never small in practice , and , in fact , it may even go beyond the critical value @xmath39 , it is imperative that some sort of filtering or cleaning procedure be applied , in order to reduce the effect of noise .",
    "a number of these techniques is available in the literature  @xcite .",
    "each of them corresponds to injecting some external information , additional to the time series data , into the empirical covariance matrix .",
    "the procedure proposed recently in  @xcite requires that we make an educated guess concerning the structure of the market .",
    "we are going to test its performance in the next section .",
    "studies of real financial empirical matrices  @xcite have revealed that they only have a relatively small number of large eigenvalues ( in the case of the s&p500 less than 20 ) , the rest are small , and conform rather well to the marchenko - pastur pattern  ( [ eq : wishart ] ) .",
    "this must mean that the number of relevant sectors is fairly small compared with the size of the portfolio .",
    "our task is therefore to reconstruct the true correlation matrix assuming a structure with a few sectors .",
    "the general theory of the cleaning procedure of the empirical correlation matrix dressed with gaussian noise is described in  @xcite .",
    "let @xmath40 be the resolvent for the cleaned correlation matrix g(z ) = 1n tr 1z-*c *  , with a similar formula for the the resolvent @xmath41 of the empirical correlation matrix .",
    "then the relation between the two is expressed as z g(z ) = z g(z ) , z = .",
    "this can be translated into a relation between the corresponding moments , and from the knowledge of @xmath42 moments one is able to reconstruct @xmath15 sectors for the true correlation matrix .",
    "we also note that this procedure , applied in the reverse direction , allows one to calculate the spectral density for more complicated scenarios , for correlated random matrices . as a result , the eigenvalue spectrum will slightly , but noticeably change , and come to a closer agreement with the one observed in finance .",
    "the procedure described in  @xcite allows one to reconstruct the eigenvalues only , but not the eigenvectors .",
    "our aim here is to reconstruct the true correlation matrix using the cleaned eigenvalues and the empirical eigenvectors .",
    "the question is whether such a procedure can lead to any improvement ?",
    "we present our result in figures  [ fig - q0],[fig - two ] , for the one - factor model and the market - plus - sectors model , respectively .",
    "the true correlation matrix is well reconstructed in both cases , the portfolio built from the ( cleaned ) empirical data is suboptimal by only 5 - 10% .",
    "thus , the cleaning procedure leads to a very substantial improvement compared with the naive use of the empirical covariance matrix , and allows the optimization to be performed even in the range @xmath43 .",
    "the cleaning procedure does not determine the number of sectors , or of the eigenvalues to be searched for , it is a parameter of the fitting .",
    "we tested the method with different numbers of eigenvalues ( i.e. different numbers of sectors ) , and observed the changes in performance depending on the trial structure .",
    "we find that there is a clear saturation after one reaches the number of eigenvalues corresponding the number of sectors in the true correlation matrix , and a further increase of the number of searched eigenvalues does not changes the result .",
    "this allows one to determine the proper number of sectors by looking for the signature of saturation .    on the other hand ,",
    "no problem arises if one sets the number of searched eigenvalues higher than required : the cleaning procedure will return less independent eigenvalues , saturating at the maximal number allowed by the number of sectors .    in conclusion",
    ", we have performed a preliminary study of the effect of the random matrix based cleaning described in  @xcite on the optimization of financial portfolios .",
    "we have found that the method works very efficiently in an artificial test environment , reproducing nearly perfectly a one - factor model scenario , and leading to a huge improvement in a market - plus - sectors model with a moderate number of sectors .",
    "it is obvious that before a final judgment can be passed on the method , a more detailed study of its various aspects should be performed , extending also to a possible cleaning of the eigenvectors .",
    "furthermore , a careful comparison of the efficiency of the method with other filtering procedures proposed in the literature is clearly necessary .",
    "two us ( i.k and sz.p . ) are grateful for the hospitality of the institute for theoretical sciences - a joint institute of argonne national laboratory and university of notre dame , where part of this manuscript has been prepared .",
    "g.p . acknowledges the support of hungarian otka grant t047050 .",
    "10 h. markowitz , j. fin .",
    "* 7 * ( 1952 ) 91 .",
    "e. j. elton , m. j. gruber , _ modern portfolio theory and investment analysis _",
    "( j.  wiley and sons , new york , 1995 ) .",
    "z. burda , a. goerlich , a. jarosz , j. jurkiewicz , physica a * 343 * ( 2004 ) 295 .",
    "pafka , i , kondor , physica * a319 * ( 2003 ) 487 .",
    "noh , phys . rev . * e61 * ( 2000 ) 5981 .",
    "l. laloux , p. cizeau , j .-",
    "bouchaud , m. potters , phys .",
    "* 83 * ( 1999 ) 1467 ; v. plerou , p. gopikrishnan , b. rosenow , l. a. n. amaral , h. e. stanley , phys .",
    "* 83 * ( 1999 ) 1471 .",
    "marchenko , l.a .",
    "pastur , math .",
    "ussr - sbornik , * 1 * ( 1967 ) 457 ."
  ],
  "abstract_text": [
    "<S> we study empirical covariance matrices in finance . due to the limited amount of available input information , </S>",
    "<S> these objects incorporate a huge amount of noise , so their naive use in optimization procedures , such as portfolio selection , may be misleading . in this paper </S>",
    "<S> we investigate a recently introduced filtering procedure , and demonstrate the applicability of this method in a controlled , simulation environment . </S>"
  ]
}