{
  "article_text": [
    "let @xmath0 be a coxeter group .",
    "an element @xmath2 is said to be _ fully commutative _ ( fc ) if any reduced expression for @xmath3 can be obtained from any other one by transposing adjacent pairs of commuting generators .",
    "fully commutative elements were extensively studied by stembridge in a series of papers  @xcite where , among others , he classified the coxeter groups having a finite number of fc elements and enumerated them in each case .",
    "it is known that these elements index a basis for the associated ( generalized ) temperley ",
    "lieb algebra ( @xcite ) .",
    "the growth function of such an algebra can then be obtained by computing the generating function , with respect to the length , of fully commutative elements in @xmath0 .",
    "this function has been computed by barcucci _",
    "@xcite in type @xmath1 , by hanusa and jones  @xcite in type @xmath4 , and by the present authors  @xcite in all finite and affine types .",
    "a striking fact is that , in each affine case , the corresponding growth sequence is ultimately periodic .    in the present work we focus on fc involutions for all classical coxeter groups .",
    "as explained by stembridge in  @xcite , a fc element @xmath3 is an involution if and only if its commutation class @xmath5 is _ palindromic _ , meaning that it includes the mirror image of some ( equivalently , all ) of its members .",
    "we will reformulate this in terms of heaps and certain dyck - type lattice walks which encode them .    as a first consequence",
    ", we will be able to enumerate , in types @xmath1 , @xmath6 , and @xmath7 , fc involutions according to the _",
    "major index_. this was recently done by barnabei _",
    "et al . _",
    "@xcite for the symmetric group ( type @xmath1 ) , by using the @xmath8-avoiding characterization of such elements , the robinson - schensted correspondence , and a nice connection to integer partitions .",
    "our approach in terms of heaps uses neither pattern - avoidance characterizations nor the robinson - schensted correspondence .",
    "however , it also yields a connection to integer partitions through our dyck - type lattice walks , which , as will be explained , turn out to be in bijection with the ones used in  @xcite .",
    "the advantage of our point of view is that it naturally extends to types @xmath6 and @xmath7 for which major indices can be defined , whereas the use of stembridge s pattern - avoiding characterizations  ( * ? ? ?",
    "* theorems  5.1 and 10.1 ) seems hard to handle . in type @xmath6 ,",
    "our result can for instance be written as follows ( see proposition  [ prop : majorb ] ) : @xmath9{i}}_{q}}+{{{n}\\atopwithdelims[]{\\lfloor n/2 \\rfloor}}_{q}},\\ ] ] where the square brackets are the so - called @xmath10-binomial coefficients , @xmath11 is the set of fc involutions in @xmath12 , and @xmath13 is the major index .    as a second consequence of our characterizations of fc involutions , we will also give the @xmath14-weighted generating functions for all types of classical finite and affine coxeter group .",
    "more precisely , if @xmath15 denotes the subset of fc involutions of @xmath0 and @xmath16 denotes the coxeter length , we will define @xmath17 as the length generating function for fc involutions in @xmath0 .",
    "we will use both our characterization in terms of heaps and the way these are encoded by dyck - type lattice walks to compute @xmath18 when @xmath0 is finite or affine . in the affine case",
    ", we will also show that the corresponding growth sequences are ultimately periodic , with periods dividing the values recorded in the following table ( see propositions  [ prop : involutionsaaffines ] and  [ prop : involutionsbcdaffines ] ) : @xmath19 ( if @xmath20 is odd , the number of fully commutative involutions in @xmath21 is finite . )",
    "+ finally , as a third consequence of our approach , we will relate our previous characterization in affine type @xmath4 to fan ",
    "green s cells structure of the associated temperley ",
    "lieb algebra described in  @xcite .",
    "more precisely , we will see how the use of heaps highlights and simplifies some of their results connected to fc involutions , such as  ( * ? ? ?",
    "* theorem 3.5.1 ) .",
    "this paper is organized as follows . in section  [ sec : fcihw ] , we recall definitions and basic results on coxeter groups , fully commutative involutions , heaps and walks . in section  [ sec",
    ": major ] , we enumerate fc involutions with respect to the major index in classical finite types . section  [ sec : length ] is devoted to the characterization of fc involutions and their enumeration with respect to the coxeter length in classical finite and affine types . finally , in section  [ sec : cells ] , after recalling the cell structure on fc elements defined in  @xcite using the type @xmath4 temperley ",
    "lieb algebra , we show how the use of heaps makes the combinatorics of these cells more explicit .",
    "we refer to  @xcite for standard notations and terminology pertaining to general coxeter groups .",
    "a _ coxeter system _ is a pair @xmath22 where @xmath0 is a group and @xmath23 is a finite set of generators for @xmath0 subject only to relations of the form @xmath24 , where @xmath25 , and @xmath26 , for @xmath27 . if @xmath28 has infinite order we set @xmath29 .",
    "these relations can be rewritten more explicitly as @xmath30 for all @xmath31 , and @xmath32 where @xmath33 .",
    "they are the so - called _",
    "braid relations_. when @xmath34 , they are simply named _ commutation relations _ , @xmath35",
    ".    the coxeter graph of @xmath22 will be denoted by @xmath36 .",
    "the irreducible coxeter systems corresponding to finite and affine coxeter groups are completely classified ( see  @xcite ) , and the coxeter graphs corresponding to the classical families are depicted in figures  [ fig : finite_diagrams ] and  [ fig : affinediagrams ] . here , and all along this paper , the indexing of the classical coxeter graphs is slightly different from the more standard one used in  @xcite@xcite , and  @xcite , but it is more appropriate when one considers both the coxeter length and the major index .",
    "coxeter graphs for classical irreducible finite types . ]",
    "coxeter graphs for classical irreducible affine types . ]    for @xmath2 , the _ length _ of @xmath3 , denoted by @xmath37 , is the minimum length @xmath38 of any expression @xmath39 with @xmath40 . these expressions of length @xmath37 are called _ reduced _ , and we denote by @xmath5 the set of all reduced expressions of @xmath3 .    the _ ( right ) descent set _ of an element @xmath41",
    "is defined as follows : @xmath42 and its cardinality is usually called the _ descent number _ @xmath43 .",
    "we define the _ major index _ of @xmath2 as the sum of the labels of the descents of @xmath3 ; more precisely @xmath44 it is clear that the major index depends on the indexing of the generating set @xmath45 of @xmath0 . in the case of the symmetric group @xmath46 ,",
    "the notion of major index is standard , and a very famous result states that the major index and the length are equidistributed over @xmath46 ( see  @xcite ) . for other coxeter groups ,",
    "several definitions exist . with our previous indexing of the coxeter graphs ,",
    "the major index defined above corresponds to the one already used by reiner  @xcite , and steingrmsson  @xcite in the type @xmath6 case .      in this section ,",
    "we recall the definition of fully commutative elements in coxeter groups and its relation with the theory of heaps .",
    "we then explain how the subfamily of alternating heaps corresponding to involutions can be encoded by various classes of dyck - type lattice walks .",
    "according to the well known _",
    "matsumoto - tits word property _ , any expression in @xmath5 can be obtained from any other using only braid relations ( see for instance  ( * ? ? ?",
    "* section 3.3 ) ) .",
    "the notion of full commutativity is a strengthening of this property .",
    "[ defi : fc ] an element @xmath3 is _ fully commutative _ if any reduced expression for @xmath3 can be obtained from any other by using only commutation relations",
    ".    we let @xmath47 be the free monoid generated by @xmath45 .",
    "the equivalence classes of the congruence on @xmath47 generated by the commutation relations are usually called _",
    "commutation classes_. we recall from stembridge in  ( * ? ? ?",
    "2.1 ) that an element @xmath41 is fc if , and only if , all its reduced words avoid all factors of the form @xmath48 with length @xmath49 .    by definition the set @xmath5 forms a single commutation class",
    "; we will see that the concept of _ heap _ helps to capture the notion of full commutativity .",
    "we use the definition as given in  @xcite ( see also  ( * ? ? ?",
    "* definition 2.2 ) ) , and we refer to @xcite for details of the relation with fc elements .",
    "[ defi : heaps ] let @xmath36 be a finite graph with vertex set @xmath45 .",
    "a _ heap _ on @xmath36 ( or _ of type _",
    "@xmath36 ) is a finite poset @xmath50 , together with a labeling map @xmath51 , which satisfies the following conditions :    1 .   for any vertex @xmath52 , the subposet @xmath53 is totally ordered , and for any edge @xmath54 , the subposet @xmath55 is totally ordered .",
    "the ordering on @xmath56 is the transitive closure of the relations given by all chains @xmath57 and @xmath58 , i.e. the smallest partial ordering containing these chains .",
    "two heaps on @xmath36 are _ isomorphic _ if there exists a poset isomorphism between them which preserves the labels .",
    "the size @xmath59 of a heap @xmath56 is its cardinality . given any subset @xmath60",
    ", we will note @xmath61 the subposet induced by all elements of @xmath56 with labels in @xmath62 . in particular",
    "@xmath63 is the chain @xmath64 where @xmath65 is its cardinality .",
    "if @xmath66 are two labels such that @xmath49 , note that @xmath58 is also a chain .",
    "fix a word @xmath67 in @xmath47 .",
    "define a partial ordering @xmath68 of the index set @xmath69 as follows : set @xmath70 if @xmath71 and @xmath72 is an edge of @xmath36 , and extend by transitivity .",
    "we denote by @xmath73 this poset together with @xmath74 .",
    "it is easy to see that this indeed forms a heap as in definition  [ defi : heaps ] .",
    "[ prop : wordtoheap ] let @xmath36 be a finite graph .",
    "the map @xmath75 induces a bijection between @xmath36-commutation classes of words and isomorphism classes of finite heaps on @xmath36 .    as explained in  @xcite , if @xmath3 is a fc element and @xmath76 is a reduced word for it , we can define @xmath77 , and heaps of this form are called _",
    "fc heaps_. in figure  [ fig : heaps_invol ] , we consider the dynkin diagram @xmath78 , and we give two examples of words with the corresponding fc heaps . in the hasse diagram of @xmath79 ,",
    "elements with the same labels are drawn in the same column .    , the one on the right corresponding to a fc involution.,width=453 ]    let us point out a simple operation on heaps : if @xmath80 is a heap , then its _ dual _ is @xmath81 , which is the heap with the inverse order , and where the labels are kept the same .",
    "we will say that a heap is _ self - dual _ if it is isomorphic to its dual",
    ". then we have the following result , which is essentially proved in  @xcite .",
    "[ lemme : heapinvolution ] let @xmath0 be a coxeter group with corresponding coxeter graph @xmath36 .",
    "a fully commutative element @xmath41 is an involution if and only if @xmath82 is self - dual .",
    "a fc element @xmath2 is an involution if and only if for a ( equivalently , any ) @xmath83 , the reverse @xmath84 is also in @xmath85 .",
    "this is equivalent to @xmath86 , which is by definition the dual of @xmath82 .      in this section",
    "we recall the classification of the fc involutions in the classical finite coxeter groups essentially given in  @xcite .",
    "we use a description in terms of heaps derived from  ( * ? ? ?",
    "* ,  4.4 ) , together with lemma  [ lemme : heapinvolution ] .",
    "first , we need to recall a few definitions .",
    "we fix @xmath87 in the set @xmath88 and we consider the coxeter system @xmath22 corresponding to the _ linear _ coxeter graph @xmath89 of figure  [ fig : linear_diagram ] .",
    "the linear coxeter graph @xmath90 . ]    note that this linear diagram contains as special cases the coxeter diagrams of types @xmath46 , @xmath12 and @xmath91 .",
    "[ defi : alternating ] consider the linear graph @xmath90 , and a heap @xmath56 on @xmath90 .",
    "we say that @xmath56 is _ alternating _ if for each edge @xmath92 of @xmath90 , the chain @xmath93 has alternating labels @xmath94 and @xmath95 .",
    "next , we will need the following families of heaps , which are specific to the types @xmath6 and @xmath7 .",
    "a _ self - dual right - peak of type @xmath12 _ is a heap such that there exists @xmath96 satisfying :    1 .",
    "@xmath97 ; 2 .",
    "@xmath98 or @xmath99 for @xmath100 , and @xmath101 for @xmath102 ; 3 .",
    "@xmath103 is self - dual alternating , where @xmath104 means that one @xmath105 is deleted .     a self - dual right - peak of type @xmath12.,height=113 ]",
    "the coxeter diagram of type @xmath106 is not linear .",
    "we can nevertheless define self - dual alternating heaps and self - dual right - peaks based on the previous definitions in type @xmath12 .",
    "more precisely , _ self - dual alternating heaps of type _",
    "@xmath106 are obtained from self - dual alternating heaps of type @xmath12 having either zero or an odd number of elements labeled @xmath107 , by replacing these by @xmath107 or @xmath108 alternatively , or by @xmath109 if there was originally exactly one label @xmath107 , cf .",
    "figure  [ fig : alt_typed ] .",
    "two self - dual alternating heaps of type @xmath110.,height=113 ]    _ self - dual right peaks of type _",
    "@xmath106 are heaps satisfying conditions @xmath111 and @xmath112 above , and such that there exists @xmath96 with :    1 .",
    "@xmath113 .",
    "[ rem : familypeaks ] in the above families of right - peaks the index @xmath114 is _ uniquely determined _ ; this will be particularly useful for enumerating purposes .    from ( * ? ? ?",
    "* theorem 3.10 ) and lemma  [ lemme : heapinvolution ] , we have the following result .",
    "[ prop : typeclassiques ] a fc element @xmath115 is an involution if and only if @xmath82 is a self - dual alternating heap .",
    "moreover , a fc element @xmath116 ( _ resp .",
    "_ @xmath117 ) is an involution if and only if @xmath82 is either a self - dual alternating heap of type @xmath12 ( _ resp . _",
    "@xmath106 ) or a self - dual right - peak of type @xmath12 ( _ resp . _",
    "@xmath106 ) .",
    "next , we define the lattice walks we will use in the sequel to compute generating functions for fc involutions .",
    "[ defi : walks ] a _ walk _ of length @xmath20 is a sequence @xmath118 of points in @xmath119 with its @xmath20 steps in the set @xmath120 , such that @xmath121 has abscissa @xmath122 and all horizontal steps @xmath123 can only occur between points on the @xmath124-axis .",
    "the set of all walks of length @xmath20 will be denoted by @xmath125 .",
    "the subset of walks starting at @xmath126 will be denoted by @xmath127 , and the subset of @xmath127 ending at @xmath128 will be denoted by @xmath129 . to each family",
    "@xmath130 corresponds the subfamily @xmath131 consisting of those walks with no horizontal step , and @xmath132 consisting of the ones which hit moreover the @xmath124-axis at some point .",
    "the _ total height _ @xmath133 of a walk is the sum of the heights of its points : if @xmath134 then @xmath135 .",
    "to each family @xmath136 we associate the series @xmath137 , and we define the generating functions in the variable @xmath124 by    @xmath138    notice that @xmath139 ( _ resp . _",
    "@xmath140 ) counts dyck paths ( _ resp .",
    "_ prefixes of dyck paths ) , taking into account the height .",
    "moreover , the generating function @xmath141 can easily be related to @xmath139 : a path in @xmath129 can be seen as a concatenation of dyck paths and horizontal steps which alternate , remembering that the set of dyck paths contains the empty one .",
    "therefore one can write : @xmath142    recall that , setting @xmath143 , the series @xmath139 simply becomes the generating function for the famous catalan numbers , and is therefore equal to the generating function for @xmath8-avoiding permutations , or equivalently fc elements of type @xmath1 ( see  @xcite ) .",
    "moreover , we have the recursive relation @xmath144 as can be seen by considering the first return to the @xmath124-axis , as follows :        we also point out that for all the subfamilies @xmath145 of @xmath125 that will naturally appear later in our enumerations , there will be some equations of the form   relating @xmath146 , @xmath147 and @xmath148 , and recursive relations like   for @xmath147 .",
    "we now define a bijective encoding of self - dual alternating heaps by walks , which will be especially handy to compute generating functions in the next sections .",
    "it is obtained by understanding how the encoding of heaps defined in  @xcite restricts to self - dual heaps .",
    "[ proposition : walk_encoding ] let @xmath56 be a self - dual alternating heap of type @xmath90 . to each vertex @xmath94 of @xmath90 we associate the point @xmath149 . we define @xmath150 as the walk @xmath151 . then the map @xmath152 is a bijection between self - dual alternating heaps of type @xmath90 and @xmath125 .",
    "the size @xmath59 of the heap is the total height of @xmath150 .    for any alternating heap @xmath56 and any @xmath153",
    ", we have @xmath154 .",
    "moreover if @xmath56 is self - dual and @xmath155 , then @xmath156 . therefore the map is well defined .",
    "fix @xmath157 .",
    "if the step @xmath158 is equal to @xmath159 ( _ resp . _ @xmath160 ) , then we define a convex chain @xmath161 of length @xmath162 ( _ resp . _",
    "@xmath163 ) as @xmath164 ( _ resp . _",
    "@xmath165 ) . if the step @xmath166 is @xmath123 , then @xmath167 , and we let @xmath161 be the empty chain .",
    "next we define @xmath56 as the transitive closure of the chains @xmath168 .",
    "it is acyclic since @xmath90 is linear , so we get a heap @xmath56 which is uniquely defined , alternating , and satisfies @xmath169 . since @xmath170 the result follows .",
    "the heap of a fc involution in @xmath171 and its associated walk.,width=415 ]    [ rk : ajouterunpas ] in the type @xmath46 case , if we consider alternating fc heaps , since they have either zero or one occurrence of the labels @xmath172 and @xmath173 , we can add an initial and a final step to the paths obtained through proposition  [ proposition : walk_encoding ] , to get a bijection with paths in @xmath129 . similarly ,",
    "since alternating fc heaps on @xmath12 are in bijection with paths in @xmath174 starting at height zero or one , we can add an extra initial step , to obtain a bijection with paths in @xmath127 .",
    "recall the following enumerative expressions for the number of fc involutions in classical finite types , which were first proved in  ( * ? ? ?",
    "* section 4 ) .",
    "[ coro : enumeration ] we have for @xmath175 @xmath176    the striking observation is that by considering the major index defined in section  [ sec : fcihw ] we can obtain nice @xmath10-analogues for formulas . for type @xmath1 this analogue was recently computed by barnabei _",
    "_ in  @xcite , by using the @xmath8-avoiding characterization of fc involutions , the robinson  schensted algorithm , and a connection with integer partitions .",
    "a non - bijective proof of this result , using the principal specialization of schur functions , has also been given by stanley , and a third one has been found by dahlberg and sagan ( see  @xcite ) .    in this section , we show that our different approach in terms of heaps will allow us to derive this result and extend it to types @xmath6 and @xmath7 . in type @xmath1 , we will shortly explain in proposition  [ remark : rsk ] below that our approach and the one of barnabei _ et al .",
    "_ are equivalent , and yield the same connection to integer partitions . in types",
    "@xmath6 and @xmath7 , we will still use our characterization in terms of heaps and the idea from  @xcite to connect walks to integer partitions ; here the approach through pattern avoidance in signed permutations seems harder to use .    before giving our result",
    ", we recall a classical property relating @xmath10-binomial coefficients and integer partitions . a partition of the integer @xmath177 is a nonincreasing sequence @xmath178 of positive integers whose sum is equal to @xmath177 , which we denote by @xmath179 and call the weight of @xmath180 .",
    "the integer @xmath38 is the length of @xmath180 , while the @xmath181 s are called the parts of @xmath180",
    ". it will be convenient to use _",
    "frobenius notations _ for partitions .",
    "let @xmath114 be the _",
    "rank _ of a partition @xmath180 , namely the largest integer @xmath182 such that @xmath183 : it is also the size of the _ durfee square _ of @xmath180 . for @xmath184 , define @xmath185 and @xmath186 .",
    "the frobenius notation for @xmath180 is the array @xmath187    we have the following classical generating function ( see for instance  @xcite ) .    [",
    "lem : partitions ] the generating function in the variable @xmath10 , according to the weight , of integer partitions with largest part smaller or equal to @xmath188 and length smaller or equal to @xmath189 , is given by the @xmath10-binomial coefficient @xmath190{k}}_{q}}:=\\frac{(1-q)\\cdots(1-q^n)}{(1-q)\\cdots(1-q^k)(1-q)\\cdots(1-q^{n - k})}.\\ ] ]      we prove the following result , which can be found in  @xcite .    [",
    "prop : majora ] for any positive integer @xmath20 , we have @xmath191{\\lfloor n/2 \\rfloor}}_{q}}.\\ ] ]    recall from proposition  [ prop : typeclassiques ] that each fc involution @xmath192 corresponds bijectively to a self - dual alternating heap @xmath193 , which is itself in one - to - one correspondence with a walk in @xmath129 , thanks to proposition  [ proposition : walk_encoding ] and remark  [ rk : ajouterunpas ] .",
    "note that @xmath194 if and only if there exists in the poset @xmath56 a maximum element labeled @xmath195 . in the path encoding",
    "this corresponds to a _",
    "( i.e. an ascending step followed by a descending one ) at coordinates @xmath196 .",
    "therefore the position @xmath182 of such a descent is equal to the number of steps from the origin to this peak .",
    "fix a walk @xmath197 and let @xmath188 be its number of horizontal steps .",
    "note that @xmath188 and @xmath20 have the same parity .",
    "replace the first @xmath198 ( _ resp . _ the last @xmath199 ) horizontal steps by descending ( _ resp . _ ascending ) ones .",
    "next replace all descending ( _ resp . _ ascending ) steps by horizontal ( _ resp . _",
    "vertical ) ones , yielding @xmath200 in @xmath201 , the set of walks with @xmath20 horizontal or vertical steps , starting at the origin and ending at @xmath202 .",
    "these operations are invertible , and an example of the bijection @xmath203 is provided in figure  [ fig : bijection_typea ] .",
    ", width=453 ]    it is not difficult to see that descents of @xmath204 coincide in @xmath200 with _ corner points _ ( formed by a vertical step followed by a horizontal one ) .",
    "moreover the position of a descent in @xmath204 is given by the sum of the coordinates of the corresponding corner point in @xmath200 .",
    "denote by @xmath205 , with @xmath206 and @xmath207 the corner points of @xmath200 .",
    "summarizing , we have @xmath208    since any walk @xmath209 is uniquely determined by its corner points , it can be associated with an integer partition @xmath180 defined in frobenius notation as @xmath210 this is a bijection : for a proof see  ( * ? ? ?",
    "* theorem 3.4 ) to which we refer for more detail .",
    "as any such partition has length  @xmath211 and greatest part  @xmath212 , we obtain   through and lemma  [ lem : partitions ] .    by comparing our resulting bijection with that of  @xcite",
    ", we observed a striking coincidence .",
    "starting from a fc involution @xmath115 , we considered the following sequence of bijective transformations : @xmath213 where @xmath193 and @xmath214 ( see remark  [ rk : ajouterunpas ] ) .",
    "et al . _",
    "@xcite consider a different sequence of transformations , namely : @xmath215 where @xmath216 is the two rows standard tableau obtained by the robinson  schensted correspondence , and @xmath217 is the classical associated dyck - path prefix .",
    "the following proposition shows that the two constructions essentially coincide .",
    "[ remark : rsk ] the walk @xmath217 is obtained from @xmath204 by replacing in the latter all horizontal steps by ascending ones .    if @xmath218 , then @xmath219 for all @xmath220 ( equivalently , @xmath221 for all @xmath222 ) : otherwise @xmath223 would be an occurrence of the pattern @xmath8 .",
    "this shows that @xmath56 splits naturally into two heaps corresponding to elements smaller , _ resp .",
    "_ larger than @xmath182",
    ". moreover @xmath56 contains elements labeled neither by @xmath224 nor by @xmath195 , which means the @xmath182th step of @xmath204 being a horizontal step . in the rs construction",
    ", we also easily see that such a fixed point @xmath182 will correspond to an up step in @xmath217 , where @xmath217 leaves at abscissa @xmath182 a certain height for the last time .",
    "thus the statement of the proposition is proved if we can show that @xmath225 whenever @xmath3 has no fixed points , which we now assume . in this case @xmath217 and @xmath204 are dyck paths in @xmath226 , and their construction is illustrated in figure  [ fig : rsk_et_heaps ] .    , scaledwidth=80.0% ]    note that we superimposed a cell on each vertex from the heap @xmath56 .",
    "this is useful to read off the involution directly , see for instance  @xcite .",
    "more precisely , pick any labeled edge , say @xmath182 , on the top side , and follow the corresponding `` column '' of cells until the bottom side is reached : the label that can be read off is @xmath227 . by the construction of @xmath204 from @xmath3 , it is then clear that its @xmath182th step is an up step if and only if @xmath228 .",
    "on the other hand , the @xmath182th step in @xmath217 is an up step if and only if it appears in the top row of the tableau @xmath216 obtained from @xmath3 .",
    "now one can show by induction that , in the rs insertion algorithm , an entry @xmath220 will bump @xmath182 from the first row if and only if @xmath229 .",
    "putting things together , the @xmath182th step in @xmath217 is an up step if and only if @xmath228 . comparing with the previous paragraph ,",
    "this shows that @xmath217 and @xmath204 coincide , and concludes the proof .      in type @xmath6",
    ", we have the following generalisation .",
    "[ prop : majorb ] for any positive integer @xmath20 , we have @xmath230{i}}_{q}}+{{{n}\\atopwithdelims[]{\\lfloor n/2 \\rfloor}}_{q}}.\\ ] ]    by proposition  [ prop : typeclassiques ] , we have to inspect separately self - dual alternating heaps and right - peaks of type @xmath12 . by definition right - peaks",
    "can be split for a @xmath231 into two heaps @xmath232 and @xmath233 , and this decomposition is unique by remark  [ rem : familypeaks ] .",
    "these two parts can be bijectively reassembled by associating to the first one a walk in @xmath234 ending at height one , and to the second one a walk starting with a @xmath160-step , followed by @xmath235 horizontal steps , and then gluing these two walks together .",
    "this yields a walk in @xmath129 with less than @xmath20 horizontal steps .",
    "for instance , the walk associated to the right - peak in figure  [ fig : rp_typeb ] is depicted below .",
    "we remark that if @xmath236 corresponds to a right - peak , then @xmath237 , so by applying the same arguments as in type @xmath46 , we find that the generating function for those elements is equal to @xmath238{\\lfloor n/2 \\rfloor}}_{q}}-1.\\ ] ]    the remaining heaps are the self - dual alternating ones , which are by proposition  [ proposition : walk_encoding ] in one - to - one correspondence with walks in @xmath127 .",
    "first , replace in these walks all @xmath123 steps by @xmath160 steps .",
    "secondly , replace as in type @xmath46 all descending ( _ resp . _ ascending ) steps by horizontal ( _ resp .",
    "_ vertical ) ones .",
    "we obtain this time a bijection with length @xmath20 walks with horizontal or vertical steps , starting at the origin but ending at any height , whose set is denoted by @xmath239 , as can be seen on the illustration below .",
    "[ fig : chemin_alt_typeb ]    as before , if we fix @xmath236 , the descents of @xmath3 correspond in @xmath240 to corner points , together with the last point if it ends a vertical step .",
    "denote all these points by @xmath205 ; they satisfy @xmath241 and @xmath242 , with the additional condition @xmath243 , and again @xmath244 is equal to @xmath245 .",
    "as in type @xmath1 , the corner points define a unique partition @xmath246 in frobenius notation , such that @xmath243 .",
    "summarizing , alternating fc involutions in @xmath12 are in bijection with such integers partitions @xmath246 satisfying @xmath243 . if @xmath246 is not empty , note that @xmath247 and @xmath248 , where @xmath38 is its length .",
    "set @xmath249 and @xmath250 , therefore we have @xmath251 and @xmath252 .",
    "remove from @xmath246 its first part @xmath253 and decrease by one all the remaining parts , therefore giving a partition @xmath254 of weight @xmath255 .",
    "moreover , @xmath254 satisfies the conditions of lemma  [ lem : partitions ] with @xmath20 replaced by @xmath256 and @xmath188 by @xmath182 , therefore giving the generating function @xmath257{i}}_{q}},\\ ] ] which concludes the proof .",
    "thanks to the previous proof , we can refine as follows this result , as was done in  @xcite for type @xmath1 .    for any integer @xmath258",
    ", we have @xmath259{k-1}}_{q } } { { { h+k-1-i}\\atopwithdelims[]{k-1}}_{q}}.\\ ] ] moreover , when @xmath260 , this generating function is equal to @xmath261 .",
    "we analyse more precisely the structure of the partition @xmath246 from the previous proof when the fc involution has @xmath188 descents . obviously , if @xmath260 , then this partition is empty , which yields the result .",
    "otherwise @xmath262 is the row length in the frobenius notation of @xmath246 , so it corresponds to the size of its durfee square .",
    "we can define as before the integers @xmath263 and @xmath182 , satisfying this time @xmath264 and @xmath265 , respectively .",
    "moreover , the partition @xmath254 obtained from @xmath246 has a durfee square of size @xmath266 , so the desired generating function is equal to @xmath267{k-1}}_{q } } { { { h-1-i}\\atopwithdelims[]{k-1}}_{q}}.\\ ] ] the result is then obtained by shifting accordingly the indices @xmath263 and @xmath182 .      finally , for type @xmath7 , we have the following result .",
    "[ prop : majord ] for any positive integer @xmath20 , we have @xmath268{\\lfloor ( n-1)/2 \\rfloor}}_{q}}+{{{n+1}\\atopwithdelims[]{\\lfloor ( n+1)/2 \\rfloor}}_{q}},\\ ] ] where for @xmath20 even , @xmath269{i}}_{q}}+\\frac{1}{2}q^n(1+q)\\sum_{i=0}^{n-1}{{{n-1}\\atopwithdelims[]{i}}_{q}},\\ ] ] and for @xmath20 odd , @xmath270{i}}_{q}}+\\frac{1}{2}q^n(1+q)\\sum_{i=0}^{n-1}{{{n-1}\\atopwithdelims[]{i}}_{q}}\\\\+\\sum_{h=1}^{(n-1)/2}q^{n - h}{{{n - h-1}\\atopwithdelims[]{(n-1)/2}}_{q}}+\\frac{1}{2}q^n(1+q){{{n-1}\\atopwithdelims[]{(n-1)/2}}_{q}}.\\end{gathered}\\ ] ]    obviously from their definition , self - dual right - peaks of type @xmath106 are in bijection with the ones of type @xmath12 , and have no descents at @xmath271 , so their generating function is equal to  .",
    "the alternating involutions containing @xmath272 are in bijection with walks in @xmath127 ending at height @xmath261 . among these ,",
    "the walks having an ascending last step are enumerated by @xmath273{\\lfloor ( n-1)/2 \\rfloor}}_{q}}.\\ ] ] indeed both @xmath107 and @xmath108 are descents , and the first @xmath274 steps form a walk in @xmath275 so we can use proposition  [ prop : majora ] .",
    "the generating function for the previous walks having a descending last step can be computed in the following way : first add an extra descending step to reach the @xmath124-axis , thus obtaining a walk in @xmath276 ending with two descending steps .",
    "note that neither @xmath107 nor @xmath108 are descents for the corresponding involutions , so the generating function is obtained by computing the generating function of all type @xmath1 walks from the origin to @xmath277 , to which we must substract the generating function of the walks having either a peak in position @xmath278 or ending with one horizontal step ( see the figure below ) .",
    "[ fig : sn_no_typed ]    again by proposition  [ prop : majora ] , the result is @xmath279{\\lfloor ( n+1)/2 \\rfloor}}_{q } } - q^n{{{n-1}\\atopwithdelims[]{\\lfloor ( n-1)/2 \\rfloor}}_{q } } - { { { n}\\atopwithdelims[]{\\lfloor n/2 \\rfloor}}_{q}}.\\ ] ] by adding the two previous expressions to  , we get the two last terms in   minus @xmath261 , therefore we now have to show that the generating function for the remaining alternating elements is equal to @xmath280 .",
    "consider such an element , and let @xmath56 be its corresponding heap .",
    "if there is no occurrence of @xmath107 and @xmath108 , then @xmath56 is encoded by a walk in @xmath281 .",
    "otherwise notice that self - duality implies that @xmath282 is odd . therefore if the first label of @xmath283 is @xmath107 ( _ resp .",
    "_ @xmath108 ) , then @xmath56 is in bijection with a walk @xmath284 ( _ resp . _",
    "@xmath285 ) in @xmath127 ending at an odd height .",
    "denote by @xmath286 the generating function   for type @xmath46 , and @xmath287 the generating function for the alternating fc involutions in @xmath288 .",
    "let also @xmath289 be the generating function of alternating fc involutions in @xmath12 but where each occurrence of @xmath107 is replaced by @xmath108 .",
    "we claim that if @xmath20 is even , then the desired generating function is equal to @xmath290 recall that @xmath287 counts walks in @xmath127 .",
    "these walks can be split into three parts : the ones ending at @xmath122 , at an even height @xmath291 , or at an odd height .",
    "then is consequence of a bijection between these walks ending at an odd height , and those ending at an even @xmath291 height .",
    "this bijection goes as follows : in a walk ending at an odd height replace the last @xmath123 step ( as @xmath20 is even there is at least one ) by a @xmath159 step , and shift accordingly the remaining steps . for the reverse application , change the last @xmath159 step starting from the @xmath124-axis into a @xmath123 step",
    "this bijection preserves the peaks of the walks ( and therefore the descents of the associated fc involutions ) .    simplifying",
    ", we have to compute @xmath292 , where thanks to the analysis of the previous type @xmath6 case , @xmath293{i}}_{q}}.\\ ] ] notice that in type @xmath6 , a fc involution has a descent at @xmath107 if and only if @xmath294 , with the notations above .",
    "therefore @xmath289 can be computed similarly to @xmath295 , except for @xmath296 , in which case the corresponding term has to be multiplied by @xmath10 .",
    "this yields the desired expression @xmath280 .",
    "if @xmath20 is odd , our previous bijection between walks ending at odd and even height does not work anymore , as our walks can have no horizontal step .",
    "so after splitting the walks in @xmath127 as before , but where the walks ending at an odd height are separated between those having or not an horizontal step , we can use the previous bijection to see that one must therefore replace   by @xmath297 where @xmath298 is the generating function for the walks in @xmath127 having no horizontal step , and @xmath299 is the same generating function , but where each occurrence of @xmath107 is replaced by @xmath108 . note that all these walks must end at an odd height . to conclude , it is enough to prove that @xmath300{(n-1)/2}}_{q}}.\\ ] ] to see this , consider any of the previous walks , which has , say @xmath114 , steps of the form @xmath159 leaving definitively a certain height ( note that @xmath114 has to be odd , like @xmath20 ) .",
    "transform bijectively the @xmath301 first of these steps in the previous walk to steps @xmath160 and shift accordingly all remaining steps .",
    "remark that peaks are preserved by this transformation ( this is a well known bijection , see @xcite and the references therein ) . then transform our walk as in types @xmath1 and @xmath6 , to get a walk of length @xmath20 with paths @xmath123 and @xmath302 , starting at the origin and ending at @xmath303 .",
    "the analysis is now the same as in type @xmath1 , except that we have to distinguish whether the last step corresponds to a descent ( if it is of the form @xmath304 ) ) or not . to do this ,",
    "denote by @xmath263 the distance between the top extremity of the last vertical step and the point @xmath303 , as shown in the figure below , and then proceed as in type @xmath1 to relate our walks to integer partitions in a box .",
    "[ fig : bijection_typed ]",
    "recall from the introduction that for any coxeter group @xmath0 , the length generating function @xmath18 is defined as @xmath305 . in the three classical finite types",
    "these series are polynomials , and we denote their generating functions by @xmath306 where @xmath307 .    [ prop : involutions ] we have @xmath308 where @xmath309 denotes the generating function for @xmath14-weighted prefixes of dyck walks ending at an odd height .",
    "note that the previous generating functions can all be explicitly computed thanks to   and the following functional equations : @xmath310    from proposition  [ prop : typeclassiques ] , and proposition  [ proposition : walk_encoding ] , fc involutions in @xmath46 are in one - to - one correspondence with walks in @xmath129 .",
    "this shows   by using  .    from proposition",
    "[ prop : typeclassiques ] , fc involutions in @xmath12 correspond to self - dual heaps which are either alternating or right - peaks .",
    ".,width=226 ]    as before , in the alternating case , one can use proposition  [ proposition : walk_encoding ] to show that they are in one - to - one correspondence with walks in @xmath127 .",
    "moreover , such a walk can be seen as a collection of pairs ( dyck path , horizontal step ) , followed by a prefix of a dyck path .",
    "this is illustrated in figure  [ fig : decomp_c+ ] and shows that @xmath311 yielding the first term on the right - hand side of  .    by definition right - peaks",
    "can be split into two parts @xmath232 and @xmath233 , and this decomposition is unique by remark  [ rem : familypeaks ] .",
    "the generating function of the second part is @xmath312 while by proposition  [ proposition : walk_encoding ] the first part is in bijection with walks in @xmath127 ending at height @xmath261 .",
    "the latter can be seen as collections of pairs ( dyck path , horizontal step ) , followed by a couple of dyck walks , the first starting and ending at height 0 , and the second at height 1 , as illustrated below .",
    ".,width=302 ]    this yields the generating function @xmath313 the second term on the right - hand side of   arises as the product of these two generating functions , after dividing by @xmath314 , which corresponds to the occurrence of one @xmath105 belonging to both parts of our split .",
    "finally , for the proof of  , we use the type @xmath106 case of proposition  [ prop : typeclassiques ] . starting from a self - dual alternating heap @xmath56 of type @xmath12",
    ", we have three cases :    * if there is no occurrence of @xmath107 in @xmath56 , then proposition  [ proposition : walk_encoding ] and formula   give the generating function @xmath315 .",
    "* if there is at least one occurrence of @xmath107 in @xmath56 ( self - duality implies this number is odd ) , we replace @xmath316 by @xmath317 or @xmath318 , giving rise to two heaps corresponding to elements of @xmath319 , which are in bijection with walks in @xmath320 ending at odd height .",
    "this gives the generating function @xmath321 , with the same decomposition as in figure  [ fig : decomp_c+ ] , in which @xmath140 is replaced by @xmath322 .",
    "* if there is exactly one occurrence of @xmath107 in @xmath56 , we must add the generating function for the self - dual fc heaps corresponding to type @xmath106 involutions , by replacing @xmath107 by @xmath323 .",
    "these elements are in bijection with walks in @xmath320 ending at height @xmath261 , whose generating function has already been computed ( see figure  [ fig : decomp_x ] ) . taking into account an extra @xmath14 due to the occurrence of @xmath109 , we obtain the generating function @xmath324 .",
    "the generating function of right - peaks of type @xmath106 is the one for type @xmath12 multiplied by @xmath14 , and it is equal to @xmath325 by summing up these four expressions we obtain formula   after a few simplifications .",
    "finally the functional equations for @xmath140 and @xmath322 can be computed thanks to classical decompositions of ( prefixes of ) dyck walks .      in this section",
    ", we will give the description of the heaps for fc involutions in @xmath21 , and their generating function with respect to the length .",
    "recall from  ( * ? ? ?",
    "* proposition  2.1 ) that an element @xmath3 in @xmath326 is fc if and only if , in any reduced decomposition of @xmath3 , the occurrences of @xmath195 and @xmath327 alternate for all @xmath328 , where we set @xmath329 .",
    "this shows that fc heaps for the graph of type @xmath326 coincide exactly with alternating heaps ( extended to the non - linear coxeter diagram of @xmath21 ) .",
    "moreover , from lemma  [ lemme : heapinvolution ] , we immediately derive the following description .",
    "[ prop : descriptionaaffine ] a fc element @xmath330 is an involution if and only if @xmath82 is a self - dual alternating heap of type @xmath21 .",
    "we shall represent heaps of type @xmath21 by depicting all ( alternating ) chains @xmath331 for @xmath332 . to be able to represent these chains in a planar fashion",
    ", we duplicate the set of @xmath333-elements and use one copy for the depiction of the chain @xmath334 and one copy for @xmath335 .",
    "this can be seen in figure  [ fig : bijection_typea ] , where we also illustrate the restriction of the bijection with walks from  @xcite to self - dual alternating heaps corresponding to involutions .",
    ".,width=453 ]    note that proposition  [ prop : descriptionaaffine ] immediately implies finiteness of the set of fc involutions in @xmath21 if @xmath20 is odd , as the corresponding heaps @xmath56 can not have _ full support _",
    ", i.e. there exists necessarily an integer @xmath182 such that @xmath336 .",
    "indeed , thanks to self - duality and the alternating condition , one can see that there exists even in this case an integer @xmath182 such that @xmath337 . moreover , we are able to deduce the following result , where as usual @xmath338 f(x)$ ] stands for the coefficient of @xmath339 in the power series @xmath147 .",
    "[ prop : involutionsaaffines ] the generating function , with respect to the length , of fully commutative involutions of type @xmath21 , is equal to @xmath340\\frac{{m}(x)(1+tx^2\\frac{\\partial(x{m})}{\\partial x}(tx))}{1-x{m}(x)},\\ ] ] where @xmath341 is the generating function for walks in @xmath342 starting and ending at the same height .",
    "moreover , if @xmath20 is odd ,   is a polynomial , while the corresponding growth sequence is ultimately periodic with period dividing @xmath20 , if @xmath20 is even",
    ". finally , in the latter case , periodicity starts at length @xmath343 .    from proposition",
    "[ prop : descriptionaaffine ] , we know that fc involutions in @xmath21 correspond to self - dual alternating heaps . next , by using the restriction to self - dual heaps of the bijection @xmath344 of  ( * ? ? ?",
    "* theorem 2.2 ) , we see that these involutions are in one - to - one correspondence with walks in @xmath125 starting and ending at the same height . moreover , the length of the corresponding involution is equal to the area below the walk .",
    "such walks can be decomposed according to whether they hit the @xmath124-axis or not , as can be seen below .",
    "[ fig : decomp_atilde_invol ]    the first term in formula   corresponds to the walks on the left . for the walks on the right ,",
    "the central part is in @xmath345 ( for a @xmath114 between @xmath122 and @xmath346 ) whose generating function is given by  , while the other two parts can be joined to form a path in @xmath347 . the second term in formula   is therefore obtained through classical considerations ( see for example the proof of  ( * ? ? ?",
    "* corollary 2.4 ) ) .",
    "next , it is clear that if @xmath20 is odd , then @xmath348 , while ultimate periodicity is obvious from formula   if @xmath20 is even . finally , in the latter case , the second term in   is a polynomial with degree @xmath349 , which corresponds to the area of the walk starting and ending at the origin ( having therefore @xmath350 up steps followed by @xmath350 down steps ) , and this finishes the proof .      by using the classification results of  @xcite ,",
    "it is possible to compute all the generating functions for fc involutions @xmath18 when @xmath0 is affine .",
    "nevertheless , we will only give the results for types @xmath351 , @xmath352 and @xmath353 , and we leave the exceptional types to the interested reader .",
    "in the following result , we give the general forms of these generating functions , which shows ultimate periodicity of the growth sequence in all cases .",
    "note that the exact beginning of periodicity could also be computed by our methods .",
    "denote by @xmath354 , ( _ resp . _",
    "@xmath355 ) the subfamily of @xmath356 of paths ending at an even ( _ resp . _",
    "odd ) height .",
    "denote also by @xmath357 , ( _ resp . _",
    "@xmath358 ) the subfamily of @xmath356 of paths starting and ending at an even ( _ resp .",
    "_ odd ) height .",
    "recall that to each one of these families we associate a generating function as explained in section  [ subsec : walks ] .",
    "[ prop : involutionsbcdaffines ] the generating functions for fully commutative involutions in types @xmath359 , @xmath360 and @xmath361 are respectively given by : @xmath362 where @xmath363 , and @xmath364 are polynomials .",
    "the corresponding growth sequences are ultimately periodic , with period dividing @xmath365 , @xmath366 , and @xmath365 , respectively .    from",
    "* theorem 3.4 ) and lemma  [ lemme : heapinvolution ] , fc involutions in @xmath367 correspond to self - dual heaps belonging to five families , among which only two are infinite .",
    "it is therefore enough to focus on these two sets , the first of which being made of alternating heaps . from proposition  [ proposition :",
    "walk_encoding ] , such elements correspond to walks in @xmath125 ; their generating function is given by @xmath368\\frac{(1+tx{q}(tx))^2}{1-x{m}(x)},\\ ] ] by considering as before the decomposition illustrated below .",
    ".,width=453 ]    the elements of the second infinite set are the self - dual zigzags ; they are self - dual heaps of the form @xmath369 where @xmath76 is a finite factor of the infinite periodic word @xmath370 such that @xmath371 for at least one @xmath372 .",
    "the minimal length is equal to @xmath373 , as can be seen in figure  [ fig : zigzag ] , left .",
    "moreover , there are @xmath374 self - dual heaps for each length @xmath375 ( with @xmath376 ) by left - right symmetry , and @xmath122 for other lengths , yielding the generating function @xmath377 summing these expressions and adding the polynomial generating functions corresponding to self - dual heaps in the three remaining finite families from  @xcite gives  .    for fc involutions of type @xmath360 , and from  @xcite and lemma  [ lemme : heapinvolution ] , it suffices to examine among type @xmath360 alternating and zigzag heaps which ones are self - dual . concerning alternating ones , we perform the following substitution in each self - dual alternating heap @xmath56 of type @xmath367 :",
    "replace the occurrence of @xmath378 by @xmath379 or @xmath380 , together with the replacement @xmath381 in the case of exactly one occurrence of @xmath107 .",
    "the self - duality condition forces @xmath382 to be either odd , or equal to @xmath122 .",
    "therefore the generating function for self - dual alternating heaps of type @xmath360 takes the form @xmath383\\frac{q(x)}{1-xm(x ) } + [ x^n]\\left(t^2{q}(tx)+\\frac{xt^2{q}(x){m}(tx)}{1-x{m}(x)}\\right),\\ ] ] where @xmath384 is the generating function for walks in @xmath125 ending at odd height .",
    "moreover , the only non - polynomial term in this expression is @xmath384 .",
    "the corresponding walks can be decomposed as in figure  [ fig : decomp_c_affine ] in which the parity of @xmath263 has to be taken into account , and the last term @xmath385 has to be replaced by @xmath322 .",
    "this yields @xmath386\\frac{(1+tx { q}(tx)){q}^o(x)}{1-x{m}(x)}.\\ ] ]        the minimal length for self - dual zigzags of type @xmath360 is equal to @xmath387 .",
    "moreover , for any @xmath388 there are @xmath374 self - dual heaps for each length @xmath389 : these are the heaps starting and ending at @xmath107 or @xmath108 ( see figure  [ fig : zigzag ] , middle ) . for other lengths",
    "there is only @xmath261 such heap , yielding the generating function @xmath390 it is then easy to derive formula   by adding the previous generating functions to the polynomials corresponding to self - dual heaps in the three remaining ( finite ) families of  @xcite .",
    "finally , for fc involutions of type @xmath361 , we again consider the self - dual heaps among alternating and zigzag ones .",
    "the alternating self - dual heaps correspond to walks in @xmath125 starting and ending at odd height .",
    "moreover , each such walk gives rise to @xmath391 fc involutions , according to the choices of @xmath392 or @xmath393 , and @xmath107 or @xmath108 . among these walks ,",
    "only the ones staying above the @xmath124-axis correspond to an infinite number of elements , their generating function is given by : @xmath394 as can be seen as before through classical walk decomposition .",
    "the minimal length for self - dual zigzags is @xmath395 . for any @xmath388 , by left - right symmetry",
    "there are @xmath391 such elements for each length @xmath396 ( see figure  [ fig : zigzag ] , right ) , @xmath374 for other even lengths , and @xmath122 for odd lengths , yielding the generating function @xmath397",
    "this section is not about enumeration , but aims at illustrating how the representation of fc elements as heaps can be useful in other ways .    in  @xcite , fan and green study the affine temperley ",
    "lieb algebra @xmath399 .",
    "it is a quotient of the type @xmath21 hecke algebra , and can be defined by generators @xmath400 for @xmath401 and relations : @xmath402 note that the first relation involves usually an extra parameter @xmath403 , but this has no incidence on the results we will describe .",
    "the algebra @xmath399 has a linear basis @xmath404 indexed by fc elements in @xmath21 : one can define unambiguously @xmath405 where @xmath406 is any reduced expression of the fc element @xmath3 .        since @xmath412 is a preorder , @xmath413 is an equivalence relation whose classes are called _",
    "right cells_. these are analogues of the famous kazhdan  lusztig cells which give representations of the hecke algebras , in the arguably simpler context of the temperley ",
    "lieb algebra @xmath399 .      in the sequel",
    "we wish to show how the use of heaps can illustrate this result and make it more precise . to this aim",
    "we first describe in terms of heaps the so - called _ reduction _ of fc elements used in @xcite .",
    "reduction is easy to illustrate on heaps : @xmath419 if @xmath195 labels a maximal element in @xmath82 and if either @xmath224 or @xmath327 labels a maximal element in @xmath420 , where @xmath421 is the maximal element of the chain @xmath422 .",
    "we refer the reader to figure  [ fig : irr1 ] for a chain of successive reductions .          a fc element @xmath3 is called _ irreducible _ if it can not be reduced to @xmath415 for any @xmath182 .",
    "it is relatively easy to give a characterization of the heaps of such elements .",
    "recall that the support of the fc element @xmath3 is the set of @xmath195 , @xmath424 , which occur in a reduced decomposition of @xmath3 .",
    "first it is clear that such elements are indeed irreducible .",
    "suppose @xmath3 is not of this form .",
    "then ( up to a cyclic shift of the indices and a relabeling @xmath430 ) , the following situation occurs : one has @xmath431 and either @xmath432 or @xmath433 .",
    "therefore @xmath434 and we are done .          otherwise , @xmath20 is even by the proposition .",
    "define @xmath435 and @xmath436 .",
    "then select in @xmath82 the upper ideal isomorphic to the heap of @xmath437 with the maximal number of factors , where @xmath438 .",
    "two such examples are illustrated in figure  [ fig : irr2 ] , middle and right , the one in the middle ( _ resp .",
    "_ right ) having an odd ( _ resp .",
    "_ even ) number of such factors .          to obtain theorem  [ theo : cells_involutions ]",
    ", we need to relate irreducible elements to involutions .",
    "one easily constructs an irreducible element from a fc involution by reducing it repeatedly .",
    "it can be seen in this case that the process is reversible : given such an irreducible element with heap @xmath56 , take the dual of @xmath440 and add it as an upper ideal to @xmath56 , as illustrated in figure  [ fig : irr3 ] .",
    "right cells with no involution are now easy to characterize : those are the ones whose unique irreducible element has full support and a top part @xmath439 with an even number of factors @xmath441 : see for example the right heap in figure  [ fig : irr2 ] . indeed the inverse process does not produce a fc heap in this case .",
    "g.  x. viennot .",
    "heaps of pieces .",
    "i. basic definitions and combinatorial lemmas . in _",
    "combinatoire numrative ( montreal , que . , 1985/quebec , que . , 1985",
    ") _ , volume 1234 of _ lecture notes in math .",
    "_ , pages 321350 .",
    "springer , berlin , 1986 ."
  ],
  "abstract_text": [
    "<S> an element of a coxeter group @xmath0 is fully commutative if any two of its reduced decompositions are related by a series of transpositions of adjacent commuting generators . in the present work , </S>",
    "<S> we focus on fully commutative involutions , which are characterized in terms of viennot s heaps . by encoding </S>",
    "<S> the latter by dyck - type lattice walks , we enumerate fully commutative involutions according to their length , for all classical finite and affine coxeter groups . in the finite cases </S>",
    "<S> , we also find explicit expressions for their generating functions with respect to the major index . </S>",
    "<S> finally in affine type @xmath1 , we connect our results to fan  </S>",
    "<S> green s cell structure of the corresponding temperley  </S>",
    "<S> lieb algebra .    </S>",
    "<S> [ multiblock footnote omitted ] </S>"
  ]
}