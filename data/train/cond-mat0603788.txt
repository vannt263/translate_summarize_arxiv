{
  "article_text": [
    "monte carlo simulations are used as standard techniques to investigate statistical mechanical properties of many - body systems .",
    "the use of efficient algorithms is important , and much effort has been devoted to the development of new monte carlo algorithms , such as cluster algorithms @xcite and extended ensemble methods @xcite .    for systems with discrete symmetry ,",
    "a refined treatment is possible for the coding of the computer program .",
    "for instance , in the simulation of the ising model , only one bit is required for storing the information of a single spin ; a computer word can store the information of several spins at the same time . the multispin coding technique developed by bahnot _",
    "_ @xcite and michael @xcite is based on this fact , and the ising spins of 64 systems are put in a single computer word when using the 64-bit machine .",
    "the monte carlo spin flip process is executed with the logical commands , and 64 ising systems are updated simultaneously with a single random - number sequence .",
    "accordingly , the computation time is reduced remarkably . for 64 systems",
    ", one may assign either systems having different parameters , for example , the temperature , the external field , etc . , or systems having the same parameters but with different random number sequences .",
    "the multispin coding has been successfully used for the study of the ising model on the regular lattices @xcite and that on the quasicrystal @xcite .",
    "the three - state random potts model together with the block - spin transformation was also formulated using the multispin coding @xcite .",
    "the multispin coding was applied not only to the single spin flip dynamics but also to the kawasaki spin exchange dynamics @xcite .",
    "the histogram reweighting @xcite is a powerful method to investigate the equilibrium properties with simulations ; only simulation at a single temperature is required to obtain information for a range of temperatures .",
    "recently , the present authors  @xcite have extended the idea of reweighting to the case of nonequilibrium systems based on the sequential importance sampling @xcite .",
    "a sequence of the micro - states , or a path , is generated , and the average over a single path is performed to calculate thermodynamic quantities for a standard monte carlo simulation . in nonequilibrium reweighting , on the contrary , many paths are first sampled with a trial distribution , and thermodynamic quantities are calculated based on the relative probability between the trial distribution and the target distribution .",
    "the relative probability is called  weights \" in literature , which we shall use hereafter .",
    "the nonequilibrium reweighting technique was used for the nonequilibrium relaxation of the ising model , and the dynamical properties of the phase transition are discussed @xcite . moreover , the present authors @xcite applied the nonequilibrium reweighting to the study of the nonequilibrium steady states @xcite ; the driven diffusive lattice gas model proposed by katz , lebowitz and spohn ( kls ) @xcite was employed as an example of the system showing the phase transition to the nonequilibrium steady state .    in this paper , we present the multispin coding of the nonequlibrium reweighting .",
    "it greatly saves computation time .",
    "we pick up the driven diffusive lattice gas model , the kls model @xcite , to illustrate the multispin coding , but the formulation is general .",
    "of course , it can be used for the ising model , which is simpler .",
    "we organize the rest of the paper as follows . in sec .",
    "[ sec : model ] , we briefly explain the kls model . in sec . [ sec : reweighting ] , a short description of the nonequilibrium reweighting method is given .",
    "[ sec : multispin ] , which is the main part of this paper , gives the illustration of the multispin coding . in sec .",
    "[ sec : results ] , we give the result of the calculation .",
    "the final section is devoted to summary and discussions .",
    "we use the kls model  @xcite for an illustration of the nonequilibrium reweighting method .",
    "this model consists of a _",
    "half filled _ lattice gas on a periodic @xmath0 square lattice .",
    "its hamiltonian is given by @xmath1 where the sum of lattice sites @xmath2 is over nearest neighbors , and the variable at the lattice site @xmath3 if the site is filled and @xmath4 if the site is empty .",
    "for the monte carlo update , particles are allowed to hop to an empty nearest neighbor site with the metropolis rate , @xmath5 \\label{eq : trate}\\ ] ] where @xmath6 and @xmath7 are the system configurations before and after the hop , @xmath8 represents the change in energy due to the hop , @xmath9 is a constant driving force , @xmath10 or @xmath11 depending on whether the hop is against , orthogonal or along the direction of the drive , and @xmath12 is the inverse temperature of the heat bath .",
    "the @xmath13 direction is taken as the direction of the drive .",
    "the kls model exhibits an order - disorder second order phase transition .",
    "the ordered phase consists of strips of high- and low - density domains in the direction of the drive . in the final steady state",
    ", a single strip of high density domain is formed  @xcite .",
    "the density profile along the direction of the drive can be regarded as the order parameter , and it can be defined as @xmath14",
    "in a monte carlo simulation , the system configuration changes with time . in each monte carlo step , a randomly chosen particle is attempted to hop to a nearest neighbor site and the attempt is either accepted or rejected .",
    "let @xmath15 be the initial system configuration and let @xmath16 be the system configuration of the second monte carlo step , and @xmath17 be the system configuration of the third monte carlo step and so on .",
    "in this way , a monte carlo simulation can be represented by a series of system configurations and we define a  path \" of the simulation as follows , @xmath18 many paths are sampled and the thermal average of a quantity @xmath19 may be calculated by averaging over these paths , @xmath20 , where the sum is over all paths indexed by @xmath21 , @xmath22 and @xmath9 are the inverse temperature and drive used in the monte carlo sampling process . the objective of reweighting is to calculate the thermal averages of @xmath19 at another temperature @xmath23 and drive @xmath24 .",
    "this can be achieved by using appropriate weights @xmath25 , @xmath26 to calculate the weights , the following steps are implemented :    1 .",
    "assume that a path @xmath27 up to some time @xmath28 is sampled from a simulation at @xmath22 and @xmath9 .",
    "2 .   in the next monte carlo step , choose a pair of neighboring sites at random . if one of the two sites is empty , perform a kawasaki exchange between the two sites with the rate @xmath29 .",
    "@xmath30 represents the trial system configuration after the move .",
    "the trial move is either accepted or rejected . in each case , we define an incremental weight @xmath31 , * if the move is accepted , @xmath32 and @xmath33 . *",
    "if the move is rejected , @xmath34 and @xmath35/                         [ 1 - t_{\\beta , e } ( { \\sigma'}^j |\\sigma_t^j ) ] $ ] .",
    "the weights at @xmath36 are given by multiplication : @xmath37    for each path @xmath38 these steps are repeated until a predetermined maximum monte carlo time is reached .",
    "we shall illustrate multispin coding for reweighting with infinite drive ; generalization to finite drive is straightforward .",
    "we use bitwise operations to update our system configurations and to calculate the weights . on a 64-bit machine ,",
    "64 systems are simulated in one run . for an @xmath39 lattice ,",
    "we use @xmath40 words to represent simultaneously @xmath41 lattices with each bit in the word representing one lattice site .",
    "our multispin implementation is done systematically using truth tables .",
    "firstly , we construct the appropriate truth tables for various tasks , and then we implement them using bitwise operations in the computer .    @ccc@",
    "@xmath42 & transition rate & @xmath43 + @xmath44 & @xmath45 & 0 0 0 0 + @xmath46 & @xmath47 & 0 0 0 1 + @xmath48 & @xmath49 & 0 0 1 0 + @xmath50 & @xmath51 & 0 0 1 1 + @xmath52 & 1 & 0 1 0 0 + @xmath53 & 1 & 0 1 0 1 + @xmath54 & 1 & 0 1 1 0 + @xmath55 & 1 & 0 1 1 1 + @xmath56 & 1 & 1 0 0 0 +    [ tbl : trate ]      in the kawasaki exchange , a pair of neighbor sites is chosen and if one site is empty and the other site is filled , an attempt is made for the particle in the filled site to hop to the empty site with a rate given by eq .",
    "( [ eq : trate ] ) . in the coding implementation",
    ", we should note that possible values of @xmath42 for infinite drive are @xmath57 , and @xmath56 .",
    "for example , when the attempt is made to move a particle against the drive , @xmath58 and if the move is along the drive , @xmath59 . if the move is orthogonal to the drive , @xmath60 and @xmath61 or @xmath62 depending on the local particle configurations of nearest neighbors to the chosen sites .",
    "we map the values of @xmath63 into a four - bit pattern @xmath43 , which is illustrated in table [ tbl : trate ] ; there , we also give the transition rate ( eq .  ( [ eq : trate ] ) ) for each @xmath42 . in the multispin coding",
    ", we introduce a dummy variable @xmath64 , which takes @xmath45 to @xmath65 in the present case , to implement the acceptance and rejection procedure .",
    "two arrays ` p0 ` and ` p1 ` are allocated for representing the probability of appearance of @xmath64 .",
    "the array variable @xmath66 for ` p0`[@xmath66 ] and ` p1`[@xmath66 ] takes 0 to max@xmath68 . for the size of array , max@xmath66",
    ", we choose a large enough number , for example @xmath69 .",
    "the values of each bit in ` p0 ` and ` p1 ` are set according to the transition rates as shown in fig .",
    "[ fig : jtbl ] . bits in the @xmath66th element of the arrays , when put together as ( ` p1`[@xmath66 ] , ` p0`[@xmath66 ] ) , form a binary representation of the numbers @xmath70 and @xmath71 .",
    "the arrays ` p0 ` and ` p1 ` are related to the transition probability distribution as follows .",
    "let @xmath66 be a random number between @xmath45 and max@xmath72 , then the probability of getting the array elements with the bit pattern ( ` p1`[@xmath66 ] , ` p0`[@xmath66 ] ) @xmath73 is @xmath74 , for example .",
    "we build the arrays ` p0 ` and ` p1 ` bit - by - bit and shuffle each bit independently .",
    "note that the sequence of shuffling for each @xmath75th bit in ` p0 ` and ` p1 ` _ must _ be the same for both arrays .",
    "then , the actual monte carlo procedure in the multispin coding can be summarized as follows ;    1 .   pick a pair of neighboring sites @xmath76 , @xmath77 and perform a kawasaki exchange trial .",
    "2 .   from @xmath42 ,",
    "determine @xmath78 .",
    "3 .   let @xmath66 be a random number generated uniformly between @xmath45 and max@xmath72 .",
    "4 .   assign an acceptance bit @xmath79 ( acceptance ) if @xmath80 + { \\verb+p0+}[\\lambda ] \\ge 4.\\ ] ] otherwise assign @xmath81 ( rejection ) .",
    "assignment of @xmath82 can be implemented using table [ tbl : accept ] .",
    "finally , the kawasaki particle exchange is performed using @xmath83 operations of @xmath82 with both neighboring lattice sites .",
    "@xmath84      implementation of multispin coding for reweighting is much easier than that of the kawasaki particle exchange .",
    "possible values of incremental weights @xmath85 are @xmath86 the weights can then be written as a product of incremental weights , @xmath87 where @xmath88 are the number of hits on the incremental weights @xmath89 during the course of simulation from time @xmath90 to @xmath28 .",
    "note that @xmath91 is irrelevant in eq .",
    "( [ eq : msw ] ) . hence calculation of weights has been reduced to accumulating histograms . in our implementation , we store the hits in a large array @xmath92 for @xmath93 and @xmath94 for an arbitrarily chosen @xmath95 .",
    "weights and histograms are updated only once every @xmath95 steps using eq .",
    "( [ eq : msw ] ) , and @xmath96 . for calculating @xmath97",
    ", we use the four - bit pattern @xmath98 and acceptance decision @xmath82 defined earlier . then for each @xmath99",
    ", assign @xmath97 according to the truth table given in table [ table : dh ] .",
    "to calculate the summation @xmath100 in the multispin coding , we use the same routine to compute the total magnetization or energy .",
    "the bit - counting routine , ` bitcnt ` , by ito and kanada  @xcite can be used .",
    "the essential point is that we do not have to calculate the weights by multiplication at each time , but we only need to calculate the histograms @xmath101 , which are obtained by integer operations .",
    "we performed simulations with reweighting on the kls model with infinite drive . in fig .",
    "[ fig : infinite ] , as an example , we show the time variation of the order parameter , eq .",
    "( [ order ] ) , for @xmath102 lattice with infinite drive .",
    "simulations were performed at @xmath103 and data reweighted to nearby temperatures , @xmath104 , and 3.170 ( from top to bottom ) .",
    "averages were taken over @xmath105 samples .",
    "we should note that the direct calculations at temperatures different from @xmath103 gave the consistent results as the reweighted ones within statistical errors , which shows the effectiveness of the reweighting .",
    "the detailed analysis of the phase transition based on the finite - size scaling was reported in a separate paper @xcite .",
    "we here mention about the performance of our multispin coding .",
    "the computation time of the calculation with multispin coding for 64 systems is 40 to 60 times faster than that for independent 64 simulations without multispin coding for typical system size .",
    "this is a rough estimate because such a comparison depends on the optimization of program .",
    "the overhead of computation time to calculate the histogram @xmath101 is the same order as the spin flip process , if we use the ` bitcnt ` routine  @xcite once per @xmath106 single spin flip steps .",
    "this is the same situation as the calculation of the thermal quantities . in this way ,",
    "the calculation of weights by the histogram , eq .",
    "( [ eq : msw ] ) , reduces the computation time .",
    "more important is that the accumulated errors will be much reduced for histogram calculations compared to the calculation with the multiplication of incremental weights each time .     lattice . from top to bottom",
    ", values of @xmath107 are @xmath108 , and 3.170.,width=287 ]",
    "we have formulated the nonequilibrium reweighting method that is convenient for implementing multispin coding . in addition , we have shown how multispin coding can be implemented for both particle hopping and nonequilibrium reweighting .",
    "all the computations are performed in terms of integer with logical commands . as a result ,",
    "a large increase of efficiency has been achieved .",
    "we would like to remark that the nonequilibrium reweighting method is general and may be applied to various models with different monte carlo updates . in this paper",
    ", we have treated the case of two component system with the metropolis update .",
    "nonequilibrium reweighting can be applied to multi component systems , for example , @xmath109-state potts models , and also to the heat - bath update .",
    "a generalization of the formulation is necessary , which will be discussed elsewhere @xcite .",
    "the authors thank n. ito for valuable discussions . this work is supported by a grant - in - aid for scientific research from the japan society for the promotion of science .",
    "the computation of this work has been done using computer facilities of the supercomputer center , institute of solid state physics , university of tokyo .",
    "99 r. h. swendsen and j. s. wang , phys .",
    "lett . * 58 * , 86 ( 1987 ) .",
    "u. wolff , phys .",
    "lett . * 62 * , 361 ( 1989 ) .",
    "h. k. lee and r. h. swendsen , phys .",
    "b * 64 * , 214102 ( 2001 ) . y. tomita and y. okabe , phys . rev",
    "86 * , 572 ( 2001 ) .",
    "b. a. berg and t. neuhaus , phys .",
    "b * 267 * , 249 ( 1991 ) ; phys .",
    "lett . * 68 * , 9 ( 1992 ) .",
    "j. lee , phys .",
    ". lett . * 71 * , 211 ( 1993 ) .",
    "m. c. de oliveira , t. j. p. penna , and h. j. herrmann , eur .",
    "j. b * 1 * , 205 ( 1998 ) .",
    "f. wang and d. p. landau , phys .",
    "lett . * 86 * , 2050 ( 2001 ) .",
    "a. m. ferrenberg and r. h. swendsen , phys .",
    "lett . * 61 * , 2635 ( 1988 ) . h. k. lee and y. okabe , phys .",
    "e * 71 * , 015102(r ) ( 2005 ) .",
    "a. doucet , n. de freitas , and n. gordon , _ sequential monte carlo methods in practice _ , ( springer , new york , 2001 ) . j. s. liu , _ monte carlo strategies in scientific computing _ , ( springer , new york , 2001 ) . h. k. lee and y. okabe , j. phys .",
    "a * 38 * , l241 ( 2005 ) .",
    "b. schmittmann and r. k. p. zia , _ statistical mechanics of driven diffusive systems _ , ( academic press , new york , 1995 ) .",
    "j. marro and r. dickman , _ nonequilibrium phase transitions in lattice models _ , ( cambridge university press , cambridge , 1999 )",
    ". s. katz , j. l. lebowitz , and h. spohn , phys .",
    "b * 28 * , 1655 ( 1983 ) ."
  ],
  "abstract_text": [
    "<S> we present the multispin coding for the nonequlibrium reweighting method of the monte carlo simulation , that was developed by the present authors . as an illustration , we treat the driven diffusive lattice gas model . </S>",
    "<S> we use the multispin coding technique both for the spin update and for the calculation of the histogram of incremental weights , which is needed in the calculation of nonequlibrium reweighting . </S>",
    "<S> all the operations are executed by the bitwise logical commands . </S>"
  ]
}