{
  "article_text": [
    "an increasing number of projects are dealing with high intensity accelerators and plasma devices .",
    "an efficient simulation tool for charged particle transport in such machines is in demand .",
    "institut fr angewandte physik at university frankfurt is engaged in many such projects .    the storage ring project known as `` figure-8 storage ring '' ( f8sr ) deals with accumulation of low energy high current beams @xcite .",
    "particularly , a proton beam at an energy of @xmath0 with a current of about @xmath1 is desired to inject into the ring comprising of toroidal like magnetic field with closed magnetic field lines .",
    "the preliminary experiments are designed to operate at room temperature with an aim to build an injection system .",
    "a numerical model was required to calculate the beam optics taking into account effect of fringing fields without paraxial approximation and momentum conservation in magnetic field configuration .",
    "the particle trajectories must be calculated in complex magnetic field .",
    "the particle motion is dominated by various kinds of drifts arising due to inhomogeneity in the field distribution .",
    "the pic model was implemented in circular toroidal coordinate systems .",
    "the frankfurt neutron source at stern - gerlach zentrum ( franz ) is an ambitious project that aims to produce a high density neutron flux @xcite .",
    "the neutrons will be produced using @xmath2 reaction , by accelerating intense proton beam ( about @xmath1 ) up to an energy of @xmath3 on the @xmath4-target .",
    "the beam transport becomes challenging especially in the view of high perveance proton beam . in the low energy beam transport ( lebt )",
    "section a beam chopper is desired to avoid beam loading in the rfq .",
    "the simulation tool was designed to calculate space charge dominated beam transport in the chopper system taking into account effects of secondary electron production , dynamical effects on the bunched beam , and space charge compensation .",
    "the poisson equation was modified with irregular boundary condition to simulate the electric field from curved plates .",
    "the effect of mirror charges and sparking problem can be investigated .",
    "the benchmarking of the simulation code is an important factor in gaining the confidence .",
    "the model validation was done by comparison of simulation results with measurements . the pic model in toroidal coordinate was verified by beam transport experiments in toroidal magnetic fields .",
    "the simulation results showed a good agreement within an acceptable error range .",
    "the initial results from the kicker experiments are compared with the simulation result those shows the effect of the secondary electrons on beam diagnostics .",
    "a subroutine based on monte carlo technique is incorporated to study the production mechanism of different ion species in simple he- plasma generated in the volume type ion source . in the following section we will discuss the development of the numerical model and the special features implemented in the package for various scenario .",
    "the main task in charge particle simulation is to calculate interparticle coulombic forces . an intuitive",
    ", simplest model is so called particle particle ( pp ) method which calculates the electric force on each particle due to others in every time step .",
    "this has limits not only in terms of execution time but also the data management with respect to number of particles under consideration . to overcome these limitations particle in cell method",
    "can be used . in pic method the information of particle distribution is transferred to the set of grid points .",
    "the grid can be conveniently chosen according to the system geometry e.g. cartesian coordinates in the simplest case , or a cylindrical mesh for circular symmetry .",
    "the electric field is calculated on grid points using poisson equation .",
    "the periodicity and the symmetry of the grid give decisive advantage in solving the poisson equation .",
    "this electric field is interpolated back on the particle positions @xcite .",
    "the general algorithm for pic method is shown in fig .",
    "[ pic_algorithm ] .",
    "different approaches are implemented to define the initial phase space distribution of particles .",
    "commonly in the accelerator physics kapchinsky - vladimirsky ( kv ) , waterbag or gaussian distribution are used to define the beam like distribution with main component of momentum in the forward direction with a small spread in transverse velocity plane . on the other hand",
    "the maxwellian distribution is defined for a thermalized distribution .",
    "it is convenient also to use a homogenous distribution for analytical comparison with a numerical model e.g. simulated potential distribution due to a homogenous cylindrical beam which can easily be compared using gauss law .      for an efficient calculation of inter particle forces",
    "the pic model was used .",
    "cartesian , cylindrical , or toroidal grids , as per requirement imposed by geometry were generated .",
    "the first order weighing scheme was used to calculate the charge density at grid points .",
    "each of the particles is identified in a particular cell and then the charge is attributed to grid points according to a relative volume in the 3d space .",
    "for example , as shown in fig .",
    "[ piccdcart ] , in 2-dimensional case , a particle is identified at grid point b called a nearest grid point ( ngp ) .",
    "the charge of this particle , which can be a macro particle with cluster of particles , is divided according to the inverse area weight .",
    "charge density at the grid point is given by ,    @xmath5    and so on for @xmath6 where @xmath7 is the macro charge of a single particle also called _",
    "super particle_. thus the nearest grid point , point b , is weighted maximum as compared to the point d.      poisson equation ,    @xmath8    is written in cartesian coordinates as ,    @xmath9    this equation is discretized as    @xmath10    in this scheme the gradient is taken at half step as shown in fig .",
    "[ stencil_1 ] .        simplifying eq .",
    "( [ poissoneq_discrete ] ) we get ,    @xmath11    this gives a matrix equation    @xmath12    of the form    @xmath13    the matrix @xmath14 consist of a numerous of zero elements , and is known as _ sparse_. the sparse matrix format allows efficient use of computational memory by storing only non zero values and the corresponding reference pointer . after having the matrix equations with above described form , the iterative methods are used to solve them .",
    "they are effective when the number of equations @xmath15 , where @xmath16 is the number of grid points .",
    "the biconjugate gradient stabilized ( bicgstab ) method is used to solve a non - symmetric linear system .",
    "the matrix equation requires initial values also called boundary conditions . in the case of open boundary condition the potential at the selected grid points , normally on the surface ,",
    "is calculated using coulomb interaction , setting initial conditions for the system .",
    "the closed boundary conditions are more natural , with boundaries defined with respect to system geometry e.g the vessel wall . the semi - open or semi - closed boundary condition is the combination of the both , e.g. the vessel defined in transverse direction and open boundary in longitudinal . the code was further evolved to include so called arbitrary boundary condition .",
    "this facilitates definition of curved vessel boundary in cartesian coordinates or vice versa ( see fig .  [ boundary ] ) .      in case of the irregular geometry where the fixed potential value is not defined exactly on the mesh point",
    "the matrix elements need correction @xcite @xcite .",
    "the numerical stencil in 1-d case is shown in the fig .",
    "[ stencil_2 ] .",
    "the gradient at @xmath17 is then written by fitting quadratic polynomial as    @xmath18      \\label{phi_jump}.\\ ] ]    putting the values of @xmath19 s    @xmath20    in eq .",
    "( [ phi_jump ] ) we get ,    @xmath21 . &",
    "\\nonumber\\\\ &      \\label{phi_dash }      \\end{aligned}\\ ] ]    putting expression from equation ( [ phi_dash ] ) for @xmath22 in standard second derivative    @xmath23    @xmath24 .",
    "\\nonumber \\\\      &      \\label{phi_ddash_l }      \\end{aligned}\\ ] ]    above described scheme is useful for a boundary condition , where the @xmath25 is defined left to the @xmath26 .",
    "in the case where the @xmath25 is defined right to the @xmath26 , a similar analysis can be carried out to give ,    @xmath27 .",
    "\\nonumber\\\\      &      \\label{phi_ddash_r }      \\end{aligned}\\ ] ]    this numerical technique can be extended in 2d or 3d easily .",
    "then it can be used to calculate the potential arising from the curved boundary in the cartesian coordinates .    for the left boundary",
    "then the poisson equation can be written as ,    @xmath28,\\nonumber \\\\ &      \\end{aligned}\\ ] ] and for the right boundary condition we have ,    @xmath29 .\\nonumber \\\\ &      \\end{aligned}\\ ] ]    please note here , this model was used for wien type chopper system .",
    "hence only the cases of jump in @xmath30 and @xmath31 directions are analyzed ( refer section [ chopper system for franz ] ) .",
    "the electric field on mesh points then can calculated simply by ,    @xmath32    each component of the electric field can then be written in descretized form as ,    @xmath33    consequently , these electric fields at grid points are interpolated back on particle positions employing reversed pic scheme @xcite .",
    "the evolution of the particle is then calculated by simply putting fields and positions in non relativistic lorentz equation , @xmath34).\\ ] ] the time step @xmath35 plays an important role .",
    "for example , to describe the charged particle motion in magnetic field @xmath35 must be chosen at least @xmath36 times lesser than the gyration period . to describe the motion of particle over a longer time guiding centre equations",
    "must be used and symplectic integrators have to be involved .",
    "storage ring with figure-8 geometry will be built for accumulation of intense low energy ion beams .",
    "the structure uses continuous longitudinal magnetic field ( up to @xmath37 ) for focusing the beams in the ring .",
    "the room temperature experiments are aimed to build an injection system with two toroidal segments with maximum on axis field of @xmath38 @xcite .",
    "the dynamics of charged particle beams in magnetic fields is characterized by a gyrating motion . in curved magnetic fields",
    "the ion beam is guided on a circular path , additionally dominated by drift motion , namely @xmath39 drift due to curved magnetic field , @xmath40 drift due to the inhomogeneous field and @xmath41 drift due to the space charge @xcite .",
    "the pic code was designed to describe the beam transport in curved sectors .",
    "main features of the pic model implemented in this case are    * poisson equation in circular toroidal coordinates * complete 3d space charge routine , space - charge compensation through compensation electrons ( ce ) trapped in magnetic field * simulation results can directly be compared with experimentally available optical detection system * inclusion of secondary electrons ( se ) produced on wall due to beam losses        for the model the standard toroidal coordinates ( @xmath42 ) were used and the poisson equation was discretized in the same ( see fig .",
    "[ stellar_1 ] ) @xcite .",
    "* @xmath43 : minor radius of toroidal segment ; * @xmath44 : the poloidal angle measured in @xmath45 plane from @xmath46-axis ; * @xmath47 : the toroidal angle measured in @xmath48 plane from @xmath49-axis .",
    "special care has to be taken with respect to boundary conditions . in @xmath47 direction open boundaries",
    "were defined and in @xmath44 direction periodic boundary . in radial direction the potential is set to zero at @xmath50 where @xmath51 is vessel radius . for the second boundary condition at @xmath52 , the gauss s law is used .",
    "@xmath53      fig . [ stellar_2 ] shows the current experimental setup comprising two toroidal segments .",
    "this forms the main beam line for injection experiments .        in the early stages beam transport experiment",
    "were performed with fixed diagnostics probe at the end of first segment .",
    "[ stellar_3 ] shows the proton beam with energy @xmath54 detected using a phosphor screen .",
    "the beam centre is seen to be shifted vertically upward nreare to axis , as a function of the increasing magnetic field .",
    "the simulation results and measurements are compared in the graph .    ) as a function of magnetic field compared with simulation .",
    "the example images show proton beam at @xmath54 in three different magnetic field strength of @xmath55,@xmath56 and @xmath57 . ,",
    "width=302,height=151 ]    in the current experimental setup two segments are coupled to form a ripple like structure .",
    "[ stellar_4 ] shows the vertically drifted beam position along the beam path in longitudinal direction .",
    "the simulation results are qualitatively in good agreement with measurement .",
    "the error largely occurs in the straight section due to heavy beam losses producing background noise of secondary electrons .",
    "details of the experiments are discussed in @xcite .",
    "a wien - type kicker system with crossed electric - magnetic fields ( @xmath58 ) was proposed @xcite@xcite for franz project in low energy beam transport section .",
    "a static magnetic field deflects the beam into the beam dump .",
    "a pulsed electric field produced using curved plates compensates the deflection for a short time period and injected into the rfq ( see fig .  [ wien ] ) .",
    "transport of high current beam at low energy is dominated by space charge .",
    "the beam potential at a focus can be as high as @xmath59 . to reduce beam losses due to the space charge forces the chopper system has to be compact .",
    "the pic code is implemented for beam tracking , to investigate beam power dissipation and effects of secondary electrons on the beam transport .",
    "main features of the pic model in this case are    * semi open boundary condition that facilitates definition of circular flanges at the entrance and variable aperture ( iris ) at the output * continual generation and destruction of ions to mimic input dc beam and the beam dump * use of modular boundary condition to simulate curved deflector plates and circular repeller ring electrode in the cartesian coordinates    this simulation tool describes the evolution of beam trajectory over the time .",
    "multiple species can be transported simultaneously , thus effects of electrons on proton beam can be investigated .",
    "[ pulse_current ] shows the signal from pulse generator and the simulated proton beam current downstream of the chopper system .",
    "a proton beam with an energy @xmath60 and beam current @xmath1 was transported through an aperture of @xmath61 over the distance of @xmath62 .",
    "no space charge compensation was assumed . to show the effects of space charge compensation through secondary electrons",
    "a smaller aperture of @xmath63 was defined .",
    "the electrons were defined to produce at the beam dump and on the front wall .",
    "as the pulse rises , some electrons are sweeped with the ion beam into the aperture due to the beam potential .",
    "this causes about @xmath64 of the space charge compensation .",
    "[ current_electrons ] show a factor about @xmath65 in the increased beam current due to reduced beam diameter .",
    "the disadvantage may be foreseen as electrons reaching the electric plates causing high voltage break down or sparking .",
    "the experiments are arranged to test the beam transport through electric kicker and compare the numerical model .",
    "the experimental setup is shown in fig .",
    "[ kicker_setup ] . the @xmath66-beam ( energy @xmath67 , current @xmath68 ) from volume type ion source matched into the deflector tank using an array of two gabor lenses ( plasma lens gl ) .",
    "deflector tank has plates separated by a distance of @xmath69 over the length of @xmath70 .",
    "a high voltage pulse generator deflects the beam in the horizontal plane .",
    "downstream of the deflector tank , a current transformer is installed , followed by the beam dump .",
    "the pulsed electric field deflects the beam away which is recorded as a negative signal in the current transformer .",
    "the current transformer also shows the presence of positive peaks , before and after the beam signal .",
    "int simulation model the compensation electrons ( ce ) were defined , with homogenous distribution along the beam line .",
    "the secondary electrons are produced at the beam dump .",
    "a single electron was defined to produced in the opposite direction of the beam for every @xmath66 - ion hitting the beam dump .",
    "this gives an electron flow in the opposite direction causing space charge compensation .",
    "a steady flow of particles gives a zero current in the current transformer .",
    "as the pulse comes in the electrons are flown away before the ions and similarly are again trapped in the beam potential at the end of the pulse .",
    "this gives rise to two positive peaks .",
    "this scenario can be compared in fig .",
    "[ kicker_result ] .",
    "the positive peaks due to ce and secondary electrons can be clearly seen although the amplitude does not match exactly .",
    "particle in cell model is deterministic where as monte carlo method is probabilistic .",
    "the pic is used to simulate collective effect by calculation of self electric field and external fields and particles are moved through small time step . in the mc model",
    "the probability of collision and collision frequency is calculated using cross sectional probability as a function of energy , target density and time step .",
    "the kinetic energy of a particle , say of the specie @xmath71 , @xmath72 gives the total collision cross section @xmath73 where @xmath74 is the particle number and @xmath75 is the type of collision .",
    "then the collision probability for the @xmath74th particle is given by , @xmath76 where @xmath77 is the time step and @xmath78 is the density of target specie .",
    "four random numbers are then defined say @xmath79 .",
    "first two numbers determines that if the collision occurs or not and which type of collision process takes place .",
    "if @xmath80 $ ] such that @xmath81 , the collision is said to take place .",
    "second random number determines the type of collision .",
    "there can be multiple numbers of processes taking place with cross section probability overlapping .",
    "only one reaction can be defined in single time step .",
    "thus random number @xmath82 is used to determine the type of collision process . @xmath83 and @xmath84",
    "are used e. g. in the case of electron - neutral collisions        in electron neutral scattering collision the incident electron is scattered though say @xmath85 ( see fig .",
    "[ vectors ] ) .",
    "then the energy and @xmath85 are related by , @xmath86 where @xmath87 $ ] is the random number .",
    "the azimuthal scattering angle @xmath88 is assumed uniform over @xmath89 $ ] and is given by @xmath90 where @xmath91 $ ] is the last random number .",
    "with similar procedure , the cross sections for different type of reaction can be calculated .",
    "this mc model is parallel implemented in the simulation package to study simple case of he - plasma in volume type ion source .",
    "the initial results are only used to study the correlation of beam emittance and the plasma density in given set of electrode . in future end to end ion beam transport can be simulated for specific experiments .",
    "in this paper we have described features of the simulation package employing a pic model development . this numerical model is calculates the beam optics for space charge dominated transport with realistic external fields .",
    "the further development will concentrate on the efficiency of the model and the parallelization for faster calculation . for the magnetic storage ring project the model is adopted to design the injection system .",
    "the injection system is under construction with a main beam line already installed .",
    "the chopper system with curved electric plates has been designed and installed in the lebt section of franz beam line .",
    "the monte carlo subroutine will be further developed for the time resolved space charge compensation in the kicker system of the franz .",
    "ion beam interaction with different rest gas molecule will also be included in calculations .",
    "independent software will be dedicated using mc method for simulation of discharge plasmas in ion sources .",
    "i would like to thank c. wiesner , h. dinter for collaberation and data exchange from experiments .",
    "i would also like to acknowledge the project team working on the storage ring project f8sr and the franz .",
    "99 m. droba et al . , `` design studies on novel stellarator type high current storage ring '' , proc .",
    "epac06 , edingburough , 2006 , pp .",
    "297 - 299 , ` http://www.jacow.org ` . o. meusel et al . ,  development of an intense neutron source  franz  in frankfurt",
    "linac 2006 , knoxville , 2006 , ` http://www.jacow.org ` . c. k. birdsall and a. b. langdon , `` plasma physics via computer simulations '' , 1988 .",
    "h. johansen and p. colella ,  a cartesian grid embedded boundary method for poisson s equation on irregular domains \" , j. comp .",
    ", 147 , pp .",
    "60 - 85 ( 1998 ) .",
    "z. jomaa , c. macaskill ,  a finite difference poisson solver for irregular geometries \" , anziam j. 45 ( e ) pp .",
    "c713-c728 , 2004 .",
    "r. w. hockney and j. w. eastwood ,  computer simulation using particles \" , 2005 .",
    "n. joshi et al . , `` beam transport in toroidal magnetic field '' , proc .",
    "epac08 , genoa , 2008 , wepp053 , p.  2641",
    ", ` http://www.jacow.org ` . f. c. chen ,  introduction to plasma physics and controlled fusion , volume 1 : plasma physics \" , 2008 .",
    "r. balescu , transport processes in plasmas , vol . 1 and 2 north - holland pulication .",
    "n. joshi et al . `` scaled down experiments for a stellarator - type magnetostatic stogare ring '' , proc .",
    "ipac10 , kyoto , 2010 , ` http://www.jacow.org ` . c. wiesner ,",
    "diploma thesis , goethe - university , frankfurt am main . c. wiesner ,",
    "chopper for intense proton beams at repetition rates up to @xmath92 , conference proc .",
    "pac 2009 , ` http://www.jacow.org ` ."
  ],
  "abstract_text": [
    "<S> a simulation package employing a particle in cell ( pic ) method is developed to study the high current beam transport and the dynamics of plasmas . </S>",
    "<S> this package includes subroutines those are suited for various planned projects at university of frankfurt . in the framework of the storage ring project ( f8sr ) the code was written to describe the beam optics in toroidal magnetic fields . </S>",
    "<S> it is used to design an injection system for a ring with closed magnetic field lines . </S>",
    "<S> the generalized numerical model , in cartesian coordinates is used to describe the intense ion beam transport through the chopper system in the low energy beam section of the franz project . especially for the chopper system , </S>",
    "<S> the poisson equation is implemented with irregular geometries . </S>",
    "<S> the particle in cell model is further upgraded with a monte carlo collision subroutine for simulation of plasma in the volume type ion source . </S>"
  ]
}