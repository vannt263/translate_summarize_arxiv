{
  "article_text": [
    "the most popular implementation of density functional theory ( dft ) , in principle an exact theory ,  @xcite has been the kohn - sham ( ks ) method , which offers accuracy at reasonable computational cost",
    ".  @xcite orbital - free density functional theory ( ofdft ) is another calculation scheme that in principle offers better scaling , but has not been the focus of intense research thus far . in ofdft theory ,",
    "only functionals that are explicitly dependent on the total density are used , making it theoretically capable of scaling to much larger systems than ks .",
    "the solution of the ofdft problem can also be cast in a form which is easy to implement reusing existing ks codes .",
    "@xcite within this approach , one solves a ks - like differential equation for only one orbital describing the full system .",
    "in addition , when only one orbital is present in a ks - like calculation , it is also possible to achieve better performance in orthonormalization and subspace diagonalization , the computational bottlenecks of current ks dft codes .",
    "both steps scale in a real - space code with state - of - the - art algorithms , for example , as @xmath0 , where @xmath1 is the number of electronic bands ( a number that scales as the number of atoms in the system ) and @xmath2 is the number of grid points ( a number that scales as the volume of the simulation cell ) in the calculation .",
    "@xcite thus , when using the orbital - free model , we greatly reduce the computational time of these operations by fixing @xmath1 to a number that is independent of the system size . moreover , when removing the dependence on the number of bands , the scaling of the overall calculation depends on the number of grid points and the number of atoms . among the contributions to the overall time scaling arising from the different algorithms employed ,",
    "the highest - order dependence with the number of grid points or number of atoms is first order .",
    "ofdft can then be implemented as a linear scaling method in a real - space ks dft code like gpaw  @xcite .",
    "because of the difficulties in convergence and implementation , all - electron implementations of ofdft have only been used to derive the energies of small systems , such as atoms and dimers .",
    "on the other hand , ofdft codes for studying solids rely on the use of local pseudopotentials ( lpps ) .",
    "the derivation of such pseudopotentials requires a parameter fitting , and it has been a common choice to fit the lpps to reproduce experimental or ks bulk quantities such as the lattice parameter , bulk modulus or electronic density profile .",
    "@xcite ofdft simulations with pseudopotentials have been applied successfully to the study , for example , of the fracture propagation in bulk aluminum or the structure factor of warm dense matter .",
    "@xcite    as a generalization of pseudopotentials and the linear - augmented - plane wave method the projector - augmented wave ( paw ) method has been proposed as a method that allows the calculation of all - electron values with high accuracy and efficiency  @xcite .",
    "an _ all - electron method _ , refers to methods that solve the schrdinger equation for an electronic system directly in the presence of the @xmath3 non - modified nuclear potential and _ all - electron values _ are those values that would be obtained with all - electron methods . in the dft context , it is standard to term all - electron methods also methods that calculate all - electron values with the use of transformed equations . in this work",
    ", we refer to both types of all - electron methods ; but to avoid any confusion , the expression _ all - electron method _ will refer only to the methods using a non - modified nuclear potential . when referring to the paw method , we will consistently refer to it as a method obtaining _ all - electron values_. the paw method works by providing an exact transformation between conveniently smooth pseudo - wave functions and the all - electron wave functions .",
    "the paw transformation provides thus access to all - electron densities , since it is always possible to reconstruct the all - electron wave functions from the pseudo - wave function . additionally to the paw transformation",
    ", it is also possible to use fixed core orbitals using the frozen core approximation .",
    "moreover , a reliable description over the whole periodic table with good transferability of paw potentials has been obtained  @xcite . as we will demonstrate in",
    "the following , using paw in ofdft allows the calculation of all - electron energies while also improving the convergence capabilities of the ofdft implementations reusing ks codes .",
    "all - electron values are needed to assess the performance of ofdft functionals and improve them towards better transferability and accuracy .",
    "the grid - based projector augmented - wave method  @xcite ( gpaw ) rises above others as a potential platform for ofdft .",
    "it provides all - electron accuracy , real - space grids and the projector augmented - wave ( paw ) formalism ,  @xcite which has proven itself as a viable method to obtain all - electron values .",
    "as it turns out , the use of the paw method also helps to stabilize some of the convergence problems observed earlier in similar ofdft calculations ( see ref .  ) . here",
    ", we present a novel ofdft implementation in gpaw that simultaneously preserves linear ofdft scaling , provides access to all - electron values , and offers improved convergence capabilities .",
    "the structure of the paper is as follows . after a general introduction to ofdft equations and paw transformation",
    ", we present results computed with an atomic all - electron code first and then with a real - space paw code .",
    "the atomic all - electron code is used in gpaw to generate the setups ( the object containing precomputed values that define the paw transformation ) . with the derived ofdft setups we calculate , using real - space and paw methods , binding energies of dimers .",
    "our paw binding energies agree in the mev range with binding energies from reference all - electron methods . with the ofdft setups we also compute properties of periodic systems ( lattice constant and bulk modulus ) .",
    "finally , we present some considerations on the performance of the ofdft implementation using gpaw .",
    "reusing a ks dft code can offer important advantages .",
    "currently , ks dft codes are developed by large communities of scientists working across many countries .",
    "optimization , bug fixes and state - of - the - art methods are implemented with a quality control that is guaranteed by peer testing and discussion through open forums .",
    "the present ofdft implementation will not only inherit the use of the highly performing algorithms but will also evolve naturally , being maintained and up - to - date with the evolution of the underlying ks dft code .",
    "our starting point is an exact differential equation for the density and its natural implementation into a ks code .",
    "@xcite it provides a schrdinger - like differential equation for a one - orbital model , where this orbital is the square root of the electronic density . in principle , this method can be applied for any explicit density functional .",
    "first , the system s total energy functional @xmath4 $ ] ( which can be approximate or exact ) is written , using atomic units , in the form @xmath5 = & \\int { \\text{d}}{\\textbf{r}}\\ , n^{1/2}\\left(-\\frac{1}{2}{\\nabla}^2\\right)n^{1/2 }   \\nonumber \\\\ & + g[n ] + \\int { \\text{d}}{\\textbf{r}}\\ , v({\\textbf{r } } ) \\ , n({\\textbf{r } } )   \\nonumber \\\\ & + \\frac{1}{2}\\int { \\text{d}}{\\textbf{r}}\\int { \\text{d}}{\\textbf{r } } ' \\ , n({\\textbf{r } } ) \\ , n({\\textbf{r } } ' ) \\ ,    @xmath6 is the electronic density .",
    "we immediately recognize the external potential @xmath7 in the third term and the hartree potential in the last term . here , @xmath8 $ ] is a universal functional that that subtracts the first fictitious kinetic energy term and adds the true kinetic energy of the system as well as many - body contributions to the interaction energy not contained in the last hartree term .",
    "the first term , which has the form of a single - particle kinetic energy , is an auxiliary quantity introduced with the purpose of expressing @xmath4 $ ] in a way that resembles the expression of the ks energy functional .",
    "this will facilitate the implementation of the ofdft expressions in pre - existing ks codes .",
    "more precisely , this first term in the energy functional is the kinetic energy of a wave function that equals the square root of the density @xmath9 .",
    "it happens to be equivalent to the von weizscker gradient correction term @xmath10=   \\frac{1}{8 } \\int { \\text{d}}\\mathbf{r } \\ , \\frac{\\left|{\\nabla}n({\\textbf{r } } ) \\right|^2}{n({\\textbf{r}})}$ ] ( ref .  ) .",
    "equals @xmath9 , @xmath11 $ ] in the above equation , the first equality is given by the divergence theorem .",
    "the surface integral associated with the divergence theorem , @xmath12 , can be easily shown to vanish : for finite systems @xmath13 as @xmath14 ; for periodic systems each infinitesimal contribution to the integral has an equivalent contribution of opposite sign because of the periodic boundary conditions .",
    "the second equality follows from the chain rule @xmath15 , which gives @xmath16 . ]",
    "the von weizscker term is also the exact kinetic energy for a spin - paired two electron non - interacting system , as both particles occupy the same orbital .",
    "one of the approximations available for @xmath8 $ ] , in an attempt to reproduce the kinetic energy description of the ks method , relies on introducing the pauli kinetic energy functional @xmath17 $ ] .",
    "this functional is given as the difference between the ks noninteracting kinetic energy functional and the von weizscker term , @xmath18 = t_s [ n ] - t_\\text{w } [ n]$ ] ( ref .  ) .",
    "including also the exchange - correlation functional @xmath19 $ ] , @xmath8 $ ] is simply @xmath20 = t_{\\theta } [ n ] + e_\\text{xc } [ n].\\end{aligned}\\ ] ] since the exact ks noninteracting kinetic energy functional involves explicit orbitals , an orbital - free implementation of eq .  ( [ g_levy ] ) must rely on finding a suitable approximation for @xmath17 $ ] as a functional of the total density alone .",
    "several exact requirements ( such as positivity ) have already been demonstrated for this term .",
    "@xcite violation of these conditions have also been associated with ofdft functionals convergence problems .",
    "@xcite    the ground - state density minimizing @xmath4 $ ] is given by the variational principle under the constraint @xmath21 , where @xmath22 is the number of electrons in the system .",
    "then @xmath23 from an euler - lagrange equation is expanded , yielding @xmath24}{\\delta n } \\nonumber \\\\ = & n^{-1/2 } \\left ( -\\frac{1}{2 } { \\nabla}^2 \\right ) n^{1/2 } + v_\\text{eff}({\\textbf{r } } ) = \\mu,\\end{aligned}\\ ] ] where @xmath25 is the negative of the ionization energy ,  @xcite and the hartree and @xmath8 $ ] terms have been pushed into @xmath26 .",
    "both sides are multiplied by @xmath9 , giving a schrdinger - like equation : @xmath27 where terms on the left side can be interpreted as the effective hamiltonian .",
    "one ofdft energy functional we will reference in this work is the so - called tfd-@xmath28w model .",
    "@xcite it contains the thomas - fermi kinetic energy @xcite , the dirac exchange @xcite , and a fraction of the von weizscker kinetic energy functional . in terms of the previous partitioning  ,",
    "the model is obtained by defining @xmath29 = & c_\\text{f } \\int { \\text{d}}{\\textbf{r}}\\ , n^{5/3 }   \\nonumber \\\\ & + \\left(\\lambda - 1 \\right ) \\int { \\text{d}}{\\textbf{r}}\\ , n^{1/2 } \\left ( -\\frac{1}{2 } { \\nabla}\\right ) n^{1/2 } , \\\\ e_\\text{xc } [ n ] = & c_\\text{x } \\int { \\text{d}}{\\textbf{r}}\\ , n^{4/3},\\end{aligned}\\ ] ] with @xmath30 and @xmath31 . for the tfd-@xmath28w model",
    "when @xmath28 takes smaller values such as @xmath32 or @xmath33 , convergence problems appear and the von weizscker term in @xmath34 has been determined to be the root of the problem ( see ref .   for a review ) . here",
    "we are removing those convergence problems by rearranging to @xmath35 where the derivative of the von weizscker term in @xmath18 $ ] is summed back to the kinetic energy operator",
    ". then both sides are divided by @xmath28 to get to equation @xmath36 the implementation is quite straightforward . divide the potential @xmath37 by @xmath28 after it is calculated .",
    "then , after convergence has been achieved , multiply the eigenvalue @xmath38 by @xmath28 to get the correct eigenvalue and energies .",
    "this equation converged for @xmath28 values @xmath32 and @xmath33 for the systems shown in table  [ tab : ae_atom ] .",
    "an attractive trait about the paw method @xcite is that it is a method that gives access to all - electron values .",
    "the method transforms the wave functions into pseudo wave functions with a smooth and therefore more convenient spacial behavior . to obtain the all - electron wave function @xmath39 from a smooth wave function @xmath40 ( @xmath41 is the state index ) ,",
    "we seek a linear transformation @xmath42    the transformation operator is divided into atom - centered transformations which each has effect only inside one augmentation region .",
    "atom - centered transformations are defined by atomic setups which contain the quantities related to a single atom , that is , smooth quantities for grid calculations and the unmodified atom quantities to define the transformation operator .",
    "each element has to have its own atomic setup . inside the augmentation sphere",
    ", the all - electron wave function can be expanded in atom - like partial waves basis @xmath43 ( @xmath44 is a combination index for the principal , angular momentum , and magnetic quantum numbers respectively @xmath45 ) .",
    "the index @xmath46 indicates to which augmentation region the operator acts on .",
    "then we define a set of auxiliary wave functions @xmath47 that are smooth everywhere and match the atom - like partial waves at the augmentation sphere s boundary . finally , we define linear projector functions @xmath48 as zero outside the augmentation sphere and satisfying the completeness relation @xmath49 in terms of the atom - like partial waves functions , the partial pseudo wave functions , and the projectors , the transformation is written as @xmath50 the form of the schrdinger equation within the paw context is @xmath51 where @xmath52 is the transformed hamiltonian and @xmath53 is the overlap operator . in summary , the all - electron wave - function ,",
    "is obtained from the transformation where the pseudo wave functions are obtained solving the eigenvalue equation . for details on combining paw with the ksdft method in the frozen core approximation",
    "see refs . .",
    "the convenience of formulating equation in the paw formalism is two fold .",
    "first , paw reproduces all - electron values offering freedom in adjusting the convergence parameters and the atomic setups allow tuning the numerical accuracy per element .",
    "second , the paw method could provide answers to some of the convergence problems experienced by other ofdft implementations that make use of ks codes .",
    "we have implemented the scheme in the open - source gpaw software ,  @xcite which is basically paw with real space grids and exchange and correlation functionals from libxc ( ref .  ) .",
    "implementation in this setting gives various advantages .",
    "gpaw itself is well written and community maintained with an active user base .",
    "a parallelization scaling almost ideally is available and we can use all of the functionals provided by libxc , including future updates .",
    "implementation consists of two major parts .",
    "first , we need to generate suitable orbital - free setups and then ensure that they are loaded correctly to gpaw .",
    "next , we force the occupation of electronic bands so that only one band gets occupied .",
    "[ cols=\"<,^,^,^,^,^,^,^\",options=\"header \" , ]     [ tab : iterations ]",
    "this work demonstrates that the paw method , in combination with ks codes , can reproduce all - electron ofdft energies of atoms and dimers without convergence problems .",
    "indeed , the paw calculation converges in a number of self - consistent steps comparable to the ks method .",
    "this combination of methods offers a promising route for reaching easy - to - converge large - scale ofdft calculations .",
    "moreover , when testing the accuracy of ofdft kinetic functionals , a method such as the one presented here becomes necessary .",
    "before this work can be extended to large - scale simulations , the exact relation between the setup cutoff and the resulting energy accuracy for real - space parameters must be studied for the elements involved .",
    "it is important to determine the minimum number of self - consistent iterations that can be reached once the target accuracy is defined . with the present knowledge , an increase in size of the same system requires fine tuning of simulation parameters to achieve convergence .    interestingly , with the simplest kinetic approximation for diamond",
    ", we obtained a lattice constant and bulk modulus comparable to the paw ks pbe values .",
    "this begs the question , then , to what extent such simplicity can be maintained when choosing the building blocks of more accurate and transferable kinetic functionals .",
    "we hope this work will contribute to the development of better ofdft functionals by allowing access to all - electron energy values of periodic and non - periodic systems .",
    "26ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1103/physrev.136.b864 [ * * , ( ) ] link:\\doibase 10.1103/physrev.140.a1133 [ * * , ( ) ] link:\\doibase 10.1103/physreva.30.2745 [ * * ,   ( ) ] link:\\doibase 10.1002/cpe.3199 [ ( ) ,",
    "10.1002/cpe.3199 ] http://books.google.fi/books?id=mgopscsiwu4c[__ ] ,  international series of monographs on chemistry  ( ,  ) \\doibase http://dx.doi.org/10.1016/j.cpc.2012.06.016 [ * * ,   ( ) ] link:\\doibase 10.1016/j.cossms.2008.06.005 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.111.175002 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.50.17953 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.71.035109 [ * * ,   ( ) ] link:\\doibase 10.1007/bf01337700 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.38.625 [ * * ,   ( ) ] link:\\doibase 10.1007/s10820 - 006 - 9019 - 8 [ * * , ( ) ] link:\\doibase 10.1017/s0305004100011683 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * , ( ) \\doibase http://dx.doi.org/10.1016/j.cpc.2012.05.007 [ * * ,   ( ) ] _ _ ,  @noop master s thesis ,   ( ) ,   link:\\doibase 10.1063/1.1321308 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.75.115131 [ * * ,   ( ) ] link:\\doibase 10.1109/5992.998641 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.77.3865 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.86.056704 [ * * ,   ( ) ] @noop _ _  ( ,  ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we present a computational scheme for orbital - free density functional theory ( ofdft ) that simultaneously provides access to all - electron values and preserves the ofdft linear scaling as a function of the system size . using the projector augmented - wave method ( paw ) in combination with real - space methods we overcome some obstacles faced by other available implementation schemes . specifically , the advantages of using the paw method are two fold . </S>",
    "<S> first , paw reproduces all - electron values offering freedom in adjusting the convergence parameters and the atomic setups allow tuning the numerical accuracy per element . </S>",
    "<S> second , paw can provide a solution to some of the convergence problems exhibited in other ofdft implementations based on kohn - sham codes . using paw and real - space methods , </S>",
    "<S> our orbital - free results agree with the reference all - electron values with a mean absolute error of 10  mev and the number of iterations required by the self - consistent cycle is comparable to the ks method . </S>",
    "<S> the comparison of all - electron and pseudopotential bulk modulus and lattice constant reveal an enormous difference , demonstrating that in order to assess the performance of ofdft functionals it is necessary to use implementations that obtain all - electron values . </S>",
    "<S> the proposed combination of methods is the most promising route currently available . </S>",
    "<S> we finally show that a parametrized kinetic energy functional can give lattice constants and bulk moduli comparable in accuracy to those obtained by the ks pbe method , exemplified with the case of diamond . </S>"
  ]
}