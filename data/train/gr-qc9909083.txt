{
  "article_text": [
    "there are many situations of interest in which data are contaminated by the environment",
    ". often this contamination is understood , and by monitoring the environment it is possible to  clean up \" or  reduce \" the data , by subtracting the effects of the environment from the signal or signals of interest .",
    "examples include measurements of the earth s magnetic field contaminated by harmonics of @xmath6 , or a telephone conversation carried on a transmission line , which has been corrupted by electro - magnetic cross - talk from nearby lines .",
    "the work in this paper was motivated by another example : the data stream from an interferometric gravitational radiation detector @xcite . in this instance , the signal of interest is the differential displacement of suspended test masses .",
    "a small part of this displacement arises from gravitational waves , but there are also large contributions arising from contaminating sources , such as the shaking of the optical tables ( seismic noise ) and forces due to ambient environmental magnetic fields . particularly at low frequencies , these types of ambient environmental noise are the fundamental effects limiting the sensitivity of the instrument @xcite .",
    "the key point here is that the gravitational waves are not correlated with any of these environmental artifacts .    in many such situations , it is possible to monitor the environment , offering the hope of removing from the signal of interest the contaminating effects of the environment . for the prototype gravitational wave detector used as an example in this paper @xcite ,",
    "about a dozen of these environmental signals were monitored , including components of the magnetic field , acoustic pressure , acceleration of the optical suspension , and so on @xcite .",
    "it is not hard to see that in many cases , these environmental fields add directly into the signal of interest , after convolution with some ( unknown ) response function . for example",
    "the suspension of the optical elements of the interferometer may be physically modeled by a coupled set of masses , springs , and frictional elements ( dashpots ) , and thus acts as a mechanical filtering device .",
    "the displacement of the ground is filtered through this suspension and the resulting displacement is added into the one arising from any gravitational waves . thus if the ground displacement were monitored , and if we knew the exact transfer function of the suspension , we could remove from the differential displacement signal the part due to ground motion .",
    "the difficulty here is that these transfer functions are not known , and can not be accurately calculated from first principles .",
    "for example the mechanical filters which isolate the suspension from the ground contain non - ideal springs , damping elements whose restoring forces are not proportional to velocity , and so on .",
    "it might in principle be possible to measure these transfer functions ( for example by shaking the ground in a controlled way ) but in many cases this is not practical .",
    "although our methods could be generalized to the case of continuous - in - time signals , we will assume from here on that all the signals are discretely sampled in time .",
    "we will assume that the raw data ( channels @xmath3 to @xmath0 ) are time series , sampled at regular intervals @xmath7 .",
    "we do _ not _ assume that these sample rates are the same for all the channels , so in particular @xmath8 will denote the sample rate of the @xmath2th channel .",
    "the @xmath9 ( assumed even ) different sample values of channel @xmath2 at regular time intervals will be denoted by @xmath10 we assume that each of the channels has been sampled over the entire time interval @xmath11 $ ] and thus that @xmath12 has the same invariant value for all channels @xmath13 . because the primary goal of our technique is to extract an approximation of the  true \" or  uncontaminated \" values of channel @xmath3 , we adopt a special notation for this channel , and use @xmath14 to denote the signal of interest .",
    "our methods assume that the contamination of channel 1 by the other channels is described by linear filters or transfer functions .",
    "the action of a linear filter ( convolution in the time domain ) is most simply represented in the frequency domain ( where it is just multiplication ) , and thus much of our work will take place in the frequency domain . the discrete fourier transforms ( dft ) of the channels",
    "will be denoted by @xmath15 the index @xmath16 labels frequency bins , and in particular the @xmath16th bin of channel @xmath2 corresponds to a frequency @xmath17 note that throughout this paper , the word _ band _",
    "is used to denote a collection of adjacent frequency _",
    "bins_. we assume that the raw signals ( channels ) are real values , i.e. that the @xmath18 are real , which implies that @xmath19 where ",
    "@xmath20 \" denotes complex conjugate .",
    "we begin by examining the case of only two channels .",
    "this is a good way to introduce the main ideas of the analysis and the principal techniques . in section  [ s : manychannels ]",
    "we generalize this method to the @xmath0-channel case .",
    "( 240,160)(10,0 ) ( 30,20 ) ( 30,140 ) ( 210,20 ) ( 210,140 ) ( 15,130)(30,20)[l]@xmath21 ( 15,10)(30,20)[l]@xmath22 ( 200,130)(30,20)[r]@xmath23 ( 200,10)(30,20)[r]@xmath24 ( 85,70)(25,20)@xmath25 ( 155,130)(30,20)@xmath26 ( 170,140 ) ( 35,140)(1,0)125 ( 35,20)(1,1)50 ( 110,90)(1,1)50 ( 35,20)(1,0)170 ( 180,140)(1,0)25    our model may be though of in terms of the diagram in figure [ f : twochannel ] .",
    "the output of the instrument , in other words , the actual sample values produced by the experiment , are denoted by @xmath23 and @xmath24 , in the notation introduced earlier .",
    "these values are to be thought of as  imperfect \" representations of some true values which are the variables that the experiment or instrument is attempting to measure .",
    "however the actual instrumental outputs are not exactly equal to these values , because they have been contaminated by the environment .",
    "we denote the true value which the instrument is attempting to measure by @xmath21 , and the actual output of the instrument by @xmath23 . in the two - channel case ,",
    "the environmental monitor channel is denoted by @xmath24 ; without loss of generality we may assume that it is equal to the actual value of some environmental variable @xmath22 .    in our model ,",
    "we assume that the true value @xmath21 of the desired signal is not present at the output , because it is contaminated by the environment .",
    "we assume that this contamination may be represented by a linear filter applied to the environmental variable @xmath22 .",
    "for example , suppose that @xmath21 is the temperature of a sample of material ( if that material is surrounded by a constant temperature environment ) but in fact the temperature of the environment @xmath24 is not constant , and varies with time .",
    "the influence of the environment on the measured temperature @xmath23 of the sample is complicated by the fact that the heat from the environment must diffuse through a thermal insulator before reaching the sample , so that a change in the temperature of the environment is not immediately reflected in a change in the temperature of the sample . in this example",
    ", the effect of the environment on the sample temperature may be modeled by a first - order linear filter , whose impulse response decays exponentially in a thermal diffusion time .    in the example that served to motivate this paper ,",
    "the desired signal is the difference @xmath21 in optical phase between two paths of a suspended interferometer produced by gravitational waves .",
    "however the instrument contains steering magnets , which are sensitive to the ambient magnetic fields in the laboratory : these magnetic fields result in forces on the optical elements which also change the optical phase .",
    "assuming that the geometry of the laboratory and of the instrument ( which serves to convert magnetic fields into magnetic gradients ) is not changing with time , one would expect to find a linear filter relationship between some component of the laboratory magnetic field and the output @xmath23 of the relative optical phase channel .",
    "similar effect arise from seismic motion and from other sources .",
    "the basic idea of our method is to estimate the transfer functions @xmath5 .",
    "this is most easily illustrated in the two - channel case .",
    "the situation of interest is one in which the transfer function does not change with time , or changes slowly with time .",
    "this is the case if it is defined by spring constants ( i.e. mechanical coupling ) or mutual inductances ( electrical cross - talk ) or other quantities that depend upon geometrical and mechanical properties which change slowly ( adiabatically ) with time .    to estimate",
    "the transfer function requires an averaging process .",
    "it might seem natural to average in time , but the calculations are easier to understand and express if the averaging is carried out in frequency space instead .",
    "for this reason , we imagine that the frequency space occupied by our signal ( which for the @xmath2th channel is @xmath27 ) is broken up into subspaces that span frequency bands . to introduce the notation , we first consider the channel of interest , @xmath23 . for future convenience",
    "we will assume that the nyquist frequency bin @xmath28 does not contain any useful information ( i.e. that an anti - aliasing filter was used in taking the data ) and that we can project our signal onto the @xmath29 dimensional subspace that does not include this frequency bin .",
    "for notational purposes , write this frequency - space representation as the vector @xmath30 \\\\ \\nonumber                    & = & \\left [ { \\tilde { \\bf x}^{(0 ) } } , \\cdots , { \\tilde                    { \\bf x}^{(b_1 - 1 ) } }   \\right]\\end{aligned}\\ ] ] where we have decomposed the @xmath31 into a set of @xmath32 orthogonal vector spaces , each of which contains only the frequencies in a particular band @xmath33 .",
    "the number of individual frequency  bins \" contained in one of the frequency bands is ( the dimensionless integer ) @xmath34 , and @xmath35 for @xmath13 .",
    "the number of frequency bands @xmath36 _ does _ depend upon the channel number ( or sample rate ) but the number of bins @xmath34 in a given band does not .",
    "thus , the vector @xmath37 $ ] . in general , the vector associated with frequency band @xmath38 consists of @xmath39 $ ] .",
    "the frequency band labeled by the dimensionless index @xmath38 spans a range of physical frequency @xmath40 ( in cycles / unit - time ) given by the half - open interval @xmath41 later , we will discuss how we choose the number of frequency bands .",
    "this is related to the question of how much averaging is needed to accurately estimate the transfer functions .",
    "this notation generalizes in the obvious way to the other channels @xmath42 .",
    "note that the number of real degrees of freedom of the @xmath2th channel is @xmath9 .",
    "the complex coefficients @xmath43 for @xmath44 contain @xmath45 of those real degrees of freedom .",
    "the coefficients @xmath46 and @xmath47 are both real and contain the remaining two real degrees of freedom . as before ( with no significant loss of generality ) we will assume that @xmath47 is zero , because an anti - aliasing filter has eliminated any signal contributions near the nyquist frequency .    to express the correlation between two channels ( or the auto - correlation of a channel with itself ) it is useful to introduce a bi - linear inner product .",
    "this is defined by @xmath48 this is just the ordinary cartesian inner product between the two vectors , after they have been projected into the subspace spanned by the @xmath38th frequency band .",
    "the quantity @xmath49 is the power spectrum of channel @xmath23 , summed over the @xmath38th frequency band : the total power in the @xmath38th frequency band .",
    "notice that the inner product is _ only _ defined if both channels @xmath50 and @xmath51 are sampled quickly enough so that both of them extend up to the @xmath38th frequency band .",
    "if the frequency band lies above the nyquist frequency of either channel , the inner product is not defined .",
    "note also that we could define another inner product , which is the ordinary cartesian one ( with no projection ) by summing @xmath52 over the range @xmath53 , but this is used so little that it s not worth the trouble .",
    "we are now prepared to estimate the transfer function @xmath54 shown in figure  [ f : twochannel ] .",
    "our goal in doing this is to estimate the  true \" channel of interest @xmath21 .",
    "we denote the estimate of this quantity with an overbar : @xmath55 .",
    "we also use the overbar to denote our estimates of derived quantities , for example @xmath56 .",
    "we assume that @xmath54 is _ complex constant _ within each frequency band @xmath38 , in other words that the transfer function does not vary rapidly over the frequency bandwidth @xmath57 . for notational convenience ,",
    "let us denote the constant value of @xmath58 in a given frequency band by @xmath59 .",
    "given the transfer function @xmath59 within the frequency band , our estimate of the fourier transform of the  true \" channel of interest is @xmath60 * we assume that the best estimate of the transfer function in the frequency band @xmath38 is the one that minimizes the norm @xmath61 .",
    "* notice that although the vector @xmath62 contains @xmath34 components , our estimated transfer function @xmath59 is a single complex number , containing in practice many fewer degrees of freedom than @xmath62 . in this way",
    ", the value of the transfer function averages over the different frequency bins within the band @xmath38 , and thus corresponds to a time average .    to find @xmath59",
    "we minimize the norm @xmath63 . under an arbitrary variation @xmath64",
    "one has @xmath65,\\end{aligned}\\ ] ] where  cc \" denotes the complex conjugate of the previous term . in order that @xmath66 vanish for all choices of the complex number @xmath64 the inner product appearing on the final line must vanish : @xmath67 the unique solution to this equation",
    "gives our best estimate of the transfer function @xmath54 in the frequency band @xmath38 as : @xmath68 we note that instead of minimizing the inner product of our estimate of the true channel of interest independently within each given frequency band @xmath38 , we could also have minimized the inner product defined as a sum over all @xmath69 frequency bins ; this gives the same result since vectors obtained by projection onto orthogonal subspaces ( corresponding to different frequency bands ) have zero inner product .",
    "how effective is this procedure likely to be ?",
    "clearly , this depends upon how much contamination there is , in the channel of interest , and upon how well the different environmental signals monitor the different sources of contamination . in order to quantify these effects ,",
    "it is useful to introduce the _ covariance coefficient _ between channels @xmath70 and @xmath71 in frequency band @xmath38 , which is defined by @xmath72 from the definition it follows that @xmath73 .",
    "this quantity may be interpreted as the ( absolute value of ) the cosine of the angle between the vectors representing the @xmath70th and @xmath71th channels .",
    "when @xmath74 is close to unity this means that the @xmath70th and @xmath71th channels are very correlated or anticorrelated ; when close to zero this means that there is no statistically significant ( anti)correlation .",
    "the question  how large a @xmath74 is statistically significant \" will be addressed in section  [ s : uncorrelated ] .",
    "the covariance coefficients @xmath75 between the ifo channel ( @xmath76 ) and the other 11 environmental channels @xmath77 are shown in figure  [ f : correlation ] .",
    "there are a number of interesting features in the graph of @xmath75 that are worth brief comment .    *",
    "the magnetometer output shows beautifully strong correlation with the ifo_dmro at all multiples of the line frequency of @xmath78 hz .",
    "the large ambient magnetic fields in the laboratory are probably being produced by motors in the ventilation system and transformers in the argon laser power supply .",
    "* the correlations between the microphone and the ifo_dmro may reflect mechanical resonances in the mechanical suspension and isolation systems which are driven by ambient acoustic noise . *",
    "the dc strain is a low - pass filtered version of the ifo_dmro channel of interest : channel @xmath23 !",
    "so in fact it has excellent low - frequency correlation with the ifo_dmro channel because these are measuring essentially the same thing .",
    "note that this channel will be left out of the decontamination procedure that we describe , since that procedure is intended only for signals that should not show any intrinsic correlation with the true quantity of interest . *",
    "the mode cleaner correlation is easy to understand .",
    "it occurs because the mode cleaner removes most but not all of the laser frequency noise .",
    "the remaining frequency noise is converted by the interferometer into an effective change in the arm length . *",
    "the seismometer shows interesting and significant low - frequency correlation with the ifo_dmro .",
    "the mechanical suspension does not entirely isolate the instrument from ground motions , and these are subsequently converted into motions of the suspended masses .",
    "these low - frequency correlations are precisely the sort of correlations that will be removed by the procedure described in this paper .",
    "* the arm 2 visibility and the slow pzt show almost identical correlations with the ifo_dmro channel .",
    "we do not understand why .",
    "* the arm 1 coil driver shows very clear low - frequency correlations with the ifo_dmro .",
    "these may be related to the previously - described correlation between the mode cleaner and the ifo_dmro .",
    "a technique for simultaneous removal of all of these correlations from the ifo_dmro is described in section  [ s : nchannels ] , but for the moment we return to the simplest , two - channel case .    in the two - channel case ,",
    "the transfer function in frequency band @xmath38 was estimated by minimizing the norm @xmath79 .",
    "this led to a unique solution for the estimated transfer function @xmath59 , given by ( [ e : estimatedr ] ) .",
    "how much is the norm @xmath0 reduced when compared with the corresponding norm of the original channel of interest @xmath80 before any correlations were removed ?",
    "this may be found by substituting the value of @xmath59 ( [ e : estimatedr ] ) into the definition of @xmath0 .",
    "one obtains @xmath81 \\\\ & = & \\left ( \\tilde { \\bf x}^{(b ) } , \\tilde { \\bf x}^{(b ) } \\right ) \\left[1-\\left ( \\rho_{12}^{(b ) } \\right)^2\\right].\\end{aligned}\\ ] ] the fractional reduction in the norm @xmath0 is @xmath82 .",
    "thus , if an environmental channel is strongly correlated with the channel of interest , a significant reduction in the norm is obtained . as discussed",
    "following equation ( [ e : normdef ] ) this is may be though of as a reduction in the total power in the @xmath38th frequency band .",
    "our example ( including figure  [ f : correlation ] ) is based on data from the caltech 40-meter prototype gravitational wave interferometer @xcite . during one week in november 1994",
    ", this instrument was used to collect data for later analysis . between eleven and fourteen channels of data were collected .",
    "the channel of interest @xmath23 is the interferometer differential mode read - out ( ifo_dmro ) and the other sampled channels consist of environmental and instrumental monitors .",
    "the channels were sampled at either @xmath83 hz ( fast channels ) or at one - tenth that rate ( slow channels ) .    in our first example",
    ", we consider only two channels : @xmath76 is the ifo_dmro and @xmath24 is ifo_mag_x .",
    "this is the @xmath84component of the magnetic field sampled near one of the optical elements denoted .",
    "both of these signals are sampled at the fast rate .",
    "we used @xmath85 samples from the 18 november 1994 run 1 data set , spanning approximately 266 seconds . to carry out the averaging we choose @xmath86 frequency bins in each of @xmath87 frequency bands .",
    "this is the same data set whose correlations with the ifo_dmro are illustrated in figure  [ f : correlation ] .",
    "there is particular reason to believe that the ifo_dmro is strongly contaminated by ambient magnetic field noise ( or by signals which are correlated to that ) .",
    "this is because the optical elements of the interferometer suspension are steered and controlled by magnetic forces .",
    "many of the optical elements have magnets fastened to them , and small coils are used to provide some of the servo feedback used to maintain the optical resonance of the interferometer .",
    "the laboratory magnetic fields arise from a number of sources , including motors which are part of the air - circulation systems in the laboratory , and power - mains and power - supply wiring such as the three - phase current driving the argon - laser power supply .",
    "it is also possible that ripple from the power supplies is present in the servo loops whose error outputs are the source of the ifo_dmro signal .",
    "figure [ f : timedomain ] shows the two channels @xmath23 and @xmath24 for 266 seconds . because our primary goal is to remove low - frequency ( @xmath88  hz ) contamination from @xmath23 ,",
    "these channels have been low - pass filtered by ( 1 ) transforming into the frequency domain ( 2 ) setting to zero all spectral amplitudes at frequencies @xmath89 then ( 3 ) transforming back into the time - domain .",
    "although it is not obvious from the graphs , both channels contain strong sinusoidal components at multiples of the line frequency 60 hz .",
    "notice that the rms value of channel @xmath23 is about 30 adc counts . also notice that the small instrumental feature ( blip ) around @xmath90  sec is almost obscured by the surrounding  hash \" .",
    "the fourier transforms of these two channels are shown in figure  [ f : freqdomain ] .    using the procedure that we have described",
    ", we can estimate the coupling @xmath91 between these two channels .",
    "this is shown in figure  [ f : coupling ] .    in each frequency band , the estimate of @xmath25 is a sum over the @xmath86 different frequency bins contained in that band . if there is no correlation between the two channels , the expected value of this sum behaves like a random walk , accumulating proportional to @xmath92 .",
    "( the case where there is no correlation is considered in detail in section  [ s : uncorrelated ] . ) in frequency bands where the two channels are correlated , the expected value of the sum accumulates proportional to @xmath34 .",
    "the final result , figure  [ f : cleaned ] shows the estimated  true \" value of the ifo differential mode output channel , after subtracting the estimated crosstalk .",
    "in section  [ s : twochannel ] we showed how it is possible to obtain an estimate of the coupling between two channels , by searching for the linear combination ( in frequency space ) that minimizes the variance of the channel of interest . in this section",
    ", we generalize this method to the @xmath0-channel case , where in addition to the channel of interest , there are @xmath93 additional environmental monitoring channels .",
    "the basic idea is identical .",
    "we estimate the  true \" value of the channel of interest as : @xmath94 here the @xmath95 are a set of @xmath93 coupling constants : they are our estimates of the contribution that the channel @xmath96 makes to the channel of interest @xmath23 in the frequency band @xmath38 . as before ,",
    "we choose these coupling constants in the way that minimizes the total power in the channel of interest , assuming that they are constant throughout the @xmath38th frequency band .",
    "this means that we choose the @xmath95 in order to minimize the expected value of the norm @xmath63 , under an arbitrary variation @xmath97 .",
    "@xmath98.\\end{aligned}\\ ] ] in order for this quantity to vanish under all variations of the @xmath93 coupling constants @xmath99 one must satisfy @xmath93 equations ( for @xmath100 : @xmath101 this may be conveniently written in matrix / vector form . to do so , define the _ correlation matrix estimate in the @xmath38th channel _ :",
    "@xmath102 this matrix @xmath103 is hermitian and positive semi - definite .",
    "notice that the entries of this correlation matrix are defined for @xmath104 since by definition the channel of interest @xmath105 .",
    "this means that  intrinsically \" @xmath106 is a square @xmath107 matrix .",
    "the equations satisfied by the coefficients ( [ e : reqns ] ) may now be written as @xmath108 notice that the left hand side is determined by the correlations between the channel of interest and the environmental channels .",
    "the matrix that appears on the right hand side is determined by the correlation between the different environmental channels . in the case where these are not correlated ( i.e.",
    ", a given environmental channel is only correlated with itself ) then the matrix on the right hand side is diagonal , and the situation is very similar to the two - channel case .    if all of the channels are non - zero in at least one bin in frequency band @xmath38 then the matrix is hermitian and positive definite , so that it may be inverted .",
    "we denote the inverse of this matrix by the symbol @xmath109 . note : this is _ not _ the inverse of an @xmath107 matrix .",
    "it is the inverse of the @xmath110 matrix defined by ( [ e : matrixdef ] ) for @xmath111 .",
    "the coupling constants that minimize the variance in the channel of interest are now given by : @xmath112 although it is tempting to interpret this equation as  inverse of a matrix times the matrix \" and replace the rhs by @xmath113 this is not correct , because @xmath109 is the inverse of an @xmath114 matrix .",
    "it is again possible to ask how much the norm @xmath0 is reduced when compared with the corresponding norm of the original channel of interest @xmath80 before any correlations were removed .",
    "this may be found by substituting the value of @xmath59 ( [ e : estimatedr ] ) into the definition of @xmath0 .",
    "one obtains @xmath115.\\end{aligned}\\ ] ] where the second line follows from eq .",
    "[ e : reqns ] and we have defined @xmath116 the second form expresses @xmath117 in manifestly positive definite form , while from its definition it is always less than or equal to 1 . the quantity @xmath117 provides a useful measure of the total improvement in the signal . to understand which environmental channels led to this improvement one may study the @xmath93 pairwise covariance coefficients @xmath118 .",
    "our @xmath0-channel example is based on the same 18 november 1994 run 1 data from the caltech 40-meter prototype gravitational wave interferometer @xcite that was used in the previous 2-channel example in section  [ s : twochanex ] .",
    "as before , the channel of interest @xmath23 is the interferometer differential mode read - out ( ifo_dmro ) and the other 11 sampled channels consist of environmental and instrumental monitors .",
    "three of the channels ( including ifo_dmro ) were sampled at the fast rate of @xmath83 hz and the other nine were sampled at exactly one - tenth that rate .",
    "the different channels are shown in table  [ t : channels ] .",
    "the covariance coefficients @xmath119 between these channels and the ifo_dmro channel were previously shown in figure  [ f : correlation ] .",
    ".channel assignments for the november 1994 data runs .",
    "channels 0 - 3 are the  fast \" channels , sampled at about 10 khz ; the remaining twelve are the  slow \" channels , sampled at about 1khz .",
    "note that the power stabilizer channel was accidentally disconnected until approximately 20:00 local time and so was not used by us , and that some channel numbers were not present in the data .",
    "[ cols=\"<,<,<\",options=\"header \" , ]     [ t : channels ]    as before , we used the first @xmath120 samples from the data set , covering about 266 seconds .",
    "as before , to carry out the averaging we choose @xmath86 frequency bins in each of @xmath87 frequency bands . because the dc strain channel is effectively just a low - pass filtered version of the ifo_dmro channel , it was left out of the removal process .",
    "the result of this procedure is shown in figure  [ f : cleaned2 ] .",
    "it is very useful to compare this with the previous 2-channel case , where we removed only contamination that was correlated with the magnetometer channel . in comparison to this previous case ,",
    "the following features are evident :    * the  end effects \" that are apparent in the two channel case ( figure  [ f : cleaned ] ) are no longer present : these were not end effects but contamination of the ifo_dmro channel by an interfering signal .",
    "* comparison of the power spectra ( figures  [ f : freqdomain],[f : cleaned],[f : cleaned2 ] ) in the region below 60 hz shows that a significant reduction in low - frequency content has been obtained . *",
    "the time - domain properties of the estimated detector noise are now _ more _ uniform , rather than less uniform .",
    "this is good evidence that the signal content which is being removed is in fact a true correlated signal and not merely an artifact of the subtraction procedure described here .",
    "when we began this work , our original intent had been to carry out a procedure similar to the one just described . however that procedure failed , for reasons that are interesting , and are worth explaining here .    the procedure which failed",
    "can be summarized as follows :    * take long stretches of data from each of the @xmath0 channels , spanning a time interval of length @xmath121 . *",
    "cut them into @xmath122 short segments of length @xmath123 ( say , one second long ) .",
    "* transform these into the frequency domain .",
    "* for each short segment , and in each frequency bin , calculate an @xmath124 matrix containing the products of the fourier amplitudes of the different channels .",
    "* in each frequency bin , average the @xmath122 matrices thus obtained to get an estimate of the correlation matrix . *",
    "use this correlation matrix to estimate the transfer function @xmath125 that minimizes the total power in each frequency band .",
    "the reason why this procedure failed is not hard to understand .",
    "one might expect that in this procedure , since the length of each segment in the time - domain is @xmath123 , the frequency - resolution of this method is @xmath126 .",
    "thus , for example , the line - frequency harmonics appearing at multiples of @xmath6 might be expected to be resolved within a band about @xmath127 about their true locations .",
    "this is correct .",
    "the problem occurs because in many instances , these line - like features in the frequency domain have _ much _ larger amplitude ( by orders of magnitude ) than the neighboring frequency bins .",
    "in addition , these line - like features do not lie precisely at the center of a frequency bin ( in the time domain , the corresponding sinusoids do not undergo an integer number of oscillations during the time - interval @xmath123 ) .",
    "consequently , these line - like features exhibit sidelobes of the windowing function . in the method that we have described ,",
    "this windowing function is rectangular ( on or off ) but even if a more sophisticated and smoothly - varying window function is chosen , the sidelobes are still present .",
    "these sidelobes are much smaller than the central maximum , and depending upon the choice of window function , they fall off as some ( inverse ) power of the separation in frequency bins from the central line . since the energy in the central line is so large compared with neighboring frequencies , these sidelobes , while insignificant compared with the central line feature , are still large enough to completely dominate the signals at neighboring frequencies",
    "consequently , one finds that there are large correlations arising from the central line - like features , extending out over a range of frequencies that is quite large compared to @xmath128 . in many of the instances which we examined ,",
    "these correlated sidelobes dominate the true correlation out to @xmath129 .",
    "this is shown in figure  [ f : correlatedsidelobes ] .",
    "the failure of this other method may be easily summarized as follows .",
    "although the energy arising from a sinusoidal signal present in several channels is largely confined to a ( small ) bandwidth @xmath130 , the correlation arising from this signal can dominate the correlation over a bandwidth which is fifty times larger !",
    "the resulting loss in frequency resolution is unacceptable .",
    "for this reason , we do nt use ( or recommend ! ) this method for estimating the correlations between different channels .",
    "the methods that we have described for removing environmental contamination or crosstalk from signals of interest assumes that there is no correlation between the environmental monitors and the signal of interest , and thus that any correlation which _ is _ found is due to  leakage \" or  crosstalk \" in the instrument .",
    "if this assumption is satisfied , one might well ask ,  is there a danger of falsely removing correlations which do not in fact exist in the observed signals ? \" to quantify this requires that we make assumptions about the statistics of any uncorrelated signals .",
    "suppose that we consider the case where the @xmath0 channels are independent uncorrelated gaussian random variables , with a white power spectrum . for simplicity",
    "let us also assume that each has zero mean value and unit variance .",
    "this is a situation where a good technique for removal of correlated noise from the channel of interest should do absolutely nothing , since there is no correlation to remove !",
    "how does the technique described here perform in this situation ?    for simplicity , consider first the two - channel case of section  [ s : twochannel ] .",
    "suppose that the signal values @xmath131 and @xmath132 are independent gaussian random variables with mean value zero and unit variance . in this case , the fourier amplitudes @xmath133 and @xmath134 are also independent gaussian random variables",
    ". the estimated transfer function ( [ e : estimatedr ] ) for a particular frequency band has mean value zero .",
    "the expectation value of its square is given by @xmath135 the calculation of the last quantity is slightly complicated and may be found in appendix  [ s : rho ] . here , we approximate it in the case where the frequency band @xmath136 contains many frequency bins .",
    "since the number of frequency bins in the @xmath38th frequency band is denoted by @xmath34 , we will assume that @xmath137",
    ". in this case one obtains @xmath138 because the estimated transfer function @xmath139 and the covariance @xmath140 are related by @xmath141 our simple example of two uncorrelated channels would have the expectation value of @xmath142 in each frequency band equal to @xmath143 .",
    "thus , on the average , blind application of our method would reduce the variance of the channel of interest by the fraction @xmath144\\\\ & = &    \\left ( \\tilde { \\bf x}^{(b ) } , \\tilde { \\bf x}^{(b ) } \\right ) \\left(1 - { 1 \\over f } \\right).\\end{aligned}\\ ] ] this is clearly unacceptable since there is no correlation actually present , and the power in the channel of interest should not be reduced at all . in the case where we have two uncorrelated gaussian random channels , with for example @xmath86 , the direct application of the method described here will reduce the power in the channel of interest by almost one percent !",
    "the problem that we are describing is that of incorrectly or falsely removing correlations that are not really present ! if the length of the data set were extremely long , so that the number @xmath34 of frequency bins in any given frequency band were very large , then this problem would disappear .",
    "however in practical work , it is unreasonable to have very large numbers of frequency bins @xmath34 in each band .",
    "one simple solution to this problem is to threshold on the covariance . in other words , we examine each environmental channel in turn , and ask if it is correlated with the channel of interest . if such a covariance is present _ at a statistically - significant level _ , the correlation is removed .",
    "otherwise , the correlation is not removed .",
    "since the expectation value of @xmath140 is @xmath143 , we can set a threshold of say @xmath145",
    "in the n - channel case , there is also a risk of falsely removing `` correlations '' that are not present . in section[s : nchannels ] , we introduced the correlation matrix by equation ( [ e : matrixdef ] ) .",
    "all the following calculations are based on that matrix .",
    "each entry of that matrix , @xmath146 , is the correlation between channels @xmath70 and @xmath71 in frequency band @xmath38 . according to appendix [ s : rho ] , because the number @xmath34 of frequency bins in frequency band @xmath38 is finite , the correlation between any two channels can not be calculated precisely .",
    "consequently there is a risk of finding correlations when none exist , and then incorrectly removing them .",
    "one method to avoid false dismissal of `` correlation '' is to threshold on every entry of the correlation matrix , @xmath103 .",
    "we calculate the absolute value of the covariance coefficient between channels @xmath71 and @xmath16 in frequency band @xmath38 , @xmath147 , which is defined by equation ( [ e : rho ] ) .",
    "if @xmath147 is smaller than some threshold value @xmath148 ( for example @xmath149 ) , then we set the corresponding entry @xmath103 in the correlation matrix to zero .",
    "if @xmath74 is greater than the threshold value @xmath148 , then we leave the corresponding entry @xmath103 in correlation matrix unchanged .",
    "we use , @xmath150 , to denote the correlation matrix after thresholding : @xmath151 the next step is to calculate the coupling constants using equation ( [ e : ri ] ) , but replacing @xmath103 with the correlation matrix after thresholding , @xmath150 .",
    "@xmath152 having found the coupling constants @xmath153 , one can remove the correlations from the channel of interest using equation ( [ e : remove ] ) .",
    "there is a problem when equation ( [ e : ri - thresh ] ) is applied to real data .",
    "because the thresholding sets entries of the correlation matrix to zero , @xmath150 becomes nearly singular and its inverse @xmath154 in equation ( [ e : ri - thresh ] ) becomes unstable .",
    "for example , in figure [ f : correlation ] , there are two channels , slow pzt and arm2 visibility , which are very similar to each other . when the small correlation elements are set to zero in the correlation matrix , the two rows corresponding to these two channels become very close to each other , which makes @xmath150 nearly singular .    to solve this problem , we eliminate `` redundant''channels .",
    "consider the eigenvalues @xmath155 and the eigenvectors @xmath156 of the matrix @xmath150 .",
    "note that the matrix @xmath150 is hermitian and positive semi - definite .",
    "its eigenvalues are always real and non - negative .",
    "if the matrix @xmath150 becomes close to a singular matrix , @xmath150 will have an eigenvalue @xmath157 which is very close to zero .",
    "we call the corresponding eigenvector @xmath158 . hence , @xmath159 when @xmath160 is very close to zero , the rhs of equation ( [ e : lambda_0 ] ) vanishes .",
    "this means there is at least one row in @xmath161 that can be written as a linear combination of the other rows .",
    "because @xmath161 is the correlation matrix of different channels , this implies that at least one channel is a linear combination of the other channels .",
    "that channel is a redundant channel and gives us no useful additional information about the environment .",
    "we can eliminate that channel from our channel set in order to keep the correlation matrix far from singular . to determine the `` best '' channel to eliminate , we consider the absolute value of elements @xmath162 in the eigenvector @xmath158 .",
    "if @xmath163 is the maximum of all the absolute values of elements in the eigenvector @xmath158 , this means that channel @xmath16 makes the maximum contribution to the null eigenvector .",
    "hence , we remove channel @xmath16 from the environmental channel set .",
    "then , we build a new @xmath164 correlation matrix @xmath161 from the remaining n-1 channels and follow the same procedure described above until the eigenvalues are far away from zero .",
    "let us summarize our method in steps :    1 .",
    "threshold the correlation matrix @xmath165 using equation ( @xmath166 ) to get a new correlation matrix @xmath167 .",
    "2 .   calculate the eigenvalues @xmath155 and the eigenvectors @xmath156 of the matrix @xmath150 .",
    "3 .   check whether there is an eigenvalue near zero .",
    "+ if not , calculate the coupling constants using equation ( [ e : ri - thresh ] ) and remove the correlations from the channel of interest ( @xmath23 ) using equation ( [ e : remove ] ) .",
    "+ if there is an eigenvalue @xmath160 which is close to zero , find the maximum ( for example @xmath163 ) of the absolute values of elements in the corresponding eigenvector @xmath158 . then , eliminate the corresponding channel ( for example channel @xmath16 if @xmath163 is the maximum ) from the channel set .",
    "that means that we eliminate the @xmath16 s row and @xmath16th column in @xmath168 .",
    "then return to step 2 .",
    "an ideal scheme of removing correlations from the channel of interest @xmath23 to obtain @xmath169 should have the following properties :    1 .",
    "if any environmental channel is rescaled , i.e. @xmath170 , it does not affect the result @xmath169 .",
    "if any environmental channel is duplicated , i.e. @xmath171 , @xmath172 , it does not affect the result @xmath173 .",
    "if any environmental channel is duplicated by a linear combination of other channels , i.e. @xmath174 , @xmath172 , then @xmath175 can be removed from the set of channels without affecting the result @xmath169 .",
    "of course , property 2 is just a special case of property 3 .",
    "if the environmental channels are replaced by any linear combination of the original channels , i.e. @xmath176 , where @xmath177 is an invertible matrix , it does not affect the result @xmath173 .",
    "if the environmental channels are re - labeled , it does not affect the result @xmath169 .",
    "this is a special case of condition 4 , when @xmath178 is a permutation matrix of the set @xmath179 .",
    "if an environmental channel is gaussian noise and independent of other channels , then it does not affect the final result @xmath169 at a statistically - significant level .",
    "if we do not do thresholding ( when the number of frequency bins @xmath34 in a frequency band is very large ) , our method has all six properties above .",
    "however , if we threshold using the method described in section [ s : thresh_n ] ( when the number of frequency bins @xmath34 in a frequency band is not large enough ) , our method has all the properties above except for property 4 .",
    "we also considered two other thresholding methods .",
    "the first one is to threshold on individual channels .",
    "we check the absolute value of the covariance coefficient between channel @xmath71 and channel @xmath3 ( which is the channel of interest @xmath23 ) in frequency band @xmath38 , @xmath180 .",
    "if @xmath180 is smaller than some threshold value @xmath148 then we eliminate channel @xmath71 from our channel set .",
    "if @xmath180 is greater than the threshold value @xmath148 , then we keep that channel in our channel set .",
    "this method has all the properties above except for property 4 .",
    "compared with the method discussed in section [ s : thresh_n ] , this method is too conservative : it does not remove all the possible contaminating noise .",
    "it is possible that one environmental channel @xmath181 is not correlated with the channel of interest @xmath23 but is correlated with another environmental channel @xmath182 .",
    "suppose channel @xmath182 is correlated to the channel of interest @xmath23 , and contributes to the removal of correlated noise from the channel of interest @xmath23 by equation ( [ e : remove ] ) .",
    "in this situation , if we include channel @xmath181 in the channel set , it is equivalent to the following two operations .",
    "first , we remove the correlation between channel @xmath181 and channel @xmath182 from channel @xmath182 .",
    "we call the result @xmath183",
    ". then we remove the correlation between channel @xmath23 and channel @xmath184 from channel @xmath23 .",
    "this is better than only removing the correlation between channel @xmath182 and channel @xmath23 from channel @xmath23 because our estimation of the correlation between @xmath184 and @xmath23 is better than our estimate of the correlation between @xmath182 and @xmath23 .",
    "another thresholding method is to consider the eigenvectors of the correlation matrix between the environmental channels .",
    "the correlation matrix is diagonalized by a similarity transformation , which is a unitary matrix @xmath185 made up of the eigenvectors of the correlation matrix .",
    "@xmath186 here , the matrix @xmath187 is a diagonal matrix of the eigenvalues of the correlation matrix .",
    "@xmath188 construct new channels @xmath189 by @xmath190 .",
    "these channels @xmath189 are independent of each other since they have vanishing correlation",
    ". then threshold on each channel @xmath189 individually using the method of thresholding in the two - channel case described in section [ s : uncorrelated ] .",
    "however , there is a problem with this apparently promising method . if any environmental channel is rescaled , i.e. @xmath191 , the eigenvector of the correlation matrix is changed .",
    "hence the independent channels that we build @xmath192 are also changed .",
    "so this method does not have properties 4 and 5 .",
    "one may argue that we can normalize the environmental channels first and then diagonalize the correlation matrix by the unitary matrix @xmath185 . in this way",
    "@xmath185 is unique .",
    "however we can not find any physical reason to use a unitary matrix to diagonalize the correlation matrix .",
    "if we use non - unitary matrix , it is no longer unique . to demonstrate that the non - unitary matrix is non - unique , construct a matrix @xmath177 @xmath193",
    "it is obvious that @xmath194 , and @xmath195 is the diagonal identity matrix .",
    "we can arbitrarily choose another unitary matrix @xmath196 .",
    "@xmath197 let matrix @xmath198 .",
    "equation ( [ e : non - uni ] ) shows that @xmath199 diagonalizes the correlation matrix @xmath106 to a unit matrix @xmath200 .",
    "because @xmath177 is non - unitary , @xmath199 is non - unitary . because of the choice of @xmath196 is arbitrary , @xmath199 is not unique .",
    "even when only a unitary matrix is used , there is still a problem .",
    "if an environmental channel is duplicated , i.e. @xmath201 , @xmath172 , the n eigenvectors of the correlation matrix are changed .",
    "this means this that method does not have properties 2 and 3 .",
    "it seems difficult to find a method of thresholding which has all six desired properties .",
    "there is a tradeoff in choosing a suitable method . in practice ,",
    "when full - scale ligo begins operation , we expect that the methods discussed here will provide some guidance in choosing a suitable set of environmental signals to use in `` clean up '' and understanding the interferometer s output .",
    "we anticipate that with some experience and experimentation , it will not prove too difficult to identify a set of suitable channels in different frequency bands , and thresholds can be set based on experience and on understanding of the instrument .",
    "the methods described in this paper amount to estimating whether or not a signal of interest is correlated with other environmental channels .",
    "the key assumption is that the quantity being measured in the signal channel should not have any correlations with the environment .",
    "the correlations are removed following a prescription that minimizes the power in user - defined frequency bands .",
    "we assume that the correlations with the environment are described by linear transfer functions .",
    "the methods used to identify and remove these correlations are very similar to principal component analysis ( pca ) carried out in frequency space . we have used a real data set to demonstrate that the method is both reasonable and effective .",
    "when the full scale ligo interferometers begin operation in the year 2000 , there will be over a thousand environmental and control channels being monitored , and the problem of identifying and eliminating the most significant environmental contamination will be severe . in the end , we suspect that the methods described here will be useful in two ways .",
    "first , they will assist in identifying which environmental channels are having the greatest effects on instrument performance . the frequency dependence of these effects might be helpful in trying to determine how they can be alleviated or eliminated .",
    "second , after the most relevant set of environmental channels have been successfully identified , these techniques should make it possible to  clean up \" the signal , although further study will be needed to determine if this has undesirable side effects .",
    "we gratefully acknowledge the assistance of the ligo project , and in particular the assistance that we have received from stan whitcomb and fred raab in understanding the 40-meter prototype . this work has been supported by nsf grants phy-9507740 and phy-9728704 and forbairt grant ic/1998/026 .",
    "from equation ( [ e : false - remove ] ) in section [ s : uncorrelated ] , we know that when the two channels are independent gaussian random variables , the method described in section  [ s : twochannel ] will falsely remove `` correlations '' which do not exist .",
    "one method to avoid this false dismissal of `` correlation '' is to threshold on the coherence @xmath140 defined by equation ( [ e : rho ] ) . to set a reasonable threshold on @xmath140 ,",
    "we need to know the probability distribution of @xmath140 for the case where @xmath202 and @xmath203 are not correlated .",
    "to determine the probability distribution of @xmath140 , we first consider an @xmath34-dimensional complex gaussian random variable @xmath204 , where @xmath205 and @xmath206 are independent real gaussian random variables with vanishing mean and unit variance .",
    "note that in order to make the notation simpler , we introduce a new symbol @xmath207 to represent the @xmath202 or @xmath203 in previous sections .",
    "the probability distributions are ( subscript `` g '' means `` gaussian '' ) @xmath208 define @xmath209 .",
    "the probability distribution @xmath210 is defined by @xmath211 for any choice of function @xmath212 . taking @xmath213 yields @xmath214 define @xmath215 . in the f - dimensional real space spanned by @xmath216",
    "the joint probability distribution @xmath217 is @xmath218 now we calculate the probability distribution of @xmath140 assuming that @xmath202 and @xmath203 are independent @xmath34-dimensional complex gaussian random vectors .",
    "according to equation ( [ e : rho ] ) , the coherence @xmath140 is defined by @xmath219 where @xmath220 and @xmath221 are @xmath34-dimensional complex vectors . without loss of generality , we assume @xmath220 and @xmath221 both have unit norm , or @xmath222 , so @xmath223 . because equation ( [ e : rho2 ] ) is rotationally invariant , we can also assume @xmath224 and @xmath225 for @xmath226 .",
    "then , @xmath227 thus , the probability distribution of @xmath140 is equal to the probability distribution of @xmath228 given that @xmath229 , where @xmath230 is an @xmath34-dimensional complex random variable with probability distribution given by equation ( [ e : complexarray ] ) .",
    "@xmath231 and the cumulative probability distribution @xmath232    it will be easier to first determine the cumulative probability distribution @xmath233 , or @xmath234 note that to normalize this probability distribution requires @xmath235 . in the @xmath34-dimensional real space spanned by @xmath236 ,",
    "the condition @xmath229 defines part of an ( @xmath237)-dimensional plane @xmath238 defined by @xmath239 the region ( @xmath240 and @xmath241 ) defines a part of an ( @xmath237)-dimensional plane @xmath242 given by @xmath243 note that @xmath242 is a subset of @xmath238 . from equation ( [ e : uz ] ) , we can see that @xmath217 is a constant for any given @xmath244 . in our case , @xmath229 .",
    "hence @xmath245 is just the ratio between the @xmath246-volume of @xmath242 and the @xmath246-volume of @xmath238 . to help calculate the volume of @xmath242",
    ", we can translate the coordinates @xmath236 so that the origin moves to the point @xmath247 : @xmath248 in the @xmath34-dimensional real space spanned by the coordinates @xmath249 , the plane @xmath250 is given by @xmath251 comparing equation ( [ e : allarea ] ) and equation ( [ e : toparea ] ) , we see that @xmath242 and @xmath238 are rescaled versions of each other , and the linear dimension of @xmath242 equals @xmath252 times the linear dimension of @xmath238 .",
    "hence , @xmath253 thus the cumulative distribution @xmath254 note that @xmath255 .",
    "hence this probability distribution is correctly normalized .",
    "taking the derivative of equation ( [ e : cumulative ] ) to get the differential probability distribution function yields @xmath256 hence , @xmath257 the expected value of @xmath258 is @xmath259 now we can return to the problem identified at the beginning of this section .",
    "the aim was to avoid false dismissal of non - existing `` correlation '' by setting a reasonable threshold on the coherence @xmath140 ( defined by equation ( [ e : rho ] ) ) between channels @xmath202 and @xmath203 .",
    "if @xmath140 is greater than the threshold @xmath260 , we conclude that the correlation between @xmath202 and @xmath203 is present at a statistically - significant level , and remove the correlation using method described in section  [ s : twochannel ] .",
    "if not , we leave channel @xmath202 unchanged . according to equation ( [ e : cumulative ] ) , when two channels are just independent gaussian random variables , the probability of incorrectly removing `` correlation '' between them is given by @xmath261 .",
    "for example , when @xmath86 and @xmath262 , the probability of incorrectly removing `` correlation '' is @xmath263 ."
  ],
  "abstract_text": [
    "<S> a technique is described for removing interference from a signal of interest (  channel 1 \" ) which is one of a set of @xmath0 time - domain instrumental signals (  channels 1 to @xmath0 \" ) . </S>",
    "<S> we assume that channel 1 is a linear combination of  true \" signal plus noise , and that the  true \" signal is not correlated with the noise . </S>",
    "<S> we also assume that part of this noise is produced , in a poorly - understood way , by the environment , and that the environment is monitored by channels @xmath1 to @xmath0 . </S>",
    "<S> finally , we assume that the contribution of channel @xmath2 to channel @xmath3 is described by an ( unknown ! ) linear transfer function @xmath4 . </S>",
    "<S> our technique estimates the @xmath5 and provides a way to subtract the environmental contamination from channel 1 , giving an estimate of the  true \" signal which minimizes its variance . </S>",
    "<S> it also provides some insights into how the environment is contaminating the signal of interest . </S>",
    "<S> the method is illustrated with data from a prototype interferometric gravitational - wave detector , in which the channel of interest ( differential displacement ) is heavily contaminated by environmental noise ( magnetic and seismic noise ) and laser frequency noise but where the coupling between these signals is not known in advance . </S>"
  ]
}