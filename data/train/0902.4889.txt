{
  "article_text": [
    "from its early days quantum computing was perceived as a means to efficiently simulate physics problem @xcite , and a host of results have been derived along these lines for quantum wiesner:96,meyer:97,boghosian:97a , abrams:97,zalka:98,lidar:98rc , ortiz:00,terhal:00,freedman:00,wubyrdlidar:01,aspuru - guzik:05,cirac:02,cirac:08 , and classical systems lidar : pre97a , yepez:01,meyer:02,georgeot:01a , georgeot:01b , terraneo:03,lidar:04,dorit - tutte , joe , bravyi:07,aspuru - guzik1,aspuru - guzik2 .",
    "a  natural problem relating quantum computation and statistical mechanics is to understand for which instances quantum computers provide a speedup over their classical counterparts for the evaluation of partition functions @xcite .",
    "for the _ potts model _ , results obtained in @xcite provide insight into this problem when the evaluation is an additive approximation .",
    "we provided a class of examples for which there is a quantum speedup when one seeks an exact evaluation of the potts partition function @xcite .    in this work",
    "we address the connection between quantum computing and classical statistical mechanics from the opposite perspective .",
    "namely , we seek to find restrictions on the power of quantum computing , by employing known results about efficiently simulatable problems in statistical mechanics . specifically , we restrict our attention to the _ ising model _ partition function @xmath0 , and use a mapping between graph instances of the ising model and quantum circuits introduced in @xcite , to identify a certain class of quantum circuits which have an efficient classical simulation",
    ".    restricted classes of quantum circuits which can be efficiently simulated classically have been known since the gottesman - knill theorem nielsen : book .",
    "this theorem states that a quantum circuit using only the following elements can be simulated efficiently on a classical computer:(1 ) preparation of qubits in computational basis states , ( 2 ) quantum gates from the clifford group ( hadamard , controlled - not gates , and pauli gates ) , and ( 3 ) measurements in the computational basis . such stabilizer circuits  on @xmath1 qubits can be be simulated in @xmath2 time using the graph state formalism @xcite .",
    "other early results include ref .",
    "@xcite , where the notion of matchgates was introduced and the problem of efficiently simulating a certain class of quantum circuits was reduced to the problem of evaluating the pfaffian .",
    "this was subsequently shown to correspond to a physical model of noninteracting fermions in one dimension , and extended to noninteracting fermions with arbitrary pairwise interactions @xcite ( see further generalizations in refs .",
    "@xcite ) , and lie - algebraic generalized mean - field hamiltonians @xcite .",
    "criteria for efficient classical simulation of quantum computation can also be given in terms of upper bounds on the amount of entanglement generated in the course of the quantum evolution @xcite .",
    "a result that is more directly related to the one we shall present in this work is given in ref .",
    "@xcite , but within the measurement - based quantum computation ( mqc ) paradigm .",
    "mqc relies on the preparation of a multi - qubit entangled resource state known as the cluster state .",
    "it is known that mqc with access to cluster states is universal for quantum computation .",
    "reference @xcite considers _ planar code states _ which are closely related to cluster states in that a sequence of pauli - measurements applied to the two - dimensional cluster state can result in a planar code state .",
    "mqc with planar code states consists of a sequence of measurements @xmath3 where the @xmath4 are one - qubit measurements and @xmath5 is a final measurement done on the remaining qubits in some basis which depends on the results of the @xmath4 .",
    "reference @xcite demonstrates that planar code states are not a sufficient resource for universal quantum computation ( and can be classically simulated ) .",
    "this fact is attributed to the exact solvability of the ising partition function on planar graphs .",
    "our results complement the work in @xcite , as they are provided in terms of the circuit model , and generalize to ising model instances that correspond to graphs which are not necessarily subgraphs of a two - dimensional grid .",
    "other conceptually related work uses the connection between graphs and quantum circuits and the formalism of tensor network contractions , to show that any polynomial - sized quantum circuit of @xmath6- and @xmath7- qubit gates , which has log depth and in which the @xmath7-qubit gates are restricted to act at bounded range , may be classically efficiently simulated markov : tensor , jozsa-2008,yoran:170503 .",
    "a tensor network is a product of tensors associated with vertices of some graph @xmath8 such that every edge of @xmath9 represents a summation ( contraction ) over a matching pair of indexes .",
    "we also use a relationship between quantum circuits and graphs but whose construction is quite different @xcite . also ,",
    "@xcite connects matchgates and tensor network contractions to notions of efficient simulation .",
    "finally , other closely related work was recently reported in @xcite ( see also @xcite ) , which addresses the classical simulatability of quantum circuits .",
    "their results use a connection to the partition function of spin models , as do we , and they too provide a mapping between classical spin models and quantum circuits . specifically pertinent to our work",
    "is the fact that they give criteria for the simulatability of quantum circuits , using the 2d ising model .",
    "that is , circuits consisting of single qubit gates of the form @xmath10 and nearest - neighbor gates of the form @xmath11 are classically efficiently simulable .",
    "we shall discuss how the nearest - neighbor restrictions can be lifted while retaining efficient classical simulatability .",
    "the structure of this paper is as follows .",
    "we begin with a brief review of the ising model in section [ sec : ising ] , where we define the ising partition function @xmath0 . in section [ sec2 ]",
    "we review quadratically signed weight enumerators ( qwgt s ) and their relationship to quantum circuits , and review the relationship between qwgt s and @xmath0 . in section [ sec : mapping ] we introduce an ansatz that allows one to associate graph instances of the ising model with circuit instances of the quantum circuit model . in this section we derive a key result : an explicit connection between the partition function for the ising model on a graph , and a matrix element of the unitary representing a quantum circuit which is related to this graph via the graph s incidence matrix [ eq . _  _ ( [ eq : element ] ) ] .",
    "we then present our main result in section [ sec : proof ] :  a theorem on efficiently simulatable quantum circuits .",
    "the proof depends on the fact that there are algorithms for the efficient evaluation of @xmath0 for planar instances of the ising model .",
    "we also discuss the relation to previous work . in section nextstep",
    "we present a discussion and some suggestions for future work , including the possibility of a quantum algorithm for the additive approximation of @xmath0 .",
    "we conclude in section [ sec : conc ] .",
    "the appendix gives a review of pertinent concepts from graph theory , and additional details , including some proofs .",
    "we briefly introduce the ising spin model accompanied by some notation and definitions .",
    "let @xmath12 be a finite , arbitrary undirected graph with @xmath13 edges and @xmath14 vertices . in the ising model",
    "each vertex @xmath15 is occupied by a classical spin @xmath16 , and each edge @xmath17 represents a bond @xmath18 ( interaction energy between spins @xmath15 and @xmath19 ) .",
    "[ def : ising]an _ instance _ of the ising problem is the data @xmath20 , i.e. , @xmath21 represents a weighted graph .",
    "the hamiltonian of the spin system is @xmath22a spin configuration @xmath23 is a particular assignment of spin values for all @xmath14 spins .",
    "a bond with @xmath24 is called ferromagnetic , and a bond with @xmath25 is called antiferromagnetic .",
    "the probability of the spin configuration @xmath26 in thermal equilibrium for a system in contact with a heat reservoir at temperature @xmath27 , is given by the gibbs distribution : @xmath28 , where the boltzmann weight is @xmath29 $ ] , @xmath30 is the inverse temperature in energy units , @xmath31 is the boltzmann constant , and @xmath32 is the partition function : @xmath33 .",
    "\\label{eq : z}\\]](unless there is a risk of confusion we will from now on write @xmath0 in place of @xmath34 in order to simplify our notation . ) computation of the partition function is the canonical problem of statistical mechanics , since once @xmath0 is known one can compute all thermodynamic quantities , such as the magnetization and heat capacity , by taking derivatives of @xmath35 ( the free energy )  with respect to appropriate thermodynamic variables @xcite .    in this work",
    "we restrict our attention to the case @xmath36 , with @xmath37 , which already gives rise to the full complexity of spin glass models and the associated computational hardness @xcite .",
    "for example , with the above restriction the problem of computing the partition function in the three - dimensional spin - glass is np - hard @xcite .",
    "quadratically signed weight enumerators ( qwgts ) were introduced by knill and laflamme in ref .",
    "@xcite .",
    "a quadratically signed weight enumerator is a bi - variate polynomial of the form @xmath38where @xmath39 and @xmath40 are @xmath41-matrices with @xmath40 of dimension @xmath42 and @xmath43 of dimension @xmath44 . the variable @xmath45 in the summand ranges over @xmath41-column vectors of dimension @xmath1 satisfying @xmath46 ( in the kernel , or nullspace of @xmath39 ) , @xmath47 is the transpose of @xmath45 , and @xmath48 is the hamming weight of @xmath45 ( the number of ones in the vector @xmath45 ) .",
    "all calculations involving @xmath49 or @xmath45 are done modulo @xmath7 .",
    "note that the evaluation of a qwgt , given that @xmath50 and @xmath51 are natural numbers , is in general @xmath52p - hard , since it includes the evaluation of the weight enumerator polynomial of a classical linear code @xcite .",
    "we shall now review in some detail how qwgt s were arrived at in ref .",
    "laflamme by considering expansions of quantum circuits .",
    "let @xmath53 be a quantum circuit formed by a temporal ordering of @xmath54 gates @xmath55 , and let @xmath56 be the corresponding unitary operator .",
    "note that a universal gate set can be achieved by allowing arbitrary rotations about tensor products of pauli operators , i.e. , each of the @xmath54 gates @xmath55 can be represented as    @xmath57    where @xmath58with @xmath1 being the number of qubits , such that the pauli matrices are @xmath59here @xmath60 , @xmath61 is a binary vector whose length is @xmath62 , and the superscript @xmath63 represents the qubit which is operated on by the corresponding pauli matrix . a circuit constructed using gates of the form ( [ eq : g ] ) may be approximated efficiently to accuracy @xmath64 with @xmath65 overhead using a standard gate set , such as controlled - not  with single - qubit gates , and there is a classical algorithm that computes such approximations efficiently @xcite .",
    "a universal set of one- and two - qubit gates can be obtained from @xmath55 s as in eq .",
    "( [ eq : g ] ) from the rotations with @xmath66 ( i.e. , @xmath67 ) around operators of weight at most two ( the weight of @xmath68 is the number of non - zero pairs of bits in @xmath45 ) ( theorem 3.3 , case ( e ) , of adleman:97 ) . letting @xmath69so that @xmath70",
    ", we rewrite eq .",
    "( eq : g ) as @xmath71    the gate set is still universal if @xmath72 is expressed as a product of _ real _ gates @xcite , i.e. , if each gate @xmath55 contains an odd number of @xmath73 s , so that @xmath74 in eq . (",
    "eq : gk ) is a real - valued matrix .",
    "following ref .",
    "@xcite , we adopt this convention , so that from now on @xmath75 is a binary vector of length @xmath62 , subject to the restriction that the @xmath75 can only contain an odd number of @xmath76 s .",
    "moreover , the gate set is still universal if we assume that the orientation ( the sign of @xmath77 ) is positive if the number of @xmath78 s is @xmath79 and negative otherwise @xcite .",
    "this means that we can replace eq .",
    "( [ eq : gk ] ) by@xmath80with the sign determined by the number of @xmath73 s in @xmath81",
    ". then , by defining    @xmath82    where @xmath83 is the ( always odd ) number of @xmath73 s occurring in @xmath84 , we may write @xmath85which is the desired representation of real - valued gates @xcite .    now define @xmath86 to be the block diagonal matrix whose blocks consist of    @xmath87    i.e. , @xmath88then the property that @xmath45 has an odd number of @xmath76 s is given by @xmath89 .",
    "in addition , we have the multiplication rule    @xmath90    where the addition in the subscript is bit by bit modulo @xmath7 .",
    "let @xmath91 be the @xmath92 matrix whose columns are the @xmath75:@xmath93@xmath91 is a linear size , bijective representation of the quantum circuit , where each column represents a gate and every pair of rows represents a qubit .",
    "a matrix @xmath91 which is constructed according to eq .",
    "( [ eq : h ] ) is called the @xmath91-matrix representation  of the quantum circuit @xmath53 .    using the rule ( [ eq : brule ] )",
    "we then have the following expansion laflamme :    @xmath94    where @xmath95and where the @xmath96 lower - triangular matrix @xmath97 is defined by@xmath98and where @xmath99 ranges over all binary column vectors of length @xmath54 .",
    "( thus @xmath100 is not a matrix element of @xmath97 ; we use this notation merely for convenience . )    in order to make contact with the partition function of the ising model , we shall be interested in the matrix element @xmath101 , where @xmath102 , and @xmath103 is the @xmath104 eigenvector of @xmath105 . for this matrix element to be non - zero no qubit can be flipped , i.e. , @xmath72 can not contain any @xmath106 or @xmath73 factors . when taking the same matrix element of the right - hand side of eq .",
    "( [ eq : expand ] ) we have @xmath107 , and similarly , for this to be non - zero @xmath108 can not have @xmath106 or @xmath73 factors .",
    "this is enforced by summing only over those binary vectors @xmath99 such that @xmath109 @xcite .",
    "thus : @xmath110a glance at the qwgt expression ( [ eq : s ] )  reveals a striking similarity to the latter matrix element .",
    "as a simple example meant to illustrate the correspondence between the @xmath91-matrix representation of a quantum circuit @xmath53 and the actual operation of the circuit , consider    @xmath111\\ ] ]    this matrix represents a circuit @xmath53 comprising three gates ( three columns ) acting on three qubits ( two rows per qubit),@xmath112with the following unitaries : @xmath113the superscripts represent which qubit is being acted upon and we have omitted the tensor product symbols .",
    "the pauli operators can be read off from the corresponding column entries in @xmath91 ; thus the entry @xmath114 @xmath115 in the top position of the first column of @xmath91 represents the @xmath116 pauli matrix in @xmath117 , etc .      in ref .",
    "@xcite it was shown that the ising partition function can be expressed in terms of a qwgt .",
    "let @xmath39 be the incidence matrix of the graph @xmath12 , i.e. , @xmath118let us associate a binary vector @xmath119of length @xmath13 with the bond distribution @xmath120 , by letting    @xmath121    so that @xmath122 specifies whether edge @xmath123 supports a ferromagnetic ( @xmath124 ) or antiferromagnetic ( @xmath125 ) bond .",
    "thus we can give an equivalent definition of an instance of the ising model ( recall definition [ def : ising ] ) as the data @xmath126 .",
    "let @xmath127and define the @xmath128 matrix @xmath129writing the instance data as @xmath126 we then have ( theorem 2 of @xcite ) : @xmath130where @xmath99 in the sums ranges over all @xmath131 vectors of length @xmath13 satisfying @xmath132 , where @xmath133 ( since @xmath134 or @xmath6 ) was used in the second equality , and where the qwgtdefinition ( [ eq : s ] ) was used in the last equality .",
    "this establishes the link between qwgts and the ising model partition function .",
    "because of the similarity to the matrix element @xmath135 , we expect to be able to relate the partition function to quantum circuits , via qwgts .",
    "we take this up in the next section .",
    "an even subgraph of a graph @xmath8 ( or equivalently an eulerian subgraph ) is any subgraph of @xmath8 whose vertices are of even degree .",
    "equivalently , these are paths in @xmath8 which begin and end at the same vertex , and which pass through each edge exactly once .",
    "[ def : even ]    now , note that the sum in @xmath136is over vectors that are in the kernel ( nullspace ) of @xmath39 , which here means that only subgraphs having an even number of bonds emanating from all vertices are allowed , i.e. , the sum is taken over all even subgraphs or equivalently , all eulerian subgraphs .    in this work",
    "we will sometimes refer to even or eulerian subgraphs as cycles .",
    "our goal in this section is to connect the partition function @xmath0 to @xmath137 .",
    "to do so we will use a mapping found and described in detail in ref .",
    "@xcite .      focusing on the representation of the quantum circuit given in eq .",
    "( eq : expand ) and of the partition function given in eq .",
    "( [ eq : z1 ] ) , we begin by asking ourselves if there exists some ansatz for the gate set @xmath138 such that    @xmath139    where @xmath140 .",
    "if such a form were possible , the two representations would be closely linked .",
    "indeed , we can almost get this form .",
    "let us take as an ansatz@xmath141i.e .",
    ", the special case of eq .",
    "( [ gates ] ) with @xmath142 , or @xmath143note that since the inverse temperature @xmath144 and the bond strength @xmath145 are both positive , eq .  ( [ eq : abl ] ) restricts@xmath146 to be in the range @xmath147 , or @xmath148 to be in the range @xmath149(the range for which @xmath150 ) .",
    "fortunately , this includes the case @xmath151 ( i.e. , @xmath152 ) , which , as noted above , allows a universal set of one and two qubit gates to be obtained .",
    "thus , we have not restricted the generality of the class of quantum circuits so far . on the other hand ,",
    "most @xmath153 do not correspond to universal quantum circuits .",
    "next , we obtain from eq .",
    "( [ eq : expand ] ) :    @xmath154    after taking matrix elements @xmath155 , we have , recalling eq .",
    "( [ eq:0u0 ] ) : @xmath156comparing eqs .",
    "( [ eq : z1 ] )  and ( [ 0u0 ] ) , while using @xmath157 , we see that a sufficient condition for them to be equal , is to identify the incidence matrix @xmath39 with @xmath158 via @xmath159where @xmath160 is a matrix containing twice the number of rows of the incidence matrix @xmath39 , but where each even row is a zero row , and each consecutive odd row is equal to a row of the original incidence matrix @xmath39 , and to equate the exponents , i.e. , find an edge distribution @xmath122 which solves@xmath161where @xmath162 [ recall eq .",
    "( [ eq : q ] ) ] . for then    @xmath163    _ equation _ ( [ eq : element ] )",
    "_  is a key result of this paper , as it establishes the equivalence between quantum circuits and the ising model , for bond distributions _",
    "@xmath122 _ _  that satisfy eq . _ _ ( [ eq : w ] ) _ , and _ @xmath164 _ _ s that satisfy eq",
    ". _ _ ( [ eq : abl])_. _    it has two consequences . first , if we are able to determine @xmath165 , then we are able to determine the partition function @xmath166 .",
    "note that estimating @xmath137 in general is bqp - complete @xcite and thus something one could do with a universal quantum computer .",
    "alternatively , if we had a way of classically computing @xmath167 , then we would be able to classically simulate the quantum circuit @xmath53 ( if it were solving a decision problem ) @xcite .",
    "this latter alternative is the one we focus on in this paper .",
    "the connections we established in the previous subsection between quantum circuits and the partition function imply certain restrictions .",
    "we flesh these out in the present subsection .",
    "first , since we wish to work only with the physically relevant range of positive temperatures and positive @xmath145 , we restrict the gate angles @xmath77 from now on to lie in @xmath168 .",
    "formally :    a gate angle @xmath77 [ eq .",
    "( [ eq : theta ] ) ] for a gate @xmath55 [ eq .",
    "( gates ) ] is said to be @xmath164-compatible  if  @xmath153 , where the range @xmath168 is defined in eq .",
    "( [ eq : range ] ) .",
    "next , we note that eq .",
    "( [ a = ch ] ) gives rise to a compatibility relation between circuits and graphs :    a quantum circuit @xmath53 , constructed with @xmath164-compatible angles , is @xmath8-compatible  with a graph @xmath8 if the @xmath91-matrix representation of @xmath53 satisfies eq .",
    "( [ a = ch ] ) , where @xmath39 is the incidence matrix of @xmath8 , and @xmath86 is defined in eq .",
    "( [ eq : c ] ) .",
    "when we take a @xmath8-compatible circuit and plug its @xmath91-matrix into eq .",
    "( eq : w )  we are not guaranteed that there exists a solution @xmath122 . hence we need an appropriate restriction of the class of @xmath8-compatible circuits :    a quantum circuit @xmath53 is @xmath169-compatible  if it is @xmath8-compatible and if the solution set of eq .",
    "( [ eq : w ] ) is non - empty .",
    "we need a similar notion for the bond distributions :    a bond distribution @xmath122 is @xmath170-compatible  with a graph @xmath8 and circuit @xmath53 if it satisfies eq .",
    "( [ eq : w ] ) .",
    "note that in this last definition the circuit @xmath53 must be @xmath169-compatible , for otherwise we are not guaranteed that the solution set of eq .",
    "( [ eq : w ] ) is non - empty .",
    "note further that , as these definitions imply , eqs .  ( [ a = ch])-([eq : element ] )",
    "describe a connection between quantum circuits and instances of the ising model over given graphs .",
    "namely , any @xmath91 which solves eq .",
    "( [ a = ch ] ) is a matrix representation of a circuit @xmath53 which belongs to a class defined by the incidence matrix @xmath171 of a given graph @xmath8 .",
    "in addition , we can populate the vertices of @xmath8 with weights from the bond distribution @xmath122 provided @xmath122 is compatible .",
    "thus :    [ def : omega_g]let @xmath172 be any set of graphs for which a solution to eq .",
    "( [ eq : w ] ) exists .",
    "then @xmath173 is the set of circuits which are @xmath169-compatible @xmath174 .",
    "[ def : i_g]@xmath175 is the class of ising model instances @xmath176 whose graph is @xmath177 and whose bond distributions @xmath178 are @xmath179-compatible @xmath174 .    equation ( [ eq : w ] ) is a system of linear equations over @xmath180 .",
    "the number of equations is equal to the number of even subgraphs of the given graph or the total number of elements in the set @xmath181 , and the number of unknowns is equal to the number of edges .",
    "however , in spite of the fact that the number of elements in @xmath181 scales exponentially in the number of vertices , it turns out that finding a @xmath122 which solves eq .",
    "( eq : w ) can be done efficiently [ see eq .",
    "( [ eq : w - sol ] ) below ] .",
    "let us further stress _ _  _ _ that eq .",
    "( [ eq : w ] ) is only a sufficient condition for the equality of eqs .",
    "( [ eq : z1 ] )  and ( [ 0u0 ] ) , and does not capture the whole set of possible graph instances that our scheme can handle .",
    "we define our instances via this condition because it simplifies the analysis and it allows us to extract information about an interesting set of quantum circuits which may be classically simulated .",
    "we discuss more general sufficient conditions in section [ nexta ] , but leave the development of a complete understanding of the actual graph instances that our mapping can handle , and in particular finding necessary conditions for the equality of eqs .",
    "( [ eq : z1 ] )  and ( [ 0u0 ] ) , as a problem for future study .",
    "let us recap the general idea we have developed so far . at the basis of our construction",
    "are an inverse temperature @xmath144 , bond strength @xmath145 , and a given graph @xmath8 .",
    "we use this graph to first identify a compatible class of quantum circuits @xmath182 ( definition [ def : omega_g ] ) .",
    "this class is restricted to a subclass @xmath183 of circuits for which there exist solutions to eq .",
    "( [ eq : w ] ) .",
    "such solutions are used to assign weights to the graph s edges ( a bond distribution ) , which yields a class of ising model instances compatible with @xmath8 and @xmath182 ( definition [ def : i_g ] ) . in other words , we go from the unweighted graph to a class of compatible circuits , and from there to back to the graph , which is now populated by a class of compatible ising models .",
    "each circuit is also parametrized by an angle @xmath77 , and when we vary @xmath77 in the range @xmath168 [ eq .  ( eq : range ) ] we also vary over @xmath144 and @xmath145 , via @xmath184 .",
    "however , not all values of @xmath77 correspond to universal circuits .",
    "conversely , not every circuit need correspond to a physical ( positive ) temperature .    in more detail",
    ", we identify the class of quantum circuits @xmath182 compatible with @xmath8 ( whose incidence matrix is @xmath39 ) by solving eq .",
    "( a = ch ) for the matrices @xmath91 representing each ( or some ) @xmath185 , and then find the subset @xmath183 for which the solution set to eq .",
    "( [ eq : w ] ) is non - empty .",
    "we then look for a bond distribution @xmath122 that satisfies eq .",
    "( [ eq : w ] ) for a given @xmath91 .",
    "every such @xmath122 defines an ising model instance @xmath186 that is compatible with @xmath8 and the corresponding @xmath187 .",
    "we are guaranteed that provided such a bond distribution @xmath122 exists , the partition function for the corresponding ising model is proportional to the matrix element @xmath188 [ eq .",
    "( [ eq : element ] ) ] . in other words",
    ", any bond distribution @xmath122 that satisfies eq .",
    "( [ eq : w ] ) induces a direct connection between quantum computation and the ising model on a graph with that same bond distribution .",
    "it is important to emphasize that eq .",
    "( [ eq : w ] ) will not always have a solution @xmath122 .",
    "whether or not this is the case is entirely determined by the given graph @xmath8 , since @xmath8 , via its incidence matrix @xmath39 , determines the class of @xmath8-compatible circuits @xmath182 [ i.e. , the matrices @xmath91 that solve eq .",
    "( [ a = ch ] ) ] , and together they determine @xmath99 and @xmath189 that go into eq .",
    "( [ eq : w ] ) , which @xmath122 needs to solve .",
    "thus , it makes sense to define a class of graphs for which there exists a solution @xmath122 to eq .",
    "( eq : w ) .",
    "[ def : theta ] @xmath190 is the set of graphs for which a solution to eq .",
    "( [ eq : w ] ) exists .    in order to characterize",
    "@xmath191 we require some basic ideas from graph theory , such as obstruction sets and downward closure .",
    "these are reviewed in appendix [ app : graphs ] .",
    "we shall prove :    [ finite - obs ] the obstruction set for @xmath191 is finite .",
    "this will come as a consequence of @xmath191 s downward closure and the robertson - seymour theorem  theorem [ th : rs ] .",
    "this is proved in appendix [ proofs ] .",
    "we shall also prove there that there are no solutions to eq .",
    "( [ eq : w ] ) for the graphs @xmath192 ( the complete graph on four vertices ) and @xmath193 , where @xmath193 is @xmath194 with one edge missing ( which edge does not matter , since upon deletion of another edge one can just relabel the edges and nodes and obtain exactly the same incidence structure ) .",
    "formally :    [ lem : obs ] the obstruction set for @xmath191 includes @xmath193 and @xmath192 .",
    "the proof is described in appendix [ proofs ] . see fig .",
    "[ graphs ] in appendix [ app : graphs ] for a pictorial representation of the graphs mentioned in lemma  [ lem : obs ] . as a consequence we will find that _ all graphs in _",
    "are planar_.    we shall clarify this conclusion and the previous lemma in the next subsection , but given their validity , a @xmath170-compatible bond distribution @xmath122 necessarily corresponds to a _",
    "graph @xmath8 . from this",
    "it follows that its partition function can be efficiently computed classically , and hence the corresponding class of quantum circuits , i.e. , @xmath195 , also has an efficient classical simulation .",
    "let us be precise about what we mean by classically efficiently simulatable  ( ces ) .",
    "[ def : ces]a uniform family @xmath196 of @xmath1-qubit quantum circuits is classically efficiently simulatable  ( ces )  if the matrix element @xmath197 of each circuit in @xmath198 can be obtained to @xmath31 digits of precision in time @xmath199 by classical means @xcite .",
    "this definition is a modified version of the one given in ref .",
    "jozsa-2008 , which also includes a discussion on how it can be weakened .",
    "when we collect the observations above we arrive at an efficient classical test for whether a given quantum circuit is ces .",
    "this is summarized in theorem [ th ] , which is our main result and the subject of the remainder of the paper :    * _ ( circuits corresponding to certain planar graphs have an efficient classical simulation)_*[th ] the class of quantum circuits @xmath200 is ces . deciding whether a given a graph @xmath8 is in @xmath191 can be efficiently decided .",
    "the theorem comprises two parts . in the first we characterize an entire class of ces  quantum circuits .",
    "the proof we offer below is not constructive , i.e. , we prove that there _ exists _ an efficient classical simulation of the class of quantum circuits @xmath200 , and also provide a test of non - membership in @xmath200 for a given quantum circuit . in the second part we given an explicit construction which decides whether a given graph belongs to the set of graphs resulting in ces circuits .",
    "to illustrate this part , we discuss a class of graphs ( which is a subset of @xmath200 ) in section [ sparsegraphs ] , for which we can explicitly find the @xmath170-compatible bond distribution .",
    "this class is highly restricted in that the number of even subgraphs only grows polynomially in the number of vertices , whereas in general , including restrictions to planar graphs , the number of even subgraphs grows exponentially . nonetheless , the class of quantum circuits that one obtains under this restriction is interesting in light of some new results about the classical simulatability of quantum circuits @xcite .    for the benefit of the reader",
    "we summarize the scheme of the first claim of the proof informally .",
    "this will also serve to summarize again the mapping between quantum circuits and graphs .    1 .",
    "* given : * any subset @xmath201 of @xmath191 .",
    "every @xmath202 has a @xmath170-compatible bond distribution for some quantum circuit @xmath203 , by assumption .",
    "2 .   take the incidence matrices @xmath158 of the graphs in @xmath172 and transform them into the _ h - matrix representations _ of the corresponding quantum circuits .",
    "the following constraint must be respected : every column must have one @xmath204-operation and can have at most one @xmath205-operation .",
    "[ this constraint comes from the fact that @xmath158 should be an incidence matrix for a graph , where @xmath86 is the block - diagonal matrix defined in eq .",
    "( [ eq : c ] ) . without it",
    "one has a correspondence between quantum circuits and hypergraphs @xcite . indeed , if the incidence matrix has more than two ones per column than one has a hypergraph .",
    "thus @xmath172 corresponds to a set of quantum circuits @xmath206 , i.e. , every quantum circuit @xmath207 is _ gw - compatible _ for some @xmath177 .",
    "4 .   show that our mapping from circuits to graphs defines a downward closed set  of graphs , which means that we may apply the robertson - seymour theorem @xcite .",
    "this theorem guarantees that there is a finite set of graphs ( obstruction set ) for which we can test whether or not @xmath8 has any members of this set as a graph minor @xcite ( at most cubic complexity in the number of quantum gates in @xmath208 ) .",
    "define @xmath191 , via this obstruction set , i.e. , a graph is a member of @xmath191 if it does not have @xmath192 and @xmath209 _ with one edge deleted _ as minors ( there may be other forbidden minors ) .",
    "one has a set of circuits which correspond to the graphs which have a satisfying bond distribution @xmath122 for equation ( [ eq : w ] ) .",
    "we call the corresponding class of quantum circuits @xmath200 .",
    "( this specific obstruction set has been tested with mathematical software .",
    "see appendix [ app : algo ] . )",
    "6 .   due to the fact that these graphs are planar , the partition function @xmath210 of any graph in @xmath190 can be computed efficiently by a classical computer @xcite .",
    "7 .   using equation ( [ eq : element ] ) ,",
    "show that knowledge of @xmath0 can be used to determine the outcome of a quantum circuit @xmath211 for a decision problem .",
    "* conclude : * families of quantum circuits in @xmath200 which solve a decision problem can be classically simulated .",
    "being that @xmath201 is a subset of @xmath191 , any subset @xmath212 of @xmath200 is ces .",
    "conversely , we have a test for non - membership in the set @xmath200 :    1 .   *",
    "input * a quantum circuit @xmath208 .",
    "2 .   transform @xmath53 into a matrix whose columns represent pauli operations ( that are to be exponentiated ) and every pair of rows are the qubits being acted upon as described in section [ sec : qwgt - qc ]",
    ". this matrix is called @xmath91 [ eq .  ( [ eq : h ] ) ] and",
    "is in 1-to-1 correspondence with @xmath53 . as above",
    ", the following constraint must be respected : every column must have one @xmath204-operation and can have at most one @xmath205-operation .",
    "3 .   after the above transformation ,",
    "construct a corresponding incidence matrix @xmath158 of a graph @xmath8 .",
    "4 .   check the graph @xmath8 for the minors @xmath193 and @xmath213 .",
    "conclude : * if either of these are minors of @xmath8 then reject @xmath214 .",
    "the following lemma allows us to introduce an ordering on the elements in @xmath215 .",
    "[ graphk ] if a graph @xmath8 is a member of @xmath190 , then so is @xmath216 or @xmath217 , i.e. , the deletion or contraction of an arbitrary edge @xmath218 from a graph in @xmath190 is also in @xmath190 .",
    "the proof of this lemma is technical and is given in appendix [ proofs ] .",
    "lemma [ graphk ] implies that @xmath191 is a _ downwardly closed set with respect to the minor ordering_. hence we can apply the robertson - seymour theorem @xcite , theorem [ th : rs ] , which states that _ any graph may be tested for membership in a given downwardly closed set of graphs by just searching the graph for a finite set of minors . _",
    "the complexity of doing this , given knowledge of the minors one is looking for , can be shown to be cubic in the number of edges .",
    "we implemented this to test eq .",
    "( [ eq : w ] ) for non - planar solutions , as we describe next .      using mathematical software we demonstrated that the mapping between graphs and circuits described above , with the sufficient condition given by eq .",
    "( [ eq : w ] ) , can not be satisfied for @xmath219 and @xmath194 .",
    "that is , @xmath219 and @xmath194 are forbidden minors for @xmath191 .",
    "the algorithm we implemented to check this is described in appendix [ app : algo ] . however , a finite graph is planar if and only if it does not have @xmath219 or @xmath194 as minors ( wagner s theorem ; see appendix [ app : graphs ] ) . as stated earlier , we thus have    [ lem : planar]all graphs in @xmath191 are planar .",
    "we remark that we have been able to find examples of planar graphs for which there do exist solutions @xmath122 to eq .",
    "( [ eq : w ] ) , e.g. , @xmath220 . as we explain below",
    ", this means that @xmath191 includes planar graphs which are not outerplanar .",
    "the standard way in which a quantum circuit @xmath221 solves a decision problem , is to measure , say , the first qubit , and decide the problem according to this measurement outcome . in ref .",
    "@xcite it was shown that for every such decision problem , there exists another quantum circuit @xmath222 such that the evaluation of @xmath223 is equivalent to the decision problem solved by applying @xmath221 and measuring the first qubit . in this sense",
    "we have :    [ lem : decision]knowledge of @xmath224 suffices to determine the output of a quantum circuit which is being used to solve a decision problem .    for a proof see , e.g. , ref .",
    "@xcite .",
    "collecting everything we now prove our main theorem .",
    "we first need one more technical lemma :    [ quad - form]_a quadratic form _ @xmath225 _ over gf(2 )  is linear in _ @xmath50 _",
    "( equal to _ @xmath226 _",
    "_ @xmath39 _ _  is symmetric . _ _    here @xmath227 denotes a vector comprising the diagonal of @xmath39 .",
    "the proof of this lemma is presented in appendix [ proofs ] .",
    "we start from the second claim of the theorem , namely we prove that we can efficiently decide whether a given graph belongs to the set @xmath191 , and that we can find some @xmath122 if it does belong .",
    "let @xmath8 be a given graph and let @xmath228 be the matrix whose columns are a basis of @xmath229 , where @xmath39 is the incidence matrix of @xmath8 .",
    "this means that any @xmath230 may be written as @xmath231 where @xmath50 is an arbitrary @xmath232-dimensional binary vector . using this we may rewrite eq .",
    "( [ eq : w ] ) over gf(2 ) as @xmath233since the right - hand side is linear in @xmath50 for all @xmath50 , the left - hand side must also be linear in @xmath50 .",
    "it follows by lemma [ quad - form ] that @xmath234 is symmetric , and moreover that the quadratic form @xmath235 can be written as @xmath236 .",
    "thus , solving eq .",
    "( [ eq : w ] ) for @xmath122 is equivalent to solving the linear system @xmath237 , or @xmath238since this equation must be true for all @xmath50 , it follows that @xmath239 and hence that @xmath122 is the solution to@xmath240since @xmath228 is efficiently constructable , @xmath122 can also be found efficiently using standard methods for solving linear equations over gf(2 ) .",
    "now for the first claim of the theorem , which states that the circuits corresponding to the graphs in @xmath191 are ces .",
    "@xmath191 is a downwardly closed set of graphs which generates a set of compatible quantum circuits @xmath195 via the mapping described above . in turn",
    "we have the corresponding ising model instances @xmath241 and by assumption , the _ g@xmath53-compatible _ bond distributions @xmath122 for the circuits @xmath242 and graphs @xmath243 . lemma [ lem : planar ] states that these instances are planar .",
    "it follows that they are ces , i.e. , we may compute the ising partition function for any of these instances efficiently with a classical computer .",
    "this is due to a result by kasteleyn , who gave a classical algorithm for the exact evaluation of the ising partition function of any planar graph in the absence of an external magnetic field @xcite .",
    "according to our definition of ces quantum circuits ( definition [ def : ces ] ) , all we need is to be able to obtain the evaluation in a time polynomial in the number of qubits ( which translates to the number of vertices ) , and the desired number of bits of precision of @xmath167 , which is achieved by the algorithm given in @xcite .",
    "now , since @xmath244 [ eq .  ( [ eq : element ] ) ] , and for any graph in @xmath191 we have an efficient way of classically determining @xmath245 , we are thus able to determine the matrix element @xmath246 for any quantum circuit in @xmath200 efficiently .",
    "it follows from lemma lem : decision that any quantum circuit in @xmath200 which solves a decision problem is ces .",
    "we remark that this technique can be used to prove that quantum circuits which correspond to non - planar classes of graphs for which the ising partition function has efficient classical evaluation schemes , e.g. , graphs of bounded tree width , are ces .",
    "we suspect that some of the results obtained in ref . @xcite may be reproduced in this way .",
    "we further remark that due to algorithms for planarity testing , given a quantum circuit one can test if it belongs to the class @xmath200 of ces quantum circuits .",
    "for example , a simple test follows from the eulerian criterion of planarity : @xmath247 where @xmath13 is the number of edges and @xmath14 is the number of vertices .",
    "( this follows from the application of a handshaking lemma to the famous relation @xmath248 , where @xmath249 is the number of faces @xcite . )",
    "examining the close relationship between the circuit representation @xmath91 and the incidence matrix @xmath158 , one can give the restriction @xmath250provided that the universal gate set consists of rotations about products of pauli operations . a circuit @xmath53",
    "for which eq .",
    "( [ euler ] )  holds generates a planar graph @xmath8 via the mapping we have described .",
    "provided eq .",
    "( [ eq : w ] ) has a non - trivial solution @xmath122 , it follows that @xmath53 is @xmath169-compatible , and hence ces by planarity of @xmath8 .",
    "our motivation in this subsection is to present a result on ces quantum circuits which allows a comparison to the recent results presented in @xcite and @xcite . in both papers ,",
    "results dependent on quantum gates being restricted to nearest neighbor qubit operations in one dimension are presented . via our construction",
    "we derive a similar result , but show that the restriction to nearest - neighbor operations and one dimension can be lifted .",
    "we begin with a simple example .",
    "recent work in ref .",
    "@xcite demonstrates that any circuit that is built out of @xmath205-rotations and nearest neighbor @xmath251 rotations can be efficiently simulated .",
    "now assume that one is restricted to a class of planar graphs , @xmath252 , for which the number of even subgraphs scales polynomially with the number of vertices .",
    "this restriction is not necessary and is introduced merely for simplicity .",
    "let us call the corresponding set of quantum circuits ( under the mapping presented above ) @xmath253 .",
    "upon inspection of the incidence matrix of a typical graph in @xmath252 one sees that even though the majority of incident vertices are nearest neighbor , there are several that are not , no matter how one labels the vertices .",
    "for example , consider the graph depicted in fig .",
    "[ pc ] .",
    "the incidence matrix is given by @xmath254\\ ] ] and one possible circuit representation @xmath91 is given by @xmath255\\ ] ]    note that the fifth and sixth columns correspond to gates of the form @xmath256respectively .",
    "the superscripts indicate which qubit is being operated on , and thus one can clearly see that _ non - nearest neighbor interactions are possible_. this example demonstrates that our construction may extend the results in @xcite , for example , by linking together graphs like the necklace  shown .",
    "note , however , that the nearest - neighbor restriction can only be relieved slightly as most of the interactions will in fact remain nearest - neighbor . taking this example as motivation , what follows is a more  general construction which will be used to pursue a better understanding of ces circuits .",
    "we now define a simple subclass of planar graphs which have a polynomial ( in the number of vertices ) number of even subgraphs . because of planarity",
    "this class of graphs correspond to ces quantum circuits .",
    "however , note that this class of graphs is by no means an exhaustive characterization of all planar graphs which have a polynomial number of even subgraphs .",
    "a basis of the null space of the incidence matrix @xmath158 is referred to as a cycle basis .",
    "let @xmath257 be those planar graphs with @xmath258 vertices and @xmath259 edges , where @xmath260 .",
    "[ polyinv ] @xmath257 has a polynomial , in @xmath258 , number of even subgraphs .",
    "a cycle basis consists of a set of connected even subgraphs of a given graph in @xmath257 .",
    "the dimension of the null space ( or the number of elements of the cycle basis ) is in this case equal to the number of edges minus the rank of @xmath158 .",
    "recall also that the rank of the incidence matrix equals the number of edges minus the number of components ( which is one in our case ) .",
    "thus , asymptotically , one has , @xmath261now , note that the null space allows all possible sums of the basis and therefore we are left with @xmath262 elements as claimed .",
    "one could imagine graphs in @xmath257 as being sparse graphs consisting of cycles ( even subgraphs ) strung together along trees without too many branching points .",
    "this is due to the relationship between @xmath263 and @xmath258 given above .",
    "one can see that a branch without a cycle always adds an additional vertex ( one edge has two vertices ) and the only way that the relationship between vertices and edges can be satisfied is if the number of branches is kept smaller than the number of cycles .",
    "that is , there will need to be _ more cycles than edges that do not terminate at a cycle_. further , the incidence matrix of these structures , like the example above in fig .",
    "[ pc ] , will have columns that consist of nearest neighbor consecutive 1 s  for the majority of positions .",
    "this rule is broken when a tree branches and when one runs into a cycle . by theorem [ polyinv ] , this can only happen @xmath264 times .",
    "as @xmath263 is the number of gates and @xmath258 is the number of qubits in the corresponding quantum circuit , we have just proven :    a quantum circuit consisting of gates of the form @xmath265 , which act on nearest neighbor qubits except for @xmath266 gates , which can act on qubits @xmath15 and @xmath19 such that @xmath267 , is ces .",
    "note : @xmath0 operations may be included in the exponent of this operator at any position not occupied by the @xmath205 and @xmath204 operations .    the important point in the last corollary is that we allow non - nearest neighbor gates , thus extending the results of @xcite , and also jozsa:08 , where only nearest - neighbor ces  quantum circuits were considered .",
    "so far we have stressed the special role of @xmath194 and @xmath219 , which led us to the conclusion that all graphs in @xmath191 are planar .",
    "however , it turns out that we can be more specific , since we have also been able to show that @xmath192 and @xmath193 are forbidden minors for @xmath191 ( lemma [ lem : obs ] ; see appendix [ app : algo ] for a description of the proof , using mathematical software ) .",
    "in other words , there does not exist a solution to eq .",
    "( [ eq : w ] ) for the graphs @xmath192 and @xmath193 .",
    "these graphs play a role in characterizing the set of _ outerplanar graphs _",
    "@xcite , which we define next :    for any planar graph , there are regions bounded by the cycles of the graph and an unbounded region outside of all the cycles .",
    "an outerplanar graph is a planar graph for which every vertex is within the unbounded region when it is embedded in the plane such that no edges intersect .",
    "for example , the graph in fig .",
    "[ pc ] is outerplanar .",
    "more informally , a graph is outerplanar if it can be embedded in the plane such that all vertices lie on the outer ( exterior ) face . a graph @xmath8 is outerplanar iff @xmath268 ( a new vertex is connected to all vertices of @xmath8 ) is planar wiegers:06 .",
    "the characterization of relevance to us is the following analog of kuratowski s theorem for planar graphs ( described in appendix  app : graphs ) :    [ th : op]a graph is outerplanar if and only if it has no subgraph homeomorphic to @xmath192 or @xmath220 .    in other words",
    ", @xmath220 is a forbidden minor for outerplanar graphs , where @xmath220 is like @xmath194 except that one side of the bipartite graph has two vertices instead of three .    [",
    "prop : k33 - 1]if a graph is outerplanar then it does not have @xmath269 as a minor .",
    "assume that @xmath193 is a minor of some @xmath270 .",
    "then @xmath8 has @xmath220 as a minor , since @xmath220 is a minor of @xmath269 .",
    "( this is easy to see : just contract one edge and delete another . ) but by theorem [ th : op ] outerplanar graphs can not have @xmath220 as a minor , which is a contradiction .",
    "thus @xmath8 can not be outerplanar .",
    "note that the converse is not necessarily true , i.e. , not all graphs which do not have @xmath193 as a minor are outerplanar .",
    "@xmath271 and @xmath272 .    by lemma [ lem : obs ] , if @xmath243 then @xmath8 can not have @xmath192 or @xmath273 as minors . by theorem",
    "[ th : op ] and proposition prop : k33 - 1 , if @xmath274 is an outerplanar graph then it can not have @xmath275 or @xmath193 as minors either .",
    "this suggests that @xmath191 may have graphs in common with the set of outerplanar graphs .",
    "we have verified , using mathematical software , that the intersection is indeed nonempty . for example , we have found that certain trees with cycles , which are outerplanar by construction , are in @xmath191 .",
    "moreover , we have verified using mathematical software that @xmath276 , i.e. , it is not a forbidden minor for the existence of a solution @xmath122 . but @xmath220 is not outerplanar , hence there are graphs in @xmath191 which are not outerplanar ( in particular , all subdivisions of @xmath220 ) .",
    "this is interesting since some problems are np - complete for subclasses of planar graphs but solvable in polynomial time for outerplanar graphs .",
    "some examples are the chromatic number , hamiltonian path and hamiltonian circuit .",
    "another example is the page number which is one for outerplanar graphs .",
    "this means that we can embed the vertices on a line which divides the plane into two subplanes , and draw all edges in one of the subplanes without crossing . in a sense ,",
    "outerplanar graphs are easycomputationally .",
    "the fact that @xmath191 includes non - outerplanar graphs thus suggests that it may include interesting computational problems .",
    "in this section we briefly discuss two possible future directions for research .",
    "so far we have assumed the sufficient condition ( [ eq : w ] ) in order to obtain the desired equality between the partition function and the circuit matrix element @xmath224 [ eqs .",
    "( [ eq : z1 ] )  and ( [ 0u0 ] ) ] .",
    "we have also shown that a satisfying bond distribution @xmath122 can always be efficiently tested for an computed , under eq .",
    "( [ eq : w ] ) .",
    "let us now relax the constraint of eq .",
    "( [ eq : w ] ) by considering a more general way in which the desired proportionality,@xmath277can be obtained .",
    "indeed , eq .  ( [ eq : w ] ) is clearly not a necessary condition .",
    "the following construction demonstrates that it is likely that the number of cases which _ do not have a solution @xmath122 _ for the bond distribution is much smaller than the case we analyzed given by eq .",
    "( eq : w ) .",
    "note that in eq .",
    "( [ equal ] ) the powers of the @xmath164 s are the weights of the null vectors @xmath99 , that is the number of ones in @xmath99 . thus it is possible for an equality to occur for a given term in the sum in the two sides of eq .",
    "( [ equal ] ) for different @xmath99 s , as long as the weights of the @xmath99 s are equal .",
    "this gives us the constraint for the following .",
    "one can organize all the @xmath99 s in bins in terms of weights from @xmath6 to @xmath278 .",
    "let us now take bin @xmath279 , i.e. , the set of vectors of weight @xmath279 .",
    "let @xmath280 be all the null vectors of @xmath158 of weight @xmath279 .",
    "then , if for all @xmath279    @xmath281    where @xmath282 is any permutation of the numbers @xmath283 , then eq .  ( [ equal ] ) would be satisfied . clearly , eq .  ( [ eq : w ] ) is a special case of this more general condition .",
    "this demonstrates that it is likely that a satisfying bond distribution @xmath122 can be found for a given graph even if the sufficient condition ( [ eq : w ] ) can not be satisfied .",
    "loosely , this is due the fact that there are many conjunctive statements of the form ( [ conj ] ) that can be satisfying .",
    "in fact it seems likely that also non - planar graphs ( i.e. , those containing @xmath219 or @xmath194 as minors ) may have a satisfying @xmath122 according to eq .",
    "( [ conj ] ) .",
    "we leave this as a problem for future investigation .",
    "an important point concerning the more general condition ( [ conj ] ) is that we do not know if it can be efficiently tested for a satisfying bond distribution @xmath122 , let alone solved for such a @xmath122 .      as mentioned in section [ sec : ansatz ] , eq .",
    "( [ eq : element ] ) has two consequences , and our focus in this paper has been on the ability to find ces circuits using known results about the hardness of computing partition functions .",
    "let us now briefly consider the other consequence , namely the fact that if we are able to determine @xmath101 , then we are able to determine the partition function @xmath166",
    ".    a fully - polynomial randomized approximation scheme ( fpras ) for the fully - ferromagnetic ising partition function was presented in jerrum:90 .",
    "it is well known that having an fpras for the non - ferromagnetic ising model implies that @xmath284 ( randomized polynomial time ) which would be quite unexpected @xcite .",
    "it should therefore be of no surprise that no fpras for this problem has been found , even with quantum resources .",
    "however _ additive _ approximation schemes seem likely and in fact one was given in @xcite for the related potts model partition function , even though the instances that they were able to account for are not known to be bqp - complete and the hardness is in fact unknown .",
    "equation ( [ eq : element ] ) precisely relates a matrix element of a quantum circuit with the value of the partition function of the ising model for a corresponding graph instance .",
    "this means that if we could approximate the matrix element , we would have an approximation for the ising partition function .",
    "due to the hadamard test , it is well known that a polynomial estimation of this matrix element is bqp - complete .",
    "( see ref .",
    "jordan for a description of the hadamard test . ) specifically , by making @xmath285 measurements , one can either have @xmath286 or @xmath287 to precision @xmath288 , but one must keep in mind that this approximation is an additive one .",
    "this means that with some probability of success bounded below ( say by @xmath289 ) the approximation returns @xmath290 such that @xmath291where @xmath292 is a polynomially small parameter and @xmath293 is the approximation scale of the problem .",
    "note that if @xmath294 then the approximation will be an fpras @xcite .",
    "equations ( [ eq : element ] ) and ( eq : approx ) taken together quantify how a measurement of @xmath135 yields an approximation of the partition function of the ising model instance @xmath21 corresponding to the circuit @xmath53 .",
    "we have provided a construction that allows one to determine if a given quantum circuit corresponds to a class of quantum circuits which are classically efficiently simulatable ( ces ) .",
    "this was done by looking at the corresponding graph instances of the classical ising model using a mapping previously introduced in @xcite .",
    "this was then used to conclude that any class of quantum circuits which solve decision problems and are restricted to certain planar graph instances are ces .",
    "our main result is stated in theorem [ th ] , which characterizes the class of ces  circuits via the set of planar graphs @xmath191 .",
    "we have given a partial characterization of @xmath191 by stating that its obstruction set includes @xmath193 and @xmath192 ( and hence , by downward closure also @xmath295 and @xmath219 ) .",
    "an interesting open problem is to give a complete characterization of the obstruction set ; we know from the robertson seymour theorem that this set is finite , since we have proved that @xmath191 is downwardly closed .",
    "our mapping can also be used to construct a quantum algorithm for the additive approximation of the partition function . however , there are two issues .",
    "the instances we are able to handle are constrained by our use of equation ( [ eq : w ] ) which does not capture all the ways a certain bond distribution may satisfy equation ( [ equal ] ) , but which simplifies our analysis greatly .",
    "the other issue is the fact that our mapping may fail to provide information about the bond distribution of a given graph .",
    "an open problem is to obtain a better understanding of what the complexity of finding the bond distribution for a particular graph instance is .",
    "this understanding will have consequences in our knowledge of where bqp is in the complexity hierarchy , as we will be able to relate the simulatability of universal quantum circuit families with the complexity of finding bond distributions . on the other hand , it is possible that the complexity of finding bond distributions is somehow incorporated in the power of the quantum circuit that corresponds to the graph instance of the ising model , in the sense that the circuit corresponding to a planar graph ( under our mapping ) may not be ces , because the effort of obtaining the bond distribution via eq .",
    "( [ conj ] ) blocks such a simulation .",
    "this material is based upon work supported by the national science foundation ( nsf ) under grant no .",
    "phy-0802678 , and by the army research office under grant w911nf-05 - 1 - 0440 .",
    "dal thanks the institute for quantum information ( iqi ) at caltech where part of this work was done .",
    "iqi is supported by the nsf under grant no .",
    "phy-0803371 .",
    "[ sec : app ]",
    "here we review some essential definitions and theorems form graph theory needed for the results presented in this work .",
    "a good reference for these concepts is the wikipedia article on planar graphs , or ref .",
    "@xcite .",
    "a subgraph @xmath91 of a given graph @xmath8 is called a _ minor _ ( or child ) of @xmath9 if it is isomorphic to a graph that can be obtained from @xmath8 via a sequence of edge deletions , edge contractions , or deletion of isolated vertices .",
    "edge contraction is the process of removing an edge and combining its two endpoints into a single vertex .",
    "edge deletion removes an edge without removing its vertices .",
    "the set of graphs @xmath296 is _ downwardly closed with respect to minor ordering _ if whenever @xmath8 is a member of @xmath296 , then so is any minor of @xmath8 .",
    "a trivial consequence of the definition of downwardly closed sets is that every such set has an obstruction set :    an _ obstruction set _ for @xmath8 is a set of minors of @xmath8 , also called _ forbidden minors _ , with the property that they prevent downward closure .",
    "in other words , if one constructs a set of minors of @xmath8 and encounters a minor that violates the property for which downward closure is being tested , such a minor is called forbidden , and belongs to the obstruction set . now comes a seminal theorem due to robertson and seymour @xcite :    [ th : rs](robertson  seymour ) every downwardly closed set of graphs ( possibly infinite ) has a finite obstruction set , i.e. , a finite set of forbidden minors .    for our purposes",
    "an important example are the planar graphs :    a _ planar graph _ is a graph which can be embedded in the plane , i.e. , it can be drawn on the plane in such a way that its edges may intersect only at their endpoints , i.e. , edges never cross .",
    "nonplanar graph _ is a graph which can not be drawn in the plane without edge intersections .",
    "there are two particularly important nonplanar graphs , denoted @xmath219 ( the complete graph on five vertices ; complete means that each pair of vertices are connected by an edge ) and @xmath194 ( the complete bipartite graph on six vertices , three of which connect to each of the other three ) .",
    "they are depicted in fig .",
    "[ graphs ] .     and outerplanar graphs . ]",
    "planarity is characterized by wagner s theorem @xcite :    [ th : wag ] a finite graph is planar if and only if it does not have @xmath297 or @xmath194 as a minor .    in other words , if one deletes or contracts the edges of a graph and finds one of these minors , then the graph is not planar .",
    "hence @xmath219 and @xmath295 are forbidden minors ( form an obstruction set ) for planarity .    for completeness",
    "we note that an alternative characterization can be given in terms of the concept of a subdivision of a graph :    a _ subdivision _ of a graph results from inserting vertices into edges .    thus , while deletion and contraction of edges shrinks a graph down , subdivision builds it up",
    ".    two graphs @xmath8 and @xmath274 are _ homeomorphic _ if there is an isomorphism from some subdivision of @xmath8 to some subdivision of @xmath274 .",
    "a finite graph is planar if and only if it has no subgraph homeomorphic to @xmath297 or @xmath194 .    in other words ,",
    "a finite graph is planar if and only if it does not contain a subgraph that is isomorphic to a subdivision of @xmath219 or @xmath194 .    in this work",
    "we give a criterion for graph membership ( in a certain set @xmath298 which is defined in definition [ def : theta ] ) based on the existence of a solution for the system of linear equations over @xmath180 defined by eq .",
    "( [ eq : w ] ) .",
    "we want to be guaranteed that this membership has an ordering in the sense that if @xmath8 is a member , then so is every minor of @xmath8 . in other words",
    ", we are testing for downward closure . the robertson ",
    "seymour theorem guarantees that membership in our set @xmath191 is not obstructed by an _",
    "infinite _ set of graphs .",
    "however , the situation is in fact far better : membership of a graph to a fixed downward closed set can be checked by running a polynomial time algorithm for all elements of the obstruction set ( if it is known ) , since searching for a minor on a given graph only requires cubic time @xcite .",
    "in fact , checking whether a graph is planar can be done in linear time .    for completeness",
    "we include the definition of a _ hypergraph _ as our correspondence between quantum circuits and graphs is actually a mapping between circuits and hypergraphs @xcite .",
    "a hypergraph is a generalization of a graph where edges are replaced by _",
    "let @xmath299 be the set of vertices and let @xmath300 be the set of hyperedges .",
    "each @xmath301 is a collection of vertices where each @xmath302 .",
    "thus the main difference from ordinary graphs is that edges consist of arbitrary collections of vertices rather than two and thus graphs are special cases of hypergraphs . as shown in ref .",
    "@xcite , the existence of hyperedges is what gives us access to the universal gate set presented in @xcite , via the two assumptions enumerated at the end of section [ sec : mapping ] .",
    "however , the circuits that correspond to graphs is what is interesting here , as our results depend on information about the ising partition function defined on ordinary graphs .",
    "here we present the proof of lemmas [ finite - obs ] , [ graphk ] , and quad - form , which we repeat for convenience :    * lemma [ graphk ] * _ if a graph @xmath8 is a member of @xmath215 , then so is @xmath303 or @xmath217 , i.e. , the deletion or contraction of an arbitrary edge @xmath218 from a graph in @xmath190 is also in @xmath190 . _",
    "assume that @xmath243 .",
    "recall that a graph @xmath8 is an element of @xmath304 if there exists some solution @xmath122 to the set of linear equations over @xmath305 @xmath306where @xmath307 is the matrix whose rows are elements , @xmath308 , of the nullspace of the incidence matrix of the graph @xmath8 ( given as the ising instance ) , and @xmath309 is the vector whose entries are the @xmath310 .",
    "these null elements , @xmath308 , correspond to the even subgraphs of @xmath8 and will be referred to as cycles ( recall definition  [ def : even ] ) . from elementary linear algebra we know that a solution exists if @xmath309 may be written as a linear combination of columns of @xmath307 or in other words if @xmath311=\\mathrm{rank}[a^{(g)}].\\]]we must demonstrate that after we either delete or contract an edge , and arrive at the subgraph @xmath274 , we have @xmath312=\\mathrm{rank}% [ a^{(g^{\\prime } ) } ] .\\ ] ]    we shall demonstrate this with an edge deletion as the case of a contraction is similar .",
    "we begin with a given graph @xmath8 which is a member of @xmath313 .",
    "we have @xmath314 \\left [   \\begin{array}{cccccc } g_{21}^{\\prime } & g_{22}^{\\prime } & \\cdots   & g_{2s}^{\\prime } & \\cdots   &   g_{2n}^{\\prime } \\\\   0 & 0 & \\cdots   & 0 & \\cdots   & 0 \\\\   g_{41}^{\\prime } & g_{42}^{\\prime } & \\cdots   & g_{4s}^{\\prime } & \\cdots   &   g_{4n}^{\\prime } \\\\   0 & 0 & \\cdots   & 0 & \\cdots   & 0 \\\\   \\vdots   & \\vdots   & \\vdots   & \\vdots   & \\vdots   & \\vdots   \\\\   g_{v1}^{\\prime } & g_{v2}^{\\prime } & \\cdots   & g_{vs}^{\\prime } & \\cdots   &   g_{vn}^{\\prime } \\\\",
    "0 & 0 & \\cdots   & 0 & \\cdots   & 0% \\end{array}% \\right]\\ ] ]    using einstein notation this equals@xmath315   \\label{hch}\\ ] ]    keep in mind that if we were to delete an edge from @xmath8 , this would correspond to losing a column from @xmath158 which would correspond to losing , say the @xmath316 column from matrix ( [ hch ] ) . taking the lower triangular portion of matrix ( [ hch ] ) and calculating we find that the @xmath317 element of the vector @xmath309 is@xmath318+a_{m3}[a_{m1}g_{2i-1,3}^{\\prime } { g^{\\prime } } % ^{2i,1}+a_{m2}g_{2i-1,3}^{\\prime } { g^{\\prime } } ^{2i,2}]+\\cdots    \\notag \\\\ & + & a_{mk}[a_{m1}g_{2i-1,k}^{\\prime } { g^{\\prime } } ^{2i,1}+\\cdots + a_{m(k-1)}g_{2i-1,k}^{\\prime } { g^{\\prime } } ^{2i , k-1}]+\\cdots    \\notag \\\\ & + & a_{mn}[a_{m1}g_{2i-1,n}^{\\prime } { g^{\\prime } } ^{2i,1}+\\cdots + a_{m(n-1)}g_{2i-1,n}^{\\prime } { g^{\\prime } } ^{2i , n-1}]\\end{aligned}\\]]where @xmath319 is the @xmath320 element of the @xmath321 null vector of @xmath158 or the matrix element @xmath322 .",
    "now , let @xmath323    this is the portion of @xmath324 that would vanish if we were to omit the edge that corresponds to the @xmath316 column of the matrix ( [ hch ] ) .",
    "this means that if we remove this edge , we will end up with the subgraph @xmath274 and we can write@xmath325this equation is saying that the @xmath321 entry of the right hand side of @xmath306is given by the @xmath321 entry of the right hand side of @xmath326(the corresponding system of equations for the graph @xmath274 ) plus the term @xmath327 .    from the assumption that @xmath328 and by construction we have @xmath329 = \\sum_{i}\\delta _ { i}c_{i}\\]]where the @xmath330 are coefficients in @xmath180 and the @xmath331 are columns of @xmath307 , i.e. , @xmath332=\\mathrm{% rank}[a^{(g)}].$ ] thus we have @xmath333how does the matrix @xmath39 change as we go from @xmath334 by this edge deletion ?",
    "if the edge is a _ dangling edge _",
    ", i.e. , not part of a cycle , then we lose a column ( column @xmath335 ) but if the edge deletion causes the breaking of @xmath5 cycles , then @xmath39 will lose @xmath5 rows ( in addition to column @xmath335 ) , as the rows encode the cycle structure of the graph . in this case , the dimension ( or length ) of @xmath336 will be @xmath5 less than the dimension of @xmath309 and the @xmath331 will also be shorter by @xmath5 entries .",
    "we call these shorter @xmath331 , @xmath337 .",
    "further , and most importantly , @xmath338 will vanish , as mentioned . after taking this into consideration",
    "we now can conclude that@xmath339where @xmath340.$ ] thus , @xmath312=\\mathrm{rank}% [ a^{(g^{\\prime } ) } ] .\\ ] ]    the proof for edge contractions is similar .",
    "the main difference is that an edge contraction does not cause the loss of a cycle except when the edge in question belongs to a cycle of length three .",
    "thus in general , the contraction case is simpler except when dealing with cycles of length three . in this case",
    "the proof caries over in the same way .",
    "thus the set of graphs @xmath190 is downwardly closed .",
    "* lemma [ finite - obs ] * _ the obstruction set for @xmath298 is finite . _    the set of graphs @xmath191 is _ downwardly closed _ by the above lemma .",
    "one may then apply the robertson - seymour theorem ( theorem [ th : rs ] ) and immediately conclude that the number of forbidden minors of @xmath191 is finite .",
    "* lemma [ quad - form ] * _ a quadratic form _ @xmath225 _ over gf(2 )  is linear in _",
    "_  ( equal to _ _",
    "@xmath226 ) _ iff",
    "_ @xmath39 _",
    "_  is symmetric . _",
    "_    let @xmath50 be an @xmath290-dimensional column vector and @xmath39 an @xmath341 matrix , both over gf(2 ) . consider the quadratic form @xmath342 and assume that @xmath39 is symmetric :  @xmath343 .",
    "then @xmath344where in the second line we used @xmath345 [ true over gf(2 ) ] , exchanged @xmath15 and @xmath19 in the third summand and used @xmath346 .",
    "the first and third summands are equal and hence add up to zero over gf(2 ) .",
    "we are left with the , second , linear term , i.e. , @xmath347 , where @xmath227 denotes a vector comprising the diagonal of @xmath39 .",
    "next , assume that @xmath39 is not symmetric .",
    "then there exists a pair of indices @xmath348 such that @xmath349 , i.e. , @xmath350 . as above",
    ", we have : @xmath351 .",
    "consider the index pair @xmath352 in this sum :   @xmath353thus the quadratic form contains at least one non - linear ( quadratic ) term @xmath354 .",
    "note that all calculations are done modulo 2 .",
    "* input : * a graph @xmath8 for which we wish to determine if there exists some satisfying edge interaction @xmath122 that satisfies eq .",
    "( [ eq : w ] ) .",
    "specifically , we considered @xmath355 , @xmath219 , @xmath193 ( @xmath194 with one edge deleted ) and @xmath192 .      1 .   from the incidence matrix @xmath39 of @xmath8",
    "obtain the following items : 1 .",
    "all vectors @xmath308 belonging to the null space @xmath356 of the incidence matrix .",
    "these row vectors form a matrix @xmath5 .",
    "2 .   construct a matrix representation @xmath91 of the possible corresponding quantum circuits ( under the mapping presented earlier ) . from @xmath91",
    "construct @xmath357 .",
    "this matrix will have variables @xmath358 corresponding to all the possible ways that one can include or omit @xmath0 operations ( changing these affects the types of edge interactions that one obtains , if any . )",
    "form the vector @xmath40 whose @xmath320 entry is @xmath359 , where @xmath308 are the elements of the null space of @xmath360 .",
    "this is the left - hand side of eq .",
    "( [ eq : w ] ) .",
    "each entry of @xmath361 consists of linear equations whose variables @xmath358 represent the presence or absence of a @xmath0 operation in a quantum circuit that corresponds to @xmath8 .",
    "3 .   form a matrix @xmath362 whose rows are all possible bonds .",
    "produce a matrix @xmath363 whose @xmath320 row @xmath364 is equal to @xmath365 .",
    "these are all possible values of the right hand side of eq .",
    "( eq : w ) .",
    "( note that due to symmetry there will be many repeats , so that the total number of possible bonds to check is far fewer than all possible bonds . ) 5 .",
    "attempt to solve the system of linear equations @xmath366 over @xmath180 ( where @xmath31 runs from @xmath6 to the number of rows of @xmath363 ) for the variables @xmath358 . a solution for some @xmath31",
    "gives information for a specific circuit representation @xmath91 .",
    "if no solution for the @xmath358 exists , then there is no satisfying bond distribution @xmath122 for eq .",
    "( [ eq : w ] ) .",
    "this is indeed the case for @xmath194 , @xmath219 , @xmath193 and @xmath192 . if there is a solution for some fixed @xmath31 , continue .",
    "take this specific @xmath91 ( i.e. , this @xmath91 has no variables and corresponds to a specific circuit given by the solution of the @xmath358 above ) and now form @xmath367 again .",
    "this time however , @xmath40 contains no variables and is a numerical vector .",
    "thus , one now has the binary vector @xmath40 and the matrix @xmath5 .",
    "solve the linear system @xmath368 and output the edge interaction @xmath122 ."
  ],
  "abstract_text": [
    "<S> we exploit a recently constructed mapping between quantum circuits and graphs in order to prove that circuits corresponding to certain planar graphs can be efficiently simulated classically . </S>",
    "<S> the proof uses an expression for the ising model partition function in terms of quadratically signed weight enumerators ( qwgts ) , which are polynomials that arise naturally in an expansion of quantum circuits in terms of rotations involving pauli matrices . </S>",
    "<S> we combine this expression with a known efficient classical algorithm for the ising partition function of any planar graph in the absence of an external magnetic field , and the robertson - seymour theorem from graph theory . </S>",
    "<S> we give as an example a set of quantum circuits with a small number of non - nearest neighbor gates which admit an efficient classical simulation . </S>"
  ]
}