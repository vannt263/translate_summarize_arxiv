{
  "article_text": [
    "finite - difference hydrodynamics schemes find widespread use in astrophysical applications , where they are often parts of computations that involve other significant physical processes , such as external heating and radiative cooling . in this paper",
    "we consider numerical methods for establishing the accuracy of a calculation in the presence of shocks .",
    "our primary tool is testing for convergence .",
    "we require that calculations not merely converge , but converge at or near the expected asymptotic rate .",
    "this accuracy criterion should readily lend itself to automated refinement methods in which grids are made denser only when and where required for accuracy .    for our investigations",
    "we use the one - dimensional euler equations modified by the inclusion of an explicit artificial viscosity .",
    "the numerical schemes are operator - split and explicit .",
    "we describe two schemes : a _ non - conservative _ form that uses the internal - energy density as a primary variable , as is common in astrophysical calculations ( e.g. , @xcite , @xcite , and @xcite ) , and a similar _ conservative _ form that instead uses the total - energy density as a primary variable .    in this paper",
    "we investigate the performance of these schemes in simple test problems with shocks . after outlining the numerical methods in section  ,",
    "we show in section  that the non - conservative internal - energy scheme converges to incorrect solutions when shocks develop .",
    "this failure occurs when artificial - viscous lengths and gridsize are decreased proportionally , as is the usual practice .",
    "when viscous lengths are held fixed as the gridsize tends to zero , however , the scheme converges to a correct solution ( albeit to a different physical problem ) .",
    "section  discusses the performance of both schemes in a shock - tube problem .",
    "we show explicitly that the internal - energy scheme ( for a particular choice of viscous lengths ) converges toward a solution with shock speed too low by approximately  0.2% .",
    "the other , conservative difference scheme converges toward the correct solution even in the presence of the shock .",
    "( we show in appendix  a that its correct behavior is a consequence of the lax - wendroff theorem  [ @xcite ] , which we extend to operator - split schemes . )    then in section  we examine rates of convergence for the conservative scheme .",
    "we show that the presence of linear artificial viscosity ( proportional to  @xmath1 ) introduces a substantial amount of diffusion . in sequences in which the artificial viscosity vanishes with the gridsize ,",
    "the variation in diffusion has an observable effect on convergence rates for small - amplitude waves .",
    "finally , we consider a wall - shock problem , which also contains such small - amplitude waves .",
    "we consider two kinds of sequences : ( 1 )  sequences in which the artificial viscosity enters as a constant term , and ( 2 )  sequences in which it varies with the gridsize .",
    "holding the artificial - viscous lengths fixed leads quite readily to small changes and the expected convergence rate .",
    "in contrast , in the sequences where the viscosity vanishes with the gridsize , we observe that the convergence rate tends only slowly toward the rate expected .",
    "the effect of linear artificial viscosity on post - shock sound waves contributes substantially to this slowness .",
    "attempts to extrapolate solutions with different viscous lengths must cope with the variation in the widths of transitions that represent shocks .",
    "these widths closely scale with the artificial - viscous lengths , but small deviations from exact scaling behavior may pose considerable barriers to extrapolation algorithms .",
    "these deviations from scaling are the main subject of appendix  c.",
    "we refer to our two finite - difference schemes as `` internal - energy '' and `` total - energy , '' after the underlying differential equations that they represent .",
    "we consider the one - dimensional euler equations , written in the form @xmath2 \\\\",
    "\\label{euler_internal_energy }      \\frac{\\partial { e_{\\it int\\/}}}{\\partial t } &        = & -\\left(\\frac{\\partial}{\\partial x }                            \\left[\\frac{{e_{\\it int\\/}}\\,m}{\\rho}\\right ]              + p \\frac{\\partial}{\\partial x } \\frac{m}{\\rho}\\right ) \\\\    \\label{euler_total_energy }      \\frac{\\partial { e_{\\it tot\\/}}}{\\partial t } &                 = & -\\frac{\\partial}{\\partial x }                                 \\left[({e_{\\it tot\\/}}+ p)\\frac{m}{\\rho}\\right],\\end{aligned}\\ ] ] where @xmath3 is the momentum density ( here per length ) ; @xmath4 , the _ internal _ energy density ; @xmath5 , the _ total _ energy density , and @xmath6 , the pressure .",
    "the equation of state is given by the ideal gas law ; generally we take  @xmath7 .",
    "equations ( [ euler_internal_energy ] ) and ( [ euler_total_energy ] ) are alternative expressions of the conservation of energy . in the internal - energy scheme , we apply equation  ( [ euler_internal_energy ] ) ; in the total - energy scheme , equation  ( [ euler_total_energy ] ) .",
    "since we want to capture shocks automatically and so avoid the computational difficulties of shock tracking , we use an explicit artificial viscosity to generate the entropy necessary for shocks . following norman and winkler  ( ) , to the physical pressure  @xmath8",
    "we add the term @xmath9,\\ ] ] where @xmath10 is the adiabatic sound speed .",
    "the constants  @xmath11 and  @xmath12 are viscous lengths for linear and quadratic artificial - viscous terms , and parametrize their strengths .",
    "typically the artificial viscosity smears shock transitions over a region whose size is comparable to the viscous lengths . conventionally the viscous lengths  @xmath11 and  @xmath12 are chosen to be a small multiple of the gridsize  @xmath13 ; we adopt this approach for our initial investigations .    for a finite - difference representation of the equations of motion , we employ an operator - split scheme similar to the internal - energy scheme developed by norman and winkler  ( @xcite , @xcite ) .",
    "they use a staggered spatial grid , defining scalar and vector quantities at different gridpoints ; whereas our grid is unstaggered .",
    "the operator splitting proceeds as follows : for the parts of the equations  ( [ euler_density][euler_total_energy ] ) that represent advection , @xmath14}{\\partial x},\\ ] ] we use the monotonic advection scheme of van leer  ( ) .",
    "the rest of the terms are treated in three further substeps : pressure acceleration , artificial viscosity , and compressional heating . in each full timestep , we account first for each of these three terms ( in the order specified ) , and then for the advection terms .",
    "each substep generates new values of the physical variables , which then are used in the update for the next substep .    explicitly ,",
    "then , the finite - difference equations take this form : first we represent the pressure - acceleration term by @xmath15 to incorporate the artificial - viscosity terms we next use @xmath16 where values of the momentum density  updated by pressure acceleration  enter into the right - hand sides through  @xmath17 and  @xmath18 $ ] . for the gradient term , we take  @xmath19 .",
    "then , in the compressional - heating substep , the energy density is changed by @xmath20,\\end{aligned}\\ ] ] where once again the latest values of  @xmath21 ,  @xmath22 , and  @xmath23 enter the right - hand sides .",
    "the resulting values of the physical quantities enter the advection substep .",
    "the van leer procedure has the flux - conserving form @xmath24 the fluxes  @xmath25 are calculated in the upwind fashion @xmath26 , &                 \\mbox{if $ v_{j+1/2 } \\geq 0 $ , } \\\\           v_{j+1/2}\\left[\\psi_{j+1 }            - \\frac{1}{2}\\left(v_{j+1/2}\\delta t/\\delta x + 1\\right )                                                   \\nabla\\psi_{j+1}\\right ] , &                 \\mbox{if \\(v_{j+1/2 } < 0\\ ) , }        \\end{array }     \\right.\\ ] ] where @xmath27 , and ( as always ) @xmath28 .",
    "this advection scheme s monotonicity arises from van leer s definition of the gradient - like term @xmath29 where @xmath30 .",
    "the spatial accuracy of the van leer procedure is second - order , except at extrema , where the accuracy must be reduced to first order to guarantee monotonicity . after the advection substep",
    ", the update through the timestep  @xmath31 is complete .    in regions where the continuum solution is smooth , such difference schemes are consistent with the differential equations  ( @xcite ) . when discontinuities are present , however , it is not immediately obvious that truncation errors should vanish in the  @xmath32 limit .",
    "if we regard truncation errors as products of these small quantities and derivatives of the solution , then clearly it is possible that the truncation errors may remain finite even in the small - gridsize , small - timestep limit .",
    "lax and wendroff  ( ) proved that single - step _ conservative _ difference schemes , if stable and convergent , converge to weak solutions of the corresponding systems of conservation laws .",
    "this theorem can be directly extended to include operator - split , multi - step conservative schemes as well ( see appendix  a ) .",
    "we know of no such theorem or extension for non - conservative schemes , however .",
    "below we present results that show that some non - conservative schemes ( namely , our internal - energy type ) do _ not _ converge to weak solutions of conservation laws .",
    "the operator - splitting method limits the overall time accuracy to first order , and the spatial accuracy of the substeps is ( almost everywhere ) second order . for smooth flows , then , asymptotically the error per step is  @xmath33 .    in general , the need for numerical stability requires constraints on the timestep  @xmath31  ( @xcite ) .",
    "we impose two constraints .",
    "first , the timestep must everywhere satisfy the courant - friedrichs - lewy condition , @xmath34 second , since the artificial viscosity takes the form of diffusion , we enforce a `` diffusion - limiting '' condition @xmath35 to ensure these conditions , before making each update we choose the timestep to be @xmath36,\\ ] ] where @xmath37 and @xmath38 are safety factors .",
    "all of the calculations shown in this paper use  @xmath39 .    despite these stability constraints",
    ", we have found that our total - energy scheme is _ unstable _ in the limit  @xmath40 when  @xmath41 . in our experience , any given unstable calculation may be stabilized by increasing the linear artificial viscous length  @xmath11 .",
    "however , _ we discourage the use of the total - energy scheme for convergence studies . _ imposing a diffusion - limiting condition  ( [ diff - limit ] ) means that increasing the artificial viscosity forces smaller timesteps and greater computational expense .",
    "we use the scheme in the context of this paper to emphasize that our conclusions regarding the internal - energy scheme are based on that scheme s non - conservative nature .    in the calculations that we show in this paper , we observe no indications of instability .",
    "further , we have duplicated most of the total - energy calculations with the ( likewise conservative ) classic lax - wendroff scheme  ( @xcite ) in two - step form  ( @xcite ) .",
    "( some lax - wendroff calculations required reduced timesteps for stability , achieved by using a smaller safety factor  @xmath42 . )",
    "these verify that our results regarding convergence in the presence of linear artificial viscosity depend on the viscosity , not on the underlying numerical scheme .",
    "since the internal - energy equation  ( [ euler_internal_energy ] ) is not in the form of a conservation law , finite - difference schemes based on it do not conserve total energy exactly .",
    "hence , one test of its results is to compare the calculated total energy with the total energy in the initial conditions . under some conditions this scheme produces incorrect results .",
    "for the first test problem we consider a steepening wave .",
    "the initial conditions superpose a large - amplitude wave on a flat background : @xmath43 where @xmath44 ^ 2                            - \\left [ ( x - x_0)/\\delta\\right]^4 } , &                                \\mbox{if $ \\left| x - x_0 \\right| < 2\\delta $ } \\\\          0 , & \\mbox{otherwise . }",
    "\\end{array }      \\right.\\ ] ] for the amplitude we take  @xmath45 ; and for the width parameter ,  @xmath46 . in the small - amplitude limit of the inviscid equations of motion ,",
    "this waveform is a purely right - moving wave .",
    "because of non - linear effects , it steepens and forms a shock on its leading edge .",
    "( the grid is large enough that waves from the perturbation do not reach the edges ; hence no energy flows in or out the computational volume . )",
    "the viscous parameters are  @xmath47 and  @xmath48 .",
    "we refine the gridsize  @xmath13 and compare the results .",
    "figure  illustrates the behavior of the total - energy error  @xmath49 at various times as a function of gridsize  @xmath13 . at early times",
    "( @xmath50 ) the error decreases proportionally to  @xmath13 , as anticipated for this first - order accurate scheme . at late times  ( @xmath51 ) , however , at small values of  @xmath13 the energy error tends toward _ non - zero _ values . for these cases ,",
    "increasing resolution leads not to greater accuracy , but rather toward some incorrect solution .",
    "the internal - energy scheme can not be performing correctly at late times .",
    "the shock forms at @xmath52 , estimated as follows .",
    "we repeat the calculations beginning with the same initial conditions but without artificial viscosity . to forestall the onset of numerical instabilities that develop in the absence of linear artificial viscosity ,",
    "the timestep safety factor  @xmath53 is reduced to  @xmath54 .",
    "we use the characteristics moving to the right from each gridpoint at the speed  @xmath55 to find the time of first crossing , which corresponds to shock formation .",
    "close examination of the   curve in figure  suggests that it may deviate from the well - behaved curves for  .",
    "once the shock forms , the non - vanishing energy error becomes increasingly apparent .",
    "this experiment strongly suggests that the internal - energy scheme fails when the flow contains a shock .    before discussing this failure further",
    ", we introduce another measure of errors in computed solutions .",
    "define the cauchy error for a solution computed with gridsize  @xmath13 by @xmath56 =           \\int\\limits_{\\it grid } \\left|\\psi_{\\delta x}(x , t )                            - \\psi_{\\delta x / 2}(x , t ) \\right| \\,dx,\\ ] ] where @xmath57 is some physical variable ( at position  @xmath58 and time  @xmath59 ) as computed with gridsize  @xmath13 .",
    "when the numerical calculations converge to the solution of the continuum system , this error measure should behave as  @xmath60 , where  @xmath61 gives the leading - order behavior of the error . for smooth flows ,",
    "@xmath61  is simply the order of accuracy of the scheme .",
    "when discontinuities are present , however , @xmath61  depends also on the changes in the computed transition widths  @xmath62 , which should be on the order of the viscous lengths  @xmath11 and  @xmath12 .",
    "( we discuss this issue further in appendix  c. ) if the jump across the transition is  @xmath63 , then ( on dimensional grounds alone ) the shock should contribute  @xmath64 ( up to numerical constants ) to the cauchy error . when the viscous lengths  @xmath11 and  @xmath12 are taken to be proportional to the gridsize  @xmath13 , the contribution to the cauchy error should also behave as  @xmath65 .",
    "( note , however , that this is a norm - dependent statement .",
    "for example , in the commonly used  @xmath66  norm the error at shock transitions should behave as  @xmath67 . ) when computations are sufficiently well - resolved so that solutions converge as expected  that is , where @xmath61  has its expected asymptotic value  then they can be regarded as quite close to the @xmath68  result  ( @xcite ) .",
    "note , however , that the cauchy error exploits _ no _ knowledge of the exact continuum solution . in practice one often assumes that convergence at the expected rate implies convergence to the correct solution .",
    "figure  shows that the cauchy error measures for all three densities  ( @xmath69 , @xmath70 , and  @xmath4 ) decrease linearly with decreasing gridsize  @xmath13 .",
    "this shows that convergence of the cauchy error alone does _ not _ imply correct behavior of the numerical scheme .",
    "( since the cauchy errors for all three quantities behave similarly , in the rest of this paper we illustrate cauchy errors for the momentum density only . )",
    "aside from the total - energy error , we have no indications that the internal - energy scheme behaves incorrectly .",
    "no numerical instabilities appear , and the performance at pre - shock times is exactly as anticipated .",
    "the error itself is relatively small  at  @xmath71 the error in total energy approaches approximately  0.4% of the initial energy in the wave  and has likely gone unnoticed by many users of internal - energy schemes . since the scheme appears stable and convergent , this finite error clearly shows that non - conservative schemes need not converge to solutions of the conservation laws when discontinuities are present .    motivated by this hypothesis",
    ", we make the following modification : instead of scaling the viscous lengths  @xmath11 and  @xmath12 with the gridsize  @xmath13 , so that @xmath72 , @xmath73 , we treat the viscous lengths themselves as constants .",
    "this approach changes the differential equations being solved .",
    "viscous effects remain finite even as the gridsize  @xmath13 vanishes , and so shocks are replaced by smooth transitions with finite width . with this change , the internal - energy scheme behaves properly at all times .",
    "we expect errors proportional to  @xmath74 , since the scheme s first - order error is entirely temporal ( i.e. ,  @xmath75 , not  @xmath65 ) , and , by the diffusion - limiting condition  ( [ diff - limit ] ) , for sufficiently small  @xmath13 the timestep  @xmath31 is proportional to @xmath74 .",
    "we repeat the steepening - wave problem , now choosing @xmath76 and @xmath77 . in figure",
    "we see that , for sufficiently small gridsize  @xmath13 , the total - energy error  @xmath78 tends toward zero as  @xmath79 at all times .",
    "figure  shows that the cauchy error  @xmath80 $ ] also decreases as  @xmath79 at all times .",
    "the magnitudes of these errors are much smaller than their counterparts ( at the same gridsize  @xmath13 ) from the previous ( @xmath72 , @xmath81 ) calculations .",
    "this suggests that these finite - gridsize results are quite close to the solutions of the ( finite - viscosity ) continuum system .",
    "equivalently , it suggests that the cauchy errors measured in the previous calculations are dominated by the change in viscous lengths  @xmath11 and  @xmath12 , not by effects of the non - zero gridsize .",
    "although the preceding discussion has focussed on the failure of a particular internal - energy scheme with particular computational parameters , the phenomenon is more general .",
    "we have varied the size of the timestep safety factors  @xmath53 and  @xmath42 and the strengths of the viscous parameters  @xmath72 and  @xmath82 ( including setting @xmath83 ) with no improvement in results .",
    "further , we have implemented versions with norman and winkler s staggered grid , as well as several other modifications to the difference equations  ( @xcite , @xcite ) , also without improvements in results .",
    "( appendix  b details the modifications we have tested . )",
    "it is possible that the scheme may converge toward the inviscid solution if we choose to vary the gridsize  @xmath13 and viscous lengths  @xmath11 and  @xmath12 such that @xmath84 but  @xmath85 . in this situation",
    "the width of the shock representation should decrease with increasing resolution , but the number of gridpoints in the representation should increase .",
    "we do not investigate the behavior of the scheme using this procedure .",
    "the slowly decreasing values of  @xmath11 and  @xmath12 impose penalties on computational efficiency [ via the diffusion - limiting timestep condition  ( [ diff - limit ] ) ] , and it is unclear whether convergence toward a physically reasonable solution can be readily observed without choosing the viscous lengths to be nearly constants .",
    "to summarize , when the flow contains shocks ( and the limiting equations are inviscid ) , the internal - energy scheme converges toward a solution that is demonstrably wrong .",
    "this failure arises because the solution contains discontinuities and the difference scheme is non - conservative .",
    "we can recover acceptable behavior by changing the equations so that the limiting solution does not contain discontinuities .",
    "in the next section we study another test problem in which the internal - energy scheme demonstrably fails , and also show that the total - energy scheme succeeds .",
    "because we associate the failures of the internal - energy scheme with the presence of shocks , for the second test problem we consider a shock tube , as introduced by sod  ( ) . at @xmath86 a static , impermeable interface separates two states of a gas at rest . at @xmath87",
    "the barrier disappears , and a shock then forms . because the problem admits a similarity solution that can be found exactly , it is an ideal test problem for shocked flows .",
    "we test the performance of both the non - conservative , internal - energy scheme and the conservative , total - energy scheme .",
    "the exact solution can be constructed as follows  ( @xcite ) : since neither the equations of motion nor the initial conditions contain a characteristic length , all interfaces must travel at constant speeds away from the initial discontinuity .",
    "a  shock propagates into the low - pressure region ; a rarefaction wave , into the high - pressure region .",
    "the gas between these two transitions travels at a constant speed and is uniform , except at a single point at which the density may be discontinuous , the contact discontinuity .",
    "the rankine - hugoniot jump conditions relate the upstream velocity , pressure , and density to the uniform middle region s conditions .",
    "the transition across the rarefaction wave can be obtained by noting that the flow in this region is adiabatic , and so the physical quantities can be determined with the method of characteristics .",
    "only one possible shock and one possible rarefaction wave allow the velocity and pressure to match in the middle region ; we determine these numerically , since the relations are implicit .    with the exact solution in hand",
    ", we can test both internal - energy and total - energy schemes .",
    "we use sod s initial conditions . on the left side of the grid ,",
    "the pressure and density are given the values  @xmath88 ; on the right , the pressure is  @xmath89 and the density is  @xmath90 .",
    "( at the interface we give these quantities their averaged values . ) in this section only the equation of state is given by a @xmath91 ideal gas .",
    "figure  dramatically illustrates the failure of the internal - energy scheme .",
    "( in the shock - tube calculations , we use @xmath92 . )",
    "we show the density in the region around the shock jump at  @xmath93 and compare the results of the two numerical schemes with the exact solution .",
    "although the computed solutions appear well - behaved and free of instabilities , two problems with the internal - energy solution are apparent : first , the shock transition is in the wrong place ( the shock velocity is 0.2%  too low ) , and second , the post - shock density is wrong ( 0.3%  too high ) .",
    "further , the total - energy scheme gets both of these right ; aside from a small post - shock oscillation , it exhibits _ no _ numerical difficulties . in figure",
    "we show the total - energy error accrued by the internal - energy scheme at various resolutions , and again this diagnostic verifies that the scheme does not converge toward a correct solution .    in figure",
    "we show the cauchy error measures  @xmath94 $ ] associated with both schemes calculations . for each",
    ", the errors decrease with decreasing gridsize ; in fact , the quantities are almost identical .",
    "as before , however , we already know that the internal - energy scheme does _ not _ converge to the correct solution .",
    "the _ rate _ of convergence appears _ poorer _ than  @xmath65 .",
    "we trace this slow convergence to the presence of contact discontinuities , which can present special problems to numerical schemes .",
    "we observe the correct rate of convergence when we alter the initial conditions to remove the discontinuity .",
    "this change removes much of the shock - tube problem s usefulness as a test problem , though , since the time evolution is no longer given by a similarity solution .",
    "( in the next section , in which we discuss rates of convergence , we use a test problem with smooth initial conditions that does not contain contact discontinuities . )    unlike shocks , contact discontinuities do not develop in smooth flow .",
    "similarly , the smoothed regions that represent contact discontinuities do not tend to steepen .",
    "thus effects of non - zero gridsize cause them to spread without limit , rather than toward some steady state . for a contact discontinuity in an isobaric medium , translating at a constant speed , no length or time scales enter except the width  @xmath95 of the representation and the gridsize  @xmath13 .",
    "thus a scaling holds among  @xmath95 ,  @xmath13 , and the time  @xmath96 : we may write that  @xmath97 .",
    "it is clear that if the representation spreads without limit , then at all times  @xmath98 and so  @xmath99 .",
    "since the cauchy error accrued at these discontinuities is proportional to their widths , the cauchy error can not scale linearly with the gridsize  @xmath13 .",
    "( we might expect that this diffusion process would lead the width  @xmath95 to behave asymptotically [ as  @xmath100 as  @xmath101 .",
    "instead , however , using the total - energy scheme we find that a calculation involving only the advection of contact discontinuities suggests that asymptotically @xmath95  varies as  @xmath102 . )    for the shock tube , as in the steepening wave , the internal - energy scheme appears stable and convergent but fails to converge toward a correct solution .",
    "the lax - wendroff theorem shows that the conservative , total - energy scheme should converge toward a correct solution , and all indications are that it does so .    in brief , when the artificial - viscous lengths  @xmath11 and  @xmath12 are proportional to the gridsize  @xmath13",
    ", the calculations of our internal - energy scheme do not converge to the known shock - tube solution ; while those of our total - energy scheme do approach the exact solution .",
    "this result reinforces our finding that the internal - energy scheme fails in the presence of shocks .",
    "further , the cauchy errors  ( [ cauchy ] ) for the ( correct ) total - energy scheme and the ( errant ) internal - energy scheme are nearly _ indistinguishable_. use of convergence tests alone can not guarantee convergence to the correct solution .",
    "since the internal - energy scheme is unreliable when shocks are present , we employ the total - energy scheme exclusively for our discussion of convergence rates .",
    "the diffusive effects of linear artificial viscosity introduces a noticeable amount of diffusion even to linear perturbations .",
    "we first discuss in some detail the impact on small , linear waves .",
    "then we show the effect on convergence rates for a wall shock  a test problem containing both a shock and small - amplitude waves .",
    "the presence of linear artificial viscosity can have a surprisingly large effect on the observed convergence rate . to illustrate these effects",
    ", we consider small - amplitude waves .",
    "first we exhibit convergence rates for calculations of such waves , and then show consistency between rates in this calculation and rates derived using an analytic treatment .",
    "finally we comment on the viscous lengths necessary to yield convergence rates close to the expected asymptotic result .    for the numerical calculations , we take as initial conditions the right - moving wave  ( [ right - moving - wave][modified - gaussian ] ) discussed above in section  3 , with amplitude  @xmath103 and width parameter  @xmath104 .",
    "we calculate to time  @xmath105 using the total - energy scheme with linear artificial viscosity only  the quadratic artificial viscous length  @xmath12 is  @xmath106 .",
    "figure  shows the cauchy errors  @xmath80 $ ] .",
    "note that instead of plotting  @xmath94 $ ] as a function of  @xmath13 ( as in figures  2 ,  4 , and  7 ) , here we show it as a function of the viscous length  @xmath11 .",
    "the computations use  @xmath107 , chosen so that the resolution is sufficiently high that purely numerical errors ( as compared with infinitely resolved computations with those values of the viscous length  @xmath11 ) are negligible . note that as @xmath11  decreases the decrease of the errors tends toward the expected linear rate ( cf .  the line segment corresponding to @xmath65  dependence ) , but only rather slowly .",
    "to quantify this tendency , for triplets of calculations we define  @xmath108/\\epsilon_{l_1}[m])/\\log 2 $ ] , which approximates the logarithmic derivative of  @xmath109 with respect to  @xmath11 . in the asymptotic regime ,",
    "@xmath110  approaches the order of accuracy .",
    "we show  @xmath110 as a function of  @xmath11 in figure  .",
    "note that even at the smallest value of  @xmath11 , @xmath110  is still rather far from the expected value of  @xmath88 even though almost two orders of magnitude separate  @xmath11 from the problem s natural length scale  @xmath111 .",
    "a simple analytic model shows such convergence rates are a consequence of the diffusive effects of linear artificial viscosity .",
    "consider the equations of motion ( [ euler_density][euler_total_energy ] ) linearized about a constant background , which ( in terms of the small quantities  @xmath112 ,  @xmath113 , and  @xmath114 ) read @xmath115 ( the background is specified by the constants  @xmath116 ,  @xmath117 ,  @xmath118 , and  @xmath119 .",
    "note that  @xmath11 is the linear viscous length , _ not _ a perturbation quantity . )",
    "we include the artificial - viscous terms , but to leading order in the small perturbations the quadratic artificial viscosity vanishes .",
    "in the _ absence _ of linear artificial viscosity  ( @xmath120 ) the linearized equations take the familiar euler form , and the three coupled equations can be rewritten as three _ decoupled _ equations , @xmath121 where  @xmath122 and  @xmath123 , for modes that propagate along the three characteristic paths , at speeds  @xmath116 and  @xmath124 . in the _ presence _ of linear artificial viscosity ,",
    "performing the analogous transformation leads to three still coupled equations : @xmath125 note that  @xmath126 , the mode that remains still with respect to the background velocity  @xmath116 , is unaffected by artificial viscosity .",
    "we next _ assume _ that ( as in the wave example above ) one of the remaining modes is sufficiently larger than the other two so that we can neglect their influence on its propagation .",
    "calling it simply  @xmath127 , we thus obtain the equation of motion @xmath128 the left - hand side of this equation describes just the advection of the quantity  @xmath127 , so that ( with the identification of the diffusion constant  @xmath129 ) the equation is simply the heat diffusion equation @xmath130 for the quantity  @xmath131 in the frame of reference that moves at the speed  @xmath124 .",
    "we study the convergence of solutions of the heat equation  ( [ heat ] ) as the diffusion coefficient  @xmath132 tends to zero .",
    "we consider the time evolution of a gaussian pulse .",
    "an _ exact _",
    "solution for  @xmath133 is @xmath134 where  @xmath135 is the initial  ( @xmath87 ) amplitude and  @xmath136 is the initial width of the pulse . with this solution",
    "it is straightforward to calculate the cauchy error ( at a fixed time  @xmath96 ) associated with a sequence of solutions in which the viscous parameter  @xmath132 varies . in figure",
    "we show the cauchy error  @xmath137 $ ] evaluated at  @xmath105 using an amplitude  @xmath138 and width  @xmath139 .",
    "( we choose different values for the width parameters in this treatment and in the calculations described above because the shape of the initial conditions differs . ) again the convergence rate  @xmath110 , shown in figure  , becomes close to the expected value of  @xmath88 only at quite small values of the diffusion  @xmath132 . in the context of the flat background of the previous calculations",
    ", we require values of the viscous length  @xmath140 much smaller than the natural length scale  @xmath136 to achieve values of  @xmath110 close to  @xmath88 .    to determine how small the diffusion coefficient  @xmath132or , equivalently , the viscous length  @xmath11must be in order to achieve a convergence rate  @xmath110 close to the asymptotic value of  @xmath88 , we examine the _ pointwise _ convergence of the exact solution  ( [ exact - heat ] ) of the linearized problem .",
    "that is , for any values of  @xmath141 , consider the behavior of  @xmath142 as  @xmath143 .",
    "we assume that , for sufficiently small values of  @xmath132 , we may approximate @xmath144 we determine the value of  @xmath145 at which the first and second terms on the right - hand side are equal .",
    "the asymptotic regime for convergence lies at values of  @xmath132 much less than  @xmath146 .",
    "the calculation itself is elementary and yields @xmath147 the analogous quantity for the viscous length is @xmath148    loosely , the convergence rate for the cauchy error is a weighted ( spatial ) average of the pointwise convergence rate . since the main contribution to the error comes from a region within a few widths  @xmath136 of the spatial origin , we replace the dimensionless ratio in equation  ( [ l1-crit ] ) by  @xmath149 .",
    "thus , the asymptotic regime for the cauchy error should lie at values of the viscous length  @xmath11 much less than @xmath150 note that _ smaller _ values of  @xmath11 are required as the time  @xmath96 increases to achieve the same convergence rate .    in practice",
    ", one may wish to increase the resolution of a computation until the convergence rate  @xmath110 is within some tolerance  @xmath151 of the asymptotic value ( here ,  @xmath88 ) .",
    "assume [ as above , in equation  ( [ error - analytic ] ) ] that for small  @xmath152 the error behaves as @xmath153 where  @xmath154 specifies the value of  @xmath152 at which the two terms on the right - hand side contribute equally .",
    "the logarithmic derivative of the error  @xmath155 with respect to  @xmath152 is then simply @xmath156 to attain a convergence rate within  @xmath151 of  @xmath88 , we must use values of  @xmath152 less than approximately  @xmath157 .",
    "( comparison with the results shown in figures     and  suggest that this estimate is about right for the analytic model and too high for the numerical calculations by a factor of a few . )      as noted above , even for the reliable total - energy scheme our results for the shock - tube problem do not yield the expected @xmath65  rate of convergence .",
    "this is a consequence of the shock tube s discontinuous initial conditions . for our final test problem ,",
    "we choose one that contains a shock , smooth initial conditions , and small - amplitude waves : a wall shock .",
    "gas impinges on a wall at  @xmath158 . for uniform , supersonic flow from the right ( @xmath159 ) , a shock will form and move outward . for initial conditions we place a transition between density , momentum , and energy values appropriate to a mach  2 steady - state shock .",
    "( in the equation of state we again use  @xmath7 , as in the study of the nonlinear sound wave . )",
    "we mediate between upstream and downstream states with a smooth transition function : @xmath160 where the transition function is @xmath161\\tanh{\\frac{35}{12}(x-6 ) } , &                           \\mbox{if $ 3 < x",
    "< 9 $ }             \\\\         b , & \\mbox{if $ x > 9$. }       \\end{array }     \\right.\\ ] ] at the left edge ( at @xmath158 ) we use reflecting boundary conditions , but for the tests reported here we stop the calculations at  @xmath162 before any physical perturbations reach either edge of the computational grid .",
    "although the initial conditions do not represent the exact , steady - state profile for a shock transition , one quickly forms and translates away from the wall .",
    "waves form and propagate away from the shock toward the wall .",
    "figure  shows these structures in the density .",
    "we have performed many calculations parameterized by the viscous length  @xmath163 and the gridsize  @xmath13 .",
    "we use these to form two types of sequences : first , with the viscous parameter  @xmath164 held constant , and second , with the viscous length  @xmath152 held constant as  @xmath13 varies .",
    "figure  shows the cauchy error  @xmath94 $ ] , again as a function of the viscous length  @xmath152 .",
    "each of the five solid lines represents a sequence with constant  @xmath164  ( @xmath165 ) .",
    "first , note that over the range of gridsizes  @xmath13 in which we can reasonably calculate , the convergence rate tends toward  @xmath65 but does not approach it unambiguously .",
    "note also that the magnitude of the errors is almost entirely a function of the viscous _ length _  @xmath152the solid lines overlap . that is , the particular choice of gridsize has only a small effect on the cauchy error .",
    "the difficulty of achieving the expected convergence rate in these sequences must be an effect of the changing values of the viscous lengths , not of the finite resolution .",
    "we attempt to isolate the effect of the shock transition on the cauchy error by changing the limits of integration in its definition  ( [ cauchy ] ) to include only the transition region or to exclude it .",
    "figure  also shows in dotted lines the error associated with the transition region  ( @xmath166 ) , and in dashed lines with the transients in the rest of the flow  ( @xmath167 ) . note that the transition region yields the expected @xmath65  convergence rate at relatively large values of the gridsize  @xmath13 . the more slowly decreasing contribution to",
    "the cauchy error appears in the region of the transients .",
    "the cauchy error for the shock transition should asymptotically be proportional to the viscous length  @xmath152 , as discussed above , and so its convergence rate implies that transition widths are indeed scaling with  @xmath152 .",
    "( appendix  c discusses the small deviations from exact scaling in shock transition regions . )",
    "figure  shows again cauchy errors as a function of gridsize  @xmath13 . here , however , each solid line represents a set of calculations with a _ fixed _ value of the viscous length  @xmath152 .",
    "we show only calculations with the gridsize  @xmath13 sufficiently small that the timestep  @xmath31 is always determined by the diffusion condition  ( [ diff - limit ] ) ; then the errors should ( asymptotically ) be  @xmath168 .",
    "it is clear that these calculations lie in the asymptotic regime : the errors are nearly proportional to  @xmath74 .",
    "we use the _ same _ calculations to construct figures     and  .",
    "when considered as part of sequences with constant  @xmath152 , they unambiguously lie in the asymptotic regime ; whereas when considered as part of sequences with constant  @xmath164 they do _ not . _",
    "we illustrate this dichotomy in figure  : each circle represents a calculation , and lines represent the sequences to which each belongs . for triplets of calculations in sequences ,",
    "we calculate the numerical convergence rate  @xmath169/\\epsilon_{\\delta x}[m])/\\log 2 $ ] , which approaches the order of accuracy in the asymptotic regime .",
    "values of  @xmath170 are shown on the lines that define the appropriate sequences of calculations .",
    "for each sequence , where we expect the errors to behave asymptotically as  @xmath171 , we find that  @xmath172 to several decimal places .",
    "for sequences of  @xmath173 calculations the closest we can achieve to the expected value  ( @xmath174 ) is  @xmath175 .",
    "the cauchy errors in the  @xmath176 sequences are larger in magnitude than those in the sequences ( compare figures     and    ) .",
    "the smallness of the latter errors and the attainment of the expected convergence rate shows that errors in the former sequences are dominated by the effects of changing viscous lengths , _ not _ of insufficient resolution .",
    "the apparently poor convergence rate in the post - shock region can be related ( at least in part ) to the discussion of small - amplitude waves above in section  5.1 .",
    "the features in the post - shock region  ( cf .",
    "figure     ) consist of relatively small - amplitude waves .",
    "a considerable contribution to the integrand defining the cauchy error  ( [ cauchy ] ) comes from the region near  @xmath177 , where a left - moving wave lies . from the previous discussion , for this wave alone",
    "we require much smaller viscous lengths  @xmath152 to attain a numerical convergence rate  @xmath110 within a few percent of  @xmath88 .",
    "( we have deemed this to be computationally infeasible . )",
    "this explanation implicitly assumes that the waves generated as the shock forms do not vary with the viscous length  @xmath152 .",
    "the width of the shock transition , varies as the viscous length , however , and so some post - shock waves ( also varying as  @xmath178 ) must arise from the different transition widths . along a sequence",
    "in which @xmath176 , these waves with short length scale should make a contribution of order @xmath65 to the cauchy error .",
    "the effect of the other ( long length scale ) waves on the numerical convergence rate continues to increase with time ( i.e. , @xmath110  is further from  @xmath88 ) , and so ultimately the effect of these should be greater than that of the short - wavelength waves .    by studying this relatively simple test problem , we find that we can readily attain the expected  @xmath171 convergence rate in sequences in which the viscous lengths  @xmath11 and  @xmath12 are constants .",
    "we emphasize that in such sequences the  @xmath0 limit does _ not _ correspond to the euler equations  ( [ euler_density][euler_total_energy ] ) . in sequences in which the ratios  @xmath72 and  @xmath82 are constants , attaining the expected  @xmath65 convergence rate appears more difficult .",
    "the difficulty is tied to the changes in viscous lengths , not to numerical errors introduced by non - zero gridsizes .",
    "we attribute it to the diffusive effects of linear artificial viscosity on waves that are generated as the shock forms .",
    "we have investigated the use of convergence tests to assess the accuracy of finite - difference solutions to the euler equations in the presence of shocks .",
    "we find that a non - conservative internal - energy scheme does not converge to solutions of the continuum equations .",
    "use of the cauchy error does _ not _ detect this significant failure .",
    "the lax - wendroff theorem applies to our total - energy scheme ( as shown in appendix  a ) , however , and so it provides reliable results .",
    "our identification of this failure with the presence of shocks leads us to introduce a modification of the equations of motion , in which the artificial - viscous terms are held constant as the gridsize varies , rather than scaled with the gridsize . in such modified systems , smooth transitions replace shock discontinuities .",
    "with the discontinuities removed , the internal - energy scheme converges as expected , without the indications of the problems that signal the failure of the unmodified system .    for well - behaved schemes ,",
    "convergence at the expected rate can be used as a clear indicator of accuracy , a particularly unambiguous criterion in automated contexts . diffusion due to linear artificial viscosity can lead to convergence difficulties . by investigating a wall shock with smooth initial conditions , however , using our definition of cauchy error to provide the criterion for convergence , we readily achieve the expected convergence rate when the artificial - viscous terms are held constant , and approach it when the artificial - viscous terms vanish with the gridsize .    finally , we have investigated the possibility of using the calculations that establish our numerical convergence rate in extrapolations . in sequences in which the artificial viscosity scales with the gridsize",
    ", we find that transitions that represent shocks deviate in several ways from exact scaling .",
    "our findings on extrapolations and scaling can be found in appendix  c.    we wish to thank sam finn , matt choptuik , john hawley , mordecai mac  low , jim stone , and paul woodward for helpful discussions .",
    "this research has been carried out at cornell university with the generous support of the nsf  ( ast-8657467 ) under the pyi  program and nasa  ( nagw-2224 ) under the ltsa  program .",
    "pak  wishes further to acknowledge the support of an nsf  graduate fellowship .",
    "some computations reported herein were carried out using the resources of the cornell theory center , which receives major funding from the  nsf and ibm  corporation , with additional support from new york state science and technology foundation and members of its corporate research institute .",
    "we discuss in this appendix the extension of the lax - wendroff theorem to multi - step , operator - split schemes .",
    "this theorem was originally presented by lax and wendroff  ( ) ; our discussion follows their treatment .",
    "write the system of conservation laws as @xmath179 where  @xmath180 is an unknown vector function of  @xmath58 and  @xmath96 and  @xmath181 is a given vector function of  @xmath180 .",
    "the theorem requires that the difference equations be written in the form @xmath182 where  @xmath183 .",
    "the numerical flux  @xmath184 is determined in the following fashion : @xmath185 , where  @xmath186 is a vector - valued function of  @xmath187 vector arguments , which is related to  @xmath181 by the _",
    "single _ requirement that @xmath186  approach  @xmath181 , in the sense that @xmath188 if , in the limit  @xmath32 , @xmath189  converges ( boundedly , almost everywhere ) to some function  @xmath190 , then  @xmath190 is a weak solution of  ( [ pde ] ) .",
    "we claim that the proof also holds if the numerical flux  @xmath184 is given by a vector - valued function  @xmath186 of vector arguments and a ( scalar ) parameter ,  @xmath191 , such that @xmath192    operator - split schemes satisfy this condition , as we now explain .",
    "write the continuum equations  ( [ pde ] ) as @xmath193 where we take the number of substeps to be 2 ( for notational simplicity ) .",
    "the difference equations will consist of two substeps to represent the equations @xmath194 sequentially .",
    "that is , the first substep takes the form @xmath195 where  @xmath196 represents the set of all relevant  @xmath197 .",
    "the resulting set  @xmath198 enters the second substep @xmath199 we assume that the substeps numerical fluxes  @xmath200 and  @xmath201 are consistent with the substep fluxes  @xmath202 and  @xmath203 in the sense of  ( [ consistency ] ) .",
    "the split scheme can be rewritten in the awkward one - step form @xmath204                         \\label{defines - g } \\\\          & = & v_j + \\frac{\\delta t}{\\delta x } \\delta { \\cal g},\\end{aligned}\\ ] ] where  @xmath205 is defined by the quantity in the square brackets .",
    "since the scheme can be written in the conservative form  ( [ update ] ) , we now establish that the numerical flux  @xmath206 satisfies the extended consistency requirement  ( [ consistency - extension ] ) .",
    "let all of its vector arguments approach the value  @xmath207 , while  @xmath208 approaches some constant , finite value",
    ". then  @xmath209 must vanish ( since  @xmath200 is a continuous function of its vector arguments where all of them are equal ) , and so essentially  @xmath206 becomes  @xmath210 .",
    "since each of  @xmath200 and  @xmath201 are consistent with  @xmath202 and  @xmath203 , then  @xmath206 must be consistent with  @xmath181 .",
    "in this appendix we describe changes made to the internal - energy scheme , whose basic form is given in section  2 .",
    "we emphasize that _ none _ of these changes affects the conclusions of sections  3 and  4 : the scheme still converges to solutions that are demonstrably incorrect .",
    "the viscous lengths  @xmath11 and  @xmath12 and the timestep safety factors  @xmath53 and  @xmath42 were varied in ranges given .    [ cols=\"<,<\",options=\"header \" , ]     \\2 .",
    "a staggered grid allows cleaner implementation of the van leer advection scheme .",
    "the vector quantities  velocity and momentum  are stored at gridpoints midway between the gridpoints for the remaining ( scalar ) quantities .",
    "this requires that every difference equation be modified : pressure acceleration  ( [ pressure_acceleration ] ) becomes @xmath211 the artificial - viscosity difference equations  ( [ art - visc - momentum ] , [ art - visc - internal ] ) become @xmath212 where now @xmath213 . the compressional heating equation  ( [ comp - heat - difference ] ) becomes @xmath214 the van leer advection procedure is virtually unchanged for scalar quantities .",
    "the velocity at the staggered gridpoints is taken to be  @xmath215 .",
    "for the momentum ( a vector quantity ) , the velocity at the other gridpoints is taken to be  @xmath216 .",
    "\\3 . as in norman and winkler  ( ) and stone and norman  ( ) , the pressure - acceleration term in the momentum equation  ( [ euler_momentum ] ) can be replaced by @xmath217 the difference equation for the physical pressure  ( [ pressure_acceleration_staggered ] ) must be replaced by @xmath218 and that for the artificial - viscosity term  ( [ momentum - art - visc - staggered ] ) , by @xmath219    \\4 . in norman and winkler  ( ) and stone and norman  ( ) , energy conservation is improved by using a `` time - centered pressure '' ( as in  @xmath220 ) on the right - hand side of the compressional - heating term of the internal - energy equation  ( [ euler_internal_energy ] ) , then applying the equation of state to replace the pressure with the internal - energy density .",
    "the substep then can be expressed as @xmath221 which replaces  ( [ comp - heat - difference ] ) .",
    "consistent - transport advection  ( @xcite ) is said to improve local conservation of certain quantities .",
    "the advection of mass density remains the same .",
    "the remaining quantities are treated `` consistently '' with the mass density . in the van leer advection substep ,",
    "the momentum , rather than the velocity , moves the quantities over the grid . in the procedure for calculating the fluxes  @xmath25",
    ", the momentum density field replaces the velocity field , and ( to compensate for the extra factor of mass density ) the specific densities  @xmath222 replace the densities  @xmath223 themselves .",
    "in the main body of this paper , we adopt the attitude that we may regard a calculation as reliable if we can show that it lies within the asymptotic regime ( i.e. , if its errors are converging as expected ) .",
    "since such a determination uses several calculations at different gridsizes , it is then straightforward to attempt to calculate an even more accurate solution by extrapolating the set of calculations .",
    "we first consider the wall - shock problem of section 5.2 . because its physical structure is relatively simple ",
    "one shock wave and detached waves ",
    "we investigate the possibility of using the many calculations to perform extrapolations to the limit . where the flow is smooth , an extrapolation in powers of the gridsize  @xmath13 is valid .",
    "if the calculations extend into the asymptotic regime , then the extrapolations should be quite accurate .",
    "first , consider extrapolations of sequences in which the viscous lengths  @xmath11 and  @xmath12 are held constant .",
    "we use calculations for which timesteps  @xmath31 are proportional to  @xmath74 ; then the truncation error associated with each is of order  @xmath171 .",
    "we assume that , at each gridpoint in the best - resolved calculation , the results can be expressed as @xmath224 with some coefficients  @xmath225  ( @xcite ) .",
    "( the linear term is absent because the scheme is second - order . )",
    "extrapolation of  @xmath226 calculations finds the value of @xmath227 by eliminating the first  @xmath228 error terms . where values are required from calculations at points other than gridpoints , we interpolate using polynomials to an order of accuracy at least that of the eventual extrapolated result .",
    "the extrapolations are well - behaved and apparently more accurate than their component calculations .",
    "we illustrate this accuracy in figure  by means of a cauchy error obtained using extrapolations .",
    "the extrapolations , for which  @xmath229 , use calculations ( with gridsizes differing by factors of  @xmath230 ) from  @xmath231 down to the value of the gridsize indicated on the horizontal axis .",
    "the error decreases markedly with increasing resolution ( which also corresponds to more extensive extrapolation ) .",
    "next , consider extrapolations in which the viscous parameter  @xmath232 is held constant .",
    "( for these extrapolations we assume that the errors take a form similar to that in equation  ( [ richardson ] ) , but _ include _ the term linear in the gridsize  @xmath13 , because of the first - order accuracy . ) figure  shows the density as extrapolated from a sequence with  @xmath233 .",
    "( this sequence includes the calculation illustrated above in figure  12 . )",
    "qualitatively , the results appear poor in the region of the shock , but sensible in the remainder of the flow .",
    "the sharp features of the waves are by the extrapolation , even though some features must result from the formation of the shock discontinuity . in the shock region , representations of shocks approach discontinuities in the  @xmath0 limit . hence , although the cauchy error measure  @xmath234 $ ] for the entire flow approaches the expected  @xmath65 behavior , near the shock the pointwise behavior of the error _ can not _ lie in the asymptotic regime .",
    "although pointwise extrapolation of a sequence of calculations fails near shocks when the viscous lengths  @xmath11 and  @xmath12 change within the sequence , one might try to devise a special procedure for extrapolation in shock regions .",
    "any such method must consider the expected scaling of the transition region with the viscous lengths .",
    "we investigate the mechanisms that alter this scaling .",
    "we begin with a steady - state problem , the shock tube , to investigate short length scales , then move to the wall - shock problem for the influence of large - scale gradients .",
    "consider a _",
    "steady - state _ shock with uniform upstream and downstream conditions .",
    "the shock travels at constant speed , and the transition width for the shock representation must be determined by the viscous lengths  @xmath11 and  @xmath12 . for simplicity , we take  @xmath235 .",
    "transitions calculated at different viscous lengths  @xmath152 then are related by a scaling relation : @xmath236 in the region of the shock , located at  @xmath237 , where the function  @xmath238 is independent of  @xmath152 .    given two calculations  @xmath239 and  @xmath240 made with different gridsizes  @xmath13 , viscous lengths  @xmath152 , or both , we measure the deviation from exact scaling by means of the function @xmath241(\\xi , t ) =                       \\psi^{(1)}_{\\delta x^{(1 ) } } ( x_s^{(1 ) } + l^{(1)}\\xi , t )                        - \\psi^{(2)}_{\\delta x^{(2 ) } } ( x_s^{(2 ) } + l^{(2)}\\xi , t)\\ ] ] in the vicinity of  @xmath242 . calculating this deviation function",
    "requires knowing the shock positions  @xmath243 and  @xmath244 . in practice ,",
    "when comparing computations with different viscous lengths  @xmath152 , we assume that  @xmath245 and approximate the shock position by locating the intersection of the two shock representations . determining  @xmath237 in other ways does not change our results significantly .",
    "the deviation function vanishes if the calculations obey the exact scaling relation  ( [ scaling ] ) , since then @xmath246 . when it is more convenient to work with a scalar deviation measure , we calculate a norm of  @xmath247(\\xi)$ ] : @xmath248 \\right| \\right| =     \\int_{-\\eta}^{\\eta } \\left| d^{(1,2)}[\\psi](\\xi ) \\right| \\ , d\\xi .\\ ] ] to limit the investigation to the shock region , the parameter  @xmath249 should not be chosen too large ; we take  @xmath250 .",
    "we begin our discussion of deviations from scaling with the shock - tube problem , in which the shock is truly steady - state .",
    "our comparisons of calculations fall into two categories : first , we compare calculations with the _ same _ viscous length  @xmath152 ; and , second , we compare calculations with _ different _ values of  @xmath152 . in the second type , comparisons between calculations with",
    "the _ same _ value of the ratio  @xmath164 are a useful special case .",
    "( for illustrations we focus on the sequence with  @xmath251 . )",
    "before describing the causes of scaling deviations , we first discuss some useful properties of shock - tube calculations . in this problem",
    "the only length scale set by initial conditions and equations of motion is the artificial - viscous length  @xmath152 .",
    "thus solutions of the continuum equations ( including the effects of artificial viscosity ) obey the scaling property @xmath252 with  @xmath253 arbitrary , where the spatial origin is chosen at the point of the initial discontinuity .",
    "the corresponding finite - difference solutions have an analogous property .",
    "a difference solution  @xmath254 , which approximates the continuum solution  @xmath255 , may equally well be interpreted as the result of a calculation in which the values of the viscous length  @xmath152 , the gridsize  @xmath13 , and the timesteps  @xmath31 are all scaled by  @xmath253 : @xmath256 .",
    "hence , two calculations with the same value of the viscous parameter  @xmath164 made to the same time  @xmath59 at different gridsizes  @xmath257 and  @xmath258 are completely equivalent to two calculations with the same  @xmath164 and  @xmath257 , but made to the times  @xmath59 and  @xmath259 , respectively .",
    "we have identified several causes of deviations from exact scaling .",
    "first , if the two viscous lengths entering into  @xmath247 $ ] are the same , then actually it does not measure deviations from scaling .",
    "instead , it measures the truncation errors proportional to  @xmath74 of computed solutions ( as compared to the `` exact '' solution with that same _ finite _ value of  @xmath152 ) .",
    "we estimate the magnitude of these truncation errors in a calculation at a given gridsize  @xmath13 by differencing it with a calculation at the smaller gridsize  @xmath260 ( with the same value of the viscous length  @xmath152 ) . in figure",
    "we show this estimate of truncation errors as a function of the scaled spatial cordinate  @xmath261 in the shock - tube problem for calculations ( to the fixed time  @xmath262 ) at gridsizes  @xmath263 , all with the viscous length  @xmath152 chosen so that  @xmath264 .",
    "note that the results are all quite similar despite the different values of  @xmath152 and  @xmath13 . along a sequence",
    "in which  @xmath173 , the effect of truncation error is a constant in the scaled cordinate  @xmath265 .",
    "we explain this result as follows : interpret the results as a sequence in _ time _ of truncation errors at a single gridsize and viscous length .",
    "if this chosen gridsize is  @xmath266 , then figure  shows results at times  @xmath267 , respectively .",
    "it then indicates that when the transition is near steady - state , the truncation error remains nearly constant in time .",
    "the solid line in figure  shows the deviation function  @xmath268 $ ] that compares transitions calculated with viscous lengths  @xmath269 and  @xmath270 , with the gridsize chosen sufficiently small  ( @xmath271 ) so that the @xmath171  truncation errors are small .",
    "this illustrates a second source of deviations from exact scaling .",
    "we identify it as an approach to steady state , as the discontinuous initial conditions relax toward a steady - state computed transition .",
    "( the shape of the functions in figure  show that transitions are steeper than the idealized , scaling case . )",
    "this relaxation is a consequence of the artificial viscosity , and so it is reasonable that its time scale must be on the order of  @xmath272 ( where  @xmath180 is some characteristic velocity ) , which is the only time scale available in the problem .",
    "( alternatively , we may argue that the diffusion time scale for a length  @xmath62 is on the order of  @xmath273 , with diffusion coefficient .",
    "since the computed transition width evolves from zero to a value on the order of  @xmath152 , the resulting time scale is on the order of  @xmath272 . )",
    "when the ratio  @xmath274 is smaller , the transition should be closer to steady state [ i.e. , the exact - scaling transition function  ( [ scaling ] ) ] .",
    "figure  also shows ( dashed line ) the deviation function calculated with the same values of the viscous length  @xmath152 but with larger gridsizes , chosen with the same value of the ratio  @xmath251 . with such large gridsizes ,",
    "the  @xmath171 truncation error associated with either calculation is much larger in magnitude than the deviation function .",
    "the deviation function , however , is nearly identical to that in the more accurate , small - gridsize calculations .",
    "this shows a consequence of the similarity in truncation errors as a function of  @xmath261 along sequences with fixed  @xmath164 : write the result of a calculation at gridsize  @xmath13 and viscous length  @xmath152 in the vicinity of the shock as @xmath275 where the truncation error  @xmath276 depends on  @xmath13 through the ratio  @xmath164 , as discussed above .",
    "then the deviation function for calculations with the _ same value _ of  @xmath164 reduces to @xmath277(\\xi ) & = & \\psi^{(1 ) } ( x_s + l^{(1)}\\xi , t ; l^{(1 ) } )                          + { \\cal t } \\left ( \\xi , t ; \\frac{l}{\\delta x } \\right )                                                               \\nonumber        \\\\                         &    &                    \\mbox {   } - \\psi^{(2 ) } ( x_s + l^{(2)}\\xi , t ; l^{(1 ) } )                          - { \\cal t } \\left ( \\xi , t ; \\frac{l}{\\delta x } \\right ) \\\\                         & = & \\psi^{(1 ) } ( x_s + l^{(1)}\\xi , t ; l^{(1 ) } )                           - \\psi^{(2 ) } ( x_s + l^{(2)}\\xi , t ; l^{(1 ) } ) , \\nonumber\\end{aligned}\\ ] ] that is , the deviation function for calculations without truncation errors .",
    "we use this result to determine  @xmath0 deviation functions over a wide range of viscous lengths  @xmath152 , including values of  @xmath152 for which sufficiently accurate calculations ( i.e. , with small truncation errors ) are computationally infeasible . in figure",
    "we show the scalar deviation measure  ( [ deviation - scalar ] ) as a function of  @xmath152 , determined from a sequence of calculations at gridsizes  @xmath278 , with  . in the reinterpretation of these calculations as a sequence in increasing _",
    "( rather than increasing _ resolution _ ) , we have a sequence at times  @xmath279 . because the deviations result from a diffusive relaxation process",
    ", we navely expect their amplitudes to decrease exponentially with increasing time ( or decreasing  @xmath152 ) .",
    "clearly the deviations decrease , but not exponentially .",
    "( the behavior appears more similar to a power law , but it does not approach one asymptotically . in any case , we have no reason to expect such behavior . )",
    "morduchow and paullay  ( ) and morduchow and valentino  ( ) , working with a one - dimensional ideal gas with a prandtl number of 3/4 , performed an eigenvalue analysis to investigate shock stability .",
    "they found a continuum of decay rates , including values arbitrarily close to zero .",
    "if our system shares this property , then even asymptotically we should not expect to observe exponential decay .",
    "a combination of perturbation modes with a continuum of rates could imitate the observed behavior .",
    "our third and last cause of deviations from exact scaling has a simple physical origin .",
    "large - scale gradients in the flow have an effect on the structure of the transition",
    ". since transitions of different widths sample these gradients to different extents , observable deviations result .",
    "to illustrate , we consider a physical problem in which the shock itself is not in steady state , the wall - shock problem .",
    "although as  @xmath280 the shock approaches steady state , at any finite time the shock generates weak gradients in the downstream region .",
    "figure  shows deviation functions  @xmath268(\\xi)$ ] for the wall - shock problem .",
    "the two curves represent comparisons of , first ( solid line ) ,  @xmath281 and  @xmath282 ( using  @xmath283 ) , and second ( dashed line ) ,  @xmath284 and  @xmath285 ( using  @xmath251 ) .",
    "( the sense of the deviation shows that the transition is steepening ; this agrees with the smoothed initial conditions , which [ by design ] are less steep than the steady - state transition . )",
    "note the effect of the large - scale gradients downstream from the shock  unlike in the steady - state , shock - tube cases , @xmath286 tends toward non - zero values for negative values of  @xmath287 .",
    "the slope ( with respect to  @xmath265 ) with which the curve turns away from zero on the left side should be proportional to the scaling factor , i.e. ,  @xmath152 , as figure  verifies .",
    "our investigations into extrapolation procedures suggest difficulties in devising an automated extrapolation scheme that ensures a predetermined order of accuracy . extrapolating sequences with",
    "the artificial - viscous length  @xmath152 fixed appears feasible , but the improvements are small .",
    "direct pointwise extrapolation of sequences in which the viscous length  @xmath152 is chosen proportional to the gridsize  @xmath13 yields improvements away from shocks , but at the cost of reasonable behavior at shocks .",
    "finally , our studies of the scaling behavior of shock transitions suggests that computed transitions in general deviate from exact scaling behavior in ways not easily controlled ; exploiting the scaling behavior to extrapolate to zero - width shock transitions may incur errors of unknown magnitude .",
    "finn , l. s. and hawley , j. f. 1989 , unpublished report .",
    "hawley , j. f. , smarr , l. l. and wilson , j. r. 1984 , , 55 , 211 .",
    "landau , l. d. and lifshitz , e. m. 1987 , fluid mechanics , second edition , translated by j. b. sykes and w. h. reid ( oxford : pergamon ) .",
    "lax , p. and wendroff , b. 1960 , comm .",
    "pure appl .",
    ", 13 , 217 .",
    "morduchow , m. and paullay , a. j. 1971 , phys .",
    "fluids , 14 , 323 .",
    "morduchow , m. and valentino , j. v. 1979 , j. appl .",
    "mech . , 46 , 505 .",
    "norman , m. l. , wilson , j. b. and barton , r. t. 1980 , , 239 , 968 .",
    "norman , m. l. and winkler , k .- h .",
    "a. 1986 , 2-d eulerian hydrodynamics with fluid interfaces , self - gravity and rotation , in astrophysical radiation hydrodynamics , edited by m. l. norman and k .- h .",
    "a. winkler ( dordrecht : reidel ) , p. 187 .",
    "richardson , l. f. and gaunt , j. a. 1927 , phil . trans .",
    "a , 226 , 299 .",
    "richtmyer , r. d. and morton , k. w. 1967 , difference methods for initial - value problems , second edition ( new york : interscience ) .",
    "sod , g. a. 1978 , j. comput .",
    "phys . , 27 , 1 .    sod , g. a. 1985 , numerical methods in fluid dynamics : initial and initial boundary - value problems ( cambridge : cambridge university press )",
    ".    stone , j. m. and norman , m. l. 1992 , , 80 , 753 .",
    "van leer , b. 1977 , j. comput .",
    "phys . , 23 , 276 .",
    "difference between total energy in an internal - energy computation and exact total energy , as a function of gridsize  @xmath13 in the steepening - wave problem of section  3 .",
    "artificial viscosity vanishes with decreasing gridsize .",
    "each line corresponds to a different time ( from bottom to top , @xmath288 ) .",
    "when @xmath289 , the error does not tend toward zero .",
    "difference between total energy in an internal - energy computation and exact total energy , as a function of gridsize  @xmath13 in the steepening - wave problem .",
    "the viscous lengths  @xmath11 and  @xmath12 are fixed .",
    "each line corresponds to a different time ( @xmath291 ) .",
    "the region near the shock front in the shock - tube problem calculated by both internal - energy ( solid curve ) and total - energy schemes ( dashed curve ) ( at  @xmath93 , using  @xmath292 and  @xmath293 ) as well as the exact solution ( dotted curve ) .        momentum cauchy errors for a small - amplitude sound wave .",
    "the quadratic viscous length  @xmath12 is zero .",
    "the linear viscous length  @xmath11 is chosen to be  @xmath294 .",
    "the short line segment indicates a slope corresponding to  @xmath13 dependence .",
    "cauchy errors for the analytic solution of the heat equation as diffusion coefficient  @xmath143 .",
    "as discussed in the text , the linearized equations of motion in the presence of linear artificial viscosity may take this form .",
    "momentum cauchy errors for the wall - shock problem .",
    "each solid line describes a sequence of calculations in which the viscous length  @xmath299 is a constant multiple of the gridsize ; five lines represent the values  @xmath300 .",
    "the short line segment indicates a slope corresponding to  @xmath13 dependence .",
    "the dashed and dotted lines isolate the contributions from the shock - transition region ( @xmath167 ) and the rest of the flow  ( @xmath166 ) , respectively",
    ".      convergence of the momentum cauchy errors for the wall - shock problem , considered within sequences in which the viscous lengths  @xmath11 and  @xmath12 are _ constant _ ( horizontal lines ) and _ proportional to the gridsize  @xmath13 _ ( diagonals ) .",
    "numerical convergence rates  @xmath110 , shown along these sequences , measure the approach to the expected convergence rates  @xmath65 and  @xmath171 .",
    "the  @xmath171 truncation error ( estimated as discussed in text ) as a function of  @xmath261 in the shock - tube problem at  @xmath93 .",
    "the estimates are for four calculations , all with  @xmath251 , with gridsizes  @xmath305 .",
    "as discussed in the text , these calculations may also be interpreted as a sequence in time  ( @xmath306 ) at  @xmath266 .",
    "deviation from exact shock - transition scaling of density  ( [ deviation - function ] ) as a function of @xmath261 in the shock - tube problem .",
    "the solid line compares  @xmath307 and @xmath308 calculations ; the @xmath309  truncation error is negligible .",
    "the dashed line compares  @xmath307 ,  @xmath310 and  @xmath308 ,  @xmath311 calculations ; the @xmath171 truncation error for either is larger in magnitude than the function plotted here .",
    "deviation from exact shock - transition scaling of density  ( [ deviation - scalar ] ) as a function of viscous length  @xmath152 .",
    "the  @xmath171 truncation error has been removed , as described in the text , leaving the effects of relaxation toward exact scaling .",
    "deviation from exact shock - transition scaling of density  ( [ deviation - function ] ) as a function of for the wall - shock problem .",
    "the solid curve represents a comparison of  @xmath312 with  @xmath313 ; the dashed curve , of  @xmath313 with ."
  ],
  "abstract_text": [
    "<S> we investigate asymptotic convergence in the  @xmath0 limit as a tool for determining whether numerical computations involving shocks are accurate . </S>",
    "<S> we use one - dimensional operator - split finite - difference schemes for hydrodynamics with a von neumann artificial viscosity . </S>",
    "<S> an internal - energy scheme converges to demonstrably wrong solutions . </S>",
    "<S> we associate this failure with the presence of discontinuities in the limiting solution . </S>",
    "<S> our extension of the lax - wendroff theorem guarantees that certain conservative , operator - split schemes converge to the correct continuum solution . </S>",
    "<S> for such a total - energy scheme applied to the formation of a single shock , convergence of a cauchy error approaches the expected rate slowly . </S>",
    "<S> we relate this slowness to the effect of varying diffusion , due to varying linear artificial - viscous length , on small - amplitude waves . in an appendix </S>",
    "<S> we discuss the scaling of shock - transition regions with viscous lengths , and exhibit several difficulties for attempts to make extrapolations .    </S>"
  ]
}