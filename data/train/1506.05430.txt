{
  "article_text": [
    "rather than layers of physical security or obscure coding in the distribution of a classical key @xcite , quantum cryptography claims to rely on the fundamental laws of quantum physics to provide secure quantum key distribution ( qkd ) @xcite . in the simplest scheme",
    ", information is encoded on non - orthogonal states which are transmitted from alice to bob via a quantum channel .",
    "after classical procedures of error correction and privacy amplification , alice and bob are then able to distill shared secret bits @xcite .",
    "any attempt by eve at gleaning information inevitably introduces noise in the quantum channel ; by quantifying this noise , alice and bob determine how much distillation must be applied to make eve s information negligible or if there is too much noise ( breaching the _ security threshold _ ) they abort the protocol .    over the last several decades , qkd has been implemented many times , more recently even in simple network configurations @xcite . by utilizing an iterated point - to - point strategy ,",
    "a secret key may be shared with legitimate users on more distant network nodes .",
    "this strategy explicitly requires secure and trusted intermediate relay stations .",
    "however , modern communication protocols ( e.g. , tcp / ip ) rely on a more advanced ` end - to - end principle '  @xcite with simple , unreliable and untrusted relays ; any layers of security are provided by the two end - parties .    a first step in this direction has been done by ref .",
    "@xcite , which extended qkd  to the mediation of an untrusted relay , void of quantum sources ( e.g. , entanglement ) and performing a quantum measurement which generates secret correlations in remote stations .",
    "this idea of a measurement - based untrusted relay ( also known as ` measurement - device independence ' ) has been experimentally implemented with discrete variables  @xcite .",
    "more recently , the use of measurement - based untrusted relays has been introduced in continuous - variable qkd  @xcite with the aim of exploiting the advantages of bosonic systems  @xcite in terms of cheap quantum sources and highly - efficient detectors .",
    "indeed this protocol is able to achieve secret - key rates orders of magnitude higher than any protocol based on discrete - variable systems .",
    "this is possible thanks to the use of the cheapest possible quantum sources , i.e. , coherent states , combined with simple linear optics and homodyne detectors at the relay station .",
    "@xcite found that the optimal performances are achieved in the asymmetric configuration where the relay is close to one of the parties .    in this paper",
    ", we deepen the analysis of ref .",
    "@xcite considering the symmetric configuration where the relay is midway between alice and bob .",
    "despite the fact this is not the optimal setup in terms of rates and security distances , it is still very important to analyze for potential applications in network scenarios where two parties are roughly equidistant from a public server or access point .",
    "another reason for analyzing this kind of setup is in its simple analytical formulas for the secret - key rates . using these formulas",
    ", we can provide a very detailed comparison between the most important gaussian attacks against the quantum links .    in our cryptanalysis of the symmetric protocol",
    "we clearly show that , at fixed transmissivity and thermal noise on the links , the optimal eavesdropping strategy is a two - mode coherent gaussian attack , where eve injects quantum correlations in both the quantum channels leading to the relay . in this attack , these channels are combined ( via beam - splitters ) with two entangled modes , which have been prepared in a suitable einstein - podolsky - rosen ( epr ) state .",
    "such a strategy greatly outperforms the single - mode collective attack based on two independent entangling cloners which was assumed in some recent investigations @xcite .",
    "any such security analysis relying on independent attacks on the channels is therefore incomplete and opens security loopholes .",
    "the paper is organized as follows : in section  [ prot ] we describe the setup in the symmetric scenario . in section  [ eavesdropping ] we analyze its security and provide a formula for the key rate . in section  [ sym_app ] we compare the various gaussian attacks , identifying the optimal attack and the corresponding minimum key rate of the protocol .",
    "finally , in section  [ conc ] we draw our conclusions .",
    "let us consider the scenario where alice and bob do not access a direct communication link .",
    "instead they connect to a perfectly - in - the - middle relay via insecure quantum links , as shown in fig .",
    "[ scheme](a ) .",
    "the relay is untrusted , meaning that it is assumed to be operated by eve in the worst case scenario .",
    "the protocol proceeds as follows : alice and bob possess two modes , @xmath0 and @xmath1 , which are prepared in coherent states , @xmath2 and @xmath3 , with randomly - modulated amplitudes ( according to a complex gaussian distribution with large variance ) .",
    "they send these modes to the intermediate relay where the output modes , @xmath4 and @xmath5 , are subject to a continuous - variable bell detection  @xcite .",
    "this means that @xmath4 and @xmath5 are mixed on a balanced beam splitter and the output ports are conjugately homodyned : one port is homodyned in the @xmath6-quadrature with outcome @xmath7 , while the other port is homodyned in the @xmath8-quadrature with outcome @xmath9 .",
    "compactly , the measurement provides the complex outcome @xmath10 which is then broadcast over a public channel .     and @xmath11 , respectively .",
    "the relay performs a continuous - variable bell measurement with complex outcome @xmath10 , which is publicly broadcast . from the knowledge of @xmath12",
    "each party can infer the variable of the other party .",
    "( b ) entanglement - based representation of the protocol under two - mode gaussian attack . using two beam splitters with transmissivity @xmath13 ,",
    "eve injects to ancillary modes , @xmath14 and @xmath15 , prepared in a two - mode gaussian state with zero mean and cm in the symmetric normal form of eq .",
    "( [ eve - cm ] ) .",
    "see text for details.,scaledwidth=45.0% ]    to understand the working mechanism of the relay , first suppose there is no loss and noise in the links .",
    "in such a case , we have @xmath16 , so that the communication of @xmath12 creates _ a posteriori _ correlations between alice s and bob s variables .",
    "each party can easily infer the variable of the other .",
    "for instance , alice could compute the quantity @xmath17 recovering bob s encoding @xmath11 up to detection noise  @xcite .",
    "this procedure partly recalls the post - processing of the two - way qkd  protocols  @xcite .",
    "note that eve s knowledge of variable @xmath12 would be of no help to extract information on the individual variables @xmath18 and @xmath11 , i.e. , we have @xmath19 in terms of mutual information @xcite . by contrast , as a result of the broadcast of @xmath12 , the conditional mutual information of alice and bob becomes non - zero @xmath20 .",
    "thus , if eve wants to steal information , she needs to introduce loss and noise .",
    "in general , the action of eve may involve a global unitary operation correlating all the uses of the protocols .",
    "however , using random permutations of their data  @xcite , alice and bob can always reduce this scenario to an attack which is coherent within the single use of protocol .",
    "this can be a joint attack of both the links and the relay .",
    "the parties can further reduce this eavesdropping to consider a coherent attack of the links only , assuming a properly - working relay , i.e. , a relay implementing a continuous - variable bell detection . in particular",
    ", since the protocol is based on the gaussian modulation and gaussian detection of gaussian states , the optimal coherent attack of the links will be based on a gaussian unitary interaction  @xcite .",
    "see ref .",
    "@xcite for more details about this general reduction of the attack .",
    "according to the previous discussion , we can reduce the attack to a two - mode gaussian attack against the quantum links of alice and  bob .",
    "the most realistic implementation of such an attack consists of two beam splitters combining the signals with ancillary modes prepared in a generally quantum - correlated gaussian state ( more exotic gaussian attacks may be constructed using other canonical forms  @xcite ) . in particular , we will consider the symmetric configuration of this attack , where the parameters are identical for the two links , so that the performances of the protocol are invariant under exchange of alice and bob . in order to analyze this symmetric gaussian attack , we adopt the entanglement - based ( eb ) representation of the protocol , where alice s and bob s ensembles of coherent states are simulated using two epr states subject to local heterodyne detections .      the eb - representation of the protocol is described in fig .",
    "[ scheme](b ) .",
    "alice and bob possess two epr states , @xmath21 and @xmath22 , with the same covariance matrix ( cm )  @xcite@xmath23{cc}% \\mu\\mathbf{i } & \\sqrt{\\mu^{2}-1}\\mathbf{z}\\\\ \\sqrt{\\mu^{2}-1}\\mathbf{z } & \\mu\\mathbf{i}% \\end{array } \\right )   , \\ ] ] where @xmath24 , @xmath25 and @xmath26 .    by applying heterodyne detections to the remote modes , @xmath27 and @xmath28 , alice and",
    "bob prepares coherent states , @xmath2 and @xmath29 , on the other epr  modes , @xmath0 and @xmath30 , respectively .",
    "in particular , their amplitudes , @xmath18 and @xmath11 , are modulated according to a complex gaussian distribution with variance @xmath31 , that we take to be very large @xmath32 .",
    "modes @xmath0 and @xmath30 are then sent to the relay for detection .",
    "alice s and bob s modes @xmath0 and @xmath30 are mixed with ancillary modes , @xmath14 and @xmath15 , respectively .",
    "this is done by means of two beam - splitters with the same transmissivity @xmath13 .",
    "the ancillas belong to an environmental set @xmath33 in the hands of eve , and the reduced state of @xmath14 and @xmath15 is a zero - mean gaussian state @xmath34 with cm in the symmetric normal form @xmath35{cc}% \\omega\\mathbf{i } & \\mathbf{g}\\\\ \\mathbf{g } & \\omega\\mathbf{i}% \\end{array } \\right )   , ~\\mathbf{g}:=\\left ( \\begin{array } [ c]{cc}% g & 0\\\\ 0 & g^{\\prime}% \\end{array } \\right )   .",
    "\\label{eve - cm}%\\ ] ] here @xmath36 is the variance of the thermal noise injected in the beam splitters , while @xmath37  accounts for the quantum correlations between the two ancillas .",
    "( the various parameters @xmath36 , @xmath38 , and @xmath39 satisfy simple physical constraints imposed by the uncertainty principle  @xcite ) .",
    "the output modes , @xmath4 and @xmath5 , are subject to the continuous - variable bell detection ( with the outcome broadcast ) , while eve s output modes , @xmath40 and @xmath41 , together with all the other ancillary modes @xmath42 are stored in a quantum memory , which is detected by an optimal coherent measurement at the end of the protocol .",
    "note that we may consider different transmissivities , @xmath43 and @xmath44 , for the beam splitters , and an asymmetric cm with different thermal variances , @xmath45 and @xmath46 .",
    "this is the general asymmetric case considered in ref .",
    "however , when the relay is midway between the two parties , the amount of loss and noise present in the links is realistically expected to be identical . in other words , it is reasonable to consider here a symmetric attack as the one previously described , which has @xmath47    thanks to this symmetry , we can reduce the number of parameters and derive a simple analytical expression for the secret - key rate , which allows us to perform a detailed analysis of the various specific symmetric attacks which are possible against our protocol . in particular",
    ", we can easily study the performances of these attacks in terms of the correlation parameters , @xmath38 and @xmath39 , and identify the optimal one which minimizes key rate and security threshold .",
    "furthermore , due to the symmetry , alice and bob can be interchanged , which implies that there is no difference between direct and reverse reconciliation  @xcite .",
    "in other words , we can consider a unique secret - key rate for the protocol ( assuming one - way classical communication for error correction and privacy amplification ) .      without loss of generality ,",
    "we assume that alice is the encoder of information ( variable @xmath18 ) while bob is the decoder , so that he post - processes his variable @xmath11 to infer @xmath18 . in the eb - representation , these variables are informationally equivalent to the outcomes of the heterodyne detections  @xcite .",
    "to derive the rate , we note that the bell detection at the relay and the heterodyne detections of the two parties commute with each other . for this reason",
    ", we can equivalently compute the rate from the conditional state @xmath48 of modes @xmath27 and @xmath28 after the communication of the outcome @xmath12 .",
    "the rate is given by  @xcite@xmath49 where @xmath50 is alice and bob s conditional mutual information , while @xmath51 is eve s holevo information  @xcite on alice s variable ( which can be computed from the state of the output ancillas ) .",
    "since all output modes are in a global pure state and the various detections are rank-1 , we can write  @xcite@xmath52 where @xmath53 is the von neumann entropy  @xcite , computed on the post - relay state @xmath48 of alice and bob , and the double - conditional state @xmath54 of bob , conditioned to relay s and alice s detections ( computable from @xmath48 ) .",
    "both the mutual information @xmath50 and eve s holevo entropy @xmath51 can be computed from the post - relay state @xmath48 , in particular , from its cm @xmath55 . imposing the symmetry conditions of eq .",
    "( [ sym ] ) in the general expression of @xmath56 computed in ref .",
    "@xcite , we derive@xmath57{cc}% \\mu\\mathbf{i } & \\mathbf{0}\\\\ \\mathbf{0 } & \\mu\\mathbf{i}% \\end{array } \\right )   -\\frac{\\tau(\\mu^{2}-1)}{2}\\times\\label{totalcm - pr}\\\\ &   \\times\\left ( \\begin{array } [ c]{cccc}% \\frac{1}{\\tau\\mu+\\lambda } &   & -\\frac{1}{\\tau\\mu+\\lambda } & \\\\ & \\frac{1}{\\tau\\mu+\\lambda^{\\prime } } &   & \\frac{1}{\\tau\\mu+\\lambda^{\\prime}}\\\\ -\\frac{1}{\\tau\\mu+\\lambda } &   & \\frac{1}{\\tau\\mu+\\lambda } & \\\\ & \\frac{1}{\\tau\\mu+\\lambda^{\\prime } } &   & \\frac{1}{\\tau\\mu+\\lambda^{\\prime}}% \\end{array } \\right )   , \\nonumber\\end{aligned}\\ ] ] where @xmath58 note that eq . ( [ totalcm - pr ] ) represents a particular case of the general cm of eq .",
    "( [ vabcondgammagen2 ] ) , which is obtained in the appendix , where non - unit quantum efficiencies of the detectors are also included .",
    "now , we can easily compute @xcite the symplectic spectrum of eq.([totalcm - pr ] ) in the limit of large modulation @xmath59 , obtaining@xmath60 then , entropy term @xmath61 in eq .",
    "( [ iegamma ] ) can be computed using the function@xmath62 thus , we have @xmath63    to compute @xmath64 we derive the double - conditional cm @xmath65 .",
    "we put eq .",
    "( [ totalcm - pr ] ) in the block - form@xmath66{cc}% \\mathbf{a } & \\mathbf{c}\\\\ \\mathbf{c}^{t } & \\mathbf{b}% \\end{array } \\right )   , \\ ] ] and we apply a partial gaussian heterodyne measurement on alice s remote mode @xmath67given by @xcite , @xmath68 which gives@xmath69{cc}% \\mu-\\frac{(\\mu^{2}-1)\\tau}{\\tau(\\mu+1)+2\\lambda } & 0\\\\ 0 & \\mu-\\frac{(\\mu^{2}-1)\\tau}{\\tau(\\mu+1)+2\\lambda^{\\prime}}% \\end{array } \\right )   .\\label{bob - cm - cond}%\\ ] ] for @xmath59 , its symplectic eigenvalue is given by@xmath70 and we have @xmath71",
    ". we can then compute eve s holevo information , asymptotically given by@xmath72 .",
    "\\label{holevo - bound}%\\ ] ] alice and bob s conditional mutual information @xmath50 can be computed from the classical cm  @xmath73 describing their outcomes . after simple algebra , we get the asymptotic expression@xmath74 as a result , we computed the following asymptotic secret - key rate for the symmetric gaussian attack@xmath75 \\nonumber\\\\ &   + h\\left [   \\frac{\\sqrt{(\\tau+2\\lambda)(\\tau+2\\lambda^{\\prime})}}{\\tau } \\right ]   , \\label{rsym}%\\end{aligned}\\ ] ] which is function of the parameters @xmath13 , @xmath36 , @xmath38 and @xmath39 .",
    "a complete analysis of the performances of the scheme in presence of non - ideal experimental conditions is described in appendix [ app - efficiency ]",
    "for fixed transmissivity @xmath13 and thermal noise @xmath36 affecting each link , there are remaining degrees of freedom in the two - mode gaussian attack .",
    "these are given by the correlation parameters @xmath38 and @xmath39 , which can be represented as a point on a ` correlation plane ' ( see fig .  [ attackcha ] ) .",
    "each point of this plane describes an attack ( with different amount and kind of correlations ) to which it corresponds a specific key rate according to eq .",
    "( [ rsym ] ) . here",
    "we provide a detailed comparison between these attacks , showing how the optimal coherent attack greatly outperforms the collective attack based on independent entangling cloners .",
    "because of the symmetry , we have a simple characterization of the set of possible gaussian attacks which are accessible to eve .",
    "these correspond to points @xmath76 such that  @xcite@xmath77 among all these accessible attacks , those satisfying the further condition@xmath78 are separable attacks ( @xmath34 separable ) , while those violating eq .",
    "( [ sepcon ] ) are entangled attacks ( @xmath34 entangled ) .",
    "see fig .",
    "[ attackcha ] for a numerical representation .     and @xmath36 ( here set to @xmath79 ) ,",
    "the attack is fully specified by the two correlation parameters @xmath76 , whose accessible values are represented by the non - white area . in particular , the inner darker region represents the set of separable attacks ( @xmath80 separable ) , while the two outer and lighter regions represent entangled attacks ( @xmath34 entangled ) .",
    "the numbered points represent the specific attacks described in sec .",
    "[ sym_app].,scaledwidth=32.0% ]    in particular , we can identify the following attacks :    _ collective attack .",
    "_ this is the simplest attack , represented by point  ( 1 ) in fig .",
    "[ attackcha ] , i.e. , the origin of the plane ( @xmath81 ) .",
    "this corresponds to using two identical and independent entangling cloners with transmissivity @xmath13 and thermal noise @xmath36 .",
    "in fact , we have @xmath82 , where @xmath83 ( @xmath84 ) is a thermal state with variance @xmath36 , whose purification @xmath85 is an epr state in the hands of eve .    _",
    "separable attacks**. * * _ within the separable attacks we can identify points  ( 2 ) , ( 3 ) , and  ( 4 ) in fig .  [ attackcha ] .",
    "these are characterized by the condition @xmath86 and represent the separable attacks with the highest correlations .",
    "in particular , points  ( 2 ) correspond to the cases @xmath87 or @xmath88 , point  ( 3 ) corresponds to @xmath89 , and point  ( 4 ) to @xmath90 .",
    "_ epr attacks . _ finally , points ( 5 ) and ( 6 ) in fig .",
    "[ attackcha ] are the most entangled attacks , where eve s ancillas @xmath14 and @xmath15 are described by an epr state .",
    "point ( 5 ) is the ` positive epr attack ' with @xmath91 , while ( 6 ) is the ` negative epr attack ' with @xmath92 .",
    "the latter turns out to be the optimal attack against the protocol .",
    "we now compare the performances of the previous attacks in figs .",
    "[ ratescomp ] and  [ soglie ] . in fig .",
    "[ ratescomp ] we fix the transmissivity @xmath93 and we study the corresponding rates @xmath94 as function of the thermal noise @xmath36 . in fig .  [ soglie ] we plot the security thresholds .",
    "these are given by the condition @xmath95 , and they are expressed in terms of maximum tolerable thermal noise versus transmissivity @xmath96 .",
    "( bits ) versus thermal noise @xmath36  for the various symmetric attacks ( 1)-(6 ) classified in sec .",
    "[ sym_app ] and displayed in fig .",
    "[ attackcha ] .",
    "link - transmissivity is set to @xmath93 .",
    "note that the negative epr  attack ( 6 ) is the optimal attack minimizing the rate of the protocol .",
    ", scaledwidth=45.0% ]    ) expressed as maximum tolerable thermal noise @xmath36  versus link - transmissivity @xmath13 .",
    "we compare the various symmetric attacks ( 1)-(6 ) classified in sec .",
    "[ sym_app ] and displayed in fig .",
    "[ attackcha ] . the negative epr attack ( 6 ) is the optimal corresponding to the lowest security threshold .",
    "also note the peculiar inversion of the threshold for the positive epr attack ( 5 ) , for which the rate is positive for values of thermal noise _ above _ the threshold.,scaledwidth=47.0% ]    our analysis identifies good  and bad  entanglement for the security of the protocol .",
    "good entanglement refers to the entangled attacks in the bottom right area of fig .",
    "[ attackcha ] , with @xmath97 , of which the attacks ( 3 ) and ( 5 ) are border points .",
    "this entanglement is good because it injects correlations of the type @xmath98 and @xmath99 , therefore helping the bell detection ( which projects on @xmath100 and @xmath101 ) . as a result",
    ", eve actively helps the key distribution .",
    "this is evident from the performance of the positive epr attack ( 5 ) both in terms of rate ( fig .",
    "[ ratescomp ] ) and security threshold ( fig .",
    "[ soglie ] ) .",
    "in fact , from fig .",
    "[ ratescomp ] , we see that the rate is _ increasing _ in the thermal noise @xmath36 and , in fig .",
    "[ soglie ] , we see a peculiar inversion of the security threshold so that thermal noise _ above _ the threshold is tolerable .",
    "these features are typical of all entangled attacks with @xmath102 and @xmath103 , corresponding to the segment of points between ( 3 ) ( excluded ) and ( 5 ) ( included ) . in figs .",
    "[ ratescomp ] and  [ soglie ] , these attacks have curves which are intermediate between those of ( 3 ) and ( 5 ) .",
    "by contrast , bad entanglement refers to the entangled attacks in the top left area of fig .",
    "[ attackcha ] , with @xmath104 and having the attacks ( 4 ) and ( 6 ) as border points .",
    "this entanglement is instead bad because it injects correlations of the type @xmath105 and @xmath106 , which are opposite to those established by the bell detection . in this case ,",
    "eve decreases the correlations between alice s and bob s variables , and she is able to eavesdrop more information , with the optimal strategy achieved by the negative epr attack ( 6 ) as clear from the rates of fig .",
    "[ ratescomp ] and the security thresholds of fig .",
    "[ soglie ] .",
    "the asymmetric version of this attack is optimal in case of asymmetric setups  @xcite .    by comparing the curves ( 6 ) and ( 1 ) in figs .",
    "[ ratescomp ] and  [ soglie ] , we clearly see the substantial advantage given by this optimal attack with respect to the standard collective attack based on independent entangling cloners .",
    "analytically , the minimum key rate associated with the optimal attack is given by@xmath107   , \\label{rmin}%\\ ] ] with @xmath108 .",
    "one can easily check this is numerically much less than the rate of the collective attack@xmath109 \\nonumber\\\\ &   + \\log_{2}\\left\\ {   \\frac{\\tau^{2}}{e^{2}(1-\\tau)[\\tau+(1-\\tau)\\omega]\\omega } \\right\\ }   .\\end{aligned}\\ ] ]    thus , the security analysis which is valid for one - way continuous - variable qkd protocols  @xcite , and based on the study of collective ( single - mode ) entangling - cloner attacks , can not be applied to our relay - based protocol .",
    "for this reason , the studies provided by refs .",
    "@xcite are incomplete and can not prove the unconditional security of the relay - based ( measurement - device independent ) qkd with continuous variables .",
    "in conclusion , we have provided a detailed analysis of the relay - based qkd protocol of ref .",
    "@xcite , considering a completely symmetric setup under the action of symmetric attacks .",
    "despite the fact that this particular case does not represent the optimal configuration of the scheme , still it is important for its potential implementation in network scenarios .",
    "furthermore , the symmetry conditions allow us to greatly simplify the cryptoanalysis and derive simple analytical results .",
    "thanks to this approach , we have been able to provide a very detailed classification of the symmetric attacks against the protocol , characterizing the different possible strategies in terms of their correlation properties . at fixed transmissivity and thermal noise ,",
    "we have identified the optimal symmetric attack which corresponds to a coherent attack where the ancillas are maximally entangled with a specific type of epr  correlations ( negative epr attack ) . in particular",
    ", this attack greatly outperforms the standard collective attack based on independent entangling - cloners , which is therefore unsuitable for assessing the security of this kind of protocol ( contrary to the claims of other analysis @xcite ) .",
    "this also confirms the results of ref .",
    "@xcite which were given in the general case of asymmetric setups .",
    "finally our work clarifies the crucial role of quantum correlations in assessing the security of qkd  protocols which are based on untrusted relays .",
    "further studies may include the extension of this protocol to thermal - qkd  @xcite , with the aim of using different wavelengths of the electromagnetic field , e.g. , in mixed technology platforms using both optical / infrared and microwave carriers .",
    "this work was funded by a leverhulme trust research fellowship , the epsrc via ` hipercom ' ( grant no .",
    "ep / j00796x/1 ) , ` qdata ' ( grant no .",
    "ep / l011298/1 ) and the uk quantum technology hub for quantum communications technologies ( grant no .",
    "ep / m013472/1 ) .",
    "in this appendix we analyze the role of experimental imperfections computing the key - rates and the security thresholds in the presence of bell detectors with non - ideal quantum efficiencies .",
    "we also study finite - size effects connected with finite gaussian modulations  @xcite , and the role played by the non - ideal efficiency of the classical reconciliation codes  @xcite .",
    "we show that , also in the presence of realistic experimental limitations , the optimal eavesdropping is given by the two - mode coherent negative - epr attack .",
    "we generalize eq.([totalcm - pr ] ) to include detectors efficiencies by placing two beam splitters with transmissivities @xmath110 and @xmath111 , as illustrated in fig .",
    "[ relay_eff ] . to preserve the purity of the global ( alice - bob - eve ) state ,",
    "the non - detected signals are sent to eve s quantum memory ( this is the assumption to make in the worst - case scenario , since the relay is untrusted and eve can control the loss of the detectors ) .",
    "we follow the general approach given in ref .",
    "we write the total cm in the block form@xmath112{cc}% \\mathbf{v}_{ab } & \\mathbf{c}\\\\ \\mathbf{c}^{t } & \\mathbf{b}% \\end{array } \\right )   , \\label{block - general - cm}%\\ ] ] where the block @xmath113{cc}% \\mathbf{b}_{1 } & \\mathbf{d}\\\\ \\mathbf{d}^{t } & \\mathbf{b}_{2}% \\end{array } \\right )   , \\label{b - appendix}%\\ ] ] describes the modes sent to the relay , @xmath4 and @xmath5 .",
    "these are processed by the balanced beam splitter and then measured . in our case it is easy to verify  @xcite that the blocks @xmath114,@xmath115 and @xmath116 take the following expressions@xmath117\\mathbf{i,}% \\label{b1-b2}\\\\ \\mathbf{d }   &   \\mathbf{=}(1-\\tau)\\mathbf{g , } \\label{d - appendix}%\\end{aligned}\\ ] ] where @xmath118@xmath119 and @xmath120@xmath121    in eq .",
    "( [ block - general - cm ] ) the sub - matrix @xmath122 describes the joint quantum state of remote modes @xmath27 and @xmath28 , while the block @xmath123 * *  * * is a rectangular matrix accounting for the correlations between the remote modes and the transmitted ones , i.e. , @xmath4 and @xmath5 .",
    "in particular , we compute@xmath124{c}% \\sqrt{\\tau(\\mu^{2}-1)}\\mathbf{z}\\\\ \\mathbf{0}% \\end{array } \\right )   , \\text { } \\mathbf{c}_{2}=\\left ( \\begin{array } [ c]{c}% \\mathbf{0}\\\\ \\sqrt{\\tau(\\mu^{2}-1)}\\mathbf{z}% \\end{array } \\right )   .",
    "\\label{c1-c2}%\\ ] ]      applying eq .",
    "( 74 ) from ref .",
    "@xcite to eq .",
    "( [ block - general - cm ] ) , we obtain alice and bob s cm conditioned to the relay bell measurement .",
    "this is given by@xmath125 where@xmath126{cc } & 1\\\\ 1 & \\end{array } \\right )   , \\text { } \\mathbf{x}_{2}=\\left ( \\begin{array } [ c]{cc } & 1\\\\ -1 & \\end{array } \\right )   .",
    "\\label{x1-x2}%\\ ] ] here the quantum efficiencies of the detectors , simulated by the beam splitter transmissivities @xmath110 and @xmath111 , are contained in the symmetric matrix@xmath127{cc}% \\gamma_{1}(\\eta ) & \\gamma_{3}\\\\ \\gamma_{3 } & \\gamma_{2}(\\eta^{\\prime } ) \\end{array } \\right )   .",
    "\\label{gamma - m}%\\ ] ]    in the case of a bell detection the matrix @xmath128 can explicitly be computed , according to eqs .",
    "( 54 - 59 ) of ref .",
    "in particular , its entries take the form@xmath129 where @xmath130 and @xmath131 are easily obtained from eq .",
    "( [ b1-b2 ] ) and  ( [ d - appendix ] ) , using the formulas of ref .",
    "@xcite .",
    "after simple algebra we derive the post - relay cm inclusive of the quantum efficiencies@xmath57{cc}% \\mu\\mathbf{i } & \\mathbf{0}\\\\ \\mathbf{0 } & \\mu\\mathbf{i}% \\end{array } \\right )   -\\frac{\\tau(\\mu^{2}-1)}{2}\\times\\\\ &   \\times\\left ( \\begin{array } [ c]{cccc}% \\frac{1}{\\gamma_{1}(\\eta ) } &   & -\\frac{1}{\\gamma_{1}(\\eta ) } & \\\\ & \\frac{1}{\\gamma_{2}(\\eta^{\\prime } ) } &   & \\frac{1}{\\gamma_{2}(\\eta^{\\prime}% ) } \\\\",
    "-\\frac{1}{\\gamma_{1}(\\eta ) } &   & \\frac{1}{\\gamma_{1}(\\eta ) } & \\\\ & \\frac{1}{\\gamma_{2}(\\eta^{\\prime } ) } &   & \\frac{1}{\\gamma_{2}(\\eta^{\\prime})}% \\end{array } \\right )   .\\end{aligned}\\ ] ] this cm can be rewritten in the form@xmath57{cc}% \\mu\\mathbf{i } & \\mathbf{0}\\\\ \\mathbf{0 } & \\mu\\mathbf{i}% \\end{array } \\right )   -\\frac{\\tau(\\mu^{2}-1)}{2}\\times\\nonumber\\\\ &   \\times\\left ( \\begin{array } [ c]{cccc}% \\frac{1}{\\tau\\mu+\\lambda(\\eta ) } &   & -\\frac{1}{\\tau\\mu+\\lambda(\\eta ) } & \\\\ & \\frac{1}{\\tau\\mu+\\lambda^{\\prime}(\\eta^{\\prime } ) } &   & \\frac{1}{\\tau \\mu+\\lambda^{\\prime}(\\eta^{\\prime})}\\\\ -\\frac{1}{\\tau\\mu+\\lambda(\\eta ) } &   & \\frac{1}{\\tau\\mu+\\lambda(\\eta ) } & \\\\ & \\frac{1}{\\tau\\mu+\\lambda^{\\prime}(\\eta^{\\prime } ) } &   & \\frac{1}{\\tau \\mu+\\lambda^{\\prime}(\\eta^{\\prime})}% \\end{array } \\right )   , \\label{vabcondgammagen2}%\\end{aligned}\\ ] ] where@xmath132{c}% \\lambda(\\eta)=(\\omega - g)(1-\\tau)+\\frac{1-\\eta}{\\eta}~,\\\\ \\\\ \\lambda^{\\prime}(\\eta^{\\prime})=(\\omega+g^{\\prime})(1-\\tau)+\\frac { 1-\\eta^{\\prime}}{\\eta^{\\prime}}~. \\end{array } \\right .",
    "\\label{lamdas - gen}%\\ ] ] note that eq .",
    "( [ vabcondgammagen2 ] ) could have been computed directly from eq .",
    "( [ totalcm - pr ] ) by applying the transformations  @xcite@xmath133      from the previous cm we can write the sub - matrix describing bob s mode@xmath134{cc}% \\mu-\\frac{\\tau(\\mu^{2}-1)}{2[\\tau\\mu+\\lambda(\\eta ) ] } & \\\\ & \\frac{\\tau(\\mu^{2}-1)}{2[\\tau\\mu+\\lambda^{\\prime}(\\eta^{\\prime})]}% \\end{array } \\right )",
    ". \\label{vbobgamma}%\\ ] ] then , by applying eq .",
    "( [ het - formula ] ) to the generalized cm of eq .",
    "( [ vabcondgammagen2 ] ) , we derive the doubly - conditional cm of bob , conditioned to both relay s and alice s detections , i.e.,@xmath135{cc}% \\mu-\\frac{\\tau(\\mu^{2}-1)}{[\\tau(\\mu+1)+2\\lambda(\\eta ) ] } & \\\\ & \\mu-\\frac{\\tau(\\mu^{2}-1)}{[\\tau(\\mu+1)+2\\lambda^{\\prime}(\\eta^{\\prime})]}% \\end{array } \\right )   . \\label{vbgammaalpha}%\\ ] ]    we can now derive the symplectic spectra of the cms of eq .",
    "( [ vabcondgammagen2 ] ) and  ( [ vbgammaalpha ] ) .",
    "we find simple analytical expressions in the limit of large modulation .",
    "for @xmath56 we have the symplectic eigenvalues @xmath136 and @xmath137 , while for @xmath65 we have @xmath138 .",
    "these eigenvalues can be obtained by applying the transformations of eq .",
    "( [ ltrans ] ) to the eqs .",
    "( [ total - spectrum ] ) and  ( [ cond - spectrum ] ) .",
    "using these spectra , we can compute the corresponding total and conditional von neumann entropies and therefore the holevo bound . in the limit of large modulation , eve s holevo information becomes@xmath139[\\tau+2\\lambda^{\\prime}% ( \\eta^{\\prime})]}}{\\tau}\\right ]   , \\label{holevoapp}%\\end{aligned}\\ ] ] which extends eq .",
    "( [ holevo - bound ] ) to arbitrary efficiencies @xmath110 and @xmath111 .",
    "similarly , we can extend the formula for alice and bob s mutual information , which here becomes@xmath140[\\tau+\\lambda^{\\prime}(\\eta^{\\prime } ) ] } } , \\label{iab - asy}%\\ ] ] for large modulation . combining the previous results",
    ", we derive the asymptotic key - rate in the presence of detector inefficiencies@xmath141[\\tau+\\lambda^{\\prime}(\\eta^{\\prime})]}}\\right ] \\nonumber\\\\ &   + h\\left [   \\frac{\\sqrt{[\\tau+2\\lambda(\\eta)][\\tau+2\\lambda^{\\prime}% ( \\eta^{\\prime})]}}{\\tau}\\right ]   , \\label{rsym - gen}%\\end{aligned}\\ ] ] which clearly extends the formula given in eq .",
    "( [ rsym ] ) .    [ [ role - of - the - imperfections - on - key - rate - security - thresholds - and - achievable - distances ] ] role of the imperfections on key - rate , security thresholds and achievable distances ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    in this section we study in detail the combined role of the various experimental limitations and imperfections , confirming  the main findings presented in the main body of this paper .",
    "we compute the key - rate and the security thresholds considering not only the realistic quantum efficiency of the detectors , but also the use of a finite gaussian modulation and the non - ideal reconciliation efficiency provided by realistic codes for error correction and privacy amplification .      in order to extract a secret key",
    ", the honest parties must process their correlated data in stages of perform error correction and privacy amplification .",
    "this data processing is today implemented with a limited efficiency @xmath142 , for instance @xmath143@xcite . to include this limitation",
    ", we have to multiply alice and bob s mutual information by @xmath11 , and consider the realistic key - rate  @xcite@xmath144 where @xmath145 and @xmath51 are now computed considering finite modulation @xmath146 besides non - ideal detector efficiencies @xmath110 and @xmath111 ( clearly these quantities must tend to eqs .",
    "( [ holevoapp ] ) and  ( [ iab - asy ] ) in the limit of large modulation ) .",
    "( bits ) is plotted versus thermal noise @xmath36 for @xmath147 ( snu ) * * ( top - panel ) and @xmath148 ( bottom - panel ) .",
    "other parameters are @xmath93 , @xmath149 and @xmath150 .",
    "we compare two eavesdropping strategies : the collective one - mode entangling cloner attack @xmath151 ( dotted black line ) and the two - mode negative epr  attack @xmath92 ( continuous black line ) .",
    "we see that the key - rate of the two - mode attack is always lower than that of the one - mode attack . for comparison ,",
    "we have also plotted the performances in the case of ideal reconciliation ( @xmath152 ) , ideal detectors ( @xmath153 ) and large modulation ( @xmath59 ) .",
    "these ideal performances are represented by the red curves , dotted for the one - mode attack and continuous for the two - mode attack.,scaledwidth=45.0% ]    in general , the mutual information can be computed from the formula @xmath154 , where @xmath155 is defined in ref .",
    "eve s holevo information can be computed using the formula of the von neumann entropy @xmath156 , with @xmath157 defined in eq .",
    "( [ h ] ) and applied to the numerical symplectic eigenvalues of the cms given in eqs .",
    "( [ vabcondgammagen2 ] ) and  ( [ vbgammaalpha ] ) . in fig .  [ rate - general ] , we plot the key - rate of eq .",
    "( [ gen - key - rate ] ) as a function of the thermal noise @xmath36 for two values of the gaussian modulation @xmath147 ( top ) and @xmath148 ( bottom ) * * vacuum shot noise unit ( snu ) , and choosing @xmath93 , @xmath150 and @xmath149 .",
    "we see that the key - rate of a negative epr attack is clearly lower than that of a collective one - mode attack .",
    "this behavior is generic by varying the previous parameters .",
    "here we study the impact of the experimental limitations on the security thresholds , comparing the two - mode optimal attack with one - mode collective attack .",
    "the security threshold is obtained by solving the equation@xmath158 in this equation , we fix the values of the gaussian modulation ( @xmath147 or @xmath159 ) , the reconciliation efficiency @xmath160 , and the quantum efficiencies @xmath150 .",
    "then , for each attack , we can write the security threshold as @xmath161 .",
    "the comparison is provided in fig",
    ".  [ thresholds ] , where we see that the threshold of the optimal two - mode attack is always lower than the threshold of the one - mode collective attack .     for @xmath147 ( top panel ) and @xmath148 ( bottom panel ) .",
    "other parameters are @xmath149 and @xmath150 .",
    "we compare the two - mode negative epr attack ( continuous black lines ) and the one - mode entangling cloner attack ( dotted black lines ) .",
    "red curves refer to the ideal case @xmath162 and @xmath59.,scaledwidth=45.0% ]    the previous analysis can be performed by expressing the transmissivity in term of distances . in fact , we may consider @xmath163 , where @xmath164 is the distance in km , assuming the standard loss rate in fibre of @xmath165db / km .",
    "the achievable distances are shown in fig .",
    "[ distances ] .",
    "we see that moving from the ideal conditions ( red curves , with @xmath166 and @xmath59 ) the performances deteriorate .",
    "all others curves are obtained for realistic reconciliation efficiencies @xmath149 , and detectors efficiencies @xmath150 .",
    "the top panel compares the ideal thresholds with the case @xmath148 ( black ) , while in the bottom panel we show the degradation of the performances while increasing the modulation from @xmath148 ( black ) to @xmath167 ( green ) .    , where @xmath164 is the distance in km , assuming the loss rate of @xmath165 db / km . as in previous figures",
    "we compare the two - mode negative epr attack ( solid lines ) with the one - mode entangling - cloner attack ( dotted lines ) . in the top panel ,",
    "the red curves refer to the ideal conditions @xmath162 and @xmath59 .",
    "the black curves refer to the non ideal case * * @xmath149 , @xmath150 and @xmath148 ( snu)*. * the bottom panel shows the degradation of the performance as we increase the modulation from @xmath148 ( black curves ) to @xmath167 ( green curves ) , for @xmath149 , @xmath150.,scaledwidth=50.0% ]    it is interesting to note the effect of the reconciliation efficiency on the optimal modulation variance . for values of @xmath168 ,",
    "the optimal modulation is not infinite .",
    "in fact , for the realistic value considered here , @xmath149 , we have a range of finite modulations @xmath169 , for which the performances are improved .      here",
    "we summarize some important aspects emerged from this further analysis .",
    "first , we have shown that positive key - rates are still achievable over the range of metropolitan distances in the presence of various experimental limitations .",
    "second , the negative - epr attack , already identified to be the optimal attack in the ideal case ( see main text ) continues to be the most powerful eavesdropping strategy also considering realistic experimental conditions , i.e. , finite modulation , non - ideal reconciliation and non - ideal detectors .",
    "third , the degradation of the performances of the protocol does not come from the finite modulation ( e.g. , we checked that values as low as @xmath147 are still acceptable ) but mainly from the quantum efficiencies of the detectors , @xmath110 and @xmath111 , and the reconciliation efficiency @xmath11 of the classical codes .",
    "note that ref .",
    "@xcite computed the rate of the protocol at fixed transmissivity @xmath13 and thermal noise @xmath36 , since they fixed both @xmath13 and @xmath170 . however , while the latter formula provides the excess noise for standard one - way protocols  @xcite it does not for the considered relay - based protocol ( see ref .",
    "@xcite for the correct definition of excess noise in this more complex case ) .",
    "note that , in the presence of a pure - loss attack @xmath171 and @xmath172 , the non - unit quantum efficiencies of the detectors can be included in the loss of the channels . for simplicity , for @xmath173 we can write @xmath174 which is equivalent to consider @xmath175 in the cm of eq .",
    "( [ totalcm - pr ] ) ."
  ],
  "abstract_text": [
    "<S> we consider the continuous - variable protocol of pirandola _ </S>",
    "<S> et al_. [ nature photonics * 9 * , 397402 ( 2015 ) , see also arxiv.1312.4104 ] where the secret - key is established by the measurement of an untrusted relay . in this network protocol </S>",
    "<S> , two authorized parties are connected to an untrusted relay by insecure quantum links . </S>",
    "<S> secret correlations are generated by a continuous - variable bell detection  performed on incoming coherent states . in the present work we provide a detailed study of the symmetric configuration , where the relay is midway between the parties . </S>",
    "<S> we analyze symmetric eavesdropping strategies against the quantum links explicitly showing that , at fixed transmissivity and thermal noise , two - mode coherent attacks are optimal , manifestly outperforming one - mode collective attacks based on independent entangling cloners . </S>",
    "<S> such an advantage is shown both in terms of security threshold and secret - key rate . </S>"
  ]
}