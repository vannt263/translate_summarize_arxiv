{
  "article_text": [
    "a diagnostic x - ray beam can be characterized by its photon fluence distribution , which corresponds to the number of photons within each energy interval in the spectrum range .",
    "experimentally , this distribution is generally determined by direct measurement through the use of an energy dispersive solid state detector together with appropriated electronics @xcite .",
    "since this technique is quite expensive and requires specialized labor , it has been proposed an alternative approach to reconstruct x - ray fluence spectra from its attenuation curves data .    in its pioneer paper ,",
    "l. silberstein proposed a method based on the laplace transform to reconstruct x - ray spectra using an analytical approximation to the attenuation curve @xcite . in 1936 , g. e. bell discusses silverstein technique and tests its performance using experimental curves @xcite .",
    "some decades later , j. w. twidell presented a computer code to reconstruct iteratively x - ray spectra by error minimization between experimental and numerical attenuation data @xcite . in 1983 ,",
    "kramer & von seggern published two reviews of the main techniques to solve the x - ray spectra reconstruction problem and showed results obtained by the least square method @xcite .",
    "one year later rubio & mainardi applied the laplace transform to reconstruct x - ray spectra with characteristic lines . @xcite .    in the last years",
    ", several studies have been published dealing with experimental and numerical aspects of the x - ray spectrum problem @xcite .",
    "specifically , in 1998 nisbet et al proposed the using of classical simulated annealing ( csa ) algorithm to reconstruct x - ray spectra with energy between @xmath0 and @xmath1 @xcite by the minimization of an objective function .",
    "typically , this function is defined as the error between the experimental and modeled data added to a regularization function through a factor @xmath2 .",
    "however , it was not clearly shown how the regularization function was built neither how each new solution has been generated from the previous ones .    as it is widely known , simulated annealing is a stochastic optimization algorithm which has been employed to solve non convex maximization / minimization problems .",
    "potential solutions are iteratively generated through a suitable visitation distribution and whether accepted or not according to a predefined criterion .",
    "its classical version ( csa ) was formulated based on the metropolis acceptance criterion @xcite combined to a geometric or logarithmic temperature cooling schedule @xcite and adopting a gaussian visitation distribution .",
    "it has been mathematically shown that the logarithmic cooling temperature ensures the global minimum convergence @xcite . since such cooling schedule takes excessive computational time , a faster algorithm was proposed , the fast simulated annealing ( fsa ) , which accomplishes a visitation distribution based on cauchy probability density function with the cooling schedule as inverse of the iteration @xcite .    by the introducing of two new parameters ,",
    "@xmath3 and @xmath4 , tsallis & stariolo designed the generalized simulated annealing ( gsa ) , which generalizes the metropolis acceptance criterion , the visitation distribution and the cooling schedule , retrieving csa and fsa as particular cases @xcite .",
    "practical problems such as protein structure configurations and the electrical impedance tomography inverse problem have also been tackled using the simulated annealing algorithms @xcite .",
    "here we introduce an algorithm based on gsa combined with a suitable first derivative regularization function to solve the x - ray spectrum reconstruction inverse problem .",
    "c _ language computer code has been implemented and numerical experiments have been carried out to survey the algorithm performance with respect to two main parameters , @xmath2 and @xmath5 , which we conveniently define as @xmath6 .",
    "results show that our algorithm has significant performance improvement compared to the csa version without regularization function and is able to retrieve the x - ray fluence distribution with high accuracy .",
    "moreover , results allow us to suggest a range of @xmath7 and @xmath8 that improves the algorithm performance .",
    "the paper is organized as follows : in sec .",
    "[ theoretical_exp_methods ] , we state the x - ray fluence distribution reconstruction inverse problem and present the generalized simulated annealing algorithm . also , we discuss the computational implementation and present the numerical experiments . in sec .",
    "[ results_discussion ] , we show and discuss the results and , finally , in sec .",
    "[ conclusion ] , we conclude stressing the effectiveness of our method .",
    "in this section , we present the x - ray spectrum reconstruction inverse problem formulation and our proposal for a regularization function .",
    "then , we introduce the generalized simulated annealing algorithm fundamentals . finally , we discuss the algorithm implementation and present the numerical experiments .",
    "consider a x - ray beam with unattenuated fluence distribution @xmath9 , as shown in fig .",
    "( [ fig_spectrum_attenuation]-a ) . after crossing @xmath10 attenuation plates with thickness @xmath11 and densities @xmath12 , as shown in fig .",
    "( [ fig_spectrum_attenuation]-b ) , the attenuated fluence distribution @xmath13 is    @xmath14 , \\label{atenuation}\\ ] ]    where @xmath15 is the mass attenuation coefficient , which depends on @xmath16 .",
    "the relative transmission @xmath17 after the x - ray beam cross @xmath10 attenuation plates is    @xmath18ede}{\\int_0^{e_{\\rm max}}\\phi_e(e)(\\mu_{\\rm en}/\\rho)ede } , \\label{trasmission}\\ ] ]    where @xmath19 is the spectrum energy upper limit and @xmath20 is the mass energy - absorption coefficient , which depends on @xmath16 .",
    "then , one defines the x - ray spectrum reconstruction direct problem as the determination of the transmission curve @xmath21 from a known fluence distribution @xmath22 and the correspondent inverse problem as the determination of the fluence distribution @xmath22 from its transmission curve @xmath17 . discretizing the continuum fluence distribution @xmath9 in a vector",
    "@xmath23 $ ] that represents a histogram with @xmath24 energy bins , the integrals of eq .",
    "( [ trasmission ] ) can be replaced by summations and the transmission becomes the vector @xmath25 $ ] , with components    @xmath26    where @xmath27 is the number of attenuation measurements and    @xmath28ede .",
    "\\label{integral}\\ ] ]    thus , in our discretized x - ray spectrum reconstruction inverse problem , we know the transmission data @xmath29 and we must determine the fluence distribution @xmath30 . comparing the experimental transmission data",
    "@xmath31 $ ] with the numerical one @xmath25 $ ] generated from a trial fluence distribution @xmath32 , we define an objective function as    @xmath33 ^ 2 + \\lambda r({\\bf\\phi_{\\rm trial } } ) , \\label{objective_function}\\ ] ]    where @xmath34 is a regularization function and @xmath2 is the regularization parameter .",
    "the suitable choice to the regularization function @xmath35 is of fundamental importance . in our algorithm , it has been constructed to guarantee the smoothness of the spectrum penalizing large fluence differences between two neighboring components of @xmath32 .",
    "thus , we have considered it as the first derivative of the standardized trial fluence distribution    @xmath36    where @xmath37 are the elements of the standardized trial fluence    @xmath38}. \\label{normalized_fuence}\\ ] ]    our propose for such standardization is important to makes the regularization function @xmath34 to have the same order magnitude of the absolute mean square error @xmath39 ^ 2/m$ ] of eq .",
    "( [ objective_function ] ) and facilities the choice of the regularization parameter @xmath2 , which represents the threshold between the data fitting and the spectrum smoothness .",
    "moreover , since @xmath40 and @xmath41 are relative transmission , our standardization of the trial fluence distribution makes the objective function eq .",
    "( [ objective_function ] ) dimensionless .    summarizing , in the x - ray reconstruction spectrum inverse problem",
    ", one must find out a fluence distribution that yields the objective function global minimum .",
    "mathematically , the solution of the optimization problem @xmath42 must satisfy    @xmath43    which we are concerned in the following .",
    "the algorithm starts from a random initial solution . at each iteration ,",
    "a new guess solution @xmath44 is generated and compared with the previous one @xmath45 . before describing the way new solutions",
    "are generated , let us address the acceptance criterion . according to metropolis criterion , the probability @xmath46 to accept the new solution is    @xmath47    where @xmath48 is the variation between the new and old solutions objective function and @xmath49 is the acceptance temperature , which corresponds to a stochasticity control parameter .    to generate a new solution @xmath44 , each component @xmath50 of the current solution @xmath45",
    "is modified , one at a time , generating a new component @xmath51 through the visitation distribution    @xmath52    where @xmath53 is the visitation temperature , which is related to the visitation length jump , and    @xmath54 \\label{qgaussian}\\ ] ]    is the standard @xmath55-gaussian probability distribution function ( pdf ) within    @xmath56    being the generalized exponential function @xcite .",
    "the attractive feature of the generalized gaussian visitation is its versatility .",
    "the suitable choice of @xmath5 parameter allows the algorithm transit from a global search to a local one and vice - versa .",
    "the 2nd moment of the @xmath55-gaussian pdf ( [ qgaussian ] ) is only finite for @xmath57 , which allows us to infer that for @xmath58 , one has the best agreement between local and global visitation @xcite .",
    "tsallis & stariolo , for example , estimated that the gsa best performance is reached to @xmath59 @xcite , while deng et al proposed an approach to generate @xmath55-gaussian deviate and show numerically that the optimal gsa performance is to @xmath60 @xcite .",
    "the stochastic search is controlled by the temperature cooling schedule .",
    "the process starts with high temperatures allowing a wide spread visitation and high probability to accept a new solution that increases the objective function .",
    "as the process approaches the end , the visitation becomes more local and the probability to accept bad new solutions tends to vanish .",
    "we have chosen two schedules to decrease the temperatures @xmath49 and @xmath53 as a function of the iteration @xmath61 ,    @xmath62    where @xmath63 is a cooling rate , and    @xmath64    with @xmath65 $ ] being the generalized logarithm function , which is the inverse of the presented generalized exponential function eq .",
    "( [ q_exp ] ) .",
    "it is important to note that as @xmath66 , eq . ( [ qgaussian ] ) and eq .",
    "( [ tvcooling ] ) become , respectively , the usuals gaussian distribution and logarithm cooling schedule , retrieving the csa . also it is possible verify that for @xmath67 we obtain the fsa with cauchy visitation distribution and inverse of iteration cooling schedule .",
    "one of the present paper contributions is the initial temperatures setting approach . to guarantee initial large probability to detrap from a local minimum basin",
    "the initial acceptance temperature @xmath68 must be greater than the depth of deepest local minimum landscape . to estimate @xmath68 , an initial random search",
    "is performed in which @xmath69 solutions @xmath70 are generated and its correspondent objective functions @xmath71 are calculated .",
    "evaluating the greatest difference of the objective function @xmath72 - \\min\\left[f({\\bf\\phi})\\right]$ ] , we define    @xmath73    where @xmath74 is a predefined initial probability to accept new solutions that increase the objective function and is set near to @xmath75 to give the algorithm initial high probability to escape from local minima basin .    to ensure an efficient wide landscape exploration , the initial visitation temperature , @xmath76 , must be greater than the largest actual spectrum fluency .",
    "to simplify the @xmath76 setting , we modeled the actual spectrum shape as a triangle with base @xmath77 and high @xmath76 , where @xmath78 and @xmath19 are the minimum and maximum spectrum energy .",
    "as the collision air kerma @xmath79 can be experimentally measured and it represents the area underneath of the modeled spectrum ( triangle ) , we set    @xmath80    summarizing , consider the following gsa algorithm , being @xmath81 the maximum number of iterations and @xmath82 the number of new trial solutions at each iteration .    1 .",
    "set the simulation parameters : @xmath81 , @xmath82 , @xmath83 , @xmath4 e @xmath2 ; 2 .",
    "set the initial temperatures @xmath68 and @xmath76 using eqs .",
    "( [ ta_0 ] ) and ( [ tv_0 ] ) ; 3 .",
    "generate a random initial solution @xmath45 ; 4 .   evaluate the objective function @xmath84 using eq .",
    "( [ objective_function ] ) ; 5 .   for @xmath61 from @xmath75 to @xmath81",
    "repeat @xmath82 times the following steps : 1 .",
    "generate a new solution @xmath44 using eq .",
    "( [ visitation ] ) ; 2 .",
    "evaluate the new objective function @xmath85 using eq .",
    "( [ objective_function ] ) ; 3 .   considere the metropolis criterion : + @xmath86 if @xmath87 ; + @xmath86 else , if @xmath88/t_a } > x \\sim u(0,1 ) , \\quad \\mbox{then}\\quad { \\bf\\phi}_{\\rm old } = { \\bf\\phi}_{\\rm new}$ ] ; 2 .   cooling down the temperatures @xmath49 and @xmath53 using eqs .",
    "( [ tacooling ] ) and ( [ tvcooling ] ) ; 6 .",
    "output results      a _ c _ language computer code to solve the x - ray spectrum reconstruction inverse problem have been implemented and numerical tests were carried out to assess its performance . since our contributions are mainly related with a suitable regularization function and the use of gsa instead of csa , the numerical experiments have dealt specifically to the algorithm accuracy with respect to the parameters @xmath5 and @xmath2 .",
    "the implemented computer code receives , as input data , the collision air kerma , @xmath79 , the minimum and maximum spectrum energies , @xmath78 and @xmath19 , and the experimental transmission data , @xmath89 .",
    "thus , the gsa algorithm ( sec . [ gsa ] ) is throughout performed @xmath90 times starting from different random initial guess solutions , yields @xmath90 numerical spectra @xmath91 .",
    "the final solution is the numerical fluence distribution @xmath92 defined as    @xmath93    where @xmath94 is the numerical mean fluence for each energy bin @xmath95 of @xmath92 and @xmath24 is the number of energy bins . to generate the @xmath5-gaussian deviate ,",
    "we have used the generalized box - mller method @xcite .",
    "three experimental spectra data with peak voltages of @xmath96 , @xmath97 and @xmath98 were selected as reference to test the suitability of our algorithm @xcite .",
    "the choice was made to avoid characteristic x - ray in addition to the bremsstrahlung spectrum .",
    "the reference spectra minimum energy , @xmath99 , maximum energy , @xmath100 , and number of energy bins @xmath24 are shown in tab .",
    "[ tab_actual_spectra ] .",
    "attenuation curves for aluminum considering @xmath101 different thickness were numerically generated and used as input data in our numerical experiments .",
    "the normalized fluence distributions for each reference spectra and its relative transmission curves are shown in fig .",
    "( [ actualspectra ] ) .    to compare the numerical solution @xmath102 to the actual one @xmath103",
    ", we have chosen the absolute mean error    @xmath104    where @xmath105 and @xmath106 are the component @xmath95 of the actual and numerical normalized fluence distributions given , respectively , by    @xmath107 } \\qquad\\mbox{and}\\qquad { \\hat{\\bf\\phi}}_{\\rm num } = \\frac{{\\bf\\phi}_{\\rm num}}{\\max[{\\bf\\phi}_{\\rm num}]}\\ ] ]    .x - ray reference spectra with its energy range and number of energy bins @xcite [ cols=\"^,^,^,^\",options=\"header \" , ]     for each reference spectra , the program has run setting @xmath108 , @xmath109 and @xmath110 constants , but varying @xmath5 and @xmath2 in the range @xmath111 and @xmath112 . to each pair ( @xmath5,@xmath2 ) , the numerical fluence distribution @xmath92",
    "was compared to the actual one @xmath113 yielding @xmath114 absolute mean errors calculated by eq .",
    "( [ abserror ] ) .",
    "now we present and analyze the main results obtained from the numerical experiments .",
    "first , we present in fig .",
    "( [ fig_surf ] ) the absolute mean error @xmath115 behavior as function of parameters @xmath2 and @xmath5 .",
    "results does not allow us find out an unique `` optimal '' pair ( @xmath116 ) .",
    "however it is notable that the error decreases strongly for @xmath7 to all reference spectra , which corroborates the fundamental importance of our regularization function .",
    "also , one can see considerable improvement on the results for @xmath8 .",
    "indeed , as we have discussed in sec .",
    "[ gsa ] , the 2nd moment of pdf ( [ qgaussian ] ) diverges for @xmath117 and the visitation becomes more global and efficient .",
    "+ ( a ) +   + ( b ) +   + ( c )    beyond that , to show how the numerical fluence distributions fit to the reference actual spectra , we present in fig .",
    "( [ fig_spectra ] ) the results obtained using csa ( @xmath118 ) without regularization function ( @xmath119 ) and the best fluence distributions reached by gsa combined with our regularization function . despite these best results have occurred for different values of @xmath5 and @xmath2 for each reference spectra , it is quite evident that for @xmath8 and @xmath7 the algorithm provides excellent fitness to the actual data .    finally , although the metropolis criterion might be also generalized , we have chosen its classical version since such generalization is still under investigation . indeed , one year after the original paper of tsallis & stariolo @xcite , xiang et al proposed an rule to change the parameter @xmath3 to speed up the convergence of gsa @xcite . in 2009",
    "crokidakis et al have used a modified metropolis criterion based on generalized boltzmann - gibbs entropy to analysis phase transitions of the ising model @xcite and three years later , silva et al @xcite have retrieved the detailed energy balance and locality of the generalized metropolis criterion using the generalized operators @xcite .",
    "a technique based on generalized simulated annealing algorithm combined to a first derivative regularization function to solve the x - ray spectrum reconstruction inverse problem was presented .",
    "a computer code that receives a x - ray attenuation data and returns an approximation for its fluence distribution was implemented .",
    "numerical experiments using three reference spectra with @xmath96 , @xmath97 and @xmath98 were carried out to assess the algorithm performance mainly with respect to the parameters @xmath2 and @xmath5 .",
    "results show high accuracy improvement for @xmath7 and @xmath8 , corroborating the gsa better performance compared to csa and showing the fundamental importance of our smoothness regularization function .",
    "moreover , our technique seems to be quite reliable since its numerical reconstruction fluence distributions present excellent fitness to the reference spectra .",
    "finally , the presented technique is promising to assist the tricky practical problem of determination of a x - ray spectrum beam from its attenuation data , which is considerably less expensive and easier to accomplish than the current direct measurement approaches .",
    "ohm thanks the ifsp and capes .",
    "asm thanks the cnpq ( 305738/2010 - 0 and 485155 - 2013 - 3 ) .",
    "amc thanks the cnpq and fapesp .",
    "xx    ali e  s  m , mcewen m  r  rogers d  w  o 2012 unfolding linac photon spectra and incident electron energies from experimental transmission data , with direct independent validation _ med .",
    "phys . _ * 39 * ,  65856595 .",
    "ankerhold u 2000 catalogue of x - ray spectrum and their characteristic data - iso and din radiation qualities , therapy and diagnostic radiation qualities , unfiltered x - ray spectra technical report ptb - report dos-34 .",
    "arruda t  j , gonzales r  s , terariol c  s  a  martinez a  s 2008 arithmetical and geometrical means of generalized logarithmic and exponential functions : generalized sum and product operators _ phys .",
    "lett . a _ * 372 * ,  25782582 .",
    "cho h  m , kim h  j , choi y  n , lee s  w , ryu h  j  lee y  j 2013 the effects of photon flux on energy spectra and imaging characteristics in a photon - counting x - ray detector _ phys .",
    "* 58 * ,  48654879 .",
    "menin o  h , rolnik v  martinez a  s 2013 boundary element method and simulated annealing algorithm applied to electrical impedance tomography image reconstruction _ rev . bras .",
    "_ * 35 * ,  2304123047 .",
    "nisbet a , weatherburn , fenwick j  d  mcvey g 1998 spectral reconstruction of clinical megavoltage photon beams and the implications of spectral determination on the dosimetry of such beams _ phys .",
    "med . biol . _ * 43 * ,  15071521 .",
    "silva r , de felcio j  r  d  martinez a  s 2012 generalized metropolis dynamics with a generalized master equation : an approach for time - independent and time - dependent monte carlo simulations of generalized spin systems _ phys .",
    "e _ * 85 * ,  06670710667079 ."
  ],
  "abstract_text": [
    "<S> the throughout knowledge of a x - ray beam spectrum is mandatory to assess the quality of its source device . </S>",
    "<S> since the techniques to directly measurement such spectra are expensive and laborious , the x - ray spectrum reconstruction using attenuation data has been a promising alternative </S>",
    "<S> . however , such reconstruction corresponds mathematically to an inverse , nonlinear and ill - posed problem . </S>",
    "<S> therefore , to solve it the use of powerful optimization algorithms and good regularization functions is required . here , we present a generalized simulated annealing algorithm combined with a suitable smoothing regularization function to solve the x - ray spectrum reconstruction inverse problem . </S>",
    "<S> we also propose an approach to set the initial acceptance and visitation temperatures and a standardization of the objective function terms to automatize the algorithm to address with different spectra range . </S>",
    "<S> numerical tests considering three different reference spectra with its attenuation curve are presented . </S>",
    "<S> results show that the algorithm provides good accuracy to retrieve the reference spectra shapes corroborating the central importance of our regularization function and the performance improvement of the generalized simulated annealing compared to its classical version .    </S>",
    "<S> x - ray , spectrometry , inverse problem , generalized simulated annealing </S>"
  ]
}