{
  "article_text": [
    "several imaging tasks can be formulated as the problem of finding a reconstructed version of a degraded and possibly under - sampled image . removing signal oscillations ( _ image denoising _ ) and optical aberrations ( _ image deblurring _ ) due to acquisition and transmission faults are common problems in applications such as medical imaging , astronomy , microscopy and many more .",
    "further , the image interpolation problem of filling in missing or occluded parts of the image using the information from the surrounding areas is called _ image inpainting _ @xcite .",
    "more sophisticated imaging tasks aim to decompose the acquired image into its component structures , such as cartoon and texture , or into the product of an  intrinsic \" component not subject to light - changes ( e.g. illumination ) and its counterpart describing illumination changes only , see @xcite .",
    "the problem of shadow removal belongs to this latter class @xcite . for a given image @xmath0",
    ", it can be formulated as @xmath1 where @xmath2 denotes the image domain , @xmath3 the illumination image and @xmath4 the _ reflectance _ image , i.e.  the intrinsic image not subject to illumination changes @xcite . due to the ill - posedness of the problem , in @xcite",
    "a maximum - likelihood approach is used . in @xcite , a pde - based approach computing the solution of as the stationary state of a linear parabolic pde",
    "is considered .",
    "due to its similarities with the analogous physical process , such model is called _",
    "image osmosis_.    [ [ image - osmosis . ] ] image osmosis .",
    "+ + + + + + + + + + + + + +    given a rectangular image domain @xmath5 with lipschitz boundary @xmath6 and a positive initial gray - scale image @xmath7 , for a given vector field @xmath8 the linear image osmosis model proposed in @xcite is a drift - diffusion pde which computes for every @xmath9,~ t>0 $ ] a regularised family of images @xmath10 of @xmath0 by solving : @xmath11 \\\\",
    "u(x,0)=f(x ) & \\text { on } \\omega \\\\ \\langle",
    "\\nabla u - \\bm{d}u , \\bm{n } \\rangle = 0 & \\text { on } \\partial \\omega \\times ( 0 , t ] , \\end{cases}\\ ] ] where @xmath12 denotes the euclidean scalar product and @xmath13 the outer normal vector on @xmath14 .",
    "the extension to rgb images is straightforward by letting the process evolve for each colour channel . in (",
    "* proposition 1 ) the authors prove that any solution of preserves the average gray value and the non - negativity at any time @xmath15 .",
    "furthermore , by setting @xmath16 for a reference image @xmath17 , the steady state @xmath18 of @xmath19 turns out to be a minimiser of the energy functional : @xmath20 and can be expressed as a rescaled version of @xmath21 via the formula @xmath22 , where @xmath23 and @xmath24 are the average of @xmath0 and @xmath21 over @xmath25 , respectively .    in @xcite",
    "the osmosis model is used as a non - symmetric variant of diffusion for several visual computing applications ( data compression , face cloning and shadow removal ) . a general fully discrete framework for this problem",
    "is studied in @xcite where , under some standard conditions on the semi - discretised finite differences operators used , the conservation properties described above are shown to be still valid upon discretisation .",
    "we synthesise these results as follows :    @xcite [ theo : vogel ] for a given @xmath26 , consider the semi - discretised linear osmosis problem : @xmath27 where @xmath28 is an irreducible ( non - symmetric ) matrix with zero - column sum and non - negative off - diagonal entries . for @xmath29 , consider the time - discretisation schemes @xmath30 : @xmath31    then , in both cases , @xmath32 is an irreducible , non - negative matrix with strictly positive diagonal entries and unitary column sum and for @xmath33 the following properties hold true :    1 .   for every @xmath15 , the evolution preserves positivity and the average gray value of @xmath34 ; 2 .",
    "the unique steady state is the eigenvector of @xmath32 associated to eigenvalue @xmath35 .    for large @xmath36",
    ", the numerical realisation via implicit euler method requires the inversion of a non - symmetric penta - diagonal matrix , which may be highly costly for large images .",
    "alternatively , problem can be solved using dimensional splitting methods , @xcite .    [",
    "[ adi - splitting - methods . ] ] adi splitting methods .",
    "+ + + + + + + + + + + + + + + + + + + + + +    given a domain @xmath37 , a _",
    "dimensional splitting _",
    "method decomposes the semi - discretised operator @xmath38 of initial boundary value problem into the sum : @xmath39 such that the components @xmath40 , @xmath41 encode the linear action of @xmath38 along the space direction @xmath41 respectively .",
    "the term @xmath42 may contain additional contributes coming from mixed directions and non - stiff nonlinear terms .",
    "_ alternating directional implicit _ ( adi ) schemes are time - stepping methods that treat the unidirectional components @xmath43 implicitly and the @xmath42 component , if present , explicitly in time .",
    "having in mind a standard finite difference space discretisation , this splitting idea translates into reducing the @xmath44-dimensional original problem to @xmath44 one - dimensional problems .    for 2d applications , we set @xmath45 .",
    "let @xmath46 denote an approximation of @xmath4 in the grid of size @xmath47 at point @xmath48 ; the discretisation of considered in @xcite reads : @xmath49 which can be splitted into the sum of @xmath50 and @xmath51 where no mixed and/or nonlinear terms appear ( @xmath52 ) .",
    "following @xcite , we recall now the two adi schemes considered in this paper .    [ [ the - peaceman - rachford - scheme . ] ] the peaceman - rachford scheme .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the first method considered is the second - order accurate _ peaceman - rachford _ adi scheme . for every @xmath29 and time - step @xmath36 , compute an approximation @xmath53 via the updating rule : @xmath54 heuristically , forward and backward euler are applied alternatively in a symmetrical way , thus resulting in second - order accuracy @xcite .",
    "[ [ the - douglas - scheme . ] ] the douglas scheme .",
    "+ + + + + + + + + + + + + + + + + + +    a more general adi decomposition accommodating also the general case @xmath55 in is the _ douglas _ method .",
    "for @xmath29 , @xmath36 and @xmath56 $ ] , the updating rule reads @xmath57 in words , the numerical approximation in each time step is computed by applying at first a forward euler predictor and then it is stabilised by intermediate steps where just the unidirectional components @xmath40 of the splitting appear , weighted by @xmath58 whose size balances the implicit / explicit behaviour of these steps .",
    "the time - consistency order of the scheme is equal to two for @xmath52 and @xmath59 , and it is of order one otherwise .    for @xmath45 both schemes and are unconditionally stable , see @xcite .",
    "however , for large time steps , the time - accuracy may suffer due to the presence of the explicit steps .",
    "[ [ scope - of - the - paper . ] ] scope of the paper .",
    "+ + + + + + + + + + + + + + + + + + +    in this work , we apply schemes and to solve and show that similar conservation properties as in theorem [ theo : vogel ] hold . compared to standard implicit methods used in @xcite , such schemes",
    "renders a much more efficient and accurate numerical solution .",
    "we show that adi schemes and show similar conservation properties as in theorem [ theo : vogel ] .    [",
    "prop : pr ] let @xmath26 and @xmath60 .",
    "then , the peaceman - rachford scheme on the splitting preserves the average gray value , the positivity and converges to a unique steady state .",
    "we write the peaceman - rachford iteration as @xmath61 and observe that for @xmath62 the matrices @xmath63 and @xmath64 , are non - negative and irreducible with unitary column sum and positive diagonal entries being each @xmath65 a one - dimensional implicit / explicit discretised osmosis operator satisfying the assumptions of theorem [ theo : vogel ] . therefore , at every implicit / explicit half - step and using the restriction on @xmath66 , the average gray - value and positivity are conserved . furthermore , the unique steady state is the eigenvector of the operator @xmath67 associated to the eigenvalue to one .",
    "the following lemma is useful to prove a similar result for the douglas scheme .",
    "[ lemma : sum ] if @xmath68 and @xmath69 s.t . @xmath70 and",
    "@xmath71 for every @xmath72 , then , the matrix @xmath73 has column sum equal to @xmath74 .",
    "writing each element @xmath75 in terms of the elements of @xmath76 and @xmath77 , we have that for every @xmath78 : @xmath79    [ propop : agv ] let @xmath80 , @xmath36 and @xmath81 $ ] .",
    "then , the douglas scheme applied to the splitted semi - discretised scheme preserves the average gray value .    for every @xmath29 ,",
    "we write the douglas iteration as @xmath82 \\bm{u}^k   \\\\ & = \\bigl(\\bm{i } + \\tau ( \\bm{i}-\\theta \\tau \\bm{a_2})^{-1 } ( \\bm{i}-\\theta \\tau \\bm{a_1})^{-1}\\bm{a } \\bigr ) \\bm{u}^k = : \\bigl(\\bm{i } + \\tau\\bm{p_2}\\bm{p_1}\\bm{a } \\bigr ) \\bm{u}^k\\end{aligned}\\ ] ] where both @xmath83 and @xmath84 are non - negative , irreducible , with unitary column sum and strictly positive diagonal entries by theorem [ theo : vogel ] , while @xmath85 is zero - column sum being the standard discretised osmosis operator . by lemma [ lemma :",
    "sum ] , the operator @xmath86 has zero column sum and the operator @xmath87 has unitary column sum .",
    "thus , for every @xmath29 : @xmath88    there is no guarantee that the non - diagonal entries of the operator @xmath89 are non - negative .",
    "therefore , it is not possible to apply directly theorem [ theo : vogel ] to conclude that the iterates @xmath90 remain positive and that they converge to a unique steady state .",
    "however , our numerical tests suggest that both properties remain valid",
    ". a rigorous proof of these properties is left for future research .",
    "in the following algorithm [ alg : peaceman lu ] and [ alg : douglas lu ] we present the pseudocode for the peaceman - rachford and the douglas schemes , respectively , when applied to images of size @xmath91 pixels , with @xmath92 .",
    "we recall that in @xcite , the non - splitted euler implicit method is solved iteratively by ` bicgstab ` , which is influenced by the tolerance and maximum iterations required .    due to the structure of the adi matrices @xmath50 and @xmath51 , a tridiagonal ` lu ` factorisation can be used for a better efficiency after a permutation on matrix @xmath51 based on @xcite to reduce the bandwidth to one : this is convenient for images with large @xmath93 , where non - splitted methods become prohibitively expensive . in the non - splitted case , one",
    "` lu ` factorisation plus @xmath94 system resolutions for the penta - diagonal matrix @xmath38 , with lower and upper bandwidth equal to @xmath93 , costs @xmath95 _ flops _ overall . in the splitted case ,",
    "the computational cost is reduced to @xmath96 _ flops _ because of the use of tridiagonal @xmath35-bandwidth matrices . for the same reason , the inverse splitted operators @xmath50 and",
    "@xmath51 require less storage space than the non - splitted operator @xmath38 while the inverse of @xmath38 has significantly more non - zeros entries .",
    "since @xmath66 is constant , all the ` lu ` factorisations can be computed only once before the main loop .    as a toy example , we evolved the osmosis model starting from an initial constant image , with a known steady state . in table",
    "[ tab : numerical results ] we compare the non - splitting and splitting solutions at @xmath97 for different fixed time - steps @xmath66 and @xmath98 where exact - in - time reference solution is computed by exponential integrators @xcite . for a comparison with @xcite , the non - splitted approach is solved by ` bicgstab ` ( in our case ` tol=1e-15 ` and ` maxiter=1e6 ` ) and also test the direct @xmath99 factorisation .",
    "the order of the methods for the energy error ( e.e . ) are plotted in  figure  [ fig : order and solution comparison ] . for larger time - steps ,",
    "adi methods are 10@xmath100 faster than non - splitting methods .",
    "l|c|c|cc|cc|cc & & & + method & @xmath58 & @xmath101 & time & e.e .  &",
    "time & e.e .   & time & e.e .   + `",
    "bicgstab ` ( 5 d. ) & 1 & 1 & * 76.70 s. * & * 1.84e-10 * & 58.08 s. & 2.00e-09 & 19.44 s. & 1.91e-08 + ` lu ` ( 5 d. ) & 1 & 1 & & * 1.84e-10 * & 53.31 s. & * 1.84e-09 * & 5.46 s. & * 1.85e-08 * + ` douglas ` adi & 1 & 1 & 80.04 s & * 1.84e-10 * & * 7.30 s. * & * 1.84e-09 * & * 0.73 s. * & 2.85e-08 + ` bicgstab ` ( 5 d. ) & 0.5 & 2 & 75.01 s. & 5.56e-15 & 23.2 s. & 5.58e-13 & 20.19 s. & 8.00e-09 + ` lu ` ( 5 d. ) & 0.5 & 2 & & 5.58e-15 & 52.92 s. & 5.58e-13 & 5.27 s. & 8.00e-09 + ` douglas ` adi & 0.5 & 2 & 80.35 s. & * 2.00e-15 * & 9.76 s. & * 2.00e-13 * & 0.86 s. & * 1.96e-11 * + ` p`.-`r .",
    "` adi & - & 2 & * 57.41 s. * & 1.51e-14 & * 5.81 s. * & 1.51e-12 & * 0.54 s. * & 1.53e-10 +    [ tab : numerical results ]    0.5    0.5 : energy error at @xmath97 for several @xmath66 .",
    "[ fig : shadow_removal ] : input with shadow boundary ( top ) ; douglas adi solution and result after non - local inpainting @xcite ( bottom ) . parameters : @xmath102 ; @xmath103 . image from : http://aqua.cs.uiuc.edu/site/projects/shadow.html .",
    ", title=\"fig:\",height=181 ]    finally , in figure [ fig : shadow_removal ] the adi numerical solution of the shadow - removal problem as in @xcite is shown , starting from a shadowed image @xmath4 and setting @xmath104 on the shadow boundary . there , in order to correct the diffusion artefacts , an inpainting correction ( e.g.  @xcite ) is applied .",
    "in this paper , we consider the _ image osmosis _ model proposed in @xcite for several imaging applications .",
    "we proposed an adi splitting approach to decompose the 2-d finite difference operator into two one - dimensional tridiagonal operators .",
    "we proved that the splitting numerical schemes preserve properties holding for the continuous model .",
    "numerically , these methods are efficient and accurate .",
    "we tested the proposed methods for a shadow removal problem , with an inpainting post - processing step .",
    "future research directions include a rigorous stability and convergence analysis of the douglas method and the formulation of a ( nonlinear ) model driving the diffusion on the shadow mask to avoid the inpainting correction .",
    "lc acknowledges the joint anr / fwf project ",
    "efficient algorithms for nonsmooth optimization in imaging \" ( eanoi ) fwf n. i1148 / anr-12-is01 - 0003 .",
    "ce acknowledges the support of gncs - indam .",
    "sp was supported by the uk engineering and physical sciences research council ( epsrc ) grant ep / l016516/1 .",
    "9        aubert g and kornprobst p 2006 _ mathematical problems in image processing : partial differential equations and the calculus of variations _",
    "2nd ed applied mathematical sciences ( springer ) isbn 9780387322001"
  ],
  "abstract_text": [
    "<S> we consider _ alternating directional implicit _ ( adi ) splitting schemes to compute efficiently the numerical solution of the pde osmosis model considered by weickert et al .  in @xcite for several imaging applications . </S>",
    "<S> the discretised scheme is shown to preserve analogous properties to the continuous model . </S>",
    "<S> the dimensional splitting strategy traduces numerically into the solution of simple tridiagonal systems for which matrix factorisation techniques are used to improve upon the performance of classical implicit methods even for large time steps . </S>",
    "<S> applications to shadow removal and inpainting problems are presented . </S>"
  ]
}