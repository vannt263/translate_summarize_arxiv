{
  "article_text": [
    "as photons travel through matter , the radiation field experiences changes due to net total emission , absorption , and scattering , see for instance @xcite . at high enough energy density the radiation will heat and accelerate the plasma .",
    "this coupled system is radiation hydrodynamics .",
    "the radiation can at a fundamental level be described by the time evolution of the spectral radiation intensity @xmath0 , which is the radiation energy per unit area , per unit solid angle in the direction of photon propagation @xmath1 , per unit interval of photon frequency @xmath2 , and per unit time interval .",
    "several method have been developed to solve the radiation field in various degree of physics fidelity .    in monte carlo",
    "radiative transfer methods , the radiation is statistically evaluated .",
    "small photon packets are created with their energy and propagation direction statistically selected .",
    "the packets are propagated through matter using the radiation transfer equation @xcite .",
    "characteristic methods use integration along rays of various lengths to solve for the angular structure of the radiation transport . a recent conservative ,",
    "causal ray - tracing method was developed and combined with a short characteristic ray - tracing for the transfer calculations of ionizing radiation @xcite .",
    "solar surface magneto - convection simulations are increasingly realistic and use a three - dimensional , non - gray , approximate local thermodynamic equilibrium ( lte ) , radiative transfer for the heating and cooling of plasma .",
    "these simulations are typically formulated for four frequency bins in the radiative transport equation @xcite .",
    "for some applications , simplifications to the radiation transfer can be made by calculating moments of the radiation intensity over the solid angle @xmath3 .",
    "the spectral radiation energy and the spectral radiation energy flux are defined by the 0th and 1st moments as @xmath4 in addition , the spectral radiation pressure tensor @xmath5 is defined by the second moment @xmath6 a whole class of radiation transfer models are based on solving the corresponding radiation moment equations , using a closure relation between the spectral pressure tensor and the spectral intensity @xcite .    a radiation - hydrodynamics code based on variable eddington tensor ( vet ) methods @xcite can still capture the angular structure of the radiation field by relating the spectral radiation pressure tensor to the spectral radiation intensity and the method is applicable for both the optically thin and thick regime .",
    "optically thin versions of the vet method have been used in the context of cosmological reionization @xcite .",
    "further simplification assumes that the radiation pressure is isotropic and proportional to the radiation energy .",
    "this is the diffusion approximation .",
    "several codes have been developed using this approximation .",
    "hydra @xcite is an arbitrary lagrange eulerian code for 2d and 3d radiation hydrodynamics .",
    "the radiation transfer model is based upon either flux limited multigroup or implicit monte carlo radiation transport .",
    "the eulerian code rage @xcite uses a cell - based adaptive mesh refinement to achieve resolved radiative hydrodynamic flows .",
    "hyades @xcite solve the radiation hydrodynamic equations on a lagrangian mesh , while cale @xcite can use either a fixed eulerian mesh , an embedded lagrangian mesh , or a partially embedded , partially remapped mesh .",
    "our newly developed radiation - hydrodynamic solver uses an eulerian grid together with a block - based adaptive mesh refinement strategy .",
    "we limit the discussion of the radiation hydrodynamics implementation in crash to plasmas in the absence of magnetic field .",
    "most of the description in this paper can , however , easily be extended to magnetohydrodynamic ( mhd ) plasmas as well .",
    "indeed , since the crash code is essentially the magnetohydrodynamic bats - r - us code @xcite extended with libraries containing radiation transport , equation - of - state ( eos ) , and opacity solvers , the implementation for the coupling between the radiation field and mhd plasmas is readily available .",
    "the crash code uses the recently developed block adaptive tree library ( batl , @xcite ) . here",
    "we will focus on the radiation implementation .",
    "both the crash and bats - r - us codes are publicly available as part of the space weather modeling framework ( swmf , @xcite ) or can be used as stand - alone codes .    in the following",
    ", section [ sec : radhydro ] introduces the radiation hydrodynamic equations for multi - material plasmas , in a form general enough to apply at high energy density . section [ sec : method ] describes the numerical algorithms to solve these equations .",
    "next , in section [ sec : verification ] verification tests , are presented for radiation and electron heat conduction on non - uniform meshes in 1d , 2d , and 3d slab geometry and in axially symmetric ( @xmath7 ) geometry .",
    "we also show a full system multi - material radiation hydrodynamic simulation on an adaptively refined mesh and demonstrate good scaling up to 1000 processors .",
    "the paper is summarized in section [ sec : summary ] .",
    "the equations of radiation hydrodynamics describe the time evolution of both matter and radiation . for the applications that supported the work reported here",
    ", the code must be able to model matter as a high energy density plasma that is in lte so that the population of all atomic and ion states can be obtained from statistical physics ( see for instance @xcite ) .",
    "we allow for multiple materials throughout the spatial domain of interest , but restrict the analysis to plasma flows that are far from relativistic .",
    "the materials can be heated to sufficiently high temperatures so that they can ionize and create free electrons , introducing the need for a time evolution equation for the electron energy density .",
    "the electrons transfer heat by thermal heat conduction and emit and absorb photon radiation .",
    "the radiation model discussed in this paper is non - equilibrium diffusion , in which the electron and radiation temperature can be different .",
    "we approximate the radiation transfer with a gray or multigroup flux limited diffusion ( fld ) .",
    "this model is also of interest for application to a number of astrophysical problems .    in the following subsections",
    ", we will describe the radiative transfer equations for the evolution of the multigroup radiation energy densities ( section [ sec : radtrans ] ) in the fld approximation ( section [ sec : fld ] ) .",
    "the coupling of the radiation field to the two species hydrodynamic equations of electrons and ions are discussed in section [ sec : hydroeq ] . in section [ sec : levelset ] , the method for tracking the different materials is treated , while the lookup tables used for of the eos and opacities are mentioned in section [ sec : eos ] .      in this section",
    ", we will build up the form of the radiation transport in the multigroup diffusion approximation that is used for the implementation in the crash code .",
    "the spectral pressure tensor , equation ( [ eq : pressuretensor ] ) , is often approximated in the form @xcite @xmath8 where @xmath9 is the spectral eddington tensor , @xmath10 is the eddington factor , and @xmath11 is the identity matrix .",
    "the second term on the right hand side is a dyad constructed from the direction of the spectral radiation flux .",
    "the pressure tensor can be used to arrive at a time evolution equation for the solid angle integrated spectral radiation energy @xcite @xmath12 which contains the plasma velocity @xmath13 of the background plasma .",
    "here the colon denotes the contraction of the two tensors @xmath5 and @xmath14 .",
    "the processes described by the symbolic terms on the right hand side of equation ( [ eq : buchlerform ] ) will be described below .    setting the eddington factor @xmath15 corresponds to the radiation diffusion model . in this case",
    "the radiation is assumed to be effectively isotropic and the spectral radiation pressure can be described by the scalar @xmath16 where we have introduced the adiabatic index of the radiation field , which in this case has the relativistic value @xmath17 . the time evolution for the spectral energy density can then be simplified to @xmath18 the second and third terms on the left hand side of equation ( [ eq : mg1 ] ) express the change in the spectral energy density due to the advection and compression of the background plasma , which moves with the velocity @xmath13 , as well as the frequency shift due to compression . in the free - streaming limit where the radiation hardly interacts with the matter , @xmath10 will approach one . in this paper",
    "we will keep @xmath15 and at the same time use a flux limited diffusion for the free - streaming regime whenever needed ( see section [ sec : fld ] ) .",
    "the set of equations for the spectral energy density ( [ eq : mg1 ] ) still consists of an infinite amount of equations , one for each frequency . a finite set of governing equations to describe the radiation transport in the multigroup diffusion approximation is obtained when we choose a set of frequency groups .",
    "here we enumerate groups with the index , @xmath19 .",
    "the interval of the photon frequencies , relating to the @xmath20th group is denoted as @xmath21 $ ] .",
    "a discrete set of group energy densities , @xmath22 , is introduced in terms of the integrals of the spectral energy density of the frequency group interval : @xmath23 now we can integrate equation ( [ eq : mg1 ] ) to arrive at the desired set of the multigroup equations : @xmath24 the fourth term on the left hand side is a frequency shift due to the plasma compression .",
    "this term is essentially a conservative advection along the frequency axis .",
    "in the context of the multi - group radiation diffusion , a discussion about the stimulated emission is not less important than lte .",
    "excellent accounts on the stimulated emission exist in the literature , see for instance @xcite . here",
    ", we merely sumarize how the stimulated emission modifies the absorption opacity @xmath25 obtained from , e.g. , opacity tables .",
    "this is important when dealing with externally supplied opacity tables , since the crash code assumes that the absorption opacities are corrected .",
    "integrating the total absorption and emission over all directions and summing up the two polarizations of the photons , the following expression can be derived for the emission and absorption @xmath26 where the effective absorption coefficient , @xmath27 , is introduced to account for the correction due to stimulated emission : @xmath28 \\right),\\ ] ] in which @xmath29 is the photon energy , @xmath30 is the boltzmann constant , and @xmath31 is the electron temperature .",
    "we also introduced the spectral energy density distribution of the black body radiation ( the planckian ) @xmath32 - 1}.\\label{eq : planck}\\ ] ] the total energy density in the planck spectrum equals @xmath33 , where @xmath34 is the radiation constant .",
    "we use the standard definition of the group planck mean opacity @xmath35 and group rosseland mean opacity @xmath36 @xcite @xmath37 in which @xmath38 is the spectral total opacity . the right hand side of equation ( [ eq : multigroup ] ) can now be written as ( see for instance @xcite ) @xmath39 where @xmath40 is the radiation diffusion coefficient for radiation group @xmath20 . the absorption and",
    "emission uses the coefficient @xmath41 .",
    "these group mean opacities are either supplied by lookup tables or by an opacity solver .    in a single group approximation ( gray diffusion ) , the spectral energy density is integrated over all photon frequencies and the total radiation energy density is obtained by @xmath42 this amounts to summing up all groups @xmath43 .",
    "the gray radiation diffusion equation can be derived as ( see for instance @xcite ) @xmath44 where the diffusion coefficient @xmath45 is now defined by the single group rosseland mean opacity @xmath46 as @xmath47 , and the absorption coefficent @xmath48 is defined in terms of the single group planck mean opacity @xmath49 as @xmath50 .      in the crash code , a single fluid description is used , so that all of the atomic and ionic species as well as the electrons move with the same bulk velocity @xmath13 . the conservation of mass @xmath51 provides the time evolution of the mass density @xmath52 of all the materials in the simulation .",
    "the plasma velocity is obtained from the conservation of momentum @xmath53 = 0 .",
    "\\label{eq : momentum}\\ ] ] the total plasma pressure is the sum of the ion and electron pressures : @xmath54 .",
    "the net force of the radiation on the plasma is given by the gradient of the total radiation pressure @xmath55 , where the total radiation pressure is obtained from the group radiation energies : @xmath56 .",
    "in a high density plasma , the electrons are very strongly coupled to the ions by collisions . however , for higher temperatures , the electrons and ions get increasingly decoupled . at a shock front , where ions are preferentially heated by the shock wave , the electrons and ions are no longer in temperature equilibrium .",
    "ion energy is transfered to the electrons by collisions , while the electrons will in turn radiate energy .",
    "we therefore solve separate equations for the ion / atomic internal energy density @xmath57 and the electron internal energy density @xmath58 : @xmath59 the coupling coefficient @xmath60 in the collisional energy exchange between the electrons and ions depends on the relaxation time @xmath61 and the atomic number density @xmath62 .",
    "the energy transfer depends also on the difference between the ion temperature @xmath63 and the electron temperature @xmath31 . in equation ( [ eq : electronenergy ] )",
    ", we have included the electron thermal heat conduction with conductivity @xmath64 .",
    "since the electrons are the species that are responsible for the radiation absorption and emission , the energy exchange between the electrons and the radiation groups is added to equation ( [ eq : electronenergy ] ) .    for the development of the numerical schemes in section [ sec : method ] we will use an equation for the conservation of the total energy density @xmath65 instead of the equation for the ion internal energy ( [ eq : ionenergy ] ) .",
    "this is especially important in regions of the computational domain where hydrodynamic shocks can occur , so that we can recover the correct jump conditions .",
    "the conservation of the total energy can be derived from equations ( [ eq : groupenergy ] ) and ( [ eq : density])([eq : electronenergy ] ) as @xmath66    = \\nabla\\cdot(c_e\\nabla t_e ) +    \\sum_{g=1}^g \\nabla\\cdot\\left ( d_g\\nabla e_g\\right ) .",
    "\\label{eq : energycons}\\ ] ] the frequency shift term in equation ( [ eq : groupenergy ] ) due to the plasma compression does not show up in the conservation of the total energy if we use energy conserving boundary conditions at the end points of the frequency domain , i.e. at @xmath67 and @xmath68 in the analytical description or at the end points of the numerically truncated finite domain .",
    "in many of the crash applications , we need a procedure to distinguish between different materials .",
    "we assume that the materials do not mix , but differ from each other by their properties such as the equation of state and opacities .",
    "if we use @xmath69 different materials , then we can define for each material @xmath70 the level set function @xmath71 that is initially set to zero at the material interface , while positive inside the material region and negative outside .",
    "generally , we use a smooth and signed distance function in the intial state . at later times , the location of material @xmath72 is obtained by means of a simple advection equation @xmath73 for any given point in space and time , we can determine what the material is , since analytically only one of the level set functions @xmath74 can be positive at any given point",
    ". numerical errors will create regions where this is not true .",
    "in practice we take the largest @xmath74 .",
    "this is a simple approximation , we may explore more sophisticated approaches in the future",
    ". the number of material levels @xmath69 can be configured at compile time .",
    "we have implemented eos solvers and a code to calculate the frequency averaged group opacities .",
    "the implemention will be reported elsewhere , but mention that in the eos and opacity solver the temperature is assumed to be well below the relativistic values : @xmath75ev .",
    "the non - relativistic speed of motion is also assumed while simplifying the radiation transport equation and to neglect the relativistic corrections for opacities . in this paper",
    ", we will assume that all necessary quantities are calculated and stored in lookup tables .",
    "our eos solver assumes that the corrections associated with ionization , excitation , and coulomb interactions of the partially ionized ion - electron plasma are all added to the energy of the electron gas and to the electron pressure .",
    "this is possible since those corrections are controlled by the electron temperature .",
    "the ion internal energy density , ion pressure , and ion specific heat in an isochoric process per unit of volume are simply @xmath76 which are due to the contributions due to ion translational motions for which @xmath77 .",
    "the relations among the electron internal energy density , pressure , density , and temperature are known as the eos .",
    "to solve these relations is usually complex and time consuming . we therefore store these relations in invertible lookup tables . for each material @xmath72 ,",
    "our eos tables have the logarithmic lookup arguments @xmath78 .",
    "the list of quantities stored in these tables is indicated in table [ table : eos ] .",
    "these lookup tables are populated with quantities that are needed for both single temperature and two temperature simulations . for two - temperature plasma simulations",
    ", we will need @xmath79 , @xmath58 , the electron specific heat @xmath80 , the electron speed of sound gamma @xmath81 .",
    "for convenience we added the total pressure @xmath82 , total internal energy density @xmath83 , single temperature specific heat @xmath84 , and the single temperature speed of sound gamma @xmath85 , which can be used in single temperature simulations .",
    "we use high enough table resolutions so that it is sufficient to use a bilinear interpolation in the lookup arguments .",
    "if @xmath79 or @xmath58 ( or @xmath86 and @xmath87 in single temperature mode ) are known on entry of the lookup instead of @xmath31 , we do a binary search in the table to find the appropriate electron temperature .",
    "the latter only works as long as the necessary thermodynamic derivatives are sign definite , i.e. the table is invertible .",
    "other thermodynamic quantities that are needed , but not stored in these lookup tables , can be derived .",
    "for example , the electron density can be obtained from the mean ionization @xmath88 .",
    "in addition , we have lookup tables for the averaged multigroup opacities .",
    "these tables are either constructed internally for a given frequency range , number of groups , and the selected materials , or externally supplied . for any material @xmath72 ,",
    "the logarithmic lookup arguments are @xmath89 .",
    "the stored quantities , see table [ table : opacity ] , are the specific rosseland mean opacity @xmath90 and the specific planck mean opacity @xmath91 for all groups @xmath19 that are used during a simulation .",
    "the planck opacities are assumed to be corrected for the stimulated emission , as discussed in section [ sec : radtrans ] .",
    "the groups are always assumed to be logarithmically distributed in the frequency space .",
    "radiation diffusion theory can transport energy too fast in the optically thin free streaming limit . in the diffusion limit",
    ", the radiation diffusion flux for each group follows fick s law @xmath92 , where the diffusion coefficient @xmath93 depends on the rosseland mean opacity @xmath36 for the group @xmath20 via @xmath94 .",
    "this flux is however not bounded . in the optically thin free - streaming limit",
    ", the magnitude of the radiation flux can be at most @xmath95 in order to maintain causality .",
    "various flux limiters exist in the literature , see for instance @xcite , that ensure that the diffusion flux is limited by this free streaming flux .",
    "we implemented the so - called square - root flux limiter to obtain the correct progation speed in the optically thin regime @xcite .",
    "for this flux limiter , the diffusion coefficient is rewritten as @xmath96 in the limit that the radiation length scale @xmath97 is large , the diffusive limit is recovered . for a small radiation length scale , @xmath98 and the radiation propagates with the speed of light .",
    "similarly , we implemented the option to limit the electron thermal heat flux ( see @xcite for more details on electron flux limiters ) .",
    "the classical spitzer - harm formula for the collisional electron conductivity is proportional to @xmath99 , where @xmath100 is the mean square ionization of the used material .",
    "the collisional model is only valid when the temperature scale length @xmath101 is much larger than the collisional mean free path of the electrons @xmath102 .",
    "when the temperature scale length is only a few @xmath102 or smaller , this description breaks down . this may for instance happen in laser - irradiated plasmas .",
    "one could in that case find the heat flux from solving the fokker - planck equation for the electrons , but this is computationally expensive .",
    "instead , we use a simplified model to limit the electron heat flux . a free - streaming heat flux can be defined as the thermal energy density in the plasma transported at some characteristic thermal velocity : @xmath103 , where @xmath104 . for practical applications ,",
    "the maximum heat transport is usually only a fraction of this free - streaming flux : @xmath105 , where @xmath106 is the so - called flux limiter .",
    "this heat flux model is the threshold model and is also used in other radhydro packages , such as hyades @xcite .",
    "the flux - limited heat flux can now be defined as @xmath107 the flux limiter @xmath106 is an input parameter and can be tuned to let the simulated results better fit reality .",
    "in this section , we describe the discretization of the set of multi - material , radiation hydrodynamics equations for the density ( [ eq : density ] ) , momentum ( [ eq : momentum ] ) , total energy ( [ eq : energycons ] ) , electron internal energies ( [ eq : electronenergy ] ) , radiation group energy ( [ eq : groupenergy ] ) , and material level set functions ( [ eq : levelset ] ) .",
    "the equations are time integrated using an operator split method to solve the equations in substeps . formally , we may write this system as @xmath108 where @xmath109 is the vector of state variables .",
    "we have split the right hand sides of the equations into three parts and time advance the equations with an operator splitting method in the following order : ( 1 ) the right hand side @xmath110 describes the advection and pressure contributions ( section [ sec : hydro ] ) .",
    "this part is essentially the ideal hydrodynamic equations augmented with the advection and compression of the radiation energy , the electron internal energy , and the material level sets .",
    "( 2 ) the right hand side @xmath111 is the advection of the radiation field in frequency space ( section [ sec : frequency ] ) . (",
    "3 ) the right hand side @xmath112 takes care of the diffusion and energy exchange terms , which we will solve with an implicit scheme ( section [ sec : implicit ] ) .",
    "the operator splitting is not unique . instead of splitting the hydrodynamic advection operator and the extra advance operator for the frequency advection ,",
    "one may attempt to discretize the frequency advection flux as an extra flux for the control volume of the four - dimensional @xmath113 space . however , since the crash code is built around the existing bats - r - us code in 1d , 2d , and 3d , we opted for splitting the frequency advection from the hydro update .",
    "the boundary conditions are treated in section [ sec : boundary ] .      in the first step of the operator splitting , we update the hydrodynamic equations including the advection and compression of the radiation energy density , electron internal energy density and the level sets .",
    "we have implemented two variants to solve the hydrodynamic equations : ( 1 ) using conservation of the total energy ( section [ sec : conservative ] ) and ( 2 ) a non - conservative pressure formulation ( section [ sec : nonconservative ] ) .",
    "we can combine the two discretizations in a hybrid manner a simulation .",
    "we have implemented several hydrodynamic shock - capturing schemes in the crash code : the hlle scheme @xcite , the rusanov scheme @xcite , and a godunov scheme @xcite with an exact riemann solver . in this section",
    ", we will explain how we generalized the hlle scheme for our system of equations that includes radiation , level sets , and an eos .",
    "the other hydrodynamic schemes can be generalized in a similar fashion .",
    "typical hydrodynamic solvers in the literature assume constant @xmath114 .",
    "our problem is to generalize the constant @xmath114 hydro solvers for the case of spatially varying polytropic index , @xmath115 , due to ionization , excitation and coulomb interactions .",
    "a method that is applicable to all the aforementioned , constant @xmath114 , hydrodynamic shock - capturing schemes is to split the electron internal energy @xmath58 density as the sum of an ideal ( translational ) energy part @xmath116 and an extra internal energy density @xmath117 .",
    "similarly , we can define an ideal total energy density @xmath118 which is related to the total energy density by @xmath119 .",
    "we will time advance @xmath79 with the ideal electron pressure equation and @xmath117 by a conservative advection equation , and then apply a correction step as described below .    the time update with the operator @xmath110 solves the following equations : @xmath120 = 0 , \\\\",
    "\\frac{\\partial e_i}{\\partial t } & + & \\nabla\\cdot\\left [ ( e_i+p+p_r ) { \\mathbf{u } } \\right ]    = 0,\\label{eq : hdenergy}\\\\    \\frac{1}{\\gamma-1}\\frac{\\partial p_e}{\\partial t } & + &    \\frac{1}{\\gamma-1}\\nabla\\cdot(p_e { \\mathbf{u } } ) + p_e { \\mathbf{\\nabla } \\cdot { \\mathbf{u } } } = 0 , \\label{eq : hdelectronenergy } \\\\    \\frac{\\partial e_x}{\\partial t } & + & \\nabla\\cdot \\left [ e_x { \\mathbf{u } } \\right ]    = 0 , \\label{eq : hdextra } \\\\",
    "\\frac{\\partial e_g}{\\partial t } & + & \\nabla\\cdot(e_g { \\mathbf{u } } )    + ( \\gamma_r - 1)e_g { \\mathbf{\\nabla } \\cdot { \\mathbf{u } } } = 0 , \\label{eq : hdradiation } \\\\    \\frac{\\partial d_m}{\\partial t } & + & \\nabla\\cdot ( d_m { \\mathbf{u } } ) - d_m { \\mathbf{\\nabla } \\cdot { \\mathbf{u } } } = 0 ,    \\label{eq : hdlevel}\\end{aligned}\\ ] ] where the frequency advection , diffusion , and energy exchange terms are ommitted in this first operator step . after each time",
    "advance from time @xmath121 to time @xmath122 , we have to correct @xmath123 , @xmath124 , @xmath79 , and @xmath117 .",
    "we denote the uncorrected variables with a superscript @xmath125 , then we recover at time level @xmath126 the true electron internal energy @xmath127 and the true total energy density @xmath128 by @xmath129 since both @xmath124 and @xmath117 follow a conservation law , the total energy density @xmath123 is also conserved .",
    "the true electron pressure is recovered from the updated electron internal energy and mass density by means of the eos : @xmath130 where the function @xmath131 can be either a calculated eos or an eos lookup table for material @xmath72 , determined by the level set functions @xmath132 ( section [ sec : levelset ] ) .",
    "the extra internal energy @xmath117 is reset as the difference between the true electron internal energy and the ideal electron internal energy for @xmath77 : @xmath133 this is postive because the eos state @xmath131 satisfies @xmath134 at all times .",
    "the ideal part of the total energy density at time level @xmath126 can now be updated as @xmath135 we have now recovered @xmath128 , @xmath136 , @xmath137 , and @xmath138 at time @xmath122 .    we time advanced the hydrodynamic equations to the time level @xmath125 with a shock - capturing scheme with a constant @xmath77 .",
    "for an ideal eos , the speed of sound of the equations ( [ eq : hddens])([eq : hdradiation ] ) can be derived as @xmath139 which includes the modifications due to the presence of the total radiation pressure .",
    "this speed of sound will be used in the hydro scheme below .",
    "since the crash eos solver always satisfies @xmath140 and @xmath141 , the speed of sound for the ideal eos is always an upper bound for the true speed of sound .",
    "we use shock - capturing schemes to advance the equations ( [ eq : hddens])([eq : hdlevel ] ) . in the following",
    ", we denote the ( near ) conservative variables by @xmath142 and let @xmath143 be grid cell averages in the standard finite volume sense . if we assume for the moment a 1d grid with spacing @xmath144 , cell center index @xmath145 and cell face between cell @xmath145 and @xmath146 identified by half indices @xmath147 , then we can write the two - stage runge - kutta hydro update as @xmath148 where @xmath106 is the numerical flux . in particular , the hlle flux @xmath106 equals the physical flux @xmath149 when @xmath150 , @xmath151 when @xmath152 , and in all other cases it uses the weighted flux @xmath153 here , the left and right cell face states are @xmath154 we use the generalized koren limiter , and define the limited slopes as @xmath155 , \\\\",
    "\\bar{\\delta}^ru_i & = & { \\rm minmod}\\left [ \\beta ( u_{i+1}-u_i ) ,      \\beta ( u_i - u_{i-1 } ) , \\frac{u_{i+1}-u_i-2u_{i-1}}{3 } \\right],\\end{aligned}\\ ] ] for the extrapolations from the left and right .",
    "this reconstruction can be third order in smooth regions away from extrema @xcite .",
    "the parameter @xmath156 can be changed between 1 and 2 , but in simulations with adaptive mesh refinement we have best experience with @xmath157 .",
    "we generally apply the slope limiters on the primitive variables @xmath158 , instead of the conservative variables .",
    "we apply the slope limiter on @xmath159 instead of @xmath117 since @xmath159 is smoother at shocks and across material interfaces .",
    "a multi - dimensional update is obtained by adding the fluxes for each direction in a dimensionally unsplit manner .",
    "after each stage of the two step runge - kutta , we correct for the eos effects via the update procedure outlined in equations ( [ eq : fixstart])([eq : fixstop ] ) .      in regions away from shocks it is sometimes more important to preserve pressure balance than to have a shock capturing scheme that recovers the correct jump conditions .",
    "this is especially important at material interfaces .",
    "we therefore have implemented the option to solve the hydro part of the pressure equations @xmath160 instead of the equations for the total energy ( [ eq : hdenergy ] ) and the electron internal energy ( [ eq : hdelectronenergy ] ) .",
    "as long as the speed of sound gamma for the electrons @xmath161 is smaller than @xmath77 , the numerical scheme is stable .",
    "contrary to the energy conserving scheme , the pressure based scheme can directly include the eos and we no longer need the time evolution of the extra internal energy density ( [ eq : hdextra ] ) .",
    "the eos contribution in the electron pressure equation ( [ eq : pressuresolve ] ) is implemented as a source term @xmath162 added to the ideal electron pressure equation .    to facilitate using both the shock capturing properties and the pressure balance at the material interfaces during crash simulations , we have several criteria to automatically switch between them accordingly .",
    "one of the criteria , for instance , uses a detection of steep pressure gradients as a shock identification",
    ". the user can select the magnitude of the pressure gradient above which the scheme switches to the conservative energy equations .",
    "the set of multigroup equations ( [ eq : groupenergy ] ) contain an integral over the group photon frequencies . performing this integration ,",
    "the frequency advection update by the @xmath111 operator can be written as @xmath163 = 0 .",
    "\\label{eq : groupbounds}\\ ] ] these equations , however , do still depend on the unknown photon frequency @xmath2 and the spectral radiation energy density @xmath164 .",
    "we will now restrict the analysis to a frequency grid that is uniformly spaced in the frequency logarithm , i.e. , @xmath165 for large enough number of frequency groups @xmath166 , the group energy @xmath22 can then be approximated as the product of the photon frequency , spectral radiation energy @xmath164 , and the logarithmic group spacing @xmath167 : @xmath168 using this approximation in equation ( [ eq : groupbounds ] ) , we obtain our final form of the frequency advection @xmath169 where @xmath170 is the frequency advection speed .",
    "the values @xmath171 are to be interpolated from the mesh - centered values @xmath22 towards the group boundaries .",
    "the frequency advection is a conservative linear advection in the log - frequency coordinate , for which the physical flux is defined as @xmath172 .",
    "for the boundary conditions in the frequency domain we assume zero radiation flux so that no radiation will leak at the edges of the frequency domain . equation ( [ eq : closed ] ) can be discretized with the one - stage second order upwind scheme @xmath173 where time level @xmath125 is now the state after the hydro update and the numerical flux is @xmath174 , \\qquad u_\\nu\\le0,\\nonumber\\\\    f_{g-1/2 } & = & u_\\nu    \\left[e_{g-1}+\\frac{1-{\\rm c}}{2}\\bar{\\delta }      ( e_g - e_{g-1},e_{g-1}-e_{g-2})\\right ] , \\qquad u_\\nu\\ge0.\\label{eq : mg9}\\end{aligned}\\ ] ] and we use the superbee limiter @xcite for the limited slope @xmath175 .",
    "the courant - friedrichs - levi number @xmath176 depends on the hydrodynamic time - step @xmath177 .",
    "if c is larger than one , the frequency advection is sub - cycled with the number of steps equal to the smallest integer value larger than c.      the stiff parts of the radhyro equations are solved implicitly in an operator split fashion .",
    "these stiff parts are the radiation energy diffusion , electron heat conduction , and the energy exchange between the electrons and each energy group @xmath20 and between the electrons and ions . in this section",
    ", we will describe two implicit schemes that are implemented : ( 1 ) solving for all radiation groups , electron and ion temperatures in a coupled manner ( section [ sec : unsplit ] ) , and ( 2 ) solving each radiation group energy and the electron temperature independently ( section [ sec : split ] ) .",
    "our strategy for resolution changes is described in appendix [ sec : reschange ] , while the modifications for the @xmath7-geometry are explained in appendix [ sec : rz ] .",
    "discretizing the diffusion and energy exchange terms of equations ( [ eq : ionenergy])([eq : electronenergy ] ) , and ( [ eq : groupenergy ] ) implicitly in time leads to @xmath178 where time level @xmath125 now corresponds to the state after the hydro update and the frequency advection .",
    "the coupling coefficients @xmath179 and @xmath180 and the diffusion coefficients @xmath181 and @xmath182 are taken at time level @xmath125 ( frozen coefficients ) .",
    "one can either ( 1 ) solve the coupled system of @xmath183 equations ( [ eq : implionenergy])([eq : implgroupenergy ] ) implicitly or ( 2 ) solve equation ( [ eq : implionenergy ] ) for the ion internal energy @xmath184 , substitute the solution back into equation ( [ eq : implelectronenergy ] ) , and solve the resulting reduced set of @xmath185 equations ( [ eq : implelectronenergy])([eq : implgroupenergy ] ) implicitly .",
    "here we describe the second scheme , because it is more efficient , especially for small number of groups , e.g. , for gray radiation diffusion .",
    "note that if we did include ion heat conduction in ( [ eq : implgroupenergy ] ) , then we would have to solve the entire coupled system of equations .",
    "first we introduce the ion planck function @xmath186 as a new variable similar to the electron planck function @xmath187 , and replace @xmath57 and @xmath58 with these variables using the chain rule @xmath188 in which @xmath189 and @xmath80 are the specific heats of the ions and electrons , respectively . now equation ( [ eq : implionenergy ] )",
    "can be replaced with @xmath190 where @xmath191 is again taken at time level @xmath125 .",
    "the numerator comes from @xmath192 .",
    "equation ( [ eq : planckion ] ) can be solved for @xmath193 .",
    "this result can be substituted into the electron internal energy equation ( [ eq : implelectronenergy ] ) to obtain @xmath194 where we have introduced new coefficients at time level @xmath125 : @xmath195 the planck weights @xmath196 satisfy @xmath197 .",
    "it is convenient to introduce the changes @xmath198 and @xmath199 to arrive at @xmath200 \\delta b    & - & \\sum_{g=1}^g \\sigma_g^ * ( \\delta e_g - w_g^ * \\delta b )    = \\sigma_{ie}''(b_i^ * - b^ * ) \\nonumber \\\\    & + & \\nabla\\cdot c_e'\\nabla b^ *     + \\sum_{g=1}^g\\sigma_g^*(e_g^ * - w_g^ * b^ * ) , \\label{eq : implelectronnoncos}\\\\    \\left [ \\frac{1}{\\delta t } - \\nabla\\cdot d_g^*\\nabla \\right ] \\delta e_g    & - & \\sigma_g^*(w_g^*\\delta b - \\delta e_g ) = \\sigma_g^*(w_g^*b^ * - e_g^ * )    + \\nabla\\cdot d_g^ * \\nabla e_g^*.\\label{eq : implgroupnoncons}\\end{aligned}\\ ] ] this is a coupled system of @xmath185 linearized equations for the changes @xmath201 and @xmath202 .",
    "the right hand sides are all at time level * .",
    "a discrete set of equations are obtained by applying the standard finite volume method to the equations ( [ eq : implelectronnoncos ] ) and ( [ eq : implgroupnoncons ] ) and partitioning the domain in a set of control volumes @xmath203 , enumerated by a single index @xmath204 . as an example , the fluxes @xmath205 associated with the radiation diffusion operator may be obtained by approximating the gradient of the group energy density with a simple central difference in the uniform part of the mesh : @xmath206 where the index @xmath207 enumerates the control volumes which have a common face with the control volume @xmath145 , the face area being @xmath208 , and the distance between the cell centers is @xmath209 .",
    "note that we assumed here an orthogonal mesh .",
    "generalization to curvilinear grids can be done as shown in @xcite .",
    "the diffusion coefficients at the face are obtained by simple averaging of the cell centered diffusion coefficient : @xmath210 .",
    "the discretization of the diffusion operator at resolution changes is described in appendix [ sec : reschange ] .    the linear system ( [ eq : implelectronnoncos])([eq : implgroupnoncons ] )",
    "can be written in a more compact form as the linearized implicit backward euler scheme @xmath211 where @xmath109 are the @xmath212 state variables @xmath213 and @xmath22 for all @xmath214 control volumes , and @xmath215 .",
    "@xmath216 is defined by the spatially discretized version of the right hand side of equations ( [ eq : implelectronnoncos ] ) and ( [ eq : implgroupnoncons ] ) .",
    "the matrix @xmath217 is a @xmath218 block matrix consisting of @xmath219 sub - matrices .",
    "this matrix @xmath220 is in general non - symmetric due to the planck weight @xmath221 in the energy exchange between the radiation and electrons . to solve this system we use krylov sub - space type iterative solvers , like gmres @xcite or bi - cgstab @xcite . to accelerate the convergence of the iterative scheme , we use a preconditioner . in the current implementation of crash",
    ", we use the block incomplete lower - upper decomposition ( bilu ) preconditioner , which is applied for each adaptive mesh refinement block independently . for gray radiation diffusion",
    "the planck weight is one and the matrix @xmath220 can be proven to be symmetric positive definite ( spd ) for commonly used boundary conditions ( see for example @xcite ) .",
    "in that case we can use a preconditioned conjugate gradient ( pcg ) scheme ( see for instance @xcite ) .",
    "for some verification tests , we can attempt to go second order in time under the assumption of temporally constant coefficients using the crank - nicolson scheme @xmath222 with @xmath223 . the implicit residual can again be linearized @xmath224 to obtain the linear system of equations @xmath225 we use the same iterative solvers as for the backward euler scheme .",
    "finally , we show how we use the solution @xmath201 and @xmath202 for @xmath19 from the non - conservative equations ( [ eq : implelectronnoncos ] ) and ( [ eq : implgroupnoncons ] ) to advance the solution of the original equations ( [ eq : implionenergy])([eq : implgroupenergy ] ) and still conserve the total energy .",
    "one needs to express the fluxes and energies on the right hand side in the latter equations in terms of @xmath226 and @xmath227 while still keeping the coefficients frozen .",
    "after some algebra we obtain @xmath228 this update conserves the total energy to round - off error .",
    "note that at this final stage , taking too large time step may result in negative ion internal energy @xmath184 if @xmath229 and negative electron internal energy @xmath127 if @xmath230 .",
    "if this happens , the advance might be redone with a smaller time step , to limit the drop in @xmath213 , or by some other timestep control scheme .",
    "a generalization of the conservative update to the crank - nicolson scheme is also implemented for verification tests with time constant coefficients .    for completeness",
    ", we mention that in the absence of radiation we solve during the implicit step for the temperatures @xmath31 and @xmath63 instead of the radiation energy - like variables @xmath231 and @xmath232 . in that case",
    "the corresponding matrix @xmath220 is always spd . in principle , the formulation in temperatures can be generalized to radiation as well . in @xcite ,",
    "a spectral temperature @xmath233 is defined , such that the spectral energy density is locally equal to the spectral planckian energy density at the temperature @xmath234 : @xmath235 .",
    "this relationship is a one - to - one map . a group temperature , @xmath236 ,",
    "can also be introduced as the discrete analog such that the group energy density can be obtained by @xmath237 the equation ( [ eq : implgroupenergy ] ) can be recast as equation for the group temperature @xmath236 .",
    "this introduces the group specific heat of the radiation @xmath238 .",
    "the set of equations ( [ eq : implionenergy])([eq : implgroupenergy ] ) reformulated as an implicit backward euler scheme for the temperatures @xmath63 , @xmath31 , and @xmath236 can in a similar way as in @xcite be proven to be spd . while this scheme has the advantage of being spd , the conservative update of the group energy density @xmath239 might result in negative energy density @xmath227 for too large time steps .",
    "the coupled implicit scheme of section [ sec : unsplit ] requires the solution of a large system of equations ( @xmath185 variables per mesh cell ) .",
    "the preconditioning for such a system can be computationally expensive and requires overall lots of memory .",
    "we therefore also implemented a decoupled implicit scheme that solves each equation independently .",
    "for some applications , the electron temperature does not change much due to energy exchange with the radiation .",
    "this is typically so if the electrons have a much larger energy density than the radiation , so that @xmath31 changes little due to the interaction with the radiation in a single time step . in that case , we solve first for the electron and ion temperatures without the contributions from the radiation - electron energy exchange . let again time level @xmath125 indicate the state after the hydro update and frequency advection , and freeze again @xmath181",
    ", @xmath182 , @xmath179",
    ", @xmath180 at time level @xmath125 . discretization in time now leads to @xmath240 where the time level @xmath241 of @xmath58 indicates that we still have to do an extra update to time level @xmath126 with the radiation - electron energy exchange .",
    "each radiation group energy density is solved independently using time level @xmath125 for the electron temperature in @xmath242 : @xmath243 where we have exploited the assumption that @xmath242 is not stiff .",
    "equations ( [ eq : splitionenergy])([eq : splitgroupenergy ] ) can be recast in equations for the @xmath185 independent changes @xmath244 and @xmath245 : @xmath200 \\delta b    & = & \\sigma_{ie}''(b_i^ * - b^ * ) + \\nabla\\cdot c_e'\\nabla b^ * ,    \\label{eq : splitelectronnoncos } \\\\",
    "\\left [ \\frac{1}{\\delta t } + \\sigma_g^ * - \\nabla\\cdot d_g^*\\nabla \\right ]    \\delta e_g & = & \\sigma_g^*(w_g^*b^ * - e_g^ * )    + \\nabla\\cdot d_g^ * \\nabla e_g^*.\\label{eq : splitgroupnoncons}\\end{aligned}\\ ] ] where we have used the definitions ( [ eq : freeze1 ] ) , ( [ eq : freeze2 ] ) , and ( [ eq : freeze3 ] ) of the coefficients , frozen at time level @xmath125 .",
    "each equation for the changes is in the form of the linearized implicit backward euler scheme ( [ eq : euler ] ) and can be solved independently with iterative solvers like gmres and bi - cgstab using a bilu preconditioner .",
    "as long as the boundary conditions are such that the matrices are symmetric and positive definite , the preconditioned conjugate gradient method might also be used .    in a similar manner as with the coupled implicit scheme ,",
    "a conservative update for the energy densities can be derived as @xmath246 that preserve the total energy to roud - off errors .",
    "the main difference between the conservative update in the coupled and decoupled schemes is that here the energy exchange between the radiation and electrons is added afterwards as the last term in equation ( [ eq : conseeupdate ] ) .",
    "this scheme requires less computational time for preconditioning and the krylov solver than the coupled implicit algorithm , however it generally needs more message passing in parallel computations .",
    "it is therefore not always guaranteed that the decoupled scheme is faster .",
    "the memory usage is always smaller .",
    "the crash code allows for any user specified type of boundary conditions .",
    "several commonly used boundary conditions are readily available in the main code for convenience , e.g. , fixed , extrapolation with zero gradient , periodic , and reflective boundary conditions .    for the radiation field ,",
    "we have implemented a zero or fixed incoming flux boundary condition that is used instead of the extrapolation with zero gradient .",
    "this type of boundary condition is useful if there are no sources of radiation outside the computational domain and we assume that outflowing radiation does not return back into the computational domain ( zero albedo ) .",
    "note that simple extrapolation with zero gradient can make the radiation diffusion problem ill - posed .",
    "the boundary condition is derived as follows : radiation diffusion approximation corresponds to a linear - in - angle intensity distribution @xmath247 so we can calculate the radiation flux through a boundary surface . if we define the outward pointing normal vector of the boundary as @xmath248 , the net flux of radiation energy inward through this boundary",
    "is @xmath249 where the closure ( [ eq : closure ] ) is used . in the radiation diffusion model ,",
    "the flux is written as @xmath92 , where the diffusion coefficient @xmath93 is a nonlinear function of @xmath22 and @xmath250 in a flux limited diffusion model .",
    "the boundary condition satisfies @xmath251 for the left boundary in the @xmath252-direction , for instance , this can be discretized as @xmath253 where the index 1 corresponds to the last physical cell and 0 to the ghost cell .",
    "this equation can be solved for the ghost cell value .",
    "for zero incoming radiation flux boundary conditions we set @xmath254 .",
    "to test the crash as well as the bats - r - us and swmf codes , we have implemented numerous tests .",
    "these tests are subdivided in two categories : functionality tests and verification tests .",
    "both test suites are performed automatically and return pass or fail messages depending on whether or not certain predefined tolerance criteria are met .",
    "this automated testing process provides a software quality confidence especially when used in combination with a software version control system like cvs ( concurrent versions system ) to recover previous correctly performing code .",
    "the functionality tests are performed nightly on several computer platforms with different compilers and number of processors .",
    "they consist of unit tests and full system tests .",
    "the unit tests are designed to test a particular unit , for example a linear equation solver .",
    "the full system tests on the other hand , exercise the code in the way the end - users will use it for their research applications .",
    "we always try to cover as much code as possible with these tests so that we can discover bugs and other unwanted side effects early on .    to test the correctness of the implemented algorithms we have also constructed a suite of verification tests .",
    "this suite is executed daily on a dedicated parallel computer and runs specific simulations to quantify against analytic and semi - analytic solutions , whenever possible .",
    "the crash test repository currently covers a wide range of tests for hydrodynamics , multi - material advection methods , gray and multigroup radiation diffusion , heat conduction , to mention a few .",
    "these are performed to test for grid and/or time convergence , as deemed necessary .",
    "we also simulate full system laboratory experiment configurations in various geometries , dimensionality , and physics fidelity .",
    "the results are either validated against laboratory experiments or simply used to check that the code keeps performing these simulations as expected .",
    "once a week , we also perform a parallel scalability test on a large parallel computer to verify that the code does not degrade in performance during further development of the software .    in the following sub - sections , we highlight some specific verification tests related to the implicit radiation ( section [ sec : radverify ] ) and heat conduction ( section [ sec : condverify ] ) solver .",
    "the tests cover both cartesian and @xmath7-geometry , and some of them also involve the hydrodynamic solver . we demonstrate a 3d full system test in section [ sec : fullsystem ] and describe the parallel scalability in section [ sec : parallel ] .      for the assessment of the accuracy of the solutions in the test suites , an appropriate definition of the numerical errors",
    "have to be defined .",
    "we will use two types of errors to quantify the verification analysis : the relative l1 error is defined as @xmath255 where @xmath256 indexes the state variables of numerical solution vector @xmath109 and the reference solution @xmath257 , and @xmath204 indexes the grid cells of the entire computational domain . for test problems with smooth solutions , we will also use the relative maximum error defined by @xmath258 quite often the reference solution is defined on a grid with higher resolution than that of the numerical solution . in that case",
    ", we first coarsen the reference solution to the resolution of the numerical solution .",
    "@xcite developed a one - dimensional marshak wave test , to check the accuracy of the scheme and the correctness of the implementation of the time - dependent non - equilibrium gray radiation diffusion model . in this test ,",
    "radiation propagates through a cold medium that is initially in absence of radiation .",
    "the equations are linearized by the choice of the specific heat of the material @xmath259 as well as by setting the rosseland and planck opacities to the same uniform and time - independent constant @xmath260 .",
    "the cold medium is defined on a half - space of the slab geometry @xmath261 . at the boundary on the left ,",
    "a radiative source is specified , creating an incident radiation flux of @xmath262 , where @xmath263kev .",
    "as time progresses , the radiation diffuses through the initially cold medium and by energy exchange between radiation and matter , the material temperature will rise . in @xcite , a semi - analytical solution is derived for the time evolution of the radiation energy and material temperature .",
    "we will use this solution for this verification test .    for convenience , we locate the right boundary at the finite distance @xmath264 cm and impose a zero incoming radiation flux on that boundary .",
    "we decompose the computational domain in 6 grid blocks at the base level with 10 cells per block . between @xmath265 cm and @xmath266 cm ,",
    "the domain is refined by one level of amr . during the time evolution , the radiation diffuses to the right through the resolution changes .",
    "the system is time evolved with the implicit radiation diffusion solver by using a preconditioned conjugate gradient method till the final time @xmath267ns .",
    "the solver steps through a series of fixed time steps of @xmath268ns and we use a crank - nicolson approach to achieve second order accurate time - integration .",
    "note that this is possible because coefficients of the matrix to be solved are not time dependent .",
    "the computed radiation and material temperatures at the final time are shown in figure [ fig : suolsontemp ] and agree well with the semi - analytical solution .",
    "figure [ fig : suolsonerror ] shows the relative l1 error of the radiation and material teperatures versus increasing grid resolution of the base level grid .",
    "we did not use the semi - analytical solution as the reference , since it is difficult to get an accurate enough solution with the quadrature method as mentioned by @xcite .",
    "instead , we use a very high resolution ( 1920 cells ) numerical reference solution obtained with the crash code .",
    "four different base level resolutions with 60 , 120 , 240 , and 480 cells are used to demonstrate the second order convergence .",
    "the time step is proportional to the cell size @xmath144 .",
    "@xcite designed several shock tube problems for the non - equilibrium gray radiation diffusion coupled to the hydrodynamic equations that can be used for code verification .",
    "these solutions are planar radiative shock waves where the material and radiation temperatures are out of equilibrium near the shock , but far from the shock the flow is assumed to be in radiative equilibrium . depending on the mach number of the pre - shock state , a wide range of shock behavior can occur .",
    "for the crash test suite , we selected a few of the semi - analytic solutions from @xcite . in this section",
    "we will describe the mach 1.05 flow with uniform opacities as an example . here",
    "the shock is smoothed out by the energy exchange with the diffusive radiation .",
    "another more challenging mach 5 problem with non - uniform opacities will be described in section [ sec : lowrie3 ] .",
    "the mach 1.05 test is performed on a 2d non - uniform grid .",
    "the initial condition is taken to be the same as the original steady state reference solution .",
    "since the system of equations is galilean invariant , we can add an additional velocity -1.05 so that the velocity on the left boundary is zero while the smoothed shock will now move to the left . this new initial condition as well as the velocity vector",
    "are rotated by @xmath269 .",
    "this means that there is a translational symmetry in the @xmath270 direction of the @xmath271-plane as shown in figure [ fig : lowrie1grid ] .",
    "the computational domain is @xmath272 by @xmath273 decomposed in @xmath274 grid blocks of @xmath275 cells each .",
    "we apply one level of refinement inside the region @xmath276 by @xmath277 .",
    "the initial smoothed shock starts at the right boundary of the refined grid and we time evolve the solution till it reaches the resolution change on the left as shown in figure [ fig : lowrie1grid ] .",
    "for the boundary conditions in the @xmath252 direction we use zero radiation influx conditions for the radiation field , while zero gradient is applied to the remaining state variables . on the @xmath278 boundaries ,",
    "we apply a sheared zero gradient in the @xmath270 direction for all variables .",
    "the hydrodynamic equations are time evolved with the hlle scheme with a cfl number 0.8 .",
    "we use the generalized koren limiter with @xmath279 for the slope reconstruction . for the implicit radiation diffusion solver",
    ", we use the gmres iterative solver in combination with a bilu preconditioner .",
    "the specific heat is time dependent since it depends on the density , therefore the implicit scheme is only first order accurate in time . to enable second order grid convergence for this smooth test problem ,",
    "we compensate this by reducing cfl number proportional to the grid cell size , in other words @xmath280 , so that second order accuracy with respect to @xmath144 can be achieved .",
    "we increase the spatial resolution by each time doubling the number of grid blocks at the base level in both the @xmath252 and @xmath278 directions .",
    "the convergence of the numerically obtained material and radiation temperatures along the @xmath281 cut at the final time @xmath282 is shown in figure [ fig : lowrie1temp ] .",
    "the solid , dotted , and dashed lines correspond to the solutions with the @xmath274 , @xmath283 , and @xmath284 base level grid blocks , respectively .",
    "the advected semi - analytical reference solution is shown as a blue line for comparison .    to assess the order of accuracy",
    ", the grid convergence is shown in figure [ fig : lowrie1error ] for the three resolutions .",
    "the relative l1 error is calculated using the density , velocity components , and both the material and radiation temperatures .",
    "we obtain second order convergence for both the conservative as well as the non - conservative ( using the pressure equation instead of the total energy ) hydrodynamic schemes .",
    "the latter scheme can be used because in the mach 1.05 test the hydro shock is smoothed out by the interaction with the radiation .      as a test for the multigroup radiation diffusion model we developed a double light front test problem .",
    "this test is used to verify the implementation of both the group diffusion and flux limiters . at the light front the discontinuity in the radiation field switches on the flux limiter .",
    "this limiter is used to correct the radiation propagation speed in the optically thin free streaming regime . with the light front test",
    "we can then check that we obtain the speed of light propagation of the front and that the front maintains as much as possible the initial discontinuity .",
    "this test is constructed as follows : we use a 1d computational domain of the size of @xmath285 m in the @xmath252-direction .",
    "on this domain , we initialize the two radiation group energy densities @xmath22 @xmath286 with a very small , positive number to avoid division by zero in the flux limiter .",
    "also the rosseland mean opacities are set to a small number corresponding to strong radiation diffusion , while the planck mean opacities are set to zero corresponding to an optically thin medium .",
    "the radiation energy density of the first group enters from the left boundary by applying a fixed boundary condition with value one in arbitrary units . on the right boundary",
    "this group is extrapolated with zero gradient .",
    "note that these are the proper boundary conditions in the free - streaming limit and not the diffusive flux boundary conditions described in section [ sec : boundary ] .",
    "the second radiation group enters from the right boundary with density one , and it is extrapolated with zero gradient at the left boundary .",
    "we time evolve both groups for @xmath287m@xmath288 seconds .",
    "the analytic solution will then be two discontinuities that have reached @xmath289 m , since both fronts propagate with the speed of light @xmath290 .",
    "the computational domain is non - uniform . in the coarsest resolution",
    "there are 10 grid blocks of 4 cells each at the base level . inside the regions @xmath291 and @xmath292 , we use one level of refinement . the total time evolution is divided into 400 fixed time steps .",
    "we use gmres for the radiation diffusion solver in combination with a bilu preconditioner . for the grid convergence",
    "we reduce the fixed time step quadratically with the grid resolution .",
    "this time step reduction mimics second order discretization in time . in figure",
    "[ fig : lightfront ] , the two group energy densities are shown for the base level grid resolutions 40 , 80 , 160 , and 320 .",
    "clearly , with increasing number of cells , the solution converges towards the reference discontinuous fronts at @xmath293 .    in figure",
    "[ fig : lightfronterror ] , the grid convergence is shown for the four resolutions . the relative l1 error is calculated using both radiation group energy densities and compared to the analytical reference solution with the discontinuities at @xmath293 . in @xcite , it was stated that for a second order difference scheme the convergence rate for a contact discontinuity is 2/3 .",
    "indeed , we find this type of convergence rate , due to the numerical diffusion of the discontinuities , for the light front test .",
    "we have also performed the tests in the @xmath278 and @xmath294 directions to further verify the implementation .",
    "this test is designed to check the relaxation rate between the material and the radiation .",
    "the energy exchange between the material and radiation groups can be written as @xmath295 for a single radiation group , an analytic expression can be found to describe the relaxation in time .",
    "however , for arbitrary number of groups , a time dependent analytic solution is less obvious , except for some rather artificial cases . here",
    "we make the assumption of an extremely large value of the specific heat @xmath84 to make the analysis more tractable . in that case ,",
    "the material temperature is time independent , so that @xmath296 is likewise time independent .",
    "the solution is then @xmath297 assuming @xmath298 initially . at time @xmath299 , the group radiation energy density is @xmath300 . note that this test only needs one computational mesh cell in the spatial domain .",
    "we set @xmath301kev and the resulting planckian spectrum , defined by @xmath296 , is depicted by the dotted line in the left panel of figure [ fig : infinitemedium ] .",
    "we use 80 groups logarithmically distributed over the photon energy domain in the range of 0.1ev to 20kev .",
    "the computed @xmath22 at time @xmath299 are shown as + points .",
    "for the simulation we used the gmres iterative solver and the crank - nicolson scheme . to assess the error , we repeated the test with time steps of @xmath302 , @xmath303 , and @xmath304 of the simulation time .",
    "the second order convergence rate is demonstrated in the right panel of figure [ fig : infinitemedium ] .",
    "this test is designed to verify the implicit heat conduction solver in @xmath7-geometry .",
    "it tests the time evolution of the temperature profile using uniform and time independent heat conductivity . in @xmath7-geometry , the equation of the electron temperature for purely heat conductive",
    "plasma follows @xmath305 we will set the electron specific heat @xmath306 and assume the electron conductivity @xmath307 to be constant . in that case",
    ", a solution can be written as a product of a gaussian profile in the @xmath294-direction and an elevated bessel function @xmath308 in the @xmath309-direction @xcite : @xmath310 where @xmath311 is the first root of the derivative of @xmath312 .",
    "we select the following values for the input parameters : @xmath313 , @xmath314 , and @xmath315 in dimensionless units .",
    "the computational domain is @xmath316 and @xmath317 discretized with @xmath274 grid blocks of @xmath318 cells each . in the region",
    "@xmath319 and @xmath320 , we apply one level of mesh refinement .",
    "we impose a symmetry condition for the electron temperature on the axis . on all other boundaries",
    "the electron temperature is fixed to the time dependent reference solution .",
    "we time evolve this heat conduction problem with a preconditioned conjugate gradient method from time @xmath321 to the final time at @xmath322 .",
    "the crank - nicolson approach is used to achieve second order accurate time integration .",
    "the initial and final solutions for the electron temperature are shown in figure [ fig : rz ] in color contour in the @xmath7-plane .",
    "the heat conduction has diffused the temperature in time to a more uniform state .",
    "the black line indicates the region in which the mesh refinement was applied .",
    "the relative maximum error of the numerically obtained electron temperature versus the analytical solution is shown in figure [ fig : rzerror ] .",
    "here we used the non - uniform grid with base resolutions of @xmath323 , @xmath324 , @xmath325 , and @xmath326 cells and set the time step proportional to the cell size to demonstrate a second order convergence rate .",
    "the @xcite problem tests both the hydrodynamics and the heat conduction implementation .",
    "this test generalizes the well - known sedov ",
    "taylor strong point explosion in single temperature hydrodynamics by including the heat conduction .",
    "the heat conductivity is parameterized as a non - linear function of the density and material temperature : @xmath327 .",
    "we select the spherically symmetric self - similar solution of @xcite with coefficients @xmath328 and @xmath329 and the adiabatic index is @xmath330 .",
    "this solution produces , similar to the sedov ",
    "taylor blast - wave , an expanding shock front through an ambient medium .",
    "however , at very high temperatures , thermal heat conduction dominates the fluid flows , so that a thermal front precedes the shock front . with the selected parameters ,",
    "the heat front is always at twice the distance from the origin of the explosion as is the shock front .",
    "we perform the test in @xmath7-geometry .",
    "the computational domain is divided in @xmath331 cells .",
    "the boundary conditions along the @xmath309 and @xmath294 axes are reflective .",
    "the two other boundaries , away from explosion , are prescribed by the self - similar solution .",
    "the time evolution is numerically performed as follows : for the hydrodynamics we use the hlle scheme and the generalized koren limiter with @xmath332 as the slope limiter .",
    "the cfl number is set to 0.8 .",
    "the heat conduction is solved implicitly with the preconditioned conjugate gradient method .",
    "the test is initialized with the spherical self - similar solution with the shock front located at the spherical radius @xmath333 and the heat front is at @xmath334 .",
    "the simulation is stopped once the shock front has reached @xmath334 and the heat front is at @xmath335 .",
    "a 1d slice along the @xmath309-axis of the solution at the final time is shown in figure [ fig : rmtvcut ] .",
    "we normalize the output similar to @xcite : the temperature is normalized by the central temperature , while the density and radial velocity are normalized by their values of the post - shock state at the shock . the numerical solution obtained by the crash code",
    "is shown as @xmath336 symbols and is close to the self - similar reference solution , shown as solid lines .",
    "note that the temperature is smooth due to the heat conduction , except for the discontinuous derivative at the heat front .",
    "the wiggle at @xmath337 in the density and radial velocity is a due to the diffusion of the analytical shock discontinuity in the initial condition during the first few time steps . in the left panel of figure [ fig : rmtvtemp ] ,",
    "the spherical expansion of temperature at the final time is shown .",
    "clearly , the cartesian grid with the @xmath7-geometry does not significantly distort the spherical symmetry of the solution .",
    "the spatial distribution of the error in the temperature is shown in the right panel .",
    "the errors are largest at the discontinuities of the shock and heat fronts as expected .",
    "a grid convergence study is performed with resolutions of @xmath338 , @xmath339 , and @xmath340 cells . the relative l1 error in figure [ fig : rmtverror ]",
    "is calculated using the density , velocity components , and the material temperature .",
    "the convergence rate is first order due to the shock and heat front .",
    "any of the verification tests for non - equilibrium gray - diffusion coupled to the single temperature hydrodynamics can be reworked as a test for the hydrodynamic equations for the ions coupled to the electron pressure equation with electron heat conduction and energy exchange between the electrons and ions . as an example",
    ", we will transform one of the non - equilibrium gray diffusion tests of @xcite to verify the heat conduction implementation .",
    "the electron energy density equation ( [ eq : electronenergy ] ) without the radiation interaction can be written as @xmath341    + p_e { \\mathbf{\\nabla } \\cdot { \\mathbf{u } } } = \\nabla\\cdot\\left [ c_e\\nabla t_e \\right ]    + \\sigma_{ie } ( t_i - t_e),\\label{eq : electrontemp}\\ ] ] where the heat conduction and energy exchange terms on the right hand side depend on the gradients and differences of the temperatures .",
    "the equation for the gray radiation energy density ( [ eq : grayenergy ] ) on the other hand depends on the gradients and differences of energy densities . by defining the radiation temperature @xmath342 by @xmath343 and using the definition of the planckian @xmath344 , we can rewrite the energy density equation for the radiation as @xmath345    + \\frac{1}{3 } e_r { \\mathbf{\\nabla } \\cdot { \\mathbf{u } } } & = & \\nabla\\cdot\\left [ d_r \\nabla e_r \\right ]    + c\\kappa_p ( at^4 - e_r ) \\nonumber \\\\    & = & \\nabla\\cdot\\left [ \\overline d_r \\nabla t_r \\right ]    + c\\overline\\kappa_p ( t - t_r),\\label{eq : radiationtemp}\\end{aligned}\\ ] ] where @xmath346 and @xmath347 are the new coefficients that appear due to this transformation .",
    "the equations ( [ eq : electrontemp ] ) and ( [ eq : radiationtemp ] ) are now of the same form . to translate a gray diffusion test to a heat conduction test",
    ", we reinterpret @xmath348 as the heat conductivity @xmath307 and @xmath349 as the relaxation coefficient @xmath350 in the ion - electron energy exchange .",
    "in addition , the material temperature @xmath351 and radiation temperature @xmath342 have to be reinterpreted as the ion temperature @xmath63 and electron temperature @xmath31 , respectively .",
    "note that we also have to relate the electron pressure and internal energy by @xmath352 similar to the radiation field corresponding to @xmath353 , and let the electron internal energy and electron specific heat depend on the electron temperature as @xmath354 and @xmath355 , respectively .",
    "as an example , we transform the mach 5 non - equilibrium gray diffusion shock tube problem of @xcite .",
    "it uses non - uniform opacities that depend on the density and temperature defined by @xmath356 and @xmath357 .",
    "the above described procedure is used to translate this problem to an electron heat conduction test with energy exchange between the electron and ions .",
    "the heat conductivity for this test is @xmath358 and the relaxation coefficient between the electron and ions is @xmath359 .",
    "we perform this mach 5 heat conduction test on a 2d non - uniform grid . for the initial condition ,",
    "the 1d semi - analytical steady state reference solution of @xcite is used .",
    "there is a mach 5 pre - shock flow on the left side of the tube resulting in an embedded hydro shock as well as a steep thermal front ( a look at figure [ fig : lowrie3temp ] will help to understand this shock tube problem . ) we add an additional velocity of mach @xmath360 so that the pre - shock velocity is zero and the shock is no longer steady , but instead will move to the left with a velocity @xmath360 ( in units in which the pre - shock speed of sound is 1 ) .",
    "the problem is rotated anti - clockwise on the grid by @xmath361 .",
    "the translational symmetry is now in the @xmath270 direction in the @xmath271-plane similar to the mach 1.05 shock tube problem described in section [ sec : lowrie1 ] .",
    "the computational domain is @xmath362 by @xmath363 . inside the area @xmath364 and @xmath365 , we apply one level of refinement . this refinement is set up such that both the heat front as well as the shock front will propagate through the resolution change on the left ( from fine to coarse ) and right ( from coarse to fine ) , respectively .",
    "for the boundary conditions in the @xmath252-direction , we fix the state on the right side with the semi - analytical solution , but for the left side we use zero gradient . on the @xmath278 boundaries ,",
    "we apply a sheared zero gradient in the @xmath270 direction .    for the evolution till the final time @xmath366",
    ", we use the hlle scheme together with the generalized koren limiter with @xmath279 to solve the hydrodynamic equations .",
    "the cfl number is set to 0.8 .",
    "the heat conduction and energy exchange between electrons and ions are solved implicitly with the backward euler scheme using the gmres iterative solver in combination with a bilu preconditioner .    in figure",
    "[ fig : lowrie3temp ] , the electron ( right panel ) and ion ( left panel ) temperatures are shown at the final time along the @xmath252-axis .",
    "the semi - analytical reference solution is shown as a blue line , while the numerical solution is shown with @xmath336 symbols for a simulation with @xmath367 cells at the base level in the @xmath252 and @xmath278 direction .",
    "the hydro shock is located near @xmath368 and shows up in the ion temperature as a jump in the temperature , followed directly behind the shock by a strong relaxation due to the energy exchange between the ions and electrons .",
    "the electron temperature stays smooth due to strong heat conduction .",
    "the heat front is seen with a steep foot at @xmath369 .",
    "this front corresponds to the radiative precursor in the non - equilibirum gray diffusion tests of @xcite .",
    "we repeated the test with four different resolutions at the base level : @xmath367 , @xmath370 , @xmath371 , and @xmath372 cells in the @xmath252 and @xmath278 direction .",
    "the insets in both panels of figure [ fig : lowrie3temp ] show the four resolutions as solid , dotted , dashed , dashed - dotted lines , respectively . in the left panel ,",
    "the zoom - in shows the convergence of the ion temperature towards the embedded hydro shock and the temperature relaxation . in the right panel ,",
    "the blow - up shows the convergence towards the reference precursor front .",
    "note that no spurious oscillations appear near the shock or near the precursor .    due to the discontinuity in both the shock and heat precursor",
    ", the convergence rate can be at most first order .",
    "indeed , in figure [ fig : lowrie3error ] the relative l1 error shows first order accuracy . the error is calculated using all the density , velocity components and both temperatures .",
    "note that the spike in the ion temperature is spatially so small that a huge number of grid cells are needed to get a fully resolved shock and relaxation state .",
    "the crash test repository contains a range of full system configurations to be used for validation with future laboratory experiments . in figure",
    "[ fig : nozzle_init ] , we show the configuration of a 3d elliptic nozzle through which a fast shock of the order of @xmath373km / s will be launched , which is still significantly slower than the speed of light . the shock wave is produced by a 1.1ns laser pulse from the left with 4kj of energy irradiating a 20@xmath374 m thick beryllium disk , initially located at @xmath375 .",
    "a layer of gold is glued to the plastic tube to protect the outside of the tube from the laser - driven shock .",
    "the plastic ( polyimide ) tube is circular for @xmath376@xmath374 m with a radius of 600@xmath374 m . beyond @xmath377@xmath374",
    "m the tube is elliptic by flattening the tube in the @xmath278-direction by a factor 2 .    the first part of the simulation is performed with the 2d , lagrangian , radiation hydrodynamic code hyades @xcite to time advance the laser energy deposition and the response of the system until the end of the laser pulse at 1.1 ns . this laser pulse first shocks and then accelerates the beryllium to the right .",
    "after 1.1ns the output of hyades is used as an initial condition of the crash code .",
    "this simulation is performed for a two temperature , electron and ion , plasma . for the radiation",
    ", we use the flux limited diffusion approximation with 30 groups .",
    "the photon energy is in the range of 0.1ev to 20kev , logarithmically distributed over the groups . due to the symmetry in the problem",
    "we only simulate one quadrant ( @xmath378 and @xmath379 ) , with reflective boundary conditions at @xmath281 and @xmath380 . at all other boundaries we use an extrapolation with zero gradient for the plasma and a zero incoming flux boundary for the radiation .",
    "the domain size is @xmath381 \\times \\left [ 0,900 \\right ] \\times \\left [ 0,900 \\right]$ ] microns for the @xmath252 , @xmath278 , @xmath294 coordinates .",
    "the base level grid consists of @xmath382 blocks of @xmath383 mesh cells .",
    "one level of dynamic mesh refinement is used at material interfaces and the shock front .",
    "overall , the effective resolution is @xmath384 cells and there are approximately 4.5 million finite volume cells .",
    "the hydrodynamic equations are solved with the hlle scheme with a cfl number 0.8 together with the generalized koren limiter with @xmath279 .",
    "the diffusion and energy exchange of the radiation groups as well as the heat conduction are solved with the decoupled implicit scheme using a bi - cgstab iterative solver .",
    "the simulation from 1.1ns to 13ns physical time took 1 hour and 55 minutes on 480 cores of the flux supercomputer at the university of michigan .    in figure",
    "[ fig : nozzle ] , we show the shock structure at 13ns .",
    "the accelerated beryllium compresses the xenon directly to the right of the interface , which is seen as a high density plasma near @xmath385@xmath374 m in the top right panel of figure [ fig : nozzle ] .",
    "this drives a primary shock and the velocity jump at @xmath386@xmath374 m is seen in the middle left panel . behind the shock front , the ions are heated as depicted from the middle right panel , followed directly behind the shock by a cooling due to the energy exchange between the ions and electrons .",
    "early on , the electron heating produces ionization and the emission of radiation , and the radiation in turn heat and ionizes the material ahead of the primary shock .",
    "the radiation temperature , measuring the total radiation energy density , is shown in the bottom left panel .",
    "the photons will interact again with the matter , sometimes after traveling some distance .",
    "this is the source of the wall shock seen ahead of the primary shock @xcite : photons traveling ahead of the shock interact with the plastic wall , heat it , and this in turn drives a shock off the wall into the xenon .",
    "the ablation of the plastic is depicted in the top left panel as a radially inward moving polyimide ( in green color ) near and even ahead of the primary shock .",
    "the compressed xenon due to the plastic ablation is seen in the top right panel as a faint density feature that is ahead of the primary shock front , between @xmath385@xmath374 m and @xmath387@xmath374 m .",
    "the interaction between the photons and matter is also seen by the radiative precursor to the right of the radiative shock elevating the electron temperature ahead of the shock in the bottom right panel .",
    "this is due to the strong coupling between the electrons and radiation field .",
    "the reader is referred to @xcite for more details on radiative effects in radiative shock tubes .",
    "we present parallel scaling studies on the pleiades supercomputer at nasa ames .",
    "this computer is an sgi ice cluster connected with infiniband .",
    "figure [ fig : scaling ] shows the strong scaling for a problem size that is independent of the number of processors .",
    "this 3d simulation is a circular tube version of the full system test described in section [ sec : fullsystem ] .",
    "it uses five materials , 30 radiation groups , and separate electron and ion temperatures .",
    "the grid contains @xmath388 blocks of @xmath383 cells each at the base level and in addition two time dependent refinement levels .",
    "there are overall approximately 2.6 million cells in this problem .",
    "we use lookup tables for the eos and opacities , so that the computational time for that is negligible . for the hydrodynamic equations",
    ", we use the hlle scheme together with the generalized koren limiter with @xmath279 . the radiation diffusion ,",
    "electron heat conduction and energy exchange terms are solved implicitly with the decoupled scheme , uing the bi - cgstab iterative solver .",
    "this simulation is performed for 20 time steps for the number of cores varying from 128 to 2048 , but excludes file i / o to measure the performance of the implicit solver . up to 1024 cores , we get good scaling .",
    "however for more cores we observe saturation in the performance .",
    "we have extended the bats - r - us code @xcite with a new radiation transfer and heat conduction library . this new combination together with the equation - of - state and multigroup opacity solver",
    "is called the crash code .",
    "this code uses the recently developed parallel block adaptive tree library ( batl , see @xcite ) to enable highly resolved radiation hydrodynamic solutions .",
    "the implemented radiation hydrodynamic schemes solve for the gray or multigroup radiation diffusion models in the flux limited diffusion approximation .    in high energy density plasmas ,",
    "the electrons are most of the time strongly coupled to the ions by collisions .",
    "an important exception is at hydrodynamic shocks , where the ions are heated by the shock wave and the electrons and ions are out of temperature equilibrium .",
    "since radiative shocks are the main application for crash , we have implemented a separate electron pressure equation with the electron thermal heat conduction . for the electron heat conduction",
    ", we have added the option of a flux limiter to limit the thermal flux with the free - streaming heat flux .",
    "the multi - material radiation hydrodynamic equations are solved with an operator split method that consists of three substeps : ( 1 ) solving the hydrodynamic equations with standard finite volume shock - capturing schemes , ( 2 ) the linear advection of the radiation in frequency - logarithm space , and ( 3 ) the implicit solution of the radiation , heat conduction , and energy exchanges . for the implicit solver , standard",
    "krylov solvers are used together with a block incomplete lower - upper decomposition ( bilu ) preconditioner .",
    "this preconditioner scales well up to 500 or 1000 processors . for future work",
    ", we may explore for the implicit multigroup diffusion a multi - level preconditioner to better scale the radiation solver beyond 1000 processors .",
    "we have presented a suite of verification tests that benchmark the performance .",
    "these tests verify the correctness and accuracy of the implementation for the gray and multigroup radiation diffusion algorithm and the heat conduction in 1d , 2d , and 3d slab and 2d @xmath7 geometry .",
    "to demonstrate the full capability of the implementation , we have presented a 3d multi - material simulation of a radiative shock wave propagating through an elliptic nozzle .",
    "this configuration will be used in future validation studies .",
    "since this radiation transfer library is an extension of the bats - r - us code , the implementation is readily available for mhd simulations as well .",
    "this allows for validation studies of the radiation mhd implementation using laboratory - astrophysics experiments or for the simulations of astrophysical plasmas .",
    "this work was funded by the predictive sciences academic alliances program in doe / nnsa - asc via grant defc52 - 08na28616 and by the university of michigan .",
    "the simulations were performed on the nasa advanced supercomputing system pleiades .",
    "in sections [ sec : unsplit ] and [ sec : split ] , the diffusion operator is discretized on a uniform mesh with a standard finite volume method in combination with a central difference approximation for the gradient in the flux calculation as in equation ( [ eq : diffusionflux ] ) .",
    "the diffusion coefficient that is needed at the face is obtained by simple arithmetic averaging of the left and right cell center diffusion coefficients .",
    "the generalization to resolution changes as in figure [ fig : grid ] is less straightforward . in the following",
    ", we will denote the fine cell centers by @xmath389 and @xmath390 , the coarse cell center by @xmath290 .",
    "the flux densities at the resolution changes in the direction orthogonal to the interface are denoted by @xmath391 and @xmath392 at the fine faces , and @xmath393 at the coarse face .    in @xcite",
    ", a strategy was developed to discretize the diffusion operator on an adaptive mesh in the context of reservoir simulations .",
    "the main ingredients of the method are ( 1 ) require the continuity of the flux at the resolution change in the strong sense , i.e. @xmath394 , and ( 2 ) discretize the gradient in the diffusion flux by a one - sided difference .",
    "an expression was found for the diffusion flux @xmath395 in which the diffusion coefficient is replaced by a weighted harmonic average of the cell centered values @xmath396 , @xmath397 , @xmath398 . in @xcite , it was argued that this discretization does not properly propagate the self - similar marshak waves of the radiation diffusion model , unless the cell centered diffusion coefficients are calculated on a common face temperature .    in the code discussed in this paper , we follow a different approach that replaces the harmonic average of the diffusion coefficient in @xcite by an arithmetic average and obtain for the flux densities normal to the resolution change interface @xmath399,\\ ] ] where @xmath144 is the fine cell size and the diffusion coefficient at the face is averaged as @xmath400 /3.\\ ] ] we demonstrated with verification tests including those discussed above that this change produces properly propagating radiative precursor and shock fronts .",
    "generalizations to 1d and 3d are straightforward .",
    "incorporating the @xmath7-geometry in a finite volume formulation is as follows : the radial cell face area and the cell volume must be made proportional to the distance @xmath309 from the symmetry axis .",
    "in addition , the @xmath309 component of the momentum equation ( @xmath401 ) is modified as @xmath402 = \\frac{p+p_r}{r},\\ ] ] where @xmath403 is the unit vector in the @xmath309 direction and @xmath404 .",
    "this correction reflects the fact that the pressure term is a gradient , not a divergence .",
    "arfken , g. 1985 , mathematical methods for physicists , 3rd edition ( san diego , ca : academic press ) baek , s. , di matteo , p. , semelin , b. , combes , f. , & revaz , y. 2009 , , 495 , 389 barton , r.t .",
    "1985 , in numerical astrophysics , eds by j.m .",
    "centrella , j.m .",
    "leblanc , & r.l .",
    "bowers ( jones and bartlett , boston ) , 482 buchler , j.r .",
    "1983 , , 30 , 395 doss , f.w . ,",
    "robey , h.f . ,",
    "drake , r.p . , & kuranz , c.c .",
    "2009 , phys .",
    "plasmas , 16 , 112705 doss , f.w . ,",
    "drake , r.p . , &",
    "myra , e.s .",
    "2011 , phys .",
    "plasmas , submitted drake , r.p . 2006 ,",
    "high - energy density physics ( berlin - heidelberg - ny : springer ) drake , r.p .",
    "2011 , submitted to high energy density physics edwards , m.g .",
    "1996 , j. comp .",
    "phys , 126 , 356 einfeldt , b. , munz , c.d . , roe , p.l . , & sjgreen , b. 1991 , j. comp .",
    "92 , 273 eisenstat , s.c .",
    "1981 , siam j. sci . and stat .",
    ", 2 , 1 gittings , m. et al .",
    "2008 , comput .",
    "disc , 1 , 015005 godunov , s.k .",
    "1959 , mat .",
    "sbornik , 47 , 271 harten , a. , lax , p.d . ,",
    "& van leer , b. 1983 , siam rev . , 25 ( 1 ) , 35 koren , b. 1993 , in numerical methods for advection - diffusion problems , eds c.b .",
    "vreugdenhil & b. koren ( braunschweig : vieweg ) , 117 landau , l.d .",
    "& lifshitz , e.m .",
    "1980 , theoretical physics , vol .",
    "5 . statistical physics , part 1 .",
    "3rd edition ( pergamon press : ny ) larsen , j. & lane , s. 1994 , , 51 , 179 levermore , c.d . &",
    "pomraning , g.c .",
    "1981 , , 248 , 321 lowrie , r.b . & edwards , j.d .",
    "2008 , shock waves , 18 , 129 lund , c.m . & wilson j.r .",
    "1980 , lawrence livermore national laboratory report ucrl-84678 marinak , m.m . ,",
    "kerbel , g.d . ,",
    "gentile , n.a . ,",
    "jones , o. , munro , d. , pollaine , s. , dittrich , t.r . , &",
    "haan , s.w .",
    "2001 , phys . of plasmas , 8 , 2275 martnez - sykora , j. , hansteen , v. , de pontieu , b. , & carlsson , m. 2009 , , 701 , 1569 maselli , a. , ferrara , a. , & gallerani , s. 20009 , , 395 , 1925 mellema , g. , iliev , i.t . ,",
    "alvaraz , m.a . , & shapiro , p.r .",
    "2006 , , 11 , 374 mihalas , d. & weibel - mihalas , b. 1984 , foundations of radiation hydrodynamics ( new york : oxford univ . press ) minerbo , g.n .",
    "1978 , , 20 , 451 morel , j.e .",
    "2000 , , 65 , 769 nayakshin , s. , cha , s.h . , & hobbs , a. 2009 , , 397 , 1314 petkova , m. & springel , v. 2009 , , 396 , 1383 pomraming , g.c .",
    "2005 , the equations of radiation hydrodynamics ( mineola : dover ) powell , k.g . , roe , p.l . ,",
    "linde , t.j .",
    ", gombosi , t.i . , & dezeeuw , d.l .",
    "1999 , j. comp .",
    "154 , 284 reinicke , p. , & meyer - ter - vehn , j. 191 , phys . fluids a , 3 , 1807 rijkhorst , e.j . , plewa , t. , dubey , a. , & mellema , g. 2006 , , 452 , 907 roe , p.l .",
    "1986 , ann .",
    "fluid mech . , 18 , 337 saad , y. & schultz , m.h .",
    "1986 , siam j. sci .",
    "7(3 ) , 856 stein , r.f . , benson , d. , & nordlund , 2007 , in new solar physics with solar - b mission , eds k. shibata , s. nagata , & t. sakurai , 369 , 87 stone , j.m . , mihalas , d. , & norman , m.l .",
    "1992 , , 80 , 819 su , b. & olson , g.l .",
    "1996 , , 56 , 337 tth , g. et al .",
    "2005 , j. geophys .",
    "res . , 110:a12226 , 2005 tth , g. , ma , y. , & gombosi , t.i .",
    "2008 , j. comp .",
    "phys . , 227 , 6967 tth , g. et al .",
    "2010 , submitted to j. comp .",
    "van der vorst , h.a .",
    "1992 , siam j. sci . and stat .",
    "comput . , 13 , 631 vgler , a. , shelyag , s. , schssler , m. cattaneo , f. , emonet , t. , & linde , t. 2005 , , 429 , 335 yee , h.c .",
    "1989 , nasa tm-101088 zeldovich , ya.b . &",
    "raizer , yu.p .",
    "2002 , physics of shock waves and high - temperature hydrodynamic phenomena ( mineola , ny : dover publications )     r | c | l & * stored quantity * & * units * + total pressure @xmath86 & @xmath405 & ev + total internal energy density @xmath87 & @xmath406 & ev + electron pressure @xmath79 & @xmath407 & ev + electron internal energy density @xmath58 & @xmath408 & ev + specific heat @xmath409 & @xmath410 & + electron specific heat @xmath80 & @xmath411 & + speed of sound gamma & @xmath412 & + electron speed of sound gamma & @xmath81 & + inverse of ion - electron interaction time & @xmath413 & s@xmath414 + electron conductivity & @xmath307 & jm@xmath414s@xmath414k@xmath414 + mean ionization & @xmath415 & + mean square ionization & @xmath100 &"
  ],
  "abstract_text": [
    "<S> we describe the crash ( center for radiative shock hydrodynamics ) code , a block adaptive mesh code for multi - material radiation hydrodynamics . </S>",
    "<S> the implementation solves the radiation diffusion model with the gray or multigroup method and uses a flux limited diffusion approximation to recover the free - streaming limit . </S>",
    "<S> the electrons and ions are allowed to have different temperatures and we include a flux limited electron heat conduction . </S>",
    "<S> the radiation hydrodynamic equations are solved in the eulerian frame by means of a conservative finite volume discretization in either one , two , or three - dimensional slab geometry or in two - dimensional cylindrical symmetry . </S>",
    "<S> an operator split method is used to solve these equations in three substeps : ( 1 ) solve the hydrodynamic equations with shock - capturing schemes , ( 2 ) a linear advection of the radiation in frequency - logarithm space , and ( 3 ) an implicit solve of the stiff radiation diffusion , heat conduction , and energy exchange . </S>",
    "<S> we present a suite of verification test problems to demonstrate the accuracy and performance of the algorithms . </S>",
    "<S> the crash code is an extension of the block - adaptive tree solarwind roe upwind scheme ( bats - r - us ) code with this new radiation transfer and heat conduction library and equation - of - state and multigroup opacity solvers . </S>",
    "<S> both crash and bats - r - us are part of the publicly available space weather modeling framework ( swmf ) . </S>"
  ]
}