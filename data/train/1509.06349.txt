{
  "article_text": [
    "kalle saari studies in @xcite optimal squareful words which are aperiodic words containing the least number of minimal squares ( that is , squares with no proper square prefixes ) such that every position starts a square .",
    "saari proves that an optimal squareful word always contains exactly six minimal squares , and he characterizes these squares ; less than six minimal squares forces a word to be ultimately periodic .",
    "moreover , he shows that sturmian words are a proper subclass of optimal squareful words .",
    "we propose a square root map for sturmian words .",
    "let @xmath1 be a sturmian word of slope @xmath0 , and write it as a product of the six minimal squares in its language @xmath11 : @xmath2 .",
    "the square root of @xmath1 is defined to be the word @xmath3 .",
    "the main result of this paper is that the word @xmath4 is also a sturmian word of slope @xmath0 .",
    "more precisely , we prove that the square root of the sturmian word @xmath12 of intercept @xmath13 and slope @xmath0 is @xmath14 where @xmath15 .",
    "in addition to proving that the square root map preserves the language of a sturmian word @xmath1 , we show how to locate any prefix of @xmath4 in @xmath1 .",
    "we also characterize the sturmian words of slope @xmath0 which are fixed points of the square root map ; they are the two sturmian words @xmath16 and @xmath17 where @xmath18 is the infinite standard sturmian word of slope @xmath0 .",
    "the majority of the proofs of results on sturmian words rely heavily on the interpretation of sturmian words as rotation words . continued fractions and results from diophantine approximation theory play a key role in several proofs .",
    "solutions of the word equation @xmath19 where the words @xmath6 are among the six minimal squares in @xmath11 for some fixed irrational @xmath0 are closely linked to the square root map .",
    "the study of these solutions to this word equation arises naturally from the study of fixed points of the square root map .",
    "the sturmian fixed points of the square root map are fixed because they have arbitrarily long prefixes @xmath20 which satisfy the word equation .",
    "we characterize these specific solutions , i.e. , those primitive words @xmath21 such that @xmath22 and @xmath23 can be written as a product of minimal squares @xmath20 satisfying the word equation . on the circle @xmath24 , the interval",
    "@xmath25 $ ] of such a word @xmath21 can be seen to satisfy the square root condition @xmath26 ) \\subseteq [ w]$ ] , so we instead study and characterize the primitive words satisfying this square root condition .",
    "the result is that the specific solutions to the word equation ( or , equivalently , the primitive words satisfying the square root condition ) are the reversals of standard and semistandard words of slope @xmath0 ( see for a definition ) and the reversed standard words with the first two letters exchanged .",
    "in particular , all of these specific solutions are nonperiodic .",
    "it was known that the word equation @xmath27 has nonperiodic solutions @xcite , but according to our knowledge no large families of nonperiodic solutions have been identified until our result .",
    "word equations of the type @xmath28 have been considered by tpn holub @xcite .    the final central topic of this paper concerns the square root map in a more general setting .",
    "the square root map can be defined not only for sturmian words but for any optimal squareful word .",
    "we construct an infinite family of non - sturmian , linearly recurrent optimal squareful words @xmath29 with properties similar to sturmian words .",
    "the words @xmath29 are fixed points of the square root map .",
    "they are constructed by finding non - sturmian solutions of the word equation @xmath19 and by building infinite words having arbitrarily long squares of such solutions as prefixes .",
    "the subshifts @xmath7 generated by the words @xmath29 exhibit behavior similar to sturmian subshifts .",
    "the square root map preserves the language of several but not every word in @xmath7 .",
    "curiously , if the language of a word in @xmath7 is not preserved under the square root map , then the image must be periodic .",
    "this result is very surprising since it is contrary to the plausible hypothesis that the square root of an aperiodic word is aperiodic .",
    "the paper is organized as follows . in",
    "we prove that the square root map preserves the language of a sturmian word . as a corollary",
    "we obtain a description of those sturmian words which are fixed points of the square root map . in",
    "we observe that the intervals of the minimal squares in @xmath11 satisfy the square root condition . in",
    "we characterize all words @xmath22 satisfying the square root condition .",
    "the result is that @xmath23 with @xmath21 primitive satisfies the square root condition if and only if @xmath21 is a reversed standard or semistandard word or a reversed standard word with the first two letters exchanged .",
    "contains a proof of the characterization of the specific solutions of the word equation @xmath19 mentioned earlier .",
    "we show that a primitive word @xmath21 satisfies the square root condition if and only if @xmath23 can be written as a product of minimal squares satisfying the word equation . in we",
    "show how to locate prefixes of @xmath4 in @xmath1 . as an important step in proving this , we provide necessary and sufficient conditions for a sturmian word to be a product of squares of reversed standard and semistandard words .",
    "we give a formula describing the square root of the fibonacci word in .",
    "is devoted to constructing the non - sturmian fixed points @xmath29 mentioned above and to demonstrating that the languages of the words in their subshifts are preserved or they are mapped to periodic words .",
    "we conclude the paper by giving some remarks on possible generalizations in and by discussing a few open problems in .",
    "a short version of this paper was published as an extended abstract in the proceedings of words 2015 @xcite .",
    "in this section we review notation and basic concepts and results of word combinatorics , optimal squareful words , continued fractions , and sturmian words .",
    "most of the definitions and results provided here about words can be found in lothaire s book @xcite .",
    "_ an alphabet _",
    "@xmath30 is a finite non - empty set of _ letters _ , or _",
    "symbols_. a ( finite ) _ word _ over @xmath30 is a finite sequence of letters of @xmath30 obtained by concatenation .",
    "the concatenation of two words @xmath31 and @xmath32 is the word @xmath33 . in this paper",
    "we consider only _ binary words _ ,",
    "that is , words over an alphabet of size two . most of the time we take @xmath30 to be the set @xmath34 .",
    "_ the set of nonempty words over @xmath30 _ is denoted by @xmath35 .",
    "we denote _ the empty word _ by @xmath36 and set @xmath37 . a nonempty subset of @xmath38",
    "is called a _",
    "language_. let @xmath39 be a word of @xmath40 letters .",
    "we denote _ the length _",
    "@xmath40 of @xmath21 by @xmath41 ; by convention @xmath42 .",
    "the set of proper powers of a word @xmath21 is denoted by @xmath43 .    an _ infinite word _",
    "@xmath21 over the alphabet @xmath30 is a function from the nonnegative integers to @xmath30 .",
    "we write concisely @xmath44 with @xmath45 .",
    "the set of infinite words over @xmath30 is denoted by @xmath46 .",
    "an infinite word @xmath21 is said to be _ ultimately periodic _ if we can write it in the form @xmath47 for some words @xmath48 .",
    "if @xmath49 , then @xmath21 is said to be _ periodic _ , or _ purely periodic_. an infinite word which is not ultimately periodic is _",
    "aperiodic_. the _ shift operator @xmath50 _ acts on infinite words as follows : @xmath51 .",
    "a finite word @xmath52 is a _ factor _ of the finite or infinite word @xmath21 if we can write @xmath53 for some @xmath54 and @xmath55 .",
    "if @xmath56 , then the factor @xmath52 is called a _ prefix _ of @xmath21 . if @xmath57 , then we say that @xmath52 is a _ suffix _ of @xmath21 .",
    "the set of factors of @xmath21 , the _ language of @xmath21 _ , is denoted by @xmath58 .",
    "if @xmath39 , then we let @xmath59 = a_i \\cdots a_j$ ] whenever the choices of positions @xmath60 and @xmath61 make sense .",
    "this notion is extended to infinite words in a natural way .",
    "an _ occurrence _ of @xmath52 in @xmath21 is a position @xmath60 such that @xmath62 = u$ ] .",
    "if such a position exists , then we say that @xmath52 _ occurs _ in @xmath21 .",
    "a positive integer @xmath63 is a _ period _ of @xmath64 if @xmath65 for @xmath66 .",
    "if the finite word @xmath21 has period @xmath63 and @xmath67 for some real @xmath0 such that @xmath68 , then @xmath21 is called an _",
    "@xmath0-repetition_. an @xmath0-repetition is _ minimal _ if it does not have an @xmath0-repetition as a proper prefix .",
    "if @xmath69 , then @xmath21 is a _ square _ with _ square root _",
    "a square is _ minimal _ if it does not have a square as a proper prefix .",
    "a word @xmath21 is _ primitive _ if it is of the form @xmath70 if and only if @xmath71 .",
    "equivalently , a word @xmath21 is primitive if and only if @xmath21 occurs in @xmath23 exactly twice .",
    "the _ primitive root of @xmath21 _ is the unique primitive word @xmath52 such that @xmath72 for some @xmath73 .",
    "let @xmath74 be a periodic infinite word .",
    "the _ minimal period of @xmath21 _ is defined to be the primitive root of @xmath75 .",
    "let @xmath39 be a word . _",
    "the reversal _",
    "@xmath76 of @xmath21 is the word @xmath77 . if @xmath78 , then we call @xmath21 _ a palindrome_. let @xmath79 be the _ cyclic shift operator _",
    "defined by the formula @xmath80 .",
    "the words @xmath81 are the _ conjugates of @xmath21_. if @xmath52 is a conjugate of @xmath21 , then we say that @xmath52 is conjugate to @xmath21 .",
    "an infinite word @xmath21 is _ recurrent _ if each of its factors occurs in it infinitely often .",
    "let @xmath82 be the sequence of consecutive occurrences of a factor @xmath52 in a recurrent word @xmath21 .",
    "the _ return time _ of @xmath52 is the quantity @xmath83 which can be infinite .",
    "the factors @xmath84 $ ] , @xmath85 are the _ returns to @xmath52 _ in @xmath21 . if the return time of each factor of @xmath21 is finite , then the word @xmath21 is _ uniformly recurrent_. equivalently , @xmath21 is uniformly recurrent if for each factor @xmath52 of @xmath21 there exists an integer @xmath86 such that every factor of @xmath21 of length @xmath86 contains an occurrence of @xmath52 .",
    "if there exists a global constant @xmath87 such that the return time of any factor @xmath52 of @xmath21 is at most @xmath88 , then we say that @xmath21 is _",
    "linearly recurrent_. clearly a linearly recurrent word is uniformly recurrent .",
    "the _ index _ of a factor @xmath52 of an infinite word @xmath21 is defined to be @xmath89 if @xmath21 is uniformly recurrent and aperiodic , then the index of every factor of @xmath21 is finite .",
    "a _ subshift _ @xmath7 is a subset of @xmath46 such that @xmath90 for some language @xmath91 such that @xmath92 .",
    "if we set above @xmath93 where @xmath21 is an infinite word , then we say that the subshift @xmath7 is generated by @xmath21 .",
    "subshifts are clearly shift - invariant .",
    "if every word in a subshift is aperiodic , then we call the subshift _ aperiodic_. a subshift is _ minimal _ if it does not contain nonempty subshifts as proper subsets .",
    "a nonempty subshift is minimal if and only if it is generated by a uniformly recurrent word .      in @xcite kalle saari",
    "considers @xmath0-repetitive words .",
    "an infinite word is _",
    "@xmath0-repetitive _ if every position in the word starts an @xmath0-repetition and the number of distinct minimal @xmath0-repetitions occurring in the word is finite . if @xmath94 , then @xmath0-repetitive words are called _ squareful words_. this means that every position of a squareful word begins with a minimal square .",
    "saari proves that if the number of distinct minimal squares occurring in a squareful word is at most @xmath95 , then the word must be ultimately periodic . on the other hand , if a squareful word contains at least @xmath96 distinct minimal squares , then aperiodicity is possible .",
    "saari calls the aperiodic squareful words containing exactly @xmath96 minimal squares _",
    "optimal squareful words_. further , he shows that optimal squareful words are always binary and that the six minimal squares must take a very specific form :    [ prp : min_square_roots ] let @xmath21 be an optimal squareful word .",
    "if @xmath97 occurs in @xmath21 for some @xmath98 , then the roots of the six minimal squares in @xmath21 are @xmath99 for some @xmath100 and @xmath101 .",
    "the optimal squareful words containing the minimal square roots of are called _ optimal squareful words with parameters @xmath102 and @xmath103_. for the rest of this paper we reserve this meaning for the symbols @xmath102 and @xmath103 . furthermore , we agree that the symbols @xmath104 always refer to the minimal square roots .",
    "saari completely characterizes optimal squareful words ( * ? ? ?",
    "* theorem  17 ) .",
    "[ prp : optimal_squareful_characterization ] an aperiodic infinite word @xmath21 is optimal squareful if and only if ( up to renaming of letters ) there exists integers @xmath100 and @xmath101 such that @xmath21 is an element of the language @xmath105      in this section we review results on continued fractions and best rational approximations of irrational numbers needed in this paper",
    ". good references on these subjects are the books of khinchin @xcite and cassels @xcite .",
    "every irrational real number @xmath0 has a unique infinite continued fraction expansion @xmath106 = a_0 + \\dfrac{1}{a_1 + \\dfrac{1}{a_2 + \\dfrac{1}{a_3 + \\cdots } } }    \\end{aligned}\\ ] ] with @xmath107 and @xmath108 for all @xmath109 .",
    "the numbers @xmath110 are called _ the partial quotients _ of @xmath0 .",
    "we focus here only on irrational numbers , but we note that with small tweaks much of what follows also holds for rational numbers , which have finite continued fraction expansions .",
    "the _ convergents _ @xmath111 of @xmath0 are defined by the recurrences @xmath112 the sequence @xmath113 converges to @xmath0 .",
    "moreover , the even convergents are less than @xmath0 and form an increasing sequence and , on the other hand , the odd convergents are greater than @xmath0 and form a decreasing sequence .    if @xmath114 and @xmath115 , then between the convergents @xmath116 and @xmath117 there are _ semiconvergents _ ( called intermediate fractions in khinchin s book @xcite ) which are of the form @xmath118 with @xmath119 . when the semiconvergents ( if any ) between @xmath116 and @xmath117 are ordered by the size of their denominators , the sequence obtained is increasing",
    "if @xmath120 is even and decreasing if @xmath120 is odd .",
    "note that we make a clear distinction between convergents and semiconvergents , i.e. , convergents are not a specific subtype of semiconvergents .",
    "a rational number @xmath121 is a _",
    "best approximation _ of the real number @xmath0 if for every fraction @xmath122 such that @xmath123 and @xmath124 it holds that @xmath125 in other words , any other multiple of @xmath0 with a coefficient at most @xmath126 is further away from the nearest integer than @xmath127 is .",
    "the next important proposition shows that the best approximations of an irrational number are connected to its convergents ( for a proof see theorems 16 and 17 of @xcite ) .",
    "[ prp : best_approximation_convergent ] the best rational approximations of an irrational number are exactly its convergents .",
    "we identify the unit interval @xmath24 with the unit circle @xmath128 .",
    "let @xmath129 be irrational .",
    "the map @xmath130 where @xmath131 stands for the fractional part of the number @xmath13 , defines a rotation on @xmath128 . the circle partitions into the intervals @xmath132 and @xmath133 .",
    "points in the same interval of the partition are said to be on the same side of @xmath134 and points in different intervals are said to be on the opposite sides of @xmath134 .",
    "( we are not interested in the location of the point @xmath135 . )",
    "the points @xmath136 and @xmath137 are always on the opposite sides of @xmath134 .",
    "the points @xmath138 with @xmath139 always lie between the points @xmath140 and @xmath136 ; see .",
    "we measure the shortest distance to @xmath134 on @xmath128 by setting @xmath141 we have the following facts for @xmath114 and for all @xmath142 such that @xmath143 : @xmath144 we can now interpret as @xmath145 note that rotating preserves distances ; a fact we will often use without explicit mention . in particular , the distance between the points @xmath146 and @xmath147 is @xmath148 .",
    "thus by the minimum distance between the distinct points @xmath146 and @xmath147 with @xmath149 is at least @xmath150 .",
    "formula tells what is the point closest to @xmath134 among the points @xmath146 for @xmath151 .",
    "we are also interested in knowing the point closest to @xmath134 on the side opposite to @xmath137 .",
    "the next result is very important and concerns this ; see ( * ? ? ?",
    "* proposition  2.2 . ) .",
    "[ prp : closest ] let @xmath0 be an irrational number .",
    "let @xmath40 be an integer such that @xmath152 with @xmath114 and @xmath139 .",
    "if @xmath153 , then @xmath154 for some integer @xmath155 such that @xmath156 .",
    "sturmian words are a well - known class of infinite , aperiodic binary words with minimal factor complexity .",
    "they are defined as the infinite words having @xmath157 factors of length @xmath40 for every @xmath158 . for our purposes",
    "it is more convenient to view sturmian words as the infinite words obtained as codings of orbits of points in an irrational circle rotation with two intervals ; see @xcite .",
    "let us make this more precise .",
    "the frequency @xmath0 of letter @xmath159 ( called the _ slope _ ) in a sturmian words exists , and it is irrational . divide the circle @xmath128 into two intervals @xmath160 and @xmath161 defined by the points @xmath134 and @xmath162 , and define the coding function @xmath163 by setting @xmath164 if @xmath165 and @xmath166 if @xmath167 .",
    "the coding of the orbit of a point @xmath13 is the infinite word @xmath12 obtained by setting its @xmath168 letter to equal @xmath169 where @xmath86 is the rotation by angle @xmath0 .",
    "this word is sturmian with slope @xmath0 , and conversely every sturmian word with slope @xmath0 is obtained this way . to make the definition proper , we need to define how @xmath163 behaves in the endpoints @xmath134 and @xmath162",
    "we have two options : either take @xmath170 and @xmath171 or @xmath172 $ ] and @xmath173 $ ] .",
    "the difference is seen in the codings of the orbits of the special points @xmath174 , and both options are needed to be able to obtain every sturmian word of slope @xmath0 as a coding of a rotation .",
    "however , in this paper we are not concerned about this choice .",
    "we make the convention that @xmath175 with @xmath176 and @xmath177 is either of the half - open intervals of @xmath128 separated by the points @xmath13 and @xmath178 ( taken modulo @xmath159 if necessary ) not containing the point @xmath134 as an interior point .",
    "the interval @xmath179 is either of the half - open intervals separated by the points @xmath134 and @xmath13 having smallest length ( the case @xmath180 is not important in this paper ) .",
    "since the sequence @xmath181 is dense in @xmath24as is well - known  every sturmian word of slope @xmath0 has the same language ( that is , the set of factors ) ; this language is denoted by @xmath11 .",
    "further , all sturmian words are uniformly recurrent .    for every factor @xmath39 of length @xmath40",
    "there exists a unique subinterval @xmath25 $ ] of @xmath128 such that @xmath12 begins with @xmath21 if and only if @xmath182 $ ] .",
    "clearly @xmath183 = i_{a_0 } \\cap r^{-1}(i_{a_1 } ) \\cap \\ldots \\cap r^{-(n-1)}(i_{a_{n-1 } } ) .",
    "\\end{aligned}\\ ] ] we denote the length of the interval @xmath25 $ ] by @xmath184|$ ] .",
    "the points @xmath185 partition the circle into @xmath157 intervals , which have one - to - one correspondence with the words of @xmath11 of length @xmath40 . among these intervals",
    "the interval containing the point @xmath186 corresponds to the right special factor of length @xmath40 .",
    "a factor @xmath21 is _ right special _ if both @xmath187 .",
    "similarly a factor is _ left special _ if both @xmath188 . in a sturmian word",
    "there exists a unique right special and a unique left special factor of length @xmath40 for all @xmath158 .",
    "the language @xmath11 is mirror - invariant , that is , for every @xmath189 also @xmath190 .",
    "it follows that the right special factor of length @xmath40 is the reversal of the left special factor of length @xmath40 .",
    "sturmian words are also _ balanced _ ; that is , the number of occurrences of the letter @xmath159 in any two factors of the same length differ at most by @xmath159 .    given the continued fraction expansion of an irrational @xmath129 as in , we define the corresponding _ standard sequence _",
    "@xmath191 of words by @xmath192 as @xmath193 is a prefix of @xmath194 for @xmath109 , the sequence @xmath195 converges to a unique infinite word @xmath18 called the infinite standard sturmian word of slope @xmath0 , and it equals @xmath196 . inspired by the notion of semiconvergents , we define _ semistandard _ words for @xmath114 by @xmath197 with @xmath119 .",
    "clearly @xmath198 and @xmath199 .",
    "instead of writing `` standard or semistandard '' , we often simply write `` ( semi)standard '' .",
    "the set of standard words of slope @xmath0 is denoted by @xmath200 , and the set of standard _ and _ semistandard words of slope @xmath0 is denoted by @xmath201 .",
    "( semi)standard words are left special as prefixes of the word @xmath18 .",
    "every ( semi)standard word is primitive ( * ? ? ?",
    "* proposition  2.2.3 ) .",
    "an important property of standard words is that the words @xmath193 and @xmath202 almost commute ; namely @xmath203 and @xmath204 for some word @xmath21 and distinct letters @xmath13 and @xmath178 . for more on standard words see @xcite .",
    "the only difference between the words @xmath18 and @xmath205 where @xmath206 $ ] and @xmath207 $ ] is that the roles of the letters @xmath134 and @xmath159 are reversed",
    ". we may thus assume without loss of generality that @xmath208 .",
    "for the rest of this paper we make the convention that @xmath0 stands for an irrational number in @xmath209 having the continued fraction expansion as in with @xmath208 , i.e. , we assume that @xmath210 .",
    "the numbers @xmath211 and @xmath212 refer to the denominators of the convergents of @xmath0 , and the words @xmath193 and @xmath213 refer to the standard or semistandard words of slope @xmath0 .      in this section we review some known results on powers in sturmian words , and prove helpful results for the next section .",
    "if a square @xmath23 occurs in a sturmian word of slope @xmath0 , then the length of the word @xmath21 must be a really specific number , namely a denominator of a convergent or a semiconvergent of @xmath0 .",
    "the proof can be found in ( * ? ? ?",
    "* theorem",
    "1 ) or ( * ? ? ?",
    "* proposition  4.1 ) .",
    "[ prp : square_length ] if @xmath22 with @xmath21 nonempty and primitive , then @xmath214 , @xmath215 or @xmath216 for some @xmath114 with @xmath139 .",
    "next we need to know when conjugates of ( semi)standard words occur as squares in a sturmian word .",
    "[ prp : conjugate_square ] the following holds :    a.   a factor @xmath189 is conjugate to @xmath193 for some @xmath217 if and only if @xmath218 and @xmath22 .",
    "b.   let @xmath21 be a conjugate of @xmath213 with @xmath114 and @xmath219 .",
    "then @xmath22 if and only if the intervals @xmath25 $ ] and @xmath220 $ ] have the same length .",
    "c.   let @xmath221 , @xmath222 , or @xmath223 with @xmath114 and @xmath139 , and let @xmath1 be the ( semi)standard word of length @xmath40 .",
    "a factor @xmath189 of length @xmath40 is conjugate to @xmath1 if and only if @xmath21 and @xmath1 have equally many occurrences of the letter @xmath134 .",
    "( i ) _ is a direct consequence of ( * ? ? ?",
    "* theorem  3 ) or alternatively ( * ? ? ? * theorem  4.5 ) .",
    "( ii ) _ can be inferred from theorems 4.3 and 4.5 of @xcite .",
    "finally , claim _ ( iii ) _ is evident from the proof of ( * ? ? ?",
    "* theorem  4.3 ) , but a short proof can be given : the idea is that every factor of length @xmath40 except one exceptional factor @xmath75 is conjugate to @xmath1 since @xmath224 occurs in @xmath11 by _ ( i ) _ and @xmath225 . as",
    "not every factor of length @xmath40 may have the same number of letters @xmath134 ( a right special factor always extends to two factors having different number of letters @xmath134 ) , it must be that @xmath75 has a different number of letters @xmath134 than any conjugate of @xmath1 .",
    "we also need to know the index of certain factors of sturmian words .",
    "the following proposition follows directly from theorems 3 and 4 of @xcite or from ( * ? ? ?",
    "* theorem  4.5 ) .",
    "[ prp : standard_index ] the index of the standard word @xmath193 in @xmath11 is @xmath226 for @xmath114 and @xmath227 for @xmath228 .",
    "the index of the semistandard word @xmath213 in @xmath11 with @xmath114 and @xmath219 is @xmath229 .",
    "in @xcite saari observed that every sturmian word with slope @xmath230 $ ] is an optimal squareful word with parameters @xmath231 and @xmath232 .",
    "the assumption @xmath210 implies that @xmath233 , so the six minimal squares in @xmath11 are the same as in .",
    "in particular , saari s result means that every sturmian word can be ( uniquely ) written as a product of the six _ minimal squares of slope @xmath0 _ .",
    "thus the square root map introduced next is well - defined .",
    "let @xmath1 be a sturmian word with slope @xmath0 and factorize it as a product of minimal squares @xmath234 the _ square root of @xmath1 _ is then defined to be the word @xmath3 .",
    "let us consider as an example the famous fibonacci word @xmath235 .",
    "the fibonacci word is a sturmian word of slope @xmath236 $ ] , so it has parameters @xmath237 and @xmath238 .",
    "it is also the fixed point of the substitution @xmath239 . for more information ,",
    "see for instance @xcite .",
    "we have that @xmath240    note that a square root map can be defined for any optimal squareful word",
    ". however , now we only focus on sturmian words ; we study later the square root map for other optimal squareful words in .",
    "we aim to prove the surprising fact that given a sturmian word @xmath1 the word @xmath4 is also a sturmian word having the same slope as @xmath1 .",
    "moreover , knowing the intercept of @xmath1 , we can compute the intercept of @xmath4 .    in the proof",
    "we need a special function @xmath241 defined as follows .",
    "for @xmath242 we set @xmath243 and we set @xmath244 .",
    "\\end{cases }    \\end{aligned}\\ ] ] the mapping @xmath245 moves a point @xmath13 on the circle @xmath128 towards the point @xmath162 by halving the distance between the points @xmath13 and @xmath162 . the distance to @xmath162 is measured in the interval @xmath160 or @xmath161 depending on which of these intervals the point @xmath13 belongs to .",
    "we can now state the result .",
    "[ thm : square_root ] let @xmath12 be a sturmian word with slope @xmath0 and intercept @xmath13",
    ". then @xmath246 .",
    "in particular , @xmath247 is a sturmian word with slope @xmath0 .    for a combinatorial version of the above theorem see in .",
    "the main idea of the proof is to demonstrate that the square root map is actually the symbolic counterpart of the function @xmath245 .",
    "we begin with a definition .",
    "a square @xmath22 satisfies the _ square root condition _ if @xmath26 ) \\subseteq [ w]$ ] .",
    "note that if the interval @xmath25 $ ] in the above definition has @xmath162 as an endpoint , then @xmath21 automatically satisfies the square root condition .",
    "this is because @xmath245 moves points towards the point @xmath162 but does not map them over this point .",
    "actually , if @xmath21 satisfies the square root condition , then necessarily the interval @xmath25 $ ] has @xmath162 as an endpoint ( see ) .",
    "we will only sketch the proof of the following lemma .",
    "( 0,0 ) circle ( 1.5 ) ; ( 0:1.5 ) circle(0.8pt ) ; ( 85:1.5 ) circle(0.8pt ) ; ( 170:1.5 ) circle(0.8pt ) ; ( 222.5:1.5 ) circle(0.8pt ) ; ( 254.95:1.5 ) circle(0.8pt ) ; ( 307.5:1.5 ) circle(0.8pt ) ; ( 85:1.3 ) arc ( 85:307.5:1.3 ) ; ( 85.5:1.3 ) circle(0.8pt ) ; ( 222.5:1.3 ) circle(0.8pt ) ; ( 307.5:1.3 ) circle(0.8pt ) ; at ( 1.8,0 ) ; at ( -1.6,-1.1 ) ; at ( 1.5,1.2 ) ; at ( -1.4,1.3 ) ; at ( -1.8,-0.45 ) ; at ( -1.0,-1.6 ) ; at ( 0.55,-1.7 ) ; at ( 1.7,-0.8 ) ; at ( -0.65,0.7 ) ; at ( -0.1,-1.0 ) ;    [ lem : min_square_root_formula ] for every @xmath248 the minimal square root @xmath104 of slope @xmath0 satisfies the square root condition and @xmath249 for all @xmath250 $ ] .",
    "it is straightforward to verify that @xmath251 = i(0,1-\\alpha ) ,                & & [ s_4 ] = i(1-\\alpha,1 ) , \\\\        & [ s_2 ] = i(-2\\alpha,1-\\alpha ) ,         & & [ s_5 ] = i(1-\\alpha ,- q_{2,1}\\alpha ) , \\\\        & [ s_3 ] = i(-2\\alpha,1-\\alpha ) , \\quad   & & [ s_6 ] = i(1-\\alpha ,- q_{2,1}\\alpha )      \\end{aligned}\\ ] ] and @xmath252 = i(0,-2\\alpha ) ,                         & & [ s_4 ^ 2 ] = i(-q_{2,1}\\alpha,1 ) , \\\\        & [ s_2 ^ 2 ] = i(-(q_{2,1}+1)\\alpha,1-\\alpha ) ,        & & [ s_5 ^ 2 ] = i(1-\\alpha,-(q_{3,1}+1)\\alpha ) , \\\\        & [ s_3 ^ 2 ] = i(-2\\alpha,-(q_{2,1}+1)\\alpha ) , \\quad & & [ s_6 ^ 2 ] = i(-(q_{3,1}+1)\\alpha ,- q_{2,1}\\alpha ) ,      \\end{aligned}\\ ] ] see .",
    "since @xmath245 does not map points over the point @xmath162 , it is evident that every minimal square root satisfies the square root condition .",
    "consider then the latter claim .",
    "let @xmath248 .",
    "suppose that @xmath250\\setminus\\{0\\}$ ] , @xmath253 , and @xmath254 for some @xmath255 .",
    "then @xmath256 since @xmath245 is a function from @xmath128 to @xmath128 .",
    "we consider next the cases @xmath257 and @xmath258 ; the other cases are similar .",
    "suppose that @xmath259 .",
    "now @xmath260 and @xmath261 , so @xmath262 $ ] .",
    "the claim is thus clear as in if @xmath263 and @xmath264 . if @xmath265 , then @xmath170 and @xmath266 .",
    "if @xmath267 , then @xmath172 $ ] and @xmath268 .    assume then that @xmath269",
    "note that @xmath270 .",
    "using we obtain that @xmath271 where equality holds only if @xmath272 and @xmath273 .",
    "the length of the interval @xmath274 $ ] is @xmath275 . since @xmath276 and @xmath277",
    ", it follows from the preceding inequalities that @xmath278 .",
    "therefore @xmath279 $ ] .",
    "if @xmath280 or @xmath281 , then the conclusion follows as in .",
    "suppose finally that @xmath273 and @xmath272 .",
    "now @xmath172 $ ] , so @xmath282 . on the other hand , @xmath283 so the conclusion holds also in this case .",
    "write @xmath284 as a product of minimal squares . since the minimal square @xmath285 satisfies the square root condition by",
    ", we have that @xmath286 $ ] .",
    "hence both @xmath247 and @xmath14 begin with @xmath287 .",
    "implies that @xmath288 for all @xmath289 $ ] .",
    "thus by shifting @xmath12 the amount @xmath290 and by applying the preceding reasoning , we conclude that @xmath14 shifted by the amount @xmath291 begins with @xmath292 . therefore the words @xmath247 and @xmath14 agree on their first @xmath293 letters . by repeating this procedure ,",
    "we conclude that @xmath246 .",
    "allows us to effortlessly characterize the sturmian words which are fixed points of the square root map .",
    "[ cor : fixed_points ] the only sturmian words of slope @xmath0 which are fixed by the square root map are the two words @xmath16 and @xmath17 , both having intercept @xmath162 .",
    "the only fixed point of the map @xmath245 is the point @xmath162 .",
    "having this point as an intercept , we obtain two sturmian words : either @xmath16 or @xmath17 , depending on which of the intervals @xmath160 and @xmath161 the point @xmath162 belongs to .",
    "the set @xmath294 is not only the set of fixed points but also the unique attractor of the square root map in the set of sturmian words of slope @xmath0 .",
    "when iterating the square root map on a fixed sturmian word @xmath12 , the obtained word has longer and longer prefixes in common with either of the words @xmath16 and @xmath17 because @xmath295 tends to @xmath162 as @xmath40 increases .",
    "in the previous section we saw that the minimal squares , which satisfy the square root condition , were crucial in proving that the square root of a sturmian word is again sturmian with the same slope .",
    "the minimal squares of slope @xmath0 are not the only squares in @xmath11 satisfying the square root condition ; in this section we will characterize combinatorially such squares . to be able to state the characterization , we need to define @xmath296 the set of reversed standard words of slope @xmath0 .",
    "similarly we set @xmath297 we also need the operation @xmath298 which exchanges the first two letters of a word ( we do not apply this operation to too short words ) .    the main result of this section is the following .",
    "[ thm : square_root_condition_iff_rsst ] a square @xmath22 satisfies the square root condition if and only if @xmath299 .    as we remarked in , a square @xmath22 trivially satisfies the square root condition if its interval @xmath25 $ ] has @xmath162 as an endpoint .",
    "our aim is to prove that the converse is also true .",
    "we begin with a technical lemma .",
    "[ lem : maps_out ] let @xmath222 or @xmath300 for some @xmath114 with @xmath143 , and let @xmath60 be an integer such that @xmath301 .",
    "a.   if @xmath302 and @xmath303 , then @xmath304 . b.   if @xmath305 and @xmath306 , then @xmath307 .",
    "( i ) _ , the second assertion is symmetric .",
    "suppose @xmath302 and @xmath308 .",
    "note that the distance between the points @xmath309 and @xmath310 is less than @xmath0 .",
    "it follows that @xmath311 .",
    "assume on the contrary that @xmath312 , that is , @xmath313 since @xmath314 , the distance between @xmath310 and @xmath309 is the same as the distance between @xmath159 and @xmath174 .",
    "thus by substituting @xmath315 to the above and rearranging , we have that @xmath316 since @xmath311 , we obtain that @xmath317 suppose now first that @xmath300 for some @xmath114 and @xmath143 . since @xmath318 , and imply that @xmath319 for some @xmath320 . as @xmath311 , the point @xmath321 must lie on the opposite side of @xmath134 in the interval @xmath160 .",
    "therefore @xmath322 . then by",
    ", the point @xmath309 must lie in @xmath161 .",
    "this is a contradiction .",
    "suppose then that @xmath222 .",
    "it is easy to see that can not hold for any @xmath60 greater than @xmath159 .",
    "this concludes the proof .",
    "[ cor : interval_endpoint ] if @xmath22 with @xmath21 primitive satisfies the square root condition , then the interval @xmath25 $ ] has @xmath162 as an endpoint .",
    "let @xmath323 .",
    "implies that @xmath221 , @xmath222 , or @xmath300 for some @xmath114 with @xmath143 .",
    "say @xmath324 . as the only factor of length @xmath159 occurring as",
    "a square is @xmath134 , the claim holds as @xmath325 = i_0 = i(0 , 1-\\alpha)$ ] .",
    "suppose then that @xmath222 or @xmath300 .",
    "let @xmath25 = i(-i\\alpha , -j\\alpha)$ ] .",
    "then either @xmath326 = i(-i\\alpha ,",
    "-(j + |w|)\\alpha)$ ] or @xmath326 = i(-(i + |w|)\\alpha , -j\\alpha)$ ] .",
    "suppose first that @xmath25 \\subseteq i_0 $ ] . by symmetry",
    "we may assume that @xmath327 .",
    "now @xmath326 = [ -(i+|w|)\\alpha , -j\\alpha)$ ] if and only if @xmath328 .",
    "namely , if @xmath329 , then it is clear that it is possible to find a point @xmath330 close to @xmath331 such that @xmath332 , so the condition @xmath26 ) \\subseteq [ w]$ ] can not be satisfied . if @xmath326 = [ -i\\alpha , -(j+|w|)\\alpha)$ ] and @xmath329 , then by @xmath333 , so the condition @xmath26 ) \\subseteq [ w]$ ] can not be satisfied",
    ". thus also in this case necessarily @xmath328 .",
    "the case where @xmath25 \\subseteq i_1 $ ] is proven symmetrically using the latter symmetric assertion of .",
    "next we study in more detail the properties of squares @xmath22 whose interval has @xmath162 as an endpoint .",
    "[ prp : endpoint_alpha_characterization ] consider the intervals of factors in @xmath11 of length @xmath222 or @xmath300 with @xmath114 and @xmath143 .",
    "let @xmath52 and @xmath75 be the two distinct words of length @xmath40 having intervals with endpoint @xmath162",
    ". then the following holds .",
    "a.   there exists a word @xmath21 such that @xmath334 and @xmath335 for distinct letters @xmath13 and @xmath178 .",
    "b.   either @xmath52 or @xmath75 is right special . c.   if @xmath336 is the right special word among the words @xmath52 and @xmath75 , then @xmath337 .",
    "d.   if @xmath338 is the word among the words @xmath52 and @xmath75 which is not right special , then @xmath339 if and only if @xmath222 or @xmath340 .",
    "suppose first that @xmath222 .",
    "then it is straightforward to see that the factors @xmath52 and @xmath75 of length @xmath40 having intervals with endpoint @xmath162 are @xmath341 and @xmath342 .",
    "clearly @xmath343 is right special and @xmath344 .",
    "moreover @xmath345 .",
    "assume that @xmath300 for some @xmath114 with @xmath143 .",
    "by the point @xmath174 is the point closest to @xmath134 on the side opposite to the point @xmath321 .",
    "thus either @xmath346 $ ] or @xmath347 $ ] .",
    "assume by symmetry that @xmath346 $ ] .",
    "this means that the word @xmath52 is right special , proving _",
    "( ii)_. further , the endpoint of @xmath348 $ ] which is not @xmath162 must be after a rotation the next closest point to @xmath134 on the side opposite to the point @xmath321 .",
    "thus by @xmath348 = i(-(q_{k , l-1 } + 1)\\alpha , 1-\\alpha)$ ] and consequently @xmath349 = i(1-\\alpha , -(q_{k-1 } + 1)\\alpha)$ ] .",
    "since the points @xmath350 and @xmath351 are on the opposite sides of the point @xmath162 and the points @xmath352 and @xmath353 are on the opposite sides of the point @xmath134 , it follows that @xmath52 begins with @xmath354 and @xmath75 begins with @xmath355 for distinct letters @xmath356 and @xmath357 .",
    "assume on the contrary that @xmath358 and @xmath359 for distinct letters @xmath360 and @xmath235 . in particular , @xmath361 .",
    "this means that the point @xmath362 is in @xmath363 $ ] and the point @xmath364 is in @xmath365 $ ] .",
    "it must be that @xmath366 and @xmath367 as otherwise the point @xmath368 would be in @xmath369 $ ] and the point @xmath370 would be in @xmath371 $ ] contradicting the choice of @xmath372 . since @xmath0 is irrational , either @xmath373 is closer to @xmath162 than @xmath13 or @xmath374 is closer to @xmath162 than @xmath178 .",
    "suppose that @xmath373 is closer to @xmath162 than @xmath13 .",
    "since @xmath373 is on the same side of the point @xmath162 as @xmath13 , it follows that @xmath375 since @xmath376 , by it must be that @xmath377 .",
    "however , as @xmath378 , it follows by that @xmath379 for some @xmath380 .",
    "thus @xmath381 .",
    "this is , however , a contradiction as @xmath361 .",
    "suppose then that @xmath374 is closer to @xmath162 than @xmath178 .",
    "similar to above , it follows that @xmath382 again , it must be that @xmath383 .",
    "since @xmath384 , it follows from that @xmath385 . therefore @xmath386 .",
    "this is again a contradiction with the fact that @xmath361 .    thus we conclude that @xmath387 and @xmath388 for some word @xmath21 proving _",
    "( i)_. as @xmath300 , it must be that the right special word of length @xmath40 equals @xmath389 .",
    "since @xmath52 and @xmath75 are conjugate by ( iii ) , implies that if @xmath340 , then @xmath390 .",
    "suppose that @xmath391 . by , the word @xmath392 occurs as a square in @xmath11 . since @xmath11 is mirror - invariant , also @xmath393 .",
    "therefore from it follows that @xmath394| = \\|q_{k , l-1}\\alpha\\| = |[s_{k , l}]|$ ] .",
    "now @xmath349 = i(1-\\alpha , -(q_{k-1 } + 1)\\alpha)$ ] , so @xmath395| = \\|q_{k-1}\\alpha\\| \\neq |[u]|$ ] . thus implies that @xmath396 . hence _",
    "( iii ) _ and _ ( iv ) _ are proved .    if @xmath397 , then clearly @xmath398 , so the claim holds .",
    "we may thus focus on the case that @xmath399 .",
    "suppose that @xmath22 satisfies the square root condition . by the interval",
    "@xmath25 $ ] has @xmath162 as an endpoint .",
    "moreover , implies that @xmath215 or @xmath400 for some @xmath114 with @xmath143 .",
    "thus from it follows that @xmath401 or @xmath402 where @xmath1 is the ( semi)standard word of length @xmath41 . by we have that @xmath403 .",
    "moreover , by we have that @xmath404 if and only if @xmath405 for some @xmath109 .",
    "thus @xmath299 .",
    "suppose then that @xmath299 .",
    "note first that @xmath406 has the same number of letters @xmath134 as @xmath21 , so @xmath21 is conjugate to @xmath406 by .",
    "thus it follows from that @xmath22 .",
    "let @xmath52 and @xmath75 be the factors of length @xmath41 having endpoint @xmath162 . by the word @xmath52 must be right special and @xmath407 .",
    "since the right special factor of length @xmath41 is unique , either @xmath408 or @xmath409 . thus the interval @xmath25 $ ] has @xmath162 as an endpoint",
    ". then clearly @xmath23 satisfies the square root condition .",
    "it turns out that the squares of slope @xmath0 satisfying the square root condition have also a different characterization in terms of specific solutions of the word equation @xmath410 in the language @xmath11 .",
    "we are interested only in the solutions of where all words @xmath411 are _ minimal square roots _ ,",
    "i.e. , primitive roots of minimal squares .",
    "thus we give the following definition .    a nonempty word",
    "@xmath21 is a _ solution to _",
    "if @xmath21 can be written as a product of minimal square roots @xmath412 which satisfy the word equation .",
    "the solution is _ trivial _ if @xmath413 and _ primitive _ if @xmath21 is primitive .",
    "the word @xmath21 is a _ solution to in @xmath11 _ if @xmath21 is a solution to and @xmath22 .",
    "all minimal square roots of slope @xmath0 are trivial solutions to .",
    "one example of a nontrivial solution is @xmath414 in the language of the fibonacci word ( i.e. , in the language of slope @xmath236 $ ] ) since @xmath415 .",
    "note that in the language of any sturmian word there are only finitely many trivial solutions as the index of every factor is finite .",
    "note that the factorization of a word as product of minimal squares is unique . indeed ,",
    "if @xmath416 , where the squares @xmath6 and @xmath417 are minimal , then either @xmath285 is a prefix of @xmath418 or vice versa . therefore by minimality @xmath419 , that is , @xmath420 .",
    "the uniqueness of the factorization follows .    our aim is to complete the characterization of as follows .",
    "[ thm : complete_characterization ] let @xmath189 .",
    "the following are equivalent :    a.   @xmath21 is a primitive solution to in @xmath11 , b.   @xmath23 satisfies the square root condition , c.   @xmath299 .    for later use in",
    "we define the language @xmath421 .",
    "the language @xmath421 consists of all factors of the infinite words in the language @xmath422    observe that by every factor in @xmath421 is a factor of some optimal squareful word with parameters @xmath102 and @xmath103 .",
    "moreover , if @xmath423 $ ] , then @xmath424 .",
    "the language @xmath425 consists of all nonempty words in @xmath421 which can be written as products of the minimal squares .",
    "let @xmath426 , that is , @xmath427 for minimal square roots @xmath411",
    ". then we can define the square root of @xmath21 by setting @xmath428 .",
    "we need two technical lemmas .",
    "their proofs are straightforward case - by - case analysis .",
    "the statement of has a technical condition for later use in , which is perhaps better understood if the reader first reads the proof of up to the point where is invoked .",
    "[ lem : exchange_squares ] let @xmath52 and @xmath75 be words such that    * @xmath52 is a nonempty suffix of @xmath429 , * @xmath430 , * @xmath75 begins with @xmath431 for distinct letters @xmath13 and @xmath178 , * @xmath432 and @xmath433 .",
    "suppose there exists a minimal square @xmath434 such that @xmath435 and @xmath434 is a prefix of @xmath436 or @xmath437 .",
    "then there exist minimal squares @xmath438 such that @xmath434 and @xmath439 are prefixes of @xmath436 and @xmath437 of the same length and @xmath440 .",
    "let @xmath441 be a minimal square such that @xmath442 and @xmath441 is a prefix of @xmath436 or @xmath437 .",
    "it is not obvious at this point that @xmath443 exists but its existence becomes evident as this proof progresses . by symmetry",
    "we may assume that @xmath441 is a prefix of @xmath436 .",
    "to prove the claim we consider different cases depending on the word @xmath443 .",
    "* case a. * @xmath444 .",
    "since @xmath52 is a nonempty suffix of @xmath429 and @xmath442 , it must be that @xmath445 .",
    "as @xmath75 begins with @xmath134 , we have that @xmath75 begins with @xmath446 by assumption . since @xmath447 and @xmath448",
    ", the word @xmath75 begins with either @xmath449 or @xmath450 . in the latter case @xmath451",
    "would begin with @xmath452 contradicting the assumption @xmath433 .",
    "hence @xmath75 begins with @xmath449 .",
    "it follows that @xmath436 has @xmath453 as a prefix , that is , @xmath436 begins with @xmath454 . on the other hand , the word @xmath437 has the word @xmath455 as a prefix . since @xmath456 , the conclusion of the claim holds .",
    "* case b. * @xmath457 .",
    "if @xmath445 , then @xmath75 has @xmath458 as a prefix and , consequently , @xmath451 has @xmath459 as a prefix contradicting the fact that @xmath433 .",
    "therefore by the assumptions that @xmath52 is a nonempty suffix of @xmath429 and @xmath442 , it follows that @xmath460 .",
    "thus @xmath75 has @xmath461 as a prefix .",
    "using the fact that @xmath433 , we see that @xmath75 begins with @xmath462 and @xmath451 begins with @xmath463 .",
    "hence @xmath436 has @xmath464 as a prefix , and @xmath437 has @xmath465 as a prefix . since @xmath466 , we conclude , as in the previous case , that the conclusion holds .    * case c. * @xmath467 . using again the fact that @xmath52 is a suffix of @xmath429 and @xmath442 , we see that either @xmath445 or @xmath460 . in the first case @xmath75",
    "begins with @xmath468 and @xmath451 begins with @xmath449 .",
    "hence the word @xmath437 has @xmath454 as a prefix . as @xmath469",
    ", the conclusion follows .",
    "let us then consider the other case .",
    "now @xmath451 begins with @xmath462 , so the word @xmath437 has @xmath464 as a prefix .",
    "again , the conclusion follows since @xmath466 .",
    "* case d. * @xmath470 .",
    "now the only option is that @xmath471 .",
    "using the fact that @xmath447 , we see that @xmath75 can not begin with @xmath472 , so @xmath75 must have @xmath462 as a prefix .",
    "further , since @xmath448 , it must be that @xmath429 is a prefix of @xmath75 .",
    "if @xmath473 would be a prefix of @xmath75 , then the word @xmath451 would have the word @xmath474 as a factor contradicting the fact that @xmath433 .",
    "thus @xmath475 is a prefix of @xmath75 .",
    "since @xmath447 and @xmath476 , we have that @xmath477 is a prefix of @xmath75 .",
    "consequently , the word @xmath451 begins with @xmath478 , so @xmath437 has @xmath479 as a prefix .",
    "assume first that @xmath103 is odd .",
    "it is straightforward to see that in this case @xmath480 thus for the prefix @xmath481 of @xmath436 we have that @xmath482 as @xmath483 , the conclusion follows as before .",
    "assume then that @xmath103 is even .",
    "it is now easy to show that @xmath484 therefore @xmath485 since @xmath486 , the conclusion again follows .",
    "* case e. * @xmath487 .",
    "now either @xmath471 or @xmath488 .",
    "in the first case @xmath75 must begin with @xmath489 .",
    "however , this implies that @xmath451 begins with @xmath490 contradicting the fact that @xmath433 .",
    "consider then the latter case where @xmath75 begins with @xmath491 .",
    "as @xmath433 and @xmath448 , it must be that @xmath451 begins with @xmath492 .",
    "hence the word @xmath437 has @xmath479 as a prefix .",
    "since the word @xmath75 begins with @xmath493 , the word @xmath436 has @xmath494 as a prefix .",
    "the conclusion follows as @xmath495 .",
    "* case f. * @xmath496 .",
    "now there are two possibilities : either @xmath471 or @xmath488 . in the first case @xmath75",
    "begins with @xmath478 , so @xmath451 begins with @xmath497 .",
    "the word @xmath437 has @xmath498 as a prefix .",
    "proceeding as in the case d depending on the parity of @xmath103 , we see that the conclusion holds .",
    "consider then the latter case @xmath488 .",
    "the word @xmath75 must begin with @xmath52 , so @xmath451 has @xmath493 as a prefix .",
    "clearly the word @xmath437 has @xmath494 as a prefix . as @xmath499 , the conclusion follows .",
    "a more intuitive way of stating is that under the assumptions of the lemma swapping two adjacent and distinct letters which do not occur as a prefix of a minimal square affects a product of minimal square only locally and does not change its square root .    [",
    "lem : product_of_squares ] let @xmath21 be a primitive solution to having the word @xmath500 as a suffix such that @xmath501 . then @xmath502 and @xmath503 .    if @xmath504 , then it is easy to see that @xmath505 and @xmath506 , so the claim holds .",
    "we may thus suppose that @xmath429 is a proper suffix of @xmath21 .",
    "since @xmath21 is a solution to , we have that @xmath507 and @xmath508 for some minimal square roots @xmath411 .",
    "it must be that @xmath509 as if @xmath71 then @xmath510 , and it is not possible for @xmath429 to be a proper suffix of @xmath21 .",
    "assume for a contradiction that @xmath511 .",
    "since @xmath512 is a prefix of @xmath23 , it follows that @xmath292 begins with the letter @xmath134 .",
    "if @xmath513 , then @xmath512 begins with @xmath514 but @xmath515 begins with @xmath516 , which is impossible .",
    "hence @xmath517 , and by repeating the argument it follows that @xmath518 for all @xmath120 such that @xmath519 .",
    "thus @xmath21 can not have @xmath429 as a suffix , so we conclude that @xmath520 . hence @xmath21 always begins with @xmath446 or @xmath521 .",
    "we show that @xmath522 .",
    "assume on the contrary that @xmath523 .",
    "since @xmath21 has the word @xmath429 as a suffix , it follows that @xmath429 is a factor of @xmath285 .",
    "it follows that @xmath287 is one of the words @xmath524 , @xmath429 or @xmath525 ( if @xmath238 ) . if @xmath526 , then @xmath429 occurs in @xmath527 only as a prefix",
    ". thus @xmath504 contradicting the fact that @xmath429 is a proper suffix of @xmath21 .",
    "if @xmath528 , then @xmath429 occurs in @xmath529 as a prefix and as a suffix . since @xmath530 , it must be that @xmath531 contradicting the primitivity of @xmath21 .",
    "let finally @xmath238 and @xmath532 .",
    "then @xmath429 occurs in @xmath533 as a suffix . hence @xmath531 contradicting again the primitivity of @xmath21 .",
    "now there exists a maximal @xmath534 such that @xmath535 and @xmath536 is a prefix of @xmath21 .",
    "actually @xmath536 is a proper prefix of @xmath21 , as otherwise @xmath537 , so @xmath538 contradicting the primitivity of @xmath21 .",
    "thus when factorizing @xmath539 and @xmath23 as products of minimal squares , the first @xmath534 squares are equal .",
    "let @xmath52 be the nonempty word such that @xmath540 . by the definition of the number @xmath534",
    ", we have that @xmath52 is a proper prefix of @xmath541 .",
    "suppose for a contradiction that @xmath542 .",
    "it follows that @xmath52 has @xmath429 as a proper suffix .",
    "this leaves only the possibilities that @xmath543 is either of the words @xmath524 or @xmath429 .",
    "however , if @xmath544 , then @xmath429 can not be a proper suffix of @xmath52 , and if @xmath545 , then @xmath534 is not maximal .",
    "we conclude that @xmath546 .",
    "next we show that @xmath21 must satisfy @xmath547 .",
    "suppose first that @xmath21 begins with the letter @xmath134 .",
    "then as @xmath429 is a proper suffix of @xmath21 and @xmath548 , it must be that @xmath21 begins with @xmath549 .",
    "suppose that this prefix overlaps with the suffix @xmath429 . then clearly @xmath550 contradicting the primitivity of @xmath21 . if the prefix @xmath549 does not overlap with the suffix @xmath429 , then @xmath547 . assume then that @xmath21 begins with the letter @xmath159 .",
    "similar to above , the word @xmath21 must begin with @xmath492 . in this case",
    "necessarily @xmath547 .",
    "finally , we can apply to the words @xmath52 and @xmath21 with @xmath551 .",
    "we obtain minimal squares @xmath552 such that @xmath553 is a prefix of @xmath554 and and @xmath555 for some @xmath556 .",
    "thus @xmath557 the claim is proved .",
    "[ prp : standard_solutions ] let @xmath299 .",
    "then the word @xmath21 is a primitive solution to in @xmath11 .",
    "note that implies that @xmath22 .",
    "suppose first that @xmath558 where @xmath559 .",
    "clearly the minimal square root @xmath560 are solutions to , so we are left with the case where @xmath561 for some @xmath562 such that @xmath563 .",
    "it is straightforward to see that if @xmath562 is even , then @xmath564 if @xmath562 is odd , then @xmath565 hence @xmath21 is a solution to .",
    "we may thus suppose that @xmath566 , so @xmath21 has @xmath429 as a suffix .",
    "we proceed by induction .",
    "now either @xmath567 for some @xmath568 with @xmath139 or @xmath569 for some @xmath568 .",
    "we assume that the claim holds for every word satisfying the hypotheses which are shorter than @xmath21 .",
    "consider first the case @xmath567 for some @xmath568 with @xmath139 .",
    "by the fact that @xmath570 we obtain that @xmath571 now if @xmath572 and @xmath573 , then the conclusion holds as @xmath574 is a minimal square root . hence we may assume that either @xmath575 or @xmath572 and @xmath576 .",
    "since @xmath577 is a solution to , we have that @xmath578 and @xmath579 for some minimal square roots @xmath411 .",
    "in other words , @xmath580 since @xmath581 , with an application of we obtain that @xmath582 thus @xmath583 and @xmath584 so @xmath21 is a solution to .",
    "consider next the case @xmath585 for some @xmath568 .",
    "similar to above , @xmath586 if @xmath575 , then the claim follows using the induction hypothesis and as above . in the case",
    "@xmath572 we have that @xmath587 namely , it is not difficult to see that if @xmath103 is even , then @xmath588 if @xmath103 is odd , then @xmath589 thus @xmath21 is a solution to also in the case @xmath572 .",
    "note that a word @xmath21 in the set @xmath590 is a solution to but not in the language @xmath11 .",
    "rather , @xmath21 is a solution to in @xmath591 where @xmath592 is a suitable irrational such that @xmath406 is a reversed standard word of slope @xmath592 .    from we",
    "conclude the following interesting fact :    there exist arbitrarily long primitive solutions of in @xmath11",
    ".    we can now prove .    by",
    "and it is sufficient to prove that _",
    "( i ) _ implies _",
    "( ii)_.    suppose that @xmath21 is a solution to in @xmath11 .",
    "write @xmath23 as a product of minimal squares : @xmath593 .",
    "let @xmath594 $ ] .",
    "then the word @xmath12 begins with @xmath595 , so by the word @xmath246 begins with @xmath596",
    ". therefore @xmath597 = [ w]$ ] .",
    "thus @xmath23 satisfies the square root condition .",
    "recall from that the square root @xmath4 of a sturmian word @xmath1 has the same factors as @xmath1 .",
    "the proofs were dynamical ; we used the special mapping @xmath245 on the circle . in this section",
    "we describe combinatorially why the language is preserved ; we give a location for any prefix of @xmath4 in @xmath1 . as a side product , we are able to describe when a sturmian word is uniquely factorizable as a product of squares of reversed ( semi)standard words .",
    "let us begin with an introductory example .",
    "recall from the square root of the fibonacci word @xmath235 : @xmath598 obviously the square root @xmath599 of @xmath600 occurs as a prefix of @xmath235 .",
    "equally clearly the word @xmath601 occurs , not as a prefix , but after the prefix @xmath287 of @xmath235 .",
    "thus the position of the first occurrence of @xmath602 shifted @xmath603 positions from the position of the first occurrence of @xmath287 .",
    "however , when comparing the position of the first occurrence of @xmath604 with the first occurrence of @xmath602 , we see that there is no further shift . by further inspection",
    ", the word @xmath605 occurs for the first time at position @xmath291 of @xmath235 .",
    "this is no longer true for the first seven minimal squares ; the first occurrence of @xmath606 is at position @xmath607 of @xmath235 .",
    "the amount of shift from the previous position @xmath603 is @xmath608 ; observe that both of these numbers are fibonacci numbers .",
    "thus the amount of shift was exactly the length of the square roots added after observing the previous shift .",
    "as an observant reader might have noticed , both of the words @xmath287 and @xmath292 are reversed standard words , or equivalently , primitive solutions to .",
    "repeating similar inspections on other sturmian words suggests that there is a certain pattern to these shifts and that knowing the pattern would make it possible to locate prefixes of @xmath4 in the sturmian word @xmath1 .",
    "thus it makes very much sense to `` accelerate '' the square root map by considering squares of solutions to instead of just minimal squares .",
    "next we make these somewhat vague observations more precise .",
    "every sturmian word has a solution of as a square prefix .",
    "next we aim to characterize sturmian words having infinitely many solutions of as square prefixes .",
    "the next two lemmas are key results towards such a characterization .",
    "[ lem : square_union ] consider the reversed ( semi)standard word @xmath389 of slope @xmath0 with @xmath114 and @xmath139 .",
    "the set @xmath609\\setminus\\{1-\\alpha\\}$ ] equals the disjoint union @xmath610 \\right ) \\setminus \\bigcup_{i = 1}^{l-1 } [ { \\widetilde{s}}_{k , i}^{\\,2 } ] .",
    "\\end{aligned}\\ ] ] analogous representations exist for the sets @xmath611\\setminus\\{1-\\alpha\\}$ ] and @xmath612\\setminus\\{1-\\alpha\\}$ ] .    to put it more simply :",
    "for each @xmath613 there exists a unique reversed ( semi)standard word @xmath21 such that @xmath594 $ ] . to illustrate the proof , we begin by giving a proof sketch .",
    "consider as an example the interval @xmath325 = i(0 , 1-\\alpha)$ ] .",
    "it is easy to see that @xmath614 = i(0 , -2\\alpha ) = i(0 , -(q_0 + 1)\\alpha)$ ] , so @xmath325 = [ 0 ^ 2 ] \\cup i(-(q_0 + 1)\\alpha , 1-\\alpha)$ ] .",
    "the interval @xmath615 is the interval of the factor @xmath616 . therefore @xmath325 = [ { \\widetilde{s}}_0^{\\,2 } ] \\cup [ { \\widetilde{s}}_{2,1}]$ ] .",
    "since @xmath617 , the interval @xmath618 $ ] splits into two parts : @xmath619 = [ { \\widetilde{s}}_{2,1}^{\\,2 } ] \\cup j$ ] .",
    "it is straightforward to show that @xmath620 .",
    "again , the interval @xmath621 is the interval of the factor @xmath21 which equals either @xmath622 or @xmath623 depending on the number @xmath624 . so @xmath325 = [ { \\widetilde{s}}_0^{\\,2 } ] \\cup [ { \\widetilde{s}}_{2,1}^{\\,2 } ] \\cup [ w]$ ] .",
    "this process can be repeated for the interval @xmath25 $ ] and indefinitely after that .",
    "the very same idea can be applied to any interval @xmath609 $ ] .",
    "consider the lengths of the reversed ( semi)standard words beginning with the same letter as @xmath625 .",
    "out of these lengths we can form the unique increasing sequence @xmath626 such that @xmath627 .",
    "if we set @xmath628 and @xmath629 , then based on the observations in the proof of we see that @xmath630 $ ] .",
    "the interval @xmath631 is split by the point @xmath632 .",
    "it must be that @xmath633 = i(-(b_1 + 1)\\alpha , -(b_2 + 1)\\alpha)$ ] . otherwise @xmath633 = [ s_1 ] \\cap r^{-b_2}([s_1 ] ) = i(-(b_2 + 1)\\alpha , 1-\\alpha)$ ] , so the points @xmath634 and @xmath635 are on the opposite sides of @xmath134 .",
    "furthermore , @xmath636 equals the distance between the points @xmath635 and @xmath637 , so @xmath638 .",
    "since also the point @xmath321 is on the side opposite to @xmath635 , it follows that @xmath639 which is obviously false . thus",
    "@xmath640 = i(-(b_2 + 1)\\alpha,1-\\alpha)$ ] is the interval of @xmath641 , the unique reversed ( semi)standard word of length @xmath642 beginning with the same letter as @xmath643 . by repeating this when @xmath509 , we see that the interval @xmath644 is split by the point @xmath645 and that @xmath646 = i(-(b_n+1)\\alpha , -(b_{n+1}+1)\\alpha)$ ]",
    "then there is a unique reversed ( semi)standard word @xmath647 such that @xmath648 = i(-(b_{n+1}+1)\\alpha,1-\\alpha ) = j_n \\setminus [ s_n^2]$ ] ; we set @xmath649 $ ] . by the definition of the sequence @xmath626 , the words @xmath647 and",
    "@xmath643 begin with the same letter .",
    "this yields a well - defined sequence @xmath650 of nested subintervals of @xmath631 .",
    "it is clear that @xmath651 as @xmath652 .",
    "it follows that @xmath653 \\cup \\{1-\\alpha\\ } = j_1 \\cup \\{1-\\alpha\\ } = \\bigcup_{n=1}^\\infty [ s_n^2 ] \\cup \\{1-\\alpha\\}.      \\end{aligned}\\ ] ] the sets @xmath646 $ ] are by definition disjoint .",
    "the claim follows since the indexing in the claim is just another way to express the reversed ( semi)standard words having lengths from the sequence @xmath626 .",
    "the above proof works as it is for the cases @xmath654 and @xmath655 ; only minor adjustments in notation are needed .",
    "[ lem : not_square_prefix ] let @xmath656 and @xmath657 .",
    "then @xmath658 is never a proper prefix of @xmath659 .    if @xmath660 and @xmath661 , then by , the intervals @xmath662 $ ] and @xmath663 $ ] are disjoint . hence @xmath658 can never be a proper prefix of @xmath659 .",
    "assume then that @xmath664 .",
    "if @xmath665 , then @xmath659 is a minimal square , so it is not possible for @xmath658 to be a proper prefix of @xmath659 .",
    "suppose that @xmath666 for some @xmath114 with @xmath139 .",
    "as in the proof of , we have that @xmath349 = i(-(q_{k-1}+1)\\alpha , 1-\\alpha)$ ] . if @xmath52 begins with the same letter as @xmath75 and @xmath667 , then @xmath668 .",
    "it follows , as in the proof of , that the distance between @xmath162 and either of the endpoints of the interval @xmath662 $ ] must be at least @xmath150 . hence the intervals @xmath349 $ ] and @xmath662 $ ] are disjoint , so @xmath658 is not a proper prefix of @xmath659 .",
    "let @xmath1 be a fixed sturmian word of slope @xmath0 . since the index of a factor of a sturmian word is finite , and",
    "imply that if @xmath1 has infinitely many solutions of as square prefixes then no word in @xmath669 is a square prefix of @xmath1 .",
    "we have now the proper tools to prove the following :    [ prp : begins_with_rsst ] let @xmath12 be a sturmian word of slope @xmath0 and intercept @xmath13",
    ". then @xmath12 begins with a square of a word in @xmath669 if and only if @xmath613 .",
    "if @xmath613 , then @xmath670\\setminus\\{1-\\alpha\\}$ ] or @xmath671\\setminus\\{1-\\alpha\\}$ ] .",
    "thus by applying to @xmath672 or @xmath673 , we see that the word @xmath12 begins with a square of a word in @xmath669 .",
    "suppose then that @xmath674 .",
    "then @xmath675 .",
    "it is a well - known fact that @xmath676 and @xmath677 for some palindromes @xmath678 and @xmath679 for every @xmath109 ( see e.g. ( * ? ? ?",
    "* lemma  2.2.8 ) ) . as @xmath680",
    ", it follows that @xmath681 and @xmath682 .",
    "hence by , the word @xmath12 can not have as a prefix a square of a word in @xmath669 .",
    "it follows that if @xmath1 has infinitely many solutions of as square prefixes , then @xmath683 .",
    "next we take one extra step and characterize when @xmath1 can be written as a product of squares of words in @xmath669 .",
    "a sturmian word @xmath1 of slope @xmath0 can be written as a product of squares of words in @xmath669 if and only if @xmath1 is not of the form @xmath684 where @xmath685 and @xmath686 .",
    "if @xmath1 is a product of squares in @xmath669 , then this product is unique .",
    "this is a direct consequence of and .",
    "suppose that @xmath687 . then the word @xmath1 has only finitely many solutions of as square prefixes .",
    "we call the longest solution _ maximal_. observe that the maximal solution is not necessarily primitive since any power of a solution to is also a solution .",
    "sturmian words of slope @xmath0 can be classified into two types .    * type a*. sturmian words @xmath1 of slope",
    "@xmath0 which can be written as products of maximal solutions to . in other words , it can be written that @xmath688 where @xmath411 is the maximal solution occurring as a square prefix of the word @xmath689 where @xmath690 .",
    "* type b*. sturmian words @xmath1 of slope @xmath0 which are of the form @xmath691 where @xmath686 and the words @xmath411 are maximal solutions as above .    and",
    "imply that the words @xmath411 in the above definitions are uniquely determined and that the primitive root of a maximal solution is in @xmath669 .",
    "consequently , a maximal solution is always right special .",
    "when finding the factorization of a sturmian word as a product of squares of maximal solutions , it is sufficient to detect at each position the shortest square of a word in @xmath669 and take its largest even power occurring in that position .    keeping the sturmian word @xmath1 of slope @xmath0 fixed , we define two sequences @xmath692 and @xmath693 .",
    "we set @xmath694 .",
    "following the notation above , we define depending on the type of @xmath1 as follows .    *",
    "( a ) * if @xmath1 is of type a , then we set for all @xmath109 that @xmath695    * ( b ) * if @xmath1 is of type b , then we set for @xmath519 that @xmath696 and we let @xmath697    compare these definitions with the example in the beginning of this section ; the words @xmath287 and @xmath292 are maximal solutions in the fibonacci word ( which is of type a ) .",
    "we are finally in a position to formulate precisely the observations made in the beginning of this section and state the main result of this section .",
    "[ thm : combinatorial_version ] let @xmath1 be a sturmian word with slope @xmath0 .    _",
    "( a ) _ if @xmath1 is of type a , then @xmath698 moreover , the first occurrence of the prefix @xmath699 of @xmath4 is at position @xmath700 of @xmath1 for all @xmath217 .",
    "_ ( b ) _ if @xmath1 is of type b , then @xmath701 moreover , the first occurrence of the prefix @xmath699 with @xmath702 is at position @xmath700 of @xmath1 , and the first occurrence of any prefix of @xmath4 having lenght greater than @xmath703 is at position @xmath703 of @xmath1 .",
    "in particular @xmath4 is a sturmian word with slope @xmath0 .",
    "the theorem only states where the prefixes @xmath704 of @xmath4 occur for the first time . for the first occurrence of other prefixes of @xmath4 we do not have a guaranteed location .",
    "\\(a ) at ( -5.75,0.8 ) ; ( b ) at ( @xmath705 ) ; ( x1 ) at ( @xmath706 ) ; ( a )  ( b ) ; at ( x1 ) ; ( c ) at ( @xmath707 ) ; ( d ) at ( @xmath708 ) ; ( x2 ) at ( @xmath709 ) ; ( c )  ( d ) ; at ( x2 ) ; ( e ) at ( @xmath710 ) ; ( f ) at ( @xmath711 ) ; ( x3 ) at ( @xmath712 ) ; ( e )  ( f ) ; at ( x3 ) ; ( g ) at ( @xmath713 ) ; ( h ) at ( @xmath714 ) ; ( x4 ) at ( @xmath715 ) ; ( g )  ( h ) ; at ( x4 ) ; ( i ) at ( @xmath716 ) ; ( j ) at ( @xmath717 ) ; ( x5 ) at ( @xmath718 ) ; ( i ) ",
    "( j ) ; at ( x5 ) ;    ( box )    ;    = [ line width=0.8pt , black,<- > ] ( b1 ) at ( @xmath719 ) ; ( b1 )  ( @xmath720 ) ; ( b2 ) at ( @xmath721 ) ; ( b2 )  ( @xmath722 ) ; ( b3 ) at ( @xmath723 ) ; ( b3 )  ( @xmath724 ) ; ( b4 ) at ( @xmath725 ) ; ( b4 )  ( @xmath726 ) ;    = [ line width=0.8pt , gray,<- > ] ( d1 ) at ( @xmath727 ) ; ( d1 )  ( @xmath728 ) ; ( d2 ) at ( @xmath729 ) ; ( d2 )  ( @xmath730 ) ; ( d3 ) at ( @xmath731 ) ; ( d3 )  ( @xmath732 ) ; ( d4 ) at ( @xmath733 ) ; ( d4 )  ( @xmath734 ) ;    to illustrate the theorem , consider next @xmath735 , the eighth shift of the fibonacci word .",
    "if we write under the word @xmath735 each of the corresponding words @xmath704 at the position of their first occurrence we get the picture in .",
    "shows that the nice pattern where the words @xmath704 overlap continues indefinitely and , moreover , that if we replace @xmath735 with any other sturmian word ( of type a ) we obtain a similar picture .",
    "most of the results of this paper were motivated by the discovery of this pattern .    before proving the theorem",
    "we need one more result .",
    "[ prp : max_solution_suffix ] suppose that @xmath1 is a sturmian word of type a. then the word @xmath704 is right special and a suffix of the word @xmath736 for all @xmath217",
    ".    this proof might be tricky to follow .",
    "we advise the reader to keep the picture of in mind while reading the proof .",
    "this picture depicts only the case a below but is surely helpful .",
    "the assertion is evident when @xmath737 .",
    "suppose that @xmath738 and assume that @xmath704 is right special and that @xmath704 is a suffix of the word @xmath736 .",
    "it is equivalent to say that @xmath739 $ ] and @xmath740 \\subseteq r^{-|\\lambda_k|}([\\lambda_k])$ ] ( evidently @xmath741 ) .",
    "we write simply @xmath742 , @xmath743 , and @xmath744 .",
    "this proof utilizes only the facts that @xmath745 and that @xmath338 is right special and a suffix of the word @xmath336 , not the structure of the words @xmath338 and @xmath336 implied by their definitions .",
    "thus without loss of generality , we may assume that @xmath746 is primitive .",
    "consequently , @xmath747 .",
    "it follows that @xmath748    & = i(-(q+1)\\alpha,1-\\alpha ) \\text { and } \\\\        [ x^2 ] & = [ x ] \\cap r^{-|x|}([x ] ) = i(-(q+1)\\alpha , -(|x| + 1)\\alpha ) .",
    "\\nonumber      \\end{aligned}\\ ] ] for some nonnegative integer @xmath749 .",
    "let @xmath750 .",
    "it follows from the hypothesis @xmath751 $ ] that @xmath752)$ ] . by the point @xmath13",
    "is an endpoint of the interval @xmath753)$ ] .",
    "let then @xmath754 . by the point @xmath178",
    "is an endpoint of the interval @xmath755)$ ] and an interior point of the interval @xmath753)$ ] .",
    "suppose for a contradiction that @xmath756)$ ] .",
    "as @xmath757)$ ] ( otherwise it would follow that @xmath758)$ ] which contradicts ) , it follows that @xmath759 ) \\cap r^{-|\\mu x|}([x ] ) = \\emptyset$ ] . since @xmath760 = [ \\mu ] \\cap r^{-|\\mu|}([x ] ) \\cap r^{-|\\mu x|}([x ] ) ,      \\end{aligned}\\ ] ] we have that @xmath761 \\subseteq r^{-|\\mu x|}([x])$ ] . by assumption",
    "@xmath761 \\subseteq [ \\mu ] \\subseteq r^{-|\\lambda|}([\\lambda])$ ] .",
    "thus @xmath761 \\subseteq r^{-|\\lambda|}([\\lambda ] ) \\cap r^{-|\\mu x|}([x])$ ] , so by the above we are forced to conclude that @xmath761 = \\emptyset$ ] .",
    "this is a contradiction since @xmath746 is chosen in such a way that @xmath761 = [ \\mu x^2 ] \\neq \\emptyset$ ] .",
    "we conclude that @xmath762)$ ] .",
    "now @xmath763 ) = r^{-|\\lambda|}([\\lambda ] ) \\cap r^{-|\\mu|}([x])$ ] . since @xmath762 ) , r^{-|\\mu|}([x])$ ] , it follows that @xmath764)$ ] .",
    "thus @xmath765 $ ] , so the word @xmath766 is right special .",
    "we have two cases depending on the length of the interval @xmath753)$ ] compared to the length of the interval @xmath759)$ ] .",
    "* case a. * @xmath753 ) \\nsubseteq r^{-|\\lambda|}([\\lambda])$ ] . in this case @xmath763 ) = i(x , z)$ ] where @xmath372 an endpoint of @xmath759)$ ] . since @xmath178 is an interior point of @xmath763)$ ] , @xmath767 , and @xmath768)$ ] , we obtain that @xmath769)$ ] . since @xmath178 is also an interior point of @xmath759)$ ]",
    ", we obtain similarly that @xmath759 ) \\cap r^{-|\\mu|}([x^2 ] ) = i(y , z)$ ] . thus @xmath760 = [ \\mu ] \\cap r^{-|\\mu|}([x^2 ] ) \\subseteq r^{-|\\lambda|}([\\lambda ] ) \\cap r^{-|\\mu|}([x^2 ] ) = i(y , z ) \\subseteq",
    "r^{-|\\lambda x|}([\\lambda x ] ) .",
    "\\end{aligned}\\ ] ] this proves that @xmath770 is a suffix of @xmath771 .",
    "* case b. * @xmath753 ) \\subseteq r^{-|\\lambda|}([\\lambda])$ ] .",
    "it follows that @xmath763 ) = r^{-|\\mu|}([x])$ ] , so @xmath772 ) = r^{-|\\mu x|}([x])$ ] . since @xmath773 ) \\subseteq",
    "r^{-|\\mu x|}([x])$ ] , we get that @xmath760 = [ \\mu ] \\cap r^{-|\\mu|}([x^2 ] ) \\subseteq [ \\mu ] \\cap r^{-|\\mu x|}([x ] ) \\subseteq [ \\mu ] \\cap r^{-|\\lambda x|}([\\lambda x ] )      \\end{aligned}\\ ] ] proving that also in this case @xmath770 is a suffix of @xmath771 .",
    "note that even though @xmath704 is right special and always a suffix of @xmath736 , it is not necessary for @xmath736 to be right special .",
    "= [ line width=0.8pt,|-| ] = [ line width=0.8pt , black ] = [ line width=0.8pt , bluish , text = bluish , font= * * ] = [ line width=0.8pt , greenish , text = greenish , font= * * ] = [ line width=0.8pt , cyanish , text = cyanish , font= * * ] * * * * * *    ( 2,0 ) circle(0.9pt ) ; at ( 2,0.3 ) ; ( 3,0 ) circle(0.9pt ) ; at ( 3,0.3 ) ; at ( 7,0.3 ) ;    ( 0,0 ) ",
    "( 7,0 ) ; at ( 10,0 ) ;    ( 2,-0.5 ) ",
    "( 8,-0.5 ) ; at ( 10,-0.5 ) ;    ( 3,-1 ) ",
    "( 9,-1 ) ; at ( 10,-1 ) ;    ( 2,0 ) ",
    "( 2,-1.5 ) ; ( 7,0 ) ",
    "( 7,-2.5 ) ;    ( 3,0 ) ",
    "( 3,-2.5 ) ; ( 6,0.5 ) ",
    "( 6,-1 ) ;    ( 2,-1.5 ) ",
    "( 7,-1.5 ) ; at ( 10,-1.5 ) ;    ( 3,-2 )  ( 8,-2 ) ; at ( 10,-2 ) ;    ( 3,-2.5 )  ( 7,-2.5 ) ; at ( 10,-2.5 ) ;    ( 1.5,0.5 )  ( 6,0.5 ) ; at ( 10,0.5 ) ; ( 2,-0.5 )  ( 6,-0.5 ) ; ( 3,-1 ) ",
    "( 6,-1 ) ;    = [ line width=0.8pt,|-| ] = [ line width=0.8pt , black,-| ]    \\(o ) at ( 0,0 ) ; ( a ) at ( 10,0 ) ; ( d ) at ( 0,-0.7 ) ; ( u ) at ( 0,0.3 ) ; ( m ) at ( @xmath774 ) ; ( w ) at ( @xmath775 ) ; ( x ) at ( @xmath776 ) ;    \\(o ) ",
    "( @xmath777 ) ; ( 0,0 )  ( @xmath778 ) ; ( @xmath779 )  ( @xmath780 ) ; ( @xmath780 )  ( @xmath781 ) ; ( @xmath781 )  ( @xmath782 ) ; ( @xmath783 )  ( @xmath784 ) ; iin 0, ... ,3 ( @xmath785 ) ",
    "( @xmath786 ) ; ( @xmath787 )  ( @xmath788 ) ; ( @xmath789 )  ( @xmath790 ) ; ( @xmath789 )  ( @xmath791 ) ; ( @xmath789 )  ( @xmath792 ) ; ( e ) at ( -0.015,0 ) ; ( @xmath793 )  ( @xmath794 ) ; ( @xmath795 )  ( @xmath796 ) ;    at ( @xmath797 ) @xmath798 ; at ( @xmath799 ) @xmath800 ; at ( @xmath801 ) @xmath800 ; at ( @xmath802 ) @xmath803 ; at ( @xmath804 ) @xmath803 ; at ( @xmath805 ) @xmath21 ; at ( @xmath806 ) @xmath21 ; at ( @xmath807 ) @xmath21 ; at ( @xmath808 ) @xmath21 ; at ( @xmath809 ) @xmath810 ; at ( @xmath811 ) @xmath810 ; at ( @xmath812 ) @xmath800 ; at ( @xmath813 ) @xmath803 ;    since sturmian words of type b differ from sturmian words of type a essentially only by the fact that the sequence of maximal solutions is finite , it is in this proof enough to consider the case that @xmath1 is of type a.    says that @xmath704 is always a suffix of @xmath736 for all @xmath217 .",
    "since @xmath814 , it follows that the word @xmath815 has the word @xmath704 as a prefix",
    ". therefore @xmath816 .",
    "it remains to prove that the first occurrence of @xmath699 in @xmath1 is at position @xmath700 of @xmath1 for all @xmath217 .",
    "it is clear that the first occurrence of @xmath817 is at position @xmath818 .",
    "assume that @xmath738 , and suppose for a contradiction that @xmath699 occurs before the position @xmath700 . since @xmath704 is a prefix of @xmath699 , by induction we see that @xmath699 can not occur before the position @xmath819 .",
    "this means that an occurrence of @xmath820 begins in @xmath1 at position @xmath163 such that @xmath821 ; see .",
    "observe that @xmath1 has at position @xmath822 an occurrence of @xmath823 .",
    "write now @xmath824 with @xmath825 . since @xmath21 is primitive",
    ", we must have that @xmath826 with @xmath827 .",
    "thus @xmath803 occurs in @xmath1 at position @xmath828 . since @xmath829",
    ", it follows that either @xmath21 is a prefix of @xmath803 or @xmath803 is a prefix of @xmath21 .",
    "suppose first that @xmath21 is a prefix of @xmath803 .",
    "if @xmath830 , then the prefix @xmath831 of @xmath1 is followed by @xmath23 . now @xmath832 is a solution to implying that @xmath800 is not a maximal solution to .",
    "since this is contradictory , we infer that @xmath833 .",
    "since @xmath803 occurs at position @xmath834 and @xmath803 has @xmath21 as a prefix , it must be that @xmath803 begins with @xmath835 where @xmath836 is the first letter of @xmath21 .",
    "since @xmath21 is right special and @xmath22 , it follows that @xmath837 begins with @xmath23 .",
    "like above , this implies that @xmath800 is not maximal .",
    "this is a contradiction .",
    "suppose then that @xmath803 is a proper prefix of @xmath21 .",
    "first of all , @xmath803 must be primitive , as otherwise @xmath803 and consequently @xmath21 would have as a prefix a square of some word in @xmath669 contradicting .",
    "the assumption that @xmath803 is a prefix of @xmath21 implies that @xmath803 and @xmath21 begin with the same letter .",
    "like above , since @xmath21 is right special and @xmath22 , it must be that @xmath21 occurs after the prefix @xmath736 of @xmath1 . since also @xmath837 occurs after the prefix @xmath736 , by we",
    "conclude that the word @xmath21 must be a proper prefix of @xmath837 .",
    "observe now that the assumption that @xmath803 is a proper prefix of @xmath21 excludes the possibilities that @xmath838 or @xmath839 .",
    "therefore @xmath840 for some @xmath841 with @xmath842 .",
    "because @xmath843 , we must have that @xmath844 . on the other hand , since @xmath845 and @xmath803 and @xmath21 begin with the same letter , the only option is that @xmath846 with @xmath847 .",
    "now @xmath848 so as @xmath21 is a prefix of @xmath837 , it must be that @xmath849 .",
    "this is a contradiction .",
    "this final contradiction ends the proof .    as a conclusion of this section",
    ", we study the lengths of the maximal solutions of .",
    "namely , let @xmath688 be a sturmian word of type a factorized as a product of maximal solutions @xmath411 .",
    "computer experiments suggest that typically the sequence @xmath850 is strictly increasing",
    ". however , there are examples where @xmath851 for some @xmath852 .",
    "it is natural to ask if the lengths can decrease significantly or if oscillation is possible .",
    "it turns out that neither is possible . in",
    "we prove that @xmath853 .",
    "first we need a result on certain periods of ( semi)standard words .",
    "[ lem : standard_periods ] let @xmath854 and @xmath855 . if @xmath52 is a prefix of some word in @xmath856 , then @xmath857 and @xmath858 for some @xmath114 with @xmath139 .",
    "suppose that @xmath52 is a prefix of some word in @xmath856 .",
    "if @xmath859 , then necessarily @xmath860 .",
    "then obviously @xmath52 is not a prefix of any word in @xmath856 .",
    "therefore @xmath857 for some @xmath114 with @xmath139 .",
    "suppose that @xmath861 .",
    "then @xmath862 .",
    "it is straightforward to show that @xmath75 must equal to @xmath863 ; @xmath52 can not be a prefix of a word in @xmath856 if @xmath860 or @xmath864 for some @xmath865 such that @xmath847 .",
    "thus we may assume that @xmath866 .",
    "suppose first that @xmath867 . then by the assumption @xmath855",
    ", it must be that @xmath868 for some @xmath865 such that @xmath869 . since @xmath52 is a prefix of some word in @xmath856",
    ", it follows that the word @xmath870 is a prefix of some word in @xmath871 .",
    "since the word @xmath21 begins with @xmath872 , we obtain that @xmath873 begins with @xmath872 , so @xmath874 .",
    "this is a contradiction .",
    "assume then that @xmath875 .",
    "now the prefix @xmath202 of @xmath52 is a prefix of some word in @xmath856 , so by induction @xmath876 .",
    "now @xmath877 , so as @xmath52 is a prefix of some word in @xmath856 , it follows that @xmath878 is a prefix of some word in @xmath856 .",
    "this means that @xmath372 ends with a prefix of @xmath879 of length @xmath880 .",
    "as the prefix of @xmath879 of length @xmath880 is @xmath881 , the word @xmath372 ends with @xmath881 .",
    "consequently @xmath882 ; a contradiction .",
    "the only remaining option is that @xmath858 .",
    "this is certainly possible .",
    "the next proposition describes precisely under which conditions it is possible that @xmath851 .",
    "moreover , it rules out the possibility that the lengths decrease significantly or oscillate .",
    "[ prp : next_shorter ] let @xmath2 be a sturmian word of type @xmath30 with slope @xmath0 factorized as a product of maximal solutions @xmath411 . if @xmath883 , then @xmath884 for some @xmath114 with @xmath885 , the primitive root of @xmath292 is @xmath577 , and @xmath886 .",
    "assume that @xmath883 .",
    "let us first make the additional assumption that @xmath287 is primitive . in particular , @xmath887 .",
    "let @xmath52 be the primitive root of @xmath292",
    ". then @xmath656 and , moreover , by the assumption @xmath883 it holds that @xmath888 .",
    "by the word @xmath889 is a suffix of the word @xmath890 .",
    "therefore @xmath287 is a proper suffix of @xmath891 , so @xmath892 for some nonempty word @xmath443 .",
    "a standard argument shows that @xmath287 is a suffix of some word in @xmath893 ( see e.g. , ( * ? ? ?",
    "* proposition  1.3.4 ) ) .",
    "consequently , @xmath894 is a prefix of a word in @xmath895 . as @xmath888",
    ", implies that that @xmath884 and @xmath896 for some @xmath114 with @xmath139 .",
    "suppose now that @xmath897",
    ". then the word @xmath515 contains @xmath898 as a factor .",
    "thus @xmath899 .",
    "as @xmath202 is a prefix of @xmath900 , it follows that @xmath901 contradicting",
    ". therefore @xmath902 .",
    "let us then relax the assumption that @xmath287 is primitive . let @xmath75 be the primitive root of @xmath287 , so that @xmath903 for some @xmath85 .",
    "consider now the sturmian word @xmath904 . by the above arguments @xmath905 for some @xmath114 with @xmath885 and the primitive root of @xmath292",
    "is @xmath577 .",
    "further , as @xmath906 , it follows from that @xmath907 .",
    "thus @xmath908 , that is , @xmath884 .",
    "it remains to show that @xmath886 .",
    "assume for a contradiction that @xmath909 .",
    "it is not possible that @xmath910 as the preceding arguments show that then @xmath292 must be reversed semistandard word ; however , @xmath292 is a power of the reversed standard word @xmath577 .",
    "hence by the maximality of @xmath292 we have that @xmath911 .",
    "let @xmath912 with @xmath825 and @xmath556 .",
    "as @xmath913 , we have that @xmath914 .",
    "assume for a contradiction that @xmath915 .",
    "if @xmath21 is semistandard , then implies that @xmath916 , so @xmath917 can not hold .",
    "thus @xmath21 is standard . if @xmath838 , then clearly @xmath918 can not hold as the index of the factor @xmath134 in @xmath11 is @xmath919 .",
    "thus @xmath920 .",
    "suppose first that @xmath921 .",
    "now @xmath922 so @xmath923 .",
    "since @xmath924 , implies that @xmath925 . therefore @xmath926 implying that @xmath927 .",
    "however , if @xmath927 , then @xmath928 is odd , so actually @xmath929 .",
    "then @xmath930 , so @xmath931 ; a contradiction .",
    "suppose then that @xmath932 .",
    "now @xmath933 so @xmath934 .",
    "like previously , as @xmath924 , implies that @xmath935 .",
    "like above , we obtain that @xmath936 ; a contradiction .",
    "similar to above @xmath937 as @xmath938 , we conclude that @xmath939 .",
    "therefore by it is not possible that @xmath940 . in conclusion",
    ", it is not possible that @xmath917 .",
    "this is a contradiction .",
    "now @xmath941 ( by the maximality of @xmath292 it must be that @xmath942 ) . because @xmath943 , we have that @xmath944 for some @xmath865 such that @xmath945 . since @xmath906 , the word @xmath21 is semistandard so by we have that @xmath916 . by the word",
    "@xmath946 is a suffix of the word @xmath947 .",
    "it follows that @xmath948 where @xmath534 is such that @xmath949 .",
    "therefore the words @xmath950 and @xmath577 commute ; a contradiction .",
    "this final contradiction proves that @xmath886 .",
    "[ cor : solution_length_increasing ] let @xmath688 be a sturmian word of type @xmath30 with slope @xmath0 factorized as a product of maximal solutions @xmath411",
    ". then @xmath951 .",
    "this follows from : if @xmath952 for some @xmath852 , then @xmath953 .",
    "in this section we prove a formula for the square root of the fibonacci word . to do this we factorize the fibonacci word as a product of maximal solutions to .",
    "we denote by @xmath954 the slope of the fibonacci word , that is , @xmath955 $ ] .",
    "further , we set @xmath956 we need two lemmas specific to the slope @xmath954 .",
    "[ lem : fibonacci_formula1 ] for the standard words of slope @xmath954 it holds that @xmath957 for all @xmath217 .",
    "the case @xmath958 is verified directly : @xmath959 .",
    "let then @xmath109 .",
    "there exists a palindrome @xmath960 such that @xmath961 for all @xmath109 ( see e.g. ( * ? ? ?",
    "* lemma  2.2.8 ) ) .",
    "now @xmath962 which proves the claim .",
    "[ lem : fibonacci_formula2 ] for the standard words of slope @xmath954 it holds that @xmath963 for all @xmath217 .",
    "if @xmath958 , then @xmath964 .",
    "let then @xmath109 .",
    "now @xmath965 where the last equality follows by induction . by applying we",
    "obtain that @xmath966 which proves the claim .    as an immediate corollary to we obtain a formula for the square root of the fibonacci word .",
    "[ thm : fibonacci_square_root ] for slope @xmath954 we have that @xmath967    the preceding arguments are very specific to the fibonacci word .",
    "the reader might wonder if formulas for the square roots of other standard sturmian words exist .",
    "surely , for some specific words such formulas can be derived , but we believe no general factorization for the square roots of standard sturmian words can be given .",
    "let us give some arguments supporting our belief .",
    "let @xmath688 be a standard sturmian word of slope @xmath0 factorized as a product of maximal solutions to .",
    "the word @xmath1 begins with the word @xmath968 . therefore if @xmath969 , then @xmath970 .",
    "thus if @xmath969 , then @xmath292 begins with @xmath134 if and only if @xmath102 is odd .",
    "because of the asymmetry of the letters @xmath134 and @xmath159 in the minimal squares of slope @xmath0 , the parity of the parameter @xmath102 greatly influences the remaining words @xmath411 .",
    "moreover , it is not just the partial quotient @xmath971 which influences the factorization .",
    "suppose for instance that @xmath972 and @xmath273 . shows how the values of the partial quotients @xmath973 and @xmath974 affect the words @xmath411 .",
    "the cell of the table tells to which squares of reversed standard words the words @xmath975 and @xmath976 correspond to .",
    "for example if @xmath977 and @xmath978 , then the standard sturmian word of slope @xmath979 $ ] begins with @xmath980 . tells the first letter of the corresponding word @xmath981 . as can be observed from , the first letter of @xmath981 varies when @xmath973 and @xmath974 vary .",
    "because of the asymmetry , it is thus expected that slight variation in partial quotients drastically changes the factorization as a product of maximal solutions to . since similar behavior is expected from the rest of the partial quotients , it seems to us that no nice formula ( like e.g. , the formula of ) can be given for the square root of a standard sturmian word in terms of reversed standard words .    .how",
    "@xmath287 , @xmath292 , and @xmath976 are affected when @xmath973 and @xmath974 vary in the case that @xmath972 and @xmath273 . [ cols=\"<,<,<,<\",options=\"header \" , ]     de luca and fici proved a nice formula for a certain shift of a standard sturmian word ( * ? ? ?",
    "* theorem  18 ) .",
    "let @xmath18 be the standard sturmian word of slope @xmath982 $ ] .",
    "then @xmath983    as a corollary of this theorem we obtain that the word @xmath984 is a sturmian word of slope @xmath0 with intercept @xmath985 . we have thus shown that @xmath986 in particular , we obtain the well - known result that the fibonacci infinite word is a product of the reversed fibonacci words .",
    "in this section we construct a family of linearly recurrent and optimal squareful words which are not sturmian but are fixed points of the ( more general ) square root map .",
    "moreover , we show that any subshift @xmath7 generated by such a word has a curious property : for every @xmath8 either @xmath9 or @xmath10 is periodic .",
    "it is evident from that sturmian words are a proper subclass of optimal squareful words .",
    "as sturmian words have the exceptional property that their language is preserved under the square root map , it is natural to ask if other optimal squareful words can have this property .",
    "we show that , indeed , such words exist by an explicit construction .",
    "the idea behind the construction is to mimic the structure of the sturmian words @xmath16 and @xmath17 .",
    "the simple reason why these words are fixed points of the square root map ( thus preserving the language ) is that they have arbitrarily long squares of solutions to as prefixes .",
    "thus to obtain a fixed point of the square root map , it is sufficient to find a sequence @xmath987 of solutions to with the property that @xmath988 is a proper prefix of @xmath989 for all @xmath109",
    ". let us show how such a sequence can be obtained .",
    "let @xmath990 be a fixed primitive solution to in the language of some sturmian word with slope @xmath991 $ ] such that @xmath992 .",
    "in particular , @xmath990 has the word @xmath500 as a proper suffix .",
    "recall from the proof of that @xmath993 .",
    "we denote the word @xmath994 simply by @xmath298 . using the word @xmath990 as a seed solution",
    ", we produce a sequence @xmath995 of primitive solutions to defined by the recurrence @xmath996 we need to prove that the sequence @xmath995 really is a sequence of primitive solutions to . before showing this ,",
    "let us define @xmath997 the limits exist as @xmath998 is always a prefix of @xmath999 .",
    "hence both @xmath1000 and @xmath1001 have arbitrarily long squares of words in the sequence @xmath995 as prefixes .",
    "observe also that @xmath1002 .",
    "as there is not much difference between @xmath1000 and @xmath1001 in terms of structure , we set @xmath29 to be either of these words .    taking for granted that the sequence @xmath995 is a sequence of solutions to , we see that @xmath1003 .",
    "note that we also need to ensure that the word @xmath29 is optimal squareful for the square root map to make sense .",
    "next we aim to prove the following .",
    "[ prp : gamma_solutions ] the word @xmath1004 is a primitive solution to in @xmath421 for all @xmath109 .",
    "recall from that the language @xmath421 consists of all factors of the infinite words in the language @xmath1005    before we can prove , we need to know that the words @xmath1004 are primitive and that they are factors of some optimal squareful word with parameters @xmath102 and @xmath103 .",
    "[ lem : gamma_primitive ] the word @xmath1004 is primitive for all @xmath109 .",
    "we proceed by induction . by definition @xmath1006",
    "is primitive .",
    "let @xmath109 , and suppose for a contradiction that @xmath1007 is not primitive ; that is , @xmath1008 for some primitive word @xmath372 and @xmath509 . if @xmath1009 , then obviously @xmath1010 must be even , and the suffix of @xmath1004 of length @xmath1011 must be a prefix of @xmath1004 .",
    "this contradicts the primitivity of @xmath1004 .",
    "the case @xmath1012 would clearly imply that @xmath1013 , which is not possible .",
    "hence @xmath1014 , and further @xmath1015 .",
    "as @xmath998 is a suffix of some word in @xmath1016 , it follows that @xmath1017 where @xmath1018 is a suffix of @xmath1004 . on the other hand",
    ", @xmath372 is a suffix of @xmath1004 , so @xmath1019 .",
    "since @xmath372 is primitive , the only option is that @xmath52 is empty .",
    "therefore @xmath1020 ; a contradiction with the primitivity of @xmath1004 .",
    "[ lem : gamma_optimal_squareful ] we have that @xmath1021 for all @xmath109 .    for a suitable slope",
    "@xmath1022 $ ] , either of the words @xmath990 and @xmath298 is a reversed standard word of slope @xmath0 .",
    "thus by both @xmath1023 and @xmath1024 are in @xmath11 , so @xmath1025 .",
    "we clearly have that @xmath1026 .",
    "note that by the assumption @xmath992 both of the words @xmath990 and @xmath298 have the word @xmath1027 as a proper suffix .",
    "write @xmath1028 . since @xmath1 begins with @xmath462 and @xmath1023",
    "has @xmath1029 as a suffix , it follows that @xmath1030 . using the fact that @xmath1031",
    ", we see that @xmath1032 .",
    "clearly @xmath1033 .",
    "proceeding by induction we may assume that @xmath114 and @xmath1021 .",
    "since @xmath1004 has either @xmath990 or @xmath298 as a prefix , it can be written that @xmath1034 with @xmath1035 .",
    "it follows that @xmath1036 . since @xmath1037 is a suffix of either @xmath1023 or @xmath1024 , we have that @xmath1038",
    ". therefore @xmath1039 . as @xmath1040",
    ", we have that @xmath1041 is a suffix of some word in @xmath1042 .",
    "overall , the word @xmath1043 is in @xmath421 .",
    "clearly then must the word @xmath1044 also be in @xmath421 .",
    "note that without the assumption @xmath992 the conclusion of the above lemma fails to hold .",
    "if @xmath1045 , then @xmath1046 and @xmath1047 . therefore @xmath1048 , and consequently @xmath1049 .",
    "we proceed by induction . by the word",
    "@xmath1004 is primitive for all @xmath109 .",
    "tells that both of the words @xmath1004 and @xmath1050 are in @xmath421 for all @xmath109 . by definition both @xmath1006 and @xmath1051 are solutions to .",
    "we may thus assume that @xmath109 and both @xmath1004 and @xmath1050 are solutions to .",
    "it follows from that @xmath1052 since @xmath1050 is a solution to , also implies that @xmath1053 because @xmath1054 we obtain that @xmath1055 this proves that @xmath1007 is a solution to .",
    "consider next the word @xmath1056 . because @xmath1057 , it is evident that @xmath1058 therefore also @xmath1059 is a solution to .",
    "the conclusion follows .    as we remarked earlier , we have now proved that @xmath29 is a fixed point of the square root map .",
    "next we show that the word @xmath29 is aperiodic , linearly recurrent , and not sturmian .",
    "[ lem : gamma_not_sturmian ] the word @xmath1060 is not a factor of any sturmian word .    by definition @xmath1061 .",
    "write @xmath1062 and @xmath1063 for some word @xmath21 and distinct letters @xmath13 and @xmath178",
    ". now @xmath1064 , so the word @xmath1060 has factors @xmath1065 and @xmath1066 .",
    "hence @xmath1060 is not balanced , and it can not be a factor of any sturmian word .    [",
    "lem : gamma_linearly_recurrent ] the word @xmath29 is aperiodic and linearly recurrent .    the recurrence and the definition of @xmath29 show that for all @xmath109 the word @xmath29 is a product of the words @xmath1067 and @xmath1056 such that between two occurrences of @xmath1059 there is always @xmath998 or @xmath1068 . from this",
    "it follows that the return time of a factor of @xmath29 of length @xmath1004 is at most the return time of the factor @xmath1050 , which is at most @xmath1069 .",
    "let then @xmath21 be a factor of @xmath29 such that @xmath1070 .",
    "since @xmath21 is a factor of some factor of @xmath29 of length @xmath1071 , it follows that the return time of @xmath21 is at most @xmath1072 . now @xmath1073 proving that @xmath29 is linearly recurrent .",
    "the preceding shows that @xmath1004 is followed in @xmath1074 by both @xmath1004 and @xmath1050 .",
    "as the first letters of @xmath1004 and @xmath1050 are distinct , the factor @xmath1004 is right special .",
    "thus @xmath1074 contains arbitrarily long right special factors , so @xmath29 must be aperiodic .",
    "since linearly recurrent words have linear factor complexity ( * ? ? ?",
    "* theorem  24 ) , it follows from that @xmath29 has linear factor complexity .",
    "we observed in the previous proof that the word @xmath29 is a product of the words @xmath990 and @xmath298 such that between two occurrences of @xmath298 in this product there is always @xmath1023 or @xmath1075 . since @xmath990 and @xmath298 are primitive , any word @xmath1076 which is a product of the words @xmath990 and @xmath298 such that @xmath1077 must synchronize to the factorization of @xmath29 as a product of the words @xmath990 and @xmath298 . that is , for any factorization @xmath1078 we must have that @xmath1079 is a multiple of @xmath1080 .",
    "the word @xmath29 is a non - sturmian , linearly recurrent optimal squareful word which is a fixed point of the square root map .",
    "the fact that @xmath29 is optimal squareful and linearly recurrent follows from lemmas [ lem : gamma_optimal_squareful ] and [ lem : gamma_linearly_recurrent ] .",
    "the argument outlined at the beginning of this section shows that @xmath29 is a fixed point of the square root map as by the words @xmath1004 which occur as square prefixes in @xmath29 are solutions to .",
    "finally , @xmath29 contains the factor @xmath1060 , so @xmath29 is not sturmian by .",
    "denote by @xmath7 the subshift consisting of the infinite words having language @xmath1074 . as @xmath29 is linearly recurrent ,",
    "it is uniformly recurrent , so the subshift @xmath7 is minimal .",
    "the rest of this section is devoted to proving the result mentioned in the beginning of this section .",
    "[ thm : preserved_periodic ] for all @xmath8 either @xmath9 or @xmath10 is ( purely ) periodic with minimal period conjugate to @xmath990 .",
    "moreover , there exists words @xmath1081 such that @xmath1082 and @xmath1083 is periodic .",
    "this result is very surprising since it is contrary to the plausible hypothesis that an aperiodic word must map to an aperiodic word under the square root map .",
    "it is not difficult to prove for words in @xmath7 which are products of the words @xmath990 and @xmath298 .",
    "we prove this special case next in .",
    "however , difficulties arise since a word in @xmath7 can start in an arbitrary position of an infinite product of @xmath990 and @xmath298",
    ". there are certain well - behaved positions in @xmath990 and @xmath298 which are easier to handle .",
    "is proved for these special positions in .",
    "the rest of the effort is in demonstrating that all the other cases can be reduced to these well - behaved cases .",
    "we begin by proving the easier cases , and we conclude with the reductions .    [",
    "lem : product_sl_preserved ] if a word @xmath8 can be written as a product of the words @xmath990 and @xmath298 , then @xmath9 .",
    "any word @xmath52 which is a product of the words @xmath990 and @xmath298 can be naturally written as a binary word @xmath1084 over the alphabet @xmath1085 .",
    "if such a word @xmath1084 has even length , then it is a word over the alphabet @xmath1086 .",
    "using the fact that @xmath1087 , @xmath1088 , @xmath1089 , and @xmath1090 ( see ) , we can define a square root for a word over @xmath30 .",
    "the word @xmath998 is a prefix of @xmath29 for all @xmath109 .",
    "thus @xmath1004 has occurrences at positions @xmath134 and @xmath1010 of @xmath29 .",
    "clearly @xmath1091 , so the word @xmath1092 occurs in @xmath1093 in an even and in an odd position .",
    "let @xmath75 be a prefix of @xmath21 of length @xmath1094 for some @xmath73 , so @xmath1095 is a word over @xmath30 .",
    "since @xmath75 is a prefix of @xmath21 , the word @xmath75 is a factor of some @xmath1004 .",
    "since @xmath1092 occurs in @xmath1093 in an even and in an odd position , the word @xmath1095 occurs in an even position in @xmath1093 .",
    "hence @xmath1093 can be factored as @xmath1096 where @xmath372 and @xmath1097 are finite or infinite words over @xmath30 . since @xmath29 is a fixed point of the square root map ,",
    "we have that @xmath1098 .",
    "hence @xmath1099 .",
    "it follows that @xmath1100 , so @xmath9 .",
    "let @xmath21 be a word and @xmath562 be an integer such that @xmath1101 . if the factor of @xmath1102 of length @xmath1103 starting at position @xmath562 can be written as a product of minimal squares @xmath1104 , then we say that the position @xmath562 of @xmath21 is _",
    "repetitive_. if in addition @xmath1105 for all @xmath155 such that @xmath1106 , then we say that the position @xmath562 is _",
    "nicely repetitive_.    for example if @xmath1107 , @xmath1108 , and @xmath1109 , then the position @xmath159 of @xmath990 is repetitive as the factor @xmath1110 of @xmath1111 of length @xmath1112 starting at position @xmath159 is in @xmath425 .",
    "this position is not nicely repetitive as @xmath1113 .",
    "the position @xmath229 of @xmath990 , however , can be checked to be nicely repetitive .",
    "the position @xmath1114 of @xmath990 is not repetitive as the factor @xmath1115 of length @xmath1116 starting at position @xmath1114 is not in @xmath425 .    in the upcoming proof of we will show that if @xmath8 is a product of the words @xmath990 and @xmath298 and @xmath562 is a nicely repetitive position of @xmath990 , then the word @xmath1117 is always periodic . on the other hand , we show that if @xmath562 is not a nicely repetitive position then @xmath1117 is always in @xmath7 .",
    "next we identify some good positions in the suffix @xmath429 of @xmath990 . as we observed in the proof of",
    ", the suffix @xmath429 of @xmath990 restricts locally how a factorization of a word as a product of minimal squares continues after an occurrence of @xmath429 .",
    "consider a product @xmath20 of minimal squares which has an occurrence of @xmath429 at position @xmath562 .",
    "then for some @xmath1118 the minimal square @xmath1119 must begin at some of the positions @xmath1120 .",
    "otherwise some minimal square would have @xmath429 as an interior factor ; yet no such minimal square exists . among the positions @xmath1120 we are interested in the largest position where a minimal square may begin",
    "let @xmath1121 it is straightforward to see that @xmath1122 we are interested in those positions of the suffix @xmath429 of @xmath990 where no minimal square begins . hence we define @xmath1123 a consequence of the definitions is that if @xmath562 is a position of @xmath990 such that @xmath1124 , then there exists @xmath1125 such that @xmath1126 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] .",
    "this fact is used later several times .",
    "[ lem : periodic_image ] suppose that @xmath8 can be written as a product of the words @xmath990 and @xmath298 .",
    "assume that the position @xmath1127 is nicely repetitive .",
    "let the prefix of @xmath1128 of length @xmath1129 be factorized as a product of minimal squares @xmath20 .",
    "then the word @xmath1117 is periodic with minimal period @xmath1130 .",
    "moreover , @xmath1130 is conjugate to @xmath990 .",
    "as @xmath562 is repetitive , the factor @xmath52 of length @xmath1129 of @xmath1111 starting at position @xmath562 is in @xmath425 . if we substitute the middle @xmath990 in @xmath1111 with @xmath298 , then an application of shows that the factor of length @xmath1129 of @xmath1131 starting at position @xmath562 is still in @xmath425 and that the square root of this factor coincides with the square root of @xmath52 ( here we need that @xmath1127 ) .",
    "further analysis shows that if we substitute the words @xmath990 in @xmath1111 in any way , then the square root of the factor of length @xmath1129 beginning at position @xmath562 is unaffected .",
    "since @xmath562 is repetitive , the prefix of @xmath1132 of length @xmath1129 is again in @xmath425 and has the same square root , and so on .",
    "thus @xmath1117 is periodic . since",
    "both the square of the period and @xmath1023 occur in a suitable sturmian word ; having equals lengths , they must be conjugate by .",
    "we have that @xmath1133 , so @xmath576 .",
    "let @xmath52 be the suffix of @xmath990 of length @xmath1134 .",
    "since @xmath562 is repetitive , the factor @xmath75 of @xmath1111 of length @xmath1129 starting at position @xmath562 can be factorized as a product of minimal squares @xmath553 .",
    "we have that @xmath1135 because @xmath1127 .",
    "next we consider how the situation changes if any of the words @xmath990 in @xmath1111 is substituted with @xmath298 .",
    "substituting the first @xmath990 with @xmath298 does not affect the product as @xmath576 .",
    "suppose then that the second word @xmath990 is substituted with @xmath298 . by applying to the words @xmath52 and",
    "@xmath990 with @xmath1136 , we see that the factor of length @xmath1129 of @xmath1131 starting at position @xmath562 can still be factorized as a product of minimal squares and that the square root of this factor coincides with the square root of @xmath75 .",
    "consider next what happens when the third word @xmath990 is substituted with @xmath298 .",
    "let @xmath1137 set @xmath1138 . since @xmath562 is nicely repetitive ,",
    "we have that @xmath1139 . by the maximality of @xmath534 and the definition of the set @xmath1140 , we thus have that @xmath1141 .",
    "applying to the suffix of @xmath990 of length @xmath1142 and @xmath990 with @xmath1143 we obtain , like above , that the product of minimal squares is affected but the square root is not . substituting the second and third words @xmath990 with @xmath298",
    "gives the same result : first proceed as above and substitute the second word @xmath990 and then make the second substitution like above but apply for the word @xmath298 instead of @xmath990 .",
    "we have concluded that however we substitute the words @xmath990 in @xmath1111 , the square root of the factor of length @xmath1129 beginning at position @xmath562 never changes .",
    "the word @xmath21 is obtained from the word @xmath1144 by substituting some of the words @xmath990 with @xmath298 . by the preceding",
    ", the prefix of @xmath1128 of length @xmath1129 can be factorized as a product of minimal squares @xmath20 .",
    "since @xmath562 is repetitive , the prefix of @xmath1132 of length @xmath1129 can also be factorized as a product of some minimal squares ( perhaps different ) but the square root still equals @xmath1130 . by repeating this observation",
    "we see that @xmath1145    by our choice of @xmath990 we have that @xmath1146 where @xmath1147 is a reversed standard word of some slope @xmath1022 $ ] .",
    "let @xmath1148 $ ] be a number such that @xmath1149 for @xmath1150 and @xmath1151 . then by the definition of standard words @xmath1152 . by the preceding , the prefix of @xmath1153 of length @xmath1154 can be written as a product of minimal squares , and the square root of these minimal squares equals @xmath1155 .",
    "since the square root of a sturmian word of slope @xmath592 is a sturmian word of slope @xmath592 , we have that @xmath1156 . as @xmath1157",
    ", it follows by that @xmath1130 is conjugate to @xmath990 .",
    "since @xmath990 is primitive , so is @xmath1130 , and hence the period @xmath1130 is minimal .",
    "[ lem : one_nicely_repetitive ] every seed solution @xmath990 has at least one nicely repetitive position @xmath562 such that @xmath1127 .",
    "suppose that @xmath1158 for some @xmath568 and @xmath1159 .",
    "it is sufficient to show that @xmath1160 is a nicely repetitive position of @xmath990 . if @xmath1161 , then there exists @xmath1162 such that @xmath1163 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] . since the position @xmath534 is nicely repetitive , so must",
    "@xmath1164 be .",
    "if @xmath1165 , then as @xmath1166 , an application of shows that the conclusion holds also in this case .    observe that the word @xmath1167 is both a prefix and a suffix of @xmath990 .",
    "using the fact that @xmath1168 we obtain that @xmath1169 by the word @xmath1170 is in @xmath425 .",
    "since @xmath1167 is a solution to , we have that @xmath1171 .",
    "overall , the factor @xmath1172 of @xmath1111 of length @xmath1129 starting at position @xmath534 is in @xmath425 .",
    "thus the position @xmath534 of @xmath990 is repetitive .",
    "suppose for a contradiction that the suffix of @xmath990 of length @xmath1173 is in @xmath425 , that is , @xmath1174 for some minimal square roots @xmath1175 .",
    "it follows that @xmath1176 .",
    "since @xmath202 is a solution to , it follows that @xmath1177 .",
    "this contradicts the primitivity of @xmath202",
    ". similarly if the suffix of @xmath1023 of length @xmath1178 is in @xmath425 , then @xmath1179 contradicting the primitivity of @xmath1167 .",
    "we conclude that the position @xmath534 is nicely repetitive .    and now imply the following :    there exist uncountably many linearly recurrent optimal squareful words having ( purely ) periodic square root .",
    "we only need to show that there are uncountably many such words .",
    "consider the words in @xmath7 which can be written as a product of the words @xmath990 and @xmath298 .",
    "viewed over the binary alphabet @xmath1085 , these words form an infinite subshift @xmath1180 .",
    "let us show that @xmath1180 is minimal .",
    "then the conclusion follows by well - known arguments from topology : a minimal subshift is always finite or uncountable and an aperiodic subshift can not be finite ( use the fact that a perfect set is always uncountable ) .",
    "let @xmath1181 ( we use the notation of the proof of ) .",
    "let @xmath1182 be a factor such that @xmath1183 .",
    "as @xmath1184 , every occurrence of @xmath52 in @xmath29 must synchronize to the factorization of @xmath29 as a product of @xmath990 and @xmath298 .",
    "it follows that every return to @xmath52 in @xmath29 is a product of @xmath990 and @xmath298 .",
    "since the return time of @xmath52 is finite in @xmath29 , the return time of the word @xmath1084 in @xmath1185 is also finite .",
    "hence @xmath1180 is minimal .",
    "we also prove the following weaker result , which we need later .",
    "[ lem : nicely_repetitive_position ] the position @xmath1186 of @xmath990 is repetitive .    we prove first by induction that the prefix of the word @xmath1187 of length @xmath1188 is a product of minimal squares for @xmath114 and @xmath562 such that @xmath139 .",
    "let us first establish the base cases .",
    "recall that @xmath1189 and @xmath574 .",
    "we have that @xmath1190 in addition , for @xmath1191 , we have that @xmath1192 the case @xmath573 is clear .",
    "so let us assume that @xmath576 .",
    "we have that @xmath1193 so it is sufficient to show that the word @xmath1194 is in @xmath425 .",
    "suppose first that @xmath1195 is even .",
    "then as @xmath1196 is a solution to , it is enough to show that @xmath1197 . since @xmath1198 , we have that @xmath1199 now @xmath1200 . the word @xmath1201 is a solution to , so the conclusion follows as @xmath1195 is even .",
    "suppose next that @xmath1195 is odd .",
    "we need to show that @xmath1202 . using the facts @xmath1198 and @xmath1200 we obtain that @xmath1203 by the word @xmath1204 is a product of minimal squares . since @xmath1195 is odd and @xmath1201 is a solution to , the conclusion follows .",
    "we have established the base cases .",
    "now for @xmath1205 and @xmath139 , we have that @xmath1206 by induction @xmath1207 and @xmath1208 for some minimal square roots @xmath1209 .",
    "therefore @xmath1210 we have thus proved that the prefix of the word @xmath1187 of length @xmath1188 is a product of minimal squares for @xmath114 and @xmath562 such that @xmath139 .    now if @xmath1211 for some @xmath114 and @xmath562 such that @xmath139 , then the claim is clear by the above .",
    "suppose that @xmath1212 .",
    "now if @xmath1213 , then two applications of ( first with @xmath1214 , @xmath1215 and then with @xmath1216 , @xmath1217 ) show that the claim holds .",
    "assume that @xmath1218 .",
    "since the prefix of @xmath1219 of length @xmath1220 is in @xmath425 , this means that the prefix of @xmath625 of length @xmath1221 is in @xmath425 .",
    "it is sufficient to show that the prefixes of @xmath625 and @xmath1222 of length @xmath1223 are in @xmath425 . since @xmath1198",
    ", the word @xmath1224 has @xmath1204 as a prefix .",
    "if @xmath1225 , then the word @xmath1226 has @xmath1227 as a prefix .",
    "finally if @xmath1228 , then the word @xmath1229 has @xmath1230 as a prefix .",
    "shows that @xmath1204 , @xmath1227 , and @xmath1230 are all in @xmath1231 .",
    "the conclusion follows .",
    "there is no clear pattern for other positions in @xmath1140 ; it depends on the word @xmath990 if a position in @xmath1140 is repetitive or not .",
    "the position @xmath1186 is not always nicely repetitive .",
    "suppose that @xmath237 , @xmath238 , and @xmath1232 .",
    "then the factor beginning at position @xmath1233 of @xmath1111 of length @xmath1129 is a product of minimal squares : @xmath1234 . as @xmath1235 ,",
    "the position @xmath96 is not nicely repetitive .    since none of the minimal squares can be a proper prefix of another minimal square ,",
    "it is easy to factorize words as products of minimal squares from left to right .",
    "next we consider what happens if we start to backtrack from a given position to the left .",
    "[ lem : backtracking ] let @xmath1236 be minimal square roots .",
    "let @xmath21 be a word having both of the words @xmath434 and @xmath439 as suffixes .",
    "if @xmath1237 , then @xmath1238 and the word @xmath1239 is a suffix of @xmath746 .",
    "suppose that @xmath1237 .",
    "we may assume that @xmath40 is as large as possible .",
    "we prove the lemma by considering different options for the word @xmath746 .",
    "clearly we can not have that @xmath1240 .",
    "let @xmath1241 .",
    "now @xmath434 can have a proper minimal square suffix only if @xmath1242 . if @xmath102 is even",
    ", then we must have that @xmath1243 the suffix @xmath1244 of @xmath21 can not be preceded by @xmath1245 as otherwise @xmath21 would have @xmath1246 as a suffix ; this is not possible as @xmath1247 .",
    "therefore there is no choice for @xmath1248 .",
    "thus @xmath1249 and @xmath1239 is a suffix of @xmath746 .",
    "if @xmath102 is odd , then similarly @xmath1250 again there is no choice for @xmath1251 , and the conclusion holds .",
    "similar considerations show that the conclusion holds if @xmath1252 .",
    "let then @xmath1253 .",
    "it is obvious that now @xmath1254 .",
    "if @xmath1255 or @xmath1108 , then like above @xmath1256 and @xmath1239 is a suffix of @xmath746 .",
    "we may thus suppose that @xmath1257 .",
    "say @xmath1258 .",
    "then we must have @xmath1259 and @xmath1260 .",
    "like above , the remaining minimal square roots @xmath1261 with @xmath1262 must equal to @xmath1263 and there must be @xmath1264 of them . since there is no further choice , the conclusion holds as clearly @xmath1239 is a suffix of @xmath746 .",
    "suppose then that @xmath1265 .",
    "the next case is @xmath1266 .",
    "assume first that @xmath103 is even .",
    "then it is straightforward to see that necessarily @xmath1267 thus @xmath1268 and , further , it must be that @xmath1269 like before , the remaining minimal squares @xmath1261 with @xmath1270 must equal to @xmath1263 and there must be @xmath1264 of them . therefore @xmath1271 is a suffix of @xmath746 , so the conclusion holds . if @xmath103 is odd , then in a similar fashion @xmath1272 so @xmath1273 and @xmath1274 again , the final @xmath1264 minimal square roots must equal @xmath1263 . since @xmath1275 is a suffix of @xmath746 , the conclusion holds .",
    "if @xmath1276 , then it is clear that @xmath1277 .",
    "the conclusion follows as in the case @xmath1253 .",
    "the next lemma is useful in the proof of .",
    "[ lem : can_not_continue ] let @xmath21 be an infinite product of the words @xmath990 and @xmath298 and @xmath1278 , @xmath1279 , @xmath1280 be positions of @xmath21 such that @xmath1281 .",
    "let @xmath534 be the largest integer such that @xmath1282 .",
    "if    * @xmath1283 , w[\\ell_2,\\ell_3 - 1 ] \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] , * @xmath1284 , and * @xmath1285 ,    then for all @xmath1286 such that @xmath1287 $ ] is a suffix of @xmath1288 $ ] we have that @xmath1289| < |w[\\ell_1,\\ell_3 - 1]|$ ] .",
    "let @xmath1290 $ ] and @xmath1291 $ ] .",
    "since @xmath1292 , we may write @xmath1293 and @xmath1294 for some minimal square roots @xmath411 and @xmath1261 . if @xmath1295 and @xmath1296 for all @xmath1297 , then as @xmath1298 , we must have that @xmath1299 .",
    "this means that the prefix @xmath285 of @xmath75 ends before the position @xmath1279 , that is , @xmath1300 .",
    "this contradicts the fact that @xmath1301 .",
    "therefore as @xmath1298 , we we conclude that there exists maximal @xmath1302 such that @xmath1303 .",
    "if @xmath1304 , then by the we have that @xmath1305 .",
    "this is not possible as @xmath1298 .",
    "therefore @xmath1306 .",
    "let @xmath1307 be such that @xmath1308 is a suffix of @xmath1288 $ ] .",
    "write @xmath1309 for minimal square roots @xmath1310 . applying the to the words @xmath1311 and @xmath1312 yields that @xmath1313 .",
    "it follows that @xmath1314 .",
    "finally we can give a proof of .",
    "let @xmath8 . since @xmath29 is uniformly recurrent and a product of the words @xmath990 and @xmath298 , there exists a word @xmath1315 such that @xmath1316 is a product of @xmath990 and @xmath298 and @xmath1317 for some @xmath562 such that @xmath1318 ( recall that a product of @xmath990 and @xmath298 occurring in @xmath29 having length at least @xmath1319 must synchronize to the factorization of @xmath29 as a product of @xmath990 and @xmath298 ) .",
    "if @xmath1320 , then the conclusion holds by , so we can assume that @xmath1321 .",
    "write @xmath21 as a product of minimal squares : @xmath1322 .",
    "let @xmath1323 if @xmath1324 , then set @xmath1325 .",
    "if @xmath1326 , then we set @xmath1327 . by the maximality of @xmath1328 and by the definition of the set @xmath1140 , it follows that @xmath1329 ( indeed , the word @xmath298 also has @xmath429 as a suffix ) .",
    "see .    to aid comprehension",
    "we have separated different parts of the proof as distinct claims with their own proofs .",
    "any new definitions and assumptions given in one of the subproofs are valid only up to the end of the subproof .    if @xmath1330 , then @xmath9 .",
    "suppose that @xmath1330 . by the definition of the number @xmath1328",
    ", we have that @xmath1324 and the word @xmath1331 is a product of the words @xmath990 and @xmath298 . now @xmath1332 where @xmath1333 . since @xmath1334 is a product of @xmath990 and @xmath298 , by @xmath1335 . by the choice of @xmath990 as a solution to and by , the first @xmath1129 letters of @xmath1334 can be written as a product of minimal squares . hence @xmath1336 for some minimal square roots @xmath1337 . by the",
    ", we have that @xmath1338 is a suffix of @xmath1239 .",
    "thus the word @xmath1339 is a suffix of the word @xmath1340 .",
    "therefore @xmath1341 , so @xmath9 .",
    "we assume that @xmath1342 .",
    "now either the position @xmath1278 of @xmath990 is nicely repetitive or it is not .",
    "[ cl : nicely_repetitive ] if @xmath1278 is a nicely repetitive position of @xmath990 , then @xmath10 is periodic with minimal period conjugate to @xmath990 .    by the word",
    "@xmath1343 is periodic with minimal period @xmath372 conjugate to @xmath990 .",
    "if @xmath1327 , then there is nothing more to prove , so assume that @xmath1344 .",
    "there exists @xmath1345 such that @xmath1346 .",
    "since @xmath1278 is a nicely repetitive position of @xmath990 , the prefix of @xmath1347 of length @xmath1129 is a product of minimal squares and its square root equals @xmath372 by . since the factor @xmath1348 $ ] is also a product of minimal squares , the implies that @xmath1349}$ ] is a suffix of @xmath372 .",
    "now @xmath1350}\\sqrt{t^{\\ell_1}(w')}$ ] , so @xmath10 is periodic with minimal period conjugate to @xmath990 .    if the position @xmath1278 of @xmath990 is not nicely repetitive , then either it is not repetitive or it is repetitive but not nicely repetitive .",
    "[ cl : repetitive_not_nicely ] if @xmath1278 is repetitive but not nicely repetitive position of @xmath990 , then @xmath9 .",
    "suppose that @xmath1278 is a repetitive but not a nicely repetitive position of @xmath990 .",
    "this means that either @xmath1351 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] or @xmath1352 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] ( they both can not be in @xmath425 as this would imply that @xmath990 is not primitive ) . thus either @xmath1353 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] or @xmath1354 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] ( in the latter case ensures that @xmath1354 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] ) .",
    "the former case is , however , not possible as it would contradict the maximality of @xmath1328 .",
    "thus only the latter option is possible .",
    "since @xmath1316 is a product of the words @xmath990 and @xmath298 , the prefix @xmath1355 $ ] of @xmath1316 is a product of minimal squares . since @xmath1348 , w'[\\ell_1,|s^2|-1 ] \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] , the implies that @xmath1356}$ ] is a suffix of @xmath1357}$ ] .",
    "thus @xmath10 is a suffix of @xmath1358 . as @xmath1359 by ,",
    "we conclude that @xmath9 .",
    "now we may suppose that @xmath1278 is not a repetitive position of @xmath990 .",
    "we let @xmath1360 the numbers @xmath1361 , @xmath1362 , and @xmath1363 are well - defined as the words @xmath990 and @xmath298 are not minimal squares .",
    "we set @xmath1364 intuitively , the positions @xmath1278 , @xmath1279 , @xmath1280 , and @xmath1365 are the successive positions of @xmath21 which are closest from the left to the boundaries of the words @xmath990 and @xmath298 in the factorization of @xmath1316 as a product of the words @xmath990 and @xmath298 such that the prefix up to the position is a product of minimal squares ; see . let @xmath1366 , @xmath1367 , @xmath1368 , and @xmath1369 .",
    "it is clear by the definitions that @xmath1370 for all @xmath1371 .",
    "we have that @xmath1372 . if @xmath1373 or @xmath1374 equals @xmath1080 , then @xmath9 .    by our assumption",
    "that @xmath1342 , we have that @xmath1375 .",
    "if @xmath1376 , then the factor @xmath1354 $ ] would be a product of minimal squares .",
    "this case was already considered in where we concluded that @xmath9 .",
    "suppose that @xmath1377 .",
    "consider the positions @xmath1278 and @xmath1080 of @xmath1316 . both of the factors @xmath1378 $ ] and @xmath1379 = w'[\\ell_3-|s^2|,\\ell_3 - 1]$ ] are in @xmath425 . now",
    "@xmath1332 for some @xmath1380 .",
    "since @xmath1381 , the prefix of @xmath1334 of length @xmath1129 is in @xmath425 . applied to the word @xmath1382 $ ] implies that @xmath1383| < |u| < |s^3|$ ] which is nonsense . therefore @xmath1384 .",
    "assume then that @xmath1385 .",
    "suppose for a contradiction that @xmath1386 .",
    "both of the factors @xmath1387 $ ] and @xmath1388 = w'[\\ell_4-|s^2|,\\ell_4 - 1]$ ] are in @xmath425 . since @xmath1386 , also @xmath1389 .",
    "thus by the definition of @xmath1279 , we have that @xmath1390",
    ". applied to the word @xmath1391 $ ] shows that @xmath1392| < |u'| < |s^3|$ ] which is absurd .",
    "this contradiction shows that @xmath1393 , so @xmath9 .",
    "we may now assume that @xmath1394 for all @xmath1371 .",
    "the position @xmath1373 of @xmath990 is nicely repetitive .",
    "assume on the contrary that neither of the positions @xmath1373 and @xmath1395 is a repetitive position of @xmath990 .",
    "first note that as @xmath1396 is not repetitive , we have that @xmath1397 .",
    "similarly @xmath1386 .",
    "if @xmath1398 , then it follows from and the definitions of the positions @xmath1399 and @xmath1400 that @xmath1401 ; a contradiction .",
    "hence @xmath1402 .",
    "similarly @xmath1403 as otherwise the position @xmath1373 would be repetitive .",
    "finally , @xmath1404 because @xmath1395 is not repetitive .",
    "we have two cases : either @xmath1405 or @xmath1406 .",
    "assume that @xmath1407 .",
    "by the position @xmath1186 of @xmath990 is repetitive , so @xmath1408 . since all of the positions @xmath1396 , @xmath1373 , and @xmath1395 are distinct , the only option is that @xmath1409 . since the position @xmath1410 is repetitive , by the factor @xmath1411 $ ]",
    "is in @xmath425 . by the definition of the positions @xmath1279 , @xmath1280 , and @xmath1365 also @xmath1412 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] . since @xmath1386 , also @xmath1413 .",
    "since @xmath1410 is the smallest element of the set @xmath1140 , we have that @xmath1414 . as @xmath1415 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ]",
    ", we obtain by that @xmath1416| < |u| = |s^2|$ ] .",
    "this is a contradiction .",
    "hence we have that @xmath1405 .",
    "since the factor @xmath1417 $ ] is a product of minimal squares , the number @xmath1418 is even .",
    "similarly the numbers @xmath1419 and @xmath1420 are even .",
    "thus the number @xmath1421 is even , so @xmath1080 is even .",
    "it follows that the numbers @xmath1422 , @xmath1423 , and @xmath1424 are even .",
    "however , exactly two of the numbers @xmath1425 , @xmath1426 , and @xmath1427 have odd length .",
    "hence exactly two of the numbers @xmath1396 , @xmath1373 , and @xmath1395 are odd . thus it is not possible that all of the numbers @xmath1428 , @xmath1429 , and @xmath1430 are even .",
    "this is a contradiction .",
    "the previous contradiction shows that either of the positions @xmath1373 and @xmath1395 is a repetitive position of @xmath990 .",
    "suppose for a contradiction that @xmath1395 is repetitive .",
    "we have that @xmath1431 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] and @xmath1432 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] .",
    "similar to the second paragraph of this subproof , using we obtain a contradiction unless @xmath1433 .",
    "even this conclusion is contradictory as @xmath1396 is not repetitive .",
    "therefore @xmath1395 can not be repetitive , so @xmath1373 is a repetitive position of @xmath990 .",
    "now if @xmath1373 would not be nicely repetitive , we would have by the maximality of @xmath1361 that",
    "@xmath1434 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] , that is , @xmath1377 . however , since @xmath1435 , we have that @xmath1373 is a nicely repetitive position of @xmath990 .",
    "we are now in the final stage of the proof .",
    "we will show that @xmath10 is periodic with minimal period conjugate to @xmath1080 .",
    "we can now argue as in the proof of .",
    "since @xmath1373 is a nicely repetitive position of @xmath990 , by the word @xmath1436 is periodic with minimal period @xmath372 conjugate to @xmath990 .",
    "we have that @xmath1437 for some @xmath1438 .",
    "since @xmath1373 is a nicely repetitive position of @xmath990 , the prefix of @xmath1439 of length @xmath1129 is a product of minimal squares and its square root equals @xmath372 by . since @xmath1440 \\in \\pi({\\mathfrak{a}},{\\mathfrak{b}})$ ] , the implies that @xmath1441}$ ] is a suffix of @xmath372 .",
    "now @xmath1442}\\sqrt{t^{\\ell_2}(w')}$ ] , so @xmath10 is periodic with minimal period conjugate to @xmath990 .    by the word",
    "@xmath990 always has at least one nicely repetitive position .",
    "it therefore follows that there exists a word in @xmath7 having periodic square root .",
    "\\(o ) at ( 0,0 ) ; ( w ) at ( 3.5,0 ) ; ( z ) at ( @xmath1443 ) @xmath1316 ; iin 0, ... ,3 ( @xmath1444 )  ( @xmath1445 ) ; ( @xmath1446 )  ( @xmath1447 ) ;    = [ circle , fill , inner sep=0,minimum size=3pt ] ( x1 ) at ( @xmath1448 ) [ tick ] ; i[count = from 2 ] in 0.9,0.95,0.85,0.88 ( x ) at ( @xmath1449 ) [ tick ] ; ( d1 ) at ( 0.0,-0.35 ) ; ( l1 ) at ( @xmath1450 ) @xmath562 ; iin 2, ... ,5 ( li ) at ( @xmath1451 ) @xmath1452 ; ( u1 ) at ( 0,0.5 ) ; iin 1, ... ,4 ( @xmath1453 )  ( @xmath1454 ) ; iin 1, ... ,5 ( @xmath1455 )  ( @xmath1453 ) ; ( u2 ) at ( 0,1 ) ; ( m1 ) at ( @xmath1456 ) @xmath1457 ; ( m2 ) at ( @xmath1458 ) @xmath1459 ; ( m3 ) at ( @xmath1460 ) @xmath1461 ; ( m4 ) at ( @xmath1462 ) @xmath1463 ; ( d2 ) at ( 0,-0.8 ) ; ( e ) at ( 0.01,0 ) ; iin 0, ... ,3 ( @xmath1464 ) ",
    "( @xmath1465 ) ; ( @xmath1466 )  ( @xmath1464 ) ; ( @xmath1446 )  ( @xmath1467 ) ; ( d3 ) at ( @xmath1468 ) ; iin 1, ... ,4 ( si ) at ( @xmath1469 ) @xmath1470 ;",
    "it is natural to think that the square root map could be generalized to obtain a cube root map and , further , a @xmath1471 root map .",
    "however , in ( * ? ? ?",
    "* theorem  5.3 . )",
    "saari proves the following reformulation of a result of mignosi , restivo , and salemi .",
    "[ prp : repetitivity_periodicity ] if @xmath21 is an everywhere @xmath0-repetitive word with @xmath1472 , where @xmath1473 is the golden mean , then @xmath21 is ultimately periodic .",
    "generalizing the square root map to a cube root map would require everywhere @xmath1474-repetitive words . by the above such words",
    "must be ultimately periodic , so we expect that this direction of research would not be fruitful .",
    "another way to generalize the square root map is to use abelian powers instead of ordinary powers . for abelian powers",
    "a result like does not exist .",
    "for instance , by ( * ? ? ?",
    "* theorem  1.9 . )",
    "every position in a sturmian word begins with an abelian @xmath1475 power for all @xmath114 .",
    "abelian square root can be defined for e.g. optimal squareful words as we will see shortly .",
    "however , abelian cubes in sturmian words do not work .",
    "consider again the fibonacci word @xmath235 .",
    "the minimal abelian cube prefix of @xmath1476 is @xmath1477 .",
    "this abelian cube is followed by the factor @xmath1478 , so the root of the next abelian cube must begin with @xmath1478 . hence if we define the abelian cube root of @xmath1476 to be the product of the roots of the abelian cubes , the resulting word begins with @xmath1479 which is not a factor of @xmath235 .",
    "thus by defining an abelian cube root map in this way , we lose the main property that the mapping preserves the languages of sturmian words",
    ".    in @xcite saari also considers optimal abelian squareful words . _",
    "optimal abelian squareful words _ are defined by replacing minimal squares with minimal abelian squares in the definition of optimal squareful words .",
    "let @xmath1480 be a product of minimal abelian squares @xmath1481 .",
    "we define its _ abelian square root _ as the word @xmath1482{w } = x_1 x_2 \\cdots$ ] .",
    "it follows from ( * ? ? ?",
    "* theorem  18 ) that the six minimal squares are products of exactly five minimal abelian squares ( this is straightforward to verify directly ) . thus if @xmath21 is an optimal squareful word , then @xmath1483{w}$ ] .",
    "thus by the abelian square root of a sturmian word @xmath12 is the sturmian word @xmath14 .",
    "also , by there exists a minimal subshift @xmath7 such that for all @xmath8 either @xmath1482{w } \\in \\omega$ ] or @xmath1482{w}$ ] is periodic .",
    "saari proves in ( * ? ? ?",
    "* theorem  19 ) that an optimal abelian squareful word must have at least five distinct minimal abelian squares , but he leaves the characterization of these sets of minimal abelian squares open . thus it is possible that there exists optimal abelian squareful words which contain other minimal abelian squares than those given by ( * ? ? ?",
    "* theorem  18 ) . for such words",
    "the abelian square root map could exhibit different behavior than the square root map ( if the square root map is even defined for such words ) .",
    "we have not extended our research to this direction .",
    "we could also generalize the special function @xmath245 .",
    "divide the distance @xmath1484 between @xmath13 and @xmath162 into @xmath120 parts and choose the image of @xmath13 to be @xmath1485 among the points @xmath1486 to obtain the function @xmath1487 the map @xmath1488 is a perfectly nice function on the circle @xmath128 , but to make things interesting we would need to find a symbolic interpretation for it .",
    "we have not figured out any such interpretation for these generalized functions .",
    "in the we saw that there are non - sturmian words whose language is preserved under the square root map . however , sturmian words satisfy an even stronger property : by for the sturmian subshift @xmath1489 of slope @xmath0 it holds that @xmath1490 .",
    "this property is not satisfied by the aperiodic and minimal subshift @xmath1491 of the word @xmath29 constructed in since by there is a word in @xmath1491 having periodic square root ; since @xmath1491 is aperiodic and minimal , it can not contain such words .",
    "we are thus led to ask the following question we could not answer :    if @xmath7 is a subshift containing optimal squareful words satisfying @xmath1492 , does the subshift @xmath7 only contain sturmian words ?",
    "let us briefly see that if we do not require all words in @xmath7 to be aperiodic then the above question has a negative answer .",
    "there exists a non - minimal non - sturmian subshift @xmath7 containing squareful words such that @xmath1492 .",
    "let @xmath990 be a seed solution as in , and let @xmath29 be a corresponding fixed point of the square root map generated by the seed @xmath990 as in .",
    "further , set @xmath1493 , let @xmath1494 be the subshift generated by @xmath1495 , and let @xmath1491 be the subshift generated by @xmath29 . if @xmath1496 , then by either @xmath1497 or @xmath1498 . hence if we are able to show that @xmath1499 , then the non - minimal and non - sturmian subshift @xmath1500 has the desired properties .",
    "let @xmath1501 , so @xmath1502 for some @xmath1318 .",
    "write @xmath21 as a product of minimal squares : @xmath1322 .",
    "we can now argue as in the proof of . if @xmath1503 for some @xmath73 or @xmath1504 for some @xmath380 , then using the fact that @xmath1505 it is straightforward to see that @xmath1498 .",
    "otherwise either @xmath562 is a nicely repetitive position of @xmath990 or @xmath1506 is a nicely repetitive position of @xmath990 where @xmath1507 in both of these cases we deduce with the help of that @xmath1498 .",
    "there are other interesting related questions .",
    "consider the limit set @xmath1508 we know very little about the limit set except in the sturmian case when it contains the two fixed points @xmath16 and @xmath17 .",
    "for the word @xmath29 of we proved that the limit set contains at least two fixed points . we ask :    when is the limit set nonempty ? if it is nonempty , does it always contain fixed points ?",
    "can it contain points which are not fixed points ?",
    "it is a genuine possibility that the limit set is empty .",
    "consider for instance the word @xmath1509 , the morphic image of the fixed point of the morphism @xmath1510 under @xmath1511 where @xmath1512 and @xmath1513 are minimal square roots of slope @xmath1514 $ ] .",
    "it is straightforward to verify that @xmath1515 is optimal squareful and uniformly recurrent and that the returns to the factor @xmath1516 in @xmath1517 are @xmath1518 , @xmath1519 and @xmath1520 . by considering all possible occurrences of the factor @xmath1521 in any product of minimal squares of slope @xmath0",
    ", it can be shown that the square root of the product always contains a return to the factor @xmath1516 which is not in @xmath1517 . since the factor @xmath21 occurs in every point in the subshift @xmath1522 generated by @xmath1515",
    ", we conclude that @xmath1523 .",
    "in we constructed infinite families of primitive solutions to using the recurrence @xmath1067 .",
    "why this construction worked was because the seed solution @xmath990 and the word @xmath1524 satisfy @xmath1087 , @xmath1088 , @xmath1089 , and @xmath1090 , that is , @xmath1525 .",
    "similarly @xmath1526 , so substituting for example @xmath1527 we obtain the primitive solution @xmath1528 to in @xmath1529 .",
    "more solutions can be obtained with analogous constructions . restricting to the languages of optimal squareful words , we ask :    what are the primitive solutions @xmath21 of in @xmath1530 such that @xmath21 or @xmath23 is not sturmian and @xmath21 is not obtainable by the above construction ?",
    "the authors were supported by university of turku graduate school utugs matti programme and by the fidipro grant ( 137991 ) from the academy of finland ."
  ],
  "abstract_text": [
    "<S> we introduce a square root map on sturmian words and study its properties . given a sturmian word of slope @xmath0 , there exists exactly six minimal squares in its language ( a minimal square does not have a square as a proper prefix ) . </S>",
    "<S> a sturmian word @xmath1 of slope @xmath0 can be written as a product of these six minimal squares : @xmath2 . </S>",
    "<S> the square root of @xmath1 is defined to be the word @xmath3 . </S>",
    "<S> the main result of this paper is that that @xmath4 is also a sturmian word of slope @xmath0 . </S>",
    "<S> further , we characterize the sturmian fixed points of the square root map , and we describe how to find the intercept of @xmath4 and an occurrence of any prefix of @xmath4 in @xmath1 . related to the square root map , we characterize the solutions of the word equation @xmath5 in the language of sturmian words of slope @xmath0 where the words @xmath6 are minimal squares of slope @xmath0 .    </S>",
    "<S> we also study the square root map in a more general setting . </S>",
    "<S> we explicitly construct an infinite set of non - sturmian fixed points of the square root map . </S>",
    "<S> we show that the subshifts @xmath7 generated by these words have a curious property : for all @xmath8 either @xmath9 or @xmath10 is periodic . </S>",
    "<S> in particular , the square root map can map an aperiodic word to a periodic word .    </S>",
    "<S> : sturmian word , standard word , optimal squareful word , word equation , continued fraction </S>"
  ]
}