{
  "article_text": [
    "we consider the first - order language of graph theory whose vocabulary contains two relation symbols @xmath4 and @xmath5 , respectively for adjacency and equality of vertices . the term _ first - order _ imposes the condition that the variables represent vertices and",
    "hence the quantifiers apply to vertices only . without quantification over sets of vertices , we are unable to express by a single formula some basic properties of graphs , such as being bipartite , being connected , etc .",
    "( see , e.g. ,  ( * ? ? ?",
    "* theorems  2.4.1 and  2.4.2 ) ) . however , first - order logic is powerful enough to define any _ individual _ graph .",
    "how succinctly this can be done is the subject of this article .    as a starting example , let us say in the first - order language that vertices @xmath6 and @xmath7 are at distance at most @xmath8 from one another . a possible formula @xmath9 can look as follows : @xmath10    by a _ sentence _",
    "we mean a first - order formula where every variable is bound by a quantifier .",
    "if we specify a graph @xmath1 , a sentence @xmath11 is either _ true _ or _ false _ on it . if @xmath12 is a graph isomorphic to @xmath1 , then @xmath11 is either true or false on @xmath1 and @xmath12 simultaneously . in other words",
    ", first - order logic can not distinguish between isomorphic graphs .",
    "in general , we say that a sentence @xmath11 _ distinguishes _ a graph @xmath1 from another graph @xmath12 if @xmath11 is true on @xmath1 but false on  @xmath12 .",
    "for example , sentence @xmath13 distinguishes a complete graph @xmath14 from any graph @xmath12 that is not complete . the sentence @xmath15 distinguishes @xmath16 , the path with @xmath8 vertices , from any longer path @xmath17 , @xmath18 .    throughout this survey",
    "we consider only graphs whose vertex set is finite and non - empty .",
    "we say that a sentence @xmath11 _ defines _ a graph @xmath1 ( up to isomorphism ) if @xmath11 distinguishes @xmath1 from every non - isomorphic graph @xmath12 .    for example",
    ", the single - vertex graph @xmath19 is defined by sentence @xmath20 . if @xmath21 , then the path @xmath16 is defined by @xmath22 & & { \\mbox{\\qquad\\qquad\\qquad\\qquad\\quad}}\\mbox{\\tt to say that the diameter equals $ n-1$}\\\\[1.5 mm ] & & \\displaystyle{}{\\wedge}\\forall x\\neg\\exists y_1\\exists y_2\\exists y_3 { \\left ( \\bigwedge_{i=1,2,3}x\\sim y_i{\\wedge}\\bigwedge_{i\\ne j}\\neg(y_i = y_j ) \\right)}\\\\[5.5 mm ] & & { \\mbox{\\qquad\\qquad\\qquad\\qquad\\quad}}\\mbox{\\tt to say that the maximum degree $ \\le2$}\\\\[2 mm ] & & \\displaystyle{}{\\wedge}\\exists x\\neg\\exists y_1\\exists y_2 { \\left ( \\bigwedge_{i=1,2}x\\sim y_i{\\wedge}\\neg(y_1=y_2 ) \\right)}\\\\[3 mm ] & & { \\mbox{\\qquad\\qquad\\qquad\\qquad\\quad}}\\mbox{\\tt to say that the minimum degree $ \\le1 $ ( thereby}\\\\ & & { \\mbox{\\qquad\\qquad\\qquad\\qquad\\quad}}\\mbox{\\tt distinguishing from cycles $ c_{2n-2}$ and $ c_{2n-1}$ ) } \\end{array}\\ ] ]    we have already mentioned the following basic fact : _ every finite graph @xmath1 is definable . _ indeed , let @xmath23 be the vertex set of @xmath1 and @xmath24 be its edge set . a sentence",
    "defining @xmath1 could read :    @xmath25    where , for the notational convenience , we use the following shorthands @xmath26   \\mathrm{adj}(x_1,\\dots , x_n)&{\\stackrel{\\mbox{\\tiny def}}{=}}&\\bigwedge_{\\{v_i , v_j\\}\\in e(g ) } x_i\\sim   x_j\\ \\wedge\\bigwedge_{\\{v_i , v_j\\}\\not\\in e(g ) } \\neg\\ , ( x_i\\sim   x_j ) .   \\end{aligned}\\ ] ] in other words , we first specify that there are @xmath8 distinct vertices , list the adjacencies and the non - adjacencies between them , and then state that we can not find @xmath27 distinct vertices .",
    "the sentence ( [ eq : def ] ) is an exhaustive description of @xmath1 and seems rather wasteful .",
    "we want to know if there is a more succinct way of defining a graph on @xmath8 vertices .",
    "the following natural succinctness measures of a first - order formula @xmath11 are of interest :    * the _ length _",
    "@xmath28 which is the total number of symbols in @xmath11 ( each variable symbol contributes 1 ) ; * the _ quantifier depth _ @xmath29 which is the maximum length of a chain of nested quantifiers in @xmath11 ; * the _ width _ @xmath30 which is the number of variables used in @xmath11 ( different occurrences of the same variable are not counted ) . as the maximum number of free variables in a subformula of @xmath11 .",
    "denote this version by @xmath31 .",
    "clearly , @xmath32 and the inequality can be strict .",
    "nevertheless , the two parameters are closely related : @xmath11 can be rewritten by renaming bound variables in an equivalent form @xmath33 so that @xmath34 ; see ( * ? ? ? * lemma 3.1.4 ) . ]",
    "formula @xmath35 in ( [ ex : dist_n ] ) was intentionally written in a non - optimal way .",
    "note that @xmath36 , @xmath37 , and @xmath38 .",
    "the same distance restriction can be expressed more succinctly with respect to the latter two parameters , namely @xmath39 where @xmath40 ( resp .",
    "@xmath41 ) stands for the integer nearest to @xmath6 from above ( resp .  from below ) .",
    "now @xmath42 , giving an exponential gain for the quantifier depth !",
    "the width can be reduced even more drastically : by recycling variables we can write @xmath43 with only @xmath44 variables in total , achieving @xmath45 .",
    "we now come to the central concepts of our survey .",
    "let us define @xmath3 ( resp .",
    "@xmath0 , @xmath2 ) to be the minimum of @xmath28 ( resp .",
    "@xmath29 , @xmath30 ) over all sentences @xmath11 defining a graph @xmath1 .",
    "we will call these graph invariants , respectively , the _ logical length , depth _ , and _ width _ of  @xmath1 .",
    "[ ex : ldw ]    using @xmath43 in place of @xmath35 in ( [ ex : path ] ) , we see that @xmath46 and @xmath47 .",
    "the reader is encouraged to improve the latter to @xmath48 .",
    "the generic defining sentence ( [ eq : def ] ) shows that @xmath49 and @xmath50 for every graph @xmath1 on @xmath8 vertices .",
    "the _ complement _ of @xmath1 , denoted by @xmath51 , is the graph on the same vertex set @xmath52 whose edges are those pairs that are not in @xmath24 .",
    "one can easily prove that @xmath53 and @xmath54 .",
    "the logical length , depth , and width of a graph satisfy the following inequalities : @xmath55 the latter relation follows from an obvious fact that @xmath56 for any first - order formula @xmath11 .",
    "the former follows from a bit less obvious fact that for any first - order formula @xmath11 there is a logically equivalent formula @xmath57 with @xmath58 .",
    "suppose that we put some restrictions on the structure of a defining sentence .",
    "this may cause an increase in the resources ( length , depth , width ) that we need in order to define a graph in the straitened circumstances .",
    "these effects will be one of our main concerns in this survey .",
    "we will deal with restrictions of the following two sorts .",
    "we may be allowed to make only a small ( constant ) number of quantifier alternations or to use only a bounded number of variables .",
    "the former is commonly used in logic and complexity theory to obtain hierarchical classifications of various problems .",
    "the latter is in the focus of _ finite - variable logics _",
    "( see , e.g , grohe  @xcite ) . moreover , the number of variables has relevance to the computational complexity of the graph isomorphism problem , see section  [ s : wl ] .",
    "[ [ bounded - number - of - quantifier - alternations . ] ] bounded number of quantifier alternations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a first - order formula @xmath11 with connectives @xmath59 is in a _ negation normal form _ if all negations apply only to relations ( one can think that we now do not have negation at all but introduce instead two new relation symbols , for inequality and non - adjacency ) .",
    "it is well known that this structural restriction actually does not make first - order logic weaker : we can always move negations in front of relation symbols without increasing the formula s length more than twice and without changing the quantifier depth and the width .",
    "given such a formula @xmath11 and a sequence of nested quantifiers in it , we count the number of _ quantifier alternations _",
    ", that is , the number of successive pairs @xmath60 and @xmath61 in the sequence . the _ alternation number _ of @xmath11 is the maximum number of quantifier alternations over all such sequences . the",
    "_ @xmath62-alternation logic _ consists of all first - order formulas in the negation normal form whose alternation number does not exceed @xmath62 . we will adhere to the following notational convention : a subscript @xmath62 will always indicate that at most @xmath62 quantifier alternations are allowed . for example , @xmath63 is the minimum quantifier depth of a sentence in the @xmath62-alternation logic that defines a graph  @xmath1 .    for any graph @xmath1 on @xmath8 vertices",
    "we have @xmath64 where the last bound is due to the defining sentence  ( [ eq : def ] ) .    [",
    "[ bounded - number - of - variables . ] ] bounded number of variables .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    the _",
    "@xmath65-variable logic _ is the fragment of first - order logic where only @xmath65 variable symbols are available , that is , the formula width is bounded by @xmath65 .",
    "the restriction of defining sentences to the @xmath65-variable logic will be always indicated by a superscript @xmath65 . to make this notation always applicable , we set @xmath66 if the @xmath65-variable logic is too weak to define @xmath1 . if @xmath67 for a graph @xmath1 of order @xmath8 , then we have @xmath68 where the last bound will be established in theorem [ thm : dk ] below .",
    "note that the bounds in example [ ex : ldw].1 can be strengthened to @xmath69 .",
    "we will also enrich first - order logic by allowing one to use expressions of the type @xmath70 in order to say that there are at least @xmath71 vertices with property @xmath57 .",
    "those are called _ counting quantifiers _ and the extended logic will be referred to as _ counting logic_. a counting quantifier @xmath72 contributes 1 in the quantifier depth irrespectively of the value of @xmath71 . for the counting logic we will use the `` sharp - notation '' , thus denoting the logical depth and width of a graph @xmath1 in this logic , respectively , by @xmath73 and @xmath74 .",
    "clearly , @xmath75 and @xmath76 .",
    "the counting quantifiers often allow us to define a graph much more succinctly .",
    "for example ,",
    "@xmath77 as this graph is defined by @xmath78 this is in sharp contrast with the fact that @xmath79 , where the lower bound follows from the simple observation that @xmath8 variables are not enough to distinguish between @xmath14 and  @xmath80",
    ".      section [ s : prelim ] specifies notation and proves a couple of basic facts about first - order sentences . the latter",
    "are applied to establish an upper bound on the logical length @xmath3 of a graph in terms of its logical depth @xmath0 and to estimate from above the number of graphs whose logical depth is bounded by a given parameter  @xmath65 .",
    "the existence of such bounds is more important than the bounds themselves that are huge , involving the tower function .",
    "furthermore , we define @xmath81 to be the smallest quantifier depth sufficient to distinguish between non - isomorphic graphs @xmath1 and @xmath12 .",
    "we will observe that the obvious inequality @xmath82 gives the sharp lower bound on @xmath0 .",
    "thus estimating @xmath0 reduces to estimating  @xmath81 for all @xmath83    the value of @xmath81 is characterized in section [ s : games ] as the length of the _ ehrenfeucht game _ on @xmath1 and @xmath12 . moreover",
    ", the logical width admits a characterization in terms of another parameter of the game .",
    "thus , the determination of the logical depth and width of a graph reduces to designing optimal strategies in the ehrenfeucht game .    in section [ s : wl ] , the logical width and the logical depth are also characterized , respectively , as the minimum _ dimension _ and the minimum _ number of rounds _ such that the so - called _ weisfeiler - lehman algorithm _ returns the correct answer .",
    "the algorithm tries to decide whether two input graphs are isomorphic ; its one - dimensional version is just the well - known color - refining procedure .",
    "thus , an analysis of the algorithm can give us information on the logical complexity of the input graphs .",
    "this relationship is even more advantageous in the other direction : once we prove that all graphs in some class @xmath84 have low logical complexity , we immediately obtain an efficient isomorphism test for  @xmath84 .",
    "this paradigm is successful for graphs with bounded treewidth and planar graphs , with good prospects for covering all classes of graphs with an excluded minor . in section [ ss : classes ] we report strong upper bounds for the logical depth / width of graphs in these classes .",
    "in section [ s : general ] we survey the bounds known in the general case .",
    "in particular , if a graph @xmath1 on @xmath8 vertices has no _ twins _ , i.e.",
    ", no two vertices have the same adjacency to the rest of the graph , then @xmath85 .",
    "the factor of @xmath86 can be improved for graphs with bounded vertex degrees .",
    "here we have to content ourselves with linear bounds in view of a linear lower bound by cai , frer , and immerman @xcite .",
    "they constructed examples of graphs with maximum degree  3 such that @xmath87 for a positive constant  @xmath88 .",
    "section [ s : average ] discusses the logical complexity of a random graph .",
    "we obtain rather close lower and upper bounds for _ almost all _ graphs .",
    "furthermore , we trace the behavior of the logical depth in the evolutional random graph model  @xmath89 where @xmath90 is a function of @xmath8 .",
    "while in sections [ s : worstcase ] and [ s : average ] we deal with , respectively , worst case and average case bounds , section [ s : best ] is devoted to the _",
    "best case_. more specifically , we define _ succinctness function _",
    "@xmath91 to be equal to the minimum of @xmath0 over all @xmath1 on @xmath8 vertices .",
    "since only finitely many graphs are definable with a fixed quantifier depth , @xmath91 goes to infinity as @xmath8 increases .",
    "it turns out that its growth is inconceivably slow : we show a superrecursive gap between the values of @xmath91 and @xmath8 .",
    "this phenomenon disappears if we `` smoothen '' @xmath91 by considering the least monotonic upper bound for this function : the smoothed succinctness function is very close to the log - star function .",
    "furthermore , the succinctness function can be considered in any logic .",
    "let @xmath92 be its variant for the logic with no quantifier alternation .",
    "we can determine @xmath92 with rather high precision : it is also related to the log - star function .",
    "the lower bound for @xmath92 implies a superrecursive gap between the graph parameters @xmath0 and @xmath93 , yet another evidence of the weakness of the 0-alternation logic .",
    "the tight upper bound for @xmath92 shows that , nevertheless , there are graphs whose definitions , even if quantifiers are not allowed to alternate , can have surprisingly low quantifier depth .",
    "we give several methods of explicit constructions of such graphs .",
    "these constructions have another interesting aspect .",
    "they allow us to show that the previously mentioned tower - function bounds from section [ s : prelim ] can not be improved substantially .",
    "some of the most interesting open questions are collected in section  [ s : open ] .",
    "some of the results presented in the survey generalize to relational structures over a fixed vocabulary .",
    "such generalizations are often straightforward . for example , the upper bounds on succinctness functions hold true if the vocabulary contains at least one relation symbol of arity more than 1 ( since any graph can be trivially represented as a structure over this vocabulary ) .",
    "extension of the worst case bounds to general structures is also possible but requires essential additional efforts ; see  @xcite .",
    "various definability parameters were investigated also for special structures : colored graphs ( immerman and lander @xcite , cai , frer , and immerman @xcite ) , digraphs and hypergraphs ( pikhurko , veith , and verbitsky @xcite ) , bit strings and ordered trees ( spencer and st .",
    "john @xcite ) , linear orders ( grohe and schweikardt  @xcite ) .",
    "we define the _ tower function _ by @xmath94 and @xmath95 for each subsequent integer @xmath96 . given a function @xmath97 , by @xmath98",
    "we will denote the @xmath96-fold composition of @xmath97 .",
    "in particular , @xmath99 .",
    "by @xmath100 we always mean the logarithm base 2 .",
    "the `` inverse '' of the tower function , the _ log - star _",
    "function @xmath101 , is defined by @xmath102 .",
    "we use the standard asymptotic notation .",
    "for example , @xmath103 means that there is a constant @xmath104 such that @xmath105 for all sufficiently large  @xmath8 .",
    "the number of vertices in a graph @xmath1 is called the _ order _ of @xmath1 and is denoted by @xmath106 .",
    "the _ neighborhood _",
    "@xmath107 of a vertex @xmath108 consists of all vertices adjacent to @xmath108 .",
    "the _ degree _ of @xmath108 is defined by @xmath109 .",
    "the _ maximum degree _ of a graph @xmath1 is defined by @xmath110 .",
    "the _ distance _ between vertices @xmath111 and @xmath108 in a graph @xmath1 is defined to be the minimum length of a path from @xmath111 to @xmath108 and denoted by @xmath112 .",
    "if @xmath111 and @xmath108 are in different connectivity components , then we set @xmath113 .",
    "eccentricity _ of a vertex @xmath108 is defined by @xmath114 .",
    "let @xmath115 .",
    "the subgraph induced by @xmath1 on @xmath116 is denoted by @xmath117 $ ] .",
    "we denote @xmath118 $ ] , which is the result of the removal of all vertices in @xmath116 from @xmath1 .",
    "if a single vertex @xmath108 is removed , we write @xmath119 .",
    "a set of vertices @xmath116 is called _ homogeneous _ if @xmath117 $ ] is a complete or an empty graph .",
    "a graph is _",
    "@xmath65-connected _ if it has at least @xmath120 vertices and remains connected after removal of any @xmath121 vertices .",
    "2-connected graphs are also called _ biconnected_.    a graph is _ asymmetric _ if it admits no non - trivial automorphism .",
    "we have already mentioned the trivial relation @xmath122 .",
    "now we aim at bounding @xmath3 from above in terms of @xmath0 .",
    "we write @xmath123 to say that graphs @xmath1 and @xmath12 can not be distinguished by any sentence with quantifier depth @xmath65 . as it is easy to see",
    ", @xmath124 is an equivalence relation .",
    "its equivalence classes will be referred to as _ @xmath124-classes_. we say that a sentence @xmath11 _ defines _ a @xmath124-class @xmath125 if @xmath11 is true on all graphs in @xmath125 and false on all other graphs .",
    "[ lem : keq ]    the number of @xmath124-classes is finite and does not exceed @xmath126 .",
    "every @xmath124-class is definable by a sentence @xmath11 with @xmath127 and @xmath128 .",
    "the case of @xmath129 is easy : there is only one @xmath130-class ( consisting of all graphs ) , which is definable by @xmath131 .",
    "let @xmath132 and @xmath133 .",
    "when we write @xmath134 , we will mean an @xmath135-tuple @xmath136 ( if @xmath137 , the sequence is empty ) . if @xmath138 and @xmath11 is a formula with @xmath135 free variables",
    "@xmath139 , then notation @xmath140 will mean that @xmath141 is true on @xmath1 with each @xmath142 being assigned the respective  @xmath143 as its value .    a formula @xmath144 of quantifier depth @xmath145 is _ normal _ if @xmath11 is built from variables @xmath146 and every maximal sequence of nested quantifiers in @xmath11 has length @xmath145 and quantifies the variables @xmath147 exactly in this order .",
    "a simple inductive syntactic argument shows that any @xmath144 has an equivalent normal formula @xmath148 of the same quantifier depth as @xmath11 .",
    "we write @xmath149 to say that @xmath140 exactly when @xmath150 for every normal formula @xmath11 of quantifier depth @xmath145 .",
    "a normal formula @xmath141 _ defines _ a @xmath151-class @xmath125 if @xmath140 exactly when @xmath152 belongs to @xmath125 .",
    "the @xmath151-equivalence class of @xmath152 will be denoted by @xmath153_{k , s}$ ] .",
    "let @xmath154 denote the number of all @xmath151-classes and @xmath155 denote the minimum @xmath156 such that every @xmath151-class is definable by a normal formula of depth at most @xmath145 and length at most @xmath156 .",
    "note that relations @xmath124 and @xmath157 coincide .",
    "thus , our goal is to estimate the numbers @xmath158 and @xmath159 from above .",
    "we use the backward induction on @xmath135 .",
    "a @xmath160-class can be determined by specifying , for each pair of the @xmath65 elements , whether they are equal and , if not , whether they are adjacent or non - adjacent .",
    "there are at most three choices per pair .",
    "it easily follows that @xmath161 and @xmath162 .",
    "we are now going to estimate @xmath154 and @xmath155 in terms of @xmath163 and @xmath164 .",
    "suppose that each @xmath165-class @xmath166 is defined by a formula @xmath167 whose length is bounded by  @xmath164 .",
    "define @xmath168_{k , s+1 } : \\hspace{0.5 mm } u\\in v(g ) \\right\\}}$ ] , the set of @xmath165-classes obtainable from @xmath152 by specifying one extra vertex .",
    "note that @xmath169 indeed , suppose that @xmath170 , say , @xmath171_{k , s+1}$ ] is not in @xmath172 for some @xmath173 .",
    "then @xmath174 because formula @xmath175 is true for @xmath152 but false for @xmath176 .",
    "suppose now that @xmath152 and @xmath176 are distinguishable by a normal formula of quantifier depth @xmath145 .",
    "as it is easily seen , they are distinguishable by such a formula of the form @xmath177 .",
    "without loss of generality , assume that the formula @xmath177 is true for @xmath152 but false for @xmath176 .",
    "let @xmath173 be such that @xmath178 .",
    "since @xmath11 distinguishes @xmath179 from all @xmath180 with @xmath181 , the class @xmath182_{k , s+1}$ ] is not in @xmath172 and , hence , @xmath170 .",
    "thus , for a @xmath151-class @xmath125 we can correctly define the set of @xmath165-classes accessible from @xmath125 by @xmath183 for some ( in fact , arbitrary ) @xmath152 in @xmath125 .",
    "it follows from what we have proved that for arbitrary @xmath151-classes @xmath125 and @xmath184 , we have @xmath185 as an immediate consequence , @xmath186 since @xmath187 for every integer @xmath188 , we have @xmath189 . by the above recursion , we conclude that @xmath190 , which proves part  1 of the lemma .",
    "another conclusion is that any @xmath151-class @xmath125 can be defined by a normal formula @xmath191 looking at the length of @xmath192 , we obtain the recurrence @xmath193 set @xmath194 .",
    "a simple inductive argument shows that @xmath195 define the two - parameter function @xmath196 inductively on @xmath96 by @xmath197 and @xmath198 for @xmath199 .",
    "this is a generalization of the old function : @xmath200 .",
    "one can prove by induction on @xmath96 that for any @xmath201 and @xmath202 we have @xmath203 indeed , it is easy to check the validity of ( [ g ] ) for @xmath204 , while for @xmath205 we have @xmath206 we have for all @xmath207 that @xmath208 .",
    "this follows from @xmath209 for @xmath210 and can be checked by hand for @xmath211 .",
    "thus , for @xmath207 , we have by  ( [ g ] ) that @xmath212 routine calculations ( omitted ) based on  ( [ rec_l ] ) and the exact initial values @xmath213 , @xmath214 , and @xmath215 give part  2 of the lemma for @xmath216 .",
    "lemma [ lem : keq].2 gives us a bound for the logical length of a graph in terms of its logical depth .",
    "it suffices to notice that each single graph @xmath1 constitutes a @xmath124-class for @xmath217 .",
    "[ thm : dvsl ] @xmath218    in fact , ( * ? ? ?",
    "* theorem  10.1 ) states only that @xmath219 .",
    "here we went into the trouble of estimating the error term more precisely so that lemma [ lem : keq].2 and some of its consequences can be stated more neatly .",
    "lemma [ lem : keq].1 gives the following result .",
    "[ thm : inequi ] the number of graphs with logical depth at most @xmath65 does not exceed @xmath126 .",
    "notice two further consequences of lemma  [ lem : keq ] .",
    "[ thm : inequi2 ]    there are at most @xmath220 pairwise inequivalent sentences about graphs of quantifier depth @xmath65 .",
    "every sentence @xmath11 about graphs of quantifier depth @xmath65 has an equivalent sentence @xmath33 with the same quantifier depth and length less than @xmath221 .",
    "note that , if a sentence @xmath11 has quantifier depth @xmath65 , then the set of all graphs on which @xmath11 is true is the union of some @xmath124-classes . therefore , there are @xmath222 and no more pairwise inequivalent sentences of quantifier depth @xmath65 , where @xmath223 is the number of @xmath124-classes .",
    "part 1 now follows from lemma [ lem : keq].1 . by the same reason",
    "every sentence @xmath11 of quantifier depth @xmath65 is equivalent to the disjunction of sentences defining some @xmath124-classes . by lemma [ lem : keq].2",
    ", such disjunction does not need to be longer than @xmath224 .",
    "this proves part  2 .",
    "given two non - isomorphic graphs @xmath1 and @xmath12 , we define @xmath81 ( resp .",
    "@xmath225 ) to be the minimum of @xmath29 ( resp .",
    "@xmath30 ) over all sentences @xmath11 distinguishing @xmath1 from @xmath12 .",
    "thus , @xmath226 if and only if @xmath123 . obviously , @xmath227 . also , @xmath82 and @xmath228 .",
    "it turns out that these inequalities are tight in the following sense .",
    "[ lem : ddd ]    @xmath229 .",
    "@xmath230 .    _",
    "_ 1 . for each @xmath12 non - isomorphic to @xmath1 fix a sentence @xmath231 that distinguishes @xmath1 from @xmath12 and has the minimum possible quantifier depth , i.e. , @xmath232 .",
    "consider the sentence @xmath233 .",
    "it distinguishes @xmath1 from each non - isomorphic @xmath12 and has quantifier depth @xmath234 . therefore , @xmath235 as wanted .",
    "an obvious drawback of this argument is that the above conjunction over @xmath12 in @xmath11 is actually infinite .",
    "however , we have @xmath236 and there are only finitely many pairwise inequivalent first - order sentences about graphs of bounded quantifier depth , see theorem [ thm : inequi2 ] above .",
    "thus we can obtain a legitimate finite sentence defining  @xmath1 by removing from @xmath11 duplicates up to logical equivalence .    _ _ 2 .",
    "running the same argument , we have to `` prune '' the infinite conjunction @xmath237 , where @xmath238 . here",
    "we encounter a complication because there are infinitely many inequivalent sentences of the same width .",
    "( consider e.g.  the sentences from example [ ex : ldw].1 . ) however , theorem [ thm : dk].1 in section  [ s : wl ] implies that for every @xmath12 we can additionally require that the depth of @xmath231 is at most , for example , @xmath239 , where @xmath8 is the order of @xmath1 .",
    "now we can proceed as in part 1 of the lemma .",
    "lemma [ lem : ddd ] stays true in any finite - variable logic , any logic with bounded number of quantifier alternations , the logic with counting quantifiers , and any hybrid thereof .",
    "we set @xmath240 if @xmath65 variables do not suffice to distinguish @xmath1 from  @xmath12 .",
    "let @xmath1 and @xmath12 be graphs with disjoint vertex sets .",
    "@xmath241-round @xmath65-pebble ehrenfeucht game on @xmath1 and @xmath12 _ , denoted by @xmath242 , is played by two players , spoiler and duplicator , to whom we may refer as he and she respectively .",
    "the players have at their disposal @xmath65 pairwise distinct pebbles @xmath243 , each given in duplicate .",
    "a _ round _ consists of a move of spoiler followed by a move of duplicator . at each move spoiler",
    "takes a pebble , say @xmath244 , selects one of the graphs @xmath1 or @xmath12 , and places @xmath244 on a vertex of this graph . in response duplicator",
    "should place the other copy of @xmath244 on a vertex of the other graph .",
    "it is allowed to move previously placed pebbles to other vertices and place more than one pebble on the same vertex .",
    "after each round of the game , for @xmath245 let @xmath142 ( resp .",
    "@xmath246 ) denote the vertex of @xmath1 ( resp .",
    "@xmath12 ) occupied by @xmath244 , irrespectively of who of the players placed the pebble on this vertex .",
    "if @xmath244 is off the board at this moment , @xmath142 and @xmath246 are undefined .",
    "if after every of @xmath241 rounds the component - wise correspondence @xmath247 to @xmath248 is a partial isomorphism from @xmath1 to @xmath12 , this is a win for duplicator .",
    "otherwise the winner is spoiler .",
    "the following example should provide the reader with a hint for the solution of the exercise suggested in example  [ ex : ldw].1 .",
    "[ ex : game43]_spoiler wins @xmath249 if @xmath250 . _ assume that @xmath12 contains no triangle because otherwise spoiler wins by pebbling its vertices .",
    "let @xmath108 be a vertex in @xmath12 of degree at least 3 .",
    "spoiler pebbles 3 neighbors of @xmath108 .",
    "duplicator should pebble 3 distinct pairwise non - adjacent vertices in @xmath16 for otherwise she loses the game .",
    "the distance between any two vertices pebbled in @xmath12 is equal to 2 . unlike to this",
    ", some two vertices pebbled in @xmath16 ( say , by pebbles @xmath251 and @xmath252 ) are at a larger distance .",
    "spoiler moves @xmath253 to @xmath108 .",
    "duplicator is forced to violate the adjacency relation .    the particular case of @xmath242 in which the number of pebbles is the same as the number of rounds , i.e. , @xmath254 , deserves a special attention . in this case , the outcome of the game will not be affected if we prohibit moving pebbles from one vertex to another , that is , if we allow the players to play with each @xmath244 exactly once , say , in the @xmath96-th round .",
    "we denote this variant of @xmath255 by @xmath256 and will mean it whenever the term _ ehrenfeucht game _",
    "is used with no specification .",
    "[ lem : distance ] suppose that in the 3-pebble ehrenfeucht game on @xmath257 some two vertices @xmath258 at distance @xmath8 were selected so that their counterparts @xmath259 are at a strictly larger distance ( possibly infinity ) .",
    "then spoiler can win in at most @xmath260 extra moves .",
    "spoiler sets @xmath261 , @xmath262 , @xmath263 , @xmath264 , and places a pebble on the middle vertex @xmath111 in a shortest path from @xmath265 to @xmath266 ( or either of the two middle vertices if @xmath267 is odd ) .",
    "let @xmath181 be selected by duplicator in response to @xmath111 . by the triangle inequality , we have @xmath268 for @xmath269 or @xmath270 .",
    "for such @xmath71 spoiler resets @xmath271 , @xmath272 , @xmath273 , @xmath274 and applies the same strategy once again . in this way spoiler",
    "ensures that @xmath275 in each round .",
    "eventually , unless duplicator loses earlier , @xmath276 while @xmath277 , that is , duplicator fails to preserve adjacency .    to estimate the number of moves made ,",
    "notice that initially @xmath278 and for each subsequent @xmath279 this distance becomes at most @xmath280 , where @xmath281 .",
    "therefore the number of moves does not exceed the minimum @xmath96 such that @xmath282 .",
    "as @xmath283 , the latter inequality is equivalent to @xmath284 , which proves the bound .    there is a rather clear connection between spoiler s strategy designed in the proof of lemma [ lem : distance ] and first - order formula @xmath285 in ( [ ex : deltaa ] ) .",
    "we will see that , in some strong sense , @xmath256 corresponds to first - order logic , while @xmath242 corresponds to its @xmath65-variable fragment .",
    "in fact , every logic has its own corresponding game .    in the _ @xmath65-alternation _ variant of @xmath256 spoiler",
    "is allowed to switch from one graph to another at most @xmath65 times during the game , i.e. , in at most @xmath65 rounds he can choose the graph other than that in the preceding round .    in the _ counting version _ of the game @xmath242 spoiler can make a _ counting move _ consisting of two acts .",
    "first , he specifies a set of vertices @xmath286 in one of the graphs .",
    "duplicator has to respond with a set of vertices @xmath287 in the other graph so that @xmath288 ( if this is impossible , she immediately loses ) .",
    "second , spoiler places a pebble @xmath244 on a vertex @xmath289 . in response duplicator has to place the other copy of @xmath244 on a vertex @xmath290 .",
    "it is clear that , any round with @xmath291 is virtually the same as a round of the standard game .",
    "there is a general analogy between strategies allowing spoiler to win a game on @xmath1 and @xmath12 and first - order sentences distinguishing these graphs : the former can be converted into the latter and vice versa so that the duration of a game will be in correspondence to the quantifier depth and the number of pebbles will be in correspondence to the number of variables .",
    "[ thm : games ] let @xmath1 and @xmath12 be non - isomorphic graphs .",
    "( ehrenfeucht @xcite , frass @xcite ) @xmath81 equals the minimum @xmath241 such that spoiler has a winning strategy in @xmath256 .",
    "( pezzoli @xcite ) @xmath292 equals the minimum @xmath241 such that spoiler has a winning strategy in the @xmath65-alternation game @xmath256 .",
    "( immerman @xcite , poizat @xcite ) @xmath225 equals the minimum @xmath65 such that spoiler has a winning strategy in @xmath242 for some @xmath241 .",
    "( immerman @xcite , poizat @xcite ) @xmath293 equals the minimum @xmath241 such that spoiler has a winning strategy in @xmath242 .",
    "( immerman and lander  @xcite ) @xmath294 equals the minimum @xmath65 such that spoiler has a winning strategy in the counting version of @xmath242 for some @xmath241 .",
    "furthermore , if @xmath295 , then @xmath296 equals the minimum @xmath241 such that spoiler has a winning strategy in the counting version of @xmath242 .",
    "we refer the reader to ( * ? ? ?",
    "* theorem 6.10 ) for the proof of parts  35 .",
    "part  1 follows from part  4 in view of the facts that @xmath297 and that any sentence @xmath11 can be equivalently rewritten with the same quantifier depth @xmath29 and with use of at most @xmath29 variables .    in view of lemma [ lem : ddd ] ,",
    "the ehrenfeucht theorem provides us with a powerful tool for estimating the logical depth and width of graphs .",
    "consider , for instance , a path @xmath16 .",
    "example [ ex : game43 ] and lemma [ lem : distance ] are immediately translated into the upper bound @xmath298 . on the other hand ,",
    "a lower bound @xmath299 follows from the existence of a winning strategy for duplicator in @xmath300 whenever @xmath301 ( all details can be found in ( * ? ? ? * theorem 2.1.3 ) ) .",
    "_ graph isomorphism _ is the problem of recognizing if two given graphs are isomorphic .",
    "the best known algorithm ( babai , luks , and zemlyachenko @xcite ) takes time @xmath302 , where @xmath8 denotes the number of vertices in the input graphs .",
    "particular classes of graphs for which graph isomorphism is solvable more efficiently are therefore of considerable interest .",
    "somewhat surprisingly , a number of important tractable cases are solvable by a combinatorially simple , uniform approach , namely the multidimensional weisfeiler - lehman algorithm .",
    "the efficiency of this method depends much on the logical complexity of input graphs .",
    "for the history of this approach to the graph isomorphism problem we refer the reader to @xcite",
    ". we will abbreviate _",
    "@xmath65-dimensional weisfeiler - lehman algorithm _ by _ k_. the 1  is commonly known as _ canonical labeling _ or _ color refinement algorithm_. it proceeds in rounds ; in each round a coloring of the vertices of input graphs @xmath1 and @xmath12 is defined , which refines the coloring of the previous round . the initial coloring @xmath303 is uniform , say , @xmath304 for all vertices @xmath305 . in the @xmath306st round , the color @xmath307",
    "is defined to be a pair consisting of the preceding color @xmath308 and the multiset of colors @xmath309 for all @xmath310 adjacent to @xmath111 .",
    "for example , @xmath311 iff @xmath111 and @xmath108 have the same degree . to keep the color encoding short , after each round the colors are renamed ( we never need more than @xmath312 color names because appearance of the @xmath313th color indicates non - isomorphism . ] ) .",
    "as the coloring is refined in each round , it stabilizes after at most @xmath312 rounds , that is , no further refinement occurs .",
    "the algorithm stops once this happens .",
    "if the multiset of colors of the vertices of @xmath1 is distinct from the multiset of colors of the vertices of @xmath12 , the algorithms reports that the graphs are not isomorphic ; otherwise , it declares them to be isomorphic . disappointingly , the output is not always correct .",
    "the algorithm may report false positives , for example , if both input graphs are regular with the same vertex degree .",
    "following the same idea , the @xmath65-dimensional version iteratively refines a coloring of @xmath314 .",
    "the initial coloring of a @xmath65-tuple @xmath315 is the isomorphism type of the subgraph induced by the vertices in @xmath315 ( viewed as a labeled graph where each vertex is labeled by the positions in the tuple where it occurs ) . loosely speaking",
    ", the refinement step takes into account the colors of all neighbors of @xmath315 in the hamming metric .",
    "color stabilization is surely reached in @xmath316 rounds and , thus , the algorithm terminates in polynomial time for fixed @xmath65 .",
    "let us give a careful description of the k for @xmath132 .",
    "given an ordered @xmath65-tuple of vertices @xmath317 , we define the _ isomorphism type _ of @xmath318 to be the pair @xmath319 ^ 2 : \\hspace{0.5 mm } u_i = u_j \\right\\}},{\\left\\ { \\hspace{0.5 mm } ( i , j)\\in[k]^2 : \\hspace{0.5 mm } \\{u_i , u_j\\}\\in e(g ) \\right\\}}\\big),\\ ] ] where @xmath320 $ ] denotes the set @xmath321 .",
    "if @xmath322 and @xmath323 , we let @xmath324 denote the result of substituting @xmath310 in place of @xmath143 in @xmath315 .",
    "the _ @xmath241-round k _ takes as an input two graphs @xmath1 and @xmath12 and purports to decide if @xmath325 . the algorithm performs the following operations with the set @xmath314",
    ".    _ initial coloring .",
    "_    the algorithm assigns each @xmath326 color @xmath327 ( in a suitable encoding ) .",
    "_ color refinement step .",
    "_    in the @xmath96-th round each @xmath328 is assigned color @xmath329 and similarly with each @xmath330 .",
    "here @xmath331 denotes a multiset . in a weaker _ count - free _ version of the algorithm , this notation will be interpreted as a set .",
    "let @xmath332    _ computing an output .",
    "_    the algorithm reports that @xmath333 if @xmath334 and that @xmath325 otherwise .    in the above description we skipped an important implementation detail . in order to prevent increasing the length of @xmath335 at the exponential rate ,",
    "we arrange colors of all @xmath65-tuples of @xmath314 in the lexicographic order and replace each color with its number before every refinement step .",
    "furthermore , let @xmath336 where @xmath337 denotes the @xmath65-tuple @xmath338 .",
    "[ lem : diagineq ] in both the standard and the count - free versions of the k , inequality @xmath339 implies ( [ eq : decision ] ) , which in its turn implies @xmath340    consider the standard version ; the analysis of the count - free case is similar ( and even simpler ) . by the _ equality type _ of a @xmath65-tuple @xmath315 we mean the first component of ( [ eq : isotype ] ) .",
    "note that @xmath65-tuples with different equality types never have the same color .",
    "therefore , @xmath341 and @xmath342 are different iff they are different on some class of @xmath65-tuples with the same equality type .",
    "this proves the first implication .    on the other hand , suppose that ( [ eq : decision ] ) holds .",
    "let @xmath343 be an equality type on which @xmath341 and @xmath342 differ .",
    "note that each @xmath315 in @xmath343 contributes color @xmath344 ( a certain number of times ) to color @xmath345 .",
    "moreover , the sum of the contributions over all vertices @xmath62 is the same for every @xmath346 .",
    "it follows that , if a color has different multiplicities in @xmath341 and @xmath342 , its `` traces '' occur different number of times in @xmath347 and @xmath348 , and hence these multisets are distinct .",
    "as it is easily seen , if @xmath349 is an isomorphism from @xmath1 to @xmath12 , then for all @xmath65 , @xmath96 , and @xmath328 we have @xmath350 .",
    "this shows that for isomorphic input graphs the output is always correct . if input graphs are non - isomorphic and the dimension @xmath65 is not big enough , the algorithm can erroneously report isomorphism",
    "a criterion for the optimal choice of the dimension is obtained by cai , frer , and immerman @xcite , who discovered a connection between the weisfeiler - lehman algorithm and the logical complexity of graphs via the ehrenfeucht game ( for the color refinement algorithm this was done by immerman and lander @xcite ) .",
    "the success of the standard version of the algorithm depends on distinguishability of the input graphs in the logic with counting quantifiers , while the count - free version is in the same way related to the standard first - order logic .",
    "referring to the k below , we will * always * assume @xmath188 for the standard version of the algorithm and @xmath132 for its count - free version ( we can exclude the case of @xmath129 , whose analysis differs by some details , as the count - free 1 is of no interest : note that it is unable to distinguish between two graphs of order @xmath8 without isolated vertices )",
    ".    given numbers @xmath241 , @xmath156 , and @xmath351 , graphs @xmath1 , @xmath12 , and @xmath65-tuples @xmath328 , @xmath352 , we use notation @xmath353 to denote the @xmath241-round @xmath156-pebble ehrenfeucht game on @xmath1 and @xmath12 with initial configuration @xmath354 , that is , the game starts on the board with @xmath65 already pebbled pairs @xmath355 . if the initial configurations is not a partial isomorphism , duplicator loses @xmath353 whatever @xmath356 .",
    "the following lemma is a key element of our analysis .",
    "[ lem : game ] let @xmath328 and @xmath352 .",
    "equality @xmath357 holds for ( the standard version of ) the k iff duplicator has a winning strategy in the counting version of @xmath358 .",
    "equality ( [ eq : coleq ] ) holds for the count - free version of the k iff duplicator has a winning strategy in ( the standard version of ) @xmath358 .",
    "we prove only part 2 ( part 1 is proved in detail in ( * ? ? ?",
    "* theorem 5.2 ) ) .",
    "we proceed by induction on @xmath241 .",
    "the base case @xmath359 is straightforward by the definitions of the initial coloring and the game .",
    "assume that the proposition is true for @xmath360 rounds .",
    "let @xmath142 and @xmath246 denote the vertices in @xmath1 and @xmath12 respectively marked by the @xmath96-th pebble pair .",
    "assume ( [ eq : coleq ] ) and consider the ehrenfeucht game on @xmath1 , @xmath12 with initial configuration @xmath361 and @xmath362 .",
    "first of all , this configuration is non - losing for duplicator since ( [ eq : coleq ] ) implies that @xmath363 .",
    "further , duplicator can survive in the first round .",
    "indeed , assume that spoiler in this round selects a vertex @xmath62 in one of the graphs , say in @xmath1 .",
    "then duplicator selects a vertex @xmath364 in the other graph @xmath12 so that @xmath365 for all @xmath323 .",
    "in particular , @xmath366 for all @xmath323 . along with @xmath363 , this implies that @xmath367 .",
    "assume now that in the second round spoiler removes @xmath368-th pebble , @xmath369 .",
    "then duplicator s task in the rest of the game is essentially to win @xmath370 .",
    "since @xmath371 , duplicator succeeds by the induction assumption .",
    "assume now that ( [ eq : coleq ] ) is false .",
    "it follows that @xmath372 ( then spoiler has a winning strategy by the induction assumption ) or there is a vertex @xmath62 in one of the graphs , say in @xmath1 , such that for every @xmath364 in the other graph @xmath12 we have @xmath373 for some @xmath374 . in the latter case spoiler in his first move",
    "places the @xmath375-th pebble on @xmath62 .",
    "let @xmath364 be the vertex selected in response by duplicator .",
    "in the second move spoiler will remove the @xmath376-th pebble , which implies that the players essentially play @xmath377 from now on . by the induction assumption , spoiler wins .",
    "[ lem : diagd ] equality @xmath378 is true for the standard ( resp .",
    "count - free ) version of the k iff duplicator has a winning strategy in the counting ( resp .",
    "standard ) version of @xmath379 .",
    "we consider the standard version of the algorithm ; the proof for the count - free version is very similar .",
    "if the multisets @xmath380 and @xmath381 are not equal , spoiler has a winning strategy in the counting game @xmath379 . in the first round he makes a counting move that forces pebbling @xmath382 and @xmath383 so that @xmath384 .",
    "the remainder of the game is equivalent to the counting game @xmath385 , where spoiler has a winning strategy by lemma  [ lem : game ] .",
    "if the multisets @xmath380 and @xmath381 are equal , duplicator is able to play the first round so that @xmath386 for the pebbled vertices @xmath62 and @xmath364 .",
    "she wins the remaining game again by lemma  [ lem : game ] .",
    "we say that the @xmath241-round k  _ works correctly for a graph @xmath1 _ if its output is correct on all input pairs @xmath257 ( here @xmath12 may have any order , not necessary the same as @xmath1 ) .",
    "[ thm : wld ] the @xmath241-round k  works correctly for @xmath1 if @xmath387 and only if @xmath388    the same holds true for the count - free @xmath241-round kand the standard logic ( without counting ) .    if @xmath325 , the output is correct in any case .",
    "suppose that @xmath333 .",
    "by lemma [ lem : diagineq ] , inequality ( [ eq : ineq1 ] ) is a sufficient condition for the output being correct while ( [ eq : ineq3 ] ) is a necessary condition for this .",
    "the theorem now follows from lemma [ lem : diagd ] , the ehrenfeucht theorem ( theorem [ thm : games].4,5 ) , and lemma  [ lem : ddd].1 along with its counting version .    by theorem",
    "[ thm : wld ] , @xmath389 is both a sufficient and a necessary condition for a successful work of the k  on all inputs @xmath257 . as we already discussed , the number of rounds can be taken @xmath390 .",
    "therefore , graph isomorphism is solvable in polynomial time for any class of graphs @xmath84 with @xmath391 for all @xmath392 .",
    "this applies to any class of graphs embeddable into a fixed surface and any class of graphs with bounded treewidth ( see section  [ ss : classes ] ) .",
    "sometimes the weisfeiler - lehman algorithm gives us even better result , namely the solvability of the isomorphism problem by a parallel algorithm in polylogarithmic time .",
    "the concept of polylogarithmic parallel time is captured by the complexity class nc and its refinements : @xmath393 where i  consists of functions computable by circuits of polynomial size and depth @xmath394 , i  is an analog for circuits with unbounded fan - in , and i  is an extension of i  allowing threshold gates . as it is well known @xcite ,",
    "i  consists of exactly those functions computable by a crcw pram with polynomially many processors in time @xmath394 .",
    "grohe and verbitsky @xcite point out that the @xmath241-round k(resp .",
    "its count - free version ) is implementable in 1  ( resp .",
    "1 ) as long as @xmath395 and @xmath396 . if combined with theorem [ thm : wld ] , this gives us the following result .",
    "[ thm : gve ] let @xmath132 be a constant .",
    "let @xmath84 be a class of graphs @xmath1 with @xmath397 .",
    "then graph isomorphism for @xmath84 is solvable in 1 .",
    "let @xmath84 be a class of graphs @xmath1 with @xmath398 .",
    "then graph isomorphism for @xmath84 is solvable in 1 .",
    "we will see applications of theorem [ thm : gve ] in section  [ ss : classes ] .",
    "suppose that @xmath399 and that we do not know a priori any bounds for @xmath400 .",
    "how large has @xmath241 to be taken in order to ensure that the @xmath241-round k  works correctly for @xmath1 ?",
    "an answer is given by an important concept of _ color stabilization _ that was already discussed in the beginning of this section .",
    "we will regard @xmath401 as a partition of @xmath314 .",
    "let @xmath402 be the minimum number for which @xmath403 .",
    "of course , it is enough to check the condition ( [ eq : decision ] ) for @xmath404 ; it can not change for bigger @xmath241 . since each @xmath401 is a refinement of @xmath405 , we have @xmath406 .",
    "in fact , we are able to prove a bit more delicate claim : the weisfeiler - lehman algorithm can be terminated as soon as @xmath401 stabilizes at least within @xmath407 .    to make this more precise , we introduce some notation .",
    "denote the restriction of the partition @xmath401 to @xmath407 by @xmath408 .",
    "let @xmath409 be the smallest number @xmath135 such that @xmath410 .",
    "note that @xmath409 is an individual combinatorial parameter of a graph @xmath1 , not depending on @xmath12 ( we may think that the k is run on a single graph @xmath1 , which is actually a quite meaningful _ canonization mode _ of the algorithm ) .",
    "we now state practical termination rules for the k.    once @xmath411 , terminate and report non - isomorphism .",
    "once @xmath412 and @xmath413 , terminate and report isomorphism .",
    "let us argue that these rules are sound for both versions of the algorithm .",
    "suppose that rule  2 is invoked .",
    "thus @xmath414 and @xmath413 . by the latter equality we also have @xmath415 .",
    "it follows that in the @xmath241-th round the algorithm achieves a proper color refinement on neither @xmath1 nor @xmath12 .",
    "thus , the partition @xmath401 has been stabilized on @xmath314 and the soundness of rule  2 follows .",
    "[ thm : wls ]    the @xmath241-round k  recognizes non - isomorphism of @xmath1 and @xmath12 if @xmath416    the @xmath241-round k  works correctly for @xmath1 if @xmath417    both claims hold true for the count - free version of the algorithm and the standard logic ( with no counting ) .",
    "we have seen that good bounds for the logical complexity of graphs imply efficiency of the weisfeiler - lehman algorithm on these graphs .",
    "now we will get a couple of noteworthy facts on the logical complexity as a consequence of our analysis of the algorithm .",
    "[ thm : dk ] let @xmath1 be a graph of order @xmath8 .    if @xmath1 is distinguishable from another graph @xmath12 in the @xmath418-variable logic , then @xmath419 .",
    "if @xmath1 is definable in the @xmath418-variable logic , then @xmath420 .",
    "let @xmath421 . comparing the sufficient conditions for the correctness of the @xmath241-round k  given by theorem [ thm : wls ] and the necessary conditions given by theorem [ thm : wld ] ,",
    "we have @xmath422 provided @xmath423 and @xmath424 provided @xmath399 . for the former claim",
    "we need also the fact , actually established in the proof of theorem [ thm : wld ] , that the count - free @xmath241-round k   is able to recognize non - isomorphism of @xmath1 and @xmath12 only if @xmath423 and @xmath425 .",
    "it remains to notice that @xmath426 .",
    "a somewhat weaker bound @xmath427 follows from the work of dawar , lindell , and weinstein ( * ? ? ?",
    "* corollary 4 ) .",
    "here we overview known bounds for the logical depth and width for natural classes of graphs . several interesting definability effects can be observed even when we focus on so simple graphs as trees .",
    "this class is considered at the beginning of this section ( and will be further discussed in sections [ s : average ] and [ s : best ] ) .",
    "we will see that many results about trees admit generalization to graphs with bounded treewidth .",
    "we further consider planar graphs .",
    "then we briefly discuss more general cases of graphs embeddable into a fixed surface and graphs with an excluded minor , as well as a few sporadic results on other classes .",
    "the following result is based on edmonds algorithm , that dates back to the sixties ( see , e.g. , @xcite ) , and its logical interpretation is due to immerman and lander  @xcite .",
    "[ thm : cwtrees ]    the color refinement algorithm succeeds in recognizing isomorphism of trees .",
    "consequently , @xmath428 for every two non - isomorphic trees @xmath429 and  @xmath430 .",
    "@xmath431 for every tree  @xmath429 .",
    "_ _ 1 . as in section",
    "[ s : wl ] , let @xmath432 denote the coloring appearing after the @xmath241-th refinement .",
    "let @xmath433 denote the set of all vertices at the distance at most @xmath241 from a vertex @xmath108 .",
    "it is not hard to see that , if @xmath108 is an arbitrary vertex in a tree @xmath429 , then the subtree spanned by @xmath433 is , up to isomorphism , reconstructible from @xmath434 .",
    "let @xmath108 and @xmath435 be arbitrary vertices in trees @xmath429 and @xmath430 . if @xmath436 , we have @xmath437 at latest for @xmath241 one greater than the smaller of the eccentricities of @xmath108 and @xmath435 .",
    "therefore , the color refinement algorithm distinguishes between any two non - isomorphic trees .",
    "the second statement of part  1 follows by lemma [ lem : game].1 and theorem  [ thm : games].5 .",
    "_ _ 2 . to obtain the desired definability result",
    ", we use the equality @xmath438 which is an analog of lemma [ lem : ddd].2 ( with a much simpler proof as graphs of different orders are distinguishable with a single counting quantification ) .",
    "thus , it suffices to prove that @xmath439 whenever @xmath440 .",
    "suppose that @xmath12 is not a tree for otherwise we are done by part  1 .",
    "also , as it was just mentioned , we can suppose that both @xmath429 and @xmath12 have @xmath8 vertices .",
    "assume first that @xmath12 has a connected component @xmath430 which is a tree .",
    "note that @xmath441 because @xmath430 has less than @xmath8 vertices .",
    "let @xmath442 and @xmath443 .",
    "run the color refinement algorithm on input @xmath444 . as in the proof of part 1",
    "we have @xmath445 because the coloring @xmath446 on @xmath430 is the same as if the algorithm was run on @xmath430 instead of @xmath12 .",
    "therefore , @xmath429 and @xmath12 are distinguishable with 2 variables in the counting logic .",
    "if none of the connected components of @xmath12 is a tree , then @xmath12 has at least @xmath8 edges .",
    "since @xmath429 has exactly @xmath447 edges , @xmath12 and @xmath429 have distinct multisets of vertex degrees and , hence , are distinguishable by a sentence with 2 counting quantifiers .",
    "the proof of theorem [ thm : cwtrees ] gives us only a linear upper bound @xmath448 for a tree of order @xmath8 .",
    "we can get a speed - up if we allow more variables .",
    "[ thm : cdtrees ] for every tree @xmath429 on @xmath8 vertices we have @xmath449    by an analog of lemma [ lem : ddd].1 for the counting logic and theorem [ thm : games].5 , we have to show that spoiler is able to win the counting game @xmath450 with some @xmath451 for any graph @xmath430 non - isomorphic to @xmath429 .",
    "suppose that @xmath430 has the same order @xmath8 .",
    "if @xmath430 is disconnected , spoiler wins ( even without counting moves ) by lemma [ lem : distance ] .",
    "if @xmath430 is connected and has a cycle , then @xmath429 and @xmath430 have distinct multisets of vertex degrees .",
    "therefore , we will suppose that @xmath430 is a tree too .",
    "every tree @xmath429 has a single - vertex _ separator _ , that is , a vertex @xmath108 such that no branch of @xmath452 has more than @xmath453 vertices ; see , e.g. , ore ( * ? ? ?",
    "* chapter 4.2 ) .",
    "the idea of spoiler s strategy is to pebble such a vertex and to force further play on some non - isomorphic branches of @xmath429 and @xmath430 , where the same strategy can be applied recursively .",
    "thus , in the first round spoiler pebbles a separator @xmath108 in @xmath429 and duplicator responds with a vertex @xmath435 somewhere in @xmath430 .",
    "the component of @xmath452 containing a neighbor @xmath111 of @xmath108 will be denoted by @xmath454 and considered a rooted tree with the root at @xmath111 .",
    "a similar notation will apply also to @xmath430 . in the second round spoiler",
    "makes a counting move and ensures that @xmath455 and @xmath456 are pebbled so that the rooted trees @xmath454 and @xmath457 are non - isomorphic , see fig .  [ fig : tree1 ] .",
    "the next goal of spoiler is to force pebbling adjacent vertices @xmath458 and @xmath265 in @xmath454 and adjacent vertices @xmath459 and @xmath460 in @xmath457 so that @xmath461 , @xmath462 , and @xmath463 .",
    "once this is done , the same will be repeated recursively .    to make the transition from @xmath454 to @xmath464 ,",
    "spoiler follows three rules .",
    "_ if @xmath454 has a branch @xmath465 for some @xmath466 such that @xmath467 and the number of branches isomorphic to @xmath465 is different for @xmath454 and @xmath457 , then spoiler makes a counting move and forces pebbling such @xmath6 and @xmath468 so that @xmath469 .",
    "the latter two branches will serve as @xmath464 and @xmath470 .",
    "if no such branch is available , spoiler pebbles a separator @xmath310 of @xmath454 .",
    "note that duplicator is forced to respond with a vertex @xmath471 in @xmath457 .",
    "otherwise we would have @xmath472 while @xmath473 .",
    "therefore , some distances among the three pebbled vertices would be different in @xmath429 and in @xmath430 and spoiler could win in less than @xmath474 moves by lemma [ lem : distance ] .",
    "_ if @xmath429 differs from @xmath430 by some branch @xmath475 ( having a different number of occurrences in @xmath476 ) that does not contain @xmath111 , spoiler makes a counting move with the pebble released from @xmath108 and forces pebbling such @xmath6 in @xmath429 and some @xmath477 in @xmath430 so that @xmath478 .",
    "these branches will serve as @xmath464 and @xmath470 .",
    "( it is possible that @xmath479 contains @xmath480 or @xmath475 contains @xmath111 but then the distances among @xmath481 are not all equal to the distances among @xmath482 and spoiler quickly wins . )    _ rule 3 . _",
    "denote the branch of @xmath483 containing @xmath111 by @xmath484 ( and similarly for @xmath430 ) .",
    "if rule 2 is not applicable , then @xmath484 and @xmath485 are non - isomorphic ( where an isomorphism would need to respect two pairs of designated vertices , namely @xmath111 and @xmath480 as well as the neighbors of @xmath310 and @xmath471 ) . assume the harder subcase that @xmath486 .",
    "when spoiler pebbles a vertex @xmath7 on the path from @xmath111 to @xmath310 by moving the pebble from @xmath108 , duplicator is forced to pebble the corresponding vertex @xmath487 on the path from @xmath480 to @xmath471 .",
    "it is easy to see that a vertex @xmath488 can be chosen so that @xmath489 and @xmath490 differ by branches containing neither @xmath111 and @xmath480 nor @xmath310 and @xmath471 .",
    "let spoiler pebble such @xmath7 as close to @xmath310 as possible .",
    "note that @xmath491 because otherwise rule 1 was applicable .",
    "now spoiler can make a counting move with the pebble released from @xmath310 to force pebbling @xmath492 and @xmath493 for which @xmath494 see fig .",
    "[ fig : tree2 ] .",
    "this complies with the goal of finding new @xmath464 and @xmath470 because @xmath495    in fact , duplicator could try to prevent the fulfillment of ( [ eq : tnoniso ] ) by forcing a choice of @xmath493 such that @xmath496 would contain either @xmath480 or @xmath471 . in the former case spoiler",
    "could win by using differences between the distances among @xmath497 and among @xmath498 . in the latter case ( [ eq : tnoniso",
    "] ) would anyway be true because @xmath499 and @xmath496 would have different orders .",
    "indeed , since rule 2 was not applicable , the choice of @xmath7 ensures that the branches of @xmath489 and @xmath490 containing @xmath310 and @xmath471 are isomorphic .",
    "thus , we would have @xmath500 ( where @xmath501 denotes the branch of @xmath489 containing @xmath310 ) while @xmath502 is strictly smaller by  ( [ eq : halforder ] ) .",
    "given @xmath454 , spoiler finds a new distinguishing branch @xmath464 in 3 rounds in the worst case .",
    "also , 2 rounds suffice to win the game once the current subtree @xmath454 has at most 4 vertices .",
    "the number of transitions from the initial branch of order at most @xmath503 to one with at most @xmath504 vertices is bounded by @xmath505 because @xmath506 becomes twice smaller each time .",
    "routine calculations ( and lemma  [ lem : distance ] ) imply the desired bound on the length of the game .",
    "the definability of trees in a finite - variable counting logic within logarithmic quantifier depth can also be derived from a work by etessami and immerman @xcite , which also implies that counting quantifiers are here not needed as long as the maximum vertex degree is bounded by a constant .",
    "curiously , theorem [ thm : cdtrees ] sheds some new light on the history of isomorphism testing for trees .",
    "the first record of this history was made by edmonds , who showed that the problem is solvable in linear time ( see theorem [ thm : cwtrees ] ) .",
    "ruzzo @xcite found an 1 algorithm under the condition that the vertex degrees of input trees are at most logarithmic in the number of vertices .",
    "miller and reif @xcite established an 1 upper bound unconditionally .",
    "they wrote @xcite : `` no polylogarithmic parallel algorithm was previously known for isomorphism of unbounded - degree trees . '' however , the 2-dimensional weisfeiler - lehman algorithm has been discussed in the literature at least since 1968 ( e.g. , @xcite ) and , as we now see by combining theorem [ thm : cdtrees ] with theorem [ thm : gve].1 , this algorithm does the job for arbitrary trees in 2 , i.e. , in parallel time @xmath507 !    to complete this historical overview , we have to mention a result by lindell @xcite who showed that isomorphism of trees is recognizable in logarithmic space .",
    "though lindell s result is best possible ( see jenner et al .",
    "@xcite ) , the solvability of the problem by so simple and natural procedure as the weisfeiler - lehman algorithm still remains a noteworthy fact .",
    "note that @xmath508 ( it is not hard to see that the color refinement algorithm requires at least @xmath509 rounds to distinguish between @xmath16 and the disjoint union of @xmath510 and @xmath511 ) . thus , theorem [ thm : cdtrees ] shows a jump from linear to logarithmic quantifier depth when the number of variables is increased just by 1 .",
    "such width - depth trade - offs were observed and studied by frer  @xcite .",
    "theorem [ thm : cwtrees ] says that 2 variables and counting quantifiers suffice to define any tree .",
    "moreover , we could well manage without counting quantifiers but then we would need to have @xmath512 variables . a simple example of a star , where @xmath513 , shows that a smaller number is not enough .",
    "the following bound is a variant of a result by immerman and kozen @xcite , who consider definability of trees represented by an asymmetric child - parent relation between vertices .",
    "[ thm : wtrees ] @xmath514 for any tree @xmath429 with the exceptions of @xmath515 .",
    "the logical depth of a tree can be bounded in terms of the maximum degree and the order .",
    "[ thm : dtrees ]    for every tree @xmath429 of order @xmath8 with maximum vertex degree @xmath516 we have @xmath517    let @xmath518 be the maximum of @xmath519 over all trees with @xmath8 vertices and maximum degree at most @xmath520 . if both @xmath521 and @xmath522 tend to infinity , then @xmath523    the upper bounds on @xmath519 comes from spoiler s strategy similar to that of the proof of theorem  [ thm : cdtrees ] , that is , spoiler pebbles a separator @xmath108 of the given tree @xmath429 and then tries to restrict the game to one of the components of @xmath452 . informally speaking ,",
    "the worst case scenario for spoiler is when @xmath452 has @xmath521 components of order about @xmath524 of two different isomorphism types , each occurring half of the time .",
    "then spoiler may need around @xmath525 extra moves to restrict game to a component of @xmath452 ( if the components of the counterpart @xmath526 are of these two types but with different multiplicities ) .",
    "thus , roughly , spoiler `` reduces '' the order by factor @xmath521 using @xmath525 moves , which gives the heuristic for the bound of theorem  [ thm : dtrees].2 .",
    "the optimality of this bound is given by a recursive construction of a tree @xmath429 ( and another tree @xmath527 ) , where at each recursion step we glue together about @xmath525 trees of two different isomorphism types at a common root .",
    "informally speaking , the _ treewidth _ of a graph tells us to which extent the graph is representable as a tree - like structure .",
    "this concept appeared in the robertson - seymour theory and , aside of its theoretical importance , found a lot of applications in design of algorithms on graphs .",
    "we do not go into any detail here , referring instead to the books @xcite and @xcite that may serve as introductions to , respectively , the structural theory of graphs and the algorithmic applications .",
    "it happens quite often that techniques applicable to trees can be extended to graphs whose treewidth is bounded by a constant . in particular , this is true for the definability parameters .",
    "[ thm : btw ]    ( grohe and mario @xcite ) if a graph @xmath1 has treewidth @xmath65 , then @xmath528 .",
    "( grohe and verbitsky @xcite ) if a graph @xmath1 on @xmath8 vertices has treewidth @xmath65 , then @xmath529 consequently , isomorphism of graphs whose treewidth does not exceed @xmath65 is recognizable by the @xmath530-dimensional weisfeiler - lehman algorithm in @xmath531 .",
    "the last claim in the theorem follows a general paradigm provided by theorem [ thm : gve].1 : a low quantifier depth implies solvability of the isomorphism problem in nc . prior to @xcite , for graphs with bounded treewidth only polynomial - time isomorphism test of bodlaender @xcite was known .",
    "very recently das , torn , and wagner @xcite put the problem in the complexity class logcfl .",
    "like theorem [ thm : cdtrees ] , the proof of theorem [ thm : btw].2 is based on separator techniques . in general , a set @xmath115 will be called a _ separator _ for graph @xmath1 if any component of @xmath532 has at most @xmath453 vertices .",
    "it is well known @xcite that all graphs of treewidth @xmath65 have separators of size @xmath120 .",
    "the separator techniques in the study of logical complexity of graphs were introduced by cai , frer , and immerman @xcite , who derived a bound @xmath533 for planar graphs from the known fact @xcite that every planar graph of order @xmath8 has a separator of size @xmath534 .",
    "in fact , this result is a particular case of theorem [ thm : btw].1 because planar graphs have treewidth bounded by @xmath535 ; see ( * ? ? ?",
    "* proposition 4.5 ) .",
    "later grohe @xcite proved that @xmath74 for all planar @xmath1 is actually bounded by a constant .    without counting quantifiers",
    "we can not have any nontrivial upper bound for the logical depth in terms of the order of a graph as long as a class under consideration contains all trees .",
    "however , some natural classes of planar graphs admit such bounds .",
    "a plane drawing of a graph is called _ outerplanar _ if all the vertices lie on the boundary of the outer face .",
    "_ outerplanar graphs _ are those planar graphs having an outerplanar drawing .",
    "the treewidth of any outerplanar graph is at most 2 .",
    "as it is well known ( see , e.g. , @xcite ) , any outerplanar graph is representable as a tree of its biconnected components .",
    "note also that an outerplanar graph is biconnected iff it has a hamiltonian cycle and that such a graph can be geometrically viewed as a dissection of a convex polygon .",
    "[ thm : planar ]    if @xmath1 is a biconnected outerplanar graph of order @xmath8 , then @xmath536    for a 3-connected planar graph @xmath1 of order @xmath8 we have @xmath537 .",
    "part 2 shows another case when theorem [ thm : gve ] is applicable .",
    "it gives an 1 isomorphism test for 3-connected planar graphs and , by a known reduction of miller and reif @xcite , for the whole class of planar graphs .",
    "this complexity bound for the planar graph isomorphism is not new ; it follows from the 1 isomorphism test for embeddings designed in @xcite and the 1 embedding algorithm in @xcite . as a possible advantage of the weisfeiler - lehman approach , note that it is combinatorially much simpler and more direct .",
    "in particular , we do not need any embedding procedure here . the best possible complexity bound for the planar graph isomorphism",
    "is recently obtained by datta et al .",
    "@xcite who design a logarithmic - space algorithm for this problem .",
    "theorem [ thm : planar].1 is proved in @xcite and is based on the existence of a 2-vertex separator in any outerplanar graph . the possibility to avoid counting quantifiers relies on certain rigidity of biconnected outerplanar graphs .",
    "the latter is related to the following geometric fact : any such graph has a unique , up to homeomorphism , outerplanar drawing .",
    "the case of 3-connected planar graphs is much more complicated because the smallest separators in such graphs can have about @xmath538 vertices ( such examples can be obtained by adding a few edges to the grid graph @xmath539 ) .",
    "the proof of theorem [ thm : planar].2 in @xcite exploits a strong rigidity property of 3-connected planar graphs : by the whitney theorem ( see , e.g. , @xcite ) , they have a unique , up to homeomorphism , embedding into the sphere .",
    "an embedding can be represented as a purely combinatorial structure , called a _ rotation system _ ( see @xcite ) , to which one can extend the concepts of definability , isomorphism , the ehrenfeucht game etc . defining rotation systems is a simpler business because they admit a kind of coordinatization and hence an analog of the halving strategy from lemma [ lem : distance ] is available for spoiler .",
    "the most essential ingredient of the proof of theorem [ thm : planar].2 is a strategy for spoiler in the ehrenfeucht game on graphs allowing him to simulate the ehrenfeucht game on the corresponding rotation systems .      no graph with treewidth @xmath540 has @xmath541 as a minor .",
    "the class of graphs embeddable into a closed 2-dimensional surface @xmath542 is closed under minors and , as follows from the robertson - seymour graph minor theorem , no graph from this class contains a minor of @xmath543 for some @xmath544 . extending his earlier work on graphs embeddable into a fixed surface @xcite , grohe @xcite recently announced a proof that , if a graph @xmath1 does not contain @xmath543 as a minor , then @xmath74 is bounded by a constant @xmath545 . the case of @xmath546",
    "is treated in detail in  @xcite .",
    "alon , seymour , and thomas @xcite proved that , if a graph @xmath1 of order @xmath8 does not contain a @xmath543 as a minor , then it has a separator of size at most @xmath547 . using this result , for all connected graphs with this property one can prove @xcite that @xmath548 .",
    "a graph is _ strongly regular _",
    "if all its vertices have equal degrees and , for some @xmath549 and @xmath550 , each pair of adjacent vertices has exactly @xmath549 common neighbors and each pair of non - adjacent vertices has exactly @xmath550 common neighbors .",
    "non - isomorphic graphs with the same order , degree , and parameters @xmath549 and @xmath550 are standard examples of a failure of the 2  algorithm .",
    "babai studies the isomorphism problem for this class in @xcite .",
    "his individualization - and - refinement technique translates into a bound @xmath551 for all strongly regular graphs of a sufficiently large order @xmath8 with the exception for the disjoint unions of complete graphs and their complements ( for which we have @xmath552 ) .",
    "further improvements are obtained by spielman  @xcite .",
    "evdokimov , ponomarenko , and tinhofer @xcite undertake an analysis of the 3-dimensional wl algorithm on the classes of cographs , interval graphs , and even directed path graphs ( the latter class extends the class of interval graphs and contains also all ptolemaic graphs , in particular , trees ) .",
    "it follows from @xcite that @xmath553 for all @xmath1 in any of these classes .",
    "the boundedness of @xmath74 for interval graphs follows also from the paper of laubner @xcite , who uses purely logical methods ( while evdokimov et al .",
    "develop an algebraic approach that , in fact , originates from the seminal work by weisfeiler and lehman ) .",
    "grohe @xcite proves that @xmath391 for all chordal line graphs . on the other hand",
    ", he shows that there are chordal graphs with @xmath554 and the same holds true for line graphs .",
    "the latter result is obtained by a reduction to the graphs with @xmath554 constructed by cai , frer , and immerman @xcite ( cf .",
    "theorem [ thm : cfi ] below ) .",
    "note that the cai - frer - immerman graphs are regular of degree 3 , where the regularity can be traded for the bipartiteness after a slight modification .",
    "recall that @xmath555 if we are motivated by the graph isomorphism problem , it is quite natural to focus on these parameters under the assumption that @xmath1 and @xmath12 have the same order ( even without saying that @xmath556 otherwise ) .",
    "distinguishing a graph @xmath1 from all non - isomorphic @xmath12 of _ the same order _ is sometimes called _",
    "identification problem_. in particular , we would like to determine or estimate the maximum of @xmath81 ( resp .",
    "@xmath557 ) as a function of @xmath558 .",
    "equivalently , what is the minimum @xmath559 such that spoiler has a winning strategy in @xmath256 for all non - isomorphic @xmath1 and @xmath12 of order  @xmath8 ?    by taking disjoint unions of complete and empty graphs , it is easy to find @xmath1 and @xmath12 with @xmath560 .",
    "bounding @xmath557 from below is much more subtle issue . using a nice nontrivial argument , cai , frer , and",
    "immerman @xcite came up with a linear lower bound .",
    "[ thm : cfi ] for infinitely many @xmath8 there are non - isomorphic graphs @xmath1 and @xmath12 both of order @xmath8 such that @xmath561 , where @xmath88 is a positive constant .",
    "the calculation of pikhurko et al .",
    "* section 7.5 ) shows that one can take @xmath562 .",
    "let us turn to upper bounds .",
    "suppose that @xmath333 and @xmath563 . before reading further",
    ", the reader might try to improve the trivial bound @xmath564 at least somewhat .",
    "it may be seen as a curious observation that @xmath565 follows from the harary version of the ulam reconstruction conjecture , open for a long time , claiming that non - isomorphic graphs of equal orders have different sets of vertex - deleted subgraphs .",
    "one solution of this exercise , giving @xmath566 , is to apply the erds - szekeres bound on ramsey numbers .",
    "it implies that every graph @xmath1 of large order @xmath8 contains a homogeneous set of more than @xmath567 vertices .",
    "spoiler pebbles the complement of such a set @xmath542 in @xmath1 .",
    "suppose that the unpebbled set is independent ( otherwise we can play on the complementary graphs ) .",
    "if duplicator is lucky , she manages to pebble the complement to an independent set @xmath568 in @xmath12 so that @xmath569 . identifying the pebbled parts , spoiler compares the number of vertices in @xmath542 and in @xmath568 with the same neighborhood .",
    "these numbers can not be identical for @xmath1 and @xmath12 and , by @xmath570 , spoiler can demonstrate this using at most @xmath571 further moves in one of the graphs .",
    "after this warm - up , we can state an almost optimal bound .",
    "[ thm : pvv ] for every two non - isomorphic graphs @xmath1 and @xmath12 of the same order @xmath8 we have @xmath572 .      in the case of the counting logic ,",
    "theorem [ thm : cfi ] provides us with infinitely many graphs @xmath1 for which @xmath573 . as",
    "usually , @xmath8 denotes the order of a graph .",
    "an upper bound easily follows from theorem [ thm : pvv ] : we have @xmath574 for all @xmath1 . though this bound does not use the power of counting quantifiers at all , we are not aware of any better bound .    consider the standard first - order logic ( without counting ) .",
    "at the first sight , everything is clear here .",
    "indeed , the general upper bound @xmath575 is attained , even for the width , by the complete graph @xmath14 and by the empty graph @xmath576 . however , these are the only two extremal graphs . in other words , @xmath577 for all @xmath1 with exception of @xmath578 . as @xmath14 and @xmath576 are the most symmetric graphs , this observation suggests two problems .",
    "the first one is to prove a better bound for a class of graphs with restrictions on the automorphism group .",
    "the second is to obtain , for as small as possible @xmath579 , an explicit or algorithmic description of all order-@xmath8 graphs whose logical depth ( resp .",
    "width ) exceeds @xmath156 .",
    "we start with the first problem .",
    "[ def : twins]let @xmath111 , @xmath108 , and @xmath135 be three vertices and @xmath580 .",
    "we say that @xmath135 _ separates _ @xmath111 and @xmath108 if @xmath135 is adjacent to exactly one of the two vertices .",
    "furthermore , we call @xmath111 and @xmath108 _ twins _ if no @xmath135 separates @xmath111 and @xmath108 ( or , equivalently , if the transposition of @xmath111 and @xmath108 is an automorphism of the graph ) . a graph is called _ twin - free _ if it has no twins .",
    "[ thm : irred ] if @xmath1 is twin - free , then @xmath581 .",
    "theorem [ thm : irred ] can not be improved to a sublinear bound . indeed , consider @xmath582 , the disjoint union of @xmath71 copies of @xmath583 .",
    "as it is easily seen , @xmath582 is twin - free and @xmath584 ( the reader is welcome to play @xmath585 on duplicator s side ) .",
    "no sublinear improvement is possible even for connected graphs : the graphs constructed by cai , frer , and immerman in theorem [ thm : cfi ] are twin - free .",
    "we prove theorem [ thm : irred ] based on lemma [ lem : ddd].1 and the ehrenfeucht theorem ( theorem [ thm : games].1 ) .",
    "that is , we design a strategy allowing spoiler to win @xmath256 for any @xmath83 , where @xmath586 . as an important additional feature of the strategy , spoiler will alternate between the graphs only once . by theorem [ thm :",
    "games].2 , this shows that our bound holds even for the logic with only one quantifier alternation ( as it is indicated by the subscript in theorem  [ thm : irred ] ) .",
    "[ def : weaksieve]let @xmath115 . given two vertices @xmath587 ,",
    "we call them _ @xmath116-similar _ and write @xmath588 if @xmath111 and @xmath108 are inseparable by any vertex in @xmath116 , i.e. , if @xmath589",
    ".    now , let @xmath590 .",
    "we say that @xmath116 _ sifts out _",
    "@xmath7 if for every @xmath591 the relation @xmath592 implies @xmath593 ( in other words , the vertex @xmath7 is uniquely identified by its adjacencies to @xmath116 ) .",
    "let @xmath594 consist of all @xmath595 and all @xmath7 sifted out by @xmath116 .",
    "we call @xmath116 a _ _ sieve _ _ if @xmath596 .",
    "furthermore , @xmath116 is called a _ weak sieve _ if @xmath597 .",
    "consider the ehrenfeucht game on non - isomorphic @xmath1 and @xmath12 and assume that @xmath116 is a sieve in @xmath1 .",
    "let spoiler pebble all vertices of @xmath116 .",
    "we leave to the reader to verify that spoiler can win in at most 2 more moves .",
    "we now describe a more advanced _ weak sieve strategy_.    [ lem : weaksieve ] if @xmath116 is a weak sieve in @xmath1 , then spoiler is able , for any @xmath83 , to win @xmath256 with @xmath598 .",
    "moreover , he does not need to jump from one graph to the other more than once during the game .",
    "first , spoiler selects all of @xmath116 .",
    "let @xmath599 be the duplicator s reply .",
    "assume that duplicator has not lost yet .",
    "for the notational simplicity let us identify @xmath116 and @xmath600 so that @xmath601 and the player s moves coincide on @xmath116 .",
    "let @xmath602 in @xmath1 and @xmath603 in  @xmath12 .",
    "it is not hard to see that spoiler wins in at most two extra moves unless the following holds . for any @xmath604",
    "there is a @xmath605 ( and vice versa ) such that @xmath606 .",
    "moreover , this bijective correspondence between @xmath607 and @xmath608 establishes an isomorphism between @xmath609 $ ] and @xmath610 $ ] .",
    "suppose that this is the case and identify @xmath607 with @xmath608 .",
    "let @xmath611 and @xmath612 .",
    "let @xmath613 and define @xmath614    if @xmath615 , spoiler wins in at most two moves .",
    "first , he selects @xmath492 .",
    "let duplicator reply with @xmath493 .",
    "assume that @xmath616 for otherwise she has already lost .",
    "as the neighborhoods of @xmath617 in @xmath607 differ , spoiler can demonstrate this by picking a vertex of @xmath607 .",
    "if @xmath618 , then spoiler selects any two vertices in @xmath619 and wins with at most one more move , as required .",
    "hence , we can assume that for any @xmath492 we have @xmath620 for some @xmath621 .",
    "since each vertex in @xmath622 is sifted out by @xmath607 , the function @xmath97 is injective .",
    "if @xmath623 , spoiler easily wins in two moves .",
    "suppose , therefore , that @xmath624 is a bijection .",
    "as @xmath333 , the mapping @xmath97 does not preserve the adjacency relation between some @xmath625 .",
    "now , spoiler selects both @xmath7 and @xmath492 .",
    "duplicator can not respond with @xmath626 and @xmath627 ; by the definition of @xmath97 spoiler can win in one extra move .",
    "theorem [ thm : irred ] immediately follows from lemma [ lem : weaksieve ] and the next lemma .",
    "any twin - free graph @xmath1 on @xmath8 vertices has a weak sieve @xmath116 with @xmath628 .",
    "given @xmath115 , let @xmath629 denote the partition of @xmath630 into @xmath631-equivalence classes .",
    "starting from @xmath632 , we repeat the following procedure .",
    "as long as there exists @xmath633 such that @xmath634 , we move @xmath111 to @xmath116 .",
    "as soon as there is no such @xmath111 , we arrive at @xmath116 which is _ @xmath635-maximal _ , that is , @xmath636 for any @xmath633 .",
    "note that @xmath637 because this inequality is true at the beginning and is preserved in each construction step . using also the inequality @xmath638 , we conclude that @xmath628 .",
    "we now prove that the @xmath116 is a weak sieve .",
    "suppose , to the contrary , that @xmath111 and @xmath108 are distinct @xmath594-similar vertices in @xmath639 .",
    "since @xmath1 has no twins , these vertices are separated by some @xmath135 .",
    "we can not have @xmath640 by the definition of @xmath594-similarity .",
    "thus @xmath641 .",
    "let @xmath642 be the class in @xmath629 including @xmath643 and @xmath644 be the class in @xmath629 containing @xmath135 .",
    "since @xmath645 , the class @xmath644 has at least one more element in addition to @xmath135 . if @xmath646 , moving @xmath135 to @xmath116 splits up @xmath642 and does not eliminate @xmath644 . if @xmath647 , moving @xmath135 to @xmath116 splits up this class and splits up or does not affect the others . in either case @xmath648 increases , giving a contradiction .",
    "the proof of theorem [ thm : irred ] is complete .",
    "this theorem was significantly extended in @xcite giving some progress on the second research problem stated above .",
    "in particular , it was shown that one can efficiently check whether or not @xmath649 for the input graph @xmath1 of order @xmath8 and , if this is not true , then one can efficiently compute the exact value of @xmath0 .",
    "also , the same holds for  @xmath2 .",
    "this result is interesting in view of the fact that algorithmic computability of the logical depth and width of a graph , even with no efficiency requirements , is unclear .",
    "a reason for this is that the question if a given first - order sentence defines some graph is known to be undecidable  @xcite .",
    "the upper bound of @xmath650 can be improved if we impose a restriction on the maximum vertex degree .",
    "[ thm : bdeg ] let @xmath651 .",
    "let @xmath1 be a graph of order @xmath8 with no isolated vertex and no isolated edge .",
    "if @xmath652 , then @xmath653 for a constant @xmath654 .",
    "theorem [ thm : bdeg ] aims at showing a constant @xmath655 strictly less than @xmath656 rather than at attempting to find the optimum @xmath655 . in the case of @xmath657 , which is simple and",
    "included just for uniformity , an optimal bound is @xmath658 . without the assumption that @xmath1 has no isolated vertex and edge",
    ", the theorem does not hold for any fixed @xmath659 .",
    "a counterexample is provided by the disjoint union of isolated edges . even under the stronger assumption that @xmath1 is connected , theorem [ thm : bdeg ] still does not admit any sublinear improvement : the cai - frer - immerman graphs in theorem [ thm : cfi ]",
    "are connected and have maximum degree  3 .",
    "in section [ s : worstcase ] we investigated the maximum values of logical parameters over graphs of order @xmath8 .",
    "now we want to know its typical values . a natural setting for this problem",
    "is given by the erds - rnyi model of a random graph @xmath89 .",
    "the latter is a random graph on @xmath8 vertices where every two vertices are connected by an edge with probability @xmath90 independently of the other pairs .",
    "a particularly important case is @xmath660 , when we have the uniform distribution on all graphs on a fixed set of @xmath8 vertices .",
    "whenever we say that for a random graph of order @xmath8 something happens _ with high probability _",
    "( abbreviated as _ whp _ ) , we mean a probability approaching @xmath661 as @xmath662 .",
    "we begin with a simple but useful observation about the color refinement algorithm described at the beginning of section [ s : wl ] : if the coloring of a graph stabilizes with all color classes becoming singletons , it can be considered a canonical vertex ordering .",
    "it turns out that this happens for almost all graphs .",
    "this result can be used to estimate the logical complexity of almost all graphs , in particular , to show that almost surely @xmath663 ( immerman and lander  @xcite ) .",
    "[ thm : bes ]    ( babai , erds , and selkow @xcite ) 2 color refinements split a random graph @xmath660 into color classes which are singletons with probability more than @xmath664n$ ] , for all large enough @xmath8 .",
    "consequently , @xmath665 with this probability .",
    "( babai and kuera @xcite ) 3 color refinements split a random graph @xmath660 into color classes which are singletons with probability more than @xmath666 , for a constant @xmath104 and all large enough @xmath8 .",
    "consequently , @xmath667 with this probability .",
    "the logical conclusions made in theorem [ thm : bes ] are based on the necessity part of theorem [ thm : wld ] .",
    "it suffices to notice that , once the color refinement splits the vertex set of an input graph @xmath1 into singletons , one extra round of the algorithm suffices to distinguish @xmath1 from any non - isomorphic graph .",
    "next , we are going to show that the upper bound of theorem  [ thm : bes].1 is best possible .",
    "let @xmath668 denote the coloring of the vertex set of a graph @xmath1 produced by the color refinement procedure in @xmath241 rounds .",
    "[ lem:1colref ] whp for @xmath669 there exists a non - isomorphic graph @xmath12 on @xmath670 such that @xmath671 for every vertex @xmath672 .",
    "let @xmath1 be a typical graph of a sufficiently large order @xmath8 .",
    "in particular , we assume that @xmath1 satisfies theorem  [ thm : bes].1 and that @xmath673 for every vertex @xmath6 of @xmath1 , where we can take e.g. @xmath674 by a simple application of chernoff s bound ( see also ( * ? ? ?",
    "* corollary  3.4 ) ) . by the pigeonhole principle",
    ", there is a set @xmath675 of @xmath676 vertices all having the same degree .",
    "another property of the random graph @xmath1 that we assume is that every set @xmath677 of size @xmath111 contains distinct vertices @xmath678 with @xmath679 and @xmath680 . indeed ,",
    "let us fix a @xmath111-set @xmath677 and estimate the probability that it violates this property .",
    "one can find at least @xmath681 edge - disjoint @xmath504-cycles inside the complete graph on @xmath116 .",
    "( for example , picking up cycles one by one arbitrarily , we get enough of them by the well - known fact that a @xmath682-free graph on @xmath111 vertices has @xmath683 edges , see , e.g. , ( * ? ?",
    "? * chapter 25.5 ) . ) for each @xmath504-cycle on vertices @xmath684 in this order , at least one of the relations @xmath685 and @xmath686 should be false , this having probability @xmath687 . by the edge - disjointness , these events for different selected cycles are mutually independent . hence @xmath116 violates the desired property with probability is at most @xmath688 .",
    "since there are @xmath689 candidates for a bad set @xmath116 , the probability that it exists is @xmath690 , giving the required .    hence , the equidegree set @xmath675 contains vertices @xmath678 with @xmath679 and @xmath680 .",
    "let @xmath12 be obtained from @xmath1 by removing edges @xmath691 and adding edges @xmath692 .",
    "this operation preserves the degree of every vertex as well as the multiset of degrees of its neighbors , that is , @xmath693 for every vertex @xmath694 .",
    "suppose that @xmath1 and @xmath12 are isomorphic .",
    "any isomorphism @xmath97 must preserve the @xmath695-colors .",
    "since @xmath695-classes are all singletons , @xmath97 has to be the identity map on @xmath696 .",
    "but then the adjacency between , e.g. , @xmath310 and @xmath6 is not preserved , a contradiction .",
    "the lemma is proved .",
    "given a typical @xmath669 , let @xmath12 be a graph satisfying lemma  [ lem:1colref ] .",
    "thus , the 2-round color refinement fails to distinguish between @xmath1 and @xmath12 . by the sufficiency part of theorem [ thm : wld ]",
    ", we have @xmath697 . as an alternative proof ,",
    "the reader can design a winning strategy for duplicator in the counting game @xmath698 .",
    "together with theorem [ thm : bes].1 , this bound gives us the exact value @xmath699 .",
    "[ thm : cdrgraph ] whp @xmath700 .",
    "we always have @xmath701 and , on the other hand , @xmath702 implies @xmath703 because any definition with quantifier depth 2 can be rewritten with using only 2 variables .",
    "it follows from theorem [ thm : cdrgraph ] that @xmath704 whp .",
    "unfortunately , we could not decide whether the typical value of @xmath705 is @xmath44 or @xmath504 , which seems to be an interesting question .",
    "[ thm : wdrgraph ] fix an arbitrarily slowly increasing function @xmath706 .",
    "then we have whp that @xmath707    we first prove the lower bound .",
    "[ def : alice]for an integer @xmath708 , we say that a graph @xmath1 has the _ @xmath65-extension property _ if , for every two disjoint @xmath709 with @xmath710 , there is a vertex @xmath711 adjacent to all @xmath595 and non - adjacent to all @xmath712 .",
    "[ lem : alice1 ] if both @xmath1 and @xmath12 have @xmath65-extension property , then @xmath713 .    by theorem [ thm : games].3 it suffices to design a strategy allowing duplicator to survive in @xmath714 arbitrarily long .",
    "suppose that spoiler puts pebble @xmath90 on a new position @xmath108 in one of the graphs , say , @xmath1 .",
    "let @xmath116 ( resp .",
    "@xmath607 ) denote the set of pebbled vertices in @xmath12 whose counter - parts in @xmath1 are adjacent ( resp .",
    "non - adjacent ) to @xmath108 .",
    "duplicator moves the other copy of @xmath90 to a vertex @xmath492 with the given adjacencies to @xmath715 whose existence is guaranteed by the @xmath65-extension property .",
    "[ lem : alice2 ] let @xmath716 be a real constant .",
    "then the @xmath65-extension property holds for @xmath660 whp for any @xmath717 .",
    "let @xmath8 be large .",
    "any particular @xmath116 and @xmath607 with @xmath718 falsify the @xmath65-extension property with probability @xmath719 .",
    "since the number of such pairs is @xmath720 , a random graph @xmath660 does not have the @xmath65-extension property with probability at most @xmath721 the former inequality is true only if @xmath722 but this makes no problem because the @xmath65-extension property implies itself for all smaller values of parameter @xmath65 .",
    "since the function @xmath723 is monotone , the @xmath65-extension property fails with the probability bounded from above by @xmath724 as it was claimed .",
    "fix @xmath716 .",
    "let @xmath8 be sufficiently large and set @xmath725 .",
    "by lemma [ lem : alice2 ] , @xmath669 has the @xmath65-extension property whp .",
    "let @xmath12 be a graph which also possesses the @xmath65-extension property and is non - isomorphic to @xmath1 .",
    "the existence of such a graph follows also from lemma [ lem : alice2 ] : given @xmath1 , let @xmath726 be another , independent copy of a random graph .",
    "it should be only noticed that @xmath727 with probability at most @xmath728 . by lemma [ lem : alice1 ]",
    ", we have @xmath729 thereby proving the lower bound of theorem  [ thm : wdrgraph ] .",
    "to prove the upper bound , we employ the _ weak sieve strategy _ that was designed in section [ ss : generaldw ] .",
    "lemma [ lem : weaksieve ] allows us to estimate the parameter @xmath730 by the size of a weak sieve existing in @xmath1 .",
    "the upper bound of theorem [ thm : wdrgraph ] follows from lemmas [ lem : wsievergraph ] below , that gives us a good enough bound for the size of a weak sieve in a random graph .",
    "the paper  @xcite states a slightly weaker upper bound than that in theorem  [ thm : wdrgraph ] ( namely , @xmath731 there ) .",
    "the current more precise estimate is due to joel spencer ( unpublished ) .",
    "[ lem : wsievergraph ] fix an arbitrarily slowly increasing function @xmath706 .",
    "then whp @xmath660 has a weak sieve of size at most @xmath732 .",
    "we will consider a random graph @xmath660 on an @xmath8-vertex set @xmath733 . fix @xmath677 with @xmath734 , where @xmath735 .",
    "we generate @xmath660 in two stages .",
    "_ stage 1 : _ reveal the edges between @xmath116 and @xmath736 ( needless to say , each such edge appears with probability 1/2 independently of the others ) .",
    "our goal at this stage is to show that @xmath594 is large whp .",
    "a fixed @xmath737 is sifted out by @xmath116 with probability @xmath738 by linearity of expectation @xmath739}=(n-|x|)n^{-o(1)}=n^{1-o(1)}.\\ ] ] we can now apply the martingale techniques to show that whp @xmath740 is concentrated near its mean value . more precisely , we need the following estimate : @xmath741}-2\\lambda\\sqrt{n-|x|}\\ , \\right ] } < { \\mathrm{e}}^{-\\lambda^2/2}\\ ] ] for any @xmath742 , where @xmath743}$ ] denotes the probability of an event @xmath286 .    to prove it , consider the probability space consisting of all functions @xmath744 .",
    "define a random variable @xmath745 on this space by setting @xmath746 to be equal to the number of values in @xmath747 taken on by @xmath748 exactly once .",
    "note that , if @xmath748 and @xmath749 differ only at one point , then @xmath750 .",
    "construct an appropriate martingale as explained in the alon - spencer book ( * ? ? ?",
    "* chapter 7.4 ) .",
    "namely , let @xmath751 and define a sequence of auxiliary random variables @xmath752 by @xmath753}$ ] .",
    "by azuma s inequality ( see ( * ? ? ?",
    "* theorems 7.2.1 and 7.4.2 ) ) , for all @xmath742 we have @xmath754}-2\\lambda\\sqrt m\\ , \\right]}<{\\mathrm{e}}^{-\\lambda^2/2},\\ ] ] which is exactly what is claimed by  ( [ eq : sieve1 ] ) .",
    "by ( [ eq : sieve1 ] ) we have whp that @xmath755 conditioning on @xmath594 satisfying this bound , we go to the next stage of generating  @xmath660 .",
    "_ stage 2 : _ reveal the edges inside @xmath736 .",
    "it is enough to show that @xmath756 whp .",
    "if the last claim is false , then there are @xmath757 having the same adjacencies to @xmath758 .",
    "this happens with probability no more than @xmath759 the proof is complete .",
    "theorem [ thm : wdrgraph ] shows rather close lower and upper bounds for the logical width and depth of a random graph @xmath660 . surprisingly , even this can be improved .",
    "[ thm : precise ] for infinitely many @xmath8 we have whp @xmath760    this upper bound is at most by @xmath761 larger than the lower bound of theorem [ thm : wdrgraph ] .",
    "it follows that , for infinitely many @xmath8 , the parameters @xmath762 with @xmath205 , @xmath0 , and @xmath2 are all concentrated on at most @xmath763 possible values ( while some extra work , see  ( * ? ? ?",
    "* section  4.3 ) , gives a 5-point concentration ) .",
    "[ thm : rtree ] let @xmath764 denote a tree on the vertex set @xmath765 selected uniformly at random among all @xmath766 such trees .",
    "whp we have @xmath767 and @xmath768 .",
    "the lower bound for @xmath769 immediately follows from the following property of a random tree : whp @xmath764 has a vertex adjacent to @xmath770 leaves .",
    "note that the upper bound for @xmath771 does not follow directly from theorem [ thm : dtrees ] because whp @xmath772 ( see moon @xcite ) .",
    "we will write @xmath773 to say that a sentence @xmath11 is true on a graph @xmath1 .",
    "let @xmath774}$ ] .",
    "the _ 0 - 1 law _ established by glebskii et al .",
    "@xcite and , independently , by fagin @xcite says that , for each @xmath11 , @xmath775 approaches 0 or 1 as @xmath662 .",
    "denote the limit by @xmath776 .",
    "define the _ convergency rate function _ for the 0 - 1 law by @xmath777 note that the maximization here can be restricted to a finite set by theorem  [ thm : inequi2].1 .",
    "therefore , the standard version of the 0 - 1 law implies that @xmath778 as @xmath662 for any fixed @xmath65 .",
    "naor , nussboim , and tromer  @xcite showed that @xmath779 .",
    "another result in  @xcite states that one can choose @xmath780 and @xmath781 such that the probability that @xmath89 has a @xmath782-clique is bounded away from 0 and 1 .",
    "thus for this probability @xmath783 the 0 - 1 law does not hold with respect to formulas of depth  @xmath782 .",
    "the following theorem sharpens slightly the first part of the above result and improves on the second part in two aspects : we do not need to change the probability @xmath784 and we get an almost best possible upper bound .",
    "let @xmath785 with constant @xmath88 .    if @xmath786 , then @xmath787 as @xmath662 .",
    "if @xmath788 , then @xmath789 does not tend to 0 as @xmath662 .",
    "more strongly , for every @xmath790 $ ] there is a sequence of formulas @xmath791 ( where @xmath792 ) with @xmath793 such that @xmath794 as @xmath795 .",
    "part 2 follows from theorem [ thm : precise ] .",
    "the latter implies that ( for infinitely many @xmath8 ) actually _ any _ property @xmath796 of graphs on @xmath8 vertices can be `` approximated '' by a first - order sentence of depth at most @xmath797 . indeed , take the conjunction of defining formulas over all graphs in @xmath796 of order @xmath8 and depth at most @xmath797 .",
    "the omitted graphs constitute negligible proportion of all graphs by theorem  [ thm : precise ] .",
    "we now prove part  1 . like the proof in",
    "@xcite we use the extension property , but we argue in a slightly different way .    part  1 let @xmath798 denote a first - order statement of quantifier depth @xmath65 expressing the @xmath799-extension property .",
    "lemma  [ lem : alice2 ] provides us with an infinitesimal @xmath800 such that @xmath801    we will consider @xmath802 on the range @xmath803 .",
    "this function is decreasing for @xmath804 and increasing for @xmath805 .",
    "since @xmath806 , for any @xmath807 there is some @xmath808 such that the conditions @xmath809 and @xmath810 are equivalent .",
    "we fix a value @xmath807 so that @xmath811 whenever @xmath809 .",
    "note that @xmath812    the result readily follows from the following fact .    if @xmath813 , then for every first - order statement @xmath11 with @xmath127 we have latexmath:[\\[\\label{eq : twoalpha }     we will prove first a more modest bound .    if @xmath813 , then for every first - order statement @xmath11 with @xmath127 we have latexmath:[\\[\\label{eq : ahalf }     consider a pair of integers @xmath65 and @xmath8 such that @xmath813 .",
    "let @xmath11 be a first - order statement with @xmath127 .",
    "without loss of generality , suppose that @xmath816 .",
    "if @xmath817 for some @xmath818 , let @xmath818 denote the largest such number .",
    "for @xmath819 we have @xmath820 .",
    "let @xmath821 and @xmath822 be independent random graphs with , respectively , @xmath818 and @xmath823 vertices .",
    "note that @xmath824}\\ge{\\mathbb{p}\\left[\\ , g_n\\models\\phi\\,\\,\\&\\,\\,g_m\\not\\models\\phi\\ , \\right]}>\\frac14.\\ ] ] on the other hand , lemma [ lem : alice1 ] implies that @xmath825}\\ge{\\mathbb{p}\\left[\\ , g_n\\models e_k\\,\\,\\&\\,\\,g_m\\models e_k\\ , \\right]}= p_n(e_k)p_m(e_k).\\ ] ] it follows that @xmath826 and , therefore , @xmath827 or @xmath828 . comparing this with ( [ eq : sqrt3 ] )",
    ", we conclude that @xmath829 or @xmath830 , which implies that @xmath831 .",
    "the desired bound ( [ eq : ahalf ] ) follows now by the definition of  @xmath818 .",
    "consider a pair of integers @xmath65 and @xmath8 such that @xmath813 .",
    "let @xmath11 be a first - order statement with @xmath127 .",
    "let @xmath832 and @xmath833 be two independent copies of @xmath660 . by lemma [ lem : alice1 ] , @xmath834}\\ge{\\mathbb{p}\\left[\\ , g'\\models e_k\\,\\,\\&\\,\\,g''\\models e_k\\ , \\right]}=p_n(e_k)^2.\\ ] ] on the other hand ,",
    "@xmath834}\\le{\\mathbb{p}\\left[\\ , g'\\mathrm{\\ and\\ } g''\\mathrm{\\ are\\ not\\ distinguished\\ by\\ } \\phi\\ , \\right]}=p_n(\\phi)^2+(1-p_n(\\phi))^2.\\ ] ] combining the two bounds , we obtain @xmath835 using claim b , we immediately infer from here that @xmath836 the desired bound ( [ eq : twoalpha ] ) follows now from  ( [ eq : convergence ] ) .",
    "we now take a dynamical view on a random graph @xmath89 by letting the edge probability @xmath90 vary . with @xmath90 varying from 0 to 1",
    ", @xmath89 evolves from empty to complete .",
    "we want to trace the changes of its logical complexity during the evolution .",
    "since the definability parameters do not change when we pass to the complement of a graph , we can restrict ourselves to case @xmath837 .",
    "when @xmath90 is a constant , one can estimate @xmath0 within additive error @xmath838 .",
    "[ thm : gnp ] if @xmath839 is constant , then whp @xmath840 where @xmath841 and @xmath842 .",
    "similarly to theorem [ thm : wdrgraph ] , the lower bound is based on the @xmath65-extension property .",
    "however , the proof of the upper bound is quite different . in particular",
    ", we have hardly any control on the alternation number in this result .",
    "the argument is rather complicated so we give only a brief sketch , concentrating more on its logical rather than probabilistic component .",
    "let @xmath843 be typical and @xmath844 be arbitrary .",
    "let @xmath670 and @xmath845 .",
    "for a sequence @xmath116 of vertices , let @xmath846 and @xmath847 $ ] .",
    "let the analogous notation ( with primes ) apply to @xmath832 .",
    "if there is @xmath672 such that for every @xmath848 we have @xmath849 , then spoiler selects @xmath6 .",
    "whatever duplicator s reply @xmath848 is , spoiler reduces the game to non - isomorphic graph @xmath850 and @xmath851 .",
    "we expect that @xmath852 and @xmath850 is also ` typical ' .",
    "thus spoiler used one move to reduce the order of the random graph by a factor of @xmath90 , which should lead to the upper bound @xmath853 .",
    "suppose now that there are @xmath672 and distinct @xmath854 such that @xmath855 .",
    "spoiler selects @xmath856 .",
    "assume that duplicator replies with @xmath857 , for otherwise @xmath858 and spoiler proceeds as above .",
    "now spoiler selects @xmath493 ; let @xmath859 be the duplicator s reply .",
    "we can assume that @xmath860 , for otherwise spoiler applies the inductive strategy to the @xmath861-game , where the order of the random graph is reduced by factor @xmath862 .",
    "let @xmath863 and @xmath864 .",
    "a first moment calculation shows that there is vertex @xmath865 such that no vertex of @xmath866 has the same neighborhood in @xmath675 as @xmath108 .",
    "let spoiler select @xmath108 and let @xmath867 be the duplicator s reply .",
    "two copies @xmath868 and @xmath869 of a ` typical ' graph @xmath870 have a large vertex intersection .",
    "another first moment calculation shows that whp there is only one way to achieve this , namely that the ( unique ) isomorphism @xmath871 between @xmath868 and @xmath869 is in fact the identity on @xmath872 .",
    "but then @xmath873 has the same adjacencies to @xmath872 as @xmath435 .",
    "spoiler selects @xmath873 and wins the game in at most one extra move .",
    "finally , up to a symmetry it remains to consider the case that there is a bijection @xmath874 such that for any @xmath672 we have @xmath875 .",
    "as @xmath876 , there are @xmath877 such that @xmath748 does not preserve the adjacency between @xmath7 and @xmath492 .",
    "spoiler selects @xmath7 .",
    "we can assume that duplicator replies with @xmath878 for otherwise spoiler reduces the game to @xmath879 .",
    "now , spoiler selects @xmath492 to which duplicator is forced to reply with @xmath880 .",
    "let @xmath881 .",
    "assume that @xmath882 for otherwise spoiler applies the inductive strategy to these graphs .",
    "but then @xmath883 is an induced subgraph of @xmath884 , a property that we do not expect to see in a random graph .    in order to convert this rough idea into a rigorous proof one",
    "has to show that whp as long as the subgraphs @xmath885 that can appear in the game are sufficiently large , they have all required properties . also , one has to design spoiler s strategy to deals small subgraphs of @xmath89 at the end of the game .",
    "all details can be found in  ( * ? ? ?",
    "* section  3 ) .",
    "it is interesting to investigate the behavior , e.g. , of @xmath886 when @xmath887 tends to zero . in particular , it is open whether , for every constant @xmath888 and @xmath889 we have whp @xmath890 .",
    "some restriction on @xmath783 from below is necessary here .",
    "indeed , let @xmath1 be an arbitrary non - empty graph ( i.e. , @xmath1 has at least one edge ) and let @xmath832 be obtained from @xmath1 by adding one more isolated vertex .",
    "it is easy to see that @xmath891 and @xmath892 , where @xmath893 denotes the number of isolated vertices of @xmath1 .",
    "it follows that @xmath894 it is well known ( see , e.g. , @xcite ) that @xmath895 whp as long as @xmath896 .",
    "in particular , we have @xmath897 whenever @xmath898 .    in some cases , the lower bounds ( [ eq : d0 ] ) are sharp .    [",
    "lem : comps ] let @xmath899 denote the number of connected components in a graph @xmath1 isomorphic to a graph @xmath900 .",
    "suppose that a non - empty graph @xmath1 satisfies @xmath901 then @xmath902 .",
    "let us show that @xmath903 for any @xmath83 .",
    "let @xmath900 be such that @xmath904 .",
    "for definiteness suppose that @xmath905 .",
    "spoiler marks @xmath906 components of @xmath12 which are isomorphic to @xmath900 by pebbling one vertex in each of them .",
    "duplicator is forced either to mark one of the @xmath900-components of @xmath1 twice ( by pebbling two vertices , say , @xmath111 and @xmath108 in it ) or to mark a component @xmath907 of @xmath1 which is not isomorphic to @xmath900 . in the former case spoiler wins by pebbling a path from @xmath111 to @xmath108 . in the latter case spoiler pebbles completely the @xmath900-component of @xmath12 corresponding to @xmath907 .",
    "duplicator is forced to pebble a connected part @xmath908 of @xmath907 . if she has not lost yet , then @xmath909 and hence @xmath908 is a proper subgraph of @xmath907 .",
    "spoiler wins by pebbling another vertex in @xmath907 which is adjacent to a vertex in  @xmath908 . altogether at most @xmath910 moves are made .",
    "it remains to prove the upper bound on the width .",
    "the last move may require using the @xmath911-th pebble .",
    "however , for this purpose spoiler can reuse a pebble placed earlier in a component different from @xmath907 .",
    "this trick is unavailable only if @xmath912 and @xmath913 or if @xmath914 and @xmath915 .",
    "in both cases spoiler can win in at most @xmath916 rounds ( and at most one alternation ) .",
    "moreover , if this number is at least @xmath910 , then @xmath914 and @xmath1 has no component with @xmath917 or more vertices by  ( [ eq : comps ] ) . in this case",
    ", spoiler can win in at most @xmath917 moves .",
    "[ thm : invn ] if @xmath918 with @xmath919 being an arbitrary bounded function of @xmath8 , then @xmath920 whp .",
    "it is well known that , observing the evolution process in the scale @xmath918 , at the point @xmath921 we encounter the phase transition . if @xmath922 , whp all components of @xmath89 have @xmath923 vertices each ; if @xmath924 , there appears a unique exception , the so - called _ giant _ component with a linear number of vertices .",
    "one can check that , for any @xmath925 , condition ( [ eq : comps ] ) holds whp ( even for the giant component if it exists ) , where @xmath926 is a root of some explicit equation , see  ( * ? ? ?",
    "* theorem 19 ) .",
    "then , by lemma [ lem : comps ] and equality ( [ eq : d0distr ] ) , @xmath927 and @xmath928 ( and all parameters in between ) are @xmath929 .",
    "when @xmath88 is larger than @xmath930 , then whp the giant component of @xmath89 violates  ( [ eq : comps ] ) : its order exceeds the number of isolated vertices .",
    "this case is handled in  @xcite as follows .",
    "denote the giant component of @xmath843 by @xmath823 .",
    "given @xmath83 , we have to design a strategy allowing spoiler to fast enough win the ehrenfeucht game on @xmath1 and @xmath12 .",
    "the strategy in the proof of lemma [ lem : comps ] does not work only if @xmath931 or @xmath932 .",
    "we adapt it for these cases so that spoiler , instead of selecting all vertices of @xmath823 , plays an optimal strategy for @xmath823 using at most @xmath933 moves ( instead of @xmath934 moves as earlier ) .",
    "first , we can assume that no component of @xmath12 has diameter @xmath8 or more .",
    "otherwise spoiler pebbles @xmath111 and @xmath108 at distance @xmath8 in @xmath12 . for duplicator s responses @xmath480 and @xmath435 in @xmath1 we have either @xmath935 or @xmath936 .",
    "hence spoiler wins in less than @xmath937 moves .",
    "second , we can assume that duplicator always respects the connectivity relation ( two vertices are in the relation if they are connectable by a path ) . indeed , suppose that @xmath111 and @xmath108 belong to the same connected component @xmath900 in one of the graphs while their counter - parts @xmath480 and @xmath435 are in different components of the other graph .",
    "then spoiler wins in less than @xmath938 moves .    under this assumption",
    ", spoiler easily forces that , starting from the 2nd round , the play goes on components of @xmath1 and @xmath12 , of which exactly one is isomorphic to @xmath823 .",
    "one of the main results of  @xcite states that whp @xmath939 which implies that spoiler is able to win quickly and proves the theorem .",
    "the upper bound ( [ eq : giant ] ) is obtained roughly as follows . by iteratively removing vertices of degree 1 from the giant component @xmath823 , one obtains the _ core _ @xmath84 of @xmath823 ( that is",
    ", @xmath84 is a maximum subgraph with minimum degree at least @xmath940 ) .",
    "the _ kernel _ @xmath941 of @xmath1 is the _ serial reduction _ of @xmath84 , that is , we iterate the following to obtain @xmath941 : if there is a vertex @xmath6 of degree @xmath940 , then we remove @xmath6 but add edge @xmath942 , where @xmath7 and @xmath492 are the two neighbors of @xmath6 .",
    "the kernel may have loops and multiple edges and has to be modeled as a _",
    "colored graph_. the original graph @xmath1 can be encoded by specifying its kernel @xmath941 and the structure of rooted trees that correspond to each vertex or edge of @xmath941 , the latter being viewed as a total coloring of @xmath941 .",
    "it happens that whp every vertex @xmath6 of @xmath941 can be _ identified _ by a small - depth formula @xmath943 with one free variable ( that is @xmath944 while @xmath945 for every other vertex @xmath946 ) in the first - order language of colored graphs .",
    "thus one can define @xmath941 succinctly by stating that for every @xmath947 there is a unique vertex satisfying @xmath943 , that every vertex satisfies @xmath943 for some @xmath948 , and by listing the adjacencies between vertices identified by @xmath943 and @xmath949 for every @xmath950 .",
    "the core @xmath84 can now be defined by specifying the length of the path corresponding to each edge of @xmath941 , while the giant component @xmath823 can be defined by specifying the random rooted trees hanging on the vertices of @xmath84 using theorem  [ thm : rtree ] ( which relies in part on theorem  [ thm : dtrees ] ) .",
    "the bound ( [ eq : giant ] ) is optimal up to a constant factor .",
    "this follows from the fact that whp the giant component @xmath823 has a vertex @xmath108 adjacent to at least @xmath951 leaves .",
    "( indeed , consider the graph @xmath952 that is obtained from @xmath823 by attaching an extra leaf at @xmath108 . )",
    "we believe that the lower bound is sharp , that is , whp @xmath953 , but we were not able to settle this question .    finally , we consider edge probabilities @xmath954 with rational @xmath955 .",
    "such @xmath90 occur as threshold functions for ( non-)appearance of particular graphs as induced subgraphs in @xmath89 .",
    "what is relevant to our subject is that such @xmath90 show an irregular behavior of @xmath89 with respect to first - order properties .    since the treatment of the general case of rational",
    "@xmath125 would require a considerable amount of technical work , the paper  @xcite focuses on a sample value @xmath956 , when @xmath886 falls down and becomes so small as it is essentially possible ( cf .",
    "section  [ s : best ] ) .",
    "[ thm : arithm ] if @xmath957 , then whp @xmath958    the upper bound is based on the following ideas .",
    "let the predicate @xmath959 state that these 4 distinct vertices have no common neighbor .",
    "its probability is @xmath960 and its values over different 4-tuples are rather weakly correlated .",
    "thus , if for a set @xmath286 and a vertex @xmath961 , we define @xmath962 be the 3-uniform hypergraph on @xmath286 with @xmath963 being a hyperedge if and only if @xmath964 holds , then @xmath962 behaves somewhat like a random hypergraph . as it is shown in (",
    "* lemma  21 ) , one can find 4 vertices such that their common neighborhood @xmath286 is relatively large ( namely , @xmath965 ) and yet there are vertices @xmath966 such that hypergraphs @xmath967 and @xmath968 encode in some way the multiplication and addition tables for an initial interval of integers .",
    "also , any integer can be succinctly defined in first - order logic with arithmetic operations .",
    "roughly speaking , in order to define an integer @xmath368 , one can write it in binary @xmath969 and specify for every @xmath323 the @xmath96-th bit @xmath970 ; crucially , the same binary expansion trick can be used recursively to specify the index @xmath96 , and so on .",
    "this allows us to identify vertices @xmath286 with very small depth .",
    "next , we consider the set @xmath287 of vertices of @xmath1 that have exactly 4 neighbors in @xmath286 and are uniquely determined by this . again , the vertices of @xmath287 are easy to identify ( just list the 4 neighbors in @xmath286 ) . finally ,",
    "if @xmath286 was chosen carefully , then each vertex @xmath310 of @xmath1 is uniquely identified by the hypergraph @xmath971 .",
    "( the reason that we need an intermediate set @xmath287 is that the number of possible 3-uniform hypergraphs @xmath972 is at most @xmath973 , that is , too small . ) of course , many technical difficulties arise when one tries to realize this approach .",
    "the lower bound in theorem  [ thm : arithm ] is very general .",
    "we use only the simple fact that any particular unlabeled graph with @xmath71 edges is the value of @xmath89 , where @xmath974 , with probability at most @xmath975 let @xmath976 be the number of non - isomorphic graphs definable with depth at most @xmath65 .",
    "then @xmath977}\\le f(k)\\exp { \\left\\ {   -(1/2-o(1))n^{7/4 }   \\right\\}}$ ] . by theorem [ thm : inequi ] ,",
    "if @xmath979 , we have @xmath980 and hence @xmath977}=o(1)$ ] .    the above idea ( arithmetization of certain vertex sets in graphs ) has been previously used by spencer  ( *",
    "* section  8) to obtain non - convergence and non - separability results on the example of @xmath89 with @xmath981 .",
    "so far we have considered the evolution of the logical complexity of a random graph in the standard logic with no counting .",
    "we conclude this section with an extension of theorem [ thm : bes ] .",
    "[ thm : czpa ] let @xmath783 be any function of @xmath8 such that @xmath982 where @xmath983 as @xmath662 .",
    "then 2 color refinements split a random graph @xmath89 into color classes which are singletons with probability that is higher than @xmath984 for each constant @xmath104 and all large enough @xmath8 .",
    "consequently , @xmath985 with this probability .",
    "note that , in the case of @xmath784 , this result improves the probability bound in part 1 of theorem [ thm : bes ] , while the probability bound in part 2 is still better .    by elaborating on the argument of lemma [ lem:1colref ]",
    ", we are able to supply theorem [ thm : czpa ] with the matching lower bound ( that is , @xmath986 whp ) within the range @xmath987 .",
    "as in the preceding sections , we consider the logical depth of graphs with a given number of vertices @xmath8 . we know that the maximum value @xmath988 is attained by the complete and empty graphs ( and only by them ) and",
    "that the typical values lie around @xmath100 ( see theorem [ thm : wdrgraph ] ) .",
    "now we are going to look at the minimum .",
    "we already have a good starting point : by theorem [ thm : arithm ] , there are graphs with @xmath989 in order to get such examples , we have to generate a random graph with the edge probability @xmath990 . in section [ ss:3constr ]",
    "we give three explicit constructions achieving the same bound . in section [ ss : succfunc ]",
    "we introduce the _ succinctness function _ @xmath991 and give an account of what is known about it .",
    "section [ ss : zeroalt ] is devoted to the question of how succinctly we can define graphs if we are not allowed to make quantifier alternations . in section [ ss:2appl ] the bounds on the succinctness function are applied to proving separations results for logical parameters of graphs , in particular , for @xmath0 and  @xmath3 .",
    "we describe a `` padding '' operation that was invented by joel spencer ( unpublished ) .",
    "it converts any graph @xmath1 to an exponentially larger graph @xmath992 with the logical depth larger just by 1 .",
    "@xmath992 includes @xmath1 as an induced subgraph .",
    "in addition , for every subset @xmath116 of @xmath670 , the graph @xmath992 contains a vertex @xmath993 . denote the set of these vertices by @xmath994 .",
    "there is no edge inside @xmath994 but there are some edges between @xmath733 and @xmath994 .",
    "specifically , @xmath694 is adjacent to @xmath993 iff @xmath995 . in particular , @xmath996 is isolated and @xmath997 .",
    "vertex @xmath998 will play a special role in our first - order definition of @xmath992 .",
    "first of all , we will say that there is a vertex @xmath88 ( assuming @xmath999 ) whose neighborhood spans in @xmath992 a subgraph isomorphic to @xmath1 .",
    "this can be done by relativizing a formula @xmath1000 defining @xmath1 to @xmath1001 .",
    "that is , each universal quantification @xmath1002 in @xmath1000 has to be modified to @xmath1003 and each existential quantification to @xmath1004 denote the relativized version of @xmath1000 by @xmath1005 .",
    "note that relativization does not change the quantifier depth .",
    "a sentence defining @xmath992 can now look as follows : @xmath1006 where we use harmless shorthands for simple first - order expressions .",
    "it is easy to see that @xmath1007 and that , if @xmath1008 is a _ @xmath1009-formula _ ( that is , every chain of nested quantifiers is a string of this form ) , then @xmath1010 stays in this class as well .",
    "consider now a sequence of graphs @xmath1011 where @xmath1012 , the single - vertex graph , and @xmath1013 .",
    "since @xmath1014 , we have @xmath1015 .",
    "it follows that @xmath1016 .",
    "suppose that we have a set @xmath84 of @xmath8-vertex graphs , each of logical depth at most @xmath521 .",
    "our goal is to construct a much larger set @xmath1017 of graphs with a much larger number of vertices @xmath1018 and logical depth bounded by @xmath1019 .",
    "an additional technical condition is that all the graphs have diameter 2 .",
    "we know from theorem [ thm : wdrgraph ] that almost all graphs on @xmath8 vertices have logical depth less than @xmath100 and it is well known that they have diameter 2 . choosing a sufficiently large @xmath8 , we can start with @xmath84 being the class of all such graphs .",
    "since almost all graphs are asymmetric , we have @xmath1020 . just for the notational simplicity ,",
    "we prefer that @xmath1021 is even .    for each @xmath1022 such that @xmath1023 , the set @xmath1017 contains graph @xmath1024 that is , we take the vertex disjoint union of all graphs in @xmath542 and complement it . for convenience ,",
    "we bound the logical depth of the complement @xmath1025 rather than that of @xmath1 . given an arbitrary @xmath1026 , we analyze the ehrenfeucht game on the two graphs .",
    "if @xmath12 has a connected component of diameter at least 3 , spoiler pebbles vertices @xmath111 and @xmath108 in @xmath12 at the distance exactly 3 from one another . for duplicator s responses @xmath480 and @xmath435 in @xmath1027 , either @xmath1028 or @xmath936 . in any case ,",
    "spoiler wins within the next 2 moves .",
    "suppose from now on that all components of @xmath12 have diameter at most 2 .",
    "this condition allows us to assume that duplicator respects the connectivity relation for otherwise spoiler wins with one extra move ( which will be added to the total count of rounds ) .    if one of the graphs , @xmath1027 or @xmath12 , has a connected component @xmath286 non - isomorphic to any component of the other graph , spoiler pebbles a vertex in @xmath286 .",
    "let @xmath287 be the component of the other graph where duplicator responds .",
    "starting from the second round , spoiler plays the ehrenfeucht game on non - isomorphic graphs @xmath286 and @xmath287 and wins in at most @xmath521 moves .",
    "if such a component does not exist , @xmath1027 must have a component @xmath286 with at least two isomorphic copies in @xmath12 . then in the first two rounds",
    "spoiler pebbles vertices in these two .",
    "duplicator is forced at least once to respond in a component @xmath287 of @xmath1027 non - isomorphic to @xmath286 , which is an already familiar configuration .",
    "thus , @xmath1029 can be at most 3 larger than the maximum logical depth of graphs in @xmath84 . at the same time @xmath1030 has the much larger number of vertices , namely @xmath1031 .",
    "it follows that @xmath1032 for any @xmath1 in @xmath1017 .",
    "note that any graph in @xmath1017 is the complement of a disconnected graph and hence has diameter 2 .",
    "this allows us to iterate the construction .",
    "say , for any @xmath1033 we get @xmath1034 and so on .",
    "if we fix the initial class @xmath84 , the iteration procedure gives us graphs with @xmath1035 .",
    "this bound is worse than in the preceding section but the extra factor of 3 can be eliminated if spoiler plays more smartly ( see  @xcite ) .",
    "the two previous examples were artificially constructed with the aim to ensure low quantifier depth .",
    "now we present a natural class of graphs admitting succinct definability .",
    "the _ radius _ of a graph @xmath1 is defined by @xmath1036 , where @xmath1037 denotes the eccentricity of a vertex @xmath108 .",
    "a vertex @xmath108 is _ central _ if @xmath1038 .",
    "any tree has either one or two central vertices ( see , e.g. , ( * ? ? ?",
    "* chapter 4.2 ) ) .",
    "[ lem : treedr ] let @xmath429 be an asymmetric tree with @xmath1039 . then @xmath1040 .",
    "we will design a strategy for spoiler in the ehrenfeucht game on @xmath429 and a non - isomorphic graph @xmath430 .",
    "the reader that took the effort to reconstruct the proof of theorem [ thm : wtrees ] will now definitely benefit .",
    "we can assume that @xmath429 and @xmath430 have equal diameters ( in particular , @xmath430 is connected ) for else spoiler wins in less than @xmath1041 moves by lemma [ lem : distance ] . if @xmath430 is a non - tree , let spoiler pebble a vertex @xmath435 on a cycle in @xmath430 . by this move spoiler",
    "forces the game on @xmath1042 and @xmath1043 , where @xmath108 is duplicator s response in @xmath429 . if @xmath108 is a leaf , spoiler wins in two moves . otherwise @xmath1042 is disconnected , while @xmath1044 .",
    "lemma [ lem : distance ] applies again and spoiler wins in less than @xmath1045 moves .",
    "assume , therefore , that @xmath430 is a tree too .",
    "call a tree _ diverging _ if every vertex @xmath310 splits it into pairwise non - isomorphic branches , where each branch is considered rooted at the respective neighbor of @xmath310 ( an isomorphism of rooted trees has to match their roots )",
    ". any asymmetric tree is obviously diverging .",
    "on the other hand , if a tree is diverging , it is either asymmetric or has a single nontrivial automorphism and the latter transposes two central vertices .",
    "suppose that @xmath430 is diverging .",
    "in the first round spoiler pebbles a central vertex @xmath108 of @xmath429 and duplicator responds with a vertex @xmath435 in @xmath430 .",
    "as it is easily seen , at least one of @xmath1042 and @xmath1043 has a branch @xmath287 non - isomorphic to any branch in the other tree .",
    "spoiler restricts further play to @xmath287 by pebbling its root . continuing in this fashion ,",
    "that is , each time finding a matchless subbranch , spoiler forces pebbling two paths in @xmath429 and @xmath430 emanating from @xmath108 and @xmath435 respectively .",
    "spoiler wins at latest when the path in @xmath429 reaches a leaf .",
    "so suppose that @xmath430 is not diverging .",
    "let @xmath435 be a central vertex of @xmath430 and @xmath480 be a vertex at the maximum possible distance from @xmath435 with the property that @xmath1046 has two isomorphic branches @xmath1047 and @xmath1048 .",
    "spoiler pebbles the path from @xmath435 to @xmath480 and the two neighbors of @xmath480 in @xmath1047 and @xmath1048 . from this point spoiler can play as before because @xmath1047 and @xmath1048 are diverging and only one of them can be isomorphic to the corresponding branch pebbled by duplicator in @xmath429 .",
    "lemma [ lem : treedr ] shows that asymmetric trees are definable with quantifier depth not much larger than their radius . on the other hand",
    ", asymmetric trees can grow in breadth , having a huge number of vertices .",
    "more precisely , there are asymmetric trees with @xmath1049 .",
    "indeed , let @xmath1050 denote the number of asymmetric rooted trees of height at most @xmath65 .",
    "a simple recurrence @xmath1051 shows that @xmath1052 .",
    "let @xmath1053 and @xmath1054 be the ( unrooted ) tree of radius @xmath65 with a single central vertex @xmath88 such that the set of branches growing from @xmath88 consists of all @xmath1055 pairwise non - isomorphic asymmetric rooted trees of height less than @xmath65 .",
    "( the reader will now surely recognize another instance of the unite - and - conquer method ! )",
    "since @xmath1054 has even diameter , the central vertex @xmath88 is fixed under all automorphisms .",
    "it easily follows that @xmath1054 is asymmetric .",
    "this graph will be referred to as the _ universal asymmetric tree of radius @xmath65_. note that @xmath1056 .",
    "combining it with lemma [ lem : treedr ] , we obtain @xmath1057 .    with a little extra work ,",
    "trees with low logical depth can be constructed on any given number of vertices .",
    "it turns out that the log - star bound is essentially the best what can be achieved for trees .",
    "[ thm : besttree ] for every @xmath8 there is a tree @xmath429 on @xmath8 vertices with @xmath1058 . on the other hand , for all trees @xmath429 on @xmath8 vertices we have @xmath1059 .",
    "we will see in the next section that the lower bound of theorem [ thm : besttree ] can not be extended to the class of all graphs .",
    "universal asymmetric trees have been proved to be a useful technical tool in complexity theory and finite model theory since a long time , see the references in dawar et al .",
    "lemma 3.4(e ) in the latter paper readily implies a succinctness result for the logical _",
    "length_.    [ thm : univtree ] for the universal asymmetric tree of radius @xmath65 we have @xmath1060 .",
    "the theorem shows that , for infinitely many @xmath8 , there is a tree @xmath429 on @xmath8 vertices with @xmath1061 . unlike theorem [ thm : besttree ] ,",
    "this result can not be extended to all @xmath8 because there are infinitely many @xmath8 such that all graphs on @xmath8 vertices have logical length @xmath1062 ( see ( [ eq : gnlow ] ) in the proof of theorem  [ thm : tight ] ) .",
    "define the _ succinctness function _ by @xmath1063 since only finitely many graphs are definable with a fixed quantifier depth ( see theorem [ thm : inequi ] ) , we have @xmath1064 as @xmath662 .",
    "the examples collected in section [ ss:3constr ] show that @xmath91 increases rather slowly .",
    "let @xmath1065 denote the version of @xmath91 for definitions with at most @xmath62 quantifier alternations .",
    "the padding construction from section [ sss : padding ] gives us @xmath1066 for infinitely many @xmath8 and , by theorem [ thm : arithm ] , this bound holds actually for all @xmath8 , perhaps with a worst additive constant .",
    "is the log - star bound best possible ?",
    "the answer is surprising enough : in some strong sense it is but , at the same time , it is very far from being tight .",
    "first , let us elaborate on the latter claim .",
    "a _ prenex formula _ is a formula with all its quantifiers being in front . in this case",
    "there is a single sequence of nested quantifiers and the quantifier rank is just the number of quantifiers occurring in a formula .",
    "the superscript _ prenex _ will mean that we allow defining sentences only in prenex form .",
    "thus , @xmath1067 is equal to the minimum quantifier depth of a prenex formula with at most @xmath62 quantifier alternations that defines a graph on @xmath8 vertices .",
    "we obviously have @xmath1068 . recall that @xmath1069 denotes the minimum length of a sentence defining @xmath1 with at most @xmath62 quantifier alternations . since a quantifier - free formulas with @xmath65 variables",
    "is equivalent to a disjunctive normal form over @xmath1070 relations between the variables , we obtain also relation @xmath1071    recall that a _ total recursive function _ is an everywhere defined recursive function .    [ thm : superrec ] there is no total recursive function @xmath97 such that @xmath1072 for all  @xmath8 .",
    "the theorem implies a superrecursive gap between @xmath106 and @xmath1073 or even @xmath1074 .",
    "in particular , the values of @xmath1075 are infinitely often inconceivably smaller even than the values of @xmath101 . more generally , if a total recursive function @xmath1076 is monotone nondecreasing and tends to infinity , then @xmath1077 which actually means that the succinctness function admits no reasonable lower bound .",
    "the proof of theorem [ thm : superrec ] is based on simulation of a turing machine @xmath823 by a prenex formula @xmath1078 in which a computation of @xmath823 determines a graph satisfying @xmath1078 and vice versa .",
    "such techniques were developed in the classical research on hilbert s _ entscheidungsproblem _ by turing , trakhtenbrot , bchi and other researchers ( see @xcite for survey and references ) .",
    "an important feature of our simulation is that it works if we restrict the class of structures to graphs . as a by - product",
    ", we obtain another proof of lavrov s version of the trakhtenbrot theorem @xcite ( see also ( * ? ? ?",
    "* theorem 3.3.3 ) ) saying that the first - order theory of finite graphs is undecidable .",
    "the proof actually shows the undecidability of the @xmath1079-fragment of this theory for some @xmath90 , @xmath135 , and @xmath1080 .",
    "we now have to explain why bound ( [ eq : q3logstar ] ) , though not sharp , is best possible in some sense .",
    "let us define the _ smoothed succinctness function _",
    "@xmath1081 to be the least monotone nondecreasing integer function bounding @xmath91 from above , that is , @xmath1082 the following theorem shows that @xmath1083 and , therefore , the log - star function is a nearly optimal _ monotone _",
    "upper bound for the succinctness function  @xmath91 .",
    "[ thm : ssf ] @xmath1084    though the lower bound contains a nonconstant lower order term , it can hardly be distinguished from a constant : for example , @xmath1085 for @xmath1086 , which is a rough estimate of the number of elementary particles in the observable universe .    theorem [ thm : besttree ] implies that @xmath1087 for all @xmath8 . since this bound is monotone , it is a bound on @xmath1081 as well .",
    "the lower bound for @xmath1081 can be derived from theorem [ thm : inequi ] . according to it , at most @xmath126 graphs are definable with quantifier depth @xmath65 .",
    "given @xmath1088 , let @xmath65 be such that @xmath1089 .",
    "it follows that @xmath1090 . by the pigeonhole principle",
    ", there will be some @xmath1091 for which no graph of order precisely @xmath71 is defined with quantifier depth at most @xmath65 .",
    "we conclude that @xmath1092 and hence @xmath1093 .",
    "we defined @xmath1081 to be the `` closest '' to @xmath91 monotone function .",
    "notice that @xmath91 itself lacks the monotonicity , deviating from @xmath1081 infinitely often ( set @xmath1076 to be the lower bound in theorem [ thm : ssf ] and apply  ( [ eq : intro0 ] ) ) .",
    "it is interesting to observe how the succinctness function changes when we put restrictions on the logic .",
    "note that all what we have stated about the succinctness function for first - order logic actually holds true for its fragment with 3 quantifier alternations .",
    "now we consider the first - order logic with no quantifier alternation , consisting of purely existential and purely universal formulas and their monotone boolean combinations ( of course , all negations are supposed to stay in front of relation symbols ) .",
    "it is easy to see that any sentence with no quantifier alternation is equivalent to a sentence in the _ bernays - schnfinkel class_. the latter consists of prenex formulas in which the existential quantifiers all precede the universal quantifiers , as in @xmath1094 where @xmath57 is quantifier - free .",
    "this fragment of first - order logic is provably weak .    to substantiate this claim ,",
    "consider the _",
    "finite satisfiability problem _ : given a first - order sentence @xmath11 about graphs , one has to decide whether or not there is a finite graph satisfying @xmath11 .",
    "more generally , let @xmath1095 consist of all those @xmath8 such that there is a graph on @xmath8 vertices satisfying @xmath11 .",
    "thus , the problem is to decide whether @xmath1095 is nonempty .",
    "lavrov @xcite proved that this problem is unsolvable even for sentences without equality ( for directed graphs this is a classical result on hilbert s _ entscheidungsproblem _ , known as the trakhtenbrot - vaught theorem , see @xcite ) .",
    "however , if we consider only sentences in the bernays - schnfinkel class , the finite satisfiability problem becomes decidable .",
    "this directly follows from the following simple observation showing that a nonempty spectrum always contains a certain small number .",
    "[ lem : bs ] suppose that a first - order sentence @xmath11 is of the form ( [ eq : bs ] ) .",
    "if @xmath11 is satisfiable , then @xmath1095 contains @xmath65 or a smaller number .",
    "assume that @xmath11 is true on a graph @xmath1 with more than @xmath65 vertices and let @xmath1096 be the set of vertices @xmath146 whose existence is claimed by @xmath11 .",
    "note that the induced subgraph @xmath1097 $ ] satisfies @xmath11 as well .",
    "the solvability of the finite satisfiability problem for the bernays - schnfinkel class was observed by ramsey in @xcite .",
    "ramsey showed that the spectrum of a bernays - schnfinkel formula can be completely determined .",
    "this follows from the following result where his famous combinatorial theorem appeared as a technical tool .",
    "recall that a set is _ cofinite _ if it has finite complement .",
    "[ thm : ramsey ] any sentence about graphs @xmath11 in the bernays - schnfinkel class has either finite or cofinite spectrum . more specifically , if @xmath11 is of the form ( [ eq : bs ] ) , then either @xmath1095 contains no number equal to or greater than @xmath1098 or it contains all numbers starting from @xmath1099 .",
    "assume that @xmath11 is true on a graph @xmath1 with at least @xmath1098 vertices and let @xmath1096 consist of vertices @xmath146 whose existence is claimed by @xmath11 .",
    "recall that _",
    "ramsey number _ @xmath1100 is equal to the minimum @xmath402 such that every graph with @xmath402 or more vertices contains a homogeneous set of @xmath156 vertices . as it is well known , @xmath1101 .",
    "by the pigeonhole principle , @xmath1102 contains a subset @xmath1103 of @xmath1100 vertices with the same neighborhood within @xmath675 .",
    "let @xmath116 be a homogeneous set of @xmath156 vertices in @xmath1104 $ ] .",
    "note that @xmath1105 $ ] satisfies @xmath11 and that @xmath116 is a set of @xmath156 twins in this graph .",
    "cloning the twins , we can obtain a graph that satisfies @xmath11 and has any number of vertices larger than @xmath1099 .",
    "after this small historical excursion , let us turn back to the definability with no quantifier alternation .",
    "first of all , note that even without quantifier alternation all graphs remain definable ( see ( [ eq : def ] ) ) and , hence , the parameter @xmath93 is well defined .",
    "[ thm : d0comp ] @xmath93 is a computable parameter of a graph .",
    "given @xmath1106 , one can algorithmically construct a finite set @xmath1107 consisting of 0-alternating sentences of quantifier depth @xmath71 so that every 0-alternating sentence of quantifier depth @xmath71 has an equivalent in @xmath1107 . to decide if @xmath1108 , for each sentence @xmath1109 satisfied by @xmath1 we have to check if @xmath1110 can be satisfied by another graph @xmath832 .",
    "we first reduce @xmath1110 to an equivalent statement @xmath57 in the bernays - schnfinkel class .",
    "suppose that @xmath57 has @xmath65 existential quantifiers .",
    "it suffices to test all @xmath844 with at most @xmath120 vertices .",
    "indeed , if @xmath11 is true on a graph with more than @xmath120 vertices then , by the argument used to prove lemma [ lem : bs ] , @xmath11 is as well true on its induced subgraphs with @xmath120 and @xmath65 vertices ( one of which is not isomorphic to @xmath1 ) .",
    "we can not prove anything similar for @xmath0 or even @xmath730 .",
    "the proof of theorem [ thm : d0comp ] is essentially based on the decidability of whether or not a 0-alternating sentence is defining for some graph . however , in general this problem is undecidable ( see  @xcite ) .    for the logic with",
    "no quantifier alternation , the succinctness function has much more regular behavior .",
    "[ thm : q0 ] @xmath1111    the lower bound has to be contrasted to theorem [ thm : superrec ] .",
    "it gives us a kind of a quantitative confirmation of the fact that the 0-alternation fragment of first - order logic is strictly less powerful .",
    "the upper bound improves upon the alternation number in ( [ eq : q3logstar ] ) attaining the optimum .",
    "the proof of this bound is based on the unite - and - conquer construction in section [ sss : unite ] , where more subtle analysis is needed in order to achieve the zero alternation number .",
    "all the details can be found in  @xcite .",
    "theorem [ thm : q0 ] ( lower bound ) given @xmath8 , denote @xmath1112 and fix a graph @xmath1 on @xmath8 vertices such that @xmath1113 . the same relation between @xmath1069 and @xmath63 as in theorem [ thm : dvsl ]",
    "is proved in @xcite . by this result ,",
    "@xmath1 is definable by a 0-alternating sentence @xmath1110 of length less than @xmath126 .",
    "convert @xmath1110 to an equivalent sentence @xmath11 in the bernays - schnfinkel class and note that @xmath1114 . by lemma [ lem : bs ]",
    ", @xmath11 must be true on some graph with at most @xmath29 vertices .",
    "since @xmath11 is true only on @xmath1 , we have @xmath1115 this implies that @xmath1116 suppose on the contrary to our claim that @xmath1117",
    ". then @xmath1118 and ( [ n1 ] ) implies that @xmath1119 which is a contradiction , proving the claimed bound .    using the lower bound of theorem [ thm : q0 ] and the absence of any recursive linkage between @xmath1075 and @xmath8 , we are able to show a superrecursive gap between two parameters in the logical depth hierarchy @xmath1120    [ thm : dvsd0 ] there is no total recursive function @xmath97 such that @xmath1121 for all graphs  @xmath1 .",
    "assume that such an @xmath97 exists .",
    "let @xmath1122 be a graph for which @xmath1123 .",
    "then @xmath1124 this implies that @xmath1125 , contradictory to theorem  [ thm : superrec ] .    we have seen weighty evidences that the 0-alternating sentences are strictly less expressive than the sentences of the same quantifier depth with quantifier alternations .",
    "it is quite surprising that , nevertheless , sometimes we can prove for @xmath93 upper bounds which are just a little worse than the best known bounds for @xmath0 .",
    "the following results should be compared with theorems [ thm : dtrees ] , [ thm : pvv ] , and  [ thm : wdrgraph ] .",
    "[ thm : allzero ]    ( bohman et al .",
    "@xcite ) let @xmath1126 denote the maximum of @xmath1127 over all trees with @xmath8 vertices and maximum degree at most @xmath520 . if both @xmath521 and @xmath522 tend to infinity , then @xmath1128 .",
    "( pikhurko , veith , and verbitsky  @xcite ) @xmath1129 for all non - isomorphic graphs @xmath1 and @xmath12 with the same number of vertices  @xmath8 .",
    "( kim et al .",
    "@xcite ) @xmath1130 with high probability .",
    "we conclude this subsection with a demonstration of somewhat surprising strength of the bernays - schnfinkel class .",
    "we say that a sentence @xmath11 _ identifies _ a graph @xmath1 if it distinguishes @xmath1 from any non - isomorphic graph of the same order .",
    "let @xmath1131 denote the minimum quantifier depth of @xmath11 in the bernays - schnfinkel class identifying @xmath1 .",
    "we already discussed the identification problem in section [ sss : identif ] .",
    "note , however , a striking difference .",
    "while in section [ sss : identif ] we could make the conjunction of all sentences @xmath231 distinguishing @xmath1 from another graph @xmath12 of the same order , now we have to distinguish @xmath1 from all such @xmath12 by a single prenex sentence !    for any graph @xmath1 of order @xmath8 , we have @xmath1132 .    with high probability we have @xmath1133 .",
    "moreover , the latter bound holds true even if the number of universal quantifiers in an identifying formula is restricted to  2 .",
    "succinctly definable graphs can be used to show that the tower function is sometimes unavoidable in relations between logical parameters of graphs .",
    "we first observe that the relationship between the logical depth and the logical length in theorem [ thm : dvsl ] is `` nearly '' tight",
    ".    , which was proved for the variant of @xmath3 where variable @xmath142 contributes @xmath1134 , rather than just 1 , to the formula length.][thm : tight ] there are infinitely many pairwise non - isomorphic graphs @xmath1 with @xmath1135 .    the proof is given by a simple counting argument .",
    "a first - order sentence @xmath11 defining a graph @xmath1 determines a natural binary encoding of @xmath1 ( up to isomorphism ) of length @xmath1136 .",
    "it follows that at most @xmath1137 graphs can have logical length less than @xmath65 . by the pigeonhole principle , there is @xmath1138 such that @xmath1139 for all @xmath1 on @xmath8 vertices .",
    "for all these graphs we have @xmath1140 which exceeds @xmath1141 if @xmath65 is chosen sufficiently large . by theorem",
    "[ thm : besttree ] , there is a graph @xmath1122 on @xmath8 vertices with @xmath1142 combining ( [ eq : gnup ] ) and ( [ eq : gnlow ] ) , we obtain the desired separation of @xmath1143 from @xmath1144 . increasing the parameter @xmath65 , we can have infinitely many such examples .",
    "one of the consequences of theorem [ thm : superrec ] is that prenex formulas are sometimes unexpectedly efficient in defining a graph .",
    "we are now able to show that , nevertheless , they generally can not be competitive against defining formulas with no restriction on structure .",
    "more specifically , we have simple relations @xmath1145 combining the second inequality with theorem [ thm : dvsl ] , we obtain @xmath1146 and we can now see that this relationship between @xmath1147 and @xmath0 is not so far from being optimal",
    ".    [ cor : pren ] there are infinitely many pairwise non - isomorphic graphs @xmath1 with @xmath1148 .",
    "the proof of theorem [ thm : tight ] gives us actually a better bound , though somewhat cumbersome , namely @xmath1149 with @xmath1150 and @xmath88 a constant .",
    "corollary [ cor : pren ] follows from here simply by noticing that parameters @xmath1147 and @xmath3 are exponentially close .",
    "the latter fact follows from ( [ eq : ddllprenex ] ) and a version of ( [ eq : ldprenex ] ) , namely @xmath1151    in conclusion we note that the tower function is essential also in the upper bound for the number of graphs definable with quantifier depth @xmath65 given by theorem  [ thm : inequi ] .",
    "there are at least @xmath1152 first - order sentences of quantifier depth @xmath65 defining pairwise non - isomorphic graphs and , hence , being pairwise inequivalent .",
    "in section [ sss : asymtrees ] we noticed that there are exactly @xmath1153 asymmetric rooted trees of height at most @xmath540 .",
    "basically this follows from the fact that such a tree is completely characterized by the set of its branches from the root , each being an asymmetric rooted tree of height at most @xmath1154 ( the root is not a part of any branch ) .",
    "thus , @xmath1155 asymmetric rooted trees have height exactly @xmath540 . note that @xmath1156 of them have exactly one branch of height @xmath1154 .",
    "therefore , there are at least @xmath1157 asymmetric rooted trees whose underlying trees ( with roots dismissed ) have diameter @xmath1158 and , hence , are asymmetric too . by lemma  [ lem : treedr ] , each of these trees is definable with quantifier depth  @xmath1159",
    ".    a lower bound of @xmath1160 for the number of pairwise inequivalent sentences of quantifier depth @xmath65 is shown by spencer ( * ? ? ?",
    "* theorem 2.2.2 ) .",
    "many questions remain open , some of which are included in the main text of the survey alongside the known related results . for reader",
    "s convenience we collect a few open problems here that we consider most interesting .",
    "while the factor of @xmath656 in theorem  [ thm : pvv ] is best possible , we do not know if it can be improved for logic with counting .",
    "surprisingly , we could not resolve even the following question .",
    "is there @xmath1161 such that for every graph @xmath1 of sufficiently large order @xmath8 we have @xmath1162 ?",
    "recall that no sublinear bound is generally possible here because cai , frer , and immerman @xcite constructed graphs with linear width in the counting logic ; see theorem [ thm : cfi ] .",
    "automorphisms of these graphs play an essential role in establishing this lower bound .",
    "it would be very interesting to estimate @xmath74 from above for asymmetric @xmath1 .",
    "again , we have only the bound @xmath1163 as a straightforward corollary of theorem [ thm : pvv ] , where no restriction on the automorphism group is supposed .    another research direction , with applications to the graph isomorphism problem , is identification of natural classes of graphs with @xmath74 bounded by a constant ; see sections [ sss : exclminor ] and [ sss : others ] .",
    "such a bound is known for interval graphs @xcite , and it is interesting if it can be extended to the class of circular - arc graphs .",
    "the approach suggested in @xcite is based on the fact that any maximal clique in an interval graph is definable as the common neighborhood of some two vertices .",
    "this prevents any straightforward extension to circular - arc graphs , where the number of maximal cliques can be exponential .",
    "the ( un)boundedness of @xmath74 is an interesting open question also for disk graphs , yet another extension of the class of interval graphs ( martin grohe , 2010 ) .    a result of dawar , lindell , and weinstein @xcite",
    "( see also theorem [ thm : dk ] ) implies an upper bound for @xmath73 in terms of @xmath74 and the order @xmath8 of @xmath1 , where @xmath74 disappointedly occurs at the exponent .",
    "can this bound be improved ? at the moment we can not even exclude that @xmath1164 . if the latter bound was true for @xmath1165 with @xmath1166 , this would have important consequences for isomorphism testing by theorem  [ thm : gve ] .    where do we need the power of counting quantifiers ? to keep far away from the trivial example of a complete or empty graph ,",
    "suppose that a graph @xmath1 is asymmetric .",
    "is it true or not that @xmath1167 ?",
    "a random graph shows that this bound would be best possible .",
    "we are still far from having a complete evolutionary picture of the logical complexity for a random graph .",
    "let @xmath1168 be fixed and @xmath90 be an arbitrary function of @xmath8 with @xmath1169 .",
    "is it true that whp @xmath890 ?    the local behavior of the succinctness function @xmath91 , that was defined in section  [ ss : succfunc ] , is unclear . while it is trivial that @xmath1170 , we do not know , for example , if @xmath1171 for some constant @xmath84 and all @xmath8 .    in accordance with our notation system ,",
    "let @xmath1172 denote the succinctness function for the @xmath65-variable logic . by slightly modifying the proof of lemma [ lem : treedr ]",
    ", one can show that @xmath1173 for all @xmath8 .",
    "since the satisfiability problem for the 3-variable logic is undecidable ( see , e.g. , @xcite ) , it is not excluded that an analog of theorem [ thm : superrec ] can be established for  @xmath1174 .",
    "theorem  [ thm : dvsd0 ] says that there is no recursive link between @xmath1073 and @xmath93 .",
    "can one show a superrecursive gap between @xmath63 and @xmath1176 for some @xmath1177 or , at least , between @xmath0 and @xmath730 ?    though the case of trees was thoroughly investigated throughout the survey , this class of graphs deserves further attention .",
    "one may expect that many logical questions for trees are easier .",
    "note in this respect that the first - order theory of finite trees is decidable due to rabin @xcite .",
    "nevertheless , we do not know , for example , whether or not the logical depth @xmath519 of a tree @xmath429 is a computable parameter ( while it is not hard to show that the logical width @xmath1178 is computable in logarithmic space ) .",
    "disappointingly , we were able to collect only a few results on the logical length for this survey .",
    "from the fact that there are @xmath1179 non - isomorphic graphs of order @xmath8 , it is easy to derive that whp @xmath1180 .",
    "the obvious general upper bound is @xmath1181 .",
    "this leaves open the question what the logical length of a typical graph is .",
    "also , it would be very interesting to find explicit examples of graphs with large @xmath3 .",
    "pseudo - random graphs can be natural candidates .",
    "for example , it is well known ( blass , exoo , and harary @xcite ) that paley graphs share the first - order properties of a truly random graph .",
    "furthermore , we can define the succinctness function with respect to the logical length by @xmath1182 .",
    "let @xmath1183 be the version of @xmath1184 for the @xmath62-alternation logic . from theorem [ thm : superrec ] and the relation ( [ eq : ldprenex ] )",
    ", it follows that @xmath1184 , and even @xmath1185 , can be incomprehensibly smaller than @xmath8 : for any total recursive function @xmath97 we must have @xmath1186 infinitely often . on the other hand ,",
    "the estimate ( [ eq : gnlow ] ) in the proof of theorem [ thm : tight ] implies that @xmath1187 for infinitely many @xmath8 .",
    "moreover , the same argument shows that @xmath1188 for _ all _ @xmath8 , where @xmath1189 denotes the smoothed version of @xmath1184 similarly to ( [ eq : smoothed ] ) .",
    "how tight is the bound of @xmath1062 in these statements ?",
    "another interesting problem is the behavior of the function @xmath1190 ( recall that for @xmath92 we know the exact asymptotics owing to theorem [ thm : q0 ] ) . note in conclusion that techniques for estimating the length of a first - order formula are worked out , e.g. , by adler and immerman @xcite , dawar et al .",
    "@xcite , grohe and schweikardt  @xcite .",
    "we are grateful to joel spencer for the fruitful collaboration on the subject of this survey and for allowing us to use his unpublished ideas in the proof of lemma [ lem : wsievergraph ] and in section  [ sss : padding ] .",
    "we also thank martin grohe for his detailed comments , in particular , for bringing up a succinctness result of dawar et al .",
    "@xcite ( theorem [ thm : univtree ] here ) to our attention .",
    "a.  dawar , m.  grohe , s.  kreutzer , n.  schweikardt .",
    "model theory makes formulas large . in : _",
    "proc .  of the 34th int .",
    "colloquium on automata , languages and programming . _ lecture notes in computer science , vol .  4596 , 913924 ( 2007 ) .",
    "m.  frer .",
    "weisfeiler - lehman refinement requires at least a linear number of iterations . in : _",
    "proc .  of the 28th int .",
    "colloquium on automata , languages , and programming .",
    "_ lecture notes in computer science , vol .",
    "2076 , 322333 ( 2001 ) .",
    "m.  grohe , j.  mario .",
    "definability and descriptive complexity on databases of bounded tree - width . in : _ proc .  of the 7th int .",
    "conf .  on database theory _ , lecture notes in computer science , vol .  1540 , 7082 ( 1999 ) .",
    "m.  grohe , o.  verbitsky . testing graph isomorphism in parallel by playing a game . in : _",
    "proc .  of the 33rd int .",
    "colloquium on automata , languages , and programming .",
    "_ lecture notes in computer science , vol .",
    "4051 , 314 ( 2006 ) .",
    "m.  naor , a.  nussboim , e.  tromer .",
    "efficiently constructible huge graphs that preserve first order properties of random graphs . in : _",
    "theory of cryptography . _ lecture notes in computer science , vol .  3378 , 6685 ( 2005 ) .",
    "e.  pezzoli .",
    "computational complexity of ehrenfeucht - frass games on finite structures . in : _ proc .  of the 12th conf .",
    "on computer science logic 1998_. lecture notes in computer science , vol .  1584 , 159170 ( 1999 ) .",
    "o.  verbitsky .",
    "planar graphs : logical complexity and parallel isomorphism tests . in : _",
    "proc .  of the 24th symp .  on theoretical aspects of computer science _",
    ", lecture notes in computer science , vol .",
    "4393 , 682693 ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> we discuss the definability of finite graphs in first - order logic with two relation symbols for adjacency and equality of vertices . </S>",
    "<S> the _ logical depth _ @xmath0 of a graph @xmath1 is equal to the minimum quantifier depth of a sentence defining @xmath1 up to isomorphism . </S>",
    "<S> the _ logical width _ </S>",
    "<S> @xmath2 is the minimum number of variables occurring in such a sentence . </S>",
    "<S> the _ logical length _ </S>",
    "<S> @xmath3 is the length of a shortest defining sentence . </S>",
    "<S> we survey known estimates for these graph parameters and discuss their relations to other topics ( such as the efficiency of the weisfeiler - lehman algorithm in isomorphism testing , the evolution of a random graph , quantitative characteristics of the zero - one law , or the contribution of frank ramsey to the research on hilbert s _ entscheidungsproblem _ ) . </S>",
    "<S> also , we trace the behavior of the descriptive complexity of a graph as the logic becomes more restrictive ( for example , only definitions with a bounded number of variables or quantifier alternations are allowed ) or more expressible ( after powering with counting quantifiers ) . </S>"
  ]
}