{
  "article_text": [
    "hyperconvex metric spaces were defined by aronszajn and panitchpakdi in @xcite as part of a program to generalise the hahn - banach theorem to more general metric spaces ( reviewed in @xcite , and below ) .",
    "isbell @xcite and dress @xcite showed that every metric space could be embedded into a minimum hyperconvex space , called the _ tight span _ or _",
    "injective envelope_. our aim is to show that the notion of hyperconvexity , the tight span , and much of the related theory can be extended beyond metrics to a class of multi - way metrics which we call diversities .",
    "recall that a _",
    "metric space _ is a pair @xmath0 where @xmath1 is a set and @xmath2 is a function from @xmath3 to @xmath4 satisfying    1 .",
    "@xmath5 and @xmath6 if and only if @xmath7 .",
    "2 .   @xmath8 .",
    "we define a _ diversity _ to be a pair @xmath9 where @xmath1 is a set and @xmath10 is a function from the finite subsets of @xmath1 to @xmath4 satisfying    1 .",
    "@xmath11 , and @xmath12 if and only if @xmath13 .",
    "if @xmath14 then @xmath15 .",
    "we prove below that these axioms imply monotonicity :    1 .",
    "if @xmath16 then @xmath17    we will show that tight span theory adapts elegantly from metric spaces to diversities . the tight span of a metric space @xmath0 is formed from the set of point - wise minimal functions @xmath18 such that @xmath19 for all @xmath20 .",
    "letting @xmath21 denote the finite subsets of @xmath1 , the tight span of a diversity @xmath9 is formed from the set of point - wise minimal functions @xmath22 such that @xmath23 for all finite collections @xmath24 .",
    "we can embed a metric space in its tight span ( with the appropriate metric on the tight span ) ; we can embed a diversity in its tight span ( with the appropriate diversity on the tight span ) .",
    "both constructions have characterisations in terms of injective hulls , and both possess a rich mathematical structure .",
    "the motivation for exploring tight spans of diversities was the success of the metric tight span as a tool for classifying and visualising finite metrics , following the influential paper of dress @xcite .",
    "the construction provided the theoretical framework for split decomposition @xcite and neighbor - net @xcite , both implemented in the splitstree package @xcite and widely used for visualising phylogenetic data . by looking at diversities , rather than metrics or distances ,",
    "our hope is to incorporate more information into the analysis and thereby improve inference @xcite .",
    "dress et al .",
    "@xcite coined the term _ t - theory _ for the field of discrete mathematics devoted to the combinatorics of the tight span and related constructions .",
    "sturmfels @xcite highlighted t - theory as one area where problems from biology have led to substantial new ideas in mathematics .",
    "contributions to t - theory include profound results on optimal graph realisations of metrics @xcite ; intriguing connections between the buneman graph , the tight span and related constructions @xcite ; links with tropical geometry and hyperdeterminants @xcite ; classification of finite metrics @xcite ; and properties of the tight span for special classes of metrics @xcite .",
    "hirai @xcite describes an elegant geometric formulation of the tight span .",
    "we believe that there will be diversity analogues for many of these metric space results .",
    "our use of the term _ diversity _ comes from the appearance of a special case of our definition in work on phylogenetic and ecological diversity @xcite .",
    "however diversities crop up in a broad range of contexts , for example :    1 .",
    "_ diameter diversity .",
    "_ let @xmath0 be a metric space .",
    "for all @xmath25 let @xmath26 then @xmath9 is a diversity .",
    "@xmath27 diversity .",
    "_ for all finite @xmath28 define @xmath29 then @xmath30 is a diversity .",
    "phylogenetic diversity .",
    "_ let @xmath31 be a phylogenetic tree with taxon set @xmath1 .",
    "for each finite @xmath32 , let @xmath33 denote the length of the smallest subtree of @xmath31 connecting taxa in @xmath34 .",
    "then @xmath9 is a _",
    "phylogenetic diversity_. 4",
    ".   _ length of the steiner tree .",
    "_ let @xmath0 be a metric space .",
    "for each finite @xmath32 let @xmath33 denote the minimum length of a steiner tree connecting elements in @xmath34 . then @xmath9 is a diversity .",
    "truncated diversity .",
    "_ let @xmath9 be a diversity .",
    "for all @xmath25 define @xmath35 for each @xmath36 , @xmath37 is a diversity .",
    "note that these diversities can be encoded using @xmath38 values , an important consideration for the design of efficient algorithms .",
    "the generalisation of metrics to more than two arguments has a long history .",
    "there is an extensive literature on 2-metrics ( metrics taking three points as arguments ) ; see @xcite .",
    "generalised metrics defined on @xmath39-tuples for arbitrary @xmath39 go back at least to menger @xcite , who took the volume of an @xmath39-simplex in euclidean space as the prototype . recently various researchers have continued the study of such generalised metrics defined on @xmath39-tuples ; see @xcite for examples . however , as of yet , a satisfactory theory of tight spans has not been developed for these generalisations .",
    "dress and terhalle @xcite developed tight span theory for _ valuated matroids _",
    ", which can be viewed as an @xmath39-dimensional version of a restricted class of metrics .",
    "they demonstrated intriguing links with algebraic building theory .",
    "one significant difference is that , for diversities , the tight span consists of functions on @xmath21 rather than on @xmath1 , as is the case for valuated matroids .",
    "we note that our results differ from all of this earlier work because , for a diversity @xmath9 , the function @xmath10 is defined on arbitrary finite subsets of @xmath1 rather than tuples of a fixed length .",
    "the structure of this paper is as follows : in section  [ sec : tightspan ] we develop the basic theory of tight spans on diversities , defining the appropriate diversity for a tight span and showing that every diversity embeds into its tight span . in section  [ sec : hyperconvex ] we characterise diversities that are isomorphic to their tight spans . here",
    ", isomorphism is defined in analogy to isometry for metric spaces .",
    "these are the _ hyperconvex _ diversities , a direct analogue of metric hyperconvexity .",
    "we prove that diversity tight spans , like metric tight spans , are injective , and are formally the injective envelope in the category of diversities . in section",
    "[ sec : tightlinks ] we explore in more detail the direct links between diversity tight spans and metric tight spans .",
    "we show when the diversity equals the diameter diversity ( as defined above ) the diversity tight span is isomorphic to the diameter of the metric tight span . in section  [ sec : phylo ]",
    "we study the tight span of a phylogenetic diversity , and prove that taking the tight span of a phylogenetic diversity recovers the underlying tree in the same way that taking the tight span of an additive metric recovers its underlying tree .",
    "this theory is developed for _",
    "real trees_. finally , in section  [ sec : steiner ] we examine applications of the theory to the classical steiner tree problem . dress and",
    "krger @xcite defined an _ abstract _",
    "steiner tree where the internal nodes did not have to sit in the given metric space .",
    "they proved that these abstract steiner trees can be embedded in the tight span .",
    "we extend their results to steiner trees based on diversities , thereby obtaining tight bounds for the classical steiner tree problem .",
    "we begin by establishing some basic properties of diversities . recall that @xmath21 denotes all the finite subsets of the set @xmath1 and that a diversity is the pair @xmath9 where @xmath1 is a set and the function @xmath40 satisfies axioms ( d1 ) and ( d2 ) .",
    "[ thm : diversitybasics ] let @xmath9 be a diversity .    1 .",
    "if @xmath41 is defined as @xmath42 then @xmath0 is a metric space .",
    "we say that @xmath0 is the _ induced metric _ of @xmath9 .",
    "2 .   ( d3 ) holds , that is , for @xmath43 , if @xmath44 then @xmath45 .",
    "3 .   for @xmath43 if @xmath46 then @xmath47 .    1 .   that @xmath48 if and only if @xmath49 follows from ( d1 ) .",
    "symmetry is clear . to obtain the triangle inequality , for any @xmath50 , @xmath51 using ( d2 ) .",
    "2 .   first note for any @xmath52 and @xmath53 that by ( d2 ) with @xmath54 empty @xmath55 the more general result follows by induction .",
    "3 .   using ( d2 ) @xmath56    we now state the diversity analogue for the metric tight span .",
    "let @xmath9 be a diversity .",
    "let @xmath57 denote the set of all functions @xmath58 satisfying @xmath59 and @xmath60 for all finite @xmath61 .",
    "write @xmath62 if @xmath63 for all finite @xmath32 . the tight span of @xmath9 is the set @xmath64 of functions in @xmath57 that are minimal under @xmath65",
    ".    * example . *",
    "any diversity @xmath10 on @xmath66 is determined by the four values @xmath67 we write @xmath68 , @xmath69 and @xmath70 for @xmath71 .",
    "condition   then translates to the following set of inequalities : @xmath72 for distinct @xmath73 .",
    "note we have omitted inequalities like @xmath74 since these are implied by and the triangle inequality ( d2 ) .",
    "the elements of @xmath64 are the minimal @xmath75 in @xmath57 .",
    "equivalently , @xmath64 is the set of @xmath75 that satisfy and such that for each nonempty @xmath32 , @xmath76 appears in an inequality in that is tight .",
    "a straightforward but tedious analysis of the inequalities ( which we omit ) gives the following characterisation of @xmath64 .",
    "define the three ` external ' vertices @xmath77 and the four ` internal ' vertices @xmath78 where @xmath79 . let @xmath54 be the cell complex formed from the line segments @xmath80 $ ] , @xmath81 $ ] , @xmath82 $ ] and the solid tetrahedron with vertices @xmath83 .",
    "a case - by - case analysis gives that @xmath84 if and only if @xmath85 , @xmath86 , @xmath87 , @xmath88 , @xmath89 .",
    "if @xmath90 then @xmath91 to @xmath92 coincide , and the tight span is one - dimensional and resembles the metric tight span for the induced metric , albeit sitting in a higher dimensional space ( figure  [ fig : threepoint]a ) . when @xmath93 the tight span resembles a tetrahedron with three spindles branching off , as in figure  [ fig : threepoint]b .",
    "@xmath94 +    . on the left",
    "an example where @xmath95 , and the diversity tight span is one - dimensional and resembles the tight span of the induced metric . on the right a case with @xmath96 , where the diversity consists of a three - cell with three adjacent one - cells .",
    ", width=384 ]    we now prove a characterisation of the diversity tight span which will be used extensively throughout the remainder of the paper ( theorem  [ thm : altchartight ] ) .",
    "an equivalent result holds for the metric tight span ( * ? ? ?",
    "* theorem 3(v ) ) .",
    "[ thm : altchartight ] let @xmath58 and suppose @xmath59",
    ". then @xmath84 if and only if for all finite @xmath32 , @xmath97    suppose that @xmath84 . as @xmath59 , the supremum in is well defined .",
    "for all finite @xmath98 and all finite @xmath99 we have @xmath100 giving the required lower bound on @xmath101 .",
    "now suppose that for some finite @xmath102 @xmath103 define a function @xmath104 by @xmath105 clearly @xmath106 and @xmath107 .",
    "we show that @xmath108 is in @xmath57 .",
    "let @xmath109 be a finite subset of @xmath21 .",
    "if @xmath110 then @xmath111 if @xmath112 then @xmath113 by letting @xmath114 .",
    "so @xmath115 , @xmath106 and @xmath107 , contradicting @xmath84 .",
    "hence there is no @xmath102 satisfying  . if @xmath84 then holds for all finite @xmath32 .",
    "for the converse , suppose that holds for all finite @xmath32 . then @xmath116 .",
    "suppose that @xmath115 , that @xmath107 and @xmath25 . then for all finite @xmath99 we have @xmath117 so that @xmath118 . hence @xmath75 is minimal in @xmath57 .",
    "we note that the characterisation of tight spans given by theorem  [ thm : altchartight ] is analogous to the definition of tight spans for valuated matroids used by @xcite .",
    "one important difference is that , for diversities , the tight span is made up of functions on @xmath21 rather than functions on @xmath1 .",
    "the following basic properties of members of @xmath64 will be used subsequently .",
    "[ cor : tightmonotone ] suppose that @xmath84 .    1",
    ".   @xmath119 for all finite @xmath32 .",
    "2 .   if @xmath120 and @xmath121 is finite then @xmath122 ; that is , @xmath75 is _",
    "monotone_. 3 .",
    "@xmath123 for all @xmath124 with @xmath14 .",
    "@xmath125 for all @xmath43 ; that is , @xmath75 is _ sub - additive_. 5 .",
    "@xmath126 for all finite @xmath34 .",
    "use @xmath127 in the definition of @xmath57 .",
    "+ 2 . follows from and the monotonicity of @xmath10 .",
    "let @xmath128 with @xmath14 .",
    "we have @xmath129 subtracting from gives @xmath130 by taking @xmath131 and using the triangle inequality .",
    "we note that this property is analogous to the continuity of functions in the metric tight span , see ( * ? ? ? * theorem 3(iv ) ) .",
    "+ 4 . given any @xmath43 and",
    "any finite collection @xmath132 we have @xmath133 so that @xmath134 by theorem  [ thm : altchartight ] .",
    "+ 5 . for any finite @xmath135 ,",
    "@xmath136 so @xmath137    the distance between any two functions @xmath138 in the metric tight span is given by the @xmath139 norm , @xmath140 which dress ( * ? ? ? * theorem 3(iii ) ) shows is equivalent on this set to @xmath141 dress also showed that a metric can be embedded into its tight span using the kuratowski map @xmath142 , which takes an element @xmath143 to the function @xmath144 for which @xmath145 for all @xmath146 .",
    "this is exactly the map @xmath147 defined in @xcite .",
    "here we establish the analogous results for the diversity tight span .",
    "we define the appropriate function @xmath142 from a diversity to its tight span .",
    "we then define a function @xmath148 on @xmath64 so that @xmath149 is a diversity and prove that @xmath142 is an embedding .    1 .",
    "let @xmath150 and @xmath151 be two diversities .",
    "a map @xmath152 is an embedding if it is one - to - one ( injective ) and for all finite @xmath153 we have @xmath154 . in this case , we say that @xmath155 embeds @xmath150 in @xmath151 .",
    "an isomorphism is an onto ( surjective ) embedding between two diversities .",
    "3 .   let @xmath9 be a diversity . for each @xmath143 define the function @xmath156 by @xmath157 for all finite @xmath32 .",
    "let @xmath142 be the map taking each @xmath143 to the corresponding function @xmath144 .",
    "4 .   let @xmath9 be a diversity .",
    "let @xmath158 be the function defined by @xmath159 and @xmath160 for all finite non - empty @xmath161 .",
    "further manipulations give a form for @xmath148 analogous to : @xmath162 for all finite @xmath163 .",
    "we can also re - express in a form closer to .",
    "note the similarity between lemma  [ lem : deltat ] and ( * ? ? ?",
    "* theorem 3(iii ) ) .",
    "[ lem : deltat ] if @xmath164 then @xmath165    @xmath166    by theorem  [ thm : altchartight ] .",
    "[ thm : tightspan_is_diversity ] @xmath149 is a diversity .    first note that for all @xmath161 , when @xmath167 , @xmath168 so that @xmath148 is non - negative .    if @xmath169 then for all @xmath61 with @xmath170 we have @xmath171 hence @xmath172 , showing that @xmath148 is monotone .    if @xmath173 then @xmath174 by the subadditivity of @xmath75 and by part 1 of proposition  [ cor : tightmonotone ] . on the other hand , if @xmath175 then there is @xmath176 such that @xmath177 . by monotonicity and lemma",
    "[ lem : deltat ] we have @xmath178 we have now proved that @xmath148 satisfies ( d1 ) .    for the triangle inequality , suppose @xmath179 and @xmath180 are disjoint finite subsets of @xmath64 and that @xmath181 .",
    "then by lemma  [ lem : deltat ] @xmath182 and @xmath183 by part 4 of proposition  [ cor : tightmonotone ] the function @xmath184 is sub - additive , so @xmath185 combining  and again applying lemma  [ lem : deltat ] we have @xmath186 the triangle inequality ( d2 ) now follows by monotonicity .    theorem  [ thm : tightspan_is_diversity ] establishes that @xmath149 is a diversity .",
    "we now show that @xmath142 is an embedding from @xmath9 into @xmath149 .",
    "we then prove the diversity analogue of ( * ? ? ?",
    "* eq . ( 2.4 ) ) ( see ( * ? ? ?",
    "* theorem 3(ii ) ) ) and characterise @xmath148 in terms of a minimality condition .",
    "[ thm : deltatmin ]    1 .",
    "the map @xmath142 is an embedding from @xmath9 into @xmath149 .",
    "2 .   for all finite @xmath187 and @xmath84 , @xmath188 3 .   if @xmath189 is a diversity such that @xmath190 for all finite @xmath187 and @xmath84 then @xmath191 for all finite @xmath161 .    \\1 .",
    "fix @xmath143 .",
    "consider finite @xmath61 .",
    "the triangle inequality for diversities , ( d2 ) , gives @xmath192 so that @xmath193 .",
    "there is @xmath194 such that @xmath195 . since @xmath196 we have for all finite @xmath32 that @xmath197 hence @xmath198 .    to see",
    "that @xmath142 is one - to - one observe that for @xmath199 , @xmath200 but @xmath201 .",
    "so @xmath202 for distinct @xmath203 .",
    "we now show that @xmath204 for all finite @xmath187 .",
    "let @xmath187 , @xmath205 .",
    "taking @xmath206 in gives @xmath207 .    by repeatedly using the triangle inequality we have for any finite @xmath208 and @xmath209 that @xmath210 taking the supremum over all such @xmath109 and applying gives @xmath211 .",
    "so @xmath212 and @xmath142 is an embedding .",
    "\\2 . let @xmath187 , @xmath213 finite , and @xmath84 . if @xmath214 for @xmath215 then , using part 1 , @xmath216 as required",
    "otherwise , suppose @xmath217 .",
    "let @xmath218 .",
    "@xmath219 letting @xmath220 for all @xmath221 shows @xmath222 by proposition  [ cor : tightmonotone ] part 5 . on the other hand ,",
    "following the same reasoning as in part 1 of this proof shows @xmath223 therefore @xmath224 .",
    "suppose that @xmath225 , where @xmath226 and @xmath227 .",
    "for all collections @xmath61 with @xmath170 and all collections @xmath228 of elements in @xmath179 , we have from 1 . and 2",
    ". that @xmath229",
    "aronszajn and panitchpakdi @xcite introduced hyperconvex metric spaces and showed that they are exactly the injective metric spaces .",
    "[ def : metricts ]    1 .",
    "a metric space @xmath0 is said to be _ hyperconvex _ if for all @xmath230 with @xmath231 for all @xmath203 there is a point @xmath232 such that @xmath233 for all @xmath143 .",
    "2 .   a metric space",
    "@xmath0 is _ injective _ if it satisfies the following property : given any pair of metric spaces @xmath234 , @xmath235 , an embedding @xmath236 and a non - expansive map @xmath237 there is a non - expansive map @xmath238 such that @xmath239 .",
    "see @xcite for a proof of the equivalence of these two concepts , as well as a highly readable and comprehensive review of the rich metric structure of hyperconvex spaces .",
    "here we establish diversity analogues for these concepts and show that the equivalence holds in this new setting .",
    "we begin by defining diversity analogues of injective and hyperconvex metric spaces .    1 .   given diversities @xmath150 and @xmath151 ,",
    "a map @xmath240 is _ non - expansive _ if for all @xmath153 we have @xmath241 and it is an _ embedding _ if it is one - to - one and for all @xmath153 we have @xmath242 .",
    "2 .   a diversity @xmath9 is _ injective _",
    "if it satisfies the following property : given any pair of diversities @xmath150 , @xmath243 , an embedding @xmath236 and a non - expansive map @xmath237 there is a non - expansive map @xmath238 such that @xmath239 .",
    "a diversity @xmath9 is said to be _ hyperconvex _ if for all @xmath244 such that @xmath245 for all finite @xmath61 there is @xmath232 such that @xmath246 for all finite @xmath187 .",
    "the following theorem establishes the diversity equivalent of aronszajn and panitchpakdi s result .",
    "[ lem : injecthyper ] a diversity @xmath9 is injective if and only if it is hyperconvex .",
    "first suppose that @xmath9 is injective .",
    "consider @xmath244 satisfying for all finite @xmath61 . without loss of generality we can assume @xmath247 and hence @xmath248 .",
    "choose @xmath84 with @xmath249 .",
    "let @xmath250 be a point not in @xmath1 , let @xmath251 and let @xmath252 be the function where for all finite @xmath32 , @xmath253 from proposition  [ cor : tightmonotone ] part 2 we have that @xmath254 is monotonic , and from part 4 and 5 we have that @xmath255 for all finite @xmath256 such that @xmath14 .",
    "these , together with monotonicity and the fact that @xmath254 coincides with @xmath10 on @xmath21 , imply the triangle inequality ( d2 ) for @xmath257 .",
    "we now apply the fact that @xmath9 is injective .",
    "let @xmath150 be @xmath9 ; let @xmath151 be @xmath257 , let @xmath155 be the identity embedding from @xmath9 into @xmath257 and let @xmath258 be the identity map from @xmath9 to itself .",
    "then there is a non - expansive map @xmath259 such that @xmath260 for all @xmath143 .",
    "let @xmath261 .",
    "for all finite @xmath32 we have @xmath262 this proves that @xmath9 is hyperconvex .",
    "for the converse , suppose now that @xmath9 is hyperconvex .",
    "let @xmath150 and @xmath151 be two diversities , let @xmath236 be an embedding and let @xmath258 be a non - expansive map from @xmath263 to @xmath1 .",
    "we will show that there is non - expansive @xmath238 such that @xmath239 .",
    "let @xmath264 denote the collection of pairs @xmath265 such that @xmath266 and @xmath267 is a non - expansive map from @xmath213 to @xmath1 such that @xmath268 .",
    "we want to show that @xmath269 .",
    "suppose this is not the case .",
    "we write @xmath270 if @xmath271 and @xmath272 restricted to @xmath213 equals @xmath267 .",
    "the partially ordered set @xmath273 satisfies the conditions of zorn s lemma , so it contains maximal elements .",
    "let @xmath265 be one such maximal element .",
    "choose @xmath274 . for each finite @xmath275",
    "let @xmath276 .",
    "for any finite collection @xmath277 we have @xmath278 since @xmath9 is hyperconvex , there is @xmath279 such that @xmath280 for all finite @xmath275 .",
    "hence we can extend @xmath267 to @xmath281 by setting @xmath282 , giving a non - expansive map from @xmath281 to @xmath1 , and contradicting the maximality of @xmath213 .",
    "it follows that @xmath269 , proving that @xmath9 is injective .",
    "let @xmath9 be a diversity .",
    "for @xmath161 and finite @xmath187 let @xmath283    clearly , @xmath284 we show that @xmath285 also satisfies a sub - additivity type identity .",
    "[ lem : phi ] for @xmath286 and @xmath287 we have @xmath288    given @xmath289 there is finite @xmath61 and a collection @xmath228 of elements in @xmath64 such that @xmath290 similarly , there is finite @xmath99 and a collection @xmath291 of elements in @xmath64 such that @xmath292 define @xmath293 and the collection @xmath294 by @xmath295 then @xmath296 taking @xmath297 proves the lemma .",
    "isbell proved that the metric tight span is injective , and hence hyperconvex ( * ? ? ?",
    "* section 2.9 ) .",
    "here we prove the same result for diversities .",
    "for any diversity @xmath9 , the tight span @xmath149 is hyperconvex .",
    "[ lem : tightspanconvex ]    let @xmath298 be given such that for all finite @xmath299 @xmath300 without loss of generality we can assume @xmath247 . we need to find @xmath194 so that @xmath301 for all @xmath302 .",
    "define @xmath303 on @xmath21 by @xmath304 we have @xmath305 .",
    "suppose that @xmath61 , @xmath170 and let @xmath306 be a collection of finite subsets of @xmath64 indexed by elements of @xmath109 .",
    "from lemma  [ lem : phi ] and we have @xmath307 so that @xmath308 and @xmath309 .",
    "there is @xmath194 such that @xmath310 .",
    "consider finite @xmath161 .",
    "applying lemma  [ lem : deltat ] , @xmath311 as required .",
    "the metric tight span construction gives an isometric embedding @xmath142 from a metric space @xmath0 into an injective ( hyperconvex ) metric space .",
    "isbell showed that this embedding is minimal in that no proper subspace of the tight span both contains @xmath312 and is injective .",
    "such an embedding is called an _ injective envelope _ , and all injective envelopes of a metric space are equivalent ( * ? ? ? * thm 2.1 ) .    here",
    "we prove the analogous result for diversities that the embedding @xmath142 of a diversity into its tight span is also an injective envelope .    the class of all diversities with all non - expansive maps as morphisms forms a category , which we will denote @xmath313 .",
    "the definitions of embeddings and injective objects then correspond to concepts in category theory , as reviewed in @xcite .",
    "lemma  [ lem : kappaisessential ] together with the injectivity of @xmath149 establishes that @xmath149 is the _ injective hull _ of @xmath9 in the category @xmath313 ( * ? ? ?",
    "proposition 9.20(5 ) of @xcite demonstrates the equivalence between the category theory injective hull and the injective envelope introduced in @xcite .",
    "[ lem : kappaisessential ] let @xmath258 be a non - expanding map from @xmath149 to diversity @xmath314 . if @xmath315 is an embedding from @xmath9 to @xmath314 then @xmath258 is an embedding from @xmath149 to @xmath314 .    since @xmath258 is non - expanding @xmath316 for all finite @xmath161 . using theorem  [ thm : deltatmin ] part 3",
    "we will show that @xmath317 , so that @xmath258 is an embedding .",
    "consider @xmath84 .",
    "define @xmath108 on @xmath21 by @xmath318 for all finite @xmath34 .",
    "then for any finite @xmath32 we have @xmath319 for all @xmath34 . for all finite collections @xmath61 we have @xmath320 so that @xmath115 and @xmath107 .",
    "hence @xmath321 for all finite @xmath32 .",
    "it follows that @xmath322 for all @xmath84 and finite @xmath32 .",
    "define @xmath323 on @xmath64 by @xmath324 .",
    "then @xmath323 is a diversity and @xmath190 for all finite @xmath187 . by theorem  [ thm : deltatmin ] ,",
    "@xmath325 for all finite @xmath179 .",
    "as @xmath258 is non - expansive @xmath326 for all finite @xmath179 and @xmath258 is an embedding .",
    "the following theorem is a translation of ( * ? ? ?",
    "* proposition 9.20(4 ) ) to diversities .",
    "[ thm : envelope ] if there is an embedding @xmath155 from @xmath9 into @xmath314 and @xmath314 is injective ( hyperconvex ) then there is an embedding @xmath258 from @xmath149 into @xmath314 such that @xmath315 .    since @xmath155 is a non - expansive map , @xmath314 is injective , and @xmath142 is an embedding of @xmath9 into @xmath149 ,",
    "there is a non - expansive map @xmath327 such that @xmath315 . by lemma  [ lem : kappaisessential ]",
    ", @xmath258 is an embedding .",
    "let @xmath9 be a diversity .",
    "the following are equivalent :    1 .",
    "@xmath9 is hyperconvex ; 2 .",
    "@xmath9 is injective ; 3 .",
    "there is an isomorphism between @xmath9 and its tight span , @xmath149 .    1 .  and 2 .",
    "are equivalent by theorem [ lem : injecthyper ] . to see that 2 .",
    "implies 3 .",
    ", let @xmath328 and @xmath329 in theorem  [ thm : envelope ] .",
    "then there is an embedding @xmath258 from @xmath149 to @xmath9 such that @xmath330 .",
    "so @xmath142 is surjective and 3 .",
    "follows . finally , since hyperconvexity is invariant under isomorphism , 1",
    ".  follows from 3 .",
    "in this section we prove that tight span theory for metrics is embedded within the tight span theory for diversities .",
    "the link between the two is provided by the _ diameter diversity _ as introduced above .",
    "given a metric space @xmath0 we define the function @xmath331 by @xmath332 for finite @xmath32 , with @xmath333 .",
    "we call @xmath334 the _ diameter diversity _ for @xmath0 . note that if we restrict @xmath335 to pairs of elements we recover @xmath2 as the induced metric",
    ".    we will establish close links between tight spans of metrics and tight spans of their diameter diversities .",
    "@xmath336    [ lem : diaminject ]    1 .",
    "let @xmath337 be a diversity with induced metric @xmath338 .",
    "let @xmath0 be a metric space and let @xmath334 be the associated diameter diversity .",
    "then @xmath258 is a non - expansive map from @xmath337 to @xmath334 if and only if it is a non - expansive map from @xmath338 to @xmath0 .",
    "2 .   a metric space @xmath0 is injective ( hyperconvex ) if and only if the diameter diversity @xmath334 is injective ( hyperconvex ) .",
    "the tight span @xmath339 of a diameter diversity is itself a diameter diversity .",
    "suppose that @xmath258 is a non - expansive map from @xmath337 to @xmath334 .",
    "for all @xmath340 we have @xmath341 so @xmath258 is non - expansive from @xmath338 to @xmath0 .",
    "conversely , suppose @xmath258 is a non - expansive map from @xmath338 to @xmath0 .",
    "then for any finite @xmath275 we have @xmath342 2 .",
    "suppose that @xmath0 is injective .",
    "let @xmath150 , @xmath151 be two diversities with induced metrics @xmath343 .",
    "let @xmath155 be an embedding from @xmath150 into @xmath151 and let @xmath258 be a non - expansive map from @xmath150 to @xmath334",
    ". then @xmath155 embeds @xmath234 into @xmath344 , and by part 1 .",
    ", @xmath258 is a non - expansive map from @xmath234 to @xmath0 . as @xmath0 is an injective metric space",
    "there is a non - expansive map @xmath345 from @xmath344 to @xmath0 such that @xmath239 , which by part 1 .",
    "is a non - expansive map from @xmath346 to @xmath334 .",
    "since @xmath347 for all @xmath34 , @xmath345 is non - expansive from @xmath151 to @xmath334 .",
    "hence @xmath334 is injective .",
    "conversely , suppose @xmath334 is an injective diversity .",
    "let @xmath234 , @xmath344 be two metric spaces , let @xmath155 be an embedding of @xmath234 into @xmath344 , and let @xmath258 be a non - expansive map from @xmath234 to @xmath0 .",
    "then @xmath258 is a non - expansive map from @xmath348 to @xmath334 and since @xmath334 is injective , there is a non - expansive map @xmath345 from @xmath346 to @xmath334 such that @xmath239 .",
    "applying part 1 .",
    "again , we have that @xmath345 is the required non - expansive map from @xmath344 to @xmath0 .",
    "hence @xmath0 is injective .",
    "since @xmath9 is a diameter diversity , for any finite @xmath179 and @xmath349 , we have @xmath350 for some @xmath351 . hence for finite @xmath352 @xmath353    [ thm : metricdiamdiverseequiv ] let @xmath0 be a metric space with metric tight span @xmath354 .",
    "let @xmath355 be the associated diameter diversity where @xmath331 , and let @xmath339 be its diversity tight span",
    ". then    1 .",
    "the metric space obtained by restricting @xmath148 to pairs in @xmath356 is isometric to the metric space @xmath354 .",
    "the diversity obtained by taking the diameter on the metric space @xmath354 is isomorphic to the diversity @xmath149",
    ".    first note that for any metric spaces @xmath357 and @xmath358 a map @xmath258 from @xmath359 to @xmath360 is an embedding from @xmath357 to @xmath358 if and only if @xmath258 is an embedding from @xmath361 to @xmath362 .",
    "let @xmath363 be the diameter diversity associated to @xmath354 and let @xmath364 be the induced metric for @xmath339 .",
    "let @xmath365 be the kuratowski embedding from @xmath0 to @xmath354 .",
    "then @xmath365 is also an embedding from @xmath9 to @xmath363 . in the same way ,",
    "let @xmath366 be the kuratowski embedding from @xmath9 to @xmath339 .",
    "then @xmath366 is also an embedding from @xmath0 to @xmath364 .    by lemma  [ lem : diaminject ] 2 .",
    ", @xmath363 is a hyperconvex diversity and @xmath364 is a hyperconvex metric space . applying ( * ? ? ?",
    "* proposition 9.20(4 ) ) ) in the category * met * there is an embedding @xmath258 from @xmath354 to @xmath364 such that @xmath367    the identity map @xmath368 on @xmath354 is non - expansive and @xmath258 is an embedding , so applying the definition of injective metric spaces to @xmath354 we have that there is a non - expansive map @xmath345 from @xmath356 to @xmath369 such that @xmath370    by lemma  [ lem : diaminject ] 3 .",
    ", the diversity @xmath371 is a diameter diversity and so from lemma  [ lem : diaminject ] 1 .",
    ", the map @xmath345 is also a non - expansive map from @xmath371 to @xmath363 . combining and we have @xmath372 which is an embedding . by lemma  [ lem : kappaisessential ] we have",
    "that @xmath345 is an embedding , implying that that @xmath258 is both an isomorphism from @xmath354 to @xmath364 and an isomorphism from @xmath363 to @xmath339 .",
    "a metric space @xmath0 is _ additive _ or _ tree - like _ if there is a tree with nodes partially labelled by @xmath1 so that for each @xmath203 the length of the path ( including branch - lengths ) connecting @xmath373 and @xmath146 equals @xmath374 .",
    "dress @xcite showed that if @xmath0 is additive then its metric tight span corresponds exactly to the smallest tree it can be embedded in .",
    "the elements of the tight span correspond not only to the nodes of the original tree , but also the points along the edges . here",
    "we will prove analogous results about phylogenetic diversity .",
    "following @xcite we will work with _ real trees _",
    "( also called metric - trees or @xmath4-trees ) , rather than graph - theoretic trees .",
    "@xcite    1 .",
    "let @xmath375 be a metric space and let @xmath376 be two points at distance @xmath377 .",
    "geodesic _ joining @xmath376 is a map @xmath378 \\rightarrow { \\mathcal{x}}$ ] such that @xmath379 , @xmath380 and @xmath381 for all @xmath382 $ ] . the image of @xmath383 is called a _ geodesic segment_. 2 .",
    "* defn 2.1 ) a metric space @xmath375 is a _ real tree _ or @xmath4-tree if 1 .",
    "there is a unique geodesic segment @xmath384 $ ] joining each pair of points @xmath385 .",
    "if @xmath386 \\cap [ x , z ] = \\{x\\}$ ] then @xmath386 \\cup [ x , z ] = [ y , z]$ ] .",
    "+ hence if @xmath387 are three points in a real tree then @xmath388 \\subseteq [ x , z ] \\cup [ y , z ] .",
    "\\label{eq : rt}\\ ] ]    phylogenetic diversity , as introduced by @xcite and investigated extensively by @xcite and others , can be viewed as a generalisation of additive metrics .",
    "the phylogenetic diversity of a set of nodes or points in a tree is the length of the smallest subtree connecting them , so that the restriction of a phylogenetic diversity to pairs of points gives an additive metric .",
    "a formal definition of phylogenetic diversity on real trees requires a bit more machinery .    for a real tree @xmath375 ,",
    "let @xmath389 be the one - dimensional hausdorff measure on it @xcite .",
    "the important features of @xmath389 for our purposes is that it is defined on all borel sets , it is monotone , and it is additive on disjoint sets . furthermore , for any points @xmath390 , @xmath391)=d(a , b)$ ] , and naturally @xmath392 .",
    "see @xcite for a related measure on real trees .    1 .",
    "the convex hull of a set @xmath393 is @xmath394\\ ] ] and we say that @xmath34 is convex if @xmath395 .",
    "2 .   let @xmath375 be a real tree .",
    "the _ real - tree diversity _",
    "@xmath396 for @xmath375 is defined by @xmath397 for all finite @xmath393 .",
    "note that since @xmath34 is finite , @xmath398 is closed and hence @xmath399 is defined .",
    "first we prove that this phylogenetic diversity satisfies the diversity axioms ( d1 ) and ( d2 ) .",
    "[ thm : phyloisdiv ] let @xmath375 be a real tree . then @xmath396 is a diversity .    since @xmath389 is a measure , @xmath400 is non - negative and also monotonic . if @xmath13 then @xmath401 and so @xmath402 . if @xmath403 then select distinct @xmath404 .",
    "since @xmath405)}=[a , b]$ ] and @xmath391)= d(a , b)$ ] we have @xmath406 .",
    "this proves ( d1 ) .",
    "let @xmath407 and suppose that @xmath14 .",
    "from we have @xmath408 \\subseteq [ a , b ] \\cup [ b , c]\\ ] ] for all @xmath52 , @xmath409 and @xmath410 .",
    "hence @xmath411 and @xmath412 giving us the triangle equality ( d2 ) .",
    "we now show that complete real - tree diversities are hyperconvex , proving the diversity analogue of ( * ? ? ?",
    "* theorem 3.2 ) .",
    "[ lem : closedconvex ] let @xmath375 be a real tree with associated tree diversity @xmath396",
    ". for all finite @xmath413 and @xmath414 , the ball @xmath415 is closed and convex .    for any finite but non - empty @xmath413",
    "the function @xmath416 is continuous .",
    "hence when @xmath417 the ball @xmath418 is closed .    to prove convexity , suppose that @xmath419 .",
    "fix @xmath420 . for all @xmath421 $ ] , @xmath422 and",
    "so @xmath423 showing that @xmath424 .",
    "we have that @xmath425 $ ] , and by symmetry @xmath426 $ ] , are contained in @xmath427 . by we have @xmath428 \\subseteq [ a , x_1 ] \\cup [ a , x_2 ] \\subseteq b(c , r)\\ ] ] so that @xmath427 is both closed and convex .",
    "[ thm : phyloishyper ] let @xmath375 be a real tree with associated real - tree diversity @xmath396",
    ". then @xmath396 is hyperconvex if and only if @xmath375 is complete .",
    "suppose that @xmath375 is a complete real tree .",
    "then @xmath375 is a hyperconvex metric space ( * ? ? ?",
    "* theorem 3.2 ) .",
    "suppose that @xmath429 satisfies @xmath430 for all finite @xmath431 .",
    "we will show that the collection of balls @xmath432 has a non - empty intersection .",
    "first we show that the members of @xmath433 intersect pairwise .",
    "consider a pair of nonempty finite subsets @xmath434 of @xmath1 . to show that @xmath435 and @xmath436 intersect , we show that there is @xmath437 such that @xmath438 and @xmath439 .",
    "this clearly holds if there is @xmath440 .",
    "suppose then that @xmath441 and @xmath442 are disjoint .",
    "since @xmath443 are finite , @xmath441 and @xmath442 are closed subtrees of @xmath444 . by",
    "2 , lemma 1.9 ) there exists @xmath445 and @xmath446 such that @xmath447 \\cap { \\mathrm{conv}(a_i ) } = \\{a_i\\}$ ] and @xmath447 \\cap { \\mathrm{conv}(a_j ) } = \\{a_j\\}$ ] and for all @xmath448 and @xmath449 we have @xmath447 \\subseteq [ x , y]$ ] . then ,",
    "@xmath450 ) + \\mu({\\mathrm{conv}(a_j ) } ) \\\\ & = & { \\delta_{{t}}}(a_i ) + d(a_i , a_j ) + { \\delta_{{t}}}(a_j).\\end{aligned}\\ ] ] hence there is @xmath451 $ ] such that @xmath452 and @xmath453 , so that @xmath454 and likewise @xmath439 .    we have established that @xmath433 satisfies the pairwise intersection property .",
    "the closed , convex sets of a real tree satisfy the helly property @xcite , so every finite subcollection of @xmath433 has non - empty intersection . by the completeness of @xmath375",
    ", @xmath433 has a non - empty intersection , so there is @xmath437 such that @xmath455 for all @xmath456 .",
    "this proves that @xmath396 is hyperconvex .    for the converse ,",
    "we note that completeness of @xmath375 follows directly from ( * ? ? ?",
    "* proposition 3,2 ) and the definition of hyperconvexity for diversities .",
    "a diversity @xmath9 is a _",
    "phylogenetic diversity _ if it can be embedded in a real - tree diversity @xmath396 for some complete real tree @xmath375 .    clearly , every real - tree diversity is a phylogenetic diversity , but a phylogenetic diversity is a real - tree diversity only if its induced metric is a real tree .",
    "[ thm : phylo_if_tight_is_tree ] let @xmath9 be a diversity .",
    "then @xmath9 is a phylogenetic diversity if and only if @xmath149 is a real - tree diversity .",
    "since @xmath9 is a phylogenetic diversity there is a complete real tree @xmath375 with real - tree diversity @xmath396 for which there is an embedding @xmath258 from @xmath457 into @xmath396 . by theorem  [ thm : phyloishyper ] @xmath396 is hyperconvex . by theorem  [ thm : envelope ]",
    "there is an embedding @xmath345 from @xmath149 into @xmath396 such that @xmath458 .",
    "let @xmath459 be the induced metric for @xmath149 .",
    "it follows directly from the hyperconvexity of @xmath149 that @xmath459 is convex . for any @xmath460 and geodesic segment",
    "@xmath461 $ ] in @xmath64 , the image of @xmath461 $ ] under @xmath345 is the unique geodesic segment between @xmath462 and @xmath463 .",
    "it follows that @xmath464 is a convex subset of @xmath375 and @xmath375 restricted to @xmath464 is a real tree ( * ? ? ?",
    "36 ) . restricting @xmath465 to @xmath464",
    "then gives a real - tree diversity which is isomorphic to @xmath149 .",
    "for the converse , note that the map @xmath142 from @xmath9 into its tight span is an embedding , so that @xmath9 is a phylogenetic diversity .",
    "we now link the real tree given by the diversity tight span of a phylogenetic diversity and the tight span of its induced metric .",
    "[ lem : divembed ] let @xmath466 and @xmath467 be complete real trees and let @xmath468 and @xmath314 be the associated real - tree diversities",
    ". then    1 .",
    "@xmath469 is a non - expansive map from @xmath466 to @xmath467 if and only if it is a non - expansive map from @xmath468 to @xmath314 .",
    "@xmath469 is an embedding from @xmath466 to @xmath467 if and only if it is an embedding from @xmath468 to @xmath314 .",
    "suppose that @xmath470 is a non - expansive map from @xmath466 to @xmath467 .",
    "for any finite @xmath471 , we have @xmath472 .",
    "first note that @xmath473 . then note that since in this case the one - dimensional hausdorff measure of a set is a limit of infima of the total length of countable covers of a set by geodesic segments ( * ? ? ?",
    "* section 6.1 ) , @xmath474 for all measurable @xmath475 .",
    "this proves that @xmath345 is a non - expanding map with respect to diversities .",
    "the other direction is immediate .",
    "the argument follows as in 1 , with showing @xmath476 for all measurable @xmath475 .",
    "let @xmath9 be a phylogenetic diversity and let @xmath0 be its induced metric .",
    "let @xmath339 be the diversity tight span of @xmath9 and let @xmath354 be the metric tight span of @xmath0",
    ". then @xmath354 is isometric with the induced metric of @xmath339 .    by ( * ? ?",
    "* theorem 8) , @xmath354 is a real tree .",
    "let @xmath363 be the corresponding real - tree diversity , which is hyperconvex by theorem  [ thm : phyloishyper ] .",
    "let @xmath477 denote the induced metric of @xmath339 .",
    "from theorem  [ thm : phyloishyper ] we have that @xmath477 is a complete real tree and is therefore a hyperconvex metric space ( * ? ? ?",
    "* theorem 3.2 ) .",
    "let @xmath365 be the kuratowski embedding from @xmath0 to @xmath354 and let @xmath366 be the kuratowski embedding from @xmath9 to @xmath339 .",
    "the map @xmath366 is then also an embedding between the induced metric @xmath0 and the induced metric @xmath364 . applying ( * ? ? ?",
    "* proposition 9.20(4 ) ) ) in the category * met * , there is an embedding @xmath478 such that @xmath479 by lemma  [ lem : divembed ] , @xmath258 is also an embedding from the diversity @xmath480 to the diversity @xmath371 . for all @xmath25 , @xmath481 so that @xmath365 embeds @xmath9 in @xmath480 .",
    "the identity map @xmath368 on @xmath354 is non - expansive and @xmath258 is an embedding , so applying the definition of injective metric spaces to @xmath354 we have that there is a non - expansive map @xmath345 from @xmath364 to @xmath354 such that @xmath482    applying lemma  [ lem : divembed ] 1 .",
    "we see that the map @xmath345 is also a non - expansive map from @xmath371 to @xmath363 . combining and we have @xmath372 which is an embedding . by lemma  [ lem : kappaisessential ] we have",
    "that @xmath345 is an embedding , implying that that @xmath258 is an isometry from @xmath354 to @xmath364 .",
    "let @xmath1 be a finite set of points in a metric space @xmath483 .",
    "the _ ( metric ) steiner tree problem _ is to find the shortest network that connects them .",
    "clearly this network will always be a tree .",
    "more formally    metric steiner problem . + * input * : subset @xmath1 of a metric space @xmath483 . +",
    "* problem : * find a ( graph theoretic ) tree @xmath31 for which @xmath484 and @xmath485 is minimised .",
    "+ dress and krger @xcite examined an ` abstract ' metric steiner problem where one drops the constraint that @xmath486 .",
    "this abstract steiner tree was one of the first distance - based criteria proposed for the inference of phylogenetic trees @xcite , though it is now not widely used .",
    "suppose that @xmath31 is a tree with edge weights @xmath487 .",
    "given @xmath488 we let @xmath489 denote the sum of edge weights along the path from @xmath490 to @xmath437 . + abstract steiner problem .",
    "+ * input * : finite metric space @xmath0 . + * problem : * find a ( graph theoretic ) tree @xmath31 and edge weighting @xmath491 such that @xmath492 , @xmath493 for all @xmath203 and @xmath494 is minimised .",
    "+ suppose that @xmath31 is a solution to the metric steiner problem for @xmath495 .",
    "define the weight function @xmath491 by @xmath496 .",
    "then , by the triangle inequality , @xmath493 for all @xmath203 .",
    "it follows then that the length of the minimum abstract steiner tree for @xmath497 is a lower bound for the metric steiner problem .",
    "dress and krger showed that the lower bound becomes tight when @xmath483 equals @xmath498 , the metric tight span of @xmath1 .",
    "[ thm : dktheorem ] let @xmath0 be a finite metric space . for every solution @xmath499 to the abstract steiner tree problem there is a map @xmath500 such that @xmath501 for all @xmath143 and @xmath502 for all @xmath503 .",
    "hence the length of the minimal steiner tree for @xmath312 in @xmath498 equals the length of the minimal abstract steiner tree for @xmath0 and the minimal abstract steiner trees can be embedded within the tight span .",
    "a direct corollary is that if @xmath2 is tree - like then the abstract steiner tree equals the tree corresponding to @xmath2 .",
    "here we show that , using diversities , we can obtain a tighter bound on the metric steiner problem than that given by the abstract steiner problem . given a tree @xmath31 with edge weights @xmath504 and @xmath505 we let @xmath506 be the sum of edge weights in the smallest subtree of @xmath31 connecting @xmath34 . hence @xmath507 is a phylogenetic diversity . + diversity steiner problem .",
    "+ * input * : finite diversity @xmath9 . + * problem : * find a ( graph theoretic ) tree @xmath31 and edge weighting @xmath491 such that @xmath492 , @xmath508 for all @xmath187 , and @xmath494 is minimised .",
    "+ let @xmath1 be a finite subset of a metric space @xmath483 .",
    "for each @xmath32 let @xmath509 denote the minimum length of a ( metric ) steiner tree connecting the points @xmath34 in the metric space @xmath483 .",
    "we see that @xmath510 is a diversity . for each @xmath511 , consider the _ truncated _ diversity @xmath512 defined by @xmath513 for all @xmath32 .",
    "[ prop : treebound ] if @xmath499 is a minimum length solution for the diversity steiner problem applied to @xmath512 then the length @xmath514 of @xmath31 is a lower bound for @xmath515 , the optimal length of a metric steiner tree for @xmath1 .",
    "let @xmath516 be a solution to the metric steiner problem and let @xmath517 be the associated phylogenetic diversity . then for all @xmath121 such that @xmath518 we have that @xmath519 , the length of @xmath520 restricted to @xmath121 , is bounded below by @xmath521 .",
    "it follows that @xmath522 for all @xmath32 , so that @xmath516 is a potential solution for the diversity steiner problem .",
    "as @xmath499 is optimal , we have @xmath523    for @xmath524 , the bounds provided by the proposition [ prop : treebound ] coincide with those given by length of the minimum abstract steiner tree . as @xmath525 increases , the bounds returned by the diversity steiner tree applied to @xmath512 will tighten , until eventually the diversity steiner tree will coincide with the metric steiner tree . furthermore , we have a direct extension of theorem  [ thm : dktheorem ] , stating that these diversity steiner trees will all be contained in the diversity tight span .",
    "let @xmath9 be a finite diversity .",
    "for every solution @xmath499 to the diversity steiner tree problem for @xmath9 there is a map @xmath500 such that @xmath501 for all @xmath143 and @xmath526 for all @xmath503 .",
    "let @xmath527 be the diversity on @xmath528 given by @xmath499 , as defined above . since @xmath499 solves the diversity steiner problem , @xmath529 for all @xmath32 .",
    "let @xmath142 denote the canonical embedding from @xmath1 to @xmath64 .",
    "then @xmath142 is a non - expansive map from @xmath507 to @xmath149 .",
    "the tight span @xmath149 is injective .",
    "hence there is a non - expansive map @xmath258 from @xmath530 to @xmath149 such that @xmath501 for all @xmath143 . for each @xmath531 let @xmath532 .",
    "then @xmath533 for all @xmath534 .",
    "consider @xmath32 , and let @xmath535 be the set of edges in the smallest subtree of @xmath31 containing @xmath34 . by the triangle inequality , @xmath536",
    "hence @xmath537 is a candidate for the diversity steiner problem , but since @xmath499 is already minimum , @xmath538 .",
    "it follows that @xmath539 for all @xmath540 .",
    "v.  chepoi , b.  fichet , a note on three - way dissimilarities and their relationship with two - way dissimilarities , in : selected contributions in data analysis and classification , stud .",
    "classification data anal . knowledge organ . ,",
    "springer , berlin , 2007 , pp .",
    "465475 .",
    "j.  admek , h.  herrlich , g.  e. strecker , abstract and concrete categories , pure and applied mathematics ( new york ) , john wiley & sons inc . , new york , 1990 , the joy of cats , a wiley - interscience publication ."
  ],
  "abstract_text": [
    "<S> the tight span , or injective envelope , is an elegant and useful construction that takes a metric space and returns the smallest hyperconvex space into which it can be embedded . </S>",
    "<S> the concept has stimulated a large body of theory and has applications to metric classification and data visualisation . </S>",
    "<S> here we introduce a generalisation of metrics , called diversities , and demonstrate that the rich theory associated to metric tight spans and hyperconvexity extends to a seemingly richer theory of diversity tight spans and hyperconvexity .    </S>",
    "<S> tight span ; injective hull ; hyperconvex ; diversity ; metric geometry ; </S>"
  ]
}