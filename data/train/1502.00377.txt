{
  "article_text": [
    "video object tracking is a fundamental problem in the academic research of image / video processing and computer vision , involving two key issues : ( i ) extracting objects of interest from backgrounds and ( ii ) establishing correspondences of objects over video frames .",
    "trajectory parsing and analysis for multiple targets is a further task upon target tracking , and plays a critical role in the recently - arising intelligence applications , such as robotics  @xcite and video surveillance systems  @xcite .",
    "it is also an important support for higher level video retrieval and event analysis  @xcite .",
    "the object of this work is to study a unified approach for trajectory analysis under the bayesian framework . as fig .",
    "[ fig : front_fig ] illustrates , the input of our algorithm is a short sequence of observed frames rather than a single frame , in which we localize the multiple moving targets and track them with their identities preserved ; the global trajectories of targets for the whole video can be parsed through the inference .          in the literature ,",
    "video object tracking has been intensively studied and many effective methods have been proposed . for single - target tracking , various object appearance models and motion models",
    "are well exploited to estimate target state ( location , velocity , etc . )",
    "recently , a class of techniques called `` tracking by detection '' has been shown to provide promising results  @xcite .",
    "for multi - object tracking ( i.e. trajectory analysis ) , which our method addresses , we shall identify multiple moving targets by associating correspondences between observations and objects as well as estimating the state of each target  @xcite .    in general",
    ", we roughly categorize the work of trajectory analysis into two types : sequential inference based , and deferred inference based , in terms of the number of input frames for inference .",
    "\\(i ) sequential inference based methods use the information of the currently observed frame to predict the states of moving targets and assign their target identities .",
    "the classical examples are particle filtering  @xcite and optical flow  @xcite .",
    "recently , avidan  @xcite proposed a learning - based tracker using the online adaboost algorithm , which maintains a discriminative detector to track targets in the current frame .",
    "babenko et al .",
    "@xcite significantly improved the tracking performance using multiple instance learning ( mil ) . despite great success , these approaches may yield identity lossing ( or switching ) and trajectory fragmentation in terms of mutual - interaction , occlusion and spurious motion , because they make online decisions while discarding global information .",
    "\\(ii ) deferred inference based methods , also referred as global data association based tracking , are to identify each observation with either a track i d or a false alarm in a short period of time , e.g. @xmath0 frames .",
    "the observations , namely , moving blobs , can be obtained by using methods such as background subtraction .",
    "the first attempts on data association optimization are multiple hypothesis tracker  @xcite , and joint probabilistic data association filters  @xcite , which search the hypothesis ( the associations of observations and targets ) by assuming one - to - one mapping , i.e. one observation to one target .",
    "once this assumption is relaxed , e.g. a target consisting of a set of observations , the search space of optimization grows exponentially with the number of frames and targets . to overcome this problem ,",
    "many deterministic optimal algorithms have been employed , such as extended dynamic programming  @xcite , quadratic boolean programming  @xcite , and hierarchical hungarian algorithm  @xcite .",
    "however , it is still impractical to apply these methods for intelligence surveillance systems , due to the following aspects  @xcite .",
    "first , some approaches of trajectory analysis need good initializations , e.g. , manually annotating targets or assuming no conglutination at the beginning frame .",
    "second , due to the ambiguity caused by the similar appearances of coupled targets , it is difficult to stably maintain the correct identities of targets with long term tracking . in the example in fig .",
    "[ fig : challenge ] ( a ) , the track ids of targets are switched in the crowd scene  @xcite .",
    "third , the affinity model of a moving target , i.e. object representation , is not discriminative with respect to complex surrounding clutter , illumination and object scale changes , which often leads to false tracking or the splitting of one target into several pieces  @xcite , as the examples shown in fig .",
    "[ fig : challenge ] ( b ) and ( c ) .",
    "according to the literature review , the proposed approach belongs to deferred inference based methods .",
    "the goal of our approach is to parse trajectories of moving targets under the bayesian framework , in which searching for the optimal trajectory solution is formulated as a problem of maximizing a posterior probability ( map ) .",
    "we briefly introduce our method in the following three aspects : a composite feature for matching affinity of moving targets , a spatio - temporal graph for representing the task of trajectory analysis , and an iterative stochastic algorithm for global inference .",
    "\\(i ) in surveillance videos , particularly for some outdoor scenes , it is a critical issue to robustly recover correspondences over frames against illumination changes , drastic motion , etc .",
    "a consensus from a recent image feature research  @xcite is that a good image feature for tracking demands two properties : ( i ) the discrimination , i.e. distinctive matching over frames , and ( ii ) the robustness , i.e. geometric - invariance , and tolerance of non - rigid motion , etc .",
    "in fact , these two properties sometimes conflict with each other .",
    "for example , one may increase the region size ( scale ) of a local feature and/or the dimensionality of the descriptor , but a larger feature is usually less robust in tracking with photometric and geometric changes . in this paper",
    ", we propose a composite image feature to represent moving targets .",
    "we employ two types of well - known image features , surf  @xcite and mser  @xcite , in the composite features .",
    "each composite feature is composed of a feature region generated by mser detector within a set of surf feature points .",
    "this scheme is similar with the bundled feature  @xcite proposed by sun et al .",
    "@xcite for web image search , but we define a different matching metric to adapt object tracking .",
    "\\(ii ) given the extracted composite features from the observed frames , we can build up a spatial graph and a temporal graph to pose the problem of trajectory analysis as a joint task of spatial graph partitioning and temporal graph matching . in the spatial graph , each graph vertex is a detected composite feature and each graph edge is defined by the appearance and motion consistency of the two adjacent vertices . in the temporal graph ,",
    "each graph vertex implies one underlying target consisting of a connected cluster of composite features , and the graph edges denote the matching correspondences between targets in consecutive frames . with these graph representations",
    ", the task of graph partitioning corresponds with extracting and segmenting targets from background ; the graph matching task is equivalent to establishing the correspondences of targets over frames .",
    "we can further formulate these tasks by maximizing posterior probability under the bayesian framework .",
    "in addition , two types of scene contexts are integrated as the informative prior , including : ( i ) target size prediction using scene geometric information , inspired by the previous work  @xcite , and ( ii ) target motion prior model by the path statistics .",
    "these types of prior knowledge are very informative to make the model robust and efficient .",
    "for example , with two people walking close together with similar appearances , our model tends to segment them into two individual targets according to the prior term of target size prediction .",
    "\\(iii ) it is a non - trivial optimization procedure to search for the maximum of the posterior probability with our formulation .",
    "there are many ambiguities caused by conglutinations , occlusions , and similar appearances of targets and background clutters in some crowded surveillance scenes .",
    "the searching order or rule for an optimal solution is thus quite difficult to design . in the perspective of energy minimization",
    ", there exists quite a few local minimums , e.g. , track i d switching , in the search for energy minimums .",
    "therefore , unlike the deterministic or heuristic searching in the previous work of trajectory inference  @xcite , we design a stochastic sampling algorithm using the markov chain monte carlo ( mcmc ) mechanism  @xcite to explore the solution space . in literature , some work  @xcite shows great results on solving spatio - temporal data association by an mcmc - based algorithm . in our method",
    ", we adopt an mcmc - based cluster sampling method , namely swendsen - wang cut  @xcite , for optimal solution exploration .",
    "the algorithm iterates between two types of mcmc dynamics for the spatial graph partitioning and temporal graph matching respectively .",
    "compared with some recently proposed approaches  @xcite which also adopt stochastic inference for trajectory analysis , the major advantages of the proposed method are as follows .",
    "( 1 ) we adopt two types of mcmc dynamics to iteratively solve the video object segmentation and tracking , which are mutually conditional and closely coupled .",
    "this algorithm is able to explore the global optimal solution and eliminate the need for good initializations .",
    "( 2 ) the proposed composite feature provides a flexible and robust representation against scene clutters and object geometric deformations in tracking .",
    "( 3 ) we apply our method to various challenging surveillance videos from several public datasets and show that it outperforms other approaches .",
    "this paper is organized as follows .",
    "we first introduce the problem representation and formulation in section  [ sect : representation ] and section  [ sect : formuation ] .",
    "then section  [ sect : inference ] presents the algorithm for trajectory inference , and section  [ sect : implementation ] describes the implementation details and the system flow .",
    "a set of experiments and comparisons are proposed in section  [ sect : experiments ] , and the paper is concluded with discussions in section  [ sect : discussion ] .",
    "given an input video , we set the observed window spanned over @xmath1 frames for each computation of trajectory analysis . the observed window is moving with a step - size of @xmath2 frames . using a state - of - the - art background modeling algorithm  @xcite , the image lattice @xmath3 of each frame is initially partitioned into foreground and background domains @xmath4 .",
    "the trajectory analysis takes the foreground domain as the input , although the background subtraction is not perfect , i.e. occurring false alarm regions .",
    "we then propose a novel image feature , namely the composite feature , extracted from the foreground domain , based on which a spatial graph and a temporal graph are constructed .",
    "each vertex in the spatial graph is a composite feature and each vertex in the temporal graph represents a segmented moving target . in the following , we start by introducing the composite features , then define the problem of trajectory analysis via graph representation , and present the probabilistic formulation .          for representing moving objects ,",
    "we propose a composite image feature that bundles a region with several key points for improving both discrimination and robustness .",
    "the proposed composite feature involves two popular features : the point feature surf  @xcite and the region feature mser  @xcite .",
    "the surf keypoint exploits scale - space extrema by determination of hessian matrix and employs integral image for rapid computation .",
    "the mser feature is defined by an extremal property of its intensity function in the ellipse region and on its outer boundary .",
    "both of these two features are robust against viewing angle , scale , and illumination changes .",
    "some extracted surf points and mser regions are shown in fig .",
    "[ fig : comp_feature ] ( b ) .    given a foreground image domain @xmath5 ,",
    "we first detect the point and region features , denoted by @xmath6 and @xmath7 respectively .",
    "we allow overlaps among the region features , and discard those with large size , i.e. those containing others or spanning half the size of the foreground domain .",
    "a composite feature @xmath8 is then defined as @xmath9 where @xmath10 indicates that the point feature @xmath11 exists inside the region feature @xmath12 .",
    "the composite feature including no surf points will be removed automatically . in practice ,",
    "the number of surf points in each composite feature is @xmath13 .",
    "a moving target represented by the composite features is illustrated in fig .",
    "[ fig : comp_feature ] .",
    "the measuring energy @xmath14 of two composite features @xmath15 and @xmath16 includes two terms : _ independence similarity _ and _ configuration consistency_. @xmath17 where @xmath18 is a weighted parameter for the two terms .",
    "\\(i ) the independence similarity @xmath19 is based on the matching distance of two region features .",
    "the energy of this term is defined as , @xmath20 where @xmath21 is the descriptor for surf feature .    , and",
    "for the right one , its relative order is @xmath22 .",
    "thus , the configuration consistency of these two composite features is : @xmath23 . ]",
    "\\(ii ) the configuration consistency @xmath24 performs a weak geometric verification between two composite features .",
    "let @xmath25 denotes the set of matched feature pairs of two composite features @xmath15 and @xmath16 .",
    "this set can be quickly calculated by matching surf points in a greedy manner : searching the best match for each point in region of the corresponding composite feature .",
    "we define their configuration consistency based on the relative order with point matching . given the centroid of region feature , the relative order of inside points can be determined according to their spatial distance to the centroid . as fig .",
    "[ fig : match_comp_feature ] illustrates , we number the points in the left based on the spatial distance to the centroid , i.e. 1,2,3,4,5 ; the numbers of points in the right is propagated from the left points based on the matching correspondence . and the consistency can be computed as , @xmath26 where @xmath27 denotes the relative order of the points , @xmath28 is the indicator function , and @xmath29 is the number of matched point pairs .",
    "the unmatched point pairs are not taken into account in the definition because the appearance dissimilarity has been penalized by the first term @xmath30 in eqn .",
    "[ eqn : ind_similarity ] .",
    "specifically , the cost by @xmath30 would be relatively large with respect to the @xmath31 , if the numbers of points are discrepant ( e.g. , 5 v.s .",
    "moreover , to make this consistency penalty smooth and gentle , we can additionally apply the _ sigmoid _ function on the relative order computation .",
    "we observe that , unlike a single type of features , a composite feature provides a flexible and stable representation that captures the distinctive image primitives as well as the geometric structure .",
    "given the observed window , i.e. a period of frames @xmath32}$ ] , we extract the composite features @xmath33 on the foreground areas @xmath34}$ ] .",
    "then we obtain a set of spatial graphs @xmath35}$ ] , where each composite feature is treated as the graph vertex @xmath36 .",
    "the goal of trajectory analysis is to segment moving targets and recover their correspondences in each frame . with the graph representation ,",
    "this problem is posed as a joint task of graph partitioning and matching .    }",
    "( b ) shows the foreground mask for frame @xmath37 .",
    "( c ) illustrates the spatial attribute graph of the currently observed frame @xmath37 , where each graph vertex denotes a composite feature of the foreground domain and has four bonds connecting to neighboring vertices .",
    "the graph edges imply the motion and appearance consistency between two adjacent vertices .",
    "the edges between the foreground and background domains are turned off automatically .",
    "( d ) illustrates the temporal attribute graph with the vertices being the connected clusters of spatial graph vertices .",
    "each temporal graph vertex indicates an underlying target .",
    "the edges in the temporal graph represent the matching correspondences over frames .",
    "note that the vertices in the bottom row in ( d ) indicate the unmatched regions and have no temporal connections . ]",
    "* i. spatial graph partitioning * is to segment targets over a time span @xmath1 . as illustrated in fig .",
    "[ fig : stgraph ] ( b ) , we represent the partition of the observed frames as @xmath38}$ ] , @xmath39}=\\{\\pi_t ; t=0,1,2,\\ldots,\\tau\\ } \\nonumber \\\\ \\pi_t=\\{u_{t , i};i=0,1,2,\\ldots , k_t\\},\\end{aligned}\\ ] ] where @xmath40 is the target number at time @xmath41 , and @xmath42 indicates the false alarm regions , i.e. not target regions but proposed as the foreground .",
    "each moving target @xmath43 at time @xmath41 is described by a bounding box , @xmath44 where @xmath45 denotes the target center and @xmath46 denotes the width and height .",
    "the initial foreground domain @xmath5 consists of the target image domains @xmath47 and false alarm domains @xmath48 , @xmath49    we solve the foreground partitioning @xmath50 with a spatial graph representation ( as shown in fig .",
    "[ fig : stgraph ] ( c ) ) , defined over the foreground image lattice with nearest @xmath51 neighbor connections , @xmath52 , where @xmath53 is the set of graph vertices and @xmath54 is the set of link edges connecting neighboring graph vertices .",
    "each spatial graph vertex @xmath55 includes one composite feature @xmath56 and the corresponding label @xmath57 $ ] , indicating the vertex belongs to certain target or false alarm .",
    "therefore , each target @xmath43 at time @xmath41 corresponds to a set of connected graph vertices @xmath58 .",
    "we solve the task of graph partitioning by turning off edges , i.e. , generating disjoint subgraphs , which will be introduced in section  [ sect : spatial_sampling ] .",
    "temporal graph matching * is recovering the correspondences of targets over time span @xmath1 .",
    "we represent a set of matching matrices by @xmath59}$ ] , @xmath60 } & = & \\{\\phi_t;t=1,2,\\ldots,\\tau-1\\ } \\\\\\nonumber \\phi_t(u_{t , i } ) & = & u_{t+1,i } \\bigcup \\{\\emptyset\\},\\end{aligned}\\ ] ] where each matrix @xmath61 describes a mapping relation from the @xmath41-th frame to the @xmath62-th frame .",
    "a target matching to @xmath63 indicates that it is occluded or moving out at the current frame ( i.e. being `` killed '' ) , while a target with no matches in previous frames indicates that it is newly appearing ( i.e. being `` born '' ) .    as illustrated in fig .",
    "[ fig : stgraph ] ( d ) , a temporal graph @xmath64 is defined for moving targets .",
    "each temporal graph vertex @xmath65 includes a moving target @xmath43 and its matching label @xmath66 at time @xmath41 .",
    "each edge indicates the matching relation of two vertices between adjacent frames , as @xmath67 .",
    "since we have performed partitioning on the spatial graph , we can reasonably assume one - to - one mapping between temporal nodes .",
    "note that unmatched nodes are allowed to stand alone , caused by false alarm regions from the background subtraction . in fig .",
    "[ fig : stgraph](d ) , the blobs with different colors represent the temporal graph nodes and the dotted ones indicate the unmatched regions .    therefore , for the problem of trajectory completion , we define the following solution representation @xmath68 from the observed @xmath69}$ ] as @xmath70}=\\{k_{[0,\\tau]},\\pi_{[0,\\tau]},\\phi_{[0,\\tau]}\\},\\end{aligned}\\ ] ] where @xmath71}$ ] denotes the foreground target number in time span @xmath1 , @xmath38}$ ] denotes the partition result for each frame , and @xmath59}$ ] denotes the matching correspondences of moving targets between adjacent frames in the form of matrix mapping from one target to another .",
    "equivalently , the solution configuration of trajectory completion can also be represented by @xmath72 motion trajectories , also called `` cables '' in  @xcite , @xmath73}=\\{n , c_i;i=0,1,\\ldots n\\},\\end{aligned}\\ ] ] where @xmath74 represents the false alarm regions , and other cable represents the trajectory of a foreground moving target , respectively .",
    "this representation makes it simple to define the motion models .",
    "@xmath75\\ } ) ;   i \\!=\\ !",
    "1,\\ldots , n , \\\\",
    "\\!\\!\\!\\!\\!\\!c_0\\!\\!\\ ! & = & \\!\\{u_{t,0};t=0,1,\\ldots,\\tau\\},\\end{aligned}\\ ] ] where @xmath76 and @xmath77 denotes the birth time and death time of the trajectory @xmath78 , respectively",
    ".    therefore , in the probabilistic formulation in section  [ sect : formuation ] , we shall be able to switch between the two notations above .",
    "based on the definition of solution @xmath68 , we can formulate the inference problem in a bayesian framework , and the optimal solution @xmath79 can be solved by maximizing a posterior probability , @xmath80}^ * \\!\\ ! & = & \\!\\ ! \\arg \\max_w p(w_{[0,\\tau]}|i_{[0,\\tau ] } ) \\\\ & = & \\!\\!\\!\\ !",
    "\\arg \\max_w p(i_{[0,\\tau]}|w_{[0,\\tau]};\\beta ) p(w_{[0,\\tau]}| \\theta)\\nonumber , \\end{aligned}\\ ] ] where @xmath81 and @xmath82 are the parameters for the likelihood and prior models respectively .",
    "we define prior model @xmath83}| \\theta)$ ] on scene contexts , which provide informative guidance for graph partitioning and matching , as @xmath84}|\\theta)\\!\\!\\ ! = \\!\\!\\!p(\\pi_{[0,\\tau ] } ) \\cdot p(\\phi_{[0,\\tau]}).\\ ] ] note that each probability term is assumed to be independent , since they can be calculated irrelatively .    * i. partition prior @xmath85})$ ] * we assume each frame is separately segmented and define the prior as , @xmath86})\\!\\!=\\!\\!\\prod_{t=0}^\\tau p(\\pi_t)\\!\\!=\\!\\!\\prod_{t=0}^\\tau\\prod_{i=0}^{k_t}p(u_{t , i}).\\end{aligned}\\ ] ] instead of using the potts model as a partition prior in previous work  @xcite , we predict the target location and size according to the scene surface property and information of camera calibration .",
    "according to the research of using geometric context  @xcite , the object size in the image plane is correlated with the physical size ( in the real world ) according to the scene geometric information , i.e. the camera parameters and the ground plane .",
    "the scene geometry can be roughly estimated in an interactive manner in a surveillance system according to a recent work  @xcite .",
    "we can then employ the informative prior of target size in the image plane , if the tracked targets belong to a specific object category .",
    "in other words , the prior distribution of target size is conditional on the target location in the image . in this work ,",
    "considering the requirement of real - time processing , it is not practical to integrate the target recognition in the trajectory analysis , and we thus make the assumption that the semantic label of targets is specified in a certain scene . in fact , this assumption is reasonable , e.g. , the indoor surveillance systems usually aim at about people while the outdoor systems usually track vehicles .",
    "[ fig : locationsize ] ( a ) illustrates the location - size prediction with scene geometry .",
    "let @xmath87 and @xmath88 denote the top and the bottom of car , @xmath89 the intersection of the car and the horizon line in the image plane , and @xmath90 the vertical vanishing point .",
    "besides , let @xmath91 denote the car height and @xmath92 the camera height . the expected size of an observed vehicle on the ground plane can be predicted by simply following the cross ratio theorem , @xmath93 therefore we can obtain the target size distribution with respect to the target location @xmath94 .",
    "suppose the location of target @xmath43 is @xmath95 and the partition prior can be thus written as @xmath96 an example of predicting sizes of vehicles in the surveillance scene is presented in fig .",
    "[ fig : locationsize ] ( b ) , where we sample vehicle sizes from @xmath94 .        *",
    "ii . matching prior on trajectory @xmath97 } ) $ ] * for simplicity , we use the cable representation to define this prior model , which includes two terms : ( i ) the birth , death , length ( lifespan ) of the cable , and ( ii ) trajectory shape of the cable .",
    "thus , we have the matching prior factorized to obtain the following probability terms , @xmath98})\\!&=&\\!\\prod_{i=0}^n p(c_i),\\\\ \\!p(c_i ) \\ ! & = & \\ !",
    "p(t_{i , b},t_{i , d } ) p(\\gamma_i , \\mathcal{r}),\\end{aligned}\\ ] ] where @xmath78 represents the @xmath99-th target trajectory .",
    "the first term @xmath100 gives the prior distribution of birth / death on the global trajectory as shown in fig .",
    "[ fig : pathmodel ] ( a ) .",
    "@xmath101 denotes the trajectory shape , i.e. the curve of the trajectory .",
    "the second term @xmath102 is a global motion prior based on a path model @xmath103 , which consists of a set of reference trajectories @xmath104 , as shown in fig.[fig : pathmodel ] ( b ) .",
    "we can learn these reference trajectories by clustering in a supervised way according to the method reported by wang et al  @xcite .",
    "then the motion prior is in the form of a mixture model plus a robust statistic , as @xmath105 where the function @xmath106 denotes the geometrical distance  @xcite between the shapes of two trajectories , and @xmath107 is a tuning parameter for robustness .",
    "the likelihood model @xmath108}|w_{[0,\\tau]};\\beta)$ ] includes the two following aspects : ( i ) the region appearances fitting with the background model , and ( ii ) the appearance consistency of the trajectories . @xmath109}|w_{[0,\\tau]};\\beta)\\!\\!\\!\\ ! &",
    "= & \\!\\!\\!\\ ! \\prod_{t=0}^\\tau   p(\\lambda^f_t | \\pi_t , \\mathcal{b } )   \\\\\\nonumber & & \\cdot\\prod_{i=1}^n p(\\lambda(c_i ) | c_i),\\end{aligned}\\ ] ] where @xmath5 denotes the image domain of the foreground and @xmath110 the background model proposed by  @xcite .",
    "@xmath111 indicates the image domain covered by trajectory @xmath78 , i.e. the moving target @xmath112 over @xmath41 frames .",
    "the appearance consistency of the trajectories @xmath113 is equivalent to the matching similarity between targets over frames , as @xmath114 where @xmath115 and @xmath47 denote the image domains of adjacent targets .",
    "the target matching can be further calculated by measuring the composite features of the targets , @xmath116 where @xmath117 is the distance metrics between two composite features , as defined in eqn.[eqn : feature_measure ] .",
    "@xmath118 denotes the total number of extracted features in the target .",
    "given the spatial and temporal graph representations , the problem of trajectory recovery is posed as two coupled tasks of spatial graph partitioning @xmath38}$ ] and temporal graph matching @xmath59}$ ] . in this section ,",
    "we discuss a stochastic sampling algorithm to jointly solve the two tasks .    the reasons of using stochastic scheme rather than other deterministic optimization methods , e.g. belief propagation , or graph - cuts , are as follow .",
    "( 1 ) it is difficult to design fast searching rules due to the unpredictable variance and ambiguity of tracked targets . ( 2 ) the probabilistic formulation is a non - convex representation . ( 3 ) we usually can not obtain the reliable initialization for trajectory analysis .",
    "the proposed stochastic inference algorithm , designed under the metropolis - hasting mechanism  @xcite , is able to efficiently seek the optimal solution @xmath119}$ ] from the posterior probability @xmath120 } | { { \\bf i}}_{[0 , \\tau]})$ ] as defined in eqn .",
    "[ eq : posterior ] , @xmath121}^ * \\sim p(w_{[0 , \\tau ] } | { { \\bf i}}_{[0 , \\tau]}).\\ ] ] we simulate a ergodic and aperiodic markov chain in which the algorithm visits a sequence of states in the joint space of @xmath122 } , \\phi_{[0,\\tau]}\\}$ ] over the time span @xmath1 .",
    "specifically , the sampling process iterates between two types of markov chain monte carlo ( mcmc ) dynamics and infers the graph partitioning @xmath38}$ ] and graph matching @xmath59}$ ] respectively .",
    "there are two components working in the iterative manner as follows :    * fixing the current state of graph matching @xmath59}$ ] , we perform cluster sampling to explore the new solutions of graph partition @xmath38}$ ] . *",
    "fixing the current state of graph partition @xmath38}$ ] , we update the graph matching state @xmath59}$ ] by changing the matching relations of objects in the trajectories .    in both two components ,",
    "each sampling is achieved by realizing a reversible jump ( i.e. operator ) between any two successive states to explore new solutions , for either graph partitioning or graph matching .",
    "the acceptance of a new state is decided based on a metropolis - hastings  @xcite decision to guarantee the convergence of the inference algorithm . in general ,",
    "given two successive states @xmath89 and @xmath87 for either partitioning or matching , the acceptance rate is defined as : @xmath123 where @xmath124 and @xmath125 are the posterior probability of @xmath119}$ ] defined in eqn .  [",
    "eq : posterior ] .",
    "@xmath126 is the proposal probability to drive the state transition from @xmath87 to @xmath89 and conversely , @xmath127 is the proposal probability from state @xmath89 to @xmath87 .",
    "how to design the proposal probability for driving the solution state transition is a non - trivial task that was addressed by a branch of works in literature  @xcite .",
    "recently , a mcmc - based cluster sampling algorithm , namely `` swendsen - wang cut''(swc ) , is proposed for image segmentation , which is able to simplify the calculation of the ratio of proposal probability @xmath128 in graphical models .",
    "we refer to  @xcite for the theoretical background .    in the following ,",
    "we will discuss , respectively , the cluster sampling algorithm for graph partitioning and graph matching .    , is generated by turning edges off and then to be re - labeled for new solution states . ]          given a spatial graph @xmath129 extracted in the observed frame @xmath130 $ ] , we utilize the swc sampling for the graph partition inference .",
    "the algorithm achieves a reversible jump between two states in the solution space including the following two steps",
    ".    * step 1 .",
    "* we generate a connected cluster by probabilistically turning off the edge links in the graph .    in the spatial graph @xmath131 ,",
    "suppose that @xmath53 is the set of graph vertices specifying the composite features and @xmath54 is the set of edges connecting neighboring graph vertices , as shown in fig .",
    "[ fig : stgraph ] ( c ) . for notation simplicity ,",
    "we omit the time stamp @xmath41 and the superscript @xmath132 in the algorithm description . for any edge @xmath133",
    ", we introduce an auxiliary random variable @xmath134 , i.e. the connecting variable , which indicates whether the edge is turned on or off .",
    "the edge turn - on probability @xmath135 is defined according to the similarity of the two connected vertices , @xmath136 where @xmath137 and @xmath138 are two graph vertices connected by the edge @xmath139 .",
    "we collect some discriminative appearance and motion features ( like the color , orientation gradient , and optical flow ) , which form a compact histogram @xmath140 , i.e. each histogram bin indicates a specific feature dimension . for the image domain of the vertex",
    ", we describe colors by luv metrics and pool over into @xmath141 bins ; the orientation gradients are quantized with @xmath142 bins , and the optical flows with @xmath143 bins . for an edge @xmath144 ,",
    "the turn - on probability @xmath135 of two adjacent vertices can be thus defined with their appearance and motion consistency , as @xmath145 where @xmath146 is the kullback - leibler divergence between any two histograms and @xmath147 is a constant temperature factor .",
    "hence each edge is turned off with probability @xmath148 ( as shown in fig .",
    "[ fig : spatial_states ] ) .",
    "it is worth mentioning that the turn - on probabilities of edges are calculated during the graph extraction before the sampling iteration .    for an arbitrary edge @xmath139 , we then sample the connecting variable @xmath149 following the bernoulli probability , @xmath150 thus , graph vertices connected together by `` on '' edges form a connected cluster ( denoted by @xmath151 for simplicity ) , in which all vertices will share the same label in partitioning .",
    "usually vertices in a @xmath151 have similar appearance and thus most likely belong to the same object .",
    "[ fig : spatial_states ] illustrates a @xmath151 generated from different partition states .",
    "note the edge between different objects ( different colored nodes ) are turned off deterministically .",
    "compared to other graph partition algorithm ( e.g. , graph - cuts  @xcite ) that turns off the edges by analytically finding the maximum flow over edges , the sampling method enables us to search for more possible solutions of graph partition .",
    "therefore , the ratio of proposal probability @xmath128 in eqn .",
    "[ eq : acceptance ] can be re - factorized as generating and labeling the connected cluster , as , @xmath152 where @xmath153 and @xmath154 denote the connected cluster generated on state @xmath89 and @xmath87 , respectively .",
    "@xmath155 denotes the set of edges that are turned off on state @xmath89 , and similarly @xmath156 is the turned - off edge set on @xmath87 .",
    "then we discuss the labeling of connected component in the next step .",
    "* step 2 . *",
    "we explore for a new solution of graph partitioning by labeling the generated @xmath151 . in practice ,",
    "a few ( e.g. @xmath157 ) @xmath151s will be generated and we select one of them randomly .",
    "assume that the current partition state is @xmath158 where @xmath159 denotes the background regions and @xmath160 $ ] a segmented object .",
    "note that the @xmath151 may include the vertices from multiple targets .",
    "then we can assign the @xmath151 a label from @xmath161 to @xmath162 to update the partition state by three types of reversible jumps .    * * split - and - merge * the @xmath151 is extracted from one object and merged into another one .",
    "the jump between the state ( a ) and ( b ) is an example as shown in fig .",
    "[ fig : spatial_states ] .",
    "this jump is self - reversible . * * split * the selected @xmath151 is assigned a new label , that is , a new object is created . in fig .",
    "[ fig : spatial_states ] , from state ( a ) or ( b ) to state ( c ) is a `` birth '' jump . * *",
    "merge * the whole object is selected as a @xmath151 and merged into another object , as from state ( c ) to state ( a ) or ( b ) in fig .",
    "[ fig : spatial_states ] . the split jump and merge jump are mutual reversible .",
    "these jumps can be defined in the same form as , @xmath163\\ } \\nonumber\\\\ \\rightleftarrows \\ { l(v ) =",
    "i ' , v \\in cc , i ' \\in [ 1 , k]\\},\\end{aligned}\\ ] ] where @xmath164 indicates the label of vertex @xmath165 .",
    "[ alg : sketch ]    \\1 .",
    "construct graphs on new frames .",
    "+  ( 1 ) calculate an initial foreground map by the background subtraction .",
    "+  ( 2 ) extract the composite features by surf and mser detectors .",
    "+  ( 3 ) construct the initial spatial graphs on each frame with each composite feature being a vertex .",
    "+  ( 4 ) construct the initial temporal graph .",
    "perform the sampling algorithm with the new frames @xmath166 $ ] .",
    "+  ( 1 ) for each frame @xmath167 $ ] , loop for @xmath168 sampling iterations .",
    "+  ( i ) perform sampling for spatial graph partitioning on frame @xmath41 .",
    "+  ( ii ) accept the new partition state according to the acceptance rate in eqn .",
    "[ eq : acceptance ] .",
    "+  ( 2 ) sample the temporal graph matching with frames @xmath169 $ ] in @xmath170 iterations .",
    "+  ( i ) perform sampling for temporal graph matching .",
    "+  ( ii ) accept the new matching state according to the acceptance rate in eqn .",
    "[ eq : acceptance ] .",
    "perform the sampling algorithm within the global observed period @xmath171 $ ] .",
    "+  loop for @xmath170 rounds +  ( 1 ) randomly select @xmath172 frames in @xmath171 $ ] , and for each frame @xmath41 loop for @xmath173 sampling iterations .",
    "+  ( i ) perform sampling for spatial graph partitioning on frame @xmath41 .",
    "+  ( ii ) accept the new partition state according to the acceptance rate in eqn .",
    "[ eq : acceptance ] . +  ( 2 ) sample the temporal graph matching with frames @xmath171 $ ] in @xmath170 iterations . +  ( i ) perform sampling for temporal graph matching .",
    "+  ( ii ) accept the new matching state according to the acceptance rate in eqn .",
    "[ eq : acceptance ] .",
    "output the final solution of trajectory analysis @xmath119}$ ] .",
    "graph matching sampling in the temporal graph is similar with sampling in the spatial graph .",
    "note that the temporal sampling may cause state changing in the spatial graph , since each segmented object in the spatial graph is a node in the temporal graph , as shown in fig .",
    "[ fig : stgraph ] ( d ) .",
    "similarly , we first need to construct the temporal graph @xmath64 within the observed period @xmath171 $ ] , and calculate the turn - on probabilities of edges @xmath174 between arbitrary neighboring vertices . recall that each vertex @xmath175 indicates a moving target represented by a bounding box as shown in eqn .",
    "[ eq : target_represent ] .",
    "we can thus use some simple appearance features on the image domains of vertices to define the turn - on probability , just similar with the definition in the spatial graph shown in eqn .",
    "[ eq : qe ] .    in the inference for graph",
    "matching , we first randomly select one trajectory @xmath78 at the current solution state , which is a bit different compared with the inference in the spatial graph . and we generate a sub - trajectory as the connected cluster @xmath151 by probabilistically turning off the edge connections , as illustrated in fig .  [",
    "fig : temporal_states ] ( a ) .",
    "the @xmath51 types of reversible jumps are then performed to update the solution state .",
    "[ fig : temporal_states ] illustrates the transition of solution states .",
    "* * birth * assigning a new color for the selected @xmath151 , that is , to create a new cable ( trajectory ) , as illustrated in fig .",
    "[ fig : temporal_states ] ( d ) . * * merge * the selected @xmath151 is merged into another cable , as shown in fig .",
    "[ fig : temporal_states ] ( e ) . in practice",
    ", we merge the @xmath151 with neighboring cables . * * death * setting the selected @xmath151 as background ( false alarm ) , as shown in fig .",
    "[ fig : temporal_states ] ( c ) . *",
    "* swap * this is an important operator in temporal sampling .",
    "given a selected @xmath151 , we swap it with another sub - cable in the same time span .",
    "[ fig : temporal_states ] ( b ) is the succedent state of the current state in fig .",
    "[ fig : temporal_states ] ( a ) caused by the this operator .",
    "assume that @xmath72 trajectories are traced in the observed period on the current state and each vertex @xmath165 in the trajectory represents a moving target .",
    "the birth , death , and swap jumps can be defined in the same form as , @xmath176\\ } \\nonumber \\\\ \\rightleftarrows \\ { l(v ) = i ' , v \\in cc , i ' \\in [ 0 , n]\\},\\end{aligned}\\ ] ] where @xmath177 represents the label of @xmath165 . the implementation for the swap jump is a bit different , since we need to select another sub - cable , as @xmath178 where @xmath179 represents to swap labels of the two vertices .",
    "we summarize the sketch of the proposed method in algorithm  [ alg : sketch ] , and introduce the detailed implementation in section  [ sect : implementation ] .      the joint space of @xmath122 } ,",
    "\\phi_{[0,\\tau]}\\}$ ] over the time span @xmath1 is so large that it is prohibitive to search it exhaustively .",
    "for example , consider a case that there are @xmath162 spatial graph vertexes and @xmath72 trajectories ( moving targets ) in average .",
    "the solution space has in the order of @xmath180 . in statistics",
    ", we can simplify the maximum searching for joint probability by using the conditional probability , if the prior is assumed to be weak .",
    "this inspires us to design the algorithm to iteratively sample the conditional probabilities , @xmath181 } | \\phi_{[0,\\tau ] } ) $ ] and @xmath182 } | \\pi_{[0,\\tau]})$ ] , respectively , with the two mcmc dynamics .",
    "the joint solution space is then separated into two relatively simple spaces .",
    "for either solution space of spatial graph partitioning or temporal graph matching , the markov chain is ergodic via performing the reversible jumps , based on the metropolis - hasting mechanism  @xcite .",
    "as the space is finite , all states can be visited following the observation that there is a non - zero probability for any node to be chosen into the connected component and assigned a label by activating the jumps .",
    "then the markov chain can move from a state to any other state with non - zero probability in finite steps .    in our method",
    ", we have to limit the number of sampling steps for efficiency consideration , as described in algorithm  [ alg : sketch ] .",
    "then the global convergence is no longer guaranteed and the algorithm might obtain a local minimum .",
    "nevertheless , we find the experimental results satisfactory due to the following reasons .",
    "first , the integration of informative prior models , e.g. , @xmath85})$ ] , effectively accelerates the inference by fast rejecting false positive proposals .",
    "second , the cluster sampling is much more efficient than traditional simpling methods .",
    "the process of generating the connected cluster is the key to efficiency improvement , in which the discriminative appearance and motion features are collected for generating effective proposals .",
    "moreover , the cluster sampling enlarges the space that the stochastic process can possibly visit , and avoids often getting stuck in local minimums .",
    "an empirical study of inference convergence will be introduced in section  [ sect : experiments ] .",
    "in this section , we apply our method to a video surveillance system which also involves a background modeling module  @xcite , and carry out the experiments with comparisons to the state - of - the - art approaches .",
    "we start by introducing the parameter settings in our experiments .",
    "we set the value of the observed time span @xmath183 frames , and we set the observed window moving forward with a step - size of @xmath184 frames .",
    "the other related parameters for our approach are introduced as follows .    for the composite feature definition ( in section  [ sect : representation ] ) , the histogram of local orientations @xmath21 consists of @xmath185 quantized bins and each bin indicates a small range of orientation angles , i.e. @xmath186 degrees .",
    "the weighted parameter @xmath18 for measuring similarity of composite features is empirically set as @xmath187 .    for the introduced prior models ( in section  [ sect : formuation ] ) ,",
    "we train them in an initial stage for each specific surveillance scene .",
    "the partition prior @xmath188})$ ] , i.e. the location - size prediction for tracked targets , is obtained by estimating the extrinsic camera parameters using an interactive calibration toolkit  @xcite , where we need to label a few parallel lines and tracked targets to calculate the vanishing points .",
    "note that we make an assumption that the camera is fixed with only one degree of freedom , namely its height @xmath92 . for the matching",
    "prior on trajectory @xmath97 } ) $ ] , we set the tuning parameter for robustness @xmath189 .",
    "the geometrical distance of two trajectories @xmath190 is normalized into @xmath191 $ ] .",
    "it is worth mentioning that we are allowed to disable these prior models by setting them uniform , although they are very effective in applications .    given a period of observed frames @xmath171 $ ] ,",
    "we extract composite features on the newly arriving frames , i.e. @xmath51 frames for each sliding window , where we construct the spatial graphs and a temporal graph .",
    "note that the initial temporal graph consists of composite features also , since temporarily no moving target is segmented in the new frames . in the following ,",
    "the sampling procedure includes two stages : sampling in the new frames @xmath166 $ ] and sampling in the whole observed period @xmath171 $ ] .",
    "\\(i ) in the first stage , spatial graph partitioning is performed and the number of sampling iterations at each frame is bounded at @xmath168 ; vertices ( composite features ) are grouped to indicate potential moving targets due to their consistent appearances and motions .",
    "and then we sample the temporal graph matching with frames @xmath169 $ ] , where the @xmath192-th frame should be taken into account , since we need to extract correspondences between the previous frames and the new frames .",
    "we set iteration number of the temporal matching sampling as @xmath170 .",
    "\\(ii ) in the second stage , the spatial graph partitioning and temporal graph matching are performed iteratively in a loop .",
    "the loop is set as @xmath170 rounds , and each round includes two sampling iterations .",
    "( 1 ) first , a small number ( i.e. @xmath193 ) of frames in @xmath171 $ ] are first randomly selected for graph partition sampling , and the number of sampling iterations at each frame is bounded at @xmath173 .",
    "( 2 ) then we perform matching sampling in the observed period @xmath171 $ ] for @xmath170 iterations .",
    "we use three public video databases , trecvid08  @xcite , pets  @xcite , and lhi  @xcite , to evaluate our method and compare with other state - of - the - arts approaches .",
    "these databases are very challenging for the multi - target tracking task , including scenarios with severe occlusions , scale changes or complex background structure .",
    "a number of video clips from these databases are selected for testing , i.e. , @xmath194 videos from lhi , @xmath195 from pets and @xmath195 from trecvid .",
    "we manually annotate the bounding boxes of targets in the videos as the ground - truth . in our method , the types ( semantic labels ) of tracking targets are provided , which serve as the prior information .",
    "the videos selected from the trecvid and pets are all indoor scenes and the moving targets are all pedestrians ; the videos in lhi are captured from outdoor traffic surveillance , and we thus track the moving vehicles as the targets . table  [ tab : databases ] summarizes the number of frames as well as the number of targets in the testing videos .",
    "all the testing videos are with the frame rate of @xmath0 fps and the frame size of @xmath196 pixels .",
    "the experiments are carried out on a high - performance workstation with core duo @xmath197 ghz cpu and @xmath195 gb memory .",
    "the computational efficiency for all steps ( as described in algorithm  [ alg : sketch ] ) in our system is summarized as follows . on average",
    ", the step of constructing graphs on new frames costs @xmath198 ms ; it costs @xmath199 ms to perform sampling on new frames , including spatial graph partitioning and temporal graph matching ; sampling within the global observed period costs around @xmath200ms .",
    "recall that the algorithm processes @xmath51 newly arriving frames at a time , i.e. , the observed window is moving with a step - size of @xmath51 frames .",
    "thus , our system is capable of processing @xmath172 frames per second on average . in practice",
    ", we can enhance the efficiency by reducing the numbers of sampling iterations .",
    ".testing sequences from public video databases [ cols=\"^,^,^\",options=\"header \" , ]         table  [ tab : result_tracvid ] , table  [ tab : result_pets ] , and table  [ tab : result_lhi ] show the quantitative results of our results with the results proposed by zhao et al .",
    "@xcite , and huang et al .",
    "the method by zhao et al .",
    "@xcite tracks pedestrians with a model - based approach to interpret the image observations by multiple partially occluded human hypotheses , and thus we only apply this method on the trecvid and pets databases for human tracking .",
    "the results show that our method achieves the best performance , greater recall , greater precision , fewer fa / frm , and fewer switchids .",
    "to illustrate the benefits of using informative priors in trajectory analysis , we also report the system performances in the setting of disabling the prior components .",
    "the analysis of these experiments are presented as follows .    1 .",
    "using deferred frames for global inference , i.e. an observed window , is very helpful , which provides us with more information to handle occlusions and mutual interactions . 2 .   the prior components , e.g. the location - size prediction , gives very important cues for segmenting conglutinated targets",
    "; they effectively reduce the false alarms .",
    "3 .   the matching prior on trajectory , birth , death , lifespan of the cable , and shape of the cable , are strong constraints particularly for tracking vehicles in the traffic surveillance scene , since the motions of vehicles are usually regular in a certain scene .",
    "4 .   in the pets",
    "dataset , many pedestrians have very similar appearances ( e.g. in black coats ) or motions ( e.g. walking together ) , despite which the iterative sampling algorithm is shown to effectively reduce the number of switchids .    in addition , we propose a novel benchmark metric to evaluate the trajectory - level performance , namely average tracing rate ( atr ) , which is defined as the ratio of the traced trajectory length with respect to the ground - truth .",
    "the horizontal axis of atr represents the coverage rate of the traced trajectory compared to the ground - truth of the testing videos ; the vertical axis represents the proportion of trajectory length .",
    "the atr for a result of trajectory analysis is in the form of a spot - curve for a discretized level of evaluation .",
    "this metric is very intuitive and straightforward to visualize the consistency of the tracking trajectories . in fig .",
    "[ fig : tracing_rate ] , we propose the atr curves of our method on the three datasets . in this evaluation , we compare with two other mcmc - based stochastic approaches for trajectory analysis , mcmc data association ( mcmc ) by yu et al .",
    "@xcite and trajectory parsing by liu et al .  @xcite .",
    "to further analyze the algorithm convergence , we present an empirical study on visualizing the output energy in inference . here the output energy , @xmath201 } | i_{[0,\\tau]}))$ ] , is the logarithm of posterior probability within an observed period @xmath171 $ ] .",
    "[ fig : convergence ] ( a ) , for an arbitrary period , we compare with gibbs sampling for the trajectory analysis . for comparison ,",
    "we replace the cluster sampling method at each step by the traditional gibbs sampler  @xcite in the algorithm .",
    "we observe that the cluster sampling converges significantly faster .",
    "moreover , we investigate the output energies with respect to the two important parameters in our system , the observed period length @xmath1 and the forward step - size @xmath2 . this experiment is also carried out within a period of observed frames .",
    "we first fix @xmath202 and discretely increase @xmath1 by @xmath186 scales : @xmath203 .",
    "that is , we increase the length of period and deal with more video frames in inference .",
    "then we increase @xmath204 with fixed @xmath205 , to gradually reduce the overlap with the previous inference .",
    "the empirical results are reported in fig .",
    "[ fig : convergence ] ( b ) , where the horizontal axis represents the scale for either parameter .",
    "the objective of this paper is to track multiple video targets and recover their trajectories , against occlusion , interruption , and background clutter .",
    "compared with the previous methods in literature , the main contributions of this paper are as follows .",
    "first , we propose a novel unified framework of trajectory analysis to together solve spatial graph partitioning and temporal graph matching .",
    "second , a robust composite feature bundling the mser feature and surf feature is presented for the affinity model of moving targets , against scale transition and non - rigid motion .",
    "third , we design a stochastic sampling algorithm to iteratively solve the spatial graph partition and temporal graph matching .",
    "this algorithm is designed under the metropolis - hastings method without the need for good initializations .",
    "we have applied our method in an intelligence video system and found satisfactory performance . in experiments ,",
    "our method is tested on several challenging videos from the public video databases of visual surveillance , including trecvid , pets , and lhi , and it outperforms the state - of - the - art methods .    in future work , it is important to integrate object recognition  @xcite into the trajectory analysis , which will lead to a more general solution for video surveillance applications .",
    "in addition , we plan to study the parallel implement for the mcmc - based inference to further improve the computation efficiency .",
    "x. liu , l. lin , h. jin , s. yan , and w. tao , integrating spatio - temporal context with multiview representation for object recognition in visual surveillance , _ ieee transactions on circuits and systems for video technology _ , 21(4 ) : 393 - 407 , 2011 .",
    "l. yang , j. si , k. s. tsakalis , a. a. rodriguez , direct heuristic dynamic programming for nonlinear tracking control with filtered tracking error , _ ieee transactions on smc , part b _ ,",
    "39(6 ) : 1617 - 1622 , 2009 ."
  ],
  "abstract_text": [
    "<S> in order to track the moving objects in long range against occlusion , interruption , and background clutter , this paper proposes a unified approach for global trajectory analysis . instead of the traditional frame - by - frame tracking , </S>",
    "<S> our method recovers target trajectories based on a short sequence of video frames , e.g. @xmath0 frames . </S>",
    "<S> we initially calculate a foreground map at each frame , as obtained from a state - of - the - art background model . </S>",
    "<S> an attribute graph is then extracted from the foreground map , where the graph vertices are image primitives represented by the composite features . with this graph representation , </S>",
    "<S> we pose trajectory analysis as a joint task of spatial graph partitioning and temporal graph matching . </S>",
    "<S> the task can be formulated by maximizing a posteriori under the bayesian framework , in which we integrate the spatio - temporal contexts and the appearance models . </S>",
    "<S> the probabilistic inference is achieved by a data - driven markov chain monte carlo ( mcmc ) algorithm . </S>",
    "<S> given a peroid of observed frames , the algorithm simulates a ergodic and aperiodic markov chain , and it visits a sequence of solution states in the joint space of spatial graph partitioning and temporal graph matching . in the experiments , our method is tested on several challenging videos from the public datasets of visual surveillance , and it outperforms the state - of - the - art methods .    </S>",
    "<S> trajectory analysis , multiple object tracking , graph partitioning and matching , video surveillance . </S>"
  ]
}