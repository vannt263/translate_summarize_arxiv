{
  "article_text": [
    "the high photometric precision demanded by _ kepler _ @xcite requires detailed knowledge of how pixels respond to starlight during a nominal observational interval .",
    "this is provided by the _",
    "kepler _ pixel response function ( prf ) , a super - resolution representation of the interaction of starlight with pixels that includes modulation by pointing jitter and other systematic effects during an observation ( this usage of prf differs from that in @xcite ) .",
    "the prf provides a continuous representation that allows the prediction of a star s flux value on any pixel given the star s pixel position : these pixel values are samples of the prf at the star s sub - pixel position .    the _ kepler _ focal plane @xcite consists of 42 @xmath0 ccds , each of which is divided into two @xmath1 output channels .",
    "a prf model is defined on each of these 84 output channels , accounting for ccd tip / tilt and other channel - level variations . due to variation in the optical psf within an output channel ,",
    "the prf model is pixel - position dependent (  [ section : prfrepresentation ] ) .",
    "data is collected at a 29.4 minute cadence ; we refer to this sampling interval as a `` long cadence '' .",
    "bandwidth limitations prevent the storage and downlinking of all @xmath2 pixels at each long cadence : at most @xmath3 pixels are downlinked per long cadence .",
    "the prf currently contributes to _ kepler s _ precision by supporting the selection of optimal pixels for aperture photometry (  [ section : optimalpixels ] ) , and providing high - precision prf - fitted centroids (  [ section : stellarcentroids ] ) for attitude determination , crucial for removing the effects of pointing jitter from photometry .",
    "these are sufficient to attain _",
    "kepler s _ current high precision @xcite .",
    "the future use of differential image analysis will use the prf to perform target and pixel level sensitivity corrections , including local image motion , further increasing _",
    "kepler s _ precision .",
    "a star s position on the _ kepler _ focal plane is computed with the software package _ radec2pix _ , developed by the _",
    "science operations center ( soc ) .",
    "this package uses the _ kepler _ focal plane geometry ( fpg ) model (  [ section : fpg ] ) , as well as kepler optical , nominal spacecraft attitude , and velocity aberration models .",
    "the _ kepler _ prf on an output channel is represented as a continuous piece - wise polynomial function of sub - pixel position on each pixel , providing a super - resolution image of the light of a star falling on the pixels .",
    "pixel values are determined by evaluating the prf given the pixel and sub - pixel position of a star : the pixel position determines where the prf is placed in the output channel s pixel array , while the sub - pixel position determines the pixel values .",
    "figure  [ fig1 ] shows two example prfs and corresponding pixel values .",
    "computation of the prf from stellar images requires knowing where those images fall on the focal plane .",
    "each star s coordinates are provided by the kepler input catalog ( kic ) , and the physical location of the ccds relative to each other provided by the _ focal plane geometry _ ( fpg ) model (  [ section : fpg ] ) .",
    "determination of the fpg model , however , requires prf - fitted stellar centroids (  [ section : stellarcentroids ] ) , so fpg and prf are mutually dependent .",
    "therefore we determine both fpg and prf in an iterative process (  [ section : prffpgiteration ] ) .",
    "a _ kepler _ prf is defined on a grid of @xmath4 pixels called the _ prf pixel array _ , where @xmath5 is large enough to capture the full prf .",
    "each pixel in the prf pixel array is sub - divided into @xmath6 sub - pixel regions .",
    "each sub - pixel region is assigned a two - dimensional polynomial @xmath7 , where @xmath8 are the pixels indices in the @xmath4 prf pixel array and @xmath9 are the sub - pixel indices in the @xmath6 sub - pixel grid on pixel @xmath8 .",
    "therefore there are @xmath10 two - dimensional polynomials associated with a prf on an output channel . for most channels @xmath11 is sufficient to capture the prf , while for some channels @xmath12 is required .",
    "we find @xmath13 provides sufficient sub - pixel detail .",
    "the order of each of these polynomials is determined by a maximal information criterion (  [ section : prfcomputation ] ) .",
    "each pixel of the prf pixel array gives the flux on that pixel from a star whose location is in the central pixel of the prf pixel array .",
    "thus the central pixel represents the peak of the star s prf while pixels towards the edge represent the flux in the wings of that star s prf .",
    "the values of these fluxes depend on the sub - pixel position of the star .",
    "prf polynomials are determined independently of each other , so they will not match at sub - pixel boundaries .",
    "we handle the resulting discontinuities using two strategies : ( 1 ) the discontinuities are minimized by fitting the prf using data that extends into adjacent sub - pixel regions as described in [ section : prfcomputation ] and ( 2 ) the remaining discontinuities are smoothed when evaluating the prf as described in  [ section : prftopixels ] .    a position - dependent prf is implemented by measuring five prfs on each output channel : one at each corner and one at the center .",
    "linear interpolation on the resulting triangles as described in ",
    "[ section : prftopixels ] provides an interpolated prf at any point in the output channel .",
    "this model neglects pixel - level variations , which are treated during calibration @xcite .      the focal plane geometry ( fpg ) model represents each of the 42 ccds on the _ kepler _ focal plane via the center position , rotation angle , and plate scale of each ccd .",
    "prior to launch the ccd positions were known with an accuracy of @xmath14 pixels ; the fpg model provides the required accuracy of @xmath15 pixels .",
    "the input to the fpg model computation is a two dimensional polynomial which maps right ascension and declination to pixel location .",
    "these _ motion polynomials _ are derived via a fit to the observed pixel positions of known stars via prf centroiding (  [ section : stellarcentroids ] ) , and serve as a smoothing filter , reducing the impact of observational errors of individual stars .",
    "fpg computation determines the ccd locations of a set of sky coordinates in two ways : via the _ radec2pix _",
    "library , which uses the fpg model ; and via the motion polynomials , which do not use the fpg model .",
    "the fpg model parameters are adjusted via a levenberg - marquardt non - linear least squares algorithm until the differences between the model and observation are minimized .",
    "the fpg model computation also provides the spacecraft attitude .",
    "the prf provides expected pixel values for a given star with a given magnitude and sky location .",
    "the output channel and pixel position of the star is determined via the _ radec2pix _ library .",
    "this pixel position determines which triangle contains the star s central pixel , which determines which three ( of five ) prfs are used to compute the star s final image .",
    "pixel values for the star are determined from each of the three prfs by evaluating the prf polynomials at the sub - pixel position of the star . on each pixel in the prf pixel",
    "array the sub - pixel region containing the star s sub - pixel coordinates is chosen .",
    "the polynomial in that sub - pixel region is evaluated at the star s sub - pixel location , providing the relative flux for that pixel .",
    "this results in an array of @xmath4 pixels reflecting the relative flux of the star based on that prf .    when the sub - pixel location of a star is close to the boundary between sub - pixel patches , the following method smoothes out inter - patch discontinuities .",
    "the pixel value is evaluated using all nearby polynomial patches ( two patches near an edge , four patches near a corner ) .",
    "adjacent polynomial patches can be evaluated at these positions because patches are defined using data that extend into adjacent patches (  [ section : prfcomputation ] ) . for simplicity",
    "we consider the case of an edge , where we have two values @xmath16 and @xmath17 from the two polynomial patches adjacent at that edge .",
    "these values are smoothly interpolated using the distance @xmath18 of the star s sub - pixel position from the edge with the formula @xmath19 . here",
    "the weight @xmath20 is given , assuming @xmath18 is normalized so that it ranges from 0 on one side of the edge to 1 on the other side of the edge , by @xcite @xmath21 the scale factor @xmath22 determines the steepness of the exponential curve .",
    "@xmath20 has the property that it is equal to 0 for @xmath23 , equal to 1 for @xmath24 , and equal to 0.5 for @xmath25 .",
    "further , @xmath20 has continuous derivatives of all order , even at @xmath26 and @xmath27 .",
    "this approach smoothly eliminates the discontinuity at the boundary between the polynomial patches .",
    "the above process is repeated for all three prfs defined on the triangle containing the star s central pixel , giving three @xmath4 pixel arrays , one at the location of each prf .",
    "these pixel arrays are linearly interpolated in the plane of the triangle , giving the final relative pixel values for this star .",
    "these relative pixel values are multiplied by the total flux of the star in the _ kepler _ bandpass via the _ kepler _ magnitude given by the kepler input catalog . the final pixel array",
    "is then placed in the output channel pixel array in the location corresponding to the pixel position of the star . repeating this process for every star on an output channel results in a synthetic image that should match the actual image observed in flight , assuming the kic is accurate ( figure  [ fig2 ] )",
    "the prf was measured during the commissioning phase of the _ kepler _ mission , after the photometer was brought into final focus .",
    "the prf measurement strategy was to collect observations of bright , uncrowded , unsaturated stars , which are used to fit the prf polynomial patches .",
    "the prf measurement used 19,189 stars in the _ kepler _ field with magnitudes between 12 and 13 that did not have significant ( @xmath28 ) flux from other stars in a @xmath29 pixel aperture centered on the star .",
    "these stars were observed for 242 cadences of 14.7 minute duration , half a long cadence , to reduce the time required to perform the observations .",
    "data for the prf measurement were obtained from each odd cadence , while the spacecraft slewed to a new dither location during the even cadences .",
    "these 121 prf data cadences visited the achieved locations shown in figure  [ fig3 ] , which were used in the prf computation .",
    "the order of visitation of this pattern was randomized to minimize the impact of time - varying systematics .",
    "the pixel values for each star are converted to relative pixel values by normalizing by the total flux from that star .",
    "the pixels from each star measurement of the 121 data cadences are treated as independent data points , resulting in 2,321,869 observations distributed on 84 output channels .",
    "the distribution was uneven , with some channels having many more stars than others .",
    "two types of prf are computed for each output channel : a single prf using all targets , and a set of five prfs to capture intra - channel prf variation as described in  [ section : prftopixels ] . when computing the five - prf set , the data for each of the five prfs are selected from a region near where that prf is defined .",
    "for each corner prf the data is selected from a square extending from that corner into the input channel .",
    "for the central prf the data is selected from a square centered on the output channel .",
    "the size of each square is set to include a specified minimum number of targets , so the squares on a crowded channel will be smaller than the squares on a channel with fewer stars .",
    "we find that ten stars is sufficient to create prfs that capture the cores with good quality .",
    "once the data for a particular prf is selected , the pixel data is grouped in two ways : ( 1 ) the integer pixel coordinates of each pixel are registered onto the @xmath4 prf pixel array so that the central pixel of the star corresponds to the central pixel of the prf pixel array .",
    "( 2 ) each star s pixel is placed into a sub - pixel bin corresponding to the sub - pixel region containing that star .",
    "the sub - pixel bin covers a larger area than the sub - pixel region , providing overlapping data used for the polynomial fit , minimizing discontinuities between adjacent polynomial patches . for each pixel in the prf pixel array , and for each sub - pixel region in that pixel , the @xmath30th pixel value @xmath31 is collected with its sub - pixel coordinates @xmath32 .",
    "the prf polynomial patch @xmath33 for that sub - pixel region is the polynomial that minimizes @xmath34 ^{2}.   \\label{eqn : prf_least_squares}\\ ] ] here @xmath35 is the number of pixel values in this sub - pixel region for this pixel , and @xmath36 is the uncertainty in the measurement of @xmath31 ( figure  [ fig4 ] )",
    ".    the order of the polynomial is determined by the modified akaike information criterion @xcite .",
    "if @xmath37 is the mean square error of the polynomial fit @xmath38 for a given order @xmath39 , then akaike s modified information criterion selects the order that minimizes @xmath40 where @xmath41 is the number of coefficients in the polynomial @xmath38 for order @xmath39 .",
    "the polynomial order will vary from sub - pixel region to sub - pixel region .",
    "the minimal solution to equation ( [ eqn : prf_least_squares ] ) is found using a fitting method that is robust against outliers .",
    "a difficulty was encountered when computing prfs in a five - prf set . while the data was sufficient to capture the core of the prf ,",
    "the far wings were highly vulnerable to background pollution from dim background stars due to the small number of targets used .",
    "in contrast , the single prfs computed on the same output channel using all the targets had , for the most part , well - behaved wings ( we occasionally hand - edited the single prf far wings to remove obvious background pollution ) . the solution was to replace polynomials in the far wings of the prfs in the 5-prf set with those from the corresponding pixel and sub - pixel regions from the single prf .",
    "the region of replacement was determined by computing a contour of a manually determined background value that encloses the prf core in each prf of the five - prf set .",
    "all polynomial patches outside that contour were replaced by polynomials from the single prf .",
    "the resulting discontinuities were of the same magnitude as the discontinuities that already existed between polynomial patches .",
    "the resulting prfs do a good job of simulating pixel flux from the stars in the kic , as shown in figure  [ fig2 ] .",
    "we find that central pixel energies vary across the _ kepler _ focal plane , with 11% of the output channels having central pixel energies less than 0.3 , 20% between 0.3 and 0.4 , 37% between 0.4 and 0.5 , 28% between 0.5 and 0.6 , and 4% between 0.6 and 0.7 .",
    "there are several possible sources of prf error , including :    * changes in the statistics of spacecraft pointing jitter .",
    "this has remained stationary over time but is being monitored .",
    "* focus has changed slightly but measurably over time due to water desorption and thermal variations @xcite .",
    "* kic errors , including variable stars and blends , can distort the measured prf and cause errors for individual stars .",
    "* ccd non - uniformities . *",
    "the prf computation did not attempt to include effects due to star color .",
    "pre - flight simulated prfs based on code v simulations of the optical psf from ball aerospace and technologies corporation indicate that color can have a non - trivial effect on the prf .",
    "the impact and mitigation of these errors is an area of active investigation .",
    "the computation described in ",
    "[ section : prfcomputation ] assumes that the pixel data have been calibrated , had their background removed , and that that _ kepler _ attitude and fpg model are known .",
    "pixel data calibration and background removal are performed by the same software from the _ kepler _ soc pipeline that is used to process _ kepler _",
    "science data @xcite .",
    "the _ kepler _ attitude and fpg model , however , are based on prf centroiding (  [ section : stellarcentroids ] ) .",
    "therefore an iterative approach is required .",
    "two soc modules are used : cal , which performs pixel - level calibration , and pa which performs background characterization and removal as well as stellar centroiding and computation of motion polynomials ( pa also performs aperture photometry during _ kepler _ science processing , but prf does not use this feature ) .",
    "background - removed pixels are not persisted in the soc pipeline , so the background removal function of pa must be called with each iteration .",
    "prf processing begins with a non - iterative bootstrap phase : pixel data is calibrated by cal , then pa is called with a pre - launch estimate of the prf and fpg models that are used for centroiding and motion polynomial creation . at this point",
    "the iterative loop is entered : the fpg calculation provides an updated fpg model and attitude solution ; pa performs background removal ; the prf computation described in  [ section : prfcomputation ] is performed ; pa performs centroiding and motion polynomial computation using the updated prf .",
    "the iteration is repeated until the fpg model is observed to converge .    to obtain convergence ,",
    "it was necessary to `` pin '' the centroid of the prf computed in  [ section : prfcomputation ] to a specific location because both prf and fpg can move the location of a star image on a ccd .",
    "we chose to constrain the prf so that the value - weighted centroid of all input pixel values is at the center of the prf array .",
    "there is a limit of @xmath3 pixels per _ kepler _ long cadence . among these pixels",
    "are those chosen for stellar _ kepler _ targets @xcite .",
    "these pixels are selected to support high - precision aperture photometry of these targets : for each stellar target those pixels are selected which maximize the signal - to - noise ratio ( snr ) for that target .",
    "the selection process relies on synthetic images generated using the prf , kic and a zodiacal light model . for each target ,",
    "two synthetic images are created : 1 ) an image that contains the target star only ( `` target '' ) and 2 ) all stars except the target star , plus zodiacal light ( `` scene '' ) .",
    "both images include effects of saturation , charge transfer efficiency and smear induced by the lack of a shutter .",
    "the noise for each pixel @xmath42 ( in electrons ) contains contributions from shot , read ( @xmath43 ) and quantization noise ( @xmath44 ) @xcite and is computed as @xmath45 .",
    "the snr of the pixel is @xmath46 .",
    "the pixels are sorted in decreasing order of snr . starting with the first pixel , as each pixel",
    "is added the snr of the collection of pixels is computed , and the collection of pixels that maximize the collection s snr defines the optimal aperture for this target .",
    "margin against prf and kic errors is provided by a ring of pixels placed around the optimal aperture , as well as a column of pixels on the left for undershoot correction @xcite .",
    "the result is the _ requested aperture _ for storage and downlinking .",
    "software on the _ kepler _ spacecraft supports 1024 arbitrarily shaped _",
    "spacecraft apertures _ , far fewer than the number of requested apertures .",
    "therefore each requested aperture is assigned to the spacecraft aperture with the smallest number of pixels that contains the requested aperture .",
    "figure  [ fig5 ] shows example optimal and spacecraft apertures .",
    "a synthetic image containing all stars in the kic is used to determine background pixels that are stored , downlinked and used to build and remove a background model in soc processing of the science targets .",
    "centroid locations for unsaturated , sufficiently bright target stars are determined by prf fitting : a non - linear fit is performed which varies the location and flux of the prf , minimizing the @xmath47 of the pixel - wise difference of the prf - based pixel image (  [ section : prftopixels ] ) and the flight pixel values for that target .",
    "the resulting centroids show high stability , with changes over time of about @xmath48 millipixels ( after removing systematic effects ) .",
    "errors in the prf model induce local biases , which exhibit a median of about 1 millipixel and median absolute deviation of  22 millipixels pixels , across the focal plane .",
    "akaike , h. , 1974 ieee transactions on automatic control 19 ( 6 ) : 716 argabright , v. s. , et al . , 2008 spie 7010 bathala , n. , et al . , 2010 , in press borucki , w. j. , et al . ,",
    "2010 science , 327 ( 5968 ) : 977 caldwell , d. a. , et al .",
    ", 2010 , in press haas , m. r. et al . , 2010 , in press jenkins , j. m. , et al . , 2010 , in press jenkins , j. m. , et al . , 2010 , in press koch , d. g. , et al . , 2010 , in press lauer , t. r. , 1999 , 111 ( 765):1434 warner , f. w. , 1983 , foundations of differentiable manifolds and lie groups , ( springer )"
  ],
  "abstract_text": [
    "<S> _ kepler _ seeks to detect sequences of transits of earth - size exoplanets orbiting solar - like stars . </S>",
    "<S> such transit signals are on the order of 100 ppm . the high photometric precision demanded by _ kepler _ requires detailed knowledge of how the _ kepler _ pixels respond to starlight during a nominal observation . </S>",
    "<S> this information is provided by the _ kepler </S>",
    "<S> _ pixel response function ( prf ) , defined as the composite of _ kepler s _ optical point spread function , integrated spacecraft pointing jitter during a nominal cadence and other systematic effects . to provide sub - pixel resolution , </S>",
    "<S> the prf is represented as a piecewise - continuous polynomial on a sub - pixel mesh . </S>",
    "<S> this continuous representation allows the prediction of a star s flux value on any pixel given the star s pixel position . </S>",
    "<S> the advantages and difficulties of this polynomial representation are discussed , including characterization of spatial variation in the prf and the smoothing of discontinuities between sub - pixel polynomial patches . on - orbit super - resolution measurements of the prf across the _ kepler _ field of view </S>",
    "<S> are described . </S>",
    "<S> two uses of the prf are presented : the selection of pixels for each star that maximizes the photometric signal to noise ratio for that star , and prf - fitted centroids which provide robust and accurate stellar positions on the ccd , primarily used for attitude and plate scale tracking . </S>",
    "<S> good knowledge of the prf has been a critical component for the successful collection of high - precision photometry by _ </S>"
  ]
}