{
  "article_text": [
    "a crucial bottleneck in extracting systems - level information from direct statistical mechanical simulations in general , and from molecular dynamics ( md ) in particular , is that the simulations sample phase space `` at their own pace '' , dictated by the shape and barriers of the effective free energy surface .",
    "long simulation times are thus `` wasted '' revisiting already explored locations in conformation space . over the last twenty years",
    "there has been a tremendous amount of effort invested , and many truly creative solutions proposed , for biasing the simulations so as to circumvent this .",
    "techniques that have now become a standard part of the simulator s toolkit , like umbrella sampling or shake , biasing techniques like importance sampling , milestoning , path sampling or metadynamics , techniques like the nudged elastic band / string method , and -more recently- techniques based on machine learning , like reconnaissance metadynamics , have been ingeniously formulated and proposed to help alleviate this problem ( see e.g. @xcite and references therein ) . a recent review on dimensional reduction and enhanced sampling in atomistic simulations",
    "can be found in @xcite .",
    "a crucial assumption that underpins many of these methods ( as well as our own work over the years , and what will be implemented here ) is that the dynamics are , effectively , low - dimensional : there exists a `` good set of a few collective variables '' ( also called collective coordinates , or reduction coordinates ) in which one can write an effective langevin ( or effective fokker - planck ) equation ; it is the potential of this effective langevin that we are trying to identify and exploit .",
    "while one generally expects this effective langevin to be a higher order , generalized one , and thus have memory terms @xcite , we will show here how we can , in effect , construct `` short memory '' approximations with the help of collective variables detected and updated `` on the fly '' using manifold learning . if we ( a ) knew the right coarse - grained observables ( the right collective variables ) ; and if importantly , ( b ) we had an `` easy way '' to create molecular conformations consistent with given values of these coordinates ( a procedure that we call here `` lifting '' ) , then creating tabulated ( or interpolated ) effective free energy surfaces with a black box atomistic simulator and umbrella sampling would be `` easy '' . by observing the dynamics of the md in these few collective coordinates",
    ", we can then straightforwardly estimate the local gradient of the effective potential and the local diffusivity in the effective langevin description .",
    "actually , `` easily '' does not do justice to the problem - estimating effective langevin terms locally from simulations is a highly nontrivial estimation problem in the theory of sdes , and many a career in financial mathematics are made from studying it carefully . here",
    ", we will conveniently assume that we have at our disposal `` the current best '' local stochastic estimation techniques available , so that we can go from observations of the unbiased dynamics ( or the umbrella - sampled dynamics ) to local effective sde term coefficients .",
    "given an approximate effective free energy surface ( in its `` few '' collective coordinates ) , we can then go ahead to perform tasks like reaction rate estimation with the explicit surrogate function , or its tabulated form .",
    "mathematical and computational tools for performing such tasks on explicit ( or tabulated ) functions of a few variables exist in the `` standard '' mathematical literature ( e.g. in optimization ) and will also be assumed known and `` off the shelf '' available .",
    "even though finding these invaluable good collective coordinates is difficult , it is at least reassuring to know that `` the useful collective coordinate set '' is not unique , but rather conveniently degenerate : any set of two basis vectors on a plane suffices to span the plane .",
    "if our -say for simplicity- two - dimensional free energy surface is not a flat plane , but a curved manifold , any set of two basis vectors on any plane that is one - to - one with our fes would suffice to parametrize it ( provide a set of coordinates on it , so that we can navigate it ) .",
    "discovering good coordinates for describing a function based on data lies at the crux of modern computer / data science research .",
    "this is precisely our task here , too : find ( explore , reveal ) an effective fes , and parametrize it ( construct a map of it ) in terms of useful collective coordinates .",
    "we first discuss the simple , one - dimensional case .",
    "if a good , physically meaningful reaction coordinate @xmath0 is known _ a priori _ ( see the inset in left panel of figure [ draft01 ] ) then a procedure for extracting a good approximate fes from computational data is obvious : a ( possibly regular ) grid in the one - dimensional phase space is constructed , and umbrella sampling is performed to estimate the potential of mean force . alternatively ,",
    "several parallel , appropriately initialized short runs can be used to estimate the local effective langevin drift and diffusivity .",
    "either way , an approximate fes ( with controlled approximation error ) can be interpolated .",
    "yet good collective coordinates are not globally known in advance , and must be generated as the computation progresses .",
    "consider as an illustration , a one - dimensional manifold ( blue thick line in figure [ draft01 ] ) with the corresponding 1d effective fes ( in yellow ) . say that after some initial simulation time the solution trajectory becomes trapped in one of the energy wells ( bottom left in the figure ) . then data mining can be applied to an ensemble of locally sampled configurations to ( a ) establish that the relevant manifold is one dimensional ; to ( b ) learn its local parametrization ( e.g. in terms of the first meaningful diffusion map coordinate ) ; and thus to ( c ) detect the boundary points of the manifold portion so far explored ( `` fathomed '' ) .",
    "these boundary points can now be smoothly extended outward - not in time , but in the geometry of the manifold , parametrized locally by the first diffusion coordinate @xcite , or , even simpler , by the first local principal component close to each boundary .",
    "this extension takes us beyond the conformation space already explored , and may well be _ against _ the local fes gradient , leading , as we will discuss , to computational savings .",
    "the extension can not but be an approximate one - a `` predictor '' , a taylor series approximation of the manifold locally in the ambient space ( black arrow on the left in the left panel of figure [ draft01 ] ) .",
    "a `` corrector '' step must follow : a short equilibration ( possibly by plumed - assisted umbrella sampling @xcite as schematically illustrated by the red arrow following the black one in the figure ; or possibly by a short unbiased simulation ) gives us new , unexplored conformations on the manifold beyond what we had already fathomed .",
    "new brief simulations are run , new points on the manifold are collected ( second blue point cloud in the figure ) , added to the data base , and then fed to data mining so as to parametrize the augmented fes geometry .",
    "the extension procedure repeats again and again : new unexplored conformations keep being added and the extended geometry of the effective fes is gradually revealed , leading to the discovery of new wells ( like the one on the right in the left panel of figure [ draft01 ] ) .    in higher dimensions , the basic approach remains the same , although its representation becomes more complicated .",
    "consider a two - dimensional `` undulating '' free energy surface embedded in a high dimensional ambient space , as shown in the right panel of figure [ draft01 ] .",
    "the `` color map '' on this carpet denotes the effective fes contours ; if , as we `` walk '' on the carpet we estimate , on the fly , the local color gradient , we can use this information to help us direct our walking pattern , and thus make the extraction of the information we are after ( like a reaction rate , or the discovery of a saddle point ) less time consuming .",
    "in `` indiana jones and the last crusade '' the hero walks on a glass mirror bridge that he can not see - but in the end , he takes some sand , and throws it at his feet , so that the sand reveals the local shape of the bridge .",
    "this is precisely what we do in imapd with our `` free energy carpet '' .",
    "we start with simulations that have locally ( and partially ) sampled some location on the fes : `` sand we have poured around our own feet '' - our first small cloud , `` c1 '' in right panel of figure [ draft01 ] ; but now that a little of the low - dimensional geometry of the carpet is revealed , we can `` walk '' , take a big step ( as big as we trust the smoothness of the carpet ) to a new location , and pour some sand there , namely initialize molecular dynamics conformations consistent with the new location in collective coordinate space , and start one or more unbiased simulations there .",
    "this is `` the new sand '' - our new little cloud , c2 in the right panel of figure [ draft01 ] , to which we have stepped .",
    "one can easily intuit how the geometry is revealed from iterating this process : for a @xmath1-dimensional ( here @xmath2 ) reduced description , the initial `` seed '' simulation will form an effectively @xmath1-dimensional ( here @xmath3-dimensional ) cloud . we need to identify the @xmath4dimensional ( here , @xmath5-dimensional ) boundary of this cloud ( its `` silver lining '' ) .",
    "then , at some point on this lining , -or possibly at an ensemble of points uniformly discretizing this @xmath5-d curve , each of them one by one , or all in parallel computationally- we `` take a step away '' from this cloud , smoothly extrapolating the coordinates `` as far as we trust their smoothness '' .",
    "we could move , for example , along local geodesics -as we have explained in detail in previous work @xcite ; clearly , we can only `` trust '' these geodesics only so far ( since the carpet may `` violently '' curve , and our smooth extrapolation may not locally parametrize it any more ) .    by identifying the boundary , marching `` outward '' from a number @xmath6 of points on it , creating @xmath6 little @xmath1-dimensional clouds from simulations initialized at each extrapolation , and then `` integrating '' the new @xmath6 clouds in an atlas with the initial one , again and again",
    ", we will `` fathom '' the carpet .",
    "so , while the `` local marching '' from every boundary parametrization point may be done in local coordinates ( e.g. local pca ) or in more global coordinates ( e.g. diffusion maps geometric harmonics ) , all new data points at every iteration can be integrated in our global geometry either by reprocessing them all together , or by creating an efficient database structure that allows transitioning from local coordinates of one cloud to local coordinates of the cloud next to it ( one chart in an atlas to the next ) .",
    "this is reminiscent of `` simplicial continuation '' in following the parametric solutions of algebraic equations .",
    "we have a predictor step ( our extrapolation in local reduction coordinates ) and then a corrector step that `` brings us back down '' to the fes - this corrector step might be discarding the fast initial transient of an unbiased simulation , or running umbrella sampling constrained on the extrapolated coarse coordinates .",
    "it is clear that we only need to move `` outward '' if we are to explore new areas - ( that can be ensured through good bookkeeping ) - and while this is a nontrivial process to generalize , bookkeeping is easy in one dimension , easy ( but nontrivial ) in two dimensions , doable in three , difficult in four etc .",
    "- so practically , we expect the process to be easy to program for relatively low - dimensional ( 1,2,3 ... maybe 4 dimensional ) free energy surfaces - and it will require nontrivial computational geometry and programming .",
    "this is precisely the same bookkeeping necessary in multi - parameter simplicial continuation for the tracking of solutions of algebraic equations @xcite ( see also the available software package for continuation and bifurcation problems auto @xcite ) .",
    "we discuss now the implementation of the proposed imapd molecular simulation sampling approach .    conforming to the literature ( but also for the sake of clarity )",
    "our first benchmark illustration is the time - honored alanine dipeptide @xcite , here in implicit solvent with the amber03 force field @xcite .    in our second application",
    ", we apply the imapd algorithm to the transmembrane protein mga2 , which plays a key role in the regulation of lipid saturation levels in the yeast endoplasmic reticulum ( er ) .",
    "recent simulations and experiments identified a unique rotation - based sensing mechanism to probe the membrane characteristics @xcite . in response to changes in lipid saturation , the 30-amino acid transmembrane helices ( tmh ) anchoring mga2 into the er were found to rotate relative to each other in an mga2 dimer , driven in part by packing effects acting on bulky protruding tryptophans .",
    "just probing the rotational dynamics and charting the underlying free energy landscape required millisecond - long md simulations feasible only with a coarse - grained ( cg ) description @xcite .",
    "however , even on this long time scale , only the tmh contact could be sampled , with tmh dissociation expected to occur on time scales orders of magnitude longer .",
    "therefore , even in more than 3-ms simulations of a simplified cg description , the relevant configuration space of the dimer could not be sampled exhaustively .    here",
    "we show that with imapd not only the competing mga2 bound states , but also the unbinding pathways can be discovered , simply by strategic initialization of otherwise fully unbiased md trajectories .",
    "this reduces computational costs at least 1000-fold .",
    "it has been long argued that alanine dipeptide admits a two - dimensional reduced description in terms of two physically meaningful coordinates , namely the dihedral angles @xmath7 and @xmath8 ( see details , e.g. , in @xcite ) .",
    "our approach does not require such _ a priori _ knowledge ( neither of the dimensionality nor of some physical meaning of the collective coordinates ) while exploring the fes .",
    "three successive stages of our exploration protocol are reported in figure [ alamulti ] ; the protocol is initialized from a transient simulation segment ( an ensemble of configurations ) visibly trapped within some initial potential well ; this is what we call the _ initial simulation data_. each stage of imapd is composed of the following sub - steps :    * * data mining*. a manifold learning technique ( here , diffusion maps - dmaps - @xcite ) is used to discover a low - dimensional embedding for the data collected so far .",
    "this discovery includes the selection of the appropriate dimension ( @xmath1 ) of the manifold , and its parametrization , here in terms of @xmath1 leading diffusion map coordinates ( dc1, ...",
    ",dcd ) . * * boundary detection*. using algorithms from the literature ( e.g. here alpha - shapes @xcite , readily implemented in the matlab package , or more generally ,  wrapping \" algorithms @xcite ) we detect the @xmath9 dimensional boundary of the region explored ( `` fathomed '' ) by the available simulation data . * * outward extension*. at each boundary point , we take an outward step ( here , approximately normal to the boundary , in the tangent space of our low - dimensional manifold ) .",
    "the option implemented in this study involves local principal components ( lpc ) in the ambient space .",
    "for each boundary point , ( a ) a fixed number of nearest neighbors is detected in ambient space ; ( b ) local pca is performed on this set of neighbors with the local reduced dimension @xmath10 selected by a threshold for the maximum variance ( details below ) ; ( c ) the center of mass of this local neighborhood is computed in the @xmath10-dimensional pca space ; and then ( d ) `` outward extension '' of the manifold at the original boundary point is performed ( in the pca low - dimensional space ) along the line segment passing through the local neighborhood center of mass and the boundary point itself .",
    "alternative extension techniques ( like geometric harmonics or laplacian pyramids @xcite can also be used for this purpose . * * lifting * is then performed from the extended lpc coordinates to novel , unexplored molecular configurations lying on / close to the extended manifold . going from lpc directly to ambient space",
    "was satisfactory in this simple illustration .",
    "in general , however , equilibrated conformations consistent with ( _ respecting _ ) the extended lpc coordinate values may be needed , and can be obtained , for example , through short , constrained , umbrella - sampling runs @xcite , e.g. through plumed @xcite or colvars @xcite . *",
    "* new sampling / data base updating on the extended manifold*. short simulation bursts are carried out from these new  extended \" initial conditions ( possibly several replicas from each , initialized with different maxwell - boltzmann velocities and/or different thermostat seeds).the new data are appended to the growing fathomed configuration data base .",
    "the procedure then repeats till new metastable configurations are detected .    in figure [ alamulti ] ( left panel ) an initial transient",
    "is visibly trapped in two nearby metastable configuration wells .",
    "data mining ( dmaps ) clearly suggests a two - dimensional fes ; the inset shows this two - dimensional manifold embedded in the the space of the first three dmap coordinates .",
    "the boundary points of the  fathomed \" portion of the manifold are identified ( red circles ) and extended outward ( green stars ) .",
    "lifting via lpc is quite satisfactory here , and new sampling on the extended manifold is performed through simple unbiased short runs initialized at the lifted configurations .",
    "the resulting new configurations are appended to the growing simulation database , and a new round of data mining , boundary detection and outward extension is shown in figure [ alamulti ] ( middle panel ) , both in 2d projection and in 3d embedding .",
    "this is repeated one more time , leading to figure [ alamulti ] ( right panel ) , where two new ( folded ) metastable configurations have been discovered .",
    "what is important is that the manifold parametrization shown in the right panel of figure [ alamulti ] _ was not known _ at the beginning .",
    "only the small portion of the manifold ( marked by the yellow ellipse ) was initially available .",
    "the geometry of the ( growing ) manifold beyond that initial ellipse and its ( adaptively also growing ) parametrization have been gradually revealed as part of our exploration protocol .",
    "for the sake of completeness , the results of the above exploration process are also reported in the popular ramachandran plot in fig .",
    "[ discovery ] in terms of the two physical coarse variables @xmath7 and @xmath8 .",
    "the dipeptide , initially trapped in the basins on the top - left , is gradually forced towards new configurations that would not have naturally been visited in such a short simulation time period .     of the variance",
    "was retained ( see materials and methods below ) . ]    in this relatively simple example , the low - dimensional fes `` slow manifold '' identified on the fly happens to also be the graph of a function above the two ramachandran plot coordinates ( in other words , the determinant of the jacobian of the transformation form the  physical \" coarse coordinates @xmath7-@xmath8 to the diffusion ones dc1-dc2 keeps the same sign , and is neither too big nor too small on the data : it stays bounded away from zero and from infinity , so that the transformation from physically meaningful to data - based collective coordinates is bi - lipschitz @xcite ) .",
    "this means that the effectively 2d fes can be described _ equally well _ in terms of @xmath7-@xmath8 or in terms of our ( evolving ) dc1-dc2 . if , however , this effectively 2d manifold  folded \" over the ramachandran plot variables , our data - mining would still be able to correctly parametrize , and extend , the fes .",
    "before we elaborate on the steps , a few words about efficiency . in this example , the total computational time associated with all performed simulation bursts was estimated at @xmath11 ps .",
    "it is known that for this system @xmath12 ns direct simulation are , on average , needed to observe the transition from the initial , lower free - energy configurations to the discovered , higher free - energy ones ( see @xcite where the same system was simulated ) .",
    "this yields an apparent computational speed - up of three orders of magnitude for this rudimentary ( far from optimal ) implementation , in line with what was observed in @xcite , where the re - initialization did not involve extrapolation , but rather occurred at the `` farthest reached '' point ( in dmap space ) ; since the computation there was one - dimensional , boundary detection was straightforward .",
    "this technique , like reconnaissance metadynamics , also builds the exploration geometry , and actually does it `` seamlessly '' , without having to `` jump and reinitialize '' consistent molecular configurations . yet",
    "it is precisely this `` jumping and reinitializing '' that we feel is the most powerful element of our approach : we do not have to wait to `` fill in the wells '' ( as in metadynamics ) , nor do we need to sample the part of the geometry that we trust is smooth enough .",
    "we can take a step `` as big as we trust '' in the geometry , and then sample there and in this way save a remarkable amount of computational time ( see the appendix ) .",
    "these two steps are determined by the length @xmath13 of the unbiased sampling and the length @xmath14 of the extension . before discussing optimal choices of these two crucial parameters ,",
    "some conceptual geometrical considerations are in order .    for a simple one - dimensional sde in terms of a known variable @xmath15",
    ", reinitializations can be carried out with no effort and the extension parameter @xmath14 chosen as large as one likes ( the support of the effective fes is not a curved one - dimensional manifold in a high dimensional space ) . in complex atomistic simulations , however , challenges to the practical implementation of the above procedure arise because    * the low - dimensional _ support _ ( manifold ) of the effective free - energy surface is typically curved and embedded in a high dimensional phase space ; * coarse grained coordinates parametrizing this manifold are _ a priori _ unknown and need to be systematically discovered and  harmonized \" with their incarnations at the previous step ; * re - initialization of the fine - scale simulator requires a _ lifting _ operator from the low - dimensional space up to ambient physical space ( see also @xcite ) .    those are precisely some of the aspects addressed in this work .",
    "our alanine example only provides a proof - of - concept illustration since the code we set up was far from optimal .",
    "we did not optimize the extension parameter @xmath14 nor the unbiased sampling time @xmath13 , which was instead kept constant ; and in this first attempt , at each step we extended _ all _ detected boundary points .",
    "future optimized implementations will include a smarter parametrization / selection of the boundary points to extend , as well as a smarter selection of the unbiased sampling interval based on local estimates of the free energy gradient ( this selection follows the same principles discussed in detail and demonstrated in @xcite , where , however , the collective coordinates were already known ) .",
    "one might , for example , not extend points at which the effective fes rises steeper ( its local gradient norm is larger ) than a preset threshold .",
    "finally , in estimating computational speedup we should also include the cost of necessary intermediate steps , such as dmaps , local pca and lifting .",
    "having demonstrated the power of imapd in applications to well - characterized model systems , we next use it to chart the configuration space of the biologically relevant mga2 sensor of lipid saturation @xcite .",
    "for this challenging molecular system , even millisecond long atomistic md simulations proved insufficient to observe a dimer dissociation event .",
    "however , they provide us with an excellent reference for the dimeric bound state @xcite . fig .",
    "[ fig : globaldm ] shows the corresponding free energy landscape as a function of the first two global dc of the dimers , with the 4 highly populated clusters corresponding to local minima .",
    "importantly , we do not use this surface to guide imapd in any way , only to give the reader a global view of the progress in the search . as the first step in imapd ,",
    "we run a burst of ten short ( 100-ns ) unbiased simulations initiated from the starting configuration .",
    "the resulting trajectories sample its vicinity , but do not escape the local free energy minimum ( black squares fig.[fig : globaldm ] first panel ) .",
    "we use the structures along these simulations to detect the boundary in the local dc representation , and from there we project outward , building 16 new starting configurations . from each of these",
    "we start another burst of ten 100-ns long unbiased simulations .",
    "although most of these trajectories fall back to the starting cluster , many are able to escape from it , landing into new regions of the landscape , effectively discovering most of the highly populated clusters during the first phase of the expansion ( blue circles fig.[fig : globaldm ] panel a ) . in the spirit of building a growing map of the landscape ,",
    "we combine all configurations sampled so far and repeat the boundary detection and projection in newly calculated local dc to obtain new starting configurations . in a second imapd round starting from them , we already visit all relevant regions of the landscape ( blue circle fig.[fig : globaldm ] panel b ) .    for reference",
    ", we extend the initial unbiased simulations to estimate the time scales necessary to explore the landscape in a purely equilibrium approach . in fig.[fig : globaldm ] panel c , we can see that after running ten simulations for @xmath16 each , only one trajectory is able to leave the starting cluster . in order to discover all the remaining clusters ,",
    "each simulation must be run for @xmath17 .",
    "we now represent the exploration process by using two angles @xmath18 and @xmath19 that describe the relative orientation of the two tmh in a mga2 dimer ( see inset lower panel fig.[fig : globaluv ] ) .",
    "we again took advantage of already available long equilibrium simulations to calculate a reference free energy surface as a function of @xmath18 and @xmath19 . due to the identity of the two tmh ,",
    "the surface , shown in fig.[fig : globaluv ] , is approximately mirror symmetric with respect to the bisector .    in imapd ,",
    "the first short unbiased simulations sample structures where the two reference w10 face each other , and , consistently with what we saw in the global dc representation , are confined to the starting state .",
    "the first expansion leads to the discovery of two new states , which contain configurations where the w10 are far apart , pointing in one case to opposite directions and in the other in the same direction . taking into account the symmetry of the surface , the last relevant state is discovered during the second expansion .",
    "importantly , in a few configurations at this stage , the two tmh are actually separated , which represents a disassociation event of the dimer .",
    "this particular new configuration is then sampled for almost half of the time during a third expansion .",
    "in this work , we described , implemented and tested imapd , a geometry - based , machine - learning inspired approach to accelerating the extraction of information from atomistic and stochastic simulators - in particular , the computation of effective fes .",
    "the algorithm has been tested on cg simulations of mga2 tmh dimers , a system of biological relevance with rich conformational dynamics in the microsecond to millisecond regime and beyond ; the two helices can make use of various contact interfaces , corresponding to the clusters in the free energy surfaces shown in fig.[fig : globaldm ] and [ fig : globaluv ] .",
    "our set - up mimics a situation in which only one structure is known , and md simulations are restricted to short timescales due to the size of the system . on the one hand , the number of computing cores that can be used to parallelize a single simulation might be limited by lack of resources or bounds in the scaling behavior ; on the other hand , the dynamics of complex ( bio)molecular systems are characterized by long correlation times .",
    "it stands to reason that in such situations of practical interest , running many short independent simulations is often more effective than focusing on few long ones .",
    "however , a crucial element of this strategy is to select appropriate initial configurations so not to get trapped in configuration space .",
    "we have shown how by using machine learning algorithms ( dmaps and pca ) to infer new configurations from which to start bursts of short unbiased simulations we were able to efficiently discover new relevant structures of the mga2 tmh dimers .",
    "starting from a single initial structure , the imapd algorithm was able , in only two iterations , to sample structures in the entire relevant configuration space of the dimer .",
    "we want to stress that all simulations that we have used are unbiased : after `` intelligent '' reinitialization no unphysical force was added to steer the dynamics of the system .    in order to monitor the progress of the exploration",
    ", we used low dimensional free energy surfaces calculated as a function both of machine learning coordinates ( dmap ) , and physical variables ( angles @xmath20 ) .",
    "these surfaces are representations of the configuration space of the dimer , i.e. , when both tmh are in close proximity ( @xmath21 nm ) . as we saw in fig.[fig : globaluv ] by monitoring the distance separating the two tmh , during the second and third expansion ( and thus after only a few tens of microseconds of cumulative simulated time ) , the algorithm sampled a dissociation event .    in equilibrium simulations these occur on much longer time scales than the formation of the dimer itself .",
    "during more than 3 ms long equilibrium simulations of the mga2 dimer , we never observed a single dissociation event@xcite !    this problem has been recently addressed in the context of the same cg model by using metadynamics @xcite , where an unphysical history dependent bias must be added on the distance separating the two tmh , considered to be _ a priori _ a slow coordinate of the system .    in our case , instead",
    ", the algorithm `` discovers '' this new extremely slow coordinate after having exhaustively explored the slow coordinates describing the conformational rearrangement in the dimer state shown in fig.[fig : globaldm ] and [ fig : globaluv ] .",
    "one can say that the algorithm gradually and adaptively discovers a hierarchy ( an `` atlas '' ) of slow coordinates .",
    "monitoring the actual dissociation events suggests a new slow variable : the relative tilt of the two helices .",
    "the main attractive feature of the proposed approach is that it can explore low - dimensional effective free energy surfaces in high dimensional configurations spaces without the need of relying on _ a priori _ knowledge of suitable collective coordinates ; our coarse coordinates are progressively and adaptively revealed as computation progresses .",
    "the main assumption upon which our method is based is the same one that underpins most of the model reduction techniques in statistical mechanics : due to time scale separation , the system dynamics is mostly confined on low - dimensional ( smooth ) manifolds in phase - space @xcite .",
    "our approach squarely aims at exploiting smoothness of the low - dimensional manifolds which , for the gradient systems of interest here , act as the support of the free energy surface governing molecular and other atomistic dynamics . writing the expression _ jumping as far as we trust the smoothness _",
    "above is , then , the pivot on which our approach `` lives or dies '' . two important issues , one relatively simple , and one deeper , determine the _ tuning parameters _ of our algorithm .",
    "the first is the easier one : if the effective fes does not have hierarchical roughness , then there already exist two computational enabling technologies that support our algorithm .",
    "the first `` enabler '' has to do with the local scaling of the noise through a _ mahalanobis like _ distance @xcite which , combined with diffusion - map based data - mining conveniently factors out fast local oscillations ( _ curved _ fast local invariant measures , `` half - moons '' as we call them in the discussion of @xcite .",
    "the second `` enabler '' is straightforward : after factoring out these fast oscillations we have a smooth surface , and now we are faced with a numerical error control problem : the need for systematic adaptive step - size selection .",
    "we will not address this technical issue here ; we simply note that the same computational machinery that , in traditional initial value problem solvers , allows one to make local error estimates can also be in principle used for our purposes . performing the computation with one step , and then performing it twice with half the step , allows one to make a local `` on line '' error estimate and keep the computation below prescribed error bounds .",
    "the second issue is deeper , and we will only pay lip service to resolving it , even though we believe that what we suggest is `` the right way '' to go about it .",
    "this is the critical ( not for our relatively simple examples ! ) issue of hierarchical roughness .",
    "this implies ( in sde language ) that our potentials are multi - scale potentials ; and , possibly , that our noises may not be just additive . here",
    ", we revert to the discussion above about `` what the best off - the - shelf estimation techniques '' for multiscale diffusions , and maybe not only diffusions , but , say , levy flight processes may be . in all our discussion",
    ", we assumed that the effective equation is a langevin ( or the associated fokker - planck ) .",
    "for simple `` egg - carton '' like potentials , as in the seminal work of pavliotis and stuart , it is possible through ingenious but relatively straightforward tools , like subsampling , to `` go around '' the roughness , and estimate a smooth _ effective _ sde @xcite .",
    "what is , however , more systematically missing ( and missing , to significant extent , in the sde estimation literature ) is a round of data processing ( and if necessary ) additional data collection for _ hypothesis testing_. in 2007 , and in a more general context , we discussed this issue of `` deciding the nature of the coarse equation through microscopic simulations ... '' @xcite .",
    "as the abstract of that papers states , `` _ ...",
    "the effective coupling of microscopic simulators with macroscopic behavior requires certain decisions about the nature of the unavailable coarse equation . ... in the absence of an explicit formula ... , we propose , implement , and validate a simple scheme for deciding these and other similar questions about the coarse equation using only the microscopic simulator .",
    "this excerpt was chosen to suggest we have done a lot ( and we believe there are contributions there for several types of problems ) ; yet we believe that the collection of data for hypothesis testing about the nature of unavailable effective sdes is a nascent field , and we are cognizant of relatively few efforts in this direction .",
    "yet given the microscopic simulators , one can collect the data necessary for such algorithms , and we believe that , even though there will be technical difficulties , and good mathematics in the process , this is an area that will advance significantly in the near future , and our approach will benefit from these advances . while discussing estimation , there is another significant ( and , fortunately , less difficult ) item to consider : the exploitation of the estimated local potential gradient -the heat map , or `` color map '' , on our carpet- in _ informing _ our geometric exploration of the carpet .",
    "this has been , to a large extent , discussed in @xcite when the collective coordinates were known - and the issues remain the same , because they are , more or less , common - sense issues : when at the bottom of a well , we probably want to move upwards ; we may want our steps to be along local geodesics ; we may want our steps ( the location of our `` fresh clouds '' ) to maybe try to conform to level sets of the effective free energy ; if we find a saddle , we may `` just '' kick a little `` on the other side '' , and let the simulation find the new well bottom by itself ; if there are surfaces that look like the grand canyon ( huge gradients in some directions ) maybe we do not want to go above some level set because the simulation ( and the molecule itself ) would never get there in a person s lifetime .",
    "we appreciate that these and several other _ common sense _ decisions have to be implemented in an automated fashion in the code , if the code is to be useful ; that is a matter of effort and resources .",
    "plumed @xcite ( or colvars @xcite ) goes quite a long way towards being a platform in which to incorporate what is done here , and what we envision being done in an automated fashion .",
    "it is also important to recognize that one may have `` exotic '' carpets that change dimensionality as the exploration proceeds ( @xmath3-dimensions narrowing to @xmath5-dimension and then maybe `` opening back out '' like a river delta , to @xmath3-dimensions - just like the shapes of some children s kites as shown in @xcite- , or , say @xmath22-dimensions narrowing to @xmath5-dimension and then back again , like bar bells ) .",
    "we can in principle deal with that geometrically , but we will not discuss this further in this paper beyond referring to the work of belkin et al . and others @xcite , @xcite .",
    "the important issue of adaptively determining the dimensionality of low - dimensional surfaces in data mining has been discussed in @xcite .",
    "it is fitting to close the discussion by a quotation from the 2016 b. peters review article @xcite : `` _ however , the methods in this review share one overarching disadvantage . human intuition remains the best source of trial coordinates and mechanistic hypotheses , and",
    "there is no procedure for having an epiphany .",
    "all current algorithms for optimizing reaction coordinates work within the space of chosen trial coordinates . _ '' our work here attempts such a `` computer assisted epiphany '' : by adaptively revealing the exploration geometry , and by exploiting its smoothness to guide further exploration ; it makes a step towards circumventing human intuition in the discovery phase .",
    "yet the rationalization of what has been discovered in terms of physically interpretable candidate coordinates is an important post - processing step and significantly augments the overall value of the process ( e.g. confirming that , in the last stages , the relative tilt between the two helices is `` one - to - one '' with the machine - discovered coordinates )",
    ". a useful discussion of the `` man - versus - machine '' detected variables can be found in @xcite .",
    "the data mining step of our procedure has been performed by the diffusion map ( dmap ) method .",
    "compared to the popular principal component analysis ( pca ) @xcite , dmap enables us to extract a nonlinear embedding thus minimizing the dimension of the low - dimensional description .",
    "full details on dmaps can be found in @xcite .",
    "let @xmath23 be a set of @xmath24 points in a @xmath25-dimensional ( ambient ) space . to fix ideas , let @xmath26 be an array collecting the @xmath27 cartesian coordinates of all atoms ( or beads in coarse - grained calculations ) forming the @xmath28 configuration extracted from md simulators .",
    "let a _ dissimilarity function _",
    "@xmath29 be defined between any pair of points @xmath26 and @xmath30 , such that @xmath31 only when points coincides , while the more dissimilar the point the larger @xmath32 .",
    "an obvious choice ( although not the only one ) for @xmath33 is the euclidean distance .",
    "when dealing with molecular configurations , distances are to be evaluated upon removal of rigid translation , rotation and all other possible symmetries . based on @xmath32 , a pair - wise affinity function",
    "can be constructed , @xmath34 , where @xmath35 is monotonically decreasing and non - negative with @xmath36 , while @xmath37 . as usual in the dmap literature , we utilized the heat kernel , @xmath38 $ ] , where the model parameter @xmath39 is introduced in order to discriminate between points that are effectively linked from points that are not ( i.e. those that are separated by a distance larger than @xmath39 ) .",
    "moreover , we made use of the density invariant normalization of the matrix @xmath40 .",
    "more details on the choice of the eigenvectors can be also found in @xcite .",
    "let @xmath41 be an arbitrary boundary point in the @xmath25-dimensional ambient space , which we want to extend outwardly with respect to the previously simulated ( available ) point cloud .",
    "let us identify the @xmath42 nearest neighbors of @xmath41 in the ambient space .",
    "let @xmath43 be the @xmath44 data matrix collecting the cartesian coordinates of @xmath45 points , namely the ones within the chosen neighborhood of @xmath41 , including @xmath41 itself .",
    "let us now perform principal component analysis - pca - of the matrix @xmath43 .",
    "this yields :    * the @xmath46 matrix of loading : @xmath47 ; * the @xmath44 matrix of principal component scores : @xmath48 ; * a vector @xmath49 with the @xmath25 eigenvalues of the covariance matrix @xmath43 .",
    "an estimate of the local dimension - @xmath10- of data ( i.e. in the chosen neighborhood of @xmath50 ) can be readily obtained by setting a threshold for the maximum variance to keep as follows : @xmath51 with @xmath52 .",
    "alternatively , the dimension of the reduced space ( @xmath10 ) can be also fixed _ a priori _ once and forever at any boundary point .",
    "regardless of the method we decide to use , let us assume that the above dimension @xmath10 is known .",
    "let us consider the @xmath53 matrix @xmath54 collecting the reduced pca coordinates of the @xmath45 points of interest .",
    "in other words , @xmath54 is provided by the first @xmath10 columns of the above matrix @xmath48 .",
    "let @xmath55 and @xmath56 be the pca reduced coordinates of the above boundary point @xmath41 and of the center of mass of the considered neighborhood , respectively .",
    "we compute the following ( row ) unit vector @xmath19 in pca reduced space along which we intend to project outward the boundary point @xmath41 .",
    "@xmath57 a new point in reduced pca space can be identified as @xmath58 , where @xmath14 is a non - negative scalar quantity stipulating how far we intend to extend the point @xmath41 from the current location .",
    "lifting of the new point @xmath59 into ambient space can be readily accomplished by a linear mapping , @xmath60 where the @xmath61 matrix @xmath62 is given by the ( transposed ) first @xmath10 columns of the above matrix @xmath47 ( i.e. the matrix of loadings ) , while @xmath43 is the mean row vector , where each of the @xmath25 ( ambient space ) coordinate is averaged over the @xmath45 points in the chosen neighborhood .",
    "the ala dipeptide is simulated with gromacs 4.5.5 @xcite in a periodically replicated box with dimensions of @xmath63 @xmath64 .",
    "solvent is treated implicitly , using the still generalized born formalism with a cut - off of 0.8 nm .",
    "the temperature is maintained constant at @xmath65 by means of velocity rescaling thermostat @xcite .",
    "when searching for dmap low - dimensional embeddings , all configurations are first aligned to a reference configuration using the kabsch algorithm @xcite , and afterward the standard euclidean distance is used as pair - wise dissimilarity function .",
    "the dmap model parameter was set at @xmath66 nm . when performing local pca , at each boundary point @xmath67 nearest neighbors are considered , whereas the local dimension @xmath10 is automatically estimated by setting a threshold for maximum variance of @xmath68 .",
    "the non - negative scalar quantity @xmath14 for local extension is chosen in the range : @xmath69 .",
    "starting from each new extended configuration , 2 short bursts are performed by each time randomly re - assigning maxwell - boltzmann velocities to atoms .",
    "simulation bursts consist of 15000 simulation steps with a time step of @xmath70 fs .",
    "the latter unusually small time step is not essential for computations : it was chosen for convenience as it ensured a sufficiently large number of samples along the burst trajectories .",
    "the 30 amino - acids long transmembrane domain of mga2 ( sequence in single letter code : rndkmliffwipltlllltwfimykfgnqd ) was modeled as an alpha helix in the martini v2.2 force field @xcite .",
    "we used the insane tool @xcite to assemble for each simulation a 10x10x10 nm box containing two mga2 monomers , about 300 popc lipids , water and ion beads corresponding to a 0.15 m nacl concentration , for a total amount of about 10,000 beads .",
    "each initial configuration was relaxed by using 15000 steps of steepest descent , and then equilibrated for 2 ns at a temperature of 303 k and pressure of 1 atm , restraining the positions of the protein beads rescaled compatibly with the pressure coupling .",
    "temperature was kept constant with the velocity rescaling thermostat @xcite and pressure with the semiisotropic berendsen barostat @xcite during equilibration , and the semiisotropic parrinello - rahman barostat @xcite during the production runs .",
    "all simulations were performed in gromacs 4.6.7 @xcite , using a time step of 20 fs .",
    "we initially ran 10 independent simulations starting from the same structure , each 100 ns long .",
    "we saved configurations containing only the protein degrees of freedom every 2 ns , and aligned them in a self - consistent way to the average sampled configuration , removing translations and rotations with the kabsch algorithm @xcite .",
    "in particular , we first aligned the trajectory to an arbitrary configuration , calculated the average configuration and used it to align the trajectory again , repeating the procedure until the rmsd between two consecutive average configurations was smaller than 0.01 nm .",
    "the alignment was done on the backbone beads of residues 3 - 28 of each monomer .",
    "furthermore , we took into account the identity of the two monomers , which introduces an exchange - symmetry in the system .",
    "we thus considered for every frame the structure with the smallest rmsd to the reference upon swapping of the two monomers .",
    "we calculated the first two dc in the cartesian space of the aligned configurations , using the euclidean metric and @xmath71 nm , and approximated the boundary of the obtained points with a convex hull .",
    "we projected each point on the boundary outwards at a distance of @xmath72 nm along the local pca , which were calculated on its 100 nearest neighbors , with @xmath10 chosen to keep @xmath73 of the original variance .",
    "we added lipids around the projected dimer and solvated the resulting bilayer , then shortly equilibrated the system , obtaining 16 new configurations ( table [ tab : table ] ) .",
    "we then ran 10 independent 100 ns long unbiased simulations for each new configuration by randomly initializing the initial velocities , and merged the new trajectories to the initial ones .",
    "after this first expansion , we repeated the entire procedure for a second and a third time ( expansions 2 and 3 ) obtaining , respectively , 16 and 12 new configurations ( table [ tab : table ] ) .",
    "newly discovered configurations where the two monomers are separated were excluded from the procedure , since they would dominate the representation in dc .",
    "the free energy surface as a function of the first two global diffusion coordinates shown in fig.[fig : globaldm ] was calculated using 24,815 configurations of the dimer sampled at equal times from a previously reported 2.52 ms long equilibrium trajectory @xcite that was self - consistently aligned to the average configuration as already explained .    to represent newly sampled configurations on the global dm landscape , we aligned them on the same average configuration described above and combined them to the configurations sampled from the long equilibrium trajectory , hence evaluating the dm on the combined set for each new trajectory .",
    "all dm were calculated using the euclidean metric and @xmath71 nm .",
    "the two angles @xmath18 and @xmath19 used in fig.[fig : globaluv ] define the relative rotation of the two alpha helices forming a mga2 dimer .",
    "@xmath18 is the angle defined counter - clockwise between the orthogonal line to the direction connecting the centers of mass of the two helices and the vector pointing to residue w10 of the first monomer ; @xmath19 is the angle defined counter - clockwise between the orthogonal line to the direction connecting the centers of mass and the vector pointing to residue w10 of the second monomer ( see inset in fig.[fig : globaluv ] ) .",
    "both angles have periodicity @xmath74 . for chemically and structurally identical monomers",
    ", we would have mirror symmetry with respect to the line @xmath75 .",
    "the reference free energy landscape of fig.[fig : globaluv ] was calculated by using 248,144 frames sampled at equal times from a 2.52 ms long equilibrium trajectory @xcite .",
    "we calculated @xmath18 and @xmath19 both in the reference of the first monomer , and in the reference of the second monomer , in this way effectively enforcing the monomer - exchange symmetry of the system .",
    "any residual deviation from the mirror symmetry in the surface is due to some flexibility of the helices , which can be only approximately considered as rigid bodies .",
    "analysis and visualization of the data were performed with numpy @xcite , scipy @xcite , ipython @xcite , matplotlib @xcite and mdanalysis @xcite .",
    "molecular representations were made with vmd @xcite .",
    "lccccc &    [ cols=\"^ \" , ]      + 1 . initial unbiased & 1 & 10 & 1 & 1/4 & 0 + 2 .",
    "expansion 1 & 16 & 160 & 16 & 3/4 & 0 + 3 .",
    "expansion 2 & 16 & 150 & 15 & 4/4 & 1 + 4 .",
    "expansion 3 & 12 & 100 & 12 & 4/4 & 1 + 5 .",
    "reference unbiased & 1 & 10 & 40 & 4/4 & 0 + 6 .",
    "equilibrium free energy & 10 & 10 & 2,520 & 4/4 & 0 +    [ tab : table ]    : after a simulation time @xmath76 the explored region has the ( expected ) maximum height in energy @xmath77 shown .",
    "the figure compares results of unbiased simulations with those biased by ( a ) simple reinitialization at the edges and ( b ) geometrically biased reinitializations , through the outward extensions advocated here .",
    "the unbiased sde [ sdeeq ] has been solved using a euler - maruyama scheme with @xmath78 .",
    "we caution the reader that this is just an illustrative caricature . ]",
    "let us consider the stochastic dynamics described by @xmath79[sdeeq ] with harmonic potential @xmath80 . for @xmath81 , @xmath82 and @xmath83 . for unbiased simulations initialized around the bottom of the energy well , the expected time to visit a given region at least once grows exponentially with the spanned energy difference , as shown by open circles in the inset of figure [ sdecomp ] ) . for computations biased by re - initializing at the edges , @xmath84 and @xmath85 , of the interval fathomed after a simulation time @xmath86 , in the spirit of the approach in @xcite a significant advantage",
    "can be already noticed as shown in figure [ sdecomp ] by the open squares . however",
    ", remarkable additional computational speedup ( i.e. several orders of magnitude ) can be achieved if the solver of [ sdeeq ] can be reinitialized each time _ extending beyond _ the already explored domain . for an extension step of only @xmath87 ( re - initializing each time at @xmath88 and then running unbiased for @xmath89 at each end ,",
    "the improvement is clearly visible in the open diamonds in the figure .",
    "ec and igk initially planned the work .",
    "asg , cwg and rrc contributed to the data mining aspects of the problem .",
    "ec ( benchmark 1 ) and rc with gh ( benchmark 2 ) performed the computations shown .",
    "ec and igk with assistance from all authors wrote the paper .",
    "this work was partially supported by the us national science foundation , the us afosr ( dr . darema ) and darpa ( igk ) .",
    "e.c . acknowledges partial support of italian ministry of education through the nano - bridge project ( prin 2012 , grant number 2012lhpsjc ) .",
    "r.c . and g.h .",
    "were supported by the max planck society . e.c .",
    ", r.c . and i.g.k .",
    "also wish to acknowledge the hospitality and support of ias - tum in garching .",
    "60ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.3390/e16010163 [ * * ,   ( ) ] ,   link:\\doibase 10.1016/j.biotechadv.2014.11.011 [ * * , ( ) ] link:\\doibase 10.1146/annurev.physchem.040808.090412 [ * * ,   ( ) ] in  link:\\doibase 10.1007/12_2008_3 [ _ _ ] ,  ( )  pp .",
    ",   link:\\doibase 10.1021/ct100114j [ * * ,   ( ) ] ,  ,   link:\\doibase 10.1146/annurev - physchem-040412 - 110006 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) link:\\doibase 10.1016/j.molcel.2016.05.015 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) `` , ''  in  link:\\doibase    10.1007/978 - 3 - 642 - 55566 - 4_17 [ _ _ ] ,  ( ,  , )  pp .   _",
    "_ ,  @noop ph.d .",
    "thesis ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1080/00268976.2013.813594 [ * * ,   ( ) ] ,   @noop * * ,   ( ) link:\\doibase 10.1021/jacs.6b05602 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * , ( ) @noop * * , ( ) @noop * * ,   ( ) link:\\doibase 10.1137/050643647 [ * * ,   ( ) ] @noop * * ,   ( ) https://arxiv.org/abs/1211.6727 [ ( ) ] link:\\doibase 10.1007/s10851 - 016 - 0684 - 2 [ ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) `` , ''  in  link:\\doibase    10.1007/978 - 3 - 642 - 14941 - 2_16 [ _ _ ] ,  ( ,  ,  )  pp .",
    "link:\\doibase 10.1103/physreve.80.031102 [ * * ,   ( ) ] @noop _ _",
    "( , ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop ( ) @noop * * , ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1.1.49.7193 [ ( ) ]"
  ],
  "abstract_text": [
    "<S> we describe and implement imapd , a computer - assisted approach for accelerating the exploration of uncharted effective free energy surfaces ( fes ) , and more generally for the extraction of coarse - grained , macroscopic information from atomistic or stochastic ( here molecular dynamics , md ) simulations . </S>",
    "<S> the approach functionally links the md simulator with nonlinear manifold learning techniques . </S>",
    "<S> the added value comes from biasing the simulator towards new , unexplored phase space regions _ by exploiting the smoothness _ of the ( gradually , as the exploration progresses ) revealed intrinsic low - dimensional geometry of the fes . </S>"
  ]
}