{
  "article_text": [
    "we discuss a selection of topics in algebraic statistics , mainly about ising models and markov models .",
    "our presentation of the basics is slightly different from other excellent presentations of the topic and it is based on work in progress and on previous conference presentations , in particular our presentations at the second crest - sbm international conference _",
    "harmony of grbner bases and the modern industrial society _ , june 28 - july 2 , 2010 , osaka , japan . due to the review character of this paper",
    ", we do not have in - line references , but we give commented references in bibliographical notes at the end of each section .",
    "our introductory example is the _ ising model _ from statistical physic . given an undirected graph without loops @xmath0 we consider a collection @xmath1 of @xmath2-valued random variables on the finite sample space @xmath3 .",
    "for each edge @xmath4 , the @xmath2-valued random variable @xmath5 is called an _",
    "interaction_. the exponential family of densities @xmath6 is the _ ising model_. the densities",
    "are taken with respect to the reference measure @xmath7 , hence @xmath8 it is possible to describe the ising model in a differentiable manifold , that is without reference to any specific chart , by saying that is a special parameterization of the set of all strictly positive probability densities @xmath9 such that @xmath10    however , the ising model has an extra special feature , namely the so - called _ canonical statistics _ ,",
    "i.e. the linear basis of @xmath11 which is used to obtain the parameterization in , are _ integer valued _ random variables .",
    "we call a model of this type a _ lattice exponential family _ lef .",
    "it is always possible to parameterize a lef with nonnegative and non strictly positive canonical statistics .",
    "for example , in the ising model we can use the binary variables @xmath12 , @xmath13 , and @xmath14 , @xmath15 , to get the same model in a different parameterization : @xmath16 with the obvious change of parameters @xmath17 , @xmath18 .",
    "it should be noted that @xmath19 and @xmath20 .",
    "in fact , the re - coding is actually the character group @xmath21 .    in statistical physics , a model as in",
    "is called gibbs ( or boltzmann - gibbs ) model .",
    "the interest of nonnegative but nonpositive canonical statistics appears in the discussion of the limit case where some of the @xmath22 s tend to @xmath23 . in such a case a limit distribution with smaller support",
    "is obtained .",
    "another parameterization of interest is obtained , by taking in the nonlinear transformation @xmath24 , @xmath13 , @xmath25 , @xmath26 , to get the _ monomial form _",
    "@xmath27    let us make a second remark .",
    "the random variable @xmath28 belongs to the vector space @xmath11 generated by the constants and the canonical statistics if , and only if , it is orthogonal in @xmath29 to each random variable @xmath30 in the orthogonal space @xmath31 . in other words , a density @xmath9 belongs to the model of for some @xmath22 , or to the model in for some @xmath32 , if , and only if , the equation @xmath33 holds for all @xmath30 such that @xmath34    by considering the positive and negative part , @xmath35 , can be written as @xmath36 this argument is true for all exponential families . in particular , in the lattice case , it is possible to find a vector basis of the orthogonal space whose elements @xmath30 are all integer valued . as a consequence , and are both polynomials with indeterminates @xmath37 , @xmath38 , @xmath39 , @xmath13 , and @xmath40 , @xmath41 .",
    "the binomials in are the _ polynomial invariants _ of the lef model .    in the ising model",
    "it is easy to find a linear basis of the orthogonal space , namely the set @xmath42 of all interactions @xmath43 , @xmath44 , which are _ not _ included in the model itself .",
    "we turn now to the study of statistical models of the special monomial type of .",
    "many cases could support this approach , but in our view the basic one is the following : in the probability @xmath9 is assumed to be strictly positive , while both and make sense when @xmath45 at some @xmath46 .",
    "the ising model is named after the physicist ernst ising ( 1900 - 1998 ) and is the basic mathematical model for ferromagnetism .",
    "we do not discuss at all its applications to statistical physics , where in fact special cases are considered , see e.g. @xcite .",
    "the unifying concept of exponential family was fully developed in the classical monograph by barndorff - nielsen@xcite ; a recent exposition of its multiple applications is the review by wainwright and jordan .",
    "the importance of a parameter free and geometrical approach was discovered by cenov@xcite and evolved into what is now called nonparametric information geometry , see the seminal papers by phil dawid@xcite and the functional version by pistone and sempi .",
    "the algebraic approach emerged in the 90 s .",
    "it was first outlined in a monograph by pistone , riccomagno and wynn and fully developed in a paper by geiger , meek and sturmfels .",
    "currently there is an extensive literature  tagged algebraic statistics",
    " we will refer to in the following sections .",
    "we work on a finite sample space @xmath48 with reference measure @xmath7 .",
    "we consider an nonnegative integer _ model matrix _",
    "@xmath49 representing @xmath50 random variables @xmath51 , @xmath52 . the elements of the matrix @xmath47 are denoted by @xmath53 , @xmath54 .",
    "we assume the row @xmath55 to be the constant 1 .",
    "the @xmath56-column of @xmath47 , say @xmath57 , is a multi - exponent of the _ monomial term _ @xmath58    the monomial model of the model matrix @xmath47 ( briefly , the _ @xmath47-model _ ) is defined as follows .    1 .   the _ unnormalized probability densities _ of the @xmath47-model are of the form @xmath59 for all @xmath60",
    "_ such that @xmath61 is not identically zero_. 2 .",
    "the probability densities with respect to @xmath7 in the @xmath47-model are @xmath62 3 .   if @xmath63 , @xmath64 and @xmath65 , i.e. the _ interior _ of the @xmath47-model is a lef in the parameters @xmath22 .",
    "the probability density does not depend on @xmath66 , so that we usually drop the @xmath66 parameter : @xmath67 however , it is useful to keep it in the notation of the unnormalized density which is a _ projective _ object .",
    "the product @xmath68 is strictly positive for @xmath69 , @xmath70 , and it is identically zero for @xmath71 if @xmath72 for all @xmath38 . if a row @xmath51 is not strictly positive , then the unnormalized density is defined for all @xmath32 in the face @xmath73 of the positive quadrant @xmath74 .",
    "this face parameterizes an @xmath75-model with all parameters but @xmath76 and sample space @xmath77 , @xmath75 being the submatrix of @xmath47 obtained deleting the @xmath78-th row and all the columns @xmath56 such that @xmath72 .",
    "a similar argument applies to the case where @xmath79 for at least one @xmath38 .",
    "let us discuss the identifiability of the interior of an @xmath47-model by deriving a _ confounding equation_.    two parameter s values @xmath80 are such that @xmath81 if , and only if , @xmath82    denote by @xmath83 the normalizing constant .",
    "then @xmath84 if , and only if , @xmath85 hence @xmath86 if we define @xmath87 , then @xmath88 .",
    "as the first column of @xmath47 is 1 , the first vector of the canonical basis satisfies @xmath89 , so that the confounding equation is .",
    "let be given two matrices @xmath49 and @xmath90 .",
    "when the interior of the @xmath47-model does represent the same statistical model as the interior on the @xmath91-model ?",
    "the interiors of the @xmath47-model and the @xmath91-model coincide if , and only if , @xmath92 .",
    "assume that for @xmath63 and @xmath93 there is a positive constant @xmath94 such that @xmath95 it follows that @xmath96 .",
    "it is relevant to note that the equivalence of the interiors does not imply the equivalence of the borders , as the following example shows .",
    "this topic is discussed in the next section .",
    "the simplest example of @xmath47-model is the binomial@xmath97 with state space @xmath98 , measure @xmath99 , model matrix @xmath100 } ] {          & 0 & 1 & 2 & 3 & \\cdots & n \\cr         0 & 1 & 1 & 1 & 1 & \\cdots & 1 \\cr          1 & 0 & 1 & 2 & 3 & \\cdots & n } \\ , \\ ] ] unnormalized density @xmath101 , and density @xmath102 , @xmath103 and @xmath104 .",
    "a second monomial model with the same interior has model matrix @xmath105 } ] {          & 0 & 1 & 2 & \\cdots & n-1 & n \\cr         0 & 1 & 1 & 1 & \\cdots & 1 & 1 \\cr          1 & 0 & 1 & 2 & \\cdots & n-1 & n \\cr         2 & n & n-1 & n-2 & \\cdots & 1 & 0 } \\ , \\ ] ] unnormalized density @xmath106 , and density @xmath107 , @xmath108 .",
    "the gibbs model in with state space @xmath109 has a model matrix whose rows are indexed by @xmath110 and entries @xmath111 , @xmath112 , @xmath113 .    in some applications",
    "the statistical model is further _",
    "constrained_. we consider here two types of contrains : linear constrains on the probability densities and linear contrains on the parameters of the monomial model .",
    "in the first case a matrix @xmath114 is given and the statistical model is @xmath115 , restricted to all @xmath32 s such that @xmath116 , @xmath117 . in the second case",
    "the parameters @xmath32 are constrained by a linear variety . in general , the constrained statistical model is not anymore an @xmath47-model . instead , it is an instance of a _ curved exponential family_.      the term @xmath47-model was first used in the seminal paper by geiger , meek and sturmfels .",
    "it is currently of general use , but unfortunately the definition has been adapted by various authors to their special needs .",
    "for example , the original paper assumes the column sums to be constant , which we do not .",
    "a further ( small ) issue comes from the presentation of the matrix @xmath47 : in the statistical literature the model matrix has sample points as _ rows _ , while the algebraic literature takes sample points as _",
    "columns_. the geometry of curved exponential families was first discussed by efron@xcite .",
    "the kernel of the ring homomorphism from @xmath118 $ ] to @xmath119 $ ] defined by @xmath120 , @xmath121 , is the _ toric ideal _ of a , i@xmath122 .",
    "it is a prime ideal generated by binomials @xmath123 with @xmath124 , hence there exists a finite generating set of binomials .",
    "the polynomials in are the _ polynomial invariants _ of the @xmath47-model and all its unnormalized densities belong to the intersection of the variety of the toric ideal with @xmath125 . because of the assumption @xmath126 , we have @xmath127 , so that the binomials in are homogeneous polynomials .",
    "hence all densities @xmath128 in the @xmath47-model belong to the ideal generated by the same binomial equations .",
    "in fact , more is true .",
    "[ th : closure ] the intersection of the @xmath47-variety with the probability simplex is the closure of the @xmath47-model .    we discuss below a slightly different version of this basic result .",
    "let @xmath91 be a model matrix such that the @xmath47-model and the @xmath91-model are equal in the interior of the parameter space .",
    "each row of @xmath91 belongs to the set @xmath129 .",
    "this set is closed under vector sum and has a unique minimal generating set , which is called hilbert basis .",
    "each vector in the hilbert basis is nonnegative and , because of the minimality , has at least one zero . let @xmath130 be a matrix with margins @xmath131 , whose rows are the vectors of the hilbert basis .    1 .   the @xmath130-model is the closure of the @xmath47-model , i.e. each density in the @xmath130-model is a limit of a sequence in the @xmath47-model .",
    "2 .   setting @xmath132 in the @xmath130-model , we obtain a limit @xmath133-model whose support is @xmath134 .",
    "the @xmath133-model on @xmath135 is the @xmath130-model conditioned to @xmath135 .",
    "it should be noted that the @xmath130-model in the previous proposition is possibly non minimal among models with the closure property in item ( 1 ) .",
    "a basis producing a minimal representation of all limits is called a _",
    "circuit basis_. if the hilbert basis is boolean , then it is also a minimal description of the border .",
    "when the model is constrained , the admissible limits are obtained by intersecting the constrains with the faces of the nonnegative quadrant .",
    "this is discussed in the following examples .",
    "the integer kernel of @xmath136 is @xmath137-generated by the rows of @xmath138 and the corresponding binomials are @xmath139 the hilbert basis of @xmath140 is @xmath141 and hence @xmath142 .",
    "the admissible defective supports for limits are @xmath143 and @xmath144 .",
    "assume we add the constrain @xmath145 , i.e. the constrain matrix @xmath146 . in monomial form the constrain is @xmath147 , i.e. @xmath148 .",
    "this constrain happens to be a binomial , and the constrained model reduces to a single distribution , namely the uniform distribution .",
    "consider the sample space @xmath149 and model matrix @xmath150 } ] {     & \\scriptstyle + + + & \\scriptstyle -++ & \\scriptstyle + -+ & \\scriptstyle --+ & \\scriptstyle + + - & \\scriptstyle -+- & \\scriptstyle + -- & \\scriptstyle --- \\cr   0   & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\cr   1   & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 \\cr   2   & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 1 \\cr   3   & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 \\cr   12 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 \\cr   13 & 0 & 1 & 0 & 1 & 1 & 0 & 1 & 0 \\cr   23 & 0 & 0 & 1 & 1 & 1 & 1 & 0 & 0 } \\ .\\ ] ] it is a special ising model on a complete graph on 3 vertices .",
    "the orthogonal space is generated by the vector of the 3-way interaction @xmath151 } ] {     & \\scriptstyle + + + & \\scriptstyle -++ & \\scriptstyle + -+ & \\scriptstyle --+ & \\scriptstyle + + - & \\scriptstyle -+- & \\scriptstyle + -- & \\scriptstyle --- \\cr    & 1 & -1 & -1 & 1 & -1 & 1 & 1 & -1 }   \\ .\\ ] ]    the hilbert basis is given by the rows of the matrix @xmath152 } ] {     & \\scriptstyle + + + & \\scriptstyle -++ & \\scriptstyle + -+ & \\scriptstyle --+ & \\scriptstyle + + - & \\scriptstyle -+- & \\scriptstyle + -- & \\scriptstyle --- \\cr    1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 1 \\cr    2 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 \\cr    3 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 \\cr    4 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 \\cr    5 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 0 \\cr    6 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 \\cr    7 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 \\cr    8 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\cr    9 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\cr    10 & 1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\cr    11 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 \\cr    12 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 \\cr    13 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 \\cr    14 & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 0 \\cr    15 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 \\cr    16 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 } \\ .\\ ] ]    the previous matrix was computed with a symbolic software",
    ". however , we note that each row is obtained by taking a single 1 in the subset where the value of the 3-way interaction equals 1 and another one in the complementary subset , for a total of @xmath153 rows . a proof of the hilbert basis property could be based on the minimality of the support of such vectors .",
    "we denote by @xmath154 the parameters of the @xmath130-model .",
    "the possible reduced supports of limit distributions of the @xmath47-model are the intersections of the subsets of 6 zeros in each of 16 rows of @xmath130 .",
    "for example , if we set @xmath155 in the @xmath130-model , then the set @xmath156 has zero probability and the limit model matrix is obtained by conditioning the @xmath47-model to the remaining support set @xmath157 , @xmath158 } ] {     & \\scriptstyle -++ & \\scriptstyle + -+ & \\scriptstyle --+ & \\scriptstyle + + - & \\scriptstyle -+- & \\scriptstyle + -- \\cr   0   & 1 & 1 & 1 & 1 & 1 & 1 \\cr   1   & 1 & 0 & 1 & 0 & 1 & 0 \\cr   2   & 0 & 1 & 1 & 0 & 0 & 1 \\cr   3   & 0 & 0 & 0 & 1 & 1 & 1 \\cr   12 & 1 & 1 & 0 & 0 & 1 & 1 \\cr   13 & 1 & 0 & 1 & 1 & 0 & 1 \\cr   23 & 0 & 1 & 1 & 1 & 1 & 0 } \\ .\\ ] ] on the subset @xmath157 the aliasing relation is @xmath159 , therefore one of the interactions depends on the other two interactions .",
    "the submatrix with one interaction s row deleted is non - singular . in conclusion ,",
    "the limit model is the saturated model , i.e. the full simplex of probabilities on @xmath157 .",
    "we pass now to the discussion of the constrained model .",
    "the equality of the marginal distributions reduces to the constrain matrix @xmath160 } ] {     & \\scriptstyle + + + & \\scriptstyle -++ & \\scriptstyle + -+ & \\scriptstyle --+ & \\scriptstyle + + - & \\scriptstyle -+- & \\scriptstyle + -- & \\scriptstyle --- \\cr   1=2 & 0 & 1 & -1 & 0 & 0 & 1 & -1 & 0 \\cr   1=3 & 0 & 1 & 0 & 1 & -1 & 0 & -1 & 0 } \\ .\\ ] ] in terms of the parameters @xmath154 of the @xmath130-model the constrains are @xmath161 the intersection of the previous variety with the necessary condition for a border case , i.e. @xmath162 , gives the equations of the constrain on the border .",
    "the theory of toric ideals is due to sturmfels@xcite .",
    "we do not discuss here an important topic of this area , namely markov bases which were introduced in another seminal paper by diaconis and sturmfels .",
    "the border of an @xmath47-model is discussed in detail in kahle s thesis@xcite together with a generalization to general exponential families due to rauh , kahle and ay .",
    "here we have associated the border to a special version of the @xmath47-model using an hilbert basis as set of canonical statistics , an idea which is mentioned first in rapallo s thesis@xcite .",
    "proofs are published in malag and pistone .",
    "hilbert basis computations where done using ` 4ti2`@xcite and @xcite .",
    "another important topic we do not discuss here is birch s theorem , see the exposition by pachter and sturmfels .",
    "the discussion outlined in the examples is new .",
    "a key result in exponential families is the relation of the partial derivatives of the cumulant function with the cumulants of the canonical statistics . in particular , the gradient of the cumulant generating function maps the canonical parameters onto the interior of the convex polytope generated by the values of the canonical statistics .",
    "we discuss here a version of this in the case of @xmath47-models .",
    "we call _ design _ any finite set of real vectors .",
    "the image of a lef under the canonical statistics is the _",
    "canonical _ lef .",
    "its support is a _ design _ @xmath163 .",
    "in particular , the canonical version of an @xmath47-model is supported by the design @xmath164 whose points are the columns of the model matrix .",
    "the set of all polynomials which are zero on a design is the _ design ideal _ i@xmath165 .",
    "the canonical @xmath47-model has the form @xmath166 with normalizing constant ( partition function ) @xmath167 in the weyl algebra @xmath168 we define the operators @xmath169 where the equality follows from the commutation relation @xmath170 . for all @xmath171 we have",
    "@xmath172 so that @xmath173 and , by iteration , _ @xmath174 _ , @xmath175 .",
    "the operator @xmath176 applied to the polynomial @xmath177 $ ] gives @xmath178 for @xmath179 we have the commutation @xmath180 , hence @xmath181    by dividing by the normalizing constant we obtain he following expression for the moments : @xmath182 } \\ .\\ ] ]    from the ring homomorphism @xmath183 & \\to & { \\mathbb{c}}\\langle t_1 \\dots t_m , \\partial_1 \\dots \\partial_m\\rangle , \\\\",
    "x_i & \\mapsto & t_i\\partial_i ,   \\end{array } \\right.\\ ] ] we have for each polynomial @xmath184 @xmath185    as @xmath186 , the polynomial @xmath187 is identified up to an element of the design ideal .",
    "the quotient ring @xmath188 has a linear basis @xmath189 of monomials called _ monomial basis _",
    ", with @xmath190 elements .",
    "[ prop : differential ]    1 .",
    "let @xmath189 , be a monomial basis for @xmath191 .",
    "then @xmath192 satisfies the following system of @xmath193 linear non - homogeneous differential equations : @xmath194 2 .",
    "[ prop : differential2 ] let @xmath195 be the ( reduced ) indicator polynomial of @xmath196 .",
    "then @xmath192 satisfies the following system of @xmath193 linear non - homogeneous differential equations : @xmath197 [ item:2 ] 3 .",
    "let @xmath198 be a polynomial in the toric ideal of the monomial homomorphism @xmath199 .",
    "then @xmath200    in the previous theorem , if the right end sides in the first two items are expressed in terms of known moments , the equations are homogeneous , e.g. item [ item:2 ] becomes @xmath201      the model matrix is the same as in with the 23-row deleted : @xmath202 } ] {     & \\scriptstyle + + + & \\scriptstyle -++ & \\scriptstyle + -+ & \\scriptstyle --+ & \\scriptstyle + + - & \\scriptstyle -+- & \\scriptstyle + -- & \\scriptstyle --- \\cr   0   & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\cr   1   & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 \\cr   2   & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 1 \\cr   3   & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 \\cr   12 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 \\cr   13 & 0 & 1 & 0 & 1 & 1 & 0 & 1 & 0 } \\ .\\ ] ] the orthogonal space is generated by the missing interactions @xmath203 and @xmath204 .",
    "computations where done with the software",
    ". a monomial basis of the design is @xmath205 and the indicator polynomial of the column @xmath206 , is expressed in this monomial basis by @xmath207 it follows that the differential operator of proposition [ prop : differential ] is @xmath208      here we use the algebraic theory of design which was presented first by pistone and wynn and discussed in detail in the quoted monograph .",
    "the practical interest and feasibility of the resulting computations is object of current research .",
    "we consider in this section an homogeneous irreducible markov chain @xmath209 , @xmath210 , with state space @xmath211 , initial probability @xmath212 , transitions @xmath213 , @xmath214 .",
    "let @xmath215 and @xmath216 . the transitions in @xmath217 are called _",
    "loops_. the directed graph of transitions @xmath218 is defined by @xmath219 if , and only if , @xmath220 , @xmath221 , and it is connected .",
    "let @xmath222 be a trajectory with positive probability , i.e. a path of the graph of transitions , @xmath223 with @xmath224 , @xmath225 .",
    "the set of trajectories with @xmath226 transitions is denoted by @xmath227 . for each @xmath228 ,",
    "the transition s count is the integer @xmath229-matrix with elements @xmath230 .",
    "the joint distribution up to the time @xmath226 on the sample space @xmath227 is a monomial term in the ring @xmath231 $ ] , @xmath232    the sparse matrix whose rows have indexes in @xmath233 , whose columns have indexes in @xmath227 , such that the column @xmath222 is @xmath234 , @xmath235 , @xmath236 , defines a toric statistical model on @xmath227 called _ toric markov chain _",
    "( tmc ) .",
    "the unnormalized density up to the time @xmath226 of the toric model is @xmath237    for example , if the state space is @xmath238 , a direct computation shows that the tmc is , up to a linear transformation of the canonical parameters , equal to the constrained model of the type of , namely @xmath239 the constrain is a linear constrain on the canonical parameters @xmath240 , @xmath241 .",
    "in fact , the constrained model is an exponential family .    in the tmc",
    "the @xmath32 s parameters are not required to be transition probabilities , therefore the markov chain model is a submodel of the tmc model given by linear restrictions on the @xmath32 s .",
    "it follows that the mc is not an exponential family , but it is a curved exponential family .",
    "more precisely , as it is seen from the product form , the tmc from time 0 to time @xmath226 is a special markov process with non - homogeneous transition probabilities . if the transition probabilities are homogeneous , then the tmc is a markov chain . moreover , we note that the joint distributions of the tmc does not form a projective system for different @xmath226 s , in particular classical results on the mixture representation of processes whose sufficient statistics are transition s counts do not apply here .",
    "let us define the vector @xmath242 , @xmath13 .",
    "the tmc on @xmath227 is a mc if , and only if , it is constant , say @xmath243 , @xmath13 .",
    "we denote by @xmath244 the probability of a trajectory @xmath228 .",
    "a transition matrix @xmath245 is obtained by normalizing of the @xmath246 s , @xmath247 and @xmath248 if @xmath249 . as @xmath250 , the marginal unnormalized density up to time @xmath251 is @xmath252 and",
    "the conditional probabilities are @xmath253 the marginal unnormalized density up to time @xmath254 is @xmath255 and the conditional probabilities are given by @xmath256 for generic vertices @xmath221 we have : @xmath257 hence tmc is an homogeneous mc if , and only if , @xmath258 i.e. if and only if @xmath243 , @xmath13 .",
    "in such a case the @xmath259 is proportional to the transition matrix @xmath213 .",
    "a second description of the relation between the mc and the tmc follows by writing @xmath259 as @xmath260 in .",
    "the unnormalized density @xmath261 can be re - written as @xmath262 where @xmath263 is the number of exits from @xmath264 , including transitions from @xmath264 to @xmath264 itself .",
    "this distribution is the distribution of a mc with the added weight @xmath265 . or",
    ", we can say that the tmc , given the number of outs @xmath266 , @xmath13 , is a mc .",
    "the normalizing constant of a tmc on a graph @xmath267 is @xmath268 and the normal equations for the maximum likelihood estimation can be written as polynomial equations with the operator introduced in as @xmath269 , @xmath270 .",
    "the existence of a solution of the normal equation stems from the general theory of exponential families if the transition s observed values are strictly positive .",
    "if it is not the case , we can find a border solution using the following characterization of transition s counts .",
    "[ prop : grande ] an integer matrix @xmath271 is the transition count of a trajectory @xmath222 if , and only if , it is connected and @xmath272 is either 0 for all @xmath273 or is @xmath274 for a vertex @xmath275 , @xmath276 for a different vertex @xmath277 , and zero for all @xmath278 .    an observed transition s count @xmath279 is connected and defines a sub - graph of the model graph by the positivity condition @xmath280 .",
    "it follows that the normal equations have a solution in a submodel .",
    "we have defined a toric ideal associated with the unnormalized densities on @xmath227 .",
    "now we want to consider all trajectories , i.e. trajectories of any length @xmath226 .",
    "we need first to fix a more precise language for closed trajectories .",
    "a _ closed trajectory _",
    "@xmath281 is any trajectory going from an initial @xmath275 back to @xmath275 ; @xmath282 is the reversed closed trajectory .",
    "if we do not distinguish any initial vertex , the equivalence class of closed trajectories is called a _",
    "trail_. a closed trajectory is _ elementary _ if it has no proper closed sub - trajectory , i.e. if does not meet twice the same vertex except the initial one @xmath275 .",
    "the trail of an elementary closed path is a _",
    "cycle_. the set of cycles @xmath283 is finite . a trajectory @xmath284 is elementary if does not contain any cycle .    given a transition matrix @xmath245 and an initial probability @xmath212 , we compute the probability of any trajectory as @xmath285 .",
    "the factor @xmath286 does not depend on the initial point @xmath287 if the trajectory is closed ; in fact in such a case the matrix @xmath279 is a function of the trail only .",
    "consider the ring @xmath288 $ ] .    1 .",
    "the _ markov monomial ideal _ is the monomial ideal generated by the monomials @xmath289 , where @xmath222 is a trajectory , @xmath290 .",
    "the _ stationary markov ideal _ is the ideal generated by the markov monomial ideal and by the equations of stationarity @xmath291 , @xmath292 .",
    "the _ ideal of closed trajectories _ is the monomial ideal generated by the monomials @xmath293 , @xmath222 closed , in the ring @xmath294 $ ] .",
    "[ prop : monimialcycles ]    1 .",
    "for each trajectory @xmath222 there exist an elementary sub - trajectory @xmath295 , possibly empty , and nonnegative integers @xmath296 , @xmath297 , such that @xmath298 .",
    "all matrices @xmath299 and @xmath300 , @xmath297 are boolean .",
    "if @xmath295 is not empty , it has the same initial and final point as @xmath222 .",
    "[ item : monimialcycles2 ] the monomial ideal of closed trajectories is generated by the cycles .",
    "the monomials associated to a cycle are square - free",
    ". 3 .   the markov monomial ideal is generated by the cycles and the elementary trajectories .    1 .",
    "let @xmath301 be a trajectory and consider the first closed trajectory encountered , @xmath302 , if any .",
    "then @xmath303 is an elementary closed trajectory and @xmath304 is either empty or a trajectory .",
    "hence @xmath305 and the iterations stops after a finite number of steps .",
    "if @xmath222 is closed , then @xmath306 , hence @xmath307 . on a closed trajectory @xmath222",
    ", the matrix of transition counts @xmath308_{v , w\\in v } = \\sum_{k=1}^n ( x_{k-1}(\\omega)=v , x_k(\\omega)=w)\\ ] ] has row sums equal to column sums , i.e. there are as many _ ins _ as _ outs _ at each vertex , see prop .",
    "[ prop : grande ] .",
    "if the trajectory is closed , then we can apply the previous item .",
    "otherwise @xmath222 and @xmath309 start at the same vertex and @xmath310    in a sense , the joint distribution of each trajectory is characterized by the markov monomial ideal .",
    "let @xmath245 be an irreducible markov matrix .",
    "the distribution of the stationary markov chain is a function of transition s monomials of the cycles .",
    "consider @xmath311 with @xmath220 and define the sets @xmath312 of the trajectories from @xmath313 to @xmath264 of length @xmath314 , @xmath315 . for each @xmath316 , the trajectory @xmath317 is closed . because of the markov property and irreducibility",
    ", we have the cesaro limit @xmath318 , so that @xmath319 as @xmath320 is a product of cycle s monomials because of prop .",
    "[ prop : monimialcycles ] , all values @xmath321 of the 2-step joint distribution depend on the values of the cycle s monomials .",
    "we note that the values of cycle s monomials are dependent .",
    "for example , in the complete graph with 4 vertices there are 20 cycles ( including the 4 loops ) , while the number of degrees of freedom for a generic transition probability on 4 points is 12 .",
    "the name tmc was used first by pachter and sturmfels .",
    "see also hare and takemura for slightly different definitions .",
    "the representation of processes whose sufficient statistics are transition s count is a version of de finetti exchangeability , see freedman@xcite .",
    "[ prop : grande ] is proved grande@xcite .",
    "a tmc is a particular case of a graphical model in the sense of lauritzen@xcite .",
    "a related issue is the characterization of the distribution of stationary markov chains via a mixture on monomials on cycles that was obtained by mcqueen@xcite , cfr .",
    "a transition matrix @xmath213 , @xmath214 , satisfies the _ detailed balance _",
    "( db ) condition if @xmath322 , @xmath214 for some strictly positive @xmath323 , @xmath273 . as a consequence",
    ", @xmath324 is an invariant probability and the stationary markov chain @xmath325 has _",
    "reversible _ two - step joint distribution @xmath326 , @xmath214 , @xmath327 .",
    "the distribution of the markov chain is uniquely parameterized by its symmetric two - step joint distribution .",
    "the db assumption is trivially satisfied for @xmath328 and moreover @xmath220 if , and only if , @xmath329 .",
    "given an undirected connected graph @xmath330 with no loops and the directed graph @xmath331 whose arcs are the two directions of each edge , we consider here all transition probabilities such that @xmath248 , @xmath332 , if , and only if , @xmath333 .",
    "let @xmath217 denote loops with positive transition @xmath334 and @xmath335 the invariant probability .    for each trajectory @xmath301 in the graph @xmath336",
    "let @xmath337 be the _ reversed trajectory_. the reversed probability is @xmath338 .",
    "from we compute the likelihood @xmath339 the log - likelihood @xmath340 because of the stationarity of @xmath335 , the divergence is @xmath341 } + \\sum_{a\\in \\mathcal a } { \\log\\left(\\frac{p_a}{p_{ra}}\\right ) } { { \\operatorname{\\mathbb{e}}}_{\\operatorname{\\mathbb{p}}}\\left[n_a\\right ] } \\\\ = n \\sum_{(v\\to w ) \\in \\mathcal a } { \\log\\left(\\frac{p_{v\\to w}}{p_{w\\to v}}\\right ) } \\pi(v ) p_{v\\to w } \\\\ =",
    "n \\sum_{v , w \\in v } { \\log\\left(\\frac{p(v , w)}{p(w , v)}\\right ) } p(v , w ) \\ ,   \\end{gathered}\\ ] ] where @xmath342 is the two - step joint distribution . as the divergence is zero if , and only if , the probabilities are equal , the db condition is equivalent to @xmath343 .",
    "the last statement could be easily derived otherwise , but the computation of the divergence has an independent interest , e.g. it shows the linear dependence on @xmath226 of the divergence .",
    "let @xmath222 a _ closed trajectory _ and let @xmath344 its reversed trajectory .",
    "in the previous section we have shown that the distribution of the markov chain is uniquely characterized by the initial probability , the loop transitions @xmath334 , @xmath273 , and the monomials @xmath345 , for each closed and loop - free @xmath222 .    in the case of a reversible chain ,",
    "these monomials are invariant under the reversion .",
    "let the markov chain @xmath346 have its transitions supported by the connected graph @xmath336 .",
    "the mc is reversible if , and only if , @xmath347 for all closed trajectory @xmath222 .",
    "this suggests the following definition .",
    "the _ kolmogorov s ideal _ or _ k - ideal _ of the graph @xmath336 is the ideal generated by the binomials @xmath348 , where @xmath222 is a closed trajectory .    the generation of the ideal of closed trajectory by the cycles of prop .",
    "[ prop : monimialcycles ] together with the sygyzy characterization of grbnber basis on an ideal lead to the following proposition .    1 .",
    "the k - ideal is generated by the set of binomials @xmath349 , where @xmath222 is cycle .",
    "the binomials @xmath348 , where @xmath222 is any cycle , form a _ reduced universal grbner basis _ of the k - ideal .    in the previous sections",
    "we have constructed a process leading from a monomial parameterization of a statistical model to a binomial basis of its toric ideal . here",
    "the process is reversed , in that we are given a binomial ideal and would like to show it is , in fact , a toric ideal .",
    "this program will eventually produce a parameterization of reversible markov transitions in monomial form .",
    "we observe that the variety of the k - ideal is not satisfied by probabilities , but by transition probabilities .",
    "we had a similar issue when describing the difference between tmcs and mcs .",
    "the proof that the k - ideal is a toric ideal is based on standard construct of graph theory that we are going to review now .",
    "let @xmath350 be the set of cycles of @xmath351 . for each cycle @xmath352",
    "we define the _ cycle vector _ of @xmath222 to be @xmath353 , where @xmath354 the _ cycle space _ is the vector space generated in @xmath355 by the cycle vectors .    for each proper subset @xmath91 of the set of vertices , @xmath356 ,",
    "say @xmath357 , we define the _ cocycle vector _ of @xmath91 to be @xmath358 , with @xmath359 the cocycle vectors generate the _ cocycle space_. the cycle space and the cocycle space orthogonally split @xmath360 .",
    "we denote by @xmath361 the integer - valued cycle vectors .",
    "we will see below how this integer vectors are related to transition s counts .",
    "the model matrix of the toric model we are going to produce for the k - ideal is the matrix with row s indices in @xmath362 and column s indexes in @xmath351 .",
    "the element in position @xmath363 of the @xmath364-block is one if , and only if , the arc @xmath365 belongs to the edge @xmath366 .",
    "the element in position @xmath367 of the @xmath368-block is @xmath369 .",
    "we call this model matrix the _ cocycle matrix_. it follows that the cocycle space is the kernel of the cocycle matrix and @xmath361 is its lattice .",
    "the following definition provides a generalization of the hilbert basis we already used in our discussion of the border of an @xmath47-model .",
    "it is needed below to provide a more precise version of the cycle decomposition of a closed trajectory .    1",
    ".   given two integer vectors @xmath370 , we say @xmath371 is _ conformal _ to @xmath372 , @xmath373 , if the component - wise product is nonnegative and @xmath374 component - wise , i.e. @xmath375 and @xmath376 for all @xmath377 .",
    "a _ graver basis _ of @xmath361 is the set of the minimal elements with respect to the conformity partial order @xmath378 .    1 .   for each integer cycle vector @xmath379 , @xmath380",
    ", there exist cycles @xmath381 and positive integers @xmath382 , such that @xmath383 , @xmath384 , @xmath225 and @xmath385 2 .",
    "the set @xmath386 is a _",
    "graver basis _ of @xmath361 .    from the previous proposition follows the result on the k - ideal .",
    "the k - ideal is the toric ideal of the cocycle matrix .",
    "in fact , the binomials @xmath348 , @xmath387 , form a graver basis of the k - ideal . the cocycle matrix has negative entries and it could easily modified to a matrix with nonnegative entries as we have done in the discussion of the ising model .",
    "the previous algebraic statement is rephrased in statistical terms as follows .    1 .",
    "the _ strictly positive reversible transition probabilities _ on @xmath331 are given by @xmath388 where @xmath389 , @xmath390 .",
    "2 .   the first set of parameters , @xmath391 , is a function of the edge @xmath15 .",
    "3 .   the second set of parameters , @xmath392 , @xmath357 , represents the deviation from symmetry .",
    "it is not identifiable because the full set of cocycle vectors @xmath393 , @xmath357 , is not linearly independent .",
    "4 .   the parametrization can be used to derive an explicit form of the invariant probability .",
    "the following proposition is a summary of all results .",
    "consider the strictly non - zero points on the k - variety .    1 .",
    "the symmetric parameters @xmath394 , @xmath41 , are uniquely determined .",
    "the parameters @xmath395 , @xmath357 are confounded by the @xmath368-block of the cocycle matrix .",
    "an identifiable parametrization is obtained by taking a subset of parameters corresponding to linearly independent rows , denoted by @xmath395 , @xmath396 , @xmath397 : @xmath398 3 .",
    "the detailed balance equations , @xmath399 , are verified if , and only if , @xmath400    it is possible to give an algebraic form of the original kolmogorov statement on the equivalence of detailed balance with equality of transitions on closed trajectories in the form of a statement on elimination ideals .",
    "the _ detailed balance ideal _ is the ideal @xmath401 in the ring @xmath402 $ ] .    1 .",
    "the matrix @xmath403_{v\\to w \\in { \\mathcal a}}$ ] is a point of the variety of the k - ideal if and only if there exists @xmath404 such that @xmath405 belongs to the variety of the detailed balance ideal .",
    "the detailed balance ideal is a toric ideal .",
    "the k - ideal is the @xmath406-elimination ideal of the detailed balance ideal .    by combining the monomial representation of the transitions and the monomial representation of the invariant probability ,",
    "we obtain a classical parameterization of reversible transitions in the form @xmath407 together with the constrain @xmath408 this form is well known in the literature on the _ hastings - metropolis _ simulation algorithm , where we are given an unnormalized positive probability @xmath406 and a transition @xmath409 if @xmath410 .",
    "we are required to produce a new transition @xmath411 such that @xmath245 is reversible with invariant probability @xmath406 and @xmath412 .",
    "we have @xmath413 and moreover we want @xmath414    let @xmath415 be a probability on @xmath229 , strictly positive on @xmath416 , and let @xmath417 . if @xmath4180,1[\\times]0,1 [ \\to ] 0,1[$ ] is a symmetric function such that @xmath419 then @xmath420 is a 2-reversible probability on @xmath416 such that @xmath421 , positive if @xmath415 is positive .",
    "the proposition applies to various cases of interes , e.g. @xmath422 , @xmath423 , @xmath424 .      a recent exposition of the theory of reversible mcs appears in the lecture notes by aldous and",
    "we use standard results in graph theory , see e.g. the monograph by bollobas@xcite . here",
    "we mainly follow our paper .",
    "the application to simulation is discussed e.g. in the monograph by liu@xcite .",
    "the basic notions in probability and mathematical statistics are those of independence and conditioning , which in turn are expressed by product of probability and conditional probability .",
    "it is not by chance that almost all classical statistical models have a product form and that the logarithmic transformations are a key ingredient of computation in statistics .",
    "modern combinatorial and computational commutative algebra have provided a unifying framework for the diverse instances of such basic structures . in particular , the notion of toric ideal captures the essentials of what we have called lattice exponential families , i.e. the discrete case that is rife in applied statistics and statistical physics .",
    "we have presented an overview of the algebraic theory of statistical models that fall under the scheme , together with an algebraic discussion of their limit cases and their differentiation .",
    "the application to markov chains is an expansion of these ideas to objects that do not belong to a probability simplex .",
    "this is actually a special case of a more general interesting theory , namely bayes networks .",
    "it is likely to expect applications to bayesian statistics , a topic we have not touched upon .",
    "we thank the organizers of the osaka conference , especially professor takayuki hibi for providing an ideal place to discuss these , and related , ideas .",
    "we thank paolo baldi , francesco grande , luigi malag , fabio rapallo for useful discussions while this paper was in preparation .",
    "n.  n. encov , _ statistical decision rules and optimal inference _ , translations of mathematical monographs , vol .",
    "53 ( american mathematical society , providence , r.i . , 1982 ) .",
    "translation from the russian edited by lev j. leifman .",
    "g.  pistone , e.  riccomagno and h.  p. wynn , _ algebraic statistics .",
    "computational commutative algebra in statistics _ , monographs on statistics and applied probability , vol .",
    "89 ( chapman & hall / crc , boca raton , fl , 2001 ) ."
  ],
  "abstract_text": [
    "<S> * abstract * this is a review of current research in markov chains as toric statistical models . </S>",
    "<S> its content is a mixture of background information , results from the relevant recent literature , new results , and work in progress . </S>"
  ]
}