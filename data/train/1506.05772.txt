{
  "article_text": [
    "since the discovery of dna structure by watson and crick , molecular biology has progressed increasingly fast , with rapid advances in sequencing and related genomic technologies . among these",
    ", dna microarrays and rna - seq have been widely adopted to obtain gene expression profiles , by measuring the concentration of tens of thousands of mrna molecules in single assays @xcite . despite their enormous potential @xcite ,",
    "problems of reproducibility and reliability @xcite have discouraged their use in some areas , e.g.  biomedicine @xcite .",
    "the normalization of gene expression , which is required to set a common reference level among samples @xcite , has been reported to be problematic , affecting the reproducibility of results with both microarray @xcite and rna - seq @xcite .",
    "batch effects and their influence on normalization have recently received a great deal of attention @xcite , resulting in approaches aiming to remove unwanted technical variation caused by differences between batches of samples or by other sources of expression heterogeneity @xcite . a different issue , however ,",
    "is the underlying assumption made by the most widely used normalization methods to date , such as median and quantile normalization @xcite for microarrays , or rpkm ( reads per kilobase per million mapped reads ) @xcite , tmm ( trimmed mean of m - values ) @xcite , and deseq @xcite normalization for rna - seq , which posit that all or most genes are not differentially expressed @xcite .",
    "although it may seem reasonable for many applications , this _ lack - of - variation assumption _ has not been confirmed .",
    "moreover , results obtained with external controls @xcite or with rt - qpcr @xcite suggest that it may not be valid .",
    "some methods have been proposed to address this issue , based on the use of spike - ins @xcite , negative control probes ( sqn , subset quantile normalization ) @xcite , or negative control genes ( ruv-2 , remove unwanted variation , 2-step ) @xcite .",
    "these methods use external or internal controls that are _ known a priori _ not to be differentially expressed @xcite .",
    "their applicability , however , has been limited by this requirement of a priori knowledge , which is rarely available for a sufficiently large number of controls .",
    "in addition , other methods have been proposed to address the lack - of - variation assumption by identifying a subset of non - differentially expressed genes from the assay data , such as cross - correlation normalization @xcite , lvs ( least - variant set ) normalization @xcite , and nvas ( nonparametric variable selection and approximation ) normalization @xcite . while lvs normalization requires setting in advance a number for the fraction of genes to be considered as non - differentially expressed , with values in the range 4060% @xcite , cross - correlation and nvas normalization are expected to degrade in performance when more than 50% of genes are differentially expressed @xcite .",
    "more recently , crossnorm has been introduced @xcite , based on the mixture of gene expression distributions from the experimental conditions .",
    "this method , however , has been proposed for two experimental conditions , and specially for paired samples .",
    "the extension of this approach to experimental designs with unpaired samples and more than a few experimental conditions would lead , as far as we can hypothesize , to an unmanageable size of the data matrix to process .",
    "thus , to clarify and overcome the limitations imposed by the lack - of - variation assumption , we have developed an approach to normalization that does not assume lack - of - variation and that is suitable to most real - world applications .",
    "hence , we aimed to avoid the need of spike - ins , a priori knowledge of control genes , or assumptions on the number of differentially expressed genes .",
    "the analysis of several gene expression datasets using this approach confirmed that our methods reached these goals .",
    "furthermore , our results show that assuming lack - of - variation can severely undermine the detection of gene expression variation in real assays .",
    "we have found that large numbers of differentially expressed genes , with substantial expression changes , are missed or misidentified when data are normalized with methods that assume lack - of - variation .",
    "a large gene expression dataset was obtained from biological triplicates of _ enchytraeus crypticus _ ( a globally distributed soil organism used in standard ecotoxicity tests ) , sampled under 51 experimental conditions ( 42 treatments and 9 controls ) , involving exposure to several substances , at several concentrations and durations according to a factorial design ( supplementary table  s1 ) .",
    "gene expression was measured using a customized high - density oligonucleotide microarray @xcite , resulting in a dataset with 18,339 gene probes featuring good hybridization signal in all 153 samples .",
    "taking into account the design of the microarray @xcite , we refer to these gene probes as _ genes _ in what follows .    to further explore and compare outcomes between normalization methods ,",
    "two synthetic random datasets were built and analyzed .",
    "one of them was generated with identical means and variances gene - by - gene to the real _ e. crypticus _ dataset , and under the assumption that no gene was differentially expressed .",
    "in addition , normalization factors were applied , equal to those obtained from the real dataset .",
    "thus , this synthetic dataset was similar to the real one , while complying by construction with the lack - of - variation assumption .",
    "the other synthetic dataset was also generated with comparable means and variances to the real dataset and with normalization factors , but in this case differential expression was added . depending on the experimental condition ,",
    "several numbers of differentially expressed genes and ratios between over- and under - expressed genes were introduced ( see methods ) .",
    "together , these synthetic datasets with and without differential gene expression represent , respectively , the alternative and null hypotheses for a statistical test of differential gene expression .",
    "the gene expression datasets were normalized with four methods .",
    "two of these methods are the most widely used procedures for microarrays , namely median ( or scale ) normalization and quantile normalization @xcite .",
    "( note that current methods of normalization for rna - seq , such as rpkm @xcite , tmm @xcite , and deseq @xcite , perform between - sample normalization by introducing a scaling per sample obtained with some form of mean or median , using all or a large set of genes .",
    "thus their performance , in what concerns the issues addressed here , is expected to be similar to that of median normalization for microarrays . )",
    "the other two normalization methods were developed for this study , they being called _ median condition - decomposition normalization _ and _ standard - vector condition - decomposition normalization _ , respectively mediancd and svcd normalization in what follows .    with the exception of quantile normalization , all used methods apply a multiplicative factor to the expression levels of each sample , equivalent to the addition of a number in the usual @xmath0-scale for gene expression levels . solving the _ normalization problem _",
    "consists of finding these correction factors",
    ". this problem can be exactly and linearly decomposed into several sub - problems : one within - condition normalization for each experimental condition and one final between - condition normalization for the condition averages ( see methods ) . in the within - condition normalizations ,",
    "the samples ( replicates ) subjected to each experimental condition are normalized separately , whereas in the final between - condition normalization average levels for all conditions are normalized together . because there are no genes with differential expression in any of the within - condition normalizations",
    ", the lack - of - variation assumption only affects the final between - condition normalization .",
    "the assumption is avoided by using , in this normalization , expression levels only from _ no - variation genes _ , defined as genes that show no evidence of differential expression under a statistical test .",
    "an important detail is that the within - condition normalizations ensure good estimates of the within - condition variances , which are required by the statistical test for identifying no - variation genes .",
    "this requisite also implies that a minimum of two samples is required per experimental condition",
    ". both methods of normalization proposed here , mediancd and svcd normalization , follow this condition - decomposition approach .    with mediancd normalization",
    ", all normalizations are performed with median values , as in conventional median normalization , but only no - variation genes are employed in the between - condition step . otherwise ,",
    "if all genes were used in this final step , the resulting total normalization factors would be exactly the same as those obtained with conventional median normalization .    for svcd normalization",
    ", a vectorial procedure was developed to carry out each normalization step , called standard - vector normalization .",
    "the samples of any experimental condition , in a properly normalized dataset , must be _",
    "exchangeable_. in mathematical terms , the expression levels of each gene can be considered as an @xmath1-dimensional vector , where @xmath1 is the number of samples for the experimental condition .",
    "after standardization ( mean subtraction and variance scaling ) , these standard vectors are located in a @xmath2-dimensional hypersphere .",
    "the exchangeability mentioned above implies that , when properly normalized , the distribution of standard vectors must be invariant with respect to permutations of the samples and must have zero expected value .",
    "these properties allow to obtain a robust estimator of the normalization factors , under fairly general assumptions that do not imply any particular distribution of gene expression ( see methods ) .",
    "it is worth mentioning that the limit case when the number of samples is two ( @xmath3 ) represents a degenerate case for standard - vector normalization , in which the space of standard vectors reduces to a 0-dimensional space with only two points . in this degenerate case ,",
    "standard - vector normalization is equivalent to global loess normalization @xcite , i.e.  loess normalization without correction for non - linearities with respect to the level of gene expression or microarray print - tips . in this sense ,",
    "standard - vector normalization is a generalization to any number of samples of the approach underlying the different types of loess normalization .",
    "figure  [ fig:01 ] displays the results of applying the four normalization methods to the real and two synthetic datasets .",
    "each panel shows the interquartile range of expression levels for the 153 samples , grouped in triplicates exposed to each experimental condition .",
    "both median and quantile normalization ( second and third rows ) yielded similar outputs for the three datasets .",
    "in contrast , mediancd and svcd normalization ( fourth and fifth rows ) detected much greater variation between conditions in the real dataset and the synthetic dataset with differential gene expression .",
    "conventional median normalization makes , by design , the median of all samples to be the same , while quantile normalization makes the full distribution of gene expression of all samples to be the same . hence ,",
    "if there were differences in medians or distributions between experimental conditions , both methods would have removed them .",
    "such variation was indeed present in the synthetic dataset with differential gene expression ( fig .",
    "[ fig:01]k , n ) , and hence we can hypothesize the same for the real dataset ( fig .  [ fig:01]j , m ) .      to clarify",
    "how mediancd and svcd normalization preserved the variation between conditions , we studied the influence of the choice of no - variation genes in the final between - condition normalization .",
    "to this end , we obtained the between - condition variation as a function of the number of no - variation genes , in two families of cases . in one family",
    ", no - variation genes were chosen in decreasing order of @xmath4-values from the statistical test used to analyze variation between conditions . in the other family",
    ", genes were chosen at random .",
    "the first option was similar to the approach implemented to obtain the results presented in fig .",
    "[ fig:01]j  o , with the difference that , there , the no - variation genes were chosen automatically , by a subsequent statistical test performed on the distribution of @xmath4-values ( see methods ) .    for the real dataset ( fig .",
    "[ fig:02]a ) , the random choice of genes resulted in @xmath5 decays ( @xmath6 being the number of chosen genes ) , followed by a plateau .",
    "the @xmath5 decays reflect the error in the estimation of normalization factors . selecting the genes by decreasing @xmath4-values",
    ", however , yielded a completely different result . up to a certain number of genes , the variance remained similar , but for larger numbers of genes the variance dropped rapidly .",
    "figure  [ fig:02]a shows , therefore , that between - condition variation was removed as soon as the between - condition normalizations used genes that changed in expression level across experimental conditions .",
    "the big circles in fig .",
    "[ fig:02]a indicate the working points of the normalizations used for the results displayed in fig .",
    "[ fig:01]j , m .",
    "in fact , these points slightly underestimated the variation between conditions . although the statistical test for identifying no - variation genes ensured that no evidence of variation was found , the expression of some selected genes varied across conditions .",
    "the results obtained for the synthetic dataset with differential gene expression ( fig .  [ fig:02]b ) were qualitatively similar to those of the real dataset , but with two important differences .",
    "the amount of between - condition variation detected ( by selecting no - variation genes by decreasing @xmath4-values ) was smaller than with the real dataset , implying that the real dataset had larger differential gene expression . additionally , the variation detected in the synthetic dataset had a simpler dependency on the number of genes , an indication that the differential gene expression introduced in the synthetic dataset had a simpler structure than that of the real dataset .",
    "figure  [ fig:02]c shows the results for the synthetic dataset without differential gene expression . there were no plateaus when no - variation genes were chosen randomly , only @xmath5 decays , and differences were small when no - variation genes were selected by decreasing @xmath4-values .",
    "big circles show that the working points of fig .",
    "[ fig:01]l , o were selected with all available genes as no - variation genes , which is the optimum choice when there is no differential gene expression .    overall , fig .",
    "[ fig:02 ] shows that the between - condition variation displayed in fig .",
    "[ fig:01]j , k , m ,",
    "n is not an artifact caused by using an exceedingly small or extremely particular set of genes in the final between - condition normalization , but that this variation originated from the datasets .",
    "the positions of the big circles in fig .",
    "[ fig:02 ] highlight the good performance of the statistical approach for choosing no - variation genes in the normalizations carried out for fig .",
    "[ fig:01]j  o . besides , the residual variation displayed by the @xmath5 decays implies that , as estimators of the normalization factors , svcd normalization features smaller error than mediancd normalization .",
    "in what follows , we call _ detected positives _ the differentially expressed genes ( degs ) resulting from the statistical analyses , _ treatment positives _ the degs introduced in the synthetic dataset with differential gene expression , _ true positives _ the detected positives which were also treatment positives , and _ false positives _ the detected positives which were not treatment positives",
    ". corresponding terms for _ negatives _ refer to genes which were not degs .",
    "figure  [ fig:03 ] shows the numbers of degs detected in the real and synthetic datasets , for each of the 42 experimental treatments compared to the corresponding control ( supplementary table  s2 ) , after normalizing with the four methods . for the real dataset ( fig .",
    "[ fig:03]a ) , the number of degs identified after mediancd and svcd normalization were much larger for most treatments , in some cases by more than one order of magnitude . for the synthetic dataset with differential gene expression ( fig .",
    "[ fig:03]b ) , results were qualitatively similar , but with less differential gene expression detected , consistently with fig .",
    "[ fig:02]a , b .",
    "the number of treatment positives can be displayed in this case ( empty black down triangles , fig .",
    "[ fig:03]b ) , showing a better correlation , with mediancd and svcd normalization , between the number of treatment positives and detected positives .",
    "for the synthetic dataset without differential gene expression ( fig .",
    "[ fig:03]c ) , no deg was found but for one or two degs in two conditions .",
    "given that the false discovery rate was controlled to be less than 5% per treatment , this is expected to happen when evaluating 42 treatments .",
    "figure  [ fig:03]a reports , for the real dataset , statistically significant changes of gene expression , that is , changes that can not be explained by chance . equally important is the effect size , i.e.  the scale of detected variation in degs , which is displayed by fig .  [ fig:04 ] .",
    "the boxplots show absolute fold changes of expression level for all degs detected after applying each normalization method .",
    "mediancd and svcd normalization allowed to detect smaller changes of gene expression , which were otherwise missed when using median and quantile normalization .",
    "this differential gene expression detected with mediancd and svcd normalization can hardly be considered negligible , given that , for all treatments , the interquartile range of absolute fold changes was above 1.5-fold , and , for more than 28 ( 67% ) treatments , the median absolute fold change was greater than 2-fold .",
    "interestingly , the scale of differential gene expression detected with mediancd and svcd normalization in this assay is of similar magnitude to those reported by studies of global mrna changes using external controls with microarrays and/or rna - seq @xcite .",
    "figure  [ fig:05 ] displays the balance of differential gene expression , i.e.  the comparison between the number of over- and under - expressed genes , for the real dataset .",
    "the quantity in the @xmath7-axes is the mean of an indicator variable @xmath8 , which assigns @xmath9 to each over - expressed deg and @xmath10 to each under - expressed deg .",
    "hence , balance of differential gene expression corresponds to @xmath11 , all degs over - expressed to @xmath12 , and , for example , 60% degs under - expressed to @xmath13 . as discussed below , and as it has been reported before @xcite",
    ", the balance of differential gene expression has a strong impact on the performance of normalization methods .",
    "figure  [ fig:05 ] shows that , regardless of the normalization method used , the unbalance of differential gene expression detected in the real dataset was substantial for most conditions .",
    "detected unbalances were ( in absolute value ) larger with mediancd and svcd normalization , in both cases with more than 30 ( 71% ) treatments having @xmath14 , that is , more than 75% of over- or under - expressed genes .",
    "moreover , the differences between the unbalances detected with median and quantile normalization , on one hand , and mediancd and svcd normalization , on the other , were specially notorious for the treatments with more degs ( treatments 2642 , fig .",
    "[ fig:03]a ) . in those cases , median and quantile normalization resulted in the smallest detected unbalances , whereas mediancd and svcd normalization yielded the largest ones , with values near @xmath15 for all but two treatments .",
    "true differential expression was known , by construction , for the synthetic dataset with differential gene expression .",
    "thus , fig .",
    "[ fig:06 ] shows for this dataset the true positive rate ( ratio between true positives and treatment positives , also known as statistical power or sensitivity ) and the false discovery rate ( fdr , ratio between false positives and detected positives ) . with conditions 1 to 20 , which correspond to those conditions with less than approximately 10% of treatment positives ( fig .",
    "[ fig:03]b , empty black down triangles ) , the true positive rate was similarly low for all normalizations . regarding the fdr , when the ( total ) number of detected positives was up to a few tens , variability of the fdr around the target bound at 0.05",
    "is to be expected , given that the bound is defined over an average of repetitions of the multiple - hypothesis test .",
    "yet , the fdr obtained after median and quantile normalization was higher than the 0.05 bound for most conditions .",
    "more striking , however , was the behavior for conditions 21 to 42 ( more than 10% of treatment positives ) .",
    "the true positive rates obtained after median and quantile normalization were much lower than those obtained with mediancd and svcd normalization , while the fdr after median and quantile normalization was clearly over the bound at 0.05 . in comparison , mediancd and svcd normalization , besides offering better sensitivity of differential gene expression , maintained the fdr consistently below the desired bound .",
    "figure  [ fig:07 ] further explores these results , by representing the true positive rate and false discovery rate ( fdr ) as a function of the unbalance between over- and under - expressed genes .",
    "figure  [ fig:07 ] shows that the unbalance of differential gene expression was a key factor in the results obtained with median and quantile normalization . when most degs were over- or under - expressed , both the true positive rate and fdr degraded markedly after using median or quantile normalization .",
    "in contrast , the true positive rate and fdr were not affected by the unbalance of differential gene expression when using mediancd or svcd normalization .    concerning the identification of no - variation genes , both mediancd and svcd normalization performed well .",
    "in the synthetic dataset without differential gene expression , both methods identified all genes as no - variation genes , which is the best possible result . in the synthetic dataset with differential gene expression , 1,834 genes ( 10% of a total of 18,339 genes ) were , by construction , negatives across all treatments .",
    "mediancd and svcd normalization detected , respectively , 1,723 and 1,827 no - variation genes , among which 96.9% and 95.2% were true negatives .",
    "to provide additional evidence of the performance of mediancd and svcd normalization , we analyzed the golden spike @xcite and platinum spike @xcite datasets .",
    "both of them are artificial real datasets , the largest ones for which true degs are known .",
    "hence , they have been widely used to benchmark normalization methods @xcite .",
    "the design of the golden spike dataset was questioned for reasons concerning , among others , the anomalous null distribution of @xmath4-values , the lack of biological replicates , and the high concentration of spike - ins @xcite .",
    "nevertheless , this dataset is worth considering here because it challenges what we claim are key capabilities of our approach , that is , to correctly normalize gene expression data when many genes are differentially expressed , even with large unbalance between over- and under - expression .",
    "this dataset consists of microarray data obtained with the affymetrix genechip drosgenome1 , with two experimental conditions and three technical replicates per condition .",
    "excluding affymetrix internal control probes , the dataset contains a total of 13,966 gene probe sets , of which 3,876 were spiked - in , which we call _ known _ in what follows . among these ,",
    "1,328 ( 34.3% ) were over - expressed ( known positives ) to varying degrees between 1.1- and 4-fold , while the remaining 2,535 ( 65.4% ) were spiked - in at the same concentration in both conditions ( known negatives ) .",
    "( percentages do not add up to 100% because of a very small number of probe sets with weak matching to multiple clones @xcite . )    in addition to the normalization methods used above , we included cyclic loess normalization @xcite in this case , because it facilitates a better comparison of results with previous studies @xcite .",
    "figure  [ fig:08 ] summarizes the results obtained for the golden spike dataset , by displaying receiver operating characteristic ( roc ) curves for the detection of differential gene expression .",
    "the upper panel shows the true positive rate ( as before , ratio between true positives and treatment positives ) versus the false positive rate ( ratio between false positives and treatment negatives ) , while the lower panel shows the number of true positives versus the number of false positives . in both cases , detected and treatment positives / negatives were restricted to known genes , following previous studies @xcite .",
    "doing otherwise would have given an excessively dominant role to the issue of cross - hybridization in the analysis of differential gene expression @xcite .",
    "additionally , the analysis was performed using only probe sets with hybridization signal in all samples , with the aim of factoring out differences between normalization methods caused by the response to missing data .",
    "results obtained without this restriction ( supplementary fig .",
    "s3 ) or with @xmath16-tests instead of limma @xcite analysis ( supplementary fig .",
    "s4 ) were very similar to those of fig .",
    "[ fig:08 ] .",
    "the comparison of roc curves shown in fig .  [ fig:08 ] highlight the superior performance of mediancd and , in particular , svcd normalization .",
    "dashed lines show results when the list of known negatives was given as an input to some of the normalization methods ( something than can not be done in real assays ) .",
    "it is remarkable that svcd normalization featured equally well with or without this information .",
    "points in fig .",
    "[ fig:08 ] indicate the results when controlling the false discovery rate ( fdr ) to be below 0.01 ( left point on each curve ) or 0.05 ( right point ) .",
    "figure  [ fig:08]b shows reference lines for actual fdr equal to 0.01 , 0.05 , 0.1 , 0.2 and 0.5 ( from left to right ) . in all cases ,",
    "the fdr was not adequately controlled , although the difference between intended and actual fdr was notably smaller with mediancd and svcd normalization .",
    "lack of control of the fdr in the analysis of this dataset has been previously reported @xcite .",
    "it is caused by the non - uniform ( hence anomalous ) distribution of @xmath4-values for negative genes , which results from the analysis of differential gene expression @xcite .",
    "it has been argued that this anomalous distribution of @xmath4-values is , in turn , a consequence of the own experimental design of the dataset , in particular the lack of biological replication and the way clone aliquots were mixed to produce each gene group with a given fold change @xcite .",
    "later studies have attributed this issue mostly to non - linear or intensity - dependent effects , not properly corrected in the within - sample normalization step ( e.g.  background correction ) of the analysis pipeline @xcite .    concerning the identification of no - variation genes , both mediancd and",
    "svcd normalization worked correctly .",
    "mediancd normalization identified 561 no - variation genes , of which 93.9% were known , and among which 84.1% were known negatives .",
    "svcd normalization , in comparison , featured better detection , with 1,224 no - variation genes identified , of which 94.4% were known , and among which 90.0% were known negatives .",
    "the design of the platinum spike dataset @xcite took into account the concerns raised by the golden spike dataset , offering a dataset with two experimental conditions and nine ( three biological @xmath17 three technical ) replicates per condition , and including near 50% more spike - ins .",
    "besides , differential gene expression was balanced , with respect to both total mrna amount and extent of over- and under - expression .",
    "gene expression data was obtained with affymetrix drosophila genome 2.0 microarrays . excluding affymetrix internal control probes ,",
    "the dataset contained a total of 18,769 probe sets , of which 5,587 were spiked - in , called _ known _ as above . among these , 1,940 ( 34.7% )",
    "were differentially expressed ( known positives ) to varying degrees between 1.2- and 4-fold ( 1,057 over - expressed , 883 under - expressed ) , while the remaining 3,406 ( 61.0% ) were spiked - in at the same concentration in both conditions ( known negatives ) .",
    "figure  [ fig:09 ] shows roc curves for the platinum spike dataset . as above ,",
    "only known genes were considered for detected and treatment positives / negatives .",
    "additionally , gene probes were restricted to those with signal in all samples .",
    "results obtained without this restriction ( supplementary fig .",
    "s5 ) or with @xmath16-tests instead of limma analysis ( supplementary fig .",
    "s6 ) were again very similar .",
    "in contrast to the golden spike dataset ( fig .  [ fig:08 ] ) , the performance concerning true and false positives resulting from the different normalization methods was much more comparable . in this case ,",
    "mediancd and svcd normalization were only marginally better .",
    "note , however , that the fdr was again not properly controlled ( fig .  [ fig:09]b ) . similarly to the golden spike dataset , and despite biological replication and a different experimental setup , obtained distributions of @xmath4-values for negative genes have been reported to be non - uniform @xcite .",
    "this fact is consistent with previous arguments relating the lack of control of the fdr to a general problem concerning the correction of non - linearities in the preprocessing of microarray data @xcite .    regarding the identification of no - variation genes , mediancd and",
    "svcd normalization also worked correctly with this dataset .",
    "mediancd normalization identified 2,090 no - variation genes , of which 95.4% were known , and among which 98.7% were known negatives .",
    "svcd normalization featured slightly better , with 2,232 no - variation genes identified , of which 95.3% were known , and among which 98.3% were known negatives .",
    "the lack - of - variation assumption underlying current methods of normalization was self - fulfilling , removing variation in gene expression that was actually present .",
    "moreover , it had negative consequences for downstream analyses , as it removed potentially important biological information and introduced errors in the detection of gene expression .",
    "the resulting decrease in statistical power or sensitivity is a handicap , which can be addressed by increasing the number of samples per experimental condition .",
    "however , degradation of the ( already weak ) control of the false discovery rate when using median or quantile normalization is a major issue for real - world applications .",
    "the removal of variation can be understood as additive errors in the estimation of normalization factors .",
    "considering data and errors vectorially ( see methods ) , the length of each vector equals , after centering and up to a constant factor , the standard deviation of the data or error .",
    "errors of small magnitude , compared to the data variance , would only have minor effects .",
    "however , errors of similar or greater magnitude than the data variance may , depending on the vector lengths and the angle between the vectors , severely distort the observed data variance .",
    "this will , in turn , cause spurious results in the statistical analyses .",
    "furthermore , the angles between the data and the correct normalization factors ( considered as vectors ) are random , given that expression data reflect biological variation while normalization factors respond to technical variation .",
    "if the assay is repeated , even with exactly the same experimental setup , the errors in the normalization factors will vary randomly , causing random spurious results in the downstream analyses .",
    "this explains , at least partially , the lack of reproducibility found in transcriptomics studies , especially for the detection of changes in gene expression of small - to - medium magnitude ( up to 2-fold ) , because variation of this size is more likely to be distorted by errors in the estimation of normalization factors .",
    "accordingly , the largest differences in numbers of differentially expressed genes detected by median and quantile normalization , compared to mediancd and svcd normalization , occurred in the treatments with the smallest magnitudes of gene expression changes ( figs .",
    "[ fig:03]a , [ fig:04 ] ) .    the variation between medians displayed in fig .  [ fig:01]j , k , m , n may seem surprising , given routine expectations based on current methods ( fig .",
    "[ fig:01]d , e , g , h ) .",
    "nevertheless , this variation inevitably results from the unbalance between over- and under - expressed genes . as an illustration of this issue ,",
    "let us consider a case with two experimental conditions , in which the average expression of a given gene is less than the distribution median under one condition , but greater than the median under the other .",
    "the variation of this gene alone will change the value of the median to the expression level of the next ranked gene . therefore",
    ", if the number of over - expressed genes is different from the number of under - expressed genes , and enough changes cross the median boundary , then the median will substantially differ between conditions . only when differential expression is negligible or is balanced with the respect to the median , will the median stay the same .",
    "note that this is a related but different requirement from the number of over- and under - expressed genes being the same .",
    "this argument applies equally to any other quantile in the distribution of gene expression .",
    "the case of quantile normalization is the least favorable , because it requires that changes of gene expression are balanced with respect to all distribution quantiles .    compared with other normalization approaches that try to identify no - variation genes from expression data , such as cross - correlation @xcite , lvs @xcite , or nvas @xcite normalization ,",
    "our proposal is able to work correctly with higher degrees of variation in gene expression , given that those methods are not expected to work correctly when more than 5060% of genes vary .",
    "the reason for this difference in performance lies in that those methods use a binning strategy over the average expression between conditions ( cross - correlation , nvas ) , or need to assume an a priori fraction ( usually 40 - 60% ) of non - differentially expressed genes ( lvs ) .",
    "when the majority of genes are differentially expressed , very few of those bins may be suitable for normalization , or the assumed fraction of non - differentially expressed genes may not hold .",
    "in contrast , our approach makes one single search in a space of @xmath4-values , and without assuming any fraction of non - differentially expressed genes .",
    "as long as there are a sufficient number of non - differentially expressed genes , of the order of several hundreds , normalization is possible , including cases with global mrna changes or transcriptional amplification @xcite . in general , it is a matter of comparison between the magnitude of the error in the estimation of normalization factors and the amount of biological variation .",
    "the estimation error decreases with the number of no - variation genes detected ( fig .",
    "[ fig:02 ] ) , and whenever normalization error is well below biological variation , normalization between samples will be correct and beneficial for downstream analyses .",
    "our approach to normalization is based in four key ideas : first , decomposing the normalization by experimental conditions and normalizing separately each condition before normalizing the condition means ; second , using the novel standard - vector normalization ( or alternatively median scaling ) to perform each normalization ; third , identifying no - variation genes from the distribution of @xmath4-values resulting from a statistical test of variation between conditions ; and fourth , employing only no - variation genes for the final between - condition normalization .",
    "these four ideas are grounded on rigorous mathematical statistics ( see methods and supplementary information ) .",
    "it is also worth noting that both median and standard - vector normalization , as methods for each normalization step , are distribution - free methods ; they do not assume gaussianity or any other kind of probability distribution for the expression levels of genes .",
    "mediancd and svcd normalization are freely available in the r package _ cdnormbio _ , installable from github ( see code availability ) .",
    "previous assumptions that gene variation is rather limited could suggest that there is no need for more comprehensive normalization methods such as our proposal . in line with this , it could be argued that the amount of variation in our real ( _ e .",
    "crypticus _ ) dataset is exceptional and much larger than the variation likely to be occur in most experiments .",
    "we think that this an invalid belief .",
    "most of the available evidence concerning widespread variation in gene expression is inadequate , because it involves circular reasoning .",
    "we have shown here that current normalization methods , used by almost all studies to date , assume no variation in gene expression between experimental conditions , and they remove it if it exists , unless it is balanced .",
    "therefore , these methods _ can not _ be used to discern the extent and balance of global variation in gene expression .",
    "only methods that are able to normalize correctly , whatever these extent and balance are , can be trusted for this task .",
    "the fact that our methods perform well with large and unbalanced differential gene expression does not imply that they perform poorly when differential gene expression is more moderate or balanced .",
    "our results show that this is not case . in the design of our methods",
    ", no compromise was made to achieve good performance with high variation in exchange for not so good performance with low variation .",
    "the downside of our approach lies elsewhere , in a greater algorithmic complexity and a greater demand of computing resources .",
    "yet , we consider this a minor demand , given the capabilities of today s computers and the resources required by current high - throughput assays .",
    "our results have being obtained from microarray data , but similar effects are expected to be found in rna - seq assays .",
    "current normalization procedures for rna - seq , such as rpkm @xcite , tmm @xcite , or deseq @xcite , perform between - sample normalization based on some form of global scaling and under the assumption that most genes are not differentially expressed .",
    "this makes rpkm , tmm , and deseq normalization , in what concerns between - sample normalization and the removal or distortion of variation discussed here , similar to conventional median normalization .",
    "an example of this issue , including results from microarray and rna - seq assays , has been reported in a study of the transcriptional amplification mediated by the oncogene c - myc @xcite .",
    "importantly , mediancd and svcd normalization were designed with no dependencies on any particular aspect of the technology used to globally measure gene expression , i.e.  microarrays or rna - seq .",
    "the numbers in the input data are interpreted as steady state concentrations of mrna molecules , in order to identify the normalization factors , and irrespectively of whether the concentrations were obtained from fluorescence intensities of hybridized cdna ( microarrays ) or from counts of fragments of cdna ( rna - seq ) .",
    "both technologies require between - sample normalization , because in some step of the assay the total mrna or cdna mass in each sample must be equalized within a given range required by the experimental platform , this equalization of total mass , together with other sources of variation in the total efficiency of the assay , amounts to a factor multiplying the concentration of each mrna species .",
    "this factor is different for each sample , and it is what between - sample normalization aims to detect and correct for .",
    "moreover , the total mrna mass in each sample is , in many cases , mostly determined by a few highly expressed genes , rather than an unbiased average over the total mrna population .",
    "this makes between - sample normalization critical regarding comparisons of gene expression between different experimental conditions , as our results illustrate .",
    "it is also important to highlight that this between - sample uncertainty in the measurement of mrna concentrations is different from other issues , such as for example non - linearities .",
    "these other problems are usually more specific to each technology , and they are the scope of within - sample normalization ( e.g.  background correction for microarrays and gene - length normalization for rna - seq ) , which are obviously also necessary and should be applied _ before _ between - sample normalization .",
    "similarly , methods that address the influence of biological or technical confounding factors on downstream analyses , such as sva @xcite or peer @xcite , should be applied when necessary , _ after _ normalizing .",
    "finally , the significance of widespread variation in gene expression merits consideration from the viewpoint of molecular and cell biology . established understanding about the regulation of gene expression considers it as a set of processes that generally switch on or off the expression of genes , performed mostly at transcription initiation , by the combinatorial regulation of a large number of transcription factors , and with an emphasis on gene expression programs associated with cell differentiation and development .",
    "recent studies , however , have expanded this understanding , offering a more complex perspective on the regulation of gene expression , by identifying other rate - limiting regulation points between transcription initiation and protein translation , such as transcription elongation and termination , as well as mrna processing , transport and degradation .",
    "promoter - proximal pausing of rna polymerase ii ( in eukaryotes ) @xcite and transcript elongation @xcite , in particular , have received a great deal of attention recently , in connection with gene products involved in signal transduction pathways .",
    "these mechanisms , which seem to be highly conserved among metazoans , would allow cells to tune the expression of activated genes in response to signals concerning , for example , homeostasis , environmental stress or immune response .",
    "as an illustration , studies about the transcription amplification mediated by the oncogene c - myc have uncovered that it regulates the promoter - proximal pausing of rna polymerase ii , affecting a large number of genes already activated by other regulatory mechanisms @xcite .",
    "our results for the toxicity experiment with _",
    "e. crypticus _ are consistent with regulatory capabilities for broad fine - tuning of gene expression levels , far beyond what conventional methods of normalization would allow to detect .",
    "this contrast underlines that normalization methods that truly preserve variation between experimental conditions are necessary for high - throughput assays exploring genome - wide regulation of gene expression , as required by current research in molecular and cell biology .    in summary",
    ", this study proves that large numbers of genes can change in expression level across experimental conditions , and too extensively to ignore in the normalization of gene expression data .",
    "current normalization methods for gene expression microarrays and rna - seq , because of a lack - of - variation assumption , likely remove and distort variation in gene expression .",
    "the normalization methods proposed here solve this problem , offering a means to investigate broad changes in gene expression that have remained hidden to date .",
    "we expect this to provide revealing insights about diverse biomolecular processes , particularly those involving substantial numbers of genes , and to assist efforts to realize the full potential of gene expression profiling .",
    "the test species was _",
    "enchytraeus crypticus_. individuals were cultured in petri dishes containing agar medium , in controlled conditions @xcite .    for copper ( @xmath18 ) exposure , a natural soil collected at hygum , jutland ,",
    "denmark was used @xcite . for silver ( @xmath19 ) and nickel ( @xmath20 ) exposure , the natural standard soil lufa 2.2 ( lufa speyer , germany )",
    "was used @xcite . the exposure to ultra - violet ( uv )",
    "radiation was done in iso reconstituted water @xcite .",
    "the tested @xmath18 forms @xcite included copper nitrate ( @xmath21 , sigma aldrich ) , @xmath18 nanoparticles ( @xmath18-nps , 2030 nm , american elements ) and @xmath18 nanowires ( @xmath18-nwires , as synthesized @xcite ) .    the tested ag forms @xcite included silver nitratre ( @xmath22 , sigma aldrich ) , non - coated @xmath19 nanoparticles ( @xmath19-nps non - coated , 2030 nm , american elements ) , polyvinylpyrrolidone ( pvp)-coated @xmath19 nanoparticles ( @xmath19-nps pvp - coated , 2030 nm , american elements ) , and @xmath19 nm300k nanoparticles ( @xmath19 nm300k , 15 nm , jrc repository ) .",
    "the @xmath19 nm300k was dispersed in 4% polyoxyethylene glycerol triolaete and polyoxyethylene ( 20 ) orbitan mono - laurat ( tween 20 ) , thus the dispersant was tested alone as control ( ctdisp ) .",
    "the tested @xmath20 forms included nickel nitrate ( @xmath23 , fluka ) and ni nanoparticles ( @xmath20-nps , 20 nm , american elements ) .",
    "spiking for the @xmath18 and @xmath19 materials was done as previously described @xcite . for the @xmath20 materials ,",
    "the @xmath20-nps were added to the soil as powder , following the same procedure as for the @xmath18 materials .",
    "@xmath24 , being soluble , was added to the pre - moistened soil as aqueous dispersions .",
    "the concentrations tested were selected based on the reproduction effect concentrations @xmath25 and @xmath26 , for _",
    "e.  crypticus _ , within 95% of confidence intervals , being : @xmath27 @xmath28 = 290/360 mg@xmath18/kg , @xmath18-nps @xmath28 = 980/1760 mg@xmath18/kg , @xmath18-nwires @xmath28 = 850/1610 mg@xmath18/kg , @xmath18-field @xmath28 = 500/1400 mg@xmath18/kg , @xmath29 @xmath28 = 45/60 mg@xmath19/kg , @xmath19-np pvp - coated @xmath28 = 380/550 mg@xmath19/kg , @xmath19-np non - coated @xmath28 = 380/430 mg@xmath19/kg , @xmath19 nm300k @xmath28 = 60/170 mg@xmath19/kg , ctdisp = 4% w / w tween 20 , @xmath24 @xmath28 = 40/60 mg@xmath20/kg , @xmath20-nps @xmath30 = 980/1760 mg@xmath20/kg .",
    "four biological replicates were performed per test condition , including controls . for @xmath18 exposure , the control condition for all the treatments consisted of soil from a control area at hygum site , which has a @xmath18 background concentration of 15 mg / kg @xcite . for @xmath19 exposure ,",
    "two control sets were performed : ct ( un - spiked lufa soil , to be the control condition for @xmath29 , @xmath19-nps pvp - coated and @xmath19-nps non - coated treatments ) and ctdisp ( lufa soil spiked with the dispersant tween 20 , to be the control condition for the @xmath19 nm300k treatments ) . for @xmath20 exposure , the control consisted of un - spiked lufa soil .      in soil ( i.e.  for @xmath18 , @xmath19 and @xmath20 ) exposure followed the standard ert @xcite with adaptations as follows :",
    "twenty adults with well - developed clitellum were introduced in each test vessel , containing 20 g of moist soil ( control or spiked ) .",
    "the organisms were exposed for three and seven days under controlled conditions of photoperiod ( 16:8 h light : dark ) and temperature @xmath31 without food .",
    "after the exposure period , the organisms were carefully removed from the soil , rinsed in deionized water and frozen in liquid nitrogen .",
    "the samples were stored at @xmath32 , until analysis .    for uv exposure , the test conditions @xcite were adapted for _",
    "e.  crypticus _ @xcite .",
    "the exposure was performed in 24-well plates , where each well corresponded to a replicate and contained 1 ml of iso water and five adult organisms with clitellum .",
    "the test duration was five days , at @xmath31 .",
    "the organisms were exposed to uv on a daily basis , during 15 minutes per day to two uv intensities ( 280400 nm ) of @xmath33 and @xmath34 @xmath35 , corresponding to total uv doses of 7511.6 and 8118.35 @xmath36 , respectively . the remaining time was spent under standard laboratory illumination ( 16:8 h photoperiod ) . uv radiation was provided by an uv lamp ( spectroline xx15f / b , spectronics corporation , ny , usa , peak emission at 312 nm ) and a cellulose acetate sheet was coupled to the lamp to cut - off uvc - range wavelengths @xcite .",
    "thirty two replicates per test condition ( including control without uv radiation ) were performed to obtain 4 biological replicates for rna extraction , each one with 40 organisms . after the exposure period",
    ", the organisms were carefully removed from the water and frozen in liquid nitrogen .",
    "the samples were stored at @xmath32 , until analysis .",
    "rna was extracted from each replicate , which contained a pool of 20 and 40 organisms , for soil and water exposure , respectively .",
    "three biological replicates per test treatment ( including controls ) were used .",
    "total rna was extracted using sv total rna isolation system ( promega ) .",
    "the quantity and purity were measured spectrophotometrically with a nanodrop ( nanodrop nd-1000 spectrophotometer ) and its quality checked by denaturing formaldehyde agarose gel electrophoresis .",
    "500 ng of total rna were amplified and labeled with agilent low input quick amp labeling kit ( agilent technologies , palo alto , ca , usa ) .",
    "positive controls were added with the agilent one - color rna spike - in kit .",
    "purification of the amplified and labeled crna was performed with rneasy columns ( qiagen , valencia , ca , usa ) .",
    "the crna samples were hybridized on custom gene expression agilent microarrays ( 4 x 44k format ) , with a single - color design @xcite .",
    "hybridizations were performed using the agilent gene expression hybridization kit and each biological replicate was individually hybridized on one array .",
    "the arrays were hybridized at @xmath37 with a rotation of 10 rpm , during 17 h. afterwards , microarrays were washed using agilent gene expression wash buffer kit and scanned with the agilent dna microarray scanner g2505b .",
    "fluorescence intensity data was obtained with agilent feature extraction software v.  10.7.3.1 , using recommended protocol ge1_107_sep09 .",
    "quality control was done by inspecting the reports on the agilent spike - in control probes .",
    "analyses were performed with r @xcite v.  3.3.1 , using r packages plotrix @xcite v.  3.6.3 and rcolorbrewer @xcite v.  1.1.2 , and with bioconductor @xcite v.  3.3 packages affy @xcite v.  1.50.0 , drosgenome1.db v  .3.2.3 , drosophila2.db v.  3.2.3 , genefilter v.  1.54.2 , and limma @xcite v.  3.28.20 .",
    "background correction was carried out by agilent feature extraction software for the real ( _ e .",
    "crypticus _ ) dataset , while the affymetrix mas5 algorithm , as implemented in the limma package , was used for the golden and platinum spike datasets .    to ensure an optimal comparison between the different normalization methods ,",
    "only gene probes with good signal quality ( flag isposandsignif = true ) in all samples were employed for the analysis of the _ e.  crypticus _ dataset .",
    "this implied the selection of 18,339 gene probes from a total of 43,750 .",
    "for the golden and platinum spike datasets , data were considered as missing when probe sets were not called present by the mas5 algorithm .",
    "the synthetic dataset without differential gene expression was generated gene by gene as normal variates with mean and variance equal , respectively , to the sample mean and sample variance of the expression levels for each gene , as detected from the real _",
    "e.  crypticus _ dataset after svcd normalization .",
    "the synthetic dataset with differential gene expression was generated equally , except for the introduction of differences in expression averages between treatments and controls .",
    "the magnitude of the difference in averages was equal , for each differentially expressed gene ( deg ) , to twice the sample variance .",
    "the percentage of degs for each treatment was chosen randomly , in logarithmic scale , from a range between 0.9% and 90% , while ensuring that 10% of genes were not differentially expressed across the entire dataset .",
    "one third of the treatments were mostly over - expressed ( for each treatment independently , the probability of a deg being over - expressed was @xmath38 ) , one third of the treatments were mostly under - expressed ( @xmath39 ) , and the remaining third had mostly balanced differential gene expression ( @xmath40 ) .",
    "for both synthetic datasets , the applied normalization factors were those detected by svcd normalization from the real _",
    "e.  crypticus _ dataset .",
    "median normalization was performed , for each sample , by subtracting the median of the distribution of expression levels , and then adding the overall median to preserve the global expression level .",
    "quantile normalization was performed as implemented in the limma package .",
    "the two condition - decomposition normalizations , mediancd and svcd , proceeded in the same way : first , independent within - condition normalization for each experimental condition , using all genes . then , one between - condition normalization , iteratively identifying no - variation genes and normalizing until convergence of the set of no - variation genes . and finally , another between - condition normalization using only the no - variation genes detected , to calculate the between - condition normalization factors .",
    "the criterion for convergence of mediancd normalization was to require that the relative changes in the standard deviation of the normalization factors were less than 0.1% , or less than 10% for 10 steps in a row .",
    "in the case of svcd normalization , convergence required that numerical errors were , compared to estimated statistical errors ( see below ) , less than 1% , or less than 10% for 10 steps in a row .",
    "convergence of the set of no - variation genes was achieved by intersection of the sets found during 10 additional steps under convergence conditions .",
    "these default convergence parameters were used for all the mediancd and svcd normalizations reported , with the exception of mediancd with the golden spike dataset , which used 30% ( instead of 10% ) of relative change for 10 steps in a row , to reach convergence .    in svcd normalization",
    ", the distribution of standard vectors was trimmed in each step to remove the 1% more extreme values of variance .",
    "differentially expressed genes were identified with limma analysis or t - tests , controlling the false discovery rate to be below 5% , independently for each comparison of treatment versus control .",
    "the reference distributions with permutation symmetry shown in the polar plots of supplementary movies  s1s3 were calculated through the six possible permutations of the empirical standard vectors .",
    "the watson @xmath41 statistic was calculated with the two - sample test @xcite , comparing with an equal number of samples obtained by sampling with replacement the permuted standard vectors .      in a gene expression dataset with @xmath42 genes ,",
    "@xmath43 experimental conditions and @xmath6 samples per condition , the _ observed _ expression levels of gene @xmath44 in condition @xmath45 , @xmath46 , can be expressed in @xmath0-scale as @xmath47 where @xmath48 is the vector of _ true _ gene expression levels and @xmath49 is the vector of normalization factors .",
    "given a sample vector @xmath50 , the mean vector is @xmath51 , and the residual vector is @xmath52 .",
    "then , can be linearly decomposed into @xmath53 equations   define the within - condition normalizations for each condition @xmath45 .",
    "the scalar values in are used to obtain the equations on condition means , @xmath54 the between - condition normalization is defined by .",
    "equations   reduce to a single number , which is irrelevant to the normalization .",
    "the complete solution for each condition is obtained with @xmath55 .    for full details about this condition - decomposition approach ,",
    "see supplementary mathematical methods in the supplementary information .",
    "the @xmath6 samples of gene @xmath44 in a given condition can be modeled with the random vectors @xmath56 .",
    "again , @xmath57 , where @xmath58 is a fixed vector of normalization factors . it can be proved under fairly general assumptions ( see supplementary information ) , that the true standard vectors have zero expected value @xmath59 whereas the observed standard vectors verify , as long as @xmath60 , @xmath61    this motivates the following iterative procedure to solve and ( _ standard - vector normalization _ ) : @xmath62    at convergence , @xmath63 , which implies @xmath64 and @xmath65 .",
    "convergence is faster the more symmetric the empirical distribution of @xmath66 is on the unit @xmath67-sphere .",
    "convergence is optimal with spherically symmetric distributions , such as the gaussian distribution , because in that case @xmath68    assuming no dependencies between genes , an approximation of the statistical error at step @xmath16 can be obtained with @xmath69 this statistical error was compared with the numerical error to assess convergence .",
    "see supplementary mathematical methods in the supplementary information for full details about this algorithm .",
    "see also supplementary movies s1s3 for normalization examples .",
    "no - variation genes were identified with one - sided kolmogorov - smirnov tests , as goodness - of - fit tests against the uniform distribution , carried out on a distribution of @xmath4-values .",
    "these @xmath4-values were obtained from anova tests on the expression levels of genes , grouped by experimental condition .",
    "the ks test was rejected at @xmath70 .",
    "see supplementary mathematical methods in the supplementary information for more details about this approach to identify no - variation genes .",
    "see also supplementary movies s4s6 for examples of use .    87    urlstyle [ 1]doi : # 1    k.  adelman and j.  t. lis .",
    "promoter - proximal pausing of rna polymerase ii : emerging roles in metazoans .",
    "_ , 130 ( 10):0 72031 , 2012 .",
    "s.  anders and w.  huber .",
    "differential expression analysis for sequence count data . _",
    "genome biol .",
    "_ , 110 ( 10):0 r106 , 2010",
    ".    k.  v. ballman , d.  e. grill , a.  l. oberg , and t.  m. therneau .",
    "faster cyclic loess : normalizing rna arrays via linear models . _ bioinformatics _ , 200 ( 16):0 27782786 , 2004 .",
    "b.  m. bolstad , r.  a. irizarry , m.  astrand , and t.  p. speed . a comparison of normalization methods for high density oligonucleotide array data based on variance and bias .",
    "_ bioinformatics _ , 19:0 185193 , 2003 .",
    "p.  c. boutros .",
    "the path to routine use of genomic biomarkers in the cancer clinic . _",
    "genome res .",
    "_ , 250 ( 10):0 150813 , 2015 .    k.  h. brettingham - moore , c.  p. duong , a.  g. heriot , r.  j.  s. thomas , and w.  a. phillips . using gene expression profiling to predict response and prognosis in gastrointestinal cancers - the promise and the perils .",
    "_ ann of surg oncol _ , 18:0 14841491 , 2011 .",
    "j.  h. bullard , e.  purdom , k.  d. hansen , and s.  dudoit .",
    "evaluation of statistical methods for normalization and differential expression in mrna - seq experiments . _ bmc bioinformatics _ , 11:0 94 , 2010 .",
    "s.  calza , d.  valentini , and y.  pawitan .",
    "normalization of oligonucleotide arrays based on the least - variant set of genes . _ bmc bioinformatics _ , 9:0 140 , 2008 .",
    "m.  p. castro - ferreira , t.  e. de  boer , j.  k. colbourne , r.  vooijs , c.  a.  m. van gestel , n.  m. van straalen , a.  m. v.  m. soares , m.  j.  b. amorim , and d.  roelofs .",
    "transcriptome assembly and microarray construction for enchytraeus crypticus , a model oligochaete to assess stress response mechanisms derived from soil conditions .",
    "_ bmc genomics _ , 15:0 302 , 2014 .",
    "y.  chang , m.  l. lye , and h.  c. zeng .",
    "large - scale synthesis of high - quality ultralong copper nanowires .",
    "_ langmuir _ , 21:0 37463748 , 2005 .",
    "l.  cheng , l .- y .",
    "lo , n.  l.  s. tang , d.  wang , and k .- s .",
    ": a novel normalization strategy for microarray data in cancers . _ sci . rep .",
    "_ , 6:0 18898 , 2016 .",
    "chi , h.  y. chang , g.  haraldsen , f.  l. jahnsen , o.  g. troyanskaya , d.  s. chang , z.  wang , s.  g. rockson , m.  van  de rijn , d.  botstein , and et  al .",
    "endothelial cell diversity revealed by global expression profiling .",
    "_ proc natl acad sci usa _",
    ", 100:0 1062310628 , 2003 .",
    "s.  e. choe , m.  boutros , a.  m. michelson , g.  m. church , and m.  s. halfon .",
    "preferred analysis methods for affymetrix genechips revealed by a wholly defined control dataset .",
    "_ genome biol . _ , 60 ( 2):0 r16 , 2005 .",
    "chua , p.  vijayakumar , p.  m. nissom , c .- y .",
    "yam , v.  v.  t. wong , and h.  yang . a novel normalization method for effective removal of systematic variation in microarray data . _ nucleic acids res .",
    "_ , 340 ( 5):0 e38 , 2006 .    a.  conesa , p.  madrigal , s.  tarazona , d.  gomez - cabrero , a.  cervera , a.  mcpherson , m.  w. szczeniak , d.  j. gaffney , l.  l.  l. elo , x.  zhang , and a.  mortazavi . a survey of best practices for rna - seq data analysis . _ genome biol .",
    "_ , 17:0 13 , 2016 .",
    "l.  j. core , j.  j. waterfall , and j.  t. lis .",
    "nascent rna sequencing reveals widespread pausing and divergent initiation at human promoters . _",
    "science _ ,",
    "3220 ( 5909):0 18458 , 2008 .",
    "j.  couzin . genomics .",
    "microarray data reproduced , but some concerns remain . _ science _",
    ", 313:0 1559 , 2006 .",
    "a.  r. dabney and j.  d. storey .",
    "a reanalysis of a published affymetrix genechip control dataset . _ genome biol .",
    "_ , 70 ( 3):0 401 , 2006 .",
    "m .- a . dillies , a.  rau , j.  aubert , c.  hennequet - antier , m.  jeanmougin , n.  servant , c.  keime , g.  marot , d.  castel , j.  estelle , and et  al . a comprehensive evaluation of normalization methods for illumina high - throughput rna sequencing data analysis . _ brief bioinform _ , 14:0 671683 , 2013 .",
    "s.  draghici , p.  khatri , a.  c. eklund , and z.  szallasi .",
    "reliability and reproducibility issues in dna microarray measurements .",
    "_ trends genet _ , 22:0 101109 , 2006 .",
    "d.  j. duggan , m.  bittner , y.  chen , p.  meltzer , and j.  m. trent .",
    "expression profiling using cdna microarrays .",
    "_ nat genet _",
    ", 21:0 1014 , 1999 .",
    "j.  durbin .",
    "_ distribution theory for tests based on the sample distribution function_. society for industrial and applied mathematics , philadelphia , 1973 .",
    "m.  l. eaton .",
    "_ multivariate statistics : a vector space approach_. institute of mathematical statistics , beachwood , ohio , 2007 .",
    "k.  fang , s.  kotz , and k.  w. ng .",
    "_ symmetric multivariate and related distributions_. chapman and hall , new york , 1990 .",
    "w.  feller .",
    "_ an introduction to probability theory and its applications _ , volume  2 .",
    "wiley , new york , 2 edition , 1971 .",
    "a.  a. fodor , t.  l. tickle , and c.  richardson .",
    "towards the uniform distribution of null _",
    "_ values on affymetrix microarrays .",
    "_ genome biol .",
    "_ , 80 ( 5):0 r69 , 2007",
    ".    s.  frantz .",
    "an array of problems .",
    "_ nat rev drug discov _ , 4:0 362363 , 2005 .    j.  a. gagnon - bartsch and t.  p. speed .",
    "using control genes to correct for unwanted variation in microarray data . _ biostatistics _ , 13:0 53952 , 2012 .",
    "d.  p. gaile and j.  c. miecznikowski .",
    "putative null distributions corresponding to tests of differential expression in the golden spike dataset are intensity dependent . _",
    "bmc genomics _ , 8:0 105 , 2007 .",
    "m.  garber , m.  g. grabherr , m.  guttman , and c.  trapnell .",
    "computational methods for transcriptome annotation and quantification using rna - seq .",
    "_ nat methods _ , 8:0 469477 , 2011 .",
    "l.  gautier , l.  cope , b.  m. bolstad , and r.  a. irizarry .",
    "analysis of affymetrix genechip data at the probe level .",
    "_ bioinformatics _ , 200 ( 3):0 307315 , 2004",
    ".    t.  r. golub , d.  k. slonim , p.  tamayo , c.  huard , m.  gaasenbeek , j.  p. mesirov , h.  coller , m.  l. loh , j.  r. downing , m.  a. caligiuri , and et  al .",
    "molecular classification of cancer : class discovery and class prediction by gene expression monitoring . _ science _ , 286:0 531537 , 1999 .    s.  i.  l. gomes , g.  caputo , n.  pinna , j.  j. scott - fordsmand , and m.  j.  b. amorim .",
    "effect of 10 different @xmath71 and @xmath72 ( nano)materials on the soil invertebrate _",
    "enchytraeus crypticus_. _ environ toxicol chem _ , 34:0 24092416 , 2015a .    s.  i.  l. gomes , j.  j. scott - fordsmand , and m.  j.  b. amorim . cellular energy allocation to assess the impact of nanomaterials on soil invertebrates ( enchytraeids ) : the effect of cu and ag .",
    "_ int j environ res public health _ , 12:0 68586878 , 2015b .",
    "a.  k. gupta , t.  varga , and t.  bodnar .",
    "_ elliptically contoured models in statistics and portfolio theory_. springer , new york , 2013 .",
    "m.  a. hannah , a.  g. heyer , and d.  k. hincha . a global survey of gene regulation during cold acclimation in arabidopsis thaliana .",
    "_ plos genet .",
    "_ , 10 ( 2):0 e26 , 2005",
    ".    m.  a. hannah , h.  redestig , a.  leisse , and l.  willmitzer .",
    "global mrna changes in microarray experiments .",
    "_ , 260 ( 7):0 741742 , 2008 .    s.  c. hicks and r.  a. irizarry . : a data - driven approach to guide the choice of an appropriate normalization method . _ genome biol _ , 16:0 117 , 2015 .",
    "w.  huber , v.  j. carey , r.  gentleman , s.  anders , m.  carlson , b.  s. carvalho , h.  c. bravo , s.  davis , l.  gatto , t.  girke , and et  al . orchestrating high - throughput genomic analysis with bioconductor .",
    "_ nat methods _ , 12:0 115121 , 2015 .",
    "r.  a. irizarry , b.  hobbs , f.  collin , y.  d. beazer - barclay , k.  j. antonellis , u.  scherf , and t.  p. speed .",
    "exploration , normalization , and summaries of high density oligonucleotide array probe level data .",
    "_ biostatistics _ , 4:0 249264 , 2003 .",
    "r.  a. irizarry , l.  m. cope , and z.  wu .",
    "feature - level exploration of a published affymetrix genechip control dataset .",
    "_ genome biol .",
    "_ , 70 ( 8):0 404 , 2006 .",
    "n.  b. ivanova , j.  t. dimos , c.  schaniel , j.  a. hackney , k.  a. moore , and i.  r. lemischka . a stem cell molecular signature .",
    "_ science _ , 298:0 601604 , 2002 .",
    "i.  jonkers and j.  t. lis . getting up to speed with transcription elongation by rna polymerase ii .",
    "cell biol .",
    "_ , 160 ( 3):0 167177 , 2015 .",
    "o.  kallenberg .",
    "_ probabilistic symmetries and invariance principles_. springer , new york , 2005 .",
    "j.  t. leek and j.  d. storey . capturing heterogeneity in gene expression studies by surrogate variable analysis .",
    "_ plos genet _ , 3:0 172435 , 2007 .",
    "j.  t. leek , r.  b. scharpf , h.  c. bravo , d.  simcha , b.  langmead , w.  e. johnson , d.  geman , k.  baggerly , and r.  a. irizarry . tackling the widespread and critical impact of batch effects in high - throughput data .",
    "_ nat rev genet _",
    ", 11:0 733739 , 2010 .",
    "j.  lemon .",
    "plotrix : a package in the red light district of r. _ r - news _ , 60 ( 4):0 812 , 2006 .",
    "s.  li , p.  p. labaj , p.  zumbo , p.  sykacek , w.  shi , l.  shi , j.  phan , p .- y .",
    "wu , m.  wang , c.  wang , d.  thierry - mieg , j.  thierry - mieg , d.  p. kreil , and c.  e. mason .",
    "detecting and correcting systematic variation in large - scale rna sequencing data .",
    "_ nat biotechnol _ , 32:0 888895 , 2014 .    c.  y. lin , j.  lovn , p.",
    "b. rahl , r.  m. paranal , c.  b. burge , j.  e. bradner , t.  i. lee , and r.  a. young .",
    "transcriptional amplification in tumor cells with elevated c - myc .",
    "_ cell _ , 15112150 ( 1):0 5667 , 2012 .",
    "y.  lin , k.  golovnina , z .- x .",
    "chen , h.  n. lee , y.  l.  s. negron , h.  sultana , b.  oliver , and s.  t. harbison .",
    "comparison of normalization and differential expression analyses using rna - seq data from 726 individual _",
    "drosophila melanogaster_. _ bmc genomics _ , 17:0 28 , 2016 .",
    "k.  a. lippa , d.  l. duewer , m.  l. salit , l.  game , and h.  c. causton . exploring the use of internal and external controls for assessing microarray technical performance .",
    "_ bmc res notes _ , 3:0 349 , 2010 .",
    "j.  listgarten , c.  kadie , e.  e. schadt , and d.  heckerman .",
    "correction for hidden confounders in the genetic analysis of gene expression . _ proc natl acad sci usa _ , 107:0 1646570 , 2010 .",
    "t.  d. littlewood , p.  kreuzaler , and g.  i. evan .",
    "all things to all people .",
    "_ cell _ , 1510 ( 1):0 113 , 2012 .",
    "d.  j. lockhart , h.  dong , m.  c. byrne , m.  t. follettie , m.  v. gallo , m.  s. chee , m.  mittmann , c.  wang , m.  kobayashi , h.  horton , and et  al .",
    "expression monitoring by hybridization to high - density oligonucleotide arrays .",
    "_ nat biotechnol _ , 14:0 16751680 , 1996 .",
    "j.  lovn , d.  a.  a. orlando , a.  a.  a. sigova , c.  y.  y. lin , p.  b.  b. rahl , c.  b.  b. burge , d.  l.  l. levens , t.  i.  i. lee , and r.  a.  a. young .",
    "revisiting global gene expression analysis .",
    "_ cell _ , 151:0 476482 , 2012 .",
    "s.  michiels , s.  koscielny , and c.  hill .",
    "prediction of cancer outcome with microarrays : a multiple random validation strategy .",
    "_ lancet _ , 365:0 488492 , 2005 .",
    "a.  mortazavi , b.  a. williams , k.  mccue , l.  schaeffer , and b.  wold .",
    "mapping and quantifying mammalian transcriptomes by rna - seq .",
    "_ nat methods _ , 5:0 621628 , 2008 .",
    "e.  neuwirth .",
    "_ rcolorbrewer : colorbrewer palettes _ , 2014 .",
    "url https://cran.r-project.org/package=rcolorbrewer .",
    "r package version 1.1 - 2 .    t.  t. ni , w.  j. lemon , y.  shyr , and t.  p. zhong .",
    "use of normalization methods for analysis of microarrays containing a high degree of gene effects . _",
    "bmc bioinformatics _ , 9:0 505 , 2008 .",
    "z.  nie , g.  hu , g.  wei , k.  cui , a.  yamane , w.  resch , r.  wang , d.  r. green , l.  tessarollo , r.  casellas , k.  zhao , and d.  levens . is a universal amplifier of expressed genes in lymphocytes and embryonic stem cells .",
    "_ cell _ , 1510 ( 1):0 6879 , 2012 .    .",
    "_ guidelines for the testing of chemicals no 202 .",
    "daphnia sp . acute immobilization test_. organization for economic cooperation and development , paris , 2004a .    .",
    "_ guidelines for the testing of chemicals no . 220 .",
    "enchytraeid reproduction test_. organization for economic cooperation and development , paris , 2004b .",
    "r.  d. pearson . a comprehensive re - analysis of the golden spike data : towards a benchmark for differential expression methods .",
    "_ bmc bioinformatics _ , 9:0 164 , 2008 .",
    "_ r : a language and environment for statistical computing_. r foundation for statistical computing , vienna , austria , 2016 .",
    "url https://www.r - project.org/.    s.  e. reese , k.  j. archer , t.  m. therneau , e.  j. atkinson , c.  m. vachon , m.  de  andrade , j .-",
    "a. kocher , and j.  e. eckel - passow . a new statistic for identifying batch effects in high - throughput genomic data that uses guided principal component analysis .",
    "_ bioinformatics _ , 29:0 287783 , 2013 .",
    "d.  risso , j.  ngai , t.  p. speed , and s.  dudoit .",
    "normalization of rna - seq data using factor analysis of control genes or samples .",
    "_ nat biotechnol _ , 32:0 896902 , 2014 .",
    "m.  e. ritchie , b.  phipson , d.  wu , y.  hu , c.  w. law , w.  shi , and g.  k. smyth .",
    "_ limma _ powers differential expression analyses for rna - sequencing and microarray studies . _ nucleic acids res _ , 43:0 e47 , 2015 .",
    "m.  d. robinson and a.  oshlack . a scaling normalization method for differential expression analysis of rna - seq data .",
    "_ genome biol _ , 11:0 r25 , 2010 .",
    "m.  schena , d.  shalon , r.  w. davis , and p.  o. brown .",
    "quantitative monitoring of gene expression patterns with a complementary dna microarray .",
    "_ science _ , 270:0 467470 , 1995 .",
    "e.  f. schuster , e.  blanc , l.  partridge , and j.  m. thornton . estimation and correction of non - specific binding in a large - scale spike - in experiment",
    ". _ genome biol .",
    "_ , 80 ( 6):0 r126 , 2007 .",
    "j.  j. scott - fordsmand , p.  h. krogh , and j.  m. weeks .",
    "responses of _ folsomia fimetaria _",
    "( collembola : isotomidae ) to copper under different soil copper contamination histories in relation to risk assessment .",
    "_ environ toxicol chem _ , 19:0 12971303 , 2000 .",
    "l.  shi , l.  h. reid , w.  d. jones , r.  shippy , j.  a. warrington , s.  c. baker , p.  j. collins , f.  de  longueville , e.  s. kawasaki , k.  y. lee , and et  al .",
    "the microarray quality control ( maqc ) project shows inter- and intraplatform reproducibility of gene expression measurements .",
    "_ nat biotechnol _ , 24:0 11511161 , 2006 .",
    "r.  shippy , s.  fulmer - smentek , r.  v. jensen , w.  d. jones , p.  k. wolber , c.  d. johnson , p.  s. pine , c.  boysen , x.  guo , e.  chudin , and et  al .",
    "using rna sample titrations to assess microarray platform performance and normalization techniques .",
    "_ nat biotechnol _ , 24:0 11231131 , 2006 .",
    "g.  k. smyth and t.  speed .",
    "normalization of cdna microarray data .",
    "_ methods _ , 31:0 265273 , 2003 .",
    "o.  stegle , l.  parts , r.  durbin , and j.  winn .",
    "a bayesian framework to account for complex non - genetic factors in gene expression levels greatly increases power in eqtl studies .",
    "_ plos comput biol _ , 6:0 e1000770 , 2010 .",
    "j.  d. storey .",
    "the positive false discovery rate : a bayesian interpretation and the q - value .",
    "_ ann stat _ , 31:0 20132035 , 2003 .",
    "j.  d. storey and r.  tibshirani .",
    "statistical significance for genomewide studies .",
    "_ proc natl acad sci usa _ , 100:0 94409445 , 2003 .",
    "z.  su , p.  p. labaj , s.  li , j.  thierry - mieg , d.  thierry - mieg , w.  shi , c.  wang , g.  p. schroth , r.  a. setterquist , j.  f. thompson , and et  al . a comprehensive assessment of rna - seq accuracy , reproducibility and information content by the sequencing quality control consortium . _ nat biotechnol _ , 32:0 903914 , 2014 .",
    "p.  k. tan , t.  j. downey , e.  l. spitznagel , p.  xu , d.  fu , d.  s. dimitrov , r.  a. lempicki , b.  m. raaka , and m.  c. cam .",
    "evaluation of gene expression measurements from commercial microarray platforms . _ nucleic acids res _ , 31:0 56765684 , 2003 .",
    "a.  l. tarca , r.  romero , and s.  draghici .",
    "analysis of microarray experiments of gene expression profiling .",
    "j. obstet .",
    "gynecol . _ , 1950 ( 2):0 373388 , 2006 .    j.  van  de peppel , p.  kemmeren , h.  van bakel , m.  radonjic , d.  van leenen , and f.  c.  p. holstege .",
    "monitoring global messenger rna changes in externally controlled microarray experiments .",
    "_ embo rep .",
    "_ , 40 ( 4):0 387393 , 2003 .",
    "l.  j. van t veer , h.  dai , m.  j. van  de vijver , y.  d. he , a.  a.  m. hart , m.  mao , h.  l. peterse , k.  van  der kooy , m.  j. marton , a.  t. witteveen , and et  al .",
    "gene expression profiling predicts clinical outcome of breast cancer .",
    "_ nature _ , 415:0 530536 , 2002 .",
    "z.  wang , m.  gerstein , and m.  snyder .",
    "rna - seq : a revolutionary tool for transcriptomics .",
    "_ nat rev genet _",
    ", 10:0 5763 , 2009 .",
    "b.  weigelt and j.  s. reis - filho .",
    "molecular profiling currently offers no more than tumour morphology and basic immunohistochemistry . _ breast cancer res _ , 12 suppl .",
    "4:0 s5 , 2010 .",
    "z.  wu and m.  j. aryee .",
    "subset quantile normalization using negative control features .",
    "_ j comput biol _ , 17:0 13851395 , 2010 .",
    "y.  h. yang , s.  dudoit , p.  luu , d.  m. lin , v.  peng , j.  ngai , and t.  p. speed .",
    "normalization for cdna microarray data : a robust composite method addressing single and multiple slide systematic variation . _",
    "nucleic acids res .",
    "_ , 300 ( 4):0 e15 , 2002 .    q.  zhu , j.  c. miecznikowski , and m.  s. halfon .",
    "preferred analysis methods for affymetrix genechips .",
    "ii . an expanded , balanced , wholly - defined spike - in dataset . _ bmc bioinformatics _ , 11:0 285 , 2010 .",
    "this work was supported by the european union fp7 projects modern ( ref .  309314 - 2 , to c.p.r . ,",
    "j.j.s .- f . ) , marina ( ref .  263215 , to j.j.s .- f .",
    ") , and sun ( ref .  604305 , to c.p.r . ,",
    ", m.j.b.a . ,",
    "j.j.s .- f . ) , by feder funding through compete ( programa operacional factores de competitividade ) and portugal funding through fct ( fundao para a cincia e tecnologia ) within the project bio - chip ( refs .",
    "fcomp-01 - 0124-feder-041177 , fct expl / aag - maa/0180/2013 , to s.i.l.g . , m.j.b.a . ) , and by a post - doctoral grant ( ref .",
    "sfrh / bpd/95775/2013 , to s.i.l.g . )",
    "s.i.l.g . , m.j.b.a .  and j.j.s .- f .",
    "designed the toxicity experiment . s.i.l.g",
    ".  carried out the experimental work and collected the microarray data .",
    "designed and implemented the novel normalization methods . c.p.r .  performed the statistical analyses .",
    "all the authors jointly discussed the results .",
    "c.p.r .  drafted the paper , with input from all the authors .",
    "all the authors edited the final version of the paper .",
    "miame - compliant microarray data were submitted to the gene expression omnibus ( geo ) repository at the ncbi website ( platform : gpl20310 ; series : gse69746 , gse69792 , gse69793 and gse69794 ) .",
    "the novel normalization methods were implemented as r functions .",
    "this code , together with r scripts that generate the synthetic datasets and reproduce all reported results starting from the raw microarray data , are available at the github repository ` https://github.com/carlosproca/gene-expr-norm-paper ` and in the supplementary data file ` gene-expr-norm.zip ` .",
    "additionally , mediancd and svcd normalization are available via the r package _ cdnormbio _ , installable from the github repository ` https://github.com/carlosproca/cdnormbio ` .",
    "the authors declare that they have no competing financial interests .",
    "figure 1        figure 2        figure 3        figure 4        figure 5        figure 6        figure 7        figure 8        figure 9",
    "supplementary figure s1        supplementary figure s2        supplementary figure s3        supplementary figure s4        supplementary figure s5        supplementary figure s6",
    "* supplementary movie  s1 .",
    "* example of one within - condition standard - vector normalization , for the real ( _ e .",
    "crypticus _ ) dataset .",
    "the movie shows the 14 steps of the convergence of standard - vector normalization performed for the condition ag.nm300k.ec20.3d ( exposure to ag nm300k nanoparticles , with an @xmath73 dose for three days ) . left",
    "panels show a subset of 10,000 randomly - chosen sample standard vectors , with one gray line per gene , in the plane of residual vectors , i.e.  the plane perpendicular to the vector of coordinates @xmath74 .",
    "the lines labeled s1s3 indicate the projection of the axes onto this plane , the number 13 being the sample number .",
    "the red line is the estimated vector of normalization factors at each step , with length @xmath75 , which results from the bias of the standard vectors towards that direction .",
    "right panels show the polar distribution of vector angles ( black solid curve ) , compared to the distribution of vector angles after all six possible permutations of the sample labels ( blue dashed curve ) .",
    "the watson @xmath41 statistic provides a measure of the difference between both distributions . in the initial step",
    ", there is a large bias towards the first and second sample , compared to the third one .",
    "the bias is reduced in each step by subtracting the normalization factor estimate , which makes the distribution of standard vectors more permutationally symmetric and with a correspondingly smaller @xmath41 .",
    "after convergence in 14 steps , there is no detectable bias left .",
    "* supplementary movie  s2 .",
    "* example of one within - condition standard - vector normalization , for the synthetic dataset without differential gene expression .",
    "the movie displays the standard - vector normalization performed for the condition ag.nm300k.ec20.3d , on the synthetic dataset generated with the standard normal @xmath76 as base distribution .",
    "format and labels are the same as in supplementary movie  s1 .",
    "note the uniform distribution of angles after normalizing , which corresponds to a parametric family of probability distributions with spherical symmetry .",
    "the corresponding movie for the synthetic dataset with differential gene expression is virtually identical , given that standard vectors are independent of sample averages .",
    "* supplementary movie  s3 .",
    "* example of one within - condition standard - vector normalization , for synthetic log - normal data .",
    "the movie shows the standard - vector normalization performed for the condition ag.nm300k.ec20.3d , on a synthetic dataset generated in the same way as that of supplementary movie  s2 , except for using as base distribution the log - normal @xmath77 , which has large positive skewness ( @xmath78 ) .",
    "format and labels are the same as in supplementary movies  s1 , s2 .",
    "note that the distribution of standard vector angles after normalizing is not uniform , but it has permutation symmetry .    *",
    "supplementary movie  s4 .",
    "* identification of no - variation genes ( non - differentially expressed genes ) for the real ( _ e .",
    "crypticus _ ) dataset .",
    "the movie shows the 27 steps of the corresponding between - condition normalization , with svcd normalization .",
    "both panels show the empirical distribution function of @xmath4-values obtained from anova tests on expression levels , per gene and grouped by experimental condition .",
    "the left panel shows the complete interval @xmath79 $ ] , while the right panel depicts the interval close to 1 where the first goodness - of - fit ( gof ) test was not rejected .",
    "the black portion of the distribution corresponds to @xmath4-values at which the gof test was rejected , the big black circle indicates the first @xmath4-value at which the gof test was not rejected , and the red portion shows the range of @xmath4-values whose genes , as a result , were identified as no - variation genes .",
    "the dashed blue line and the dotted blue line indicate , respectively , the theoretical distribution function of the uniform distribution and the threshold of the one - sided kolmogorov - smirnov test ( @xmath80 , @xmath6  equal to the number of @xmath4-values for the first gof test that was not rejected ) .",
    "convergence criteria was met from steps 18 to 27 .",
    "these last ten steps ensured stability of the detected set of no - variation genes , by cumulative intersection of the successive sets identified , each one with @xmath81 no - variation genes , as shown .",
    "the resulting final set had 974 no - variation genes .",
    "* supplementary movie  s5 .",
    "* identification of no - variation genes for the synthetic dataset with differential gene expression .",
    "the movie shows the 15 steps of the corresponding between - condition normalization , with svcd normalization .",
    "format and labels are the same as in supplementary movie  s4 .",
    "note the similarity with the behavior observed for the real dataset ( supplementary movie  s4 ) .",
    "* supplementary movie  s6 .",
    "* identification of no - variation genes for the synthetic dataset without differential gene expression .",
    "the movie shows the 14 steps of the corresponding between - condition normalization , with svcd normalization .",
    "format and labels are the same as in supplementary movies  s4 , s5 .",
    "note that the distribution of @xmath4-values at convergence ( steps 514 ) is uniform in the whole interval @xmath79 $ ] , up to the level detected by the goodness - of - fit test .",
    "this corresponds to a dataset with no differentially expressed genes .",
    "let @xmath82 be the samples of @xmath6 independent and identically distributed random variables @xmath83 .",
    "let us represent the samples @xmath82 with the @xmath84 column vector @xmath85 , and let us denote the sample mean by @xmath86 .",
    "an essential property of the mean and residual vectors is that they belong to subspaces that are orthogonal complements @xcite .",
    "hence , for any sample vector @xmath92 , the mean vector @xmath94 belongs to the subspace of dimension 1 spanned by the unit vector @xmath102 , while the residual vector @xmath95 belongs to the @xmath103-dimensional hyperplane orthogonal to @xmath104 .",
    "the lengths of the mean vector and residual vector are equal , up to a scaling factor , to the sample mean and sample standard deviation , respectively .",
    "for a set of samples @xmath82 , where @xmath105 , let us denote the sample mean as before by @xmath86 , and the sample variance as @xmath106 .",
    "then , the lengths of the mean and residual vectors obtained from the sample vector @xmath99 are @xmath107    finally , let us define the standard vector of the sample vector @xmath99 ( @xmath105 ) , as @xmath108 whenever @xmath109 , or otherwise as @xmath110 .",
    "@xmath111 is the all - zeros column vector of dimension @xmath6 .    for a given number of samples @xmath6 , all the non - zero standard vectors belong to the ( @xmath112)-sphere of radius @xmath113 , embedded in the @xmath103-dimensional hyperplane perpendicular to @xmath104 . besides",
    ", all the components of a standard vector are equal to the corresponding standardized samples , @xmath114          let us denote the _ observed _ expression level of gene @xmath44 in the sample @xmath119 of condition @xmath45 by @xmath120 .",
    "we assume that the observed level @xmath120 is equal , in the usual @xmath0-scale , to the addition of the normalization factor @xmath121 to the _ true _ gene expression level @xmath122 , @xmath123    solving the _ normalization problem _ amounts to finding the normalization factors @xmath121 from the observed values @xmath120 .",
    "the normalization factors can be understood as sample - wide changes in the concentration of mrna molecules by multiplicative factors equal to @xmath124 .",
    "these changes are caused by technical reasons in the assay and are independent of the biological variation in the true levels @xmath122 .",
    "let us represent the true and observed expression levels , @xmath122 and @xmath120 , of gene @xmath44 in the samples @xmath125 of condition @xmath45 , by the @xmath117-dimensional vectors @xmath126 let us also represent the unknown normalization factors of condition @xmath45 by the @xmath117-dimensional vector @xmath127      the residual - vector equations correspond to the @xmath43 within - condition normalizations .",
    "each within - condition normalization uses the equations particular to a condition @xmath45 , for the subset of genes @xmath130 that have expression level available and of enough quality in that experimental condition .",
    "let us define the vectors of conditions means as @xmath136 and let us express the condition - mean equations in vectorial form as @xmath137 applying again the mean and variance operators , we obtain @xmath138    the residual - vector equations on condition means correspond to the single between - condition normalization , in a similar way as do for the each of the within - condition normalizations .",
    "there is one equation per gene .",
    "the only equations used in the between - condition normalization are those of the subset of genes @xmath139 that show no evidence of variation across experimental conditions , according to a statistical test .    given that @xmath140 , has the only unknown @xmath141 .",
    "the meaning of @xmath141 is a conversion factor between the scale the true and observed expression levels .",
    "this factor depends on the technology used to measure the expression levels and finding it is out of the scope of the normalization problem .",
    "therefore , without loss of generality , we assume @xmath142 , so @xmath143    the solution of the between - condition normalization , @xmath144 , allows to find the mean vectors of the normalization factors @xmath145 , via , and .",
    "the within - condition normalizations yield the residual vectors @xmath146 .",
    "the complete solution to the normalization problem is finally obtained , for each condition @xmath45 , with @xmath147    thus , the original normalization problem has been divided in @xmath148 normalization sub - problems on residual vectors , stated by and .",
    "in fact , this linear decomposition is possible for any partition of the set of @xmath1 samples .",
    "the choice of the partition as the one defined by the experimental conditions is motivated by the need to control the biological variation among the genes used in each normalization .",
    "all the @xmath148 normalizations face the same kind of _ normalization of residuals problem _ , which we define in general as follows .    * normalization of residuals",
    "problem*. let @xmath149 be the @xmath119-th observed value of feature @xmath44 , in a dataset with @xmath105 observations for each of the @xmath150 features . the observed values @xmath149 are equal to the true values @xmath151 plus the normalization factors @xmath152 , which are constant across features . in vectorial form , there are @xmath150 equations @xmath153 where the vectors belong to @xmath84 . as a consequence @xmath154    solving the _ normalization of residuals problem _ amounts to finding the residual vector of normalization factors @xmath155 from the observed residual vectors @xmath156 . in the within - condition normalizations ,",
    "the features are gene expression levels , with one observation per sample of the corresponding experimental condition . in the between - condition normalization ,",
    "the features are means of gene expression levels , with one observation per condition .",
    "there is , however , an additional requirement imposed by the methods with which we propose to solve the between - condition normalization . we would like to consider the condition means @xmath157 in as sample data across conditions .",
    "this only holds when all the conditions have the same number of samples .",
    "otherwise , we balance the condition means so that they result from the same number of samples in all conditions , according to the procedure described in the following .",
    "let @xmath158 be the minimum number of samples across conditions , @xmath159 .",
    "let @xmath160 be independent random samples ( without replacement ) of size @xmath158 from the set of indexes @xmath161 , with one sample per gene @xmath44 and condition @xmath45 .",
    "then , the balanced condition means are defined as @xmath162   \\overline{y}_j^{(k ) * }       & \\;=\\ ; \\frac{\\displaystyle \\sum_{i \\in \\mathcal{s}_j^{(k ) } }       y_{ij}^{(k ) } } { s^ * } , \\\\[1ex ]   \\overline{a}_j^{(k ) * }       & \\;=\\ ; \\frac{\\displaystyle \\sum_{i \\in \\mathcal{s}_j^{(k ) } }       a_i^{(k ) } } { s^ * } .\\end{aligned}\\ ] ]    from , the balanced condition means verify a relationship similar to , @xmath163 moreover , the average of @xmath164 across the sampling subsets @xmath160 is equal to the unknown @xmath165 .",
    "this implies that are , on average , equivalent to .",
    "hence , we use the following vectors of balanced conditions means @xmath166 instead of , , in order to build the condition - mean equations .",
    "this balancing of the condition means is only required when the experimental conditions have different number of samples .",
    "we have assumed that the @xmath6 true values @xmath167 of feature @xmath44 are samples of independent and identically distributed random variables @xmath168 .",
    "these random variables can be represented with the random vector @xmath169 , carried by the probability space @xmath170 and with induced space @xmath171 .",
    "let us define the random vectors @xmath172 and @xmath173 with the vectorial operators mean and residual , respectively , @xmath174    @xmath175 holds for any random vector @xmath176 , as well as the other properties presented above .",
    "let us assume that @xmath177 and that @xmath178 , which imply that @xmath179 has length 1 almost surely .",
    "the standard random vector @xmath180 is a pivotal quantity , where the location ( mean ) and scale ( standard deviation ) of feature @xmath44 have been removed .",
    "the probability distribution of @xmath181 across the remaining degrees of freedom over the unit @xmath67-sphere is governed by the parametric family of the random variables @xmath182 .",
    "moreover , the independence and identity of distribution across the @xmath6 observations implies that the distribution of @xmath183 is _ exchangeable _ , i.e.  invariant with respect to permutations of the observation labels . as a result , @xmath181 is also permutation invariant , which geometrically corresponds to symmetries with respect to the @xmath184 permutations of the axes in the @xmath6-dimensional space of random vectors , projected onto the @xmath103-dimensional hyperplane of residual vectors .",
    "residual vectors and standard vectors have been widely studied , especially in relation to elliptically symmetric distributions and linear models @xcite , and to the invariances of probability distributions @xcite . here",
    ", we consider these vectors from the viewpoint of the problem of normalizing multivariate data , and its relationship with permutation invariance .    it is well know that , for a multivariate distribution with independent and identically distributed components , the expected value of the standard vector is zero @xcite , given that it is so for each component .",
    "we prove this here for completeness , and to show that it is also a necessary consequence of the permutation invariance of the distribution .",
    "_ proposition_. the expected value of any true ( i.e.  without normalization issues ) standard vector is zero . if the @xmath105 samples of feature @xmath44 are independent and identically distributed , then @xmath185      the only vectors that are invariant with respect to all possible permutations are those that have all components identical . therefore , @xmath192 , with @xmath193 .",
    "however , @xmath194 , so that @xmath195 .",
    "hence @xmath196 .",
    "@xmath197    for each true random vector @xmath176 , there is an observed random vector @xmath198 , where @xmath199 is the random vector of normalization factors .",
    "the random vectors @xmath176 and @xmath199 are independent , representing biological and technical variation , respectively . therefore , and without loss of generality , we assume in what follows a fixed vector of normalization factors @xmath58 , i.e.  we condition on the event @xmath200 .",
    "we also assume that @xmath201 , which implies that @xmath202 has length 1 almost surely .      _",
    "proposition_. if the @xmath105 samples of feature @xmath44 are independent and identically distributed , whenever @xmath205 , @xmath206 when @xmath115 , there is the additional requirement that @xmath207 .",
    "this threshold of detection only occurs for the degenerate case of @xmath115 .",
    "otherwise , when @xmath213 and the vectors @xmath173 and @xmath155 are not collinear , they lie on a plane . the vector @xmath214 is the diagonal of the parallelogram defined by @xmath173 and @xmath155 .",
    "hence the angle between @xmath215 and @xmath155 is strictly less than the angle between @xmath173 and @xmath155 , so the cosine of the angle is strictly greater .",
    "thus , @xmath216          as a consequence , the _ normalization of residuals problem _ may be restated as the problem of finding the normalization factors @xmath155 from the observed vectors @xmath156 , such that the standard vectors @xmath220 are invariant against permutations of the observation labels . or equivalently , such that the standard vectors @xmath220 have zero mean .",
    "the following property provides an approach to the solution .",
    "these inequalities are identities when @xmath229 is of opposite sign to @xmath230 , or when @xmath231 . because of the permutation symmetries of @xmath179",
    ", it follows that @xmath232 , which implies @xmath233 and hence @xmath234          the gaussian multivariate distribution , among others , has spherical symmetry besides permutation symmetry . for parametric families with",
    "spherical symmetry , the true standard vector @xmath203 has uniform distribution over the @xmath67-sphere . as a result , the components of @xmath242 perpendicular to @xmath155 are antisymmetric with respect to the direction of @xmath155 , so that they cancel out in expectation .",
    "that is , for parametric families with spherical symmetry , and as long as @xmath205 , @xmath243      the properties , suggest the use of @xmath244 to approximate the unknown residual vector of normalization factors @xmath155 . the following iterative method implements this approach to solve the _ normalization of residuals problem_.      we assume that @xmath249 , for all @xmath246 and all @xmath250 .",
    "nonetheless , an implementation of this algorithm benefits from trimming out a small fraction ( e.g.  1% ) of the features with lesser @xmath251 in , in order to avoid numerical singularities .",
    "therefore , the recursive sequence  faces a new , weaker _ normalization of residuals problem _ at each step @xmath16 , with true residual vectors @xmath252 , observed residual vectors @xmath245 and unknown normalization factors @xmath256 .",
    "the step @xmath16 results in the estimation of normalization factors @xmath247 , which are removed from @xmath245 , generating the next step . at the beginning ,",
    "@xmath259 and @xmath260 .    at convergence , @xmath63 .",
    "equations  , , imply that , in such a case , @xmath261 and @xmath65 .",
    "convergence is optimal when the parametric family of the @xmath150 features has spherical symmetry , gaussian being the most prominent case .",
    "otherwise , the more uniform the distribution of standard vectors @xmath262 is on the @xmath67-sphere , the faster the sequence  converges .",
    "see examples of convergence in supplementary movies  s1s3 .",
    "let us consider a gene expression dataset , with @xmath42 genes and @xmath43 experimental conditions .",
    "each condition @xmath45 has @xmath117 samples .",
    "the total number of samples is @xmath118 .",
    "let us assume that @xmath263 and that @xmath264 , for all conditions @xmath265 .",
    "let us also assume that , among the @xmath42 genes , there is a fraction @xmath266 of non - differentially expressed genes ( non - degs ) , with @xmath267 , while the remaining fraction @xmath268 comprises the differentially expressed genes ( degs ) @xcite .",
    "let us consider the usual anova test comparing average expression levels across conditions , gene - by - gene . under the null hypothesis of a non - deg ,",
    "the corresponding @xmath269-statistic follows the @xmath269-distribution with @xmath270 and @xmath271 degrees of freedom .",
    "the test of this hypothesis yields a @xmath4-value @xmath272 for each gene @xmath273 .",
    "the obtained @xmath4-values @xmath272 follow a probability distribution that can be considered as the mixture of two probability distributions , @xmath274 and @xmath275 , for the non - degs and the degs , respectively @xcite .",
    "the fraction @xmath266 of non - degs follows the uniform distribution on the interval @xmath79 $ ] , @xmath276 while the fraction @xmath268 of degs follows a distribution that verifies , for any @xmath277 , @xmath278 and the mixture distribution is @xmath279    let us further assume that there exists a @xmath280 , with @xmath281 , such that @xmath282 for every @xmath283 . in other words ,",
    "all degs have @xmath4-value @xmath272 from the anova test such that @xmath284 , while only some genes among the non - degs have p - value with @xmath285 .",
    "this implies that the mixture distribution of @xmath4-values is uniform on the interval @xmath286 $ ] , @xmath287    on the other hand , for any set of @xmath6 samples @xmath288 obtained from @xmath6 independent and identically distributed uniform random variables on the interval @xmath289 $ ] , all the distances between consecutive ordered samples ( including boundaries ) , @xmath290 , obey the same distribution @xcite . then , it can be realized that , for any @xmath44 such that @xmath291 , the two subsets of samples @xmath292 and @xmath293 follow uniform distributions on the intervals @xmath294 $ ] and @xmath295 $ ] , respectively .    based on these facts , to identify no - variation genes we propose finding the minimum @xmath296 , from the ordered sequence of @xmath4-values @xmath297 , such that a goodness - of - fit test for the uniform distribution on the interval @xmath298 $ ] , performed on @xmath299 , is not rejected . as a result ,",
    "the genes corresponding to the @xmath4-values @xmath300 are considered as no - variation genes ."
  ],
  "abstract_text": [
    "<S> rna - seq and gene expression microarrays provide comprehensive profiles of gene activity , but lack of reproducibility has hindered their application . </S>",
    "<S> a key challenge in the data analysis is the normalization of gene expression levels , which is currently performed following the implicit assumption that most genes are not differentially expressed . here </S>",
    "<S> , we present a mathematical approach to normalization that makes no assumption of this sort . </S>",
    "<S> we have found that variation in gene expression is much larger than currently believed , and that it can be measured with available assays . </S>",
    "<S> our results also explain , at least partially , the reproducibility problems encountered in transcriptomics studies . </S>",
    "<S> we expect that this improvement in detection will help efforts to realize the full potential of gene expression profiling , especially in analyses of cellular processes involving complex modulations of gene expression .    </S>",
    "<S> * keywords * + differential gene expression + gene expression microarrays + rna - seq + normalization of high - throughput data    * abbreviations * + deg : differentially expressed gene + fdr : false discovery rate + mediancd normalization : median condition - decomposition normalization + svcd normalization : standard - vector condition - decomposition normalization </S>"
  ]
}