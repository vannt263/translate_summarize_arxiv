{
  "article_text": [
    "in the alvarez - macovski@xcite method , the line integrals of the x - ray basis set coefficients are computed from measurements with multiple spectra .",
    "the introduction of photon counting detectors into medical x - ray imaging@xcite gives the possibility of providing the spectral data by pulse height analysis ( pha ) .",
    "these detectors , however , have multiple defects@xcite that affect the information they provide . in some cases , the defects have been found to produce sharply increased noise in the estimates of the line integrals at specific object attenuations@xcite .",
    "the increased noise may indicate potential non - invertibility of the transformation between the spectral measurements and the line integrals .",
    "therefore , it is important to develop mathematical descriptions of the invertibility of the transformation .",
    "this paper is a step towards this mathematical description .",
    "it presents a proof that measurements with two spectra and a photon counting detector with pileup are invertible .",
    "an example of this would be measurements with two x - ray tube voltages .",
    "note that the results of this paper are not applicable to two bin pulse height analysis with pileup case since the effective spectra for that case depend on the object thickness .",
    "for biological materials we can approximate the x - ray attenuation coefficient @xmath0 accurately with a two function basis set@xcite @xmath1    in this equation , @xmath2 are the basis set coefficients and @xmath3 are the basis functions , @xmath4 . as implied by the notation , the coefficients @xmath2",
    "are functions only of the position @xmath5 within the object and the functions @xmath3 depend only on the x - ray energy @xmath6 .",
    "if there is a high atomic number contrast agent , we need to extend the basis set to higher dimensions .",
    "neglecting scatter , the expected value of the number of transmitted photons @xmath7 with an effective measurement spectrum @xmath8 is @xmath9    where the line integral in the exponent is on a line from the x - ray source to the detector .    using the decomposition , eq .",
    "[ eq:2-func - decomp ] , the line integral in eq .",
    "[ eq : ik - integral ] is @xmath10    where @xmath11 are the line integrals of the basis set coefficients .",
    "the @xmath12 are summarized as the components of the a - vector , @xmath13 , and the measurements by a vector , @xmath14 , whose components are the photon counts with each effective spectrum . since the body transmission is exponential in @xmath13 , we can approximately linearize the measurements by taking logarithms .",
    "the results is the log measurement vector @xmath15 , where @xmath16 is the expected value of the measurements with no object in the beam and the division means that corresponding members of the vectors are divided .",
    "equations [ eq : ik - integral ] define a relationship between @xmath13 and the expected value of the measurement vector , @xmath17 . the invertibility of this transformation is the subject of this paper .",
    "in a previous paper@xcite , i showed that without pileup the transformation @xmath17 with two spectra and a two function basis set is invertible under quite general conditions .",
    "since i will use parts of the derivation with the pileup case , i will repeat it here .      before discussing the situation in general ,",
    "two simple but important cases will be discussed .",
    "the first case is two monoenergetic spectra with energies @xmath18 and @xmath19 . in this case",
    "the expected value of the measurement in eq .",
    "[ eq : ik - integral ] can be linearized by taking the logarithm .",
    "the transformation can be written @xmath20 where @xmath21 is a matrix with coefficients @xmath22\\ ] ]    the transformation is invertible if the determinant of @xmath21 is not equal to zero : @xmath23    that is if @xmath24    figure [ fig : ratio - of - optimal funcs ] shows a plot of the ratio of the basis set functions versus energy in the medical diagnostic region .",
    "note that the ratio is monotonically increasing .",
    "thus , the condition in equation ( [ eq : f ratios ] ) will be true if the two energies are different .",
    "is satisfied.[fig : ratio - of - optimal funcs ] ]    another useful special case is when the object is known to consist of a single material with basis set coefficient vector @xmath25 . in this case , a single photon count measurement suffices to determine the material thickness . with a single material of thickness @xmath26",
    ", the @xmath13 vector is @xmath27    and the expected number of photons is a function of only @xmath26 @xmath28de.\\ ] ]    the derivative of @xmath29 with respect to @xmath26 is always negative @xmath30de<0 .",
    "\\end{array}\\label{eq : lambda - prime}\\ ] ]    because the integrand is always greater than zero . since @xmath31 is monotonically decreasing , it can be inverted to compute @xmath26 .",
    "for the general case , the following theorem is useful ( fulks 1978@xcite page 284 ) :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ let f be a continuously differentiable mapping defined on an open region d in e2 , with range r in e2 , and lets its jacobian be never zero in d. suppose further that c is a simple closed curve that , together with its interior ( recall the jordan curve theorem ) , lies in d , and that f is one - to - one on c. then the image t of c is a simple closed curve that , together with its interior , lies in r. furthermore , f is one - to - one on the closed region consisting of c and its interior , so that the inverse transformation can be defined on the closed region consisting of t and its interior . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    which i paraphrase as    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if the jacobian of a continuously differentiable two dimensional mapping is nonzero throughout an open region d and if the mapping is one to one on a simple closed curve c which lies in d , then the mapping is one to one on c and its interior . _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    by using this theorem the following result can be established :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if two spectra with different maximum energies and such that suitably defined average energies of the spectra transmitted through an object are not equal over a region of the @xmath13 plane containing the points for the object , then the two measurements @xmath32 can be used to uniquely calculate the values of @xmath13 . _",
    "_ _ _ _ _ _ _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    in order to establish this result , the jacobian must be shown to be nonzero throughout a region in the @xmath33 plane and the transformation must be shown to be invertible on a closed simple curve in this region .    the first quadrant will be used as the region .",
    "the closed curve consists of segments along the axes and a circle joining the ends of the segments , as shown in figure [ fig : closed - contour-4invertproof ] .",
    "this is a region of theoretical and practical importance because a basis set consisting of the attenuation coefficients of the calibration materials is usually used , since only positive equivalent thicknesses of the calibration materials can be used , this region must contain all the measured values . .    ]    since @xmath32 is the logarithm of the measurements , the components of its jacobian are @xmath34de}{\\int s_{i}(e)exp[-a_{1}f_{1}(e)-a_{2}f_{2}(e)]de}\\quad i , j=1,2 \\end{array}\\label{eq : jij}\\ ] ]    note that by defining two normalized spectra @xmath35}{\\int s_{i}(e)exp[-a_{1}f_{1}(e)-a_{2}f_{2}(e)]de}\\quad i=1,2\\ ] ]    the jacobian matrix can be written as @xmath36\\ ] ]    where @xmath37 denotes the average using the normalized spectrum @xmath38 .",
    "thus the condition for the determinant of the jacobian not being zero is equivalent to @xmath39    this condition must be tested for individual spectra .    in order to complete the proof of invertibility",
    ", the transformation must be shown to be invertible on a closed curve in the domain .",
    "the simple cases discussed at the beginning of this section may be used for this proof .",
    "the parts of the curve along the axes are special cases of the single material case .",
    "each axis corresponds to different thicknesses of one of the basis materials if the attenuation coefficient of the calibration material is used as a basis function .",
    "if other basis functions are used , the coordinates can be transformed to the attenuation coefficients of real materials and the proof applies in the transformed coordinates .",
    "the circle of large radius is an approximation of the single energy case . for large radius",
    ", there will be high attenuation . with beam hardening",
    ", the transmitted spectrum with large attenuation therefore approaches the two monoenergetic spectra case where the energies are the maximum energies in the spectra .",
    "if the maximum energies are different , we can approach the known invertible monoenergetic case arbitrarily closely by making the radius larger and larger .",
    "in a previous paper@xcite , i used the central limit theorem of renewal processes@xcite to show that , for recording times much greater than the mean inter - event time , the expected value of recorded counts with pileup approaches @xmath40    in this equation , @xmath29 is the expected number of photons incident on the detector during the measurement time and @xmath41 is the expected number of photons arriving during the dead time @xmath42 .",
    "if @xmath43 is the average rate of photon arrivals then @xmath44 . if @xmath45 is the measurement time then @xmath46 .",
    "defining @xmath47 , @xmath48 and the expected recorded counts are @xmath49",
    "in this section i give a proof that we can invert data consisting of measurements with two x - ray spectra with a photon counting detector with pileup .",
    "an example would be making two sequential measurements of an object using an x - ray with switching the voltage .",
    "note that this does not prove that any two spectrum measurement with pileup is invertible .",
    "for example with two bin photon counting with pha , pileup causes the recorded spectrum to change so the assumptions of this section would not be met .",
    "the proof is analogous to the proof for the measurements with no pileup described in the previous sec .",
    "[ sec : invertibility-2dim-2spect - no - pileup ] .",
    "i will show the transformation is invertible on the path in the first quadrant shown in fig .",
    "[ fig : closed - contour-4invertproof ] .",
    "the previous proof for invertibility on the circular segment is also applicable with pileup since , for large thicknesses , the count rate is very low so the pileup parameter @xmath41 is essentially equal to zero and the pileup counts are the same as those without pileup .    the remaining part of the proof is to show that the data are invertible on the paths from the origin along the coordinates axes .",
    "the equation for the expected value of the recorded number of photons with pileup is @xmath50 differentiating this equation along the axes @xmath51    where a prime denotes a derivative with respect to object thickness .",
    "factoring the equation @xmath52    since the denominator is always positive and , from eq .",
    "[ eq : lambda - prime ] , @xmath53 is always less than zero , the derivative of the recorded counts with respect to object thickness is never equal to zero so the transformation of the recorded counts with pileup is invertible along the coordinate axes .",
    "this completes the proof if we can show that the jacobian of the transformation is never zero inside the contour .",
    "this depends on the spectra but for commonly used spectra such as from x - ray tubes with different voltages , experience has shown that the transformation is invertible in the first quadrant .",
    "the data acquisition model used is unrealistic  most systems with photon counting detectors would also use pha .",
    "nevertheless , it provides an example of invertibility with pileup .    as discussed in my previous paper@xcite , due to the exponential probability distribution of x - ray photon inter - arrival times ,",
    "pulse pileup is a fundamental effect",
    ". it will always be present in photon counting systems no matter how small the response time .",
    "pileup has accurate analytical models and its analysis may lead to an understanding of invertibility with the other detector defects such as charge trapping and sharing , polarization , and incomplete photon energy deposition due to compton scattering and k radiation escape@xcite .",
    "a proof is given of the invertibility of two dimension basis set line integrals from two spectrum , photon counting data with pileup .",
    "r.  e. alvarez and a.  macovski , `` energy - selective reconstructions in x - ray computerized tomography , '' _ phys .",
    "* 21 * , 73344 , ( 1976 ) .",
    "[ online ] .",
    "available : http://dx.doi.org/10.1088/0031-9155/21/5/002      m.  overdick , c.  baumer , k.  j. engel , j.  fink , c.  herrmann , h.  kruger , m.  simon , r.  steadman , and g.  zeitler , `` towards direct conversion detectors for medical imaging with x - rays , '' _ ieee trans .",
    "sci . _ * nss08 * , 15271535 , ( 2008 ) .",
    "[ online ] .",
    "available : http://dx.doi.org/10.1109/nssmic.2008.4775117        r.  e. alvarez , `` energy dependent information in x - ray imaging ",
    "part 1 the vector space description , '' _ stanford university information systems laboratory - unpublished _ ,  * * ( 1982 ) .",
    "[ online ] .",
    "available : http://dx.doi.org/10.13140/rg.2.2.19355.46887        k.  taguchi , m.  zhang , e.  c. frey , x.  wang , j.  s. iwanczyk , e.  nygard , n.  e. hartsough , b.  m.  w. tsui , and w.  c. barber , `` modeling the performance of a photon counting x - ray detector for ct : energy response and pulse pileup effects , '' _ med .",
    "phys . _ * 38 * , 10891102 , ( 2011 ) .",
    "[ online ] .",
    "available : http://dx.doi.org/10.1118/1.3539602      r.  e. alvarez , `` signal to noise ratio of energy selective x - ray photon counting systems with pileup , '' _ med .",
    "_ * 41 * , no .  11 , 111909 , ( 2014 ) .",
    "[ online ] .",
    "available : http://dx.doi.org/10.1118/1.4898102"
  ],
  "abstract_text": [
    "<S> in the alvarez - macovski@xcite method , the line integrals of the x - ray basis set coefficients are computed from measurements with multiple spectra . </S>",
    "<S> an important question is whether the data are invertible . </S>",
    "<S> this paper presents a proof that measurements with two spectra and a photon counting detector with pileup are invertible .    </S>",
    "<S> key words : photon counting , dead time , pileup , spectral x - ray , dual energy , energy selective    = 1 </S>"
  ]
}