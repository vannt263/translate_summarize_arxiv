{
  "article_text": [
    "the aim of this article is to study the asymptotic properties of an important class of pattern - avoiding permutations : the separable permutations .",
    "our main result is the description of the asymptotics in @xmath0 of the number of occurrences of any fixed given pattern in a uniform separable permutation of @xmath0 elements .",
    "we first give some definitions . for any @xmath0",
    ", the set of permutations of @xmath1:= \\{1,2,\\ldots , n\\}$ ] is denoted by @xmath2 .",
    "we write permutations of @xmath2 in one - line notation as @xmath3 . for a permutation @xmath4 in @xmath2 , the _ size _ @xmath0 of @xmath4",
    "is denoted by @xmath5 .",
    "for @xmath6 , and @xmath7 $ ] of cardinality @xmath8 , let @xmath9 be the permutation of @xmath10 induced by @xmath11 .",
    "for example for @xmath12 and @xmath13 we have @xmath14 since the values in the subsequence @xmath15 are in the same relative order as in the permutation @xmath16 .",
    "a permutation @xmath17 is a _ pattern _ involved in @xmath4 , and the subsequence @xmath18 is an _ occurrence _ of @xmath19 in @xmath4 .    all along this paper , we use letter @xmath4 for a ( large ) permutation of size @xmath0 , and letter @xmath19 for a pattern of size @xmath20 .",
    "we denote by @xmath21 the proportion of occurrences of a pattern @xmath19 in @xmath4 .",
    "more formally @xmath22 \\text { of cardinality } k \\text { such that } \\operatorname{pat}_i(\\sigma)=\\pi\\}.\\ ] ] equivalently @xmath21 is the probability to have @xmath23 if @xmath24 is randomly and uniformly chosen among the @xmath25 subsets of @xmath1 $ ] with @xmath8 elements . if @xmath26 , we set conveniently @xmath27 .",
    "we say that @xmath4 _ avoids _",
    "@xmath28 if there is no occurrence of @xmath28 in @xmath4 , _ i.e. _ , @xmath29 .",
    "for any ( finite or infinite ) set of patterns @xmath30 , we denote by @xmath31 the set of permutations of size @xmath0 that avoid all the @xmath32 s . then , @xmath33 is called a _ class _ of ( pattern - avoiding ) permutations .",
    "equivalently , a class of permutations is a set @xmath34 of permutations such that , for any @xmath35 and any pattern @xmath19 of @xmath4 , it holds that @xmath36 .",
    "classes of permutations have been intensively studied for their combinatorial and algorithmic properties over the last 50 years .",
    "an account of the past and current research on these classes can be found in  @xcite .",
    "finding the enumeration of specific classes , defined by the avoidance of a small number of small patterns , has been one of the first problems studied in this field .",
    "it started with the proof that @xmath37 is counted by the catalan numbers , for any @xmath38 , and the research on this topic still continues , as witnessed by the summary  @xcite .",
    "the combinatorics of classes of permutations has however expanded in several other directions , including a general approach to the study of classes of permutations based on various notions of structure , like the _ substitution decomposition _ ( ( * ? ? ?",
    "* proposition 2 ) or ( * ? ? ?",
    "* section 3.2 ) ) to which we shall return later in this introduction .",
    "the probabilistic study of classes of permutations is much more recent and , just like their combinatorial study at its beginning , it focuses on the study of specific classes with small excluded patterns .",
    "more precisely , the probabilistic counterpart of the study of specific classes is centered on the following interesting question : given a fixed pattern @xmath28 , what can we say about a typical @xmath4 in @xmath39 ( for large @xmath0 ) ? recently , many authors have considered this problem for different choices of small patterns @xmath28 .",
    "we mention a few of them .    *",
    "the question was initiated in a paper of madras and liu @xcite in relation with a monte - carlo algorithm to approximate growth rates of permutation classes . in subsequent papers , atapour and madras @xcite and madras and",
    "pehlivan @xcite started the study of uniform permutations in @xmath39 for small patterns @xmath28 . * in parallel , miner and",
    "pak @xcite described very precisely the asymptotic shape of a uniform element in @xmath39 for the @xmath40 patterns @xmath28 in @xmath41 .",
    "dokos and pak @xcite have then obtained similar results for random doubly alternating baxter permutations .",
    "note also that miner and pak discuss at the end of their paper a possible connection with the brownian excursion .",
    "* such a connection between @xmath39 for @xmath42 and the brownian excursion is explained by hoffman , rizzolo and slivken @xcite .",
    "many combinatorial consequences are given , in particular a precise description of fixed points of such permutations @xcite .",
    "* in a parallel line of research , bna @xcite investigates the behaviour of @xmath43 $ ] for @xmath4 uniform in @xmath44 , and several fixed @xmath19 s .",
    "similar results for other permutation classes and various patterns @xmath19 have then been obtained by homberger @xcite , chang , eu and fu @xcite and rudolf @xcite . *",
    "the question of finding limiting distributions for @xmath21 for @xmath4 uniform in @xmath39 , rather than studying only its expectation , was raised by janson , nakamura and zeilberger in @xcite : the authors gave some algorithms to find limits of moments for small @xmath19 and @xmath28 .",
    "a bit later , janson @xcite has given for every @xmath19 the asymptotic behaviour of the random variable @xmath21 for @xmath4 uniform in @xmath44 .",
    "for instance , he expresses in terms of the brownian excursion area the asymptotic behaviour of @xmath45 .",
    "* in his recent thesis , bevan describes the limit shape of permutations in so - called _ connected monotone grid classes _ ( * ? ? ?",
    "* chapter 6 ) .",
    "this result is the first that deals with an infinite family of permutation classes .",
    "* even if it does not involve strictly speaking _ pattern - avoiding permutations _ , we mention the recent work of kenyon , kral , radin and winkler @xcite .",
    "they prove a large deviation theorem for permutations seen as probability measures on the square .",
    "their result yields limit shapes of random permutations with fixed densities of some fixed pattern @xmath46 .",
    "this parallels similar results on graphons , which are well - studied objects in random graph theory .    in the current paper",
    ", we are specifically interested in the class of _ separable _ permutations .",
    "a permutation @xmath4 is _ separable _ if @xmath4 avoids both @xmath47 and @xmath48 .",
    "we obtain results similar to those of janson @xcite for @xmath49 , namely we study occurrences of any pattern @xmath19 in uniform random separable permutations .",
    "there is however an important difference between our work and all classes studied so far : random permutations in any of these previously studied classes have a limit which is _ deterministic _ at first order , whereas random separable permutations have a limit which is _ non - deterministic _ at first order .",
    "the limit of random separable permutations will be discussed in [ subsec : intro_permutons ] , and the proof that it is not deterministic will be given in [ ssec : variance ] .",
    "this is also visible on [ fig : simu_largeseparable ] , which shows two large typical separable permutations obtained using a boltzmann random sampler .     and",
    "@xmath50 ( a permutation @xmath4 is represented here with its _ diagram _ : for every @xmath51 , there is a dot at coordinates @xmath52).,title=\"fig : \" ]   and @xmath50 ( a permutation @xmath4 is represented here with its _ diagram _ :",
    "for every @xmath51 , there is a dot at coordinates @xmath52).,title=\"fig : \" ]    there are several reasons that motivate our choice of studying the class of separable permutations , in addition to it being one of the most studied classes after @xmath37 for @xmath28 of size @xmath53 .",
    "separable permutations have a very nice and robust combinatorial structure : they can be completely decomposed using direct sums and skew sums , and therefore can be represented as signed schrder trees ( see [ sec : permutationsandschrodertrees ] ) . besides , the class of separable permutations is the simplest case of a non - trivial _ substitution - closed _ ( also called wreath - closed  @xcite ) class , and we believe that the results obtained here might be extended to any substitution - closed class ; see the discussion on universality in [ subsec : perspectives ] .      throughout this paper , let us denote by @xmath54 a uniform separable permutation of size @xmath0 .",
    "our goal is to describe the limit of @xmath54 when @xmath0 goes to infinity .",
    "our main result gives , for any @xmath19 , the asymptotics of the distribution of @xmath55 when @xmath0 tends to infinity .",
    "we will see in [ subsec : intro_permutons ] an equivalent formulation in terms of weak convergence of probability measures on the square .",
    "our main theorem is the following :    [ thm : main ]",
    "let @xmath54 be a uniform separable permutation of size @xmath0 .",
    "there exists a collection of random variables @xmath56 , @xmath19 ranging over all permutations , defined on the same probability space , such that for all @xmath19 , @xmath57 and :    1 .",
    "[ item : main_variance ] if @xmath19 is a separable permutation of size at least @xmath58 , @xmath59 is a non - deterministic random variable . +",
    "( if @xmath19 is the permutation of size @xmath60 , @xmath61 . if @xmath19 is not separable , @xmath62 . )",
    "[ item : main_distrib ] for all @xmath19 , when @xmath63 , @xmath64 where @xmath65 denotes the convergence in distribution .",
    "[ item : main_joint ] moreover the convergence holds jointly , that is : for any finite sequence of permutations @xmath66 , @xmath67 ( on the right - hand side , the @xmath68 s are not independent . )",
    "theorem  [ thm : main ] is not just an existential result : in this paper we give for any pattern @xmath19 a construction of @xmath59 ( [ dfn : lambda_pi ] p. ) that can be briefly explained as follows .",
    "there is a natural way ( reviewed in [ section : extracting ] ) to extract a ( signed ) tree with @xmath69 leaves from a realization of the ( signed ) brownian excursion .",
    "the variable @xmath59 is the probability that this tree is one of the _ separation trees _ of @xmath19 ( see [ sec : permutationsandschrodertrees ] for the definition ) .",
    "statement  [ item : main_variance ] of the theorem is proved in [ ssec : variance ] , while statement  [ item : main_joint ] ( statement [ item : main_distrib ] being just a special case ) is proved in sections  [ sec : leavesareuniform ] to  [ sec : main_proof ] , following the proof schema detailed in [ sec : outlineproof ] .",
    "theorem  [ thm : main ] shows in particular that , for every separable pattern @xmath19 of size @xmath8 , the number of occurrences of @xmath19 in @xmath54 must be renormalized by @xmath70 to have a non - trivial limit in distribution .",
    "this is in contrast with the result of janson ( * ? ? ?",
    "* theorem 2.1 ) for @xmath4 uniform in @xmath44 . indeed , in his result , the numbers of occurrences of different patterns of the same size are normalized by different powers of @xmath0 to have non - trivial limits in distribution .    in addition to the convergence in distribution",
    ", we also prove the convergence of all joint moments ( in fact , we first prove the convergence of joint moments , and then deduce the convergence in distribution ) .",
    "this is especially interesting since the joint moments in the limit can be computed explicitly .",
    "more precisely , all joint moments can be expressed in the limit from expectations of @xmath59 s ( see [ prop : computing_moments ] ) , and the expectation of @xmath59 can be expressed in terms of the number @xmath71 of signed binary trees associated with the permutation @xmath19 ( these are also sometimes called _ separation trees _ of @xmath19 ; see [ sec : permutationsandschrodertrees ] for their definition ) .",
    "the latter is proved in [ prop : expectation_lamdba_pi ] , which reads as follows :    [ thm : mainesperance ] for any permutation @xmath19 of size @xmath8 , @xmath72\\stackrel{n\\to + \\infty}{\\longrightarrow } \\frac{n_\\pi}{2^{k-1 } \\operatorname{cat}_{k-1}},\\ ] ] where we denote by @xmath73 the @xmath8-th catalan number .",
    "our proof of [ thm : mainesperance ] involves the random variables @xmath59 , which are constructed from the brownian excursion .",
    "we do not know if there exists a proof using only discrete arguments .",
    "in addition to being defined combinatorially , the numbers @xmath71 are easy to compute ; see [ obs : n_pi ] .",
    "this gives for example @xmath74&=    \\lim_{n \\to + \\infty } \\mathbb{e}\\left[\\operatorname{\\widetilde{occ}}(21,\\si_n)\\right ] = \\frac12 ; \\\\",
    "\\lim_{n \\to + \\infty } \\mathbb{e}\\left[\\operatorname{\\widetilde{occ}}(123,\\si_n)\\right]&=    \\lim_{n \\to + \\infty } \\mathbb{e}\\left[\\operatorname{\\widetilde{occ}}(321,\\si_n)\\right ] = \\frac14 ; \\\\ \\lim_{n",
    "\\to + \\infty } \\mathbb{e}\\left[\\operatorname{\\widetilde{occ}}(132,\\si_n)\\right]&=    \\lim_{n \\to + \\infty } \\mathbb{e}\\left[\\operatorname{\\widetilde{occ}}(213,\\si_n)\\right ] = \\frac18\\\\    \\lim_{n \\to + \\infty } \\mathbb{e}\\left[\\operatorname{\\widetilde{occ}}(231,\\si_n)\\right ] & =     \\lim_{n \\to + \\infty } \\mathbb{e}\\left[\\operatorname{\\widetilde{occ}}(312,\\si_n)\\right ] = \\frac18.\\end{aligned}\\ ] ] limits of higher ( joint ) moments can also be computed explicitly , as shown in [ prop : computing_moments ] . for example , we obtain @xmath75= \\frac{1}{30};\\qquad    \\lim_{n \\to + \\infty } \\operatorname{var}\\left[\\operatorname{\\widetilde{occ}}(132,\\si_n)\\right ] = \\frac{3}{560 } ; \\\\    \\lim_{n \\to + \\infty } & \\mathbb{e}\\left [ \\operatorname{\\widetilde{occ}}(12,\\si_n ) \\cdot \\operatorname{\\widetilde{occ}}(123,\\si_n ) \\right]= \\frac{43}{280}.\\end{aligned}\\ ] ]    these values",
    "have been computed automatically with a sage program @xcite that the authors can make available on request .",
    "we refer to [ ssec : exp_lpi ] for a discussion on the computation of joint moments , both from the theoretical and algorithmic points of view .    for the curious reader ,",
    "we give the first few moments of @xmath76 ( that is the limits of the first few moments of @xmath77 ) : @xmath78=\\frac{1}{2},\\quad \\mathbb{e}[\\lambda_{12}^2]=\\frac{17}{60},\\quad \\mathbb{e}[\\lambda_{12}^3]=\\frac{7}{40},\\quad",
    "\\mathbb{e}[\\lambda_{12}^4]=\\frac{6361}{55440},\\quad \\mathbb{e}[\\lambda_{12}^5]=\\frac{1741}{22176}.\\ ] ] we did not recognize the first moments of any `` usual '' distribution on @xmath79 $ ] .",
    "we recall the notion of _ permutons _ introduced in @xcite .",
    "note that , in @xcite , permutons are called _ limit permutations _ and have two equivalent definitions ( see ( * ? ? ?",
    "* section 2.3 ) ) ; the name _ permuton _ was proposed in @xcite in analogy with the graph analogue _",
    "graphon_.    [ dfn : permuton ] a _ permuton _ is a probability measure @xmath80 on the square @xmath79 ^ 2 $ ] with uniform marginals , _",
    "i.e. _ , for any @xmath81 and @xmath82 with @xmath83 , @xmath84 \\times [ 0,1 ] ) = \\mu([0,1 ] \\times [ a , b ] ) = b - a.\\ ] ]    one can associate a permuton @xmath85 to a permutation @xmath4 of size @xmath0 .",
    "we define @xmath85 as having density @xmath0 on each square @xmath86 \\times [ ( \\sigma(i)-1)/n,\\sigma(i)/n]$ ] ( for @xmath87 ) and density @xmath88 elsewhere ; that is , each of these squares has total weight @xmath89 , uniformly distributed in it .",
    "this is a natural way to encode and rescale a permutation , very close to the graphical representation that we use on [ fig : simu_closed_or_not , fig : simu_largeseparable ] .",
    "since permutons are measures , it is natural to speak about weak convergence of permutons .",
    "we will see in [ sec : permutons ] that our main result , combined with previous results on permutons , implies the following :    let @xmath54 be a uniform random separable permutation of size @xmath0 .",
    "there exists a random permuton @xmath90 such that @xmath91 tends to @xmath90 in distribution in the weak convergence topology .",
    "moreover , @xmath90 is not deterministic .",
    "[ thm : main_permuton ]    the distribution of this permuton @xmath90 is unique , since it is defined as a limit in distribution .",
    "the proof of the existence of @xmath90 is not constructive , but involves the variables @xmath59 , which are themselves built using a realization of the brownian excursion .",
    "we therefore call @xmath90 the _ brownian separable permuton_.    there are many examples of convergence of large combinatorial structures towards continuum objects built from brownian motion ( or related processes : the brownian bridge and excursion ) .",
    "one can mention    * random mappings and brownian bridges ; * random trees and brownian trees ; * random graphs and brownian motion .",
    "a very good reference for these topics is @xcite .",
    "[ thm : main_permuton ] fits naturally in this body of literature .",
    "note that the fact that separable permutations have a brownian limit in some sense should not come as a surprise . indeed ,",
    "separable permutations of size @xmath0 can be encoded by ( signed ) _ schrder trees _ with @xmath0 leaves ( see [ sec : permutationsandschrodertrees ] ) .",
    "like for many families of trees , the limit of schrder trees with a fixed number of leaves ( leaving signs aside ) is related to the brownian excursion : more precisely , pitman and rizzolo @xcite and kortchemski @xcite proved that the _ contour _ of a uniform schrder tree with @xmath0 leaves tends to the brownian excursion .",
    "this result is essential in our approach .",
    "we think that the brownian separable permuton @xmath90 is an interesting object and is worth being studied .",
    "in particular , we would like to address the following questions .",
    "construction of @xmath90 : :    at the moment , @xmath90 is defined in a indirect way , as    limit of discrete objects .",
    "is there a way to define / construct the    random measure @xmath90 directly in the continuum , _",
    "e.g. _ as    a function of the ( signed ) brownian excursion ? properties of @xmath90 : :    it would be interesting to find some almost - sure properties of    @xmath90 .",
    "is it absolutely continuous or singular with    respect to lebesgue measure on the square ? ( note that , since its    marginals are uniform , it can not have atoms . )",
    "one also expects that    @xmath90 is fractal in some sense , because of the link with    the brownian excursion and the visual aspect of the simulations in    [ fig : simu_largeseparable ] .",
    "this raises the following question : what is    the hausdorff dimension of its support ?",
    "universality of @xmath90 : :    we believe that @xmath90 is the limit ( in the sense of    permutons ) of many other classes of random pattern - avoiding    permutations .",
    "recall indeed that the class of separable permutations    is the first non - trivial case of a substitution - closed class of    permutations .",
    "such classes are those whose structure is    well - understood using the substitution decomposition mentioned earlier    in this introduction , even more so when they contain a finite number    of so - called _ simple _ permutations ( see  ( * ? ? ?",
    "* section 3.2 ) ) . for any    substitution - closed class ,",
    "the permutations it contains may be    represented by trees , called _ ( substitution ) decomposition trees_.    these generalize signed schrder trees by introducing other types of    vertices , labeled by the simple permutations in the class .",
    "as the    encoding of separable permutations by schrder trees is crucial in    this work , our results might extend to all substitution - closed classes    containing finitely many simple permutations .",
    "figure  [ fig : simu_closed_or_not ] shows two typical permutations : one in    a substitution - closed class , one in a class that is not closed under    substitution . on these examples",
    ", it seems clear that the first one    looks similar to the separable case , whereas the second one does not .     in the substitution - closed class",
    "whose simple permutations are @xmath47 , @xmath48 and @xmath92 . on the right , a typical permutation of size @xmath93 in the non - substitution - closed class @xmath94.,title=\"fig : \" ]   in the substitution - closed class whose simple permutations are @xmath47 , @xmath48 and @xmath92 . on the right , a typical permutation of size @xmath93 in the non - substitution - closed class @xmath94.,title=\"fig : \" ]",
    "our paper is organized as follows .",
    "* [ sec : preliminaries ] gives all the preliminaries needed to define the limit random variables @xmath59 and records a lot of easy useful facts about permutations and trees .",
    "* section  [ sec : main_result ] defines the variables @xmath59 and presents the structure of the proof of theorem  [ thm : main].[item : main_joint ] .",
    "* sections  [ sec : leavesareuniform ] to  [ sec : signs ] go through the several steps of this proof ( the outline of the proof itself is given in [ sec : outlineproof ] ) . *",
    "we gather all the arguments and conclude the proof of theorem  [ thm : main].[item : main_joint ] in section  [ sec : main_proof ] . *",
    "[ sec : permutons ] contains the proof of the permuton interpretation of our main result : [ thm : main_permuton ] . *",
    "section  [ sec : properties_of_moments ] studies some properties of @xmath59 : combinatorial formulas for the moments in [ ssec : exp_lpi ] and proof of [ thm : main].[item : main_variance ] ( @xmath59 is not deterministic ) in [ ssec : variance ] . * we collect several useful properties of the brownian excursion in [ appendix ] .",
    "[ dfn : trees ] a _ schrder tree _ is either a leaf , or consists of a root vertex with an ordered @xmath8-tuple of subtrees attached to the root ( @xmath95 ) , which are themselves schrder trees .",
    "non - leaf vertices of a tree are called _",
    "internal vertices_.    we consider only _ finite _ schrder trees , _",
    "i.e. _ , those having finitely many leaves and internal vertices .    in our context , the _ size _ of a tree @xmath96 is its number of leaves .",
    "it is denoted @xmath97 , whereas @xmath98 denotes the number of vertices of @xmath96 ( including both leaves and internal vertices ) .",
    "because every internal vertex of a schrder tree has at least @xmath58 children , it follows immediately ( by induction ) that :    [ obs : size_schroeder_tree ] for every schrder tree @xmath96 , @xmath99 .",
    "a _ binary tree _ is a schrder tree where there are exactly @xmath58 subtrees attached to every internal vertex .    in this article",
    ", we consider unlabeled trees .",
    "nevertheless , since we work with _ plane _ trees ( _ i.e. _ , trees in which the subtrees attached to a vertex are ordered ) , there is a canonical way to label the _ leaves _ of a tree ( from left to right ) .",
    "then a subset of the set of leaves of a tree @xmath96 is canonically represented by a subset @xmath24 of @xmath100 $ ] .",
    "[ dfn : common_ancestor ] let @xmath96 be a schrder tree and @xmath101 and @xmath102 be two vertices of @xmath96 . denote by @xmath103 the root of @xmath96 .",
    "the _ ( first ) common ancestor _ of @xmath101 and @xmath102 is the vertex furthest away from @xmath103 that appears on both paths from @xmath103 to @xmath101 and from @xmath103 to @xmath102 in @xmath96 .",
    "[ dfn : induced_subtree ] let @xmath96 be a schrder tree .",
    "any subset @xmath24 of the leaves of @xmath96 induces a subtree @xmath104 of @xmath96 , which is also a schrder tree , defined as follows :    * the leaves of @xmath104 are the elements of @xmath24 ; * the internal vertices of @xmath104 are the vertices of @xmath96 that are common ancestors of two leaves in @xmath24 ; * the ancestor - descendant relation in @xmath104 is inherited from the one in @xmath96 ; * the order between the children of an internal vertex of @xmath104 is inherited from @xmath96 .",
    "note that if @xmath96 is a binary tree , then so is @xmath104 .",
    "[ dfn : signed_trees ] a _ signed _ schrder tree is a pair @xmath105 , where @xmath96 is a schrder tree and @xmath106 a function from the set of internal vertices of @xmath96 to @xmath107 .",
    "[ dfn : induced_signed_subtree ] let @xmath105 be a signed schrder tree .",
    "any subset @xmath24 of the leaves of @xmath96 induces a signed subtree @xmath108 of @xmath105 , where @xmath104 is as in definition  [ dfn : induced_subtree ] and @xmath109 is the restriction of @xmath106 on the set of internal vertices of @xmath104 .",
    "[ ex : schrodertree ] consider the signed schrder tree on the left - hand side of [ fig : subtree ] . to ease the presentation ,",
    "we have indicated the canonical labeling of its leaves from left to right .",
    "we take the subset of leaves @xmath110 ( circled on the picture ) .",
    "then the signed subtree @xmath108 is represented on the right - hand side of [ fig : subtree ] .",
    "( again labels on the leaves are here to simplify the presentation , our objects are in essence not labeled . )",
    "[ dfn : tree2perm ] let @xmath19 and @xmath4 be two permutations of respective sizes @xmath8 and @xmath111 .",
    "their _ direct sum _ and _ skew sum _ are the permutations of size @xmath112 defined by @xmath113 = \\pi \\oplus \\sigma = & \\pi_1 \\ldots \\pi_k ( \\sigma_1 + k ) \\ldots ( \\sigma_\\ell + k ) \\textrm { and } \\\\ \\ominus[\\pi,\\sigma ] = \\pi \\ominus \\sigma = & ( \\pi_1+\\ell ) \\ldots ( \\pi_k+\\ell ) \\sigma_1 \\ldots \\sigma_\\ell . \\end{aligned}\\ ] ]    the operators @xmath114 and @xmath115 being associative , direct sums and skew sums with @xmath116 components are defined in the obvious way .",
    "we will use the notation @xmath117 $ ] instead of @xmath118 ( and similarly for @xmath115 ) .",
    "examples with @xmath119 are provided in [ fig : sum_and_skew ] , which also illustrates the graphical interpretation of these operations on permutation diagrams .    ,",
    "title=\"fig:\",width=264 ] , title=\"fig:\",width=264 ]    let @xmath105 be a signed schrder tree .",
    "the permutation associated with @xmath105 , denoted @xmath120 , is inductively defined by :    * if @xmath96 is a leaf , then @xmath121 ; * otherwise , denoting by @xmath122 the children of the root of @xmath96 from left to right , and @xmath123 the restriction of @xmath106 to the vertices of @xmath124 , @xmath125 & \\text { if the root of $ t$ has sign $ + $ ; } \\\\",
    "\\ominus[\\operatorname{perm}(t_1,\\eps_1 ) , \\ldots , \\operatorname{perm}(t_r,\\eps_r ) ] & \\text { if the root of $ t$ has sign $ -$. }   \\end{cases}\\ ] ]    if @xmath126 , we say that @xmath105 is _ a signed tree _ of @xmath4 .",
    "[ dfn : separating_tree ]    note that the @xmath127-th leaf of @xmath105 ( from left to right ) corresponds to the @xmath127-th element of @xmath120 .",
    "_ binary _ signed trees of a permutation @xmath4 are sometimes called _ separation trees _ of @xmath128 .    for example",
    ", let @xmath105 be the tree on the left - hand side of [ fig : subtree ] of [ ex : schrodertree ]",
    ". then @xmath129,1 \\big ] , 1,\\ominus[1,1 ] \\bigg ]   = \\oplus \\big [ \\oplus[321,1],1 , 21 \\big]= \\oplus[3214,1,21]=3214576.\\ ] ] on the other hand , if we consider the tree @xmath108 on the right - hand side of [ fig : subtree ] , we have @xmath130,1 \\big ] = 123.\\ ] ] in other words , @xmath105 and @xmath108 are signed trees of @xmath131 and @xmath132 , respectively .",
    "there is an important consequence of the definition of the signed tree @xmath105 of a permutation @xmath4 , which is easily seen on our figures . for @xmath133 , then @xmath134 ( resp .",
    "@xmath135 ) if and only if the common ancestor of leaves @xmath136 has sign @xmath137 ( resp .",
    "@xmath138 ) .",
    "a consequence of this observation is that the map @xmath139 is compatible with taking substructures :    [ obs : patterns_and_subtrees ] let @xmath105 be a signed schrder tree .",
    "let @xmath24 be a subset of @xmath100 $ ] and @xmath108 be the signed subtree of @xmath105 induced by @xmath24 .",
    "then it holds that @xmath140 .",
    "we continue [ ex : schrodertree ] .",
    "taking @xmath110 , we have seen that @xmath141 and @xmath142 .",
    "thus [ obs : patterns_and_subtrees ] asserts that @xmath143 , which is indeed the case .",
    "this is illustrated by [ fig : schroder_permutation_avecmotif ] .    .",
    "the elements of the pattern @xmath144 are circled / overlined .",
    "[ fig : schroder_permutation_avecmotif],width=377 ]    in the introduction , separable permutations have been defined as avoiding specific patterns .",
    "in fact , they can also been characterized using signed schrder trees .",
    "[ prop : bbl ] separable permutations are exactly those that can be obtained as @xmath120 for a signed binary tree @xmath105 , or equivalently , those that can be obtained as @xmath120 for a signed schrder tree @xmath105 .    the first part ( with binary trees ) has been established in @xcite .",
    "assume now that a permutation @xmath128 can be obtained as @xmath120 for a signed schrder tree @xmath105 ; we need to prove that @xmath128 can also be obtained as @xmath145 for a signed binary tree @xmath146 .",
    "to obtain @xmath146 from @xmath105 , it is enough to replace every vertex with a label @xmath147 and @xmath148 subtrees @xmath149 by a binary tree with @xmath8 leaves on which @xmath149 are pending and with all internal vertices labeled @xmath147 .",
    "[ fig : form_100euros ] ( p. ) shows _ all _ binary trees that can be obtained by the above construction from a specific signed schrder tree .",
    "the advantage of schrder trees over binary trees is that the correspondence tree - permutation can be made one - to - one in more natural way :    [ prop : bij_separables_trees ] the map @xmath139 is a size - preserving bijection between separable permutations and signed schrder trees in which the signs alternate ( _ i.e. _ , all internal vertices at even ( resp .",
    "odd ) distance from the root have the same sign as the root ( resp . the opposite sign ) ) .",
    "proposition  [ prop : bij_separables_trees ] is a consequence of the more general substitution decomposition theorem for permutations  ( * ? ? ?",
    "* proposition 2 ) . in this context , the unique signed schrder tree @xmath105 in which the signs alternate such that @xmath150 is called the _ ( substitution ) decomposition tree _ of @xmath19 .",
    "let us return to [ ex : schrodertree ] .",
    "the permutation @xmath131 which is induced by the tree on the left - hand side of [ fig : subtree ] is separable and the schrder tree in which signs alternate that corresponds to it is shown in [ fig : schroderalterne_permutation ] .    , width=377 ]    recall that @xmath54 denotes a uniform random separable permutation of size @xmath0 . throughout the paper ,",
    "we denote by @xmath151 a uniform random schrder tree with @xmath0 leaves . from proposition",
    "[ prop : bij_separables_trees ] , it follows that :    [ cor : same_distibution_separables_trees ] let @xmath152 be a balanced bernoulli variable with values in @xmath107 , independent from @xmath151 .",
    "let @xmath153 be the sign function on the internal vertices of @xmath151 , such that the signs alternate and the root of @xmath151 has sign @xmath152 .",
    "then @xmath54 has the same distribution as @xmath154 .",
    "pitman and rizzolo observed ( see ( * ? ? ? * theorem 1 ) ) that @xmath151 behaves like a galton - watson tree conditioned to have @xmath0 leaves ( we refer to ( * ? ? ?",
    "* section 3 ) for basics of galton - watson trees ) :    [ prop : schroeder_are_galton - watson ] let @xmath155 be the probability distribution defined by : @xmath156 then    * @xmath155 has mean @xmath60 and variance @xmath157 ; * @xmath151 has the same distribution as a galton - watson tree with offspring distribution @xmath155 , conditioned to have @xmath0 leaves .",
    "note that there are actually infinitely many probability distributions @xmath155 such that @xmath151 has the same distribution as a galton - watson tree with offspring distribution @xmath155 , conditioned to have @xmath0 leaves .",
    "the one chosen in proposition  [ prop : schroeder_are_galton - watson ] is such that @xmath155 has mean @xmath60 .",
    "this choice maximizes the probability that a galton - watson tree with offspring distribution @xmath155 has @xmath0 leaves , when @xmath0 tends to infinity .",
    "this property will be used in proposition  [ prop : estimationmarcher ] ( p. ) .",
    "an _ excursion _ is a continuous function @xmath158 \\to [ 0 , + \\infty)$ ] with @xmath159 .",
    "we can canonically associate with a tree an excursion , called its _",
    "contour_.    [ dfn : contour ]",
    "let @xmath96 be a ( binary or schrder ) tree .",
    "recall that @xmath98 denotes the total number of vertices of @xmath96 , and denote by @xmath160 the set of vertices of @xmath96 .",
    "consider the function @xmath161 ( @xmath162 stands for _ depth first search _ ) defined by :    * @xmath163 is the root of @xmath96 ; * if @xmath164 , then @xmath165 is the leftmost child of @xmath102 that has not yet been visited , if it exists , and the parent of @xmath102 otherwise .",
    "the _ contour _ of @xmath96 is the function @xmath166 \\to [ 0;+\\infty)$ ] such that for all integers @xmath127 in @xmath167 $ ] , @xmath168 is the distance from the root of @xmath96 to the vertex @xmath169 , and @xmath170 is linear between those points .",
    "an example of a tree @xmath96 and its contour @xmath170 is given on [ fig : contour ] ( the reader should disregard the signs for the moment ) .",
    "the tiny numbers beside each vertex @xmath102 indicate the times @xmath127 in @xmath167 $ ] such that @xmath171 .",
    "[ dfn : normalized_contour ] let @xmath96 be a schrder tree .",
    "the _ normalized contour _ of @xmath96 is the function @xmath172 \\to [ 0 , + \\infty)$ ] defined as follows : @xmath173 , \\quad \\widetilde{c_t}(u)=\\frac{1}{\\sqrt{|t| } } c_t\\big ( ( 2\\#t-2)\\ , u \\big).\\ ] ]    by definition , both @xmath170 and @xmath174 are continuous , so that @xmath174 is an excursion .",
    "some properties of the local maxima and local minima of @xmath174 follow from its definition , and will be essential for our purpose .",
    "[ obs : peaks = leaves ] let @xmath96 be a tree with @xmath175 .",
    "if there is a _ local maximum _ of @xmath174 in @xmath101 , then @xmath176 for some integer @xmath127 and @xmath169 is a _ leaf _ of @xmath96 .",
    "this defines a bijection between the leaves of @xmath96 and the local maxima of @xmath174 .",
    "this allows to identify the leaves of @xmath96 with the @xmath177-coordinates of the local maxima of @xmath174 .",
    "we will often do so in the sequel , and we introduce the following notation :    [ dfn : leaves_coordinates ] for any tree @xmath96 with @xmath175 , we define @xmath178 to be the @xmath177-coordinates of the local maxima of @xmath174 ( which correspond to the leaves of @xmath96 ) , and we set @xmath179 $ ] .",
    "[ obs : valleys = internal_nodes ] let @xmath96 be a tree with @xmath175 . if there is a _ local minimum _ of @xmath174 in @xmath101 , then @xmath176 for some integer @xmath127 and @xmath169 is an _",
    "internal vertex _ of @xmath96 .",
    "note however that a single internal vertex can correspond to several local minima of @xmath174 .",
    "using the description of schrder trees as galton - watson trees ( see [ prop : schroeder_are_galton - watson ] ) , pitman and rizzolo @xcite and kortchemski @xcite have proved that the normalized contour of a uniform schrder tree converges in distribution to a multiple of the brownian excursion ( one of ) its definition(s ) , together with some useful properties , and bibliographical references . ] . throughout the paper ,",
    "we denote by @xmath180 the brownian excursion .",
    "[ prop : convergencecontour ] the following convergence holds in distribution in the space @xmath181 $ ] of real - valued continuous functions on @xmath79 $ ] : @xmath182 } \\stackrel{n\\to+\\infty}{\\longrightarrow } \\left(\\lambda \\cdot \\exc(u)\\right)_{u\\in[0,1]},\\ ] ] where @xmath183 .",
    "we now define signed analogues of contours and excursions .",
    "a _ signed excursion _ is a pair @xmath184 where @xmath185 is an excursion and @xmath186 a function from the set of the local minima of @xmath185 to @xmath107 .    from observation  [ obs :",
    "valleys = internal_nodes ] , we may define the signed contour of a signed tree as follows :    [ dfn : signed_contour ] let @xmath105 be a signed schrder tree .",
    "the _ signed contour _ of @xmath105 is the pair @xmath187 , where @xmath186",
    "associates to every local minimum of @xmath174 reached in @xmath176 the sign of the internal vertex @xmath169 of @xmath96 .",
    "the reader is now invited to look again at [ fig : contour ] , taking the signs into consideration .",
    "we may also define the signed brownian excursion by :    [ dfn : brownian_exc ] the signed brownian excursion is the pair @xmath188 where @xmath180 is the brownian excursion and @xmath189 is the function assigning balanced independent signs on the local minima of @xmath180 .",
    "[ rem : cv_to_signedbrownianexc ] consider a uniform random schrder tree @xmath151 of size @xmath0 and a random sign function @xmath153 on its internal vertices defined as in [ cor : same_distibution_separables_trees ] .",
    "if we use [ dfn : signed_contour ] on @xmath190 , we get a random signed excursion @xmath191 .",
    "since @xmath192 converges towards a multiple of the brownian excursion @xmath180 , a natural question is the convergence of @xmath191 towards the signed brownian excursion .",
    "a first difficulty in proving such a result would be to find a good topology on signed excursions .",
    "another , maybe deeper , obstacle is that the signs assigned to the local minima in @xmath191 are far from independent : recall that on the corresponding tree , signs on internal vertices alternate .",
    "our work shows the convergence of @xmath191 to @xmath188 in a weaker sense .",
    "indeed , the next subsection explains how to extract a permutation of any fixed size from a signed excursion , and theorem  [ thm : main].[item : main_joint ] proves the joint convergence in distribution of the permutations extracted from @xmath191 to those extracted from @xmath188 .",
    "given @xmath8 points in an excursion , there is a natural way to associate a tree with this data .",
    "we now explain this construction .",
    "this is classical in the random tree literature and can for example be found in le gall s survey ( * ? ? ?",
    "* section 2.5 ) ( except that he considers geometric trees , _",
    "i.e. _ , with edge - lengths , while we are only interested in combinatorial trees ) .",
    "[ dfn : tree ] let @xmath185 be an excursion and @xmath193 be a set of @xmath8 points in @xmath79 $ ] . without loss of generality , we assume @xmath194 . for all @xmath195 , let @xmath196 be the minimum value of @xmath185 on @xmath197 $ ] .",
    "we associate to @xmath198 a schrder tree @xmath199 , defined recursively as follows .    if @xmath200 then @xmath199 is a leaf .",
    "otherwise , let @xmath201 and denote by @xmath202 all the indices @xmath203 such that @xmath204 . for notational convention ,",
    "let @xmath205 and @xmath206 . for all @xmath207",
    ", define @xmath208 .",
    "then @xmath199 is the tree whose root has arity @xmath209 and whose children are @xmath210 .",
    "[ obs : distinctminimpliesbinary ] if all @xmath196 are distinct , then @xmath199 is a binary tree .",
    "an example of the construction presented in definition  [ dfn : tree ] is given on [ fig : extraction ] ( the reader should disregard the signs for the moment ) .        by construction ,",
    "the leaves of @xmath199 are in one - to - one correspondence with the @xmath211 s . moreover",
    ", to each @xmath196 corresponds an internal vertex of @xmath199 ; note however that several @xmath196 s may correspond to the same vertex of @xmath199 ( this happens exactly for @xmath196 and @xmath212 having the same value such that no @xmath213 for @xmath214 is smaller ) .",
    "in addition , the common ancestor of the leaves corresponding to @xmath211 and @xmath215 in @xmath199 is the internal vertex that corresponds to @xmath196 . more generally , the common ancestor of the leaves corresponding to @xmath211 and @xmath216 , with @xmath133 , is the internal vertex that corresponds to @xmath217 .",
    "an interesting special case consists in considering the normalized contour @xmath174 of a tree @xmath96 , and choosing @xmath218 to be a subset of @xmath219 ( defined in definition  [ dfn : leaves_coordinates ] ) .",
    "[ obs : extractedtree = subtree ] let @xmath96 be a schrder tree , and @xmath24 be a subset of its set of leaves .",
    "let @xmath218 be the subset of @xmath219 corresponding to the @xmath177-coordinates of these leaves .",
    "then @xmath220 , that is to say the tree extracted from @xmath218 in the contour of @xmath96 is the same as the subtree of @xmath96 induced by @xmath24 .",
    "a similar statement holds when extracting trees in excursions that are not necessarily contours ; this observation ( or rather its signed analogue ) will be useful in section  [ sec : moments ] .",
    "[ obs : extractedtree = subtree_generalcase ] let @xmath185 be an excursion and @xmath193 be a set of @xmath8 points in @xmath79 $ ] .",
    "let @xmath221 .",
    "let @xmath222 be a subset of @xmath218 , and @xmath24 be the corresponding subset of the set of leaves of @xmath96 .",
    "then the tree extracted from @xmath222 in @xmath185 is the substree of @xmath96 induced by @xmath24 , _",
    "i.e. _ , @xmath223 .",
    "we now discuss the signed analogue of the extraction of trees from excursions .",
    "[ dfn : tree_pm ] let @xmath184 be a signed excursion , and @xmath193 be a set of @xmath8 points in @xmath79 $ ] , assumed to satisfy @xmath194 .",
    "as in definition  [ dfn : tree ] , for all @xmath195 , denote by @xmath196 the minimum value of @xmath185 on @xmath197 $ ] .",
    "we assume that the following condition holds : @xmath224\\textrm { , \\emph{i.e . } , } \\\\",
    "\\textrm{for all } i , \\textrm { there exists } y \\in ( x_i , x_{i+1 } ) \\textrm { such that } f(y)=m_i .",
    "\\\\ \\bullet \\ \\textrm{for all } i\\textrm { , all the local minima with value } m_i \\textrm { on } ( x_i , x_{i+1 } ) \\\\",
    "\\textrm{are given the same sign by } s \\textrm { , abusively denoted } s(m_i ) .",
    "\\\\ \\bullet \\ \\textrm{if } m_i = m_j \\textrm { and there is no } i < k < j \\textrm { such that } m_k < m_i , \\\\",
    "\\textrm{then } s(m_i ) = s(m_j ) .",
    "\\tag{$\\mathcal{c}$ } \\label{condition : unique_signs_on_minima } \\end{cases}\\ ] ] then @xmath225 is defined like @xmath199 , except that , at each stage of the construction , we associate with the root the sign of the corresponding local minimum ( or minima ) of @xmath185 . doing so , at the end of the construction , every internal vertex of @xmath225 has a sign .",
    "condition   ensures that the signs are well - defined .",
    "indeed , the first condition guarantees that @xmath185 has a minimum on @xmath226 , which is therefore a local minimum of @xmath185 ( of value @xmath196 ) , and consequently has a sign .",
    "the second condition implies that , for all @xmath127 , all minima of @xmath185 on @xmath226 have the same sign , and the third one ensures that ( with the notation of definition  [ dfn : tree ] ) all @xmath227 have the same sign , and recursively so .    because a separable permutation is associated with each signed schrder tree ( see [ dfn : separating_tree ] and [ prop : bbl ] )",
    ", we can extract a separable permutation from a signed excursion in which @xmath8 points are chosen .",
    "[ dfn : perm ] let @xmath184 be a signed excursion and @xmath193 be a set of @xmath8 points in @xmath79 $ ] .",
    "assume @xmath228 satisfies condition  .",
    "the separable permutation associated with @xmath228 is @xmath229    the reader is now invited to look again at [ fig : extraction ] , taking the signs into consideration .",
    "the permutation associated to the signed tree on the right is @xmath230 , so that in this case , @xmath231 .",
    "[ obs : perm_is_defined ] when considering a signed tree @xmath105 and its signed contour @xmath187 , and choosing @xmath218 as a subset of @xmath219 , then condition   is always satisfied . indeed , all local minima of @xmath174 that are required to have the same sign correspond to the same internal vertex of @xmath96 .",
    "moreover , we have the signed equivalents of observations  [ obs : extractedtree = subtree ] and  [ obs : extractedtree = subtree_generalcase ] .",
    "[ obs : tree_pm ] let @xmath105 be a signed schrder tree and @xmath187 be its signed contour .",
    "let @xmath24 be a subset of the set of leaves of @xmath96 , and @xmath218 be the corresponding subset of @xmath219 .",
    "then @xmath232 , _",
    "i.e. _ , the signed tree extracted from @xmath218 in the signed contour of @xmath105 is defined and is the same as the signed subtree of @xmath105 induced by @xmath24 .",
    "[ obs : tree_pm_generalcase ] let @xmath184 be a signed excursion and @xmath193 be a set of @xmath8 points in @xmath79 $ ] .",
    "assume that @xmath233 is defined and let @xmath234 .",
    "let @xmath222 be a subset of @xmath218 , and let @xmath24 be the corresponding subset of the set of leaves of @xmath105 . then the signed tree extracted from @xmath222 in @xmath184 is defined and is the substree of @xmath105 induced by @xmath24 , _",
    "i.e. _ , @xmath235 .",
    "[ ex : sous - arbre - extrait ] for @xmath228 as in [ fig : extraction ] and @xmath236 , then @xmath237 \\node[circle , draw , inner sep=0pt ] { \\tiny $ + $ }    child { node[inner sep=0pt ] { ~ } }   child { node[inner sep=0pt ] { ~ } } ; \\end{scope}}\\end{array}$ ] .    getting to permutations , we can combine observations  [ obs : patterns_and_subtrees ] and  [ obs : tree_pm ] to obtain :    [ obs : functionperm = patterns ] let @xmath105 be a signed schrder tree , and @xmath184 be its signed contour . consider a subset @xmath24 of the set of leaves of @xmath96 , and denote by @xmath218 the corresponding subset of @xmath219 .",
    "we have : @xmath238    we consider the signed scrder tree @xmath105 from [ ex : schrodertree ] and the set @xmath110 .",
    "we have in this case @xmath239 .",
    "on the other hand , the construction of @xmath240 is illustrated on [ fig : extraction_from_signed_contour ] and also yields the permutation @xmath132 .",
    "another situation where we will extract a permutation from a signed excursion is the following .",
    "[ obs : brownian_satisfies_c ] let @xmath184 be a realization of the signed brownian excursion @xmath188 and @xmath218 be a set of @xmath8 points taken uniformly and independently at random in @xmath79 $ ] .",
    "then condition   is satisfied with probability @xmath60 for @xmath241 , and the extracted tree is binary ( see [ cor : onesided , lemma : minimumsamelevel ] in appendix ) .",
    "recall from the introduction that @xmath55 denotes the proportion of occurrences of @xmath19 in a uniform random separable permutation of size @xmath0 .",
    "our main result ( see theorem  [ thm : main].[item : main_distrib ] and [ item : main_joint ] p. ) is the ( joint ) convergence in distribution of @xmath55 towards a random variable @xmath59 that we now define .",
    "we denote by @xmath242 $ ] the characteristic function of an event @xmath243 .",
    "[ dfn : lambda_pi ] let @xmath19 be a pattern and @xmath188 be the signed brownian excursion .",
    "let also @xmath244 .",
    "let @xmath245 be @xmath8 uniform and independent points in @xmath79 $ ] , independent from @xmath188 and set @xmath246 .",
    "the random variable @xmath59 is defined by @xmath247 note that this may be rephrased as @xmath248\\ |\\ \\exc , s \\right)$ ] .",
    "more precisely , we define the infinite - dimensional random vector @xmath249 , indexed by _ all patterns @xmath19 of all sizes _ as follows : for each @xmath19 , let @xmath250 be a set of @xmath69 independent uniform random variables in @xmath79 $ ] , taken independently for different patterns @xmath19 , then we set @xmath251\\ \\right)_\\pi | \\exc , s   \\bigg ) .",
    "\\label{eq : def_lambda_pi_vecteur}\\ ] ] in this definition , and throughout the paper , the event `` @xmath252 '' should be understood as `` @xmath253 '' .    since the finite - dimensional marginals of @xmath254 appear in our main theorem , rather than the whole vector , let us write down explicitly the definition of these finite - dimensional laws : for any patterns @xmath255 ,  , @xmath256 we have @xmath257,\\ , \\dots , \\ , \\one[\\operatorname{perm}(\\exc , s,\\xx^{(\\pi_r)})= \\pi_r]\\big)\\ , |\\ \\exc , s \\bigg ) .",
    "\\label{eq : def_lambda_pi_finidim}\\ ] ]    note that in the definition of @xmath59 , we condition on the _ random variable _",
    "@xmath188 , so that @xmath59 is a random variable itself .",
    "moreover , in [ eq : def_lambda_pi_vecteur , eq : def_lambda_pi_finidim ] , all coordinates are defined by conditioning on the _ same realization _ @xmath188 .",
    "thus , the variables @xmath59 corresponding to different patterns @xmath19 are _ not independent_.    the reader less familiar with probability theory might be more comfortable with the following equivalent description of @xmath59 . for simplicity , we only discuss below the definition of the one - dimensional random variable @xmath59 ( for a fixed pattern @xmath19 ) , and not of the full infinite - dimensional vector @xmath249 .",
    "let us define a function @xmath258 on signed excursions as follows : @xmath259 where @xmath260 is a set of @xmath69 uniform and independent points in @xmath79 $ ] .",
    "then we set to be the image of the signed brownian excursion by @xmath258 .",
    "in other words , in [ eq : def_lambda_pi ] , the probability is taken with respect to @xmath260 , while we consider a realization of @xmath188 . in such situations",
    ", we will sometimes use a superscript on @xmath261 to record the source of randomness : namely we write [ eq : def_lambda_pi ] as @xmath262 similarly we use superscripts on expectation symbols @xmath263 to indicate the source of randomness .",
    "[ obs : expectation_of_expectation ] with this notation , we have the obvious compatibility relation : @xmath264 = \\esper^{\\exc , s,\\xx } \\big [ g(\\exc , s,\\xx ) \\big],\\ ] ] for any function @xmath265 such that these quantities are defined .",
    "if @xmath265 is the indicator function of an event @xmath243 , this can be rewritten as : @xmath266 = \\proba^{\\,\\exc , s,\\xx } \\big ( a   \\big).\\ ] ]    to finish this section , we discuss trivial cases of our main theorem , when @xmath19 is not separable and when @xmath19 is the permutation of size @xmath60 .",
    "[ rem : nonseparable ] observe that if @xmath19 is not a separable permutation , from [ prop : bbl ] it can not be obtained as @xmath267 and thus @xmath59 is identically equal to @xmath88 in this case .",
    "clearly , @xmath55 is also identically equal to @xmath88 in this case since a separable permutation can not have a non - separable pattern ( permutation classes are by definition downward - closed for the pattern relation ) .",
    "[ rem : motif1 ] if @xmath268 is the only permutation of size @xmath60 , then regardless of @xmath269 we have that @xmath267 is the permutation of size @xmath60 . consequently , @xmath59 is identically equal to @xmath60 in this case .",
    "similarly , @xmath55 is also identically equal to @xmath60 , since every element of a permutation is an occurrence of the pattern @xmath270 .",
    "thus our main theorem is vacuous in the special cases @xmath19 not separable or @xmath268 .      to prove the convergence of @xmath55 towards @xmath59 , it is useful to describe these two random variables in a similar manner .",
    "more precisely , we define a function @xmath271 in such a way that both @xmath55 and @xmath59 have a natural expression using @xmath271 . along the way",
    ", we also define a tree analogue @xmath272 of @xmath271 , which we shall use in the proof of theorem  [ thm : main].[item : main_joint ] . because both @xmath271 and @xmath272 take a distribution function among their arguments , we first give some basics on this topic .    a distribution function @xmath273 is a right - continuous non - decreasing function from @xmath274 to @xmath79 $ ] with @xmath275 and @xmath276 .",
    "a real - valued random variable @xmath277 has distribution function @xmath273 if , for all @xmath177 , one has : @xmath278 . in the sequel ,",
    "we only consider distribution functions @xmath273 such that @xmath279 and @xmath280 ( equivalently , the associated random variables have values in @xmath79 $ ] ) ; and we identify @xmath273 with its restriction on the domain @xmath79 $ ] .",
    "for such a distribution function @xmath273 , the pseudo - inverse @xmath281 of @xmath273 is : @xmath282 & \\to & [ 0,1]\\\\       & u      & \\mapsto & \\inf \\{x \\in [ 0,1 ] \\text { such that } f(x)\\geq u\\ } \\end{array}.\\ ] ] one can check that for all @xmath283 $ ] and @xmath284 , @xmath285 moreover , if @xmath286 is a uniform random variable on @xmath79 $ ] , then @xmath287 has distribution function @xmath273 .",
    "the following distribution functions will be of particular interest in this work .",
    "* the distribution function @xmath288 of the uniform distribution on @xmath79 $ ] is given by @xmath289 * with any tree @xmath96 with set of leaves @xmath290 ( @xmath175 ) , we associate its _ leaf distribution function _",
    "@xmath291 defined by @xmath292 } ,      \\label{eq : eqdfleaves}\\ ] ] where @xmath293}$ ] is @xmath60 if the condition is fulfilled and @xmath88 otherwise . by definition ,",
    "taking a random variable with distribution @xmath291 corresponds to choosing a leaf of @xmath96 uniformly at random ( more precisely the @xmath177-coordinate @xmath294 of the corresponding leaf in the normalized contour of @xmath96 ) .",
    "[ fig : leaf_distrib_function ] shows the leaf distribution function associated with the ( unsigned ) tree of [ fig : contour ] p ..    ( -0.1,0 )  ( 2.1,0 ) ; ( 0,-0.1 )  ( 0,1.1 ) ; at ( -0.08,-0.08 ) @xmath88 ; at ( 0.3,-0.15 ) @xmath295 ; at ( 0.5,-0.15 ) @xmath296 ; at ( 0.7,-0.15 ) @xmath297 ; at ( 1,-0.15 ) @xmath298 ; at ( 1.3,-0.15 ) @xmath299 ; at ( 1.6,-0.15 ) @xmath300 ; at ( 1.8,-0.15 ) @xmath301 ; at ( 2,-0.15 ) @xmath60 ; ( 0.3,-0.03 )  ( 0.3,0.03 ) ; ( 0.5,-0.03 )  ( 0.5,0.03 ) ; ( 0.7,-0.03 )  ( 0.7,0.03 ) ; ( 1,-0.03 )  ( 1,0.03 ) ; ( 1.3,-0.03 )  ( 1.3,0.03 ) ; ( 1.6,-0.03 )  ( 1.6,0.03 ) ; ( 1.8,-0.03 )  ( 1.8,0.03 ) ; ( 2,-0.03 )  ( 2,0.03 ) ; at ( -0.1,0.143 ) @xmath302 ; at ( -0.1,0.286 ) @xmath303 ; at ( -0.1,0.429 ) @xmath304 ; at ( -0.1,0.571 ) @xmath305 ; at ( -0.1,0.714 ) @xmath306 ; at ( -0.1,0.857 ) @xmath307 ; at ( -0.1,1 ) @xmath60 ; ( -0.03,0.143 )  ( 0.03,0.143 ) ; ( -0.03,0.286 )  ( 0.03,0.286 ) ; ( -0.03,0.429 )  ( 0.03,0.429 ) ; ( -0.03,0.571 )  ( 0.03,0.571 ) ; ( -0.03,0.714 )  ( 0.03,0.714 ) ; ( -0.03,0.857 )  ( 0.03,0.857 ) ; ( -0.03,1 )  ( 0.03,1 ) ; ( 0,0 )  ( 0.32,0 ) ; ( 0.3,0.143 )  ( 0.52,0.143 ) ; ( 0.5,0.286 )  ( 0.72,0.286 ) ; ( 0.7,0.429 )  ( 1.02,0.429 ) ; ( 1,0.571 ) ",
    "( 1.32,0.571 ) ; ( 1.3,0.714 ) ",
    "( 1.62,0.714 ) ; ( 1.6,0.857 ) ",
    "( 1.82,0.857 ) ; ( 1.8,1 ) ",
    "( 2,1 ) ; at ( 0,0 ) @xmath308 ; at ( 0.3,0.143 ) @xmath308 ; at ( 0.5,0.286 ) @xmath308 ; at ( 0.7,0.429 ) @xmath308 ; at ( 1,0.571 ) @xmath308 ; at ( 1.3,0.714 ) @xmath308 ; at ( 1.6,0.857 ) @xmath308 ; at ( 1.8,1 ) @xmath308 ; at ( 2,1 ) @xmath308 ; ( 0.3,0.143 ) ",
    "( 0.3,0 ) ; ( 0.5,0.286 ) ",
    "( 0.5,0 ) ; ( 0.7,0.429 ) ",
    "( 0.7,0 ) ; ( 1,0.571 ) ",
    "( 1,0 ) ; ( 1.3,0.714 ) ",
    "( 1.3,0 ) ; ( 1.6,0.857 ) ",
    "( 1.6,0 ) ; ( 1.8,1 ) ",
    "( 1.8,0 ) ; ( 2,1 ) ",
    "( 2,0 ) ; ( 0.3,0.143 ) ",
    "( 0,0.143 ) ; ( 0.5,0.286 ) ",
    "( 0,0.286 ) ; ( 0.7,0.429 ) ",
    "( 0,0.429 ) ; ( 1,0.571 ) ",
    "( 0,0.571 ) ; ( 1.3,0.714 ) ",
    "( 0,0.714 ) ; ( 1.6,0.857 ) ",
    "( 0,0.857 ) ; ( 1.8,1 ) ",
    "( 0,1 ) ;    the following lemma will be used in [ sec : signs , sec : continuity ] .",
    "[ lem : ff*pareil ] if @xmath273 is a distribution function , then @xmath309 .",
    "note that on @xmath79 $ ] , @xmath310}$ ] .",
    "choose @xmath311 $ ] .",
    "if @xmath312 then @xmath313 if on the contrary @xmath314 then write for a small @xmath284 @xmath315 and let @xmath316 .",
    "we now define @xmath317 and @xmath318 as follows .",
    "let @xmath319 be a tree with @xmath8 leaves , @xmath185 be an excursion and @xmath273 be a distribution function with @xmath279 and @xmath280 .",
    "let @xmath320 be independent random variables with distribution function @xmath273 and @xmath260 be the set @xmath321 .",
    "then @xmath317 is defined as the probability that @xmath322 .",
    "[ dfn : probtree ]    let @xmath19 be a permutation of size @xmath8 , @xmath184 be a signed excursion and @xmath273 be a distribution function with @xmath279 and @xmath280 .",
    "let @xmath320 be independent random variables with distribution function @xmath273 and @xmath260 be the set @xmath321 .",
    "then @xmath318 is defined as the probability that @xmath323 .",
    "[ dfn : probperm ]    note that in the above two definitions , if the event @xmath322 ( resp .",
    "@xmath323 ) is realized , then there is no repetition in @xmath320 .",
    "[ obs : lamba_from_prperm ] by definition , it follows that @xmath324 .",
    "let @xmath105 be a signed tree and @xmath325 be the corresponding permutation .",
    "let @xmath187 be the signed contour of @xmath105 and @xmath291 be the distribution function associated with @xmath96 .",
    "it holds that : @xmath326 where @xmath327 denotes the falling factorial @xmath328 .",
    "[ lem : ourprocess = proppatterns ]    let @xmath320 be independent random variables with distribution function @xmath291 ( in this case , @xmath329 is always defined  see [ obs : perm_is_defined ] ) .",
    "in other terms , we take @xmath8 leaves of @xmath96 independently uniformly at random .",
    "the probability that they are different is clearly @xmath330 .",
    "conditioned to that event , @xmath331 is a uniform subset of @xmath8 leaves of @xmath96 . from [ obs : functionperm = patterns ] , we have @xmath332 where @xmath24 is a uniform random @xmath8-element subset of @xmath100 $ ] . the probability that the right hand - side is equal to @xmath19 is by definition @xmath333 .",
    "thus @xmath334 which ends the proof .",
    "[ cor : occ_from_prperm ] recall that @xmath151 denotes a uniform random schrder tree with @xmath0 leaves , and @xmath153 the sign function on the internal vertices of @xmath151 , such that the signs alternate and the root of @xmath151 has a balanced sign .",
    "denote by @xmath191 the signed contour of @xmath190 . then @xmath335      our main result  the joint convergence in distribution of @xmath336 to @xmath59 , see theorem  [ thm : main].[item : main_joint] is proved in several steps starting from the expressions of @xmath336 and @xmath59 in terms of @xmath271 ( see [ obs : lamba_from_prperm ] and [ cor : occ_from_prperm ] ) .",
    "first , we prove the almost - sure convergence of @xmath337 to @xmath288 .",
    "informally , this states that choosing uniformly at random a leaf in @xmath151 ( or rather the corresponding @xmath177-coordinate in the normalized contour @xmath192 ) amounts in the limit to choosing a uniform point in @xmath79 $ ] .",
    "this is done in section  [ sec : leavesareuniform ] , using standard arguments involving conditioned random walks and concentration inequalities .    from there , a natural way to finish the proof would be to prove the convergence of @xmath191 to the signed brownian excursion , and the continuity of @xmath338 . as discussed in [ rem : cv_to_signedbrownianexc ] ,",
    "a major difficulty when trying to prove that @xmath191 converges to @xmath188 is that the signs on the local minima of @xmath192 are far from independent . instead of attacking this difficulty head - on ,",
    "we have developed a proof along a different line .",
    "recall that our goal is to prove the convergence in distribution of @xmath336 to @xmath59 .",
    "the main part of our proof is to show the convergence of @xmath336 to @xmath59 _ in expectation_. in section  [ sec : moments ] , we prove that this is enough to have convergence in distribution .",
    "indeed we shall see that all moments of @xmath59 are determined by expectations of @xmath339 , for larger permutations @xmath340 .",
    "moreover we shall see that a similar statement holds in the limit for @xmath336 .",
    "therefore , convergence of expectations implies convergence of all ( joint ) moments . and since the random variables are bounded by @xmath60 , convergence of ( joint ) moments implies ( multi - dimensional ) convergence in distribution , as we will explain in section  [ sec : moments ] .",
    "the goal of section  [ sec : continuity ] is to prove the convergence in distribution of the _ unsigned _ trees extracted from the normalized contour of a uniform schrder tree to the _ unsigned _ trees extracted from the brownian excursion .",
    "this is achieved by proving the continuity of @xmath341 , and using the convergence of @xmath192 to @xmath180 and the convergence of @xmath337 to @xmath288 .",
    "since this step does not involve signs , there is no major difficulty here .    in section  [ sec : signs ] , we return to signed objects , proving that the signs on extracted trees are balanced and independent .",
    "more precisely , we examine the signs of the internal vertices of a signed tree @xmath342 extracted from @xmath191 , and we prove that , when @xmath0 goes to infinity , these signs are balanced and independent . note that a similar statement for @xmath188 is obvious , because the signs are chosen balanced and independent in @xmath188 .",
    "the proof for @xmath191 involves the fact that the relative distances between the points of @xmath192 corresponding to the vertices of @xmath319 tend to infinity , and a subtree exchangeability argument .",
    "finally , we put all these results together in section  [ sec : main_proof ] , to conclude the proof of theorem  [ thm : main].[item : main_joint ] .",
    "more precisely , using sections  [ sec : continuity ] and [ sec : signs ] we show the convergence of @xmath336 to @xmath59 in expectation , which implies theorem  [ thm : main].[item : main_joint ] using section  [ sec : moments ] .",
    "with the notation of [ ssec : distribution_function ] , our goal is to prove the convergence of @xmath337 to @xmath288 . for this purpose ,",
    "we use a classical technique : we regard schrder trees of a given size as conditioned random walks and use concentration inequalities in the spirit of marckert and mokkadem  @xcite .      with a tree",
    "@xmath96 having @xmath98 vertices , we associate its _ depth first queue process _ ( or _ dfqp _ ) @xmath343 , defined as follows .",
    "* set @xmath344 ; * order the vertices @xmath345 of @xmath96 according to the first time they are met in the depth - first search ( see [ dfn : contour ] p. ) .",
    "* at time @xmath127 , for @xmath346 , @xmath347 .",
    "this process is also sometimes called the _",
    "lukasiewicz path _ of @xmath96 .",
    "note that the dfqp differs from the contour .",
    "figure  [ fig : dfqp ] shows an example of this construction .",
    "@xmath348    by construction @xmath343 has the following properties :    * for each @xmath349 , @xmath350 is non - negative , while @xmath351 . *",
    "leaves of @xmath96 are in bijection with steps @xmath352 in @xmath353 .    as explained for instance in  (",
    "* section 3.3 ) , if @xmath96 is a galton - watson tree , then the random process @xmath354 has the same distribution as a random walk with i.i.d .",
    "steps stopped when hitting @xmath352 :    let @xmath355 be a galton - watson tree with offspring distribution @xmath155 , and @xmath356 be i.i.d .",
    "random variables with @xmath357 for @xmath358 . set @xmath359",
    "the dfqp of @xmath355 has the same distribution as @xmath353 stopped when hitting @xmath352 .",
    "2 .   let @xmath360 be the random tree @xmath355 , conditioned to have @xmath0 leaves .",
    "the dfqp of @xmath360 has the same distribution as @xmath353 stopped when hitting @xmath352 and conditionned to hit @xmath352 for the first time at its @xmath0-th down step .",
    "[ prop : dfpq_is_crw ]    note that when the offspring distribution of @xmath355 has mean equal to @xmath60 , the random walk @xmath353 is centered , _",
    "i.e. _ , @xmath361=0 $ ] .",
    "since the only negative step of @xmath353 is @xmath352 , this ensures that @xmath353 hits @xmath352 with probability one .",
    "we apply now this construction to @xmath151 , a uniform random schrder tree with @xmath0 leaves . from now on",
    ", @xmath155 is the distribution of proposition  [ prop : schroeder_are_galton - watson ] ( p. ) . from proposition  [ prop : schroeder_are_galton - watson ]",
    ", @xmath151 has the same distribution as a galton - watson tree with offspring distribution @xmath155 conditioned to have @xmath0 leaves .",
    "consequently , the dfqp of @xmath151 has the same distribution as a conditioned random walk @xmath353 as above .",
    "recall from proposition  [ prop : schroeder_are_galton - watson ] that @xmath155 has mean @xmath60 , so that @xmath353 hits @xmath352 with probability @xmath60 .",
    "finally , we denote @xmath362 the conditioning event @xmath363 an estimate on its probability will be useful .",
    "let @xmath356 be i.i.d .",
    "random variables with @xmath357 for @xmath358 , and set @xmath359 .",
    "there exists a constant @xmath364 such that for @xmath0 large enough , @xmath365 [ prop : estimationmarcher ]    since @xmath366 s have zero mean and finite variance , [ prop : estimationmarcher ] is a consequence of    1 .   the local limit theorem ( * ? ?",
    "* chap.vii ) , 2 .   the hitting - time theorem ( * ? ? ? * theorem 3.14 ) .    for more details",
    "we refer the reader to @xcite .",
    "recall that @xmath151 denotes a uniform schrder tree with @xmath0 leaves .",
    "the goal of this section is to prove the following statement :    defining the random distribution function @xmath337 as in [ eq : eqdfleaves ] ( p. ) , almost surely it holds that : @xmath367 [ propleavesuniform ]    we first concentrate on the @xmath177-coordinates of _",
    "vertices_. for this , we adapt a result by marckert and mokkadem ( see section 3 in @xcite ) to our setting with a fixed number of leaves .",
    "we first recall their notation .",
    "let @xmath368 be the vertices of a schrder tree @xmath96 numbered via the depth first queue process . note that the vertices of @xmath96 are visited ( for the first time ) in the same order by the contour process",
    "@xmath369 .    for @xmath370 ,",
    "let @xmath371 be the @xmath177-coordinate of the first occurrence of vertex @xmath372 in the contour process @xmath369 . if @xmath372 is a leaf of @xmath177-coordinate @xmath111 ( in the normalized contour ) , then @xmath373 .",
    "for a real number @xmath374 $ ] we let @xmath375 be the largest integer @xmath376 such that @xmath377 : in other words , @xmath375 denotes the number of _ vertices _ visited by the contour process @xmath369 considered only up to @xmath378 ( for an example , see figure  [ fig : notationscontourzeta_m ] ) .    , since @xmath379 . ]",
    "the following lemma establishes that for large @xmath0 , @xmath177-coordinates of the vertices are uniformly distributed in @xmath380 $ ] .",
    "[ lem : unpeudegueu ] for every @xmath381 , we have , for @xmath0 large enough , @xmath382}\\left|\\zeta(x\\,\\ #",
    "t_n ) - x\\,\\#t_n\\right|\\geq n^{\\frac12+\\delta } \\right )   \\le e^{-n^\\delta}.\\ ] ]    this statement is essentially proved in @xcite ; see the last ten lines of the proof of their theorem 2 , p.1671 .",
    "the only difference is that here we condition on the number of leaves ( instead of the number of vertices ) .",
    "the adaptation of the proof is straightforward since the probability of the event @xmath362 on which we condition is of the same order : by proposition  [ prop : estimationmarcher ] we have @xmath383 .    from the definitions we have , for every schrder tree @xmath96 with @xmath0",
    "leaves : @xmath384 by definition of @xmath385 , @xmath386 if and only if @xmath387 . thus we can rewrite the above equation as @xmath388 as in proposition  [ prop : dfpq_is_crw ] , consider a random walk @xmath389 with i.i.d .",
    "steps @xmath390 , where @xmath357 , for all @xmath358 .",
    "for all integers @xmath391 , it holds that @xmath392 by standard concentration inequalities for the binomial distribution ( see for instance ( * ? ? ?",
    "* theorem 2.19 ) ) , we have for all @xmath393 , every @xmath381 and @xmath0 large enough @xmath394 therefore , the probability of the latter event conditioned on @xmath362 is smaller than for @xmath0 large enough .    on the other hand , from proposition  [ prop : dfpq_is_crw ]",
    "the random walk @xmath389 conditioned to @xmath362 and stopped when hitting @xmath352 has the same distribution as the depth first queue process of a uniform schrder tree @xmath151 with @xmath0 leaves . in this correspondence , steps @xmath352 in the random walk @xmath353 correspond to leaves in the tree @xmath151 .",
    "recall from  observation  [ obs : size_schroeder_tree ] ( p. ) that @xmath395 .",
    "therefore , for a uniform schrder tree @xmath151 we have for all @xmath396 , @xmath397 by the union bound , @xmath398 besides , the @xmath0-th down step of @xmath353 ( without any conditioning ) occurs at a time @xmath28 which is a sum of @xmath0 i.i.d .",
    "geometric random variables with mean @xmath399 .",
    "thus for large @xmath0 we have by a chernov bound @xmath400 in the correspondance between conditioned random walks and schrder trees , the time @xmath28 of the @xmath0-th down step of @xmath353 corresponds to the number of vertices @xmath401 of the tree . by the same conditioning argument as above , for a uniform schrder tree @xmath151 , @xmath402 we have now all the tools to complete the proof . combining [ eq : ftzeta , eq : concentrationnbfeuilles ] , we get @xmath403 } \\left| n\\ , f_{t}(x)-\\zeta(x \\ , \\#t_n ) ( 2-\\sqrt{2})\\right|>n^{\\frac12+\\delta}\\right)\\\\ \\leq e^{-n^\\delta}.\\ ] ] using [ lem : unpeudegueu ] , this yields @xmath403 } \\left| n\\ , f_{t}(x)- ( x \\ , \\#t_n ) ( 2-\\sqrt{2})\\right|>2n^{\\frac12+\\delta}\\right)\\\\ \\leq 2\\ , e^{-n^\\delta}.\\ ] ] we now use [ eq : concentrationtaille ] to conclude that @xmath403 } \\left| f_{t}(x)- x \\right|>3n^{-\\frac12+\\delta}\\right)\\\\ \\leq 3\\ , e^{-n^\\delta}.\\ ] ] the almost - sure convergence follows by a classical application of the borel - cantelli lemma .",
    "a statement close to [ propleavesuniform ] was proved by kortchemski ( * ? ? ?",
    "* corollary 3.3 ) .",
    "note however that the distribution function @xmath404 considered by kortchemski takes as argument the number ( or the proportion ) of vertices visited so far , while our function @xmath273 uses the @xmath177-coordinate in the ( normalized ) contour .",
    "[ lem : unpeudegueu ] enables precisely to go from one of this time parametrization to another .",
    "recall that , for each @xmath0 , @xmath54 denotes a uniform random separable permutation of size @xmath0 , and that we want to prove the convergence in distribution of the random variables @xmath55 to @xmath59 . since the random variables @xmath55 and",
    "the candidate limit @xmath59 are bounded by @xmath60 , ( multi - dimensional ) convergence in distribution is equivalent to convergence of ( joint ) moments .",
    "more precisely , theorem  [ thm : main].[item : main_joint ] ( p. ) is equivalent to the following statement :    [ thm : convjointmoments ] for any list of patterns @xmath405 ( possibly with repetitions ) , @xmath406 \\longrightarrow \\esper\\left [ \\prod_{i=1}^r \\lambda_{\\pi_i } \\right].\\ ] ]    assume that [ thm : convjointmoments ] holds . for a fixed pattern @xmath19 , the candidate limit @xmath59",
    "is bounded by @xmath60 ( see [ dfn : lambda_pi ] p. ) , thus all of its moments exist and are bounded by @xmath60 . from ( * ? ? ? * theorem 30.1 ) , this implies that @xmath59 is determined by its moments .",
    "therefore , from ( * ? ? ?",
    "* theorem 30.2 ) , the moment convergence @xmath407 \\to \\esper[\\lambda_\\pi^m]$ ] ( for all @xmath408 ) implies the convergence in distribution @xmath409 .",
    "fix now a list of patterns @xmath410 . to prove the multi - dimensional convergence in distribution @xmath411 ,",
    "it is enough to prove that for any @xmath412 , we have the unidimensional convergence in distribution @xmath413 see ( * ? ? ?",
    "* theorem 29.4 ) .",
    "but again , the right - hand side is bounded and hence determined by its moments ; moreover , [ thm : convjointmoments ] implies the convergence of moments , so that holds .",
    "therefore [ thm : convjointmoments ] implies [ thm : main].[item : main_joint ] , as claimed .",
    "consider now the converse implication and assume [ thm : main].[item : main_joint ] .",
    "we fix a list of patterns @xmath405 . by the mapping theorem ( * ? ? ?",
    "* theorem 29.2 ) , @xmath414 converges in distribution to @xmath415 . but these variables are uniformly bounded and hence uniformly integrable , so that the convergence also holds in expectation by ( * ? ? ?",
    "* theorem 25.12 ) .",
    "hence [ thm : main].[item : main_joint ] implies [ thm : convjointmoments ] .    instead of proving a convergence in distribution of random variables , we can therefore limit ourselves to proving a convergence of real numbers , which is a lot more tractable . to make our task even simpler , we show in [ cor : expectation_is_enough ] below that theorem  [ thm : convjointmoments ] follows if we prove , for all @xmath19 , the convergence of @xmath416 $ ] to @xmath417 $ ] .",
    "the key point is that @xmath418 can be expressed combinatorially as a linear combination of @xmath419 for larger patterns @xmath340 , and that the same relation holds between @xmath415 and the @xmath339 s .",
    "[ dfn : ordered_set - partition ] let @xmath340 be a permutation of size @xmath420 and @xmath46 be permutations such that @xmath421 .",
    "an ordered set - partition @xmath422 of @xmath423 is _ compatible _ with @xmath424 if for all @xmath127 , @xmath425 .",
    "let @xmath426 be the number of ordered set - partitions compatible with @xmath424 .",
    "we denote by @xmath427 the proportion of ordered set - partitions of @xmath423 which are compatible with @xmath424 .",
    "let @xmath428 , @xmath429 and @xmath430 .",
    "there are @xmath40 ordered set - partitions of @xmath431 which are @xmath432 , @xmath433 , @xmath434 , @xmath435 , @xmath436 , @xmath437 .",
    "let ( @xmath438,@xmath439 ) be one of the first four ordered pairs , then @xmath440 thus ( @xmath438,@xmath439 ) is not compatible with @xmath441 . on the contrary ,",
    "the last two pairs are compatible with @xmath441",
    ". then @xmath442 and @xmath443 .",
    "fix a list of patterns @xmath46 , and denote by @xmath420 the sum of their sizes .",
    "then @xmath444 [ prop : moments_in_terms_of_expectation_limit_case ]    we fix a realization @xmath188 of the brownian excursion all along the proof .",
    "the main idea to prove the equality in [ prop : moments_in_terms_of_expectation_limit_case ] is to show that both parts represent the probability of the same event .",
    "first we describe the event .",
    "we fix a list of patterns @xmath46 and we denote by @xmath420 the sum of their sizes .",
    "let us take @xmath420 independent uniform random variables in @xmath79 $ ] .",
    "we denote the @xmath445 first ones ( in the order of sampling ) by @xmath446 , the following ones @xmath447 , and so on until the @xmath448 last ones which are denoted @xmath449 .",
    "let @xmath450 for all @xmath127 and @xmath451 .",
    "the event we are considering is then : for each @xmath127 , @xmath452 . since @xmath188 is a fixed realization of the brownian excursion , all the probabilities below should be understood with respect to the random variables @xmath260 , as indicated by the notation @xmath453 .",
    "let @xmath454 .",
    "since the @xmath455 are independent , we have : @xmath456    it remains to prove that @xmath457 .",
    "we compute this probability by conditioning on the value of @xmath267 .",
    "since @xmath458 satisfies condition   ( p. ) with probability  @xmath60 ( see observation  [ obs : brownian_satisfies_c ] p. ) , the permutation @xmath267 is almost surely defined and has size  @xmath420 .",
    "thus @xmath459    by definition , @xmath460 , so we just need to prove that @xmath461 to finish the proof .",
    "consider a realization of the random variables @xmath260 .",
    "we say that @xmath462 has rank @xmath8 if it is the @xmath8-th smallest value among all variables of @xmath260 .",
    "then we can associate with @xmath260 an ordered set - partition of @xmath463 that we denote abusively @xmath464 and that is defined as follows : the @xmath127-th subset of @xmath464 is obtained from @xmath465 by replacing each @xmath462 by its rank .",
    "for example , @xmath466 since @xmath467 .",
    "let @xmath468 be the set of all ordered set - partitions of @xmath463 in @xmath103 subsets such that the @xmath127-th one has @xmath469 elements .",
    "then , by conditioning on the value of @xmath464 , we have @xmath470 recall that , by construction , @xmath471 . from observations  [ obs : tree_pm_generalcase ]",
    "( p. ) and",
    "[ obs : patterns_and_subtrees ] ( p. ) , @xmath472    in addition , we claim that @xmath464 is uniformly distributed in @xmath468 , that is , for each @xmath473 in @xmath468 , we have . indeed",
    "each possible relative order of the @xmath474 occurs with the same probability .",
    "moreover , the block sizes of ordered set - partitions in @xmath468 are prescribed : @xmath475 .",
    "therefore each ordered set - partition in @xmath468 corresponds to the same number of relative orders of the variables @xmath474 ; and this proves our claim .",
    "finally , we obtain that @xmath476 .",
    "thus @xmath457 , which concludes the proof .",
    "fix a list of patterns @xmath46 , and denote by @xmath420 the sum of their sizes .",
    "then for any permutation @xmath128 of size @xmath0 , @xmath477 the constant hidden in the @xmath478 symbol does depend on @xmath479 , but is uniform on @xmath4 .",
    "[ prop : moments_in_terms_of_expectation_discrete_case ]    let @xmath480 be the size of @xmath481 .",
    "we denote by @xmath482 the set of @xmath480-element subsets , @xmath24 , of @xmath1 $ ] such that @xmath483 .",
    "then @xmath484 we set @xmath485 .",
    "then @xmath486 note that the sets @xmath487 are disjoints : indeed @xmath488 .",
    "therefore , denoting @xmath489 , we have : @xmath490    we first study @xmath353 .",
    "let @xmath491 , and define @xmath492 .",
    "note that @xmath493 , and that the inequality is strict if and only if @xmath494 .",
    "consequently , it holds that @xmath495 .",
    "it follows that @xmath496 , where the constant hidden in the @xmath478 symbol depends on the @xmath480 s but not on  @xmath0 . since @xmath497 for some constant that depends on the @xmath480 s",
    "only , we obtain that @xmath498 , where the constant hidden in the @xmath478 symbol depends on the @xmath480 s only .",
    "we now study @xmath487 .",
    "each element of @xmath487 corresponds to an occurrence of @xmath340 in @xmath4 .",
    "conversely , a given occurrence of @xmath340 in @xmath4 may lead to one , several or no element(s ) of @xmath487 : this depends on the number of ways to partition the set of indices of @xmath4 corresponding to the occurrence of @xmath340 into an ordered sequence @xmath499 of @xmath103 sets such that each @xmath500 induces the pattern @xmath481 .",
    "the number of ways to do this ordered partition does not depend on the occurrence of @xmath340 that is considered , and there are by definition @xmath426 ways to do this partition .",
    "thus @xmath501    putting things together , @xmath502 by simple computations , we have @xmath503 , where again the constant hidden in the @xmath478 symbol depends on the @xmath480 s only .",
    "to conclude , we need to remark that the sum @xmath504 is bounded independently of @xmath0 ; indeed , each term @xmath505 is bounded by @xmath60 , and there are @xmath506 terms .",
    "it then follows that @xmath507 where the constant hidden in the @xmath478 symbol does depend on @xmath479 , but is uniform on @xmath4 .",
    "[ cor : expectation_is_enough ] theorem  [ thm : convjointmoments ] ( and therefore theorem  [ thm : main].[item : main_joint ] ) is equivalent to the following statement : @xmath508 \\longrightarrow \\esper\\left [ \\lambda_{\\pi } \\right ] .",
    "\\label{eq : cv_exp}\\ ] ] [ cor : exp_is_enough ]    we assume that eq",
    ".   holds .",
    "let @xmath479 be a list of patterns , and denote by @xmath420 the sum of their sizes .",
    "then , from [ prop : moments_in_terms_of_expectation_limit_case , prop : moments_in_terms_of_expectation_discrete_case ] , we have : @xmath509    = \\sum_{\\rho \\in \\sn_k } c_{\\pi_1,\\ldots,\\pi_r}^\\rho \\esper \\left [ \\operatorname{\\widetilde{occ}}(\\rho , \\si_n)\\right ] + o(1 )    = \\sum_{\\rho \\in \\sn_k } c_{\\pi_1,\\ldots,\\pi_r}^\\rho \\left(\\esper \\left [ \\lambda_\\rho \\right ] + o(1)\\right ) + o(1)\\\\    = \\sum_{\\rho \\in \\sn_k } c_{\\pi_1,\\ldots,\\pi_r}^\\rho \\esper \\left [ \\lambda_\\rho \\right ] + o(1 )    = \\esper\\left [ \\prod_{i=1}^r \\lambda_{\\pi_i } \\right ] + o(1).\\end{gathered}\\ ] ] note that to get the second line , we used that @xmath510 does not depend on @xmath0 .",
    "the above computations show that eq .   implies theorem  [ thm : convjointmoments ] .",
    "the next three sections focus on proving eq .  ; the proof will be completed in  [ thm : convexp ] .",
    "in this section , we prove the convergence in distribution of the trees extracted from the normalized contour of a uniform schrder tree to the trees extracted from the brownian excursion ( in the unsigned case ) . this result is stated in [ cor : prtree_cv_in_distribution ] .",
    "it follows easily from earlier results and a continuity property of @xmath272 ( defined in [ dfn : probtree ] p. ) that we establish in [ lem : continuityprobtree ] below .",
    "let us first set up some notation .",
    "fix a tree @xmath319 with @xmath8 leaves .",
    "we consider @xmath511 that is the map @xmath512 .",
    "we use the uniform topology ( that is , the topology induced by the supremum norm ) both on the set of excursions and on the set of distribution functions .    throughout the section ,",
    "if @xmath185 is an excursion and @xmath513 in @xmath79 $ ] , we denote @xmath514 } f$ ] .",
    "let @xmath515 be the reordering of @xmath8 uniform i.i.d .",
    "random variables in @xmath79 $ ] .",
    "we say that an excursion @xmath185 has the _ distinct minima property _",
    "if @xmath516 ,  , @xmath517 are distinct with probability @xmath60 ( the probability here is taken with respect to @xmath518 ) .",
    "let @xmath180 be the brownian excursion , then a.s .",
    "@xmath180 has the distinct minima property .",
    "[ lem : exc_dmp ]    this can be seen as a consequence of [ lem : tout_a_une_densite ] , but since this lemma uses a deep result of @xcite , let us give a more elementary proof .",
    "if @xmath180 is the brownian excursion , and @xmath519 is the reordering of @xmath8 i.i.d .",
    "uniform random variables in @xmath79 $ ] , then from [ cor : onesided ] with probability @xmath60 no @xmath366 is a one - sided minimum . when this is the case , for each @xmath127 , @xmath520 can not be reached on the extremities of the interval @xmath521 $ ] and is therefore a local minimum .",
    "consequently , using [ lemma : minimumsamelevel ] , the values @xmath516 ,  , @xmath517 are distinct , almost surely .",
    "let @xmath319 be a fixed tree with @xmath8 leaves .",
    "if @xmath185 is an excursion with the distinct minima property then @xmath511 is continuous in @xmath522 .",
    "[ lem : continuityprobtree ]    we prove that @xmath523 as soon as @xmath524 and @xmath525 .",
    "fix @xmath526 and consider an excursion @xmath265 and a distribution function @xmath355 with @xmath527 and @xmath528 .",
    "recall from [ lem : ff*pareil ] ( p. ) that @xmath529 and that @xmath530 is the identity on @xmath79 $ ] .",
    "let @xmath531 be the reordering of @xmath8 independent uniform random variables , and let @xmath532 .",
    "furthermore , set @xmath533 .",
    "note that @xmath534 is non - decreasing , so that @xmath535 .",
    "we write @xmath536 . by construction",
    "we have that :    * @xmath222 has the distribution of the reordering of @xmath8 i.i.d .",
    "random variables of distribution @xmath355 ; * and , for each @xmath127 , one has @xmath537 .",
    "it follows from @xmath527 that for all @xmath538 , @xmath539 .",
    "this implies that , for each @xmath538 , @xmath540 where @xmath541 is the modulus of continuity of @xmath185 defined by @xmath542 recall that @xmath199 is the tree extracted from the set of points @xmath218 on the excursion @xmath185 .",
    "we have @xmath543 above and in what follows , the randomness is only given by @xmath218 , the variables @xmath222 are functions of the @xmath218 s and hence random as well , while @xmath185 is non - random .",
    "we emphasize this by using the notation @xmath544 .    by construction ( see [ dfn : tree ] p. ) , the tree @xmath199 only depends on the relative order of @xmath545 .",
    "we denote @xmath546 the minimal difference between any two of these values .",
    "since @xmath185 is assumed to have the distinct minima property , @xmath546 is non - zero with probability @xmath60 .    from [ eq : conv_val_and_min ]",
    ", we see that @xmath547 are in the same relative order as @xmath545 as soon as @xmath548 .",
    "if this is the case , then @xmath549 . therefore , @xmath550 with [ eq : prob_diff_trees ] , this completes the proof .",
    "recall that the _ ( substitution ) decomposition tree _ of @xmath4 is the unique signed schrder tree @xmath105 in which the signs alternate such that @xmath551 . by [ cor : same_distibution_separables_trees ] ( p. ) , in the case where @xmath54 is a uniform random separable permutation of size @xmath0 ,",
    "then its ( unsigned ) decomposition tree is a uniform schrder tree with @xmath0 leaves , denoted @xmath151 all along the article .",
    "let @xmath54 be a uniform random separable permutation of size @xmath0 and @xmath552 be the normalized contour of its decomposition tree .",
    "we also define @xmath337 as usual ( see [ eq : eqdfleaves ] p. ) .",
    "let @xmath180 be the brownian excursion and @xmath183 .",
    "then , in distribution , @xmath553 [ propcvcf ]    from propositions [ prop : convergencecontour ] ( p. ) and [ propleavesuniform ] ( p. ) , we know that @xmath554 and @xmath555 .",
    "it remains to prove the joint convergence .",
    "note that the limit @xmath288 of @xmath337 is non - random .",
    "thus we want to use a theorem of billingsley ( * ? ? ?",
    "* theorem 3.9 ) that asserts that if @xmath556 and @xmath557 ( where @xmath558 and @xmath559 are random variables with values in a metric space @xmath560 , @xmath561 are random variables with values in a metric space @xmath562 and @xmath563 is a deterministic element of @xmath562 ) , then @xmath564 , _ provided that @xmath560 and @xmath562 are separable_.    the functions @xmath192 and the limit @xmath565 are random elements in the space @xmath181 $ ] of continuous functions on @xmath79 $ ] , which is known to be separable ( see ( * ? ? ?",
    "* example 1.3 ) ) . on the other hand , the functions @xmath337 and their limit @xmath288 live in the space @xmath562 of right - continuous functions on @xmath79 $ ] with left - sided limits that admits only a finite number of jumps at rational points .",
    "we clearly have @xmath566 \\times \\ccc[a_1,a_2 ] \\times \\cdots \\times \\ccc[a_k,1],\\ ] ] and hence @xmath562 is separable .",
    "note the space of right - continuous functions on @xmath79 $ ] with left - sided limits is not separable for the uniform topology , which explains why we used a more restricted space in the proof above .",
    "another option would have been to use the skorohod topology and the fact that when the candidate limit is continuous , convergence in uniform and skorohod topologies are equivalent .    for more details on uniform and skorohod topologies on the space of right - continuous functions with left - sided limits",
    "( including explanations of the above claims ) , we refer the reader to ( * ? ? ?",
    "* section 15 ) .",
    "[ cor : prtree_cv_in_distribution ] with the above notation , for any fixed @xmath319 , we have the convergence in distribution @xmath567 in particular , we have @xmath568      \\to       \\esper^\\exc \\big[\\operatorname{pr^{tree}}(\\patterntree;\\exc , f_u ) \\big].\\ ] ]    recall from [ propcvcf ] , that @xmath569 let @xmath570 $ ] be the set of excursions with the distinct minima property . from [ lem : exc_dmp ] , we know that @xmath571 the same of course holds , replacing @xmath180 by @xmath565 . but from [ lem : continuityprobtree ] , the set @xmath572 of discontinuity points of @xmath573 is included in the complement of @xmath574 and thus @xmath575 .",
    "therefore , using ( * ? ? ?",
    "* theorem 25.7 ) , eq .",
    "implies that @xmath576 the first part of the corollary follows , observing that @xmath317 is invariant by multiplication of the excursion @xmath185 by a scalar .",
    "since the variables in consideration take value in @xmath79 $ ] , convergence of distribution implies the convergence of expectations , which completes the proof .",
    "we now return to the study of signed trees .",
    "the purpose of this section is to justify that asymptotically ( when @xmath0 goes large ) the @xmath577 signs in the tree @xmath578 are independent and balanced , when @xmath579 is a @xmath8-element subset of the set of leaves of @xmath151 chosen uniformly at random :    [ prop : balanced_signs_discrete ] let @xmath54 be a uniform random separable permutation of size @xmath0 and @xmath342 be a signed binary tree of size @xmath8 . as usual",
    ", let @xmath191 be the signed contour of the decomposition tree of @xmath54 . we also consider a uniform random @xmath8-element subset @xmath579 of leaves of @xmath151 . then @xmath580    the proof is given at the end of the present section .",
    "the core of this proof is [ lem : balanced_heights ] below , regarding heights of branching points of marked leaves in uniform random schrder trees .",
    "we first introduce notation .",
    "recall that @xmath151 is a uniform schrder tree of size @xmath0 .",
    "we take a set of @xmath8 leaves of @xmath151 uniformly at random . as in definition",
    "[ dfn : leaves_coordinates ] ( p. ) , denote their @xmath177-coordinates by @xmath581 , and @xmath582 and let @xmath583 be the height of @xmath294 in @xmath151",
    ". for @xmath584 , denote by @xmath585 the height of the common ancestor of the leaves @xmath294 and @xmath586 ( defining the height as the distance from the root ) .",
    "[ lem : balanced_heights ] when @xmath63 , the parities of @xmath587 are asymptotically balanced , independent from each other and from the subtree @xmath319 induced by the @xmath8 leaves .",
    "more formally , we fix a binary tree @xmath319 with @xmath8 leaves and we condition on the event that the subtree of @xmath151 induced by @xmath579 is @xmath319 . for all @xmath588 , @xmath589 where @xmath590 means @xmath591 .",
    "the proof essentially relies on a subtree exchangeability argument .",
    "in order to give intuition we start by the case @xmath592 .    in this case",
    ", there is a unique binary tree with two leaves , so the conditioning is not relevant .",
    "we want to prove that the common ancestor of two leaves @xmath593 and @xmath594 , chosen uniformly at random in @xmath151 among all @xmath58-element subsets of leaves , has an even height with probability asymptotically @xmath595 .",
    "fix two integers @xmath596 .",
    "we consider the set @xmath597 of schrder trees @xmath96 with @xmath0 leaves , with two marked leaves @xmath593 and @xmath594 ( @xmath598 ) , such that @xmath593 has height @xmath599 .",
    "such a tree @xmath96 can be canonically described as follows :    * take a chain @xmath600 going from the root of @xmath96 to the first marked leaf . *",
    "then for each @xmath601 , glue a tree @xmath602 and a tree @xmath603 respectively on the left and on the right of @xmath604 .",
    "* one of the trees @xmath605 , say @xmath606 , contains the second marked leaf @xmath594 .",
    "then the vertex @xmath607 is the common ancestor of @xmath593 and @xmath594 and has height @xmath608 .    for every permutation @xmath609 of @xmath610 , replacing each pair @xmath611 by @xmath612 in the above decomposition provides a bijection from @xmath597 to itself .",
    "this bijection maps a tree with @xmath608 onto a tree with @xmath613 .",
    "applying this construction to our random tree @xmath151 with its two marked leaves , we get that for each @xmath614 with @xmath615 @xmath616 therefore , we obtain @xmath617 which goes to @xmath595 , as soon as @xmath618 goes to infinity in probability .",
    "this will be proved in [ lem : hauteurfeuille ] below .",
    "we now prove [ lem : balanced_heights ] in the general case @xmath619 .",
    "since the proof uses a lot of notation , the reader is invited to look regularly at [ fig : schemapreuveechangeabilite ] , which illustrates the main definitions .",
    "@xmath620    we fix @xmath619 and a binary tree @xmath319 with @xmath8 leaves .",
    "we denote by @xmath621 the set of schrder trees of size @xmath0 with @xmath8 marked leaves @xmath622 which induce the subtree @xmath319 .",
    "for such a tree @xmath96 , each vertex @xmath102 in @xmath319 corresponds to a vertex @xmath623 in @xmath96 : @xmath623 is either one of the marked leaves of @xmath96 ( if @xmath102 is a leaf of @xmath319 ) or a common ancestor of two marked leaves of @xmath96 ( if @xmath102 is an internal vertex of @xmath319 ) .",
    "we denote by @xmath624 the height of @xmath623 in @xmath96 .",
    "we fix an internal vertex @xmath102 of @xmath319 .",
    "define @xmath625 as the left child of @xmath102 in @xmath319 and @xmath626 as the parent of @xmath102 . for @xmath96 in @xmath621 ,",
    "the distance between @xmath627 and @xmath628 is @xmath629 .",
    "( if @xmath102 is the root , then @xmath626 is not defined and we shall think of @xmath628 as a virtual new root of @xmath96 that is an ancestor of every vertex in @xmath96 and has height @xmath352 ; in particular , we take @xmath630 . )    the vertices of @xmath319 ( both leaves and internal vertices , @xmath102 excluded ) are partitioned in two sets : the right subtree @xmath631 of @xmath102 and its complement set @xmath632 . for a sequence of heights @xmath633 ,",
    "we define @xmath634 note that , for every @xmath96 in this set , @xmath635 ; we denote this common value by @xmath636 .",
    "( if @xmath102 is the root of @xmath319 , we set @xmath637 . )",
    "similarly to the decomposition in the case @xmath592 , each tree in @xmath638 can be decomposed as follows .    *",
    "a chain @xmath639 going from @xmath628 to @xmath627 .",
    "* for each @xmath640 , a tree @xmath602 and a tree @xmath603 respectively on the left and on the right of @xmath641 .",
    "* one of the trees @xmath605 , say @xmath606 , contains @xmath642",
    ". then the vertex @xmath643 is @xmath623 and has height @xmath644 . * a `` top tree '' which consists of the offspring of @xmath627 . *",
    "all others vertices of @xmath96 form a connected subtree called the `` bottom tree '' .",
    "( if @xmath102 is the root of @xmath319 , there is no bottom tree . )    for every permutation @xmath609 of @xmath645 , replacing each pair @xmath611 by @xmath612 in the above decomposition provides a bijection from @xmath638 to .",
    "clearly , this bijection maps a tree with @xmath646 onto a tree with .",
    "we now work with a uniform schrder tree @xmath151 of size @xmath0 with @xmath8 marked leaves , and we condition on the fact that these leaves induce the subtree @xmath319 .",
    "we use the notation @xmath647 .",
    "the above discussion implies that for every @xmath648 we have , @xmath649 therefore @xmath650 we introduce a subset @xmath651 of @xmath621 of _ well - behaved _ trees @xmath652 we will prove in [ lem : hauteurfeuille ] that for all @xmath102 , @xmath653 .    note that if @xmath654 is such that @xmath655 , then @xmath656 as a consequence , we have @xmath657 where the error term @xmath658 is bounded independently of @xmath654 , provided that @xmath655 .",
    "internal vertices of @xmath319 can be canonically indexed by @xmath659 : @xmath660 is the common ancestor of @xmath294 , @xmath586 . by definition , @xmath661 and we denote .",
    "fix @xmath662 . for @xmath663",
    "the vertex @xmath372 lies in @xmath664 , so that the fact that @xmath151 belongs to @xmath665 determines the random variables @xmath666 .",
    "clearly , this also determines whether @xmath151 belongs to @xmath667 or not .",
    "consequently for all @xmath668 , the event @xmath669 can be written as a disjoint union ( on @xmath654 ) of events of the form @xmath670 .",
    "[ eq : presqueundemi ] yields @xmath671 furthermore , since @xmath672 from [ lem : hauteurfeuille ] , we have @xmath673 for any event @xmath243 . using this twice , we obtain @xmath674 repeating this argument @xmath675 times concludes the proof .    it remains to prove that with high probability a uniform schrder tree @xmath151 is _ well - behaved _ : the heights @xmath583 of marked leaves and @xmath676 of their common ancestors and the distances @xmath677 and @xmath678 are all larger than @xmath679 ( in fact larger than @xmath680 for all @xmath681 ) .",
    "[ lem : hauteurfeuille ] we re - use the notation of the proof of [ lem : balanced_heights ] . in particular , @xmath651 denotes the set of trees @xmath96 in @xmath621 such that @xmath682 .",
    "for all internal vertices @xmath102 of @xmath319 , @xmath683    in the special case where @xmath684 \\node[circle , draw , inner sep=1pt ] { }    child { node[inner sep=0pt ] { ~ } }   child { node[inner sep=0pt ] { ~ } } ; \\end{scope}}\\end{array}$ ] ( i.e. @xmath592 ) , every pair @xmath685 of marked leaves of a schrder tree with @xmath686 leaves induces @xmath319 , and the height of @xmath593 goes to infinity in probability when @xmath687 .",
    "first , [ cor : prtree_cv_in_distribution ] gives the probability of the conditioning event in the limit : @xmath688 where @xmath689 is a set of @xmath8 i.i.d uniform random variables in @xmath79 $ ] . from [ lemma : arbrebinaireuniforme ] , we know that this quantity is strictly larger than @xmath88 .",
    "therefore it is enough to prove that without the conditioning .    by definition , for each internal vertex @xmath102 in @xmath319 , @xmath690 is one of the following :    * the height @xmath583 of a marked leaf ; * the height @xmath585 of the common ancestor of two marked leaves ; * the difference of heights @xmath677 between two common ancestors ; * the difference of heights @xmath678 between a leaf and a common ancestor .",
    "thus the first statement of the lemma will follow if we show that @xmath691 actually , we prove the stronger statement that for any two @xmath136 , all sequences of random variables @xmath692 converge in distribution to positive random variables .",
    "we will only write the details for the sequence @xmath693 , the proof being identical in the other cases . recall that the @xmath177-coordinate of @xmath694 has the same distribution as @xmath695 , where    * @xmath696 is the @xmath127-th smallest value among @xmath8 i.i.d .",
    "uniform random variables in @xmath79 $ ] .",
    "* @xmath697 is defined in [ eq : pseudoinverse , eq : eqdfleaves ] ( p. ) and is shown in [ lem : ff*pareil , propleavesuniform ] ( p. ) to be close to @xmath177 for large @xmath0 ;    by construction we have ( in what follows @xmath192 is the normalized contour function of @xmath151 , and the @xmath698 s are independent from @xmath192 ) : @xmath699}\\sqrt{n}\\times \\widetilde{c_{t_n}}\\quad \\text { and thus } \\quad   \\left| \\frac{m_i}{\\sqrt{n } } - \\min_{[u_{i},u_{i+1 } ] } \\widetilde{c_{t_n } } \\right| \\leq \\omega(\\widetilde{c_{t_n}},\\delta_n)\\end{aligned}\\ ] ] where @xmath700 and @xmath541 is the modulus of continuity already defined in [ eq : def_modulus_continuity ] ( p. )",
    ". it follows that @xmath701 } \\widetilde{c_{t_n } } -\\min_{[u_{j},u_{j+1 } ] } \\widetilde{c_{t_n}}\\big| \\right| \\leq 2\\omega(\\widetilde{c_{t_n}},\\delta_n).\\label{eq : majorationhihj}\\end{aligned}\\ ] ]    but from [ lem : ff*pareil , propleavesuniform ] , @xmath702 .",
    "moreover , the sequence of random functions @xmath703 converges in @xmath704)$ ] from [ prop : convergencecontour ] ( p. ) and therefore is tight , implying that @xmath705 ( see ( * ? ? ?",
    "* theorem 7.3 ) ) .",
    "now , for every deterministic @xmath706 in @xmath79 $ ] , we have @xmath707 } \\widetilde{c_{t_n } } -\\min_{[u_{j},u_{j+1 } ] } \\widetilde{c_{t_n}}\\big|\\stackrel{(d)}{\\to } \\lambda \\big|\\min_{[u_{i},u_{i+1 } ] } \\exc -\\min_{[u_{j},u_{j+1 } ] } \\exc\\big|\\ ] ] by [ prop : convergencecontour ] .",
    "we now integrate @xmath708 with respect to the joint distribution of @xmath709 and get ( here",
    "we use the fact that the @xmath698 s are independent from the contour ) @xmath710 } \\widetilde{c_{t_n } } -\\min_{[u_{j},u_{j+1 } ] } \\widetilde{c_{t_n}}\\big|\\stackrel{(d)}{\\to } \\lambda \\big|\\min_{[u_{i},u_{i+1 } ] } \\exc -\\min_{[u_{j},u_{j+1 } ] } \\exc\\big|,\\ ] ] and the right - hand side is non - zero a.s . from [ lem : tout_a_une_densite ] .",
    "this concludes the proof that @xmath711 converges in distribution to a non - zero random variable and hence completes the proof of the first statement of [ lem : hauteurfeuille ] .    in particular",
    ", we have proved that @xmath618 goes to infinity in probability when @xmath687 .",
    "the second statement of the lemma is just a rephrasing of this , in the particular case where @xmath684 \\node[circle , draw , inner sep=1pt ] { }    child { node[inner sep=0pt ] { ~ } }   child { node[inner sep=0pt ] { ~ } } ; \\end{scope}}\\end{array}$ ] .",
    "let @xmath54 be a uniform separable permutation of size @xmath0 . from [ cor :",
    "same_distibution_separables_trees ] ( p. ) , it has the same distribution as @xmath154 where @xmath151 is a uniform schrder tree with @xmath0 leaves and @xmath153 is the sign function on the internal vertices of @xmath151 , such that the signs alternate and such that the root @xmath103 of @xmath151 has a balanced sign : @xmath712 with probability @xmath595 . recall that @xmath192 ( resp .",
    "@xmath191 ) denotes the normalized contour of @xmath151 ( resp .",
    "the signed contour of @xmath190 ) .",
    "as in the statement of the proposition , consider a uniform random @xmath8-element subset @xmath579 of leaves of @xmath151 .",
    "recall from observations  [ obs : extractedtree = subtree ] and  [ obs : tree_pm ] that @xmath713 ( resp .",
    "@xmath714 ) is the subtree of @xmath151 ( resp .",
    "the signed subtree of @xmath190 ) induced by these leaves .",
    "we condition on the fact that @xmath715 .",
    "it is enough to prove that the probability that the signs in @xmath714 coincide with a fixed sign function @xmath106 on the internal vertices of @xmath319 is @xmath716 .",
    "recall that the signs in @xmath714 correspond to signs of the common ancestors of the marked leaves in @xmath190 .",
    "we further condition on the fact that the root of @xmath151 has sign @xmath137 .",
    "then a vertex in @xmath151 has sign @xmath137 if it has even height and sign @xmath138 if it has odd height .",
    "therefore the probability that the common ancestors have given signs correspond to the probability that their heights have given parities .",
    "this probability is @xmath716 by [ lem : balanced_heights ] .",
    "the same holds if we had conditioned on the fact that the root of @xmath151 has sign @xmath138 .",
    "we can therefore conclude , that , conditioning only on the event @xmath715 , the probability that the common ancestors have given signs is @xmath716 , which completes the proof of the proposition .",
    "in this section we prove that the convergence of the expectation for @xmath272 implies the one of the expectation for @xmath271 . in order to do that , the expectation for @xmath271 is expressed in terms of the one for @xmath272 ( as a linear combination ) in the continuous and discrete cases .",
    "this is possible since the signs are balanced and independant as it has been proven in proposition  [ prop : balanced_signs_discrete ] .",
    "[ lem : expectation_tree_to_perm_continuous ] let @xmath19 be a pattern of size @xmath8 and @xmath188 be the signed brownian excursion .",
    "@xmath717 = \\frac{1}{2^{k-1 } } \\sum_{(\\patterntree,\\eps ) } \\esper^\\exc \\left [   \\operatorname{pr^{tree}}(\\patterntree;\\exc , f_u)\\right ] , \\ ] ] where the sum runs over all signed binary trees @xmath718 of @xmath19 .    by definition ,",
    "@xmath719 where @xmath260 is a set of @xmath8 independent uniform variables in @xmath79 $ ] .",
    "thus , with observation  [ obs : expectation_of_expectation ] ( p. ) , @xmath720   = \\proba^{\\,\\exc , s,\\xx } (   \\operatorname{perm}(\\exc , s,\\xx ) = \\pi ) .\\ ] ] since @xmath721 this is exactly the probability that @xmath722 is equal to one of the signed trees that are pre - images of @xmath19 by @xmath139 . in other terms ,",
    "@xmath720 =      \\sum_{(\\patterntree,\\eps ) } \\proba^{\\,\\exc , s,\\xx}\\big ( \\operatorname{tree}_{\\pm}(\\exc , s,\\xx ) = ( \\patterntree,\\eps ) \\big),\\ ] ] where the sum runs over all signed trees of @xmath19 . from [ obs : distinctminimpliesbinary ] ( p. ) , if @xmath723 is not binary , then @xmath724 has probability @xmath88 , since from [ lemma : minimumsamelevel ] a.s .",
    "all minima of @xmath180 have distinct values .",
    "consequently , in this case @xmath725 has also probability @xmath88 , and the sum above can be restricted to the signed _ binary _ trees of @xmath19 . for each",
    "such signed binary tree @xmath342 , we have @xmath726 indeed , signs are taken independently on local minima of @xmath180 and thus on vertices of @xmath319 .",
    "finally , with observation  [ obs : expectation_of_expectation ] again , the probability on the right hand - side is @xmath727= \\esper^{\\exc } \\big [ \\operatorname{pr^{tree}}(\\patterntree;\\exc , f_u)\\big ] ,      \\label{eq : expinprobforprtree}\\ ] ] which ends the proof .    using proposition  [ prop : balanced_signs_discrete ]",
    ", we obtain a discrete analogue of this lemma :    let @xmath19 be a pattern of size @xmath8 and @xmath54 be a uniform random separable permutation of size @xmath0 . as usual , let @xmath191 be the signed contour of the decomposition tree of @xmath54 . @xmath728      = \\frac{1}{2^{k-1 } } \\sum_{(\\patterntree,\\eps ) } \\esper^{\\si_n } \\left [   \\operatorname{pr^{tree}}(\\patterntree;\\widetilde{c_{t_n}},f_{t_n})\\right ] + o(1),\\ ] ] where the sum runs over all signed binary trees @xmath718 of @xmath19 .",
    "[ lem : expectation_tree_to_perm_discrete ]    let @xmath260 be a set of @xmath8 independent variables taken with distribution @xmath337 .",
    "remember that this amounts to choosing @xmath8 leaves of @xmath151 independently and uniformly at random . using an argument similar to that in the previous proof",
    ", we have @xmath728 =   \\sum_{(\\patterntree,\\eps ) }   \\proba^{\\si_n , \\xx}\\big ( \\operatorname{tree}_{\\pm}(\\widetilde{c_{t_n}},s_n,\\xx ) = ( \\patterntree,\\eps ) \\big ) ,   \\label{eq : esperprobpermfinite_sumtrees}\\ ] ] where the sum runs over all signed trees @xmath718 of @xmath19 .",
    "it holds that @xmath729 and @xmath730 = \\esper^{\\si_n } \\big [ \\operatorname{pr^{tree}}(t_0;\\widetilde{c_{t_n}},f_{t_n})\\big].\\end{gathered}\\ ] ] if @xmath723 is not binary , using [ cor : prtree_cv_in_distribution ] ( p. ) , we further have @xmath731 \\to   \\esper^e \\big [   \\operatorname{pr^{tree}}(t_0;e , f_u ) \\big]=0.\\ ] ] recall indeed that , since a.s .",
    "all minima of @xmath180 have distinct values from [ lemma : minimumsamelevel ] , the trees extracted from @xmath180 at uniformly distributed points are binary with probability @xmath60 .",
    "therefore the sum in [ eq : esperprobpermfinite_sumtrees ] can be replaced by a sum over signed _ binary _ trees @xmath718 of @xmath19 , making only an error of @xmath658 . for signed binary trees",
    "@xmath718 , we use proposition  [ prop : balanced_signs_discrete ] ( p. ) to derive that @xmath732 finally , since @xmath733 = \\esper^{\\si_n } \\big [ \\operatorname{pr^{tree}}(\\patterntree;\\widetilde{c_{t_n}},f_{t_n})\\big],\\ ] ] this ends the proof .    using these expressions of the expectation for @xmath271 in terms of the one for @xmath272 in the continuous and discrete cases",
    ", we can now prove our main result :    for any pattern @xmath19 , @xmath734 \\longrightarrow \\esper\\left [ \\lambda_{\\pi } \\right].\\ ] ] [ thm : convexp ]    from [ cor : prtree_cv_in_distribution ] , we have that , for each tree @xmath319 , @xmath735   \\to",
    "\\esper^\\exc \\big [ \\operatorname{pr^{tree}}(\\patterntree;\\exc , f_u ) \\big].\\ ] ] combining this with [ lem : expectation_tree_to_perm_continuous , lem : expectation_tree_to_perm_discrete ] , we get that for each pattern @xmath19 , @xmath728   \\to \\esper^{\\exc , s } \\big [   \\operatorname{pr^{perm}}(\\pi;e , s , f_{u } ) \\big].\\ ] ] from [ cor : occ_from_prperm ] ( p. ) , @xmath736 .",
    "together with observation  [ obs : lamba_from_prperm ] ( stating that @xmath737 ) , this ends the proof of [ thm : convexp ] .",
    "as shown by corollary  [ cor : exp_is_enough ] ( p. ) , theorems  [ thm : convjointmoments ] and  [ thm : main].[item : main_joint ] follow from theorem  [ thm : convexp ] above .",
    "the goal of this section is to prove [ thm : main_permuton ] ( p. ) .",
    "we first need additional material on permutons .",
    "recall from [ dfn : permuton ] that permutons , which were introduced in @xcite , are probability measures on @xmath79 ^ 2 $ ] with uniform marginals . given a permuton @xmath80 and an integer @xmath8",
    ", there is a natural way to define a random permutation @xmath738 of size @xmath8 .",
    "[ dfn : cv_permutons ] let @xmath80 be a permuton and @xmath8 be an integer .",
    "take @xmath8 points in @xmath79 ^ 2 $ ] independently according to @xmath80 .",
    "these @xmath8 points have distinct @xmath177-coordinates and distinct @xmath391-coordinates ( since @xmath80 has uniform marginals ) .",
    "therefore we can order these points @xmath739 such that @xmath740 .",
    "then @xmath738 is the unique permutation such that @xmath741 .    for a permutation @xmath19 of size @xmath8 ,",
    "following the notation of @xcite , we then define @xmath742 as the probability that @xmath743 .",
    "we say that a ( deterministic ) sequence of permutations @xmath744 with sizes going to infinity converges to the permuton @xmath80 if , for all @xmath19 , @xmath745 tends to @xmath742 .",
    "it is noticed in ( * ? ? ?",
    "* eq.(49 ) ) that the convergence of @xmath744 to a permuton @xmath80 is equivalent to the weak convergence of the associated permutons @xmath746 to @xmath80 . in particular , this implies the uniqueness of limits of sequences of permutations .",
    "moreover from ( * ? ?",
    "* theorem 1.6 ( i ) ) if @xmath744 is a deterministic sequence of permutations such that @xmath745 has a limit for all @xmath19 , then there exists a ( necessarily unique ) permuton @xmath80 such that @xmath747 tends towards @xmath80",
    ".    we can now proceed to the proof of [ thm : main_permuton ] .",
    "[ item : main_joint ] in [ thm : main ] asserts that the finite - dimensional laws of @xmath748 converge to those of @xmath749 ( here , vectors are indexed by all permutations ) .",
    "this is equivalent to the convergence in distribution of the infinite - dimensional vector @xmath748 towards @xmath749 in the product topology ( from the definitions of the convergence in distribution and of the product topology ) . from skorohod",
    "s representation theorem ( * ? ? ?",
    "* theorem 3.30 ) , there exists a probability space @xmath750 , random variables @xmath751 and @xmath752 such that :    1 .   for each @xmath753 , @xmath754 is a random vector @xmath755 indexed by all permutations that has the same law as @xmath748 ; 2 .",
    "@xmath752 is a random vector @xmath756 indexed by all permutations that has the same law as @xmath749 ; 3 .",
    "[ item : conv_ps ] we have sure convergence ( in the product topology ) of @xmath754 to @xmath752 when @xmath0 tends to infinity , _",
    "i.e. _ , for any @xmath757 , we have @xmath758    we now aim at constructing random variables @xmath759 such that @xmath760 , so that we can apply theorem 1.6 ( i ) of @xcite in each @xmath757 .",
    "fix @xmath761 .",
    "since @xmath755 and @xmath748 have the same distribution , one can assume that they have the same image set .",
    "thus , for any @xmath541 in @xmath750 , @xmath762 is equal to @xmath763 for some permutation @xmath128 of size @xmath0 that we denote @xmath764 .",
    "this defines a sequence of random permutations @xmath759 defined on the probability space @xmath750 such that @xmath760 .",
    "next , we claim that for any fixed @xmath0 , @xmath759 has the same distribution as @xmath54",
    ". indeed , @xmath0 being fixed , considering the restriction of @xmath748 ( resp .",
    "@xmath765 ) to patterns @xmath19 of size @xmath0 gives the distribution of @xmath54 ( resp .",
    "@xmath759 ) .",
    "the claim then follows since @xmath748 and @xmath765 have the same distribution ( both the same as that of @xmath755 ) .    from [ item : conv_ps ] above , and by definition of @xmath759 , for any @xmath757 , the following holds : @xmath766 using ( * ? ? ?",
    "* theorem 1.6 ( i ) ) , this implies that , for any @xmath757 , there exists a ( unique ) permuton @xmath767 such that @xmath764 tends to @xmath767 in the sense of [ dfn : cv_permutons ] , or equivalently @xmath768 converges weakly to @xmath767 . since sure",
    "convergence implies convergence in distribution and since @xmath759 and @xmath54 have the same distribution , we deduce that @xmath91 tends in distribution to @xmath90 in the weak convergence topology , as claimed .",
    "finally , it should be noted that by construction , for any @xmath19 , @xmath769 , using the notation @xmath96 from [ dfn : cv_permutons ] , since both are the limit in distribution of @xmath55 . since from theorem",
    "[ thm : main].[item : main_variance ] @xmath76 is not deterministic , neither is @xmath90 .",
    "in this section , we give some additional results concerning the limit variables @xmath59 . these results are not needed in the proof of our main theorem ( [ thm : main].[item : main_joint ] ) . however , the more information we have on @xmath59 , the more interesting our theorem is .",
    "the first result , given in [ ssec : exp_lpi ] , is a way of computing ( joint ) moments of the variables @xmath59 .",
    "this has been used in the introduction to give explicit values for the limit of ( joint ) moments of @xmath55 .",
    "our second result presented in [ ssec : variance ] is the fact that the variables @xmath59 are not deterministic when @xmath19 is separable .",
    "this corresponds to [ item : main_variance ] in [ thm : main ] .",
    "recall that @xmath71 denotes the number of signed binary trees associated with the permutation @xmath19 .    for any permutation @xmath19 of size @xmath8 ,",
    "@xmath734 \\longrightarrow \\esper\\left [ \\lambda_{\\pi } \\right ] = \\frac{n_\\pi } { 2^{k-1 } \\cdot \\operatorname{cat}_{k-1}}.\\ ] ] [ prop : expectation_lamdba_pi ]    for any @xmath19 , the convergence of @xmath770 $ ] to @xmath771 $ ] is given by  [ thm : convexp ] ( p. ) .",
    "let @xmath19 be a permutation of size @xmath8 and let us prove that @xmath771 = \\frac{n_\\pi}{2^{k-1 } \\cdot \\operatorname{cat}_{k-1}}$ ] .",
    "we consider the signed brownian excursion @xmath188 .",
    "we take @xmath8 points @xmath772 in @xmath79 $ ] uniformly at random , independently from each other and from @xmath188 , and we let @xmath773 . from [ lem : expectation_tree_to_perm_continuous ] ( see also [ eq : expinprobforprtree ] in its proof ) , we have @xmath717 =   \\frac{1}{2^{k-1 } } \\sum_{(\\patterntree,\\eps ) }       \\proba^{\\,\\exc,\\xx}\\big ( \\operatorname{tree}(\\exc,\\xx)=\\patterntree ) , \\ ] ] where the sum runs over all signed binary trees @xmath718 of @xmath19 .",
    "[ lemma : arbrebinaireuniforme ] , a deep result on brownian excursion , states that @xmath774 is a uniform binary tree with @xmath8 leaves , _",
    "i.e. _ , for any binary tree @xmath723 with @xmath8 leaves , @xmath775 the proposition then follows immediately .",
    "in addition , @xmath71 , the number of signed binary trees of a given permutation @xmath19 , can be expressed combinatorially from the decomposition tree of @xmath19 . more precisely :    [ obs : n_pi ] for any permutation @xmath19 , denoting @xmath776 its ( unique ) decomposition tree , it holds that @xmath777 where @xmath778 is the number of children of @xmath102 .",
    "given a signed tree of @xmath19 , and a vertex @xmath102 with sign @xmath106 in this tree , the following transformation produces a tree which is still a signed tree of @xmath19 : assuming that @xmath8 subtrees @xmath779 are attached to @xmath102 , replace @xmath102 by a binary tree with @xmath8 leaves and all internal vertices labeled @xmath106 and where the @xmath127-th leaf is replaced by @xmath780 .",
    "conversely , each signed binary tree of @xmath19 can be obtained from the decomposition tree @xmath776 of @xmath19 applying this transformation on all internal vertices @xmath102 of @xmath776 .",
    "an example is given in [ fig : form_100euros ] .",
    "and its @xmath781 signed binary trees.,width=453 ]    [ prop : computing_moments ] let @xmath46 be a list of patterns , and let @xmath782 .",
    "we have : @xmath406 \\longrightarrow \\esper\\left [ \\prod_{i=1}^r \\lambda_{\\pi_i } \\right]= \\sum_{\\rho \\in \\sn_k } c_{\\pi_1,\\ldots,\\pi_r}^\\rho \\esper \\left [ \\lambda_\\rho \\right],\\ ] ] where for any @xmath783 , @xmath784 denotes the proportion of ordered set - partitions of @xmath423 which are compatible with @xmath424 ",
    "see  [ dfn : ordered_set - partition ] p ..    see the proof of  [ cor : expectation_is_enough ] for the convergence result , and [ prop : moments_in_terms_of_expectation_limit_case ] for the expression of @xmath785 $ ] .",
    "the results of this section enable the automatic computation of joint moments of @xmath59 .",
    "as mentioned in the introduction , we have implemented this in sage .",
    "let us discuss quickly algorithmic questions behind this implementation .",
    "* from [ prop : expectation_lamdba_pi ] , computing the expectation essentially amounts to computing @xmath71 . finding the degree of the root of the decomposition tree of @xmath19 is easy . to simplify the discussion",
    "( but without loss of generality ) , suppose that this root has sign @xmath137 .",
    "then its degree is the number of integers @xmath786 such that @xmath787 thanks to the second formulation , this can be computed in linear time reading the permutation from left - to - right , keeping only in memory the maximum of the values already read .",
    "+ degrees of all vertices can then be computed recursively , and we find @xmath71 using [ obs : n_pi ] , in quadratic time . *",
    "higher moments or joint moments are more complex to compute .",
    "fix a list of patterns @xmath479 of respective sizes @xmath788 and set @xmath789 . while efficient for theoretical purpose , the definition of the coefficients @xmath784 ( see [ dfn : ordered_set - partition ] p. ) is not optimal from a practical point of view .",
    "it is however possible to generate directly the multiset of permutations of @xmath790 , where each @xmath340 appears with multiplicity @xmath426 . for each pair of ordered set - partitions @xmath791 and @xmath792 of @xmath793 with @xmath794",
    ", we can define a permutation @xmath795 as follows : @xmath795 assigns the @xmath796-th smallest value in @xmath797 to the @xmath376-th smallest value in @xmath798 .",
    "it is easy to check that any given @xmath340 is constructed this way from exactly @xmath426 pairs @xmath799 .",
    "we have used this construction in our implementation of the computation of joint moments . + even if this is more efficient than a naive implementation of [ dfn : ordered_set - partition ] , the complexity still grows very quickly .",
    "indeed , the number of pairs @xmath799 as above is equal to @xmath800 . in practice",
    ", we have only been able to compute the first four moments of @xmath76 with this algorithm ( the fifth moment given in the introduction has been inferred from the first four using the symmetry @xmath801 ) .",
    "we believe that modifying slightly the program to enable parallel computing may allow to compute the fifth moment with the above algorithm in a reasonable time but that the sixth moment , which involves more than @xmath802 pairs @xmath799 , will remain out of reach .      finally we will prove theorem  [ thm : main].[item : i ] .",
    "we have already seen in [ rem : nonseparable ] ( p. ) that , when @xmath19 is not separable , @xmath59 is identically @xmath88 ( in particular , deterministic ) .",
    "we have also seen in [ rem : motif1 ] ( p. ) that for the permutation @xmath19 of size @xmath60 , @xmath59 is identically @xmath60 ( and thus , again deterministic ) . on the contrary",
    ", we now prove that if @xmath19 is separable of size at least @xmath58 , then @xmath59 is a true _",
    "random _ variable and not a deterministic constant .",
    "when @xmath19 is separable of size at least @xmath58 , to prove that @xmath59 is not deterministic , it would be sufficient to check that @xmath803 .",
    "although [ prop : computing_moments ] provides an expression of the variance of @xmath59 , this expression does not allow us to prove directly that @xmath803 .",
    "instead , we prove in [ prop : not - equal ] that @xmath804 $ ] with positive probablility . from the expression of",
    "@xmath805 $ ] given in [ prop : expectation_lamdba_pi ] , it follows immediately that @xmath805 > 0 $ ] if @xmath19 is separable .",
    "so the proof of theorem  [ thm : main].[item : i ] will be completed as soon as we prove that @xmath59 takes values as close to @xmath88 as wanted with positive probability .",
    "this is done in [ lem : identiteatouslescoups ] .",
    "[ lem : identiteatouslescoups ] let @xmath19 be a separable permutation of size @xmath95 , @xmath188 be the signed brownian excursion and @xmath806 be an integer .",
    "there exists an event @xmath807 such that    * @xmath808 occurs with positive probability ; * if @xmath188 is such that @xmath808 occurs , then @xmath809 , where @xmath810 and the @xmath366 s are uniform independent points in @xmath79 $ ] .    assume first that @xmath811 .",
    "the key idea of the proof is that for some realizations of @xmath188 ( see a sketch in [ fig : evenement_chelou ] ) , @xmath812 with high probability .",
    "for which @xmath812 with high probability.,width=491 ]    we set @xmath813 and define intervals as follows :    * for integers @xmath111 between @xmath88 and @xmath806 , we set @xmath814\\cap[0,1]$ ] ; * for integers @xmath111 between @xmath60 and @xmath806 , we set @xmath815 $ ] .    these intervals are represented on [ fig : intervals ] .",
    "we have @xmath816 for each @xmath111 .",
    "moreover , @xmath817 for @xmath818 and @xmath819 , while @xmath820 .     and @xmath821.,width=453 ]",
    "let @xmath807 be the event defined as follows :    1 .",
    "[ item : i ] for each @xmath111 , @xmath822 .",
    "[ item : ii ] @xmath823 .",
    "3 .   the signs of the @xmath824 local minima of @xmath180 on @xmath825 are all @xmath137 .",
    "taking @xmath185 a piecewise linear excursion such that @xmath826 for integers @xmath111 between @xmath88 and @xmath806 and @xmath827 for @xmath828 , and with @xmath829 , it follows from [ lem : brownientubes ] that @xmath830 consider now a realization @xmath188 of the signed brownian excursion such that @xmath808 is realized , and let @xmath810 be @xmath8 uniform independent points in @xmath79 $ ] .",
    "the construction of @xmath808 ensures that @xmath831 as soon as each @xmath366 is in an interval @xmath832 such that @xmath832 does not contain any other @xmath833 .",
    "equivalently , if @xmath834 then one of the two following events occurs :    * for some @xmath127 , @xmath366 belongs to an interval @xmath821 ; * for some @xmath835 , @xmath366 and @xmath833 belong to the same interval @xmath832 .",
    "therefore we get @xmath836 this finishes the proof of [ lem : identiteatouslescoups ] when @xmath837 . by symmetry , the same result holds for @xmath838 .",
    "therefore , the statement of [ lem : identiteatouslescoups ] holds for all separable permutations of size at least @xmath58 .    we can now establish the announced proposition .",
    "[ prop : not - equal ] for any separable pattern @xmath19 of size at least @xmath58 , @xmath839 ) > 0.\\ ] ] in particular , @xmath59 is not almost surely constant .",
    "let @xmath95 be the size of @xmath19 .",
    "since @xmath805>0 $ ] ( from [ prop : expectation_lamdba_pi ] ) and @xmath8 is fixed , one can choose @xmath806 big enough such that @xmath840 $ ] .",
    "for such a value of @xmath806 , let @xmath808 be the event given by [ lem : identiteatouslescoups ] . if @xmath188 is such that @xmath808 is realized , then ( with @xmath810 a tuple of @xmath8 uniform independent points in @xmath79 $ ] ) @xmath841.\\ ] ] since @xmath808 has positive probability , the event @xmath842 $ ] also occurs with positive probability .",
    "for the convenience of the reader , we now record several useful properties of a typical realization of the brownian excursion @xmath180 .",
    "there are several ways to define the brownian excursion , the most convenient for us is to draw a realization of @xmath180 from a realization of the brownian motion @xmath843 , as follows ( see ( * ? ? ?",
    "* section 0.2 ) ) .",
    "consider @xmath844 ( almost surely @xmath845 ) , and set @xmath846 thus the brownian excursion @xmath180 is seen as a dilatation of a piece of @xmath152 .",
    "it follows that some almost - sure properties of the set of local extrema of @xmath152 remain true for @xmath180 .",
    "recall that by definition , @xmath177 is a one - sided local minimum for @xmath185 if , for some @xmath284 @xmath847}f\\quad \\text { or } \\quad f(x)=\\min_{[x , x+\\eps]}f.\\ ] ]    [ cor : onesided ] the set of one - sided local minima of the brownian excursion @xmath180 has lebesgue measure @xmath88 , almost surely .",
    "we first prove an analogous statement for the brownian motion @xmath843 .",
    "we denote @xmath848 the set of one - sided local minima of @xmath152 , and @xmath849 its lebesgue measure .",
    "we have @xmath850 so that , taking the expectation with respect to @xmath152 , @xmath851=\\int_0^{+\\infty } \\mathbb{e}[\\mathbf{1}_{u\\in \\operatorname{omin}(b ) } ] du = \\int_0^{+\\infty } \\mathbb{p}(u\\in \\operatorname{omin}(b ) ) du = 0.\\ ] ] in the last equality we used the fact that for every fixed @xmath101 , @xmath852 : theorem 1.27 in @xcite gives a similar result for local minima ( _ i.e. _ , two - sided minima ) , but the proof is easily adapted to the case of one - sided minima . thus @xmath849 is a nonnegative random variable with expectation @xmath88 , and therefore is equal to @xmath88 almost surely .",
    "the statement then follows for @xmath853 by dilatation , since the dilatation of a set of measure zero has measure zero as well .",
    "we now discuss values of local minima .",
    "[ lemma : minimumsamelevel ] with probability one the brownian excursion @xmath180 has no two local minima with the same value .    for the brownian motion it is the statement of (",
    "* lemma 11.15 ) .",
    "this is also true for @xmath180 since it is a dilatation of the brownian motion .",
    "an important consequence of [ lemma : minimumsamelevel ] in the present paper is that , for all set of @xmath8 distinct points @xmath218 of @xmath79 $ ] and for almost all realizations of @xmath180 , the tree @xmath854 obtained in [ section : extracting ] is a binary tree ( because of [ obs : distinctminimpliesbinary ] ) .",
    "a remarkable fact is that if @xmath218 is uniformly distributed this random binary tree is uniform ( see ( * ? ? ?",
    "* section 2.6 ) ) :    [ lemma : arbrebinaireuniforme ] fix @xmath619 and a binary tree @xmath723 with @xmath8 leaves .",
    "let @xmath855 be @xmath8 uniform and independent random variables in @xmath79 $ ] , independent from @xmath180 . then @xmath856    it is in fact even possible to describe the law of the _ geometric tree _ extracted from @xmath180 and @xmath857 , _",
    "i.e. _ , a tree with edge - lengths that are nonnegative real numbers ( see ( * ? ? ?",
    "* th . 2.11 ) ) . in this paper",
    ", we use a rather weak consequence of this result .",
    "[ lem : tout_a_une_densite ] take @xmath8 i.i.d .",
    "uniform random variables in @xmath79 $ ] independently from @xmath180 and call them @xmath858 . set @xmath859}\\exc$ ] .",
    "then the random vector @xmath860 has distinct coordinates with probability @xmath60 .",
    "as said above , the law of the geometric tree extracted from @xmath180 and @xmath857 is given in ( * ? ? ?",
    "* th . 2.11 )",
    "; this law has a density with respect to the uniform distribution on geometric trees .",
    "conditioning on the fact that @xmath861 is a given @xmath723 with @xmath8 leaves , the coordinates of @xmath862 are sums of edge - lengths of the geometric tree .",
    "hence the vector @xmath862 has a density with respect to the lebesgue measure on @xmath863 . without conditioning",
    ", @xmath862 has also a density , which is simply the mean of the conditional densities .",
    "this implies the lemma .",
    "finally we need the fact that the brownian excursion @xmath180 is arbitrary close to any fixed lipschitz excursion with positive probability .",
    "( a lipschitz excursion is simply an excursion that is also a lipschitz function , _",
    "i.e. _ , there exists @xmath864 such that @xmath865 for all @xmath866 in @xmath79 $ ] ) .",
    "[ lem : brownientubes ] for every lipschitz excursion @xmath185 and @xmath381 , @xmath867    the proof relies on a similar result for brownian motion ( * ? ? ?",
    "* sec.1.4 ) .",
    "let us give some details .",
    "fix a lipschitz excursion @xmath185 and @xmath381 as in the statement of the lemma . without loss of generality ,",
    "assume that @xmath868 .",
    "define @xmath869 , so that @xmath870",
    ". then @xmath871 therefore replacing if necessary @xmath185 by @xmath872 and @xmath147 by @xmath873 , we can assume without loss of generality that the following holds : @xmath874 ,      \\text { one has } f(s ) \\geq \\eta .",
    "\\label{eq : exc_loin_zero}\\ ] ]    we extend @xmath185 to the interval @xmath875 $ ] by setting @xmath876 if @xmath877 and @xmath878 if @xmath879 .",
    "let @xmath880 be a realization of the brownian motion .",
    "let @xmath881 $ ] . using the results of ( * ? ? ?",
    "* sec.1.4 ) , we know that with positive probability we have @xmath882 } |b_s - f(s-\\tfrac12)| < \\eta .",
    "\\label{eq : tube_brownien}\\ ] ] together with , this implies in particular that @xmath883;\\\\      b_s<0 & \\text { if } s \\in[\\frac12-\\delta,\\frac12-\\eta ] \\cup [ \\frac32+\\eta,\\frac32 + \\delta ]",
    ".    \\end{cases}\\ ] ] therefore , if we define @xmath81 and @xmath82 as in , we have @xmath884 in particular @xmath885 . for @xmath186 in @xmath79",
    "$ ] , we can write @xmath886 using [ eq : tube_brownien , eq : ab_controlled ] , the inequality @xmath885 and the fact that @xmath185 is a bounded lipschitz function , it is not hard to see that this upper bound is smaller than @xmath887 for some constant @xmath888 .",
    "since @xmath889 can be chosen as small as wanted , we may assume @xmath890 and we get @xmath891 ( for all @xmath186 in @xmath79 $ ] ) .    in summary , for @xmath889",
    "sufficiently small , implies @xmath892 , so that the latter occurs with positive probability , as wanted .",
    "many thanks to carine pivoteau for providing boltzmann samplers of permutations in classes , for running experiments with us using those , and for producing the simulations shown in the introduction .",
    "in addition , we thank dominique rossin for sharing the results of early experiments he did on random permutations in classes .",
    "we are also very grateful to grgory miermont for discussions at several stages of the project ; he suggested in particular the exchangeability argument at the core of the proof of proposition  [ prop : balanced_signs_discrete ] .",
    "we also thank warmly igor kortchemski for helping us find our way in the literature on the brownian motion and excursion .",
    "finally , we thank douglas rizzolo for pointing out that the value of the variance in [ prop : schroeder_are_galton - watson ] was wrong in the first version of the present paper .    our work was supported by a swiss - french phc germaine de stael grant ( project 2015 - 09 ) .",
    "fb , lg and ap also benefited from the hospitality of the institut fr mathematik of zrich in may and december 2015 .",
    "mb is supported by a marie heim - vgtlin grant of the swiss national science foundation ."
  ],
  "abstract_text": [
    "<S> we study uniform random permutations in an important class of pattern - avoiding permutations : the separable permutations . </S>",
    "<S> we describe the asymptotics of the number of occurrences of any fixed given pattern in such a random permutation in terms of the brownian excursion . </S>",
    "<S> in the recent terminology of permutons , our work can be interpreted as the convergence of uniform random separable permutations towards a `` brownian separable permuton '' . </S>"
  ]
}