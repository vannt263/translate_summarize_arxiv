{
  "article_text": [
    "clustering is a key component of pattern analysis methods , aiming at finding hidden structures in a set of data .",
    "it is a very active field of research@xcite , with applications that cover diverse problems , from grouping star systems based on astronomical observations to selecting genes and proteins that have similar functionality or characterizing customer groups based on purchasing patterns .",
    "the problem of finding clusters in a dataset can be divided into three stages : i ) measuring the similarity of the objects under analysis , ii ) grouping the objects according to these similarities , and iii ) evaluating the `` goodness '' of the clustering solution .",
    "the last stage has received little attention until recent years , when a growing interest in the problem can be noticed @xcite . the second stage (",
    "finding clusters efficiently given a set of similarities between objects ) has been widely studied in the literature @xcite and several clustering algorithms have been introduced .",
    "they are usually divided into hierarchical and partitional methods @xcite .",
    "hierarchical clustering ( hc ) algorithms find successive clusters using previously defined ones , in an agglomerative ( `` bottom - up '' ) or divisive ( `` top - down '' ) way .",
    "the result of this process is a binary tree , called a dendrogram@xcite .",
    "the number of clusters obtained depends on the level at which the user cuts the dendrogram .",
    "partitional algorithms , on the other hand , pre  determine a fixed number of clusters .",
    "one of the most widely used approaches is the k - means @xcite algorithm ( or its improved version pam@xcite ) that , starting from @xmath0 random clusters , searches iteratively for a locally optimal solution of the clustering problem .",
    "recently , frey and dueck@xcite proposed the innovative and computationally efficient affinity propagation ( ap ) algorithm . according to this method",
    ", each data point is viewed as a node in a network .",
    "nodes exchange messages until a set of cluster - centers emerges as a solution .",
    "the algorithm shares characteristics with both hierarchical and partitioning methods .    despite the success that these methods have shown in several artificial and experimental datasets",
    ", they usually fail to handle manifold - structured data , i.e. data that form low - dimensional , arbitrary shapes or paths through a high - dimensional space .",
    "there are algorithms that can in principle handle with this situation , like single linkage hierarchical clustering @xcite or chamaleon @xcite .",
    "most of these methods are based on graph theory .",
    "unfortunately , they are limited in the range of problems they can solve and usually need thousands of data samples to work properly .",
    "instead of developing new algorithms appropriate for these problems , we propose here to obtain better solutions going back to stage one of clustering , i.e. , by finding better ways to measure similarities between datapoints . in some sense",
    ", our view shares the spirit of kernel methods @xcite , looking for solutions to new problems by using appropriate new metrics together with well - known pattern analysis algorithms .    in the last years",
    ", several methods for characterizing the non - linear manifold where a dataset may lie were developed , like isomap@xcite , locally linear embedding@xcite or laplacian eigenmaps@xcite .",
    "basically , they all look for local neighborhood relations that can be used to produce low dimensional projections of the data at hand .",
    "ham et al.@xcite showed that they can also be interpreted as particular kernels .    in this paper",
    "we discuss new strategies to evaluate similarities in manifold spaces that easily extend the application of any clustering algorithm to these cases .",
    "following isomap , we first create the k - nearest - neighbor - graph ( knn - graph ) of the data , using a low k - value .",
    "if the graph is disconnected , which is expected in clustering problems , we add a number of edges ( following different strategies that will be discussed later ) in order to create a connected graph .",
    "the key point of our method is that the added edges have an exponentially penalized length .",
    "we then apply an appropriate algorithm to measure inter - point distances along the connected graph and use these measures as ( dis)similarities .",
    "we call the method the pknng metric ( for penalized k - nearest - neighbor - graph based metric ) .    in section ii",
    "we introduce the method and discuss the different schemes we use to connect the subgraphs .",
    "then , in section iii we introduce three two - dimensional artificial problems , which we embed in higher - dimensional spaces .",
    "we use these problems to evaluate the new metrics on different aspects and also show results on a digit recognition problem . finally ,",
    "in section iv we draw some conclusions and discuss future lines of research .",
    "the evaluation of similarities with the pknng metric is a two - step process .",
    "first we search the original dataset space for locally dense ( connected ) structures using the knn - graph . in the ideal case",
    "the process will end with a connected subgraph corresponding to each cluster but in the real case , when working with finite noisy samples , there are usually too many separated structures , typically more than one for each real cluster . in the second step",
    "we add penalized edges to the graph in order to fully connect it , and use an appropriate algorithm to measure distances in the ( now ) connected graph .     +   +   +   +   +      among the several algorithms for discovering low dimensional manifolds recently introduced , isomap has strong theoretical properties and is also easy to understand .",
    "we follow the main isomap idea to search for locally connected structures . as explained by tenenbaum , de silva and langford@xcite , in a curved manifold the geodesic distance between neighboring points",
    "can be approximated by the euclidean input space distance .",
    "for distant points , in contrast , geodesic distances are better approximated as a path of short segments connecting neighboring points . to this end",
    ", we construct the knn - graph of the data , i.e. the graph with one vertex per observed example , arcs between each vertex and its @xmath0 nearest neighbors , and with weights equal to the euclidean distance between them .",
    "as we look for dense subgraphs , at the end of the process we eliminate all outliers from the graphs .",
    "we consider that an arc is an outlier if it is not reciprocal ( i.e. one of the vertex is not a k - nn of the other ) and the length of the arc is an outlier of its distribution ( i.e. if it is larger than the 3rd quartile plus @xmath1 times the inter - quartile distance ) . in figure [ fig1 ]",
    "we show a toy example of this process .",
    "panel ( a ) shows the original data with the corresponding knn - graph . in general",
    ", the use of a low number of neighbors ( 3 to 7 in all our cases , as in @xcite ) produces graphs that can follow the curved structure of any data without adding `` shortcuts '' between geodesically distant points@xcite .",
    "+     +     +      as stated previously , when working with real data the first step will usually generate separated structures , typically more than one for each real cluster . in the ideal case",
    ", each sub - graph should correspond to a unique cluster and we could leave them disconnected and interpret those distances as equal to infinite . in the real case , however , some sub - graphs correspond to the same cluster . therefore , we need to evaluate also geodesic distances between points lying in different sub - graphs . with that purpose ,",
    "we add to the graph a number of edges in order to fully connect it . the key point of the method is that we penalize the weight of these new connecting edges with an exponential factor of the form : @xmath2 where @xmath3 is the graph weight corresponding to the added edge , @xmath4 is the euclidean distance between the points being connected by that edge and @xmath5 is the mean edge weight in the original graph . using this metric we can connect sub - graphs corresponding to the same cluster with a relatively small cost , because connections in the same order of magnitude of @xmath5 will get a low penalization .",
    "on the other hand , edges connecting distant sub - graphs will be strongly penalized seems more natural , penalizing only external connections bigger than @xmath5 .",
    "we choose our formulation in order to penalize in practice all added edges . ] .    which edges to add in order to connect the graph is an interesting problem by itself .",
    "we evaluate in this work four different schemes that cover most of the simple possibilities :      in this first scheme we add to the graph the minimum number of edges , each of them of minimum length ( the minimum spanning set ) , which fully connect the graph . on panel ( b ) of figure [ fig1 ]",
    "we show the result of this connection strategy on our toy example .      here",
    "we connect each sub - graph to all other sub - graphs using minimum length edges .",
    "figure [ fig1 ] , panel ( c ) , shows this strategy on the toy example .      in this simple scheme",
    "we add to the graph all remaining edges ( of course , with a penalized weight ) .",
    "on panel ( d ) of figure [ fig1 ] we show the corresponding graph .      in this last strategy",
    "we first find the medoid of each sub - graph , and then add edges connecting each medoid to all remaining medoids .",
    "figure [ fig1 ] , panel ( e ) , shows this strategy applied to our toy example .",
    "the idea behind minspan is to add the shortest available edges trying to follow as much as possible the structure of the manifold .",
    "minspan basically produces one - dimensional structures .",
    "we showed in a previous work @xcite that this effect can introduce some instability for distant points , but ( as we will confirm later ) it does not affect the performance of clustering .",
    "allsubgraphs is an extension of minspan and alledges can be viewed as an extension of allsubgraphs . at each step of this chain",
    "we add more edges , which increases the connectivity of the graph , reducing the potential instability of minspan . on the other hand , by adding edges we increase the probability of introducing `` shortcuts '' in the manifold , which can reduce the overall performance of the method .",
    "the medoids scheme is basically introduced to have a different scheme to compare with . as it does not include the minimum spanning set , it is always forced to use other paths in the graph and , consequently , it is not expected to be abble to follow a curved manifold .",
    "neighboring points belonging to different sub - graphs can be completely separated by this connection scheme .",
    "once we have a connected graph , we can compute geodesic distances between all points as minimum - length paths in the graph using computationally efficient algorithms like floyd or dijkstra@xcite .",
    "one of the advantages of the pknng metric is that it can produce accurate results both for curved / elongated manifolds and for typical compact cloud data . on this last , more typical kind of data ,",
    "the pknng metric produces similar results to the euclidean metric . as an example , figure [ gaussians ] shows the four clusters found by the pam algorithm using the pknng metric ( minspan scheme ) on an artificial dataset created by sampling four gaussians with different deviations .      to evaluate the proposed metric on more challenging problems including curved / elongated clusters , we use three artificial datasets with different characteristics :      the first dataset corresponds to points uniformly sampled from two arcs of circumference ( two clusters ) , with gaussian noise of a fixed amplitude added to the radial direction .",
    "the second artificial dataset was generated by sampling uniformly from three equally separated spirals , with added gaussian noise proportional to the radial distance .",
    "the result is a three clusters problem , each one of them having a non - uniform density , which can confuse some algorithms .      on this problem",
    "the central cluster corresponds to a uniform sampling of a circle , which is surrounded by two rings , also sampled uniformly but with constant gaussian noise added to the radial component .",
    "we split both middle- and outer - rings in halves ( adding a small gap ) , to create a more difficult five clusters problem .",
    "this third dataset has clusters with different ( but uniform ) densities .",
    "all datasets were generated in a ( 2-dimensional ) plane .",
    "for each one of them we used three different noise levels .",
    "an example of the clustering problems is shown in figure [ dataexamples ] . in order to evaluate the performance of the pknng metric at handling low - dimensional manifolds in high - dimensional spaces",
    ", we embedded our three datasets in 2d , 3d and 10d spaces , generating the following four settings :    [ [ d ] ] 2d ^^    in this first case we kept the three datasets in the original 2d space .",
    "[ [ d-1 ] ] 3d ^^    to start increasing the difficulty of the clustering problems , we coiled the original plane to form a swiss - roll , producing a non - linear embedding of the original clusters into a 3d space . in figure [ swiss ]",
    "we show an example of the resulting problem .      in this third setting",
    "we added gaussian noise to the previous 3d embedding in order to drift the points away from the surface of the swiss - roll .      as a last and more difficult setting",
    ", we took the 3d coiled data and added 7 extra dimensions to the problem .",
    "we then applied a random rotation in the 10d space , and finally added gaussian noise in all 10 dimensions .",
    "we evaluate different aspects of our new metric using the three artificial datasets combined with the four different embeddings previously described . in all cases , after measuring similarities with a given metric , we used the three clustering algorithms described in the introduction , namely pam , hc and ap , to find an appropriate clustering of the data .",
    "the quality of the solutions was evaluated in terms of the clustering accuracy , i.e. the percentage of the dataset assigned to the right cluster . for each case under evaluation ( dataset + noise level + embedding ) we produced 100 different realizations of the dataset and computed the mean clustering accuracy .",
    "+     +     +     +     +     +     +     +     +     +     +     +     +     +     +     +    in a first series of experiments we evaluated the four connection schemes previously discussed . in figure [ schemes ] we show the corresponding results using the pam clustering algorithm .",
    "the figure includes the results for the three artificial datasets and the four embedding situations previously discussed . at each panel",
    "we also include the results of using the standard euclidean metric as a baseline reference .",
    "the qualitative results are similar in all the situations under analysis .",
    "it is clear from the figure that three connection schemes ( minspan , allsubgraphs and alledges ) have very similar performances , clearly superior to the baseline methodology . the medoids scheme , as expected ,",
    "does not show a real improvement over the plain euclidean metric . comparing the three efficient schemes",
    ", minspan seems to be superior to allsubgraphs and alledges in a few situations , in particular in the 3d  noise and 10d  noise embeddings .    in all panels",
    "the difference in accuracy between the baseline and the three efficient schemes increases when noise decreases . in these cases , when there is a bigger separation among the clusters , the new metric can easily find the curved clusters in all embedding situations .",
    "the edge in performance of the pknng metric decays smoothly when the clusters start to overlap , becoming equivalent ( but never worse ) to the plain euclidean metric in high  noise situations .",
    "it is interesting to note that the pknng metric can deal efficiently with clusters of different densities ( three - rings datasets ) or with densities changing within the same cluster ( three - spirals dataset ) .",
    "we compared in this second experiment the three clustering methods ( pam , hc and ap ) that we described in the introduction , in order to investigate whether there is any dependence of the performance of the pknng metric on the algorithm being used . in figure [ clust_methods ]",
    "we show the results of pam , hc and ap applied to the similarities evaluated with the pknng - minspan metric .",
    "we again include in each panel the results of the standard euclidean metric plus pam as a baseline reference .",
    "it is evident from the figure that the good performance of the pknng metric is independent of the clustering algorithm in all situations .",
    "we performed a third experiment to assess the influence of the exponential penalization on the pknng metric . in this case",
    "we included in the comparison two connection schemes , namely minspan and alledges , under two different settings : i ) in the ( normal ) exponentially penalized version ( as used in all previous experiments ) , and ii ) in a `` plain '' version in which we eliminated the penalization and used for the added connecting edges the standard euclidean distance .",
    "both settings used exactly the same graphs , the only difference being the exponential penalization of some weights in the first case .",
    "it is easy to see that the `` plain '' version of alledges is simply the standard euclidean metric , our baseline in all experiments . for completeness",
    ", we also include in this case the results obtained measuring similarities with the knn - graph with the minimum k - value that produces a fully connected graph ( we call this method min - k - connected - graph ) . in figure [ pen_or_no ]",
    "we show the results obtained with the pam clustering algorithm applied to the five settings described in this paragraph . analyzing the figure , the two methods that use `` plain '' , non - fully - connected euclidean graphs ( the minspan - plain and the min - k - connected - graph ) show in most cases a better performance than the standard euclidean metric , but , more importantly , the two penalized metrics are in all cases clearly superior to the corresponding `` plain '' methods .",
    "these results suggest that the key factor of our new metric is the exponential penalization of the added edges .      in this last experiment with the artificial datasets we selected a good representative of the new methods ( the pknng - minspan metric plus the pam clustering algorithm ) , and compared it with two well - known , state - of - the - art clustering methods .",
    "the first method under comparison is the single linkage hierarchical clustering algorithm@xcite , which is equivalent to constructing a minimum spanning tree ( mst ) of the dataset . as we stated in the introduction",
    ", this algorithm can identify curved / arbitrary clusters in some situations .",
    "the second method is the spectral clustering algorithm@xcite .",
    "this method has recently received increasing attention and is considered to be effective for arbitrary manifolds .",
    "we used a gaussian kernel for which , at each run , we set the @xmath6 parameter proportional to the mean distance between points in the datasets .",
    "again , we included the pam algorithm with the plain euclidean metric as a baseline .",
    "figure [ comparacion ] show the corresponding results .",
    "the three methods show equivalent performance in low noise situations .",
    "mst seems to be more affected by high noise levels and high dimensionality situations , giving worse results than the baseline method in some cases .",
    "overall , pknng+pam seems to be superior to spectral clustering on the three  spirals and three  rings datasets , and the opposite can be observed on the two  arcs dataset . as usually happens with efficient methods , which one works better is highly problem  dependent .",
    "it is worth mentioning that we applied all three clustering algorithms as `` off - the - shelf '' methods , i.e. , without any fine  tunning of internal parameters",
    ". this fact can explain the sometimes low performance of spectral clustering , because in some cases the automatic setting of the @xmath6 parameter can be inappropriate . even taking this into account , we believe that this is the fairest setting for the comparison , because : i ) the pknng metric also has a free parameter , @xmath5 , which we choose to set automatically , and ii ) in real world datasets , when there is no gold standard to compare against , there is no clear method for fine  tuning the free parameters .      as a final , real - world example of the use of the pknng metric on a high - dimensional dataset",
    ", we applied it to clustering subsets of the mnist handwritten digits dataset collected by lecun and cortez @xcite .",
    "the mnist dataset is a subset of a larger set available from nist .",
    "the 8-bit gray  scale images of the digits have been size - normalized and centered in 20x20 pixels images .",
    "we used only the 60000 images in the training set collected by lecun , without any pre - processing at all . in a first experiment",
    ", we took 500 random samples of each digit and applied the four clustering procedures ( as described in the previous subsection ) to find 10 clusters .",
    "we then evaluated the clustering accuracy and repeated the experiment 10 times , taking care of using non  overlapping random samples . in the column labeled 1:10 of table [ digits ]",
    "we show the mean accuracy obtained with each method . in this problem",
    "the performance of the pknng+pam method is @xmath7 better than spectral clustering , which is the second best .",
    "we repeated the experiment ( 500 non ",
    "overlapping random samples repeated 10 times ) but reducing it to subsets of three digits that are usually highly confused ( 4 - 7 - 9 and 3 - 5 - 8 ) . in the last two columns of table [ digits ] we show the corresponding results .",
    "again , pknng+pam has a clear edge over all other methods under comparison .",
    ".clustering results on the mnist digits dataset .",
    "columns show the mean clustering accuracy ( @xmath8 one standard deviation ) over 10 random partitions of the different subsets . [ cols=\"^,^,^,^\",options=\"header \" , ]",
    "in this work we have introduced the penalized k - nearest - neighbor - graph based metric , and have shown that it is a useful tool for clustering arbitrary manifolds .",
    "the metric can be used in combination with any clustering algorithm , as we have demonstrated with several experiments using artificial datasets .",
    "our new pknng metric is based on a two - step method : first we construct the k - nearest - neighbor - graph of the dataset using a low k - value ( from 3 to 7 ) , and then we use exponentially penalized weights for connecting the sub - graphs produced by the first step .",
    "we have discussed several possible schemes for connecting the different sub - graphs , finding after long experiments with artificial datasets that any scheme that includes the minspan set shows equivalently good results .",
    "overall , using strictly the minspan set seems to produce the best results according to our analysis .",
    "the key innovation of our metric is the use of exponentially penalized weights to connect the sub - graphs .",
    "we have confirmed this fact by using three diverse artificial problems and four different ( non - linear ) embeddings . in that experiment",
    "most of the gain in accuracy over the euclidean metric was lost when we eliminated the penalizing factor .    a comparison with two state - of - the - art algorithms for clustering manifold data , namely spectral clustering and minimum - spanning - trees , confirms the validity of our results . as a real world application , we have clustered digit images from the mnist dataset , finding that the pknng metric plus the pam clustering algorithm was superior to other methods in this task .",
    "future work includes the application of the pknng metric to real genomic and proteomic data , face recognition and others .",
    "we acknowledge partial support for this project from anpcyt ( grant pict 2003 11 - 15132 ) .",
    "we thank pablo f. verdes for useful comments on this and on a previous manuscript , and monica larese and lucas uzal for a carefull reading of this manuscript ."
  ],
  "abstract_text": [
    "<S> a difficult problem in clustering is how to handle data with a manifold structure , i.e. data that is not shaped in the form of compact clouds of points , forming arbitrary shapes or paths embedded in a high - dimensional space . in this work </S>",
    "<S> we introduce the penalized k - nearest - neighbor - graph ( pknng ) based metric , a new tool for evaluating distances in such cases . </S>",
    "<S> the new metric can be used in combination with most clustering algorithms . </S>",
    "<S> the pknng metric is based on a two - step procedure : first it constructs the k - nearest - neighbor - graph of the dataset of interest using a low k - value and then it adds edges with an exponentially penalized weight for connecting the sub - graphs produced by the first step . </S>",
    "<S> we discuss several possible schemes for connecting the different sub - graphs . </S>",
    "<S> we use three artificial datasets in four different embedding situations to evaluate the behavior of the new metric , including a comparison among different clustering methods . </S>",
    "<S> we also evaluate the new metric in a real world application , clustering the mnist digits dataset . in all cases the pknng metric shows promising clustering results . </S>"
  ]
}