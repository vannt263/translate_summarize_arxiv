{
  "article_text": [
    "the table @xmath0 we consider consists of the square @xmath1\\times [ 0,1/2]$ ] with a vertical wall @xmath2 connecting the points @xmath3 and @xmath4 .",
    "we play billiard on this table , with @xmath2 acting as a one - sided mirror .",
    "that is , we consider a point particle in @xmath0 and a direction @xmath5 in @xmath6 , the particle moves at unit speed in the direction until it reaches the boundary of the table .",
    "if it arrives at the left side of @xmath2 it passes through it unperturbed , while if it arrives at the right side of @xmath2 or at the boundary of the square it is reflected with the usual law of geometric optics , the angle of incidence equals the angle of reflection ( see figure [ 1 ] ) .",
    "polygonal billiards with one - side straight mirrors were briefly described by m. boshernitzan and i. kornfeld @xcite in connection with a special kind of piecewise linear mapping of a semi - interval , called interval translation mappings ( itms ) .",
    "interval translation mappings are a natural generalization of interval exchange transformations .    in this article",
    "we prove that billiard flow on such table can be associated with special interval translation mappings called double rotations ( proposition 1 ) .",
    "the term double rotations was introduced in @xcite , they have also been studied in @xcite , @xcite , @xcite .",
    "we show that up to a natural involution there exists a bijection between double rotations and billiard map we work with , and therefore almost all of our billiard map are of finite type due to the corresponding results for double rotations ( theorem 2 part 2 ) ) ( see @xcite and @xcite ) . in the other parts of theorem 2",
    "we collect various interesting implications of this result on unique ergodicity , non - unique ergodicity , and the hausdorff dimension of the attractor ( concretizing a suggestion of boshernitzan and kornfeld @xcite ) .",
    "our main result is an exact linear formula for complexity of billiard trajectories in a given direction in the case @xmath7 ( theorem 4 ) , we also give a linear estimate in case of other rational values of @xmath8 ( theorem 9 ) .",
    "the main result also generalizes to certain other rational polygons with one sided scatterers located at an axis of symmetry ( theorem 7 )",
    ". the proof is based on an extension of combinatorial arguments introduced by j. cassaigne ( @xcite ) for languages with bispecial words ( theorem 11 ) and also uses a certain symmetry of orbits of the unfolded billiard .",
    "a _ double rotation _ is a map @xmath9 of the form : @xmath10    consider the billiard in the table @xmath0 described in the introduction .",
    "there is a well known construction of unfolding the billiard in a rational polygon to a translation surface ( see for example @xcite ) .",
    "the same construction applied to our setting yields a unit torus consisting of four copies of the billiard table @xmath0 with slits corresponding to @xmath2 which are identified according to the billiard flow : when we hit a right copy of @xmath2 ( depicted in blue ) we jump to the corresponding left copy of @xmath2 ( depicted in green ) , while the left ( green ) copies of @xmath2 are transparent . with these identifications",
    "our billiard is equivalent to the linear flow on the unit slitted torus ( see figure [ 2 ] ) .     is a double rotation , width=340,height=434 ]",
    "consider the first return map to the vertical section @xmath11 in the unfolded slit torus ( see figure [ 2 ] , where this section is drawn by yellow dashed line ) .",
    "we denote this map by @xmath12 .",
    "we identify its domain of definition with the circle @xmath13 .",
    "it is easy to check that there are only two possibilities for our trajectories ( here we assume that the the trajectory is not vertical : @xmath14 ) : either the orbit of the point hits the blue wall , and immediately goes back to the section ( this is depicted by the orange line in figure [ 2 ] ) ; or the orbit of the point does not touch the blue wall ( such an orbit is depicted by the purple line in figure [ 2 ] ) . in the first case @xmath15 ; in the second case @xmath16 .",
    "therefore , we have the following :    first return map on the vertical section @xmath11 is a double rotation with the following values of parameters : @xmath17    let us consider the cubic polynomial @xmath18 and let @xmath19 be the unique root of @xmath20 in @xmath21.$ ] let us consider the following values of parameters of our billiard : @xmath22 the map @xmath23 is then the double rotation introduced by boshernitzan and kornfeld in @xcite , the first example of an itm whose dynamics differs from that of an interval exchange .",
    "to explain this difference , and to collect the most interesting implications of known results to our situation , we need to introduce some notation . for any @xmath24",
    "the _ attractor _ of @xmath25 is the set @xmath26 where @xmath27 if there exists @xmath28 such that @xmath29 then we say that @xmath25 is of _ finite type_. otherwise @xmath25 is of _ infinite type_. informally , the interval translation map being of finite type means that it can be reduced to interval exchange transformations ; if it is of infinite type , then the attractor is a cantor set .",
    "the boshernitzan ",
    "kornfeld example given above is of infinite type .",
    "fix the parameters @xmath30 and a direction @xmath5 .",
    "let @xmath31 be the associated double rotation .",
    "let @xmath32 and @xmath33 be the two intervals of continuity of @xmath25 .",
    "the _ code _",
    "@xmath34 of the @xmath25 orbit of @xmath35 is the sequence of intervals it hits , i.e.  @xmath36 if and only if @xmath37 is in the interval @xmath38 .",
    "the _ language _ @xmath39 is the set of all infinite codes obtained as @xmath35 varies , and @xmath40 is the set of different _ words of length @xmath41 _ which appear in @xmath42 .",
    "let @xmath43 .",
    "note that one could also consider @xmath44 the number of different words of length @xmath41 which appear in @xmath42 as @xmath45 varies in the attractor .",
    "we must exclude directions for which there is a billiard orbit from an end point of @xmath2 to an end point of @xmath2 .",
    "we call such directions _ exceptional_. there are at most a countably many exceptional directions since for any positive constant @xmath46 , there is a finite number of billiard orbits which start and end at end points of @xmath2 and have length at most @xmath46 .",
    "the following theorem follows directly from several known results about double rotations , interval translation mappings and piecewise continious interval maps .",
    "[ thm1 ]    \\1 ) for all @xmath47 with @xmath5 non - exceptional the billiard / double rotation is minimal .",
    "+ 2 ) for almost all @xmath47 the double rotation is of finite type .",
    "+ 3 ) there exists an uncountable set of @xmath47 so that the hausdorff dimension of the closure of the attractor is zero , in particular the double rotation is of infinite type .",
    "+ 4 ) for each @xmath47 with @xmath5 non - exceptional the billiard / double rotation has at most two ergodic invariant measures .",
    "+ 5 ) there exists an uncountable set of @xmath47 with @xmath5 non - exceptional such that the billiard / double rotation is not uniquely ergodic .",
    "+ 6 ) for all @xmath47 with @xmath5 non - exceptional the complexity @xmath48 grows at most polynomially with degree @xmath49 .    in @xcite",
    "it was suggested that there may exist configurations on a rational billiard table with mirrors which force the light to get concentrated in some arbitrarily small portions of the table .",
    "this suggestion is confirmed by part 3 ) of the theorem .",
    "it is easy to check that varying the parameters @xmath47 we can obtain all double rotations with only one restriction : @xmath50 there exists an involution between two parts of parameter space ( @xmath51 and @xmath52 ) and the orbit behavior of itm from these two parts are completely the same : the involution is measure preserving and does not change the dynamics .",
    "thus all known results on double rotations hold in our setting .",
    "1 ) we think of a double rotation as an itm defined on an interval .",
    "first suppose that this interval is @xmath13 ( in the coordinates of the definition of double rotation ) .",
    "either this is an itm on with 3 intervals of continuity , or it has 4 intervals of continuity . in the later case",
    "we choose the origin to be the point @xmath53 , and the double rotation now has at most 3 intervals of continuity , thus we can always choose coordinates so that the itm has at most 3 intervals and part 1 ) follows from theorem 2.4 of @xcite .",
    "part 2 ) follows from @xcite theorem 4.1 or from theorem 1 of @xcite , part 3 ) follows from theorem 10 of @xcite , part 4 ) follows from theorem 3 of @xcite , part 5 ) follows from theorem 11 of @xcite , and part 6 ) follows theorem 1 of @xcite ( see also corollary 8 of @xcite ) .    the _ billiard flow _",
    "@xmath54 is defined on the phase space @xmath55 , with proper identifications on the boundary , and the _ attractor _ of the billiard flow is @xmath56 an immediate application of the fubini theorem to theorem 2 part 2 ) yields    for almost every @xmath30 the billiard attractor has full measure .",
    "* question : * for which polygons with one sided mirrors does the billiard attractor have full measure ?",
    "positive measure ?",
    "zero measure ?    the main results of this article are improvements of part 6 ) of the theorem .",
    "we begin with the case @xmath57 , i.e.  the one sided mirror is in the middle of the square , where we get a complete description of the complexity .",
    "we define three sets of directions , in the below definitions all the parameters @xmath58 and @xmath59 are integers . @xmath60 @xmath61 @xmath62    for @xmath63 let @xmath64 .",
    "the set are pairwise disjoint and @xmath65    we give a geometric description of these sets .",
    "we work in the unfolded model ( figure [ 2 ] ) and consider the two singular points of the forward billiard map .",
    "we consider the backward trajectories of these two singular points , the sets are distinguished by the fact which part of the boundary of the semi - transparent mirror is first touched by the backwards trajectory , the transparent side or the reflecting side .",
    "this identifies how many preimages a corresponding point of the orbit has ( none or two ) . in particular",
    ", @xmath66 corresponds to the case when both of the trajectories first touched the reflecting side , @xmath67 to the case when both of the trajectories first touched the transparent side and @xmath68 is the intermediate case , one trajectory first touches the reflecting side and the other tranjectory first touches the transparent side .",
    "[ thm2 ] suppose @xmath57 and that @xmath5 is non - exceptional",
    ". then either , @xmath69 , and @xmath70 or there exists a positive integer constant @xmath71 so that    1 .   for @xmath72 , @xmath73 for all sufficiently large @xmath41 , or 2 .   for @xmath74 , @xmath75 for all sufficiently large @xmath41",
    "remark , in cases 1 and 2 the double rotation @xmath76 is of infinite type where by @xmath76 we mean @xmath77 for any arbitrary @xmath78 .",
    "the behavior of the complexity for small @xmath41 will also be described in the proof .",
    "since the map @xmath76 is minimal , we can apply a theorem of boshernitzan , _ a minimal symbolic system with @xmath79 is uniquely ergodic _ ( @xcite[theorem 7.3.3 ] ) to conclude that    if @xmath80 then @xmath76 is uniquely ergodic .    note that @xmath81 is open , and exceptional directions are countable , thus we have shown that for all but countably many @xmath5 in an open set of @xmath5 the map @xmath76 is of infinite type , uniquely ergodic and of linear complexity .    in the case",
    "@xmath82 the billiard attractor has positive , but not full measure .    except for the exact computation of the sets @xmath83 , theorem [ thm2 ]",
    "is a special case of a more general result .",
    "take any rational polygon , reflect it in one side .",
    "erase part of the side , make the other part a one sided mirror ( which will be part of the line @xmath84 to be concrete ) , to produce a table @xmath85 .",
    "consider the slitted flat surface @xmath86 associated with @xmath85 ( see for example @xcite ) with the slits identified as in the square case .",
    "for the moment consider @xmath85 without the one - sided mirror , and @xmath87 without the slits , let @xmath88 be the angles between the sides of @xmath85 , and let @xmath46 be the least common multiple of the @xmath89 .",
    "then a standard computation shows that @xmath90 has @xmath91 vertices ( not counting the endpoints of the slits ) @xcite .",
    "consider the section @xmath84 as a subset of @xmath85 .",
    "in @xmath87 there are @xmath92 copies of this section .",
    "if we fix @xmath5 non - exceptional ( no orbit from any vertex of @xmath85 to any vertex of @xmath85 ) then there are @xmath46 copies of the section for which the linear flow on @xmath87 jumps via an identification ( the linear flow goes through the other @xmath46 copies of the section as if they where not there ) .",
    "we consider the first return map @xmath76 to the @xmath46 copies which produce a jump .",
    "the top and bottom of the section have already been counted as vertices of @xmath85 .",
    "the map @xmath76 is an interval translation map with @xmath93 intervals of continuity , the @xmath94 coming from the @xmath94 singular points on @xmath87 , and the @xmath46 from the end point of the one - sided mirror ( which we assume starts at the bottom of @xmath85 ) .",
    "we assign a symbol to each of these intervals and code the billiard orbit by these @xmath94 symbols .",
    "let @xmath48 be the complexity of the associated language .",
    "[ thm3 ] if @xmath85 as above and @xmath5 is non - exceptional then there exists a positive constant @xmath71 and @xmath95 so that @xmath96 for all sufficiently large @xmath41 .",
    "example 1 : in the double hexagon ( figure [ fig3 ] ) all angles have @xmath97 , so @xmath98 . in this case",
    "all @xmath99 , so we do not have any removable singularities .",
    "example 2 : in the @xmath100 shaped figure ( figure [ fig3 ] ) one can calculate @xmath101 .",
    "however , on @xmath87 only 4 of these singularities are actual singularities ( the two points with angle @xmath102 and the two copies of the end point of the one sided mirror on @xmath87 ) , the others are removable singularities .",
    "we also remark that in the original case of the square @xmath103 and there are 4 removable singularities .",
    "we remind the reader of two results : _ an aperiodic itm with r intervals of continuity has at most @xmath104 minimal components _",
    "( theorem 2.4 in @xcite ) and _ if @xmath105 is an integer , then a minimal symbolic system satisfying _",
    "@xmath106 _ admits at most k-2 ergodic invariant measures _ ( theorem 7.3.4 in @xcite ) . combining these two results with theorem 7 yields",
    "there are at most @xmath107 $ ] minimal components and on each minimal component the number of ergodic invariant measures for the itm / billiard is at most @xmath108 .",
    "we turn to the question of complexity for rational position of the mirror in the square case , i.e.  @xmath109 .",
    "suppose @xmath110 .",
    "we consider the return map to the vertical sections @xmath111 with @xmath112 .",
    "the first return map @xmath113 to these vertical sections is given by @xmath114,\\\\ ( i+1    \\hspace{-.2 cm }   \\pmod q , y+\\tan{\\theta}/q   \\hspace{-.2 cm }   \\pmod 1 )   & \\mbox{otherwise}. \\end{array } \\right.\\ ] ] we code orbits of this map by a 3 letter alphabet , 2 letters for the section @xmath115 ( where the map is discontinuous ) and a third letter for all the other sections .    [ thm5 ] if @xmath110 , @xmath5 is non - exceptional then @xmath116 for all @xmath41 .",
    "theorem 2.4 in @xcite and theorem 7.3.4 in @xcite imply that    there are at most @xmath117 minimal components and on each minimal component the number of ergodic invariant measures for the itm / billiard is at most @xmath118 .",
    "the main technical tool will be a variant of cassaigne s formula @xcite .",
    "let @xmath119 be a finite alphabet , @xmath120 be a language , @xmath121 the set of words of length @xmath41 which appear in @xmath122 , and @xmath123 .",
    "note that @xmath124 . for any @xmath125 let @xmath126 and thus @xmath127 for @xmath128 let @xmath129 we remark that while @xmath130 the other two quantities can be @xmath131 .",
    "a word @xmath128 is called left special if @xmath132 , right special if @xmath133 and bispecial if it is left and right special .",
    "let @xmath134 let @xmath135 .    in this section",
    "we show that    [ thm::com ] @xmath136 [ combi ]    * remark : * cassaigne proved this theorem in the case of recurrent languages ( i.e. @xmath137 ) @xcite ( see @xcite for a english version of the proof ) .",
    "we use the same strategy of proof .",
    "since for every @xmath138 there exist @xmath139 and @xmath140 such that @xmath141 we have @xmath142 thus @xmath143 now , for @xmath138 we can write @xmath144 with @xmath145 and @xmath140",
    ". let @xmath146 .",
    "thus @xmath147.\\ ] ] let @xmath148 , and",
    "thus @xmath149 equals @xmath150   - \\sum_{v \\in \\l_{np}(n ) }    \\big ( m_r(v ) - 1 \\big ) .\\ ] ]    for any word @xmath151 with @xmath152 any legal prolongation to the right of @xmath153 is a legal prolongation to the right of @xmath154 as well thus if @xmath155 then @xmath156 .",
    "thus words with @xmath155 do not contribute to any of the above sums .",
    "thus @xmath149 is equal to the above sum restricted to those @xmath154 such that @xmath157 for the left sum , if furthermore @xmath158 then there is only a single @xmath8 such that @xmath152 . for this @xmath8",
    "we have @xmath159 thus such words do not contribute to the left sum .",
    "thus the only terms which contribute to the left sum are the bispecial words , and to the right the words for which @xmath160 ; in other words @xmath149 equals @xmath161   - \\sum_{v \\in \\l_{np}(n):m_r(v ) > 1 }    \\big ( m_r(v ) - 1 \\big ) .\\ ] ]    for any @xmath162 we have @xmath163 and @xmath164 thus @xmath149 equals    @xmath165",
    "theorem [ thm2 ] we use theorem [ combi ] . in our case @xmath155 or @xmath166 ,",
    "so the second term of the equation reduces to @xmath167 , thus @xmath149 equals @xmath168    we have @xmath169 and @xmath170 .",
    "suppose that @xmath35 has two preimages , and that @xmath171 is in the boundary of one of the two intervals of continuity of @xmath76 , i.e.  the billiard orbit of @xmath35 arrives at the top of the reflecting side of @xmath2 after @xmath41 steps .",
    "consider the code @xmath154 of length @xmath41 .",
    "clearly @xmath172 . since @xmath5 is non - exceptional then @xmath173 .",
    "( note that if @xmath5 is exceptional then @xmath174 and thus the orbits would not contribute to the sum . ) thus for non - exceptional directions @xmath175    we switch back and forth between the language of double rotations and that of the billiard .",
    "let @xmath176 be the two ( common ) endpoints of @xmath177 and @xmath178 ( in the original definition of double rotations these points are called @xmath131 and @xmath53 ) .",
    "let @xmath179 be the collection of nth - preimages of @xmath180 which we will denote by @xmath181 for short .",
    "then we will define the tree @xmath182 of preimages of @xmath180 to be the set @xmath183 with a directed arrow from @xmath184 to @xmath185 if @xmath186 we define similarly the preimage tree @xmath187 .",
    "any right special word corresponds to a billiard orbit which hits @xmath180 or @xmath188 , thus we can decompose @xmath149 into two parts , those words contributing to this difference corresponding to a billiard orbit arrives at @xmath180 , and those which arrive at @xmath188 ; we note these two contributions by @xmath189 for the point @xmath180 , and similarly for the point @xmath188 .",
    "this formula can be seen as counting the number of leaves at level @xmath41 of a weighted tree , a vertex @xmath190 has weight @xmath191 if it has two preimages ( contributing one element to @xmath192 ) , weight @xmath131 if it has one preimage , weight @xmath193 if it has no preimages ( contributing one element in @xmath194 ) ( figure [ tree ] ) .",
    ".,title=\"fig:\",width=340,height=434 ] ( -152,153)@xmath180 ( -120,153)@xmath191 ( -91,168)@xmath131 ( -64,187)@xmath131 ( -90,132)@xmath193    for any @xmath41 such that each of the @xmath195 has a unique preimage , we have @xmath196 and thus @xmath197 .    now consider an @xmath41 so that at least one point @xmath198 has two preimages . the first time this happens , @xmath199 , if this never happens then set @xmath200 .",
    "thus @xmath201 and @xmath202 .",
    "this implies @xmath197 . by the symmetry ,",
    "the next time , @xmath203 one of these backwards orbits hits the mirror , the other one will also hit the mirror from the other side .",
    "thus one of the orbits will have two preimages and the other will be non - left - extendable . thus @xmath204 .",
    "the same holds for all times @xmath205 for which @xmath206 .",
    "we have thus shown that @xmath207 is the unique time for which @xmath208 .",
    "the same holds for @xmath209 , but @xmath207 and @xmath210 are not necessarily equal .",
    "if @xmath211 then @xmath212 by definition @xmath169 and thus @xmath213 .",
    "then @xmath214 for all @xmath215 and @xmath216 for all @xmath217 .",
    "thus @xmath218 in particular if @xmath219 , i.e.  if the preimages of both points @xmath180 and @xmath188 disappear before being doubled , then @xmath220 it is easy to check that @xmath219 happens exactly when @xmath221 .    on the other hand",
    "if @xmath222 , if follows that @xmath223 set @xmath224 and @xmath225 .",
    "we have @xmath214 for all @xmath226 , @xmath227 for all @xmath228 $ ] , @xmath216 otherwise .",
    "thus @xmath229 $ , } \\\\ 3n + ( 1- n_0 ^ - - n_0^+ ) & \\text{otherwise}. \\end{cases}\\ ] ] if @xmath230 then exactly one of the two points @xmath180 or @xmath188 disappears before being doubled , thus @xmath231 the itm is of infinite type and @xmath232 if @xmath233 then neither preimage disappers before being doubled , thus @xmath234 .",
    "theorem [ thm3 ] the main difference with theorem [ thm2 ] is that instead of two points @xmath176 which produce right special words , there are now @xmath93 points .",
    "call these point @xmath235 .",
    "the other difference is that there are @xmath93 intervals of continuity , thus @xmath236 and thus @xmath237 .",
    "otherwise the proof is identical , for each of the @xmath238 we construct its preimage tree .",
    "we consider the first time @xmath239 when the preimage is doubled .",
    "the symmetry argument is identical to the square case , once a @xmath238 has two preimages at some time , it has two preimages for larger times .",
    "the @xmath240 in the statement of the theorem then corresponds to the number of @xmath238 which have two - preimages at a certain time , while for the other @xmath241 points the preimages disappear before being doubled . as before , @xmath71 is responsible for the events that happened before the mo- ment when the first preimage was doubled .",
    "we conclude that @xmath242 for @xmath41 sufficiently large and thus @xmath243 .",
    "theorem [ thm5 ] remember that in this case the map @xmath113 is the first return map to the union of vertical sections @xmath244 described before the theorem .",
    "the proof follows the same line as the the case @xmath245 , in which we argued that by symmetry that once there are two preimages of @xmath180 , each time one disappears a new one appears .",
    "this is no longer true in the general rational case . as in the case",
    "@xmath245 we need to consider the preimage tree under the map @xmath113 of the points @xmath180 and @xmath188 ( which as in case @xmath246 are the points of discontinuity on the circle @xmath247 ) , the map being continuous on the other circles .    as mentioned in the proof of theorem 4 , the difference @xmath248 counts the number of leaves of level @xmath41 , but since all points in the set @xmath249 have the same second coordinate , we have @xmath250 , for any @xmath125 , for any point @xmath251 .",
    "thus @xmath252 for all @xmath41 .    taking into account the contribution of @xmath180 and @xmath188 yields @xmath253 and",
    "since @xmath254 , we conclude that @xmath255    [ prop1 ] if @xmath256 then @xmath257 .",
    "proposition [ prop1 ] by assumption there are no right special words , thus no bispecial words .",
    "thus @xmath258 .",
    "we have @xmath259 , thus @xmath260 and @xmath261 it follows that @xmath257 .",
    "we thank pascal hubert for fruitful discussions and henk bruin for a critical reading of an earlier version of this manuscript .",
    "we gratefully acknowledge the support of anr perturbations and erc starting grant quasiperiodic .",
    "we also thank the anonymous referee for several useful suggestions which improved our presentation .",
    "s.  ferenczi , and t.   monteil , _ infinite words with uniform frequencies , and invariant measures _ , combinatorics , automata and number theory , encyclopedia math .",
    "* 135 * , cambridge univ . press , cambridge ( 2010 ) , 373409 ."
  ],
  "abstract_text": [
    "<S> we study the billiard on a square billiard table with a one - sided vertical mirror . </S>",
    "<S> we associate trajectories of these billiards with double rotations and study orbit behavior and questions of complexity . </S>"
  ]
}