{
  "article_text": [
    "the boundary layer problem in numerical quadrature is the first , and probably the most difficult to solve , from a bayesian chain aiming either to implement the automatic mesh generation by the adaptive quadrature methods under sound expectation of _ reliable local quadrature rule _",
    "@xmath3 outputs , or to provide early detection of the origins of code failure .",
    "the need of such a stringent requirement , which goes well beyond the usual implementation of the automatic adaptive quadrature rules ( see , e.g. , @xcite ) arises in the numerical exploration of the predictions of models describing phase transitions in complex physical systems , which critically depend on the realization of ( unknown in advance ) values of some specific parameters ( like , e.g. , the hole or electron doping level in high-@xmath4 superconducting materials @xcite ) .",
    "the solution of the resulting parametric integrals makes use of the existing library programs the reliability of the outputs of which is heavily based on user s ability to choose the suitable procedure from a proposed menu . the impossibility to know in advance the detailed behaviour of the integrand function over the whole class of parametric integrals forces the use of a trial and error approach which may result in unnoticed unreliable @xmath3 pairs and , consequently , bad output failure .",
    "the _ a posteriori _ assessment of the reliability of the @xmath3 pair over the current integration subrange @xcite solves only half of the problem since the code remains highly inefficient .",
    "the _ a priori _ verification of the conditioning of the integrand profile at the quadrature knots , which was proposed by us some time ago @xcite needed in fact , a whole set of hierarchically ordered criteria providing _ bayesian inference _",
    "@xcite on the status of the _ gradually generated _ integrand profile at newly added quadrature knots .",
    "the _ root _ of the resulting bayesian inference decision tree is the _ diagnostic of the behaviour of the integrand function @xmath5 at the boundaries @xmath1 and @xmath2 of the finite integration domain @xmath0$]_. to set it , a suitable integrand sampling is required inside a _ mesoscopic neighbourhood of the boundary layer of _",
    "@xmath0 $ ] .",
    "the present paper generalizes the analysis done in @xcite over minimal four point partitions inside the mesoscopic regions associated to each of the ends @xmath1 and @xmath2 of @xmath0 $ ] . by allowing an _ unrestricted _ four point partition , the diagnostic failures stemming from the inadequacy of a frozen integrand sampling",
    "are avoided , resulting in analysis reliability enhancement for difficult integrand functions .",
    "let @xmath6 denote either @xmath7 or @xmath8 , the floating point representations of the endpoints @xmath1 and @xmath2 of @xmath0 $ ] .",
    "the analysis establishes the status of the value @xmath9 , the _ floating point representation of the computed value of the integrand _ , @xmath10 , as follows :    * _ diagnostic : smooth integrand behaviour_. + _ bayesian inference _ : _ regular _ quadrature knot mesh over @xmath0 $ ] can be generated starting from the @xmath6 endpoint .",
    "+ _ supplementary information _ : the analysis also generates an estimate of the lateral derivative @xmath11 inside @xmath0 $ ] .",
    "this will serve to the formulation of acceptance check criteria for the two quadrature knots which lie nearest and next nearest to @xmath6 . in case of rejection",
    ", the decision to perform the _ immediate subrange subdivision of @xmath0 $ ] _ , without generating the integrand profile at the remaining quadrature knots is taken . *",
    "_ diagnostic : endpoint or outer singularity of @xmath5 or its derivatives_. + _ bayesian inference _ : _ slow convergence _ is to be expected under subrange subdivision .",
    "use of a specific subrange subdivision procedure based on bisection together with a convergence acceleration procedure ( e.g. , the epsilon extrapolation algorithm ) are a must . * _ diagnostic : inner nearby singularity_. + _ bayesian inference _ :",
    "the occurrence of an offending inner singular point @xmath12 near @xmath6 is to be further confirmed . under affirmative diagnostic",
    ", @xmath12 is to be located to machine accuracy . the input integral is then split into two integrals , over @xmath13 and @xmath14 $ ] , each being further processed following the procedure adequate for endpoint singularity . *",
    "_ diagnostic : inner nearby finite jump . _ + _ bayesian inference _ : further confirmation of the existence of an offending inner jump point @xmath12 near @xmath6 is necessary . under affirmative diagnostic , @xmath12 is to be located to machine accuracy . the input integral is then split into two integrals , over @xmath15 and @xmath16 $ ] , with @xmath17 and @xmath18 taking values equal to the lateral limits of @xmath5 and @xmath19 at @xmath12 .",
    "the resulting integrals over the two subintervals are to be solved for smooth @xmath5 . *",
    "_ diagnostic : irregular behaviour_. + _ bayesian inference _ : the output of the automatic procedure could hardly be taken for reliable .",
    "clarification of the offending integrand behaviour is a must . * _ diagnostic : smooth integrand behaviour at both ends @xmath1 and @xmath2_. + _ bayesian inference _ : early check for the presence of an _ oscillatory or odd integrand _ is useful .",
    "if an affirmative diagnostic is issued , then _ define a ceiling accuracy of the expected output _",
    ", originating in severe precision loss due to heavy cancellation by subtraction .",
    "the function @xmath20\\subset\\mathbb{r}\\rightarrow\\mathbb{r } , f = f(x)$ ] , is _ smooth _ inside a lateral mesoscopic neighbourhood @xmath21 $ ] of the reference abscissa @xmath6 denoting the floating point representation of either the end @xmath1 or the end @xmath2 of @xmath0 $ ] , provided the computed values of the first order divided differences of @xmath5 over any abscissa sampling inside @xmath22 are _ independent on the choice of the sampling abscissas_. [ theor : smooth ]    the result stated in theorem  [ theor : smooth ] essentially follows from the property that , for any reference abscissa @xmath23 of a continuous twice differentiable function @xmath24 , a nonvanishing neighbourhood @xmath25 does exist inside which the _ linear _ taylor series expansion of @xmath5 around @xmath26 holds true within some predefined accuracy threshold @xmath27 .",
    "[ rem : taylor ]    the numerical check of the continuity of @xmath5 at the ends of the integration domain @xmath0 $ ] can only be done from a _ sampling of its computed values _",
    ", @xmath28 , over a set of @xmath29 machine number arguments @xmath30 , @xmath31 , @xmath32 . if @xmath33 denote the _ actual _ values of @xmath34 over @xmath35 , then , due to the round - off , @xmath36 in general . as a consequence ,",
    "the best information on the smoothness properties of @xmath5 at @xmath6 following from the set @xmath37 is obtained from the scrutiny of the properties of a second degree polynomial least squares fit to the floating point data .",
    "a problem in terms of _ machine number abscissas _ is obtained by the scale transformation @xmath38 where @xmath39 denotes the algebraic distance from @xmath6 to its nearest machine number inside @xmath0 $ ] .",
    "this leads to the second degree fitting polynomial @xmath40 spanned by the _",
    "orthonormal _ basis polynomials @xmath41 .",
    "a _ linear _ polynomial fitting over @xmath35 is obtained provided @xmath42 is _ negligible everywhere _ at @xmath43 $ ] , @xmath44 , @xmath45 . making all calculations requested by the least squares procedure",
    "then results in the statement of the theorem , qed .    if we assume a _ minimal mesh sampling _",
    "@xmath46 characterized by the abscissa set @xmath47 , then the following _ smoothing criteria _ emerge : @xmath48\\approx 0 , \\quad       d\\sb{ij}=f\\sb{i}-f\\sb{j}.    \\label{eq : crit1}\\ ] ] [ cor : crita ]    if we assume a _ minimal mesh sampling _",
    "@xmath46 characterized by the abscissa set @xmath49 , then the following _ smoothing criteria _ emerge : @xmath50 [ cor : critb ]    if the analysis issued the diagnostic of smooth @xmath5 at the endpoint @xmath6 , then the following estimate for the lateral first order derivative @xmath11 inside @xmath0 $ ] holds , @xmath51 [ cor : deriv ]",
    "to allow useful inferences , the analysis done in the previous section has to be supplemented , on one side , with a quantitative measure of the smallness of the differences defined in corollaries  [ cor : crita ] and  [ cor : critb ] and , on the other side , with qualitative criteria able to single out those specific unique features which characterize other integrand behaviours inside a mesoscopic neighbourhood of @xmath6 .    *",
    "4.1 . smoothness threshold . * the practical implementation of the smoothness criteria  ( [ eq : crit1 ] ) and  ( [ eq : crit2 ] ) compares the magnitudes of the expressions entering the left hand sides of these equations with an _ integrand dependent upper threshold _ , @xmath52 where @xmath53 , the machine epsilon with respect to addition , defines the machine accuracy dependent parameter of the solution , while @xmath54 , @xmath55 , is a heuristic parameter intended to overcome possible diagnostic errors coming from the normal roundoff noise . in practice",
    ", we have found that a value @xmath56 resulted in adequate diagnostics for all the tested smooth case study functions @xmath5 .",
    "the diagnostic reliability decreases as long as the magnitudes of one or more of the quantities entering the eqs .",
    "( [ eq : crit1 ] ) or  ( [ eq : crit2 ] ) get near @xmath57 .    *",
    "4.2 . endpoint or outer singularity . *",
    "the basic features of such a behaviour are : inward monotonically decreasing @xmath58 under @xmath59 ; steep variation of @xmath5 over argument distances separated by one or a few machine numbers ; inward monotonically decreasing @xmath60 .",
    "if the sampling of corollary  [ cor : crita ] is generated , then the addition of two supplementary abscissas at @xmath61 and @xmath62 respectively and the confirmation of the abovementioned three features once again over the resulting smaller subranges distinguishes singular behaviour from an inner finite jump near @xmath6 .    *",
    "inner nearby singularity . * the features of this kind of behaviour are mirror reflected with respect to those of an endpoint or outer singularity .    *",
    "inner nearby finite jump .",
    "* there are two hints suggesting this diagnostic .",
    "first , the sharp increase of the magnitude of one of the first order divided differences approximating @xmath19 over the subranges defined by sampling .",
    "second , the feature gets enhanced if a finer partition is defined over the subrange in question .    * 4.5 . irregular behaviour . * this negative diagnostic is usually associated with the occurrence of rapid oscillations of @xmath5 which make the usual local quadrature rules ineffective .",
    "the analysis described above yields diagnostics issued by a code which runs within an environment defined by the hardware and the software at hand . the _ code robustness , reliability , and portability _",
    "are secured provided several delicate points are adequately solved .",
    "the last code versions were run on several pcs with intel 4 + , amd32 , or amd64 processors , linux 2.4 or linux 2.6 + operating systems , and the gnu gcc compiler incorporating fortran 77 .",
    "early code versions were also run on sun workstations in bltp - jinr , or under microsoft xp os .",
    "the study of the conformity of the hardware and software of the abovementioned systems to the _ ieee 754 standard _ which governs the floating    point arithmetic ( see , e.g. , @xcite ) , revealed the occurrence of four instances where the requirements of the standard were more or less frequently infringed : ( i ) _ length of the significand ; _ ( ii ) _ floating point comparisons ; _ ( iii ) _ code optimization ; _ ( iv ) _ underflow threshold_.    * 5.1 . length of the floating point double precision significand .",
    "* under the standard compliant value of the machine epsilon with respect to addition , @xmath63 , often analysis failure has been noticed .",
    "this was identified to stem from the _ loss of the last , assumed significant , 53-rd bit _ under reuse of _ exact _ data after their ram / cache storage .",
    "the simplest possible case study of hidden bit loss is illustrated in fig .",
    "1a : the quantities @xmath64 , @xmath63 , @xmath65 , are computed and stored in an array ( to force ram / cache storage ) and then the differences @xmath66 are plotted .",
    "under ieee 754 standard observance , the _ constant answer _ , @xmath67 should had been obtained .",
    "however , this result is obtained indeed under @xmath68 .",
    "1b illustrates the same effect when exploring integrand behaviour around a singular point on an example taken from quadpack , @xcite , p.110 , @xmath69 the values @xmath70 have been computed and compared with the exact ones .",
    "several spuriously equal output pair are noticed at pairs of assumed neighbouring machine number arguments , which spoil the reliability of the analysis .",
    "increase of @xmath53 to @xmath68 rules out such spurious pairs ( fig .",
    "* 5.2 . floating point comparisons . * in the example",
    "( [ eq : snglr3 ] ) , @xmath71 may be either transferred from a procedure to another one using the @xmath72 value which retains the most significant @xmath73 binary bits in the significand , or it may be directly computed in cpu from the original expression @xmath74 , in which case the processor stored @xmath75 value retains the most significant @xmath76 binary bits .",
    "the ieee 754 standard asks that @xmath75.eq.@xmath77.true .",
    "none of the two compilers available to us ( f77 , c++ gcc ) did obey to this requirement .",
    "since the use of floating point comparison was unavoidable , special care was taken to exclude all the possible @xmath78 to @xmath79 comparisons .",
    "code optimization by the compiler .",
    "* we might try to write a code in which use of @xmath78 values is always secured in comparison operations by asking the transfer of each variable entering such operation to ram / cache , followed by their transfer back to cpu . in its search for `` efficiency '' increase ,",
    "the code optimization by the compiler finds such a trick `` unnecessary '' , thus spoiling the output correctness .",
    "the observation is not singular @xcite .    *",
    ". the underflow threshold .",
    "* on all but one computers at our disposal , the standard value @xmath80 was found to be right .",
    "however , on one of the mentioned sun workstations the code crashed at @xmath80 , while the value @xmath81 was found to be ok .    *",
    "catastrophic precision loss in the neighbourhood of a non - zero singular point .",
    "* two supplementary features present in figures 1b and 1c deserve consideration : ( i ) the computed function values are different from the exact ones _ starting with the most significant bit_. ( ii ) the use of the primary quadpack expression listed in eq .  ( [ eq : snglr3 ] ) ( data labelled `` l53'',``l52 '' ) infringes the left - right symmetry of the exact data .    in spite of this severe precision loss due to cancellation by subtraction , correct inferences based on the use of the unique features characterizing a singular behaviour ( paragraph 4.2 ) are still possible due to the fact that the computed `` wrong data '' _ preserve _ the ordering relationships characteristic to the `` true data '' .    if a substitution of variable which moves the singularity to the origin is possible , then all the difficulties enumerated at paragraphs 5.2 , 5.3 , and 5.5 are completely removed ( fig .",
    "the boundary layer problem asks for accurate and reproducible diagnostics of integrand @xmath5 behaviour at the endpoints @xmath1 and @xmath2 of a finite integration domain @xmath0 $ ] .    in the present paper",
    "we have discussed several critical issues which dramatically influence code robustness and reliability .",
    "generalizations of the results previously reported in @xcite allows significant improvement of code quality by :    \\(i ) definition of smooth behaviour from an _ unrestricted _ least squares analysis over small ( mesoscopic ) neighbourhoods of the endpoints @xmath1 and @xmath2 .",
    "this secures the derivation of continuity criteria valid _ everywhere _ over the mesoscopic range where the analysis is done .",
    "\\(iv ) identification of the critical hardware and software features which could spoil the correctness of the diagnostics by deviation from the ieee 754 standard and code reformulation such as to become insensitive to such drawback of the computing environment .",
    "the correct solution of the boundary layer problem is the first from a set of hierarchically ordered problems the solutions of which should allow _ a priori _ bayesian inferences on efficient and reliable mesh generation within automatic adaptive quadrature .",
    "the solution of such problems is planned to be discussed in subsequent reports .",
    "this research was partially financed within the ceex contract cex 05-d11 - 68/11.10.2005 in ifin - hh and theme 09 - 6 - 1060 - 2005/2007 in lit - jinr .",
    "the authors acknowledge the financial support received within the `` hulubei - meshcheryakov '' programme , jinr order no . 726/06.12.2005 for participation to mmcp 2006 conference ."
  ],
  "abstract_text": [
    "<S> the boundary layer of a finite domain @xmath0 $ ] covers mesoscopic lateral neighbourhoods , inside @xmath0 $ ] , of the endpoints @xmath1 and @xmath2 . </S>",
    "<S> the correct diagnostic of the integrand behaviour at @xmath1 and @xmath2 , based on its sampling inside the boundary layer , is the first from a set of hierarchically ordered criteria allowing _ a priori _ bayesian inference on efficient mesh generation in automatic adaptive quadrature . </S>"
  ]
}