{
  "article_text": [
    "given an @xmath6 hermitian matrix @xmath1 , the _ spectral density _ , also commonly referred to as the _ density of states _ ( dos ) , is formally defined as @xmath7 here @xmath8 is the dirac distribution commonly referred to as the dirac @xmath8-``function '' ( see e.g.  @xcite ) , and the @xmath9 s are the eigenvalues of @xmath1 , assumed here to be labeled non - decreasingly .",
    "the dos is an important quantity in many physics problems , in particular in quantum physics , and a large volume of numerical methods were developed by physicists and chemists  @xcite for this purpose . besides being used as a qualitative visualization tool for understanding spectral characteristics of the matrix",
    ", the dos can also be used as to quantitatively compute the trace of a matrix function , as given in the formal formulation below @xmath10 = \\sum_{i=1}^{n } f(\\lambda_{i } ) \\equiv    n \\int_{-\\infty}^{\\infty }    f(t)\\phi(t ) { \\,\\mathrm{d}}t .",
    "\\label{eqn : tracefa}\\ ] ] here @xmath11 is a smooth function , and the formal integral in eq .",
    "should be interpreted in the sense of distribution .",
    "if one had access to all the eigenvalues of @xmath1 , the task of computing the dos would become a trivial one .",
    "however , in many applications , the dimension of @xmath1 is large .",
    "the computation of its entire spectrum is prohibitively expensive , and a procedure that relies entirely on multiplications of @xmath1 with vectors is the only viable approach .",
    "fortunately , in many applications @xmath1 only has @xmath5 nonzero entries , and therefore the cost of matrix - vector multiplication , denoted by @xmath12 , is @xmath5 . in some other cases",
    "the matrix is a dense matrix but fast matrix - vector multiplication method still exists with @xmath13 cost , where @xmath14 is a integer that is not too large .",
    "this is the case when the matrix - vector multiplication can be carried out effectively with fast algorithms , such as the fast fourier transform ( fft ) , the fast multipole method ( fmm )  @xcite , the hierarchical matrix  @xcite , and the fast butterfly algorithm  @xcite , to name a few . rigorously speaking ,",
    "the dos is a distribution and can not be directly approximated by smooth functions . in order to assess the accuracy of a given numerical scheme for estimating the dos",
    ", the dos must be properly _",
    "regularized_. the basic idea for estimating the dos is to first expand the regularized dos using simple functions such as polynomials",
    ". then it can be shown that the estimation of the dos can be obtained by computing the trace of a polynomial of @xmath1 , which can then be estimated by repeatedly applying @xmath1 to a set of random vectors .",
    "this procedure has been discovered more or less independently by statisticians  @xcite and by physicists and chemists  @xcite , and will be referred to as hutchinson s method in the following . in physics",
    "such method is often referred to as the kernel polynomial method ( kpm )  @xcite with a few different variants .",
    "a recent review on the choice of regularization and different numerical methods for estimating the dos is given in  @xcite .",
    "there are also a variety of randomized estimators that can be used in hutchinson s method , and the quality of different estimators is analyzed in  @xcite .",
    "* contribution .",
    "* to the extent of our knowledge , all randomized methods so far for estimating the dos are based on different variants of hutchinson s method .",
    "these methods estimate the dos by averaging the information obtained from @xmath3 random vectors directly .",
    "the numerical error , when properly defined , decays asymptotically as @xmath15 . as a result ,",
    "high accuracy is difficult to achieve : every extra digit of accuracy requires increasing the number of random vectors by @xmath16 fold .    in this work",
    ", we demonstrate that the accuracy for estimating the regularized dos can be significantly improved by making use of the _ correlated information _ obtained among different random vectors .",
    "we use the fact that each point of the dos can be evaluated as the trace of a numerically low rank matrix , and such trace can be evaluated by repeatedly applying @xmath1 to a small number of random vectors , and by taking certain linear combination of the resulting vectors .",
    "if different set of random vectors were needed for different points on the spectrum the method will be prohibitively expensive .",
    "however , we demonstrate that it is possible to use _ the same set of random vectors _ to `` sweep through '' in principle the entire spectrum .",
    "therefore we call our method a `` spectrum sweeping method '' .",
    "our numerical results indicate that the spectrum sweeping method can significantly outperform hutchinson type methods in terms of accuracy , as the number of random vectors @xmath3 becomes large",
    ". however , the computational cost and the storage cost can still be large when the dos needs to be evaluated at a large number of points .",
    "furthermore , the accuracy of the spectrum sweeping method may be compromised when the right number of randomized vectors is not known _ a priori_. we develop a robust and efficient implementation of the spectrum sweeping method to overcome these two problems .",
    "under certain assumption on the distribution of eigenvalues of the matrix @xmath1 , and the cost of the matrix - vector multiplication is @xmath5 , we demonstrate that the computational cost of the new method scales as @xmath4 and the storage cost scales as @xmath5 for increasingly large matrix dimension @xmath17 .",
    "we also demonstrate that the new method for evaluating the dos can be useful for accurate trace estimation as in eq .",
    ".    * other related works . *",
    "the spectrum sweeping method is not to be confused with another set of methods under the name of `` spectrum slicing '' methods  @xcite .",
    "the idea of the spectrum slicing methods is still to obtain a partial diagonalization of the matrix @xmath1 .",
    "the main advantage of spectrum slicing methods is enhanced parallelism compared to conventional diagonalization methods . due to the natural orthogonality of eigenvectors corresponding to distinct eigenvalues of a hermitian matrix ,",
    "the computational cost for each set of processors handling different parts of the spectrum can be reduced compared to direct diagonalization methods",
    ". however , the overall scaling for spectrum slicing methods is still @xmath18 when a large number of eigenvalues and eigenvectors are to be computed .    * notation . * in linear algebra notation ,",
    "a vector @xmath19 is always treated as a column vector , and its conjugate transpose is denoted by @xmath20 . for a randomized matrix @xmath21 , its entry - wise expectation value",
    "is denoted by @xmath22 $ ] and its entry - wise variance is denoted by @xmath23 $ ] .",
    "we call @xmath24 a ( real ) random gaussian matrix , if each entry of @xmath25 is real , and follows independently the normal distribution @xmath26 . in the case",
    "when @xmath27 , @xmath25 is called a ( real ) random gaussian vector .",
    "the imaginary unit is denoted by @xmath28 .",
    "the paper is organized as follows . in section",
    "[ sec : dos ] we introduce the dos estimation problem .",
    "we also demonstrate the delta - gauss - chebyshev ( dgc ) method , which is a variant of the kernel polynomial method , to estimate the dos .",
    "we develop in section  [ sec : doslowrank ] the spectrum sweeping method based on the randomized estimation of the trace of numerically low rank matrices , and demonstrate a robust and efficient implementation of the spectrum sweeping method in section  [ sec : robustdoslowrank ] .",
    "we show how the dos estimation method can be used to effective compute the trace of a matrix function in section  [ sec : traceest ] .",
    "following the numerical results in section  [ sec : numer ] , we conclude and discuss the future work in section  [ sec : conclusion ] .",
    "without loss of generality , we shall assume that the spectrum of @xmath1 is contained in the interval @xmath29 .",
    "for a general matrix with spectrum contained in the interval @xmath30 , we can apply a spectral transformation @xmath31 the spectrum of @xmath32 is contained in @xmath29 , and all the discussion below can be applied to @xmath32 .",
    "the fact that the spectral density @xmath33 is defined in terms of dirac @xmath8-functions suggests that no smooth function can converge to the spectral density in the limit of high resolution , in the usual @xmath34 norms ( @xmath35 )  @xcite . in order to compare different numerical approximations to the spectral density in a meaningful way",
    ", the dos should be regularized .",
    "one simple method is to employ a gaussian regularization @xmath36 .",
    "\\label{}\\ ] ] here @xmath37 is a gaussian function . in the following",
    "our goal is to compute the smeared dos @xmath38 .",
    "the key of computing the dos is the estimation of the trace of a matrix function without diagonalizing the matrix . to the extent of our knowledge",
    ", randomized methods developed so far are based on hutchinson s method or its variants  @xcite .",
    "the following simple and yet useful theorem is a simple variant of hutchinson s method and explains how the method works .",
    "[ thm : evartrace ] let @xmath0 be a hermitian matrix , and @xmath39 be a random gaussian vector , then @xmath40 = \\operatorname{tr}[a ] , \\quad \\mathrm{var } [ w^ { * } a w ] =      2\\sum_{i\\ne j } ( { \\mathrm{re}}a_{ij})^2 .",
    "\\label{eqn : evartrace}\\ ] ]    first @xmath40 = \\mathbb{e}\\left[\\sum_{ij } w_{i } w_{j }    a_{ij}\\right ] =    \\sum_{i } a_{ii } = \\operatorname{tr}[a].\\ ] ] here we used that @xmath41= 0 , \\quad \\mathbb{e } [ w w^ { * } ] = i$ ] and @xmath42 is a real vector .",
    "this follows directly from that each entry of @xmath42 is independently distributed and follows the gaussian distribution @xmath26 .",
    "second , @xmath43 = & \\mathbb{e } \\left[(w^ { * } a w)^2 -      ( \\operatorname{tr}[a])^2\\right ]    = \\mathbb{e } \\left[\\sum_{ijkl } w_{i } w_{j } w_{k } w_{l } a_{ij }    a_{kl } - ( \\operatorname{tr}[a])^2\\right]\\\\    = & \\sum_{ik } a_{ii } a_{kk } + 2 \\sum_{i\\ne j } ( { \\mathrm{re}}a_{ij})^2 -    ( \\sum_{i } a_{ii})^2 = 2 \\sum_{i\\ne j } ( { \\mathrm{re}}a_{ij})^2 .    \\end{split}\\ ] ]    using theorem  [ thm : evartrace ] , if we choose @xmath44 to be a random gaussian matrix , then @xmath45 \\approx \\frac{1}{n_{v}}\\operatorname{tr}[w^{*}g_{\\sigma}(ti - a ) w].\\ ] ]    in practice in order to compute @xmath46 , we can expand @xmath47 into polynomials of @xmath1 for each @xmath48 , and then evaluate the trace of polynomial of @xmath1 . a stable and efficient implementation can be obtained by using chebyshev polynomials .",
    "other choices of polynomials such as legendre polynomials can be constructed similarly . using the chebyshev polynomial ,",
    "@xmath49 is approximated by a polynomial of degree @xmath50 as @xmath51 the coefficients @xmath52 need to be evaluated for each @xmath48 .",
    "since the dirac @xmath8-function is regularized using a gaussian function , following the notion in  @xcite we refer to eq .   as the `` delta - gauss - chebyshev '' ( dgc ) expansion .",
    "since @xmath53 is a smooth function on @xmath29 , the coefficient @xmath54 in the dgc expansion can be computed as @xmath55 here @xmath56 is the kronecker @xmath8 symbol .",
    "with change of coordinate @xmath57 , and use the fact that @xmath58 , we have @xmath59 eq .   can be evaluated by discretizing the interval @xmath60 $ ] using a uniform grid , and the resulting quadrature can be efficiently computed by the fast fourier transform ( fft ) .",
    "this procedure is given in alg .",
    "[ alg : dgcexpansion ] , and this procedure is usually inexpensive .    [ cols= \" < , < \" , ]",
    "for large hermitian matrices that the only affordable operation is matrix - vector multiplication , randomized algorithms can be an effective way for obtaining a rough estimate the dos .",
    "however , so far randomized algorithms are based on hutchinson s method , which does not use the correlated information among different random vectors .",
    "the accuracy is inherently limited to @xmath2 where @xmath3 is the number of random vectors .",
    "we demonstrate that randomized low rank decomposition can be used as a different mechanism to estimate the dos . by properly taking into account the correlated information among the random vectors , we develop a spectrum sweeping ( ss ) method that can sweep through the spectrum with a reasonably small number of random vectors and the accuracy",
    "can be substantially improved compared to @xmath2 . however , for spectrally uniformly distributed matrices with a large number of points to evaluate the dos , the direct implementation of the spectrum sweeping method can have @xmath18 complexity .",
    "we also present a robust and efficient implementation of the spectrum sweeping method ( ress ) . for spectrally",
    "uniformly distributed matrices , the complexity for obtaining the dos can be improved to @xmath4 , and the extra robustness comes from a hybridization with hutchinson s method for estimating the residual .",
    "we demonstrate how the regularized dos can be used for estimating the trace of a smooth matrix function .",
    "this is based on a careful balance between the smoothness of the function and that of the dos .",
    "such balance is implemented through a deconvolution procedure .",
    "numerical results indicate that this allows the accurate estimate of the trace with again @xmath4 scaling .",
    "the current implementation of the spectrum sweeping method is based on chebyshev polynomials .",
    "motivated from the discussion in  @xcite , lanczos method would be more efficient than chebyshev polynomials for estimating the dos , and it would be interesting to extend the idea of spectrum sweeping to lanczos method and compare with chebyshev polynomials .",
    "we also remark that the spectrum sweeping method effectively builds a low rank decomposition near each point on the spectrum for which the dos is to be evaluated .",
    "combining the deconvolution procedure as in the trace estimation and the low rank decomposition could be potentially useful in some other applications to directly estimate the whole or part of a matrix function .",
    "for instance , in electronic structure calculation , the diagonal entries of the fermi - dirac function is needed to evaluate the electron density . these directions will be explored in the future .",
    "this work is partially supported by the scientific discovery through advanced computing ( scidac ) program and the center for applied mathematics for energy research applications ( camera ) funded by u.s .",
    "department of energy , office of science , advanced scientific computing research and basic energy sciences , and by the alfred p. sloan fellowship .",
    "we thank the anonymous referees for their comments that greatly improved the paper .",
    "g.  a. parker , w.  zhu , y.  huang , d.  hoffman , d.  j. kouri , matrix pseudo - spectroscopy : iterative calculation of matrix eigenvalues and eigenvectors of large matrices using a polynomial expansion of the dirac delta function , comput .",
    "96 ( 1996 ) 2735 .",
    "h.  m. aktulga , l.  lin , c.  haine , e.  g. ng , c.  yang , parallel eigenvalue calculation based on multiple shift ",
    "invert lanczos and contour integral based spectral projection method , parallel comput .",
    "40 ( 2014 ) 195212 ."
  ],
  "abstract_text": [
    "<S> for a large hermitian matrix @xmath0 , it is often the case that the only affordable operation is matrix - vector multiplication . in such case , </S>",
    "<S> randomized method is a powerful way to estimate the spectral density ( or density of states ) of @xmath1 . </S>",
    "<S> however , randomized methods developed so far for estimating spectral densities only extract information from different random vectors independently , and the accuracy is therefore inherently limited to @xmath2 where @xmath3 is the number of random vectors . in this paper we demonstrate that the `` @xmath2 barrier '' can be overcome by taking advantage of the correlated information of random vectors when properly filtered by polynomials of @xmath1 . </S>",
    "<S> our method uses the fact that the estimation of the spectral density essentially requires the computation of the trace of a series of matrix functions that are numerically low rank . by repeatedly applying @xmath1 to the same set of random vectors and taking different linear combination of the results </S>",
    "<S> , we can sweep through the entire spectrum of @xmath1 by building such low rank decomposition at different parts of the spectrum . under some assumptions , we demonstrate that a robust and efficient implementation of such spectrum sweeping method can compute the spectral density accurately with @xmath4 computational cost and @xmath5 memory cost . </S>",
    "<S> numerical results indicate that the new method can significantly outperform existing randomized methods in terms of accuracy . as an application </S>",
    "<S> , we demonstrate a way to accurately compute a trace of a smooth matrix function , by carefully balancing the smoothness of the integrand and the regularized density of states using a deconvolution procedure . </S>"
  ]
}