{
  "article_text": [
    "the existence of some sort of hierarchical order is an apparently widespread feature of many complex systems , including gene @xcite and human brain @xcite networks , ecosystems @xcite , social and urban structures @xcite , the internet @xcite or open - source communities @xcite .",
    "the presence of such underlying order in the multiscale organization of complex systems is a long standing hypothesis @xcite giving rise to the idea of hierarchy as a central concept -see also @xcite . although usually treated only in qualitative terms , some formal approaches to the problem have been proposed .",
    "the efforts towards a well - defined quantification of hierarchical order have been improving by means of complex networks theory . as a key part of their organization",
    ", dedicated efforts have been made towards a proper identification of hierarchical trends .",
    "one outcome of these efforts has been a number of powerful , heuristic measures @xcite .",
    "often , a nested organization -formally identical to order , in set - theoretical terms @xcite- can be identified as the basis of hierarchical order .",
    "if we think in hierarchy in these terms , we might agree with herbert simon that `` it is a commonplace that nature loves hierarchies '' -cited in @xcite .",
    "many examples belong to this picture . within the context of matter organization ,",
    "molecules are made of atoms , which result from the combination of elementary particles , some of which having also internal subunits ( as quarks ) .",
    "similarly , the relation of characteristic scales of organization by inclusion of one in another , like chinese boxes or matryoshka dolls , has been seen as a sort of hierarchical organization .",
    "another relevant example is the case of fractal structures which naturally define a hierarchy of self - similar objects .",
    "finally , within the context of taxonomy , spin glasses or optimization theory , the use of _ ultrametricity _ has also allowed to define hierarchical order @xcite .",
    "biological hierarchies have also evolved through time as part of a process that generates high - level entities out of nesting lower - level ones @xcite",
    ". however , taxonomic classification trees are probably the most obvious representation of a hierarchy based on inclusion . in biology ,",
    "living beings are individuals grouped in _ taxa",
    "_ according their characteristics . starting from species ,",
    "a nested hierarchy is defined where species belong to genera , which are included within families forming orders and so forth . here",
    ", every organism is , in principle , unambiguously classified and therefore no uncertainty can be associated to the process of classification .    alternatively to the view of nestedness",
    ", a hierarchical organization can be defined in a structure of causal relations .",
    "paradigmatic examples are the flowchart of a company or the chain of command in the army , where the authority concept defines a particular case of causal relation .",
    "causality induces an asymmetrical link between two elements , and this asymmetry , either by inclusion or through any kind of causal relation , defines an order .",
    "we observe that any circular or symmetrical relation between two elements violates the concept of order , thereby intuitively loosing its hierarchical nature . from this perspective ,",
    "any feedforward relation is potentially hierarchical .",
    "such feedforward structures pervade a diverse range of phenomena and structures , from phylogenetic trees to river basins .",
    "a common feature of most of the approaches mentioned above is that the notion of _ hierarchy _ is basically identified with the concept of _ order_. order is a well defined concept in mathematics @xcite but , is order enough to grasp the intuitive idea of hierarchy ?",
    "can we actually define what is _ hierarchy _ ? quoting herbert simon , @xcite .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ ( ... ) a hierarchical system -or hierarchy- can be defined in principle as a system that is composed of interrelated subsystems , each of the latter being also hierarchic in structure until the lowest scale is reached . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    this definition does not provide a clear formalization of hierarchy as a measurable feature , although it certainly grasps the intuitive idea of hierarchy . how can such a general measure be defined ?",
    "it is reasonable to assume that we have a hierarchy if there is no ambiguity ( or uncertainty ) in the chain of command followed for any individual to the chief in the flowchart .",
    "we shall call this feature the _ definiteness condition_. this is also valid for nested structures .",
    "one might think that this condition is justified by a single chain of command or in the case of matryoshka dolls .",
    "however , such structures are already defined within order theory as _ totally ordered _",
    "( see fig .",
    "[ fig1]a ) .",
    "order and hierarchy are closely related but they are not essentially the same . in this paper",
    "we reserve the word _",
    "hierarchy _ to designate a concept that goes beyond the definition of order .",
    "we argue that the difference stems from the fact that a hierarchical structure must also satisfy a _",
    "pyramidal organization _",
    "constraint -see fig .",
    "( [ fig1]b ) . in other words ,",
    "the lower the layer of organization , the larger the number of entities it contains .",
    "but , what happens when this pyramid structure is inverted ? intuitively , they would not be hierarchical but anti - hierarchical . in this work",
    "we show how information theory naturally provides the suitable framework to characterize hierarchy in causal structures . within this theoretical apparatus",
    "we provide the rigorous definition of the hierarchy index for causal structures and how it is applied in some illustrative examples establishing a distinction among hierarchical , non - hierarchical and anti - hierarchical .",
    "in this section we will present the basic theoretical background used in this paper , grounded both in order and graph theories . at the end of this section",
    "we will formally define the _ causal graph _",
    ", the key concept of this theoretical framework where the proposed hierarchy measures are applied .      hierarchy is undoubtedly tied to order",
    "this is why we make a brief review of order theory highlighting some features that have been commonly attributed to hierarchy .",
    "the first task is to define an ordered pair between two elements @xmath0 of a given set @xmath1 , to be written as @xmath2 , @xmath3 or , in a formally equivalent way : @xmath4 this latter formalization explicitly defines order from an inclusion relation @xcite .",
    "this immediately connects to standard views of hierarchical systems , as we already mentioned , in which inclusion relations are considered essential . having defined an ordered pair",
    ", we define an order relation .",
    "let @xmath5 be a countable , finite set and @xmath6 a relation .",
    "such a relation is an _ order relation _",
    "-rigorously speaking , a _ strict partial order_- if the following condition holds : @xmath7    we finally define two subsets of @xmath1 from the definition of order relation which will be useful to characterize the kind of structures studied in this paper .",
    "the set of maximal elements of @xmath1 , to be written as @xmath8 , is defined as : @xmath9 similarly , the set of minimal elements , to be written as @xmath10 is defined as : @xmath11      let @xmath12 be a directed graph , being @xmath13 , the set of nodes , and @xmath14 the set of arcs -where the order , @xmath15 implies that there is an arc in the following direction : @xmath16 . given a node @xmath17",
    ", the number of outgoing links , to be written as @xmath18 , is called the _ out - degree _ of @xmath19 and the number of ingoing links of @xmath19 is called the _ in - degree _ of @xmath19 , written as @xmath20 .",
    "the _ adjacency matrix _ of a given graph @xmath21 , @xmath22 is defined as @xmath23 ; and @xmath24 otherwise . through the adjacency matrix , @xmath25 and @xmath26",
    "are computed as @xmath27 furthermore , we will use the known relation between the @xmath28-th power of the adjacency matrix and the number of paths of length @xmath28 going from a given node @xmath19 to a given node @xmath29 specifically , @xmath30 is the number of paths of length @xmath28 going from node @xmath19 to node @xmath29 @xcite .",
    "it is said that @xmath19 _ dominates _",
    "@xmath31 if @xmath32 . a _ feed - forward _ or _ directed acyclic graph _ ( dag ) is a directed graph characterized by the absence of cycles : if there is a _ directed path _ from @xmath19 to @xmath31 ( i.e. , there is a finite sequence @xmath33 ) then , there is no directed path from @xmath31 to @xmath19 .",
    "conversely , the matrix @xmath34 depicts a dag with the same underlying structure but having all the arrows ( and thus , the causal flow ) inverted .",
    "the _ underlying graph _ of a given dag @xmath21 , to be written as @xmath35 , is the undirected graph @xmath36 obtained by substituting all arcs of @xmath37 , @xmath38 by edges giving the set @xmath39 .",
    "a dag @xmath21 is said to be _ connected _ if for any pair of nodes combination @xmath40 there is a finite sequence of pairs having the following structure @xmath41 being @xmath42 .",
    "given the acyclic nature of a dag , one can find a finite value @xmath43 as follows : @xmath44 it is easy to see that @xmath45 is the length of the longest path of the graph .    borrowing concepts from order theory @xcite , we define the following set : @xmath46 to be named the set of _ maximal nodes _ of @xmath21 , by which @xmath47",
    ". additionally , one can define the set of nodes @xmath48 as @xmath49 to be referred as the set of _ minimal nodes _ of @xmath21 .",
    "the set of all paths @xmath50 , @xmath51 , from @xmath52 to a given node @xmath53 is indicated as @xmath54 .",
    "given a node @xmath53 , the set of all paths from @xmath52 to @xmath19 is written as @xmath55 furthermore , we will define the set @xmath56 as the set of all nodes participating in this path , except the maximal one .",
    "conversely , the set @xmath57 is the set of all nodes participating on this path , except the minimal one . attending to the node relations depicted by the arrows , and due to the acyclic property , at least one node ordering can be defined , establishing a natural link between order theory and dags",
    "this order is achieved by labeling all the nodes with sequential natural numbers and obtaining a configuration such that : @xmath58 the existence of this labeling connects order relations with directed acyclic graphs .",
    "finally , throughout this paper we reserve the word _",
    "tree _ to refer to those graphs where all nodes excluding the maximal one have @xmath59 and all nodes except the minimal ones display @xmath60 .",
    "therefore , we distinguish between chains ( all nodes with @xmath61 excluding the minimal one ) and trees .      in a causal graph",
    "we only consider immediate relations between elements i.e. two elements are causally related if there exists just one cause - effect event relating them .",
    "we explicitly neglect those relations between nodes which can only be derived by transitivity .",
    "a causal relation can be illustrated by genetic inheritance in a genealogy .",
    "offspring s characters come from its parents and indirectly from its grandparents .",
    "therefore , no direct causal relation can be defined between grandparents and grandsons .",
    "however , it is true that grandparents indirectly determine the characters of grandsons , due to the transitive nature of the genetic relations .    in this work",
    "we will restrict the use of the term _ causal relation _ to refer to direct relations such as direct parent - sons relations , as described in the above example . a causal graph",
    "@xmath62 is a directed graph where @xmath63 are the elements of a set ( the members of a family , in the above described example ) and @xmath37 are the _ causal relations _ that can be defined between the members of @xmath63 . in this work ,",
    "we restrict the term _ causal graphs _ to graphs being _ acyclic _",
    "( i.e. , dags ) and _ connected_. the former property avoids conflicts in the definition of the causal flow .",
    "the latter property assumes that two non - connected causal structures have no relation among them , and therefore must be considered as two independent systems .",
    "hereafter , we will refer to the set of paths @xmath54 as the set of _ causal paths_.",
    "in this section we propose the basis for a rigorous evaluation of hierarchy .",
    "we begin by defining the features of what we consider as the _ perfect hierarchical structure_. as will be shown below , our proposed definition of hierarchy matches with an ordered structure with special features , thereby making an explicit difference between order and hierarchy .",
    "therefore , we reserve the term hierarchy to refer to a special class of order . within the framework of graph theory , the required conditions naturally match those displayed by a tree - like feedforward graph .",
    "then , as we shall see , the estimator we propose identifies the feed - forward tree topology as perfectly hierarchical .",
    "the main point of the section is devoted to the definition of a quantitative estimator of hierarchy based on two entropy measures that captures the intuitive ideas described in the introductory section : the definiteness and pyramidal organization condition .",
    "we stress that the forthcoming formalism applies only to the class of _ causal graphs_.      we are going to refer to a system as _ perfectly hierarchical _ if it satisfies the following conditions .",
    "let us consider a system depicted by a _ causal graph _ @xmath64 .",
    "we say that this graph @xmath65 will be perfectly hierarchical if the following two conditions hold :    1 .   _",
    "definiteness condition.- _ for every element @xmath66 there is only one element @xmath17 , @xmath67 such that @xmath68 .",
    "a straightforward consequence of this condition is that @xmath69 2 .",
    "_ pyramidal condition.- _ there is a partition @xmath70 of the set @xmath63 , i.e. , @xmath71 by which : @xmath72 a direct consequence of the above is that @xmath73 which reflects the pyramidal structure of the graph .",
    "a measure of hierarchy must properly weight the deviations of the studied graph from the above requirements .",
    "one could add another condition , by imposing that every node in a given layer dominates the same number of nodes contained in the next downstream layer . in formal terms , this implies that , in addition to the above conditions , we can add a third one , namely :    \\3 .",
    "_ symmetry condition_. it is established by means of @xmath74 which actually corresponds to a so - called complete @xmath28-ary tree ( gross and yellen , 1999 ) . therefore , in those cases where symmetry is considered as an inherent feature of ideal hierarchy , deviations from symmetrical configurations must also be taken into account in our quantitative approximation .",
    "maximals exhibiting and inverted pyramidal condition ( note that inverting the arrows we would have a tree - like graph ) e ) an ordered but no hierarchical linear chain violating the pyramidal condition and f ) an inverted tree - like structure where no definiteness and pyramicity conditions are satisfied onwards but completely satisfied backwards.,width=264 ]    let us summarize the above statements @xmath75 , @xmath76 and @xmath77 and their consequences . the so - called _ definiteness condition",
    "_ implies that _ there is no uncertainty _ in identifying the premise of a given causal relation , i.e. , the node that immediately governs a given node .",
    "taking into account the definition of causal graph , ( essentially , a connected dag ) this first statement restrict to tree structures the number of candidates for perfectly hierarchical structures .",
    "note that these trees -including linear chains- have a single root node , i.e. , @xmath78 .",
    "the _ pyramidal condition _",
    "rules out from the set of perfectly hierarchical structures those dags having linear chains in their structure . in other words , nodes displaying @xmath79 are not allowed .",
    "we observe that , according to the pyramidal condition , @xmath80 therefore , it is straightforward to conclude that the most simple representation of an ideal hierarchical structure is a binary tree -see fig ( [ fig2]a)- , in which the above inequality becomes equality for all successive layers .",
    "this is consistent with standard graph theory and the definition of perfect binary tree .",
    "finally , the _ symmetry condition _ , optional for our definition of hierarchy , rules out those trees which are not perfectly symmetrical . whereas trees shown in figs .",
    "( [ fig2]a ) and ( [ fig2]b ) can be considered hierarchical by virtue of conditions @xmath75 and @xmath76 , condition @xmath77 makes a distinction between them , being only perfectly hierarchical the first one .    as a final remark ,",
    "let us note that one can build non - hierarchical and anti - hierarchical structures , by simply violating some of the conditions we stated above , namely the pyramidal condition alone -fig .",
    "( [ fig2]e)- or both the definiteness and the pyramidal condition , -see fig .",
    "( [ fig2]d and [ fig2]f ) .",
    "it is easy to see that a quantitative estimator of hierarchy should account for limit cases and place as intermediate point structures such as the one depicted in fig .",
    "( [ fig2]c ) .",
    "the above features describe the _ perfect _ hierarchical structure . in this section",
    "we go further and we provide the basis for a definition of a _ hierarchical index _ of a causal graph grounded in the framework of information theory .",
    "this index provides a quantitative estimation of how far is a given causal graph from the conditions of a perfect hierarchy .    in the following subsections",
    "we will define two entropies for a causal graph , attending to the top - down and bottom - up observations of the causal graph according to the onward and backward flows in the graph .",
    "the aim of this mathematical formalism is to quantify the impact of the number of pathways in the causal graph .",
    "specifically , we will consider the balance between the _ richness _ of causal paths ( a top - down view ) versus the _ uncertainty _ when going back reversing the causal flow ( i.e. , a bottom - up perspective ) .",
    "then , attending to the direction of the flow we interpret the top - down view as a richness whilst the bottom - up as an uncertainty in terms of topological reversibility as recently introduced in @xcite . arguably , the larger is the number of decisions going down , the higher is the richness of causal paths .",
    "similarly , the larger the number of alternative pathways to climb up , the larger will be the uncertainty in recovering the causal flow . in the following subsections , we will explore , within the framework of information theory , the relationship between diversity and uncertainty and the their impact in the fulfillment of the hierarchy conditions .",
    "we begin this section with a brief revision of the core concepts of information theory , to be used as our theoretical framework .    according to classical information theory @xcite ,",
    "let us consider a system @xmath81 with @xmath82 possible states , whose occurrences are governed by a random variable @xmath83 with an associated probability mass function formed by @xmath84 . according to the standard formalization , the _ uncertainty _ or _ entropy _ associated to @xmath83 , to be written as @xmath85 , is :",
    "@xmath86 which is actually an average of @xmath87 among all events of @xmath81 , namely , @xmath88 , where @xmath89 is the _ expectation _ or average of the random quantity between parentheses .",
    "analogously , we can define the _",
    "conditional entropy_. given another system @xmath90 containing @xmath91 values or choices , whose behavior is governed by a random variable @xmath92 , let @xmath93 be the conditional probability of obtaining @xmath94 if we already know @xmath95 .",
    "then , the conditional entropy of @xmath92 from @xmath83 , to be written as @xmath96 , is defined as : @xmath97      the first task is to study the degree of reversibility of causal paths , thereby considering the role of the _ definiteness condition_. this will be evaluated by computing the uncertainty in reversing the process starting from a given node in @xmath48 . the formalism used in this section is close to the one developed in @xcite .",
    "we first proceed to define the probability distribution from which the entropy will be evaluated .",
    "accordingly , the probability to chose a path @xmath98 from node @xmath99 by making a random decision at every crossing when _ reverting _ the causal flow is : @xmath100 the conditional entropy obtained when reverting the flow from @xmath53 will be : @xmath101 the overall uncertainty of @xmath21 , written as @xmath102 , is computed by averaging @xmath103 over all minimal nodes , i.e :    @xmath104\\nonumber\\\\    & = & \\sum_{v_i\\in\\mu}q(v_i ) \\sum_{v_j\\in v(\\pi(v_i)}\\log ( k_{in}(v_j))\\left[\\sum_{\\pi_k : v_j\\in v(\\pi_k)}\\mathbb{p}(\\pi_k|v_i)\\right]\\nonumber\\\\ & = & \\sum_{v_i\\in\\mu}q(v_i ) \\sum_{v_k\\in v\\setminus m}\\phi_{ik}({\\cal g})\\log k_{in}(v_k ) . \\label{entropia1}\\end{aligned}\\ ] ]    where we assume , unless indicated : @xmath105 instead of a vector , now we construct a @xmath106 matrix , @xmath107 accounting for the combinatorics of paths and how they contribute to the computation of entropy .",
    "@xmath108_{ij}\\equiv\\phi_{ij}({\\cal    g})=\\sum_{\\pi_k : v_j\\in    v(\\pi_k)}\\mathbb{p}(\\pi_k|v_i).\\nonumber\\end{aligned}\\ ] ] this represents the probability to reach @xmath29 starting from @xmath19 .",
    "now we derive the general expression for @xmath109 . to compute the probability to reach a given node",
    ", we have to take into account the probability to follow a given path containing such a node , defined in ( [ pprod ] ) . to rigorously connect it to the adjacency matrix",
    ", we first define an auxiliary , @xmath110 matrix @xmath111 , namely : @xmath112 where @xmath113 . from this definition ,",
    "we obtain the explicit dependency of @xmath109 from the adjacency matrix , namely , @xmath114^k({\\cal    g})\\right)_{ij}. \\label{phi(b)}\\ ] ] and accordingly , we have @xmath115 ^ 0({\\cal g})\\right)_{ii}=1.\\ ] ] therefore , we already obtained the explicit form of such a conditional entropy , namely : @xmath116 assuming equiprobability , the above expression leads to : @xmath117      let us now estimate the topological richness of a causal graph , i.e. , the average amount of information needed to describe a given top - down path within the structure .",
    "let us observe that the kind of question we are trying to answer is the same than the one explored above , but considering the top - down approach .",
    "therefore , the mathematical form of this quantity , to be referred as @xmath118 , will be formally analogous to the previous one , but considering that we are going onwards according to the causal flow . thus : @xmath119 where @xmath120 is the cardinality of @xmath52 -the set of maximal nodes .",
    "@xmath121 is analogous to @xmath122 of equation ( [ hgeneral ] ) . in this case , elements @xmath123 of matrix @xmath124 represent the probability to cross node @xmath31 departing from @xmath125 according to the causal flow .",
    "the explicit expression of @xmath124 is defined from matrix @xmath126 : @xmath127 then , @xmath128^k({\\cal g})\\right)_{ij}. \\label{phi(b)}\\ ] ] and as above , we have @xmath129 ^ 0({\\cal g})\\right)_{ii}=1.\\ ] ]      as we shall see , the above definition of information will bring us the ingredients to define a hierarchy index according to the list detailed in section [ section : conceptual ] . roughly speaking , what we propose in the following lines",
    "is to evaluate the balance between the pyramidal structure of the graph against the degree of reversibility of the paths it generates , i.e , the balance between @xmath130 and @xmath131 .",
    "however , in order to rigorously characterize hierarchy , we need to properly treat the studied graph attending to the different layers of its feedforward structure .",
    "the analysis of the graph structure allows us to identify and quantify deviations from the perfect structure at any level of the graph .",
    "the starting point will involve the characterization of a layered structure within the graph defining a partition @xmath132 of the set of nodes .",
    "involved in the evaluation of hierarchy . @xmath133 and @xmath134 are obtained through successive application of bottom - up leaf removal algorithm , which implies that we remove all nodes having @xmath135 . @xmath136 and @xmath137 are obtained by the successive application of a top - down leaf removal algorithm , thereby removing the nodes having @xmath138 .",
    "we observe that the generation of @xmath139 and @xmath140 implies the breaking of the net -see text.,width=283 ]    given the dag @xmath141 , let us define two partitions of @xmath63 , @xmath70 and @xmath142 .",
    "the members of such partitions are the layers of the dag by either performing a top down or bottom up _ leaf removal algorithm _ @xcite .",
    "specifically , the first members of such partitions are defined as : @xmath143 and @xmath144 we observe that @xmath145 and that @xmath146 . with the above subsets of @xmath63 we can define the graphs @xmath147 , and @xmath148 in the following way : @xmath149 and @xmath150 respectively .",
    "similarly , we build @xmath151 as : @xmath152 and @xmath153 respectively .",
    "we therefore defined two sequences of subgraphs of @xmath21 ordered by inclusion , namely : @xmath154 and @xmath155 where it is easy to observe that : @xmath156 in fig .",
    "( [ fig : leafremovals ] ) we describe the generation of these subsets of graphs for a given toy model of dag . in summary , we constructed two collections of subsets by finding the layered structure using a bottom - up leaf removal algorithm ( pruning the elements having @xmath135 successively ) and a top - down leaf removal algorithm ( i.e. , pruning the elements having @xmath138 ) .",
    "notice that , even if @xmath157 one can not assume @xmath158 except in symmetrical cases .          in order to generate a normalized estimator @xmath159 ( between @xmath160 and @xmath161 ) accounting for the balance between @xmath162 and @xmath102 we will define it as",
    ": @xmath163 since both the layered structure and its pyramidal composition must be taken into account , the hierarchical index of the graph must be weighted taking into account the successive layers of the system .",
    "this avoids to identify as completely hierarchical those structures not perfectly satisfying the _ pyramidal condition_. therefore , the _ hierarchical index of a feed - forward net _ , to be indicated as @xmath164 will be the average among the @xmath165 subgraphs @xmath166 , the @xmath165 subgraphs @xmath167 and @xmath21 itself -note that we average between @xmath168 objects , i.e. : @xmath169 it is strictly necessary to take into account all these subgraphs in order to identify any violation of the hierarchy conditions at any level of the structure . we can go a step further by imposing symmetry in the pyramidal structure as suggested above , to distinguish among different topologies such as those displayed in figure ( [ fig2]a ) .",
    "let us indicate by @xmath170 the set of paths from @xmath52 to @xmath48 present in the graph @xmath171 .",
    "the so - called _",
    "jensen s inequality _",
    "@xcite provides an upper bound of the information content which , in our case reads : @xmath172 we observe that a ) is only achieved when all @xmath173 from @xmath52 to @xmath48 are equiprobable , being this equiprobability an indicator of symmetry .",
    "the same applies to b ) , but now we consider the bottom - up estimator , when paths are considered from @xmath48 to @xmath52 . in this case , attending to the symmetric condition we can define and estimator analogous to @xmath174 , namely , @xmath175 accordingly , the symmetrized version of the hierarchy index , @xmath176 , would be : @xmath177 to ensure the consistency of @xmath178 and @xmath179 we must overcome the last conceptual problems .",
    "when performing the leaf removal operation one can break the graph in many connected components having no connections among them .",
    "let us indicate as @xmath180 the set of components of our graph @xmath181 , each of them obtained from the set @xmath182 of nodes and their . in this case ,",
    "the natural way to proceed is to average the individual contributions of the different connected components of @xmath183 or @xmath184 according to the number of nodes they have against @xmath185 or @xmath186 , leading to : @xmath187 the same applies for @xmath188 for the computation of @xmath179 . finally , we impose , for both mathematical and conceptual consistency that : @xmath189 furthermore , if @xmath190 , ( i.e. , the case where the graph consists of a single node ) : @xmath191 according to this formulation some scenarios would lead to @xmath192 .",
    "the simplest one is the just mentioned by definition , consisting of a single node .",
    "another one is the linear feed - forward chain having @xmath193 or more linked nodes .",
    "it is clear that in these cases , @xmath194 .",
    "it is worth to stress that this particular situation matches with the causal graph of a total order relation , and therefore , we have the way to differentiate this particular graph from other structures having null hierarchy .",
    "finally , a third class of structures belongs to the family of non - hierarchical graphs .",
    "they give @xmath195 since @xmath196 .",
    "this is the case of erds rnyi dags or dag cliques . in these cases ,",
    "the causal graph is not hierarchical because all the diversity of paths generated when crossing the causal flow downwards is neutralized by the uncertainty in recovering any causal path backwards .       and @xmath197 .",
    "for both graphs we add , in an iterative way , arcs at random until we reach the feed forward clique configuration .",
    "note that the link addition to the two initial tree - like structures converge in the same full connected configuration which contains @xmath198 links .",
    "for both experiments squares represent @xmath178 values , and triangles @xmath199 . as expected , @xmath200 , except in limit cases .",
    "the small graphs provide a visual clue for type of structures we are obtaining through the arc enrichment process . for every point in the chart , mean and standard deviation were calculated from @xmath201 replicas .",
    "entropies were computed considering @xmath202.,width=321 ]    in this section we evaluated the hierarchy of several toy models in order to intuitively grasp the scope of the measure . in fig .",
    "( [ figgrafets ] ) we evaluated the hierarchy index ( both the raw one and the symmetrical one ) for several structures leading to hierarchical , anti - hierarchical and non - hierarchical structures .",
    "the figure illustrates the impact of number of maximals and minimals and the multiplicity of pathways in relation to the existence of a pyramidal and predictable structure .",
    "we observe that deviations from tree and inverted tree configurations lead to a non binary interpretation of hierarchy .",
    "furthermore , we measured ( fig .",
    "( [ figevolution ] ) the impact in terms of hierarchy of arc addition preserving the acyclic character .",
    "staring from two extreme tree graphs ( the feedforward and the inverted ones , respectively ) we add arcs at random until we reach a fully connected feed - forward structure in both situations .",
    "we consider the starting point of our numerical experiment a binary tree , @xmath203 containing @xmath204 nodes .",
    "we construct an inverted binary tree @xmath205 by the transposition of the adjacency matrix of @xmath203 . in both graphs",
    "we say that , consistently with the ordering property of dags , given an arc @xmath206 then @xmath207 . in an iterative process we construct two new dags @xmath208 where @xmath209 labels the number of additions of new arcs to the underlying @xmath203 and @xmath205 .",
    "the process ends when graphs achieve the directed acyclic clique condition , i.e. , the linearly ordered graph @xmath210 containing @xmath211 nodes : @xmath212 for statistical significance , we performed @xmath201 replicas of the numerical experiment .",
    "then @xmath213 and @xmath214 and their respective standard deviations were calculated for each set of iterations .",
    "( [ figevolution ] ) shows that starting from an initial value of @xmath215 for @xmath203 and @xmath216 for @xmath205 , the addition of feed - forward arcs causes a decrease in absolute value of the hierarchical indexes until @xmath217 corresponding to a total linear ordered structure where every possible feed - forward path is included in the graph . as expected , @xmath200 except in the extreme full - connected cases .",
    "we finally test the case of a directed acyclic erds rnyi ( er ) graph @xmath218 .",
    "this is an interesting example of a topologically homogeneous dag with non - correlation in terms of @xmath25 and @xmath26 @xcite .",
    "graphs were obtained by the construction of an undirected er graph @xmath219 where @xmath220 is the set of edges ( undirected links ) . directed acyclic condition was obtained by a process of random numbering of nodes @xcite .",
    "the direction of the arrows was defined attending @xmath221 ( i.e. , condition depicted in eq .",
    "( 6 ) ) fig .",
    "[ er ] shows a representative behavior of the null hierarchical character of @xmath218 ensembles .",
    "notice that the normal distribution is centered for @xmath178 and @xmath222 at zero values , indicating that such random structures have not any hierarchical organization .     and",
    "@xmath222 for an ensemble of @xmath223 replicas of directed acyclic er graphs of @xmath224 and @xmath225 caption .",
    "numerical results show gaussian - like distributions centered at zero .",
    "notice that @xmath222 distribution displays a narrower variation than the @xmath178 one in agreement to the @xmath226 inequality.,width=302 ]",
    "hierarchical patterns are known to pervade multiple aspects of complexity . in spite of their relevance ,",
    "it is not obvious in general how to formalize them in terms of a quantitative theory .",
    "this paper presents a definition of hierarchy to be applied to the so - called _ causal graphs _ ,",
    "i.e. , connected , directed acyclic graphs where arcs depict some direct causal relation between the elements defining the nodes .",
    "it is therefore a measure of hierarchy over the structure of the causal flow .",
    "the conceptual basis of this measure is rooted in two fundamental features defining hierarchy : the absence of ambiguity in recovering the causal flow and the presence of a pyramidal structure .",
    "the hierarchy index presented here weights the deviations from such general properties .",
    "the specific expression for this index is derived using techniques and concepts from information theory .",
    "it is shown , thus , that the requirements of hierarchy naturally fit the tension between richness in causal paths against the uncertainty in recovering them depicted by a balance between two conditional entropies .    under our previous assumptions",
    ", we have shown that the feed - forward tree is the structure that fully satisfies the conditions for a perfect hierarchical system .",
    "interestingly , trees as perfect representations of hierarchies is a long - standing idea @xcite . in this way",
    ", our mathematical formalization establishes a bridge between the qualitative idea of hierarchy and its quantification .",
    "our approach allows to measure the hierarchy of any system provided that it can be represented in a feedforward causal graph .    throughout the paper we emphasized that although hierarchy is deeply tied to order , there are strong reasons to go beyond it .",
    "the most obvious one is that _ order _ is a well established concept and therefore , there is no need for the use of a different word , if we identify it with hierarchy . but another important issue must be taken into account tied to the intuitive notion of hierarchy we propose .",
    "we propose that hierarchy must feature the pyramidal nature of the connective patterns and that this pyramidal structure must be in agreement with the top - down nature of the feed - forward flow of causality .",
    "information theory reveals extremely suitable to define a hallmark to study hierarchy in the terms described in this paper : the richer the structure ( but at the same time , reversible , in topological terms ) , the more hierarchical it is . in this way , since the conditions we defined for a system to be perfectly hierarchical lead us to conclude that a feed forward tree is the perfect hierarchical structure since maximizes the richness without loss of predictability .",
    "it is worth to note that precisely , the pyramidal condition is the key point to guarantee the the predictability .",
    "the extreme case is the feedforward clique - see fig .",
    "[ figgrafets ] ) .",
    "although richness can be increased through pathway redundancy , this effect cancels out due to decreased predictability , leading to a non hierarchical structure .",
    "a particular case is the linear chain .",
    "this representation of a total order relation has null values of both entropies .",
    "in other words , a perfect predictable system but without richness . it is worth to note that both cases are not pyramidal structures .",
    "by contrast , anti - hierarchical ones exhibit an inverted pyramidal structure leading to a different effect . from the perspective of our formalism",
    ", the anti - hierarchical organization occurs by minimizing richness and predictability . in consequence , other structure",
    "different than an inverted tree will be less anti - hierarchical .",
    "therefore it is easy to see that the hierarchical index in absolute value measures the closeness of an ( anti)-hierarchical tree structure capturing somehow the path complexity of the structure .",
    "further work should explore the relation of this theoretical achievement within the framework of a formal measure of complexity .",
    "additionally , this research could be expanded to a more general class of directed graphs containing cycles .",
    "this latter point would be achieved by properly defining a measure of _ how well ordered _ is a net , for it is clear that the presence of cycles will generate conceptual problems in the identification of the causal flow .",
    "this work was supported by the eu @xmath227 framework project complexdis ( nest-043241 , crc and jg ) , the ute project cima ( jg ) , fundacin marcelino botn ( crc ) , the james mcdonnell foundation ( bcm and rvs ) and the santa fe institute ( rvs ) .",
    "we thank complex system lab members for fruitful conversations and an anonymous reviewer for his / her constructive suggestions .",
    "d.  s. bassett , e.  bullmore , b.  a. verchinski , v.  s. mattay , d.  r. weinberger , and a.  meyer - lindenberg .",
    "hierarchical organization of human cortical networks in health and schizophrenia .",
    ", 28:92399248 , 2008 ."
  ],
  "abstract_text": [
    "<S> in this paper we explore the concept of hierarchy as a quantifiable descriptor of ordered structures , departing from the definition of three conditions to be satisfied for a hierarchical structure : _ order _ , _ predictability _ and _ pyramidal structure_. according to these principles we define a hierarchical index taking concepts from graph and information theory . </S>",
    "<S> this estimator allows to quantify the hierarchical character of any system susceptible to be abstracted in a feedforward causal graph , i.e. , a directed acyclic graph defined in a single connected structure . </S>",
    "<S> our hierarchical index is a balance between this predictability and pyramidal condition by the definition of two entropies : one attending the onward flow and other for the backward reversion . </S>",
    "<S> we show how this index allows to identify hierarchical , anti - hierarchical and non hierarchical structures . </S>",
    "<S> our formalism reveals that departing from the defined conditions for a hierarchical structure , feedforward trees and the inverted tree graphs emerge as the only causal structures of maximal hierarchical and anti - hierarchical systems , respectively . </S>",
    "<S> conversely , null values of the hierarchical index are attributed to a number of different configuration networks ; from linear chains , due to their lack of pyramid structure , to full - connected feedforward graphs where the diversity of onward pathways is canceled by the uncertainty ( lack of predictability ) when going backwards . </S>",
    "<S> some illustrative examples are provided for the distinction among these three types of hierarchical causal graphs .        </S>",
    "<S> * the idea of hierarchy has been largely attributed to a disparate number of systems and , although easily perceived , its quantification is not a trivial issue . in this work </S>",
    "<S> we quantify the hierarchy of a given causal structure with a feedforward structure . starting with the representation of a system of causal relations as a graph </S>",
    "<S> , we define a non heuristic measure of hierarchy having strong grounds on the principles of information theory . </S>",
    "<S> we depart from the definition of the conditions for a system to be considered perfectly hierarchical : a pyramidal structure with a completely predictable reversion of the causal flow . in this context , a hierarchy index is defined by weighting how far is a given feedforward structure from these conditions . </S>",
    "<S> as we shall see , structures that fully satisfy this property belong to a special class of trees . </S>",
    "<S> our estimator allows to establish a quantitative criterion for the definition of hierarchic , non - hierarchic and anti - hierarchic networks . * </S>"
  ]
}