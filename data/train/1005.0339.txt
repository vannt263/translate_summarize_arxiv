{
  "article_text": [
    "in the following , we note @xmath2 the total number of signals exchanged by alice and bob during the protocol . we note @xmath0 and @xmath1 the classical data of alice and bob , respectively , after they have measured their quantum states , and @xmath3 refers to the quantum state of the eavesdropper .",
    "the formalism developed in @xcite allows for the following generalization of the secret - key rate of a discrete - variable qkd protocol which is secure against collective attacks @xcite : @xmath4 this key rate has to be compared to the asymptotic key rate @xmath5 given by @xmath6 and four differences can be noticed .    first , only @xmath7 signals are used for the establishment of the key , out of the @xmath2 signals exchanged .",
    "this is due to the fact that @xmath8 signals are used for parameter estimation .",
    "this leads to the presence of the prefactor @xmath9 in front of the secret key rate .",
    "note that this factor is not very critical : it would become relevant if a qkd protocol were to be implemented and commercialized as it limits the rate of the protocol , but in practice , it has little effect on the final rate , say a factor @xmath10 if @xmath11 of the data are used for parameter estimation .",
    "indeed , the real theoretical challenge today is to decide whether a qkd protocol can be used to distill a secret key for some given conditions ( of losses and noise ) .",
    "from this point of view , optimizing every possible parameter in order to maximize the secret key rate seems a little bit premature .",
    "second , the usual conditional entropy @xmath12 has to be replaced by the expression @xmath13 taking into account the finite precision of the parameter estimation . indeed , whereas the quantum channel can be assumed to be perfectly known in the asymptotic regime , here , this can only be achieved with a finite precision related to the probability @xmath14 that the true values of the @xmath15 channel parameters are not inside the confidence region computed from the parameter estimation procedure .",
    "note there is never unicity of such a confidence region : one is free to optimize his choice among all possible regions compatible with the failure probability @xmath14 .",
    "this choice can be based on the simplicity of the description of the region ( for instance the cartesian product of @xmath15 intervals corresponding to each estimated parameter ) , or on an optimization maximizing the final secret key rate , in which case the confidence region is a very general region in the @xmath15-dimensional space of the parameter space .",
    "unfortunately , such an optimization is often rather complicated to perform , and in general , one chooses confidence regions with very simple shapes ( one is referred to ref .",
    "@xcite for a discussion of such considerations in the case of bb84 ) .",
    "there also exists a trade - off between the desired level of precision of the parameter estimation ( in particular , the number @xmath15 of parameters one considers ) and the number @xmath16 of signals which have to be sacrificed to this end .",
    "for instance , it is known that for bb84 , in the asymptotic regime , a full tomography of the state increases the secret key rate @xcite .",
    "this is not necessary true anymore in a finite - size context . in @xcite",
    ", the authors suggest that in the limit where @xmath2 tends to infinity , the optimal number of samples @xmath16 used for the parameter estimation should be on the order of @xmath17 .",
    "however , for reasonable values of the block length @xmath2 , the number of samples needs to be much larger than @xmath17 , especially in the case of continuous - variable protocols .    for bb84",
    ", only one parameter needs be estimated in theory : the quantum bit error rate ( qber ) . in practice , however , depending on the implementation , additional parameters might need being estimated especially if weak coherent states are sent instead of true single photons , for instance in the case where the decoy - state technique @xcite is applied . using hoeffding s inequality for instance",
    ", one can find a confidence interval ( parameterized by @xmath14 ) for the qber such that the true value of the parameter is inside the interval with probability at least @xmath18 . in the case",
    "where several parameters must be estimated ( for instance in continuous - variable qkd protocols ) , the notion of confidence interval should be replaced by a multi - dimensional confidence region such that the true value of the parameters lies in the region with a probability at least @xmath19 . then one needs to compute the minimum value of the conditional entropy @xmath12 compatible with the confidence interval : this gives @xmath13 .",
    "whereas this procedure is relatively straightforward for the qber ( which is a bounded parameter since @xmath20 ) , we will see in the following that the question is more involved for continuous - variable qkd protocols where one needs to estimate _ a priori _ unbounded parameters such as the excess noise . in this paper , we will consider two parameters to be estimated in continuous - variable qkd : the transmission @xmath21 and the excess noise @xmath22 . in principle , these are not the only parameters to be estimated in a real implementation as one also needs to know alice s modulation variance ( as well as the electronic noise and the quantum efficiency of the detectors if one considers a scenario where bob s detection is calibrated ) , but one can reasonably assume that this parameter is relatively well known , in comparison to @xmath21 and @xmath22 .",
    "third , @xmath23 corresponds to the amount of information which needs to be exchanged by alice and bob during the reconciliation phase .",
    "this quantity is necessarily equal or larger than the conditional entropy @xmath24 , but in practice , it always turns out out be strictly larger than the optimal value .",
    "we would like to emphasize that the effect of an imperfect reconciliation , which is parameterized by @xmath23 here , was already taken into account for the study of continuous - variable qkd through the so - called _ reconciliation efficiency _ @xmath25 .",
    "this reconciliation efficiency gives the fraction of @xmath26 , the mutual information between alice and bob s data , that the legitimate parties are able to exploit in practice .",
    "more precisely , the size of the ( identical ) bit strings shared by alice and bob after the reconciliation procedure is @xmath27 ( the factor @xmath7 is a reminder that only @xmath7 couples of data are processed for the key distillation , the rest being used for parameter estimation ) .",
    "this imperfect reconciliation efficiency has been for a long time the cause of the limited range of cv qkd protocols ( and still is for the protocols involving a gaussian modulation ) . in the case of discrete - variable qkd protocols ,",
    "@xmath23 is typically modeled as : @xmath28 where @xmath29 is a parameter characterizing the reconciliation efficiency ( in a slightly different way than @xmath25 for continuous - variable reconciliation ) and @xmath30 is the probability that the reconciliation fails and that this failure goes undetected by alice and bob . and @xmath25 are related to each other ( for binary variables ) through @xmath31 using the fact that @xmath32 for symmetric binary variables , one obtains @xmath33 in practice , this probability can be made arbitrarily small .",
    "finally , the parameter @xmath34 is related to the security of the privacy amplification .",
    "its value is given by : @xmath35 where @xmath36 is the hilbert space corresponding to the variable @xmath0 used in the raw key , @xmath37 is a _ smoothing _ parameter and @xmath38 is the failure probability of the privacy amplification procedure .",
    "both the smoothing parameter @xmath37 and @xmath38 are intermediate parameters which should be optimized numerically .",
    "the first term of @xmath34 , that is the square - root term , actually corresponds to the speed of convergence of the smooth min - entropy ( which is the appropriate measure of the key length ) of an independent and identically distributed ( i.i.d . ) state ( remember that we consider collective attacks here ) toward the von neumann entropy .",
    "indeed , only in the asymptotic limit is the smooth min - entropy of an i.i.d .",
    "state equal to its von neumann entropy .",
    "the second term is directly linked to the failure probability @xmath38 of the privacy amplification procedure .    note that if one was to consider general security , it would be necessary to add to eq .",
    "[ finite - size - rate ] another correction term linked to the use of the exponential version of de finetti theorem @xcite , or to the postselection technique @xcite and this would give an even more pessimistic key rate . however , in the case of bb84 for instance , collective attacks are optimal , even in the case of finite size analysis , and such terms are therefore not required . for cv qkd protocols",
    ", it is also conjectured but not yet proven that collective attacks are always optimal .",
    "therefore , it makes sense to consider the finite size analysis when the eavesdropper is restricted to collective attacks . without the proof of the optimality of collective attacks",
    ", one could use the bound derived in @xcite for the application of an exponential version of de finetti theorem for infinite - dimensional hilbert spaces .",
    "however , because this bound , which is not believed to be tight , leads to very pessimistic results , we prefer not to take it into account here , and therefore limit our analysis to the case of collective attacks .    in the end",
    ", one needs to fix an overall security parameter @xmath39 for the quantum key distribution protocol . indeed",
    ", contrary to the more usual asymptotic scenario , no such thing as _ perfect security _ can exist in a finite - size setting , and one is limited to @xmath39-security",
    ". the ( small ) parameter @xmath39 corresponds to the failure probability of the whole protocol , meaning that the protocol is assured to performed as is supposed to except with a probability at most @xmath39 .",
    "again , here , we do not consider problems due to an imperfect implementation , which might lead to the existence of side - channels that can be used by an eavesdropper .",
    "the failure probability @xmath39 can be computed from the various parameters described above , and in the limit of small parameters , one has : @xmath40    note that all parameters @xmath41 and @xmath38 can independently be fixed at arbitrarily low values ( possibly by increasing the total number @xmath2 of exchanged signals to a rather high value ) :    * @xmath14 can be made as low as desired simply by increasing the size of the sample used for parameter estimation ( and therefore not used for establishing a key ) .",
    "* @xmath30 can be decreased with the following procedure : alice and bob simply need to compute a hash of their respective bit strings after the reconciliation and to publicly compare it .",
    "this method is very interesting because computing a hash acts like an error amplification : even if the original strings only differ for a few bits out of several millions , their hash will be different with a very high probability .",
    "hence alice and bob can check that they share a common bit - string while sacrificing only a negligible quantity of data . *",
    "@xmath37 and @xmath38 are virtual parameters that can be optimized in the computation .",
    "they must simply satisfy both equalities [ finite_delta ] and [ finite_epsilon ] .    as a consequence",
    ", the overall security parameter @xmath39 can be chosen arbitrarily small , to a value corresponding to alice and bob s wishes .",
    "obviously , this comes at the cost of decreasing the final secret key size .",
    "traditionally , in the asymptotic regime , one can make the assumption that the quantum channel is perfectly known , before the transmission is even performed .",
    "hence the optimization of the various free parameters can be made before the exchange of data , and the final secret key rate can be in principle known in advance ( as long as the quantum channel behaves as anticipated ) .    in the finite - size scenario ,",
    "the situation is quite different . in particular",
    ", one does not know in advance the characteristics of the quantum channel . to be fair , even after the exchange of quantum signals ,",
    "the quantum channel is only partially known : more precisely , a few relevant parameters ( qber for qubit channels , transmission and excess noise for continuous - variable channels ) are known to lie inside some confidence regions , except with probability @xmath14 .    even if alice and bob do not know in advance the properties of the quantum channel they will use , they can guess them with a reasonable accuracy , making the assumption that no eavesdropper will actually try to control the quantum channel .",
    "note that this guess is only used in order to _ a priori _ optimize various parameters of the protocols and consequently maximize the _ expected _ secret key rate , under a `` normal use '' of the quantum channel .",
    "if an eavesdropper is present , the guess made by alice and bob might not be very good , hence leading to an non optimized use of the quantum channel , but the security of the key distribution will not be affected .",
    "for a continuous - variable qkd protocol , the secret key rate depends ( in the asymptotic limit ) on three main physical parameters : alice s modulation variance @xmath42 , the transmission of the channel @xmath21 and the excess noise @xmath22 which corresponds to the noise on bob s state in excess compared to the shot noise .",
    "the idea is to optimize @xmath42 in order to maximize the expected secret key rate . to do that",
    ", alice and bob can guess the values of @xmath21 and @xmath22 .",
    "the transmission can be evaluated quite precisely with @xmath43 where @xmath44 is the known quantum efficiency of bob s detection and @xmath45 is the distance in kilometers between alice and bob . here , we assume an optical fiber with losses of @xmath46 per kilometer . in practice , alice and bob generally have a good estimate of the value of the transmission of the quantum channel before they start the quantum key distribution protocol .",
    "the value of @xmath22 , on the other hand , depends on the quality of the setup and turns out to be fairly stable from one experimental run of the qkd protocol to the next .",
    "typically , for state - of - the - art implementations , its value is around @xmath47 of the shot noise @xcite .",
    "note that this corresponds to the _ expected _ value of the excess noise . as we will see later",
    ", the measured value might differ significanty from the theoretical value due to a high statistical noise .    at the beginning of the protocol , alice and",
    "bob agree on a particular value of the overall security parameter @xmath39 .",
    "they also agree on a reconciliation protocol , meaning that they know the parameter @xmath30 in advance .",
    "since both @xmath37 and @xmath38 are virtual parameters that have to be optimized afterwards , the rest of the initial ( that is before the quantum distribution ) optimization consists in studying the parameter @xmath14 which quantifies the failure probability of the parameter estimation .",
    "this parameter depends on the number @xmath48 of samples used for this parameter estimation as well as on some properties of the quantum channels such as the expected true values of the parameters @xmath21 and @xmath22 .",
    "therefore , given the expected behavior of the quantum channel , one can infer the value of @xmath16 required to obtain a particular value of the parameter @xmath14 .",
    "this in turn puts a lower bound on the block size @xmath2 necessary to obtain a @xmath39-secure secret key .    at this point , still before the actual start of the quantum key distribution protocol , alice and bob can optimize the values of the total number @xmath2 of signal exchanged , the length of the raw key @xmath7 as well as the optimal value for alice s modulation variance @xmath42 in order to maximize the expected secret key rate compatible with the overall security parameter @xmath39 .",
    "the values of @xmath2 , @xmath7 and @xmath42 can be considered to be fixed at this stage .",
    "then , alice and bob proceed with the quantum exchange part of the qkd protocol : alice sends @xmath2 random coherent states ( or @xmath49 for protocols with heterodyne detection ) according to the modulation characterizing the protocol ( with a modulation variance @xmath42 ) who measures them with a homodyne ( or heterodyne ) detection .",
    "bob informs alice of his measurement choices ( that is , for each state , bob tells alice whether he measured the @xmath50 or the @xmath51 quadrature , or both ) and alice discards the data that bob did not measure .",
    "they publicly disclose @xmath52 of their correlated data in order to estimate the true values of the transmission and excess noise of the quantum channel .",
    "they can therefore compute the value of @xmath53 , the conditional von neumann entropy of bob s data ( which will be used to form the key in a reverse reconciliation procedure ) given eve s quantum state , which is compatible with the estimated parameters except with probability @xmath14 .",
    "if this value is compatible with a positive secret key rate , alice and bob continue with the reconciliation procedure , otherwise they abort the protocol . at the end of the reconciliation procedure , alice and",
    "bob compute the hash of their respective bit strings ( for some well chosen hash function , that is , a randomly chosen hash function from a family such that the equality of both hashes guarantees that the reconciliation procedure worked except with probability @xmath54 ) .",
    "if their strings differ ( because their hashes differ ) , alice and bob abort the protocol .",
    "( note , however , that alice and bob might try to continue with the protocol by exchanging more classical information in order to complete the reconciliation procedure . )",
    "if their hashes are identical , alice and bob compute the final key size compatible with the security parameter @xmath39 ( by optimizing over @xmath37 and @xmath38 ) and perform the privacy amplification , that is , they randomly pick a hash function from a two - universal family of hash functions which outputs a string of length @xmath55 , with @xmath56 the size of the @xmath39-secure secret key that they can extract from their data .",
    "first of all , we would like to emphasize once again that we are only considering here collective attacks and not general attacks .",
    "this decision can be motivated by the fact that the optimality of collective attacks has been proven asymptotically and that it is conjectured that this optimality could hold in a finite - size setting . moreover , the correction terms computed in @xcite are quite large and likely not tight and might hide interesting effects ( such as the dependence of the key rate on parameter estimation ) behind purely technical details such as ( temporary ? ) bounds linked to a particular mathematical proof ( exponential version of de finetti theorem for infinite dimensional hilbert spaces ) .",
    "the main difference between discrete - variable and continuous - variable qkd protocols is obviously the infinite dimensionality of the hilbert space required to describe cv qkd protocols .",
    "this is in general rather problematic when studying the security of cv qkd but it becomes even more annoying when one considers finite size effects . in particular ,",
    "when one is only interested in asymptotic key rates , the dimension problem can be solved by saying that in the end , everything in the experiment is discrete ( even the homodyne detection since the local oscillator has a finite energy ) .",
    "therefore , one can always theoretically bound the dimension of the relevant hilbert space by a number large enough and prove that the correction terms due to this large dimension all go to zero in the asymptotic limit .",
    "unfortunately , for a finite - size scenario , such an approach fails as the convergence toward the asymptotic rate can be heavily slowed for high dimension .",
    "for instance the finite dimension corresponding to the digitalization is often on the order of @xmath57 if one uses @xmath58-bit analog - to - digital converters .",
    "if one compares such a system with a two - dimensional one , equation tells us that the same @xmath34 is attained for a @xmath59 , _",
    "i.e. _ for a value of @xmath7 @xmath60 times higher in the high - dimensional case .",
    "the magnitude of such factors clearly shows that bounding the dimensionality of the system by a finite value is not enough for ensuring its security in practical circumstances .",
    "this dimension should also be as small as possible , and it is important to come up with security proofs that are as dimension - independent as possible .",
    "fortunately , in some continuous variable protocols @xcite , the raw key is encoded on bits , and this allows us to take @xmath61 for the numerical evaluation of the section [ finite_results ] .",
    "when this is not possible , one should be able to replace the real dimension of the system by its _ effective dimension _ , but this remains essentially an open question .",
    "such an effective dimension is generally much smaller than the real dimension and is sufficient to capture the relevant features of the continuous - variable system .",
    "different definitions for this effective dimension can be proposed .",
    "generally however , one defines the effective dimension @xmath62 of a mixed system @xmath63 as : @xmath64 which quantifies the number of states over which @xmath63 is spread @xcite .",
    "for instance , a totally mixed state over @xmath2 orthogonal states has @xmath65 .",
    "a more speculative variant would be to remember that according to @xcite , the proper max - entropy @xmath66 of a state is not given by the rnyi entropy of order 0 ( which diverges for any quantum state of a cv system ) but by the rnyi entropy of order @xmath10 .",
    "therefore one could also define the effective dimension @xmath67 as the exponential of this entropy , that is @xmath68 the advantage of the first definition is that it relates to the energy of the state , and that it is automatically bounded , for any ( physical ) state @xmath63 .    in order to be rigorous",
    ", the above effective dimension defined above will probably be defined under the form of  smooth dimensions \" , depending on a small parameter @xmath39 , in a way similar to the smooth - entropies introduced in @xcite , which have allowed to look at the finite - size effect . in any case , it is intuitively clear that ultimately , it is such effective dimensions that should appear in security proofs of cv qkd protocols .",
    "this question certainly needs to be investigated further .",
    "we stress again that such a problem , which is rather benign in the asymptotic limit , plays a crucial role in a finite - size analysis .",
    "another specificity of cv qkd is that classical entropies are ill - defined for continuous variables : the shannon entropy has to be replaced by a differential entropy , which is not a practical quantity to analyze secret key rates .",
    "for this reason , the expression @xmath69 is inadequate for cv qkd .",
    "the solution is to rewrite the different quantities in terms of mutual information instead of relative entropies .",
    "hence , the previous expression can be replaced by @xmath70 in the case of a cv protocol . here",
    "@xmath71 gives the amount of mutual information alice and bob were effectively capable to extract through the reconciliation phase : @xmath25 is the reconciliation efficiency which ranges from 0 when no information was extracted to 1 for a perfect reconciliation scheme .",
    "while @xmath53 is defined as the minimum conditional entropy compatible with the statistics given by the parameter estimation except with probability @xmath14 , @xmath72 is naturally defined as the _ maximum _ of the holevo information compatible with the statistics except with probability @xmath14 .",
    "hence , in the case of a continuous - variable qkd protocol , the secret key rate obtained for a finite size analysis reads : @xmath73      whereas the question of error - correction was never a crucial issue for dv protocols where it just implied a small correction term , the same is not true for cv protocols _ without postselection_. for these schemes , alice and bob need to be able to extract their mutual information very efficiently . the absence of efficient reconciliation protocols working in the low signal - to - noise ratio ( snr ) regime was , for a long time , the reason why cv protocols could not distribute secret keys as far as their dv counterparts . to be more precise , a reconciliation protocol",
    "is considered efficient if @xmath25 is larger than roughly 80@xmath74 . for such efficiencies",
    ", the correction term appears quite negligible and has a limited impact on the qkd protocol .",
    "for a gaussian modulation , the best known protocols achieve efficiencies higher than 80 @xmath74 only for snr larger than 1 @xcite . for lower snr ( relevant to increase the range of the protocol )",
    ", no good protocol is known for the reconciliation of correlated gaussian variables .",
    "fortunately , this problem can be solved in this regime by switching to a discrete modulation where efficient protocols are available for all snr lower than 1 @xcite .",
    "to summarize , both modulation schemes ( gaussian and discrete ) are useful depending on the working distance of the protocol .",
    "when working at short distances , a gaussian modulation should be chosen whereas a discrete modulation is more adapted to reach longer distances . in both cases ,",
    "the effect of imperfect reconciliation can be taken care of by taking @xmath75 which is a conservative value consistent with state of the art reconciliation schemes .",
    "note that one can make the best of both worlds ( continuous and discrete modulation ) by using a specific eight - dimensional continuous modulation ( see ref .",
    "@xcite for a detailed presentation of such a protocol ) .",
    "for discrete - variable qkd protocols , it turns out that the principal finite - size effect , in terms of its consequences on the secret key rate , is the parameter estimation @xcite .",
    "a similar situation is expected for continuous - variable protocols , the main problem being without any doubt , the estimation of the excess noise @xmath22 .    in this section",
    ", we study the parameter estimation procedure for continuous - variable protocols , without postselection . quite fortunately , despite being described in an infinite dimensional hilbert space , these protocols display only a few parameters that need to be estimated : these are the parameters characterizing the covariance matrix of the state shared by alice and bob in the entanglement - based version of the protocol @xcite . on the positive side",
    ", this covariance matrix can be symmetrized through a technique similar to the one explained in @xcite , and this symmetrized version is described by only two unknown parameters ( in addition to alice s modulation variance ) . on the negative side , in order to be able to estimate the two relevant parameters , it seems that one still has to make the assumption of a gaussian channel .",
    "this does not look as a very constraining assumption as it is known that alice and bob can always assume their state to be gaussian ( see @xcite ) .",
    "however , this result has only been established in the asymptotic limit , and one can not yet rigorously exclude the ( improbable ) situation where this result does not hold in general .    a non - gaussian attack that would exploit such a possible loophole would have to be quite subtle . indeed , the usual security proof stating that gaussian states are the ones which minimize the secret key rate can not be used here because the proof implicitly assumes the knowledge of the covariance matrix . for a _ given _ covariance matrix , the state maximizing eve s information",
    "is gaussian .",
    "the only possible loophole would be that because the covariance matrix is not perfectly known in a finite - size scenario , there might exist a non - gaussian state , compatible with the estimated covariance matrix computed with a gaussian assumption , that would be better for eve than the gaussian state estimated by alice and bob .",
    "let us detail things a little .",
    "let us note @xmath76 the set of states compatible with the results of the parameter estimation , under a gaussian model , except with probability @xmath14 .",
    "let us note @xmath77 the set of states compatible with the results of the parameter estimation , under a general , non - gaussian model , except with probability @xmath14 .",
    "it is not easy to compare the two sets _ a priori _ , but one can imagine that they likely get closer and closer as @xmath14 goes to 0 ( we typically consider @xmath78 ) . in the following , because we make the gaussian assumption , we consider the gaussian state @xmath79 which maximizes eve s information ( note that @xmath76 is not composed of gaussian states only , but we know that the worst case from alice and bob s point of view is gaussian )",
    ". however , it is not yet possible to exclude the existence of a non - gaussian state @xmath80 such that the secret key rate obtained for @xmath81 is strictly lower that the one obtained for @xmath82 .",
    "this is however quite unlikely .",
    "for this reason , we conjecture that the gaussian optimality still holds in a non - asymptotic scenario , and in the following , we make the assumption of a gaussian channel .",
    "again we insist on the point that even if this conjecture were proven wrong , the bounds computed here would still be quite accurate .",
    "note , however , that this conjecture was recently established in the case of protocols with a gaussian modulation @xcite .",
    "our goal , here , is to compute @xmath72 , the maximal value of the holevo information between eve and bob s classical variable compatible with the statistics except with probability @xmath14 .",
    "the nice property of cv protocols without postselection is that @xmath83 can be bounded from above by a function of two parameters only .",
    "more precisely , this function depends on the covariance matrix @xmath84 of the state @xmath85 shared by alice and bob in the entanglement - based version of the protocol ( see @xcite for protocols with a gaussian modulation and @xcite for protocols with a discrete modulation ) .",
    "one can always assume that @xmath84 take the following form : @xmath86 where @xmath42 is the variance of alice s modulation in the _ prepare and measure _ scheme and @xmath21 and @xmath22 refer to the experimentally estimated effective transmission and excess noise of the channel @xcite .",
    "the parameter @xmath87 is a function of @xmath42 which depends on the modulation scheme .",
    "for instance , one has : @xmath88 in the case of a gaussian modulation . for a discrete modulation",
    ", @xmath87 has a more complicated expression but turns out to be almost equal to @xmath89 for small variances ( see @xcite ) : for the two - state protocol , one has @xmath90 and for the four - state protocol , one has @xmath91 where @xmath92 finally , for the continuous eight - dimensional modulation @xcite , one has : @xmath93 these various parameters are related through : @xmath94 in order to compute @xmath72 , one simply needs to evaluate @xmath95 , the covariance matrix compatible with the data except with probability @xmath14 which maximizes the holevo information between eve and bob s classical data .",
    "the estimation of @xmath95 is made through the sampling of @xmath96 couples of correlated variables @xmath97 . as we said before , we consider here a normal model for these variables .",
    "within this model , alice and bob s data are linked through the following relation : and consequently the quantum channel are symmetrized . ]",
    "@xmath98 which is a normal linear model parametrized by @xmath99 and where @xmath100 follows a centered normal distribution with unknown variance @xmath101 .",
    "the random variable @xmath0 can be either a normal random variable with variance @xmath42 in the case of the cv qkd protocol with a gaussian modulation , or an unbiased bernoulli random variable taking values @xmath102 in the case of the two- and four - state protocols ( and a similar situation occurs for the continuous eight - dimensional modulation ) . at this point",
    ", it is worth considering the dependence of @xmath83 in the variables @xmath103 and @xmath104 .",
    "one can in particular check numerically that the following inequalities hold for any value of the modulation variance @xmath42 and for all modulation schemes considered here : @xmath105 this means that one can find the covariance matrix @xmath95 which minimizes the secret key rate with a probability at least @xmath18 : @xmath106 where @xmath107 and @xmath108 correspond respectively to the minimal value of @xmath103 and the maximal value of @xmath104 compatible with the sampled data , except with probability @xmath109 .",
    "note that this means that the confidence region we consider here is simply a two - dimensional rectangle .",
    "one could obviously study more complicated regions that might slightly improve the final key rate .",
    "however , here , we prefer to restrict ourselves to this simpler solution which has the advantage of displaying the same features as a more complicated model , but without drowning them under too technical mathematical details .",
    "maximum - likelihood estimators @xmath110 and @xmath111 are known for the normal linear model @xcite : @xmath112 moreover , @xmath110 and @xmath111 are independent estimators with the following distributions : @xmath113 where @xmath103 and @xmath104 are the true values of the parameters .",
    "this allows us to compute @xmath107 , a lower bound for @xmath103 , and @xmath108 , an upper bound for @xmath104 in the limit of large @xmath16 : , the @xmath114 distribution converges to a normal distribution .",
    "the approximation is almost exact in our case as we consider values of @xmath16 ( much ) larger than @xmath115 . ]",
    "@xmath116 where @xmath117 is such that @xmath118 and @xmath119 is the _ error function _ defined as @xmath120    in a given experiment , one can simply compute the values of both estimators @xmath110 and @xmath111 and plug them in the eq .",
    "[ extremal_values ] in order to get the values of @xmath107 and @xmath108 and finally the value of @xmath72 . in order to keep analyzing the protocol from a theoretical point of view",
    ", we take for @xmath110 and @xmath111 their expected values : @xmath121 & = & \\sqrt{t } , \\\\ \\mathbb{e}[\\hat{\\sigma}^2 ] & = & 1 + t \\xi . \\end{array}\\ ] ] using these values , one can compute @xmath107 and @xmath108 : @xmath122    finally , one gets the covariance matrix @xmath95 which should be used to compute the expected secret key rate @xmath72 in the finite case : @xmath123 = \\gamma +    \\begin{pmatrix }      0 & \\delta_z \\sigma_z\\\\    \\delta_z \\sigma_z & \\delta_b \\mathbbm{1}_2\\\\    \\end{pmatrix},\\ ] ] with @xmath124    at the first order , for long distances , the main effect is clearly the uncertainty on the excess noise .",
    "the _ effective _ excess noise @xmath125 due to the imprecision of the estimation is given by : @xmath126 we will display in the next section the effect of the parameter estimation on the secret key rate , but we can already give a hint about the block length that will generally be required for a given distance .",
    "indeed , from eq .",
    "[ effective - xi ] , one immediately obtains : @xmath127 for @xmath78 , one has @xmath128 , and if one requires @xmath129 , which is a typical value for the true excess noise @xcite , then the number of samples required scales as a function of the transmission as @xmath130 for instance , if the distance between alice and bob is 50 km , then @xmath131 which means that one expects the block length to be on the order of @xmath132 , which is barely realistic .",
    "if the distance is 100 km , then the block length should be on the order of @xmath133 , which is much more complicated .",
    "we will see in section [ finite_results ] that the reality is even worse than that .    before proceeding with the numerical results , we now discuss two technical points linked to the problem of parameter estimation .",
    "first , we come back on the assumption made previously that in a typical experiment , the value of the estimators will roughly correspond to the true value of the parameter .",
    "then , we hint on alternative approaches to improve the estimation of the parameters for cv qkd protocols , which might be more economical in terms of the number of samples required , but whose mathematical analysis is much more involved .      for a given experiment , the secret key rate can be computed and is a function of the observed values of the estimators @xmath110 and @xmath111 ( but not only ) .",
    "one can write @xmath134 .",
    "> from a theoretical point of view , that is , without performing the actual experiment , there are two different secret key rates that can be computed .    the first possibility , considered for instance in @xcite , is to compute the secret key rate @xmath135 obtained for the expected values of the parameters : @xmath136 , \\mathbb{e}[\\hat{\\sigma}^2]).\\ ] ] in some sense , this corresponds to what one could call the most probable secret key rate .",
    "this interpretation , however , is not correct .    the correct theoretical secret key rate @xmath137 is given by the expected value of the secret key rate , that is @xmath138.\\ ] ] obviously , this value is much more difficult to evaluate in general as one needs to know the probability distributions of both estimators @xmath110 and @xmath111 , whereas in the case of @xmath135 , one just needs to know the expected values .",
    "fortunately , we will see in section [ finite_results ] that in fact both values are remarkably close , meaning that one can always safely use @xmath135 as the secret key size .",
    "an interesting characteristics of continuous - variable qkd protocols is that it might be possible to perform the parameter estimation without sacrificing any data .",
    "this is obviously something impossible in discrete - variable qkd where estimating the quantum bit error rate ( qber ) requires for alice and bob to disclose part of their data .    in continuous - variable qkd however , the bit used for the raw key is encoded in only a part of bob s classical data .",
    "let us take the example of the four - state protocol for instance @xcite .",
    "in this case , bob s data @xmath139 are real numbers and the raw key elements are simply given by the sign of the variables @xmath140 .",
    "the absolute value is sent to alice through the public , authenticated channel , and alice uses it to perform the reverse reconciliation procedure .    in the parameter estimation procedure that we described above",
    ", alice and bob would agree on a certain subset of their data and completely disclose their data in this subset .",
    "this means that the absolute values of the rest of bob s data are not used for this parameter estimation , whereas it manifestly contains information concerning the covariance matrix of the state shared by alice and bob .",
    "one could certainly use this information to improve the accuracy of the parameter estimation , or equivalently , obtain the same accuracy while using less samples , therefore increasing the final secret key rate .",
    "however , the statistics techniques necessary for this study are beyond the scope of this paper , and we do not address this question more extensively here .    before concluding this section , we give another possible way to improve upon the parameter procedure presented here . for continuous - variable qkd protocols ,",
    "it is clear that the critical parameter to estimate is the excess noise .",
    "the transmission on the other hand is less critical for two reasons : first , it can be estimated more precisely than the excess noise with the same amount of data ( in particular , the relative uncertainty for the transmission is smaller than the one for the excess noise ) , and second , the secret key rate is much more sensitive to variations in the excess noise than in the transmission . therefore , one could use the following method in order to estimate the transmission and the parameters :    * the transmission is estimated through the same procedure as before , with @xmath16 samples , * bob uses the _",
    "totality _ of his data to compute an estimation of the variance of his data . then using the relation @xmath141 and his estimation of @xmath21 , bob infers an estimation for the excess noise .    this approach seems better than the one studied above .",
    "however , it involves computing two _ dependent _ estimators and the probability distributions of the estimators ( necessary to compute confidence regions ) are not known .",
    "therefore , in this paper , we use a likely suboptimal procedure to perform the parameter estimation , but this procedure allows for the computation of explicit bounds .",
    "the question of what is the best parameter estimation procedure in the case of continuous - variable qkd is still open , and is certainly worth investigating further , as it turns out that the parameter estimation is an important problem if one wants to distribute secret keys over long distance , while using realistic block lengths .",
    "before we discuss the results in terms of secret key rate , we start by considering the specific influence of @xmath34 , related to privacy amplification and defined in eq .  .",
    "we then study the influence of the parameter estimation .      on figure [ delta_finite ]",
    ", we plot the value of the parameter @xmath34 as a function of @xmath7 , the size of the raw key . here , we take @xmath61 since for all continuous - variable protocols we consider , the raw key is encoded on bits @xcite . among notable features",
    ", one sees that the value of @xmath34 does not critically depend on the parameters @xmath37 and @xmath38 which need to be optimized in theory .",
    "one can easily see from the curve , that for the plotted domain ( @xmath142 ) , @xmath34 is essentially determined by the first term of eq .",
    ", @xmath143     ( color online . ) parameter @xmath34 as a function of @xmath7 for various values of @xmath37 and @xmath38 . from top to bottom , @xmath144 . ]",
    "the important lesson is the large value of @xmath34 , even for ( seemingly ) quite large sizes of the raw key .",
    "in particular , one observes that @xmath34 is larger than 0.01 for raw key sizes smaller than @xmath145 . in practice , this means that if the asymptotic secret key rate is below 0.01 bit per channel use , then if one wants to take into account finite - size effects , one has to use block lengths larger than 10 million in order to be able to claim to have truly distributed a secret key among distance parties .      here , we focus on the value of the _ effective _ excess noise @xmath125 due to the finite precision of the parameter estimation . on figure [ ksi_finite ]",
    ", we display this effective excess noise as a function of @xmath16 , the number of samples used in the parameter estimation .",
    "( color online . )",
    "parameter @xmath125 as a function of @xmath16 for @xmath146 ( in fact , @xmath125 does not depend too critically on the precise value of @xmath14 , and one obtains almost similar plots for @xmath147 for instance ) . from bottom to top",
    ", we consider channel losses of 5 db , 10 db , 15 db and 20 db . with a perfect homodyne detection ( quantum efficiency equal to 1 ) , this is equivalent to distances of 25 , 50 , 75 and 100 km , respectively . ]    from figure [ ksi_finite ] , it is clear that the parameter estimation has a major impact on the final secret key rate .",
    "indeed , the four - state protocol for instance , which can achieve remarkably long distances in the asymptotic limit , requires very low values of the excess noise , typically less than one percent in order to distribute key over distances close to 100 km .",
    "here , we see that such parameters require to sample 10 billion couples of correlated data ! for this reason , it is doubtful that continuous - variable qkd is very practical over distances much larger than 100 km , at least with the security proofs presently available .",
    "note that a similar situation is also true for discrete - variable protocols .      here , we first consider the secret key rate @xmath135 which is the one obtained if the estimators @xmath148 and @xmath149 are equal to their expected values .",
    "we do not proceed to a complete optimization of the various parameters since it will not fundamentally change the results and instead take the following values : @xmath150 the choice for @xmath39 is a very conservative choice , but it turns out that the secret key rate does not depend very critically on @xmath39 ( a similar observation was made in @xcite ) .",
    "the choice to use half of the data for the parameter estimation procedure results from the fact that the block size is almost entirely decided by the number of data actually sampled .",
    "the reconciliation efficiency of @xmath151 is a conservative value @xcite . finally , we consider the quantum efficiency of the homodyne detection to be @xmath152 which corresponds to a typical experimental parameter @xcite .",
    "moreover , we consider the paranoid mode where the electronic noise is null .",
    "remember that two different models can be considered when discussing the security of cv qkd : either the electronic noise of bob s detection is considered as regular excess noise ( paranoid mode ) , or it is attributed to bob s detection ( realistic mode ) .",
    "the second case is more natural , but it implies that bob s detection stage should be calibrated . as a first approximation ,",
    "the paranoid mode without electronic noise is equivalent ( in the asymptotic regime ) to the case of a realistic mode where the electronic noise is non negligible but is not supposed to be caused by the action of an eavesdropper . in the finite - size regime , one can still make the assumption that bob s detection is very well calibrated and that there is virtually no uncertainty on the value of the electronic noise . as a consequence , in order to avoid too many technical details , we present here results obtained in the paranoid scenario without electronic noise .",
    "note that this solution was also chosen in the review by scarani _",
    "et al _ @xcite .",
    "( color online . )",
    "secret key rate for the four - state protocol . from left to right , the curves correspond respectively to block lengths of @xmath153 and @xmath154 .",
    "full lines , dashed lines and dotted lines correspond respectively to an expected value of the excess noise of 0.001 ( optimistic ) , 0.005 ( realistic ) , 0.01 ( conservative ) .",
    "the secret key rate is null for a block length of @xmath115 . ]",
    "the secret key rates displayed on figure [ k4finite ] correspond to the key rate one can expect if the estimators give the true value of the parameters . as we argued above",
    ", a more relevant secret key rate corresponds to the _ expected _ value computed for the probability distributions of the estimators @xmath110 and @xmath111 .",
    "as we already explained , the most important parameter for the final secret key rate is the excess noise .",
    "this means that one should mainly consider the probability distribution of the estimator @xmath111 . according to equation [ estimator_pdf ] ,",
    "one has : @xmath155 for large @xmath16 , the @xmath156 distribution tends to a normal distribution , which translates into @xmath157 where , as before , @xmath104 corresponds to the true value of the parameter . here",
    ", we can therefore compute an approximate value of the expected secret key rate @xmath137 as @xmath158 \\approx \\mathbb{e}[f(t , \\hat{\\sigma}^2)]\\ ] ] since @xmath110 has a probability distribution peaked around the true value of the parameter @xmath103 and because @xmath159 does not depend critically on the value of @xmath103 . using the normality of the random variable @xmath111 , one obtains @xmath160 it turns out that the behavior of @xmath137 is numerically indistinguishable from the value of @xmath135 .",
    "for this reason , we do not display it here .",
    "the main consequence is that one can in very good approximation compute the final key rate by considering the expected values of the parameters being estimated .",
    "this is rather fortunate as computing @xmath137 is much more demanding from a computing point of view than computing @xmath135 .    finally , on fig .",
    "[ k4finite0005bis ] , we display the results for the recently proposed eight - dimension protocol described in detail in ref .",
    "@xcite , which outperforms the four - state protocol in realistic cases , and may also be easier to implement .",
    "( color online . )",
    "secret key rate for the four - state ( thin curves ) and eight - dimension ( thick curves ) protocols obtained for an expected realistic value of the excess noise of 0.005 , and for @xmath78 . from left to right , the block length @xmath2 is equal to @xmath161 and @xmath154 .",
    "the secret key rate is null for a block length of @xmath115 .",
    "the eight - dimension protocol is better for all curves . ]",
    "this article laid down the basis of finite - size analysis of continuous - variable qkd protocols , but several problems remain open , and should be addressed in further studies .",
    "first , a basic tool used in the asymptotic regime is the gaussian optimality theorem @xcite , which remain valid for collective attacks , even in the case of the protocols which do not use a gaussian modulation , that is , the protocols designed to perform well over long distance @xcite . whereas using this theorem is completely legitimate in the asymptotic regime @xcite , it is not so clear in a finite - size scenario , where very subtle ( and highly improbable ) attacks might perform slightly better .",
    "such attacks would have to be based on the idea of fooling alice and bob by having them make wrong assumptions in the parameter estimation procedure .",
    "this subtle point ( given that the blocks have anyway to be very large ) deserves further analysis .",
    "second , and perhaps more importantly , one should prove whether or not collective attacks are optimal in the finite - size setting . if this is the case , then all is for the best , and the bounds derived here are accurate .",
    "but if collective attacks are not optimal , then one needs to come up with bounds as tight as possible for coherent attacks . on this subject , it would seem that adapting the postselection technique from @xcite to continuous variables ( using for instance symmetries in phase space as explained in @xcite ) would lead to much tighter bounds that the one currently available through an exponential version of de finetti theorem for infinite dimensional hilbert spaces @xcite .",
    "despite the fact that there are still open problems concerning the finite size analysis of continuous - variable quantum key distribution , some lessons can already be learned .",
    "first , it should be emphasized again that the problem of the reconciliation efficiency at low snr is essentially solved by new protocols using discrete modulation and high - efficiency reconciliation codes , such as the four - state @xcite or eight - dimension @xcite protocols .",
    "then , as is the case for discrete - variable qkd protocols , the most important remaining finite - size effect is the limited accuracy of the parameter estimation . for cvqkd ,",
    "the main issue is the value of the channel excess noise , which has already a critical effect for values as small as 1% of shot noise . nevertheless",
    ", operating windows do exist , provided that both the  real \" excess noise is very small , and the block size is very large . under such circumstances , secure key distribution over distances larger than 50 km seem quite feasible , especially with the eight - dimension protocol @xcite , as it has been shown on fig .",
    "[ k4finite0005bis ] .",
    "the authors acknowledge the hospitality of cqt singapore during the workshop `` quantum cryptography with finite resources '' ( 4 - 6 december 2008 ) .",
    "this work received financial support from agence nationale de la recherche under projects prospiq ( anr-06-nano-041 - 05 ) and sequre ( anr-07-sesu-011 - 01 ) and from the eu erc starting grant percent ."
  ],
  "abstract_text": [
    "<S> the goal of this paper is to extend the framework of finite size analysis recently developed for quantum key distribution to continuous - variable protocols . </S>",
    "<S> we do not solve this problem completely here , and we mainly consider the finite size effects on the parameter estimation procedure . despite the fact that some questions are left open , we are able to give an estimation of the secret key rate for protocols which do not contain a postselection procedure </S>",
    "<S> . as expected , these results are significantly more pessimistic than the ones obtained in the asymptotic regime . </S>",
    "<S> however , we show that recent continuous - variable protocols are able to provide fully secure secret keys in the finite size scenario , over distances larger than 50 km .    </S>",
    "<S> quantum key distribution ( qkd ) is a cryptographic primitive that allows two distant parties , alice and bob , to generate secret keys despite the presence of a potential eavesdropper @xcite . </S>",
    "<S> when , in 1984 , bennett and brassard invented the first qkd protocol @xcite , they could only prove that their protocol had to be secure in some appropriate regime ( for instance in the unrealistic case where alice and bob s data are perfectly correlated ) but were not in measure to establish any security proof for a realistic setup at that time . during the last 25 years , security proofs </S>",
    "<S> have steadily improved and today , _ unconditional security _ </S>",
    "<S> , that is , security guaranteed in an information - theoretical sense has been established for many qkd protocols @xcite , including continuous - variable protocols @xcite . </S>",
    "<S> a caveat , however , is that any theoretical security proof relies on assumptions , which can be more or less explicit . </S>",
    "<S> one such assumption can be for instance that the physical implementation of the protocol behaves as specified , and that no side - channels can be exploited by the adversary . </S>",
    "<S> this , unfortunately , is in general impossible to prove @xcite unless one considers _ </S>",
    "<S> device - independent _ quantum cryptography @xcite , which is certainly a fascinating theoretical possibility , but highly unpractical . </S>",
    "<S> another assumption which is often made is that one considers the security of a protocol in the asymptotic regime of infinitely many signals exchanged by alice and bob . here , on the positive side , </S>",
    "<S> the general framework to address the problem of finite - size effects already exists . the specific formalism was developed in renner s phd thesis @xcite and subsequently detailed in @xcite and applied in @xcite . </S>",
    "<S> note also that another analysis compatible with composable security was developed by hayashi in the case of bb84 with decoy states @xcite and later applied to experimental data @xcite . </S>",
    "<S> on the negative side , the results of these various papers are quite pessimistic and it is not totally unreasonable to think that the security of all qkd implementations realized until now was in fact jeopardized due to the ( way ) too short length of the blocks exchanged by alice and bob !    so far , the finite - size analysis has been restricted to discrete - variable protocols , that is , protocols described with a finite dimensional hilbert space ( see ref . </S>",
    "<S> @xcite for an application to qkd using qudit systems ) .    </S>",
    "<S> on the other hand , continuous - variable protocols where information is encoded in phase space , appear to be a credible alternative to historical protocols like bb84 . </S>",
    "<S> indeed , they are relatively easy to implement , requiring only coherent states generation together with homodyne detection @xcite and now display very good performances in terms of achievable distance @xcite .    </S>",
    "<S> the basic idea of continuous - variable qkd is to encode information in phase space . </S>",
    "<S> to do so , alice sends random coherent states to bob , who decides randomly to measure either one of the quadratures with a homodyne detection . </S>",
    "<S> ( note that a variant consists for bob to perform an heterodyne detection , that is to measure both quadratures simultaneously @xcite . ) after this measurement , alice and bob share classical variables @xmath0 ( the value of the quadrature of the state sent by alice ) and @xmath1 ( bob s measurement result ) from which they can in principle distill a key , once they have exchanged sufficiently many signals . </S>",
    "<S> a few protocols of interest have been proved unconditionally secure @xcite , depending on alice s modulation which can be either continuous ( gaussian @xcite or eight - dimensional @xcite in order to allow for a very efficient reconciliation procedure ) or discrete ( binary @xcite or quaternary @xcite ) . </S>",
    "<S> note that for all such protocols , no postselection of the classical data @xcite should be performed , as such a postselection is not compatible with present security proofs .    </S>",
    "<S> the goal of the present paper is to give a first finite - size analysis for continuous - variable qkd protocols . in section [ framework ] </S>",
    "<S> , we rapidly review the framework of @xcite . in section [ outline ] , </S>",
    "<S> we describe the outline of a general continuous - variable qkd protocol . </S>",
    "<S> then , we discuss in section [ finite_issues ] the main specificities of continuous - variable protocols in the context of finite - size analysis . </S>",
    "<S> we proceed in section [ parameter_estimation ] with a detailed study of the most important finite - size effect : parameter estimation . </S>",
    "<S> finally , we present the results of this study in section [ finite_results ] and give some perspectives . </S>"
  ]
}