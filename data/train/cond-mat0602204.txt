{
  "article_text": [
    "numerical electronic structure calculations are now well established branch of solid state physics .",
    "while for the finite systems , such as atoms and molecules , more sophisticated and rigorous calculation methods exist , for extended systems studied in condensed matter physics the only widely used practical tool is up to now density functional theory ( dft ) in the local density approximation ( lda ) .",
    "@xcite it has so great predictive power , that not only charge and spin density , one - electron and total energies obtained in lda are in general in a very good agreement with experimental data , but it was possible to develop _ ab initio _ molecular dynamic methods , based on lda .",
    "such methods achieved the level of numerical experiment , because even so complicated effects , such as reconstruction of the crystal surface can be correctly described by them .  @xcite    however , there are materials where lda results do not agree well with experimental data . for band insulators and semiconductors lda",
    "gives systematically underestimated values of the energy gap .",
    "@xcite for mott insulators , for example transition - metal oxides , lda results could be qualitatively wrong , giving metallic state while experimentally those systems are wide gap insulators .",
    "@xcite    there were many attempts to cure this deficiency of lda . among",
    "the most widely used one can mention gw ,  @xcite sic ,  @xcite and lda+@xmath6@xcite methods . while those approaches have their advantages",
    "there is still no universally accepted calculation scheme which would be as simple and practical as standard lda and a search for better methods continues in scientific community .",
    "the basic problems of lda can be traced to the fact that the exchange - correlation energy functional is defined in a _",
    "local _ approximation . as a result its variational derivative ,",
    "exchange - correlation potential ( that is a _ function _ of the density value in particular point * r * instead of being a general _ functional _ of density ) , is continuous as a number of electrons function .",
    "more general approximations using in addition to the electron density its gradient like gga @xcite method have continuous potential as well . however , perdew _ et al . _",
    "@xcite had investigated the properties of the _ exact _ density functional ( edf ) and shown that its potential must jump discontinuously when number of electrons @xmath7 goes through an integer value .",
    "the proper function of total energy @xmath8 versus number of electrons @xmath7 should have a curve as series of straight - line segments with derivative discontinuities at integral values of @xmath7 while in lda this curve has continuous derivatives .",
    "any attempts to improve lda as an approximation to exact density functional theory should be done in such a way that a new functional would obey this discontinuity requirement .    in the present work",
    "we define a functional that by construction has the potential discontinuities required for exact density functional . for that we introduce a concept of _ orbital densities _ corresponding to one - electron orbitals .",
    "the orbital densities functional ( odf ) depends on a set of _ orbital densities _ instead of the total electron density only .",
    "when the number of electrons goes through an integer value the variational derivative of the odf functional jumps discontinuously and the corresponding function of total energy @xmath9 versus number of electrons @xmath7 has a curve as series of straight - line segments .",
    "varying this functional one - electron equations were obtained with potential in the form of projection operator . for occupied states",
    "the effect of this operator on the energy is negative and positive for empty states . as a the result it increases separation between valence and conduction bands comparing with lda values thus curing lda deficiency of energy gap value systematic underestimation .",
    "the minimization of odf functional gives a set of orbital densities and hence the total electron density corresponding to ground state of the system .",
    "the same functional can be used to calculate energies of orbital densities fluctuations around the ground state values .",
    "from this we have derived _ fluctuation hamiltonian _ defined via orbital density fluctuation operators .",
    "this hamiltonian allows to treat correlation effects and hence obtain better description of ground state properties and spectral function for the excitations . in the present work we have used for odf hamiltonian dynamical mean - filed theory ( dmft )  @xcite with quantum monte carlo ( qmc ) method to solve the effective impurity problem .",
    "the optimal choice for one - electron orbitals needed to define orbital densities can be determined by condition of fluctuation energy minimum .",
    "we have shown that the less extended in space these orbitals are , the lower the energy of orbital densities fluctuations around ground state is .",
    "therefore in our odf method we have used maximally localized wannier functions for orbital densities definition .",
    "@xcite    recently we have developed `` generalized transition state '' ( gts ) method @xcite to improve agreement of calculated and experimental spectral properties comparing with lda .",
    "we have found that odf projection operator is identical to the one in equations of gts method .",
    "the basis of gts method was an idea that one - electron energies corresponding to wannier functions should have a meaning of the removal ( addition ) energies for electrons from ( to ) the corresponding states .",
    "that was realized by using `` transition state '' scheme@xcite generalized to wannier functions .",
    "it is remarkable that so different approaches as `` transition state '' correction to excitation energies and requirement of exchange - correlation potential discontinuity can lead to the same equations .",
    "we have applied odf method to the problem of metal - insulator transition in lah@xmath0 .",
    "lda has severe difficulties for this material because it gives metallic solution for all values of hydrogen deficiency @xmath1 while experimentally the system is insulating for @xmath2 .",
    "we have found that odf projection operator potential is enough to open a gap for stoichiometric lah@xmath3 but in order to reproduce paramagnetic insulator for lah@xmath4 correlation effects should be taken into account via dmft - qmc solution of odf fluctuation hamiltonian .",
    "the paper is structured as follows . in sec .",
    "[ odf ] the derivations of odf functional and fluctuation hamiltonian are presented . in sec .",
    "[ w_def ] and  [ wf_gf ] we describe the construction of wannier functions .",
    "[ wf_dmft ] gives a short account of dmft method and sec .",
    "[ self - cons ] describes the self - consistency issues . in sec .",
    "[ lah3 ] results of odf calculations for lah@xmath0 are presented .",
    "[ conclusion ] concludes the paper .",
    "in the local density approximation ( lda)@xcite to the density functional theory @xcite(see appendix  [ constrain ] ) exchange - correlation energy is calculated via : @xmath10=\\int d\\mathbf{r } \\varepsilon_{xc}(\\rho(\\mathbf{r}))\\rho(\\mathbf{r}),\\end{aligned}\\ ] ] where @xmath11 is exchange - correlation energy density for homogeneous electron gas with density equal to @xmath12 .",
    "equation ( [ odf2 ] ) defines an exchange - correlation potential @xmath13)/\\delta\\rho(\\mathbf{r})$ ] which is a continuous function of the number of electrons @xmath7",
    ". however , perdew _ et al . _",
    "@xcite proved that for the _ exact _ density functional exchange - correlation potential must jump discontinuously when number of electrons @xmath7 goes through an integer value .",
    "the hohenberg - kohn theorem@xcite was extended in ref .   to fractional electron number .",
    "it was shown that for the electron density @xmath14 which integrates to @xmath15 where m is an integer and @xmath16 the exact density functional @xmath17 is equal to : @xmath18 this means that in general the curve of @xmath17 versus @xmath7 is a series of straight - line segments with derivative discontinuities at integer values of @xmath7 .",
    "it was proven@xcite that the chemical potential @xmath19 is discontinues when the number of electrons goes through integer value : @xmath20 where @xmath21 and @xmath22 are removal and addition energies respectively .",
    "the functional derivative @xmath23 is also discontinuous : two limits for @xmath7 approaching @xmath24 from above and below will differ by constant @xmath25 .",
    "electron density [ eq .  ( [ lda43 ] ) ] can be expressed as a sum of the `` orbital densities '' @xmath26 defined in the following way ( @xmath27 is @xmath28-th orbital wave function ) : @xmath29 the orbital densities can be varied from zero to the maximum values @xmath30 .",
    "the condition of linear dependence of the _ exact _ density functional on the fractional number of electrons [ eq .  ( [ lda23 ] ) ] can be expressed via orbital density @xmath31 corresponding to the partially occupied orbital @xmath32 .",
    "this orbital is the lowest unoccupied one for number of electrons @xmath33 and the highest occupied for @xmath34 .",
    "the variation of the total electron density @xmath14 will be defined only by the variation of @xmath31 for number of electrons changing from @xmath24 to @xmath35 @xmath36=e_{edf}[\\rho_0+\\rho_j]=e_{edf}\\big|_{\\rho_j(\\mathbf{r})=0}+ \\int d\\mathbf{r } \\rho_j(\\mathbf{r})\\lambda_j(\\mathbf{r}),\\end{aligned}\\ ] ] where @xmath37 is the density for number of electrons @xmath33 . here",
    "@xmath38 satisfies to the equation : @xmath39    orbital density @xmath31 enters eq .",
    "( [ odf3 ] ) in a linear form .",
    "however lda functional [ eqs .",
    "( [ lda44 ] ) and ( [ odf2 ] ) ] does not show such a linear dependence on density variations .",
    "equation analogous to eq .",
    "( [ odf3 ] ) for lda has a general form ( keeping only first and second variational derivatives in expansion series ) : @xmath40=e_{lda}[\\rho_0+\\rho_j ]   \\approx e_{lda}\\big|_{\\rho_j(\\mathbf{r})=0}+ \\int d\\mathbf{r } \\rho_j(\\mathbf{r}){\\frac{\\delta e_{lda}}{\\delta\\rho(\\mathbf{r})}}\\big|_{\\rho_j(\\mathbf{r})=0 } \\\\",
    "\\nonumber   + \\frac{1}{2}\\int d\\mathbf{r } \\rho_j(\\mathbf{r})\\int d\\mathbf{r'}\\rho_j(\\mathbf{r'})\\frac{\\delta^2 e_{lda}}{\\delta\\rho(\\mathbf{r})\\delta\\rho(\\mathbf{r'})}\\big|_{\\rho_j(\\mathbf{r})=0}.\\end{aligned}\\ ] ]    using eqs .",
    "( [ lda60 ] ) and ( [ lda61 ] ) this expansion can be rewritten via constrain potential @xmath41 and effective interaction strength function @xmath42 : @xmath43=e_{lda}[\\rho_0+\\rho_j ]   \\approx e_{lda}\\big|_{\\rho_j(\\mathbf{r})=0}+ \\int d\\mathbf{r } \\rho_j(\\mathbf{r})\\phi(\\mathbf{r})\\big|_{\\rho_j(\\mathbf{r})=0 } \\\\",
    "\\nonumber   + \\frac{1}{2}\\int d\\mathbf{r } \\rho_j(\\mathbf{r})\\int d\\mathbf{r'}\\rho_j(\\mathbf{r'})w(\\mathbf{r},\\mathbf{r'})\\big|_{\\rho_j(\\mathbf{r})=0}.\\end{aligned}\\ ] ]    if one will add to eq .",
    "( [ odf5 ] ) a correction term : @xmath44   \\equiv -\\frac{1}{2}\\int d\\mathbf{r } \\rho_j(\\mathbf{r})\\int d\\mathbf{r'}(\\rho_j(\\mathbf{r'})-\\rho^{max}_j(\\mathbf{r'}))w(\\mathbf{r},\\mathbf{r'})\\big|_{\\rho_j(\\mathbf{r})=0}\\end{aligned}\\ ] ] then the linear dependence on the density variations ( as it is required for the _ exact _ density functional [ eq .  ( [ odf3 ] ) ] ) will be restored : @xmath45 + e_{corr}[\\rho_j ] \\approx e_{lda}\\big|_{\\rho_j(\\mathbf{r})=0 } \\\\+ \\nonumber \\int d\\mathbf{r } \\rho_j(\\mathbf{r})\\big(\\phi(\\mathbf{r})\\big|_{\\rho_j(\\mathbf{r})=0}+ \\frac{1}{2}\\int d\\mathbf{r'}\\rho^{max}_j(\\mathbf{r'})w(\\mathbf{r},\\mathbf{r'})\\big|_{\\rho_j(\\mathbf{r})=0}\\big).\\end{aligned}\\ ] ] equation ( [ odf7 ] ) is equivalent to eq .",
    "( [ odf3 ] ) with the function @xmath38 equal to : @xmath46    we define the `` orbital densities functional '' @xmath9 as : @xmath47\\equiv e_{lda}[\\rho ] -\\frac{1}{2}\\sum_i \\int d\\mathbf{r } \\rho_i(\\mathbf{r})\\int d\\mathbf{r'}(\\rho_i(\\mathbf{r'})-\\rho^{max}_i(\\mathbf{r'}))w(\\mathbf{r},\\mathbf{r'})\\big|_{\\rho_i(\\mathbf{r})=0}.\\end{aligned}\\ ] ] please note that the odf functional [ eq .  ( [ odf8 ] ) ]",
    "depends not only on the total charge density @xmath14 that is a sum of orbital densities but also explicitly on a set of orbital densities @xmath48 .",
    "let us investigate the dependence of the functional [ eq .  ( [ odf8 ] ) ] on the number of electrons @xmath7 .",
    "at first please note that for the integer values of @xmath7 corresponding to the integer orbital occupancies @xmath49 the value of the functional [ eq .",
    "( [ odf8 ] ) ] coincides with the corresponding value of the lda functional . for integer @xmath49 values orbital density",
    "@xmath26 is equal either zero for empty state ( @xmath50 ) or @xmath51 for occupied state ( @xmath52 ) . in both cases correction term in eq .",
    "( [ odf8 ] ) vanishes .",
    "we will show that in accordance with the properties@xcite of the the exact density functional @xmath17 [ eq .  ( [ lda23 ] ) ]",
    "this dependence corresponds to the curve of @xmath9 versus @xmath7 as a series of straight - line segments with derivative discontinuities at integer values of @xmath7 .",
    "the increase of the total number of electrons @xmath7 occurs via consequential increase of the orbital occupancies @xmath49 so that when @xmath7 changes from @xmath24 to @xmath35 the value of the @xmath49 corresponding to the highest occupied orbital for the system with @xmath35 electrons changes from 0 to 1 .",
    "the corresponding variation @xmath53 of the total charge density @xmath14 will consist exclusively of the variation of corresponding orbital density @xmath31 of particular orbital @xmath32 .",
    "then variational derivative of the functional [ eq .  ( [ odf8 ] ) ] is equal to : @xmath54 the first term in the right part of eq .",
    "( [ odf9 ] ) @xmath55 is continuous .",
    "however , the second term depends on the index @xmath32 .",
    "when number of electrons @xmath7 is equal to @xmath56 then @xmath32 corresponds to the highest occupied orbital for the system with @xmath24 electrons .",
    "however , for @xmath15 the index will change to @xmath57 corresponding to the lowest unoccupied orbital for the system with @xmath24 electrons or the highest occupied orbital for the system with @xmath35 electrons . the value of @xmath58 in the integral in the right part of eq .",
    "( [ odf9 ] ) will jump from @xmath59 to zero with @xmath7 going @xmath56 to @xmath60 for infinitesimally small @xmath61 .",
    "that results in the corresponding jump of variational derivative @xmath62 : @xmath63    in order to show that the variational derivative @xmath62 is constant for number of electrons varying from @xmath24 to @xmath35 we need explicit expression for the variational derivative of lda functional @xmath55 .",
    "that could be obtained using expansion of eqs .",
    "( [ odf5 ] ) and ( [ odf5s ] ) : @xmath64 then eq .  ( [ odf9 ] ) takes the form : @xmath65 the right part of eq .",
    "( [ odf12 ] ) does not depend on @xmath66 and hence it is constant for fractional number of electrons @xmath67 . as derivatives of all terms in lda functional are continuous the jump of @xmath68 in eq .",
    "( [ odf10 ] ) can be assigned to the jump in the variational derivative of the effective exchange - correlation energy term in odf functional @xmath69 .",
    "this term can be derived from odf functional [ eq .  ( [ odf8 ] ) ]",
    "similarly to the lda case eq .",
    "( [ lda44 ] ) .",
    "if orbital @xmath70 is fixed then variation of orbital density @xmath26 occurs only via variation of occupancy @xmath49 : @xmath71 then the second variation of lda functional is : @xmath72 the second derivative of lda functional with respect to the occupancy @xmath49 is : @xmath73    the value of the derivative @xmath74 could be obtained in constrained lda calculation either in a direct way or by taking into account that derivative of lda functional over orbital occupancy @xmath75 is equal to one - electron eigenvalue @xmath76 [ see eqs .",
    "( [ lda62])-([lda67 ] ) ] : @xmath77    using eqs .",
    "( [ odf21s])-([odf23 ] ) odf functional [ eq .  ( [ odf8 ] ) ] could be rewritten via occupancies @xmath49 : @xmath78= e_{lda}[\\rho(\\mathbf{r } ) ] -\\frac{1}{2}\\sum_i n_i(n_i-1)\\frac{\\delta \\epsilon_i}{\\delta n_i}.\\end{aligned}\\ ] ]    the derivative of odf functional [ eq .  ( [ odf8 ] ) ] with respect to the total number of electrons @xmath7 can be expressed via occupancies @xmath49 of partially occupied orbital @xmath32 : @xmath79 expanding @xmath80 as a function of @xmath67 and keeping only the first term ( which is equivalent to keeping only first and second variational derivatives in eq .",
    "( [ odf5 ] ) ) one can show that derivative @xmath81 does not depend on @xmath67 : @xmath82 analogue of eq .",
    "( [ odf10 ] ) demonstrates a jump of @xmath81 when number of electrons @xmath7 is going through an integer value @xmath24 : @xmath83    we have shown that with the accuracy of expansion of eq .",
    "( [ odf5 ] ) the variational derivative of the `` orbital densities functional '' @xmath9 [ eq .  ( [ odf8 ] ) ] conforms to the conditions for the _ exact _ density functional found in ref .",
    ": it is a constant for fractional number of electrons and has a discontinuity when number of electrons is going through an integer value .",
    "equations ( [ odf30 ] ) and ( [ odf23s ] ) are directly related to `` transition state '' approach proposed by slater @xcite to calculate excitation energies . in this scheme lda eigenvalue ( kohn - sham equations eigenvalue ) of the corresponding one - electron state should be calculated with its occupancy equal 0.5 ( half way between initial and final states of excitation process ) .",
    "one can identify a derivative of the odf functional [ eq .  ( [ odf30 ] ) ] over occupancy @xmath49 as a corresponding one - electron energy @xmath84 : @xmath85 if lda eigenvalue @xmath86 is a linear function of occupancy @xmath49 ( @xmath87 ) ( which is equivalent to expansion eq .",
    "( [ odf10s ] ) ) then for an empty state ( @xmath50 ) : @xmath88 for occupied states ( @xmath52 ) a sign plus in eq .",
    "( [ const ] ) will be replaced by minus .",
    "one can see that eq .",
    "( [ ts1 ] ) can reproduce both those cases : @xmath89    in ref .",
    "we have introduced an auxiliary functional by variation of which eq .",
    "( [ ts2 ] ) giving `` transition state '' correction to one - electron energies can be obtained .",
    "that functional is identical to the functional [ eq .  ( [ odf30 ] ) ] .",
    "keeping in mind that we have defined functional [ eq .  ( [ odf30 ] ) ] in order to reproduce properties of the exact density functional@xcite one can arrive to conclusion that eigenvalues calculated in `` transition state '' method are a good approximation to the eigenvalues of the _ exact _ functional .    the minimization of the functional eq .",
    "( [ odf8 ] ) will give a set of orbital densities @xmath48 and hence the total charge density @xmath14 corresponding to the ground state of the system .",
    "it is useful to derive equations for _ fluctuations _ of the orbital densities @xmath90 around the average ground state functions @xmath48 .",
    "this `` ground state '' charge density @xmath14 corresponds to the minimum of odf functional [ eq .  ( [ odf8 ] ) ] but not of the lda functional so that one must use in the calculations constrain potential @xmath41 ( see appendix [ constrain ] , eq .",
    "( [ lda61 ] ) ) .",
    "analogous to the expansion eqs .",
    "( [ odf5 ] ) and ( [ odf5s ] ) one can write for the lda part of odf functional : @xmath91 \\approx e_{lda}[\\{\\rho_i\\}]+ \\sum_i\\int d\\mathbf{r } \\delta\\rho_i(\\mathbf{r}){\\phi(\\mathbf{r } ) } \\\\",
    "\\nonumber   + \\frac{1}{2}\\sum_i\\sum_j\\int d\\mathbf{r } \\delta\\rho_i(\\mathbf{r})\\int d\\mathbf{r'}\\delta\\rho_j(\\mathbf{r'})w(\\mathbf{r},\\mathbf{r'}).\\end{aligned}\\ ] ] for the correction term eq .",
    "( [ odf6 ] ) the corresponding expression is : @xmath92 \\approx e_{corr}[\\{\\rho_i\\}]-\\\\ \\nonumber - \\sum_i\\int d\\mathbf{r } \\delta\\rho_i(\\mathbf{r})\\int d\\mathbf{r'}(\\rho_i(\\mathbf{r'})-\\frac{1}{2}\\rho^{max}_i(\\mathbf{r'}))w(\\mathbf{r},\\mathbf{r ' } ) \\\\",
    "\\nonumber   - \\frac{1}{2}\\sum_i\\int d\\mathbf{r } \\delta\\rho_i(\\mathbf{r})\\int d\\mathbf{r'}\\delta\\rho_i(\\mathbf{r'})w(\\mathbf{r},\\mathbf{r'}).\\end{aligned}\\ ] ] both eqs .",
    "( [ odf13 ] ) and ( [ odf14 ] ) become exact if one supposes that @xmath93 does not depend on fluctuations @xmath94 so that all variational derivatives higher than the second order are equal to zero . in the following",
    "we assume that this approximation is valid .",
    "then for the total odf functional one has : @xmath95 = e_{odf}[\\{\\rho_i\\}]+ \\\\ \\nonumber + \\sum_i\\int d\\mathbf{r } \\delta\\rho_i(\\mathbf{r})\\big(\\phi(\\mathbf{r})- \\int d\\mathbf{r'}(\\rho_i(\\mathbf{r'})-\\frac{1}{2}\\rho^{max}_i(\\mathbf{r'}))w(\\mathbf{r},\\mathbf{r ' } ) \\big ) \\\\",
    "\\nonumber   + \\frac{1}{2}\\sum_i\\sum_{j\\neq i}\\int d\\mathbf{r } \\delta\\rho_i(\\mathbf{r})\\int d\\mathbf{r'}\\delta\\rho_j(\\mathbf{r'})w(\\mathbf{r},\\mathbf{r'}).\\end{aligned}\\ ] ]    it is convenient to introduce effective odf potential @xmath96 : @xmath97    using eqs .",
    "( [ odf15 ] ) and ( [ odf16 ] ) one can define a hamiltonian for the density matrix fluctuation operators @xmath98 ( here ground state orbital density can be considered as an average value of density matrix operator @xmath99 ) : @xmath100    the orbital density matrix operators @xmath101 could be expressed via orbital occupancy operators @xmath102 ( if orbitals @xmath70 are fixed and the variation of orbital density @xmath26 occurs only via variation of occupancies @xmath49 ) : @xmath103 the fluctuation hamiltonian eq .",
    "( [ odf17 ] ) can be expressed using eqs .",
    "( [ odf21s])-([odf23 ] ) via occupancy operators @xmath102 and their average values @xmath104 ( @xmath105 ) @xmath106    the orbital densities @xmath26 are defined by orbitals @xmath70 in expression for charge density in eq .",
    "( [ odf1 ] ) . in the density functional theory",
    "it is usually assumed that those orbitals are solutions of kohn - sham equations [ eqs .",
    "( [ lda46 ] ) and ( [ lda54 ] ) ] and so minimize functional eq .",
    "( [ lda44 ] ) . however , any unitary transformation ( defined by unitary matrix @xmath6 ) of the set of the functions @xmath70 produces a new set of orbitals : @xmath107 corresponding to the same charge density @xmath14 .",
    "this new set of orbitals can be used to define odf functional in eq .",
    "( [ odf8 ] ) an so this functional is orbital - dependent .    in order to remove uncertainty in choosing the orbital set one needs to impose an additional condition .",
    "we propose the following way to do it .",
    "the hamiltonian eq .",
    "( [ odf17 ] ) can be used to calculate the contribution to the energy from fluctuations : @xmath108 ( the average value of fluctuations @xmath109 is equal to zero so the first term in eq .",
    "( [ odf17 ] ) does not give contribution to the fluctuation energy . ) taking into account eqs .",
    "( [ odf13 ] ) and ( [ odf14 ] ) one can separate contributions to eq .",
    "( [ odf18 ] ) from lda functional where summation over @xmath28 and @xmath32 is performed including terms with @xmath110 and a correction term eq .",
    "( [ odf14 ] ) .",
    "the lda part is : @xmath111    correction term gives a negative contribution equal to : @xmath112    from eq .",
    "( [ odf18s ] ) one can see that lda contribution to fluctuation energy is defined by the total charge density fluctuations @xmath113 and so does not depend on the orbitals definition . then the minimum of the fluctuation energy eq .",
    "( [ odf18 ] ) is achieved when the absolute value of correction contribution eq .",
    "( [ odf19 ] ) has a maximum .",
    "the correction term contribution in eq .",
    "( [ odf19 ] ) can be calculated using expression of fluctuations hamiltonian via fluctuation occupancy operators @xmath114 [ eq .  ( [ h_fluct ] ) ] : @xmath115    as the average value of square of occupancy fluctuations @xmath116 depends on the specific properties of the system , the only way to minimize fluctuation energy @xmath117 [ eq .  ( [ odf18 ] ) ] is to maximize @xmath118 .",
    "using eqs .",
    "( [ odf21s3 ] ) and ( [ odf23 ] ) this parameter can be expressed via orbitals as : @xmath119    for new set of the functions @xmath120 [ eq .  ( [ odf27 ] ) ]",
    "one has : @xmath121 using eq .  ( [ odf28 ] ) and",
    "the fact that the derivatives @xmath122 are always positive one can define a functional of unitary matrix @xmath6 : @xmath123\\equiv\\sum_i\\frac{\\delta \\tilde{\\epsilon}_i}{\\delta \\tilde{n}_i } =   \\sum_i \\sum_{jj'll ' } u_{ij}u_{ij'}^*u_{il}u_{il'}^*\\int d\\mathbf{r}\\int d\\mathbf{r ' } \\psi_j(\\mathbf{r})\\psi_{j'}^*(\\mathbf{r})w(\\mathbf{r},\\mathbf{r'})\\psi_{l}(\\mathbf{r'})\\psi_{l'}^*(\\mathbf{r'})\\end{aligned}\\ ] ] maximization of which one can use as a condition to determine the matrix @xmath6 and hence the optimal set of orbitals @xmath70 to define odf functional .",
    "the function @xmath42 [ eq .",
    "( [ lda60 ] ) ] is defined as screened effective interaction between density fluctuations @xmath124 and so should decay with increasing of @xmath125 value .",
    "then the more localized in space orbitals @xmath70 are , the larger should be the integral eq .",
    "( [ odf21s4 ] ) value .",
    "one of possible choices for these orbitals could be wannier functions .",
    "marzari and vanderbilt in ref .   proposed the condition of maximum localization to determine the procedure to calculate wannier functions for multi - band case ( two orthonormal sets of functions , wannier and bloch , are connected via unitary transformation so wannier functions can be considered as a particular choice of unitary matrix @xmath6 in eq .",
    "( [ odf27 ] ) ) .",
    "the requirement of maximum localization should lead to the reasonably maximized values of parameter @xmath118 in eq .",
    "( [ odf21s4 ] ) and hence to minimization the fluctuations energy eq .",
    "( [ odf18 ] ) . then wannier functions obtained via procedure proposed in ref .   are a good choice for a set of orbitals to define odf functional .    in the following",
    "we will assume that orbital densities are defined not by one - electron eigenfunctions @xmath27 as in eq .",
    "( [ odf1 ] ) but by wannier functions @xmath126 and their occupancies @xmath127 calculated via procedure described in sec . [ w_def ] : @xmath128    using eqs .",
    "( [ odf30])-([odf20 ] ) odf functional [ eq .  ( [ odf8 ] ) ] could be rewritten with wannier functions occupancy operators @xmath129 [ eq .  ( [ q_wf2 ] ) ] and their average values @xmath130 .",
    "the corresponding functional will be analogous to eq .",
    "( [ odf30 ] ) but with occupancies @xmath127 [ eq .",
    "( [ q_wf ] ) ] and energies @xmath131 [ eq .  ( [ e_wf ] ) ]",
    "corresponding to wannier functions : @xmath132    the variation of the functional eq .",
    "( [ functional - gts ] ) will produce ( see appendix [ project ] ) one - electron hamiltonian @xmath133 in the form of projection operator : @xmath134 @xmath135 in eq .",
    "( [ h_corr ] ) are wannier functions [ eq .",
    "( [ w - b ] ) ] and @xmath136 are : @xmath137 the values of derivatives @xmath138 should be determined in constrained lda calculations ( see sec .",
    "[ w_def ] ) .",
    "equations  ( [ functional - gts])-([dv - gts ] ) are identical to the equations of `` generalized transition state '' ( gts ) method that we have developed in ref .  .",
    "the basis of gts method was an idea that one - electron energies corresponding to wannier functions should have a meaning of the removal ( addition ) energies for electrons from ( to ) the corresponding states .",
    "that was realized by using `` transition state '' scheme @xcite generalized to wannier functions instead of eigenfunctions .",
    "it is remarkable that the same equations can be obtained by introducing correction to the lda functional restoring the properties of the _ exact _ density functional theory .  @xcite    the potential correction operator [ eqs .",
    "( [ h_corr ] ) and ( [ dv - gts ] ) ] shifts the energies of wannier functions on @xmath136 values which are negative ( @xmath139 ) for the occupied states ( @xmath140 ) and positive ( @xmath141 ) for the empty states ( @xmath142 ) . that gives valence bands pushed down and conduction bands pushed up comparing with standard lda results increasing energy separation between them ( energy gap value ) which is systematically underestimated in lda .",
    "it was shown in ref .   that calculations with potential correction [ eqs .",
    "( [ h_corr ] ) and ( [ dv - gts ] ) ] result in a much better agreement with experimental energy gap values for semiconductor ( si ) , band insulator ( mgo ) , mott insulator ( nio ) , and peierls insulator babio@xmath3 .",
    "the hamiltonian @xmath133 [ eq .  ( [ h_corr ] ) ] can be considered as a static mean - field approximation to a general problem .",
    "wannier functions analogue of the fluctuation hamiltonian eq .",
    "( [ h_fluct ] ) is : @xmath143    the first and second parts of hamiltonian eq .",
    "( [ h_corr3 ] ) are not  ( ! )  _ noninteracting _ hamiltonian and _ interaction _ term as it is usually defined in model hubbard and anderson hamiltonians .",
    "the first part @xmath144 is equivalent to the hartree - fock approximation hamiltonian determined by the average values of wannier functions occupancies @xmath145 and the second part describes interaction between fluctuations around @xmath145 . as these average values are determined from the solution of the full hamiltonian eq .",
    "( [ h_corr3 ] ) , that defines a self - consistent calculation scheme .",
    "in contrast to lda+@xmath6@xcite and lda+dmft @xcite methods there is no `` double counting '' problem in this hamiltonian because there were no `` merging '' of lda and hubbard model concepts here and both terms in eq .",
    "( [ h_corr3 ] ) were derived from the same functional eq .",
    "( [ functional - gts ] ) .    the problem defined by the hamiltonian eq .",
    "( [ h_corr3 ] ) can be solved by any of the methods developed to treat many - body effects . in the present work we have used dynamical mean - field theory ( dmft)@xcite ( see sec . [ wf_dmft ] ) .",
    "the orbital projection calculation scheme for wannier functions ( wfs ) used in the present work was described in details in the earlier paper@xcite where the lda+dmft ( dmft  dynamical mean - field theory ) method in the wannier function basis set was proposed .",
    "below we present the main formulas of this scheme .",
    "the concept of wfs has a very important place in the electron theory in solids since its first introduction in 1937 by wannier .",
    "@xcite wfs are the fourier transformation of bloch states @xmath146 , @xmath147 where @xmath7 is the number of discrete @xmath148 points in the first brillouin zone ( or , the number of cells in the crystal ) and * t * is lattice translation vector .",
    "wannier functions are not uniquely defined for a many - band case because for a certain set of bands any orthogonal linear combination of bloch functions @xmath146 can be used in eq .",
    "( [ wf_psi_def ] ) . in general",
    "it means the freedom to choose the of unitary transformation matrix @xmath149 for bloch functions :  @xcite @xmath150 there is no rigorous way to define @xmath149 .",
    "this calls for an additional restriction on the properties of wfs . among others ,",
    "marzari and vanderbilt  @xcite used the condition of maximum localization for wfs , resulting in a variational procedure to calculate @xmath149 . to get a good initial",
    "guess the authors of ref .",
    "proposed choosing a set of localized trial orbitals @xmath151 and projecting them onto the bloch functions @xmath146 .",
    "it was found that this starting guess is usually quite good .",
    "this fact later led to the simplified calculating scheme in ref .   where the variational procedure was abandoned and the result of the aforementioned projection",
    "was considered as the final step .    for the projection procedure used in the present work one needs to identify the set of bands and corresponding set of localized trial orbitals @xmath151 .",
    "the choice of bands and orbitals is determined by the physics of the system under consideration .",
    "the set of bands can be defined either by the band indices of the corresponding bloch functions ( @xmath152 ) , or by choosing the energy interval ( @xmath153 ) in which the bands are located .",
    "nonorthogonalized wfs in reciprocal space @xmath154 are then the projection of the set of site - centered atomiclike trial orbitals @xmath151 on the bloch functions @xmath146 of th chosen bands defined by band indices ( @xmath155 to @xmath156 ) or by energy interval ( @xmath153 ) : @xmath157    in the present work we have used lmto method@xcite to solve a band structure problem and the trial orbitals @xmath151 were lmtos .",
    "the coefficients @xmath158 in eq .  ( [ wf_psi ] )",
    "define ( after orthonormalization ) the unitary transformation matrix @xmath149 in eq .",
    "( [ psi_def ] ) .    in any dft method",
    "the kohn - sham orbitals are expanded through the certain basis : @xmath159 the basis functions of the lmto method are bloch sums of the site - centered orbitals : @xmath160 where @xmath161 is the combined index representing @xmath162 ( @xmath163 is the atomic number index in the unit cell , @xmath164 are orbital and magnetic quantum numbers ) , @xmath165 is the position of atom in the unit cell .    for the _ orthogonal",
    "_ lmto basis @xmath166 and hence    @xmath167 for a nonorthogonal basis set orthogonalization of the hamiltonian must be done before using eq .",
    "( [ coef_b ] ) .    in order to orthonormalize the wfs [ eq .",
    "( [ wf ] ) ] one needs to calculate the overlap matrix @xmath168 , @xmath169 and its inverse square root @xmath170 , @xmath171 from eqs .",
    "( [ wf ] ) and ( [ ss ] ) the orthonormalized wfs in @xmath148 space @xmath172 can be obtained as @xmath173 @xmath174    using eqs .",
    "( [ wf_orth])-([coef_wf_lmto ] ) one can find energies of wfs :    @xmath175    and their occupancies : @xmath176 where @xmath177 is the eigenvalue for a particular band , @xmath178 is the step function , @xmath179 is the fermi energy .",
    "the transformation from lmto to the wf basis set is defined by the explicit form of wfs eqs .",
    "( [ wf_orth ] ) and ( [ coef_wf_lmto ] ) , and by the expressions for matrix elements of the hamiltonian and density matrix operators in wf basis [ eqs .",
    "( [ e_wf ] ) and ( [ q_wf ] ) ] . the transformation from wf to lmto basis",
    "can also be defined using eq .",
    "( [ wf_orth ] ) .",
    "such transformation is necessary in calculations using odf correction potential in the form of projection operator eq .",
    "( [ h_corr ] ) .",
    "it will also be used for constrained lda calculations needed to determine the values of wfs energy derivatives with respect to their occupancies @xmath180 which define potential correction parameters @xmath136 in eqs .",
    "( [ h_corr ] ) and ( [ dv - gts ] ) and effective coulomb parameters @xmath181 in odf fluctuation hamiltonian in the hubbard form eqs .",
    "( [ h_corr4])-([h_corr6 ] ) .",
    "for example if constrain potential operator is diagonal in wf basis ( @xmath182 ) , then in lmto basis its matrix elements can be calculated via : @xmath183 @xmath184 @xmath185",
    "in many - body theory the system is usually described not by bloch functions @xmath146 [ eq .  ( [ psi ] ) ] and their energies @xmath177 but by the green function @xmath186 the matrix green function @xmath187 is defined via the noninteracting hamiltonian matrix @xmath188 [ eq .  ( [ h_corr6 ] ) and ( [ h_constrain2 ] ) ] and the matrix self - energy @xmath189 [ eq .  ( [ sigma_full ] ) ] as @xmath190^{-1}_{\\mu \\nu}.\\end{aligned}\\ ] ]",
    "we define the nonorthonormalized wf obtained by projecting the trial orbital @xmath191 on the hilbert subspace determined by the green function [ eq .  ( [ green1 ] ) ] in the energy interval ( @xmath153 ) , namely , @xmath192 and @xmath193 in the noninteracting case , the self - energy @xmath194 is absent and hence we have @xmath195 where @xmath196 are the eigenvectors , and @xmath177 are the eigenvalues of @xmath197 .",
    "thus @xmath198 in eq .  ( [ coef_green_b ] ) becomes @xmath199 where @xmath200 are the band numbers corresponding to the energy interval ( @xmath153 ) . since this recovers the result of eq .",
    "( [ coef_b ] ) , we demonstrated that our general definition of wfs [ eq .  ( [ wf1 ] ) ] via green function reduces to that in terms of bloch functions [ eq .",
    "( [ wf ] ) ] in sec .",
    "[ w_def ] .    to orthonormalize @xmath201 defined in eq .",
    "( [ wf1 ] ) , one can just follow the orthonormalizing procedure made in sec .",
    "[ w_def ] [ eqs .",
    "( [ o - s])-([coef_wf_lmto ] ) ] with the overlap matrix @xmath168 is defined as @xmath202 the occupancy matrix in the orthogonalized wf basis [ eq .",
    "( [ wf1 ] ) ] is defined as @xmath203 by using eq .",
    "( [ green1 ] ) and orthogonalized wannier functions [ eq .  ( [ wf1 ] ) ] , one finds @xmath204 with @xmath205 the energy matrix can be defined similarly ( except that the integral over energy is calculated in the @xmath206 interval where the corresponding wfs are determined ) as @xmath207 with @xmath208",
    "the dmft@xcite was recently found to be a powerful tool to numerically solve multiband hubbard models . in order to use this tool the fluctuation hamiltonian [ eq .  ( [ h_corr3 ] ) ]",
    "should be rewritten in the form of standard multi - orbital hubbard model . for that one",
    "needs to identify coulomb parameters @xmath181 as derivatives @xmath180 and rearrange terms in eq .",
    "( [ h_corr3 ] ) into noninteracting and interaction parts : @xmath209 with interaction term : @xmath210 and noninteracting hamiltonian : @xmath211    in dmft the lattice problem becomes an effective single - site problem which has to be solved self - consistently for the matrix self energy @xmath212 and the local matrix green function in wannier functions basis set : @xmath213^{-1}\\right)_{nn'},\\end{aligned}\\ ] ] where @xmath161 is a chemical potential , @xmath214 is noninteracting hamiltonian [ eq .  ( [ h_corr6 ] ) ] and",
    "@xmath215 is self - energy in wannier functions basis : @xmath216 the dmft single - site problem may be viewed as a self - consistent single - impurity anderson model .",
    "@xcite the corresponding local one - particle matrix green function @xmath217 can be written as a functional integral@xcite involving an action where the hamiltonian of the correlation problem under investigation , including the interaction term with the hubbard interaction , enters .",
    "@xcite the action depends on the bath matrix green function @xmath218 through @xmath219 to solve the functional integral of the effective single - impurity anderson problem , various methods can be used : quantum monte carlo ( qmc ) , numerical renormalization group ( nrg ) , exact diagonalization ( ed ) , non - crossing approximation ( nca ) , etc .",
    "( for a brief overview of the methods see ref .  ) . in the present work",
    "the qmc method was used to solve the impurity problem .",
    "the matrix self - energy @xmath220 obtained as a solution of dmft in sec .",
    "[ wf_dmft ] is defined in the wf basis set [ eq .  ( [ sigma ] ) ] . in order to compute the interacting green function in the full - orbital hilbert space [ eqs .",
    "( [ green1 ] ) and ( [ green2 ] ) ] one has to transform self - energy to the lmto basis set .",
    "this can be easily done by using the linear - expansion form of the wfs in terms of the lmto basis set [ eqs .",
    "( [ wf_orth ] ) and ( [ coef_wf_lmto ] ) ] , @xmath221 the matrix elements of the self - energy @xmath222 [ eq .  ( [ sigma_full ] ) ] together with the noninteracting hamiltonian matrix @xmath223 [ eqs .",
    "( [ h_corr6 ] ) and ( [ h_constrain2 ] ) ] allow one to calculate the matrix green function @xmath224 [ eq .",
    "( [ green2 ] ) ] and thus the interacting green function @xmath225 [ eq .  ( [ green1 ] ) ] .",
    "@xmath225 contains the full information about the system , and various electronic , magnetic , and spectral properties can be obtained from it .",
    "one can also calculate the charge - density distribution modified by correlation effects via @xmath226 with this @xmath227 one can recalculate the lda potential which is a functional of electron density [ eq .  ( [ lda49 ] ) ] . from the green function [ eq .",
    "( [ green1 ] ) ] one can recalculate new wfs [ eqs .",
    "( [ wf1 ] ) and ( [ coef_green_b ] ) ] which together with the new lda hamiltonian allows one to obtain new parameters for the noninteracting hamiltonian [ eqs .",
    "( [ h_constrain2 ] ) and ( [ h_corr6 ] ) ] . with the new set of wannier functions one performs a series of constrain lda calculation to determine derivatives @xmath180 and",
    "hence define a new coulomb interaction parameters @xmath181 in the interaction hamiltonian [ eq .  ( [ h_corr5 ] ) ] .",
    "the set of new lda potential , wfs , and coulomb interaction parameters calculated from the interacting green function [ eq .  ( [ green1 ] ) ] defines the input for the next iteration step and hence closes the self - consistency loop in the computation scheme . for the feedback from dmft to lda in the particular case of the lmto",
    "method@xcite one needs a set of moments for the partial densities of states @xmath228 for every atomic sphere @xmath163 and the orbital moment @xmath229 ( ref .  ) in order to calculate the new charge density and hence the new lda potential : @xmath230    the orbital densities functional computational scheme described above is _ ab initio _",
    "( does not contain any outside parameters ) and fully self - consistent .",
    "the charge density @xmath227 , wannier functions @xmath231 , and derivatives @xmath180 ( effective fluctuations interaction strength ) are recalculated on every self - consistency loop and hence modified by correlations comparing with the values obtained in standard lda calculations .",
    "analogous calculation scheme was proposed in fig .  1 in ref .  .",
    "in the present work odf method was applied to the problem of metal - insulator transition in nonstoichiometric lanthanum trihydride lah@xmath0 , where both parts of the calculation scheme , static mean - field approximation [ eqs .",
    "( [ functional - gts])-([dv - gts ] ) ] and fluctuation hamiltonian [ eq .",
    "( [ h_corr3 ] ) ] in dmft ( sec . [ wf_dmft ] ) were needed to describe experimentally observed dependence of the system ground state on the hydrogen deficiency parameter @xmath1 .",
    "lanthanum trihydride lah@xmath0 shows an interesting metal - insulator transition with increasing of @xmath1 value .",
    "@xcite while stoichiometric lah@xmath3 is an insulator , 30% hydrogen deficiency ( @xmath232 ) results in a metallic ground state .",
    "however , standard lda calculations@xcite give a metal as a ground state even for stoichiometric composition lah@xmath233 .",
    "in this case well - known problem of lda , underestimation of the energy gap value , is so severe that the gap value is negative with valence and conduction bands overlapping on 0.25 ev ( see fig .",
    "[ lah3_lda ] ) .",
    "the lanthanum trihydride has a crystal structure derived from the face - centered cubic structure ( lattice parameter @xmath234 = 10.5946 a.u . ) for la atoms and hydrogen atoms occupying two tetrahedral and one octahedral interstitials per every metallic ion .",
    "the band structure of lah@xmath3 ( fig .  [ lah3_lda ] ) is relatively simple : lower three occupied bands are formed by hydrogen @xmath235 states and the conduction bands correspond to lanthanum 5@xmath236 , 6@xmath237 , and 6@xmath238 states .",
    "attempts to cure the lda fault in lah@xmath3 were performed with many methods beyond lda , among others , the gw method@xcite ( the energy gap @xmath239=0.8 - 0.9 ev ) , the weighted local density approach@xcite ( @xmath239=0.7 ev ) , and model calculations .",
    "@xcite    the orbital densities functional ( odf ) theory [ eq .  ( [ functional - gts ] ) ]",
    "proposed in the present work adds to standard kohn - sham equations potential correction in the form of projection operator [ eqs .",
    "( [ h_corr ] ) and ( [ dv - gts ] ) ] .",
    "this correction is negative for occupied valence bands and positive for empty conduction bands and hence increases energy separation between those bands .",
    "odf calculations for lah@xmath3 results in insulating ground state with a fundamental gap value of 1.10 ev and direct optical gap 1.25 ev at g - point ( see fig .  [ lah3_gts ] ) . experimental data for the value of energy gap e@xmath240=0.5 ev was estimated using activation energy determined from resistivity measurements in ref .  .",
    "optical measurements estimate the direct gap e@xmath240 as 1.87 ev but the fundamental band gap @xmath2411 ev lower .",
    "@xcite    hydrogen atoms could be removed from the lanthanum trihydride forming nonstoichiometric lah@xmath0 .",
    "we have performed lda and odf calculations for two compositions @xmath1=0.25 ( lah@xmath4 ) ( see fig .  [ la4h11v ] ) and @xmath1=0.5 ( lah@xmath5 ) ( see fig .  [ la2h5v ] ) .",
    "both lda and odf calculations gave metallic ground state for two compositions @xmath1=0.25 and @xmath1=0.5 .",
    "every hydrogen vacancy leads to appearance of one vacancy state in the gap split from the conduction band with one electron occupying this state ( see fig .",
    "[ la4h11v](a ) ) .",
    "static mean - field odf potential correction [ eqs .",
    "( [ h_corr ] ) and ( [ dv - gts ] ) ] results in separation of the vacancy band from the conduction band and in increasing of energy gap between valence and conduction bands comparing with lda but half - filled vacancy band stays metallic ( see figs .  [ la4h11v](b ) and  [ la2h5v](b ) )",
    ". however , experimentally only lah@xmath5 is metallic while lah@xmath4 should be an insulator . to treat this problem we have used odf fluctuation hamiltonian [ eq .  ( [ h_corr3 ] ) ] and",
    "have solved it using dmft - qmc ( see sec .",
    "[ wf_dmft ] ) .",
    "inverse temperature parameter was @xmath242=10  ev@xmath243 . in the result",
    "we have obtained in agreement with experiment paramagnetic insulator ground state for lah@xmath4 with a typical mott insulator pattern of lower and upper hubbard bands around chemical potential with the energy gap of 0.1  ev ( see fig .",
    "[ dmft](b ) ) . however , for lah@xmath5 a width of the vacancy band is significantly larger then for lah@xmath4 ( see figs .",
    "[ la4h11v](b ) and [ la2h5v](b ) ) and dmft calculations resulted in well defined metallic state ( see fig .  [ dmft](a ) ) .",
    "we have proposed orbital densities functional that by construction has discontinuous exchange - correlation potential in agreement with _ exact _ density functional theory . the one - electron potential obtained by variation of this",
    "functional produces comparing with lda lower energies for valence bands and higher energies for conduction bands thus overcoming systematic underestimation of energy gap value in lda . to treat correlation effects",
    "we have derived from orbital densities functional the hamiltonian corresponding to the fluctuations of orbital densities around the ground state values . combining this hamiltonian with dynamical mean - filed theory and quantum monte carlo method for effective impurity problem",
    "we have developed _ ab initio _ and fully self - consistent scheme for electronic structure calculations .",
    "the scheme was applied to the problem of metal - insulator transition in lah@xmath0 and gave a qualitative improvement for agreement with experimental data .",
    "this work was supported by russian foundation for basic research under the grants rffi-04 - 02 - 16096 and rffi-03 - 02 - 39024 , by netherlands organization for scientific research through nwo 047.016.005 .",
    "a.l . acknowledges support from the dynasty foundation and international centre for fundamental physics in moscow .",
    "we are grateful to d.  vollhardt for helpful discussions and for supplying qmc - dmft computer code .",
    "lda functional @xmath244 $ ] depends on the electron density @xmath12 defined by one - electron functions @xmath70 and their occupancies @xmath49 : @xmath245 @xmath246   = t[\\rho ]    + \\frac{1}{2}\\int d\\mathbf{r}\\int d\\mathbf{r ' } \\frac{\\rho(\\mathbf{r})\\rho(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}| }    \\\\",
    "\\nonumber + \\int d\\mathbf{r } v_z(\\mathbf{r})\\rho(\\mathbf{r } ) + e_{xc}[\\rho],\\end{aligned}\\ ] ] where @xmath247 is external potential , @xmath248 $ ] is exchange - correlation energy functional [ see eq .",
    "( [ odf2 ] ) ] and @xmath249 $ ] is kinetic energy term .    kinetic energy is a functional of electron density @xmath249 $ ] via single particle orbitals @xmath70 which are functionals of density themselves . to prove that the following reasoning can be used .",
    "@xcite hohenberg - kohn theorem@xcite states that external potential is uniquely defined by the ground state electron density of the system .",
    "that is also true for a noninteracting system with potential @xmath250(\\mathbf{r})$ ] .",
    "this potential defines a schrdinger equation for the orbitals @xmath70 : @xmath251(\\mathbf{r}))\\psi_i(\\mathbf{r } ) = \\epsilon_i\\psi_i(\\mathbf{r}).\\end{aligned}\\ ] ] as potential @xmath250(\\mathbf{r})$ ] is a functional of density then solutions of the eq .",
    "( [ lda46 ] ) are also functionals of density : @xmath252(\\mathbf{r}).\\end{aligned}\\ ] ]    kinetic energy is defined by a set of orbitals @xmath253(\\mathbf{r})$ ] and hence it is also a functional of density : @xmath254   =   \\sum_i n_i\\int d\\mathbf{r } \\psi^{*}_i[\\rho](\\mathbf{r})(-\\nabla^2)\\psi_i[\\rho](\\mathbf{r } ) .",
    "\\end{aligned}\\ ] ]    minimization of the functional eq .",
    "( [ lda44 ] ) gives : @xmath255}{\\delta\\rho(\\mathbf{r } ) } = \\frac{\\delta t[\\rho]}{\\delta\\rho(\\mathbf{r } ) } + v_{lda}(\\mathbf{r } ) = 0\\end{aligned}\\ ] ] where one - electron lda potential is : @xmath256 ( @xmath257/\\delta\\rho(\\mathbf{r})$ ] is exchange - correlation potential ) .",
    "variation of kinetic energy functional is : @xmath258 & = & \\delta \\big ( \\sum_i n_i\\int d\\mathbf{r } \\psi^{*}_i[\\rho](\\mathbf{r})(-\\nabla^2)\\psi_i[\\rho](\\mathbf{r})\\big ) \\\\ \\nonumber & = & \\delta \\big ( \\sum_i n_i\\int d\\mathbf{r } \\psi^{*}_i[\\rho](\\mathbf{r})(\\epsilon_i[\\rho]-v_s[\\rho](\\mathbf{r}))\\psi_i[\\rho](\\mathbf{r})\\big)\\\\ \\nonumber & = &   \\delta \\big(\\sum_i n_i\\epsilon_i[\\rho]-\\int d\\mathbf{r } v_s[\\rho](\\mathbf{r})\\rho(\\mathbf{r})\\big ) .\\end{aligned}\\ ] ] first order perturbation theory for one - electron energies @xmath259 $ ] gives : @xmath260 & = & \\int d\\mathbf{r } \\psi^{*}_i[\\rho](\\mathbf{r})(\\delta v_s[\\rho](\\mathbf{r } ) ) \\psi_i[\\rho](\\mathbf{r})\\big .\\end{aligned}\\ ] ] then eq .",
    "( [ lda50 ] ) is : @xmath261   =    - \\int d\\mathbf{r ' } v_s[\\rho](\\mathbf{r})\\delta \\rho(\\mathbf{r } ) \\end{aligned}\\ ] ] and variational derivative of kinetic energy functional is : @xmath262}{\\delta\\rho(\\mathbf{r } ) } = -v_s[\\rho](\\mathbf{r}).\\end{aligned}\\ ] ] the minimization condition [ eq .  ( [ lda48 ] ) ] becomes : @xmath263}{\\delta\\rho(\\mathbf{r } ) } =   -v_s[\\rho](\\mathbf{r})+v_{lda}(\\mathbf{r } ) = 0 .\\end{aligned}\\ ] ]    a set of kohn - sham@xcite equations ( [ lda46 ] ) with @xmath250(\\mathbf{r } ) = v_{lda}(\\mathbf{r})$ ] defines one - electron orbitals @xmath253(\\mathbf{r})$ ] and hence a new electron density @xmath14 via eq .",
    "( [ lda43 ] ) .",
    "the problem should be solved self - consistently till electron density used to calculate @xmath264 will coincide with the density obtained using kohn - sham equations solutions @xmath253(\\mathbf{r})$ ] .    in order to define functional [ eq .  ( [ lda44 ] ) ] for charge density @xmath265 different from the density minimizing",
    "@xmath244 $ ] one needs to introduce constrain potential @xmath41 and minimize auxiliary functional : @xmath266   = e_{lda}[\\rho ]   + \\int d\\mathbf{r } \\phi(\\mathbf{r})(\\rho(\\mathbf{r})-\\widetilde{\\rho}(\\mathbf{r})),\\end{aligned}\\ ] ] @xmath267(\\mathbf{r})+v_{lda}(\\mathbf{r})+\\phi(\\mathbf{r})=0 .\\end{aligned}\\ ] ] then potential in kohn - sham equations ( [ lda46 ] ) is : @xmath268(\\mathbf{r})=v_{lda}(\\mathbf{r})+ \\phi(\\mathbf{r}).\\end{aligned}\\ ] ] the second variational derivative of lda functional is : @xmath269}{\\delta\\rho(\\mathbf{r})\\delta\\rho(\\mathbf{r ' } ) } = \\frac{\\delta}{\\delta\\rho(\\mathbf{r'})}(-v_s[\\rho](\\mathbf{r})+v_{lda}(\\mathbf{r}))= \\frac{\\delta v_{lda}(\\mathbf{r})}{\\delta\\rho(\\mathbf{r'})}-\\frac{\\delta v_s[\\rho](\\mathbf{r})}{\\delta\\rho(\\mathbf{r'})}.\\end{aligned}\\ ] ] the variational derivative of lda potential [ eq .  ( [ lda49 ] ) ] is obtained in a straightforward way : @xmath270 the second term in eq .",
    "( [ lda55 ] ) , @xmath271(\\mathbf{r})/\\delta\\rho(\\mathbf{r'})$ ] is more complicated .",
    "let us first solve an inverse problem  to calculate response function :  @xcite @xmath272 first - order perturbation theory for eigenfunctions and eigenvalues of kohn - sham equations ( [ lda46 ] ) gives : @xmath273 then response function in eq .",
    "( [ lda57s ] ) is : @xmath274 the second term in eq .",
    "( [ lda55 ] ) is defined by the inverse response function : @xmath275 this inverse response function can be obtained solving integral equation : @xmath276 then the second variational derivative of lda functional is : @xmath277 @xmath42 can be interpreted as an effective interaction strength between density fluctuations @xmath124 in lda functional .",
    "the first variational derivative of the lda functional can be obtained from eq .",
    "( [ lda42 ] ) : @xmath278(\\mathbf{r}),\\end{aligned}\\ ] ] where @xmath279(\\mathbf{r})$ ] is constrain potential needed to obtain electron density @xmath14 in self - consistent solution of kohn - sham equations [ eqs .",
    "( [ lda46 ] ) and ( [ lda54 ] ) ] .",
    "let us consider variation of the lda functional eq .",
    "( [ lda44 ] ) in respect to the occupancies @xmath49 and orbitals @xmath70 defining electron density @xmath14 in eq .",
    "( [ lda43 ] ) : @xmath280    @xmath281    @xmath282    @xmath283    as orbitals are normalized : @xmath284 and from eq .",
    "( [ lda65 ] ) it follows that : @xmath285    all this was proven to be valid for the lda eigenfunctions @xmath70 which are solutions of kohn - sham equations [ eq .",
    "( [ lda46 ] ) ] .",
    "let us prove that the derivative of lda functional over the wannier function occupancy @xmath127 [ eq .  ( [ q_wf ] ) ] is equal to the energy @xmath131 [ eq .  ( [ e_wf ] ) ] of this wf .",
    "the charge density expressed via wannier functions @xmath126 [ eq .",
    "( [ wf_orth ] ) ] and its occupancies @xmath127 is : @xmath286 then derivative over wannier function occupancy @xmath127 ( with fixed functions @xmath287 ) can be calculated using eq .",
    "( [ lda63 ] ) : @xmath288",
    "in odf functional eq .",
    "( [ functional - gts ] ) wannier functions occupancies @xmath127 [ eq .  ( [ q_wf ] ) ] can be expressed via projection operator @xmath129 : @xmath289 ( summation @xmath290 is over occupied states only in all equations below ) .",
    "the variational derivative of occupancy @xmath127 with respect to the one - electron wave function @xmath291 is : @xmath292 then variation of the correction term in odf functional eq .",
    "( [ functional - gts ] ) will give the following correction to the corresponding expression for lda functional [ see eq .",
    "( [ lda64 ] ) ] : @xmath293 this proves eqs .",
    "( [ h_corr ] ) and ( [ dv - gts ] ) for odf correction to lda hamiltonian .",
    "kinetic energy term in eq .",
    "( [ lda44 ] ) can be calculated using eq .",
    "( [ lda46 ] ) : @xmath294 multiplying eq .",
    "( [ lda14 ] ) by @xmath295 , integrating over @xmath296 and summing over occupied states @xmath28 one can obtain : @xmath297 then total energy in eq .",
    "( [ lda44 ] ) is equal to : @xmath298 using eq .",
    "( [ lda49 ] ) for lda potential @xmath299 the final expression for total energy is : @xmath300    in the case of odf functional [ eq .  ( [ functional - gts ] )",
    "] there will be an additional term in expression for kinetic energy [ eq .",
    "( [ lda15 ] ) ] due to the odf potential correction [ eq .",
    "( [ lda19 ] ) ] : @xmath301 the additional terms to total energy expression eq .",
    "( [ lda17 ] ) are @xmath302 here @xmath303 is defined as right part of eq .",
    "( [ lda17 ] ) .",
    "@xmath303 differs from @xmath304 because it is taken for @xmath305 which does not minimize @xmath304 .",
    "99 w. kohn and l.  j. sham , phys .",
    "rev . * 140 * , a1133 ( 1965 ) .",
    "p.  hohenberg and w.  kohn , phys",
    "136 * , b864 ( 1964 ) .",
    "f.  gygi and g.  galli , mater . today * 8 * , 26 ( 2005 ) .",
    "jones and o. gunnarsson , rev .",
    "phys . * 61 * , 689 ( 1989 ) .",
    "w. e. pickett , rev . mod . phys . * 61 * , 433 ( 1989 ) .",
    "l. hedin , phys . rev . * 139 * , a796 ( 1965 )",
    ". j.  p. perdew and a. zunger , phys .",
    "b * 23 * , 5048 ( 1981 ) .",
    "v.  i. anisimov , j. zaanen , and o.  k. andersen , phys .",
    "b * 44 * , 943 ( 1991 ) . v.  i. anisimov , f. aryasetiawan , and a. lichtenstein , j. phys . : condens .",
    "matter * 9 * , 767 ( 1997 ) .",
    "a.  d. becke , phys .",
    "a * 38 * , 3098 ( 1988 ) ; j.  p. perdew and y. wang , phys .",
    "b * 45 * , 13  244 ( 1992 ) ; j.  p. perdew , k. burke , and m. ernzerhof , phys .",
    "lett . * 77 * , 3865 ( 1996 ) .",
    "j.  p. perdew , r.  g.  parr , m.  levy , and j.  l. balduz , phys .",
    "49 * , 1691 ( 1982 ) .",
    "d.  vollhardt , in _ correlated electron systems _ , edited by v. j. emery ( world scientific , singapore , 1993 ) , p. 57 . th .",
    "pruschke , m. jarrell , and j.  k. freericks , adv . in phys . *",
    "44 * , 187 ( 1995 ) .",
    "a. georges , g. kotliar , w. krauth , and m.  j. rozenberg , rev .",
    "phys . * 68 * , 13 ( 1996 ) .",
    "n. marzari and d. vanderbilt , phys .",
    "b * 56 * , 12  847 ( 1997 ) ; n. marzari , i. souza , and d. vanderbilt , psi - k newsletter * 57 * , 112 ( 2003 ) [ psi-k.dl.ac.uk/newsletters/news_57/highlight_57.pdf ] . v.  i. anisimov and a.  v. kozhevnikov , phys . rev .",
    "b * 72 * , 071525 ( 2005 ) . j. c. slater , _ quantum theory of molecules and solids _",
    "( mcgrow - hill , new york , 1974 ) , vol .",
    "k. held , i. a. nekrasov , n. blmer , v. i. anisimov , and d. vollhardt , int . j. mod .",
    "b * 15 * , 2611 ( 2001 ) ; k. held , i. a. nekrasov , g. keller , v. eyert , n. blmer , a. k. mcmahan , r. t. scalettar , t. pruschke , v. i. anisimov , and d. vollhardt , in _ quantum simulations of complex many - body systems : from theory to algorithms _ , edited by j.  grotendorst , d.  marks , and a.  muramatsu , nic series no . 10",
    "( nic directors , forschunszentrum jlich , 2002 ) , pp .",
    "175 - 209 ; k. held , i. a. nekrasov , g. keller , v. eyert , n. blmer , a. k. mcmahan , r.  t.  scalettar , th .",
    "pruschke , v.  i.  anisimov , and d.  vollhardt , psi - k newsletter * 56 * , 65 ( 2003 ) [ psi-k.dl.ac.uk/newsletters/news_56/highlight_56.pdf ] ; a.  i.  lichtenstein , m.  i.  katsnelson , and g.  kotliar , in _ electron correlations and materials properties _",
    ", edited by a. gonis , n. kioussis , and m. ciftan ( kluwer academic / plenum , new york , 2002 ) , p. 428 .",
    "v. i. anisimov , d. e. kondakov , a. v. kozhevnikov , i. a. nekrasov , z.  v.  pchelkina , j.  w.  allen , s .- k .",
    "kim , p. metcalf , s. suga , a. sekiyama , g. keller , i. leonov , x. ren , and d. vollhardt , phys .",
    "b * 71 * , 125119 ( 2005 )",
    ". g. h. wannier , phys . rev . * 52 * , 191 ( 1937 ) .",
    "wei ku , h. rosner , w. e. pickett , and r. t. scalettar , phys .",
    "lett . * 89 * , 167204 ( 2002 ) .",
    "o. k. andersen , phys .",
    "b * 12 * , 3060 ( 1975 ) ; o. gunnarsson , o. jepsen , and o. k. andersen , _ ibid .",
    "_ * 27 * , 7144 ( 1983 ) . h.",
    "l. skriver , _ the lmto method _ , springer series on solid state science , no .",
    "41 ( springer , new york , 1984 ) .",
    "j. n. huiberts , r. griessen , j. h. rector , r. j. wijngaarden , j. p. dekker , d. g. de groot , and n. j. koeman , nature ( london ) * 380 * , 231 ( 1996 ) .",
    "j. p. dekker , j. van ek , a. lodder , and j. n. huiberts , j. phys . : condens .",
    "matter * 5 * , 4805 ( 1993 ) ; y. wang and m. y. chou , phys .",
    ". lett . * 71 * , 1226 ( 1993 ) ; m. gupta and j. p. burger , phys . rev .",
    "b * 22 * , 6074 ( 1980 ) .",
    "j. a. alford , m. y. chou , e. k. chang , and s. g. louie , phys .",
    "b * 67 * , 125110 ( 2003 ) ; e.  k.  chang , x.  blase , and s. g. louie , _ ibid . _ * 64 * , 155108 ( 2003 ) .",
    "zhigang wu , r.  e.  cohen , d.  j.  singh , r.  gupta , and m.  gupta , phys .",
    "b * 69 * , 085104 ( 2004 ) .",
    "k. k. ng , f. c. zhang , v. i. anisimov , and t. m. rice , phys .",
    ". lett . * 78 * , 1311 ( 1997 ) ; phys .",
    "b * 59 * , 5398 ( 1997 ) .",
    "j. shinar , b. dehner , r. g. barnes , and b. j. beaudry , phys .",
    "lett . * 64 * , 563 ( 1990 ) ; j.  peterman , j.  h. weaver , and d.  t. peterson , phys .",
    "b * 23 * , 3903 ( 1981 ) .",
    "a. t. m. van gogh , d. g. nagengast , e. s. kooij , n. j. koeman , j. h. rector , r. griessen , c.  f.  j.  flipse , and r. j. j. g. a. m. smeets , phys .",
    "b * 63 * , 195105 ( 2001 ) .",
    "t. grabo , t. kreibich , s. kurth , and e. k. u. gross , in _ strong coulomb correlations in electronic structure calculations _ , edited by v. i. anisimov ( gordon and breach science publishers , amsterdam , 2000 ) , pp .",
    "203 - 305 .",
    "a.  grling and m.  levy , phys .",
    "a * 50 * , 196 ( 1994 ) ."
  ],
  "abstract_text": [
    "<S> local density approximation ( lda ) to the density functional theory ( dft ) has continuous derivative of total energy as a number of electrons function and continuous exchange - correlation potential , while in _ exact _ dft both should be discontinuous as number of electrons goes through an integer value . </S>",
    "<S> we propose orbital densities functional ( odf ) ( with orbitals defined as wannier functions ) that by construction obeys this discontinuity condition . by its variation one - electron equations </S>",
    "<S> are obtained with potential in the form of projection operator . </S>",
    "<S> the operator increases a separation between occupied and empty bands thus curing lda deficiency of energy gap value systematic underestimation . </S>",
    "<S> orbital densities functional minimization gives ground state orbital and total electron densities . </S>",
    "<S> the odf expression for the energy of orbital densities fluctuations around the ground state values defines odf fluctuation hamiltonian that allows to treat correlation effects . </S>",
    "<S> dynamical mean - field theory ( dmft ) was used to solve this hamiltonian with quantum monte carlo ( qmc ) method for effective impurity problem . </S>",
    "<S> we have applied odf method to the problem of metal - insulator transition in lanthanum trihydride lah@xmath0 . in lda calculations </S>",
    "<S> ground state of this material is metallic for all values of hydrogen nonstoichiometry @xmath1 while experimentally the system is insulating for @xmath2 . </S>",
    "<S> odf method gave paramagnetic insulator solution for lah@xmath3 and lah@xmath4 but metallic state for lah@xmath5 . </S>"
  ]
}