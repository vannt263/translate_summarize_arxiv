{
  "article_text": [
    "[ [ sparse - graphs . ] ] sparse graphs . + + + + + + + + + + + + + +",
    "the notion of nowhere denseness was introduced by neetil and ossona de mendez  @xcite as a general model of _ uniform sparseness _ of graphs .",
    "many familiar classes of sparse graphs , like planar graphs , graphs of bounded treewidth , graphs of bounded degree , and , in fact , all classes that exclude a fixed ( topological ) minor , are nowhere dense .",
    "notably , classes of bounded average degree or bounded degeneracy are not necessarily nowhere dense . in an algorithmic context",
    "this is reasonable , as every graph can be turned into a graph of degeneracy at most  @xmath7 by subdividing every edge once ; however , the structure of the graph is essentially preserved under this operation .",
    "formally , a graph @xmath8 is a",
    "_ minor _ of a graph @xmath0 , written @xmath9 , if there are pairwise vertex - disjoint connected subgraphs @xmath10 of  @xmath0 such that whenever @xmath11 is an edge in @xmath8 , there are @xmath12 and @xmath13 for which @xmath14 is an edge in @xmath0 .",
    "such a family @xmath10 is called a _ minor model _ of @xmath8 in @xmath0 .",
    "the graph @xmath8 is a _",
    "depth-@xmath3 minor _ of @xmath0 , denoted @xmath15 , if there is a minor model @xmath10 of  @xmath8 in @xmath0 such that each subgraph @xmath16 has radius at most @xmath3 .",
    "[ def : nwd ] a class @xmath1 of graphs is _ nowhere dense _ if there is a function @xmath17 such that @xmath18 for all @xmath19 and all @xmath20 .",
    "nowhere denseness turns out to be a very robust concept with several seemingly unrelated natural characterizations .",
    "these include characterizations by the density of shallow ( topological ) minors  @xcite , quasi - wideness  @xcite ( a notion introduced by dawar  @xcite in his study of homomorphism preservation properties ) , low tree - depth colorings  @xcite , generalized coloring numbers  @xcite , sparse neighborhood covers  @xcite , by a game called the splitter game  @xcite and by the model - theoretic concepts of stability and independence  @xcite . for a broader discussion",
    "we refer to the book of neetil and ossona de mendez  @xcite .",
    "this wealth of concepts and results has been applied to multiple areas in mathematics and computer science , but a particularly frutiful line of research concerns the design of efficient algorithms for hard computational problems on specific sparse classes of graphs that occur naturally in applications .",
    "for instance , using low tree - depth colorings , neetil and ossona de mendez  @xcite showed that the and problems are fixed - parameter tractable on any nowhere dense class , parameterized by the size of the pattern graph .",
    "it was later shown by grohe et al .",
    "@xcite that , in fact , every first - order definable problem can be decided in almost linear time on any nowhere dense graph class .",
    "an important and related concept is the notion of a graph class of _ bounded expansion_. precisely , a class of graphs @xmath1 has bounded expansion if for any @xmath19 , the ratio between the numbers of edges and vertices in any @xmath3-shallow minor of a graph from @xmath1 is bounded by a constant depending on @xmath3 only .",
    "obviously , every class of bounded expansion is also nowhere dense , but the converse is not always true",
    ". classes of bounded expansion were also introduced by neetil and ossona de mendez  @xcite , and in this setting even more algorithmic applications are known .",
    "these include database query answering and enumeration @xcite , or approximation and kernelization algorithms for domination problems  @xcite , a topic that we explore in detail next .",
    "[ [ domination - problems . ] ] domination problems .",
    "+ + + + + + + + + + + + + + + + + + + +    in the parameterized problem we are given a graph  @xmath0 and an integer parameter @xmath21 , and the task is to determine the existence of a subset @xmath22 of size at most @xmath21 such that every vertex @xmath23 of @xmath0 is _ dominated _ by @xmath24 , that is , @xmath23 either belongs to @xmath24 or has a neighbor in @xmath24 . more generally , for fixed @xmath19 we can consider the distance-@xmath3 dominating set problem , where we are asked to determine the existence of a subset @xmath22 of size at most @xmath21 such that every vertex @xmath25 is within distance at most  @xmath3 from a vertex from @xmath24 .",
    "the dominating set problem plays a central role in the theory of parameterized complexity , as it is a prime example of a @xmath26$]-complete problem , thus considered intractable in full generality from the parameterized point of view . for this reason , dominating set and distance-@xmath3 dominating set have been extensively studied in restricted graph classes , including the sparse setting .",
    "the study of parameterized algorithms for on sparse and topologically - constrained graph classes has a long history , and , arguably , it played a pivotal role in the development of modern parameterized complexity .",
    "a point of view that was particularly fruitful , and most relevant to our work , is _",
    "recall that a kernelization algorithm is a polynomial - time preprocessing algorithm that transforms a given instance into an equivalent one whose size is bounded by a function of the parameter only , independently of the overall input size .",
    "we are mostly interested in kernelization algorithms whose output guarantees are polynomial in the parameter , or maybe even linear . for on topologically - restricted graph classes , linear kernels were given for planar graphs  @xcite , bounded genus graphs  @xcite , apex - minor - free graphs  @xcite , graphs excluding a fixed minor  @xcite , and graphs excluding a fixed topological minor  @xcite .",
    "all these results relied on applying tools of topological nature , most importantly deep decomposition theorems for graphs excluding a fixed ( topological ) minor .",
    "notably , the research on kernelization for directly led to the introduction of the technique of _ meta - kernelization _",
    "@xcite , which applies to a much larger family of problems on bounded - genus and @xmath8-minor - free graph classes .    the first application of the abstract sparsity theory to domination problems , beyond the topologically - constrained setting , was given by dawar and kreutzer  @xcite , who showed that for every @xmath19 and every nowhere dense class @xmath1 , distance-@xmath3 dominating set is fixed - parameter tractable on @xmath1 .",
    "this result is based on the characterization of nowhere denseness in terms of uniform quasi - wideness .",
    "it is known that nowhere dense classes are the limit for the fixed - parameter tractability of the problem : drange et al .",
    "@xcite showed that whenever @xmath1 is a somewhere dense class closed under taking subgraphs , there is some @xmath19 for which distance-@xmath3 dominating set is @xmath26$]-hard on @xmath1 .",
    "as far as polynomial kernelization is concerned , drange et al .",
    "@xcite gave a linear kernel for distance-@xmath3 dominating set on any graph class of bounded expansion , for every @xmath19 , and an almost linear kernel for dominating set on any nowhere dense graph class ; that is , a kernel of size @xmath27 for some function @xmath6 .",
    "drange et al .",
    "could not extend their techniques to larger domination radii @xmath3 on nowhere dense classes , however , they conjectured that this should be possible . together with the aforementioned negative result",
    ", this would confirm the following dichotomy conjecture for the parameterized complexity of distance-@xmath3 dominating set .",
    "[ con : kernel ] let @xmath1 be a class of graphs closed under taking subgraphs .",
    "if @xmath1 is nowhere dense , then for each @xmath19 , the distance-@xmath3 dominating set problem admits an almost linear kernel on  @xmath1 .",
    "otherwise , if @xmath1 is somewhere dense , then for some @xmath19 , the distance-@xmath3 dominating set problem is @xmath26$]-hard .",
    "an important step towards proving  [ con : kernel ] was made recently by a subset of the authors  @xcite , who gave a polynomial kernel for distance-@xmath3 dominating set on any nowhere dense class @xmath1 .",
    "this result , in fact , follows from the new polynomial bounds on uniform quasi - wideness , proved in  @xcite , in combination with the old approach of dawar and kreutzer  @xcite .",
    "however , the degree of the polynomial bound on the kernel size in  @xcite depends badly on @xmath3 and the class we are working with .    [ [ neighborhood - complexity . ] ] neighborhood complexity .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    one of the crucial ideas in the work of drange et al .",
    "@xcite was to focus on the _ neighborhood complexity _ in sparse graph classes .",
    "more precisely , for an integer @xmath19 , a graph @xmath0 , and a subset @xmath28 of vertices of  @xmath0 , the _",
    "@xmath3-neighborhood complexity _ of  @xmath2 , denoted @xmath29 , is defined as the number of different subsets of @xmath2 that are of the form @xmath30\\cap a$ ] for some vertex @xmath23 of @xmath0 ; here , @xmath31 $ ] denotes the ball of radius @xmath3 around @xmath23 .",
    "that is , @xmath32\\cap a\\ \\colon\\ u\\in v(g)\\}|.\\ ] ] it was proved by reidl et al",
    ".  @xcite that linear neighborhood complexity exactly characterizes subgraph - closed classes of bounded expansion .",
    "more precisely , a subgraph - closed class @xmath1 has bounded expansion if and only if for each @xmath19 there is a constant @xmath33 such that @xmath34 for all graphs @xmath20 and vertex subsets @xmath28 .",
    "they posed as an open problem whether nowhere denseness can be similarly characterized by almost linear neighborhood complexity , thus essentially stating the following conjecture .",
    "[ con : nei ] let @xmath1 be a graph class closed under taking subgraphs .",
    "then @xmath1 is nowhere dense if and only if there exists a function @xmath35 such that @xmath36 for all @xmath19 , @xmath37 , graphs @xmath20 , and vertex subsets @xmath28 .",
    "it is easy to see the right - to - left implication of  [ con : nei ] .",
    "if @xmath1 is somewhere dense and closed under taking subgraphs , then for some @xmath19 it contains the exact @xmath3-subdivision of every graph  @xcite . in this case",
    "it is easy to see that the @xmath3-neighborhood complexity of a vertex subset  @xmath2 can be as large as @xmath38 .",
    "the lack of the left - to - right direction was a major , however not the only , obstacle preventing drange et al .",
    "@xcite from extending their kernelization results to on any nowhere dense class .",
    "the proof of this direction for @xmath39 was given by gajarsk et al .",
    "@xcite , and this result was used by drange et al .",
    "@xcite in their kernelization algorithm for ( with distance @xmath39 ) on nowhere dense graph classes .",
    "[ [ our - results . ] ] our results .",
    "+ + + + + + + + + + + +    in this paper we resolve in affirmative both  [ con : kernel ] and  [ con : nei ] .",
    "let us start with the latter .",
    "[ thm : main - neighborhood - complexity ] let @xmath1 be a graph class closed under taking subgraphs .",
    "then @xmath1 is nowhere dense if and only if there exists a function @xmath35 such that @xmath36 for all @xmath19 , @xmath37 , @xmath20 , and @xmath28 .    to prove the above",
    ", we carefully analyze the argument of reidl et al .",
    "@xcite for linear neighborhood complexity in classes of bounded expansion .",
    "this argument is based on the analysis of vertex orderings certifying the constant upper bound on the _ weak coloring number _ of any graph from a fixed class of bounded expansion . in the nowhere dense setting",
    ", we only have an @xmath40 upper bound on the weak coloring number , and therefore the reasoning breaks whenever one tries to use a bound that is exponential in this number .",
    "we circumvent this issue by applying tools based on model - theoretic properties of nowhere dense classes of graphs .",
    "more precisely , we use the fact that every nowhere dense class is _ stable _ in the sense of shelah , and hence every graph  @xmath8 which is obtained from a graph @xmath0 from a nowhere dense class via a first - order interpretation has bounded vc - dimension  @xcite .",
    "then exponential blow - ups can be reduced to polynomial using the sauer - shelah lemma .",
    "these tools were recently used by a subset of the authors to give polynomial bounds for uniform quasi - wideness  @xcite , a fact that also turns out to be useful in our proof .",
    "we remark that we were informed by micek , ossona de mendez , oum , and wood  @xcite that they have independently resolved  [ con : nei ] by proving the same statement of  [ thm : main - neighborhood - complexity ] , however using different methods .    having the almost linear neighborhood complexity for any nowhere dense class of graphs",
    ", we can revisit the argumentation of drange et al .",
    "@xcite and complete the proof of  [ con : kernel ] by showing the following result .",
    "[ thm : main - kernel ] let @xmath1 be a fixed nowhere dense class of graphs , let @xmath3 be a fixed positive integer , and let @xmath37 be any fixed real . then there is a polynomial - time algorithm that , given a graph @xmath20 and a positive integer @xmath21 , returns a subgraph @xmath41 and a vertex subset @xmath42 with the following properties :    * there is a set @xmath22 of size at most @xmath21",
    "which @xmath3-dominates @xmath0 if and only if there is a set @xmath43 of size at most  @xmath21 which @xmath3-dominates @xmath44 in @xmath45 ; and * @xmath46 , for some function @xmath47 depending only on the class @xmath1 .    just as in drange",
    "@xcite , the obtained triple @xmath48 is formally not an instance of , but of an annotated variant of this problem where some vertices ( precisely @xmath49 ) are not required to be dominated .",
    "this is an annoying formal detail , however it can be addressed as follows . as observed by drange et al .",
    ", such annotated instance can be reduced back to the standard problem in the following way : add two fresh vertices @xmath50 , connect them by a path of length @xmath3 , and connect @xmath51 with each vertex of @xmath49 using a path of length @xmath3 .",
    "then the obtained graph @xmath52 has a dominating set of size at most @xmath53 if and only if @xmath45 admits a set of at most @xmath21 vertices that @xmath3-dominates @xmath44 .",
    "drange et al .",
    "argued that this modification increases edge densities of @xmath54-shallow minors of the graph by at most @xmath55 , for each @xmath56 .",
    "it is straightforward to see that the same modification in the nowhere dense setting may increase the size of the largest clique found as a depth-@xmath54 minor by at most @xmath55 , for each @xmath56 .",
    "thus , the graph @xmath52 obtained in the reduction still belongs to a nowhere dense class @xmath57 , where the sizes of excluded shallow clique minors , at all depths , are one larger than for @xmath1 .",
    "our proof of  [ thm : main - kernel ] revisits the line of reasoning of drange et al .",
    "@xcite for bounded expansion classes , and improves it in several places where the arguments could not be immediately lifted to the nowhere dense setting .",
    "the key ingredient is , of course , the usage of the newly proven almost linear neighborhood complexity for nowhere dense classes ( [ thm : main - neighborhood - complexity ] ) , however , this was not the only piece missing .",
    "another issue was that the algorithm of drange et al .",
    "starts by iteratively applying the constant - factor approximation algorithm for of dvok  @xcite in order to get very strong structural properties of the instance ; in essence , they exploit also a large @xmath58-independent set that dvok s algorithm provides in case of failure . for the argument to work ,",
    "it is crucial that this iteration finishes after a constant number of rounds , as each round introduces a constant multiplicative blow - up of the kernel size .",
    "however , the argument for this is crucially based on the class having bounded expansion , and seems hard to lift to the nowhere dense setting .",
    "we circumvent this problem by removing the whole iterative scheme of drange et al .",
    "@xcite whatsoever , and replacing it with a simple @xmath59-approximation following from the fact that the class we are working with has bounded vc - dimension . as a result",
    ", we do not obtain the large @xmath58-independent set needed by drange et al .  for further stages , but we are able to extract a sufficient substitute for it using the new polynomial bounds for uniform quasi - wideness  @xcite . thus , the whole algorithm is actually conceptually simpler than that of drange et al . , but this comes at the cost of using deeper black - boxes relying on stability theory .    [ [ organization . ] ] organization .",
    "+ + + + + + + + + + + + +    in  [ sec : prelim ] we give the necessary background about nowhere dense classes of graphs , and we introduce key definitions .",
    "[ sec : neighborhood - complexity ] is devoted to the proof of  [ thm : main - neighborhood - complexity ] . in  [ sec : kernel ] we prove  [ thm : main - kernel ] .",
    "[ sec : conclusion ] contains concluding remarks .",
    "[ [ notation . ] ] notation .",
    "+ + + + + + + + +    by @xmath60 we denote the set of non - negative integers . for a set @xmath2 , by @xmath61",
    "we denote the family of all subsets of @xmath2 . for an equivalence relation @xmath62 , by @xmath63",
    "we denote the number of equivalence classes of @xmath62 .",
    "we use standard graph notation ; see e.g.  @xcite for reference .",
    "all graphs considered in this paper are finite , simple , and undirected . for a graph @xmath0 , by @xmath64 and @xmath65",
    "we denote the vertex and edge sets of @xmath0 , respectively .",
    "a graph  @xmath8 is a _ subgraph _ of  @xmath0 , denoted @xmath66 , if @xmath67 and @xmath68 .",
    "a class of graphs @xmath1 is _ monotone _ if for every @xmath20 and every subgraph @xmath66 , we also have @xmath69 .",
    "for any @xmath70 , by @xmath71 $ ] we denote the subgraph induced by  @xmath72 .",
    "we write @xmath73 for the graph @xmath74 $ ] and if @xmath75 , we write @xmath76 instead .    for a non - negative integer @xmath77 ,",
    "a _ path of length @xmath77 _ in  @xmath0 is a sequence @xmath78 of pairwise distinct vertices such that @xmath79 for all @xmath80 .",
    "we write @xmath81 for the vertex set @xmath82 of  @xmath83 and @xmath84 for the edge set @xmath85 of  @xmath83 and identify  @xmath83 with the subgraph of @xmath0 with vertex set @xmath81 and edge set @xmath84 .",
    "we say that the path  @xmath83 _ connects _ its _ endpoints _ @xmath86 , whereas @xmath87 are the _ internal vertices _ of @xmath83 .",
    "two vertices @xmath88 are _ connected _ if there is a path in @xmath0 with endpoints @xmath89 .",
    "the _ distance _ @xmath90 between two connected vertices @xmath89 is the minimum length of a path connecting @xmath23 and @xmath91 ; if @xmath89 are not connected , we put @xmath92 .",
    "the _ radius _ of  @xmath0 is @xmath93 .",
    "a graph @xmath0 is @xmath94-_degenerate _ if every subgraph @xmath66 has a vertex of degree at most @xmath94 . for a positive integer  @xmath95 , we write @xmath96 for the complete graph on @xmath95 vertices .    for a vertex @xmath91 in graph @xmath0 , the set of all neighbors of a vertex @xmath91 in @xmath0",
    "is denoted by @xmath97 , and the set of all vertices at distance at most @xmath3 from @xmath91 ( including @xmath91 ) is denoted by @xmath98 $ ] .",
    "we may omit the superscript if the graph is clear from the context .",
    "the _ @xmath3-neighborhood complexity _ of a subset @xmath28 in @xmath0 is defined as @xmath99\\cap a \\colon v\\in v(g)\\}|.\\ ] ]    [ [ nowhere - dense - classes - of - graphs . ] ] nowhere dense classes of graphs .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath0 be a graph and let @xmath19 .",
    "a graph @xmath8 with vertex set @xmath100 is a _",
    "depth-@xmath3 minor _ of  @xmath0 , written @xmath101 , if there are connected and pairwise vertex disjoint subgraphs @xmath102 , each of radius at most @xmath3 , such that if @xmath103 , then there are @xmath104 and @xmath105 such that @xmath106 .",
    "a class @xmath1 of graphs is _ nowhere dense _ if there exists a function @xmath107 such that @xmath18 for all @xmath108 and for all @xmath20 .",
    "nowhere denseness admits several equivalent definitions , see  @xcite for a wider discussion .",
    "we next recall those that will be used in this paper .",
    "[ [ edge - density - of - shallow - minors . ] ] edge density of shallow minors .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for a graph @xmath8 , the _ edge density _ of @xmath8 is the ratio @xmath109 .",
    "the _ grad _ , or _ greatest reduced average density _ , of a graph @xmath0 at depth @xmath19 , is defined as : @xmath110 for a class of graphs @xmath1 , let @xmath111 .",
    "classes of bounded expansion are exactly those , for which @xmath112 is finite for each @xmath3 . in nowhere dense classes",
    "the edge density of shallow minors is not necessarily bounded by a constant , but it is small , as explained in the next result .",
    "[ lem : gradbound ] let @xmath1 be a nowhere dense class of graphs .",
    "there is a function @xmath113 such that for every @xmath19 , @xmath37 , graph @xmath20 , and its @xmath3-shallow minor @xmath101 , it holds that @xmath114 .",
    "[ [ weak - coloring - mumbers . ] ] weak coloring mumbers .",
    "+ + + + + + + + + + + + + + + + + + + + + +    for a graph @xmath0 , by @xmath115 we denote the set of all linear orders of @xmath64 . for @xmath116 , we write @xmath117 if @xmath23 is smaller than @xmath91 in @xmath118 , and @xmath119 if @xmath117 or @xmath120 . for @xmath88 and any @xmath121 , we say that  @xmath23 is _",
    "weakly @xmath3-reachable _ from  @xmath91 with respect to  @xmath118 , if there is a path @xmath83 of length at most @xmath3 connecting @xmath23 and @xmath91 such that @xmath23 is the smallest among the vertices of @xmath83 with respect to  @xmath118 . by @xmath122",
    "$ ] we denote the set of vertices that are weakly @xmath3-reachable from  @xmath91 with respect to  @xmath118 . for any subset @xmath28 , we let @xmath123 = \\bigcup_{v\\in a } { \\mathrm{wreach}}_r[g , l , v]$ ] .",
    "the _ weak @xmath3-coloring number @xmath124 _ of @xmath0 is defined as follows : @xmath125\\bigr|.\\\\\\end{aligned}\\ ] ] the weak coloring numbers were introduced by kierstead and yang  @xcite in the context of coloring and marking games on graphs . as proved by zhu @xcite , they can be used to characterize both bounded expansion and nowhere dense classes of graphs . in particular , we use the following .",
    "[ lem : wcolbound ] let @xmath1 be a nowhere dense class of graphs .",
    "there is a function @xmath126 such that @xmath127 for every @xmath108 , @xmath37 and @xmath128 .",
    "the generalized coloring numbers play a key role for dvok s approximation algorithm for @xmath3-dominating sets  @xcite and also in the result on neighborhood complexity by  @xcite .",
    "new bounds for these numbers on restricted graph classes can be found in  @xcite .",
    "[ [ quasi - wideness . ] ] quasi - wideness .",
    "+ + + + + + + + + + + + + + +    a set @xmath129 is called _",
    "@xmath3-independent _ in @xmath0 if for all distinct @xmath130 we have @xmath131 .",
    "a class @xmath1 of graphs is _ uniformly quasi - wide _ if there are functions @xmath132 and @xmath133 such that for all @xmath134 and all subsets @xmath28 for @xmath20 of size @xmath135 there is a set @xmath136 of size @xmath137 and a set @xmath138 of size @xmath139 which is @xmath3-independent in @xmath140 . the functions @xmath141 and @xmath142 are called the _ margins _ of the class  @xmath1 .",
    "it was shown by neeil and ossona de mendez  @xcite that a monotone class @xmath1 of graphs is nowhere dense if and only if it is uniformly quasi - wide . in particular , every nowhere dense class is uniformly quasi - wide , even without the assumption of monotonicity .",
    "for us it will be important that the margins @xmath141 and @xmath142 can be assumed to be polynomial in  @xmath3 and that the sets @xmath143 and @xmath144 can be efficiently computed .",
    "this was proved only recently by kreutzer et al .",
    "@xcite .",
    "[ thm : uqw ] let @xmath1 be a nowhere dense class of graphs . for every @xmath19 there exist constants  @xmath145 and @xmath146 such that for all @xmath147 , all @xmath148 and all sets @xmath28 of size at least  @xmath149 , there is a set @xmath136 of size at most @xmath146 such that there is a set @xmath138 of size at least  @xmath150 which is @xmath3-independent in @xmath140 .",
    "furthermore , if @xmath151 for all @xmath20 , then @xmath152 and there is an algorithm , that given an @xmath153-vertex graph @xmath20 , @xmath19 , and @xmath28 of size at least @xmath149 , computes a set @xmath144 of size at most @xmath146 and an @xmath3-independent set @xmath138 in @xmath140 of size at least @xmath150 in time @xmath154 , where @xmath155 .",
    "the running time of the algorithm of  [ thm : uqw ] is stated in  @xcite only as @xmath156 . however , it is easy to see that the algorithm actually runs in time as stated above .",
    "the algorithm computes  @xmath3 times the truth value of @xmath94 first - order formulas of the form @xmath157 , with @xmath94 free variables ranging over the parameter set  @xmath2 .",
    "that is , it decides for each tuple @xmath158 whether the formula @xmath159 is true in the graph .",
    "each considered formula has quantifier rank one , so by brute - force we can check all evaluations of the quantifier and we have to access the adjacency list of each inspected vertex , giving a multiplicative factor @xmath160 in the running time .",
    "a more careful analysis is certainly possible ; however , we refrain from performing it as it is not crucial for the goals of this study .    [ [ vc - dimension . ] ] vc - dimension .",
    "+ + + + + + + + + + + + +    let @xmath161 be a family of subsets of a set @xmath2 .",
    "for a set @xmath162 , we denote @xmath163 .",
    "the set @xmath164 is _ shattered by @xmath165 _ if @xmath166 .",
    "the _ vapnik - chervonenkis dimension _",
    ", short _ vc - dimension _ , of @xmath165 is the maximum size of a set @xmath164 that is shattered by @xmath165 .",
    "note that if @xmath164 is shattered by @xmath165 , then also every subset of @xmath164 is shattered by  @xmath165 .",
    "the following theorem was first proved by vapnik and chervonenkis  @xcite , and rediscovered by sauer  @xcite and shelah  @xcite .",
    "it is often called the sauer - shelah lemma in the literature .",
    "[ thm : sauer_shelah ] if @xmath167 and @xmath161 has vc - dimension @xmath54 , then @xmath168    note that in the interesting cases @xmath169 it holds that @xmath170 , and in general it holds that @xmath171 .    for a graph @xmath0 , the vc - dimension of @xmath0 is defined as the vc - dimension of the set family @xmath172\\colon v\\in v(g)\\}$ ] over the set @xmath64 .",
    "[ [ vc - dimension - and - nowhere - denseness . ] ] vc - dimension and nowhere denseness .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    adler and adler  @xcite have proved that any nowhere dense class @xmath1 of graphs is _",
    "stable _ , which in particular implies that any class of structures obtained from @xmath1 by means of a first - order interpretation has vc - dimension bounded by a constant depending only on @xmath1 and the interpretation .",
    "in particular , the following is an immediate corollary of the results of adler and adler  @xcite .",
    "[ thm : adler ] let @xmath1 be a nowhere dense class of graphs and let @xmath173 be a first - order formula over the signature of graphs , such that for all @xmath174 and @xmath175 it holds that @xmath176 if and only if @xmath177 . for @xmath20 , let @xmath178 be the graph with vertex set @xmath179 and edge set @xmath180 .",
    "then there is an integer @xmath94 depending only on @xmath1 and @xmath181 such that @xmath178 has vc - dimension at most @xmath94 .    by applying [ thm : adler ] to first - order formulas expressing the properties @xmath182 and @xmath183",
    ", we immediately obtain the following .",
    "[ thm : adleradler ]",
    "let @xmath1 be a nowhere dense class of graphs and let @xmath108 .",
    "for @xmath20 , let @xmath184 be the graph with the same vertex set as @xmath0 and an edge @xmath185 if and only if @xmath186 .",
    "define the graph @xmath187 in the same manner , but putting an edge @xmath11 into @xmath188 if and only if @xmath189 .",
    "then there is an integer @xmath190 such that both @xmath184 and @xmath187 have vc - dimension at most  @xmath190 for every @xmath20 .    by combining [ thm :",
    "adleradler ] with the sauer - shelah lemma ( [ thm : sauer_shelah ] ) we infer the following .    [ lem : numberofneighborhoods ] let @xmath1 be a nowhere dense class of graphs and let @xmath19 .",
    "then @xmath191 for every graph @xmath20 and @xmath28 with @xmath192 , where @xmath190 is the constant given by  [ thm : adleradler ] .",
    "thus , a polynomial bound on the neighborhood complexity for any nowhere dense class , and , in fact , for any stable class , already follows from known tools .",
    "our goal in the next section will be to show that with the assumption of nowhere denseness we can prove an almost linear bound , as described in [ thm : main - neighborhood - complexity ] .",
    "[ [ distance - profiles . ] ] distance profiles .",
    "+ + + + + + + + + + + + + + + + + +    in our reasoning we will need a somewhat finer view of the neighborhood complexity . more precisely , we would like to partition the vertices of the graph not only with respect to their @xmath3-neighborhood in a fixed set @xmath2 , but also with respect to what are the exact distances of the elements of this @xmath3-neighborhood from the considered vertex . with this intuition in mind ,",
    "we introduce the notion of a _ distance profile_.    let @xmath0 be a graph and let @xmath28 be a subset of its vertices .",
    "for a vertex @xmath25 , the _ @xmath3-distance profile _ of @xmath23 , denoted @xmath193 $ ] , is a function mapping vertices of @xmath2 to @xmath194 defined as follows : @xmath195(v)=\\begin{cases}{\\mathrm{dist}}_g(u , v ) & \\quad \\textrm{if } { \\mathrm{dist}}_g(u , v)\\leq r,\\\\ \\infty & \\quad \\textrm{otherwise.}\\end{cases}\\ ] ] we say that a function @xmath196 is _ realized as an @xmath3-distance profile on @xmath2 _ if there is @xmath25 such that @xmath197 $ ] .",
    "we may drop the superscript if the graph is clear from the context .    similarly to the neighborhood complexity , we define the _ distance profile complexity _ of a vertex subset @xmath28 in a graph @xmath0 , denoted @xmath198 , as the number of different functions realized as @xmath3-distance profiles on @xmath2 in @xmath0 .",
    "clearly it always holds that @xmath199 , thus  [ thm : main - neighborhood - complexity ] will follow directly from the following result , which will be proved in the next section .",
    "[ thm : main - profiles ] let @xmath1 be a nowhere dense class of graphs .",
    "then there is a function @xmath35 such that for every @xmath19 , @xmath37 , graph @xmath20 , and vertex subset @xmath28 , it holds that @xmath200 .",
    "let us observe that the polynomial bound of [ lem : numberofneighborhoods ] carries over to distance profiles .",
    "[ crl : number - of - profiles ] let @xmath1 be a nowhere dense class of graphs .",
    "then there is an integer @xmath201 such that for every @xmath19 , @xmath37 , graph @xmath20 , and vertex subset @xmath28 with @xmath192 , it holds that @xmath202 .",
    "observe that for any vertex @xmath25 , the @xmath3-distance profile @xmath193 $ ] is uniquely determined by the tuple @xmath203\\cap a , n^g_1[u]\\cap a,\\ldots , n^g_{r-1}[u]\\cap a , n^g_r[u]\\cap a).\\ ] ] this is because for any @xmath204 , the value @xmath193[v]$ ] is equal to the smallest integer @xmath205 such that @xmath206 , or @xmath207 if no such integer exists . by  [ lem : numberofneighborhoods ]",
    ", we have @xmath208 possibilities for the @xmath209-th entry of this tuple , hence we can set @xmath210 .",
    "reidl et al .",
    "@xcite gave a linear bound on the neighborhood complexity for all subsets of vertices of graphs from a class of bounded expansion ; see theorem 3 in  @xcite .",
    "more precisely , they show that for every graph @xmath0 and every @xmath28 , it holds that @xmath211 note that if @xmath0 belongs to some fixed class @xmath1 of bounded expansion , then @xmath212 is bounded by a constant depending only on the class @xmath1 and @xmath3 .",
    "however , assuming only that @xmath1 is nowhere dense , by [ lem : wcolbound ] we have that for all @xmath213 and @xmath37 the number @xmath212 is bounded only by @xmath214 , which is not a constant . in particular , since @xmath212 appears in the exponent of the bound of reidl et al . , we do not obtain even a polynomial upper bound .",
    "in this section we prove  [ thm : main - profiles ] , which directly implies  [ thm : main - neighborhood - complexity ] , as explained in the previous section .",
    "our approach is to carefully analyze the proof of reidl et al .",
    "@xcite , and to fix parts that break down in the nowhere dense setting using tools derived , essentially , from the stability of nowhere dense classes .",
    "we first prove the following auxiliary lemma .",
    "we believe it may be of independent interest , as it seems very useful for the analysis of weak coloring numbers in the nowhere dense setting .",
    "[ lem : bd - vcdimension ] let @xmath1 be a nowhere dense class of graphs and let @xmath174 .",
    "for @xmath215 and a linear order @xmath216 , let @xmath217\\ \\colon\\ v \\in v(g ) \\}.\\ ] ] then there is a constant @xmath218 , depending only on @xmath1 and @xmath3 ( and not on @xmath0 and @xmath118 ) , such that @xmath219 has vc - dimension at most @xmath218 .    since @xmath1 is nowhere dense , according to  [ lem : wcolbound ] , it is uniformly quasi - wide , say with margins @xmath141 and @xmath142 .",
    "we fix a number @xmath150 to be determined later , depending only on @xmath3 and @xmath1 .",
    "let @xmath220 and @xmath221 .",
    "assume towards a contradiction that there is a set @xmath222 of size @xmath223 which is shattered by @xmath219 .",
    "fix sets @xmath224 and @xmath225 such that @xmath226 , @xmath227 , and @xmath143 is @xmath58-independent in @xmath228 .",
    "we will treat @xmath118 also as a linear order on the vertex set of @xmath140 .    as a subset of @xmath2 , the set @xmath143 is also shattered by @xmath219 .",
    "that is , for every @xmath229 there is a vertex @xmath230 such that @xmath231 \\cap b$ ] .",
    "note that since @xmath143 is @xmath58-independent in @xmath228 , so is @xmath164 , and we have @xmath232 \\cap b| \\leq 1.\\ ] ]    for a vertex @xmath233 , number @xmath234 , and vertex @xmath235 , let us consider the set @xmath236 of all paths of length ( exactly ) @xmath237 that connect @xmath238 and @xmath91 .",
    "we define @xmath239 to be the largest ( with respect to @xmath118 ) vertex @xmath240 , for which there exists a path @xmath241 such that every vertex on @xmath83 is strictly larger than @xmath242 with respect to @xmath118 . if no such vertex in @xmath143 exists , we put @xmath243 .",
    "the _ signature _ of a vertex @xmath244 is defined as @xmath245 it now follows that the number of possible signatures is small .    [ cl : num - signatures ] the set @xmath246 has size at most @xmath247 .    for each @xmath248 and @xmath249 , there are @xmath250 possible values for @xmath239 , while the number of relevant pairs @xmath251 is at most @xmath252 .",
    "the next claim intuitively shows that for a vertex @xmath91 , the signature of @xmath91 plus the set of vertices of @xmath143 weakly reachable from @xmath91 in @xmath140 provides enough information to deduce precisely the set of vertices of @xmath143 weakly reachable from @xmath91 in @xmath0 .",
    "[ cl : signatures - enough ] suppose @xmath253 are such that @xmath254\\cap b = { \\mathrm{wreach}}_r[g - s , l , w]\\cap b.\\ ] ] then @xmath122\\cap b = { \\mathrm{wreach}}_r[g , l , w]\\cap b$ ] .    by symmetry it suffices to show that for any @xmath255 , if @xmath256 $ ] , then @xmath257 $ ] . for every such @xmath242 , there is a path @xmath83 of length a most @xmath3 that connects @xmath91 and @xmath242 , on which , moreover , @xmath242 is the @xmath118-minimal vertex .",
    "if this path avoids @xmath144 , then @xmath258 = { \\mathrm{wreach}}_r[g - s , l , w]\\subseteq { \\mathrm{wreach}}_r[g , l , w],\\ ] ] and we are done .",
    "otherwise , let @xmath238 be the first vertex in @xmath144 on @xmath83 ( i.e. , the closest to @xmath91 ) ; obviously @xmath259 , since @xmath260 .",
    "let @xmath238 be the @xmath237-th vertex on @xmath83 ( starting from @xmath91 ) , where we have @xmath261 .",
    "let @xmath262 be the prefix of @xmath83 from @xmath91 to @xmath238 , and @xmath263 be the suffix of @xmath83 from @xmath238 to  @xmath242 . since @xmath242 is the @xmath118-minimal vertex on @xmath83 , and @xmath259 , all vertices on @xmath262 are greater than @xmath242 with respect to @xmath118",
    ". therefore @xmath264 and @xmath265 .",
    "since @xmath266 , we have that @xmath267 .",
    "consequently , there is a path @xmath268 of length @xmath237 connecting @xmath51 and @xmath238 such that all vertices of @xmath268 are greater than @xmath242 with respect to @xmath118 . by concatenating @xmath268 and @xmath263",
    "we obtain a path of length at most @xmath3 connecting @xmath51 and @xmath242 , such that @xmath242 is the @xmath118-minimal vertex on this path .",
    "this implies that @xmath257 $ ] .    by  [ cl : num - signatures ]",
    "there are at most @xmath247 possible signatures , while we argued that the intersection @xmath269\\cap b$ ] is always of size at most @xmath55 , hence there are at most @xmath270 possibilities for it .",
    "thus , by  [ cl : signatures - enough ] we conclude that only at most @xmath271 subsets of  @xmath143 are realized as @xmath272 for some @xmath273 . to obtain a contradiction with @xmath143 being shattered by @xmath219 , it suffices to select @xmath150 so that @xmath274 since @xmath275 is a constant depending on @xmath1 and  @xmath3 only , we may choose @xmath150 depending on @xmath1 and  @xmath3 so that the above inequality holds .    with  [ lem : bd - vcdimension ] in hand , we now are ready to prove  [ thm : main - profiles ] .",
    "let @xmath1 be a nowhere dense class of graphs .",
    "then there is a function @xmath35 such that for every @xmath19 , @xmath37 , graph @xmath20 , and vertex subset @xmath28 , it holds that @xmath200 .",
    "fix @xmath213 and @xmath37 . in the proof",
    "we will use small constants @xmath276 , which will be determined in the course of the proof . if @xmath277 , then the number of different @xmath3-distance profiles on @xmath2 is at most @xmath278 , which is bounded by a function of @xmath3 only .",
    "hence , throughout the proof we can assume without loss of generality that @xmath279 , in particular @xmath192 .",
    "the first step is to reduce the problem to the case when the size of the graph is bounded polynomially in @xmath280 . according to  [ crl : number - of - profiles ] , there is an integer @xmath201 such that there are at most @xmath281 different @xmath3-distance profiles on @xmath2 . we therefore classify the elements of @xmath64 according to their @xmath3-distance profiles on @xmath2 , that is , let define an equivalence relation @xmath282 on @xmath64 as follows : @xmath283 = \\pi^g_r[w , a].\\ ] ] construct a set @xmath284 by taking @xmath2 and , for each equivalence class @xmath285 of @xmath282 , adding an arbitrary element @xmath286 to @xmath284 . then , construct a set @xmath287 by starting with @xmath284 , and , for each distinct @xmath288 , performing the following operation : if @xmath189 , then add the vertex set of any shortest path between @xmath23 and @xmath91 to @xmath287 .",
    "finally , let @xmath289 $ ] .",
    "[ cl : size - gp ] the following holds : @xmath290 .    by  [ crl : number - of - profiles ] , the equivalence relation @xmath282 has at most @xmath281 equivalence classes , hence @xmath291 .",
    "when constructing @xmath292 we consider at most @xmath293 pairs of vertices from @xmath2 , and for each of them we add at most @xmath294 vertices to @xmath287 .",
    "it follows that @xmath295    [ cl : preserve - gp ] the following holds : @xmath296 .",
    "observe that for any @xmath297 , if @xmath189 , then @xmath298 ; this follows immediately from the inclusion of shortest paths in the construction of @xmath287 .",
    "therefore , we infer that for each equivalence class @xmath285 of @xmath282 , the @xmath3-distance profile of @xmath299 on @xmath2 in @xmath45 is the same as in @xmath0 , because @xmath300 and @xmath301 .",
    "it follows that every @xmath3-distance profile on @xmath2 that is realized in @xmath0 is also realized in @xmath45 .",
    "intuitively ,  [ cl : preserve - gp ] shows that we can restrict our attention to graph @xmath45 instead of @xmath0 , since by doing this we do not lose any @xmath3-distance profiles realized on @xmath2 .",
    "the gain from this step is that the size of @xmath45 is bounded polynomially in terms of @xmath280 ( [ cl : size - gp ] ) , hence we can use better bounds on the weak coloring numbers , as explained next .",
    "according to  [ lem : wcolbound ] , there is a function @xmath302 such that @xmath303 where @xmath304 .",
    "let @xmath118 be a linear order of @xmath305 witnessing @xmath306 ; that is , for each @xmath307 we have @xmath308|\\leq { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)\\cdot|a|^{{\\varepsilon}_3}$ ] . for each @xmath307 , let us define the following set : @xmath309 = { \\mathrm{wreach}}_r[g ' , l , v ] \\cap { \\mathrm{wreach}}_r[g',l , a].\\ ] ] in other words , @xmath310 $ ] comprises all vertices that are weakly @xmath3-reachable both from @xmath91 and from some vertex of @xmath2 . since @xmath310\\subseteq { \\mathrm{wreach}}_r[g ' , l , v]$ ] for each @xmath307",
    ", we have @xmath311| \\leq |{\\mathrm{wreach}}_r[g ' , l , v]|\\leq { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)\\cdot |a|^{{\\varepsilon}_3}.\\ ] ] furthermore , as for each @xmath307 we have @xmath310\\subseteq { \\mathrm{wreach}}_r[g , l , a ] = \\bigcup_{w\\in        a}{\\mathrm{wreach}}_r[g , l , w]$ ] , @xmath312\\big| \\leq   |a|\\cdot \\max_{w\\in v(g ' ) } |{\\mathrm{wreach}}_r[g , l , w]| \\leq      { f_{{\\mathrm{wcol}}}}(2r,\\varepsilon_4)\\cdot|a|^{1+\\varepsilon_3}.\\ ] ]    we now classify the vertices @xmath307 according to their distance profiles @xmath313 $ ] .",
    "more precisely , let @xmath62 be the equivalence relation on @xmath305 defined as follows : @xmath314 = y[w]\\textrm { and } \\pi^{g'}_r[v , y[v]]=\\pi^{g'}_r[w , y[w]].\\ ] ] we next show that the equivalence relation @xmath62 refines the standard partitioning according to @xmath3-distance profiles on @xmath2 .",
    "[ cl : equiv - refines ] for every @xmath253 , if @xmath315 , then @xmath316=\\pi^{g'}_r[w , a]$ ] .    by symmetry ,",
    "to show that @xmath316=\\pi^{g'}_r[w , a]$ ] it suffices to prove that for each @xmath317 , if @xmath318 , then @xmath319 .",
    "let @xmath83 be a shortest path from @xmath91 to @xmath223 in @xmath45 , say of length @xmath320 .",
    "let @xmath321 be the smallest vertex on @xmath83 with respect to @xmath118 .",
    "then @xmath83 certifies that @xmath321 is both weakly @xmath3-reachable from @xmath91 and from @xmath317 , hence @xmath322 $ ] .",
    "since @xmath310=y[w]$ ] and @xmath323=\\pi^{g'}_r[w , y[w]]$ ] by assumption , and the prefix of @xmath83 from @xmath91 to @xmath321 certifies that @xmath324 , we have that @xmath325 .",
    "since @xmath83 was a shortest path , also the prefix of @xmath83 from @xmath91 to @xmath321 is a shortest path between @xmath91 and @xmath321 , and the suffix of @xmath83 from @xmath321 to @xmath223 is a shortest path between @xmath321 and @xmath223 .",
    "concluding , @xmath326    [ cl : equiv - refines ] suggests the following approach to bounding @xmath327 : first give an upper bound on the number of possible sets of the form @xmath310 $ ] , and then for each such set , bound the number of @xmath3-distance profiles on it .",
    "we deal with the second part first , as it essentially follows from  [ crl : number - of - profiles ] .",
    "let us set @xmath328 , where @xmath201 is the constant given by  [ crl : number - of - profiles ] .",
    "[ cl : prof - on - one ] there is a function @xmath329 such that for each @xmath235 , we have @xmath330)\\leq g(r,{\\varepsilon}_4)\\cdot |a|^{{\\varepsilon}_2}$ ] .",
    "fix some @xmath331 $ ] for @xmath235 .",
    "if @xmath332 , then there are obviously at most @xmath333 distance profiles on @xmath44 .",
    "otherwise , according to  [ crl : number - of - profiles ] , there is a constant @xmath201 such that @xmath334 . since @xmath335|\\leq { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)\\cdot |a|^{{\\varepsilon}_3}$ ]",
    ", we obtain that the total number of profiles on @xmath44 is bounded by @xmath336 hence we can take @xmath337 .    it remains to give an upper bound on the number of distinct sets @xmath310 $ ] .",
    "let us set @xmath338 , where @xmath218 is the constant given by  [ lem : bd - vcdimension ] .",
    "[ cl : num - y ] the following holds : @xmath339 \\colon v\\in v(g ' ) \\ } \\right|\\leq 1 + 2\\cdot { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)^{x(r)+1 } \\cdot |a|^{1+{\\varepsilon}_1+{\\varepsilon}_3}.$ ]    let @xmath340 \\colon v\\in v(g')\\}\\setminus \\{\\emptyset\\}$ ] be the family of all non - empty sets of the form @xmath310 $ ] for @xmath307 ; it suffices to show that @xmath341 .",
    "define mapping @xmath342 as follows : for @xmath343 , @xmath344 is the largest element of @xmath44 with respect to @xmath118 .",
    "take any @xmath307 with @xmath310\\neq \\emptyset$ ] , and recall that every vertex in @xmath310 $ ] is weakly @xmath3-reachable from @xmath91 .",
    "observe that every vertex @xmath345 $ ] is weakly @xmath58-reachable from @xmath346)$ ] .",
    "to see this , concatenate the two paths of length at most @xmath3 that certify that @xmath347 $ ] and @xmath346)\\in { \\mathrm{wreach}}_r[g',l , v]$ ] , and note that this path of length at most @xmath58 certifies that @xmath348)]$ ] . consequently , for every @xmath349 , we have @xmath350.\\ ] ] this implies that the union of all sets of @xmath351 that choose the same @xmath321 via @xmath352 has size at most @xmath353 .",
    "fix any @xmath349 and denote @xmath354 let us count how many distinct subsets of @xmath355 belong to @xmath351 .",
    "every such @xmath331 $ ] , as a subset of @xmath355 , satisfies @xmath310\\cap s_y = y[v ] = { \\mathrm{wreach}}_r[g'l , v ] \\cap { \\mathrm{wreach}}_r[g',l , a]$ ] . as for all @xmath91 the set @xmath356 $ ]",
    "is the same , this means that the number of different @xmath310\\in { \\mathcal{y}}$ ] that are mapped to a fixed @xmath321 is not larger than the number of different sets @xmath357\\cap s_y$ ] , for @xmath307 .    by lemma  [ lem : bd - vcdimension ]",
    ", the set @xmath358 { \\colon } v \\in v(g ' ) \\}$ ] has vc - dimension at most @xmath218 , and so has the subfamily @xmath359 { \\colon } v \\in v(g')\\}$ ] .",
    "hence , by the sauer - shelah lemma ( [ thm : sauer_shelah ] ) , we infer that @xmath360 \\colon v\\in v(g')\\}|\\leq 2\\cdot |s_y|^{x(r)}.\\ ] ] finally , we observe that @xmath361 and recall that @xmath362 , hence @xmath363 \\colon v\\in v(g')\\}| \\\\    & \\leq & 2\\cdot \\sum_{y\\in \\gamma({\\mathcal{y } } ) } |s_y|^{x(r ) } \\leq 2\\cdot |\\gamma({\\mathcal{y}})|\\cdot ( { \\mathrm{wcol}}_{2r}(g'))^{x(r ) } \\\\           & \\leq & 2\\cdot |\\bigcup { \\mathcal{y}}|\\cdot ( { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)\\cdot |a|^{{\\varepsilon}_3})^{x(r ) } \\leq   2\\cdot { f_{{\\mathrm{wcol}}}}(2r,\\varepsilon_4)\\cdot|a|^{1+{\\varepsilon}_3}\\cdot { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)^{x(r)+1}\\cdot |a|^{{\\varepsilon}_1}\\\\           & = & 2\\cdot { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)^{x(r)+1}\\cdot |a|^{1+\\varepsilon_1+{\\varepsilon}_3}.    \\end{aligned}\\ ] ]    by combining  [ cl : preserve - gp ] ,  [ cl : equiv - refines ] ,  [ cl : prof - on - one ] , and  [ cl : num - y ] , we conclude that @xmath364 { ~:~}v\\in v(g ' ) \\ } \\right|\\cdot g(r,{\\varepsilon}_4)\\cdot |a|^{{\\varepsilon}_2}\\\\      & \\leq & ( 1 + 2\\cdot { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)^{x(r)+1 } \\cdot |a|^{1+{\\varepsilon}_1+{\\varepsilon}_3})\\cdot g(r,{\\varepsilon}_4)\\cdot",
    "|a|^{{\\varepsilon}_2}\\\\      & \\leq & 3\\cdot { f_{{\\mathrm{wcol}}}}(2r,{\\varepsilon}_4)^{x(r)+1}\\cdot g(r,{\\varepsilon}_4)\\cdot |a|^{1+{\\varepsilon}_1+{\\varepsilon}_2+{\\varepsilon}_3}.    \\end{aligned}\\ ] ] thus , if we fix @xmath365 so that @xmath366 , then we can set @xmath367 .",
    "in this section we use the neighborhoods complexity tools to prove  [ thm : main - kernel ] .",
    "our proof will rely on the approach of drange et al .",
    "@xcite , and therefore we need to first explain some tools borrowed from there , in particular we recall the notion of @xmath3-projection and introduce @xmath3-projection profiles . throughout the section we fix a nowhere dense class @xmath1 .",
    "whenever we say that the running time of some algorithm on a graph @xmath0 is _ polynomial _ , we mean that it is of the form @xmath368 , where @xmath369 is a universal constant that is independent of @xmath1 , @xmath3 , @xmath5 , or any other constants defined in the context .",
    "however , the constants hidden in the @xmath370-notation may depend on @xmath1 , @xmath3 , and @xmath5 .",
    "[ [ projections - and - projection - profiles . ] ] projections and projection profiles .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath20 be a graph and let @xmath28 be a subset of vertices .",
    "for vertices @xmath204 and @xmath371 , a path @xmath83 connecting @xmath23 and @xmath91 is called _ @xmath2-avoiding _ if all its vertices apart from @xmath91 do not belong to @xmath2 . for a positive integer @xmath3 , the _",
    "@xmath3-projection _ of any @xmath371 on @xmath2 , denoted @xmath372 is the set of all vertices @xmath204 that can be connected to @xmath23 by an @xmath2-avoiding path of length at most @xmath3 .",
    "the _ @xmath3-projection profile _ of a vertex @xmath371 on @xmath2 is a function @xmath373 $ ] mapping vertices of @xmath2 to @xmath194 , defined as follows : for every @xmath204 , the value @xmath373(v)$ ] is the length of a shortest @xmath2-avoiding path connecting @xmath23 and  @xmath91 , and  @xmath207 in case this length is larger than @xmath3 .",
    "similarly as for @xmath3-neighborhoods and @xmath3-distance profiles , we define @xmath374\\colon u\\in v(g)\\setminus a\\}|\\ ] ] to be the number of different @xmath3-projections and @xmath3-projection profiles realized on @xmath2 , respectively . clearly , again it always holds that @xmath375 .    in their kernelization algorithm , drange et al .",
    "@xcite use a linear bound on the number of different @xmath3-projections in any graph class of bounded expansion .",
    "we now verify that , in the nowhere dense setting the near - linear bound on the number of different @xmath3-distance profiles can be used also to give a near - linear bound the number of different @xmath3-projection profiles . the proof is based on the idea of creating a `` layered '' graph , which was also used by drange et al .",
    "@xcite .",
    "[ lem : projection - complexity ] suppose @xmath1 is a nowhere dense class of graphs .",
    "then there is a function @xmath376 such that for every @xmath19 , @xmath37 , graph @xmath20 , and vertex subset @xmath28 , it holds that @xmath377 .    for a graph @xmath0 and a positive integer @xmath94 , the _ @xmath94-blowup of @xmath0 _ , denoted @xmath378 ,",
    "is defined as follows - blowup is a special case of a more general operation called _ lexicographic product _ , but we will not use this operation here . ] .",
    "the vertex set of @xmath378 consists of pairs of the form @xmath379 , where @xmath25 and @xmath380 ; vertex @xmath379 is called the _",
    "@xmath209-th _ copy of @xmath23 .",
    "the copies of every vertex @xmath25 are made into a clique , i.e. , there is an edge @xmath381 for all @xmath25 and @xmath382 .",
    "moreover , whenever there is an edge @xmath383 , then we make every copy of @xmath23 adjacent to every copy of  @xmath91 , i.e. , we put an edge @xmath384 for all @xmath385 .    for a class @xmath1 , by @xmath386",
    "we denote the closure under subgraphs of the class @xmath387 .",
    "it is well - known that if @xmath1 is nowhere dense , then for any fixed positive integer @xmath94 , the class @xmath386 is also nowhere dense ; see e.g.  chapter 4.7 of  @xcite , or , simply observe that if @xmath1 is uniformly quasi - wide , say with margins @xmath142 and @xmath141 , then @xmath386 is uniformly quasi - wide with margins @xmath388 and @xmath389 .",
    "let us fix @xmath19 and @xmath37 . given @xmath20 and @xmath28",
    ", we construct a graph @xmath8 as follows .",
    "the vertex set of @xmath8 consists of pairs @xmath379 , where @xmath25 and @xmath390 .",
    "again , vertex @xmath379 is called the _",
    "@xmath209-th _ copy of @xmath23 , while the subset @xmath391 will be called the _ @xmath209-th layer _ of @xmath8 .",
    "the edge set of @xmath8 is defined as follows : for each edge @xmath392 and each @xmath393 , we put an edge @xmath394 , but only if @xmath395 , and we put an edge @xmath396 , but only if @xmath397 .",
    "it is easy to see that @xmath8 is a subgraph of @xmath398 , the @xmath399-blowup of @xmath0 , hence @xmath400 .",
    "let @xmath401 .",
    "we now prove that for every @xmath371 , the @xmath3-projection profile of @xmath23 on @xmath2 in @xmath0 can be uniquely decoded from the @xmath3-distance profile of @xmath402 on @xmath143 in @xmath8 .",
    "[ cl : encode ] for every @xmath371 and @xmath204 , the value @xmath373(v)$ ] is equal to the smallest index  @xmath209 such that @xmath403((v , i))=i$ ] , or @xmath207 if no such index exists .",
    "observe that , for each @xmath390 , the distance from @xmath402 to the @xmath209-th layer of  @xmath8 is at least @xmath209 , hence we always have @xmath403((v , i))\\geq i$ ] .",
    "to prove the claim , we show inequalities in two directions .    in one direction , suppose that @xmath83 is a shortest @xmath2-avoiding path connecting @xmath23 and @xmath91 .",
    "let @xmath404 , where the length of @xmath83 is @xmath209 , and suppose @xmath205 .",
    "then it follows that @xmath405 is a path in @xmath8 , certifying that @xmath403((v , i))\\leq i$ ] .",
    "together with the inequality from the previous paragraph this implies that @xmath403((v , i))=i$ ] .    in the other direction ,",
    "suppose @xmath403((v , i))=i$ ] for some @xmath209 , and let @xmath268 be the path in  @xmath8 certifying this .",
    "since @xmath268 has length @xmath209 and connects @xmath402 with a vertex of @xmath209-th layer , it follows that  @xmath268 has to have the form @xmath406 , where @xmath407 are vertices of @xmath8 . by the construction of @xmath8",
    ", we infer that @xmath408 is an edge in @xmath0 for all @xmath409 , and moreover @xmath410 do not belong to @xmath2 . therefore , @xmath411 is a walk of length @xmath209 in @xmath0 connecting @xmath23 with @xmath91 , where only the last vertex belongs to @xmath2 .",
    "it follows that in @xmath0 there is an @xmath2-avoiding path of length at most @xmath209 connecting @xmath23 with @xmath91 , which certifies that @xmath373(v)\\leq i$ ] .    by  [ cl : encode ] , we have @xmath412 on the other hand , by  [ thm : main - profiles ] we have @xmath413 where function @xmath414 is given for the ( nowhere dense ) class @xmath415 .",
    "however , @xmath415 depends only on @xmath1 and @xmath3 , hence @xmath414 depends only on @xmath1 , @xmath3 , and @xmath5 .",
    "therefore , we can set @xmath416 .",
    "we next recall the main tool for projections proved by drange et al .",
    "@xcite , namely the _",
    "closure lemma_. intuitively , it says that any vertex subset @xmath28 can be `` closed '' to a set @xmath417 that is not much larger than @xmath2 , such that all @xmath3-projections on @xmath417 are small .",
    "the next lemma follows from a straightforward adaptation of the proof of drange et al .",
    "[ lem : closure ] there is a function @xmath418 and a polynomial - time algorithm that , given @xmath20 , @xmath419 , @xmath19 and @xmath37 , computes the _ @xmath3-closure _ of @xmath164 , denoted @xmath420 with the following properties .",
    "* @xmath421 ; * @xmath422 ; and * @xmath423 for each @xmath424 .",
    "let us elaborate on the adaptation .",
    "drange et al .",
    "work in the bounded expansion setting , and they give the following upper bounds on @xmath425 and @xmath426 , for each @xmath427 : @xmath428 where @xmath429 ; here @xmath0 is assumed to belong to a class of bounded expansion @xmath1 . in the nowhere dense setting , @xmath430 is not bounded by a constant , but  [ lem : gradbound ] ensures that the edge density of any @xmath3-shallow minor @xmath8 of a graph from @xmath1 is bounded by @xmath431 . in the proof of drange et al .",
    ", the only place where the parameter @xmath432 comes from is to estimate the edge density in a graph that is an @xmath433-shallow minor of the original graph @xmath0 , in which , moreover , the number of vertices is polynomial in @xmath434 .",
    "it follows by  [ lem : gradbound ] that in the nowhere dense setting , we can substitute @xmath432 with @xmath435 for some function @xmath6 , thus obtaining the statement of  [ lem : closure ] after rescaling @xmath5 .",
    "finally , we need another lemma from drange et al . , called the _",
    "short paths closure lemma_. here , it is shown that a set can be closed without blowing up its size too much , so that short distances between its elements are preserved in the subgraph induced by the closure .",
    "again , the proof is a straightforward adaptation of the proof of drange et al .",
    "[ lem : pathsclosure ] there is a function @xmath436 and a polynomial - time algorithm which on input @xmath20 , @xmath419 , @xmath19 , and @xmath37 , computes a superset @xmath437 of vertices with the following properties :    * whenever @xmath189 for @xmath438 , then @xmath439}(u , v)={\\mathrm{dist}}_g(u , v)$ ] ; and * @xmath440 .",
    "the upper bound on @xmath441 given by drange et al . is @xmath442 , for some polynomial @xmath443 .",
    "again , if @xmath1 is only assumed to be nowhere dense , @xmath430 is not bounded , but the analysis of the proof of drange et al .",
    "reveals that the only place this factor comes from is an application of the closure lemma at the beginning of the proof . after replacing this lemma with its counterpart for a nowhere dense class ( [ lem : closure ] ) , factor @xmath444 is substituted with a polynomial of @xmath445 , which is of the form @xmath446 after rescaling  @xmath5 .    [ [ towards - the - proof . ] ] towards the proof .",
    "+ + + + + + + + + + + + + + + + + +    with all the tools gathered , we can now proceed to the proof of  [ thm : main - kernel ] . for convenience , we recall its statement .",
    "let @xmath1 be a fixed nowhere dense class of graphs , let @xmath3 be a fixed positive integer , and let @xmath37 be any fixed real .",
    "then there is a polynomial - time algorithm that , given a graph @xmath20 and a positive integer @xmath21 , returns a subgraph @xmath41 and a vertex subset @xmath42 with the following properties :    * there is a set @xmath22 of size at most @xmath21 which @xmath3-dominates @xmath0 if and only if there is a set @xmath43 of size at most  @xmath21 which @xmath3-dominates @xmath44 in @xmath45 ; and * @xmath46 , for some function @xmath47 depending only on the class @xmath1 .    for the rest of this section let us fix constants @xmath19 and @xmath37 ; they will be used implicitly in the proofs .",
    "our proof follows the general strategy proposed by drange et al .",
    "@xcite for the bounded expansion setting , however we replace parts that break in the nowhere dense setting with the new results .",
    "the crucial new tool we use is the near - linear bound on the neighborhood complexity in nowhere dense graphs , more precisely the projection variant ( [ thm : main - profiles ] ) .",
    "however , there are also other places where a fix is necessary . here , the polynomial bounds on uniform quasi - wideness ( [ thm : uqw ] ) proved recently by kreutzer et al .",
    "@xcite will appear useful .",
    "let us recall some terminology from drange et al .",
    "@xcite , which is essentially also present in the approach of dawar and kreutzer  @xcite . for an integer @xmath19 ,",
    "graph @xmath0 , and vertex subset @xmath447 , we say that a subset of vertices @xmath24 is a _ @xmath448-dominator _",
    "if @xmath449 .",
    "we write @xmath450 for the smallest @xmath448-dominator in @xmath0 and @xmath451 for the smallest @xmath452-dominator in @xmath0 .",
    "the crux of the approach of drange et al . is to perform kernelization in two phases : first compute a small _ @xmath3-domination core _ , and then reduce the size of the graph in one step .",
    "an _ @xmath3-domination core _ of @xmath0 is a subset @xmath447 such that every minimum size @xmath448-dominator is also a distance-@xmath3 dominating set in @xmath0 .",
    "we shall prove the following analogue of theorem 4.11 of  @xcite .",
    "[ lem : findcore ] there exists a function @xmath453 and a polynomial - time algorithm that , given a graph @xmath20 and integer @xmath454 , either correctly concludes that @xmath0 can not be @xmath3-dominated by @xmath21 vertices , or finds an @xmath3-domination core @xmath447 of @xmath0 of size at most @xmath455 .",
    "starting with @xmath456 , which is clearly an @xmath3-domination core of @xmath0 , we try to iteratively remove vertices from @xmath44 while preserving the property that @xmath44 is an @xmath3-domination core of @xmath0 .",
    "more precisely , we show the following lemma , which is the analogue of theorem 4.12 of  @xcite and of lemma 11 of  @xcite . observe that [ lem : findcore ] follows by the applying  [ lem : findredundantvertex ] iteratively until the size of the core is reduced to at most @xmath457 .",
    "this iteration is performed at most @xmath153 times leading to an additional factor  @xmath153 in the running time in  [ lem : findcore ] .",
    "[ lem : findredundantvertex ] there exists a function @xmath453 and a polynomial - time algorithm that , given a graph @xmath20 , an integer @xmath454 , and an @xmath3-domination core @xmath44 of @xmath0 with @xmath458 , either correctly concludes that @xmath44 can not be @xmath3-dominated by @xmath21 vertices , or finds a vertex @xmath459 such that @xmath460 is still an @xmath3-domination core of  @xmath0 .    as in drange",
    ", the first step of the proof of  [ lem : findredundantvertex ] is to find a suitable approximation of a @xmath448-dominator . for this ,",
    "drange et al .",
    "use a quite complicated scheme of iteratively applying the approximation algorithm of dvok  @xcite , because for the next step they need a dual object  a large @xmath58-independent set  which is provided by the algorithm of dvok as a certificate of approximation .",
    "the need of ensuring that this iterative construction finishes in a constant number of rounds is another piece that breaks in the nowhere dense setting .",
    "we circumvent this problem by obtaining a suitably large @xmath58-independent set using the polynomial bounds on uniform quasi - wideness ( [ thm : uqw ] ) instead of the algorithm of dvok .",
    "therefore , we can rely on the classic @xmath59-approximation of brnnimann and goodrich  @xcite for the problem in set families of bounded vc - dimension , as explained in the next lemma .",
    "[ lem : dvorak ] there is a function @xmath461 and a polynomial - time algorithm that , given @xmath20 and @xmath447 , computes a @xmath448-dominator of size at most @xmath462 , where @xmath21 is the size of a minimum @xmath3-dominating set of @xmath44 .",
    "let @xmath165 be a family of subsets of @xmath64 defined as @xmath463\\colon u\\in z\\}$ ] .",
    "family @xmath165 is a subfamily of the family of all closed @xmath55-neighborhoods in the graph  @xmath187 , as defined in  [ thm : adleradler ] . by [ thm : adleradler ]",
    ", @xmath187 has vc - dimension at most @xmath464 , where @xmath94 depends on @xmath1 and @xmath3 , hence also the vc - dimension of @xmath165 is bounded by @xmath94 .",
    "it is clear that @xmath448-dominators in @xmath0 correspond to hitting sets of @xmath165 , that is , subsets of @xmath64 that intersect every set of @xmath165 .",
    "brnnimann and goodrich  @xcite gave a polynomial - time algorithm that , given a set family of vc - dimension at most @xmath94 and an integer @xmath21 , either correctly concludes that there is no hitting set of size at most @xmath21 , or finds a hitting set of size at most @xmath465 .",
    "more precisely , the running time of this pseudopolynomial algorithm becomes polynomial , with the exponent not dependent on  @xmath1 , if we precompute @xmath165 , store it in a binary matrix , and implement subsystem and witness oracles , as defined in  @xcite , as linear scans over all the elements of @xmath165 .",
    "finally , we can choose the function @xmath461 so that the upper bound on the size of the obtained hitting set , being at most @xmath465 , is upper bounded by @xmath462 .",
    "hence , the set provided by the algorithm of  @xcite applied to @xmath165 can be returned .",
    "we are now ready to prove  [ lem : findredundantvertex ] .",
    "the function @xmath453 will be defined in the course of the proof . for convenience ,",
    "for now we assume that @xmath466 for some large constant @xmath467 , for at the end we will rescale @xmath5 accordingly .",
    "we first apply  [ lem : dvorak ] , to either conclude that there is no @xmath448-dominator of size at most  @xmath21 or to compute a @xmath448-dominator @xmath164 of size at most @xmath462 .",
    "this application takes polynomial time . in the first case we can reject the instance ,",
    "hence assume that we are in the second case .",
    "we apply the algorithm of  [ lem : closure ] to the set @xmath164 and distance parameter @xmath468 , thus computing its closure @xmath469 , henceforth denoted by @xmath470 . by  [ lem : closure ]",
    ", we have @xmath471 and , for every @xmath472 , @xmath473    we now classify the elements of @xmath474 according to their @xmath468-projection profiles on @xmath470 .",
    "more precisely , let us define an equivalence relation @xmath282 on @xmath474 as follows : @xmath475=\\rho^g_{3r}[v , x_{\\mathrm{cl}}].\\ ] ] by  [ lem : projection - complexity ] , the number of equivalence classes of @xmath282 is bounded as follows : @xmath476 note that the partition of @xmath64 into the equivalence classes of @xmath282 can be computed in polynomial time , by just computing the @xmath468-projection profile for each vertex using breadth - first search , and then comparing the profiles pairwise .",
    "let @xmath145 and @xmath146 be the functions provided by  [ thm : uqw ] for the class @xmath1 .",
    "denote @xmath477 from the above inequalities on @xmath478 and @xmath479 , it follows that setting @xmath480 , we can fix the function @xmath453 so that the following inequality is always satisfied : @xmath481 since we assumed that @xmath482 , it follows that @xmath483 .",
    "hence , by the pigeonhole principle , there exists an equivalence class @xmath285 of @xmath282 that contains more than @xmath484 vertices . by applying the algorithm of  [ thm : uqw ] to any subset of @xmath285 of size exactly @xmath484 , we find sets @xmath136 and @xmath485 such that @xmath486 , @xmath487 , and @xmath118 is @xmath58-independent in @xmath140 .",
    "this application takes time @xmath488 .",
    "provided @xmath5 satisfies @xmath489 , which we can assume without loss of generality , we have that @xmath490 ; here , the constants hidden in the @xmath370-notation may depend on @xmath1 .",
    "since we can assume that @xmath491 , this application of the algorithm of  [ thm : uqw ] takes then time @xmath492 , which is polynomial with the degree independent of @xmath1 .",
    "we now classify the elements of @xmath118 according to their @xmath3-distance profiles on @xmath144 .",
    "note that @xmath493 and that the number of @xmath3-distance profiles on @xmath144 is bounded by @xmath494 . since @xmath495 , by the pigeonhole principle we infer that there is a subset @xmath496 of size @xmath497 such that @xmath498    at this point the situation is almost exactly as in lemma 3.8 of  @xcite .",
    "more precisely , every vertex of @xmath499 is an irrelevant dominatee , i.e. , it can be excluded from @xmath44 without spoiling the property that @xmath44 is a domination core . for the sake of completeness , we repeat the argumentation from  @xcite , which is based on an exchange argument .",
    "let @xmath500 be any vertex of @xmath499 , which also belongs to @xmath44 due to @xmath501 , and let @xmath502 .",
    "[ cl : exchange ] the set @xmath503 is also a domination core of @xmath0 .",
    "suppose @xmath24 is a minimum - size @xmath504-dominator in @xmath0 .",
    "consider first the case when @xmath500 is @xmath3-dominated by @xmath24 .",
    "then @xmath24 is in fact a @xmath448-dominator , and it must be a minimum - size @xmath448-dominator since @xmath505 and @xmath24 is a minimum - size @xmath504-dominator . since @xmath44 is an @xmath3-domination core by assumption , we infer that @xmath24 is an @xmath3-dominating set of @xmath0 , hence we are done in this case .",
    "thus , for the rest of the proof we assume that @xmath24 does not @xmath3-dominate @xmath500 , and we aim at a contradiction .",
    "consider any vertex @xmath506 .",
    "since @xmath507 , we have that @xmath223 is @xmath3-dominated by @xmath24 . for each such @xmath223 ,",
    "let us select any vertex @xmath508 that @xmath3-dominates @xmath223 .",
    "further , let @xmath509 be an arbitrary path of length at most @xmath3 that connects @xmath510 with @xmath223 .",
    "we first prove that for each @xmath511 , the path @xmath509 does not traverse any vertex of @xmath512 . for suppose otherwise , and assume that @xmath321 is the first ( closest to @xmath223 ) vertex of @xmath509 that belongs to @xmath513 .",
    "suppose further that the length of the prefix of @xmath509 from @xmath223 to @xmath321 is @xmath77 , for some @xmath514 ; thus @xmath515 and @xmath516 .",
    "if we had @xmath517 , then since all vertices of @xmath499 have the same distance profile on @xmath144 , we would have @xmath518 , implying @xmath519 so @xmath500 would be @xmath3-dominated by @xmath508 . on the other hand ,",
    "if we had @xmath520 , then the prefix of @xmath509 from @xmath223 to @xmath321 , being an @xmath513-avoiding path , certifies that @xmath521(y)\\leq \\ell$ ] .",
    "vertices of @xmath522 have the same projection profiles on @xmath513 , hence also @xmath523(y)=\\rho^g_{3r}[x , x_{\\mathrm{cl}}](y)\\leq \\ell$ ] , implying in particular that @xmath524 . then the same reasoning as in the previous case leads to the contradiction with the supposition that @xmath500 is not @xmath3-dominated by @xmath24 .",
    "we conclude that the paths @xmath525 are entirely contained in @xmath526 . since @xmath527 is @xmath58-independent in @xmath140 , and each path @xmath509 has length at most @xmath3 , we conclude that vertices @xmath510 for @xmath506 are pairwise different .",
    "in particular , if we denote @xmath528 , then @xmath529 denote @xmath530 .",
    "since @xmath531 and the @xmath468-projection of each vertex of @xmath532 onto @xmath513 has size at most @xmath533 , we infer that @xmath534 thus @xmath535 .",
    "denote @xmath536 ; then we have @xmath537 .",
    "we claim that @xmath538 is still a @xmath504-dominator in @xmath0 , which will contradict the assumption that @xmath24 is a minimum - size @xmath504-dominator in @xmath0 .    for the sake of contradiction , suppose there is some vertex @xmath539 that is not @xmath3-dominated by @xmath538 . since @xmath24 is a @xmath504-dominator and @xmath540 , it follows that there is some vertex @xmath506 such that @xmath510 was the vertex of @xmath24 that @xmath3-dominated @xmath541 , i.e. , @xmath542 .",
    "let @xmath543 be any path of length at most @xmath3 connecting @xmath510 and @xmath541 .",
    "futhermore , since @xmath544 and @xmath513 is a @xmath448-dominator , there is some path @xmath545 of length at most @xmath3 that connects @xmath541 with a vertex of @xmath513 .",
    "consider now the concatenation of paths @xmath509 , @xmath543 , and @xmath545 .",
    "this is a walk of length at most @xmath468 connecting @xmath223 with a vertex of @xmath513 .",
    "let @xmath242 be the first vertex of this walk ( from the side of  @xmath223 ) that belongs to @xmath512 .",
    "we have that @xmath242 does not lie on @xmath509 , since we argued that @xmath509 is disjoint with @xmath512 .",
    "therefore , @xmath242 lies on @xmath543 or @xmath545 , however every vertex lying on any of these paths is at distance at most @xmath3 from @xmath541 .",
    "hence @xmath546 , so it remains to argue that @xmath547 .",
    "this is obvious if @xmath548 since @xmath144 was explicitly included in @xmath549 , so assume that @xmath550 .",
    "then the prefix of the considered walk from @xmath223 to @xmath242 avoids @xmath513 , which certifies that @xmath551 .",
    "however , @xmath552 and all vertices of @xmath285 have the same @xmath468-projection profile on @xmath513 , so in particular the same @xmath468-projection on @xmath513 .",
    "we conclude that @xmath553 , which finishes the proof .",
    "[ cl : exchange ] ensures us that vertex @xmath500 is an irrelevant dominatee that can be returned by the algorithm .",
    "note that we were able to find @xmath500 provided @xmath482 for some constant  @xmath467 depending on @xmath1 and @xmath3 .",
    "hence , we conclude the proof by rescaling @xmath5 to @xmath554 throughout the reasoning .    finally , having computed a suitably small domination core",
    ", we can construct a kernel from it .",
    "this part of reasoning is exactly the same as in  @xcite .",
    "[ lem : core - kernel ] there exists a function @xmath555 and a polynomial - time algorithm that , given a graph @xmath20 and an @xmath3-domination core @xmath447 of @xmath0 , computes a graph @xmath45 with at most @xmath556 vertices such that @xmath42 and @xmath557 .",
    "first , we classify the vertices of @xmath558 according to their @xmath3-projections onto @xmath44 .",
    "precisely , consider an equivalence relation @xmath282 on @xmath558 defined as follows : @xmath559=\\rho^g_{r}[v , z].\\ ] ] by  [ lem : projection - complexity ] , the equivalence relation @xmath282 has at most @xmath560 equivalence classes .",
    "for each equivalence class @xmath285 of @xmath282 , let us arbitrarily select a vertex @xmath299 belonging to @xmath285 .",
    "let us define : @xmath561 thus we have @xmath562 now , we apply  [ lem : pathsclosure ] to @xmath0 , the set @xmath2 , distance parameter @xmath3 , and @xmath5 .",
    "thus we compute a superset @xmath563 with the following conditions satisfied : for every pair of vertices @xmath564 , if @xmath189 then @xmath565}(u , v)$ ] .",
    "moreover , we have @xmath566 now , we claim that the algorithm can output the graph @xmath567 $ ] ; the correctness of this step follows from the following .",
    "[ cl : correctness - closure ] it holds that @xmath568,z)$ ] .",
    "the proof of  [ cl : correctness - closure ] is the same as the proof of claims 3.12 and 3.14 in  @xcite , and hence we omit it and refer the reader to  @xcite instead .",
    "let us only remark that the crucial observation is that if @xmath24 is a minimum - size dominating set in @xmath0 , then @xmath569 is also a minimum - size dominating set in @xmath0 , while @xmath570 .",
    "we conclude by rescaling @xmath5 by factor  @xmath571 in order to achieve an upper bound @xmath572 for some function @xmath555 .",
    "[ thm : main - kernel ] follows by combining  [ lem : findcore ] and  [ lem : core - kernel ] , and rescaling @xmath5 by factor @xmath571 .",
    "in this paper we proved that for monotone graph classes , nowhere denseness is equivalent to admitting an almost linear upper bound on the neighborhood complexity of any subset of vertices of a graph from the class . as a concrete algorithmic application of this characterization , we gave an almost linear kernel for the problem on any nowhere dense class of graphs and any @xmath19 .",
    "this yields a dichotomy theorem for the parameterized complexity of on monotone classes : there is a sharp jump in the complexity exactly on the boundary between nowhere and somewhere denseness .",
    "our study contributes to the general research programme of understanding the connections between the combinatorial , algorithmic , and logical aspects of the notions of abstract sparsity ; this programme is currently under intensive development .",
    "in particular , we believe that this work together with  @xcite provides fundamental applications of model - theoretic tools borrowed from the stability theory to the combinatorial and algorithmic theory of nowhere dense classes . conceptually , we think that the most important technical insight can be summarized as follows .",
    "when working with a graph @xmath0 from a fixed nowhere dense class @xmath1 , one often would like to define auxiliary objects that are not necessarily sparse ; examples include the hypergraph of balls of radius @xmath3 around every vertex , or the hypergraph of weak @xmath3-reachability sets that we encountered in  [ sec : neighborhood - complexity ] .",
    "while we can not directly apply the sparsity toolbox to these objects due to their dense nature , we can still infer some of their properties , predominantly the boundedness of the vc - dimension , from the stability of the graph class @xmath1 .",
    "this , together with the sauer - shelah lemma , is often enough to get a refined combinatorial understanding that leads to conclusions for the original sparse graph @xmath0 .",
    "more concretely , as  @xcite and this work shows , a bound on the vc - dimension combined with the sauer - shelah lemma is often the right tool for turning exponential blow - ups in combinatorial estimations into polynomial , which enables lifting reasonings from the bounded expansion setting to the nowhere dense setting .",
    "g. drange , m.  s. dregi , f.  v. fomin , s.  kreutzer , d.  lokshtanov , m.  pilipczuk , m.  pilipczuk , f.  reidl , f.  snchez villaamil , s.  saurabh , s.  siebertz , and s.  sikdar .",
    "kernelization and sparseness : the case of dominating set . in _",
    "stacs 2016 _ , volume  47 of _ lipics _ ,",
    "pages 31:131:14 .",
    "schloss dagstuhl  leibniz - zentrum fr informatik , 2016 .",
    "see arxiv preprint 1411.4575 for full proofs .",
    "f.  v. fomin , d.  lokshtanov , s.  saurabh , and d.  m. thilikos .",
    "linear kernels for ( connected ) dominating set on graphs with excluded topological subgraphs . in _",
    "stacs 2013 _ , volume  20 of _ lipics _ ,",
    "pages 92103 .",
    "schloss dagstuhl  leibniz - zentrum fr informatik , 2013 .",
    "s.  kreutzer , m.  pilipczuk , r.  rabinovich , and s.  siebertz .",
    "the generalised colouring numbers on classes of bounded expansion . in _ 41st international symposium on mathematical foundations of computer science , mfcs 2016 , august 22 - 26 , 2016 - krakw , poland _ , pages 85:185:13 , 2016 ."
  ],
  "abstract_text": [
    "<S> we prove that whenever @xmath0 is a graph from a nowhere dense graph class @xmath1 , and @xmath2 is a subset of vertices of @xmath0 , then the number of subsets of  @xmath2 that are realized as intersections of  @xmath2 with @xmath3-neighborhoods of vertices of @xmath0 is at most @xmath4 , where @xmath3 is any positive integer , @xmath5 is any positive real , and @xmath6 is a function that depends only on the class @xmath1 . </S>",
    "<S> this yields a characterization of nowhere dense classes of graphs in terms of _ neighborhood complexity _ , which answers a question posed by reidl et al .  </S>",
    "<S> @xcite . as an algorithmic application of the above result </S>",
    "<S> , we show that for every fixed @xmath3 , the parameterized problem admits an almost linear kernel on any nowhere dense graph class . </S>",
    "<S> this proves a conjecture posed by drange et al .  </S>",
    "<S> @xcite , and shows that the limit of parameterized tractability of on subgraph - closed graph classes lies exactly on the boundary between nowhere denseness and somewhere denseness .    </S>",
    "<S> ( 0,0 ) ( 395,-237 ) </S>"
  ]
}