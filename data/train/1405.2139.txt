{
  "article_text": [
    "a striking feature of multiple - soliton solutions of integrable model equations such as the korteweg - devries equation , the benjamin - ono equation , and the nonlinear schrdinger equation is that they interact elastically , leading to time - periodic , relative - periodic , or quasi - periodic dynamics .",
    "by contrast , the interaction of solitary waves for the free - surface euler equations is inelastic .",
    "however , it has been observed many times in the literature @xcite that the residual radiation after a collision of such solitary waves can be remarkably small . in the present paper",
    "we explore the possibility of finding nearby time - periodic and relative - periodic solutions of the euler equations using a collision of unidirectional stokes waves as a starting guess .",
    "such solutions demonstrate that recurrent elastic collisions of solitary waves in the spatially periodic case do not necessarily indicate that the underlying system is integrable .",
    "a relative - periodic solution is one that returns to a spatial phase shift of its initial condition at a later time .",
    "this only makes sense on a periodic domain , where the waves collide repeatedly at regular intervals in both time and space , with the locations of the collisions drifting steadily in time .",
    "they are special cases ( with @xmath0 ) of quasi - periodic solutions , which have the form @xmath1 with @xmath2 an @xmath3-periodic continuous function , i.e.  @xmath4 , and @xmath5 , @xmath6 , @xmath7 . throughout the manuscript",
    ", we will use the phrase `` solitary waves '' in a broad sense to describe waves that , most of the time , remain well - separated from one another and propagate with nearly constant speed and shape . `` stokes waves ''",
    "will refer to periodic progressive solutions of the free - surface euler equations of permanent form , or waves that began at @xmath8 as a linear superposition of such traveling waves .",
    "they comprise a special class of solitary waves .",
    "`` solitons '' will refer specifically to superpositions of @xmath9 solutions of the kdv equation on the whole line , while `` cnoidal solutions '' will refer to their spatially periodic , multi - phase counterparts ; see  [ sec : kdv ] for elaboration .",
    "it was found in @xcite that decreasing the fluid depth causes standing waves to transition from large - scale symmetric sloshing behavior in deep water to pairs of counter - propagating solitary waves that collide repeatedly in shallow water . in the present work",
    ", we consider unidirectional waves of different amplitude that collide due to taller waves moving faster than shorter ones .",
    "we present two examples of solutions of this type : one where the resulting dynamics is fully time - periodic ; and one where it is relative - periodic , returning to a spatial phase shift of the initial condition at a later time . both examples exhibit behavior typical of collisions of kdv solitons . in the first ,",
    "one wave is significantly larger than the other , and completely subsumes it during the interaction . in the second ,",
    "the waves have similar amplitude , with the trailing wave bumping into the leading wave and transferring energy without fully merging .    despite these similarities , the amplitude of the waves in our examples are too large for the assumptions in the derivation of the kdv equation to hold .",
    "in particular , the larger wave in the first example is more than half the fluid depth in height , and there is significant vertical motion of the fluid when the waves pass by .",
    "a detailed comparison of the euler and kdv equations for waves with these properties is carried out in  [ sec : kdv ] . a review of the literature on water wave collisions and the accuracy of the kdv model of water waves is also given in that section .    rather than compute such solutions by increasing the amplitude from the linearized regime via numerical continuation , as was done for counter - propagating waves in @xcite , we use collisions of right - moving stokes waves as starting guesses .",
    "the goal is to minimally `` tune '' the background radiation generated by the stokes collisions so that the amount coming out of each collision is identical to what went into it . in the first example of  [ sec : num ] , we find that the tuned background radiation takes the form of a train of traveling waves of smaller wavelength moving to the right more slowly than either solitary wave . by contrast , in the counter - propagating case studied in @xcite , it consists of an array of smaller - wavelength standing waves oscillating rapidly relative to the time between collisions of the primary waves . in the second example of  [ sec",
    ": num ] , the background radiation is essentially absent , which is to say that the optimized solution is free from high - frequency , low - amplitude disturbances in the trough , and closely resembles a relative - periodic cnoidal solution of kdv .",
    "we call the collisions in this solution `` elastic '' as they repeat forever , unchanged up to spatial translation , and there are no features to distinguish radiation from the waves themselves .",
    "this process of tuning parameters to minimize or eliminate small - amplitude oscillations in the wave troughs is reminiscent of vanden - broeck s work @xcite in which oscillations at infinity could be eliminated from solitary capillary - gravity waves by choosing the amplitude appropriately .    to search for relative periodic solutions",
    ", we use a variant of the overdetermined shooting method developed by the author and collaborators in previous work to study several related problems : time - periodic solutions of the benjamin - ono equation @xcite and the vortex sheet with surface tension @xcite ; hopf bifurcation and stability transitions in mode - locked lasers @xcite ; cyclic steady - states in rolling treaded tires @xcite ; self - similarity ( or lack thereof ) at the crests of large - amplitude standing water waves @xcite ; harmonic resonance and spontaneous nucleation of new branches of standing water waves at critical depths @xcite ; and three - dimensional standing water waves @xcite .",
    "the three approaches developed in these papers are the adjoint continuation method @xcite , a newton - krylov shooting method @xcite , and a trust region shooting method @xcite based on the levenberg - marquardt algorithm @xcite .",
    "we adopt the latter method here to exploit an opportunity to consolidate the work in computing the dirichlet - neumann operator for many columns of the jacobian simultaneously , in parallel",
    ". one computational novelty of this work is that we search directly for large - amplitude solutions of a nonlinear two - point boundary value problem , without using numerical continuation to get there .",
    "this is generally difficult .",
    "however , in the present case , numerical continuation is also difficult due to non - smooth bifurcation `` curves '' riddled with cantor - like gaps @xcite , and the long simulation times that occur between collisions in the unidirectional case .",
    "our shooting method has proven robust enough to succeed in finding time - periodic solutions , when they exist , with a poor starting guess .",
    "false positives are avoided by resolving the solutions spectrally to machine accuracy and overconstraining the minimization problem .",
    "much of the challenge is in determining the form of the initial condition and the objective function to avoid wandering off in the wrong direction and falling into a nonzero local minimum before locking onto a nearby relative - periodic solution .",
    "the equations of motion of a free surface @xmath10 evolving over an ideal fluid with velocity potential @xmath11 may be written @xcite @xmath12      \\notag      \\varphi_t & = p\\left[\\phi_y\\eta_t - \\frac{1}{2}\\phi_x^2 -    \\frac{1}{2}\\phi_y^2 - g\\eta\\right ] , \\ ] ] where subscripts denote partial derivatives , @xmath13 is the restriction of @xmath14 to the free surface , @xmath15 is the acceleration of gravity , @xmath16 is the fluid density , and @xmath17 is the projection @xmath18 where we assume a @xmath19-periodic domain . the velocity components @xmath20 and @xmath21 at the free surface can be computed from @xmath22 via @xmath23 where a prime denotes a derivative and @xmath24 is the dirichlet - neumann operator @xcite @xmath25 for the laplace equation , with periodic boundary conditions in @xmath26 , dirichlet conditions ( @xmath27 ) on the upper boundary , and neumann conditions ( @xmath28 ) on the lower boundary , assumed flat .",
    "we have suppressed @xmath29 in the notation since time is frozen in the laplace equation .",
    "we compute @xmath30 using a boundary integral collocation method @xcite and advance the solution in time using an 8th order runge - kutta scheme @xcite with 36th order filtering @xcite .",
    "see @xcite for details .",
    "traveling waves have the symmetry that @xmath31 this remains true if @xmath26 is replaced by @xmath32 . as a starting guess for a new class of time - periodic and relative - periodic solutions , we have in mind superposing two traveling waves , one centered at @xmath33 and the other at @xmath34",
    ". doing so will preserve the property ( [ eq : init ] ) , but the waves will now interact rather than remain pure traveling waves . a solution will be called _ relative periodic _ if there exists a time @xmath35 and phase shift @xmath36 such that @xmath37 for all @xmath29 and @xmath26 .",
    "time - periodicity is obtained as a special case , with @xmath38 .",
    "we can save a factor of 2 in computational work by imposing the alternative condition @xmath39 from this , it follows that @xmath40 but then both sides of each equation in ( [ eq : ts : def ] ) agree at time @xmath41 .",
    "thus , ( [ eq : ts : def ] ) holds for all time .    in the context of traveling - standing waves in deep water @xcite ,",
    "it is natural to define @xmath35 as twice the value above , replacing all factors of @xmath42 by @xmath43 . that way a pure standing wave returns to its original configuration in time @xmath35 instead of shifting in space by @xmath44 in time @xmath35 . in the present work ,",
    "we consider pairs of solitary waves moving to the right at different speeds , so it is more natural to define @xmath35 as the first ( rather than the second ) time there exists a @xmath36 such that ( [ eq : ts : def ] ) holds .",
    "we adapt the overdetermined shooting method of @xcite to compute solutions of ( [ eq : init])([eq : even : odd ] ) .",
    "this method employs the levenberg - marquardt method @xcite with delayed jacobian updates @xcite to solve the nonlinear least squares problem described below .    for ( [ eq : init ] )",
    ", we build the symmetry into the initial conditions over which the shooting method is allowed to search : we choose an integer @xmath45 and consider initial conditions of the form @xmath46 where @xmath47 and @xmath48 , @xmath49 are the fourier modes of @xmath10 , @xmath50 .",
    "the numbers @xmath51 are assumed real and all other fourier modes ( except @xmath52 ) are zero .",
    "we set @xmath52 to the fluid depth so that @xmath53 is a symmetry line corresponding to the bottom wall .",
    "this is convenient for computing the dirichlet - neumann operator @xcite . in the formula for @xmath54",
    ", the minus sign is taken if @xmath55 so that @xmath56 .",
    "we also solve for the period , @xmath57 the phase shift @xmath36 is taken as a prescribed parameter here .",
    "alternatively , in a study of traveling - standing waves @xcite , the author defines a traveling parameter @xmath58 and varies @xmath59 as part of the algorithm to obtain the desired value of @xmath58 .",
    "this parameter @xmath58 is less meaningful for solitary wave collisions in shallow water , so we use @xmath36 itself as the traveling parameter in the present study .",
    "we also need to specify the amplitude of the wave .",
    "this can be done in various ways , e.g.  by specifying the value of the energy , @xmath60 by constraining a fourier mode such as @xmath61 , or by specifying the initial height of the wave at @xmath33 : @xmath62 thus , to enforce ( [ eq : even : odd ] ) , we can minimize the objective function @xmath63 where @xmath64 here @xmath65 is the desired value of the chosen amplitude parameter .",
    "alternatively , we can impose ( [ eq : ts : def ] ) directly by minimizing @xmath66 ^ 2 +    \\big[\\varphi(x , t)-\\varphi(x-\\theta,0)\\big]^2\\right)dx,\\ ] ] which also takes the form @xmath67 if we define @xmath68 as above and @xmath69 , \\\\",
    "r_{4j}+ir_{4j+1 } & = \\sqrt{2}\\left [ \\hat\\varphi_j(t ) - e^{-ij\\theta}\\hat\\varphi_j(0 ) \\right ] ,    \\end{aligned } \\qquad\\quad ( 1\\le j\\le m/2).\\ ] ] note that @xmath70 measures deviation from evenness and oddness of @xmath71 and @xmath72 , respectively , while @xmath73 measures deviation of @xmath74 and @xmath75 from their initial states . in the first example of ",
    "[ sec : num ] , we minimize @xmath73 directly , while in the second we minimize @xmath70 and check that @xmath73 is also small , as a means of validation .",
    "the number of equations , @xmath76 for @xmath70 and @xmath77 for @xmath73 , is generally larger than the number of unknowns , @xmath78 , due to zero - padding of the initial conditions .",
    "this adds robustness to the shooting method and causes all fourier modes varied by the algorithm , namely those in ( [ eq : init : trav ] ) , to be well - resolved on the mesh .      to compute the @xmath79th column of the jacobian @xmath80 , which is needed by the levenberg - marquardt method",
    ", we solve the linearized equations along with the nonlinear ones : @xmath81 here @xmath82 , @xmath83 , @xmath84 is given in ( [ eq : ww ] ) , @xmath85 is its derivative ( see @xcite for explicit formulas ) , and a dot represents a variational derivative with respect to perturbation of the initial conditions , not a time derivative . to compute @xmath86 for @xmath87 and @xmath88 ,",
    "one simply puts a dot over each fourier mode on the right - hand side of ( [ eq : r : def ] ) or ( [ eq : r1:def ] ) , including @xmath89 and @xmath90 in ( [ eq : r1:def ] ) .",
    "if @xmath91 , then @xmath92 and @xmath93\\ ] ] in ( [ eq : r : def ] ) and ( [ eq : r1:def ] ) , respectively , with similar formulas for @xmath94 and @xmath95 .",
    "the three possibilities for @xmath68 are handled as follows : @xmath96_{t=0}dx ,     \\quad ( k\\le n ) , \\qquad    { \\frac{\\partial r_1}{\\partial c_{n+1 } } } = 0 , \\\\    & \\text{case 2 : } \\quad { \\frac{\\partial r_1}{\\partial c_k } } = { { \\dot\\eta}^{\\scriptscriptstyle\\bm\\wedge}}_1(0 ) = \\delta_{k,1 } ,    \\quad ( k\\le n+1),\\\\    & \\text{case 3 : } \\quad { \\frac{\\partial r_1}{\\partial c_k } } = \\dot\\eta(0,0 ) = 2\\delta_{k,\\text{odd } } , \\quad    ( k\\le n ) , \\qquad { \\frac{\\partial r_1}{\\partial c_{n+1 } } } = 0,\\end{aligned}\\ ] ] where @xmath97 and @xmath98 equal 1 if @xmath99 or @xmath79 is odd , respectively , and equal zero otherwise .",
    "the vectors @xmath100 in ( [ eq : q : qdot ] ) are computed in batches , each initialized with a different initial perturbation , to consolidate the work in computing the dirichlet - neumann operator during each timestep .",
    "see @xcite for details .",
    "as mentioned in the introduction , our idea is to use collisions of unidirectional stokes ( i.e.  traveling ) waves as starting guesses to find time - periodic and relative periodic solutions of the euler equations .",
    "we begin by computing traveling waves of varying wave height and record their periods .",
    "this is easily done in the framework of  [ sec : method ] .",
    "we set @xmath101 ( or any other small number ) and minimize @xmath73 in ( [ eq : f1 ] ) . the resulting `` period '' @xmath35 will give the wave speed via @xmath102 .",
    "below we report @xmath103 , i.e.  @xmath35 is rescaled as if @xmath36 were @xmath19 .",
    "we control the amplitude by specifying @xmath61 , which is the second option listed in  [ sec : method ] for defining the first component @xmath68 of the residual .",
    "a more conventional approach for computing traveling waves is to substitute @xmath104 , @xmath105 into ( [ eq : ww ] ) and solve the resulting stationary problem ( or an equivalent integral equation ) by newton s method @xcite .",
    "note that the wave speed @xmath106 here is unrelated to the vector @xmath106 of unknowns in ( [ eq : init : trav ] ) .",
    "plots of wave height and first fourier mode versus period for stokes waves with wavelength @xmath19 and fluid depth @xmath107 .",
    "the temporal periods are @xmath108.,width=316 ]     collision of two right - moving stokes waves that nearly return to their initial configuration after the interaction .",
    "( left ) solutions a and c were combined via ( [ eq : aandc ] ) and evolved through one collision to @xmath109 .",
    "( right ) through trial and error , we adjusted the amplitude of the smaller stokes wave and the simulation time to obtain a nearly time - periodic solution . ]    with traveling waves in hand , out next goal is to collide two of them and search for a nearby time - periodic solution , with @xmath110 .",
    "as shown in figure  [ fig : bif : stokes ] , varying @xmath61 from 0 to @xmath111 causes the period of a stokes wave with wavelength @xmath112 and mean fluid depth @xmath107 to decrease from @xmath113 to @xmath114 , and the wave height ( vertical crest - to - trough distance ) to increase from 0 to @xmath115 .",
    "solution c is the closest among the stokes waves we computed to satisfying @xmath116 , where @xmath117 is the smallest integer satisfying @xmath118 . we then combine solution a with a spatial phase shift of solution c at @xmath8 .",
    "the resulting initial conditions are @xmath119 + \\big[\\eta^c_0(x-\\pi)-h\\big ] , \\\\",
    "\\varphi^{a+c}_0(x ) & = \\varphi^a_0(x ) + \\varphi^c_0(x-\\pi ) ,    \\end{aligned}\\ ] ] where @xmath107 is the mean fluid depth .",
    "plots of @xmath120 , @xmath121 , @xmath122 and @xmath123 are shown in figure  [ fig : aandc ] .",
    "if the waves did not interact , the combined solution would be time - periodic ( to the extent that @xmath116 , i.e.  to about @xmath124 ) .",
    "but the waves do interact .",
    "in addition to the complicated interaction that occurs when they collide , each slows the other down between collisions by introducing a negative gradient in the velocity potential between its own wave crests .",
    "indeed , as shown in the right panel of figure  [ fig : aandc ] , the velocity potential increases rapidly across a right - moving solitary wave and decreases elsewhere to achieve spatial periodicity .",
    "the decreasing velocity potential induces a background flow opposite to the direction of travel of the other wave . in the left panel of figure  [ fig : align : stokes ] , we see that the net effect is that neither of the superposed waves has returned to its starting position at @xmath125 , and the smaller wave has experienced a greater net decrease in speed",
    ". however , as shown in the right panel , by adjusting the amplitude of the smaller wave ( replacing solution c by b ) and increasing @xmath35 slightly to @xmath126 , we are able to hand - tune the stokes waves to achieve @xmath127 , where @xmath36 is set to zero in ( [ eq : f1 ] ) .",
    "note that as @xmath29 varies from 0 to @xmath128 in the left panel of figure  [ fig : evol : kdv1 ] , the small wave advances by @xmath44 units to the right while the large wave advances by @xmath129 units .",
    "the waves collide at @xmath130 .",
    "this generates a small amount of radiation , which can be seen at @xmath131 in the right panel of figure  [ fig : align : stokes ] .",
    "some radiation behind the large wave is present for all @xmath132 , as shown in figure  [ fig : pov : kdv1 ] .    before minimizing @xmath73",
    ", we advance the two stokes waves to the time of the first collision , @xmath130 . at this time",
    ", the larger solitary wave has traversed the domain 3 times and the smaller one 2.5 times , so their peaks lie on top of each other at @xmath33 .",
    "the reason to do this is that when the waves merge , the combined wave is shorter , wider , and smoother than at any other time during the evolution .",
    "quantitatively , the fourier modes of @xmath48 and @xmath49 decay below @xmath133 for @xmath134 at @xmath8 , and @xmath135 when @xmath130 .",
    "thus , the number of columns needed in the jacobian is reduced by a factor of 3 , and the problem becomes more overdetermined , hence more robust . for the calculation of a time - periodic solution , we let @xmath8 correspond to this merged state , which affects the time labels when comparing figures  [ fig : evol : kdv1 ] and  [ fig : evol : kdv2 ] . as a final initialization step , we project onto the space of initial conditions satisfying ( [ eq : init : trav ] ) by zeroing out the imaginary parts of @xmath136 and the real parts of @xmath137 , which are already small .",
    "surprisingly , this improves the time - periodicity of the initial guess in ( [ eq : f1 ] ) to @xmath138 .",
    "evolution of two stokes waves that collide repeatedly , at times @xmath139 , @xmath140 .",
    "( left ) traveling solutions a and b in figure  [ fig : bif : stokes ] were initialized with wave crests at @xmath33 and @xmath34 , respectively .",
    "the combined solution is approximately time - periodic , with period @xmath141 .",
    "( right ) the same solution , at later times , starting with the second collision ( @xmath142 ) . ]",
    "a different view of the solutions in figure  [ fig : evol : kdv1 ] shows the generation of background waves .",
    "shown here are the functions @xmath143 , which give the dynamics in a frame moving to the right fast enough to traverse the domain four times in time @xmath35 . in a stationary frame , the smaller and larger solitary waves traverse the domain 5 and 6 times , respectively.,height=192 ]    we emphasize that our goal is to find _ any _ nearby time - periodic solution by adjusting the initial conditions to drive @xmath73 to zero .",
    "energy will be conserved as the solution evolves from a given initial condition , but is only imposed as a constraint ( in the form of a penalty ) on the search for initial conditions when the first component of the residual in ( [ eq : r : def ] ) is set to @xmath144 . in the present calculation , we use @xmath145 instead . in the second example , presented below , we will constrain energy . in either case , projecting onto the space of initial conditions satisfying ( [ eq : init : trav ] )",
    "can cause @xmath68 to increase , but it will decrease to zero in the course of minimizing @xmath73 .",
    "this projection is essential for the symmetry arguments of  [ sec : obj : fun ] to work .",
    "time - periodic solutions near the stokes waves of figure  [ fig : evol : kdv1 ] .",
    "( left ) @xmath107 , @xmath146 , @xmath147 , @xmath148 .",
    "( right ) @xmath149 , @xmath150 , @xmath151 , @xmath152 .",
    "the background radiation was minimized by hand in the right panel by varying @xmath153 and @xmath154 . ]     same as figure  [ fig : pov : kdv1 ] , but showing the time - periodic solutions of figure  [ fig : evol : kdv2 ] instead of the stokes waves of figure  [ fig : evol : kdv1 ] .",
    "the stokes waves generate new background radiation with each collision while the time - periodic solutions are synchronized with the background waves to avoid generating additional disturbances .",
    ", height=192 ]    we minimize @xmath73 subject to the constraint @xmath155 , the third case described in  [ sec : method ] for specifying the amplitude .",
    "this causes @xmath73 to decrease from @xmath156 to @xmath157 using @xmath158 grid points and @xmath159 time - steps ( to @xmath131 ) .",
    "the results are shown in the left panel of figures  [ fig : evol : kdv2 ] and  [ fig : pov : kdv2 ] .",
    "the main difference between the stokes collision and this nearby time - periodic solution is that the stokes waves generate additional background ripples each time they collide while the time - periodic solution contains an equilibrium background wave configuration that does not grow in amplitude after the collision . while the background waves in the counter - propagating case ( studied in @xcite ) look like small - amplitude standing waves , these background waves travel to the right , but slower than either solitary wave .",
    "after computing the @xmath107 time - periodic solution , we computed 10 other solutions with nearby values of @xmath153 and @xmath154 to try to decrease the amplitude of the background radiation .",
    "the best solution we found ( in the sense of small background radiation ) is shown in the right panel of figures  [ fig : evol : kdv2 ] and  [ fig : pov : kdv2 ] , with @xmath149 and @xmath150 . the amplitude of the background waves of this solution are comparable to that of the stokes waves after two collisions .",
    "our second example is a relative periodic solution in which the initial stokes waves ( the starting guess ) are b and c in figure  [ fig : bif : stokes ] instead of a and c. as before , solution c is shifted by @xmath44 when the waves are combined initially , just as in ( [ eq : aandc ] ) .",
    "because the amplitude of the larger wave has been reduced , the difference in wave speeds is smaller , and it takes much longer for the waves to collide . if the waves did not interact , we would have @xmath160 where wave b crosses the domain @xmath161 times in time @xmath162 while wave c crosses the domain @xmath163 times .",
    "the subscript 0 indicates that the waves are assumed not to interact .",
    "since the waves do interact , we have to evolve the solution numerically to obtain useful estimates of @xmath35 and @xmath36 .",
    "we arbitrarily rounded @xmath162 to 1436 and made plots of the solution at times @xmath164 .",
    "we found that @xmath165 is nearly even ( up to a spatial phase shift ) for the first time at @xmath166 .",
    "this was our initial guess for @xmath42 .",
    "the phase shift required to make @xmath71 approximately even and @xmath72 approximately odd was found by graphically solving @xmath167 .",
    "this gives the initial guess @xmath168 .",
    "this choice of @xmath35 and @xmath36 ( with @xmath169 and @xmath170 as initial conditions ) yields @xmath171 and @xmath172 .",
    "we then minimize @xmath70 holding @xmath173 and @xmath36 constant , which gives @xmath174 and @xmath175 .",
    "we note that @xmath73 is computed over @xmath176 $ ] , twice the time over which the solution was optimized by minimizing @xmath70 , and provides independent confirmation of the accuracy of the solution and the symmetry arguments of  [ sec : obj : fun ] .",
    "the results are plotted in figure  [ fig : evol : kdv3 ] .",
    "we omit a plot of the initial guess ( the collision of stokes waves ) as it is indistinguishable from the minimized solution .",
    "in fact , the relative change in the wave profile and velocity potential is about @xmath177 percent , @xmath178 and @xmath42 changes even less , from 554.057 ( stokes ) to 554.053 ( periodic ) . by construction ,",
    "@xmath173 and @xmath179 do not change at all .",
    "it was not necessary to evolve the stokes waves to @xmath42 , shift space by @xmath179 , zero out fourier modes that violate the symmetry condition ( [ eq : init ] ) , and reset @xmath8 to correspond to this new initial state .",
    "doing so increases the decay rate of the fourier modes ( slope of @xmath180 vs @xmath79 ) by a factor of 1.24 in this example , compared to 3.36 in the previous example , where it is definitely worthwhile .",
    "a relative - periodic solution found using a superposition of the stokes waves labeled b and c in figure  [ fig : bif : stokes ] as a starting guess . unlike the previous case",
    ", the waves do not fully merge at @xmath130 . ]",
    "the large change from @xmath181 to @xmath182 is due to nonlinear interaction of the waves .",
    "there are two main factors contributing to this change in period .",
    "the first is that the waves do not fully combine when they collide .",
    "instead , the trailing wave runs into the leading wave , passing on much of its amplitude and speed .",
    "the peaks remain separated by a distance of @xmath183 at @xmath130 , the transition point where the waves have the same amplitude .",
    "thus , the peak separation changes by @xmath184 rather than @xmath44 in half a period .",
    "the second effect is that the larger wave slows down the smaller wave more than the smaller slows the larger .",
    "recall from fig .",
    "[ fig : aandc ] that each wave induces a negative potential gradient across the other wave that generates a background flow opposing its direction of travel .",
    "quantitatively , when the waves are well separated , we find that the taller and smaller waves travel at speeds @xmath185 and @xmath186 , respectively .",
    "the relative speed is then @xmath187 .",
    "thus , @xmath188 with numerical values @xmath189 .",
    "this means that both effects together have overestimated the correction needed to obtain @xmath35 from @xmath162 .",
    "this is because the relative speed slows down as the waves approach each other , which is expected since the amplitude of the trailing wave decreases and the amplitude of the leading wave increases in this interaction regime .",
    "indeed , the average speed of the waves is @xmath190 which are slightly smaller and larger , respectively , than their speeds when well separated .",
    "note that @xmath42 in ( [ eq : ineq ] ) may be written @xmath191 .",
    "we used @xmath192 in ( [ eq : average : speed ] ) to account for the 20 times the waves cross the domain @xmath193 in time @xmath42 in addition to the offset shown in figure  [ fig : evol : kdv3 ] .",
    "in the previous section , we observed two types of overtaking collisions for the water wave : one in which the larger wave completely subsumes the smaller wave for a time , and one where the two waves remain distinct throughout the interaction .",
    "similar behavior has of course been observed for the korteweg - de vries equation , which was part of our motivation for looking for such solutions .",
    "lax @xcite classified overtaking collisions of two kdv solitons as bimodal , mixed , or unimodal .",
    "unimodal and bimodal waves are analogous to the ones we computed above , while mixed mode collisions have the larger wave mostly subsume the smaller wave at the beginning and end of the interaction , but with a two - peaked structure re - emerging midway through the interaction .",
    "lax showed that if @xmath194 , the collision is bimodal ; if @xmath195 , the collision is unimodal ; and if @xmath196 , the collision is mixed . here",
    "@xmath197 and @xmath198 are the wave speeds of the trailing and leading waves , respectively , at @xmath199 .",
    "leveque @xcite has studied the asymptotic dynamics of the interaction of two solitons of nearly equal amplitude .",
    "zou and su @xcite performed a computational study of overtaking water wave collisions , compared the results to kdv interactions , and found that the water wave collisions ceased to be elastic at third order .",
    "craig _ et .",
    "@xcite also found that solitary water waves collide inelastically .",
    "this does not conflict with our results since we optimize the initial conditions to make the collision elastic .",
    "head on collisions have been studied numerically by su and mirie @xcite , experimentally by maxworthy @xcite , and by a mixture of analysis and computation by craig _ et .",
    "_ @xcite .",
    "validation of kdv as a model of water waves has also been studied extensively .",
    "a formal derivation may be found in ablowitz and segur @xcite .",
    "rigorous justification has been given by bona , colin and lannes @xcite , building on earlier work by craig @xcite as well as schneider and wayne @xcite . according to @xcite",
    ", some gaps still exist in the theory in the spatially periodic case .",
    "experimental studies of the validity of kdv for describing surface waves have been performed by zabusky and galvin @xcite as well as hammack and segur @xcite .",
    "recently , ostrovsky and stepanyants @xcite have compared internal solitary waves in laboratory experiments to the predictions of various model equations , including kdv , and give a comprehensive overview of the literature on this subject @xcite .",
    "our objective in this section is to determine quantitatively whether the solutions of the water wave equations that we computed in ",
    "[ sec : num ] are well - approximated by the kdv equation .",
    "following ablowitz and segur @xcite , we introduce a small parameter @xmath200 and dimensionless variables @xmath201 where @xmath153 is the fluid depth .",
    "we assume the bottom boundary is at @xmath202 rather than 0 in this derivation , so that @xmath203 runs from @xmath204 to @xmath205 .",
    "the laplacian becomes @xmath206 , which allows for @xmath207 to be computed order by order , with leading terms satisfying @xmath208 here we used @xmath209 and @xmath210 .",
    "note that @xmath211 is independent of @xmath203 , and agrees with the velocity potential @xmath14 on the bottom boundary , up to rescaling : @xmath212 from the equations of motion , @xmath213 and @xmath214 , one finds that @xmath215 where @xmath216 . expanding @xmath217 , @xmath218 , we find that @xmath219 where we have introduced characteristic coordinates @xmath220 , @xmath221 as well as a slow time scale @xmath222 to eliminate secular growth in the solution with respect to @xmath223 and @xmath224 at first order in @xmath200 ; see @xcite for details . the notational conflict of @xmath225 with the acceleration of gravity , @xmath226 , is standard , and will not pose difficulty below .",
    "comparison of the solutions of the kdv and euler equations , initialized identically with the superposition of stokes waves labeled a and b in figure  [ fig : bif : stokes ] .",
    "the final time @xmath35 is set to @xmath126 , as in fig .",
    "[ fig : align : stokes ] , when the euler solution nearly returns to its initial configuration after a single overtaking collision . ]    in our case , the waves travel to the right , so we may set @xmath227 in the formulas above . returning to dimensional variables , we then have @xmath228 which satisfies @xmath229 where @xmath230 .",
    "note that @xmath200 drops out .",
    "for comparison with the results of  [ sec : num ] , we will add @xmath153 to @xmath165 and set @xmath231 instead . in figure",
    "[ fig : kdv : cmp1 ] , we compare the solution of ( [ eq : dim : kdv ] ) , with initial condition @xmath232 , defined similarly to @xmath233 in ( [ eq : aandc ] ) , to the solution of the free - surface euler equations shown in figs .",
    "[ fig : align : stokes ] and  [ fig : evol : kdv1 ] .",
    "shortly after the waves are set in motion , the kdv solution develops high - frequency oscillations behind the larger peak that travel left and quickly fill up the computational domain with radiation .",
    "the solution of the euler equations remains much smoother .",
    "the large peak of the kdv solution also travels @xmath234 faster , on average , than the corresponding peak of the euler solution , so that at @xmath235 , when the taller euler wave has traversed the domain 6 times , the taller kdv wave has traversed it @xmath236 times . for our purposes , these discrepancies are much too large for kdv to be a useful model , and we conclude that the first example in  [ sec : num ] is well outside of the kdv regime .    in this comparison ,",
    "timestepping the kdv equation was done with the 8 stage , 5th order implicit / explicit runge - kutta method of kennedy and carpenter @xcite .",
    "spatial derivatives were computed spectrally using the 36th order filter of hou and li @xcite .",
    "we found that 2048 spatial grid points and 96000 timesteps was sufficient to reduce the error at @xmath235 below @xmath237 near the larger peak and below @xmath238 elsewhere , based on comparing the solution to one with 3072 grid points and 192000 timesteps .",
    "our solutions of the euler equations are much more accurate since there are no second or third spatial derivative terms present to make the equations stiff .",
    "thus , we can use 8th or 15th order explicit timestepping rather than 5th order implicit / explicit timestepping .",
    "monitoring energy conservation and performing mesh refinement studies suggests that we obtain 1314 digits of accuracy in the solutions of the euler equations , at which point roundoff error prevents further improvement in double - precision arithmetic .",
    "comparison of the solutions of the kdv and euler equations , both initialized with the superposition of stokes waves labeled b and c in figure  [ fig : bif : stokes ] .",
    "@xmath239 here . ]    in figure  [ fig : kdv : cmp2 ] , we repeat this computation using initial conditions corresponding to the superposition of stokes waves @xmath240 , which was used as a starting guess for the second example of  [ sec : num ] .",
    "this time the kdv solution does not develop visible high - frequency radiation in the wave troughs , and the solutions of kdv and euler remain close to each other for much longer .",
    "however , the interaction time for a collision also increases , from @xmath141 in the first example to @xmath239 here . in fig .",
    "[ fig : kdv : cmp2 ] , by @xmath241 , the taller kdv and euler waves have visibly separated from each other , and by @xmath130 , when the euler waves have reached their minimum approach distance , the kdv solution is well ahead of the euler solution .",
    "thus , while there is good qualitative agreement between the kdv and euler solutions , they do not agree quantitatively over the time interval of interest .",
    "from this point of view , the second example of  [ sec : num ] also lies outside of the kdv regime .",
    "an alternative measure of the agreement between kdv and euler is to compare the solutions from  [ sec : num ] with nearby relative - periodic solutions of kdv . in other words ,",
    "we wish to quantify how much the initial conditions and period have to be perturbed to convert a relative - periodic solution of the euler equations into one for the kdv equations .",
    "since we used a superposition of stokes waves for the initial guess to find time - periodic and relative - periodic solutions of the euler equations , we will use a similar superposition ( of cnoidal waves ) for kdv .",
    "the vertical crest - to - trough heights of the three stokes waves considered in  [ sec : num ] are @xmath242 well - known @xcite periodic traveling wave solutions of ( [ eq : dim : kdv ] ) are given by @xmath243\\sqrt{gh},\\end{gathered}\\ ] ] where we added @xmath153 to @xmath165 to match the change in @xmath244 from @xmath245 to @xmath246 in ( [ eq : dim : kdv ] ) . here",
    "@xmath247 and @xmath248 are the complete elliptic integrals of the first and second kind , respectively , and @xmath249 is one of the jacobi elliptic functions @xcite . in our case @xmath112 , @xmath15 and @xmath107 .",
    "for each @xmath250 in ( [ eq : h : abc ] ) , we solve the @xmath251 equation for @xmath252 using mathematica @xcite , and then evaluate @xmath253 on a uniform grid that is fine enough that its fourier coefficients decay below machine roundoff .",
    "the values of @xmath254 are @xmath255 this approach requires extended precision arithmetic to compute @xmath252 and evaluate @xmath165 , but the running time takes only a few seconds on a typical laptop .",
    "a periodized version of the simpler @xmath9 formula could be used for the first two waves , but decays too slowly for wave @xmath256 to be spatially periodic to roundoff accuracy .",
    "once these cnoidal waves have been computed , we superpose their initial conditions to form @xmath257 and @xmath258 , just as in  [ sec : num ] .",
    "it is well - known that a superposition of @xmath3 cnoidal waves retain this form when evolved via kdv , with @xmath3 amplitude and @xmath3 phase parameters governed by an ode describing pole dynamics in the complex plane @xcite . in the @xmath0 case , the solutions are relative - periodic .",
    "comparison of time - periodic solution found in ",
    "[ sec : num ] to nearby relative - periodic two phase cnoidal solution of kdv .",
    "the periods are @xmath147 and @xmath259 , respectively . ]",
    "comparison of relative - periodic solution found in ",
    "[ sec : num ] to nearby relative - periodic two phase cnoidal solution of kdv .",
    "the periods are @xmath239 and @xmath260 , respectively . ]",
    "figures  [ fig : kdv : cmp5 ] and  [ fig : kdv : cmp4 ] compare the time - periodic and relative - periodic solutions of the euler equations , computed in  [ sec : num ] , to these cnoidal solutions of kdv . since the periods are different , only the initial conditions are compared . in the larger - amplitude example , shown in fig .",
    "[ fig : kdv : cmp5 ] , the euler solution is not as flat in the wave trough as the cnoidal solution due to an additional oscillatory component ( the `` tuned '' radiation ) . from the difference plot in the right panel , we see that the crest - to - trough amplitude of these higher frequency oscillations is roughly @xmath261 , or @xmath262 of the wave height @xmath263 .",
    "the euler solution is time - periodic with period @xmath264 while the cnoidal solution is relative - periodic , returning to a spatial phase shift of its initial condition at @xmath265 , which differs from @xmath266 by @xmath267 . in the smaller - amplitude example , shown in fig .",
    "[ fig : kdv : cmp4 ] , both solutions have smooth , flat wave troughs , and it is difficult to distinguish one from the other in the left panel .",
    "the crest - to - trough amplitude of the difference in the right panel is roughly @xmath268 , or @xmath269 of @xmath270 .",
    "the relative change in period is @xmath271 .",
    "while the left panels of figures  [ fig : kdv : cmp5 ] and  [ fig : kdv : cmp4 ] show close agreement between relative - periodic solutions of the euler and kdv equations at @xmath8 , it should be noted that the wave amplitudes of the cnoidal solutions were chosen to minimize the discrepancy in these figures .",
    "the change in period by @xmath267 and @xmath272 , respectively , is perhaps a better measure of agreement .",
    "comparison of kdv and euler solutions , both initialized with a 2-phase cnoidal wave with peaks matching the heights of the stokes waves labeled a and b ( left ) or b and c ( right ) in fig .",
    "[ fig : bif : stokes ] .",
    "here @xmath147 ( left ) and @xmath273 ( right ) . ]    a final comparison of the two equations is made in fig .",
    "[ fig : kdv : cmp7 ] , where we evolve the euler equations with the kdv initial conditions .",
    "this requires an initial condition for @xmath274 , where we have suppressed @xmath29 in the notation for this discussion since it is held fixed at 0 .",
    "based on the derivation presented above , we first solve @xmath275 $ ] for @xmath14 on the bottom boundary .",
    "we then use the approximation @xmath276 to evaluate @xmath14 on the free surface . in the left panel of figure  [ fig : kdv : cmp7 ] , the larger wave grows and overturns before @xmath277 when evolved under the euler equations , instead of traveling to the right when evolved via kdv . to handle wave",
    "breaking , we switched to an angle - arclength formulation of the free - surface euler equations @xcite . in the small - amplitude example in the right panel ,",
    "the euler solution develops visible radiation and falls slightly behind the kdv solution , although the phases are closer at @xmath42 than the result of evolving the stokes waves under kdv in figure  [ fig : kdv : cmp2 ] .",
    "we also tried evaluating @xmath278 at @xmath279 to obtain the initial condition for @xmath280 , where @xmath281 are the fourier modes of @xmath282 at @xmath8 , but the results were worse for the large - amplitude example  the wave breaks more rapidly  and were visually indistinguishable in the small - amplitude example from the results plotted in fig .",
    "[ fig : kdv : cmp7 ] .    in summary , the large - amplitude time - periodic solution of the euler equations found in ",
    "[ sec : num ] is well outside of the kdv regime by any measure , and the small - amplitude relative - periodic solution is closer , but not close enough to achieve quantitative agreement over the entire time interval of interest .",
    "we have demonstrated that the small amount of background radiation produced when two stokes waves interact in shallow water can often be tuned to obtain time - periodic and relative - periodic solutions of the free - surface euler equations . just as for the korteweg - de vries equation , the waves can fully merge when they collide or remain well - separated .",
    "however , the comparison is only qualitative as the waves are too large to be well - approximated by kdv theory .    in future work",
    ", we will study the stability of these solutions using floquet theory .",
    "preliminary results suggest that the first example considered above is unstable to harmonic perturbations while the second example is stable . in the stable case",
    ", an interesting open question is whether the stokes waves used as a starting guess for the minimization algorithm , which have the same energy as the relative - periodic solution found , might remain close to it forever , executing almost - periodic oscillations around it . presumably @xmath36 would need to be varied slightly for this to be true , since @xmath36 is a free parameter that we selected by hand to obtain a small value of @xmath73 for the initial guess .",
    "another open question is whether there are analogues for the euler equations of @xmath3-phase quasi - periodic solutions of the kdv equation with @xmath283 .",
    "we are confident that the methods of this paper could be used to construct degenerate cases of @xmath283 solitary water waves colliding elastically in a time - periodic or relative - periodic fashion , along the lines of what was done for the benjamin - ono equation in @xcite .",
    "computing more general quasi - periodic dynamics of the form @xmath284 , @xmath285 with @xmath286 and @xmath5 , @xmath6 , @xmath7 seems possible in principle using a more sophisticated shooting method to determine @xmath250 , @xmath287 and @xmath6 .",
    "existence of such solutions for the euler equations would show that non - integrable equations can also support recurrent elastic collisions even if they can not be represented as @xmath3-phase superpositions of elliptic functions ."
  ],
  "abstract_text": [
    "<S> we compute time - periodic and relative - periodic solutions of the free - surface euler equations that take the form of overtaking collisions of unidirectional solitary waves of different amplitude on a periodic domain . as a starting guess , we superpose two stokes waves offset by half the spatial period . using an overdetermined shooting method , </S>",
    "<S> the background radiation generated by collisions of the stokes waves is tuned to be identical before and after each collision . in some cases , </S>",
    "<S> the radiation is effectively eliminated in this procedure , yielding smooth soliton - like solutions that interact elastically forever . </S>",
    "<S> we find examples in which the larger wave subsumes the smaller wave each time they collide , and others in which the trailing wave bumps into the leading wave , transferring energy without fully merging . </S>",
    "<S> similarities notwithstanding , these solutions are found quantitatively to lie outside of the korteweg - de vries regime . </S>",
    "<S> we conclude that quasi - periodic elastic collisions are not unique to integrable model water wave equations when the domain is periodic .    </S>",
    "<S> = 1 </S>"
  ]
}