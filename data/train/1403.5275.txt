{
  "article_text": [
    "image registration is an important challenging topic in image processing .",
    "it consists mainly in finding a suitable transformation between two images ( or image data ) , called _ source _ and _ target images _ , taken either at different times or from different sensors or viewpoints .",
    "the scope is to determine a transformation such that the transformed version of the source image is similar to the target one .",
    "there is a large number of applications demanding image registration , including astronomy , biology , computer vision , genetics , physics , medicine , robotics , to name a few . for an overview , see e.g. @xcite and references therein . in medicine , for example",
    ", registration is required for combining different modalities ( x - ray , computer tomography ( ct ) , magnetic resonance imaging ( mri ) and positron emission tomography ( pet ) images , for instance ) , monitoring of diseases , treatment validation , comparison of the patient s data with anatomical atlases , and radiation therapy .",
    "in particular , the _ landmark - based image registration _",
    "process is based on two finite sets of landmarks , i.e. sparse data points located on images , usually not uniformly distributed , where each landmark of the source image has to be mapped onto the corresponding landmark of the target image ( see @xcite ) .",
    "now , in order to give a more formal idea , we consider the sets @xmath0 and @xmath1 each containing @xmath2 point - landmarks in the source and target images , respectively .",
    "thus , the registration problem involves a transformation @xmath3 , such that @xmath4 where each coordinate @xmath5 of the transformation function @xmath6 is separately calculated , that is , the interpolation problem involving @xmath7 is solved for @xmath8 , with the corresponding conditions @xmath9 , @xmath10 .",
    "this problem can be formulated in the context of multivariate scattered data interpolation , and solved by different techniques , among which radial basis functions ( rbfs ) play a preminent role ( see , e.g. , @xcite ) .",
    "the use of rbf transformations , in particular of the thin plate splines , for point - based image registration was first proposed by bookstein @xcite , and it is still common ( see @xcite and the software package mipav @xcite ) .",
    "a number of authors have investigated the most popular radial basis function transformations in the image registration context : thin plate spline @xcite , multiquadric @xcite , inverse multiquadric @xcite , and gaussian transformations @xcite . a more specific application which involves registration and includes",
    "imaging techniques , such as computer tomography and magnetic resonance imaging , can be found in @xcite .    since using globally supported rbfs , as for example the gaussians , a single landmark pair change may influence the whole registration result , in the last two decades several methods have been presented to circumvent this disadvantage , such as weighted least squares and weighted mean methods ( wlsm and wmm , respectively ) @xcite , compactly supported radial basis functions ( csrbfs ) , especially wendland s and gneiting s functions @xcite , and elastic body splines ( ebss ) @xcite .",
    "a certain number of papers have been dedicated to recall and compare these methods for nonrigid image registration : main contributions , advantages and drawbacks of radial basis functions , compactly supported radial basis functions and elastic body splines are mentioned in @xcite ; thin plate splines , multiquadrics , piecewise linear and weighted mean transformations are explored and their performances are compared in @xcite ; finally , radial basis functions , wendland s functions and elastic body splines are reviewed , together with b - splines and wavelets , in @xcite .",
    "several authors have shown the superiority of local registration methods over the global ones in some situations , for instance , in medical imaging and in airborne imaging .",
    "in fact , a global mapping can not properly handle images locally deformed .",
    "for this reason , more recently , local methods , already known in interpolation theory , have been proposed in landmark - based image registration : the modified shepard s method ( also known as the inverse distance weighted method ( idwm ) ) @xcite , and lobachevsky spline method @xcite .",
    "these interpolation techniques , giving rise to local mappings , handle well images locally deformed . moreover , they are in general stable and the computational effort to determine transformations is low and , therefore , a large number of landmarks can be used .    in this paper",
    "we focus , from a mathematical point of view , on properties and performances of some local interpolation schemes for landmark - based image registration .",
    "precisely , we consider modified shepard s interpolants , wendland s functions , and lobachevsky splines .",
    "they are quite unlike each other , but all of them are compactly supported and enjoy interesting theoretical and computational properties ( see @xcite ) . in particular , we point out some unusual forms of the considered functions . moreover , referring to wendland s functions , we consider for the first time in this context , as far as we know , compactly supported interpolants given by products of univariate wendland s functions @xcite .",
    "all these methods are also compared with gaussians and thin plate splines , which are globally supported but are still among the most widely used methods in applications .",
    "numerical experiments point out differences in accuracy and smoothness of the considered methods",
    ". the comparison can be useful to users in the choice of the appropriate transformation for their scopes .",
    "moreover , since some schemes need parameters , our numerical tests might be of interest in the choice of them .",
    "the paper is organized as follows .",
    "section 2 introduces some preliminaries : the landmark - based registration problem and the solvability of the associated interpolation problem . in section 3",
    "we briefly recall radial basis functions , like gaussians , multiquadrics , inverse multiquadrics and thin plate splines to construct globally supported transformations .",
    "section 4 is devoted to describe local transformations , given by the modified shepard s formula which uses rbfs as local approximants . in section 5",
    "wendland s functions are presented to define compactly supported transformations , whereas in section 6 we focus on lobachevsky splines which define again compactly supported transformations .",
    "finally , section 7 contains several numerical results obtained in some test and real - life examples : special emphasis is devoted to comparing accuracy of local interpolation schemes and to determining optimal values of parameters .",
    "let @xmath11 be a given set of landmarks in the source image @xmath12 and let @xmath13 be the given set of corresponding landmarks in the target image @xmath14 .",
    "the registration problem reads as follows .",
    "[ lit ] let the landmark sets @xmath15 and @xmath16 be given .",
    "find a transformation @xmath17 within a suitable space @xmath18 of admissible functions , such that @xmath19    each coordinate @xmath5 of the transformation function is calculated separately , i.e. the interpolation problem @xmath7 is solved for each @xmath8 , with the corresponding conditions @xmath20 in order to have a class of basis functions that generate non - singular interpolation matrices for any set of distinct points , we introduce the concept of strictly positive definite functions @xcite .",
    "we suppose that the interpolant @xmath21 has the form @xmath22 @xmath23 being the coefficients to be found .",
    "a necessary condition to have unique solvability of the interpolation problem @xmath24 is given by the following result @xcite .",
    "[ nec_cond ] the interpolation problem ( [ ic ] ) , where @xmath5 is of the form ( [ intform ] ) , has a unique solution if the function @xmath25 is strictly positive definite on @xmath26 , that is @xmath27 for any @xmath2 pairwise different points @xmath28 , and @xmath29^t\\in { \\mathbb{r}}^n$ ] , @xmath30 .",
    "moreover , we remark that theorem [ nec_cond ] is also satisfied for a strictly conditionally positive definite function @xmath25 of order @xmath31 if the quadratic form ( [ real_positive_definite_function ] ) holds and @xmath32 for any polynomial @xmath33 of degree at most @xmath34 .    finally , we give the following theorem which allows us to construct multivariate strictly positive definite functions from univariate ones ( see , e.g. , @xcite ) .",
    "[ spdf_dd ] suppose that @xmath35 are strictly positive definite and integrable functions on @xmath36 , then @xmath37 is a strictly positive definite function on @xmath26 .",
    "in this section we consider globally supported radial basis functions , which are well - known in the field of approximation theory and scattered data interpolation ( see @xcite ) , and widely used in landmark - based image registration as well ( see , e.g. , @xcite and references therein ) .",
    "using radial basis functions , the general coordinate @xmath38 , @xmath39 of the transformation function is assumed to have the form @xmath40 where @xmath41 is a radial basis function depending only on the euclidean distance @xmath42 , and @xmath43 and @xmath44 are coefficients to be determined .",
    "the space @xmath45 @xmath46 @xmath47 @xmath48 @xmath49@xmath50 , where the @xmath51 are a basis of polynomials up to degree @xmath34 , has dimension @xmath52 , which must be lower than @xmath2 . therefore , in order to compute the coefficients @xmath53 and @xmath54 in ( [ s ] ) , it is required to solve the following system of linear equations @xmath55 where @xmath56 is a @xmath57 matrix , @xmath58 is a @xmath59 matrix , and @xmath60 denotes the column vector of the @xmath61-th coordinate of the target point - landmarks @xmath62 corresponding to the image point - landmarks @xmath63",
    ". equations ( [ sist ] ) are obtained by requiring that @xmath64 satisfies the interpolation conditions ( [ interp ] ) and the side conditions @xmath65 , for @xmath66 , i.e. @xmath67 .    the most popular choices for @xmath68 in landmark - based registration are @xmath69 where @xmath70 and @xmath71",
    ". the gaussian ( g ) and the inverse multiquadric ( imq ) , which occurs for @xmath72 in the generalized multiquadric function , are strictly positive definite functions , whereas the thin plate spline ( tps ) and the multiquadric ( mq ) , i.e. for @xmath73 in the generalized multiquadric function , are strictly conditionally positive definite functions of order @xmath74 .",
    "the addition of a polynomial term of a certain order along with side conditions , in order to guarantee existence and uniqueness of the solution in the linear equation system ( [ sist ] ) , is required only for strictly conditionally positive definite functions .",
    "it allows us to have a nonsingular interpolation matrix . for thin plate spline",
    "the order of the polynomial is 1 and for multiquadric depends on the exponent @xmath74 , the minimal degree being @xmath75 .",
    "polynomials have global support and therefore the polynomial part influences globally the registration result",
    ".    an important feature of some radial basis functions is the presence of a shape parameter , which allows us to control their influence on the registration result @xcite . on the other hand",
    "this property could be seen as a drawback , because the user needs to give the parameter value . also for this reason the thin plate spline",
    "is usually considered more suitable than other rbfs for image registration , since this process of image registration must sometimes be automatic .",
    "the thin plate spline seems to be preferable to other radial basis functions for image registration also for other reasons ( see , in particular , @xcite and references already cited ) .",
    "the thin plate spline minimizes a functional which represents the bending energy of a thin plate separately for each component @xmath5 , @xmath8 , of the transformation @xmath64 .",
    "thus , the functional @xmath76 can be separated into a sum of similar functionals that only depend on one component @xmath5 of * f * , and the problem of finding * f * can be decomposed into @xmath77 problems @xcite .",
    "note that the interpolation matrices generated by radial basis functions are dense , since they are globally supported , and ill - conditioned @xcite , especially those generated by gaussian .",
    "ill - conditioning could happen even if it is required to interpolate a relatively small number of landmarks , since the landmarks may be very close to each other .",
    "another possible disadvantage of the use of rbfs is given by the number of floating - point operations , which can be very time consuming , especially if the number of landmarks is high or the registration of 3d images is needed .",
    "shepard s method or inverse distance weighted method is commonly used for multivariate interpolation and approximation of scattered data . in the literature , many versions of this method can be found ( see @xcite for an overview ) . here",
    ", we consider a modified version of shepard s method , which is local and uses radial basis functions as local approximants ( see @xcite ) . this interpolant has been already successfully used in landmark - based registration context @xcite .    referring to the context of landmark - based image registration",
    ", we define the @xmath61-th coordinate of a modified shepard s transformation @xmath3 in the form @xmath78 the _ nodal functions _ @xmath79 , @xmath10 , are local approximants at @xmath63 , constructed on the @xmath80 source landmarks closest to @xmath63 and satisfying the interpolation conditions @xmath81 . the weight functions",
    "@xmath82 , @xmath10 , are given by @xmath83 where @xmath84 @xmath85 , and @xmath86 is a non - negative localizing function defined by @xmath87 @xmath88 being the hypercube of centre at @xmath63 and side @xmath89 . note that the choice of the hypercube side @xmath89 may not be unique , being partially empirical .    in this way , each component @xmath5 , @xmath8 , is evaluated at @xmath90 considering only a certain number @xmath91 of landmarks closest to @xmath90 .",
    "the weights @xmath92 given in ( [ sh ] ) satisfy the cardinality relations @xmath93 where @xmath94 is the kronecker delta , and give a partition of unity , namely @xmath95    in ( [ sh ] ) we take the local approximants @xmath79 , @xmath10 , as local rbf interpolants , of the form @xmath96 where the radial basis functions @xmath97 depend only on the @xmath80 source landmark points of the considered neighborhood of @xmath63 , the index @xmath98 refers to and renumbers the landmark points of the neighborhood of @xmath99 , and the space @xmath45 spanned by the ( @xmath34)-degree polynomials @xmath100 has a dimension @xmath52 which must be lower than @xmath80 .",
    "it is required that @xmath79 satisfies the interpolation conditions @xmath101 and the side conditions @xmath102 hence , to compute the coefficients @xmath103 and @xmath104 in ( [ rbf ] ) , it is required to solve uniquely the system of linear equations @xmath105 where @xmath106 is a @xmath107 matrix , @xmath108 is a @xmath109 matrix , and @xmath110 denotes the column vector of the target landmark points @xmath62 corresponding to the @xmath63 .",
    "registration results obtained using local radial basis functions ( in particular thin plate spline and gaussian ) point out that the local transformation technique compares well with the global one , and in some cases it is superior . in particular ,",
    "the former is preferable when the number of landmarks is large , since its main features are locality and stability @xcite .",
    "the drawback of the technique is the need of a empirical determination of the local parameters @xmath80 and @xmath91 .",
    "in this section we focus on probably the most known family of compactly supported radial basis functions , namely wendland s functions ( see @xcite ) .",
    "they have been introduced in image registration context with the motivation that their influence around a landmark is limited , in 2d and 3d images on a circle or a sphere , respectively @xcite .",
    "this property allows us the registration of medical images where changes occur only locally .",
    "here we propose also the use of compactly supported radial basis functions defined by products of univariate wendland s functions .",
    "some numerical tests using this type of functions , have pointed out their better accuracy but worse stability in comparison with multivariate wendland s functions @xcite , the support being a square or a cube , in 2d or 3d setting .",
    "wendland s functions are obtained by using the truncated power function @xmath111 ( where @xmath112 is defined as @xmath113 for @xmath114 and @xmath115 for @xmath116 ) , which is strictly positive definite and radial on @xmath26 for @xmath117 , and repeatedly applying the operator @xmath118 given by @xmath119 , @xmath120 ( see , e.g. , @xcite ) .",
    "then , wendland s functions are given by @xmath121    specifically , they are all supported on the interval @xmath122 $ ] and have a polynomial representation there .",
    "in addition to this , the following theorem states that any other compactly supported @xmath123 polynomial function that is strictly positive and radial on @xmath124 will not have a smaller polynomial degree .",
    "finally , they have minimal degree with respect to a given space dimension @xmath77 and smoothness @xmath125 @xcite .",
    "the functions @xmath126 are strictly positive definite and radial on @xmath26 and are of the form @xmath127,\\\\ \\nonumber 0 , & \\mbox { } \\   r > 1 ,   \\nonumber \\end{array } \\right.\\ ] ] with a univariate polynomial @xmath128 of degree @xmath129 .",
    "moreover , @xmath130 are unique up to a constant factor , and the polynomial degree is minimal for given space dimension @xmath77 and smoothness @xmath125 .",
    "though there exist recursive formulas to compute the functions @xmath126 for all @xmath77 and @xmath131 , here for convenience we only give explicit forms of @xmath126 , for @xmath132 .",
    "the functions @xmath126 , @xmath132 , have the form @xmath133,\\\\ \\nonumber \\varphi_{m,2}(r ) \\doteq \\left ( 1-r\\right)_+^{s+2}\\left[\\left(s^2 + 4s+3\\right)r^2+\\left(3s+6\\right)r+3\\right],\\\\ \\nonumber \\varphi_{m,3}(r ) \\doteq \\left ( 1-r\\right)_+^{s+3 } \\left[\\left(s^3 + 9s^2 + 23s+15\\right)r^3+\\left(6s^2 + 36s+45\\right)r^2+\\left(15s+45\\right)r+15\\right ] , \\nonumber \\end{array } \\right.\\ ] ] where @xmath134 , and the symbol @xmath135 denotes equality up to a positive constant factor .",
    "since wendland s functions are compactly supported , the interpolation matrices can be made sparse by appropriately scaling the support of the basic function . in the following",
    "we can consider only wendland s functions depending on a shape parameter @xmath136 .",
    "using for simplicity the symbol @xmath126 as in theorem 5.2 , we list some of the most commonly used functions for @xmath137 along with their degree of smoothness @xmath125 , that is @xmath138 and for @xmath139 , that is @xmath140 we remark that the functions @xmath141 , @xmath142 , are strictly positive definite and radial not only on @xmath143 but also on @xmath26 , for @xmath144 ( see @xcite ) .",
    "referring to the image registration context we can define wendland s transformations in two ways :    * by multivariate radial wendland s functions ; * by products of univariate radial wendland s functions .",
    "[ wetr ] given a set of source landmark points @xmath11 , with associated the corresponding set of target landmark points @xmath13 , a _ wendland s transformation _",
    "@xmath146 is such that each its component @xmath147 assumes one of the following forms @xmath148 and @xmath149 , @xmath150 .    from definition [ wetr ]",
    "it follows that the transformation function @xmath151 @xmath152 is calculated for each @xmath8 , and the coefficients @xmath153 in ( [ lsttr ] ) and ( [ lsttr2 ] ) are to be obtained by solving @xmath77 systems of linear equations .",
    "since we are mainly interested in the bivariate transformation @xmath154 , we take @xmath139 , and so from ( [ lsttr ] ) and ( [ lsttr2 ] ) we have to consider respectively @xmath155 @xmath156 which , imposing the conditions @xmath157 and @xmath158 , for @xmath159 , give two associated linear systems for each of them .    in general , when radial basis functions with compact support are used for landmark - based image registration , a significant reduction of the global influence is observed .",
    "moreover , even significant local deformations can be well registered by this approach .",
    "therefore , their use is advantageous when it allows us to deal with local changes in images , as in medical images @xcite .",
    "in this section we consider a class of spline functions , called _ lobachevsky splines _ , arising in probability theory .",
    "they were introduced by lobachevsky in 1842 ( see , e.g. , @xcite ) and are identical ( up to a scaling factor ) to zero centered uniform b - splines ( see below ) .",
    "the use of lobachevsky splines for interpolation and integration of multivariate scattered data was considered in @xcite and for image registration in @xcite .",
    "the sequence of lobachevsky splines @xmath160 converges for @xmath161 to the normal density function with expectation 0 and standard deviation 1 ( see @xcite ) , i.e. @xmath162 and moreover the convergence is uniform for all @xmath163 .    to get an explicit expression of @xmath164",
    "it is convenient referring to the function @xmath165 , related to @xmath166 by the relation @xmath167 both @xmath166 and @xmath165 can be interpreted as probability density functions having supports on @xmath168 $ ] and @xmath169 $ ] , @xmath170 , respectively .",
    "now , @xmath165 is given by the convolution product @xmath171 because by definition @xmath172 for @xmath173 , and @xmath174 elsewhere .",
    "setting @xmath175 , we get the recursive formula @xmath176    thus , reasoning by induction ( see @xcite ) , we may express @xmath165 , for @xmath177 , by the formula    @xmath178_+^{n-1},\\end{aligned}\\ ] ]    where @xmath179 is the truncated power function",
    ". sometimes it may be convenient to consider a different form of ( [ eq : a5b ] ) , namely @xmath180^{n-1 } , \\end{aligned}\\ ] ] for @xmath181 , and @xmath182 otherwise , where @xmath183 means the greatest integer less than or equal to the argument .    the piecewise function @xmath165 is graphically represented by arcs of parabolas of degree @xmath184 ; the first @xmath185 derivatives of different arcs of parabolas are equal at the knots ( the points where the parabolic pieces are joined ) , i.e. @xmath186 $ ] .",
    "the knots are uniformly spaced with size @xmath187 , and @xmath165 is an even function with support @xmath188 $ ] . in the case",
    "@xmath189 the knots are unit spaced and this class of splines enjoys very interesting applications in signal and image processing , wavelets theory , etc .",
    "( see , e.g. , @xcite ) . from a computational viewpoint",
    "it is convenient to evaluate @xmath165 starting from the pieces defined on @xmath190 $ ] and then obtain the pieces on @xmath191 $ ] by symmetry .",
    "moreover , each piece on @xmath190 $ ] can be obtained by the preceding one by simply adding a term , as clearly appears from ( [ eq : a5a ] ) .    in order to show the connection between the lobachevsky splines and the b - splines ( see @xcite ) , we may consider the following expression @xmath192=\\frac{1}{(n-1)!}\\sum_{k=0}^n(-1)^k\\big(\\displaystyle{n \\atop k}\\big)(t - k)_+^{n-1},\\ ] ] which is a well - known form of the classic b - splines on the support @xmath193 $ ] ( see , e.g. @xcite ) .",
    "lobachevsky splines satisfy a three - term recurrence relation for @xmath194 , namely , @xmath195 ,   \\label{eq : a6c}\\ ] ] which may be interesting from a computational point of view .",
    "in fact , this relation is very stable , whereas ( [ eq : a5b ] ) could suffer from loss - of - significance errors owing to subtraction of nearly equal quantities . note that , for computational reasons , @xmath196 in ( [ eq : a6c ] ) must be taken in the interval @xmath197 .    considering the connection between @xmath198 and @xmath199 ,",
    "the limit ( [ eq : a2 ] ) becomes @xmath200 noteworthy convergence properties are satisfied also by integrals and derivatives of lobachevsky splines . from the central limit theorem for the convergence in distribution ( see ,",
    "e.g. , @xcite ) we have @xmath201 this result is also a direct consequence of ( [ eq : a2 ] ) and lebesgue s dominate convergence theorem .",
    "the asymptotic behaviour of derivatives of lobachevsky splines is described by the following result @xcite @xmath202=d^q \\bigg[\\frac{1}{\\sqrt{2\\pi}}\\exp{\\big(\\frac{-x^2}{2}\\big)}\\bigg],\\nonumber \\label{eq : a6b}\\ ] ] that is , @xmath203 being a fixed integer , the sequence @xmath204 , of the @xmath203-th derivatives of @xmath205 converges to the @xmath203-th derivative of the standardized normal density function .",
    "it is well - known that using gaussians it is convenient to introduce a shape parameter @xmath206 .",
    "this trick can be conveniently applied in our case as well considering @xmath207 instead of @xmath205 . using the shape parameter as a factor has the effect that a decrease of the shape parameter produces flat basis functions , while increasing @xmath206 leads to more peaked ( or localized ) basis functions .",
    "the same result can be achieved considering @xmath198 and acting on the parameter @xmath208 .",
    "numerical computations show that the approximation performance obtained by @xmath199 or @xmath198 are totally equivalent , if the values of the parameters @xmath206 and @xmath208 are conveniently chosen @xcite .    in order to formulate the lobachevsky spline transformation in the context of image registration",
    ", we may consider the following definition ( see @xcite ) .",
    "[ ddd ] given a set of source landmark points @xmath11 , with associated the corresponding set of target landmark points @xmath13 , a _ lobachevsky spline transformation _",
    "@xmath146 is such that each its component @xmath210 takes the form @xmath211 where @xmath212 @xmath165 is given in ( [ eq : a5b ] ) , @xmath213 is even , @xmath214 is any point in @xmath26 , and @xmath215 is a data site .",
    "note that @xmath216 in ( [ lst ] ) is a linear combination of the product of univariate shifted strictly positive define functions @xmath217 , which are spline functions with compact supports @xmath218 $ ] and continuous up to @xmath185 derivatives .",
    "furthermore , we remark that @xmath216 might also be expressed as a linear combination ( with different coefficients @xmath219 ) of the product of the shifted strictly positive define functions @xmath220 , whose compact supports are @xmath221 $ ] .",
    "referring to definition [ ddd ] , we observe that the transformation function @xmath222 @xmath152 has to be calculated for each @xmath8 , and the parameters @xmath153 ( or @xmath219 ) in ( [ lst ] ) are to be obtained by solving @xmath77 systems of linear equations . since we are mainly interested in the bivariate transformation @xmath223 , we take @xmath139 in ( [ lst ] ) , requiring that @xmath224 solves problem [ lit ] .",
    "therefore , we have to consider @xmath225 which , imposing the conditions @xmath226 and @xmath227 , for @xmath159 , gives two associated linear systems .",
    "numerical results in @xcite have shown that lobachevsky splines are accurate and stable in the image registration context .",
    "moreover , being compactly supported , they give rise to sparse interpolation matrices ( for suitable choices of the shape parameters ) .",
    "in this section , we compare the performances of the above recalled methods when applied to give local image transformations . in particular , we consider the modified shepard s formula with local approximants given by gaussian and thin plate spline ( shep - g and shep - tps , respectively ) , wendland s transformations defined by means of bivariate wendland s functions @xmath228 and @xmath229 ( w2 - 2d and w4 - 2d , respectively ) and by means of products of univariate wendland s functions ( w2 - 1d@xmath2301d and w4 - 1d@xmath2301d ) , and lobachevsky spline transformations with @xmath231 ( denoted by l4 and l6 , respectively ) .",
    "moreover , to get a more complete picture , we show also the registration results obtained by gaussian ( g ) and thin plate spline ( tps ) , which are widely used in this context .    in order to test the different local interpolation schemes , we obtain several numerical results on some test cases . here , for brevity , we refer to two test examples given in @xcite .",
    "they simulate typical medical cases where image portions scale or shift .",
    "these image portions represent rigid objects embedded in elastic material changing their position or form .",
    "the approach we propose can cope with local differences between corresponding images .",
    "in general these differences may be caused by the physical deformation of human tissue due to surgeries or pathological processes such as tumor growth or tumor resection .",
    "however , the aim is here to determine a transformation function , which connects the points of the source and target images , so that the target image is affected by the slightest possible deformation .",
    "finally , we briefly present some experimental results obtained by applying gaussian , thin plate spline , lobachevsky splines , bivariate wendland s functions and products of univariate wendland s functions to real image data .",
    "more precisely , we consider two x - ray images of the cervical of an anonymous patient taken at different times .",
    "note that this example has simply an illustrative purpose .",
    "we denote by @xmath232 the set of @xmath233 corner points of a regular grid superimposed on the source images ( see figures [ mi_1 ] and [ new_mi_sti_large ] ) .",
    "the grid is transformed using 32 ( cases 1 and 2 : square shift and scaling , respectively ) and 64 ( cases 3 and 4 : square shift and scaling , respectively ) landmarks and , in the case of square shift , also 4 quasi  landmarks , i.e. landmarks which have the same positions in both source and target images , to prevent an overall shift .",
    "the choice to consider two different pair landmark sets is justified by the necessity of testing the interpolation schemes on different situations : the former with a deformation concentrated in a small region of the image , the latter with a larger deformation , which probably influences the entire image transformation .",
    "the source and target image landmarks , shown in the images in figure [ mi_1 ] and in figure [ new_mi_sti_large ] for both cases , are marked by a circle ( @xmath234 ) and a star ( @xmath235 ) , respectively .                at first",
    ", we analyze the behaviour of the root mean squares error ( rmse ) by varying the shape parameter in each interpolation scheme in order to determine the optimal  value of the parameter , namely the value which gives us the smallest error .",
    "root mean squares error is found computing the distances between the displacements of grid points @xmath236 and the values @xmath237 obtained by the transformations . it assumes the following form    @xmath238    where @xmath239 is the euclidean norm .",
    "it is well - known that the choice of parameter values for a specific method is a very difficult task , because the optimal  values depend , at least to a certain extent , on the actual application .",
    "hence , in order to obtain some general information on the parameter variation , the most suitable way is given by considering geometric models ( squares and circles ) of underlying objects . moreover , for a fixed model the parameter values depend on the set of landmarks , i.e. their number and collocation .",
    "as for the use of the root mean squares error , we remark that rmse is currently considered in the literature as a suitable tool for measuring the performance of an image transformation method ( see , e.g. , @xcite ) .",
    "other performance indices are theoretically possible , but the rmse appears the most practical and effective one .",
    "quantitative graphics for the accuracy of the registration results are shown in figures 36 .",
    "thus , exploiting rmse graphs , we can pick optimal values for the shape parameters and compare the registration results , obtained by applying the different interpolation methods to the test cases 1 - 4 .",
    "their comparison points out goodness and effectiveness of the various approaches from the point of view of errors .",
    "in particular , such graphs are plotted for equispaced values of @xmath240 $ ] for g , shep - g , l4 and l6 ( figures 36 , left ) , and equispaced values of @xmath241 $ ] for w2 - 2d , w4 - 2d , w2 - 1d@xmath2301d and w4 - 1d@xmath2301d ( figures 36 , right ) . here",
    "the choice of the localization parameters for shep - g and shep - tps was @xmath242 and @xmath243 .",
    "$ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ] $ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ]    $ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ] $ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ]    $ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ] $ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ]    $ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ] $ ] ( left ) and @xmath244 $ ] ( right).,title=\"fig : \" ]    in table [ c1_opt ] we report the root mean squares errors ( rmses ) obtained by using the optimal values determined above .",
    "an analysis of errors is difficult , since all the considered interpolation schemes are known to be accurate and , in fact , all errors are of the same orders of magnitude .",
    "however , a comparison of rmses points out that in cases 1 and 3 ( when the square shifts using 32 and 64 landmarks , respectively ) the results are better when thin plate spline , wendland s function w2 ( 2d and 1d@xmath2301d ) and lobachevsky spline l4 are used . in case 2 ( square scaling with 32 landmarks ) , errors are less when compactly supported wendland s functions w2 and w4 - 2d are used , while in case 4 ( square scaling with 64 landmarks ) better accuracy is obtained using w2 and lobachevsky spline l4 .",
    "moreover , we note that , in the comparison of global and local methods , thin plate spline gives better results when the object shifts , whereas the local shepard s method with gaussian is preferable when the object scales , as already shown in @xcite .        ' '' ''    & case 1 & case 2 & case 3 & case 4 +    ' '' ''    g & @xmath245 & @xmath246 & @xmath247 & @xmath248 + @xmath206 & @xmath249 & @xmath250 & @xmath251 & @xmath250 +    ' '' ''    tps & @xmath252 & @xmath253 & @xmath254 & @xmath253 +    ' '' ''    shep - g & @xmath255 & @xmath256 & @xmath257 & @xmath258 + @xmath206 & @xmath259 & @xmath250 & @xmath250 & @xmath250 +    ' '' ''    shep - tps & @xmath260 & @xmath253 & @xmath261 & @xmath253 +    ' '' ''    w2 - 2d & @xmath262 & @xmath263 & @xmath264 & @xmath265 + @xmath266 & @xmath267 & @xmath268 & @xmath267 & @xmath269 +    ' '' ''    w4 - 2d & @xmath270 & @xmath271 & @xmath272 & @xmath273 + @xmath266 & @xmath249 & @xmath251 & @xmath274 & @xmath275 +    ' '' ''    w2 - 1d@xmath2301d & @xmath276 & @xmath277 & @xmath254 & @xmath278 + @xmath266 & @xmath267 & @xmath251 & @xmath249 & @xmath275 +    ' '' ''    w4 - 1d@xmath2301d & @xmath279 & @xmath280 & @xmath281 & @xmath282 + @xmath266 & @xmath267 & @xmath269 & @xmath267 & @xmath274 +    ' '' ''    l4 & @xmath283 & @xmath284 & @xmath285 & @xmath286 + @xmath206 & @xmath249 & @xmath287 & @xmath275 & @xmath250 +    ' '' ''    l6 & @xmath288 & @xmath289 & @xmath290 & @xmath291 + @xmath206 & @xmath251 & @xmath250 & @xmath249 & @xmath250 +    it is well known that also shape and smoothness of the transformed grids may be relevant to compare different transformations . to this aim in the following figures we present registration results obtained by the interpolation methods , using the previously determined optimal values for the parameters . here",
    "we observe significant differences .",
    "registration results involving interpolation schemes w4 - 2d and w4 - 1d@xmath2301d are not represented , since the results are worse than those obtained with the other schemes .    in figure 7",
    "we show registration results obtained by applying the interpolation schemes in the case 1 of square shift when the number of landmarks is 32 .",
    "irregular grids are obtained using g and shep - g , while smoother results are given by tps , shep - tps , lobachevsky splines and wendland s functions . transformed grids visibly smoother",
    "are obtained when tps , shep - tps and w2 - 2d transformations are employed for the shift of a square using 64 landmarks ( see figure 9 ) .",
    "figure 8 and 10 concern the square scaling with 32 and 64 landmarks , respectively . in both cases ,",
    "tps and shep - tps transformations maintain the square form of the image , but the image is visibly enlarged , while the deformation is limited when lobachevsky splines and wendland s functions are used .",
    "moreover , we point out that the condition numbers of interpolation matrices generated by gaussian are very large in both cases , namely @xmath292 .     and @xmath266 . ]",
    "\\(a ) g , @xmath293     and @xmath266 . ]",
    "\\(b ) tps     +     and @xmath266 . ]",
    "\\(c ) shep - g , @xmath294     and @xmath266 . ]",
    "\\(d ) shep - tps     +     and @xmath266 . ]",
    "\\(e ) w2 - 2d , @xmath295     and @xmath266 . ]",
    "\\(f ) w2 - 1d@xmath2301d , @xmath295     and @xmath266 . ]",
    "\\(g ) l4 , @xmath293     and @xmath266 . ]",
    "\\(h ) l6 , @xmath296     +     and @xmath266 . ]",
    "\\(a ) g , @xmath297     and @xmath266 . ]",
    "\\(b ) tps     +     and @xmath266 . ]",
    "\\(c ) shep - g , @xmath297     and @xmath266 . ]",
    "\\(d ) shep - tps     +     and @xmath266 . ]",
    "\\(e ) w2 - 2d , @xmath298     and @xmath266 . ]",
    "\\(f ) w2 - 1d@xmath2301d , @xmath299     and @xmath266 . ]",
    "\\(g ) l4 , @xmath300     and @xmath266 . ]",
    "\\(h ) l6 , @xmath297     +     and @xmath266 . ]",
    "\\(a ) g , @xmath296     and @xmath266 . ]",
    "\\(b ) tps     +     and @xmath266 . ]",
    "\\(c ) shep - g , @xmath297     and @xmath266 . ]",
    "\\(d ) shep - tps     +     and @xmath266 . ]",
    "\\(e ) w2 - 2d , @xmath295     and @xmath266 . ]",
    "\\(f ) w2 - 1d@xmath2301d , @xmath301     and @xmath266 . ]",
    "\\(g ) l4 , @xmath302     and @xmath266 . ]",
    "\\(h ) l6 , @xmath293     +     and @xmath266 . ]",
    "\\(a ) g , @xmath297     and @xmath266 . ]",
    "\\(b ) tps     +     and @xmath266 . ]",
    "\\(c ) shep - g , @xmath297     and @xmath266 . ]",
    "\\(d ) shep - tps     +     and @xmath266 . ]",
    "\\(e ) w2 - 2d , @xmath303     and @xmath266 . ]",
    "\\(f ) w2 - 1d@xmath2301d , @xmath304     and @xmath266 . ]",
    "\\(g ) l4 , @xmath297     and @xmath266 . ]",
    "\\(h ) l6 , @xmath297     +    finally , changing the values of shape parameters , sometimes it is possible to obtain better registration results from the point of view of smoothness . in particular , we focus our attention on compactly supported functions , which seem to be more effective for image registration . in figure 11 we show some transformed grids using lobachevsky l4 and wendland w2 - 2d where the values of parameters are not optimal choices with regard of errors ( @xmath305 and @xmath301 , respectively ) , but such that the registration results are smoother .",
    "rmses are given by @xmath306 and @xmath307 , respectively , and therefore are greater than the errors found using optimal values for the shape parameters .    summing all results and considerations on these test cases , we can say that wendland s functions work particularly well when @xmath308 $ ] .",
    "in fact , in this case , the behavior of rmses varying @xmath266 shows that accuracy is preserved ( see figures 36 ) . for the gaussian",
    "the rmse graphs are flat and all parameter values give equivalent results , but the accuracy is slight better for @xmath309 $ ] .",
    "we observe the same behavior for the graphs of lobachevsky l4 and l6 .",
    "precisely , in test cases 1 and 3 it is better to choose the parameter value in the interval @xmath310 $ ] , whereas in test cases 2 and 4 the choice @xmath309 $ ] seems better .",
    "however , all the considered values give a good approximation and the errors vary very little .",
    "l4        w2 - 2d      in this subsection we consider two opposite radial transformations , that is , the expansion and the contraction of a circle ( see figure [ fig : tumor ] ) .",
    "they may offer very schematic models for the growing and the resection of a tumor in surrounding elastic brain tissue . in these models",
    "( given in @xcite ) the outer circle corresponds to the skull bone , which is assumed to be rigid .",
    "the inner circle represents the boundary of the tumor , whereas the space between the inner and the outer circle is assumed to be filled with elastic material , which corresponds to brain tissue .",
    "the grids are transformed using 20 equidistant landmarks placed on the inner circle and , to prevent an overall shift , also 40 quasi ",
    "landmarks , i.e. landmarks at invariant positions , at the outer circle in the source and target images .",
    "these point - landmarks , shown in figure [ tumor_exp - res ] for the circle expansion ( left ) and the circle contraction ( right ) , are marked by a circle ( @xmath234 ) and a star ( @xmath235 ) , respectively .         in these experiments",
    "we compare at first the registration results obtained by using the modified shepard s method , with tpss as local interpolants , and the global tps method .",
    "hence , taking optimal values for @xmath80 and @xmath91 , in figure 14 we show the registration results obtained by applying tps ( a ) and shep - tps ( b ) .",
    "their comparison mainly points out the goodness and the effectiveness of shepard - type method for this situation ( see also @xcite ) .",
    "specifically , in the circle expansion we consider @xmath311 and @xmath312 for the modified shepard s formula , obtaining a rmse = @xmath313 , while the global approach produces a rmse = @xmath314 . on the other hand , in the circle contraction",
    "the local method yields a rmse = @xmath315 for @xmath316 and @xmath312 , whereas the global one gives a rmse = @xmath317 .",
    "the following figures 14 ( c)(d ) show registration results using wendland w2 - 2d ( @xmath295 and @xmath299 for expansion and contraction , respectively ) and w2 - 1d@xmath2301d ( @xmath318 and @xmath319 , respectively ) .",
    "in particular , in the circle expansion we obtain a rmse = @xmath320 for w2 - 2d and a rmse = @xmath321 for w2 - 1d@xmath2301d , whereas in the circle contraction we have a rmse = @xmath322 for w2 - 2d and a rmse = @xmath323 for w2 - 1d@xmath2301d .",
    "we note that deformations of transformed images using wendland s functions are very large . for the other methods we observe even larger deformations and therefore we present no results .",
    "1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]    \\(a ) tps    1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]",
    "\\(b ) shep - tps     +    1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]",
    "\\(c ) w2 - 2d    1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]",
    "\\(d ) w2 - 1d@xmath2301d     +    1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]",
    "\\(e ) tps    1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]    \\(f ) shep - tps     +    1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]",
    "\\(g ) w2 - 2d    1d ( d ) ; circle contraction : registration results obtained by using tps ( e ) and shep - tps ( f ) , w2 - 2d ( g ) and w2 - 1d@xmath2301d ( h ) . ]",
    "\\(h ) w2 - 1d@xmath2301d     +      in this subsection we shortly present some experimental results obtained by applying gaussians , thin plate splines , lobachevsky splines , bivariate wendland s functions and products of univariate wendland s functions to real image data .",
    "more precisely , we consider two x - ray images of the cervical of an anonymous patient taken at different times .",
    "the aim of this application is to present a real - life example as , to say , that presented by modersitzki in @xcite , an exaustive discussion based on medical and computer science details being left out . in figure 15",
    "we show the two images along with landmarks and quasi - landmarks , setting on the left the source image and on the right the target one .",
    "the size of both images is @xmath324 pixels . in particular , within each of the two images , there have been selected 6 landmarks , whose coordinates are reported in table [ mr_land ] ; moreover , to fix transformation and to prevent an overall shift , 12 quasi - landmarks have been added on the boundaries of the source and target images .        ' '' ''",
    "@xmath98-th landmark & @xmath325 & @xmath326 & @xmath327 & @xmath328 +    ' '' ''    @xmath329 & @xmath330 & @xmath331 & @xmath332 & @xmath333 +    ' '' ''    @xmath334 & @xmath335 & @xmath336 & @xmath337 & @xmath338 +    ' '' ''    @xmath339 & @xmath340 & @xmath341 & @xmath342 & @xmath343 +    ' '' ''    @xmath344 & @xmath345 & @xmath346 & @xmath347 & @xmath346 +    ' '' ''    @xmath348 & @xmath349 & @xmath350 & @xmath351 & @xmath352 +    ' '' ''    @xmath353 & @xmath354 & @xmath355 & @xmath356 & @xmath357 +    each result in figure 16 ( a)(f ) represents a transformed image , obtained using gaussian , thin plate spline , wendland s w2 - 2d , w4 - 2d , w2 - 1d@xmath2301d , lobachevsky spline l4 transformations , respectively . for the gaussian and lobachevsky l4 transformations we have used the parameter value @xmath294 , and for wendland s transformations the value @xmath295 .",
    "we observe that gaussian transformation strongly deforms the image , while using thin plate and lobachevsky splines the deformations are less significant .",
    "better registration results are obtained with the wendland s transformations , especially when we use w2 - 2d .",
    "moreover , we point out that in general classical wendland s transformations ( both w2 - 2d and w4 - 2d ) give less deformations than product wendland s ones , and registration results are better if we use small  values for the parameter @xmath266 .",
    "finally , in order to provide a more precise analysis among the different methodologies , in table [ mr_err ] we also report an error quantification , expressed in terms of the rmses and suitably computed on a significant subset of evaluation points automatically chosen .",
    "this study confirms once more , from a numerical standpoint , what we have previously observed .    in this application",
    "we take into account the analyses performed in subsection 7.1 , especially for the choice of the parameters . here for the gaussian and lobachevsky l4 transformations we have used the parameter value @xmath294 , and for wendland s transformations the value @xmath295 , but , as pointed out in subsection 7.1 , the parameter values for the wendland and lobachevsky functions can be chosen in a wide range .",
    "this consideration is supported by results obtained with different parameter values .",
    "however , it is not astonishing that the optimal parameter values obtained in this example do not coincide with those given in previous test examples 1 and 2 .",
    "in fact , small differences of the optimal parameter values in the various situations are to be expected , because the number and collocation of landmarks are considerably changed .        ' '' ''    g & tps & w2 - 2d & w4 - 2d & w2 - 1d@xmath2301d & l4 +    ' '' ''    @xmath285 & @xmath358 & @xmath359 & @xmath360 & @xmath361 & @xmath362 +             \\(a ) g , @xmath294        \\(b ) tps     +        \\(c ) w2 - 2d , @xmath295        \\(d ) w4 - 2d , @xmath295     +        \\(e ) w2 - 1d@xmath2301d , @xmath295        \\(f ) l4 , @xmath294     +",
    "we compared some well established interpolation methods , such as compactly supported radial basis functions , specifically wendland s functions , and some techniques recently proposed in the context of image registration , namely the modified shepard s method , in which the nodal functions are obtained by using radial basis functions , and compactly supported lobachevsky splines . to this aim , we briefly recalled all the above local interpolation schemes and made comments on their performances in landmark - based image registration , taking into account the wide literature on the topic .",
    "for the first time , as far as we know , we proposed the use of products of univariate compactly supported radial basis functions , which perform well when they are compared with other schemes even if , in general , multivariate radial wendland s functions provided better registration results .    in particular , we were interested to point out which scheme may be preferable in a specific situation . moreover , since many techniques require the use of a shape parameter which might greatly influence registration results , we pointed out that sometimes may be necessary a compromise between accuracy and smoothness , whereas in other situations a significative improving of accuracy , with the use of optimal parameters , is recommendable .    with regard to all the analyzed test cases and , in particular , considering rmses and smoothness of the transformed images , we can claim that among the ten considered schemes the following four are preferable : tps , shep - tps , w2 - 2d , l4 .",
    "the tps method is global and does not need a parameter .",
    "this can be advantageous , but as a consequence the scheme is also less adaptive to the different situations that arise in real cases . on the contrary , referring to shep - tps , the problem mainly consists in finding optimal choices for the three parameters .",
    "regarding to wendland s functions w2 - 2d and lobachevsky l4 , it is remarkable that their performances are good in all the considered different situations and , moreover , the parameter selection can be made by the user in a large interval .    here",
    ", we used interpolating transformations which accomplish an exact match of corresponding landmarks .",
    "this implicitly means that the landmark positions are exactly known .",
    "however , if we have to deal with landmark localization errors , then it would be advantageous to weaken the interpolation conditions by introducing an approximation scheme .",
    "further investigations in this direction are still required and ongoing .",
    "the authors thank the anonymous referees for their detailed and valuable comments which helped to greatly improve the quality of the paper .",
    "moreover , the authors gratefully acknowledge the support of department of mathematics g. peano  , university of turin , project modeling and approximation of complex systems ( 2010 ) . finally , the second author is grateful to the istituto nazionale di alta matematica  ( indam ) for its financial support by a research grant .",
    "g. allasia , r. cavoretto , a. de rossi , b. quatember , w. recheis , m. mayr , s. demertzis , radial basis functions and splines for landmark - based registration of medical images , in : t.e .",
    "simos et al .",
    ", proceedings of the icnaam10 , aip conference proceedings , vol . 1281 ,",
    "melville , new york , 2010 , pp .",
    "716719 .",
    "r. cavoretto , a. de rossi , a local idw transformation algorithm for medical image registration , in : t.e .",
    "simos et al .",
    ", proceedings of the icnaam08 , aip conference proceedings , vol .",
    "1048 , melville , new york , 2008 , pp .",
    "970973 .",
    "r. cavoretto , a. de rossi , landmark - based image registration using gneiting s compactly supported functions , in : t.e .",
    "simos et al .",
    ", proceedings of the icnaam12 , aip conference proceedings , vol . 1479 , melville , new york , 2012 , pp .",
    "13351338 .",
    "fitzpatrick , d.l.g .",
    "hill , c.r .",
    "maurer jr , image registration , in : m. sonka et al .",
    "( eds . ) , handbook of medical imaging .",
    "volume 2 : medical image processing and analysis , spie press , bellingham , 2000 , pp .",
    "447513 .",
    "m. fornefett , k. rohr , h.s .",
    "stiehl , elastic registration of medical images using radial basis functions with compact support , proc .",
    "conf . on computer vision and pattern recognition ( cvpr99 ) , fort collins , co ,",
    "june 23 - 25 , ieee computer society , 1999 , pp .",
    "402407 .",
    "b. quatember , m. mayr , w. recheis , s. demertzis , g. allasia , a. de rossi , r. cavoretto , e. venturino , geometric modelling and motion analysis of the epicardial surface of the heart , math .",
    "simulation 81 ( 2010 ) 608622 .",
    "b. quatember , m. mayr , w. recheis , s. demertzis , g. allasia , a. de rossi , r. cavoretto , e. venturino , development of an accurate method for motion analyses of the heart wall based on medical imagery , in : r. moreno - daz et al .",
    "( eds . ) , computer aided systems theory - eurocast 2011 , lncs 6928 , springer - verlag berlin heidelberg , 2012 , pp ."
  ],
  "abstract_text": [
    "<S> in this paper we focus , from a mathematical point of view , on properties and performances of some local interpolation schemes for landmark - based image registration . precisely , we consider modified shepard s interpolants , wendland s functions , and lobachevsky splines . </S>",
    "<S> they are quite unlike each other , but all of them are compactly supported and enjoy interesting theoretical and computational properties . in particular , we point out some unusual forms of the considered functions . finally , detailed numerical comparisons are given , considering also gaussians and thin plate splines , which are really globally supported but widely used in applications .    </S>",
    "<S> nonrigid image registration , scattered data interpolation , compactly supported functions , modified shepard s formula , wendland s functions , lobachevsky splines .    65d05 , 65d07 , 68u10 . </S>"
  ]
}