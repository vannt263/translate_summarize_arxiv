{
  "article_text": [
    "consider a xy - model with hamiltonian @xmath1 where @xmath2 denotes the angle between the spin @xmath3 , in site @xmath4 , and the @xmath5-axis , @xmath6 is a coupling constant , the first summation extends over all pairs of nearest neighbors and the second one over all sites .",
    "the second term in ( [ hamiltonian ] ) corresponds to the energy associated with a symmetry breaking field , characterized by a positive integer @xmath7 and a constant @xmath8 .",
    "this model is important since it may describe many real magnetic crystals subject to symmetry - breaking crystalline fields @xcite .",
    "experimental crystalline fields corresponding to @xmath9 , @xmath10 and @xmath11 are expected . for @xmath12",
    "the model corresponds to a xy - model with an external magnetic field .",
    "for @xmath9 we have a system with @xmath0 symmetry ( which we call xy2 ) .",
    "this latter case is specially interesting because : ( i ) it was studied by jos _ et .",
    "al . _ who were unable to ascertain the small @xmath13 structure of the phase diagram@xcite , ( ii ) the critical temperature @xmath14 for this system , neither for @xmath15 , is not known exactly . (",
    "iii ) recently , resende and costa @xcite have founded differences of 2% in the value of @xmath14 depending on the pseudo - random number generator employed , i.e. , @xmath16 with ran2 @xcite or @xmath17 with ranlux in the fourth _ luxury _ level @xcite , and ( iv ) the quantities needed to implement the recently introduced `` broad histogram method '' ( bhm ) @xcite for this system are hard to compute .",
    "in this paper we have two main aims : ( i ) to show how to implement the bhm when there are no analytical expressions for its quantities and , ( ii ) to use the bhm , together with microcanonical simulations , to calculate the critical temperature and the critical exponents for the xy2 model ( @xmath15 ) .    in the next section we review the implementation of the bhm for continuous systems and",
    "we describe how to apply it to the xy2 model and , in extend , to * any * continuous model . in section ( [ sec : implement ] ) some details on the sampling process employed are presented .",
    "section ( [ sec : results ] ) shows the results of the finite - size scaling analysis .",
    "finally , we summarize some comments and conclusion in section ( [ sec : conclusion ] ) .",
    "the broad histogram method ( bhm ) @xcite is a novel analysis technique introduced in 1996 by de oliveira _ et .",
    "_ in order to calculate the spectral degeneracy @xmath18 of a given system . instead of investigating the form of the histogram of visits , the new method computes @xmath18 from the microcanonical averages of a special macroscopic quantity @xmath19 defined below .",
    "this new analysis method can be used in conjunction with any sampling strategy used previously ( microcanonical , canonical , multicanonical , etc . ) .",
    "since the basic quantities are microcanonical averages , the method does not depend on the form of histogram of visits and sample sets of different runs can be joined together just by cummulating them in the same histograms .",
    "furthermore , each sample contributes with a number of several digits to these averages , a much richer information that just increasing by unity some entry in the histogram of visits . as a result",
    ", the bhm can estimate thermodynamic averages with more precision on broader temperature ranges than other reweighting methods @xcite .",
    "consider some symmetric relationship @xmath20 connecting pairs of states in the phase space of the system and define a new macroscopic quantity @xmath19 as the number of connections starting from state @xmath21 that changes the energy of this state by @xmath22 . now , consider the subspaces @xmath23 and @xmath24 of all states with energy @xmath25 and @xmath26 , respectively . since @xmath20 is symmetric , the number of connections going from @xmath23 to @xmath24 equals the number of connections coming back from @xmath24 to @xmath23 , or @xmath27 where @xmath18 is the number of microstates with energy @xmath25 and @xmath28 is the average of @xmath19 on @xmath23 .",
    "this is the so called _ broad histogram equation_. it means that the ratio @xmath29 can be obtained by estimation of the averages @xmath28 .",
    "equation ( [ bhrel ] ) is completely general and is exact for any statistical model @xcite . starting from an initial value @xmath30 and applying the method iteratively , the density of states function @xmath18",
    "can be obtained in steps of @xmath22 on a whole energy range .    by taking logarithm at both sides of eq .",
    "( [ bhrel ] ) we arrive to the following expression for @xmath31@xmath32@xmath33 } / de$ ] : @xmath34 then , an alternative procedure is to use this expression to estimate @xmath35 at several energy values and integrate it to obtain an approximation of @xmath36@xmath32@xmath37}$ ] , the microcanonical entropy .",
    "the bhm is an analysis procedure on a set of samples obtained previously .",
    "the samples itself can be colleted with every sampling method avaible as , for instance , microcanonical@xcite , canonical@xcite ( including cluster @xcite algorithms ) or multicanonical@xcite and @xmath38 @xcite procedures , and some of them have been already tested @xcite .",
    "the averages @xmath28 can be estimated just by cumulating the quantities @xmath19 on histograms in @xmath25 and by dividing them into the number of samples at each energy bin , so far states with the same energy are taken into the sample with the same probability ( this is the usual procedure to compute microcanonical averages ) .",
    "if we are interested in canonical averages @xmath39 at temperature @xmath40 of a certain quantity @xmath41 , we need an additional histogram in @xmath25 to cumulate @xmath42 for all states in the sample and compute the microcanonical averages @xmath43 . once @xmath18 and @xmath43 have been determined , the canonical aveage @xmath39 of a certain quantity @xmath41 are computed as @xmath44      \\nonumber \\\\",
    "z(t)&= & \\sum_e g(e ) \\exp[-e / k_{\\rm b}t ] \\ ;     \\label{meanqe}\\end{aligned}\\ ] ] for any desired temperature , where @xmath45 is the boltzmann constant .",
    "the bhm method was originally used to investigate discrete models but , recently , muoz and herrmannn have shown how to extend it for continuous systems , as the xy @xcite and heisenberg @xcite models .",
    "the relationship @xmath20 is replaced by a symmetric transition probability @xmath46 , and the number of connections @xmath19 is redefined as the probability , @xmath47 , to obtain an energy change between @xmath22 and @xmath48 with this transition probability @xmath20 .",
    "hence , the problem reduces to that of calculating the probability density function ( p.d.f . ) @xmath47 for a given configuration @xmath21 .",
    "this calculation can be easily done for the xy and heisenberg models , where a partial analytical computation is easy to perform . for the xy model with z2 symmetry",
    "the problem is more difficult .",
    "consider the transition probability @xmath20 defined by @xmath49 here , @xmath50 is the number of sites .",
    "this transition probability corresponds to the following protocol of virtual random movements : first , a site @xmath4 is chosen at random ( with probability @xmath51 ) ; then , a new angle @xmath52 is chosen at random on the interval @xmath53 .",
    "thus , @xmath52 is a random variable with p.d.f .",
    "@xmath54 if the spin @xmath4 was chosen to be turn , its bonds and interaction with the external field are the only ones that change the energy value .",
    "let us define the energy associated to spin @xmath4 as @xmath55 where @xmath56@xmath57@xmath58 , @xmath59@xmath57@xmath60 and the summations run over all nearest neighbors of spin @xmath4 .",
    "if @xmath2 changes to @xmath52 the energy @xmath61 changes to @xmath62 .",
    "what is the p.d.f . of this random variable ? to find the p.d.f .",
    "@xmath63 for a specific @xmath64 we need to solve the equation @xmath65 denoting its real roots by @xmath66 , the p.d.f .",
    "is written as @xcite @xmath67 the difficulty here is to find the roots @xmath68 .",
    "the equation ( [ eq : roots ] ) is fourth order in @xmath69 ( consequently the maximum value for @xmath70 is 4 ) and there are analytical expressions to compute the roots , but they are too cpu - time demanding to be computed for every site @xmath4 .",
    "moreover , the exact calculation of these roots for other models could be impossible .    for these reasons",
    "we propose to calculate the roots numerically and to store a table @xmath71 for some values of @xmath56 , @xmath59 and @xmath72 .",
    "other values not stored in the table can be founded by interpolation techniques .",
    "this approach is very fast , since we need only to calculate @xmath56 , @xmath59 and @xmath73 for each selected spin and to read from the table the value for the respective p.d.f .. figure ( 1 ) shows the p.d.f .",
    "@xmath74 for some values of @xmath56 and @xmath59 , obtained from a table with @xmath75 entries for @xmath56 , @xmath75 for @xmath59 and @xmath76 for @xmath72 . despite of these few values we did not find any significant difference between using linear interpolation or taking the nearest value in the table .",
    "furthermore , nearly the same results are obtained with only @xmath75 entries for @xmath73 .    because @xmath22@xmath57@xmath77@xmath78@xmath73 , its p.d.f . for a change in site",
    "@xmath4 is @xmath79@xmath57@xmath80 . finally ,",
    "since all sites are equally probable , for a given configuration * x * we obtain @xmath81 where the sum is over all sites .",
    "toward a finite - size scaling analysis of this two - dimensional model we investigated system sizes of @xmath82@xmath57@xmath11,@xmath83,@xmath84,@xmath85,@xmath86,@xmath87,@xmath88 and @xmath89 with periodic boundary conditions .",
    "a single value of @xmath22@xmath57@xmath90 was chosen for the bhm analysis .",
    "since we are interested only in thermodynamic functions near the critical temperature it is not necessary to sample the whole energy range of positive temperatures . instead",
    ", the following schema was adopted : for each system size we set a maximal and a minimal energy values @xmath91 and @xmath92 and chose @xmath93 equally - spaced energy points between them .",
    "our goal is to estimate @xmath35 at each point @xmath25 , as @xmath94 and to integrate it by the trapezoidal rule .",
    "samples were taken by performing microcanonical simulations on small windows of width @xmath95 , that choose and turn one spin at random and accept the new state only if it falls into the window .",
    "this procedure takes all states inside the window with the same probability .",
    "then , most of the samples will cumulate on the high - energy border of the window , because the density of states is a fast - growing function . therefore ,",
    "@xmath96 is well estimated from a microcanonical simulation in a window of width @xmath95 centered at @xmath25 , and @xmath97 from a microcanonical simulation in a window of width @xmath98 centered at @xmath99 .",
    "a schematic description of this sampling procedure is shown in figure ( [ xyz2microsim ] ) .",
    "table [ tablexyz2sims ] shows the values of @xmath91 @xmath92 and @xmath93 used for each system size .    summarizing , we ran two microcanonical simulations for each value of @xmath35 .",
    "the microcanonical averages @xmath100 , @xmath101 and @xmath102 were computed at each energy point by averaging the @xmath103-values in both windows . inside each window",
    "@xmath104 mcss were discarded before sampling and , then , @xmath89 samples spaced by @xmath84 mcss were taken .",
    "the whole procedure was repeated @xmath86 times and the data of all @xmath86 runs were cumulated in the same histograms .",
    "we performed a finite - size scaling analysis @xcite to estimate the critical properties of this model .",
    "we have divided our analysis in two parts ; first , the determination of the critical temperature and , second , the estimation of the critical parameters .",
    "one of the questions we want to elucidate is the dependence of the results on the random number generator employed .",
    "hence , we repeated our simulations with four different random number generators , i.e. , ran2 @xcite , ranlux with the fourth _ luxury _ level @xcite , ranibm @xcite and a lagged - fibonacci @xcite random number generator with primitive trinomial ( 110503,53719,0 ) @xcite , initialized with ran2 .    figure ( [ ubinder ] ) shows the fourth - order binder cumulant @xmath105 computed for all system sizes with the four random number generators . by looking at the limits of the smallest rhombus crossed by all curves we define maximal and minimal values for the critical coupling @xmath106 and the universal parameter @xmath107 ( table [ tablexyz2_utc ] ) .",
    "the most precise results are obtained with the fibonacci and the less ones with ranlux . by combining the four results through a maximal likehood estimator @xcite",
    "we obtain @xmath108 ( @xmath109 ) and @xmath110 , in good agreement with the value @xmath111 for the 2d - ising universality class @xcite ( here and in the following the number between parenthesis represents a @xmath112 error bar , with a confidence level of @xmath113% .",
    "for instance , @xmath114 and @xmath115 ) .    to corroborate this value for the critical temperature we have plotted the temperatures of maximal heat capacity @xmath116 and maximal magnetic susceptibility @xmath117 as a function of the system size @xmath82 . in the thermodynamic limit @xmath118 since @xmath119 for the 2d - ising universality class ,",
    "we expect a linear behavior of @xmath116 and @xmath117 against @xmath120 .",
    "figure ( [ figurexyz2_tcvtxs ] ) shows this linear behavior with the four random number generators .",
    "the linear regressions were obtained from the data points at @xmath121 and @xmath89 .",
    "all figures coincide to estimate a critical temperature near @xmath122 , in excellent agreement with our estimate from the binder cumulant and in concordance with the value of @xmath16 obtained in ref .",
    "@xcite with ran2 , but far away of value @xmath123 obtained in the same reference with ranlux .      to compute the critical exponents of this model we used the data obtained with the fibonacci random number generator , that has showed to be the most precise one .",
    "the critical exponent @xmath124 can be obtained by two different procedures .",
    "first , it can be estimated from the previous data for the binder cumulant by using the relation @xcite @xmath125 figure ( [ figurexyz2nu]a ) shows the power - law fit for this relation at @xmath126 .",
    "the value @xmath127 ( @xmath128 ) obtained is consistent with the value @xmath119 of the 2d - ising universality class .",
    "second , it can be estimated from ( [ tcvxs ] ) by plotting @xmath129 against @xmath120 ( figure ( [ figurexyz2nu]b ) ) .",
    "this second value of @xmath130 ( @xmath131 ) is not so precise as the first one . by combining both results in a maximal likehood estimator",
    ", we obtain @xmath132 .",
    "figure ( [ figurexyz2beta]a ) shows the average magnetization per site @xmath133 at @xmath126 as a function of the system size @xmath82 , in order to compute the critical parameter @xmath134 from the finite - size behavior @xmath135 the value of @xmath136 is higher than the value @xmath137 of the 2d - ising universality class .",
    "this can be a small - sizes effect , since the same estimation excluding @xmath138 and @xmath85 gives @xmath139 . by excluding in",
    "consecutively the system sizes @xmath138 and @xmath85 we obtained different values of @xmath140 .",
    "these values , when plotted against @xmath120 , show a linear behavior ( @xmath82 is the minimal system size taken into account ) ( figure ( [ figurexyz2beta]b ) ) .",
    "the linear extrapolation gives a final estimation for @xmath141 .",
    "figure ( [ figurexyz2beta]c ) shows the fss collapse of the average magnetization , by taking @xmath142 and @xmath143 .    to compute @xmath144",
    "we have used the three finite - size scaling relations @xcite @xmath145 figure ( [ figurexyz2gamma]a ) shows the results form these three methods .",
    "the results are @xmath146 ( eq . [ eqfssxs1 ] ) , @xmath147 ( eq . [ eqfssxs2 ] ) and @xmath148 ( eq . [ eqfssxs3 ] ) . by excluding consecutively the system sizes @xmath138 and",
    "@xmath85 we obtain the values shown in figure ( [ figurexyz2gamma]b ) .",
    "the larger variation corresponds to the estimations from @xmath149 , as expected @xcite .",
    "the linear extrapolation of these values does not coincide for @xmath150 , nevertheless , they all intersect around @xmath151 , when the system sizes @xmath152 and @xmath84 have been excluded .",
    "furthermore , it coincides with the maximal - likehood estimator of the three values , @xmath153 , in good agreement with the value for the 2d - ising universality class , @xmath154 . figure ( [ figurexyz2gamma]c ) shows the fss collapse of the magnetic susceptibility with @xmath142 and @xmath155 .",
    "the more difficult parameter to be directly computed is @xmath156 , the critical parameter for the divergence of the specific heat .",
    "on one side , assuming hyperscaling @xmath157 to be valid and setting our estimate of @xmath132 we obtain for @xmath158 ( the lattice dimension ) @xmath159 , which corresponds to a finite cusp , @xmath160 on the other side , for the 2d - ising universality class @xmath161 and @xmath162 shows a logarithmic divergence @xcite",
    "@xmath163 \\quad .",
    "\\label{xyz2_cvlogmax}\\end{aligned}\\ ] ] furthermore , one predicts the scale behavior @xcite @xmath164 \\quad , \\label{xyz2_cvlogt}\\end{aligned}\\ ] ] where @xmath165 .",
    "the constant @xmath166 can be deduced from the scaling behavior of @xmath167 @xmath168 \\quad .",
    "\\label{xyz2_cvlogtc}\\end{aligned}\\ ] ]    figure ( [ figurexyz2alpha]a ) shows both a power - law fit with @xmath169 ( @xmath170 ) and a logarithmic fit ( @xmath171 ) for @xmath172 ( circles ) .",
    "the value of @xmath173 for the first one was set by looking for the larger correlation coefficient @xmath174 of the power - law fit .",
    "this maximal value @xmath175 changes , however , only in the fifth decimal place for @xmath176 , corresponding to @xmath177 .",
    "we take , hence , @xmath178 , in good agreement with the value from hyperscaling .",
    "the logarithmic fit , with correlation coefficient @xmath179 is almost indistinguishable from the power - law fit .",
    "figure ( [ figurexyz2alpha]a ) also shows a logarithmic fit for @xmath167 ( squares ) .",
    "this fit estimates @xmath180 from ( [ xyz2_cvlogtc ] ) with correlation coefficient @xmath181 .",
    "figure ( [ figurexyz2alpha]b ) shows the fss collapse of the specific heat according with ( [ xyz2_cvlogt ] ) for this value of @xmath166 .",
    "all system sizes collapse well , except for @xmath182 at @xmath183 , due , perhaps , to a lack of simulational points for this system size .",
    "all these results support the thesis of a logarithmic anomaly of the specific heat for this model .",
    "our results are summarized in table [ tablexyz2criticalparameters ] .",
    "they are in good agreement with the expected values for the 2d - ising universality class and @xcite .",
    "we have constructed a bhm analysis procedure for the xy - model with @xmath0 symmetry . with this example , we have shown how to construct a bhm analysis when the quantities @xmath184 can not be easy computed . our strategy is to construct a table for the function @xmath185 ( eq . [ eq : fepsilon ] ) , where the indexes are given by the variables which define the energy per spin @xmath73 , and the values of the function are determined by numerical methods .",
    "other values not stored in the table are found by interpolation techniques .",
    "this approach is very fast , since only a memory access , an interpolation and a sum are needed to compute @xmath184 .",
    "it is only restricted by the amount of memory available .",
    "this approach is general and can be extended to other complex models .",
    "we have employed the bhm analysis procedure together with microcanonical simulations to perform a finite - size scaling analysis of the xy - model with @xmath0 symmetry , for system sizes @xmath186 .",
    "our calculations give a very precise estimates for the critical temperature , @xmath108 and of the binder cumulant @xmath110 .",
    "furthermore , our results for @xmath14 and @xmath187 are almost the same for the four pseudo - random number generators employed , ran2 , ranlux , fibonacci and ranibm , with the most precise results for fibonacci and the least ones for ranlux .",
    "our estimations for the critical exponents are in good agreement within the error bars with the theoretical predictions of the 2d - ising universality class and with other monte carlo studies",
    ".    our value of @xmath14 agrees with the result @xmath16 from @xcite with ran2 and clearly disagrees with the result @xmath17 from the same reference with ranlux .",
    "to clarify this point , figure ( [ newcosta ] ) shows our results for the magnetic susceptibility in a @xmath188 system , obtained with different random number generators and including also some reference points calculated with the metropolis algorithm , which reproduce the figure ( 1 ) of ref .",
    "@xcite . in that previous work ,",
    "the metropolis algorithm with ranlux showed a peak at a clearly lower temperature ( @xmath189 ) than the same algorithm with ran2 ( @xmath190 ) .",
    "in contrast , all our data coincide to show a peak around @xmath190 , including the metropolis estimations with ranlux . in our opinion",
    ", the result of @xmath17 could be due to an incorrect implementation of ranlux .",
    "the computational time of the bhm analysis increases proportional to @xmath50 , the number of sites , in the same proportion as the time of one mcss with the microcanonical sampling procedure .",
    "a special care should be taken , however , to assure that enough microcanonical simulations contribute to each temperature average . according to eq .",
    "( [ meanqe ] ) , the contribution of a sample with energy @xmath25 to the average @xmath39 is weighted by the factor @xmath191 , which distributes approximately as a gaussian with center at @xmath192 and width @xmath193@xmath57@xmath194 . therefore , all samples in the range @xmath195 will contribute to @xmath39 .",
    "for small system sizes , the whole range of energies contributes . for large ones ,",
    "we have tried to maintain a constant number of simulations inside @xmath196 .",
    "the number of simulations per energy interval can be chosen by assuming @xmath197@xmath198@xmath199 for @xmath200 and @xmath201 otherwise .",
    "table [ tablexyz2_nepersigma ] shows the number of microcanonical simulations in @xmath196 at @xmath202 by assuming @xmath203 ( see figure ( [ figurexyz2alpha]b ) ) .    in conclusion",
    ", we have shown that the bhm method can be used to obtain quality results from the finite - size scaling analysis of a non - trivial system , also if the quantities required to implement the method are hard to compute analitically .",
    "these results support the usefulness and generality of the bhm .",
    "we want to thank very specially hans j. herrmann for encouraging discussions and suggestions in the develop of this work .",
    "arl wishes to thank h.j .",
    "herrmann and j. d. muoz for the hospitality and financial support at ica1 where this work was done .",
    "the authors acknowledge financial support from cnpq ( brazilian agency ) ( arl ) and deutscher akademischer austauschdienst ( daad ) ( jdm , through scholarship a/96/0890 ) .",
    "b.  a. berg , in _ proceedings of the international conference on multiscale phenomena and their simulations ( bielefeld , october 1996 ) _ , edited by b.  m. f.  karsch and h. satz ( world scientific , singapura , 1997 ) ."
  ],
  "abstract_text": [
    "<S> in this work we investigate the classical ferromagnetic xy - model in two dimensions subject to a symmetry breaking field which impose a @xmath0 symmetry to the system . </S>",
    "<S> we used the broad histogram method combined with microcanonical simulations and finite - size scaling analysis to estimate the critical temperature and critical exponents of this system with little computational effort . </S>",
    "<S> in addition , we present a general procedure which makes possible to use the broad histogram method for continuous systems , also when the macroscopic quantities needed by the method can not be obtained analytically . </S>",
    "<S> our results are robust under the choice of four different pseudo - random number generators . </S>"
  ]
}