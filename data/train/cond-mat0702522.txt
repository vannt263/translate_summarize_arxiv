{
  "article_text": [
    "molecule - surface interactions play a cental role in many technologically relevant processes like heterogeneous catalysis , semiconductor growth and corrosion .",
    "a detailed investigation of the underlying elementary steps at an atomic scale , e.g. physisorption , chemisorption , dissociation , diffusion , and desorption , is crucial to gain the deeper understanding needed to identify new catalysts , candidates for protective surface coatings , and chemically inert surfaces .",
    "a central quantity in all these processes is the potential - energy surface ( pes ) , which gives the potential - energy of the system as a function of the positions of the nuclei .",
    "first - principles calculations , and in particular density - functional theory ( dft ) , have become an important tool in providing accurate , often quantitative information on pess .",
    "nevertheless , the computational demands connected with the calculation of every single pes point for systems involving an extended solid surface still impose severe constraints , e.g. limiting the number and time span of `` on - the - fly '' _ ab initio _ molecular dynamics ( md ) trajectories to study the molecule - surface interaction .",
    "consequently , important physical quantities like sticking coefficients , which result from statistical averaging and which thus require e.g. a large number of md runs to obtain converged results , are still hardly accessible in this way .    as one possibility to determine such quantities from first - principles , gro and scheffler  @xcite introduced a `` divide and conquer '' approach , which allows to speed up the calculation of the md trajectories by splitting the problem into three steps .",
    "first , the multi - dimensional pes is mapped on a finite grid by calculating the energies for a number of configurations using an accurate method like dft . in a second step",
    "these points are interpolated to a continuous pes representation by an appropriate method that allows to access the energy and the forces several orders of magnitude faster than the original dft calculations . in the mentioned example of md simulations , the forces at any nuclear configuration",
    "can then be obtained from the interpolated pes representation at low computational cost , thereby permitting the calculation of a sufficient number of md trajectories .",
    "several approaches have been proposed for such interpolation schemes . in analytical fits",
    "@xcite a reasonable functional form is `` guessed '' by physical intuition and the free parameters of this functional form are optimized to represent the set of dft energies as accurately as possible .",
    "if an appropriate functional form can be found , this approach minimizes the required first - principles input and avoids spurious , unphysical features in the pes . on the other hand , with increasing dimensionality of the pes ,",
    "the construction of suitable functional forms becomes increasingly involved , and the fixed functional form makes this approach also quite inflexible .",
    "first attempts to optimize the functional form itself in the fitting process by applying a genetic programming technique have hitherto only been reported for up to three - dimensional pess  @xcite .",
    "an alternative to analytic fits is the modified shepard interpolation  @xcite . in this method",
    "the potential close to a calculated dft point is expanded as a second - order taylor series .",
    "the potential of a new configuration is then constructed as a weighted sum over the taylor expansions with respect to the neighboring dft points .",
    "the fitting procedure can be further simplified by reducing the corrugation of the pes  @xcite . for pess describing a molecule - surface interaction this can e.g. be achieved by subtracting separately calculated pess describing the interactions of the individual atoms of the molecule with the surface .",
    "finally , we also mention an approach to efficiently represent pess by parameterizing a tight - binding hamiltonian @xcite . in principle",
    ", this approach requires only a relatively small number of dft calculations in order to obtain accurate fits to high - dimensional pess . in practice ,",
    "the scheme is , however , unfortunately hampered by the indirect and cumbersome tight - binding parameterization procedure .    in recent years",
    ", neural networks  @xcite ( nn ) were also successfully applied to fit pess of small gas - phase molecules  @xcite .",
    "neural networks form a very general class of functions  @xcite , which in principle can approximate any function to arbitrary accuracy without requiring any information about the underlying functional form of the problem .",
    "first applications to the description of molecule - surface interactions have demonstrated the capabilities of this approach  @xcite , but were complicated by technical difficulties in achieving a proper consideration of the symmetry of the solid surface  @xcite .",
    "the aim of the present paper is therefore to overcome these limitations by introducing a symmetry - adapted neural network representation of pess for molecule - surface interactions , which is based on a new type of symmetry functions that takes the symmetry of the surface potential exactly into account .",
    "the accuracy and efficiency of such a nn representation , in particular for md simulations , is demonstrated by studying the interaction of oxygen with the al(111 ) surface .",
    "for this , we concentrate on the six - dimensional pes describing the interaction with an o@xmath0 molecule constrained to its spin - triplet state , which could recently be shown to be of crucial importance in understanding the low initial sticking coefficient reported experimentally@xcite .",
    "inspired by the neural signal processing in biological systems  @xcite , the first artificial neural networks have been introduced in 1959  @xcite . since then nn techniques have become a standard tool in many fields of research . while they have been applied mainly to pattern recognition and classification problems , neural networks also represent a very general fitting scheme that in principle allows to approximate any function to arbitrary accuracy  @xcite .",
    "no previous knowledge about the underlying functional form is required . instead , a number of known values of the function to be fitted is presented to the nn in order to adapt a rather large number of parameters using an optimization algorithm .",
    "out of the many types of neural networks , the class of multilayer feed - forward neural networks  @xcite has particularly proven to be a useful tool for the representation of potential - energy surfaces  @xcite .",
    "the general structure of such a multi - layer feed - forward neural network is shown schematically in fig .",
    "[ nnstructure ] .",
    "it consists of an input layer , one or more hidden layers and an output layer . in each layer",
    "there is a certain number of nodes . when representing a pes by a nn , the relevant coordinates of the system determining the potential are fed into the input layer of the nn .",
    "there are many possible choices for the input coordinates @xmath1 depending on the system to be studied . in the most simple case of the one - dimensional interaction potential of an isolated diatomic molecule",
    "the bond length would e.g. be an appropriate choice as input coordinate . for molecules",
    "several bond lengths and angles can be used as input , as has been shown for the pess of several small molecules  @xcite .",
    "the node in the output layer provides the target quantity , i.e. , in the present case the potential energy of the system .",
    "however , nns are not constrained to fit only one quantity , and it would for example also be possible to fit the potential and the forces acting on the atoms simultaneously .    in between the input and the output layer ,",
    "there are one or more hidden layers , each with a certain number of nodes .",
    "the term `` hidden layer '' indicates that the numerical values at the nodes of these layers have no physical meaning and are just auxiliary mathematical quantities .",
    "each node in each layer is connected to the nodes in the adjacent layers by so - called weights , the fitting parameters of the nn . as illustrated in fig .",
    "[ nnstructure ] , the weight parameter @xmath2 is connecting node @xmath3 in layer @xmath4 with node @xmath5 in layer @xmath6 , where the input layer has the superscript @xmath7 .",
    "the value @xmath8 of node @xmath3 in layer @xmath4 is obtained from the values @xmath9 of all nodes @xmath5 in the preceding layer @xmath6 and from the connecting weights by @xmath10 i.e. , for each node the values of the nodes in the previous layer are multiplied by the respective weights and added up to yield a single number . on this number",
    "a so - called activation function @xmath11 is applied , which can be different for each layer .",
    "activation functions are typically sigmoidally shaped non - linear functions , which introduce the capability to fit non - linear functions into the nn .",
    "frequently employed functional forms are the hyperbolic tangent or fermi - like functions .",
    "for very large or very small arguments the activation functions converge to a constant number , but for a certain interval the output changes significantly in a non - linear way .",
    "in contrast , a linear activation function is often employed in the output layer to avoid a constraint on the possible range of output values .",
    "finally , there is a bias weight connected to each node in the hidden layers and the output layer , which acts as an adjustable offset to shift the non - linearity regime of the activation functions as needed to obtain an optimal fit .    the full analytic form for the small model nn shown in fig .  [ nnstructure ]",
    "is given by the expression @xmath12 in general , each layer including input and output layers can contain many more nodes than in the simple example shown in fig .",
    "[ nnstructure ] , and also more than one hidden layer is typically used .",
    "the number of layers and nodes determines the analytic form of the nn , and also analytic derivatives , i.e. , the forces , can be calculated .",
    "the overall nn architecture can then be described following the scheme suggested in ref .  .",
    "in this scheme , the nn in fig .  [ nnstructure ] is a @xmath13 network , where the first number indicates the number of nodes in the input layer , the last number the number of nodes in the output layer , and the number(s ) in between the number(s ) of nodes in the hidden layer(s ) .",
    "the employed activation function in each layer is labeled as @xmath14 , if a hyperbolic tangent is applied , or as @xmath15 for a linear function . in the present example",
    ", a hyperbolic tangent is thus used in the hidden layer , and a linear function in the output layer , hence @xmath16 .    in order to construct a continuous pes representation from a number of known training energies ( for example obtained from dft )",
    ", the weight parameters of the nn are optimized in an iterative way to reproduce these input energies as accurately as possible .",
    "initially the weights are chosen randomly , and for each known configuration ( i.e. point in the pes landscape ) the potential predicted by the nn is calculated .",
    "taking these values and the corresponding original input energies , an error function can be constructed .",
    "this error function is then minimized to optimize the weight parameters and thus requires the calculation of the derivatives of the output energies with respect to each @xmath2 .",
    "standard optimization algorithms like steepest descent , which is called backpropagation in the nn context , or conjugate gradient can be used to find the optimum set of parameters . in particular for nns",
    "also the extended kalman filter  @xcite ( ekf ) has proven to be a useful optimization tool . in the ekf",
    "the weights are adapted not after the presentation of the full input data set , but after the presentation of each single data point , which is intended to make the optimization process less sensitive to local minima in the high - dimensional optimization space.@xcite additionally , information from previous weight updates is included by using a modified cost function including a weighting factor for previous iterations .",
    "for details on the ekf we refer to ref .   and references therein .",
    "once an optimal set of weight parameters has been found , the nn constitutes the continuous pes representation , i.e. it can be employed to predict the energy and forces at any point in the pes landscape .    _ a priori _ it is not known which network architecture will be best for a given fitting problem , and tests are necessary to find the optimum number of hidden layers and nodes , as well as the best activation functions for a given system .",
    "too few nodes in the hidden layers will typically result in underfitting , i.e. , important features of the pes will be erroneously smoothed out .",
    "more nodes increase the flexibility of the nn , but can lead to overfitting , i.e. , artificial features appear in the pes . in general , an advisable strategy seems therefore to use the smallest possible nn that yields the desired accuracy .    in",
    "order to check on overfitting , one can split the full input data set into a training set used to optimize the nn parameters , and a test data set , which is not employed in the fit .",
    "the set of nn parameters that yields the lowest error for the test set may then be interpreted as having the best predictive power for unknown structures .",
    "the intention of the present work is to employ nns to represent the pes describing the interaction of a molecule approaching an extended single - crystal surface . addressing an important class of molecules",
    ", we will focus our discussion on diatomic molecules , and employ furthermore the so - called frozen - surface approximation .",
    "a possible generalization of our approach is then discussed in section [ discussion ] .    in the frozen - surface approximation ,",
    "the substrate atoms are assumed to be fixed to their positions pertinent to the clean surface .",
    "the dimensionality of the problem is thereby reduced to the degrees of freedom representing the impinging molecule , i.e. six dimensions for the case of diatomic molecules . instead of the cartesian coordinates of the two atoms ,",
    "usually the center of mass coordinates @xmath17 , @xmath18 , and @xmath19 ( where the @xmath20- and @xmath21-axes are parallel to the surface , and the @xmath22 axis points out of plane ) , as well as the molecular bond length @xmath23 , the angle between the molecular axis and the surface normal @xmath24 , and the angle between the projection of the molecular axis into the surface plane and the positive @xmath20-axis @xmath25 are used to describe the molecular configuration .",
    "these coordinates can be grouped into two classes : the coordinates @xmath17 , @xmath18 , @xmath24 and @xmath25 , in which the potential is periodic , and the `` non - periodic '' coordinates @xmath19 and @xmath23 .    due to the lateral symmetry of the solid surface it is sufficient to map the pes only for molecular configurations inside the irreducible wedge of the surface unit - cell . however , after the nn parameterization it is usually desirable to also have the appropriate pes information available outside this irreducible wedge . in md simulations intended to be run on",
    "the nn represented pes , the molecule should for example not be constrained to a motion inside the irreducible wedge only , but should be able to move from one wedge to another .",
    "consequently , the nn has to provide the energy and forces for all possible molecular configurations also outside the symmetry unique wedge .",
    "a straightforward solution would be to expand the energetic input data to a wider range of lateral @xmath17 and @xmath18 coordinates by suitably copying the data inside the irreducible wedge into neighboring wedges before the fit , and then to train the nn to a larger surface area .",
    "such a procedure is necessarily very inefficient due to the increased input data set and larger nn size , i.e. , number of parameters that would be required .",
    "furthermore , the nn fit is necessarily only an approximation to the underlying energetic data , and if parts of the pes , which are equivalent by symmetry , are fitted independently , the symmetry is numerically broken .    a solution to this problem",
    "has been suggested by lorenz , gro and scheffler by introducing functions including the symmetry of the surface .",
    "@xcite basically , the problem of assigning energies to molecular configurations is separated into two steps . in the first step",
    "the molecular coordinates are mapped on the `` symmetry functions '' , which describe the symmetry of the surface , and thereby the symmetry of the pes .",
    "the resulting symmetry function values replace the original molecular coordinates as input for the nn , and in a second step the energies are assigned to the symmetry function values by the nn .",
    "this procedure ensures that the symmetry properties of the symmetry functions are fully included in the nn representation of the pes .",
    "the construction of these symmetry functions is similar to the construction of the functional form in an analytic fit  @xcite .",
    "yet , the function values do not need to yield the total energy of the system , but only its symmetry in form of a set of function values .",
    "unfortunately , the hitherto proposed symmetry functions are valid only for a given system and are difficult to construct even for simple low - dimensional pess , because they have to describe correctly the complex interdependence of all `` periodic '' coordinates @xmath17 , @xmath18 , @xmath24 and @xmath25 .",
    "@xcite up to now , such functions have correspondingly been constructed using physical intuition , which can easily lead to artificial or missing symmetries .",
    "since this can have severe consequences on the represented pes topology , and thereby on molecular trajectories in md simulations run on the nn interpolated pes , the present work aims to improve on this situation by developing a more general scheme to construct symmetry functions , which include the full symmetry of a given system and are free of spurious symmetries not present in the true molecule - surface interaction .",
    "we begin developing our concept by looking at the symmetry of the interaction of an atom with a fcc(111 ) surface . a schematic top view explaining the irreducible wedge of the surface unit - cell is shown in fig . [ al111symmetry ] .",
    "the position of the atom over the surface is uniquely defined by its three cartesian coordinates @xmath17 , @xmath18 , and @xmath19 , where @xmath17 and @xmath18 are in the surface plane as indicated in fig .",
    "[ al111symmetry ] . the lateral symmetry of the surface could be considered in a straightforward manner by replacing these coordinates with the distances @xmath26 , @xmath27 and @xmath28 of the atom to the closest top , fcc and hcp surface sites , i.e. , the edges of the irreducible wedge of the surface unit - cell .",
    "if in a md simulation an atom crosses the border of the symmetry unique wedge of the surface , the closest reference surface sites change and the set of \\{@xmath26 , @xmath27 , @xmath28 } values naturally incorporates the symmetry as shown in fig .",
    "[ discontinuity ] for an atomic motion from a top site via a bridge site to a neighboring top site . nevertheless , although describing the periodicity of the surface correctly , the set \\{@xmath26 , @xmath27 , @xmath28 } is not an appropriate choice for the symmetry functions to fit the total energy of the system , since in md simulations also the derivatives of the energy with respect to the atomic coordinates , i.e. , the forces , are required . as can be seen in fig .",
    "[ discontinuity ] for the sample atomic motion , @xmath26 shows a discontinuity in its derivative at the wedge boundary originating from the switch to another reference top site , and consequently this discontinuity is also present in the forces .",
    "we solve this problem of discontinuities in the derivatives by replacing the atomic distances by fourier terms centered at the high - symmetry sites , which describe the position of the atom in a unique way as well . for a fcc(111 ) surface , these atomic fourier terms are @xmath29   \\nonumber \\\\&&\\cdot \\exp{\\left(-\\frac{1}{2}z\\right ) } \\label{fouriertop}\\end{aligned}\\ ] ] @xmath30 \\nonumber\\\\ & & \\cdot \\exp{\\left(-\\frac{1}{2}z\\right ) } \\label{fourierfcc}\\end{aligned}\\ ] ] @xmath31   \\nonumber\\\\&&\\cdot\\exp{\\left(-\\frac{1}{2}z\\right ) } \\quad , \\label{fourierhcp}\\end{aligned}\\ ] ] where the positions of the top , fcc and hcp sites are given by ( @xmath32 ) , ( @xmath33 ) and ( @xmath34 ) , respectively , and @xmath35 is the lattice constant of the surface unit - cell .",
    "the exponential term @xmath36 takes the dependence on the vertical distance @xmath19 to the surface into account , and ensures in particular that for a large atom - surface distance the function values and therefore also the fitted energy should become independent of the actual values of @xmath17 and @xmath18 .",
    "the fourier terms are compared to the simple distance terms in fig .",
    "[ discontinuity ] .",
    "they have continuous derivatives , which demonstrates that this function set is now a suitable choice for fitting the pes of an atom interacting with a fcc(111 ) surface , while naturally including the full symmetry of the surface .",
    "this is also directly apparent from the full lateral periodicity of the functions @xmath37 , @xmath38 and @xmath39 that is plotted in fig .",
    "[ fourieratom ] .",
    "it is intuitive to generalize the concept of fourier term based symmetry functions to molecules by building on the fourier terms for each constituent atom of the molecule . for a diatomic molecule ,",
    "the positions of both atoms can then e.g. be described by fourier terms like @xmath40 \\nonumber\\\\   & & \\cdot e^{-\\frac{1}{2}z } \\label{fouriertop1}\\end{aligned}\\ ] ] @xmath41 \\nonumber\\\\    & & \\cdot e^{-\\frac{1}{2}z } \\label{fourierfcc1}\\end{aligned}\\ ] ] @xmath42 \\nonumber\\\\   & & \\cdot e^{-\\frac{1}{2}z } \\label{fourierhcp1}\\end{aligned}\\ ] ] @xmath43\\nonumber\\\\   & & \\cdot e^{-\\frac{1}{2}z } \\label{fouriertop2}\\end{aligned}\\ ] ] @xmath44\\nonumber\\\\   & & \\cdot e^{-\\frac{1}{2}z } \\label{fourierfcc2}\\end{aligned}\\ ] ] @xmath45\\nonumber\\\\ & & \\cdot e^{-\\frac{1}{2}z } \\label{fourierhcp2}\\end{aligned}\\ ] ] which are functions of the cartesian coordinates of the two atoms @xmath46 and @xmath47 . apart from the constant @xmath48 to which we return below , the only modification compared to the atomic terms in eqs .",
    "( [ fouriertop]-[fourierhcp ] ) , is the explicit addition of the terms @xmath49 and @xmath50 to the respective fourier terms of atoms 1 and 2 .",
    "this is necessary , because the multiplication by the exponential term @xmath36 depending only on the center - of - mass distance of the molecule from the surface is not sufficient to distinguish different separations @xmath51 and @xmath52 of both atoms from the surface .",
    "this is resolved by the explicit heights @xmath51 or @xmath52 , and eqs .",
    "( [ fouriertop1 ] - [ fourierhcp2 ] ) then describe the positions of both atoms with respect to the top , fcc and hcp sites uniquely .",
    "what is still not defined , however , is the relative position of both atoms to each other , since we obtain the same symmetry function values no matter in which wedge at the surface , i.e. , at which distance from each other , the two atoms are located .",
    "this can be remedied by adding a further symmetry function to the set , which is simply given by the distance @xmath23 between both atoms of the molecule .",
    "the final set of symmetry functions for a heteronuclear diatomic molecule is thus    [ heterodiatom ] @xmath53      the symmetry functions defined up to now allow to fully take the symmetry of the solid surface into account , but do not exploit possibly existing symmetries of the molecule itself .",
    "for diatomic molecules this would be the case for homonuclear molecules like o@xmath0 , where an interchange of both atoms should not change the symmetry function values and therewith the input and output of the nn .",
    "considering this additional symmetry explicitly in the nn parameterization is obviously desirable .",
    "similar to the consideration of the surface symmetries , it may even be mandatory from a numerical point of view to avoid artificial symmetry breaking and noise in the fitted total energies and forces .    within the concept of fourier term based symmetry functions ,",
    "such internal molecular symmetries may be accounted for by suitably combining the atomic fourier terms discussed up to now . for this",
    ", it may be convenient to avoid negative function values and this is the reason , why the arbitrary constant @xmath48 has been added to the symmetry functions in eqs .",
    "( [ fouriertop1 ] - [ fourierhcp2 ] ) . in general , such a constant can be added at will , without changing anything in the symmetry properties of the fourier term . for a heteronuclear diatomic molecule adding or not adding this constant makes no difference , and one would simply choose @xmath54 . however ,",
    "if one wants to avoid negative function values , a sufficiently positive value for this constant may equally well be chosen .",
    "for the example of a homonuclear diatomic molecule , the additional symmetry with respect to exchange of the two atoms can then e.g. be incorporated by symmetrizing and antisymmetrizing the fourier terms of both atoms for each surface site yielding the new set of symmetry functions    [ symantisym ] @xmath55    these symmetrized and antisymmetrized atomic fourier terms form `` molecular '' fourier terms and still contain all structural information .",
    "they are plotted in fig .",
    "[ moleculeplot ] as a function of the center - of - mass coordinates @xmath17 and @xmath18 for fixed values of @xmath23 , @xmath19 , @xmath24 and @xmath25 , exhibiting the correct lateral periodicities of the solid surface .    the proper dependence on the angular orientation of the molecule is illustrated in fig .",
    "[ symmetryfuncplot ] . here , the symmetry function values are plotted for a molecule rotating about @xmath25 , i.e. for fixed coordinates @xmath17 , @xmath18 , @xmath19 , @xmath24 and @xmath23 . in fig .",
    "[ symmetryfuncplot]a the molecule is oriented parallel to the surface above an fcc site . a rotation by 60@xmath56 transfers the molecule into an energetically equivalent configuration .",
    "this is reflected in the set of symmetry function    values , which exhibit a periodicity of 60@xmath56 .",
    "if the molecule is not parallel , but tilted with respect to the surface , the symmetry is reduced from 6-fold to 3-fold .",
    "this is exemplified in fig .",
    "[ symmetryfuncplot]b for @xmath24=30@xmath56 , and the symmetry functions are able to describe this complex interdependence between the two angles @xmath24 and @xmath25 correctly .",
    "equivalent performance of the symmetry functions is found for other high - symmetry sites at the surface , namely the top and hcp sites .",
    "equally important , the reduced symmetry at other sites is also properly taken into account , as shown in fig .",
    "[ symmetryfuncplot]c for a molecule at a bridge site and tilted by @xmath24=30@xmath56 .",
    "the symmetry of the remaining mirror plane at the bridge site is reflected in the set of symmetry function values by the symmetry at @xmath25=90@xmath56 and @xmath25=270@xmath56 . due to the inequivalence of the hcp and fcc sites at the fcc(111 ) surface",
    ", there is no symmetry with respect to @xmath25=0@xmath56 and @xmath25=180@xmath56 at the bridge site .",
    "finally , fig .",
    "[ symmetryfuncplot]d demonstrates the capability of the symmetry functions for a low symmetry site at the surface , namely for a molecule located at @xmath57 and @xmath58 . here , the set of symmetry functions is different for each value of @xmath25 because of the absence of symmetry elements at this site .      for diatomic molecules , the derived set of seven symmetry functions ( either @xmath59 for heteronuclear molecules or @xmath60 for homonuclear molecules ) contains already exhaustive information on the molecular configuration .",
    "however , adding further ( redundant ) symmetry functions may nevertheless improve the numerical accuracy of the fit .",
    "for this it is important to realize that the molecular coordinates are always only mapped onto the symmetry functions , which in turn provide the input for the nn . there is no need to ever invert this procedure , i.e. to reconstruct the coordinates of each atom in the molecule that correspond to a given set of symmetry function values .",
    "for the case of a diatomic molecule , the six atomic coordinates may therefore be mapped onto an arbitrarily large set of symmetry functions , if this only helps to achieve a good nn fit to the pes . on the other hand ,",
    "one also has to recognize that the construction of such redundant symmetry functions is necessarily system - specific , and the benefit of including them in the set in terms of lowering the fitting error can only be assessed by trial - and - error .    to provide an example for such redundant symmetry functions",
    ", we will discuss below in the application to the dissociation of o@xmath0 at al(111 ) that we found it useful to include a term depending only on the molecule - surface separation @xmath61 as well as three fourier terms depending on the center of mass of the molecule in the same way as the atomic terms in eqs .",
    "( [ fouriertop]-[fourierhcp ] ) .",
    "@xmath62\\nonumber\\\\&&\\cdot\\exp{\\left(-\\frac{1}{2}z\\right)}\\\\ % \\label{cmsfourier2}g^{10 } & = & \\bigg [ \\cos\\left(\\frac{2\\pi}{a } \\left(\\left(x - x_{\\rm f}\\right)+\\frac{1}{\\sqrt{3}}\\left(y - y_{\\rm f}\\right)\\right)\\right ) \\nonumber\\\\ & & + \\cos\\left(\\frac{4\\pi}{a\\sqrt{3}}\\left(y - y_{\\rm f}\\right)\\right ) \\nonumber \\\\   & & + \\cos\\left ( \\frac{2\\pi}{a}\\left(\\left(x - x_{\\rm f}\\right)-\\frac{1}{\\sqrt{3}}\\left(y - y_{\\rm f}\\right)\\right)\\right)\\bigg]\\nonumber\\\\&&\\cdot\\exp{\\left(-\\frac{1}{2}z\\right)}\\\\ % \\label{cmsfourier3}g^{11 } & = & \\bigg [ \\cos\\left(\\frac{2\\pi}{a } \\left(\\left(x - x_{\\rm h}\\right)+\\frac{1}{\\sqrt{3}}\\left(y - y_{\\rm h}\\right)\\right)\\right ) \\nonumber\\\\ & & + \\cos\\left(\\frac{4\\pi}{a\\sqrt{3}}\\left(y - y_{\\rm h}\\right)\\right ) \\nonumber \\\\   & & + \\cos\\left ( \\frac{2\\pi}{a}\\left(\\left(x - x_{\\rm h}\\right)-\\frac{1}{\\sqrt{3}}\\left(y - y_{\\rm h}\\right)\\right)\\right)\\bigg]\\nonumber\\\\&&\\cdot\\exp{\\left(-\\frac{1}{2}z\\right)}\\end{aligned}\\ ] ] these terms do not break the symmetry of the functions @xmath63 ( or @xmath59 ) and are motivated by the fact that for a small almost spherical diatomic molecule the center of mass position will have a pronounced influence on the energy expression . accordingly , although eqs .",
    "( [ cmsfourier1]-[cmsfourier3 ] ) contain redundant information , this does not complicate the fit , but instead `` assists '' the nn in extracting the energetically relevant structural information .      in order to perform molecular dynamics simulations",
    "the forces acting on the atoms are required .",
    "the force @xmath64 acting in the direction of the molecular coordinate @xmath65 can be obtained analytically from the neural network by @xmath66 the derivative of the total energy with respect to the symmetry functions , i.e. , the input of the nn , is determined by the network structure .",
    "the derivative of the symmetry functions with respect to the molecular coordinates is given by the definitions of the symmetry functions , which thus need to have continuous derivatives .",
    "both can be evaluated analytically , and using these analytic derivatives it is guaranteed that the forces are consistent with the energies , and in particular , that the forces are zero at local minima of the potential - energy surface .",
    "we found that the forces obtained from the neural network are much more precise with respect to the symmetry of the problem than forces directly obtained from dft , since in the latter case even in highly converged calculations the symmetry of the forces is often broken by numerical noise .",
    "we illustrate the use of the developed symmetry functions in the application to the o@xmath0 dissociation at an al(111 ) surface . here , the six - dimensional pes representing the interaction of an o@xmath0 molecule constrained to its spin - triplet state has been of particular interest to explain the experimentally measured low sticking coefficient . for further details on the physics of this system , we refer to refs .   and .",
    "here this particular pes is simply taken as an example to illustrate the nn interpolation scheme .      as input data to the nn",
    ", the six - dimensional pes has been mapped using density - functional theory as implemented in the dmol@xmath67 code  @xcite and employing the rpbe functional  @xcite to describe electronic exchange and correlation .",
    "the kohn - sham orbitals are expanded in a basis of numerical atomic orbitals and polarization functions  @xcite , and the spatial extent of the orbitals is confined by a cutoff of 9 bohr .",
    "a mesh of ( 3@xmath683@xmath681 ) k - points has been used to sample the brillouin zone .",
    "a fermi broadening of 0.1  ev has been applied to improve convergence and the energy was subsequently extrapolated to 0  k. the spin - triplet on the oxygen molecule is enforced by employing a locally - constrained dft approach described in detail in refs .  .",
    "a total of 3768 dft data points has been calculated , mostly contained in 38 different , so - called `` elbow - plots '' , which give the pes as a function of the molecular bond length @xmath23 and distance to surface @xmath19 for fixed molecular orientation and surface site .",
    "the energy zero for the pes has been defined for an infinitely large molecule - surface separation , i.e. , as the sum of the total energy of the clean al(111 ) surface and a free o@xmath0 molecule at its equilibrium bond length .",
    "a detailed account of the dft calculations and selection of the data points can be found in ref . . here , we only mention one aspect that was found to be of importance for the nn fit . for small molecular bond - lengths and small molecule - surface separations",
    "the potential becomes highly repulsive .",
    "this steep rise in the energy ( and consequently larger energy range to be fitted ) caused problems to the achieved accuracy of the nn fit .",
    "however , these high - energy regions are not accessible in md simulations which typically focus on a maximum molecular kinetic energy of 1  ev , and consequently a highly accurate mapping of these parts of the pes is not required .",
    "we thus applied a cutoff function to constrain the highest potential energies to an energy threshold of @xmath69  ev using @xmath70 where @xmath71 has been set to 1  ev .",
    "the potential energies up to + 4  ev are thereby unmodified , while only the higher energies are quenched to approach @xmath72 asymptotically .",
    "constraining the highest energy of the pes in this way reduces the energy range to be fitted , and was found to yield more accurate nn fits in the remaining ( relevant ) energy range .      [ cols=\"<,>\",options=\"header \" , ]     from the total of 3768 dft energy points , 96 randomly chosen points were used as independent test set not included in the nn optimization procedure .",
    "different `` fitting weights '' ( not to be confused with the weight parameters @xmath2 connecting the nn nodes ) were assigned to the remaining dft data points used to train the nn .",
    "the motivation for this was the requirement that the pes representation needs to be most accurate for the low - energy regions along the minimum energy paths .",
    "dft data points corresponding to these regions were thus emphasized in the fit by higher fitting weights , so as to enforce a most accurate reproduction by the optimized nn .",
    "after several tests , the fitting weights compiled in table  [ weights ] were chosen for the nn optimization .    in order to demonstrate the role of the symmetry functions , we proceed in two steps .",
    "first , fits using only functions @xmath63 are constructed , which already contain all relevant structural information . in the next step",
    "fits using all 11 symmetry functions @xmath73 are constructed and the effect of the additional , redundant functions on the numerical accuracy of the results is investigated .",
    "two aspects of the resulting pes representations are of interest : first , the pes should be qualitatively correct , i.e. , all symmetry features of the system must be present .",
    "second , also the quantitative accuracy of the energies should be as close as possible to the underlying dft data .",
    "all in all 64 different nn architectures with varying numbers of hidden layers , nodes per layer and parameters of the kalman filter  @xcite have been tested .",
    "the best fit was obtained using two hidden layers with 40 nodes per layer , the hyperbolic tangent as activation function in the hidden layers and a linear activation function in the output layer . using symmetry functions",
    "@xmath63 only , i.e. the minimum structural information , the root mean square errors ( rmse ) of the training and the test sets are 0.472  ev and 0.329  ev . the mean average deviations ( mad ) are 0.166  ev and 0.196  ev . due to the higher fitting weights assigned to the low energy points ( cf .",
    "table  [ weights ] ) the accuracy of the fit is much better for these dft data points , which represent the most important pes regions for the md applications .",
    "the mad for the points with @xmath74  ev is only 0.070  ev and the points along the entrance channel having the o@xmath0 equilibrium bond length of @xmath75   have a particularly small error of only 0.019  ev , which is very important for an accurate description of steering effects acting on slow molecules approaching the surface .    employing all symmetry functions @xmath73 the rmse of the full training and the test sets",
    "are reduced by one order of magnitude , to 0.049  ev and 0.070  ev , respectively .",
    "the mads are 0.023  ev and 0.033  ev .",
    "this indicates that including the functions describing the center of mass of the o@xmath0 molecule strongly supports the fitting process for the nearly spherical o@xmath0 molecule . the fitting error for the important low - energy points with @xmath74  ev",
    "is now reduced to 0.012  ev and the points along the entrance channel having the o@xmath0 equilibrium bond length of @xmath75   have a very small error of only 1.4  mev .",
    "this excellent overall reproduction of the pes by the optimized nn can also be seen by the three sample `` elbow - plots '' shown in fig .",
    "[ elbowplots ] . however , the inspection of two - dimensional cuts through the 6-dimensional pes is not sufficient to ensure an accurate representation of the pes in all dimensions .",
    "we therefore confirmed the accuracy of the nn pes by comparing several md trajectories run on the nn pes with corresponding direct on - the - fly _ ab initio _",
    "md trajectories .",
    "after 0.2 ps , which is about the time required by a molecule with a translational kinetic energy of 0.15  ev starting at @xmath19=5   to approach the barrier region at @xmath19=2.5   , the positions in the nn pes md and on - the - fly ab initio md differed in all cases by less than 0.1   .",
    "apart from this quantitative assessment of the fitting accuracy , the central aim of the present work is to provide a scheme to construct nn potentials with the correct symmetry properties . in fig .",
    "[ esymmetry ] the potential obtained using functions @xmath76 is plotted for the molecular rotations described in fig .",
    "[ symmetryfuncplot ] .",
    "clearly , the potential exhibits the correct symmetry properties of the different surface sites .",
    "the excellent representation achieved in the model case o@xmath0/al(111 ) demonstrates that the proposed symmetry - adapted nns are very well capable of accurately interpolating a given set of input pes data points .",
    "we acknowledge that mapping the molecular coordinates on slightly involved symmetry functions , as well as evaluating the nn output and its derivative on - the - fly in a md simulation is computationally slightly more demanding than employing simple analytical potentials .",
    "nevertheless , evaluation of the nn pes is still about 5 - 6 orders of magnitude faster than direct dft - based md simulations , and is less susceptible to pes representation errors than the less flexible analytical potentials .",
    "a clear disadvantage of the present nn interpolation scheme is that consideration of further degrees of freedom requires a completely new nn optimization .",
    "whereas it is for example straightforward to consider substrate motion in on - the - fly _ ab initio _",
    "md simulations , this requires a mapping and interpolation of a correspondingly higher dimensional pes in the nn scheme .",
    "one of us is presently developing a new nn approach to this problem @xcite , but the limited dimensionality that can be well treated and the ensuing limitation to the frozen - surface approximation are certainly the biggest drawbacks of the nn scheme as presented here . in this respect , it is only a weak justification , that consideration of only the molecular degrees of freedom has proven to be a valid approximation for a number of adsorbate systems .    with this in mind ,",
    "the systematic construction of symmetry functions based on atomic fourier terms does improve on present nn schemes and replaces the cumbersome empirical construction of complex symmetry functions depending simultaneously on many degrees of freedom .",
    "the correct choice of symmetry functions is essential for an accurate representation of the pes .",
    "inaccurate symmetry functions can treat inequivalent configurations as equivalent , possibly facing the nn with the task to fit two different input energies to `` nominally '' the same structure .",
    "such contradictions typically give rise to bad fits .",
    "vice versa , truly equivalent structures should also yield the same set of symmetry function values , since only then the symmetry of the surface is exactly included in the pes representation ( and in the forces ) , and a numerical symmetry breaking affecting the md trajectories is impossible .",
    "both requirements are met by the current approach .",
    "it is also important to repeat that the mapping of the coordinates is always done only in one direction : from the six molecular coordinates to the 11 symmetry functions for the training of the nn , as well as for the prediction of energies and forces of new structures .",
    "it is not necessary to reconstruct the original set of coordinates from the set of symmetry function values @xmath77 , which also allows us to use rather complicated symmetry functions that are hard to invert .",
    "an application of the here described fourier method to other surface unit - cell shapes and sizes , i.e. other single - crystal surfaces , should in most cases be straightforward .",
    "for rectangular surface unit - cells , e.g. at fcc(100 ) surfaces , the centers of three atomic fourier terms can e.g. be placed at the top , bridge and hollow site to span the symmetry unique wedge of the surface .",
    "also larger surface supercells may readily be used , e.g. in the presence of preadsorbed atoms or surface reconstructions , if the symmetry unique wedge of the surface is chosen accordingly .",
    "finally , in principle it is also possible to describe the simultaneous interaction of two or more diatomic molecules with the surface . in this case",
    "a set of symmetry functions is constructed for each of the two molecules and augmented by terms describing the relative position of the molecules . however , in this case , as well as in the case of poly - atomic molecules , the configuration space , i.e. the dimensionality of the problem , is strongly increased making a systematic mapping of the pes more costly .",
    "this is particularly consequential , since it can not be overstressed that nns are not able to extrapolate the energies of structures outside the configuration spanned by the input data set .",
    "a systematic mapping of the entire pes range of interest as done in the o@xmath0/al(111 ) model case is thus a prerequisite for the presented approach .",
    "we have presented a symmetry - adapted neural network representation of potential - energy surfaces for molecule - surface interactions .",
    "the method builds on symmetry functions , which fully take the symmetry of the surface into account . instead of the molecular coordinates ,",
    "the values of these symmetry functions are used as input for the neural network .",
    "the symmetry functions are constructed in a systematic way from atomic fourier terms and the construction recipe should be readily applicable to a wide range of surface unit - cell sizes and shapes . the accuracy of the method has been demonstrated by interpolating the six - dimensional potential - energy surface of an oxygen molecule in the spin - triplet state interacting with the al(111 ) surface .",
    "the authors wish to thank matthias scheffler for initiating the neural network project and for stimulating discussions .",
    "bernard delley is gratefully acknowledged for providing the dmol@xmath67 code ."
  ],
  "abstract_text": [
    "<S> the accurate description of molecule - surface interactions requires a detailed knowledge of the underlying potential - energy surface ( pes ) . </S>",
    "<S> recently , neural networks ( nns ) have been shown to be an efficient technique to accurately interpolate the pes information provided for a set of molecular configurations , e.g. by first - principles calculations . here </S>",
    "<S> , we further develop this approach by building the nn on a new type of symmetry functions , which allows to take the symmetry of the surface exactly into account . </S>",
    "<S> the accuracy and efficiency of such symmetry - adapted nns is illustrated by the application to a six - dimensional pes describing the interaction of oxygen molecules with the al(111 ) surface . </S>"
  ]
}