{
  "article_text": [
    "the first direct detection of gravitational waves is a key science mission around the world , with many different approaches being advocated .",
    "these include ground and space - based laser interferometers @xcite , and pulsar timing arrays ( collections of galactic millisecond pulsars ( msps ) ; @xcite ) , and it is with the latter of these that we will be concerned with here .",
    "it is the exceptional stability of msps , with decade long observations providing timing measurements that show fractional instabilities similar to atomic clocks ( e.g. ) , that makes them key to the pursuit of a wide range of scientific endeavors .",
    "for example , observations of the pulsar psr b1913 + 16 provided the first indirect detection of gravitational waves @xcite , whilst the double pulsar system psr j0737 - 3039a / b provides precise measurements of several ` post keplerian ' parameters allowing for additional stringent tests of general relativity @xcite .",
    "current theoretical limits ( @xcite ) place the amplitude of a stochastic gravitational wave background ( gwb ) generated by coalescing black holes ( e.g. @xcite ) at only a factor 3 - 10 lower than current observational limits ( e.g. @xcite ) . in order to make the first tentative detections of these signals as much ancillary data will be needed as possible in order to constrain the other components present in the data .",
    "dispersion measure ( dm ) variations are thought to be one of the largest components of noise in pulsar timing data ( e.g. @xcite ) , and many different methods exist to describe it ( e.g. @xcite , henceforth l13 ; lee et al . submitted 2013 ; @xcite ) . in the near future",
    ", observations from lofar will allow precise measurements of dm in the direction of pulsars to be used in pta analysis .",
    "including this information in subsequent analysis in order to constrain the dm signal and separate it from the gravitational waves will thus be critical .    in this article",
    "we describe how to include such dm measurements as prior information in pulsar timing analysis in order to constrain the signal realisation for the dm by modifying the existing bayesian techniques presented in l13 . in section [ section : bayes ]",
    "we give a brief overview of our bayesian methodology , and in section [ section : models ] derive the likelihood that we use to include the additional dm measurements when analysing the simulated data in section [ section : sims ] .",
    "finally we will provide some concluding remarks in section [ section : conclusion ] .",
    "this research is the result of the common effort to directly detect gravitational waves using pulsar timing , known as the european pulsar timing array ( epta ) @xcite .",
    "our method for performing pulsar timing analysis is built upon the principles of bayesian inference , which provides a consistent approach to the estimation of a set of parameters @xmath0 in a model or hypothesis @xmath1 given the data , @xmath2 .",
    "bayes theorem states that :    @xmath3    where @xmath4 is the posterior probability distribution of the parameters , @xmath5 is the likelihood , @xmath6 is the prior probability distribution , and @xmath7 is the bayesian evidence .    in parameter estimation , the normalizing evidence factor",
    "is usually ignored , since it is independent of the parameters @xmath0 .",
    "inferences are therefore obtained by taking samples from the ( unnormalised ) posterior using , for example , standard markov chain monte carlo ( mcmc ) sampling methods .",
    "an alternative to mcmc is the nested sampling approach @xcite , a monte - carlo method targeted at the efficient calculation of the evidence , that also produces posterior inferences as a by - product . in @xcite and @xcite this nested sampling framework",
    "was built upon with the introduction of the multinest algorithm , which provides an efficient means of sampling from posteriors that may contain multiple modes and/or large ( curving ) degeneracies , and also calculates the evidence . since",
    "its release multinest has been used successfully in a wide range of astrophysical problems , from detecting the sunyaev - zeldovich effect in galaxy clusters @xcite , to inferring the properties of a potential stochastic gravitational wave background in pulsar timing array data @xcite . in the following sections we make use of the multinest algorithm to obtain our estimates of the posterior probability distributions for both timing model , and stochastic parameters .",
    "recently temponest ( l13 ) was introduced as a means of performing a simultaneous analysis of either the linear or non - linear timing model and additional stochastic parameters using multinest to efficiently explore this joint parameter space , whilst using tempo2 @xcite as an established means of evaluating the timing model at each point in that space .",
    "we incorporate the likelihood developed in section [ section : models ] into temponest in order to perform the analysis described in section [ section : sims ] .",
    "for any pulsar we can write the toas for the pulses as a sum of both a deterministic and a stochastic component :    @xmath8    where @xmath9 represents the @xmath10 toas for a single pulsar , with @xmath11 and @xmath12 the deterministic and stochastic contributions to the total respectively , where any contributions to the latter will be modelled as random gaussian processes . writing the deterministic signal due to the timing model as @xmath13 , and the uncertainty associated with a particular toa as :    @xmath14    where @xmath15 and @xmath16 represent the efac and equad parameters applied to toa @xmath17 respectively , we can write the probability that the data is described by the timing model parameters @xmath18 and white noise parameters @xmath15 and @xmath16 as :    @xmath19      to include the dm variations , which we will denote @xmath20 , we begin by following the same process as in l13 . writing it in terms of its fourier coefficients",
    "@xmath21 so that @xmath22 where @xmath23 denotes the fourier transform such that for frequency @xmath24 and time @xmath25 we will have both :    @xmath26    and an equivalent cosine term . here the dispersion constant @xmath27 is given by :    @xmath28    @xmath29 is the total observing timespan , @xmath30 is the observing frequency for the toa at barycentric arrival time @xmath25 , and @xmath24 the frequency of the signal to be sampled . defining the number of coefficients to be sampled by @xmath31",
    ", we can then include the set of frequencies with values @xmath32 , where @xmath10 extends from 1 to @xmath31 . for typical pta data @xcite",
    "show that for frequency independent spin noise , a low frequency cut off of @xmath33 is sufficient to accurately describe the expected long term variations present in the data , as the quadratic included in the timing model in the form of the spindown parameters acts as a proxy to lower frequency signals . for dm variations ,",
    "however , these terms must be accounted for either by explicitly including these low frequencies in the model , or by including a quadratic in dm to act as a proxy , as with the red noise , defined as :    @xmath34    with @xmath35 free parameters to be fitted , @xmath36 the barycentric arrival time for toa @xmath17 and @xmath37 elements of a vector :    @xmath38    for a single pulsar the covariance matrix @xmath39 of the fourier coefficients @xmath21 will be diagonal , with components    @xmath40    where there is no sum over @xmath17 , and the set of coefficients @xmath41 represent the theoretical power spectrum for the dm variations in the residuals .    as discussed in @xcite , whilst eq [ eq : bprior ]",
    "states that the fourier modes are orthogonal to one another , this does not mean that we assume they are orthogonal in the time domain where they are sampled , and it can be shown that this non - orthogonality is accounted for within the likelihood . instead , in bayesian terms",
    ", eq . [ eq : bprior ] represents our prior knowledge of the power spectrum coefficients within the data .",
    "we are therefore stating that , whilst we do not know the form the power spectrum will take , we know that the underlying fourier modes are still orthogonal by definition , regardless of how they are sampled in the time domain .",
    "it is here then that , should one wish to fit a specific model to the power spectrum coefficients at the point of sampling , such as a broken , or single power law , the set of coefficients @xmath41 should be given by some function @xmath42 , where we sample from the parameters @xmath0 from which the power spectrum coefficients @xmath41 can then be derived .",
    "we can then write the joint probability density of the timing model , white noise parameters , power spectrum coefficients and the signal realisation , pr@xmath43 , as :    @xmath44    where @xmath45 represents any additional prior information regarding the dm signal realisation . henceforth we will consider @xmath45 to be given by a vector of measurements of the dm at some set of arbitrary times with associated measurement errors , which we will denote @xmath46 and @xmath47 respectively .",
    "for our choice of @xmath48 we use an uninformative prior that is uniform in @xmath49 space , and draw our samples from the parameter @xmath50 instead of @xmath51 . given this choice of prior the conditional distributions that make up eq . [ eq : prob ]",
    "can be written :    @xmath52 \\nonumber\\end{aligned}\\ ] ]    where @xmath53 and represents the white noise errors in the residuals , and @xmath54 describes components of the dm model in addition to those contained in the fourier modes , such as the quadratic terms in the timing model which we have separated from the @xmath13 term for clarity .",
    "we then also have :    @xmath55 \\\\ \\nonumber & \\times & \\frac{1}{\\sqrt{\\mathrm{det}\\bmath{\\psi}}}\\exp\\left[-\\frac{1}{2}(\\bmath{l_{dm}}-\\bmath{f_{dm}}-\\bmath{f_la})^t\\bmath{\\psi}^{-1}\\right.\\nonumber \\\\ & \\times & \\left.(\\bmath{l_{dm}}-\\bmath{f_{dm}}-\\bmath{f_la})\\right].\\end{aligned}\\ ] ]    here @xmath56 is a matrix of fourier modes as in eq .",
    "[ eq : fmatrix ] , however with points evaluated at the times that additional dm measurements were made , and @xmath57 is the diagonal noise matrix for the additional dm measurements with values @xmath47 .",
    "we then marginalise over all fourier coefficients @xmath21 analytically in order to find the posterior for the remaining parameters alone .    in order to perform the marginalisation over the fourier coefficients",
    "@xmath21 , we first write the log of the likelihood in eq [ eq : prob ] , which , excluding the determinant terms , and denoting @xmath58 as @xmath59 , @xmath60 as @xmath61 , @xmath62 as @xmath63 and @xmath64 as @xmath65 is given by : @xmath66 taking the derivitive of @xmath67 with respect to @xmath21 gives us : @xmath68 which can be solved to give us the maximum likelihood vector of coefficients @xmath69 : @xmath70 re - expressing eq .",
    "[ eq : logl ] in terms of @xmath69 :    @xmath71    the 3rd term in this expression can then be integrated with respect to the @xmath72 elements in @xmath21 to give : @xmath73 \\nonumber \\\\ & = & ( 2\\pi)^m~\\mathrm{det } ~ \\bmath{\\sigma}^{-\\frac{1}{2}}.\\end{aligned}\\ ] ] our marginalised probability distribution for a set of gwb coefficients is then given as : @xmath74 , \\nonumber\\end{aligned}\\ ] ]      in much the same way in which we include an efac in the white noise matrix to alter the weighting of the data , we can include an efac in the matrix @xmath57 in order to alter the weight of the dm measurements in the event that the errors provided are under , or over estimated , or if the measurements are not consistent with the timing data .",
    "as such we can simply define :    @xmath75    in the simulations described in section [ section : sims ] however , we will not include this additional parameter .",
    "we can include additional , frequency independent red ` spin ' noise in much the same way as the dm variations .",
    "as before we define a matrix of fourier modes for a set of @xmath10 frequencies :    @xmath76    and an equivalent cosine term .",
    "these rows can then be appended to the fourier matrix in eq.[eq : fmatrix ] , which we will denote here @xmath77 to form a new matrix containing both the red noise and dm terms :    @xmath78    similarly the matrix @xmath39 is extended to accommodate the new power spectrum coefficients required to describe the spin noise . the additional dm prior term is then kept the same : in forming the matrix @xmath79 we add the term @xmath80 to only the section of the matrix @xmath81 that corresponds to the autocorrelated terms of the dm modes , and similarly the vector @xmath82 is added only to the part of @xmath83 concerned with the dm fourier modes when forming @xmath65 .      in many pulsar timing datasets , phase jumps",
    "are fitted between different groups of observations , or there might be other parameters that are not of interest , such as a constant phase offset , resulting in a potentially significant increase in the number of parameters to be fit for in analysis .",
    "if the specific values of such parameters are not of importance we can marginalise analytically over them , greatly reducing the dimensionality of the problem .",
    "if we separate the timing model into a contribution from the set of parameters that we wish to parameterise @xmath13 and a contribution from the set of @xmath72 parameters that we plan to marginalise over analytically @xmath84 then we can write the probability that the data @xmath85 is described by the remaining parameters @xmath18 and any additional parameters @xmath86 we wish to include as :    @xmath87    using a uniform prior on the @xmath72 @xmath88 parameters , we use the same approach as described in @xcite to perform this marginalisation process analytically . this results in equation [ eq : llikemargin ] , which is the expression we will be using in the subsequent analysis :    @xmath89 , \\end{aligned}\\ ] ]    where @xmath90 , @xmath91 and @xmath92 .",
    "[ cols=\"<,^,^,^\",options=\"header \" , ]     [ table : sim1 ]    in order to check the efficacy of the method described in section [ section : models ] we simulate a dataset for the isolated pulsar j0030 + 0451 .",
    "we begin by taking the injected parameter values given in table [ table : sim1 ] and generate a 5 year dataset with uneven sampling in the time domain , but with an average cadence of @xmath93 2 weeks .",
    "we include two observing frequencies at 1440 and 2440 mhz where the higher frequency observations exist only for the latter @xmath94 of the observations , and where no multi - frequency data exists for any given observing epoch of duration @xmath93 2 weeks .",
    "we then add variations in the dm that are described by a power law with functional form @xmath95 with a spectral index of @xmath96 .",
    "note that we do not list injected values for the @xmath97 and @xmath98 parameters as these are used simply as proxies to the low frequency dm variations , and as such we do not know a priori what these values will take .",
    "we then simulate discrete observations of the total dm signal that will act as our prior , @xmath46 .",
    "we generate monthly samples that are scattered around the true signal with an rms of @xmath99@xmath100  pc .",
    "the injected dm signal , simulated dm observations , and the final residuals obtained when subtracting the injected timing model parameters in table [ table : sim1 ] except the dm parameters , are shown in fig .",
    "[ fig : res ] .",
    "in addition to the timing model and dm parameters , we also include a red noise power law model in our analysis , of the same functional form as the dm spectrum .",
    "we initially performed our analysis using a log uniform prior on the red noise amplitude , however as can be seen in fig .",
    "[ fig : logred ] the signal is completely unconstrained below some upper limit . when using a log uniform prior this upper limit",
    "will be dependent upon the lower limit chosen for the prior , and as such we instead use a uniform prior on the red noise amplitude , in order to obtain a robust upper limit on the signal .    in fig .",
    "[ figure : timingposteriors ] we show the one dimensional posteriors for the timing model and stochastic parameters given in table [ table : sim1 ] when including ( blue ) , and not including ( red ) , the simulated dm observations as additional prior information . for the timing model parameters the injected value , when known , is given by 0 on the @xmath101 axis , which is in units of the 1@xmath102 uncertainty returned by tempo2 when not including either the red noise or dm power law model components .",
    "the clear result here is that the precision with which the timing model parameters have been recovered has improved significantly when including the additional prior information , between a factor @xmath103 .",
    "comparing the posteriors for the amplitude of the red noise power law , when including the additional prior information the upper limit decreases by a factor of @xmath104 , demonstrating how critical such data will be in constraining gravitational wave signals in pulsar timing data .",
    "@xmath105{signal.pdf } & % \\includegraphics[width=80mm]{res.pdf } \\\\",
    "\\end{array}$ ]    @xmath105{logredamp.pdf } & % \\includegraphics[width=80mm]{logredindex.pdf } \\\\",
    "\\end{array}$ ]    @xmath106{ra.pdf } & \\includegraphics[width=50mm]{dec.pdf } & \\includegraphics[width=50mm]{f0.pdf } \\\\ % % \\hspace{-0.5 cm } \\includegraphics[width=50mm]{f1.pdf } & \\includegraphics[width=50mm]{pmra.pdf } & \\includegraphics[width=50mm]{pmdec.pdf } \\\\ % % \\hspace{-0.5 cm } \\includegraphics[width=50mm]{dm.pdf } & \\includegraphics[width=50mm]{dm1.pdf } & \\includegraphics[width=50mm]{dm2.pdf } \\\\ % % \\hspace{-0.5 cm } \\includegraphics[width=50mm]{px.pdf } & \\includegraphics[width=50mm]{redamp.pdf } & \\includegraphics[width=50mm]{redspec.pdf } \\\\ % % \\hspace{-0.5 cm } \\includegraphics[width=50mm]{dmamp.pdf } & \\includegraphics[width=50mm]{dmindex.pdf } & \\\\ % \\end{array}$ ]",
    "we have discussed a method of including discrete measurements of the dispersion measure in the direction of a pulsar as prior information in the analysis of that pulsar . by using an existing bayesian framework ,",
    "this prior information can be simply folded into the analysis and used to constrain the dm signal realisation in pulsar timing data .",
    "we have shown that this method can be applied where no multi - frequency data exists across much of the dataset , and does not require simultaneous multi - frequency data to be present for any observing epoch .",
    "we have shown that , as expected , including this prior information can greatly increase both the precision of the timing model parameters recovered from the analysis , as well as increase the sensitivity to red noise in the data .",
    "clearly the level of improvement in real data will be entirely dependent on the dataset in question , however the inclusion of such prior information will likely prove extremely useful both to test the validity of existing models for dm , and to improve constraints in future analysis .",
    "many thanks to jason hessels for assistance in the production of this work ."
  ],
  "abstract_text": [
    "<S> here we present a bayesian method of including discrete measurements of dispersion measure due to the interstellar medium in the direction of a pulsar as prior information in the analysis of that pulsar . </S>",
    "<S> we use a simple simulation to show the efficacy of this method , where the inclusion of the additional measurements results in both a significant increase in the precision with which the timing model parameters can be obtained , and an improved upper limit on the amplitude of any red noise in the dataset . </S>",
    "<S> we show that this method can be applied where no multi - frequency data exists across much of the dataset , and where there is no simultaneous multi - frequency data for any given observing epoch . </S>",
    "<S> including such information in the analysis of upcoming international pulsar timing array ( ipta ) and european pulsar timing array ( epta ) data releases could therefore prove invaluable in obtaining the most constraining limits on gravitational wave signals within those datasets .    </S>",
    "<S> [ firstpage ]    methods : data analysis , pulsars : general , pulsars : individual </S>"
  ]
}