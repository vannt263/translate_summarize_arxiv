{
  "article_text": [
    "much of our insight into the dynamics of galaxy structure and evolution relies on the properties of regular orbits .",
    "we commonly assume that regular orbits dominate owing to the importance of baryonic dissipation during galaxy formation : dissipation naturally selects non - intersecting orbits and is the principal enforcer of axisymmetry . following the mostly successful @xmath0cdm paradigm , we assume that galaxies are a combination of dissipative ( disks ) and non - dissipative ( dark - matter and stars ) components with different geometries .",
    "there is no natural reason to assume that sufficient conditions for regularity ( i.e. the simultaneous separability of both the hamilton - jacobi equation and the poisson equation defined by the stckel conditions , e.g. @xcite ) coincides with this combination of dissipative and dissipationless dynamical processes .",
    "therefore , these dynamical systems are not regular everywhere almost certainly .    on the other hand , owing to ease of computation , insight provided by regular systems underpins most of our physical scenarios for galactic stability , structure and evolution .",
    "for example , theories of spiral arms , swing amplification , among others assume regularity .",
    "the author has made predictions for the secular evolution of galaxies in combined disk and spheroid systems using classical hamiltonian perturbation theory ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this previous work assumes that only one resonance influences the dynamics of any one otherwise regular orbit at one time using the averaging theorem ( e.g. * ? ? ?",
    "the current paper assesses the failure of this assumption and provides a tool for identifying important dynamics missed by the averaging approximation",
    ". moreover , environmental perturbations and secular and possibly dynamical instabilities yield bars and spiral arms .",
    "some of these features are strong perturbations and are likely to generate irregular orbits .",
    "specifically , is it possible that our ignorance of irregular behaviour biases our interpretive insight ?    in this paper , we present a general method based on one of the mathematical tools used in some proofs of the kolmogorov - arnold - moser ( kam ) theorem for studying the regular orbits that are preserved under perturbations . recall that regular orbits in a bound system are fully characterised by a full set of constants of the motion , often chosen to be action - angle variables for theoretical convenience .",
    "these variables are constructed by finding the canonical transformation from a set of cartesian variables ( or some other conical coordinate system ) to a new set which leaves the hamiltonian independent of angles .",
    "the hamilton - jacobi ( hj ) equation defines this canonical transformation implicitly .",
    "for regular systems , the action - angle variables define tori in phase space that fully describe the quasi - periodic motion .",
    "the approach pursued here is the construction of numerical solution of the hj equation for a perturbed regular system .",
    "if the solution exists , the new transformation yields a new set of action - angle variables .",
    "if the solution does not exist , the torus is presumed destroyed ; that is , one or more of the actions is no longer a constant of the motion and the trajectory may appear chaotic .",
    "this approach is complementary to the most popular approach for studying chaos : lyapunov exponent analysis .",
    "while a study of lyapunov exponents provides a local phase - space measure for orbits whose trajectories diverge exponentially under the influence of a perturbation , exponent values close to zero provide little useful information for the surviving regular orbits .",
    "conversely , the kam procedure characterises the orbits distorted by a perturber while identifying but not characterising the orbit of the broken tori",
    ". finally , if irregular dynamics is important for galaxies , the dynamics are likely to appear in stochastic layers around primary resonances and these need to be accounted for by criteria used by n - body simulators to determine phase - space and temporal resolution ( see @xcite for a widely - used example ) .",
    "this paper develops the basic formalism and presents the results for the circular restricted three - body problem as an example . in the companion papers ,",
    "we explore the question of how prevalent is irregularity in systems of interest and how might this irregularity affect galaxy structure and evolution ?    since these issues in modern non - linear dynamics will be unfamiliar to many , we begin with a quick review of the theoretical motivation in section [ sec : hj ] followed by a discussion of standard practice in galaxy dynamics section [ sec : galdynintro ] .",
    "kam theory is at the heart of modern hamiltonian dynamics .",
    "the fundamental problem addressed by kam theory first arose in the three - body problem beginning with poincar : the introduction of a third body into the integrable gravitational two - body system renders the dynamics non - integrable , independent of the mass of the bodies .",
    "there exists a large literature on perturbative tools for constructing approximate integrable systems for solar - system dynamics ( see * ? ? ?",
    "* for a pre - kam summary ) .",
    "these tools are based on expansions the ratio of the planet mass to the solar mass , a small parameter . then , they reduce the degrees of freedom of the problem by identifying uninteresting degrees of freedom and integrating or _ averaging _ the resulting equations of motion over these uninteresting variables . however , the convergence of these series is questionable owing to the appearance of small denominators in the solution to the averaged equations .",
    "poincar called this fundamental problem of mechanics ( see @xcite for an historical review ) .",
    "the essence of the vanishing - denominator conundrum will be familiar to most physics students in the context of a forced harmonic oscillator .",
    "if the external force matches the oscillator s natural frequency ( i.e. is resonant ) the linear solution is unbounded . more generally , the response of the non - linear oscillator is bounded but will tend to generate oscillations in multiples of the driving frequency resulting many resonances . if we add a second non - linear oscillator , the accidental near coincidence of two harmonics may lead to erratic behaviour . in a similar way ,",
    "let us consider a solar system with two planets ; one planet exerts a periodic force on the motion of a second .",
    "expanding the perturbation in a fourier series , we may recast the problem as that of coupled pendula forced by all combinations of all possible harmonics of the natural frequencies of the two planets .",
    "the commensurability of the orbital periods for one or more terms in the fourier series of sufficient amplitude can lead to small denominators resulting from resonant and divergence of the expansion .",
    "@xcite suggested an two - part approach to obtaining convergence of these series .",
    "first , proceeding in the standard way , one may linearize the problem about an approximate solution and obtain an the approximate solution complete with small denominators .",
    "secondly , one may improve the approximate solution inductively using a quadratically convergent iterative method .",
    "success of this approach relies on the choice of initial conditions such that the denominators do not vanish for low - order harmonic terms _ and _ that the amplitude of the harmonics terms approach zero exponentially with increasing harmonic order .",
    "these ideas were then made rigorous by ( i.e. * ? ? ?",
    "* ) and @xcite and led to what we now know as the kam theory . in short , systems that can be shown to satisfy the kam theorem have to be sufficient smooth and continuous and not have commensurate frequencies to some maximal order for some perturbation amplitude @xmath1 smaller than some bound , @xmath2 .",
    "kam theory does not solve the problem of non - integrability but helps explain its genesis .",
    "specifically , tori may be destroyed if the frequencies approach low - order commensurabilities or the perturbation strength @xmath1 grows .",
    "although kam theory does not estimate the chaotic measure , direct numerical solution of the perturbed equations of motion or evolution using hamiltonian maps suggests that modest perturbation strengths induce a non - zero measure of chaotic orbits .",
    "the resulting phase space consists of a combination of regular and irregular regions often called a _",
    "mixed phase space_. when most tori are broken , even those far from the original location of the vanishing denominators , the actions of the chaotic trajectories drift in the irregular regions and the remaining tori are localised to resonances , so - called _ regular islands_. a detailed description of this theory is beyond the scope of this paper .",
    "however , while reading various introductions to the current version of the kam theory ( e.g. * ? ? ?",
    "* ) while on sabbatical at the institute for advanced study several years ago , i was struck by the algorithmic nature of kolmogorov s underlying concept .",
    "the basic tools are part of the every numericist s standard arsenal : newton s method and numerical fourier transforms .",
    "can one use these tools _ numerically _ to understand practical astronomical problems ?",
    "the answer appears to be : yes ! the outstanding question for us here is : does this generic dynamical picture of mixed phase space have implications for galactic dynamics ?      the same general ingredients necessary to understand modern celestial dynamics applies to our understanding of galactic dynamics .",
    "as in the perturbation theories described in @xcite , we may exploit the quasi - periodic nature of the unperturbed representation of the phase space to convert the dynamical partial - differential equations to an series of algebraic equations .",
    "this series corresponds to an ordering in increasing spatial frequencies .",
    "truncating this series on physical grounds yields an algebraically tractable set of linear equations .",
    "the main difference arises in the broader frequency spectrum and therefore slower convergence the perturbed kepler problem .",
    "in addition , the approach here abandons the averaging theorem that artificially isolated resonances .    using a related but orthogonal approach ,",
    "james binney and collaborators have made enormous progress in their program to derive approximate angle - action coordinates from the standard cartesian phase - space coordinates ( and vice versa ) that they call _ torus mapping_. in a fiducial series of papers , @xcite show that generating functions formulated as action - angle series together with a careful choice of a nearly analytic hamiltonian that approximates the system of interest and an appropriately tuned cost function may be used to solve for the coefficients of the canonical generating function with sufficient accuracy to obtain tori that are excellent approximations to systems of astronomical interest .",
    "more recently , @xcite demonstrated that this approach works well in three - dimensional as well as two - dimensional problems .",
    "although both approaches begin with an action - angle expansion of the canonical generating function , we are attempting to discover , quantify and understand the role of irregularity galaxies rather than trying to obtain regular approximations to galaxies .",
    "torus mapping uses a cost function to match the coefficients of the generating function series in the least - squares sense to a target hamiltonian . in the approach considered here",
    ", we attempt to implicitly solve for the values of these coefficients that leaves the target hamiltonian invariant .",
    "formally , this is equivalent to solving the hamilton - jacobi equation that defines the actions and angles , as described earlier .    as a first galactic application , ( * ? ?",
    "* hereafter paper 2 ) applies the method developed in this paper to investigate the role of chaos in barred galaxies .",
    "most certainly , we are not the first to consider the importance of chaos in barred galaxies ; e.g. for a selection of relatively recent papers see ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and references therein .",
    "rather , this work was intended to test the approach on a well investigated astronomical scenario . using the new numerical kam approach ,",
    "we can easily identify , in phase space , the tori that survive under the self - consistent perturbation of the bar potential on the overall gravitational potential .    secondly , although collisionless and collisional dissipation lead to systems that are approximately regular , the combination of the two are _ not _ regular .",
    "specifically , a dark halo yields a weakly triaxial system , and therefore approximately spherical system .",
    "stable spherical systems are regular .",
    "the baryonic component quickly settles into an approximately axisymmetric or elliptical disk , another nearly regular system .",
    "however the join of the two systems , as we envision most galaxies , are unlikely to be regular . moreover",
    ", a general three - dimensional stellar disk will not have regular orbits .",
    "therefore , there will be irregular , chaotic regions in phase space in addition to regular regions .",
    "this simple observation raises several questions .",
    "are there generic features of a exponential stellar disk induced by breaking of invariant tori ?",
    "do the chaotic regions enable significant structural evolution in a galaxy lifetime ?",
    "therefore , as a second application of the numerical kam method , we consider this problem in ( * ? ?",
    "* hereafter paper 3 ) .      to investigate these questions , we will develop a computational method that seeks numerical solutions to the hamilton - jacobi ( hj ) equation for a irregular system by successive perturbations to an initially regular system .",
    "we will review the mathematical background and develop the method in section [ sec : kam ] .",
    "for the galactic applications described above , we will begin with the spherical system whose radial profile is obtained from the monopole or other appropriate spherical approximation for gravitational potential of the full non - spherical mass distribution .",
    "the perturbation , then , is the difference between full mass distribution and the monopole distribution .",
    "for example , to investigate irregularity of the combined dark halo  galactic disk system , we consider the unperturbed system to be the monopole part of the multipole expansion for the entire system .",
    "the resulting massless perturbation squeezes the isopotential surfaces towards the disk plane .",
    "then , one may investigate the evolving regular orbits ( tori ) by successively increasing the perturbation until the target mass distribution is reached .",
    "section [ sec : hj ] describes the mathematical approach followed by a description of the numerical algorithm whose details can be found in appendix [ sec : numerical ] .",
    "we conclude with a summary and discussion in section [ sec : summary ] .",
    "the action - angle variables for a time - independent equilibrium system are the result of seeking a canonical transformation that leaves the hamiltonian a function of momentum variables alone . if the ansatz of a generating function separable in the new momentum variables",
    "also separates the hamiltonian for bound values of the energy , the resulting the resulting equations of motion are angle - like variables that increase linearly with time describing the quasi - periodic motion .",
    "the new momenta are constant in time because the hamiltonian is coordinate independent . with an appropriate scaling , the new coordinates may be chosen to advance by @xmath3 for each cycle .",
    "let these new momenta and coordinates ( action - angle variables ) be denoted by @xmath4 .",
    "geometrically , these new coordinates define a tori in phase space .",
    "if the system is everywhere regular , the phase space is foliated by tori .",
    "the existence of action - angle variables implies a system of regular orbits .",
    "although this construction is sufficient but not necessary for regularity , it is the usual starting point for most discussions .",
    "more generally , orbits are often defined to be irregular if distance between two phase - space states with small initial distance increases exponentially .",
    "this exponential divergence implies that any notion of predictability or _ memory _ of the initial state is soon lost .",
    "clearly , trajectories defined by action - angle variables are confined to tori and will not be exponentially divergent .",
    "now , assume a system of regular orbits specified by action - angle variables @xmath4 with the hamilton @xmath5 .",
    "for the problems considered in this paper , we will begin with a spherical unperturbed mass distribution . in the case , the values for @xmath6 , @xmath7 are always available by quadrature given @xmath8 .",
    "thus , the regular system defined by a spherical potential provides a good starting point for adding perturbations that induce irregularity .",
    "the same features hold true for any potential in stckel form @xcite but the general coordinate systems are more cumbersome ( e.g. * ? ? ?",
    "as we will see in the development below , a chain of successive perturbations and canonical transformations describing invariant tori will be tied , through interpolation , to this fiducial foliation of phase space by regular orbits .",
    "we apply a non - spherical perturbation , @xmath9 where @xmath10 are the radius , colatitude , and azimuthal angle , respectively , so that the total hamiltonian is @xmath11 given some non - spherical or non - axisymmetric perturbation , we often rewrite equation ( [ eq : pertham ] ) to _ define _ the perturbation : @xmath12 . for a spherical distribution @xmath13 and @xmath14",
    "are three - vectors ( see * ? ? ?",
    "* for an explicit representation ) .",
    "we could use the extended phase - space paradigm ( e.g. * ? ? ?",
    "3 ) to include time dependence without any substantive changes to this development .",
    "however , to simply notation , we assume that the perturbation is time independent .",
    "following the standard procedure for solving the hj equation , we seek a new set of canonical variables , @xmath15 say , such that @xmath16 .",
    "we assume a time - independent canonical generator to transform from the original action - angle variables to a new set of action - angle variables @xmath17 to first order in the perturbation : @xmath18 this is a standard type 2 generating function @xcite .",
    "the first term in equation ( [ eq : f1 ] ) generates the identity transformation .",
    "the new canonical variables are then ( e.g. * ? ? ?",
    "* ) @xmath19 } \\label{eq : ci } \\\\     { \\mathbf{s}}&= \\frac{\\partial f_1}{\\partial{\\mathbf{j } } } = { \\mathbf{w}}+      \\frac{\\partial w_1}{\\partial{\\mathbf{j } } }      & & \\mbox{[new ] } \\label{eq : cw}\\end{aligned}\\ ] ] and the new hamiltonian is @xmath20 recall that @xmath21 defines the time - independent hj equation and is an implicit equation for the term @xmath22 through equation ( [ eq : ci ] ) .",
    "the key to finding @xmath23 is the implicit solution for @xmath22 defined by equation ( [ eq : hnew ] ) .",
    "once we have the generating function @xmath22 , the new action variables follow immediately from equation ( [ eq : ci ] ) .      a direct solution of the hj equation ( defined through equations [ eq : hnew ] and [ eq : hj ] ) using a numerical partial differential equation scheme is not practical for problems of interest .",
    "rather , we define a solution based on a succession of first - order expansions .",
    "the solution is then iterated to improve the approximation to @xmath22 until the desired convergence is obtained .",
    "the solution is constructed inductively as follows .",
    "assume that we have an approximate solution @xmath24}$ ] at iteration @xmath25 whose deviation from an exact solution is @xmath26 } \\equiv h\\bigg({\\mathbf{j}}+\\frac{\\partial w_1^{[n]}}{\\partial{\\mathbf{w } } } ,      { \\mathbf{w}}\\bigg ) - h_{new}^{[n]}({\\mathbf{j } } )    \\label{eq : q_n}\\ ] ] where @xmath27}({\\mathbf{j } } ) \\equiv \\frac{1}{(2\\pi)^3 } \\oint d{\\mathbf{w}}h\\bigg({\\mathbf{j}}+\\frac{\\partial w_1^{[n]}}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg ) .",
    "\\label{eq : havg}\\ ] ] the solution @xmath24}$ ] will be @xmath28 , that is , the order of the perturbing potential . if @xmath24}$ ] is exactly @xmath22 , then equation ( [ eq : q_n ] ) yields @xmath29}=0 $ ] owing to equation ( [ eq : hnew ] ) . similarly ,",
    "if @xmath30}({\\mathbf{j}})$ ] is exactly @xmath23 then the definition in equation ( [ eq : havg ] ) is an identity .",
    "however , if @xmath29}\\not=0 $ ] , then @xmath29}$ ] is second - order in the small perturbation @xmath24}$ ] by construction .",
    "now , let us look for an improved solution , @xmath31 } = w_1^{[n ] } + \\delta w_1^{[n]}$ ] where @xmath32 } ] = \\mathcal{o}[q^{[n]}]$ ] from the definition in equation ( [ eq : q_n ] ) .",
    "the improvement @xmath33}$ ] removes an additional piece of the discrepancy between @xmath30}$ ] and @xmath34 which is already of order @xmath29}$ ] .",
    "we will explicitly derive the improvement in terms of the next order difference @xmath35}$ ] and demonstrate the following ordering @xmath36 } =    h\\bigg({\\mathbf{j}}+\\frac{\\partial w_1^{[n+1]}}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg )    -   h_{new}^{[n+1]}({\\mathbf{j } } ) = \\mathcal{o}[(q^{[n]})^2 ] .",
    "\\label{eq : qquad}\\ ] ] this implies that the iteration converges quadratically .",
    "we assume the existence of solution @xmath24}$ ] and endeavour to obtain the solution @xmath31}$ ] such that @xmath37}({\\mathbf{j } } ) =   h\\bigg({\\mathbf{j}}+\\frac{\\partial        w_1^{[n+1]}}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg ) .",
    "\\label{eq : iternp1}\\ ] ] although we do not know @xmath38}({\\mathbf{j}})$ ] a priori , it is a constant with respect to the new angle @xmath39 will not affect our solution .",
    "we begin with the taylor series expansion of equation ( [ eq : iternp1 ] ) in @xmath33}$ ] : @xmath40}({\\mathbf{j } } ) & = &       h\\bigg({\\mathbf{j}}+\\frac{\\partial w_1^{[n+1]}}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg )    = h\\bigg({\\mathbf{j}}+\\frac{\\partial w_1^{[n]}}{\\partial{\\mathbf{w } } } +      \\frac{\\partial\\delta w_1^{[n]}}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg ) \\nonumber    \\\\    & = &     h\\bigg({\\mathbf{j}}+\\frac{\\partial w_1^{[n]}}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg ) +    \\frac{\\partial h}{\\partial{\\mathbf{i}}}\\cdot\\frac{\\partial\\delta      w_1^{[n]}}{\\partial{\\mathbf{w } } } + \\mathcal{o}[(q^{[n]})^2 ] , \\nonumber \\\\    & = &     q^{[n ] } + h_{new}^{[n]}({{\\mathbf{j } } } ) +    \\frac{\\partial h}{\\partial{\\mathbf{i}}}\\cdot\\frac{\\partial\\delta      w_1^{[n]}}{\\partial{\\mathbf{w } } } + \\mathcal{o}[(q^{[n]})^2 ]    \\label{eq : hjq}\\end{aligned}\\ ] ] having substituted equation ( [ eq : q_n ] ) and @xmath41 is evaluated at @xmath42}/\\partial{\\mathbf{w}})$ ] .",
    "the function @xmath43 may be evaluated implicitly in terms of iteration quantities as follows : @xmath44}}{\\partial{\\mathbf{j } } } = \\frac{\\partial h}{\\partial{\\mathbf{j } } } -     \\frac{\\partial h_{new}^{[n]}({\\mathbf{j}})}{\\partial{\\mathbf{j } } }    & = & \\frac{\\partial h}{\\partial{\\mathbf{i}}}\\cdot\\bigg[\\mathbf{1 } + \\frac{\\partial^2        w_1^{[n]}}{\\partial{\\mathbf{j}}\\partial{\\mathbf{w}}}\\bigg ] -     \\frac{\\partial h_{new}^{[n]}({\\mathbf{j}})}{\\partial{\\mathbf{j } } } \\nonumber \\\\    & = & \\bigg[\\mathbf{1 } + \\frac{\\partial^2        w_1^{[n]}}{\\partial{\\mathbf{j}}\\partial{\\mathbf{w}}}\\bigg]^t \\cdot \\frac{\\partial      h}{\\partial{\\mathbf{i } } } - \\frac{\\partial h_{new}^{[n]}({\\mathbf{j}})}{\\partial{\\mathbf{j}}}.\\end{aligned}\\ ] ] after rearranging , we find @xmath45}}{\\partial{\\mathbf{j}}\\partial{\\mathbf{w}}}\\bigg]^t\\bigg)^{-1 }    \\bigg(\\frac{\\partial q^{[n]}}{\\partial{\\mathbf{j } } } +       \\frac{\\partial h_{new}^{[n]}}{\\partial{\\mathbf{j}}}\\bigg ) .",
    "\\label{eq : dhdi}\\ ] ] since @xmath46}_1}{\\partial{\\mathbf{j}}\\partial{\\mathbf{w}}}\\bigg)^t\\bigg]^{-1 }     \\bigg(\\frac{\\partial q^{[n]}}{\\partial{\\mathbf{j}}}\\bigg ) \\cdot    \\frac{\\partial\\delta w^{[n]}_1}{\\partial{\\mathbf{w } } }    = \\mathcal{o}\\bigg[(q^{[n]})^2\\bigg],\\ ] ] we may ignore the @xmath47}/\\partial{\\mathbf{j}}$ ] term in equation ( [ eq : dhdi ] ) upon substituting into equation ( [ eq : hjq ] ) to @xmath48})^2]$ ] . performing the substitution ,",
    "the equality in the last of equation ( [ eq : hjq ] ) becomes @xmath26 } +    \\frac{\\partial h_{new}^{[n]}}{\\partial{\\mathbf{j}}}\\cdot    \\bigg[\\bigg(\\mathbf{1}+\\frac{\\partial^2          w_1^{[n]}}{\\partial{\\mathbf{j}}\\partial{\\mathbf{w}}}\\bigg)^t\\bigg]^{-1 }    \\cdot\\frac{\\partial\\delta w_1^{[n]}}{\\partial{\\mathbf{w } } } =    h_{new}^{[n+1]}({\\mathbf{j } } ) - h_{new}^{[n]}({\\mathbf{j } } )    \\label{eq : solhj}\\ ] ] up to terms with @xmath48})^2]$ ] .",
    "because @xmath29}$ ] , @xmath30}$ ] and @xmath24}$ ] are known quantities at this point in the iteration , equation ( [ eq : solhj ] ) may be solved explicitly for @xmath33}$ ] to first - order accuracy yielding a solution to @xmath35}=0 $ ] that is accurate to @xmath49})^2]$ ] .",
    "in other words , we have shown that @xmath50 } ] = \\mathcal{o}[(\\delta q^{[n]})^2]$ ] , and , therefore , the iterative correction to @xmath29}$ ] defined by equations ( [ eq : q_n ] ) and ( [ eq : solhj ] ) converges quadratically .",
    "a compact solution of equation ( [ eq : solhj ] ) is obtained by fourier analysis in the new angles @xmath39 using the standard type 2 canonical transformation ( equation [ eq : cw ] ) .",
    "we assume that the action - angle expansion of the generating function @xmath22 in the new action - angle variables exists : @xmath51 the fourier transform of equation ( [ eq : solhj ] ) may be written @xmath52}({\\mathbf{j}},{\\mathbf{w}}({\\mathbf{j}},{\\mathbf{s } } ) )    e^{-i{\\mathbf{l}}\\cdot{\\mathbf{s } } } \\label{eq : ql1 } \\nonumber \\\\    & = & \\frac{1}{(2\\pi)^3}\\oint d{\\mathbf{s}}\\bigg\\ {      \\frac{\\partial h_{new}^{[n]}}{\\partial{\\mathbf{j}}}\\cdot      \\bigg[\\bigg(\\mathbf{1}+\\frac{\\partial^2            w_1^{[n]}}{\\partial{\\mathbf{j}}\\partial{\\mathbf{w}}}\\bigg)^t\\bigg]^{-1 }      \\cdot\\frac{\\partial\\delta w_1^{[n]}}{\\partial{\\mathbf{w } } }    \\bigg .",
    "\\nonumber \\\\    & & - \\bigg(h_{new}^{[n+1]}({\\mathbf{j } } ) - h_{new}^{[n]}({\\mathbf{j}})\\bigg )      \\bigg\\ }    e^{-i{\\mathbf{l}}\\cdot{\\mathbf{s}}}.    \\label{eq : ql2}\\end{aligned}\\ ] ] the first term in the integrand of equation ( [ eq : ql2 ] ) may be simplified using the canonical transformation ( equation [ eq : cw ] ) : @xmath53^{-1 } \\cdot    \\frac{\\partial\\delta w_1}{\\partial{\\mathbf{w } } } & = &    \\bigg[\\mathbf{1 } + \\frac{\\partial^2        w_1}{\\partial{\\mathbf{w}}\\partial{\\mathbf{j}}}\\bigg]^{-1 } \\cdot    \\frac{\\partial\\delta w_1}{\\partial{\\mathbf{w } } } \\nonumber \\\\ & = &     \\bigg(\\frac{\\partial{\\mathbf{s}}}{\\partial{\\mathbf{w}}}\\bigg)^{-1}\\cdot    \\frac{\\partial\\delta w_1}{\\partial{\\mathbf{w } } } =     \\frac{\\partial\\delta w_1}{\\partial{\\mathbf{s}}}.\\end{aligned}\\ ] ] the second term in the integrand is independent of @xmath39 and therefore vanishes unless @xmath54 .",
    "finally , in terms of the fourier coefficients , the solution to equation ( [ eq : solhj ] ) is @xmath55 } - h_{new}^{[n+1]})\\delta_{{\\mathbf{l}}\\ , { \\bf 0 } } +    i{\\mathbf{l}}\\cdot\\frac{\\partial h_{new}^{[n]}}{\\partial{\\mathbf{j}}}\\delta\\varpi_{{\\mathbf{l } } } = 0\\ ] ] or , for @xmath56 , @xmath57}}{\\partial{\\mathbf{j } } } } q_{{\\mathbf{l}}}.    \\label{eq : ql3}\\ ] ] since an arbitrary additive constant in the generating function @xmath22 does not affect the solution for the action - angle variables , we are free to ignore the constant coefficients with @xmath54 . repeating the procedure , we may continue to iterate until @xmath29}$ ] is as small as desired .",
    "this iteration method is essentially that used in proving the kam theorem ( * ? ? ?",
    "* chapter 5 ,  2 ) . as in this theorem , the iterative corrections are second - order in the perturbation and are , therefore , quadratically convergent . from hamilton s equations , the quantity @xmath58}/\\partial{\\mathbf{j}}$ ] is a vector of frequencies and the small divisor @xmath59 will occur near a commensurability or resonance .",
    "even when the denominator is bounded away from zero , the effect of the denominator is far reaching ( see section [ sec : kamdiscuss ] below for discussion ) .",
    "this procedure has some favourable features .",
    "the iteration produces the series in the new actions and angles directly .",
    "also , assuming that the hamiltonian is available , the computation of the integrands in equation ( [ eq : ql1 ] ) do not require gradients in @xmath60 ; that is , the iteration can proceed without computing the frequencies @xmath61 .",
    "the updated coefficients are provided recursively by @xmath62}_{{\\mathbf{l}}}({\\mathbf{j } } ) \\leftarrow \\varpi_{{\\mathbf{l}}}^{[0]}({\\mathbf{j } } ) + \\sum_{k=1}^{n}\\delta\\varpi_{{\\mathbf{l}}}^{[k]}({\\mathbf{j}})$ ] and @xmath63}_{new } \\leftarrow h_0 + \\sum_{k=1}^{k } q_{{\\mathbf{l}}=\\mathbf{0}}^{[k]}$ ] where the initial value of @xmath64}$ ] is simply the first order perturbation ( see also equation [ eq : hj1st ] ) .",
    "there are , however , several practical problems with the formulation above .",
    "the main one is that evaluation of equation ( [ eq : ql1 ] ) requires @xmath65 which is implicit .",
    "this solution be computed straightforwardly using the newton - raphson method .",
    "an alternative approach uses an expansion in the new actions @xmath60 and old angles @xmath14 the mixed solution avoids an implicit solution of equation ( [ eq : cw ] ) to obtain the old angles in terms of the new .",
    "a rederivation of the iterative solution for the mixed fourier variables that yields a numerically expedient algorithm for the computation of the expansion coefficients using the standard fast fourier transform algorithm without implicit solutions is presented in appendix [ sec : numerical ] .",
    "each choice has advantages depending on the application .",
    "finally , the quadratic convergence of the iteration suggests a direct newton - raphson evaluation of equation ( [ eq : solhj ] ) . while possible , numerical stability seems to require a careful choice of a small but dominating subset of indices @xmath66 . since our goal is an automated analysis , we used equation ( [ eq : ql3 ] ) or equation ( [ eq : hjn2 ] ) for the examples in this and in companion papers .      mathematically speaking , a term in equation ( [ eq : w1aa ] ) based on the solution from equation ( [ eq : ql3 ] ) with a vanishing denominator will result in long - period motion with large amplitude for one degree of freedom .",
    "this signals the breakdown of the continuous , predictable behaviour of linear perturbation theory .",
    "the kam theory arose as a result of poincar s concern about the stability of the three - body problem ( i.e. the stability of the solar system ) resulting from this breakdown .",
    "the two systems have one huge qualitative difference : dynamical times in the solar system are measured in the billions while dynamical times in a galaxy are measured in the hundreds , maybe thousands at most .",
    "owing to our mathematical techniques , the numerical characterisation of the perturbation theory failure often requires extremely high - resolution data and time series very long compared to the natural frequencies of our dynamical system .",
    "this is partly the result of our celestial mechanics bias and computational limitations .",
    "galaxies have _ many _ orders of magnitude more stars and dark - matter particles than solar system bodies of interest .",
    "therefore , even though the available time scales are much shorter , the phase space coverage is so thorough that some an observable subset of particles will manifest chaotic dynamics in the time available .",
    "this regime begs for study and partially motivates this paper .",
    "much of kam theory is concerned with the phase - space domain that admits convergent solutions away from the vanishing denominators in equation ( [ eq : ql3 ] ) .",
    "the theory employs the exponential decay of fourier coefficients of analytic functions with increasing @xmath67 together with the general condition that rational numbers approximate the ratios of hamiltonian frequencies , @xmath68 , sufficiently badly that the series converges nearly everywhere for most problems of physical interest under weak perturbations .",
    "this condition is often written in the following form : @xmath69}}{\\partial{\\mathbf{j } } } \\ge    \\beta ( |{\\mathbf{l}}|)^{-\\gamma }    \\label{eq : diophantine}\\ ] ] for some @xmath70 and @xmath71 where @xmath72 is the rank of @xmath66 .",
    "armed with this formal result , we have confidence that our procedure will work much for much of phase space , although we will not explicitly verify the exponential decrease of coefficient amplitudes here .",
    "however , note that the time - scale mismatch remains ; the eternal nature of the torus may be too strong a criterion for our galactic systems .",
    "we may address this in an intuitive way by noting that the time - scale for a particular term with a vanishing denominator will be proportional to the maximum absolute value of the integers in @xmath66 ( denoted @xmath73 ) .",
    "therefore , a truncation at modest values of @xmath73 combined with the exponential decay of high - order coefficients suggests that the dynamics revealed by the algorithm from section [ sec : derive ] may retain its applicability .",
    "we will see examples of this truncation in section [ sec:3body ]    in the standard application of the kam theorem , one attempts to find a torus subject to the constraint of equation ( [ eq : diophantine ] ) .",
    "this may require some adjustments to the initial conditions in @xmath13 .",
    "our goal here is somewhat different : we are interested in the fraction of tori that break up under the perturbation as a function of phase space volume and therefore , we do not adjust @xmath13 .",
    "in other words , we are interested in the converse to the kam problem : where in phase space do tori _ not _ exist ?",
    "the natural implication of failing convergence of the series @xmath74 for some @xmath60 is a broken torus . in practice",
    ", failure has two forms : 1 ) the quantity @xmath75}}{\\partial{\\mathbf{j}}}=\\epsilon\\sim0 $ ] so that the amplitude @xmath76 is too large to continue with the iteration ; and 2 ) multiple terms of different @xmath66 influence each near one of the separatrices , inducing smale horseshoes ( and chaos thereby ) into the dynamics around the homoclinic trajectory ( as in * ? ? ?",
    "although the kam theorem does not offer specific wisdom on this , numerical experiments described below and in and show that failure to converge is most frequently an indicator of chaos .",
    "the kam procedure is perturbative .",
    "some applications , therefore , may benefit from breaking a large perturbation into small increments to better understand the development of irregularity .",
    "for example , we might choose to define a perturbation strength @xmath77 with @xmath78 $ ] .",
    "then , at increment @xmath79 , the perturbation strength is always of order @xmath80 with @xmath81 with @xmath82 clearly , this could be generalised to a non - linear dependence on @xmath1 . then , the algorithm from section ( [ sec : derive ] ) may be applied successively to each level @xmath79 .",
    "explicitly , let the solution at each step @xmath79 be denoted by @xmath83 , or using equation ( [ eq : f1 ] ) , @xmath84 .",
    "the iteration developed in the previous section results in the following chain of canonical transformations : @xmath85 & \\equiv & [ { \\mathbf{i}}(0 ) , { \\mathbf{w}}(0 ) ] \\xrightarrow{f_1({\\mathbf{j}},{\\mathbf{w}};1 ) } [ { \\mathbf{i}}(1 ) , { \\mathbf{w}}(1 ) ] \\xrightarrow{f_1({\\mathbf{j}},{\\mathbf{w}};2 ) } [ { \\mathbf{i}}(2 ) , { \\mathbf{w}}(2)]\\cdots \\nonumber \\\\ & & [ { \\mathbf{i}}(m-2 ) , { \\mathbf{w}}(m-2 ) ] \\xrightarrow{f_1({\\mathbf{j}},{\\mathbf{w}};m-1 ) } [ { \\mathbf{i}}(m-1 ) , { \\mathbf{w}}(m-1 ) ] \\xrightarrow{f_1({\\mathbf{j}},{\\mathbf{w}};m ) } \\nonumber \\\\ & & [ { \\mathbf{i}}(m ) , { \\mathbf{w}}(m ) ] \\equiv [ { \\mathbf{j } } , { \\mathbf{s } } ] .",
    "\\label{eq : chain}\\end{aligned}\\ ] ] at any step in the chain , the converged perturbed orbit has @xmath86 with uniformly advancing @xmath87 at the rate @xmath88 .    for a simple example , consider a chain with a single link , @xmath89 .",
    "we wish to plot the perturbed trajectory for the torus with @xmath60 as a function of time . by construction ,",
    "the angle variable advance uniformly at the rate @xmath90 , so beginning at @xmath91 , choose to advance to @xmath92 .",
    "using equations ( [ eq : ci ] ) and ( [ eq : w1aa ] ) , we compute @xmath13 at @xmath93 . using equations ( [ eq : cw ] ) and ( [ eq : w1aa ] ) , we compute for @xmath14 at @xmath93 .",
    "since the cartesian values of the phase - space point @xmath94 are known since the regular orbit is determined by quadrature , we have our phase space point for the torus @xmath60 at @xmath95 . for @xmath96 ,",
    "the same steps are used recursively from beginning at @xmath97 and moving down the chain by recursion .",
    "equation ( [ eq : cw ] ) tells us that the @xmath98 is implicitly defined by @xmath99 $ ] .",
    "solving for @xmath98 , equation ( [ eq : ci ] ) gives @xmath100 explicitly in terms of @xmath101 .",
    "we then walk down the chain transformations defined by equation ( [ eq : chain ] ) for each desired value of @xmath99 $ ] until we reach @xmath102\\equiv[{\\mathbf{i}}(0 ) , { \\mathbf{w}}(0)]$ ] .",
    "the last step provides us with the phase - space point in terms of the unperturbed tori .",
    "the penalty of using equations ( [ eq : incrp])([eq : chain ] ) for large @xmath103 is the large memory needed to store all of the coefficients and intermediate tables of actions and angles at each @xmath79 .",
    "see for additional discussion of this topic and its application .",
    "the computation of new perturbed action - angle values along with the computation of the new frequencies requires action - space partial derivatives of the expansion coefficients from equations ( [ eq : ql1 ] ) and ( [ eq : ql3 ] ) using equations ( [ eq : ci ] ) , ( [ eq : cw ] ) and ( [ eq : hnew ] ) .",
    "these numerical computations rely on either finite - difference or functional approximation techniques , and as usual , the best choice is problem dependent .",
    "we will use the notation defined in @xcite for action variables in a spherically - symmetric gravitational potential : @xmath104 and @xmath105 denote the radial and azimuthal action in the orbital plane , and @xmath106 denotes the projection of @xmath104 on the axis perpendicular to the equatorial plane ( i.e. the @xmath107 axis ) .",
    "depending on the perturbation , the perturbed actions @xmath108 will no longer have these clear interpretations . for a perturbation to a thin disk by a vertically symmetric disturbance , we can restrict our consideration to the action pair @xmath109 and consider only a two - dimensional distribution of action points .",
    "in general , an initially rectangular grid of nodes @xmath109 will not rectangular after the perturbation is applied .",
    "therefore , we can not rely on the standard algorithms that assume a rectilinear grid for @xmath110 for interpolation . for this paper , we explored two techniques to handle the expected irregular distribution of nodes @xmath110",
    ". first , the modified shepard algorithm @xcite uses a voronoi tessellation to provide a metric on the unstructured grid and inversely weights the contribution of nearby points by distance within a specified radius .",
    "alternatively , one may use a k - d tree to identify points within the specified radius using a nearest - neighbour search algorithm .",
    "the latter is slightly more efficient in greater than two dimensions .",
    "secondly , @xcite find an optimal set of coefficients in the least - squares sense to a multidimensional jacobi polynomial approximation in an irregular region .",
    "the shepard algorithm performed more robustly in tests and we use this approach for this and the companion papers .",
    "the third action , @xmath106 , is conserved for an axisymmetric but otherwise three - dimensional perturbation ( such the effect of a flattened perturbation on spherical bulge and halo ) .",
    "therefore , we may consider slices of constant @xmath106 individually and break the problem into two pieces .",
    "we first define planes of constant @xmath111 .",
    "the maximum value of @xmath106 may be defined by choosing an effective circular radius : @xmath112 and setting @xmath113 . since @xmath114 and @xmath115 where @xmath116 describes the inclination of the orbital plane relative to the @xmath117 plane ,",
    "once the value of @xmath106 is fixed , the values of @xmath118 determine @xmath116 .",
    "in other words , the orbits defined on the @xmath104@xmath105 plane at fixed @xmath106 have larger inclination off the disk plane as @xmath105 increases .",
    "this is a slightly odd way of representing phase space but is convenient for numerical derivatives .",
    "for example , @xmath119 may be computed by interpolating @xmath120 for the desired values of @xmath109 and using finite - difference derivative between @xmath106 planes to compute @xmath121 . because @xmath122 , the computation of derivatives at the lower boundary in @xmath105 may require special treatment such as extrapolation .",
    "we truncate the action - angle series by choosing a maximum index in each dimension , @xmath123 .",
    "these indices should be chosen sufficiently large to obtain an accurate representation of the orbit by the trigonometric polynomial .",
    "for eccentric orbits , whose expansions include terms with large @xmath73 owing to the high instantaneous frequencies at pericentre , the required value of @xmath123 may be much larger than the desired number of retained commensurabilities .",
    "however , overly large values of @xmath123 are computationally costly , both in cpu time and memory usage . for computations here , we find that @xmath124 is a good compromise .",
    "we use the efficient fftw package for the computing the discrete fourier transform using the fast - fourier transform algorithm .",
    "one of the pair of transform equations ( equations [ eq : ci ] and [ eq : cw ] ) is implicit , depending on whether we use the angle expansion in new variables ( as in equation [ eq : w1aa ] ) or in old angle variables ( as described in appendix [ sec : numerical ] , equation [ eq : wexp ] ) .",
    "as described at the close of section [ sec : derive ] , the mixed variable form that follows the type 2 generating function explicitly is computationally more efficient . in this case , transforming from the new action to the old action given the old angle is a simple application of equation ( [ eq : ci ] ) given @xmath125 from equation ( [ eq : hjn ] ) or equation ( [ eq : hjn2 ] ) : @xmath126 the angle transform is more complicated in two ways .",
    "first , equation ( [ eq : cw ] ) requires an action derivative of @xmath127 , which we perform using the modified shepard algorithm as described in section [ sec : interp ] .",
    "second , equation ( [ eq : cw ] ) is now an implicit expression for @xmath39 in terms of @xmath14 : @xmath128 .",
    "fortunately , this is efficiently solved using the newton - raphson method as follows .",
    "define : @xmath129 and @xmath130 then , the newton - raphson iteration for @xmath14 becomes @xmath131 this converges to machine precision in under ten iterations in practice .      the formalism of section [ sec : canonical ]",
    "may easily be extended to time - dependent perturbations .",
    "similar to the transformation of the hj equation to an algebraic equation using action - angle transforms , we may treat the time variable using a laplace transform .",
    "the special case of a simple harmonic time dependence , such as that resulting from a constant pattern speed with frequency @xmath132 , a fourier transform is sufficient .",
    "the resulting transform has a single term and the denominators in equation ( [ eq : ql3 ] ) become : @xmath69}}{\\partial{\\mathbf{j } } } \\longrightarrow    { \\mathbf{l}}\\cdot\\frac{\\partial h_{new}^{[n]}}{\\partial{\\mathbf{j } } }   - m\\omega_p.\\ ] ] we sum over all driving frequencies @xmath79 if there are a finite number of discrete constant drivers @xmath133 .",
    "if the time - dependence is aperiodic , the resulting transform results in a continuous frequency - like laplace transform variable @xmath134 : @xmath69}}{\\partial{\\mathbf{j } } } \\longrightarrow    { \\mathbf{l}}\\cdot\\frac{\\partial h_{new}^{[n]}}{\\partial{\\mathbf{j } } }   + i s.\\ ] ] the inverse laplace transform required for the fully general time - dependent hamiltonian requires an additional grid of quadratures but otherwise , the algorithm follows as in section [ sec : canonical ] . in the example below and in and",
    ", we will assume at most a single driving frequency .",
    "the ideas from the previous sections have been implemented in an object - oriented c++ code .",
    "readers with little interest or experience in object - oriented programming ( oop ) may skip this section without consequence . in short , an _ object _ or _ class _ is a data structure and a set of functions .",
    "oop imbues the relationship between be classes with the same relationships and interrelationships that their counterparts have in the physical or mathematical world .",
    "thus , oop provides a framework for the computational scientist to build and extend their numerical machinery ( see @xcite for an illustrative introduction ) .",
    "because oop enforces the natural relationships between objects , it also helps prevent mistakes . the specific oop design features for the code that implements the algorithm in section [ sec : derive ] are as follows :    1 .   the hamiltonian torus concept is embodied by a single class whose",
    "instances track the action vector , the coefficients of the @xmath22 expansion , and the derivatives of @xmath22 necessary to compute the angles at any desired time and at any level of the perturbation hierarchy .",
    "2 .   time - dependent perturbations will require multiple harmonic orders or frequency subspaces .",
    "these may be used to track periodic or aperiodic temporal perturbations using fourier or laplace , respectively .",
    "these subspace domains are fixed by the definition of the perturbation .",
    "the torus class instances keep lists of values indexed by each subspace .",
    "3 .   a container class keeps track of the full collection of action - vector _ nodes _ and associated tori for each perturbation .",
    "this container implements the interpolation and differentiation of the possibly irregularly sampled action points that enables the computation of the perturbed trajectories for each new torus .",
    "4 .   this container class may have any number of derived classes that may initialise the individual nodes with action values based on specific symmetries or special geometries in phase space . since the calculation begins with regular orbits , a particular derived class implements the computation of the analytic mapping between cartesian and angle - angle phase - space vectors for each geometry of interest .",
    "the astronomical applications here and in the companion papers assume axisymmetric or spherical unperturbed models .",
    "the container class of nodes has been designed to handle a three - dimensional unstructured grids , two - dimensional grids , and three - dimensional grids restricted to two - dimensional slices with fixed @xmath106 . during development , we tested the general three - dimensional grid using a computation that was restricted to two - dimensional slices . as expected , the implementation of a full three - dimensional grid is the most expensive and noisiest , requiring an order of magnitude more tori to achieve the same accuracy than the equivalent restriction to two - dimensional slices .",
    "the container class keeps track of and attempts to diagnose any problems in the interpolations as the computation proceeds .",
    "specifically , for strong perturbations , the induced oscillations for one @xmath135 term on another may drive excursions beyond the initial action grid . most often , these happen near phase - space boundaries for diverging iterations typical of broken tori . 7 .",
    "finally , these computations often represent an investment in both human and computing time .",
    "all intermediate results are stored to full precision for later reuse using the boost ( http://www.boost.org ) serialisation library .    for each newly - defined computation , we begin by choosing an appropriate value of @xmath123 for each dimension in the subspace .",
    "this finite set of `` quantum numbers '' results in a cubical lattice of @xmath136 . for two - dimensional problems ,",
    "the lattice is a square .",
    "we have explored the dependence of the coefficients on the selected value by increasing @xmath137 by factors of two until convergence reached . for problems explored to date",
    "@xmath138 has been sufficient .",
    "also , significantly larger values require special accommodations memory requirements .      the lyapunov exponents , @xmath139 for @xmath140 where @xmath25 is phase - space dimensionality , measure the exponential divergence rate of initially nearby phase - space points .",
    "the so - called _ standard algorithm",
    "_ @xcite exploits the multiplicative ergodic theorem @xcite .",
    "the import of this theorem may be motivated by the following example .",
    "consider the mapping defined by the continuous solution of the linearized equations of motion , @xmath141 where @xmath142 .",
    "this gives us a tangent - space mapping from @xmath143 to @xmath95 : @xmath144\\mathbf{u}(0)$ ] .",
    "if our tangent map @xmath145 were constant for all time , it would be a trivial matter to compute the eigenfunctions and eigenvalues once , and compute the subsequent evolution at any desired time .",
    "we can not do this because @xmath146 is time dependent , and therefore we would have a new eigenvalue problem at every time @xmath147 .",
    "oseledets theorem tells us that the generic case behaves as if @xmath146 were constant and that the lyapunov exponents are related to the eigenvalues of the the mapping matrix : @xmath148 for appropriately chosen eigenvectors @xmath149 .",
    "the major shortcomings of the algorithms based on this theorem are that the accuracy of the estimates depend sensitively on the numerical method . because of this",
    ", there is a very large literature describing improved lyapunov exponent algorithms .",
    "however , for our purposes here , accurate exponents are not required .",
    "we will use only the standard algorithm to discriminate between exponents that exceed some positive threshold value and those that do not .",
    "also , following common practice , we will use the continuous gram - schmidt normalisation procedure @xcite to estimate the various exponential subspaces to prevent the computational singularity that results from the direct application of the oseledets theorem .",
    "there are many newer approaches with virtues for different applications ( see * ? ? ?",
    "* for a review ) ; the choice of the standard algorithm for this application may not be optimal .",
    "our ode solver is the standard rk4 stepper .",
    "we experimented with a 6th order symplectic runge - kutta ( using the @xcite trick ) and the runge kutta felhberg algorithm ( e.g. * ? ? ?",
    "* ) , and the adaptive bulirsh - stoer ( b - s ) method with a specified relative error ( e.g. * ? ? ?",
    "the non - sympletic b - s scheme is much more efficient owing to the multiple length scales of the halo / spheroid and disk .",
    "relative energy changes of one part in @xmath150 and relative @xmath151 changes of one part in @xmath152 are obtained with time maximum time steps of 0.0001 .",
    "however , an externally chosen fixed time - step using the standard rk4 yield the most rapid convergence of the lyapunov exponents on average .    the rk4 time - step , @xmath153 , is chosen as follows .",
    "we begin with a time step selected using the typical n - body simulation algorithms : a fraction of the characteristic dynamical time determined by either the logarithmic derivative of the position or velocity .",
    "then , we solve the equations of motion numerically to find the smallest ratio of velocity to force .",
    "we use 1/100 of this value to integrate the equations of motion and its tangent space to determine lyapunov exponents .",
    "this fraction is both increased and decreased to check for convergence of the derived exponents .",
    "typically , this procedure results in a time step one order of magnitude smaller than that chosen by the traditional algorithm used for n - body simulations .",
    "in addition to the ode - solver time - step , one must choose the number of individual time - steps between gram - schmidt orthogonalisation of the principle directions .",
    "after some experimentation , we choose this number to be 1/3 of the mean orbital time .",
    "our implementation was tested successfully using the lorenz equations which has well - known lyapunov values @xcite .    convergence of the maximal lyapunov exponent , @xmath154 , for small value of @xmath155 can be logarithmically slow .",
    "that is , if the true value is @xmath156 , the most positive exponent approaches zero proportional to @xmath157 where @xmath158 is the number of steps @xmath153 . for the work here ,",
    "we are less interested in the value of @xmath154 but whether @xmath159 for some characteristic time @xmath160 .",
    "our algorithm is as follows :    1 .",
    "discard the first @xmath161 of the recorded lyapunov values .",
    "typically , we choose a series @xmath162 steps of size @xmath153 discard the first half of the series ; that is , we set @xmath163 .",
    "order the exponents @xmath164 . for @xmath165 , compute the linear regression of @xmath166 with @xmath167 to estimate the slope @xmath103 .",
    "perfect convergence to zero yields @xmath168 while perfect to a non - zero positive value yields @xmath169 . if the computed slope @xmath103 is greater that @xmath170 we assume that the most positive exponent is zero .",
    "the phase space vector is computed from the background potential for each torus in the grid ( as described in section [ sec : toricomp ] ) . in this paper",
    ", we are typically analysing of order @xmath171 different initial conditions for multiple numerical experiments , so examination of each by eye is not feasible .",
    "however , we have done this for some test cases and failure modes in this algorithm warrant some discussion because they appear to indicate interesting dynamical situations .",
    "first , we noticed that the run of individual @xmath172 with step @xmath79 do not maintain their initial ordering .",
    "for example , it is not unusual for the value of @xmath172 to converge a different rates .",
    "secondly , and more importantly , individual orbits that appear to be converging to positive value @xmath173 at small @xmath79 will begin to converge to zero logarithmically at large @xmath79 .",
    "occasionally , the opposite behaviour is seen : a value of @xmath174 at small @xmath79 may suddenly increase and converge to decreasing value of @xmath173 at large @xmath79 .",
    "after checking for and not finding any implementation errors , we concluded that this behaviour is consistent with the dynamics under study .",
    "in particular , an orbit in a chaotic region will exhibit exponential sensitivity .",
    "however , the apparent diffusion in action space may result in an orbit `` sticking '' in a region of apparent regularity for some time , resulting in a decreasing positive value of @xmath165 .",
    "this well - known behaviour is the result of an initially diffusing orbit encountering regular islands around separatricies and at the boundary of stochastic sheaths . leaving a detailed study for later , we note that this tendency towards stickiness in stochastic layers surrounding separatricies of strong resonances undermines the utility of using lyapunov exponents to characterise the dynamics in these stochastic layers .",
    "also note that these same orbits that exhibit non - uniform convergence often coincide with values of broken tori identified using the numerical kam method , suggesting that these are regions of weak chaos ( i.e. sub - exponential sensitivity ) that occur near strong resonances .",
    "phenomenologically , these weakly - chaotic trajectories appear regular throughout much of their orbital phase but may switch morphology suddenly near heteroclinic points .",
    "so , although they may appear to have lyapunov exponents close to zero , they give rise to orbits with varying behaviour .",
    "hamilton s equations for a fourier - series perturbation with a single dominant term ( i.e. a single @xmath135 in equation [ eq : w1aa ] or [ eq : wexp ] ) may be solved directly without difficulty .",
    "however , difficulties do arise when several terms contribute comparable power to equation ( [ eq : w1aa ] ) .",
    "for example , consider two such terms ( @xmath175 and @xmath176 ) with @xmath177 .",
    "as described in section [ sec : hj ] , each term alone is analogous to a single pendulum with a single degree of freedom . consider an initial condition near the unstable equilibrium of one of the pendula .",
    "the initial conditions must be finely tuned for the trajectory to ` climb ' to the unstable equilibrium .",
    "as the trajectory approaches this equilibrium , the force of the primary pendulum vanishes , and then , the other pendulum can influence the trajectory , causing apparent stochastic behaviour . depending on the state of the full system",
    ", this influence can cause the trajectory to enter the either the positive or negative rotation zones or the libration zone of the primary pendulum . in summary ,",
    "the two interacting pendula have resulted in the destruction the torus described by the action conjugate to the angular degree of freedom describing the unstable equilibrium . in some cases , for very strong perturbations , resonances from harmonics of the primary resonance can interact .",
    "this dynamics leads to the _ resonance overlap criterion _ @xcite .",
    "this will be familiar in solar - system context as orbit instability induced by the overlap of mean - motion resonances .",
    "the consequences of this broken torus depends on the problem at hand .",
    "if one of the pendula corresponds to a primary resonance , noise near the resonance can cause the ensemble of trajectories representing the entire torus ( e.g. initial conditions with the same initial actions but uniformly spaced phase values ) to change their actions depending on their phase .",
    "moreover , the problem can be complicated by many fourier terms simultaneously interacting and generating wide regions in phase space that exhibit exponentially sensitive stochastic behaviour .",
    "the erratic behaviour can be dramatically exacerbated if the unstable trajectories generated by several fourier terms coincide in phase space . in this case",
    ", trajectories may move from resonance to resonance . in some cases",
    ", the influence of individual components may be too plentiful to discriminate .",
    "as previously described ( see section [ sec : lyapcompute ] ) , the degree of stochasticity is most often characterised by the product of lyapunov exponent , @xmath154 and the characteristic dynamical time , @xmath178 .",
    "values of @xmath179 are called _ strong _ chaos and values of @xmath180 are called _ weak _ chaos ( e.g. * ? ? ?",
    "the method highlighted in section [ sec : kam ] is based on a perturbative solution including all the lower - order terms @xmath66 within some lattice with cardinality @xmath181 .",
    "we assume that failure to find a solution leading to a new torus implies a _ broken _ torus : the absence of an analytic predictive description of future time evolution of an ensemble of nearby phase - space points .",
    "moreover , although broken tori and lyapunov exponents are related , an exploration of phase space using each method reveals different information about the underlying dynamical structure .",
    "for example , loci of broken tori in a phase space perturbed away from regularity may result from a specific strong resonance .",
    "orbits of different morphology reside on either side of or in islands surrounding this resonance . with increasing perturbation strength , these loci",
    "broaden as additional terms conspire to break tori .",
    "however , although a broad region of broken tori implies regions of positive lyapunov exponents , this does not imply that @xmath182 , and conversely , large @xmath183 may occur in narrow regions around separatricies , as in the standard map . as we will see below and in and",
    ", regions of high @xmath183 often appear in regions of broken tori but not exclusively . in some cases , the largest values of @xmath183",
    "occur between the widening loci of primary resonances .",
    "the loci of original primary resonances sometimes remains a local minimum in @xmath183 , presumably owing to regular islands _ spawned _ by these resonances , as suggested by the morphology of poincar surface - of - section plots for the standard hamiltonian mapping problem .",
    "and @xmath184 showing action @xmath185 versus angle @xmath186 for @xmath187 for approximately @xmath171 recurrences .",
    "the action of the homoclinic trajectory is @xmath188 .",
    "trajectories with @xmath189 and @xmath190 are in libration and rotation , respectively .",
    "[ fig : upert],scaledwidth=80.0% ]    .",
    "although the amplitude of the second term is only 1% of the primary term , a region around the homoclinic trajectory is chaotic .",
    "also note the distorted resonant orbit for @xmath191 .",
    "[ fig : pert_0p01],scaledwidth=80.0% ]    .",
    "the amplitude of the second term is only 10% of the primary term ; most of the libration zone is filled with chaotic trajectories , although regular initial conditions can be found still .",
    "for example , trajectories with @xmath192 near the original homoclinic trajectory were chosen to display embedded islands .",
    "an example of a resonant island trajectory is @xmath193 .",
    "[ fig : pert_0p1],scaledwidth=80.0% ]    in this section , we investigate the evolution of a two - pendulum model with two non - zero terms in equation ( [ eq : w1aa ] ) to explicitly contrast the one - degree of freedom problem that underpins secular evolution with the multiple degree of freedom problem that admits chaos . for an explicit example , let us consider the hamiltonian @xmath194 where @xmath4 are the action - angle variables for the unperturbed hamiltonian @xmath8 with @xmath195 and @xmath196 .",
    "the restriction to a fourier single term in the expansion series results in classical secular perturbation theory . occasionally , the linear solution described above may diverge owing to the resonant denominators , but a non - linear solution can be found most often for a single term .",
    "however , when one or more _ additional _ fourier terms are added to the hamiltonian , irregularity arises .",
    "the importance of the irregularity to the solution in its astronomical context depends on the relative magnitude of the expansion coefficients and the order of commensurability .",
    "we will quantify the order of resonance as @xmath197 .",
    "it is well - known that chaos arises in a _",
    "stochastic layer _ near the homoclinic trajectory ( e.g. * ? ? ?",
    "so , we focus on the solution of the perturbed hamiltonian near the homoclinic trajectory for a single perturbation term , say @xmath198 .",
    "motivated by orbit averaging , we transform to _ slow _ and _ fast _ variables defined by the following type 2 canonical transformation : @xmath199 near the commensurability defined by @xmath200 , equation ( [ eq : cw ] ) implies that the new angle @xmath201 will change slowly and the new @xmath202 will change rapidly with time .",
    "the expressions for @xmath185 and @xmath203 follow similarly from equation ( [ eq : ci ] ) .",
    "the choice of the second term has a fair bit of flexibility in this application ; the most important constraint is that @xmath204 when @xmath205 .",
    "these conditions can be made rigorous @xcite but are not needed for this example .    to define an explicit form for the hamiltonian in equation ( [ eq : toyh ] )",
    ", we expand @xmath8 to second - order around a set of unperturbed initial actions @xmath206 . ignoring the cross term and completing the squares ,",
    "we obtain : @xmath207 where @xmath208 is an uninteresting constant and @xmath209 and @xmath116 represent @xmath210 and @xmath211 respectively , the definitions of @xmath212 include the offsets from initial conditions and completing the squares , and @xmath213 and @xmath214 are @xmath215 and @xmath216 , respectively .    for a simple example , we begin with initial conditions near the homoclinic trajectory defined by @xmath217 , @xmath218 , @xmath219 with @xmath220 and @xmath221 .",
    "this implies that @xmath222 and @xmath223 . the @xmath184 surface - of - section ( sos ) plot ( fig .",
    "[ fig : upert ] ) reveals that standard phase space of the regular , integrable pendulum . for @xmath224 ,",
    "the homoclinic trajectory broadens owing the action of the non - resonant term on on the resonant term near the unstable point .",
    "the sos plot for @xmath225 and @xmath226 are shown in figs .",
    "[ fig : pert_0p01 ] and [ fig : pert_0p1 ] , respectively .",
    "typical values of @xmath227 for astronomical perturbations described below and in the companion papers are between 0.1 and 0.5 so fig .",
    "[ fig : pert_0p1 ] is the more typical situation . for values",
    "@xmath228 , much of the libration is chaotic with a relatively wide chaotic zone around the original homoclinic trajectory .",
    "the dynamics of models like this are nicely described in chapters 2 and 3 of @xcite .",
    "the model of equation ( [ eq : toyh2 ] ) is today example only ; most realistic expansion series have approximately 5 terms with amplitude ratios with the primary between 0.1 and 1.0 .",
    "many may interact simultaneously leading to complex chaotic dynamics near the primary resonant orbit .",
    "this simple model helps motivate the prevalence of chaotic behaviour in the astronomical examples in the companion papers .",
    "additional investigation of the dynamics of this simple model reveals a wide variety of features found in the standard hamiltonian mapping , @xmath229 with @xmath230 . in particular ,",
    "one finds a stochastic ` sea ' with a wide variety of islands whose location change quickly with small changes in action within the stochastic layer .",
    "this leads to the behaviour of hamiltonian intermittency : the appearance of both stochastic and regular behaviour in the same trajectory .",
    "this results from trajectories being held up at the border of stable islands , sometimes called `` stickiness ''",
    "( i.e. * ? ? ?",
    "* ; * ? ? ?",
    "these dynamics may lead to heavy - tailed escape distributions similar to those caused by the first - order fermi effect @xcite .",
    "the relevance of possibly pervasive weak chaos in shaping the galactic velocity distributions and its relevance to so - called radial migration motivates additional investigation .",
    "the three - body problem is one of the oldest and best studied in dynamics , although surprises continue to emerge . here , we will consider application of the numerical kam method to the restricted three - body problem .",
    "the main goal for this example is the comparison our diagnosis of broken tori using the nkam method with the characterisation of chaos using lyapunov exponents for a familiar problem .",
    "we take units @xmath231 , consider the perturbation to be a circularly orbiting jupiter - like planet with @xmath232 and @xmath233 , and explore the motion of a coplanar test particle .",
    "we examined two types of perturbations . in the first",
    ", we assumed that the unperturbed potential is that of a central point mass fixed at the origin ( i.e. the sun ) and the perturbation is an orbiting point mass ( i.e. jupiter ) . in the second",
    ", we assumed the perturbation is the difference between the unperturbed potential and that generated by the full two - body solution including barycentric motion .",
    "the results were nearly the same for both perturbations for harmonic orders @xmath89 through @xmath234 , so we will use the fixed barycentre perturbation for the remainder of the calculations .     and azimuthal harmonic orders @xmath235 in the action plane .",
    "the legend indicates primary components @xmath236 in the form @xmath237 for @xmath238 , broken tori of higher order ( @xmath239 ) are indicated by black dots and unbroken tori are indicated by blue dots .",
    "[ fig : jup_tori],scaledwidth=80.0% ]    , scaledwidth=80.0% ]     with @xmath240 .",
    "[ fig : sos31],scaledwidth=80.0% ]      here , we describe the results of the torus construction outlined in section [ sec : kam ] .",
    "[ fig : jup_tori ] shows a plot of broken ( coloured circles and squares ) and unbroken ( blue dots ) tori as a function of radial and azimuthal actions , @xmath104 and @xmath105 , for the jupiter - like model .",
    "the original grid of radial and azimuthal actions is chosen by choosing a range of minimum and maximum energy defined by the circular orbits between @xmath241 and @xmath242 .",
    "let @xmath243 and @xmath244 be the energy and angular momentum of the circular orbit at @xmath245 . for each energy value in the range @xmath246 $ ] , we compute the minimum and maximum values of @xmath104 and @xmath105 such that @xmath247 .",
    "phase - space points outside the envelope of this region are shown as white .",
    "the legend has been restricted to low - order resonances for clarity .",
    "other broken tori , for higher - order tori , are shown as black points . to help interpret the results ,",
    "note that the two - body ( kepler ) problem in the adopted units has the following simple representation as a function of @xmath13 : the energy is @xmath248 the eccentricity is @xmath249 and the semi - major axis is : @xmath250 therefore , diagonal lines at constant @xmath251 are lines of constant energy and semi - major axis .",
    "loci of constant eccentricity are the lines @xmath252i_2 $ ] ; the diagonal @xmath253 has eccentricity @xmath254 . because the frequencies are independent of @xmath1 at fixed @xmath255 , these diagonals are also lines of constant orbital frequency and therefore loci of resonances as well .",
    "initial phase - space values were selected from a grid of @xmath104 and @xmath105 values chosen between upper and lower energy bounds .",
    "the finite steps in each action value yields non - rectangular boundaries in the @xmath104@xmath105 plane .",
    "the method described in section [ sec : canonical ] is most efficient when the fourier expansion series converges quickly , that is , when the value of @xmath137 is small .",
    "however , for this planetary perturbation , orbits with increasingly large @xmath1 can pass close to the perturbing planet for increasingly large values of @xmath104 ( or energy @xmath255 ) . convergence of the @xmath22 series would require increasing large values of @xmath137 .",
    "clearly for modest fixed values of @xmath137 , this method will only produce accurate tori estimates for @xmath256 .",
    "nonetheless , our example below will show that we can still obtain interesting insight into the dynamics with a small finite cube of @xmath66 pairs .",
    "a number of features are immediately evident .",
    "first , the broken tori cluster around loci corresponding to principle low - order resonances .",
    "we identify the coefficient @xmath236 with the largest magnitude as the principle resonance of each torus ; the low - order principle resonance `` quantum '' numbers @xmath237 are indicated in the legend .",
    "the dominating terms in the series should reflect the underlying drivers of the perturbation , however , the identification of principle resonances is solely based on amplitude in figs .",
    "[ fig : jup_tori ] and [ fig : jup_tori_big ] . in many cases ,",
    "the lowest - order term is only slightly smaller than the largest term with higher - order @xmath66 .",
    "therefore , the identifications in this figure may not precisely the morphological character of the broken torus but still provide some clues to the important features of the dynamics .",
    "two or more terms @xmath257 of comparable amplitude are most likely necessary for stochasticity .",
    "if desired , one may further study the details of specific broken tori using the direct integration approach described in section [ sec : toymodel ] .",
    "the tori with @xmath258 unbroken except at high eccentricity , @xmath259 . for reference",
    ", the locus @xmath260 have @xmath261 and @xmath262 has @xmath263 ( from equation [ eq : kepe ] ) .",
    "the swath of broken tori with @xmath264 , @xmath265 have been spot checked by direct integration and many of these do indeed exhibit unusual stochastic behaviour `` by eye '' in the form of eccentricity changes and sometimes irregular precession .",
    "the primary resonance identification suggests that resonance spreads out in to the cloud , presumably aided by other high - amplitude subdominant terms @xmath236 .",
    "the locus of broken tori in the upper right of the diagram are induced by the 3:1 and 4:3 resonances and other mean - motion harmonics with other high - order secondary resonances .",
    "the sos in planet s rotating from for the upper - left most torus in this locus is shown in fig .",
    "[ fig : sos31 ] .    for comparison , fig .",
    "[ fig : jup_tori_big ] shows a grid of tori at lower action - space resolution but larger maximum energy and radius .",
    "this figure shows that the damage to the tori by the jupiter - like planet is localised to the vicinity of the planet and eccentric planet crossing orbits , perhaps as expected .",
    "the upper locus is , again , the result of the 3:1 and 4:3 primary resonances .",
    "broken tori in this locus are affected by significant stochastic behaviour as evidenced by direct integration .    direct integration broken tori at small",
    "@xmath104 and @xmath266 show less dramatic stochastic behaviour .",
    "there are a large number of distinct groups of broken tori in fig .",
    "[ fig : jup_tori ] that might be of interest for various dynamical situations .",
    "most of these are likely to have been investigated previously by planetary dynamicists .",
    "our main goal , here , is to make contact with a well - established problem .",
    "key to this , is understanding whether the failure of the numerical kam procedure to produce a torus implies an irregular , stochastic orbit . to better assess stochasticity",
    ", we turn to lyapunov exponent computation using the methods described in section [ sec : lyapcompute ] .    for direct confirmation of broken tori ,",
    "the melnikov method has become the standard tool for detecting splitting of invariant manifolds for systems of ordinary differential equations close to integrable ones .",
    "the melnikov method for two degree of freedom hamiltonians described by @xcite .",
    "their method estimates the magnitude of the chaos by measuring the fraction of the energy surface where chaotic motion occurs .",
    "this idea will be explored in a future contribution .      .",
    "the data is somewhat under - smoothed to better reveal the fine - scale structure.[fig : lyap_o12],scaledwidth=80.0% ]     , scaledwidth=80.0% ]     and @xmath267 ( red ) .",
    "see fig . to locate this broken torus .",
    "the orbit of the jupiter - like planet is also shown ( green ) .",
    "the primary broken torus has commensurability @xmath268 , with secondary terms @xmath269 , and @xmath270 .",
    "[ fig : orbit_chaotic ] , scaledwidth=80.0% ]    we use initial conditions generated from the unperturbed tori in fig .",
    "[ fig : jup_tori ] to estimate positive lyapunov exponents using the method outlined in section [ sec : lyapcompute ] .",
    "to recall , the lyapunov exponents for each orbit are computed using the tangent - space method described by @xcite . to diagnose convergence , the time series of exponent estimates , computed from a running finite - time average ,",
    "are analysed using linear regression computation .",
    "if the largest exponent approaches zero with a slope @xmath271 , the exponent is assumed to be zero ; otherwise , it assumed to be positive .",
    "the relative density of positive lyapunov exponents indicating stochasticity are shown in fig .",
    "[ fig : lyap_o12 ] .",
    "a value of 1 ( 0 ) indicates that all ( no ) neighbouring orbits have positive lyapunov exponent .",
    "this figure is computed by smoothing the irregular distribution of initial @xmath109 values onto a regular grid with spacing 0.01 using a gaussian kernel with width 0.01 in action value .",
    "the initial smoothing value was estimated by a cross - validation analysis @xcite and manually adjusted downward by a factor of 5 to better reveal some of the intrinsic structure common to fig .",
    "[ fig : jup_tori ] .    the comparison of figs .",
    "[ fig : jup_tori ] and [ fig : lyap_o12 ] reveals both similarities and differences .",
    "overall , the regions of broken tori coincide with regions of positive lyapunov exponents .",
    "the 3:1 resonance locus at @xmath272 also appears as a region of strong stochasticity .",
    "not present in fig .",
    "[ fig : jup_tori ] are the horizontal loci of high - density positive lyapunov exponent with @xmath273 and @xmath274 .",
    "additional investigation revealed these are caused by high - order secondary resonances not included in the @xmath257 series .",
    "these are eccentric trajectories that come close to the planet at pericentre ; their inherent stochasticity would only be revealed by the nkam method for large @xmath73 .",
    "similar a horizontal locus with @xmath275 _ is _ present in fig . [",
    "fig : jup_tori ] .",
    "the direct integration of the equations of motion for a particular initial condition in the broad region of broken tori is shown in fig .",
    "[ fig : orbit_chaotic ] ; changes in the argument of periapsis and eccentricity results from close encounters with the perturbing planet , as expected .    figs .",
    "[ fig : jup_tori_big ] and [ fig : lyap_o13 ] compare the same model with lower action resolution but larger maximum energy , large radii orbits .",
    "this further illustrates the major features of the findings here .",
    "first , the low - order resonances give rise to stochasticity spreading from these resonances in the diagonal region described by @xmath276 .",
    "second , these stochastic zones spread for high eccentricity orbits ( @xmath277 ) forming a horizontal band of chaotic orbits with @xmath278 .",
    "this region has eccentricity @xmath279 .",
    "this band results from low - order terms interacting with high - order terms .",
    "[ fig : lyap_o13 ] reveals an additional band at larger @xmath105 , ` parented ' by higher orders resonances .",
    "the locus of broken tori parented by the 3:1 , 4:3 and other harmonics primary appears to demarcate the the upper horizontal tongue of high - eccentricity ( @xmath280 ) positive lyapunov exponents . as in the case of fig .",
    "[ fig : lyap_o12 ] , the lower horizontal loci have no detected counterpart in the numerical kam results , presumably owing to the truncation in @xmath73 as previously discussed .",
    "the region of positive lyapunov exponents is bounded from above by the locus of eccentric orbits with pericentre values of @xmath281 and bound from below by the locus with apocentre values of @xmath282 .",
    "overall , we find that the nkam method and the lyapunov exponent analysis provide a consistent picture of the broken tori in the restricted three - body problem for a jupiter - like planet .",
    "the nkam method provides useful dynamical details , such as which resonances are responsible for the stochastic behaviour around the separatrix .",
    "this is done by recording the dominant terms in the series defining the perturbation ( equation [ eq : w1aa ] ) .",
    "these terms may be later used later for detailed analyses , as desired .",
    "the lyapunov exponent analysis gives a broad - brushed view of stochasticity and is not restricted to low - order resonances .",
    "this paper describes a method for estimating the existence and destruction of regular orbits or _ tori _ under a perturbation .",
    "all orbits are assumed to be regular before applying a perturbation .",
    "this is most easily realised by choosing a standard model in stckel form @xcite ; spherical and two - dimensional axisymmetric potentials are trivial examples .",
    "classical hamiltonian perturbation theory isolates the response of individual resonances by identifying the particular slowing varying degree of freedom identified with the commensurable frequencies at resonance and averages over the rest .",
    "however , this procedure fails to include important dynamics near the resonance ( i.e. close to the separatrix of the principle resonance ) owing to non - negligible perturbations by the averaged terms that have been cast away by the averaging .",
    "the new method proposed here uses the hamilton - jacobi equation to extend the reach of canonical perturbation theory by including the mutual interactions of excited resonances .",
    "it is now well known that these terms lead to dynamical instability through classical indeterminism or chaos ( e.g. * ? ? ?",
    "* ) . by retaining many terms in the original series rather than dispatching them using the averaging theorem",
    ", we develop a perturbation theory that includes chaos .",
    "the new method is motivated by mathematical machinery used in some proofs of kam theory ( e.g. * ? ? ?",
    "* ) and their correspondence to techniques used by this author previously .",
    "specifically , both the kam procedure and the standard secular perturbation theory attempts to solve the perturbed hamiltonian equation using a fourier analysis .",
    "the kam procedure defines an iterative procedure to obtain a new set of action - angle variables as the solution to a perturbed hamilton - jacobi equation .",
    "the standard secular perturbation theory uses the averaging theorem to derive one - dimensional equations of motion for each resonance of interest .",
    "the essence of the method described in section [ sec : kam ] is a quadratically converging iteration for the coefficients of a series approximation to a canonical generating function that defines a new set of action - angle variables under the perturbation for all terms simultaneously .",
    "that is , the converged coefficients give us a canonical generating function that solves the perturbed hamilton - jacobi equation and provides new action - angle variables ( i.e. new _ tori _ ) .",
    "moreover , the kam theorem suggests that it is sufficient to retain some finite subset of coefficients for some modest perturbation strength .",
    "this justifies in part the truncation of the expansion series that is necessary for practical numerical computation .    when the coefficients for a particular value of the action vector , @xmath13 , fail to converge",
    ", the cause is rapid oscillation near the unstable equilibrium of the primary resonance induced by one or more secondary resonances .",
    "this is an example of the so - called homoclinic tangle discovered by poincar .",
    "specifically , the perturbation splits the stable and unstable parts of the infinite - period resonant trajectory ; the frequency of their mutual intersections intersect increase rapidly near the original unstable points of equilibrium .",
    "@xcite describes the dynamics of these tangles and their consequences in exquisite detail . from a heuristic perspective",
    ", the kam theorem tells us that the onset of chaos is a result of coarse graining the dynamics generated by the homoclinic tangles .",
    "the consequences of these tangles is shown in the stochastic layer that appears around the unperturbed homoclinic trajectory ( fig .",
    "[ fig : upert ] ) as the amplitude of the perturbation is increased ( figs .",
    "[ fig : pert_0p01 ] and [ fig : pert_0p1 ] ) in our toy model from section [ sec : toymodel ] .",
    "this observation also suggests that the failure of the iteration in section [ sec : kam ] is likely to imply chaos .",
    "the identification of particular broken tori provides a starting point for investigating the character and strength of the resulting stochasticity .",
    "the example in section [ sec:3body ] shows that the numerical kam procedure reproduces many of the same features as the more traditional empirical determination using lyapunov exponents .",
    "however , characterising phase space using lyapunov exponents is both time consuming and numerically challenging .",
    "they are also difficult to connect to the underlying dynamics for several reasons .",
    "first , the computation of the lyapunov exponents requires a numerical solution of the equations of motion . if the orbit is chaotic , the initial conserved quantities drift .",
    "secondly , once the orbit enters the vicinity of the homoclinic trajectory that has been broadened by nearby resonances , the initially exponentially diverging orbits may appear to converge again .",
    "in short , orbits with initially positive lyapunov exponents fall prey to the orbit s proclivity to explore phase space and locate and get stuck near regular islands .",
    "so lyapunov exponents are not ideal for classifying regularity in some arbitrary potential owing to the appearance of islands of regularity in the stochastic layers around primary resonances .",
    "the same problem affects poincar surface - of - section ( sos ) plots ; for a single orbit , the sos plot graphically represents the tendency for weakly chaotic orbits to both diffuse to and from regular regions .",
    "the numerical kam approach does not suffer from diffusion and is computationally much faster that the standard lyapunov exponent algorithms for studying the phase space with the same number of initial conditions .",
    "however , the numerical kam method requires a rapidly converging fourier series for accuracy , and this may not be satisfied for some problems of astronomical interest . for example , the example in section [ sec:3body ] illustrates that stochasticity for very eccentric trajectories in a solar system requires expansion to very high order . on the other hand ,",
    "the applications described in @xcite and @xcite  a bar perturbation to a disc and disc perturbation to a dark - matter halo , respectively  will be well described by a small number of terms .",
    "in addition to analytic estimates of secular evolution and dynamical stability , action variables are widely employed to represent phase - space distributions by making use of jeans theorem @xcite .",
    "given a time - independent action - space distribution , the positions and velocities of all orbits are known for all time .",
    "for many applications , the action - angle method will remain a useful and mostly accurate construct .",
    "the results of this paper , combined with the galaxy applications described in and , suggest that systems with strong deviations from the classical regular systems ( spherical or triaxial stckel potentials , two - dimensional axisymmetric disks , etc . )",
    "may give rise to dynamics strongly affected by , if not dominated by , irregularity .",
    "for example , one would not use jeans equations to describe the dynamics in the vicinity of jupiter ; and describe analogous situations for galactic dynamics .    a secondary goal of this paper is an extension of the well - established tools of secular perturbation theory to the study of stochastic dynamics in the context of galaxy evolution .",
    "an important motivating application not addressed here or in the companion papers is the extension of this technique to the prediction of long - term evolution .",
    "the might be done , for example , by using the numerical kam procedure to identify broken tori and then computing diffusion coefficients in the initial action space following the numerical approach of @xcite or something similar .",
    "phase - space evolution might then be followed by a combination of the numerical kam analyses and a fokker - planck type evolution . while feasible",
    ", this would be a computationally expensive project .",
    "some will no doubt argue that the applicability of the work described here should be established in n - body simulations before proceeding further .",
    "this gives rise to the question of whether direct n - body simulation suffices to obtain the dynamics described in this paper .",
    "this is a separate project in itself but in aid of this goal , i offer the following issues for consideration .",
    "first , it is well established that stochastic layers exist around primary resonances in hamiltonian systems with multiple degrees of freedom .",
    "the width of these layers depend on the strength and structure of the perturbation .",
    "these layers are expected to have lower dimensionality that the phase space itself .",
    "therefore , it is possible that small time - steps , much smaller than typically used in n - body simulations , might be necessary for individual particle orbits to resolve ( or `` feel '' ) the chaos . in other words",
    ", large time - steps may be giving the appearance of more regularity than in nature .",
    "anecdotal evidence for this issue is found in the computation of lyapunov exponents .",
    "large time - steps , say 20100 divisions per characteristic orbital time , are too large to capture the effect of exponential growth owing to resonance overlap ; time - steps 10100 times smaller were required for convergence of the exponents .    secondly , adaptive poisson solvers generate force fluctuations .",
    "their scale depends on the method . for direct - summation codes and tree codes",
    ", the spatial scale will be the smoothing length . for pic - type solvers",
    ", the scale will be the cell size .",
    "for orthogonal - basis codes , the scale is set by the maximum order of the basis functions .",
    "the concern is that scattering from these fluctuations may interfere with , change or otherwise wash out the underlying hamiltonian chaos .",
    "some will argue that galaxies are naturally noisy , and therefore , if the numerical noise in the force computation washes out the hamiltonian chaos , then it is probably not important .",
    "this argument is circular .",
    "the existence of astronomical noise does not make n - body particle noise a good stand in . even in the unlikely case that particle noise emulated the true fluctuations for some application , the simulator would need to compute the auto - correlation time for the noise fluctuations to set the correct dynamical time - step .",
    "the natural noise in dark - matter halos will be a mixture of particle - like and non - particle like .",
    "particle - like noise will come from dark substructure and dwarf satellites , molecular clouds and star clusters , to name a few .",
    "however , it is likely that these are fewer in number than simulation particles and with different distributions than the dark matter or disk particles , and therefore the resulting noise spectrum will be different .",
    "non - particle like noise will be generated by the wrapping dark - matter streams , continuing gas accretion and other long - term evolutionary processes that result from galaxy assembly . in short ,",
    "all of these processes require precise study before their contribution to the dynamics is well - understood .",
    "chaotic dynamics may give rise to anomalous acceleration or scattering caused by overlapping patterns .",
    "in the example from section [ sec : toymodel ] , the stochastic layer that forms around the separatrix has multiple embedded islands .",
    "trajectories move through the stochastic layer feeling the intermittent effects regular and irregular motion .",
    "for example , in computing the lyapunov exponents for section [ sec:3body ] we noticed the tendency for trajectories with positive exponents at early times begin to converge toward zero .",
    "this is consistent with the behaviour of hamiltonian intermittency .",
    "this well - established behaviour is called _",
    "stickiness_. when chaotic trajectories approach the regular regions they stick to their border inducing long periods of almost regular motion .",
    "this intermittent behaviour determines the magnitude of diffusion . for stronger perturbations",
    ", chaotic trajectories may appear to suffer from noticeable anomalous kicks and apparently sudden changes in their direction or orientation ; such effects are related to `` radial migration '' .    in cases where the lyapunov exponents are positive but very small , the trajectories slowly diffuse into the thin chaotic layer defined by the dominant and secondary term(s ) in the action - angle expansion of the perturbation .",
    "additional terms may yield a complicated network of higher - order resonances , often sticking for very long times to the boundaries of islands constituting the so - called _ edge of chaos _",
    "regime @xcite .",
    "this seems less likely to be important to time - limited systems such as galaxies . a recent paper by @xcite notes that the measured fraction of regular orbits in a barred galaxy simulation appears to increase with time .",
    "perhaps this is a consequence of intermittency .",
    "this early development of this work was supported in part by nsf awards ast-0907951 and ast-1009652 .",
    "mdw gratefully acknowledges support from the institute for advanced study , where work on this project began .",
    "many thanks douglas heggie who made valuable comments on an early version of this manuscript .",
    "60 natexlab#1#1    arnold v.  i. , 1963 , russian mathematical surveys , 18 , 13    arnold v.  i. , 1989 , mathematical methods of classical mechanics , 2nd edn .",
    "springer - verlag , new york    arnold v.  i. , kozlov v.  v. , neishtadt a.  i. , 1997 , mathematical aspects of classical and celestial mechanics , 2nd edn .",
    "springer    barrow - green j. , 1997 , poincar and the three body problem , history of mathematics no .",
    "american mathematical society    j. , kumar s. , 1993 , , 261 , 584    binney j. , tremaine s. , 2008 , galactic dynamics : ( second edition ) ( princeton series in astrophysics ) .",
    "princeton university press    brouwer d. , clemence g.  m. , 1961 , methods of celestial mechanics . academic press    buhmann m.  d. , 2003 ,",
    "radial basis functions : theory and implementations .",
    "cambridge university press , isbn 978 - 0 - 521 - 63338 - 3    cash j.  r. , 1985 , comp . &",
    "with appls . , 11 , 395    chirikov b.  v. , 1979 , physics reports , 52 , 265    christiansen f. , rugh h.  h. , 1997 , nonlinearity , 10 , 1063    g. , harsoula m. , 2013 , , 436 , 1201    l.  a. , maffione n.  p. , cincotta p.  m. , giordano c.  m. , 2012 , arxiv e - prints    de  la  llave r. , 2003 , a tutorial on kam theory , universi series .",
    "american mathematical society    eisenhart l.  p. , 1934",
    "math . , 35 , 284    a. , peters t. , 2014 , , 443 , 2579    goldstein h. , poole c.  p. , safko j. , 2002 , classical mechanics , 3rd edn .",
    "addison - wesley    holmes p. , marsden j.  e. , 1982 , comm .",
    "82 523 ( 1982 ) , 82 , 523    m. , binney j. , 1994 , , 268 , 1033    kolmogorov a. , 1954 , the proceedings of the ussr academy of sciences , 98 , 527530    lai y .- c . , 1999 , physical review e , 60 , r6283    lee k. , 1988 , phys . rev .",
    "lett . , 60 , 1991    lochak p. , meunier c. , 1988 , applied mathematical sciences , vol .",
    "72 , multiphase averaging for classical systems .",
    "springer    t. , bountis t. , skokos c. , 2013 , journal of physics a mathematical general , 46 , 254017    t. , machado r.  e.  g. , 2014 , , 438 , 2201    t. , machado r.  e.  g. , 2014 , , 438 , 2201    c. , binney j. , 1990 , , 244 , 634    moser j. , 1962 , nachrichten der akademie der wissenschaften in gttingen , mathematisch - physikalische klasse , 1    moser j. , 1966 , annali della scuola normale superiore di pisa , ser .",
    "iii , 20 , 499    oseledets v.  i. , 1968 , trans .",
    "moscow math .",
    ", 197    p.  a. , 2012 , international journal of bifurcation and chaos , 22 , 30029    pitt - francis j. , whiteley j. , 2012 , guide to scientific computing in c++ , undergraduate topics in computer science .",
    "springer    pschel j. , 2001 , proc .",
    "pure math .",
    ", 69 , 707    press w.  h. , teukolsky s.  a. , vetterling w.  t. , flannery b.  p. , 1992",
    ", numerical recipes in c , 2nd edn . cambridge university press , cambridge    reichl l. , 2004 , the transition to chaos , 2nd edn .",
    ", institute for nonlinear science .",
    "springer    renka r.  j. , 1988 , acm trans . math .",
    "software , 14 , 149 , algorithm 660    renka r.  j. , 1988 , acm trans .",
    "software , 14 , 151 , algorithm 661    riachy s. , mboup m. , richard j .-",
    ", 2011 , j. comput .",
    ", 236 , 1069    j.  l. , binney j. , 2014 , , 441 , 3284    shepard d. , 1968 , in proc .",
    "517523    silverman b.  w. , 1986 , density estimation for statistics and data analysis .",
    "chapman and hall , london    springel v. , 2005 , mnras , 364 , 11051134    stckel p. , 1892",
    ", phd thesis , halle    tremaine s. , weinberg m.  d. , 1984 , , 209 , 729    tsallis c. , 2009 , introduction to nonextensive statistical mechanics : approaching a complex world .",
    "springer , new york    vesperini e. , weinberg m.  d. , 2001 , in asp conf .",
    "ser . 230 : galaxy disks and disk galaxies , pp",
    ". 457458    vinti j.  p. , der g.  j. , bonavito n.  l. , 1998 , orbital and celestial mechanics .",
    "american institute of aeronautics and astronautics , pp .",
    "329352    weinberg m.  d. , 1994 , , 108 , 1398    weinberg m.  d. , 1998 , in asp conf .",
    "ser . 136 : galactic halos , p. 357",
    "weinberg m.  d. , 2001 , in the restless universe , pp .",
    "167190    weinberg m.  d. , 2015 , , paper 2 , submitted    weinberg m.  d. , 2015 , , paper 3 , submitted    weinberg m.  d. , katz n. , 2002 , , 580 , 627    wiggins s. , 1992 , chaotic transport in dynamical systems .",
    "springer    wiggins s. , 2003 , introduction to applied nonlinear dynamical systems and chaos , 2nd edn .",
    "springer    wolf a. , swift j.  b. , swinney h.  l. , vastano j.  a. , 1985 , physica , 285    wolf a. , swift j.  b. , swinney h.  l. , vastano j.  a. , 1985 , physica , 16d , 285    yoshida h. , 1990 , phys .",
    "a , 150 , 262    zaslavskii g.  m. , sagdeev r.  z. , usikov d.  a. , chrnikov a.  a. , 1991 , weak chaos and quasi - regular patterns .",
    "cambridge university press    zaslavsky g.  m. , 2007 , the physics of chaos in hamiltonian systems .",
    "imperial college press",
    "the development of the nkam algorithm in section [ sec : kam ] uses a fourier series in the new action - angle variables of the perturbed hamiltonian @xmath15 .",
    "while elegant , this set of variables complicated the solution for the new variables in terms of the old variables @xmath4 . rather than solve equation ( [ eq : hjq ] ) by a fourier series in @xmath39 as described by equation ( [ eq : ql1 ] ) , we may write the expansion in terms of the old angles @xmath14 : @xmath283 where @xmath284 is the new action vector , @xmath285 is the old angle vector , and @xmath286 is a vector of integers whose values are @xmath287 for some @xmath288 as before .",
    "this mixed set of variables is more natural for the type 2 generating function @xcite but our main motivation here is computational efficiency .",
    "this mixed expansion series results in iterative algorithm that does not require implicit solution of angle variables .",
    "the revised derivations otherwise follows the same steps that lead to equation ( [ eq : qquad ] ) .    to see this new formulation facilitates the implicit solution of the new canonical variables as a function of the old , write the expansion of the right - hand side of equation ( [ eq : hj ] ) to first order in the perturbation @xmath289",
    "$ ] explicitly : @xmath290}}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg )    =     \\bigg\\{h_0({\\mathbf{j } } ) +      { \\mathbf{\\omega}}({\\mathbf{j}})\\cdot\\frac{\\partial w_1}{\\partial{\\mathbf{w } } } +      h_1({\\mathbf{j } } , { \\mathbf{w}})\\bigg\\ } + \\mathcal{o}(w_1 ^ 2 )    \\label{eq : rhs}\\ ] ] where we have used the notation @xmath291 for compactness .",
    "if we subtract the terms in @xmath292 from both sides of equation ( [ eq : rhs ] ) , after rearranging and grouping the new terms , we have : @xmath293    \\nonumber + \\\\ & &     \\bigg[h_1\\bigg({\\mathbf{j}}+ \\frac{\\partial w_1}{\\partial{\\mathbf{w } } } , { \\mathbf{w}}\\bigg ) -       h_1({\\mathbf{j } } , { \\mathbf{w}})\\bigg ] .",
    "\\label{eq : hj2}\\end{aligned}\\ ] ] the left - hand side is the difference between @xmath294 and the first - order taylor series .",
    "terms on the right - hand side of equation ( [ eq : hj2 ] ) are second order in the perturbation @xmath295 . as in the section [ sec :",
    "derive ] , we can exploit this to determine the first - order contribution once and for all , and iterate to improve the second - order contribution .",
    "we proceed as follows .",
    "consider the action - angle expansion of equation ( [ eq : hj2 ] ) in the fourier series defined by equation ( [ eq : wexp ] ) .",
    "the first two terms on the left - hand side are constants with respect to @xmath14 and therefore only contribute to coefficients @xmath125 with @xmath54 . from equation ( [ eq : ci ] )",
    ", these terms make no contribution to the new action , and from equation ( [ eq : cw ] ) , these terms only result in a constant offset in new angle . as in section",
    "[ sec : kam ] , we see from equations ( [ eq : ci ] ) and ( [ eq : cw ] ) that the @xmath54 transform of equation ( [ eq : hj2 ] ) generates an uninteresting phase shift in the solution .",
    "the fourier coefficient of the third term on the left - hand side of equation ( [ eq : hj2 ] ) is @xmath296 while that for the fourth term is determined once and for all by direct quadrature .",
    "since the right - hand side is second order in @xmath22 , we can immediately solve for the first - order contribution to @xmath125 by demanding that the first - order contribution to the lhs of equation ( [ eq : hj2 ] ) vanishes : @xmath297}({\\mathbf{j } } )    = \\frac{i}{{\\mathbf{l}}\\cdot{\\mathbf{\\omega}}({\\mathbf{j}})}\\frac{1}{(2\\pi)^3 }    \\oint d{\\mathbf{w}}h_1({\\mathbf{i } } , { \\mathbf{w } } ) e^{-i{\\mathbf{l}}\\cdot{\\mathbf{w } } }    \\label{eq : hj1st}\\ ] ] where @xmath298 and @xmath299 to first order .",
    "again , we can safely ignore the @xmath54 which yields an constant offset in @xmath39 by equation ( [ eq : cw ] ) .",
    "we may now substitute this first - order solution @xmath300}({\\mathbf{j}},{\\mathbf{w } } ) = \\sum_{{\\mathbf{l } } }    \\varpi_{{\\mathbf{l}}}({\\mathbf{j}})^{[1 ] } e^{i{\\mathbf{l}}\\cdot{\\mathbf{w}}}\\ ] ] into equation ( [ eq : hj2 ] ) to get : @xmath301}({\\mathbf{j } } ) & = & \\varpi_{{\\mathbf{l}}}^{[1]}({\\mathbf{j } } )     + \\frac{i}{{\\mathbf{l}}\\cdot{\\mathbf{\\omega}}({\\mathbf{j}})}\\frac{1}{(2\\pi)^3 }    \\bigg\\ {      \\oint d{\\mathbf{w}}\\ , \\bigg[h_0\\bigg({\\mathbf{j}}+ \\frac{\\partial            w_1^{[1]}}{\\partial{\\mathbf{w}}}\\bigg ) - h_0({\\mathbf{j } } ) -        { \\mathbf{\\omega}}\\cdot\\frac{\\partial w_1^{[1]}}{\\partial{\\mathbf{w}}}\\bigg ]      e^{-i{\\mathbf{l}}\\cdot{\\mathbf{w } } } + \\bigg .",
    "\\nonumber \\\\    & & \\hspace{98pt}\\bigg .",
    "\\oint d{\\mathbf{w}}\\ ,      \\bigg[h_1\\bigg({\\mathbf{j}}+ \\frac{\\partial w_1^{[1]}}{\\partial{\\mathbf{w } } } ,          { \\mathbf{w}}\\bigg ) - h_1({\\mathbf{j } } , { \\mathbf{w}})\\bigg]e^{-i{\\mathbf{l}}\\cdot{\\mathbf{w } } }    \\bigg\\ } \\label{eq : hj3}\\end{aligned}\\ ] ] equation ( [ eq : hj3 ] ) may be similarly iterated to obtain @xmath302}({\\mathbf{j } } ) & = & \\varpi_{{\\mathbf{l}}}^{[1]}({\\mathbf{j } } ) + \\nonumber \\\\    & & \\frac{i}{{\\mathbf{l}}\\cdot{\\mathbf{\\omega}}({\\mathbf{j}})}\\frac{1}{(2\\pi)^3 }    \\bigg\\ {      \\oint d{\\mathbf{w}}\\ , \\bigg[h_0\\bigg({\\mathbf{j}}+ \\frac{\\partial            w_1^{[n-1]}}{\\partial{\\mathbf{w}}}\\bigg ) - h_0({\\mathbf{j } } ) -        { \\mathbf{\\omega}}\\cdot\\frac{\\partial w_1^{[n-1]}}{\\partial{\\mathbf{w}}}\\bigg ]      e^{-i{\\mathbf{l}}\\cdot{\\mathbf{w } } } + \\bigg .",
    "\\nonumber \\\\    & & \\hspace{98pt}\\bigg .",
    "\\oint d{\\mathbf{w}}\\ ,      \\bigg[h_1\\bigg({\\mathbf{j}}+ \\frac{\\partial w_1^{[n-1]}}{\\partial{\\mathbf{w } } } ,          { \\mathbf{w}}\\bigg ) - h_1({\\mathbf{j } } , { \\mathbf{w}})\\bigg]e^{-i{\\mathbf{l}}\\cdot{\\mathbf{w } } }    \\bigg\\ } \\label{eq : hjn}\\end{aligned}\\ ] ] or using @xmath303 , @xmath304}({\\mathbf{j } } ) & = & \\varpi_{{\\mathbf{l}}}^{[1]}({\\mathbf{j } } ) + \\nonumber \\\\   & & \\frac{i}{{\\mathbf{l}}\\cdot{\\mathbf{\\omega}}({\\mathbf{j}})}\\frac{1}{(2\\pi)^3 }    \\bigg\\ {      \\oint d{\\mathbf{w}}\\ , \\bigg[h\\bigg({\\mathbf{j}}+ \\frac{\\partial            w_1^{[n-1]}}{\\partial{\\mathbf{w}}}\\bigg ) - h({\\mathbf{j}},{\\mathbf{w } } ) -        { \\mathbf{\\omega}}\\cdot\\frac{\\partial w_1^{[n-1]}}{\\partial{\\mathbf{w}}}\\bigg ]      e^{-i{\\mathbf{l}}\\cdot{\\mathbf{w } } } \\bigg\\ } \\nonumber \\\\ \\label{eq : hjn2}\\end{aligned}\\ ] ] the iteration may be terminated when the value of @xmath305 } - \\varpi_{{\\mathbf{l}}}^{[n-1]}|$ ] is sufficiently small .",
    "equations ( [ eq : hj1st ] ) , ( [ eq : hj3 ] ) , ( [ eq : hjn ] ) , and ( [ eq : hjn2 ] ) require angle integrals over a range of @xmath66 .",
    "the restricted three - body problem example in section [ sec:3body ] and the galactic - bar perturbation in considers a two - dimensional orbital distribution with a non - axisymmetric perturbation . for the application in",
    ", we will consider azimuthally symmetric perturbations only ; @xmath151 will remain constant for all orbits and only terms @xmath125 with @xmath306 will be non - zero . therefore , our angle integrals in the equations above are two dimensional for this case as well . by restricting our series to @xmath307 $ ] and",
    "@xmath308 $ ] , the angle integrals in equations ( [ eq : hj1st ] ) , ( [ eq : hj3 ] ) and ( [ eq : hjn ] ) have the same form as a discrete fourier transform and may be efficiently performed using the fft algorithm .",
    "the two - dimensional restriction is for numerical convenience only ; see for a discussion of the full three - dimensional perturbation .",
    "as described in section [ sec : interp ] , we divided our action grids into three classes : 1 ) two - dimensional problems with action space @xmath309 ) ; 2 ) three - dimensional problems with action space @xmath310 with one action conserved , @xmath111 say ; and 3 ) the fully general three - dimensional problem .",
    "our software implementation includes all three classes but only ( 1 ) and ( 2 ) are used in this and the companion papers . in general , the distribution of @xmath13 will not be on a regular grid , and therefore interpolation and evaluation of partial derivatives require specialised methods .",
    "we have explored spline fits , interpolating simplices @xcite and the shepard method @xcite .",
    "numerical experiments suggests that the shepard method is the most robust and generally accurate on test problems .",
    "the authors of alglib ( www.alglib.net ) suggest that the radial basis function ( rbf ) methods ( e.g. * ? ? ?",
    "* ) further improve the performance of shepard s algorithm , but this has not been investigated here .",
    "our implementation of shepard s algorithm begins with an irregular point set denoted as @xmath311 for @xmath312 .",
    "let the desired field @xmath313 evaluated on this set be denoted as @xmath314 .",
    "the original shepard approximating function @xcite is defined as @xmath315 where the weight functions @xmath316 are @xmath317^r}{\\sum_{j=1}^n h[\\delta - d_j({\\mathbf{i}})]^r }    \\label{eq : shep2}\\ ] ] with @xmath318 , @xmath319 , the standard euclidean norm , and @xmath320 $ ] defined by @xmath321 =     \\begin{cases }      $ q$ , & q\\ge0\\\\      $ 0 $ , & q<0\\\\    \\end{cases}\\ ] ] the smoothing parameter @xmath214 and the exponent @xmath322 are tuning constants .",
    "generally , if exponent @xmath322 has a value in @xmath323 $ ] then @xmath324 has peaks at the grid points , and if @xmath325 , the approximating function tends toward a well defined slope at the nodes . in this paper",
    ", we use the modified shepard method implementations by @xcite .",
    "this updated algorithm generalises the simple weights of the original algorithm by augmenting the approximation of @xmath314 by a quadratic multinomial whose coefficients are determined by the weighted least - squares fit to the @xmath158 nearest neighbours to @xmath13 .",
    "the weights are @xmath326 ^ 2}{[r_i(n_q ) d_i({\\mathbf{i}})]^2 }    \\label{eq : shep3}\\ ] ] where @xmath327 is the radius about @xmath311 containing @xmath328 points .",
    "we used the recommended default value of @xmath329 and @xmath330 for the two- and three - dimensional cases from @xcite .",
    "the derivatives ( e.g. for gradients of field quantities ) are easily computed analytically from the quadratically augmented form of @xmath314 . finally , at each node in the grid , we store the full orbit computation , tabulated as function of angle .",
    "these are linearly as needed to produce a full phase - space evaluation at @xmath4 ."
  ],
  "abstract_text": [
    "<S> our understanding of the mechanisms governing the structure and secular evolution galaxies assume nearly integrable hamiltonians with regular orbits ; our perturbation theories are founded on the averaging theorem for isolated resonances . on the other hand , it is well - known that dynamical systems with many degrees of freedom are irregular in all but special cases . </S>",
    "<S> for example , the solar system is chaotic and no doubt more so when dynamically young . </S>",
    "<S> similarly , although driven towards symmetry by dissipation and mixing galaxies are chaotic and , galaxies are dynamically young , are strongly affected by perturbations , and are probably strongly chaotic . </S>",
    "<S> the best developed framework for studying the breakdown of regularity and the onset is the kolmogorov - arnold - moser ( kam ) theory . here , we use a numerical version of the kam procedure to construct regular orbits ( tori ) and locate irregular orbits ( broken tori ) . </S>",
    "<S> irregular orbits are most often classified in astronomical dynamics by their exponential divergence using lyapunov exponents . </S>",
    "<S> although their computation is numerically challenging , the procedure is straightforward and they are often used to estimate the measure of regularity . </S>",
    "<S> the numerical kam approach has several advantages over lyapunov exponent computation : 1 ) it provides the morphology of perturbed orbits ; 2 ) its constructive nature allows the tori to be used as basis for studying secular evolution ; 3 ) for broken tori , clues to the cause of the irregularity may be found by studying the largest , diverging fourier terms ; and 4 ) it is more likely to detect weak chaos and orbits close to bifurcation . </S>",
    "<S> conversely , it is not a general technique and works most cleanly for small perturbations . </S>",
    "<S> we develop a perturbation theory that includes chaos by retaining an arbitrary number of interacting terms rather than eliminating all but one using the averaging theorem . </S>",
    "<S> the companion papers show that models with significant stochasticity seem to be the rule , not the exception . moreover , the subdimensionally of phase - space features spawned by chaotic dynamics demands fine - scale temporal resolution , and we discuss the implication for n - body simulations .    </S>",
    "<S> [ firstpage ]    methods : numerical  dark matter  galaxies : formation , evolution , kinematics and dynamics  chaos </S>"
  ]
}