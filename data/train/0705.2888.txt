{
  "article_text": [
    "throughout this paper , a _ lattice path _ will mean a lattice path in the plane whose only allowable steps are north @xmath2 and east @xmath3 .    it is a classical theorem @xcite@xcite that if @xmath1 is a positive integer , then the number of lattice paths from @xmath4 to @xmath5 ( where @xmath6 ) that avoid touching or crossing the line @xmath0 except at @xmath4 is given by the formula @xmath7 in fact , more is true : there are @xmath8 such paths with @xmath9 northwest corners .",
    "this stronger result appears explicitly in  @xcite and implicitly even earlier , but our favorite proofs of all these facts are the bijective proofs of goulden and serrano  @xcite .",
    "it is natural to ask if there are similar simple formulas for lattice paths from @xmath4 to @xmath10 that avoid the line @xmath0 , if @xmath1 is allowed to be an arbitrary positive rational number . while one can write down a determinantal formula ( indeed , a determinantal formula exists for an arbitrarily shaped boundary ) , nothing as simple as ( [ eq : classic ] ) is known , and empirical investigation does not suggest any obvious conjecture .",
    "our first main result is that for certain periodic staircase boundaries ( instead of straight - line boundaries ) , there _ are _ simple enumerative formulas that generalize ( [ eq : classic ] ) and ( [ eq : classicnw ] ) , at least for certain special starting and ending points .    given positive integers @xmath11 and @xmath12 , let @xmath13 be the infinite staircase path that starts at @xmath14 , then takes @xmath11 steps east , @xmath12 steps north , @xmath11 steps east , @xmath12 steps north , and so on .",
    "given a set @xmath15 of ( finite ) lattice paths , take each path @xmath16 , and augment it by prepending a north step to the beginning of  @xmath17 and appending a north step to the end of  @xmath17 .",
    "let @xmath18 denote the resulting set of lattice paths .",
    "[ thm : corners ] let @xmath11 , @xmath12 , @xmath19 , and @xmath20 be positive integers .    1 .",
    "let @xmath21 be the set of lattice paths from @xmath4 to @xmath22 that avoid @xmath13 .",
    "there are @xmath23 paths in  @xmath24 with @xmath20 northwest corners ( equivalently , @xmath20 southeast corners ) .",
    "2 .   let @xmath25 be the set of lattice paths from @xmath3 to @xmath26 that avoid @xmath13 .",
    "there are @xmath27 paths in  @xmath28 with @xmath20 northwest corners ( equivalently , @xmath20 southeast corners ) .",
    "the equivalence between counting northwest and southeast corners follows because in a lattice path that starts with a north step and ends with a north step , the first corner must be a northwest corner and the last corner must be a southeast corner , and northwest and southeast corners must alternate .",
    "also , since @xmath29 for any  @xmath15 , summing over all @xmath20 and applying vandermonde",
    "convolution immediately yields the following corollary .",
    "[ cor : total ] let @xmath11 , @xmath12 , and @xmath19 be positive integers .",
    "then @xmath30 is the same as avoiding @xmath0 except at @xmath4 , so our results generalize ( [ eq : classic ] ) and ( [ eq : classicnw ] ) in one direction , by allowing arbitrary @xmath11 and  @xmath12 , but are simultaneously more special in another direction , since only certain special endpoints are allowed .",
    "more precisely , note that if we set @xmath31 and @xmath32 in ( [ eq : classic ] ) and ( [ eq : classicnw ] ) , then we get the same answers as if we set @xmath33 and @xmath34 in ( [ eq : totalone ] ) and ( [ eq : nwone ] ) .",
    "( when @xmath34 , the map @xmath35 simply adds a northwest corner to every path . )    our proof of theorem  [ thm : corners ] is similar to goulden and serrano s in several ways but differs in one crucial way . like goulden and serrano ,",
    "we interpret ( [ eq : nwone ] ) and ( [ eq : nwtwo ] ) as counting _ all _ paths of a certain type , minus the _ bad _ paths .",
    "another similarity is the idea of breaking the bad path into two halves @xmath36 and  @xmath37 at the first `` bad point '' so as to manipulate @xmath36 and  @xmath37 into something that is easier to count .",
    "the crucial difference is that goulden and serrano _ rotate _",
    "@xmath36 , whereas we _ interchange @xmath36 and  @xmath37_. and  @xmath37 !",
    "we also overstated the difference between rotation and interchange ; if we rotate @xmath36 , then rotate @xmath37 , and then rotate the entire path , then we have simply interchanged @xmath36 and  @xmath37 .",
    "so when there is a proof by one technique , there is probably a proof by the other . finally , independently and almost simultaneously with goulden and serrano , loehr  @xcite used a rotation argument for a similar lattice - path enumeration problem . ]",
    "we also give a second proof of corollary  [ cor : total ] , which is based on a well - known argument of raney  @xcite regarding cyclic shifts of integer sequences .",
    "it is frustrating that theorem  [ thm : corners ] applies only to special endpoints .",
    "can anything be said about other endpoints ?",
    "we do not have a satisfactory answer to this question , but our second main result is a tantalizing hint that more general theorems lie waiting to be found .",
    "it is best stated in the language of binary strings ; we draw the connection to lattice paths afterwards .",
    "[ thm : binary ] for @xmath38 , @xmath39 , and @xmath40 , let @xmath41 be the number of binary sequences of length @xmath42 such that for all  @xmath43 , the @xmath43th occurrence of @xmath44 ( if it exists ) appears in positions @xmath45 and @xmath46 or later , and such that the total number of occurrences of @xmath44 and  @xmath47 is at most  @xmath48 .",
    "then @xmath49    our proof of theorem  [ thm : binary ] is again an application of raney s argument , combined with a straightforward induction on  @xmath19 .    to convert theorem  [ thm : binary ] into lattice - path language ,",
    "let @xmath50 be a binary sequence , let @xmath51 , and define @xmath52 by @xmath53 , for @xmath54 .",
    "if we convert @xmath52 into a lattice path by turning @xmath55 s into east steps and @xmath56 s into north steps , then it is easily checked that the binary sequences in theorem  [ thm : binary ] turn into lattice paths avoiding  @xmath57 , as defined below .    for @xmath39 ,",
    "define @xmath57 to be the staircase path that starts at @xmath58 , then takes @xmath59 steps east , @xmath60 steps north , @xmath11 steps east , @xmath60 steps north , @xmath11 steps east , and so on , always alternating between @xmath60 steps north and @xmath11 steps east except for the first segment of @xmath59 steps east .",
    "for example , @xmath61 is the dashed line in the lower picture in either figure  [ fig : caseone ] or figure  [ fig : casetwo ] below .",
    "curiously , we have not been able to generalize theorem  [ thm : binary ] to more general staircase boundaries , or to refine the count according to northwest or southeast corners .",
    "but for the special case when @xmath62 is even , we have a second , purely bijective proof of the following corollary of theorem  [ thm : binary ] .",
    "[ cor : sum ] for all @xmath63 and @xmath64 , the number of lattice paths of length @xmath65 that start at @xmath4 and that avoid touching or crossing @xmath66 equals the number of lattice paths of length @xmath65 that start at @xmath4 and that avoid touching or crossing the line @xmath0 except at @xmath4 .",
    "this number has the explicit formula @xmath67    formula ( [ eq : sum ] ) is of course just obtained by summing over the appropriate instances of ( [ eq : classic ] ) .",
    "these numbers also appear as a107027 in sloane s online encyclopedia of integer sequences .",
    "this cries out for a combinatorial interpretation of each summand as counting lattice paths avoiding @xmath66 but with varying endpoints .",
    "unfortunately , we do not know how to make this idea work .",
    "note that the case @xmath68 of theorem  [ thm : binary ] is particularly simple :    [ cor : fournchoosetwon ] for @xmath38 , there are @xmath69 binary sequences of length @xmath70 with the property that for all  @xmath43 , the @xmath43th occurrence of @xmath44 appears in positions @xmath71 and @xmath72 or later ( if it exists at all ) .",
    "we suspect that we have not yet found the `` proof from the book '' of corollary  [ cor : fournchoosetwon ] , and encourage the reader to find it .",
    "the outstanding open question is whether our results generalize further .",
    "we should mention two papers @xcite and  @xcite that consider staircase boundaries similar to  @xmath13 and that prove results related to corollary  [ cor : total ] .",
    "see also theorem  8.3 of  @xcite .",
    "although our results do not seem to imply or be implied by these other results , perhaps it would be fruitful to investigate the precise relationships among them .",
    "we thank mihai ciucu , don coppersmith , ira gessel , christian krattenthaler , fred kochman , lee neuwirth , and doron zeilberger for useful discussions .",
    "( of theorem [ thm : corners ] )      as we hinted above , we interpret ( [ eq : totalone ] ) as counting the set  @xmath73 of _ all _ paths of a certain type , minus the set of _ bad _ paths . for @xmath74 ,",
    "let @xmath75 be the set of all lattice paths from @xmath76 to @xmath77 , and let @xmath78 . then latexmath:[\\[|t_i|",
    "= \\binom{sn+tn}{tn } \\qquad \\mbox{and}\\qquad    of  @xmath73 as follows . given any @xmath80 ,",
    "find the smallest  @xmath81 such that @xmath82 ; such an  @xmath81 must exist .",
    "then there exists a unique @xmath83 that agrees exactly with the remainder of  @xmath17 , provided that we append @xmath81 north steps to the end of  @xmath17 .",
    "identifying @xmath17 with  @xmath84 embeds @xmath21 in  @xmath73 .",
    "it remains to show that the number of bad paths ",
    "the paths in @xmath85is @xmath86 .",
    "we partition the set @xmath85 into @xmath11 disjoint sets @xmath87 as follows . by definition ,",
    "every path in @xmath85 must hit a bad point , i.e. , a point on the boundary @xmath13 .",
    "for @xmath88 , we let @xmath89 be the set of all paths in @xmath85 whose first bad point has an @xmath90-coordinate that is congruent to  @xmath43 modulo  @xmath11 . to prove formula  ( [ eq : totalone ] ) , it suffices to show that @xmath91 , independent of  @xmath43 .",
    "fix any @xmath43 .",
    "given @xmath92 , observe that the step that terminates in the first bad point of  @xmath17 must be a north step .",
    "let @xmath36 be the portion of  @xmath17 prior to this fatal north step , and let @xmath37 be the portion of  @xmath17 after the bad point .",
    "thus @xmath93 . now comes the crucial part of the proof , where we interchange @xmath36 and  @xmath37 .",
    "more precisely , let @xmath84 be the lattice path that starts at @xmath94 and takes steps @xmath95 .",
    "see figure  [ fig : interchange ] for an example .",
    "we claim that @xmath100 bijects @xmath89 onto the set  @xmath101 of all paths from @xmath94 to @xmath102 .",
    "first note that since @xmath17 and @xmath84 have the same total number of north steps and the same total number of east steps except that one north step of  @xmath17 has been changed into an east step of  @xmath84 , it follows that @xmath84 does in fact terminate at @xmath102 .",
    "now , given any path  @xmath103 , let @xmath37 be the initial segment of  @xmath84 up to the last point of  @xmath84 that lies on the boundary @xmath13 .",
    "the next step after that must be an east step ; let @xmath36 be the remainder of  @xmath84 after that .",
    "it is straightforward to check that this allows us to construct a unique preimage  @xmath17 of  @xmath84 .",
    "this proves formula  ( [ eq : totalone ] ) .",
    "now we prove the stronger formula  ( [ eq : nwone ] ) , for northwest corners . the initial north step of each lattice path in  @xmath24 forces there to be a northwest corner with @xmath90-coordinate zero , whereas the final north step does not affect the northwest corner count .",
    "therefore if we embed @xmath21 in  @xmath73 as above , we really want to count lattice paths with @xmath9 northwest corners ( rather than @xmath20 northwest corners ) .",
    "there are @xmath104 paths in  @xmath73 with @xmath9 northwest corners , because we can pick the @xmath90-coordinates and @xmath105-coordinates of the corners independently .",
    "it therefore suffices to show that for all  @xmath43 , there are @xmath106 paths in  @xmath89 with @xmath9 northwest corners .",
    "if @xmath107 is a binary string , let @xmath108 denote its length , and let @xmath109 denote its _ weight , _",
    "i.e. , the number of @xmath56 s in  @xmath107 .",
    "let @xmath110 be the set of ordered pairs @xmath111 of binary strings such that @xmath112 , @xmath113 , and @xmath114 .",
    "it suffices to describe a bijection from @xmath101 to @xmath110 such that the composite map @xmath115 sends paths with @xmath9 northwest corners to pairs @xmath111 with @xmath116 .    before describing this bijection",
    ", we make two observations .",
    "let @xmath17 , @xmath36 , @xmath37 , and  @xmath84 be as above .",
    "the first observation is that , because of the position of the endpoint of  @xmath17 relative to the boundary @xmath13 , @xmath37 always has at least one east step .",
    "the second observation is that we lose a northwest corner when passing from @xmath17 to  @xmath84 iff @xmath37 starts with an east step , and we gain a northwest corner as we pass from @xmath17 to  @xmath84 iff @xmath37 ends with a north step .",
    "( note that we can both gain a corner and lose a corner , leaving the total corner count unchanged . ) so to track corners properly , we must watch the first and last steps of  @xmath37 .",
    "now for the bijection . given @xmath103 , construct @xmath107 by first writing down a binary string of length @xmath117 whose @xmath81th digit ( @xmath118 ) is  @xmath56 iff @xmath119 is the @xmath90-coordinate of a northwest corner of  @xmath84 , and then deleting the digit corresponding to the point where @xmath84 intersects @xmath13 for the last time .",
    "this digit must exist , because @xmath37 has at least one east step .",
    "for example , in figure  [ fig : interchange ] , we first write down @xmath120 , and then delete the @xmath121th digit to obtain @xmath122 .",
    "the first @xmath123 digits of @xmath124 are obtained by writing down the binary string of length @xmath123 whose @xmath81th digit ( @xmath125 ) is  @xmath56 iff @xmath126 is the @xmath105-coordinate of a northwest corner of  @xmath84 .",
    "the next digit of  @xmath124 is  @xmath56 iff @xmath37 does not start with a north step , and the last digit of  @xmath124 is the complement of the deleted digit of  @xmath107 . for example , in figure  [ fig : interchange ] , @xmath127 .    to see that @xmath128 , first pair off the @xmath56 s in @xmath107 and  @xmath124 arising from northwest corners that they both `` see , '' and then note that @xmath124 will have two extra @xmath56 s corresponding to the columns in which the first and last vertices of  @xmath37 appear : either @xmath124 sees a northwest corner in that column ( and @xmath107 of course does not see it ) , or there is no such corner , in which case the appropriate trailing bit of  @xmath124 will be set . either way , @xmath129 .",
    "similarly , as we pass from @xmath17 to @xmath84 to  @xmath124 , a corner that is lost from @xmath17 to  @xmath84 is `` caught '' by the penultimate bit of  @xmath124 , and @xmath124 will gain an extra  @xmath56 either by catching a gained corner or , if no corner is gained , by setting its last bit . thus @xmath130 is one more than the number of northwest corners of  @xmath17 .",
    "equivalently , @xmath109 is one _ less _ than the number of northwest corners of  @xmath17 .",
    "it remains to show that @xmath131 is a bijection .",
    "since @xmath132 , it suffices to show that @xmath84 can be reconstructed from its image @xmath111 . to reconstruct  @xmath84",
    "it suffices to reconstruct the northwest corners .",
    "the penultimate digit of  @xmath124 is  @xmath55",
    "iff @xmath84 has a northwest corner with @xmath90-coordinate @xmath133 , so we need only reconstruct the deleted digit of  @xmath107 .",
    "the _ value _ of the deleted digit is the complement of the last digit of  @xmath124 , so we need only reconstruct its _ position_. to do this , take @xmath111 and begin constructing @xmath84 from the end backwards without regard to the deleted digit . at some point , the partially reconstructed path will touch or cross the boundary @xmath13 .",
    "it is easy to check that the first such contact point with @xmath13 yields the position of the deleted digit of  @xmath107 .",
    "this completes the proof of part  ( 1 ) .",
    "the proof of part  ( 2 ) is very similar , so we focus only on the details that differ . for @xmath74 ,",
    "let @xmath75 be the set of all lattice paths from @xmath76 to @xmath134 , and let @xmath78 .",
    "then @xmath73 is our set of _ all _ paths .",
    "note that @xmath25 is already naturally a subset of  @xmath73in fact , @xmath135so we do not have to embed @xmath25 in  @xmath73 .",
    "the definition of the sets @xmath89 is exactly analogous .",
    "however , @xmath84 now starts at @xmath136 rather than at @xmath94 , and ends at @xmath102 .",
    "the proof of  ( [ eq : totaltwo ] ) now goes through as before .",
    "to do the corner count , we need to define the map @xmath137 in the case that @xmath37 is empty or vertical , i.e. , has no east steps . in this case",
    ", we always delete the _ first _ digit of  @xmath107 .",
    "the definition of  @xmath124 is the same as before .",
    "the arguments that @xmath114 and that @xmath137 is a bijection still work .",
    "however , @xmath109 is no longer always one less than the number of northwest corners of  @xmath17 .",
    "let @xmath138 denote the set of paths in  @xmath139 for which @xmath37 is vertical or empty and @xmath36 starts with a horizontal step .",
    "then it is straightforward to check that for @xmath140 , @xmath109 is _ equal _ to the number of northwest corners of  @xmath17 .",
    "so if we let @xmath141 denote the members of  @xmath142 with @xmath20 northwest corners , then pulling back @xmath110 to @xmath89 shows that formula  ( [ eq : nwtwo ] ) is the cardinality of the set @xmath143 on the other hand , if we let @xmath144 denote the subset of  @xmath25 consisting of paths that start with a north step , and observe that prepending a north step to @xmath145 adds a northwest corner to  @xmath17 iff @xmath17 starts with an east step , then we see that @xmath146 is equinumerous with @xmath147 thus to show that ( [ eq : parttwoa ] ) and ( [ eq : parttwob ] ) are equinumerous , it suffices to show that @xmath148 for any  @xmath20 . but",
    "this bijection is easily described : given a path in  @xmath144 , simply move all the initial north steps to the end ; this creates a path in  @xmath138 with one fewer northwest corner .",
    "this completes the proof .",
    "of course this follows from theorem  [ thm : corners ] , but we have another proof .",
    "the formula in equation  ( [ eq : totalone ] ) can be rewritten as @xmath149 .",
    "consider the set  @xmath150 of all paths starting at the origin that end with a north step and that have a total of @xmath151 east steps and a total of @xmath152 north steps .",
    "clearly @xmath153 and @xmath154 .",
    "we need to show that @xmath21 comprises precisely @xmath155 of the paths in  @xmath150 .",
    "decompose any path @xmath156 into @xmath19 consecutive subpaths @xmath157 , where each @xmath158 contains exactly @xmath12 north steps and ends in a north step .",
    "our desired result follows immediately from the following key claim : for _ any _ @xmath156 , there is exactly one `` cyclic shift '' of @xmath17 that lies in  @xmath21 , where by a cyclic shift we mean one of the @xmath19 paths of the form @xmath159 obtained from  @xmath17 by concatenating the subpaths in a cyclically permuted order .    to see the key claim , one first readily verifies that @xmath80 iff for all @xmath160 , the total length of the first @xmath81 subpaths @xmath161 is at least @xmath162 .",
    "now we apply an argument patterned after a classic proof of raney  @xcite . for",
    "all @xmath163 , let @xmath164 be the length of  @xmath165 .",
    "consider the graph in the @xmath166 plane with straight - line segments between vertices @xmath167 and @xmath168 , where @xmath169 the `` average '' slope of this graph is @xmath170 .",
    "the line of the form @xmath171 that is `` tangent '' to this graph from below intersects the graph exactly once every @xmath19 points , because the graph has period  @xmath19 and the coefficient of  @xmath90 is an integer plus @xmath155 .",
    "the points of intersection have the form @xmath167 , @xmath172 , @xmath173 , etc .",
    ", and the value of  @xmath43 here yields the unique cyclic shift having the desired property .",
    "this proves the claim .",
    "the proof of equation  ( [ eq : totaltwo ] ) is similar .",
    "define @xmath174 to be the set of all paths from the origin that have a total of @xmath175 east steps and a total of @xmath123 north steps .",
    "decompose any @xmath176 as follows : @xmath177 where each @xmath158 has @xmath178 north steps .",
    "then @xmath145 iff for all @xmath179 we have @xmath180 exactly one `` cyclic shift '' of  @xmath17 has the equivalent property that for all  @xmath81 , @xmath181 thus there are @xmath182 paths in  @xmath25 , which is equivalent to equation  ( [ eq : totaltwo ] ) .        it is easily verified that @xmath183 and @xmath184 .",
    "if @xmath185 and @xmath186 , then we claim that the following recursion holds : @xmath187 the reason is that an admissible binary string of order @xmath188 can be extended by any sequence of @xmath189 bits without danger of causing inadmissibility , provided that the resulting string changes from 1 to 0 or vice versa at most @xmath190 times .",
    "the parameter @xmath191 counts the number of changes introduced by the last @xmath189 bits , and the binomial coefficient counts the number of ways to position the @xmath191 changes .    by vandermonde convolution",
    ", the recurrence ( [ eq : recursion ] ) almost gives us a proof by induction on  @xmath19 , except that we need to handle the cases @xmath192 and @xmath193 .",
    "note that no string of order @xmath19 can have more than @xmath194 changes , and that equation  ( [ eq : binary ] ) takes the same value for @xmath192 and @xmath193 .",
    "so to complete the proof of theorem  [ thm : binary ] , it is enough to show that @xmath195 which can be rewritten as @xmath196 .",
    "the left - hand side counts the admissible strings with exactly @xmath194 changes , and we use the proof technique of raney as before .",
    "any such string @xmath37 must start with 0 ; we decompose it into substrings @xmath197 , where each @xmath198 consists of @xmath199 zeroes followed by @xmath200 ones , and @xmath201 .",
    "the condition for admissibility can now be expressed as @xmath202 for all @xmath203 .",
    "exactly one cyclic shift of  @xmath37 has the equivalent property that for all @xmath81 , @xmath204 thus the number of admissible strings with exactly @xmath194 changes is equal to @xmath155 times the number of ways to partition @xmath42 into @xmath205 positive integers , corresponding to the numbers @xmath199 , @xmath200 .",
    "this is well known to be @xmath206 , and this completes the proof .",
    "we can deduce this easily from theorem  [ thm : binary ] just by showing that equation  ( [ eq : binary ] ) reduces to equation  ( [ eq : sum ] ) when @xmath193 and @xmath62 .",
    "we have @xmath207 breaking up the sum , the right - hand side becomes @xmath208 , \\end{aligned}\\ ] ] or @xmath209 \\binom{2(k+1)n}{2n } - ( k-1 ) \\sum_{i=0}^{2n-1 } \\binom{2(k+1)n}{i},\\ ] ] which then collapses to formula  ( [ eq : sum ] ) .",
    "however , we also give a direct bijective proof .",
    "if @xmath210 then formula  ( [ eq : sum ] ) simplifies to  @xmath211 , the boundary conditions are nearly vacuous , and the result is easy to prove .",
    "so fix @xmath212 and @xmath38 .          to see that a bijection between @xmath213 and @xmath215 implies the corollary , we make two observations .",
    "first , because @xmath214 is a multiple of  @xmath218 , every lattice path of length @xmath214 that avoids @xmath0 can be extended by either an east step or a north step without hitting the line @xmath0 ; therefore @xmath219 is exactly half the number of lattice paths of length @xmath65 that avoid @xmath0 .",
    "second , the paths excluded by the final condition on  @xmath215 are precisely those that avoid the line @xmath216 after @xmath3 , and therefore are in bijection with @xmath213simply prepend an east step to each path in  @xmath213 .",
    "we define a procedure called _ trisection _ that we need in our construction of  @xmath221 .",
    "define the _ potential _ of a point @xmath222 to be @xmath223 .",
    "let @xmath224 be a lattice path , not necessarily starting at @xmath4 , but with the property that the potential difference of  @xmath224i.e .",
    ", the potential of the last point of  @xmath224 minus the potential of the first point of  @xmath224is at least @xmath218 ( and hence in particular comprises at least @xmath218 steps ) . to trisect  @xmath224 , first look at the last @xmath1 steps of  @xmath224 .",
    "if all of these steps are east steps , then the trisection procedure fails .",
    "otherwise , let @xmath225 be the segment of  @xmath224 consisting of the last north step of  @xmath224 along with all the east steps after that .",
    "let @xmath226 be the length of  @xmath225 .",
    "find the _ last _ lattice point @xmath227 such that the initial segment  @xmath228 of  @xmath224 comprising everything up to  @xmath229 has potential difference exactly @xmath230 .",
    "such a point @xmath229 must exist ( since increases in potential can occur only one unit at a time ) and must occur prior to  @xmath225 . let @xmath231 be the segment of  @xmath224 between @xmath228 and  @xmath225 .",
    "the decomposition @xmath232 is the trisection of  @xmath224 .",
    "note that the potential difference of  @xmath225 is @xmath233 and so the combined potential difference of @xmath228 and  @xmath225 is zero ; thus the potential difference of  @xmath231 is the same as that of  @xmath224 .",
    "we are now ready to describe @xmath221 . given @xmath234 , the construction of @xmath235 has two phases . in phase  1 , we decompose @xmath224 into segments ; in phase  2 , we build @xmath235 using the segments constructed in phase  1 .",
    "the paths in  @xmath213 with the smallest potential difference are those that terminate closest to the line  @xmath0 ; these are readily checked to have potential difference at least @xmath218 .",
    "we begin phase  1 by trying to trisect @xmath224 into @xmath236 .",
    "if this fails , we proceed to phase  2 .",
    "otherwise , if the _ height _ of  @xmath237 ( i.e. , the @xmath105-coordinate of the last point of  @xmath237 minus the @xmath105-coordinate of the first point of  @xmath237 ) is even , then we proceed to phase  2 .",
    "otherwise , we try to trisect @xmath231 into @xmath238 , proceeding to phase  2 if the trisection fails or if @xmath239 has even height .",
    "if we still do not reach phase  2 , then we try to trisect  @xmath240 , and so  on .",
    "each successful trisection preserves the potential difference of the middle section while shrinking its length , so we must eventually reach phase  2 , with a decomposition @xmath241 for some  @xmath242 , where @xmath243 denotes whatever remains in the middle .",
    "if we reach phase  2 because the height of  @xmath244 is even , then we set @xmath245 where the `` east '' means that we begin @xmath235 with an east step .",
    "for an example with @xmath246 and @xmath247 , see figure  [ fig : caseone ] .",
    "the other way to reach phase  2 is for the last @xmath1 steps of  @xmath243 to all be east steps . decompose @xmath248 where @xmath249 comprises those final @xmath1 east steps . then set @xmath250 for an example , again with @xmath246 and @xmath247 , see figure  [ fig : casetwo ] .",
    "one must check that @xmath251 .",
    "waypoint _ to be a point on the line @xmath216 that is midway between two consecutive southeast corners of  @xmath66 ( i.e. , it has the form @xmath252 for some  @xmath81 ) . the claim that @xmath251 can be broken down into subclaims : ( 1 )  the part of @xmath235 preceding  @xmath237 avoids @xmath66 and takes us to a waypoint ; ( 2 )  each pair @xmath253 , @xmath254 , etc .",
    ", resulting from successful trisections takes us from one waypoint to another and avoids  @xmath66 ; ( 3 )  the last part @xmath243 or  @xmath255 starts at a waypoint and avoids  @xmath66 . checking these subclaims",
    "is easier to do oneself than to write out in detail , so we will just indicate the key points .",
    "the claims about waypoints follow because an @xmath256 pair has potential difference zero , and therefore if it starts on @xmath0 then it ends on @xmath0 .",
    "if @xmath257 has odd height then @xmath256 ends on a waypoint if it starts on a waypoint . at most one  @xmath257 , namely  @xmath244 ,",
    "has even height , and then @xmath258 takes us from @xmath3 to a waypoint .",
    "the other tricky claim is that @xmath256 avoids  @xmath66 , but this follows because by construction , the potential of @xmath257 never drops below its initial potential so that it even stays below the line @xmath216 ; also , if we trace @xmath259 backwards from its terminal waypoint , it takes at most @xmath260 horizontal steps and therefore avoids hitting  @xmath66 .",
    "to invert  @xmath221 , suppose we are given @xmath261 . whether figure  [ fig : caseone ] or figure  [ fig : casetwo ] applies depends on whether the first step of  @xmath224 is north or east .",
    "mark all the waypoints of  @xmath224 ; there must be at least one , since @xmath261 . by backing up from a waypoint until we find a north step",
    ", we can construct the  @xmath259 , and therefore also the  @xmath257 and  @xmath243 . hence @xmath221 is easily reversed .",
    "we leave the straightforward verification of the details to the reader .              c. krattenthaler , the enumeration of lattice paths with respect to their number of turns , in _ advances in combinatorial methods and applications to probability and statistics , _ ed .",
    "n.  balakrishnan , birkhuser , boston ( 1997 ) , 2958 ."
  ],
  "abstract_text": [
    "<S> there is a strikingly simple classical formula for the number of lattice paths avoiding the line @xmath0 when @xmath1 is a positive integer . </S>",
    "<S> we show that the natural generalization of this simple formula continues to hold when the line @xmath0 is replaced by certain periodic staircase boundaries  but only under special conditions . </S>",
    "<S> the simple formula fails in general , and it remains an open question to what extent our results can be further generalized .    ,    ,    ,    ,    ballot sequence , zigzag , stairstep , touching , crossing , tennis ball </S>"
  ]
}