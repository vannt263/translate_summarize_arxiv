{
  "article_text": [
    "end - to - end simulation of the next generation of telescopes , their adaptive optics systems , instrumentation , and control systems is increasingly a necessity given their high cost and complexity . for existing systems with planned upgrades or changes , minimizing disruption by conducting rigorous computer or lab testbed simulations",
    "@xcite is essential .",
    "simulations of the entire optical pipeline and control algorithms have been employed with great success in programs such as the gemini planet imager ( gpi ) @xcite .",
    "systems under construction ( the large synoptic survey telescope ( lsst ) @xcite ) or in the early design stage ( the thirty meter telescope @xcite ) have devoted significant fractions of their time and monetary budgets to producing detailed error budgets .",
    "systems like lsst , which are particularly sensitive to atmospheric variability @xcite , need atmosphere models that closely match real conditions while not extending their already significant computational requirements .    underpinning all simulations",
    "is the atmosphere model through which wavefronts from artificial sources propagate and accumulate phase errors that a simulation in turn propagates through a telescope s optics to observe the effect on the system s point spread function ( psf ) .",
    "systems with active @xcite or adaptive optics ( ao ) @xcite then make their best effort to correct for these phase errors .",
    "one of the more prevalent methods used to mimic wind in simulations is by invoking taylor s frozen flow hypothesis : generating large phase screens of zero - mean , gaussian white noise in the time domain , scaling them according to the desired statistics ( _ e.g. _ kolmogorov ) in fourier space @xcite , and translating them across the aperture at each time step . one phase screen is generated for each wind layer with dimensions based on exposure time , desired screen resolution , wind speed and direction in that layer , and considerations like making the array square and close to a power of 2 to apply a fast fourier transform ( fft ) . while this method has proven its utility thus far",
    ", the advent of large - aperture telescopes @xcite or ones with wide fields of view means @xcite that simulations will and do rapidly run up against computation and storage limits , particularly for high - resolution or long - exposure runs . for example , the gpi adaptive optics simulator ( gpiaos ) is limited to a 4-second maximum exposure because of memory limits and the lsst simulation team has to generate phase screens that are tens of gigabytes per wind layer for their runs @xcite .",
    "there are two major recent thrusts in phase screen generation research .",
    "1 ) solutions that preclude the need to generate large phase screens exist or are being developed , such as extending aperture - sized screens by a few columns at each time step @xcite .",
    "however , they do not address atmospheric `` boiling '' and changing the atmospheric turbulence model used is not trivial .",
    "2 ) there are also efforts to increase the realism of simulations by generating and evolving turbulence at multiple scales @xcite or evolving atmosphere parameters , like phase coherence length @xcite . in this paper",
    "we present an autoregressive ( ar ) method that encompasses aspects of both research direction : it is a computationally efficient method that can be used to simulate frozen flow for long - exposure simulations or for wide - aperture systems ; it accommodates a wide variety of turbulence models ( kolmogorov , von karman , bespoke ) ; it uses one parameter ( @xmath1 ) to vary stochastic content and another ( @xmath2 ) to set the turbulence model parameters , both of which can be varied in time , as outlined in section [ sec : method ] .",
    "the ar method starts with the translating screen generation method described in the previous paragraph @xcite , advances phase in the fourier domain to simulate wind and adds in appropriately scaled noise at each time step to inject random variations to simulate `` boiling . ''",
    "it provides a path around computational resource limitations and is simple to implement , especially when compared to the complexity of modal methods @xcite .",
    "the ar method is compatible with any sample - based phase screen generation method that operates in the fourier domain",
    ". both major shortcomings of fft - based methods cited as motivation for current phase screen work @xcite , finite exposure times and static atmosphere parameters , are addressed by the ar method .",
    "a method using a markov process with elements similar to the one we propose is described in @xcite .",
    "phase translation to simulate wind occurs in the fourier domain and scaled , decorrelated phase is added to an instantiation of a phase screen .",
    "however , the decorrelation coefficient ( analogous to our autoregression coefficient ) increases with spatial frequency , something that we find does not correspond to measured telemetry as we outline in section [ sec : motivation ] .",
    "in addition , the method is subject to periodicity , a shortcoming common to all fourier - based methods , which results in phase screen sizes increasing with simulation length .",
    "periodicity is an issue we explicitly address below and in section [ ssec : periodicity ] .",
    "there is no change in phase screen size as simulation time increases using the autoregressive method described in this paper .",
    "the authors also do not make it explicitly clear whether they add decorrelated phase at each time step in a simulation , while we outline our algorithm in an easily replicable manner with detailed analysis of its memory and computation requirements .",
    "two additional criticisms of sample - based fourier methods are the periodicity of generated screens , which wrap around the domain , and the fidelity of their power spectra to theory , in particular at low and high spatial frequencies .",
    "algorithms to eliminate periodicity by extending the physical size of the screen @xcite exist and can be applied to the ar method , but , as we demonstrate in section [ ssec : periodicity ] , the process of adding stochastic content with the desired power spectrum at each time step effectively results in the renewal of phase after a time interval that scales with the magnitude of the autoregressive scaling coefficient used .",
    "efforts to address the power spectrum problem have ranged from hybrid , covariance - based , fourier - modal representations of phase @xcite to modifications of the sample - based fourier methods @xcite .",
    "the sample - based methods have tended to concentrate on low spatial frequency power because spectral roll - off at the high - frequency end means that the low - frequency power mismatch is the more significant problem @xcite .",
    "a hybrid method @xcite , while producing screens whose power content agrees well with theory , still invokes frozen flow , suffers from periodicity and is order @xmath3 in complexity ( where @xmath4 is the number of points in the screen ) .",
    "methods that add subharmonics to boost low - frequency power are efficient augmentations to the ar method as long as the power spectrum scaling coefficient ( denoted @xmath5 in section [ sec : method ] ) is appropriately adjusted to conserve total power .",
    "the markov process screen generation method described above includes an analysis of how to add a computationally reasonable set of subharmonics that will yield a spatial power spectrum which conforms more closely to theory @xcite .",
    "however , we are in the process of analyzing telemetry gathered from instruments such as gpi and the shaneao adaptive optics system @xcite on the shane 3-meter telescope at lick observatory and will exploit the capacity to modify power in each fourier mode to match measured data .",
    "section [ sec : method ] describes the ar phase screen generation method in detail .",
    "its reduced memory requirements , computation complexity that is at least comparable to ( if not less complex ) than commonly used existing phase screen generation methods and lack of periodicity are analyzed in section [ sec : memory ] .",
    "we test phase screen psds for fidelity to theory and illustrate the impact of adding small amounts of boiling to frozen flow phase on the gpi ao simulator , which incorporates large parts of the as - built system , in section [ sec : validation ] .",
    "key metrics such as contrast ratio are reduced by factors of 220 in the central regions of a target bright star s psf , _",
    "i.e. _ in precisely the area the system is expected to find and take spectra of exoplanets .",
    "we analyze differences in power content of ar atmospheres and frozen flow screens .",
    "finally , we provide an example of fitting collected telemetry with the ar model in section [ sec : motivation ] . this section serves to provide justifications for our assumptions on model parameters and to tie this work into the broader picture of our ongoing work on wind predictive ao .",
    "wind predictive ao relies on kalman filters generated from ar model fits to telemetry in real - time .",
    "the filter generator will be trained on more realistic phase screens that incorporate multiple wind layers and `` boiling '' parameters extracted from a large corpus of existing telemetry from gpi and the shane telescope .",
    "the key differentiator between the ar method and others is the ability to tailor atmospheres and vary power in frozen flow and stochastic components at a modal level .",
    "each fourier mode has an associated complex autoregressive scaling parameter , @xmath1 with @xmath6 , which attenuates phase from the previous timestep . in addition , the phase of @xmath1 encodes wind velocity and direction for a given layer @xcite .",
    "multiplying by an exponential in the fourier domain translates each fourier mode resulting in a frozen flow effect which wraps around the domain . setting @xmath7 produces pure frozen flow .",
    "the autoregressive method for a given wind layer starts at time @xmath8 by generating a phase array , @xmath9 , in the commonly used manner outlined above which is slightly wider than the telescope primary pupil diameter to mitigate edge effects .",
    "white noise is scaled in fourier space by a kolmogorov power law , @xmath2 , ( _ n.b .",
    "_ @xmath2 can also follow von karman statistics where outer scale is important or other turbulence models , even , as we foreshadow in section [ sec : motivation ] , fits to telemetry ) to give it the appropriate power spectrum @xcite as follows :    @xmath10    where :    * @xmath11 screen diameter in meters * @xmath12 number of pixels across screen ( which is @xmath13 in extent ) * @xmath14 fried s parameter @xcite or phase coherence length in meters at a wavelength of 500 nm * @xmath15 = spatial frequency components ( meter@xmath16 ) .    for each subsequent iteration",
    ", we treat the evolution of phase , @xmath17 ( in radians ) , as an autoregressive process of order 1 in fourier space , denoted ar(1 )  _ i.e. _ one where the phase at at any given time step is only dependent on the phase from the previous time step and added noise scaled by @xmath2 @xcite . for fourier - transformed ( ft ) phase from the previous timestep , @xmath18 , each fourier mode ( @xmath19 ) is scaled by @xmath1 .",
    "ar coefficient @xmath1 is a complex array , @xmath20 in extent , and a function of spatial frequency ( @xmath21 ) so each frequency can be individually modified .",
    "the magnitude of @xmath1 determines how much past phase is attenuated at every time step .",
    "the phase of @xmath1 ( designated @xmath22 to avoid confusion with atmospheric phase ) contains wind velocity and direction information .",
    "it translates @xmath23 in the fourier domain@xcite and is given by :    @xmath24    where :    * @xmath25 are wind velocity components ( meters s@xmath16 ) * @xmath26 is the sampling interval ( in seconds )    appropriately scaled , fourier - transformed , unit - variance , spatially white noise ( @xmath27 , also an @xmath13 array , @xmath28 ) is added back in at each timestep to simulate the effect of turbulence .",
    "the white noise scale factor ( @xmath29 ) is a function of @xmath1 and @xmath2 so that total power is conserved across phase screen time series as @xmath1 varies  something that we verify in section [ sec : validation ] .",
    "any method used to boost low spatial frequency power would also require modifying @xmath5 .",
    "the atmospheric phase in the fourier domain at any timestep @xmath30 is :    @xmath31",
    "when using a fft , spatial frequencies are indexed as fourier modes , ( @xmath32 ) .",
    "flowcharts comparing the traditional frozen flow method and this new autoregressive method are shown in fig .",
    "[ fig : flowchart ] .",
    "flowcharts comparing the traditional frozen flow atmosphere generation process ( _ left _ ) and the autoregressive ar(1 ) process ( _ right _ ) for a 1-layer atmosphere ( the process is repeated for each wind layer ) .",
    "the seeming simplicity of the frozen flow flowchart belies its memory requirements . in the autoregressive method , @xmath33 and",
    "this determines by how much prior atmospheric phase is attenuated .",
    "the phase of @xmath1 carries information about wind velocity and direction in the layer as seen in equation [ eqn : alphaphase ] . ]    for our implementation of this method we chose a computationally efficient dft method , fftw3 @xcite .",
    "each complex fourier transform is of order @xmath34 floating point operations ( flops ) , where @xmath35 .",
    "fftw3 has the advantage of delivering the same performance for values of n that are not powers of 2 as well , which is not the case for conventional implementations of the fft algorithm ( such as that bundled with the idl programming language ) . as seen in fig .",
    "[ fig : flowchart ] , in the normal course of operation , each iteration involves generating an @xmath20 array of white , gaussian noise , followed by a scaling operation and a fourier transform ( ft)/inverse fourier transform ( ift ) pair for each wind layer .",
    "other than the ft / ift pair , the other operations are element - wise , 2-d array operations of order @xmath36 .",
    "hence , the overall complexity of the ar algorithm is of order @xmath37 .",
    "more realistic simulations will have to evolve @xmath38 and wind speeds in time , which means @xmath2 and @xmath1 will have to be recalculated periodically in the course of a simulation .",
    "while this will increase computation time , the memory requirements and complexity will not change .    the ar method s computational complexity is of the same order as the traditional frozen flow method ( @xmath37 ) , with a significantly smaller n , as shown later in this section .",
    "when comparing per iteration , sub - pixel shifts of a large array to simulate wind in any direction for the conventional method can be done in the fourier domain on a sub - array around the aperture .",
    "this entails performing a ft / shift / ift operation on an array at least as large as the ar phase array , so the ar method performs no worse , computationally speaking , per timestep .",
    "both methods could improve performance by generating hermitian white noise in the frequency domain @xcite , which removes the need for an fft per timestep .",
    "covariance - based methods @xcite can do no better than @xmath39 , with @xmath40 inflated by the requirement of creating a large , translating screen to mimic wind using a frozen flow model",
    ".    phase screen extrusion methods @xcite which extend phase screens by a few columns , @xmath41 , in the direction of wind flow compute a covariance matrix at each timestep which is a matrix multiplication operation involving a matrix of size @xmath42 and a vector with @xmath43 elements .",
    "this is an @xmath36 operation ( where @xmath35 as noted above )  more efficient than the ar method .",
    "if a simulation is tracking more than one atmosphere layer , phase screen generation and evolution of each layer is handled separately in the fourier domain before a linear combination of the real part of their ifts is used as the new wavefront in a given simulation timestep .",
    "memory requirements for a multiple wind layer simulation are :    @xmath44    where :    * @xmath4 is the number of wind layers ( + 1 for the cumulative phase that is actually fed into simulation ) * @xmath45 , number of points and @xmath46 , the pixel width of the screen .",
    "@xmath47 is a scale factor on the order of unity used to scale up screen size to the nearest size convenient for ffts , reduce periodicity or increase low - order spatial power .",
    "@xmath48 is entrance pupil diameter in meters and @xmath49 is the spatial sampling scale or resolution of the phase screen ( meters pixel@xmath16 ) * @xmath50 is the number of bytes per phase array element ( varies depending on the precision desired  typically 4 or 8) and the factor of 2 arises because phase in the fourier domain is a complex number    for example , phase screens used with the gpiao simulator are 48 subapertures across and each subaperture is 8 pixels wide , resulting in @xmath51 pixel screens for each time step .",
    "the gemini telescope s primary mirror is 7.7 meters in diameter with 43 subapertures across it .",
    "a complex phase screen fourier array for a single wind layer ( regardless of wind speed , direction and exposure time / simulation length ) occupies @xmath52 mb for a given time step in the idl - based gpiaos .",
    "in contrast , a translating frozen flow phase screen with a typical wind velocity measured on cerro pachon of @xmath53 m / s east - southeast @xcite requires a large value of @xmath40 ( equation [ eqn : memeqn ] ) to account for the wind vector and simulation length .",
    "since the screen has to be square and @xmath54 can only be a limited set of values ( _ e.g. _ powers of 2 form one subset of allowable @xmath54 values ) , a 1-second simulation requires a @xmath55 pixel screen ( 18.9 mb ) per wind layer while a 4-second run demands a @xmath56 pixel screen ( 134 mb ) per layer .",
    "in addition , the entire screen for a wind layer has to be carried in memory ( though memory mapping can solve the problem of ram capacity with the trade - off of slowing down simulation time with hard drive accesses ) and manipulated at each timestep .",
    "hence , the storage requirements for a 1-second simulation run are 16 times smaller per timestep when using an ar phase screen versus a translating phase screen . for a 4-second simulation ,",
    "the analogous factor is 113.8@xmath57 smaller .",
    "memory requirements for the ar method are no different than those for phase screen extrusion methods : the screen size for each timestep is the determined by the desired aperture size and resolution .    for computation comparisons , @xmath40log@xmath58 for the @xmath59 , @xmath60 and @xmath61 screen size cases",
    "is @xmath62 , @xmath63 and @xmath64 respectively , which indicate the ar method is @xmath65 and @xmath66 more efficient for 1-second and 4-second simulations .",
    "sample - based fourier methods suffer from the problem of periodicity @xcite , in that phase screens wrap around the domain . in the case of ar - generated phase screens ,",
    "the addition of scaled noise at each timestep results in a substantially uncorrelated phase screen after a time interval dependent on @xmath67 .",
    "for example , after 500 timesteps , with @xmath68 , less than 1% of the phase from the initial timestep is retained ( @xmath69 ) .",
    "the corresponding interval for @xmath70 is 5000 timesteps . a phase screen for a given wind layer with velocity @xmath71 m / s would take approximately 1 second to traverse the gemini aperture , hence using @xmath70 for",
    "that layer would require a screen spanning a spatial extent @xmath72 larger than the aperture at an ao system rate of 1 khz to minimize periodicity .",
    "however , this screen size would not change with wind direction or simulation length , unlike for the traditional frozen flow screen generation methods .",
    "it is only dependent on wind speed , ao system rate and the chosen value of @xmath67 for a given layer .",
    "the set of tests we performed to validate our ar atmospheres can be classified as * a ) * verification of the shape and distribution of spatial and temporal power spectra to show that the ar phase screen generation method conforms to theory and * b ) * comparisons in ao simulator performance between pure frozen flow atmospheres and ar atmospheres to quantify how changes in assumptions about the atmosphere model affect system performance metrics . in the case of gpi , a planet imager that seeks to occult a target star and enhance contrast ratio in the region immediately surrounding the star , one key",
    "metric is residual scattered light at low radii centered on the parent star , a region where there is a high likelihood of discovering planets .",
    "the lsst project has also observed material changes in psf recovery from the addition of `` boiling '' via the ar method to their simulations which is causing them to revisit assumptions about their atmosphere model @xcite .",
    "characterizing the changes in system response to injected stochastic content is a necessary step in the process of deciding whether replacing the existing model with another is worth the effort .    in both tests , atmosphere datacubes ( time series of 2-d phase screens ) were sized slightly larger than the gemini south primary pupil ( @xmath73 with a pixel scale of 0.0224 meters pixel@xmath16 ) and with @xmath68 or @xmath70 . for the power spectrum checks",
    ", we generated higher - resolution ( in time ) ar atmosphere datacubes with 8192 timesteps ( representing a 5.46-second exposure at the gpi frame rate of 1.5 khz ) .",
    "comparative simulations were fed atmosphere realizations for a 1 second exposure when analyzing point spread function ( psf ) differences between ar and frozen flow screens .",
    "longer 22-second exposures at 1 khz were used when comparing to gpi telemetry , which was collected in blocks with the same parameters .",
    "three wind layers with differing velocities and directions derived from conditions observed at cerro pachon were tracked @xcite .",
    "a blackman window was used to generate an unbiased , low - leakage periodogram with interval length set to 1024 samples for ar atmosphere phase screen time series of varying lengths in time and scaling parameter , @xmath1 .",
    "spatial psds were calculated at each radial spatial wavenumber within the gpi aperture by exploiting parseval s theorem and compared to theory @xcite .",
    "temporal psds were plotted over a frequency range [ -512,512 ] hz from the generated periodograms @xcite .",
    "spatial psds for datacubes comprising time series of autoregressive phase screens with @xmath68 ( _ left _ ) and @xmath70 ( _ right _ ) .",
    "overplotted on both is the theoretical kolmogorov power spectrum derived from @xcite .",
    "power spectral density of each datacube follows the expected kolmogorov slope ( @xmath74 ) .",
    "the @xmath68 datacube exhibits lower variance about the theoretical slope because of the higher magnitude scaled noise injected into successive frames.,title=\"fig : \" ]   spatial psds for datacubes comprising time series of autoregressive phase screens with @xmath68 ( _ left _ ) and @xmath70 ( _ right _ ) .",
    "overplotted on both is the theoretical kolmogorov power spectrum derived from @xcite .",
    "power spectral density of each datacube follows the expected kolmogorov slope ( @xmath74 ) .",
    "the @xmath68 datacube exhibits lower variance about the theoretical slope because of the higher magnitude scaled noise injected into successive frames.,title=\"fig : \" ]    spatial psds for @xmath75 are shown in fig [ fig : spat - psd ] .",
    "these atmosphere realizations used kolmogorov statistics and demonstrate the expected @xmath74 slope for spatial frequency , @xmath76 ( the theoretical power spectrum is overplotted for comparison ) @xcite .",
    "the psd for @xmath70 shows a greater variance around the theoretical slope because of the higher correlation between phase from one timestep to the next .",
    "the greater stochastic content in the @xmath68 phase screens makes it hew closer to the power spectrum for infinite realizations of purely random screens .    correctly scaling @xmath5 ensures overall power is conserved between datacubes with varying @xmath1  fig .",
    "[ fig : temp - psd ] shows phase screen series with lower magnitudes of alpha have lower peaks and wider temporal power spectrum profiles , but the integral under the curve is constant as @xmath67 varies .",
    "temporal power spectral density comparison for two sets of autoregressive phase screen time series with @xmath68 and @xmath70 plotted over the full temporal frequency range ( _ left _ ) and zoomed in to lower frequencies ( _ right _ ) to show the lower power peak for the @xmath68 case .",
    "integrated power is the same for both cases.,title=\"fig : \" ]   temporal power spectral density comparison for two sets of autoregressive phase screen time series with @xmath68 and @xmath70 plotted over the full temporal frequency range ( _ left _ ) and zoomed in to lower frequencies ( _ right _ ) to show the lower power peak for the @xmath68 case .",
    "integrated power is the same for both cases.,title=\"fig : \" ]      ar and frozen flow atmosphere realizations were fed into the gpi ao simulator @xcite and the spatial and temporal power content of the residual phase in each case was compared to test the sensitivity of modeled instrument behavior to atmosphere models with greater turbulence added .",
    "the gpi ao simulator is a detailed end - to - end system simulation with fourier optics components .",
    "it uses a standard approach of translating large phase screens to generate a frozen flow atmosphere .",
    "the output of the ao system feeds an apodized - pupil lyot coronagraph .",
    "the coronagraph suppresses diffraction and the spatial filter creates a dark hole where the residual scattered light is a function of both propagated wavefront sensor noise and residual atmosphere . until the ar method was used for atmosphere generation , simulations were limited to 4-second exposure times , a constraint that has now been lifted .",
    "in addition , it is now possible to simulate aspects of gpi s calibration system , which compensates for slowly varying non - common path errors ( like temperature , flexure and changing gravity vector ) and operates on timescales of tens of seconds to minutes .",
    "radially averaged profile of science psf image produced by the gpi ao simulator running in closed - loop for three realizations of the atmosphere : pure frozen flow ( blue ) , autoregressive with @xmath70 ( black ) and @xmath68 ( red ) .",
    "intensity on the y - axis is normalized such that the peak of the ideal , unblocked psf is 1 . inside the innermost 10-pixel radius ,",
    "psf intensity is suppressed by coronagraphy . outside the corrected area at a radius of @xmath77 pixels ,",
    "the power in all psfs converges . at lower orders ,",
    "the ar atmospheres have greater residual power : @xmath78 for @xmath70 and @xmath79 for @xmath68 ) .",
    "the scattered light at a spatial location in the psf corresponds directly to a specific fourier mode in the spatial psd . ]",
    "we observed that the ar - generated atmospheres resulted in psf images with more scattered light ( higher intensity ) at lower radii when compared to pure frozen flow ( @xmath80 for @xmath70 and @xmath79 for @xmath68 ) .",
    "[ fig : arvff ] shows a psf comparison of the default controller for each atmosphere type : pure frozen flow , ar with @xmath70 , and ar with @xmath68 . the plot is a radial average of the normalized intensity of the instantaneous science psf recorded half way through a 1-second simulation run .",
    "intensity is normalized such that the peak of the ideal , unblocked psf is set equal to 1 .",
    "scattered light at a given location in the psf plot corresponds to residual power for a specific fourier mode @xcite .",
    "hence , the excess power seen close to the center of the psf ( at low radii ) translates into more power at low order fourier modes , @xmath81 $ ] . below a radius of 10 pixels ,",
    "power is suppressed by the apodized lyot coronagraph . however , in the 10 - 100 pixel radius region ( gpi s `` dark hole '' @xcite ) , significantly different psfs were recorded for small variations in atmospheric power distributions , which impacts the ability of the instrument to detect planets that lie close to the target star . to verify that this was a feature inherent in ar atmospheres that could be exploited when comparing to telemetry or a vestige of artefacts introduced by gpiaos",
    ", we compared the temporal psds of the input atmosphere models .",
    "analysis of the temporal power spectra of ar atmospheres versus pure frozen flow atmospheres reveals the source of the elevated low - order intensity in fig .",
    "[ fig : arvff ] .",
    "[ fig : temppsd - olvcl ] plots the open- and closed - loop temporal psds , _",
    "i.e. _ the power content of the ar atmosphere datacubes ( open - loop ) and that of the residuals as seen by the system s wavefront sensor using the default controller ( closed - loop ) . the two types of atmospheres have similar low - frequency power but the broad wings beyond 5 hz in the open - loop ar psd are not suppressed resulting in broad wings in the closed - loop psd and , hence , more scattered light close to the center of the psf in fig .",
    "[ fig : arvff ] .",
    "the residuals for an ar atmosphere with @xmath68 in the right - hand plot in fig .",
    "[ fig : temppsd - olvcl ] show elevated power levels ( the area under the curve is @xmath79 greater ) over the frozen flow model atmosphere consistent with the differences seen in fig . [",
    "fig : arvff ] .",
    "the temporal structure of the atmosphere model evidently has a large impact on system performance .",
    "the magnitude of the impact can be estimated using the error transfer function ( etf ) of a simulator because a change in input psd changes the error output of a closed loop system @xcite .",
    "the etf for gpiaos @xcite , which applies corrections two frames after measurement , is given by :    @xmath82    where :    * @xmath83 , @xmath84 is the default modal gain and @xmath85 is integrator leak gain .",
    "the temporal psd of the measurements of the ao system in closed loop is estimated by :    @xmath86    where :    * @xmath87 is the temporal psd of the phase ( measured when the system applies no correction ) .",
    "* @xmath88 is the temporal psd of the wfs noise ( measured when the system is run closed - loop with no phase aberrations passed through it _",
    "i.e. _ with no phase screen ) .    we can neglect the impact of the wfs response on the atmosphere as it is significant only at high temporal frequencies .",
    "further details on this type of modeling are outlined in ch .",
    "6 of @xcite .",
    "more than an exercise in curiosity , in at least the gpi case , greater scattered light near the core of the psf has the very real effect of decreasing contrast and reducing sensitivity to and detection of exoplanets .",
    "hence , simulating the operation of the system with more realistic atmosphere models that have the same statistics as recorded telemetry will provide more credible limits to the system s capabilities . using such models will allow tests of control schemes that improve contrast in conditions that more closely resemble the real - world observing environment than pure frozen flow atmosphere models .",
    "in the next section we describe our ongoing effort to exploit the flexibility and customizability of the ar method to build a better atmosphere model by extracting meaningful parameters like wind speed and direction , wind layers with the most power content , and statistics like @xmath38 and @xmath89 .",
    "the magnitude of the effect of introduced `` boiling '' on psf quality , plotted in fig .",
    "[ fig : arvff ] , illustrates the need to better understand atmospheric characteristics , find ways to measure them and correct for them . in the previous sections we have outlined an ar model with a number of degrees of freedom that account for and temporally evolve aspects of atmospheric turbulence such as statistics ( @xmath38 , @xmath89 ) , `` boiling '' , and wind layers with differing wind velocities and directions while still remaining computationally tractable and suitable for large - scale simulations . tuning those degrees of freedom to improve upon prior models and better",
    "reflect reality by comparing to gathered telemetry is the next phase .",
    "we are in the process of analyzing telemetry gathered by ao systems on gpi and the shane telescope at lick observatory @xcite , by performing ar model fits to temporal psds and extracting parameters from spatial psds .",
    "this effort , in turn , feeds into implementing wind predictive ao @xcite on a test bed @xcite and on - sky to eliminate temporal errors caused by wind - blown phase .",
    "the wind predictive method employs kalman filters and linear quadratic gaussian ( lqg ) control to notch out power in wind peaks found .",
    "the ar method will be used to generate synthetic atmospheres on which the kalman filter generator will be trained .",
    "we wish to explore the sensitivity of kalman filters to power in the random element of the atmosphere and crafting a realistic atmosphere model is the first step in the process .    in simulations",
    ", for each realization of the atmosphere the gpi ao simulator was run with the default unoptimized controller , an optimized gain filter and a kalman filter @xcite . in all simulation comparisons ,",
    "the kalman filter had the greatest residual suppression ( especially at higher orders ) , followed by the optimized filter .",
    "the kalman filter achieved the least improvement for @xmath68 , which is expected behavior when a filter optimized for flow is applied to an atmosphere with higher power in boiling , but was still comparable to or better than an optimized filter .",
    "one example of peak fitter and layer finder output is shown in fig .",
    "[ fig : gpitelem ] .",
    "closed loop residual phase as measured by gpi s wavefront sensor over 22.1 seconds with the system pointed at a bright star and an ao system rate of 1 khz was stored at the date and time indicated on the plot .",
    "using the system s error and noise transfer functions , pseudo - open loop phase is estimated , which is then converted to fourier modes and temporal psds calculated . a psd peak",
    "fitter and layer finder algorithm @xcite identifies and fits wind peaks and then finds wind layers .",
    "the width of each peak sets the magnitude of @xmath1 for that peak ; wider peaks have lower values of @xmath67 , as seen in fig .",
    "[ fig : temp - psd ] .",
    "the temporal frequency of the peak is used to set the phase of @xmath1 per equation [ eqn : alphaphase ] .",
    "[ fig : gpitelem ] plots the temporal psd of a fourier mode ( @xmath90 ) displaying ar model fits to power peaks at 0 hz ( dc , @xmath91 ) and 10.2 hz ( @xmath92 ) .",
    "values of @xmath67 for the other peaks fit range from 0.991 to 0.996 , a characteristic shared by other telemetry sets analyzed which motivates our restriction of @xmath67 values analyzed in ar modeling to the interval @xmath93 $ ] .",
    "two wind layers found have wind velocities of 1.2 m / s and 4.9 m / s ( with no altitude information ) .",
    "only wind peaks which contain significant power ( defined to be greater than 20% of the peak with the highest power content , the d.c .",
    "peak in this case ) are identified and used for wind prediction , _",
    "i.e. _ ones that are worthwhile for the system to correct .",
    "hence , peaks at -2 , -5 and beyond + 20 hz are ignored .",
    "in contrast to the method outlined in @xcite , we have observed no frequency dependence of the decorrelation parameter @xmath1 .",
    "our fits to telemetry indicate that from one time step to the next its magnitude is confined to the interval @xmath93 $ ] which is significantly different from the implied range of @xmath94 $ ] in the prior work .",
    "the process of analyzing telemetry is work in progress , but there is already evidence to suggest that the ar model is a better representation of the power distribution of the atmosphere ( between frozen flow and `` boiling '' components ) than pure kolmogorov frozen flow .",
    "long simulations also need information about the temporal evolution of atmospheric characteristics like power in wind layers , @xmath38 and @xmath89 ( both of which are extracted from the spatial psd of atmospheric telemetry ) .",
    "telemetry collection through individual nights in varied conditions from different sites and its analysis will better inform how to set and evolve atmosphere model parameters in long exposure simulations .",
    "temporal psd of fourier mode @xmath90 for open - loop phase reconstructed from closed - loop residuals as measured by the gemini planet imager ( solid black line ) with the overlaid model fit ( solid red line ) for peaks at dc ( @xmath91 ) and 10.2 hz ( @xmath92 ) . ]",
    "we have implemented , validated , tested and analyzed an autoregressive method for the generation of phase screens with turbulence .",
    "where comparisons can be made , the ar atmosphere technique is 10 - 160 times more efficient in its use of computational resources and memory than sample - based phase translation methods . by raising the limit on simulation length",
    ", it significantly extends the capabilities of existing simulators and allows the testing of longer time - scale corrections .",
    "the method s flexibility allows for the easy incorporation of any desired atmospheric turbulence model and and variation of parameters ( like coherence length and outer scale ) . finally , its simplicity when compared to other worthy attempts at optimization makes it ready for immediate use and adaptation in simulation ( source code in the form of idl and python routines is available on ` github ` ) .",
    "spatial power spectra are as expected ( and can be tweaked based on the turbulence model used  we chose kolmogorov for this exercise ) .",
    "temporal power spectra show ar atmospheres have very different power distributions compared to frozen flow realizations which results in significant differences in psf profiles in simulations .",
    "work is ongoing to relate ar atmospheres to real - world telemetry gathered by multiple ao systems so that the statistics of generated atmospheres ( _ e.g. _ power content , turbulence strength and evolution of parameters like @xmath38 ) are as close as possible as those extracted from observations .",
    "tailored atmosphere models that resemble real conditions will then be used to train kalman filter generators for optimizing fourier wind identification schemes before they are tested on - sky .",
    "the work of ss and arr is funded by the uc lab fees research program grant 12-lf-236852 .",
    "ss wishes to thank erik johansson at the nso for his insight during highly productive discussions about the ar method and jim chiang at slac for the considerable assistance he provided in creating the python version of the ar screen generation code .",
    "the gemini observatory is operated by the association of universities for research in astronomy , inc .",
    ", under a cooperative agreement with the nsf on behalf of the gemini partnership : the national science foundation ( united states ) , the national research council ( canada ) , conicyt ( chile ) , the australian research council ( australia ) , ministrio da cincia , tecnologia e inovao ( brazil ) and ministerio de ciencia , tecnologa y innovacin productiva ( argentina )"
  ],
  "abstract_text": [
    "<S> we present a sample - based , autoregressive ( ar ) method for the generation and time evolution of atmospheric phase screens that is computationally efficient and uses a single parameter per fourier mode to vary the power contained in the frozen flow and stochastic components . </S>",
    "<S> we address limitations of fourier - based methods such as screen periodicity and low spatial frequency power content . </S>",
    "<S> comparisons of adaptive optics ( ao ) simulator performance when fed ar phase screens and translating phase screens reveal significantly elevated residual closed - loop temporal power for small increases in added stochastic content at each time step , thus displaying the importance of properly modeling atmospheric `` boiling '' . </S>",
    "<S> we present preliminary evidence that our model fits to ao telemetry are better reflections of real conditions than the pure frozen flow assumption .    </S>",
    "<S> [ 1]@xmath0 [ 1 ]    99    rudy , a.  r. , srinath , s. , poyneer , l.  a. , ammons , s.  m. , gavel , d.  t. , kupke , r. , dillon , d. , and rockosi , c. , `` progress towards wind predictive control on shaneao : test bench results , '' , 91481z ( 2014 ) .    </S>",
    "<S> poyneer , l.  a. and macintosh , b.  a. , `` optimal fourier control performance and speckle behavior in high - contrast imaging with adaptive optics , '' , 74997514 ( 2006 ) .    </S>",
    "<S> connolly , a.  j. , peterson , j. , jernigan , j.  g. , abel , r. , j.  bankert , c.  c. , claver , c.  f. , gibson , r. , gilmore , d.  k. , grace , e. , jones , r.  l. , ivezic , z. , jee , j. , juric , m. , kahn , s.  m. , krabbendam , v.  l. , krughoff , s. , lorenz , s. , pizagno , j. , rasmussen , a. , todd , n. , tyson , j.  a. , and young , m. , `` simulating the lsst system , '' , 77381o ( 2010 ) .    </S>",
    "<S> wang , l. and ellerbroek , b. , `` computer simulations and real - time control of elt ao systems using graphical processing units , '' , 844723 ( 2012 ) .    </S>",
    "<S> jee , j.  m. and tyson , j.  a. , `` towards precision lsst weak - lensing measurement- i : impacts of atmospheric turbulence and optical aberration '' , pub . </S>",
    "<S> astr . </S>",
    "<S> soc . </S>",
    "<S> pacific * 123 * , 596614 ( 2011 )    mcglamery , b. , `` computer simulation studies of compensation of turbulence degraded images , '' , 225233 ( 1976 ) .    </S>",
    "<S> peterson , j.  r. , jernigan , j.  g. , kahn , s.  m. , rasmussen , a.  p. , peng , e. , ahmad , z. , bankert , j. , chang , c. , claver , c. , gilmore , d.  k. , grace , e. , hannel , m. , hodge , m. , lorenz , s. , lupu , a. , meert , a. , nagarajan , s. , todd , n. , winans , a. and young , m. , `` simulation of astronomical images from optical survey telescopes using a comprehensive photon monte carlo approach , '' suppl . </S>",
    "<S> * 218 * , 14 ( 2015 )    assmat , f. , wilson , r.  w. , and gendron , e. , `` method for simulating infinitely long and non stationary phase screens with optimized memory storage , '' , 988999 ( 2006 ) .    fried , d.  l. and clark , t. , `` extruding kolmogorov - type phase screen ribbons '' , , 463468 ( 2008 )    beghi , a. , cenedese , a. , and masiero , a. , `` multiscale phase screen synthesis based on local principal component analysis '' , , 79878000 ( 2013 )    vorontsov , a.  m. , paramonov , p.  .v . , and valley , m. , `` generation of infinitely - long phase screens for modeling optical wave propagation through turbulence , '' , 589108 ( 2005 ) .    </S>",
    "<S> johansson , e.  m. and gavel , d.  t. , `` simulation of stellar speckle imaging , '' , 372383 ( 1994 ) .    </S>",
    "<S> harding , c.  m. , johnston , r.  a. , and lane , r.  g. , `` fast simulation of a kolmogorov phase screen , '' , 21612170 ( 2003 ) .    </S>",
    "<S> glindemann , a. , lane , r.  g. , and dainty , j.  c. , `` simulation of time - evolving speckle patterns using kolmogorov statistics , '' , 23812388 ( 1993 ) .    </S>",
    "<S> welsh , b.  m. , `` a fourier series based atmospheric phase screen generator for simulating anisoplanatic geometries and temporal evolution , '' , 327338 ( 1997 ) .    </S>",
    "<S> lane , r.  g. , glindemann , a. , and dainty , j.  c. , `` simulation of a kolmogorov phase screen , '' waves in random media * 2 * , 209224 ( 1992 ) .    </S>",
    "<S> sedmak , g. , `` implementation of fast - fourier - transform - based simulations of extra - large atmospheric phase and scintillation screens , '' , 45274538 ( 2004 )    gavel , d. , kupke , r. , dillon , d. , norton , a. , ratliff , c. , cabak , j. , phillips , a. , rockosi , c. , mcgurk , r. , srinath , s. , peck , m. , lanclos , k. , gates , j. , saylor , m. , ward , j. , and pfister , t. `` shaneao : wide science spectrum adaptive optics system for the lick observatory , '' , 914805 ( 2014 )    percival , d.  b. , and walden , a.  t. , _ spectral analysis for physical applications _ ( cambridge university , reprint 1998 )    poyneer , l.  a. , macintosh , b.  a. , and vran , j .- p . </S>",
    "<S> , `` fourier transform wavefront control with adaptive prediction of the atmosphere , '' , 26452660 ( 2007 ) .    fried , d.  l. , `` statistics of a geometric representation of wavefront distortion , '' , 1427-1435 ( 1965 )    frigo , m. , and johnson , s.  g. , `` the design and implementation of fftw3 , '' proc . </S>",
    "<S> ieee * 93 * , 216-231 ( 2005 ) .    </S>",
    "<S> richards , m.  a. , `` the discrete - time fourier transform and discrete fourier transform of windowed stationary white noise , '' ` http://users.ece.gatech.edu/mrichard/dft%20of%20noise.pdf `    tokovinin , t. and travouillon , t. , `` model of optical turbulence profile at cerro pachon '' , mnras * 365 * , 1235 - 1242 ( 2006 )    schneider , m  d. , lawrence livermore national lab , livermore , ca , usa ( personal communication , 2015 )    perrin , m.  d. , sivaramakrishnan , a. , makidon , r.  b. , oppenheimer , b.  r. , and graham , j. , `` the structure of high strehl ratio point - spread functions , '' , 702712 ( 2003 ) .    </S>",
    "<S> poyneer , l.  a. , de  rosa , r.  j. , macintosh , b. , palmer , d.  w. , perrin , m.  d. , sadakuni , n. , savransky , d. , bauman , b. , cardwell , a. , chilcote , j.  k. , dillon , d. , gavel , d. , goodsell , s.  j. , hartung , m. , hibon , p. , rantakyr , f.  t. , thomas , s. , and veran , j - p . , </S>",
    "<S> `` on - sky performance during verification and commissioning of the gemini planet imager s adaptive optics system , '' , 91480k ( 2014 ) .    </S>",
    "<S> roddier , f. , _ adaptive optics in astronomy _ ( cambridge university , 1999 )    poyneer , l.  a. and veran , j - p . </S>",
    "<S> , `` kalman filtering to suppress spurious signals in adaptive optics control , '' , a223a224 ( 2010 ) .    </S>",
    "<S> rudy , a.  r. , poyneer , l.  a. , srinath s. , ammons , s.  m. and gavel d. , `` a laboratory demonstration of an lqg technique for correcting frozen flow turbulence in adaptive optics systems '' , in prep    poyneer , l.  a. , van dam , m.  a. and veran , j - p . </S>",
    "<S> `` experimental verification of the frozen flow atmospheric turbulence assumption with use of astronomical adaptive optics telemetry , '' , 833846 ( 2009 ) </S>"
  ]
}