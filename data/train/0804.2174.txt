{
  "article_text": [
    "image encryption is somehow different from text encryption due to some inherent features of images , such as bulk data capacity and high correlation among pixels .",
    "therefore , digital chaotic ciphers like those in @xcite and traditional cryptographic techniques such as des , idea and rsa are no longer suitable for practical image encryption , especially for real - time communication scenarios .",
    "so far , many chaos - based image cryptosystems have been proposed @xcite .",
    "the major core of these encryption systems consists of one or several chaotic maps serving the purpose of either just encrypting the image or shuffling the image and subsequently encrypting the resulting shuffled image . in @xcite a new image encryption algorithm based on chaotic map lattices has been proposed .",
    "the aim of this paper is to assess the security of such cryptosystem .",
    "the rest of the paper is organized as follows .",
    "section  [ section : description ] describes the cryptosystem introduced in @xcite .",
    "after that , section  [ section : designproblems ] points out some design problems inherent to that cryptosystem , and section  [ section : attacks ] gives some attacks on the cryptosystem under study .",
    "finally , some security enhancements are presented in section  [ section : enhance ] followed by the last section , which presents the conclusions .",
    "the encryption scheme described in @xcite is based on the logistic map given by @xmath0 for a certain value of @xmath1 , the chaotic phase space is @xmath2 $ ] .    given an @xmath3 color image with r , g , b color components , an initialization process is performed to convert the integer values of each pixel to real numbers that can work with the above chaotic logistic map .",
    "first , the 2-d image is scanned in the raster order ( i.e. , from left to right and from top to bottom ) to form three 1-d integer sequences @xmath4 ( @xmath5 ) , where @xmath6 denotes the color component @xmath7 of the @xmath8-th pixel .",
    "then , the integer sequences are converted to three real - number sequences each of which corresponds to a different color component : @xmath9 , where @xmath10 after the above initialization process , the following encryption procedure is carried out separately for each color component to obtain the ciphertext :    1 .",
    "set @xmath11 .",
    "2 .   set the initial condition of the logistic map as follows : @xmath12 [ algorithm : encryption1 ] 3 .",
    "iterate the chaotic logistic map from @xmath13 for @xmath14 times to obtain @xmath15 .",
    "[ algorithm : encryption2 ] 4 .   set @xmath16 .",
    "if @xmath17 , then subtract @xmath18 from @xmath19 to ensure @xmath20 $ ] .",
    "5 .   set @xmath21 .",
    "if @xmath22 , go to step  [ algorithm : encryption1 ] ; otherwise the encryption procedure stops for the current color component .    after performing the above encryption procedure for all three color components , the three sequences @xmath23 , @xmath24 and @xmath25 make up the ciphertext .    as claimed in @xcite , the secret key is composed of the following four sub - keys :    1 .",
    "the control parameter of the logistic map , i.e. , @xmath1 .",
    "2 .   the image height and the image width , i.e. , @xmath26 and @xmath27 respectively .",
    "3 .   the number of chaotic iterations in step  [ algorithm : encryption2 ] , i.e. , @xmath14 .",
    "4 .   the number of cycles , i.e. , @xmath28 .",
    "the decryption procedure is similar to the above description , but in an reverse order , and the following inverse map @xmath29\\label{eq : real2integer}\\ ] ] is used in the last step to recover the plain - image by converting real numbers back to integer pixel values . for more details about the encryption / decryption procedures ,",
    "the reader is referred to @xcite .",
    "following kerckhoffs principle @xcite , the security of a cryptosystem should depend only on its key . for the cryptosystem defined in @xcite ,",
    "the size of the image to be encrypted determines one of its four secret sub - keys . in a known - plaintext attack",
    "we have access to both the plain image and its encrypted version , which means that we know the size of the image .",
    "moreover , in a ciphertext - only attack the value @xmath30 is known and it is possible to get @xmath26 if @xmath27 is known and vice versa .",
    "therefore , it is not a good idea to include the size of the image as part of the key , since it does not increase the difficulty to break the cryptosystem .",
    "in addition , the control parameter @xmath1 of the logistic map is also part of the key . in @xcite @xmath1",
    "is chosen in @xmath31 for the sake of the map defined in eq .",
    "( [ equation : logistic ] ) being always chaotic . however , the bifurcation diagram of the logistic map ( fig .",
    "[ figure : logistic ] ) shows the existence of periodic windows in that interval .",
    "it means that a user could choose @xmath1 such that the logistic map would be working in a non - chaotic area , which is not a good security criterium when considering chaotic cryptosystems ( * ? ? ?",
    "* rule 5 ) .",
    "hence , it is advisable to give a more detailed definition of the possible values of @xmath1 , so that the user can only choose those values of the control parameter @xmath1 preventing the logistic map from showing a periodic behaviour .",
    "finally , the other parts of the key are the number of iterations of the logistic map per pixel ( @xmath14 ) and the number of encryption cycles ( @xmath28 ) . as secret sub - keys",
    ", both values should possess a high level of entropy to avoid being guessed by a possible attacker .",
    "however , it is not advisable to select large values for @xmath28 and @xmath14 , since it will definitely lead to a very slow encryption speed . on the other hand ,",
    "using small values of @xmath28 and @xmath14 reduces the level of security , since those small values do not provide good confusion and diffusion properties .",
    "both restrictions imply a reduction of the associated sub - key space and thus they make the brute - force attack more likely to be successful . as a conclusion ,",
    "it is convenient to use @xmath28 and @xmath14 as design parameters and not as part of the secret key .",
    "this approach has been traditionally followed with respect to the number of encryption rounds in classical schemes such as des or aes .",
    "as it happens during the encryption procedure , all the intermediate values @xmath19 obtained through the decryption stage must be inside the phase space .",
    "this means that @xmath32 should appear in eq .",
    "( 10 ) and ( 11 ) in @xcite instead of @xmath33 .",
    "having in mind this consideration , the performance of the decryption process will be analyzed in the following .",
    "the cryptosystem described in @xcite generates a ciphertext consisting of a number of real values .",
    "all the operations to encrypt an image are performed using floating - point arithmetic . from section  [ section : description ] we know that @xmath16 , where @xmath15 is the resulting value of iterating the logistic map @xmath14 times from @xmath13 .",
    "hence , if we want to recover @xmath34 ( the original value of the @xmath8-th element in the last round ) , we have to iterate @xmath14 times the logistic map from @xmath13 to get @xmath15 and , after that , to substract this value from @xmath19 .",
    "however , the resulting value of this previous operation might not match the actual value of @xmath34 , due to the wobbling precision problem that exists when dealing with floating - point operations @xcite .",
    "this wobbling precision problem also causes the resulting guessed value of @xmath34 to depend on the cryptosystem implementation .",
    "therefore , if an image is encrypted on one platform and decrypted on another , and the implementations of floating - point arithmetics on both platforms are not compatible with each other , then the decrypted image might not match the original one . in @xcite",
    "the cryptosystem was implemented using microsoft visual c # .net 2005 and no comment was given about the wobbling precision problem in the decryption process .",
    "however , we have experimentally verified that this problem indeed exists when the cryptosystem is implemented using matlab .",
    "a very useful measure of the performance of the decryption procedure is the mean square error or mse . for @xmath35 and @xmath36 being a plain image and the decrypted image respectively ,",
    "the mse for the color component @xmath7 is defined as @xmath37 where @xmath30 is the number of pixels of the images considered .",
    "consequently , for a well designed encryption / decryption scheme the mse should be 0 for each color component .",
    "unfortunately , for the cryptosystem under study , the values of mse for all three color components are generally not equal to 0 due to the wobbling precision problem associated to the floating - point arithmetic .    in order to evaluate the underlying decryption error of the cryptosystem defined in @xcite , a @xmath38 plain - image `` lena '' , as shown in fig .",
    "[ figure : lena ] , was encrypted and decrypted using the same key @xmath39 .",
    "the results showed that the three mses obtained for the red , green and blue components of the decrypted image with respect to the original one were 6.49 , 0.018 , 0.057 , respectively . for another key @xmath40 ,",
    "the obtained mses were 206.96 , 123.45 , 58.65 , respectively .",
    "figure  [ fig_error ] shows the decrypted image and the error image when the cryptosystem was implemented in matlab using a third key @xmath41 .",
    "the maximum value of @xmath42 in eq .   is reached when @xmath43 , which informs that the maximum value of a sequence generated from the iteration of the logistic map is @xmath44 , i.e. , @xmath45 .",
    "the ciphertext of the cryptosystem proposed in @xcite is composed of @xmath46 real values , each of which is in the range @xmath2 $ ] .",
    "this means that it is possible to approximate @xmath47 as the maximum value of all the real values in the ciphertext , i.e. , @xmath48 then , from @xmath47 , one can estimate the secret value of the control parameter @xmath1 as @xmath49    consequently , if we have a ciphertext , we can estimate the value of the sub - key @xmath1 .",
    "in other words , a ciphertext - only attack allows us to estimate the sub - key @xmath1 . in this sense ,",
    "the image `` lena '' ( fig .  [ figure : lena ] ) was encrypted for @xmath50 , @xmath51 and different values of @xmath52 $ ] .",
    "these values of @xmath1 were then estimated from the ciphertexts by applying eqs .   and .",
    "the estimation errors are shown in fig .",
    "[ figure : parameterestimationlena ] .",
    "the average estimation error was @xmath53 , whereas the maximum and minimum errors were @xmath54 and @xmath55 , respectively . by increasing the value of @xmath28 from 1 to 3 and keeping the other sub - keys unchanged ,",
    "the parameter estimation errors are shown in fig .",
    "[ figure : parameterestimationlena_2 ] , being the mean estimation error @xmath56 , the minimum error @xmath57 and the maximum error @xmath58 .     and @xmath51 .",
    "]     and @xmath59 . ]    finally , in figs .",
    "[ figure : psnr1 ] and [ figure : psnr2 ] the sensitivity of the cryptosystem with respect to the control parameter @xmath1 is shown .",
    "this sensitivity is measured using the peak signal to noise ratio ( psnr ) , which is defined for the color component @xmath7 as @xmath60    figure  [ figure : psnr1 ] displays the psnrs of the different color components of the decrypted image `` lena '' with respect to the original image `` lena '' for @xmath52 $ ] when the same key is used for encryption and decryption .",
    "the values of the other sub - keys are @xmath50 , @xmath59 . on the other hand",
    ", figure  [ figure : psnr2 ] shows the psnrs when the control parameter used in decryption shows some deviation from that employed in the encryption process .",
    "one can see that for a deviation of the control parameter of less than @xmath61 and for a certain range of values of the control parameter , it is possible to recover the original image `` lena '' with a similar psnr to that obtained using the correct control parameter .",
    "for instance , for @xmath62 the pnsrs for the red , green and blue components of the recovered `` lena '' are @xmath63 , @xmath64 and @xmath65 , respectively .",
    "for the same value of @xmath1 and a parameter estimation error equal to @xmath66 , the psnr of the recovered `` lena '' with respect to the original one is @xmath67 for the red component , @xmath68 for the green and @xmath69 for the blue component .",
    "one important feature of a secure encryption scheme is that the encryption speed should not depend on the key value . indeed ,",
    "if the time consumed on encryption / decryption is correlated with the value of the key ( or a sub - key ) , then it is possible to approximate that ( sub-)key . this kind of attack is called timing attack @xcite . as it has been shown in section  [ section : description ] , in every encryption round , step  [ algorithm : encryption2 ] is carried out through the @xmath14 iterations of eq .",
    ", where @xmath14 is a sub - key .",
    "this means that , for a certain number of encryption rounds ( i.e. , a certain value of @xmath28 ) and a certain value of the control parameter @xmath1 , the encryption speed decreases as @xmath14 does .",
    "similarly , because the encryption / decryption procedure is composed of @xmath28 repeated cycles , the encryption speed will also become slower if the value of @xmath28 increases . to be more precise , for a given plain - image",
    ", we can expect the existence of the following bi - linear relationship between the encryption / decryption time ( edt ) and the values of @xmath14 and @xmath28 : @xmath70 where @xmath7 corresponds to the common operations consumed on each chaotic iteration , @xmath71 to the operations performed in each cycle excluding those about chaotic iterations , and @xmath72 to those operations performed on the initialization process and the postprocessing after all the @xmath28 cycles are completed .",
    "in addition , because @xmath1 is just the control parameter of the chaotic map , it is expected that @xmath73 will be independent of its value .    with the aim of verifying this hypothesis ,",
    "some experiments have been made under the following scenario .",
    "an image with random pixel values of size @xmath74 was encrypted for different values of @xmath1 , @xmath14 and @xmath28 .",
    "the encryption time corresponding to each key is shown in fig .",
    "[ figure : encryptiontime ] , from which one can see that eq .   is verified .",
    "the above experimental results ensure the feasibility of a timing attack to a sub - key of the cryptosystem under study : by observing the encryption time , it is possible to estimate the values of @xmath14 if @xmath28 is known and vice versa . without loss of generality , assuming an attacker eve knows the value of @xmath14 , but not that of @xmath28 , let us demonstrate how the timing attack can be performed in practice . in this case , the relationship between edt and the value of @xmath28 can be simplified as @xmath75 , where @xmath76 and @xmath77 .",
    "then , if eve gets a temporary access to the encryption ( or decryption ) machine , she can carry out a real timing attack in the following steps :    1 .",
    "she observes the whole process of encryption ( or decryption ) to get the encryption ( or decryption ) time @xmath78 and also the size of the ciphertext ( i.e. , the size of the plaintext ) .",
    "2 .   by choosing two keys with different values of @xmath28",
    ", she encrypts a plaintext ( or decrypts a ciphertext ) of the same size and gets @xmath79 and @xmath80 .",
    "she derives the values of @xmath81 and @xmath82 by substituting @xmath79 and @xmath80 into @xmath75 .",
    "4 .   she estimates the value of @xmath28 to be @xmath83 . 5 .",
    "she verifies the estimated value @xmath84 by using it to decrypt the observed ciphertext .",
    "if the recovered plaintext is something meaningful , the attack stops ; otherwise , she turns to search the correct value of @xmath28 in a small neighborhood of @xmath84 until a meaningful plaintext is obtained .",
    "the above timing attack actually reveals that partial knowledge about the key constitutes useful information to determine the rest of the key .",
    "however , such a problem should not exist for a well - designed cryptosystem ( * ? ? ?",
    "* rule  7 ) .",
    "hence , we reach the conclusion that the cryptosystem proposed in @xcite was not well designed .    finally , it deserves being mentioned that the linear relationship between the encryption / decryption time and the value of @xmath28 has been implicitly shown in ( * ? ? ?",
    "* table  i ) . there",
    ", for an image of size @xmath85 and @xmath28 equal to @xmath86 , @xmath87 and @xmath88 , the encryption times were observed to be @xmath89 , @xmath90 and @xmath91 seconds , respectively .",
    "this clearly showed a linear relationship between the encryption time and the value of @xmath28 .",
    "unfortunately , the authors of @xcite did not realize that this is a security defect that could be used to develop the timing attack reported in this paper .",
    "to overcome the problems of the original cryptosystem , we propose to enhance it by applying the following rules :    * use a piecewise linear chaotic map ( pwlcm ) @xcite instead of the logistic map for the size of the chaotic phase space being independent with respect to the control parameter value . indeed , the chaotic phase space of the pwlcm is ( 0,1 ) for all the values of the control parameter .",
    "the pwlcm also has a uniform invariant probability distribution function , which makes impossible to estimate the control parameter through the maximum value of the ciphertext , as we can do for the cryptosystem under study . *",
    "the wobbling precision problem should be circumvented by forcing fixed - point computations .",
    "a possible solution is to transform the values of the phase space of the chaotic map into integer values , so the encryption and decryption operations are carried out using integer numbers instead of real numbers . * without loss of security , the enhanced cryptosystem should be easy to implement with acceptable cost and speed ( * ? ? ?",
    "* rule  3 ) .",
    "it is expected that the enhanced cryptosystem can encrypt at least a pixel per iteration to reach high encryption / decryption speed . *",
    "the key of the enhanced cryptosystem should be precisely defined ( * ? ? ?",
    "* rule  4 ) , and the key space from which valid keys are chosen should be precisely specified and avoid non - chaotic regions ( * ? ? ?",
    "* rule  5 ) . this can be assured by choosing the control parameter(s ) of a pwlcm as the secret key , because for every valid control parameter , the behavior of the pwlcm is chaotic .",
    "* having in mind today s computer speed , the key space size should be @xmath92 in order to elude brute - force attacks ( * ? ? ?",
    "* rule  15 ) . in the encryption scheme defined in @xcite",
    "every color component is encrypted independently from the other color components . nevertheless , the secret key employed in the encryption process of each color component is the same .",
    "it is convenient to use a different value of the key for each color component and make the encryption of the three color components dependent on each other , since this implies a considerable increase of the key space .",
    "it has been tested that the sensitivity of the pwlcm with respect to the control parameter is around @xmath61 . therefore ,",
    "when the control parameter is used as the key of the cryptosystem , the size of the key space will be @xmath93 .",
    "nonetheless , if we use a different value of @xmath94 for every color component , and the encryption of each color component depends on the others , the size of the key space will be @xmath95 , which satisfies the security requirement related to the resistance against brute - force attacks .",
    "in this paper , some problems of a new image encryption scheme based on chaotic map lattices are reported and two attacks on this cryptosystem have been presented . to overcome these problems and weaknesses , we have introduced some countermeasures to enhance the cryptosystem by following the cryptographical rules listed in @xcite .",
    "the work described in this paper was partially supported by _ ministerio de educacin y ciencia of spain _ , research grant seg2004 - 02418 and _ ministerio de ciencia y tecnologa _ of spain , research grant tsi2007 - 62657 .",
    "shujun li was supported by a research fellowship from the _ alexander von humboldt foundation , germany_.                              p.  c. kocher , `` timing attacks on implementations of diffie - hellman , rsa , dss , and other systems , '' advances in cryptology ",
    "crypto96 , vol .",
    "1109 of _ lecture notes in computer science _ , 104113 ( 1996 ) ."
  ],
  "abstract_text": [
    "<S> this paper reports a detailed cryptanalysis of a recently proposed encryption scheme based on the logistic map . </S>",
    "<S> some problems are emphasized concerning the key space definition and the implementation of the cryptosystem using floating - point operations . </S>",
    "<S> it is also shown how it is possible to reduce considerably the key space through a ciphertext - only attack . moreover </S>",
    "<S> , a timing attack allows the estimation of part of the key due to the existent relationship between this part of the key and the encryption / decryption time . as a result </S>",
    "<S> , the main features of the cryptosystem do not satisfy the demands of secure communications . </S>",
    "<S> some hints are offered to improve the cryptosystem under study according to those requirements .    * </S>",
    "<S> *    recently a new cryptosystem was proposed by using a chaotic map lattice ( cml ) . in this paper , we analyze the security of this cryptosystem and point out some of its security defects . </S>",
    "<S> a number of measures have been suggested to enhance the security of the cryptosystem following some established guidelines on how to design good cryptosystems with chaos . </S>"
  ]
}