{
  "article_text": [
    "the work reported in this paper has two motivations , one theoretical and the other practical .",
    "the former is the recent introduction of _ well groups _ in the study of mappings @xmath3 between topological spaces . assuming a metric space of perturbations , we have such a group for each subspace @xmath4 , each bound @xmath5 on the magnitude of the perturbation , and each homological dimension @xmath6 .",
    "these groups , and the diagrams that they generate , extend the boolean concept of transversality to a real - valued measure we refer to as _",
    "robustness_. using this measure , we can quantify the robustness of a fixed point of a mapping @xcite and prove the stability of the apparent contour of a mapping from an orientable @xmath7-manifold to @xmath8 @xcite . in this paper , we contribute to the general understanding of well groups by studying the real - valued case .",
    "along the way , we also extend the general theory of well groups to incorporate relative well groups . specifically ,    1 .",
    "we give a general definition of relative well groups given a mapping @xmath3 , a number @xmath5 , and a nested pair @xmath9 of subspaces of @xmath10 , and 2 .",
    "we characterize the relative well groups of @xmath0 whenever @xmath11 is an interval and @xmath12 is a subset of the endpoints .",
    "applications of this theoretical work are anticipated in medical imaging and scientific visualization , where data in the form of real - valued functions is common .",
    "to mention one example , it is common to acquire information about internal organs through a magnetic resonance image , which results in a @xmath13-dimensional array of intensity values , best viewed as a function from the unit cube to the real line .",
    "the predominant method for highlighting or extracting relevant substructures of this image uses preimages of real values .",
    "generically , these are @xmath7-manifolds , commonly referred to as _ contours _ or _ isosurfaces _ @xcite . sometimes , these @xmath7-manifolds are complemented by preimages of intervals , referred to as _ interval volumes _ in visualization @xcite . in this paper",
    ", we call the preimage of a value a _ level set _ , and the preimage of an interval an _ interlevel set _ , in which the interval can be closed , open , or half - open .",
    "we contribute to the state - of - the - art by    1 .   explaining how the homology of level and interlevel sets can be read off the extended persistence diagram of the function , and 2 .   describing how the robustness of features in level and interlevel sets , quantified through well groups ,",
    "can be read off the same diagram .",
    "our results add up to a ` point calculus ' in algebraic topology for mining the rich homological information contained in the extended persistence diagram of a real - valued function .",
    "the compactness of the data representation and the efficiency of the mining operations make the diagram an attractive graphical interface tool for studying @xmath13-dimensional images .",
    "we view this tool as complementary to the contour spectra described in @xcite , which plot continuously varying quantities , such as area and volume , across the family of level sets .",
    "the most novel aspect of our diagram is the robustness information , which has previously not been available .",
    "this novelty is combined with the unprecedented ease with which homological information is accessible .",
    "there is also evidence for the practicality of the interface provided by the fast oct - tree implementation of the described concepts @xcite , which has been used to study @xmath13-dimensional images of root systems of agricultural plants .",
    "[ [ outline . ] ] outline .",
    "+ + + + + + + +    in section [ sec2 ] , we review necessary background on persistence , zigzag modules , and well groups . in section [ sec3 ]",
    ", we explain the point calculus for interlevel sets . in section [ sec4 ] ,",
    "we extend the point calculus to include the robustness information provided by the well groups .",
    "finally , section [ sec5 ] concludes the paper with a brief discussion of the contributions and of future research directions .",
    "we divide the background material into three parts , introducing persistence and extended persistence in section [ sec21 ] , explaining the extension to zigzag modules and level set pyramids in section [ sec22 ] , and defining absolute and relative well groups in section [ sec23 ] .",
    "traditional persistent homology is based on a nested sequence of spaces , which induces a linear sequence of homology groups connected by maps from left to right .",
    "we describe this concept in two steps .",
    "[ [ persistence . ] ] persistence .",
    "+ + + + + + + + + + + +    the persistence of homology classes along a filtration of a topological space can be defined in a quite general context @xcite . for this paper , we need only a particular type of filtration , one defined by the sublevel sets of a tame function .",
    "given a real - valued function @xmath1 on a compact topological space @xmath14 , we consider the filtration of @xmath14 via the _ sublevel sets _",
    "@xmath15 $ ] , for all real values @xmath16 .",
    "whenever @xmath17 , the inclusion @xmath18 induces maps on the homology groups @xmath19 , for each dimension @xmath6 . here",
    "we will use field coefficients so that the homology groups are torsion - free and are therefore vector spaces over the field . often we will suppress the homological dimension from our notation , writing @xmath20",
    "; in this case , we will always assume that all maps @xmath21 decompose into the direct sum of maps on each factor .",
    "a real value @xmath16 is called a _ homological regular value _ of @xmath1 if there exists @xmath22 such that the inclusion @xmath23 induces an isomorphism between homology groups for every @xmath24 .",
    "if @xmath16 is not a homological regular value , then it is a _ homological critical value_. we say that @xmath1 is _ tame _ if it has finitely many homological critical values and if the homology groups of each sublevel set have finite rank . assuming that @xmath1 is tame",
    ", we enumerate its homological critical values @xmath25 . choosing @xmath26 homological regular values",
    "@xmath27 such that @xmath28 , we put @xmath29 .",
    "the inclusions @xmath30 induce maps @xmath31 for @xmath32 and give the following filtration : @xmath33 we say a class @xmath34 is _ born _ at @xmath35 if @xmath36 . a class @xmath37 born at @xmath35",
    "is said to _ die entering _",
    "@xmath38 if @xmath39 but @xmath40 . we remark that if a class @xmath37 is born at @xmath35 , then every class in the coset @xmath41 = \\alpha + { { \\ifmmode{\\rm im\\,}\\else{\\mbox{\\(\\rm im\\,\\)}}\\fi}{{{\\ifmmode{\\sf f}\\else{\\mbox{\\(\\sf f\\)}}\\fi}}^{i-1,i}}}$ ] is born at the same time .",
    "of course , whenever such an @xmath37 dies entering @xmath38 , the entire coset @xmath41 $ ] also dies with it .",
    "we represent @xmath41 $ ] graphically as the point @xmath42 in the plane .",
    "drawing all birth - death pairs as points , we get diagrams like the ones sketched in figures [ fig : subdiagrams ] and [ fig : twopants ] .    supposing that @xmath43 is different from all homological critical values , we collect all points in the upper - left quadrant defined by @xmath44 to get all classes born before @xmath45 and still alive",
    "; see the left diagram in figure [ fig : subdiagrams ] .",
    "their number is the rank of the homology group of the sublevel set , @xmath46 .",
    "observe that we really need the extended plane to draw the points because some classes get born but never die , so the corresponding points have @xmath47 as their second coordinates .",
    "there is an elegant way around this minor annoyance , which we now describe .",
    "[ [ extended - persistence . ] ] extended persistence .",
    "+ + + + + + + + + + + + + + + + + + + + +    since the filtration in ( [ eqn : persfilt ] ) begins with the zero group but ends with a potentially nonzero group , it is possible to have classes that are born but never die .",
    "we call these _ essential _ classes , as they represent the actual homology of the space @xmath14 . to measure the persistence of the essential classes , we follow @xcite and extend the sequence in ( [ eqn : persfilt ] ) using relative homology groups .",
    "more precisely , we consider for each @xmath48 the _ superlevel set _ @xmath49 .",
    "note that we have @xmath50 and @xmath51 by compactness . for @xmath52 ,",
    "the inclusion @xmath53 induces a map on relative homology @xmath54 .",
    "these maps therefore give rise to the following extended filtration : @xmath55 we extend the notions of birth and death in the obvious way .",
    "since this filtration begins and ends with the zero group , all classes eventually die .",
    "we also extend the graphical representation of the information contained by forming _",
    "persistence diagrams _ , which we now introduce more formally .",
    "we have such a diagram for each dimension @xmath6 ; see figure [ fig : subdiagrams ] .",
    "each diagram is a multiset of points in the plane , containing one point @xmath56 for each coset of classes that is born at @xmath35 or @xmath57 , and dies entering @xmath38 or @xmath58 . in some circumstances , it is convenient to add the points on the diagonal to the diagram , but in this paper , we will refrain from doing so .",
    "the persistence diagram contains three important subdiagrams , corresponding to three different combinations of birth and death location . the _ ordinary subdiagram _ ,",
    "@xmath59 , represents classes that are born and die during the first half of ( [ eqn : extpersfilt ] ) .",
    "the _ relative subdiagram _ , @xmath60 , represents classes that are born and die during the second half .",
    "finally , the _ extended subdiagram _ ,",
    "@xmath61 , represents classes that are born during the first half and die during the second half of the extended filtration .",
    "note that points in @xmath59 all lie above the main diagonal while points in @xmath60 all lie below . on the other hand",
    ", @xmath61 may contain points on either side of the main diagonal .",
    "by @xmath62 , we mean the points of all diagrams in all dimensions .",
    "drawing these subdiagrams side by side can be cumbersome , and drawing them on top of each other can be confusing . in section [ sec3 ] , we will introduce a new design that addresses these concerns .",
    "we note that the homology groups in the extended filtration of ( [ eqn : extpersfilt ] ) , or in the shorter filtration of ( [ eqn : persfilt ] ) , are all vector spaces over a fixed field and that the maps between them are all linear maps . in @xcite ,",
    "carlsson and de silva generalize this situation to sequences of vector spaces that are connected by maps going from left to right or from right to left .",
    "we now briefly review their work as well as the related work on level set zigzag modules in @xcite .",
    "[ [ zigzag - modules . ] ] zigzag modules .",
    "+ + + + + + + + + + + + + + +    a _ zigzag module _",
    "@xmath63 is a finite sequence of vector spaces connected by linear maps which either go forward or backward between consecutive spaces : @xmath64 if the arrow advances from @xmath65 to @xmath66 , then we denote the corresponding linear map as @xmath67 ; otherwise , we write @xmath68 .",
    "a _ submodule _",
    "@xmath69 of @xmath63 is a collection of linear subspaces @xmath70 such that @xmath71 or @xmath72 , whichever is the case for @xmath73 .",
    "a submodule @xmath69 is a _ summand _ if there is a complementary submodule @xmath74 , meaning every vector space splits as a direct sum @xmath75 .",
    "the authors in @xcite prove that every zigzag module can be split into indecomposable summands of a certain form , and , in particular , it has a basis , a concept we now describe .",
    "first , we suppose that we have , for each @xmath73 , a set of elements @xmath76 such that the nonzero elements form a basis of @xmath65 . in other words",
    ", we can decompose @xmath65 into the direct sum @xmath77 , noting that some of the terms on the right hand side may be zero .",
    "we use the superscripts to form correspondences between the bases .",
    "specifically , we require @xmath78 , or @xmath79 , depending on the case .",
    "furthermore , we assume that , for each superscript @xmath48 , there exist @xmath80 such that @xmath81 iff @xmath82 $ ] . in other words , for each fixed @xmath48 , we have a submodule @xmath83 of @xmath63 in which the non - zero vector spaces are @xmath84-dimensional and form a single contiguous subsequence connected by identity maps .",
    "calling such a submodule an _ interval module _ , we think of it as being in correspondence with the closed interval @xmath85 $ ] . the collection @xmath86 is a _ basis _ for the zigzag module if @xmath63 can be decomposed into the direct sum of the interval modules ( [ zz : interval ] ) .",
    "equivalently , the collection is a basis for @xmath63 if each map @xmath87 is the direct sum of the maps @xmath88 , and each map @xmath89 is the direct sum of the maps @xmath90 , whichever one is defined .",
    "although a zigzag module @xmath63 can have many different bases , the set of intervals associated to any such basis will be unique @xcite .",
    "for example , any basis for the zigzag module given by the filtration in ( [ eqn : persfilt ] ) will have one interval @xmath85 $ ] for each coset of classes born at @xmath91 and dying entering @xmath92 .",
    "[ [ mayer - vietoris - diamonds . ] ] mayer - vietoris diamonds .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    we are interested in an elementary operation that connects two minimally different zigzag modules : a _ mayer - vietoris diamond_. we suppose that we have two zigzag modules differing only at position @xmath73 , and that at this position we have a diamond of the following form : @xmath93{{{\\ifmmode{\\sf h}\\else{\\mbox{\\(\\sf h\\)}}\\fi}}({{\\ifmmode{{\\mathbb v}}\\else{\\mbox{\\({\\mathbb v}\\)}}\\fi}},{{\\ifmmode{{\\mathbb v}}\\else{\\mbox{\\({\\mathbb v}\\)}}\\fi } } ' ) }                                    \\\\",
    "\\node    { { \\longleftrightarrow}{{\\ifmmode{\\sf h}\\else{\\mbox{\\(\\sf h\\)}}\\fi}}({{\\ifmmode{{\\mathbb",
    "c}}\\else{\\mbox{\\({\\mathbb c}\\)}}\\fi}},{{\\ifmmode{{\\mathbb c}}\\else{\\mbox{\\({\\mathbb c}\\)}}\\fi } } ' ) }     \\arrow{ne , t}{a_{j-1 } }                               \\node[2]{{{\\ifmmode{\\sf h}\\else{\\mbox{\\(\\sf h\\)}}\\fi}}({{\\ifmmode{{\\mathbb d}}\\else{\\mbox{\\({\\mathbb d}\\)}}\\fi}},{{\\ifmmode{{\\mathbb d}}\\else{\\mbox{\\({\\mathbb d}\\)}}\\fi } } ' ) { \\longleftrightarrow } }     \\arrow{nw , t}{b_j }          \\\\          \\node[2]{{{\\ifmmode{\\sf h}\\else{\\mbox{\\(\\sf h\\)}}\\fi}}({{\\ifmmode{{\\mathbb e}}\\else{\\mbox{\\({\\mathbb e}\\)}}\\fi}},{{\\ifmmode{{\\mathbb e}}\\else{\\mbox{\\({\\mathbb e}\\)}}\\fi } } ' ) }          \\arrow{ne , t}{a_j}\\arrow{nw , t}{b_{j-1 } }      \\end{diagram } ,      \\label{zz : diamond}\\ ] ] where we show the more general , relative form in which the primed spaces are subspaces of the corresponding unprimed ones , and we have @xmath94 , @xmath95 , @xmath96 , and @xmath97 .",
    "we get the more special , absolute form by setting @xmath98 .",
    "the name of the diamond is justified by the long exact sequence we get by reading the diamond from bottom to top and iterating through the dimensions .",
    "when the primed spaces are all empty , this gives the classic version of the mayer - vietoris sequence , and more generally , we get the relative version : @xmath99 see e.g.  @xcite .",
    "importantly , this sequence is exact , which means that the image of each map equals the kernel of the next map .",
    "such diamonds arise in the following context .",
    "consider again the function @xmath0 and the interleaved sequence of homological regular and critical values : @xmath100 .",
    "setting @xmath101 and @xmath102)$ ] , we get a zigzag module of length @xmath103 , which , following @xcite , we refer to as the _ level set zigzag _ of @xmath1 .",
    "it starts and ends with @xmath104 and alternates between advancing maps @xmath105 and backward maps @xmath106 . from this module",
    ", we can create a new one by fixing an index @xmath73 , substituting @xmath107 = [ s_j , s_{j+1 } ] { { \\ ; \\cup \\;}}[s_{j+1 } , s_{j+2}]$ ] for @xmath108 { { \\ ; \\cap \\;}}[s_{j+1 } , s_{j+2}]$ ] , and leaving all other groups unchanged ; of course we also reverse the two maps involving the changed space .",
    "this produces a new zigzag module which differs from the old via a mayer - vietoris diamond .",
    "this construction can be generalized by flipping between intersections and unions of larger intervals and pairs of intervals , thus producing a whole array of zigzag modules which differ via mayer - vietoris diamonds .",
    "[ [ the - pyramid . ] ] the pyramid .",
    "+ + + + + + + + + + + +    starting with the level set zigzag , we get an array of zigzag modules which are best described as monotonic paths that go diagonally up and down , always from left to right . the array of such paths is connected within a pyramidal structure , which we now describe . as a graphical guide , we consider the square drawn in figure [ fig : pyramid-1 ] .",
    "we give it a coordinate system by parameterizing the downward slope from @xmath47 at the upper left , to @xmath109 in the middle , and back up to @xmath47 at the lower right .",
    "similarly , we parameterize the upward slope from @xmath109 at the lower left , to @xmath47 in the middle , and back to @xmath109 at the upper right .",
    "the two slopes divide the square into four triangular regions , each containing a point with coordinates @xmath110 and @xmath45 for every choice of @xmath111 .",
    "we interpret this point differently in each of the regions . to explain this interpretation , it is convenient to introduce a shorthand that uses open set notation for pairs of closed sets , writing @xmath112 for @xmath113 . specifically , @xmath114   & = &   ( f^{-1}(-\\infty , y ] , f^{-1}(-\\infty , x ] ) , \\\\    f^{-1 } [ x , y )   & = &   ( f^{-1}[x , \\infty ) , f^{-1}[y , \\infty ) ) , \\\\",
    "f^{-1 } ( x , y )   & = &   ( f^{-1}(-\\infty,\\infty ) , f^{-1}(-\\infty , x ] { { \\ ; \\cup \\;}}f^{-1 } [ y,\\infty ) ) .\\end{aligned}\\ ] ]    if a point with coordinates @xmath115 and @xmath116 lies in the bottom region , we think of it as the space @xmath117 $ ] .",
    "however , if the point lies in the left , right , or top region , we think of it as @xmath118 $ ] , @xmath119 , or @xmath120 , respectively .",
    "if we now take @xmath121 and consider the points @xmath122 , @xmath123 , @xmath124 , and @xmath125 , we get a mayer - vietoris diamond in each region ; see figure [ fig : pyramid-1 ] .",
    "this is easiest to see in the closed interval case since @xmath85 = [ w , y ] { { \\ ; \\cap \\;}}[x , z]$ ] and @xmath126 = [ w , y ] { { \\ ; \\cup \\;}}[x , z]$ ] . in the closed - open case",
    ", we have @xmath127 and @xmath128 as well as @xmath129 and @xmath130 .",
    "similar computations verify the diamond in the remaining two cases .    by repeated application of the diamond",
    ", we can generate any monotonic path from the one along the bottom edge of the square .",
    "each path is thus decorated by spaces as described , and applying the homology functor gives a zigzag module of absolute and relative homology groups .",
    "the latter arise when we move the left or right end of the path , which can be done without the mayer - vietoris diamond because the corresponding spaces are and stay empty so that the module remains unchanged . besides the level set zigzag along the bottom edge",
    ", we are particularly interested in the path along the upward slope , which translates into the extended filtration of ( [ eqn : extpersfilt ] ) .",
    "its midpoint is @xmath131 , the center of the square , which results in @xmath132 .",
    "for this reason , we think of the center as the apex of a pyramid , as viewed from above .    as a partial justification for the notation with open sets , we mention that the homology group of the preimage of the interval @xmath124 , if computed with infinite chains , is isomorphic to the relative homology group of @xmath133 , f^{-1 } ( x ) { { \\ ; \\cup \\;}}f^{-1 } ( y))$ ] . by excision , this is isomorphic to the relative homology group of @xmath134 , f^{-1 } ( -\\infty , x ] { { \\ ; \\cup \\;}}f^{-1 } [ y , \\infty))$ ] .",
    "the reader who wishes to learn how to read the homology of interlevel sets can safely skip section [ sec23 ] and now continue with section [ sec3 ] .",
    "however , to differentiate the robust from the non - robust homological information in these readings , we need to first understand the subgroups of homology that give meaning to this concept .    [ [ well - groups . ] ] well groups .",
    "+ + + + + + + + + + + +    suppose that we have a continuous mapping @xmath3 between topological spaces .",
    "given a subset @xmath4 , we review here the definition of the well groups @xmath135 for each radius @xmath5 .",
    "when @xmath11 is clear from context , we will drop it from the notation and simply write @xmath136 , by which we mean the direct sum of groups @xmath137 , for each homological dimension @xmath6 .",
    "we will also need the assumption that @xmath138 has homology groups of finite rank in each dimension .",
    "in addition to the mapping @xmath1 , we assume a subspace @xmath139 of @xmath140 the space of continuous mappings from @xmath14 to @xmath10 , requiring that @xmath139 contains @xmath1 .",
    "for example , @xmath139 might consist of all mappings homotopic to @xmath1 .",
    "we assume a metric on @xmath139 and write @xmath141 for the distance between two mappings .",
    "we call @xmath142 an",
    "_ @xmath16-perturbation _ of @xmath1 if @xmath143 .",
    "given @xmath4 , we introduce the _ radius function _ , @xmath144 , by setting @xmath145 to the infimum value of @xmath16 for which there exists an @xmath16-perturbation @xmath146 with @xmath147 .",
    "we filter @xmath14 via the sublevel sets of the radius function , setting @xmath148 $ ] . for @xmath149",
    "there is a map @xmath150 .",
    "the preimage of @xmath11 under any @xmath16-perturbation @xmath142 of @xmath1 will obviously be a subset of @xmath151 , and hence there is a map on homology , @xmath152 . given a class @xmath153 and an @xmath16-perturbation @xmath142 of @xmath1 , we say that @xmath37 is _ supported _ by @xmath142 if @xmath154 . the _ well group _",
    "@xmath155 is then defined @xcite to consist of the classes that are supported by all @xmath16-perturbations of @xmath1 : @xmath156 for @xmath17 , the map @xmath157 restricts to a map @xmath158 . on the other hand",
    ", @xmath159 contains @xmath160 as a subgroup .",
    "it can be shown that @xmath161 whenever @xmath17 ; see @xcite .",
    "in other words , the rank of the well group can only decrease as the threshold value increases .",
    "we call a value of @xmath16 at which the rank of the well group decreases a _ terminal critical value _ of @xmath162 . the _ well diagram _ of @xmath1 and @xmath11 is the multiset of terminal critical values of @xmath162 , taking a value @xmath163 times if the rank of the well group drops by @xmath163 at the value",
    ". often we will refer to this diagram as the _ robustness _ of the preimage @xmath138 . in this paper",
    ", we focus on the case @xmath164 and @xmath165 , lifting the usual metric on @xmath166 to @xmath139 by defining @xmath167 . in this case",
    ", the radius function satisfies @xmath168 . in general , the relationship between the terminal critical values and the homological critical values of @xmath162 is not completely understood .",
    "however , if @xmath164 and @xmath11 is a point , we will see that the former is a subset of the latter .",
    "we get more complicated relationships when @xmath11 is an interval .",
    "[ [ example . ] ] example .",
    "+ + + + + + + +    consider the torus @xmath14 , as shown in figure [ fig : twopants ] , along with the vertical height function @xmath0 and the space @xmath169 .",
    "the preimage of @xmath11 , @xmath170 , consists of two disjoint circles on the torus ; hence there are two components and two independent @xmath84-cycles , all belonging to the well group at radius @xmath104 . for small values of @xmath16",
    ", @xmath171 consists of two disjoint cylinders .",
    "the homology has yet to change ; furthermore , although the proof will come later , all classes still belong to the well groups at these small radii .    now consider the value of @xmath16 shown in figure [ fig : twopants ] . for this @xmath16 ,",
    "the sublevel set @xmath172 consists of two pair - of - pants glued together along two common circles .",
    "we note that @xmath173 has dropped in rank by one , while the rank of @xmath174 has grown to three .",
    "in contrast , the rank of @xmath175 is less than or equal to one .",
    "indeed , the function @xmath176 , defined by @xmath177 , is an @xmath16-perturbation of @xmath1 and the zero set of the corresponding distance function , @xmath178 , is a single closed curve . since the rank of the first homology group of that curve is one , and",
    "since the rank of @xmath179 can be no bigger than this rank , the well group @xmath180 can also have rank at most one . that it does in fact have rank",
    "exactly one will follow from our results in section [ sec4 ] .",
    "[ [ relative - well - groups . ] ] relative well groups .",
    "+ + + + + + + + + + + + + + + + + + + + +    since the pyramid involves relative homology groups , it seems wise to extend the definition of well groups into the context of relative homology . while this notion is new , it follows the above ideas closely so that presenting the definition in this background section seems appropriate .",
    "assume again that we have a continuous mapping @xmath3 between topological spaces , as well as a subspace @xmath139 of @xmath181 that contains @xmath1 and is equipped with a metric .",
    "given a nested pair @xmath9 of subspaces of @xmath10 , and a radius @xmath5 , we note that @xmath182 is a subset of @xmath172 . for each @xmath16-perturbation @xmath142 of @xmath1",
    ", there is an inclusion of pairs @xmath183 which induces a map @xmath184 between relative homology groups .",
    "the _ relative well group _",
    "@xmath185 is defined to be the intersection of the images of these maps , taken over all @xmath16-perturbations of @xmath1 : @xmath186 when a distinction is needed , we will refer to the previous notion of well groups as _ absolute _ well groups .",
    "in this section , we present the first half of our point calculus , showing how to read the homology of a level or interlevel set from the extended persistence diagram .",
    "the crucial technical concept is that of a basis of the pyramid of zigzag modules , which we establish by strengthening the pyramid theorem in @xcite .    [",
    "[ flipping - a - basis . ] ] flipping a basis .",
    "+ + + + + + + + + + + + + + + + +    we construct a basis for the pyramid one step at a time , by flipping the basis of one zigzag module to the next . for this purpose , we consider two zigzag modules that differ at one position , and we assume that there is a mayer - vietoris diamond serving as a connecting bridge between the two modules at that position . drawing the diamond with the intersection at the bottom and the union at the top , as in ( [ zz : diamond ] )",
    ", we say the diamond connects the _ lower _ module with the _ upper _ module .",
    "given a basis of the lower module , we can show that we can construct a basis of the upper module so that the two bases agree on the overlap .",
    "we refer to this operation as _ flipping _ the first basis to the second .",
    "given two zigzag modules that differ by a single mayer - vietoris diamond , we can flip any basis of the lower module to a basis of the upper module .",
    "we give a proof by construction .",
    "writing @xmath187 for the basis of the lower zigzag module , we describe a basis @xmath188 of the upper zigzag module that differs from the lower one only at the position @xmath73 at which the modules differ ; as in ( [ zz : diamond ] ) .",
    "we thus at once set @xmath189 for all @xmath190 , and the main task is then the construction of the @xmath191 . put briefly",
    ", our rule will be that @xmath192 iff an odd number of @xmath193 , @xmath194 , @xmath195 are non - zero .",
    "we give more specifics via a case analysis .",
    "the cases are labelled pictorially , with black dots denoting non - zero classes , showing only the positions @xmath196 .",
    "case 1 ( ): : :    we have @xmath197 and    @xmath198 , and define @xmath191 as    well as the advancing map using the mayer - vietoris diamond , namely    @xmath199 , which is non - zero by    exactness and because @xmath200 .",
    "case 2 ( ): : :    again we set @xmath201 which is zero    by exactness and because @xmath202 .",
    "case 3 ( ): : :    we set @xmath203 ,    which in this case is non - zero . indeed ,",
    "if it were zero , then , by    exactness , the pair @xmath204 would be in the image    of the map @xmath205 . by the direct - sum    decomposition of the maps in the basis",
    ", this would imply that    @xmath206 , a contradiction .",
    "case 4 ( ): : :    we have @xmath202 and    @xmath207 . if there are    @xmath208 indices @xmath48 of this kind , then    the orthogonal complement to the image of the map @xmath209 ,    defined below , has rank @xmath210 , as we prove shortly .",
    "we    pick @xmath210 classes @xmath191 that span this    complement . since @xmath191 maps to @xmath194 via    the connecting homomorphism of the mayer - vietoris sequence , the    homological dimension of @xmath191 is one higher than that    of @xmath194 . case 5 ( ): : :    this is symmetric to case 2 , and we set    @xmath211 . case 6 ( ): : :    this is symmetric to case 1 , and we set    @xmath212 .",
    "note first that we now have interval modules @xmath213 in the lower zigzag module , and interval modules @xmath214 in the upper zigzag module . to show that the latter are indeed summands",
    ", we only need to verify that the non - zero classes @xmath191 form a basis of @xmath215 , the new group in the upper zigzag module . using the notation in ( [ zz : diamond ] ) , we let @xmath216 denote the vector space spanned by the pairs @xmath217 , noting that @xmath216 is a subspace of @xmath218 , but because of case 3 it is not necessarily the entire direct sum . we consider the subspaces @xmath219 of @xmath216 spanned by the pairs @xmath217 in each case @xmath220 , for @xmath221 .",
    "these subspaces are independent and span the entire space @xmath216 . in other words , zero is the only element common to any two of the subspaces , and the ranks of the subspaces add up to the rank of @xmath216 .",
    "the case analysis suggests a map @xmath222 with @xmath223 , if @xmath224 , and zero otherwise .",
    "since @xmath225 , this map is zero on @xmath226 , but it is also zero on @xmath227 and @xmath228 .",
    "furthermore , @xmath209 is injective when restricted to @xmath229 , @xmath230 , and @xmath231 .",
    "we proceed to show that the images of these latter three vector spaces under @xmath209 are independent of one another . to derive a contradiction",
    ", we first suppose that @xmath232 contains a non - zero class",
    ". then there must exist @xmath233 and @xmath234 with @xmath235 .",
    "hence , @xmath236 , which , by exactness , tells us that @xmath237 . but",
    "this contradicts the direct - sum decomposition of the map @xmath238 .",
    "next , suppose that @xmath239 contains a non - zero class , which means there exists @xmath233 and @xmath240 such that @xmath235 . as above , this implies that @xmath236 , and we reach the same contradiction .",
    "finally , a symmetric argument gives @xmath241 .",
    "we conclude that @xmath242 , @xmath243 , and @xmath244 are independent subspaces of @xmath215 . in case 4",
    ", we picked a basis for the orthogonal complement to their span ; all together , we have a basis of @xmath215 , as required .    [",
    "[ establishing - a - basis . ] ] establishing a basis .",
    "+ + + + + + + + + + + + + + + + + + + + +    the pyramid theorem in @xcite establishes an explicit bijection between the interval modules that arise in the decomposition of any two zigzags within the pyramid .",
    "we strengthen this result by establishing bases on all the zigzag modules in such a way that the basis elements correspond to the intervals and respect the same bijections .",
    "we call this a _ basis _ of the pyramid . to construct it",
    ", we note that the paths in the pyramid are connected by mayer - vietoris diamonds .",
    "we can therefore flip a basis of the level set zigzag upwards through the entire pyramid via repeated application of the basis flip lemma .    a basis of the level set zigzag module extends to a basis of the entire pyramid .",
    "we now give an explicit description of how the interval modules of the various paths in the pyramid relate to each other .",
    "a convenient reference in this description is the extended filtration ( [ eqn : extpersfilt ] ) , which follows the upward slope through the middle of the pyramid .",
    "its first half is parameterized from @xmath245 to @xmath47 , and its second half from @xmath47 back to @xmath245 .",
    "let now @xmath115 and @xmath116 be two points along the upward slope , with @xmath115 to the left of @xmath116 .",
    "we distinguish between the ordinary case ( @xmath246 , both in the first half ) , the relative case ( @xmath247 , both in the second half ) , and the two extended cases ( @xmath246 and @xmath247 , with @xmath115 in the first half and @xmath116 in the second half ) . for each case",
    ", we sketch how the basis element of the interval corresponds to basis elements of other homology groups in figure [ fig : transformation ] .    as a general pattern ,",
    "the two points trace out two curves consisting of segments with slopes @xmath248 that reflect before they hit the vertical sides and end at the horizontal sides of the square . the reason for the slopes are cases 1 , 2 , 5 , and 6 in the proof of the basis flip lemma , and the reason for the reflection is the local change in the zigzag structure caused by moving the terminal zero group up .",
    "the two curves cross at one point inside the square , and the location of that point is characteristic for the case ( the triangular region on the left in the ordinary case , at the top and at the bottom in the two extended cases , and on the right in the relative case ) .",
    "the crossing is caused by case 4 , in which the correspondence between the basis elements is constructed via the connecting homomorphism of the mayer - vietoris sequence and therefore comes with a shift in homological dimension .",
    "[ [ turning - the - table .",
    "] ] turning the table .",
    "+ + + + + + + + + + + + + + + + + +    the regions in figure [ fig : transformation ] show all the spaces represented by points in the pyramid to which the basis element corresponding to the interval @xmath85 $ ] is relevant .",
    "we are now interested in the inverse question : which basis elements are relevant to a given space ? more specifically : which intervals in the decomposition of the extended filtration ( [ eqn : extpersfilt ] ) map to the basis of the homology group of the space represented by a point with coordinates @xmath110 and @xmath45 ?",
    "we answer this question by considering the following subregions of the @xmath6-dimensional persistence diagram : @xmath249   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ord}\\else{\\mbox{\\(\\rm ord\\)}}\\fi}_{p}{({f } ) } } \\mid x <",
    "b < y \\ }                       \\sqcup   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{p}{({f } ) } } \\mid x < b , a < y \\ } , \\\\    { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p}}}[a , b ]   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{p}{({f } ) } } \\mid b < x , y < a \\ }                        \\sqcup   \\ { ( x , y ) \\in { { \\ifmmode{\\rm rel}\\else{\\mbox{\\(\\rm rel\\)}}\\fi}_{p}{({f } ) } } \\mid y < a < x \\ } , \\\\    { { \\ifmmode{\\lambda}\\else{\\mbox{\\(\\lambda\\)}}\\fi}_{{p}}}[a , b )   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{p}{({f } ) } } \\mid a < y < b \\ }                       \\sqcup   \\ { ( x , y ) \\in { { \\ifmmode{\\rm rel}\\else{\\mbox{\\(\\rm rel\\)}}\\fi}_{p}{({f } ) } } \\mid a < y < b < x \\ } , \\\\    { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p}}}[a , b )   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm rel}\\else{\\mbox{\\(\\rm rel\\)}}\\fi}_{p}{({f } ) } } \\mid y < a < x < b\\ } , \\\\    { { \\ifmmode{\\lambda}\\else{\\mbox{\\(\\lambda\\)}}\\fi}_{{p}}}(a , b ]   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ord}\\else{\\mbox{\\(\\rm ord\\)}}\\fi}_{p}{({f } ) } } \\mid x < a < y < b \\ } , \\\\    { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p}}}(a , b ]   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ord}\\else{\\mbox{\\(\\rm ord\\)}}\\fi}_{p}{({f } ) } } \\mid a < x < b < y\\ }                       \\sqcup   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{p}{({f } ) } } \\mid a < x < b \\ } , \\\\    { { \\ifmmode{\\lambda}\\else{\\mbox{\\(\\lambda\\)}}\\fi}_{{p}}}(a , b )   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ord}\\else{\\mbox{\\(\\rm ord\\)}}\\fi}_{p}{({f } ) } } \\mid x < a < y \\ }",
    "\\sqcup   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{p}{({f } ) } } \\mid x < a , b < y \\ } , \\\\    { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p}}}(a , b )   & = &   \\ { ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{p}{({f } ) } } \\mid a < x , y < b \\ }",
    "\\sqcup   \\ { ( x , y ) \\in { { \\ifmmode{\\rm rel}\\else{\\mbox{\\(\\rm rel\\)}}\\fi}_{p}{({f } ) } } \\mid y < b < x \\},\\end{aligned}\\ ] ] where we assume that @xmath110 and @xmath45 are both homological regular values .",
    "these multisets are displayed in figure [ fig : four - homology ] in which we have also introduced a new , and for our purposes more convenient , way of drawing the extended persistence diagram .",
    "we have glued the domains of the three sub - diagrams and drawn the result as a right - angled triangle . in this triangle ,",
    "the birth and death axes go from @xmath245 up to @xmath250 and then continue on back to @xmath245 . in other words , we flip the extended subdiagram upside down and glue its ( formerly ) upper side to the upper side of the ordinary subdiagram . similarly , we rotate the relative subdiagram by @xmath251 degrees and glue its ( formerly ) right side to the right side of the ( flipped ) extended subdiagram .",
    "after gluing the three domains , we rotate the design by @xmath252 degrees so the triangle rests on its longest side , consisting of the diagonals in the ordinary and relative subdiagrams .",
    "the diagonal of the extended subdiagram is now the vertical symmetry axis passing through the middle of the triangle .",
    "there is a straightforward translation of this triangular design to the representation of persistence advocated in @xcite .",
    "namely , draw a isosceles right - angled triangle downward from each point in the multiset and call the horizontal lower edge the corresponding _ bar_. the _ barcode _ is the multiset of bars , one for each point in the diagram .",
    "similarly , we can translate the triangular design into the square design of the pyramid by cutting along the vertical axis , turning the right triangle upside - down , and gluing the two triangles along their hypotenuses .",
    "[ [ reading - interlevel - sets . ] ] reading interlevel sets .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    the purpose of the multisets defined above is to offer a convenient way to read the absolute or relative homology of an interlevel set from the extended persistence diagram .",
    "we need some definitions to combine all four types into one .",
    "first , we let @xmath253 be the collection of interval modules in the decomposition of the extended filtration ( [ eqn : extpersfilt ] ) .",
    "as mentioned earlier , this collection is in bijective correspondence with the points in @xmath62 .",
    "we write @xmath254 for the abstract vector space spanned by @xmath253 , and we let @xmath255 be the collection of vector spaces spanned by subsets of this basis .",
    "second , we write @xmath256    \\sqcup { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p+1 } } } [ a , b ]   &   \\mbox{\\rm if~ } i = [ a , b ] , \\\\",
    "{ { \\ifmmode{\\lambda}\\else{\\mbox{\\(\\lambda\\)}}\\fi}_{{p } } } [ a , b )    \\sqcup { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p+1 } } } [ a , b )   &   \\mbox{\\rm if~ } i = [ a , b ) , \\\\      { { \\ifmmode{\\lambda}\\else{\\mbox{\\(\\lambda\\)}}\\fi}_{{p-1 } } } ( a , b ] \\sqcup { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p } } } ( a , b ]   &   \\mbox{\\rm if~ } i = ( a , b ] , \\\\      { { \\ifmmode{\\lambda}\\else{\\mbox{\\(\\lambda\\)}}\\fi}_{{p-1 } } } ( a , b ) \\sqcup { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p } } } ( a , b )   &   \\mbox{\\rm if~ } i = ( a , b ) ,    \\end{array } \\right.\\end{aligned}\\ ] ] for the region of points in the persistence diagram that correspond to the basis elements of @xmath257 , and call it a _ pair of wings_. with these concepts , we have the following result , which implies that the rank of @xmath257 is the number of points in @xmath258 :    for each dimension @xmath6 and each interval @xmath259 whose endpoints are homological regular values , there exists an isomorphism that takes @xmath257 to the vector space @xmath260 spanned by the basis vectors corresponding to the points in @xmath261 .",
    "write @xmath262 and let @xmath263 be the basis of the group @xmath264 , where @xmath259 is an interval with endpoints @xmath111 that can be closed , closed - open , open - closed , or open .",
    "the claimed isomorphism is then the linear map @xmath265 defined by @xmath266 for all non - zero @xmath267 .    to understand why the image of @xmath268 consists of the intervals that correspond to the points in @xmath258",
    ", we need to recall the transformation rules sketched in figure [ fig : transformation ] .",
    "consider for example the closed interval case , @xmath269 $ ] , for which @xmath270 \\sqcup { { \\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{p+1 } } } [ a , b]$ ] .",
    "since the interval is closed , the homology group is represented by the point @xmath271 in the lower triangular region . to lie in the dark shaded region ,",
    "this point must satisfy the constraint @xmath272 in the ordinary case , @xmath273 and @xmath274 in the first extended case , and @xmath273 and @xmath274 without dimension shift in the second extended case .",
    "these inequalities define @xmath275 $ ] . furthermore , we get @xmath276 and @xmath277 with dimension shift in the second extended case , and @xmath278 , again with dimension shift , in the relative case .",
    "these inequalities define @xmath279 $ ] , which completes the proof in the closed case . for",
    "a proof of the closed - open , open - closed , and open cases , note that the points representing @xmath257 are found in the right , left , and top triangular region of the pyramid , and then argue in a similar fashion .",
    "the definition of well group given in section [ sec2 ] involves an uncountable number of perturbations , which give rise to the intersection of a potentially large number of subgroups , and as such does not seem amenable to computation . in this section ,",
    "we show that the situation in the real - valued case is simpler , and that we are able to read the absolute and relative well groups directly from the extended persistence diagram .",
    "we begin with a consequence of the mayer - vietoris sequence , which provides the main technical ingredient of our proofs .",
    "[ [ a - corollary - of - mayer - vietoris . ] ] a corollary of mayer - vietoris .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for convenience , we establish the following notational convention , wherein we reuse the same letter in different fonts .",
    "we will need it for absolute and for relative homology groups . to avoid repetition , we state it now for the more general relative case . letting @xmath280 and @xmath281 be pairs of topological spaces , we write @xmath282 if @xmath283 and @xmath284 .",
    "this inclusion of pairs induces a map @xmath285 on homology groups , and we write @xmath286 for the image of this map .",
    "note that @xmath69 is always a subgroup of @xmath215 , namely the subgroup of homology classes that have a chain representative carried by @xmath287 .",
    "note also that the rank of @xmath69 can never exceed the rank of @xmath215 .",
    "suppose that , furthermore , @xmath288 .",
    "then , from the sequence of maps @xmath289 , we see that @xmath290 , the image of @xmath291 in @xmath215 , must be a subgroup of @xmath69 .",
    "the following lemma is a direct consequence of the exactness of the mayer - vietoris sequence .",
    "however , we will use it often enough that it seems reasonable to state and prove it formally .",
    "suppose the pair of topological spaces @xmath281 can be decomposed as @xmath96 and @xmath97 , where @xmath292 and @xmath293 .",
    "set @xmath294 .",
    "if a class @xmath295 belongs to @xmath296 and to @xmath297 , then @xmath37 also belongs to @xmath216 .",
    "following our convention , we use the notation @xmath298 for the map on homology induced by the inclusion of @xmath299 in @xmath300 .",
    "similarly , we write @xmath301 and @xmath302 , as well as @xmath303 and @xmath304 . note that @xmath305 , @xmath306 , and @xmath307 .",
    "consider now the relevant portion of the mayer - vietoris sequence for @xmath300 : @xmath308 by assumption , @xmath309 , so there exists some @xmath310 such that @xmath311 .",
    "similarly , there exists an @xmath312 such that @xmath313 .",
    "this implies that the pair @xmath314 belongs to the kernel of @xmath315 , and thus also , by exactness of the sequence , belongs to the image of @xmath316 .",
    "hence , there exists @xmath317 with @xmath318 and @xmath319 .",
    "in particular , since @xmath320 , we have @xmath321 , and therefore @xmath322 as claimed .    in the typical application of the mayer - vietoris lemma",
    ", we will construct further pairs @xmath323 and @xmath324 such that @xmath325 . from the remark above , we know that @xmath326 and @xmath327 .",
    "the lemma then applies and we can conclude that @xmath322 , as before .",
    "[ [ the - well - group - of - a - level - set . ] ] the well group of a level set .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as a warm - up exercise , we first consider the case in which @xmath11 is a single point .",
    "more specifically , we suppose that we have a compact topological space @xmath14 and a function @xmath0 , and we find the well groups @xmath328 , where @xmath169 is some point on the real line . in this case , @xmath329   = f^{-1 } [ a - r , a+r ] $ ] . to state the formula , we distinguish two particular subspaces of @xmath172 , namely the _ top level set _ , @xmath330 , and the _ bottom level set _ , @xmath331 .",
    "using the convention from before , we write @xmath332 and @xmath333 for the images of @xmath334 and @xmath335 in @xmath336 .",
    "@xmath337 , for every @xmath5 .    proof .",
    "we prove equality by establishing the two inclusions in turn .",
    "to show @xmath338 , consider an arbitrary class @xmath339 .",
    "we define @xmath340 and @xmath341 and note that they are @xmath16-perturbations of @xmath1 , with @xmath342 and @xmath343 . by definition of the well group ,",
    "@xmath37 is supported by every @xmath16-perturbation of @xmath1 , and therefore by @xmath344 and by @xmath345 .",
    "it follows that @xmath346 . to show @xmath347",
    ", we consider an arbitrary class @xmath346 and let @xmath142 be an arbitrary @xmath16-perturbation of @xmath1 .",
    "to finish the proof , we need to show that @xmath37 is supported by @xmath142 . we define @xmath348 and @xmath349 { { \\ ; \\cap \\;}}{{\\ifmmode{{\\mathbb x}}\\else{\\mbox{\\({\\mathbb x}\\)}}\\fi}}_r$ ]",
    ". note that @xmath350 while @xmath351 .",
    "furthermore , the inequality @xmath352 implies that @xmath353 and @xmath354 . by the mayer - vietoris lemma ,",
    "@xmath37 is supported by @xmath355 , as required .",
    "the point formula implies that the well group for a morse function @xmath1 can change only at critical values of the function @xmath162 , where @xmath169 . in other words , terminal critical values",
    "are , in this simple context , just ordinary critical values . indeed ,",
    "if @xmath356 $ ] is an interval that contains no critical values of @xmath162 , then there is a deformation retraction @xmath357 providing an isomorphism @xmath358 .",
    "furthermore , this retraction maps @xmath359 onto @xmath360 , in such a way that that the images of @xmath334 and @xmath361 in @xmath159 are identical .",
    "similarly , the images of @xmath335 and @xmath362 in @xmath159 are identical . hence the well groups @xmath136 and @xmath160 are isomorphic .    [ [ the - well - group - of - an - interlevel - set . ] ] the well group of an interlevel set",
    ". + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +      the pairs @xmath371 and @xmath372 include into @xmath373 in all four cases . still using the notational convention from above",
    ", we write @xmath332 and @xmath333 for the images of @xmath374 and @xmath375 in @xmath376 .",
    "the formula for the well group , @xmath377 , is then , unsurprisingly :    @xmath337 , for every @xmath5 .",
    "we give the argument for the most complicated of the four cases , when @xmath378 .",
    "the proofs of the other three cases are simpler versions of the same argument .",
    "we may assume @xmath379 , else @xmath380 , which implies that all groups in the claimed formula are zero and so we are done . to prove the inclusion @xmath338",
    ", we consider the two @xmath16-perturbations @xmath340 and @xmath341 , as before .",
    "note that @xmath381 and @xmath382 , and the desired inclusion follows from the definition of relative well groups . to prove @xmath347 , we choose an arbitrary class @xmath346 and an @xmath16-perturbation @xmath142 of @xmath1 .",
    "furthermore , we introduce the following pairs of subspaces : @xmath383 ,         \\\\     { { \\ifmmode{{\\mathbb c}}\\else{\\mbox{\\({\\mathbb c}\\)}}\\fi}}_r ' & = &   ( h^{-1 } [ a,\\infty ) { { \\ ; \\cap \\;}}f^{-1 } ( -\\infty , a+r ] ) { { \\ ; \\cup \\;}}(h^{-1 } [ b,\\infty ) { { \\ ; \\cap \\;}}f^{-1 } ( -\\infty , b+r ] ) ,         \\\\     { { \\ifmmode{{\\mathbb d}}\\else{\\mbox{\\({\\mathbb d}\\)}}\\fi}}_r   & = &    h^{-1 } ( -\\infty , b ] { { \\ ; \\cap \\;}}f^{-1 } [ a - r,\\infty ) ,          \\\\     { { \\ifmmode{{\\mathbb d}}\\else{\\mbox{\\({\\mathbb d}\\)}}\\fi}}_r ' & = &   ( h^{-1 } ( -\\infty , a ] { { \\ ; \\cap \\;}}f^{-1 } [ a - r,\\infty ) ) { { \\ ; \\cup \\;}}(h^{-1 } ( -\\infty , b ] { { \\ ; \\cap \\;}}f^{-1 } [ b - r,\\infty ) ) ;   \\end{aligned}\\ ] ] see figure [ fig : open - interval ] for a depiction of the open case .",
    "since @xmath142 is an @xmath16-perturbation , we have @xmath384 and similarly @xmath385 .",
    "this implies @xmath386 and @xmath387 , and therefore @xmath388 .",
    "it is easy to see that @xmath389 , and also that @xmath390 .",
    "the mayer - vietoris lemma thus implies @xmath391 .",
    "since this is true for all @xmath16-perturbations @xmath142 , we have @xmath339 , as required .    [ [ including - intervals . ] ] including intervals .",
    "+ + + + + + + + + + + + + + + + + + + +    we again need some definitions to unify the four cases into one .",
    "given two intervals @xmath259 and @xmath392 of the same type , we say @xmath259 _ includes _ into @xmath392 , denoted as @xmath393 , if @xmath394 includes as a pair in @xmath395 . unfolding",
    "the definition of the four types and assuming @xmath396 , we have @xmath397 \\hookrightarrow [ a , d]$ ] , @xmath398 , @xmath399 \\hookrightarrow ( b , d]$ ] , and @xmath400 ; compare this with the mayer - vietoris diamonds in figure [ fig : pyramid-1 ] .",
    "suppose now that we have intervals @xmath393 , both of the same type . by the interlevel set lemma , there are isomorphisms that take @xmath257 and @xmath401 to groups @xmath402 and @xmath403 in @xmath404 .",
    "the inclusion induces a map on homology , which composes with these isomorphisms to give @xmath405 . on the other hand ,",
    "since the two groups are members of @xmath404 , there is also a natural map from @xmath402 to @xmath403 , namely the one that restricts to the identity on the span of their shared vectors and is zero otherwise .",
    "not surprisingly , @xmath406 is exactly that map .",
    "we formalize this claim and give a proof .",
    "let @xmath393 and let @xmath402 , @xmath403 be the corresponding @xmath6-dimensional groups in @xmath404 .",
    "then the image of @xmath405 is a vector space in @xmath404 , and its basis is in bijection with the multiset @xmath407",
    ".    proof .   to restate the lemma",
    ", we consider the diagram defined by the homology groups of the preimages of the including intervals , @xmath393 , and the corresponding vector spaces in @xmath404 : @xmath408 the vertical maps are isomorphisms given by the interlevel set lemma .",
    "the map @xmath409 is induced by inclusion , and @xmath406 maps a basis vector of @xmath402 to the same basis vector of @xmath403 , if it exists , and to zero , otherwise .",
    "hence , the basis of @xmath410 consists of the vectors that are common to the bases of @xmath402 and @xmath403 .",
    "this lemma states that we can get @xmath406 by composing @xmath409 with the two isomorphisms .",
    "equivalently , the diagram commutes . to prove commutativity",
    ", we consider again the zigzag modules drawn as monotonic paths in the square ; see figure [ fig : pyramid-1 ] .",
    "since @xmath393 , we can find two non - crossing modules , one containing @xmath257 and the other containing @xmath401 .",
    "to get a basis for @xmath411 , we translate intervals from one path to the other , keeping only the ones that cover both @xmath257 and @xmath401 . further translating these intervals to the hypotenuse gives the corresponding points in the persistence diagram .",
    "these points are precisely the ones shared by @xmath258 and @xmath412 .",
    "in other words , @xmath410 in @xmath404 is isomorphic to @xmath411 , as desired .    [",
    "[ reading - robustness . ] ] reading robustness .",
    "+ + + + + + + + + + + + + + + + + + +    the image lemma allows us to compute the well groups and the well diagram associated to a single interval , @xmath413 .",
    "the homology of @xmath394 can be read off the persistence diagram of @xmath1 , as stated in the interlevel set lemma .",
    "similarly , the homology of @xmath373 , where @xmath414 and @xmath415 , can be read off the same diagram , as we now explain . by the interval formula , the well group for @xmath16 is the intersection of the images of the maps @xmath416 and @xmath417 induced by the inclusions . by the image lemma , this intersection corresponds to a pair of rectangles within the region of @xmath394 ; see the intersection between @xmath258 and the dotted rectangles in figure [ fig : four - robustness ] .    in the closed case , this intersection gradually recedes to infinity , while in the two half - open cases",
    ", the intersection disappears when @xmath16 reaches half the length of the interval .",
    "correspondingly , the well group shrinks gradually in the closed case , while it vanishes at or before @xmath418 in the half - open cases .",
    "similarly , the well group vanishes when @xmath16 reaches @xmath419 in the open case .",
    "however , here it vanishes abruptly .",
    "more precisely , the range of the maps @xmath420 and @xmath421 , which is @xmath422 , approaches the homology group of the suspension of the level set at @xmath423 , when @xmath16 goes toward @xmath419 , before it suddenly becomes zero when @xmath16 reaches that limit .    in all four cases , a point contributes to the well group until @xmath16 reaches a value at which the shrinking intersection no longer contains the point . finding this value of @xmath16 is easy since both rectangles shrink uniformly along all of their sides .",
    "consider for example the case @xmath269 $ ] illustrated by the upper left design in figure [ fig : four - robustness ] . for a point @xmath424 ,",
    "the value of @xmath16 at which the point drops out of the relevant region is @xmath425 , \\\\",
    "\\min \\{b - x , y - a \\ } & \\mbox{\\rm if } & ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{}{({f } ) } } { { \\ ; \\cap \\;}}{{\\ifmmode{\\lambda}\\else{\\mbox{\\(\\lambda\\)}}\\fi}_{{}}}[a , b ] ,",
    "\\\\    \\min \\{x - b , a - y \\ } & \\mbox{\\rm if } & ( x , y ) \\in { { \\ifmmode{\\rm ext}\\else{\\mbox{\\(\\rm ext\\)}}\\fi}_{}{({f } ) } } { { \\ ; \\cap \\;}}{{\\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{}}}[a , b ] , \\\\    \\min \\ { x - a , a - y \\ }   & \\mbox{\\rm if } &   ( x , y ) \\in { { \\ifmmode{\\rm rel}\\else{\\mbox{\\(\\rm rel\\)}}\\fi}_{}{({f } ) } } { { \\ ; \\cap \\;}}{{\\ifmmode{\\varrho}\\else{\\mbox{\\(\\varrho\\)}}\\fi}_{{}}}[a , b].\\end{aligned}\\ ] ] the well diagram is the multiset of the values we get from the points in the persistence diagram .",
    "[ [ measuring - the - difference . ] ] measuring the difference .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    we can interpret the rank of the well group as a measure of the similarity between the image of the map @xmath426 and the image of the map @xmath427 .",
    "alternatively , we could use the cokernels of these two maps to measure their difference .",
    "indeed , it is not difficult to prove counterparts of the image lemma for cokernels as well as for kernels .",
    "let @xmath393 and let @xmath402 , @xmath403 be the corresponding @xmath6-dimensional groups in @xmath404 .",
    "then the kernel and cokernel of @xmath405 are vector spaces in @xmath404 , the basis of @xmath428 is in bijection with @xmath429 , and the basis of @xmath430 is in bijection with @xmath431 .    to measure the difference , we would therefore take the ( algebraic ) sum of the two cokernels .",
    "consider for example the open case . by the above lemma",
    ", we get a basis of @xmath432 and @xmath433 by setting @xmath434 and first setting @xmath259 to @xmath435 and second to @xmath436 .",
    "the basis of the sum , @xmath437 , is in bijection with the union of the two multisets of points , which is @xmath438 .",
    "the main contribution of this paper is the introduction of the point calculus for homology computations of level and interlevel sets .",
    "this comprises interlevel sets defined by closed , half - open , and open intervals , images , kernels , and cokernels of maps induced by inclusions , and the robustness of homology as defined by well groups .",
    "the point calculus provides a compact interface to a wealth of homological information that can be useful to researchers with and without background in algebraic topology . for the expert",
    ", it provides a compact summary of information that may be used to formulate conjectures about the topology of spaces and of functions . for the non - expert ,",
    "the interface offers an intuitive approach to understand the topology of datasets that by - passes the introduction of algebraic topology foundations .",
    "it is directly applicable to data in the form of continuous functions , which is common in medical imaging and in scientific visualization .",
    "we conclude by formulating an open question aimed at casting light on two- and higher - dimensional notions of robustness .",
    "this paper provides a solution to computing robustness when @xmath164 and perturbations are measured using the @xmath439-metric , and @xcite shows that our results also hold for a broader class of metric function spaces . in @xcite ,",
    "the authors give an algorithm when @xmath14 is an orientable @xmath7-manifold , @xmath440 , and @xmath11 is a point .",
    "algorithms for other cases are not yet known .",
    "the authors thank vin de silva for many helpful technical discussions leading to a strengthening of this paper .                    persistent homology",
    " a survey .",
    "_ surveys on discrete and computational geometry .",
    "twenty years later _ , eds .",
    "j.  e.  goodman , j.  pach and r.  pollack , contemporary mathematics * 453 * , 257282 , amer .",
    "soc . , providence , rhode island , 2008 .",
    "the stability of the apparent contour of an orientable @xmath7-manifold . in _ topological methods in data analysis and visualization _ , 2742 , eds .  v.  pascucci , x.  tricoche , h.  hagen and j.  tierny , springer - verlag , heidelberg , germany , 2011 ."
  ],
  "abstract_text": [
    "<S> given a function @xmath0 on a topological space , we consider the preimages of intervals and their homology groups and show how to read the ranks of these groups from the extended persistence diagram of @xmath1 . in addition , we quantify the robustness of the homology classes under perturbations of @xmath1 using well groups , and we show how to read the ranks of these groups from the same extended persistence diagram . </S>",
    "<S> the special case @xmath2 has ramifications in the fields of medical imaging and scientific visualization . </S>"
  ]
}