{
  "article_text": [
    "transition path sampling ( tps ) is a versatile and efficient set of computational techniques for the study of rare events.@xcite it has been successfully used to reveal the microscopic mechanisms of processes as diverse as autoionization in liquid water @xcite , structural transformations in nanocrystalline solids @xcite , and folding of small proteins.@xcite the purpose of this paper is to propose a new shooting algorithm which can greatly increase the efficiency of tps when transit times of activated trajectories greatly exceed the picosecond time scale of phase space stability .    at its core",
    "tps is a monte carlo procedure enabling a random walk in the ensemble of pathways that cross a free energy barrier between two metastable states ( denoted a and b ) .",
    "while this sampling is strongly biased towards reactive trajectories , it leaves the underlying dynamics of the system unchanged .",
    "thus , the result of a tps simulation is a representative set of true dynamical pathways , weighted as if they were excerpted from an extremely long , unbiased simulation of equilibrium dynamics .",
    "many analytical tools have been developed to extract from such a collection of trajectories useful molecular information about the process of interest.@xcite    the algorithm typically used to construct such a random walk is called _ shooting _",
    "@xcite . here",
    ", a point along a given reactive trajectory is randomly selected and slightly changed ; for instance , one might change the velocities of all particles by a small random number drawn from a symmetric distribution . using the dynamical rules of the system , this _ shooting point _ is then propagated forward and backward in time to obtain a complete new trajectory .",
    "if this new trajectory still connects a with b it is accepted and used as a basis for the next shooting move ; otherwise it is rejected .",
    "the efficiency of this algorithm in exploring the transition path ensemble is based on a balance between the intrinsic instability of complex dynamical systems and the local character of the shooting move : small disturbances grow exponentially quickly in time , leading to separation of trajectories typically within a few picoseconds .",
    "nonetheless , if the disturbance is small , the new trajectory will be locally similar to the old one and is therefore likely to surmount the barrier between a and b ; such shooting moves will be accepted frequently . just as with conventional monte",
    "carlo moves in configuration space , maximum efficiency can often be obtained by adjusting the size of the disturbance to achieve an acceptance probability of roughly 40% .",
    "@xcite    shooting moves are best suited for the study of systems that relax quickly ( within the picosecond time scale of trajectory separation ) into their product state after reaching the top of the barrier .",
    "many interesting processes , like the nucleation of first order phase transitions or conformational change in complex molecules , proceed much more slowly from the transition state . in tps simulations of such systems , shooting moves must be made extraordinarily subtle in order to stand a reasonable chance of connecting reactant and product states . as a matter of practice ,",
    "however , disturbances can not be made arbitrarily small due to the limited machine precision of floating point numbers .",
    "lacking an ability to control the degree of global separation between trajectories , tps methods are severely compromised in efficacy .",
    "the demonstrated computational advantages of importance sampling in trajectory space lose appeal when offset by the wasted effort of generating a vast excess of non - reactive paths .    in a recent paper@xcite",
    ", bolhuis addressed this problem by modifying slightly the rules that propagate a system in time .",
    "specifically , a weak stochastic component was added to the dynamics , removing the unique correspondence between a trajectory s past and its future .",
    "it thus became possible to resample only parts of an existing pathway , leading to much higher acceptance probabilities for shooting moves and , bolhuis reports , significant improvement in sampling efficiency.@xcite    in this paper , we show that it is possible to perform productive shooting moves for arbitrarily long transition paths without modifying a system s natural dynamics .",
    "our technique for introducing and propagating extraordinarily small disturbances is based on the simple dynamics of small perturbations in phase space .",
    "we explain the method and offer a straightforward algorithm for implementation in sec .",
    "[ sec : method ] .",
    "use of the technique is demonstrated in sec .",
    "[ sec : isom ] for a simple isomerization process in a dense liquid that , by construction , involves diffusive dynamics on a rugged barrier . in sec .",
    "[ sec : meta ] we examine limitations of the method by considering reactive dynamics that pass through highly metastable , obligatory intermediate states .",
    "distance @xmath0 , in reduced units , between two particles in a liquid of 108 soft spheres@xcite as a function of time along a reference trajectory and four shooting trajectories .",
    "at time zero , displacements of various size are added to particle velocities in the reference trajectory . because phase space disturbances grow exponentially in time , decreasing the shooting displacement by successive orders of magnitude results in only linear increase in the time that elapses before trajectories separate .",
    "shooting displacements smaller than @xmath1 can not be resolved in double precision ; the resulting shooting trajectories will exactly retrace the initial one.,scaledwidth=40.0% ]    in a tps simulation of a system evolving with deterministic dynamics , a trajectory @xmath2 of length @xmath3 consists of a number of `` snapshots '' @xmath4 , which are separated by a time step @xmath5 , @xmath6 here , the time slices @xmath4 are full phase space vectors , detailing the positions and velocities of all particles .",
    "subsequent time slices are related by @xmath7 where the function @xmath8 propagates the system for one time step .",
    "consider now a shooting move , in which a small disturbance @xmath9 is added to the shooting point @xmath10 to obtain state @xmath11 of the shooting trajectory @xmath12 .",
    "( to simplify notation , we will assume the shooting point to be @xmath10 , the initial state of the trajectory , throughout this section .",
    "the algorithm we will describe applies transparently to shooting points at any chosen time along the trajectory . )",
    "usually the perturbation @xmath9 affects only momentum space , but changing the positions of the particles can be useful in some cases @xcite .",
    "the perturbed point @xmath13 is then propagated for a number of @xmath14 time steps to obtain @xmath15 , where @xmath16 and @xmath17 refers to the @xmath14-fold application of the time step propagator .",
    "we define the time - evolved disturbance @xmath18 by subtracting the old trajectory from the new one , @xmath19 . due to the dynamic instability of the system , perturbations grow exponentially in time , @xmath20 here , @xmath21 is the largest lyapunov exponent of the system.@xcite for typical fluid systems , @xmath22 .",
    "we wish to control precisely the time it takes for a small perturbation to reach a size of order 1 , at which point the new trajectory will be essentially separated from the old one .",
    "this time determines the probability that the new trajectory will be reactive and therefore acceptable . because of subsequent exponential growth",
    ", @xmath23 must be decreased by many orders of magnitude to increase the separation time of trajectories by even a few picoseconds ( see figs .",
    "[ diverge_fig ] and [ expgrow_fig ] ) . with the standard double precision format for representing floating point numbers on a computer , however , the smallest number that can be added to 1.0 to give a result distinguishable from 1.0 is of the order of @xmath1 , and numerical results become unreliable at values of @xmath24 well above this limit .",
    "( we assume throughout this paper that a system of units has been chosen such that typical numerical values of coordinates and momenta are of order 1 . )",
    "especially when the total length of the transition path is significantly longer than a few picoseconds , the limited range of practical displacement sizes constitutes a severe sampling problem : shooting moves will only be accepted from points in the vicinity of the barrier top ; otherwise , new trajectories will simply return to the stable state they came from and be rejected .",
    "as the system may stay near the _ a priori _ unknown barrier top only for a small fraction of the total transition time , sampling can break down completely . in these cases , implementing shooting displacements of arbitrarily small size would be very helpful .     time evolution of small displacements @xmath18 in a liquid of 108 soft spheres@xcite for disturbances of various sizes , @xmath25 ( legend values indicate values of @xmath26 ) . all displacements grow exponentially with the same rate , up to the time where trajectories separate",
    "the maximum possible value of @xmath27 is determined by the dimensions of the simulation box .",
    "note that adjacent lines are equidistant in the linear regime , except for displacement sizes smaller than @xmath28 .",
    "although these smallest displacements yield trajectories that can in practice be distinguished from the base trajectory , limited numerical precision introduces rounding errors that degrade computational estimates of linear divergence.,scaledwidth=40.0% ]       time evolution of shooting moves from a point @xmath10 on the reference trajectory @xmath2 .",
    "the two shooting displacements @xmath29 and @xmath30 , as vectors in high - dimensional phase space , point in the same direction but have different magnitudes , @xmath31 . at a later time",
    "@xmath32 short enough that first - order perturbation theory remains valid , these displacements remain proportional , @xmath33 .",
    "the displacement of interest @xmath18 , no matter how small , can thus be constructed in the linear regime simply by dividing @xmath34 by the original scaling factor @xmath35.,scaledwidth=40.0% ]    we propose to solve this problem by using perturbation theory to follow the time evolution of the _ displacement _ vector @xmath29 itself , up to the point where it grows large enough to allow accurate evaluation of the sum @xmath36 . expanding @xmath37 around @xmath10",
    ", we obtain @xmath38\\;.\\end{aligned}\\ ] ] for small displacements @xmath39 , the linear approximation is for all practical purposes exact on the scale of a single time step , @xmath40 where the matrix @xmath41 is given by @xmath42 to integrate @xmath29 forward in time according to equation ( [ lineq ] ) , the equations of motion for the matrix @xmath41 could in principle be solved numerically.@xcite doing so in practice would be cumbersome , requiring calculation of all second derivatives of the interaction potential with respect to particle positions .",
    "we propose a much simpler approach for advancing @xmath18 , inspired by methods for computing lyapunov exponents in systems whose interaction potentials lack well - defined second derivatives . our implementation is illustrated in fig .",
    "[ shoot_fig ] .    instead of integrating the small perturbation @xmath29",
    ", we follow the time evolution of a related perturbation @xmath30 , which _ is _ large enough to be added at the shooting point and propagated in the usual way , i.e. , by integrating newton s equation of motion for @xmath43 .",
    "we use a superscript for @xmath44 and @xmath45 because in the following we will consider a family of different perturbed trajectories @xmath46 , with @xmath47 . exploiting the linearity described by eq .",
    "( [ lineq ] ) , we choose @xmath30 to be in the same direction ( in the high - dimensional phase space ) as @xmath29 , @xmath48 where @xmath49 is a scalar constant . if @xmath30 is also small enough to justify the linear approximation of eq .",
    "( [ lineq ] ) , @xmath50 then the initial relationship between @xmath29 and @xmath30 holds also at a later time @xmath32 , @xmath51 in the linear regime it is thus possible to follow the time evolution of arbitrarily small displacements @xmath29 by monitoring larger , proportional displacements .    the linear approximation for the `` helper '' displacement @xmath34 in eq .",
    "( [ equ : lineqy ] ) will of course remain valid for only a short time @xmath52 , typically less than 1 ps .",
    "our interest in the trajectory @xmath53 , however , is only as a proxy for the evolution of smaller displacements that can not be represented explicitly .",
    "as @xmath34 approaches the boundary of the linear regime , @xmath54 , we may therefore switch our attention to a different helper trajectory @xmath55 , one whose displacement is initially too small to be of practical use but by the time @xmath52 grows large enough to be represented explicitly .",
    "the new displacement @xmath56 can be obtained at any time @xmath57 simply by scaling @xmath34 appropriately , @xmath58 .",
    "because it is initially smaller than @xmath34 , it will remain in the linear regime for a longer time , @xmath59 . for times",
    "@xmath60 we therefore proceed by integrating standard equations of motion for @xmath55 until it approaches the boundary of the linear approximation . at that point",
    "we repeat the procedure , scaling back the displacement to switch attention to yet another helper trajectory .",
    "in effect we monitor a single displacement from the reference trajectory whose magnitude is periodically scaled down such that the linear approximation is always valid . in this way we can monitor the time evolution of an arbitrarily small disturbance",
    ". the corresponding trajectory will be numerically indistinguishable from the reference trajectory as long as the displacement s magnitude is smaller than @xmath61 . at later times",
    "the displaced trajectory can be distinguished , and its dynamics can be safely computed by integrating equations of motion in the usual way .",
    "precision shooting algorithm for generating a trial trajectory @xmath12 ( blue curve ) whose initial displacement from the base trajectory @xmath2 ( red line ) is extraordinarily small .",
    "points in the light blue field ( whose extent is @xmath62 ) can not be numerically distinguished from the reference trajectory .",
    "until the trial trajectory exits this region , its time evolution is calculated by proxy using `` helper '' trajectories @xmath63 ( thin black curves ) .",
    "displacements of trial ( black arrows ) and helper trajectories from the base trajectory are related by proportionality as long as they remain within the linear regime , represented by the light red field . to preserve this simple relationship ,",
    "the displacement of the helper trajectory @xmath63 from the reference trajectory is scaled back when it threatens to leave the region of linear dynamics , effectively switching the system to the next helper trajectory @xmath64 . by following the systems dynamics along many sections of helper trajectories ( green curve ) and by keeping track of the rescaling factors",
    ", one can accurately construct the state of the trial trajectory once it becomes distinguishable from the reference trajectory .",
    "the result of this shooting move is a trial trajectory @xmath12 that is numerically identical to the base trajectory @xmath2 over a certain length of time and then emerges from it in the correct way.,scaledwidth=40.0% ]    this insight suggests the following algorithm , which implements a shooting trajectory @xmath12 , whose initial deviation @xmath29 from the base - trajectory @xmath2 is smaller than the precision limit .",
    "this is done by monitoring `` helper '' trajectories @xmath65 , which are obtained by repeated rescaling . for an illustration of this algorithm see fig .",
    "[ algo_fig ] .    1 .   at the shooting point @xmath10 ,",
    "add a displacement @xmath30 of fixed size @xmath66 .",
    "the displacement @xmath30 is parallel to @xmath29 and larger by a factor of @xmath35 .",
    "propagate the point @xmath67 forward in time for @xmath14 time steps , corresponding to a time interval @xmath68 .",
    "3 .   compute the factor @xmath69 quantifying the divergence from the reference trajectory .",
    "switch to a new helper trajectory by setting @xmath70 .",
    "store the factor @xmath49 .",
    "4 .   propagate the new displacement forward in time by integrating the equations of motion for @xmath14 steps beginning from @xmath71 .",
    "calculate and store the factor @xmath72 .",
    "iterate step 4 , each time beginning from @xmath73 and rescaling by the factor @xmath74 . at every iteration",
    "compute the displacement of interest , @xmath75 , where @xmath76 is the product of all factors used for rescaling so far . to store the current point along the actual shooting trajectory ,",
    "compute @xmath77 .",
    "as long as @xmath78 , @xmath79 will be numerically identical to @xmath80 .",
    "if @xmath81 , the actual shooting displacement is large enough to be treated in the usual way : set @xmath77 and integrate equations of motion from this point without further rescalings ( ceasing iteration of step 4 ) .",
    "note that for shooting moves conducted at points other than @xmath10 , the procedure must be repeated backward in time to obtain a complete shooting trajectory . in the following",
    "we discuss the accuracy of this scheme and give recommendations for choosing values of @xmath82 and @xmath14 .",
    "time evolution of the magnitude of two shooting displacements for a fluid of wca particles.@xcite displacements of size @xmath83 ( black ) and @xmath84 ( red ) are initially proportional ( pointing in the same direction in phase space ) .",
    "both are rescaled to their initial size every 100 time steps ( see inset for a magnified view ) to preserve this linear relationship .",
    "deviation from proportionality is quantified by the relative error @xmath85 ( blue ) defined in eq .",
    "( [ error_eq]).,scaledwidth=40.0% ]    the above algorithm is exact only if the linear approximation of eq .",
    "( [ lineq ] ) holds . for",
    "perturbations of finite size , deviations from this approximation occur .",
    "the question thus arises , how accurate an approximation is this approach for propagating small disturbances ? more specifically , to what extent do helper displacements remain proportional to the actual shooting displacements of interest ?",
    "one could certainly imagine that the fast growth of small non - linearities rapidly erodes the linear relationship on which we depend .",
    "here we present evidence from computer simulations that proportionality of small displacements can hold in practice over very long time scales .",
    "figure [ linreg_fig ] shows the time evolution of two proportional disturbances .",
    "the initial displacement vectors point in the same direction of phase space but have different magnitudes , @xmath83 and @xmath84 .",
    "the respective shooting trajectories were propagated independently , and the displacements from the base trajectory were rescaled to their initial length every 100 time steps . for a perfectly linear time evolution , these displacements remain proportional at all later times . in practice",
    "the vectors @xmath34 and @xmath86 will develop a nonzero angle due to non - linearities . to quantify this deviation from parallel alignment ,",
    "we define @xmath87 as shown in fig .",
    "[ linreg_fig ] , the relative error @xmath85 does not grow above a low level even for very long simulation runs .",
    "this long time stability of aligned disturbances holds over a broad range of displacement sizes between @xmath88 and @xmath89 .",
    "values of @xmath85 can be somewhat larger than for the specific case plotted in fig .",
    "[ linreg_fig ] but on average do not grow larger than @xmath89 for any case .",
    "the error is insensitive to the choice of the rescaling interval @xmath90 , as long as the displacements stay smaller than approximately @xmath91 , where the linear regime breaks down . for displacements smaller than @xmath88 ,",
    "rounding errors become problematic , and phase space displacements do not remain parallel to a good approximation .",
    "one might expect the region of long time stability to extend to even lower levels , closer to the precision limit of @xmath1",
    ". however , the total achievable accuracy in a computer simulation depends , among other factors , on the details of the integrator @xmath8 , the size of the time step , and the dimensionality of the system , and can lie well above the precision limit of @xmath1 .",
    "we find that for the particular system used here , the precision level is about @xmath28 .    in the light of these observations , a value of @xmath92 as initial magnitude for helper displacements seems appropriate .",
    "this choice lies midway between the upper limit of the linear regime ( approximately @xmath91 ) , and the point where rounding errors become dominant ( approximately @xmath88 ) .",
    "as the accuracy of the rescaling scheme is quite insensitive to the frequency of rescalings , many equally good choices of @xmath14 are possible . as a starting point ,",
    "a value of @xmath14 which leads to rescalings every time the displacements have doubled their size is advisable .",
    "relative orientations of three phase space displacement vectors ( @xmath34 , @xmath86 , and @xmath93 ) for a wca fluid.@xcite we plot the angle @xmath94 , @xmath95 , @xmath96 ) and are rescaled to their original sizes at different intervals ( @xmath97 , @xmath98 , @xmath99).,scaledwidth=40.0% ]    the fact that @xmath85 does not show any systematic long - time growth in fig .",
    "[ linreg_fig ] seems surprising .",
    "after all , no constraint is imposed on the direction of the displacement vectors .",
    "why does an accumulation of errors not eventually lead to decoupling and @xmath100 ?",
    "stability of the precision shooting algorithm is in fact a simple and direct consequence of the collective dynamics of displacements in the linear regime . in figure [ angle_fig ]",
    "we plot the angles between three periodically rescaled shooting displacement vectors of different size and random initial direction . eventually , they all rotate into the same direction , which is associated with the largest lyapunov exponent @xmath21 of the system . the time scale on which the directions of different displacement vectors converge is on the order of @xmath101 , where @xmath102 is the difference between the first and second largest lyapunov exponents.@xcite it is because of this convergence , that the difference vector @xmath103 between two proportional displacements with initially identical direction will stay small .",
    "we point out that this property constitutes a main difference of our method over the stochastic scheme introduced by bolhuis@xcite and similar algorithms .",
    "consider , for instance , the following simple algorithm that can be viewed as a smooth version of the stochastic scheme by bolhuis :    * choose a shooting point @xmath104 .",
    "* a fixed number of timesteps @xmath14 earlier and later , at the points @xmath105 and @xmath106 , add a displacement of @xmath1 to one velocity component of one particle . *",
    "integrate the points @xmath105 and @xmath106 forward and backward in time , respectively , to get a complete new trajectory .",
    "just like the precision shooting algorithm , this simple scheme results in a shooting trajectory that is numerically identical to its base trajectory for a certain period of time",
    ". however , the emerging separation between base and shooting trajectories will not be consistent with a shooting move conducted at @xmath10 , but rather with two uncorrelated shooting moves at @xmath105 and @xmath106 .",
    "our algorithm , on the other hand , correctly reproduces the correlated forward and backward dynamics of a displacement introduced at @xmath107 .",
    "we demonstrate the precision shooting algorithm on a simple isomerization process of a solvated diatomic molecule in three dimensions .",
    "our test system consists of 389 particles interacting _ via _ the wca@xcite potential .",
    "we use conventional reduced units , with particle mass and potential parameters @xmath82 and @xmath108 all set to unity . particles # 1 and # 2 do not interact _ via _ the wca potential , but are bonded through a one - dimensional potential with two deep minima separated by a rough barrier ( see fig .  [ pot_fig ] ) : @xmath109 ^ 2 & \\quad\\mathrm{if}\\ ; q(x)<0\\,,\\\\                   h_1\\left[1-(q(x)-b)^2/w^2\\right]^2 & \\quad\\mathrm{if}\\ ; q(x)>b \\,,\\\\                  h_1 + h_2\\frac{\\cos^2\\left[a(q(x)-b/2)\\right]}{\\sqrt{1+ga^2(q(x)-b/2)^2 } } & \\quad\\mathrm{else}\\ , .",
    "\\end{array}\\right.\\ ] ] here , @xmath110 , @xmath111 is the difference between the @xmath112-component of the position of the bonded particles , @xmath113 is the cutoff of the wca potential , @xmath114 determines the width of the minima , @xmath115 and @xmath116 are the length and height of the barrier in between , respectively , and the constants @xmath117 , @xmath118 , and @xmath119 determine the shape of the barrier .",
    "the potential and its derivative are continuous by construction .",
    "potential energy @xmath120 of interaction between particles # 1 and # 2 , comprising the diatomic molecule in our model isomerization process , plotted as a function of the difference @xmath111 between their @xmath112-coordinates .",
    "the dashed lines mark the boundaries of the minima a and b.,scaledwidth=40.0% ]    to speed computation , we borrow a trick from bolhuis work : @xcite particle # 2 is considered to lie always to the right of particle # 1 , hence @xmath121 .",
    "this choice , together with the one - dimensionality of @xmath120 , allows us to choose a simulation box with dimensions @xmath122 .",
    "the resulting particle density is 0.75 , the total energy per particle is 1.0 , and the temperature is 0.45 , as gauged by average kinetic energy .",
    "we use the velocity verlet algorithm@xcite to integrate the equations of motion with a time step of 0.002 .",
    "distribution of transition times @xmath123 for our model isomerization process , as gauged from 2500 trajectories initiated at the barrier top .",
    "inset : difference @xmath111 between the @xmath112-coordinates of particles # 1 and # 2 as a function of time for a typical trajectory.,scaledwidth=40.0% ]    we are interested in sampling the transition of the dimer from the `` contracted '' minimum a at @xmath124 to the `` extended '' minimum b at @xmath125 . the dimer is defined to be in state a for @xmath126 and in state b for @xmath127 ( see fig .",
    "[ pot_fig ] ) . because the system is dense , and the barrier is both long and rough , relaxation from the transition state into either stable minimum is quite protracted .    in conducting tps simulations",
    "it is important that sampled trajectories are not shorter than typical spontaneous barrier - crossing events.@xcite we determine this typical duration for our simple model system by initiating many straightforward molecular dynamics simulations with the dimer bond length set at @xmath128 , corresponding to the middle of the barrier . integrating the equations of motion forward and backward in time yields a representative sample of the transition path ensemble . for a particular trajectory ,",
    "the transition time @xmath123 is the time the system spends between regions a and b. the resulting distribution of transition times is plotted in fig .",
    "[ dist_fig ] . for tps simulations ,",
    "we choose a total trajectory length of @xmath129 time steps , long enough to include 98% of the natural transition path ensemble .",
    "the bias of our sampling to short transitions is therefore minor .",
    "although the artificial potential energy landscape studied here does not directly represent any physical system of interest , it nevertheless shares with many real systems features that lead to long transition pathways and make straightforward application of tps methods ineffective . in our view roughness of the barrier region is an important ingredient .",
    "models featuring long but flat barriers , such as that of ref .",
    "@xcite , should not in fact pose any severe problems for path sampling via the standard shooting move . assuming that motion atop such a flat barrier is diffusive in nature , and that time evolution from the edge of the barrier proceeds into the adjacent minimum with near certainty , then a trajectory initiated on",
    "the barrier will relax into stable state a with probability @xmath130 , where @xmath131 is the initial distance from a and @xmath132 is the width of the barrier . similarly , the probability of relaxing first into state b is @xmath133 .",
    "a standard shooting move from the barrier region then yields a reactive trajectory with probability @xmath134 this value of the acceptance rate should correspond to near optimal sampling of the transition path ensemble.@xcite a problematically low acceptance rate would only arise if one were to sample trajectories of insufficient length , i.e. , paths shorter than typical spontaneous transitions",
    ".    in our tps simulations , only momenta ( and not particle positions ) are disturbed in the shooting moves , with each particle s momentum changed in each direction by an amount drawn from a gaussian distribution of standard deviation @xmath135 ( followed by rescaling of all momenta to enforce energy conservation).@xcite we conduct standard shooting moves with values of @xmath135 of @xmath136 , @xmath137 , and @xmath88 , as well as precision shooting moves with @xmath135 ranging in size from @xmath88 to @xmath138 .",
    "the latter are implemented using helper displacements with @xmath139 and are rescaled every time they reach twice their original size .",
    "for the system size studied here , the initial magnitudes of the resulting displacement vectors are larger than the corresponding value of @xmath135 by a factor of roughly 34 on average .",
    "for instance , @xmath139 results in displacement vectors with an initial size of about @xmath140 .",
    "for each set of sampling parameters , we attempt 50,000 monte carlo moves in trajectory space .",
    "roughly half of these trial moves are generated by shooting .",
    "the other half are generated by a procedure called `` shifting'',@xcite in which short trajectory segments are added to and subtracted from the ends of an existing path .",
    "fraction of shooting moves for our model isomerization process that are accepted in long tps simulations .",
    "acceptance ratios are shown for shooting displacements of various sizes , @xmath141 , implemented using the standard shooting algorithm for values of @xmath26 of 1 , 5 , and 10 , and the precision shooting algorithm for @xmath142 .",
    "for @xmath143 , the result obtained from the precision shooting algorithm ( red ) is effectively indistinguishable from the one obtained with standard shooting.,scaledwidth=40.0% ]    figure [ acc_fig ] shows the fraction of attempted shooting moves that are accepted in tps simulations of the diatomic isomerization with a rough barrier .",
    "while standard shooting moves are accepted with low frequency , any desired acceptance ratio can be obtained by using the precision shooting technique .",
    "figure [ samp_fig ] shows changes in transition time @xmath123 over the course of two tps runs with shooting displacements of @xmath144 and @xmath145 .",
    "a dramatic difference in the efficiency of generating qualitatively different trajectories for the two cases is evident .",
    "variation in isomerization transition time @xmath123 over the course of long tps runs .",
    "the bold black line shows results for a simulation using shooting displacements with @xmath144 , while the thin green line corresponds to @xmath146.,scaledwidth=40.0% ]    to assess the improvement in sampling efficiency achieved with precision shooting , we quantify the computational effort necessary to generate statistically independent transition pathways .",
    "more specifically , we calculate the autocorrelation function @xmath147 where @xmath148 is the deviation of the transition time after the @xmath14-th shooting move from its average @xmath149 , as calculated from all collected trajectories.@xcite rapid decay of @xmath150 indicates an efficient sampling of trajectories .",
    "figure [ ttauto_fig ] shows the logarithm of @xmath150 for different shooting displacement magnitudes along with the `` decorrelation time '' @xmath151 , defined as the number of successive shooting moves after which the correlation function decays to a value less than @xmath152 .",
    "the maximal sampling efficiency is achieved for shooting displacements with @xmath153 .",
    "improvement over the largest displacement we considered ( @xmath144 ) is more than ten - fold .",
    "following bolhuis@xcite , we also investigate as a measure of decorrelation changes in the bond length @xmath112 midway in time through the crossing event .",
    "decay of correlations in this quantity , and the implied dependence of sampling efficiency on shooting displacement size , mirror those reported for the transition time @xmath123 .",
    "number of shooting moves required to generate a statistically independent isomerization trajectory using shooting displacements of various sizes , with @xmath141 .",
    "inset shows decay of correlation @xmath150 in the transition time @xmath123 following @xmath14 attempted shooting moves .",
    "the `` decorrelation time '' @xmath151 is defined as the value of @xmath14 beyond which @xmath154.,scaledwidth=40.0% ]    as fig .",
    "[ ttauto_fig ] illustrates , sampling is comparably efficient for a broad range of displacement sizes between @xmath155 and @xmath156 . in this regime ,",
    "the efficiency gain due to increased acceptance rates for smaller shooting moves is compensated almost exactly by the efficiency loss due to increased similarity between the shooting trajectory and its base trajectory .",
    "using equation ( [ exp_eq ] ) , the time @xmath157 over which a shooting trajectory with displacement size @xmath158 can not be resolved from its base trajectory can be approximated by the time required for the displacement size to reach @xmath1 , @xmath159 for our system , @xmath160 and therefore @xmath161 time steps for the smallest displacement with @xmath162 .",
    "even for this small displacement size , @xmath157 is only 30% of the total trajectory length @xmath163 and efficient sampling is still possible .",
    "if @xmath29 is decreased further , @xmath157 will become comparable to @xmath163 and sampling efficiency will decrease accordingly .",
    ", the smallest representable number in double precision , exponents can be conveniently stored separately as integer numbers . ] for a displacement with @xmath155 , the largest size that leads to optimum efficiency , @xmath157 amounts to only 5% of the total trajectory length .",
    "tps simulation of isomerization dynamics which must proceed through a deep intermediate energy minimum .",
    "top left : interaction potential between particles # 1 and # 2 .",
    "top right : acceptance ratio of shooting moves as a function of displacement size , @xmath141 .",
    "bottom : bond length @xmath112 as a function of time for the starting trajectory and for a pathway obtained after many shooting and shifting moves .",
    "the two trajectories have been shifted in time to highlight their similarity in the vicinity of the intermediate state.,scaledwidth=40.0% ]    by extending the time span over which a shooting trajectory tracks its base trajectory , the algorithm proposed in this work can substantially increase the efficiency of tps simulations that suffer from poor acceptance of shooting moves .",
    "the method is fully consistent with deterministic dynamics and faithfully reproduces the divergent behavior of arbitrarily small displacements in phase space .",
    "we emphasize , however , that the method does not solve all problems whose primary symptom is a low shooting acceptance rate .",
    "most importantly , it does not overcome challenges associated with metastable intermediate states . in this section",
    "we explore the this difficulty in the context of diatomic isomerization .    in order to explore the consequences of metastable intermediates ,",
    "we have modified the diatomic potential @xmath120 to include a deep minimum midway between contracted and extended states ( see fig .",
    "[ inter_fig ] ) , @xmath164 ^ 2 & \\mathrm{if}\\ ; q(x)<0,\\\\                   h_1\\left[1-(q(x)-2w_2)^2/w_1 ^ 2\\right]^2 & \\mathrm{if}\\ ; q(x)>2w_2,\\\\                  h_1-h_2\\left[1-(q(x)-w_2)^2/w_2 ^ 2\\right]^2 & \\mathrm{else}. \\end{array}\\right.\\ ] ] here , @xmath165 , @xmath166 , @xmath167 , @xmath168 , and @xmath169 . limited by machine precision , standard shooting moves fail completely in this case : even shooting moves initiated near the intermediate minimum c rapidly separate from their base trajectories and with high probability do not escape to stable state a or b. only with the precision shooting technique , using a displacement size smaller than @xmath170 , are we able to conduct successful shooting moves .",
    "this success does not indicate , however , that trajectory space is sampled efficiently : a comparison of the first trajectory .",
    "starting with the first of these windows , trajectories are accepted if they cross the border to the next one . after accepting a few such trajectories , the simulation moves on to the next window , eventually leading to a trajectory that crosses",
    "the intermediate from a to b. note that a similar procedure is used in forward flux sampling.@xcite ] with a pathway obtained after many thousands of shooting moves shows that those parts of the trajectory spent within the intermediate are not resampled at all ( see fig .",
    "[ inter_fig ] ) ; they are numerically identical .",
    "transitions involving strongly metastable intermediates are in fact fundamentally problematic for tps methods , unless the dynamics of intermediates appearance and disappearance can be identified as distinct kinetic substeps . if the typical time spent in c is manageable in a computer simulation , then the intermediate does not pose a problem even to the standard shooting move .",
    "if , on the other hand , the free energy barriers delimiting the intermediate state are large compared to typical thermal excitations , then escaping c will itself be a rare event . in such cases , typical transitions from a to b",
    "require at least two unlikely fluctuations ( activating entry and exit of each intermediate state ) , well separated in time .",
    "any shooting move that perceptibly modifies dynamics between these rare fluctuations will be rejected with high probability .",
    "precision shooting can readily generate subtly modified pathways that remain reactive but can not be expected to effectually switch between reactive trajectories that follow substantially different courses through the intermediate state . as tps leaves a system s natural dynamics unchanged , it can eliminate only the largest time scale associated with a rare event . without resorting to methods that prescribe in some sense the detailed route between stable states",
    ", one can overcome the challenge of metastable intermediates with tps only by subdividing transition dynamics into several steps , each of which involves a single dynamical bottleneck .",
    "this work was supported by the austrian science fund ( fwf ) within the science college `` computational materials science '' under grant w004 , and by the chemical sciences , geosciences , and biosciences division of the u.s .",
    "department of energy ."
  ],
  "abstract_text": [
    "<S> the kinetics of collective rearrangements in solution , such as protein folding and nanocrystal phase transitions , often involve free energy barriers that are both long and rough . applying methods of transition path sampling to harvest simulated trajectories that exemplify such processes </S>",
    "<S> is typically made difficult by a very low acceptance rate for newly generated trajectories . </S>",
    "<S> we address this problem by introducing a new generation algorithm based on the linear short - time behavior of small disturbances in phase space . using this `` precision shooting '' technique , </S>",
    "<S> arbitrarily small disturbances can be propagated in time , and any desired acceptance ratio of shooting moves can be obtained . </S>",
    "<S> we demonstrate the method for a simple but computationally problematic isomerization process in a dense liquid of soft spheres . </S>",
    "<S> we also discuss its applicability to barrier crossing events involving metastable intermediate states . </S>"
  ]
}