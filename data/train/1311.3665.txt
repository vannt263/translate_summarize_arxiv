{
  "article_text": [
    "investigations of emission lines from astronomical sources provide a host of information from those sources , including the chemical , kinematic , and physical conditions .",
    "while spectroscopy is generally preferred when analyzing a single or a few sources , narrow  band imaging has traditionally offered the advantage of surveying extended regions of the sky in one or a few emission lines of interest .",
    "one of the most difficult steps when deriving the intensity or equivalent width ( ew ) of an emission line is the determination of the underlying continuum level to be subtracted off the total intensity at the wavelength of the emission to produce a line  only signal . for narrow  band images , this step is usually accomplished by obtaining a second image , either in a broad  band filter ( thus , enhancing the signal of the underlying continuum relative to that of the emission line ) or in an emission  line ",
    "free narrow  band filter , at a wavelength adjacent to that of the emission line , and subtracting a scaled version of this image from the original narrow  band image .",
    "the scaling parameter @xmath0 is most often determined from ( 1 ) measurements of emission  line ",
    "free sources in the same image ( e.g. , helou et al .",
    "2004 , calzetti et al .",
    "2007 ) , or from ( 2 ) ratios of the transmission efficiency of the filters used in the two images , or a combination of the two methods ( kennicutt et al .",
    "2008 ) .",
    "either approach ( 1 ) or ( 2 ) can give unsatisfactory results : the use of emission  line ",
    "free sources exploits only a subset of the available signal in the image , while the use of the filters transmission curve ratio requires accurate a  priori knowledge of both the filters characteristics and the spectral energy distribution of the sources of interest .",
    "additionally , the first approach introduces an element of subjectivity in the determination of which sources are free of emission lines .",
    "we discuss in this paper a method for subtracting the underlying continuum from narrow  band images that attempts to remove much of the subjectivity or uncertainty built into other methods .",
    "we show , in what follows , that the skewness of the signal distribution in the pixels of the continuum  subtracted image is a sensitive indicator of the optimal value for the scaling factor @xmath0 , under a large range of characteristics for the input images . in ",
    "2 we present a simple simulation model to show how the optimal scaling factor is related to a specific feature ( that we call `` transition '' ) in the skewness trend in the residual ( continuum  subtracted ) images . then",
    ", we show two typical applications of this method to the images from the advanced camera for survey(acs ) of the hubble space telescope ( hst ) , and the optical data of the spitzer infrared nearby galaxies survey ( sings , kennicutt et al . 2003 ) to include examples of both space - based and ground - based data . in ",
    "3 we present several examples of anomalous transitions and show how to fix such anomalies . from the implications of our simulations and those anomalies , we derive a set of criteria for the range of applicability of our method . in ",
    "4 we summarize the results and discuss pathways for developing user  friendly routines and/or interfaces that enable using this method efficiently on astronomical images .",
    "our skewness transition method is based on a simple observation : _ near the optimal subtraction , skewness values of residual images show a transitional behavior and the center of the transition is the optimal subtraction . _ for the continuum subtraction problem , a common experience is that over - subtracted images will tend to have a large number of negative - valued pixels , while under  subtracted images will show excess flux resulting in more positive - valued pixels than the optimally subtracted image .",
    "this general property can be expressed as an `` asymmetry '' or skewness of pixel histogram in the image , which we can exploit for our optimization problem .",
    "the skewness of a distribution is defined as : @xmath4 where @xmath5 is a mean , @xmath6 is a standard deviation , and @xmath7 is the sample number .",
    "the skewness is a direct indicator of asymmetry .",
    "symmetric functions such as a gaussian have skewness = 0 .",
    "if a function has a long positive tail ( many pixels with excess flux ) , it has a positive skewness and called positive - skewed ; a negative - tail in the pixel value distribution indicates a negative skewness .",
    "pixel histograms of `` sky '' images in astronomy generally possess gaussian or poisson distributions , which are , therefore , symmetric or slightly positive - skewed .",
    "this means that positive skewness values of real images are mostly due to astronomical signals .",
    "if we assume that the signal is composed of the background ( sky ) , the stellar continuum , and the line - emission , then our problem is to remove both the sky and the stellar continuum from the mixed observed signal while preserving the emission line portion of it .",
    "when we subtract some continuum from the original image , the overall signal strength decreases .",
    "this means the skewness decreases as we subtract more continuum from the original image .",
    "as we continue subtracting continuum from the original image and move toward an over - subtracted image , the skewness transitions from positive stellar residual to negative stellar residual .",
    "if the stellar component dominates over the line emission component , the transition occurs near the skewness = 0 ; i.e. the skewness transits from positive to negative .",
    "the question becomes whether we can exploit the transition point between under- and over - subtraction to obtain an optimal continuum - subtraction algorithm .",
    "we investigate the meaning of such empirical transition in a controlled `` experiment '' by building a simple model and present the implications from it in the following section .",
    "we then move to actual applications to real astronomical images in the next section .",
    "the purpose of this section is to show the results of a simple simulation model and to draw some important implications about the skewness transition and its relation with the optimal continuum subtraction .",
    "the model also provides criteria for application of the method to real images and some clues to resolve anomalous cases .      while images are two dimensional scalar data sets of x , y , and pixel value , the statistics on them usually compresses the spatial dimensions and only deal with the pixel values .",
    "hence , the dimensionality of our image is not important to study its statistical properties .",
    "in addition , most tasks reading pixel values from images follow row - by - row or column - by - column directions virtually treating images as one dimensional data .",
    "it is , therefore , reasonable to treat images as one dimensional arrays for our skewness method .",
    "we assume that a narrow - band image @xmath8 consists of four components , extended line - emission @xmath9 , emission from stars @xmath10 , background @xmath11 , and combined noise of all kinds @xmath12 including poisson ( or gaussian ) noise of each signal , dark current , and readout noise .",
    "we also assume that a broad - band image @xmath13 consists of three components : stellar emission @xmath14 , background @xmath15 , and combined noise @xmath16 , and any other components are negligible for each image .",
    "those are written mathematically as : @xmath17 \\\\ i_b(x ) & = & \\sum s'_{i}(x ) + b_{b } + noise[\\sigma_{b } ( x ) ]   \\\\ \\sigma_{n } & = & \\sqrt{\\sigma_{e}^2 + \\sigma_{s}^2 + \\sigma_{b_n}^2 + dc_{n } + rn_{n}^{2 } } \\\\ \\sigma_{b } & = & \\sqrt{\\sigma_{s'}^2 + \\sigma_{b_b}^2 + dc_{b } + rn_{b}^{2 } } \\end{aligned}\\ ] ] where @xmath18 is the pixel coordinate , @xmath19 is the variance for @xmath9 , @xmath20 and @xmath21 for stellar emissions , @xmath22 and @xmath23 for backgrounds , @xmath24 and @xmath25 for read - out noises , and @xmath26 and @xmath27 are dark currents .    to quantify the amount of subtraction , we define a residual image , @xmath28 , as @xmath29 \\nonumber \\\\   & = & e(x ) + \\delta_{b}(\\mu ) + \\delta_{s}(x ; \\mu ) + noise[\\sigma_{sub}(x;\\mu)]\\end{aligned}\\ ] ] @xmath30 where @xmath0 is a parameter to control the amount of subtraction , @xmath31 is a background residual function , @xmath32 is a stellar residual function , and @xmath33 is the variance of all the combined noises .",
    "the residual functions are the terms to describe the intrinsic differences of backgrounds and stellar continuums in the two images .",
    "finally , we define the skewness function , @xmath34 , by measuring the skewness of the residual image for a given @xmath0 .",
    "@xmath35 where the definition of skewness is presented in equation 1 . in this mathematical framework ,",
    "the continuum subtraction problem is rephrased as a problem to find an optimal @xmath0 parameter which minimizes the stellar residual function .      in this section ,",
    "we assign simple numerical functions to each term in the previous equations .",
    "we simulate images with arrays of @xmath36 pixels , which is roughly a @xmath37 2d image . the size is smaller than a typical image but large enough to mimic most statistical behaviors .",
    "we define a smooth and extended function for e(x ) and take a gaussian profile to represent each star as written below , @xmath38 where @xmath7 is a number of stars .",
    "we choose a basic set of parameters , @xmath39 + 2.0 \\nonumber \\\\",
    "b_{i } & = & randomu[0,10 ^ 5 ] \\nonumber \\\\ c_{i } & = & 5.0 \\nonumber \\\\",
    "d_{i } & = & 4\\times a_{i } \\nonumber \\\\ e_{i } & = & b_{i } \\nonumber \\\\ f_{i } & = & c_{i } \\nonumber \\\\ noise[\\sigma_{n } ( x ) ] & = & randomn(\\sigma = 1 )   \\nonumber \\\\",
    "noise[\\sigma_{b } ( x ) ] & = & randomn(\\sigma = 2 ) \\nonumber \\\\ b_{n } & = & -10 \\nonumber \\\\ b_{b } & = & -10 \\nonumber \\end{aligned}\\ ] ] where `` @xmath40 $ ] '' chooses a random number uniform between ` a ' and ` b ' , `` @xmath41 $ ] '' produce a gaussian distribution with the sigma value of ` c ' .",
    "we refer this set of parameters as our  reference set \" .",
    "@xmath9 is chosen to be smooth and extended throughout the whole array , which we model as a combination of a exponential and a trigonometric function .",
    "many other functional forms could be used . @xmath42 and",
    "@xmath43 represent the fluxes of simulated stars .",
    "the fluxes are randomly chosen from 2 to 202 .",
    "@xmath44 and @xmath45 represent the positions of simulated stars .",
    "they are chosen randomly throughout the whole array . @xmath46 and",
    "@xmath47 represent the width of gaussian psfs and we fix the value at 5.0 for both images .",
    "the noise components are chosen as gaussian distributions with the given sigma value . in the reference",
    "set , the two stellar components , @xmath48 and @xmath49 , are equal except the flux scale , @xmath50 .",
    "all other parameters are set equal in each image , without registration errors , psf mismatches , or color and background variations .",
    "therefore , the stellar residual function vanishes at @xmath51 ; @xmath52 in the reference set , which corresponds to the perfect continuum subtraction .",
    "here we show the skewness values of residual images for our numerical models .",
    "before we investigate more practical cases with a model , we present a trivial case called the  reference model \" . in the reference model",
    ", we set @xmath53 and take the reference set values for all other parameters .",
    "hence , the two simulated images , @xmath8 and @xmath13 , are identical at @xmath51 .",
    "figure  [ fig : refer1 ] shows the results of the reference model .",
    "the top - left ( middle - left ) panel shows the simulated narrow - band image ( broad - band image ) .",
    "the corresponding right panel shows the pixel histogram for each simulated image .",
    "the bottom - left figure shows the skewness function for the reference model and the bottom - right panel shows the pixel histograms for three different cases : under - subtracted ( @xmath54 ) , optimally - subtracted ( @xmath55 ) , and over - subtracted ( @xmath56 ) images .",
    "basically the skewness values are monotonically decreasing as we increase the subtraction scaling factor between the two images .",
    "this monotonically decreasing trend exhibits a `` flattening '' effect near the optimal subtraction , because the skewness value contributed by stellar component is zero at the optimal subtraction . for the reference model ,",
    "the residual histogram is purely gaussian at @xmath55 due to the absence of a line - emission term ( @xmath57 ) ; hence the skewness is zero at the perfect ( optimal ) subtraction .",
    "we can also observe that the skewness function @xmath34 is symmetric at ( @xmath58 ) with a _ transition feature _ by which we can identify where the axis of symmetry is located .",
    "the transition and its symmetric shape are the key feature of our skewness transition method for finding the optimal continuum subtraction . for a smooth profile of @xmath34 , the transition point",
    "is located at the inflection point of @xmath59 .",
    "now we add the emission - line component @xmath9 to the narrow - band image , @xmath8 .",
    "the @xmath9 term of equation  [ eq : source ] is defined to be faint enough , in flux , to minimally change the symmetric transition .",
    "figure  [ fig : practical2 ] shows the results of this model .",
    "we call this our `` practical model '' , because this will be the most general case in our practical applications .",
    "the notable differences between the practical model and the reference model are :    1 .",
    "the skewness is non - zero at the optimal subtraction value , @xmath60 , because of non - zero line - emission .",
    "2 .   the transition is slightly asymmetric at @xmath55 , but still we can locate the center of transition corresponding to optimal subtraction .",
    "the effect of adding the line - emission @xmath9 component is to increase the asymmetry of the transition feature .",
    "figure  [ fig : ex3 ] shows the trend of the asymmetric behavior of @xmath34 by increasing the line - emission in the narrow - band image .",
    "the ratio , r , is a ratio of total fluxes defined as @xmath61 .",
    "this represents a relative strength between stellar component and line emission component . for @xmath62 ,",
    "the transition is relatively symmetric .",
    "we can determine the center of transition with high accuracy .",
    "for @xmath63 , the transition is asymmetric but still we can locate the transition point . for @xmath64 ,",
    "most of skewness is contributed by the line emission term @xmath9 .",
    "so the skewness variation before the transition is minor .",
    "their trends are flat or slightly increasing near the transition . after the transition ,",
    "the skewness decreases monotonically .",
    "due to the dominance of line emission , the continuum subtraction is less important for this case .",
    "also , we can still make a rough guess using the decreasing pattern for the @xmath65 regime shown in figure  [ fig : ex3 ] and [ fig : ngc4449first10 ] .",
    "this experiment provides the first general recipe for our approach : the optimal subtraction value will be more accurately recovered if we can choose a section of our image where the stellar emission dominates over the line emission across the selected image section .",
    "the previous models are ideal cases because we set most of the uncertainties to zero . in this section",
    ", we present the effect of adding different backgrounds , noise levels , registration errors , psf mismatches , and stellar flux errors on the transition feature of the practical model .    for the background",
    ", we can easily predict that differences in backgrounds between narrow - band and broad - band images do not affect the skewness value , since the background of an image is a constant generally related to the first moment of the distribution .",
    "figure  [ fig : back4 ] shows the skewness functions of many different background combinations for narrow - band and broad - band images .",
    "the small differences for various background combinations are caused by the removing process of deviant pixels , `` iterstat '' , described in the following section .",
    "from the figure , we infer that we can generally ignore the effect of different backgrounds between narrow - band and broad - band images on the transition feature of @xmath34 . for the noise levels ,",
    "figure  [ fig : sig5 ] shows the skewness functions for various @xmath66 and @xmath67 combinations .",
    "asymmetries can develop for some combinations , but overall the optimal solution is at the center of the transition .    figure  [ fig : errors6 ] shows the effects of adding position errors ( top - left panel ) , flux errors ( top - right panel ) , and psf errors ( bottom panels ) on the practical model .",
    "the errors illustrate the types of effects that can arise from inaccurate registration ( position errors ) of the narrow and broad band images ; the flux errors from flat - fielding inaccuracies and different colors of the two bandpasses ; and the psf errors from different seeings and inaccuracies of psf matching .    for the position errors ( or registration error ) , we add uniform random numbers to the positions of stellar objects with the given range of `` poserror '' in the simulated broad - band image , thus simulating shifts in pixels .",
    "the position errors change the shape of the transition to more negative - sloped ones and eventually smear out the transition for a @xmath68 shift , which corresponds to 20% of the sigma width , 5 , of the gaussian psf in the practical model . in a similar sense , we add uniform random numbers to the fluxes and the widths of the stellar psfs to the broad - band images .",
    "both show the same result that the transition is conserved while a certain amount of error is added and , after that threshold , the transition is smeared out .",
    "the fluxerror @xmath69 and the psf width error @xmath70 correspond to 10% of average stellar flux and 20% of the width of gaussian psf .",
    "the difference in color and dust extinction between the two filters can produce a flux difference between the two images similar to the one we simulate .",
    "the widths of psfs also show a certain amount of scatter in actual images .",
    "these practical issues can be considered as flux errors and psf errors .",
    "a systematic difference of the size of psfs can occur when using different instruments for the two images .",
    "it is possible that there can be a systematic offset even after matching the psfs . to investigate the effect of a systematic difference in the psf size",
    ", we add a constant to the width of the gaussian psf in the simulated broad - band image . in this case , since the profile shapes are different for the two images , the stellar residual function does not vanish at @xmath55 .",
    "the bottom - right panel of figure  [ fig : errors6 ] shows the transitions for various systematic mismatches . for broader profiles in the broad - band image ( positive additions to the @xmath6 values ) ,",
    "the transition shifts to a smaller value of @xmath0 , because , to minimize the difference between the two profiles , the peak of the broader profile has to be lowered . for sharper profiles ( negative additions to the @xmath6 values ) in the broad - band image ,",
    "the transition is shifted to larger @xmath0 . as other errors , the transition is smeared out when the offset is too large .",
    "to summarize , we have the two important implications from investigating the effects of errors on the transition :    1 .",
    "the transition is conserved for errors in source registration , psf width , or flux scaling that are smaller than @xmath71 10 % @xmath72 20 % .",
    "most errors make the slope of the transition more negative ( we call this `` down - slope transition '' ) .",
    "the smearing - out limits in our model are just guidelines since our model is simplistic and its purpose is to provide theoretical guidance not to simulate accurate features in the continuum subtraction of real images . in most practical applications ,",
    "the error tolerance is robust enough to find the transitions in most of the subtracted images .",
    "most transitions in practical applications are down - sloped because most uncertainties are inevitable .",
    "real images contain many cosmetic defects including unmasked cosmic rays and saturated pixels .",
    "such pixels can dominate the skewness value even though the number of the pixels is small .",
    "therefore , we need a procedure to remove such deviant pixels . in our approach , we adopt _",
    "iterstat.cl _ from the image reduction and analysis facility(iraf ) and _ djs_iterstat.pro _ from the interactive data language(idl ) .",
    "both scripts have two parameters , sigrej and maxiter .",
    "they iteratively recalculate the statistics ignoring the outliers outside of @xmath73sigrej@xmath74 , where @xmath75 and @xmath76 are mean and standard deviation at the @xmath77-th step , and stop when one of these conditions is met : ( 1 ) the maximum number of iterations , as set by maxiter , is reached .",
    "( 2 ) no new pixels are rejected , as compared to the previous iteration .",
    "( 3 ) at least 2 pixels remain from which to compute statistics . though we adopt the iterstat procedure for rejection , that is not the only option to remove the deviant pixels .",
    "the rejection algorithm is needed to prevent deviant pixels from dominating the skewness measurement , and any other routine that has this purpose can be used on the images .",
    "figure  [ fig : iter7 ] shows the effect of the iterstat routine .",
    "we set the maximum number of iterations to maxiter=10 . by decreasing the rejection threshold , @xmath78 ,",
    "we remove more pixels from the residual images . in our simulation models , the transitional feature does not change until we lose most of the stellar flux .",
    "so basically the rejection procedure , iterstat , conserves the transition . in practical uses",
    ", the rejection algorithm can amplify other possible errors , such as registration errors and psf errors , and , eventually , smear out the transition .",
    "therefore , theoretically the rejection process does not change the transition but practically strong rejection criteria can affect the transition .",
    ", using the _ iterstat _ routine . basically implementing a rejection algorithm on",
    "the data preserves the transition . ]      in this section , we have presented the results of our one dimensional simulations .",
    "we have shown that there is a transition in the skewness values of the residual images . and the location of the transition provides the optimal value @xmath0 for stellar flux removal .",
    "the line emission term , @xmath9 , increases the asymmetry of the transition . without the line emission term",
    ", we have a simple symmetric transition as shown in the reference model . to keep the transition in near symmetric shape",
    ", we need to choose a section of the image where the stellar flux dominates over the emission line flux , @xmath62 ( section  2.1.4 ) , for high accuracy . the transition is error - resistant for large ranges in the possible observational uncertainties .",
    "the _ iterstat _",
    "rejection routine we adopt to remove deviant pixels ( crs and saturated pixels ) conserves the transition , provided the integrity of the image ( in terms of total stellar flux ) is preserved .",
    "our skewness transition method is better for statistical sampling than any extant methods , such as choosing several point - source objects to measure flux ratios , because we use the whole pixel distribution in a section of ( or an entire ) image . for the stellar dominant regime , @xmath62 , we can make an accurate estimation for subtraction .",
    "computation time is also relatively short , because we only measure a skewness for each residual image .",
    "the only weak point on this method is that we may not find the transition in some pathological cases . in the following sections",
    ", we will investigate our method on real images and also present how to deal with pathological cases .",
    "the previous section shows the expectations from models for where and how the skewness method works .",
    "but our simulated images are too simplistic to represent real images . in this section",
    "we will present typical examples which demonstrate that the expectations from models are applicable to real data and that the optimal @xmath0 value is found at the center of the transition for stellar dominated images .",
    "figure [ fig : ngc5713first8 ] shows the h@xmath79 image ( top - left ) and the r - band image ( top - right ) for ngc5713 observed with the 1.5 m telescope of cerro tololo inter - american observatory ( ctio ) .",
    "the data are part of the spitzer infrared nearby galaxies survey ( sings , kennicutt et al .",
    "2003 ) . to obtain a continuum - free h@xmath80image",
    ", we use the r - band image to remove the stellar component from the narrow - band image .",
    "one common method is to measure the flux of stellar objects in the two images and take the ratios of them for the scaling factor of continuum subtraction .",
    "the 8 open circles in the h@xmath80image indicate the stars we choose to calculate the flux ratios ( the number adjacent to each circle ) between the narrow - band and the broad - band images .",
    "we use the iraf / imexamine task for photometry of each star .",
    "the minimum ratio among our chosen stars is 0.047 and the maximum ratio is 0.056 .",
    "from those ratios , we can point out the two caveats for this continuum subtraction method ; ( 1 ) stars are located in the foreground of the target .",
    "( 2 ) the distribution seems to be bimodal clustered around 0.049 and 0.053 .",
    "this is a selection bias caused by choosing several bright stars in the image .",
    "the bottom - right panel in figure [ fig : ngc5713first8 ] shows the skewness function obtained with the iterstat routine ( @xmath81 rejection , 10 iterations ; the rejection thresholds of @xmath81 or @xmath82 are suitable for most practical cases .",
    "our simulation has somewhat higher @xmath6 thresholds because of our simplistic implementations for stellar and extended sources ) .",
    "this is a typical example consistent with our theoretical results .",
    "all of the flux ratios from the stellar objects are scattered around the center of the transition .",
    "the overall shape of the skewness function is quite similar to that of our practical model .",
    "the slope of the transition is negative as our error - tolerance test suggests .",
    "the transition is slightly asymmetric but enough to locate the optimal position .",
    "we choose @xmath83 for the optimal location , and we show the residual image for @xmath83 in the bottom - left panel of figure [ fig : ngc5713first8 ] . in this image ,",
    "the foreground stars are almost perfectly subtracted , supporting our choice for the optimal value of @xmath0 .",
    "figure  [ fig : ngc5713second9 ] shows the zoom - in skewness function on the transition ( top - left ) and pixel histograms for various scaling factors @xmath0 ( top - right ) . for comparison , we put the minimum ratio labelled `` a '' and the maximum ratio labelled `` c '' in the plot of the skewness function .",
    "we give the label `` b '' to our optimal choice .",
    "the transition starts near a and ends slightly further from c. before and after the transition , the skewness decreases monotonically .",
    "so there are , near the transition , two asymptotic lines , the  under - subtraction line \" before the transition and the  over - subtraction line \" after the transition . if the transition is symmetric , the two asymptotic lines are parallel to each other . in this case",
    ", we can locate the center of the transition very accurately .",
    "the top - right panel shows the pixel histograms for the five residual images , the original narrow - band image ( @xmath84 ) , a(@xmath85 ) , b(@xmath83 ) , c(@xmath86 ) , and the heavily over - subtracted image(@xmath87 ) .",
    "the skewness keeps decreasing as we increase the amount of continuum - subtraction . near the optimal subtraction",
    ", the decrement of skewness reduces so as to produce the transitional pattern in the skewness trend .",
    "the bottom panels of figure  [ fig : ngc5713second9 ] show the relative flux difference @xmath88 ( or @xmath89 ) on pixel - by - pixel basis between a ( or c ) and b. the @xmath81 level is 0.015 for the residual image b. so the pixel value @xmath90 corresponds to @xmath91 . for some bright pixels , the flux differences between the two subtractions are less than 10% . but for faint pixels , the fluxes are very sensitive to the choice of scaling factor @xmath0 . for the pixels less than @xmath92 levels in the figure ,",
    "the flux changes over 100% depending on the choice of scaling factor .",
    "when we calculate a line ratio such as h@xmath93/h@xmath80for diffuse gas , the accurate continuum subtraction becomes very important .",
    "the total pixel counts in the aperture for ngc5713 shown in figure  [ fig : ngc5713first8 ] ( bottom - left panel ) are 3900 for a , 3200 for b , and 2800 for c. so the relative flux difference between a ( or c ) and b is 22% ( or 13% ) . between the two conservative subtractions a and c , the difference of aperture photometry range up to 30% .",
    "so , even for aperture photometry , an inaccurate choice of continuum - subtraction can change the flux significantly , in our case over 10% .",
    "basically there is no mathematical proof that the center of transition is the optimal subtraction in practical applications . for our simulation model , the argument is mathematically correct because we set the related parameters to satisfy the perfect subtraction .",
    "our empirical observations show that the ratios of stellar fluxes are located in the transition region and our visual inspection of the the residual image shows that a good choice for the optimal continuum  subtraction is the center of the transition region .",
    "we , thus , assume that the center of the transition is the optimal solution for general applications .",
    "basically space - based images are not much different from ground - based images .",
    "the only difference which matters for the skewness method is that space - based images have more resolved faint stars than ground - based ones , so they are more sensitive to mis - registration errors between the two images .",
    "figure  [ fig : ngc4449first10 ] shows the h@xmath79 image of ngc4449 observed by the advanced camera for survey(acs ) of the hubble space telescope(hst ) ( top - left ) and the continuum image for the h@xmath79 image created by interpolating images in the two filters f814w and f555w ( top - right ) . since ngc4449 is a starburst galaxy , the nebular emission dominates over stellar objects in the h@xmath79 image . because of that , we will find a broad and asymmetric transition from the entire image and the size of the image itself is too large to calculate the skewness function in a relatively short amount of computing time .",
    "hence , we choose the region with pixel coordinates [ 3400:4000 , 500:1100 ] shown in the bottom panels in figure [ fig : ngc4449first10 ] where the stellar objects dominate the total flux and the size is relatively small to obtain the skewness function in a short time .",
    "the left panel of figure  [ fig : ngc4449second11 ] shows the skewness function of the region . to obtain a better transition for this image we use the iterstat procedure with @xmath82 rejection and 10 iterations .",
    "the skewness function is not as smooth as the previous example of the ground - based image , because the small size and relatively low signal - to - noise ratio of the image induces noise in the skewness for each @xmath0 .",
    "the right panel of figure  [ fig : ngc4449second11 ] shows the transition which begins around @xmath94 and ends around @xmath95 .",
    "we choose @xmath96 as an optimal value for the subtraction .",
    "we apply this local optimal value to the entire image .",
    "if the image section is large enough to represent the overall stellar population of the entire image , the local optimal value is a good choice for the global optimum .",
    "figure  [ fig : ngc4449third12 ] shows the central region of the continuum subtracted images for @xmath97 each .",
    "we can observe that the skewness transition corresponds to the transition from under - subtraction ( @xmath94 ) to over - subtraction ( @xmath95 ) and that the optimal value chosen from the center of the transition is well - subtracted even at visual inspection .                because ngc4449 is very bright in h@xmath80",
    ", we can investigate the effect of various line emission strengths on the skewness transitions as shown in figure  [ fig : ex3 ] for the simulations .",
    "first , for the investigation , we measure the pixel counts for the original ( un - subtracted ) narrow - band image .",
    "we consider that the pixel counts are the total flux , @xmath98 .",
    "then we measure the pixel counts for the subtracted narrow - band image taking the optimal ratio , @xmath99 , found in the previous section .",
    "we consider that the pixel counts are the line emission flux , @xmath100 . from those",
    ", we can measure the ratio , @xmath101 ( table  1 ) .",
    "figure  [ fig : ngc4449fourth13 ] shows the selected 6 sections in the h@xmath80image and their skewness functions .",
    "the vertical lines indicate the location of the optimal ratio , @xmath99 , derived earlier from the first image region ( figure  [ fig : ngc4449first10 ] ) .",
    "we can see that our previously derived optimal ratio , @xmath99 , is consistent with the skewness functions of the selected sections .",
    "section e , that has @xmath62 , shows a symmetric transition , for which we can locate the center easily and accurately .",
    "section f has @xmath63 and shows an asymmetric trend .",
    "sections , b , c , and d show the flat or slightly increasing trend before the optimal solution .",
    "after the optimal point , the skewness decreases monotonically for these regions . in section",
    "a , the overall trend shows a smooth decrease , although it remains similar to those of b , c , and d. this demonstrates that the skewness function is solely dominated by the ratio of the line  to  stellar emission .",
    "we can not find any characteristic specific to the stellar emission for section a.        crrrr a & 6169 & 5537 & 632 & 8.8 + b & 3106 & 2322 & 784 & 3.0 + c & 27808 & 18976 & 8832 & 2.1 + d & 24040 & 19699 & 4341 & 4.5 + e & 116 & 24 & 92 & 0.26 + f & 620 & 254 & 366 & 0.69 +",
    "we have presented the expectations and the typical applications of the skewness method in the previous sections .",
    "the typical transition is nearly symmetric and shows a down - slope trend .",
    "we choose the optimal continuum subtraction by locating the center of the transition .",
    "however , some defects or low image quality can cause anomalous shapes of the skewness function so that we can not easily locate the center of transition . in this section",
    ", we will present cases of anomalous transitions caused by the presence of problematic pixels or regions in the images and show how those problems can be resolved . from those anomalous cases",
    ", we will infer criteria for the applicability of the skewness method and discuss the strengths and weaknesses of this method .",
    "figure [ fig : ngc4254first14 ] shows the r - band image of ngc4254(top ) from the sings sample , its pixel histogram(middle ) , and its skewness function(bottom ) .",
    "the noise is not gaussian and has two peaks caused by a non - uniform background .",
    "such distorted background affects the skewness value of the image and finally produces the anomalous skewness function . to reduce the non - uniformity , we take the central part of the image , shown in figure [ fig : ngc4254second15 ] . even though the noise distribution is not perfectly gaussian ,",
    "the double peak component is removed .",
    "the middle panels in the figure show the skewness functions for this image section .",
    "the transition is now normal and we take the optimal value , @xmath102 . the bottom panel shows the continuum - subtracted h@xmath79 image for @xmath102 which is optimally - subtracted even at visual inspection .",
    "since dust lanes of spiral galaxies appear as dark regions on a brighter background , some of them may be counted as sky background in pixel histograms .",
    "this contamination distorts the shape of sky background from its typical gaussian distribution .",
    "so the off - source field is also important for our skewness transition method to secure well - defined background statistics . in most ground based observations",
    "the field - of - view(fov ) is large enough to cover enough off - source field .",
    "but the small field of view of hst observations can be problematic to obtain enough off - source field .",
    "figure [ fig : ngc4258first16 ] shows the f658n and the f547 images ( left panels ) of wf2 from hst / wfpc2 and their pixel histograms(right panels ) for ngc4258 . if the sky backgrounds are smooth and close enough to gaussian distribution , we can assume that the center of the skewness transition is the optimal subtraction .",
    "but as irregularity increases , there is no guarantee whether the solution will be located at the center or not .",
    "the histograms in the figure show atypical shapes because of the presence of the dust lane and the lack of off - source information due to small field - of - view .",
    "the top panels of figure [ fig : ngc4258second17 ] shows the skewness function calculated from those images .",
    "the transition is somewhat asymmetric , but still we can locate the center of transition at 0.14 . the problem is whether the chosen value is reliable or not .",
    "the bottom panels of figure [ fig : ngc4258second17 ] show the continuum subtracted image with @xmath103 ( left ) and its pixel histogram ( right ) .",
    "when we compare the f658n images before and after subtraction , figure [ fig : ngc4258first16 ] and figure [ fig : ngc4258second17 ] , we find many over - subtracted stars in the subtracted image ; this means that the value of @xmath0 is not an optimal one . to avoid the over - subtraction , a better choice is to take @xmath104 .",
    "this implies that the irregular sky backgrounds of the broad - band and narrow - band images blur the relation between the transition point and the optimal subtraction . for this kind of situation ,",
    "the skewness method is not much more reliable to pick up the optimal solution than other approaches . but",
    "this uncertainty is an intrinsic limitation of the image itself due to the indefinite sky background and lack of off - source information .",
    "saturation of stellar objects can provide an effect on the stellar residual function and it will significantly affect the transition .",
    "fig.[fig : ngc3627first18 ] shows the skewness functions ( right ) and the r - band images ( left ) for ngc3627 . in the top panels , the two bright stars have conspicuous horizontal spikes and the transition shows an unexpected up - slope trend . in the middle panels ,",
    "we show a section of the image that avoids the two saturated stars .",
    "the strong up - slope trend is removed in this section , but still there is a bump around @xmath105 .",
    "this is because of possible saturation in the galaxy bulge .",
    "we thus mask out the bulge , too .",
    "the final image section is shown in the bottom panels , and for this we obtain the expected transition in the skewness trend .",
    "the top panel of fig.[fig : ngc3627second19 ] shows the zoom - in plot of the transition .",
    "we take the optimal value , @xmath106 from the figure .",
    "the bottom - left panel of the figure shows the subtracted image of @xmath106 .",
    "the bulge is over - subtracted because it was masked out in order to obtain a well  behaved skewness transition in the image .",
    "this shows , a posteriori , that the galaxy bulge is likely saturated in this observation .",
    "a visual inspection would suggest @xmath105 to avoid over - subtracting the bulge ; the image resulting from this value of @xmath0 is shown in the bottom - right panel of the figure .",
    "however , since the skewness method is objective , and not as subjective as our eyes , we choose the left panel as an optimally - subtracted image .",
    "these steps demonstrate the improvement on the skewness method when masking out problematic regions .              we have presented theoretical expectations and a few applications using actual data for the skewness transition method .",
    "theoretical expectations imply that the stellar emission needs to dominate in order to obtain a more symmetric transition and locate the optimal solution more accurately .",
    "and we have found that saturated bright stars or bulge , dust lane , and non - uniform sky background can produce anomalous behaviors in the skewness function .",
    "the effectiveness of the method can , however , be recovered by removing / masking out such anomalies from the images .    as a summary of what we have found",
    ", we can itemize the criteria of the skewness method as follows :    1 .",
    "stellar emission needs to dominate over line emission ( @xmath107 ) to obtain a more symmetric transition . * for @xmath62 , the transition is symmetric and we can locate the center of the transition accurately ; * for @xmath63 , the transition becomes more asymmetric but still we can locate the transition center . * for @xmath108",
    ", we can still roughly locate the optimal solution using its monotonically decreasing trend after the optimal ratio .",
    "but when @xmath109 is large enough , there is no characteristic transition for the skewness function . 2 .",
    "appropriate registrations and psf matches are required to avoid smearing out transitions .",
    "saturated sources need to be avoided or masked .",
    "4 .   a smooth sky background which is not too deviant from gaussian or poisson distributions is required .",
    "fortunately , most criteria above are not constraining requirements , in general . if we accept the assumption that a local optimal value from an image section is not much different from the global optimal value for the whole image , we can easily use image sections to satisfy the criteria for the optimal solution .",
    "before we summarize our results , we discuss two important issues in this section : ( 1 ) self - contamination of line emission in its corresponding broad - band image ; and ( 2 ) automation of the procedure , i.e. , of finding the location of the skewness transition .",
    "for some cases , the target line emission also falls in the broad - band filter ; e.g. r - band for h@xmath80continuum subtraction . in general , the fraction of the line emission flux relative to the total flux in the broad  band filter is small enough that we can consider the self - contamination a higher order correction .",
    "but , in those instances in which the line emission is a non ",
    "negligible contribution , @xmath11010% , to the broad - band image , the decontamination of the broad  band flux from the line contribution becomes important .",
    "a standard approach is to use an iterative subtraction method .",
    "the basic idea is that , if an object suffers from substantial line emission contamination in the broad - band image , the stellar continuum baseline is over - estimated by the amount of self  contamination .",
    "after subtraction , the self  contaminated object , therefore , tends to have an underestimated line flux ; i.e. a smaller line flux estimate than a true contamination  free value . we thus keep iteratively subtracting the line emission and broad  band images from each other , until the fluxes stabilize to their asymptotic values , typically after two  three iterations .",
    "this iterative process can be described as : @xmath111 where @xmath112 is the original narrow - band image , @xmath113 the original broad - band image , @xmath114 the i - th line emission image , @xmath115 the i - th stellar continuum image , and @xmath116 the i - th optimal ratio of continuum subtraction .",
    "the two original images , @xmath112 and @xmath113 , need to be scaled to the same units to ensure that the subtraction , @xmath117 , is self  consistent . during the iterations ,",
    "if we can take the best ideal @xmath118 for each step , the two sequences of @xmath119 and @xmath120 should converge to the contamination - free values .",
    "the consistent choices of @xmath118s , hence , are important to guarantee the convergence .",
    "we applied this iteration method to decontaminate [ o iii](@xmath1215007)@xmath122and h@xmath123@xmath122from f555w in hong et al .",
    "we compared the iterated f555w with the f547 m image which is the filter free from line contamination . from this study , we have shown that the iteration method works and our skewness transition method is good enough to provide accurate subtractions to obtain convergent values . however , it is still possible for some images with poor quality to fail to converge during iterative subtractions .",
    "the typical symmetric transition ( or near - symmetric transition ; r @xmath124 ) has an inflection point where the optimal solution is ( see figure  [ fig : ex3 ] ) .",
    "this is a fundamental feature to build an automatic method for continuum subtraction .",
    "but the problem is , as described in  3 , that we have observational anomalies which are generally handled manually .",
    "therefore , the automation of the continuum subtraction procedure suffers from practical issues .",
    "we can implement a code to find the inflection point and infer the corresponding r value to check whether the inflection point is derived from a symmetric transition or not .",
    "auxiliary codes which can recognize anomalies in the transition and select anomaly  free image sections are , however , needed to avoid problematic regions",
    ". there can be many solutions to deal with this practical issue such as genetic algorithm and pattern recognition .",
    "one option is to choose random sections in an image and calculate the transition for each section .",
    "the results from the image sections could then be discarded or merged according to the quality of each solution . the need for automatic pipelines to handle huge amounts of data in astronomy will ultimately drive the requirements for the automation of this method , via optimized routines and/or interfaces , in order to increase its practical use .",
    "we have presented a quantitative method to determine the optimal stellar continuum subtraction from a narrow - band image .",
    "the skewness of the residual image shows a transitional feature and we have found that , from our simulations , the transition is related to the optimal value of the subtraction . if the stellar emission dominates over the line emission in the narrow - band image , the transition is symmetric and the optimal solution is located at the center of the transition ; hence a very accurate subtraction can be achieved .",
    "uncertainties brought by nonuniform sky background and saturation of bright stars or bulges can produce anomalous transitions .",
    "if we can identify `` well - behaved '' ( i.e. , anomaly ",
    "free ) image sections that satisfy the applicable criteria ( section 3.2 ) , we recover the conditions for optimal subtraction .",
    "this method is objective and quantitative , and it is statistically complete since it use all the pixels in the image .",
    "we can also obtain a better precision than visual subtraction if the images have sharp and symmetric transitions .",
    "this accuracy is important especially for diffuse gas emission , for which an inaccurate stellar continuum subtraction can produce over 100% variation in the measured flux . by choosing well  behaved sections of images and assuming that the local optimal value is not much different from the global one",
    ", we can achieve high accuracy ( @xmath12510% error on the global flux ) for most astronomical images .",
    "calzetti , d. , kennicutt , r. c. , engelbracht , c. w. , et al .",
    "2007 , apj , 666 , 870 helou , g. , roussel , h. , appleton , p. , et al .",
    "2004 , apjs , 154 , 253 hong , s. , calzetti , d. , dopita , m. a. et al .",
    "2011 , apj , 731 , 45 kennicutt , r.c . ,",
    "armus , l. , bendo , g. , calzetti , d. , dale , d.a . , draine , b.t . ,",
    "engelbracht , c.w . , et al .",
    "2003 , pasp , 115 , 928 kennicutt , r. c. , lee , j. c. , funes , s. j. , sakai , s. , & akiyama , s. 2008 , apjs , 178 , 247"
  ],
  "abstract_text": [
    "<S> we present an objective method to remove the stellar continuum emission from narrow  band images to derive emission  line images . </S>",
    "<S> the method is based on the skewness of the pixel histogram of the residual images . </S>",
    "<S> specifically , we exploit a transition in the skewness of the signal in the continuum  subtracted image , which appears when the image changes from being under  subtracted to over  subtracted . </S>",
    "<S> tests on one  dimensional artificial images demonstrate that the transition identifies the optimal scaling factor @xmath0 to be used on the broad - band image i@xmath1 in order to produce the optimal line  emission image i@xmath2 , i.e. , i@xmath2=i@xmath3-@xmath0 i@xmath1 , with i@xmath3 the original ( un  subtracted ) narrow  band image . </S>",
    "<S> the advantage of this method is that it uses all information  bearing pixels in the final image , and not just a sub  set of those pixels ( the latter being common in many traditional approaches to stellar continuum removal from narrow  band images ) . </S>",
    "<S> we apply our method to actual images , both from ground  based and space facilities , in particular to wfpc2 and acs images from the hubble space telescope , and we show that it is successful irrespective of the nature of the sources ( point - like or extended ) . </S>",
    "<S> we also discuss the impact on the accuracy of the method of non  </S>",
    "<S> optimal images , such as those containing saturated sources or non  uniform background , and present ` workarounds ' for those problems . </S>"
  ]
}