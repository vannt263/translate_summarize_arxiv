{
  "article_text": [
    "machine learning prediction of brain disorders based on neuroimaging data has gained increasing attention in recent years .",
    "studies aiming at predicting brain disorders based on voxel - level and region - level mri features are reviewed in @xcite and @xcite ; these reviews also highlight some important pitfalls of machine learning based analyses of neuroimaging data .",
    "when it comes to classification of connectomes , the task becomes even more challenging .",
    "mathematically , the input objects of machine learning algorithms are now graphs with particular properties .",
    "let @xmath0 be a macroscale brain network , @xmath1 be a class label ( we only deal with @xmath2 throughout this study ) . given a training set of pairs @xmath3 and the test set of input objects @xmath4",
    ", the task is to make a good prediction of the unknown class label @xmath5 .",
    "the task is specific because of the particular objects @xmath0 : these are relatively small undirected fully connected graphs with weighted edges and uniquely labeled nodes which are localized in 3d space . for structural connectomes ,",
    "edges are weighted proportionally to the number of streamlines between the brain regions .",
    "the most obvious approach to classification within these settings would be to adopt some strategy of transforming adjacency matrices into vectors from @xmath6 because most classifiers work with this type of input objects . in this paper",
    ", we develop a different approach .",
    "we propose that spectra of the normalized graph laplacians can capture the most essential structural properties of brain networks .",
    "hence , spectral distributions of brain networks can differ in normal and pathological development . to account for differences in the spectral distributions of connectomes",
    "we propose to use an earth mover s distance ( emd ) , a metric that appears in transportation problem as a discretized version of the mass transportation distance .",
    "we next use the pairwise distances between spectral distributions of brain networks to construct a kernel for a support vector machines ( svm ) classifier .",
    "we evaluate the proposed approach for a task of classification of autism spectrum disorder versus typical development based on a publicly available dataset .",
    "we report classification quality that is higher than that obtained based on simpler graph embedding methods .",
    "we propose that spectra of the normalized laplacians can be used to meaningfully represent connectomes . given an undirected weighted graph with @xmath7 nodes , we define the adjacency matrix @xmath8 as the @xmath9 matrix with entries @xmath10 , where @xmath10 is the weight between the respective nodes ( the weights are not necessarily binary ) .",
    "we define @xmath11 as the diagonal matrix of weighted node degrees :    @xmath12    the normalized graph laplacian is given by : @xmath13        for an extensive theory on the normalized laplacian spectra , we refer to @xcite .",
    "the spectra of the normalized laplacian are particularly informative because they have some useful properties .",
    "the eigenvalues are always in range from 0 to 2 ; this allows the comparison of networks with different sizes .",
    "importantly , the overall shape of the eigenvalue distribution , its symmetry and the multiplicity of particular values also capture an important information about graph structure ; figure 1 gives an example illustration on a toy network .",
    "for the formal definitions and proofs , we refer to @xcite .",
    "a paper @xcite also plots many examples of the spectral distributions of the normalized laplacians of the simulated and real networks ; the latter include biological networks , weblog hyperlink graphs , power grids , us football games , and many others .",
    "the authors attempt to group these networks into classes based on the shape of their spectral distributions ; they suggest that the shape of the spectral distribution of the networks of a particular class can provide insights into their structure and growth .",
    "however , the proposed classification scheme is rough and is based only on the visual evaluation of the plotted distributions .",
    "a similar work is done in @xcite .",
    "the authors compare eigenvalue distributions of the normalized laplacians across the structural brain networks of the cat , macaque and caenorhabditis elegans ; they describe similarities in these networks and also compare them to some random networks and real networks from other domains . based on the visual evaluation of the plotted distributions ,",
    "the authors claim that the close relation between the normalized laplacian spectra of the analyzed networks suggests shared underlying structural properties of the neuronal systems of the macaque , cat and c. elegans .",
    "they conclude that the analysis of graph spectra reveals the structural brain networks to be in a specific class of networks , distinct from the other network classes .    taken together",
    ", these papers suggest that the graph spectra can serve as informative features for the task of brain network classification .",
    "hence , the problem of classifying graphs transforms into a problem of classifying distributions of the eigenvalues associated with these graphs . in the next section ,",
    "we discuss how this can be accommodated .",
    "as discussed above , we aim to take into account the shape of the spectral distributions and the multiplicity of particular eigenvalues rather than simply consider the eigenvalues as feature vectors .",
    "hence , we need to introduce a distance between spectral distributions . provided that we can measure the pairwise differences between the distributions of graph spectra , we can construct a kernel based on these differences .",
    "afterwards , we can use the kernel trick and feed the obtained kernel to an svm classifier .",
    "the svm classifier is able to accept any input objects , not necessarily a set of vectors from @xmath6 .",
    "this means that any positive semi - definite function    @xmath14 on the input data @xmath15 can be used as a kernel for the svm classifier provided that : @xmath16 for any @xmath17 and any coefficients @xmath18 .",
    "there are no constraints on the structure of the input data @xmath15 .",
    "examples of kernels on graphs can be found in @xcite and @xcite .    in this study , we explore behavior of a kernel that is based on distances between graph spectral distributions .",
    "let @xmath19 be the spectrum of a normalized laplaian @xmath20 and @xmath21 be a distance between spectra @xmath22 .",
    "we build a graph kernel @xmath23 using the distance @xmath24 as follows : @xmath25      hence , we need to compute pairwise distances between spectral distributions .",
    "there are two possible ways to accommodate this .",
    "first , we can estimate the density using empirical values and use measures that work with localized data representations .",
    "we explored this method in our previous work @xcite .",
    "we first split the entire range of eigenvalues into equal intervals ( bins ) and computed frequencies within each bin .",
    "we next considered the two probabilistic distance measures : the kullback - leibler divergence and the jensen - shannon distance .",
    "we obtained the information divergence based kernels by exponentiating these measures and examined their performance in the tasks of classification of autism spectrum disorder versus typical development and of the carriers versus non - carriers of an allele associated with the high risk of alzheimer disease .",
    "the outcomes of the algorithm were extremely sensitive to the number of bins used to reconstruct density .",
    "on average , the classification quality was rather poor , with the area under the receiver operating characteristic curve ( roc auc ) of about 0.65 , although with some arbitrary numbers of bins it occasionally unsystematically peaked higher .    in this study , we introduce a different approach that does not require defining arbitrary bin sizes and hence overcomes the major weakness of the previously used method .",
    "the algorithm proposed here compares the spectral distributions directly based on the vectors of eigenvalues . to accommodate this",
    ", we propose to use the earth mover s distance ( emd ) @xcite , which measures the minimum cost of transforming one sample distribution into another .",
    "this metric receives its name from the idea behind it : if each distribution is represented by some amount of dirt , emd is the minimum cost required to move the dirt of one distribution to produce the other .",
    "the cost is the amount of dirt moved times the distance by which it is moved .",
    "the emd is thus based on the solution to the transportation problem , which is a problem of finding a least expensive flow of goods from the suppliers to the consumers that satisfies the consumers demand . from this point",
    ", the emd can also be viewed as a discretized version of the monge - kantorovich mass transportation distance , which is defined for continuous measures . in statistics ,",
    "the emd is also known as the wasserstein metric between probability distributions .",
    "we refer to @xcite for a review on the history of this measure .",
    "more technically , let @xmath26 be the eigenvalues of spectrum @xmath19 .",
    "we put an equal measure @xmath27 to each point @xmath28 on real line .",
    "let @xmath29 be the flow of mass between the points @xmath28 and @xmath30 .",
    "the emd is the normalized flow of mass between sets @xmath31 and @xmath32 that minimizes the overall cost : @xmath33 with the constraints : @xmath34 , @xmath35 , @xmath36 .",
    "the emd is a metric , and hence the kernel is a true positive semi - definite kernel . in what follows ,",
    "we examine how svm classifier with this kernel performs in a task of classification of autism spectrum disorder versus typical development .",
    "we explore the performance of the proposed kernel using a publicly available ucla autism dataset ( described in @xcite ) .",
    "this dataset includes dti - based connectivity matrices of 51 high - functioning autism spectrum disorder ( asd ) subjects ( 6 females ) and 43 typically developing ( td ) subjects ( 7 females ) .",
    "average age ( standard deviation ) is 13.0 ( 2.8 ) for asd group and 13.1 ( 2.4 ) for td group .",
    "nodes are defined using parcellation scheme that is based on a large meta - analysis of functional mri studies combined with whole - brain functional connectivity mapping .",
    "this scheme produces 264 equal - size brain regions and thus 264@xmath37264 connectivity matrices .",
    "edges result from brain deterministic tractography .",
    "it is performed on voxelwise fractional anisotropy values using the fiber assignment by continuous tracking ( fact ) algorithm @xcite .",
    "edge weights in the original matrices are proportional to the number of streamlines detected by the algorithm .",
    "for each dataset , we apply three different weighting schemes . based on our previous findings@xcite",
    ", we expect that connectomes that capture information on both strength ( number of streamlines ) and lengths ( physical distances between brain regions ) of the connections are most useful for classification , at least for this particular task . for a purpose of comparison",
    ", we also consider weightings that only take into account either strength or distance .",
    "for the former , we take the original weighted connectivity matrices . for the latter , we first binarize original connectomes and than scale the existing edges by their lengths : @xmath38 where @xmath39 is the euclidean distance between centers of the regions @xmath40  and @xmath41",
    ". we use montreal neurological institute ( mni ) coordinates of region centers provided by the authors of the datasets to obtain the reasonable proxy of the distances between brain regions .",
    "third , we combine the two weighting schemes and produce connectomes with weights defined by : @xmath42    for each of the three weighting schemes , we next scale each matrix by the sum of its edge weights : @xmath43 .",
    "this scaling does not produce any changes in the spectra of the normalized laplacians ; hence , this step is not needed for our proposed pipeline .",
    "however , we also use `` bag of edges '' as the baseline features ( to be described in the next section ) , and we use scaling to enhance between - subject comparison based on these features .      for each of the three weighting schemes , we produce the normalized laplacians of the connectomes and compute their spectra .",
    "we next compute the emd - based kernels by , . to compute the pairwise emd between spectra we use an implementation that uses the original samples of points and",
    "does not require any data reduction .",
    "the kernels are then fed to the svm .",
    "the regularization parameter of the svm classifier is fixed at 0.1 , 1 , 10 , and 50 .",
    "we report the results obtained for the models with the best value of this penalty parameter .",
    "we use two different approaches to produce baseline classification quality .",
    "first , we use the same eigenvalues of the normalized laplacians and treat them as feature vectors .",
    "we run linear kernel svm on the vectors of eigenvalues .",
    "the regularization parameter of the svm classifier is fixed at the same values as above .",
    "second , we vectorize each weighted adjacency matrix by taking the values of its upper triangle ( the so - called `` bag of edges '' ) and use these vectors as baseline features .",
    "again , we run linear kernel svm on these features with the penalty parameter fixed at the same values as above .",
    "we use the roc auc to assess the predictive quality of the algorithms .",
    "we use 10-fold cross - validation and combine predictions on all test folds to estimate the classification quality on the entire sample .",
    "we repeat this procedure 100 times with different 10-fold splits , thus producing 100 roc auc values .",
    "we use python 2.7 and ipython notebooks platform , specifically numpy , scipy , pandas , matplotlib , scikit - learn @xcite , and pyemd @xcite libraries .",
    "all scripts will be available at https://github.com/yuliad/bacon-2016 .",
    "we first plot spectral distributions of the connectomes in figure 2 .",
    "we use the group average asd and td matrices with the combined weights , compute the associated @xmath44 and its spectrum . to produce the plots , we convolve the eigenvalues with a gaussian kernel ; that is , we plot the function : @xmath45 .",
    "we use @xmath46 . for purpose of illustration",
    ", we also produce three random graphs and plot their respective spectra in figure 2 .",
    "the first one is the erd@xmath47s - r@xmath48nyi ( er ) graph for which the required number of connections is produced randomly .",
    "the second random graph is based on the barab@xmath49si - albert ( ba ) preferential attachment model .",
    "the third graph is the watts - strogatz ( ws ) network with small - world properties ( the rewiring probability is set to 0.2 ) .",
    "the number of nodes and edges in these random graphs is set equal to that of the group average matrix of the real dataset .",
    "the plotting algorithm is the same as for the actual matrices .",
    "the plots produced for the human brain connectivity matrices differ from the respective plots obtained for the random graphs . of the three random graph models ,",
    "the small - world ws model produces a spectral distribution most close to that of the connectomes .",
    "empirical distributions based on human brain networks are close to those of the cat , macaque and c. elegans described by @xcite .",
    "our plots exactly follow their description of the respective plots observed for the non - human connectomes : ( 1 ) the spectra are skewed to the left with the largest eigenvalue much closer to one than the smallest eigenvalue ; ( 2 ) the distributions show a peak close to one ; and ( 3 ) the smallest eigenvalues are scattered around a few small peaks at the beginning of the spectra . in general , this confirms an observation @xcite that spectral distributions of brain networks share similar properties .",
    "however , average asd and td spectral distributions are very close and almost coincide . at the same time",
    ", the distributions of the normalized laplacian eigenvalues of the individual connectomes shown in figure 2 largely vary .",
    "figure 3 shows the classification results of the svm with the emd - based kernel on graph spectra , the linear kernel on graph spectra , and the linear kernel on the `` bag of edges '' .",
    "interestingly , the linear classifier that works with the `` bag of edges '' slightly outperforms a similar classifier that works with the vectors of eigenvalues .",
    "this is surprising due to a huge dimensionality of the vectors of edges ( equal to the number of elements in the upper triangle of a connectivity matrix ) .",
    "this also shows that the eigenvalues of the normalized laplacian spectra per se do not help to represent connectome objects in a space where they would be separable .    for the weighting schemes that are based solely on the strengths of the network connections or their physical lengths none of the algorithms works satisfactorily .",
    "however , for a weighting scheme that incorporates information on both strengths and lengths of the connections , the proposed pipeline works well and clearly outperforms the baselines .",
    "the roc auc averaged over 100 runs of the algorithm is 0.706 , standard deviation is 0.022 .",
    "first , this partly confirms our previous finding that weighting connectomes by both the number of streamlines and the physical distances enhances classification quality .",
    "this might be because long streamlines are more prone to bias of the tractography algorithm ; downweighting long connections partly eliminates this bias .",
    "second , the classification quality obtained with the emd - based kernel svm is better than the average classification results obtained in our previous work @xcite using the probabilistic kernels .",
    "importantly , the emd - based kernel is certainly    , @xmath50 and @xmath51 refer to the matrices with the original weights and the weights obtained by and , respectively .",
    "each boxplot shows a distribution of roc auc values over 100 runs of the algorithm with different 10-fold splits . ]",
    "more robust in the sense that it does not require an intermediate step of density reconstruction but still allows to evaluate differences between the empirical eigenvalue distributions .",
    "figure 4 provides more details on how the emd - based svm classifier performed on our dataset .",
    "the roc curve is shown in the left .",
    "the middle plot shows a gram matrix obtained by , ; the submatrices for the asd and td subjects are in the lower left and upper right squares , respectively .",
    "this matrix suggests that the asd subjects are somewhat closer to each other , while the td group shows larger variability in pairwise difference values . in line with this",
    ", the right plot in figure 4 shows that our algorithm performs quite well identifying asd subjects ( average recall value over 100 runs of the algorithm is 0.737 , standard deviation is 0.025 ) . at the same time , the algorithm somewhat tends to classify td subjects as pathological ( average precision value is 0.670 , standard deviation is 0.019 ) .",
    "we propose an algorithm that uses eigenvalue distributions of the normalized laplacian spectra of structural brain networks to classify normal and pathological development based on connectomes .",
    "we compute pairwise distances between spectral distributions of connectomes using earth mover s distance ( emd ) , a metric that appears as a solution to the transportation problem .",
    "its main advantage over the previously explored probabilistic distances is that it takes into account the shapes of the spectral distributions and at the same time does not require density reconstruction from the empirical values .",
    "we compute a kernel based on this metric and run svm classifier with this kernel .",
    "we examine the performance of the proposed algorithm for a task of classification of autism spectrum disorder versus typical development based on a publicly available dataset .",
    "the best - performing svm classifier with the emd - based kernel outperformed the baselines and produced roc auc value of 0.71 .",
    "this study generally confirms that spectral distributions of the normalized laplacians capture some meaningful structural properties of brain networks which make them different from other network classes , and also suggests that spectral distributions of connectomes can help to distinguish normal and pathological brain development .",
    "still , further studies are needed to explore whether these findings can generalize to other classification tasks and , importantly , other schemes of network construction ( in terms of both definition of nodes and weighting of edges ) . also , in this study we only discussed structural connectomes ; spectral properties of functional brain networks are to be studied .",
    "4 wolfers , t. , buitelaar , j.k . , beckmann , c.f .",
    ", franke , b. , marquand , a.f . : from estimating activation locality to predicting disorder : a review of pattern recognition for neuroimaging - based psychiatric diagnostics .",
    "neurosci biobehav rev .",
    ", 57 , 328349 ( 2015 )                  dodonova , y. , korolev s. , tkachev a. , petrov , d. , zhukov , l. , belyaev , m. : classification of structural brain networks based on information divergence of graph spectra .",
    "machine learning for signal processing proceedings ( 2016 , accepted ) .",
    "rudie , j.d . ,",
    "brown , j.a .",
    ", beck - pancer , d. , hernandez , l.m . , dennis , e.l . , thompson , p.m. , et al .",
    ": altered functional and structural brain network organization in autism .",
    "neuroimage clin 2 , 7994 ( 2013 )      petrov , d. , dodonova , y. , zhukov , l. , belyaev , m. : boosting connectome classification via combination of geometric and topological normalizations .",
    "pattern recognition in neuroimaging proceedings ( 2016 , accepted )"
  ],
  "abstract_text": [
    "<S> in this paper , we tackle a problem of predicting phenotypes from structural connectomes . </S>",
    "<S> we propose that normalized laplacian spectra can capture structural properties of brain networks , and hence graph spectral distributions are useful for a task of connectome - based classification . </S>",
    "<S> we introduce a kernel that is based on earth mover s distance ( emd ) between spectral distributions of brain networks . </S>",
    "<S> we access performance of an svm classifier with the proposed kernel for a task of classification of autism spectrum disorder versus typical development based on a publicly available dataset . </S>",
    "<S> classification quality ( area under the roc - curve ) obtained with the emd - based kernel on spectral distributions is 0.71 , which is higher than that based on simpler graph embedding methods . </S>"
  ]
}