{
  "article_text": [
    "relativistic viscous hydrodynamics is a popular choice for modeling high - energy heavy - ion collisions .",
    "hydrodynamics is appropriate when collisions are sufficiently rapid to keep the various species moving with a single collective velocity and local kinetic temperature , and to keep the stress - energy tensor sufficiently isotropic to warrant a viscous treatment .",
    "however , these conditions are lost near the end of the reaction , when the various hadrons begin to cool separately and move with different collective velocities @xcite . the final stage of the reaction and the decoupling are then best modeled with a microscopic simulation , which in the limit of many particles , or with a high over - sampling , becomes equivalent to a boltzmann description .",
    "often these simulations are referred to as hadronic cascades .",
    "particles are emitted into the hadronic cascade through a hyper - surface separating the hydrodynamic region from the cascade .",
    "if the phase space density of a particle s of momentum @xmath0 at the boundary is @xmath1 , the number of particles emitted into the simulation side of the boundary through a hyper - surface element is given by the cooper - frye formula @xcite , @xmath2 here , @xmath3 is a small hyper - surface element .",
    "variations of the cooper - frye formula have been applied to numerous hybrid models @xcite . in each of these approaches",
    "the boltzmann equation is solved by sampling techniques , i.e. , rather than storing information for each phase - space element @xmath4 , one follows the evolution of sample particles chosen consistently with the phase space density . for sampling ratios of one ,",
    "the cascade is a one - to - one simulation of the hadronic stage . for higher sampling ratios ,",
    "the models approach the limit of a boltzmann equation . since hadronic cascades are modeling the low - density stage at the end of the collision where velocity gradients are reduced , sampling ratios of unity are nearly indistinguishable from the boltzmann limit .",
    "this is in contrast to the case of simulating the early partonic stage , where sampling ratios need to be of order 10 or more to approach the boltzmann limit @xcite .",
    "whether the sampling ratios are unity or not , one needs to generate particles into the cascade code consistently with the hydrodynamic description at the hyper - surface .    for a time - like element , @xmath5",
    ", one can consider the emission from a frame where the emission is simultaneous across the element and @xmath6 represents a volume element undergoing sudden emission .",
    "for a space - like element , one can choose a frame where the surface is stationary .",
    "in this frame @xmath7 represents the area of the element multiplied by the time of the emission . depending on the hyper - surface element , @xmath3 , and the particle s momentum @xmath8 ,",
    "the number @xmath9 can be either positive or negative .",
    "the positive contribution describes particles being fed into the cascade , whereas the negative contribution represents the backflow , i.e. those particles which leave the cascade region , cross the interface , and enter the hydrodynamic domain .",
    "both the positive and negative contributions are necessary if energy , momentum and charge are to be conserved across the interface .",
    "similar issues to those being discussed here in the context of a hydrodynamics / cascade interface have also been studied with regards to coupling a hydrodynamics directly to the vacuum , instantaneous freezeout , see for example @xcite .",
    "when coupling directly to the vacuum the stress - energy tensor is discontinuous , while with coupling to a boltzmann code , one can aim for a continuous description if the interface is performed at a sufficiently high density that collision rates justify the hydrodynamic description .",
    "most hadronic cascades ignore backflow .",
    "such codes apply a step function , @xmath10 , to eq .",
    "( [ eq : cooperfrye ] ) , and do nt erase particles from the simulation that flow backward across the boundary . for modeling of particles at mid - rapidity , it has been shown that the backflow is on the order of one half of one percent @xcite .",
    "however , it has been reported that the error grows to the level of several percent away from mid - rapidity @xcite .",
    "the purpose of this short paper is to introduce a method for correcting for backflow .",
    "the approach accounts for the backflow through the production and propagation of negative - weight particles .",
    "local conservation laws are exactly conserved in the limit of high sampling .",
    "the theoretical underpinnings of this approach are described in the next two sections .",
    "a hadronic cascade was altered to incorporate these changes , and a brief evaluation of the behavior is presented in the subsequent section along with conclusions about the approach . the appendix provides a description of the algorithm used to numerically sample the particle flow across the hydrodynamic / cascade interface .",
    "in order to apply the cooper - frye formalism of eq .",
    "( [ eq : cooperfrye ] ) one needs to first generate a list of hyper - surface elements , @xmath11 , where the index @xmath12 denotes each small element .",
    "formally , @xmath11 can be described as the portion of the hyper - surface that falls within a small four - volume element , @xmath13 .",
    "the surface is described by a criteria based on local properties , such as the temperature or density , and can be written parametrically as , @xmath14 where the function @xmath15 could be any quantity propagated through the hydrodynamic evolution , such as the particle or energy density .",
    "for instance , if the interface is chosen to occur at fixed temperature , @xmath16 , the location of the surface would be described by @xmath17 .",
    "the function should be defined such that one is inside the hydrodynamic region if @xmath18 and outside if @xmath19 .",
    "the hyper - surface element is then @xmath20 where @xmath21 is a step function .",
    "for example , if @xmath22 is defined by a surface of constant temperature , @xmath11 is parallel to @xmath23 .    for time - like elements , @xmath5",
    ", one can always consider the element in a frame where @xmath24 points purely in the time direction . in this frame",
    "the emission is simultaneous across the hyper - surface , and @xmath25 represents a small volume element . if @xmath26 the criteria @xmath22 is falling with time , e.g. the temperature is falling , and particles are being emitted into cascade region .",
    "the majority of the emission in heavy - ion collisions comes from such elements . for @xmath27 ,",
    "the criteria is rising , and the hydrodynamic region is absorbing the volume element .",
    "this can be understood by considering the sign of the @xmath28 term in the cooper - frye formula .",
    "having @xmath27 is unusual in a time - like element , because it is difficult to find an area where the density or temperatures are rising . even with lumpy initial conditions , the longitudinal expansion is driving the densities downward even in regions where two lumps are expanding into one another .    for space - like elements ,",
    "@xmath29 , one can always find a boost and rotation which point @xmath3 along the positive @xmath30 axis . in this frame",
    "the emission surface is temporarily stationary , and the emission @xmath9 is positive for particles with @xmath31 and negative for @xmath32 . if the flow velocity in this frame , @xmath33 , is greater than zero , there will more positive contribution than negative contribution . for explosive collisions",
    "this is usually the case .",
    "the negative contributions represent those particles flowing into the hydrodynamic region , i.e. , the backflow .",
    "both the positive and negative contributions are required to conserve charge .",
    "for instance , the charge that travels through an element , from the hydrodynamic to the cascade region between times @xmath34 and @xmath35 , is @xmath36 the first term vanishes from current conservation and the last two terms describe the difference between the net charges in the @xmath37 region at the two times .",
    "the net current density for all the hadron species @xmath38 can be written in terms of the phase space density as @xmath39 since the contributions from all momenta are required to construct the conserved current density at an position @xmath30 , one can not throw away the contributions to the cooper - frye formula from those momenta with @xmath40 without violating current conservation .",
    "similar expressions can be derived for the energy and momentum , thus showing that the negative contributions to the cooper - frye expressions are essential if one wishes to satisfy any of the conservation laws .    there",
    "exist numerous algorithms for finding the hyper - surface , depending on whether the initial conditions are lumpy or smooth , whether the calculation is one - dimensional , two - dimensional , or three dimensional , and depending on what sort of mesh is used to model the hydrodynamic expansion .",
    "a particularly robust algorithm that works for three - dimensional systems of arbitrary topology is described in @xcite .",
    "the output of hydrodynamic codes is a list of the hyper - surface elements , @xmath41 , their space - time coordinates , and any additional information required to reconstruct the phase space density , e.g. , the collective flow , temperature , densities , and anisotropies of the stress - energy tensor . for each @xmath42 within each @xmath43 , one can calculate the probability of creating a particle , @xmath9 .",
    "one then decides to create a particle with probability @xmath9 .",
    "an efficient algorithm for doing this is presented in the appendix .",
    "the issue of backflow occurs when @xmath9 is negative . in the field of relativistic heavy ions ,",
    "two approaches have been applied thus far .",
    "the first approach is simply to neglect the negative contribution . as mentioned in the introduction , this violates energy , momentum and charge conservation at the one percent level at mid - rapidity , and higher away from mid - rapidity .    a second method for handling the backflow has been to erase those particles from the cascade simulation that cross back into the hydrodynamic region .",
    "this requires storing the location of the hyper - surface from the hydrodynamic module for consideration by the cascade .",
    "this method would satisfy the conservation laws as long as the phase space density is continuous across the boundary .",
    "a strong discontinuity would suggest that the hydrodynamic treatment was not justified for the densities or temperatures that determined the interface , or that the viscous corrections to the stress - energy tensor in the hydrodynamic treatment is not consistent with the dynamics of a hadron gas . choosing a higher interface density or temperature , or better accounting for viscous effects , might solve the problem .",
    "for the purpose of this paper , we will assume that the phase space density is continuous , though with the recommendation that the continuity be better studied in the future .",
    "a more daunting problem with this approach comes from the book - keeping required to decide whether particles crossed the boundary .",
    "hydrodynamic approaches tend to use very small cells , on the order of 0.1 fm .",
    "particles would typically cross hundreds of such cell boundaries , with a very small fraction of such cell boundaries representing an interface with the hydrodynamic treatment .",
    "although there are a variety of algorithms used in cascades , it would seem that the majority of the numerical cost in performing the cascades might then be applied to tracking the backflow .",
    "given the field s interest in fluctuating ( lumpy ) initial conditions , the topology of the breakup surface could be complex , and could vary event - to - event .",
    "this makes it difficult to find a robust algorithm that avoids constantly checking for interface crossings .",
    "this approach was applied in @xcite but that was for a smooth , azimuthally symmetric , boost - invariant hydrodynamic treatment , where the hyper - surface could be represented by giving the radius of the transition hyper - surface as a function of time .",
    "a third scheme is presented here . instead of tracking particles relative to the interface",
    ", this scheme simulates the evolution of particles emitted with the negative weights , @xmath44 , from eq .",
    "( [ eq : cooperfrye ] ) .",
    "a weight of negative unity is originally assigned to such particles , whereas a weight of positive unity is assigned to particles emitted with @xmath45 .",
    "since the negative - weight particles are a small fraction of the overall particles , the additional numerical cost should be on the order of a few percent .",
    "the particles are then evolved through the cascade , but with the products of each collision being assigned weights as described below .",
    "when analyzing the final products for their impact on specific observables , each particle would contribute proportional to its weight .",
    "for instance , when incrementing a bin used to calculate spectra , a particle with weight of -1 would reduce the bin count by one .",
    "if the phase space density is continuous across the interface , the particles being scattered from the cascade region back into the hydrodynamic region should exactly cancel the negatively weighted particles emitted according to the cooper - frye formula .",
    "even if the phase space density turns out to be discontinuous , this method will still satisfy all the conservation laws .",
    "it is propagating the weights through the subsequent collisions where the weighting becomes complicated .",
    "if a pair of incoming particles each has a weight of positive unity , both incoming particles are removed from the particle list after the collision ( a weight of zero is assigned to the incoming particles ) and a weight of positive unity is assigned to each of the collision products .",
    "however , if the @xmath46 incoming particles have arbitrary weights , @xmath47 , both the new outgoing particles and incoming particles may need to be assigned post - collision weights if the conservation laws are to be satisfied .",
    "if the new weights assigned to the incoming particles are non - zero , those particles can not be deleted from the particle list after the collision .",
    "the weights for the @xmath48 outgoing particles ( those that are newly created or are scattered into new momentum states ) , are labeled @xmath49 , and are all set to the product of the weights of the incoming particles , @xmath50 the weights for the scattered or newly created particles are all equal to the product of the incoming weights .",
    "this ensures that if any of the incoming weights are changed by a factor @xmath51 , that the weight of each of the outgoing products is changed by the same factor . instead of being erased ,",
    "the incoming particles are assigned post - collision weights @xmath52 , @xmath53 if all the incoming weights are unity , @xmath54 for all @xmath38 , and the incoming particles can be erased . assigning non - zero post - collision weights to the incoming particles as prescribed in eq .",
    "( [ eq : weights2 ] ) ensures that conservation laws are enforced in each collision , @xmath55 given that the charge is conserved in the reaction , @xmath56 the conserved charge @xmath57 could just as easily refer to a continuous variable like momentum or energy .",
    "for the several simple process involving @xmath58 scatterings or @xmath59 decays , the weights of the outgoing particles are shown in eq.s [ eq : weights ] .",
    "each incoming particle is labeled @xmath60 , where @xmath61 refers to all information about the particle and its trajectory , while @xmath62 is its weight .",
    "the outgoing particles are similarly referenced , with @xmath63 referring to the particle s information .",
    "if all weights were unity , the weights could be ignored and the reactions would be described as @xmath64 .",
    "one can understand the weightings for each line of eq .",
    "( [ eq : weights ] ) from eq .",
    "( [ eq : weights1 ] ) . for example",
    ", one can consider a case where a positive - weight particle collides with a negative - weight particle , @xmath65 .",
    "the positive - weight particle should not have scattered since the negative - weight particle should not be there , plus the negative - weight particle is in principle canceling the effect of a spurious positive - weight particle that should have been erased from cascade for having re - entered the hydrodynamic region .",
    "thus , not only should particle-1 not scatter , one needs to correct for the fact that such particles sometimes scatter spuriously , which means the forward going track weight needs to go from 1 to 2 .",
    "the scattered tracks are given negative weight so that the cancel the effect of particle-1 scattering off a spurious track .",
    "similar arguments follow for each row in the list . if the phase space density is continuous across the border , the original negative weight tracks should exactly cancel the positive - weight tracks that would have been erased when reentering the hydrodynamic region if one were applying the second method described earlier . @xmath66    implementing the procedure described in eq .",
    "( [ eq : weights ] ) turns out to be non - tenable due to the growth in the weights of the outgoing products .",
    "for example , if two particles with weight 2 collide , the scattered particles would have weights of 4 . in practice , this lead to exponentially growing weights as a function of the number of collisions .",
    "in addition to the growing weights , the number of trajectories being considered increases since the incoming particles are often reweighted , rather than deleted . for",
    "a central au+au collision at the highest rhic energy , final - state weights would often exceed the numerical range of the computer , and the number of tracks would exceed the available memory . even if the simulation were allowed to finish , the high - weighted tracks would overwhelm the answer with noise .",
    "thus , the procedure needs to be modified so that the effects of scattering with non - unity - weighted particles is regulated .    to limit the growth and associated noise of heavily weighted tracks , the procedure described above",
    "was modified .",
    "particles were first divided into two sets : base particles and backflow tracer particles .",
    "the base particles are created and evolve exactly as if the backflow particles had never been included in the cascade .",
    "the tracer particles begin as the set of negative - weighted particles representing the backflow .",
    "they also include all the trajectories required to trace the influence of the backflow .",
    "tracer particles are allowed to interact with base particles , but are not allowed to collide with one another .",
    "for this reason the effect of the backflow is handled correctly to linear order in the backflow .",
    "since the fraction of backflow particles is unlikely to exceed a few percent , the error associated with this approximation should be on the order of a tenth of a percent or less .",
    "charge , energy and momentum is conserved in each collision as well as in the generation of the particles through the hydrodynamic / cascade boundary .",
    "all of the base particles are assigned weights of positive unity , whereas the tracer particles are allowed to have weights of @xmath67 .",
    "the weights for scattering processes needs to be assigned consistently with those given in eq .",
    "[ eq : weights ] .",
    "however , because collisions between two tracer particles is neglected , the list of interactions is abbreviated and given in eq .",
    "( [ eq : altreactionlist ] ) . for a collision between incoming particles",
    "whose momenta , position and charges are labeled by @xmath68 and @xmath69 while the outgoing particles are denoted by @xmath70 , the cascade must consider three cases .",
    "in the first case both particles are base particles and have weights of positive unity .",
    "such particles are described by the notation @xmath71 . in the second case ,",
    "one of the particles is a tracer particle with positive weight , @xmath72 , and in the third case one has a tracer particle of negative weight .",
    "@xmath73 for decays , @xmath74 , the outgoing decay products all have the same weights as the incoming particle , and are all either base or all tracer particles depending on whether @xmath61 is a base or tracer particle . for decays ,",
    "the original track is deleted .    from inspecting the three reactions in eq .",
    "( [ eq : altreactionlist ] ) one can see that the evolution of the base particles is exactly the same as it would be without the tracer particles , as there is no change to the base particles occurring when the base particle collides with a tracer particles .",
    "the tracer particles for the final states are all added into the equations on the right - hand sides of the last two expressions in eq .",
    "( [ eq : altreactionlist ] ) to make the reactions consistent with the weights in eq .",
    "[ eq : weights ] .",
    "for the two reactions involving tracer particles there are two outgoing particles that differ only by their weights or by whether they are tracer particles .",
    "since having two particles with the same trajectory would cause numerical problems , the second particle is translated randomly in relative rapidity in the case of bjorken boost invariance , or if boost invariance is not implemented , moved by a small random step in coordinate space .",
    "this procedure correctly reproduces the evolution described by the algorithm described in eq .",
    "[ eq : weights ] to first order in the backflow .",
    "however , for the @xmath75 processes described in eq .",
    "( [ eq : altreactionlist ] ) that involve an incoming tracer particle , the number of tracer particles triples from one to three .",
    "thus , if a large number of collisions occur the number or tracer particles quickly grows and the method can become noisy .",
    "for that reason , the scattering of tracer particles is curtailed once a tracer particle and its ancestors have suffered a number of collisions @xmath76 .",
    "this is accomplished by storing a number @xmath77 for each tracer particle .",
    "then , when a incoming tracer particle scatters according to the list in eq .",
    "( [ eq : altreactionlist ] ) , the number is incremented by one and assigned to all the tracer products of the final state .",
    "the sensitivity to the cutoff @xmath76 is shown in figure [ fig : fake ] .",
    "the figure shows results from a simulation of 100@xmath78 gev on 100@xmath78 gev au+au central au+au collisions at rhic . the hadronic cascade , b3d @xcite , modeled a longitudinally boost invariant system by describing hadrons with spatial rapidities between -1 and 1 with cyclic boundary conditions .",
    "the algorithm for modeling backflow described above was incorporated into the model with several values of @xmath76 . for @xmath76 set to zero , the backflow particles were created , but were not allowed to collide .",
    "after decays , the average number of backflow particles per collision was approximately 4.5 per event , a small fraction of the over 2300 final - state base particles .",
    "a typical hadron might collide two to three times per cascade event but backflow particles were likely to collide significantly more often due their being emitted into the dense hydrodynamic region .",
    "since the number of tracer particles triples with each collision , the number of tracer particles rises rapidly as a function of @xmath76 , as shown in the lower panel of fig .",
    "[ fig : fake ] , and by the time @xmath79 the number of final - state tracer particles exceeds the number of final - state base particles .     from a simulation of the central two units of rapidity in a 100@xmath78 gev on 100@xmath78 gev au+au collision ,",
    "the number of tracer particles , the additional particles required to model the effects of the backflow , is shown in the lower panel as a function of @xmath76 , which limits the amount of scattering the tracer particles can undergo . for @xmath80 backflow particles never scatter and only 4.5 particles are required",
    ". however , the effect of a scattering spreads over more and more particles as @xmath76 is increased , and by the time @xmath79 , the number of tracer particles is greater than the number of actual particles . the lower panel shows the net transverse energy carried by tracer particles in the final state .",
    "the effect saturates for large @xmath76",
    ". however , large @xmath76 is numerically more expensive and can introduce more statistical noise into the analysis .",
    ", scaledwidth=60.0% ]    for @xmath80 , the @xmath81 backflow particles carried nearly 2.2 gev of transverse energy , which subtracts from the net transverse energy of the event due to their negative weight .",
    "this is denoted by @xmath82 , @xmath83 and is shown in the upper panel of fig .",
    "[ fig : fake ] as a function of @xmath76 .",
    "once @xmath84 , tracer particles can have both positives and negative weights .",
    "the net transverse energy carried by the tracer particles then involves a large cancellation and can become noisy for large @xmath76 due to the large number of tracer particles . by letting the tracer particles scatter , the net transverse energy carried by the tracer particles",
    "is reduced by the longitudinal work done in the expansion .",
    "the quantity @xmath82 saturates for larger @xmath76 . the bulk of the correction for scattering is accounted for with just a few scatterings . for example , by setting @xmath85 , one simulates nearly 90% of the change of @xmath82 with little additional computational cost since the average number of tracer particles is only on the order of 100 .",
    "the backflow contribution from a cooper - frye interface between hydrodynamic and boltzmann / cascade models can indeed can be accounted for with the methods above .",
    "the method was shown to correctly account for the backflow in the limit that the backflow is sufficiently small so that the effects are linear in the backflow .",
    "additionally , a second approximation can be applied that limits the simulation of backflow to a finite number of scatterings .",
    "most of the secondary scattering effects occur in the first few scatterings , which allows one to impose the cutoff for small @xmath76 .",
    "this prevents the method from consuming significant additional numerical resources or from adding significant statistical noise to the output .",
    "even with @xmath80 , charge , energy and momentum flow through the interface is satisfied .",
    "this work was mainly motivated by the desire to find a method to account for backflow without requiring disproportionate resources to describe an effect whose impact is modest at best . at mid - rapidity in high - energy heavy - ion colliisons ,",
    "the number of particles traveling back into the hydrodynamic region is only a fraction of a percent of the total number of particles . for slightly lower energies , or away from mid - rapidity , that fraction might increase , though is unlikely to exceed a few percent .",
    "the method described here seems ideal for such cases .",
    "the method was implemented into the cooper - frye generator and cascade used in the code b3d .",
    "this code was designed to perform the same tasks as the hadronic cascade urqmd , but to be better suited for a high - energy and to be faster .",
    "b3d can generate particles from the hypersurface using the algorithms described in the appendix , and perform the hadronic cascade in approximately 0.25 seconds on a single core in a typical laptop .",
    "adding backflow corrections with @xmath85 slowed the code down by 3% and increased the size of the final - state data files by 5% .",
    "the results of fig .",
    "[ fig : fake ] show that using @xmath85 allows one to calculate the effects of the backflow to the @xmath86 level .",
    "given that backflow is a small effect , this may be more than sufficient for most purposes .",
    "for a small hyper - surface element @xmath3 , the number of particles emitted is @xmath87 aside from the factor of @xmath88 , the second line looks like the usual thermal emission .",
    "the primed quantities refer to momenta and phase space densities measured in the reference frame of the fluid , i.e. the frame where @xmath89 .",
    "this formula works for any @xmath90 , but for a monte carlo procedure it must be chosen large enough that @xmath88 never exceeds unity for any @xmath61 .",
    "efficiency is lost if it becomes larger than necessary .",
    "the choice above is the optimum value as it corresponds to the smallest acceptable value that keeps @xmath91 .      1 .",
    "choose particles according to a static thermal distribution with volume @xmath90 .",
    "the quantity @xmath92 should incorporate any viscous corrections .",
    "2 .   boost the particles by @xmath93 3 .   keep or reject the particle with probability @xmath88 .",
    "if rejected , continue to the next species .",
    "this procedure should be repeated for each species . however , volume elements tend to be small and there might be many species with small probabilities . rather than throwing random numbers for each species",
    "it is more efficient to implement the following algorithm :    1 .",
    "generate a series of thresholds separated by random amounts , @xmath94 , where @xmath95 generates a random number between zero and unity .",
    "this produces thresholds separated by lengths with probabilities @xmath96 .",
    "if one is at a position @xmath30 and one increments by @xmath97 , the chance of hitting a threshold is @xmath98 , independent of any previous threshold .",
    "2 .   thus one can make a cumulative sum for each species @xmath99 , @xmath100 where @xmath101 is the density in the rest frame of species @xmath102 .",
    "if @xmath103 crosses a threshold , one considers creating a particle as described above . if @xmath103 crosses two thresholds , one attempts to create two particles .    for each differential probability",
    "the chance of crossing a threshold will be independent of any other differential probability , so the emissions are independent , and thus poissonian .",
    "with this approach , the number of random numbers one generates in deciding whether to attempt creating a particle is the number of particles one would make if the weights , @xmath88 in eq .",
    "( [ eq : weightdef ] ) , were unity .",
    "this can be a significant improvement compared to throwing random numbers for each species ( perhaps over 300 ) in each volume element ( perhaps many millions ) .",
    "since one knows the total density of hadrons , @xmath104 , one can check to see whether @xmath105 crosses a threshold . if not , one can increment the running total in one swipe and avoid considering each species independently .",
    "this procedure assumes that you already know @xmath101 . for calculations where the interfaces is defined by a fixed temperature , and with @xmath106",
    ", one can calculate these densities once , and store them . for calculations with a variety of breakup densities , one might store an array of values .    [ [ generating - a - particle - with - the - thermal - phase - space - density - fbf - p . ] ] generating a particle with the thermal phase space density @xmath1 .",
    "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    in the absence of viscous corrections one can generate a particle in the fluid rest frame with the following algorithm .",
    "for a probability distribution @xmath107 , one can sample the distribution by taking the natural log of the product of three random numbers , i.e. @xmath108 , where @xmath109 are random numbers chosen uniformly between zero and unity . for a three - dimensional distribution of massless particles , the choice of coordinates is @xmath110 ^ 2}{[\\ln(r_1r_2r_3)]^2}.\\end{aligned}\\ ] ] to check that this works one can calculate the jacobian , @xmath111 for massive particles one can throw a fourth random number @xmath112 , and if @xmath113 , one repeats the procedure until one satisfies the additional condition .    unfortunately , this becomes inefficient for large masses , @xmath114 , because the probability of successfully satisfying the condition for @xmath112 becomes small for small @xmath115 . in that case one applies an alternative algorithm . for @xmath116",
    ", it was found that a more efficient method is based on the expression , @xmath117 where @xmath118 is the kinetic energy .",
    "the strategy is to generate @xmath119 ignoring the factor @xmath120 , then do a keep - or - repeat based on that weight . to generate a value of @xmath119 consistent with @xmath121 , one breaks up the factor @xmath122 into three terms , @xmath123 one",
    "first throws a random number @xmath124 and chooses which of the three terms to use as a distribution based on the integrated weights for each term , @xmath125 and @xmath126 .",
    "once one has picked a given term , one can pick @xmath119 as @xmath127 and @xmath128 respectively . with this value of @xmath119",
    ", one can now do a keep or repeat decision based on the weight @xmath129 .",
    "after @xmath119 is chosen , @xmath130 and @xmath131 can be picked with new random numbers , @xmath112and @xmath132 .",
    "viscous corrections can be applied according to @xcite .",
    "this involves transforming the momentum according to ( in the rest frame ) @xmath133 where @xmath134 is the shear tensor in the frame of the fluid , and @xmath135 is a constant chosen so that the generated distribution will indeed have the stress - energy tensor one wishes assuming that the viscous correction @xmath136 is much smaller than the pressure .",
    "this coefficient @xmath135 can be found analytically given the list of masses and spins of the hadrons @xcite . for @xmath137 ,",
    "the linear approximation is good to the one percent level or better in that it consistently reproduces the viscous correction @xmath134 according to @xmath138          h.  sorge , phys .",
    "b * 373 * , 16 ( 1996 ) [ nucl - th/9510056 ] .",
    "s.  pratt and j.  murray , phys .",
    "c * 57 * , 1907 ( 1998 ) . c.  anderlik , l.  p.  csernai , f.  grassi , w.  greiner , y.  hama , t.  kodama , z.  i.  lazar and v.  k.  magas _ et al .",
    "_ , phys .",
    "c * 59 * , 3309 ( 1999 ) [ nucl - th/9806004 ] .",
    "f.  cooper and g.  frye , phys .",
    "d * 10 * , 186 ( 1974 ) . c.  nonaka and s.  a.  bass , phys .",
    "c * 75 * , 014902 ( 2007 ) [ nucl - th/0607018 ] . c.  gale , s.  jeon , b.  schenke , p.  tribedy and r.  venugopalan , phys .",
    "* 110 * , 012302 ( 2013 ) [ arxiv:1209.6330 [ nucl - th ] ] .",
    "h.  song , s.  a.  bass , u.  heinz , t.  hirano and c.  shen , phys .",
    "c * 83 * , 054910 ( 2011 ) [ erratum - ibid .",
    "c * 86 * , 059903 ( 2012 ) ] [ arxiv:1101.4638 [ nucl - th ] ] .",
    "j.  novak , k.  novak , s.  pratt , c.  coleman - smith and r.  wolpert , arxiv:1303.5769 [ nucl - th ] .",
    "d.  molnar and m.  gyulassy , nucl .",
    "a * 697 * , 495 ( 2002 ) [ erratum - ibid .",
    "a * 703 * , 893 ( 2002 ) ] [ nucl - th/0104073 ] .",
    "s.  cheng , s.  pratt , p.  csizmadia , y.  nara , d.  molnar , m.  gyulassy , s.  e.  vance and b.  zhang , phys .  rev .",
    "c * 65 * , 024901 ( 2002 ) [ nucl - th/0107001 ] .",
    "p.  huovinen and h.  petersen , arxiv:1206.3371 [ nucl - th ] .",
    "s.  pratt and j.  vredevoogd , phys .",
    "c * 78 * , 054906 ( 2008 ) [ erratum - ibid .",
    "c * 79 * , 069901 ( 2009 ) ] [ arxiv:0809.0516 [ nucl - th ] ] .",
    "s.  pratt and g.  torrieri , phys .",
    "c * 82 * , 044901 ( 2010 ) [ arxiv:1003.0413 [ nucl - th ] ] ."
  ],
  "abstract_text": [
    "<S> methods for building a consistent interface between hydrodynamic and simulation modules is presented . </S>",
    "<S> these methods account for the backflow across the hydrodynamic / simulation hyper - surface . </S>",
    "<S> the algorithms are efficient , relatively straight - forward to implement , and account for conservation laws across the hyper - surface </S>",
    "<S> . the methods also account for the spurious interactions between particles in the backflow and other particles by following the subsequent impact of such particles . </S>",
    "<S> since the number of altered trajectories grows exponentially in time , a cutoff is built into the procedure so that the effects of the backflow are ignored beyond a certain number of collisions . </S>"
  ]
}