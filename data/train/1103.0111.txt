{
  "article_text": [
    "the model system usually considered for the description of the stationary configurations of sandpiles on a tray table is the monge - kantorovich type system of pdes @xmath2 ( see , e.g. , @xcite ) .",
    "the data of the problem are the flat surface of the table @xmath3 , the profile of the tray table @xmath4 , and the density of the source @xmath5 .",
    "the dynamical behavior of the granular matter is pictured by the pair @xmath6 , where @xmath7 is the profile of the standing layer , whose slope has not to exceed a critical value ( @xmath8 ) in order to prevent avalanches , while @xmath9 is the thickness of the rolling layer ( see figure  [ fig : sand ] ) .",
    "the condition @xmath10 corresponds to require that the matter runs down only in the region where the slope of the heaps is maximal . on the border of the table",
    "the standing layer fills the gap with the height @xmath4 , and the exceeding sand falls down . if @xmath11 , the model reduces to the open table problem , largely investigated in recent years ( see e.g.  @xcite and the references therein ) .        in the present paper",
    "we consider a more general system of pdes in the open , bounded and connected set @xmath12 @xmath13 in the unknowns @xmath14 , @xmath15 .",
    "the data are :    * @xmath16 , a compact convex set of class @xmath17 containing the origin in its interior , and its ( strictly convex ) polar set @xmath18 .",
    "the set @xmath19 appears in ( [ f : mkint ] ) by means of its gauge function @xmath20",
    ". moreover the closure of @xmath1 will be equipped with a ( possibly asymmetric ) geodesic distance @xmath21 given in terms of the gauge function @xmath22 of the polar set @xmath18 ( see section  [ s : extens ] ) ; * @xmath23 ; * @xmath24 , @xmath25-lipschitz function w.r.t .",
    "@xmath21 .",
    "this general version takes into account the possibility of homogeneous anisotropies , and can be applied , for example , to the bean s model for the description of the macroscopic electrodynamics of hard superconductors ( see @xcite , for the case @xmath11 and @xmath1 , @xmath19 smooth sets ) , and to optimal shape design ( see @xcite ) .",
    "s.  bianchini in @xcite proved that the lax ",
    "hopf function @xmath26 ( defined in ( [ f : lh ] ) below ) , coupled with an explicit @xmath27 solves ( [ f : mkint ] ) ( see theorem  [ f : bian ] ) .",
    "the function @xmath28 is constructed as follows .",
    "the set @xmath1 can be covered by a family of disjoint transport rays , and every @xmath29-component of a solution to ( [ f : mkint ] ) satisfies a first order linear ode along almost every ray .",
    "the function @xmath28 is then uniquely defined along each ray , by requiring that it vanishes at the final point .",
    "this procedure gives a solution to ( [ f : mkint ] ) , thanks to a disintegration formula for the lebesgue measure along the rays .    in this paper",
    "we shall provide a complete characterization of the solutions @xmath6 to ( [ f : mkint ] ) .",
    "starting from the fact that @xmath30 is a solution , we show that a pair @xmath6 is a solution if and only if both @xmath31 and @xmath32 are solutions , so that we can decouple the original problem ( see section  [ s : minimum ] ) .",
    "moreover , the admissible @xmath7-components are characterized as the solutions of a minimization problem which has an explicit minimal solution @xmath33 depending on the source term @xmath34 .",
    "since @xmath26 is the maximal solution of the problem , the uniqueness of the @xmath7-component corresponds to the case when @xmath35 .",
    "we prove that this can occur if and only if the final points in @xmath1 of the transport rays are contained in the support of the source @xmath34 ( see section [ s : uniqueu ] ) . concerning the @xmath29-component , in @xcite",
    "it is proved that every admissible @xmath29 has to vanish at the final points in @xmath1 of the transport rays .",
    "hence , by the very definition of @xmath28 , it is the unique @xmath29-component if the union @xmath36 of the rays with both endpoints on @xmath37 has null lebesgue measure .",
    "we shall prove that the converse is also true : if the set @xmath36 has positive lebesgue measure , we can construct a nontrivial function @xmath14 such that @xmath38 , so that the uniqueness of the @xmath29-component fails .",
    "these results generalize those in @xcite to the case when the reference set @xmath1 is possibly non regular , the boundary datum @xmath4 is possibly non - homogeneous , and the constraint @xmath19 is a possibly non - strictly convex set . in this case",
    "we have to use a completely different strategy with respect to the previous approaches .",
    "namely , if @xmath1 and @xmath19 are smooth enough , then it is possible to define a suitable notion of ( anisotropic ) curvatures of @xmath37 , and the analysis of solutions to ( [ f : mkint ] ) can be performed using the methods of differential geometry ( see , e.g. , @xcite ) . in the non - smooth case",
    "these methods do not work , and a different approach is needed , based on the techniques developed in optimal transport theory ( see @xcite ) .",
    "namely , system ( [ f : mkint ] ) can be understood as the pde formulation of an optimal transport problem with strictly convex cost function @xmath22 , assigned initial distribution @xmath39 and transport potential given by the lax - hopf function @xmath26 ( so that the final mass distribution @xmath40 is the measure concentrated on @xmath37 induced by the transportation of @xmath41 along the rays associated to @xmath26 ) . from this point of view",
    ", the minimization problem considered in section  [ s : minimum ] turns out to be the dual formulation of the monge problem ( see , e.g. , @xcite for an exhaustive presentation of this subject ) .",
    "a comment on the regularity assumption on @xmath19 is in order .",
    "namely , if @xmath19 is of class @xmath17 , then its polar set @xmath18 need not be of class @xmath17 , but it is strictly convex .",
    "it is well - known that the strict convexity of @xmath18 , which is the unit ball of the dual norm @xmath22 , allows non - trivial simplifications in the proofs ; for example , the direction of the transport rays coincides with @xmath42 almost everywhere in @xmath1 .",
    "related results in the case of a general possibly non - regular constraint @xmath19 can be found in @xcite .",
    "the paper is organized as follows . in section  [ s : prel ] we collect all the notation and preliminary results . in section  [ s : extens ] we recall some generalization of the mcshane s extension theorem for lipschitz functions with constrained gradient . these general results will be used for introducing the maximal and the minimal extension of the boundary datum @xmath4 consistent with the gradient constraint .",
    "section  [ s : existence ] is devoted to the statement of the problem , some remarks on the hypotheses , and the statement of the existence result due to s.  bianchini ( see ( * ? ? ?",
    "one of the main tools needed for proving the uniqueness results is the fact that ( [ f : mkint ] ) is the euler - lagrange necessary condition for a minimization problem with a gradient constraint .",
    "this property is proved in section  [ s : minimum ] .",
    "the necessary and sufficient conditions for the uniqueness of the solutions @xmath6 to ( [ f : mkint ] ) are proved in sections  [ s : unique ] and  [ s : uniqueu ] . as a byproduct of our analysis , with a little additional effort",
    ", we provide a complete description of the singular sets considered in this kind of optimal transport problems",
    ".    * acknowledgements . *",
    "the authors wish to thank the anonymous referee for valuable comments that have improved the presentation of the manuscript .",
    "the standard scalar product of @xmath43 will be denoted by @xmath44 , while @xmath45 will denote the euclidean norm of @xmath46 . concerning the segment joining @xmath46 with @xmath47 , we set @xmath48\\ } , \\qquad \\oray{x , y } : = \\cray{x , y}\\setminus\\{x , y\\}. \\ ] ]    given a set @xmath49 , its interior , its closure and its boundary will be denoted by @xmath50 , @xmath51 and @xmath52 respectively .",
    "a bounded open set @xmath53 ( or , equivalently , @xmath54 or @xmath55 ) is of class @xmath56 , @xmath57 , if for every point @xmath58 there exists a ball @xmath59 and a one - to - one mapping @xmath60 such that @xmath61 , @xmath62 , @xmath63 , @xmath64 .",
    "let us now fix the notation and the basic results concerning the convex set which plays the role of gradient constraint for the @xmath7-component in ( [ f : mkint ] ) .",
    "in the following we shall assume that @xmath65 let us denote by @xmath18 the polar set of @xmath19 , that is @xmath66 we recall that , if @xmath19 satisfies ( [ f : hypk ] ) , then @xmath18 is a compact , strictly convex subset of @xmath67 containing the origin in its interior , and @xmath68 ( see , e.g. , @xcite ) .",
    "the gauge function @xmath69 of @xmath19 is defined by @xmath70 it is straightforward to see that @xmath71 is a positively 1-homogeneous convex function such that @xmath72 .",
    "the gauge function of the set @xmath18 will be denoted by @xmath22 .",
    "the properties of the gauge functions needed in the paper are collected in the following theorem .",
    "[ t : sch ] assume that @xmath16 satisfies ( [ f : hypk ] ) .",
    "then the following hold :    \\(i ) @xmath71 is continuously differentiable in @xmath73 , and @xmath74",
    "\\(ii ) @xmath18 is strictly convex , and @xmath75    \\(iii ) for every @xmath76 , @xmath77 belongs to @xmath78 , and @xmath79    see @xcite , section 1.7 .    in what follows",
    "we shall consider @xmath67 endowed with the possibly asymmetric norm @xmath80 , @xmath43 .",
    "by theorem  [ t : sch](ii ) , the unit ball @xmath18 of @xmath22 is strictly convex but , under the sole assumption ( [ f : hypk ] ) , it need not be differentiable .",
    "moreover , the minkowski structure @xmath81 is not a metric space in the usual sense , since @xmath22 need not be symmetric ( for an introduction to nonsymmetric metrics see @xcite ) . finally , since @xmath18 is compact and @xmath82 , then the convex metric is equivalent to the euclidean one , that is there exist @xmath83 , @xmath84 such that @xmath85 for every @xmath86 .",
    "the main motivation for introducing the convex metric associated to @xmath22 is the fact that the sobolev functions with the gradient constrained to belong to @xmath19 are the locally 1-lipschitz functions with respect to @xmath22 , as stated in the following result .",
    "[ l : diseqrho ] let @xmath53 be a nonempty open set , and assume that the set @xmath87 satisfies ( [ f : hypk ] ) .",
    "let @xmath22 be the gauge function of @xmath18 .",
    "then the following properties are equivalent .",
    "* @xmath88 is a locally @xmath25-lipschitz function with respect to @xmath22 , i.e. @xmath89 * @xmath90 , and @xmath91 for a.e .",
    "@xmath92 .",
    "let @xmath7 be a locally 1-lipschitz function in @xmath93 with respect to the metric @xmath22 .",
    "then @xmath7 is locally lipschitz in @xmath93 , and if @xmath94 is a differentiability point of @xmath7 , by ( [ f : lipur ] ) we have @xmath95 hence @xmath96 for all @xmath97 , that is @xmath98 . since @xmath7 is a locally lipschitz function in @xmath93 with gradient in the bounded set @xmath19 , ( ii ) holds .",
    "conversely , let @xmath7 satisfy ( ii ) , and let @xmath99 .",
    "clearly , we can assume @xmath100 .",
    "let @xmath101 , and let @xmath102 be the cylinder of radius @xmath103 around the segment @xmath104 .",
    "let us choose @xmath105 such that @xmath106 .",
    "by ( ii ) there exists a set @xmath107 with @xmath108-lebesgue measure zero , such that for every @xmath109 , @xmath7 is absolutely continuous along the segment @xmath110 , and @xmath111 for a.e .",
    "@xmath112 $ ] .",
    "let @xmath113 , @xmath114 .",
    "then , for every @xmath115 , @xmath116 the conclusion now follows from the continuity of @xmath7 in @xmath93 , passing to the limit in @xmath117",
    ".    in the sequel we need to consider locally 1-lipschitz functions with respect to @xmath22 that agree with a given continuous boundary datum .",
    "this can be done only if the boundary values are compatible with the gradient bounds , and , in absence of assumptions on the regularity of the reference set , the compatibility condition concerns the variations of the data along every admissible path .",
    "here we introduce some notation for the curves , while the compatibility condition will be discussed in section  [ s : extens ] .",
    "[ d : gamma ] let @xmath118 be a nonempty compact set .",
    "for every @xmath119 , @xmath120 will denote the ( possibly empty ) family of absolutely continuous curves @xmath121\\to d$ ] such that @xmath122 and @xmath123 .",
    "for every absolutely continuous curve @xmath121\\to \\r^n$ ] , let us denote by @xmath124 its length with respect to the convex metric associated to @xmath22 , that is @xmath125    if @xmath126 is a compact subset of @xmath67 , by a standard compactness argument we have that if @xmath127 , then there exists a geodesic in @xmath126 joining @xmath128 to @xmath129 , i.e.  there exists a curve @xmath130 such that @xmath131 for every @xmath132 ( see e.g.  ( * ? ? ? * thm .",
    "4.3.2 ) , @xcite ) .",
    "for sake of completeness we briefly recall that any geodesic curve lying in the interior of @xmath126 is in fact a segment , due to strict convexity of @xmath22 .",
    "[ l : geoint ] let @xmath118 be a nonempty compact set .",
    "let @xmath119 be two points such that @xmath133 , and let @xmath134 be a geodesic . if @xmath135 for every @xmath136 , then the support of @xmath137 is the segment @xmath138 .",
    "by an approximation argument we can assume that @xmath139 so that @xmath140 for every @xmath141 $ ] .",
    "let @xmath142 , @xmath141 $ ] , be a parametrization of the segment @xmath138 .",
    "assume by contradiction that the support of @xmath137 is not the segment @xmath138 .",
    "since @xmath18 is strictly convex we have that @xmath143 .",
    "since the support of @xmath137 is contained in @xmath144 , there exists @xmath145 such that the support of @xmath146 is contained in @xmath144",
    ". then @xmath147 \\\\ & = ( 1-\\varepsilon)\\len{\\gamma } + \\varepsilon\\len{\\eta } < \\len{\\gamma } , \\end{split}\\ ] ] in contradiction with the minimality of @xmath137 .",
    "in this section , @xmath148 and @xmath126 will be two sets such that @xmath149 so that @xmath150 is an open ( possibly empty ) set .    for a given continuous function @xmath151 , we want to discuss the existence of a locally lipschitz extension of @xmath152 in @xmath126 with the gradient constrained to belong to a convex set @xmath19 .",
    "it is well known that , in the case @xmath153 , @xmath1 bounded open subset of @xmath67 , @xmath154 , and @xmath19 satisfying ( [ f : hypk ] ) , a necessary and sufficient condition for the existence of such an extension is @xmath155 where @xmath156 is the family of absolutely continuous curves @xmath121\\to \\overline{\\omega}$ ] such that @xmath157 for every @xmath158 , @xmath159 and @xmath160 ( see ( * ? ? ?",
    "* sect .  5 ) and @xcite ) .",
    "moreover , if @xmath1 has a lipschitz boundary , one can relax the above necessary and sufficient condition by taking paths in @xmath161 ( see @xcite ) .    in order to handle more general situations",
    ", we will consider a continuous function @xmath151 satisfying @xmath162 where @xmath163 is the family of curves introduced in definition  [ d : gamma ] .",
    "this condition can be rephrased in the setting of the length space @xmath164 , where @xmath165 $ ] is the ( possibly asymmetric ) distance defined by @xmath166 ( we refer to ( * ? ? ?",
    "2 ) for the basic properties of length spaces ; see in particular remark  2.2.6 for the extension to possibly asymmetric metrics . )",
    "namely , ( [ f : h4 ] ) is equivalent to requiring that @xmath152 is a @xmath25-lipschitz function with respect to the @xmath21 .    in the following lemma we recall the well known fact that ( [ f : h4 ] ) turns out to be a sufficient condition for the existence of minimal and maximal @xmath25-lipschitz extensions ( w.r.t .",
    "@xmath21 ) of @xmath152 . notice that ( [ f : h4 ] ) is no more a necessary condition , as it can be seen when @xmath126 is a closed segment in @xmath167 .",
    "[ l : genprop ] let @xmath148 , @xmath126 satisfy ( [ f : cd ] ) , let @xmath19 satisfy ( [ f : hypk ] ) , and let @xmath168 be a continuous function satisfying ( [ f : h4 ] ) . then the functions @xmath169 are continuous in @xmath126 , and @xmath170 in @xmath148 .",
    "moreover , @xmath171 and @xmath172 a.e .  in @xmath173 .    as a consequence of lemma  [ l : genprop ] ,",
    "the functions @xmath174 and @xmath175 belong to the functional space @xmath176 it should be noted that in the definition of @xmath177 the infimum is taken over all paths in @xmath126 joining @xmath178 to @xmath46 , while the supremum in the definition of @xmath175 is taken over all paths in @xmath126 joining @xmath46 to @xmath178 .",
    "this asymmetry is needed in order to construct exactly the maximal and the minimal elements of @xmath179 , as it is stated in lemma [ l : vischar ] below ( see ( * ? ? ?",
    "2.1 ) ) .",
    "[ d : visible ] given @xmath180 , we shall say that @xmath178 is a visible point for @xmath46 if the segment @xmath181 is entirely contained in the open set @xmath150 .",
    "we shall denote by @xmath182 the set of all visible points for @xmath46 , that is @xmath183 .",
    "[ l : vischar ] the functions @xmath174 , @xmath175 defined in ( [ f : psi ] ) are characterized in the following way : @xmath184 moreover @xmath185 for every @xmath186 .",
    "[ c : penduno ] let @xmath187 be a point of differentiability for @xmath174 ( resp .",
    "@xmath175 ) . then @xmath188 ( resp .",
    "@xmath189 ) belongs to @xmath190 .",
    "given @xmath187 , let @xmath191 be such that @xmath192 setting @xmath193 , the fact that @xmath194 and lemma [ l : diseqrho ] imply that @xmath195\\,.\\ ] ] then we have @xmath196 and hence @xmath197\\,.\\ ] ] if @xmath174 is differentiable at @xmath46 , ( [ f : linpsi ] ) implies that @xmath198 , so that @xmath199 on the other hand , by lemma  [ l : genprop ] , @xmath200 , hence @xmath188 belongs to @xmath190 .",
    "the proof for @xmath175 is omitted , since it is entirely similar .",
    "our main goal is to provide a full analysis of the monge - kantorovich system of pdes @xmath201 under the following assumptions :    * @xmath1 is a nonempty bounded connected open subset of @xmath67 , @xmath202 .",
    "* @xmath203 , @xmath5 a.e .  in @xmath1 .",
    "* @xmath69 is the gauge function of a set @xmath87 satisfying ( [ f : hypk ] ) .",
    "* @xmath204 is a continuous function , satisfying the condition @xmath205 where @xmath206 , \\overline{\\omega}):\\ \\gamma(0 ) = y,\\ \\gamma(1 ) = x \\right\\}\\,.\\ ] ]    in the first equation in ( [ f : mk ] ) we understand @xmath207 defined also at the origin since , by the third condition , @xmath208 a.e .  where @xmath209 .",
    "the functional setting for the unknowns @xmath6 in ( [ f : mk ] ) is @xmath210 , where @xmath211 and @xmath212    by a solution of ( [ f : mk ] ) we mean a pair @xmath213 satisfying @xmath214 and @xmath215 a.e .  in @xmath1 .",
    "let us define the lax - hopf function @xmath216 by @xmath217 which corresponds to the function @xmath174 defined in ( [ f : lh3 ] ) in the special case @xmath153 , @xmath218 , and @xmath219 ( observe that @xmath220 and @xmath221 ) .    as a consequence of lemmas  [ l",
    ": genprop ] , [ l : vischar ] , and corollary  [ c : penduno ] , we obtain the following result , which is well - known when @xmath1 is a lipschitz domain ( see e.g.  ( * ? ? ?",
    "* chap .  5 ) ) .",
    "[ t : genprop ] if ( h1 ) , ( h3 ) and ( h4 ) are fulfilled , then @xmath222 and @xmath223 a.e .  in @xmath1 .",
    "moreover , @xmath26 is the maximal element in @xmath224 , and it is characterized by @xmath225 where @xmath226 .    if @xmath11 , the lax ",
    "hopf function @xmath227 is the distance from @xmath228 with respect to the convex metric associated to @xmath22 , that is @xmath229 , @xmath230 ( see @xcite for a complete treatment of this subject ) .",
    "more generally , if @xmath231 satisfies @xmath232 the lax ",
    "hopf function @xmath26 coincides with @xmath233 namely , from ( [ f : onelip ] ) it is easy to check that @xmath234 on @xmath228 .",
    "moreover , from the representation formula ( [ f : lh2 ] ) it is clear that @xmath235 . on the other hand ,",
    "let @xmath236 and let @xmath237 be such that @xmath238 .",
    "let @xmath239 be such that @xmath240 . then , by the representation formula ( [ f : lh2 ] ) and by ( [ f : onelip ] ) we have that @xmath241 so that @xmath242 .",
    "the following example shows that if we merely require ( h4 ) , then in general @xmath243 .",
    "given @xmath244 let us define the set @xmath245 and let @xmath231 be defined by @xmath246 .",
    "if we choose @xmath247 , then @xmath248 for every @xmath249 , and @xmath124 is the usual ( euclidean ) length of a curve @xmath137 .",
    "a straightforward computation shows that @xmath4 satisfies ( h4 ) . on the other hand",
    ", it is also clear that @xmath4 does not satisfy ( [ f : onelip ] ) .",
    "namely , if we consider the two boundary points @xmath250 , @xmath251 , then we have @xmath252    in this case , the function @xmath253 defined in ( [ f : lh4 ] ) does not belong to @xmath224 , since @xmath254 and hence it does not achieve the boundary value at @xmath255 .",
    "we conclude this section with the following result due to s. bianchini ( see @xcite and @xcite for its generalization to the case of nonsmooth constraint sets @xmath19 ) .",
    "[ t : exv ] there exists a weak solution @xmath27 to the transport equation @xmath256    as a corollary of theorems  [ t : genprop ] and  [ t : exv ] we conclude that @xmath30 is a solution to ( [ f : mk ] ) .",
    "in this section we shall discuss the connection between the system of pdes ( [ f : mk ] ) and the variational problem @xmath257 it is clear that , since @xmath34 is non - negative and @xmath26 is the maximal element in @xmath224 , then @xmath26 is a solution to ( [ f : min ] ) . we shall show that ( [ f : mk ] ) is the euler - lagrange necessary and sufficient condition for the minimum problem ( [ f : min ] ) .",
    "this property , which is the analogous to the duality in mass transport theory , will be useful in the proofs of the uniqueness of the solutions of ( [ f : mk ] ) .    as a preliminary step ,",
    "we need to enrich the class of test functions allowed in ( [ f : weak ] ) .",
    "[ l : approx ] let @xmath258 , @xmath259 on @xmath228 .",
    "then there exists a sequence @xmath260 such that @xmath261 and @xmath262 a.e .  in @xmath1 , and @xmath263 , @xmath264 for every @xmath115 .",
    "we use a standard truncation argument .",
    "let @xmath265 such that @xmath266 for every @xmath267 , @xmath268 for @xmath269 , @xmath270 for @xmath271 , @xmath272 for every @xmath267 .",
    "let us define @xmath273 , so that @xmath274 pointwise in @xmath275 .",
    "moreover , @xmath276 , hence @xmath277 a.e .  in @xmath1 and @xmath278 .",
    "let @xmath279 be the standard family of mollifiers in @xmath67 .",
    "since @xmath280 has compact support in @xmath1 , we can choose a sequence @xmath281 , such that the sequence @xmath282 has the required properties .",
    "[ c : density ] @xmath283 is dense in the space @xmath284 with respect to the weak@xmath285 topology of @xmath286 . as a consequence ,",
    "if @xmath213 satisfies ( [ f : weak ] ) , then @xmath287    we are now in a position to prove that the monge - kantorovich system ( [ f : mk ] ) is the euler - lagrange condition for the minimum problem ( [ f : min ] ) .    [",
    "t : equiv ] the minimum problem ( [ f : min ] ) and the system of pdes ( [ f : mk ] ) are equivalent in the following sense .",
    "* @xmath288 is a solution to ( [ f : min ] ) if and only if there exists @xmath289 such that @xmath6 is a solution to  ( [ f : mk ] ) .",
    "* let @xmath288 be a solution to  ( [ f : min ] ) .",
    "then @xmath6 is a solution to  ( [ f : mk ] ) if and only if @xmath32 is a solution to  ( [ f : mk ] ) .",
    "let us denote by @xmath290 the indicator function of the set @xmath19 , that is @xmath291 so that @xmath292\\ , dx = -\\int_{\\omega}fu\\ , dx , \\qquad \\forall u\\in \\spacex\\,.\\ ] ] since @xmath71 is differentiable in @xmath293 , the subgradient of the indicator function can be explicitly computed , obtaining @xmath294 ( see e.g.  ( * ? ? ?",
    "23 ) ) .    hence ,",
    "if @xmath6 is a solution to ( [ f : mk ] ) , then @xmath295 for a.e .",
    "@xmath236 , so that , for every @xmath296 @xmath297 where the last equality follows from corollary  [ c : density ] .",
    "this proves that @xmath7 is a solution to ( [ f : min ] ) .",
    "assume now that @xmath288 is a minimizer for @xmath298 , so that @xmath299 a.e .  in @xmath1 ,",
    "due to the maximality of @xmath26 in @xmath224 and the fact that @xmath5 . by corollary",
    "[ c : density ] we can choose @xmath300 as test function in the transport equation ( [ f : dive ] ) solved by @xmath26 , getting @xmath301 on the other hand , by theorem [ t : sch](ii ) and the fact that @xmath302 a.e .  in @xmath1 , we have @xmath303 so that @xmath304 and @xmath305 a.e .  in @xmath1 , that is @xmath31 is a solution of ( [ f : mk ] ) .",
    "this concludes the proof of ( i ) .",
    "let us prove ( ii ) .",
    "the previous computation shows that if @xmath306 is a solution of ( [ f : mk ] ) , and @xmath288 is a solution of the minimum problem ( [ f : min ] ) , then also @xmath6 is a solution of ( [ f : mk ] ) .",
    "finally , let @xmath6 be a solution to ( [ f : mk ] ) . upon observing that @xmath307 a.e .  in @xmath1 , and choosing @xmath300 as test function in the weak formulation of the transport equation @xmath308",
    "we conclude that the opposite implication holds .",
    "thanks to theorem  [ t : equiv](ii ) , the uniqueness of the @xmath29 component of the solution of the system of pdes ( [ f : mk ] ) will follow from the fact that the function @xmath309 introduced in theorem [ t : exv ] is the unique weak solution in @xmath310 of the equation @xmath311    we shall use an explicit representation of @xmath309 proved in @xcite and , in order to explain it , we need to introduce some additional tools , related to the directions where the function @xmath26 has the maximal slope .    recalling the representation formula ( [ f : lh2 ] ) for @xmath26 , for every @xmath312 let us define the projections of @xmath46 by @xmath313 and , for every @xmath236 , let @xmath314 be the set of directions through @xmath46 @xmath315",
    "let @xmath316 be the set of points with multiple projections , that is @xmath317 and for every @xmath318 , let @xmath319 and @xmath320 denote the unique elements in @xmath321 and @xmath314 respectively .",
    "finally , let @xmath322 be defined by @xmath323\\ } , & x\\in \\omega\\setminus d\\ , , \\\\ 0 & x\\in d\\ , , \\end{cases}\\ ] ] and let @xmath324 be the set @xmath325 where we understand that @xmath326 if @xmath180 .",
    "we shall call _ transport ray _ through @xmath236 any segment @xmath327 , @xmath328 .",
    "it is clear from the definition that , if @xmath318 , then there is a unique transport ray @xmath329 through @xmath46 . on the other hand , if @xmath180 , any segment @xmath330 , with @xmath328 , is a transport ray through @xmath46 .",
    "the transport rays correspond to the segments where @xmath26 grows linearly with maximal slope , as stated in the following lemma .",
    "hence in the sandpiles model , they correspond to the directions where the matter is allowed to run down , that is where the @xmath29component could be nonzero .",
    "[ l : prunica ] for every @xmath236 and @xmath331 we have @xmath332 moreover , if @xmath333 , then @xmath334    the identity ( [ f : ulin ] ) follows from ( [ f : linpsi ] ) , while ( [ f : ulin2 ] ) for @xmath333 follows from ( [ f : ulin ] ) when @xmath335 , and from the very definition of @xmath336 when @xmath337 .",
    "[ l : project ] given @xmath318 , let @xmath329 be the transport ray through @xmath46 .",
    "then @xmath338 for every @xmath339 .    from ( [ f : ulin2 ] ) it is clear that @xmath340 for every @xmath341 .",
    "assume by contradiction that there exists @xmath339 such that @xmath342 contains a point @xmath343 .",
    "we claim that the three points @xmath47 , @xmath344 and @xmath336 can not be aligned .",
    "namely , we can not have @xmath345 , for otherwise we would have @xmath346 . on the other hand",
    ", we can not have @xmath347 : indeed , in this case , by ( [ f : ulin2 ] ) we would have @xmath348 , while , by ( [ f : ulin ] ) , we know that @xmath349 . putting together these information , we get @xmath350 a contradiction .    since the curve @xmath351 , joining @xmath47 to @xmath336 and lying in @xmath1 except for its endpoints , is not a segment , by lemma  [ l : geoint ] it can not be a geodesic , so that @xmath352 taking into account ( [ f : ulin2 ] ) we get @xmath353 a contradiction with @xmath354 .    at this stage",
    "we are dealing with three meaningful sets of singular points associated to @xmath26 :    * the sets of points in @xmath1 where @xmath26 is not differentiable ; * the sets of points in @xmath1 with multiple projections ; * the set of endpoints in @xmath1 of the transport rays .",
    "the set @xmath324 plays a central role in optimal transport theory . as a matter of fact ,",
    "the disintegration of the lebesgue measure in the reference set @xmath1 along transport rays , can be achieved only if @xmath324 has lebesgue measure zero , and this is one of the main tools of the theory .",
    "if @xmath1 and @xmath19 are sufficiently smooth ( e.g.  both of class @xmath355 , and @xmath19 with strictly positive curvatures ) , one can prove that @xmath126 coincides with @xmath356 ( see , e.g. @xcite ) , so that , by rademacher s theorem , @xmath126 has zero lebesgue measure .",
    "moreover , using the methods of differential geometry , it is possible to prove that @xmath357 and to characterize @xmath358 in terms of optimal focal points . as a consequence one can prove that @xmath324 has zero lebesgue measure and give detailed rectifiability results ( see , e.g. , @xcite )",
    ".    if @xmath1 and @xmath19 are not regular , the set @xmath359 may have positive lebesgue measure ( see @xcite for an example where @xmath360 , @xmath361 , and @xmath19 is the unit ball ) , and @xmath324 can be a proper subset of @xmath359 .",
    "we recall here some known properties of the singular sets , adding some remarks in order to complete the description of the relationships between these sets .",
    "the known results , proved in @xcite , are collected in the following proposition .",
    "[ p : d ] the sets @xmath356 , @xmath126 and @xmath324 satisfy the following properties .",
    "* @xmath362 .",
    "more precisely , if @xmath26 is differentiable at @xmath236 , then @xmath46 has a unique projection and @xmath363 .",
    "* the set @xmath324 has zero lebesgue measure .",
    "* @xmath126 is a @xmath108 rectifiable set .",
    "[ r : exa ] we recall that @xmath364 if @xmath19 is strictly convex . proposition [ p : d](i ) states that @xmath362 , in general .",
    "the following example shows that it can happen that @xmath365 .",
    "let us consider the set @xmath366 and let @xmath19 be its polar set .",
    "the set @xmath18 is strictly convex but it is not of class @xmath17 , hence the set @xmath19 is of class @xmath17 but it is not strictly convex ( see theorem [ t : sch ] ) .",
    "let @xmath1 be the hexagon @xmath367 ( see figure  [ fig : exa ] ) . the lax ",
    "hopf function @xmath227 associated to @xmath19 and to the boundary datum @xmath11 is the distance function to the boundary of @xmath1 with respect to the convex metric @xmath22 , which can be explicitly computed as @xmath368 so that @xmath369 .     and",
    "@xmath18 of example  [ r : exa],height=151 ]    since @xmath126 is a subset of @xmath324 , then by proposition  [ p : d](ii ) it has lebesgue measure zero .",
    "notice that @xmath126 can be a proper subset of @xmath324 even in the regular case .",
    "for example , let @xmath1 be the ellipsis @xmath370 , where @xmath371 , and let @xmath372 .",
    "the points @xmath373 and @xmath374 are the centers of curvature of @xmath228 at @xmath375 and @xmath376 respectively",
    ". it can be checked that @xmath377 whereas @xmath378 .    moreover , since @xmath324 need not be closed ( see ( * ? ? ?",
    "* remark 5.2 ) ) , @xmath379 in general .",
    "the following proposition shows that @xmath380 .",
    "[ p : bu ] for every @xmath381 we have that @xmath382 , where @xmath383 is the function defined in ( [ f : tau ] ) .",
    "let us fix @xmath384 .",
    "we can assume without loss of generality that @xmath385 , and @xmath386 , @xmath387 .",
    "since the map @xmath388 is continuous in the open set @xmath389 ( see ( * ? ? ?",
    "3.2 ) ) , there exists @xmath105 such that @xmath390 , and @xmath391 for every @xmath392 .",
    "given @xmath393 , let us define the function @xmath394 by @xmath395 so that @xmath396 . hence @xmath152 maps @xmath397 into the hyperplane @xmath398 .",
    "the continuity of @xmath399 in @xmath397 ensures that we can choose @xmath400 in such a way that @xmath401 for every @xmath402 .    summarizing",
    ", @xmath403 is a continuous map , @xmath404 , and @xmath405 belongs to the ray @xmath406 .",
    "moreover , for every @xmath407 , we have that @xmath408 , hence @xmath409 and , by corollary  [ l : project ] , we infer that @xmath410 .    since @xmath152 maps @xmath411 into the @xmath108-dimensional hyperplane @xmath412 , by the borsuk ",
    "ulam lemma ( see ( * ? ? ?",
    "* cor .  4.2 ) ) there exists @xmath413 such that @xmath414 .",
    "furthermore @xmath415 , so that the equality @xmath414 implies that @xmath416 i.e. , @xmath417 is parallel to @xmath418 .",
    "but the transport ray through @xmath417 and @xmath419 contains the origin , hence @xmath420 and @xmath421 .    for the reader",
    "s convenience we collect here the results concerning the relationships between the singular sets .",
    "the sets @xmath356 , @xmath126 and @xmath324 have zero lebesgue measure .",
    "moreover , @xmath422 and @xmath423 , with possibly strict inclusions .",
    "we are now in a position to briefly recall the explicit representation of the function @xmath309 appearing in ( [ f : dive ] ) , one of the main results in @xcite .",
    "[ f : bian ] there exists a positive function @xmath424 , absolutely continuous along almost every transport ray , such that an explicit solution @xmath27 of  ( [ f : dive ] ) is given by @xmath425 more precisely , for a.e .",
    "@xmath333 the function @xmath28 is locally absolutely continuous along the ray @xmath426 , @xmath427 , and satisfies @xmath428 = - f(x+t d(x))\\ , \\alpha(x+t d(x)),\\\\ \\displaystyle \\lim_{t\\to \\tau(x)^- } \\vf(x+t d(x))\\ , \\alpha(x+t d(x ) ) = 0 .",
    "\\end{cases}\\ ] ]    see @xcite , theorems  5.7 and  7.1 .",
    "the reader may want to compare the representation formula  ( [ f : vf ] ) with the one proved in the regular homogeneous case ( see @xcite ) , where @xmath429 can be explicitly written in terms of the distance from the boundary @xmath430 and of the anisotropic curvatures @xmath431 of @xmath228 at @xmath319 .",
    "more precisely , one has @xmath432 , \\qquad x\\in\\omega\\setminus d\\,.\\ ] ]    we shall find a necessary and sufficient condition for having that @xmath28 is the unique solution to ( [ f : divei ] ) .",
    "the following example shows why the uniqueness of the @xmath29-component may fail .",
    "[ e : square ] let @xmath433 , @xmath372 , and let @xmath434 on @xmath37 , so that @xmath435 in @xmath1 .",
    "then every function of the form @xmath436 , @xmath437 for @xmath438 $ ] , is a non - negative solution of the equation @xmath439 .",
    "notice that in this case @xmath440 in @xmath1 , so that  ( [ f : divei ] ) has infinitely many solutions of the form @xmath441 , with @xmath442",
    ". the existence of non - trivial variations of @xmath28 is due to the fact that @xmath1 is covered by transport rays with both endpoints on @xmath228",
    ".    now it should be clear that , in order to discuss the uniqueness of the @xmath29component of the solutions to  ( [ f : divei ] ) , we need to introduce the set @xmath443 where the set @xmath444 is defined by @xmath445    in example  [ e : square ] , @xmath446 and @xmath447 .",
    "in general @xmath36 is the union of the transport rays ending on @xmath228 . on this",
    "set every function in @xmath224 is forced to have maximal slope and hence to coincide with @xmath26 .",
    "[ l : sinray ] let @xmath448 be given . then the following hold .",
    "* @xmath449 and @xmath450 for every @xmath451 . * if @xmath452 , then @xmath453 for every @xmath454 . as a consequence every @xmath288 coincides with @xmath26 on the set @xmath36 .",
    "let us start by proving that @xmath328 for every @xmath451 .",
    "namely @xmath455 where the last inequality follows from lemma  [ l : diseqrho ] . hence @xmath456",
    ", so that @xmath328 .",
    "actually we can prove that @xmath457 for every @xmath451 using the same argument of the proof of corollary  [ l : project ] : if there exists @xmath458 , @xmath459 , then the three points @xmath460 , @xmath46 and @xmath461 can not be aligned , so that @xmath462 and @xmath463 a contradiction .",
    "since @xmath464 and , for every @xmath465 , @xmath466 , it is clear that @xmath467 .    finally , let @xmath468 and @xmath454 be given . then , using lemma  [ l : diseqrho ] we get @xmath469 and ( ii ) follows .",
    "[ t : uniqv ] the function @xmath28 defined in  ( [ f : vf ] ) is the unique solution of ( [ f : divei ] ) if and only if the set @xmath36 has zero lebesgue measure .",
    "the uniqueness of @xmath28 when @xmath36 has zero lebesgue measure is proved in ( * ? ? ?",
    "the proof is based on the fact that every weak solution @xmath14 to  ( [ f : divei ] ) is locally absolutely continuous along almost every transport ray , and satisfies @xmath470 = - f(x+t d(x))\\ , \\alpha(x+t d(x))\\,.\\ ] ] moreover , if the endpoint @xmath336 of the transport ray through @xmath46 belongs to @xmath1 , the @xmath471 satisfies the initial condition @xmath472 so that , by theorem  [ f : bian ] , @xmath473 along that ray .",
    "let us now assume that @xmath36 has positive lebesgue measure .",
    "it is clear that the function @xmath474 is the lax - hopf function corresponding to the geometry induced by the convex set @xmath475 and the boundary datum @xmath476 .",
    "assume that @xmath26 and @xmath477 are differentiable at a point @xmath465 , with @xmath448 .",
    "from proposition  [ p : d ] we have that @xmath478 .",
    "the same argument , used with @xmath476 as boundary datum and the geometry induced by @xmath475 , shows that @xmath479 where @xmath480 and @xmath481 denote respectively the gauge functions of the convex sets @xmath475 and @xmath482 .",
    "let us consider the indicator function of the set @xmath36 , @xmath483 by theorem [ t : exv ] , there exist two nonnegative functions @xmath484 , @xmath485 such that @xmath486 looking at the explicit representations of @xmath484 and @xmath485 as in  ( [ f : vf ] ) , we easily get @xmath487 so that , for every @xmath488 , we obtain @xmath489 hence for every @xmath490 the function @xmath491 is a non - negative weak solution to  ( [ f : divei ] )",
    ".    it can be easily checked that if the datum @xmath4 satisfies ( h4 ) with strict inequality holding for every @xmath492 , then the lebesgue measure of @xmath36 is zero , so that @xmath28 is the unique @xmath29-component allowed in ( [ f : mk ] ) .",
    "if the lebesgue measure of @xmath493 is zero , then by lemma  [",
    "l : sinray ] we have that @xmath494 .",
    "on the other hand , it can be easily checked that the converse implication is also true . in @xcite",
    "( see also @xcite ) it is proved that either @xmath495 or there exists a weak solution @xmath496 to @xmath497 such that @xmath498 a.e .  in @xmath1 . in the proof of theorem  [ t : uniqv ]",
    "we have shown that , as soon as @xmath36 has positive lebesgue measure , it is possible to construct a solution @xmath14 to  ( [ f : homo ] ) such that @xmath499 a.e .",
    "on @xmath36 .",
    "in theorem  [ t : equiv ] we have shown that the set of admissible @xmath7-components of the solutions to ( [ f : mk ] ) coincides with the set of solutions to the minimum problem ( [ f : min ] ) .    in this section",
    "we shall construct , using lemma  [ l : genprop ] , the minimal solution to ( [ f : min ] ) , and we shall give a necessary and sufficient condition in order to have that this function equals the maximal solution @xmath26 in @xmath1 .",
    "the function @xmath33 is the function @xmath175 defined in ( [ f : psi ] ) corresponding to @xmath153 , @xmath513 , and @xmath514 on @xmath148 .",
    "clearly the function @xmath152 satisfies ( [ f : h4 ] ) on @xmath148 , since @xmath26 satisfies that condition on @xmath275 .",
    "then the stated properties follow from lemmas  [ l : genprop ] , [ l : vischar ] and  [ l : sinray ] .",
    "a function @xmath288 is a solution to  ( [ f : min ] ) if and only if @xmath515 .",
    "moreover , the function @xmath33 coincides with @xmath26 in @xmath1 ( and hence @xmath26 is the unique solution to ( [ f : min ] ) ) if and only if @xmath516 .",
    "the first assertion follows from proposition  [ p : uf](iii ) and from the fact that @xmath288 is a solution to ( [ f : min ] ) if and only if @xmath511 on @xmath502 .",
    "let us prove the uniqueness result .",
    "assume that @xmath516 , so that @xmath517 and , from proposition  [ p : uf](ii ) , @xmath518 on @xmath324 .",
    "let @xmath519 be given , and let @xmath520 be the endpoint of the ray through @xmath46 .",
    "we have @xmath521 and hence @xmath509 .",
    "assume now by contradiction that @xmath35 in @xmath1 and that there exists @xmath522 such that @xmath523 .",
    "let @xmath524 and @xmath525 be such that @xmath526 notice that @xmath527 , otherwise we get @xmath528 . hence @xmath94 , @xmath47 and @xmath344 are three distinct points .",
    "moreover we have that @xmath529 , otherwise by lemma  [ l : geoint ] we should have @xmath530 and @xmath531 a contradiction .",
    "cannarsa , p. cardaliaguet , g. crasta , and e. giorgieri , _ a boundary value problem for a pde model in mass transfer theory : representation of solutions and applications _ , calc .",
    "partial differential equations * 24 * ( 2005 ) , 431457 .",
    "cannarsa and c. sinestrari , semiconcave functions , hamilton - jacobi equations and optimal control , progress in nonlinear differential equations and their applications , vol .",
    "58 , birkhuser , boston , 2004 .",
    "gromov , metric structures for riemannian and non - riemannian spaces , english ed .",
    ", modern birkhuser classics , birkhuser boston inc . ,",
    "boston , ma , 2007 , based on the 1981 french original , with appendices by m. katz , p. pansu and s. semmes , translated from the french by sean michael bates .",
    "mr mr2307192 ( 2007k:53049 )        li and l. nirenberg , _ the distance function to the boundary , finsler geometry and the singular set of viscosity solutions of some hamilton  jacobi equations _ , commun .",
    "pure appl .  math .",
    "* 58 * ( 2005 ) , 85146 .",
    "villani , optimal transport , grundlehren der mathematischen wissenschaften [ fundamental principles of mathematical sciences ] , vol .",
    "338 , springer - verlag , berlin , 2009 , old and new .",
    "mr 2459454 ( 2010f:49001 )"
  ],
  "abstract_text": [
    "<S> we prove a uniqueness result of solutions for a system of pdes of monge - kantorovich type arising in problems of mass transfer theory . </S>",
    "<S> the results are obtained under very mild regularity assumptions both on the reference set @xmath0 , and on the ( possibly asymmetric ) norm defined in @xmath1 . in the special case </S>",
    "<S> when @xmath1 is endowed with the euclidean metric , our results provide a complete description of the stationary solutions to the tray table problem in granular matter theory . </S>"
  ]
}