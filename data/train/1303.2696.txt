{
  "article_text": [
    "it has been established that modeling biochemical reaction networks with a macroscopic deterministic model , for instance with ordinary differential equations ( odes ) , can be unsuitable when some species are present in low copy numbers or if reactions are highly diffusion limited @xcite .",
    "such systems may only be accurately modeled by a discrete stochastic model .",
    "usually two levels of stochastic modeling are considered : the mesocopic level and the microscopic level .",
    "the mesoscopic scale is described by the chemical master equation ( cme ) which is a discrete , stochastic model .",
    "molecules are treated as discrete entities but assumed to be well stirred with a uniform distribution within the simulation volume .",
    "the copy number of each species is computed but the position of individual molecules is not tracked .",
    "exact trajectories of such a system can be generated with the stochastic simulation algorithm ( ssa ) by gillespie @xcite .",
    "systems for which the condition of spatial homogeneity does not hold can be modeled at the mesoscopic level by subdividing the domain into smaller compartments , where in each compartment the well stirred condition is assumed to hold .",
    "diffusion can now be modeled as discrete jumps between the compartments .",
    "the governing equation of the system is the reaction - diffusion master equation ( rdme ) and exact trajectories can be computed with the next subvolume method ( nsm ) @xcite , which is an efficient implementation of the ssa in a spatial setting .",
    "several software packages have been developed for simulating systems at the mesoscopic level , including mesord @xcite , urdme @xcite and steps @xcite .",
    "the spatial accuracy of the rdme depends on the size of the voxels .",
    "if the voxels are too large we might not resolve the spatial dynamics of the system accurately , but on the other hand it has also been shown that when the size of the voxels becomes too small the accuracy deteriorates @xcite . by allowing the reaction rates in the system to depend on the size of the voxels in a general way , accuracy can be retained , but at most up to a critical lower bound of the voxel size , at which point the model breaks down regardless of how the reaction rates are chosen @xcite .",
    "the mesoscopic model may therefore be unsuitable for systems where a very high spatial accuracy is required to capture important dynamics .",
    "the microscopic level , or microscale , usually refers to models where the positions of single molecules are tracked .",
    "either we compute the continous position in space or let the individual molecules move on a lattice , as in ref . .",
    "reactions occur with some probability per unit time when molecules collide or when they are within some prescribed reaction radius .",
    "there are two models that have been used extensively to model systems at the microscale : the smoluchowski model @xcite and the doi model @xcite . in this paper",
    "we will only be concerned with the smoluchowski model .    in ref .",
    "they show that fine - grained spatial correlations can affect the macroscopic behaviour of a system .",
    "furthermore , the dynamics of the system can not be captured on the macroscopic or mesoscopic level but rather require a microscopic level of simulation .",
    "this is due to highly diffusion - limited reactions and fast rebindings that the mesoscopic model can not resolve without hitting the critical lower bound of the voxel size .",
    "this motivates development of efficient methods for simulating systems at the microscopic level .",
    "the green s function reaction dynamics ( gfrd ) algorithm @xcite is an efficient method to generate accurate trajectories of the smoluchowski model .",
    "a full @xmath0-body problem is divided into many @xmath1- and @xmath2-body problems that can be simulated independently by choosing the time step in the algorithm sufficiently small . for these subproblems",
    "the smoluchowski equation can be solved analytically or numerically .",
    "improvements of gfrd have been developed in e.g. refs . .",
    "sampling random numbers from the analytical solution of the smoluchowski equation is complicated and expensive , but in ref .",
    "this step is simplified by solving the smoluchowski equation using first order or second order operator splitting schemes . in ref .",
    "the algorithm is made exact in both space and time by combining gfrd with the first - passage kinetic monte carlo ( fpkmc ) algorithm developed in ref . , and this improved algorithm is called egfrd . the main idea in egfrd is to introduce protective spheres around single molecules and pairs of molecules and then sample exact times for the molecules to exit the spheres .    software that implements egfrd is ecell @xcite .",
    "other software packages that simulate systems with the smoluchowski model as the target model are smoldyn @xcite , mcell @xcite and spatiocyte @xcite . both smoldyn and mcell discretize time while gfrd is exact in time , thus making them less accurate . on the other hand , smoldyn and mcell",
    "can be significantly more efficient for larger systems . in spatiocyte molecules",
    "move on a lattice of densely packed spheres .    instead of simulating the system with a purely microscopic method one can combine the microscopic level and the mesoscopic level in a hybrid method @xcite .",
    "by restricting the microscale simulations to the species or the parts of space that are necessary for capturing the important dynamics of the system , computational time can be saved without losing a significant amount of accuracy .",
    "in addition to the observed spatial heterogeneity in systems where molecules move only by pure diffusion in free space , there can be spatial effects in systems due to interactions with internal lower dimensional structures in the cells .",
    "this could for instance be binding to and reactions on curved surfaces or one - dimensional structures such as dna or microtubules . in ref .",
    "a method for simulating interactions with curved surfaces at the microscopic level is developed , and in ref .",
    "they develop an fpkmc method for simulating active transport due to chemical potentials on embedded lines of fixed length and with fixed configuration .",
    "a mesoscopic method that simulates interactions between molecules in free space and lines is considered in ref . and a mesoscopic method incorporating active transport",
    "is suggested in ref . .",
    "in this paper we have developed an algorithm that combines single molecule simulations in three - dimensional space with single molecule simulations on embedded curves .",
    "molecules in some general three - dimensional volume , for instance a sphere or a cylinder , are simulated with the gfrd algorithm .",
    "they can react with the embedded curves according to the smoluchowski model .",
    "molecules attached to a curve can also diffuse and react with each other according to the one - dimensional smoluchowski equation .",
    "in addition to pure diffusion , we simulate active transport along the curves by letting the molecules bound to the curves move deterministically in one direction .",
    "the curves can have an arbitrary shape .",
    "this flexibility is obtained by approximating a continuous curve with non - constant curvature by straight linear segments , and this approximation can be made arbitrarily accurate by making the discretization of the curve finer and finer .",
    "it is also known that many one - dimensional structures in cells are highly dynamic @xcite .",
    "a microtubule may for instance both move in space as well as grow and shrink .",
    "we take those dynamics into account by letting the embedded curves move according to some general random process as well as letting them grow and shrink over time .",
    "the following sections are organized as follows . in sec .",
    "[ sim3d1d ] we review the gfrd method in one dimension as well as three dimensions . in sec .",
    "[ emb_1d ] we describe the algorithm for coupling the one - dimensional simulations with the three - dimensional simulations , as well as simulation of moving lines embedded in space . in sec .",
    "[ results ] we demonstrate the flexibility of the algorithm with four examples .",
    "in the first example we verify the accuracy of the method by comparing with mesoscopic simulations and theoretical predictions . in the second example we consider two spirals embedded in a sphere . in the third example we consider several straight lines embedded in a spherical domain .",
    "molecules can bind to the lines and are then moved by active transport along the lines .",
    "the lines move in space according to a random process , and we show how the active transport affects the distribution of the molecules in space . in the final example we consider lines that grow and shrink .",
    "we show how the number of molecules attached to a line will vary with the total length of the lines .",
    "all parameters are given in si - units .",
    "we consider a system of @xmath0 molecules , where the molecules can undergo bimolecular or unimolecular reactions .",
    "the evolution of the system is modeled by the smoluchowski equation with a mixed boundary condition at the reaction radius of the molecules . in principle",
    "one could write down the smoluchowski equation for the full system , but due to the high dimension it would not be tractable to solve . in gfrd @xcite the main idea is to divide the full @xmath0-body problem into smaller subproblems consisting of the simulation of single molecules and pairs of molecules .",
    "the subdivision is done in two steps .",
    "first we find the nearest neighbor of every molecule .",
    "molecules that have each other as nearest neighbors form pairs and the remaining molecules will be updated as single molecules .",
    "secondly we choose a time step @xmath3 such that no molecule in a pair is likely to react with any other molecule except its nearest neighbor and molecules that are not in a pair should be unlikely to react with any other molecule .",
    "the full @xmath0-body problem can now be approximated by smaller , independent , subproblems during the time step @xmath3 .",
    "the positions of single molecules are updated by sampling from a normal distribution with standard deviation @xmath4 in each direction , where @xmath5 is the diffusion constant of the molecule .",
    "a pair of molecules , where the molecules have the positions @xmath6 and @xmath7 at time @xmath8 , are updated according to the pdf @xmath9 obtained by solving the smoluchowski equation for a pair of molecules , given by : @xmath10 where @xmath11 and @xmath12 are the diffusion coefficient and position of particle @xmath13 . by making a change of variables as suggested in ref .",
    "this equation can be split into two equations : one for the relative position of the molecules and one for a weighted mean of the positions @xmath14 now @xmath15 can be written as @xmath16 , and the equations become @xmath17 where @xmath18 is the sum of the diffusion coefficients of the molecules .",
    "the motion in the @xmath19 direction is in free space and will be described by a normal distribution , but the equation for the @xmath20 coordinate will have an additional boundary condition at the reaction radius of the molecules to model associations between molecules . by considering the equation in a spherical coordinate system , @xmath21 , the boundary condition becomes :    @xmath22    where @xmath23 is the reaction radius of the molecules , @xmath24 and @xmath25 is the intrinsic association rate .",
    "the initial condition is given by @xmath26 and @xmath27 vanishes as @xmath28 .",
    "this equation can be solved analytically @xcite , but due to the complexity of the analytical solution we use the method described in ref . .",
    "there the full equation is solved in two steps using a first order splitting scheme ( or if higher accuracy is needed with a second order splitting scheme ) .",
    "this simplifies the sampling of new positions for the molecules , at the price of an additional error .",
    "this error is shown to be small in ref . .",
    "the first step of the operator splitting scheme is to solve for the radial part of the equation ( in a spherical coordinate system rotated such that @xmath29 ) , given by :    @xmath30    with the initial condition @xmath31 and with the boundary condition given by eq . .",
    "the analytical solution is derived in ref . .",
    "the second step is to solve for the angular part :    @xmath32    with initial condition given by @xmath33 .",
    "the solution to eq",
    ". will be independent of @xmath34 , and the distribution of @xmath34 will therefore be uniform on the interval @xmath35 .",
    "it is possible to solve eq .",
    "analytically and the solution is given in the form of an infinite series , where the terms are products of legendre functions and exponentials .",
    "efficient strategies to compute the analytical solutions of eqs . and are discussed in ref . .",
    "an efficient method to generate random numbers from the pdf @xmath36 is suggested in ref . .",
    "note that the probability for two molecules to survive until time @xmath37 is given by @xmath38 from @xmath39 we can sample the exact time when the pair of molecules react ( cf . ref . ) .",
    "thus , the first step is to check whether the two molecules react before @xmath37 .",
    "if they do , we execute the reaction at the sampled time , and if they do not react we sample new positions for each molecule by    1 .",
    "sample @xmath40 from the pdf @xmath41 .",
    "sample @xmath42 from the pdf @xmath36 with @xmath43 .",
    "sample @xmath44 from a uniform distribution on the interval @xmath35 .",
    "4 .   transform @xmath45 back to @xmath46 .",
    "sample @xmath47 from a normal distribution and then solve eq . to obtain @xmath48 and @xmath49 .",
    "also molecules in one dimension can react . for pairs of molecules",
    "we solve the one - dimensional smoluchowski equation @xmath50 with the boundary condition at the reaction radius @xmath51 to obtain the pdf @xmath52 for the distance @xmath53 at time @xmath54 between the two molecules , given that the distance was @xmath55 at time @xmath8 . the analytical solution to eq . with boundary condition given by eq .",
    "is derived in ref . .",
    "both molecules in one dimension and molecules in three dimensions can dissociate .",
    "consider a reaction @xmath56 .",
    "the time until an @xmath57-molecule dissociates is sampled from an exponential distribution with mean @xmath58 . after a molecule @xmath57 has dissociated the @xmath59- and @xmath60-molecules",
    "are placed at a distance equal to the reaction radius .",
    "most biologically realistic geometries are fairly complex .",
    "cells can be close to spherical or have a shape reminding of a spheroid .",
    "eukaryotes typically have complex internal two - dimensional structures .",
    "one flexible and efficient way to deal with such non - regular surfaces is to discretize the surface with an unstructured mesh .    in this paper we do not consider volumes with internal two - dimensional structures , and are consequently only concerned with the outer boundaries of the volume",
    "the outer boundary is approximated by a triangular surface mesh .",
    "the vertex of each triangle is also a center vertex in the dual mesh generated from the primal mesh .",
    "consider a center vertex @xmath61 .",
    "this center vertex is the vertex of several triangles @xmath62 in the mesh , and to each dual element we associate one linear plane defined by the center vertex @xmath61 and with normal given by the average of all the normals @xmath63 to the triangles @xmath62 .",
    "we have now assigned one linear plane to each dual element in the mesh , and these planes are an approximation of the surface .",
    "now , assume that a molecule is close to one of the planes approximating the surface .",
    "choose a time step @xmath3 small enough such that the interaction between the molecule and the plane can be approximated by the interaction between an infinite flat plane and a molecule during @xmath3 . then consider the change of coordinate system where the molecule diffuses parallel to the plane in two directions and along the normal of the plane in the third direction .",
    "the molecule can then be updated according to normal diffusion in the first two directions and in the third direction by sampling from a normal distribution and then , in case the molecule ends up on the wrong side of the plane , simply reflecting that coordinate in the plane .",
    "this approach gives great flexibility to the algorithm and enables us to simulate molecules in different complicated geometries .",
    "the details of this approach is described in ref . .",
    "another method to simulate molecules close to an absorbing or reflecting boundary has been suggested in ref . .",
    "note that by making a locally planar approximation we can also include reactions between molecules and surfaces by solving the one - dimensional smoluchowski equation for molecules that are close to the surface , as done in ref . .",
    "in this paper , however , we only consider reflecting outer boundaries , but the methodology for simulating interactions with reactive surfaces ( outer boundaries as well as internal surfaces ) developed in ref .",
    "can be combined with the method described in this paper .",
    "furthermore , we could also combine this method with the hybrid method coupling microscopic and mesoscopic simulation algorithms , also developed in ref . .",
    "we consider a continuous and differentiable curve @xmath64 embedded in space , parametrized by @xmath65 @xmath64 can be approximated by a piecewise linear curve @xmath66 .",
    "denote the linear segments of @xmath66 by @xmath67 .",
    "the segment @xmath68 is defined by the points @xmath69 and @xmath70 .",
    "the points are chosen such that @xmath71 and thus all segments are connected .",
    "the curve @xmath72 can be approximated to arbitrary accuracy by letting @xmath73 in such a way that @xmath74 .",
    "we want to simulate reactions between molecules in space and the curve as well as diffusion and reactions between molecules on the curve .",
    "furthermore , we want to simulate moving curves that grow and shrink .",
    "if a molecule @xmath57 is close to @xmath66 , we will choose a time step @xmath3 such that the molecule is unlikely to interact with more than one of the linear segments during that time step , and such that the linear segment can be approximated , to high accuracy , by an infinitely long straight line during @xmath3 .",
    "the problem of simulating a molecule close to an infinitely long straight line can be reduced to a two - dimensional problem , which can be seen by considering the position of the molecule at time @xmath8 , @xmath75 , in cylindrical coordinates @xmath76 , with the @xmath77-coordinate in the direction of the line .",
    "the diffusion of the molecule in the @xmath77-coordinate is now independent of the diffusion in the @xmath78 and @xmath79 directions and the interaction with the line .",
    "assume that the closest linear segment to the molecule is @xmath68 .",
    "now consider the sphere @xmath39 with center at @xmath75 and radius @xmath80 . by choosing the time step @xmath3 such that the molecule @xmath57 is unlikely to diffuse outside of the sphere @xmath39 during the time step ,",
    "the requirement that the molecule is unlikely to react with more than one linear segment is satisfied . if the diffusion coefficient of @xmath57 is @xmath81 , the molecule will , on average , diffuse the distance @xmath82 during a time step @xmath3 .",
    "thus , we choose the time step to be @xmath83 where @xmath84 is a constant chosen sufficiently large in order to ensure that the probability for the molecule to diffuse outside of the sphere is small",
    ". note that if the molecule is really close to @xmath69 or @xmath70 the time step could become very small , making the simulation too slow . to avoid this problem we have to choose a smallest value that @xmath3 can take , thus introducing an error .",
    "however , with a carefully chosen smallest value of @xmath3 that error will be small .",
    "the interaction between the molecule and the linear segment can now be approximated by the two - dimensional smoluchowski equation during @xmath3 .",
    "the two - dimensional smoluchowski equation for the relative position ( in cylindrical coordinates ) is given by : @xmath85 with the boundary condition @xmath86    again we solve the equation in two steps with a first order operator splitting scheme .",
    "the radial part is given by : @xmath87 with the boundary condition given by eq .",
    ", the initial condition given by @xmath88 and with @xmath89 vanishing at infinity .",
    "the solution of eq . with the boundary condition given by eq . is solved analytically in ref . .",
    "the analytical solution is @xmath90 where @xmath91 and the function @xmath60 is defined by @xmath92 here @xmath93 and @xmath94 are bessel functions of the first kind and @xmath95 and @xmath96 are bessel functions of the second kind . despite having the analytical solution available we choose to compute the solution using a finite difference method , as the analytical solution is fairly complex and expensive to evaluate .",
    "the solution could also be tabulated as described in ref . .",
    "tabulating the solution is more efficient but has the drawback of introducing an additional error as well as consuming more memory .",
    "the second step is to solve for @xmath79 and @xmath77 @xmath97 with initial condition @xmath98 again , @xmath15 vanishes at infinity .",
    "the solution of eq . is a gaussian in both the @xmath77-direction and the @xmath79-direction .",
    "molecules can also dissociate from the lines .",
    "the time until a dissociation is assumed to be exponentially distributed with mean equal to the intrinsic dissociation rate , and after a dissociation from a line the molecule is placed at a distance equal to the reaction radius between the molecule and the line . as we are using a finite difference scheme to compute the solution of eq . we are in fact forced to place the dissociating molecule at a slightly larger distance from the line than the reaction radius , in order to have discretization points between the molecule and the line .",
    "this introduces a small error , but it can be made arbitrarily small by placing the molecule closer and closer to the line while increasing the number of discretization points used in the finite difference scheme .      a new position at time @xmath99 , @xmath100 , of a single molecule moving by pure diffusion , bound to @xmath72 at position @xmath75 at time @xmath54 , where @xmath101 , is computed by sampling a distance @xmath102 from a one - dimensional normal distribution with standard deviation @xmath4 and then updating @xmath103 it is possible that @xmath100 is no longer on the segment @xmath68 . if this is the case we project @xmath100 to the closest point on @xmath66 .",
    "the time step @xmath3 should thus be chosen such that @xmath4 is small in comparison to @xmath104 , so that the molecules do not diffuse a long distance compared to the distance of the segments .",
    "since we are projecting the molecule onto the line we are introducing a small error and the effective diffusion will be slightly slower than the exact diffusion process .",
    "however , if the angles between the linear segments are small , this error will also be small , and it is therefore important to ensure that the discretization of @xmath72 is fine enough to make the angles small enough . note that the process defined by eq",
    "can be modified to account for other types of motion on curves , such as active transport .",
    "for instance , @xmath102 could be sampled from another distribution than the normal distribution , or be completely deterministic .",
    "molecules on the same line segment can react according to the pdf obtained by solving eq . with boundary condition given by eq . .",
    "many one - dimensional structures in cells are not stationary , but rather move around in space",
    ". they can also grow and shrink .",
    "we simulate this process with an operator splitting scheme .",
    "choose a time step @xmath105 .",
    "first we keep the lines constant in space and propagate the molecules according to the algorithm described above for the full time step @xmath105 .",
    "the second step is to move the lines according to some transformation @xmath106 in space , for the full time step @xmath105 .",
    "@xmath107 can both move the line in space but also change the length of the line .",
    "we apply @xmath107 to all the points , such that the linear segments at time @xmath108 are defined by the pair of points @xmath109    the position of the molecules are now no longer guaranteed to be on the lines .",
    "each molecule is therefore projected down to the closest point on its respective line . for high accuracy we should therefore choose the time step @xmath105 such that each molecule is projected only a short distance .",
    "after each step it is possible that some molecules on the line that were previously separated by some small distance are now overlapping . if this is the case they are moved apart and placed at a distance equal to their reaction radius .",
    "molecules in space that overlap with the lines are also moved such that they are at a distance from the line equal to their reaction radius .",
    "we then repeat this process until the final time @xmath110 .",
    "if higher accuracy is needed it would be possible to consider higher order splitting schemes , such as strang splitting @xcite .",
    "the algorithm outlined above is summarized in algorithm 1 .",
    "note that this is only a summarized version of the gfrd algorithm .",
    "there are some special cases that require extra care , such as pairs of molecules that are also close to a boundary . for a more detailed description of how to handle such cases the reader",
    "is referred to refs . .",
    "initialize the system at the time @xmath111 and choose a final time @xmath110 .",
    "choose a time step @xmath105 for the operator splitting .",
    "divide the set of all molecules into subsets of one or two molecules such that pairs are formed by molecules that are each others nearest neighbor .",
    "set @xmath112 .",
    "update the linear segments according to the transformation @xmath107 . update the time @xmath113 .",
    "repeat ( 2)-(12 ) until the final time @xmath110 .",
    "we show the practical use of the algorithm by studying both examples with straight lines through a three - dimensional domain as well as lines with non - constant curvature .",
    "we demonstrate how to use the algorithm to simulate active transport by letting molecules attached to a line move with a deterministic speed in a predetermined direction . finally , we let the lines move in space as well as grow and shrink .      we consider a cylinder with radius @xmath114 , height @xmath115 and aligned along the x - axis . inside the cylinder",
    "we consider a line of length @xmath116 , for instance modeling a polymer , going through the center of the cylinder .",
    "the polymer has a reaction radius @xmath117 .",
    "molecules of species @xmath57 can associate to the polymer to form molecules @xmath118 .",
    "molecules @xmath118 can dissociate from the polymer to become species @xmath57 .",
    "thus , we consider the reaction @xmath119{k_r } a_{\\mathrm{cyl}}.\\end{aligned}\\ ] ] where @xmath57 is a molecule diffusing in three - dimensional space and @xmath118 is a molecule bound to the polymer .",
    "the diffusion constant of @xmath57 is @xmath120 and the diffusion constant of @xmath118 is @xmath121 .",
    "the intrinsic reaction rates are chosen to be @xmath122 and @xmath123 .",
    "the problem setup is shown in fig .",
    "[ fig : linecyl_setup ] .",
    "( blue dots ) diffuse in the cylindrical volume .",
    "they react with the line and transforms into the one - dimensional species @xmath118 ( red dots ) .",
    "the line ( green ) extends throughout the domain through the center of the cylinder .",
    "the outer boundary is approximated by piecewise linear planes and is reflective . ]",
    "due to the cylindrical symmetry of the problem , the reactions with the polymer can be reduced to a two - dimensional problem .",
    "the average time @xmath124 until a molecule @xmath57 reacts with the polymer can thus be computed using a formula for association times on disks , derived in ref . .",
    "we can therefore compare the microscopic simulation with a corresponding mesoscopic simulation of the reaction @xmath125{k_r^{\\mathrm{meso}}}a_{\\mathrm{cyl}}\\end{aligned}\\ ] ] where @xmath126 and , due to the detailed balance condition , @xmath127 . here",
    "@xmath128 is the area of the face of the cylinder . in fig .",
    "[ fig : linecyl_res ] we show that for this simple problem , the microscopic simulations agree well with spatially homogeneous mesoscopic simulations , performed with the ssa .     at the microscopic level and the mesoscopic level .",
    "the mesoscopic simulation agree well with the microscopic simulation .",
    "the average is taken over 20 trajectories and we start the simulation with 250 @xmath57-molecules uniformly distributed in the domain . ]",
    "next we consider a more involved example .",
    "the geometrical setup is the same as above , but now we let the molecules of species @xmath118 react with an operator site at the center of the line , thus considering the line a coarse model of dna . the operator site is denoted by @xmath59 and we consider the reactions @xmath129{k_r } a_{\\mathrm{cyl}}\\\\ & a_{\\mathrm{cyl}}+b\\xrightarrow { } b_{\\mathrm{active}}.\\end{aligned}\\ ] ] we assume that the operator site is absorbing and of radius @xmath130 . on both sides , at the distance @xmath131 from the operator site , we place a road block .",
    "road blocks are modeled by stationary , non - reactive ( but reflective ) molecules of radius @xmath130 .",
    "thus , molecules binding to the dna at a distance larger than @xmath131 from the operator site , will not be able to find it since molecules can not diffuse through the road blocks . in ref .",
    "a similar problem is simulated with a mesoscopic method .",
    "the microscopic parameters can not easily be transformed to corresponding mesoscopic parameters , but the qualitative behaviour can be compared .",
    "we compute the average time , @xmath132 , until an @xmath118-molecule binds to the operator site , and this time will depend on the length @xmath131 between the road blocks . in fig .",
    "[ fig : roadblocks ] we show that this time decreases with increasing length between the road blocks , as was shown in refs . .",
    "the decrease in the binding time levels off as @xmath131 becomes greater than the average distance that a molecule slides on the dna before dissociating .",
    "-molecule binds to the operator site decreases with the distance between the road blocks . as the distance becomes greater than the average sliding distance of an @xmath118 , the decrease levels off .",
    "the parameters in the simulations are @xmath133 , @xmath134 and @xmath135 for all species .",
    "the simulation is started with 250 @xmath57-molecules in free space . ]",
    "one - dimensional structures in living cells are often not well approximated by straight lines due to their curvature , and they may also have a complicated spatial distribution relative to each other .",
    "it is therefore important to be able to simulate molecules reacting with and on lines of non - constant curvature . to demonstrate the flexibility of the method we therefore consider the following system of reactions @xmath136{k_r^1 } a_{\\mathrm{cyl } } , \\,\\ , b\\xrightleftharpoons[k_d^2]{k_r^2 } b_{\\mathrm{cyl}}\\\\ & a_{\\mathrm{cyl}}+b_{\\mathrm{cyl}}\\xrightleftharpoons[k_d^3]{k_r^3 } c_{\\mathrm{cyl}},\\end{aligned}\\ ] ] where @xmath118 , @xmath137 and @xmath138 are molecules bound to one of the lines and @xmath57 and @xmath59 are molecules diffusing in three - dimensional space that can react with the lines .",
    "we will consider two spirals @xmath139 and",
    "@xmath140 along the y - axis , parameterized by @xmath141 with @xmath142 and @xmath143 .",
    "each spiral is divided into 30 linear segments .",
    "the setup is shown in fig .",
    "[ fig : spiral ] .",
    "we start with 150 molecules of species @xmath57 and 150 molecules of species @xmath59 , with initial positions sampled from a uniform distribution .",
    "the reactions rates are chosen to be @xmath144 , @xmath145 , @xmath146 and @xmath147 . the diffusion rate for the molecules in space is @xmath148 and the diffusion rate for the molecules on the spirals is @xmath149 .",
    "we simulate the system for @xmath2 seconds and the evolution of the system is shown in fig .",
    "[ fig : spiral_res ] .      molecules in living cells do not only move by normal diffusion but can also be actively transported .",
    "for instance , intracellular transport on the cytoskeleton , a structure in the cell composed of fibers such as actin and microtubules , is an important mechanism for directed transport of cargo in the cell @xcite .",
    "cargo attach to the fibers and are then transported by molecular motors : myosins along actin and dynein and kinesins along microtubules .",
    "we will consider a much simplified model of active transport from the cytosol towards the center of a cell .",
    "molecules bind to microtubules , modeled by straight lines passing through the origin .",
    "we assume that the transport is of constant speed in the direction towards the origin and we do not explicitly model the molecular motors .",
    "other more complex and more biologically accurate models of active transport could be incorporated into the method by modifying eq . in a suitable way . the model used in this example",
    "is not meant to be a very accurate model of such processes , but is rather meant to serve as an example of the flexibility of the algorithm .",
    "we initialize the system by sampling 25 points , @xmath150 , uniformly on a sphere of radius @xmath151 .",
    "25 straight line segments through the origin are then defined by the pairs @xmath152 , @xmath153 .",
    "we start with 100 @xmath57-molecules in space , with initial positions sampled from a uniform distribution .",
    "the @xmath57-molecules can then associate and dissociate to the microtubules through the reaction @xmath154{k_r}a_{\\mathrm{cyl}}$ ] .",
    "@xmath57-molecules in space diffuse with the diffusion constant @xmath135 , but molecules on the microtubules move deterministically towards the center of the sphere with constant speed @xmath155 .",
    "the microtubules are rotated @xmath156 and @xmath157 radians around the x- and y - axis per time step @xmath3 , where @xmath158 @xmath159 and @xmath160 are random numbers sampled from a normal distribution with standard deviation 1 .",
    "@xmath105 is chosen to be 0.01 .",
    "thus , the microtubule @xmath161 defined by the points @xmath152 at time @xmath54 , will be updated at time @xmath99 by rotating @xmath162 and @xmath163 around the x- and y - axis @xmath156 and @xmath157 degrees , with @xmath156 and @xmath157 given by eq . .",
    "the trajectory of one of the microtubules is plotted in fig .",
    "[ fig : microtubule_ts ] and two snapshots of a simulation , one at @xmath164 and one at the final time @xmath165 are shown in fig .",
    "[ fig : active_transport_snapshots ] .    in fig .",
    "[ fig : active_transport_res ] the distribution of molecules in the radial direction is plotted .",
    "the initial distribution is uniform in space . due to the transport towards the center ,",
    "this distribution is shifted and more molecules are close to the center of the sphere at the final time @xmath165 .",
    "the reaction rates in the simulation are @xmath122 and @xmath166",
    ".    - , @xmath167- and @xmath77-coordinates of one of the endpoints of the microtubule is plotted .",
    "the microtubule is rotated according to eq . .",
    "]     is shifted towards the center of the sphere .",
    "the distribution at the final time , plotted in the figure above , is based on the mean of three trajectories . ]",
    "microtubules are highly dynamic and can , in addition to moving around in space , both grow and shrink . therefore , as a final example",
    ", we will consider fibers embedded in a sphere and whose lengths can both increase and decrease .",
    "the sphere has a radius @xmath151 , with two straight fibers passing through the origin .",
    "the fibers are initially of length @xmath168 .",
    "the lines rotate in the same way as in sec .",
    "[ active_transport ] but will also grow and shrink . after each time step , the length of the line is updated , and molecules are projected down to the closest point on the line .",
    "note that the closest point could in fact be the endpoint of the line if the molecule was close to the end of the line before the length was updated .",
    "one possibility is to let such molecules be transformed to molecules in free space , but in this example they will stay bound to the line .",
    "now , assume that the length of the line at time @xmath8 is given by @xmath169 .",
    "then the length at @xmath37 is given by @xmath170 where x is a random number sampled from a normal distribution with mean 0 and standard deviation @xmath171 , with the restrictions that @xmath172 and @xmath173 .",
    "thus , if the line is defined by the points @xmath174 at time @xmath8 , it will be defined by the points @xmath175 at time @xmath176 .",
    "intuitively one would expect that when the length of the fibers decrease , the number of bound molecules will also decrease , under the condition that the fibers grow and shrink at a time scale that is longer than or similar to the time scale for the system to reach steady state .",
    "thus , if we choose parameters such that this condition is fulfilled , we would expect to see a correlation between the number of molecules of species @xmath118 and the total length of the two lines .",
    "we start the simulation with @xmath177 molecules of species @xmath57 uniformly distributed in space .",
    "the diffusion constants are @xmath120 and @xmath178 . in fig .",
    "[ fig : growing_sphere_res ] we plot the total length of the two lines and the total number of molecules bound to a line . in fig .",
    "[ fig : growing_sphere_res ] a trajectory of the system , with @xmath179 , is plotted together with the sum of the length of the lines . as expected",
    "the two trajectories are clearly correlated .",
    "-molecules is plotted together with the sum of the length of the two lines .",
    "the two time series are correlated with correlation coefficient 0.713 and a 95% confidence interval of the correlation coefficient is given by @xmath180 $ ] . ]",
    "we have described an algorithm to simulate biochemical systems in complex geometries with embedded and dynamic one - dimensional manifolds .",
    "molecules in space can associate to and dissociate from the embedded curves .",
    "molecules in space and on the lines are simulated using the gfrd algorithm .",
    "the accuracy of the algorithm depends on the discretization of the lines and the time step chosen in the algorithm .",
    "the simulation of the molecules and the spatial transformation of the lines are split in time according to a first order operator splitting scheme and the error will therefore depend on the time step chosen for this splitting , as well as the curvature of the lines .",
    "we have demonstrated the flexibility of this method in four numerical examples .",
    "first we have shown that the time until a molecule binds to an operator site on dna depends on the length between two road blocks on each side of the operator site . as the length increases , the time until a molecule binds decreases .",
    "the decrease levels off as the distance gets bigger than the average sliding distance of a molecule on the dna , in agreement with refs . .",
    "in the second example we consider two spirals embedded in a sphere .",
    "molecules in space undergo a reversible reaction with the spirals and molecules on the spirals also react reversibly . in a third example",
    "we have considered a simple model of active transport .",
    "molecules in a sphere react reversibly with embedded lines and move deterministically towards the center , while bound .",
    "the lines also move in space and we have shown how the radial distribution of the molecules is shifted due to the active transport . in a final example we have simulated lines that are growing and shrinking in space and shown how the dynamics of the lines correlates to the concentration of the molecules in the system .",
    "andreas hellander and per ltstedt have read the manuscript carefully and suggested a number of improvements .",
    "this work has been supported by the swedish research council and the national institute of health under award no .",
    "1r01eb014877 - 01 .",
    "the content is solely the responsibility of the author and does not necessarily represent the official views of the national institute of health .",
    "36ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) http://stacks.iop.org/0305-4470/9/i=9/a=008 [ * * ,   ( ) ] http://stacks.iop.org/0305-4470/9/i=9/a=009 [ * * ,   ( ) ] @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) ,   @noop `` , ''   ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1103/physreve.66.056701 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> stochastic models of reaction - diffusion systems are important for the study of biochemical reaction networks where species are present in low copy numbers or if reactions are highly diffusion limited . in living cells many such systems include reactions and transport on one - dimensional structures , such as dna and microtubules . </S>",
    "<S> the cytoskeleton is a dynamic structure where individual fibers move , grow and shrink . in this paper </S>",
    "<S> we present a simulation algorithm that combines single molecule simulations in three - dimensional space with single molecule simulations on one - dimensional structures of arbitrary shape . </S>",
    "<S> molecules diffuse and react with each other in space , they associate to and dissociate from one - dimensional structures as well as diffuse and react with each other on the one - dimensional structure </S>",
    "<S> . a general curve embedded in space can be approximated by a piecewise linear curve to arbitrary accuracy . </S>",
    "<S> the resulting algorithm is hence very flexible . </S>",
    "<S> molecules bound to a curve can move by pure diffusion or via active transport , and the curve can move in space as well as grow and shrink . </S>",
    "<S> the flexibility and accuracy of the algorithm is demonstrated in four numerical examples . </S>"
  ]
}