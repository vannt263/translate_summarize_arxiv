{
  "article_text": [
    "in this paper we use the theory of kolyvagin systems to prove ( most of ) a conjecture of darmon from @xcite .    in ( * ? ? ? * conjecture 4.1 ) , inspired by work of the first author and tate @xcite , and of hayes @xcite , gross conjectured a `` refined class number formula '' for abelian extensions @xmath4 of global fields . attached to this extension ( and some chosen auxiliary data )",
    "there is a generalized stickelberger element @xmath5 $ ] , where @xmath6 , with the property that for every complex - valued character @xmath7 of @xmath8 , @xmath9 is essentially @xmath10 ( modified by the chosen auxiliary data ) .",
    "gross conjectural formula is a congruence for @xmath11 , modulo a certain specified power of the augmentation ideal of @xmath12 $ ] , in terms of a regulator that gross defined .    in a very special case ,",
    "darmon formulated an analogue of gross conjecture involving first derivatives of @xmath13-functions at @xmath14 .",
    "suppose @xmath15 is a real quadratic field , and @xmath16 is the extension of @xmath15 generated by @xmath1-th roots of unity , with @xmath1 prime to the conductor of @xmath17 .",
    "darmon defined a stickelberger - type element @xmath18 $ ] , interpolating the first derivatives @xmath19 , where @xmath20 is the quadratic character attached to @xmath17 and @xmath7 runs through even dirichlet characters of conductor @xmath1 .",
    "darmon conjectured that @xmath21 is congruent , modulo a specified power of the augmentation ideal , to a regulator that he defined .",
    "see  [ statement ] and conjecture [ dconj ] below for a precise statement .",
    "our main result is a proof of darmon s conjecture `` away from the @xmath22-part '' . in other words ,",
    "we prove that the difference of the two sides of darmon s conjectured congruence is an element of @xmath22-power order .    the idea of our proof is a simple application of the results proven in @xcite . for every odd prime @xmath0",
    "we show that although neither the left - hand side nor the right - hand of darmon s conjectured congruence ( as @xmath1 varies ) is a `` kolyvagin system '' as defined in @xcite , each side is _ almost _ a kolyvagin system ; moreover , both sides fail to be kolyvagin systems in precisely the same way .",
    "that is , we show that the left - hand side and right - hand side form what we call in this paper _ pre - kolyvagin systems _ in the sense that they each satisfy the specific set of local and global compatibility relations given in definition [ preksdef ] below .",
    "it seems that pre - kolyvagin systems are what tend to occur `` in nature '' , while kolyvagin systems satisfy a cleaner set of axioms .",
    "we show that the two concepts are equivalent , by constructing ( see proposition [ preksks ] ) a natural transformation @xmath23 that turns pre - kolyvagin systems into kolyvagin systems and has the properties that :    * @xmath23 does not change the term associated to @xmath3 , and * @xmath23 is an isomorphism from the @xmath24-module of pre - kolyvagin systems to the @xmath24-module of kolyvagin systems .",
    "since it was proved in @xcite that ( in this situation ) the space of kolyvagin systems is a free @xmath24-module of rank one , it follows that if two pre - kolyvagin systems agree when @xmath3 , then they agree for every @xmath1 . in the case",
    "@xmath25 , darmon s congruence follows from classical formulas for @xmath26 , so we deduce that ( the @xmath0-part , for every odd prime @xmath0 of ) darmon s conjectured congruence formula holds for all @xmath1 .",
    "darmon s conjecture begs for a generalization .",
    "a naive generalization , even just to the case where @xmath15 is a real abelian extension of @xmath27 , is unsuccessful because the definition of darmon s regulator does not extend to the case where @xmath28 > 2 $ ] . in a forthcoming paper",
    "we will use the ideas and conjectures of @xcite to show how both gross and darmon s conjectures are special cases of a much more general conjecture . in the current paper",
    "we treat only darmon s conjecture because it can be presented and proved in a very concrete and explicit manner .",
    "the paper is organized as follows . in  [ nota ]",
    "we describe our setting and notation , and in  [ statement ] we state darmon s conjecture and our main result ( theorem [ mainthm ] ) . in  [ augq ]",
    "we recall some work of hales @xcite on quotients of powers of augmentation ideals , that will enable us to translate the definition of kolyvagin system given in @xcite into a form that will be more useful for our purposes here . in  [ kssect ] we give the definition of a kolyvagin system ( for the galois representation @xmath29 ) . in  [ prekssect ] we define pre - kolyvagin system , and give an isomorphism between the space of pre - kolyvagin systems and the space of kolyvagin systems . in  [ cupks ] ( resp . ,",
    " [ rpks ] ) we show that the `` stickelberger '' side ( resp . ,",
    "regulator side ) of darmon s formula is a pre - kolyvagin system as @xmath1 varies .",
    "finally , in  [ pfsect ] we combine the results of the previous sections to prove theorem [ mainthm ] .",
    "fix once and for all a real quadratic field @xmath15 , and let @xmath30 be the conductor of @xmath17 . let @xmath31 be the quadratic dirichlet character associated to @xmath17 , and @xmath32 the nontrivial element of @xmath33 .",
    "if @xmath34 is a @xmath33-module , we let @xmath35 be the subgroup of elements of @xmath34 on which @xmath32 acts as @xmath36 .    throughout this paper @xmath37 will always denote a prime number .",
    "let @xmath38 denote the set of squarefree positive integers prime to @xmath30 .",
    "if @xmath39 let @xmath40 be the product of all primes dividing @xmath1 that split in @xmath17 , and @xmath41 the number of prime divisors of @xmath40 : @xmath42 for every @xmath43 let @xmath44 be the galois module of @xmath1-th roots of unity in @xmath45 , define @xmath46 and let @xmath47 denote the augmentation ideal of @xmath48 $ ] , which is generated over @xmath49 by @xmath50 . there is a natural isomorphism @xmath51 defined by sending @xmath52 to @xmath53 .",
    "if @xmath54 then we can view @xmath55 either as the quotient @xmath56 of @xmath57 , or as the subgroup @xmath58 . with the latter identification we have @xmath59 the product and the sum taken over primes @xmath37 dividing @xmath1 .",
    "we will usually write the group operation in multiplicative groups such as @xmath60 with standard multiplicative notation ( for example , with identity element @xmath61 ) . however , when dealing with `` mixed '' groups such as @xmath62 , we will write the operation additively and use @xmath63 for the identity element .    fix an embedding @xmath64 .",
    "in this section we state our modified version of darmon s conjecture ( mostly following @xcite ) and our main result ( theorem [ mainthm ] ) .    if @xmath43 , let @xmath65 be the inverse image of @xmath66 under the chosen embedding @xmath64 , and define the cyclotomic unit @xmath67 and the `` first derivative @xmath68-element '' @xmath69.\\ ] ]    the element @xmath70 is an `` @xmath13-function derivative evaluator '' in the sense that for every even character @xmath71 , classical formulas give @xmath72 where @xmath73 is the dirichlet @xmath13-function with euler factors at primes dividing @xmath1 removed , and @xmath74 is the absolute value corresponding to our chosen embedding @xmath75 .",
    "suppose @xmath43 .",
    "let @xmath76 be the group of divisors of @xmath15 supported above @xmath77 , and let @xmath78^\\times$ ] , the group of @xmath1-units of @xmath15 .",
    "we will write the action of @xmath48 $ ] on @xmath79 additively , so in particular @xmath80 .",
    "let @xmath81 be the archimedean place of @xmath15 corresponding to our chosen embedding @xmath64 .",
    "[ freer+1 ] suppose @xmath43 , and let @xmath82 .    1 .",
    "we have @xmath83 , @xmath84 , and @xmath85 .",
    "2 .   the group @xmath86 is a free abelian group of rank @xmath87 , and is a subgroup of finite index in @xmath88 .",
    "3 .   the group @xmath89 is a free abelian group of rank @xmath87 .",
    "if @xmath90 , and @xmath91 , then @xmath92 is a basis of @xmath89 .",
    "the only part that is not clear is that @xmath86 is torsion - free , i.e. , @xmath93 . let @xmath94 be a squarefree integer such that @xmath95 . if @xmath96 , then @xmath97 , so @xmath98 is not a unit at the primes dividing @xmath99 .",
    "since @xmath1 is prime to @xmath99 , we can not have @xmath100 .    a _ standard _",
    "@xmath49-basis of @xmath89 is a basis of the form described in lemma [ freer+1](iii ) .",
    "given a standard basis of @xmath89 , a @xmath49-basis @xmath101 of @xmath86 will be called _ oriented _ if the ( regulator ) determinant of the logarithmic embedding @xmath102 with respect to the two bases is positive .",
    "concretely , this regulator is the determinant of the matrix whose entry in row @xmath103 and column @xmath104 is @xmath105 .    choosing a standard basis of @xmath89 is equivalent to ordering the prime divisors @xmath106 of @xmath40 and choosing one prime of @xmath15 above each @xmath106 .",
    "any basis of @xmath86 can be oriented either by reordering the basis , or inverting one of the basis elements .",
    "suppose @xmath43 and @xmath107 is a prime of @xmath15 dividing @xmath40 .",
    "define a homomorphism @xmath108 by @xmath109 - 1 \\pmod{i_n^2}\\ ] ] where @xmath110 \\in \\gamma_n$ ] is the local artin symbol .",
    "note that if @xmath111 , then @xmath110 $ ] belongs to the inertia group @xmath112 , so @xmath113 and @xmath114 .",
    "in general , if @xmath115 then @xmath116    [ rdef ] ( see @xcite . ) suppose @xmath43 , and let @xmath82 .",
    "choose a standard basis @xmath117 of @xmath89 and an oriented basis @xmath101 of @xmath86 , and define the regulator @xmath118 by @xmath119 this determinant , and the ones that follow below , are meant to be evaluated by expanding by minors along the top row , i.e. , @xmath120 where @xmath121 is the @xmath122 matrix ( with entries in @xmath123 ) obtained by removing the first row and @xmath104-th column of the matrix above .",
    "note that this definition of @xmath124 does not depend on the choice of @xmath49-bases .",
    "the possible ambiguity of @xmath125 is removed by requiring that the basis of @xmath86 be oriented .",
    "let @xmath126 denote the `` @xmath1-class number '' of @xmath15 , i.e. , the order of the ideal class group @xmath127)$ ] . for the rest of this section we write simply @xmath128 instead of @xmath129 .    for every @xmath43 , we have @xmath130    for @xmath43 , let @xmath131 denote the image of @xmath70 in @xmath132 . let @xmath133 be the number of prime divisors of @xmath134",
    "; we continue to denote by @xmath128 the number of prime factors of @xmath40 .",
    "the following is a slightly modified version of darmon s `` leading term '' conjecture ( * ? ? ?",
    "* conjecture 4.3 ) .",
    "[ dconj ] for every @xmath43 , we have @xmath135    the main theorem of this paper is the following .    [ mainthm ] for every @xmath43 , we have @xmath136$}.\\ ] ]    in other words , the @xmath0-part of conjecture [ dconj ] holds for every odd prime @xmath0 ; in still other words , @xmath137 has @xmath22-power order in @xmath132 .",
    "a key step in the proof of theorem [ mainthm ] is the following observation .",
    "[ n=1 ] conjecture [ dconj ] holds if @xmath3 .",
    "when @xmath3 we have @xmath138 , @xmath139 , @xmath140 and @xmath141 , where @xmath142 is a generator of @xmath143 and @xmath144 at our specified archimedean place .",
    "dirichlet s analytic class number formula shows that @xmath145 where @xmath146 is the class number of @xmath15 .",
    "hence @xmath147 in @xmath148 .",
    "\\(i ) in darmon s formulation ( * ? ? ?",
    "* conjecture 4.3 ) , the regulator @xmath124 was defined with respect to a basis of @xmath149 instead of @xmath86 , and there was an extra factor of @xmath22 on the right - hand side .",
    "this agrees with conjecture [ dconj ] if and only if @xmath150 = 2 $ ] , i.e. , if and only if @xmath151 .",
    "\\(ii ) the ambiguity of @xmath125 in conjecture [ dconj ] is necessary .",
    "namely , even when @xmath3 , we may only have @xmath152 in @xmath143 .",
    "since @xmath153 is always positive ( it is a norm from a cm field to @xmath15 ) , the proof of proposition [ n=1 ] shows that @xmath154 in @xmath60 when @xmath155 is odd and @xmath148 has a unit of norm @xmath36 . note that in this case @xmath156 and @xmath157 differ ( multiplicatively ) by an element of order @xmath22 in @xmath60 , so the discrepancy disappears when we tensor with @xmath158 $ ]",
    "suppose @xmath43 , and let @xmath82 .",
    "let @xmath159 be the ( cyclic ) subgroup generated by monomials @xmath160 with @xmath161 .",
    "let @xmath162 be the subgroup generated by monomials @xmath163 where each @xmath164 for some @xmath106 dividing @xmath1 , and @xmath165 ( i.e. , either one of the @xmath106 divides @xmath134 , or @xmath166 for some @xmath167 ) .",
    "if @xmath168 then there is a natural identification @xmath169 , and if @xmath170 is prime then @xmath171 and @xmath172 .",
    "if @xmath115 , let @xmath173 \\onto \\z[\\gamma_d ] \\hookto \\z[\\gamma_n]\\ ] ] denote the composition of the natural maps .",
    "we also write @xmath174 for the induced map on @xmath175 for @xmath176 .",
    "the following proposition is based on work of hales @xcite .",
    "[ crit ] suppose @xmath39 , and @xmath177 .",
    "then :    1 .   @xmath178 .",
    "2 .   if @xmath179 and @xmath94 , then @xmath180 and @xmath181 .",
    "3 .   @xmath182 .",
    "the map @xmath183 defined by @xmath184 is an isomorphism .",
    "let @xmath185 be the polynomial ring @xmath186 $ ] with one variable @xmath187 for each prime @xmath37 dividing @xmath1 . fix a generator @xmath188 of @xmath189 for every @xmath37 dividing @xmath1 , and define a map @xmath190 $ ] by sending @xmath191 . by corollary 2 of @xcite",
    ", this map induces an isomorphism from the homogeneous degree-@xmath128 part of @xmath192 to @xmath193 , where @xmath194 is the ideal of @xmath185 generated by @xmath195 , and @xmath196 is the ideal generated by certain other explicit homogeneous relations ( see ( * ? ? ?",
    "* lemma 2 ) ) .",
    "the only fact we need about these `` extra '' relations is : @xmath197 note that @xmath198 is the image in @xmath193 of the subgroup of @xmath192 generated by @xmath199 , where @xmath200 .",
    "similarly , @xmath201 is the image of the subgroup generated by all other monomials of degree @xmath128 . by , @xmath199 does not occur in any of the relations in @xmath196 , and assertion ( i ) follows .",
    "assertion ( ii ) is clear , since @xmath202 kills those monomials that include @xmath203 with @xmath204 for @xmath37 dividing @xmath99 , and leaves the other monomials unchanged .",
    "fix @xmath205 .",
    "if @xmath206 and @xmath207 , then @xmath208 by ( ii ) .",
    "conversely , suppose that @xmath208 for every @xmath37 dividing @xmath40 .",
    "choose @xmath209 homogeneous of degree @xmath128 representing @xmath210 , and suppose @xmath30 has the minimum number of monomials among all representatives of @xmath210 .",
    "we will show that @xmath211 , and hence @xmath206 .    fix a prime @xmath37 dividing @xmath40 .",
    "the map @xmath212 \\onto \\z[\\gamma_{n/\\ell } ] \\hookto \\z[\\gamma_n]$ ] corresponds to the map @xmath213 defined by setting @xmath214 . since @xmath208 , substituting @xmath214 in @xmath30 gives a relation in @xmath215 , i.e. , @xmath216 where @xmath217 is homogeneous of degree @xmath218 , @xmath219 , and @xmath187 does not occur in @xmath220 .",
    "but then @xmath221 represents @xmath210 , so the minimality assumption on @xmath30 implies that @xmath222 .",
    "therefore @xmath223 for every @xmath37 dividing @xmath40 , so @xmath224 and @xmath206 .",
    "this proves ( iii ) .",
    "let @xmath225 . then @xmath226 .",
    "it follows from that the monomial @xmath199 only occurs in elements of @xmath215 with coefficients divisible by @xmath217 .",
    "therefore @xmath198 is cyclic of order @xmath217 , and so is @xmath227",
    ". clearly the map @xmath183 of ( iv ) is surjective , so it must be an isomorphism .",
    "if @xmath205 , let @xmath228 denote the projection of @xmath210 to @xmath198 under the splitting of proposition [ crit](i ) .",
    "we will use the following lemma without explicit reference in some of our computations in  [ prekssect ] and  [ rpks ] .",
    "its proof is left as an exercise .",
    "suppose @xmath229 , @xmath230 , and @xmath231 . then @xmath232",
    "fix an odd prime @xmath0 . to prove theorem [ mainthm ] we need to introduce kolyvagin systems , as defined in @xcite .",
    "( see in particular @xcite , and also @xcite , for the case of kolyvagin systems associated to even dirichlet characters that we use here . )",
    "let @xmath233 denote the @xmath0-adic completion of @xmath60 .",
    "similarly , for every rational prime @xmath37 let @xmath234 , @xmath235 , and define @xmath236 and @xmath237 to be their @xmath0-adic completions .",
    "we define the `` finite subgroup '' @xmath238 to be the `` unit part '' of @xmath236 @xmath239    if @xmath240 splits in @xmath15 , define the `` transverse subgroup '' @xmath241 to be the ( closed ) subgroup generated by @xmath242 and @xmath243 , where we identify @xmath244 with @xmath245",
    ". then we have a canonical splitting @xmath246 , and since @xmath0 is odd @xmath247    [ phifsdef ] if @xmath248 splits in @xmath15 , define the _ finite - singular isomorphism _ @xmath249 by @xmath250 - 1 )      + ( 1,\\ell ) \\otimes ( [ x_{\\lambda^\\tau},f_{\\lambda^\\tau}(\\bmu_\\ell)/f_{\\lambda \\tau}]-1 ) \\\\     & = ( \\ell,\\ell^{-1 } ) \\otimes ( [ x_\\lambda , f_\\lambda(\\bmu_\\ell)/f_\\lambda]-1)\\end{aligned}\\ ] ] where @xmath251 with @xmath252 , and @xmath253 $ ] is the local artin symbol .",
    "( concretely , note that if @xmath254 then @xmath255 $ ] is the automorphism in @xmath189 that sends @xmath256 to @xmath257 . )",
    "then @xmath258 is a well - defined isomorphism ( both the domain and range are free of rank one over @xmath259 ) , independent of the choice of @xmath107 versus @xmath260 .",
    "[ ksdef ] let @xmath261 .",
    "kolyvagin system _ @xmath262 ( for the galois representation @xmath29 ) is a collection @xmath263 satisfying the following properties for every rational prime @xmath37 .",
    "let @xmath264 denote the image of @xmath265 in @xmath266 .    1 .   if @xmath267 , then @xmath268 .",
    "2 .   if @xmath207 , then @xmath269 .",
    "3 .   if @xmath270 , then @xmath271 .",
    "let @xmath272 denote the @xmath24-module of kolyvagin systems for @xmath29 .",
    "let @xmath273 . in @xcite ,",
    "a kolyvagin system was defined to be a collection of classes @xmath274 , and @xmath258 took values in @xmath275 .",
    "we use proposition [ crit](iv ) to replace @xmath276 by @xmath198 and to replace @xmath189 by @xmath277 , which will be more convenient for our purposes here .",
    "also , a kolyvagin system @xmath278 as in @xcite extends uniquely to @xmath279 simply by setting @xmath280 for @xmath281 .",
    "the following theorem is the key to our proof of theorem [ mainthm ] .",
    "[ rankone ] suppose @xmath282 .",
    "if @xmath283 , then @xmath284 for every @xmath285 .",
    "we follow  6.1 of @xcite , with @xmath286 , @xmath287 , @xmath288 , and with the selmer structure denoted @xmath289 in @xcite . by lemma 6.1.5 and proposition 6.1.6 of @xcite ,",
    "the hypotheses needed to apply the results of  5.2 of @xcite all hold , and the core rank of @xmath290 is @xmath61 .    by theorem 5.2.10(ii ) of @xcite , @xmath272 is a free @xmath24-module of rank one .",
    "therefore ( switching @xmath262 and @xmath291 if necessary ) there is an @xmath292 such that @xmath293 , i.e. , @xmath294 for every @xmath285 .",
    "if @xmath262 is identically zero , then so is @xmath291 and we are done . if @xmath262 is not identically zero , then ( since the ideal class group of @xmath15 is finite ) theorem 5.2.12(v ) of @xcite shows that @xmath295 . since @xmath296 in the torsion - free @xmath24-module @xmath297 ( in fact property ( i ) above shows that @xmath298 ) , we must have @xmath299 .",
    "keep the fixed odd prime @xmath0 .",
    "the right - hand and left - hand sides of conjecture [ dconj ] are `` almost '' kolyvagin systems . if they were kolyvagin systems , then since they agree when @xmath3 ( proposition [ n=1 ] ) , they would agree for all @xmath1 by theorem [ rankone ] , and theorem [ mainthm ] would be proved .    in this section",
    "we define what we call `` pre - kolyvagin systems '' , and show that a pre - kolyvagin system can be transformed into a kolyvagin system . using theorem [ rankone ] , we deduce ( corollary [ prekskscor ] below ) that if two pre - kolyvagin systems agree when @xmath3 , then they agree for every @xmath1 . in  [ cupks ] and  [ rpks ] , respectively , we will show that the left- and right - hand sides of conjecture [ dconj ] are pre - kolyvagin systems .",
    "then theorem [ mainthm ] will follow from corollary [ prekskscor ] and proposition [ n=1 ] .    if @xmath300 , let @xmath301 denote the image of @xmath98 in @xmath302 , and if @xmath303 splits in @xmath17 , let @xmath304 and @xmath305 denote the projections of @xmath301 induced by the splitting .",
    "let @xmath306 denote the projection of @xmath98 induced by the splitting of proposition [ crit](i ) , and similarly for @xmath307 and @xmath308 .",
    "[ mdef ] if @xmath43 and @xmath309 divides @xmath40 , let @xmath310 be the @xmath311 matrix with entries in @xmath123 @xmath312 we let @xmath313 , where @xmath314 is understood to be zero , so that all diagonal entries of @xmath315 are zero",
    ". define @xmath316 by convention we let @xmath317 .",
    "note that @xmath318 and @xmath319 are independent of the ordering of the prime factors of @xmath99 .",
    "[ preksdef ] a _ pre - kolyvagin system _ @xmath262 ( for @xmath29 ) is a collection @xmath320 where @xmath177 , satisfying the following properties for every rational prime @xmath37 :    1 .   if @xmath267 , then @xmath321 .",
    "2 .   if @xmath207 , then @xmath322 3 .   if @xmath207 , then @xmath323 .",
    "4 .   if @xmath207 , then @xmath324 . 5 .   if @xmath270 , then @xmath325 .",
    "let @xmath326 denote the @xmath24-module of pre - kolyvagin systems for @xmath29 .",
    "[ pktok ] if @xmath327 is a pre - kolyvagin system , define @xmath328 by @xmath329    [ detmlem ] suppose @xmath285 and @xmath115 .    1 .   if @xmath330 then @xmath331 .",
    "2 .   if @xmath332 then @xmath333 .",
    "3 .   @xmath334 .",
    "suppose @xmath330 .",
    "the column of @xmath335 corresponding to @xmath37 consists of all zeros except for @xmath336 on the diagonal .",
    "the first assertion follows from this , and ( ii ) and ( iii ) follow directly from the definition .",
    "[ preksks ] the map @xmath337 of definition [ pktok ] is a @xmath24-module isomorphism @xmath338 between free @xmath24-modules of rank one .",
    "the @xmath24-linearity is clear .",
    "the injectivity is clear as well , since it follows easily by induction that if @xmath339 for all @xmath1 , then @xmath340 for all @xmath1 .",
    "we next show that if @xmath262 is a pre - kolyvagin system , then @xmath341 is a kolyvagin system . in other words ,",
    "we need to show for every @xmath285 that    1 .",
    "@xmath342 , 2 .",
    "if @xmath267 then @xmath343 , 3 .   if @xmath207 then @xmath344 , 4 .   if @xmath207 then @xmath345 , 5 .   if @xmath270 then @xmath346 .",
    "fix @xmath285 , and suppose that @xmath207 . then @xmath347 fix a divisor @xmath99 of @xmath348 . by lemma [ detmlem](i )",
    ", @xmath349 also , @xmath350 by definition [ preksdef](ii ) , so by lemma [ detmlem](ii ) @xmath351 thus @xmath352 for every @xmath37 dividing @xmath1 .",
    "since @xmath297 is a free @xmath24-module , it follows from proposition [ crit](iii ) that @xmath342 .",
    "this is property ( a ) above .    by ( a ) , and",
    "using that @xmath353 , we have @xmath354 if @xmath267 , then property ( i ) of definition [ preksdef ] of a pre - kolyvagin system shows that @xmath355 for every @xmath99 , so @xmath356 this is ( b ) .",
    "now suppose @xmath207 . for ( c )",
    ", using property ( i ) of definition [ preksdef ] we have @xmath357 projecting into @xmath198 , and using ( a ) , ( ii ) of definition [ preksdef ] , and lemma [ detmlem](ii ) , we have @xmath358 this is ( c ) . for ( d ) , using ( a ) , lemma [ detmlem](iii ) , and ( iv ) of definition [ preksdef ] we have @xmath359    finally , suppose that @xmath270 . using definition [ preksdef](v ) and property ( a ) above , @xmath360 this completes the proof that @xmath341 is a kolyvagin system .    since @xmath272 is a free @xmath24-module of rank one ( * ? ? ?",
    "* theorem 5.2.10(ii ) ) , to complete the proof it remains only to show that the map @xmath361 is surjective .",
    "if @xmath362 , then ( since @xmath363 ) we can define inductively a collection @xmath364 such that @xmath365 for every @xmath1 .",
    "it is straightforward to check that @xmath262 is a pre - kolyvagin system ; since we will not make use of this , we omit the proof . by definition [ pktok ]",
    "the image of @xmath262 in @xmath272 is @xmath341 .",
    "[ prekskscor ] suppose @xmath366 .",
    "if @xmath283 , then @xmath284 for every @xmath285 .",
    "let @xmath341 and @xmath367 be the images of @xmath262 and @xmath291 , respectively , under the map of definition [ pktok ]",
    ". then @xmath341 and @xmath367 are kolyvagin systems , and @xmath368 .",
    "therefore @xmath369 by theorem [ rankone ] , so by the injectivity assertion of proposition [ preksks ] we have @xmath370 , i.e. , @xmath284 for every @xmath285 .",
    "we will use the following definition and lemma to replace property ( iv ) in the definition of a pre - kolyvagin system by an equivalent property that will be easier to verify . see remark [ 5.9 ] below .",
    "[ symmdef ] if @xmath43 , let @xmath371 denote the set of permutations of the primes dividing @xmath40 , and let @xmath372 be the subset @xmath373 if @xmath374 let @xmath375 , the product of the primes not fixed by @xmath376 , and define @xmath377    [ 5.8 ] suppose that @xmath378 is an abelian group , @xmath37 is a prime that splits in @xmath17 , and @xmath379 for every @xmath285",
    ". then the following are equivalent :    1 .   for every @xmath1 divisible by @xmath37 , @xmath380 .",
    "2 .   for every @xmath1 divisible by @xmath37 , @xmath381 .",
    "we show first that ( ii ) implies ( i ) ( which is the implication we use later in this paper ) .",
    "let @xmath382 denote the derangements , i.e. , the permutations with no fixed points .",
    "then we can evaluate the determinant @xmath383 as follows .",
    "let @xmath384 be the @xmath385-entry in @xmath315 .",
    "then @xmath386 where the second equality holds since the diagonal entries of @xmath315 vanish .",
    "fix an @xmath1 divisible by @xmath37 , and let @xmath387 using property ( ii ) we have @xmath388 fix a divisor @xmath389 of @xmath40 that is divisible by @xmath37 .",
    "we will show that the coefficient of @xmath390 in @xmath391 in is @xmath392 , which exactly cancels the coefficient of @xmath390 in @xmath393 . using",
    ", the coefficient of @xmath390 in @xmath391 in is @xmath394 for every @xmath395 there is a unique triple @xmath396 such that @xmath397 to see this , simply write @xmath398 as a product of disjoint cycles , let @xmath376 be the cycle containing @xmath37 , and let @xmath399 and @xmath400 .",
    "thus the coefficient of @xmath390 in @xmath391 in is ( using again ) @xmath401 therefore @xmath402 , so ( i ) holds .",
    "although we will not need it , here is a simple argument to show that ( i ) implies ( ii ) .",
    "suppose that @xmath403 satisfies ( i ) .",
    "if @xmath404 , then ( since @xmath405 ) we can use ( i ) recursively to express @xmath406 as a linear combination of @xmath407 with @xmath332 .",
    "thus @xmath408 is uniquely determined by the subset @xmath409 .",
    "clearly @xmath410 determines a unique collection @xmath411 satisfying ( ii ) , with @xmath412 if @xmath267 .",
    "we showed above that ( ii ) implies ( i ) , so @xmath413 satisfies ( i ) .",
    "since ( i ) and @xmath410 uniquely determine both @xmath408 and @xmath413 , we must have @xmath414 , and so @xmath408 satisfies ( ii ) .",
    "[ 5.9 ] we will apply lemma [ 5.8 ] as follows .",
    "let @xmath415 , and let @xmath416 .",
    "then lemma [ 5.8 ] says that we can replace property ( iv ) in definition [ preksdef ] of a pre - kolyvagin system by the equivalent statement :    1 .",
    "if @xmath207 , then @xmath417",
    "fix an odd prime @xmath0 .",
    "if @xmath43 , let @xmath418 be the number of prime factors of @xmath134 . in this section we will show that the collection @xmath419 is a pre - kolyvagin system . recall that @xmath420    [ 9.4 ] if @xmath285 then @xmath421 where for @xmath422 , @xmath423 is the kolyvagin derivative class denoted @xmath424 in @xcite , or @xmath425 in ( * ? ? ?",
    "* appendix ) .",
    "this is proposition 9.4 of @xcite .",
    "s should be @xmath426 , as in ( * ? ? ?",
    "* lemma 8.1 ) . ]",
    "( note that @xmath424 in @xcite and @xmath425 in ( * ? ? ?",
    "* appendix ) are defined to lie in @xmath427 , after fixing generators of every @xmath189 . without fixing such choices ,",
    "the elements defined in @xcite and @xcite live naturally in @xmath428 . )",
    "[ thetapreks ] the collection @xmath419 is a pre - kolyvagin system .",
    "we need to check the five properties of definition [ preksdef ] . for @xmath422 ,",
    "let @xmath429 be as in proposition [ 9.4 ] .    since @xmath430 for every @xmath1",
    ", it follows easily by induction from proposition [ 9.4 ] that @xmath431 , where @xmath128 is the number of prime factors of @xmath40 .",
    "this is property ( i ) of definition [ preksdef ] .",
    "suppose @xmath207 .",
    "a standard property of cyclotomic units shows that @xmath432 it follows from the definition of @xmath70 that @xmath433 since @xmath207 we have @xmath434 , so this verifies property ( ii ) of definition [ preksdef ] .    projecting each of the summands in proposition [ 9.4 ] into @xmath428",
    ", one sees that all terms with @xmath94 vanish , yielding @xmath435 properties ( iii ) , ( iv ) , and ( v ) of definition [ preksdef ] follow from the corresponding properties of the @xmath436",
    ". see ( * ? ? ?",
    "* proposition a.2 ) or ( * ? ? ?",
    "* theorem 4.5.4 ) for ( iii ) , and ( * ? ? ?",
    "* theorem a.4 ) or ( * ? ?",
    "* proposition a.2 ) for property ( iv)@xmath437 of remark [ 5.9 ] .",
    "property ( v ) is immediate , since @xmath436 depends only on @xmath40 .",
    "in this section we study relations among the regulator elements @xmath124 , to show that the collection @xmath438 is a pre - kolyvagin system .",
    "[ cnr ] suppose @xmath43 , @xmath207 , and @xmath117 is a standard basis of @xmath89 with @xmath439 . then @xmath440 is a standard basis of @xmath441 , and we can choose an oriented basis @xmath442 of @xmath86 such that @xmath443 is an oriented basis of @xmath444 .    with any such bases , @xmath445 and @xmath446    everything except the final sentence is clear . comparing the determinants of the logarithmic embeddings @xmath447 with respect to our given bases",
    ", we see that @xmath448 because @xmath449 for @xmath450 . since our bases are oriented , both determinants are positive .",
    "hence @xmath451 so @xmath452 .    the exact sequence @xmath453 )      \\too \\pic(\\o_f[1/n ] ) \\too 0\\ ] ] shows that @xmath454 = h_{n/\\ell}/h_n,\\ ] ] so @xmath455 as claimed .",
    "since @xmath456 is unramified at @xmath457 , @xmath458 in @xmath459 .",
    "[ regreg1lem ] suppose @xmath43 , @xmath207 , and @xmath82 . then @xmath460    to compute @xmath124 , fix bases for @xmath89 and @xmath88 as in lemma [ cnr ] . by definition @xmath461",
    "and then @xmath462 is the determinant of the matrix obtained by applying @xmath463 to rows @xmath22 through @xmath87 of this matrix . for @xmath464 ,",
    "@xmath465 is a unit at @xmath457 , so the local artin symbol @xmath466 $ ] lies in the inertia group @xmath189 .",
    "hence @xmath467 for @xmath464 , and so @xmath468 the upper left @xmath122 determinant is the one used to define @xmath469 , so @xmath470 by lemma [ cnr ] .",
    "fix an odd prime @xmath0 as in   [ kssect ] and [ prekssect ] , and keep the rest of the notation of those sections as well .",
    "[ finlem ] if @xmath285 , @xmath37 is a prime not dividing @xmath1 , and @xmath82 , then @xmath471    since @xmath267 , if @xmath472 then @xmath473 . now",
    "the lemma is clear , since @xmath118 .",
    "[ fsprop ] suppose @xmath285 and @xmath207 .",
    "then @xmath474    note that @xmath475 is well - defined , since lemma [ finlem ] shows that @xmath476 .    as in the proof of proposition [ regreg1lem ] ,",
    "fix a basis @xmath117 of @xmath89 with @xmath477 , and an oriented basis @xmath442 of @xmath86 as in lemma [ cnr ] .",
    "then @xmath478 since @xmath479 , and @xmath480 for @xmath464 .",
    "( recall that when we evaluate these determinants using , the multiplicative notation in @xmath481 changes to additive notation in the tensor product @xmath482 , so @xmath61 s in the top row become @xmath63 s , and @xmath483 becomes @xmath484 .",
    ") we have @xmath445 by lemma [ cnr ] .",
    "for @xmath464 we have @xmath485 , so @xmath486 and @xmath487 thus @xmath488     & = \\frac{h_{n/\\ell}}{h_n } \\left| \\begin{array}{ccccccc } \\phifs_\\ell((\\epsilon_0)_{\\ell } ) & \\cdots & \\phifs_\\ell((\\epsilon_{r-1})_{\\ell } ) \\\\ \\grx{\\lambda_1}{n/\\ell}{\\epsilon_0}+\\grx{\\lambda_1}{\\ell}{\\epsilon_0 } & \\cdots      & \\grx{\\lambda_1}{n/\\ell}{\\epsilon_{r-1}}+\\grx{\\lambda_1}{\\ell}{\\epsilon_{r-1 } } \\\\ \\vdots & \\vdots & \\vdots\\\\ \\grx{\\lambda_{r-1}}{n/\\ell}{\\epsilon_0}+\\grx{\\lambda_{r-1}}{\\ell}{\\epsilon_0 } & \\cdots      & \\grx{\\lambda_{r-1}}{n/\\ell}{\\epsilon_{r-1}}+\\grx{\\lambda_{r-1}}{\\ell}{\\epsilon_{r-1 } }   \\end{array } \\right|\\end{aligned}\\ ] ] ( the @xmath489 because we moved column @xmath87 to column @xmath61 , and the @xmath490 because we moved row @xmath87 to row @xmath22 ) .",
    "when we expand the last determinant ( including expanding the sums @xmath491 ) , each term that includes one of the @xmath492 lies in @xmath493 ( since the top row also contributes one element of @xmath494 ) .",
    "thus all such terms project to zero in @xmath198 , and so @xmath495 where @xmath496.\\ ] ] but then @xmath497 , so the proposition follows .",
    "suppose @xmath498 , @xmath499 , and @xmath82 .",
    "define @xmath500 using any standard basis of @xmath89 and oriented basis of @xmath86 .",
    "in particular @xmath501 .    [ indstep ]",
    "suppose @xmath43 and @xmath267 .    1 .",
    "if @xmath37 is inert in @xmath17 , then @xmath502 .",
    "2 .   if @xmath37 splits in @xmath17 and @xmath503 , then @xmath504 in @xmath505 .    let @xmath128 be the number of prime divisors of @xmath40 , so @xmath506 and @xmath507 are free @xmath49-modules of rank @xmath87 .",
    "choose a standard basis of @xmath506 and an oriented basis of @xmath507 .",
    "for @xmath508 , let @xmath509 then @xmath510 where @xmath511 is the matrix whose top row is @xmath512 and whose @xmath513-st row for @xmath514 is @xmath515 if @xmath516 and @xmath517 if @xmath518 .",
    "note that @xmath519 , and that the entries of each @xmath515 are in @xmath277 .",
    "suppose first that @xmath37 is inert in @xmath17 , so @xmath520 .",
    "then @xmath521 if @xmath290 is nonempty ( since @xmath198 has no `` @xmath37 component '' ) , so shows that @xmath522 further , since @xmath37 is inert in @xmath17 we have @xmath523 , @xmath524 , and @xmath525 .",
    "thus @xmath526 , and so @xmath527 this is ( i ) .",
    "now suppose that @xmath37 splits in @xmath17 .",
    "since the entries of each @xmath515 are in @xmath494 , if @xmath528 we have @xmath529 . thus gives @xmath530 by definition of @xmath124 , @xmath531    to compute @xmath532 , let @xmath533 , and assume that our oriented basis of @xmath507 was chosen so that @xmath443 is an oriented basis of @xmath534 with respect to the standard basis of @xmath535 obtained by removing @xmath536 from @xmath537 . for @xmath538 , @xmath539 is a unit at @xmath540 , so @xmath541 .",
    "thus @xmath542 ( where the second determinant has no @xmath540 row ) .",
    "further , an argument identical to that of lemma [ cnr ] shows that @xmath543 therefore @xmath544 multiplying by @xmath545 and using gives @xmath546 since @xmath547 , we have @xmath548 this completes the proof of the proposition .    if @xmath43 , recall ( definition [ symmdef ] ) that @xmath371 denotes the set of permutations of the primes dividing @xmath40 , @xmath372 is the subset @xmath549 and if @xmath374 then @xmath550 and @xmath551 .",
    "[ finitepart ] if @xmath552 and @xmath207 , then @xmath553    as usual , fix a basis @xmath117 of @xmath89 with @xmath477 , and an oriented basis @xmath442 of @xmath86 as in lemma [ cnr ] , so that @xmath443 is an oriented basis of @xmath444 .",
    "then @xmath554 for each @xmath103 , we have @xmath555 .",
    "if @xmath464 , then @xmath465 is a unit at @xmath457 so @xmath556 .",
    "thus @xmath557 the map @xmath558 - 1 $ ] is an isomorphism from @xmath559 to @xmath560 , and is zero on @xmath561 because @xmath37 is a norm in the extension @xmath562 .",
    "hence the first determinant in the equation above is zero , because the top and bottom rows are linearly dependent .",
    "also , if @xmath464 then @xmath465 is a unit at @xmath457 , so @xmath563 and @xmath564 by lemma [ cnr ] , @xmath565 .",
    "thus @xmath566 we can now `` simplify '' by inductively expanding the right - hand side using proposition [ indstep ] .",
    "specifically , expand @xmath567 using proposition [ indstep](ii ) . then expand each of the resulting @xmath568 using proposition [ indstep](ii ) again",
    "continue until no terms @xmath569 remain .",
    "the resulting sum consists of one term @xmath570 for each sequence @xmath571 of distinct primes dividing @xmath40 ( with @xmath572 ) .",
    "identifying this sequence with the @xmath573-cycle @xmath574 gives the formula of the theorem , since @xmath575 .",
    "[ rpreks ] the collection @xmath438 is a pre - kolyvagin system .    we need to check the five properties of definition [ preksdef ] .",
    "property ( i ) is lemma [ finlem ] , ( ii ) is proposition [ regreg1lem ] , ( iii ) is proposition [ fsprop ] , ( iv ) is theorem [ finitepart ] along with of remark [ 5.9 ] , and ( v ) is proposition [ indstep](i ) .",
    "fix an odd prime @xmath0 . by theorems [ thetapreks ] and [ rpreks ]",
    ", we have pre - kolyvagin systems @xmath576 by proposition [ n=1 ] , @xmath577 in @xmath143 .",
    "hence by corollary [ prekskscor ] , @xmath578 if @xmath579 , then proposition [ crit](iv ) shows that @xmath580 .",
    "therefore @xmath581 and holds vacuously in this case .",
    "since holds for every @xmath43 and every odd prime @xmath0 , this completes the proof of theorem [ mainthm ] ."
  ],
  "abstract_text": [
    "<S> we use the theory of kolyvagin systems to prove ( most of ) a refined class number formula conjectured by darmon . </S>",
    "<S> we show that for every odd prime @xmath0 , each side of darmon s conjectured formula ( indexed by positive integers @xmath1 ) is `` almost '' a @xmath0-adic kolyvagin system as @xmath1 varies . </S>",
    "<S> using the fact that the space of kolyvagin systems is free of rank one over @xmath2 , we show that darmon s formula for arbitrary @xmath1 follows from the case @xmath3 , which in turn follows from classical formulas . </S>"
  ]
}