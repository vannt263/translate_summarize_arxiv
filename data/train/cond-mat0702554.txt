{
  "article_text": [
    "in electronic structure calculations for solids , the evaluation of an observable requires integrating a periodic function in reciprocal space.@xcite we will distinguish between three kinds of properties : those where the integral is over the brillouin zone ( type - i ) , over the fermi surface ( type - ii ) , and over an energy - difference isosurface ( type - iii ) . in many cases those integrals",
    "take , at @xmath1 , the form @xmath2 @xmath3 and @xmath4.\\ ] ] here @xmath5 is the fermi level , @xmath6 are the eigenenergies of the one - electron states , and @xmath7 involves matrix elements of periodic operators which commute with the crystal translations .",
    "ground - state properties such as the total energy , and dc response functions such as the hall conductivity , are examples of the first and second type of property , respectively .",
    "the third type includes optical absorption in the dipole approximation ; other response and spectral functions can be expressed in a similar form.@xcite eqs .",
    "( [ eq : type1])([eq : type3 ] ) are by no means exhaustive .",
    "while properties such as the electron - phonon interaction [ described by matrix elements of the form @xmath8 associated with phonon wavevector @xmath9 are not explicitly covered above , the methods discussed in this paper can be extended to handle such cases.@xcite    in a practical calculation the continuous integral is replaced by a summation over a finite number @xmath10 of points in the brillouin zone ( bz ) , @xmath11 where @xmath12 is the cell volume and @xmath13 are the @xmath0-point weights that arise upon restricting the summation to the irreducible wedge of the bz . for type - i properties of insulators ,",
    "the integrand varies smoothly across the bz and this summation converges rapidly with the number of sampled points.@xcite in metals the bz integral must be treated carefully , as the integrand is now discontinuous due to the partial filling of the energy bands .",
    "properties of type ii and iii pose the additional challenge of sampling isosurfaces in @xmath0-space accurately and efficiently .",
    "in all these other cases the rate of convergence is much slower than for ground state properties of insulators , and a very large number of @xmath0-points may be needed .",
    "this sampling problem severely limits the efficiency and accuracy of _ ab - initio _",
    "calculations for many properties . examples of such difficulties abound even in the recent literature , and include the magnetocrystalline anisotropy of ferromagnets@xcite and optical absorption in hot liquid metals,@xcite to name just a few .    in this paper",
    "we describe a widely - applicable wf - based scheme for interpolating both the energy bands @xmath6 and the matrix elements @xmath7 .",
    "the method was used in ref .   to compute the anomalous hall conductivity of iron .",
    "where possible , we have adopted a notation consistent with that work . ref .   dealt with a type - i problem ( the quantity being integrated over the bz was the berry curvature of the occupied states ) , and here we extend the method to problems of type ii and iii .",
    "as an example of a type - ii problem , we study the low - field classical hall coefficient of several cubic metals .",
    "this and other transport coefficients pose an additional challenge to existing _ ab - initio _ methodologies : how to evaluate the first and possibly also the second @xmath0-derivatives of the energy bands at the fermi level .",
    "early work@xcite employed tight - binding ( tb ) parameterizations of _ ab - initio _ bands and the derivatives were calculated by numerical differentiation using the linear tetrahedron method . in other work ,",
    "an analytic evaluation of the tb band gradients has been used to achieve improved numerical stability,@xcite but the second derivatives were still computed by finite differences .",
    "other interpolation strategies , such as the skw scheme@xcite and spectral differentiation,@xcite have also been used .",
    "all previous interpolation schemes have one feature in common : the only information retained from the original _ ab - initio _ calculation is the set of energy eigenvalues on a grid of @xmath0-points .",
    "hence the information about the connectivity of the bands is lost , and the interpolation becomes unreliable or even unstable in the vicinity of band crossings , avoided crossings , and near - degeneracies . moreover , retaining only the eigenenergies strongly restricts the type of matrix elements @xmath7 , and hence observables , that can be computed .",
    "a more powerful interpolation scheme can be obtained by keeping one more piece of information , namely , the overlap matrices between the bloch states at neighboring grid points as in eq .",
    "( [ eq : overlap ] ) below .",
    "it is perhaps not widely appreciated that the information about band connectivity is encoded in those overlap matrices .",
    "indeed , they are the key input for the wf - construction method,@xcite and the connectivity can be recovered from the wannier representation of the bandstructure .",
    "thus , not only do the wannier - interpolated bands reproduce the _ ab - initio _ bands with essentially no loss of accuracy , but their @xmath0-derivatives can also be evaluated analytically .",
    "like the skw scheme , the present method is based on fourier interpolation . unlike skw,@xcite however , it produces stable and reliable results even in the presence of band crossings and avoided crossings .    remarkably , a knowledge of the overlap matrices of eq .",
    "( [ eq : overlap ] ) allows for the interpolation of properties that are not determined by the energy bands alone , but also depend on the position ( or velocity ) matrix elements .",
    "( more generally , any one - electron operator can be interpolated if , in addition , its matrix elements between the wfs are tabulated . ) as an example , we compute the magnetic circular dichroism of iron , a type - iii property .    the paper is organized as follows .",
    "section  [ sec : interpol ] contains the methodological aspects of the work .",
    "we start by reviewing the wf construction methods .",
    "we then describe the wannier - interpolation strategy for a generic periodic operator .",
    "the interpolation of the velocity operator , as well as of band gradients and inverse effective masses , is discussed separately .",
    "we conclude sec .",
    "[ sec : interpol ] by presenting an improved broadening scheme for performing the @xmath0-space integrals . in sec .",
    "[ sec : hall ] we apply the technique to the low - field hall effect of several cubic metals , and in sec .",
    "[ sec : mcd ] to the magnetic circular dichroism of bcc fe . in sec .",
    "[ sec : conclusion ] we provide a brief discussion and conclusion .",
    "the appendix contains some convergence studies .",
    "_ ab - initio _ calculations provide a certain number of low - lying bloch eigenstates @xmath14 on a mesh of @xmath0-points in the bz , which we take to be uniform .",
    "we will denote points on this `` _ ab - initio _ mesh '' by @xmath15 , to distinguish them from arbitrary or interpolation points , which will be denoted by @xmath16 .",
    "consider a type - ii ( fermi - surface ) problem ; two situations may occur .",
    "the first one , which is seen in pb for example , occurs when the fermi level lies within an isolated group of @xmath17 bands , where by `` isolated '' we mean separated from all higher and lower bands by a gap throughout the bz . in this case",
    "it is possible to construct a set of @xmath17 wfs per unit cell spanning the hilbert space of the isolated bloch manifold .",
    "this can be done using the method of marzari and vanderbilt@xcite to obtain so - called maximally localized wannier functions for that isolated group of bands .",
    "the second scenario occurs when the bands of interest are `` entangled '' with other bands .",
    "then it is still possible , using the approach of souza , marzari , and vanderbilt,@xcite to construct a small number @xmath17 of maximally localized wfs which describe those bands exactly .",
    "the number @xmath17 of wfs per cell is now to some extent an adjustable parameter .",
    "the first step is to identify the subspace of states of interest .",
    "usually this is done by selecting the bands inside an energy window spanning from @xmath18 to @xmath19 .",
    "( for type - i and type - iii problems @xmath18 is normally in the gap below the lowest valence bands and the position of @xmath19 depends on the problem , but is always above @xmath5 . for a type - ii problem the only requirement is that @xmath20 , and in practice the range is adjusted so that wfs with good localization and symmetry properties result . )",
    "the number @xmath21 of states within this window can vary from one @xmath15-point to another , and we require that @xmath22 for all @xmath15 , so that the space spanned by the wfs ( the `` projected space '' ) can be chosen to contain as a subspace all the window states . in the method of ref .",
    "a second ( outer ) energy window is used which encloses the previously defined ( inner ) window . at each @xmath15 ,",
    "the @xmath17-dimensional projected space is a subspace of the @xmath23-dimensional space of states contained in the outer window .",
    "for the special case of an isolated group of @xmath17 bands it is natural to choose @xmath24    only two pieces of information from the _ ab - initio _ calculation are needed as an input to the wf - generation algorithm : the @xmath23 band - energy eigenvalues @xmath25 , and the @xmath26 overlap matrices between the cell - periodic bloch eigenstates at neighboring points @xmath15 and @xmath27 , @xmath28 the output consists of an @xmath29 matrix @xmath30 for each @xmath15 .",
    "these matrices relate the original set of @xmath23 _ ab - initio _ bloch eigenstates selected by the outer window to a new set of @xmath17 orthonormal bloch - like states @xmath31 that vary smoothly with @xmath15 .",
    "these states are labeled with a superscript ( w ) to indicate that the wfs are obtained from them by a direct fourier sum @xmath32 @xmath15-points and @xmath33 is the @xmath34-th wannier function in the unit cell at @xmath35 .",
    "although the explicit construction of the wfs obviously requires a knowledge of the @xmath36 s , only the eigenvalues @xmath25 and the overlaps @xmath37 are needed to obtain the @xmath38 matrices . retaining this minimal information from the _ ab - initio _ calculation is thus sufficient for many applications , including the ones presented in this work .",
    "an important object in what follows is the @xmath39 hamiltonian matrix in the projected subspace , @xmath40_{nm},\\end{aligned}\\ ] ] where @xmath41 is a diagonal @xmath42 matrix and @xmath43 .",
    "we diagonalize @xmath44 by finding an @xmath39 unitary matrix @xmath45 such that @xmath46 where @xmath47 . then @xmath48 will be identical to the original _ ab - initio _",
    "@xmath25 for all bands inside the inner window .",
    "the corresponding bloch states latexmath:[\\[\\label{eq : twist }    coincide with the _ ab - initio _ eigenstates @xmath36 inside the inner window .",
    "we shall refer to a quantity with a ( w ) or ( h ) superscript as belonging to the wannier or hamiltonian gauge respectively .",
    "the problem we pose for ourselves is the following one .",
    "suppose we are given a periodic operator operator @xmath50 , and we have computed at every @xmath15 @xmath51 its matrix elements between the @xmath23 _ ab - initio _ eigenstates in the outer energy window .",
    "how can we interpolate this matrix onto an arbitrary point @xmath16 ?",
    "we now show that this can be achieved once the matrices @xmath38 and the eigenvalues @xmath25 ( @xmath52 ) are known .",
    "naturally , we can only expect the interpolation onto a given @xmath16 to be meaningful for those matrix elements @xmath53 for which both @xmath54 and @xmath55 fall within the inner window .",
    "we start by describing in sec .",
    "[ sec : gauge_cov ] the interpolation strategy as it applies to most ( `` conventional '' ) properties .",
    "transport and optical properties merit a separate discussion , given in sec .",
    "[ sec : non_gauge_cov ] .      by analogy with eq .",
    "( [ eq : hamw ] ) , we define the @xmath39 matrix @xmath56_{nm}.\\end{aligned}\\ ] ] next we find its fourier sum @xmath57 this operation is done once and for all for each of the @xmath58 lattice vectors @xmath35 lying in a supercell conjugate to the @xmath15-mesh .",
    "( if the sum is performed using a fast fourier transform ( fft ) , the vectors @xmath35 will be disposed in a parallelepipedal supercell . ) using eq .",
    "( [ eq : wf ] ) we recognize in @xmath59 the matrix element of @xmath60 between wfs , @xmath61 in the above equations , the specification of the lattice vectors @xmath35 can be left ambiguous with respect to supercell translations ( @xmath62 since @xmath63 for all mesh points @xmath15 , and thus @xmath64 .",
    "however , we now wish to perform the inverse ( slow ) fourier transform @xmath65 which yields the interpolation of eq .",
    "( [ eq : opw ] ) onto an arbitrary point @xmath16 . at this point",
    "the set of lattice vectors must be defined more precisely , since for points @xmath16 not on the @xmath15-mesh @xmath66 , and the smoothness of interpolation will depend on the choice of set . using the fft parallelepipedal supercell , for example ,",
    "is generally not optimal .",
    "instead , one wants to choose lattice vectors lying inside the wigner - seitz ( ws ) supercell centered on the origin,@xcite but the details may vary ( e.g. , sharing weights of @xmath35-vectors lying on the boundary of the ws supercell , or truncation to a sphere lying within the ws supercell ) . in practice the @xmath67 decay exponentially with @xmath68 , as expected if the wfs are exponentially localized , so the results should not be very sensitive to this choice , when using a sufficiently dense @xmath15-mesh .",
    "these remarks are illustrated in the appendix .",
    "the final step is to transform the matrix of eq .",
    "( [ eq : op_k ] ) from the wannier to the hamiltonian gauge . to find the required unitary matrix @xmath69 we repeat the above steps for @xmath70 to obtain @xmath71 .",
    "the matrix @xmath69 is then given by eq .",
    "( [ eq : htrans ] ) , with the replacement @xmath72 . finally , @xmath73 where @xmath39 matrix products are implied on the right - hand side .",
    "this solves the problem posed above at the beginning of sec .",
    "[ sec : wanninterp ] .",
    "once the wf matrix elements of both the operator of interest and the hamiltonian are tabulated , the interpolation onto an arbitrary @xmath0-point requires only inexpensive operations on small @xmath39 matrices .",
    "when @xmath74 , the present scheme reduces to slater - koster interpolation , with the maximally localized wfs playing the role of the tb basis orbitals.@xcite    fig .",
    "1 shows the interpolated band structure of bcc fe along @xmath75h , using the same wfs and computational details as in ref .  .",
    "if one were to superimpose on this plot the energy bands obtained by performing an _ ab - initio _",
    "calculation for a large number of points along the same line in @xmath0-space , they would be essentially indistinguishable from the interpolated ones . following ref .",
    ", we indicate with vertical dashed lines @xmath0-points on the @xmath15-mesh used for constructing the wfs ( an @xmath76 grid in the full bz ) .",
    "it is apparent that the wannier interpolation procedure _ succeeds in resolving details on a scale much smaller than the spacing between those points . _",
    "in particular , _ the correct band connectivity is obtained .",
    "_ this means that spin - orbit - induced avoided crossings , for example , are never mistaken for actual crossings , no matter how weak the spin - orbit interaction .",
    "( color online . )",
    "wannier - interpolated bands of bcc fe along @xmath75h .",
    "the bands are color - coded according to the value of @xmath77 : red for spin up and blue for spin down .",
    "the energies are given in ev and the fermi level is at 0  ev .",
    "the vertical dashed lines indicate @xmath0-points on the _ ab - initio _ mesh used for constructing the wfs . ]",
    "we note in passing that one could have formulated the problem at the beginning of sec .",
    "[ sec : wanninterp ] somewhat differently : rather than viewing the matrix elements of @xmath60 and @xmath78 between the @xmath23 _ ab - initio _ bloch states at each @xmath15 as the basic ingredients of the method , we could have assigned that role to the matrix elements of the two operators between the wfs . even if the latter viewpoint is in some ways the more fundamental one , in practical implementations one often obtains the wannier matrix elements ( [ eq : opwr_b ] ) via eqs .",
    "( [ eq : op_abinitio])([eq : opwr ] ) . when doing so , the wannier orbitals are never explicitly constructed .",
    "the treatment of transport and optical properties in crystals is more subtle .",
    "we will restrict our discussion to the electric - dipole approximation , where those properties depend on matrix elements of the velocity operator .",
    "the formulation of the previous subsection could in principle be used to interpolate the full velocity operator @xmath79 $ ] ( @xmath80 ) .",
    "its matrix elements , as those of any other periodic operator , transform between the wannier and hamiltonian gauges according to eq .",
    "( [ eq : gauge_cov ] ) ( such a matrix will be called `` gauge - covariant''@xcite ) .",
    "they are given by@xcite @xmath81    however , when describing the dynamics of electrons in crystals it is convenient , from the points of view of both numerics and physics , to decompose the velocity operator into two terms.@xcite this is achieved by taking @xmath82 outside the brackets on the right - hand side of eq .",
    "( [ eq : vel ] ) and compensating for the extra terms that appear . after a few manipulations one obtains @xmath83 where @xmath84    the first ( second ) term on the right - hand side of eq .",
    "( [ eq : vel_b ] ) is diagonal ( off - diagonal ) in the band index .",
    "note that neither is separately gauge - covariant . for example",
    ", the second one contains @xmath0-derivatives acting on the eigenstates . according to eq .",
    "( [ eq : twist ] ) , additional terms involving @xmath85 will therefore appear when transforming between the wannier and hamiltonian gauges .",
    "let us define , for every matrix object  @xmath86 , @xmath87 so that , by definition , @xmath88 only for gauge - covariant objects .",
    "this notation will be used in the next section for expressing the intraband ( diagonal ) velocity matrix elements and the effective mass tensor , and in sec .",
    "[ sec : mcd ] for the interband ( off - diagonal ) velocity .",
    "we make use of the first and second @xmath0-derivatives of the hamiltonian matrix , @xmath89 @xmath90 and define @xmath91 and @xmath92 via eq .",
    "( [ eq : utrans ] ) as usual .",
    "we also define the first and second @xmath0-derivatives of the band energy , @xmath93 @xmath94 which have the interpretation of group velocity ( ignoring berry - curvature contributions ) and inverse effective mass tensor , respectively .",
    "the strategy for interpolating these quantities is similar to the one developed in ref .   for the berry curvature .",
    "we will again make extensive use of the antihermitian matrix @xmath95 defined in that work .",
    "first we consider the band - gradient velocity , eq .",
    "( [ eq : band_vel ] ) . in the hamiltonian gauge @xmath96 , and",
    "hence @xmath97 .",
    "differentiating eq .",
    "( [ eq : htrans ] ) with respect to @xmath98 , @xmath99 where each object is an @xmath39 matrix and h.c .  denotes the hermitian conjugate . because of the extra terms in curly brackets we have @xmath100 and thus @xmath101 , the first term on the right - hand side of eq .",
    "( [ eq : vel_b ] ) , is not gauge - covariant .",
    "however , those extra terms do not contribute to the velocity ; being the product of a diagonal matrix ( @xmath102 ) with an antihermitian matrix ( @xmath103 ) , they only contain off - diagonal elements which cancel those in @xmath104 .",
    "thus @xmath105_{nn}.\\ ] ]    differentiating this equation yields the inverse effective mass tensor ( [ eq : mass ] ) @xmath106_{nn}\\nonumber\\\\ & = & \\big[u^\\dagger h\\pw_{\\alpha\\beta } u\\big]_{nn}+ \\big\\{u^\\dagger h\\pw_{\\alpha } \\partial_{\\beta}u   + { \\rm h.c.}\\big\\}_{nn } \\nonumber\\\\ & = & \\overline{h}\\ph_{nn,\\alpha\\beta}+ \\big\\{\\overline{h}\\ph_{\\alpha}d\\ph_{\\beta}+{\\rm h.c.}\\big\\}_{nn}.\\end{aligned}\\ ] ] unlike eq .  ( [ eq : hder ] ) , here the matrix in curly brackets has nonzero diagonal elements which contribute to @xmath107 .",
    "( [ eq : vel_interpol])([eq : inv - mass1 ] ) are the desired expressions for the band derivatives , valid away from degeneracies and inside the inner energy window .",
    "they involve the @xmath39 matrices @xmath69 calculated in sec .",
    "[ sec : gauge_cov ] , @xmath103 given by eq .",
    "( [ eq : ddef ] ) , @xmath108 , and @xmath109 .",
    "the last two involve @xmath0-derivatives of eq .",
    "( [ eq : op_k ] ) that can be taken analytically , i.e. , @xmath110 and @xmath111      in order to interpret the above expressions it is illuminating to introduce @xmath112 , the @xmath34-th @xmath17-component column vector of @xmath113.@xcite @xmath112 is an eigenvector of @xmath114 , the hamiltonian operator projected onto the wf space .",
    "we then recognize in eq .",
    "( [ eq : vel_interpol ] ) the hellmann - feynman result @xmath115 , and in eq .",
    "( [ eq : inv - mass1 ] ) the expression for the effective mass tensor in empirical tb theory.@xcite eq .",
    "( [ eq : ddef ] ) is the standard result from @xmath116 perturbation theory , in terms of the tb states .",
    "it involves the operator @xmath117 , which differs from the full velocity operator in that the position - operator - dependent terms are absent.@xcite we note that all the formulas given so far and in the rest of the paper remain valid when the _ ab - initio _ hamiltonian contains non - local and spin - orbit terms .",
    "the advantage of this reformulation of @xmath118 perturbation theory is that it is done strictly in terms of the small number @xmath17 of @xmath17-dimensional states @xmath112 at an arbitrary @xmath16 , and yet it is exact within the inner energy window .",
    "in contrast , the formulation in terms of the original _ ab - initio _ states on the @xmath15-grid is considerably more expensive and usually entails a truncation error.@xcite      while meaningful band derivatives can be defined via degenerate @xmath116 perturbation theory even at degeneracy points in the bz,@xcite this is not possible when the only information available about the bandstructure is a list of eigenenergies on a predetermined coarse @xmath0-point grid . in that case , the information about the band connectivity is lost , and finite - difference estimates of the derivatives become ill - defined at points of degeneracy , which have to be carefully avoided.@xcite    in the present formulation the @xmath0-gradients of the degenerate states are the eigenvalues of the submatrix @xmath119_{\\mu\\nu}= \\la\\phi_\\mu\\vt h\\pw_\\alpha\\vt\\phi_\\nu\\ra,\\ ] ] where the indices @xmath120 and @xmath121 run over the degenerate states only .",
    "we update the @xmath39 matrix @xmath113 by replacing the columns corresponding to those states with the rotated states that diagonalize @xmath108 .",
    "the hessian matrix can then be obtained from eq .",
    "( [ eq : inv - mass1 ] ) using the updated @xmath113 and a modified form of eq .",
    "( [ eq : ddef ] ) ,    @xmath122    in cases of degeneracies ( at band edges , for example ) where some of the eigenvalues of the matrix ( [ eq : degen1 ] ) are equal , a first - order treatment is inadequate and the correct rotation between eigenstates needed to compute the hessian is found by going to second order in degenerate perturbation theory .",
    "this amounts to diagonalizing the submatrix obtained from the right - hand side of eq .",
    "( [ eq : inv - mass1 ] ) by replacing the subscripts @xmath123 therein by @xmath124 , and letting @xmath120 and @xmath121 run over the the first - order - degenerate bands .",
    "the desired hessian matrix elements are the eigenvalues of that submatrix .    in our calculations",
    "we employ the first - order form of degenerate perturbation theory when two or more energy eigenvalues lie within 10@xmath125  ev of each other and we subsequently use the second - order form if in addition two or more band gradients differ by less than 0.1  ev -  .",
    "upper panel : dispersion of the three @xmath126-like energy bands of pb along the @xmath75k direction , obtained by interpolating a non - relativistic _ ab - initio _ calculation .",
    "lower panel : inverse effective masses of those bands along the same direction , calculated in two ways : from the interpolated eigenenergies on a regular mesh of points using a spline fit ( circles ) , and from perturbation theory in the wannier representation ( solid lines ) . ]    as an illustration , we used the above formulas to calculate the inverse effective mass of the three @xmath126-like valence bands of pb along the @xmath75k direction in @xmath0-space .",
    "( we have chosen this example because it displays a threefold band - edge degeneracy at @xmath75 and a band crossing between @xmath75 and k. )    in all the calculations in this work , lattice constants are taken from ref .  .",
    "the bloch states are obtained with the pwscf code@xcite using density - functional theory in the local - density approximation , together with the planewave - pseudopotential formalism.@xcite norm - conserving pseudopotentials are employed , and spin - orbit effects are included in sec .",
    "[ sec : mcd ] and fig .",
    "[ fig : fe - bands ] only .",
    "the wfs are generated using the wannier90 code.@xcite    in pb the lowest four valence bands crossing the fermi level are separated everywhere in the brillouin zone from higher bands , so that the original prescription of marzari and vanderbilt@xcite can be used to generate the corresponding maximally localized wfs .",
    "they are atom - centered and have @xmath127 character , with the axis of each orbital pointing towards a nearest neighbor .    the inverse effective masses are shown as solid lines in the lower panel of fig .  [ fig : lead - curve ] . for comparison ,",
    "we also plot as circles in the lower panel the values obtained by fitting a spline function to the energy eigenvalues on a dense grid of @xmath0-points along the path .",
    "we remark that whereas in the analytic method band crossings are handled automatically , in order to obtain a smooth spline fit it was necessary to manually reorder the eigenvalues close to the band crossing .",
    "once that is done , the agreement between the two is essentially perfect .",
    "we conclude this section by discussing the evaluation of type - i , ii , and iii integrals , eqs .",
    "( [ eq : type1][eq : type3 ] ) . in order to accelerate the convergence of type - i integrals with respect to the number of sampling points in eq .",
    "( [ eq : kgrid ] ) , a broadening scheme can be used.@xcite this amounts to replacing the step function in eq .",
    "( [ eq : type1 ] ) with a fermi - dirac - like smearing function . in the case of type - i integrals ,",
    "smearing is most important when relatively few sampling points are used , as tends to be the case whenever the evaluation of the integrand is expensive.@xcite if , however , the integrand is inexpensive , as is the case when using wannier interpolation , then it is possible to converge the bz integral without resorting to smearing . for example",
    ", no smearing was used in ref .   for integrating the berry curvature over the occupied states of bcc fe .",
    "smearing plays a more fundamental role in integrals of types ii and iii : when replacing the bz integral in eqs .",
    "( [ eq : type2]-[eq : type3 ] ) by a grid summation , the @xmath128-functions must be replaced by normalized functions with non - zero width , such as gaussians .",
    "for example , in eq .",
    "( [ eq : type2 ] ) one would replace @xmath129 by @xmath130 ideally the gaussian width should be , for a given grid spacing @xmath131 , comparable with the level spacing @xmath132 .",
    "the level spacing is however difficult to estimate , and the common practice is to set @xmath133 to a constant for all bands and @xmath0-points . as a result , fs sheets arising from steep and flat bands are not described consistently .",
    "this is a serious disadvantage of broadening schemes with respect to the linear tetrahedron method , as discussed in ref .  .",
    "this drawback is easy to remedy within the wannier - interpolation method , since the band derivatives are readily available ( sec .",
    "[ sec : grad_hess ] ) , and can be used to estimate the level spacing .",
    "the simple estimate @xmath134 suggests using a state - depending broadening width @xmath135 for type - i and type - ii integrals ( @xmath136 is a dimensionless constant of the order of unity ) , and @xmath137 for type - iii integrals . with this prescription @xmath133",
    "is no longer an independent adjustable parameter from @xmath131 , guaranteeing that the @xmath138 and @xmath139 limits are approached consistently .",
    "several smearing functions beyond a simple gaussian have been proposed@xcite and can be used straight forwardly with the adaptive smearing scheme . for all of the calculations presented in this work",
    "we use the first - order hermite polynomial scheme introduced by methfessel and paxton.@xcite    the above first - order adaptive smearing should be reliable whenever the level - spacing is gradient - dominated . in practice we find that it works rather well even near critical points.this is illustrated in fig .",
    "[ fig : smearing ] , where we show the density of states of diamond calculated using both the adaptive and conventional ( fixed width ) smearing , with a @xmath140 interpolation mesh .",
    "when using a fixed width of @xmath141  ev , the sharp van - hove features are not well described . reducing it to 0.2",
    "ev improves the situation for some of them , but introduces spurious oscillations whenever the level - spacing becomes larger than @xmath133 . with the adaptive scheme such oscillations do not occur for a sensible choice of @xmath136 , and",
    "the sharp features are well - described .",
    "we have used @xmath142 , but find the results to be quite robust for @xmath143 .",
    "( color online . )",
    "density of states of bulk diamond calculated in the range 8 - 18ev using the conventional gaussian broadening approach ( light thin lines ) with a fixed width of 0.4  ev in the upper panel and 0.2  ev in the lower panel , versus the adaptive broadening approach ( dark thick lines ) .",
    "the inset shows the density of states in the full valence band range computed with the adaptive broadening approach . ]",
    "as a first benchmark application we compute the `` classical '' low - field hall coefficient of cubic metals , which is given by @xmath144 @xmath145 and @xmath146 ( for the systems studied in this section , which are non - ferromagnetic and do not include the spin - orbit interaction , the sum over spin - degenerate bands will give rise to factors of two , which are not written explicitly . )",
    "@xmath147 is the longitudinal conductivity , and and @xmath148 , where @xmath149 is the antisymmetric ( hall ) conductivity .",
    "the above expressions are obtained from a bloch - boltzmann description of transport ; for a detailed derivation , see ref .  .",
    "we note that eq .",
    "( [ eq : sigma_xy ] ) is written in a form which is specific to cubic metals .",
    "the quantities @xmath150 and @xmath151 are given by eqs .",
    "( [ eq : band_vel ] ) and ( [ eq : mass ] ) , @xmath152 is the fermi - dirac distribution function , and @xmath153 is the electron charge . at low temperatures",
    "@xmath154 tends to @xmath155 , and both @xmath147 and @xmath156 become fs integrals of the form of eq .",
    "( [ eq : type2 ] ) . in the constant relaxation - time approximation",
    "@xmath157 drops out from eq .",
    "( [ eq : rh ] ) so that @xmath158 is completely specified by the first and second band derivatives at @xmath5 .",
    "calculations were done for li , al , cu and pd . unlike pb , in these metals the set of bands crossing the fermi level is not isolated . therefore , in order to generate maximally localized wfs we first used the disentanglement procedure summarized in sec .",
    "[ sec : wf_gen ] to obtain an optimal projected space .",
    "the number of bands contained therein must be at least equal to the number of bands crossing the fermi level .",
    "however , it is often desirable to extract a somewhat larger projected space if this produces a more symmetric set of wannier functions .    for lithium we obtained four atom - centered wfs per primitive cell with @xmath127 character .",
    "for aluminum we extracted a nine - dimensional projected subspace .",
    "the resulting wfs are atom - centered , but have no distinct symmetry characteristics . for cu and pd we used seven wfs : five with @xmath159 character on atom centers , and two with @xmath160 character located at the tetrahedral interstitial sites .",
    "these have been previously described for cu in ref .  .",
    "the computational details are the same as in section [ sec : examples ] .",
    "we obtain the self - consistent ground state using a 16@xmath16116@xmath16116 monkhorst - pack mesh of @xmath0-points and a fictitious fermi smearing@xcite of 0.02ry for the brillouin - zone integration .",
    "we use the local density approximation ; for the materials studied we find the results are not significantly altered by using a gga such as pbe.@xcite    .",
    "[ table : hall ] hall coefficient @xmath158 , in units of @xmath162m@xmath163c@xmath164 .",
    "references to the experimental data can be found in ref .  .",
    "[ cols=\"<,^,^,^,^\",options=\"header \" , ]     to compute the hall coefficient we use an _ ab - initio _ grid of 12@xmath16112@xmath16112 * q*-points and obtain the required quantities on a uniform mesh of 60@xmath16160@xmath16160 @xmath16-points .",
    "we implement an adaptive mesh refinement scheme in which we identify those points of the @xmath0-space mesh at which at least one band lies with 0.5ev of the fermi energy and obtain the required quantities on a @xmath165 submesh spanning the original cell associated with this mesh point .",
    "we find these parameters give converged values of the hall coefficient for the four metals studied .",
    "this is particularly reassuring in the case of pd , where previous techniques encountered difficulties because of the occurrence of bands crossings near the fermi surface.@xcite    the results for the hall coefficient @xmath158 are compiled in table  [ table : hall ] . for li , al , and",
    "cu we find excellent agreement with previous calculations based on empirical tb fitting to _ ab - initio _ bands,@xcite as well as _",
    "ab - initio _ calculation combined with skw interpolation.@xcite the case of pd is more delicate as @xmath158 depends critically on the details of the _ ab - initio _ calculation .",
    "for example a shift upwards ( downwards ) in the fermi level of 0.002ry causes a change of @xmath1663  ( + 2 )  @xmath167m@xmath163c@xmath164 . in view of this",
    "we refine the position of the fermi level in a final non - self - consistent step by interpolating the band energies and gradients onto a @xmath168 @xmath16-mesh and using the adaptive broadening scheme .",
    "our converged value of @xmath158 is intermediate between the two previously computed values , and shows a relatively large discrepancy with experiment .",
    "previous authors have suggested@xcite that it maybe necessary to go beyond the constant relaxation time approximation to give a good description of the transport properties of pd .",
    "magneto - optical effects in ferromagnets result from a combination of exchange splitting and spin - orbit coupling ( soc).@xcite the former breaks time - reversal ( tr ) in the spin channel , and the latter transmits the tr - breaking to the orbital motion of the electrons , endowing the optical conductivity tensor with an antisymmetric component .",
    "the simplest such effect to evaluate is magnetic circular dichroism ( mcd ) , the difference in absorption between left- and right - circularly - polarized light , and we have chosen it for illustrative purposes .",
    "it is given by the imaginary part of the antisymmetric conductivity , @xmath169 .",
    "_ ab - initio _ calculations of magneto - optical effects demand high accuracy and dense @xmath0-space sampling .",
    "the spin - orbit interaction is typically a small perturbation on top of the much larger exchange splitting , and the modifications that it produces on the electronic structure ( both in the energy bands and in the matrix elements ) are subtly and strongly dependent on @xmath0-point and band index .",
    "the conductivity @xmath170 is evaluated from the kubo formula of linear - response theory in the electric - dipole approximation.@xcite the needed ingredients are the energy eigenvalues of the states involved in the optical transitions and the transition matrix elements",
    ". we will evaluate the interband contribution to the magneto - optical absorption using eq .",
    "( [ eq : vel_b ] ) for the electric - dipole transition matrix elements , where it is now understood that all bloch functions @xmath171 are spinors determined from a hamiltonian that includes the spin - orbit interaction .",
    "one finds @xmath172,\\end{aligned}\\ ] ] where @xmath173 .",
    "( [ eq : sigma_mcd ] ) is a type - iii integral of the form of eq .",
    "( [ eq : type3 ] ) .",
    "when evaluating it by wannier interpolation it must be kept in mind that the wannier - derived bands reproduce the _ ab - initio _ ones only inside the inner energy window , and therefore its range must be adjusted according to the maximum desired absorption frequency .",
    "the matrix elements @xmath174 are to be evaluated in the hamiltonian gauge , and the interpolation of @xmath175 is based on the two relations@xcite @xmath176 and @xmath177 where @xmath178 is given by eq .",
    "( [ eq : ddef ] ) and @xmath179 and @xmath180 are related by eq .",
    "( [ eq : utrans ] ) . inserting eq .",
    "( [ eq : ata ] ) into @xmath181 in eq .",
    "( [ eq : sigma_mcd ] ) , we find @xmath182 the contributions to @xmath183 from the three terms on the right - hand side will be denoted as @xmath184@xmath184 , @xmath185@xmath184 , and @xmath185@xmath185 , respectively .",
    "magnetic circular dichroism spectrum of bcc iron .",
    "the calculated spectrum ( solid lines ) is compared with the experimental spectrum from ref .   as reproduced in ref .",
    "( open circles ) . ]",
    "( color online . )",
    "upper panel : decomposition of the magnetic circular dichroism spectrum into the three terms defined by the wannier - interpolation procedure .",
    "lower panel : cumulative anomalous hall conductivity ( ahc ) versus @xmath186 , defined as the contribution to the ahc from frequencies higher than @xmath186 in eq .",
    "( [ eq : kk ] ) . ]    unlike the calculations presented earlier in the paper , to calculate the mcd spectrum we have used relativistic pseudopotentials which explicitly include spin - orbit effects.@xcite the computational details for the _ ab - initio _ calculation , wf - generation , and treatment of the spin - orbit interaction are the same as in ref .  .",
    "the integral in eq .",
    "( [ eq : sigma_mcd ] ) was evaluated on a uniform @xmath16-mesh containing @xmath187 points using the adaptive broadening scheme , which we find to be essential for resolving the fine details in the mcd spectrum .",
    "the spin magnetization is along the @xmath188-axis , so that @xmath189 is the only independent non - zero component .",
    "it is conventional to plot the mcd spectrum as @xmath190 , and adopt this convention in fig .",
    "[ fig : mcd ] .",
    "our calculated spectrum for bcc fe is in excellent agreement with the one computed in ref .   using a completely different electronic structure method .",
    "( previous calculations of magneto - optical effects have most commonly used all - electron methods . ) as remarked in ref .  , this level of agreement between two different calculations is non - trivial when it comes to the spin - orbit - induced @xmath191 .",
    "it provides a strong validation of the wannier - interpolation scheme combined with the pseudopotential - planewave method as a viable way of computing magneto - optical effects .",
    "the upper panel of fig .",
    "[ fig : mcd_contrib ] shows the decomposition of the calculated mcd spectrum into the three contributions ( @xmath184@xmath184 , @xmath185@xmath184 , and @xmath185@xmath185 ) defined by the wannier - interpolation procedure , as discussed following eq .",
    "( [ eq : aa ] ) .",
    "it is clear that the @xmath185@xmath185 contribution tends to dominate the spectrum in the frequency range from 0 to 7  ev , especially at the lowest frequencies . for frequencies above 7",
    "ev ( not shown ) , the @xmath184@xmath184 and @xmath185@xmath184 terms become significant .",
    "the interband mcd spectrum @xmath191 is related to the karplus - luttinger anomalous hall conductivity@xcite ( ahc ) @xmath192 by the kramers - krnig relation @xmath193 in the lower panel of fig .",
    "[ fig : mcd_contrib ] we show the cumulative ahc versus @xmath186 , defined as the contribution to the ahc from frequencies higher than @xmath186 in eq .",
    "( [ eq : kk ] ) . in practice",
    "we use as the upper frequency limit in eq .",
    "( [ eq : kk ] ) the difference from the fermi energy to the top of the inner energy window ( 18  ev ) .",
    "it is clear that the ahc is completely dominated by the low - frequency contributions below @xmath194  ev .",
    "it can be shown that applying the transformation ( [ eq : kk ] ) separately to the @xmath185@xmath185 term of the mcd spectrum yields the @xmath185@xmath185 term of the ahc , as defined in ref .  .",
    "this explains the intriguing result that more than 99% of the anomalous hall conductivity can be recovered from the @xmath185@xmath185 term alone.@xcite this is a consequence of ( i ) the low - frequency part of the spectrum being weighted more in the integral as a result of the @xmath195 factor in the integrand , and ( ii ) the @xmath185@xmath185 term overwhelming the other two at very low frequencies .",
    "we have presented a wannier - interpolation scheme to compute efficiently and accurately fermi - surface and spectral properties from first principles . as an example of the former we computed the low - field hall conductivity for several cubic metals . as an example of the latter we calculated the magnetic circular dichroism spectrum of bcc fe .",
    "the scheme naturally resolves a number of difficulties which have plagued existing interpolation schemes .",
    "firstly , by preserving the information about band connectivity , band crossings and avoided crossings are treated correctly .",
    "in addition , the evaluation of the velocity matrix elements needed to compute both the hall coefficient and the mcd spectrum can be done analytically in the wannier representation .",
    "furthermore , the scheme does not become any more complex upon inclusion of the spin - orbit interaction in the hamiltonian .",
    "in particular , there are no additional contributions to the velocity matrix elements ; all the spin - orbit - related corrections are contained in the spinor wfs .",
    "also , the wannier - interpolation scheme is decoupled from the particular choice of basis set used for performing the original _ ab - initio _ calculation , nor does it depend on the specific level of single - particle theory . as such , the calculation of a given property can be implemented in a universal way inside the wannier module , which can then be interfaced with any desired electronic structure code .",
    "the appeal of the present approach is that it combines the simplicity of a tight - binding - like scheme with the power and accuracy of _ ab - initio _ methods .",
    "most importantly , _ it allows operators other than the hamiltonian to be interpolated in the same manner as the slater - koster interpolation of energy bands . _ as such , it can be applied to a wide variety of problems in condensed matter physics .",
    "it should be particularly useful for studying metallic systems .",
    "a number of properties of metals remain extremely challenging to compute from first - principles , as a result of difficulties in sampling the fermi surface with sufficient accuracy .",
    "wannier interpolation provides an elegant and powerful framework for investigating such problems with _ ab - initio _ techniques .",
    "this work was supported by the laboratory directed research and development program of lawrence berkeley national laboratory under the department of energy contract no .",
    "de - ac02 - 05ch11231 , and by nsf grant 0549198 .",
    "convergence of the wannier interpolated band energies as a function of the linear dimensions @xmath196 of the _ ab - initio _ @xmath15-point grid .",
    "we plot the maximum error ( squares ) and mean absolute error ( circles ) , where the error is the difference between the wannier interpolated band energy and the value obtained from a full non - self consistent diagonalization of the planewave hamiltonian .",
    "the lines are linear fits to the points with @xmath197 . ]",
    "( color online . )",
    "comparison of interpolated band - energies for pb obtained using sets of lattice vectors defined within wigner - seitz ( ws ) and parallelepipedal ( p ) supercells .",
    "upper figure : energy bands interpolated using a @xmath198 @xmath15-point grid ( ws cell  solid lines , p cell  dashed lines ) . full _ ab - initio _ results are shown as open circles . lower figure : convergence of the wannier - interpolated band energies for the two supercells as a function of the linear dimensions @xmath196 of the @xmath15-point grid .",
    "details as in fig .",
    "[ fig : band - conv ] . ]    for a given operator @xmath199 the agreement inside the inner energy window between @xmath200 obtained by wannier interpolation and @xmath201 calculated using a full first - principles calculation is determined by @xmath58 , the number of points in the @xmath15-grid .",
    "the resulting wfs are periodic over the the conjugate real - space supercell spanning @xmath58 unit cells .",
    "for any finite @xmath58 there is some overlap between a wf and its neighboring periodic images , which affects the matrix @xmath202 .",
    "it is generally accepted that wfs decay exponentially ; numerical studies have confirmed this for several materials,@xcite and recently there has been a claim of a formal proof for multiband time - reversal - invariant insulators.@xcite the error in @xmath202 , and therefore in the interpolation , should accordingly also decrease exponentially beyond some supercell size .",
    "we report numerical tests for two cases : the isolated set of four valence bands in pb , and the low - lying bands of li , using the same wfs as in secs .",
    "[ sec : examples ] and  [ sec : hall ] , respectively .",
    "the band energies are computed via both wannier interpolation and non - self - consistent diagonalization of the planewave hamiltonian on a @xmath203 bz grid .",
    "for li we collect data from the bottom of the inner energy window to 0.5ev below the top of the inner energy window ; points close to the top of the inner window may show larger discrepancies , as they result from an interpolation between @xmath15-points inside and outside the inner window . fig .",
    "[ fig : band - conv ] shows several measures of the difference in the energies as a function of @xmath196 . in both cases",
    "we find that the error decreases exponentially for @xmath204 .",
    "it is particularly reassuring that this occurs in li , since the decay properties of disentangled wfs has yet to be investigated thoroughly , and they probably fall outside the scope of existing formal proofs of exponential decay .",
    "finally , we examine the optimal choice of supercell in which to define the set of lattice vectors @xmath35 for the fourier transform in eq .",
    "( [ eq : op_k ] ) . to illustrate the discussion introduced earlier in the vicinity of eq .",
    "( [ eq : op_k ] ) , we compare the results for parallelepipedal and wigner - seitz supercells . in the upper part of fig .",
    "[ fig : wigner_vs_par ] we compare the interpolated energy bands for a @xmath205 grid of @xmath15-points .",
    "for such a sparse @xmath15-grid the interpolated bands do not agree precisely with the exact _ ab - initio _ bands from a non - self - consistent diagonalization of the planewave hamiltonian ; this is most noticeable in the deviation of the curvature of the three upper bands between k and @xmath75 .",
    "however , it is clear that the wigner - seitz supercell yields significantly better results than the parallelepipedal cell .",
    "this is most clear for the upper band from l to @xmath75 , which displays large oscillations for the parallelepipedal cell . in the lower portion of fig .",
    "[ fig : wigner_vs_par ] , we show several measures of the error in the interpolated bands as a function of @xmath196 ; for any given @xmath15-grid the wigner - seitz cell gives the more accurate results .",
    "the superiority of the wigner - seitz choice can be easily understood , as it ensures the largest minimum distance between a wf and its periodic images ."
  ],
  "abstract_text": [
    "<S> we present an efficient first - principles approach for calculating fermi surface averages and spectral properties of solids , and use it to compute the low - field hall coefficient of several cubic metals and the magnetic circular dichroism of iron . </S>",
    "<S> the first step is to perform a conventional first - principles calculation and store the low - lying bloch functions evaluated on a uniform grid of @xmath0-points in the brillouin zone . </S>",
    "<S> we then map those states onto a set of maximally - localized wannier functions , and evaluate the matrix elements of the hamiltonian and the other needed operators between the wannier orbitals , thus setting up an `` exact tight - binding model . '' in this compact representation the @xmath0-space quantities are evaluated inexpensively using a generalized slater - koster interpolation . because of the strong localization of the wannier orbitals in real space , the smoothness and accuracy of the @xmath0-space interpolation increases rapidly with the number of grid points originally used to construct the wannier functions . </S>",
    "<S> this allows @xmath0-space integrals to be performed with _ </S>",
    "<S> ab - initio _ accuracy at low cost . in the wannier representation , band gradients , effective masses , and other @xmath0-derivatives needed for transport and optical coefficients can be evaluated analytically , producing numerically stable results even at band crossings and near weak avoided crossings .    o v u </S>"
  ]
}