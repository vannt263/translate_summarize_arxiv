{
  "article_text": [
    "in recent years several stochastic wave function methods have been developed and used to describe the dynamics of open quantum systems @xcite .",
    "all these approaches are based on the following idea : instead of solving the quantum master equation to obtain the time evolution of the reduced density matrix , an ensemble of pure states is propagated using a stochastic time evolution .",
    "this method provides two major advantages : the individual sample paths of the different realizations can  in some situations  be interpreted as the time evolution of an individual continuously monitored quantum system @xcite and the scaling of the numerical performance with the system size is better for this approach @xcite .",
    "a particular interesting situation considered in quantum optics is the coupling of a system ( e.  g. , an atom or a cavity ) to the continuum of modes of the electromagnetic field . since a lot of theoretical and experimental effort",
    "is used to prepare the environment in certain well defined states which are not restricted to thermal mixtures ( see , e.  g. , @xcite ) , it is interesting to investigate the time evolution of an open quantum system which is coupled to an environment in an arbitrary state .",
    "one way to obtain the stochastic time evolution of the reduced system takes as its starting point the quantum master equation for the reduced density matrix .",
    "a stochastic wave function is constructed on a phenomenological basis in the following way : start with an ensemble of pure states representing the initial density matrix @xmath0 and propagate each member of the ensemble using a stochastic time evolution which guarantees that the covariance matrix of the stochastic process is the reduced density matrix .",
    "this procedure ensures that expectation values of system observables are calculated correctly .    in applications of open quantum systems",
    "one is also interested in multitime correlation functions such as @xmath1 , where @xmath2 and @xmath3 are heisenberg operators , and the angular brackets denote the ensemble average . in the density matrix approach these quantities",
    "are usually determined by making use of the quantum regression theorem @xcite which is based on the identity @xmath4 where @xmath5 denotes the trace over the system s degrees of freedom and @xmath6 is the time evolution super operator of the corresponding quantum master equation , and @xmath7 and @xmath8 are schrdinger operators .",
    "( [ q_reg_eq ] ) allows the following interpretation : for the calculation of @xmath1 start with the density matrix @xmath0 and propagate to @xmath9 using the quantum master equation .",
    "then propagate the `` density matrix '' @xmath10 up to the time @xmath11 and calculate the quantum mechanical expectation value of @xmath7 with respect to this density matrix .",
    "however , since @xmath10 is , in general , not a positive matrix ( and hence not a true density matrix ) , it can not be expressed as an ensemble of pure states and hence a direct generalization of this computational scheme to the stochastic wave function approach is not possible . instead",
    ", some alternative computational schemes are proposed in the literature such as expressing time - ordered multitime correlation functions as the sum of symmetric time - ordered correlation functions @xcite which can be simulated directly , or using the heisenberg picture of the quantum state diffusion model @xcite .    in this article",
    "we will present a different approach to the derivation of the stochastic time evolution which is formulated within the framework of probability distributions on projective hilbert space @xcite .",
    "the starting point for this approach is not the quantum master equation for the reduced density matrix , but a microscopic model for the dynamics of the total system .",
    "this model is used to calculate the unitary time evolution of the total system in second order perturbation theory , which leads to a liouville equation for the corresponding probability distribution .",
    "the equation of motion of the reduced system s probability distribution is obtained by invoking a specific reduction formula , which relies upon the above stated condition that expectations of system operators are calculated accurately , and performing the markov approximation .",
    "this scheme allows the derivation of the stochastic time evolution of an open quantum system coupled to an environment which is in an almost arbitrary state . to be more precise , the only restrictions we impose on the state of the environment concern the relative time scales of the system s and the environment s time evolution .",
    "note , that this restriction is not fundamental but necessary in order to end up with a markovian dynamics of the reduced system .    to construct a stochastic process that allows also the determination of multitime correlation functions we shall follow in this article the following strategy : multitime correlation functions are expressed in terms of matrix elements of reduced heisenberg picture operators which can be written as expectation values in a _ doubled _ hilbert space .",
    "this then enables the formulation of a stochastic process in the doubled hilbert space which fulfills the condition , that matrix elements of reduced heisenberg picture operators and hence multitime correlation functions are calculated correctly .",
    "this article is organized as follows : in sect .",
    "[ prob_dist ] we will briefly review the statistical description of quantum systems in terms of probability distributions on the underlying hilbert space .",
    "[ deri ] describes the derivation of the equation of motion of the reduced system s probability density functional .",
    "we find that the time evolution of this probability density is governed by a liouville ",
    "master equation .",
    "the resulting stochastic process is thus a piecewise deterministic markov process . in sec .",
    "[ heis ] we define the matrix elements of the reduced heisenberg picture operators . we show that these matrix elements can be determined by simulating a stochastic process in a doubled hilbert space which is again a piecewise deterministic markov process .",
    "the process defined in the doubled hilbert space is used to calculate arbitrary measurable multitime correlation functions , which is shown in sec .",
    "[ mult_corr ] . in order to illustrate the general theory presented in this article we explicitly discuss some examples of quantum optical systems in sec .",
    "[ examples ] .",
    "the basis for a description of open quantum systems in terms of a stochastic wave function is the definition of a probability measure on the underlying hilbert space @xmath12 . in this article",
    "we will make use of the probability density functional @xmath13 $ ] which is defined such that @xmath13d\\psi d\\psi^*$ ] is the probability of finding the state of the system in the volume element @xmath14 around @xmath15 at time @xmath16 @xcite .",
    "the volume element of the hilbert space is defined as @xmath17 where @xmath18 labels a complete set of quantum numbers .",
    "thus , the normalization of @xmath13 $ ] reads @xmath19=1,\\ ] ] where the integral extends over the hilbert space @xmath12 . in order to be consistent with the general principles of quantum mechanics we have to impose two further conditions on @xmath13",
    "$ ] : i ) since two state vectors which only differ by a phase factor describe the same physical state , we require that @xmath13 $ ] does not depend on the phase of the state vector and ii ) we are only interested in normalized state vectors , so that the support of @xmath13 $ ] is the unit sphere in the hilbert space @xmath12 . the quantum mechanical expectation value of an arbitrary linear operator @xmath7 with respect to @xmath13 $ ] is defined as @xmath20}\\equiv    \\int d\\psi d\\psi^*\\langle\\psi|a|\\psi\\rangle p[\\psi , t].\\ ] ] for the composition of two statistically independent subsystems , which are described by two probability distributions @xmath21 and @xmath22 on the hilbert spaces @xmath23 and @xmath24 , respectively , we further define the tensor product probability distribution @xmath25 $ ] on @xmath26 as @xcite @xmath27&=&\\int d\\psi d\\psi^*\\int d\\varphi d\\varphi^*\\nonumber\\\\    & \\times&\\delta[\\psi-\\psi\\otimes\\varphi]p_1[\\psi , t]p_2[\\varphi , t],\\end{aligned}\\ ] ] where @xmath28 $ ] is the functional delta distribution , and write as a short hand notation @xmath29=p_1[\\cdot , t]\\otimes p_2[\\cdot , t]$ ] .",
    "the connection to the standard density matrix description of statistical ensembles is made through the identity @xmath30.\\ ] ] hence , the density matrix is the covariance matrix of the stochastic process .",
    "in this section we derive the equation of motion for the probability distribution of the states of an open system . to this end , we first describe briefly the class of models we want to treat ( sec .  [ model ] ) .",
    "we then introduce in sec .",
    "[ wca ] the weak coupling assumption which enables us to derive an expression for the conditional transition probability @xmath31 $ ] , where @xmath15 , @xmath32 are pure states of the open system ( sec .",
    "[ cond_prob ] ) .",
    "this result will be further simplified by making the markov approximation ( sec .",
    "[ ma ] ) , and finally be used to obtain the desired equation of motion ( sec .  [ eq_mo ] ) .",
    "consider an open quantum system in the hilbert space @xmath23 with hamiltonian @xmath33 interacting with an environment consisting of harmonic oscillators , e.  g. , the electromagnetic field modes .",
    "the pure states of the environment are elements of the hilbert space @xmath24 and the hamiltonian @xmath34 of the environment is given by @xmath35 where we set @xmath36 for simplicity . throughout this article",
    ", @xmath37 denotes the annihilation operator for the field mode @xmath38 with frequency @xmath39 , unit wave vector @xmath40 , and polarization index @xmath41 .",
    "the initial condition for the state of the environment at time @xmath42 is given by a probability distribution @xmath43=\\sum_\\alpha p_\\alpha\\int_0^{2\\pi } \\frac{d\\chi}{2\\pi }    \\delta[\\varphi - e^{i\\chi}\\varphi_\\alpha],\\ ] ] where the @xmath44 are positive , normalized weights , i.e. , @xmath45 and the @xmath46 are arbitrary normalized states in @xmath24 .",
    "it is important to note that we do not suppose that the @xmath46 are orthogonal , i.e. , the initial condition eq .",
    "( [ env_init_eq ] ) also includes arbitrary mixtures of coherent states .",
    "we further assume that the system under consideration and the environment are statistically independent at time @xmath42 , i.e. , that the probability distribution of the total system factorizes at time @xmath42 ( cf .",
    "( [ prod_def_eq ] ) ) .",
    "the interaction of the system with its environment is modeled via the interaction hamiltonian @xmath47 where the operators @xmath48 and @xmath49 are defined as @xmath50 the @xmath51 are the ( real ) coupling constants . for optical systems @xmath7 and @xmath52 could be , for example , the positive and negative frequency part of the dipole operator .",
    "it is useful to assume that the @xmath48 are eigenoperators of @xmath33 , i.e. , @xmath53=\\omega_ia_i$ ] with @xmath54 , and @xmath55 , where @xmath56 is the system frequency .",
    "this is no restriction since this can always be achieved by choosing appropriate linear combinations of @xmath7 and @xmath52 .",
    "this type of coupling describes for example the interaction of a two level system or a harmonic oscillator with a quantized electromagnetic field in the rotating wave approximation , which is of particular interest in quantum optics .",
    "note that the restriction to this kind of coupling has only technical reasons .",
    "the generalization of the presented theory to a coupling involving more than one system operator @xmath7 , which was considered for example in ref .",
    "@xcite , is straightforward .",
    "the hamiltonian of the total system is @xmath57    in order to simplify the discussion in sec .",
    "[ ma ] , where we state the conditions necessary to perform the markov approximation , we will introduce at this point a decomposition of the hilbert space of the environment into the hilbert space @xmath58 which is the state space of the bath and the hilbert space @xmath59 which describes the driving field .",
    "this decomposition reflects the fact that the electromagnetic field which interacts with the system is in general produced by different sources which can have totally different effects on the system .",
    "this decomposition is defined as follows :    let @xmath60 be the set of modes @xmath61 for which @xmath62}= 0 $ ] , i.e. , the modes which do not contribute to the average electromagnetic field and @xmath63 be the set of modes @xmath61 for which @xmath62}\\neq 0 $ ] .",
    "then we define the hilbert space of the bath @xmath58 as @xmath64 where @xmath65 is the hilbert space of the field mode @xmath61 , and similarly we define the hilbert space @xmath59 of the driving field .",
    "obviously we have @xmath66 .",
    "we further assume that the states belonging to @xmath58 and @xmath59 are statistically independent , i.e. , the probability distribution of the environment can be written as @xmath67 , where @xmath68 and @xmath69 are the probability distributions on the bath space and on the space of the driving field respectively .",
    "this assumption is reasonable since the two fields are usually generated by different and independent sources .    with the above definitions in mind we can decompose accordingly the operators @xmath49 as follows : @xmath70 where @xmath71 and @xmath72 for the expectations of the operators @xmath49 we thus obtain @xmath73}=\\langle\\!\\langle",
    "b_i^{\\mbox{\\scriptsize dr}}\\rangle\\!\\rangle_{p_{\\mbox{\\tiny dr}}[\\cdot , t]},\\ ] ] i.e. , the expectation of the electromagnetic field only depends on the state of the driving field and is independent of the state of the bath .",
    "for the two time correlation function @xmath74}$ ] , where @xmath75 , we find @xmath76}&= &    \\langle\\!\\langle { b_i^{\\mbox{\\scriptsize b}}}^\\dagger ( s ) b_j^{\\mbox{\\scriptsize b } }    \\rangle\\!\\rangle_{p_{\\mbox{\\tiny b}}[\\cdot , t]}\\nonumber\\\\    & + &   \\langle\\!\\langle { b_i^{\\mbox{\\scriptsize dr}}}^\\dagger ( s)b_j^{\\mbox{\\scriptsize dr } }    \\rangle\\!\\rangle_{p_{\\mbox{\\tiny dr}}[\\cdot , t]},\\end{aligned}\\ ] ] which means that this correlation functions can be split into the sum of two terms , where the first term only depends on the state of the bath and the second term is due to the driving field .      the basis of the weak coupling assumption is the fact that the environment is large compared to the system .",
    "hence it is assumed that the dynamics of the environment is given by its free time evolution ; the perturbations due to the interaction with the system under consideration can be neglected . for the probability distribution of the environment",
    "this means @xmath77=\\sum_\\alpha p_\\alpha\\int_0^{2\\pi}\\frac{d\\chi}{2\\pi }    \\delta\\left[\\varphi - e^{i\\chi}e^{-ih_2(t - t_0)}\\varphi_\\alpha\\right]\\ ] ] for all @xmath16 , and we have chosen the initial condition given in eq .",
    "( [ env_init_eq ] ) .    using the weak coupling assumption",
    ", we can further evaluate the expressions for the bath correlation functions @xmath78}$ ] defined in sec .",
    "[ model ] , if the states of the _ individual bath modes _ are statistically independent , which means that the probability distribution of the bath is the product of probability distributions @xmath79 on the hilbert spaces @xmath65 of the individual bath modes @xmath61 .",
    "this will be the case for the examples we want to treat in this article .",
    "we obtain for example @xmath80 }    = \\sum_{k\\in{\\cal k}_{\\mbox{\\scriptsize b } } } g_k^2e^{i\\omega s }    \\langle\\!\\langle   b_k^\\dagger b_k\\rangle\\!\\rangle_{p_{k}[\\cdot , t_0]}.\\ ] ] it is important to note , that this correlation function only depends on the time argument @xmath81 and the state of the bath at time @xmath42 ; it is independent of the time @xmath16 .      in this section",
    "we focus on the description of the dynamics of the reduced system evolving from the initial distribution of the total system @xmath82=p_1[\\cdot , t_0]\\otimes   p_2[\\cdot , t_0]\\ ] ] ( cf .",
    "( [ prod_def_eq ] ) for the definition of the tensor product probability distribution ) , where @xmath83=\\int_0^{2\\pi } \\frac{d\\chi}{2\\pi } \\delta[\\psi - e^{i\\chi}\\psi_0],\\ ] ] and @xmath84 $ ] is given by eq .",
    "( [ env_init_eq ] ) .",
    "thus at time @xmath42",
    "the system is in the pure state @xmath32 and the initial distribution of the environment is given by the probability distribution @xmath22 .",
    "the dynamics of the reduced system is completely described through the conditional transition probability @xmath85 $ ] , which is the probability that the system is in the state @xmath15 at time @xmath86 _ under the condition _ that the system is in the state @xmath32 at time @xmath42 . in order to do this",
    ", we will start in sec .",
    "[ pure_sep_dyn ] with the calculation of the time evolution of the pure product state @xmath87 in second order perturbation theory . using this result",
    "we can calculate @xmath88 $ ] and applying a reduction formula ( sec .",
    "[ cond_prob ] ) , we finally obtain an exact expression for the conditional transition probability .",
    "it is important to note that the conditional transition probability @xmath85 $ ] also defines the dynamics of the reduced system , if its initial state is given by an arbitrary probability distribution @xmath89 $ ] . according to the general laws of probability theory the propagated reduced probability distribution",
    "@xmath90 $ ] given the conditional transition probability @xmath91 is @xmath92=\\int d\\psi_0 d\\psi_0^*t[\\psi , t_0+\\tau|\\psi_0,t_0 ]     p_1[\\psi_0,t_0].\\ ] ] thus it is sufficient to consider the initial conditions eq .",
    "( [ p_1_in_eq ] ) .      in this section",
    "we will study the time evolution of the initial distribution eq .",
    "( [ p_in_eq ] ) in second order perturbation theory . to this end",
    ", we have to calculate the time evolution of the pure product state @xmath87 . in the interaction picture which coincides with the schrdinger picture at time @xmath42 ,",
    "the operators @xmath93 are given by @xmath94 since @xmath48 is an eigenoperator of @xmath33 , and the operators @xmath95 are given by @xmath96 in second order perturbation theory we obtain for the propagated state @xmath97 where the first and second order propagation operators acting on the states of the environment are @xmath98 if we define the averages of @xmath99 and @xmath100 with respect to the probability distribution of the environment as @xmath101},\\quad g_{ij}\\equiv\\langle\\!\\langle g_{ij}\\rangle\\!\\rangle_{p_2[\\cdot , t_0]},\\ ] ] and the shifted operators @xmath102 and @xmath103 as @xmath104 we can rewrite eq .",
    "( [ pert ] ) as @xmath105 where we introduced the time evolution operator @xmath106 which is defined as @xmath107 as we will show in sec .",
    "[ cond_prob ] , eq .",
    "( [ pert2_eq ] ) is the basis for the construction of a specific reduction formula .",
    "we can also use eq .",
    "( [ pert2_eq ] ) to determine the time evolution of the probability distribution of the total system if the initial probability distribution is given by eq .",
    "( [ p_in_eq ] ) . for the propagated distribution @xmath88",
    "$ ] we simply obtain @xmath108=\\sum_\\alpha p_\\alpha\\int_0^{2\\pi}\\frac{d\\chi}{2\\pi }     \\delta[\\psi - e^{i\\chi}\\psi_\\alpha(t_0+\\tau)],\\ ] ] where the states @xmath109 are the propagated states defined in eq .",
    "( [ pert2_eq ] ) .",
    "the key to the stochastic description of open quantum systems is the reduction formula @xcite .",
    "the reduction formula states how the conditional transition probability @xmath85 $ ] is defined given the probability distribution @xmath25 $ ] ( cf .",
    "( [ p_prop_eq ] ) ) on the state space of the total system @xmath110 . in order to derive an appropriate expression for @xmath91 we require the following necessary condition to hold : @xmath111\\nonumber\\\\    & \\stackrel{!}{=}&\\int d\\psi d\\psi^ * \\langle\\psi|c|\\psi\\rangle     t[\\psi , t_0+\\tau|\\psi_0,t_0],\\end{aligned}\\ ] ] or in the more compact notation introduced in sec .",
    "[ prob_dist ] @xmath112 }    \\stackrel{!}{=}\\langle\\!\\langle c     \\rangle\\!\\rangle_{t[\\cdot , t_0+\\tau|\\psi_0,t_0]}.\\ ] ] note that the integral on the left - hand side of eq .",
    "( [ exp_cond_full_eq ] ) extends over the hilbert space @xmath113 , whereas the integral on the right - hand side only extends over the reduced state space @xmath23 .",
    "the above condition ensures that the time evolution of the expectation value of an arbitrary operator @xmath114 acting on the total system s state space calculated using the distribution @xmath88 $ ] is the same as the expectation value of @xmath115 with respect to @xmath85 $ ] .",
    "however , there are infinitely many ways to construct a reduced probability distribution which fulfills the above condition , just as there are infinitely many ways to express an arbitrary density matrix as an ensemble of pure states @xcite , and each reduced probability distribution will define a different stochastic process . in ref .",
    "@xcite it was shown that different processes can be formulated using different `` reduction bases '' ( which are bases of the hilbert space of the environment ) .",
    "these processes were interpreted as the time evolution of a continuously monitored individual quantum system and each process was related to a specific measurement scheme @xcite .    here , we will follow a different approach , which has the advantage that it results in a particular simple , basis - free reduction formula , but which is not based on a specific measurement scheme . if we insert the propagated probability distribution of the total system eq .",
    "( [ p_prop_eq ] ) in the left - hand side of the consistency condition eq .",
    "( [ exp_cond_eq ] ) and neglect terms of the order @xmath116 we obtain @xmath117}&=&\\langle{\\psi_0}|l^\\dagger c l|{\\psi_0}\\rangle\\nonumber\\\\ & & + \\sum_{i , j}\\gamma_{ij}\\langle{\\psi_0}| a_i^\\dagger c a_j|{\\psi_0}\\rangle,\\end{aligned}\\ ] ] where we introduced the @xmath118correlation matrix of the environment @xmath119 }    = -(g_{ij}+g_{ji}^*+f_i^*f_j),\\ ] ] and @xmath120 and @xmath121 are defined in eq .",
    "( [ f_g_eq ] ) .",
    "note that @xmath122 is hermitian and non - negative .",
    "if we denote the normalized eigenvectors of @xmath122 by @xmath123 , and its eigenvalues by @xmath124 , and define the system ( jump- ) operators as @xmath125 then eq .",
    "( [ exp_prop ] ) can be written as @xmath126}&= &    \\langle{\\psi_0}|l^\\dagger c l|{\\psi_0}\\rangle\\nonumber\\\\    & & + \\sum_{i}\\widetilde{\\lambda}_i\\langle{\\psi_0}| j_i^\\dagger c     j_i|{\\psi_0}\\rangle\\nonumber\\\\    & \\stackrel{!}{=}&\\langle\\!\\langle c     \\rangle\\!\\rangle_{t[\\cdot , t_0+\\tau|\\psi_0,t_0]}.\\end{aligned}\\ ] ] consider the following conditional transition probability : @xmath127&=&w\\delta[\\psi- w^{-1/2}l\\psi_0]\\nonumber\\\\    & + & \\sum_{i}\\tilde{\\lambda}_i    w_i\\delta[\\psi - w_i^{-1/2}j_i\\psi_0],\\end{aligned}\\ ] ] where @xmath128 , and @xmath129 . obviously , the conditional transition probability defined by eq .",
    "( [ t_eq ] ) satisfies the necessary condition eq .",
    "( [ exp_cond_eq ] ) .",
    "since in the generic case the matrix @xmath122 is nondegenerated we find three contributions to @xmath91 : the system can evolve into the state @xmath130 , or to one of the two states @xmath131 , and @xmath132 .",
    "note , that the expression for the conditional transition probability eq .",
    "( [ t_eq ] ) is _ exact _ within second order perturbation theory ; however , its derivation is based on the special choice of the initial probability distribution eq .",
    "( [ p_in_eq ] ) and the complete dynamics of the environment is contained in the functions @xmath133 , @xmath134 , @xmath124 , and the operators @xmath106 , and @xmath135 .      in sec .",
    "[ cond_prob ] we derived an expression for the conditional transition probability @xmath85 $ ] ( cf .",
    "eq .  ( [ t_eq ] ) ) which is exact within second order perturbation theory",
    ". however , in situations where the environment has a large number of degrees of freedom , this formula is of little practical use for computations without further approximations .",
    "the simplest approximation scheme resulting in a conditional transition probability which is independent of the actual state of the environment , is the markov approximation .",
    "we will use this approximation to calculate the quantities involving the state of the environment , namely the ensemble average of the first order propagation operator @xmath120 ( cf .",
    "( [ f_eq ] ) and  ( [ f_g_eq ] ) ) and the ensemble average of the second order propagation operator @xmath121 ( cf .  eqs .",
    "( [ g_eq ] ) , and  ( [ f_g_eq ] ) ) .",
    "this will be done in sec .",
    "[ f_calc ] and sec .",
    "[ g_calc ] , respectively .",
    "these results will then be combined in sec .",
    "[ t_ma_sec ] in order to establish an approximate expression for the conditional transition probability .",
    "we can simply calculate the ensemble average @xmath120 of the first order propagation operator @xmath99 ( cf .",
    "( [ f_eq ] ) ) by taylor expansion .",
    "to first order in @xmath136 we obtain : @xmath137 where @xmath138 is the mean electromagnetic field at time @xmath42 , weighted with respect to the coupling constants @xmath51 , and the probability distribution @xmath139 $ ] . using eq .",
    "( [ exp_eq ] ) we find @xmath140}=    \\sum_{k\\in{\\cal k}_{\\mbox{\\scriptsize dr}}}g_k    \\langle\\!\\langle b_k\\rangle\\!\\rangle_{p_{\\mbox{\\tiny dr}}[\\cdot , t_0]}.\\ ] ] obviously , the quantities @xmath120 only depend on the driving field and are independent of the state of the bath",
    ". however , the validity of this approximation is limited to the validity of the taylor expansion to first order in @xmath136 , and this is guaranteed by the condition @xmath141 where @xmath142 is the correlation time of the mean electromagnetic field ; this correlation time is of the order of magnitude of the inverse bandwidth of the spectrum of the driving field .      performing a taylor expansion of eq .",
    "( [ g_eq ] ) with respect to @xmath136 in order to calculate the ensemble average of the second order propagation operator @xmath121 we are lead to a vanishing first order term , i.e. , @xmath121 is at least quadratic in @xmath136 . however , this taylor expansion is only valid for a propagation time @xmath136 which is small compared to the decay time of the correlation function of the environment @xmath143}$ ] . since this correlation function is the sum of the correlation function of the bath and the driving field ( cf",
    "( [ exp1_eq ] ) ) , we find that @xmath121 is the sum of two terms , where the first one depends only on the state of the bath , and the second depends only on the state of the driving field , i.e. , @xmath144 since we focus our interest on situations , where the decay time @xmath145 of the bath correlation is very small compared to the decay time @xmath146 of the driving field correlation ( which is equal to @xmath142 for a coherent driving field ) and to the time scale @xmath147 of the systematic dynamics , we have to use an appropriate approximation of @xmath121 for `` medium '' values of @xmath136 , i.e. , for values of @xmath136 for which @xmath148 in this case , the bath correlation function leads to a contribution @xmath149 linear in @xmath136 whereas the driving field correlation function leads to a term @xmath150 which is quadratic in @xmath136 ; thus we will neglect the latter . by describing the dynamics of the open system on a _ coarse grained _ time axis , i.e. , by neglecting time variations which are smaller than @xmath145",
    "we can perform the markov approximation and extend the range of the integration over @xmath151 in eq .",
    "( [ g_eq ] ) to infinity .",
    "the result to first order in @xmath136 is @xmath152}.\\ ] ] we can simplify this further by evaluating the above integral , as shown in appendix  [ g_ij_app ] .",
    "the result is : @xmath153 if the individual bath modes are statistically independent then the real constants @xmath154 and @xmath155 , and the complex constant @xmath156 do not depend on the time @xmath42 .",
    "this would not be the case if some bath modes with different frequencies were not statistically independent .      in this section",
    ", we will combine the results of sec .",
    "[ cond_prob ] , where we derived an exact expression for the time evolution of the conditional transition probability , with the approximations developed in secs .",
    "[ f_calc ] and [ g_calc ] , to obtain the short time dynamics of the conditional transition probability in markov approximation .",
    "we shall begin with the evaluation of the correlation matrix of the environment @xmath122 : inserting eqs .",
    "( [ f_app_eq ] ) and ( [ g_11_0_eq ] ) into eq .",
    "( [ gamm_eq ] ) , we find to first order in @xmath136 @xmath157 by computing the eigenvalues @xmath158 and the corresponding normalized eigenvectors @xmath159 of @xmath122 , we obtain using eq .",
    "( [ j_op_eq ] ) the jump operators @xmath135 .",
    "( in order to simplify the notation , we do not write the @xmath42dependency of @xmath158 and @xmath160 explicitly . )    furthermore , we can calculate the operator @xmath106 , which describes the smooth time evolution of the reduced system , by inserting eqs .",
    "( [ f_app_eq ] ) and ( [ g_11_0_eq ] ) into eq .",
    "( [ l_eq ] ) .",
    "the result to first order in @xmath136 is @xmath161 where the three operators @xmath162 , @xmath163 , and @xmath164 , which account for the influence of the environment on the open system are defined below .",
    "we can distinguish the effects of the two sources of the electromagnetic field :    \\1 .",
    "the driving field : using eq .",
    "( [ f_app_eq ] ) we find @xmath165 this is precisely the operator , which has to be added to the hamiltonian of a quantum system in the presence of a classical electromagnetic field ( according to the principle of minimal substitution ) or a coherent driving field @xcite .",
    "however , this result is also true for more general driving fields , since the only assumptions we have to make about the nature of the driving field concern its correlation times @xmath142 and @xmath146 ( cf .",
    "[ f_calc ] and [ g_calc ] ) .",
    "the bath : using eq .",
    "( [ g_11_0_eq ] ) we find @xmath166 where @xmath167 is a hermitian operator which leads to small energy shifts  the lamb shift @xmath168 and the stark shift @xmath155 .",
    "the non - hermitian operator @xmath169 describes the damping due to the coupling to the bath .",
    "if we define @xmath170 , then the damping operator can also be written as @xmath171 using eq .",
    "( [ h_d_1_eq ] ) and the fact that @xmath164 is the only non - hermitian operator which contributes to the operator @xmath106 , it is clear that the weight @xmath172 is given by @xmath173 the latter equality ensures that @xmath174 , which is equivalent to the normalization of the conditional transition probability .    summing up the above results and transforming back to the schrdinger picture , we finally obtain the conditional transition probability in the markov approximation @xmath175&=&\\left(1-\\gamma\\tau\\sum_i\\lambda_i       ||j_i\\psi_0||^2\\right)\\nonumber\\\\      & \\hspace*{-8em}\\times&\\hspace*{-4em }      \\delta\\left[\\psi-\\left(i - i\\tau g\\left(t_0\\right)\\right)\\psi_0       \\right]\\nonumber\\\\      & \\hspace*{-8em}+&\\hspace*{-4em}\\gamma\\tau\\sum_i\\lambda_i||j_i\\psi_0||^2    \\delta\\left[\\psi-\\frac{j_i\\psi_0}{||j_i\\psi_0||}\\right].\\end{aligned}\\ ] ] here , we introduced the nonlinear time evolution operator @xcite @xmath176 and the effective system hamiltonian @xmath177 note , that the deterministic propagation with the nonlinear operator @xmath178 conserves the norm of the propagated state and thus confines the dynamics to the unit sphere of the hilbert space of the system .",
    "the following comment may be helpful .",
    "if we combine the two approximations we made ( second order perturbation theory and the markov approximation ) with the weak coupling assumption and assume that the probability distribution @xmath179 $ ] of the total system factorizes at time @xmath42 , i.e. , @xmath180=p_1[\\cdot , t_0 ] \\otimes p_2[\\cdot , t_0]$ ] , then the probability distribution @xmath88 $ ] of the total system at time @xmath86 can be approximated by @xmath181=p_1[\\cdot , t_0+\\tau]\\otimes p_2[\\cdot , t_0+\\tau],\\ ] ] where @xmath182 $ ] is given by eqs .",
    "( [ p_prop_1_eq ] ) and ( [ trans_eq ] ) and @xmath183 $ ] by eq .",
    "( [ bath_mo ] ) , i.e. , @xmath184 $ ] approximately factorizes .",
    "thus we can use the same scheme for the calculation of the conditional transition probability @xmath185 $ ] and by repeating this argument , we find that @xmath29 $ ] factorizes for all @xmath16 .",
    "hence , the dynamics of the reduced system is markovian .",
    "one possible starting point for the derivation of the differential equation of motion for the reduced probability distribution is the infinitesimal generator @xmath186 of the process @xcite , which is defined by its action on an arbitrary functional @xmath187 , which may depend explicitly on time : @xmath188 = \\lim_{\\tau\\rightarrow 0}\\frac{{\\cal p}_\\tau r[\\psi_0,t_0]-      r[\\psi_0,t_0]}{\\tau},\\ ] ] where the propagator @xmath189 is defined by @xmath190=     \\int d\\psi d\\psi^ * r[\\psi , t_0+\\tau]t[\\psi ,",
    "t_0+\\tau|\\psi_0,t_0],\\ ] ] i.e. , @xmath191 $ ] is the expectation value of the functional @xmath187 at time @xmath86 under the condition that the process starts in the state @xmath32 at time @xmath42 . inserting eqs .",
    "( [ trans_eq ] ) and  ( [ propagator_eq ] ) in eq .",
    "( [ generator_eq ] ) and performing the limit @xmath192 on the coarse grained time axis ( i.e. , @xmath193 ) we obtain @xmath194&=&i\\int dx\\bigg((g(t_0)\\psi_0)^*(x )    \\frac{\\delta r[\\psi_0,t_0]}{\\delta \\psi_0^*(x)}\\nonumber\\\\    & \\hspace*{-6em}-&\\hspace*{-3em}\\frac{\\delta r[\\psi_0,t_0 ] }    { \\delta \\psi_0(x)}(g(t_0)\\psi_0)(x)\\bigg)\\nonumber\\\\    & \\hspace*{-6em}+&\\hspace*{-3em}\\int d\\psi^ * d{\\psi}(r[\\psi , t_0]-r[\\psi_0,t_0 ] )    w[{\\psi}|\\psi_0,t_0],\\end{aligned}\\ ] ] where we defined the transition functional @xmath195=\\gamma\\sum_i \\lambda_i     \\langle{\\psi_0}|j_i^\\dagger j_i",
    "|{\\psi_0}\\rangle\\delta\\left[\\psi-    \\frac{j_i\\psi_0}{||j_i{\\psi_0}||}\\right].\\ ] ] note , that the @xmath42dependency of @xmath196 $ ] is given through @xmath197 and @xmath135 .",
    "( [ gen_1_eq ] ) represents the generator of a piecewise deterministic markov process @xcite , whose sample paths consist of deterministically propagated pieces interrupted by stochastic jumps .",
    "the deterministic pieces are the solution of the nonlinear schrdinger equation @xcite @xmath198 and the waiting time distribution function for the stochastic jumps is given by @xcite @xmath199=1-\\exp\\left(-\\gamma\\sum_i\\lambda_i     \\int_{t_0}^t ds ||j_i\\psi(s)||^2\\right).\\ ] ] this is the probability that a jump occurs in the time interval @xmath200 under the condition that the system is in the state @xmath32 at time @xmath42 .",
    "if a jump occurs at time @xmath91 then the state of the system at time @xmath91 is @xmath201 with probability @xmath202 , where @xmath203 is @xmath204 , with @xmath205 .    in order to obtain the differential equation of motion for the reduced probability distribution",
    ", we set @xmath206=\\delta[\\psi-\\psi']$ ] and obtain @xmath207=t[\\psi , t+\\tau|\\psi',t],\\ ] ] and thus @xmath208&=&\\lim_{\\tau \\rightarrow 0 }    \\frac{1}{\\tau}\\big ( p_1[\\psi , t+\\tau]-p_1[\\psi , t]\\big)\\nonumber\\\\    & \\hspace*{-8em}=&\\hspace*{-4em}\\lim_{\\tau \\rightarrow 0}\\int d\\psi'd{\\psi'}^*\\frac{t[\\psi , t+\\tau|\\psi',t ]    -\\delta[\\psi-\\psi']}{\\tau}p_1[\\psi',t]\\nonumber\\\\    & \\hspace*{-8em}=&\\hspace*{-4em}\\int d\\psi'd{\\psi'}^*\\big({\\cal g } \\delta[\\psi-\\psi ' ]    \\big)p_1[\\psi',t].\\end{aligned}\\ ] ] if we insert eq .  ( [ gen_1_eq ] ) in eq .",
    "( [ p_1_1_eq ] ) and evaluate the integral we obtain the differential equation of motion of the reduced probability distribution    ' '' ''    ' '' ''    @xmath209&=&i\\int dx\\left\\{\\frac{\\delta }        { \\delta \\psi(x)}\\big(g(t)\\psi\\big)(x)-\\frac{\\delta } { \\delta \\psi^*(x ) }        \\big(g(t)\\psi\\big)^*(x)\\right\\}p_1[\\psi , t]\\nonumber\\\\      & \\hspace*{-6em}+&\\hspace*{-3em}\\int d{\\psi ' } d{\\psi'}^ *      \\big\\{w[\\psi|{\\psi',t}]p_1[{\\psi'},t]-w[{\\psi'}|\\psi , t]p_1[\\psi , t]\\big\\}\\end{aligned}\\ ] ] which is a liouville  master equation @xcite .",
    "( [ liou_mast_eq ] ) implies that for the conditional transition probability the integro - differential equation @xmath210&=&i\\int         dx\\left\\{\\frac{\\delta }        { \\delta \\psi(x)}\\big(g(t)\\psi\\big)(x)-\\frac{\\delta } { \\delta \\psi^*(x ) }        \\big(g(t)\\psi\\big)^*(x)\\right\\}t[\\psi , t|\\psi_0,t_0]\\nonumber\\\\      & \\hspace*{-10em}+&\\hspace*{-5em}\\int d{\\psi ' } d{\\psi'}^ *       \\big\\{w[\\psi|{\\psi'},t]t[\\psi',t|\\psi_0,t_0]-      w[{\\psi'}|\\psi , t]t[\\psi , t|\\psi_0,t_0 ] \\big\\}\\end{aligned}\\ ] ]    2 holds for any @xmath211 .",
    "this equation can be solved either analytically for some simple systems using the hilbert  space path integral representation of the process @xcite or numerically by either simulating the process @xcite or using a recursive computation scheme @xcite .",
    "studying the dynamics of open systems , one is not only interested in the time evolution of expectation values of some system operator @xmath212 but , moreover , one wants to investigate the time evolution of an arbitrary matrix element of this operator and obtain quantities such as @xmath213 . note that for an open system this is only a short hand notation .",
    "what we really mean by this is @xmath214 where @xmath215 is the hamiltonian of the total system ( see eq .",
    "( [ h_tot_eq ] ) ) and the states @xmath216 and @xmath217 are defined as @xmath218 and @xmath219 , i.e. , we assume , that the state of the environment is given by the probability distribution eq .",
    "( [ env_init_eq ] )",
    ". we will refer to this quantity ( eq .  ( [ heis_def_eq ] ) ) as the matrix element of the reduced heisenberg picture operator @xmath220 and use it in sec .",
    "[ dir_corr ] for the calculation of time - ordered multitime correlation functions .    in the case of a closed system , @xmath213",
    "is easily calculated by solving the corresponding schrdinger equation with the two initial conditions @xmath221 and @xmath222 separately to obtain @xmath223 and @xmath224 and then evaluating the scalar product @xmath225",
    ". a naive generalization of this scheme to an open system  which will lead to wrong results  would be the following : instead of solving the schrdinger equation , simulate the stochastic process defined in sec .",
    "[ eq_mo ] with the two initial conditions @xmath226 and @xmath32 to obtain @xmath223 and @xmath224",
    ". then evaluate the scalar product @xmath227 and average over a sufficiently large ensemble of realizations .",
    "however , what we really obtain using this procedure is the quantity @xmath228t[\\psi , t_0+\\tau|\\psi_0,t_0],\\end{aligned}\\ ] ] which is , in general , not equal to @xmath213 .",
    "this can be most easily seen by considering the special case @xmath229 : according to the definition of the conditional transition probability ( cf .",
    "[ cond_prob ] ) , @xmath85 $ ] has to fulfill the necessary condition @xmath230.\\end{aligned}\\ ] ] obviously , the quantity @xmath231 defined in eq .",
    "( [ bad_exp_eq ] ) is , in general , different from the right - hand side of eq .",
    "( [ exp_cons_cond_eq ] ) , and thus this approach will lead to wrong results .",
    "however , as we will show below , it is possible to construct a stochastic process which describes the time evolution of @xmath226 and @xmath32 _ simultaneously _ and whose sample paths can be used to estimate the desired quantity @xmath213 . in order to do so",
    ", we describe the dynamics of the open system in the doubled hilbert space @xmath232 , such that the `` state '' of the open system is given by a normalized pair of state vectors @xmath233 , where @xmath234 and @xmath91 denotes the transposed vector .",
    "accordingly , we define the extension of a system operator @xmath212 to the doubled hilbert space @xmath235 as @xmath236 using the raising operator @xmath237 whose expectation value @xmath238 in the state @xmath239 is the scalar product @xmath240 , we can write the matrix elements of @xmath212 as @xmath241 this equation is the crucial point of the following construction : it allows to write matrix elements of reduced system operators as expectation values in the doubled hilbert space @xmath235 .",
    "the same idea will be used in sec .",
    "[ dir_corr ] for the development of an algorithm that enables the determination of arbitrary correlation functions .",
    "note , that the scalar products on the left - hand side and on the right - hand side of the above equations are defined in different hilbert spaces , namely in @xmath23 and @xmath235 , respectively .",
    "( the @xmath242 on the right - hand side of eq .",
    "( [ mat_el_exp_eq ] ) is introduced to highlight the connection of the above equation with eq .",
    "( [ gen_corr_eq ] ) ( see below ) ) .",
    "we also introduce a reduced probability distribution @xmath243 $ ] on the set of normalized states of @xmath235 , which is the probability density of finding the system in the state @xmath239 , and a conditional transition probability @xmath244 $ ] which is the probability density that the system is in the state @xmath239 at time @xmath86 _ under the condition _ that the system is in the state @xmath245 at time @xmath42 .",
    "the goal of this section is to derive in analogy to the scheme we presented in sec .",
    "[ deri ] the equation of motion for the conditional transition probability @xmath246 , which has to fulfill the necessary condition @xmath247},\\ ] ] where @xmath248 and @xmath249 .",
    "the above condition states that the matrix element @xmath250 of a reduced heisenberg picture operator is proportional to the expectation value of the operator @xmath251 with respect to the probability distribution @xmath246 .",
    "in order to achieve this we have to make the following assumptions , which are similar to those made in sec . [ deri ] : i )",
    "according to the weak coupling assumption , we will assume that the time evolution of the environment is given by its free evolution ( cf .",
    "( [ bath_mo ] ) ) .",
    "ii ) the probability distribution of the total system at time @xmath42 , @xmath252 $ ] ( which is defined on the hilbert space @xmath253 ) , factorizes and is given by @xmath254=\\sum_\\alpha p_\\alpha\\int_0^{2\\pi}\\frac{d\\chi}{2\\pi }    \\delta[\\theta - e^{i\\chi}\\theta_0\\otimes\\varphi_\\alpha].\\ ] ] iii ) second order perturbation theory and finally iv ) the markov approximation .",
    "if we combine these approximations we find after some calculations which are similar to those presented in sec .",
    "[ deri ] , that the necessary condition eq .",
    "( [ cons_cond2_eq ] ) to first order in @xmath136 ( and to second order in the coupling @xmath51 ) reads : @xmath255},\\end{aligned}\\ ] ] where @xmath106 , and @xmath197 , and @xmath135 are defined as in sec .",
    "[ t_ma_sec ] .",
    "note that this equation is completely analogous to eq .",
    "( [ exp_prop_dia ] ) .",
    "this leads us directly to a conditional transition probability to first order in @xmath136 @xmath256}&= & \\widetilde{w}\\delta [    \\theta-\\widetilde{w}^{-1/2}\\widetilde{l}\\theta_0]\\nonumber\\\\    & + & \\gamma\\tau\\sum_{i}\\lambda_i    \\widetilde{w}_i\\delta[\\theta-\\widetilde{w}_i^{-1/2}\\widetilde{j}_i\\theta_0],\\end{aligned}\\ ] ] where we have defined @xmath257 the effective hamiltonian @xmath258 is defined in eq .",
    "( [ h_eff_eq ] ) , and @xmath259 .",
    "the appropriate normalization constants are @xmath260 and @xmath261 . in analogy to eq .",
    "( [ w_eq ] ) we find @xmath262 which ensures the normalization of the conditional transition probability @xmath263 .",
    "the equation of motion for the conditional transition probability @xmath264 $ ] , where @xmath211 , can be found using the same scheme as described in sec .",
    "[ eq_mo ] : calculation of the generator @xmath265 and its action on the functional @xmath266=\\delta[\\theta-\\theta']$ ] leads to the liouville ",
    "master equation    @xmath267      & = & i\\int dx\\bigg\\{\\frac{\\delta}{\\delta \\theta(x ) }      \\cdot\\big(\\widetilde{g}(t)\\theta\\big)(x )      -\\frac{\\delta } { \\delta \\theta^*(x)}\\cdot\\big(\\widetilde{g}(t)\\theta\\big)^*(x )      \\bigg\\}\\widetilde{t}[\\theta , t|\\theta_0,t_0]\\nonumber\\\\      & \\hspace*{-8em}+&\\hspace*{-4em}\\int d{\\theta ' } d{\\theta'}^*\\big\\ {      w[\\theta|\\theta',t ]      \\widetilde{t}[\\theta',t|\\theta_0,t_0 ]     -w[\\theta'|\\theta , t ]     \\widetilde{t}[\\theta , t|\\theta_0,t_0]\\big\\},\\end{aligned}\\ ] ]    2 where we defined the functional wirtinger derivative with respect to states belonging to @xmath235 as @xmath268\\displaystyle        \\frac{\\delta}{\\delta \\psi(x ) }    \\end{array}\\right).\\ ] ] the generator for the continuous time evolution is defined in analogy to eq .",
    "( [ g_eff_eq ] ) as @xmath269 and the transition functional is given by ( cf .",
    "( [ trans_func_eq ] ) ) @xmath270=\\gamma\\sum_i \\lambda_i     \\widetilde{w}_i\\delta\\left[\\theta-\\widetilde{w}_i^{-1/2 }    \\widetilde{j}_i\\theta_0\\right].\\ ] ] again , the stochastic process which is defined through eq .",
    "( [ heis_liou_mast_eq ] ) is a piecewise deterministic markov process , where the deterministic pieces are the solution of the nonlinear schrdinger equation @xmath271 and the waiting time distribution for the stochastic jumps under the condition that the system is in the state @xmath245 at time @xmath42 is given by @xmath272=1-    \\exp\\left(-\\gamma\\sum_i\\lambda_i\\int_{t_0}^tds||\\widetilde{j}_i\\theta(s)||^2     \\right).\\ ] ] the liouville - master equation ( [ heis_liou_mast_eq ] ) also determines the equation of motion for the reduced heisenberg picture operator @xmath273 : expanding @xmath273 in terms of its matrix elements and inserting the liouville - master equation ( [ heis_liou_mast_eq ] ) we obtain after some calculations @xmath274(t )    + \\frac{1}{2}\\sum_i\\gamma_i } \\nonumber\\\\    & \\times&\\big\\ {    2\\left(j_i^\\dagger x j_i\\right)(t)-\\left(j_i^\\dagger j_i x\\right)(t)-\\left(x j_i^\\dagger j_i\\right)(t )    \\big\\}.\\end{aligned}\\ ] ] thus the equation of motion of the reduced heisenberg picture operator is the adjoint equation of the quantum master equation @xcite and we find @xmath275 for any initial density matrix @xmath276 , where @xmath6 is the time evolution super operator of the quantum master equation .",
    "this relation is the basis of the quantum regression theorem @xcite .",
    "we close this section with a few remarks : for the initial condition @xmath277 the stochastic process defined in this way reduces to the stochastic process defined in sec .",
    "[ eq_mo ] ; formally , this can be expressed through the identity @xmath278=\\delta\\left[\\theta-\\frac{1}{\\sqrt{2 } } ( \\psi,\\psi)^t\\right ] t[\\psi , t|\\psi_0,t_0],\\ ] ] where @xmath279 $ ] is the solution of the liouville  master equation ( [ liou_mast_eq ] ) .",
    "thus , the dynamics of the system described in the doubled hilbert space @xmath235 reduces to our earlier description of the dynamics in the ordinary hilbert space @xmath23 .",
    "this is an important property of the conditional transition probability @xmath263 which establishes the link between the two approaches .    for the numerical simulation of the stochastic process ,",
    "it is useful to omit the normalization requirement and use the linear operator @xmath280 instead of @xmath281 as the generator for the deterministic motion .",
    "thus , for the numerical simulation we use an unnormalized state vector @xmath282 , and the deterministic pieces are the solution of the _ linear _ schrdinger - type equation @xmath283 and the waiting time distribution for the stochastic jumps for unnormalized states is given by @xmath284=1-||\\hat{\\theta}(t)||^2,\\ ] ] under the condition that the state @xmath245 is normalized and @xmath285 is the solution of the above schrdinger - type equation with the initial condition @xmath286 .",
    "this equation is easily proven by differentiating eqs .",
    "( [ heis_wait_eq ] ) and ( [ heis_wait_unnorm_eq ] ) with respect to @xmath16 and comparing the results .",
    "the above procedure has the major advantage , that the schrdinger equation ( [ heis_lin_eq ] ) for @xmath287 is linear and that the two components are decoupled .",
    "this leads to a large reduction of the time necessary for the calculation of the deterministic time evolution .",
    "in addition , we do not have to calculate the waiting time distribution separately .    in ref .",
    "@xcite gisin formulated the heisenberg picture of the quantum state diffusion model of open systems .",
    "in analogy to our approach , he used a coupled pair of stochastic differential equations for the calculation of heisenberg picture operators .",
    "his approach has the advantage that the scalar product of two state vectors @xmath288 and @xmath15 is constant in time , i.e. , the matrix elements of the identity operator are calculated correctly in each realization of the stochastic process , whereas in our approach the identity operator is treated like any other system operator , i.e. , for the calculation of the matrix elements one has to average over many realizations . on the other hand , gisin s approach is limited to the calculation of matrix elements with respect to nonorthogonal state vectors , i.e. , the stochastic differential equations are not defined if @xmath289 calculation of multitime correlation functions ----------------------------------------------      the theory we presented in sec .",
    "[ deri ] allows the calculation of one time expectation values of an observable such as @xmath290 .",
    "this theory can easily be extended to the calculation of symmetric , time - ordered multitime correlation functions such as @xmath291 where @xmath212 and @xmath292 are arbitrary operators and @xmath293 . as in sec .  [ heis ]",
    "we use the short hand notation @xmath294 where @xmath295 is a pure product state of the total system .",
    "thus , at time @xmath42 the system is in the pure state @xmath32 and the state of the environment is given through the probability distribution @xmath22 ( cf .",
    "( [ env_init_eq ] ) ) . an exact expression for @xmath296 in terms of probability distributions defined on the hilbert space of",
    "the _ total _ system can be written as @xmath297    p[\\psi_1,t_1].\\end{aligned}\\ ] ] the time - dependent probability distribution @xmath298 and the conditional transition probability @xmath299 for the total system can be calculated using the unitary time evolution , @xmath300=\\sum_{\\alpha}p_\\alpha    \\delta[\\psi_1-\\exp(-ih(t_0-t_1 ) ) \\psi_0\\otimes    \\varphi_\\alpha]\\nonumber\\\\ & &   \\hat{t}[\\psi_2,t_2|\\psi_1,t_1]=    \\delta[\\psi_2-\\exp(-ih(t_2-t_1))\\psi_1],\\end{aligned}\\ ] ] where @xmath215 is the hamilton of the total system ( cf .",
    "eq  ( [ h_tot_eq ] ) ) .",
    "if we apply the scheme we presented in sec .",
    "[ deri ] ( i.e. , the weak coupling assumption , second order perturbation theory , the reduction formula , and the markov approximation ) to express @xmath301 and @xmath299 in terms of the conditional transition probability @xmath91 of the reduced system we find that @xmath296 is approximately given by @xmath302 t[\\psi_1,t_1|\\psi_0,t_0],\\end{aligned}\\ ] ] where the @xmath303 are states of the system under consideration and the conditional transition probability @xmath91 satisfies the liouville  master equation eq .",
    "( [ liou_mast_1_eq ] ) . for the stochastic process which is used to simulate eq .",
    "( [ symm_corr2_3_eq ] ) this means the following : the process starts in the state @xmath32 at time @xmath42 and is propagated to the state @xmath304 at time @xmath305 using the stochastic time evolution defined in sec .",
    "[ cond_prob ] .",
    "then the process jumps to the normalized state @xmath306 and is propagated to the state @xmath307 at time @xmath308 .    for the most general symmetric time - ordered correlation function",
    "we obtain in a similar way    ' '' ''    ' '' ''    @xmath309\\cdots      t[\\psi_2,t_2|{w_1}^{-1/2}x_1\\psi_1,t_1]t[\\psi_1,t_1|\\psi_0,t_0],\\end{aligned}\\ ] ]    2 where @xmath310 and @xmath292 are arbitrary system operators , and @xmath311 , and @xmath312 .",
    "this class of correlation functions contains for example the correlation @xmath313 which has been measured in the famous hanbury - brown and twiss experiment ( see , e.  g. @xcite ) or , more recently , for a single ion in a trap by diedrich and walther @xcite .    the stochastic simulation algorithm which we use to compute symmetric time - ordered multitime correlation functions",
    "can thus be summarized as follows : 1 .",
    "start in the state @xmath32 at time @xmath42 and propagate up to the state @xmath304 at time @xmath305 using the stochastic time evolution ( cf .",
    "[ eq_mo ] ) .",
    "2 . jump to the state @xmath314 .",
    "3 . propagate the state @xmath314 at time @xmath305 up to the time @xmath308 , etc .",
    "4 . compute the expectation value @xmath315 . by repeating this procedure sufficiently often",
    ", we can estimate the unknown correlation function by averaging over the sample paths .",
    "in the preceding discussion we limited ourselves to a pure initial state @xmath32 of the system .",
    "however , this is not a real restriction : if the initial state of the open system is described by a probability distribution @xmath89 $ ] , we find @xmath316}\\nonumber\\\\ & &   \\hspace*{2em}=\\int d\\psi d\\psi^ *    p_1[\\psi , t_0 ] g(\\psi , t_0, ... ,t_n , t_{n+1})\\end{aligned}\\ ] ] thus , we can simulate this type of correlation functions by drawing a random initial state @xmath15 with probability @xmath89 $ ] and using the above simulation algorithm .      especially in the context of quantum optics",
    ", measurements are not restricted to obtain information about symmetric time - ordered correlation functions .",
    "for example , the fluorescence spectrum of a two level atom is the fourier transform of the stationary expectation value @xmath317 which is a special case of the more general time - ordered multitime correlation function @xmath318 where @xmath319 , and @xmath320 , and @xmath310 and @xmath321 are arbitrary system operators .",
    "in fact , according to gardiner @xcite and gardiner and collett @xcite , this kind of multitime correlation function is the only one that arises in the quantum theory of measurement .    for the calculation of this time - ordered correlation function we will present two distinct approaches",
    ": we can express the general time - ordered correlation function through a linear combination of symmetric time - ordered correlation functions ( sec .",
    "[ red_corr ] ) or we can define a stochastic process in the doubled hilbert space @xmath322 ( cf .  sec .",
    "[ heis ] ) which allows a direct calculation of the sought quantity ( sec .",
    "[ dir_corr ] ) .      in order to express the general time - ordered correlation function defined in eq .",
    "( [ corr_eq ] ) as a linear combination of symmetric time - ordered correlation functions as defined in eq .",
    "( [ symm_corr_eq ] ) , we can use the operator identity @xmath323 ( which yields the polarization identity @xcite for @xmath324 ) .",
    "this identity is easily proven by computing the product and recognizing that the prefactor of every term in the sum is a geometric series .",
    "for example the correlation function @xmath325 could be rewritten as @xmath326 this is a symmetric time - ordered correlation function .",
    "relation ( [ moel_eq ] ) was used by dalibard et  al .",
    "@xcite for the computation of the spectrum of fluorescence of a two level atom .",
    "however , for the calculation of a general time - ordered correlation function , one would need to calculate at least @xmath327 symmetric time - ordered correlation functions , where @xmath328 is the number of indices @xmath329 for which @xmath330 is equal to some @xmath331 and @xmath81 is the number of indices @xmath329 for which @xmath330 and @xmath332 are equal to some @xmath331 and @xmath333 , respectively . especially for higher order correlation functions , this procedure is very time consuming .      in sec .",
    "[ symm_corr ] , we demonstrated how the stochastic process which we use to simulate one  time expectations of system operators ( cf .",
    "[ eq_mo ] ) could be applied to the simulation of symmetric time - ordered multitime correlation functions .",
    "similarly , the stochastic process which we use to calculate matrix elements of a reduced heisenberg picture operator @xmath213 ( cf .",
    "[ heis ] ) provides a direct method for the calculation of general time - ordered correlation functions of the type given by eq .",
    "( [ corr_eq ] ) .",
    "the reason for this fact is  as we will show below  that these correlation functions can be expressed by symmetric correlation functions in the doubled hilbert space @xmath235 in the following manner : order the set of times @xmath335 and rename them @xmath336 such that @xmath337 where @xmath61 is the number of coinciding time points .",
    "then define a set of schrdinger operators @xmath338 on @xmath235 as @xmath339    \\left(\\begin{array}{cc }      i&0\\\\      0&y_j\\end{array}\\right ) ,         & \\mbox{if $ r_l= s_j\\neq t_i$ for some $ j$ and all $ i$,}\\\\[3ex ]    \\left(\\begin{array}{cc }      x_i&0\\\\      0&y_j\\end{array}\\right ) ,         & \\mbox{if $ r_l = t_i= s_j$ for some $ i$ and $ j$}. \\end{array}\\right.\\ ] ] using this definitions and the definition of the raising operator @xmath340 ( cf .",
    "( [ rais_eq ] ) ) we find from eq .",
    "( [ corr_eq ] ) @xmath341 where @xmath342 , @xmath343 , and @xmath344 .",
    "( [ gen_corr_eq ] ) is a symmetric time - ordered multitime correlation function that can be calculated applying the simulation algorithm in a doubled hilbert space described in sec .",
    "[ symm_corr ] .",
    "note that for the special choice @xmath345 , @xmath346 , @xmath347 , @xmath348 , and @xmath349 the right - hand side of eq .",
    "( [ gen_corr_eq ] ) is just the matrix element @xmath350 of some system operator @xmath292 ( cf .",
    "( [ mat_el_exp_eq ] ) ) .    as an explicit example of the general formalism we will consider the two time correlation function @xmath351 , with @xmath352 : for this we obtain the following simulation algorithm : 1 .",
    "start in the normalized state @xmath32 at time @xmath42 and propagate to the state @xmath304 at time @xmath305 using the stochastic time evolution in @xmath23 ( cf .",
    "[ eq_mo ] ) .",
    "2 . jump to the normalized pair of state vectors @xmath353 , where @xmath354 .",
    "3 . propagate to the state @xmath355 at time @xmath308 using the stochastic time evolution defined in the doubled hilbert space ( cf .",
    "[ heis ] ) .",
    "4 . evaluate the scalar product @xmath356 and weight it with the factor @xmath357 .",
    "repeat this procedure sufficiently often and average over the different realizations . using eq .",
    "( [ reg_bas_eq ] ) it is straightforward to show that applying this scheme we determine the quantity @xmath358 where @xmath359 is the propagator of the quantum master equation .",
    "this is in complete agreement with the standard definition of the two time correlation function @xmath351 @xcite and , hence , in complete agreement with the quantum regression theorem .    the above algorithm is easily generalized to the calculation of higher order correlation functions .",
    "note that by using this approach we have to calculate only one symmetric time - ordered multitime correlation function in a doubled hilbert space , instead of @xmath327 correlation functions that have to be calculated using the method described in sec .",
    "[ red_corr ] .",
    "we will compare the numerical performance of both methods in sec .",
    "[ vac ] where we use the calculation of the fluorescence spectrum of a driven two level atom as an example .",
    "consider a two level atom with the hamiltonian @xmath360 , where @xmath361 are the pseudo spin operators of the atom , driven by a coherent field .",
    "the state of the environment is given by @xmath362 with probability 1 , where @xmath363 is the unitary displacement operator and @xmath364 is the amplitude of the coherent excitation of the field mode @xmath61 .",
    "we will assume that the bandwidth of the coherent excitation is small , i.e. , eq .",
    "( [ tau_tau_e_cond ] ) holds . using eq .",
    "( [ e_t_eq ] ) we find for the mean of the electromagnetic field @xmath365}=-i\\sum_{k\\in{\\cal k}_{\\mbox{\\scriptsize dr } } }    g_k\\beta_k e^{-i\\omega_k t},\\ ] ] and the driving term in the effective hamiltonian is thus given by @xmath366 since the bath is in the vacuum state , we find using eqs .",
    "( [ n_eq ] ) and ( [ m_eq ] ) from the appendix @xmath367 computing the eigenvalues of the correlation matrix of the environment @xmath122 ( cf .",
    "( [ corr_first_eq ] ) ) leads to @xmath368 , and @xmath369 , and thus we find the jump operators @xmath370 , and @xmath371 .",
    "neglecting the lamb shift we obtain for the effective hamiltonian @xmath372 this is the same effective hamiltonian , that is used in other stochastic wave function approaches for the coherent time evolution of a system coupled to the vacuum , see , e. g. refs .",
    "@xcite .",
    "we can now use the simulation algorithm described in sec .",
    "[ symm_corr ] to calculate the correlation function @xmath373 which is the probability of emitting a photon at time @xmath16 and a second photon at time @xmath11 in the steady state .",
    "this correlation function could be measured in a hanbury - brown and twiss experiment .",
    "we do this by drawing a random initial state from an uniform distribution on @xmath23 and then propagating this state for a time @xmath374 in order to reach the steady state regime .",
    "then we apply the above described simulation algorithm to calculate the sought quantity . in fig .",
    "[ ana_hbt ] we compare the numerical results with the analytical solution obtained by the quantum regression theorem ( solid line ) for a resonant coherent excitation with @xmath375 ( which yields the rabi frequency @xmath376 ) and @xmath377 realizations .",
    "the error bars indicate the estimated error calculated at each point using the estimated standard deviation of the sample of realizations .",
    "obviously , our calculations are in good agreement with the analytical results .",
    "we can also compute the spectrum of the fluorescence radiation which is the fourier transform of the correlation function @xmath378 using the simulation algorithms presented in sec .",
    "[ red_corr ] ( denoted by method i in fig .  [ num_per ] ) and sec .",
    "[ dir_corr ] ( denoted by method ii in fig .",
    "[ num_per ] ) respectively . for the same parameters as above",
    ", both algorithms converge to the analytical solution , first given by mollow @xcite . however , the numerical performance of both algorithms is quite different : fig .",
    "[ num_per ] shows the necessary cpu time on an rs6000 workstation in order to achieve a desired numerical precision in a log  log plot .",
    "the solid lines represent the mean square deviation of the numerical solution from the exact solution and the dashed lines show the mean estimated standard deviation of the numerical solution .",
    "obviously , the latter quantity provides for both algorithms a very good measure of the accuracy of the numerical simulation .",
    "a closer analysis reveals , that method ii is for a given accuracy by a factor of @xmath379 faster than method i. actually , this result is better than we expected , since the time method i uses for the computation of a single realization is only by a factor of 1.7 greater than the time method ii needs .",
    "thus , the accuracy of a single realization is higher for method ii than for method i. we emphasize that , in order to obtain a realistic picture of the scaling of the cpu times , we used a numerical integration of the corresponding differential equations ( eqs .",
    "( [ det_eq ] ) and ( [ heis_det_eq ] ) ) , instead of the well - known analytical solution .      as a second example , we want to investigate a two level atom with the hamiltonian @xmath380 , driven by a displaced squeezed vacuum . thus , the state of the environment is given by @xmath381 with probability 1 , where @xmath363 is the unitary displacement operator and @xmath382 is the unitary squeezing operator . using the identities @xcite @xmath383 together with eq .",
    "( [ e_t_eq ] ) we find for the mean of the electromagnetic field @xmath384}=-i\\sum_{k\\in{\\cal k}_{\\mbox{\\scriptsize dr } } }    g_k\\beta_k e^{-i\\omega_k t},\\ ] ] and thus for the driving term in the effective hamiltonian @xmath385 it is important to note that the driving term is completely unaffected by the squeezing and again the coherent excitation acts like a classical field .",
    "if we assume that the bandwidth of the coherent excitation is small and that the squeezing is homogeneous over a wide bandwidth near the resonance frequency @xmath56 then eq .",
    "( [ mark_cond_eq ] ) holds and we can calculate the parameters @xmath154 and @xmath156 appearing in the bath correlation matrix @xmath122 using eqs .",
    "( [ n_eq ] ) and ( [ m_eq ] ) .",
    "we find @xmath386 where @xmath387 and @xmath388 are the parameters of the squeezing at the resonance frequency @xmath56 and the efficiency parameter @xmath389 is defined as @xmath390 where @xmath391 is the solid angle in which the squeezing occurs . if the squeezing is homogeneous over the complete solid angle @xmath392 , then @xmath393 and we find a perfect squeezed vacuum with @xmath394 ( minimum uncertainty state ) ; if only a finite solid angle is squeezed , then we find @xmath395 , which corresponds to an imperfect squeezing .",
    "thus a perfect squeezing over a finite solid angle leads to the same dynamics as an imperfect squeezing within the complete solid angle @xmath392 .    in order to obtain the rates @xmath396 and the corresponding jump operators @xmath135 which are necessary for a stochastic description of the system we have to calculate the eigenvalues and eigenvectors of the bath correlation matrix @xmath122 . in terms of @xmath154 and @xmath397",
    "we find @xmath398 where @xmath399 .",
    "the spectrum of fluorescence can be obtained by calculating the correlation function @xmath400 in the steady state , and then taking the fourier transform of this quantity . in fig .",
    "[ sq_specs ] we present numerically calculated spectra of resonance fluorescence for a coherent driving field with a rabi frequency of @xmath376 ( @xmath401 ) and various squeezing parameters ( solid lines ) and compare it with the vacuum spectrum obtained by mollow @xcite ( thin line ) . in ref .  @xcite it was shown that in the strong field limit the spectrum of resonance fluorescence is sensitive to the relative phase of the driving field and the phase of the squeezing , i.e. , it depends on @xmath402 : for a perfect squeezing and @xmath403 the linewidth of the central peak is reduced to a subnatural level , whereas the sideband peaks are broadened .",
    "this is shown in fig .",
    "[ sq_specs ] ( a ) and [ sq_specs ] ( c ) . in the limit @xmath404 but @xmath405 ( i.e. , very strong squeezing of only a few modes )",
    "the shape of the central peak is approximately identical with the shape of the central peak in the mollow triplet ; the sideband peaks are still broadened ( cf .",
    "[ sq_specs ] ( b ) and [ sq_specs ] ( d ) ) . on the other hand , for @xmath406 the central peak and the sideband peaks",
    "are broadened for both @xmath407 ( cf .",
    "[ sq_specs ] ( e ) and [ sq_specs ] ( g ) ) and @xmath408 ( cf .",
    "[ sq_specs ] ( f ) and [ sq_specs ] ( h ) ) .    for the numerical calculation of the correlation function @xmath400 we used the stochastic simulation algorithm in the doubled hilbert space described in sec .",
    "[ dir_corr ] and @xmath409 realizations .",
    "note , that it is useful from a numerical point of view to subtract the limit @xmath410 from the calculated correlation function before taking the fourier transform , since this constant corresponds to the @xmath411shaped coherent part of the spectrum , which is neglectable in the limit of strong driving fields .",
    "the agreement of the numerical with the analytical solution given in ref .",
    "@xcite is very good for all the examples presented above ( the relative error of the correlation function is of the order @xmath412 ) .",
    "note that the analytical solution was obtained by assuming that all modes of the electromagnetic field are squeezed .",
    "however , the above discussion makes clear that it can also be used for the more general case considered here by setting @xmath395 , i.e. , by assuming an imperfect squeezing .",
    "as a last example we want to investigate an open system coupled to a heat bath in a thermal state , which is represented by a mixture of coherent states .",
    "thus the probability density @xmath413 $ ] of the bath is given by @xmath414=\\bigotimes_{k\\in{\\cal k}_{\\mbox{\\scriptsize b}}}p_k[\\cdot , t_0],\\ ] ] where @xmath415&=&\\frac{1}{\\pi}\\left(e^{\\omega_k / kt}-1\\right)\\int d^2\\alpha    \\int_0^{2\\pi}\\frac{d\\chi}{2\\pi}\\nonumber\\\\     & \\hspace*{-6em}\\times&\\hspace*{-3em}\\exp\\left(-|\\alpha|^2\\left(e^{\\omega_k / kt }     -1\\right)\\right)\\delta\\left[\\varphi - e^{i\\chi}|\\alpha\\rangle\\right],\\end{aligned}\\ ] ] and @xmath416 is an eigenstate of the destruction operator @xmath37 with complex eigenvalue @xmath417 . by inserting eq .",
    "( [ coh_therm_eq ] ) in eqs .",
    "( [ n_eq ] ) and ( [ m_eq ] ) , respectively , we obtain @xmath418 as expected , and hence the jump operators @xmath419 and rates @xmath420 and @xmath421 .",
    "note that we would have obtained the same values for @xmath154 and @xmath156 and hence the same equation of motion for the reduced probability distribution by representing the probability density @xmath68 of the heat bath in terms of eigenstates of the number operator @xcite .",
    "the reason for this invariance is that all parameters which describe the influence of the environment on the open system are expectation values of linear environment operators and hence independent of the actual representation of the mixture .",
    "the primary goal of the present paper was to show how stochastic wave function methods have to be generalized in order to allow the systematic evaluation of the matrix elements of reduced heisenberg operators and of arbitrary multitime correlation functions .",
    "the starting point for the derivation of the equation of motion for the reduced system s probability distribution is the unitary time evolution of the total system ( i.e. , the system together with its environment ) . from this , we infer the dynamics of the reduced system through the following necessary condition : the time evolution of the expectation value of an arbitrary system observable @xmath115 calculated using the reduced probability distribution has to be equal to the time evolution of the expectation value of @xmath114 in the total system ( up to second order perturbation theory ) . by making the week coupling assumption and the markov approximation we can further simplify the expression for the reduced system s probability distribution and finally obtain the desired equation of motion .",
    "this equation is a liouville  master equation and hence the underlying stochastic process is a piecewise deterministic markov process .",
    "we emphasize , that the only major assumptions we have to make about the state of the environment concern the relation of the time scale of the reduced system s dynamics compared to the time scale of the dynamics of the environment .",
    "the basic idea underlying the approach to the evaluation of multitime correlations presented here is the introduction of a doubled hilbert space .",
    "the latter allows to write matrix elements of reduced heisenberg picture operators as expectation values . employing this ansatz a stochastic process in the doubled hilbert space",
    "is easily constructed which directly leads to the determination of arbitrary correlation functions .",
    "the process in the doubled hilbert space is again a piecewise deterministic process described by a liouville ",
    "master equation for a probability distribution on the doubled hilbert space .    to complete this article",
    "we have discussed three typical examples of quantum optics : ( i ) a coherently driven two level system coupled to the vacuum .",
    "this example is mainly used as a basis for a numerical comparison of two simulation algorithms for the calculation of multitime correlation functions , namely our approach and an algorithm proposed in ref .",
    "@xcite . for this example",
    "our approach was faster by a factor of 3 .",
    "( ii ) a coherently driven two level system coupled to a squeezed vacuum . in this example",
    "we derive the stochastic time evolution of a system coupled to a squeezed vacuum which extends over a finite solid angle ( i.e. , not over the complete solid angle @xmath392 ) .",
    "in particular we show , that a perfect squeezing over a finite solid angle leads to the same dynamics of the open system as an imperfect squeezing over the complete solid angle @xmath392 .",
    "( iii ) a thermal mixture of coherent states .",
    "this example illustrates , that the equation of motion for the reduced probability distribution does not depend on the actual representation of the state of the environment .",
    "let us calculate first @xmath422 : combining eq .",
    "( [ g_lin_eq ] ) and  ( [ bath_correl_eq ] ) and performing the continuum limit yields @xmath423 where we defined the mean number of photons @xmath424 with frequency @xmath39 as @xmath425},\\ ] ] where @xmath426 and @xmath427 and the mean quadratic coupling at frequency @xmath56 @xmath428 note that the above summations and integrations are restricted to modes @xmath429 .",
    "since @xmath430 the expressions for @xmath424 and @xmath431 are independent of the volume of quantization @xmath432 . using the identity @xmath433 where p denotes the cauchy principal value we find @xmath434 with @xmath435 and @xmath436 thus",
    ", the constant @xmath154 we have just defined is the mean number of photons in the modes with frequency @xmath56 , where the mean is taken over the states of the ensemble _ and _ over the relative strength of the coupling .",
    "the imaginary part @xmath155 leads to the stark shift .    for the calculation of @xmath437 we can use the commutator relations @xmath438=\\delta_{kk'}$ ] and find : @xmath439 where @xmath440 thus we find @xmath441 where we used the definition of @xmath431 ( eq .",
    "( [ gamm_eq ] ) ) and defined @xmath442 the new constant @xmath168 which appears here is the lamb shift ."
  ],
  "abstract_text": [
    "<S> within the framework of probability distributions on projective hilbert space a scheme for the calculation of multitime correlation functions is developed . </S>",
    "<S> the starting point is the markovian stochastic wave function description of an open quantum system coupled to an environment consisting of an ensemble of harmonic oscillators in arbitrary pure or mixed states . </S>",
    "<S> it is shown that matrix elements of reduced heisenberg picture operators and general time - ordered correlation functions can be expressed by time - symmetric expectation values of extended operators in a doubled hilbert space . </S>",
    "<S> this representation allows the construction of a stochastic process in the doubled hilbert space which enables the determination of arbitrary matrix elements and correlation functions . </S>",
    "<S> the numerical efficiency of the resulting stochastic simulation algorithm is investigated and compared with an alternative monte carlo wave function method proposed first by dalibard et al . </S>",
    "<S> [ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 68 * , 580 ( 1992 ) ] . by means of a standard example </S>",
    "<S> the suggested algorithm is shown to be more efficient numerically and to converge faster . </S>",
    "<S> finally , some specific examples from quantum optics are presented in order to illustrate the proposed method , such as the coupling of a system to a vacuum , a squeezed vacuum within a finite solid angle , and a thermal mixture of coherent states .    2 </S>"
  ]
}