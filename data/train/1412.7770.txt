{
  "article_text": [
    "a classic result in the theory of continuous - time markov chains ( ctmcs ) states that an irreducible chain on a countable space has a unique invariant distribution if and only if it is positive recurrent @xcite .",
    "an irreducible and positive recurrent ctmc is commonly called _ ergodic_.",
    "all finite irreducible markov chains are automatically ergodic @xcite , however verification of ergodicity becomes much harder when the state space is countably infinite .",
    "the most common approach to this problem is the use of the so - called foster - lyapunov criteria @xcite which , among others , provide sufficient conditions for positive recurrence . according to one of the main results of this theory",
    ", the uniformly negative drift of a suitably defined lyapunov function outside a finite set of states guarantees that the expected hitting time of this set is finite for any initial condition of the chain , which in turn implies that the chain is ergodic @xcite . despite its elegance , successful application of this result to a given ctmc",
    "depends critically on the computation of a lyapunov function , a non - trivial procedure .",
    "several attempts have been made to provide guidelines for the construction of lyapunov functions for specific classes of ( discrete - time ) markov chains @xcite , yet the general problem of determining a suitable lyapunov function for a given system remains unsolved . in this work , we propose an optimization - based approach to the computation of lyapunov functions when the transition rates of a given ctmc are affine functions of the state and the movement of the chain is determined by a finite set of transition vectors .",
    "such characteristics can be found , for example , in models of stochastic chemical kinetics , as well as models used in ecology and epidemiology .",
    "our method relies on the formulation of a semidefinite optimization program ( sdp ) , which can be solved efficiently by existing sdp solvers .",
    "several classic results in markov chain theory have demonstrated how lyapunov functions can be used to provide bounds on stationary expectation of a function of the chain .",
    "our approach enables us to optimize these bounds over a given class of lyapunov functions . in this way",
    ", approximations of quantities related to the stationary behavior of the chain can be obtained fast , without stochastic simulation or solution of the kolmogorov equations .",
    "the rest of the paper is organized as follows : section [ preliminaries ] provides the necessary mathematical background of foster - lyapunov theory and the associated bounds that can be obtained using lyapunov functions .",
    "next , sections [ optim_approach ] and [ linearlyap ] present the main idea behind our approach and its application to markov chains with affine transition rates .",
    "several examples are considered in section [ examples ] to demonstrate the applicability and effectiveness of our method .",
    "the conclusions of our study and some current research directions are finally summarized in section [ discussion ] .",
    "we consider an irreducible ctmc @xmath0 with state space @xmath1 ( where @xmath2 is the set of nonnegative integers ) .",
    "the infinitesimal generator of @xmath3 is denoted by @xmath4 , where @xmath5 denotes the transition rate from state @xmath6 to state @xmath7 .",
    "we assume that @xmath8 is conservative ( @xmath9 ) and that each state @xmath6 leads to finitely many states @xmath7 . more specifically",
    ", we assume that the movement of the chain is controlled by a finite set of constant _ transition vectors _",
    "@xmath10 , so that possible transitions out of @xmath11 lead into states @xmath12 .",
    "further , we assume that each transition rate @xmath5 is affine in @xmath6 .    in the rest of the paper",
    ", we will denote @xmath13 by @xmath14 and @xmath15 by @xmath16 . with this notation , application of the generator @xmath8 to a function @xmath17",
    "yields a new function @xmath18 , called the _ drift _ of @xmath19 , which is given by @xmath20    the following theorem provides sufficient conditions for a given irreducible ctmc on @xmath21 to be ergodic .",
    "[ mainth ] suppose there exists a function @xmath22 and a finite set @xmath23 such that@xmath24 then the chain is non - explosive and ergodic .",
    "function @xmath19 is commonly called a _",
    "stochastic lyapunov function_. note that nonnegativity of @xmath19 could alternatively be replaced by the condition that @xmath19 is lower - bounded over @xmath21 @xcite .",
    "conditions ( [ negdrift ] ) and ( [ posdrift ] ) can be combined in one inequality of the form @xmath25 where @xmath26 denotes the indicator function of @xmath27 and @xmath28    the following is a simple consequence of ergodicity :    @xmath29 in    since @xmath19 is bounded from below , @xmath30 would imply that that @xmath31 is a supermartingale that converges to a constant @xcite , and the chain could not be ergodic .",
    "hence , it must hold @xmath32 , i.e. @xmath33 .    intuitively , theorem [ mainth ] states that for an irreducible ctmc the process @xmath31 behaves like a supermartingale outside a finite set @xmath27 , i.e. @xmath19 decreases on average along the trajectories of the chain until the process hits @xmath27 , the so - called _ refuge set_. this interpretation makes an interesting connection with deterministic lyapunov theory , and could lead one to think that @xmath27 possesses some special property among all subsets of @xmath21 .",
    "however , this is not the case . to see this",
    ", we need two hitting time definitions @xcite :    given a set @xmath34 , the first entrance time to @xmath35 ( or the * hitting time * of @xmath35 ) , denoted by @xmath36 , is defined as @xmath37 with the infimum over an empty set taken to be @xmath38 . using @xmath39 , the hitting time to @xmath40 , we next define the * first return time * to @xmath35 , denoted by @xmath41 : @xmath42    given a positive recurrent ctmc , we know that the expected return time to any state , @xmath43 $ ] is finite @xcite . in turn",
    ", this implies that @xmath44 $ ] is also finite for any @xmath6 and @xmath7.$ ] and observing that @xmath43\\geq{}_xp(t , x , y)(\\mathbb{e}_y[\\tau_x]+t)$ ] .",
    "since the chain is irreducible and @xmath43<\\infty$ ] , @xmath44<\\infty$ ] as well .",
    "] consequently , the expected hitting time , @xmath45 $ ] , of any set @xmath46 as a function of @xmath6 is also finite .",
    "this implies that @xmath47 $ ] for @xmath48 finite is a lyapunov function for the chain , since we have the following    [ lemma_return ] the function @xmath49 is the pointwise minimal solution to the system @xmath50    using a first step decomposition and the definition of @xmath51 , we see that for @xmath52 @xmath53 application of the generator on @xmath49 then gives @xmath54 substituting the expression for @xmath49 obtained above , we see that @xmath55 if @xmath52 .",
    "minimality of @xmath51 follows from theorem 4.3 of @xcite : if holds for some @xmath19 and @xmath56 , then @xmath57\\leq v(x),~\\forall x\\notin c.\\ ] ]    we thus see that any finite set @xmath48 can serve as refuge for at least one lyapunov function . in other words ,",
    "no set holds a prominent position in ( [ lyapeq ] ) , in contrast to deterministic lyapunov theory .",
    "consequently , there is a large freedom in the choice of stochastic lyapunov functions .",
    "this freedom can be exploited , however , since we know that lyapunov functions can provide bounds to stationary expectations of functions of the chain , as well as bounds on hitting times of sets ( an example of the latter was already used in the proof of lemma [ lemma_return ] ) .",
    "one can therefore _ optimize _ over a class of candidate lyapunov functions to obtain such bounds , and thus gain insight into the stationary behavior of a given chain .",
    "below we present more analytically the bounds we consider in this work .",
    "consider the problem of finding a set @xmath27 that contains a large portion of the invariant distribution .",
    "such a set defines a `` central '' region in the state space of the chain , in which it is most probable to find the sample paths at stationarity ( notice the similarity of such a set to the equilibrium point of a nonlinear system ) . a simple calculation based on ( [ lyapeq ] )",
    "@xcite shows that @xmath58 where @xmath59 denotes the invariant distribution of the chain .",
    "this is intuitively expected , since @xmath60 indicates the average maximum positive rate of change of @xmath19 when @xmath61 is in @xmath27 , and thus quantifies the tendency of the process to move out of @xmath27 .",
    "it is no surprise then that @xmath62 is intimately connected with @xmath63 , i.e. the fraction of time the process spends on average inside @xmath27 at stationarity .    for a given lyapunov function",
    ", one can also reverse the process and find a set @xmath64 such that @xmath65 .",
    "this will be some super - level set of @xmath66 . more concretely , given a lyapunov function @xmath19 and the associated constant @xmath62 in ( [ lyapeq ] ) , we know that @xmath67 .",
    "next , given an @xmath68 , we can find a @xmath69 such that the new super - level set @xmath70 has probability greater than @xmath71 . to do this , we first note that @xmath72 so , using @xmath64 in place of @xmath27",
    "we can write @xmath73 using theorem 4.3 of @xcite , we know that @xmath74 so we can compute the necessary shift @xmath75 from the equation @xmath76      lyapunov functions can be also used to obtain moment bounds : as shown in @xcite , if ( [ lyapeq ] ) is generalized to @xmath77 where @xmath78 , it also holds that @xmath79    from ( [ generalcondition ] ) and ( [ momentbound ] ) ( proven in theorem 4.3 of @xcite ) , the stationary expectation of a given nonnegative function @xmath80 can be upper - bounded using the maximum drift obtained from a suitably chosen lyapunov function @xmath19 .",
    "the above observations can serve as starting points towards the construction of appropriate lyapunov functions for bounding invariant quantities related to a given ctmc . to demonstrate the form of the resulting optimization problems",
    ", we consider the case of finding a set that contains a large fraction of the stationary probability mass of the chain .",
    "in other words , our goal is to obtain a lower bound on the probability mass of a set @xmath27 , which is described as the ( super)level set of the function @xmath66 . in abstract terms , this can be posed as the following optimization problem :    @xmath81    @xmath82 denotes some class of functions over which the optimum is sought .",
    "the second constraint requires that @xmath18 eventually becomes negative outside a compact set @xmath83 and is necessary for @xmath19 to be a lyapunov function .",
    "we then know that the set @xmath67 will lie inside @xmath83 .",
    "the intuition behind this formulation is to look for a function @xmath84 for which the positive drift over @xmath83 is minimal .",
    "since the positive drift is directly related to the tendency of the process trajectories to move out of the refuge @xmath27 , one expects that a refuge corresponding to a lyapunov function with the minimal drift will be located in the region where the stationary density of @xmath3 tends to be higher .",
    "as we shall see , in the case of affine transition rates can be cast in the form of polynomial optimization , provided we treat all functions involved as defined on a continuous space ( @xmath85 ) . in particular , becomes a semidefinite program ( sdp ) if we focus our search on quadratic lyapunov functions .",
    "in the case of affine transition rates the _ drift vector _",
    "@xmath86 can be written as @xmath87 , for some @xmath88 and @xmath89 .",
    "for these systems we consider the class of quadratic lyapunov functions @xmath90 , for some @xmath91 and @xmath92 , to be determined via optimization .",
    "to derive the analytic form of the optimization problem , we take a closer look at the action of the generator @xmath8 on this class of functions : @xmath93 the decision variables in this expression are @xmath94 and @xmath95 . despite the fact that they appear in a product",
    ", we observe that @xmath95 always appears in a product with @xmath94 . by defining @xmath96",
    ", we can optimize over @xmath94 and @xmath97 , and recover @xmath95 whenever @xmath94 is invertible .",
    "when this condition fails , @xmath19 can be defined without the constant term @xmath98 .",
    "this shift has no effect on our results .",
    "we thus see that @xmath18 is a quadratic function of the form @xmath99 , for which we know that @xmath100 problem then takes the form of an sdp , which can compactly be written as    @xmath101    the second constraint requires that @xmath18 eventually becomes negative outside a compact set @xmath83 and is necessary because the third constraint alone is not enough to guarantee that numerical solvers will not converge to the trivial solution @xmath102 .",
    "in the case of lyapunov function optimization for linear dynamical systems , where the stability of @xmath103 is typically studied , one can ensure non - degeneracy of solutions by requiring @xmath104 for a small positive @xmath68 .",
    "this would not be a good choice in our case , as @xmath19 is not expected to be homogeneous in @xmath6 ( and thus have a minimum at zero ) , and such a constraint could severely affect the result of the optimization . our second constraint requires the choice of a given compact set @xmath83 , which can be thought of as an initial guess of where the set @xmath27 could lie .",
    "provided it is not chosen too small , the optimization outcome will not be affected by the particular choice of @xmath83 .    to maintain the sdp form of the problem",
    ", @xmath83 has to be defined through a set of linear or quadratic inequalities , in which case the second constraint can be written in semi - definite form using the s - procedure @xcite .      using the already established theoretical results presented in subsection [ momentbounds ] , we see that we obtaining upper bounds on the stationary mean of a given polynomial function @xmath78 requires solving a problem very similar to .",
    "provided @xmath80 has a degree @xmath105 ( i.e. , if we seek to bound means and ( co)variances ) , the resulting problem is still an sdp :    @xmath106    the non - degeneracy constraint involving the set @xmath83 is no longer needed : such solutions are no longer possible , thanks to the presence of @xmath80 in the inequality .",
    "when a system contains quadratic or bilinear transition rates ( such as in the case of bimolecular reactions in chemical kinetics ) , using a ( general ) quadratic lyapunov function will result in third order polynomials in @xmath18 .",
    "however , when only a few transitions have this feature , one could still search for a quadratic lyapunonv function by requiring that @xmath107 , where @xmath108 are the transition vectors corresponding to these transitions .",
    "there can not be too many such transitions ( in comparison to the state size , @xmath109 ) , otherwise the only feasible solution will be @xmath110 .",
    "every constraint of the form @xmath111 restricts @xmath19 to be constant along the direction @xmath112 , a severe restriction on the shape of the function .",
    "note also that such a @xmath19 can no longer be positive definite , however it can still be lower - bounded on @xmath113 and satisfy @xmath114 which is enough for theorem [ mainth ] to hold ( note that our chains evolve on @xmath113 ) . in turn , this is only possible if no @xmath112 has all its components nonnegative ( otherwise @xmath19 would be zero along a direction inside the positive orthant ) .",
    "if the @xmath112 s arise from chemical reaction stoichiometries , they automatically have this property due to mass conservation : a bimolecular reaction must consume some reactants to generate the products .",
    "consider the following reaction scheme corresponding to a simple transcription - translation model : @xmath115 the numbers of mrna and protein molecules at time @xmath116 will be denoted by @xmath117 and @xmath118 respectively .",
    "this system can be modeled as a ctmc @xcite @xmath119 on @xmath120 . at each state @xmath121 ,",
    "four transitions are possible ; their transition vectors are @xmath122^t$ ] , @xmath123^t$ ] , @xmath124^t$ ] and @xmath125^t$ ] , with corresponding transition rates @xmath126 , @xmath127 , @xmath128 and @xmath129 .",
    "we are first going to search for a lyapunov function that will provide us with the high - stationary density region of the system . to that end",
    ", we solve to obtain @xmath130 , @xmath94 and @xmath97 , for @xmath131 . and @xmath132 the optimal solution turns out to be @xmath133 notice that @xmath90 is centered very close to the mean of the system ( @xmath134 ) . following the method of subsection [ probbound ] , we can compute the level set of @xmath18 which contains more than @xmath135% of the stationary mass of the chain . a few of those sets are displayed on fig .",
    "[ mrna - prot ] below , together with a logarithmic plot of the actual invariant distribution of the system , obtained from ssa . the innermost contour ( corresponding to a lower bound of 80% ) encloses 99% of the invariant probability .",
    "overlayed to the logarithm ( base 10 ) of the invariant distribution of the system , obtained from stochastic simulation .",
    "the percentages next to each line denote the optimization - based lower bound on the stationary mass enclosed by it . ]",
    "while the lower bounds obtained are certainly conservative , we are nevertheless able to capture the region of high stationary density of the system with relatively good accuracy . on the other hand , this choice results in a very simple sdp that can be solved in 0.38 seconds using yalmip @xcite with the sdpt3 solver in matlab .",
    "turning to moment upper bounds , solution of problem for various choices of @xmath80 are presented in table [ moments_mrna - prot ] below .",
    ".upper moment bounds obtained from optimization problem , compared against their true values . [ cols=\"^,^,^\",options=\"header \" , ]      our final example is a system described by the following reaction scheme : @xmath136 with @xmath3 , @xmath137 and @xmath138 denoting the abundance of @xmath139 , @xmath140 and @xmath141 respectively . due to the presence of the bimolecular reaction , candidate quadratic lyapunov functions for this system must satisfy @xmath142 for the resulting optimization problem to remain in sdp form . under this constraint ,",
    "the lyapunov function that optimally determines the region of maximum stationary density is given by @xmath143 , where @xmath144 because @xmath94 is singular , @xmath95 can not be determined separately .",
    "this poses no problem for our approach , as we explained in section [ optim_approach ] .",
    "the level set of @xmath18 corresponding to a lower bound of 90% is displayed on figure [ nonl ] .",
    "optimization took 0.4 seconds in yalmip with the sdpt3 solver .",
    "corresponding to a 90% lower bound probability .",
    "the actual stationary mass contained in the set is about 99.9% .",
    "blue dots mark the points visited by a long chain sample path . ]",
    "apart from proving stability , lyapunov functions for deterministic systems are useful in many different ways , for example in estimating the region of attraction of a given equilibrium point or providing convergence rates . in a similar fashion ,",
    "the well - established theory of stochastic lyapunov functions for markov chains has turned them into useful tools for probing the stationary system behavior , besides determining ergodicity . in this work ,",
    "we have presented an optimization - based approach to lyapunov function design for locating regions of high stationary probability and bounding moments of ctmcs .",
    "we have shown that even simple quadratic lyapunov functions can capture a lot about the stationary behavior of a ctmc , and thus provide information about a system without the need for stochastic simulation .",
    "the results of this analysis can be used , for example , to determine suitably small truncations of the state space , on which approximate solution methods such as the finite state projection algorithm @xcite can be applied .",
    "previous work has employed linear lyapunov functions to determine exponential ergodicity of ctmcs , and shown that the search of such functions can often be reduced to the solution of a linear program @xcite .",
    "when the main goal is to determine system stability , linear lyapunov functions can provide the simplest and most efficiently computable certificates .",
    "however , when additional system properties are of interest , linear functions are not sufficiently flexible to provide useful answers .",
    "for example , estimates of high - density regions can not be tight enough using a linear lyapunov function @xmath19 , as the level sets of @xmath19 over the positive orthant are polyhedra with @xmath145 faces , @xmath109 of which lie on the coordinate axes .",
    "on the other hand , the level sets of quadratic function can be centered away from the origin , and thus provide much tighter estimates of this type .    due to space limitations , we chose to present the main ideas of our approach only for chains with affine transition rates .",
    "one could argue that such systems can be easily studied using moment equations or even the closed form of their probability density , which is available in several  but not all  cases .",
    "we believe that one can take advantage of this simplicity to check the soundness of a new approach , before moving on to more complex systems with general polynomial transition rates .",
    "the presence of such rates leads to general polynomial optimization problems , that can be solved using sum - of - squares ( sos ) relaxations @xcite , in the same spirit that polynomial lyapunov functions are used to study the stability of polynomial dynamical systems @xcite .",
    "while the main ideas of our approach remain the same in that case as well , the optimization problem setup becomes a bit more intricate , and will therefore be the topic of a future publication .",
    "r.  l. tweedie , `` sufficient conditions for regularity , recurrence and ergodicity of markov processes , '' in _ mathematical proceedings of the cambridge philosophical society _ , vol .",
    "78 , no .  01 , 1975 , pp . 125136 .",
    "a.  papachristodoulou and s.  prajna , `` on the construction of lyapunov functions using the sum of squares decomposition , '' in _ decision and control , 2002 , proceedings of the 41st ieee conference on _ , vol .  3 , 2002 , pp ."
  ],
  "abstract_text": [
    "<S> we address the problem of lyapunov function construction for a class of continuous - time markov chains with affine transition rates , typically encountered in stochastic chemical kinetics . following an optimization approach , </S>",
    "<S> we take advantage of existing bounds from the foster - lyapunov stability theory to obtain functions that enable us to estimate the region of high stationary probability , as well as provide upper bounds on moments of the chain . </S>",
    "<S> our method can be used to study the stationary behavior of a given chain without resorting to stochastic simulation , in a fast and efficient manner . </S>"
  ]
}