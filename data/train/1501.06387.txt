{
  "article_text": [
    "considerable effort has been expended recently to assess and compare different space ",
    "time models for forecasting earthquakes in seismically active areas such as southern california .",
    "notable among these efforts were the development of the regional earthquake likelihood models ( relm ) project [ @xcite ] and its successor , the collaboratory for the study of earthquake predictability ( csep ) [ @xcite ] .",
    "the relm project was initiated to create a variety of earthquake forecast models for seismic hazard assessment in california . unlike previous projects that addressed the assessment of models for seismic hazard , the relm participants decided to adopt many competing forecasting models and to rigorously and prospectively test their performance in a dedicated testing center [ @xcite ] . with the end of the relm project , the forecast models became available and the development of the testing center was done within the scope of csep .",
    "many point process models , including multiple variants of the epidemic - type aftershock sequence ( etas ) models of @xcite have now been proposed and are part of relm and csep , though the problem of how to compare and evaluate the goodness of fit of such models remains quite open .    in relm , a community consensus was reached that all entered models be tested with certain tests , including the number or n - test that compares the total forecasted rate with the observation , the likelihood or l - test that assesses the quality of a forecast in terms of overall likelihood , and the likelihood - ratio or r - test that assesses the relative performance of two forecast models compared with what is expected under one proposed model [ @xcite ] . however , over time several drawbacks of these tests were discovered [ @xcite ] and the need for more powerful tests became clear .",
    "the n - test and l - test simply compare the quantiles of the total numbers of events in each bin or likelihood within each bin to those expected under the given model , and the resulting low - power tests are typically unable to discern significant lack of fit unless the overall rate of the model fits extremely poorly .",
    "further , even when the tests do reject a model , they do not typically indicate where or when the model fits poorly , or how it could be improved .",
    "meanwhile , the number of proposed spatial ",
    "temporal models for earthquake occurrences has grown , and the need for discriminating which models fit better than others has become increasingly important .",
    "techniques for assessing goodness of fit are needed to pinpoint where existing models may be improved , and residual plots , rather than numerical significance tests , seem preferable for these purposes .",
    "this paper proposes a new form of residual analysis for assessing the goodness of fit of spatial point process models .",
    "the proposed method compares the normalized observed and expected numbers of points over voronoi cells generated by the observed point pattern .",
    "the method is applied here in particular to the examination of a version of the etas model originally proposed by @xcite , and its goodness of fit to a sequence of 520 @xmath0 hector mine earthquakes occurring between october 1999 and december 2000 . in particular , the voronoi residuals indicate that assumption of a constant background rate @xmath1 in the etas model results in excessive smoothing of the seismicity and significant underprediction of seismicity close to the fault line .",
    "residual analysis for a spatial point process is typically performed by partitioning the space on which the process is observed into a regular grid and computing a residual for each pixel .",
    "that is , one typically examines aggregated values of a residual process over regular , rectangular grid cells .",
    "alternatively , residuals may be defined for every observed point in the pattern , using a metric such as deviance , as suggested in @xcite .",
    "various types of residual processes were proposed in @xcite and discussed in @xcite and @xcite .",
    "the general form of these aggregated residual measures is a standardized difference between the number of points occurring and the number expected according to the fitted model , where the standardization may be performed in various ways .",
    "for instance , for pearson residuals , one weights the residual by the reciprocal of the square root of the intensity , in analogy with pearson residuals in the context of linear models . @xcite",
    "propose smoothing the residual field using a kernel function instead of simply aggregating over pixels ; in practice , this residual field is typically displayed over a rectangular grid and is essentially equivalent to a kernel smoothing of aggregated pixel residuals .",
    "@xcite also propose scaling the residuals based on the contribution of each pixel to the total pseudo - loglikelihood of the model , in analogy with score statistics in generalized linear modeling .",
    "standardization is important for both residual plots and goodness - of - fit tests , since otherwise plots of the residuals will tend to overemphasize deviations in pixels where the rate is high . behind the term _ pearson residuals _ lies the implication [ see , e.g. , the error bounds in figure  7 of @xcite ] that these standardized residuals should be approximately standard normally distributed , so that the squared residuals , or their sum , are distributed approximately according to pearson s @xmath2-distribution .    the excellent treatment of pearson residuals and other scaled residuals by @xcite , the thorough discussion of their properties in @xcite , their use for formal inference using score and pseudo - score statistics as described in @xcite , and the fact that such residuals extend so readily to the case of spatial  temporal point processes may suggest that the problem of residual analysis for such point processes is generally solved . in practice , however , such residuals , when examined over a fixed rectangular grid , tend to have two characteristics that can limit their effectiveness :    when the integrated conditional intensity ( i.e. , the number of expected points ) in a pixel is very small , the distribution of the residual for the pixel becomes heavily skewed .",
    "positive and negative values of the residual process within a particular cell can cancel each other out .    since pearson residuals are standardized to have mean zero and unit ( or approximately unit ) variance under the null hypothesis that the modeled conditional intensity is correct",
    "[ see @xcite ] , one may inquire whether the skew of these residuals is indeed problematic .",
    "consider , for instance , the case of a planar poisson process where the estimate of the intensity @xmath3 is exactly correct , that is , @xmath4 at all locations , and where one elects to use pearson residuals on pixels .",
    "suppose that there are several pixels where the integral of @xmath3 over the pixel is roughly @xmath5 .",
    "given many of these pixels , it is not unlikely that at least one of them will contain a point of the process . in such pixels ,",
    "the raw residual will be @xmath6 , and the standard deviation of the number of points in the pixel is @xmath7 , so the pearson residual is @xmath8 .",
    "this may yield the following effects : ( 1 ) such pearson residuals may overwhelm the others in a visual inspection , rendering a plot of the pearson residuals largely useless in terms of evaluating the quality of the fit of the model , and ( 2 ) conventional tests based on the normal approximation may have grossly incorrect @xmath9-values , and will commonly reject the null model even when it is correct .",
    "even if one adjusts for the nonnormality of the residual and instead uses exact @xmath9-values based on the poisson distribution , such a test applied to any such pixel containing a point will still reject the model at the significance level of @xmath5 .",
    "these situations arise in many applications , unfortunately .",
    "for example , in modeling earthquake occurrences , typically the modeled conditional intensity is close to zero far away from known faults or previous seismicity , and in the case of modeling wildfires , one may have a modeled conditional intensity close to zero in areas far from human use or frequent lightning , or with vegetation types that do not readily support much wildfire activity [ e.g. , @xcite ] .",
    "these challenges are a result of characteristic i above , and one straightforward solution would be to enlarge the pixel size such that the expected count in each cell is higher . while this would be effective in a homogeneous setting , in the case of an inhomogeneous process it is likely that this would induce a different problem : cells that are so large that even gross misspecification within a cell may be overlooked , and thus the residuals will have low power .",
    "this is the problem of characteristic  ii .",
    "when a regular rectangular grid is used to compute residuals for a highly inhomogenous process , it is generally impossible to avoid either highly skewed residual distributions or residuals with very low power .",
    "these problems have been noted by previous authors , though the important question of how to determine appropriate pixel sizes remains open [ @xcite ] .",
    "note that , in addition to pearson residuals and their variants , there are many other goodness - of - fit assessment techniques for spatial and spatial  temporal point processes [ @xcite ] .",
    "examples include rescaled residuals [ @xcite ] and superthinned residuals [ @xcite ] , which involve transforming the observed points to form a new point process that is homogeneous poisson under the null hypothesis that the proposed model used in the transformation is correct .",
    "there are also functional summaries , such as the weighted version [ @xcite ] of ripley s @xmath10-function [ @xcite ] , where each point is weighted according to the inverse of its modeled conditional intensity so that the resulting summary has conveniently simple properties under the null hypothesis that the modeled conditional intensity is correct , as well as other similarly weighted numerical and functional summaries such as the weighted r / s statistic and weighted correlation integral [ @xcite ] . as noted in @xcite , all of these methods can have serious deficiencies compared to the easily interpretable residual diagrams , especially when it comes to indicating spatial or spatial  temporal locations where a model may be improved .",
    "this paper proposes a new form of residual diagram based on the voronoi cells generated by tessellating the observed point pattern .",
    "the resulting partition obviates i and ii above by being adaptive to the inhomogeneity of the process and generating residuals that have an average expected count of 1 under the null hypothesis .",
    "for an to point processes and their intensity functions , the reader is directed to @xcite . throughout this paper",
    "we are assuming that the point processes are simple and that the observation region is a complete separable metric space equipped with lebesgue measure , @xmath11 .",
    "note that we are not emphasizing the distinction between conditional and papangelou intensities , as the methods and results here are essentially equivalent for spatial and spatial  temporal point processes .",
    "this paper is organized as follows .",
    "section  [ sec2 ] describes voronoi residuals and discusses their properties .",
    "section  [ sec3 ] demonstrates the utility of voronoi residual plots .",
    "the simulations shown in section  [ sec4 ] demonstrate the advantages of voronoi residuals over conventional pixel - based residuals in terms of statistical power .",
    "in section  [ sec5 ] we apply the proposed voronoi residuals to examine the fit of the etas model with uniform background rate to a sequence of hector mine earthquakes from october 1999 to december 2000 , and show that despite generally good agreement between the model and data , the etas model with uniform background rate appears to slightly but systematically underpredict seismicity along the fault line and to overpredict seismicity in certain locations along the periphery of the fault line , especially at the location 35 miles east of barstow , ca .",
    "[ secvoronoiresiduals ]    a voronoi tessellation is a partition of the metric space on which a point process is defined into convex polygons , or _",
    "voronoi cells_. specifically , given a spatial or spatial  temporal point pattern @xmath12 , one may define its corresponding _ voronoi tessellation _ as follows : for each point @xmath13 of the point process , its corresponding cell @xmath14 is the region consisting of all locations which are closer to @xmath13 than to any other point of @xmath12 .",
    "the voronoi tessellation is the collection of such cells .",
    "see , for example , @xcite for a thorough treatment of voronoi tessellations and their properties .    given a model for the conditional intensity of a spatial or space  time point process , one may construct residuals simply by evaluating the residual process over cells rather than over rectangular pixels , where the cells comprise the voronoi tessellation of the observed spatial or spatial  temporal point pattern .",
    "we will refer to such residuals as _",
    "voronoi residuals_.    an immediate advantage of voronoi residuals compared to conventional pixel - based methods is that the partition is entirely automatic and spatially adaptive .",
    "this leads to residuals with a distribution that tends to be far less skewed than pixel - based methods . indeed , since each voronoi cell has exactly one point inside it by construction , the raw voronoi residual for cell @xmath15 is given by @xmath16\\\\[-8pt]\\nonumber & = & 1 - { \\vert}c_i{\\vert}\\bar\\lambda,\\end{aligned}\\ ] ] where @xmath17 denotes the mean of the proposed model , @xmath18 , over @xmath14 .",
    "this raw residual can be scaled in various ways , as is well addressed by @xcite .",
    "note that when @xmath12 is a homogeneous poisson process , the sizes @xmath19 of the cells are approximately gamma distributed .",
    "indeed , for a homogeneous poisson process , the expected area of a voronoi cell is equal to the reciprocal of the intensity of the process [ @xcite ] , and simulation studies have shown that the area of a typical voronoi cell is approximately gamma distributed [ @xcite ] ; these properties continue to hold approximately in the inhomogeneous case provided that the conditional intensity is approximately constant near the location in question [ @xcite ] .    .",
    "the middle panels show results at location @xmath20 where @xmath21 ; the right panels show results at location @xmath22 where @xmath23 .",
    "the distribution ( [ eq2 ] ) is overlaid for the top middle and top right plots . ]",
    "the raw voronoi residual in ( [ eq1 ] ) will therefore tend to be distributed approximately like a modified gamma random variable .",
    "more specifically , the second term , @xmath24 , referred to in the stochastic geometry literature as the reduced area , is well approximated by a two - parameter gamma distribution with a rate of 3.569 and a shape of 3.569 [ @xcite ] .",
    "the distribution of the raw residuals is therefore approximated by @xmath25 by contrast , for pixels over which the integrated conditional intensity is close to zero , the conventional raw residuals are approximately bernoulli distributed .",
    "the exact distributions of the voronoi residuals are generally quite intractable due to the fact that the cells themselves are random , but approximations can be made using simulation .",
    "consider the point process defined by the intensity function @xmath26 on the subset @xmath27 \\times[-1,1]$ ] .",
    "figure  [ vorpixdists ] presents a realization of the process along with the corresponding voronoi tessellation ( top panels ) and a regular rectangular pixel grid ( bottom panels ) .",
    "two locations in @xmath28 were selected for investigation : one with relatively high intensity , the other with relatively low intensity .",
    "residual distributions were simulated by generating 5000 point patterns from the model , identifying the pixel / cell occupied by the location of interest , then calculating the difference between the number of observed points and the number expected under the same model .",
    "it can be seen from figure  [ vorpixdists ] that the distribution of voronoi residuals under the null hypothesis is well approximated by distribution ( [ eq2 ] ) at both the high intensity and low intensity locations . by comparison ,",
    "the distribution of pixel residuals is that of a poisson distributed variable with intensity @xmath29 , for pixel @xmath30 , centered to have mean zero . at the location where the intensity is high",
    ", this distribution is moderately skewed , but for the low intensity location the distribution becomes extremely skewed to the point of being effectively a two - valued random variable .",
    "in addition to distribution ( [ eq2 ] ) being a good approximation for the distribution of the voronoi residuals at a given location across many realizations , it is also a close approximation for the distribution of all residuals for a single realization ( see , e.g. , the lower left plot in figure  [ overestimating ] ) .",
    "it is important to note that such residuals are not strictly independent of one another due to the nature of the tessellation , however , our assessment is that this dependence is fairly minor .",
    "see the discussion for additional comments on independence .     with voronoi tessellation overlaid ( top left ) , voronoi residual plot for this simulation using a proposed intensity of @xmath31 ( top right ) , histogram of the voronoi residuals , with the density of the reference distribution ( [ eq2 ] ) overlaid ( bottom left ) , quantile plot of the voronoi residuals with respect to distribution  ( [ eq2 ] ) , with pointwise 95% confidence limits obtained via simulation of the proposed model ( bottom right ) .",
    "the color scale of the voronoi residual plot is @xmath32 , where @xmath33 is the distribution function of ( [ eq2 ] ) .",
    "tiles intersecting the boundary of the space are ignored . ]",
    "in this section the utility of voronoi residuals will be demonstrated using a series of simulations of spatial poisson processes .",
    "the simulations are random samples from a specified _ generating model_. these simulations are then modeled , correctly or incorrectly , by a _ proposed model_. voronoi residuals are then computed and used to assess the degree to which the proposed model agrees with simulations .",
    "we first consider the simplest case , where the proposed model is the same as the generating model . as a result ,",
    "one expects residuals that are spatially unstructured and relatively small in magnitude , that is , the only variation should be due to sampling variability .     with voronoi tessellation overlaid ( top left ) , voronoi residual plot of this simulation ( top right ) , histogram of the voronoi residuals , with the density of the reference distribution ( [ eq2 ] ) overlaid ( bottom left ) , quantile plot of the voronoi residuals with respect to the distribution ( [ eq2 ] ) , with pointwise 95% confidence limits obtained via simulation ( bottom right ) .",
    "the color scale of the voronoi residual plot in the top right is @xmath32 , where @xmath33 is the distribution function of ( [ eq2 ] ) .",
    "tiles intersecting the boundary of the space are ignored , as the distribution of these tile areas may differ substantially from the gamma distribution . ]",
    "figure  [ correctmodel ] shows a simulation of a spatial poisson process with intensity @xmath26 on the subset @xmath27 \\times[-1,1]$ ] , along with its corresponding voronoi tessellation .    in the voronoi residual plot in the top right panel of figure  [ correctmodel ] , each tile is shaded according to the value of the residual under the distribution function of the modified gamma distribution ( [ eq2 ] ) .",
    "the resulting @xmath9-values are then mapped to the color scale using an inverse normal transformation .",
    "thus , brightly shaded red areas indicate unusually low residuals , corresponding to areas where more points were expected than observed ( overprediction ) , and brightly shaded blue indicates unusually high residuals , corresponding to areas of underprediction of seismicity .    the tiles in the voronoi residual plot in figure  [ correctmodel ] range from light to moderate hues , representing residuals that are within the range expected under the reference distribution .",
    "similarly , the histogram and quantile plot of the voronoi residuals demonstrate that the distribution of the residuals is well approximated by distribution ( [ eq2 ] ) .      in order to evaluate the ability of voronoi residuals to detect model misspecification",
    ", simulations were obtained using a generating model and then residuals were computed based on a different proposed model . the top left panel of figure  [ overestimating ]",
    "displays a realization of a poisson process with intensity @xmath34 .",
    "the proposed model assumes a constant intensity across the space , @xmath35 . because of the lack of points near the origin , the tiles near the origin are larger than expected under the proposed model and , hence , for such a cell @xmath36 near the origin , the integral @xmath37 exceeds 1 , leading to negative residuals of large absolute value .",
    "these unusually large negative residuals are evident in the voronoi residual plot and clearly highlight the region where the proposed model overpredicts the intensity of the process .",
    "these residuals are also clear outliers in the left tail of the reference distribution of the residuals and , as a result , one sees deviations from the identity line in the quantile  quantile plot in figure  [ overestimating ] .",
    "[ secpower ] we now consider the manner in which the statistical power of residual analysis using a voronoi partition differs from that of a pixel partition . in the context of a residual plot , a procedure with low power would generate what appears to be a structureless residual plot even when the model is misspecified . to allow for an unambiguous comparison ,",
    "here we focus on power in the formal testing setting : the probability that a misspecified model will be rejected at a given confidence level .",
    "[ secpit ] as was discussed in section  [ secvoronoiresiduals ] , the distribution of voronoi residuals under the null hypothesis is well approximated by a modified gamma distribution , while the distribution of pixel residuals is that of a poisson distributed variable with intensity @xmath38 , for pixel @xmath30 , centered to have mean zero . to establish a basis to compare the consistency between proposed models and data for these two methods",
    ", we utilize the probability integral transform ( pit ) [ @xcite ] .",
    "the pit was proposed to evaluate how well a probabilistic forecast is calibrated by assessing the distribution of the values that the observations take under the cumulative distribution function of the proposed model .",
    "if the observations are a random draw from that model , a histogram of the pit values should appear to be standard uniform .",
    "one condition for the uniformity of the pit values is that the proposed model be continuous .",
    "this holds for voronoi residuals , which are approximately gamma distributed under the null hypothesis , but not for the poisson counts from pixel residuals . for such discrete random variables ,",
    "randomized versions of the pit have been proposed . using the formulation in @xcite ,",
    "if @xmath33 is the distribution function of the proposed discrete model , @xmath39 is an observed random count and @xmath40 is standard uniform and independent of @xmath41 , then @xmath42 is standard uniform , where @xmath43 the method can be thought of as transforming a discrete c.d.f . into a continuous c.d.f . by the addition of uniform random noise .",
    "the pit , both standard and randomized , provides a formal basis for testing two competing residual methods . for a given proposed model and a given realization of points , the histogram of pit values , @xmath44 , for each residual method should appear standard uniform if the proposed model is the same as the generating model .",
    "the sensitivity of the histogram to misspecifications in the proposed model reflects the statistical power of the procedure .",
    "there are many test statistics that could be used to evaluate the goodness of fit of the standard uniform distribution to the pit values . here",
    "we choose to use the kolmogorov ",
    "smirnov ( k  s ) statistic [ @xcite ] , @xmath45 where @xmath46 is the empirical c.d.f . of the sample and @xmath47 is the c.d.f . of the standard uniform . since the voronoi residuals of a given realization are not independent of one another , we use critical values from a simulated reference distribution instead of the limiting distribution of the statistic .",
    "two models were considered for the simulation study .",
    "the first was a homogeneous poisson model on the unit square with intensity @xmath3 on  @xmath48 .",
    "the second was an inhomogeneous poisson model with intensity @xmath49 on @xmath48 , where @xmath50 , @xmath51 and @xmath52 .",
    "the constant @xmath53 is a scaling constant chosen so that the parenthetical term integrates to one .",
    "the result is a function that is symmetric about @xmath54 and @xmath55 , reaches a maximum at @xmath56 , integrates to 300 regardless of the choice of @xmath57 , and is reasonably flat along the boundary box .",
    "this final characteristic should allow the alternative approach to the boundary problem , described below , to be relatively unbiased .",
    "additionally , it presents inhomogeneity similar to what might be expected in an earthquake setting .",
    "the procedure for the inhomogeneous simulation was as follows .",
    "a point pattern was sampled from the true generating model , ( [ modelbeta ] ) with @xmath58 . for a given proposed model , ( [ modelbeta ] ) with @xmath59 , and a fixed number of pixels @xmath60 on the unit square @xmath61 ^ 2 $ ] , pit values were calculated for the counts in each pixel , @xmath30 . the empirical c.d.f . of the pit transformed residuals",
    "was then compared to the c.d.f . of the standard uniform using the k ",
    "after many iterations of this procedure , the proportion of iterations with an observed k  s statistic that exceeded the critical value served as the estimate of the power of the method .",
    "an analogous procedure was followed for the voronoi partition , but with the pit values calculated by evaluating the voronoi residuals ( [ eq1 ] ) under the gamma distribution ( [ eq2 ] ) .",
    "the homogeneous simulation was conducted in the same manner , but drew samples from a generating model of @xmath62 and compared them to estimates from a proposed model @xmath63 .    .",
    "]    it is known that voronoi cells generated along the boundary of the space do not follow the same distribution as the interior cells .",
    "one recourse is to omit them from the analysis , as in section  [ sec3 ] .",
    "here we consider realizations of the model ( [ modelbeta ] ) on the entire plane but consider only the distribution of all cells generated by points inside the unit square @xmath61 ^ 2 $ ] .",
    "for the homogeneous model , figure  [ hpow ] shows the resulting estimated power curves for several pixel partitions , including @xmath64 .",
    "the power of each method was computed for a series of proposed models , @xmath65 .",
    "the best performance was by the method that used the voronoi partition , which shows high power throughout the range of misspecification .",
    "for the pixel partitions , @xmath66 had the highest power , but as the number of partitions increases , the k ",
    "s test loses its power to detect misspecification .",
    "this trend can be attributed to characteristic i : when the space is divided into many small cells , the integrated conditional intensity is very small and the distribution of the residuals is highly skewed . as a consequence ,",
    "the majority of counts are zeros , so the majority of the pit values are being generating by @xmath67 [ equation  ( [ eq4 ] ) ] and , thus , the resulting residuals have little power to detect model misspecification . the most powerful test in this homogeneous setting is in fact one with no partitioning , which is equivalent to the number - test from the earthquake forecasting literature [ @xcite ] .",
    "for the inhomogeneous case , power curves were computed for a series of proposed models of the form ( [ modelbeta ] ) , with @xmath68 .",
    "the results are shown in figure  [ ih1pow ] .",
    "the power curve for the voronoi method presents good overall performance , particularly when the model is substantially misspecified .",
    "the voronoi residuals are not ideally powerful for detecting slight misspecification , however , perhaps because the partition itself is random , thus introducing some variation that is difficult to distinguish from a small change in @xmath57 .    , where @xmath69 and @xmath70 .",
    "the generating model is @xmath58 . ]",
    "focusing only on the four pixel methods , the best performance is at @xmath71 pixels .",
    "the poor performance of @xmath66 in detecting the large positive misspecification is due to the fact that the model becomes more inhomogeneous as @xmath72 increases , but that inhomogeneity is averaged over cells that are too large ( the problem associated with characteristic ii in section  [ sec1 ] ) .",
    "meanwhile , the poor overall performance of @xmath73 is due to the same problem that exists in the homogeneous setting , where the pit values are dominated by the random uniform noise .    in applications such as earthquake modeling ,",
    "the use of pixel methods often results in situations with extremely low intensities in some pixels , similar to the case considered here with @xmath73 , but perhaps even more extreme .",
    "for instance , one of the most successful forecasts of california seismicity [ @xcite ] estimated rates in each of @xmath74 pixels in a model that estimated a total of only 35.4 earthquakes above m 4.95 over the course of a prediction experiment that lasted from 2006 to 2011 .",
    "estimated integrated rates were as low as 0.000007 in some pixels , and 58% of the pixels had integrated rates that were lower than 0.001 .",
    "an immediate improvement could be made by aggregating the pixels , but this in turn will average over the strong inhomogeneity along fault lines in the model , which will lower power .",
    "for this reason , the voronoi residual method may be better suited to the evaluation of seismicity models , as well as other processes that are thought to be highly inhomogeneous .",
    "in this section we apply voronoi residual analysis to the spatial  temporal epidemic - type aftershock sequence ( etas ) model of @xcite , which has been widely used to describe earthquake catalogs .    according to the etas model of @xcite , the conditional intensity @xmath3",
    "may be written @xmath75 where @xmath76 is a spatial density on the spatial observation region @xmath28 , @xmath77 and @xmath78 are temporal and spatial coordinates , respectively , @xmath79 is the magnitude of earthquake @xmath80 , and where the triggering function , @xmath81 , may be given by one of several different forms .",
    "one form for @xmath81 proposed in @xcite is @xmath82 where @xmath83 is the lower magnitude cutoff for the catalog .",
    "there is considerable debate in the seismological community about the best method to estimate the spatial background rate @xmath76 [ @xcite ] .",
    "when modeling larger , regional catalogs , @xmath1 is often estimated by smoothing the largest events in the historical catalog [ @xcite ] , and in such cases a very important open question is how ( and how much ) to smooth [ @xcite ] . for a single earthquake - aftershock sequence , however ,",
    "can one instead simply estimate @xmath1 as constant within a finite , local area , as in @xcite ?",
    "a prime catalog to investigate these questions is the catalog of california earthquakes including and just after the 1999 hector mine earthquake ( figure  [ hector - pattern ] ) .",
    "this data set was analyzed previously in @xcite , and consists of the origin times , epicentral locations and magnitudes of the 520 earthquakes with magnitude at least @xmath84 , from latitude 34 to 35 , longitude @xmath85116 to @xmath85117 , from 10/16/1999 to 12/23/2000 , obtained from the southern california seismic network ( scsn ) .        the parameters in the model were estimated by maximum likelihood estimation , using the progressive approximation technique described in @xcite .",
    "for the purpose of this analysis , we focused on the purely spatial aspects of the residuals , and thus integrated over the temporal domain to enable planar visualization of the residuals .",
    "the result is a voronoi tessellation of the spatial domain where for tile @xmath14 , for the integral in equation ( [ eq1 ] ) , the estimated conditional intensity function @xmath86 is numerically integrated over the spatial tile @xmath14 and over the entire time domain from 10/16/1999 to 12/23/2000 .",
    "we take two approaches to detecting inconsistencies between the etas model and the hector mine catalog : the inspection of plots for signs of spatial structure in the residuals and the evaluation of pit histograms as overall indicators of goodness of fit .",
    "figure  [ hector - res - plots ] shows residual plots based on both the pixel partition and the voronoi tessellation . as in figures",
    "[ correctmodel ] and  [ overestimating ] , the magnitude of each residual cell is represented by the value that the residual takes under the distribution function appropriate to that model ( poisson or gamma ) , which is the pit value discussed in section  [ secpit ] .",
    "the pixel residual plot shows that the etas model estimates a much higher conditional intensity along the fault region running from ( @xmath85116.4 , 33.9 ) to ( @xmath85116.1 , 33.3 ) than was observed in the hector mine sequence .",
    "away from the fault , the residuals are less structured , with no indication of model misspecification .",
    "the voronoi residual plot shares the same color scale as the pixel plot , but excludes the boundary cells by shading them white .",
    "some strong overprediction is apparent in several large cells in the general area of the fault line , but the structure is more nuanced than that found in the pixel plot . figure  [ hector - res - plot - zoom ] provides an enlarged version of the fault region , showing systematic underprediction along the fault and overprediction on the periphery of the fault .",
    "such structure in the residuals indicates that the etas model with uniform background rate may be oversmoothing .",
    "this suggests modeling the background rate @xmath76 in equation ( [ eq3 ] ) as inhomogeneous for southern california seismicity , in agreement with @xcite who came to a similar conclusion for japanese seismicity .",
    "that covers the fault line , which runs from approximately ( @xmath85116.4 , 34.85 ) to ( @xmath85116.25 , 34.4 ) .",
    "pit values are transformed to a color scale using the inverse normal transformation and tiles intersecting the boundary of the space are ignored , as the distribution of these tile areas may differ substantially from the gamma distribution . ]",
    "this structure is lost when the residuals are visualized using the pixel partition because the over- and underprediction are averaged over the larger fixed cells ( a  case of characteristic ii ) .",
    "the true intensity in this region is likely highly spatially variable , which makes the spatially adaptive voronoi partition a more appropriate choice .        as discussed in section  [ secpit ] ,",
    "pit values will be uniformly distributed if the fitted model is correct , therefore , pit histograms can be used as a means to assess general goodness of fit [ @xcite ] .",
    "figure  [ hector - pit - hists ] shows the distribution of the randomized pit values resulting from the pixel partition ( left panel ) alongside the pit values from the voronoi partition ( right panel ) .",
    "both histograms show deviations from uniformity , suggesting model misspecification .",
    "the histogram resulting from the voronoi parition suggests more deviation , however , which is consistent with the finding in section  [ secpower ] that this partition is more sensitive to misspecification than the pixel partition .",
    "it also suggests that there are areas of strong underprediction as well as overprediction , while the pixel pit values primarily identify the overprediction .",
    "the pit histogram is a useful tool to visualize overall goodness of fit , while the voronoi residual plot seems to be more powerful for identifying areas of poor fit .",
    "applying voronoi residual analysis to the etas model and the hector mine earthquake sequence suggests model misspecification  oversmoothing along the fault  that is undetected by other methods .",
    "these voronoi residuals may of course be used in tandem with standard , pixel - based residuals , which may in turn be based on a judicious choice of pixel size , or perhaps using a different spatially adaptive grid than the one proposed here .",
    "the use of pit values , both in residual plots and histograms , relies upon a readily computable form for @xmath33 , the distribution of residuals under the fitted model . in the case of the voronoi partition , this requires monte carlo integration of the conditional intensity function over the irregular cells . this process can be time consuming if the intensity function is sufficiently inhomogenous or if the number of earthquakes in the catalog is very high .",
    "the pit values of the pixel partition are easier to compute and they benefit from a more straightforward interpretation in the residual plot simply because the fixed grid is a more familiar configuration . however , because of their improved statistical power , voronoi residuals are more informative and thus worth the additional computation and consideration .",
    "the importance of selecting the size of the cell on which to compute a residual is not unique to this pit ",
    "k  s statistic testing environment .",
    "the discrepancy measure proposed by @xcite is defined on a borel set of a given shape @xmath28 .",
    "the author emphasizes the importance of choosing an appropriate size for @xmath28 ( page  835 ) and points out that if the cell is too small or too large , the power will suffer .",
    "a related problem arises in the selection of the bandwidth of the kernel used to smooth a residual field [ @xcite , section  13 and discussion ] .",
    "although we have focused on formal testing at the level of the entire collection of residuals , testing could also be performed at the level of individual cells . for the voronoi partition ,",
    "this extension is straightforward and is essentially what is being done informally in the shaded residual plots . for any pixel partition ,",
    "such testing may be problematic , as any pixel with an integrated conditional intensity close to zero would contain zero points with more than @xmath87 probability , so any hypothesis test with @xmath88 using a rejection interval would necessarily have a type i error near 1 .    generating the partition using a tessellation of the observed pattern has advantages and disadvantages .",
    "the advantage is that it is adaptive and requires no input from the user regarding tuning parameters .",
    "the disadvantages are that some sampling variability is induced by the random cell areas and that the residuals are dependent , so techniques relying upon an i.i.d .",
    "assumption must be used cautiously .",
    "a promising future direction is to consider residuals based on a model - based centroidal voronoi tessellation [ @xcite ] , which mitigates characteristics i and ii of the pixel method while providing a partition that creates residuals that are independent of one another if the underlying model is poisson .",
    "it should also be noted that the standardization methods proposed in @xcite may be used with voronoi residuals or instead one may elect to plot deviance residuals [ @xcite ] in each of the voronoi cells . in general , our experience suggests that the standardization chosen for the residuals seems far less critical than the choice of grid .",
    "the results seem roughly analogous to kernel density estimation , where the selection of a kernel function is far less critical than the choice of bandwidth governing its range .",
    "we thank the reviewer and associate editor for helpful comments that significantly improved this paper ."
  ],
  "abstract_text": [
    "<S> many point process models have been proposed for describing and forecasting earthquake occurrences in seismically active zones such as california , but the problem of how best to compare and evaluate the goodness of fit of such models remains open . </S>",
    "<S> existing techniques typically suffer from low power , especially when used for models with very volatile conditional intensities such as those used to describe earthquake clusters . </S>",
    "<S> this paper proposes a new residual analysis method for spatial or spatial  temporal point processes involving inspecting the differences between the modeled conditional intensity and the observed number of points over the voronoi cells generated by the observations . </S>",
    "<S> the resulting residuals can be used to construct diagnostic methods of greater statistical power than residuals based on rectangular grids .    following an evaluation of performance using simulated data , </S>",
    "<S> the suggested method is used to compare the epidemic - type aftershock sequence ( etas ) model to the hector mine earthquake catalog . </S>",
    "<S> the proposed residuals indicate that the etas model with uniform background rate appears to slightly but systematically underpredict seismicity along the fault and to overpredict seismicity in along the periphery of the fault .    ,    ,     + </S>"
  ]
}