{
  "article_text": [
    "we first discuss how to reduce adaptive protocols and compute two - way capacities at any dimension .",
    "we then derive our results for bosonic and qubit communications . for full proofs and details",
    "the reader may refer to the methods which summarizes the contents and the additional results given in the supplementary material .",
    "our machinery builds on several tools but the key features are the introduction of a suitable notion of channel s ree , which provides a general upper bound for the two - way capacities of an arbitrary quantum channel , and the design of teleportation stretching , that allows us to reduce this upper bound to a computable one - shot quantity for the most interesting cases .",
    "the dimension of the hilbert space is arbitrary and may be infinite , i.e. , we consider both discrete variable ( dv ) and continuous variable ( cv ) systems  @xcite .",
    "_ adaptive protocols and two - way capacities_.  let us start by describing adaptive protocols and defining two - way capacities .",
    "suppose that alice and bob are separated by a quantum channel @xmath18 and want to implement the most general quantum protocol assisted by adaptive loccs .",
    "the protocol may be stated in a completely general fashion and may be then specified for distributing quantum information , distilling entanglement or secret correlations .",
    "we assume that alice and bob have countable sets of systems , denoted by @xmath19 and @xmath20 , respectively .",
    "these sets represent local registers that the parties may continuously and dynamically update .",
    "the first step is the preparation of the initial separable state @xmath21 of @xmath19 and @xmath20 by some locc @xmath22 ( see also fig .",
    "[ protocolad ] ) . after the preparation of the local registers",
    ", there is the first transmission : alice picks a system from her local register @xmath23 , so that the register is updated as @xmath24 ; system @xmath25 is sent through the channel @xmath18 , with bob getting the output @xmath26 ; bob includes the output in his local register , which is updated as @xmath27 ; finally , alice and bob apply another locc @xmath28 to their updated registers @xmath19 and @xmath20 . in the second transmission ,",
    "alice picks and sends another system @xmath29 through channel @xmath18 with output @xmath30 for bob .",
    "the parties apply a further locc @xmath31  to the updated registers and so on .",
    "after @xmath32 transmissions , alice and bob share an output state @xmath33 depending on the adaptive loccs @xmath34 .    , alice and bob perform los assisted by unlimited two - way ccs , i.e. , adaptive loccs @xmath35 . for simplicity , we assume the following updates of the local registers @xmath36 ( preparation )  and @xmath37 ( receipt).,scaledwidth=50.0% ]    by definition , this adaptive protocol has a rate equal to @xmath38 if the output state @xmath39 is sufficiently close to a target state @xmath40 with @xmath41 bits , i.e. , we may write @xmath42 in trace norm . in general",
    ", the rate of the protocol must be defined as an average quantity , which means that the adaptive loccs @xmath43 are implicitly assumed to be averaged over local measurements and are therefore trace - preserving ( see methods ) .",
    "thus , by taking the asymptotic limit in @xmath32  and optimizing over @xmath43 , we define the generic two - way capacity of the channel as@xmath44    in particular , if the aim of the protocol is entanglement distribution , then the target state @xmath40 is a maximally entangled state and @xmath45 . because an ebit can teleport a qubit and a qubit can distribute an ebit , @xmath46 coincides with the two - way quantum capacity @xmath47 . if the goal is to implement qkd , then the target state @xmath40 is a private state  @xcite and @xmath48 . here",
    "the secret - key capacity satisfies @xmath49 , because ebits are specific types of secret bits and loccs are equivalent to los and public communication  @xcite .",
    "thus , the generic two - way capacity @xmath50 can be any of @xmath1 , @xmath0 , or @xmath2 , and these capacities must satisfy @xmath51 . also note that we may consider the two - way private capacity @xmath52 , which is the maximum rate at which classical messages can be securely transmitted  @xcite .",
    "because of the unlimited two - way ccs and the one - time pad , we have @xmath53 .",
    "this equivalence is implicitly assumed hereafter .",
    "_ general bounds for the two - way capacities_.  let us design suitable bounds for @xmath54 . from below we know that we may use the coherent  @xcite or reverse coherent  @xcite information .",
    "take a maximally entangled state of two systems @xmath55 and @xmath56 , i.e. , an einstein - podolsky - rosen ( epr ) state @xmath57 . propagating half of such a state through the channel defines its choi matrix @xmath58 .",
    "this allows us to introduce the coherent information of the channel @xmath59 and its reverse counterpart @xmath60 , defined as @xmath61-s(\\rho_{\\mathcal{e}})$ ] , where @xmath62 is the von neumann entropy .",
    "these quantities represent lower bounds for the entanglement that is distillable from the choi matrix @xmath63 via one - way ccs , denoted as @xmath64 . in other words",
    ", we can write the hashing inequality  @xcite @xmath65 because the epr state is energy - unbounded in cvs , so is the choi matrix of a bosonic channel , and the hashing inequality needs to be suitably extended ( see methods ) .",
    "as previously said , the completely novel and most important tool is the upper bound .",
    "we construct this bound by extending the notion of ree  from a quantum state to a quantum channel .",
    "recall that , for any bipartite state @xmath66 , the ree is defined as @xmath67 , where @xmath68 is an arbitrary separable state and @xmath69   $ ] is the relative entropy  @xcite .",
    "then , we may prove the following .",
    "[ weak converse][theomain]at any dimension , finite or infinite , the generic two - way capacity of an arbitrary quantum channel @xmath18 must satisfy the upper bound@xmath70 where @xmath71 for finite - dimensional systems .    * * proof ( sketch ) .",
    "* * the proof involves several ingredients .",
    "for any finite dimension @xmath72 and any number @xmath32 of channel uses , the epsilon - closeness @xmath73 between the output state @xmath39 and the target state @xmath40 is mapped into a fannes - type inequality for the ree  @xcite , which here reads @xmath74 .",
    "now we use the result that the ree of the target state is lower bounded by its distillable key  @xcite , so that we may write @xmath75 . up to epsilons ,",
    "we therefore get @xmath76 . taking the limit for large @xmath32 and",
    "optimizing over the adaptive loccs , we get the upper bound @xmath77 where we may use @xmath78 instead of the @xmath79 .",
    "the result is extended to infinite dimension by introducing a cut - off in the hilbert space by means of a suitable trace - preserving loccs . exploiting the monotonicity of the ree under such loccs",
    ", the cut - off may be then released .",
    "the final result is independent from the cut - off , proviso that we consider @xmath79 in eq .",
    "( [ theo1 ] ) .",
    "see methods for full details .",
    "@xmath80    the general upper bound @xmath81 may be called the adaptive ree of the channel . because this quantity is very hard to compute ,",
    "we relate it with other notions of ree that one can introduce  for a quantum channel .",
    "the most natural notion is the ( one - shot )  ree of the channel , that we define as @xmath82   .",
    "\\label{supremumof2}%\\ ] ] this is the maximum amount of entanglement ( as measured by the ree ) that can be distributed in a single use of the channel .",
    "its regularized version is given by @xmath83 .",
    "then , we also consider the ree  of the choi matrix @xmath84 , which is the entanglement distributed through the channel by means of a maximally - entangled epr  state .",
    "its regularization is given by @xmath85 .",
    "on the one hand , it is easy to verify the inequalities@xmath86 because ( 1 ) adaptive strategies are more general than optimal _ a priori _ state preparation and ( 2 ) sending epr states is a particular type of preparation . on the other hand",
    ", we also have the following opposite chain@xmath87 because ( 1 ) the ree is subadditive and ( 2 ) sending one epr  state is a particular state preparation .    from these two chains of inequalities",
    ", we see that there is no general connection between the upper bound @xmath81 and the single - letter quantities @xmath88 or @xmath89 . in the following ,",
    "we establish this connection for channels that suitably commute with quantum teleportation .",
    "for these channels , we will prove that @xmath90 , so that we can use the easily - computable quantity @xmath88 as an upper bound for their two - way capacities .",
    "_ teleportation stretching of an adaptive protocol_.  we now introduce a novel technique based on quantum teleportation  @xcite , that we call teleportation stretching .",
    "this technique simplifies an _ _ adaptive protocol with an arbitrary quantum task ( quantum communication , entanglement distribution or key generation ) into a non - adaptive block protocol performing exactly the same original task .",
    "this reduction holds for any number @xmath32 of uses of the channel , as long as the channel features suitable properties of covariance with quantum teleportation , a very common property at any dimension , finite or infinite . before describing teleportation stretching we need to develop a preliminary tool , which is the teleportation - simulation of a quantum channel .",
    "call @xmath91  the set of teleportation unitaries in arbitrary dimension @xmath72 .",
    "these are the random unitaries which are generated by the teleportation process . for a qudit , @xmath91",
    "is composed of generalized pauli operators , i.e. , the generators of the weyl - heisenberg group . for a cv system",
    ", the set @xmath92 is composed of displacement operators  @xcite , spanning the infinite dimensional version of the previous group .",
    "we say that a quantum channel @xmath18 is teleportation - covariant  or  stretchable  if , for any teleportation unitary @xmath93 , we may write@xmath94 for some generally - different unitary @xmath95 . the output @xmath95 does not need to belong to the input teleportation set @xmath91 , but this is the case when the channel @xmath18 preserves the dimension of the hilbert space .",
    "the class of stretchable channels is very wide and includes pauli channels , erasure channels and bosonic gaussian channels .",
    "thus , the key property of a stretchable channel @xmath18 is that the teleportation unitaries can be pushed out of the channel , where they become other unitaries that can still be corrected . for this reason",
    ", the transmission of a system through @xmath18 can be simulated by its teleportation over the choi matrix @xmath96 , as we fully explain in fig .",
    "[ topbottom ] .     from input system",
    "@xmath97 to output system @xmath98 .",
    "( middle )  system @xmath97 is perfectly teleported onto the new input system @xmath99 by a teleportation circuit composed by an epr state @xmath100 plus a bell detection acting on @xmath97 and @xmath55 ( triangle ) .",
    "the outcome @xmath101 of the measurement is classically communicated to bob .",
    "since the channel is stretchable , the input teleportation unitary @xmath102 is mapped into an output unitary @xmath103 .",
    "this is corrected by bob applying @xmath104 .",
    "( bottom )  the final result is the teleportation of the input system @xmath97 onto the output system @xmath98  by using the choi matrix @xmath96 as a resource state . clearly , this process teleports not only the reduced state of @xmath97  but also all its correlations with ancillary systems . at infinite dimension ,",
    "the choi matrix and the bell detection are defined by suitable limits.,scaledwidth=50.0% ]    at infinite dimension , the bosonic epr state is defined as @xmath105 , where @xmath106 is a two - mode squeezed vacuum state with variance @xmath107  @xcite .",
    "correspondingly , the asymptotic choi matrix of a bosonic channel is defined by the limit @xmath108 where @xmath109 , and the ideal bell detection is the limit of a quasi - projection @xmath110 onto displaced versions of @xmath106 . using @xmath111 and @xmath112 in the teleportation - simulation of fig .",
    "[ topbottom ] , we generate a teleportation channel @xmath113 different from @xmath18 .",
    "however , for large @xmath107 , we retrieve @xmath114 for any input state @xmath66 .",
    "let us remark that the criterion of teleportation - covariance of eq .",
    "( [ stretchability ] ) is a novel result in the literature that allows us to easily identify teleportation - simulable channels at any dimension .",
    "also note that our formulation of teleportation - simulation generalizes previous studies , restricted to the class of pauli channels  @xcite ( see methods for details ) .",
    "once we have developed the teleportation - simulation of channels in a more advanced form , applicable at any dimension , we can exploit this tool to design the technique of teleportation stretching .",
    "teleportation stretching simplifies an adaptive protocol via the following steps : ( i ) first we replace the stretchable  channel with teleportation over its choi matrix ; ( ii ) we treat teleportation as an additional locc while anticipating the choi matrix back in time , so as to stretch  it out of the loccs ; ( iii ) finally , we collapse the loccs into a single trace - preserving locc . mathematically , the best way to describe this technique is considering the stretching of the generic @xmath115th use of the channel , after which we iterate the result for all the transmissions .        in fig .",
    "[ reduction ] , we stretch the generic @xmath115th transmission through channel @xmath18 , so that the @xmath115th register state of alice and bob can be written as @xmath116 for some trace - preserving locc @xmath117 . the next step is to iterate eq .",
    "( [ toiterate ] ) , which leads to the output state @xmath118 because the initial state @xmath21 is separable , its preparation can be included in the loccs , so that we may write @xmath119 for a single but very complicated trace - preserving locc @xmath120 . for infinite - dimensional systems , one may use finite - energy resources @xmath111 and @xmath112 as described above .",
    "it is easy to check that these provide an ouput @xmath121 $ ] such that @xmath122 for large @xmath107 , so that eq .",
    "( [ outlemma ] ) is implicitly interpreted assuming such asymptotic limit .",
    "thus , after @xmath32 uses of a stretchable channel @xmath18 , alice and bob s output state can be written as a tensor - product of choi matrices up to a trace - preserving locc @xmath120 .",
    "in other words , the original adaptive protocol has been reduced to a block protocol with exactly the same task but whose output state is generated by distributing @xmath32 epr  states through the channel followed by a final round of two - way assisted los .",
    "this reduction is the core idea of teleportation stretching .",
    "afterwards , we also discuss how to relax eq .",
    "( [ stretchability ] ) and write generalized versions of eq .",
    "( [ outlemma ] ) .",
    "let us remark that teleportation stretching must not be confused with an older and different method present in ref .",
    "* section v ) .",
    "in fact , the latter reference showed how to transform a protocol of quantum communication @xmath123 through a pauli channel @xmath18 into a protocol of entanglement distillation @xmath124 over mixed states @xmath68 ( such that teleporting over @xmath68 reproduces @xmath18 ) .",
    "these protocols have different and inequivalent outputs at any @xmath32 .  clearly , this is very different from our decomposition in eq .",
    "( [ outlemma ] ) , which simplifies an adaptive protocol , with an arbitrary task , into an equivalent block protocol , achieving exactly the same task and output state at any @xmath32 . for instance , eq .",
    "( [ outlemma ] ) may be used to simplify a key - generation adaptive protocol into an equivalent key - generation block protocol , for any number @xmath32 of uses of a stretchable channel at any dimension ( see methods for more discussions ) .",
    "_ entanglement flux as computable upper bound_.  note that eq .",
    "( [ outlemma ] ) alone is not very useful , but its combination with theorem  [ theomain ] provides the insight of our method .",
    "in fact , let us compute the ree  of the state @xmath39 , decomposed as in eq .",
    "( [ outlemma ] ) .",
    "we find@xmath125 where we have used that ( 1 ) the ree is non - increasing under trace - preserving loccs and ( 2 ) it is subadditive under tensor products .",
    "these are two basic properties valid at any dimension  @xcite ( more details for the bosonic channels will be given afterwards ) .",
    "such a manipulation allows us to discard all the details of the complicated @xmath120 .",
    "then , by replacing eq .",
    "( [ torep ] ) into eq .",
    "( [ theo1 ] ) , we can also discard the upper limit and the supremum in the definition of @xmath81 , and we get the simple bound @xmath126 more precisely , we can state the following main result .",
    "[ addtheo]for any stretchable channel @xmath18 , we write@xmath127    * proof . *  the combination of eqs .",
    "( [ theo1 ] ) and  ( [ torep ] ) provides @xmath128 , where we have replaced the @xmath79  with the @xmath78 by applying the feketes lemma to the subadditive sequence @xmath129 .",
    "note that @xmath130 is a specific distribution strategy where alice sends halves of epr states through the channel .",
    "this means that we may also write @xmath131 proving the first equality in eq .",
    "( [ firsteq ] ) . to prove the last equality in eq .",
    "( [ firsteq ] ) , we already know that @xmath132  from eq .",
    "( [ oppo2 ] ) . for the converse part , we apply teleportation stretching to a single use of @xmath18 , so as to write @xmath133 for a trace - preserving locc @xmath134 .",
    "then , the monotonicity of the ree leads to @xmath135 .",
    "@xmath80    thus , our upper bound @xmath81 has been reduced to compute the one - shot ree of the channel @xmath89 and , more precisely , the ree  of its choi matrix @xmath88 . because the latter quantity represents the entanglement distributed through the channel by an epr  state , we simply call it the entanglement flux  of the channel , and we adopt the short - hand notation @xmath136 as we see from theorem  [ addtheo ] , for a stretchable channel we have @xmath137 , meaning that the epr state is the optimal input for distributing entanglement .",
    "most importantly , by combining theorems  [ theomain ] and  [ addtheo ] , we see that the entanglement flux of a stretchable channel is an upper bound for all its two - way capacities . in other words , we automatically prove the following .    [ corollarymain]at any dimension , the generic two - way capacity @xmath54 of a stretchable channel @xmath18 must satisfy@xmath138    afterwards we show the existence of stretchable channels for which the previous upper bound coincide with the lower bound in eq .",
    "( [ hashing ] ) , so that the maximum entanglement they distribute is one - way distillable @xmath139 . for these distillable channels , the ree  is additive , i.e. , eq .",
    "( [ firsteq ] ) has all equalities , and we establish the two - way capacities as @xmath140 .",
    "this important class includes lossy channels , quantum - limited amplifiers , dephasing and erasure channels .        as mentioned before",
    ", we can also relax the condition of eq .",
    "( [ stretchability ] ) and consider more general channels that are decomposable as @xmath141 , where @xmath142 is stretchable while @xmath143 and @xmath144 are arbitrary . for these partly - stretchable channels ,",
    "we may write @xmath145 this allows us to consider other error models , such as amplitude damping , and to handle extra decoherence , such as trusted noise in local setups . the latter condition is particularly relevant for thermal qkd  @xcite and measurement device independent ( mdi ) qkd  @xcite .    a further generalization consists of defining weakly - stretchable channels as those given by the mixture @xmath146 where @xmath147 is a probability distribution . in this case , @xmath148 where @xmath149 is the probability of the stretchable part @xmath150 .",
    "this is needed to study quantum and secure communications which are affected by strong statistical fluctuations , as those induced by atmospheric turbulence in the links between ground stations and satellites  @xcite .",
    "note that eqs .",
    "( [ parseqq ] ) and  ( [ weaklymain ] ) involve choi matrices which are generally different from that of the original channel .",
    "these are the weakest decompositions we can write in order to successfully use our technique .",
    "it is understood that there are many decompositions of a quantum channel as in eq .",
    "( [ wschnn ] ) , so that the problem is to find which decomposition minimizes the upper bound in eq .",
    "( [ weaklymain ] ) .",
    "it is also understood that the definitions of partly- or weakly - stretchable channels are non - trivial as long as we exclude the identity channel @xmath151 from being their stretchable part @xmath142 .",
    "in fact , any quantum channel can always be written as @xmath152 , which leads to the general but trivial upper bound @xmath153 given by the dimension @xmath72 of the input space .",
    "the full classification of channels that can be stretched by teleportation and reduced by our method is shown in fig .",
    "[ channelclass ] .",
    "_ two - way and multiband quantum communication_.  our method can also be extended to other communication scenarios , e.g. , to include the presence of a feedback quantum channel . in this case",
    ", the most general adaptive protocol considers alice and bob sending systems to each other via the two channels , @xmath18 ( forward )  and @xmath143 ( feedback ) , and performing adaptive loccs before and after each transmission .",
    "we can suitably define the generic capacity @xmath154 of the two - way quantum communication assisted by unlimited two - way ccs .",
    "this capacity quantifies the maximum number of target bits that can be distributed per individual transmission by either the forward or the backward channel . for stretchable channels",
    ", we find @xmath155 which reduces to @xmath156 if they are distillable . in the latter case , the optimal strategy is  just the use of the quantum channel with the maximum capacity .",
    "another relevant scenario is the multiband quantum channel @xmath157 , which is an important model for broadband optical communications . in this",
    "setting , alice prepares @xmath158 systems which are simultaneously sent through @xmath158 independent channels or bands  @xmath159 , with adaptive loccs performed before and after each block transmission .",
    "the generic multiband capacity @xmath160 quantifies the maximum number of target bits distributed in each multiband transmission . in the case of stretchable bands",
    "@xmath159 , we can easily show that the multiband capacity must satisfy @xmath161 , which reduces to the additive result @xmath162 if the bands @xmath159 are distillable .",
    "we are now ready to derive the ultimate rates for quantum and secure communication through bosonic channels . for bosonic systems ,",
    "the ideal epr  state @xmath163 has infinite energy , so that the choi matrix of a bosonic channel is energy - unbounded .",
    "this means that the coherent information quantities and the entanglement flux must be computed as limits .",
    "as discussed before , we consider a sequence of two - mode squeezed vacuum states  @xcite @xmath106 with channel output @xmath164 .",
    "this naturally defines the bosonic epr state as @xmath165 and the asymptotic choi matrix of the bosonic channel as @xmath166 .",
    "furthermore , @xmath167 defines a sequence of quasi - projective measurements @xmath168 whose limit is the ideal bell detection .    for the lower bound , the coherent information quantities @xmath59 and @xmath60 are then computed as limits on the sequence @xmath111 .",
    "such quantities are finite for gaussian channels , so that the hashing inequality is automatically extended . for the upper bound , teleportation stretching and all the subsequent derivations leading to corollary  [ corollarymain ]",
    "are formally extended to the asymptotic state @xmath96 via the sequences @xmath111 and @xmath112 ( see methods for more details ) . in particular , by using the lower semicontinuity of the relative entropy  @xcite , we may write @xmath169 for a suitable sequence of separable states @xmath170 .    for gaussian channels , the sequences in eq .",
    "( [ liminf ] ) are composed of gaussian states , for which we can easily compute the relative entropy .",
    "in fact , for any two gaussian states , @xmath171 and @xmath172 , we prove the formula @xmath173 , where @xmath174 is a simple functional of their statistical moments ( see methods ) .",
    "further algebraic manipulations allow us to bound ( and determine ) the two - way capacities of the most relevant gaussian channels , starting from the most important , the lossy channel .",
    "_ rate - loss scaling in quantum optical communications_.  optical communications through free - space links or telecom fibres are inevitably lossy and the standard model to describe this scenario is the lossy channel .",
    "this is a bosonic gaussian channel characterized by a transmissivity parameter @xmath10 , which quantifies the fraction of input photons surviving the channel .",
    "it can be represented as a beam splitter mixing the incoming signals with an environment at zero temperature ( background thermal noise is negligible at optical and telecom frequencies ) .    for a lossy channel @xmath175 with arbitrary transmissivity @xmath10",
    "we apply our reduction method and compute the entanglement flux @xmath176 .",
    "this coincides with the reverse coherent information of this channel @xmath177 , first derived in ref .",
    "thus , we find that this channel is distillable and all its two - way capacities are given by@xmath178 interestingly this capacity coincides with the maximum discord  @xcite that can be distributed to the parties , since we may write  @xcite @xmath179 , where the latter is the discord of the gaussian choi matrix @xmath96  @xcite . also note that we prove the strict separation @xmath180 , where @xmath181 is the unassisted quantum capacity  @xcite .    expanding our formula in eq .",
    "( [ formcloss ] ) at high loss @xmath12 , we find @xmath182 bits per channel use , or about @xmath10 nats per channel use .",
    "this completely characterizes the fundamental rate - loss scaling which rules all long - distance quantum optical communications in the absence of quantum repeaters .",
    "it is important to remark that our work also proves the achievability of this scaling .",
    "this represents a major advance with respect to previous literature , where previous studies based on the squashed entanglement  @xcite identified a non - achievable upper bound , twice of the actual scaling we discovered .    the capacity in eq .",
    "( [ formcloss ] ) is also valid for two - way quantum communication with lossy channels , assuming that @xmath10 is the maximum transmissivity between the forward and feedback channels .",
    "it can also be extended to a multiband lossy channel , for which we write @xmath183 where @xmath184 are the transmissivities of the various bands or frequency components .",
    "for instance , for a multimode telecom fibre with constant transmissivity @xmath10 and bandwidth @xmath185 , we have @xmath186 .",
    "note that we may write @xmath187 for any partly - stretchable channel decomposable as @xmath188 , where @xmath175 is a lossy component .",
    "this encompasses a wide range of situations . depending on the choice of @xmath143 and @xmath144",
    ", we can generate gaussian or non - gaussian channels .",
    "it also allows us to include any form of manipulation or decoherence in the extra channels @xmath143 and @xmath144 , such as trusted noise affecting preparation and detection .",
    "once determined the secret key capacity of the lossy channel , we can analyze the state of the art in high - rate qkd , by comparing this ultimate limit with the maximum rates achievable by practical protocols in the presence of loss .",
    "we assume infinitely long keys and ideal parameters . for cvs",
    "we assume : unit detector efficiency , zero excess noise , large modulation and unit reconciliation efficiency . for dvs",
    "we assume : unit detector efficiencies , zero dark count rates , zero intrinsic error , unit error correction efficiency , and no other internal loss .",
    "the corresponding maximum rates are compared with the secret - key capacity @xmath189 in fig .",
    "[ protocolspic ] . from the figure",
    "we can appreciate how ideal implementations of cv protocols are not so far from the ultimate limit .",
    "db per km .",
    "the secret key capacity of the channel ( red line ) sets the fundamental rate limit for qkd .",
    "compare with the non - tight upperbound of ref .",
    "@xcite ( dotted line ) .",
    "we then show the maximum rates achievable by current protocols .",
    "for the cv protocols ( purple lines ) , we consider : ( i ) one - way no - switching protocol  @xcite , coinciding with cv - mdi - qkd  @xcite in the most asymmetric configuration ( relay approaching alice  @xcite ) . for high loss ( @xmath12 ) , the rate scales as @xmath190 , which is just @xmath191 of the capacity .",
    "same scaling for the one - way switching protocol of ref .",
    "@xcite ; ( ii ) two - way protocol with coherent states and homodyne detection  @xcite which scales as @xmath192 for high loss ( thermal noise is needed for two - way to beat one - way qkd ) . for the dv protocols ( dashed lines ) ,",
    "we consider : bb84 with single - photon sources  @xcite with rate @xmath193 ; bb84 with weak coherent pulses and decoy states  @xcite with rate @xmath194 ; and dv - mdi - qkd  @xcite with rate @xmath195.,scaledwidth=48.0% ]    finally , note that free - space satellite communications may be modeled as a mixture of lossy channels @xmath196 with transmissivities @xmath197 and associated probabilities @xmath198  @xcite . for this fading channel",
    "@xmath199 we may write @xmath200 in general , fading is a random process affecting the attenuation of a channel due to many potential causes , such as the presence of multipath propagation , obstacles or atmospheric turbulence .",
    "the bound in eq .",
    "( [ bfading ] ) applies to any fading channel which can be modeled by a weakly - stretchable channel as in eq .",
    "( [ wschnn ] ) , where the stretchable components @xmath150 are lossy channels while the extra channels @xmath201 and @xmath202 account for any other stochastic process .",
    "_ quantum communications with gaussian noise_.  as discussed above the fundamental limit of the lossy channel provides a general upper bound for the two - way capacities of gaussian channels with lossy components .",
    "here we consider gaussian channels in more detail and we derive tailored upper bounds for each case .",
    "let us start from the thermal - loss channel , which can be modeled as a beamsplitter with transmissivity @xmath10 in a thermal background with @xmath203 mean photons .",
    "its action on input quadratures @xmath204 is given by @xmath205 with @xmath206 being a thermal mode .",
    "this channel is central for quantum communications at the microwave regime but also important for cv qkd at optical and telecom frequencies , where gaussian eavesdropping via entangling cloners results into a thermal - loss channel  @xcite .    for an arbitrary thermal - loss channel @xmath207",
    "we apply our reduction method and compute the entanglement flux@xmath208 -h(\\bar{n } ) , \\label{lossub}%\\ ] ] for @xmath209 , while zero otherwise . in the previous formula",
    "we have set @xmath210 . combining this result with the lower",
    "bound given by the reverse coherent information  @xcite , we write the following inequalities for the two - way capacity of this channel@xmath211 as shown in fig .  [ figtotal]a , the two bounds tend to coincide at sufficiently high transmissivity .",
    "we clearly retrieve the previous result of the lossy channel for @xmath212 .",
    "another important gaussian channel in bosonic communications is the quantum amplifier .",
    "this is a crucial element in quantum cloning  @xcite , therefore playing a non - trivial role in eavesdropping strategies against cv qkd .",
    "this channel @xmath213 is described by @xmath214 , where @xmath215 is the gain and @xmath206 is the thermal environment with @xmath203 mean photons .",
    "we compute the entanglement flux@xmath216 for @xmath217 , while zero otherwise . combining this result with the coherent information  @xcite",
    ", we get @xmath218 whose behavior is plotted in fig .",
    "[ figtotal]b .",
    "we note that the two bounds tend to coincide at low gains .    in the absence of thermal noise ( @xmath212 )",
    ", the previous channel describes a quantum - limited amplifier @xmath219 , for which the bounds in eq .",
    "( [ cthermalamp ] ) coincide .",
    "this channel is therefore distillable and its two - way capacities are@xmath220 in particular , this proves that @xmath221 coincides with the unassisted quantum capacity @xmath222  @xcite .",
    "the result of eq .",
    "( [ campli ] ) sets the fundamental limit for quantum communication , entanglement distribution and secret - key generation using deterministic quantum optical amplifiers .",
    "we see that infinite amplification is useless .",
    "then , for an amplifier with typical gain @xmath223 , the maximum achievable rate for quantum communication is just @xmath224 qubit per use .",
    "finally , one of the simplest models of bosonic decoherence is the additive - noise gaussian channel  @xcite .",
    "this is the direct extension of the classical model of a gaussian channel to the quantum regime .",
    "it can be seen as the action of a random gaussian displacement over incoming states . in terms of input - output transformations ,",
    "it is described by @xmath225 where @xmath226 is a classical gaussian variable with zero mean and variance @xmath227 . for this channel @xmath228",
    "we find the entanglement flux@xmath229 for @xmath230 , while zero otherwise . including the lower bound given by the coherent information  @xcite , we get@xmath231 in fig .  [ figtotal]c , see its behavior and how the two bounds tend to rapidly coincide for small added noise .",
    "it is interesting to note how quantum communication rapidly degrades when we compose quantum channels .",
    "for instance , a quantum - limited amplifier with gain @xmath223 can transmit @xmath232 qubit per use from alice to bob .",
    "this is the same amount which can be transmitted from bob to charlie , through a lossy channel with transmissivity @xmath191 . by using bob as a quantum repeater",
    ", alice can therefore transmit at least @xmath224 qubit per use to charlie .",
    "if we remove bob , and we compose the two channels , we obtain an additive - noise gaussian channel with variance @xmath233 , for which @xmath234 qubits per use .",
    "we now study the ultimate rates for quantum communication , entanglement distribution and secret key generation through the most important qubit channels .",
    "the quantum channels we are going to consider are present in a plethora of scenarios .",
    "for instance they may describe relaxation and dephasing effects in quantum memories , where communication is intended in time , from the storage to the retrieval of quantum information .",
    "they are the most common form of decoherence in quantum information processing .",
    "for instance , they can be found at the chip - scale level , e.g. , in quantum computers based on trapped ions , atoms or superconducting qubits , but also in a model of distributed quantum computer or quantum internet  @xcite , which exploits elements as optical cavities .    from a theoretical point of view , the study of stretchable channels in finite dimension is easier , since their choi matrices are bounded , so that we can apply our reduction method ( sec .",
    "[ reductionsect ] ) without any asymptotic limit . for the upper bound",
    ", we may directly use teleportation stretching to derive @xmath235 , with the latter being the distillable key of the choi matrix .",
    "then , we can exploit the ree  bound @xmath236 ( see  methods ) .",
    "the analysis is more subtle for partly - stretchable channels , since their decomposition may involve both dv and cv channels . in any case , the rigorous method of sec .",
    "[ reductionsect ] does not depend on the dimension and , therefore , it encompasses all possible situations .    _",
    "pauli channels_.  a general error model which describes both the manipulation and transmission of qubits is the pauli channel .",
    "specific examples are the depolarising channel , which uniformly shrinks the bloch sphere , and the dephasing channel , which causes loss of quantum information without energy decay . in particular , phase damping describes processes such as spin - spin relaxation and the scattering of photonic qubits through waveguides .",
    "phase damping is at the basis of the loss of coherence in many quantum systems , especially in circuit quantum electrodynamics  @xcite .",
    "in general , a qubit pauli channel can be written as @xmath237 where @xmath238 , @xmath239 , and @xmath240 are pauli operators  @xcite and @xmath241 is a probability distribution .",
    "it is easy to check that this channel is stretchable and its choi matrix is bell - diagonal .",
    "we compute the entanglement flux exactly as@xmath242 if @xmath243 , while zero otherwise .",
    "since the channel is unital , we have that @xmath244 , where @xmath245 is the shannon entropy .",
    "thus , the two - way capacity of a pauli channel satisfies@xmath246    let us specify the latter result to the case of a depolarising channel , which is defined by a particular choice of the probability distribution @xmath247 in such a way that the three pauli operators are equiprobable .",
    "this is equivalent to say that the input state is mapped into a maximally mixed state with some probability @xmath4 , i.e. , @xmath248 setting @xmath249 , we may then write@xmath250 for @xmath251 , while @xmath252 otherwise . the behavior of this two - way capacity is shown in fig .  [ dvplots]a .    the result can be readily extended to a generalized depolarising channel acting on a qudit of arbitrary dimension @xmath253 .",
    "this channel is defined as in eq .",
    "( [ depolqubits ] ) up to using the mixed state @xmath254 . setting @xmath255 and @xmath256",
    ", we find@xmath257    let us now consider the qubit dephasing channel , which is a pauli channel where only the @xmath240 error is involved with some probability @xmath4 , i.e. , we have @xmath258 in this case , we can easily check that the two bounds of eq .",
    "( [ pauligenmain ] ) coincide , so that the dephasing channel is distillable and its two - way capacities are @xmath259 note that this also proves @xmath260",
    "@xcite , meaning that classical feedback does not increase the quantum capacity of this channel .    for an arbitrary qudit with computational basis @xmath261 ,",
    "the generalized dephasing channel is defined as @xmath262 where @xmath263 is the probability of @xmath115 phase flips , with a single flip being @xmath264 .",
    "this channel is distillable and its two - way capacities are functionals of @xmath265@xmath266    _ quantum erasure channel_.  one of the simplest error model for a qubit is the erasure channel .",
    "this is not a pauli channel and its action is simply described by@xmath267 where @xmath4 is the probability that the input state is transformed into an orthogonal erasure state @xmath268 . for this channel , we already know that @xmath269  @xcite .",
    "we now extend this result to the secret key capacity .    following ref .",
    "@xcite , one shows that @xmath270 .",
    "in fact , suppose that alice sends halves of epr states to bob .",
    "a fraction @xmath271 will be perfectly distributed .",
    "these good cases can be identified by bob applying the measurement @xmath272 on each output system , and communicating the results back to alice in a single and final cc .",
    "therefore , they distill at least @xmath271 ebits per copy .",
    "it is then easy to check that this channel is stretchable and its entanglement flux is @xmath273 .",
    "thus , the erasure channel is distillable and we may write @xmath274    in arbitrary dimension @xmath72 ,  the generalized erasure channel is defined as in eq .",
    "( [ erasuredef ] ) , where @xmath66 is now the state of a qudit and the erasure state @xmath268 lives in the extra @xmath275 dimension .",
    "we can easily generalize the previous derivations to find that this channel is distillable and @xmath276 note that the latter result can also be obtained by computing the squashed entanglement of the erasure channel , as shown by the independent derivation of ref .",
    "@xcite .",
    "_ amplitude damping channel_.  finally , an important model of decoherence in two - level quantum systems , such as a spins or an optical cavities , is energy dissipation or amplitude damping .",
    "many spin chain communication networks can also be described as an overall amplitude damping channel which affects the transmission of a spin excitation from a sender to a receiver , at the opposite ends of the chain  @xcite .",
    "these spin chains may represent a possible medium for on - chip quantum communication which avoids the conversion between localized ( register ) qubits and flying ( photonic ) qubits  @xcite .",
    "the action of an amplitude damping channel over an input qubit state is described by the kraus decomposition @xmath277 , where@xmath278 and @xmath4 is the probability of damping .",
    "this channel is partly - stretchable .",
    "in fact , it is decomposable as @xmath279 where @xmath280 is an identity mapping from the original qubit to a single - rail qubit , which is the subspace of a bosonic mode spanned by the vacuum and the single - photon states ; then , @xmath281 is a lossy channel with transmissivity @xmath282 ; finally , @xmath283 is an identity mapping from the single - rail qubit to the original qubit . the mappings can be realized via hybrid teleportation .    using eq .",
    "( [ parseqq ] ) , we write the upper bound @xmath284 = -\\log_{2}p$ ] , which can be strengthened into @xmath285 where we also use the dimensionality bound associated with the input alphabet . the best lower bound",
    "is given by the reverse coherent information  @xcite@xmath286 the upper bound in eq .",
    "( [ c2dampbb ] ) is extremely simple and can be easily extended to the study of spin communication networks with arbitrary topology  @xcite .",
    "however , it is good only at strong damping ( @xmath287 ) .",
    "in fact , we may compute a tighter bound by using the squashed entanglement ( see methods ) .",
    "we find@xmath288 note that this bound is also tighter than  @xcite @xmath289 , which is computed from the entanglement - assisted classical capacity @xmath290 .",
    "see also fig .",
    "[ dvplots]b .     with arbitrary probability @xmath4 .",
    "it is contained in the shadowed region specified by the bounds in eq .",
    "( [ depmain ] ) .",
    "we also depict the best known bound based on the squashed entanglement  @xcite ( dashed ) . *",
    "b *  two - way capacity of the amplitude damping channel @xmath291 for arbitrary damping probability @xmath4 .",
    "it is contained in the shadowed area identified by the lower bound ( lb ) of eq .",
    "( [ lbrevcoherad ] ) and the upper bound ( ub ) of eq .",
    "( [ ubmainsquash ] ) .",
    "we also depict the bound of eq .",
    "( [ c2dampbb ] ) ( upper solid line ) , which is good only at high dampings ; and the bound @xmath292 of ref .",
    "@xcite ( dotted line ) .",
    "finally , note the separation of the two - way capacity @xmath293  from the unassisted quantum capacity @xmath294 ( dashed line).,scaledwidth=31.0% ]",
    "summary_.  in this work we have established the fundamental limits of quantum communication , entanglement distribution and secret key generation in the absence of quantum repeaters . on the one hand , these limits tell us the optimal rates that direct point - to - point protocols can achieve ; on the other , they provide the fundamental benchmarks that quantum repeaters must surpass in order to be effective devices .",
    "we have determined these limits at any dimension , from qubits to bosonic systems .    in order to achieve our results",
    "we have designed a powerful reduction method : this combines the relative entropy of entanglement , suitably extended to quantum channels , with a teleportation - based technique , dubbed teleportation stretching .",
    "this method reduces the most general adaptive protocol implemented over a wide family of quantum channels to the computation of a simple one - shot quantity , the entanglement flux .",
    "this is shown to be the tightest upper bound for the two - way capacities ( @xmath0 , @xmath1 and @xmath2 ) of many fundamental quantum channels in both discrete- and continuous - variable settings .",
    "in fact , combining our upper bound with suitable lower bounds , we have established simple and coincident formulas for the various two - way capacities ( @xmath295 ) of the bosonic lossy channel , the quantum - limited amplifier , and the dephasing channel in arbitrary dimension , besides the secret - key capacity @xmath2 of the erasure channel in arbitrary dimension .",
    "all these results have been obtained after about @xmath11 years since the first studies  @xcite .    for the specific analysis of the bosonic channels , we have also extended the hashing inequality to cv  systems and proven a closed formula for computing the relative entropy of two arbitrary multimode gaussian states ( starting from their gibbs - exponential representation  @xcite ) .",
    "this formula does not involve residual symplectic decompositions , being directly expressed in terms of the statistical moments of the gaussian states .",
    "it therefore supersedes previous implicit expressions where symplectic transformations need to be carried out  @xcite .",
    "our result for the lossy channel completely characterizes the long - sought and fundamental rate - loss scaling which affects any quantum optical communication , setting the ultimate achievable rate for repeaterless qkd at @xmath296 bits per channel use , i.e. , about @xmath297 bits per use at high loss .",
    "this confirms a prediction from 2009  @xcite , which inspired the explorations of the ultimate limits in the bosonic setting .",
    "it also confirms the potentialities of the reverse reconciliation which dates back to the seminal @xmath298 experiment on high - rate qkd  @xcite .",
    "_ other aspects_.  it is interesting to discuss the role of the time cost for the ccs , since these are ultimately restricted by the speed of light .",
    "one may argue that unassisted or forward - assisted protocols might be faster than two - way assisted protocols in practical implementations .",
    "in fact , this could happen if ccs were needed for each use of the quantum channel .",
    "our work shows that this practical caveat does not hold for distillable channels .",
    "in fact , for a distillable channel @xmath18 , we have @xmath299 , meaning that any adaptive protocol can be reduced to alice and bob distributing epr pairs .",
    "after this distribution , a single round of ccs ( forward or backward ) is sufficient for implementing entanglement distillation .",
    "then , qubits can be teleported via the distilled pairs using another single round of ccs , now forward from alice to bob .",
    "the time cost associated with two rounds of ccs is clearly negligible in the limit of many uses of the channel .",
    "however , also note that quantum memories are needed for implementing final loccs .",
    "let us also discuss energy constraints at the input of bosonic channels .",
    "imposing such constraints is not necessary since the two - way capacities @xmath1 , @xmath0 and @xmath2 are already bounded by quantum mechanics ( different would be the case for the classical capacity ) . in any case",
    ", we have verified that our bound for the lossy channel @xmath300 remains sufficiently tight even if we constrain the input energy down to one mean photon , which is the ideal regime of qubit - based qkd . at such low energies and for long distances ,",
    "it is tighter than any energy - constrained bound based on the squashed entanglement .",
    "_ recent developments and future directions_.  as previously mentioned , our reduction method based on relative entropy of entanglement and teleportation stretching is very general and can be used well beyond the scope of this work .",
    "indeed it has been already used to extend the results to the presence of quantum repeaters .",
    "more precisely , ref .",
    "@xcite have recently studied and simplified the most general adaptive protocols of quantum and private communication between the two end - points of a repeater chain and , more generally , of an arbitrarily - complex quantum network , where systems may be routed though single or multiple paths .",
    "depending on the type of routing , the end - to - end capacities are achieved by solving the widest path or the maximum flow problem .",
    "@xcite also considered multiple senders and receivers in the quantum network , proving a quantum version of the network coding theorem for quantum key distribution .",
    "it is clear that our technique of teleportation stretching can also be combined with other entanglement measures , which are monotonic under loccs and subadditive over tensor products .",
    "this is certainly true for other measures based on the relative entropy , e.g. , the rains bound  @xcite .",
    "more interestingly , teleportation stretching can be combined with the quantum fisher information to completely simplify adaptive protocols for quantum parameter estimation  @xcite ; in a similar way , it can be exploited to reduce adaptive protocols for quantum channel discrimination  @xcite .",
    "let us conclude by saying that further efforts should certainly be addressed to improve the upper and/or lower bounds for some of the quantum channels that we studied .",
    "the two - way capacities of important channels such as the thermal - loss channel , the depolarising channel and the amplitude damping channel are yet to be determined and will be the object of future work .",
    "here we provide a summary of the contents of the supplementary material .",
    "@xmath301supplementary section  i : we briefly discuss some general aspects of the trace - preserving loccs , also in connection with the mean rate of the protocol .",
    "@xmath301supplementary section  ii : we give full details of the lower bound based on the coherent and reverse coherent information at any dimension .",
    "we discuss how to extend the hashing inequality to cv systems and energy - unbounded choi matrices of bosonic gaussian channels .",
    "@xmath301supplementary section  iii : we prove our weak converse theorem  [ theomain ] , which establishes the general upper bound based on the adaptive ree of the channel , valid at any dimension ( finite or infinite ) .",
    "@xmath301supplementary section  iv : we provide general notions on quantum teleportation , the structure of the teleportation unitaries at any dimension , and the mappings between dvs and cvs , e.g. , via hybrid teleportation .",
    "@xmath301supplementary section  v : we briefly review the teleportation - simulation of quantum channels ,  that was originally introduced for the restricted class of pauli channels . we show how to advance this tool in order to include the other dv channels and also handle cv  channels .",
    "in particular , we introduce the property of teleportation covariance ( stretchability ) for a quantum channel and we show that this property is equivalent to the teleportation - simulation of the channel by means of its choi matrix .",
    "finally , we discuss how the definition of stretchable channel can be weakened and generalized to consider partly- and weakly - stretchable channels , so as to include amplitude damping , fading channels etc .",
    "@xmath301supplementary section  vi : we provide full details on the novel technique of teleportation stretching , showing the general block reduction of an arbitrary adaptive protocol implemented on a stretchable , partly- or weakly - stretchable channel .",
    "the crucial connection with the relative entropy of entanglement is also discussed .",
    "then , we provide full details of teleportation stretching for bosonic channels , where suitable limits have to be considered .",
    "finally , we discuss additional details and simplifications for the teleportation stretching of discrete - variable channels .",
    "@xmath301supplementary section  vii : we discuss the originality of teleportation stretching with respect to previous literature , thoroughly comparing it with the different methods and results of ref .",
    "* section v ) .",
    "@xmath301supplementary section  viii : we show the results for the two - way quantum communication .",
    "@xmath301supplementary section  ix : we show the results for the multiband quantum channel .",
    "@xmath301supplementary section  x : we provide the basic tools for proving the results related with the bosonic gaussian channels . after some basic notions , we prove our closed formula for the relative entropy between two arbitrary multimode gaussian states , directly expressed in terms of their statistical moments .",
    "@xmath301supplementary section  xi : we give the main derivations for the bosonic gaussian channels .",
    "first we discuss the lower bound of the coherent and reverse coherent information , also including a short discussion of the lower bound of ref .",
    "then , we compute the entanglement flux of the various gaussian channels .",
    "we end with a discussion of the potential use of energy constraints .",
    "@xmath301supplementary section  xii : we give the main derivations for the discrete - variable channels .",
    "we compute the entanglement flux of : erasure channels , pauli channels ( depolarising , dephasing ) and , finally , amplitude damping channels . for the latter",
    "we also derive a tight upper bound based on the squashed entanglement .",
    "@xmath301supplementary section  xiii : we provide details on the ideal rates of current qkd  protocols .",
    "let us provide here a schematic list of our key findings .    1 .",
    "we have designed a reduction method which simplifies any protocol for quantum communication , entanglement distribution and secret key generation which is based on unlimited two - way ccs and adaptive local operations ( adaptive loccs ) . this is possible by combining two main ingredients : + 1.1 ) teleportation stretching .",
    "this technique reduces @xmath32 adaptive uses of a quantum channel into a tensor - product of choi matrices , not necessarily of the same original channel , plus a single locc .",
    "teleportation stretching achieves this goal for a completely general adaptive protocol .",
    "it considers any dimension ( finite or infinite ) and can be implemented over an extremely wide family of quantum channels , identified as those which commute or partially commute with teleportation ( even in a statistical fashion ) .",
    "it can also be extended to more complex communication scenarios .",
    "+ 1.2 ) the other ingredient is the extension of the relative entropy of entanglement ( ree ) from states to channels .",
    "this allows us to bound the optimal rates achievable by an adaptive protocol implemented over an arbitrary quantum channel . in combination with teleportation stretching we",
    "can completely discard all the adaptive loccs of the protocol and bound its performance with a computable one - shot quantity , the entanglement flux .",
    "thus , the insight of the entire reduction method is the suitable combination of points ( 1.1 ) and ( 1.2 ) , i.e. , it is a ` ree+teleportation ' reduction method .",
    "we have shown that the entanglement flux is the tightest upper bound for the two - way capacities of many quantum channels at any dimension , finite ( qubit , qudits ) or infinite ( bosonic systems ) .",
    "by using our reduction method , we have determined the two - way capacities ( @xmath0 , @xmath1 and @xmath2 ) of the bosonic lossy channel , the quantum - limited amplifier , the dephasing channel in arbitrary dimension , and the secret key capacity @xmath2 of the erasure channel in arbitrary dimension .",
    "all these capacities have extremely simple formulas . 4 .",
    "we have finally characterized the fundamental rate - loss tradeoff affecting quantum optical communications , so that repeaterless qkd  is restricted to @xmath297 bits per channel use at long distances .",
    "we have extended the hashing inequality to continuous variables , including the energy - unbounded choi matrices of bosonic gaussian channels .",
    "we have proven a computable formula for the relative entropy between two arbitrary gaussian states",
    ". this formula does not involve residual symplectic decompositions , since it is directly expressed in terms of the statistical moments of the gaussian states , i.e. , their mean values and covariance matrices . from this point of view",
    ", it supersedes previous implicit expressions where symplectic transformations need to be carried out  @xcite .    * acknowledgments*.  we acknowledge support from the epsrc  via the ` uk quantum communications hub ' ( ep / m013472/1 ) and ` qdata ' ( ep / l011298/1 ) , and from the erc ( starting grant 308253 pacomanedia ) . in alphabetic order we would like to thank g. adesso , s. bose , s. l. braunstein , t. cope , k. goodenough , f. grosshans , s. guha , m. horodecki , l. jiang , c. lupo , s. mancini , a. muller - hermes , b. schumacher , m. westmoreland , m. m. wilde , and a. winter for feedback , comments and discussions .    999    nielsen , m. a. & chuang , i. l. quantum computation and quantum information ( cambridge university press , cambridge , 2000 ) .",
    "braunstein , s. l. & van loock , p. quantum information with continuous variables .",
    "* 77 * , 513 ( 2005 ) .",
    "weedbrook , c. _ et al .",
    "_ gaussian quantum information .",
    "phys . _ * 84 * , 621 ( 2012 ) .",
    "holevo , a. quantum systems , channels , information : a mathematical introduction ( de gruyter , berlin - boston , 2012 ) .",
    "wilde , m. m. quantum information theory ( cambridge university press , cambridge , 2013 ) .",
    "bennett , c. h. & brassard , g. quantum cryptography : public key distribution and coin tossing .",
    "ieee international conf . on computers , systems , and signal processing _ , _ bangalore _ , pp .",
    "175179 ( 1984 ) .",
    "ekert , a. k. quantum cryptography based on bell s theorem .",
    "* 67 * , 661663 ( 1991 ) .",
    "gisin , n. , ribordy , g. , tittel , w. & zbinden , h. quantum cryptography .",
    "phys . _ * 74 * , 145 - 196 ( 2002 ) .",
    "scarani , v. _ et al . _ the security of practical quantum key distribution .",
    "phys . _ * 81 * , 1301 , ( 2009 ) .",
    "kimble , h. j. the quantum internet .",
    "_ nature _ * 453 * , 10231030 ( 2008 ) .",
    "pirandola , s. & braunstein , s. l. unite to build a quantum internet .",
    "_ nature _ * 532 * , 169171 ( 2016 ) .",
    "pirandola , s. _ et al . _ advances in quantum teleportation .",
    "_ nature photon .",
    "_ * 9 * , 641652 ( 2015 ) .",
    "andersen , u. l. , neergaard - nielsen , j. s. , van loock , p. & furusawa , a. hybrid discrete- and continuous - variable quantum information .",
    "_ nature phys . _",
    "* 11 * , 713719 ( 2015 ) .",
    "xiang , z .-",
    "ashhab , s. , you , j. q. & nori , f. hybrid quantum circuits : superconducting circuits interacting with other quantum systems .",
    "phys . _ * 85 * , 623 - 653 ( 2013 ) .",
    "kurizki , g. _ et al .",
    "_ quantum technologies with hybrid systems .",
    "usa _ * 112 * , 3866 - 73 ( 2015 ) .",
    "briegel , h .- j . ,",
    "dr , w. , cirac , j. i. & zoller , p. quantum repeaters : the role of imperfect local operations in quantum communication .",
    "lett . _ * 81 * , 5932 - 5935 ( 1998 ) .",
    "van meter , r. quantum networking ( john wiley & sons , 2014 ) .",
    "vedral , v. , plenio , m. b. , rippin , m. a. & knight , p. l. quantifying entanglement .",
    "lett . _ * 78 * , 2275 - 2279 ( 1997 ) .",
    "vedral , v. & plenio , m. b. entanglement measures and purification procedures .",
    "rev . a _ * 57 * , 1619 ( 1998 ) .    vedral , v. the role of relative entropy in quantum information theory .",
    "* 74 * , 197 ( 2002 ) .",
    "bennett , c. h. , brassard , g. , crepeau , c. , jozsa , r. , peres , a. & wootters , w. k. teleporting an unknown quantum state via dual classical and einstein - podolsky - rosen channels .",
    "lett . _ * 70 * , 1895 ( 1993 ) .",
    "braunstein , s. l. & kimble , h. j. teleportation of continuous quantum variables .",
    "lett . _ * 80 * , 869872 ( 1998 ) .",
    "horodecki , k. , horodecki , m. , horodecki , p. & oppenheim , j. secure key from bound entanglement .",
    "lett . _ * 94 * , 160502 ( 2005 ) .",
    "choi , c. completely positive linear maps on complex matrices .",
    "_ linear algebra appl_. * 10 * , 285290 ( 1975 ) .",
    "bennett , c. h. , divincenzo , d. p. , & smolin , j. a. capacities of quantum erasure channels .",
    "lett . _ * 78 * , 3217 - 3220 ( 1997 ) .",
    "devetak , i. & winter , a. relating quantum privacy and quantum coherence : an operational approach .",
    "lett . _ * 93 * , 080501 ( 2004 ) .",
    "devetak , i. & winter , a. distillation of secret key and entanglement from quantum states .",
    "a _ * 461 * , 207 ( 2005 ) .",
    "devetak , i. the private classical capacity and quantum capacity of a quantum channel .",
    "_ ieee trans .",
    "info . theory _",
    "* 51 * , 44 - 55 ( 2005 ) .",
    "grosshans , f. _ _ et al .",
    "_ _ quantum key distribution using gaussian - modulated coherent states .",
    "_ nature _ * 421 * , 238 - 241 ( 2003 ) .",
    "garca - patrn , r. , pirandola , s. , lloyd , s. & shapiro , j. h. reverse coherent information .",
    "lett . _ * 102 * , 210501 ( 2009 ) .",
    "pirandola , s. , garca - patrn , r. , braunstein , s. l. & lloyd , s. direct and reverse secret - key capacities of a quantum channel .",
    "lett . _ * 102 * , 050503 ( 2009 ) .",
    "takeoka , m. , guha , s. & wilde , m.m .",
    "fundamental rate - loss tradeoff for optical quantum key distribution . _ nature comms . _ * 5 * , 5235 ( 2014 ) .",
    "christandl , m. & winter , a. squashed entanglement : an additive entanglement measure .",
    "_ j. of math .",
    "* 45 * , 829 - 840 ( 2004 ) .",
    "christandl , m. the structure of bipartite quantum states : insights from group theory and cryptography . _ phd thesis , university of cambridge , 2006 .",
    "_    maurer , u. m. & wolf .",
    "s. unconditionally secure key agreement and the intrinsic conditional information .",
    "_ ieee trans .",
    "info . theory _ * 45 * , 499 - 514 ( 1999 ) .",
    "curty , m. , lewenstein , m. & ltkenhaus , n. entanglement as a precondition for secure quantum key distribution .",
    "lett . _ * 92 * , 217903 ( 2004 ) .",
    "schumacher , b. & nielsen , m. a. quantum data processing and error correction .",
    "rev . a _ * 54 * , 2629 ( 1996 ) .    lloyd , s. capacity of the noisy quantum channel .",
    "rev . a _ * 55 * , 1613 ( 1997 ) .",
    "donald , m. j.  & horodecki , m. continuity of relative entropy of entanglement .",
    "lett . a _ * 264 * , 257 - 260 ( 1999 ) .",
    "bennett , c. h. , divincenzo , d. p. , smolin , j. a. & wootters , w. k. mixed - state entanglement and quantum error correction .",
    "rev . a _ * 54 * , 3824 - 3851 ( 1996 ) .    horodecki , m. , horodecki , p. & horodecki , r. general teleportation channel , singlet fraction , and quasidistillation .",
    "a _ * 99 * , 1888 ( 1999 ) .",
    "bowen , g. & bose , s. teleportation as a depolarizing quantum channel , relative entropy and classical capacity .",
    "_ * 87 * , 267901 ( 2001 ) .",
    "filip , r. continuous - variable quantum key distribution with noisy coherent states .",
    "_ phys . rev . a _ * 77 * , 022310 ( 2008 )",
    ".    usenko , v. c. & filip , r.  feasibility of continuous - variable quantum key distribution with noisy coherent states .",
    "rev . a _ * 81 * , 022318 ( 2010 ) .",
    "weedbrook , c. _ et al .",
    "_ quantum cryptography approaching the classical limit .",
    "lett . _ * 105 * , 110501 ( 2010 ) .",
    "weedbrook , c. _ et al .",
    "_ continuous - variable quantum key distribution using thermal states",
    "rev . a _ * 86 * , 022318 ( 2012 ) .",
    "weedbrook , c. , ottaviani , c. & pirandola , s. two - way quantum cryptography at different wavelengths .",
    "a _ * 89 * , 012309 ( 2014 ) .",
    "braunstein , s. l. & pirandola , s. side - channel - free quantum key distribution .",
    "_ * 108 * , 130502 ( 2012 ) .    lo , h .- k . , curty , m. & qi , b. measurement - device - independent quantum key distribution .",
    "lett . _ * 108 * , 130503 ( 2012 ) .",
    "pirandola , s. _ et al .",
    "_ high - rate measurement - device - independent quantum cryptography .",
    "_ nature photon . _",
    "* 9 * , 397 - 402 ( 2015 ) .",
    "ottaviani , c. , spedalieri , g. , braunstein , s.l . & pirandola , s. continuous - variable quantum cryptography with an untrusted relay : detailed security analysis of the symmetric configuration .",
    ". rev . a _ * 91 * , 022320 ( 2015 ) .    rubenok , a. , slater , j. a. , chan , p. , lucio - martinez , i. & tittel , w. real - world two - photon interference and proof - of - principle quantum key distribution immune to detector attacks .",
    "lett . _ * 111 * , 130501 ( 2013 ) .",
    "ferreira da silva , t. et al .",
    "proof - of - principle demonstration of measurement - device - independent quantum key distribution using polarization qubits .",
    "rev . a _ * 88 * , 052303 ( 2013 ) .    tang , y .- l .",
    "_ et al . _ measurement - device - independent quantum key distribution over 200 km . _",
    "lett . _ * 113 * , 190501 ( 2013 ) .",
    "hosseinidehaj , n. & malaney , r. gaussian entanglement distribution via satellite .",
    "a _ * 91 * , 022304 ( 2015 ) .    modi , k. _ et al . _",
    "the classical - quantum boundary for correlations : discord and related measures .  _ rev .",
    "phys . _ * 84 * , 1655 ( 2012 ) .",
    "pirandola , s. quantum discord as a resource for quantum cryptography .",
    "rep . _ * 4 * , 6956 ( 2014 ) .",
    "pirandola , s. , spedalieri , g. , braunstein , s.l . ,",
    "cerf , n. j. & lloyd , s. optimality of gaussian discord .",
    "lett . _ * 113 * , 140405 ( 2014 ) .",
    "weedbrook , c. _ et al .",
    "_ quantum cryptography without switching .",
    "lett . _ * 93 * , 170504 ( 2004 ) .",
    "spedalieri , g. _ et al .",
    "_ quantum cryptography with an ideal local relay .",
    "_ proceedings of the spie security + defence 2015 conference on quantum information science and technology _ , toulouse , france ( 21 - 24 september 2015 ) .",
    "pirandola , s. , mancini , s. , lloyd , s. & braunstein , s. l. continuous - variable quantum cryptography using two - way quantum communication .",
    "_ nature phys . _ * 4 * , 726 ( 2008 ) .",
    "ottaviani , c. & pirandola s. general immunity and superadditivity of two - way gaussian quantum cryptography .",
    "_ sci . rep_. * 6 * , 22225 ( 2016 ) .",
    "goodenough , k. , elkouss , d. & wehner , s. assessing the performance of quantum repeaters for all phase - insensitive gaussian bosonic channels .",
    "_ preprint arxiv_:1511.08710v1 ( 2015 ) .",
    "holevo , a. s. & werner , r. f. evaluating capacities of bosonic gaussian channels .",
    "rev . a _ * 63 * , 032312 ( 2001 )",
    ".    braunstein , s. l. , cerf , n. j. , iblisdir , s. , van loock , p. & massar , s. optimal cloning of coherent states with a linear amplifier and beam splitters .",
    "lett . _ * 86 * , 4938 ( 2001 ) .",
    "wolf , m. m. , prez - garca , d. & giedke , g. quantum capacities of bosonic channels .",
    "lett . _ * 98 * , 130501 ( 2007 ) .",
    "bose , s. quantum communication through an unmodulated spin chain .",
    "lett . _ * 20 * , 207901 ( 2003 ) .",
    "bose , s. , bayat , a. , sodano , p. , banchi , l. & verrucchi , p. spin chains as data buses , logic buses and entanglers in quantum state transfer and network engineering  ( springer berlin heidelberg , 2014 ) , pp 1 - 37 .",
    "schoelkopf , r. j. & girvin , s. m. wiring up quantum systems . nature * 451 * , 664 - 669 ( 2008 ) .",
    "devetak , i. & shor , p.w .",
    "the capacity of a quantum channel for simultaneous transmission of classical and quantum information ,  _ commun .",
    "phys . _ * 256 * , 287303 ( 2005 ) .",
    "pirandola , s. capacities of repeater - assisted quantum communications . _ preprint arxiv_:1601.00966 ( 2016 ) .",
    "banchi , l. , braunstein , s.l . & pirandola , s. quantum fidelity for arbitrary gaussian states .",
    "lett . _ * 115 * , 260501 ( 2015 ) .",
    "chen , x .- y .",
    "gaussian relative entropy of entanglement .",
    "rev . a _ * 71 * , 062320 ( 2005 )",
    ".    scheel , s. , & welsch d .-",
    "entanglement generation and degradation by passive optical devices .",
    "rev . a _ * 64 * , 063811 ( 2001 ) .    rains , e. m. a semidefinite program for distillable entanglement .",
    "_ ieee trans .",
    "info . theory _",
    "* 47 * , 29212933 ( 2001 ) .",
    "audenaert , k. , de moor , b. , vollbrecht , k. g. h. & werner , r. f. asymptotic relative entropy of entanglement for orthogonally invariant states .",
    "_ physical review a _ * 66 * , 032310 ( 2002 ) .",
    "pirandola , s. & lupo , c. ultimate precision of adaptive quantum metrology .",
    "_ in preparation .",
    "_    supplementary material",
    "in our main text , we define quantum protocols which are based on local operations ( los ) and unlimited two - way classical communication ( cc ) , briefly called adaptive loccs . in particular , we say that such adaptive loccs are implicitly assumed to be averaged over the outcomes of the local measurements and are therefore trace - preserving . here",
    "we briefly discuss such an averaging process , why it is important and how it is connected with the actual rate of the protocol .",
    "recall that los may involve both trace - preserving operations ( such as local quantum channels , addition of ancillas , and discarding of systems ) and non trace - preserving operations , i.e. , quantum measurements .",
    "it is easy to understand that the latter operations can be converted into trace - preserving ones when we average over their outcomes .",
    "after this procedure , any locc becomes trace - preserving , i.e. , a specific kind of a completely - positive trace - preserving ( cptp ) map .",
    "let us describe the process with a simple example .",
    "consider alice and bob sharing a quantum state @xmath302 . on system @xmath97 , alice performs a quantum measurement , described by a positive - operator valued measure ( povm ) with measurement operators @xmath303 and @xmath304 .",
    "outcome @xmath101 is achieved with probability @xmath305 and classically communicated to bob , who then performs a unitary operation @xmath102 on his system @xmath98 . for any @xmath101",
    ", we have the conditional ( non trace - preserving ) locc @xmath306    re - normalizing we obtain the conditional state@xmath307 now , the mean output state is given by @xmath308 where the average locc @xmath120 is now trace - preserving and explicitly reads@xmath309    the trace - preserving property is very important in order to exploit the properties of the relative entropy of entanglement ( ree ) @xmath310 .",
    "in fact , this is an entanglement measure which is convex , subadditive on tensor products and monotonic under trace - preserving loccs .",
    "thus , we may write  @xcite@xmath311    &   = e_{r}(\\bar{\\rho}_{ab})\\nonumber\\\\ &   \\leq{\\textstyle\\sum\\nolimits_{k } } p_{k}e_{r}(\\rho_{ab}^{k})\\leq e_{r}(\\rho_{ab}).\\end{aligned}\\ ] ]      as previously mentioned , an important reason behind the use of trace - preserving loccs is that they directly provide the average rate of the protocol",
    ". suppose that alice and bob perform the adaptive protocol described in the main text and they implement loccs that contain measurements .",
    "denote by @xmath312 the sequence of outcomes and by @xmath313 the associated joint probability . for any sequence @xmath314",
    ", we have a sequence of conditional ( non trace - preserving )  loccs @xmath315 which generate the un - normalized state @xmath316 .",
    "suppose that the normalized output state @xmath317 is epsilon close to a corresponding target state @xmath318  with rate @xmath319 .",
    "this means that we have @xmath320 in trace norm or , equivalently , @xmath321",
    "\\leq\\varepsilon,\\ ] ] in trace distance",
    ". the actual rate of the protocol will be given by the average @xmath322 which is exactly the value associated with the average target state @xmath323 .",
    "now , it is easy to show that @xmath40 can be approximated by the mean output state @xmath324 which is generated by considering the average loccs @xmath325 in fact , we may write @xmath326 \\nonumber\\\\ &   \\leq\\sum_{u}p(u)d\\left [   \\rho_{\\mathbf{ab}}^{n}(u),\\phi_{n}(u)\\right ] \\leq\\varepsilon,\\end{aligned}\\ ] ] where we use the joint convexity of the trace distance . as a result , the average rate of the protocol @xmath38 can be computed from the average trace - preserving loccs @xmath43 .",
    "consider a quantum channel @xmath18 applied to some input state @xmath327 of system @xmath55 .",
    "let us introduce the purification @xmath328 of @xmath329 by means of an auxiliary system @xmath330 .",
    "we can therefore consider the output @xmath331 . by definition ,",
    "the coherent information is  @xcite@xmath332 where @xmath333 and @xmath334 is the von neumann entropy .",
    "similarly , the reverse coherent information is given by  @xcite@xmath335 where @xmath336 .",
    "when the input state @xmath329 is a maximally - mixed state , its purification is a maximally - entangled state @xmath337 , so that @xmath338 is the choi matrix of the channel , i.e. , @xmath96 .",
    "we then define the coherent information of the channel as @xmath339 similarly , its reverse coherent information is @xmath340    note that for unital channels , i.e. , channels preserving the identity @xmath341 , we have @xmath342 .",
    "this is just a consequence of the fact that , the reduced states @xmath329 and @xmath343 of a maximally entangled state @xmath337 is a maximally - mixed state @xmath254 , where @xmath72 is the dimension of the hilbert space ( including the limit for @xmath344 ) . if the channel is unital , also the reduced state @xmath345 is maximally - mixed . as a result , @xmath346 and we may write @xmath347 .    in the specific case of discrete - variable systems ( @xmath348 ) , we have @xmath349 and therefore@xmath350 in particular , for unital qubit channels ( @xmath351 ) , one has@xmath352 the latter two formulas will be exploited to compute the coherent information of discrete - variable channels .",
    "the coherent information is an achievable rate for _ forward _ one - way entanglement distillation .",
    "similarly , the reverse coherent information is an achievable rate for _ backward _ one - way entanglement distillation ( i.e. , assisted by a single and final cc from bob to alice ) .",
    "in fact , thanks to the hashing inequality  @xcite , we may write @xmath353      the hashing inequality is known to be valid for finite - dimensional quantum systems . here",
    "we show that it also applies to energy - constrained states in infinite dimension . in this case",
    "we can easily show the continuity of the ( reverse ) coherent information in the limit of infinite dimension , which allows us to extend the hashing inequality .",
    "consider a two - mode state @xmath354 where each mode has @xmath355 mean photons .",
    "we can always find a finite - dimensional projector @xmath356 such that @xmath357 where @xmath358 , with @xmath359 being the dimension of the truncated hilbert space @xmath360 of each mode ( the proof is a trivial adaptation of that in refs .",
    "@xcite ) .",
    "let us consider the truncated state @xmath361^{-1}\\hat{p}_{\\gamma}\\rho_{ab}\\hat{p}_{\\gamma}~.\\ ] ] using eq .",
    "( [ eq : energy02 ] ) , one can write the following inequality@xmath362 where @xmath363  is the trace norm . the proof of is a simple modification of the one given by ref .",
    "@xcite .    both @xmath354 and @xmath364",
    "have @xmath365 mean photons . the trace - distance condition @xmath366  implies@xmath367   + 32h_{2}(3\\varepsilon)~ , \\label{condent}\\ ] ] where @xmath368 is the binary shannon entropy .",
    "this is just lemma  17 of ref .",
    "@xcite by setting @xmath369 and @xmath370 .",
    "thus , writing eq .",
    "( [ condent ] ) for the coherent information @xmath371 and using eq .",
    "( [ lemmaeq2 ] ) , we derive@xmath372   + 32h_{2}\\left [ o\\left (   \\frac{\\sqrt{\\bar{n}}}{d}\\right )   \\right ] \\nonumber\\\\ \\rightarrow0,~\\text{for~}d\\rightarrow+\\infty~.\\end{gathered}\\ ] ] a fully equivalent result holds for the reverse coherent information @xmath373 .",
    "thus for any @xmath203 , the ( reverse ) coherent information is continuous in the limit of infinite dimension .",
    "this means that the hashing inequality  @xcite is automatically extended to cv systems with constrained energy . in other words",
    ", @xmath374 ( @xmath375 ) represents an achievable rate for the one - way distillable entanglement of the bounded cv state @xmath66 via forward ( backward ) ccs .      for cv systems ,",
    "the ideal epr  state @xmath163 is defined as the limit of two - mode squeezed vacuum ( tmsv ) states @xmath106 , where @xmath376 is sent to infinity ( here @xmath203 is the mean photon number in each mode ) .",
    "thus , the choi matrix of a gaussian channel is defined as the asymptotic operator @xmath166 where @xmath377 .",
    "correspondingly , the computation of the ( reverse ) coherent information of the channel is performed as a limit , i.e. , we have@xmath378    as we will see in more detail in sec .",
    "[ apprevcoe ] , for gaussian channels the functionals @xmath379 and @xmath380 are continuous , monotonic and bounded in @xmath107 .",
    "therefore , the previous limits are finite and we can continuously extend the hashing inequality of eq .",
    "( [ hashapp ] ) to the asymptotic choi matrix @xmath96 of a gaussian channel , for which we may set @xmath381 .",
    "let us start by considering quantum systems with finite dimension @xmath72 .",
    "for any two states @xmath39 and @xmath40 such that @xmath382 , we may write the fannes - type inequality  @xcite @xmath383 where @xmath384 is a constant and @xmath385 . note that @xmath386 where @xmath387 is the distillable key of @xmath40  @xcite .",
    "therefore , we may write@xmath388 for @xmath389 , let us set @xmath390 then the previous inequality becomes@xmath391 for @xmath392 , we have @xmath393 and @xmath394 , so that @xmath395 taking the limit for large @xmath32 and optimizing over the adaptive protocols , we get @xmath396 .    when @xmath39 is a continuous variable state , we consider a trace - preserving locc @xmath397 which maps the state into a discrete variable state @xmath398 with support in a fock space with a cut - off @xmath399 .",
    "this cv - dv mapping can be realized by means of two local quantum channels ( see next section for more details ) .",
    "we can then write eq .",
    "( [ keyeq ] ) for @xmath400 . for any cut - off @xmath401 with @xmath402",
    ", we derive @xmath403 for any cut - off @xmath404 , we have @xmath405 .",
    "thus , independently from the cut - off , we may write @xmath406    the rhs  in eq .",
    "( [ pro01 ] ) can be upper - bounded using @xmath407 which derives from the monotonicity of the relative entropy of entanglement under trace - preserving loccs . for clarity",
    ", we break down this in the following steps@xmath408 in ( 1 ) we denote by @xmath409 the optimal separable state closest to @xmath400 ( in relative entropy ) ; in ( 2 ) we introduce the non - optimal separable state @xmath410 , where @xmath411 is the separable state closest to @xmath39 ( note that @xmath397 is a locc and therefore preserves the separability of the input states ) ; in ( 3 ) we exploit the fact that the relative entropy can not increase under a trace - preserving locc , property which holds in arbitrary dimension  @xcite .",
    "thus , we may write@xmath412 optimizing over the adaptive protocols we get @xmath413 where the latter quantity is defined on cvs .",
    "ideal teleportation is based on the use of an ideal epr state @xmath414 of systems @xmath55  ( for alice ) and @xmath56 ( for bob ) . for a qudit of arbitrary dimension",
    "@xmath72 , this is a multi - dimensional bell state , i.e. , a maximally entangled state of the form @xmath415 in particular , it is the usual bell state @xmath416 for a qubit . for cv systems ( @xmath344 ) , the ideal epr  source @xmath57 can be expressed as a tmsv state  @xcite @xmath106  in the limit of infinite energy @xmath417 , so that one realizes the asymptotic epr conditions @xmath418 for position and @xmath419 for momentum .    to teleport , we need to apply an ideal bell detection on the input system @xmath97 and the epr system @xmath55 ( i.e. , alice s part of the epr state ) .",
    "this detection corresponds to projecting onto a basis of bell states @xmath420 where the outcome @xmath101 takes @xmath421 values with equal probability @xmath422 .",
    "more precisely , the bell detection is a positive - operator valued measure ( povm ) with operators @xmath423 where @xmath424 is the bell state as in eq .",
    "( [ eprfinite ] ) and @xmath102 is one of @xmath421 teleportation unitaries , corresponding to generalized pauli operators ( described below ) . for cv systems ,",
    "@xmath424  is an asymptotic state and the unitaries @xmath102 are phase - space displacements with complex amplitude @xmath101  @xcite",
    ". the cv  bell detection can be realized by using the tmsv state @xmath106 in the place of the ideal epr source in eq .",
    "( [ bellpovmele ] ) ; this defines a quasi - projective measurement @xmath112 whose limit is the ideal bell detection for cvs .",
    "for any state @xmath66 of the input system @xmath97 , and any outcome @xmath101 of the bell detection , the other epr system @xmath56 ( bob s part )  is projected onto @xmath425 . once alice has communicated the value of @xmath101 to bob ( feed - forward ) , the latter applies the correction unitary @xmath426 to retrieve the original state @xmath66 on its system @xmath56 . note that this process also teleports all correlations that the input system @xmath97 may have with ancillary systems .",
    "let us characterize the set of teleportation unitaries @xmath427 for a qudit of arbitrary dimension @xmath72 .",
    "first of all , let us write @xmath101 as a multi - index @xmath428 with @xmath429 .",
    "the teleportation set is therefore composed of @xmath421 generalized pauli operators @xmath430 , where @xmath431 .",
    "these are defined by introducing unitary ( non - hermitian ) operators@xmath432 where @xmath433 is the modulo @xmath72 addition and @xmath434 so that they satisfy the generalized commutation relation@xmath435    note that any qudit unitary can be expanded in terms of these generalized pauli operators .",
    "we may construct the set of finite - dimensional displacement operators @xmath436 with @xmath437 which form the finite - dimensional weyl - heisenberg group ( or pauli group ) .",
    "for instance , for a qubit ( @xmath351 ) , we have @xmath438 and the group @xmath439 . for a cv system ( @xmath440 ) , the teleportation set is composed of infinite displacement operators , i.e. , we have @xmath441 , where @xmath442 is a phase - space displacement operator  @xcite with complex amplitude @xmath101 .",
    "this set is the infinite - dimensional weyl - heisenberg group .",
    "it is important to note that , at any dimension ( finite or infinite ) , the teleportation unitaries satisfy @xmath443 where @xmath444 is another teleportation unitary and @xmath445 is a phase .",
    "in fact , for finite @xmath72 , let us write @xmath101 and @xmath446 as multi - indices , i.e. , @xmath428 and @xmath447 . from @xmath448",
    ", we see that @xmath449 . then , for infinite @xmath72 , we know that the displacement operators satisfy @xmath450 , for any two complex amplitudes @xmath314 and @xmath451 .",
    "now , let us represent a teleportation unitary as @xmath452 it is clear that we have @xmath453 for dv systems , and @xmath454 for cv systems",
    ". therefore @xmath455 satisfies the group structure@xmath456 where @xmath457 is a product of two groups of addition modulo @xmath72 for dvs , while @xmath457 is the translation group for cvs .",
    "note that group @xmath457 is abelian .",
    "thus , the ( multi-)index of the teleportation unitaries can be taken from the group @xmath457 .      in this section ,",
    "we describe cv - to - dv and dv - to - cv mappings which are performed by means of local quantum channels ( cptp maps ) . an easy way to construct a cv - to - dv map is first applying a fock space truncation at some cut - off @xmath72 by means of a dichotomic povm@xmath458 where @xmath459 are number states .",
    "then , the good outcome @xmath460 is followed by an identity channel , while the bad outcome @xmath461 is followed by a completely depolarising channel which outputs the vacuum state . for instance , this can be implemented by a lossy channel @xmath462 with conditional transmissivity @xmath463 , where @xmath464 and @xmath465 .",
    "it is easy to check that the average quantum operation @xmath466 is a pinching  cptp map which only filters the subspace with support up to @xmath467 photons .",
    "dv - to - cv maps can be constructed using hybrid quantum teleportation  @xcite .",
    "for instance , a polarisation qubit @xmath468 can be teleported onto a single - rail qubit , which is the bosonic subspace spanned by the vacuum @xmath469 and the single - photon state @xmath470 .",
    "it is sufficient to build a hyper - entangled bell state @xmath471 and apply a discrete variable bell detection on qubits @xmath97 and @xmath472 .",
    "this teleports @xmath97  onto the bosonic mode @xmath98 , up to pauli operators ( suitably re - written in terms of the ladder operators ) . as usual",
    ", these unitaries can be undone from the output state .",
    "such procedure can be readily extended to teleport a qudit , with arbitrary dimension @xmath72 , into a @xmath72-dimensional subspace of the fock space .",
    "one has to build a suitable hyper - entangled bell state @xmath473 which maps the qudit computational basis @xmath474 into the first @xmath467 number states @xmath475 .",
    "then , we just apply a qudit bell detection on @xmath97 and @xmath472 , which teleports @xmath97 onto the bosonic mode @xmath98 , up to @xmath421  generalized pauli operators .",
    "we start by discussing how the protocol of teleportation can be modified in such a way to simulate ( certain ) quantum channels .",
    "this tool has been gradually developed in a series of papers  @xcite for the case of dv systems and the specific class of dimension - preserving channels , so that the dimensions of the input and output hilbert spaces are exactly the same . in the past , this allowed to tele - simulate the class of pauli channels  @xcite , also known as generalized depolarizing channels .",
    "after a review of these previous results , we then formulate the most general and advanced version of the teleportation - simulation argument , so that it can be applied to any quantum channel without any constraint on the dimension of the hilbert space , which may vary from the input to the output and may be finite or infinite .",
    "this allows us to tele - simulate many more dv channels , not restricted to the pauli class , and to extend tele - simulation to cv channels and even hybrid channels ( i.e. , mappings between dvs and cvs ) .",
    "the development of this tool is a preliminary step for the technique of teleportation stretching that will be discussed in detail in sec .",
    "[ app_tele ] .",
    "we will see how our advanced teleportation - simulation can be used to reduce an adaptive protocol into a much simpler block form , where all channel transmissions are replaced by choi matrices and all the adaptive loccs are collapsed into a single final locc .",
    "this is what we mean by teleportation stretching  of an adaptive protocol , for a completely generic task and in arbitrary dimension . to stress the originality of this technique",
    ", we will completely clarify its crucial differences with respect to previous literature in sec .",
    "[ prelit ] .      instead of performing the standard protocol of quantum teleportation over an epr state",
    ", we may consider an arbitrary mixed state as a resource . in this case , the effect of teleportation is not an identity map but a noisy channel from the input to the output .",
    "this kind of teleportation - simulation argument was first introduced in ref .",
    "* section  v ) for the specific case of dimension - preserving channels in finite dimension , i.e. , for the simulation of dv channels where the dimension @xmath72 of the hilbert space @xmath476 is preserved from the input to the output .",
    "this has been called the tight  case in ref .",
    "@xcite .",
    "let us discuss this procedure in more detail .",
    "consider a mixed state @xmath68 of two qudits @xmath55 and @xmath56 , both having dimension @xmath72 , i.e. , their joint hilbert space is @xmath477 .",
    "the teleportation channel  associated with the density operator @xmath478 is the dimension - preserving quantum channel @xmath479 which is given by teleporting an input @xmath72-dimensional qudit by using the resource state @xmath68 .    as depicted in the top panel of fig .",
    "[ telech ] , alice jointly measures qudit @xmath55 and input qudit @xmath97 by means of a bell detection , whose outcome @xmath480 is associated with a generalized pauli unitary @xmath102 .",
    "this detection projects bob s qudit @xmath56 onto a @xmath101-dependent state .",
    "once the outcome @xmath101  is communicated to bob , he applies the pauli correction @xmath426 to qudit @xmath481thus retrieving the final state on the output qudit @xmath98 .",
    "the average over all outcomes @xmath101 defines the teleportation channel @xmath482 as a cptp map  from the states of @xmath97 to the states of @xmath98 .",
    "only when @xmath68 is an epr state @xmath163 , the teleportation channel is an identity map or transfer operator from @xmath97 to @xmath98 .     and qudit @xmath55 of the resource state @xmath68 are subject to a bell detection ( green triangle ) with outcome @xmath101 .",
    "this is communicated to bob , who applies @xmath426 to qudit @xmath56 . on average , this defines a teleportation channel @xmath482 from @xmath97 to @xmath98 . * choi - based teleportation - simulation*. we may consider the case where the resource state @xmath68 is the choi matrix @xmath96 of another channel @xmath18 , which corresponds to sending half of an epr state @xmath163 through @xmath18 ( see the gray box ) . an important case is when",
    ", assuming @xmath483 @xmath96 , we find @xmath484 , so that a channel @xmath18 from @xmath97 to @xmath98 can be replaced by teleportation over its choi matrix @xmath63 ( see the bottom panel).,scaledwidth=60.0% ]    now let us assume that the resource state @xmath68 is achieved sending half of an epr state through another channel @xmath18@xmath485 in other words , @xmath68 corresponds to the choi matrix @xmath96 of channel @xmath18 .",
    "an important case is when @xmath18 coincides with the teleportation channel of its choi matrix , i.e.,@xmath486 which means that one can replace channel @xmath18 with teleportation over @xmath96 .",
    "this choi - based teleportation - simulation of a quantum channel is also depicted in fig .",
    "[ telech ] .    ref .",
    "* section  v ) recognized that eq .",
    "( [ eqbenn ] ) is certainly true for qudit pauli channels ( generalized depolarizing channels ) , because their choi matrices are bell - diagonal states .",
    "these channels take the form@xmath487 where @xmath488 are probabilities and @xmath102 are qudit pauli operators . using the multi - index @xmath428 ,",
    "these operators can be written as @xmath431 ( see sec .",
    "[ teleunapp ] ) .",
    "this particular case was later re - considered in ref .",
    "@xcite , where eq .",
    "( [ eqbenn ] ) was discussed as a property of mutual reproducibility between mixed states and quantum channels . in a few words , because of eq .",
    "( [ eqbenn ] ) , we may store a channel @xmath18 into its choi matrix @xmath96 ( by sending half of an epr state through the channel ) , and then we can recover the channel back by performing teleportation over @xmath96 .    at this point , a natural question to ask is the following :    _ can we generate other dv channels ( beyond pauli ones ) by using the original teleportation - simulation argument of ref .",
    "b2 ? _    the answer is _",
    "no_.    in fact , ref .",
    "@xcite showed that standard teleportation protocol ( based on bell detection and pauli corrections ) performed over an arbitrary @xmath489 state @xmath68 can only simulate  a quantum channel of the form@xmath490 where @xmath491 are the povm elements of the bell detection , @xmath492 are pauli operators and @xmath493 is the @xmath72-dimensional bell state of eq .",
    "( [ eprfinite ] ) .",
    "this is clearly a @xmath72-dimensional pauli channel , as one can easily see by comparing it with eq .",
    "( [ paulidd ] ) .",
    "the possibility to generate other dv channels relies on a stronger modification of the original teleportation protocol .",
    "previous works  @xcite have considered the use of more general detections and correction unitaries but always assuming the preservation of the input ( finite ) dimensionality .",
    "recently , ref .",
    "@xcite has also considered a generalization of the teleportation - simulation argument for dv channels , using tools from ref .",
    "we now remove all the assumptions regarding the dimension of the quantum systems which may vary through the channel , and may be finite or infinite .",
    "let us extend the teleportation - simulation argument beyond dv  pauli channels , by relaxing the dimensionality assumption and using more general correction unitaries .",
    "consider an arbitrary mixed state @xmath68 of systems @xmath55 ( for alice ) and @xmath56 ( for bob ) , where @xmath494 and @xmath495 .",
    "alice performs a bell detection on system @xmath55 and the input @xmath72-dimensional system @xmath97 .",
    "such detection has random outcome @xmath101 associated with a teleportation unitary @xmath102 .",
    "this is a pauli operator for @xmath348 and a phase - space displacement for @xmath440 .",
    "the outcome @xmath101 is communicated to bob , who applies a correction unitary @xmath496  ( generally different from @xmath426 )  to his system @xmath56 , thus retrieving the output system @xmath98 .",
    "the average over the bell outcomes defines a _ generalized _ teleportation channel @xmath497 which may be dimension - altering in the general case .",
    "note that we may also have @xmath72 and/or @xmath498 equal to infinity .",
    "in such a general scenario , we are interested to establish a criterion for the choi - based teleportation - simulation of a quantum channel , i.e. , to determine whether some channel @xmath18 can be simulated by  generalized teleportation over its choi matrix @xmath96 , so that @xmath499 see also fig .",
    "[ dimensions ] .     of a channel  @xmath18 . in general , channel",
    "@xmath18 is dimension - altering so that systems @xmath55 and @xmath56 may have hilbert spaces with different dimensions , @xmath72 and @xmath498 , respectively .",
    "an input system @xmath97 with dimension @xmath72  and system @xmath55 are subject to a bell detection ( green triangle ) with outcome @xmath101 .",
    "this outcome has an associated teleportation unitary @xmath102 which is a pauli operator for @xmath348 and a phase - displacement for @xmath440 .",
    "the classical outcome @xmath101 is communicated to bob , who applies a correction unitary @xmath496 to system @xmath56 , with output @xmath98 of dimension @xmath498 ( in general , @xmath500 ) . on average",
    ", this procedure defines a generalized teleportation channel @xmath501 from @xmath97 to @xmath98 .",
    "we are interested in those channels such that @xmath502.,scaledwidth=45.0% ]    note that , if cv systems are involved , i.e. , @xmath440 and/or @xmath503 , the mathematical description involves limits for both the choi matrix @xmath96 and the ideal bell detection . in particular , if all the systems involved are single bosonic modes , then we consider the tmsv state @xmath106 as a resource state , so that we have the channel output @xmath109 defining @xmath166 .",
    "then , we may replace the ideal bell detection with a quasi - projective measurement @xmath112 onto displaced versions of @xmath106 , so that the corrections @xmath496 are displacement operators .",
    "this construction provides an imperfect teleportation channel @xmath504 which defines an asymptotic channel @xmath501 in trace norm , i.e. , we have some @xmath501 such that @xmath505 for any input state @xmath66 .",
    "the question is whether @xmath501 reproduces the orginal channel @xmath18 or not .",
    "the crucial property that a quantum channel must possess in order to admit a choi - based teleportation - simulation is the covariance with teleportation . in arbitrary dimension ( finite or infinite )",
    ", we say that a quantum channel is teleportation - covariant  or stretchable , if for any teleportation unitary @xmath102 , we may write @xmath506 for another generally - different unitary @xmath103 ( which does not need to belong to the set of the input teleportation unitaries @xmath507 ) .",
    "we then prove the following .",
    "[ proppreli]the transmission of a system through a stretchable channel @xmath18 can be simulated by ( generalized ) teleportation over the choi matrix @xmath96 of the channel .",
    "more precisely , the property of teleportation covariance of eq .",
    "( [ stretch ] ) implies the choi - based tele - simulation @xmath502 .    *",
    "proof . *",
    "suppose that alice sends a quantum system @xmath97 through channel @xmath18 with output @xmath98 , i.e. , we have @xmath508 .",
    "we can replace @xmath97  with another input system @xmath99 by teleportation .",
    "in fact , we can prepare an ideal epr state @xmath100 of systems @xmath55 and @xmath99 , and perform a bell detection on the original input system @xmath97 and the epr system @xmath55 ( see also fig .",
    "[ stretchpic ] for a schematic representation ) .     from input system",
    "@xmath97 to output system @xmath98 .",
    "( bottom )  input system @xmath97 is perfectly teleported into the new input system @xmath99 by a teleportation circuit composed by an ideal epr state and a bell detection ( triangle ) .",
    "the outcome @xmath101 of the measurement is classically communicated to bob . since the channel is stretchable the teleportation unitary @xmath102",
    "is mapped into another output unitary @xmath103 .",
    "this is corrected by bob applying @xmath496.,scaledwidth=45.0% ]    this leads to perfect teleportation of @xmath97 onto @xmath99 , up to a random teleportation unitary , i.e. , we have @xmath509 .",
    "the unitary @xmath102 could be undone by alice before transmission . however , since @xmath18 is stretchable , @xmath102 is mapped into an output unitary @xmath103 that bob can equivalently undo at the output , i.e.,@xmath510 therefore , bob just needs to receive alice s cc about the outcome @xmath101 and correspondingly apply @xmath496 to retrieve the transmitted state , i.e. ,",
    "it is clear from fig .",
    "[ stretchpic ] that what  just realized is generalized teleportation over the choi matrix @xmath96 . the procedure is also valid in the presence of cv systems .",
    "when the input @xmath97 is a cv system , we just need to consider the cv versions for the epr state @xmath163 and the bell detection , which are rigorously defined as limits of energy - bounded operators.@xmath512    note that we may also give a group representation of the crucial property of teleportation covariance  or stretchability  specified by eq .",
    "( [ stretch ] ) . as discussed in sec .",
    "[ teleunapp ] , we may express an arbitrary teleportation unitary as @xmath513 .",
    "calling @xmath514 , we see that eq .",
    "( [ stretch ] ) implies@xmath515 so that @xmath516 and @xmath517 are generally - different unitary representations of the same ( abelian ) group @xmath457 .",
    "thus , eq .  ( [ stretch ] ) can also be written as@xmath518 for all @xmath519 , where @xmath520 .",
    "the property of stretchability  in eq .",
    "( [ stretch ] ) is certainly satisfied if the channel is covariant with respect to the weyl - heisenberg group , describing the teleportation unitaries in both finite- and infinite - dimensional hilbert spaces .",
    "this happens when the channel is dimension - preserving and we may set @xmath521 for some @xmath522 in eq .",
    "( [ stretch ] ) .",
    "equivalently , this also means that the @xmath516 and @xmath517 are exactly the same unitary representation in eq .",
    "( [ stretchggg ] ) .",
    "we call weyl - covariant  the stretchable channels having this additional property",
    ".    in finite - dimension , a weyl - covariant channel must necessarily be a pauli channel .",
    "in infinite - dimension , a weyl - covariant channel commutes with displacements which is certainly a property of the bosonic gaussian channels . a simple channel which is stretchable but not weyl - covariant is the erasure channel .",
    "this is in fact dimension - altering ( since it adds an orthogonal state to the input hilbert space ) and the output correction unitaries to be used in eq .",
    "( [ stretch ] ) have the augmented form @xmath523 .",
    "hybrid channels , mapping dvs to cvs and viceversa , can not be weyl - covariant but they may be stretchable .",
    "finally , the amplitude damping channel is an example of non - stretchable channel .",
    "see the table below for a classification .",
    "@xmath524{c|c|c } & stretchable & weyl - covariant\\\\\\hline pauli channels & yes & yes\\\\ gaussian channels & yes & yes\\\\ erasure channels & yes & no\\\\ hybrid channels & yes / no & no\\\\ amplitude damping & no & no \\end{tabular}\\ ] ]    note that , for a quantum channel in finite dimension , we may easily re - write eq .",
    "( [ stretch ] ) in terms of an equivalent condition for the choi matrix .",
    "in fact , by evaluating the equality in eq .",
    "( [ stretch ] )  on the epr  state @xmath525  and using the property that @xmath526 , one finds @xmath527 thus , a finite - dimensional channel @xmath18 is stretchable if and only if , for any teleportation unitary @xmath102 , we may write@xmath528   = 0~ , \\label{choileo}\\ ] ] for another generally - different unitary @xmath103",
    ".    there are finite - dimensional channels which satisfy conditions stronger than eq .",
    "( [ choileo ] ) . for pauli channels ,",
    "we may write @xmath529   = 0 $ ] for any @xmath101 , i.e. , the choi matrix is invariant under twirling operations restricted to the generators of the pauli group @xmath507 . for depolarising channels , we may even write @xmath530   = 0 $ ] for an arbitrary unitary @xmath531 .",
    "this means that the choi matrix of a depolarising channel is an isotropic state .      in general , we consider channels for which we may relax eq .",
    "( [ stretch ] ) into weaker conditions .",
    "for instance , we may impose eq .",
    "( [ stretch ] ) only to a specific part in the decomposition of a channel .",
    "thus , we call partly - stretchable  any channel which can be decomposed as @xmath532 where @xmath143 and @xmath144 are arbitrary channels , and @xmath142 is a stretchable channel or stretchable part  of @xmath18 .",
    "note that @xmath143 and @xmath144 may account for arbitrary decoherence within alice s and bob s labs .",
    "for instance , these extra channels may describe trusted noise in the local devices ( as is the case for trusted - noise qkd ) .",
    "the extra channels @xmath143 and @xmath144 are very important because they may also represent dv - cv mappings at the input and output of the stretchable part @xmath142 .",
    "as we discuss afterwards and in the main text , this decomposition allows us to study the amplitude damping channel , which can be expressed as in eq .",
    "( [ partly ] ) with @xmath143 and @xmath144 being dv - cv mappings and @xmath142 being a lossy channel .    more generally , we also consider weakly - stretchable  channels , which are defined as those channels for which we may write the statistical mixture@xmath533 where @xmath147 is a joint probability distribution , @xmath534 and @xmath202 are arbitrary channels , and @xmath535 are stretchable parts . these mixtures of channels are needed to describe communications with non - negligible statistical fluctuations , as is the case of atmospheric turbulence and ground - to - satellite links .",
    "this decomposition is fundamental for the study of bosonic fading channels .",
    "it is clear that partly- and weakly - stretchable channels do not directly imply @xmath502 , apart when they can be reduced to stretchable channels . also note that these weaker definitions are non - trivial as long as we exclude the identity channel from being the stretchable part .",
    "in fact , if we allow the identity , then every channel is partly - stretchable in a trivial sense , because we can always write @xmath536 . in general , for a quantum channel , there are many decompositions as in eq .",
    "( [ partly ] ) or eq  ( [ weakly ] ) , and the main problem is to find those which are optimal ( so to minimize the upper bound on the two - way capacity ) .",
    "we are now ready to present the technique of teleportation stretching .",
    "consider the adaptive protocol described in the main text , where alice ( register @xmath19 ) and bob ( register @xmath20 ) perform adaptive loccs on their registers before and after each transmission of a system ( from alice to bob ) .",
    "this procedure is repeated a number @xmath32 of times , with the output state @xmath39 approximating some target state , depending on the task of the protocol .    assuming that the channel is stretchable ( even partly or weakly ) , then the output state can be written in terms of a tensor - product of choi matrices plus a single trace - preserving locc @xmath120 . in other words ,",
    "a completely arbitrary adaptive protocol can be reduced to a much simpler block form , where the adaptive loccs are all collapsed into @xmath120 .",
    "we have the following .",
    "[ teleportation stretching][theostretch]let us consider @xmath32 uses of an adaptive protocol over a stretchable channel @xmath18 as in eq .",
    "( [ stretch ] ) .",
    "then , alice and bob s output state can be written in terms of its choi matrix @xmath96 as@xmath537 where @xmath120 is a trace - preserving locc .",
    "for a partly - stretchable channel as in eq .",
    "( [ partly ] ) , we may write@xmath538 finally , for a weakly - stretchable channel @xmath18 as defined in eq .",
    "( [ weakly ] ) , we derive @xmath539 where @xmath540 is the choi matrix of the stretchable part @xmath535 associated with the marginal probability @xmath149",
    ".    * proof . *",
    "we directly prove the more general eq .",
    "( [ eqtheo ] ) , whose specification then provides eqs .",
    "( [ eqtheo2 ] ) and  ( [ eqtheo3 ] ) .",
    "see the main text for a proof which is specifically given for eq .",
    "( [ eqtheo3 ] ) . to understand the general procedure",
    ", one can directly refer to the steps schematically depicted in figs .",
    "[ p1]-[p4 ] ( which can be easily translated into mathematical equations ) .",
    "consider a generic @xmath541-instance of the protocol , which will occur with some probability @xmath147 .",
    "assume that this occurs at the @xmath158th transmission ( between two adaptive loccs ) .",
    "as shown in fig .",
    "[ p1 ] , we decompose the channel into @xmath542 .",
    "-instance of the protocol occurring at the @xmath158th transmission .",
    "channel is decomposed as @xmath543.,scaledwidth=73.0% ]     is replaced by generalized teleportation over its choi matrix @xmath540 .",
    "green triangle is the bell detection applied to the input system @xmath544 and part of the choi matrix .",
    "the blue square is the correction unitary @xmath496 applied upon receipt of the outcome @xmath101 of the detection.,scaledwidth=75.0% ]    then , we replace the stretchable part @xmath535 by generalized teleportation over its choi matrix @xmath540 as in fig .",
    "next we treat channel @xmath201 and the bell detection as part of alice s los .",
    "similarly , we include @xmath202 and the correction unitary @xmath496 into bob s los ( see fig .",
    "the following step is stretching the choi matrix @xmath540 back in time and out of the adaptive loccs , so that the latter can be collapsed into a single trace - preserving locc ( see fig .",
    "[ p4 ] ) .     and the bell detection become part of alice s los .",
    "similarly , channel @xmath202 and the correction unitary @xmath496 are included into bob s los .",
    "the result is an equivalent extended locc which provides the same output.,scaledwidth=75.0% ]     is stretched back in time and out of the adaptive loccs , which can therefore be collapsed into a single trace - preserving locc.,scaledwidth=75.0% ]    the previous procedure is repeated iteratively for all the @xmath541-instances of the protocol , so that we extract @xmath545 copies of @xmath546 , where @xmath149 is the marginal probability of @xmath535 in the mixture of eq .",
    "( [ weakly ] ) .",
    "thus , we globally stretch  the tensor product @xmath547 out of the adaptive loccs . by averaging over all bell outcomes ( and including the initial separable",
    "register state into the loccs ) , the previous tensor product will be subject to a final trace - preserving locc @xmath120 , so that the output state @xmath39 of alice and bob can be written as in eq .",
    "( [ eqtheo ] ) .",
    "@xmath80    we conjecture that the weakest condition needed in order to reduce an adaptive protocol by teleportation stretching is our definition of weakly - stretchable channels in eq .",
    "( [ weakly ] ) .",
    "both this weak condition and the stronger one of partly - stretchable channels , given in eq .",
    "( [ partly ] ) , are such that the tool of the teleportation channel is only applied to sub - channels of a decomposition .",
    "this allows us to decompose the output into choi matrices which are not necessarily equal to the choi matrix of the original channel .      as discussed in the main text , teleportation stretching alone",
    "is not sufficient to provide a simple method for computing the two - way capacities .",
    "in fact , this tool has to be combined with our weak converse theorem and the properties of the relative entropy of entanglement ( ree ) .",
    "the reduction method discussed in our main text includes the following points :    1 .   bound the generic two - way capacity @xmath54 by means of the adaptive ree of the channel ( weak converse theorem ) @xmath548 2 .",
    "decompose the output ( teleportation stretching ) @xmath549 3 .",
    "combine eqs .",
    "( [ c11 ] ) and  ( [ c22 ] ) , and then exploit the properties of the ree to discard @xmath120 and simplify the tensor product .",
    "this also allows us to ignore both the asymptotic limit @xmath550 and the difficult optimization @xmath551 .",
    "thus , the previous points lead to@xmath552 where @xmath553 is the entanglement flux of @xmath535 .    in the following two subsections ,",
    "we provide more details for the specific cases of cv  channels ( sec .",
    "[ appbosonicstretch ] ) and dv channels ( sec .",
    "[ dvcaseapp ] ) .",
    "we then discuss a simple dimensionality bound in sec .",
    "[ appdimbb ] , and we conclude with a  detailed discussion on some of the relations with previous literature ( sec .",
    "[ prelit ] ) .",
    "for bosonic channels , the choi matrices are energy - unbounded operators to be intended as asymptotic states .",
    "in fact , the definition of the ideal cv epr state involves the construction of a suitable sequence of finite - energy states whose infinite - energy limit provides the requested epr conditions for the relevant quadratures .",
    "this is a well - known and standard procedure in cv quantum information . in particular",
    ", this is exactly how the finite - energy braunstein - kimble protocol for cv  quantum teleportation  @xcite reproduces the ideal vaidman protocol  @xcite in the limit of infinite energy . using exactly the same kind of limit and exploiting the lower semi - continuity of the relative entropy ,",
    "we can suitably extend the notion of entanglement flux and write the general upper bound of eq .",
    "( [ conub ] ) for bosonic channels .",
    "let us discuss here the entire procedure in detail . in this section ,",
    "we first describe how to handle the resource state ; then , in sec .",
    "[ cvbelldet_app ] , we also include the finite - energy approximation of the ideal cv  bell detection .",
    "the cv epr asymptotic state @xmath163 is defined as the limit of tmsv states @xmath554 where the energy @xmath376 is sent to infinite .",
    "here @xmath203 is the mean photon number of the reduced thermal state associated with each mode , labeled as @xmath55 and @xmath56 . in the fock basis ,",
    "a generic tmsv state is the pure state  @xcite@xmath555 where @xmath556 . in the phase - space , the tmsv state @xmath106",
    "is simply described by the gaussian wigner function @xmath557(x)=\\pi^{-2}\\exp\\left [   -\\frac{1}{2}x^{t}(v^{\\mu})^{-1}x\\right ] , \\label{wignertmsv}\\ ] ] where @xmath558 and @xmath559 is the covariance matrix , given by@xmath560{cc}\\mu & c\\\\ c & \\mu \\end{array } \\right )   \\oplus\\left ( \\begin{array } [ c]{cc}\\mu & -c\\\\ -c & \\mu \\end{array } \\right )   , ~~c:=\\sqrt{\\mu^{2}-\\frac{1}{4}}.\\ ] ]    it is easy to see that , for large @xmath107 , the wigner function of eq .",
    "( [ wignertmsv ] ) assumes the delta - like expression  @xcite@xmath557(x)\\rightarrow n(q_{+},p_{-})~\\delta(q_{a}-q_{b})~\\delta ( p_{a}+p_{b}),\\ ] ] where @xmath561 is a normalization factor , function of the anti - squeezed quadratures @xmath562 and @xmath563 , such that @xmath564 .",
    "thus , in exactly the same way as the dirac delta is a generalized function defined as a limit of test functions ( in the sense of distributions ) , the infinite - energy limit of tmsv states @xmath565 defines the ideal asymptotic state @xmath163 , realizing the specific epr conditions @xmath418 and @xmath419 .",
    "now assume that mode @xmath56 of a tmsv state @xmath106  is sent through a bosonic channel @xmath18 ( for simplicity of notation , we keep calling @xmath56 the resulting mode at the channel output , see fig .  [ limitchannel ] ) . after the channel",
    ", we have the imperfect  choi matrix @xmath566 then , we define the energy - unbounded choi matrix of the bosonic channel @xmath18 as the asymptotic limit@xmath567 any quantum operation or functional applied to the asymptotic operator @xmath96 is implicitly meant to be applied to the imperfect  choi matrix @xmath111 and then computed as a suitable @xmath107-limit on the output . in particular , for a stretchable bosonic channel , this means that we formally define the action of a locc as follows @xmath568   .\\ ] ] similarly , for the entanglement flux of a bosonic channel , we formally define@xmath569 where the minimization is over all sequences @xmath570 of separable states which are convergent in trace norm .",
    "assuming such definitions ( and their immediate extensions to the case of weakly - stretchable bosonic channels ) , we may write the same recipe specified by eqs .",
    "( [ c11])-([conub ] ) .    in order to show that this is indeed the case ,",
    "consider an imperfect  teleportation channel , where we use the finite - energy tmsv state @xmath106 as a resource state , i.e. , _  la _ braunstein and kimble ( see fig .  [ limitchannel ] ) . since @xmath106 is not maximally entangled , the teleportation process is not perfect .",
    "thus , even if the bosonic channel @xmath18 is stretchable ( i.e. , commutes with displacements ) , an optimized output correction unitary @xmath496 does not reproduce @xmath18 .",
    "we therefore have a generally different teleportation channel @xmath113 which is defined by averaging the input - output quantum operation over the bell outcomes .        for any ( energy - bounded )",
    "state @xmath571 whose part @xmath472 is propagated through the imperfect teleportation channel @xmath113 , we may write alice and bob s output state as @xmath572 now let us take the limit for @xmath417 . by construction , it is clear that @xmath106 becomes the ideal cv epr  source @xmath163 , so that the teleportation process becomes ideal and , therefore , the stretchable channel @xmath18 is perfectly reproduced at the output as a teleportation channel , i.e. , @xmath573 .",
    "thus , in the asymptotic limit , we may write@xmath574 which can be expressed in trace norm as @xmath575 .    by applying the stretching argument to the scheme of fig .",
    "[ limitchannel ] , we also see that alice and bob s output state @xmath576 can equivalently be written as@xmath577 where @xmath120 is a trace - preserving locc , which includes both the input preparation of @xmath571 and the teleportation process , while @xmath111 is the imperfect  choi matrix of eq .",
    "( [ imchoi ] ) . by taking the limit of @xmath417 in eq .",
    "( [ lll1 ] ) , the imperfect state @xmath576 becomes the channel output state @xmath302 according to eq .",
    "( [ limitmmmuuu ] ) .",
    "therefore , we may write@xmath578 in the same limit , we see that the imperfect source @xmath111 becomes the energy - unbounded choi matrix of the channel @xmath96 , according to the definition in eq .",
    "( [ definitionmmnn ] ) .",
    "therefore , we may _ formally _",
    "write @xmath579    the generalization of the previous reasoning is immediate . for any adaptive protocol , performed @xmath32 times over a stretchable bosonic channel @xmath18 , we may write the output state of alice s register @xmath19 and bob s register @xmath20 as@xmath580   , \\label{expr222}\\ ] ] for a suitable trace - preserving locc @xmath120 which includes the input preparations , the teleportation processes and the adaptive loccs of the original protocol .",
    "let us now compute the ree on the output state @xmath39 of eq .",
    "( [ expr222 ] ) .",
    "we may write @xmath581    &   \\overset{(2)}{\\leq}\\min_{\\{\\sigma^{\\mu}\\}}\\underset{\\mu\\rightarrow+\\infty } { \\lim\\inf}~s\\left (   \\bar{\\lambda}\\left [   ( \\rho^{\\mu})^{\\otimes n}\\right ]    &   \\overset{(3)}{\\leq}\\min_{\\{\\sigma^{\\mu}\\}}\\underset{\\mu\\rightarrow+\\infty } { \\lim\\inf}~s[(\\rho^{\\mu})^{\\otimes n}||(\\sigma^{\\mu})^{\\otimes n}]\\nonumber\\\\ &   \\overset{(4)}{=}n~\\min_{\\{\\sigma^{\\mu}\\}}\\underset{\\mu\\rightarrow+\\infty } { \\lim\\inf}~s\\left (   \\rho^{\\mu}||\\sigma^{\\mu}\\right ) \\nonumber\\\\ &   \\overset{(5)}{=}n\\phi(\\mathcal{e})~ , \\label{toexnnmm}\\ ] ] where : ( 1 )  we exploit eq .",
    "( [ expr222 ] ) and the definition of ree ; ( 2 )  we use the lower semi - continuity of the relative entropy  @xcite while introducing sequences of separable states @xmath570 that are converging in trace norm ; ( 3 )  we exploit the monotonicity of the relative entropy under trace - preserving ( locc )  maps ; ( 4 ) we use the additivity of the relative entropy over tensor - product states ; and ( 5 )  we use the definition of eq .",
    "( [ deffluxbbnn ] ) .    by using eq .",
    "( [ toexnnmm ] ) and our weak converse theorem ( valid at any dimension ) , we may then write the following upper bound for the two - way capacity of a stretchable bosonic channel@xmath582 where the latter bound comes from the choice of a specific sequence of separable states @xmath583 . here",
    "it is absolutely crucial to make a good choice for @xmath583 , otherwise the upper bound will be too large . in the case of bosonic gaussian channels",
    ", the sequence can be built using two - mode gaussian states which are separable but yet strongly - correlated ( e.g. , maximizing their quantum discord ) .",
    "details will be given in sec .",
    "[ app : fluxgauss ] .",
    "the computation itself of the relative entropy @xmath584 can then be done analytically by proving a closed formula for gaussian states ( more details will be given in sec .",
    "[ section : re ] ) .",
    "as said before , another point to consider in the cv framework is that the ideal bell detection is also energy - unbounded , corresponding to a projection onto the asymptotic epr state up to phase - space displacements @xmath442 . as we know , to deal with this , we just need to consider a finite - energy version of the measurement , defined as a quasi - projection onto displaced versions of the tmsv state @xmath106 with finite parameter @xmath107 , i.e. , a povm @xmath112 with operators @xmath585\\phi^{\\mu}[d(k)\\otimes i ] .",
    "\\label{bellfinite}\\ ] ] optically , this can be interpreted as applying a balanced beam - splitter followed by two projections , one onto a position - squeezed state and the other onto a momentum - squeezed state ( both with finite squeezing ) .",
    "the ideal cv  bell detection is reproduced by taking the limit of @xmath586 in eq .",
    "( [ bellfinite ] ) .",
    "mathematically , this limit can be rigorously taken on the output .",
    "let us replace the ideal cv bell detection with its finite - energy version in the teleportation scheme of fig .",
    "[ limitchannel ] .",
    "this approximation , together with the use of a tmsv state @xmath106 as a resource state , leads to an output teleportation channel @xmath113 which is generally different from the original one @xmath18 .",
    "thus , for any ( energy - bounded ) input state @xmath571 , we have an output state @xmath576 which is generally different from @xmath587 .",
    "however , by construction , it is trivial to see that we retrieve perfect teleportation in the limit of @xmath588 , so that @xmath589 .    from the point of view of teleportation stretching ,",
    "this means that we need to consider a @xmath107-dependent trace - preserving locc @xmath590 in eq .",
    "( [ lll1 ] ) , i.e. , we write @xmath591 which leads to @xmath592 . in other words",
    ", we may formally write@xmath593 consequently , we just need to replace @xmath120  with @xmath594 in eq .",
    "( [ expr222 ] ) and easily adapt the derivation of eq .",
    "( [ toexnnmm ] ) , so that we write @xmath595   ||\\lim_{\\mu}\\bar{\\lambda}_{\\mu}\\left [ \\sigma^{\\otimes n}\\right ]   \\right ) \\nonumber\\\\ &   \\leq\\min_{\\sigma\\in\\text{sep}}\\underset{\\mu\\rightarrow+\\infty}{\\lim\\inf } ~s\\left (   \\bar{\\lambda}_{\\mu}\\left [   ( \\rho^{\\mu})^{\\otimes n}\\right ]    &   \\leq\\min_{\\{\\sigma^{\\mu}\\}}\\underset{\\mu\\rightarrow+\\infty}{\\lim\\inf } ~s\\left (   \\bar{\\lambda}_{\\mu}\\left [   ( \\rho^{\\mu})^{\\otimes n}\\right ]    and we apply the same properties as before . the final result of eq .",
    "( [ toexnnmm ] ) clearly continues to hold true .      for dv channels , the choi matrices are energy - bounded and the ree+teleportation method briefly described in sec .",
    "[ recipeapp ] can be applied without taking any ( continuous ) limit . in this case , the reduction method can also be understood in the following heuristic way .    consider a generic key - generation protocol , described by a sequence @xmath43 of adaptive loccs , which is implemented over a stretchable channel @xmath18 in finite dimension . for large @xmath32 and for an asymptotic optimal locc @xmath596 , the output state @xmath39 will approximate a private state with optimal key rate , i.e.",
    ", the number of secret - key bits will approach the secret - key capacity of the channel @xmath597 .",
    "now , using teleportation stretching , we may write the channel output as @xmath598 for some trace - preserving locc , which contains all the adaptive loccs @xmath43 plus the teleportation operations . the optimal @xmath596 corresponds to a suboptimal locc @xmath599 applied to the choi matrices @xmath600 . in other words ,",
    "the asymptotic protocol for key distribution over @xmath18  is a specific protocol of key distillation over @xmath96 , leading to @xmath601 , where the latter is the distillable key of @xmath96 .",
    "one the other hand , it is easy to derive the opposite inequality .",
    "in fact , it is sufficient to consider alice sending epr states through the channel , so that the shared output will be @xmath600",
    ". then , there will be an optimal locc on these shared states which asymptotically reaches the distillable key @xmath602 .",
    "of course , this can be seen as a specific key distribution protocol over @xmath18 , where alice and bob do not perform adaptive loccs but just a final block locc , which leads to @xmath603 .",
    "thus , for a finite - dimensional stretchable channel , we may write@xmath604 where @xmath605 exploits the result that the distillable key of a dv state is upper bounded by its regularized ree  @xcite .",
    "the previous expression can not be written for bosonic channels , since their choi matrix @xmath63 is energy - unbounded and we do not know how to mathematically handle the distillable key @xmath602 .",
    "by contrast , we know how to deal with @xmath88 , for which we can exploit the lower semi - continuity of the relative entropy , as thoroughly explained in sec .  [ appbosonicstretch ] .    for dv partly - stretchable channels , eq .",
    "( [ sssrrr ] ) holds in a weaker form .",
    "in fact , in this case , we have the decomposition @xmath606 , and we may write the channel output as @xmath607 where @xmath608 is the choi matrix of the stretchable part @xmath142 .",
    "notice that any key - generation protocol @xmath43 over channel @xmath18 can be mapped into a reduced key - generation protocol @xmath609 over @xmath142 , by including channels @xmath143 and @xmath144 in the loccs . however , the reduced protocols @xmath609 will only be a subset of all the possible protocols that we can implement over @xmath142 .",
    "thus , assuming that @xmath142 is also a dv channel , we may write @xmath610 .    in other words , we have the following chain@xmath611 finally , in the case of dv channels which are weakly - stretchable ( and whose stretchable parts @xmath612 are also dv channels ) , we may write previous eq .",
    "( [ srsr ] ) in a statistical fashion , according to the definition in eq .",
    "( [ weakly ] ) .",
    "it is very easy to show that two - way capacities are bounded by the dimension @xmath72 of the input alphabet , i.e. , we may write@xmath613 which is however not useful for cv channels ( @xmath440 ) . to show eq .",
    "( [ alphabet ] ) , just consider that any channel is partly - stretchable in a trivial sense , meaning that we may always invoke the identity channel @xmath151 as its stretchable part .",
    "in other words , we may always decompose a channel as @xmath614 , so that we may write eq .",
    "( [ partly ] ) with@xmath615 therefore , by stretching the identity , we get @xmath616",
    "teleportation stretching allows one to reduce the most general adaptive protocol into a block protocol , where channels are replaced by tensor products of choi matrices ( not necessarily of the same original channel ) and the adaptive loccs are collapsed into a single trace - preserving locc .",
    "this is the physical content of the decompositions of eqs .",
    "( [ eqtheo3 ] ) , ( [ eqtheo2 ] ) and  ( [ eqtheo ] ) given in lemma  [ theostretch ] , which are novel in the literature . in particular ,",
    "let us stress that such decompositions were not observed , claimed or exploited in ref .",
    "* section  v ) . for clarity , let us discuss here the contents of ref .",
    "* section  v ) , which considered protocols assisted by one - way ccs , with implicit extension to the case of two - way ccs .    ref .",
    "* section  v ) showed how to connect a quantum communication ( qc ) protocol , which uses a quantum error correcting code ( qecc ) at the two ends of a finite - dimensional ( pauli ) channel @xmath18 , with an entanglement distillation ( ed ) protocol , which is implemented over mixed states @xmath68 .",
    "the connection is established by interpreting @xmath18 as the teleportation channel generated by @xmath68 by using the standard teleportation protocol ( based on bell detection and pauli corrections ) , i.e. , by setting @xmath617 .",
    "this allowed them to prove @xmath618 and , implicitly , its generalization to the two - way version @xmath619 the basic reasoning behind the proof of eq .",
    "( [ ubbennett ] ) has been reported and suitably generalized in fig .",
    "[ bennett1 ] .     to system @xmath98  by means of channel @xmath18 ( red curvy line ) . in the upper  lo , alice applies a suitable qecc @xmath620 to encode an @xmath158-qubit logical state @xmath621 into an @xmath32-qubit codeword which is sent through the channel @xmath622 . in the lower lo",
    ", bob applies a decoding operation @xmath623 , so that @xmath624 tends to the identity , and the @xmath32-use output state @xmath625 approximates @xmath626 . in the general case ,",
    "assume that the previous los are assisted by unlimited two - way ccs between alice and bob . by optimizing over all qeccs and in the limit of infinite channel uses",
    ", one defines the two - way quantum capacity @xmath47 . * * ( ii )  * * then notice that alice can use the qecc to send part of @xmath158  ebits ( see the epr  state in the gray box ) , so that alice and bob share an output state @xmath627 which approximates @xmath628 . assuming an asymptotic and optimal qecc , each ebit is reliably transmitted at the quantum capacity rate @xmath47 . * * ( iii )  * * finally , assume that the channel @xmath18 can be described by teleportation over the resource state @xmath68 .",
    "any entanglement distribution strategy through channel @xmath18 can therefore be seen as a specific protocol of entanglement distillation applied to the copies of @xmath68 .",
    "this observation leads to @xmath629 .",
    ", scaledwidth=50.0% ]    in the discussion of fig .",
    "[ bennett1 ] , we note that the proof of eq .",
    "( [ ubbennett ] ) * does not * involve or exploit any mathematical decomposition of bob s output state ( @xmath630 in fig .",
    "[ bennett1 ] ) in terms of the resource state @xmath68 . in other words , for @xmath32 uses of the channel , it does not exploit anything like@xmath631 for a suitable trace - preserving locc @xmath120 that collapses all the adaptive loccs of the original protocol .",
    "in fact , ref .",
    "* section  v ) just considers the output state @xmath625  of the  qc protocol in terms of the input logical state @xmath632 only the output state @xmath627 of the entanglement distribution protocol is ( implicitly ) connected with the copies @xmath633 , so that today we would write @xmath634 , for some entanglement distillation locc @xmath635 .",
    "it is clear that both this decomposition and that in eq .",
    "( [ decobbb ] ) are conceptually and mathematically different from our eq .",
    "( [ decoapp ] ) , where the output state of the quantum communication @xmath625 is the one which is directly decomposed in terms of the resource states @xmath633 .    in fact , our decomposition does not change the task of the protocol , i.e. , we do not switch from a qc  protocol to an ed protocol .",
    "we keep the ouput of the quantum communication @xmath625 fixed .",
    "we then change the way in which this output can be generated . instead of an adaptive qc protocol  with the logical state @xmath636 as input , we simulate the channel by teleportation over @xmath68 and then we collapse the preparation @xmath636 , the encoding / decoding maps , and the teleportation operations into a single locc , whose average provides @xmath120 .",
    "thus , we have a new input @xmath633 whose processing via @xmath120 provides the original output @xmath625 of the qc  protocol .",
    "see fig .",
    "[ reductionp ] .",
    "maintaining the task and output of the original protocol makes a crucial difference because this procedure can now be applied to any kind of adaptive protocol , not just for quantum communication , but for any other task , including key generation or even quantum metrology and quantum channel discrimination  @xcite .",
    "this aspect is also important in order to extend the procedure to more complex scenarios , in particular to the presence of quantum repeaters in arbitrary network topologies  @xcite .",
    "furthermore , recall that our formulation is also very general in terms of its applicability , i.e. , it is not just restricted to the class of pauli channels , but can be applied to all dv  and cv  channels possessing the property of teleportation covariance / stretchability in eq .",
    "( [ stretch ] ) .",
    "it is interesting to note that , in order to achieve something similar to our eq .",
    "( [ decoapp ] ) from the output state @xmath627 considered in ref .",
    "* section  v ) , we need to perform some non - trivial _ a posteriori _ manipulations .",
    "basically , we need to add an additional teleportation process to the scheme of fig .",
    "[ bennett1 ] , so that a copy of the input logical state @xmath636 is bell detected together with the @xmath97 systems of @xmath158 epr states @xmath628 .",
    "assuming that the teleportation unitaries commute with the encoding / decoding operations and the channel ( i.e. , our condition of stretchability ) , then the corrections can be done at the output by bob . in this way , we can generate @xmath625 by a teleportation applied to the bipartite state @xmath637 .",
    "finally , by collapsing all alice s preparations and los into a single lo , and all bob s los into a single lo , we may write eq .",
    "( [ decoapp ] ) .",
    "let us now discuss the second reasoning present in ref .",
    "* section  v ) which proved the inequality @xmath638 and , implicitly , its two - way version @xmath639 this reasoning has been reported and slightly adapted in fig .  [ bennett2 ] .",
    "it is clear that also the lower bound of eq .",
    "( [ lbbennett ] ) does not consider or exploit any mathematical decomposition of the finite - size output state @xmath625 of the quantum communication in terms of choi matrices .",
    "the final result of ref .",
    "* section  v ) is that , for channels satisfying the condition @xmath640 , we may simultaneously write eqs .",
    "( [ ubbennett ] ) and  ( [ lbbennett ] ) , therefore establishing@xmath641    .",
    "this is achieved by alice distributing epr states @xmath163 through the channel @xmath18 .",
    "then , assume that alice and bob apply los assisted by two - way ccs for entanglement distillation ( ed ) . optimizing over all the ed strategies in the limit of many copies , they reach @xmath642 . on top of the infinite distilled ebits , they can perform teleportation of input qubits , therefore realizing a specific protocol of quantum communication through channel @xmath18 .",
    "this establishes @xmath643 .",
    "note that teleportation must be performed as an _",
    "protocol on top of another _ asymptotic _ protocol . in fact , if teleportation is performed run - by - run , e.g. , after each distillation step , then @xmath642 may not be achievable.,scaledwidth=50.0% ]    there is an evident reason of why a finite - size decomposition of the channel output such as that in eq .",
    "( [ decoapp ] ) was not observed or exploited in ref .",
    "* section  v ) . at that time",
    ", there was no idea on how to handle and simplify the complicated locc @xmath120 .",
    "this is instead the turning point of our current method where @xmath120 is completely discarded by exploiting the properties of the ree .",
    "thus , contrarily to ref .",
    "* section  v ) , teleportation stretching specifically aims at writing and exploiting channel decompositions of the type @xmath644 , where all the adaptive loccs are collapsed .",
    "it does this for an arbitrary adaptive protocol ( i.e. , with arbitrary target state ) in arbitrary dimension , and considering even more general decompositions , such as those in lemma  [ theostretch ] .",
    "let us schematically list the advances with respect to previous literature , with the goal to avoid potential misunderstandings by other authors .",
    "* 1 ) block reduction of an arbitrary adaptive protocol .",
    "*  teleportation stretching is formulated to reduce an arbitrary adaptive protocol into a corresponding block protocol , having exactly the same task , e.g. , quantum communication , entanglement distribution or key generation .",
    "in fact , the output state is expressed in terms of choi matrices subject to a suitably - constructed locc , i.e. , it takes the mathematical expression @xmath645 , as stated in lemma  [ theostretch ] . among the various tasks ,",
    "the most important is secret - key generation , whose capacity @xmath597 is an upper bound for all the others and whose study is based on tools  @xcite introduced well after the 1996 paper  @xcite .",
    "it should be clear that the finite - size choi decomposition of the channel output @xmath646 for an arbitrary adaptive protocol represents a novel insight which is _ not _ contained in ref .",
    "* section  v ) or other papers .",
    "* 2 ) teleportation covariance . *",
    "we have fully characterized the condition that a quantum channel must satisfy in order to be simulated by quantum teleportation over its choi matrix .",
    "this condition of stretchability ( or teleportation - covariance ) is the main content of our proposition  [ proppreli ] .",
    "this is clearly _ not _ present in ref .",
    "* section  v ) , which only identified a restricted class of dv channels , called generalized depolarizing channels , which are those described by bell - diagonal choi matrices ( therefore , pauli channels ) . indeed , as shown in ref .",
    "@xcite , only pauli channels can be simulated with the tools of ref .",
    "* section  v ) .    * * 3 ) even wider families of dv channels .  * * we have also shown how much we can weaken the condition of stretchability in order to enlarge our class of channels , by also considering compositions and random mixtures .",
    "for this reason , our method can be applied to very large families ( partly- and weakly - stretchable channels ) .",
    "in particular , we can include channels , such as the amplitude damping channel , which does not fully commute  with teleportation .",
    "these important features are crucial in order to apply the technique to more general error models , such as the presence of extra decoherence in the labs and/or statistical fluctuations in the channel parameters",
    ".    * 4 ) cv systems .",
    "*  teleportation stretching is designed to work both with dv and cv channels ( even when they are composed together in a hybrid combination ) .",
    "the extension to cv systems and bosonic channels is non - trivial because we need to carefully handle the hilbert space s cut - off .",
    "furthermore , we need to introduce suitable sequences of states in order to define the asymptotic choi matrices of bosonic channels and we need to consider sequences of finite - energy measurements in order to describe the asymptotic and ideal bell detection . to make the technique effective",
    ", we also need to exploit the lower semi - continuity of the relative entropy and to extend the hashing inequality to infinite dimension .",
    "* 5 ) more complex quantum communication . *",
    "we show ( see next sections ) that teleportation stretching is a flexible technique which can be applied to other forms of quantum communication , including the two - way quantum communication and multiband quantum channels .",
    "see also refs .",
    "@xcite for recent extensions to repeater - based communication in quantum networks , quantum metrology and channel discrimination .    *",
    "6 )  applicability .",
    "*  finally , we have shown how teleportation stretching can have an effective application .",
    "in fact , the most crucial point is the connection with the ree .",
    "this ree+teleportation  method allows us to completely reduce the analysis of an adaptive protocol to the computation of a simple quantity , the one - shot ree of the channel .",
    "this method has allowed us to establish a number of two - way capacities .",
    "this is the most important insight that was missing in previous literature .    regarding the last point",
    ", one can appreciate the exploitation of the ree at increasing levels of generality and mathematical rigorousness .",
    "the most straightforward and naive intuition is combining the 1996 result @xmath647 ( suitably extended to stretchable channels )  with the fact that @xmath648 and the recent ree  upper bound @xmath649 .",
    "this leads to @xmath650 for our class of stretchable channels in finite dimension .",
    "however , this simple intuition does not allow us to study the secret - key capacity @xmath597 of these dv channels , and can not be applied to find the various two - way capacities of cv bosonic  channels .",
    "therefore , one has to explicitly apply teleportation stretching to an arbitrary key - generation protocol .",
    "this generalization allows us to derive @xmath651 for dv stretchable channels , and therefore @xmath652 , as we have shown in sec .",
    "[ dvcaseapp ] . to further extend the results and cover cv  channels , as well as dv partly - stretchable channels ( e.g. , amplitude damping )",
    ", we must define the adaptive channel s  ree , which satisfies @xmath413 .",
    "the latter is then reduced to a one - shot quantity by teleportation stretching , according to the recipe described in sec .",
    "[ recipeapp ] and assuming suitable limits for the energy - unbounded choi matrices .    the recipe of sec .",
    "[ recipeapp ] is therefore the most general and rigorous approach to be applied at any dimension .",
    "furthermore , the recipe of sec .  [ recipeapp ] is the only approach that can be extended to more complex communication scenarios , e.g. , two - way quantum communication , or beyond point - to - point settings , as shown in ref .",
    "@xcite .",
    "it is clear that teleportation stretching goes beyond the preliminary ideas and goals of ref .",
    "* section  v ) .",
    "it is also important to note the basic differences between teleportation stretching and other previous results , such as the programmable quantum gate arrays  @xcite . in our case",
    ", we do not consider a universal set of unitaries but a fixed quantum channel which commutes  with teleportation ( even partly or statistically ) .",
    "thus , instead of post - selecting the identity outcome ( occurring with probability @xmath653 for a qudit , and zero probability for a cv system ) , we can consider all the outcomes of the bell detection which are then fed - forward in the final locc .",
    "thus , our method departs from probabilistic ( i.e. , non trace - preserving ) programmable quantum processors  @xcite and their formulation in terms of port - based teleportation  @xcite . in particular , the fact that our method provides an overall trace - preserving locc is absolutely crucial for the simplification of the adaptive protocols by means of the ree .",
    "our method can be extended to more complex forms of quantum communication .",
    "in fact , our weak converse theorem can be applied to any scenario where two parties derive an output state by means of an adaptive quantum protocol .",
    "all the details of the protocol are contained in the loccs @xmath43 which are collapsed into @xmath120 by teleportation stretching and then discarded using the ree .",
    "the information about the specific communication scenario survives in the choi matrices .    consider the case where the parties may also exploit a feedback quantum channel @xmath143 , from bob to alice . in this case ,",
    "alice and bob send systems to each other by choosing between two possible channels , @xmath18 ( forward )  or @xmath143 ( backward ) , and performing adaptive locc after each single transmission ( see also fig .",
    "[ feedbackch ] ) . in general , they may agree an adaptive strategy where the feedback transmission occurs a fraction @xmath4 of the rounds .",
    "the definition of the generic two - way capacity can suitably be extended to this type of protocol .",
    "this capacity @xmath154 provides the maximum number of target bits that can be distributed per individual transmission , by using the two channels @xmath18 and @xmath143  with optimal probabilities , and assuming los assisted by unlimited two - way ccs .",
    "first of all , let us consider a fixed probability distribution @xmath4 , so that we may consider the corresponding @xmath4-dependent capacity @xmath654 .",
    "it is easy to check that this capacity must satisfy the inequality @xmath655 where the lower bound is a convex combination of the individual capacities of the two channels .",
    "this is achievable by using the channels independently , i.e. , by using adaptive loccs which are independent between the forward and backward transmissions .    .",
    "only two transmissions are shown.,scaledwidth=65.0% ]    assuming that @xmath18 and @xmath143 are both stretchable , we can stretch the protocol and find the output state@xmath656 where the tensor exponents @xmath657 and @xmath658 of the two choi matrices are always integers for suitably large @xmath32 ( it is implicitly understood that we consider suitable limits in the bosonic case ) . now , using the monotonicity of the ree under trace - preserving loccs , we can relax the locc @xmath120 .",
    "then , we use its subadditivity under tensor products . in other words , we may write@xmath659\\nonumber\\\\ &   \\leq n(1-p)e_{r}(\\rho_{\\mathcal{e}})+npe_{r}(\\rho_{\\mathcal{e}^{\\prime}})\\nonumber\\\\ &   = n(1-p)\\phi(\\mathcal{e})+np\\phi(\\mathcal{e}^{\\prime}).\\end{aligned}\\ ] ]    as previously mentioned , our weak converse theorem can be applied to any type of adaptive protocol where two parties finally share a bipartite state @xmath39 . thus , we may write@xmath660    by combining eqs .",
    "( [ bb1 ] ) and  ( [ bb2 ] ) , we can derive the following bounds for the two - way capacity @xmath661 of the two - way quantum communication@xmath662 in the case of distillable channels , we have @xmath140 and @xmath663 , so that we can write@xmath664 and the optimal distribution strategy ( value of @xmath4 ) corresponds to select the channel with the maximum capacity .    note that we may also consider a two - way quantum communication protocol where the forward and backward transmissions occur simultaneously , and correspondingly define a capacity that quantifies the maximum number of target bits which are distributed in each double communication , forward _ and _ backward ( instead of each single transmission , forward _ or _",
    "backward ) .",
    "however , this case can be considered as a double - band quantum communication and therefore it becomes a specific case of the multiband scenario studied in the next section .",
    "consider the communication scenario where alice and bob can exploit a multiband quantum channel , i.e. , a quantum channel whose single use involves the simultaneous transmission of @xmath158 distinct systems . in practice , this channel @xmath665 is represented by a set of @xmath158 independent channels or bands @xmath666 ,",
    "i.e. , it can be written as@xmath667 for instance , the bands may be bosonic gaussian channels associated with difference frequencies .    in this case",
    ", the adaptive protocol is modified in such a way that  each ( multiband ) transmission involves alice simultaneously sending @xmath158 quantum systems to bob .",
    "these @xmath158 input systems may be in a generally - entangled state , which may also involve correlations with the remaining systems in alice s register .",
    "before and after each multiband transmission , the parties perform adaptive loccs on their local registers @xmath19 and @xmath20 . the multiband protocol is therefore characterized by a locc  sequence @xmath668 after @xmath32 transmissions .    the definition of the generic two - way capacity is immediately extended to a multiband channel .",
    "this capacity quantifies the maximum number of target bits that are distributed ( in parallel ) for each multiband transmission by means of adaptive protocols .",
    "it must satisfy @xmath669 where the lower bound is the sum of the two - way capacities of the single bands @xmath670 .",
    "this lower bound is obtained by using adaptive loccs which are independent between different @xmath670 , and considering an output state of the form @xmath671 where @xmath672 is the output associated with @xmath670 .",
    "let us consider @xmath158 ideal epr states at the input of the multiband channel @xmath665 ( it is implicitly understood that we consider suitable limits in the bosonic case ) .",
    "then , we define the choi matrix of @xmath665 as@xmath673 and its entanglement flux as @xmath674 due to the subadditivity of the ree , we clearly have@xmath675 we say that a multiband channel @xmath665 is stretchable ( distillable ) if all its bands @xmath670 are stretchable ( distillable ) .    now consider an adaptive protocol performed over a stretchable multiband channel . by teleportation stretching , the output state of alice and bob can be decomposed in the following equivalent forms@xmath676 this leads to @xmath677 using our weak converse theorem , we can then write@xmath678    combining eqs .",
    "( [ broadb1 ] ) , ( [ subreebands ] ) and  ( [ broadb2 ] ) we may write the following result for the multiband capacity@xmath679 finally , if the multiband channel @xmath665 is distillable , we have @xmath680 and we find the additive result@xmath681",
    "the important feature of the gibbs - exponential formula in eq .",
    "( [ gexpression ] ) is the direct formulation in terms of the statistical moments @xmath314 and @xmath95 , also thanks to the simple matrix relation between @xmath457 and @xmath95 specified by eq .",
    "( [ gvfun2 ] ) .",
    "this is a crucial difference with respect to the implicit formulas of refs .",
    "@xcite , where the connection with the cm was expressed by leaving non - trivial symplectic or unitary transformations to be carried out .",
    "the most typical gaussian state of two modes @xmath55 and @xmath56 is a two - mode squeezed thermal state .",
    "this has zero - mean and cm  of the form@xmath695{cc}a & c\\\\ c & b \\end{array } \\right )   \\oplus\\left ( \\begin{array } [ c]{cc}a & -c\\\\ -c & b \\end{array } \\right )   ~ , \\label{vnform}\\ ] ] with arbitrary @xmath696 and @xmath384 satisfying the condition@xmath697 these bona - fide conditions can be checked using the tools in refs .",
    "@xcite adapted to our different notation . for a cm as in eq .",
    "( [ vnform ] ) , separability corresponds to @xmath698    thus , at any fixed @xmath97 and @xmath98 , the maximally - correlated but separable gaussian state is given by imposing the boundary condition @xmath699 .",
    "it is easy to check that this state contains the maximum correlations among the separable states , e.g. , as quantified by its ( unrestricted , generally non - gaussian ) quantum discord  @xcite .    for @xmath700 in eq .",
    "( [ vnform ] ) , the gaussian state is entangled .",
    "a specific case is the tmsv state @xmath106 with cm of the form@xmath560{cc}\\mu & c\\\\ c & \\mu \\end{array } \\right )   \\oplus\\left ( \\begin{array } [ c]{cc}\\mu & -c\\\\ -c & \\mu \\end{array } \\right )   ~ , \\label{epr_cma}\\ ] ] where @xmath701 and @xmath556 .",
    "as already discussed before , for @xmath702 , it describes the asymptotic cv epr  state @xmath163 , realizing the conditions @xmath418 and @xmath703 .",
    "a gaussian channel is a cptp  map which transforms gaussian states into gaussian states .",
    "single - mode gaussian channels can be greatly simplified by means of input - output unitaries .",
    "in fact , these can always be put in canonical form  @xcite whose general action on input quadratures @xmath704 is given by@xmath705 where @xmath706 and @xmath561 are diagonal matrices , @xmath206 is an environmental mode with @xmath203 mean photons , and @xmath226 is a classical gaussian variable , with zero mean and cm  @xmath707  where @xmath227 .",
    "all gaussian channels are stretchable . in fact",
    ", the effect of an ideal teleportation is the @xmath101-dependent displacement of the input  @xmath708 , which is mapped into @xmath709 .",
    "depending on the specific canonical form we have different expressions in eq .",
    "( [ genform ] ) .",
    "we have :    * the thermal - loss channel @xmath710 with transmissivity @xmath711 and @xmath203 thermal photons .",
    "this  is described by@xmath712 for @xmath212 , the channel @xmath713  is called pure - loss channel or just lossy channel . *",
    "the amplifier channel @xmath714 with gain @xmath715 and @xmath203 thermal photons ( in the main text we use the letter @xmath8 for the gain ) .",
    "this  corresponds to the transformation @xmath716 for @xmath212 , the channel @xmath717 is called quantum - limited amplifier . * the additive - noise gaussian channel @xmath718 , which simply corresponds to@xmath719 * finally , there are other secondary forms .",
    "one is the conjugate of the amplifier , which is described by @xmath720 , where @xmath721 and @xmath722 is the reflection matrix . then , other pathological forms  @xcite : the @xmath723-form , which is a ` half ' depolarising channel and corresponds to @xmath724 ; and the @xmath725-form , which is described by @xmath726 where @xmath451 is the vacuum .",
    "we now provide a simple computable formula for the relative entropy between two arbitrary gaussian states @xmath727 and @xmath728 directly in terms of their statistical moments , without the need of symplectic decompositions . because of these features",
    ", our formula supersedes any previous proposed expression , such as the implicit ones given in refs .",
    "@xcite which leave symplectic decompositions or unitary transformations to be carried out .",
    "the starting point is the use of the gibbs - exponential form for gaussian states  @xcite which is given in eq .",
    "( [ gexpression ] ) .",
    "contrary to refs .",
    "@xcite , this form is directly expressed in terms of the statistical moments , which is why we can derive the simplest formula for the relative entropy .",
    "in fact , we show the following result .",
    "[ relative entropy of gaussian states][theorelative]for two arbitrary multimode gaussian states , @xmath727 and @xmath728 , the entropic functional @xmath729 is given by@xmath730 where @xmath731 and @xmath732 as given in eq .",
    "( [ gvfun2 ] ) . as a consequence ,",
    "the von neumann entropy of a gaussian state @xmath686 is equal to@xmath733 and the relative entropy of two gaussian states @xmath727 and @xmath728 is given by@xmath734 \\nonumber\\\\ &   = -s(\\rho_{1})-\\mathrm{tr}\\left (   \\rho_{1}\\log_{2}\\rho_{2}\\right ) \\nonumber\\\\ &   = -\\sigma(v_{1},v_{1},0)+\\sigma(v_{1},v_{2},\\delta)~. \\label{relentropy}\\ ] ]    * proof .",
    "*  start with zero - mean gaussian states , which can be written as @xmath735 $ ] , where @xmath736is the gibbs - matrix and @xmath737 is the normalization factor ( with @xmath738 ) .",
    "then , replacing into the definition of @xmath174 given in eq .",
    "( [ sigma_functional ] ) , we find @xmath739 using the commutator @xmath740}\\rangle = i\\omega_{jk}$ ] and the anticommutator @xmath741 , we derive@xmath742 \\label{gmeanv}\\\\ &   = \\mathrm{tr}\\left (   v_{1}g_{2}\\right )   , \\nonumber\\end{aligned}\\ ] ] where we also exploit the fact that @xmath743 , because @xmath744 is antisymmetric and @xmath457 is symmetric ( as @xmath95 ) .",
    "let us now extend the formula to non - zero mean values ( with difference @xmath745 ) .",
    "this means to perform the replacement @xmath746 , so that@xmath747 \\\\ &   = \\mathrm{tr}\\left [   \\rho_{1}(\\hat{x}_{j}-u_{1j}+\\delta_{j})(\\hat{x}_{k}-u_{1k}+\\delta_{k})\\right ] \\\\ &   = \\mathrm{tr}\\left [   \\rho_{1}(\\hat{x}_{j}-u_{1j})(\\hat{x}_{k}-u_{1k})\\right ]   + \\delta_{j}\\delta_{k}~.\\end{aligned}\\ ] ] by replacing this expression in eq .",
    "( [ gmeanv ] ) , we get@xmath748 thus , by combining eqs .",
    "( [ prleo1 ] ) and  ( [ prleo2 ] ) , we achieve the final formula in eq .",
    "( [ functional ] ) . the other eqs .",
    "( [ entroth ] ) and  ( [ relentropy ] ) are immediate consequences .",
    "@xmath80    as discussed in ref .",
    "@xcite , the gibbs - matrix @xmath457 becomes singular for a pure state or , more generally , for a mixed state containing vacuum contributions ( i.e. , with some of the symplectic eigenvalues equal to @xmath191 ) . in this case",
    "the gibbs - exponential form must be used carefully by making a suitable limit .",
    "since @xmath174 is basis independent , we can perform the calculations in the basis in which @xmath749 , and therefore @xmath750 , is diagonal . in this basis@xmath751 where @xmath752 is the symplectic spectrum of @xmath749 , and@xmath753~.\\ ] ] now , if @xmath754 for some @xmath101 , then its contribution to the sum in eq .",
    "is either zero or infinity .",
    "here we discuss the computation of the ( reverse ) coherent information for the most important single - mode gaussian channels , i.e. , the thermal - loss channel , the amplifier channel and the additive - noise gaussian channel .",
    "compactly , their action on input quadratures is given by@xmath755 where @xmath756 is the transmission ( or gain ) , @xmath757 is the environmental mode in a thermal state with @xmath203 mean photons , and @xmath226 is a classical gaussian variable with cm  @xmath758 .",
    "the choi matrix @xmath96 of this gaussian channel @xmath759 is defined as an asymptotic limit .",
    "in fact , at the input we consider a sequence of tmsv states @xmath106 with cm as in eq .",
    "( [ epr_cma ] ) .",
    "then , at the output , we get a sequence of finite - energy gaussian states @xmath760 whose limit defines @xmath166 .",
    "the gaussian states @xmath111 have zero mean and cm@xmath761{cc}\\mu & \\gamma\\\\ \\gamma & \\beta \\end{array } \\right )   \\oplus\\left ( \\begin{array } [ c]{cc}\\mu & -\\gamma\\\\ -\\gamma & \\beta \\end{array } \\right )   ~ , \\label{cmeigtocom}\\ ] ] where we have set@xmath762    let us compute the symplectic eigenvalues of the output cm in eq .",
    "( [ cmeigtocom ] ) .",
    "we derive  @xcite @xmath763 where @xmath764 . using the formula of the von neumann entropy for gaussian states",
    "[ see eq .",
    "( [ vongauss ] ) ] and the definitions of the coherent information @xmath765 and reverse coherent information @xmath766  [ see sec .",
    "[ section : defcoh ] ] , we may write @xmath767 where function @xmath768 is given in eq .",
    "( [ hfunctaa ] ) .",
    "it is easy to see that these quantities are continuous and increasing in @xmath769 , for any fixed values of @xmath10 , @xmath203 and @xmath770 .",
    "for instance , for the lossy channel ( @xmath711 , @xmath771 ) , we simply have@xmath772 -s\\left [   \\frac{\\eta}{2}+(1-\\eta)\\mu\\right ]   , \\\\ i(a\\langle b)_{\\rho^{\\mu } }   &   = s(\\mu)-s\\left [   \\frac{\\eta}{2}+(1-\\eta ) \\mu\\right ]   . \\label{revcohfinite}\\ ] ] thus , the limit for @xmath417 in eqs .",
    "( [ coh11 ] ) and  ( [ revcoh11 ] ) is regular and finite .",
    "the asymptotic values represent the coherent and reverse coherent information of the considered gaussian channels , i.e. , we have @xmath773 and @xmath774 , as already defined in eqs .",
    "( [ icv1 ] ) and  ( [ icv2 ] ) .",
    "correspondingly , the hashing inequality can be safely extended to the limit , i.e. , from @xmath775 we may write @xmath776    for the thermal - loss channel , the best lower bound is the reverse coherent information , given by  @xcite@xmath777 where @xmath778 is the entropic function defined in eq .",
    "( [ hfunctaa ] ) .",
    "in particular , for a lossy channel ( @xmath212 ) , one has @xmath779 for the amplifier channel , the best lower bound is given by the coherent information , which is equal to  @xcite@xmath780 and becomes@xmath781 for the quantum - limited amplifier ( @xmath212 ) . the coherent information and reverse coherent information of the additive - noise gaussian channel coincide .",
    "we have  @xcite@xmath782    it is clear that @xmath59 and @xmath60 are achievable rates for qkd , just because an ebit is a particular type of secret bit .",
    "in particular , ref .",
    "@xcite proved that @xmath60 is an achievable lower bound for qkd without the need of considering entanglement distillation .",
    "in fact , @xmath60 can be computed as the asymptotic key rate of a coherent protocol where : ( i ) alice prepares finite - energy epr states @xmath783 sending @xmath99 to bob ; ( ii ) bob heterodynes each output mode @xmath56 and sends final ccs back to alice ; and ( iii ) alice measures all her modes @xmath55 by means of an optimal coherent detection that reaches the holevo bound .",
    "the achievable rate of this coherent protocol is given by a devetak - winter rate @xmath784  @xcite .",
    "because eve holds the entire purification of alice and bob s output state @xmath111 and bob s detections are rank-1 measurements ,  this rate is equal to the reverse coherent information  @xcite @xmath785 computed on alice and bob s output . then , by taking the limit of @xmath417 , one obtains @xmath786 .",
    "let us provide full details on how to compute the entanglement flux of a single - mode gaussian channel ( in canonical form ) .",
    "we discuss here the general recipe , following the approach for bosonic channels of sec .",
    "[ appbosonicstretch ] , and then we go into details of the specific channels in the next subsections . according to eq .",
    "( [ entfluxbosonic ] ) , the entanglement flux of a gaussian channel @xmath18 satisfies@xmath787 where @xmath788 is a sequence of states as in eq .",
    "( [ seqnorm ] ) with cm as in eq .",
    "( [ cmeigtocom ] ) , while @xmath583 is a suitably constructed sequence of separable gaussian states .    for each fixed @xmath107 ,",
    "we pick the separable gaussian state having cm @xmath789 as in eq .",
    "( [ cmeigtocom ] ) but with the replacement @xmath790 for the off - diagonal term . at fixed marginals",
    "@xmath107 and @xmath791 , this is the most - correlated separable gaussian state that we can build according to eqs .",
    "( [ vnform ] ) and  ( [ sepmaxcon ] ) ; it has maximum ( non - gaussian ) discord  @xcite and minimizes the relative entropy @xmath792 as long as @xmath111 is an entangled state . in the specific case where the channel @xmath18 is entanglement - breaking , then @xmath111 becomes separable and we can trivially pick @xmath793 , which gives @xmath794 .    in general ,",
    "we are left with the analytical calculation of the relative entropy @xmath584 between two gaussian states .",
    "this can be done in terms of their statistical moments according to the formula in theorem  [ theorelative ] .",
    "for @xmath795 we find regular expressions for which the limit is well - defined , i.e. , we can put @xmath796 in eq .",
    "( [ liminfaa ] ) .",
    "we provide full algebraic details below .",
    "consider a thermal - loss channel @xmath710 with transmissivity @xmath711 and thermal number @xmath203 , so that thermal noise has variance @xmath797 . for @xmath798 ,",
    "this channel is entanglement - breaking and we just have zero entanglement flux @xmath799 .",
    "for @xmath800 we compute the relative entropy @xmath801 from the cms @xmath802 and @xmath803 of the zero - mean gaussian states @xmath111 and @xmath170 . using the formula of theorem  [ theorelative ] ,",
    "we get@xmath804\\right\\ } \\nonumber\\end{aligned}\\ ] ] where @xmath805 is the contribution of the von neumann entropy , while the other two terms come from the entropic functional @xmath806 .",
    "term @xmath807 is analytical but its expression is too cumbersome to be reported here .    by expanding for large @xmath107 , we may write @xmath808   + o(\\mu^{-1})\\nonumber\\\\ s_{1 }   &   \\rightarrow h(\\bar{n})+\\log_{2}\\left [   e(1-\\eta)\\mu\\right ] + o(\\mu^{-1})\\end{aligned}\\ ] ] and@xmath809\\right\\ } \\nonumber\\\\ \\rightarrow\\log_{2}\\mu\\sqrt{\\eta}+o(\\mu^{-1})~.\\end{gathered}\\ ] ] taking the limit @xmath810 , we get@xmath811   -h(\\bar{n})~. \\label{s1app}\\ ] ]      the thermal bound in eq .",
    "( [ thermaluba ] ) is tighter than previous bounds based on the squashed entanglement , i.e. , the takeoka - guha - wilde ( tgw ) thermal bound  @xcite@xmath814   ~ , \\label{tgwthermal}\\ ] ] and its improved version  @xcite .",
    "however , @xmath815 does not generally coincide with the achievable lower - bound  @xcite given by the reverse coherent information of the channel [ see eq .",
    "( [ rcthermal ] ) ] .",
    "thus , the generic two - way capacity of the thermal - loss channel satisfies the sandwich relation @xmath816    it is easy to check that , for a lossy channel ( @xmath212 ) , the bounds in the previous eq .",
    "( [ sandaaa ] ) coincide , therefore establishing@xmath817      the result of eq .",
    "( [ lossssy ] ) sets the fundamental limit for secret - key generation , entanglement distribution and quantum communication in bosonic lossy channels . for high loss it provides the fundamental rate - loss scaling of @xmath297 bits per channel use",
    "this also coincides with the maximum discord that can be distributed to the parties in a single use of the channel .",
    "in fact , we may write the reverse coherent information of a channel as  @xcite @xmath818 , where @xmath819 is the quantum discord  @xcite of alice and bob s ( asymptotic )  choi matrix @xmath96 , while @xmath820 is the entanglement of formation between bob and eve .",
    "because a lossy channel is dilated into a beamsplitter with a vacuum environment , we have @xmath821 .",
    "thus , for a lossy channel , we simultaneously have @xmath822 and @xmath823 .",
    "these relations lead to @xmath824 where @xmath819 is the quantum discord of the ( asymptotic ) gaussian choi matrix @xmath96  @xcite .",
    "in particular , this discord can be computed as gaussian discord  @xcite .      for the sake of completeness",
    ", we provide the specific details of the computation of the relative entropy @xmath825 for the lossy channel . after some algebra ,",
    "we achieve @xmath826 -s\\left [   ( 1-\\eta)\\mu+\\frac{\\eta}{2}\\right ]   + \\frac{\\delta}{2\\ln2}~ , \\label{limitherea}\\ ] ] where@xmath827 \\\\ &   -\\frac{c+(2\\mu-1)(1-\\eta)a}{b}\\coth^{-1}\\left [   \\frac{(1-\\eta)(1 - 2\\mu ) + a}{2}\\right ]   , \\end{aligned}\\ ] ] and @xmath828}\\\\ b   &   : = \\sqrt{8\\mu+(2\\mu-1)[4\\eta+(2\\mu-1)(1-\\eta)^{2}]}\\\\ c   &   : = 2\\eta(2\\mu-1)\\left (   2\\sqrt{4\\mu^{2}-1}-1 - 2\\mu\\right ) \\\\ &   -\\eta^{2}(2\\mu-1)^{2}-(1 + 2\\mu)^{2}~.\\end{aligned}\\ ] ]    we now insert the expression of @xmath807 in eq .",
    "( [ limitherea ] ) and we take the limit for @xmath417 .",
    "this limit is defined ( i.e. , @xmath829 ) and we get@xmath830 we can show this limit step - by - step . first note that , for large @xmath831 , we have @xmath832 thus , in the limit of @xmath417 , the first two terms in the rhs of eq .",
    "( [ limitherea ] ) become@xmath833    & \\rightarrow\\log_{2}\\left (   \\mu\\sqrt{\\eta}\\right )   + o(\\mu^{-1}),\\label{lim1a}\\\\ -s\\left [   ( 1-\\eta)\\mu+\\frac{\\eta}{2}\\right ]    &   \\rightarrow-\\log_{2}[e(1-\\eta)\\mu]+o(\\mu^{-1 } ) .",
    "\\label{lim2a}\\ ] ] then , it is easy to show that , for @xmath417 , we have @xmath834   \\coth ^{-1}\\left [   -2(1-\\eta)\\mu+o(\\mu^{0})\\right ] \\nonumber\\\\ &   -\\left [   -2+o(\\mu^{-1})\\right ]   \\coth^{-1}\\left [   \\frac{1+\\eta}{1-\\eta } + o(\\mu^{-1})\\right ] \\nonumber\\\\ &   \\rightarrow2-\\ln\\eta+o(\\mu^{-1})~. \\label{lim3a}\\ ] ] in conclusion , by using eqs .",
    "( [ lim1a ] ) , ( [ lim2a ] ) and  ( [ lim3a ] ) into eq .",
    "( [ limitherea ] ) , we obtain the final result in eq .",
    "( [ limresulta ] ) .",
    "consider an amplifier channel @xmath714 with gain @xmath715 and thermal number @xmath203 , so that thermal noise has variance @xmath797 . for @xmath835",
    "this channel is entanglement breaking and therefore @xmath799 .",
    "for @xmath836 we compute the relative entropy @xmath837 from the cms @xmath838 and @xmath839 of the zero - mean gaussian states @xmath111 and @xmath170 . using theorem  [ theorelative ] and up to terms @xmath840 ,",
    "we get@xmath841 for large @xmath107 we therefore obtain@xmath842      in general , @xmath845 does not coincide with the best known lower bound which is given by the coherent information of the channel in eq .",
    "( [ cohamplifierch ] ) .",
    "thus , the two - way capacity of the amplifier channel satisfies @xmath846 it is easy to check that , for the quantum - limited amplifier ( @xmath212 ) , the previous upper and lower bounds coincide , thus determining its two - way capacity@xmath847    note that @xmath848 turns out to coincide with the unassisted quantum capacity @xmath849  @xcite . the result of eq .",
    "( [ amplimain ] ) sets the fundamental limit for secret - key generation , entanglement distribution and quantum communication with amplifiers .",
    "a trivial consequence of the formula is that infinite amplification is useless for communication since @xmath850 . for an amplifier with typical gain @xmath223 ,",
    "the maximum achievable rate for quantum communication is just @xmath224 qubit per use .          for the conjugate of the amplifier it is easy to check that this channel is always entanglement - breaking , so that it has zero flux and , therefore , zero two - way capacity @xmath860 .",
    "the @xmath723-form  @xcite , which is a ` half ' depolarising channel , is also an entanglement - breaking channel , so that @xmath861 .",
    "finally , for the pathological  @xmath725-form  @xcite , we find the trivial bound @xmath862 .",
    "it is important to remark that the two - way capacities that we computed for gaussian channels are bounded quantities , which do not diverge even if the maximum is achieved in the limit of infinite input energy ( excluding the case of a pathological canonical form ) .",
    "in fact , one may consider an alphabet of input states whose mean number of photons is capped at some finite value @xmath863 .",
    "this assumption automatically defines a hard - constrained two - way capacity @xmath864 . for a bosonic gaussian channel",
    ", @xmath864 is increasing in @xmath863  but upper - bounded by a finite value for any @xmath863 , which is given by the entanglement flux of the channel @xmath865 .",
    "( in fact , note that all the procedure of teleportation stretching still applies if we enforce an input energy constraint for the adaptive protocols . for instance",
    "the constraint can be realized by a pinching map which is then absorbed in alice s los ) . as a result ,",
    "the asymptotic limit of the unconstrained capacity @xmath866 is finite .",
    "this is clearly true for @xmath47 , @xmath46 and @xmath597 , but the situation would be different for the two - way classical capacity of the channel .",
    "another possible situation is imposing a soft constraint  on the input energy .",
    "this means to fix the average number of photons at the input to some finite value @xmath867 . in this case , it is interesting to see that our unconstrained  upper bounds remain sufficiently tight even when they are used in the presence of such kinds of energy constraints .",
    "the best way to show this is considering our main result for the lossy channel with arbitrary transmissivity @xmath10 , for which we have proven that @xmath868 even if we constrain the input to @xmath867  mean photons , it is easy to show that : ( 1 )  the unconstrained bound @xmath869 is still very tight , since it is rapidly approached from below by the reverse coherent information ; and ( 2 )  the unconstrained bound @xmath869 remains tighter than other constrained bounds based on the squashed entanglement , even when @xmath867 is of the order of a few photons",
    ".    let us start with point ( 1 ) . from eq .",
    "( [ revcohfinite ] ) , we see that the reverse coherent information associated with a lossy channel and a tmsv state is@xmath870   , \\label{revcoh22}\\ ] ] which is obtained by setting @xmath871 in eq .",
    "( [ revcohfinite ] ) and using the @xmath872-function of eq .",
    "( [ hfunctaa ] ) . in fig .",
    "[ loeppic ] , we see that @xmath873 rapidly approaches the unconstrained upper bound @xmath869 already for @xmath874 photons .",
    "( upper red line ) and the constrained lower bound @xmath873 ( lower black line ) given by the reverse coherent information in eq .",
    "( [ revcoh22 ] ) assuming @xmath875 mean photons at the input .",
    "both are plotted in terms of the distance ( km ) assuming the standard loss rate of @xmath876db / km .",
    "the constrained two - way capacity of the lossy channel is in the middle dark area .",
    "panel ( b ) as in ( a ) but with @xmath877 mean photons .",
    "we see how the unconstrained upper bound is rapidly reached already with a few photons.,scaledwidth=40.0% ]    let us now discuss point ( 2 ) .",
    "we compare the unconstrained upper bound @xmath869 with the unconstrained tgw upper bound for the lossy channel@xmath878 and its energy - constrained version @xmath879 -h\\left [   \\frac{(1-\\eta)\\bar{m}}{2}\\right ]   .\\ ] ] ( note that the latter was just a partial result  @xcite used to derive the bound in eq .",
    "( [ ktgww ] ) for @xmath880 ) .    in fig .",
    "[ tgwcomp ] we clearly see that @xmath869 not only is tighter than @xmath881 but also outperforms the constrained version @xmath882 for all input energies down to one mean photon .",
    "this is certainly true in the important regime of intermediate - long distances ( @xmath883  km ) , where dv - qkd protocols have ideal performances at one mean photon per channel use ( as discussed in section  [ maxqkdprots ] below ) . at short distances",
    "( @xmath884  km ) , energy constraints do not really have so much practical value since we can efficiently use highly - modulated cv - qkd whose number of photons is high enough to approach the asymptotic infinite - energy behavior . in general , note that cv - qkd protocols with highly - modulated gaussian states can be used at any distance .",
    "their performance is not limited by the input energy , but it is typically degraded by the overall poor efficiency of the output detection scheme and the quality of the data - processing ( reconciliation efficiency ) .",
    "( solid red line ) with respect to the unconstrained tgw bound ( dotted ) , and the constrained tgw bound for @xmath877 mean photons ( dashed - dotted ) and @xmath875 mean photons ( dashed line ) .",
    "bounds are plotted in terms of distance ( km ) assuming the standard loss rate of @xmath876db / km .",
    "note that @xmath869 remains the tighter upper bound even if we constrain the input energy down to one mean photon .",
    "this is true everywhere , except for short distances ( where the energy constraint is not so interesting since we can efficiently use highly - modulated cv - qkd).,scaledwidth=40.0% ]",
    "given a discrete - variable channel @xmath18 in @xmath72 dimension , we can easily derive its choi matrix @xmath885 from the maximally - entangled state @xmath886 where @xmath887 is the computational basis of the qudit .",
    "we write the spectral decomposition @xmath888 where @xmath889 are the eigenvalues of the choi matrix .",
    "the von neumann entropy is simply equal to the shannon entropy of the previous eigenvalues , i.e. , @xmath890    from the choi matrix we may compute the coherent and reverse coherent information of the channel .  in particular , for unital channels , these quantities coincide and are given by the simple formula in eq .",
    "( [ unitalgen ] ) , i.e. , @xmath891 to compute the entanglement flux of the channel ( upper bound ) , recall that we have@xmath892 for some suitable separable state @xmath409 .",
    "let us write its spectral decomposition@xmath893 where @xmath894 ( @xmath895 ) are the orthogonal eigenstates ( eigenvalues ) of @xmath409 .",
    "we may then write@xmath896    the separable state @xmath409 may be constructed by applying the channel @xmath897 to the input separable state@xmath898 so that we have the output@xmath899 this specific choice will be optimal in some cases and suboptimal in others .",
    "consider a qudit in arbitrary dimension @xmath72 with computational basis @xmath900  ( results can be easily specified to the case of a qubit @xmath351 ) .",
    "the erasure channel replaces an incoming qudit state @xmath66 with an orthogonal erasure state @xmath901 with some probability @xmath4 . in other words",
    ", we have the action @xmath902 the simplicity of this channel relies in the fact that the input states either are perfectly transmitted or they are lost ( while in other quantum channels , the input states are all transmitted into generally - different outputs ) .",
    "this feature allows one to apply simple reasonings such as those in ref .",
    "@xcite which determined the @xmath0 of this channel ( more precisely , the @xmath0 of the qubit erasure channel , but the extension to arbitrary @xmath72 is trivial ) .",
    "it is easy to see that this channel is stretchable .",
    "in fact , any input unitary @xmath531 applied to the state @xmath66 is mapped into an output augmented unitary @xmath903 , i.e. , we may write @xmath904 let us write the kraus decomposition of this channel@xmath905 where @xmath906 ( with @xmath684 being the @xmath489 identity ) and @xmath907 . we then compute its choi matrix @xmath908=0 $ ] , so that eq .",
    "( [ choidec ] ) is the spectral decomposition of @xmath96 over two orthogonal subspaces , where @xmath909 has eigenvalue @xmath271 , and @xmath910 is degenerate with @xmath72 eigenvalues equal to @xmath911 .",
    "therefore , it is easy to compute the von neumann entropy , which is@xmath912 to compute the entanglement flux of the channel , we consider the separable state @xmath409 in eq .",
    "( [ sepcandidato ] ) , which here becomes @xmath913   .\\ ] ] we have now all the elements to be used in eq .",
    "( [ srelcalcolo ] ) , which provides@xmath914    for the lower bound , one can easily check that the coherent and reverse coherent information of this channel are not sufficient to reach the upper bound , since we get@xmath915 where the extra term @xmath916 is the binary shannon entropy of eq .",
    "( [ binshannon ] ) .",
    "note that these quantities are achievable rates for one - way entanglement distribution but not necessarily the optimal rates .",
    "indeed it is easy to find a strategy based on one - way backward ccs which reaches @xmath917 .",
    "this follows the same reasoning of ref .",
    "@xcite .",
    "alice can send halves of epr  states to bob in large @xmath32 uses of the channel .",
    "a fraction @xmath271 will be perfectly distributed .",
    "the identification of these good cases can be done by bob performing a dichotomic povm @xmath918 on each received system and communicating to alice which instances were perfectly transmitted . at that point",
    "alice and bob possess @xmath657 epr states with @xmath919 ebits each . on average",
    "this gives a rate of @xmath917 ebits per channel use .",
    "thus , one may write @xmath920 whose combination with eq .",
    "( [ combers ] ) provides@xmath921 since the two - way quantum capacity of the erasure channel is already known  @xcite , our novel result regards the determination of its secret key capacity @xmath922 it is clear that , for qubits , we have @xmath923 .      consider a pauli channel @xmath924 acting on a qubit state @xmath66 . the kraus representation of this channel is@xmath925 where @xmath241 is a probability distribution and @xmath926 are pauli operators , with @xmath684 the identity and@xmath927{cc}0 & 1\\\\ 1 & 0 \\end{array } \\right )   , ~y:=\\left ( \\begin{array } [ c]{cc}0 & -i\\\\ i & 0 \\end{array } \\right )   , ~z:=\\left ( \\begin{array } [ c]{cc}1 & 0\\\\ 0 & -1 \\end{array } \\right )   .\\ ] ]    it is easy to check that a pauli channel is stretchable since pauli operators ( qubit teleportation unitaries ) either commute or anticommute with the other pauli operators ( kraus operators of the channel ) . for a pauli channel we can write the stronger condition @xmath928   = 0~~\\text{for any } k\\text{,}\\ ] ] i.e. , the choi matrix is invariant under twirling operations restricted to the generators of the pauli group .",
    "in fact , the choi matrix of a pauli channel is bell - diagonal , i.e. , it has spectral decomposition@xmath929 where the eigenvalues @xmath488  are the channel probabilities , and the eigenvectors @xmath930  are the four bell states@xmath931    it is clear that @xmath932 .",
    "then , using the separable state @xmath933 as in eq .",
    "( [ sepcandidato ] ) , we derive the following upper bound for the entanglement flux of this channel@xmath934 since a pauli channel is unital , its ( reverse ) coherent information is just given by @xmath935 . therefore , the two - way capacity of a pauli channel with arbitrary distribution @xmath241 must satisfy@xmath936    latter result can be made stronger by exploiting the fact that @xmath937 is bell - diagonal .",
    "for any such a state we can compute the ree by using the formula of ref .  @xcite .",
    "in fact , let us set @xmath938 , then we may write @xmath939 thus , we have the tighter upper bound@xmath940 in the following subsections , we specialize this result for the depolarising and dephasing channels .",
    "this is a pauli channel with probability distribution @xmath941 so that we have@xmath942 let us set @xmath943 then , from eq .",
    "( [ strettopauli ] ) , we derive the following bounds for the two - way capacity of the depolarising channel@xmath944 for @xmath251 , while @xmath945 otherwise .",
    "this is a pauli channel with probability distribution @xmath946 , so that we have @xmath947 it is easy to see that @xmath948 , so that eq .",
    "( [ strettopauli ] ) leads to @xmath949 which also coincides with the unassisted quantum capacity of this channel @xmath950  @xcite .",
    "let us now consider pauli channels @xmath951 in arbitrary dimension @xmath253 .",
    "these qudit channels are also called weyl channels and have kraus representation @xmath952 where @xmath238 and @xmath240 are generalized pauli operators ( see sec .",
    "[ teleunapp ] for definitions and properties ) and @xmath953 is a probability distribution for @xmath954 .",
    "clearly this channel is stretchable .",
    "its choi matrix @xmath955 is bell - diagonal with eigenvalues @xmath956 , so that we may write its von neumann entropy in terms of the shannon entropy as follows@xmath957    note that the choi matrix can also be written as@xmath958 with @xmath959 being the phase factor of eq .",
    "( [ factorpauligen ] ) . then , let us consider a separable state @xmath933 which is constructed as in eq .",
    "( [ sepcandidato ] ) .",
    "this state can be re - written as @xmath960    by applying eq .",
    "( [ srelcalcolo ] ) , we find @xmath961 where @xmath962 . since the @xmath72-dimensional pauli channel is unital , we may also write @xmath963 , so that we derive the following bounds for its two - way capacity @xmath964 which generalizes eq .",
    "( [ paulifirst ] ) to arbitrary dimension @xmath72 . in the following two sections , we consider the specific cases of the depolarising and dephasing channels in arbitrary finite dimension @xmath72 .",
    "consider a depolarising channel acting on a qudit with dimension @xmath253 .",
    "this channel can be written as@xmath965 where @xmath966 and @xmath967 .",
    "it is manifestly stretchable .",
    "its choi matrix is the isotropic state@xmath968 satisfying the twirling condition@xmath969",
    "= 0,\\ ] ] for any qudit unitary @xmath531 .",
    "the ree of an isotropic state can be evaluated exactly by using the formula in ref .",
    "thus we can exactly compute the entanglement flux of the @xmath72-dimensional depolarising channel .",
    "let us set@xmath970 then , we may write the following expression@xmath971    because the depolarising channel is unital , we may use eq .",
    "( [ tocomputerci ] ) to compute its ( reverse ) coherent information .",
    "we specifically find@xmath972",
    "thus , the two - way capacity of this channel must satisfy the bounds@xmath973 for @xmath974 , while zero otherwise .",
    "consider a generalized dephasing channel affecting a qudit in arbitrary dimension @xmath253 .",
    "this channel has kraus representation  @xcite @xmath975 where @xmath976 , @xmath240 is the generalized pauli ( phase - flip ) operator defined in eq .",
    "( [ pauli_def ] ) , and @xmath977 is the probability of @xmath115 phase flips , equal to @xmath978 this channel is clearly stretchable and its choi matrix is @xmath979   |ii\\rangle\\langle jj|.\\ ] ] by diagonalizing , we find @xmath72 non - zero eigenvalues @xmath980 , so that the von neumann entropy is just given by @xmath981 the separable state @xmath409 in eq .",
    "( [ sepcandidato ] ) turns out to be diagonal in the computational basis and takes the form@xmath982 thus , using eq .",
    "( [ srelcalcolo ] ) , we find @xmath983    since this channel is unital , from eq .",
    "( [ tocomputerci ] ) we have that its ( reverse ) coherent information is @xmath984 , so that lower and upper bounds coincide .",
    "this means that this channel is distillable and its two - way capacity is equal to @xmath985      the amplitude damping channel describes the process of energy dissipation through spontaneous emission in a two - level system .",
    "its application to an input qubit state is defined by the kraus representation@xmath986 where@xmath987 and @xmath4 is the probability of damping .",
    "this channel is clearly non - stretchable channel since we have @xmath988 and @xmath989 .",
    "therefore , there is no unitary @xmath531 able to realize @xmath990 for pauli operator @xmath238 .",
    "the amplitude damping channel is partly - stretchable .",
    "in fact , it can be decomposed as @xmath991 where @xmath280 is an identity mapping from the original qubit ( e.g. a spin ) to a single - rail qubit , which is the subspace of a bosonic mode spanned by the vacuum and the single photon states ; then , @xmath281 is a lossy channel with transmissivity @xmath282 ; finally , @xmath283 is an identity mapping from the single - rail qubit to the original qubit .",
    "note that the two mappings can be performed via perfect hybrid teleportation and the middle lossy channel preserves the @xmath223-dimensional effective hilbert space of the system .",
    "using teleportation stretching and lemma  [ theostretch ] , we may write the decomposition@xmath992 thus , our reduction method provides the upper bound@xmath993   = -\\log_{2}p.\\ ] ] we can combine the latter result with the dimensionality bound , so that we can not exceed the logarithm of the dimension of the input hilbert space ( see sec .  [ appdimbb ] ) .",
    "this leads to @xmath994    the best lower bound is given by optimizing the reverse coherent information over the input states @xmath995 for @xmath996 .",
    "in fact , we have  @xcite@xmath997 this is an achievable lower bound for entanglement distribution assisted by a final round of backward ccs .",
    "note that this is strictly higher than the @xmath998 of the channel , which is given by  @xcite@xmath999-h_{2}\\left ( up\\right )   \\}. \\label{q1damp}\\ ] ]     with probability @xmath4 .",
    "this capacity is contained in the shadowed area identified by the lower bound ( lb ) and the upper bound ( ub ) of eq .",
    "( [ c2damp ] ) .",
    "note the separation from the unassisted quantum capacity @xmath181 of the channel ( dashed).,scaledwidth=27.0% ]    thus , in total , we may write@xmath1000 which is shown in fig .",
    "[ ampdamp ] .",
    "see the next section for the derivation of a tighter upper bound which is based on the squashed entanglement .",
    "an alternative upper bound for the two - way capacity of a quantum channel is its squashed entanglement , i.e. , we may write  @xcite @xmath1001 the squashed entanglement of an arbitrary channel @xmath18 , from system @xmath55 to system @xmath56 , is defined as  @xcite@xmath1002 , \\label{sq}\\ ] ] where @xmath329 is an arbitrary input state , and @xmath959 is the global output state@xmath1003,\\ ] ] with @xmath1004 being an isometric extension of @xmath18 and @xmath1005 being an arbitrary squashing isometry .    in eq .",
    "( [ sq ] ) , the terms in the brakets are conditional von neumann entropies computed over @xmath1006 , i.e. , @xmath1007 then note that the most general input state reads@xmath1008{cc}1-\\gamma & c^{\\ast}\\\\ c & \\gamma \\end{array } \\right )   , \\ ] ] where @xmath1009 $ ] is the population of the excited state @xmath1010 , while the off - diagonal term @xmath1011 accounts for coherence .",
    "thus , the maximization in eq .",
    "( [ sq ] ) is mapped into a maximization over parameters @xmath1012 and @xmath384 .",
    "let us compute the squashed entanglement of the amplitude damping channel @xmath291 . recall that its action is described by eq .",
    "( [ damp1 ] ) with kraus operators as in eqs .",
    "( [ damp2 ] ) and  ( [ damp3 ] ) . in the computational basis @xmath1013 , the unitary dilation of @xmath291 is therefore given by the following matrix @xmath1014{cccc}1 & 0 & 0 & 0\\\\ 0 & \\sqrt{1-p } & \\sqrt{p } & \\\\ 0 & -\\sqrt{p } & \\sqrt{1-p } & 0\\\\ 0 & 0 & 0 & 1 \\end{array } \\right )   , \\ ] ] so that we may write @xmath1015 , \\label{damp4}\\ ] ] where @xmath1016 is an environmental qubit prepared in the fundamental state @xmath1017 .",
    "it is clear that eq .",
    "( [ damp4 ] ) expresses the isometric extension of the channel , i.e. , it corresponds to @xmath1018 $ ] .    as a squashing channel we consider another amplitude damping channel but with damping probability equal to @xmath191 , so that its unitary dilation is @xmath1019 . in other words , we consider the squashing isometry @xmath1020 _ { p=1/2}$ ] ( so that we are actually deriving an upper bound of the squashed entanglement of the channel ) .",
    "let us derive the global output state @xmath1006  step - by - step .",
    "the state of systems @xmath56 and @xmath1016 at the output of the dilation @xmath1021 is given by @xmath1022{cccc}1-\\gamma & \\sqrt{p}c^{\\ast } & \\sqrt{1-p}c^{\\ast } & 0\\\\ c\\sqrt{p } & p\\gamma & \\sqrt{1-p}\\sqrt{p}\\gamma & 0\\\\ c\\sqrt{1-p } & \\sqrt{1-p}\\sqrt{p}\\gamma & ( 1-p)\\gamma & 0\\\\ 0 & 0 & 0 & 0 \\end{array } \\right )   .\\end{aligned}\\ ] ] now the system @xmath1016 is sent through the squashing amplitude damping channel with probability @xmath191 . at the output of the dilation @xmath1023 we have the final output state @xmath1024@xmath1025{cccccccc}1-\\gamma & \\frac{\\sqrt{p}c^{\\ast}}{\\sqrt{2 } } & \\frac{\\sqrt{p}c^{\\ast}}{\\sqrt{2 } } & 0 & \\sqrt{1-p}c^{\\ast } & 0 & 0 & 0\\\\ \\frac{c\\sqrt{p}}{\\sqrt{2 } } & \\frac{p\\gamma}{2 } & \\frac{p\\gamma}{2 } & 0 & \\frac{\\sqrt{(1-p)p}\\gamma}{\\sqrt{2 } } & 0 & 0 & 0\\\\ \\frac{c\\sqrt{p}}{\\sqrt{2 } } & \\frac{p\\gamma}{2 } & \\frac{p\\gamma}{2 } & 0 & \\frac{\\sqrt{(1-p)p}\\gamma}{\\sqrt{2 } } & 0 & 0 & 0\\\\ 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\ c\\sqrt{1-p } & \\frac{\\sqrt{(1-p)p}\\gamma}{\\sqrt{2 } } & \\frac{\\sqrt{(1-p)p}\\gamma}{\\sqrt{2 } } & 0 & \\gamma - p\\gamma & 0 & 0 & 0\\\\ 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\ 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\ 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\end{array } \\right )   .\\ ] ]    we now proceed with the calculation of the entropies in eqs .",
    "( [ entr1 ] ) and  ( [ entr2 ] ) , which are obtained from the eigenvalues of the reduced states @xmath1026 , @xmath1027 , @xmath1028 and @xmath1029",
    ". we obtain @xmath1030{cc}1-\\frac{p\\gamma}{2 } & \\frac{\\sqrt{p}c^{\\ast}}{\\sqrt{2}}\\\\ \\frac{c\\sqrt{p}}{\\sqrt{2 } } & \\frac{p\\gamma}{2}\\end{array } \\right )   , \\ ] ] with eigenvalues@xmath1031 the eigenvalues of @xmath1026 and @xmath1027 are too complicated to be reported here but it is easy to check that , exactly as for @xmath1032 in previous eq .",
    "( [ lambda12 ] ) , their dependence on @xmath384 is just through the modulus @xmath1033 , so that we can choose @xmath384 to be real without losing generality .",
    "because @xmath384 is real , we also have that the entropic functional @xmath1034 computed over the input state @xmath66 is exactly the same as that computed over the state @xmath1035 , with @xmath240 being the phase - flip pauli operator . using the latter observation , together with the concavity of the conditional quantum entropy  @xcite ,",
    "one simply has @xmath1036 where @xmath1037 is diagonal .",
    "this means that we may reduce the maximization to diagonal input states ( @xmath1038 ) .    as a result",
    ", we may just consider @xmath1030{cc}1-\\frac{p\\gamma}{2 } & 0\\\\ 0 & \\frac{p\\gamma}{2}\\end{array } \\right )   , \\ ] ] with eigenvalues @xmath1039 and@xmath1040{cccc}\\frac{1}{2}(p-2)\\gamma+1 & 0 & 0 & 0\\\\ 0 & \\frac{p\\gamma}{2 } & \\frac{\\sqrt{(1-p)p}\\gamma}{\\sqrt{2 } } & 0\\\\ 0 & \\frac{\\sqrt{(1-p)p}\\gamma}{\\sqrt{2 } } & \\gamma - p\\gamma & 0\\\\ 0 & 0 & 0 & 0 \\end{array } \\right )   , \\ ] ] with eigenvalues@xmath1041    from the previous eigenvalues , we compute the conditional quantum entropies in eqs .",
    "( [ entr1 ] ) and  ( [ entr2 ] ) .",
    "thus , we find that the squashed entanglement of the amplitude damping channel must satisfy the bound @xmath1042 where @xmath6 is the binary shannon entropy of eq .",
    "( [ binshannon ] ) .",
    "in particular , the function @xmath1043 is concave and symmetric in @xmath1012 , so that the maximum is reached for @xmath1044 , which corresponds to a maximally mixed state at the input .",
    "this reduces eq .",
    "( [ sq1 ] ) to the simple bound @xmath1045    if we choose a squashing amplitude damping channel with generic probability of damping @xmath10 and we repeat the calculation from the beginning we obtain the following bound for the squashed entanglement @xmath1046   -h_{2}\\left [   p\\gamma ( 1-\\eta)\\right ]   -h_{2}(p\\gamma\\eta)\\right\\ }   .\\nonumber\\end{gathered}\\ ] ] the minimum of the function inside the curly bracket is for @xmath1047 , so our choice of a balanced amplitude damping channel as a squashing channel is now justified .",
    "note that the sub - optimal choice @xmath1048 corresponds to use the identity as squashing channel ; correspondingly , the right hand side of eq .",
    "( [ setting ] ) becomes half of the entanglement - assisted classical capacity of the amplitude damping channel , i.e. ,  @xcite @xmath1049   -h_{2}(p\\gamma)\\right\\ }   .\\nonumber\\end{gathered}\\ ] ]    in conclusion , combining the lower bound of eq .",
    "( [ lbampdamp ] ) and the upper bound of eq .",
    "( [ ubampdamp ] ) , we find that the two - way capacity of the amplitude damping channel is within the sandwich@xmath1050 this is shown in fig .",
    "[ dampapp ] , which also contains a comparison with the previous upper bound based on the ree .",
    "note that , for high damping ( @xmath1051 ) , the upper bound in eq .",
    "( [ c2wayampdamp ] ) provides the scaling of @xmath1052 bits per channel use , while eq .",
    "( [ reeubdamp ] ) provides the scaling of @xmath1053 bits per channel use .     with probability @xmath4",
    "this capacity is contained in the shadowed area identified by the lower bound ( lb ) and the upper bound ( ub ) of eq .",
    "( [ c2wayampdamp ] ) .",
    "we also plot the unassisted quantum capacity @xmath181 of the channel ( dashed ) , the upper bound of eq .",
    "( [ reeubdamp ] ) based on the ree ( solid ) , and the bound of ref .",
    "@xcite  ( dotted).,scaledwidth=30.0% ]",
    "we consider the state of the art in high - rate qkd , by analyzing the maximum rates which are achievable by current practical protocols in cvs and dvs .",
    "we assume the optimal asymptotic case of infinitely long keys , so that finite - size effects are negligible .",
    "we also assume ideal parameters . for cvs",
    "this means : unit detector efficiency , zero excess noise , large modulation and unit reconciliation efficiency . for dvs",
    "this means : unit detector efficiencies , zero dark count rates , zero intrinsic error , unit error correction efficiency , and no other internal loss in the devices .",
    "note that all the following results are already present in the literature or are easily derivable from those in the literature .",
    "they are given to the reader for the sake of completeness .",
    "@xmath301no - switching protocol  @xcite .",
    "this is the practical cv  protocol with the highest secret key rate .",
    "it is based on coherent states and heterodyne detection . in reverse reconciliation ( rr ) ,",
    "its maximum secret key rate over a lossy channel with transmissivity @xmath10 is equal to @xmath1054   + s\\left ( \\frac{2-\\eta}{2\\eta}\\right )   , \\label{cv1way}\\ ] ] where @xmath768 is the entropic function given in eq .",
    "( [ hfunctaa ] ) . for high loss ( @xmath12 ) , it scales as @xmath1055 , which is @xmath191 of the secret key capacity .    @xmath301switching protocol  @xcite",
    "this was the first practical cv  protocol .",
    "it is based on coherent states and homodyne detection ( with switching between the two quadratures ) . in rr",
    ", it reaches the rate @xmath1056 which is @xmath191 of the secret key capacity . for high loss",
    ", it clearly scales as the previous protocol .",
    "@xmath301cv measurement - device - independent ( mdi ) protocol  @xcite .",
    "this is based on coherent states sent to an untrusted relay implementing a cv  bell detection .",
    "alice - relay channel has transmissivity @xmath1057  and bob - relay channel has transmissivity @xmath1058 , so that the total alice - bob channel transmissivity is @xmath1059 . in the symmetric configuration with the relay",
    "perfectly in the middle ( @xmath1060 )  @xcite , it has maximum rate@xmath1061 + s\\left (   \\frac{1}{\\sqrt{\\eta}}-\\frac{1}{2}\\right )   .\\ ] ] in the asymmetric configuration ( @xmath1062 ) , it has maximum rate@xmath1063 in particular , in the most asymmetric configuration , where the relay coincides with alice ( @xmath1064 )  @xcite , we recover the one - way rate of eq .",
    "( [ cv1way ] ) .",
    "@xmath301cv  two - way protocols  @xcite . in the first main variant",
    ", bob sends coherent states to alice , who randomly displaces their amplitudes before sending them back to bob for heterodyne detection . in rr",
    "( bob as encoder ) , this protocol has maximum rate@xmath1065   + \\log_{2}\\left [   \\frac{\\eta(1+\\eta)}{e(1-\\eta ) } \\right ]   \\right\\ }   .\\ ] ] in the second main variant , the protocol runs as before except that bob s measurement is homodyne detection ( with switching between the quadratures ) . in rr",
    ", it has maximum rate  @xcite@xmath1066 it is easy to check that both the variants scale as @xmath1067 for high loss . despite the fact that two - way protocols have lower key rates than one - way protocols in a lossy channel , they are more robust when excess noise is present . in this case , one considers the security threshold  of the protocol which is defined as the maximum tolerable excess noise above which the rate becomes negative .",
    "two - way protocols have higher security thresholds than one - way protocols  @xcite .      here",
    "we consider various dv protocols .",
    "as said before , we assume the optimal asymptotic case of infinitely long keys and also ideal parameters , which here means : unit detector efficiencies , zero dark count rates , zero intrinsic error , unit error correction efficiency , and no other internal loss in the devices . under these assumptions , we consider the ideal bb84 protocol with single photon sources  @xcite , the bb84 with weak coherent pulses and decoy states  @xcite , and dv - mdi - qkd  @xcite .",
    "let us consider the bb84 protocol  @xcite assuming that alice s source generates perfect single - photon pulses .",
    "the general formula of the key rate can be found in ref .  @xcite .",
    "it reduces to the following expression@xmath1068   -\\delta ( q)\\right\\ }   , \\label{kappa}\\ ] ] where @xmath6 is the binary shannon entropy . in eq .",
    "( [ kappa ] ) , @xmath1069 is a function accounting for the leak of information from imperfect error correction , @xmath1070 is the efficiency of the classical error correction codes , @xmath181 is the total error rate ( qber ) , and @xmath1071 is the total detection rate after quantum communication ( the raw key ) . under ideal conditions of zero dark - count rates , unit efficiency detectors , perfect visibility , and perfect classical error correction @xmath1072 , one has @xmath1073 and obtains the following maximum rate @xmath1074 , setting the maximum rate for the current dv protocols .",
    "a realistic photon source is a device emitting attenuated coherent pulses . in this case",
    ", the performance of the protocol depends on an additional parameter which is the intensity of the source . in the bb84 protocol , with weak coherent pulses and decoy states  @xcite , alice",
    "randomly changes the intensity @xmath107 of the pulses , and reveals publicly their values during the final classical communication . in this way eve can not adapt her attacks during the quantum communication .",
    "the @xmath107-dependent key rate of the protocol is given by  @xcite@xmath1075   -\\delta(q^{\\mu})\\right\\ }   , \\ ] ] where @xmath1076 is the @xmath107-dependent  qber , and @xmath1077 is the ratio between the @xmath107-dependent  detection rate @xmath1078 , associated to alice sending @xmath32 photons , and the total detection rate @xmath1071 . assuming ideal conditions , one finds @xmath1079 .",
    "the optimal key rate is obtained by maximizing over the intensities , i.e. , @xmath1080 .",
    "it is easy to check that the optimum is given by @xmath1081 and the maximum key rate becomes @xmath1082 .",
    "the general expression of the key rate is given by the following expression  @xcite@xmath1083   -g_{z}~\\delta ( q_{z } ) , \\label{dv - mdi}\\ ] ] where @xmath1084 $ ] is the joint probability that both emitters ( with intensities @xmath1085 and @xmath1086 ) generate a single - photon pulse .",
    "the quantity @xmath1087 gives the gain in the @xmath240-basis ( one assumes @xmath1088 for the @xmath238-basis ) , and @xmath1089 is the error rate in the @xmath240-basis . finally , the quantity @xmath1090 describes the gain and @xmath1091 the qber , both in the @xmath240-basis . under ideal conditions , the @xmath107-dependent key rate becomes@xmath1092 where @xmath1057 and @xmath1058 are the transmissivities of alice s and bob s channels .",
    "it is easy to check that the maximum is taken for @xmath1093 , providing @xmath1094 .",
    "pirandola , s. _ et al .",
    "_ reply to ` discrete and continuous variables for measurement - device - independent quantum cryptography ' .",
    "_ nature photon . _",
    "* 9 * , 773 - 775 ( 2015 ) .",
    "see also http://arxiv.org/abs/1506.06748 ( 2015 ) .",
    "ottaviani , c. , spedalieri , g. , braunstein , s.l . & pirandola , s. continuous - variable quantum cryptography with an untrusted relay : detailed security analysis of the symmetric configuration .",
    "rev . a _ * 91 * , 022320 ( 2015 ) .    spedalieri , g. _ et al . _",
    "quantum cryptography with an ideal local relay .",
    "_ proceedings of the spie security + defence 2015 conference on quantum information science and technology _ , toulouse , france ( 21 - 24 september 2015 ) .",
    "bennett , c. h. & brassard , g. quantum cryptography : public key distribution and coin tossing",
    ".  _ proc .",
    "ieee international conf . on computers , systems , and signal processing _ , bangalore , pp .",
    "175179 ( 1984 ) ."
  ],
  "abstract_text": [
    "<S> quantum communications promises reliable transmission of quantum information , efficient distribution of entanglement and generation of completely secure keys . for all these tasks </S>",
    "<S> there is a crucial question to answer : what are their optimal rates without quantum repeaters ? </S>",
    "<S> our work solves this basic question for two remote parties connected by a quantum channel in the most relevant practical scenarios , without imposing any restriction on their classical communication , which can be unlimited and two - way . to achieve our results , </S>",
    "<S> we first extend the notion of relative entropy of entanglement from quantum states to channels , proving a general upper bound for all the two - way assisted capacities . </S>",
    "<S> then , we design a novel technique , dubbed teleportation stretching , which reduces the most general adaptive protocols for quantum or private communication to a simple block form . in this way </S>",
    "<S> , we can simplify our upper bound to a single - letter expression for many fundamental channels , establishing exact formulas for the two - way assisted capacities of bosonic lossy channels , quantum - limited amplifiers , dephasing and erasure channels in arbitrary dimension . </S>",
    "<S> in particular , we determine the fundamental rate - loss scaling which affects any quantum optical communication , e.g. , for long - distance quantum key distribution . by setting these limits </S>",
    "<S> , we also establish the most general and correct benchmarks for testing the performance of quantum repeaters .    </S>",
    "<S> quantum information  @xcite is moving towards practical implementations , gradually evolving into next - generation quantum technologies with potentially superior performances . </S>",
    "<S> the development of completely secure quantum communications  @xcite is an appealing alternative to the present and insecure classical infrastructure . </S>",
    "<S> the idea of a quantum internet  @xcite , which might lead to a world - wide architecture for quantum communication and distributed quantum information processing , is attracting huge efforts from different fields , with hybrid solutions being considered very promising  @xcite .    </S>",
    "<S> but quantum information is more fragile than its classical counterpart . </S>",
    "<S> exotic quantum features may be rapidly washed away by unwanted interactions with the environment , so that loss and noise may greatly degrade the ideal performance of quantum protocols . </S>",
    "<S> such a limitation affects any quantum communication between two remote parties and this is the reason why , at some point , we need to resort to relays , known as quantum repeaters  @xcite . </S>",
    "<S> the crucial problem is to determine the maximum performance we can reach without these devices , so that we fully understand when they are actually needed and what benchmarks they need to surpass .    </S>",
    "<S> our work solves this fundamental problem by computing the optimal rates which are achievable by repeaterless quantum communications in the most important practical scenarios . </S>",
    "<S> we consider two remote parties connected by a quantum channel who may exploit unlimited two - way classical communication ( cc ) and adaptive local operations ( los ) , briefly called adaptive loccs . in this general scenario and </S>",
    "<S> considering the most fundamental channels , we determine the two - way capacities for transmitting quantum information ( @xmath0 ) , distilling entanglement ( @xmath1 ) and distributing secret keys ( @xmath2 ) .    to achieve our results we suitably combine the relative entropy of entanglement ( ree )  @xcite with quantum teleportation  @xcite in a novel reduction method , which completely simplifies any quantum protocol based on adaptive loccs . </S>",
    "<S> the first step is to show that the optimal rate of an adaptive protocol is upperbounded by a suitable definition of channel s ree . </S>",
    "<S> this result extends the ree upper bound of ref .  </S>",
    "<S> @xcite from quantum states to channels . </S>",
    "<S> the second step is the application of a novel technique that we call teleportation stretching . for any quantum channel which suitably commutes with teleportation </S>",
    "<S> , we can decompose the output into a tensor product of choi matrices  @xcite ; this allows us to discard the adaptive loccs by using the properties of the ree .    </S>",
    "<S> what is left is a remarkably simple result . </S>",
    "<S> in fact , our general upper bound reduces to a single - letter expression , corresponding to the ree of the channel s choi matrix . for simplicity </S>",
    "<S> , we dub entanglement flux  this latter quantity , since it represents the amount of entanglement which is distributed by a channel when it is fed by half of a maximally entangled state . </S>",
    "<S> thanks to the entanglement flux , we can upperbound the two - way capacities of bosonic gaussian channels  @xcite , pauli channels , erasure channels and amplitude damping channels  @xcite .    by showing coincidence with suitable lower bounds </S>",
    "<S> we then prove strikingly simple formulas for the two - way quantum capacity @xmath0 ( equal  to @xmath1 ) and the secret - key capacity @xmath2 of several channels : for the erasure channel we show that @xmath3 where @xmath4 is the erasure probability ; for the dephasing channel we show that @xmath5 , where @xmath6 is the binary shannon entropy and @xmath4 is the dephasing probability ( we also extend these results to arbitrary finite dimension ) . </S>",
    "<S> then , for a quantum - limited amplifier , we show that @xmath7 $ ] where @xmath8 is the gain . </S>",
    "<S> finally , for the lossy channel , we show that @xmath9 where @xmath10 is the transmissivity .    </S>",
    "<S> note that only the @xmath0 of the erasure channel was previously known  @xcite . </S>",
    "<S> it took almost @xmath11 years to find the other two - way capacities , which should give a clear idea of the novelty of our reduction method . </S>",
    "<S> furthermore , the secret - key capacity  of the lossy channel determines the maximum rate achievable in quantum key distribution ( qkd ) . at high loss @xmath12 </S>",
    "<S> we find the optimal rate - loss scaling of @xmath13 secret bits per channel use . </S>",
    "<S> this result completely characterizes the fundamental rate - loss law which restricts secure quantum optical communications , closing a long - standing open investigation , with a series of preliminary results achieved in the last @xmath14 years .    </S>",
    "<S> in fact , the exploration of these optical limits started in 2003/4 , when refs .  </S>",
    "<S> @xcite defined the notion of one - way private capacity and the high - rate experiment  @xcite introduced the reverse reconciliation . </S>",
    "<S> these ideas were merged in 2009 with the introduction of the reverse coherent information  @xcite and the computation of the lower bound @xmath15 for the lossy channel  @xcite . later in 2014 , ref .  </S>",
    "<S> @xcite derived the first ( non - tight ) upper bound @xmath16 , exploiting the fact that the squashed entanglement  @xcite bounds the distillable key rate of a quantum state  @xcite , a result with a classical counterpart  @xcite that was previously used by ref .  </S>",
    "<S> @xcite . </S>",
    "<S> finally , our approach with ree and teleportation shows here that @xmath17 , thus closing the gap and establishing the fundamental rate - loss scaling that only quantum repeaters can surpass . </S>"
  ]
}