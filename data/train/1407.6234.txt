{
  "article_text": [
    "let @xmath1 be an order in a ( semi-)simple finitely generated algebra @xmath2 over @xmath0 . by definition , this means that @xmath1 is a subring of @xmath2 and that , additively , it is a free abelian group generated by a basis of @xmath2 over @xmath0 .",
    "the determination of the unit group @xmath3 of such an order is in general a difficult task , both from the theoretical and computational point of view , and many questions remain open , as regards structural results and general algorithms .",
    "we refer the reader to ernst kleinert s survey @xcite for a general account on this topic .",
    "in this paper we propose a method , meant to be very general , to compute a presentation of @xmath3 .",
    "this method is based on a combination of vorono theory of perfect quadratic forms and bass - serre theory of graphs of groups .",
    "the latter is well - known to provide a very versatile tool for computing a presentation of a group @xmath4 acting on a connected graph @xmath5 . in such a situation , a good knowledge of the quotient graph @xmath6 yields virtually all the information on @xmath7 . to be more precise",
    ", one has the following fundamental exact sequence ( ( * ? ? ?",
    "* theorem 3.6 ) ) @xmath8    where @xmath9 ( resp .",
    "@xmath10 ) denotes the fundamental group of the graph @xmath5 ( resp . of the quotient graph of groups @xmath11 ) , see _ loc .",
    "_ for precise definitions . from this exact sequence ,",
    "one can derive , at least in principle , a presentation of the group @xmath7 .",
    "of course , to be of any practical interest , the exact sequence ( [ bs ] ) must be applied in a context where the fundamental groups @xmath9 and @xmath10 are computable as easily as possible , without too much prior knowledge of the structure of @xmath7 .",
    "the graph on which we will let @xmath12 act is built as a neighbouring graph of `` perfect forms '' , where we use a suitable refinement of the original notion of perfect forms in @xcite .",
    "the idea of using bass - serre theory in this context dates back to soul s paper @xcite , where this technique was applied to derive the explicit structure of @xmath13 as an amalgamated product of small finite groups .",
    "later , opgenorth @xcite applied the same kind of ideas to compute the integral normalizer @xmath4 of a finite unimodular group , where he only used the surjectivity of the map @xmath14 , which already allows for the computation of a generating set of @xmath7 .",
    "opgenorth s methods have been applied in @xcite to compute generators for unit groups @xmath15 of integral group rings for small groups @xmath16 .",
    "yasaki @xcite used similar ideas , combined with macbeath theorem @xcite to obtain a presentation of some bianchi groups . here , we propose to use the full strength of ( [ bs ] ) to actually get a presentation of @xmath7 .",
    "from the exact sequence ( [ bs ] ) , we see that this amounts essentially to computing the fundamental group of the neighbouring graph of perfect forms , which is non - trivial in general ( the graph is not a tree ) .",
    "there are several ways to do this .",
    "we choose to view the neighboring relation on perfect forms not only as a graph but as the @xmath17-skeleton of a cw - complex ( the well - rounded retract @xmath18 , see section [ wr ] ) . for groups acting on such complexes ,",
    "there is a slightly refined version of bass - serre theory , due to k .- s .",
    "brown ( see @xcite ) , which allows one to obtain a presentation of the group which involves only the @xmath19-skeleton of @xmath18 . beside the geometry of this complex , our algorithm only involves the computation of the stabilizers of some vertices or edges as well as `` side - pairing '' transformations .",
    "all these computations are performed using the plesken - souvignier algorithm , as implemented in magma @xcite . in particular",
    ", they essentially reduce to isometry testing of lattices and do not require any a priori knowledge of @xmath3 .    for sake of simplicity",
    ", we chose to develop the theory for simple algebras over @xmath0 .",
    "the case of semisimple algebras requires only slight modifications .    in some special cases , _",
    "e.g. _ bianchi groups or units of quaternion algebras , there are well - known methods based on an action of the relevant group on some _ hyperbolic space _ ( see _ e.g. _ @xcite ) for computing presentations .",
    "our method applies in these cases too , and should be compared to the aforementioned ones , from which they differ essentially in that we use an action on a _",
    "euclidean space_.    the paper is structured as follows : in sections 2 and 3 , we define a certain space of `` quadratic forms '' acted on by the unit group @xmath12 we want to study , and review some rather classical material about vorono s algorithm and the _ `` well - rounded retract '' _ in this context . in section 4 we explain how to use bass - serre theory to obtain a presentation of @xmath7 .",
    "we also show in section 5 how the previous idea can be used to solve the word problem in @xmath7 . in section 6 ,",
    "a selection of examples of applications of our method is presented .",
    "the final section provides an outline of the implementation of the algorithm .",
    "let @xmath20 be a finitely generated simple algebra over @xmath0 , where @xmath21 is a skew field with center @xmath22 and @xmath23 denotes the set of @xmath24-matrices .",
    "let @xmath25 be the simple left @xmath2-module .",
    "then @xmath26 and we view @xmath27 as a right @xmath21-module .",
    "let @xmath1 be an order in @xmath2 , and @xmath3 its group of units .",
    "we fix some left @xmath28-lattice @xmath29 in @xmath27 and let @xmath30 .",
    "then @xmath31 is an order in @xmath21 and @xmath29 is a right @xmath31-lattice .",
    "put @xmath32 if @xmath31 is a maximal order , then also @xmath33 is maximal , but for arbitrary orders @xmath28 in division algebras @xmath34 , one may always choose @xmath35 to achieve @xmath36 and @xmath37 . in general @xmath38",
    "is of finite index and also its unit group @xmath39 has finite index in @xmath40 as the vorono algorithm is designed to work with endomorphism rings of lattices , it is more efficient to compute @xmath41 first and retrieve @xmath3 by orbit stabiliser routines",
    ". nevertheless we try to develop the theory , as much as possible , without the assumption that @xmath1 is the endomorphism ring of a lattice .",
    "as explained in the introduction , we want to let the group @xmath3 act on a space of `` forms '' associated to the algebra @xmath2 . to that end",
    ", we first extend the scalars to @xmath42 , and obtain a semi - simple real algebra @xmath43    let @xmath44 denote the degree of @xmath21 , so @xmath45 , and let @xmath46 then @xmath47    and @xmath48 the `` canonical '' involution @xmath49 ( depending on the choice of this isomorphism ) is defined on any simple summand of @xmath50 to be transposition for @xmath51 , transposition and complex ( respectively quaternionic ) conjugation for @xmath52 and @xmath53 . the resulting involution on @xmath54 is again denoted by @xmath49 . as usual it defines a mapping @xmath55 by applying @xmath49 to the entries and then transposing the @xmath56-matrices .",
    "in particular this defines an involution @xmath57 on @xmath58 .",
    "note that , in general , this involution will not fix @xmath59 .",
    "] @xmath60 is the @xmath42-linear subspace of symmetric elements of @xmath61 .",
    "it supports the positive definite inner product @xmath62 where @xmath63 is the reduced trace of the semi - simple @xmath42-algebra @xmath64 .",
    "each element of @xmath65 can be identified , via ( [ iso ] ) , with a tuple @xmath66 of symmetric ( resp hermitian ) matrices .",
    "then , one can define the open real cone @xmath67 of positive elements in @xmath65 as @xmath68    the closure of @xmath69 in @xmath65 is denoted by @xmath70 .",
    "recall that @xmath71 is the simple left @xmath2-module .",
    "any @xmath72 defines a quadratic form on @xmath73 by @xmath74 \\coloneqq    \\langle f , x x^{\\dagger } \\rangle \\in { \\mathbb{r}}\\mbox { for all } x\\in v_{{\\mathbb{r } } } .\\ ] ] this quadratic form is positive definite ( resp .",
    "positive semidefinite ) if and only if @xmath75 ( resp .",
    "@xmath76 ) .",
    "the group @xmath77 acts on @xmath78 by @xmath79 where we embed @xmath2 into @xmath80 to define the multiplication .",
    "this action preserves the cone @xmath67 .      as before we choose a left @xmath28-lattice @xmath29 in the simple @xmath2-module @xmath81 and put @xmath82 ( where @xmath30 ) .",
    "then @xmath33 is an order in @xmath2 that contains @xmath28 of finite index .",
    "the @xmath29-minimum of a form @xmath83 is defined as @xmath84\\ ] ] and the set of @xmath29-minimal vectors of @xmath85 as @xmath86 = \\min\\nolimits _ { l}(f ) \\right\\}.\\ ] ] the @xmath29-vorono domain of @xmath85 ( or simply vorono domain of @xmath85 , if there is no ambiguity on the underlying lattice @xmath29 ) is defined as @xmath87 the closed convex hull of the rays @xmath88 as @xmath89 ranges over @xmath90 .",
    "the vorono polyhedron @xmath91 is defined as the closed convex hull of the rays @xmath88 as @xmath89 ranges over @xmath27 .",
    "a form @xmath75 is @xmath29-perfect ( or simply perfect if there is no ambiguity on the underlying lattice ) if one the following equivalent conditions holds    1 .",
    "the forms @xmath92 , where @xmath89 ranges over @xmath90 , span the whole space @xmath65 .",
    "the @xmath29-vorono domain of @xmath85 has non - empty interior .",
    "the vorono domain @xmath93 of a perfect form @xmath94 is thus an @xmath95-dimensional polyhedral cone in the euclidean space @xmath65 , where @xmath96 + r - s\\right)$ ] is the dimension of @xmath65 .",
    "it has finitely many facets , i.e. codimension @xmath17 faces .",
    "to each facet @xmath97 one associates a _ direction _",
    "@xmath98 , that is a normal facet vector , pointing towards the interior of @xmath93 . in other words , @xmath99 is a direction of @xmath93 if :    * @xmath100 for all @xmath101 , * the forms @xmath92 , as @xmath89 ranges over the set of minimal vectors of @xmath29 such that @xmath102 , generate a hyperplane of @xmath65 .",
    "the following lemma is at the core of vorono theory :    [ deadend ] let @xmath85 be a perfect form @xmath94 , and @xmath98 a direction of its vorono domain .",
    "then there exists a well - defined positive real number @xmath103 such that @xmath104 is perfect , and the vorono domains of @xmath85 and @xmath104 share a common facet .",
    "this follows from ( * ? ? ?",
    "* proposition 1.8 ) and its proof .",
    "in particular , the real number @xmath103 can be defined as @xmath105 the only thing to check is that @xmath106 , which amounts to proving that @xmath107 ( see ( * ? ? ? * proposition 13.1.8 ) or the discussion following ( * ? ? ?",
    "* proposition 1.8 ) ) . assume by way of contradiction that @xmath98 is positive",
    ". then its kernel ( the set of @xmath108 such that @xmath109 ) coincides with its radical ( the set of @xmath108 such that @xmath110=0 $ ] ) , and contains the set @xmath111 of minimal vectors @xmath112 whose image @xmath92 in @xmath65 generate the facet @xmath97 corresponding to @xmath98 . so these vectors span a @xmath21-subspace of dimension at most @xmath113 of @xmath114 , since otherwise @xmath98 would be zero , which means that there exists @xmath115 such that @xmath116 this implies , in particular , that @xmath117 is at least @xmath19 ( there is at least one element in the set of minimal vectors belonging to this facet ) . finally , the matrices @xmath92 , @xmath118 , generate a subset of dimension at most @xmath119 of @xmath65 : indeed each of the @xmath117 columns of @xmath120 lies in the hyperplane determined by ( [ hyper ] ) .",
    "this yields a contradiction since @xmath121 .    with the notation above , the form @xmath104 is called the _ neighbour _ of @xmath85 in the direction @xmath98 .      roughly speaking , vorono theory , or its variants",
    ", says that the vorono polyhedron @xmath91 may be tiled by the cones @xmath93 as @xmath85 ranges over the set of _ perfect _ forms ( see below for a more precise statement ) .",
    "there is also a dual formulation , in terms of minimal classes , which will provide the graph on which to apply bass - serre theory .",
    "[ vt ] the @xmath29-vorono domains of perfect forms constitute a locally finite exact tessellation of @xmath122 , that is :    1 .",
    "@xmath123 , 2 .",
    "for any two perfect forms @xmath85 and",
    "@xmath124 one has @xmath125 if and only if @xmath126 for some @xmath127 , 3 .   [ neighb ] each facet of the vorono domain @xmath128 of a perfect form @xmath85 is a common facet of exactly two vorono domains @xmath128 and @xmath129 of perfect forms @xmath85 and @xmath124 , 4 .   [ facets ]",
    "the vorono domain of a perfect form @xmath85 intersects only finitely many vorono domains of perfect forms .",
    "moreover this tessellation is finite up to the action of @xmath3 , in the following sense :",
    "there are finitely many @xmath3-inequivalent perfect forms of minimum @xmath17 .",
    "the proof of the first four assertions is a direct application of ( * ? ? ?",
    "* theorem 1.9 ) ( with the terminology used there , one has to check that the image of @xmath29 in @xmath73 is a discrete admissible set , which is straightforward ) .",
    "the assertion regarding finiteness can be established using mahler s compactness theorem and standard arguments from reduction theory .",
    "a quick alternative proof can be derived from results of ash ( @xcite ) as follows : first , since @xmath130 $ ] is finite , it is enough to prove that there are finitely many @xmath131-inequivalent forms .",
    "now the set @xmath132 of @xmath29-perfect forms of minimum @xmath17 is clearly a discrete and closed subset of @xmath133 .",
    "moreover , it is contained in the set of well - rounded forms ( see next section ) , whose quotient modulo @xmath131 is compact ( see @xcite main theorem , section 2 ) .",
    "the conclusion follows .",
    "the radical @xmath134 of a form @xmath76 is the set of @xmath108 such that @xmath135=0 $ ] .",
    "we say that the radical of @xmath85 is defined over @xmath21 if there exists a @xmath21-subspace @xmath18 of @xmath27 such that @xmath136 .",
    "the rational closure @xmath137 of @xmath67 is the set of forms in @xmath70 , the radical of which is defined over @xmath21 .",
    "the following corollary is a straightforward generalization of ( * ? ? ?",
    "* proposition 36 ) which was obtained under the restriction @xmath138 .",
    "our proof is slightly shorter , since the most difficult part ( the fact that @xmath67 is contained in @xmath91 ) is now a simple consequence of theorem [ vt ] .",
    "[ tesse ] the vorono polyhedron @xmath91 coincides with the rational closure of @xmath67 .",
    "the vorono tessellation takes the final form @xmath139    the inclusions @xmath140 are clear ( the first inclusion is a consequence of the previous theorem and the second is obvious from the definitions of @xmath91 and @xmath128 ) .",
    "it is also easy to see that @xmath141 : indeed , for any nonzero @xmath142 , there exist vectors @xmath143 ,  ,",
    "@xmath144 in @xmath27 and a family of positive real numbers @xmath145 , ",
    ", @xmath146 such that @xmath147 .",
    "the radical of such an @xmath85 is the set of @xmath148 such that @xmath149 which means that @xmath150 for all @xmath151 , since the @xmath152s are positive , and @xmath153 for any nonzero @xmath154 . in other words",
    ", @xmath134 is the intersection of @xmath155 hyperplanes in @xmath73 which are clearly defined over @xmath21 since the @xmath156 are in @xmath27 .",
    "the reverse inclusion @xmath157 can be established using the same argument as ( * ? ? ?",
    "* proposition 36 ) . consider a form @xmath158 .",
    "assuming that @xmath20 , there exists a @xmath21-subspace @xmath18 of @xmath81 of dimension @xmath159 such that @xmath136 .",
    "consequently , @xmath85 is @xmath77-equivalent to a form of the shape @xmath160 with @xmath161 in @xmath162 , where @xmath163 .",
    "as already seen , this cone @xmath164 is contained in the corresponding vorono cone , which means that there exists vectors @xmath165 ,  , @xmath166 in @xmath167 and a family of positive real numbers @xmath145 , ",
    ", @xmath168 such that @xmath169 .",
    "but then @xmath85 is @xmath77-equivalent to @xmath170 whence the conclusion .",
    "the final step to prove ( [ desc ] ) is to show that @xmath171 .",
    "let @xmath172 be a nonzero element in @xmath91 .",
    "we may assume , without loss of generality , that all @xmath152s are @xmath173 and that the @xmath156 are in @xmath174 .",
    "let @xmath175 be a perfect form with @xmath29-minimum @xmath17 . if @xmath176 , then there exists a direction @xmath98 of @xmath177 such that @xmath178 .",
    "consequently , if @xmath179 is the neighbour of @xmath175 in the direction @xmath98 , then @xmath180 we can pursue this process as long as @xmath181 is not found to belong to the vorono domain of a perfect form , and build a sequence @xmath182 of perfect forms in @xmath132 , the set of perfect forms with @xmath29-minimum @xmath17 , such that the sequence @xmath183 is strictly decreasing . on the other hand ,",
    "the sequence @xmath183 is easily seen to assume only finitely many values .",
    "indeed , we have @xmath184\\ ] ] and we know that for every positive definite form @xmath85 and positive @xmath185 , the set @xmath186 = \\left\\lbrace f[x ] , x \\in   l\\right\\rbrace \\cap \\left[0,\\theta\\right]$ ] is finite and depends on @xmath85 only up to @xmath131-conjugacy . since @xmath187 is finite , the right - hand side of ( [ six ] ) can thus take only finitely many values .",
    "this shows that the process must terminate , and @xmath181 belongs to the vorono domain of a perfect form .",
    "the vorono tessellation of theorem [ vt ] yields a cellular decomposition of @xmath67 .",
    "dual to it , one has a natural @xmath188-complex , acted on by @xmath189 , carried by the set of _ well - rounded _ forms ( see definition below ) .",
    "this cell - complex has been studied by many authors , especially avner ash in @xcite , to which we refer in what follows .",
    "a form @xmath94 is _ well - rounded _ if its set of minimal vectors @xmath90 contains a @xmath21-basis of @xmath27 .",
    "the cell structure on @xmath67 is induced by the decomposition into minimal classes , which are defined as follows :    two elements @xmath190 and @xmath191 are called _ minimally equivalent with respect to @xmath29 _ , if @xmath192 .",
    "we denote by @xmath193 the _ minimal class _ of @xmath85 .",
    "if @xmath194 is a minimal class then we define @xmath195 the associated set of minimal vectors .",
    "a minimal class @xmath194 is called _ well rounded _ if the form @xmath85 is .",
    "one has the following equivalent characterizations of well - rounded forms ( resp .",
    "classes ) :    [ cwr ] let @xmath196 denote the relative interior of the vorono domain of a form @xmath85 ( _ i.e. _ @xmath128 deprived of its proper faces ) .",
    "then , the following assertions are equivalent    1 .",
    "[ un ] @xmath94 is well - rounded , 2 .",
    "[ deux ] @xmath197 , 3 .",
    "[ trois ] @xmath198 .",
    "assume that @xmath85 is well - rounded , and consider the form @xmath199 .",
    "for any @xmath200 one has @xmath201=\\sum_{x",
    "\\in s_l(f)}\\langle x x^{\\dagger } , y y^{\\dagger } \\rangle=\\sum_{x \\in s_l(f)}\\operatorname{\\operatorname{tr}}\\left(x^{\\dagger } y y^{\\dagger } x\\right)=\\sum_{x \\in s_l(f)}\\operatorname{\\operatorname{tr}}_{k_{{\\mathbb{r}}}/{\\mathbb{r}}}\\left(\\left(x^{\\dagger } y\\right)\\left(x^{\\dagger } y\\right)^{*}\\right)\\ ] ] whence @xmath202 for all @xmath203 , hence @xmath204 since @xmath90 spans @xmath114 .",
    "thus @xmath205 which shows that @xmath206 .",
    "the implication @xmath207 is obvious . as for @xmath208",
    ", we note that if @xmath85 is not well - rounded , then one can find a non zero @xmath209 such that @xmath210 for all @xmath203 , whence we deduce that @xmath211=0 $ ] for all @xmath203 , which implies that @xmath212 belongs to the radical of every @xmath213 .",
    "thus @xmath214 .",
    "the action ( [ act ] ) of @xmath77 on @xmath78 , restricted to its subgroups @xmath215 , induces an action on the set of minimal classes .",
    "clearly , because of positive definiteness , the stabilizer @xmath216 is always a finite subgroup of @xmath3 .",
    "we can define similarly the stabilizer of a minimal class as @xmath217    the stabilizer @xmath218 of a well - rounded class is finite .",
    "it follows from ( * ? ? ?",
    "* lemma 5.3 ) that @xmath219 where @xmath220 is the canonical form associated to @xmath221 .",
    "so @xmath222 is the stabilizer of some positive form and therefore a finite group .",
    "positive real homotheties preserve minimal equivalence and the set of well - rounded forms .",
    "the quotient @xmath223 of @xmath18 by these homotheties inherits a well - defined @xmath188-complex structure with the following properties .",
    "let @xmath18 be the set of well - rounded forms in @xmath67 , and @xmath224 .",
    "then the correspondence @xmath225 is an inclusion - reversing bijection between the set of cells of @xmath223 , _",
    "i.e. _ _ _ minimal classes _ _ , and the set of open vorono domains not contained in the boundary of @xmath67 . in particular , @xmath226-cells of @xmath223 correspond to perfect forms in this bijection .",
    "the group @xmath3 acts cellularly on @xmath223 , and the cells have finite stabilizers .",
    "if @xmath1 is a maximal order , this is the main theorem of @xcite .",
    "the general case follows easily , since @xmath3 is a finite index subgroup of the unit group of any of its maximal overorders .",
    "see also p. gunnells appendix to the book @xcite for a nice explanation of the duality between the vorono complex and the well - rounded retract , together with their cell decompositions .    scaling invariance allows to work within the set @xmath227 , which we can identify with the set @xmath228 . using a classical terminology ,",
    "@xmath229 can thus be viewed as the boundary of a _ ryshkov polyhedron _",
    "( @xcite ) , which is locally finite ( see @xcite ) .",
    "in particular , @xmath229 is a piecewise linear hypersurface , whose faces are the minimal classes .",
    "the bounded faces correspond to well - rounded classes and actually are polytopes .",
    "in this section , we describe the theory underlying our algorithm for computing @xmath12 .",
    "almost all the material here is borrowed , with hardly any change , from brown s paper @xcite .",
    "let @xmath223 be equipped with its cell structure , as in the previous section .",
    "we denote by @xmath230 its @xmath151-skeleton .",
    "we can see @xmath231 as a _ graph _ in the sense of @xcite , with vertex set @xmath232 and edge set @xmath233 consisting of @xmath17-cells together with an orientation .",
    "each edge @xmath234 has an origin @xmath235 and a terminus @xmath236 , corresponding to its orientation . for each such @xmath234",
    ", we define @xmath237 as the same @xmath17-cell , together with the reversed orientation ( @xmath238 and @xmath239 ) .",
    "if there exists @xmath240 such that @xmath241 , one says that the edge @xmath234 is inverted under the action of @xmath7 .",
    "one technical difficulty when applying bass - serre theory in its original form is precisely that the definition of a graph adopted either in @xcite or in @xcite forbids action of groups reversing the orientation of edges , a condition which is not necessarily satisfied in practice .",
    "one can easily get around this problem e.g. using barycentric subdivision .",
    "brown s paper deals with this in a slightly different way , although essentially equivalently , which we summarize in the following steps :    1 .",
    "choose an orientation on @xmath17-cells , in such a way that the orientation of those that are not inverted by the action of @xmath7 is preserved by this action .",
    "split the set of edges @xmath233 into a disjoint union @xmath242 , where @xmath243 denotes the set of edges which are not inverted under the action of @xmath7 , and @xmath244 its complement . for @xmath245",
    "let @xmath246 be the stabilizer of the set @xmath247 and @xmath248 the stabilizer of @xmath234 ( together with its orientation ) .",
    "clearly , @xmath248 is a subgroup of @xmath246 , one has @xmath249 and @xmath250 3 .   fix a tree @xmath251 of representatives of @xmath252 , that is a sub - tree such that the set @xmath253 of its vertices is a set of representatives of @xmath254 , with the further assumption that all its edges are in @xmath243 .",
    "this implies in particular that its edges are pairwise inequivalent @xmath255 .",
    "4 .   choose a set @xmath256 of representatives of @xmath257 such that @xmath258 for all @xmath259 , and a set @xmath260 of representatives of @xmath261 such that @xmath258 for all @xmath262 .",
    "[ cinq ] for every @xmath263 , choose @xmath264 such that @xmath265 , with the convention that @xmath266 whenever @xmath234 is an edge of @xmath251 .",
    "[ cinqm ] for every @xmath267 , choose @xmath268",
    "choose a set @xmath85 of representatives of the @xmath19-cells of @xmath269 , and attach to every @xmath19-cell @xmath270 in @xmath85 a _ combinatorial path _",
    "@xmath271 , _ i.e. _ a sequence @xmath272 of edges such that : * @xmath273 , where @xmath274 denotes the @xmath17-cell underlying @xmath275 , * @xmath276 is in @xmath253 , * @xmath277 for @xmath278 and @xmath279 , * @xmath280 for @xmath278 and @xmath281 .",
    "+ to each edge of this path , one attaches ( non - canonically ) an element @xmath282 of the subgroup generated by the various isotropy groups @xmath283 ( @xmath284 ) , @xmath246 ( @xmath285 ) and the @xmath286 ( @xmath259 ) chosen in step [ cinq ] , such that the successive vertices belong to @xmath253 , @xmath287 , @xmath288 ,  , @xmath289 ( see ( * ? ? ?",
    "* section 1 ) for a precise description of @xmath282 ) .",
    "in particular , one has @xmath290 .",
    "we call the sequence @xmath291 the _ cycle associated to @xmath270 _ , and occasionally identify a cycle with the corresponding cell , when no confusion can ensue .    altogether",
    ", the previous data lead to the following presentation of @xmath12 :    [ maintheorem ] let @xmath12 be the unit group of an order in a finitely generated simple algebra over @xmath0 .",
    "let @xmath18 be the set of well - rounded forms in @xmath67 , and @xmath251 , @xmath292 , @xmath85 be chosen as above",
    ". then @xmath7 has the following structure :    @xmath293    where @xmath294 stands for the free product , @xmath295 denotes the free product on the set @xmath296 and @xmath297 is the normal subgroup generated by :    * @xmath286 , @xmath298 , * @xmath299 , @xmath259 , @xmath300 , * [ cycles ] @xmath301 , @xmath302    in other words , @xmath7 is generated by the subgroups @xmath283 ( @xmath284 ) and the elements @xmath286 ( @xmath303 ) , subject to the following relations :    * the multiplication table of @xmath304 ( @xmath305 ) . *",
    "@xmath266 if @xmath234 is an edge of @xmath251 .",
    "* @xmath306 , for @xmath259 and @xmath300 .",
    "* @xmath307 and @xmath308 , for @xmath262 and @xmath300 . * @xmath309 ",
    "@xmath310 for any cycle @xmath291 associated to a @xmath19-cell @xmath270 .",
    "the description of @xmath7 in the first part of the theorem is ( * ? ? ?",
    "* theorem 1 ) , applied to @xmath223 ( which is contractible , hence simply connected ) .",
    "more precisely , the free product @xmath311 modulo the normal subgroup generated by @xmath312 and @xmath313 is precisely the fundamental group of the barycentric subdivision @xmath314 of @xmath315 acted on by @xmath7 ( see the discussion preceding ( * ? ? ?",
    "* theorem 1 ) ) . finally , one has to mod out by the fundamental group of @xmath314 , which is the normal closure of the cycles associated to the @xmath19-cells in @xmath85 . the second part of the theorem is just a rephrasing in terms of generators and relations .",
    "[ sidetransformation ] let @xmath316 be the set of edges coming out of @xmath251 .",
    "for any @xmath317 there is some element @xmath318 with @xmath319 .",
    "choose some @xmath320 such that @xmath321 ( with the convention that @xmath322 if @xmath323 ) .",
    "the element @xmath324 then satisfies @xmath265 . and is called the * side - transformation * corresponding to @xmath234 .    in practical applications one",
    "usually does not fix an orientation on the edges of the graph @xmath5 .",
    "the additional relations that we then need correspond to the so called `` side - pairings '' from the poincar - algorithm .",
    "let @xmath325 and @xmath286 be as above , so that @xmath326 .",
    "we then call the edges @xmath234 and @xmath327 _ paired_. then @xmath328 because @xmath4 acts on the graph and hence preserves edges .",
    "so these two vertices are in @xmath253 and equivalent under @xmath4 , which implies that @xmath330 and @xmath331 .",
    "so if we do not choose an orientation and so do not restrict to those transformations @xmath286 with @xmath258 we need to add these additional relations .",
    "to solve the word problem we return to the tessellation by vorono domains @xmath128 of the perfect forms . according to corollary [ tesse ] this yields a locally finite exact tessellation of the vorono polyhedron @xmath91 that contains the open cone @xmath332 . recall that @xmath332 is a cone in the euclidean space @xmath78 from definition [ defsigma ] .",
    "instead of working in projective space we take an affine section of @xmath332 , @xmath333    [ geodesic ] for @xmath334 let @xmath335 \\ }   \\subset { \\mathcal p}'$ ] the euclidean geodesic joining @xmath89 and @xmath212 .",
    "then the set of all vorono domains of perfect forms that meet @xmath336 , @xmath337 is finite .",
    "we call @xmath338 the perfect - distance between @xmath89 and @xmath212 . note that this distance is @xmath4-invariant , @xmath339 for all @xmath340 .",
    "this is a general compactness argument : for any @xmath341 we may choose an open neighborhood @xmath342 of @xmath343 which intersects only finitely many vorono domains @xmath128 , because of the local finiteness of the tessellation . as @xmath344 is an open covering of the compact set @xmath336",
    "there is a finite subset @xmath345 such that @xmath346    there is an algorithm to express a given @xmath347 as a word in the generators given in theorem [ maintheorem ] .    for the proof we give an algorithm to find such a word in the set of all side - transformations as defined in remark [ sidetransformation ] followed by some element in @xmath348 .",
    "let @xmath349 be the union of all vorono domains of the perfect forms corresponding to the vertices of the tree @xmath251 chosen in section [ bassserre ] .",
    "choose some inner point @xmath350 and let @xmath351 be its image under @xmath352 and @xmath336 be the geodesic between @xmath89 and @xmath212 . if @xmath353 for some @xmath354 then @xmath355 and @xmath356 .",
    "otherwise @xmath336 meets the boundary of @xmath357 in some point @xmath358 .",
    "let @xmath359 by lemma [ geodesic ] the set @xmath360 is finite . if @xmath361 is in the relative interior of some codimension 1 facet ( which will be almost always the case ) then @xmath362 for some @xmath317 .",
    "note that the perfect - distance @xmath363 between any inner point @xmath343 of @xmath364 which lies on @xmath365 and @xmath212 is strictly smaller than @xmath366 .",
    "let @xmath286 be the corresponding side - transformation defined in remark [ sidetransformation ] then @xmath367 and @xmath368 with @xmath369 replace @xmath352 by @xmath370 , @xmath89 by @xmath371 and @xmath212 by @xmath372 and continue . in the unlikely event that @xmath360 contains more than one element ( i.e. @xmath365 meets the intersection of at least two distinct facets containing @xmath361 ) one chooses a different starting point @xmath373 in a small neighborhood of @xmath89 which is still contained in @xmath374 while keeping the endpoint @xmath212 of @xmath365 fixed . since the intersection of two distinct facets is of codimension",
    "at least @xmath19 it is ( from a measure theoretic point of view ) highly unlikely that @xmath365 again meets more than one facet of the fundamental domain .",
    "hence after a small number of modifications of @xmath89 and @xmath365 we are in the situation described above .",
    "in this section we list a few examples to illustrate the algorithm .",
    "many more examples can be found in a database for unit groups of orders linked to the authors homepages , where one will also find magma implementations of the algorithms .",
    "to illustrate the theory of the previous sections we comment on a very easy example .",
    "take the rational quaternion algebra ramified at 2 and 3 , @xmath375 then a maximal order is @xmath376 .",
    "so here @xmath377 , @xmath378 , @xmath379 .",
    "if we embed @xmath2 into @xmath380 using the maximal subfield @xmath381 $ ] we find three perfect forms representing the @xmath382-orbits on the set of all perfect forms : @xmath383 with stabilizers @xmath384    the tessellation for @xmath385^{2\\times 2}$ ] and the relevant part of the resulting graph ( dual to the tessellation ) is visualised in the following pictures .",
    "+     so @xmath386 is represented by the double circled vertices , and @xmath387 .",
    "we have @xmath388 , @xmath389 and @xmath390 and put @xmath391 .",
    "then @xmath392 note that all cycle relations are conjugate as there is just one @xmath382-orbit on the minimal classes of perfection corank 2 .    to illustrate that the resulting tessellation depends on the chosen maximal subfield we redo the computations for the maximal subfield @xmath393 $ ] instead of @xmath381 $ ] .",
    "the tessellation for @xmath394^{2\\times 2}$ ] is as follows .",
    "+     so here we obtain only 2 perfect forms , @xmath395 and @xmath396 , say , with @xmath397 , @xmath398 .",
    "this example illustrates the power of vorono s algorithm .",
    "let @xmath28 be a maximal order in the quaternion algebra @xmath399 , the rational quaternion algebra ramified at 19 and 37 .",
    "the fuchsian group package in magma does not return a presentation of the unit group @xmath382 in a reasonable time .",
    "our algorithm takes about 5 minutes to compute @xmath400 with the single relator @xmath401    one might want to compare this result with the well known formula for the genus @xmath352 of the associated shimura curve ( see e.g. @xcite ) .",
    "note that @xmath402 where @xmath403 . from our presentation",
    "we obtain that @xmath404 , from which we get @xmath405 as predicted .",
    "the number of perfect forms and hence the performance of our algorithm depends on the choice of the involution @xmath406 on @xmath380 . for certain quaternion algebras @xmath2",
    ", there is a canonical way to choose such an involution @xmath406 that preserves @xmath2 :    let @xmath22 be a cm - field with complex conjugation @xmath407 and let @xmath408 be a definite rational quaternion algebra with canonical involution @xmath407 . then @xmath409 defines a positive involution on @xmath410 .    using this involution",
    "we computed a few examples for imaginary quadratic fields @xmath22 : + we first fix the quaternion algebra @xmath411 and vary the imaginary quadratic field @xmath412 , with @xmath413 :    [ cols= \" < , < , < ,",
    "< , < \" , ]      let @xmath414 be a real root of @xmath415 $ ] .",
    "let @xmath416 be the rational division algebra generated ( as an algebra over @xmath0 ) by @xmath417 and @xmath418 where @xmath419 generates the galois group of @xmath420 $ ] over @xmath0 . as the minimal polynomial of @xmath421 ( and",
    "hence of @xmath422 ) is congruent modulo 2 to the minimal polynomial over @xmath423 of a seventh root of unity , @xmath424 and",
    "@xmath425 , we see that the hasse invariant of @xmath2 is @xmath426 at the prime 2 .",
    "we use @xcite to compute a maximal order @xmath28 in @xmath2 and its discriminant @xmath427 .",
    "so the only other ramified prime in @xmath2 is 3 and its hasse invariant is @xmath428 .",
    "let @xmath429 , @xmath379 , @xmath430 via one of the embeddings of @xmath420 \\hookrightarrow { \\mathbb{r}}$ ]",
    ". then @xmath382 has 431 orbits on the set of @xmath29-perfect forms in @xmath332 . after reducing the presentation obtained by the algorithm above with standard magma programs",
    "we obtain that @xmath431 where @xmath432 @xmath433 with defining relators @xmath434    note that @xmath435 has hasse invariant @xmath428 at 2 and @xmath426 at 3 .",
    "as maximal orders of @xmath2 and @xmath436 correspond to each other by transposing matrices , also their unit groups are isomorphic ( via @xmath437 ) .",
    "computing the vorono - tessellation for the transposed matrices , however , we find 410 perfect forms instead of 431 , which shows that there is no direct correspondence on the level of perfect forms .",
    "consider the rational quaternion algebra @xmath438 , ramified at @xmath439 and the infinite place .",
    "let @xmath440 be the maximal order with @xmath441-basis @xmath442 and let @xmath443 , @xmath444 .",
    "the algebra @xmath2 is of interest as a direct summand of the rational group algebra of @xmath445 .",
    "our algorithm finds one perfect form with automorphism group of order @xmath446 ( isomorphic to @xmath447 ) and a presentation of @xmath448 on the two generators @xmath449 which have orders @xmath450 and @xmath451 , respectively .",
    "these two generators satisfy a set of @xmath452 relations , which is too large to be printed here .",
    "the commutator factor group @xmath453 is cyclic of order @xmath450 .",
    "while many things in the implementation of our algorithms are straightforward , there are some tasks which do not have an obvious solution .",
    "we present these here .",
    "let @xmath454 be a form .",
    "in order to compute @xmath90 , the set of @xmath29-minimal vectors of @xmath85 , we associate to @xmath85 a @xmath441-lattice @xmath455 and compute the minimal vectors of that lattice , e.g. using ` magma ` @xcite .",
    "let @xmath456 be a @xmath441-basis of @xmath29 .",
    "we associate to the form @xmath85 the following bilinear form @xmath457 on @xmath458 : @xmath459-f[x]-f[y]\\right)\\ ] ] clearly , @xmath457 is positive definite since @xmath460 .",
    "now let @xmath455 be the @xmath441-lattice which has as its gram matrix the gram matrix of @xmath457 with respect to the basis @xmath456 . then , since @xmath461=b_f(\\ell , \\ell)$ ] for all @xmath462 , the minimal vectors of @xmath455 are the coordinates of the minimal vectors of @xmath85 with respect to the basis @xmath456 .",
    "this lemma allows us to check for isometry and to compute automorphism groups of forms using only our knowledge of the finite sets of minimal vectors and without any a - priori knowledge of @xmath448 . the membership @xmath467 is tested by checking that both @xmath474 and @xmath475 are in the free abelian group @xmath28 .",
    "we now turn to the general case , where @xmath2 is a simple algebra and @xmath476 for some @xmath28-lattice @xmath29 in @xmath27 .",
    "we will only describe the computation of the automorphism group of a form @xmath460 .",
    "isometry testing is completely analogous .",
    "we use the notation from [ imp : minvecs ] .    consider the @xmath0-linear representation of @xmath2 induced by the action of @xmath2 on @xmath27 with respect to the basis @xmath456 .",
    "if we compute the automorphism group of the @xmath441-lattice @xmath455 with the plesken - souvignier algorithm @xcite , the result of this is a finite group of @xmath477-matrices isomorphic to @xmath478 .",
    "however , in general not all of these matrices will be contained in the image of @xmath479 . in order to compute only those automorphisms which satisfy this additional condition we make use of the fact that the plesken - souvignier algorithm may be given an additional input , namely a list of matrices which is to be fixed by the resulting lattice automorphisms .",
    "let @xmath483 and consider @xmath484 as in the statement .",
    "then we have @xmath485 and consequently , for all @xmath486 , @xmath487 .",
    "this implies @xmath488 for all @xmath151 .",
    "it now follows from the double - centralizer theorem ( * ? ? ?",
    "* ( 7.11 ) ) that @xmath5 is contained in the image of the representation of @xmath2 .    since @xmath489 , the matrices @xmath5 from the previous lemma",
    "are actually contained in the image of @xmath33 under the representation we considered .",
    "therefore , using this lemma , we can compute the stabilizer @xmath490 and its intersection @xmath491 without prior knowledge of @xmath448 .",
    "a detailed exposition of vorono s algorithm is beyond the scope of this paper , so we refer the reader to @xcite for details on the theory of the algorithm .",
    "the purpose of this section is to provide an overview of the steps necessary to implement our algorithms .",
    "first of all , it should be noted that one can not carry out precise computations in @xmath492 .",
    "however in order to carry out the computations it is only necessary to embed @xmath2 into a semisimple algebra @xmath493 with positive involution .",
    "if , for example , @xmath2 is a quaternion algebra with positive involution , we compute in @xmath2 itself rather than in @xmath494 . in the case of the example in section [ ex : div3 ] we use an embedding of @xmath2 into @xmath495^{3\\times 3}$ ] , the involution in that case being transposition .",
    "note that one never needs to compute in @xmath380 , as all perfect forms already lie in @xmath493 , however the number of perfect forms depends on the choice of this algebra @xmath493 .    assuming the reader has a suitable version of vorono s algorithm at his disposal",
    ", we now move on to the computation of a presentation of @xmath448 . as a by - product of the algorithm",
    ", we already have the facets of the vorono domains .",
    "the codimension-@xmath19-faces are easily computed as intersections of facets .",
    "these codimension-@xmath19-faces ( to which we will refer as `` ridges '' in what follows ) correspond to the @xmath19-cells of the cw - complex described in section [ wr ] and for computational simplicity we perform our calculations using the faces .",
    "notice that the side transformations ( _ cf . _",
    "remark [ sidetransformation ] ) obtained by vorono s algorithm together with the stabilizers of the perfect forms generate @xmath448 .",
    "this is the set of generators we use in our implementation .",
    "however , this set of generators does not coincide with the generators described in section [ bassserre ] .",
    "let @xmath496 be a set of representatives of perfect forms obtained from vorono s algorithm .",
    "in order to compute the cycle relation corresponding to an ridge @xmath497 contained in the boundary of the vorono domain @xmath498 of a perfect form @xmath499 one should proceed as follows .",
    "note that there is a finite sequence of perfect forms @xmath500 , @xmath501 , such that @xmath502 and @xmath503 meet precisely in a facet , @xmath504 for all @xmath151 and @xmath505 .",
    "we now proceed iteratively : in the @xmath506 step we construct an element @xmath507 as a product of side - transformation ( i.e. generators of @xmath448 ) such that @xmath508 .",
    "so in the @xmath509 step we will have @xmath510 , which means @xmath511 , yielding a relation .",
    "start this calculation by identifying a facet @xmath512 of @xmath498 containing @xmath497 , set @xmath513 to be the perfect form contiguous to @xmath514 through the facet @xmath512 , @xmath515 the corresponding side transformation and @xmath516 . in the @xmath506 step ,",
    "identify the facet @xmath512 of the vorono domain of @xmath517 containing @xmath497 and satisfying @xmath518 ( this can be done by computing in the vorono domain of @xmath519 ) , and let @xmath520 be the perfect neighbour of @xmath517 through @xmath512 , @xmath282 the side transformation corresponding to the facet @xmath521 of @xmath522 and replace by @xmath352 by @xmath523 .",
    "the remaining relations described in section [ bassserre ] are easily computed .",
    "finally it is useful to employ a computer algebra system capable of handling finitely presented groups in order to simplify the presentation .",
    "h. brckner , _ algorithmen fr endliche auflsbare gruppen und anwendungen _ , thesis , rwth aachen university , 1998 .",
    "c.corrales , e. jespers , g. leal , a. del ro , _ presentations of the unit group of an order in a non - split quaternion algebra _ , adv . math .",
    "* 186 * ( 2004 ) 498524 .",
    "a. schrmann , _ computational geometry of positive definite quadratic forms _ , university lecture series , vol .",
    "48 , american mathematical society , providence , ri , 2009 , polyhedral reduction theories , algorithms , and applications .",
    "g.  f. vorono , _ nouvelles applications des paramtres continus  la thorie des formes quadratiques : 1 sur quelques proprits des formes quadratiques parfaites _ , j. reine angew . math . * 133 * ( 1907 ) 97178 .",
    "takao watanabe , syouji yano , and takuma hayashi , _",
    "vorono s reduction theory of @xmath527 over a totally real number field _ ,",
    "diophantine methods , lattices , and arithmetic theory of quadratic forms , contemp . math .",
    "587 , amer .",
    "soc . , providence , ri , 2013 , 213232 ."
  ],
  "abstract_text": [
    "<S> we describe an algorithm , meant to be very general , to compute a presentation of the group of units of an order in a ( semi)simple algebra over @xmath0 . </S>",
    "<S> our method is based on a generalisation of vorono s algorithm for computing perfect forms , combined with bass - serre theory . </S>",
    "<S> it differs essentially from previously known methods to deal with such questions , _ </S>",
    "<S> e.g. _ for units in quaternion algebras . </S>",
    "<S> we illustrate this new algorithm by a series of examples where the computations are carried out completely . </S>",
    "<S> + keywords : unit groups of orders ; generators ; presentation ; word problem ; lattices ; vorono s algorithm ; </S>"
  ]
}