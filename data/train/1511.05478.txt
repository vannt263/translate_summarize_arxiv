{
  "article_text": [
    "in recent years , molecular genetic data have been used extensively to learn about the evolutionary processes that gave rise to the observed genetic variation .",
    "one important example is the use of genetic data to try to infer whether or not gene flow occurred between closely related species during or after speciation ( see for example reviews by nadachowska  2010 , pinho and hey  2010 , smadja and butlin  2011 , bird et al .  2012 and a large number of references in these papers ) .",
    "such applications typically use computer programs such as _ mdiv _ ( nielsen and wakeley  2001 ) , _ i m _ ( hey and nielsen  2004 , hey  2005 ) , _ i m a _ ( hey and nielsen  2007 ) , _ mimar _ ( becquet and przeworski  2007 ) or _ ima2 _",
    "( hey  2010 ) , based on the  isolation with migration \" ( i m ) model , which assumes that a panmictic ancestral population instantaneously split into two or more descendant populations some time in the past and that migration occurred between these descendant populations at a constant rate ever since . whilst such methods have been extensively and successfully applied to study the relationships between different populations within species , the assumption of migration continuing at a constant rate until the present is unrealistic when studying relationships between species .",
    "becquet and przeworski  ( 2009 ) and strasburg and rieseberg  ( 2010 ) investigated by means of simulations how robust parameter estimates ( migration rates , divergence times and effective population sizes ) , obtained by methods based on the i m model , are to violations of the i m model assumptions .",
    "becquet and przeworski  ( 2009 ) found that parameter estimates obtained with _",
    "i m _ and _ mimar _ are often biased when the assumptions of the i m model are violated , and concluded that these methods are highly sensitive to the assumption of a constant migration rate since the population split .",
    "theoretical results derived by wilkinson - herbots  ( 2012 ) also suggested that estimated levels of gene flow obtained by applying an i m model to species which are now completely isolated can not simply be interpreted as average levels of gene flow over time .",
    "thus , whilst computer programs based on the i m model can be used to test for departure from a complete isolation model ( which assumes that an ancestral population instantaneously split into two or more descendant populations which have been completely isolated ever since ) , the actual parameter estimates obtained may be difficult to interpret if the i m model is not an accurate description of the history of the populations or species concerned .",
    "furthermore , in some studies the programs _",
    "i m a _ or _",
    "ima2 _ have also been used to estimate the times when migration events occurred , and to try to distinguish between scenarios of speciation with gene flow and scenarios of introgression , and it has recently been demonstrated that such inferences about the timing of gene flow ( obtained with programs based on the i m model ) are not valid ( strasburg and rieseberg  2011 , sousa et al .",
    "becquet and przeworski  ( 2009 ) , strasburg and rieseberg  ( 2011 ) and sousa et al .  (",
    "2011 ) all suggested that more realistic models of population divergence and speciation are needed .    a first step in trying to make the i m model more suitable for the study of speciation is to allow gene flow to occur during a limited period of time , followed by complete isolation of the species , and such models",
    "have been studied by teshima and tajima  ( 2002 ) , innan and watanabe  ( 2006 ) and wilkinson - herbots  ( 2012 ) . in the latter paper , a model of  isolation with an initial period of migration \" ( iim )",
    "was studied where a panmictic ancestral population gave rise to two or more descendant populations which exchanged migrants symmetrically at a constant rate for a period of time , after which they became completely isolated from each other .",
    "explicit analytical expressions were derived for the probability that two dna sequences ( from the same descendant population or from different descendant populations ) differ at @xmath0 nucleotide sites , assuming the infinite sites model of neutral mutation .",
    "it was suggested that these results may be useful for maximum likelihood estimation of the parameters of the model , if one pair of dna sequences is available at each of a large number of independent loci , and that such an ml method should be very fast as it is based on an explicit expression for the likelihood rather than on computation by means of numerical approximations or mcmc simulation .",
    "however the proposed ml estimation method had not yet been implemented and its usefulness was still to be demonstrated . in this paper",
    "we present an implementation of the ml estimation method for the parameters of the  isolation with an initial period of migration \" model proposed in wilkinson - herbots  ( 2012 ) , and we illustrate its potential by applying it to a set of dna sequence data from _ drosophila simulans _ and _ drosophila melanogaster _",
    "previously analysed by wang and hey  ( 2010 ) and lohse et al .",
    "the parameter estimates and maximized likelihood obtained for the iim model are also compared to those under an i m model and an isolation model , and it is illustrated that the method makes it possible to distinguish between more and less plausible evolutionary scenarios , by comparing aic scores or by means of likelihood ratio tests .",
    "the implementation was done in r ( r development core team 2011 ) .",
    "the r code for the mle method described is included as supplementary material and can readily be pasted into an r document .",
    "this mle algorithm is very fast indeed : for the drosophila data mentioned above ( using the number of nucleotide differences between two dna sequences at each of approximately 30,000 loci ) , we obtained estimates of the parameters of the iim model using a desktop pc ; the program returned results instantly ( i.e. in a small fraction of a second ) if all loci had been trimmed to the same estimated mutation rate ( as proposed by lohse et al .",
    "2011 ) , or in approximately 20 seconds if the full sequences ( and hence different mutation rates at different loci ) were used .    whereas most earlier methods used large samples from a small number of loci , recent advances in dna sequencing technology and the advent of whole - genome sequencing have led to an increased interest in methods which ( like that described in this paper ) can handle data from a small number of individuals at a large number of loci ( for example , takahata  1995 ; takahata et al .",
    "1995 ; takahata and satta  1997 ; yang  1997 , 2002 ; innan and watanabe  2006 ; wilkinson - herbots  2008 ; burgess and yang  2008 ; wang and hey  2010 ; yang  2010 ; hobolth et al .  2011 ; li and durbin  2011 ; lohse et al .  2011 ; wilkinson - herbots  2012 ; zhu and yang  2012 ; andersen et al .",
    "this type of data set has two advantages .",
    "firstly , data from even a very large number of individuals at the same locus tend to contain only little information about very old divergence or speciation events because typically the individuals ancestral lineages will have coalesced to a very small number of ancestral lineages by the time the event of interest is reached , and in such contexts a data set consisting of a small number of dna sequences at each of a large number of independent loci may be more informative ( maddison and knowles  2006 ; wang and hey  2010 ; lohse et al .  2010 , 2011 ) .",
    "secondly , considering small numbers of sequences at large numbers of independent loci is mathematically much easier and computationally much faster than working with large numbers of sequences at the same locus . in particular , explicit analytical expressions for the likelihood",
    "have been obtained for pairs or triplets of sequences for a number of demographic models ( for example , takahata et al .",
    "1995 ; wilkinson - herbots  2008 ; lohse et al .  2011 ; wilkinson - herbots  2012 ; zhu and yang  2012 ) , which substantially speeds up computation and maximization of the likelihood .",
    "we obtain maximum likelihood estimates of the parameters of the  isolation with initial migration \" ( iim ) model studied in wilkinson - herbots  ( 2012 ) , for the case of @xmath1 descendant populations or species .",
    "this model assumes that , time @xmath2 ago ( @xmath3 ) , a panmictic ancestral population instantaneously split into two descendant populations which subsequently exchanged migrants symmetrically at a constant rate until time @xmath4 ago ( @xmath5 ) , when they became completely isolated from each other ( see figure  [ fig1 ] ) .",
    "focusing on dna sequences at a single locus that is not subject to intragenic recombination , the ancestral population is assumed to have been of constant size @xmath6 homologous sequences until the split occurred time @xmath2 ago , where @xmath7 is large . between time",
    "@xmath2 ago and time @xmath4 ago , the two descendant populations were of constant size @xmath8 sequences each and exchanged migrants at a constant rate @xmath9 , where @xmath9 is the proportion of each descendant population that was replaced by immigrants each generation",
    ". the current size of descendant population  @xmath10 is @xmath11 sequences ( @xmath12 ) , and is assumed to have been constant since migration ended time @xmath4 ago .",
    "as is standard in coalescent theory and assuming that reproduction within populations follows the neutral wright - fisher model , time is measured in units of @xmath8 generations ( this also applies to the times @xmath2 and @xmath4 ) ; in practical applications where the wright - fisher model does not hold , @xmath7 is interpreted as the effective population size .",
    "the  scaled \" migration and mutation rates are defined as @xmath13 and @xmath14 , respectively , where @xmath15 is the mutation rate per dna sequence per generation at the locus concerned .",
    "the work described in this paper assumes that mutations are selectively neutral and follow the infinite sites model ( watterson  1975 ) . extensions to other neutral mutation models are feasible but have not yet been implemented .    for this iim model",
    ", wilkinson - herbots  ( 2012 ) found the probability that two homologous dna sequences differ at @xmath0 nucleotide sites : denoting by @xmath16 the number of nucleotide differences between two homologous sequences sampled from descendant populations  @xmath10 and  @xmath17 ( @xmath18 ) and using the subscript @xmath19 to indicate the scaled mutation rate at the locus concerned , we have for @xmath20 @xmath21 for a pair of sequences from the same descendant population , and + @xmath22 for a pair of sequences from different descendant populations , where @xmath23 with @xmath24 and where @xmath25 thus for pairwise difference data of the form @xmath26 , consisting of the number of nucleotide differences between one pair of dna sequences at each of @xmath27 independent loci , the likelihood under the iim model is given by @xmath28 where @xmath29 and @xmath30 denote the locations ( i.e. the population labels ) of the two dna sequences sampled at the @xmath31th locus , and where each factor @xmath32 is given by equation  ( [ distribution0 ] ) or  ( [ distribution1 ] ) as appropriate , replacing @xmath19 by the scaled mutation rate @xmath33 for the @xmath31th locus .",
    "note that the above derivation of the likelihood assumes that there is no recombination within loci and free recombination between loci . in order to jointly estimate all the parameters of the model , data from between - population sequence comparisons as well as within - population sequence comparisons from both populations",
    "should be included in the above likelihood ( where each pairwise comparison must be at a different , independent locus ) .",
    "the above explicit formula for the likelihood allows rapid computation and maximization , so that ml estimates can easily be obtained , as well as aic scores and likelihood ratios comparing the iim model with competing models such as the  complete isolation \" model and the symmetric  isolation - with - migration \" model .",
    "similar ml methods were first developed by takahata et al .",
    "( 1995 ) for a number of different demographic models : a single population of constant size , a population undergoing an instantaneous change of size , and complete isolation models for two and for three species .",
    "innan and watanabe  ( 2006 ) developed an extension of takahata et al.s mle method to a more sophisticated model of gradual population divergence than the iim model considered in this paper , but their calculation of the likelihood relies on numerical computation of the probability density function of the coalescence time using recursion equations on a series of time points ( and then numerically integrating over the coalescence time to find the probability of @xmath0 nucleotide differences ) , which can be time - consuming ; in addition , the accuracy of their recursion and likelihood calculation depend on the number of time points considered .",
    "the method described in the present paper assumes a simpler model than innan and watanabe s , but is faster because both the calculation of the pdf of the coalescence time and the integration over the coalescence time to find the probability of @xmath0 nucleotide differences have already been done , in an exact way , to give equations  ( [ distribution0 ] ) and  ( [ distribution1 ] ) above , leaving far less computation to be done .    in order to obtain good starting values for the likelihood maximization under the iim model , our implementation first fits a complete isolation model , as the latter model gives a more tractable likelihood surface and is therefore less sensitive to the choice of starting values .",
    "the parameter estimates obtained for the complete isolation model are then used as starting values to fit the iim model ; this was found to reduce the possibility that the program might otherwise converge on a local maximum rather than on the global maximum of the likelihood under the iim model . whilst the theoretical results obtained make it possible to directly compute ml estimates of the original parameters of the iim model as described above ( @xmath34 ) ,",
    "our implementation uses the following reparameterizations as this improved performance and robustness : @xmath35 ( similar to the choice of parameters in , for example , yang  2002 , and hey and nielsen  2004 ) , i.e. @xmath36 and @xmath37 represent respectively the time since the end of gene flow and the duration of the period of gene flow , measured by twice the expected number of mutations per lineage during the period concerned ; @xmath38 and @xmath39 are the  population size parameters \" of the current descendant populations and the ancestral population , respectively ( @xmath14 is the population size parameter of each descendant population during the migration stage of the model ) .",
    "ml estimates are obtained jointly for the parameters @xmath40 , and these can readily be converted to ml estimates of the original model parameters if required .",
    "our computer code is included as supplementary material .",
    "equations  ( 1 ) and  ( 2 ) rely on the assumption of symmetric migration and equal population sizes during the period of gene flow . without these assumptions ,",
    "an explicit analytical formula for the likelihood becomes difficult to obtain .",
    "simulation results suggest however that our method is reasonably robust to minor violations of these assumptions ; furthermore , it is possible to extend our method to allow for asymmetric migration and unequal population sizes ( costa rj and wilkinson - herbots hm , work in progress ) .",
    "to illustrate the mle method for the iim model described above , we applied this method to the genomic data set of _",
    "d. simulans _ and _ d. melanogaster _ compiled and analyzed by wang and hey  ( 2010 ) , and reanalyzed by lohse et al .",
    "( 2011 ) , who both used an i m model assuming a constant migration rate from the onset of speciation until the present .",
    "the data consist of alignments of 30,247 blocks of intergenic sequence of 500 bp each , from two inbred lines of _",
    "d. simulans _ and from one inbred line each of _ d. melanogaster _ and _ d. yakuba _ , and have been pre - processed as described in wang and hey  ( 2010 ) and lohse et al .",
    "we also follow these authors in using _ d. yakuba _ as an outgroup to estimate the relative mutation rate at each locus . as our method uses the number of nucleotide differences between one pair of sequences at each locus , we had to choose two of the three sequences ( which we will denote by _",
    "d.sim_1 , _ d.sim_2 and _ d.mel _ for brevity ) at each locus .",
    "there are of course many ways in which this can be done ( for example , one could choose two sequences at random at each locus , as done by wang and hey  2010 ) . in order to use all the data , and to be able to check to what extent our results depend on our choice of sequences",
    ", we took the following approach : three ( overlapping ) pairwise data sets were formed by alternately assigning loci to the comparisons _",
    "d.mel  -  d.sim_1 , _",
    "d.mel  -  d.sim_2 and _",
    "d.sim_1  -  _ d.sim_2 , where data set 1 starts with _ d.mel _",
    "-  _ d.sim_1 at locus 1 ( _ d.mel _  -  _ d.sim_2 at locus 2 , _ d.sim_1  -  _ d.sim_2 at locus 3 , and so on ) , data set 2 uses _",
    "_  -  _ d.sim_2 at locus 1 ( _ d.sim_1  -  _ d.sim_2 at locus 2 ,  ) , and data set 3 starts with _",
    "d.sim_1  -  _ d.sim_2 at locus 1 ( _ d.mel _  -  _ d.sim_1 at locus 2 ,  ) .",
    "thus each sequence at each locus is used in exactly two of the three data sets , and each data set contains between - species differences at approximately 20,000 loci and within - species ( _ d . simulans _ ) differences at approximately 10,000 loci .",
    "ml estimates and estimated standard errors for the iim model parameters @xmath41 represents the current size of _ d. simulans_. we used the main wang and hey ( 2010 ) data set used also by lohse et al .",
    "( 2011 ) , which does not include any _",
    "d. melanogaster _ pairs and hence contains no information on the population size parameter @xmath42 corresponding to the current size of _ d. melanogaster _ ( this parameter does not appear in the likelihood of these data and thus can not be estimated here ) . ] were obtained for each of the three data sets and then averaged over the three data sets . for comparison ,",
    "in addition to fitting an iim model as described above , we also obtained ml estimates assuming an iim model with @xmath43 ( or equivalently , @xmath44 , i.e. not allowing for a change of population size at the end of the migration period ) , a symmetric i m model ( which corresponds to putting @xmath45 in the iim model ) , and a complete isolation model ( which corresponds to assuming @xmath46 in addition to @xmath45 ; the size of descendant population  2 is irrelevant here ) .",
    "the results are given in table  [ tab1 ] .",
    "llrrrrrrrrr + data & model & @xmath47 & @xmath48 & @xmath49 & @xmath50 & @xmath51 & @xmath52 &  @xmath53 & @xmath54 & aic   +   + set 1 & isolation & & 13.66 & & 5.67 & 4.69 & & -90,097.17 & 1,175.66 & 180,200.34 + & i m & & 14.79 & & 5.54 & 3.97 & 0.0209 & -89,509.34 & 270.65 & 179,026.68 + & iim with @xmath43   & 5.87 & 9.99 & & 5.47 & 3.48 & 0.1389 & -89,374.01 & 518.43 & 178,758.03 + & iim & 7.22 & 9.38 & 6.70 & 2.68 & 3.22 & 0.0888 & -89,114.80 & & 178,241.60 + & ( s.e . ) & ( 0.20 ) & ( 0.16 ) & ( 0.11 ) & ( 0.12 ) & ( 0.09 ) & ( 0.0059 ) & & & +   + set 2 & isolation & & 13.57 & & 5.72 & 4.77 & & -90,339.14 & 1,185.38 & 180,684.28 + & i m & & 14.80 & & 5.58 & 3.98 & 0.0227 & -89,746.45 & 347.39 & 179,500.90 + & iim with @xmath43 & 6.27 & 9.88 & & 5.49 & 3.37 & 0.1793 & -89,572.76 & 685.95 & 179,155.51 + & iim & 7.62 & 9.43 & 6.85 & 2.31 & 3.05 & 0.0904 & -89,229.78 & & 178,471.56 + & ( s.e . ) & ( 0.17 ) & ( 0.15 ) & ( 0.11 ) & ( 0.11 ) & ( 0.09 ) & ( 0.0054 ) & & & +   + set 3 & isolation & & 13.63 & & 5.59 & 4.72 & & -89,979.56 & 1,094.44 & 179,965.12 + & i m & & 14.69 & & 5.48 & 4.04 & 0.0193 & -89,432.34 & 291.86 & 178,872.68 + & iim with @xmath43 & 6.29 & 9.67 & & 5.39 & 3.46 & 0.1635 & -89,286.41 & 548.28 & 178,582.82 + & iim & 7.31 & 9.31 & 6.62 & 2.56 & 3.23 & 0.0870 & -89,012.27 & & 178,036.54 + & ( s.e . ) & ( 0.20 ) & ( 0.16 ) & ( 0.11 ) & ( 0.12 ) & ( 0.09 ) & ( 0.0058 ) & & & +   + average & iim & 7.39 & 9.38 & 6.72 & 2.52 & 3.16 & 0.0887 & & & + & ( s.e . )",
    "& ( 0.19 ) & ( 0.15 ) & ( 0.11 ) & ( 0.11 ) & ( 0.09 ) & ( 0.0057 ) & & & +   +    note  the values of the likelihood ratio test statistic @xmath54 shown are for the comparison of the model concerned ( considered to be the null model ) against the model immediately underneath it .",
    "estimated standard errors ( numbers in brackets ) are provided for the model with the best fit , i.e. the full iim model .",
    "the bottom section of the table gives the parameter estimates under the iim model , averaged over the three data sets ; for each parameter , the average of the estimated standard errors for the three data sets is given in brackets , which serves as an estimated _ upper bound _ on the standard error of the averaged parameter estimate ( estimates of the exact standard errors would be hard to obtain as the three data sets overlap ) . [ tab1 ]    fitting the full iim model took approximately 20 seconds for each of the three data sets , on a desktop pc .",
    "estimated mutation rates , and hence the estimates of the parameters @xmath55 and @xmath39 defined in  ( [ pars ] ) , are averages over all the loci considered .",
    "mutation rate heterogeneity between loci was accounted for by estimating the relative mutation rate at each locus from comparison with the outgroup _",
    "d. yakuba _ , as proposed in wang and hey  ( 2010 ) ( see  materials and methods \" for further details ) ; for simplicity these relative mutation rates are treated as known constants ( see also yang  1997 , 2002 ) , i.e. uncertainty about the relative mutation rates is ignored .",
    "table  [ tab2 ] shows the estimates ( averages over the three data sets ) converted to times in years , diploid effective population sizes , and the migration rate per generation , for each of the four models considered .",
    "lcccccc + model & @xmath56 & @xmath57 & @xmath58 & @xmath59 & @xmath60 & @xmath61 +   + isolation & & 2.97my & & 6.18 m & 5.16 m & + i m & & 3.22my & & 6.04 m & 4.36 m &  @xmath62 + iim with @xmath63 & 1.34my & 3.49my & & 5.95 m & 3.75 m & @xmath64 + iim & 1.61my & 3.66my & 7.33 m & 2.75 m & 3.45 m & @xmath65 + ( s.e . ) & ( 0.04my ) & ( 0.03my ) & ( 0.12 m ) & ( 0.12 m ) & ( 0.10 m ) & ( @xmath66 )   +   +    note  the abbreviations ",
    "my \" and  m \" stand for  million years \" and  million individuals \" .",
    "the times @xmath67 and @xmath68 denote , respectively , the time since complete isolation of _ d. simulans _ and _ d. melanogaster _ ( for the iim model ) , and the time since the onset of speciation ( for all models ) , i.e. these are the times @xmath4 and @xmath2 converted into years ( see fig.1 ) .",
    "@xmath7 denotes the effective size of _",
    "d. simulans _ in the isolation and i m models , and during the migration stage of the iim model ; @xmath69 denotes the present effective size of _",
    "d. simulans _ in the full iim model ; @xmath70 is the effective size of the ancestral population .",
    "the estimates shown are the averages of the estimates obtained for the three ( overlapping ) data sets described in the text .",
    "for the iim model , the averaged estimated standard error is also given ( in brackets ) for each parameter ; this is an estimated upper bound on the standard error of the averaged parameter estimate .",
    "[ tab2 ]    these conversions assume a generation time of 0.1 year and a 10 million year speciation time between _",
    "d. yakuba _ and _ d. melanogaster_/_d",
    ". simulans _ ( as assumed by wang and hey  2010 , and by lohse et al .  2011",
    "; see also powell  1997 ) .",
    "it is seen that the iim model places the onset of speciation ( @xmath71 million years ) further back into the past than both the isolation model and the i m model , whereas the estimated time since complete isolation of the two species under the iim model ( @xmath72 million years ) is more recent than under the isolation model . under the iim model",
    "we obtain an estimated ancestral effective population size of @xmath73 million individuals , splitting into two populations containing @xmath74 million individuals each during the time interval when gene flow occurred , with _",
    "d. simulans _ expanding to a current effective population size of @xmath75 million individuals .",
    "note that the estimated migration rate per generation ( @xmath61 ) is an order of magnitude higher under the iim model than under the i m model .",
    "on the one hand , our averaging of the estimated standard errors over the three data sets ( bottom rows of tables  [ tab1 ] and  [ tab2 ] ) will have given us an overestimate of the standard error of the averaged parameter estimates .",
    "on the other hand , however , it should be noted that these estimated standard errors underrepresent the true total amount of uncertainty , as they do not account for uncertainty about the relative mutation rates at the different loci ( which have been treated as known constants , whereas in practice we have estimated them from comparison with",
    "_ d. yakuba _ ) .",
    "care should be taken therefore in the interpretation of the estimated standard errors stated in tables  [ tab1 ] and  [ tab2 ] .",
    "table  [ tab1 ] also gives the maximized loglikelihood ( @xmath53 ) for the different models fitted , for each of the three data sets .",
    "it is seen that , amongst the models being compared , the full iim model consistently gives by far the best loglikelihood value , though of course this model also has the largest number of parameters .",
    "the easiest way of comparing the fit of the different models is by using akaike s information criterion , aic , which was designed to compare competing models with different numbers of parameters ( aic scores were also used in , for example , takahata et al .",
    "1995 , nielsen and wakeley  2001 , and carstens et al .  2009 ) . for each model ( and for the same data )",
    ", aic is defined as @xmath76 ( akaike  1972 , 1974 ) .",
    "thus a larger maximized likelihood leads to a lower aic score , subject to a penalty for each additional model parameter .",
    "the  minimum aic estimate \" ( maice ) is then defined by the model ( and the maximum likelihood estimates of the model parameters ) which gives the smallest aic value amongst the competing models considered .",
    "table  [ tab1 ] includes , for each data set , the aic scores of the different models considered .",
    "it is seen that for each of the three data sets , the maice is given by the full iim model .",
    "thus , out of all the models considered here , the iim model provides the best fit to the data , as measured by the aic scores .",
    "the results in table  [ tab1 ] also show that an iim model with @xmath43 has a substantially better aic score than a symmetric i m model , suggesting that the improved fit of the iim model compared to the i m model is indeed due at least in part to accounting for the eventual complete isolation of the two species , and is not due solely to allowing differences between population sizes .",
    "an alternative approach is to perform a series of likelihood ratio tests for nested models ( see , for example , cox  2006 , section 6.5 on  tests and model reduction \" ) .",
    "focusing on any one of the three data sets in table  [ tab1 ] , if we start with the full iim model and look upwards , each of the models considered reduces to the model immediately above it by fixing the value of one parameter : respectively @xmath43 , @xmath45 , and @xmath46 . each pair of  neighbouring \" models",
    "can then be formally compared by means of a likelihood ratio test , where the null hypothesis represents the simpler of the two models ( i.e. the one with fewer free parameters ) .",
    "if the null hypothesis is true , then the test statistic @xmath77 should approximately follow a @xmath78 distribution if the  null \" value of the parameter concerned is an interior point of the parameter space ( as is the case when we test @xmath43 ) , whereas we might expect @xmath54 to follow approximately a @xmath79 mixture if the  null \" value of the parameter concerned lies on the boundary of the parameter space ( as is the case in the tests of @xmath45 and @xmath46 ) ; using a @xmath78 distribution in the latter case is conservative ( self and liang  1987 ; see also our simulation results below ) .",
    "the value of the likelihood ratio test statistic @xmath54 is given in table  [ tab1 ] for each possible null model , when evaluated against the model immediately underneath it .",
    "for each model comparison , the value of the test statistic @xmath54 is so large that the simpler model is rejected in favour of the more complex model underneath it , with , in each case , a very small p - value ( @xmath80 ) providing overwhelming evidence against the simpler model .",
    "thus these likelihood ratio tests also identify the full iim model as the most plausible amongst the different models considered .",
    "simulations were done to assess how well our method performs and how reliable the estimates obtained in the previous section are . from the three pairwise sets of drosophila sequence data considered in table  [ tab1 ] , we arbitrarily selected the first one (  data set  1 \" ) and mimicked this data set in our simulations",
    ".      each simulated data set consists of the number of nucleotide differences between a pair of dna sequences sampled from descendant population  1 for 10,082 independent loci , and the number of differences between a pair of dna sequences taken from different descendant populations for 20,165 independent loci , generated under the full iim model with  true \" parameter values equal to the estimates obtained for data set  1 ( i.e. @xmath81 , @xmath82 , @xmath83 , @xmath84 , @xmath85 and @xmath86 ) and the infinite sites model of neutral mutation .",
    "these numbers of loci for both types of comparison match those in drosophila data set  1 , and so do the relative mutation rates assumed at the different loci .",
    "one hundred such data sets were generated .",
    "for each simulated data set , ml estimates of the parameters were obtained using our r program for the iim model , i.e. the method described in  new approaches \" .",
    "the resulting estimates are shown in figure  [ fig2 ] .    , @xmath82 , @xmath83 , @xmath84 , @xmath85 and @xmath86 .",
    "each simulated data set consists of the number of nucleotide differences between two dna sequences from descendant population  1 at 10,082 independent loci , and between two dna sequences from different descendant populations at 20,165 independent loci .",
    "different loci were assumed to have different mutation rates : the relative mutation rates used at the different loci match those of the drosophila data considered in this paper.,width=574 ]    as one would expect , it is seen that ( at least for a large sample size ) our ml estimation procedure gives estimates centred on , and close to , the  true \" parameter values . in order to assess whether our method enables us to correctly select the iim model from amongst the different models considered , when the iim model is in fact the true underlying model , we also mimicked the type of analysis as was shown for data set  1 in table  [ tab1 ] : for each simulated data set , we fitted an isolation model , a symmetric i m model , an iim model with @xmath43 , and a full iim model , and computed the aic scores and the values of the likelihood ratio test statistic @xmath54 . both procedures ( using aic scores or likelihood ratio tests ) correctly identified the full iim model as the best - fitting model , for each of the 100 simulated data sets .",
    "the smallest difference obtained between the aic scores of any two neighbouring models was in fact @xmath87 , with the simpler model always having the worse aic score , and the smallest difference observed between the aic scores of the full iim model and any other model was @xmath88 , indicating that the iim model could be identified with ease .",
    "for the likelihood ratio approach , comparing the value of the test statistic @xmath54 for a pair of neighbouring models with the @xmath78 distribution gave in all cases a @xmath89-value much smaller than @xmath90 , providing extremely strong evidence against the simpler of the two models compared ( the smallest value of @xmath54 obtained for any pair of neighbouring models was @xmath91 , whereas the @xmath92 quantile of the @xmath78 distribution is only @xmath93 ) . when comparing the full iim model directly with the isolation model by means of a likelihood ratio test , the smallest value of @xmath54 observed amongst the simulated data sets was @xmath94 , again giving a @xmath89-value very much smaller than @xmath90 ( using the @xmath95 distribution ) for each of the 100 simulated data sets .",
    "we also simulated 100 data sets under the isolation model , to further investigate the performance of our method in identifying the correct model , and whether false positives may be produced  in particular , whether a signal of gene flow may be obtained when in reality there was no gene flow .",
    "the  true \" parameter values assumed in the simulations were those obtained from fitting an isolation model to drosophila data set  1 ( see table  [ tab1 ] ) .",
    "two of the simulated data sets were problematic , in that only the isolation model could be fitted : due to some large values ( @xmath96 ) for the simulated numbers of nucleotide differences between pairs of sequences from different species , r was unable to evaluate the likelihood for any of the other models in the relevant part of the parameter space . for the remaining @xmath97 simulated data sets for which all models could be fitted , a likelihood ratio test using as the null distribution the naive @xmath98 distribution ( with degrees of freedom equal to the difference between the number of parameters in the two models being compared ) gave better results than did comparison of aic scores .",
    "on the basis of aic scores , an incorrect model was selected for as many as 19 of the simulated data sets : in 6 cases the i m model gave the lowest aic score , in 2 cases the iim model with @xmath43 , and in 11 cases the full iim model .",
    "however , in 6 of the 11 cases where the full iim model was selected , the estimated migration rate was @xmath99 so that this  iim \" model was in fact an isolation model but with an additional small change of population size .",
    "a likelihood ratio test of the isolation model against the i m model at a significance level of @xmath100 resulted in acceptance of the isolation model for all 98 data sets , regardless of whether we used @xmath78 or @xmath101 as the null distribution . at a significance level of @xmath102",
    ", the isolation model was rejected for 4 of the 98 simulated data sets if we used @xmath78 , and for 6 of the simulated data sets if the mixed @xmath98 distribution was used .",
    "figure  [ fig3 ]     against the @xmath78 distribution ( left ) , and against the mixture @xmath79 ( right ) . on the vertical axis",
    "we have plotted the sample quantiles of the values of @xmath54 observed when testing the isolation model against the i m model for @xmath103 data sets simulated from the isolation model ( 2 data sets have been omitted as r was unable to fit the i m model - please see the main text for further details ) .",
    "the line @xmath104 is also shown for ease of comparison.,title=\"fig:\",width=317 ]   against the @xmath78 distribution ( left ) , and against the mixture @xmath79 ( right ) . on the vertical axis we have plotted the sample quantiles of the values of @xmath54 observed when testing the isolation model against the i m model for @xmath103 data sets simulated from the isolation model ( 2 data sets have been omitted as r was unable to fit the i m model - please see the main text for further details ) .",
    "the line @xmath104 is also shown for ease of comparison.,title=\"fig:\",width=317 ]    shows that the use of @xmath78 as the null distribution is indeed conservative , and suggests that this may be preferable to using the mixed @xmath98 distribution .",
    "similarly , at a significance level of @xmath100 , a likelihood ratio test of the isolation model against the iim model with @xmath43 led to acceptance of the isolation model for all 98 data sets , whether we used @xmath105 or the mixture @xmath106 as the null distribution . at a significance level of @xmath102 ,",
    "the use of @xmath105 resulted in rejection of the isolation model for 1 of the 98 data sets , whilst the use of @xmath106 as the null distribution led to rejection of the isolation model for 5 of the data sets .",
    "the qq - plots shown in figure  [ fig4 ] confirm again that the use of @xmath105 in this case is conservative .     against the @xmath105 distribution ( left ) , and against the mixture @xmath107 ( right ) .",
    "on the vertical axis we have plotted the sample quantiles of the values of @xmath54 observed when testing the isolation model against the iim model with @xmath43 for @xmath103 data sets simulated from the isolation model ( 2 data sets have been omitted as r was unable to fit the iim model with @xmath43 ) .",
    "the line @xmath104 is also shown for ease of comparison.,title=\"fig:\",width=317 ]    against the @xmath105 distribution ( left ) , and against the mixture @xmath107 ( right ) . on the vertical axis we have plotted the sample quantiles of the values of @xmath54 observed when testing the isolation model against the iim model with @xmath43 for @xmath103 data sets simulated from the isolation model ( 2 data sets have been omitted as r was unable to fit the iim model with @xmath43 ) .",
    "the line @xmath104 is also shown for ease of comparison.,title=\"fig:\",width=317 ]    similarly , the qq - plots in figure  [ fig5 ] indicate that the use of the @xmath95 distribution is conservative when testing the isolation model against the full iim model , and that this may be preferable to the use of a mixed @xmath98 distribution .",
    "a likelihood ratio test at a significance level of @xmath100 led to acceptance of the isolation model for all 98 data sets if a @xmath95 distribution was used , and resulted in rejection of the isolation model for 1 of the 98 data sets when using the mixed @xmath108 distribution . at a significance level of @xmath102 , using the @xmath95 distribution resulted in rejection of the isolation model for 4 of the 98 data sets ( in 2 of these 4 cases the estimated migration rate was @xmath99 , reducing the iim model to an isolation model with an additional slight change of population size ) , whereas the use of the mixed @xmath98 distribution led to rejection of the isolation model for 12 of the 98 data sets ( in 6 of these 12 cases , the estimated migration rate was @xmath99 ) .     against the @xmath95 distribution ( left ) , and against the mixture @xmath109 ( right ) .",
    "on the vertical axis we have plotted the sample quantiles of the values of @xmath54 obtained when testing the isolation model against the full iim model for @xmath103 data sets simulated from the isolation model ( 2 data sets have been omitted as r was unable to fit the iim model ) .",
    "the line @xmath104 is also shown for ease of comparison.,title=\"fig:\",width=317 ]    against the @xmath95 distribution ( left ) , and against the mixture @xmath109 ( right ) . on the vertical axis we have plotted the sample quantiles of the values of @xmath54 obtained when testing the isolation model against the full iim model for @xmath103 data sets simulated from the isolation model ( 2 data sets have been omitted as r was unable to fit the iim model ) . the line @xmath104 is also shown for ease of comparison.,title=\"fig:\",width=317 ]",
    "in this paper we have presented a very fast method to obtain ml estimates and to distinguish between different evolutionary scenarios , using nucleotide difference data from pairs of sequences at a large number of independent loci .",
    "the iim model considered allows for an initial period of gene flow between two diverging populations or species , followed by a period of complete isolation , and is more appropriate in the context of speciation than the i m model commonly used in the literature ( which assumes that gene flow continues at a constant rate all the way until the present time ) .",
    "we have illustrated the speed and power of our method by applying it to a large data set from two related species of drosophila , and to simulated data .",
    "fitting an iim model to a data set of approximately 30,000 loci ( with an average length of about 400 bp and varying mutation rates ) from two species of drosophila took approximately 20 seconds on a desktop pc ; this time included fitting an isolation model first in order to obtain good starting values for the parameters .",
    "moreover , the results made it possible to distinguish between more and less plausible models ( representing alternative evolutionary scenarios ) with ease , and identified the iim model as providing the best fit amongst the models considered .",
    "the drosophila data set studied in this paper was previously analysed by wang and hey  ( 2010 ) , who compiled the data , and by lohse et al .",
    "both fitted i m models to these data , assuming that gene flow occurred at a constant rate from the time of separation of the two species until the present time . in tables",
    "[ tab1 ] and  [ tab2 ] , alongside our results for the iim model , we also included parameter estimates for a symmetric i m model , for the sake of comparison .",
    "as expected , our i m results are in close agreement with those of lohse et al .",
    "( 2011 ) , who fitted two versions of the i m model , one with symmetric migration and one with migration in only one direction ( _ d .",
    "simulans _ to _",
    "d. melanogaster _ forward in time , motivated by wang and hey s results ) .",
    "they found that their estimated migration rate for the symmetric model is approximately half that obtained for the model with migration in one direction , i.e. both models gave the same estimated total number of migrants per generation between the two species in the two directions combined , whereas their estimates of the other parameters are virtually identical for the two models ( see p.23 of their supporting information ) .",
    "our i m results are also in good agreement with those of wang and hey  ( 2010 ) , even though they fitted a more general version of the i m model ( allowing for unequal sizes of the two species and unequal migration rates in the two directions ) and assumed the jukes - cantor model of mutation , whereas our results and those of lohse et al .",
    "( 2011 ) assume the infinite sites model for its mathematical simplicity . indeed , lohse et al .",
    "( 2011 ) comment on how little difference the assumption of the infinite sites model makes to the i m results for the pairwise drosophila data , compared to wang and hey s results based on the jukes - cantor model . of more interest is the comparison of these authors i m results with those obtained for our iim model .",
    "we note firstly that their estimates of 3.04 million years ( wang and hey  2010 ) or 2.98 million years ( lohse et al .",
    "2011 ) for the _ simulans - melanogaster _ speciation time , and also our i m estimate of 3.22 million years , fall in between our iim estimates of 3.66 million years for the time since the onset of speciation ( @xmath68 ) and 1.61 million years for the time since complete isolation of these two species ( @xmath67 ) . secondly , under the i",
    "m model the amount of gene flow between the two species ( in the two directions combined ) was estimated at 0.0134 migrant gene copies per generation ( wang and hey  2010 ) , 0.0255 migrant gene copies per generation ( lohse et al .",
    "2011 , asymmetric i m model ) , 0.0256 ( lohse et al .",
    "2011 , symmetric i m model ) , or 0.0210 migrant gene copies per generation ( our i m results in table  [ tab1 ] , averaged over the three data sets ) .",
    "these estimates are considerably smaller than the corresponding estimate of 0.0887 migrant gene copies per generation during the period of migration under our iim model .",
    "lohse et al .  (",
    "2011 ) also considered a trimmed version of the wang and hey ( 2010 ) drosophila data , where they shortened all loci to a fixed number of nucleotide differences between _",
    "d. melanogaster _ and the _ d. yakuba _ outgroup , so that the estimated mutation rate for all loci was equal .",
    "this assumption that all loci have the same mutation rate massively speeds up the computation of the likelihood , since in this case the probability of @xmath0 differences needs to be calculated only once for each observed value of @xmath0 , rather than having to calculate this probability over and over again for different mutation rates at different loci .",
    "further to this idea , we also implemented a simplified , much faster , version of our mle method to be used for data sets where all loci have the same mutation rate ( this r code is also included as supplementary material ) . applying",
    "this version of our iim program to the trimmed drosophila data ( still approximately 30,000 loci ) gave virtually instant results on a desktop pc , i.e. the computing time was @xmath110 second .",
    "however , the substantial shortening of loci did result in loss of information , and the distinction between more and less plausible models was not always as clear anymore , as the differences between the values of the maximized loglikelihood for the different models ( and hence the values of the likelihood ratio test statistic @xmath54 , and the differences between the aic scores of different models ) were not as large as they were for the full sequence data .",
    "nevertheless , the full iim model could still be identified as giving the best fit amongst the models considered in this paper , both on the basis of aic scores and by means of likelihood ratio tests .",
    "table  [ tab3 ] gives the estimates obtained by fitting the iim model to the trimmed data ; the conversion to times in years , diploid effective population sizes and migration rate per generation was done using a generation time of 0.1 year and a 10 million year speciation time between _",
    "d. yakuba _ and \\{_d . melanogaster _ , _ d. simulans _ } , as before .",
    "the results are broadly in agreement with the corresponding estimates for the full sequence data ( see table  [ tab2 ] , bottom row ) .    lcccccc + model   & @xmath56 & @xmath57 & @xmath58 & @xmath59 & @xmath60 & @xmath61 +   + iim & 1.52my & 3.67my & 6.04 m & 3.94 m & 3.82 m & @xmath111 + ( s.e . ) & ( 0.16my ) & ( 0.10my ) & ( 0.11 m ) & ( 0.33 m ) & ( 0.18 m ) & ( @xmath112 ) +   +    note  the abbreviations ",
    "my \" and  m \" stand for  million years \" and  million individuals \" .",
    "the times @xmath67 and @xmath68 denote , respectively , the time since complete isolation of _ d. simulans _ and _ d. melanogaster _ , and the time since the onset of speciation , i.e. these are the times @xmath4 and @xmath2 converted into years ( see fig.1 ) .",
    "the effective population sizes @xmath113 , @xmath7 and @xmath114 refer respectively to the present _",
    "d. simulans _ population , each population during the migration stage of the model , and the ancestral population .",
    "the estimates shown have been averaged over the three overlapping data sets described in the text . the averaged estimated standard error",
    "is also given ( in brackets ) for each parameter ; this is an estimated upper bound on the standard error of the averaged parameter estimate .",
    "[ tab3 ]    the purpose of our analysis of the drosophila data was merely to illustrate the potential of our method , rather than to draw any firm conclusions about the evolutionary history of the particular species concerned . whilst the iim model provides the best fit to the drosophila data amongst the different models considered in this paper , it is likely that more realistic models can be constructed which provide yet a better fit than the version of the iim model considered here .",
    "our assumption of equal population sizes and symmetric migration during the period of gene flow in the model is obviously an unrealistic oversimplification , but was made for the sake of mathematical tractability and computational speed .",
    "an extension of our method to a more general iim model allowing for unequal migration rates and unequal population sizes during the migration stage of the model is possible and is being developed ( costa rj and wilkinson - herbots hm , work in progress ) .",
    "similarly , the current implementation of our method assumes the infinite sites model of neutral mutation because of its mathematical ease .",
    "extensions of our method to other neutral mutation models ( for example , the jukes - cantor model ) can be done but have not yet been implemented .",
    "it should also be feasible to extend our method to incorporate more than two species .    whilst our method explicitly allows for mutation rate heterogeneity between loci (",
    "whether due to variation in sequence length or variation in the mutation rate per site , or both ) , our current implementation assumes that accurate estimates of the relative mutation rates of the different loci are available ( our implementation treats the relative mutation rates as known constants ) .",
    "this limitation will become less important as more and more genome sequences become available , allowing more accurate estimation of the relative mutation rates . for our analysis of the drosophila data presented in this paper ,",
    "however , the relative mutation rates of the different loci were estimated by comparison of \\{_d .",
    "simulans _ , _ d. melanogaster _ } with the outgroup _ d. yakuba _ , as was done also by wang and hey  ( 2010 ) and by lohse  et al .",
    "( 2011 ) . using more than one outgroup sequence (",
    "if available ) to estimate the relative mutation rate at each locus should improve the accuracy .",
    "it may also be possible to adapt our method to incorporate uncertainty about the relative mutation rates by modelling mutation rate variation as a random variable and integrating out over it ( see yang  1997 , or the  all - rate \" method proposed by wang and hey  2010 ) .",
    "the drosophila data considered in this paper are the _",
    "d. melanogaster - d. simulans _ divergence data compiled and analyzed by wang and hey  ( 2010 ) ; we used the subset of the data that was studied also by lohse et al .",
    "the data consist of alignments of 30,247 segments of intergenic sequence of length 500 bp each , from two inbred lines of _",
    "d. simulans _ and one inbred line of _ d. melanogaster _ , and from an inbred line of _ d. yakuba _ for use as an outgroup .",
    "the data have been pre - processed as described in wang and hey  ( 2010 ) and lohse et al .",
    "( 2011 ) ; the version of the data used is that labelled  wangheyraw \" in the supporting information of lohse et al .",
    "as our method uses pairwise nucleotide differences , subsets of the data were formed by selecting one pair of sequences from each locus ( i.e. _ d.mel _  -  _ d.sim_1 , _ d.mel",
    "_  -  _ d.sim_2 , or _",
    "d.sim_1  -  _",
    "d.sim_2 ) .",
    "three such subsets were formed as described in the section on  results \" ; these three data sets overlap as each sequence at each locus is used in two of the three data sets .",
    "parameter estimates and estimated standard errors were obtained for each of these three data sets separately and then averaged over the three data sets .",
    "this gives too large estimates of the standard errors of the averaged parameter estimates ; however , due to the overlap between the data sets , more accurate estimated standard errors would be difficult to obtain .",
    "following wang and hey  ( 2010 ) and lohse et al .",
    "( 2011 ) , mutation rate heterogeneity between loci was accounted for by comparing the _ d. melanogaster _ and _ d. simulans _ sequences with the outgroup _",
    "d. yakuba_. calculating the outgroup divergence @xmath115 between \\{_d .",
    "simulans _ , _",
    "d. melanogaster _ } and _ d. yakuba _ at locus @xmath31 as a weighted average over the available sequences , assigning 25% weight to each of the _ simulans _ sequences and 50% weight to the single _ melanogaster _",
    "sequence , the relative mutation rate @xmath116 of locus @xmath31 was estimated as @xmath117 , where @xmath118 is the average of the @xmath115 over all loci . the scaled mutation rate at locus @xmath31",
    "is then given by @xmath119 , where @xmath19 is the average scaled mutation rate over all the loci considered .",
    "the relative mutation rates @xmath116 are treated as fixed constants in the likelihood maximization ( see also yang  1997 , 2002 ) .",
    "estimates of the parameters of the iim model were obtained by maximizing the likelihood , given by equation  ( [ likelihood ] ) , using the reparameterization  ( [ pars ] ) . in order to obtain reasonable starting values for the likelihood maximization under the iim model , it can be helpful to first fit an isolation model , as the latter has a more tractable likelihood surface .",
    "estimated standard errors are obtained from the inverted hessian matrix .",
    "the computer code was written in r and is included as supplementary material .",
    "table  [ tab1 ] shows the results obtained for the three sets of drosophila data .    to convert the parameter estimates into readily interpretable units",
    ", we followed wang and hey  ( 2010 ) and lohse et al .",
    "( 2011 ) in using a generation time of @xmath120 year and a 10 million year speciation time between _",
    "d. yakuba _ and \\{_d .",
    "simulans _ , _ d. melanogaster _ } ( see also powell  1997 ) , which gives us an estimate of @xmath121 for the mutation rate per locus per generation , averaged over all the loci included in the analysis .",
    "the converted estimates given in table  [ tab2 ] were then calculated according to the following equations : @xmath122 for the times in years since complete isolation and since the onset of speciation , respectively ; @xmath123 for the effective size ( number of diploid individuals ) of either population during the migration stage of the model , and similarly for all other population sizes ; and @xmath124 for the migration rate per generation . estimated",
    "standard errors for the converted estimates were obtained by re - running a reparameterized version of the program , in terms of @xmath125 and @xmath126 instead of @xmath37 and @xmath127 , using the ml estimates already obtained as starting values , allowing easy computation of the hessian matrix .",
    "as before , estimated standard errors were computed separately for each of the three data sets and then averaged .",
    "following lohse et al .",
    "( 2011 ) we also analyzed a trimmed version of the wang and hey  ( 2010 ) drosophila data , where each locus was cut after 16 nucleotide differences between _",
    "d. melanogaster _ and _ d. yakuba _ , and the remainder of the locus was ignored ; the 2,090 loci which had fewer than 16 differences between _ d. melanogaster _ and _ d. yakuba _ were omitted altogether , leaving 28,157 trimmed loci for analysis .",
    "this trimming amounts to a shortening of the loci by roughly a factor of 3 on average . again , three ( overlapping ) subsets of the data were formed , each containing one pair of sequences from each locus ( i.e. _ d.mel _  -  _ d.sim_1 , _ d.mel _  -  _ d.sim_2 , or _ d.sim_1  -  _",
    "d.sim_2 ) as described above and in the section on  results \" .",
    "parameter estimates and estimated standard errors were obtained for each of these three data sets separately and then averaged over the three data sets .",
    "we used a simplified version of our r code written specifically for data sets where all loci have the same estimated mutation rate ; this simplified code is also included as supplementary material .",
    "the likelihood calculation uses the frequencies of the observed numbers of pairwise differences , which is much faster than the corresponding code for the case where different loci have different mutation rates : for the trimmed drosophila data , instead of evaluating 28,157 terms in the loglikelihood ( one term for each locus ) , only about 50 different terms need to be calculated ( corresponding to the different values of the number of pairwise differences observed , within and between species ) and multiplied by their frequencies , which hugely speeds up the likelihood computation and maximization .",
    "table  3 shows the results obtained under the iim model , after conversion into conventional units as explained above , using a mutation rate of @xmath128 per locus per generation for the trimmed data ( see also lohse et al  2011 ) .",
    "simulated pairwise difference data were generated by first simulating the coalescence times of pairs of sequences and then superimposing neutral mutation under the infinite sites model ; our r code is included as supplementary material . for pairs of sequences from the same species , our simulation algorithm uses the  shortcut \" provided by equations  ( 8) and  ( 9 ) in wilkinson - herbots  ( 2012 ) , exploiting the fact that the distribution of the coalescence time of a pair of sequences sampled from the same species in the iim model is a mixture of two  piecewise exponential \" distributions ( with  change points \" @xmath4 and @xmath2 ) , eliminating the need to explicitly simulate migration events .",
    "i would like to express my sincere thanks to yong wang , jody hey , konrad lohse and nick barton for the use of their drosophila data .",
    "thanks are also due to paul northrop and rex galbraith for some helpful tips on programming in r , and to ziheng yang for some valuable discussions .",
    "this work was supported by the engineering and physical sciences research council via an institutional sponsorship award to university college london ( grant number ep / k503459/1 ) .",
    "the r code which fits an iim model and an isolation model to pairwise difference data from a large number of independent loci is supplied as supplementary material .",
    "the r code for simulating pairwise difference data under the iim model is also provided .",
    ": :    akaike h. 1972 .",
    "information theory and an extension of the maximum    likelihood principle . in : petrov bn , csaki f , editors .",
    "2nd int .",
    "information theory , supp . to problems of control and information    theory .",
    "p. 267 - 281 .",
    ": :    akaike h. 1974 . a new look at the statistical model identification .",
    "ieee transactions on automatic control ac-19:716 - 723 .",
    ": :    andersen ln , mailund t , hobolth a. 2014 .",
    "efficient computation in the    i m model .",
    "j math biol . 68:1423 - 51 .",
    ": :    becquet c , przeworski m. 2007 . a new approach to estimate parameters    of speciation models with application to apes .",
    "genome res .    17:1505 - 1519 .",
    ": :    becquet c , przeworski m. 2009 .",
    "learning about modes of speciation by    computational approaches .",
    "evolution 63:2547 - 2562 .",
    ": :    bird ce , fernandez - silva i , skillings dj , toonen rj . 2012 .",
    "sympatric    speciation in the post  modern synthesis \" era of evolutionary biology .",
    "evol biol . 39:158 - 180 .",
    ": :    burgess r , yang z. 2008 .",
    "estimation of hominoid ancestral population    sizes under bayesian coalescent models incorporating mutation rate    variation and sequencing errors .",
    "mol biol evol .",
    "25:1979 - 1994 .",
    ": :    carstens bc , stoute hn , reid nm .",
    "an information - theoretical    approach to phylogeography .",
    "mol ecol 18:4270 - 4282 .",
    ": :    cox dr . 2006 : principles of statistical inference .",
    "cambridge    university press .",
    ": :    hey j. 2005 . on the number of new world founders : a population genetic    portrait of the peopling of the americas .",
    "plos biol .",
    "3:965 - 975 .",
    ": :    hey j. 2010 .",
    "isolation with migration models for more than two    populations .",
    "mol biol evol 27:905 - 920 .",
    ": :    hey j , nielsen r. 2004 .",
    "multilocus methods for estimating population    sizes , migration rates and divergence time , with applications to the    divergence of drosophila pseudoobscura and d. persimilis .",
    "genetics    167:747 - 760 .",
    ": :    hey j , nielsen r. 2007 .",
    "integration within the felsenstein equation    for improved markov chain monte carlo methods in population genetics .",
    "proc natl acad sci usa .",
    "104:2785 - 2790 .",
    ": :    hobolth a , andersen ln , mailund t. 2011 . on computing the coalescence",
    "time density in an isolation - with - migration model with few samples .",
    "genetics 187:1241 - 1243 .",
    ": :    innan h , watanabe h. 2006 .",
    "the effect of gene flow on the coalescent    time in the human - chimpanzee ancestral population .",
    "mol biol evol .",
    "23:1040 - 1047 .",
    ": :    li h , durbin r. 2011 .",
    "inference of human population history from    individual whole - genome sequences .",
    "nature 475(7357):493 - 496 .",
    ": :    lohse k , sharanowski b , stone gn . 2010 . quantifying the pleistocene    history of the oak gall parasitoid _",
    "cecidostiba fungosa _ using twenty    intron loci .",
    "evolution 64:2664 - 2681 .",
    ": :    lohse k , harrison rj , barton nh .",
    "a general method for    calculating likelihoods under the coalescent process .",
    "genetics    189:977 - 987 .",
    ": :    maddison wp , knowles ll .",
    "2006 . inferring phylogeny despite incomplete    lineage sorting .",
    ". 55:21 - 30 .",
    ": :    nadachowska k. 2010 .",
    "divergence with gene flow - the amphibian    perspective .",
    "herpetological journal 20:7 - 15 .",
    ": :    nielsen r , wakeley j. 2001 . distinguishing migration from isolation : a    markov chain monte carlo approach",
    ". genetics 158:885 - 896 .",
    ": :    pinho c , hey j. 2010 .",
    "divergence with gene flow : models and data .",
    "annu    rev ecol evol syst .",
    "41:215 - 230 .",
    ": :    powell jr .",
    "progress and prospects in evolutionary biology : the    drosophila model .",
    "oxford university press .",
    ": :    r development core team . 2011 .",
    "r : a language and environment for    statistical computing .",
    "r foundation for statistical computing , vienna ,    austria .",
    "url http://www.r - project.org/. : :    self sg , liang ky . 1987 .",
    "asymptotic properties of maximum likelihood    estimators and likelihood ratio tests under non - standard conditions .",
    "j    am stat assoc . 82:605 - 610 .",
    ": :    smadja cm , butlin rk .",
    "a framework for comparing processes of    speciation in the presence of gene flow .",
    "20:5123 - 5140 .",
    ": :    sousa vc , grelaud a , hey j. 2011 . on the nonidentifiability of    migration time",
    "estimates in isolation with migration models .",
    "molecular    ecology 20:3956 - 3962 .",
    ": :    strasburg jl , rieseberg lh . 2010",
    ". how robust are  isolation with    migration \" analyses to violations of the i m model ?",
    "a simulation study .",
    "mol biol evol .",
    "27:297 - 310 .",
    ": :    strasburg jl , rieseberg lh .",
    "2011 . interpreting the estimated timing of    migration events between hybridizing species .",
    "molecular ecology    20:2353 - 2366 .",
    ": :    takahata n. 1995 . a genetic perspective on the origin and history of    humans .",
    "annu rev ecol syst . 26:343 - 372 .",
    ": :    takahata n , satta y , klein j. 1995 .",
    "divergence time and population    size in the lineage leading to modern humans .",
    "theor popul biol .",
    "48:198 - 221 .",
    ": :    takahata n , satta y. 1997 .",
    "evolution of the primate lineage leading to    modern humans : phylogenetic and demographic inferences from dna    sequences .",
    "proc natl acad sci usa .",
    "94:4811 - 4815 .",
    ": :    teshima km , tajima f. 2002 .",
    "the effect of migration during the    divergence .",
    "theor popul biol . 62:81 - 95 .",
    ": :    wang y , hey j. 2010 .",
    "estimating divergence parameters with small    samples from a large number of loci .",
    "genetics 184:363 - 379 .",
    ": :    watterson ga .",
    "1975 . on the number of segregating sites in genetical    models without recombination .",
    "theor popul biol . 7:256 - 276 .",
    ": :    wilkinson - herbots hm .",
    "the distribution of the coalescence time    and the number of pairwise nucleotide differences in the `` isolation    with migration '' model .",
    "theor popul biol .",
    "73:277 - 288 .",
    ": :    wilkinson - herbots hm .",
    "the distribution of the coalescence time    and the number of pairwise nucleotide differences in a model of    population divergence or speciation with an initial period of gene    flow .",
    "theor popul biol . 82:92 - 108 .",
    ": :    yang z. 1997 . on the estimation of ancestral population sizes of    modern humans .",
    "genet res camb . 69:111 - 116 .",
    ": :    yang z. 2002 .",
    "likelihood and bayes estimation of ancestral population    sizes in hominoids using data from multiple loci .",
    "genetics    162:1811 - 1823 .",
    ": :    yang z. 2010 . a likelihood ratio test of speciation with gene flow    using genomic sequence data . genome biol evol .",
    "2:200 - 211 .",
    ": :    zhu t , yang z. 2012 .",
    "maximum likelihood implementation of an    isolation - with - migration model with three species for testing    speciation with gene flow .",
    "mol biol evol .",
    "29:3131 - 3142 ."
  ],
  "abstract_text": [
    "<S> we consider a model of  isolation with an initial period of migration \" ( iim ) , where an ancestral population instantaneously split into two descendant populations which exchanged migrants symmetrically at a constant rate for a period of time but which are now completely isolated from each other . </S>",
    "<S> a method of maximum likelihood estimation of the parameters of the model is implemented , for data consisting of the number of nucleotide differences between two dna sequences at each of a large number of independent loci , using the explicit analytical expressions for the likelihood obtained in wilkinson - herbots  ( 2012 ) . </S>",
    "<S> the method is demonstrated on a large set of dna sequence data from two species of drosophila , as well as on simulated data . </S>",
    "<S> the method is extremely fast , returning parameter estimates in less than 1 minute for a data set consisting of the numbers of differences between pairs of sequences from 10,000s of loci , or in a small fraction of a second if all loci are trimmed to the same estimated mutation rate . </S>",
    "<S> it is also illustrated how the maximized likelihood can be used to quickly distinguish between competing models describing alternative evolutionary scenarios , either by comparing aic scores or by means of likelihood ratio tests . </S>",
    "<S> the present implementation is for a simple version of the model , but various extensions are possible and are briefly discussed . </S>"
  ]
}