{
  "article_text": [
    "estimating a density function using a set of initial data points in order to find probability information is a very significant tool in statistics@xcite .",
    "the method of kernel density estimation ( kde)@xcite is now standard in many analysis and applications . furthermore , this idea has been applied in multiple fields ( archaeology @xcite , economy @xcite , etc ) .",
    "the author of this article is particularly interested in constructing perception of security ( pos ) hotspots using ( kde ) methods to analyze real data registered by security experts in bogot @xcite .",
    "nowadays a wide variety of methods are available to find density functions ( kde ) @xcite,@xcite .",
    "the method of kde via difussion is of particular interest for this document ; a recent article @xcite develops a systematic method for ( kde ) using the diffusion equation , also they propose a more general equation to solve some biases for data estimation .",
    "however in their analysis , it is only considered the normalization ( conservation of mass ) of the density function via neumann boundary conditions , the mean of the sample data is not considered , thus inducing a change of an important initial parameter from the discrete data sample .    in this article",
    ", we propose a new set of boundary conditions for the diffusion equation that maintain the initial mean and mass of the the discrete data sample in the density estimation process .",
    "a complete study of this framework is performed using the finite element method ( fem ) to solve the one - dimensional diffusion equation for different boundary conditions .",
    "we show the induced error on the final density when the mean is not conserved .",
    "we also show how this one - dimensional model can be used to simulate a ( pos ) in a busy avenue of a city .",
    "lastly the new boundary conditions are presented for the two - dimensional diffusion equation for future applications in two dimensional domains .",
    "as it was first noted in @xcite and expanded in @xcite , solving the diffusion equation with a discrete data sample @xmath0 as initial condition ( [ eq2 ] ) give an estimate of a continuous probability density function .",
    "then by solving the diffusion equation @xcite ,    - = 0 a < x < b , t>0 , [ eq1 ] + u(x,0)=_i=1^n(x - b_i ) ,  x , b_i , [ eq2 ]    with appropriate boundary conditions and then finding the best @xmath1 ( bandwidth ) for the initial data sample one obtains a continuous estimation of the experimental density . in this article we do not consider algorithms for bandwidth selection , we consider only the conservation of the mean .",
    "for more information on the bandwidth selection see @xcite .",
    "this one - dimensional toy problem is nevertheless of interest in applications for constructing ( pos ) .",
    "for instance we can model an avenue as a one dimensional domain where predictions of the most dangerous places in a selected zone can be accomplished .    in the following sections we present the non - conservation of the mean for the neumann boundary conditions for problem ( [ eq1 ] ) .",
    "we also propose new boundary conditions .",
    "for the derivations we assume that the functions are sufficiently smooth in order for the theorems of vector analysis to hold",
    ". moreover the following derivations can be done for a more general diffusion equation with a variable diffusion coefficient @xmath2 .",
    "if we consider the neumann or natural boundary conditions on the problem ( [ eq1 ] ) , we have    @xmath3    as is widely known , the total mass is conserved over time , see section [ mass - conv ] , however the mean of the initial condition is , in general , not conserved .",
    "indeed , we have    @xmath4_{a}^{b}- \\left[u(x , t)\\right]_{a}^{b}\\\\ & = u(a , t ) - u(b , t).\\end{aligned}\\ ] ]    where we used ( [ eq1 ] ) , ( [ eq3 ] ) and integration by parts .",
    "hence the mean is generally not conserved , it depends on the values of @xmath5 at the boundary in a time @xmath1 .",
    "we propose the following boundary conditions for ( [ eq1 ] ) ,    @xmath6    note that this boundary conditions are non - local , we need to evaluate in both boundary points at the same time . now we show that both the mean and the mass are conserved over time using this boundary conditions .",
    "consider first the conservation of the total mass .",
    "we have ,    @xmath7_{a}^{b } = \\frac{\\partial u(x , t)}{\\partial x}\\big|_{a}-\\frac{\\partial u(x , t)}{\\partial x}\\big|_{b}=0.\\end{aligned}\\ ] ]    where we used ( [ eq1 ] ) , ( [ eq4 ] ) and integration by parts .",
    "this shows that the total mass is conserved .",
    "consider now the conservation of the mean .",
    "we have ,    @xmath4_{a}^{b}- \\left[u(x , t)\\right]_{a}^{b}\\\\ & = ( b - a)\\frac{\\partial u(x , t)}{\\partial x}\\big|_{b } -u(b , t ) + u(a , t)\\\\ & = 0.\\end{aligned}\\ ] ]    again ( [ eq1 ] ) , ( [ eq4 ] ) and integration by parts were used to obtain the desired result .",
    "this shows that the boundary conditions ( [ eq4 ] ) for problem ( [ eq1 ] ) conserve both mean and mass .",
    "now we proceed to make some numerical simulations using fem to show the consequences of the application of this boundary conditions in the process of estimation a probability density for a data sample ( [ eq2 ] ) .",
    "now the problem ( [ eq1]),([eq4 ] ) is written in a weak formulation @xcite in order to apply the finite element method to the problem .",
    "now for all @xmath8 we have ,    @xmath9    we solve this weak formulation using fem with low order elements in theinterval @xmath10=[0,10]$ ] , where the number of elements is @xmath11",
    ". then problem ( [ eq5]),([eq2]),([eq4 ] ) yields the problem in the discretised space @xmath12 .",
    "find @xmath13 , such thatfor all @xmath14 :    _ a^b v(x)dx + _ a^b dx = ( v(b)-v(a))|_b , [ eq6 ] + u(x,0)=_i=1^n(x - b_i ) ,  x , b_i , [ eq7 ] +     where we represent delta measures by the closest base element of the finite element approximation . note that ( [ eq7 ] ) contains a normalization factor , since now the elements integral are not one ( since they are not delta measures ) .",
    "now we use the galerkin method of mean weighted residuals for the spatial part of the problem choosing low order elements @xmath15 .",
    "this formulation can be found in @xcite . for our numerical studies",
    "we solve the temporal part of the problem ( element coefficients ) using the implicit - euler galerkin discretization @xcite , thus the problem is reduced to solve a linear system iteratively for every timestep @xmath16 .    in order to implement the previous formulation numerically ,",
    "we use ` python ` to do all the calculations for the simulation .",
    "the code is available publicly in @xcite .",
    "there we start by generating a list of @xmath17 uniformly distributed points in theinterval [ 0,10 ] .",
    "this points are located in the closest interval of the spatial fem partition @xmath18 .",
    "the histogram of this points , figure [ histogram ] can be seen for instance as the number of times a certain criminal act was informed in a zone from the avenue .",
    "see figure [ fig : fig1 ] .",
    ".47 $ ] .,title=\"fig : \" ]    .47 $ ] .,title=\"fig : \" ]    if we represent this data as an initial condition we obtain the figure [ initial - condition ] . where we plotted alternatively each consecutive fem basis function red and black .",
    "now we solve numerically the problem using the implicit - euler galerkin discretization for the problem , , and we evolve the solution until time @xmath19 using either neumann boundary conditions , see figure [ neumman - sol ] and mean conserving boundary conditions , see figure [ mean - sol ] .",
    "the solution for the mean conserving boundary condition is positive for this numerical experiment , see figure [ mean - sol ] , this fact is currently being explored for future analytical studies .",
    "as the figure [ fig : fig2 ] shows , the solutions are similar and therefore we can see that for this example the new boundary condition does not generate a noticeable change on the generation of the continuous density distribution .",
    "nevertheless we present the plots of change of mass @xmath20 , figures [ mass - conv - neu ] , [ mass - conv - mean ] and change of mean @xmath21 , figures [ mean - conv - neu ] , [ mean - conv - mean ] for both neumann and mean conserving boundary conditions .    .47   .,title=\"fig : \" ]    .47   .,title=\"fig : \" ]    .47   and @xmath22 for the density estimation with neumann boundary conditions for @xmath23$].,title=\"fig : \" ]    .47   and @xmath22 for the density estimation with neumann boundary conditions for @xmath23$].,title=\"fig : \" ]    .47   and @xmath22 for the density estimation with mean conserving boundary conditions for @xmath23$].,title=\"fig : \" ]    .47   and @xmath22 for the density estimation with mean conserving boundary conditions for @xmath23$].,title=\"fig : \" ]    figures [ mean - conv - neu ] and [ mean - conv - mean ] present the real difference in the evolution of the density .",
    "we effectively see that the mean conserving boundary conditions conserve the mean in the density estimation process . on the other hand if we where to have an initial condition that is biased to one of the boundaries , the differences of the estimated densities by both boundary conditions would differ significantly .",
    "however there is no evidence to think that this phenomena occurs in real avenues .    for the numerical experiment presented here we can see that the mean for the neumann boundary conditions has changed about 0.4% in @xmath24 .",
    "this change is small , in fact , for an avenue of 10 km , the change in mean would be about 40 m. we conclude that for this numerical experiment for the process of density estimation ( when the data has not change to much due to the smoothing process ) the neumann boundary condition provide a very fast ( since they are easy to implement ) and accurate way to estimate a continuous probability density",
    ". nevertheless the mean of the sample is not preserved exactly , on the other hand , the mean conserving boundary condition , apart from being also easily implementable , is accurate and do preserve the mean of the sample .",
    "we now present the problem for the diffusion equation @xcite in two dimensions ,    @xmath25    again we want the conservation of mass and mean in the time evolution of the density .",
    "consider first the conservation of the total mass .",
    "we have ,    @xmath26    where @xmath27 , and @xmath28 denotes the outward normal unit vector to @xmath29 . to deduce this relation we used ( [ eq9 ] ) , and the first green identity @xcite .",
    "consider now the conservation of the mean .",
    "we have ,    @xmath30    where @xmath31 , assuming cartesian unit vectors . again",
    "( [ eq9 ] ) and the first green s identity were used to obtain the desired result .",
    "then the conditions that we have to impose on @xmath32 in order to conserve mean and mass are :    @xmath33    the advantage of two dimensional domains is that we are not restricted to impose only two conditions for the boundary(mean and mass conservation ) . for these domains we can in principle conserve additional higher moments of the density distribution that are meaningful for the particular problem .",
    "applications on two dimensional domains are of special interest for the author since a two dimensional map of the city can generate really robust results in the field of perception of security(pos ) .",
    "the proposed mean conserving boundary conditions were shown to effectively maintain the mean of the initial data sample over the continuous density estimation process .",
    "this was also confirmed by the numerical simulation of the estimation process where we used a list of uniformly distributed points in the interval [ 0,10 ] as an initial condition .",
    "the numerical experiments presented here show that even though neumann boundary conditions do not conserve the mean over time , they are accurate enough to maintain the mean in a very restricted interval before the over - smoothing of the density estimation process .",
    "we showed the application and some of the consequences of both the idea of ( kde ) and the new boundary conditions to avenues in a city .",
    "the consequences of implementing the diffusion equation with the proposed boundary conditions in companion of more special initial conditions and in 2d domains remains to be analyzed .",
    "i would like to express my gratitude to juan galvis , whose guidance was essential for the completion of this manuscript . i also want to thank francisco a. gmez and zdravko botev , whose comments were really appreciated for the analysis of the results .                      1d inhomogenious diffusion equation solution with fem",
    "patarroyo k. available online ."
  ],
  "abstract_text": [
    "<S> we propose boundary conditions for the diffusion equation that maintain the initial mean and the total mass of a discrete data sample in the density estimation process . </S>",
    "<S> a complete study of this framework with numerical experiments using the finite element method is presented for the one dimensional diffusion equation , some possible applications of this results are presented as well . </S>",
    "<S> we also comment on a similar methodology for the two - dimensional diffusion equation for future applications in two - dimensional domains . </S>"
  ]
}