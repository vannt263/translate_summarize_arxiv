{
  "article_text": [
    "the amount of patience required to simulate exactly a nuclear magnetic resonance ( nmr ) spectrum of an @xmath0-spin system scales approximately as @xmath1 . that much is rarely available , and considerable thought has consequently been given over the last decade to more efficient methods  @xcite , particularly those that promise to achieve that objective in polynomial time .",
    "such algorithms do exist  @xcite , but they make significant _ a priori _ assumptions about the spin system evolution  it is usually assumed that the system stays weakly correlated for the duration of the experiment  @xcite .    outside the nmr community , significant progress was recently made with the development of tensor structured methods  @xcite , all of which descend broadly from the density matrix renormalization group ( dmrg )  @xcite as well as matrix product state ( mps )  @xcite and matrix product operator ( mpo )  @xcite formalisms .",
    "typical applications of dmrg in condensed matter theory are 1d spin chains  @xcite with recent extensions to 2d lattices  @xcite .",
    "dmrg has also been put to good use in electronic  @xcite and nuclear  @xcite structure theory , but magnetic resonance spectroscopy has so far received little attention  the spin systems encountered in the daily practice of nmr and epr ( proteins , radicals , polynucleotides , polysaccharides ) are irregular three - dimensional room - temperature networks with multiple interlocking loops in the spin coupling graph and no identical couplings  @xcite . when the strict requirement for correct wavefunction phase during the very long ( milliseconds to seconds ) dissipative spin system trajectories is added to the list , time - domain dmrg methods are currently struggling .",
    "there are some biologically relevant cases , however , that may still be treated as linear chains  for the purposes of simulating simple backbone nmr experiments , protein side chains may often be ignored .",
    "this makes the corresponding spin system a weakly branched linear chain that is amenable to dmrg type treatment .",
    "simple nmr experiments can also be reformulated as a matrix - inverse - times - vector problem in the frequency domain , for which efficient algorithms in tensor product formats have recently emerged  @xcite .",
    "we report in this communication the behavior of the amen algorithm  @xcite , applied to the solution of the nmr simulation problem in the frequency domain , as well as to the technical task of adding together , without loss of accuracy , tensor train representations of thousands of spin hamiltonian terms for a protein .    having integrated the algorithms described below into _ spinach _ ( a large - scale magnetic resonance simulation library  @xcite ) , we are reporting here the first exact quantum mechanical simulation of a liquid - state 1d nmr spectrum for a protein backbone spin system with several hundred coupled spins . beyond the physical assumptions made by chemists at the problem formulation stage and the controllable numerical rounding error of the tensor train format itself  @xcite ,",
    "there are no approximations .",
    "tensor product expressions appear naturally in spin dynamics because the state space of a multi - spin system is a direct product of state spaces of individual spins  @xcite .",
    "a simple example is the nuclear zeeman interaction hamiltonian @xmath2 where @xmath0 is the number of spins , @xmath3 is the applied magnetic field , @xmath4 are nuclear chemical shielding tensors , and the sum runs over all nuclei .",
    "cartesian components of nuclear spin operators @xmath5 have the following tensor product form @xmath6 where @xmath7 denotes an identity matrix of appropriate dimension and pauli matrices @xmath8 occur at the @xmath9-th position in the tensor product sequence . this representation is known in numerical linear algebra as the canonical polyadic ( cp ) format  @xcite .",
    "although cp representations have been known in magnetic resonance spectroscopy for a long time  @xcite , they suffer in practice from rapid inflation  spin hamiltonians encountered in nmr and esr ( electron spin resonance ) systems can be complicated  @xcite and , even for simple initial conditions , the number of terms in the canonical decomposition increases rapidly during system evolution .",
    "more ominously , the number of cp terms can change dramatically after small perturbations of the hamiltonian or the system state .",
    "a simple example is @xmath10 where @xmath11 the left hand side of this equation contains @xmath0 direct product terms , given by eq .  , but the expression approximating it on the right hand side has only two direct product terms , and one could be tempted to use it to reduce storage and cpu time . however , both terms of the approximation grow to infinity when @xmath12 and the accuracy is lost due to rounding errors . such instabilities in the cp format",
    "make it difficult to use  in finite precision arithmetic the number of terms in the decomposition quickly becomes equal to the dimension of the full state space and any efficiency savings disappear .",
    "unlike the cp format , which is an _",
    "open _ tensor network , _ closed _ tensor network formats are stable to small perturbations .",
    "the most popular closed tensor network format was repeatedly rediscovered and is currently known under three different names : dmrg in condensed - matter physics  @xcite , mps  @xcite / mpo  @xcite in computational physics , and tt ( tensor train ) in numerical linear algebra  @xcite .",
    "a tensor train is defined , using the standard notation of numerical linear algebra  @xcite , as follows : @xmath13 the tt representation of the total @xmath14 operator in eq .",
    "is similar to the high  dimensional laplacian  @xcite : @xmath15 with @xmath16 @xmath17 and @xmath18 the number of terms in each summation ( known as _ bond dimension _ , or _",
    "tt rank _ ) is two , and the number of entries of the decomposition is now bounded . the tt representation of @xmath14 in eq .",
    "has @xmath19 single ",
    "spin operators , each of which is either zero , or identity @xmath7 , or the pauli matrix @xmath20 the cp representation of @xmath14 in eq .",
    "has @xmath21 such operators  the tensor train representation is clearly more memory  efficient .",
    "another notable example is the zz coupling hamiltonian that often makes an appearance in models of simple linear spin chains : @xmath22 as written , this is a cp format with @xmath23 terms and @xmath24 single - spin operators entering direct products .",
    "the corresponding tt representation is @xmath25 here each summation runs over three terms only , and the total number of single - spin operator matrices appearing in @xmath26 is @xmath27 , much fewer than the one of the cp format in eq .  .",
    "storage requirements of tensor structured representations ( both cp and tt ) stand in sharp contrast with the classical approach to magnetic resonance simulations  @xcite , where the hamiltonian is represented as a @xmath28 sparse matrix with all non - zero entries stored in memory .",
    "as soon as the matrix is assembled , cpu and memory resources grow exponentially with the number of spins @xmath29 making the simulation prohibitively difficult for large systems .",
    "tensor structured methods avoid this problem ( it is known colloquially as _ the curse of dimensionality _ ) by keeping all data in compressed formats of the form given in eqs .   and   and manipulating it without ever opening up the kronecker products .",
    "a very considerable body of literature exists on manipulating expressions directly in tensor product formats  @xcite .",
    "in particular , a given matrix may be converted into the tt format using sequential singular value decompositions  @xcite .",
    "given tensors in the tt format , one can perform linear or bilinear operations ( addition , element - wise multiplication , matrix - vector multiplication )  @xcite , fourier transform  @xcite , and convolution  @xcite directly in the tt format , avoiding exponentially large arrays and computational costs .",
    "these developments would have permitted large ",
    "scale magnetic resonance simulations entirely in the tt format , were it not for a significant obstacle  the summation operation in tensor train representations is an expensive procedure that carries a significant accuracy penalty due to the need to re - compress the representation to keep the bond dimensions low .",
    "spin hamiltonians of practically interesting biological systems contain many thousands one and two  spin terms of the kind shown in eq .  .",
    "intermediate expressions in spin dynamics simulations also frequently involve large sums .",
    "we demonstrate below that in those circumstances the standard bundle - and - recompress tensor network summation procedure leads either to the bond dimension expansion beyond the limits of modern computing hardware , or to a catastrophic accuracy loss .",
    "this problem also occurs with three ",
    "dimensional potentials encountered in electronic structure theory  @xcite . here",
    "we propose an alternative algorithm for computing large sums , based on alternating tensor train optimization , and use it to enable nmr simulations on protein - size spin systems .",
    "fully  and labelled protein human ubiquitin ( pdb code 1d3z , figure  [ fig : ubiq ] ) containing over a thousand magnetic nuclei in 76 amino acid residues was chosen for testing purposes with two types of spin subsystem selection : _ backbone _ ( h , n , c , ca , ha ) and _ extended backbone _ ( h , n , c , ca , cb , ha , hb ) .",
    "both cases involve a weakly branched continuous chain of spin - spin couplings and are encountered in the simulation of a large class of protein backbone nmr experiments that map out the protein bonding network and thereby assist in molecular structure determination : hnco  @xcite , hncoca  @xcite , hnca  @xcite , and hsqc  @xcite .",
    "the isotropic nmr hamiltonian was assembled using chemical shift values from the bmrb database  @xcite and @xmath30-couplings from the literature data  @xcite . in the cases where an experimental value of a particular @xmath30-coupling was not available in the literature , it was estimated based on the known values for structurally similar substances  @xcite  for most nmr simulation purposes and certainly for the purpose of the demonstration of the performance of the tensor train algorithm the accuracy of such coupling estimates ( about @xmath31 ) is sufficient .",
    "the raw data for the magnetic couplings used in this work is available in the example set supplied with the current public version of the _ spinach _ library  @xcite .",
    "nmr experiments were performed at @xmath32 on a varian inova @xmath33 mhz ( @xmath34 tesla ) spectrometer equipped with a z  gradient triple  resonance cryogenic probe using a @xmath35 mm sample of uniformly   and labelled human ubiquitin in @xmath36 .",
    "spectra were collected as 2d ",
    "hsqc  @xcite spectra incorporating gradient enhanced coherence selection  @xcite and water flip - back .",
    "the spectra were recorded with acquisition times of @xmath37 ( @xmath38 , ) and @xmath39 ( @xmath40 , ) . during the  evolution period , and couplings",
    "were either allowed to evolve , or decoupled by insertion of a rectangular or a shaped @xmath41  inversion pulse using the central lobe of the sinc function . during  acquisition  nuclei were either evolved or decoupled using @xmath42 ppm broadband wurst sequence  @xcite .",
    "the liquid state nmr hamiltonian of , labelled ubiquitin is : @xmath43 where canonical nmr spectroscopy notation is used  @xcite , @xmath44 index runs over all nuclei , @xmath45 and @xmath46 indices run over pairs of nuclei that belong to the same isotope , @xmath47 and @xmath48 run over pairs of nuclei that belong to different isotopes , @xmath49 and @xmath50 run over the nuclei influenced by radiofrequency pulses , @xmath51 and @xmath52 are time profiles of those pulses , @xmath53 are offset frequencies arising from the chemical shielding of the corresponding nuclei  @xcite , @xmath54 are `` strong '' nmr @xmath30-couplings  @xcite , @xmath55 are `` weak '' nmr @xmath30-couplings  @xcite , and spin operators @xmath56 are defined by eq .  . in the case of extended ubiquitin backbone , the hamiltonian in eq .",
    "contains @xmath57 shielding terms , @xmath58 coupling terms , and @xmath59 radiofrequency terms .",
    "all calculations reported below were performed by extending the functionality of _ spinach _ library  @xcite to the tensor train formalism and interfacing it to _ tt - toolbox _",
    "@xcite where appropriate .    due to the abundance of complicated multi - pulse nmr experiments with time - dependent hamiltonians  @xcite ,",
    "magnetic resonance simulations are generally carried out in the time domain .",
    "they always require long - term evolution trajectories with accurate phases ( at least @xmath60 ms , much longer than the reciprocal hamiltonian norm ) for the density operator @xmath61 under the liouville ",
    "von neumann equation : @xmath62 + \\hhr \\left ( \\hrho(t)-\\hrho_{\\mathrm{eq } } \\right ) , \\\\",
    "o(t ) & = \\left\\langle \\ho \\,\\big|\\ , \\hrho(t ) \\right\\rangle = \\trace\\left [ \\ho^\\dagger \\hrho(t ) \\right ] , \\\\    \\hrho_{\\mathrm{eq } } & = \\frac { \\exp \\left ( - \\hh / k_b t \\right ) } { \\trace\\exp \\left ( - \\hh / k_b t \\right ) } .",
    "\\end{split}\\ ] ] where @xmath63 is the relaxation superoperator ( @xmath64 model with literature values for relaxation times  @xcite was used in the present work ) , @xmath65 is the thermal equilibrium state , and @xmath66 is the observable operator , usually a sum of @xmath67 or @xmath68 operators on the spins of interest . in very simple cases",
    "where the hamiltonian is not time - dependent , the general solution to eq .",
    "can be written as : @xmath69 \\,\\big|\\ , \\hrho_0 \\right\\rangle,\\ ] ] where @xmath70 is the hamiltonian commutation superoperator .",
    "direct time domain evaluation of this equation in tensor train format , either using explicit operator exponentiation or krylov type propagation techniques , does not appear to be possible  in all cases described by eq .",
    "the ranks in the tensor train expansion quickly grow beyond the capacity of modern computers . increasing the singular value cut - off threshold at the representation compression stage leads to catastrophic loss of accuracy .",
    "fortunately , there are simple cases ( most notably pulse - acquire 1d nmr spectroscopy ) where amplitudes at only a few specific frequencies are actually required for the fourier transform of eq .  , meaning that the problem can be reformulated in the frequency domain : @xmath71 that is , to compute the observable at the point @xmath72 in the frequency domain , we need to solve a linear system @xmath73 the problem formulation in eq .",
    "sacrifices a great deal of generality compared to eq .",
    "( simulation of arbitrary nmr pulse sequences is no longer possible ) , but it does serve as a stepping stone and enables the demonstration calculation presented below .",
    "the dmrg algorithm was initially proposed  @xcite to find the ground state of a hermitian matrix @xmath74 by the minimization of the rayleigh quotient @xmath75 the dynamical dmrg algorithm  @xcite was then developed to find the solution of a linear system @xmath76 with a hermitian positive definite matrix @xmath74 by the minimization of the energy function @xmath77 apart from the change of the minimization target function , the two algorithms are similar .    in dmrg formalism",
    "the solution is sought in the form of a tensor train introduced in eq .  , but the minimization over all cores @xmath78 simultaneously is a complicated non - linear problem . to make the procedure feasible ,",
    "it is replaced by a sequence of optimizations carried over one core at a time : @xmath79 the tt format is linear in all cores @xmath78 .",
    "this fact may be expressed as @xmath80 where the frame matrix @xmath81 maps the parameters of the tt core @xmath78 to the vector @xmath82 .",
    "the linearity allows to rewrite eq .   as @xmath83 where @xmath84 is the energy function for the _ local problem _",
    "@xmath85 with @xmath86 and @xmath87 . using the non - uniqueness of the tensor train representation",
    ", one can always construct the representation with the unitary frame matrix @xmath81 , that guarantees the stability of the local problem .",
    "such a choice is known as _ gauge condition _ in the mps literature , and _ canonical form _ in the dmrg literature .",
    "after the solution @xmath88 is computed , we substitute @xmath89 in the tensor train , and continue for @xmath90 and then back and forth along the chain .    the convergence of the above described _ one - site _ dmrg procedure depends on the initial guess and in particular on the initial choice of the tt ranks because they remain the same during the sequence of updates defined by eq .  .",
    "this is a severe restriction and additional measures are therefore taken to _ adapt _ the tt ranks during the computations .",
    "one way to do that is to replace the optimization over single cores by the optimization over pairs of neighboring cores , and then to adapt the tt rank between them .",
    "another possibility is to expand the search space by adding auxiliary directions .",
    "the first method of the latter type is the _ corrected one - site _ dmrg algorithm  @xcite , which targets in addition to @xmath82 a surrogate of the next krylov vector @xmath91    for the solution of linear systems , the _ alternating minimum energy _ ( amen )",
    "algorithm was recently proposed  @xcite , which also uses an additional direction to adapt tensor train ranks . the local optimization step in amen",
    "is carried over one site only . to adapt tt ranks and improve convergence ,",
    "tt blocks are expanded by auxiliary information , @xmath92 the _ enrichment _ @xmath93 introduces new directions in the subspace spanned by @xmath94 .",
    "a good choice of the enrichment is the component @xmath93 of the tt representation ( exact or approximate ) @xmath95 of the residual @xmath96 amen algorithm is as fast as one - site methods , but as rank adaptive as the two - site dmrg algorithm , and demonstrates comparable or better convergence rates . for the solution of a linear system @xmath97 with a hermitian positive definite matrix , it has a proven global bound on the geometrical convergence rate . unlike the corrected one - site dmrg method  @xcite ,",
    "the amen algorithm is stable to perturbations and free from tuning parameters and heuristics  @xcite .",
    "the rank adaptation strategy in the enrichment phase of amen is determined by a single relative accuracy parameter .    in this work",
    "we use the amen algorithm for two purposes .",
    "first , we apply it to a system with a trivial matrix @xmath98 but a complicated right - hand side @xmath99 , which is a sum of many elementary tensors like the one in eq .  .",
    "this allows us to compress a hamiltonian returned by the _ spinach _",
    "package from the cp format given by eq .   into the tt format eq .  .",
    "the hamiltonian is stretched into a vector , and the target functional @xmath100 is a frobenius - norm distance between a given hamiltonian @xmath99 and hamiltonian @xmath82 sought in the tensor train format .",
    "the one - site optimization in eq .",
    "is effectively the solution of the over - determined linear system @xmath101 using the least squares method . for the unitary frame matrix we have @xmath102 and",
    "therefore the local optimization step is obtained by contracting the frame matrix with the given hamiltonian @xmath103 the enrichment step uses a low - rank approximation of the error @xmath104 which is obtained by one - site dmrg optimization .    after the hamiltonian is compressed into the tensor train format ,",
    "we compute 1d nmr spectra by solving the linear system in eq .  .",
    "since the matrix @xmath105 is not expected to be hermitian positive definite , we consider instead an equivalent symmetrized problem @xmath106 for demonstration purposes , we chose a simple non - selective damping relaxation model @xmath107 and the same @xmath108 operator for the initial and the detection state , where @xmath109 are the total spin operators of all  nuclei in the system .",
    "this avoids explicit radiofrequency pulses and makes the hamiltonian in eq .",
    "time - independent and real - valued , @xmath110 those properties are also inherited by the commutation superoperator @xmath111 since the detection state @xmath66 is also real - valued , the nmr spectrum @xmath112 in eq .",
    "can be computed from @xmath113 that we obtain as follows : @xmath114 this equation is solved by the amen algorithm at each point @xmath72 in the user - specified frequency interval .",
    "as discussed above , a major problem in the application of tensor train methods to magnetic resonance simulation of large systems is the calculation of lengthy sums involved in the construction of spin hamiltonians and density matrices , and their compression into the tt format .",
    "[ fig : time ] illustrates the performance of our proposed solution to this problem in the case of minimal ( h , n , c , ca , ha ) and extended ( h , n , c , ca , ha , cb , hb ) ubiquitin backbone spin systems .",
    "storage requirements for the tt format in eq .",
    "depend on all tt ranks ( bond dimensions ) @xmath115 and are characterized by the _ effective _ tt rank @xmath116 defined by @xmath117 it is clear from the left panels of fig .",
    "[ fig : time ] that the primary showstopper  rapid growth in the tensor train rank  has been removed by the amen method : the effective ranks stay below @xmath118 for the extended backbone and below @xmath42 for the minimal backbone , well within the capability of modern desktop workstations . since @xmath119 is smaller than the number of terms in the cp representation , the tt format with @xmath120 operators provides more compact storage than the cp format .    the alternative",
    "to amen is _ binary _ summation , which adds up hamiltonian terms pairwise and recompresses the representation after each addition . as demonstrated in fig .",
    "[ fig : time ] , binary summation drives tensor train ranks up to several hundred and thereby makes the solution of the linear system in eq .   exceedingly difficult .",
    "it is clear from the right panels of fig .",
    "[ fig : time ] that the cpu time requirements of amen summation compared to binary summation are essentially the same , making amen procedure clearly superior for all practical purposes . the resulting representation of the ubiquitin backbone spin hamiltonian matrix is , up to the rounding error of the complex double precision arithmetic , exact .",
    "in magnetic resonance spectroscopy this is an unprecedented development  ubiquitin nmr simulation is currently just about feasible  @xcite , with significant approximations and colossal computational resources .",
    "tensor train representation is therefore a large step forward , even though eq .",
    "is not in general applicable to arbitrary nmr experiments .     during the construction of the nmr spin hamiltonian . * top *",
    " human ubiquitin backbone ( h , n , c , ca , ha ) , * bottom *  human ubiquitin extended backbone ( h , n , c , ca , ha , cb , hb ) . here",
    "@xmath121 refers to the isotropic part of the hamiltonian and @xmath122 to the irreducible spherical components of the anisotropic part . ]",
    "is compared to the results obtained by the restricted state space ( rss ) approximation  @xcite with basis containing local spin correlations of orders up to @xmath123 and @xmath124 . *",
    "bottom *  accurate rss computation is used as a reference @xmath125 and compared to the spectra @xmath112 computed by amen and dmrg  @xcite , both using the accuracy parameter @xmath126 right subgraph : convergence of amen and dmrg methods at two points of the frequency domain ( dashed lines : an off - peak point at @xmath60 ppm , solid lines : a peak at @xmath127 ppm ) .",
    ", title=\"fig : \" ]   is compared to the results obtained by the restricted state space ( rss ) approximation  @xcite with basis containing local spin correlations of orders up to @xmath123 and @xmath124 . *",
    "bottom *  accurate rss computation is used as a reference @xmath125 and compared to the spectra @xmath112 computed by amen and dmrg  @xcite , both using the accuracy parameter @xmath126 right subgraph : convergence of amen and dmrg methods at two points of the frequency domain ( dashed lines : an off - peak point at @xmath60 ppm , solid lines : a peak at @xmath127 ppm ) .",
    ", title=\"fig : \" ]    to to    after the hamiltonian is compressed , we compute  pulse - acquire nmr spectra using eq .   with the amen algorithm and",
    "compare it to the simulation produced by the restricted state space ( rss ) approximation  @xcite , which is currently the only other method that is capable of handling nmr systems of this size . as demonstrated in fig .",
    "[ fig:1d ] ( top ) , when the basis set used by rss is increased , its result converges to the one produced by amen , and the relative deviation between two methods falls below @xmath128 across the frequency interval .",
    "it is instructive to compare the results of amen simulations with those produced by the dynamical dmrg  @xcite technique . as shown in fig .",
    "[ fig:1d ] ( bottom ) , the nmr spectrum computed by amen matches the reference spectrum returned by rss with only minor deviations , while the accuracy of the result computed by the dynamical dmrg algorithm at the same relative accuracy parameter is unacceptable .",
    "dmrg does of course produce the right answer if a much tighter accuracy parameter is specified , but the simulation time goes up by several orders of magnitude .",
    "amen does therefore appear to have a better accuracy - to - effort ratio .",
    "this is also confirmed by the convergence graph of amen and dmrg , given in the same figure , where the relative deviation between the computed and the reference values @xmath112 is shown during the iterations ( sweeps ) for both dmrg and amen .",
    "note also that the inexact values of the spectrum , computed by amen and dmrg are always below the reference values ; this was first noted by jeckelmann  @xcite .",
    "the comparison in fig .",
    "[ fig:1d ] is made using @xmath129 to visually emphasize the observed difference between the two methods ; the same conclusion also holds for more accurate calculations using @xmath130    due to the intrinsically low sensitivity of liquid state  protein nmr spectroscopy , it is not possible to record the experimental equivalent of fig .",
    "[ fig:1d ] directly with a sufficient signal - to - noise ratio ; we have therefore taken a somewhat longer route to the experimental validation of the tensor train simulation  fig .",
    "[ fig:2d ] shows experimental proton - detected ",
    "hsqc spectra of ubiquitin , compared to the simulations obtained at the basis set limit of the rss formalism  @xcite .",
    "perfect agreement is apparent in both cases .",
    "this provides an experimental evidence to the accuracy of the restricted state space method .",
    "the tensor train results in fig .",
    "[ fig:1d ] can now be justified by comparison to the rss results  it is clear that the tt formalism performs as intended .",
    "the successful 1d nmr simulation notwithstanding , very significant obstacles remain on the path to practical applications of the tensor train formalism to nmr spectroscopy .",
    "the following issues should be addressed in future work to fully uncover the potential of the dmrg / mps / tt formalism for spin dynamics simulations :    \\(a ) the requirement for the spin system to be a chain or a tree should be lifted .",
    "biological magnetic resonance spin systems are irregular polycyclic interaction networks with multiple interlocking loops in the coupling graph , particularly in solid state nmr , where inter - nuclear dipolar couplings form very dense meshes . a generalization of tensor train algorithms to general contraction networks that fully mimic the molecular structure is therefore required .",
    "\\(b ) rank explosion problem for time - domain simulations should be solved .",
    "it is clear from the success of the restricted state space approximation  @xcite that the order of spin correlation in many evolving magnetic resonance spin systems either is or may safely be assumed to be quite low .",
    "this suggests data sparsity and separability , and indicates that some kind of low - rank decomposition is possible .",
    "one likely direction is through the enforcement of symmetries and conservation laws within the tensor train format itself during time evolution .",
    "\\(c ) our experience indicates that tensor train objects are very far from being drop - in replacements for their matrix counterparts in standard simulation algorithms and software  it does actually appear that nearly everything in the very considerable body of magnetic resonance simulation methods needs to be adapted to the realities of dmrg .",
    "current implementation of tensor product methods still requires a number of tuning parameters ( approximation accuracies , tt ranks of the enrichment , etc . ) .",
    "broad adoption of tensor network algorithms would require basic linear algebra operations to be handled transparently and seamlessly by the existing simulation software packages , in the same way as sparse matrices currently are .",
    "\\(d ) transparent and clear tensor train approximation accuracy criteria , rank control and _ a priori _ error bounds should be developed in order to estimate the influence of the representation compression errors on the accuracy of the final result .",
    "this problem is particularly acute for the state vector phase in time domain simulations : magnetic resonance experiments rely critically on the phase being correctly predicted .",
    "all of that having been said , we are very optimistic about the future of low - rank tensor product dmrg / mps / tt methods , having also found them useful in fokker ",
    "planck type formalisms related to nmr and epr spectroscopy  @xcite .",
    "their primary strength is the lack of heuristic assumptions and the controllable nature of the representation accuracy .",
    "an experimental implementation of tensor train magnetic resonance simulation paths , via an interface to the _ tt - toolbox _",
    "@xcite , is available in version 1.3.1980 of our _ spinach _ library  @xcite .",
    "even with their well - documented limitations ( the requirement for the spin system to be close to a chain , difficulty with long - range time - domain simulations , code implementation challenges , etc . ) , the ability of tensor network formalisms to simulate simple liquid state nmr spectra of large spin systems essentially without approximations is impressive . they can not yet match the highly optimized dedicated methods developed by the magnetic resonance community  @xcite , but if some of the limitations are lifted by the subsequent research , dmrg methods would have the potential to become a very useful formalism in nmr research .",
    "having solved in this paper the last purely technical problem on the way to the broad adoption of tensor train formalism in magnetic resonance spectroscopy , we are quite optimistic about its potential . in particular , the following avenues appear promising :    1 .",
    "generalizing amen method to arbitrary tensor networks , e.g. tree tensor networks  @xcite , that closely match the coupling topology of the spin system .",
    "2 .   development of reliable tensor train methods for solving linear systems of algebraic equations with indefinite matrices , and time evolution problems .",
    "development of tensor product methods that reduce memory requirements and accelerate convergence by enforcing conservation laws  @xcite and matrix symmetries  @xcite .    elsewhere in magnetic resonance ,",
    "benefits to electron spin resonance spectroscopy , with its star - shaped spin interactions graphs , are likely to be harder to achieve , but may still be obtained by exploiting the direct product structure of combined spin and spatial dynamics appearing in fokker ",
    "planck type problems  @xcite .",
    "we are grateful to garnet k .- l .",
    "chan for patiently explaining the dmrg formalism to ik during his visit to cornell university and to zenawi t. welderufael for finding some of the less obvious ubiquitin @xmath30-couplings in the literature .",
    "we acknowledge the iridis high performance computing facility , and the associated support services at the university of southampton .",
    "jmw would like to acknowledge the wellcome trust for support of the southampton nmr centre and we would like to thank the geoff kelly at nimr ( mill hill ) for lending us the ubiquitin sample . the project is supported by epsrc ( ep / h003789/2 , ep / j013080/1 ) .          , http://dx.doi.org/10.1007/bf01874573 [ _ an efficient 3d nmr technique for correlating the proton and @xmath131 backbone amide resonances with the @xmath132-carbon of the preceding residue in uniformly @xmath131/@xmath133 enriched proteins _ ] , j. biomolecular nmr , 1 ( 1991 ) , pp .  99104",
    ".                              height 2pt depth -1.6pt width 23pt , http://arxiv.org/abs/1304.1222[_alternating minimal energy methods for linear systems in higher dimensions .",
    "part ii : faster algorithm and application to nonsymmetric systems _ ] , arxiv preprint 1304.1222 , 2013 .",
    "height 2pt depth -1.6pt width 23pt , http://arxiv.org/abs/1312.6542[_corrected one - site density matrix renormalization group and alternating minimal energy algorithm _ ] , in proc .",
    "enumath 2013 , accepted , 2014 .                        , http://dx.doi.org/10.1080/03081087.2012.663371[_exploiting matrix symmetries and physical symmetries in matrix product states and tensor trains _ ] , linear and multilinear algebra , 61 ( 2013 ) , pp .",
    "91122 .        ,",
    "http://dx.doi.org/10.1021/ja00052a088[_pure absorption gradient enhanced heteronuclear single quantum correlation spectroscopy with improved sensitivity _ ] , j. am .",
    ", 114 ( 1992 ) , pp .",
    "1066310665 .      , http://dx.doi.org/10.1137/110844830[_multilevel toeplitz matrices generated by tensor - structured vectors and convolution with logarithmic complexity _ ] , siam j. sci .",
    ", 35 ( 2013 ) , pp .",
    "a1511a1536 .",
    ", http://dx.doi.org/10.1063/1.3152576[_high-perfomance ab initio density matrix renormalization group method : applicability to large - scale multireference problems for metal compounds _ ] , j. chem .",
    ", 130 ( 2009 ) , p.  234114 .    , http://dx.doi.org/10.1103/physrevb.49.9214[_approximate diagonalization using the density matrix renormalization - group method : a two - dimensional - systems perspective _ ] , phys .",
    "b , 49 ( 1994 ) , pp .  92149217 .",
    ", http://dx.doi.org/10.1021/ja003724j[_self-consistent karplus parametrization of @xmath137 couplings depending on the polypeptide side - chain torsion @xmath138 _ ] , j. am .",
    "soc . , 123 ( 2001 ) , pp .",
    "70817093 .",
    "height 2pt depth -1.6pt width 23pt , http://dx.doi.org/10.1016/j.aop.2010.09.012[_the density - matrix renormalization group in the age of matrix product states _ ] , annals of physics , 326 ( 2011 ) , pp .",
    "96192 .        , http://dx.doi.org/10.1143/jpsj.66.2221 [ _ thermodynamics of the anisotropic heisenberg chain calculated + by the density matrix renormalization group method _ ] , j. phys .",
    "jpn . , 66 ( 1997 ) , pp .",
    "22212223 .    , http://dx.doi.org/10.1146/annurev-conmatphys-020911-125018[_studying two - dimensional systems with the density matrix renormalization group _ ] , annual review of condensed matter physics , 3 ( 2012 ) , pp .",
    "111128 .              , http://dx.doi.org/10.1021/ja9535524 [ _ determination of the backbone dihedral angles @xmath139 in human ubiquitin from reparametrized empirical karplus equations _ ] , j. am .",
    "soc . , 118 ( 1996 ) , pp .",
    "24832494 .    , http://dx.doi.org/10.1103/physrevb.56.5061[_transfer-matrix density - matrix renormalization - group theory for thermodynamics of one - dimensional quantum systems _ ] , phys",
    "b , 56 ( 1997 ) , pp .  50615064 .            , http://dx.doi.org/10.1063/1.3700087[_longitudinal static optical properties of hydrogen chains : finite field extrapolations of matrix product state calculations _ ] , j. chem . phys . ,",
    "136 ( 2012 ) , p.  134110 .",
    ", http://dx.doi.org/10.1016/j.cpc.2014.01.019[_chemps2 : a free open - source spin - adapted implementation of the density matrix renormalization group for ab initio quantum chemistry _ ] , computer phys .",
    "comm . , ( 2014 ) ."
  ],
  "abstract_text": [
    "<S> we introduce a new method , based on alternating optimization , for compact representation of spin hamiltonians and solution of linear systems of algebraic equations in the tensor train format . </S>",
    "<S> we demonstrate the method s utility by simulating , without approximations , a  nmr spectrum of ubiquitin  a protein containing several hundred interacting nuclear spins . </S>",
    "<S> existing simulation algorithms for the spin system and the nmr experiment in question either require significant approximations or scale exponentially with the spin system size . </S>",
    "<S> we compare the proposed method to the _ spinach _ package that uses heuristic restricted state space techniques to achieve polynomial complexity scaling . </S>",
    "<S> when the spin system topology is close to a linear chain ( e.g. for the backbone of a protein ) , the tensor train representation is more compact and can be computed faster than the sparse representation using restricted state spaces .    </S>",
    "<S> _ keywords : _    density matrix renormalization group , alternating minimal energy , tensor train , nuclear magnetic resonance , protein </S>"
  ]
}