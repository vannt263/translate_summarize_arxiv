{
  "article_text": [
    "in the context of geobiochemical models , so - called production - destruction equations are frequently encountered .",
    "these models describe the time - evolution of non - negative quantities and often take into account some type of mass conservation .",
    "the underlying ode systems describing the time - evolution of non - negative quantities @xmath1 can usually be written in the form @xmath2 for @xmath3 , with production terms @xmath4 and destruction terms @xmath5 such that @xmath6 for all @xmath7 and @xmath8 .",
    "usually , we also have @xmath9 for all @xmath7 and some mass conservation property such as @xmath10 . in vector form",
    ", we write @xmath11 with matrix - valued functions @xmath12 such that @xmath13 for all @xmath7 . setting @xmath14 ,",
    "this is written more shortly in the standard quasi - linear form @xmath15 .",
    "while many interesting biochemical reactions fit into this framework , it also includes certain space - discretized partial differential equations , e.g. the heat equation discretized by second - order differences and the first - order upwind - discretized advection equation . in the context of shallow water flows discretized by the discontinuous galerkin method , a production - destruction approach as in @xcite guarantees non - negativity of the water height for any time step size while still preserving conservativity . in that work ,",
    "the production - destruction equations where specifically formulated in order to account for the production and destruction terms which influence the cell - wise water volume .",
    "generally , numerical methods discretizing ( [ eq : pq1 ] ) are supposed to be positivity preserving , conservative and of sufficiently high order . while positivity preservation and conservativity may be directly carried over from the context of odes to that of pdes ,",
    "the issue of consistency and convergence is more subtle for pdes . in this work ,",
    "we hence take a closer look at the local discretization error of patankar - type methods applied to systems arising from linear pdes .",
    "the forward euler method applied to ( [ eq : pq1 ] ) will obviously be positivity preserving if we have @xmath16 , but this requires a very severe time step restriction on @xmath17 for stiff systems . to avoid this ,",
    "a variant was proposed by patankar @xcite , originally in the context of source terms in heat transfer .",
    "this method given by @xmath18 is unconditionally positivity preserving but not mass conserving .",
    "in addition , while ( [ eq : eulpata ] ) is of order one in the ode sense , consistency is lost for stiff problems such as the discretized heat equation .",
    "in fact , the semi - discrete 1d heat equation @xmath19 for @xmath3 , with spatial periodicity , i.e. @xmath20 and @xmath21 fits in the form ( [ eq : pq1 ] ) with diagonal destruction matrix @xmath22 . the patankar - euler scheme ( [ eq : eulpata ] ) , written out per component , now reads @xmath23 .",
    "this scheme is unconditionally positivity preserving as well as unconditionally contractive in the maximum norm .",
    "however , inserting exact pde solution values in the scheme , we obtain @xmath24 . hence , taylor development shows that for small @xmath17 and @xmath25 the leading term in these local truncation errors is given by @xmath26 .",
    "it follows that the scheme will only be convergent in case of a very severe time step restriction of @xmath27 .    in order to obtain an unconditionally positive and additionally mass conservative scheme for production - destruction equations",
    ", the modification @xmath28 has been proposed in @xcite . for linear problems @xmath29 with constant matrix @xmath30 , such as the linear heat equation",
    ", this modified method now reduces to the implicit euler method , so consistency in pde sense is not a problem there . in @xcite ,",
    "also a second - order method has been proposed .",
    "we will refer to this method as mpark2 .",
    "this scheme does not fit directly in the vector production - loss formulation and thus has to be written per component , starting with the quasi - linear form @xmath31 .",
    "the mpark2 method is then based on the trapezoidal rule with an euler - type prediction to provide the internal stage value @xmath32 and reads @xmath33 as shown in @xcite , this scheme is unconditionally positivity preserving and mass conserving , and the order is two in the ode sense .",
    "however , it is unknown whether there will be order reduction for stiff problems , in particular for semi - discrete problems obtained from pdes after space discretization . regarding the local discretization error , consistency of @xmath0 can be proven for sufficiently smooth exact solutions .",
    "this is dealt with in the next section .",
    "we will study error recursions for the mpark2 method applied to linear problems with constant coefficients .",
    "these are naturally non - linear for this method , even for linear equations . for a linear problem @xmath34 with @xmath35",
    ", we will first write ( [ eq : mprk ] ) in vector form by introducing the diagonal matrix @xmath36 . then",
    "( [ eq : mprk ] ) can be written compactly as @xmath37 along with this , we also consider the scheme with the exact solution inserted , @xmath38 where @xmath39 and @xmath40 .",
    "subtraction of ( [ eq : mprkv ] ) from ( [ eq : pmprkv ] ) gives a recursion for the global discretization errors @xmath41 of the form @xmath42 , with amplification matrix and local errors given by @xmath43 with the matrix @xmath44 given by @xmath45 .",
    "the difference between @xmath46 and its counterpart resulting from the implicit trapezoidal rule can be determined from @xmath47 thus , the term @xmath48 represents the difference in local errors between the implicit trapezoidal rule and the mpark2 scheme . for the diagonal matrices",
    ", we have @xmath49 and @xmath50 .",
    "in addition , if we assume @xmath51 then @xmath52 is bounded for @xmath53 , i.e. @xmath54 .",
    "semi - discrete linear advection and linear diffusion a reasonable assumption in the case of the semi - discrete linear advection with @xmath55 $ ] is a time - step choice such that @xmath56 .",
    "then we have @xmath57 due to the smoothness of the implicit euler scheme , it holds that @xmath58 .",
    "hence , the local discretization error of the mpark2 method applied to the semi - discrete linear advection equation with positive initial data is bounded by @xmath59 .",
    "additional assumptions on the smoothness of the initial data are necessary for the semi - discrete linear diffusion equation with @xmath60 $ ] as shown in fig .",
    "[ fig : smooth ] and table [ tab : loc_err ] . as the diagonal matrix @xmath61 in the definition of @xmath62 can be bounded by @xmath63 , a smoothness condition on the exact solution of the type @xmath64 guarantees @xmath65 and hence a local error of third order . the left part of fig .",
    "[ fig : smooth ] depicts the situation for an initial solution @xmath66 which satisfy the smoothness condition . here , the quantities @xmath67 approximate 1 for @xmath68 with @xmath69 .",
    "consequently , the difference between the quantities @xmath70 and @xmath71 is small leading to basically constant smoothness indicators @xmath72 as shown in table [ tab : loc_err ] .",
    "this table also lists the local error in the first mpark2 step . in accordance with the designed order of convergence , this local error behaves as @xmath0 . on the other hand , for an initial solution of @xmath73 , table [ tab : loc_err ] shows an order reduction to about @xmath74 in addition to an increasing value of the indicator @xmath72 . as depicted in fig .",
    "[ fig : smooth ] , this behavior is due the fact that for @xmath75 , we also have @xmath76 .",
    "values at nearby grid points will tend to 1 for @xmath68 while zeros of @xmath67 remain unchanged .",
    "this leads to the boundary layer effect for @xmath76 visible in the right part of fig .",
    "[ fig : smooth ] as well as a locally large difference in curvature between @xmath77 and @xmath71 .",
    ".effect of the smoothness condition ( [ eq : cond_smooth ] ) on the error of consistency for the mpark2 scheme .",
    "[ cols=\"<,^,^,^,^,^,^ \" , ]     ) .,width=283,height=170 ]    ) .,width=283,height=170 ]    so far , these investigations show a local discretization error of order @xmath0 for sufficiently smooth and positive solutions .",
    "this positivity requirement includes thin - layer approaches for the shallow water equations , where a thin film of water is retained also in regions marked as dry .",
    "however , we should remark that for a full convergence analysis , stability has to be proven as well .",
    "this necessitates boundedness of products of amplification matrices @xmath78 which seems to be quite difficult to prove due to the non - linearity of the method .",
    "finally , we also consider a modification to the mpark2 scheme which follows more closely the approach in @xcite .",
    "this modification is based on a direct correction of the explicit part of the implicit trapezoidal rule and reads as @xmath79 with @xmath80 determined by the correction @xmath81 to the quantity @xmath82 which may have negative components .",
    "more precisely , @xmath81 is given by @xmath83 if @xmath84 and @xmath85 otherwise .",
    "we will denote this scheme by mpark2ex . due to this switch in case of vanishing components",
    ", we can not expect an overall second order of convergence as the update reduces to two steps of the implicit euler scheme if @xmath86 .",
    "however , for a test case of an advected wave mimicking wetting and drying , i.e. advection of the initial condition @xmath87 , this method behaves much better than mpark2 as shown in fig .",
    "[ fig : patswe ] .",
    "a comparison of the patankar - type schemes is carried out for the upwind - discretized linear advection on @xmath88 grid points using spatial periodicity up to a final time of @xmath89 . as shown on the left of fig .",
    "[ fig : patswe ] , using a time step of @xmath90 corresponding to a courant number of @xmath91 does not exhibit significant differences of the schemes mpark2 and mpark2ex , also in comparison to the implicit trapezoidal rule .",
    "however , a larger time step of @xmath92 corresponding to a courant number of @xmath93 shows the drawback of mpark2 on the right part of fig .",
    "[ fig : patswe ] .",
    "while mpark2 does not account for the vanishing solution in the interval @xmath94 $ ] and the implicit trapezoidal rule clearly yields negative values , the modified scheme mpark2ex seems to combine the best features of both methods .",
    "the solution is non - negative in the whole computational domain and very accurate in the almost dry regions .",
    "hence , this method seems quite promising and should be further investigated , in particular with respect to its stability .",
    "( left ) and @xmath93 ( right ) .",
    "comparison of mpark2 to mpark2ex.,width=283,height=173 ]     ( left ) and @xmath93 ( right ) .",
    "comparison of mpark2 to mpark2ex.,width=283,height=173 ]",
    "s. ortleb gratefully acknowledges the hospitality of the centrum wiskunde & informatica where this research was partly carried out during her visit in the period of february / march 2016 .",
    "burchard , h. , deleersnijder , e. , meister , a. : a high - order conservative patankar - type discretisation for stiff systems of production - destruction equations .",
    "numer . math . *",
    "47 * , 130 ( 2003 ) patankar , s. v. : _ numerical heat transfer and fluid flow_. series in computational methods in mechanics and thermal sciences , hemisphere pub .",
    "new york , washington , 1980 .",
    "meister , a. , ortleb , s. : on unconditionally positive implicit time integration for the dg scheme applied to shallow water flows , international journal for numerical methods in fluids * 76 * , 6994 ( 2014 )"
  ],
  "abstract_text": [
    "<S> we study the local discretization error of patankar - type runge - kutta methods applied to semi - discrete pdes . for a known two - stage patankar - type scheme the local error in pde sense for linear advection or diffusion </S>",
    "<S> is shown to be of the maximal order @xmath0 for sufficiently smooth and positive exact solutions . however , in a test case mimicking a wetting - drying situation as in the context of shallow water flows , this scheme yields large errors in the drying region . </S>",
    "<S> a more realistic approximation is obtained by a modification of the patankar approach incorporating an explicit testing stage into the implicit trapezoidal rule .    </S>",
    "<S> patankar - type runge - kutta schemes for linear pdes + s.  ortleb , w. hundsdorfer </S>"
  ]
}