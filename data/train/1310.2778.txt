{
  "article_text": [
    "let @xmath7 denote an effective field of characteristic zero , i.e , one can perform arithmetic operations and test equality of two elements ( typically , @xmath8 or @xmath9 , where @xmath10 is an algebraic number ) . given two polynomials @xmath11 in @xmath12 $ ] , we consider the planar polynomial vector field @xmath13 and discuss the problem of computing rational first integrals of , i.e. , rational functions @xmath14 that are constant along the solutions @xmath15 of .",
    "more precisely , the present article is concerned with the following algorithmic problem : + @xmath16 : given a degree bound @xmath17 , either compute a rational first integral @xmath18 of   of total degree at most @xmath2 , or prove that no such @xmath19 exists .",
    "+ this old problem was already studied by darboux in 1878 ( @xcite ) and has been the subject of numerous works ever since . the naive approach ( by indeterminate coefficients )",
    "leads to a polynomial system of quadratic equations in the coefficients of @xmath19 .",
    "other methods use what is called nowadays _ darboux polynomials _ , in the spirit of the celebrated prelle - singer s",
    "method  @xcite ; see subsection  [ review ] for a review .",
    "these methods also require solving a polynomial system of quadratic equations .",
    "recently , chze  @xcite has shown that problem @xmath20 can be solved in polynomial time in  @xmath2 .",
    "the importance of this result is mainly theoretical since the exponent in the polynomial complexity estimate is bigger than  10 .    to improve upon this current state of affairs ,",
    "our starting point is the article @xcite of ferragut and giacomini .",
    "the key observation is that   has a rational first integral if and only if all power series solutions in @xmath21 $ ] of the first order non - linear differential equation @xmath22 are _ algebraic _ over @xmath23 .",
    "furthermore , minimal polynomials of these algebraic power series lead to rational first integrals .",
    "the algorithm in  @xcite still involves solving a polynomial system of quadratic equations .",
    "indeed , the key observation above is merely used to reduce the number of equations in the quadratic system provided by the naive approach .      in the present article ,",
    "we push further the observation of ferragut and giacomini , so as to give fast algorithms solving problem @xmath24 . in particular , we prove that this can be done by considering only systems of _ linear _ equations instead of systems of quadratic equations",
    ".    we design a probabilistic algorithm that uses @xmath0 arithmetic operations in  @xmath7 , where @xmath25 $ ] is the exponent of linear algebra over  @xmath7 , and the soft - o notation @xmath26 indicates that polylogarithmic factors are neglected .",
    "the probabilistic algorithm is then turned into a deterministic one , that solves problem @xmath16 in arithmetic complexity @xmath27 , where @xmath28 denotes the degree of the polynomial vector field .",
    "this compares well to the previous polynomial time algorithm given in  @xcite , which uses at least @xmath29 arithmetic operations .",
    "note that if we take @xmath30 ( i.e. , the cost of naive linear algebra ) , then the above means that the best previously known complexity would be in @xmath31 whereas our deterministic algorithm would use at most @xmath32 arithmetic operations , and our probabilistic one would use @xmath33 .",
    "lastly , we sketch a heuristic method that uses @xmath5 arithmetic operations ( i.e. , @xmath34 using classical linear algebra ) which is sub - cubic , given that the output has size @xmath35 .",
    "we provide algorithmic details , notably precise degree bounds and complexity estimates .",
    "the algorithms developed in the article are implemented in a maple package called rationalfirstintegrals which is available with various examples at http://www.ensil.unilim.fr/~cluzeau/rationalfirstintegrals.html . using this implementation",
    ", we demonstrate the efficiency of our algorithms on some examples .",
    "finally , we show how to apply a similar method to the computation of darboux polynomials .      in section  [ sec :",
    "review ] , we recall darboux s approach to the integrability of polynomial vector fields , related works , and existing results about the problem @xmath16 .",
    "we also give useful facts on the so - called _",
    "spectrum problem_. we recall in section  [ sec : rfi+deq ] the connection between rational first integrals of the polynomial vector field and algebraic power series solutions of @xmath36 .",
    "we then propose a first algorithm , based on linear algebra , that solves problem  @xmath16 . building on this ,",
    "we develop in section  [ section - proba_det_algo ] an efficient probabilistic algorithm , and then turn it into an efficient deterministic algorithm . in section  [ complexity - section",
    "] , we study the arithmetic complexity of the algorithms developed in section  [ section - proba_det_algo ] , and discuss several algorithmic issues",
    ". then , in section  [ sec_impl_exp ] we present our implementation and display its behavior on various examples .",
    "finally , section  [ sec : darboux ] shows how similar ideas can be used for computing the set of all irreducible darboux polynomials ( of a given degree ) of planar polynomial vector fields .",
    "the degree @xmath37 of a bivariate polynomial @xmath38 $ ] is the total degree of @xmath39 . a rational function @xmath40 with @xmath41 $ ]",
    "is said to be _ reduced _ when @xmath39 and @xmath42 are coprime .",
    "the degree @xmath43 of a reduced rational function @xmath44 is the maximum of @xmath37 and @xmath45 .",
    "+ we denote by @xmath46 an algebraic closure of the field  @xmath7 .",
    "+ we write @xmath47 for the usual formal derivative of the  function \" ( polynomial , or power series )  @xmath48 with respect to the variable @xmath49 . + for a set @xmath50 , we denote by @xmath51 its cardinality .",
    "in this section , we recall several useful facts , mainly to keep the exposition as self - contained as possible , and to clarify the understanding of the algorithms that we develop below .",
    "some results are not original .",
    "we consider an autonomous planar polynomial vector field @xmath52 where @xmath53 and @xmath54 are unknown  functions \" of the time variable  @xmath49 , @xmath55 and @xmath56 are polynomials in @xmath12 $ ] , and @xmath57 denotes the degree of the polynomial vector field . without any loss of generality , @xmath55 and",
    "@xmath56 will be assumed to be coprime in the remaining of the article .    to is attached the _ derivation _ @xmath58 acting on the polynomial ring @xmath12 $ ] .",
    "we thus view @xmath12 $ ] as a differential ring endowed with the derivation @xmath59 .",
    "we denote by @xmath60 its field of fractions .",
    "[ def : rfi ] a _ rational first integral of _ is a non - constant rational function @xmath14 satisfying @xmath61 .",
    "a rational first integral @xmath19 of is thus a non - trivial constant for the derivation  @xmath59 .",
    "intuitively , this means that if @xmath15 is a pair of  functions \" satisfying  , then @xmath62 is constant when @xmath49 varies .",
    "we explain in theorem  [ thm11 ] below why no algebraic extension of the base field is necessary in definition  [ def : rfi ] .",
    "a starting observation is that the rational function @xmath44 is a first integral for   if and only if @xmath63 .",
    "therefore , if @xmath19 is a _ reduced _ rational first integral for  , then @xmath39 divides @xmath64 , and @xmath42 divides @xmath65 in @xmath12 $ ] .",
    "this motivates the following definition .",
    "[ def : darboux ] a polynomial @xmath66 \\setminus \\overline\\kk$ ] is a _",
    "darboux polynomial for @xmath59 _ if @xmath67 divides @xmath68 in @xmath69 $ ] .",
    "therefore , if @xmath67 is a darboux polynomial for @xmath59 , then there exists a polynomial @xmath70 $ ] such that @xmath71 .",
    "such a polynomial @xmath70 $ ] is called a _ cofactor associated with the darboux polynomial @xmath67_.    darboux polynomials were introduced by g. darboux in @xcite .",
    "these polynomials correspond to algebraic curves invariant under the vector field .",
    "the following lemma will be used in the sequel : it means that if we have a non - singular initial condition , then there is a unique irreducible invariant algebraic curve satisfying this initial condition , see ( * ? ? ?",
    "* lemma  a.1 ) .",
    "[ lem : uniq ] let @xmath72 be the derivation attached to   and let @xmath73 be a non - singular point of @xmath59 , i.e. , @xmath74 or @xmath75 .",
    "if @xmath76 and @xmath77 are two darboux polynomials for @xmath59 such that @xmath78 and if @xmath76 is irreducible , then @xmath76 divides @xmath77 .",
    "darboux polynomials are sometimes called _ partial first integrals _ in the literature .",
    "the reason is that rational first integrals and darboux polynomials are intimately related notions : as sketched above , numerators and denominators of reduced rational first integrals are darboux polynomials .",
    "the converse is also true , see corollary  [ rfi - darboux ] below .",
    "a fundamental property of darboux polynomials is given in the following lemma ( see , e.g. , ( * ? ? ?",
    "* lemma 8.3 , p. 216 ) ) that can be proved by a straightforward calculation .",
    "[ darboux - semi - group ] let @xmath66 $ ] and let @xmath79 be a factorization of @xmath67 in @xmath69 $ ] , with @xmath76 and @xmath77 coprime .",
    "then , @xmath67 is a darboux polynomial for @xmath59 if and only if @xmath76 and @xmath77 are darboux polynomials for @xmath59 .",
    "furthermore , if @xmath80 and @xmath81 denote respectively the cofactors of @xmath82 and @xmath77 , then @xmath83 .    as a corollary",
    "we get :    [ rfi - darboux ] let @xmath84 be a reduced rational function in @xmath60 . then @xmath19 is a rational first integral of if and only if @xmath39 and @xmath42 are darboux polynomials for  @xmath59 with the same cofactor .",
    "the previous corollary gives a relation between darboux polynomials and rational first integrals .",
    "the next theorem shows that if we have enough darboux polynomials , then we have a rational first integral , see ( * ? ? ?",
    "* appendix ) for a modern proof .",
    "[ thm : darboux][darboux - jouanolou  @xcite ] + if @xmath28 , then the polynomial vector field has a reduced rational first integral @xmath40 if and only if @xmath59 has at least @xmath85 irreducible darboux polynomials . in this case",
    ", @xmath59 has infinitely many irreducible darboux polynomials and any of them divides a linear combination @xmath86 , for some @xmath87 not both zero .",
    "moreover , all but finitely many irreducible darboux polynomials are of the form @xmath88 and have the same degree .    a useful corollary of theorem  [ thm : darboux ] is the following , see @xcite :    [ degre - fini ] for each planar polynomial vector field , there exists a non - negative integer @xmath89 such that any _ irreducible _ darboux polynomial for the derivation @xmath59 attached to   has degree at most @xmath89 .",
    "given a derivation @xmath59 , the problem of finding a bound for the degree of irreducible darboux polynomials is known to be difficult : this is the so - called _",
    "poincar problem_. it has been deeply studied in the literature and many partial results exist ( @xcite and others ) though the question is not fully solved yet .",
    "the fact that the derivation @xmath90 with @xmath91 admits @xmath92 as an irreducible darboux polynomial shows that a bound depending only on the degrees of the entries can not exist : arithmetic conditions on the coefficients of @xmath59 have to be taken into account as well .",
    "+ consequently , given a planar polynomial vector field , or equivalently a derivation @xmath59 , two distinct problems occur when we want to compute rational first integrals :    1 .",
    "find a bound on the degree of the numerator and denominator of a rational first integral , that is a bound on the degree of irreducible darboux polynomials ; 2 .",
    "@xmath16 : given a degree bound @xmath17 , either compute a rational first integral @xmath18 of of total degree at most @xmath2 , or prove that no such @xmath19 exists .",
    "our aim is to give an efficient algorithm to handle the second problem @xmath16 .",
    "+ in this article we suppose that @xmath3 .",
    "this hypothesis is natural because if a derivation has a polynomial first integral of degree @xmath2 , then we can show that @xmath93 , see ( * ? ? ? * theorem 6 ) or @xcite .",
    "we recall here the definition of _ composite _ rational functions and what is called the _ spectrum _ of a rational function .",
    "we then use these notions to describe the kernel of the derivation @xmath94 and to give some of its properties .",
    "a rational function @xmath95 is _ composite _ if it can be written @xmath96 , i.e. , @xmath97 , where @xmath98 and @xmath99 with @xmath100 .",
    "otherwise @xmath19 is said to be _ non - composite_.    in @xcite , the authors propose different algorithms for the decomposition of rational functions using properties of darboux polynomials and rational first integrals of the jacobian derivation .",
    "[ lem : rfi - alg ] the set of all rational first integrals of is a @xmath7-algebra .",
    "it is closed under composition with rational functions in @xmath101 , and moreover , @xmath19 is a rational first integral of if and only if @xmath102 is a rational first integral of for some @xmath103    the first assertion directly follows from the fact that the derivation + @xmath72 is @xmath7-linear and satisfies leibniz s rule @xmath104 the second assertion follows from the equality @xmath105 and the fact that @xmath106 is zero if and only if @xmath107 .    a more precise version of lemma  [ lem : rfi - alg ] is given by the next theorem which completely describes the @xmath7-algebra structure of the set of all rational first integrals of .",
    "this theorem seems to be a folklore result but we have not found a suitable reference .",
    "consequently , a complete proof is provided here .",
    "[ thm : rfi - struct ] let @xmath59 be the derivation attached with",
    ". then we have : @xmath108 for some non - composite reduced rational first integral @xmath19 of .",
    "+ then any other rational first integral @xmath109 of is of the form @xmath110 for some @xmath103 in particular , any two non - composite reduced rational first integrals are equal , up to a homography .",
    "let @xmath111 .",
    "we have @xmath112 , so , from ( * ? ? ?",
    "* theorem 1 , p. 12 ) , we deduce that @xmath113 is finitely generated over @xmath7 and that @xmath114 for some @xmath115 .",
    "+ as for @xmath116 , @xmath117 , we get that : @xmath118 the jacobian criterion implies that @xmath119 are algebraically dependent and thus the transcendence degree of @xmath113 over @xmath7 is equal to one . by the extended luroth s theorem , see ( * ? ? ?",
    "* theorem 3 , p. 15 ) , we get @xmath120 , for @xmath121 .",
    "in particular , @xmath19 is a rational first integral of .",
    "+ now , if @xmath19 is composite , @xmath122 , with @xmath123 , then , see , e.g. , ( * ? ? ?",
    "* proposition 2.2 ) . by lemma [ lem : rfi - alg ]",
    ", @xmath124 is also a rational first integral of so that @xmath125 and @xmath126 .",
    "this yields @xmath127 , which is absurd .",
    "thus @xmath19 is non - composite which gives the desired result .    as a consequence of theorem  [ thm : rfi - struct ] ,",
    "_ non - composite reduced _ rational first integrals coincide with rational first integrals with minimal degree ; they will play a key role in the remaining of this text .",
    "+ in definition  [ def : rfi ] , we have defined rational first integrals as elements of @xmath60 .",
    "the next theorem explains why it is in general not necessary to consider rational first integrals in @xmath128 . to our knowledge",
    "this result is proved here for the first time . in @xcite ,",
    "the authors show that if there exists a rational first integral in @xmath128 , then there also exists a rational first integral in @xmath60 .",
    "we improve this result by taking into account the degrees of these rational first integrals .",
    "[ thm11 ] if admits a non - composite rational first integral in @xmath128 , then it admits a non - composite rational first integral in @xmath60 with the same degree .",
    "let @xmath129 be a non - composite rational first integral of .",
    "we denote by @xmath130 the product @xmath131 where @xmath109 is the galois group over @xmath7 of the smallest galois extension containing all the coefficients of @xmath48 , and we have @xmath132 . as @xmath133 ,",
    "@xmath130 is also a rational first integral of .",
    "thus , by lemma  [ lem : rfi - alg ] , there exists a non - composite rational first integral @xmath121 of .",
    "now , applying theorem  [ thm : rfi - struct ] with ground field @xmath46 instead of @xmath7 , we get that @xmath134 , with @xmath135 .",
    "furthermore , by ( * ? ? ?",
    "* theorem 13 ) , @xmath19 is non - composite in @xmath60 implies that @xmath19 is non - composite in @xmath128 .",
    "it thus follows that @xmath136 so that @xmath137 .",
    "now , we introduce the _ spectrum _ of a rational function which will play a crucial role in our algorithms .",
    "let @xmath138 be a reduced rational function of degree @xmath2 .",
    "the set @xmath139 , \\\\ & & \\textrm { or } \\deg ( \\lambda \\ , p - \\mu \\ , q ) < n\\}\\end{aligned}\\ ] ] is called the _ spectrum _ of @xmath40 .    in the context of rational first integrals of polynomial vector fields ,",
    "the elements of the spectrum are sometimes called _ remarkable values _ , see , e.g. , @xcite .",
    "there exists a vast bibliography about the spectrum , see for example @xcite .",
    "+ the spectrum @xmath140 is finite if and only if @xmath40 is non - composite and if and only if the pencil of algebraic curves @xmath141 has an irreducible general element , see for instance ( * ? ? ?",
    "* chapitre 2 , thorme 3.4.6 ) or ( * ? ? ?",
    "* theorem 2.2 ) for detailed proofs .    to the authors knowledge , the first effective result on the spectrum is due to poincar . in  @xcite",
    ", he establishes a relation between the number of _ saddle points _ and the cardinal of the associated spectrum , in the case where all the singular points of the polynomial vector field are distinct .",
    "in particular this yields the bound @xmath142 on the cardinality of the spectrum .",
    "this bound was improved recently in @xcite :    [ bornespectre ] let @xmath59 be the derivation attached with and @xmath143 denotes the degree of .",
    "if @xmath40 is a reduced non - composite rational first integral of , then : @xmath144    as a consequence of theorem  [ bornespectre ] and corollary  [ rfi - darboux ] , if @xmath40 is a reduced non - composite rational first integral of , then for all but @xmath145 constants @xmath146 , the polynomial @xmath147 has degree  @xmath2 and is an irreducible darboux polynomial for @xmath59 with the same cofactor as @xmath39 and  @xmath42 .",
    "this means that if has a rational first integral , there exist an infinite number of irreducible darboux polynomials which all have the same degree ( and the same cofactor ) .",
    "+ the following lemma will be useful in section  [ section - proba_det_algo ] for the study of our probabilistic and deterministic algorithms .",
    "[ lem : remarkable_values ] if @xmath148 is a reduced non - composite rational function of degree at most  @xmath2 , then the number of values of @xmath149 for which @xmath150 belongs to @xmath140 is bounded by @xmath151 .",
    "let @xmath149 be such that @xmath152 . by theorem  [ bornespectre ]",
    ", @xmath140 contains at most @xmath145 elements .",
    "now , for each @xmath153 , as @xmath39 and @xmath42 are of degree at most @xmath2 , there exist at most @xmath2 values of @xmath154 such that @xmath155 .",
    "this ends the proof .",
    "there is a vast literature regarding the computation of rational or elementary first integrals ( see for example @xcite ) and darboux polynomials ( see for example @xcite ) .",
    "note that , among these articles , very few restrict to the specific question of rational first integrals .",
    "surveys on computing first integrals ( not restricted to planar systems ) can be found for example in @xcite and @xcite for symmetry methods which we do not address here .    given a degree bound  @xmath2 ,",
    "the _ naive _ approach to solve @xmath24 consists in using the method of undetermined coefficients .",
    "this leads to a system of polynomial ( quadratic ) equations in the unknown coefficients of the rational first integral , see @xcite for a complexity estimate of this approach .",
    "+ interest in darboux polynomials has been revived by the appearance of the prelle - singer s method , @xcite . in @xcite ,",
    "coutinho and menasch schechter give necessary conditions for the existence of darboux polynomials .",
    "other necessary conditions are contained in @xcite and also in works on inverse integrating factors @xcite .",
    "the bottleneck of the prelle - singer s method and all of its variants is the computation _ by undetermined coefficients _ of all irreducible darboux polynomials of bounded degree , which leads again to solving a polynomial system .",
    "this yields an exponential complexity algorithm , see @xcite .",
    "+ in @xcite , chze shows that if the derivation  @xmath59 admits only finitely many irreducible darboux polynomials of degree at most @xmath2 , then it is possible to compute all of them by using the so - called _ ecstatic curve _ introduced in @xcite within a number of _ binary operations _ that is _ polynomial _ in the bound  @xmath2 , in the degree @xmath28 of @xmath59 and in the logarithm of the height of @xmath55 and @xmath56 .",
    "a nontrivial modification of this algorithm provides a polynomial - time method to solve @xmath16 , see again @xcite . to our knowledge , this is the first algorithm solving  @xmath16 in polynomial - time .",
    "unfortunately , the exponent is quite large , making the algorithm unpractical even for moderate values of  @xmath2 .",
    "this drawback is due to the fact that algorithm in  @xcite needs to compute the irreducible factors of a bivariate polynomial of degree @xmath156 , and the best known algorithms for solving this subtask have arithmetic complexity , e.g. , @xmath157 , see @xcite .",
    "+ last , we mention the article @xcite of ferragut and giacomini , where the algebraicity of a generic power series solution of the differential equation @xmath36 is used to improve the efficiency of the naive algorithm . precisely , the system of quadratic equations yielding the coefficients of a rational first integral is reduced to a simpler system of ( still quadratic ) equations .",
    "although this gives a good heuristic improvement on the naive method , we show in the present article how to turn it into a fast algorithm . starting from the link between and @xmath36 , we reduce @xmath16 to solving a system of _ linear _ equations . furthermore , we give tight bound on the number of terms of power series solutions of @xmath36 that are sufficient to detect the existence of rational first integrals and to compute one of them when it exists .",
    "this enables us to turn the heuristic in  @xcite into an algorithm with polynomial complexity , that is more efficient both in theory and in practice than all previous algorithms , see section  [ sec_impl_exp ] .",
    "a formal power series @xmath158 $ ] is said to be _ algebraic _ if it is algebraic over @xmath23 , that is , if there exists a non - zero polynomial @xmath159 $ ] such that @xmath160 . an irreducible polynomial @xmath159 $ ] satisfying @xmath160 is called a _ minimal polynomial of @xmath161 _ in @xmath12 $ ] .    with the planar polynomial vector field ,",
    "we associate the first order non - linear differential equation : @xmath162    we may assume without any loss of generality that @xmath53 does not divide @xmath55 , i.e. , @xmath163 .",
    "we will explain how we can reduce to this situation and study the complexity of this reduction in subsection  [ subsec : regular ] .",
    "+ then , the formal version of the cauchy - lipschitz theorem for non - linear ( first - order ) differential equations ensures that for any @xmath164 such that @xmath165 , the equation admits a unique power series solution @xmath166 $ ] satisfying @xmath167 .",
    "note that high - order truncations of the power series @xmath168 can be computed efficiently using the algorithm of brent and kung   @xcite .",
    "+ the following standard result is fundamental to both our method and the one of ferragut and giacomini in @xcite .",
    "[ lem_alg ] consider the planar polynomial vector field and assume that @xmath169 .",
    "let @xmath164 satisfy @xmath165 and @xmath170 $ ] be the unique power series solution of such that @xmath167 .    1 .",
    "if admits a non - composite rational first integral @xmath40 , then the power series @xmath168 is algebraic .",
    "more precisely , @xmath171 is a root of the non - zero polynomial @xmath172 , where @xmath173 and @xmath174 .",
    "2 .   if @xmath40 is a reduced non - composite rational first integral of of degree at most @xmath2 , then , for all but at most @xmath175 values of @xmath176 , the polynomial @xmath172 , where @xmath173 and @xmath174 is a minimal polynomial of @xmath168 .    let @xmath84 be a non - composite rational first integral of .",
    "since the spectrum @xmath140 is finite , we can suppose that @xmath39 and @xmath42 are irreducible and coprime .",
    "let us first show that @xmath177 or @xmath178 . as @xmath179 is a non - singular point of @xmath59 , if @xmath180 , then lemma [ lem : uniq ] implies that @xmath181 with @xmath182 . as @xmath39 and @xmath42 are coprime , we get a contradiction so that necessarily @xmath177 or @xmath178 .",
    "+ we thus suppose @xmath183 else we consider the rational first integral @xmath184 instead of @xmath40 . as @xmath183 ,",
    "the power series @xmath185 is invertible so that @xmath61 yields @xmath186 .",
    "the latter equality can be written @xmath187 dividing the equality by the invertible power series @xmath188 and using the fact that @xmath168 is a solution of , we obtain @xmath189 it follows that @xmath190 , for some @xmath191 .",
    "consequently , we have @xmath192 with @xmath193 which proves  ( 1 ) .",
    "+ if , in addition , @xmath44 is reduced non - composite of degree at most @xmath2 , then ( 2 ) follows directly from lemma  [ lem : remarkable_values ] .",
    "proposition  [ lem_alg ] shows in particular that if has a rational first integral @xmath40 , then all power series solutions of are algebraic .",
    "the next proposition which is well known ( see @xcite ) asserts that the converse is also true .",
    "[ rfi - darboux - diffeq ] let be a planar polynomial vector field , @xmath59 the associated derivation , and be the associated differential equation .    1 .",
    "if @xmath159 $ ] is an irreducible darboux polynomial for  @xmath59 , then all roots @xmath194 of @xmath67 such that @xmath195 are power series solutions of  .",
    "2 .   the minimal polynomial of an algebraic solution @xmath196 $ ] of such",
    "that @xmath195 is a darboux polynomial for @xmath59 .",
    "3 .   admits a rational first integral if and only if all the power series solutions of are algebraic .",
    "assume first that @xmath159 $ ] is an irreducible darboux polynomial for @xmath59 , and that @xmath197 is a root of @xmath67 , i.e. , @xmath160 .",
    "since @xmath67 divides @xmath68 , it follows that @xmath161 is also a root of @xmath68 .",
    "this implies @xmath198 on the other hand , @xmath160 implies by differentiation with respect to @xmath53 that @xmath199 these two equalities provides @xmath200 as @xmath67 is irreducible , @xmath201 so that @xmath161 is a solution of . as mentioned before @xmath195 implies @xmath158 $ ] ( cauchy - lipschitz theorem ) which proves  ( 1 ) .",
    "assume now that @xmath196 $ ] is an algebraic solution of such that + @xmath195 , and let @xmath67 be its minimal polynomial .",
    "then @xmath202 and since @xmath161 is a solution of , the latter equality implies that @xmath161 is also a root of @xmath68 .",
    "now as @xmath67 is the minimal polynomial of @xmath161 , it follows that @xmath67 divides @xmath68 , i.e. , @xmath67 is a darboux polynomial for @xmath59 and we have proved  ( 2 ) .",
    "let us now prove ( 3 ) .",
    "if all the power series solutions of are algebraic , then by ( 2 ) , @xmath59 admits infinitely many darboux polynomials",
    ". then theorem  [ thm : darboux ] shows that admits a rational first integral .",
    "the proof ends here since the other implication of ( 3 ) has been proved in proposition  [ lem_alg ] .",
    "we have seen in proposition  [ lem_alg ] that if @xmath40 is a reduced non - composite rational first integral of , then a minimal polynomial of a power series solution of is generically of the form @xmath203 for some constants @xmath204 and @xmath205 .",
    "thus , if we are able to compute such a minimal polynomial , we can deduce the rational first integral @xmath40 . in practice",
    ", we do not compute a power series @xmath166 $ ] solution of but only a truncation of @xmath168 , i.e. , a finite number of terms of its expansion on the monomial basis . given a degree bound @xmath2 for the rational first integral that we are searching for",
    ", the following lemma shows that computing @xmath206 , i.e. , the first @xmath207 terms of its expansion , is enough for our purposes .",
    "such an analysis of the needed precision for the power series solutions of that we compute is not included in @xcite . note that this kind of strategy was already used in a polynomial factorization setting ( see , e.g. , @xcite ) and in a differential equations setting ( see @xcite ) .",
    "the next lemma is a small improvement of ( * ? ? ?",
    "* lemma 2.4 ) .",
    "[ algebraic - solution ] let @xmath113 be a field of characteristic @xmath208 such that @xmath209 .",
    "let @xmath210 $ ] denote an algebraic power series whose minimal polynomial @xmath211 $ ] has degree at most @xmath2 .",
    "if @xmath212 $ ] is a polynomial of degree at most @xmath2 satisfying @xmath213 then @xmath214 . moreover , if @xmath215 has minimal degree in @xmath54 among polynomials satisfying @xmath216 , then @xmath217 for some @xmath218 $ ] .    by definition , @xmath67 satisfies @xmath216 so there exists @xmath212 $ ] of degree at most  @xmath2 satisfying @xmath216 .",
    "let @xmath215 be such a solution of @xmath216 and consider @xmath219 the resultant of @xmath67 and @xmath215 with respect to @xmath54 . as there exist polynomials @xmath220 and @xmath221 in @xmath12 $ ] such that @xmath222 , relation @xmath216 yields @xmath223 . by bzout s theorem",
    ", we have @xmath224 , thus @xmath225 .",
    "this implies that @xmath67 and @xmath215 have a non - trivial common factor .",
    "now , as @xmath67 is irreducible , necessarily @xmath67 divides @xmath215 and thus @xmath214 . finally , if @xmath215 is supposed to have minimal degree in @xmath54 among polynomials satisfying @xmath216 , we have necessarily @xmath226 for some @xmath227 $ ] which ends the proof .",
    "note that in @xmath216 , the power series @xmath228 can be replaced by its truncation @xmath229 .",
    "[ rmk : basis ] for a given power series @xmath228 , computing all the polynomials @xmath215 of degree at most @xmath2 satisfying @xmath216 can be done by taking an ansatz for @xmath215 and performing linear algebra calculations ( e.g. , solving a system of linear equations ) . consequently , computing  all \" solutions of @xmath216 means computing  a basis \" of solutions of the linear algebra problem associated with @xmath216 .",
    "an efficient method to address this problem and to get , via a row - echelon form , a solution of @xmath216 with minimal degree in @xmath54 is given in subsection  [ complexity - section - min - poly ] where a complexity analysis is provided .",
    "in the sequel , we say that @xmath215 is a _ minimal solution of @xmath216 _ if it is a solution of @xmath216 with minimal degree in @xmath54 .",
    "we now propose a first algorithm , based on linear algebra , for solving @xmath16 .",
    "more efficient algorithms , based on this one , are given in section [ section - proba_det_algo ] .",
    "the strategy of this algorithm is then used in section  [ sec : darboux ] for computing darboux polynomials .",
    "+   + ` input:`@xmath230 $ ] s.t .",
    "@xmath169 and a bound @xmath231 .",
    "+ ` output : ` a non - composite rational first integral of of degree at most  @xmath2 , or  none \" .",
    "[ gen_step1 ] for an indeterminate @xmath154 , compute the polynomial @xmath232 $ ] of degree at most @xmath233 s.t . @xmath167 and @xmath234 .",
    "[ gen_step2 ] compute all , see remark [ rmk : basis ] . ] non - trivial polynomials @xmath235 $ ] of degree @xmath236 s.t .",
    "@xmath237 if no such @xmath215 exists , then return  none \" .",
    "else , among the solutions of @xmath216 , pick a _ minimal _",
    "solution @xmath238[x , y]$ ] .",
    "[ gen_step3 ] let @xmath67 denote the primitive part of @xmath239 relatively to @xmath54 .",
    "+ set @xmath240 .",
    "+ pick any @xmath241 s.t . @xmath242 and set @xmath243 .",
    "[ gen_step4 ] if @xmath244 , then return @xmath40 .",
    "else return `` none '' .",
    "+    in the above algorithm , the output ",
    "none \" means that there is no rational first integral of degree at most @xmath2 but it may exist a rational first integral of degree strictly greater than @xmath2 .",
    "[ theorem - generic ] algorithm is correct : either it finds a non - composite rational first integral of of degree at most @xmath2 if it exists , or it proves that no such rational first integral exists .    to prove theorem [ theorem - generic ]",
    ", we shall need the following lemma .",
    "[ sigma_non_constant ] consider the planar polynomial vector field and assume that @xmath169 .",
    "if @xmath19 is a reduced rational first integral of , then @xmath245    let @xmath44 be a reduced rational first integral of .",
    "proceeding by contradiction , we assume @xmath246 .",
    "then @xmath247 so that @xmath53 divides @xmath248",
    ". now , from corollary  [ rfi - darboux ] , @xmath248 is a darboux polynomial for @xmath59 and thus , by lemma [ darboux - semi - group ] , @xmath53 is also a darboux polynomial for @xmath59 .",
    "consequently , we get that @xmath53 divides @xmath249 and thus @xmath250 .",
    "this is absurd so we conclude .",
    "suppose first that there exists a rational first integral of of degree at most @xmath2 .",
    "then , without loss of generality , we can consider a reduced non - composite one @xmath251 , see lemma  [ lem : rfi - alg ] .",
    "let @xmath252 $ ] be the power series solution of satisfying @xmath167 . by proposition  [ lem_alg ] ,",
    "@xmath253 is a root of , where @xmath254 and @xmath255 . as @xmath251 is non - composite",
    ", it follows that @xmath256 is irreducible in @xmath257 $ ] . indeed , by lemma  [ sigma_non_constant ]",
    ", the constant @xmath258 belongs to @xmath259 and thus , from lemma  [ lem : remarkable_values ] , we can find @xmath260 such that @xmath261 .",
    "consequently @xmath262 is a minimal polynomial of @xmath253 . in step  ( [ gen_step1 ] ) ,",
    "we compute the first @xmath207 terms of @xmath253 .",
    "now , in step  ( [ gen_step2 ] ) , if there exists a solution @xmath263 $ ] of @xmath216 of degree at most @xmath2 , then , lemma [ algebraic - solution ] applied with @xmath264 implies that @xmath265 with @xmath266 $ ] , where @xmath238[x , y]$ ] is defined in step ( [ gen_step2 ] ) . therefore ,",
    "taking the primitive part of @xmath239 with respect to @xmath54 , in step  ( [ gen_step3 ] ) , we have @xmath267 for some @xmath268 $ ] .",
    "now , if @xmath39 and @xmath42 denote the polynomials defined in step  ( [ gen_step3 ] ) of the algorithm , we necessarily have : @xmath269 as @xmath251 is a non - composite rational first integral , we deduce that @xmath40 is also a non - composite rational first integral . thus , we have @xmath270 in step  ( [ gen_step4 ] ) and the algorithm returns a correct output . +",
    "now suppose that has no rational first integral of degree at most @xmath2 . in step ( [ gen_step4 ] ) ,",
    "the test @xmath270 guarantees to return a correct output . in step  ( [ gen_step2 ] )",
    ", we can have an early detection of this situation .",
    "indeed by proposition  [ lem_alg ] , if @xmath216 has no non - trivial solution , then we deduce that has no rational first integral of degree at most @xmath2 .",
    "this algorithm fits the first part of our goal as it is entirely based on linear operations : we do not need to solve quadratic equations ( see section  [ complexity - section ] ) .",
    "however , it is not yet very efficient in practice because computations are done over @xmath271 .",
    "for example , in the first step , a direct calculation shows that , for @xmath272 , the coefficient of @xmath273 in the power series solution @xmath253 of satisfying @xmath167 is generically a rational function in @xmath154 of degree @xmath274 , whose denominator is generically @xmath275 . in what follows ,",
    "we accelerate things by using only computations over @xmath7 instead of computations in @xmath271 .",
    "in this section , we present an efficient probabilistic algorithm of las vegas type for solving @xmath16 . the approach is similar to the one used in the previous section .",
    "+   + ` input:`@xmath276 $ ] s.t .",
    "@xmath169 , two elements @xmath277 s.t .",
    "@xmath278 for @xmath279 , and a bound @xmath231 .",
    "+ ` output : ` a non - composite rational first integral of of degree at most @xmath2 ,  none \" or `` i do nt know ''",
    ". +    1 .",
    "[ step_proba_1 ] for @xmath280 do : + * [ step_1a ] compute @xmath281 $ ] of degree at most @xmath282 s.t .",
    "@xmath283 , and + @xmath284 . + * [ step_1b ] compute all non - trivial polynomials @xmath285 $ ] of degree @xmath236 s.t . @xmath286",
    "* [ step_1c ] if no such @xmath287 exists , then return `` none '' .",
    "+ else let @xmath288 $ ] be the primitive part relatively to @xmath54 of a minimal solution of @xmath216 . + * if @xmath289 , then while ( @xmath290 or @xmath291 ) do @xmath292 . + 2 .",
    "[ step - proba-4]if @xmath293 , then return @xmath294 .",
    "else return [ `` i do nt know'',@xmath295 $ ] ] .",
    "[ theorem - probabilistic ] algorithm terminates and satisfies the following properties :    * if it returns @xmath294 , then it is a non - composite rational first integral of of degree at most @xmath2 . *",
    "if it returns `` none '' , then there is no rational first integral of of degree at most @xmath2 . *",
    "if admits a non - composite rational first integral @xmath40 of degree at most @xmath2 and @xmath296 for @xmath279 , then the algorithm returns a non - composite rational first integral of of degree at most @xmath2 .",
    "let us first prove that the algorithm terminates .",
    "this follows directly from the fact that the loop in step ( 1d ) terminates after at most @xmath297 steps .",
    "indeed , we just have to avoid the roots of the product @xmath298 which a univariate polynomial of degree less than @xmath299 .",
    "it thus remains to check that it is a non - zero polynomial , i.e. , @xmath300 .",
    "if @xmath301 , then @xmath53 divides @xmath76 . as @xmath76 is the primitive part with respect to @xmath54 of a minimal solution of @xmath216 , this would imply that @xmath302 and thus @xmath303 which is a contradiction .",
    "+ now , if the algorithm returns @xmath294 , then the test in step ( 2 ) ensures that @xmath304 and , by construction , @xmath294 is clearly of degree at most @xmath2 .",
    "furthermore , @xmath294 is non - composite . indeed ,",
    "if @xmath294 is composite , then at least one of the @xmath305 s is reducible and thus it can not be the primitive part with respect to @xmath54 of a minimal solution of @xmath216 .",
    "finally step ( 1d ) certifies that @xmath306 .",
    "indeed , @xmath77 satisfies @xmath307 , thus if @xmath308 with @xmath309 , then either @xmath310 or @xmath290 which is not possible thanks to step ( 1d ) .",
    "we have then proved that @xmath294 is a non - composite rational first integral of of degree at most @xmath2 .",
    "+ if the algorithm returns `` none '' in step ( 1c ) , then by proposition  [ lem_alg ] , has no rational first integral of degree at most @xmath2 .",
    "+ assume finally that admits a non - composite rational first integral @xmath40 of degree at most @xmath2 and that @xmath296 for @xmath279 .",
    "then the same strategy as the one used in the proof of theorem  [ theorem - generic ] shows that our algorithm returns a non - composite rational first integral of . +    let @xmath50 be a ( finite ) subset of @xmath7 of cardinal @xmath311 greater than @xmath175 and assume that , in algorithm , @xmath312 and @xmath313 are chosen independently and uniformly at random in @xmath50 .",
    "then , if admits a rational first integral of degree at most @xmath2 , algorithm returns a non - composite rational first integral of of degree at most  @xmath2 with probability at least @xmath314 .",
    "it is a straightforward application of lemma  [ lem : remarkable_values ] , theorem  [ theorem - probabilistic ] and zippel - schwartz s lemma ( see ( * ? ? ?",
    "* lemma 6.44 ) ) .",
    "in fact , the  practical \" probability will be much better .",
    "indeed , the elements @xmath315 of the spectrum may be rational or algebraic and hence , the constants @xmath154 such that @xmath316 will generally be algebraic .",
    "so , if the @xmath317 s are chosen to be rational in the input , then the  bad \" values of the @xmath317 s will generally be in very small number .",
    "this fact is widely confirmed by experiments .",
    "+ now , we study all the different situations that can occur and the corresponding output given by the algorithm :    1 .",
    "has a non - composite rational first integral @xmath40 of degree at most @xmath2 . 1 .",
    "if @xmath318 , and @xmath319 then in this situation the algorithm returns a non - composite rational first integral .",
    "2 .   now , we study the opposite situation : @xmath320 or @xmath321 . if the algorithm computes @xmath76 and @xmath77 but @xmath294 is not a rational first integral , then it returns  i do nt know \" . a first example where this case is encountered is given in subsection  [ subsec : probaex ] .",
    "furthermore , we may be unlucky enough to choose two bad values of the @xmath317 s , i.e. , for @xmath279 .",
    "for example if we consider @xmath322 then has a non - composite rational first integral @xmath40 of degree @xmath323 , where @xmath324 and @xmath325 .",
    "but if we choose @xmath326 and @xmath327 , then we will construct two darboux polynomials @xmath328 and @xmath329 of degree only @xmath330 that are minimal polynomials of @xmath331 and @xmath332 . as @xmath333 is strictly smaller than @xmath334",
    ", we obtain @xmath335 and the algorithm returns ",
    "i do nt know \" .",
    "2 .   does not have a rational first integral with degree at most @xmath2",
    "if @xmath216 has no non - trivial solutions , then the algorithm returns  none \" .",
    "if @xmath216 has non - trivial solutions , then the algorithm returns  i do nt know \" . this situation can occur for example when : * has no rational first integral but it has darboux polynomials and the choice of @xmath312 and @xmath313 gives two darboux polynomials . for an example of a derivation without rational first integral but with darboux polynomials , see ( *",
    "* remark 15 ) .",
    "* has a rational first integral with degree bigger than the given bound @xmath2 .",
    "+ for example , consider the derivation @xmath336 and the degree bound @xmath337 .",
    "in this situation , the differential equation is @xmath338 which admits @xmath339 as solution .",
    "we set @xmath340 , and then @xmath341 gives @xmath342 .",
    "however , @xmath343 , thus @xmath168 is not a root of @xmath67 . here",
    "@xmath94 admits the rational first integral @xmath344 so if we set @xmath345 in the input , our algorithm returns a non - composite rational first integral of degree @xmath323 . in this case",
    "we compute @xmath346 .    the bivariate polynomials @xmath287",
    "s computed in step  ( 1b ) have total degree at most @xmath2 so they have coefficients .",
    "note that , if we assume @xmath347 , then we have @xmath348 .",
    "it is tempting to try to compute the @xmath287 s using only , say , @xmath349 terms of the power series .",
    "this will make the computation a little bit faster , but then the method becomes only a nice heuristic and may fail .",
    "algorithm is now turned into a deterministic algorithm .",
    "the idea is that if a rational first integral with degree at most @xmath2 exists then , if we run at most @xmath350 times , we will get a non - composite rational first integral of degree at most @xmath2 .",
    "+   + ` input:`@xmath276 $ ] s.t .",
    "@xmath163 and a bound @xmath231 .",
    "+ ` output : ` a non - composite rational first integral of of degree @xmath236 or  none \" .",
    "let @xmath351 .",
    "+ 2 .   while @xmath352 do [ det - step2 ] + 1 .",
    "choose two random elements @xmath353 s.t .",
    "@xmath354 and for @xmath279 .",
    "2 .   @xmath355 .",
    "3 .   if @xmath356none \" , then return  none \" .",
    "4 .   else if @xmath356[``i do nt know'',@xmath357 $ ] ] , then @xmath358 and go to step  ( [ det - step2 ] ) . 5 .",
    "[ det - step4 ] else return @xmath19 .",
    "return `` none '' .",
    "[ correct_detalgo ] algorithm is correct : it returns a rational first integral of degree at most @xmath2 if and only if it exists , and it returns `` none '' if and only if there is no rational first integral of degree at most @xmath2 .",
    "assume that has a non - composite rational first integral @xmath40 with degree at most @xmath2 .",
    "if @xmath356``i do nt know '' in step ( [ det - step2 ] ) , then from theorem  [ theorem - probabilistic ] , at least one of the @xmath317 s satisfies @xmath359 .",
    "the number of such  bad \" values of the @xmath317 s is bounded by @xmath175 by lemma [ lem : remarkable_values ] .",
    "hence if we repeat at least @xmath350 times , then we will get a good pair @xmath360 and by theorem  [ theorem - probabilistic ] , the probabilistic algorithm will then return a non - composite rational first integral of degree at most @xmath2 .",
    "+ now assume that has no rational first integral of degree at most @xmath2 . then by theorem [ theorem - probabilistic ] , returns",
    " none \" or  i do nt know \" .",
    "+ if in step  ( [ det - step2 ] ) , @xmath19=none \" , then we have a correct output . now",
    "if @xmath19=i do nt know \" , then the algorithm uses again with new values of the @xmath317 s and , after at most @xmath361 trials , it returns  none \" which is the correct output .",
    "in this section , we describe how the different steps of algorithms and can be performed efficiently and we study their arithmetic complexities . for the complexity issues , we focus on the dependency on the degree bound @xmath2 and we recall that we assume that @xmath362 , where @xmath28 denotes the degree of the polynomial vector field . more precisely , we suppose that @xmath143 is fixed and @xmath2 tends to infinity .",
    "+ all the complexity estimates are given in terms of arithmetic operations in @xmath7 .",
    "we use the notation @xmath363 : roughly speaking , it means that @xmath48 is in @xmath364 for some @xmath365 . for a precise definition , see ( * ? ? ?",
    "* definition 25.8 ) .",
    "we suppose that the fast fourier transform can be used so that two univariate polynomials with coefficients in @xmath7 and degree bounded by @xmath366 can be multiplied in @xmath367 , see @xcite .",
    "we further assume that two matrices of size @xmath368 with entries in @xmath7 can be multiplied using @xmath369 , where @xmath370 is the matrix multiplication exponent , see ( * ? ? ?",
    "we also recall that a basis of solutions of a linear system composed of @xmath371 equations and @xmath372 unknowns over @xmath7 can be computed using @xmath373 operations in @xmath7 , see ( * ? ? ?",
    "* chapter 2 ) .      in the algorithms given in the previous sections , we have to choose a regular point for the differential equation , i.e. , a point @xmath374 satisfying @xmath375 . to achieve this",
    ", we can start from the point @xmath376 , evaluate @xmath249 at @xmath377 .",
    "if @xmath375 , then we are done .",
    "else , we shift @xmath374 by one to get @xmath378 and we iterate the process .",
    "note that the number of iterations is at most @xmath143 .",
    "consequently , this step can be performed by evaluating @xmath143 polynomials ( namely the coefficients of @xmath249 viewed as polynomials in the variable @xmath54 ) of degree bounded by @xmath143 at @xmath143 points ( @xmath379 ) .",
    "this can thus be done in @xmath380 arithmetic operations , see ( * ? ? ?",
    "* corollary 10.8 ) .",
    "this is why , in our algorithms , we always suppose , at neglectable cost and without loss of generality , that @xmath163 .      in step  ( [ step_proba_1 ] ) of the algorithm , we compute the @xmath207 first terms of the power series solution of satisfying a given initial condition . using the result of brent and kung ( see ( * ? ? ?",
    "* theorem 5.1 ) ) based on formal newton iteration , this can be done using @xmath381 arithmetic operations , see also @xcite .",
    "we shall now give a method for solving problem @xmath216 in step  ( 1b ) of algorithm .",
    "the problem is the following : given the first @xmath207 terms of a power series @xmath228 , find ( if it exists ) , a bivariate polynomial @xmath159 $ ] , with minimal degree in @xmath54 , such that @xmath382 .",
    "this can be handled by an undetermined coefficients approach as follows : +   + ` input : ` a _",
    "@xmath384 , with @xmath385 .",
    "+ ` output : ` a minimal solution of @xmath216 with degree @xmath236 or `` none '' .",
    "let @xmath386 be an ansatz for the bivariate polynomial that we are searching for .",
    "+ 2 .   construct the linear system @xmath387 for the @xmath388 s given by : @xmath389 3 .",
    "if @xmath387 does not have a non - trivial solution , then return  none \" .",
    "[ rowechelon ] else compute a row - echelon form of a basis of solutions of @xmath387 to find a solution @xmath390 of minimal degree in @xmath54 and return it .",
    "algorithm is correct . if we suppose that @xmath347 , then it uses at most @xmath0 arithmetic operations in @xmath7 .",
    "the correctness of the algorithm is straightforward .",
    "let us study its arithmetic complexity .",
    "to construct the linear system @xmath387 , we have to compute @xmath391 for @xmath392 .",
    "this can be done in @xmath393 arithmetic operations .",
    "the linear system @xmath387 has @xmath207 equations and @xmath394 unknowns @xmath388 s .",
    "note that we assume @xmath395 so that @xmath396 .",
    "it can thus be solved using @xmath397 operations .",
    "finally , in step  ( [ rowechelon ] ) , the row - echelon form can be computed using at most @xmath398 arithmetic operations ( see ( * ? ? ?",
    "* chapter 3 ) ) since the dimension of a basis of solutions of @xmath387 does not exceed @xmath35 , which ends the proof .",
    "[ compl_proba ] algorithm uses at most @xmath0 arithmetic operations in @xmath7 , when @xmath2 tends to infinity and @xmath143 is fixed .    in subsection  [ complexity - section - pow - ser ]",
    ", we have seen that step ( 1a ) can be performed in at most @xmath399 arithmetic operations .",
    "then , using algorithm , step  ( 1b ) can be performed in @xmath398 operations in @xmath7 , see subsection  [ complexity - section - min - poly ] . in step  ( 1c )",
    ", we have to compute the primitive part relatively to @xmath54 of a minimal solution of @xmath216 .",
    "this reduces to computing @xmath2 @xmath400 s of univariate polynomials of degree at most @xmath2 which can be done in @xmath401 operations in @xmath7 ( and even faster using half - gcd techniques ) . in step  ( 1d )",
    ", we must avoid the roots of @xmath298 thus we need to run the loop at most @xmath402 times . in this loop",
    "we evaluate univariate polynomials with degree at most @xmath143 and @xmath2 , thus it uses at most @xmath403 arithmetic operations .",
    "finally , we test if @xmath293 which costs @xmath404 arithmetic operations since @xmath362 . indeed , we multiply bivariate polynomials of degree at most @xmath2 and we add bivariate polynomials of degree at most @xmath405 .    the deterministic algorithm can be done using at most @xmath27 arithmetic operations , when @xmath2 tends to infinity and @xmath143 is fixed .    in the previous statement , even if @xmath143 is fixed , we mention it in the complexity in order to emphasize on the number of iterations of the probabilistic algorithm .",
    "this estimate is straightforward from theorem  [ compl_proba ] since algorithm calls at most @xmath350 times the algorithm .",
    "the algorithm developed in subsection  [ complexity - section - min - poly ] uses an undetermined coefficients method to compute a minimal solution of @xmath216 in step ( 1b ) of algorithm .",
    "it consists in finding ( if it exists ) the minimal polynomial of a power series . in the present section ,",
    "we propose another approach to solve that problem using pad - hermite approximation , see @xcite .",
    "+ indeed , the problem of computing a bivariate polynomial annihilating a power series can be handled by means of computing a pad - hermite approximant , see @xcite .",
    "more precisely , given a power series @xmath228 , if there exists a bivariate polynomial @xmath67 of degree @xmath2 such that @xmath406 , then the coefficients of the powers of @xmath54 are a pad - hermite approximant of type @xmath407 of the vector of power series @xmath408 . computing such a pad - hermite approximant provides a polynomial @xmath215 satisfying @xmath409 where @xmath410 .",
    "unfortunately @xmath411 so that we have no way to ensure , using lemma [ algebraic - solution ] , that the pad - hermite approximant computed satisfies @xmath214 . consequently , using this method to compute the @xmath305 s in step ( 1b ) of algorithm only provides a heuristic .",
    "using pad - hermite approximation in step ( 1b ) , algorithm becomes a heuristic for computing a non - composite rational first integral of of degree at most @xmath2 using only @xmath5 arithmetic operations .",
    "beckermann - labahn s algorithm ( see @xcite ) computes a pad - hermite approximant of type @xmath412 of the vector of power series @xmath408 in @xmath413 arithmetic operations , where @xmath410 . using the proof of theorem  [ compl_proba ]",
    ", we obtain the desired complexity estimate .",
    "the algorithms developed in the previous sections have been implemented in a maple package called rationalfirstintegrals .",
    "it is available with some examples at http://www.ensil.unilim.fr/~cluzeau/rationalfirstintegrals.html . + our implementation of the heuristic proposed in subsection  [ complexity - section - pade ] is called .",
    "it uses the gfun package  @xcite and more precisely its command to search for a bivariate polynomial annihilating the power series computed using pad - hermite approximation .",
    "+ we shall now illustrate our implementation and give some timings .",
    "we start by comparing our implementation to two previous methods , namely :    1 .",
    "the _ naive _ approach which consists in using the method of undetermined coefficients to search for two polynomials @xmath39 and @xmath42 of degree at most @xmath2 satisfying @xmath414 .",
    "this implies solving a system of quadratic equations in the coefficients of @xmath39 and @xmath42 . in our implementation",
    ", we use the command of maple to solve the quadratic system , 2 .",
    "the approach developed in @xcite based on the _",
    "ecstatic curve_.    consider the planar polynomial vector field given by @xmath415 and @xmath416 which has no rational first integral of degree less than @xmath417 .",
    "the following table compares the timings ( in seconds ) of the different implementations for proving the non - existence of a rational first integral of degree less than @xmath418 .    [ cols=\"^,^,^,^\",options=\"header \" , ]     in short , it takes @xmath323 minutes to compute a rational first integral of degree @xmath419 and @xmath420 minutes to compute a rational first integral of degree @xmath421 for this family of examples .",
    "we consider the rationally integrable abel differential equation @xmath422 in the article of gine and llibre @xcite .",
    "it corresponds to the polynomial vector field given by @xmath423 and @xmath424 .",
    "a rational first integral of degree @xmath425 is computed in @xmath426 seconds by and in @xmath427 seconds by if they are both run with @xmath428 .",
    "the rational first integral returned by is given by @xmath40 with @xmath429 and @xmath430 using the procedure , we find a rational first integral written in a more compact form : @xmath431",
    "in this section , we show how the approach used above for computing rational first integrals of of degree bounded by a fixed @xmath231 can be slightly modified for computing all irreducible darboux polynomials for the derivation @xmath59 associated with of degree at most @xmath2 .",
    "+ in the output of our algorithms , irreducible darboux polynomials in @xmath432 $ ] will be given by @xmath433 $ ] and @xmath434 $ ] .",
    "the univariate polynomial @xmath435 is irreducible in @xmath436 $ ] and for all roots @xmath317 of @xmath435 , we have an irreducible darboux polynomial @xmath437 $ ] .",
    "+      in this section we give a deterministic algorithm for computing all irreducible darboux polynomials for the derivation @xmath59 associated with of degree at most @xmath2 .",
    "this algorithm is divided into two steps .",
    "first , we compute all irreducible darboux polynomials @xmath390 such that @xmath438 : this is the task of algorithm below applied to @xmath55 and @xmath56 .",
    "then , in a second step , we show how we can compute the missing darboux polynomials ( those satisfying @xmath439 ) by applying to relevant polynomials constructed from @xmath55 and @xmath56 by a change of coordinates .",
    "+ in these algorithms we suppose @xmath169 and @xmath440 , @xmath441 coprime .",
    "we can easily reduce our study to this situation .",
    "we have already explained how we can get @xmath169 .",
    "now , we just have to remark that the second condition corresponds to the choice of an element which is not a root of the resultant @xmath442 .",
    "thus after a finite number of shifts , we can assume that @xmath169 and that @xmath440 and @xmath441 are coprime .",
    "in particular , this implies that @xmath53 is not a darboux polynomial and if @xmath67 is a darboux polynomial , then @xmath443 in @xmath444 $ ] .",
    "we also assume that @xmath59 would have no rational first integral with degree at most @xmath2 .",
    "indeed , from theorem  [ thm : darboux ] , in this situation @xmath59 has an infinite number of irreducible darboux polynomials .",
    "we can check this hypothesis with the previous algorithms .",
    "+   + ` input : ` @xmath276 $ ] s.t .",
    "@xmath163 , @xmath440 , @xmath441 coprime , and a bound @xmath231 such that has no rational first integral of degree at most @xmath2 .",
    "+ ` output : ` the set of all irreducible darboux polynomials @xmath67 for the derivation @xmath59 such that @xmath445 and @xmath438 .",
    "+ 2 .   for an indeterminate @xmath154 ,",
    "compute the polynomial @xmath232 $ ] of degree at most @xmath233 s.t . @xmath167 and @xmath234 .",
    "+ 3 .   for an indeterminate @xmath154 ,",
    "compute the polynomial @xmath447 $ ] of degree at most @xmath233 s.t . @xmath448 and @xmath449 .",
    "let @xmath386 be an ansatz for the darboux polynomials that we are searching for .",
    "+ 5 .   construct the linear system @xmath450 for the @xmath388 s given by : @xmath451 6 .",
    "construct the linear system @xmath452 for the @xmath388 s given by : @xmath453 7 .   for @xmath454 do : + 1 .",
    "clear the denominator in @xmath455 .",
    "[ stepdarboux ] compute the smith normal form of @xmath455 .",
    "let @xmath456 be the last invariant factor of @xmath455 .",
    "factorize @xmath456 over @xmath7 : @xmath457 .",
    "4 .   for @xmath458 from 1 to @xmath459",
    "set @xmath460:=\\kk[c]/(\\mathcal{p}_{k , i}(c))$ ] .",
    "[ darboux_reconnu ] compute a solution of @xmath461 s.t .",
    "the corresponding polynomial @xmath462 has minimal degree in @xmath54 and is primitive w.r.t .",
    "3 .   if @xmath463 , then @xmath464\\}$ ] . 8 .   return @xmath465 .",
    "+      let @xmath67 be an irreducible darboux polynomial such that @xmath438 and @xmath466 be a root of @xmath467 .",
    "then we have : @xmath468 or @xmath469 because @xmath440 and @xmath441 are assumed to be coprime .",
    "+ if @xmath468 and @xmath470 , then @xmath67 admits a root @xmath471 such that .",
    "then , from proposition [ rfi - darboux - diffeq ] , @xmath472 is a power series solution of .",
    "thus @xmath473 is a root of @xmath474 .",
    "then , by lemma [ algebraic - solution ] , @xmath67 is constructed in step  ( [ darboux_reconnu ] ) .",
    "+ if for a constant @xmath466 , we have @xmath469 and @xmath470 , then the previous arguments used with @xmath475 show that @xmath67 is also constructed .    in the algorithm",
    ", we compute irreducible darboux polynomials @xmath67 such that @xmath476 .",
    "indeed , the algorithm finds a irreducible darboux polynomial @xmath67 if and only if the curve @xmath477 and the line @xmath478 have an intersection point .",
    "now , we show how to get irreducible darboux polynomials such that @xmath439 .",
    "the idea is to use a change of coordinates in order to get a new polynomial @xmath215 such that @xmath479 has a root . if @xmath439 , then @xmath67 has a root at infinity .",
    "thus we consider the following change of coordinates : we set @xmath480 where @xmath481 , and we consider the following polynomials : @xmath482      [ lem : chgcoord ] with the above notation , if @xmath67 is a darboux polynomial for the derivation @xmath72 , then @xmath215 is a darboux polynomial for the derivation @xmath483 furthermore , if @xmath484 , then @xmath485 .",
    "we deduce the following algorithm : +   + ` input : ` @xmath276 $ ] s.t .",
    "@xmath163 , @xmath440 , @xmath441 coprime , @xmath486 , @xmath487 and @xmath488 coprime , and a bound @xmath231 such that has no rational first integral of degree at most @xmath2 .",
    "+ ` output : ` the set of all irreducible darboux polynomials @xmath67 for the derivation @xmath59 such that @xmath445 . +      for the same reasons as before , using a finite number of shifts we can suppose that the hypotheses  @xmath169 , @xmath440 , @xmath441 coprime , @xmath486 , @xmath487 , @xmath488 coprime \" are satisfied so that these conditions are not restrictive .",
    "+ as a direct consequence of proposition  [ prop : darbouxpartcorrect ] and lemma  [ lem : chgcoord ] , we obtain the following result .",
    "as we have seen in section [ complexity - section ] , the computation of a basis of solutions of a system of linear equations is the most costly step of our algorithms . in",
    ", we have to consider four systems of linear equations .",
    "the first reason is that in , we need to study two linear systems in order to take into account the situation where @xmath478 is a vertical tangent of the curve @xmath477 .",
    "indeed , in this situation we can not get a parametrization @xmath494 of the curve .",
    "the second reason is that we need to use a change of coordinates in order to control the situation where @xmath467 has a root at infinity . of course , for a generic polynomial vector field , these two situations ( i.e. , a vertical tangent and a root at infinity ) do not appear .",
    "we then deduce the following probabilistic algorithm .",
    "+   + ` input : ` @xmath276 $ ] , a bound @xmath231 such that has no rational first integral of degree at most @xmath2 , and two elements @xmath495 .",
    "+ ` output : ` the set of all irreducible darboux polynomials @xmath67 for the derivation @xmath59 such that of @xmath445 .",
    "2 .   set @xmath496 , @xmath497 and @xmath498 .",
    "3 .   for an indeterminate @xmath154 , compute the polynomial @xmath232 $ ] of degree @xmath499 s.t . @xmath500 and @xmath501 .",
    "4 .   let @xmath386 be an ansatz for the darboux polynomials that we are searching for .",
    "construct the linear system @xmath502 for the @xmath388 s given by : @xmath451 6 .",
    "clear the denominator in @xmath502 .",
    "[ stepdarboux ] compute the smith normal form of @xmath502 .",
    "let @xmath503 be the last invariant factor of @xmath502 .",
    "factorize @xmath503 over @xmath7 : @xmath504 .",
    "1 .   for i from 1 to @xmath505 do : 1 .   set @xmath460=\\kk[c]/(\\mathcal{p}_i(c))$ ] .",
    "[ darboux_reconnu_1 ] compute a solution of @xmath461 s.t .",
    "the corresponding polynomial @xmath305 has minimal degree in @xmath54 and is primitive w.r.t .",
    "3 .   if @xmath506 , then @xmath507\\}$ ] . 9 .",
    "factorize @xmath508 over @xmath7 : @xmath509 .",
    "10 . for i from 1 to @xmath510 do : 1 .   if @xmath511 , then @xmath512\\}$ ] . 11 .",
    "return @xmath465 .",
    "+    the algorithm is correct .",
    "furthermore , if @xmath374 and @xmath10 are chosen uniformly at random in a finite set @xmath513 such that @xmath514 , then the probability that this algorithm returns irreducible darboux polynomials is at least @xmath515 .",
    "first , we remark that @xmath67 is a darboux polynomial for @xmath59 if and only if @xmath516 is a darboux polynomial for @xmath517 .",
    "thus the strategy used in this algorithm is to perform a change of coordinates in order to be in a generic position , and then to compute all irreducible darboux polynomials @xmath518 of degree at most @xmath2 by considering only one linear system . + the proof of proposition [ prop : darbouxpartcorrect ] shows that from step ( 2 ) to step ( 8) , we compute all irreducible darboux polynomials satisfying : @xmath519 let us study the probability to get @xmath520 .",
    "if @xmath521 , then @xmath522 where the other terms have degree relatively to @xmath54 strictly less than @xmath2 .",
    "thus , if @xmath523 is not equal to zero , then we have @xmath520 .",
    "+ as has no rational first integral of degree at most @xmath2 , then by darboux - jouanolou s theorem ( see theorem [ thm : darboux ] ) , we have at most @xmath145 irreducible darboux polynomials with degree at most @xmath2 .",
    "thus , by zippel - schwartz s lemma , the probability to reach the situation @xmath520 for all irreducible darboux polynomials is at least @xmath524 .",
    "+ now we suppose that @xmath520 and we study the probability to have the situation @xmath525 .",
    "if the polynomial @xmath526 is not zero , then , by zippel - schwartz s lemma , the probability to reach this situation for all irreducible darboux polynomials , is at least @xmath527 .",
    "+ if the polynomial @xmath528 is zero , then @xmath518 and @xmath529 have a common factor . as we suppose @xmath518 irreducible",
    ", we deduce that @xmath518 divides @xmath529 .",
    "thus @xmath518 divides @xmath530 .",
    "as @xmath529 and @xmath531 are coprime , we get that @xmath518 divides @xmath532 .",
    "this situation is possible only when @xmath533 .",
    "this means @xmath534 when @xmath533 and @xmath518 divides @xmath508 .",
    "we compute this kind of irreducible darboux polynomials in step ( 10 ) of the algorithm .",
    "+ in conclusion , the algorithm computes all irreducible darboux polynomials of degree at most @xmath2 with the announced probability estimate .",
    "we have implemented the algorithm in our package rationalfirstintegrals .",
    "let us illustrate the purpose of this section on an interesting example .",
    "+ consider the vector field corresponding to the jacobian derivation associated with @xmath535 , namely , @xmath536 @xmath537 by construction , it admits the rational first integral @xmath48 of degree @xmath538 and the darboux polynomials @xmath539 , @xmath540 , @xmath541 of degree at most @xmath323 .",
    "let us consider the computation of all irreducible darboux polynomials of degree at most @xmath345 .",
    "+ the first darboux polynomial @xmath76 satisfies @xmath542 and its root @xmath543 satisfies @xmath544 .",
    "therefore it will be found by considering the linear system @xmath450 in , see the proof of proposition  [ prop : darbouxpartcorrect ] .",
    "+ the darboux polynomial @xmath77 satisfies @xmath545 and but its root @xmath546 satisfies @xmath547 .",
    "thus it will be missed if we only consider system @xmath450 in .",
    "it is the case where the curve @xmath548 has the vertical tangent @xmath478 .",
    "however , if we consider the second system @xmath452 in , we will find this darboux polynomial , see the proof of proposition  [ prop : darbouxpartcorrect ] .",
    "+ finally @xmath549 satisfies @xmath550 so that @xmath551 has a root at infinity . considering only the systems",
    "@xmath450 and @xmath452 in will not be enough to find this darboux polynomial .",
    "however , performing the change of coordinates as in and applying to @xmath552 and @xmath553 instead of @xmath55 and @xmath56 will provide this darboux polynomial .",
    "+ to summarize , applying to @xmath55 and @xmath56 , we get @xmath76 and @xmath77 but we miss @xmath549 but either applying or we get the three darboux polynomials . note also that applying an algorithm similar to but where we skip step ( 2 ) , i.e. , we do not perform the generic change of coordinate , we would obtain only @xmath76 and miss both @xmath77 and @xmath549 .",
    "+ our implementation of requires computations in @xmath271 so that as for it is not very efficient and can not be used in practice for examples with large degrees .",
    "to give an idea of timings , on the previous example , running without the change of coordinates in step ( 2 ) , we obtain @xmath554 in @xmath555 seconds but we miss @xmath77 and @xmath549 whereas running , we get the complete set @xmath556 in @xmath557 seconds .              a.  bostan , f.  chyzak , f.  ollivier , b.  salvy ,  .",
    "schost , and a.  sedoglavic .",
    "fast computation of power series solutions of systems of differential equations . in _ proceedings of the eighteenth annual acm - siam symposium on discrete algorithms _ , pages 10121021 , new york , 2007 ."
  ],
  "abstract_text": [
    "<S> we present fast algorithms for computing rational first integrals with bounded degree of a planar polynomial vector field . </S>",
    "<S> our approach is inspired by an idea of ferragut and giacomini ( @xcite ) . </S>",
    "<S> we improve upon their work by proving that rational first integrals can be computed via systems of linear equations instead of systems of quadratic equations . </S>",
    "<S> the main ingredients of our algorithms are the calculation of a power series solution of a first order differential equation and the reconstruction of a bivariate polynomial annihilating a power series . </S>",
    "<S> this leads to a probabilistic algorithm with arithmetic complexity @xmath0 and to a deterministic algorithm solving the problem in @xmath1 arithmetic operations , where  @xmath2 denotes the given bound for the degree of the rational first integral , and where @xmath3 is the degree of the vector field , and @xmath4 the exponent of linear algebra . </S>",
    "<S> we also provide a fast heuristic variant which computes a rational first integral , or fails , in @xmath5 arithmetic operations . by comparison , </S>",
    "<S> the best previous algorithm given in  @xcite uses at least @xmath6 arithmetic operations . </S>",
    "<S> we then show how to apply a similar method to the computation of darboux polynomials . </S>",
    "<S> the algorithms are implemented in a maple package rationalfirstintegrals which is available to interested readers with examples showing its efficiency . </S>"
  ]
}