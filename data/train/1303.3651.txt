{
  "article_text": [
    "the network energy consumption has become one of the key design requirements of wireless communication systems in recent years @xcite . by exploiting the renewable energy such as solar power , wind power and so on ,",
    "energy harvesting technology can efficiently reduce co@xmath0 emissions @xcite .",
    "it can greatly reduce the load of power grid when the renewable energy usage well meets the network traffic load",
    ". however , due to the randomness of the renewable energy , users quality of service ( qos ) may not be guaranteed all the time , which requires other complementary stable power supplies . as the power grid is capable of providing persistent power input ,",
    "the coexistence of energy harvesting and grid power supply is considered as a promising technology to tackle the problem of simultaneously guaranteeing the users qos and minimizing the power grid energy consumption @xcite .",
    "a number of research paper have focused on the energy harvesting issues recently .",
    "the online power allocation policies of energy harvesting transmitter with a rechargeable battery are studied in @xcite using markov decision process ( mdp ) approach @xcite .",
    "the energy allocation and admission control problem is studied in @xcite for communications satellites .",
    "@xcite considers the cross - layer resource allocation problem to maximize the total system utility . in @xcite ,",
    "the authors develop the energy management policies with stability guarantee in sensor networks . and throughput maximization with causal side information and that with full side information are both studied in @xcite .",
    "although some optimal online policies are proposed , the structure of the optimal power allocation is still not clearly presented via mdp approach , which in addition usually suffers from the _ curse of dimensionality _ @xcite .",
    "recently , there have been research efforts on the analysis of the optimal offline power allocation structure @xcite . in @xcite , the problem of minimizing the transmission completion time with infinite battery capacity in non - fading channel",
    "is studied in two scenarios , i.e. , all packets are ready before transmission and packets arrive during transmission . ref .",
    "@xcite finds the optimal transmission policy to maximize the short - term throughput with limited energy storage capacity , and exploits the relation between the throughput maximization and the transmission completion time minimization .",
    "the power allocation of energy harvesting systems in fading channel is formulated as a convex optimization problem in @xcite , and the optimal _ directional water - filling ( wf ) _ policy is introduced .",
    "besides the analysis of energy harvesting system listed above , there is some other work on offline power allocation , which optimizes the energy efficiency assuming that the required energy is always available ( e.g. power grid ) . in @xcite",
    ", a lazy packet scheduling policy is proved optimal to minimize the total energy consumption within a deadline . the similar problem with individual packet delay constraint",
    "is studied in @xcite .",
    "the authors in @xcite considered the strict qos constraints such as individual packet deadlines , finite buffer and so on , and proposed a general calculus approach .",
    "different from the existing work , we consider the power allocation problem in the wireless fading channel with the coexistence of energy harvesting and power grid . to the best of our knowledge ,",
    "very limited work such as @xcite has focused on this topic , which however , only considers the binary power allocation .    in particular , we study the offline power allocation problem aiming to find the optimal structure in the energy harvesting and power grid coexisting system .",
    "we assume that the data is randomly arrived in each transmission frame , and minimize the average power grid energy consumption while completing the required data transmission before a given deadline .",
    "the main contributions are presented as follows :    * the offline grid power minimization problem is formulated and then converted into a convex optimization problem . then the closed - form optimal power is obtained in terms of lagrangian multipliers . *",
    "the structure of the optimal power allocation is analyzed in some special cases .",
    "specifically , in the case that all the data is ready before transmission , the problem is a dual problem of the throughput maximization and is solved by the _ two - stage wf _ algorithm . in the case",
    "that the battery capacity is infinite , the optimal water levels are non - decreasing , and the optimal power allocation structure can be obtained by the _",
    "reverse multi - stage wf _ policy , which allocates the harvested energy and the grid energy one by one from the last frame to the beginning .",
    "* some sub - optimal online schemes based on the analysis of the optimal power allocation structure , including _ constant water level _ policy and _ adaptive water level _ policy , are proposed and evaluated by numerical simulations .",
    "it is shown that the adaptive water level policy performs better than the constant one considering both the grid energy consumption and the qos guarantee .",
    "the rest of the paper is organized as follows .",
    "section [ sec : model ] introduces the model of the energy harvesting and power grid coexisting system .",
    "the offline grid power minimization problem is formulated in section [ sec : gpmin ] . in section [ sec : struct ] , we study the optimal solution for the minimization problem by cases . then some online algorithms are proposed in section [ sec : online ] , and numerical results are presented in section [ sec : simu ] .",
    "finally , section [ sec : conc ] concludes the paper .",
    "we consider a single wireless link as shown in fig .",
    "[ fig : system ] , where the transmitter is powered by both energy harvesting and power grid .",
    "the harvested energy is stored in a battery with capacity @xmath1 for data transmission usage .",
    "if the energy in the battery is insufficient , the transmitter uses the power grid to guarantee the user s qos . in this paper",
    ", we assume the energy is used only for transmission , i.e , the processing energy is ignored .",
    "assume the system is slotted with frame length @xmath2 .",
    "we study the optimal power allocation during a finite number of frames @xmath3 , indexed by @xmath4 .",
    "we adopt the block fading model , i.e , the channel keeps constant during each frame , but varies from frame to frame . the received signal in frame @xmath5",
    "is given by @xmath6 where @xmath7 is the channel gain , @xmath8 is the transmit power , @xmath9 is the input symbol with unit norm , and @xmath10 is the additive white gaussian noise ( awgn ) with zero mean and unit variance",
    ". the reference signal - to - noise ratio ( snr ) , defined as the snr with unit transmit power , during the frame @xmath11 is denoted by @xmath12 .",
    "then , the instantaneous rate @xmath13 in bits per channel use is @xmath14    assume the initial battery energy is @xmath15 , and the harvested energy @xmath16 arrives at the beginning of each frame @xmath11 .",
    "part of the transmit power @xmath8 is supplied by the battery , denoted as @xmath17 . and the rest is supplied by the power grid @xmath18 .",
    "the frame and energy arrival model is depicted in fig .",
    "[ fig : timeline ] .",
    "there are several constraints on the battery power @xmath17 : since the harvested energy can not be consumed before its arrival , the first constraint is the energy causality @xmath19 the second constraint is the limited battery capacity .",
    "the battery overflow happens when the reserved energy plus the harvested energy exceeds the battery capacity , which however , is not preferred because the data rate can be increased if the energy is used in advance instead of overflowed .",
    "so we have @xmath20    on the other hand , the grid power satisfies the average power constraint @xmath21 where @xmath22 is the average grid power supply .",
    "we study the grid power minimization problem with offline setup , i.e. , the energy arrivals @xmath23 and the channel gains @xmath24 of all the frames are known in advance .",
    "assume that the amount of @xmath25 bits arrive at the beginning of frame @xmath26 , where @xmath27 , and all the quantities are known .",
    "the constraint due to the random packet arrival is that the number of transmitted bits can not exceed those in the buffer , which can be expressed as @xmath28 by using ( [ constr : ranbit2 ] ) minus ( [ constr : ranbit1 ] ) for all @xmath29 , and then relaxing ( [ constr : ranbit2 ] ) to inequality , we get the data constraint as @xmath30 which is equivalent with the original constraints ( [ constr : ranbit1 ] ) and ( [ constr : ranbit2 ] ) because while achieving the optimality , ( [ constr : ranbit ] ) for @xmath31 must be satisfied with equality .",
    "otherwise , we can always decrease the transmission rate by reducing the energy consumption without conflicting any other constraints .",
    "in addition , the relaxation of ( [ constr : ranbit2 ] ) avoids the conflicts between power and data constraints .",
    "for instance , if @xmath32 and @xmath33 , the original constraint ( [ constr : ranbit1 ] ) conflicts with the battery constraint ( [ cnstr : ecap ] ) for @xmath34 . in this case , the problem is infeasible .",
    "however , the problem with constraint ( [ constr : ranbit ] ) is always feasible since we can use the extra harvested energy to transmit packets carrying no data to avoid battery overflow . in the example",
    ", the feasible power allocation policy is to allocate @xmath15 to frame 1 to transmit packets without any data .",
    "we aim at minimizing the energy consumption of power grid under the constraints of required data transmission , causality of harvested energy , battery capacity and non - negative power allocation .",
    "the problem is formulated as follows @xmath35 where the constraints ( [ cnstr : pg ] ) and ( [ cnstr : ph ] ) imply that the energy from either power grid or battery is non - negative .",
    "notice that there are three cases of the solutions : ( a ) the harvested energy exceeds the required energy to transmit all the arrived packets , which results in @xmath36 , and there are multiple solutions ; ( b ) the harvested energy is insufficient to transmit the packets .",
    "then we have @xmath37 , and the inequality is satisfied for at least one @xmath11 ; ( c ) the harvested energy is just enough to achieve the optimal power allocation , and any additional packets to transmit will result in non - zero grid power . in our analysis , we mainly focus on the case ( b ) where grid power is necessary . the case ( c )",
    "is also studied as it helps us to understand the structure of the optimal harvested power allocation .",
    "also note that we ignore the average grid power constraint ( [ cnstr : pave ] ) , which decides the feasibility of the problem .",
    "if we can find a feasible solution for problem ( [ opt : pmin ] ) without violating ( [ cnstr : pave ] ) , it can be ignored .",
    "otherwise , the required bits can not be transmitted by the deadline .",
    "hence , the best we can do is try to maximize the number of transmitted bits , which can be formulated as a throughput maximization problem @xmath38 in the following section , we analyze the optimal solution for the grid power minimization problem assuming it is feasible ( the constraint ( [ cnstr : pave ] ) is ignored ) . also , the relation between the throughput maximization and the grid power minimization is briefly discussed .",
    "the objective ( [ opt : pmin ] ) is a linear function , the constraints ( [ constr : ranbit ] ) are convex for all @xmath39 since it is a sum of @xmath40 functions larger than a threshold , and the others are all linear constraints .",
    "consequently , the optimization problem is a convex optimization problem , and the optimal solution satisfies the kkt conditions @xcite . define the lagrangian function for any multipliers @xmath41 as @xmath42 with additional complementary slackness conditions @xmath43    we apply the kkt optimality conditions to the lagrangian function ( [ eqn : lagr2 ] ) . by setting @xmath44",
    ", we obtain the unique optimal power levels @xmath45 in terms of the lagrange multipliers as @xmath46 where @xmath47 .",
    "notice that there is no closed - form expression for the parameter @xmath17 , which indicates that the power supplied from battery can be of many choices as long as the constraints are satisfied and the optimal total power @xmath45 is achieved .",
    "for instance , if one of the optimal power allocation for frames @xmath11 and @xmath26 is @xmath48 , then it is also optimal by allocating @xmath49 .",
    "denote @xmath50 as a feasible optimal solution in order to distinguish from the optimization parameter @xmath17 .",
    "hence , the optimal power allocation is @xmath51^+ , \\label{opt : p}\\ ] ] where @xmath52^+ = \\max\\{x,0\\}$ ] , and the water level is expressed by either @xmath53 depending on how the battery power and the grid power are allocated .",
    "based on the optimal power allocation solution ( [ opt : p])-([wl:2 ] ) , we study the following special cases to find the structure of the optimal power allocation .      assume the packet arrival sequence is @xmath54 , i.e. , all the packets are ready before transmission . in this case",
    ", the optimal power allocation is simplified as @xmath55    we have the following proposition :    [ prop : norandom ] for given harvested energy profile @xmath56 , define @xmath57 @xmath58 under the constraints ( [ cnstr : causal ] ) , ( [ cnstr : ecap ] ) , ( [ cnstr : pave ] ) , ( [ cnstr : pg ] ) , and ( [ cnstr : ph ] ) . assume the packet arrival sequence is @xmath54 , and define @xmath59 under the constraints ( [ cnstr : causal ] ) , ( [ cnstr : ecap ] ) , ( [ constr : ranbit ] ) , ( [ cnstr : pg ] ) , and ( [ cnstr : ph ] ) .",
    "we have @xmath60 .",
    "first of all , the functions @xmath61 and @xmath62 are monotonic increasing since the @xmath40 functions are monotonically increasing and concave .    then , we set @xmath63 .",
    "if @xmath64 , we have @xmath65 .",
    "hence , @xmath66 , as with @xmath67 , we can achieve higher throughput @xmath68 by the optimal policy .",
    "it contradicts the assumption .",
    "the same result holds for @xmath69 . as a result , @xmath70 .",
    "proposition [ prop : norandom ] shows that if all the packets are already at the transmitter before the transmission starts , the problem ( [ opt : pmin ] ) is a dual problem of ( [ opt : thrmax ] ) .",
    "we now discuss the structure of the optimal power allocation of problem ( [ opt : thrmax ] ) , and our grid power minimization problem can be solved in the same way due to dual property . in fact , the problem ( [ opt : thrmax ] ) can be considered as a simple extension of @xcite by adding an additional average grid power constraint .",
    "hence , it can be solved similarly by the directional wf algorithm . in particular ,",
    "the harvested energy in each frame can only be transferred to the future frames , and the amount that can be transferred is limited by the battery capacity .",
    "it is realized by introducing the concept of right permeable tap @xcite .",
    "the difference in our problem is that there is additional grid energy , which however , can be considered as an additional battery with total amount of energy @xmath71 .",
    "as there are no causality and capacity constraints , the grid energy allocation can be viewed as the directional wf from frame 1 with right permeable tap which allows any amount of energy transfer , which is in fact the traditional wf algorithm @xcite .    in order to emphasize the difference between harvested energy and grid energy as well as",
    "motivate the algorithm design for random packet arrival case , we propose the _ two - stage wf _ optimal power allocation policy . the procedure is divided into two stages . in the first stage , the system operates directional wf @xcite to allocate the harvested energy . at the beginning of the second stage ,",
    "the surface of the water freezes up .",
    "then the traditional wf @xcite is performed to allocate the power grid energy on the ice surface , until the energy is used up .",
    "an example is shown in fig . [ fig : wfex ] .",
    "we illustrate a total of @xmath72 frames .",
    "the initial battery energy is @xmath15 , and only the values of harvested energy @xmath73 and @xmath74 is non - zero . by performing the two - stage wf algorithm ,",
    "the optimal power allocation is obtained .",
    "it is observed from the figure that a constant water level is achieved except for frames 3 , 6 and 7 .",
    "the power used in frame 3 is zero because of deep fading . due to the battery capacity constraint ,",
    "frames 6 and 7 have higher water level to avoid energy overflow . also , the power allocation of harvested energy and power grid energy is variable under the water level .",
    "for instance , the harvested energy allocated in frame 2 can be partially reserved to be used in frame 4 , and the water level in frame 2 is achieved by power grid energy .",
    "now assume the packets arrive in every frame . in this condition",
    ", we first analyze the structure of the optimal power allocation under the different assumptions on the energy . then based on the observations ,",
    "we discuss the power allocation for the general case .",
    "[ prop : noeh ] if @xmath75 for all @xmath27 , the optimal water levels are monotonically non - decreasing as @xmath76 .",
    "the water level may increase only when ( [ constr : ranbit1 ] ) is satisfied with equality .    without the energy harvesting ,",
    "the water levels are expressed as ( [ wl:1 ] ) . since @xmath77",
    ", it naturally results in @xmath76 .",
    "in addition , if ( [ constr : ranbit1 ] ) is satisfied without equality , i.e. , @xmath78 from ( [ constr : ranbit2 ] ) we get @xmath79 then from ( [ comp : bits ] ) we have @xmath80 , and hence @xmath81 .",
    "note that the energy minimization by a deadline with grid power supply only is studied in @xcite for awgn channel , where the rate - power function is time - invariant . here",
    ", we consider the fading channel case , and conclude from proposition [ prop : noeh ] that if the power is supplied by the power grid only , the water level is non - decreasing from frame to frame .",
    "it increases only at the points where @xmath82 i.e. , the already arrived packets are all transmitted by the end of frame @xmath39 .",
    "the optimal power allocation can be obtained by _",
    "reverse multi - stage wf _ algorithm , which allocates the power from the last frame to the first frame .",
    "first allocate the power to frame @xmath3 so that ( [ constr : ranbit ] ) for @xmath83 is satisfied with equality . then freeze up the water surface of frame @xmath3 , and allocate the power to frames @xmath84 and @xmath3 with the traditional wf policy on the ice surface so that ( [ constr : ranbit ] ) for @xmath85 is satisfied with equality .",
    "repeat the procedure until the first frame .",
    "we summarize it as algorithm [ alg : revpa ] .",
    "set @xmath86    find @xmath87 so that @xmath88^+ .",
    "\\label{eq : stagewf}\\ ] ]    update @xmath89 as @xmath90    @xmath91    in the algorithm , for a given @xmath39 , @xmath89 denotes the freezed water level updated in the previous stage @xmath92 , and @xmath93 as was set in step 1 .",
    "hence , ( [ eq : stagewf ] ) means that in this stage , @xmath94 bits arrived at the beginning of frame @xmath39 are served by the traditional water filling algorithm in the following frames ( from @xmath39 to @xmath3 ) .",
    "[ fig : revpaex ] demonstrates an example of reverse multi - stage wf with grid power .",
    "it can be seen the arrived bits @xmath95 and @xmath96 are served through frames 3 - 5 , resulting in the same water level in these frames .",
    "the rest bits are served in their arriving frames respectively .",
    "is served in frames @xmath97 with traditional wf scheme.,width=432 ]    [ prop : noemax ] if @xmath98 , @xmath99 for all @xmath100 , and @xmath50 is unique ( i.e. , any packet arrival set @xmath101 satisfying @xmath102 , and @xmath103 results in @xmath104 ) , the optimal water levels are monotonically non - decreasing as @xmath76 .",
    "the water level may increase when either ( [ cnstr : causal ] ) or ( [ constr : ranbit1 ] ) is satisfied with equality .    under the conditions that the energy battery has infinite capacity and",
    "there is a unique harvested power allocation policy to complete the transmission without grid power input , the water level is determined by @xmath105 since @xmath106 , we have @xmath107 .",
    "the water level increases when either @xmath108 or @xmath109 .",
    "based on ( [ comp : causal ] ) , @xmath109 indicates that ( [ cnstr : causal ] ) is satisfied with equality .",
    "based on ( [ constr : ranbit2 ] ) and ( [ comp : bits ] ) , @xmath110 indicates that ( [ constr : ranbit1 ] ) is satisfied with equality .",
    "proposition [ prop : noemax ] shows the structure of optimal harvested power allocation under infinite battery capacity constraint .",
    "the conclusion is an extension of the optimal power allocation in non - fading scenario ( lemma 6 in @xcite ) to the fading scenario .",
    "the intuition is that due to the causality of energy and data arrival , the later frames can  see \" more available energy to be used and data bits to be transmitted than the earlier frames as the energy and data can be transferred rightwards , rather than leftwards .",
    "hence , the water level is non - decreasing . without the battery capacity constraint ,",
    "the harvested energy can be reserved for future use in any way as one wishes , and the arrived packets can also be transmitted in future frames .",
    "in addition , the water level changes when either all the packets arrived before the current frame are transmitted or all the energy harvested before the current frame are used up .",
    "if both the packet buffer and the energy battery are not empty , the water level keeps constant .",
    "[ prop : conoemax ] if @xmath98 , the optimal water levels are monotonically non - decreasing as @xmath76 .",
    "in addition , there is an optimal policy where a unique @xmath111 exists such that for @xmath112 , @xmath87 is expressed as ( [ wl:1 ] ) and for @xmath113 , @xmath87 is expressed as ( [ wl : noemax ] ) .",
    "we prove the proposition by studying all the cases of power allocation between energy harvesting and power grid in two consecutive frames .",
    "\\(a ) if @xmath114 and @xmath115 , the water levels of frame @xmath39 and @xmath116 have the same expression as ( [ wl:1 ] ) , hence @xmath76 .",
    "\\(b ) if @xmath117 and @xmath118 , the water levels are expressed the same as ( [ wl : noemax ] ) .",
    "we also obtain the monotonicity .",
    "\\(c ) if @xmath114 and @xmath118 , we have @xmath119 . as a result , @xmath120 .",
    "\\(d ) if @xmath117 and @xmath115 , we can exchange the amount of harvested energy @xmath121 @xmath122 of frame @xmath39 with the same amount of grid energy of frame @xmath116 to achieve the same optimal result , without conflicting any constraint or changing any water level . consequently , this case is converted to either ( a ) or ( c ) , and the monotonicity holds as well .    to sum up , @xmath76 holds for all @xmath39 .",
    "in addition , by conservatively using the harvested energy , the case ( d ) is converted to ( a ) or ( c ) , hence does not exist .",
    "depending on ( a)-(c ) , there is a unique @xmath111 such that for @xmath123 , we have @xmath114 and @xmath115 , for @xmath124 , we have @xmath117 and @xmath118 , and for @xmath125 , we have @xmath114 and @xmath126 .",
    "equivalently , for @xmath112 , @xmath87 is expressed as ( [ wl:1 ] ) and for @xmath127 , @xmath87 is expressed as ( [ wl : noemax ] ) .",
    "proposition [ prop : conoemax ] presents an analytically tractable structure of the optimal power allocation for both energy harvesting and power grid .",
    "intuitively , the harvested energy is reserved in the battery for the use in the later frames , in order to reduce the effect of causality constraint and improve the flexibility of harvested power allocation .",
    "hence , the harvested power and the grid power are allocated one by one with the structures described in proposition [ prop : noeh ] and [ prop : noemax ] , respectively .",
    "the optimal water level can be obtained by the power allocation policy which avoids case ( d ) in the proof of proposition [ prop : conoemax ] .",
    "it is structured as follows : the water level is non - decreasing and the harvested energy is used in a conservative way .",
    "that is , the energy harvested before frame @xmath111 is saved for future use so that the required transmission after frame @xmath111 can be satisfied by harvested energy only . to minimize the power grid energy , the harvested energy should be allocated to maximize the achievable throughput . according to propositions [ prop : noemax ] and [ prop : conoemax ] ,",
    "the optimal harvested energy allocation takes the similar reverse calculation structure as algorithm [ alg : revpa ] .",
    "the difference is that we should consider the causality of energy arrival .",
    "as the harvested energy can not be used before its arrival , it should be fully utilized after arrival .",
    "specifically , denote the available power as @xmath128 , and the required power as @xmath129 .",
    "if @xmath130 , i.e. , the harvested energy in frame @xmath3 is not enough to transmit @xmath131 bits , we  move \" the energy from the previous frames until @xmath131 bits can be transmitted . if @xmath132 , i.e. , @xmath131 bits transmission does not use up the harvested energy @xmath133 , we move the packets from the previous frames until @xmath133 is used up",
    ". then we freeze up the water surface and allocate power to the frames @xmath84 and @xmath3 with the traditional wf policy to achieve the same result , i.e. , either the bits arrived in this frame are served or the energy arrived is used up .",
    "repeat the procedure until the harvested energy is used up .",
    "it is detailed as algorithm [ alg : revpaeh ] .",
    "set @xmath134    find @xmath135 so that @xmath136^+.$ ]    find @xmath137 so that @xmath138^+.$ ]    find @xmath139    update @xmath140 as ( [ gamma : update ] ) , @xmath141 , @xmath142    find @xmath143    find @xmath144    update @xmath140 as ( [ gamma : update ] ) with @xmath145 , then break .",
    "update @xmath140 as ( [ gamma : update ] ) with @xmath146 , @xmath147    @xmath148    note that we assume the harvested energy is not enough to satisfy the required transmission , a proper @xmath149 can always be found in step 6 , i.e. , we can shift the arrived bits from previous frames to the current one to use up the arrived energy . on the contrary ,",
    "@xmath149 in step 9 may not be found when @xmath112 , and algorithm [ alg : revpaeh ] terminates .",
    "then the water surface freezes up and the grid power is allocated using algorithm [ alg : revpa ] on the ice surface until all the bits are transmitted .",
    "consequently , the optimal water level is found .    in summary ,",
    "the power allocation for infinite battery capacity is done in two stages . in the first stage",
    ", harvested energy is allocated reversely from last frame by the reverse multi - stage wf algorithm with harvested energy .",
    "we call the stage in this algorithm as sub - stage . in each sub - stage ,",
    "the to - be - transmitted bits form a required water level , and the to - be - used energy can achieve an available water level . if the required water level is higher than the available water level , energy from earlier frames are transferred rightwards .",
    "otherwise , the bits from earlier frames are transferred .",
    "the sub - stage ends when the two water levels are equal .",
    "when the harvested power allocation stage is finished , the water surface freezes up and the grid energy is allocated in the second stage also in multiple sub - stages .",
    "the objective of each sub - stage is just to achieve the required water level .",
    "however , in general case , if the battery capacity is finite , the monotonicity of the optimal water level does not hold when the constraint ( [ cnstr : ecap ] ) is satisfied with equality .",
    "the structure of the optimal power allocation can not be described in a simple and clear way .",
    "intuitively , in contrast to the case of infinite battery capacity where the harvested energy is conservatively used to achieve the optimality , in the finite capacity case , the power from battery should be allocated first to minimize the energy waste .",
    "we will propose some online algorithms based on the intuition .",
    "in this section , we assume that the transmitter only has the knowledge of the battery energy levels , the energy arrivals and the channel states of the current frame and all the past ones , but does not know those of the future . besides , the statistics of energy arrival and fading are available to the transmitter . in this setup ,",
    "some online power allocation algorithms are proposed .",
    "if all the packets @xmath150 are already at the transmitter before transmission , such as file transfer , the following algorithms are proposed :      motivated by the offline optimal solution that the power allocation tries to achieve a constant water level ( by the traditional wf in the second stage ) , we can propose a constant water level algorithm . assume the constant water level is @xmath151 , which is calculated by solving the following equation @xmath152 the power for each frame @xmath11 is calculated as @xmath153^+ .",
    "\\label{eqn : pi}\\ ] ] if @xmath154 , where @xmath155 denotes the battery energy at the beginning of frame @xmath11 , the required power is supplied by the battery only , and the energy from power grid is zero , i.e , @xmath156 .",
    "otherwise , the amount of energy @xmath157 will be taken from power grid .",
    "for the finite time transmission , the constant water level algorithm is apparently not optimal due to the different realization of channel gains .",
    "we propose the adaptive water level algorithm to improve the performance .",
    "the water level is updated for each frame , denoted by @xmath158 , which can be obtained by solving @xmath159 where @xmath160 is the remaining bits at the beginning of frame @xmath11 .    due to the randomness of energy arrival",
    ", there may be energy battery overflow for online solutions .",
    "hence in addition , we propose an _ energy overflow protection _ algorithm .",
    "if the expected battery energy exceeds the battery capacity , i.e , @xmath161 , a minimum power @xmath162 must be used .",
    "then the power allocated in frame @xmath11 is determined as @xmath163 where @xmath8 is expressed as ( [ eqn : pi ] ) . in this way",
    ", a certain amount of power must be used even when the channel is in deep fading or the water level exceeds the optimal one .",
    "this algorithm well meets the battery capacity constraint from the average point of view , and is expected to improve the performance , although the battery overflow can not be completely avoided .",
    "notice that all the packets need to be delivered in @xmath3 frames .",
    "hence , in the last frame , all the remaining packets should be transmitted as long as the required transmit power is achievable .",
    "specifically , the transmit power of the last is determined by @xmath164 where @xmath165 is the maximum achievable transmit power .",
    "however for the online settings , the transmission completion can not be guaranteed due to the fading , the maximum transmit power limits , and so on .",
    "we assume that the packets remained in the transmitter by the end of the last frame are dropped , and define the _ packet dropping probability _ as the ratio between the number of bits remained after the transmission and the total amount of bits arrived .",
    "online algorithms should minimize the grid energy consumption as well as the packet dropping probability .      for the case that the bits arrive at the transmitter randomly",
    ", the online algorithms can be proposed as a direct extension of that for all packets ready before transmission case .",
    "specifically , the constant water level algorithm is as follows .",
    "assume the average packet arrival rate is @xmath166 bits / frame , then the constant water level @xmath151 can be obtained by @xmath167 the difference with the previous one is that , as the available number of bits is finite , the power used in frame @xmath11 should not exceed @xmath168 hence the transmit power is expressed as @xmath169 where @xmath8 is expressed as ( [ eqn : pi ] ) .",
    "the adaptive water level can be calculated as @xmath170 where the right side of the equation is the total number of remaining bits approximated as the sum of current remaining bits @xmath160 and expected arrival in the upcoming frames .",
    "the battery overflow protection algorithm needs to be modified as the number of available bits in each frame is random and finite . in particular ,",
    "the transmit power is determined by @xmath171 where @xmath172 is expressed as ( [ p : min ] ) .",
    "in this section , we test the performance of the proposed algorithms . we take the earth project simulation parameters for the femto - cell scenario @xcite .",
    "specifically , we set the maximum transmit power as 33dbm for simulations .",
    "a total number of 1000 monte carlo simulation runs are performed for each parameter setup . for each run , the channel reference snrs and the energy arrivals",
    "are randomly generated .",
    "the distribution of reference snr follows the rayleigh model with probability density function @xmath173 , where @xmath174 is the average reference snr ( set to be 0db ) .",
    "the harvested energy follows non - negative uniform distribution with mean @xmath175dbm .",
    "the offline optimal solution , which is obtained by solving the convex optimization problem assuming all the reference snrs and the energy arrivals are known before transmission , can be considered as the performance upper bound .",
    "dbm , and the relative battery capacity @xmath176.,width=432 ]    we first exam the performance of the algorithms for the all packets ready before transmission case .",
    "we run @xmath177 frames in each simulation .",
    "the battery capacity is set @xmath178 times of the average arrived energy in one frame , i.e , @xmath179 .",
    "the parameter @xmath178 is called _ relative battery capacity_. and we set @xmath176 in this setup . the average grid power consumption achieved versus the number of bits to be transmitted is shown in fig .  [ fig : varbits ] .",
    "it shows that the adaptive water level algorithm outperforms the constant one .",
    "because of the finite time length , the adaptive algorithm can better utilize the energy .",
    "besides , the battery overflow protection algorithm improves the performance .",
    "it efficiently reduces the energy overflow at low grid power regime , but the gain shrinks as the grid power increases .",
    "dbm , and the number of bits per bandwidth is 25 bits / hz.,width=432 ]    we also investigate the influence of renewable energy battery capacity on the performance .",
    "[ fig : pminvaremax ] shows the relation between the battery capacity and the grid power consumption . here",
    ", we set the number of bits per bandwidth as 25 bits / hz . the performance gap between the online algorithm and the offline algorithm becomes small as the battery capacity increases .",
    "it shows that larger battery capacity makes the power allocation more flexible . also ,",
    "similar to the result from fig .",
    "[ fig : varbits ] , the battery overflow protection algorithm is efficient at low battery capacity regime .",
    "dbm , and the relative battery capacity @xmath176.,width=432 ]    fig .",
    "[ fig : incomplete ] demonstrates the packet dropping probability for different packets transmission requirements .",
    "it can be found that the adaptive algorithm can effectively complete the transmission for almost all the conditions ( the packet dropping probability is less than 0.4% ) . on the contrary",
    ", the constant water level algorithm performs worse .",
    "specifically , without overflow protection , the packet dropping probability keeps relatively high ( @xmath180% ) , while with overflow protection , it is small for very few packets transmission requirement , and then increases and converges to that without overflow protection .",
    "hence , the adaptive water level algorithm is an effective online algorithm .",
    "dbm , @xmath181 , and the number of bits is 0.25 bits / hz / frame.,width=432 ]    in addition , the average grid power consumption versus the number of considered frames @xmath3 is depicted in fig .",
    "[ fig : varframe ] . generally speaking , the grid power consumption becomes stable when the number of frames gets large .",
    "it can be seen that @xmath182 is enough to get stable results , which validates our parameter setting .",
    "dbm , and the relative battery capacity @xmath176.,width=432 ]    dbm , and the average data rate is 0.25 bits / frame / hz.,width=432 ]    dbm , and the relative battery capacity @xmath176.,width=432 ]    we then evaluate the performances of the algorithms for random packets arrival case . figs .",
    "[ fig : varranbit ] and [ fig : varranemax ] show the grid power consumption versus average data arrival rate and relative battery capacity , respectively .",
    "in contrast to the previous results , we find that the constant water level algorithm with battery overflow protection achieves lower grid power consumption than the adaptive one . however , it is observed from fig .  [",
    "fig : incompleteran ] that the constant water level algorithm results in much higher packet dropping probability ( @xmath183% ) compared with the adaptive algorithm ( @xmath184% ) .",
    "the constant water level algorithm reduces the grid power consumption by dropping a large amount of arrived bits , which can not well meet the data transmission requirement .",
    "hence , in random packets arrival scenario , the adaptive water level algorithm requires more grid energy than the constant water level algorithm in order to keep a low packet dropping probability .",
    "we have analyzed the optimal power allocation structure of the energy harvesting and power grid coexisting systems .",
    "we consider the power grid energy minimization problem and solve it by convex optimization . the two - stage wf algorithm is proposed to solve the problem in the case that all packets are ready before transmission , and the multi - stage algorithm is proposed to solve it in the case of infinite battery capacity .",
    "in addition , online algorithms motivated by the offline solutions are also proposed and evaluated by numerical simulations .",
    "for all packets ready before transmission case , the adaptive water level algorithm outperforms the constant one for both grid power consumption and packet dropping probability . on the contrary , if the packets randomly arrive in each frame , constant water level algorithm achieves lower power consumption but causes much higher packet dropping probability .",
    "y.  cui , k.  n.  lau , and y.  wu , ",
    "delay - aware bs discontinuous transmission control and user scheduling for energy harvesting downlink coordinated mimo systems , \" _",
    "ieee trans . signal processing _ , vol .",
    "60 , no .  7 , jul .",
    "2012                  o.  ozel , k.  tutuncuoglu , j.  yang , s.  ulukus , and a.  yener , `` transmission with energy harvesting nodes in fading wireless channels : optimal policies , '' _ ieee j. selected area commun .",
    "8 , sept . 2011"
  ],
  "abstract_text": [
    "<S> this paper considers the power allocation of a single - link wireless communication with joint energy harvesting and grid power supply . </S>",
    "<S> we formulate the problem as minimizing the grid power consumption with random energy and data arrival , and analyze the structure of the optimal power allocation policy in some special cases . for the case that all the packets are arrived before transmission , </S>",
    "<S> it is a dual problem of throughput maximization , and the optimal solution is found by the _ two - stage water filling ( wf ) _ policy , which allocates the harvested energy in the first stage , and then allocates the power grid energy in the second stage . for the random data arrival case , we first assume grid energy or harvested energy supply only , and then combine the results to obtain the optimal structure of the coexisting system . specifically , </S>",
    "<S> the _ reverse multi - stage wf _ policy is proposed to achieve the optimal power allocation when the battery capacity is infinite . finally , some heuristic online schemes are proposed , of which the performance is evaluated by numerical simulations .    submitted paper    energy harvesting and power grid coexisting , convex optimization , two - stage water filling , reverse multi - stage water filling . </S>"
  ]
}