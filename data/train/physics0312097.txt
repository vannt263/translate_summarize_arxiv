{
  "article_text": [
    "the beam - angle optimization ( bao ) in intensity - modulated radiation therapy ( imrt ) aims to find , for each patient - specific case , a set of beam angles that can produce a three - dimensional ( 3d ) dose distribution that conforms most closely to the prescribed one . in general , selecting the best set of beam angles that can achieve this goal is a highly non - intuitive process .",
    "this is already true in 3d conformal radiation therapy ( crt ) , where each beam has a preset profile inside its beams - eye - view aperture and only the beam weights are optimized , but especially more so in imrt .",
    "the optimal distribution of the total dose in imrt is the result of a complex interplay among a large number of beamlet intensities from multiple beam angles and therefore there is no a priori way of predicting the dependence of the objective function ( of ) on the beam angles .",
    "the optimizer has to balance the requirement of creating a prescribed dose distribution at the target with that of giving as little dose as possible to the surrounding normal tissue and organs at risk ( oars ) .",
    "stein ( 1997 ) provided a well - known counter - intuitive example of the necessary compromise that often has to be struck to achieve this balance between target coverage and oar sparing : sometimes the beams have to go directly through an oar to achieve an optimal distribution .",
    "the complex dependence of the dose distribution on the beam angles and their beamlet intensities gives rise to a multiple local minima problem .",
    "the fact that the of has a highly non - convex dependence on its variables has so far precluded any deterministic approach to its minimization and necessitated a brute - force assail to this problem , namely a global search method .",
    "this approach requires one to perform an imrt optimization on each one of a large number of possible combinations of beam angles .",
    "two main hurdles have to be overcome , however , in making this highly - iterative approach practical and can be used routinely in a clinical setting .",
    "the first hurdle is the substantial amount of time that is required to perform an imrt beam - profile optimization for a single set of beam angles .",
    "depending on the complexity of the case and the algorithm used in the optimization , the required time already ranges from several minutes to a few hours on a typical workstation .",
    "the second hurdle is the huge size of search space involved in the beam - angle search . to rigorously search for , e.g.",
    ", the best 5 gantry angles out of 180 possible directions would require one to search over @xmath0 possible combinations .",
    "a bao system that is based on an exhaustive search would therefore , most likely , be too slow for utilization in a clinical setting .",
    "the recent past has seen a limited but steady flow of publications on this topic .",
    "a few papers have provided theoretical analysis of the bao problem ( bortfeld and schlegel 1993 , jackson 1994 , braunstein and levine 2000 ) .",
    "bortfeld and schlegel ( 1993 ) considered the bao for the 3d crt , as opposed to imrt , and concluded that , for dose - based criteria , the optimum beam configuration for multiple - beam irradiation tends to be an even distribution over the @xmath1 angular range for the gantry .",
    "rowbottom ( 1998 , 1999a , 1999b ) have proposed several approaches for bao as applied to the 3d crt .",
    "dose - based of was used in the optimization of the beam weights and simulated annealing algorithm was used to select the beam orientations in a reduced search space of coplanar ( rowbottom 1998 ) and non - coplanar ( rowbottom 1999a ) beams .",
    "some a priori criteria were also used in the beam - orientation selection : the beam orientations were constrained to be separated by at least @xmath2 and parallel - opposed beams were disallowed .",
    "in addition , a single - beam cost function ( oldham 1998 ) , based largely on the geometry of the target , was used to rank the beam orientations in the search space according to their likelihood for being a member of the optimal set and only the top 10% of the set were searched in the bao .",
    "rowbottom ( 1999b ) also attempted a more intelligent search using an artificial neural network technique .",
    "the results of this search , however , seem to be inferior to those that were obtained using their earlier simulated annealing method .",
    "pugachev and xing recently proposed several approaches to bao for the imrt ( pugachev 2000 , 2001 , pugachev and xing 2001 , 2002 ) . in their earliest proposal ,",
    "a non - iterative filtered back projection ( fbp ) method , using simple exponential attenuation for parallel x - ray beams in their dose calculation , was used to solve the inverse problem in imrt while the beam orientations were optimized using a simulated annealing method .",
    "this fast fbp approach , however , seems to preclude the use of ofs other than a dose - based of . in pugachev ( 2001 ) , an iterative method ( xing and chen 1996 ) was used to optimize the beam profiles and non - coplanar beams were used in the search space .",
    "a typical prostate case in this study required about 100 hours to be optimized by searching over 5000 combinations of beam angles .",
    "the use of the beams - eye - view dosimetrics ( bevd ) ( pugachev and xing 2001 , 2002 ) allowed them a more efficient sampling of the search space : the sets of beams that have low bevd score , i.e. those that are not likely to produce an optimal dose distribution , are immediately rejected without going through the beam - profile optimization .",
    "it was claimed that the bevd - guided sampling can improve the speed by a factor of 10 while maintaining the same capacity to locate the global minimum as that of an unguided sampling .",
    "it is interesting to note that most of previous approaches to bao used the dose - based of ( bortfeld and schlegel 1993 , rowbottom 1998 , 1999a , 1999b , pugachev 2000 , 2001 , pugachev and xing 2002 ) .",
    "das ( 2003 ) proposed an imrt beam orientation selection method that is based on target equivalent uniform dose ( eud ) maximization .",
    "the objective is to maximize the eud on the target while simultaneously imposing dv constraints on the oars .",
    "these two objectives were combined into a single of by a simple scale factor and it would be interesting to compare the performance of this combined of with that of a strictly dv - based or eud - based of .    the approach that we take in this paper is to use a fast dose calculation engine that significantly reduces the time required for the imrt optimization of each given set of beam angles .",
    "this algorithm relies on the use of a compact , albeit approximate , dose kernel ( wu 2003 ) .",
    "the main purpose of this paper is to show that this fast algorithm is sufficiently accurate to be used as a dose engine in a bao .",
    "although simulated annealing has been used in several previous works on bao , in this paper we show that the _ combination _ of simulated annealing , in particular the fsa algorithm , and the fast dose engine that we proposed recently can provide a practical , i.e. fast and useful , bao system .",
    "in addition , by focusing the improvement on the speed of the dose engine in our system , we are also able to retain all other aspects of normal , i.e. clinical , imrt optimization in our bao .",
    "thus our bao system allows a dv - based of , or indeed any other types of of , to be used for the imrt optimization for each given set of beam angles generated during the bao .",
    "the promise of a bao system is to provide better alternatives to plans produced by a planner , which in clinical settings are commonly generated by a dv - based optimization .",
    "it is therefore important to use a dv - based , instead of a dose - based , optimization in a clinical imrt bao system so that a direct comparison can be effected . if the bao plan is deemed by the planner to be significantly better , it can be used for treatment ; otherwise , the plan produced manually by the planner is retained .",
    "thus the bao can be used to automatically check if the best plan of the planner can still be improved by beam - angle adjustment .",
    "starting with an already acceptable plan , the bao is executed with the same dv constraints and parameters and its plan will be used if it is significantly better and can be produced within an allowable time .",
    "it should be noted that no a priori assumption is made regarding the selection of beam orientations in this work .",
    "although incorporation of some criteria , such as constraints on the angular separation between adjacent beams , is likely to improve the performance of the system , we feel that such topics require separate careful studies .",
    "these additional beam - selection criteria will be incorporated in further studies .",
    "in this work , we propose an efficient bao method that combines a fast dose calculation engine , which we call the table lookup ( tlp ) method ( wu 2003 ) , with an effective global search method based on the fast simulated annealing ( fsa ) algorithm . we have recently implemented this method in a program that interfaces with our in - house clinical imrt system and studied its performance and potential .",
    "the following subsections will detail the components of our bao implementation .",
    "section [ bao ] discusses the flow diagram of our bao system and the algorithm that we use to select successive sets of beams from the search pool ( the fsa algorithm ) .",
    "the dose engine that we use as a workhorse in the bao ( the tlp method ) is presented in section [ tlpsection ] while section [ ofsection ] describes the dv of that we use to guide the imrt optimization .",
    "details on how the tlp method is used to accelerate our imrt optimization and discussion on its accuracy are provided in section [ optimizationsection ] .",
    "the cases that were used to test our bao system in this work are outlined in section [ materialssection ] .",
    "-0.4 in      figure [ flowchart ] displays the flow diagram of our bao system which is interfaced with an in - house imrt system .",
    "the imrt system , in which the planner sets general optimization parameters including the number and energy of beams whose directions are to be optimized , is in turn interfaced with a commercial treatment planning system ( tps ) pinnacle@xmath3 ( philips oncology system , ca , usa ) .",
    "this in - house imrt bao program , which is external to the tps , communicates with the tps through an application programming interface , provided by the tps vendor , called pinncomm .",
    "this allows the bao and the imrt programs to , e.g. , request the tps to perform a dose calculation .",
    "the bao is performed using an fsa algorithm .",
    "prior to entering the sa loop , the planner defines a search pool of beams .",
    "we use 180 equispaced beams for a coplanar search pool and 216 beams ( 72 equispaced beams at couch angle of 0@xmath4 , 45@xmath4 , and 315@xmath4 ) for a non - coplanar search in this work . for each beam in the search pool , the tps is called by the bao program to calculate an accurate dose for a uniform intensity profile .",
    "the jaws are automatically set for each beam to sufficiently cover the target with some margins .",
    "the kernel is then extracted from the tps using the tlp method ( section [ tlpsection ] ) .",
    "note that we do _ not _ optimize the number of beams in this study .",
    "the bao selects the optimal set of beams from the search pool .",
    "successive sets of beam angles are generated during the bao by using the fsa algorithm ( szu and hartley 1987 ) .",
    "the efficacy of this global search method has been proven in many fields , including imrt and beam - angle optimization ( webb 1989 , 1991 , mageras and mohan 1993 , xiang and gong 2000 , pugachev 2000 ) .",
    "the fsa is known to be much more efficient than the classical sa ( csa ) algorithm ( kirkpatrick 1983 ) . to converge to a global minimum with probability one ,",
    "the csa requires the annealing temperature to be lowered with an inverse - logarithmic schedule : @xmath5 , where @xmath6 is the iteration number ( geman and geman 1984 ) . on the other hand ,",
    "the fsa allows the temperature to be lowered with a much faster schedule ( szu and hartley 1987 ) :    @xmath7    the sa temperature @xmath8 is used in determining whether a new set of beam angles is to be accepted or rejected .",
    "note that temperature in this context should be understood only as an optimization parameter and it does not have any relation , except in analogy , to the temperature of any physical system . a move generated by the fsa",
    "is accepted with a metropolis probability ( metropolis 1953 ) :    @xmath9 , \\label{metropolis}\\ ] ]    where @xmath10 is the change of the of ( score ) .",
    "thus a downhill move is always accepted while an uphill move is accepted with a probability @xmath11 .",
    "the metropolis probability allows the optimization to simulate the behavior of a physical system in a thermal equilibrium while the sa temperature schedule controls the lowering of temperature such that the system is effectively at a thermal equilibrium at any time . as in a physical system",
    ", this recipe ensures that local minima are properly sampled and the global minimum is reached as the temperature is lowered to zero .",
    "it should be noted that @xmath10 in equation [ metropolis ] is the difference between the _ optimal _ score ( final value of objective function ) of the current trial set of beams and that of the last accepted set of beams .",
    "each of these scores is the output of a _ beam - profile _ optimization performed on the corresponding set of beams .",
    "details of the beam - profile optimization is not needed by the fsa algorithm whose task is to generate subsequent sets of beams and accept or reject each set based on the value of its _ optimal _ score .      the relative efficiency of the fsa over the csa is related to the sampling distribution that it uses . at each bao iteration ,",
    "fsa samples the _ changes _ to the current beam angles @xmath12 from a _ long - ranged _ cauchy - lorentz distribution :    @xmath13^{-(n+1)/2},\\ ] ]    where @xmath14 is the number of beam angles ( the dimension of the vector * x * ) .",
    "in contrast to fsa , the csa uses a _ short - ranged _ gaussian sampling distribution : @xmath15 $ ] , where @xmath16 is the temperature - dependent width of the sampling distribution .",
    "search - space regions farther away than @xmath16 from the current position are practically not sampled by the csa distribution and therefore csa requires a larger number of iterations than fsa to thoroughly sample the entire search space .",
    "several different choices for the definition of @xmath16 are available in the literature ( mageras and mohan 1993 ) and , in general , the `` best '' choice for an application can only be found by trial and error .",
    "for the fsa work reported in this paper , we have used a simple form @xmath17 .",
    "the value of the range parameter @xmath18 was chosen such that even at the lowest temperature ( @xmath19 in this paper ) each beam direction still has 1% probability to jump to another direction `` farthest away '' from it ( e.g. , from 0@xmath4 to 180@xmath4 gantry angle ) .",
    "thus at any temperature , the current trial set of beams always has a finite probability to jump to any other point in the search space .",
    "the ability to sample regions beyond the local neighborhood is imperative in the simulated annealing method to avoid being trapped in a local minimum .    in generating the random move for the set of beam angles",
    "@xmath12 we use the approach where the orientations of _ all _ beams in the current set are simultaneously updated .",
    "this has been shown ( mageras and mohan 1993 ) to be more effective than the alternative approach , in which one beam is picked randomly from the current set and its orientation is moved by a random distance which is picked from the sampling distribution ( das 2003 ) .",
    "the total dose at a given voxel , @xmath20 , is related linearly to the beamlet weights @xmath21 by the dose kernel @xmath22 :    @xmath23    note that in this equation the beamlet index @xmath24 comprises also the beam index ; the index @xmath24 runs over all beamlets in all beams .",
    "the dose kernel @xmath22 is a sparse matrix . at each dose voxel ,",
    "significant contributions to its dose come only from a limited number of beamlets in each beam , the largest contribution being from the beamlet that directly traverses the dose voxel .",
    "the sparse nature of the kernel matrix can be shown numerically by , e.g. , plotting the magnitude of the elements of the square matrix @xmath25 ( crooks and xing 2001 ) .",
    "this also gives a measure of the overlap between beamlets .",
    "the fact that the kernel matrix is sparse has been used to devise a fast , albeit approximate , table - lookup ( tlp ) dose calculation method , that is useful for imrt optimization ( wu 2003 ) .",
    "this efficient method was proposed to improve the performance of applications that involve a great number of dose calculations . in the present work",
    "we have used this method as the fast dose calculation engine for our imrt bao . in the tlp method ,",
    "each dose voxel is assigned one , and only one , beamlet from each beam , namely the beamlet whose raytrace intersects the voxel . the dose to the voxel is initially calculated using an accurate method , e.g. , the superposition / convolution ( sc ) method , for a uniform intensity profile for all beams . the tlp kernel is then calculated using the following formula :    @xmath26    once the kernel is calculated , dose calculation in subsequent iterations is done by looking up the kernel .",
    "note that in addition to improving the speed of the calculation , the tlp method also greatly reduces the number of kernel elements that need to be saved and read , and therefore the time needed to access them .",
    "this number , for each beam , is equal to the number of dose voxels because of the one - to - one dose - beamlet correspondence ( wu 2003 ) . the use of this fast dose - calculation method in our imrt optimization will be further described in section [ optimizationsection ] .      for each trial set of beam angles generated during the bao",
    ", an imrt optimization is performed to optimize the beam profile .",
    "this imrt optimization is implemented by using an objective function , or score , that provides a measure of `` distance '' between the current dose distribution and the desired distribution .",
    "starting from an initial distribution , the objective function is iteratively minimized by the optimizer .",
    "several types of objective function ( of ) exist in the literature and implemented in clinical imrt optimization systems . among these are",
    "the dose - based , dv - based , and the biology - based functions .",
    "the dose - based of is the most straightforward conceptually and the easiest to implement ( webb 1989 ) : it uses a penalty which is a quadratic function of the difference between the actual dose and the desired dose , which is usually the prescription dose for the tumor and zero for the organs at risk ( oars ) .",
    "the dv - based objective function is among the ones that are most useful in imrt optimization ( bortfeld 1997 , spirou and chui 1998 , wu 2000 ) .",
    "it has the advantage of being more intuitive than the biology - based ofs and more flexible than , since it is the superset of , the dose - based of .",
    "the dv - based optimization typically requires more iterations to achieve convergence than the dose - based optimization .",
    "furthermore , it requires the dose - volume histogram ( dvh ) to be computed after each dose calculation which adds to the total optimization time . in general , however , dv objective requires less adjustment of the optimization parameters to achieve a suitable plan ( wu 2000 ) .",
    "although multiple local minima exist in a dv - based imrt optimization ( they are absent in dose - based optimization ) , it has been shown ( wu and mohan 2002 , llacer 2003 ) that they are not expected to affect the outcome of optimization using gradient techniques in any clinically significant way .",
    "for the purpose of establishing our notation for later reference in the rest of this paper , here we present a brief description of our implementation of the dv of .",
    "there are two types of constraint in a dv - based optimization , each is specified by a set of dose - volume values @xmath27 .",
    "the first type of constraint ( upper constraint ) requires the volume receiving dose greater than @xmath28 , which is denoted by @xmath29 , to be _ less _ than @xmath30 .",
    "this constraint is implemented by searching for the dose value @xmath31 such that @xmath32 .",
    "a penalty is charged if @xmath33 , which is equivalent to @xmath34 since the dvh is a non - increasing function of dose .",
    "the upper constraint for a dv - based objective function therefore has the following form :    @xmath35    here @xmath36 is a heaviside step function defined by    @xmath37    an upper constraint is used to limit the dose to an oar or the hot - spot regions in a target .",
    "the index @xmath6 in the summation runs over all voxels in the oar , while @xmath38 is the penalty prefactor .",
    "the constraint s objective is to reduce the volume of the oar that receives dose greater than @xmath28 ; it therefore penalizes voxels that have dose @xmath39 .",
    "note , however , that voxels that have dose greater than @xmath31 are not penalized since the total volume of such voxels is already lower than @xmath30 .",
    "a lower constraint is used to limit the cold - spot regions in a target .",
    "this constraint requires @xmath40 , the volume receiving dose greater than @xmath28 , to be _ greater _ than @xmath30 .",
    "the penalty is imposed if @xmath41 , or equivalently if @xmath42 :    @xmath43    in an imrt optimization , dv constraints are assigned by the planner to the volumes of interest ( vois ) .",
    "each voi can have more than one constraint ; these constraints control the shape of the dvh curve for the corresponding voi . since there is no specific desired dose for each voi in a dv - based optimization , in contrast to dose - based optimization ,",
    "the quality of the dvh of one or more vois can be sacrificed slightly by the optimizer to improve those of some other vois .",
    "the importance of each dv constraint , relative to the other existing constraints , is set by the relative value of its penalty prefactor .      for each trial set of beam angles in the bao , an iterative imrt optimization using the newton s method",
    "is performed to optimize the beam profiles by minimizing a dv - based objective function . at each iteration during the imrt optimization each beamlet weight @xmath21 is updated to @xmath44 .",
    "the size of this update @xmath45 depends on the current values of dose and the kernel : @xmath46.$ ] the procedure for computing @xmath45 can be found in wu and mohan ( 2000 ) and will not be repeated here .",
    "our imrt optimization program is interfaced with a commercial 3d tps . for a given set of beams ,",
    "we start from a uniform intensity profile for all beams and compute an accurate dose @xmath47 using the dose calculation engine ( which is based on the sc method ) of the tps .",
    "kernel @xmath48 is then calculated for the iterative optimization using the tlp method ( equation [ kernelformula ] ) .",
    "note that dose and kernel enter independently in the computation of the beamlet weight update @xmath45 .",
    "this allows different levels of approximation to be used for dose and the kernel .",
    "ideally both dose and kernel are computed accurately using , e.g. , an sc method . however , for an imrt system that is interfaced with a commercial tps , the kernel is usually not directly available from the tps , although the dose is . in the io - sc method ( wu and mohan 2000 ) , @xmath45",
    "is obtained using an accurate dose and an approximate kernel at each iteration .",
    "the accurate dose , that incorporates scatter effects , is obtained from the sc dose engine of the tps .",
    "the approximate kernel , on the other hand , is obtained from the accurate sc dose using equation [ kernelformula ] .",
    "although scatter effects are neglected in this approximate kernel , they are partially accounted for in the calculation of @xmath45 since a full - scatter dose is used .",
    "the tlp method of constructing an approximate kernel has been found to be useful in practice ( wu 2003 ) and this io - sc method has been used for imrt routinely in our clinic .",
    "the main limitation of the io - sc method is the fact that the dose has to be computed at each iteration using the sc dose engine from the tps .",
    "the total optimization time is then strongly dominated by the lengthy time spent on repeated dose calculations .      for the purposes of bao , we introduce a further approximation to the computation of @xmath45 which provides a significant speed up in the calculation time .",
    "two different methods of dose calculation are used in the io - tlp method .",
    "an _ initial _",
    "dose is calculated accurately using the sc method of the tps .",
    "a kernel is then generated from this accurate dose using equation [ kernelformula ] . in _",
    "subsequent _ iterations , instead of computing a fully accurate dose using the sc method , dose is calculated by looking up the kernel , i.e. , using equation [ doseformula ] . thus _ both _ dose and kernel are approximate in the io - tlp method as opposed to only the kernel being approximate in the io - sc method .",
    "note that scatter effects are not totally absent in the io - tlp method because a full - scatter dose is always used as the initial dose for the beam - profile optimization .",
    "the tlp method provides a substantial speed advantage over the sc method . since it is based mostly on memory lookup operation , each tlp dose calculation , which is the dose engine in the io - tlp method , is typically at least two orders of magnitude faster than the corresponding sc calculation , which is used in the io - sc method . in comparing the speed of these two optimization methods ,",
    "we need to consider two separate situations : ( 1 ) a single imrt optimization for a given set of beams ; and ( 2 ) the bao in which a large number of sets of beams ( 1000 in this work ) are optimized consecutively . in the single imrt case",
    ", the io - tlp method uses the tlp dose engine to calculate the total dose at each iteration _ except _ the first one where sc is used to compute the kernel .",
    "the io - sc method , on the other hand , uses the sc dose engine at each iteration .",
    "the speed ratio between the io - tlp and io - sc methods in this case is given roughly by the total number of iterations needed to converge the optimization , which is usually about 1020 in our imrt system .",
    "in the case of bao , the kernel for each beam in the search pool is computed , using the sc method , prior to any imrt optimization . during the beam - profile optimization of each",
    "given set of beams , _ no _ sc dose calculation is needed because the kernels have all been computed and can be quickly read from memory by the tlp method .",
    "except for the time overhead spent in the initial calculation of the kernels , which is small relative to the total bao time ( table [ cputime ] ) the speed ratio in this case is given directly by the speed ratio between the tlp and the sc methods .",
    "thus our bao system is at least two orders of magnitude faster than it would be if we used the sc method as the dose engine for beam - profile optimization .",
    "-0.4 in    the feasibility of using this approximation for a bao is demonstrated in fig .",
    "[ lookuppinnacle ] where we compare the optimal scores obtained using the io - sc method with the corresponding scores obtained using the io - tlp method .",
    "this plot has been generated using 100 randomly selected sets of 3 beams that were used to plan a typical prostate case .",
    "each score shown in fig .",
    "[ lookuppinnacle ] is the square root of the optimal value ( according to the respective optimization method ) of the objective function which is the sum of contributions from all dv constraints applied to the vois in this case ( wu and mohan 2000 ) .",
    "it can be seen that the io - tlp scores are well correlated with the io - sc scores : `` good '' or `` bad '' sets of beam angles according to the io - sc method are predicted similarly by the io - tlp method . in general the io - tlp scores",
    "are lower than the io - sc scores .",
    "this is due to the fact that less scatter components are included in the io - tlp method than in the io - sc method .",
    "dose `` leakage '' outside the target , due to scatter , is slightly underestimated by the io - tlp method and this gives rise to the undercounting of the score and the finite variance of the correlation .",
    "it should be noted that the systematic score undercounting in the io - tlp method is practically irrelevant to a bao since only the relative _ ranking _ of different sets of beams is needed .",
    "the presence of a finite variance in the correlation indeed introduces some limitation to the predicting power of the io - tlp method .",
    "it is the purpose of this paper , however , to show that even with this limitation the io - tlp method can still be used as an effective , and efficient , imrt workhorse in a bao system .",
    "it can be seen in figure [ flowchart ] that our bao algorithm simply serves as an additional `` outer loop '' to a normal imrt optimization ( wu and mohan 2000 ) .",
    "the beam - profile optimization component of the bao , however , uses a different dose - calculation engine than the one that is used in normal imrt optimization .",
    "the io - tlp method is used as the beam - profile optimizer during a bao , because of its speed , while a normal imrt optimization ( for a given set of fixed beam angles ) should be performed using the io - sc method , because of its accuracy .",
    "-0.4 in    it should be noted that although the io - tlp method is used during the bao , a final beam - profile optimization using the io - sc method is performed on the optimal set of beam angles output by the bao .",
    "this is a part of the finalization step shown in the last box in figure [ flowchart ] .",
    "this final optimization of the bao plan facilitates its comparison with a human - prepared plan , which is also optimized using the io - sc method . in the following section , _ all _ of the displayed results",
    "have been produced using a io - sc - based optimization .",
    "-0.4 in    @lcc parameter & prostate & head - and - neck + number of ct slices & 26 & 129 + dose resolution & 0.2 @xmath49 0.2 @xmath49 0.2 cm@xmath3 & 0.2 @xmath49 0.2 @xmath49 0.2 cm@xmath3 + dose matrix dimension & ( 51,87,62 ) & ( 175,91,119 ) + size of bitmap vector & 98,985 & 388,238 + intensity matrix size ( per beam ) & @xmath51 & @xmath52 + intensity resolution & 0.3 @xmath49 0.5 @xmath53 & 0.3 @xmath49 0.5 @xmath53 + target volume ( cc ) & 91 ( prostate ) & 62 ( gtv ) , 175 ( ctv ) + oar volume ( cc ) & 252 ( bladder ) & 24 ( cord ) , 843 ( nodes ) + & 78 ( rectum ) & 32 , 17 ( right , left parotid ) +      two cases have been used in this work to test the practicality of our bao system : a prostate case and a head - and - neck case .",
    "some of the system parameters of these two cases are displayed in table [ systemcomparison ] .",
    "the prostate case represents the cases with relatively small size and simple arrangement of the target and the oars .",
    "the head - and - neck ( hn ) case represents the other end of the spectrum namely those with relatively large size and with multiple targets that are located close to sensitive oars . for the prostate case",
    "we compare the bao results for 3 , 5 , and 7 coplanar beams with that of the corresponding number of equispaced coplanar beams .",
    "we also examine the dependence of the improvements that can be obtained from bao on the criteria used to guide the optimization .",
    "this is done by studying the results of two different sets of criteria : a `` soft '' and a `` hard '' set .",
    "for the hn case we compare the bao results for 7 and 9 _ non_-coplanar beams with that of 9 equispaced coplanar beams .",
    "the computational time required to perform a bao on a given case generally scales with the system size .",
    "this is determined principally by the product of the total number of beamlet intensities that need to be optimized and the total number of voxels for which dose needs to be computed during the optimization .",
    "note that table [ systemcomparison ] lists the _",
    "typical _ size of the intensity matrix ( which is the size of the smallest rectangle that encloses the target in the bev of the beam ) since the specific size generally varies with the orientation of the beam .",
    "furthermore , the number of beamlet intensities that are optimized is generally less than the size of the intensity matrix because the beamlets that do not pass through any voxel in the target can be completely turned off .",
    "although increasing the number of optimization criteria is expected to increase the total optimization time , the increase is minimal because once the dose is calculated the value of the ofs can be computed very quickly .",
    "the size of the bitmap vector for the hn case in table [ systemcomparison ] is about 4 times that of the prostate case and the size of its intensity matrix is about @xmath54 times larger .",
    "thus , for the same number of beams , the total imrt optimization time for the hn case is expected to be about 48 times that of the prostate case .",
    "-0.4 in      figures [ 3beamsprostate ] and [ 5and7beamsprostate ] display the improvements that can be obtained from bao for a prostate case .",
    "each of the results shown in these figures has been obtained from a 1000-iteration fsa run and was completed in about 12 hours on a 400 mhz workstation ( table [ cputime ] ) .",
    "the initial sa temperature @xmath55 was set to an arbitrary large number ( @xmath56 ) which allowed practically all random moves generated by the sa sampling distribution to be accepted .",
    "this is an important practical requirement of the sa algorithm : the initial temperature has to be high enough to allow random sampling of the search space during the initial iterations .",
    "subsequently , the temperature was lowered using a @xmath57 schedule .",
    "figure [ sascore ] displays a typical progression of the score with increasing iteration number .",
    "the optimization is stopped after 1000 iterations ( final temperature is 1 ) because practically the temperature is already too low to allow a further significant change in the score to occur .",
    "note that , based on our experience as shown in figure [ sascore ] , the optimization can generally be terminated after a few hundred iterations without incurring a significant cost in the final score .",
    "@lcc case&cpu speed & user cpu time + 3-beam prostate & 400 mhz & 1 h 5 min + 5-beam prostate & 400 mhz & 1 h 40 min + 7-beam prostate & 400 mhz & 2 h 20 min + 7-beam hn & 750 mhz & 13 h 15 min + 9-beam hn & 750 mhz & 15 h 0 min +    @lcccc voi&type&dose ( cgy)&volume ( % ) & penalty + target & lower & 7200 & 90 & 10 + & upper & 7900 & 5 & 3 + bladder & upper & 6000 & 1 & 5 + & upper & 4000 & 5 & 3 + rectum & upper & 6000 & 5 & 5 + & upper & 4000 & 8 & 5 +    the optimal beams for this prostate case have been chosen from 180 coplanar 18-mv photon beams ( at zero couch angle ) which are distributed uniformly over the @xmath58 range for the gantry angle with a @xmath59 interval . to facilitate the comparison ,",
    "each plan shown has been normalized to 72 gy at 90% of the target volume .",
    "the dv - criteria that were used for the imrt optimization are listed in table [ prostatecriteria ] .",
    "figure [ 3beamsprostate]a compares the dvhs of a set of 3 equispaced beams and those of a set of non - equispaced beams selected by the bao .",
    "it can be seen that the bao beams provide significant improvements over the equispaced beams .",
    "the target receives a more uniform coverage while both of the oars , the bladder and rectum , receive significantly less dose .",
    "since in a 3-beam equispaced set each beam is separated from its neighbors by a relatively large @xmath60 interval , it is important to examine if better results can be obtained from equispaced beams by uniformly rotating the complete set .",
    "this is done in figure [ 3beamsprostate]b where we compare 4 different sets of equispaced beams , each equispaced configuration is rotated by @xmath61 from the previous one . while their target coverages are similar , they spare the oars rather differently .",
    "it is interesting to observe that the set that provides better protection for the bladder does so at the expense of the sparing of the rectum , or vice versa .",
    "in addition , all of these plans are still inferior to that of the bao beams shown in figure [ 3beamsprostate]a .",
    "these comparisons illustrate the importance of non - equispaced beam - angle selection in imrt .",
    "dvh comparisons between equispaced and bao plans for the same prostate case using 5 and 7 beams are presented in figures [ 5and7beamsprostate]a and [ 5and7beamsprostate]b respectively .",
    "these plans have been optimized using the same set of dv criteria as that used for the 3-beam plans in figure [ 3beamsprostate ] .",
    "although it is expected that the importance of bao will diminish as more beams are used ( stein 1997 ) , these cases show that bao can still provide rather significant improvements over the equispaced beams .",
    "we have also performed similar comparisons as in figure [ 3beamsprostate]b between different sets of 5 and 7 equispaced beams . as is expected ,",
    "the difference among different 5- and 7-beam sets is smaller than that for the 3-beam set and it decreases as we increase the number of beams from 5 to 7 .    @lccccccccc beam number & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 + gantry ( 9 beams ) & 5 & 100 & 140 & 205 & 240 & 245 & 290 & 300 & 345 + couch ( 9 beams ) & 0 & 45 & 45 & 45 & 45 & 315 & 45 & 45 & 0 + gantry ( 7 beams ) & 20 & 105 & 115 & 245 & 320 & 325 & 340 & - & - + couch ( 7 beams ) & 315 & 0 & 45 & 0 & 45 & 315 & 45 & - & - +    @lcccc voi&type&dose ( cgy)&volume ( % ) & penalty + gtv & lower & 7300 & 99 & 50 + & upper & 7700 & 0.1 & 30 + ctv & lower & 6200 & 96 & 50 + & upper & 6900 & 40 & 20 + nodes & lower & 5600 & 95 & 50 + & upper & 5800 & 15 & 20 + cord & upper & 3000 & 0.1 & 50 + brainstem & upper & 3000 & 0.1 & 50 + left parotid & upper & 2500 & 30 & 20 + & upper & 5000 & 1 & 20 + right parotid & upper & 1000 & 32 & 50 + & upper & 3000 & 10 & 50 +    @lc dv & prescription ( cgy ) + d@xmath62(gtv ) & @xmath63 6810 + d@xmath64(gtv ) & @xmath65 7491 + d@xmath66(ctv ) & @xmath63 6000 + d@xmath67(nodes ) & @xmath63 5400 + d@xmath68(cord ) & @xmath69 4500 + d@xmath68(brainstem ) & @xmath69",
    "5500 +    -0.4 in    -0.4 in    -0.4 in      due to its anatomical position , head - and - neck tumors are good candidates for the application of non - coplanar imrt .",
    "limited experience with non - coplanar hn plans and the fact that selection of non - coplanar beam directions for imrt is a highly non - intuitive process also make global search methods like the fsa , which is implemented in our bao system , particularly attractive .",
    "figures [ 9beamshn ] and [ 7beamshn ] compare the dvhs for a hn case of 9 and 7 non - coplanar beams , respectively , with those of a benchmark 9 equispaced coplanar beams .",
    "the dv criteria used to optimize these hn plans are listed in table [ hncriteria ] while the gantry and couch angles selected by our bao algorithm for these sets are tabulated in table [ noncoplanar ] .",
    "each of the bao results for this hn case has been obtained from a 1000-iteration fsa runs .",
    "the optimal beams have been chosen from 216 possible directions : the search pool for this case consists of 3 possible couch angles ( @xmath70 , @xmath71 , and @xmath72 ) with 72 possible gantry angles distributed uniformly with @xmath73 interval for each couch angle . in principle , finer resolution for the couch angle may be used .",
    "however , this will also increase the memory requirement since our bao system , as it is currently implemented , requires the kernel for each beam to be available for quick access in the system memory . for this hn case ,",
    "the size of the kernel is about 3 mb for each beam and therefore it requires about 650 mb of memory to store all the kernels .",
    "we have used a 750-mhz sun workstation to perform the bao for this hn case .",
    "the 1000-iteration bao run for the 9 non - coplanar beams required 17 hours to complete ( this includes about 2 hours of computing time required for kernel extraction ) while the 1000-iteration run for the 7 non - coplanar beams required 13 hours ( kernels were read from disk for this case ) .",
    "the relatively long optimization time for this hn case , compared to the corresponding time for the prostate case , is due to the substantially larger size of the system . a side - by - side comparison of these two systems is presented in table [ systemcomparison ] .",
    "note that , as pointed out previously in the discussion regarding figure [ sascore ] , the number of iterations used can be substantially reduced without significant reduction in the optimal score .",
    "this has the potential of shortening the total optimization time by a factor of two .",
    "further reduction in time can be obtained from using a more selective search , e.g. not allowing the beams to be too close to each other , inclusion of prior knowledge , and utilization of parallel processors . these possible avenues for improvements",
    "are currently being investigated .",
    "figure [ 9beamshn ] compares the dvhs for a set of 9 non - coplanar bao beams with those of a 9-beam equispaced coplanar set .",
    "the bao set provides both better dose uniformity at the gtv and ctv and better protection of the parotid glands .",
    "this better sparing of the parotid glands can also be seen in the isodose contours shown in figure [ contourshn ] .",
    "figure [ 7beamshn ] shows that a plan of similar quality can also be obtained using 7 non - coplanar beams , although in this case the quality of target coverage is lower than that of the 9 non - coplanar beams .",
    "the dose prescriptions for these plans are shown in table [ hnprescription ] .",
    "the plans have been normalized to best satisfy all of these prescriptions .",
    "these have been achieved by normalizing the dvhs to 60 gy at 95% of the ctv volume .",
    "@lcccc voi&type&dose ( cgy)&volume ( % ) & penalty + target & upper & 7200 & 90 & 10 + & lower & 7900 & 5 & 3 + bladder & lower & 6000 & 3 & 5 + & lower & 4000 & 10 & 1 + rectum & lower & 6000 & 5 & 5 +    -0.4 in      a noteworthy feature of a dv - based optimization is that further improvement will no longer be attempted by the optimizer once the criteria are satisfied . in other words ,",
    "once the contribution of a dv criterion to the of reaches zero , it becomes irrelevant to the optimizer .",
    "consider , e.g. , a single criterion which is assigned to the rectum : @xmath74 cgy at 5% of its volume .",
    "once this criterion is satisfied , e.g. , when @xmath75(rectum ) has been lowered to 5900 cgy , the optimizer will no longer attempts to improve the dose to the rectum , even though it is still possible to reduce its dose further .",
    "we have found that the improvement on plan quality that is output by our bao system generally depends on the dv criteria that we assign to the vois .",
    "figure [ softcriteriaplot ] compares two of the top 5 plans generated by the bao ( for the prostate case presented in section [ prostatecase ] ) using several `` soft '' criteria listed in table [ softcriteriatable ] , with the corresponding plan for a set of 3 equispaced beams .",
    "these plans have been generated for the same prostate case as that used in figures [ 3beamsprostate ] and [ 5and7beamsprostate ] .",
    "the bao sets are both predicted , by the io - tlp method which is used during the bao , to have lower score compared to the equispaced beams ( 55 and 75 for plans shown in figure [ softcriteriaplot]a and [ softcriteriaplot]b , respectively , compared to 186 for the equispaced beams ) .",
    "however , upon reoptimization using the io - sc method , the bao sets produce higher score than the equispaced beams ( 186 and 212 for figure [ softcriteriaplot]a and [ softcriteriaplot]b , respectively , compared to 162 for the equispaced beams ) .    the large score increase encountered in going from the io - tlp to the io - sc method for the plan shown in figure",
    "[ softcriteriaplot]a is largely due to the additional score accumulated by the dvh of the rectum . in this case , the io - tlp method minimized the score by creating a steep gradient of the dvh curve just below the 6000 cgy dose .",
    "note that even though below 6000 cgy the bao dvh for the rectum is _ higher _ , and therefore is worse , than the corresponding dvh of the equispaced beams , the contribution of this dvh to the of can be _ smaller _ if its dvh at 6000 cgy is lower than the corresponding value for the equispaced beams .",
    "this is specifically what happens in this case due to the steep gradient of the bao dvh curve . in going from the io - tlp to the io - sc method ,",
    "however , this steep gradient can not be sustained because of the inclusion of more scatter components in the io - sc method .",
    "this `` dose leakage '' substantially increases the partial volume of the rectum that receives dose greater than 6000 cgy and , consequently , produces a large increase in score .",
    "the bao plan in figure [ softcriteriaplot]b satisfies the criteria listed in table [ softcriteriatable ] as well as , or indeed better than , that of the equispaced beams . in this case , the higher score of the bao plan is due to the contribution from the `` normal tissue '' ( nt ) region .",
    "the nt region encompasses generic normal tissue surrounding the target that does not belong to any particular oar ( wu and mohan 2000 ) . for the prostate case that we use in this work ,",
    "the nt is a 1 cm extension of the target that is not part of any oar and it is assigned an upper constraint of 6000 cgy at 5% of its volume .",
    "the `` dose leakage '' from the target to its surrounding nt , for the case shown in figure [ softcriteriaplot]b is substantially larger than the allowance set by the assigned dv criterion and it therefore introduces a significant contribution to the of on going from the io - tlp to the io - sc method .",
    "this is due to the small angular separation of two of the 3 beams in the bao set ( @xmath76 and @xmath77 ) that provides an elongated dose distribution along the direction of these beams .",
    "in contrast to this relatively large uncertainty in the prediction of the io - tlp method for cases with `` soft '' dv criteria , in our experience we found that its prediction is much more reliable for cases with more demanding criteria , such as listed in table [ prostatecriteria ] and displayed in figures [ 3beamsprostate ] and [ 5and7beamsprostate ] .",
    "although we only present this dependence on criteria using a prostate - case example in this paper , similar behavior has also been observed for the hn case .",
    "one possible reason that may be given for this observation is that the degeneracy of the solution , i.e. the multiminima of the of , is larger for `` soft '' criteria ( wu and mohan 2002 ) .",
    "a careful study , however , is necessary in order to provide a definitive answer to this question . from the point of view of clinical applications",
    ", the fact that bao is more useful for `` hard '' cases is not expected to eliminate its practical relevance .",
    "it is well known that `` soft '' cases can be planned satisfactorily with equispaced beams or , indeed , class solutions . on the other hand , for `` hard '' cases , e.g. those of re - irradiation or of complicated geometry , class solutions are non - existent ( almost by definition ) and equispaced beams may not provide the optimal solution . for these cases",
    "the fast bao described in this paper provides an attractive alternative to a manual trial - and - error approach .",
    "several schemes have been proposed recently to rank beam directions according to their _ individual _ potential for creating a desirable imrt distribution such as the single - beam cost function ( oldham 1998 ) , beams - eye - view dosimetrics ( bevd ) ( pugachev and xing 2001 ) , and the figure - of - merit parameter ( chuang 2003 ) .",
    "these schemes have also been studied as a possible way to intelligently accelerate a bao .",
    "if a particular beam direction can be reliably predicted to always give rise to high values of objective function , independent of the directions of the other beams in the set it is a member of , it can be quickly removed from the search space .",
    "it is perhaps important to point out here , in connection with the of of the optimization , that these schemes are expected to have less significance in a dv - based optimization than in a dose - based optimization for which they have been proposed and studied .",
    "individual ranking of beam directions is useful in a dose - based optimization where each voi is assigned a specific prescribed dose .",
    "in contrast , in a dv - based optimization each voi is effectively assigned a specific _ range _ of acceptable doses . in this case , several different distributions of the total dose may have equally good value of the dv of ( in other words , the of possesses multiple local minima and degenerate solutions ) .",
    "it is therefore less meaningful to attach a specific geometric `` shape '' , and therefore potentially `` good '' or `` bad '' beam directions for creating this shape , to the optimal distribution .",
    "no a priori knowledge has been used to guide the selection of beam angles in this work .",
    "the use of reliable prior knowledge is expected to further improve the speed and potential of our bao system .",
    "however , the complexity of the bao problem requires judicious selection , and therefore careful systematic study , of what `` knowledge '' is best to be used for each given case . as has been discussed in this paper , this systematic study is especially more pertinent to the dv - based imrt optimization that we use in our bao system , because of the presence of the multiple local minima of the of , than to the dose - based optimization that is commonly used in other bao systems . in our bao system ,",
    "the beam angles are selected from the preset values in the search space .",
    "some prior knowledge can be incorporated in the initial selection of beams that are to be included in the search space , e.g. , more and less beams can be positioned in favorable and unfavorable directions , respectively .",
    "alternatively , the beam angles selected during the optimization can be restricted to have a minimum separation from each other .",
    "prior knowledge can also be used to reduce the number of beams in the search pool .",
    "although large search pools are used in this study , 180 and 216 beams for prostate and hn case respectively , in a clinical setting one may not need to use such large numbers .",
    "using a reasonable spacing of 10@xmath4 between adjacent beams in a coplanar pool , e.g. , allows us to reduce the size of the search pool to 36 .",
    "this will significantly decrease the number of possible _ combinations _ of beam angles to be sampled during the bao . in the current version of our bao system",
    ", each beam in the trial set is given a uniform initial profile prior to the beam - profile optimization .",
    "instead of this uniform intensity distribution , the initial beam profile can be set to a _",
    "non_-uniform one , chosen based on some prior knowledge .",
    "this has the potential of reducing the number of iterations needed for the beam - profile optimization and , consequently , the total bao time .",
    "in this paper we have demonstrated that a combination of a fast table - lookup dose calculation method and the fsa algorithm can be used in a practical bao system .",
    "this method has the advantage of being able to produce clinically significant improvement within a reasonable time .",
    "we showed , e.g. , that the beam angles of a 7-beam prostate plan can be optimized within about 2 hours on a moderate 400 mhz workstation . a dv - based of",
    "is used to guide the imrt optimization in our bao system .",
    "this provides a direct link to our clinical imrt system and facilitates the comparison between the bao plans and those produced by human planners .",
    "since the beam - angle optimizer in our system simply wraps around the imrt beam - profile optimizer , other ofs that are available to our imrt optimizer , such as eud , can also be used for bao in our system .",
    "our bao system can also search for the optimal set over non - coplanar beams",
    ". this feature may be particularly helpful to planners because of the insufficient experience with non - coplanar beams in treatment planning .",
    "* acknowledgements *    this work is supported in part by grant ca74043 from the national cancer institute and a research grant from philips radiation oncology systems .",
    "bortfeld t and schlegel w 1993 optimization of beam orientations in radiation therapy : some theoretical considerations 291304    bortfeld t , stein j and preiser k 1997 clinically relevant intensity modulation optimization using physical criteria _ xii international conference on the use of computers in radiation therapy _ ( medical physics publishing , madison , wi ) 14          das s , cullip t , tracton g , chang s , marks l , anscher m and rosenman j 2003 beam orientation selection for intensity - modulated radiation therapy based on target equivalent uniform dose maximization _ int . j. radiat .",
    "phys . _ * 55 * 215224                oldham m , khoo v , rowbottom c g , bedford j and webb s 1998 a case study comparing the relative benefit of optimising beam - weights , wedge - angles , beam orientations and tomotherapy in stereotactic radiotherapy of the brain 212346"
  ],
  "abstract_text": [
    "<S> this paper describes the algorithm and examines the performance of an imrt beam - angle optimization ( bao ) system . in this algorithm </S>",
    "<S> successive sets of beam angles are selected from a set of predefined directions using a fast simulated annealing ( fsa ) algorithm . </S>",
    "<S> an imrt beam - profile optimization is performed on each generated set of beams . </S>",
    "<S> the imrt optimization is accelerated by using a fast dose calculation method that utilizes a precomputed dose kernel . </S>",
    "<S> a compact kernel is constructed for each of the predefined beams prior to starting the fsa algorithm . </S>",
    "<S> the imrt optimizations during the bao are then performed using these kernels in a fast dose calculation engine . </S>",
    "<S> this technique allows the imrt optimization to be performed more than two orders of magnitude faster than a similar optimization that uses a convolution dose calculation engine . </S>",
    "<S> any type of optimization criteria present in the imrt system can be used in this bao system . </S>",
    "<S> an objective function based on clinically - relevant dose - volume ( dv ) criteria is used in this study . </S>",
    "<S> this facilitates the comparison between a bao plan and the corresponding plan produced by a planner since the latter is usually optimized using a dv - based objective function . </S>",
    "<S> a simple prostate case and a complex head - and - neck ( hn ) case were used to evaluate the usefulness and performance of this bao method . for the prostate case we compared the bao results for 3 , 5 , and 7 coplanar beams with that of the same number of equispaced coplanar beams . for the hn case </S>",
    "<S> we compare the bao results for 7 and 9 _ non_-coplanar beams with that of 9 equispaced coplanar beams . in each case </S>",
    "<S> the bao algorithm was allowed to search up to 1000 different sets of beams . </S>",
    "<S> the bao for the prostate cases were finished in about 12 hours on a moderate 400 mhz workstation while that for the head - and - neck cases were completed in 1317 hours on a 750 mhz machine . </S>",
    "<S> no a priori beam - selection criteria have been used in achieving this performance . in both the prostate and the head - and - neck cases , </S>",
    "<S> bao is shown to provide improvements in plan quality over that of the equispaced beams . </S>",
    "<S> the use of dv - based objective function also allows us to study the dependence of the improvement of plan quality offered by bao on the dv criteria used in the optimization . </S>",
    "<S> we found that bao is especially useful for cases that require strong dv criteria . </S>",
    "<S> the main advantages of this bao system are its speed and its direct link to a clinical imrt system </S>",
    "<S> .    * list of abbreviations *    bao = beam angle optimization + crt conformal radiotherapy + csa classical simulated annealing + dv dose volume + dvh dose volume histogram + eud equivalent uniform dose + fsa fast simulated annealing + hn head and neck + imrt intensity modulated radiation therapy + io - sc intensity optimization with superposition convolution + io - tlp intensity optimization with table lookup + oar organ at risk + of objective function + sa simulated annealing + sc superposition convolution + tlp table lookup + tps treatment planning system + voi volume of interest + </S>"
  ]
}