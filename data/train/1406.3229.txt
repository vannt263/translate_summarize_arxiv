{
  "article_text": [
    "given two ( di)graphs @xmath1 and @xmath0 , an _ @xmath1-packing _ in @xmath0 is a collection of vertex - disjoint copies of @xmath1 in @xmath0 .",
    "an @xmath1-packing is called _ perfect _ if it covers all the vertices of @xmath0 .",
    "perfect @xmath1-packings are also referred to as _",
    "@xmath1-factors _ or _ perfect @xmath1-tilings_. note that perfect @xmath1-packings are generalisations of perfect matchings ( which correspond to the case when @xmath1 is a single edge ) .",
    "tutte s theorem characterises all those graphs that contain a perfect matching .",
    "on the other hand , hell and kirkpatrick  @xcite showed that the decision problem of whether a graph @xmath0 has a perfect @xmath1-packing is np - complete precisely when @xmath1 has a component consisting of at least @xmath8 vertices .",
    "thus , for such graphs @xmath1 , it is unlikely that there is a complete characterisation of those graphs containing a perfect @xmath1-packing .",
    "it is natural therefore to ask for simple sufficient conditions which force a graph to contain a perfect @xmath1-packing .",
    "a seminal result in the area is the following theorem of hajnal and szemerdi  @xcite .",
    "[ hs ] every graph @xmath0 whose order @xmath5 is divisible by @xmath4 and whose minimum degree satisfies @xmath9 contains a perfect @xmath2-packing .",
    "it is easy to see that the minimum degree condition here can not be lowered . in recent years",
    "there have been several generalisations of the hajnal  szemerdi theorem .",
    "khn and osthus  @xcite characterised , up to an additive constant , the minimum degree which ensures that a graph @xmath0 contains a perfect @xmath1-packing for an _ arbitrary _ graph @xmath1 .",
    "kierstead and kostochka  @xcite proved an _ ore - type _ analogue of the hajnal  szemerdi theorem : if @xmath0 is a graph whose order @xmath5 is divisible by @xmath4 , then @xmath0 contains a perfect @xmath2-packing provided that @xmath10 for all non - adjacent @xmath11 .",
    "khn , osthus and treglown  @xcite characterised , asymptotically , the ore - type degree condition which ensures that a graph @xmath0 contains a perfect @xmath1-packing for an arbitrary graph @xmath1 .",
    "recently , keevash and mycroft  @xcite proved the following @xmath4-partite version of the hajnal  szemerdi theorem , thereby tackling a conjecture of fischer  @xcite for sufficiently large graphs .",
    "[ rpart ] given @xmath12 there exists an @xmath13 such that the following holds .",
    "suppose @xmath0 is an @xmath4-partite graph with vertex classes @xmath14 where @xmath15 for all @xmath16 . if @xmath17 then @xmath0 contains a perfect @xmath2-packing .",
    "( here @xmath18 denotes the minimum degree of a vertex from one vertex class @xmath19 to another vertex class @xmath20 . ) keevash and mycroft  @xcite actually proved a stronger result than theorem  [ rpart ] .",
    "indeed , they showed that the minimum degree condition here can be relaxed to @xmath21 provided that @xmath0 is not isomorphic to one special construction .",
    "further , their result extends to perfect @xmath22-packings where @xmath23 ( see  @xcite for more details ) .",
    "it is natural to seek analogues of the hajnal  szemerdi theorem in the digraph and oriented graph settings .",
    "we consider digraphs with no loops and at most one edge in each direction between every pair of vertices .",
    "an oriented graph is a digraph without @xmath24-cycles . in this paper",
    "we restrict our attention to the problem for digraphs .",
    "see  @xcite for an overview of the known results concerning perfect packings in oriented graphs .",
    "the _ minimum semidegree _",
    "@xmath25 of a digraph @xmath0 is the minimum of its minimum outdegree @xmath26 and its minimum indegree @xmath27 .",
    "let @xmath28 denote the minimum degree of @xmath0 , that is , the minimum number of edges incident to a vertex in @xmath0 .",
    "( note that if both @xmath29 and @xmath30 are directed edges in @xmath0 , they are counted as two separate edges . )",
    "denote by @xmath31 the set of all tournaments on @xmath4 vertices .",
    "our main result is an analogue of the hajnal  szemerdi theorem for perfect tournament packings in digraphs .",
    "[ mainthm ] given an integer @xmath7 , there exists an @xmath13 such that the following holds",
    ". suppose @xmath32 and @xmath0 is a digraph on @xmath33 vertices where @xmath4 divides @xmath5 . if @xmath34 then @xmath0 contains a perfect @xmath3-packing .",
    "notice that the minimum semidegree condition in theorem  [ mainthm ] is tight .",
    "indeed , let @xmath35 such that @xmath4 divides @xmath5 .",
    "let @xmath36 be the digraph obtained from the complete digraph on @xmath5 vertices by removing all those edges lying in a given vertex set of size @xmath37 .",
    "then @xmath38 and @xmath36 does not contain a perfect @xmath3-packing for any @xmath32 .",
    "in general , any digraph @xmath39 on @xmath5 vertices with an independent set of size @xmath37 ( and @xmath40 ) does not contain a perfect @xmath3-packing .    in the case when @xmath3 is the cyclic triangle @xmath41 , theorem  [ mainthm ] verifies a recent conjecture of czygrinow , kierstead and molla  @xcite for large digraphs .",
    "further , notice that theorem  [ mainthm ] is a ` true generalisation ' of the hajnal  szemerdi theorem in the sense that the former implies the latter for large graphs .",
    "we remark that , by applying the same probabilistic trick used by keevash and sudakov in section 7 of  @xcite , one can obtain an asymptotic version of theorem  [ mainthm ] from theorem  [ rpart ] . in",
    "@xcite it was also shown that such an asymptotic version of theorem  [ mainthm ] for @xmath42 follows from a result concerning perfect packings in multigraphs .",
    "similarly to many proofs in the area , our argument splits into ` extremal ' and ` non - extremal ' cases .",
    "when @xmath43 , the extremal case considers digraphs @xmath0 containing a set of vertices of size @xmath44 that spans an ` almost ' independent set ( i.e. @xmath0 is ` close ' to an extremal graph @xmath39 as above ) .",
    "interestingly , when @xmath42 we have an extra extremal configuration ( see section  [ subex ] ) , and thus have two separate extremal cases . in the non - extremal case",
    "our proof splits into two main tasks : finding an ` almost ' perfect @xmath3-packing in @xmath0 and finding a so - called ` absorbing set ' that can be used to cover the remaining vertices with disjoint copies of @xmath3 ( see section  [ subabs1 ] for the precise definition of such a set ) . to obtain the former",
    "we apply a result of keevash and mycroft  @xcite concerning almost perfect matchings in hypergraphs .",
    "we also make use of the directed graph removal lemma ( see e.g. @xcite ) .",
    "a substantial proportion of the paper is devoted to obtaining our desired absorbing set . a more detailed overview of the proof is given in section  [ overview ] .",
    "although the minimum semidegree condition in theorem  [ mainthm ] is ` best - possible ' one could replace the condition by a weaker one .",
    "indeed , for _ transitive _ tournaments we conjecture that the following stronger statement is true .",
    "let @xmath45 denote the transitive tournament on @xmath4 vertices .",
    "[ conj2 ] let @xmath35 such that @xmath4 divides @xmath5 .",
    "suppose that @xmath0 is a digraph on @xmath46 vertices so that for any @xmath47 , @xmath48 then @xmath0 contains a perfect @xmath45-packing .",
    "conjecture  [ conj2 ] would imply the following very recent result of czygrinow , debiasio , kierstead and molla  @xcite .",
    "[ cdthm ] let @xmath35 such that @xmath4 divides @xmath5 .",
    "then every digraph @xmath0 on @xmath5 vertices with @xmath49 contains a perfect @xmath45-packing .    in section",
    "[ easy ] we give a short proof of conjecture  [ conj2 ] in the case when @xmath50 .",
    "we also prove the following asymptotic version of conjecture  [ conj2 ] .",
    "[ 2nonex ] let @xmath51 and @xmath7 .",
    "then there exists an @xmath13 such that the following holds .",
    "suppose that @xmath0 is a digraph on @xmath52 vertices where @xmath4 divides @xmath5 and that for any @xmath47 , @xmath53 then @xmath0 contains a perfect @xmath45-packing .",
    "we give a unified approach to proving theorems  [ mainthm ] and  [ 2nonex ] , though the proof of the former is substantially more involved .",
    "for ` most ' tournaments @xmath3 , there does not exist a ` non - trivial ' minimum outdegree condition which forces a digraph @xmath0 to contain a perfect @xmath3-packing .",
    "indeed , let @xmath32 such that every vertex in @xmath3 has an inneighbour .",
    "let @xmath54 such that @xmath4 divides @xmath5 .",
    "obtain the digraph @xmath0 from the complete digraph on @xmath55 vertices by adding a vertex @xmath56 that sends out all possible edges to the other vertices ( but receives none ) .",
    "but @xmath0 does not contain a perfect @xmath3-packing since @xmath56 does not lie in a copy of @xmath3 .",
    "so certainly conjecture  [ conj2 ] and theorem  [ cdthm ] can not be generalised to arbitrary tournaments @xmath3",
    ". it would be interesting to establish whether the degree conditions in conjecture  [ conj2 ] and theorem  [ cdthm ] force a perfect @xmath3-packing for some _ non - transitive _ tournament @xmath3 on @xmath4 vertices .    in the next section we give an outline of the proofs as well as details about the organisation of the paper .",
    "suppose that @xmath0 and @xmath32 are as in theorem  [ mainthm ] .",
    "further , suppose that there is a ` small ' set @xmath58 with the property that both @xmath59 $ ] and @xmath60 $ ] contain perfect @xmath3-packings for _ any _ ` very small ' set @xmath61 where @xmath62 . then notice that , to find a perfect @xmath3-packing in @xmath0 , it suffices to find an ` almost ' perfect @xmath3-packing in @xmath63 .",
    "indeed , suppose that @xmath36 contains a @xmath3-packing @xmath64 covering all but a very small set of vertices @xmath65 . then by definition of @xmath66 ,",
    "@xmath60 $ ] contains a perfect @xmath3-packing @xmath67 .",
    "thus , @xmath68 is a perfect @xmath3-packing in @xmath0 , as desired .",
    "roughly speaking , we refer to such a set @xmath66 as an ` absorbing set ' ( see section  [ subabs1 ] for the precise definition of such a set ) .",
    "the ` absorbing method ' was first used in  @xcite and has subsequently been applied to numerous embedding problems in extremal graph theory .    in general",
    ", a digraph @xmath0 as in theorem  [ mainthm ] may not contain an absorbing set .",
    "for example , consider the complete @xmath8-partite digraph @xmath69 with vertex classes @xmath70 of size @xmath71 .",
    "( so @xmath69 contains all possible edges with endpoints in different vertex classes . )",
    "then @xmath69 satisfies the hypothesis of theorem  [ mainthm ] in the case when @xmath72 and @xmath50 .",
    "however , if @xmath73 such that @xmath74 then it is easy to see that there does not exist a set @xmath75 such that both @xmath76 $ ] and @xmath77 $ ] contain perfect @xmath78-packings .",
    "notice though that @xmath69 is ` close to extremal ' ( i.e. @xmath69 contains an independent set of size @xmath71 ) .    it turns out that being ` close ' to an extremal example is the only barrier preventing our digraph @xmath0 from containing an absorbing set @xmath66 . indeed , in the case when @xmath79 we show that if @xmath0 does not contain an ` almost ' independent set of size @xmath44 then @xmath0 contains our desired set @xmath66 .",
    "as mentioned in section  [ sec1 ] , when @xmath42 we have an extra extremal configuration @xmath80 ( see section  [ subex ] ) . in this case we show that if @xmath0 is far from @xmath80 and does not contain an ` almost ' independent set of size @xmath71 then @xmath0 contains our desired set @xmath66 ( see theorem  [ nonex1 ] ) .    * constructing the absorbing set in the non - extremal case . * the crucial idea in proving that a non - extremal digraph @xmath0 contains an absorbing set @xmath66 is to first show that @xmath0 has many ` connecting structures ' of a certain type .",
    "for example , to find our desired absorbing set it suffices to show that , for any @xmath81 , there are ` many ' @xmath82-sets @xmath83 so that both @xmath84 and @xmath85 span copies of @xmath3 in @xmath0 . in section  [ consec ]",
    "we prove a number of so - called connection lemmas that guarantee such connecting structures .",
    "this turns out to be quite a subtle process as we prove different connection lemmas depending on the structure and size of @xmath3 .",
    "in particular , we need to deal with the case when @xmath42 separately .",
    "( this stems from the fact that we now have two extremal cases .",
    "see section  [ consec ] for more details . ) in section  [ secnon ] we use the connection lemmas to construct the absorbing set @xmath66 .",
    "* covering the remaining vertices of @xmath0 in the non - extremal case .",
    "* as mentioned earlier , once we have constructed an absorbing set @xmath66 in a non - extremal digraph @xmath0 , it suffices to find an ` almost ' perfect @xmath3-packing in @xmath86 .",
    "for this , we translate the problem into one about almost perfect matchings in hypergraphs .",
    "indeed , from @xmath36 we construct a hypergraph @xmath87 on @xmath88 where , for any @xmath89 , an @xmath90-tuple @xmath91 forms an edge in @xmath87 precisely when @xmath92 spans a subtournament of @xmath3 of size @xmath90 in @xmath36 .",
    "so one may think of @xmath87 as consisting of ` layers ' @xmath93 where @xmath94 contains the edges of size @xmath90 .",
    "for example , if @xmath72 , then the edge set of @xmath95 is @xmath88 , the edge set of @xmath96 consists of all pairs @xmath97 where @xmath98 or @xmath99 and the edge set of @xmath100 consists of all triples @xmath101 that span a copy of @xmath78 in @xmath36 .",
    "@xmath87 is an example of a so - called @xmath4-complex ( see section  [ sec : almost ] for the precise definition ) .    vitally , @xmath87 has the property that a matching in @xmath102 corresponds to a @xmath3-packing in @xmath36 .",
    "we thus apply a result of keevash and mycroft  @xcite on almost perfect matchings in @xmath4-complexes .",
    "( in order to apply this result we again use that @xmath0 is non - extremal . )",
    "this ensures an almost perfect matching in @xmath102 and thus an almost perfect @xmath3-packing in @xmath103 , as desired .    *",
    "the extremal cases . *",
    "finally , we deal with the case when @xmath0 is close to an extremal example .",
    "if @xmath42 and @xmath0 is close to @xmath80 then a relatively short argument shows that @xmath0 must contain a perfect @xmath41-packing ( see lemma  [ exc3 ] ) . on the other hand , the general extremal case",
    "when @xmath0 contains an almost independent set of size @xmath44 is more involved ( see lemma  [ ex1 ] ) .",
    "( note that the class of digraphs @xmath0 on @xmath5 vertices with an almost independent set of size @xmath44 and @xmath104 is wide . )",
    "we draw on ideas from  @xcite to tackle this case .",
    "the extremal cases are the only parts of the proof where we use the full force of the minimum semidegree condition on @xmath0 . indeed ,",
    "the argument in the non - extremal case holds even if we relax the condition to @xmath105 .",
    "the proof of theorem  [ 2nonex ] follows the same general approach as that of theorem  [ mainthm ] in the _ non - extremal _ case : again our two main tasks are to ( i ) find an absorbing set and ( ii ) cover almost all of the remaining vertices with a @xmath45-packing .",
    "thus , where possible , we present the tools for both proofs in a unified way .",
    "indeed , many of our auxiliary results are applied in both proofs .      in the next section",
    "we formally introduce the notion of an absorbing set and define the extremal digraph @xmath80 .",
    "we also introduce other notation and definitions .",
    "we prove conjecture  [ conj2 ] in the case of transitive triangles in section  [ easy ] . in section  [ pfsec ] we state the main auxiliary results that we prove in the paper and derive theorems  [ mainthm ] and  [ 2nonex ] from them . in section  [ tusec ]",
    "we prove turn - type results for digraphs .",
    "these results will be applied both when constructing our absorbing sets and when finding an almost perfect @xmath3-packing in the non - extremal case .",
    "section  [ sec : almost ] deals with this latter task .",
    "we state and prove the connection lemmas for theorems  [ mainthm ] and  [ 2nonex ] in section  [ consec ] .",
    "these are then used to construct our absorbing sets in section  [ secnon ] .",
    "after giving a number of useful results in section  [ secex ] we tackle the extremal cases of theorem  [ mainthm ] in sections  [ secex1 ] and  [ secexc3 ] .",
    "given two vertices  @xmath56 and  @xmath106 of a digraph  @xmath0 , we write  @xmath29 for the edge directed from  @xmath56 to  @xmath106 .",
    "we write @xmath107 for the vertex set of @xmath0 , @xmath108 for the edge set of @xmath0 and define @xmath109 and @xmath110 .",
    "we denote by  @xmath111 and  @xmath112 the out- and the inneighbourhood of  @xmath113 and by @xmath114 and @xmath115 its out- and indegree .",
    "we will write @xmath116 for example , if this is unambiguous . for a vertex @xmath47 and a set @xmath117 we write @xmath118 to denote the number of edges in @xmath0 with startpoint @xmath56 and endpoint in @xmath92 .",
    "we define @xmath119 analogously .",
    "the _ minimum semidegree _",
    "@xmath25 of @xmath0 is the minimum of its minimum outdegree @xmath26 and its minimum indegree @xmath27 .",
    "let @xmath28 denote the minimum degree of @xmath0 , that is , the minimum number of edges incident to a vertex in @xmath0 .",
    "( note that if both @xmath29 and @xmath30 are directed edges in @xmath0 , they are counted as two separate edges . )",
    "given a subset @xmath83 , we write @xmath120 $ ] for the subdigraph of @xmath0 induced by @xmath121 .",
    "we write @xmath122 for the subdigraph of @xmath0 induced by @xmath123 .",
    "for @xmath124 we define @xmath125:=g[\\{x_1 , \\dots , x_m\\}]$ ] .",
    "given a set @xmath83 and a digraph @xmath1 on @xmath126 vertices we say that @xmath121 _ spans a copy of @xmath1 in @xmath0 _ if @xmath120 $ ] contains a copy of @xmath1 .",
    "in particular , this does not necessarily mean that @xmath121 induces a copy of @xmath1 in @xmath0 .",
    "for disjoint @xmath127 we let @xmath128 $ ] denote the digraph with vertex set @xmath129 whose edge set consists of all those edges @xmath130 with @xmath131 and @xmath132 .",
    "if @xmath0 and @xmath1 are digraphs , we write @xmath133 for the digraph whose vertex set is @xmath134 and whose edge set is @xmath135 .",
    "if @xmath0 and @xmath1 have the same vertex set @xmath136 then let @xmath137 denote the digraph with vertex set @xmath136 and edge set @xmath138 .",
    "given digraphs @xmath0 and @xmath1 , we say that @xmath0 is _ @xmath1-free _ if @xmath0 does not contain @xmath1 as a subdigraph .",
    "let @xmath0 be a ( di)graph on @xmath5 vertices and let @xmath139 .",
    "we say that a set @xmath140 is _ @xmath141-independent _",
    "if @xmath142 $ ] contains at most @xmath143 edges .",
    "given two digraphs @xmath0 and @xmath1 on @xmath5 vertices we say that @xmath0 _",
    "@xmath141-contains @xmath1 _ if , after adding at most @xmath143 edges to @xmath0 , the resulting digraph contains a copy of @xmath1 .",
    "more precisely , @xmath0 @xmath141-contains @xmath1 if there is an isomorphic copy @xmath36 of @xmath0 such that @xmath144 and @xmath145    for a ( di)graph @xmath0 and disjoint @xmath146 , we write @xmath147 for the number of edges in @xmath0 with one endpoint in @xmath148 and the other in @xmath149 .",
    "( so @xmath150 . )",
    "given a ( di)graph @xmath3 , let @xmath151 denote the disjoint union of two copies of @xmath3 .",
    "recall that @xmath45 denotes the transitive tournament of @xmath4 vertices . given @xmath89 ,",
    "we say a vertex @xmath152 is the _",
    "@xmath90th vertex of @xmath45 _ if @xmath56 has indegree @xmath153 and outdegree @xmath154 in @xmath45 . given a set @xmath121 and @xmath12 we denote by @xmath155 the set of all @xmath4-subsets of @xmath121 .    throughout the paper , we write @xmath156 to mean that we can choose the constants @xmath157 from right to left .",
    "more precisely , there are increasing functions @xmath158 and @xmath159 such that , given @xmath141 , whenever we choose some @xmath160 and @xmath161 , all calculations needed in our proof are valid .",
    "hierarchies of other lengths are defined in the obvious way .",
    "suppose that @xmath162 and @xmath163 are non - negative integers .",
    "define @xmath164 such that @xmath165 where @xmath166 .",
    "let @xmath167 and @xmath168 be disjoint vertex sets of size @xmath169 and @xmath170 respectively .",
    "let @xmath171 denote the digraph with vertex set @xmath172 and whose edge set is defined as follows :    * @xmath173 induces a complete digraph in @xmath174 ( for all @xmath175 ) ; * if @xmath176 and @xmath177 then @xmath178 ( for all @xmath175 , where indices are taken mod @xmath8 ) .",
    "define @xmath179 .",
    "( see figure  1 . )",
    "we call @xmath167 and @xmath168 the _ vertex classes of @xmath80_.    [ ] [ ] @xmath180 [ ] [ ] @xmath181 [ ] [ ] @xmath168 , title=\"fig : \" ]    suppose that @xmath5 is divisible by @xmath8 . note that @xmath182 but @xmath183 does not contain a perfect @xmath41-packing .",
    "thus , in the proof of theorem  [ mainthm ] for @xmath42 we have two extremal cases to consider : when @xmath0 contains an ` almost ' independent set of size @xmath71 and when @xmath0 ` almost ' contains @xmath80 .",
    "let @xmath32 . given a digraph @xmath0 , a set @xmath140",
    "is called a _ @xmath3-absorbing set for @xmath61 _ , if both @xmath142 $ ] and @xmath184 $ ] contain perfect @xmath3-packings . in this case",
    "we say that _",
    "@xmath65 is @xmath3-absorbed by @xmath185_. sometimes we will simply refer to a set @xmath140 as a @xmath3-absorbing set if _ there exists _ a set @xmath61 that is @xmath3-absorbed by @xmath185 .",
    "when constructing our absorbing sets in section  [ secnon ] we will use the following chernoff bound for binomial distributions ( see e.g.  ) .",
    "recall that the binomial random variable with parameters @xmath186 is the sum of @xmath5 independent bernoulli variables , each taking value @xmath187 with probability @xmath188 or @xmath189 with probability @xmath190 .",
    "[ chernoff ] suppose that @xmath121 has binomial distribution and @xmath191",
    ". then @xmath192 .",
    "let @xmath193 be a collection of digraphs and @xmath0 a digraph .",
    "we say that @xmath0 contains a _ perfect @xmath193-packing _ if @xmath0 contains a collection of vertex - disjoint copies of elements from @xmath193 that together cover all the vertices of @xmath0 .",
    "we now prove conjecture  [ conj2 ] in the case of transitive triangles .",
    "let @xmath194 .",
    "suppose that @xmath0 is a digraph on @xmath195 vertices so that for any @xmath47 , @xmath196 then @xmath0 contains a perfect @xmath78-packing .",
    "let @xmath0 be a digraph as in the statement of the theorem .",
    "remove as many edges from @xmath0 as possible so that ( [ conmin ] ) still holds .",
    "let @xmath36 denote the graph on @xmath107 where @xmath98 if and only if @xmath130 or @xmath197 .",
    "so @xmath198 by ( [ conmin ] ) .",
    "thus , theorem  [ hs ] implies that @xmath36 contains a perfect @xmath199-packing and so @xmath0 contains a perfect @xmath200-packing .",
    "let @xmath201 denote the perfect @xmath202-packing in @xmath0 that contains the most copies of @xmath78 .",
    "suppose for a contradiction that @xmath201 is not a perfect @xmath78-packing .",
    "then there is a copy @xmath203 of @xmath41 in @xmath201 . let @xmath204 where @xmath205 .",
    "suppose that @xmath206 for some @xmath207 .",
    "without loss of generality assume that @xmath208 .",
    "then ( [ conmin ] ) implies that @xmath209 .",
    "if @xmath210 then we may remove the edge @xmath211 from @xmath0 and still ( [ conmin ] ) holds , a contradiction to the minimality of @xmath0 .",
    "so @xmath212 .",
    "an identical argument implies that @xmath213 .",
    "this shows that @xmath214 for all @xmath207 or @xmath215 for all @xmath207 .    without loss of generality",
    "assume that @xmath215 for all @xmath207 .",
    "( the other case is analogous . )",
    "note that @xmath216 $ ] contains precisely three edges ( else @xmath217 spans a copy of @xmath78 , a contradiction to the maximality of @xmath201 ) .",
    "in particular , there are at least @xmath218 edges in @xmath0 with startpoint in @xmath217 and endpoint in @xmath219 .",
    "this implies that there is an element @xmath220 that receives at least @xmath221 edges from @xmath217 in @xmath0 .",
    "so there is a vertex , say @xmath56 , in @xmath217 such that @xmath222 .",
    "furthermore , @xmath106 and @xmath223 have a common outneighbour in @xmath0 that lies in @xmath224 .",
    "together this implies that @xmath225 spans a copy of @xmath226 in @xmath0 .",
    "this yields a perfect @xmath200-packing in @xmath0 containing more copies of @xmath78 than @xmath201 , a contradiction .",
    "so the assumption that @xmath201 is not a perfect @xmath78-packing is false , as desired .",
    "in this section we state a number of auxiliary results that we will prove in the paper .",
    "we then combine these results to prove theorems  [ mainthm ] and  [ 2nonex ] . roughly speaking ,",
    "the following result states that if @xmath0 is as in theorem  [ mainthm ] ( namely has large semi - degree ) and is _ non - extremal _ then @xmath0 contains a ` small ' absorbing set that absorbs _ any _ ` very small ' set of vertices in @xmath0 .    [ nonex1 ]",
    "let @xmath227 where @xmath35 and @xmath7 , and let @xmath32 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices so that @xmath228 further suppose that    * @xmath0 does not contain any @xmath141-independent set of size at least @xmath44 ; * if @xmath42 then @xmath0 does not @xmath229-contain @xmath80 .",
    "then @xmath107 contains a set @xmath66 so that @xmath230 and @xmath66 is a @xmath3-absorbing set for any @xmath231 such that @xmath232 and @xmath233 .",
    "the next result is an analogue of theorem  [ nonex1 ] that will be applied in the proof of theorem  [ 2nonex ] .",
    "[ nonex2 ] let @xmath234 where @xmath35 and @xmath7 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices so that , for any @xmath47 , @xmath235 further suppose that @xmath0 does not contain any @xmath141-independent set of size at least @xmath44 .",
    "then @xmath107 contains a set @xmath66 so that @xmath230 and @xmath66 is a @xmath45-absorbing set for any @xmath231 such that @xmath232 and @xmath233 .",
    "we prove theorems  [ nonex1 ] and  [ nonex2 ] in section  [ secnon ] .",
    "the crucial tools used in these proofs are so - called ` connection lemmas ' which we introduce in section  [ consec ] .    [ almostthm ]",
    "let @xmath236 and @xmath32 for some @xmath7 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath237 then at least one of the following properties holds :    * @xmath0 contains a @xmath3-packing that covers all but at most @xmath238 vertices ; * @xmath0 contains a @xmath141-independent set of size at least @xmath44 .",
    "theorems  [ nonex1 ] and  [ almostthm ] together ensure that a non - extremal digraph @xmath0 in theorem  [ mainthm ] contains a perfect @xmath3-packing .",
    "the following result is an analogue of theorem  [ almostthm ] that will be applied in the proof of theorem  [ 2nonex ] .",
    "[ almostthm+- ] let @xmath236 where @xmath35 and @xmath7 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that , for any @xmath239 , @xmath240 further suppose that , given any @xmath81 , if @xmath241 and @xmath242 then @xmath243",
    ". then at least one of the following properties holds :    * @xmath0 contains a @xmath45-packing that covers all but at most @xmath238 vertices ; * @xmath0 contains a @xmath141-independent set of size at least @xmath44 .",
    "in section  [ sec : almost ] we deduce theorems  [ almostthm ] and  [ almostthm+- ] from a result of keevash and mycroft  @xcite concerning almost perfect matchings in hypergraphs .",
    "the next two results cover the extremal cases of theorem  [ mainthm ] .",
    "[ ex1 ] let @xmath12 such that @xmath244 .",
    "there exist @xmath139 and @xmath13 such that the following holds .",
    "suppose that @xmath32 and @xmath0 is a digraph on @xmath33 vertices where @xmath5 is divisible by @xmath4 . if @xmath245 and @xmath0 contains a @xmath141-independent set of size @xmath44 then @xmath0 contains a perfect @xmath3-packing .",
    "[ exc3 ] there exist @xmath246 and @xmath13 such that the following holds .",
    "suppose that @xmath0 is a digraph on @xmath33 vertices where @xmath5 is divisible by @xmath8 . if    * @xmath247 and * @xmath0 @xmath229-contains @xmath80 ,    then @xmath0 contains a perfect @xmath41-packing .",
    "lemmas  [ ex1 ] and [ exc3 ] are proved in sections  [ secex1 ] and  [ secexc3 ] respectively .",
    "we now deduce theorem  [ mainthm ] from theorems  [ nonex1 ] and  [ almostthm ] and lemmas  [ ex1 ] and  [ exc3 ] .",
    "* proof of theorem  [ mainthm ] .",
    "* define constants @xmath248 and integers @xmath249 such that @xmath250 let @xmath32 and suppose that @xmath0 is a digraph on @xmath33 vertices such that @xmath4 divides @xmath5 and @xmath104 . by lemmas  [ ex1 ] and  [ exc3 ]",
    "we may assume that    * @xmath0 does not contain any @xmath141-independent set of size @xmath44 ; * if @xmath42 then @xmath0 does not @xmath229-contain @xmath80 .",
    "( otherwise @xmath0 contains a perfect @xmath3-packing , as desired . )",
    "thus , we can apply theorem  [ nonex1 ] to obtain a set @xmath251 so that @xmath230 and @xmath66 is a @xmath3-absorbing set for any @xmath231 such that @xmath232 and @xmath233 .",
    "set @xmath63 and let @xmath252 . since @xmath5 is divisible by @xmath4 and @xmath66 is a @xmath3-absorbing set , @xmath253 is also divisible by @xmath4 .",
    "further , @xmath254 notice that @xmath36 does not contain any @xmath255-independent set of size at least @xmath256 .",
    "( otherwise @xmath0 contains a @xmath141-independent set of size @xmath44 , a contradiction to ( i ) . ) therefore , by applying theorem  [ almostthm ] with @xmath257 playing the roles of @xmath258 , we obtain a @xmath3-packing @xmath64 in @xmath36 that covers all but at most @xmath238 vertices .",
    "let @xmath259 denote the set of vertices in @xmath36 that are not covered by @xmath64 .",
    "so @xmath260 and , since @xmath253 is divisible by @xmath4 , @xmath261 .",
    "thus , by definition of @xmath66 , @xmath262 $ ] contains a perfect @xmath3-packing @xmath67 .",
    "therefore , @xmath68 is a perfect @xmath3-packing in @xmath0 , as desired .",
    "similarly we deduce theorem  [ 2nonex ] from theorems  [ nonex2 ] and  [ almostthm+- ] .",
    "* proof of theorem  [ 2nonex ] . *",
    "define additional constants @xmath263 and integers @xmath264 such that @xmath265 suppose that @xmath0 is a digraph on @xmath266 vertices where @xmath4 divides @xmath5 and :    * for any @xmath239 , @xmath267 or @xmath268 .",
    "suppose that for some @xmath81 , @xmath269 , @xmath270 and @xmath271 . then if we remove the edge @xmath29 from @xmath0 , ( i ) still holds .",
    "in particular , this implies that we may assume :    * given any @xmath81 , if @xmath272 and @xmath273 then @xmath243 .",
    "note that ( i ) implies that :    * @xmath0 does not contain any @xmath141-independent set of size @xmath44 .",
    "apply theorem  [ nonex2 ] to obtain a set @xmath251 so that @xmath230 and @xmath66 is a @xmath45-absorbing set for any @xmath231 such that @xmath232 and @xmath233 .",
    "set @xmath63 and let @xmath252 . since @xmath5 is divisible by @xmath4 and @xmath66 is a @xmath45-absorbing set , @xmath253 is also divisible by @xmath4 .",
    "further , ( i ) implies that for any @xmath274 , @xmath275    suppose that for some @xmath276 , @xmath277 and @xmath278",
    ". then @xmath279 and @xmath280 .",
    "thus , by ( ii ) , @xmath281 .",
    "notice that @xmath36 does not contain any @xmath255-independent set of size at least @xmath256 .",
    "( otherwise @xmath0 contains a @xmath141-independent set of size @xmath44 , a contradiction to ( iii ) . ) therefore , by applying theorem  [ almostthm+- ] with @xmath282 playing the roles of @xmath283 , we obtain a @xmath45-packing @xmath64 in @xmath36 that covers all but at most @xmath238 vertices .",
    "let @xmath259 denote the set of vertices in @xmath36 that are not covered by @xmath64 .",
    "so @xmath260 and , since @xmath253 is divisible by @xmath4 , @xmath261 .",
    "thus , by definition of @xmath66 , @xmath262 $ ] contains a perfect @xmath45-packing @xmath67 .",
    "hence , @xmath68 is a perfect @xmath45-packing in @xmath0 , as desired .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices that satisfies ( [ conmin1 ] ) .",
    "suppose that for some @xmath81 , @xmath284 , @xmath285 and @xmath271 . then if we remove the edge @xmath29 from @xmath0 , ( [ conmin1 ] ) still holds .",
    "thus , to prove conjecture  [ conj2 ] it suffices to consider digraphs @xmath0 with the following additional assumption : given any @xmath81 , if @xmath286 and @xmath287 then @xmath243 .",
    "the next result states that such a digraph @xmath0 contains a perfect @xmath45-packing or contains an ` almost ' independent set of size @xmath44 .",
    "[ 2nonex1 ] given any @xmath139 and an integer @xmath288 there exists an @xmath13 such that the following holds .",
    "suppose that @xmath0 is a digraph on @xmath52 vertices where @xmath4 divides @xmath5 and that , for any @xmath47 , @xmath289 further suppose that , given any @xmath81 , if @xmath290 and @xmath291 then @xmath243",
    ". then at least one of the following properties holds :    * @xmath0 contains a perfect @xmath45-packing ; * @xmath0 contains a @xmath141-independent set of size at least @xmath44 .",
    "the proof is almost identical to that of theorem  [ 2nonex ] so we omit it .",
    "so theorem  [ 2nonex1 ] implies that to prove conjecture  [ conj2 ] for large digraphs it suffices to prove the extremal case .",
    "the aim of this subsection is to prove proposition  [ turanstab ] which , roughly speaking , states that a digraph @xmath0 on @xmath5 vertices of sufficiently large semidegree ( i ) contains many copies of a fixed @xmath32 or ( ii ) contains an ` almost ' independent set of size @xmath44 .",
    "proposition  [ turanstab ] will be applied in the proof of both theorem  [ nonex1 ] and theorem  [ almostthm ] .",
    "the next result is an immediate consequence of turn s theorem .",
    "[ turan ] let @xmath292 where @xmath293 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath294 then @xmath0 contains a copy of @xmath2 .",
    "let @xmath36 be the graph on @xmath107 whose edge set consists of all pairs @xmath29 where @xmath295 .",
    "then ( [ edge1 ] ) implies that @xmath296 and thus @xmath36 contains a copy of @xmath2 by turn s theorem .",
    "hence , @xmath297 as required",
    ".    [ ind ] let @xmath298 with @xmath35 and @xmath7 , and let @xmath32 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath299 if @xmath0 is @xmath3-free then @xmath0 contains an independent set of size at least @xmath300 .",
    "let @xmath301 and set @xmath302 $ ] . using ( [ min1 ] ) , greedily construct a copy @xmath303 of @xmath304 in @xmath0 . to simplify notation , for each @xmath305",
    ", we will refer to the vertex in @xmath303 ( and thus @xmath0 ) corresponding to the vertex @xmath306 in @xmath304 as @xmath306 .",
    "we say that a vertex @xmath307 is a _ candidate for @xmath308 in @xmath0 _ if the following conditions hold :    * if @xmath309 then @xmath310 ( for each @xmath305 ) ; * if @xmath311 then @xmath312 ( for each @xmath305 ) .",
    "we give an analogous definition of a _",
    "candidate for @xmath313 in @xmath0_. let @xmath148 denote the set of candidates for @xmath308 in @xmath0 and let @xmath149 denote the set of candidates for @xmath313 in @xmath0 . thus ,",
    "( [ min1 ] ) implies that @xmath314 .",
    "since @xmath0 is @xmath3-free , there is no edge in @xmath0 whose startpoint lies in @xmath148 and whose endpoint lies in @xmath149 . in particular",
    ", @xmath315 is an independent set .",
    "set @xmath316 .",
    "suppose for a contradiction that @xmath317 .",
    "given any vertex @xmath318 , since @xmath56 sends no edges to @xmath149 , ( [ min1 ] ) and ( [ abboundy ] ) imply that there are at most @xmath319 vertices in @xmath320 that @xmath56 does not send an edge to ( including itself ) .",
    "thus , @xmath321)\\geq|a'|-(r-1)\\alpha n \\geq \\left ( 1- \\frac{1}{2(r-1)}\\right)|a'|\\ ] ] and so @xmath322)\\geq \\left ( 1-\\frac{1}{2(r-1)}\\right)|a'|^2 > \\left ( 1 -\\frac{1}{r-1 } \\right ) \\frac{|a'|^2}{2 } + \\binom{|a'|}{2}.\\ ] ] hence , proposition  [ turan ] implies that @xmath323 $ ] and so @xmath0 contains a copy of @xmath3 , a contradiction .",
    "therefore , @xmath324 .",
    "together with ( [ abboundy ] ) this implies that the independent set @xmath325 is of size at least @xmath326 as required . to prove proposition  [ turanstab ] we will apply proposition  [ ind ] together with the following directed version of the removal lemma ( see e.g. @xcite ) .",
    "[ dirl ] let @xmath139 and @xmath327 .",
    "given any digraph @xmath1 on @xmath328 vertices , there exists @xmath329 and @xmath330 such that the following holds .",
    "suppose that @xmath0 is a digraph on @xmath33 vertices such that @xmath0 contains at most @xmath331 copies of @xmath1 .",
    "then @xmath0 can be made @xmath1-free by deleting at most @xmath143 edges .",
    "[ turanstab ] let @xmath332 where @xmath333 and @xmath293 , and let @xmath32 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath334 and so that @xmath0 contains at most @xmath335 copies of @xmath3 .",
    "then @xmath0 contains a @xmath336-independent set of size at least @xmath337 .",
    "the case when @xmath338 is trivial thus we may assume that @xmath7 .",
    "define an additional constant @xmath339 so that @xmath340 suppose that @xmath0 is as in the statement of the proposition .",
    "since @xmath0 contains at most @xmath335 copies of @xmath3 , lemma  [ dirl ] implies that one can remove at most @xmath143 edges from @xmath0 to obtain a spanning subdigraph @xmath36 that is @xmath3-free .",
    "so at most @xmath341 vertices in @xmath0 are incident to more than @xmath342 of the edges in @xmath343 .",
    "therefore , since @xmath344 , there exists an induced subdigraph @xmath39 of @xmath36 such that @xmath345 and @xmath346 .",
    "since @xmath39 is @xmath3-free , proposition  [ ind ] implies that @xmath39 contains an independent set @xmath185 of size at least @xmath347 by construction of @xmath39 , @xmath185 is a @xmath141-independent set in @xmath0 . by adding at most @xmath348 arbitrary vertices to @xmath185 we obtain a @xmath336-independent set in @xmath0 of size at least @xmath337 , as desired .",
    "in this section we give an analogue of proposition  [ turanstab ] which will be applied in the proof of both theorem  [ nonex2 ] and theorem  [ almostthm+- ] .",
    "the next result is an analogue of proposition  [ ind ] .",
    "[ ind+- ] let @xmath298 where @xmath35 and @xmath7 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that , for any @xmath239 , @xmath349 if @xmath0 is @xmath45-free then @xmath0 contains an independent set of size at least @xmath350 .",
    "let @xmath351 .",
    "suppose that @xmath304 is a copy of @xmath352 in @xmath0 .",
    "let @xmath353 where @xmath354 plays the role of the @xmath90th vertex of @xmath352 .",
    "we say that @xmath304 is _ consistent _ if there exists @xmath355 such that    * @xmath356 for all @xmath357 ; * @xmath358 for all @xmath359 .",
    "we call @xmath360 a _ turning point of @xmath304_. ( note that @xmath304 could have more than one turning point . )",
    "( [ min1 + - ] ) implies that every copy of @xmath361 in @xmath0 is consistent .",
    "suppose that , for some @xmath362 , we have found a consistent copy @xmath304 of @xmath352 in @xmath0 .",
    "as before , let @xmath353 where @xmath354 plays the role of the @xmath90th vertex of @xmath352 and let @xmath360 denote a turning point of @xmath304 .",
    "set @xmath363 since @xmath304 is consistent with turning point @xmath360 and @xmath364 , @xmath365 consider any @xmath366 then @xmath367 spans a consistent copy of @xmath368 in @xmath0 where @xmath56 plays the role of the @xmath369th vertex in @xmath368 .",
    "( this is true regardless of whether @xmath370 or @xmath371 . )",
    "this observation implies that we can greedily construct a consistent copy @xmath3 of @xmath372 in @xmath0 .",
    "let @xmath373 where @xmath374 plays the role of the @xmath90th vertex of @xmath372 and let @xmath375 denote a turning point of @xmath3 .",
    "set @xmath376 .",
    "since @xmath3 is consistent with turning point @xmath375 , @xmath377    suppose that there is an edge @xmath378)$ ] .",
    "then @xmath379 spans a copy of @xmath45 in @xmath0 where @xmath56 and @xmath106 play the roles of the @xmath380th and @xmath381th vertices in @xmath45 respectively .",
    "this is a contradiction , so @xmath382 is an independent set in @xmath0 , as required .",
    "[ turanstab+- ] let @xmath332 where @xmath383 and @xmath293 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that , for any @xmath239 , @xmath384 further suppose that @xmath0 contains at most @xmath335 copies of @xmath45 .",
    "then @xmath0 contains a @xmath336-independent set of size at least @xmath337 .",
    "we follow the same argument as in the proof of proposition  [ turanstab ] except that we apply proposition  [ ind+- ] rather than proposition  [ ind ] .",
    "the key tool in the proofs of theorems  [ almostthm ] and  [ almostthm+- ] is a result of keevash and mycroft  ( * ? ? ?",
    "* theorem 2.3 ) concerning almost perfect matchings in so - called @xmath385-complexes . to state this result",
    "we require some more definitions .",
    "let @xmath386 .",
    "@xmath385-system _ is a hypergraph @xmath87 in which every edge of @xmath87 contains at most @xmath385 vertices and @xmath387 . for @xmath388",
    ", we refer to the edges of size @xmath90 in @xmath87 as the _ @xmath90-edges of @xmath87 _ , and write @xmath94 to denote the @xmath90-uniform hypergraph on @xmath389 induced by these edges .",
    "@xmath385-complex @xmath87 _ is a @xmath385-system whose edge set is closed under inclusion .",
    "that is , if @xmath390 and @xmath391 then @xmath392 .",
    "let @xmath87 be a @xmath385-complex .",
    "for any edge @xmath393 , the _ degree @xmath394 of @xmath395 _ is the number of @xmath396-edges @xmath397 of @xmath87 that contain @xmath395 as a subset .",
    "minimum @xmath4-degree @xmath398 _ of @xmath87 is the minimum of @xmath394 taken over all @xmath4-edges @xmath393 .",
    "the _ degree sequence of @xmath87 _ is defined as @xmath399 .",
    "given a vector @xmath400 of positive integers we write @xmath401 to mean that @xmath402 for all @xmath403 .",
    "suppose @xmath136 is a set of @xmath5 vertices , @xmath404 and @xmath405 .",
    "define @xmath406 to be the @xmath385-complex on @xmath136 in which @xmath407 ( for @xmath408 ) consists of all @xmath90-sets in @xmath136 that contain at most @xmath409 vertices of @xmath185 .",
    "let @xmath410 .",
    "given @xmath385-uniform hypergraphs @xmath411 on the same vertex set of size @xmath5 we say that @xmath412 is _ @xmath413-contained in @xmath1 _ if , by adding at most @xmath414 edges to @xmath1 , we can find a copy of @xmath412 in @xmath1 .",
    "a _ matching _ in a hypergraph @xmath1 is a collection of vertex - disjoint edges from @xmath1 .",
    "[ myalmost ] suppose that @xmath415 .",
    "let @xmath87 be a @xmath385-complex on @xmath5 vertices such that @xmath416 then at least one of the following properties holds :    * @xmath417 contains a matching that covers all but at most @xmath238 vertices ; * @xmath417 is @xmath413-contained in @xmath418 for some @xmath419 and @xmath420 with @xmath421 .    in the following two subsections we apply theorem  [ myalmost ] to prove both theorem  [ almostthm ] and theorem  [ almostthm+- ]",
    ".      define additional constants @xmath422 such that @xmath423 let @xmath0 be a digraph as in the statement of the theorem .",
    "our first task is to construct an @xmath4-complex @xmath87 from @xmath0 so that we can apply theorem  [ myalmost ] .",
    "let @xmath87 be the @xmath4-system on @xmath107 where , for each @xmath424 , @xmath94 is defined as follows :    * for each subtournament @xmath304 of @xmath3 on @xmath90 vertices , any @xmath90-tuple in @xmath107 that spans a copy of @xmath304 in @xmath0 forms an @xmath90-edge in @xmath94 .",
    "so for example , if @xmath42 , then @xmath425 , @xmath426 is the set of all pairs @xmath97 where @xmath130 or @xmath197 and @xmath427 is the set of all triples @xmath101 that span a copy of @xmath41 in @xmath0 .",
    "( note though that @xmath101 does not have to _ induce _ a copy of @xmath41 in @xmath0 .",
    "for example , we could have @xmath216=k_3 $ ] . )    by construction @xmath87 is an @xmath4-complex .",
    "further , notice that a matching in the @xmath4-uniform hypergraph @xmath102 corresponds to a @xmath3-packing in @xmath0 .",
    "clearly @xmath428 .",
    "set @xmath429 and let @xmath304 be a subtournament of @xmath3 on @xmath90 vertices .",
    "if @xmath303 is a copy of @xmath304 in @xmath0 then ( [ mina ] ) implies that there are at least @xmath430 vertices @xmath56 in @xmath0 such that @xmath431 spans a copy of a subtournament of @xmath3 on @xmath432 vertices .",
    "this therefore implies that , @xmath433 hence , we can apply theorem  [ myalmost ] with @xmath434 playing the roles of @xmath435 .",
    "so at least one of the following conditions holds :    * @xmath102 contains a matching that covers all but at most @xmath238 vertices ; * @xmath102 is @xmath413-contained in @xmath436 for some @xmath437 and @xmath438 with @xmath439 .",
    "if ( a ) holds then this implies that ( i ) is satisfied .",
    "so we may assume that ( b ) holds .",
    "we will show that this implies that ( ii ) is satisfied .",
    "let @xmath409 be as in ( b ) and consider an arbitrary subtournament @xmath304 of @xmath3 on @xmath440 vertices .",
    "suppose for a contradiction that there are at least @xmath441 @xmath442-tuples in @xmath185 that span a copy @xmath303 of @xmath304 in @xmath0 .",
    "if @xmath443 then @xmath444 and so this implies that @xmath102 contains at least @xmath445 edges that lie in @xmath185 .",
    "this is a contradiction as @xmath102 is @xmath446-contained in @xmath436 .",
    "so suppose that @xmath447 .",
    "then ( [ mina ] ) implies that , for each copy @xmath303 of @xmath304 in @xmath0 , there are at least @xmath448 @xmath449-tuples @xmath121 in @xmath107 such that @xmath450 spans a copy of @xmath3 in @xmath0 .",
    "since @xmath451 , this implies that there are at least @xmath452 @xmath4-tuples in @xmath107 that span a copy of @xmath3 and which contain at least @xmath440 vertices from @xmath185 .",
    "so @xmath102 contains more than @xmath453 edges that contain at least @xmath440 vertices from @xmath185 .",
    "this is a contradiction as @xmath102 is @xmath446-contained in @xmath436 .",
    "so there are at most @xmath441 @xmath442-tuples in @xmath185 that span a copy of @xmath304 in @xmath0 .",
    "thus , since any @xmath442-tuple of vertices spans at most @xmath454 copies of @xmath304 , there are at most @xmath455 copies of @xmath304 in @xmath142 $ ] .",
    "further , since @xmath439 , ( [ mina ] ) implies that @xmath456 ) \\geq |s|-\\frac{n}{r } -\\eps n \\geq \\left(1- \\frac{1}{j}-\\eps ' \\right ) |s|.\\ ] ] apply proposition  [ turanstab ] with @xmath142,t',j+1,\\eps ' , \\alpha ' $ ] playing the roles of @xmath457 .",
    "this implies that @xmath142 $ ] contains a @xmath458-independent set of size at least @xmath459 . since @xmath460",
    ", this implies that @xmath0 contains a @xmath141-independent set of size at least @xmath44 , as required .",
    "define additional constants @xmath422 such that @xmath461 let @xmath0 be a digraph as in the statement of the theorem .",
    "let @xmath351 and suppose that @xmath304 is a copy of @xmath352 in @xmath0 .",
    "let @xmath353 where @xmath354 plays the role of the @xmath90th vertex of @xmath352 .",
    "we say that @xmath304 is _ consistent _ if there exists @xmath462 such that    * @xmath463 for all @xmath464 ; * @xmath465 for all @xmath466 .",
    "we call @xmath375 a _ turning point of @xmath304_. ( @xmath304 could have more than one turning point . )    ( [ miny ] ) implies that every copy of @xmath361 in @xmath0 is consistent .",
    "suppose , for a contradiction , that @xmath3 is a copy of @xmath352 in @xmath0 that is not consistent ( for some @xmath467 ) .",
    "let @xmath374 denote the vertex in @xmath3 that plays the role of the @xmath90th vertex of @xmath352 .",
    "let @xmath385 be the smallest positive integer such that @xmath468 ( and so @xmath469 by ( [ miny ] ) ) ; such an integer exists else @xmath3 is consistent with turning point @xmath470 .",
    "then there exists @xmath471 such that @xmath472 ( otherwise @xmath3 is consistent with turning point @xmath473 ) .",
    "but then @xmath474 where @xmath468 and @xmath472 .",
    "this is a contradiction to the hypothesis of the theorem .",
    "thus , every transitive tournament in @xmath0 is consistent .",
    "let @xmath87 be the @xmath4-system on @xmath107 where , for each @xmath424 , @xmath94 is defined as follows :    * any @xmath90-tuple in @xmath107 that spans a copy of @xmath475 in @xmath0 forms an @xmath90-edge in @xmath94 .    by construction @xmath87",
    "is an @xmath4-complex .",
    "further , a matching in @xmath102 corresponds to a @xmath45-packing in @xmath0 .",
    "clearly @xmath428 .",
    "suppose that @xmath3 is a ( consistent ) copy of @xmath475 in @xmath0 for some @xmath429 and let @xmath375 denote a turning point of @xmath3 . as before , let @xmath476 denote the vertex in @xmath3 that plays the role of the @xmath385th vertex in @xmath475 .",
    "set @xmath477 . since @xmath3 is consistent with turning point @xmath375 , @xmath478 further , given any @xmath479 , @xmath480 spans a copy of @xmath481 in @xmath0 .",
    "so @xmath480 is an edge in @xmath87 .",
    "this implies that @xmath433 hence , we can apply theorem  [ myalmost ] with @xmath434 playing the roles of @xmath435 .",
    "so at least one of the following conditions holds :    * @xmath102 contains a matching that covers all but at most @xmath238 vertices ; * @xmath102 is @xmath413-contained in @xmath436 for some @xmath437 and @xmath438 with @xmath439 .",
    "if ( a ) holds then ( i ) is satisfied .",
    "so we may assume that ( b ) holds .",
    "we will show that this implies that ( ii ) is satisfied .",
    "the argument now closely follows the proof of theorem  [ almostthm ] .",
    "indeed , let @xmath409 be as in ( b ) .",
    "suppose for a contradiction that there are at least @xmath441 @xmath442-tuples in @xmath185 that span a copy @xmath3 of @xmath482 in @xmath0 .",
    "if @xmath443 then @xmath483 and so this implies that @xmath102 contains at least @xmath445 edges that lie in @xmath185 .",
    "this is a contradiction as @xmath102 is @xmath446-contained in @xmath436 .",
    "so suppose that @xmath447 .",
    "recall that every copy @xmath3 of @xmath482 in @xmath0 is consistent .",
    "this implies that there are at least @xmath484 vertices @xmath47 such that @xmath480 spans a copy of @xmath485 in @xmath0 . repeating this process",
    "we see that , for every copy @xmath3 of @xmath482 in @xmath0 , there are at least @xmath448 @xmath449-tuples @xmath121 in @xmath107 such that @xmath486 spans a copy of @xmath45 in @xmath0 . since @xmath451 , this implies that there are at least @xmath452 @xmath4-tuples in @xmath107 that span a copy of @xmath45 and which contain at least @xmath440 vertices from @xmath185 .",
    "so @xmath102 contains more than @xmath453 edges that contain at least @xmath440 vertices from @xmath185 .",
    "this is a contradiction as @xmath102 is @xmath446-contained in @xmath436 .",
    "thus , there are at most @xmath441 @xmath442-tuples in @xmath185 that span a copy of @xmath482 in @xmath0",
    ". since any @xmath442-tuple of vertices spans at most @xmath454 copies of @xmath482 , there are at most @xmath455 copies of @xmath482 in @xmath142 $ ] .",
    "further , since @xmath439 , ( [ miny ] ) implies that , for every @xmath487)$ ] , @xmath488 } ( x ) \\geq |s|-\\frac{n}{r } -\\eps n \\geq \\left(1- \\frac{1}{j}-\\eps ' \\right ) |s| \\text { or } d ^-   _ { g[s ] } ( x )   \\geq \\left(1- \\frac{1}{j}-\\eps ' \\right ) |s|.\\ ] ] apply proposition  [ turanstab+- ] with @xmath142,j+1,\\eps ' , \\alpha ' $ ] playing the roles of @xmath489 .",
    "this implies that @xmath142 $ ] contains a @xmath458-independent set of size at least @xmath459 . since @xmath460",
    ", this implies that @xmath0 contains a @xmath141-independent set of size at least @xmath44 , as required .",
    "in section  [ secnon ] we prove theorems  [ nonex1 ] and  [ nonex2 ] . roughly speaking , in both these theorems , when our digraph @xmath0 is non - extremal we require a ` small ' @xmath3-absorbing set in @xmath0 that absorbs _ any _ ` very small ' set of vertices in @xmath0 ( for some @xmath32 ) .    the crucial idea in finding",
    "such an absorbing set is to first prove that our digraph @xmath0 has many ` connecting structures ' of a certain type .",
    "more precisely , to find our desired absorbing set it suffices to show that , for any @xmath81 , there are ` many ' @xmath82-sets @xmath83 so that both @xmath84 and @xmath85 span copies of @xmath3 in @xmath0 .",
    "our main task therefore is to prove so - called ` connection lemmas ' that guarantee such sets @xmath121 . in the case",
    "when @xmath42 though , we may not be able to find such sets .",
    "however , in this case we instead find , for any @xmath81 , ` many ' @xmath490-sets @xmath491 so that both @xmath84 and @xmath85 span copies of @xmath151 in @xmath0 .",
    "the approach of proving connection lemmas to find absorbing structures for packing problems has been very fruitful . indeed , lo and markstrm  @xcite used such connection lemmas to tackle perfect packing problems for hypergraphs ( although their terminology for these ` connecting structures ' differs from ours ) .",
    "further , recently the author  @xcite applied this method to prove a degree sequence version of the hajnal  szemerdi theorem .",
    "a single connection lemma ( lemma  [ con+- ] ) for theorem  [ nonex2 ] is given in section  [ con2 ] .",
    "for theorem  [ nonex1 ] , we need to prove a number of separate connection lemmas . in section  [ sec5con ]",
    "we prove the connection lemma for theorem  [ nonex1 ] for those @xmath492 where @xmath493 ( see lemma  [ 5con ] ) .",
    "the proof relies on @xmath3 containing @xmath78 as a subtournament .",
    "( so this method certainly can not be applied in the case when @xmath42 . )",
    "it is easy to see that all tournaments on at least four vertices contain @xmath78 .",
    "however for @xmath494 , the minimum semidegree condition on our digraph @xmath0 is not high enough for the proof method of lemma  [ 5con ] to go through .",
    "thus , we use a different approach to prove the connection lemma in this case ( see section  [ sec4con ] ) .",
    "this method makes use of a simple structural property of tournaments on four vertices ( see fact  [ t4fact ] ) .",
    "the case when @xmath72 is covered by lemma  [ con+- ] .    finally , we need a separate connection lemma for when @xmath42 ( see section  [ sec3con ] ) .",
    "of all the connection lemmas , this one has the most involved proof .",
    "this stems from the fact that we now have two extremal cases .",
    "thus , to find our connecting structures in a non - extremal digraph @xmath0 on @xmath5 vertices we must use both the property that @xmath0 does not contain an ` almost ' independent set of size @xmath71 _ and _ that @xmath0 does not @xmath229-contain @xmath80 .",
    "the following connection lemma is a straightforward consequence of proposition  [ turanstab+- ] .",
    "[ con+- ] let @xmath495 where @xmath383 and @xmath7 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that , for any @xmath496 , @xmath497 further , suppose that @xmath0 does not contain a @xmath141-independent set on at least @xmath44 vertices .",
    "given any @xmath81 , there exist at least @xmath498 @xmath82-sets @xmath83 such that both @xmath84 and @xmath85 span copies of @xmath45 in @xmath0 .",
    "let @xmath499 .",
    "suppose that @xmath500 and @xmath501 .",
    "( the other cases are identical . )",
    "set @xmath502 .",
    "so @xmath503 this implies that , @xmath504 together with ( [ mincon+- ] ) this implies that , for any @xmath505 , @xmath506 } ^+ ( z ) \\geq \\left ( 1 - \\frac{1}{r-2 } -\\frac{\\gamma ^2}{4 } \\right ) |s| \\ \\text{or } \\ d _ { g[s ] } ^- ( z )",
    "\\geq   \\left ( 1 - \\frac{1}{r-2 } -\\frac{\\gamma ^2}{4 } \\right ) |s|.\\end{aligned}\\ ] ]    suppose for a contradiction that @xmath142 $ ] contains at most @xmath507 copies of @xmath508 .",
    "note that @xmath509 .",
    "hence , applying proposition  [ turanstab+- ] with @xmath142 , r-1 , 2^{3r-3 } \\eta , \\gamma ^2 /4 $ ] playing the roles of @xmath510 and @xmath511 respectively , we obtain a @xmath255-independent set @xmath512 in @xmath142 $ ] of size at least @xmath513 .",
    "note that @xmath514 therefore , @xmath512 is a @xmath255-independent set in @xmath0 of size at least @xmath515 . by adding at most @xmath516 arbitrary vertices to @xmath512",
    ", we obtain a @xmath141-independent set in @xmath0 of size at least @xmath44 , a contradiction .    thus , there are at least @xmath517 copies of @xmath508 in @xmath142 $ ] .",
    "( the inequality here follows since @xmath518 . )",
    "any @xmath82-set in @xmath185 spans at most @xmath519 different copies of @xmath508 in @xmath142 $ ] .",
    "so there are at least @xmath498 @xmath82-sets @xmath520 that span a copy of @xmath508 in @xmath142 $ ] . by definition of @xmath185 , for each such set @xmath121 , both @xmath521 and @xmath85 span copies of @xmath45 in @xmath0 , as required .",
    "the following simple fact will be used in the proof of the connection lemma for tournaments on four vertices ( lemma  [ t4con ] ) .",
    "[ t4fact ] if @xmath522 then there is a subset @xmath523 with @xmath524 and such that given any @xmath525 , either    * @xmath526 for all @xmath527 or * @xmath528 for all @xmath527 .",
    "[ t4con ] let @xmath529 and @xmath522 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath530 and so that @xmath0 does not contain any @xmath141-independent set of size at least @xmath531 .",
    "then , for any @xmath81 , there exist at least @xmath532 3-sets @xmath83 such that @xmath84 and @xmath533 span copies of @xmath3 in @xmath0 .",
    "by fact  [ t4fact ] , @xmath3 contains a subset @xmath523 with @xmath524 and such that given any @xmath525 , either    * @xmath526 for all @xmath527 or * @xmath528 for all @xmath527 .",
    "we divide the proof into two cases depending on @xmath534 .",
    "* case 1 : * @xmath535 + let @xmath536 where @xmath537 . consider the case when @xmath538 for @xmath539 .",
    "( the other case , when @xmath540 for @xmath539 , is analogous . ) set @xmath541 and let @xmath542 $ ] .",
    "our aim is to find @xmath532 3-sets @xmath543 that span copies of @xmath304 in @xmath544 $ ] .",
    "then the choice of @xmath375 and @xmath148 ensures that each such set @xmath121 has the property that @xmath84 and @xmath533 span copies of @xmath3 in @xmath0 ( where @xmath56 and @xmath106 respectively play the role of @xmath375 ) , as desired .    by ( [ mint4 ] )",
    "we have that @xmath545 and so @xmath546 ) \\ge |a|-(1/4+\\eps ) n \\geq |a|- ( 1/4+\\eps)\\frac{|a|}{1/2 - 2\\eps } \\geq |a|-(1/2 + 5 \\eps ) |a|\\geq(1/2-\\gamma ^2 /4)|a|.\\ ] ] suppose for a contradiction that @xmath544 $ ] contains at most @xmath547 copies of @xmath304 .",
    "note that @xmath548 .",
    "hence , applying proposition  [ turanstab ] with @xmath544 , t ' , 3 , 65 \\eta , \\gamma ^2 /4 $ ] playing the roles of @xmath549 and @xmath511 respectively , we obtain a @xmath255-independent set @xmath320 in @xmath544 $ ] of size at least @xmath550 . by adding at most @xmath551 arbitrary vertices to @xmath320",
    ", we obtain a @xmath141-independent set in @xmath0 of size at least @xmath531 , a contradiction .    thus , there are at least @xmath552 copies of @xmath304 in @xmath544 $ ] .",
    "any @xmath8-set in @xmath148 spans at most @xmath553 different copies of @xmath304 in @xmath544 $ ] .",
    "so there are at least @xmath554 @xmath8-sets @xmath555 that span a copy of @xmath304 in @xmath544 $ ] , as required .",
    "* case 2 : * @xmath556 + let @xmath557 where @xmath558 .",
    "assume that @xmath559 and @xmath560 .",
    "( the other cases can be dealt with analogously . )",
    "we may further assume that @xmath561 ( otherwise , we can reset @xmath562 and then follow the argument from case 1 ) . finally , we may assume that @xmath563 .    for each of our desired 3-sets @xmath121 , the vertices @xmath56 and @xmath106 will play the role of @xmath564 in the copy of @xmath3 that spans @xmath84 and @xmath533 , respectively .",
    "let @xmath565 such that @xmath566 . by ( [ mint4 ] )",
    "there are at least @xmath567 choices for @xmath568 .",
    "set @xmath569 .",
    "then ( [ mint4 ] ) implies that @xmath570 suppose that @xmath544 $ ] contains at most @xmath571 edges .",
    "then by adding at most @xmath572 vertices to @xmath148 , we obtain a @xmath141-independent set in @xmath0 of size at least @xmath531 , a contradiction .",
    "so @xmath544 $ ] contains at least @xmath573 edges .",
    "given any @xmath574)$ ] , set @xmath575 . by construction , @xmath521 spans a copy of @xmath3 in @xmath0 where @xmath576 play the roles of @xmath577 and @xmath578 respectively and @xmath85 spans a copy of @xmath3 in @xmath0 where @xmath579 play the roles of @xmath577 and @xmath578 respectively .",
    "recall that there are at least @xmath567 choices for @xmath568 and at least @xmath573 choices for @xmath580 .",
    "overall , this implies that there are at least @xmath581 choices for @xmath121 , as desired .",
    "[ 5con ] let @xmath495 where @xmath383 and @xmath493 , and let @xmath32 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath582 and so that @xmath0 does not contain a @xmath141-independent set on at least @xmath44 vertices .",
    "given any @xmath81 , there exist at least @xmath498 @xmath82-sets @xmath83 such that both @xmath84 and @xmath85 span copies of @xmath3 in @xmath0 .",
    "define @xmath583 such that @xmath584 .",
    "since @xmath585 , @xmath3 contains a copy of @xmath78 .",
    "let @xmath586 where @xmath587=t_3 $ ] so that @xmath588 for @xmath589 .",
    "consider any @xmath81 .",
    "we now explain how we construct our desired @xmath82-sets @xmath121 . for each such @xmath121",
    ", @xmath56 will play the role of @xmath590 in the copy of @xmath3 spanning @xmath84 and @xmath106 will play the role of @xmath590 in the copy of @xmath3 spanning @xmath533 . when constructing each @xmath121",
    "we introduce a special vertex @xmath591 that will play the role of @xmath592 or @xmath593 in the copies of @xmath3 spanned by @xmath84 and @xmath85 .",
    "let @xmath594 be such that @xmath595 . by ( [ absdeg ] )",
    "there are at least @xmath596 choices for @xmath591 .",
    "( note that we could not guarantee such a vertex @xmath591 exists if @xmath597 .",
    "this is the reason why we can not generalise this proof to work for @xmath598 . )",
    "next we iteratively choose vertices @xmath599 such that , for each @xmath600 , the following conditions hold :    * @xmath601 ; * @xmath602 if @xmath603 and @xmath604 if @xmath605 ; * @xmath606 if @xmath607 and @xmath608 if @xmath609 ( for each @xmath610 ) .",
    "suppose that , for some @xmath611 , we have already chosen @xmath612 so that ( @xmath613)(@xmath614 ) hold for @xmath615 .",
    "then ( [ absdeg ] ) implies that there are at least @xmath616 choices for @xmath617 so that ( @xmath618)(@xmath619 ) are satisfied .",
    "conditions ( @xmath613)(@xmath614 ) ensure that @xmath620 can play the role of @xmath354 for each @xmath621 . since there are double edges between @xmath591 and @xmath622",
    "there is currently freedom as to whether @xmath591 will play the role of @xmath623 or @xmath593 .",
    "our next task is to construct sets @xmath624 of ` candidates ' to play the role of @xmath592 and @xmath593 respectively .",
    "more precisely , we say that a vertex @xmath496 is a _ candidate for @xmath564 in @xmath0 _ if :    * @xmath625 ; * @xmath626 if @xmath627 and @xmath628 if @xmath629 ; * @xmath630 if @xmath631 and @xmath632 if @xmath633 ( for each @xmath600 ) .",
    "we say that a vertex @xmath496 is a _ candidate for @xmath634 in @xmath0 _ if :    * @xmath635 ; * @xmath626 if @xmath636 and @xmath628 if @xmath637 ; * @xmath630 if @xmath638 and @xmath632 if @xmath639 ( for each @xmath600 ) .    similarly we say that a vertex @xmath496 is a _ candidate for @xmath593 in @xmath0 _ if :    * @xmath635 ; * @xmath626 if @xmath640 and @xmath628 if @xmath641 ; * @xmath630 if @xmath642 and @xmath632 if @xmath643 ( for each @xmath600 ) .",
    "( note that it is important that the first condition in the definition of a candidate for @xmath564 differs from the first condition in the definitions of candidates for @xmath634 and @xmath593 . )",
    "let @xmath644 denote the set of candidates for @xmath592 and @xmath593 respectively .",
    "( [ absdeg ] ) implies that @xmath645 . in this case",
    "( [ absdeg ] ) implies that every @xmath646 receives at least @xmath647 edges from @xmath648 in @xmath0 .",
    "so ( [ sss ] ) implies that there are at least @xmath649 edges in @xmath0 with startpoint in @xmath648 and endpoint in @xmath650 . without loss of generality",
    "assume that there are at least @xmath651 edges in @xmath0 with startpoint in @xmath652 and endpoint in @xmath650 .",
    "let @xmath653 be such an edge .",
    "notice that , by definition of candidates for @xmath564 and @xmath593 , @xmath654 spans a copy of @xmath78 in @xmath0 with @xmath655 and @xmath656 playing the roles of @xmath564 , @xmath634 and @xmath593 respectively .",
    "set @xmath657 . by construction",
    "@xmath521 spans a copy of @xmath3 in @xmath0 where @xmath56 plays the role of @xmath590 , @xmath620 plays the role of @xmath354 ( for @xmath600 ) , @xmath658 plays the role of @xmath564 , @xmath591 plays the role of @xmath634 and @xmath656 plays the role of @xmath593 .",
    "similarly , @xmath85 spans a copy of @xmath3 in @xmath0 where @xmath106 plays the role of @xmath590 , @xmath620 plays the role of @xmath354 ( for @xmath600 ) , @xmath658 plays the role of @xmath564 , @xmath591 plays the role of @xmath634 and @xmath656 plays the role of @xmath593 .",
    "* case 2 : * @xmath659 . in this case , @xmath660 note that there must be at least @xmath661 edges in @xmath662 otherwise , by adding at most @xmath663 arbitrary vertices to @xmath662 , we obtain a @xmath141-independent set in @xmath0 of size at least @xmath44 , a contradiction .",
    "consider any edge @xmath664)$ ] .    by definition of candidates for @xmath564 and @xmath634",
    ", @xmath665 spans a copy of @xmath78 in @xmath0 with @xmath666 and @xmath591 playing the roles of @xmath564 , @xmath634 and @xmath593 respectively .",
    "( indeed , by definition of @xmath662 there is a double edge from @xmath591 to both @xmath564 and @xmath634 in @xmath0 .",
    "further , @xmath667 . ) set @xmath668 . by construction",
    "@xmath521 spans a copy of @xmath3 in @xmath0 where @xmath56 plays the role of @xmath590 , @xmath620 plays the role of @xmath354 ( for @xmath600 ) , @xmath658 plays the role of @xmath564 , @xmath568 plays the role of @xmath634 and @xmath591 plays the role of @xmath593 .",
    "similarly , @xmath85 spans a copy of @xmath3 in @xmath0 .",
    "recall that there are at least @xmath669 choices for @xmath591 , at least @xmath669 choices for each @xmath620 and at least @xmath670 choices for the edges selected in cases 1 and 2 .",
    "overall , this implies that there are at least @xmath671 choices for @xmath121 , as desired .",
    "[ c3con ] let @xmath672 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath673 further suppose that    * @xmath0 does not contain any @xmath141-independent set of size at least @xmath71 , and * @xmath0 does not @xmath229-contain @xmath80 .    then , given any @xmath81 , at least one of the following conditions holds .",
    "* there are at least @xmath674 @xmath24-sets @xmath675 such that @xmath84 and @xmath533 span copies of @xmath41 in @xmath0 .",
    "* there are at least @xmath676 @xmath490-sets @xmath675 such that @xmath84 and @xmath533 span copies of @xmath677 in @xmath0 .",
    "define additional constants @xmath678 so that @xmath679 .",
    "consider any @xmath81 .",
    "set @xmath680 and @xmath681 .",
    "note that ( [ c3min ] ) implies @xmath682 .",
    "further , define @xmath683 , @xmath684 , @xmath685 and @xmath686 .",
    "( so @xmath687 is a partition of @xmath107 . )",
    "note that given any @xmath688 with @xmath689 and @xmath690 , @xmath691 and @xmath692 span copies of @xmath41 in @xmath0 .",
    "thus , if there are at least @xmath693 such edges @xmath688 , then we obtain at least @xmath674 @xmath24-sets @xmath675 such that @xmath84 and @xmath533 span copies of @xmath41 in @xmath0 , as desired .",
    "therefore , we may assume that    * there are at most @xmath693 edges @xmath688 with @xmath689 and @xmath690 .",
    "suppose that @xmath694 .",
    "then by ( [ c3min ] ) , every vertex in @xmath320 sends out at least @xmath695 edges to @xmath696 in @xmath0 .",
    "hence , there are at least @xmath697 edges @xmath688 with @xmath689 and @xmath690 , a contradiction to ( @xmath698 ) . together with an analogous argument",
    ", this implies that @xmath699 and so @xmath700    suppose that @xmath701 then by ( @xmath229 ) , @xmath702 ) \\leq 2 \\eta n^2 $ ] . by adding at most @xmath703 arbitrary vertices to @xmath704 we",
    "obtain a @xmath141-independent set in @xmath0 of size at least @xmath71 , a contradiction .",
    "hence , @xmath705 we now split the proof into two cases depending on the size of @xmath704 .",
    "* case 1 : * @xmath706 . in this case ,",
    "@xmath707 and so @xmath708 by ( @xmath698 ) , all but at most @xmath709 vertices @xmath710 send out at most @xmath711 edges to @xmath149 in @xmath0 .",
    "so each such vertex @xmath308 sends out at least @xmath712 edges to @xmath713 in @xmath0 and at least @xmath714 edges to @xmath715 in @xmath0 .",
    "altogether , this implies that @xmath716 ) \\geq ( |a|-2\\sqrt{\\eta } n)(1/3 - 6 \\eps ' ) n   \\stackrel{(\\ref{abbound})}{\\geq } ( |a|-2\\sqrt{\\eta }",
    "n ) ( |a|-7 \\eps ' n ) \\stackrel{(\\ref{abbound})}{\\geq } |a|^2 -3 \\eps ' n^2\\end{aligned}\\ ] ] and @xmath717 ) \\geq ( |a|-2\\sqrt{\\eta } n ) ( 1/3 - 2 \\eps ' ) n \\stackrel{(\\ref{cbound2})}{\\geq}(|a|-2\\sqrt{\\eta } n)(|c|-6\\eps ' n ) \\stackrel{(\\ref{abbound}),(\\ref{cbound2})}{\\geq } |a||c|-3 \\eps ' n^2.\\end{aligned}\\ ] ] an analogous argument implies that @xmath718){\\geq } |b|^2- 3 \\eps ' n^2   \\",
    "\\text { and } \\ e({g}[c , b ] ) { \\geq } |c||b|-3 \\eps ' n^2.\\end{aligned}\\ ] ]    suppose that @xmath719 and @xmath720 . then since @xmath721 )",
    "\\geq |a|^2 -3 \\eps ' n^2 $ ] , there are at least @xmath722 pairs of distinct vertices @xmath723 where @xmath724 , @xmath725 and @xmath726 . for each such pair @xmath723 , @xmath727 and @xmath728",
    "both span copies of @xmath41 in @xmath0 ( in fact , they both span copies of @xmath729 ) .",
    "this implies that ( i ) is satisfied .",
    "similarly , ( i ) holds if both @xmath730 and @xmath731 .",
    "we may therefore assume that @xmath732 or @xmath733 .",
    "without loss of generality assume that @xmath734 this implies that @xmath735 or @xmath736 .",
    "we now deal with these two subcases separately .",
    "* case 1a : * @xmath737 .    in this case",
    "we will show that ( ii ) is satisfied . note that @xmath738 then ( [ xc ] ) implies that there is a vertex @xmath739 .",
    "but by definition @xmath740 , a contradiction .",
    "thus , @xmath741    [ cbc ] if @xmath742 ) \\geq 6 \\eps '' n^2 $ ] then ( ii ) is satisfied .",
    "suppose that @xmath742 ) \\geq 6 \\eps '' n^2 $ ] .",
    "this implies that there are at least @xmath743 vertices @xmath744 that receive at least @xmath745 edges from @xmath149 in @xmath0 . by ( [ gb ] ) , all but at most @xmath746 vertices @xmath744 send out at least @xmath747 edges to @xmath149 in @xmath0 .",
    "together with ( [ xc ] ) this implies that there are at least @xmath748 vertices @xmath749 such that    * @xmath750 ; * @xmath751 and @xmath752    fix such a vertex @xmath163 . by the choice of @xmath163 and ( [ gb ] )",
    "there are at least @xmath753 vertices @xmath754 so that    * @xmath755 ; * @xmath756 .",
    "fix such a vertex @xmath757 . by definition of @xmath149 ,",
    "thus , @xmath759 spans a copy of @xmath41 in @xmath0 .",
    "( [ c3min ] ) , ( [ abbound ] ) and ( [ yc ] ) imply that @xmath760 together with ( [ gb ] ) this implies that there are at least @xmath761 vertices @xmath762 so that    * @xmath763 ; * @xmath764 .",
    "fix such a vertex @xmath765 .",
    "next fix a vertex @xmath766 such that    * @xmath767 ; * @xmath768 .",
    "there are at least @xmath769 choices for @xmath770 . by definition of @xmath149 ,",
    "thus , @xmath772 spans a copy of @xmath41 in @xmath0 .    finally , choose a vertex @xmath773 such that    * @xmath774 .",
    "the choice of @xmath775 and @xmath770 ensures that there are at least @xmath776 choices for @xmath777 .",
    "set @xmath778 . by construction",
    "both @xmath84 and @xmath85 span copies of @xmath677 in @xmath0 ( see figure  2 ) .",
    "recall that there are at least @xmath745 choices for @xmath163 , at least @xmath779 choices for @xmath757 , at least @xmath780 choices for @xmath765 , at least @xmath769 choices for @xmath770 and at least @xmath776 choices for @xmath777 .",
    "overall , this implies that there are at least @xmath781 choices for @xmath121 .",
    "so indeed ( ii ) is satisfied .",
    "this proves the claim .",
    "assume for a contradiction that @xmath742 ) < 6 \\eps '' n^2 $ ] .",
    "this implies that @xmath782 ) & \\geq   \\delta ^- ( g)|c| -e(g[b , c])-e(g[a , c ] ) -e ( g[d , c ] )   \\\\ & \\stackrel{(\\ref{c3min})}{\\geq } ( 2/3-\\eps)n|c| -6\\eps '' n^2 -|a||c|-\\eps ' n |c|\\nonumber   \\\\ & \\stackrel{(\\ref{abbound}),(\\ref{cbound2})}{\\geq } |c|(2/3-\\eps -24\\eps '' -1/3 - 8\\eta -\\eps ' ) n \\geq |c|(1/3 - 25 \\eps '' ) n    \\nonumber \\\\ & \\stackrel{(\\ref{cbound2})}{\\geq } |c|^2 -\\sqrt{\\eps '' } n^2.\\nonumber\\end{aligned}\\ ] ] similarly , @xmath783 ) & \\geq   \\delta ^+ ( g)|b| -e(g[b])-e(g[b , c ] ) -e ( g[b , d ] )   \\\\ &   \\stackrel{(\\ref{c3min})}{\\geq } ( 2/3-\\eps)n|b| -|b|^2 - 6\\eps '' n^2 -\\eps ' n |b| \\nonumber \\\\ & \\stackrel{(\\ref{abbound})}{\\geq } |b|(2/3-\\eps -1/3 - 8\\eta -24\\eps ''   -\\eps ' ) n \\geq |b|(1/3 - 25 \\eps '' ) n   \\nonumber \\\\ &   \\stackrel{(\\ref{abbound})}{\\geq } |b||a| -\\sqrt{\\eps '' } n^2.\\nonumber\\end{aligned}\\ ] ] let @xmath784 be a partition of @xmath107 such that    * @xmath785 ; * @xmath786 .",
    "such a partition exists by ( [ abbound ] ) and ( [ cbound2 ] ) .",
    "further ,    * @xmath787 ) \\stackrel{(\\ref{gac})}{\\geq } |a''||c''|-\\alpha n^2 /6;$ ] * @xmath788 ) \\stackrel{(\\ref{gb})}{\\geq } |c''||b''|-\\alpha n^2 /6;$ ] * @xmath789 ) \\stackrel{(\\ref{gbaf})}{\\geq } |b''||a''|-\\alpha n^2 /6;$ ] * @xmath790 ) \\stackrel{(\\ref{ga})}{\\geq } |a''|^2-\\alpha n^2 /6;$ ] * @xmath791 ) \\stackrel{(\\ref{gb})}{\\geq } |b''|^2-\\alpha n^2 /6;$ ] * @xmath792 ) \\stackrel{(\\ref{gcf})}{\\geq } |c''|^2-\\alpha n^2 /6.$ ]    this implies that @xmath0 @xmath229-contains @xmath80 , a contradiction .",
    "so @xmath742 ) \\geq 6 \\eps '' n^2 $ ] .",
    "claim  [ cbc ] therefore implies that ( ii ) holds , as required .    *",
    "case 1b : * @xmath736 .    in this case",
    "we will show that ( i ) is satisfied .",
    "since @xmath736 , @xmath793 then ( [ b2 ] ) implies that there is a vertex @xmath794 .",
    "but by definition @xmath795 , a contradiction .",
    "thus , @xmath796 this implies that @xmath797 if @xmath798 ) \\geq 14 \\eps '' n^2 $ ] then ( i ) is satisfied .",
    "suppose that @xmath798 ) \\geq 14 \\eps '' n^2 $ ] .",
    "this implies that there are at least @xmath799 vertices @xmath744 that send out at least @xmath800 edges to @xmath148 in @xmath0 . by ( [ gac ] ) all but at most @xmath801 vertices @xmath744",
    "receive at least @xmath802 edges from @xmath148 in @xmath0 .",
    "together with ( [ b2 ] ) and ( [ yc2 ] ) this implies that there are at least @xmath803 vertices @xmath744 so that    * @xmath804 ; * @xmath805 and @xmath806 .",
    "fix such a vertex @xmath163 .",
    "let @xmath710 such that    * @xmath807 .",
    "the choice of @xmath163 together with ( [ ya1 ] ) implies that there are at least @xmath808 choices for @xmath308 . since @xmath710 , @xmath809 .",
    "set @xmath810 . by construction @xmath521 and @xmath85",
    "both span copies of @xmath41 in @xmath0 . in total",
    "there are at least @xmath811 choices for @xmath121 .",
    "therefore ( i ) is satisfied .",
    "this proves the claim .",
    "assume for a contradiction that @xmath798 ) < 14 \\eps '' n^2 $ ] .",
    "this implies that @xmath812 ) & \\geq   \\delta ^+ ( g)|c| -e(g[c , a])-e(g[c , b ] ) -e ( g[c , d ] )   \\\\ & \\stackrel{(\\ref{c3min})}{\\geq } ( 2/3-\\eps)n|c| -14\\eps '' n^2 -|c||b|-\\eps ' n |c| \\nonumber   \\\\ & \\stackrel{(\\ref{abbound}),(\\ref{cbound2})}{\\geq } |c|(2/3-\\eps -50\\eps '' -1/3 - 8\\eta -\\eps ' ) n \\geq |c|(1/3 - 51 \\eps '' ) n \\nonumber \\\\ &   \\stackrel{(\\ref{cbound2})}{\\geq } |c|^2 -\\sqrt{\\eps '' } n^2.\\nonumber\\end{aligned}\\ ] ] similarly , @xmath813 ) & \\geq   \\delta ^- ( g)|a| -e(g[a ] ) -e ( g[c , a ] ) -e(g[d , a ] ) \\\\ & \\stackrel{(\\ref{c3min})}{\\geq } ( 2/3-\\eps)n|a| -|a|^2 - 14\\eps '' n^2 -\\eps ' n |a| \\nonumber \\\\ & \\stackrel{(\\ref{abbound})}{\\geq } |a|(2/3-\\eps -1/3 - 8\\eta -50\\eps ''   -\\eps ' ) n \\geq |a|(1/3 - 51 \\eps '' )",
    "n \\nonumber \\\\ &   \\stackrel{(\\ref{abbound})}{\\geq } |b||a| -\\sqrt{\\eps '' } n^2.\\nonumber\\end{aligned}\\ ] ] by arguing precisely as in case 1a , ( [ ga])([gb ] ) , ( [ gc1 ] ) and ( [ gba ] ) imply that @xmath0 @xmath229-contains @xmath80 , a contradiction .",
    "so @xmath798 ) \\geq 14 \\eps ''",
    "claim  [ c1b ] therefore implies that ( i ) holds , as required .",
    "* case 2 : * @xmath814 . in this case",
    "we will show that ( ii ) is satisfied .",
    "set @xmath815 .",
    "so @xmath816 this implies that @xmath817 thus , @xmath818 and @xmath819 hence , @xmath820    by ( @xmath698 ) , all but at most @xmath709 vertices @xmath821 receive at most @xmath711 edges from @xmath822 in @xmath0 .",
    "so each such vertex @xmath313 receives at least @xmath823 edges from @xmath824 in @xmath0 .",
    "this implies that @xmath825 ) \\geq ( |b|-2\\sqrt{\\eta } n)(|c|-3 \\sqrt{\\eta }",
    "n)\\geq   |c||b| -5 \\sqrt{\\eta } n^2.\\end{aligned}\\ ] ] by ( @xmath229 ) , @xmath826)+e(g[a , d ] ) \\leq 2\\eta n^2 \\ \\text { and } \\ e(g[d])+e(g[d , b ] )",
    "\\leq 2\\eta n^2.\\end{aligned}\\ ] ] therefore , @xmath827 )   & \\geq \\delta ^- ( g)|d|-e(g[a , d])-e(g[d])-e(g[c , d ] )   \\\\ & \\stackrel{(\\ref{c3min}),(\\ref{gdad})}{\\geq } ( 2/3-\\eps ) n|d|- 2 \\eta n^2 -|c||d|    \\stackrel{(\\ref{cb3})}{\\geq }   ( 1/3-\\sqrt{\\eta } -d ) n|d|    \\stackrel{(\\ref{ab2})}{\\geq } |b||d|- \\sqrt{\\eta } n^2 \\nonumber\\end{aligned}\\ ] ] and @xmath828 )    \\stackrel{(\\ref{c3min}),(\\ref{gdad})}{\\geq } ( 2/3-\\eps ) n|d|- 2 \\eta n^2 -|d||a|    \\stackrel{(\\ref{ab2})}{\\geq }   ( 1/3-\\sqrt{\\eta } + d ) n|d|    \\stackrel{(\\ref{cb3})}{\\geq } |c||d|- \\sqrt{\\eta } n^2.\\end{aligned}\\ ] ]    fix @xmath829 such that    * @xmath830 ; * @xmath831 ; * @xmath832 .",
    "( [ conxy ] ) , ( [ gbb ] ) and ( [ gcd1 ] ) imply that there are at least @xmath833 choices for @xmath834 .",
    "next fix @xmath754 such that    * @xmath835 ; * @xmath836 .",
    "the choice of @xmath834 together with ( [ gbd ] ) implies that there are at least @xmath837 choices for @xmath757 .",
    "further , @xmath838 by definition of @xmath149 .",
    "thus , @xmath839 spans a copy of @xmath41 in @xmath0 .",
    "fix @xmath840 such that    * @xmath841 ; * @xmath842 ; * @xmath843 .",
    "again ( [ conxy ] ) , ( [ gbb ] ) and ( [ gcd1 ] ) imply that there are at least @xmath844 choices for @xmath845 .",
    "next fix @xmath846 such that    * @xmath847 ; * @xmath848",
    ".    there are at least @xmath849 choices for @xmath765 .",
    "since @xmath850 , @xmath851 spans a copy of @xmath41 in @xmath0 .",
    "finally let @xmath852 .",
    "there are at least @xmath853 choices for @xmath854 .",
    "set @xmath855 . by construction @xmath84 and @xmath533",
    "both span copies of @xmath856 in @xmath0 ( see figure  3 ) .        in total",
    "there are at least @xmath857 choices for @xmath121 .",
    "therefore ( ii ) is satisfied , as desired .",
    "in this section we apply our connection lemmas to prove theorems  [ nonex1 ] and  [ nonex2 ] . following the ideas in @xcite , we first show in lemma  [ lem : abs ] that in order to find the absorbing set described in theorems  [ nonex1 ] and  [ nonex2 ] , it suffices to prove that there are at least @xmath858 @xmath3-absorbing @xmath859-sets for every fixed @xmath4-set from @xmath107 .",
    "[ lem : abs ] let @xmath860 and let @xmath293 .",
    "then there exists an @xmath13 such that the following holds .",
    "let @xmath32 .",
    "consider a digraph @xmath0 on @xmath33 vertices .",
    "suppose that any @xmath4-set of vertices @xmath61 can be @xmath3-absorbed by at least @xmath858 @xmath859-sets of vertices from @xmath107 .",
    "then @xmath107 contains a set @xmath66 so that    * @xmath230 ; * @xmath66 is a @xmath3-absorbing set for any @xmath231 such that @xmath232 and @xmath233 .",
    "the proof of lemma  [ lem : abs ] follows the same ideas as other such absorbing lemmas in the area .",
    "in particular , the proof of lemma  [ lem : abs ] follows the proof of lemma  5.2 in  @xcite very closely . for completeness",
    ", we give the proof in section  [ subabs ] .",
    "[ absorb1 ] let @xmath227 where @xmath35 and @xmath7 , and let @xmath32 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices so that @xmath861 further suppose that    * @xmath0 does not contain any @xmath141-independent set of size at least @xmath44 , and * if @xmath42 then @xmath0 does not @xmath229-contain @xmath80 .",
    "then there are at least @xmath858 @xmath3-absorbing @xmath859-sets in @xmath107 for every @xmath4-subset of @xmath107 .",
    "theorem  [ nonex1 ] follows immediately from lemmas  [ lem : abs ] and  [ absorb1 ] .",
    "similarly , theorem  [ nonex2 ] follows immediately from lemma  [ lem : abs ] and the following result .",
    "[ absorb2 ] let @xmath234 where @xmath35 and @xmath7 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices so that , for any @xmath47 , @xmath862 further suppose that @xmath0 does not contain any @xmath141-independent set of size at least @xmath44 .",
    "then there are at least @xmath858 @xmath45-absorbing @xmath859-sets in @xmath107 for every @xmath4-subset of @xmath107 .",
    "the rest of the section is devoted to the proofs of lemmas  [ lem : abs][absorb2 ] .",
    "given an @xmath4-set @xmath61 , let @xmath863 denote the family of all @xmath3-absorbing @xmath859-sets for @xmath65 in @xmath864 . by assumption , @xmath865 .",
    "let @xmath866 be the family of @xmath859-sets obtained by selecting each of the @xmath867 elements of @xmath864 independently with probability @xmath868 .",
    "then @xmath869 for every set @xmath870 .",
    "since @xmath5 is sufficiently large , proposition  [ chernoff ] implies that with high probability we have @xmath871 @xmath872 let @xmath92 be the number of intersecting pairs of members of @xmath866",
    ". then @xmath873 by markov s bound , the probability that @xmath874 is at least @xmath875 .",
    "therefore we can find a family @xmath866 of @xmath859-sets satisfying and and having at most @xmath876 intersecting pairs .",
    "removing all non - absorbing @xmath859-sets and one set from each of the intersecting pairs in @xmath866 , we obtain a family @xmath877 of disjoint @xmath3-absorbing @xmath859-sets such that @xmath878 and for all @xmath879 , @xmath880 let @xmath66 denote the disjoint union of the sets in @xmath877 . then @xmath881 .",
    "since @xmath877 consists of disjoint @xmath3-absorbing sets and each @xmath3-absorbing set is covered by a perfect @xmath3-packing , @xmath59 $ ] contains a perfect @xmath3-packing .",
    "now let @xmath882 be a set of at most @xmath883 vertices such that @xmath884 for some @xmath885 .",
    "we arbitrarily partition @xmath259 into @xmath4-sets @xmath886 . because of , we are able to @xmath3-absorb each @xmath887 with a different @xmath859-set from @xmath888 . therefore @xmath262 $ ] contains a perfect @xmath3-packing , as desired .",
    "define @xmath889 such that @xmath890 .",
    "note that ( [ minabs ] ) implies that there are at least @xmath891 @xmath4-sets in @xmath892 that span copies of @xmath3 in @xmath0 .",
    "[ claimabs ] for any @xmath499 there are at least @xmath893 @xmath894-sets @xmath675 such that both @xmath84 and @xmath533 span copies of @xmath151 in @xmath0 .",
    "suppose for a contradiction that claim  [ claimabs ] is false",
    ". then if @xmath42 , certainly lemma  [ c3con](ii ) does not hold .",
    "in particular , lemmas  [ con+- ] , [ t4con][c3con ] imply that , for any @xmath499 there are at least @xmath895 @xmath82-sets @xmath896 such that both @xmath897 and @xmath898 span copies of @xmath3 in @xmath0 .",
    "fix such a set @xmath899 .",
    "( [ not ] ) implies that there are least @xmath900",
    "@xmath4-sets @xmath901 that span copies of @xmath3 in @xmath0 and that are disjoint from @xmath902 .",
    "fix such a set @xmath903 and define @xmath904 . by construction",
    "both @xmath84 and @xmath533 span copies of @xmath151 in @xmath0 .",
    "further , since @xmath905 , there are at least @xmath906 choices for @xmath121 , a contradiction .",
    "this proves the claim .",
    "consider any @xmath4-subset @xmath907 of @xmath107 .",
    "fix some @xmath4-subset @xmath908 of @xmath107 that spans a copy of @xmath3 in @xmath0 and that is disjoint from @xmath65 .",
    "( [ not ] ) implies that there are least @xmath909 choices for @xmath92 .",
    "next fix a @xmath894-set @xmath910 such that both @xmath911 and @xmath912 span copies of @xmath151 in @xmath0 and so that @xmath913 is disjoint from @xmath914 .",
    "claim  [ claimabs ] implies that there are at least @xmath915 choices for @xmath913 .",
    "similarly , claim  [ claimabs ] implies that we can iteratively choose @xmath894-sets @xmath916 such that , for each @xmath917 :    * both @xmath918 and @xmath919 span copies of @xmath151 in @xmath0 ; * @xmath920 is disjoint from @xmath921 ; * @xmath920 is disjoint from @xmath922 for all @xmath923 ; * there are at least @xmath924 choices for @xmath920 .    set @xmath925 .",
    "then @xmath185 is a @xmath3-absorbing @xmath859-set for @xmath65 .",
    "indeed , @xmath926 $ ] contains a perfect @xmath3-packing for all @xmath927 so @xmath142 $ ] contains a perfect @xmath3-packing .",
    "furthermore , @xmath928 $ ] contains a perfect @xmath3-packing for all @xmath927 and @xmath92 spans a copy of @xmath3 in @xmath0 so @xmath929 $ ] contains a perfect @xmath3-packing .    in summary",
    ", there are at least @xmath930 choices for @xmath92 and at least @xmath924 choices for each of the @xmath920 .",
    "since each @xmath3-absorbing @xmath859-set may be counted @xmath931 times there are at least @xmath932 @xmath3-absorbing @xmath859-sets for @xmath65 , as desired .",
    "define @xmath889 such that @xmath890 . by lemma  [ con+- ] ,",
    "for every vertex @xmath47 , there are at least @xmath498 @xmath82-sets @xmath83 such that @xmath84 spans a copy of @xmath45 in @xmath0 .",
    "thus , there are at least @xmath933 @xmath4-sets in @xmath107 that span copies of @xmath45 in @xmath0 .    by now following the proof of lemma  [ absorb1 ] identically ( applying ( [ not+- ] ) and",
    "lemma  [ con+- ] ) we conclude that there are at least @xmath858 @xmath45-absorbing @xmath859-sets in @xmath107 for every @xmath4-subset of @xmath107 , as required .",
    "in sections  [ secex1 ] and  [ secexc3 ] we deal with the extremal cases of theorems  [ mainthm ] .",
    "the proof of lemma  [ ex1 ] builds on the ideas from the extremal case in  @xcite .",
    "( note though that  @xcite concerns embedding _ powers of hamilton cycles _ in _",
    "graphs_. ) in this section we give a number of results that will be applied in the proof of lemma  [ ex1 ] .      in the proof of lemma  [ ex1 ]",
    "we will apply the following result which is a direct consequence of theorems  [ nonex1 ] and  [ almostthm ] ( its proof is implicit in the proof of theorem  [ mainthm ] given in section  [ pfsec ] ) .",
    "[ 1nonex ] let @xmath934 where @xmath35 and @xmath7 so that @xmath4 divides @xmath5 , and let @xmath935 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices so that @xmath228 further suppose that @xmath0 does not contain any @xmath141-independent set of size at least @xmath44 .",
    "then @xmath0 contains a perfect @xmath3-packing .",
    "we will also apply the following immediate consequence of theorem  [ rpart ] .",
    "[ rpart2 ] given @xmath12 there exists an @xmath13 such that the following holds .",
    "suppose @xmath0 is an @xmath4-partite digraph with vertex classes @xmath14 where @xmath15 for all @xmath16 .",
    "if @xmath936 then @xmath0 contains a perfect @xmath2-packing .",
    "here @xmath937 ( @xmath938 ) denotes the minimum outdegree ( indegree ) of a vertex from one vertex class @xmath19 to another vertex class @xmath20 .",
    "a _ matching _ in a ( di)graph @xmath0 is a collection of vertex - disjoint edges @xmath939 .",
    "we write @xmath940 for the set of vertices covered by the edges from @xmath66 .",
    "we say that @xmath66 is a _ @xmath854-matching _ if @xmath941 .",
    "we say that @xmath66 is a _ perfect matching _ if @xmath942 .",
    "[ simplematch ] let @xmath943 .",
    "suppose that @xmath0 is a graph on @xmath944 vertices such that @xmath945 .",
    "let @xmath83 such that @xmath946 .",
    "then @xmath0 contains a @xmath854-matching that covers all the vertices in @xmath121 .",
    "it is easy to see that @xmath0 contains a @xmath854-matching .",
    "let @xmath66 be a @xmath854-matching in @xmath0 that covers the maximum number of vertices from @xmath121 .",
    "suppose for a contradiction that there is a vertex @xmath131 uncovered by @xmath66 .",
    "in particular , @xmath66 covers more vertices in @xmath947 than in @xmath121 .",
    "there exist non - negative integers @xmath948 such that @xmath949 and :    * @xmath66 contains precisely @xmath308 edges @xmath950 where @xmath951 and @xmath952 ; * @xmath66 contains precisely @xmath313 edges with both endpoints in @xmath121 ; * @xmath66 contains precisely @xmath163 edges with both endpoints in @xmath123 .    since @xmath66 covers more vertices in @xmath123 than in @xmath121 , @xmath953 ( and so @xmath954 ) .",
    "suppose @xmath56 has a neighbour @xmath955 .",
    "then add @xmath29 to @xmath66 and delete an edge @xmath950 from @xmath66 such that @xmath956 .",
    "then @xmath66 is a @xmath854-matching covering more vertices in @xmath121 than before , a contradiction .",
    "so @xmath56 only has neighbours in @xmath940 .",
    "suppose @xmath957 is an edge in @xmath66 such that @xmath951 and @xmath952 .",
    "if @xmath958 then delete @xmath957 from @xmath66 and add @xmath959 to @xmath66 .",
    "so again @xmath66 is a @xmath854-matching covering more vertices in @xmath121 than before , a contradiction .",
    "thus , @xmath56 is not adjacent to @xmath960 .",
    "a similar argument shows that , if @xmath961 with @xmath956 , then @xmath962 .",
    "together with ( i)(iii ) this shows that @xmath56 has at most @xmath963 neighbours in @xmath0 , a contradiction , as desired .",
    "the following immediate consequence of proposition  [ simplematch ] will be applied in the proof of lemma  [ ex1 ] .",
    "[ simplematch2 ] let @xmath943 .",
    "suppose that @xmath0 is a digraph on @xmath944 vertices such that , for any @xmath47 , @xmath964 or @xmath965 .",
    "let @xmath83 such that @xmath946 .",
    "then @xmath0 contains a @xmath854-matching that covers all the vertices in @xmath121 .",
    "let @xmath966 .",
    "suppose that @xmath0 is a ( di)graph @xmath0 on @xmath5 vertices .",
    "then we say that @xmath0 is _",
    "@xmath511-close to @xmath967 _ if there exists a partition @xmath968 of @xmath107 such that @xmath969 , @xmath970 and @xmath971 .",
    "[ matchstab ] let @xmath139 and @xmath54 be even such that @xmath972 .",
    "suppose that @xmath0 is a graph on @xmath5 vertices so that @xmath973 then at least one of the following conditions holds :    * @xmath0 contains a @xmath974-independent set of size at least @xmath975 ; * @xmath0 is @xmath976-close to @xmath967 ; * @xmath0 contains a perfect matching .",
    "suppose that @xmath0 does not contain a perfect matching .",
    "let @xmath66 be a maximal matching in @xmath0 .",
    "so there exists distinct @xmath977 .",
    "the maximality of @xmath66 implies that @xmath978 .",
    "define @xmath979 .",
    "define @xmath980 analogously .",
    "( [ matmin ] ) implies that @xmath981 such that @xmath982 and @xmath983 . if @xmath984 then by definition of @xmath985 and @xmath980 , @xmath986 .",
    "define @xmath987 .",
    "thus , @xmath988 is a larger matching than @xmath66 , a contradiction .",
    "so @xmath989 .",
    "let @xmath990 such that @xmath991 .",
    "then by definition of @xmath985 and @xmath980 , @xmath992 . set @xmath993 .",
    "then @xmath988 is a larger matching than @xmath66 , a contradiction .",
    "this proves that there is no such edge @xmath994 .",
    "define @xmath995 .",
    "suppose that @xmath996 .",
    "consider any @xmath997 . then in @xmath0",
    ", @xmath223 does not have any neighbours in @xmath998 .",
    "so ( [ matmin ] ) implies that @xmath999 .",
    "so together with ( [ snbound ] ) this implies that @xmath1000 .",
    "further , @xmath1001 is an independent set in @xmath0 . by adding at most @xmath1002 arbitrary vertices",
    "to @xmath1003 we obtain a @xmath974-independent set of size at least @xmath975 in @xmath0 .",
    "finally , suppose that @xmath1004 .",
    "so @xmath985 and @xmath980 are disjoint and @xmath1005 .",
    "together with ( [ snbound ] ) this implies that @xmath0 is @xmath976-close to @xmath967 , as desired .",
    "we will also apply the following consequence of proposition  [ matchstab ] .",
    "[ matchstab2 ] let @xmath139 and @xmath54 be even such that @xmath972 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices so that , for every @xmath47 , @xmath1006 then at least one of the following conditions holds :    * @xmath0 contains a @xmath1007-independent set of size at least @xmath975 ; * @xmath0 is @xmath1008-close to @xmath967 ; * @xmath0 contains a perfect matching .",
    "define constants @xmath1009 and @xmath13 such that @xmath1010 let @xmath32 and @xmath0 be a digraph on @xmath52 vertices as in the statement of the lemma . by assumption @xmath0 contains a @xmath141-independent set @xmath180 of size @xmath44 .",
    "( so @xmath180 is also a @xmath1011-independent set in @xmath0 . )",
    "consider @xmath1012 . if @xmath69 contains a @xmath1013-independent set @xmath181 of size @xmath44 set @xmath1014 .",
    "( note that @xmath181 is also a @xmath1013-independent set in @xmath0 . )",
    "otherwise let @xmath1015 . repeating this process , for some @xmath1016",
    ", we obtain a partition @xmath1017 of @xmath107 such that :    * @xmath173 is a @xmath1018-independent set of size @xmath44 in @xmath0 ( for all @xmath1019 ) ; * @xmath1020 and @xmath1021 $ ] does not contain a @xmath1022-independent set of size @xmath44 .",
    "( the latter condition is vacuous if @xmath1023 . )",
    "if @xmath1024 define additional constants @xmath1025 so that @xmath1026 if @xmath1027 then define @xmath1028 so that @xmath1029    let @xmath1030 and @xmath1031 .",
    "we now introduce a number of definitions .",
    "* we say that a vertex @xmath1032 is _",
    "@xmath1033-bad _ if @xmath1034 or @xmath1035 . otherwise we say that @xmath56 is _",
    "@xmath1033-good_. * we say that a vertex @xmath1036 is",
    "_ @xmath1037-exceptional _ if @xmath1038 .",
    "otherwise we say that @xmath56 is _",
    "@xmath1033-acceptable_. * we say that a vertex @xmath1036 is _ @xmath1037-excellent _ if @xmath1039 . *",
    "similarly , we say that a vertex @xmath1040 is _ @xmath1041-excellent _ if @xmath1042 .    later on",
    "we will modify the vertex classes @xmath1043 . when referring to , for example , @xmath1033-bad vertices , we mean with respect to the current class @xmath173 and not the original class .    for each @xmath1019 ,",
    "since @xmath173 is a @xmath1018-independent set in @xmath0 and @xmath1044 , there are at most @xmath1045 vertices in @xmath173 that are @xmath1046-bad .",
    "furthermore , ( [ minex1 ] ) implies that there are at least @xmath1047 edges in @xmath0 with one endpoint in @xmath173 and the other in @xmath1048 .",
    "so as @xmath1049 , there are at most @xmath1045 vertices @xmath1036 that are not @xmath1050-excellent .",
    "( this implies that there are at most @xmath1051 @xmath1052-exceptional vertices . )    * modifying the partition @xmath1053 .",
    "* let @xmath328 be the largest integer such that there exists both @xmath328 @xmath1054-bad vertices @xmath1055 _ and _",
    "@xmath328 @xmath1056-exceptional vertices @xmath1057 . note that @xmath1058 .",
    "move @xmath1059 into @xmath180 and remove @xmath1060 from @xmath180 so that each @xmath354 replaces @xmath374 in their respective classes .",
    "( so if originally @xmath1061 then we move @xmath354 into @xmath1062 .",
    "if originally @xmath1063 then we move @xmath354 into @xmath149 . )",
    "we call this ` phase ' _ step  1_.    if a vertex @xmath1064 was initially @xmath1065-good then after step  1 , @xmath56 is still @xmath1066-good .",
    "further , each @xmath374 is now @xmath1067-good .",
    "so if @xmath180 initially contained _ precisely _",
    "@xmath328 @xmath1054-bad vertices , then @xmath180 no longer contains any @xmath1068-bad vertices .    if a vertex @xmath1069 was initially @xmath1054-acceptable , then after stage  1 , @xmath106 is still @xmath1070-acceptable .",
    "further , each vertex @xmath354 is @xmath1070-acceptable .",
    "so if initially there were _ precisely _",
    "@xmath328 @xmath1054-exceptional vertices , then after stage  1 there are no @xmath1071-exceptional vertices .",
    "thus , after stage  1 we have that :    * @xmath173 is an @xmath229-independent set of size @xmath44 in @xmath0 ( for all @xmath1031 ) ; * if @xmath1027 then @xmath1021 $ ] does not contain any @xmath1072-independent set of size @xmath44 ; * there are no @xmath1068-bad vertices in @xmath180 or there are no @xmath1071-exceptional vertices in @xmath1073 ; * @xmath173 contains at most @xmath1074 @xmath1075-bad vertices ( for all @xmath1031 ) ; * there are at most @xmath1074 vertices in @xmath1048 that are not @xmath1076-excellent ( for each @xmath1019 ) .",
    "suppose that @xmath1077 .",
    "we now explain _",
    "stage  2 _ of the switching procedure .",
    "let @xmath1078 be the largest integer such that there exists both @xmath1078 @xmath1079-bad vertices @xmath1080 and @xmath1078 @xmath1081-exceptional vertices @xmath1082 at the end of stage 1 .",
    "note that @xmath1083 .",
    "move @xmath1084 into @xmath181 and remove @xmath1085 from @xmath181 so that each @xmath354 replaces @xmath374 in their respective classes .",
    "if a vertex @xmath1086 was @xmath1087-good after stage  1 then @xmath56 is still @xmath1088-good .",
    "further , each @xmath374 is now @xmath1089-good .",
    "so if at the end of stage 1 , @xmath181 contained _ precisely _ @xmath1078 @xmath1087-bad vertices , then @xmath181 no longer contains any @xmath1090-bad vertices .",
    "if a vertex @xmath1091 was @xmath1092-acceptable at the end of stage  1 , then @xmath106 is still @xmath1093-acceptable .",
    "further , each vertex @xmath354 is @xmath1093-acceptable .",
    "so if at the end of stage  1 , there were _ precisely _",
    "@xmath1078 @xmath1092-exceptional vertices , then there are now no @xmath1094-exceptional vertices .    recall that after stage  1 there are no @xmath1068-bad vertices in @xmath180 or there are no @xmath1071-exceptional vertices in @xmath1073 .",
    "suppose that the former holds .",
    "then ( [ minex1 ] ) implies that after stage  1 every vertex in @xmath180 is @xmath1095-excellent .",
    "in particular , @xmath180 is not modified in stage  2 .",
    "next suppose that after stage  1 there were no @xmath1071-exceptional vertices in @xmath1073 .",
    "suppose that @xmath56 is a vertex that lies in @xmath1096 both after stage  1 and after stage  2 .",
    "then after stage  2 @xmath56 is a @xmath1097-acceptable vertex .",
    "suppose that @xmath56 is a vertex in @xmath180 after stage  1 and a vertex in @xmath1073 after stage  2 .",
    "then @xmath1098 after stage  2 and so was a @xmath1081-exceptional vertex after stage  1 .",
    "together with ( [ minex1 ] ) , this implies that , after stage  2 , @xmath56 is a @xmath1099-excellent vertex ( in particular , @xmath56 is not @xmath1097-exceptional ) .",
    "overall this implies that , after stage  2 , there are no @xmath1100-bad vertices in @xmath180 or there are no @xmath1097-exceptional vertices in @xmath1073 .    therefore , after stage  2 we have that :    * @xmath173 is a @xmath1101-independent set of size @xmath44 in @xmath0 ( for all @xmath1031 ) ; * if @xmath1027 then @xmath1021 $ ] does not contain any @xmath1102-independent set of size @xmath44 ; * there are no @xmath1103-bad vertices in @xmath173 or there are no @xmath1104-exceptional vertices in @xmath1105 for @xmath1106 ; * @xmath173 contains at most @xmath1107 @xmath1103-bad vertices ( for all @xmath1031 ) ; * there are at most @xmath1107 vertices in @xmath1048 that are not @xmath1108-excellent ( for each @xmath1019 ) .    by applying an analogous switching procedure iteratively for @xmath1109",
    "we modify the partition @xmath1110 of @xmath107 such that the following conditions hold :    * @xmath1110 remains a partition of @xmath107 so that @xmath173 is a @xmath1111-independent set of size @xmath44 in @xmath0 ( for all @xmath1031 ) ; * if @xmath1027 then @xmath1021 $ ] does not contain any @xmath1112-independent set of size @xmath44 ; * there are no @xmath1113-bad vertices in @xmath173 or there are no @xmath1114-exceptional vertices in @xmath1048 ( for all @xmath1031 ) ; * @xmath173 contains at most @xmath1115 @xmath1113-bad vertices ( for all @xmath1031 ) ; * there are at most @xmath1115 vertices in @xmath1048 that are not @xmath1116-excellent ( for each @xmath1019 ) .",
    "note that if @xmath1027 then ( [ minex1 ] ) implies that @xmath1117 ) \\geq \\left ( 1- \\frac{1}{r - s } \\right ) |b|.\\end{aligned}\\ ] ]      in this subsection we will assume that either ( i ) @xmath1120 ( and so @xmath1118 ) or ( ii ) @xmath1121 and @xmath1021 $ ] is not @xmath889-close to @xmath1119 .",
    "the case when @xmath1121 and @xmath1021 $ ] is @xmath889-close to @xmath1119 is considered in section  [ secondcase ] .    * covering the exceptional vertices with matchings .",
    "* given any @xmath1019 , let @xmath1122 denote the set of @xmath1114-exceptional vertices in @xmath1048 .",
    "( @xmath1123 ) implies that @xmath1124 for all @xmath1019 .",
    "( [ minex1 ] ) implies that a vertex can not be both @xmath1114-exceptional and @xmath1125-exceptional for @xmath1126 .",
    "so @xmath1122 and @xmath1127 are disjoint for all @xmath1126 .",
    "given @xmath1019 , if @xmath1128 , set @xmath1129 to be the empty digraph .",
    "if @xmath1130 , set @xmath1131 $ ] . if @xmath1132 then by @xmath1133 , there are no @xmath1134-bad vertices in @xmath173 .",
    "thus , by ( [ minex1 ] ) every vertex in @xmath173 is @xmath1135-excellent for all @xmath1136 .",
    "in particular , if @xmath176 then @xmath1137 . therefore the digraphs @xmath1138 are vertex - disjoint .",
    "if @xmath1130 then , since @xmath1139 , ( [ minex1 ] ) implies that @xmath1140 ( for @xmath1031 ) . further , @xmath1141 . so proposition  [ simplematch2 ] implies that there are disjoint matchings @xmath1142 in @xmath0 such that :    * @xmath1143 is a @xmath614-matching in @xmath1129 that covers all the vertices in @xmath1122 ( for all @xmath1019 ) .",
    "note that if @xmath1144 then @xmath1143 is empty .    *",
    "extending the matchings @xmath1143 into @xmath3-packings . *",
    "our next task is to find vertex - disjoint @xmath3-packings @xmath1145 in @xmath0 so that , for each @xmath1019 :    * @xmath1146 contains precisely @xmath614 disjoint copies of @xmath3 ; * @xmath1146 covers @xmath1143 .",
    "in particular , each copy of @xmath3 in @xmath1146 contains a unique edge from @xmath1143 ; * @xmath1146 covers precisely @xmath614 vertices from @xmath1062 ( for each @xmath1147 ) and precisely @xmath1148 vertices from @xmath149 .",
    "suppose that for some @xmath1019 we have found our desired @xmath3-packings @xmath1149 .",
    "we now construct @xmath1146 .",
    "if @xmath1143 is empty then we set @xmath1150 and then ( @xmath1011)(@xmath1151 ) are vacuously true for @xmath1146 .",
    "so suppose that @xmath1143 is non - empty .",
    "since @xmath1152 , ( @xmath1153 ) implies that there exist non - negative integers @xmath1154 so that @xmath1155 and    * @xmath1143 contains precisely @xmath613 edges with one endpoint in @xmath1122 and the other in @xmath173 ; * @xmath1143 contains precisely @xmath1156 edges with both endpoints in @xmath1122 ; * @xmath1143 contains precisely @xmath1156 edges with both endpoints in @xmath173 .",
    "consider any edge @xmath395 in @xmath1143 with one endpoint @xmath176 and one endpoint @xmath1157 .",
    "since @xmath1132 , ( @xmath1158 ) implies that @xmath56 is @xmath1159-good . in particular , together with ( [ minex1 ] )",
    "this implies that @xmath1160 for all @xmath1161 and @xmath1162 . since @xmath106 is @xmath1163-exceptional , ( [ minex1 ] )",
    "implies that @xmath1164 for all @xmath1161 and @xmath1165 .",
    "it is easy to see that , together with ( [ mingb ] ) , ( @xmath1166 ) and ( @xmath1123 ) , this implies that we can greedily construct a copy @xmath304 of @xmath3 in @xmath0 such that :    * @xmath304 is vertex - disjoint from @xmath1149 and @xmath1167 ; * @xmath304 contains @xmath395 and contains precisely one vertex from each of @xmath1168 and @xmath1169 vertices from @xmath149 .",
    "further , we can repeat this process for all @xmath613 such edges @xmath395 so that the @xmath613 copies of @xmath3 thus obtained are vertex - disjoint .",
    "let @xmath1170 denote the set of these copies of @xmath3 .",
    "so @xmath1170 covers @xmath613 vertices from each @xmath1062 and @xmath1171 vertices from @xmath149 .",
    "next pair off each of the @xmath1156 edges from ( ii ) with a unique edge from ( iii ) .",
    "consider one such pair @xmath1172 of edges .",
    "so the endpoints @xmath1173 of @xmath395 lie in @xmath1122 and the endpoints @xmath1174 of @xmath397 lie in @xmath173 .",
    "suppose that @xmath1175 for some @xmath1176 .",
    "( the other cases are similar . )",
    "since @xmath1173 are @xmath1163-exceptional , ( [ minex1 ] ) implies that @xmath1177 for all @xmath1161 and @xmath1178 @xmath1179 .",
    "it is easy to see that , together with ( [ mingb ] ) , ( @xmath1166 ) and ( @xmath1123 ) , this implies that we can greedily construct a copy @xmath304 of @xmath3 in @xmath0 such that :    * @xmath304 is vertex - disjoint from @xmath1180 and @xmath1181 ; * @xmath304 contains @xmath395 and contains two vertices from @xmath1182 ( namely @xmath56 and @xmath106 ) , no vertices from @xmath173 , one vertex from @xmath1062 ( for @xmath1183 ) and @xmath1169 vertices from @xmath149 .    similarly we can greedily construct a copy @xmath303 of @xmath3 in @xmath0 such that :    * @xmath303 is vertex - disjoint from @xmath1180 , @xmath304 and @xmath1184 ; * @xmath303 contains @xmath397 and contains two vertices from @xmath1185 ( namely @xmath1186 and @xmath1187 ) , no vertices from @xmath1182 , one vertex from @xmath1062 ( for @xmath1183 ) and @xmath1169 vertices from @xmath149 .",
    "so together @xmath304 and @xmath303 cover precisely two vertices from each @xmath1062 and @xmath1188 vertices from @xmath149 .",
    "further , we can repeat this process for all such pairs of edges @xmath1172 so that the @xmath1189 copies of @xmath3 thus obtained are vertex - disjoint .",
    "let @xmath1190 denote the set of these copies of @xmath3 .",
    "then by construction @xmath1190 covers precisely @xmath1189 vertices from each @xmath1062 and @xmath1191 vertices from @xmath149 .",
    "set @xmath1192 .",
    "so @xmath1146 is a @xmath3-packing in @xmath0 . by construction @xmath1146",
    "is vertex - disjoint from @xmath1193 and satisfies ( @xmath1011)(@xmath1151 ) , as desired .    * covering the remaining vertices . *",
    "remove all those vertices covered by @xmath1194 from @xmath0 ( and from the classes @xmath1195 ) .",
    "call the resulting digraph @xmath36 . so @xmath1196 by ( @xmath1011 ) , @xmath1197 for all @xmath1031 and @xmath1198 by ( @xmath1151 ) .",
    "further , ( [ minex1 ] ) and ( @xmath1199)(@xmath1123 ) imply that the following conditions hold :    * @xmath1200 ; * @xmath1110 is a partition of @xmath88 so that @xmath173 is a @xmath1201-independent set of size @xmath256 in @xmath36 ( for all @xmath1031 ) ; * if @xmath1027 then @xmath1202 $ ] does not contain any @xmath1203-independent set of size @xmath256 ; * every vertex in @xmath1204 is @xmath1205-acceptable ( for each @xmath1019 ) ; * there are at most @xmath1115 vertices in @xmath1204 that are not @xmath1116-excellent ( for each @xmath1019 ) .    in particular , note that ( @xmath1206 ) follows since @xmath1146 contains the vertices in @xmath1122 . if @xmath1027 then ( @xmath1207 ) implies that @xmath1208 for all @xmath1209 .",
    "we now split the proof into cases depending on the size of @xmath149 .    * case 1 : @xmath1023 . * in this case @xmath1210 and @xmath1211 is a partition of @xmath88",
    ". then @xmath36 contains a @xmath3-packing @xmath1212 such that :    * @xmath1212 contains at most @xmath1213 copies of @xmath3 ; * if @xmath1214 is not @xmath1215-excellent then @xmath56 is contained in a copy of @xmath3 in @xmath1212 ( for any @xmath1216 ) ; * each copy of @xmath3 in @xmath1212 covers exactly one vertex from @xmath173 ( for each @xmath89 ) .    to see that such a @xmath3-packing @xmath1212 exists ,",
    "suppose that we have found a @xmath3-packing @xmath1217 in @xmath36 that satisfies ( @xmath1218 ) and ( @xmath1219 ) .",
    "suppose that for some @xmath1220 @xmath1036 so that @xmath56 is not @xmath1215-excellent and @xmath56 is not covered by @xmath1217 .",
    "( by ( @xmath1221 ) there are at most @xmath1213 such vertices @xmath56 . ) without loss of generality assume that @xmath1064 . then by ( @xmath1207 ) and ( @xmath1206 ) there",
    "exist @xmath1222 such that :    * @xmath1223 ; * @xmath1224 ; * @xmath1225 for all @xmath1226 such that @xmath1227",
    ".    without loss of generality assume that @xmath1228 and @xmath1229 .",
    "write @xmath1230 where @xmath1231 .",
    "since @xmath1232 , ( @xmath1221 ) implies that there is a vertex @xmath1233 such that @xmath1234 and @xmath1235 is @xmath1116-excellent for all @xmath1236 .",
    "further , since @xmath1237 , the choice of @xmath1235 together with ( @xmath1221 ) ensures that there is a vertex @xmath1238 such that @xmath1239 and @xmath1240 is @xmath1116-excellent for all @xmath1241 .",
    "in particular , @xmath1242 spans a copy of @xmath1243 $ ] in @xmath36 that is vertex - disjoint from @xmath1217 . continuing in this way we obtain vertices",
    "@xmath1244 such that @xmath1245 and @xmath1246 spans a copy of @xmath3 in @xmath36 where @xmath1247 play the roles of @xmath1248 respectively .",
    "this argument shows that we can indeed find a @xmath3-packing @xmath1212 that satisfies ( @xmath1218)(@xmath1219 ) .",
    "remove all those vertices covered by @xmath1212 from @xmath36 ( and from the classes @xmath1249 ) .",
    "call the resulting digraph @xmath39 .",
    "so @xmath1250 by ( @xmath1218 ) and @xmath1251 for all @xmath927 by ( @xmath1219 ) .",
    "further , ( @xmath1252 ) implies that , given any @xmath1253 , @xmath56 is @xmath1254-excellent ( for all @xmath1255 ) .",
    "so theorem  [ rpart2 ] implies that @xmath39 contains a perfect @xmath2-packing and thus a perfect @xmath3-packing @xmath1256 .",
    "set @xmath1257 .",
    "then @xmath201 is a perfect @xmath3-packing in @xmath0 , as required .",
    "* case 2 : @xmath1258 . * in this case @xmath1259 .",
    "given any @xmath1019 , ( @xmath1207 ) and ( @xmath1260 ) imply that there are at least @xmath1261 edges in @xmath36 with one endpoint in @xmath173 and the other endpoint in @xmath149 .",
    "since @xmath1262 , this implies that there are at most @xmath1263 vertices in @xmath173 that are not @xmath1264-excellent .",
    "let @xmath1265 denote the set of all those vertices in @xmath1266 that are not @xmath1267-excellent .",
    "so @xmath1268 .",
    "then @xmath36 contains a @xmath3-packing @xmath1212 such that :    * @xmath1212 contains @xmath1269 copies of @xmath3 ; * if @xmath1214 is not @xmath1270-excellent then @xmath56 is contained in a copy of @xmath3 in @xmath1212 ( for any @xmath1271 ) .",
    "similarly , if @xmath1272 is not @xmath1273-excellent then @xmath56 is contained in a copy of @xmath3 in @xmath1212 ; * @xmath1212 covers exactly @xmath1274 vertices from @xmath173 ( for each @xmath1019 ) and @xmath1275 vertices from @xmath149 .    to prove that such a @xmath3-packing @xmath1212 exists",
    ", we will use the follow three claims .",
    "[ claima ] let @xmath1272 be such that @xmath56 is not @xmath1273-excellent and let @xmath1276 where @xmath1277 .",
    "then there are two vertex - disjoint copies @xmath1278 of @xmath3 in @xmath36 so that :    * @xmath1279 contains two vertices from @xmath173 ( for each @xmath1019 ) and @xmath1188 vertices from @xmath149 ; * @xmath1280 and @xmath1279 is disjoint from @xmath259 .    to prove the claim consider a vertex @xmath1272 that is not @xmath1273-excellent .",
    "if @xmath1281 then @xmath1064 .",
    "further , since @xmath56 is not @xmath1273-excellent , ( @xmath1207 ) implies that    * @xmath1282 or @xmath1283 .    without loss of generality",
    "assume that @xmath1284 .",
    "fix a vertex @xmath106 in @xmath180 such that    * @xmath98 ; * @xmath106 is @xmath1267-excellent ; * @xmath1285 .",
    "note that there are at least @xmath1286 choices for @xmath106 since @xmath1268 and @xmath1287 .",
    "then by repeatedly applying ( [ bboundy ] ) we can greedily extend @xmath29 to a copy @xmath304 of @xmath3 in @xmath36 containing two vertices from @xmath180 ( namely @xmath113 and @xmath106 ) and @xmath1288 vertices from @xmath149 so that @xmath304 is disjoint from @xmath259 .",
    "next suppose that @xmath1289 .",
    "since @xmath56 is not @xmath1273-excellent , ( @xmath1207 ) and ( @xmath1206 ) imply that there exist @xmath1290 such that :    * @xmath1223 ; * @xmath1224 ; * @xmath1225 for all @xmath1291 such that @xmath1227 .    without loss of generality assume that @xmath1064 , @xmath1292 and @xmath1293 ( the other cases are similar ) .",
    "write @xmath1230 where @xmath1231 . since @xmath1294 , @xmath1268 and @xmath1287 , ( @xmath1221 ) implies that there is a vertex @xmath1295 such that",
    ":    * @xmath1234 ; * @xmath1235 is @xmath1116-excellent for all @xmath1296 ; * @xmath1235 is @xmath1264-excellent ; * @xmath1297 .    since @xmath1298 , the choice of @xmath1235 together with ( @xmath1221 ) ensures that there is a vertex @xmath1299 such that :    * @xmath1239 ; * @xmath1240 is @xmath1116-excellent for all @xmath1300 ; * @xmath1240 is @xmath1264-excellent ; * @xmath1301 .",
    "in particular , @xmath1242 spans a copy of @xmath1243 $ ] in @xmath36 . continuing in this fashion and",
    "then repeatedly applying ( [ bboundy ] ) we can greedily find a copy @xmath304 of @xmath3 in @xmath36 that covers two vertices in @xmath180 ( namely @xmath56 and @xmath1235 ) , one vertex from @xmath1062 ( for @xmath1302 ) and @xmath1303 vertices from @xmath149 so that @xmath304 is disjoint from @xmath259 .",
    "so in both cases we have found a copy @xmath304 of @xmath3 in @xmath36 that covers two vertices in @xmath180 ( including @xmath56 ) , one vertex from @xmath1062 ( for @xmath1302 ) and @xmath1303 vertices from @xmath149 .",
    "let @xmath1304 be a subtournament of @xmath3 of size @xmath1305 .",
    "let @xmath696 denote the set of vertices @xmath1306 that are @xmath1307-excellent for all @xmath1308",
    ". then @xmath1309 by ( @xmath1221 ) .",
    "together with  ( [ bboundy ] ) this implies that @xmath1310)\\geq \\left ( 1- \\frac{1}{r - s } -\\alpha",
    "^{1/6}\\right ) |b'|.\\ ] ] moreover , ( @xmath1311 ) implies that @xmath1312 $ ] does not contain any @xmath1313-independent set of size @xmath1314 .",
    "proposition  [ turanstab ] ( with @xmath1312 $ ] , @xmath1315 , @xmath1316 , @xmath1304 , @xmath1305 playing the roles of @xmath0 , @xmath5 , @xmath511 , @xmath3 , @xmath4 respectively ) implies that @xmath1312 $ ] contains a copy @xmath1317 of @xmath1304 .",
    "the choice of @xmath696 ensures that we can greedily extend @xmath1318 to a copy @xmath303 of @xmath3 in @xmath36 that is disjoint from @xmath1319 and that covers no vertices from @xmath180 , one vertex from @xmath1062 ( for @xmath1302 ) and @xmath1305 vertices from @xmath149 .",
    "so together @xmath304 and @xmath303 satisfy ( i ) and ( ii ) .",
    "this completes the proof of claim  [ claima ] .",
    "[ claimb ] let @xmath1320 be such that @xmath56 is not @xmath1046-excellent ( for some @xmath1019 ) and let @xmath1321 where @xmath1277 .",
    "then there are two vertex - disjoint copies @xmath1278 of @xmath3 in @xmath36 so that :    * @xmath1279 contains two vertices from @xmath1062 ( for each @xmath1308 ) and @xmath1188 vertices from @xmath149 ; * @xmath1280 and @xmath1279 is disjoint from @xmath259 .",
    "the proof of claim  [ claimb ] is essentially identical to the proof of claim  [ claima ] , so we omit it .    [ claimc ] let @xmath1322 be such that @xmath56 is not @xmath1046-excellent ( for some @xmath1019 ) and let @xmath1321 where @xmath1277 .",
    "then there is a copy @xmath304 of @xmath3 in @xmath36 so that :    * @xmath1323 contains one vertex from @xmath1062 ( for each @xmath1308 ) and @xmath1169 vertices from @xmath149 ; * @xmath1324 and @xmath1323 is disjoint from @xmath259 .",
    "it is easy to see that ( @xmath1207 ) , ( @xmath1206 ) and ( [ bboundy ] ) imply that we can greedily construct a copy @xmath304 of @xmath3 as in claim  [ claimc ] .",
    "recall that @xmath1268 .",
    "together with ( @xmath1221 ) this implies that we can repeatedly apply claims  [ claima][claimc ] to obtain a @xmath3-packing @xmath1212 in @xmath36 satisfying ( @xmath1325)(@xmath1326 ) .",
    "remove all those vertices covered by @xmath1212 from @xmath36 ( and from the classes @xmath1195 ) .",
    "call the resulting digraph @xmath39 .",
    "so @xmath1327 by ( @xmath1328 ) and @xmath1251 for all @xmath1031 and @xmath1329 by ( @xmath1326 ) .",
    "further , ( @xmath1330 ) implies that , given any @xmath1253 , @xmath56 is @xmath1331-excellent ( for all @xmath1332 ) and every vertex @xmath1333 is @xmath1334-excellent .",
    "suppose that @xmath1335 .",
    "then as in case  1 , theorem  [ rpart2 ] implies that @xmath39 contains a perfect @xmath2-packing and thus a perfect @xmath3-packing @xmath1256 .",
    "set @xmath1336 .",
    "then @xmath201 is a perfect @xmath3-packing in @xmath0 , as required .",
    "next suppose that @xmath1337 .",
    "let @xmath1304 be a subtournament of @xmath3 on @xmath1169 vertices such that @xmath1338 .",
    "( note that if @xmath1339 then @xmath598 .",
    "every tournament on at least four vertices contains @xmath78 , so we indeed may choose @xmath1338 . ) by ( [ bboundy ] ) and ( @xmath1340 ) we have that @xmath1341 ) \\geq ( 1 - 1/(r - s ) -\\alpha ^{1/5 } ) |b|.\\ ] ] moreover , ( @xmath1311 ) implies that @xmath1342 $ ] does not contain any @xmath1313-independent set of size @xmath1343 .",
    "further , if @xmath1344 ( and so @xmath1121 ) then by assumption @xmath1342 $ ] is not @xmath1345-close to @xmath1346 .",
    "thus , by theorem  [ 1nonex ] and proposition  [ matchstab2 ] , @xmath1342 $ ] contains a perfect @xmath1304-packing @xmath1217 .",
    "define an auxiliary digraph @xmath1347 from @xmath39 as follows .",
    "@xmath1347 has vertex set @xmath1348 where @xmath1349 and each vertex @xmath1350 corresponds to a unique copy @xmath1351 of @xmath1304 from @xmath1217 .",
    "the edge set of @xmath1347 consists of every edge @xmath1352 such that @xmath1353 and @xmath1354 for some @xmath1355 together with the following edges : suppose that @xmath1356 and @xmath1357 .",
    "then    * @xmath1358 precisely if @xmath106 sends an edge to every vertex in @xmath1351 in @xmath39 ; * @xmath1359 precisely if @xmath106 receives an edge from every vertex in @xmath1351 in @xmath39 .",
    "note that @xmath1347 is an @xmath380-partite digraph with vertex classes of size @xmath1360 .",
    "further , @xmath1361 so by theorem  [ rpart2 ] , @xmath1347 contains a perfect @xmath1362-packing . by construction of @xmath1347",
    "this implies that @xmath39 contains a perfect @xmath3-packing @xmath1256 .",
    "set @xmath1336 .",
    "then @xmath201 is a perfect @xmath3-packing in @xmath0 , as required .      in this subsection",
    "we consider the case when @xmath1364 and @xmath1021 $ ] is @xmath889-close to @xmath1119 .",
    "thus , there exists a partition @xmath1365 of @xmath149 such that @xmath1366 and @xmath1367 .",
    "( [ mingb ] ) implies that @xmath1368)\\geq |b|/2=n / r$ ] .    for @xmath1106 and @xmath1030",
    "we say that a vertex @xmath1369 is _ @xmath1370-excellent _ if @xmath1371 .",
    "( later on we will modify the classes @xmath1365 . when referring to , for example , @xmath1372-excellent vertices , we mean with respect to the current class @xmath1373 and not the original class . ) note that there are at most @xmath1374 vertices @xmath1369 that are not @xmath1375-excellent for @xmath1106 .",
    "let @xmath1376 denote the set of vertices @xmath1377 that are not @xmath1378-excellent .",
    "define @xmath1379 analogously . given a vertex @xmath1380 , if @xmath1381 then move @xmath56 into @xmath1382 .",
    "similarly , if @xmath1383 and @xmath1384 then move @xmath56 into @xmath1373 . thus , the following conditions hold :    * @xmath1385 ; * @xmath1386 ; * there are at most @xmath1387 vertices @xmath1369 that are not @xmath1388-excellent ( for @xmath1106 ) ; * given any @xmath1369 , @xmath1389 ( for @xmath1106 ) .",
    "actually , there is slack in conditions ( @xmath1390 ) and ( @xmath1391 ) . indeed ,",
    "if we move a single vertex from @xmath1382 to @xmath1373 ( or vice versa ) then ( @xmath1390 ) and ( @xmath1391 ) still hold .",
    "since @xmath1364 is even , either @xmath1392 and @xmath1393 are even or @xmath1392 and @xmath1393 are odd .",
    "suppose that @xmath1392 and @xmath1393 are odd",
    ". without loss of generality assume that @xmath1394 .",
    "fix a vertex @xmath1395 such that    * @xmath757 is @xmath1396-excellent for all @xmath1019 .",
    "( such a vertex @xmath757 exists by ( @xmath1123 ) . )",
    "then by ( [ minex1 ] ) there is a vertex @xmath1397 such that @xmath1398 .",
    "further , ( [ minex1 ] ) implies that    * @xmath1399 for all @xmath1019 or ; * @xmath1400 or @xmath1401 .",
    "if ( iii ) holds then move @xmath765 into @xmath1373 .",
    "otherwise , we leave the partition @xmath1402 of @xmath149 unchanged .",
    "thus , the following conditions hold :    * @xmath1385 ; * @xmath1386 ; * there are at most @xmath1403 vertices @xmath1369 that are not @xmath1404-excellent ( for @xmath1106 ) ; * given any @xmath1369 , @xmath1405 or @xmath1406 ( for @xmath1106 ) .",
    "additionally , one of the following conditions holds :    * @xmath1392 and @xmath1393 are even or ; * @xmath1392 and @xmath1393 are odd .",
    "further , there exist @xmath1395 and @xmath1397 such that * * @xmath1398 ; * * @xmath757 is @xmath1396-excellent for all @xmath1019 ; * * @xmath1399 for all @xmath1019 .",
    "if ( @xmath1407 ) holds then we will extend the edge @xmath1408 into a copy of @xmath3 in @xmath0 .",
    "first though we will cover the ` exceptional vertices ' in @xmath0 with @xmath3-packings .",
    "* covering the exceptional vertices with @xmath3-packings .",
    "* given any @xmath1019 , let @xmath1122 denote the set of @xmath1114-exceptional vertices in @xmath1048 .",
    "( note that if ( @xmath1407 ) holds then @xmath1409 . )",
    "( @xmath1123 ) implies that @xmath1124 for all @xmath1019 . then there",
    "exist vertex - disjoint @xmath3-packings @xmath1145 in @xmath0 so that , for each @xmath1019 :    * @xmath1146 contains precisely @xmath614 disjoint copies of @xmath3 ; * each vertex from @xmath1122 lies in a copy of @xmath3 in @xmath1146 ; * @xmath1146 covers precisely @xmath614 vertices from @xmath1062 ( for each @xmath1147 ) and precisely @xmath1410 vertices from @xmath149 ; * @xmath1146 covers an even number of vertices from @xmath1373 and an even number of vertices from @xmath1382 ; * if ( @xmath1407 ) holds then @xmath1146 does not cover @xmath757 or @xmath765 .",
    "note that the same argument used to construct @xmath1145 in section  [ firstcase ] shows that we can construct @xmath1145 here so that ( @xmath1411)(@xmath1412 ) hold .",
    "it is not difficult to see that we can additionally ensure that ( @xmath1413 ) and ( @xmath1414 ) hold .    * extending the edge @xmath1408 to a copy of @xmath3 . *",
    "if @xmath1392 and @xmath1393 are even set @xmath1415 . otherwise , ( @xmath1407 ) holds . in this case",
    ", we can greedily construct a copy @xmath304 of @xmath3 in @xmath0 such that :    * @xmath304 is vertex - disjoint from @xmath1145 ; * @xmath304 contains @xmath1408 ( and so one vertex from each of @xmath1373 and @xmath1382 ) and precisely one vertex from each of @xmath1416 .",
    "set @xmath1417 .    * covering the remaining vertices .",
    "* remove all those vertices covered by @xmath1418 from @xmath0 ( and from the classes @xmath1195 and from @xmath1365 ) .",
    "call the resulting digraph @xmath36 .",
    "so @xmath1419 by ( @xmath1411 ) , @xmath1197 for all @xmath1031 and @xmath1420 by ( @xmath1412 ) and the choice of @xmath1421 .",
    "further , ( [ minex1 ] ) and ( @xmath1199)(@xmath1123 ) imply that the following conditions hold :    * @xmath1422 ; * @xmath1110 is a partition of @xmath88 so that @xmath173 is a @xmath1201-independent set of size @xmath256 in @xmath36 ( for all @xmath1031 ) ; * every vertex in @xmath1204 is @xmath1205-acceptable ( for each @xmath1019 ) ; * there are at most @xmath1115 vertices in @xmath1204 that are not @xmath1116-excellent ( for each @xmath1019 ) .    in particular , note that ( @xmath1423 ) follows from ( @xmath1424 ) .",
    "further , ( @xmath1425)(@xmath1407 ) and ( @xmath1411)(@xmath1414 ) together with the choice of @xmath1421 implies that :    * @xmath1426 and @xmath1392 and @xmath1393 are even ; * there are at most @xmath1427 vertices @xmath1369 that are not @xmath1404-excellent ( for @xmath1106 ) ; * given any @xmath1369 , @xmath1428 or @xmath1429 ( for @xmath1106 ) .",
    "note that ( @xmath1430 ) implies that @xmath1431 for all @xmath1209 .",
    "let @xmath1265 denote the set of all those vertices in @xmath1266 that are not @xmath1267-excellent . by arguing as in case  2 from section  [ firstcase ] we see that @xmath1268 .",
    "@xmath36 contains a @xmath3-packing @xmath1212 such that :    * @xmath1212 contains @xmath1269 copies of @xmath3 ; * if @xmath1214 is not @xmath1270-excellent then @xmath56 is contained in a copy of @xmath3 in @xmath1212 ( for any @xmath1271 ) .",
    "similarly , if @xmath1272 is not @xmath1273-excellent then @xmath56 is contained in a copy of @xmath3 in @xmath1212 ; * @xmath1212 covers exactly @xmath1274 vertices from @xmath173 ( for each @xmath1019 ) and @xmath1432 vertices from @xmath149 .",
    "further , @xmath1212 covers an even number of vertices from @xmath1373 and an even number of vertices from @xmath1382 .    to prove that such a @xmath3-packing @xmath1212 exists",
    ", we will use the follow three claims .",
    "[ claima1 ] let @xmath1272 be such that @xmath56 is not @xmath1273-excellent and let @xmath1321 where @xmath1277 .",
    "then there are two vertex - disjoint copies @xmath1278 of @xmath3 in @xmath36 so that :    * @xmath1279 contains two vertices from @xmath173 ( for each @xmath1019 ) and four vertices from @xmath149 ; * @xmath1280 and @xmath1279 is disjoint from @xmath259 .",
    "* @xmath1279 contains an even number of vertices from @xmath1373 and an even number of vertices from @xmath1382 .    to prove the claim consider a vertex @xmath1272 that is not @xmath1273-excellent . without loss of generality",
    "suppose that @xmath1064 . by arguing precisely as in claim  [ claima ] one can find",
    "a copy @xmath304 of @xmath3 in @xmath36 that covers two vertices in @xmath180 ( including @xmath56 ) , one vertex from @xmath173 ( for @xmath1296 ) and one vertex from @xmath149 so that @xmath304 is disjoint from @xmath259 .    without loss of generality suppose that @xmath304 covers a vertex from @xmath1373 . then by applying ( @xmath1433 ) and ( @xmath1434 )",
    "it is easy to see that we can greedily construct a copy @xmath303 of @xmath3 so that @xmath303 covers three vertices from @xmath1373 , no vertices from @xmath180 and one vertex from @xmath1062 ( for all @xmath1302 ) and so that @xmath303 is disjoint from @xmath1435 .",
    "together @xmath304 and @xmath303 satisfy ( i)(iii ) .",
    "this completes the proof of claim  [ claima1 ] .",
    "[ claimb1 ] let @xmath1320 be such that @xmath56 is not @xmath1046-excellent ( for some @xmath1019 ) and let @xmath1321 where @xmath1277 .",
    "then there are two vertex - disjoint copies @xmath1278 of @xmath3 in @xmath36 so that :    * @xmath1279 contains two vertices from @xmath173 ( for each @xmath1019 ) and four vertices from @xmath149 ; * @xmath1280 and @xmath1279 is disjoint from @xmath259 .",
    "* @xmath1279 contains an even number of vertices from @xmath1373 and an even number of vertices from @xmath1382 .",
    "the proof of claim  [ claimb1 ] is essentially identical to the proof of claim  [ claima1 ] , so we omit it .    [ claimc1 ] let @xmath1322 be such that @xmath56 is not @xmath1046-excellent ( for some @xmath1019 ) and let @xmath1321 where @xmath1277 .",
    "then there is a copy @xmath304 of @xmath3 in @xmath36 so that :    * @xmath1323 contains one vertex from @xmath1062 ( for each @xmath1308 ) and two vertices from either @xmath1373 or @xmath1382 ; * @xmath1324 and @xmath1323 is disjoint from @xmath259 .",
    "it is easy to see that ( @xmath1436 ) , ( @xmath1423 ) and ( @xmath1434 ) imply that we can greedily construct a copy @xmath304 of @xmath3 as in claim  [ claimc1 ] .    recall that @xmath1268 .",
    "together with ( @xmath1434 ) this implies that we can repeatedly apply claims  [ claima1][claimc1 ] to obtain a @xmath3-packing @xmath1212 in @xmath36 satisfying ( @xmath1437)(@xmath1438 ) .",
    "remove all those vertices covered by @xmath1212 from @xmath36 ( and from the classes @xmath1195 and from @xmath1373 and @xmath1382 ) .",
    "call the resulting digraph @xmath39 .",
    "so @xmath1327 by ( @xmath1439 ) and @xmath1251 for all @xmath1031 and @xmath1344 by ( @xmath1438 ) .",
    "( @xmath1440 ) implies that , given any @xmath1253 , @xmath56 is @xmath1331-excellent ( for all @xmath1332 ) and every vertex @xmath1333 is @xmath1334-excellent .",
    "moreover , ( @xmath1441 ) and ( @xmath1438 ) imply that @xmath1392 and @xmath1393 are even .",
    "( @xmath1442)(@xmath1443 ) and ( @xmath1437 ) imply that    * @xmath1444 ; * there are at most @xmath1445 vertices @xmath1369 that are not @xmath1404-excellent ( for @xmath1106 ) ; * given any @xmath1369 , @xmath1446 or @xmath1447 ( for @xmath1106 ) .",
    "it is easy to see that this implies that @xmath1342 $ ] contains a perfect matching @xmath1448 .",
    "define an auxiliary digraph @xmath1347 from @xmath39 as follows .",
    "@xmath1347 has vertex set @xmath1348 where @xmath1349 and each vertex @xmath1350 corresponds to a unique edge @xmath1449 from @xmath1448 .",
    "the edge set of @xmath1347 consists of every edge @xmath1352 such that @xmath1353 and @xmath1354 for some @xmath1355 together with the following edges : suppose that @xmath1356 and @xmath1357 .",
    "then    * @xmath1358 precisely if @xmath106 sends an edge to both vertices on @xmath1449 in @xmath39 ; * @xmath1359 precisely if @xmath106 receives an edge from both vertices on @xmath1449 in @xmath39 .",
    "note that @xmath1347 is an @xmath82-partite digraph with vertex classes of size @xmath1360 .",
    "further , @xmath1450 so by theorem  [ rpart2 ] , @xmath1347 contains a perfect @xmath1451-packing . by construction of @xmath1347",
    "this implies that @xmath39 contains a perfect @xmath3-packing @xmath1256 .",
    "set @xmath1452 .",
    "then @xmath201 is a perfect @xmath3-packing in @xmath0 , as required .",
    "let @xmath1453 .",
    "suppose that @xmath0 is as in the statement of the lemma and let @xmath1454 denote the partition of @xmath107 corresponding to the vertex classes of @xmath80 .",
    "given any @xmath1455 , any @xmath1456 and any @xmath1030 , we say that @xmath56 is _ externally @xmath1457-excellent _ if @xmath56 sends out at least @xmath1458 edges to @xmath1459 in @xmath0 and receives at least @xmath1460 edges from @xmath1461 in @xmath0 .",
    "( here indices are taken mod @xmath8 . )",
    "otherwise we say that @xmath56 is _ externally @xmath1457-bad_. since @xmath0 @xmath229-contains @xmath80 and @xmath1462 , there are at most @xmath1463 vertices in @xmath0 that are externally @xmath141-bad .",
    "we also require analogous definitions corresponding to edges inside our vertex classes .",
    "indeed , given any @xmath1455 , any @xmath1456 and any @xmath1030 , we say that @xmath56 is _ internally @xmath1457-excellent _ if @xmath56 sends out at least @xmath1464 edges in @xmath1465 $ ] and receives at least @xmath1464 edges in @xmath1465 $ ] .",
    "otherwise we say that @xmath56 is _ internally @xmath1457-bad_. since @xmath0 @xmath229-contains @xmath80 and @xmath1466 , there are at most @xmath1463 vertices in @xmath0 that are internally @xmath1467-bad . throughout the proof we will modify the classes @xmath180 , @xmath181 and @xmath168 .",
    "when referring to , for example , internally excellent vertices , we mean with respect to the current classes @xmath180 , @xmath181 and @xmath168 rather than the original partition of @xmath107 .    since @xmath247 , given any vertex @xmath47 there is an @xmath1468 such that @xmath56 sends out at least @xmath1469 edges to @xmath1470 in @xmath0 and receives at least @xmath1469 edges from @xmath1470 in @xmath0 .",
    "for each vertex @xmath47 that is internally @xmath1467-bad we move @xmath56 into the class @xmath1470 .",
    "thus , we now have that :    * @xmath1471 for each @xmath1455 ; * @xmath1472 ) \\geq n/20 $ ] for each @xmath1455 ; * all but at most @xmath1473 vertices in @xmath0 are internally @xmath1474-excellent ; * all but at most @xmath1475 vertices in @xmath0 are externally @xmath1476-excellent .",
    "actually there is some slack in these conditions .",
    "indeed , ( a)(d ) hold even if we remove three vertices from @xmath0 ( and thus from @xmath180 , @xmath181 and @xmath168 ) .",
    "* changing the parity of the class sizes . * our next task is to remove ( the vertices of ) at most one copy of @xmath41 from @xmath0 to ensure that @xmath1477 ( mod @xmath8 ) . if @xmath1478 ( mod @xmath8 ) already then we do not remove a copy of @xmath41 . recall that @xmath1479 ( mod @xmath8 ) .",
    "therefore , without loss of generality we may assume that @xmath1480 , @xmath1481 and @xmath1482 ( mod @xmath8 ) .",
    "( the other cases follow analogously . )    in this case there exists a @xmath1483 such that @xmath1484 .",
    "suppose that @xmath1485 .",
    "fix some @xmath1486 that is externally @xmath1487-excellent .",
    "( such a vertex exists by ( a ) and ( d ) . ) since @xmath1488 there exists a vertex @xmath1489 such that @xmath1490 .",
    "further , since @xmath308 is externally @xmath1487-excellent and @xmath1491}(b ) \\geq n/20 $ ] by ( b ) , there is a vertex @xmath1492 such that @xmath1493 .",
    "thus , @xmath308 , @xmath313 and @xmath163 together span a copy @xmath203 of @xmath41 in @xmath0 .",
    "remove @xmath217 from @xmath0 ( and thus from @xmath180 and @xmath181 ) .",
    "so now @xmath1494 ( mod @xmath8 ) .",
    "in all other cases , we can similarly remove three vertices from @xmath0 that span a copy @xmath203 of @xmath41 so that @xmath1477 ( mod @xmath8 )",
    ". as outlined earlier , ( a)(d ) still hold .    * covering the externally bad vertices and balancing the class sizes . * ( b)(d ) ensure that we can greedily construct a collection @xmath1495 of at most @xmath1496 vertex - disjoint copies of @xmath41 in @xmath0 that together cover all those vertices in @xmath0 that are externally @xmath1487-bad .",
    "in particular , ( b ) and ( c ) ensure that we can choose each such copy of @xmath41 to lie in one of @xmath1497 $ ] , @xmath1498 $ ] and @xmath1499 $ ] . so after removing the vertices in @xmath1495 from @xmath0 we still have that @xmath1477 ( mod @xmath8 ) .",
    "further , @xmath1500 for each @xmath1455 .",
    "these last two properties together with ( b ) and ( c ) ensure that we can greedily construct a collection @xmath1501 of at most @xmath1502 vertex - disjoint copies of @xmath41 in @xmath0 such that :    * the copies of @xmath41 in @xmath1503 are vertex - disjoint from the copies of @xmath41 in @xmath1495 ; * each copy of @xmath41 in @xmath1501 lies in one of @xmath1497 $ ] , @xmath1498 $ ] and @xmath1499 $ ] .",
    "* by removing the vertices in @xmath1504 from @xmath0 we have that @xmath1505 .",
    "* covering the remaining vertices .",
    "* remove the vertices in @xmath1504 from @xmath0 ( and thus from @xmath180 , @xmath181 and @xmath168 ) .",
    "the choice of @xmath1495 ensures that every vertex now in @xmath0 is externally @xmath974-excellent and the choice of @xmath1501 ensures that now @xmath1505 .",
    "let @xmath1506 \\cup g[a_2,a_3]\\cup g[a_3,a_1]$ ] . by ignoring the orientations of the edges in @xmath36 , we can ( for example ) apply theorem  [ rpart ] to find a perfect @xmath41-packing @xmath1507 in @xmath36 .",
    "( indeed , the underlying graph of @xmath36 satisfies the minimum degree condition in theorem  [ rpart ] since every vertex in @xmath88 is externally @xmath974-excellent . ) the union of @xmath1495 , @xmath1501 , @xmath1507 and @xmath203 ( if it exists ) is a perfect @xmath41-packing in @xmath0 , as desired .",
    "in this section we raise a number of open questions concerning perfect packings in digraphs .      in  @xcite , czygrinow , debiasio , kierstead and molla proved the following minimum degree result for perfect transitive tournament packings .",
    "[ cdthm2 ] let @xmath35 such that @xmath4 divides @xmath5 .",
    "then every digraph @xmath0 on @xmath5 vertices with @xmath1508 contains a perfect @xmath45-packing .",
    "note that conjecture  [ conj2 ] would imply theorem  [ cdthm2 ] . at first sight",
    "one may ask whether @xmath45 can be replaced by _ any _ @xmath32 in theorem  [ cdthm2 ] .",
    "however , the following result of wang  @xcite shows that one requires a significantly larger minimum degree condition in the case when @xmath42 .",
    "[ wang1 ] let @xmath1509 such that @xmath8 divides @xmath5 .",
    "if @xmath0 is a digraph on @xmath5 vertices and @xmath1510 then @xmath0 contains a perfect @xmath41-packing .",
    "moreover , if @xmath71 is odd , then there is a digraph @xmath36 on @xmath5 vertices with @xmath1511 which does not contain a perfect @xmath41-packing .",
    "together with zhang  @xcite , wang also characterised the minimum degree threshold that ensures a digraph contains a perfect @xmath1512-packing .",
    "( here @xmath1512 denotes the directed cycle on four vertices . ) czygrinow , kierstead and molla  @xcite showed that the degree condition in theorem  [ wang1 ] can be relaxed to @xmath1513 if we instead seek a perfect packing consisting of a fixed number of cyclic triangles and at least one transitive triangle .    in light of theorems  [ cdthm2 ] and  [ wang1 ]",
    "we ask the following question .",
    "[ ques1 ] let @xmath1514 such that @xmath4 divides @xmath5 .",
    "let @xmath1515 .",
    "does every digraph @xmath0 on @xmath5 vertices with @xmath1516 contain a perfect @xmath3-packing ?",
    "czygrinow , debiasio , kierstead and molla  @xcite have answered question  [ ques1 ] in the affirmative under the additional assumptions that @xmath4 is sufficiently large and @xmath1517 .",
    "it is also natural to seek minimum degree conditions which ensure a digraph contains a perfect @xmath1-packing where @xmath1 is some digraph other than a tournament .",
    "let @xmath2 denote the complete digraph on @xmath4 vertices , and write @xmath1518 to denote @xmath2 minus an edge .",
    "( in the undirected setting we also use @xmath2 to denote the complete graph on @xmath4 vertices . )",
    "the following result is a simple consequence of the hajnal  szemerdi theorem .",
    "[ simple ] let @xmath1519 such that @xmath4 divides @xmath5 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices such that @xmath1520 then @xmath0 contains a perfect @xmath2-packing .",
    "let @xmath36 denote the _ graph _ on @xmath107 whose edge set consists of all those pairs @xmath29 such that both @xmath1521 .",
    "since @xmath1522 we have that @xmath1523 . thus , theorem  [ hs ] implies that @xmath36 contains a perfect @xmath2-packing . by definition of @xmath36",
    "this implies that @xmath0 contains a perfect @xmath2-packing .",
    "note that the minimum degree condition in proposition  [ simple ] is best - possible : let @xmath54 such that @xmath4 divides @xmath5 .",
    "suppose @xmath148 and @xmath149 are disjoint vertex sets where @xmath1524 and @xmath1525 .",
    "let @xmath69 be the digraph with vertex set @xmath1526 such that @xmath69 contains all possible edges between @xmath148 and @xmath149 , all edges in @xmath149 and so that @xmath148 induces a tournament .",
    "then @xmath1527 and @xmath0 does not contain a perfect @xmath2-packing since every copy of @xmath2 in @xmath69 contains at most one vertex from @xmath148 .",
    "proposition  [ simple ] implies that a digraph @xmath0 whose order @xmath5 is divisible by @xmath4 and with @xmath1528 contains a perfect @xmath2-packing .",
    "further , in the digraph @xmath69 above , set @xmath44 to be even and @xmath1529 $ ] to be a regular tournament .",
    "then @xmath69 does not contain a perfect @xmath2-packing but @xmath1530 .",
    "thus , together with theorem  [ mainthm ] , this shows that the minimum semidegree threshold that forces a perfect @xmath2-packing is much higher than the threshold that forces a perfect @xmath3-packing for any tournament @xmath3 on @xmath4 vertices",
    ". it would be interesting to establish the minimum semidegree threshold that forces a perfect @xmath1531-packing in a digraph .",
    "in particular , is this threshold significantly lower than the corresponding threshold for perfect @xmath1532-packings",
    "?    let @xmath194 be divisible by @xmath1533 and set @xmath1534 .",
    "suppose that @xmath0 is a digraph on @xmath5 vertices with the following properties : @xmath1535 where @xmath1536 and @xmath1537 ; @xmath1538 $ ] and @xmath1539 $ ] are complete digraphs ; the edges between @xmath1540 and @xmath1541 in @xmath0 form a bipartite tournament that is as regular as possible .",
    "note that , since @xmath1542 and @xmath1543 are not divisible by @xmath8 , @xmath0 does not contain a perfect @xmath729-packing .",
    "further , @xmath1544 .",
    "[ quesz ] let @xmath1509 be divisible by @xmath8 .",
    "does every digraph @xmath0 on @xmath5 vertices with @xmath1545 contain a perfect @xmath729-packing ?",
    "the author is very grateful to reshma ramadurai for many helpful discussions , to richard mycroft for a discussion on  @xcite and to daniela khn , deryk osthus and katherine staden for their comments on the manuscript .",
    "the author is also grateful to the two referees for quick and helpful reviews . in particular",
    ", the comments of one reviewer helped to significantly improve the presentation of the paper .",
    "a. czygrinow , l. debiasio , h.a .",
    "kierstead and t. molla , an extension of the hajnal  szemerdi theorem to directed graphs , _ combin .",
    "_ , to appear .",
    "a. czygrinow , h.a .",
    "kierstead and t. molla , on directed versions of the corrdi  hajnal corollary , _",
    "european j. combin . _  * 42 * ( 2014 ) , 114 .",
    "e. fischer , variants of the hajnal  szemerdi theorem , _ j. graph theory _",
    "* 31 * ( 1999 ) , 275282 .",
    "j. fox , a new proof of the graph removal lemma , _ ann . of math . _ * 174 * ( 2011 ) , 561579 .",
    "a. hajnal and e.  szemerdi , proof of a conjecture of erds , _ combinatorial theory and its applications vol .",
    "* 4 * ( 1970 ) , 601623 .",
    "p. hell and d.g .",
    "kirkpatrick , on the complexity of general graph factor problems , _ siam j. computing _",
    "* 12 * ( 1983 ) , 601609 .",
    "s. janson , t. uczak  and  a. ruciski , _ random graphs _ , wiley , 2000 .",
    "p. keevash and r. mycroft , a geometric theory for hypergraph matching , _ mem .",
    "* 233 * ( 2014 ) , monograph 1098 .",
    "p. keevash and r. mycroft , a multipartite hajnal ",
    "szemerdi theorem , submitted .",
    "p. keevash and b. sudakov , triangle packings and 1-factors in oriented graphs , _",
    "j. combin .",
    "theory  b _  * 99 * ( 2009 ) , 709727 . h.a .",
    "kierstead and a.v .",
    "kostochka , an ore - type theorem on equitable coloring ,",
    "_ j. combin .",
    "theory b _  * 98 * ( 2008 ) , 226234 .",
    "j. komls , g.n .",
    "srkzy and e. szemerdi , proof of the seymour conjecture for large graphs , _ annals of combinatorics _  * 2 * ( 1998 ) , 4360 .",
    "d. khn and d. osthus , critical chromatic number and the complexity of perfect packings in graphs , _",
    "17th acm - siam symposium on discrete algorithms _",
    "( soda 2006 ) , 851859 .",
    "d. khn and d. osthus , the minimum degree threshold for perfect graph packings , _ combinatorica _  * 29 * ( 2009 ) , 65107 .",
    "d. khn , d. osthus and a. treglown , an ore - type theorem for perfect packings in graphs , _ siam j. disc .",
    "_  * 23 * ( 2009 ) , 13351355 .",
    "a. lo and k. markstrm , minimum codegree threshold for @xmath1546-factors , _",
    "j. combin .",
    "theory a _ * 120 * ( 2013 ) , 708721 .",
    "a. lo and k. markstrm , @xmath866-factors in hypergraphs via absorption , _ graphs combin .",
    "_ , to appear .",
    "v. rdl , a. ruciski and e. szemerdi , a dirac - type theorem for 3-uniform hypergraphs , _ combin .",
    "comput . _  * 15 * ( 2006 ) , 229251 .",
    "v. rdl , a. ruciski and e. szemerdi , perfect matchings in large uniform hypergraphs with large minimum collective degree ,",
    "_ j. combin .",
    "theory ser .",
    "a _  * 116 * ( 2009 ) , 613636 .",
    "a. treglown , a note on some oriented graph embedding problems , _",
    "j. graph theory _",
    "* 69 * ( 2012 ) , 330336 .",
    "a. treglown , a degree sequence hajnal ",
    "szemerdi theorem , submitted .",
    "a. treglown and y. zhao , exact minimum degree thresholds for perfect matchings in uniform hypergraphs , _",
    "j. combin .",
    "theory a _ 119 ( 2012 ) , 15001522 .",
    "h. wang , independent directed triangles in a directed graph , _ graphs combin . _  * 16 * ( 2000 ) , 453462 .",
    "h. wang and d. zhang , disjoint directed quadrilaterals in a directed graph , _ j. graph theory _  * 50 * ( 2005 ) , 91104 ."
  ],
  "abstract_text": [
    "<S> we say that a ( di)graph @xmath0 has a perfect @xmath1-packing if there exists a set of vertex - disjoint copies of @xmath1 which cover all the vertices in @xmath0 . the seminal hajnal  </S>",
    "<S> szemerdi theorem characterises the minimum degree that ensures a graph @xmath0 contains a perfect @xmath2-packing . in this paper </S>",
    "<S> we prove the following analogue for directed graphs : suppose that @xmath3 is a tournament on @xmath4 vertices and @xmath0 is a digraph of sufficiently large order @xmath5 where @xmath4 divides @xmath5 . </S>",
    "<S> if @xmath0 has minimum in- and outdegree at least @xmath6 then @xmath0 contains a perfect @xmath3-packing .    in the case when @xmath3 is a cyclic triangle , this result verifies a recent conjecture of czygrinow , kierstead and molla  @xcite ( for large digraphs ) . </S>",
    "<S> furthermore , in the case when @xmath3 is transitive we conjecture that it suffices for every vertex in @xmath0 to have sufficiently large indegree or outdegree . </S>",
    "<S> we prove this conjecture for transitive triangles and asymptotically for all @xmath7 . </S>",
    "<S> our approach makes use of a result of keevash and mycroft  @xcite concerning almost perfect matchings in hypergraphs as well as the directed graph removal lemma @xcite .        </S>",
    "<S> [ firstpage ]    msc2000 : 5c35 , 5c20 , 5c70 . </S>"
  ]
}