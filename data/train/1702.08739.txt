{
  "article_text": [
    "we say that a @xmath1-polytope @xmath9 is _ reconstructible _ from its @xmath10-skeleton if the restriction of its face lattice to the faces of dimension at most @xmath10 already determines the entire face lattice of @xmath9 .",
    "it easily follows from a generalisation of jordan s separation theorem - sphere which is a homeomorphic image of the @xmath11-sphere divides the @xmath1-sphere into two connected components . ]",
    "that any @xmath1-polytope is reconstructible from its @xmath12-skeleton  ( * ? ? ?",
    "this is tight : for any @xmath13 perles found @xmath1-polytopes which are not combinatorially isomorphic but have isomorphic @xmath7-skeleton  ( * ? ? ?",
    "12.3 ) . call a vertex in a @xmath1-polytope _ nonsimple _ if the number of edges incident to it is @xmath2 .",
    "note that the @xmath1-bipyramid and the pyramid over the @xmath11-bipyramid form an example of such pair with exactly @xmath1 nonsimple vertices in each .",
    "the two polytopes in [ fig : nonrecontructible ] correspond to the case @xmath14 .     is highlighted . ]    for @xmath15 ,",
    "let @xmath16 denote the maximum number @xmath17 such that any @xmath1-polytope with at most @xmath17 nonsimple vertices is reconstructible from its @xmath10-skeleton .",
    "the result of blind and mani  @xcite , later proved through a brilliant argument by kalai  @xcite , asserts @xmath18 .",
    "combined with the above example , the following is known for @xmath13 : @xmath19    we obtain the following result .    for any @xmath13 ,    \\(1 ) @xmath20 , and    \\(2 ) @xmath21 , in particular @xmath22 .",
    "further , for any fixed @xmath1 in the above theorem , with exception of the reconstruction from the 1-skeleton of a polytope @xmath9 with two nonsimple vertices , the reconstruction of the face lattice of the relevant polytopes can be done in polynomial time in the number of vertices .",
    "the proof of @xmath23 , based on kaibel s  ( * ? ? ? * prop .  1 ) , is given in [ sec:2-skel ] .",
    "the proof of @xmath24 is based on a restriction of kalai s good acyclic orientations  @xcite to a subfamily with certain desired properties , whose existence in turn relies on the flexibility of bruggesser - mani line shellings ; see [ sec:1-skel ] , and in particular , [ lem : shellingorders ] and [ cor : orientation - f - initial ] .",
    "the results on polynomial complexity follow friedman  @xcite .",
    "pairs of polytopes with @xmath6 nonsimple vertices showing @xmath25 are given in [ sec : construction ] ; these are constructed by induction on the dimension and include the pair in [ fig : nonrecontructible-3nonsimple ] , found in the database by miyata - moriyama - fukuda  @xcite .",
    "realizations of these polytopes are provided via a ` polymake ` program , available online at @xcite under the name of the paper ; our program takes as input a dimension @xmath1 .",
    "very recently , doolittle  @xcite posted on arxiv a different proof of the result @xmath26 and presented vertex - facet incidences of the pair of 4-polytopes in [ fig : nonrecontructible-3nonsimple ] to show that @xmath22 .",
    "we still do not know the answer to the following problem .    does @xmath27 for some @xmath28 ?",
    "in this section , for every dimension @xmath29 we construct pairs of @xmath1-polytopes with @xmath6 nonsimple vertices and isomorphic @xmath7-skeleton .",
    "first , some terminology , following @xcite ( for undefined terminology on polytopes see e.g. the textbooks @xcite ) .",
    "let @xmath30 be a @xmath1-polytope and let @xmath31 be a point in @xmath32 .",
    "we say that a facet @xmath33 of @xmath9 is _ visible _ from the point @xmath31 if @xmath31 belongs to the open halfspace determined by @xmath34 which does not meet @xmath9 .",
    "if instead @xmath31 belongs to the open halfspace which contains the interior of @xmath9 , we say that the facet @xmath33 is nonvisible from @xmath31 .",
    "moreover , the point @xmath31 is _ beyond _ a face @xmath35 of @xmath9 if the facets of @xmath9 containing @xmath35 are precisely those that are visible from @xmath31 .",
    "our construction relies on the following well - known theorem .",
    "[ thm : beneath - beyond ] let @xmath9 and @xmath36 be two @xmath1-polytopes in @xmath37 , and let @xmath38 be a vertex of @xmath36 such that @xmath39 and @xmath40 . then    a.   a face @xmath33 of @xmath9 is a face of @xmath36 if and only if there exists a facet of @xmath9 containing @xmath33 which is nonvisible from @xmath38 ; b.   if @xmath33 is a face of @xmath9 then @xmath41 is a face of @xmath36 if and only if a.   either @xmath42 ; b.   or among the facets of @xmath9 containing @xmath33 there is at least one which is visible from @xmath38 and at least one which is nonvisible .",
    "moreover , each face of @xmath36 is of one and only of the above types .",
    "[ prop:2-skel - const ] for every dimension @xmath43 there is a pair of @xmath1-polytopes @xmath44 and @xmath45 with @xmath46 vertices , nonisomorphic face lattices and isomorphic @xmath7-skeleton , such that each has exactly @xmath6 nonsimple vertices . in particular , @xmath25 .",
    "the proof of the proposition follows from the following two claims .",
    "* claim 1 . * for every @xmath47 there is a @xmath1-polytope @xmath48 with @xmath46 vertices labelled @xmath49 in such a way that ( 1 ) the @xmath6 nonsimple vertices of @xmath44 have positive even labels , and that ( 2 ) its @xmath46 facets are as follows .",
    "let @xmath50 denote the set of even - labelled vertices except @xmath51 .",
    "type a : :    a simplex : @xmath52 ; type b : :    @xmath6 facets of the form :    @xmath53    for @xmath54 ; type c : :    @xmath3 facets of the form :    @xmath55    for @xmath56 ; type d : :    a simplex : @xmath57 ; and type e : :    a simplex : @xmath58 .",
    "the construction of the polytope @xmath48 is by induction , with the base case @xmath59 depicted in [ fig : qd ]  ( a ) .",
    "we now construct @xmath60 from @xmath48 .",
    "-polytopes @xmath61 and @xmath62 in @xmath63 , and schlegel diagrams of the pair of @xmath8-polytopes @xmath64 and @xmath65 , projected on the fact isomorphic to @xmath61 in @xmath66 .",
    "the missing 2-face of the bipyramid face @xmath67 in @xmath65 is highlighted . ]    1 .",
    "construct a pyramid over @xmath44 and label the apex of the pyramid by @xmath46 , and let @xmath68 .",
    "2 .   take the convex hull with a new vertex @xmath38 labelled @xmath69 positioned on the affine hull of the triangle @xmath70 and beyond the edge @xmath71 $ ] to obtain @xmath60 .",
    "note that this triangle is a proper face of the pyramid , since the simplex @xmath72 is a facet of the pyramid .",
    "the facets of the polytope @xmath60 will be as follows :    from [ thm : beneath - beyond](i ) it follows that any facet of the pyramid not containing the edge @xmath71 $ ] will remain a facet of the polytope .",
    "these are our facets of types a - b .",
    "type a : :    a simplex : @xmath73 ; type b : :    @xmath74 facets of the form :    @xmath75    for @xmath76 ;    [ thm : beneath - beyond ] ( ii - a ) gives that any facet @xmath33 of the pyramid containing the triangle @xmath70 is contained in the corresponding facet @xmath77 in the new polytope .",
    "these new facets are of type c.    type c : :    @xmath78 facets of the form :    @xmath79    for @xmath80 ;    finally , [ thm : beneath - beyond ] ( ii - b ) ensures that the union of the vertex @xmath81 with every ridge of the pyramid not containing the edge @xmath71 $ ] of the only remaining facet of the pyramid , which is the simplex @xmath82 , will form a facet .",
    "there are exactly two such facets ; the types d - e .",
    "type d : :    a simplex :    @xmath83 ; and type e : :    a simplex : @xmath84 ;    it remains to show that the nonsimple vertices of @xmath60 are exactly the elements of @xmath85 . by induction ,",
    "the nonsimple vertices of @xmath86 form the set @xmath50 , so in the pyramid over @xmath86 the nonsimple vertices form the set @xmath85 . taking the convex hull with @xmath81 ,",
    "the edge @xmath87 disappears and the edges with @xmath38 are created , and include @xmath88 .",
    "thus , it remains to notice that @xmath38 is simple ; indeed @xmath38 is adjacent exactly to the vertices in @xmath89 , as [ thm : beneath - beyond ] ( ii - b ) shows .",
    "this completes the proof of the claim .",
    "* claim 2 . * for every dimension @xmath29 there is a polytope @xmath90 with the same @xmath7-skeleton as @xmath48 , whose @xmath46 vertices are labelled @xmath49 such that ( 1 ) the @xmath6 nonsimple vertices of @xmath45 have positive even labels , and ( 2 ) the @xmath91 facets are as follows .",
    "type a : :    a bipyramid over a simplex : @xmath92 ; type b : :    @xmath6 facets of the form :    @xmath53    for @xmath54 ; type c : :    @xmath3 facets of the form :    @xmath55    for @xmath56 ; and type d : :    a simplex : @xmath57 .    in short , the polytope @xmath90 is created by gluing the simplex facets of type a and e of @xmath48 along the ridge @xmath50 to create a bipyramid of @xmath90 , the facet of type a.",
    "the ridge @xmath50 of @xmath48 then becomes a missing ridge in @xmath90 .",
    "we construct the @xmath1-polytope @xmath90 by taking the convex hull of @xmath44 and a new vertex @xmath93 .",
    "first consider the edge @xmath94 $ ] of @xmath44 and the unique facet @xmath33 containing the vertex @xmath91 but not @xmath95 ; note that the vertex @xmath91 is simple .",
    "the facet @xmath33 is a simplex with vertices @xmath96 .",
    "place the vertex @xmath93 beyond the facet @xmath33 along the edge @xmath97 $ ] so that it lies on the first hyperplane encountered which supports some facet @xmath98 .",
    "this ensures that any facet of @xmath44 different from @xmath33 , @xmath98 or the @xmath6 facets @xmath99 containing the edge @xmath100 is nonvisible from the vertex @xmath93 . to get this configuration , note that in the construction of @xmath44 we can place the vertex @xmath91 arbitrarily close to the vertex @xmath101 , thereby ensuring that the ray emanating from the edge @xmath97 $ ] away from @xmath95 intersects a hyperplane which supports a facet containing the vertex @xmath101 but not the vertex @xmath91 , our facet @xmath98 .",
    "the polytope @xmath45 is the convex hull of @xmath44 and @xmath93 .",
    "since @xmath102 , there is at least one ridge @xmath103 of @xmath98 which is visible from @xmath93 , which implies that @xmath103 is not a face of @xmath45 .",
    "furthermore , since there is exactly one facet of @xmath48 visible from @xmath93 , namely , @xmath33 , only the ridges of @xmath33 can be visible from @xmath93 . recall the vertex @xmath38 with label @xmath91",
    "is simple .",
    "so @xmath104 in @xmath44 and it is unique .",
    "in addition to @xmath98 not containing the edge @xmath97 $ ] , it does not contain the vertex @xmath91 either .",
    "this implies that the set of vertices of @xmath103 is @xmath50 .",
    "in particular , the facet @xmath98 must be the facet @xmath105 of @xmath44 .    from [ thm : beneath - beyond ]",
    "( ii - a ) it follows that the facet @xmath98 of @xmath48 is replaced by the simplicial facet @xmath106 , which is a bipyramid over the simplex @xmath103 with vertex set @xmath50 .",
    "combinatorially , with the exception of the ridge @xmath50 , this bipyramid has the same face lattice as the boundaries of the union of the two simplex facets @xmath33 and @xmath98 ( types a and e ) of @xmath44 .",
    "now consider any face @xmath107 of @xmath48 not contained in @xmath98 .",
    "we have three possibilities : ( 1 ) the face is contained in a facet nonvisible from the vertex @xmath93 , ( 2 ) the face contains the edge @xmath94 $ ] , and ( 3 ) the face does not contain the edge and it is not contained in a facet nonvisible from the vertex @xmath93 . in the first case , by [ thm : beneath - beyond ] ( i ) , this face is also a face of @xmath90 . in the second case , the vertex @xmath93 is in the affine hull of the face and by [ thm : beneath - beyond ] ( ii - a ) , the corresponding face @xmath108 in @xmath90 has the same dimension as @xmath107 and the form @xmath109 . in the third case , the face @xmath107",
    "must be contained in intersections involving the facet @xmath33 and some facets in @xmath110 . in this case",
    "[ thm : beneath - beyond ] ( i ) assures us that @xmath107 is not a face of @xmath90 . in summary ,",
    "the two simplex facets @xmath33 and @xmath98 in @xmath48 are replaced by a bipyramid in @xmath90 with the same @xmath7-skeleton as @xmath111 , and every other facet of @xmath48 falls into the first or second cases : a facet of @xmath48 falling in the first case remains a facet of @xmath90 and a facet @xmath107 of @xmath48 falling into the second case is replaced by the facet @xmath112 in @xmath90 .",
    "note that @xmath50 remains the set of nonsimple vertices in @xmath90 as well .",
    "this complete the proof of the claim .",
    "this completes the proof of [ prop:2-skel - const ] .",
    "refer to [ fig : qd ]  ( c)-(d ) for schlegel diagrams of the polytopes @xmath64 and @xmath65 , where the projection facet is isomorphic to @xmath113 .",
    "a ` polymake ` program implementing the ideas presented in [ prop:2-skel - const ] is available online at @xcite under the name of the paper .",
    "the program takes as input a dimension @xmath1 and returns realisations of the pair of polytopes @xmath48 and @xmath90 .",
    "[ thm:2-skel ] for any fixed @xmath114 , let @xmath9 be a @xmath1-polytope with at most @xmath115 nonsimple vertices in each facet . if @xmath116 then @xmath9 is reconstructible from its 2-skeleton . furthermore , all the facets can be found in linear time in the number of vertices of the graph .",
    "this result is best possible as the pair @xmath48 and @xmath90 constructed in [ sec : construction ] is an example of @xmath1-polytopes with @xmath117 and with isomorphic @xmath7-skeleton , but with a different number of facets . for the proof",
    "we need the notion of _ frames _ , and a useful observation of kaibel about them , to be mentioned in the proof of the theorem . define a _",
    "@xmath10-frame _ as a subgraph of @xmath118 isomorphic to the star @xmath119 , where the vertex of degree @xmath10 is called the _ root _ of the frame .",
    "if the root of a frame is a simple vertex of @xmath9 , we say that the frame is _",
    "simple_.    we show that a modification of a friedman s algorithm ( * ? ? ?",
    "* sec .  7 ) gives a proof of the theorem .",
    "repeat the following routine , until all simple @xmath11-frames in @xmath118 are visited .    1 .",
    "pick a simple vertex @xmath120 ( it exists ) and select any simple @xmath11-frame @xmath121 centred at @xmath120 .",
    "let @xmath122 be the unique vertex adjacent to @xmath120 which is not in that frame .",
    "the frame @xmath121 is contained in a unique facet in @xmath9 , denote it by @xmath123 .",
    "2 .   consider any other simple vertex @xmath124 in the frame @xmath121 with @xmath125 ( it exists ) .",
    "then there exists another simple @xmath11-frame @xmath126 centred at @xmath124 in the facet @xmath123 .",
    "3 .   consider the neighbour @xmath127 of @xmath124 present in the 2-face @xmath128 that contains the 2-frame @xmath129 with root @xmath120 .",
    "we know all the vertices of @xmath128 .",
    "then , applying ( * ? ? ?",
    "* prop .  1 ) to the edge @xmath130",
    "gives that the frame @xmath126 is formed by all the vertices adjacent to @xmath124 other than @xmath127 ( while ( * ? ? ?",
    "1 ) was phrased only for simple polytopes , it clearly holds for simple frames in polytopes ) .",
    "indeed , if the vertex @xmath127 were in the frame @xmath126 , then , since @xmath124 and every vertex in @xmath126 is in @xmath123 , the 2-face @xmath128 would be contained in @xmath123 , a contradiction .",
    "4 .   continue this process , always moving along edges formed by simple vertices , and stop when no new simple @xmath11-frame can be visited .",
    "we show that when ( 4 ) stops the obtained graph spans the facet @xmath123 .",
    "the conditions of the theorem guarantee that , in any facet @xmath123 of @xmath9 , we can go from any simple vertex to any other simple vertex through a path only formed of simple vertices , since @xmath131 is @xmath11-connected by balinski s theorem ( * ? ? ?",
    "thus , after step ( 4 ) finishes , the vertex set of the graph obtained is the vertex set of the facet @xmath123 .    repeating this process for all simple @xmath11-frames",
    "will then reveal all the facets of @xmath9 .",
    "finally , we show that this process , with a little preprocessing , runs in linear time in the number of vertices .",
    "the number of simple @xmath11-frames is @xmath1 times the number of simple vertices of @xmath9 , thus linear , and each such frame is visited once .",
    "it remains to check that the move from one simple @xmath11-frame , @xmath121 , to the next , @xmath126 , can be done in constant time ( depending on @xmath1 ) : checking if the degree of a vertex ( neighbor of @xmath120 ) is @xmath1 takes only constant time , and in case it is @xmath1 we need to find @xmath132 in step ( 3 ) in constant time . for this , preprocess the data of the @xmath4-skeleton , to construct the graph @xmath133 ( following friedman  @xcite ) whose vertices are the @xmath4-frames , and two of them are connected by an edge iff the root of one is a vertex of the other and both belong to the same @xmath4-face . move along edges of @xmath133 , from the @xmath4-frame @xmath129 with root @xmath120 to @xmath134 with root @xmath124 , to find @xmath132 in constant time . as the number of faces in the @xmath4-skeleton is linear in the number of vertices ,",
    "constructing @xmath133 takes linear time .",
    "thus , the complexity result follows .",
    "let @xmath9 be a @xmath1-polytope with exactly @xmath6 nonsimple vertices , denote their set by @xmath135 .",
    "apply the above algorithm to obtain a collection of graphs @xmath136 .",
    "the vertex sets @xmath137 are exactly the vertex sets of the facets of @xmath9 , providing reconstruction , unless the following happens : there is a single facet @xmath33 which contains @xmath135 and @xmath135 separates @xmath138 , in which case there are two subgraphs @xmath35 and @xmath139 obtained by the algorithm such that @xmath140 spans @xmath33 and @xmath141 . the only case where we can not reconstruct is in case the induced graph @xmath142 $ ] on @xmath135 is complete , and there is ambiguity",
    "whether @xmath9 has two facets corresponding to @xmath143 and @xmath144 intersecting on a common ridge with vertex set @xmath135 , or @xmath9 has a facet with vertex set @xmath145 ( all other facets are determined ) .",
    "thus , if the _ parity _ of the number of facets is also given , we can reconstruct .    combining proposition",
    "[ prop:2-skel - const ] and theorem  [ thm:2-skel ] gives    [ cor:2-skel ] @xmath20 .",
    "in this section we prove that , like simple polytopes , @xmath1-polytopes with at most two nonsimple vertices are reconstructible from their graphs ; see [ thm : exprectwo ] .",
    "this is best possible for @xmath14 , as the 4-polytopes @xmath64 and @xmath65 in [ fig : nonrecontructible-3nonsimple ] have three nonsimple vertices and the same graph . in case of one nonsimple vertex",
    "the reconstruction can be done in polynomial time , following friedman  @xcite .",
    "we start with some preparations .",
    "let @xmath9 denote a @xmath1-polytope and let @xmath146 be a shelling order of its polar @xmath147 .",
    "the shelling order naturally defines an orientation of the dual graph @xmath148 of @xmath147 : if @xmath149 precedes @xmath150 in the order , and they share a ridge , orient the corresponding edge in @xmath148 from @xmath149 to @xmath150 .",
    "since @xmath148 and @xmath118 are isomorphic , we immediately obtain an acyclic orientation of @xmath118 .",
    "denote by @xmath151 the anti - isomorphism from the face lattice of @xmath9 to the face lattice of the dual @xmath147 .",
    "following kalai @xcite , call an acyclic orientation of @xmath118 _ good _ if for every nonempty face @xmath33 of @xmath9 the graph @xmath138 of @xmath33 has a unique sink .",
    "actually , we only need that the acyclic orientation has a unique sink in every facet , so for us this possibly larger set represents the good orientations .",
    "acyclic orientations of @xmath118 arising from shellings of the dual polytope are good orientations .",
    "the following remark is simple but important .",
    "[ rmk : acycorient ] let @xmath9 be a polytope , @xmath152 an acyclic orientation of @xmath118 , @xmath33 a @xmath10-face of @xmath9 with @xmath153 , and let @xmath31 be any vertex in @xmath138 . then there is a directed path in @xmath138 from @xmath31 to some sink in @xmath33 and a directed path in @xmath138 from some source in @xmath33 to @xmath31 .",
    "define an _ initial _ set with respect to some orientation as a set such that no edge is directed from a vertex not in the set to a vertex in the set .",
    "define the @xmath154 of the face @xmath33 in the polytopal complex @xmath155 as the collection of all the faces of @xmath156 containing @xmath33 .",
    "denote by @xmath157 the boundary complex of a polytope @xmath9 .",
    "we require the following results on shelling orders of polytopes .",
    "[ lem : shellingorders ] let @xmath9 be a polytope",
    ". for every face @xmath158 and every facet @xmath33 such that @xmath159 there is a shelling order of @xmath9 in which @xmath33 comes first and the facets in @xmath160 come last .",
    "furthermore , any given facet @xmath161 in @xmath160 can be taken as the last .",
    "we proceed as in the proofs of ( * ? ? ?",
    "* thm .  8.12 , cor .  8.13 ) .",
    "choose a point @xmath162 beyond the face @xmath158 and a point @xmath163 beyond the facet @xmath33 .",
    "let @xmath164 be the line determined by @xmath162 and @xmath163 such that @xmath164 hits the interior of @xmath9 .",
    "move @xmath162 so that the line @xmath164 leaves the interior of @xmath9 at a given facet @xmath165 .",
    "perturb @xmath163 and @xmath162 so that the resulted line @xmath164 intersects each of the facets defining hyperplanes in a single and different point ( cf .",
    "orient the line @xmath164 from @xmath162 to @xmath163 and proceed with the resulted brugesser - mani line shelling as in the proof ( * ? ? ?",
    "* thm .  8.12 ) .    translating the above lemma via the duality",
    "anti - isomorphism @xmath151 we obtain the following special good orientations .    [ cor : orientation - f - initial]for every facet of a polytope @xmath9 the following orientations exist .",
    "a.   a good orientation of @xmath118 such that the vertices of the facet are initial , and within the facet any two vertices can be chosen to be the sink and source .",
    "b.   a good orientation of @xmath118 such that the vertices of the facet are initial , and within the facet a face @xmath103 is initial and a vertex not in @xmath103 is a sink in the facet .",
    "any induced @xmath11-connected subgraph of @xmath118 whose simple vertices have each degree @xmath6 and each nonsimple vertex has degree @xmath166 is called a _",
    "feasible _ subgraph .",
    "we say that a @xmath10-frame with root @xmath167 is _ valid _ if there is a facet of @xmath9 containing @xmath167 and the edges of the frame and no other edge incident to @xmath167 .",
    "thus , if @xmath167 is a simple vertex then any of its @xmath11-frames is valid .",
    "[ lem : feasible - subgraphs ] let @xmath9 be a @xmath1-polytope , and let @xmath168 be a feasible subgraph of @xmath118 containing at most @xmath3 nonsimple vertices . if the graph @xmath138 of some facet @xmath33 is contained in @xmath168 , then @xmath169 .    if @xmath170 , then @xmath171 , as @xmath138 is an induced subgraph of @xmath118 .",
    "otherwise , @xmath172 , in which case any path from a vertex in @xmath173 to a vertex in @xmath138 must pass through a nonsimple vertex , since simple vertices have the same degree in both @xmath168 and @xmath138 .",
    "consequently , the nonsimple vertices would disconnect @xmath168 , contradicting its @xmath11-connectivity .",
    "[ thm:1vertex ] let @xmath47 .",
    "every @xmath1-polytope with at most one nonsimple vertex can be reconstructed from its graph , in polynomial time in the number of vertices .",
    "the proof is an adaptation of proofs from @xcite and @xcite to the case when one nonsimple vertex exists .",
    "first , we consider only the set @xmath174 of acyclic orientations of the polytope graph in which the nonsimple vertex , if present , has indegree 0 .",
    "the existence of good orientations in @xmath174 follows from [ cor : orientation - f - initial ] .",
    "second , we need a slight generalisation of the @xmath4-systems of @xcite . a set @xmath175 of subsets of @xmath176 is called a _",
    "@xmath4-system _ of @xmath118 if for every set @xmath177 the subgraph induced by @xmath178 is @xmath4-regular and if the vertex set of every @xmath4-frame of @xmath9 with a simple vertex as a root is contained in a unique set of @xmath175 .",
    "notice that the set @xmath179 of vertex sets of @xmath4-faces of @xmath9 is a @xmath4-system of @xmath118 .",
    "then a result in the same vein as ( * ? ? ?",
    "* thm .  1 ) and ( * ? ? ?",
    "4 ) can be obtained , following their proofs : let @xmath9 be a @xmath1-polytope with at most one nonsimple vertex , @xmath175 a 2-system of @xmath118 and @xmath152 an acyclic orientation of @xmath180 .",
    "then , as argued there , @xmath181 where @xmath182 denotes the number of vertices of @xmath35 with indegree @xmath10 .",
    "the first inequality holds with equality iff @xmath183 , and the second inequality holds with equality iff @xmath152 is a good orientation of @xmath174 .",
    "based on this characterisation , and following mutatis mutandis friedman s proof in @xcite , we obtain a polynomial - time , primal - dual algorithm for deciding the @xmath4-faces of @xmath9 . combined with theorem  [ thm:2-skel ] ,",
    "we reconstruct the entire face lattice of @xmath9 in polynomial time .",
    "[ thm : exprectwo ] if @xmath9 is a @xmath1-polytope with two nonsimple vertices , then the graph of @xmath9 determines the entire combinatorial structure of @xmath9 .    in this case",
    "the reconstruction algorithm we suggest runs only in exponential time .",
    "let us assume that @xmath43 , as the result is trivial for smaller @xmath1 .",
    "denote by @xmath120 and @xmath38 the nonsimple vertices of @xmath9 .",
    "partition the facets of @xmath9 into four families : let @xmath184 ( resp .",
    "@xmath185 ) denote the family of facets containing @xmath120 and not @xmath38 ( resp .",
    "@xmath38 and not @xmath120 ) and @xmath186 ( resp .",
    "@xmath187 ) the family of facets containing none of ( resp . both ) @xmath120 and @xmath38 .",
    "we find each of these families in the following order , from first to last : @xmath184 , @xmath185 , @xmath186 , @xmath187 ; given in the following four claims .",
    "denote by @xmath188 the set of feasible subgraphs of @xmath118 which contain @xmath120 but not @xmath38 .",
    "denote by @xmath189 the set of all acyclic orientations of @xmath118 in which ( 1 ) the nonsimple vertex @xmath120 has indegree 0 , ( 2 ) the nonsimple vertex @xmath38 has outdegree 0 , and ( 3 ) some subgraph @xmath190 in @xmath188 is initial .",
    "it follows that @xmath190 has a sink which is a simple vertex .",
    "note that @xmath189 is nonempty , furthermore :    * claim 1 ( find @xmath184 ) . *",
    "a feasible subgraph @xmath190 in @xmath188 is the graph of a facet of @xmath9 containing @xmath120 but not @xmath38 iff : ( 1 ) @xmath190 is initial with respect to a good orientation @xmath152 in @xmath189 , and ( 2 ) @xmath190 has a unique sink which is a simple vertex .",
    "first consider a facet @xmath123 containing @xmath120 but not @xmath38 ( such facet clearly exists ) . by corollary  [ cor :",
    "orientation - f - initial ] @xmath191 satisfies conditions ( 1 ) and ( 2 ) .",
    "we prove the converse .",
    "let @xmath192 and let @xmath182 denote the number of simple vertices of @xmath35 with indegree @xmath10 w.r.t .",
    "define@xmath193 the function @xmath194 counts the number of pairs @xmath195 , where @xmath33 is a facet of @xmath9 and @xmath31 is a simple sink in @xmath33 w.r.t .",
    "the orientation @xmath152 in @xmath189 .",
    "if @xmath31 is a simple vertex in @xmath9 with indegree @xmath10 , then @xmath31 is a sink in @xmath196 facets of @xmath9 .",
    "since the orientation is acyclic , every facet has a sink .",
    "furthermore , every facet containing @xmath38 has @xmath38 as a sink , and @xmath120 is not a sink in any facet .",
    "let @xmath197 , and let @xmath167 be the simple sink in @xmath190 with respect to @xmath152 .",
    "suppose @xmath190 does not represent some facet @xmath33 containing @xmath167 , namely @xmath198 .",
    "then , by [ lem : feasible - subgraphs ] , there is a vertex of @xmath33 not in @xmath190 .",
    "since @xmath190 is initial with respect to @xmath152 , the facet @xmath33 would contain two sinks , one of them being @xmath167 .",
    "consequently , as there is a good orientation in @xmath189 and a subgraph in @xmath188 representing a facet , we have that @xmath199 where @xmath200 ( resp .",
    "@xmath201 ) denotes the number of facets in @xmath9 ( resp . containing @xmath38 ) .",
    "also , the orientations in @xmath189 minimizing @xmath202 are exactly the good orientations in @xmath189 .",
    "let @xmath167 be the simple sink in @xmath190 with respect to a good orientation @xmath152 in @xmath189 .",
    "then @xmath167 defines a unique facet @xmath33 of @xmath9 , and all the other vertices of @xmath33 are smaller than @xmath167 with respect to the ordering induced by @xmath152 . since @xmath190 is an initial set in @xmath152 and since there is a directed path in @xmath138 from any vertex of @xmath138 to @xmath167 ( cf .",
    "[ rmk : acycorient ] ) , we must have @xmath203 and we are done by [ lem : feasible - subgraphs ] .    exchanging the roles of @xmath120 and @xmath38 ,",
    "define @xmath204 and @xmath205 similarly to @xmath188 and @xmath189 . by symmetry",
    "we also get the following claim .",
    "* claim 2 ( find @xmath185 ) . * a feasible subgraph @xmath206 is the graph of a facet of @xmath9 containing @xmath38 but not @xmath120 iff ( 1 ) @xmath207 is initial with respect to some good orientation @xmath208 and ( 2 ) has a unique sink which is a simple vertex .",
    "running through all the good orientations in @xmath189 or @xmath205 , we recognize all the graphs of facets in @xmath184 and in @xmath185 .",
    "let @xmath209 , @xmath210 , @xmath211 and @xmath212 .",
    "clearly , @xmath213 since the number @xmath214 is known ( it is the minimum of @xmath215 over @xmath192 ) , and since @xmath216 , it follows that the number @xmath217 is known ; if @xmath218 then @xmath219 .",
    "assume then @xmath220 . we show next how to recognize the facets in @xmath186 .",
    "denote by @xmath221 the set of feasible subgraphs of @xmath118 which contain neither @xmath120 nor @xmath38 , and by @xmath222 the set of all acyclic orientations of @xmath118 in which ( 1 ) the nonsimple vertex @xmath38 has outdegree 0 , and ( 2 ) some subgraph @xmath223 in @xmath221 is initial .",
    "it follows that @xmath223 has a sink which is a simple vertex .",
    "define an _ almost good orientation _ as an acyclic orientation in which every facet with a simple sink has a unique sink .",
    "* claim 3 ( find @xmath186 ) .",
    "* let @xmath220 .",
    "a feasible subgraph @xmath224 is the graph of a facet of @xmath9 containing neither @xmath120 nor @xmath38 iff ( 1 ) @xmath223 is initial with respect to some _ almost _ good orientation @xmath225 and ( 2 ) @xmath223 has a unique sink which is a simple vertex .",
    "consider a facet @xmath226 containing neither @xmath120 nor @xmath38 ; such facet exists by assumption . reversing the shelling that follows from applying [ lem : shellingorders ] to the dual of @xmath9 with @xmath227 and @xmath228 , we get a good orientation of @xmath118 in which the vertices of @xmath226 are initial and @xmath38 is the global maximum .",
    "this proves the `` only if '' part of the claim .",
    "let @xmath225 , and as before @xmath182 denote the number of simple vertices of @xmath35 with indegree @xmath10 .",
    "let @xmath229 denote the number of valid @xmath11-frames of @xmath120 which are contained in facets which do not contain @xmath38 and have @xmath120 as a sink .",
    "since we already know all the facets containing @xmath120 but not @xmath38 , we can compute @xmath229 from @xmath152",
    ". define@xmath230 the function @xmath231 counts the number of pairs @xmath195 , where @xmath33 is a facet of @xmath9 , @xmath31 is sink of @xmath33 and either @xmath31 is simple or @xmath232 .",
    "any facet containing @xmath38 has @xmath38 as a sink . consequently ,",
    "as there is a good orientation in @xmath233 and a subgraph @xmath234 representing a facet , we have that @xmath235 note that an orientation @xmath152 of @xmath222 minimising @xmath236 is not necessarily a good orientation ; there may be a facet in which both @xmath120 and @xmath38 are sinks , but facets with a simple sink or facets not containing @xmath38 must have a unique sink .",
    "the proof now proceeds mutatis mutandis as in the proof of claim 1 .",
    "let @xmath167 be the simple sink in @xmath237 with respect to @xmath152 , then @xmath167 defines a unique facet @xmath33 of @xmath9 , where all the other vertices of @xmath33 are smaller than @xmath167 with respect to the ordering induced by @xmath152 . since @xmath237 is an initial set in @xmath152 and since there is a directed path in @xmath138 from any other vertex of @xmath138 to @xmath167 ( cf .",
    "[ rmk : acycorient ] ) , and we must have @xmath238 , with the result following from [ lem : feasible - subgraphs ] .",
    "running through all the orientations in @xmath222 minimizing @xmath239 we recognize @xmath240 .",
    "it remains to recognize @xmath241 .",
    "we first find out whether or not the number @xmath242 .",
    "note that each facet contains a simple @xmath11-frame , and any simple @xmath11-frame is contained in a ( unique ) facet .",
    "thus , @xmath243 iff there exists a simple @xmath11-frame not contained in any of the graphs of the facets in @xmath244 .",
    "assume @xmath245 . recognizing the facets in @xmath241 is done similarly to the previous cases .",
    "denote by @xmath246 the set of feasible subgraphs which contain both @xmath120 and @xmath38 , and by @xmath247 the set of all acyclic orientations of @xmath118 in which some subgraph @xmath248 in @xmath246 is initial with a unique sink which is a simple vertex .",
    "* claim 4 . *",
    "assume @xmath245 .",
    "then a feasible subgraph @xmath249 is the graph of a facet containing both @xmath120 and @xmath38 iff ( 1 ) @xmath248 is initial with respect to some good orientation @xmath152 in @xmath247 , and ( 2 ) has a unique sink which is a simple vertex .    applying [ cor : orientation - f - initial](i ) to a facet @xmath250",
    ", we get a good orientation in which the vertices of @xmath251 are initial and the sink in @xmath251 is a simple vertex .",
    "this proves the `` only if '' part .    for the `` if '' part , for any @xmath252 consider the function @xmath253 its minimum value over @xmath247 is @xmath200 . any orientation minimizing @xmath254 must be good .",
    "for any orientation @xmath152 minimizing @xmath254 , proceed as in the `` if '' part in the proof of claim 1 to conclude the proof .",
    "thus , by claims 14 we have found all the facets of @xmath9 from @xmath118 .",
    "[ cor:1-skel ] @xmath255 and @xmath22 .",
    "can the proof of theorem  [ thm : exprectwo ] be modified to reconstruct the @xmath4-faces in polynomial time , as in the case of one nonsimple vertex ( theorem  [ thm:1vertex ] ) ?",
    "this would give polynomial time reconstruction algorithm for the facets , in the presence of two nonsimple vertices .",
    "in this paper we measured the deviation from being a simple polytope by counting the number of nonsimple vertices , which is perhaps the most natural way .",
    "other measures of such deviation were considered or suggested in the literature .",
    "blind et al .",
    "@xcite thought of an `` almost '' simple polytope as a @xmath1-polytope having only vertices of degree @xmath1 or @xmath256 , while in ( * ? ? ?",
    "8) , friedman suggested that @xmath1-polytopes with few nonsimple vertices of degree at most @xmath257 may be considered close to being simple . in terms of reconstruction ,",
    "friedman s and blind s suggestions are too weak .",
    "perles construction already gives examples of inequivalent polytopes with the same @xmath7-skeleton , having exactly @xmath1 vertices of degree @xmath256 while the rest of the vertices are simple .",
    "the last three authors considered in  @xcite yet another measure of deviation from being a simple polytope , the _ excess _ , defined as @xmath258 , where @xmath259 denote the number of edges incident to the vertex @xmath38 .",
    "simple polytopes have excess zero . the paper @xcite then studied reconstructions of polytopes with small excess and of polytopes with a small number of vertices ( at most @xmath46 ) .",
    "we thank micha perles for helpful discussions .",
    "guillermo pineda would like to thank michael joswig for the hospitality at the technical university of berlin and for many fruitful discussions on the topics of this research .",
    "[ 2 ] http://www.ams.org/mathscinet-getitem?mr=#1[#2 ] [ 2]#2"
  ],
  "abstract_text": [
    "<S> blind and mani , and later kalai , showed that the face lattice of a simple polytope is determined by its graph , namely its @xmath0-skeleton . call a vertex of a @xmath1-polytope _ nonsimple _ </S>",
    "<S> if the number of edges incident to it is @xmath2 . </S>",
    "<S> we show that ( 1 ) the face lattice of any @xmath1-polytope with at most two nonsimple vertices is determined by its @xmath0-skeleton ; ( 2 ) the face lattice of any @xmath1-polytope with at most @xmath3 nonsimple vertices is determined by its @xmath4-skeleton ; and ( 3 ) for any @xmath5 there are two @xmath1-polytopes with @xmath6 nonsimple vertices , isomorphic @xmath7-skeleton and nonisomorphic face lattices . in particular , the result ( 1 ) is best possible for @xmath8-polytopes . </S>"
  ]
}