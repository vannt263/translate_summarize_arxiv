{
  "article_text": [
    "this article concerns a light flasher system developed for the very energetic radiation imaging telescope array system ( veritas )  @xcite .",
    "veritas is an array of four imaging atmospheric cherenkov telescopes ( iacts ) located at the fred lawrence whipple observatory on mount hopkins in southern arizona .",
    "the veritas telescopes measure the cherenkov light caused by relativistic electrons in air showers initiated by high energy astrophysical gamma rays .",
    "each telescope consists of a 12-m - diameter reflector viewed by a ` camera ' comprising 499 29-mm - diameter photomultiplier tubes ( pmts ) .",
    "the pmts are read out using fadcs operating at rate of 500 megasamples per second .",
    "a flasher system is used to monitor the gains and timing characteristics of the pmts .    the present veritas flasher system  @xcite uses a nitrogen laser which produces short pulses of ultraviolet ( @xmath0 = 330 nm ) light that are distributed through quartz optical fibres .",
    "each telescope is supplied by one fibre , which ends approximately four metres from the front of the camera in a termination box equipped with an opal diffuser .",
    "this system provides uniform and simultaneous illumination to all pmts in the camera .",
    "it delivers light pulses which are similar in shape and wavelength to the cherenkov - light pulses seen in normal observing and is therefore well - suited for testing the pmts in their nominal region of operation .",
    "this system has a few disadvantages .",
    "it can not be pulsed at a rate much higher than 10 hz which means that calibration runs can be long , especially when one is obtaining high - statistics data sets .",
    "such runs are usually performed under dark - sky conditions and are therefore at the expense of scientific observing time .",
    "another negative feature of the laser - based system is the cost and lifetime of the laser which uses a factory - sealed cartridge capable of producing a large but finite number of pulses . replacing the cartridge costs several thousand dollars and can cause considerable down time if a spare is not on hand .    to overcome these disadvantages ,",
    "we have developed a flasher system based on blue light - emitting diodes ( leds ) which are bright enough and fast enough to illuminate the veritas pmts with pulses of duration and intensity that are very similar to those coming from the laser - based system and yet cost less than a dollar each .",
    "the led flasher can be used to test the linearity of the pmt - fadc chain and can be used in conjunction with a neutral - density filter to determine the single - photoelectron response in all the channels . moreover , because the system can be flashed at rates limited only by the veritas data acquisition system , runs which require very high statistics can be carried out in only a few minutes .",
    "the led flasher assembly is pictured in figure  [ flasher ] .",
    "the leds and associated electronics are housed in a modified maglite@xmath1 which provides protection from weather and dust allowing the device to be mounted on the telescope for extended periods . at the front",
    ", a 50-mm opal diffuser ( edmund optics nt46 - 106 ) replaces the lens of the maglite@xmath1 and spreads the light from the leds , located a few mm behind it , such that each pmt in the camera receives approximately the same amount of light .",
    "two cables emerge from the rear of the flasher .",
    "one is used for supplying an external nim - level pulse to activate the flasher and the other is used for a ttl - level trigger - out signal .",
    "the blue leds can be seen in figure  [ flasher ] which is a photograph taken with the diffuser removed .",
    "these leds ( optek ovlgb0c6b9 ) are ingan devices with a peak wavelength of approximately 465 nm , nominal brightness of 3200 mcd , and a 50% power angle of 6@xmath2 .",
    "the flasher circuit is shown in figure  [ schematic ] and is based on concepts described in  @xcite .",
    "it uses simple integrated circuits to source currents through the blue leds each time a pulse is received , either from an external source or from an internal 10 hz oscillator .",
    "these pulses increment a binary counter ( u5 ) which cycles repeatedly through the states from 000 to 111 .",
    "the output bits are sent to a decoder ( u6 ) with active - low outputs coupled to a set of and gates ( u7 and u8 ) .",
    "the output of these are used to drive the leds using nor gates ( u9 and u12 ) to source the current required .",
    "the logic is arranged such that the number of illuminated leds in the array runs from zero through seven sequentially so that over the course of many cycles the light intensity is ramped from off to maximum repeatedly .",
    "this is useful for scanning over the range of the pmt and fadc response .",
    "the width of the current - pulse is adjustable and is made narrow enough to achieve a light pulse from the leds which is a few nanoseconds in length .",
    "this limits the amount of light in the pulse since the slew rates in the electronics are such that full amplitude is not attained before the pulse is turned off .",
    "the led flasher was tested using one of the veritas telescopes and the standard data acquisition system . for purposes of comparison",
    ", data were acquired using the laser system immediately afterwards .",
    "the led flasher rate was 200 hz and the laser was pulsed at 10 hz . for each event a 24-sample ( 48 ns ) fadc trace for each pmt was written to a data file .",
    "pedestal events were included in the data stream at the rate of 1 hz .",
    "we have attempted to produce with the led system a pulse shape which is similar to that produced by the laser system , which is itself meant to be narrow , like the pulses caused by the cherenkov photons from air showers .",
    "figure  [ traces ] shows an example of the pulses obtained from one pmt over the course of an eight - event cycle .",
    "the light level increases from zero , with no leds on , to maximum with seven leds on .",
    "note that due to pulse - to - pulse fluctuations and differences in the mean output of each led , the traces do not follow a strictly monotonic increase with event number in this example .",
    "the averages of 250 events are shown in figure  [ average ] where the progress is more linear except for level 7 which is very similar to level 6 , indicating a weak sixth led .     but averaged over 250 led pulses at each intensity level .",
    ", scaledwidth=100.0% ]    in figure  [ fits ] the distributions of figure  [ average ] have been normalized to 1.0 and fit with an asymmetric gaussian function of the form    @xmath3    @xmath4    the fit parameters are independent , within statistical uncertainties , of the the number of leds contributing to the flash .",
    "but the distributions have been normalized to 1.0 and fit with an asymmetric gaussian described in the text .",
    ", scaledwidth=100.0% ]    figure  [ example ] ( left ) is a repeat , in larger format , of the ` average-7 ' panel in figure  [ fits ] and figure  [ example ] ( right ) is a similar plot made using laser data is not possible . ] .",
    "the two figures look similar and , except for @xmath5 , the fit parameters are identical within statistical uncertainties .",
    "thus the led flasher performs as well as the laser flasher at simulating cherenkov pulses .      in this section",
    "we compare the fluctuations of the led flasher with those of the laser .",
    "the led - based system does not include an independent monitor so we use the ` camera average ' for measuring light levels .",
    "the charges reported by all 499 channels in the camera are combined for each laser or led pulse .",
    "a few dead or miscreant channels are thereby included but do not influence the average significantly . combining charges from the entire camera also means that fluctuations from finite photostatistics in individual channels will be made negligible .",
    "figure  [ led_res_1 ] shows the distributions of camera averages for the eight ( including zero ) led light levels together with gaussian fits .",
    "the fitted values are displayed in figure  [ led_resolution ] ( left ) where the resolution ( @xmath6 ) for each non - zero light level is plotted against the corresponding mean ( @xmath7 ) .",
    "for multiple , identical but uncorrelated , sources one expects the data to behave like @xmath8 , which is the form of the function that has been fit to the data in figure  [ led_resolution ] .",
    "the laser run used for these studies has only one intensity level .",
    "the distribution of camera averages is displayed in figure  [ laser_resolution ] along with a gaussian fit that shows the resolution to be approximately 3% .",
    "note that at a similar light level ( @xmath9 ) the led system has a resolution of 0.6% .",
    "this results from the good intrinsic resolution of each led , coupled with the statistical improvements due to combining multiple leds .    ) vs mean ( @xmath7 ) ( in arbitrary units ) of the distributions in figure  [ led_res_1 ] .",
    "the curve is of the form @xmath10 , expected when combining multiple , identical but uncorrelated , sources . ,",
    "scaledwidth=100.0% ]    ) is approximately 3% .",
    ", scaledwidth=100.0% ]",
    "in this section we will show how the led flasher can be used to monitor the pmt gains and we will demonstrate that it performs at least as well as the laser - based system in this regard .",
    "the simplest way to measure the relative gains of pmts is to provide light flashes to the camera and plot the response of each pmt against the response of some kind of monitor which measures the absolute light output of the flasher . in the case of the laser ,",
    "a photodiode measures a fraction of the laser light and , since the laser is nominally a constant intensity device , the relative gain of the pmt is computed as the ratio of the mean pedestal - subtracted pmt pulse size to the mean monitor pulse size .",
    "this assumes , but does not demonstrate , linearity in the system .    using the camera - average monitor introduced previously ,",
    "plots like those seen in figure  [ led_slopes ] can be constructed . in the left - hand plot",
    "the mean charge of a typical pmt is plotted against the mean monitor for the eight ( including zero ) light levels produced by the led system .",
    "a straight line has been fit to the data . for a given channel the slope of this line",
    "is related to the relative amount of light received by the pmt , the quantum efficiency of the pmt , its efficiency at collecting photoelectrons from the photocathode onto the first dynode , and the gain of the subsequent dynodes , pre - amplifier , etc .",
    "a change in any of these components will cause the slope to change and if one of the components changes ( eg the quantum efficiency decreases ) the dynode gain can be changed to compensate .",
    "measuring the slopes periodically and providing a list of high - voltage adjustments to equalize them ( flat - fielding ) is the primary task of the gain - monitoring system .    ) of the charge distribution for each light level vs the mean value of the charge distribution for that pmt .",
    "coherent fluctuations of the flasher have been removed using the monitor , and pedestal fluctuations have also been unfolded .",
    ", scaledwidth=100.0% ]    note that the eight points demonstrate the linearity of the system .",
    "if it can be assumed that linearity prevails , multiple points are not necessary ; with a pedestal and only one non - zero point one can compute the slope .",
    "this is the procedure followed when using the laser system ; with this led system linearity can be proven rather than assumed .",
    "it should be stated that in the foregoing we are assuming implicitly that the monitor made from an average of many channels has linear behaviour .",
    "it is instructive to compare the relative gains determined using the led flasher with those determined using the laser .",
    "those determined with the laser are all clustered about a single mean value to within errors .",
    "this is by construction since relative gain is the parameter used for flat fielding .",
    "the relative gains determined using the led flasher would also cluster about that value if the led light had the same wavelength as that of the laser .",
    "however , since the wavelength is longer ( 470 nm vs 330 nm ) we expect differences due to the wavelength - dependent quantum efficiency of the photo - cathodes . to the extent that this dependence varies from pmt to pmt we expect any clustering to be broadened .",
    "this phenomenon can be seen in figure  [ led_laser_3 ] .",
    "the right - hand plot in figure  [ led_slopes ] shows the variance of the pmt s pulse size distribution vs its mean for the different light levels .",
    "the contribution of pedestal fluctuations and pulse - to - pulse fluctuations of the leds have been unfolded .",
    "if we say that only fluctuations due to the poisson statistics of photoelectron production remain , we have the following argument : the mean number of photoelectrons hitting the first dynode for a given light level is @xmath11 . there are fluctuations about this given by ( approximately gaussian ) poisson statistics @xmath12 .",
    "after the dynodes and preamplifier have amplified this we have @xmath13 and @xmath14 .",
    "and we expect @xmath15 .",
    "thus the slope of the right - hand plot is related to the net gain after the first dynode .",
    "note that this method provides an estimate of the absolute gain without the use of a calibrated monitor to indicate the light level .",
    "the camera - average monitor is only used to remove pulse - to - pulse variations in light output from the leds ( a small effect anyway , as demonstrated earlier ) .",
    "a final but important effect has been left out in this simple treatment .",
    "taking into account statistics at the other dynodes , which are in general described by a polya distribution  @xcite , leads to a correction factor such that @xmath16 where @xmath17 is the resolution of the distribution that would result from injecting only single photoelectrons into the dynode chain .",
    "the effect of this is shown later in this article .    )",
    "than the led data ( @xmath18 ) since they are used in the flat - fielding procedure .",
    ", scaledwidth=100.0% ]    note that the absolute gains determined in this way do not include effects of the photocathode quantum efficiency and the first - dynode collection efficiency .",
    "thus we expect a better correlation between measurements made with the led system and measurements made with the laser system .",
    "this is seen in figure  [ led_laser ] where gains determined using the led system are plotted against those determined using the laser system .          a very direct way to measure",
    "the gain of a pmt is to determine the mean value of the pulse size distribution due to single photoelectrons .",
    "a single photoelectron should , on average , result in a measured charge of @xmath19 coulombs where @xmath20 is the system gain and @xmath21 is the electron charge , @xmath22 coulombs . in this case , as with the photostatistics method , the ` gain ' includes everything from the first dynode through to the digitized data . the photocathode quantum efficiency and first - dynode collection efficiency are not included .",
    "single photoelectrons are measured in veritas by taking special laser runs with a neutral - density filter covering the pmts to attenuate spurious light from the night sky . the light level from the laser is adjusted to result in the release of a single photoelectron in some events . with a low enough laser intensity ,",
    "one obtains a distribution with mostly zero photoelectrons , a reasonable fraction of single photoelectrons and smaller fractions of two , three , etc photoelectrons , following a poisson distribution . assuming that each photoelectron gives rise to a gaussian distribution after the effects of amplification and that this distribution is convoluted with another gaussian distribution , which results from the effect of electronic noise ( ie the pedestal distribution ) , the entire distribution can be fit with only five parameters .",
    "these are : the pedestal mean and width , the single - photoelectron mean and width , and the mean number of photoelectrons .",
    "this technique has become a standard procedure using the veritas laser system but it has limitations .",
    "the technique requires a small mean number of photoelectrons , so most laser pulses contribute to the zero photoelectron peak ( ie the pedestal ) .",
    "this means that many pulses are needed and since the laser can only be pulsed at a rate of approximately 10 hz , very long ( order one hour ) runs under dark skies are required to attain required levels of precision ; this results in a significant loss of good observing time .",
    "another issue is that of laser lifetime .",
    "lasers of the type used in the veritas system can only deliver a finite number of pulses before needing a new , expensive , cartridge .",
    "the led flasher was designed in part to address these problems .",
    "its flash rate is limited only by the data acquisition system ( which can handle rates of up to 400 hz ) and it is based on readily available and remarkably low - cost ( less than one dollar each ) leds .    to see if this flasher can be used successfully for single - photoelectron studies we made a 120,000-event run ( 10 minutes at 200 hz ) with the neutral - density filter mounted on a veritas camera .",
    "we then divided the data into subsets according to how many leds were on in an event .",
    "this is required since the underlying assumption of poisson statistics relies on the distribution of light pulse intensities being essentially a delta function . for a given light level",
    "we histogram the pulse sizes for each channel and fit the distribution with the five - parameter function described earlier .",
    "sample plots with fits superimposed are shown in figure  [ spe_1_2 ] .",
    "the left plot is made with data from events where one led was illuminated and the right plot is made with data from events where two leds were illuminated .    as a check on the robustness of the procedure we can compare the single - photoelectron values obtained for the two different light levels .",
    "changing the light level should only change the relative numbers of zero , one , two , etc photoelectrons .",
    "the mean value of the charge distribution created by a single photoelectron should stay the same .",
    "this is demonstrated in figure  [ spe_summary ] where the single - photoelectron means ( @xmath23 ) and standard deviations ( @xmath24 ) for the two light levels are plotted against each other and a strong correlation is observed .        a final check on the procedures can be made by plotting the gain determined using photostatistics ( the slope of the @xmath25 vs @xmath7 plots , as in figure  [ led_slopes ] ) against the gain from the single - photoelectron method .",
    "this is done in figure  [ pe_vs_stats ] .",
    "the left plot shows uncorrected data and the right plot shows the data after the photostatistics values have been been adjusted by two factors .",
    "the first factor is the polya correction referred to in a previous section .",
    "this is ( @xmath26 where @xmath27 ) and @xmath24 is the width of the single - photoelectron peak while @xmath23 is its mean .",
    "the distribution of @xmath17 is shown in figure  [ alpha ] .",
    "the other factor accounts for the increase in gain due the increased high - voltage ( 5% above nominal ) used for the single - photoelectron run in order to increase the separation of the single - photoelectron peak from the pedestal .",
    "the pmt gains have a power - law dependence on high - voltage : @xmath28 .",
    "as can be seen from the figure , the two estimators are correlated but there is a systematic shift from exact correlation .",
    "this can also be seen in figure  [ stat_pe_ratio ] where the ratios of the differences of the two estimators to their sums are plotted .",
    "the mean is at -5% and the standard deviation is 6% .",
    "more work needs to be done to understand this discrepancy but is beyond the scope of this paper .",
    "note that entries in figures  [ spe_summary ] , [ pe_vs_stats ] , and  [ alpha ] rely on fits to pulse - size distributions .",
    "all channels where the fits converged and had a @xmath29 less than 3.0 are included in the plots .",
    "values have been multiplied by the polya correction factor discussed the text ( @xmath26 where @xmath27 ) as well as the factor @xmath30 to account for the boosted high voltage ( 5% higher ) used for the single - photoelectron run .",
    "the solid line is to guide the eye and is not a fit .",
    ", scaledwidth=110.0% ]     where @xmath27 ) discussed in the text .",
    ", scaledwidth=90.0% ]     to their sum .",
    "the fitted gaussian has a mean of -0.05 and standard deviation of 0.06 .",
    ", scaledwidth=90.0% ]",
    "we have developed an led - based flasher system that can be used for all of the tasks currently assigned to the veritas laser system .",
    "in addition it can be run at much higher rates so calibration runs can be carried out more quickly or can benefit from improved statistics for the same length of run .",
    "the led flasher is also much less expensive than a laser and the led system is inherently a distributed one .",
    "a separate light source is installed on each telescope of the array .",
    "this could make it an attractive option for future projects such as agis  @xcite and cta  @xcite where a large number of telescopes distributed over a large area would make a system based on a central laser sending light through optical fibres impractical .",
    "this work has been supported by the natural sciences and engineering research council ( nserc ) .",
    "we are grateful to our colleagues in the veritas collaboration for the use of components of the detector in evaluating our led system ."
  ],
  "abstract_text": [
    "<S> we describe a flasher system designed for use in monitoring the gains of the photomultiplier tubes used in the veritas gamma - ray telescopes . </S>",
    "<S> this system uses blue light - emitting diodes ( leds ) so it can be operated at much higher rates than a traditional laser - based system . </S>",
    "<S> calibration information can be obtained with better statistical precision with reduced loss of observing time . </S>",
    "<S> the leds are also much less expensive than a laser . </S>",
    "<S> the design features of the new system are presented , along with measurements made with a prototype mounted on one of the veritas telescopes . </S>"
  ]
}