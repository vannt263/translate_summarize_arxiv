{
  "article_text": [
    "continuous time stochastic processes based on drift and diffusion between two absorbing boundaries have been used in a wide variety of applications including statistical physics @xcite , finance @xcite , and health science @xcite . in this article , we focus on applications to decision making tasks , where such models have successfully accounted for behavior and neural activity in a wide array of two alternative forced choice tasks , including phenomena such as the speed - accuracy tradeoff and the dynamics of neural activity during decision making in such tasks @xcite . in particular , we will discuss extensions of a specific class of diffusion model referred to as the pure drift diffusion model ( ddm ; eq . below ) , which can be shown to be statistically optimal @xcite .",
    "varieties of diffusion models have been applied within and outside of psychology and neuroscience to elucidate mechanisms for perception , decision - making , memory , attention , and cognitive control ( see reviews in @xcite ) . in the pure ddm ( and related models ) , the state variable @xmath0 is thought to represent the amount of accumulated noisy evidence at time @xmath1 for decisions represented by the two absorbing boundaries , which we refer to as the upper ( + ) and lower ( - ) boundaries .",
    "the evidence @xmath0 evolves in time according to a biased random walk with gaussian increments , which may be written as @xmath2 , and a decision is made at time @xmath3 , the smallest time @xmath1 for which @xmath0 hits either the top boundary ( @xmath4 ) or bottom boundary ( @xmath5 ) . hitting",
    "either of the two boundaries corresponds to making one of two possible decisions at time @xmath3 .",
    "the resulting decision dynamics are thus described by the first passage times of the underlying drift diffusion process . in studying these processes",
    "one is often interested in relating performance metrics such as the mean decision time and error rate ( i.e. the probability of hitting the boundary opposite to the direction of drift ) to empirical data .",
    "for example , one may be interested in studying how actions and cognitive processes might seek to maximize reward rate , which is a simple function of error rate and mean decision time @xcite .",
    "however , not all decisions can be well described by a pure ddm with time - invariant decision parameters .",
    "many decisions may require time - varying drift rates , diffusion rates , and/or thresholds in order to model `` bottom - up '' signals , e.g. sensory processing , or to model `` top - down '' effects , for example , when there are changes in attentional focus or cognitive control @xcite .",
    "in this article , we study performance metrics for such extensions of the ddm , in which model parameters are time - varying . in doing so",
    ", we build on recent work that is focused on similar time - varying random walk models @xcite .",
    "we offer an alternative approach to deriving performance metrics in this setting , including first passage time distributions as well as expected error rates and decision times , and describe how our approach can be applied to the more general class of ornstein - uhlenbeck ( o - u ) processes .",
    "an in - depth discussion of how the present article interfaces with other studies of time - varying ddms is given in section [ sec : conclusion ] .",
    "in this section we recall the pure ddm and introduce the _ multistage drift diffusion model _ ( msddm ) .      the single stage pure ddm  @xcite models human decision making in two alternative forced choice tasks . the ddm models the evolution of the evidence for decision making using the following stochastic differential equation ( sde ) : @xmath6 where parameters @xmath7 and @xmath8 are constants referred to as the drift and diffusion rate , respectively ; @xmath9 is the initial condition ( the starting point of the decision process ) , and @xmath10 are independent wiener increments with variance @xmath11 .",
    "the pure ddm   models a decision process in which an agent is integrating noisy evidence until sufficient evidence is gathered in favor of one of the two alternatives .",
    "a decision is made when the evidence @xmath0 crosses one of the two symmetric decision thresholds @xmath12 for the first time ( also referred to as its _ first passage time _ ) .",
    "in other words , the decision time is the first passage time of the drift diffusion process   with respect to the set of points within boundaries @xmath12 .",
    "we will use the terms _ correct _ and _ incorrect _ to refer to responses that cross the threshold of equivalent or opposite sign of the drift rate for the decision process .",
    "for instance , if @xmath13 , a correct decision is one for which threshold @xmath14 is crossed first ; conversely , an incorrect response refers to the case in which threshold @xmath15 was crossed first .",
    "accordingly , we refer to the probability of crossing the negative threshold in this case as the _ error rate _ and the time at which the decision variable crosses one of the thresholds as the _ decision time_.    the  pure \" ddm contrasts with ratcliff s ( 1978 )  extended \" ddm , in which the drift rates and the initial conditions across trials in an experimental session are assumed to be random variables drawn from stationary distributions",
    ". this paper will focus entirely on analyses of the former model , ( as well as its applications to ornstein - uhlenbeck processes ) .",
    "note also that the parameterization we use for the pure ddm is different from those in some other cases , e.g. , @xcite , although the underlying model is equivalent .",
    "the ddm has been extremely successful in explaining behavioral and neural data from two alternative forced choice tasks . however , its basic assumption  that model parameters such as drift rate and threshold remain constant throughout the decision process  is unlikely to hold in a number of cases .",
    "for instance , in several experimental ( and real - world ) contexts the quality of evidence is not stationary ( i.e. , the drift rate and possibly even the diffusion rate are not a constant function of time ) or decision urgency leads thresholds to decay with time .    for purposes of modeling situations described above , we introduce an extension of the ddm , the msddm , which is a generalization of the two stage process considered in @xcite . in an msddm , the drift rate , the diffusion rate , and the thresholds are piecewise constant functions of time .",
    "to implement an msddm , we partition the set of non - negative real numbers ( time axis ) into @xmath16 sets @xmath17 , \\ ;",
    "i\\in { \\{1,\\dots , n\\}}$ ] with @xmath18 and @xmath19 .",
    "we then assume that the drift rate , the diffusion rate , and the decision thresholds are constant within each interval , but that their values may be different for different intervals . in particular , the evidence integration in the msddm is modeled by @xmath20 where @xmath21 for each @xmath22 .",
    "note that for @xmath23 , the msddm reduces to the pure ddm .",
    "for simplicity of presentation , we first consider the case with constant decision thresholds at @xmath12 . in section [ sec :",
    "thresholds ] , we describe how to incorporate piecewise constant time - varying thresholds into the msddm .",
    "we will frequently refer to the @xmath24-th stage ddm of the msddm . for @xmath25 ,",
    "it is written as @xmath26 the initial condition is now a random variable @xmath27 defined as @xmath28 conditioned on no decision until time @xmath29 , i.e. , the density of @xmath27 is the conditional distribution of @xmath28 given that @xmath30 .",
    "thus , the random variable @xmath27 corresponds to realizations of the msddm that remain within the thresholds @xmath12 until time @xmath29 .",
    "note that @xmath31 is a point mass distribution centered at @xmath9 .",
    "we introduce the following notations throughout this paper :    * @xmath32 , the first passage time for the entire multistage process * @xmath33 , the first passage time for the @xmath24-th stage ddm  .",
    "* @xmath34 , and @xmath35 . *",
    "@xmath36 , the @xmath24-th stage signal to noise square ratio .",
    "in this section we derive first passage time ( fpt ) properties of the msddm . at a higher level ,",
    "our approach can be summarized as follows :    the msddm can be viewed as a cascade of @xmath16 modified ddms in which for each stage of the cascade , the initial condition is a random variable and only the decisions made before a deadline are considered . for the @xmath24-th stage ddm with a known distribution of initial condition @xmath27 , we derive ( i ) properties of the fpt conditioned on a decision before the deadline @xmath37 , and ( ii ) distribution of @xmath38 , i.e. , the distribution of @xmath39 conditioned on the fpt for the @xmath24-th stage ddm greater than @xmath37 .",
    "we then use these properties sequentially for @xmath22 to determine fpt properties during each stage .",
    "finally , we aggregate fpt properties at each stage to compute fpt properties for the msddm as a whole , that is , for the properties of the fpt that are not conditioned on the stage .    in the following , we first recall fpt properties for the pure ddm .",
    "we then use these properties , together with tools from martingale theory , to derive fpt metrics for the modified @xmath24-th stage ddm described above .",
    "finally , we use total probability formulae to merge these metrics and obtain fpt metrics for the msddm . throughout this section",
    ", we assume the decision threhsolds are fixed at @xmath12 , the number of stages is @xmath16 , and @xmath40 .",
    "we first review some well known results for the pure ddm , which is equivalent to a 1-stage msddm . without loss of generality ,",
    "we assume that the drift rate @xmath41 . recall that @xmath42 and @xmath43 .",
    "for the 1-state msddm :    a.   the error rate @xmath44 is @xmath45 throughout the remainder of the section , for brevity , we let @xmath46 .",
    "b.   the mean decision time @xmath47 is given by @xmath48 = \\expt[\\tau_1 ] = \\begin{cases }      \\frac{(1 - 2 \\er ) z -x_0}{a_1 } , & \\quad \\text{if } a_1 > 0 , \\\\",
    "\\frac{z^2 -x_0 ^ 2}{\\sigma_1 ^ 2 } , & \\quad \\text{if } a_1 = 0 .",
    "\\end{cases}\\ ] ] c.   the first passage time density @xmath49 , i.e. , the probability density function of the decision time is @xmath50 where @xmath51 d.   the expected decision time conditioned on the correct response @xmath52 and the expected decision time conditioned on the incorrect response @xmath53 are @xmath54 where @xmath55 $ ] and @xmath56 is the indicator function .",
    "+ note that @xmath52 corresponds to the average decision time computed by dividing the sum of decision times associated with the correct decision by the instances of such decisions ; while @xmath57 corresponds to the average decision time computed by dividing the sum of decision times associated with the correct decision by the instances of all ( correct and incorrect ) decisions . @xmath53 and @xmath58 are computed analogously .",
    "e.   the first passage time density conditioned on a particular decision is given by @xmath59 where @xmath60 , i.e. , @xmath61 is the probability of the event @xmath62 and @xmath63 .",
    "note that @xmath64 defined in   is the sum of @xmath65 and @xmath66 .",
    "f.   the joint density @xmath67 of the evidence @xmath0 and the event @xmath68 is @xmath69 where @xmath70 is the indicator function .",
    "+ the joint density @xmath71 can also be used to determine the fpt distribution by integrating it over the range of @xmath72 .",
    "more importantly , dividing @xmath71 by @xmath73 yields the conditional density on the evidence @xmath0 conditioned on no decision until time @xmath1 .",
    "this is critical for the analysis of the msddm . in particular",
    ", we use a slight modification of @xmath71 at the @xmath24-th stage to determine the density of the initial condition @xmath38 for the @xmath74-th stage .",
    "various derivations for the error rate , decision time , and fpt densities may be found in the decision making literature @xcite . in the probability literature",
    ", the expressions for the error rate and the expected decision time may be derived using a differential equation approach  @xcite or a martingale - based approach  @xcite . under the latter ,",
    "the fpt densities are found by first determining the laplace transform by constructing an appropriate martingale  @xcite . taking the inverse laplace",
    "transforms yields the conditional fpt densities .",
    "the negative of the derivative of the laplace transform with respect to the frequency yields the conditional mean decision times .",
    "the final statement is derived by repeatedly applying the reflection principle , followed by the cameron - martin formula  @xcite .",
    "formulas for the laplace transform are given in [ app : ddm ] .",
    "it is worth noting that the infinite series solutions for the fpt given in   are equivalent to the small - time representations for the fpt analyzed in @xcite .",
    "for completeness we also state the large - time representation that can be obtained by solving the fokker - planck equation @xcite : @xmath75 the small - time and the large - time representations mean that the associated series has nice convergence properties ( e.g. , monotonicity ) for small and large values of decision times , respectively .      in this section",
    "we analyze the @xmath24-th stage ddm .",
    "recall from above that @xmath27 is the random variable @xmath28 conditioned on the event @xmath30 , and that @xmath76 is the fpt conditioned on the event @xmath30 .    for the @xmath24-th ddm ,",
    "the initial condition is @xmath27 and only decisions made before the deadline @xmath37 are relevant . for the analysis of such a system , the two key ingredients are the density of @xmath27 and the density of the fpt @xmath76 .",
    "conditioned on a realization of @xmath27 , the density of @xmath38 can be computed using  .",
    "if the density of @xmath27 is known , then the unconditional density of @xmath38 can be obtained by computing the expected value of the conditional density of @xmath38 with respect to @xmath27 .",
    "since the density of @xmath31 is known , this procedure can be recursively applied to obtain densities of @xmath27 , for each @xmath77 .",
    "formally , the joint density @xmath78 of the evidence @xmath39 and the event @xmath79 is    @xmath80 , \\end{aligned}\\ ] ]    where @xmath81 $ ] denotes the expected value with respect to @xmath27 . the density of @xmath38 , i.e. , @xmath39 conditioned on @xmath82 is determined by dividing @xmath83 by @xmath84 which can be computed by integrating @xmath83 over the range of @xmath39 .",
    "note that the parameters in @xmath83 are @xmath9 and @xmath85 ; this highlights the fact that the distribution of @xmath38 depends on all previous stages .",
    "similarly , the fpt density for the @xmath24-th stage ddm conditioned on a realization of @xmath27 can be computed using  , and the unconditional density can be obtained by computing the expected value of the conditional density with respect to @xmath27 .",
    "formally , the fpt density for @xmath24-th stage ddm @xmath86 is @xmath87,\\ ] ] where @xmath88 . the cumulative distribution function @xmath89 is obtained by integrating @xmath86 . note that every trajectory crossing the decision threshold before @xmath90 does so irrespective of the deadline at @xmath37 .",
    "thus , the expression for density @xmath91 does not depend on @xmath37 .",
    "we are now ready to establish performance metrics for the @xmath24-th ddm .",
    "the detailed derivations of the expressions presented in this section are contained in [ app : ddm - i ] .",
    "a.   the error rate during the @xmath24-th stage @xmath92 , i.e. , the probability of an incorrect decision given that a response is made during the @xmath24-th stage , @xmath93 , is @xmath94 - \\expt_{x_i } [ e^{-2s_i x_i } ] \\prob ( \\tau_i > t_i )   - e^{-2s_i z } \\prob(\\tau_i \\le t_i ) } { ( e^ { 2s_i z } - e^{-2s_i z } ) \\prob(\\tau_i \\le   t_i ) } , & \\text { if } a_i > 0 , \\\\   \\displaystyle \\frac{1}{2 } - \\frac{(\\expt_{x_{i-1}}[x_{i-1 } ] - \\expt_{x_i}[x_i ] \\prob(\\tau_i > t_i))}{2 z \\prob(\\tau_i \\le t_i ) } , & \\text { if } a_i=0 .   \\end{cases}\\end{aligned}\\ ] ] in the following we drop the arguments of @xmath92 and refer it by @xmath95 .",
    "b.   the joint fpt density for the @xmath24-th stage ddm and a given response @xmath96 is @xmath97 \\label{eq : fpt - density - correct } \\\\",
    "f^-_i(t;x_0,\\theta_{1:i } ) & = \\frac{d}{dt}\\prob ( \\tau_i   \\le   t \\ ; \\ & \\ : x(\\tau_i ) = -z ) = \\expt_{x_{i-1 } } [ f^-(t - t_{i-1};x_{i-1},\\theta_i ) ] , \\label{eq : fpt - density - incorrect}\\end{aligned}\\ ] ] where the functions @xmath98 are taken from  and  .",
    "c.   the mean decision time given that a response is made during the @xmath24-th stage @xmath99 is @xmath100 \\nonumber\\\\ \\label{eq : decision - time - deadline } & =   \\begin{cases } t_{i-1 } +    \\frac{(1 - 2 \\er_i)z   \\prob(\\tau_i \\le t_i )   - \\expt_{x_{i-1 } } [ x_{i-1 } ] + \\expt_{x_i}[x_i ] \\prob(\\tau_i   >",
    "t_i ) - a_i ( t_i -t_{i-1 } ) \\prob(\\tau_i > t_i)}{a_i \\prob(\\tau_i \\le t_i ) } , & \\text { if } a_i > 0 , \\\\   t_{i-1 } +   \\frac{z^2 \\prob(\\tau_i \\le t_{i } ) - \\expt_{x_{i-1}}[x_{i-1}^2 ] + \\expt_{x_i}[x_i^2 ] \\prob(\\tau_i > t_i ) - \\sigma_i^2 ( t_i - t_{i-1})\\prob(\\tau_i > t_i)}{\\sigma_i^2 \\prob(\\tau_i \\le t_i ) } , & \\text { if } a_i=0 .",
    "\\end{cases}\\end{aligned}\\ ] ] d.   the expected decision time conditioned on a particular response made during the @xmath24-th stage is @xmath101 = & \\frac{\\hat{\\dt}_i^+(x_0,\\theta_{1:i})}{(1-\\er_i ) \\prob(\\tau_i",
    "\\le t_i)}\\nonumber \\\\ = & \\frac{1}{{(1-\\er_i ) \\prob(\\tau_i \\le t_i ) } } \\big ( t_{i-1 }   \\prob(x(\\tau_i)=z ) +   \\expt_{x_{i-1}}[\\hat{\\dt}^+(x_{i-1},\\theta_i ) ]   \\nonumber\\\\ \\label{eq : decision - time - correct - deadline } & - \\expt_{x_i}[\\hat{\\dt}^+(x_{i},\\theta_i ) ]   \\prob ( \\tau_i > t_i ) + t_i \\prob(x(\\tau_i ) = z \\ ; \\&\\ ; \\tau_i > t_i )   \\big)\\end{aligned}\\ ] ] @xmath102 = & \\frac{\\hat{\\dt}^-_i(x_0,\\theta_{1:i } ) } { \\er_i \\prob(\\tau_i \\leq t_i)}\\nonumber \\\\ \\label{eq : decision - time - incorrect - deadline } = & \\frac{1}{{\\er_i \\prob(\\tau_i \\le t_i ) } } \\big ( t_{i-1 }   \\prob(x(\\tau_i)=-z ) + \\expt_{x_{i-1}}[\\hat{\\dt}^-(x_{i-1},\\theta_i ) ]   \\nonumber\\\\ & - \\expt_{x_i } [ \\hat{\\dt}^-(x_i,\\theta_i ) ]   \\prob ( \\tau_i > t_i)+ t_i \\prob(x(\\tau_i ) = -z \\ ; \\&\\ ; \\tau_i > t_i)\\big),\\end{aligned}\\ ] ] where @xmath103 $ ] , @xmath104 is calculated using  and  , @xmath105 is calculated using  , and @xmath106 is calculated using  and  .",
    "we now use the fpt properties of the @xmath24-th ddm derived in ",
    "[ subsec : i - ddm ] to derive fpt properties of the msddm . in particular",
    ", we view the msddm as a cascade of modified ddms in which the initial condition is a random variable and only the decisions made before a deadline are considered .",
    "given an initial condition of @xmath9 , we sequentially compute all of the distributions of the initial conditions @xmath38 for each @xmath22 using  .",
    "then , we compute the properties of the fpt associated with the @xmath24-th stage ddm .",
    "finally , we use the total probability formula to aggregate properties of these ddms to compute fpt properties of the msddm .",
    "we now describe the fpt properties of the msddm  .",
    "the derivations of these expressions are contained in  [ app : mult - ddm ] .",
    "a.   for @xmath107 $ ] , for some @xmath108 , the fpt distribution for the msddm is @xmath109 note that @xmath110 and @xmath111 .",
    "b.   the expected decision time for the msddm is @xmath112   & =   \\sum_{i=1}^n \\big(\\expt[\\tau_i | \\tau_i \\le   t_i ]   \\prob ( \\tau_i \\le   t_i ) \\prod_{j=1}^{i-1 } \\prob(\\tau_j > t_i ) \\big ) \\nonumber\\\\ \\label{eq : multistage - dt } & =   \\sum_{i=1}^n \\big(\\dt_i(x_0,\\theta_{1:i } )   \\prob ( \\tau_i \\le   t_i ) \\prod_{j=1}^{i-1 } \\prob(\\tau_j > t_i ) \\big).\\end{aligned}\\ ] ] note that the expected decision time is the weighted sum of the expected decision times for the ddms at each stage and the weight is the probability of the decision in that stage . c.   the error rate for the msddm is @xmath113 similar to the case of the expected decision time , the error rate is the weighted sum of the error rates during each stage .",
    "d.   the expected decision time conditioned on a particular decision is @xmath114   & =   \\frac{1}{1-\\er}\\sum_{i=1}^n \\big ( \\expt[\\tau_i | x(\\tau_i)=z \\ ; \\&\\ ; \\tau_i \\le   t_i ]   ( 1- \\er_i)\\prob ( \\tau_i \\le   t_i ) \\prod_{j=1}^{i-1 } \\prob(\\tau_j > t_i ) \\big ) \\\\ \\label{eq : multistage - dt - incorrect } \\expt[\\tau | x(\\tau ) = -z ]   & = \\frac{1}{\\er } \\sum_{i=1}^n \\big ( \\expt[\\tau_i | x(\\tau_i)=z \\ ; \\&\\ ; \\tau_i \\le   t_i ]   \\er_i \\prob ( \\tau_i \\le   t_i ) \\prod_{j=1}^{i-1 } \\prob(\\tau_j > t_i ) \\big).\\end{aligned}\\ ] ] note that @xmath115   \\er_i   = \\expt[\\tau_i \\bs 1 ( x(\\tau_i)=z ) |",
    "\\tau_i \\le   t_i ] $ ] and @xmath116 .",
    "e.   for @xmath107 $ ] , for some @xmath117 , the fpt distribution conditioned on a particular decision is @xmath118 note that @xmath119 and @xmath120 .",
    "for clarity of exposition , the argument leading to results in  [ sec : performance - metrics ] assumes the same thresholds for each stage .",
    "now suppose that the thresholds for the @xmath24-th stage ddm are @xmath121 .",
    "the case of the same thresholds in  [ sec : performance - metrics ] is then the specialization @xmath122 for each @xmath77 .",
    "suppose that @xmath123 is smaller than @xmath124 .",
    "then the probability of instantaneous absorbtion into the top boundary at @xmath37 is found by integrating from @xmath123 to @xmath124 .",
    "likewise , the probability of instantaneous absorbtion into the bottom boundary at @xmath37 is determined by integrating from @xmath125 to @xmath126 .",
    "the density of @xmath38 is then found by truncating the support of the density in to @xmath127 and normalizing the truncated density . in the cases where @xmath128",
    ", there is no instantaneous absorbtion , and the density of @xmath38 is found by extending of the density in , assigning zero density to the previously undefined support . in all cases , the new , updated @xmath38",
    "may be used for computations dealing with the @xmath74-th stage of the msddm .",
    "in this section we study fpt properties of an o - u process with piecewise constant parameters . similarly to the msddm , the @xmath16-stage o - u process is defined by @xmath129 where @xmath130 for each @xmath22 .",
    "the multistage o - u process is obtained from the multistage drift - diffusion process by adding a term @xmath131 , i.e. , the o - u process is a leaky integrator , while the drift - diffusion process is a perfect integrator . in this section ,",
    "we compute an approximation of the distribution for the fpt for the o - u process   defined by @xmath132 , where @xmath12 are predefined thresholds .",
    "first , we show that a @xmath133-stage o - u process can be written as a transformation of the wiener process , and then use this transformation to write the fpt problem for the o - u process as a fpt problem for the wiener process with time - varying thresholds . finally , we approximate the time - varying thresholds with piecewise constant time - varying thresholds to compute the approximate fpt distribution of the o - u process and use it to recursively compute the fpt distribution of the multistage o - u process .",
    "consider the @xmath133-stage o - u process @xmath134 it is known  @xcite that the solution to   is @xmath135 define the transformed time @xmath136 .",
    "equivalently , @xmath137 .",
    "thus , @xmath138 therefore , if @xmath139 , we have @xmath140 .",
    "consequently , the fpt for @xmath0 with respect to thresholds @xmath12 is homeomorphic to the fpt of a wiener process starting at @xmath9 and evolving on a transformed time @xmath141 with respect to time - varying thresholds @xmath142 .",
    "since @xmath141 is a monotonically increasing function , the fpt distribution @xmath3 is readily obtained from @xmath143 , the fpt distribution of the wiener process . also , the error rates for the two processes are also the same .",
    "the computation of fpt distribution for the wiener process with time - varying thresholds is , in general , not analytically tractable .",
    "however , the time - varying thresholds can be approximated by piecewise constant time - varying thresholds and approximate fpt distributions can be computed using the msddm . while the thresholds @xmath144 are asymmetric in this setting , unlike in the case described for the msddm , such a case can be easily handled by replacing the expression in  and   with corresponding expressions for asymmetric thresholds ( see @xcite ) .",
    "the solution to the multistage o - u process   for @xmath145 is @xmath146 let @xmath147 .",
    "also , let @xmath76 and @xmath27 , @xmath22 be defined similarly to the msddm .",
    "then , conditioned on a realization of @xmath27 , the fpt problem of the @xmath24-th stage o - u process can be equivalently written as the fpt problem of the wiener process @xmath148 with respect to thresholds @xmath149 if the distribution of @xmath27 is known , then , analogous to the case of msddm , the distribution of @xmath150 can be computed . however , in this case the distribution will be approximately computed using an msddm for the @xmath24-th stage o - u process .",
    "furthermore , analogous to the msddm , the distribution of @xmath151 conditioned on @xmath82 can also be computed , which in conjunction with   yields the distribution of @xmath38 . then , a recursive procedure akin to the msddm yields the approximate fpt distribution for the multistage o - u process .",
    "in this section we discuss the application of the expressions derived in  [ sec : performance - metrics ] for experiments involving time pressure or changes in attention over the course of decision process , and for optimizing the speed - accuracy trade - off using the reward rate .",
    "we compare the theoretical predictions obtained from the analysis in this paper with the numerical values obtained through monte - carlo simulations .",
    "the simulation results in this section were obtained using @xmath152 monte carlo runs .",
    "the diffusion models were simulated using the euler - maruyama method with step size @xmath153 .",
    "codes used to produce all figures may be found at ` https://github.com/princetonuniversity/msddm `      consider the msddm   with two stages , i.e. , @xmath154 .",
    "for such a two stage ddm , the following expressions for the error rate and the expected decision time can be computed using the theory in  [ sec : performance - metrics ] : @xmath155 where @xmath156 \\prob(\\tau_1 > t_1 ) -e^{-2s_1 z }",
    "\\prob(\\tau_1 \\le t_1)}{(e^{2k _ 1 z }   -e^{-2s_1 z } ) \\prob(\\tau_1 \\le t_1 ) } , \\\\",
    "\\er_2 & = \\frac{\\expt[e^{-2 s_2   x_1 } ] - e^{-2s_2 z}}{e^{2s_2 z } - e^{-2s_2 z } } , \\end{aligned}\\ ] ] and @xmath112 = \\frac{(1 - 2 \\er_1)z   \\prob(\\tau_1 \\le t_1)- x_0 + \\expt[x_1 ]   \\prob(\\tau_1 > t_1)}{a_1 }   +   \\frac{(1 - 2 \\er_2 ) z - \\expt[x(t_1)]}{a_2 } \\prob(\\tau_1 > t_1).\\end{aligned}\\ ] ]      to illustrate the expressions derived in ",
    "[ sec : performance - metrics ] , we consider a four stage msddm .",
    "the drift rates and diffusion rates in each stage are @xmath157 and @xmath158 , respectively",
    ". let the stage initiation times be @xmath159 and the initial condition be @xmath160 .",
    "the fpt of the unconditional and conditional decision time for @xmath161 obtained using analytic expressions and monte - carlo simulations is shown in figure  [ fig : fpt - dist ] .",
    "similarly , the error rate , expected overall decision times , and expected decision times conditional on which threshold was crossed obtained using analytic expressions and monte - carlo simulations are shown in figure  [ fig : decision - time ] as a function of threshold @xmath162 .",
    "one potential application of these analyses is to describe situations in which evidence accumulation changes dynamically with the decision - maker s changing focus of attention .",
    "for instance , krajbich and colleagues ( 2010 ) have shown that the process of weighing two value - based options ( e.g. , foods ) can be modeled with a ddm in which drift rates vary during the decision process based on the option being attended to at any given moment .",
    "we consider such a case using a @xmath163-stage ddm in which the drift rates @xmath133 and @xmath164 alternate ( i.e. , @xmath165 , @xmath166 , @xmath167 , @xmath168 ) to capture a situation in which the decision maker s attention alternates between two options , one of which has greater perceived value ( higher drift rate ) than the other .",
    "let @xmath169 and the remaining @xmath170 stage initiation times be randomly and uniformly selected between @xmath171 .",
    "assume @xmath172 , @xmath161 , and let the diffusion rate be stationary and equal to unity .",
    "the unconditional and conditional fpt distributions in this scenario obtained using the analytic expressions and using monte - carlo simulations are shown in  figure  [ fig : krajbich ] .",
    "-stage ddm with alternating drift rate .",
    "the drift rates are @xmath173 , diffusion rate at each stage is unity , the threshold @xmath161 , and stage initiation times are chosen randomly in the interval @xmath174 .",
    "[ fig : krajbich],scaledwidth=70.0% ]      these analyses can also be applied to situations in which changes in evidence accumulation occur gradually over time .",
    "for instance , white and colleagues ( 2011 ) proposed a  shrinking spotlight \" model of the eriksen - flanker task , a task in which participants responding to the direction of a central arrow are influenced by the direction of arrows in the periphery ( see also @xcite ) . according to these models ,",
    "evidence accumulation is initially influenced by all of the arrows ( central as well as flankers , which may drive an incorrect response ) but as the attentional spotlight narrows the drift rate is gradually more influenced by the central arrow alone .",
    "we now consider such a situation , using a @xmath175-stage ddm as an approximation to the ddm with time - varying drift rate .",
    "assume that the diffusion rate is constant and equal to unity .",
    "let @xmath176 , @xmath161 , and stage initiation times be uniformly selected in the interval @xmath177 $ ] .",
    "let the drift rate in the @xmath24-th stage be @xmath178 .",
    "the unconditional and conditional fpt distributions for such a @xmath175-stage ddm obtained using the analytic expressions and using monte - carlo simulations are shown in figure  [ fig : gradual - time - varying ] .",
    "-stage ddm with gradually increasing drift rate .",
    "the drift rate for the @xmath24-th stage is @xmath179 , diffusion rate at each stage is unity , the threshold @xmath161 , and stage initiation times are chosen uniformly in the interval @xmath180 $ ] .",
    "[ fig : gradual - time - varying],scaledwidth=70.0% ]      analogously to the previous section , one might also be interested in modeling a decision process in which thresholds are dynamic rather than uniform across stages .",
    "this can be used to describe discrete changes in choice strategy , or a continuous change in thresholds over time , e.g. , collapsing boundaries ) ; the latter approach has been successful at describing behavior under conditions that either involve an explicit response deadline ( e.g. ,  @xcite ) or where there is an implicit opportunity cost for longer time spent accumulating evidence  @xcite .",
    "we model such a situation , using a @xmath175-stage ddm as an approximation to the ddm with collapsing threshold .",
    "assume that the drift rate and the diffusion rate are constant and equal to @xmath181 and @xmath133 , respectively .",
    "let @xmath176 , and stage initiation times be uniformly selected in the interval @xmath177 $ ] .",
    "let the threshold in the @xmath24-th stage be @xmath182 .",
    "the unconditional and conditional fpt distributions for such a @xmath175-stage ddm obtained using the analytic expressions and using monte - carlo simulations are shown in figure  [ fig : collapsing - threshold ] .",
    "-stage ddm with collapsing thresholds .",
    "the drift rate and diffusion rate at each stage are @xmath181 and @xmath133 , respectively .",
    "the stage initiation times are chosen uniformly in the interval @xmath180 $ ] , and the threshold at @xmath24-th stage is @xmath182 . [",
    "fig : collapsing - threshold],scaledwidth=70.0% ]      so far , we have assumed that the thresholds for decision - making are known and we have characterized the associated error rate and first passage time properties .",
    "the choice of threshold dictates the speed - accuracy trade - off , i.e. , the trade - off between a fast decision and an accurate decision .",
    "this joint function of speed and accuracy is believed to be critical to how animals choose to set and adjust their threshold .",
    "in particular , it has been proposed  @xcite that human subjects choose a threshold that maximizes the reward rate defined by @xmath183 + { t_{\\textup{nd}}}},\\ ] ] where @xmath184 is the sensory and motor processing time ( non - decision time ) and @xmath185 and @xmath186 $ ] are computed using the expressions derived in ",
    "[ sec : performance - metrics ] .",
    "we now investigate the reward rate as a function of the threshold for a two - stage ddm .",
    "we assume that the threshold is the same for the two stages .",
    "the reward rate for the pure ddm as shown in figure  [ fig : rr - pure - ddm ] is a unimodal function .",
    "in contrast , the reward rate for the two - stage ddm can be a bimodal function , as shown in figure  [ fig : rr-2-ddm ] .",
    "the bimodality of the reward rate leads to peculiar behavior of the optimal threshold as @xmath187 and @xmath188 are varied , as shown in figure  [ fig : opt - thresh - rr ] . in figure",
    "[ fig : opt - thresh - rr ] , we fix @xmath189 , @xmath190 , @xmath176 , and @xmath191 and study the effect of the drift rate @xmath187 and the switching time @xmath188 on the optimal threshold that maximizes the reward rate . for a given @xmath187 , the optimal threshold first increases as @xmath188",
    "is increased and then jumps down at a critical @xmath188 .",
    "the jump is attributed to the fact that one of the peaks in the bimodal function increases with @xmath188 , while the other decreases . at the critical @xmath188 , the global maximum switches from one peak to the other .",
    "the reward rate for the multistage ddm is a univariate function of the threshold and the globally optimal threshold can be efficiently determined using algorithms in  @xcite . however , compared to the algorithms for the maximization of unimodal functions , these algorithms require additional information . in particular , an upper bound on the slope of the reward rate over the domain of interest is needed to implement these algorithms .",
    "-stage ddm obtained by maximizing reward rate .",
    "the left panel shows the variation of the optimal threshold as a function of @xmath188 and @xmath187 .",
    "the other parameters are @xmath189 , @xmath190 , and @xmath176 . the right panel shows the asscoiated contour plot .",
    "the regions of the contour plot associated with @xmath169 and @xmath192 correspond to the pure ddm .",
    "[ fig : opt - thresh - rr],title=\"fig:\",scaledwidth=49.5% ] -stage ddm obtained by maximizing reward rate .",
    "the left panel shows the variation of the optimal threshold as a function of @xmath188 and @xmath187 .",
    "the other parameters are @xmath189 , @xmath190 , and @xmath176 .",
    "the right panel shows the asscoiated contour plot .",
    "the regions of the contour plot associated with @xmath169 and @xmath192 correspond to the pure ddm .",
    "[ fig : opt - thresh - rr],title=\"fig:\",scaledwidth=49.5% ]",
    "[ sec : conclusion ] we have analyzed in detail the fpt properties of the multistage drift diffusion model , which is a wiener diffusion model with piecewise time - varying drift rate , noise parameter , and decision thresholds . @xcite studied the two stage version of the msddm with constant thresholds and described a procedure for how to compute the fpt density . here",
    ", we have extended this result to @xmath16-stages and time - varying thresholds , which required relaxing the assumption that the initial condition @xmath9 is a point mass .",
    "indeed , the initial condition of the @xmath24-th ddm is not a deterministic quantity but is a random variable .",
    "furthermore , rather than requiring integration over fpt density to obtain conditional and unconditional expected decision times and error rates , our martingale - based approach allows for direct computation of these quantities .",
    "another major contribution of the paper is to show how various other performance metrics , such as the error rate during each stage , evolve as the underlying dynamics change . using these",
    ", one may compute a variety of behavioral performance metrics , without resorting to first computing the fpt densities .",
    "we also independently derived the fpt density for the msddm .",
    "the calculations in  [ sec : performance - metrics ] are relatively straightforward to implement , and code for doing so is available online , along with code that reproduces the figures in this article .",
    "it is important to note , however , the other highly optimized software packages for computing fpt statistics for time - varying diffusion models .",
    "one such package in this domain is that of @xcite , which solves an integral equation ( code for this is available online @xcite ) .",
    "@xcite introduced a matrix based approach , similar to markov chain monte - carlo methods , to efficiently implement and analyze performance metrics for a variety of extensions of the ddm .",
    "the matrix approach has been used to analyze multistage processes associated with multiattribute choice @xcite . also relevant",
    "is the paper of @xcite , which develops an efficient numerical algorithm for estimating parameters of the time - varying diffusion model from reaction time data ( i.e. , first passage times ) .",
    "more recently , very fast codes for a broad class of diffusion models have been developed by @xcite , with implementations on both cpus and gpus for considerable performance increases .",
    "compared to these previous efforts , our work is not immediately focused on developing a rapid numerical tool for simulation , but rather introducing martingale theory as a useful approach for understanding and analyzing ddms with multiple stages .",
    "thus , the codes released with this report are not intended to compete with the efficiency of the aforementioned codes , which have been highly optimized and tuned for throughput , but instead demonstrate the simplicity and effectiveness of our analysis .",
    "this said , our results do suggest promising avenues for future numerical work . particularly relevant",
    "is work by @xcite who develop efficient numerical schemes for evaluating the relevant infinite sums involved in fpt calculations .",
    "similar methods could be applied to results in  [ subsec : i - ddm ]  and   [ subsec : multistage - ddm ] to develop efficient and accurate msddm codes , which could in turn contribute to the growing collection of numerical tools available for practitioners using diffusion models to study decision making .",
    "our results may also serve as a starting point for further analysis of more complicated stochastic decision models . as an important step in this direction ,",
    "we have also shown how the equations for the msddm can be applied to ornstein - uhlenbeck processes , which can approximate leaky integration over the course of evidence accumulation , e.g. , the leaky competing accumulator model [ lca ]  @xcite .",
    "given that the lca itself can in certain cases approximate a reduced form of more complex and biologically plausible models of interactions across neuronal populations ( e.g. , @xcite ) , our analyses offer an important step toward better understanding time - varying dynamics within and across neural networks , and how these might explain complex cognitive phenomena .",
    "more broadly , we believe our analysis furthers the theory surrounding diffusion models with time - varying drift rates , and that the tools and formulae introduced will contribute to the ongoing effort to develop and understand psychologically and neurally plausible models of decision making .",
    "we thank ryan webb for the reference to smith 2000 and associated code .",
    "we thank phil holmes and patrick simen for the helpful discussions and comments .",
    "this work was funded by the c.v .",
    "starr foundation ( a.s . ) .",
    "and n.e.l . have been supported in part by onr grants n00014 - 14 - 1 - 0635 , aro grant w911nf-14 - 1 - 0431 and the insley - blair pyne fund .",
    "45 natexlab#1#1url # 1`#1`urlprefix    blurton , s.  p. , kesselmeier , m. , gondan , m. , 2012 .",
    "fast and accurate calculations for cumulative first - passage time distributions in wiener diffusion models .",
    "journal of mathematical psychology 56  ( 6 ) , 470475 .",
    "bogacz , r. , 2007 .",
    "optimal decision - making theories : linking neurobiology with behaviour .",
    "trends in cognitive sciences 11  ( 3 ) , 118125 .    bogacz , r. , brown , e. , moehlis , j. , holmes , p.  j. , cohen , j.  d. , 2006 .",
    "the physics of optimal decision making : a formal analysis of models of performance in two - alternative forced - choice tasks .",
    "psychological review 113  ( 4 ) , 700765 .    borodin , a.  n. , salminen , p. , 2002 .",
    "handbook of brownian motion : facts and formulae .",
    "springer .",
    "brunton , b.  w. , botvinick , m.  m. , brody , c.  d. , 2013 .",
    "rats and humans can optimally accumulate evidence for decision - making .",
    "science 340  ( 6128 ) , 9598 .",
    "cox , d.  r. , miller , h.  d. , 1965 .",
    "the theory of stochastic processes .",
    "methuen & co. ltd .",
    "diederich , a. , busemeyer , j.  r. , 2003 .",
    "simple matrix methods for analyzing diffusion models of choice probability , choice response time , and simple response time .",
    "journal of mathematical psychology 47  ( 3 ) , 304  322 .    diederich , a. , oswald , p. , 2014 .",
    "sequential sampling model for multiattribute choice alternatives with random attention time and processing order .",
    "frontiers in human neuroscience 8  ( 697 ) , 113 .",
    "douady , r. , 1999 .",
    "closed form formulas for exotic options and their lifetime distribution .",
    "international journal of theoretical and applied finance 2  ( 1 ) , 1742 .",
    "drugowitsch , j. , 2014 .",
    "c++ diffusion model toolset with python and matlab interfaces .",
    "github repository : https://github.com/jdrugo/dm , commit : 5729cd891b6ab37981ffacc02d04016870f0a998 .",
    "drugowitsch , j. , moreno - bote , r. , churchland , a.  k. , shadlen , m.  n. , pouget , a. , 2012 .",
    "the cost of accumulating evidence in perceptual decision making .",
    "the journal of neuroscience 32  ( 11 ) , 36123628 .",
    "durrett , r. , 2010 .",
    "probability : theory and examples .",
    "cambridge university press .",
    "farkas , z. , fulop , t. , 2001 .",
    "one - dimensional drift - diffusion between two absorbing boundaries : application to granular segregation .",
    "journal of physics a : mathematical and general 34  ( 15 ) , 31913198 .",
    "feller , w. , 1968 .",
    "an introduction to probability theory and its applications .",
    "vol .  1 .",
    "john wiley & sons .",
    "feng , s. , holmes , p. , rorie , a. , newsome , w.  t. , 2009 .",
    "can monkeys choose optimally when faced with noisy stimuli and unequal rewards .",
    "plos computational biology 5  ( 2 ) , e1000284 .",
    "frazier , p. , yu , a.  j. , 2008 .",
    "sequential hypothesis testing under stochastic deadlines . in : platt , j. , koller , d. , singer , y. , roweis , s. ( eds . ) ,",
    "advances in neural information processing systems 20 .",
    "curran associates , inc . , pp . 465472 .",
    "gardiner , c. , 2009 .",
    "stochastic methods : a handbook for the natural and social sciences , 4th edition .",
    "springer .",
    "gold , j.  i. , shadlen , m.  n. , 2001 .",
    "neural computations that underlie decisions about sensory stimuli .",
    "trends in cognitive sciences 5  ( 1 ) , 1016 .",
    "gold , j.  i. , shadlen , m.  n. , 2007 .",
    "the neural basis of decision making . annual review of neuroscience 30  ( 1 ) , 535574 .",
    "gondan , m. , blurton , s.  p. , kesselmeier , m. , jun .",
    "even faster and even more accurate first - passage time densities and distributions for the wiener diffusion model .",
    "journal of mathematical psychology 60 , 2022 .",
    "hansen , p. , jaumard , b. , lu , s.  h. , 1992 .",
    "global optimization of univariate lipschitz functions : i. survey and properties .",
    "mathematical programming 55  ( 1 ) , 251272 .",
    "horrocks , j. , thompson , m.  e. , 2004 . modeling event times with multiple outcomes using the wiener process with drift .",
    "lifetime data analysis 10  ( 1 ) , 2949 .",
    "hubner , r. , steinhauser , m. , lehle , c. , 2010 .",
    "a dual - stage two - phase model of selective attention .",
    "psychological review 117  ( 3 ) , 759784 .    krajbich , i. , armel , c. , rangel , a. , 2010 . visual fixations and the computation and comparison of value in simple choice .",
    "nature neuroscience 13  ( 10 ) , 12921298 .",
    "lin , x.  s. , 1998 .",
    "double barrier hitting time distributions with applications to exotic options .",
    "insurance : mathematics and economics 23  ( 1 ) , 4558 .",
    "liu , s. , yu , a.  j. , holmes , p. , 2009 .",
    "dynamical analysis of bayesian inference models for the eriksen task .",
    "neural computation 21  ( 6 ) , 15201553 .",
    "milosavljevic , m. , malmaud , j. , huth , a. , koch , c. , rangel , a. , 2010 .",
    "the drift diffusion model can account for the accuracy and reaction time of value - based choices under high and low time pressure .",
    "judgment and decision making 5  ( 6 ) , 437449 .",
    "navarro , d.  j. , fuss , i.  g. , 2009 .",
    "fast and accurate calculations for first - passage times in wiener diffusion models .",
    "journal of mathematical psychology 53  ( 4 ) , 222230 .    ratcliff , r. , 1980 . a note on modeling accumulation of information when the rate of accumulation changes over time .",
    "journal of mathematical psychology 21  ( 2 ) , 178184 .",
    "ratcliff , r. , mckoon , g. , 2008 .",
    "the diffusion decision model : theory and data for two - choice decision tasks .",
    "neural computation 20  ( 4 ) , 873  922 .",
    "ratcliff , r. , rouder , j.  n. , 1998 . modeling response times for two - choice decisions .",
    "psychological science 9  ( 5 ) , 347356 .",
    "ratcliff , r. , smith , p.  l. , 2004 . a comparison of sequential sampling models for two - choice reaction time .",
    "psychological review 111  ( 2 ) , 333367 .",
    "servan - schreiber , d. , printz , h. , cohen , j. , 1990 . a network model of catecholamine effects-",
    "gain , signal - to - noise ratio , and behavior .",
    "science 249  ( 4971 ) , 892895 .",
    "servant , m. , white , c. , montagnini , a. , burle , b. , 2015 .",
    "using covert response activation to test latent assumptions of formal decision - making models in humans .",
    "the journal of neuroscience 35  ( 28 ) , 1037110385 .",
    "shadlen , m.  n. , newsome , w.  t. , 2001 .",
    "neural basis of a perceptual decision in the parietal cortex ( area lip ) of the rhesus monkey .",
    "journal of neurophysiology 86  ( 4 ) , 19161936 .",
    "simen , p. , contreras , d. , buck , c. , hu , p. , holmes , p. , cohen , j.  d. , 2009 . reward rate optimization in two - alternative decision making : empirical tests of theoretical predictions .",
    "journal of experimental psychology : human perception and performance 35  ( 6 ) , 1865 .",
    "smith , p.  l. , 2000 .",
    "stochastic dynamic models of response time and accuracy : a foundational primer . journal of mathematical psychology 44  ( 3 ) , 408  463 .",
    "usher , m. , mcclelland , j.  l. , 2001 .",
    "the time course of perceptual choice : the leaky , competing accumulator model .",
    "psychological review 108  ( 3 ) , 550 .    verdonck , s. , meers , k. , tuerlinckx , f. , mar 2015 .",
    "efficient simulation of diffusion - based choice rt models on cpu and gpu .",
    "behavior research methods .",
    "voss , a. , voss , j. , feb 2008 .",
    "a fast numerical algorithm for the estimation of diffusion model parameters .",
    "journal of mathematical psychology 52  ( 1 ) , 1  9 .",
    "wald , a. , 1945 .",
    "sequential tests of statistical hypotheses .",
    "the annals of mathematical statistics 16  ( 2 ) , 117186 .",
    "wald , a. , wolfowitz , j. , 1948 .",
    "optimum character of the sequential probability ratio test .",
    "the annals of mathematical statistics 19  ( 3 ) , 326339 .    wang , x .- j .",
    "probabilistic decision making by slow reverberation in cortical circuits .",
    "neuron 36  ( 5 ) , 955968 .",
    "white , c.  n. , ratcliff , r. , starns , j.  j. , 2011 .",
    "diffusion models of the flanker task : discrete versus gradual attentional selection .",
    "cognitive psychology 63  ( 4 ) , 210238 .    wong , k .- f .",
    ", wang , x .- j . , 2006 .",
    "a recurrent network mechanism of time integration in perceptual decisions .",
    "the journal of neuroscience 26  ( 4 ) , 13141328 .",
    "the laplace transform , or moment generating function , of the fpt density conditioned on response is given for @xmath193 by @xmath194 & = \\frac{e^ { \\frac{a_1 ( z - x_0)}{\\sigma_1 ^ 2}}}{(1-\\er_1 ) } \\frac { \\sinh ( \\frac{(z+x_0 ) \\sqrt{2\\alpha \\sigma_1 ^ 2 + a_1 ^ 2 } } { \\sigma_1 ^ 2 } ) } { \\sinh ( \\frac{2z\\sqrt{2\\alpha \\sigma_1 ^ 2 + a_1 ^ 2}}{\\sigma_1 ^ 2 } ) } , \\\\   \\expt[e^{-\\alpha \\tau_1 } |x(\\tau_1)=-z ] & = \\frac{e^{- \\frac{a_1 ( z + x_0)}{\\sigma_1 ^ 2}}}{\\er_1 } \\frac { \\sinh ( \\frac{(z - x_0 ) \\sqrt{2\\alpha \\sigma_1 ^ 2 + a_1 ^ 2 } } { \\sigma_1 ^ 2 } ) } { \\sinh ( \\frac{2z\\sqrt{2\\alpha \\sigma_1 ^ 2 + a_1 ^ 2}}{\\sigma_1 ^ 2})}.\\end{aligned}\\ ] ] references for these expressions may be found in the main text .",
    "we first establish . first consider the case @xmath195 .",
    "let @xmath196 be the filtration defined by the evolution of the msddm   until time @xmath1 conditioned on @xmath30 .",
    "for some @xmath197 , it can be shown that @xmath198 = e^{-2s_i x(s)}$ ] .",
    "thus , @xmath199 is a martingale .",
    "furthermore , @xmath200 is a stopping time .",
    "therefore , it follows from optional stopping theorem that @xmath201 & = \\expt[e^ {",
    "-2 s_i x(\\hat \\tau_i)}]\\\\ & = \\expt[e^ { -2 s_i x(\\tau_i)}| \\tau_i \\le t_i ] \\prob(\\tau_i \\le t_i ) + \\expt [ e^ { -2s_i x_i } ] \\prob ( \\tau_i > t_i ) ] \\\\ & = \\big ( e^{-2s_i z } ( 1- \\er_i ) +   e^{2s_iz } \\er_i \\big ) \\prob(\\tau_i \\le t_i ) + \\expt [ e^ { -2s_i x_i } ] \\prob ( \\tau_i > t_i)].\\end{aligned}\\ ] ] solving the above equation for @xmath95 , we obtain the desired expression .    for @xmath202 , we note that @xmath203 is a martingale .",
    "therefore , applying the optional stopping theorem , we obtain @xmath204 & = \\expt[x(\\hat \\tau_i ) ] \\\\ & = \\expt[x(\\tau_i)| \\tau_i \\le t_i ]",
    "\\prob(\\tau_i \\le t_i ) + \\expt[x_i ] \\prob(\\tau_i > t_i ) ] \\\\ & = ( 1 - 2 \\er_i ) z   \\prob(\\tau_i \\le t_i ) + \\expt[x_i ] \\prob(\\tau_i > t_i ) .",
    "\\end{aligned}\\ ] ] solving the above equation for @xmath95 , we obtain the desired expression",
    ". the formulas and immediately follow from applying expectation to  and  , respectively .    to establish for @xmath205",
    ", we note that for the ddm  , @xmath206 is a martingale .",
    "therefore , applying the optional stopping theorem , we obtain @xmath204 - a_i t_{i-1}&= \\expt[x(\\hat \\tau_i ) - a_i \\hat \\tau_i ] \\\\ &",
    "=   \\expt[x(\\tau_i ) - a_i   \\tau_i | \\tau_i\\le t_i ] \\prob(\\tau_i \\le t_i ) + \\expt[(x_i -a_i t_i ]",
    "\\prob(\\tau_i > t_i)\\\\ &   = \\big ( z(1-\\er_i ) -z \\er_i - a_i \\expt[\\tau_i | \\tau_i \\le t_i ] \\big)\\prob(\\tau_i \\le",
    "t_i ) + ( \\expt[x_i ]   -a_i t_i ) \\prob(\\tau_i   > t_i ) . \\end{aligned}\\ ] ] solving the above equation for @xmath207 $ ] yields the desired expression . for @xmath208",
    ", we note that @xmath209 is a martingale .",
    "therefore , applying the optional stopping theorem , we obtain @xmath210 - \\sigma_i^2 t_{i-1 } & =    \\expt[x(\\hat \\tau)^2 - \\sigma_i^2 \\hat \\tau_i ] \\\\ & = \\expt[x(\\tau_i)^2 - \\sigma_i^2 \\tau_i|\\tau_i \\le t_i ] \\prob(\\tau_i \\le t_i ) + \\expt[x_i^2 - \\sigma_i^2 t_i ] \\prob ( \\tau_i > t_i)]\\\\ & = ( z^2   -\\sigma_i^2 \\expt[\\tau_i| \\tau_i \\le t_i ] ) \\prob(\\tau_i \\le t_i ) + ( \\expt[x_i^2 ] - \\sigma_i^2 t_i ) \\prob(\\tau_i > t_i).\\end{aligned}\\ ] ] solving the above equation for @xmath207 $ ] yields the desired expression .",
    "next , we need to establish that the laplace transform of the density for the fpt for a particular decision made before @xmath37 is @xmath211 & = \\frac{e^{-\\alpha t_{i-1}}\\expt [ { t^{\\textup{mgf}}}_+(a_i , \\sigma_i , z , x_{i-1 } , \\alpha ) ] - e^{-\\alpha   t_i } \\expt[{t^{\\textup{mgf}}}_+(a_i , \\sigma_i , z , x_i , \\alpha)]\\prob ( \\tau _ i > t_i)]}{\\prob(\\tau_i",
    "\\le t_i ) } , \\\\ \\expt[e^{-\\alpha \\tau_i } \\bs{1}(x(\\tau_i)=-z | \\tau_i \\le t_i ) ] & = \\frac { e^{-\\alpha t_{i-1 } } \\expt [ { t^{\\textup{mgf}}}_-(a_i , \\sigma_i , z , x_{i-1 } , \\alpha ) ] - e^{-\\alpha t_i } \\expt[{t^{\\textup{mgf}}}_- ( a_i , \\sigma_i , z , x_i , \\alpha)\\prob ( \\tau_i > t_i)]}{\\prob(\\tau_i \\le t_i)}.\\end{aligned}\\ ] ] to establish this , we consider the stochastic process @xmath212 . since @xmath213 = e^{\\lambda",
    "x(s ) -\\lambda a_i s - \\lambda^2 \\sigma_i^2 s/2},\\ ] ] it follows that @xmath214 is a martingale for each @xmath215 .",
    "we choose two particular values of @xmath216 : @xmath217 note that for @xmath218 , @xmath219 .",
    "therefore , stochastic processes @xmath220 and @xmath221 are martingales .",
    "now applying the optional stopping theorem , we obtain @xmath222   = \\expt [ e^{\\lambda_1 x(\\hat \\tau ) -\\alpha \\hat \\tau } ]    = e^{\\lambda_1 z } \\expt[e^{-\\alpha \\tau_i } \\bs 1(x(\\tau_i)=z\\ ; \\ & \\ ; \\tau_i \\le t_i ) ]   \\\\ +   e^{- \\lambda_1 z }",
    "\\expt[e^{-\\alpha \\tau } \\bs 1(x(\\tau_i)=-z\\ ; \\ & \\ ; \\tau_i \\le t_i ) ] + e^{-\\alpha t_i } \\expt[e^{\\lambda_1 x_i } ] \\prob(\\tau_i > t_i ) \\end{gathered}\\ ] ] similarly , @xmath223 =   e^{\\lambda_2 z } \\expt[e^{-\\alpha \\tau_i } \\bs 1(x(\\tau)=z\\ ; \\ & \\ ; \\tau_i \\le t_i ) ] \\\\ + e^{- \\lambda_2 z } \\expt[e^{-\\alpha \\tau_i } \\bs 1(x(\\tau)=-z\\ ; \\ & \\ ; \\tau_i \\le t_i ) ] + e^{-\\alpha t_i } \\expt[e^{\\lambda_2 x_i } ] \\prob(\\tau_i > t_i ) ] \\end{gathered}\\ ] ] equations  and   are two simultaneous equations in two unknowns @xmath224 $ ] and @xmath225 $ ] . solving for these unknowns , we obtain @xmath226 = \\frac{e^{-\\alpha t_{i-1}}\\expt[e^{\\lambda_1(x_{i-1 } + z ) } - e^{\\lambda_2(x_{i-1}+z ) } ] - e^{-\\alpha t_i } \\expt[e^{\\lambda_1(x_i + z ) } - e^{\\lambda_2(x_i+z ) } ] \\prob ( \\tau_i > t_i)}{e^{2\\lambda_1 z } - e^{2\\lambda_2 z}},\\ ] ] and @xmath227 \\\\ = \\frac{e^{-\\alpha t_{i-1 } } \\expt[e^{-\\lambda_1(z- x_{i-1 } ) } - e^{- \\lambda_2(z- x_{i-1 } ) } ] - e^{-\\alpha t_i } \\expt[(e^{- \\lambda_1(z- x_i ) } - e^{- \\lambda_2(z- x_i ) } ) ] \\prob(\\tau_i > t_i)}{e^{-2\\lambda_1 z } - e^{-2\\lambda_2 z}}. \\end{gathered}\\ ] ] simplifying these expressions , we obtain the desired expression .    finally , and follow from differentiating the laplace transform with respect to @xmath228 , flipping sign , and then evaluating at @xmath229 .",
    "we start by establishing  . since @xmath107 $ ] , @xmath230",
    "we now establish  .",
    "we note that @xmath112 & = \\sum_{i=1}^n \\expt[\\tau \\bs 1(t_{i-1 } < \\tau \\le   t_i ) ] \\\\ & = \\sum_{i=1}^n \\expt[\\tau \\bs 1(\\tau \\le   t_i ) | \\tau > t_{i-1 } ] \\prob(\\tau > t_{i-1 } ) \\\\   & =   \\sum_{i=1}^n \\big ( \\expt[\\tau_i | \\tau_i \\le   t_i ]   \\prob ( \\tau_i \\le   t_i ) \\prod_{j=1}^{i-1 } \\prob(\\tau_j > t_j ) \\big ) . \\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> in this work , we use martingale theory to derive formulas for the expected decision time , error rates , and first passage times associated with a multistage drift diffusion model , defined as a wiener diffusion model with piecewise constant time - varying drift rates and decision boundaries . </S>",
    "<S> the model we study is a generalization of that considered in @xcite . </S>",
    "<S> the derivation relies on using the optional stopping theorem for properly chosen martingales , thus providing formulae which may be used to compute performance metrics for a particular stage of the stochastic decision process . </S>",
    "<S> we also explicitly solve the case of a two stage diffusion model , and provide numerical demonstrations of the computations suggested by our analysis . </S>",
    "<S> we discuss the applications of these formulae for experiments involving time pressure and/or changes in attention over the course of the decision process . </S>",
    "<S> we further show how these formulae can be used to semi - analytically calculate reward rate in the service of optimizing the speed - accuracy trade - off . </S>",
    "<S> finally we present calculations that allow our techniques to approximate time - varying ornstein - uhlenbeck processes . by presenting these explicit formulae , we aim to foster the development of refined numerical methods and analytical techniques for studying diffusion models with time - varying parameters . </S>"
  ]
}