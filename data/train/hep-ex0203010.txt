{
  "article_text": [
    "there exist a large number of binning - free goodness - of - fit tests for univariate distributions .",
    "the extension to the multivariate case is difficult , because there a natural ordering system is missing . the popular @xmath2 test on the other hand suffers from the arbitrariness of the binning and from lack of power for small samples .",
    "the test proposed in this article avoids both , ordering and binning .",
    "it is especially powerful in the multivariate case .",
    "it is called energy test , because the definition of the test statistic is closely related to the energy of electric charge distributions . to facilitate the computation of the test statistic , we approximate the probability distribution function ( p.d.f . ) @xmath0 of the null hypothesis by simulated observations .",
    "the statistic `` energy '' can also be used to test whether two samples belong to the same parent distribution .    in section 2",
    "we define the test and study its properties .",
    "section 3 contains a comparison of the power of the energy test with that of other popular tests in one dimension . in section 4",
    "we apply the energy test to two - dimensional problems . we discuss possible modifications and extensions of the test in section 5 and conclude with a summary in section 6 .",
    "we define a quantity @xmath3 , the _ energy _ , which measures the difference between two p.d.fs @xmath4 and @xmath5 , @xmath6 @xmath7 , by @xmath8 \\left [   f(\\mathbf{x}^{\\prime})-f_{0}(\\mathbf{x}^{\\prime})\\right ] r(\\mathbf{x},\\mathbf{x}^{\\prime})\\mathbf{dxdx}^{\\prime}.\\label{edef}%\\ ] ]    the integrals extend over the full variate space .",
    "the weight function @xmath9 is a monotonically decreasing function of the euklidian distance @xmath10 .",
    "relation ( [ edef ] ) with @xmath11 is the electrostatic energy of two charge distributions of opposite sign which is minimum if the charges neutralize each other . setting the function @xmath12 , where @xmath13 is the dirac delta function",
    ", @xmath3 reduces to the integrated quadratic difference of the two p.d.f.s @xmath14 ^{2}\\mathbf{dx.}%\\ ] ]    since we want to generalize ( [ edef ] ) in such a way that we can apply it to a comparison of a sample with a distribution or of two samples with each other , @xmath15 is not suitable .",
    "functions like gaussians which correlate different locations have to be used .",
    "the test which we will introduce is based on the fact that for fixed @xmath4 , @xmath3 is minimum for the null hypothesis @xmath16 for all @xmath6 @xmath7 .",
    "we sketch a prove of this assertion in the appendix .    expanding ( [ edef ] ) @xmath17\\mathbf{dxdx}^{\\prime},\\ ] ] we obtain three terms which have the form of expectation values of @xmath9 .",
    "they can be estimated from two samples @xmath18 and @xmath19 drawn from @xmath20 and @xmath0 , respectively . since in",
    "the first and the second term a product of identical distributions occurs , there it is not necessary to draw two different samples of the same p.d.f .. the expectation value of @xmath9 in these expressions is given by the mean value of @xmath9 computed from all combinations of the sample observations @xmath21    throughout this article unless specified differently , all sums run from @xmath22 to the maximum value of the index .",
    "for the energy statistic @xmath23 of a sample @xmath24 relative to the p.d.f .",
    "@xmath0 is given by : @xmath25    to test whether a statistical sample @xmath18 of size @xmath26 is compatible with the null hypothesis @xmath27 , we could in principle use the test statistic @xmath23 of the sample with respect to the associated p.d.f .",
    "@xmath0 according to @xmath23 but since the evaluation of @xmath23 usually requires a sum over difficult integrals , we prefer to represent @xmath0 by a sample @xmath28 , usually generated through a monte carlo simulation",
    ". we drop in @xmath29 the term depending only on @xmath0 which is independent from the sample observations and obtain : @xmath30    furthermore , we have replaced the denominator of the first term @xmath31 by @xmath32 which has superior small sample properties ( see appendix ) .",
    "statistical fluctuations of the simulation are negligible if @xmath33 is large compared to @xmath26 , typically @xmath34 .",
    "we have investigated three different types of  weight functions , power laws , a logarithmic dependence and gaussians . @xmath35{l}% \\frac{1}{r^{\\kappa}}\\;\\text{for } r > d_{\\min}\\\\ \\frac{1}{d_{\\min}^{\\kappa}}\\;\\text{for } r\\leq d_{\\min}% \\end{array } \\right . \\label{rpot1}\\\\",
    "r_{\\log}(r ) &   = \\left\\ { \\begin{array } [ c]{l}% -\\ln r\\;\\text{for } r > d_{\\min}\\\\ -\\ln d_{\\min}\\;\\text{for } r\\leq d_{\\min}% \\end{array } \\right . \\\\",
    "r_{g}(r ) &   = \\exp\\left (   -r^{2}/(2s^{2})\\right ) \\label{rexp}%\\end{aligned}\\ ] ]    the first type is motivated by the analogy to electrostatics , the second is long range and the third emphasizes a limited range for the correlation between different observations .",
    "the power @xmath36 of the denominator in ( [ rpot1 ] ) and the parameter @xmath37 in ( [ rexp ] ) may be chosen differently for different dimensions of the sample space and different applications .",
    "for slowly varying @xmath0 a small value of @xmath36 around @xmath38 is recommended . for short range variations",
    "the test quantity with larger values around @xmath39 is more sensitive .",
    "also the logarithmic function @xmath40 is well adapted to slowly varying @xmath0 .",
    "the corresponding test quantiles are invariant under the transformation @xmath41 . for more rapidly varying @xmath0 ,",
    "the gaussian weight function @xmath42 is recommended .",
    "it permits to adjust the range of the smearing to the shape of @xmath0 .    the inverse power law and the logarithm exhibit a pole at @xmath43 equal to zero which could produce infinities in the double discrete version of the energy function @xmath29 .",
    "very small distances , however , should not be weighted too strongly since deviations from @xmath0 with sharp peaks are not expected and usually inhibited by the finite experimental resolution .",
    "we eliminate the poles by introducing a lower cutoff @xmath44 for the distances @xmath43 .",
    "distances less than @xmath44 are replaced by @xmath44 .",
    "the value of this parameter is not critical at all , it should be of the order of the average distance of the simulation points in the region where @xmath0 is maximum .",
    "[ h ]    phidist.eps    the distribution of @xmath3 depends on the distribution function @xmath0 and on the weight function @xmath9 .",
    "figure [ phidist ] shows the distributions for uniform @xmath0 with gaussian and logarithmic weight functions .",
    "the distributions are well described by a generalized extreme value distribution @xmath45 depending on three parameters , a scale parameter @xmath46 , a location parameter @xmath47 , and a shape parameter @xmath48 . rather than computing these parameters from the moments of the specific @xmath3 distributions ,",
    "we propose to generate the distribution of the test statistic and the quantiles by a monte carlo simulation . as a consequence of the dramatic increase of computing power during the last decade ,",
    "it has become possible to perform the calculations on a simple pc within minutes .",
    "there is no need to publish tables of percentage points , to distinguish between simple and composite hypotheses and also censoring can be incorporated into the simulation .",
    "let us assume that we have in a certain @xmath2-bin @xmath49 experimental observations and @xmath50 monte carlo observations and @xmath51 @xmath52 . then the @xmath2 contribution of that bin is @xmath53 for a goodness - of - fit test , an additive constant is irrelevant .",
    "thus we can drop @xmath54 in the last relation .",
    "if in addition the theoretical distribution is uniform and the bins have constant size , we can also ignore the denominator .",
    "@xmath55 up to a constant factor this last relation corresponds nearly to the energy defined in ( [ edefddm ] ) for a weight function which is constant inside the bin and zero outside : @xmath56    the @xmath2 test applied to a uniform distribution @xmath0 is equivalent to an energy test with a box shaped weight function and fixed box locations .",
    "replacing the box function by the gaussian weight function , the sharp cut at the bin boundaries and the arbitrary location of the boundary for fixed binning are avoided but the idea underlying the @xmath2 test is retained .",
    "to study the dependence of the power of the test on the choice of the weight function and its parameters , we have chosen for @xmath27 a uniform , univariate p.d.f.@xmath57 restricted to the unit interval @xmath58 $ ] .",
    "we determined the rejection power with respect to contaminations of @xmath0 with a linear and two different gaussian distributions which represent a wide and a more local distortion .",
    "@xmath59 we required 5% significance level and computed the rejection power which is equal to one minus the probability for an error of the second kind .",
    "as a reference , we also computed the power of a @xmath2 test with bins of fixed width .",
    "the number of bins @xmath60 was chosen according to the prescription proposed in @xcite .",
    "the cut - off parameter @xmath44 for @xmath61 ( power law ) and @xmath62 ( logarithmic ) was set equal to @xmath63 .",
    "[ ptb ]    e100all.eps    in figure [ e100all ] we show the results for samples of 100 observations for 70 % contamination with @xmath64 , 30 % contamination with @xmath65 and 20 % contamination with @xmath66 .",
    "five different values of the gaussian width parameter @xmath37 , four different power laws and the logarithmic weight function have been studied .",
    "as expected , the linear distribution is best discriminated by slowly varying weight functions like the logarithm , low power laws and the wide gaussians .",
    "the contamination with the narrow gaussian @xmath66 is better recognized by the narrow weight functions ( @xmath67 ) .",
    "here the two wide gaussian weight functions fail completely .",
    "[ ptb ]    power1.eps    figure [ power1 ] illustrates the dependence of the rejection power on the sample size for the three different distortions ( [ blin ] ) , ( [ bgauss1 ] ) , ( [ bgauss2 ] ) of the uniform distribution .",
    "the amount of contamination was reduced with increasing sample size .",
    "we applied the energy tests with power law @xmath68 , the logarithmic and two gaussian weight functions with fixed width @xmath69 ( gfix ) and variable width ( gvar ) .",
    "the variable width was chosen such that the full width at half maximum is equal to the @xmath2 bin width , chosen according to the @xmath70 law .",
    "this allows for a fair comparison between the two methods .",
    "as expected the linear distribution is best discriminated by the energy test with logarithmic weight function .",
    "the power of the @xmath2 test is considerably worse .",
    "the energy test with variable gaussian weight function follows the trend of the @xmath2 test but performs better in 14 out of the 15 cases .    comparing the samples with sizes 50 and 100 , respectively , we realize one of the caveats of the @xmath2 test : for the sample of size 50 there are 9 bins .",
    "the central bin coincides favorably with the location of the distortion peak of the background sample and consequently leads to a high rejection power . for the sample of size 100 ,",
    "however , there are 12 bins , thus two bins share the narrow peak and the power is reduced .",
    "the gaussian energy test is insensitive to the location of the distortion .",
    "we have investigated the following goodness - of - fit tests , some of which have been designed for special applications and can be found in @xcite : @xmath2 test , kolmogorov test , kuiper test , anderson - darling test , watson test , neyman smooth test , region test , energy tests with logarithmic and gaussian weight functions . the region test has been developed to detect localized bumps by partitioning the variate range of the order statistic into three regions with expected probabilities @xmath71 . for @xmath72 and @xmath73 observations observed in the first two regions , the test statistic is @xmath74   ^{2}%\\ ] ] where @xmath72 is the number of observations with @xmath75 .",
    "samples contaminated by different background sources were tested against @xmath27 , corresponding to the uniform distribution .",
    "the power of each test for a 5 % significance limit was evaluated from @xmath76 monte carlo simulations containing 100 observations each .    samples with background contamination by a linear distribution , gaussians and the following distributions displayed in figure [ bgd1 ] were generated by @xmath77{c}% x^{2}\\\\ ( 1-x)^{2}% \\end{array}% \\begin{array } [ c]{c}% \\text{for } 0\\leq x<0.5\\\\ \\text{for } 0.5\\leq x<1 \\end{array } \\right .",
    "\\\\ b_{c}(x )   & \\varpropto(x-0.5)^{2}\\text { \\ \\ \\ \\ \\ \\ \\ } % \\end{aligned}\\ ] ] .",
    "[ ptb ]    bgd1.eps    the power of the different tests is presented in figure [ power1d ] . as expected , none of the tests is optimum for all kind of distortions .",
    "the energy tests are quite powerful independent of the background function .",
    "[ ptb ]    power1d.eps",
    "while numerous goodness - of - fit tests exist for univariate distributions in higher dimensions only tests of the @xmath2 type have become popular .",
    "the extension of binning - free tests based on linear rank statistics to the multivariate case @xcite is difficult because no obvious ordering scheme of the observations exist .",
    "sequential ordering in the different variates depends on the sequence in which the variates are chosen .",
    "in addition to this logical difficulty there is a more fundamental problem : the re - shuffling of the observations destroys the natural metric used to display the data .",
    "the situation in goodness - of - fit problems is very similar to that in pattern recognition .",
    "the possibility to detect distortions of the expected distribution by background or resolution effects depends on an appropriate selection of the random variables .",
    "the natural choice is usually given by the experiment . by mapping a multivariate space onto a space defined by the ordering recipe much of the information contained in the original distribution may be lost .",
    "it is rather common to deal with samples of observations which are drawn from a multivariate normality .",
    "multivariate goodness - of - fit tests have been developed mostly for multinormality .",
    "an overview can be found in @xcite .",
    "an extension of the moment tests introduced by k. pearson to two variates is mardia s test @xcite .",
    "skewness @xmath78 and kurtosis @xmath79 are compared to the nominal values for the normal distribution , @xmath80 and @xmath81 respectively .",
    "we compared the logarithmic and the gaussian energy tests to mardia s tests and to the two - dimensional neyman smooth test @xcite .",
    "we chose a standard gaussian @xmath82 to represent the null hypothesis .",
    "background samples added to @xmath0 are shown in figure [ bgd2 ] .",
    "in addition , a uniform background in the region ( @xmath83 ) and variations of the gaussian background were investigated .",
    "all gaussians have the same width in both coordinates @xmath84 and @xmath85 , but differ in the value of the width and the correlation coefficient .",
    "[ ptb ]    bgd2.eps    [ h ]    power2d.eps    figure [ power2d ] displays the results .",
    "we were astonished how well the energy test competes with alternatives especially designed to test normality .",
    "we attribute the excellent performance of the energy test to the fact that it is sensitive to all deviations of two distributions whereas the mardia tests are based only on two specific moments .",
    "figure [ scatter ] is a scatter plot of data obtained in the particle physics experiment hera - b at desy .",
    "the positions of tracks from @xmath86 decays are plotted against the momentum of the @xmath86 meson .",
    "the 20 square entries represent the experimental data , the black dots correspond to a monte carlo simulation .",
    "we have computed the energy statistic @xmath3 with the logarithmic weighting function for the experimental data relative to the monte carlo prediction .",
    "separately , the energy was determined for 100 independent monte carlo samples of 20 events each to estimate the distribution of @xmath3 under @xmath27 .",
    "the experimental value is larger than all monte carlo values ( see figure [ scatter ] ) , indicating that the data do not follow the prediction .",
    "[ h ]    scatter.eps",
    "the gaussian energy test has proven to be similar but superior to the @xmath2 test for the uniform distribution . for non - uniform p.d.f.s",
    "the similarity can be retained by effectively dividing the elements of the sums in ( [ edefddm ] ) by the p.d.f . @xmath0 .",
    "@xmath87 if the density is only given by a monte carlo simulation , the density can be estimated from the volume of a multidimensional sphere in the variate space containing a fixed number of monte carlo observations . in the example of figure [ scatter ] the density at @xmath6",
    "could be estimated from the area @xmath88 of the smallest circle centered at @xmath6 containing 10 monte carlo points : @xmath89 .",
    "some statisticians recommend to use equal probability bins for the @xmath90 test in one dimension .",
    "an equivalent procedure for the gaussian energy test would be to adjust the width of the gaussian weighting function to the p.d.f . @xmath91    such an adjustment can be applied independent of the dimension of the variate space while an equal probability binning is rather difficult in two or higher dimensions .",
    "the resolution of @xmath9 should be adjusted to the expected deviations .",
    "the constants @xmath37 can be chosen differently for the different coordinates .",
    "alternatively , a variate transformation may be performed before the test is applied .",
    "the multi - dimensional logarithmic energy test requires a sensible choice of the metric .",
    "the distances of the observations should be about equal numerically in all directions of the variate space .",
    "this can be achieved by normalizing the variates to the square root of their variance .",
    "for very large samples , the computation of @xmath3 may become excessively long even with powerful computers .",
    "a possible solution to this problem is to combine observations to clusters .",
    "the cluster weight is equal to the sum of the observations included in the cluster and its location is their center of gravity .",
    "the details of the clustering are not important .",
    "the simplest method consists in combining points in bins formed by a simple grid .",
    "another possibility could be the following : observations and clusters ( once clusters have been formed ) are chosen randomly and combined with all points and clusters which are within a fixed maximum distance .",
    "the process is terminated when the number of clusters is below an acceptable limit .",
    "a frequently occurring problem is to check whether two random samples belong to the same unknown parent distribution . in the framework of the `` energy '' concept we can use bootstrap or permutation methods to deduce a reference energy distribution .",
    "the energy computed according to ( [ edefddm ] ) is then compared to this distribution .",
    "quantiles can be used to measure the compatibility of the samples .",
    "energy tests represent a powerful alternative to conventional tests . to our knowledge",
    "the energy test is the first multi - variate binning - free test which is independent of a subjective ordering system . with a logarithmic weighting function",
    "it is very sensitive to long range distortions of the distribution to be tested , a situation which is frequent in physics applications . with a gaussian weighting function",
    "the energy test has similar properties as tests of the @xmath2 type , but avoids arbitrary bin boundaries .",
    "it is more powerful than the @xmath2 test in almost all cases which we have considered .",
    "it can cope with arbitrarily small sample sizes .",
    "it is astonishing how well the energy test can compete with the mardia test for testing normality in two dimensions .    the necessity to determine the distribution function of the test statistic for the specific application is not a serious restriction with today s computing power .",
    "the energy statistic can be used to test whether different samples belong to the same parent distribution .",
    "a corresponding study will be presented in a forthcoming article .",
    "we conjecture that @xmath92 corresponds to a minimum of @xmath3 in ( [ edef ] ) . substituting @xmath93",
    "we obtain @xmath94 where @xmath95 fulfils the condition @xmath96 .",
    "we conjecture that @xmath3 is minimum for @xmath97 for weight functions @xmath9 which decrease continuously with @xmath98 .",
    "the property ( [ phigg ] ) is invariant under a linear transformation @xmath99 where @xmath100 is a positive scaling factor . assuming that @xmath9 is finite",
    ", we can restrict its values to the range @xmath101 with @xmath102 .",
    "we approximate the function @xmath95 by a histogram with function value @xmath103 in bin @xmath104 .",
    "the size of each bin is @xmath105 .",
    "@xmath106 with self - explaining notation .",
    "the weights can be substituted by cosines , @xmath107 with @xmath108 in our approximation .",
    "the sum then can be written as a sum of vectors @xmath109 in @xmath110 : @xmath111 the minimum of @xmath112 is realized only if all @xmath109 are equal to zero .",
    "when we approximate both densities @xmath20 and @xmath0 by distributions of @xmath26 points each , with weights equal @xmath113 , we require that the energy be minimum if the two samples coincide , @xmath114 @xmath115 .",
    "to fulfil this condition , we have to replace the factors @xmath116 and @xmath117 by @xmath113 in @xmath29 .",
    "@xmath118 to demonstrate the minimum condition which leads to @xmath119 , we apply an infinitesimal shift to one observation . for @xmath120 for @xmath121 and @xmath122",
    ", only the pair @xmath123 contributes to the energy , all other terms cancel .",
    "@xmath124\\ ] ] since @xmath9 _ decreases _ with its argument , @xmath125 , we have found a local _ minimum _ of the energy .",
    "for the special choice where @xmath9 is the distance function , i. e. _ increasing _ with the distance , it has been demonstrated by @xcite that @xmath3 @xmath126   -\\frac{1}{n^{2}}\\sum_{i}\\sum _ { j}|\\mathbf{x}_{i}-\\mathbf{y}_{j}|\\leq0\\ ] ] is _ maximum _ for @xmath114 for all @xmath127 .",
    "since @xmath3 is constant for constant @xmath9 , it is plausible that for discrete distributions @xmath3 is minimum for @xmath114 for all decreasing functions of the distance , and maximum for all increasing functions of the distance , however , we did not succeed in finding a general prove of this conjecture ."
  ],
  "abstract_text": [
    "<S> we present a new class of multivariate binning - free and nonparametric goodness - of - fit tests . </S>",
    "<S> the test quantity _ energy _ is a function of the distances of observed and simulated observations in the variate space . </S>",
    "<S> the simulation follows the probability distribution function @xmath0 of the null hypothesis . </S>",
    "<S> the distances are weighted with a weighting function which can be adjusted to the variations of @xmath0 . </S>",
    "<S> we have investigated the power of the test for a uniform and a gaussian distribution of one or two variates , respectively and compared it to that of conventional tests . the energy test with a gaussian weighting function </S>",
    "<S> is closely related to the pearson @xmath1 test but is more powerful in most applications and avoids arbitrary bin boundaries . </S>",
    "<S> the test is especially powerful in the multivariate case . </S>"
  ]
}