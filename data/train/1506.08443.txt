{
  "article_text": [
    "symplectic integrators are a class of mappings that allow for numerical integration of conservative dynamical systems and which , up to round - off , exactly preserve certain constants of motion ( e.g.  the symplectic form ) . as a result",
    "the integrations do not suffer from numerical `` dissipation '' which would cause an unphysical drift over many dynamical times . due to these properties ,",
    "symplectic integrators are widely used in the long - term integration of many physical systems , particularly in celestial dynamics  @xcite .",
    "conservative variational integrators  ( see e.g. * ? ? ?",
    "* ) are a subclass of symplectic integrators where the mappings are determined by the extremization of a _",
    "discretized _ action .",
    "the discretized action can inherit the symmetries of the full action such that , by noether s theorem , the discrete equations of motion exactly conserve the symplectic form and the momenta .",
    "since discretizing the time coordinate breaks the continuous time - shift symmetry , fixed - time - step variational integrators that preserve the symplectic form and the momenta can not also conserve energy  @xcite .",
    "however , the energy error tends to be bounded by a constant , even over long integration times ( see e.g. * ? ? ? * and references therein ) , in contrast with traditional integration methods where the error tends to grow with time .",
    "variational integrators can be applied to some dissipative problems using the lagrange - dalembert approach  @xcite . here",
    ", we utilize the more general nonconservative action principle , recently developed by  @xcite .",
    "this formalism was developed to accommodate generically the causal dynamics of untracked or inaccessible degrees of freedom that might result from an integrating - out or coarse - graining procedure at the level of an action / lagrangian / hamiltonian .    in this letter",
    ", we develop variational integrators from the nonconservative action principle .",
    "the resulting mappings are no longer symplectic , as the symplectic form ( and momenta ) are no longer conserved , but evolve according to the nonconservative dynamics .",
    "we instead refer this type of numerical integrator as `` slimplectic '' since phase space volumes tend to slim down for dissipative systems .",
    "we show that our method inherits many of the same performance features of the symplectic integrator .",
    "previous works have demonstrated some success by including weakly dissipative forces in 2nd - order symplectic integrators ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) ; in fact , these can be shown to be particular cases of our more general ( arbitrary order ) method .",
    "for brevity , we focus on a basic fixed - time - step slimplectic integrator leaving further developments , such as adaptive time - stepping and detailed discussion of noether current evolution , to a longer follow - up paper .",
    "nonconservative lagrangian mechanics accommodates nonconservative interactions and effects by first formally doubling the degrees of freedom , @xmath0 .",
    "the action describing the dynamics of these doubled variables is @xmath1 where the ( nonconservative ) lagrangian is @xmath2 @xmath3 is the usual lagrangian , which is an arbitrary function of coordinates , velocity , and time and describes the conservative sector of the system ( i.e. , dynamics in the absence of nonconservative effects ) .",
    "however , @xmath4 is another arbitrary function that couples the variables together , vanishes when @xmath5 , and accounts for any generic nonconservative interaction .",
    "note that @xmath6 is completely specified once @xmath3 and @xmath4 are given .",
    "after all variations of @xmath7 are performed the two variables are identified with each other , @xmath8 , which is called the _ physical limit _ ( pl ) . in some cases , it is convenient to work with more physically motivated coordinates , @xmath9 and @xmath10 .",
    "the former can often be considered like a virtual displacement and vanishes in the pl while the latter is the surviving physically relevant combination .",
    "requiring @xmath7 to be stationary under variations of the doubled variables and taking the pl leads to nonconservative euler - lagrange equations of motion , @xmath11_{\\rm pl } & = 0   \\intertext{or in terms of $ l$ and $ k$ , } \\frac{d}{dt } \\frac{{\\partial}l}{{\\partial}\\dot{q } } - \\frac{{\\partial}l}{{\\partial}q } & = \\left [ \\frac{{\\partial}k}{{\\partial}q_- }   - \\frac{d}{dt } \\frac{{\\partial}k}{{\\partial}\\dot{q}_- } \\right]_{\\rm pl }   .\\end{aligned}\\ ] ] there are multiple ways to specify @xmath4 , which depend on the particular problem in question .",
    "more details about this aspect and the nonconservative action formalism in general can be found in  ii of  @xcite , including the evolution of noether currents according to nonconservative processes described by @xmath4 .",
    "variational integrators numerically approximate the behavior of a system by implementing the exact equations of motion for a closely - related _ discrete _ action  @xcite . here",
    "we will apply it to the nonconservative action principle described above .    to construct a variational integrator we need to make a choice of discretization of the action integral @xmath12 .    a choice that provides a time - reversal symmetric discretization   is gauss - lobatto quadrature , illustrated in figure  [ fig : ggltimeslambda ] . on the time interval",
    "@xmath13 $ ] with @xmath14 , we have the set of @xmath15 quadrature points @xmath16 , with @xmath17 where @xmath18 , @xmath19 , and @xmath20 ( for @xmath21 ) is the @xmath22th root of @xmath23 , the derivative of the @xmath24th legendre polynomial , @xmath25 . for a given nonconservative lagrangian functional @xmath26",
    ", we can approximate the degrees of freedom @xmath27 using the cardinal - function interpolation for this choice of quadrature points .",
    ", the area under the nonconservative lagrangian is approximated by the weighted sum of the lagrangian , @xmath26 , evaluated at each of the @xmath28 quadrature points .",
    "this quadrature rule ( and the variational integrator ) is accurate up to order @xmath29 .",
    "the generalized velocities @xmath30 are approximated using the derivative of the @xmath31th - order interpolating function at each quadrature point . ]",
    "we then have the approximation @xmath32 , which can be conveniently evaluated at the quadrature points using the derivative matrix  ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , @xmath33 such that @xmath34 where for notational compactness we define @xmath35 , @xmath36 , and @xmath37 .",
    "using gauss - lobatto quadrature , any integral functional @xmath38 [ for example @xmath39 has a discrete - quadrature approximation on the time interval @xmath40 $ ] .",
    "this discrete functional @xmath41 is we can drop the @xmath42 , indices . ] @xmath43 where the gauss - lobatto quadrature weights @xmath44 are given by @xmath45 ^ 2}.\\end{aligned}\\ ] ]    now we approximate the action over an interval @xmath46 $ ] , @xmath47 & = \\int_{t_0}^{t_{n+1 } } \\lambda(q_\\pm , \\dot{q}_\\pm , t ) dt \\nonumber \\\\ & = { \\cal s}_d[t_0 , t_{n+1 } ]   + { \\cal o}(\\delta t^{2r+3}),\\end{aligned}\\ ] ] where the discretized action is defined as @xmath48   \\equiv \\sum_{n=0}^{n } \\lambda_d(q_{n , \\pm } , \\{q_{n,\\pm}^{(i)}\\}_{i=1}^r , q_{n+1,\\pm } , t_n ) \\label{eq : discreteaction}.\\end{aligned}\\ ] ] we refer to this discretization choice as the galerkin - gauss - lobatto ( ggl ) method  @xcite .",
    "the discrete action @xmath49 $ ] from   can then be extremized over values @xmath50 and @xmath51 , and the physical limit imposed , to generate the discretized equations of motion for each @xmath52 $ ] ,    @xmath53_{\\rm pl } & = 0 , \\\\",
    "\\left[\\frac{{\\partial}\\lambda_d^n}{{\\partial}q_{n,-}^{(i)}}\\right]_{\\rm pl } & = 0,\\end{aligned}\\ ] ]    since from figure  [ fig : ggltimeslambda ] , we see that each @xmath54 only contributes to a single @xmath55 in the discretized action  , while each @xmath50 appears in both @xmath56 and @xmath55 .",
    "in terms of @xmath57 and @xmath58 , the equations of motion are    [ eq : discreteeoms ] @xmath59_{\\rm pl } & = 0 \\label{eq : fulldiscretenceom}\\\\ \\frac{{\\partial}l_d^n}{{\\partial}q_n^{(i ) } }   + \\left[\\frac{{\\partial}k_d^n}{{\\partial}q_{n,-}^{(i)}}\\right]_{\\rm pl } & = 0.\\end{aligned}\\ ] ]    we now introduce the discrete momenta @xmath60 , defining the nonconservative ( slimplectic ) ggl variational integrator map @xmath61 , by splitting the equation of motion into    [ eq : discrete_nc_eom ] @xmath62_{\\rm pl } & = { } & - \\frac{{\\partial}l_d^n } { { \\partial}q_n}- \\left [ \\frac{{\\partial}k_d^n } { { \\partial}q_{n,- } } \\right]_{\\rm pl } \\label{eq : ncqmap},\\\\ \\pi_{n+1 } & \\equiv \\left [ \\frac{{\\partial}\\lambda_d^n } { { \\partial}q_{n+1,- } } \\right]_{\\rm pl }   & = { } & \\frac{{\\partial}l_d^n}{{\\partial}q_{n+1 } } + \\left [ \\frac{{\\partial}k_d^n}{{\\partial}q_{n+1,-}}\\right]_{\\rm pl } \\label{eq : ncpimap},\\\\ 0 & = \\left [ \\frac{{\\partial}\\lambda_d^n } { { \\partial}q^{(i)}_{n,- } } \\right]_{\\rm pl } & = { } &   \\frac{{\\partial}l_d^n}{{\\partial}q_n^{(i)}}+ \\left[\\frac{{\\partial}k_d^n}{{\\partial}q_{n,-}^{(i ) } } \\right]_{\\rm pl } \\label{eq : ncinteq}.\\end{aligned}\\ ] ]    given initial values of @xmath63 , the values of @xmath64 are determined implicitly by  , while the values for the @xmath65 intermediate points are given implicitly by equation   for @xmath21 .",
    "the final momenta @xmath66 can then be determined explicitly from  .",
    "noether s theorem for conservative actions can be shown to generalize to nonconservative systems where the corresponding noether currents evolve in time due to a non - zero k  @xcite .",
    "one can show that for continuous symmetries of the conservative action , which remain after discretization , discrete noether currents will also evolve due to @xmath67 .",
    "thus , translational or rotational symmetries , for example , will generate discrete momenta that evolve according to @xmath67 , up to round off and bias error  @xcite .",
    "additional error compared to the physical evolution is only due to the discretization of the action .",
    ", @xmath68 , with @xmath69 , and fixed time steps @xmath70 .",
    "initial conditions were taken to be @xmath71 and @xmath72 .",
    "the @xmath73nd order rk solution , shown in green , is unstable for these parameters and diverges significantly .",
    "the @xmath74th - order rk solution ( blue - dashed ) can not be readily distinguished from the @xmath74th - order slimplectic solution ( solid - orange ) in this plot .",
    "the @xmath73nd - order slimplectic solution , ( solid - red ) , gives nearly the correct amplitude after @xmath75 time steps , as the energy evolution is accurately followed , though a phase shift is evident . *",
    "bottom : * the fractional energy error relative to the energy given by the analytic solution at each time .",
    "we see that while initially the rk and slimplectic energy errors are comparable at each order , the rk energy errors grow roughly linearly with time , while the slimplectic energy error remains bounded .",
    "[ fig : dsho ] , title=\"fig : \" ] , @xmath68 , with @xmath69 , and fixed time steps @xmath70 .",
    "initial conditions were taken to be @xmath71 and @xmath72 .",
    "the @xmath73nd order rk solution , shown in green , is unstable for these parameters and diverges significantly .",
    "the @xmath74th - order rk solution ( blue - dashed ) can not be readily distinguished from the @xmath74th - order slimplectic solution ( solid - orange ) in this plot .",
    "the @xmath73nd - order slimplectic solution , ( solid - red ) , gives nearly the correct amplitude after @xmath75 time steps , as the energy evolution is accurately followed , though a phase shift is evident .",
    "* bottom : * the fractional energy error relative to the energy given by the analytic solution at each time .",
    "we see that while initially the rk and slimplectic energy errors are comparable at each order , the rk energy errors grow roughly linearly with time , while the slimplectic energy error remains bounded .",
    "[ fig : dsho ] , title=\"fig : \" ]    the ggl discretization does _ not _ preserve the time - shift symmetry preventing energy evolution from being precisely tracked .",
    "however , the fractional energy error tends to be oscillatory and bounded by a resolution and order - dependent constant .",
    "we will defer more detailed discussion of noether current evolution to a longer followup paper in the interests of space .",
    "the resulting slimplectic maps are accurate up to order @xmath76 . for @xmath77 , where no intermediate steps are used",
    ", the quadrature method is the trapezoid rule , and the variational integrator is 2nd - order and equivalent to the strmer - verlet `` leap - frog '' integrator  @xcite .",
    "it is well known that 2nd - order `` leap - frog '' integrators can be used for dissipative systems , by inserting a dissipative `` kick '' force into the `` kick - drift - kick '' ansatz , resulting in good energy and momentum evolution properties .",
    "our approach explains _",
    "why _ this simple modification works in the 2nd - order system , as it is equivalent to the lowest order slimplectic ggl method ( see also * ? ? ?",
    "* for a similar lagrange - dalembert approach ) .",
    "the slimplectic method allows this to be generalized to higher orders and general nonconservative systems .",
    "we have developed a simple ` python ` code , ` slimplectic ` , that is publicly availablethe repository for ` slimplectic ` is available at http://github.com/davtsang/slimplectic . ] and generates the fixed - time - step slimplectic ggl integrators described above , for use in characterizing the numerical technique .",
    "the code generates slimplectic solvers of arbitrary order @xmath29 given ` sympy `  @xcite expressions for @xmath78 and @xmath79 .",
    "this demonstration code is designed to work for arbitrary @xmath3 and @xmath4 , and thus has not been optimized as would be appropriate for specific problems . in particular , the equations of motion   are solved with standard root - finders , rather than a problem - specific iteration method , to be more generally applicable .    as a basic example in figure  [ fig : dsho ] we compare runge - kutta ( rk ) and slimplectic integration of a simple damped harmonic oscillator , for both 2nd and 4th - order methods .",
    "below we also present two basic astrophysical examples of non - conservative interactions .",
    "all examples are available as ` ipython ` notebooks in our public repository.^[fn : repo]^       g @xmath80 and particle size @xmath81 cm .",
    "the particle has initial semi - major axis of 1au , and initial eccentricity of @xmath82 . with a fixed - time - step of @xmath83 yr , the 2nd - order rk integrator ( green - dashed ) is unstable , while the 2nd - order slimplectic integrator ( red ) behaves much more accurately , despite significant ( numerical ) precession over a @xmath841000 year timescale .",
    "the 4th - order integrators ( rk , blue - dashed ; slimplectic , orange ) have similar long - term amplitude evolution without visible numerical precession . the phase errors ( not shown ) of the rk integrators grow @xmath85 , while the slimplectic integrators have phase error @xmath86 ( see * ? ? ?",
    "* bottom : * fractional energy error ( compared to a 6th - order slimplectic integration ) for the system described above .",
    "the rk errors grow roughly linearly in time , while the slimplectic errors are bounded .",
    "there is a slight turn - up in the 4th - order slimplectic error envelope , most likely due to the build up of round - off , bias , or action - discretization error .",
    "[ fig : prdrag ] , title=\"fig : \" ]   g @xmath80 and particle size @xmath81 cm .",
    "the particle has initial semi - major axis of 1au , and initial eccentricity of @xmath82 . with a fixed - time - step of @xmath83 yr , the 2nd - order rk integrator ( green - dashed ) is unstable , while the 2nd - order slimplectic integrator ( red ) behaves much more accurately , despite significant ( numerical ) precession over a @xmath841000 year timescale .",
    "the 4th - order integrators ( rk , blue - dashed ; slimplectic , orange ) have similar long - term amplitude evolution without visible numerical precession . the phase errors ( not shown ) of the rk integrators grow @xmath85 , while the slimplectic integrators have phase error @xmath86 ( see * ? ? ?",
    "* bottom : * fractional energy error ( compared to a 6th - order slimplectic integration ) for the system described above .",
    "the rk errors grow roughly linearly in time , while the slimplectic errors are bounded .",
    "there is a slight turn - up in the 4th - order slimplectic error envelope , most likely due to the build up of round - off , bias , or action - discretization error .",
    "[ fig : prdrag ] , title=\"fig : \" ]    we first examine the orbital motion of a dust particle experiencing poynting - robertson drag  @xcite due to radiation from a solar type star , starting with a semi - major axis of 1au in an eccentric ( @xmath87 ) orbit .",
    "the lagrangian for this system is @xmath88 where @xmath89 is the dust particle s mass , and @xmath90 its position .",
    "the dimensionless factor @xmath91 is the ratio between forces due to radiation pressure and gravity , where @xmath92 and @xmath93 are the solar luminosity and mass , @xmath94 and @xmath95 are the density and size of the dust grain . the nonconservative potential which generates the correct poynting - robertson drag force is ( for @xmath96 ) found as the virtual work from the known force , @xmath97.\\end{aligned}\\ ] ] methods to determine or derive @xmath4 are discussed in  @xcite .",
    "the first term in square brackets above gives the usual drag term , while the second term is due to the doppler shift caused by radial motion .",
    "the system was integrated for @xmath98 years using 2nd and 4th - order rk ( green and blue dashed ) and slimplectic ( red and orange solid ) methods with time - steps of @xmath83 yr .",
    "the results and discussion are shown in figure  [ fig : prdrag ] .      .",
    "each of the methods ( rk and slimplectic ggl ) are 4th order with fixed timesteps of @xmath99 and @xmath100 .",
    "the integration methods blow up when the orbital time - scale is comparable to the time step , though the slimplectic method performs significantly better than the rk method for the same time steps ; for the @xmath101 time - step the rk method is immediately unstable .",
    "+ * bottom : * relative error in the orbital radius compared to the analytic adiabatic - approximation solution .",
    "+ [ fig : pnr ] , title=\"fig : \" ] .",
    "each of the methods ( rk and slimplectic ggl ) are 4th order with fixed timesteps of @xmath99 and @xmath100 .",
    "the integration methods blow up when the orbital time - scale is comparable to the time step , though the slimplectic method performs significantly better than the rk method for the same time steps ; for the @xmath101 time - step the rk method is immediately unstable . + * bottom : * relative error in the orbital radius compared to the analytic adiabatic - approximation solution .",
    "+ [ fig : pnr ] , title=\"fig : \" ]    we also consider two @xmath102 neutron stars inspiraling from gravitational wave emission .",
    "this example demonstrates ( fixed - time - step ) integrators for systems where the orbital dynamics can change quickly due to nonconservative effects . in the post - newtonian ( pn )",
    "approximation , leading - order conservative dynamics for the orbital separation , @xmath90 , are described by newtonian gravity @xmath103 where @xmath104 is the total mass , @xmath105 is the reduced mass , and @xmath106 .",
    "dissipative effects from radiation reaction first appear at pn order @xmath107 ( or 2.5pn ) and are described by @xmath4 , which has been calculated in  @xcite . after order - reduction , @xmath108 where @xmath109 .",
    "a physically consistent simulation should go to the same pn order in @xmath3 and @xmath4 . here , instead , we use the leading order in each as a toy model to focus on the numerical method .    .",
    "+ * bottom : * absolute orbital - phase errors . in this example , both slimplectic integrators ( phase error @xmath86 ) , track the orbital phase much better than the equivalent rk integrators ( phase error @xmath85 ) .",
    "[ fig : pnphi ] , title=\"fig : \" ] . +",
    "* bottom : * absolute orbital - phase errors . in this example , both slimplectic integrators ( phase error @xmath86 ) , track the orbital phase much better than the equivalent rk integrators ( phase error @xmath85 ) .",
    "[ fig : pnphi ] , title=\"fig : \" ]    in figures  [ fig : pnr ] and [ fig : pnphi ] we examine the 4th - order rk and slimplectic integrators for different choices of time steps , @xmath99 and @xmath110 , the orbital period at the innermost stable circular orbit .",
    "the initial orbital separation is @xmath111 km and corresponds to an orbital frequency of @xmath112hz .",
    "we compare our numerical results to analytic solutions to our toy pn equations in the adiabatic regime , @xmath113 where the orbital period is assumed to be much smaller than the radiation reaction time scale for the inspiral  @xcite .",
    "all integrators begin to fail when the orbital period becomes roughly comparable to the time - step , although the slimplectic integrators can get significantly closer to this limit than the rk method ( the rk integrator with time - step @xmath99 immediately becomes unstable ) . in our followup paper",
    ", we will demonstrate an adaptive time - stepping scheme that will allow efficient slimplectic integrations that also precisely evolve the energy .",
    "we have developed a new method of numerical integration that combines the nonconservative action principle of  @xcite with the variational - integrator approach of  @xcite .",
    "these `` slimplectic '' integrators allow nonconservative effects to be included in the numerical evolution , while still possessing the major benefits of normally conservative symplectic integrators , particularly the accurate long - term evolution of momenta and energy .",
    "the discrete equations of motion are found by varying a discretized nonconservative action and implicitly define the slimplectic mapping @xmath61 .",
    "different choices of discretization generate different variational integrators . here",
    "we have focused on implementing the galerkin - gauss - lobatto ( ggl ) discretization , and demonstrating its long - term accuracy using the damped harmonic oscillator , poynting - robertson drag on a small particle , and a gravitational radiation - reaction toy problem .",
    "our results also explain why the modification of the 2nd - order `` kick - drift - kick '' ansatz to include dissipative forces performs so accurately , as this is equivalent to the lowest order version of the slimplectic ggl method .",
    "we have developed a demonstration ` python ` code , ` slimplectic`,^[fn : repo]^ which generates slimplectic integrators for arbitrary lagrangians and nonconservative potentials .",
    "readers are encouraged to test different physical systems of interest using this publicly available code , but to separately implement problem specific optimizations , particularly when solving the implicit equations of motion .",
    "_ acknowledgments _  we thank a.  cumming , a.  archibald , d.  tamayo , d.p .",
    "hamilton , m.c .",
    "miller , and the referee , w. farr , for useful discussion . d.t .  was supported by the lorne trottier chair in astrophysics and cosmology and craq .",
    "c.r.g .  was supported in part by nsf grants career phy-0956189 and phy-1404569 at caltech .",
    "l.c.s .  was supported by nasa through einstein postdoctoral fellowship award number pf2 - 130101 ."
  ],
  "abstract_text": [
    "<S> symplectic integrators are widely used for long - term integration of conservative astrophysical problems due to their ability to preserve the constants of motion ; however , they can not in general be applied in the presence of nonconservative interactions . in this letter , we develop the `` slimplectic '' integrator , a new type of numerical integrator that shares many of the benefits of traditional symplectic integrators yet is applicable to general nonconservative systems . </S>",
    "<S> we utilize a fixed - time - step variational integrator formalism applied to the principle of stationary nonconservative action developed in  @xcite . as a result , the generalized momenta and energy ( noether current ) </S>",
    "<S> evolutions are well - tracked . </S>",
    "<S> we discuss several example systems , including damped harmonic oscillators , poynting - robertson drag , and gravitational radiation reaction , by utilizing our new publicly available code to demonstrate the slimplectic integrator algorithm .    </S>",
    "<S> slimplectic integrators are well - suited for integrations of systems where nonconservative effects play an important role in the _ long - term _ dynamical evolution . as such they are particularly appropriate for cosmological or celestial n - body dynamics problems where nonconservative interactions , e.g.  gas interactions or dissipative tides , can play an important role . </S>"
  ]
}