{
  "article_text": [
    "dna microarrays have been used successfully to identify gene expression signatures characteristic of disease subtypes [ @xcite ] or distinct outcomes to therapy [ @xcite ] .",
    "many statistical methods have been developed to select genes for disease diagnosis , prognosis and therapeutic targets .",
    "however , gene selection alone may not be sufficient . in cancer pharmacogenomics , for instance , cancer drugs are increasingly designed to target specific pathways to account for the complexity of the oncogenic process and the complex relationships between genes [ @xcite ] .",
    "metabolic pathways , for example , are defined as a series of chemical reactions in a living cell that can be activated or inhibited at multiple points .",
    "if a gene at the top of a signaling cascade is selected as a target , it is not guaranteed that the reaction will be successfully inactivated , because multiple genes downstream can still be activated or inhibited .",
    "signals are generally relayed via multiple signaling routes or networks . even if a branch of the pathway is completely blocked by inhibition or activation of multiple genes",
    ", the signal may still be relayed through an alternative branch or even through a different pathway [ @xcite ] .",
    "@xcite pointed out that targeting a single pathway or a few signaling pathways might not be sufficient .",
    "thus , the focus is increasingly on identifying both relevant genes and pathways .",
    "genes and/or gene products generally interact with one another and they often function together concertedly . here",
    "we propose a bayesian model that addresses this question by incorporating information of pathway memberships and gene networks in the analysis of dna microarray data .",
    "such information is used to define pathway summaries , specify prior distributions , and structure the mcmc moves .",
    "several public and commercial databases have been developed to structure and store the vast amount of biological knowledge accumulated over the years into functionally or biochemically related groups .",
    "these databases focus on describing signaling , metabolic or regulatory pathways .",
    "some examples include gene ontology ( go ) [ @xcite ] , kyoto encyclopedia of genes and genomes ( kegg ) [ @xcite ] , metacyc [ @xcite ] , pathdb , reactome knowledgebase [ @xcite ] , invitrogen ipath ( http://www.invitrogen.com[www.invitrogen.com ] ) and cell signaling technology ( cst ) pathway ( http://www.cellsignal.com[www.cellsignal.com ] ) . the need to integrate gene expression data with the biological knowledge accumulated in these databases is well recognized .",
    "several software packages that query pathway information and overlay dna microarray data on pathways have been developed .",
    "@xcite implemented a visualization tool that color - codes kegg pathway diagrams to reflect changes in their gene expression levels .",
    "genmapp [ @xcite ] is another graphical tool that allows visualization of microarray data in the context of biological pathways or any other functional grouping of genes .",
    "@xcite use genmapp to view genes involved in specific go terms .",
    "another widely used method that relates pathways to a set of differentially expressed genes is the gene set enrichment analysis ( gsea ) [ @xcite ] .",
    "given a list of genes , gsea computes an enrichment score to reflect the degree to which a predefined pathway is over - represented at the top or bottom of the ranked list .",
    "these procedures are useful starting points to observe gene expression changes for known biological processes .",
    "recent studies have gone a step further and focused on incorporating pathway information or gene  gene network information into the analysis of gene expression data .",
    "for example , @xcite have attempted to incorporate go annotation to predict survival time , first grouping genes based on their go membership , calculating the first principal component to form a super - gene within each cluster and then applying a cox model with @xmath0 penalty to identify super - genes , that is , go terms related to the outcome . @xcite",
    "have considered a small set of 33 preselected signaling pathways and used the implied relationships among genes to infer differentially expressed genes , and @xcite have extended this work by including a temporal dimension . @xcite and @xcite have proposed different procedures that use the gene  gene network to build penalties in a regression model for gene selection .",
    "bayesian approaches have also been developed .",
    "@xcite have incorporated the dependence structure of transcription factors in a regression model with gene expression outcomes . there , a network is defined based on the hamming distance between candidate motifs and used to specify a markov random field prior for the motif selection indicator .",
    "@xcite have proposed a model for the identification of differentially expressed genes that takes into account the dependence structure among genes from available pathways while allowing for correction in the gene network topology .",
    "@xcite use a markov random field prior that captures the gene ",
    "gene interaction network in a discriminant analysis setting .",
    "these methods use the gene - pathway relationships or gene network information to identify either the important pathways or the genes .",
    "our goal is to develop a more comprehensive method that selects both pathways and genes using a model that incorporates pathway - gene relationships and gene dependence structures . in order to identify relevant genes and pathways ,",
    "latent binary vectors are introduced and updated using a two - stage metropolis ",
    "hastings sampling scheme .",
    "the gene networks are used to define a markov random field prior on the gene selection indicators and to structure the markov chain monte carlo ( mcmc ) moves .",
    "in addition , the pathway information is used to derive pathway expression measures that summarize the group behavior of genes within pathways . in this paper",
    "we make use of the first latent components obtained by applying partial least squares ( pls ) regressions on the selected genes from each pathway .",
    "pls is an efficient statistical regression technique that was initially proposed in the chemometrics literature [ @xcite ] and more recently used for the analysis of genomic and proteomic data ; see @xcite .",
    "we apply the model to simulated and real data using the pathway structure from the kegg database .",
    "our simulation studies show that the mrf prior leads to a better separation between relevant and nonrelevant pathways , and to less false positives in a model with fairly small regression coefficients .",
    "other authors have reported similar results .",
    "@xcite , in particular , comment on the effect of the mrf prior on the selection power in their linear regression setting .",
    "they also notice that adding the mrf prior implies a relatively small increase in computational cost .",
    "@xcite ( @xcite ) report that their method is quite effective in identifying genes and modified subnetworks and that it has higher sensitivity than commonly used procedures that do not use the pathway structure , with similar and , in some cases , lower false discovery rates .",
    "furthermore , in our model formulation we use the network information not only for prior specification but also to structure the mcmc moves .",
    "this is helpful for arriving at promising models faster by proposing relevant configurations . in real data applications",
    "the integration of pathway information may allow the identification of relevant predictors that could be missed otherwise , aiding the interpretation of the results , in particular , for the selected genes that are connected in the mrf , and also improving the prediction accuracy of selected models .",
    "the paper is organized as follows .",
    "section  [ sec2 ] contains the model formulation and prior specification .",
    "section  [ sec3 ] describes the mcmc procedure and strategies for posterior inference . in section  [ sec4 ] performances",
    "are evaluated on simulated data and an application of the method to gene expression data with survival outcomes is presented .",
    "section  [ sec5 ] concludes the paper with a  brief discussion .",
    "[ sec2 ] we describe how we incorporate pathway and gene network information into a bayesian modeling framework for gene and pathway selection . figure [ figure1 ] represents a schematic representation of our approach and model .",
    "[ sec2.1 ] our goal is to build a model for identifying pathways related to a particular phenotype while simultaneously locating genes from these selected pathways that are involved in the biological process of interest .",
    "the data we have available for analysis consist of the following :    @xmath1 , an @xmath2 vector of outcomes .",
    "@xmath3 , an @xmath4 matrix of gene expression levels . without loss of generality , @xmath3  is centered so that its columns sum to 0 .",
    "@xmath5 , a @xmath6 matrix indicating membership of genes in pathways , with elements @xmath7 if gene @xmath8 belongs to pathway @xmath9 , and @xmath10 otherwise .",
    "@xmath11 , a @xmath12 matrix describing relationships between genes , with @xmath13 if genes @xmath14 and @xmath8 have a direct link in the gene network , and @xmath15 otherwise .",
    "the matrices @xmath5 and @xmath11 are constructed using information retrieved from pathway databases ; see the application in section [ sec : app ] for details .    ) .",
    "the goal of the inference is to identify the pathways to be included in the model and the genes to be included within those pathways . ]    since the goal of the analysis is to study the association between the response variable and the pathways , we need to derive a score as a measure of `` pathway expression '' that summarizes the group behavior of included genes within pathways .",
    "we do this by using the latent components from a pls regression of @xmath1 on selected subsets of genes from each pathway .",
    "a number of recent studies have , in fact , applied dimension reduction techniques to capture the group behavior of multiple genes .",
    "@xcite , for instance , first apply @xmath9-means clustering to identify subsets of potentially related genes , then use as regressors the first principal components obtained from applying principal component analysis ( pca ) to each cluster .",
    "@xcite start by removing genes that have low univariate correlation with the outcome variable , then apply pca on the remaining genes to form clusters or conceptual pathways , which are used as regressors . in our method , instead of attempting to infer conceptual pathways , we use the existing pathway information . we compute a pathway activity measure by applying pls regression of @xmath1 on a subset of selected genes from the pathway .",
    "pls has the advantage of taking into account the covariance between regressors and the response variable  @xmath1 , whereas pca focuses solely on the variability in the covariate data .",
    "the selection of a subset of gene expressions to form the pls components is similar in spirit to the sparse pca method proposed by @xcite , which selects variables to form the principal components .    to identify both relevant groups and important genes , we introduce two binary vector indicators , a @xmath16 vector @xmath17 for the inclusion of the groups and a @xmath18 vector @xmath19 for the inclusion of genes , that is , @xmath20 if gene @xmath8 is selected for at least one pathway score , and @xmath21 otherwise . assuming that the response @xmath1 is continuous , the linear regression model that relates @xmath1 to the selected pathways and genes is @xmath22 where @xmath23 is the number of selected pathways and where @xmath24 corresponds to the first latent pls component generated based on the expression levels of selected genes belonging to pathway @xmath9 , that is , using the  @xmath25 s corresponding to @xmath7 and @xmath20 . to be more precise ,",
    "let pathway  @xmath9 contain @xmath26 genes and let @xmath27 denote the number of selected genes ( i.e. , genes included in the model ) that belong to pathway  @xmath9 .",
    "then @xmath28 corresponds to the first latent pls component generated by applying pls to the expression data of the @xmath29 genes , denoted as @xmath30 , @xmath31 where @xmath32 is the @xmath33 eigenvector corresponding to the largest eigenvalue of @xmath34 , with @xmath35 [ see , e.g. , @xcite ] .",
    "thus , @xmath36 is an @xmath2 vector and @xmath37 is a scalar .",
    "model ( [ eq : model2 ] ) can therefore be seen as a pls regression model with pls components restricted to available pathways , and where the goal of the inference is to identify the pathways to be included in the model , and the genes to be included within those pathways .",
    "[ sec2.2 ] in the construction above , we have assumed a continuous response .",
    "however , our model formulation can easily be extended to handle categorical or censored outcome variables .",
    "when @xmath1 is a categorical variable taking one of @xmath38 possible values , @xmath39 , a probit model can be used , as done by @xcite , @xcite and @xcite .",
    "briefly , each outcome @xmath40 is associated with a vector @xmath41 , where @xmath42 is the probability that subject @xmath14 falls in the @xmath43th category .",
    "the probabilities @xmath44 can be related to the linear predictors using a data augmentation approach .",
    "let @xmath45 be latent data corresponding to the unobserved propensities of subject @xmath14 to belong to one of the classes .",
    "when the observed outcomes @xmath40 correspond to nominal values , the relationship between @xmath40 and @xmath46 can be defined  as @xmath47 a multivariate normal model can then be used to associate @xmath45 to the predictors @xmath48    if the observed outcomes @xmath40 correspond , instead , to ordinal categories , the latent variable @xmath49 is defined such that @xmath50 if @xmath51 , @xmath52 , where the boundaries @xmath53 are unknown and @xmath54 .",
    "the latent variable @xmath49 is associated with the predictors through the linear model @xmath55    for censored survival outcomes , an accelerated failure time ( aft ) model can be used [ @xcite ; @xcite ] . in this case , the observed data are @xmath56 and @xmath57 , where @xmath58 is the survival time for subject @xmath14 , @xmath59 is the censoring time , and @xmath60 is a censoring indicator .",
    "a data augmentation approach can be used and latent variables  @xmath49 can be introduced such that @xmath61 the aft model can then be written in terms of the latent @xmath49 similarly to ( [ eq : augment2 ] ) where the @xmath62 s are independent and identically distributed random variables that may take one of several parametric forms . @xcite",
    "consider cases where @xmath63 follows a normal or a @xmath64-distribution .",
    "the regression coefficient @xmath65 in ( [ eq : model2 ] ) measures the effect of the pls latent component summarizing the effect of pathway @xmath9 on the response variable .",
    "however , not all pathways are related to the phenotype and the goal is to identify the predictive ones .",
    "bayesian methods that use mixture priors for variable selection have been thoroughly investigated in the literature , in particular , for linear models ; see @xcite for multiple regression , @xcite for extensions to multivariate responses and @xcite for probit models .",
    "a comprehensive review on features of the selection priors and on computational aspects of the method can be found in @xcite .",
    "similarly , we use the latent vector @xmath17 to specify a scale mixture of a normal density and a point mass at zero for the prior on each  @xmath65 in ( [ eq : model2]):=-1 @xmath66=0 where @xmath67 is a dirac delta function .",
    "the hyperparameter @xmath68 in ( [ eq : priorbeta ] ) regulates , together with the hyperparameters of @xmath69 defined in section  [ sec2.4 ] below , the amount of shrinkage in the model .",
    "we follow the guidelines provided by @xcite and specify @xmath68 in the range of variability of the data so as to control the ratio of prior to posterior precision . for the intercept term , @xmath70 , and the variance , @xmath71 , we take conjugate priors @xmath72 and @xmath73 , where @xmath74 , @xmath75 , @xmath76 , @xmath68 , @xmath77 and @xmath78 are to be elicited .      [ sec2.4 ] in this section",
    "we define the prior distributions for the pathway selection indicator , @xmath17 , and gene selection indicator , @xmath19 .",
    "these priors are first defined marginally then jointly , taking into account some necessary constraints .",
    "each element of the latent @xmath79-vector @xmath17 is defined as @xmath80 for @xmath81 .",
    "we assume independent bernoulli priors for the @xmath82 s , @xmath83 where @xmath84 determines the proportion of pathways expected a priori in the model .",
    "a mixture prior can be further specified for @xmath84 to achieve a better discrimination in terms of posterior probabilities between significant and nonsignificant pathways by inflating @xmath85 toward 1 for the nonrelevant pathways , as first suggested by @xcite , @xmath86 where @xmath87 is a beta density function with parameters @xmath88 and @xmath89 .",
    "since inference on @xmath84 is not of interest , it can be integrated out to simplify the mcmc implementation .",
    "this leads to the following marginal prior for  @xmath17 : @xmath90,\\ ] ] where @xmath91 is the beta function .",
    "prior ( [ eq : priorphi ] ) corresponds to a product of bernoulli distributions with parameter @xmath92 .    for the latent @xmath93-vector @xmath19",
    "we specify a prior distribution that is able to take into account not only the pathway membership of each gene but also the biological relationships between genes within and across pathways , which are captured by the matrix @xmath94 .",
    "following @xcite , we model these relations using a markov random field ( mrf ) , where genes are represented by nodes and relations between genes by edges .",
    "a mrf is a graphical model in which the distribution of a set of random variables follow markov properties that can be described by an undirected graph . in particular ,",
    "two unconnected genes are considered conditionally independent given all other genes [ @xcite ] .",
    "relations on the mrf are represented by the following probabilities : @xmath95 where @xmath96 and @xmath97 is the set of direct neighbors of gene @xmath8 in the mrf using only pathways represented in the model , that is , pathways with @xmath98 .",
    "the corresponding global distribution on the mrf is given by @xmath99 with @xmath100 the unit vector of dimension @xmath93 and @xmath11 the matrix introduced in section [ sec : reg ] .",
    "the parameter @xmath101 controls the sparsity of the model , while @xmath102 regulates the smoothness of the distribution of @xmath103 over the graph by controlling the prior probability of selecting a gene based on how many of its neighbors are selected .",
    "in particular , higher values of @xmath102 encourage the selection of genes with neighbors already selected into the model .",
    "if a gene does not have any neighbor , then its prior distribution reduces to an independent bernoulli with parameter @xmath104 $ ] , which is a logistic transformation of @xmath101 .    here , unlike @xcite , who fix both parameters of the mrf prior",
    ", we specify a hyperprior for @xmath102 . we give positive probability to values of  @xmath102 bigger than @xmath105 , which is biologically more intuitive than negative values of this parameter ( which would favor neighboring genes to have different inclusion status ) .",
    "such restriction on the domain of @xmath102 also minimizes the `` phase transition '' problem that typically occurs with mrf parameterizations of type ( [ mrf ] ) , where the dimension of the selected model increases massively for small increments of @xmath102 . when the phase transition occurs the number of selected genes increases substantially . here ,",
    "after having detected the phase transition value @xmath106 , by simulating from ( [ priormrf ] ) over a grid of @xmath107 values , we specify a beta distribution @xmath108 on @xmath109 .",
    "constraints need to be imposed to ensure both interpretability and identifiability of the model .",
    "we essentially want to avoid the following :    empty pathways , that is , selecting a pathway but none of its member genes ;    orphan genes , that is , selecting a gene but none of the pathways that contain it ;    selection of identical subsets of genes by different pathways , a situation that generates identical values @xmath28 and @xmath110 to be included in the model .",
    "these constraints imply that some combinations of @xmath17 and @xmath19 values are not allowed .",
    "the joint prior probability for @xmath111 taking into account these constraints is given by @xmath112",
    "[ sec3 ]    we now describe our mcmc procedure to fit the model and discuss strategies for posterior inference with huge posterior spaces , as in this model . in the bayesian literature on variable selection for standard linear regression models stochastic search algorithms have been designed to explore the posterior space , and have been successfully employed in genomic applications with prohibitive settings , handling models with thousands of genes .",
    "a key to these applications is the assumption of sparsity of the model , that is , the belief that the response is associated with a small number of regressors .",
    "a stochastic search then allows one to explore the posterior space in an effective way , quickly finding the most probable configurations , that is , those corresponding to coefficients with high marginal probabilities , while spending less time in regions with low posterior probability .",
    "we describe below the mcmc algorithm we have designed for our problem . in particular , borrowing from the literature on stochastic searches for variable selection , we work with a marginalized model and design a  metropolis  hastings algorithm that updates the indicator parameters for the inclusion of pathways and genes with a set of moves that add and/or delete a single gene and a single pathway . also , we update the parameter @xmath102 of the mrf from its posterior distribution by employing the general method proposed by @xcite . in @xcite",
    "we discuss how our bayesian stochastic search variable selection kernel generates an ergodic markov chain over the restricted space . in applications",
    ", we have found that a good way to asses if the stochastic exploration can be considered satisfactory is to check the concordance of the posterior probabilities obtained from different chains started from different initial points .",
    "the model parameters consist of @xmath113 @xmath114 .",
    "the mcmc procedure can be made more efficient by integrating out some of the parameters .",
    "here , we integrate out the regression parameters , @xmath70 , @xmath115 and @xmath71 .",
    "this leads to a multivariate @xmath64-distribution @xmath116 with @xmath77 degrees of freedom and @xmath117 an @xmath118-vector of ones , and where @xmath119 , with @xmath120 the @xmath121 identity matrix , and @xmath122 the @xmath123 matrix derived from the first pls latent components for the selected pathways using the selected genes . in the notation ( [ eq : fulcondy ] )",
    "the two arguments of the @xmath64-distribution represent the mean and the scale parameter of the distribution , respectively .",
    "the posterior probability distribution of the pathway and gene selection indicators is then given by @xmath124      the mcmc steps consist of the following : ( i ) sampling pathway and gene selection indicators from @xmath125 ; ( ii ) sampling the mrf parameter from @xmath126 ; ( iii ) sampling additional parameters introduced when fitting probit models for categorical outcomes or aft models for survival data .",
    "a.   the parameters @xmath111 are updated using a metropolis ",
    "hastings algorithm in a two - stage sampling scheme .",
    "the pathway - gene relationships are used to structure the moves and account for the constraints specified in section [ sec : priorselection ] .",
    "details of the mcmc moves to update @xmath111 are given in @xcite .",
    "they consist of randomly choosing one of the following move types : 1 .   change the inclusion status of gene and pathway by randomly choosing between adding a pathway and a gene or removing them both ; 2 .   change the inclusion status of gene but not pathway by randomly choosing between adding a gene or removing a gene ; 3 .   change the inclusion status of pathway but not gene by randomly choosing between adding a pathway or removing a pathway .",
    "b.   at this step we want to draw the mrf parameter @xmath102 from the posterior density @xmath127 .",
    "the prior distribution on @xmath19 is of the form @xmath128 with unnormalized density @xmath129 and a normalizing constant @xmath130 which is not available analytically . when calculating the metropolis ",
    "hastings ratio to determine the acceptance probability of a new value @xmath131 , @xmath132 with @xmath133 the current value for @xmath102 , one needs to take into account that @xmath134 .",
    "following @xcite , we introduce an auxiliary variable @xmath135 , defined on the same state space as that of @xmath19 , which has conditional density @xmath136 , and consider the posterior @xmath137 , which of course still involves the unknown @xmath138 .",
    "obviously , marginalization over @xmath135 of @xmath139 gives the desired distribution @xmath140 .",
    "now , if @xmath141 is the current state of the algorithm , we first propose @xmath131 with density @xmath142 , then @xmath143 with density @xmath144 . as usual",
    ", the choice of these proposal densities is arbitrary from the point of view of the equilibrium distribution of the chain of @xmath102 values .",
    "the choice of @xmath136 is also arbitrary .",
    "the key idea of the method proposed by @xcite is to take the proposal density for the auxiliary variable @xmath135 to be of the same form as  ( [ moller1 ] ) , but dependent on @xmath131 rather than @xmath133 , that is , @xmath145 then the metropolis  hastings ratio becomes @xmath146 and no longer depends on @xmath147 . the new value @xmath143 for the auxiliary variable @xmath135 is drawn from ( [ moller2 ] ) by perfect simulation using the algorithm proposed by @xcite . c.   in the case of classification or survival outcomes ,",
    "the augmented data @xmath148 need to be updated from their full conditionals using gibbs sampling ; see @xcite , @xcite and @xcite for details .",
    "the mcmc procedure results in a list of visited models with included pathways indexed by @xmath17 and selected genes indexed by  @xmath19 , and their corresponding relative posterior probabilities .",
    "pathway selection can be based on the marginal posterior probabilities @xmath149 .",
    "a  simple strategy is to compute monte - carlo estimates by counting the number of appearances of each pathway across the visited models .",
    "relevant pathways are identified as those with largest marginal posterior probabilities",
    ". then relevant genes from these pathways are identified based on their marginal posterior probabilities conditional on the inclusion of a pathway of interest , @xmath150 .",
    "an alternative inference for gene selection is to focus on a subset of pathways , @xmath151 , and consider the marginal posterior probability conditional on at least one pathway the gene belongs to being represented in the model , @xmath152 .",
    "we note that rao ",
    "blackwellized estimates have been employed in standard linear regression models , in place of frequency estimates , by averaging the full conditional posterior probabilities of the inclusion indicators .",
    "these estimates are computationally quite expensive , though they may have better precision , as noted by @xcite . because of our strategy for inference , that selects first pathways and then genes conditional on selected pathways , rao ",
    "blackwellized estimates of marginal probabilities may not be straightforward to derive . in all simulations and examples reported in this paper",
    "we have obtained satisfactory results by simply estimating the marginal posterior probabilities with the corresponding relative frequencies of inclusion in the visited models .",
    "inference for a new set of observations , @xmath153 , can be done via least squares prediction , @xmath154 , where @xmath155 is the first principal component based on selected genes from relevant pathways and where @xmath156 and @xmath157 , with @xmath1 the response variable in the training and @xmath158 the scores obtained from the training data using selected pathways and genes included in the model .",
    "note that for prediction purposes , since we do not know the future @xmath159 , a pls regression can not be fit .",
    "therefore , we generate @xmath160 by considering the first latent component obtained by applying pca to each selected pathway using the included genes .    in the case of categorical or censored survival outcomes ,",
    "the sampled latent variables @xmath148 would be used to estimate @xmath161 , then the correspondence between @xmath148 and the observed outcome outlined in section [ sec : surv ] can be invoked to predict @xmath159 [ @xcite ( @xcite ) ; @xcite ] .",
    "we assess performances on simulated data , then illustrate an application to microarrays using the kegg pathway database to define the mrf .",
    "[ sec4.1 ] we investigated the performance of our model using simulated data based on the gene - pathway relations , @xmath5 , and gene network , @xmath11 , of 70 pathways and 1,098 genes from the kegg database .",
    "the relevant pathways were defined by selecting 4 pathways at random . for each of the 4 selected pathways ,",
    "one gene was picked at random and its direct neighbors that belong to the selected pathways were chosen .",
    "this resulted in the selection of 4 pathways and 15 genes : 7 out of 30 from the first pathway , 3 out of 35 from the second , 3 out of 105 from the third , and 2 out of 47 from the fourth pathway .",
    "gene expressions for @xmath162 samples were simulated for these 15 genes using an approach similar to @xcite .",
    "this was accomplished by first creating an ordering among the 15 selected genes by changing the undirected edges in the gene networks into directed edges .",
    "the first node on the ordering , which we denote by @xmath163 , was selected from each pathway and drawn from a standard normal distribution ; note that this node has no parents .",
    "then all child nodes directly connected only to @xmath163 and denoted by @xmath164 were drawn from @xmath165 .",
    "subsequent child nodes at generation @xmath8 , @xmath166 , were drawn using all parents from @xmath167 , where @xmath168 indicates the set of parents of node @xmath8 and @xmath169 is a matrix containing the expressions of all the @xmath170 parents for node @xmath8 .",
    "the expression levels of the remaining 1,073 genes deemed irrelevant were simulated from a standard normal density .",
    "the response variables for the @xmath162 samples were generated from @xmath171 for the first data set we set @xmath172 , with the same sign for genes belonging to the same pathways .",
    "for the second and third data sets we used @xmath173 and @xmath174 , respectively .",
    "note how the generating process is different from model ( [ eq : model2 ] ) being fit .",
    "we report results obtained by choosing , when possible , hyperparameters that lead to weakly informative prior distributions .",
    "a vague prior is assigned to the intercept @xmath70 by setting @xmath76 to a large value tending to @xmath175 . for @xmath71 ,",
    "the shape parameter can be set to @xmath176 , the smallest integer such that the variance of the inverse - gamma distribution exists , and the scale parameter  @xmath177 can be chosen to yield a weakly informative prior .",
    "for the vector of regression coefficients , @xmath178 , we set the prior mean to @xmath179 and choose  @xmath68 in the range of variability of the covariates , as suggested in section [ sec : priorbeta ] .",
    "specifically , we set @xmath180 , @xmath181 , @xmath182 , and @xmath183 . for the pathway selection indicators , @xmath82 , we set @xmath184 . as for the prior at the gene level ,",
    "we set @xmath185 , corresponding to setting the proportion of genes expected a priori in the model to , at least , 3% of the total number of genes . parameters @xmath186 and @xmath101 influence the sparsity of the model and consequently the magnitude of the marginal posterior probabilities .",
    "some sensitivity is , of course , to be expected .",
    "however , in our simulations we have noticed that the ordering of pathways and genes based on posterior probability remains roughly the same and , therefore , the final selections are unchanged as long as one adjusts the threshold on the posterior probabilities . also , for the hyperprior on @xmath102 , we set @xmath187 , to avoid the phase transition problem , and @xmath188 and @xmath189 , to obtain a prior distribution that favors bigger values of @xmath102 in the interval @xmath190 . in our simulations",
    "we did not notice sensitivity to the specification of @xmath191 and @xmath192 .    , and conditional posterior probabilities for gene selection , @xmath193 , for the three simulated data sets .",
    "open circles indicate pathways and genes used to generate the outcome variable . ]",
    "the mcmc sampler was run for 300,000 iterations with the first 50,000 used as burn - in .",
    "we computed the marginal posterior probabilities for selection , @xmath194 , and the conditional posterior probabilities for gene selection given a subset of selected pathways , @xmath195 .",
    "figure [ fig : ppsimpathways ] displays the marginal posterior probabilities of inclusion for all 70 pathways and the conditional posterior probabilities of inclusion for all 1,098 genes .    important pathways and genes can be selected as those with highest posterior probabilities .",
    "for example , in all 3 scenarios all four relevant pathways were selected with a marginal posterior probability cutoff of 0.8 . reducing the selection threshold to a marginal posterior probability of 0.5 pulls in two false positive pathways , for all the three simulated scenarios considered .",
    "one of the false positives is the pathway with index 17 in figure [ fig : ppsimpathways ] , which contains more than 100 genes",
    ". a  closer investigation of the mcmc output reveals that different subsets of its member genes are selected whenever it is included in the model , resulting in a high marginal posterior of inclusion for the pathway but low marginal posterior probabilities for all its member genes .",
    "the second false positive pathway appears to be selected often because it contains two or three of the relevant genes that were used to simulate the response variable and were also included in the model with high marginal posterior probabilities ; all its other member genes have very low probabilities of selection .",
    "as expected , the identification of the relevant genes is easier when the signal - to - noise ratio is higher .",
    "conditional upon the best 4 selected pathways , a marginal posterior probability cutoff of 0.5 on the marginal probability of gene inclusion leads to the selection of 7 , 8 and  8 relevant genes , for the three scenarios , respectively , and no false positives . with a marginal probability threshold of 0.1 , 14 of the relevant genes",
    "are selected with 4 false positives for the scenario with @xmath196 , while 13 relevant genes are selected with only two false positives for the simulated data with @xmath173 . in the simulated setting with @xmath174 all the 15 relevant genes",
    "are selected without any false positive at a threshold of 0.12 .",
    "generally speaking , the effect of the mrf prior depends on the concordance of the prior network with the data . for the simulated data , we found that the model with the mrf prior , compared to the same model without the mrf , performs better in terms of pathway selection , as it provides a  clearer separation between relevant and nonrelevant pathways .",
    "in particular , the average difference , over the three scenarios , between the relevant pathway with the lowest posterior probability and the nonrelevant pathway with the highest posterior probability is 0.28 , while without the mrf prior it is only 0.18 .",
    "in addition , we have observed increased sensitivity of the mrf prior in selecting the true variables . for example , for the simulated case with @xmath197 , in order to select all 15 relevant genes , the marginal probability cutoff must be reduced to 0.088 at the expense of including 3 false positives .",
    "other authors have reported similar results [ @xcite ] . in the real data application",
    "we describe below , employing information on gene ",
    "gene networks aids the interpretation of the results , in particular , for those selected genes that are connected in the mrf , and improves the prediction accuracy.=-1      [ sec4.2 ]    we consider the @xcite breast cancer microarray data .. ] gene expression measures were collected on each patient using dna microarray with 24,481 probes .",
    "missing expressions were imputed using a @xmath9-nearest neighbor algorithm with @xmath198 .",
    "the procedure consists of identifying the @xmath9 closest genes to the one with missing expression in array @xmath8 using the other @xmath199 arrays , then imputing the missing value by the average expression of the @xmath9 neighbors [ @xcite ] .",
    "we focus on the 76 sporadic lymph - node - negative patients , 33 of whom developed distant metastasis within 5 years ; the remaining 43 are viewed as censored cases .",
    "we randomly split the patients into a training set of 38 samples and a test set of the same size using a fairly balanced split of metastatic / nonmetastatic cases .",
    "the goal is to identify a subset of pathways and genes that can predict time to distant metastasis .",
    "the gene network and pathway information were obtained from the kegg database .",
    "this was accomplished by mapping probes to pathways using the links between pathway node identifiers and locuslink i d . using the r package _ kegggraph _ [ @xcite ] , we first downloaded the gene network for each pathway , then merged all networks into a single one with all genes . a  total of 196 pathways and 3,592 probes were included in the analysis , with each pathway containing multiple genes and with most genes associated with several pathways .",
    "we ran two mcmc chains with different starting numbers of included variables , 50 and 80 , respectively .",
    "we used 600,000 iterations with a burn - in of 100,000 iterations .",
    "we incorporated the first latent vector of the pls for each pathway into the analysis as described in section [ sec : reg ] and set the number of pathways expected a priori in the model to @xmath200 of the total number .",
    "for the gene selection , we set the hyperparameter of the markov random field to @xmath201 , indicating that a priori at least 3% of genes are expected to be selected .",
    "we set @xmath202 , to avoid the phase transition problem , and @xmath203 and @xmath204 , to obtain a noninformative prior distribution .",
    "a sensitivity analysis showed that the posterior inference is not affected by different values of @xmath191 and @xmath192 .",
    "we set @xmath205 and @xmath206 for the prior on the regression parameters and obtained a vague prior for @xmath71 by choosing @xmath207 and @xmath208 .    the trace plots for the number of included pathways and the number of selected genes showed good mixing ( figures not shown ) .",
    "the mcmc samplers mostly visited models with 2045 pathways and 5090 genes . to assess the agreement of the results between the two chains",
    ", we looked at the correlation between the marginal posterior probabilities for pathway selection , @xmath209 , and found good concordance between the two mcmc chains with a correlation coefficient of 0.9933 .",
    "concordance among the marginal posterior probabilities was confirmed by looking at a scatter plot of @xmath149 across the two mcmc chains ( figure not shown ) .    .",
    "the 12 pathways with largest probabilities are marked with symbols .",
    "plot ( ): conditional posterior probabilities for gene selection , @xmath210 .",
    "the 41 probes with largest probability that belong to the 12 selected pathways in plot ( ) are marked with @xmath211 . ]",
    "the model also showed good predictive performance .",
    "@xcite already analyzed these data using an aft model with 3,839 probes as predictors and obtained a predictive mse of 1.9317 using the 11 probe sets with highest marginal probabilities .",
    "our model incorporating pathway information achieved a predictive mse of 1.4497 on the validation set , using 12 selected pathways and 41 probe sets with highest posterior probabilities .",
    "the selected pathways and genes are clearly indicated in the marginal posterior probability plots displayed in figure [ fig : postgene ] .",
    "if we increase the marginal probability thresholds for selection and consider a model with 7 selected pathways and 14 genes , to make the comparison more fair with the results of @xcite , we obtain a mse of 1.7614 . as a reminder ,",
    "our model selects relevant pathways and relevant genes simultaneously , while the model of @xcite selects genes only . of course , one can always select pathways post - hoc , as those that contain the selected genes .",
    "however , as single genes belong to multiple pathways , we expect our approach to give a more precise selection .    from a practical point of view , researchers can use the posterior probabilities produced by our selection algorithm as a way to prioritize the relevant pathways and genes for further experimental work .",
    "for example , the genes corresponding to the best 41 selected probe sets , conditional upon the best 12 selected pathways , are listed in table [ table : islands ] divided by islands , which correspond to sets of connected genes in the markov random field .",
    "the islands help with the biological interpretation by locating relevant branches of pathways .",
    "a subset of the selected pathways along with islands and singletons are displayed in figure [ fig : finalpath ] .",
    "several of the identified pathways are involved in tumor formation and progression .",
    "for instance , the mitogen - activated protein kinase ( mapk ) signaling pathway , involved in various cellular functions , including cell proliferation , differentiation and migration , has been implicated in breast cancer metastasis [ @xcite ] .",
    "the kegg pathway in cancers was also selected with high posterior probability .",
    "other interesting pathways are the insulin signaling pathway , which has been linked to the development , progression and outcome of breast cancer , and purine metabolism , involved in nucleotide biosynthesis and affects cell cycle activity of tumor cells .",
    "[ tabpostg ]    @p348pt@ + acacb ( 10 ) , c4a ( 8 , 12 ) , calm1 ( 10 ) , ccnb2 ( 5 ) , cd4 ( 7 ) , cdc2 ( 5 ) , cldn11 ( 7 ) , fzd9 ( 11 ) , gys2 ( 10 ) , hist1h2bn ( 12 ) , ifna7 ( 3 ) , nfasc ( 7 ) , nrcam ( 7 ) , pck1 ( 10 ) , pfkp ( 10 ) , ppargc1a ( 10 ) , pxn ( 9 ) +   + actb ( 9 ) , actg1 ( 9 ) , itga1 ( 9 ) , itga7 ( 9 ) , itgb3 ( 9 ) , itgb4 ( 9 ) , itgb6 ( 9 ) , itgb8 ( 7 , 10 ) , myl5 ( 9 ) , myl9 ( 9 ) , pdpk1 ( 10 ) , pik3cd ( 9 , 10 , 11 ) , pla2g4a ( 2 ) , plcg1 ( 11 ) , prkca ( 2 , 11 ) , prky ( 2 , 10 ) , prky ( 2 , 10 ) , ptgs2 ( 11 ) , socs3 ( 10 ) +   + acvr1b ( 2 , 3 , 11 ) , acvr1b ( 2 , 3 , 11 ) , tgfb3 ( 2 , 3 , 5 , 11 ) +   + entpd3 ( 1 ) , gmps ( 1 ) +    . ]    in addition , several genes with known association to breast cancer were also selected .",
    "protein kinase c alpha ( pkca ) , which belongs to the mapk pathway and the kegg pathways in cancer , has been reported to play roles in many different cellular processes , including cell functions associated with breast cancer progression .",
    "it has been shown to be overexpressed in some antiestrogen resistant breast cancer cell lines and to be involved in the growth of tamoxifen resistant human breast cancer cells [ @xcite ] .",
    "patients with pkca - positive tumors have been shown to have worse survival than patients with pkca - negative tumors , independently of other factors [ @xcite ] .",
    "prostaglandin - endoperoxide synthase-2 ( ptgs2 , also known as cyclooxygenase-2 or cox2 ) has also been related to breast cancer .",
    "@xcite observed cox2 overexpression in breast cancer and strong association with indicators of poor prognosis , such as lymph node metastasis , poor differentiation and large tumor size .",
    "this was further confirmed by @xcite , who showed that the expression of cox2 in human breast cancer cells facilitates the assembly of new tumor blood vessels , the release of tumor cells into the circulation , and the breaching of lung capillaries by circulating tumor cells to seed pulmonary metastasis .",
    "this is an important finding , as the majority of breast cancer deaths result from metastases rather than direct effects of the primary tumor .",
    "another gene previously shown to be predictive of breast cancer lung metastasis is integrin , beta-8 ( itgb8 ) [ @xcite ] .",
    "we also identified integrin , beta-4 ( itgb4 ) which regulates key signaling pathways related to carcinoma progression , and is linked to aggressive tumor behavior and poor prognosis in certain breast cancer subtypes [ @xcite ] .",
    "we have proposed a model that incorporates biological knowledge from pathway databases into the analysis of dna microarrays to identify pathways and genes related to a phenotype .",
    "information on pathway membership and gene networks are used to define pathway summaries , specify prior distributions that account for the dependence structure between genes , and define the mcmc moves to fit the model .",
    "the gene network prior and the synthesis of the pathway information through pls bring in additional information that is especially useful in microarray data , due to the low sample size and large measurement error .",
    "performances of the method were evaluated on simulated data and a breast cancer gene expression study with survival outcomes was used to illustrate its application .",
    "our simulation studies show the effect of the mrf prior on the posterior inference . in general , as expected , the effect of the prior depends on the data and , in particular , on the concordance of the prior network with the data . in our simulations , employing the mrf prior allows us to achieve a better separation of the relevant pathways from those not relevant ( in particular , we have found a larger average difference , over three scenarios , between the relevant pathway with the lowest posterior probability and the nonrelevant pathway with the highest posterior probability ) .",
    "in addition , in the simulated setting with fairly small regression coefficients the model with the mrf prior was able to select all the correct genes without any false positive , while the model without mrf includes 3 false positives .",
    "other authors have reported improvements on selection power and sensitivity with respect to commonly used procedures that do not use the pathway structure , with similar , and in some cases , lower false discovery rates . in addition , in our formulation of the model we have used biological information not only for prior specification but also to structure the mcmc moves .",
    "this is helpful in arriving at promising models avoiding visiting invalid configurations . finally , in real data applications",
    ", we have found that employing information on gene ",
    "gene networks can lead to the selection of significant genes that would have been missed otherwise , aiding the interpretation of the results , and achieving better predictions compared to models that do not treat genes as connected elements that work in groups or pathways .",
    "several mrf priors for gene selection indicators have been proposed in the literature .",
    "it is interesting to compare the parametrization of the mrf used in this paper and in @xcite to the parametrization used in @xcite ( @xcite ) , where the prior on @xmath19 is defined as @xmath212 where @xmath213 is the number of selected genes and @xmath214 is the number of edges linking genes with different values of @xmath215 , that is , edges linking included and nonincluded genes among all pathways , @xmath216.\\ ] ] while @xmath217 plays the same role as @xmath101 in ( [ priormrf ] ) , the parametrization using @xmath43 has a  different effect from @xmath102 on the probability of selection of a gene .",
    "this is evident from the conditional probability @xmath218 , where @xmath219 .",
    "higher values of @xmath43 encourage neighboring genes to take on the same @xmath220 value , and , consequently , genes with nonselected neighbors have lower prior probability of being selected than genes with no neighbors .",
    "we felt that parametrization ( [ priormrf ] ) was a better choice for our purposes .",
    "first , in a context of sparsity , where only few nodes are supposed to take value 1 , a prior that assigns larger probability of inclusion to genes with selected neighbors than to isolated genes seems more appropriate .",
    "second , the exact simulation algorithm of @xcite can not be used to simulate from ( [ mrfweili ] ) .",
    "while any other method to draw from ( [ mrfweili ] ) would be acceptable , as said by @xcite , markov chain methods , to sample from a mrf , require to check at each step that the chain has converged to the equilibrium distribution , to avoid introducing additional undesirable stochasticity . on the other hand ,",
    "one advantage of parametrization ( [ mrfweili ] ) is that no phase transition problem is associated to the distribution .",
    "pathway databases are incomplete and the gene network information is often unavailable for many genes",
    ". thus , there may be situations where the dependence structure and the mrf prior specification on the gene selection indicator , @xmath19 , can not be used for all genes .",
    "when the only information available is the pathway membership of genes , the prior on @xmath19 could be elicited to capture other interesting characteristics .",
    "for example , a gene can have a priori higher probability of being selected when several pathways that contain it are included in the model .",
    "we may also want to avoid favoring the selection of a large pathway just because of its size .",
    "in such cases , conditional on @xmath17 , independent bernoulli priors can be specified for @xmath215 relating the probability of selection to the proportion of included pathways that contain gene @xmath8 , adjusting for the pathway sizes , @xmath221 , that is , @xmath222 , with @xmath223 a hyperparameter to be elicited .    in our approach",
    "we have made use of pls components as summary measures of the expression of genes belonging to known pathways and then applied a fully bayesian approach for the selection of the pathways to be included in the model , and the genes to be included within those pathways .",
    "penalized techniques , including lasso [ @xcite ] , elastic net [ @xcite ] and group lasso [ @xcite ] have been studied extensively in the literature and have been successfully applied to gene expression data .",
    "the group lasso , in particular , defines sets of variables , then selects either all the variables in the group or none of them .",
    "recently , a  modification of the method was proposed by @xcite using a more general penalty that yields sparsity at both the group and individual feature levels to select groups and predictors within each group .",
    "our understanding of group lasso is that the method works best in situations where variables belonging to the same group are highly correlated , while covariates in different groups do not exhibit high correlation .",
    "however , genes belonging to the same pathway often do not exhibit high correlation in their expression levels .",
    "also , in our case there are genes belonging to different pathways that have high correlation , as well as genes that belong to more than one pathway .",
    "initial investigations suggest that , in terms of prediction mse , bayesian formulations of lasso methods perform similarly to and , in some cases , better than the frequentist lasso [ see , e.g. , @xcite ] . particularly relevant to our approach",
    "is the work of @xcite , who apply bayesian variable selection ( bvs ) and stochastic search methods in a regression model for genome - wide data . in simulations they find that , in spite of the apparent computational challenges , bvs produces better power and predictive performance compared with standard lasso techniques ."
  ],
  "abstract_text": [
    "<S> the vast amount of biological knowledge accumulated over the years has allowed researchers to identify various biochemical interactions and define different families of pathways . </S>",
    "<S> there is an increased interest in identifying pathways and pathway elements involved in particular biological processes . </S>",
    "<S> drug discovery efforts , for example , are focused on identifying biomarkers as well as pathways related to a disease . </S>",
    "<S> we propose a bayesian model that addresses this question by incorporating information on pathways and gene networks in the analysis of dna microarray data . </S>",
    "<S> such information is used to define pathway summaries , specify prior distributions , and structure the mcmc moves to fit the model . </S>",
    "<S> we illustrate the method with an application to gene expression data with censored survival outcomes . </S>",
    "<S> in addition to identifying markers that would have been missed otherwise and improving prediction accuracy , the integration of existing biological knowledge into the analysis provides a better understanding of underlying molecular processes .    ,    ,     +    . </S>"
  ]
}