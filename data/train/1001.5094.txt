{
  "article_text": [
    "let @xmath4 be an orientable 2-manifold , closed or with finitely many punctures , where the genus and the number of punctures are chosen so that @xmath4 admits a hyperbolic structure .",
    "the _ modular group _",
    "@xmath5 is the group @xmath6 , where admissible homeomorphisms preserve orientation .",
    "if a mapping class @xmath2 \\in \\mod{s}$ ] is _ pseudo - anosov _ or _ pa _",
    ", then there exists a representative @xmath7 , a pair of invariant transverse measured foliations @xmath8 and a real number @xmath9 , the _ dilatation _ of @xmath2 $ ] , such that @xmath10 multiplies the transverse measure @xmath11 ( resp .",
    "@xmath12 ) by @xmath9 ( resp .",
    "@xmath13 ) .",
    "the real number @xmath9 is an invariant of the conjugacy class of @xmath2 $ ] in mod@xmath14 .    _",
    "measured train tracks _ are a partially combinatorial device that thurston introduced to encode the essential properties of @xmath15 .",
    "a train track @xmath16 is a branched 1-manifold that is embedded in the surface @xmath4 .",
    "it is made up of vertices ( called _ switches _ ) and smooth edges ( called _ branches _ ) , disjointly embedded in @xmath4 . see ( * ? ? ?",
    "* section 1.3 ) . given a pa map",
    "@xmath2 $ ] , there exists a train track @xmath17 that _ fills _ the surface , i.e. , the complement of @xmath16 consists of ( possibly punctured ) discs , and @xmath16 is left invariant by @xmath2 $ ] .",
    "moreover , @xmath16 is equipped with a transverse measure ( resp .",
    "tangential measure ) that is related to the transverse measure @xmath11 on @xmath18 ( resp .",
    "@xmath12 on @xmath19 ) .",
    "in @xcite bestvina and handel gave an algorithmic proof of thurston s classification theorem for mapping classes .",
    "their proof shows that , if @xmath2 $ ] is a pa map of @xmath4 , then one may construct , algorithmically , a graph @xmath20 , homotopic to @xmath4 when @xmath4 is punctured , and an induced map @xmath21 that we call a _ train track map_. for every @xmath22 the restriction of @xmath23 to the interior of every edge is an immersion .",
    "it takes a vertex of @xmath20 to a vertex , and takes an edge to an edge - path which has no backtracking .",
    "let @xmath24 be the unoriented edges of @xmath20 .",
    "knowing @xmath20 and @xmath25 , they construct a somewhat special measured train track @xmath16 , and we will always assume that our @xmath16 comes from their construction .",
    "the _ transition matrix _",
    "@xmath1 is an @xmath26 matrix whose entry @xmath27 is the number of times the edge path @xmath28 passes over @xmath29 in either direction , so that all entries of @xmath1 are non - negative integers . if @xmath2 $ ] is pa , then @xmath1 is irreducible and it has a dominant real eigenvalue @xmath9 , the _ perron - frobenius eigenvalue _ @xcite .",
    "the eigenvalue @xmath9 is the dilatation of @xmath2 $ ] .",
    "the left ( resp .",
    "right ) eigenvectors of @xmath1 determine tangential ( resp .",
    "transversal ) measures on @xmath16 , and eventually determine @xmath12 ( resp .",
    "@xmath11 ) .    in this paper",
    "we study the structure of the characteristic polynomial @xmath30 of the transition matrix @xmath1 .",
    "let @xmath31 be the vector space of real weights on the edges of the bestvina - handel graph @xmath20 .",
    "let @xmath32 be the map induced from the train track map @xmath33 .",
    "we denote @xmath34 .",
    "it is well - known that @xmath35 depends on the choice of @xmath25 .",
    "the first new result in this paper is the discovery that , after dividing @xmath36 by a polynomial that is determined by the way that a train - track map acts on certain vertices of @xmath20 , one obtains a quotient polynomial which is a topological invariant of @xmath2 $ ] .",
    "this polynomial arises via an @xmath37-invariant direct sum decomposition of the @xmath38-vector space of transverse measures on @xmath16 .",
    "it is the characteristic polynomial of the action of @xmath37 on one of the summands .",
    "we call it the _ homology polynomial _ of @xmath2 $ ] , for reasons that will become clear in a moment",
    ". we will construct examples of pa maps on a surface of genus 2 which have the same dilatation , but are distinguished by their homology polynomials .",
    "like @xmath36 , our homology polynomial is the characteristic polynomial of an integer matrix , although ( unlike @xmath1 ) that matrix is not in general non - negative .",
    "we now describe how we found it .",
    "we define and study an @xmath37-invariant subspace @xmath39 . the subspace @xmath40 is chosen so that weights on edges determine a transverse measure on the train track @xmath16 associated to @xmath20 and @xmath25 .",
    "we study @xmath41 .",
    "see page 427 , lines 20- to 13- of @xcite , where the mathematics that underlies @xmath42 is described by thurston .",
    "our first contribution in this paper is to make the structure that thurston described there concrete and computable , via an enhanced form of the bestvina - handel algorithm .",
    "this allows us to prove that the characteristic polynomial @xmath43 is an invariant of the mapping class @xmath2 $ ] in mod@xmath14 .",
    "this polynomial @xmath43 is our homology polynomial .",
    "it contains the dilatation of @xmath2 $ ] as its largest real root , and so is divisible by the minimum polynomial of @xmath9 .",
    "its degree depends upon a careful analysis of the action of @xmath44 on the vertices of @xmath20 .    investigating the action of @xmath44 on @xmath40",
    ", we show that @xmath40 supports a skew - symmetric form that is @xmath44-invariant .",
    "the existence of the symplectic structure was known to thurston and also was studied by penner - harer in @xcite , however it is unclear to us whether it was known to earlier workers that it could have degeneracies .",
    "see remark  [ rem : completeness ] .",
    "we discovered via examples that degeneracies do occur . in @xmath45[sec:2nd polynomial invariant ]",
    "we investigate the radical @xmath46 of the skew - symmetric form , i.e. the totally degenerate subspace of the skew - symmetric form , and arrive an @xmath44-invariant decomposition of @xmath40 as @xmath47 .",
    "this decomposition leads to a product decomposition of the homology polynomial as a product of two additional new polynomials , with both factors being invariants of @xmath2 $ ] .",
    "we call the first of these new polynomials , @xmath48 , the _ puncture polynomial _ because it is a cyclotomic polynomial that relates to the way in which the pa map @xmath10 permutes certain punctures in @xmath4 . as for @xmath49 , our _ symplectic polynomial _ , we know that it arises from the action of @xmath44 on the symplectic space @xmath50 , but we do not fully understand it at this writing . sometimes the symplectic polynomial is irreducible , in which case it is the minimum polynomial of @xmath9 .",
    "however we will give examples to show that it can be reducible , and even an example where it is symplectically reducible .",
    "thus its relationship to the minimum polynomial of @xmath9 is not completely clear at this writing .    summarizing",
    ", we will prove :    [ thm : summarize ] let @xmath2 $ ] be a pa mapping class in mod@xmath14 , with bestvina - handel train track map @xmath25 and transition matrix @xmath1 .    1 .",
    "the characteristic polynomial @xmath36 of @xmath1 has a divisor , the homology polynomial @xmath43 , which is an invariant of @xmath2 $ ] .",
    "it contains @xmath9 as its largest real root , and is associated to an induced action of @xmath51 on @xmath52 , where @xmath53 is the surface @xmath4 when @xmath16 is orientable and its orientation cover @xmath54 when @xmath16 is non - orientable .",
    "the homology polynomial @xmath43 decomposes as a product of two polynomials @xmath55 , each a topological invariant of @xmath2 $ ] .",
    "1 .   the first factor , the puncture polynomial @xmath48 , records the action of @xmath37 on the radical of a skew - symmetric form on @xmath40 .",
    "it has topological meaning related to the way in which @xmath10 permutes certain punctures in the surface @xmath4 .",
    "it is a palindromic or anti - palindromic polynomial , and all of its roots are on the unit circle .",
    "the second factor , the symplectic polynomial @xmath49 , records the action of @xmath44 on the non - degenerate symplectic space @xmath50 .",
    "it contains @xmath9 as its largest real root .",
    "it is palindromic .",
    "if irreducible , it is the minimum polynomial of @xmath9 , but it is not always irreducible .",
    "the homology polynomial , being a product of the puncture and symplectic polynomials , is palindromic or anti - palindromic .",
    "the proof of theorem  [ thm : summarize ] can be found in @xmath45[sec:1st polynomial invariant ] and @xmath45[sec:2nd polynomial invariant ] below . in @xmath45[sec : applications ] we give several applications , and prove that our three invariants behave nicely when the defining map @xmath10 is replace by a power @xmath56 .",
    "the paper ends , in @xmath45[sec : examples ] with a set of examples which give concrete meaning to our ideas .",
    "the first such example , example  [ ex : filling - curves ] , defines three distinct maps @xmath57 on a surface of genus 2 , chosen so that all three have the same dilatation .",
    "two of the three pairs are distinguished by any one of our three invariants .",
    "the third map was chosen so that it probably is not conjugate to the other two , however our invariants could not prove that .",
    "* acknowledgments * the authors would like to thank jeffrey carlson for his help with the proof of corollary  [ cor : homology polynomial is invariant ] , which was stated as a conjecture in an earlier draft .",
    "they thank dan margalit for suggesting a way to find examples of non - conjugate maps with the same dilatation .",
    "they would also like to thank mladen bestvina , nathan dunfield , jordan ellenberg , ji - young ham , eriko hironaka , eiko kin , chris leininger , robert penner , and jean - luc thiffeault for their generosity in sharing their expertise and their patience in responding to questions .",
    "they also thank the referee who digested the content of an earlier version of this paper and told us why it needed the major revision that is given in these pages .",
    "we begin our work in @xmath45[subsec : preliminaries ] by recalling some well - known facts from @xcite that relate to the construction of the train track @xmath16 by adding infinitesimal edges to the graph @xmath20 .",
    "after that , in @xmath45[subsec : w(g , f ) ] , we introduce the space @xmath58 of transverse measures , which plays a fundamental role throughout this paper .",
    "rather easily , we will be able to prove our first decomposition and factorization theorem .",
    "thus at the end of @xmath45[subsec : w(g , f ) ] we have our homology polynomial in hand , but we do not know its meaning , have not proved it is an invariant , and do nt know how to compute it . in @xmath45[subsec : basis for w(g , f ) ] we prepare for the work ahead by constructing a basis for @xmath40 .",
    "we also learn how to find the matrix for the action of @xmath44 on the basis . with that in hand , in @xmath45[subsec : homology poly ] we identify the vector space @xmath40 with a homology space .",
    "we will be able to prove corollary  [ cor : homology polynomial is invariant ] , which asserts that the homology polynomial @xmath59 is a topological invariant of the conjugacy class of our pa map @xmath2 $ ] in @xmath60 .",
    "( later in @xmath45[sec : examples ] , we will use it to distinguish examples of pa maps acting on the same surface and having the same dilatation . )",
    "it will be assumed that the reader is familiar with the basic ideas of the algorithm of bestvina - handel @xcite .",
    "the mapping class @xmath2 $ ] will always be pa .",
    "further , assume that we are given the graph @xmath61 , homotopic to @xmath4 , and a train track map @xmath33 .",
    "we note that if @xmath4 is closed , the action of @xmath2 $ ] always has periodic points with finite order , and the removal of a periodic orbit will not affect our results , therefore without loss of generality we may assume that @xmath4 is finitely punctured .",
    "following ideas in @xcite we construct a train track @xmath16 from @xmath25 by equipping the vertices of @xmath20 with additional structure : let @xmath62 be two ( non - oriented ) edges originating at the same vertex @xmath63 .",
    "edges @xmath64 and @xmath65 belong to the same _ gate _ at @xmath63 if for some @xmath66 , the edge - paths @xmath67 and @xmath68 have a nontrivial common initial segment . if @xmath64 and @xmath65 belong to different gates at @xmath63 and there exists some exponent @xmath66 and an edge @xmath69 so that @xmath70 contains @xmath71 or @xmath72 as a subpath , then we connect the gates associated to @xmath73 with an _ infinitesimal edge . _ in this way , a vertex @xmath74 with @xmath75 gates becomes an infinitesimal @xmath75-gon in the train track @xmath16 .",
    "while this @xmath75-gon may be missing one - side , the infinitesimal edges must connect all the gates at each vertex , ( * ? ? ?",
    "* section  3.3 ) .",
    "in addition to the infinitesimal edges , @xmath16 also has _",
    "real edges _ corresponding to the edges of @xmath20 .",
    "hence , a _ branch _ of @xmath16 , in the sense of penner - harer @xcite , is either an infinitesimal edge or a real edge .",
    "it is natural to single out the following properties of the vertices of @xmath20 :    * ( vertex types)*[def : vertex - type ] see figure  [ fig : vertex - types ] .",
    "a vertex of @xmath20 is _ odd _",
    "( resp .  _ even _ ) if its corresponding infinitesimal complete polygon in @xmath16 has an odd ( resp .",
    "_ even _ ) number of sides , and it is _ partial _ if its infinitesimal edges form a polygon in @xmath16 with one side missing .",
    "partial vertices include the special case where @xmath63 has only two gates connected by one infinitesimal edge ; we call such vertices _ evanescent_. the symbol @xmath76 will denote the weight of @xmath77-th gate , and @xmath78 will denote the weight of @xmath77-th infinitesimal edge .    in @xmath45[sec :",
    "examples ] the reader can find several examples illustrating the graph @xmath20 with infinitesimal polygons associated to particular pa mapping classes . in those illustrations the vertices of the graphs have been expanded to shaded discs which show the structure at the vertices . in the sketch of a train track that xtrain generates",
    ", the branches at each gate do not appear to be tangent to each other .",
    "this was done for ease in drawing the required figures .",
    "the reader should keep in mind that all the branches at each gate are tangent to each other .",
    "we recall properties of non - evanescent vertices that are preserved under a train track map :    _ ( * ? ? ?",
    "* proposition  3.3.3 ) _ [ prop333 ] for @xmath79 , let @xmath80 be the set of odd vertices with @xmath75 gates , @xmath81 the set of even vertices with @xmath75 gates , and @xmath82 the set of partial vertices with @xmath75 gates .",
    "then the restriction of @xmath25 to each of these sets is a permutation of the set .    moreover , for each @xmath83non evanescent@xmath84 vertex @xmath63 with at least three gates",
    ", @xmath85 induces a bijection between the gates at @xmath63 and the gates at @xmath86 that preserves the cyclic order .",
    "the number of evanescent vertices of a train track representative is _ not _ an invariant of the underlying mapping class .",
    "examples exist where a train track map has a representative with evanescent vertices , and another without .    *",
    "( orientable and non - orientable train tracks ) * [ def : tau orientable ] choose an orientation on each branch of a train track @xmath16 .",
    "a train track is _ orientable _ if we can orient all the branches so that , at every switch , the angle between each incoming branch and each outgoing branch is @xmath87 .",
    "for example , see the train tracks @xmath88 and @xmath89 that are given in figure  [ fig : filling - curves - tt ] of @xmath45[sec : examples ] . after adding the infinitesimal edges",
    ", one sees that @xmath88 is orientable , but @xmath89 is not .    here is an easy observation .",
    "[ vertextypelem ] if @xmath20 has an odd vertex , then the corresponding train track @xmath16 is non - orientable .",
    "this condition is sufficient , but not necessary .",
    "if @xmath63 is an odd vertex , then there exists no consistent orientation for the corresponding infinitesimal polygon in @xmath16 .",
    "the example in figure  [ fig : filling - curves - tt ] shows that the condition is not necessary .",
    "we do not know any immediate visual criterion beyond the one in lemma  [ vertextypelem ] for detecting non - orientability .",
    "the two train tracks @xmath90 in figure  [ fig : filling - curves - tt ] of this paper both have 2 vertices , one even and one partial , and @xmath88 is orientable whereas @xmath89 is non - orientable .",
    "if all the vertices are partial , then the train track may be either orientable ( see ( * ? ? ?",
    "* example  4.2 ) ) or non - orientable ( see example  [ ex : penner ] ) ; also , a non - orientable train track may have odd , even , and partial vertices at the same time ( see example  [ ex : evenodd ] ) .",
    "given a graph @xmath20 of @xmath91 edges , one always has an @xmath92-vector space @xmath93 of weights on @xmath20 .",
    "our goal in this section is to define a subspace @xmath39 of ` transverse measures on @xmath20 ' .",
    "this space is the natural projection of the measured train track @xmath16 to a space of measures on @xmath20",
    ". it will play a fundamental role in our work .    in our setting ,",
    "all train tracks are _ bi - recurrent _ , that is , recurrent and transversely recurrent , cf .",
    "@xcite . to define our space @xmath40",
    ", we apply penner - harer s work described in ( * ? ? ?",
    "* section 3.2 ) , where bi - recurrence is assumed .",
    "let @xmath94 , where @xmath91 ( resp .",
    "@xmath95 is the number of the real ( resp .",
    "infinitesimal ) edges of train track @xmath16 .",
    "penner - harer defined a subspace @xmath96 of assignments of ( possibly negative ) real numbers , one to each branch of @xmath16 , which satisfy the _ switch conditions . _",
    "that is , if @xmath97 then at each switch of @xmath16 , the sum of the weights on the incoming branches equals to the sum on the outgoing branches .",
    "for example , in figure  [ fig : switch]-(a ) , @xmath98    there is a natural surjection @xmath99 which is defined by collapsing all the infinitesimal ( partial ) polygons to their associated vertices in @xmath20 and taking each real edge in @xmath16 to the corresponding edge in @xmath20 .",
    "let @xmath100 .",
    "that is , @xmath101 is the subspace whose elements admit an extension to a ( possibly negative ) transverse measure on @xmath16 .",
    "the name @xmath40 has been chosen to reflect the fact that our subspace depends not only on @xmath20 , but also on the action @xmath25 .",
    "here is a useful criterion for an element of @xmath31 to be in @xmath40 :    [ switchlem ] an element @xmath102 belongs to @xmath58 if and only if for each non - odd vertex the alternating sum of the weights at the incident gates is zero .",
    "assume that @xmath102 belongs to @xmath58 .",
    "let @xmath74 be a vertex with @xmath75 gates , i.e. , @xmath63 corresponds to an infinitesimal @xmath75-gon , possibly partial , in the train track @xmath16 .",
    "let @xmath103 be the weights of @xmath104 at the incident gates of @xmath63 , and let @xmath105 ( or @xmath106 if @xmath63 is a partial vertex ) be the weights of the infinitesimal edges .",
    "see figure  [ fig : vertex - types ] .",
    "the weights on the infinitesimal edges may turn out to be negative real numbers .",
    "we determine when an assignment of weights to the real edges admits an extension to the infinitesimal edges that satisfies the switch conditions .",
    "if @xmath63 is odd or even with @xmath75 gates , then the switch condition imposes : @xmath107 if @xmath75 is odd , this system of equations has a unique solution , regardless of the weights @xmath76 .",
    "if @xmath75 is even , the system is consistent if and only if @xmath108 .",
    "if @xmath63 is partial with @xmath75 gates , then the switch condition imposes : @xmath109 this system has a unique solution if and only if @xmath110 .    [ eq : inclusion ]    @xmath40 is an invariant subspace of @xmath31 under @xmath44 , i.e. , @xmath111    suppose @xmath63 is a non - odd vertex and mapped to a non - odd vertex @xmath86 .",
    "let @xmath112 .",
    "by lemma  [ switchlem ] , the alternating weight sum of @xmath104 at the incident gates of @xmath63 is @xmath113 .",
    "lemma  [ prop333 ] implies that all the weights of @xmath104 at the infinitesimal edges for @xmath63 is inherited to the weights of @xmath114 at the infinitesimal edges for @xmath86 .",
    "in addition , we account for an edge @xmath115 whose image @xmath116 passes through the vertex @xmath86 .",
    "assume that @xmath104 has weight @xmath117 at the edge @xmath69 .",
    "if a sub - edge - path @xmath118 passes through @xmath86 then edges @xmath29 and @xmath119 belong to adjacent gates at @xmath86 and the contribution of @xmath120 to the alternating sum of weights of the gates at @xmath86 is @xmath121 .    therefore , the alternating weight sum for @xmath114 at the incident gates for @xmath86 is @xmath113 . by lemma  [ switchlem ] , @xmath122 .",
    "the dimension of the vector space @xmath40 can be computed combinatorially by inspecting a train track associated to the pair @xmath123 :    [ lem : dimw(g , f ) ] @xmath124 if @xmath16 is orientable , then @xmath125 in particular , the switch conditions are precisely the cycle conditions .",
    "@xmath126 if @xmath16 is non - orientable , then @xmath127    assume that @xmath16 is orientable .",
    "by lemma  [ vertextypelem ] , @xmath20 has no odd vertices . for @xmath128 and a non - odd vertex @xmath63 ,",
    "let @xmath129 by lemma  [ switchlem ] , @xmath130 .",
    "we number the gates at @xmath63 so that the orientation of the real edges at @xmath131-th ( resp .",
    "@xmath132-th ) gate is inward ( resp .",
    "outward ) .",
    "if @xmath20 has @xmath133 vertices , @xmath134 , then we have a system of @xmath133 equations : @xmath135 the sum of the left hand sides is equal to the sum of the right hand sides .",
    "since @xmath16 is oriented , the last equation follows from the other @xmath136 equations , i.e. , the switch conditions are _ not _ independent .",
    "therefore , @xmath137    with respect to the orientations of the edges of @xmath20 , let @xmath138 be the boundary map of the chain complex .",
    "there is a natural isomorphism @xmath139 . if @xmath140 is a cycle , then the cycle condition @xmath141 is equivalent to the alternating sum condition @xmath142 at each vertex @xmath143 . by lemma  [ switchlem ]",
    "we obtain @xmath144 .",
    "in fact , the euler characteristic of @xmath145-punctured genus @xmath146 surface @xmath4 is ; @xmath147 thus @xmath148 .    in the non - orientable case ,",
    "the switch conditions are satisfied if and only if the alternating sum of the weights of gates around each even or partial vertex is zero ( lemma  [ switchlem ] ) .",
    "moreover , all these conditions are independent of each other ( * ? ? ?",
    "* lemma 2.1.1 ) , so that the number of independent constraints is the number of non - odd vertices .",
    "since @xmath149 is the number of edges , statement ( 2 ) follows .",
    "now we know that @xmath31 can be identified with the @xmath150-chains @xmath151 in the orientable case , we can extend the boundary map @xmath152 to the following map @xmath153 on @xmath31 :    * ( the map @xmath153)*[def of delta ] assume that the graph @xmath20 has @xmath133 non - odd vertices , @xmath134 .",
    "define a linear map @xmath154 @xmath155 such that @xmath156 the alternating sum of the weights of @xmath104 at the gates incident to the vertex @xmath157 .",
    "these weights satisfy the following conditions :    * if @xmath16 is oriented , then we determine the sign of each gate to be compatible with the orientation of the real edges of @xmath16 .",
    "the alternating sum is defined without ambiguity .",
    "for an example , in figure  [ fig : filling - curves - tt ] , left sketch , a plus ( resp .",
    "minus ) sign may be assigned at each gate , according as the real edges are oriented toward ( resp . away from ) the gate .",
    "* if @xmath16 is non - orientable , we assign alternating signs to the incident gates for each non - odd vertex .",
    "since @xmath16 is non - orientable , the assignments will be local and not global . clearly , the alternating sum depends on the choice of the sign assignment .",
    "[ lem : mapdelta ] in both the orientable and non - orientable cases @xmath158 .",
    "moreover , if @xmath133 is the number of non - odd vertices of @xmath20 , then @xmath159    lemma  [ switchlem ] , immediately implies that @xmath160 the dimension count follows from lemma  [ lem : dimw(g , f ) ] .",
    "finally we prove :    [ thm:1st decomposition ] _",
    "( * first decomposition theorem * ) _ @xmath161 the degree of @xmath162 ( resp .",
    "@xmath163 ) is the dimension of @xmath40 ( resp .",
    "@xmath164 ) , as given in lemma  [ lem : dimw(g , f ) ] ( resp . lemma  [ lem : mapdelta ] ) .    from lemma  [ lem : mapdelta ] ,",
    "identifying @xmath165 with the quotient @xmath166 we obtain ( [ direct sum ] ) . by the same argument as in the proof of lemma  [ eq : inclusion ] , we obtain @xmath167 .",
    "this along with @xmath168 yields ( [ polynomial ] ) .      the goal of this section is to find a basis for @xmath39 and learn how to determine the action of @xmath44 on the basis .",
    "with regard to the basis , it will be convenient to consider three cases separately : the cases when @xmath16 is orientable , when @xmath16 is non - orientable and has odd vertices , and when @xmath16 is non - orientable but has no odd vertices .",
    "that is accomplished in @xmath45[sssec : basis1 ] , [ sssec : basis2 ] and [ sssec : basis3 ] . having the basis in hand , in @xmath45[sssec : basis4 ] we learn how to compute the action of @xmath44 on the basis elements .",
    "if the train track @xmath16 associated to @xmath20 is orientable , we choose an orientation for @xmath16 , thereby inducing an orientation on the edges of @xmath20 , and choose a maximal spanning tree @xmath169 .",
    "every vertex of @xmath20 will be in @xmath170 .",
    "we consider all edges @xmath69 of @xmath20 that are not in @xmath170 , and construct a set of vectors @xmath171 and prove that the constructed set is a basis for @xmath39 .    for each @xmath172 ,",
    "find the unique shortest path in @xmath170 joining the endpoints of @xmath69 .",
    "the union of this path and @xmath69 forms an oriented loop @xmath173 in which the edge @xmath69 appears exactly once , the orientation being determined by that on @xmath69 . if the orientation of edge @xmath174 agrees ( resp . disagrees ) with the orientation of @xmath175 , then we assign a weight of @xmath150 ( resp .",
    "@xmath176 ) to @xmath177 . in particular",
    ", @xmath178 has weight 1 .",
    "the edges not in @xmath173 are assigned weight of @xmath113 . in this way",
    "we obtain a vector @xmath179 whose entries are the assigned weights . by construction , @xmath180 satisfies the criterion for a transverse measure , described in lemma  [ switchlem ] , therefore @xmath180 is an element of @xmath40 .",
    "we now show that @xmath181 is a basis for @xmath40 where @xmath182 are the edges of @xmath183 and @xmath184 note that if @xmath185 with @xmath186 , then @xmath187 .",
    "therefore @xmath188 if and only if @xmath189 , because all edges not in @xmath190 have weight @xmath113 , i.e. , the vectors @xmath191 are linearly independent .",
    "consulting lemma  [ lem : dimw(g , f ) ] we see that we have the right number of linearly independent elements , so we have found a basis for @xmath40 .",
    "[ ex - of - basis - orientable ] go to @xmath45[sec : examples ] below and see example  [ ex : filling - curves ] and its accompanying figure  [ fig : filling - curves - tt]-(1 ) .",
    "the train track for this example is orientable .",
    "the space @xmath31 has dimension 5 .",
    "order the edges of @xmath20 as @xmath192 .",
    "the edge @xmath193 and the vertices @xmath194 form a maximal tree @xmath169 , with edges @xmath195 , so that @xmath40 has dimension 4 .",
    "we have the loops @xmath196 ; @xmath197 ; @xmath198 ; @xmath199 , so that @xmath40 has basis @xmath200 ; @xmath201 ; @xmath202 ; @xmath203 , where ` prime ' means transpose .",
    "if @xmath20 has an odd vertex @xmath204 then choose a maximal spanning tree @xmath169 .",
    "let @xmath205 be the set of vertices of @xmath20 .",
    "define a height function @xmath206 by @xmath207 we obtain a forest @xmath208 by removing from @xmath170 all the edges each of which connects an odd vertex and the adjacent vertex of smaller height .",
    "see figure  [ forest ] .",
    "( left ) and a forest @xmath209 ( right ) .",
    "hollow dots @xmath210 , are odd vertices .",
    "black dots are non - odd vertices . ]",
    "the forest @xmath209 contains all the vertices of @xmath20 with exactly one odd vertex in each connected component .",
    "now , let @xmath69 be an edge that is not in @xmath211 we can find two ( possibly empty ) shortest paths in @xmath209 each of which connects an endpoint of @xmath69 to an odd vertex .",
    "the union of @xmath69 and the two paths forms an arc , which we denote by @xmath173 .",
    "( if both of the endpoints of @xmath69 belong to the same tree component of @xmath209 , then @xmath173 becomes a loop containing one odd vertex . )",
    "assign a weight of @xmath150 to @xmath69 and weight of @xmath113 to the edges that are not in @xmath173 . to the other edges in @xmath173",
    ", we assign weights of @xmath212 so that at each non - odd vertex the criterion of transverse measure ( lemma  [ switchlem ] ) is satisfied .",
    "this defines an element @xmath180 of @xmath40 .",
    "let @xmath182 be the edges of @xmath213 . by the construction",
    ", we have @xmath188 if and only if @xmath189 , so the vectors @xmath191 are linearly independent .",
    "since @xmath214 lemma  [ lem : dimw(g , f ) ] tells us that @xmath215 , hence @xmath216 is a basis of @xmath40 .",
    "see example  [ ex : evenodd ] .",
    "the graph @xmath20 has two odd vertices @xmath204 and @xmath217 .",
    "we choose a maximal tree @xmath170 whose edges are @xmath218 .",
    "this gives us a forest @xmath209 with two components .",
    "one consists of the single vertex @xmath217 , and the other consists of vertices @xmath219 and edges @xmath220 .",
    "the edge @xmath221 is not in @xmath209 , and its endpoints are @xmath222 and @xmath223 the associated arc @xmath224 since @xmath225 and @xmath221 share the same gate at @xmath222 , @xmath226 satisfies @xmath227 @xmath228 , and @xmath113 for rest of the edges .",
    "the graph @xmath20 has 10 edges @xmath229 , with @xmath220 in @xmath209 .",
    "the vector space @xmath40 has dimension 7 .",
    "the edge @xmath221 is not in @xmath209 , and its endpoints are @xmath222 and @xmath223 then @xmath230",
    "since @xmath225 and @xmath221 share the same gate at @xmath222 , @xmath226 satisfies @xmath227 @xmath228 , and @xmath113 for rest of the edges .",
    "the edge @xmath231 is also not in @xmath209 , and its endpoints are @xmath232 and @xmath233 , so @xmath234 is an arc whose endpoints coincide at @xmath204 and @xmath235 satisfies @xmath236 , and @xmath113 for rest of the edges .",
    "the other five basis elements are constructed in a similar way .      in this case",
    ", we can find a simple loop @xmath237 that does not admit an orientation consistent with the train track @xmath16 . if @xmath238 misses any vertices of @xmath239 then we define @xmath240 by adding an edge with exactly one vertex in @xmath241 if @xmath240 misses any vertices , we define @xmath242 by adding an edge with exactly one vertex in @xmath243 etc . ultimately we obtain a connected subgraph @xmath244 that is homotopy equivalent to a circle and contains all vertices of @xmath20 .",
    "if @xmath69 is an edge outside @xmath245 we can find paths in @xmath244 from each endpoint of @xmath69 to the loop @xmath246 resulting in a path @xmath247 that contains @xmath69 and with endpoints in @xmath238 .",
    "now we can find paths @xmath248 in @xmath238 so that @xmath249 and the endpoints of @xmath248 , called @xmath250 and @xmath251 , agree with those of @xmath247 .",
    "it is possible that @xmath250 and @xmath251 are the same vertex , in which case we set @xmath252 ( this happens in example  [ ex - basis - non - ori2 ] , where our construction is applied to example  [ ex : penner ] . )",
    "let @xmath253 be a vector which assigns @xmath150 to edge @xmath69 , @xmath212 to the other edges in @xmath247 , and @xmath113 to the edges not in @xmath247 , so that the alternating weight sum is @xmath113 at all the vertices but @xmath254 .",
    "next , let @xmath255 ( resp .",
    "@xmath256 ) be a vector which assigns @xmath212 to the edges of @xmath257 ( resp .",
    "@xmath258 ) and @xmath113 to the other edges not in @xmath257 ( resp .",
    "@xmath258 ) so that @xmath259 ( resp .",
    "@xmath260 ) has the alternating sum of weights equal to @xmath113 at all the vertices of @xmath20 but @xmath250 . in particular , at vertex @xmath251 , for @xmath261 , @xmath262 hence @xmath263 while , at vertex @xmath250 @xmath264 for , if it were @xmath113 then the loop @xmath238 can admit an orientation consistent with @xmath16 , which is a contradiction .",
    "therefore , at @xmath250 , @xmath265 this means , at @xmath250 , we have @xmath266 if and only if @xmath267 .",
    "if @xmath266 then define @xmath268 and @xmath269 . otherwise define @xmath270 and @xmath271 . by construction",
    ", @xmath180 satisfies the alternating sum condition of lemma  [ switchlem ] , hence @xmath272 .",
    "note that the number of edges in @xmath244 is equal to the number of vertices of @xmath20 , so by lemma  [ lem : dimw(g , f ) ] the number @xmath273 of edges outside @xmath244 is equal to @xmath274 .",
    "suppose @xmath182 are the edges of @xmath275 , then @xmath188 if and only if @xmath189 , i.e. , vectors @xmath191 are linearly independent .",
    "this proves that @xmath216 is a basis of @xmath40 .",
    "[ ex - basis - non - ori2 ] see example  [ ex : penner ] . the partial vertex @xmath204 has ten gates .",
    "we assign signs alternatively to the gates , which imposes orientations on the edges @xmath276 . however , the gates of each edge @xmath277 or @xmath85 have the same sign , hence @xmath278 do not admit consistent orientations",
    ". we may choose the loop @xmath279 to be the union of @xmath204 and the edge @xmath85 .",
    "for the edge @xmath231 , the loop @xmath280 consists of a single edge @xmath231 and @xmath204 . the element @xmath235 has @xmath281 for the edge @xmath193 , the loop @xmath282 and @xmath283 has @xmath284 the alternating sum of the weights of the ten gates is zero for both @xmath283 and @xmath235 .",
    "lemma  [ switchlem ] guarantees that @xmath285      with respect to the basis of @xmath40 described in @xmath45[sssec : basis1 ] , [ sssec : basis2 ] and [ sssec : basis3 ] , let @xmath286 denote the matrix representing the map @xmath42 . with this @xmath286",
    "we can compute the homology polynomial @xmath43 .",
    "we compute @xmath286 explicitly as follows : let @xmath287 be the edges of @xmath20 .",
    "let @xmath288 be the standard basis of @xmath289 , where @xmath290 the kronecker delta .",
    "let @xmath291 .",
    "suppose that @xmath292 is a basis constructed as in @xmath45[sssec : basis1 ] , [ sssec : basis2 ] and [ sssec : basis3 ] .",
    "reordering the labels , if necessary , we may assume @xmath293 for @xmath294 .",
    "now let @xmath295 be an @xmath296 matrix whose entries @xmath297 satisfy @xmath298 .",
    "let @xmath1 be the transition matrix for the train track map @xmath25 , and let @xmath299 be the projection onto the first @xmath273 coordinates .",
    "then @xmath286 is an @xmath300 integer matrix with @xmath301 see example 5.1 for the calculation of the matrix @xmath286 .",
    "we note that corollary  [ cor : isomorphism of f_ast ] , in the next section , implies that @xmath302 .",
    "a related question is the computation of the ` vertex polynomial ' @xmath303 , even though that polynomial is not a topological invariant and so is only of passing interest . we mention it because in special cases it may be easiest to compute the homology polynomial from the characteristic polynomial of @xmath1 by diving by the vertex polynomial .",
    "see examples  [ ex : k89 ] and [ ex : evenodd ] below , where the computation of the vertex polynomial is carried out in two cases , using data that is supplied by xtrain .",
    "while we have the first decomposition theorem in hand , and have learned how to compute the homology polynomial , that is the characteristic polynomial of the action of @xmath44 on @xmath40 , we have not proved that it is an invariant of @xmath2 $ ] and we do not understand its topological meaning .",
    "all that will be remedied in this section .",
    "our work begins by recalling the definition of the orientation cover @xmath54 of @xmath4 , introduced by thurston @xcite , see also @xcite .",
    "after that we will establish several of its properties .",
    "see proposition  [ prop : orientation cover is orientable ] . in theorem  [ thm : involution ] and corollary  [ cor : isomorphism of f_ast ] we study the homology space @xmath304 and its relationship to our vector space @xmath40 in the case when @xmath16 is non - orientable .",
    "at the end of the section , in corollary  [ cor : homology polynomial is invariant ] , we establish the important and fundamental result that the homology polynomial is an invariant of the mapping class @xmath2 $ ] in mod@xmath14 .    *",
    "( angle between two branches at a switch ) * [ def : angles at a switch ] for a switch in @xmath16 , fix a very small neighborhood that only contains the switch and the branches meeting at the switch . within this neighborhood",
    ", we orient the branches in the direction outward from the switch .",
    "this allows us to define the _ angle _ between two branches that meet at the switch .",
    "since they always meet tangentially , this angle is either @xmath113 or @xmath87 .",
    "if the angle is @xmath113 , then we say that the branches form a _",
    "corner_. for example , the angle between the branches @xmath193 and @xmath305 in figure  [ fig : switch ] ( b ) is @xmath87 , whereas the angle between the branches @xmath305 and @xmath306 is @xmath113 and @xmath307 form a corner .    * ( the orientation cover)*[def : orientation cover ] let @xmath308 be a pa homeomorphism with non - orientable train track @xmath16 . add a puncture to @xmath4 for each 2-cell of @xmath309 corresponding to an odd or even vertex of @xmath20 . the resulting surface @xmath310 deformation retracts to @xmath16 , i.e. , @xmath311 .",
    "each ( not necessarily smooth ) loop @xmath312 consists of branches of @xmath16 .",
    "we define a homomorphism @xmath313 which maps a loop in @xmath16 to @xmath113 if and only if it has an even number of corners ( see definition  [ def : angles at a switch ] ) .",
    "orientation cover _ @xmath314 associated to @xmath16 is obtained from the double cover @xmath315 of @xmath4 corresponding to @xmath316 by filling in the punctures in @xmath315 that do not belong to the original punctures of @xmath4 .    at the same time",
    ", the non - orientable train track @xmath16 lifts to an orientable train track @xmath317 . collapsing the infinitesimal @xmath83partial@xmath84 polygons in @xmath318 to vertices",
    ", we obtain a graph @xmath319 , that is a double branched cover of @xmath20 .",
    "note that the branch points of @xmath320 are precisely the odd vertices of @xmath20 . intuitively , the effect of passing to the orientation cover is a partial unrolling of loops in @xmath16 that do not admit a consistent orientation .",
    "for example , figure  [ fig : unroll ] illustrates what happens near the branch point for a vertex of valence three .",
    "[ prop : orientation cover is orientable ] assume that @xmath16 is non - orientable .    1 .",
    "the orientation cover @xmath318 is an orientable train track .",
    "the natural involution @xmath321 , or the deck transformation , reverses the orientation of @xmath318 .",
    "a puncture of @xmath4 corresponds to two punctures of @xmath54 if and only if a loop around the puncture is homotopic to a loop in @xmath16 with an even number of corners .",
    "otherwise , the puncture lifts to one puncture in @xmath54 .",
    "\\(1 ) by definition  [ def : orientation cover ] we have @xmath322 , hence every loop in @xmath318 has an even number of corners , and so @xmath318 can be consistently oriented .",
    "if the involution @xmath323 did not reverse the orientation of @xmath318 , then the orientation of @xmath318 would induce a consistent orientation of @xmath16 , but @xmath16 is not orientable .",
    "\\(2 ) a loop in @xmath16 lifts to two loops in @xmath318 if and only if it has an even number of corners . if it has an odd number of corners , then its concatenation with itself has a unique lift .    [ or - cover - matrix ] a train track map @xmath25 has two lifts @xmath324 , _ orientation preserving _ , and @xmath325 , _ orientation reversing_. they are related to each other by @xmath326 , where @xmath327 is the deck translation . let @xmath91 be the number of edges in @xmath20",
    ". then there exist @xmath328 non - negative matrices @xmath329 such that @xmath330 , the transition matrix of @xmath85 , and @xmath331 and @xmath332 are represented as : @xmath333 and @xmath334 their characteristic polynomials are @xmath335 and @xmath336    the above proposition confirms that pa maps , @xmath337 ; @xmath338 ; and @xmath339 , all have the same dilatation .",
    "even though the train track @xmath16 is non - orientable , we assign an orientation to each edge of @xmath20 .",
    "let @xmath287 be the oriented edges of @xmath20 .",
    "we denote the lifts of @xmath340 by @xmath341 . since @xmath342 is orientable , we choose an orientation , which induces orientations of @xmath343 .",
    "denote the orientation cover by @xmath344 .",
    "proposition  [ prop : orientation cover is orientable]-(1 ) implies that there are two choices : @xmath345 or @xmath346 , where @xmath347 is the edge @xmath340 with reversed orientation .",
    "we choose to assume that @xmath345 , which implies that @xmath348 .",
    "we define an orientation preserving lift @xmath349 in the following way . for an edge @xmath115 ,",
    "let @xmath350 ( resp .",
    "@xmath351 ) denote the first ( resp .",
    "last ) letter of the word @xmath352 . for each twin edges @xmath353 , we choose @xmath354 next",
    ", we define the word @xmath355 to be the word @xmath352 with each letter @xmath29 in @xmath352 replaced by @xmath356 or @xmath357 so that the resulting word corresponds to a connected edge - path in @xmath319 . due to the choice ( [ choice of head ] ) , the choice between @xmath356 and @xmath357 is uniquely determined .",
    "the word @xmath358 is given by the word @xmath355 _ read from the right to left _",
    ", then replace @xmath356 by @xmath357 and @xmath357 by @xmath356 .",
    "we define an orientation reversing train track map by @xmath359 .",
    "let @xmath360 be the standard basis of @xmath361 , where @xmath362 correspond to @xmath341 respectively . from the constructions of @xmath331 and @xmath332 , with respect to this basis , their transition matrices are of the form @xmath363 and @xmath364 respectively , for some non - negative @xmath328 matrices @xmath286 and @xmath365 satisfying @xmath330 .",
    "the formulae on characteristic polynomials follow from basic row and column reductions .",
    "in example  [ ex : penner ] there is a sketch of the orientation cover of a non - orientable train track which has no odd vertices .",
    "also one can see explicit computations of @xmath331 and @xmath332 and matrices @xmath329 .",
    "we are finally in a position to understand the topological meaning of @xmath40 :    [ thm : involution ] assume that @xmath16 is non - orientable , let @xmath321 be the involution of the orientation cover .",
    "let @xmath366 and @xmath367 be the eigenspaces of @xmath368 corresponding to the eigenvalues @xmath150 and @xmath176 , so that @xmath369 then @xmath370 and @xmath371 .",
    "fix an orientation of @xmath318 once and for all .",
    "this determines an orientation of @xmath319 .",
    "since @xmath323 is an involution , the only possible eigenvalues are @xmath212 , and @xmath372 is diagonalizable .    for a homology class @xmath373 ,",
    "let @xmath374 denote its lift to the orientation cover . since @xmath375 , we have @xmath376 . thus @xmath377    each edge @xmath378 has two lifts @xmath379 and @xmath380 .",
    "let @xmath381 be the basis element of @xmath31 corresponding to the ( unoriented ) edge @xmath69 , and let @xmath382 be the basis element of @xmath383 corresponding to the ( oriented ) edge @xmath379 . define a homomorphism : @xmath384 by @xmath385 recall that a basis element @xmath180 of @xmath40 , introduced in @xmath45  [ sssec : basis2 ] and @xmath45  [ sssec : basis3 ] , has a corresponding arc or loop @xmath386 where @xmath180 assigns weight of @xmath212 satisfying the alternating sum condition .",
    "different edges @xmath73 correspond to distinct @xmath387 and @xmath388 .",
    "moreover , when @xmath173 is an arc , its end points are odd vertices which are branch points of the orientation cover , so the lift of @xmath173 is a closed curve in @xmath54 .",
    "hence , the restriction of @xmath389 to @xmath58 is injective .",
    "assume @xmath390 .",
    "by proposition  [ prop : orientation cover is orientable]-(1 ) , the involution takes @xmath391 .",
    "we have : @xmath392 i.e. , @xmath393    comparison of euler characteristics along with lemma  [ lem : dimw(g , f ) ] shows that @xmath394 which implies @xmath395 and @xmath396 .",
    "in lemma  [ eq : inclusion ] we proved that @xmath111 in fact , a stronger statement holds .",
    "[ cor : isomorphism of f_ast ]    the restriction map @xmath397 is an isomorphism .",
    "regardless of the orientability of @xmath16 , the fact that @xmath398 is a homeomorphism implies that the induced map @xmath399 is an isomorphism .",
    "suppose that @xmath16 is orientable .",
    "the isomorphism @xmath400 in lemma  [ lem : dimw(g , f ) ] allows us to identify @xmath42 with @xmath401 , which is an isomorphism .",
    "suppose that @xmath16 is non - orientable .",
    "let @xmath402 be a basis of @xmath40 constructed as in @xmath45[sssec : basis2 ] and @xmath45  [ sssec : basis3 ] .",
    "since the map @xmath403 in the proof of theorem  [ thm : involution ] is an isomorphism , the set @xmath404 is a basis of @xmath367 .",
    "let @xmath405 be a lift of @xmath398 .",
    "it induces an isomorphism @xmath406 and a train track map @xmath407 .",
    "since @xmath54 deformation retracts to @xmath319 , we can identify @xmath408 with @xmath409 . using the same notation as in the proof of theorem  [ thm : involution ]",
    ", we have @xmath410 hence @xmath411 .",
    "since @xmath304 is finite dimensional and @xmath408 is an isomorphism , we obtain that @xmath412 is an isomorphism .",
    "the topological invariance of the homology polynomial was stated as a conjecture in an earlier draft .",
    "reading that draft , jeffrey carlson pointed the authors to a connection they had missed , making our conjecture an immediate consequence of theorem  [ thm : involution ] .",
    "we are grateful for his help .",
    "[ cor : homology polynomial is invariant ] the homology polynomial @xmath162 is an invariant of the pa mapping class @xmath2 $ ] .    let @xmath405 be a lift of the pa map @xmath308 .",
    "by theorem  [ thm : involution ] we have @xmath413 .",
    "since the eigenspace @xmath367 is an invariant of @xmath2 $ ] , so is our polynomial @xmath162 .",
    "this concludes the proof of part ( 1 ) of theorem  [ thm : summarize ] .",
    "having established the meaning of @xmath40 and the invariance of the homology polynomial , our next goal is to understand whether it is irreducible , and if not to understand its factors . at the same time , we will investigate its symmetries .    with those goals in mind ,",
    "we show that there is a well - defined and @xmath37-invariant skew - symmetric form on the space @xmath40 .",
    "see proposition  [ prop : properties of skew - sym .",
    "we define the subspace @xmath414 to be the space of degeneracies of this skew - symmetric form .",
    "we are able to interpret the the action of @xmath44 on @xmath46 geometrically , as being a permutation of certain punctures on @xmath4 . in theorem  [ thm:2nd decomposition ] we will prove that the space @xmath40 has a decomposition into summands that are invariant under the action of @xmath44 , and that as a consequence the homology polynomial decomposes as a product of two polynomials , @xmath415 and @xmath416 .",
    "we call them the _ puncture _ and _ symplectic _ polynomials . like the homology polynomial , both are invariants of @xmath2 $ ] in mod@xmath14",
    ". we also establish their symmetries in theorem  [ thm:2nd decomposition ] , and understand the precise meaning of the puncture polynomial .",
    "the symplectic polynomial contains @xmath9 as its largest real root .",
    "when irreducible , it coincides with the minimum polynomial of @xmath9 , but in general it is not irreducible .",
    "at this writing we do not understand when it is or is not reducible .",
    "our work begins with a brief diversion , to establish a technical result that will be needed in the sections that follow .",
    "we have shown how to construct basis elements @xmath418 for @xmath40 .",
    "we now build on this construction to give an explicit way to lift each @xmath272 to an element @xmath419 in such a way that @xmath420 , where @xmath421 is the natural surjection .",
    "although there are infinitely many lifts of any given basis element @xmath180 , our construction of a specific @xmath422 will be useful later .",
    "the issues to be faced in lifting @xmath180 to @xmath423 are the assignment of weights to the infinitesimal edges .",
    "suppose that @xmath74 is a vertex with @xmath75 gates numbered @xmath424 counterclockwise . for @xmath425",
    ", we define a _ transitional _ element @xmath426 that assigns @xmath150 to the @xmath77-th infinitesimal edge for the vertex @xmath63 , and @xmath113 to the remaining branches of @xmath16 . in other words , in figure  [ fig : vertex - types ] , @xmath427 and @xmath428 for @xmath429 .",
    "suppose that @xmath74 is an odd vertex with @xmath75 gates . for @xmath425",
    ", we define a _ terminal _ element @xmath430 which assigns @xmath431 to the incident infinitesimal edges for @xmath63 so that the @xmath77-th gate has weight @xmath432 and @xmath433-th @xmath434 gate has weight @xmath435 , cf .",
    "figure  [ fig : weightedpath ] ; and assigns @xmath113 for rest of the branches of @xmath16 .        for both the orientable and the non - orientable case ,",
    "our basis element @xmath272 is a vector whose entries are @xmath212 or @xmath113 . recall that the edges whose weights are @xmath212 form a loop or an arc , denoted by @xmath173 in @xmath45  [ sssec : basis1 ] , [ sssec : basis2 ] and [ sssec : basis3 ] .    at an even or a partial vertex of @xmath173 ,",
    "suppose @xmath173 goes through the @xmath77-th and @xmath433-th gates ( @xmath436 ) .",
    "to @xmath180 we add consecutive transitional elements @xmath437 with alternating signs so that the switch condition is satisfied ( cf . the upper middle circle in figure  [ fig : weightedpath ] ) .",
    "repeat this procedure for all the non - odd vertices of @xmath173 .",
    "if @xmath173 is a loop , it yields an element @xmath422 of @xmath417 .",
    "when @xmath173 is an arc ( i.e. , @xmath16 is non - orientable with odd vertices ) , the two endpoints of @xmath173 are odd .",
    "suppose @xmath173 enters the @xmath77-th gate of an odd vertex .",
    "after adding transitional elements as above , we further add terminal element @xmath438 or @xmath439 so that the switch condition is satisfied at all the incident gates of the odd vertex",
    ". proceed in this way for the other odd vertex as well , and we obtain an element @xmath422 of @xmath417 .      in this section",
    "we define a skew - symmetric form @xmath440 on @xmath40 .",
    "to get started , we slightly modify the skew - symmetric form on @xmath417 introduced by penner - harer  @xcite : for a branch @xmath441 and @xmath97 , let @xmath442 denote the weight that @xmath104 assigns to @xmath231 . at a switch of valence @xmath75 ( @xmath443 ) , label the branches @xmath444 as in figure  [ fig : switch ] . the cyclic order of @xmath445 is determined by the orientation of the surface and the embedding of @xmath16 in @xmath4 .",
    "we define a skew - symmetric form : @xmath446 recall the surjective map @xmath447 collapsing the infinitesimal ( partial ) polygons to vertices",
    ".    for @xmath448 there exist @xmath449 so that @xmath450 and @xmath451 .",
    "we define a skew - symmetric form on @xmath40 by : @xmath452    [ prop : properties of skew - sym .",
    "form ] the skew - symmetric form @xmath453 has the following properties :    1 .",
    "it is well - defined .",
    "2 .   when @xmath16 is orientable , @xmath454 is the homology intersection number of @xmath150-cycles associated to @xmath104 and @xmath455 .",
    "3 .   when @xmath16 is non - orientable , recall that @xmath456 are the eigenspaces of the deck transformation @xmath457 for the orientation cover studied in theorem  [ thm : involution ] . since @xmath458 is a _",
    "double _ branched cover , we have the following results , to be compared with @xcite : 1 .",
    "the restriction of the intersection form on @xmath304 to @xmath366 is twice the intersection form on @xmath459 .",
    "the restriction of the intersection form on @xmath304 to @xmath367 is twice the skew - symmetric form @xmath460 .",
    "4 .   for all @xmath448 ,",
    "we have @xmath461    \\(1 ) it suffices to show that for any @xmath462 and @xmath463 , the product @xmath464 .",
    "since @xmath465 , @xmath466 assigns @xmath113 to any real edge @xmath441 , it follows that the weight of @xmath466 at any gate is @xmath113 .",
    "if a vertex @xmath143 is odd or partial , @xmath466 assigns @xmath113 to any infinitesimal edges associated to the vertex @xmath63 .",
    "therefore , @xmath63 does not contribute to @xmath467 .",
    "if a vertex @xmath143 is even with @xmath75 gates , the weights @xmath468 that @xmath466 assigns to the infinitesimal edges for @xmath63 form an alternating sequence : @xmath469 .",
    "the contribution of the even vertex @xmath63 to @xmath467 is : @xmath470 where @xmath471 are the weights assigned by @xmath472 and indices are modulo @xmath75 .",
    "\\(2 ) assertion ( 2 ) is established in lemma 3.2.2 of @xcite .",
    "\\(3 ) assertion ( 3 ) follows directly from theorem  [ thm : involution ] .",
    "\\(4 ) if @xmath16 is orientable , then we identify @xmath473 .",
    "since @xmath337 is homeomorphism , the homology intersection number is preserved under @xmath474 and the assertion follows .",
    "if @xmath16 is non - orientable , then , passing to the orientation cover , @xmath475 preserves the homology intersection number .",
    "the assertion then follows from ( i ) @xmath476 and ( ii ) assertion ( 3 ) of this proposition .    knowing that @xmath460 is well - defined",
    ", we can compute @xmath477 by using the basis elements @xmath478 discussed in @xmath45  [ sssec : basis1 ] , [ sssec : basis2 ] and [ sssec : basis3 ] , and their particular extensions @xmath479 introduced in @xmath45  [ subsec : transitional & terminal ] .",
    "for this , it is convenient to study how transitional and terminal elements contribute to the skew - symmetric form .",
    "straight forward calculation of determinants at incident gates yields the following :    [ localcomputation ] let @xmath63 be a vertex with @xmath75 incident gates , numbered @xmath480 conterclockwise .",
    "we have @xmath481 , @xmath482 and @xmath483 for @xmath484 .",
    "moreover , @xmath485 @xmath486      in this section , we investigate the totally degenerate subspace of @xmath40 , @xmath487 the _ radical _ of the skew - symmetric form .",
    "it will lead us , almost immediately , to the second decomposition theorem and another new invariant of pa maps .",
    "we begin by showing how @xmath46 has already appeared in our work , in a natural way .",
    "[ prop : dim z ] let @xmath145 be the number of punctures of @xmath4 .    1 .",
    "if @xmath16 is orientable , @xmath488 .",
    "2 .   if @xmath16 is non - orientable , then @xmath489    in the orientable case , recall lemma  [ lem : dimw(g , f ) ] which states @xmath490 , and lemma 3.2.2 of @xcite which shows that our skew - symmetric form agrees with the homology intersection form .",
    "hence the space @xmath46 is generated by the homology classes of @xmath145 loops around the punctures .",
    "because their sum is null - homologous , they are linearly dependent and @xmath491 .",
    "in the non - orientable case , let @xmath54 be the orientation cover of @xmath4 ( definition  [ def : orientation cover ] ) .",
    "recall the eigen spaces @xmath456 for the deck transformation @xmath492 , cf .",
    "theorem  [ thm : involution ] .",
    "let @xmath145 ( resp .",
    "@xmath493 ) be the number of punctures of @xmath4 that lift to two ( resp .",
    "single ) punctures in @xmath54 , and let @xmath494 be the homology classes of loops around the punctures of @xmath54 , chosen so that @xmath495 for all @xmath496 and @xmath497 for all @xmath498 and oriented so that their sum is zero .",
    "the radical of the homology intersection form on @xmath304 is spanned by @xmath499 note that @xmath500 and @xmath501 for all @xmath502 and @xmath498 . by theorem  [ thm : involution ] and assertion ( 3 ) of proposition  [ prop : properties of skew - sym .",
    "form ] , we obtain that @xmath503 .",
    "clearly , @xmath504 are linearly independent , i.e. , @xmath505 .",
    "[ rem : onepuncture ] assume that @xmath4 is once punctured and that @xmath16 is non - orientable .",
    "then @xmath506 if and only if @xmath274 is odd .",
    "the induced skew - symmetric form on @xmath507 is non - degenerate , and so the dimension of @xmath507 is even .",
    "thus , @xmath508 is odd if and only if @xmath509 is odd .",
    "since @xmath4 has exactly one puncture , proposition  [ prop : dim z ] yields that @xmath510 , and the corollary follows .",
    "[ rem : completeness ] straightforward modifications of our arguments show that if @xmath16 is a non - orientable train track ( not necessarily induced by a train track map ) , then the dimension of @xmath511 is the number of complementary regions of @xmath16 with even numbers of corners . in particular ,",
    "if @xmath16 is complete , then the complement of @xmath16 consists of triangles and monogons ( ( * ? ?",
    "* theorem  1.3.6 ) ) , and so the skew - symmetric form on @xmath417 is non - degenerate in this case .",
    "although not explicit stated , this is the case covered by ( * ? ? ?",
    "* theorem  3.2.4 ) .",
    "[ thm:2nd decomposition ] * _ ( second decomposition theorem ) _",
    "* the map @xmath44 preserves the decomposition @xmath512 so that @xmath513 moreover , we have :    1 .",
    "the polynomial @xmath514 is an invariant of the pa mapping class @xmath2 \\in { \\rm mod}(s)$ ] .",
    "the restriction @xmath515 encodes how @xmath10 permutes the punctures whose projections to @xmath16 have even numbers of corners . in particular",
    ", @xmath516 is a periodic map , so that all the roots of @xmath514 are roots of unity and the polynomial @xmath514 is palindromic or anti - palindromic .",
    "the polynomial @xmath517 is an invariant of @xmath2 $ ] .",
    "the skew - symmetric form @xmath460 naturally induces a symplectic form on @xmath50 .",
    "the map @xmath44 induces a symplectomorphism of @xmath50 .",
    "hence the polynomial @xmath518 is palindromic .",
    "the homology polynomial @xmath43 is either palindromic or anti - palindromic .",
    "suppose @xmath519 by assertion ( 4 ) of proposition  [ prop : properties of skew - sym .",
    "form ] , we have @xmath520 for all @xmath521 . by corollary  [ cor : isomorphism of f_ast ] , @xmath522 is surjective , and so @xmath523 .",
    "thus @xmath44 preserves the decomposition @xmath524 .",
    "\\(1 ) the restriction @xmath515 is periodic because of proposition  [ prop : dim z ] and the fact that @xmath2 $ ] permutes the punctures of @xmath4 .",
    "hence all the roots of @xmath415 are roots of unity . moreover ,",
    "if @xmath525 is a root of @xmath415 , then @xmath526 is also a root of @xmath415 because @xmath527 $ ] .",
    "this implies that @xmath48 is palindromic or anti - palindromic .",
    "\\(2 ) by the definition of @xmath46 , the skew - symmetric form induces a non - degenerate form on @xmath50 . this",
    "together with proposition  [ subsec : skew - symmetric form on w(g , f)]-(4 ) implies that the polynomial @xmath518 is palindromic .",
    "it is an invariant of @xmath2 $ ] because it is the quotient of two polynomials , both of which have been proved to be invariants .",
    "\\(3 ) the homology polynomial @xmath528 is either palindromic or anti - palindromic because it is a product of two polynomials , one of which is palindromic and the other of which is either palindromic or anti - palindromic .",
    "this concludes the proof of parts ( 2 ) and ( 3 ) of theorem  [ thm : summarize ] .",
    "since the proof of part ( 1 ) was completed in @xmath45[sec:1st polynomial invariant ] , it follows that theorem  [ thm : summarize ] has been proved .",
    "in this section we give several applications of theorem  [ thm : summarize ] .",
    "corollary  [ cor : combinatorial invariants of [ f ] ] summarizes the numerical class invariants of @xmath2 $ ] that , as a consequence of theorem  [ thm : summarize ] , can be computed from the train track @xmath16 by simple counting arguments .",
    "corollary  [ cor on p(x ) ] is an application to fibered hyperbolic knots in 3-manifolds .",
    "corollary  [ cor : powers ] shows that our three polynomials behave very nicely under the passage @xmath2 \\to[f^k]$ ] .",
    "[ cor : combinatorial invariants of [ f ] ] under the same notation as in theorem  [ thm : summarize ] , let @xmath529 be the number of edges , vertices , odd vertices respectively in the graph @xmath20 .",
    "let @xmath145 @xmath83resp .",
    "@xmath530 be the number of punctures of @xmath4 which are represented by loops in @xmath16 with even @xmath83resp .",
    "odd@xmath84 numbers of corners .",
    "let @xmath146 @xmath83resp .",
    "@xmath531 be the genus of @xmath4 @xmath83resp .",
    "its orientation cover @xmath532 .    1 .",
    "the orientability @xmath83or non - orientability@xmath84 of @xmath16 is a class invariant of @xmath2 $ ] .",
    "the degree of the homology polynomial is a class invariant .",
    "it is : @xmath533 3 .",
    "the degree of the puncture polynomial is a class invariant .",
    "it is : @xmath534 4 .",
    "the degree of the symplectic polynomial is a class invariant .",
    "it is : @xmath535    assertion ( 4 ) implies that the dilatation of @xmath2 $ ] is the largest real root of a polynomial of degree @xmath536 , where @xmath537 @xmath83resp .",
    "@xmath538 . however , this bound is not sharp because , as will be seen in example  [ ex : k89 ] , the symplectic polynomial is not necessarily irreducible .",
    "assertion ( 1 ) is clear .",
    "see lemma  [ lem : dimw(g , f ) ] for ( 2 ) . in the orientable case",
    "each puncture is represented by a loop in @xmath16 with an even number of corners .",
    "this , together with proposition  [ prop : dim z ] , implies ( 3 ) .    to prove ( 4 ) ,",
    "let @xmath539 be the number of even vertices , partial vertices in @xmath20 , respectively .",
    "if @xmath16 is orientable , the assertion is clear . if @xmath16 is non - orientable , the euler characteristics of @xmath4 and @xmath54 are @xmath540 from lemma  [ lem : dimw(g , f ) ] and proposition  [ prop : dim z ] , we have : @xmath541 note that the sum of the degrees of the symplectic and puncture polynomials is the degree of the homology polynomial .",
    "[ cor on p(x ) ] @xmath542 the symplectic polynomial @xmath518 is an invariant of fibered hyperbolic links in @xmath543-manifolds .",
    "@xmath126 assume that @xmath544 is a homology @xmath543-sphere and @xmath545 is a fibered hyperbolic knot whose monodromy admits an orientable train track .",
    "let @xmath546 and @xmath547 denote the alexander polynomial of @xmath548 .",
    "then @xmath549    \\(1 ) let @xmath550 be a link .",
    "thurston proved that a 3-manifold @xmath551 is fibered over @xmath552 with a pa monodromy @xmath2\\in { \\rm mod}(s)$ ] if and only if @xmath553 is hyperbolic .",
    "combining his result with assertion ( 2 ) of theorem  [ thm:2nd decomposition ] , we obtain the first claim .",
    "\\(2 ) let @xmath554 be the induced map . by assertion ( 1 ) of proposition  [ prop : dim z ]",
    ", the space @xmath46 is trivial .",
    "lemma  [ lem : dimw(g , f ) ] tells us that @xmath555 . since ( @xmath556)-gate is mapped to a ( @xmath557)-gate if and only if @xmath558 is orientation reversing , we have @xmath559 the fact that @xmath560 yields the statement .    corollary  [ cor on p(x)]-(2 ) can be seen as a refinement of rykken s ( * ? ? ? * theorem 3.3 ) .",
    "our final application is to prove that our three polynomials , @xmath43 , + @xmath517 and @xmath514 behave in a very nice way under the passage @xmath2 \\to [ f^n]$ ] :    [ cor : powers ]    let @xmath561 if @xmath562 represents a pa mapping class @xmath2 $ ] , then @xmath563 represents @xmath564 $ ] .",
    "suppose @xmath565 and @xmath566 where @xmath567 , then @xmath568    note that the pa maps @xmath2 $ ] and @xmath564 $ ] act on the same surface and share the same graph @xmath20 and the associated train track @xmath16 .",
    "the direct sum decomposition in theorem  [ thm:2nd decomposition ] tells us that @xmath569 and @xmath570 since @xmath571 and @xmath572 are eigenvalues of @xmath573 and @xmath515 respectively , the desired equations follow .",
    "the product decomposition for the homology polynomial follows from the fact that it is a product of the other two polynomials .",
    "all of our examples were analyzed with the software package xtrain @xcite , with some help from octave @xcite .",
    "this package is an adaptation of the bestvina - handel algorithm to once - punctured surfaces .",
    "our illustrations show a train track @xmath16 ( in the sense of @xcite ) embedded in a once - punctured surface . regardless of whether @xmath16 admits an orientation , we equip individual edges of the graph @xmath20 with a direction for the purpose of specifying the map @xmath574 , although they coincide when @xmath16 is orientable .",
    "we remark that the limitations of the available software , at this time , to once - punctured surfaces means that the puncture polynomial in our examples is always either 1 or @xmath575    a surface is shown as a fundamental domain in the poincar ' e model for @xmath576 , with the identification pattern on the boundary given by the labels on edges .",
    "for example , a side crossed by an edge labeled @xmath193 will be identified with the side crossed by the edge labeled @xmath577 .",
    "these labels also indicate the direction of an edge ; @xmath193 is the first half , @xmath577 the second one .",
    "the shaded regions in the pictures contain all the infinitesimal edges associated with a vertex , as in figure  [ fig : vertex - types ] .",
    "to recover the graph @xmath20 , collapse each shaded region to a point .",
    "in each example , we give the associated train track map on edges of @xmath20 .",
    "that map determines the maps on the vertices .",
    "[ ex : filling - curves ] we illustrate corollary  [ cor : homology polynomial is invariant ] with a triplet of examples . sketches ( 1 ) , ( 2 ) and ( 3 ) of figure  [ fig : filling - curves ] show three copies of a once - punctured genus 2 surface @xmath578 , each containing two simple closed curves @xmath579 and @xmath580 . in all three cases @xmath581 fills @xmath4 , that is the complement of the union of the two curves is a family of discs . in all three cases the geometric intersection @xmath582",
    "we use our curves to define three diffeomorphisms of @xmath4 by the formula @xmath583 where @xmath584 denotes a dehn twist about a simple closed curve @xmath225 . by a theorem of thurston ( theorem 14.1 of @xcite ) there is a representation of the free subgroup of @xmath585 generated by @xmath586 and @xmath587 in @xmath588 which sends the product @xmath589 to the matrix @xmath590 by the thurston s theorem , @xmath589 is pa and its dilation is the largest real root of the characteristic polynomial @xmath591 of this matrix , that is @xmath592 in all three cases .",
    "we ask two questions : are @xmath57 conjugate in @xmath60 , and if they are not conjugate can our invariants distinguish them ?",
    "see @xcite for a choice of _ standard curves _",
    "@xmath593 on @xmath4 . to obtain the needed input data for the computer software xtrain @xcite we must express our maps as products of dehn twists about these curves . for simplicity",
    ", we denote the dehn twist @xmath594 by the same symbol @xmath595 . using @xmath596 for the inverse dehn twists of @xmath597 ,",
    "we find , after a small calculation , that : @xmath598 focussing on @xmath599 and @xmath600 first , xtrain tells us that the associated transition matrices are : @xmath601 in both cases @xmath602 with largest real root @xmath592 , as expected .        with the train tracks @xmath90 in hand we can see , immediately , that @xmath599 and @xmath600 are inequivalent ,",
    "because @xmath88 is orientable and @xmath89 is not . also , by lemma  [ lem : dimw(g , f ) ] the dimension of @xmath603 , which is the degree of the homology polynomial , is @xmath604 ( resp .",
    "@xmath543 ) when @xmath605 ( resp .",
    "@xmath3 ) .      for @xmath599 , a basis of @xmath606 , @xmath607 ,",
    "were computed in example  [ ex - of - basis - orientable ] . set @xmath608 and follow the instructions in @xmath45[sssec : basis4 ] for finding the matrix @xmath609 representing @xmath610 .",
    "we obtain : @xmath611 its characteristic polynomial is @xmath612 which is the homology polynomial .",
    "corollary  [ cor : combinatorial invariants of [ f]]-(4 ) tells that the symplectic polynomial has degree @xmath604 , hence it coincides with the homology polynomial .    for @xmath600 , we apply @xmath45[sssec : basis3 ] and set the non - orientable loop @xmath613 and subgraph @xmath614 .",
    "edges @xmath615 are not in @xmath244 .",
    "we reorder the edges and call @xmath616 . with this order ,",
    "basis vectors of @xmath617 are @xmath618 ; @xmath619 ; @xmath620 ; where `` prime '' means the transpose . following the instructions in @xmath45[sssec : basis4 ] ,",
    "we obtain the matrix @xmath621 representing @xmath622 . @xmath623",
    "the homology polynomial is @xmath624 , which means @xmath625 . by corollary  [ rem : onepuncture ] , the symplectic polynomial has degree @xmath3 , so it is @xmath626 .",
    "we turn to @xmath627 . from xtrain",
    ", we learn that the homology polynomials for @xmath600 and @xmath627 are the same . however , observe that the curves @xmath628 are all non - separating on @xmath4 , but @xmath629 is separating . from this",
    "it follows that there can not be an element @xmath630 that maps @xmath629 to either @xmath579 or @xmath631 .",
    "thus @xmath632 $ ] is very likely not conjugate to either @xmath633 $ ] or @xmath634 $ ] in @xmath60 .",
    "[ ex : k89 ] this example shows that the symplectic polynomial need not be irreducible over the rationals .",
    "the monodromy of the hyperbolic knot @xmath635 @xcite is represented by the following train track map :      @xmath636 we have that @xmath637 .",
    "fix a basis of @xmath164 , @xmath638 with respect to this basis , @xmath639 is represented as : @xmath640 whose characteristic polynomial is @xmath641 .",
    "therefore @xmath43 is : @xmath642 proposition  [ prop : dim z]-(1 ) tells us that @xmath643 , so that @xmath644 . since @xmath25 is orientation preserving , by corollary  [ cor on p(x)]-(2 ) , we have @xmath645 .",
    "it further factors as @xmath646 .",
    "it is interesting that these factors are no longer palindromic , and one contains the dilatation @xmath9 as a root and the other @xmath647 .",
    "there is exactly one vertex ( which is partial ) and the train track is non - orientable .",
    "the only vertex is fixed by the map and @xmath653 .",
    "we have @xmath654 , hence the skew - symmetric product is degenerate and @xmath655 , which means @xmath656 .",
    "the characteristic polynomial factors as @xmath657 the symplectic polynomial @xmath658 is irreducible , hence in this example it is necessarily the minimum polynomial of its dilatation .",
    "( note that this was not the case in example  [ ex : k89 ] above . )",
    "if one orients the real and infinitesimal edges of the train track @xmath16 in figure  [ fig : pennersub2 ] locally so that all orientations are consistent around the single partial vertex @xmath204 , one sees that the loops @xmath659 and @xmath85 do not have globally consistent orientations , whereas the loops @xmath660 and @xmath69 do .",
    "since @xmath20 has no odd vertices , the orientation cover is just an ordinary double cover as illustrated in figure  [ fig : penner - cover ] .",
    "each edge , say @xmath661 , lifts to two copies @xmath662 and the vertex @xmath663 lifts to @xmath664 .",
    "we choose an orientation for @xmath342 . as claimed in proposition  [",
    "prop : orientation cover is orientable ] , twin edges have opposite orientations .",
    "proposition  [ or - cover - matrix ] implies that there are two covering maps ; orientation preserving and orientation reversing .",
    "the following is the orientation preserving train track map @xmath665 : @xmath666 we order the edges @xmath667 .",
    "then the transition matrix of @xmath331 has the form @xmath668 where @xmath669 note that @xmath670 is the transition matrix for @xmath671 .",
    "its characteristic polynomial is @xmath672 and the symplectic polynomial is @xmath673 the following is the orientation reversing train track map @xmath674 .",
    "@xmath675 we observe that the transition matrix for @xmath332 is @xmath676 its characteristic polynomial is @xmath677 and the symplectic polynomial is @xmath678 the dilatation can not distinguish the pa maps @xmath308 , @xmath679 and @xmath680 , but our symplectic polynomial can distinguish the three .",
    "the characteristic polynomial factors as @xmath681 the factor @xmath682 is the characteristic polynomial of the matrix @xmath683 which describes how non - odd vertices @xmath684 are permuted by @xmath2 $ ] ."
  ],
  "abstract_text": [
    "<S> we investigate the structure of the characteristic polynomial @xmath0 of a transition matrix @xmath1 that is associated to a train track representative of a pseudo - anosov map @xmath2 $ ] acting on a surface . as a result </S>",
    "<S> we obtain three new polynomial invariants of @xmath2 $ ] , one of them being the product of the other two , and all three being divisors of @xmath0 . </S>",
    "<S> the degrees of the new polynomials are invariants of @xmath2 $ ] and we give simple formulas for computing them by a counting argument from an invariant train - track . </S>",
    "<S> we give examples of genus @xmath3 pseudo - anosov maps having the same dilatation , and use our invariants to distinguish them . </S>"
  ]
}