{
  "article_text": [
    "this paper develops new tools for formal inference and informal model validation in the analysis of spatial point pattern data .",
    "the score test statistic , based on the point process likelihood , is generalized to a `` pseudo - score '' test statistic derived from besag s pseudo - likelihood .",
    "the score and pseudo - score can be viewed as residuals , and further generalized to a class of residual diagnostics .",
    "the likelihood score and the score test @xcite , @xcite , pages 315 and 324 , are used frequently in applied statistics to provide diagnostics for model selection and model validation @xcite . in spatial statistics ,",
    "the score test has been used mainly to support formal inference about covariate effects @xcite assuming the underlying point process is poisson under both the null and alternative hypotheses .",
    "our approach extends this to a much wider class of point processes , making it possible ( for example ) to check for covariate effects or localized hot - spots in a clustered point pattern .",
    "figure [ fig : data ] shows three example data sets studied in the paper . our techniques make it possible to check separately for `` inhomogeneity '' ( spatial variation in abundance of points ) and `` interaction '' ( localized dependence between points ) in these data .    [",
    "cols=\"^,^,^ \" , ]",
    "in this section we discuss which of the diagnostics we prefer to use based on their behavior for the three test cases in sections  [ s : trendinhib][s : jap ] .    typically , the various diagnostics supplement each other well , and it is recommended to use more than one diagnostic when validating a model . it is well known that @xmath1 is sensitive to features at a larger scale than @xmath2 and @xmath3 .",
    "compensator and pseudo - compensator plots are informative for gaining an overall picture of model validity , and tend to make it easy to recognize a poor fit when comparing competing models . to compare models which fit closely",
    ", it may be more informative to use ( standardized ) residuals or pseudo - residuals .",
    "we prefer to use the standardized residuals , but it is important not to over - interpret the significance of departure from zero .    based on the test cases here ,",
    "it is not clear whether diagnostics based on pairwise distances , nearestneighbor distances , or empty space distances are preferable . however , for each of these we prefer to work with compensators and residuals rather than pseudo - compensators and pseudo - residuals when possible ( i.e. , it is only necessary to use pseudo - versions for diagnostics based on empty space distances ) . for instance , for the first test case ( section  [ s : trendinhib ] ) the best compensator plot is that in figure  [ fig : synth1:k](a ) based on pairwise distances ( @xmath1 and @xmath4 ) which makes it easy to identify the correct model . on the other hand , in this test case",
    "the best residual type plot is that in figure  [ fig : synth1:g](b ) based on nearest neighbor distances ( @xmath5 ) where the correct model is the only one within the critical bands .",
    "however , in the third test case ( section  [ s : jap ] ) the best compensator plot is one of the plots in figure  [ fig : jap : a ] with pseudo - compensators based on empty space distances ( @xmath6 and @xmath7 or @xmath8 and @xmath9 , respectively ) which clearly indicates which model is correct .    in the first and third test cases ( sections  [ s : trendinhib]and  [ s : jap ] ) , which both involve inhomogeneous models , it is clear that @xmath1 and its compensator are more sensitive to lack of fit in the first order term than  @xmath2 and its compensator [ compare , e.g. , the results for the homogeneous model  in figures  [ fig : synth1:k](a ) and  [ fig : synth1:g](b ) ] .",
    "it is our general experience that diagnostics based on  @xmath1 are particularly well suited to assess the presence of interaction and to identify the general form of interaction .",
    "diagnostics based on @xmath1 and , in particular , on @xmath2 seem to be good for assessing the range of interaction .    finally , it is worth mentioning the computational difference between the various diagnostics ( timed on a 2.5  ghz laptop ) .",
    "the calculations for @xmath1 and @xmath4 used in figure  [ f : krightkcom ] are carried out in approximately five seconds , whereas the corresponding calculations for @xmath2 and @xmath10 only take a fraction of a second . for @xmath8 and @xmath9 , for example , the calculations take about 45  seconds .",
    "the definition of residuals and pseudo - residuals should extend immediately to marked point processes . for space",
    " time point processes , residual diagnostics can be defined using the spatiotemporal conditional intensity ( i.e. , given the past history )",
    ". pseudo - residuals are unnecessary because the likelihood of a general space  time point process is a  product integral ( mazziotto  szpirglas identity ) . in the space ",
    "time case there is a martingale structure in time , which gives more hope of rigorous asymptotic results in the temporal ( long - run ) limit regime .",
    "residuals can be derived from many other summary statistics .",
    "examples include third - order and higher - order moments ( appendix  [ app : kthmoment ] ) , tessellation statistics ( appendix  [ app : tess ] ) , and various combinations of @xmath11 , @xmath12 and  @xmath0 .    in the definition of the extended model ( [ e : extended ] ) the canonical statistic @xmath13 could have been allowed to depend on the nuisance parameter @xmath14 , but this would have complicated our notation and some analysis .",
    "in this appendix we present other diagnosticswhich we have not implemented in software , and which therefore are not accompanied by experimental results .",
    "while the intensity and @xmath0-function are frequently - used summaries for the first and second order moment properties of a spatial point process , third and higher order summaries have been less used @xcite .      for a functional summary statistic of @xmath15th order , say , @xmath16 we obtain @xmath17\\\\ [ -8pt ] & & \\quad= k!{\\mathcal{r}}s({\\mathbf{x}},r)=k ! s({\\mathbf{x}},r)-k ! { \\mathcal{c}}s({\\mathbf{x}},r),\\nonumber\\hspace*{-28pt}\\end{aligned}\\ ] ] where @xmath18 are pairwise distinct in the sums in  ( [ e : pairwise_relation4])([e : pairwise_relation5 ] ) . in this case again , pseudo - residual diagnostics are equivalent to those based on residuals .      for a stationary and isotropic point process ( i.e. , when the distribution of @xmath19 is invariant under translations and rotations )",
    ", the intensity and @xmath0-function of the process completely determine its first and second order moment properties .",
    "however , even in this case , the simplest description of third order moments depends on a three - dimensional vector specified from triplets @xmath20 of points from @xmath19 such as the lengths and angle between the vectors @xmath21 and @xmath22 .",
    "this is often considered too complex , and instead one considers a certain one - dimensional property of the triangle @xmath23 as exemplified below , where @xmath24 denotes the largest side in @xmath23 .",
    "let the canonical sufficient statistic of the perturbing density ( [ e : perturbing ] ) be @xmath25\\\\ [ -8pt ] & = & \\sum_{i < j < k}{{\\mathbb i}\\ { { l(x_i , x_j , x_k)\\le r } \\}}.\\nonumber\\end{aligned}\\ ] ] the perturbing model is a special case of the _ triplet interaction point process _ studied in @xcite .",
    "it is also a  special case of ( [ e : kth ] ) with @xmath26 residual and pseudo - residual diagnostics are equivalent and given by ( [ e : pairwise_relation4])([e : pairwise_relation6 ] ) .",
    "some authors have suggested the use of tessellation methods for characterizing spatial point processes @xcite .",
    "a planar tessellation is a subdivision of planar region such as @xmath27 or the entire plane @xmath28 .",
    "for example , consider the dirichlet tessellation of  @xmath27 generated by @xmath29 , that is , the tessellation with cells @xmath30 suppose the canonical sufficient statistic of the perturbing density ( [ e : perturbing ] ) is @xmath31 this is a sum of local contributions as in ( [ e : sumoflocal ] ) , although not of local statistics in the sense mentioned in section  [ s : theory : residual ] , since @xmath32 depends on those points in @xmath33 which are dirichlet neighbors to @xmath34 and such points may of course not be @xmath35-close to @xmath34 ( unless @xmath35 is larger than the diameter of @xmath27 ) .",
    "we call this perturbing model a _ soft ord process _ ; ord s process as defined in @xcite is the limiting case @xmath36 in ( [ e : perturbing ] ) , that is , when @xmath35 is the lower bound on the size of cells . since @xmath37 ,",
    "the perturbing model is well - defined for all @xmath38 .",
    "let @xmath39 denote the dirichlet neighbor relation for the points in @xmath29 , that is , @xmath40 if @xmath41 .",
    "note that @xmath42 .",
    "now , @xmath43\\nonumber\\end{aligned}\\ ] ] depends not only on the points in @xmath29 which are dirichlet neighbors to @xmath44 ( with respect to @xmath45 ) but also on the dirichlet neighbors to those points ( with respect to @xmath45 or with respect to @xmath46 ) . in other words",
    ", if we define the iterated dirichlet neighbor relation by that @xmath47 if there exists some @xmath48 such that @xmath49 and @xmath50 , then @xmath51 depends on those points in @xmath29 which are iterated dirichlet neighbors to @xmath44 with respect to @xmath45 or with respect to @xmath46 .",
    "the pseudo - sum associated to the soft ord process is @xmath52\\end{aligned}\\ ] ] and from ( [ e : pseudocomp ] ) and ( [ e : fffffffff ] ) we obtain the pseudo - compensator . from ( [ e : compensatorlocal ] ) and ( [ e : soft.ord ] ) , we obtain the papangelou compensator @xmath53 many other examples of tessellation characteristics may be of interest .",
    "for example , often the delaunay tessellation is used instead of the dirichlet tessellation .",
    "this is the dual tessellation to the dirichlet tessellation , where the delaunay cells generated by @xmath29 are given by those triangles @xmath23 such that the disc containing @xmath54 in its boundary does not contain any further points from @xmath29 ( strictly speaking we need to assume a regularity condition , namely , that @xmath29 has to be in general quadratic position ; for such details , see @xcite ) . for instance , the summary statistic @xmath55 given by the number of delaunay cells @xmath23 with @xmath56 , where @xmath57 is the length of the triangle with vertices @xmath58 , is a kind of third order statisticis related to ( [ e : wwww ] ) but concerns only the maximal cliques of dirichlet neighbors ( assuming again the general quadratic position condition ) .",
    "the correspondingperturbing model has not been studied in the literature , to the best of our knowledge .",
    "this appendix concerns the variance of diagnostic quantities of the form @xmath59 where @xmath60 is a functional for which these quantities are almost surely finite , @xmath19 is a point process on  @xmath27 with papangelou conditional intensity @xmath61 and  @xmath62 is an estimate of @xmath14 ( e.g. , the mple ) .",
    "exact formulae for the variance of the innovation  @xmath63 and residual @xmath64 are given in @xcite .",
    "expressions for @xmath65 are unwieldy @xcite , section 6 , but to a first approximation we may ignore the effect of estimating  @xmath14 and consider the variance of @xmath63 . suppressing the dependence on @xmath14 , this is ( @xcite , proposition 4 ) , @xmath66 { \\,\\mathrm{d}{u } } \\nonumber\\hspace*{-28pt}\\\\ [ -8pt]\\\\ [ -8pt ]       \\hspace*{15pt } & & { } + \\int_{w^2 } { \\mathbb e } [          a(u , v,{\\mathbf{x } } ) + b(u , v,{\\mathbf{x } } )          ] { \\,\\mathrm{d}{u } } { \\,\\mathrm{d}{v}},\\nonumber\\hspace*{-28pt }   \\end{aligned}\\ ] ] where @xmath67 where @xmath68 is the second order papangelou conditional intensity .",
    "note that for a poisson process @xmath69 is identically zero .",
    "let @xmath70 be a functional summary statistic with function argument @xmath71 .",
    "take @xmath72.then the innovation @xmath63 is the pseudo - score ( [ e : pu ] ) , and the variance formula ( [ e : var.innov ] ) becomes @xmath73\\nonumber\\hspace*{-10pt}\\\\[2pt ]   & & \\quad=    \\int_w { \\mathbb e } [      ( \\delta_u s({\\mathbf{x}},z ) ) ^2 \\lambda(u,{\\mathbf{x } } )    ] { \\,\\mathrm{d}{u } } \\nonumber\\hspace*{-10pt}\\\\[2pt ]     & & \\qquad{}+   \\int_{w^2 } { \\mathbb e } [     ( \\delta_u \\delta_v s({\\mathbf{x}},z ) ) ^2 \\lambda_2(u , v,{\\mathbf{x } } )    ] { \\,\\mathrm{d}{u } } { \\,\\mathrm{d}{v } } \\hspace*{-10pt}\\\\[2pt ]     & & \\qquad{}+   \\int_{w^2 } { \\mathbb e } [            \\delta_u s({\\mathbf{x}},z )   \\delta_v s({\\mathbf{x}},z)\\nonumber\\hspace*{-10pt}\\\\[2pt ] & & \\qquad{}\\cdot            \\ {              \\lambda(u,{\\mathbf{x } } ) \\lambda(v,{\\mathbf{x } } ) - \\lambda_2(u , v,{\\mathbf{x } } )            \\ }          ] { \\,\\mathrm{d}{u } } { \\,\\mathrm{d}{v}},\\nonumber\\hspace*{-10pt}\\end{aligned}\\ ] ] where for @xmath74 and @xmath75 , @xmath76 & & { } - s({{{{\\mathbf{x } } } \\cup \\ { { v } \\ } } } , z ) + s({\\mathbf{x}},z)\\end{aligned}\\ ] ] satisfies @xmath77 .",
    "appendices  [ app : edge][app : g ] describe modifications to the standard edge corrected estimators of @xmath78 and @xmath79 required in the conditional case ( section  [ s : assump : cond ] ) because the papangelou conditional intensity @xmath80 can or should only be evaluated at locations @xmath81 where @xmath82 .",
    "corresponding compensators are also given .",
    "assume the point process is markov and we are in the conditional case as described in section  [ s : markov ] .",
    "consider an empirical functional statistic of the form @xmath83 with compensator ( in the unconditional case ) @xmath84 we explore two different strategies for modifying the edge correction .    in the _ restriction approach _",
    ", we replace @xmath27 by @xmath85 and @xmath29 by @xmath86 , yielding @xmath87\\\\ [ -8pt ]     \\hspace*{20pt } { \\mathcal{c}}s_{{{{w}^\\circ}}}({\\mathbf{x}},r ) & = & \\int_{{{{w}^\\circ } } } s_{{{{w}^\\circ}}}(u,{{{{\\mathbf{x}}}^\\circ}},r ) \\lambda_{\\hat\\theta}(u,{{{{\\mathbf{x}}}^\\circ}}\\vert { { { { \\mathbf{x}}}^{+ } } } ) { \\,\\mathrm{d}{u } } .\\nonumber\\end{aligned}\\ ] ] data points in the boundary region @xmath88 are ignored in the calculation of the empirical statistic @xmath89 .",
    "the boundary configuration @xmath90 contributes only to the estimation of @xmath14 and the calculation of the papangelou conditional intensity @xmath91 .",
    "this has the advantage that the modified empirical statistic  ( [ e : sumsrestrict ] ) is identical to the standard statistic @xmath13 computed on the subdomain @xmath85 ; it can be computed using existing software , and requires no new theoretical justification .",
    "the disadvantage is that we lose information by discarding some of the data .    in the _ reweighting approach _",
    "we retain the boundary points and compute @xmath92 where @xmath93 is a modified version of @xmath94 .",
    "boundary points contribute to the computation of the modified summary statistic @xmath95 and its compensator .",
    "the modification is designed so that @xmath95 has properties analogous to @xmath96 .",
    "the @xmath0-function and @xmath12-function of a point process  @xmath97 in @xmath98 are defined @xcite under the assumption that @xmath97 is second order stationary and strictly stationary , respectively .",
    "the standard estima - tors  @xmath99 and @xmath100 of the @xmath0-function and @xmath12-function , respectively , are designed to be approximately pointwise unbiased estimators when applied to @xmath101 .",
    "we do not necessarily assume stationarity , but when constructing modified summary statistics@xmath102 and @xmath103 , we shall require that they are also approximately pointwise unbiased estimators of @xmath78 and @xmath79 , respectively , when @xmath97 is stationary .",
    "this greatly simplifies the interpretation of plots of @xmath102 and @xmath103 and their compensators .",
    "the most common nonparametric estimators of the @xmath0-function @xcite are continuous horvitz  thompson type estimators @xcite of the form @xmath104\\\\ [ -8pt ] & = & \\frac{1}{\\hat{\\rho}^2({\\mathbf{x } } ) |w| }    \\sum_{i\\neq j }    e_w(x_i , x_j ) { { \\mathbb i}\\ { { \\|x_i - x_j\\| \\le r } \\ } } .\\nonumber\\hspace*{-20pt}\\end{aligned}\\ ] ] here @xmath105 should be an approximately unbiased estimator of the squared intensity @xmath106 under stationarity . usually @xmath107 where    the term @xmath108 is an edge correction weight , depending on the geometry of @xmath27 , designed so that the double sum in ( [ e : khat : app ] ) , say , @xmath109 , is an unbiased estimator of @xmath110 .",
    "popular examples are the ohser  stoyan translation edge correction with @xmath111\\\\ [ -8pt ] & = & \\frac{|w|}{|w \\cap ( w+(u - v))|}\\nonumber\\end{aligned}\\ ] ] and ripley s isotropic correction with @xmath112\\\\ [ -8pt ]    & = & \\frac {        2 \\pi \\vert u - v\\vert      } { \\mathsf{length}(\\partial b(u,\\vert u - v\\vert ) \\cap w)}.\\nonumber\\end{aligned}\\ ] ] estimators of the form ( [ e : khat : app ] ) satisfy the local decomposition ( [ e : sums ] ) where @xmath113 now we wish to modify ( [ e : khat : app ] ) so that the outer summation is restricted to data points @xmath34 in @xmath82 , while retaining the property of unbiasedness for stationary and isotropic point processes .",
    "the _ restriction estimator _ is @xmath114 where the edge correction weight is given by ( [ e : edgetrans ] ) or ( [ e : edgeripley ] ) with @xmath27 replaced by @xmath85 .",
    "a more efficient alternative is to replace ( [ e : khat : app ] ) by the _ reweighting estimator _",
    "@xmath115 where @xmath116 is a modified version of @xmath117 constructed so that the double sum in ( [ e : khat : smart ] ) is unbiased for @xmath118 .",
    "compared to the restriction estimator  ( [ e : khat : restrict ] ) , the reweighting estimator ( [ e : khat : smart ] ) contains additional contributions from point pairs @xmath119 where @xmath120 and @xmath121 .",
    "the modified edge correction factor @xmath122for  ( [ e : khat : smart ] ) is the horvitz  thompson weight @xcite in an appropriate sampling context .",
    "@xcite isotropic correction ( [ e : edgeripley ] ) is derived assuming isotropy , by palm conditioning on the location of the first point @xmath34 , and determining the probability that @xmath123 would be observed inside @xmath27 after a random rotation about @xmath34 . since the constraint on @xmath123 is unchanged , no modification of the edge correction weight is required , and we take @xmath124 as in ( [ e : edgeripley ] ) .",
    "note , however , that the denominator in ( [ e : khat : smart ] ) ischanged from @xmath125 to @xmath126 .",
    "the ohser  stoyan @xcite translation correction ( [ e : edgetrans ] ) is derived by considering two - point sets @xmath119 sampled under the constraint that both @xmath34 and @xmath123 are inside @xmath27 . under the modified constraint that @xmath127 and @xmath128 , the appropriate edge correction weight is @xmath129 so that @xmath130 is the fraction of locations @xmath44 in  @xmath85 such that @xmath131 .",
    "a slightly different creature is the border corrected estimator [ using usual intensity estimator @xmath132 @xmath133 with compensator ( in the unconditional case ) @xmath134 the _ restriction estimator _ is @xmath135 and the compensator is @xmath136 typically , @xmath137 , so @xmath138 is equal to @xmath139 .",
    "the _ reweighting estimator _ is @xmath140 and the compensator is @xmath141 usually , @xmath137 , so @xmath142 is equal to@xmath143 . from this",
    "we conclude that when using border correction we should always use the reweighting estimator since the restriction estimator discards additional information and neither the implementation nor the interpretation is easier .",
    "[ app : g ]      hanisch @xcite considered estimators for @xmath79 of the form @xmath144 , where @xmath145 is some estimator of the intensity @xmath146 , and @xmath147 where @xmath148 is the nearest neighbor distance for @xmath34 . if @xmath145 were replaced by @xmath146 , then @xmath149 would be an unbiased , horvitz  thompson estimator of @xmath79 .",
    "see @xcite , pages 128129 , @xcite .",
    "hanisch s recommended estimator @xmath150 is the one in which @xmath145 is taken to be @xmath151 this is sensible because @xmath152 is an unbiased estimator of @xmath146 and is positively correlated with @xmath153 .",
    "the resulting estimator @xmath149 can be decomposed in the form ( [ e : sums ] ) where @xmath154 for @xmath155 , where @xmath156 is the ( `` empty space '' ) distance from location @xmath44 to the nearest point of @xmath29 . hence ,",
    "the corresponding compensator is @xmath157 this is difficult to evaluate , since the denominator of the integrand involves a summation over all data points : @xmath158 is not related in a simple way to @xmath159 .",
    "instead , we choose @xmath145 to be the conventional estimator @xmath160 . then @xmath161 which can be decomposed in the form ( [ e : sums ] ) with @xmath162 for @xmath155 , so that the compensator is @xmath163    in the _ restriction estimator _ we exclude the boundary points and take @xmath164 , effectively replacing the data set @xmath29 by its restriction @xmath165 : @xmath166 the compensator is ( [ e : gcom : modif ] ) but computed for the point pattern @xmath167 in the window @xmath85 : @xmath168 in the usual case @xmath169 , we have @xmath170 .    in the _ reweighting estimator",
    "_ we take @xmath171 . to retain the horvitz  thompson property",
    ", we must replace the weights @xmath172 in ( [ e : dhat ] ) by @xmath173 .",
    "thus , the modified statistics are @xmath174 and @xmath175 in the usual case where @xmath137 , we have @xmath176 .",
    "optionally , we may also replace @xmath177 in ( [ e : ghatr ] ) by @xmath178 , and , correspondingly , replace @xmath179 in ( [ e : gcomr ] ) by @xmath180 .",
    "the classical border correction estimate of @xmath12 is @xmath181\\\\ [ -8pt ]      \\hspace*{15pt}&&{}\\cdot   \\sum_{x_i\\in{\\mathbf{x } } } { { \\mathbb i}\\ { { x_i \\in w_{\\ominus r } } \\ } }        { { \\mathbb i}\\ { { d(x_i , { { \\mathbf{x}}_{-{i } } } ) \\le r } \\}}\\nonumber\\end{aligned}\\ ] ] with compensator ( in the unconditional case ) @xmath182\\\\ [ -8pt ]         \\hspace*{15pt}&&{}\\cdot \\int_{w_{\\ominus r } }          { { \\mathbb i}\\ { { d(u , { \\mathbf{x } } ) \\le r } \\ } }          \\lambda_{\\hat\\theta}(u,{\\mathbf{x } } )          { \\,\\mathrm{d}{u}}.\\nonumber\\end{aligned}\\ ] ] in the conditional case , the papangelou conditional intensity @xmath183 must be replaced by @xmath184 given in ( [ e : lam = lam ] ) .",
    "the _ restriction estimator _ is obtained by replacing @xmath27 by @xmath85 and @xmath29 by @xmath167 in ( [ e : ghat : bord])([e : gcom : bord ] ) , yielding @xmath185 typically , @xmath137 so that @xmath186 .",
    "the _ reweighting estimator _ is obtained by restricting @xmath34 and @xmath44 in ( [ e : ghat : bord])([e : gcom : bord ] ) to lie in @xmath85 , yielding @xmath187 in the usual case where @xmath137 , we have @xmath188 .",
    "again , the reweighting approach is preferable to the restriction approach .",
    "the border corrected estimator @xmath189 has relatively poor performance and sample properties @xcite , page  209 .",
    "its main advantage is its computational efficiency in large data sets .",
    "similar considerations should apply to its compensator .",
    "this paper has benefited from very fruitful discussions with professor rasmus p. waagepetersen .",
    "we also thank the referees for insightful comments . the research was supported by the university of western australia , the danish natural science research council ( grants 272 - 06 - 0442 and 09 - 072331 , _ point process modeling and statistical inference _ ) , the danish agency for science , technology and innovation ( grant 645 - 06 - 0528 , _ international ph.d . student _ ) and by the centre for stochastic geometry and advanced bioimaging , funded by a grant from the villum foundation ."
  ],
  "abstract_text": [
    "<S> we develop new tools for formal inference and informal model validation in the analysis of spatial point pattern data . </S>",
    "<S> the score test is generalized to a `` pseudo - score '' test derived from besag s pseudo - likelihood , and to a class of diagnostics based on point process residuals . </S>",
    "<S> the results lend theoretical support to the established practice of using functional summary statistics , such as ripley s @xmath0-function , when testing for complete spatial randomness ; and they provide new tools such as the _ compensator _ of the @xmath0-function for testing other fitted models . </S>",
    "<S> the results also support localization methods such as the scan statistic and smoothed residual plots . </S>",
    "<S> software for computing the diagnostics is provided .    ,    . </S>"
  ]
}