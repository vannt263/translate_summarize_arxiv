{
  "article_text": [
    "quantum key distribution ( qkd ) is a cryptographic protocol for expanding a pre - shared secret between two users ( alice and bob ) by transferring quantum systems .",
    "once an adversary ( eve ) tries to acquire information about a transferred quantum system , she inevitably disturbs it in a way that can be detected by the legitimate users , and causes the abortion of the protocol ; this principle is known as `` information vs. disturbance ''  @xcite .",
    "the first and most popular qkd protocol is the bb84 protocol  @xcite , in which alice sends qubits to bob using two conjugate bases . in the real world , qubits are implemented via various methods .",
    "a very common qkd implementation is the _ phase - encoded , time - multiplexed _ scheme : a pulse that contains a single photon is sent in a superposition of two possible times , so that the encoded bit is the phase difference between these superpositions as initially suggested by bennett  @xcite and implemented by townsend and others  @xcite . in order to produce and measure such superpositioned pulses , it is common to use an _ interferometer _ ( see section  [ sec : interferobb84 ] ) .",
    "in addition to the basic ( phase - encoded , time - multiplexed ) setup , interferometers are also used in more complex qkd setups .",
    "for instance , an interferometer is used in the implementation of _ differential phase shift qkd ( dps - qkd ) _",
    "@xcite , which generalizes the time - multiplexing scheme by encoding each bit as a phase shift of three superpositioned pulses ( instead of two ) .",
    "another variant which uses interferometer is the _ plug & play _ protocol used in many experiments",
    "@xcite and commercial products  @xcite , in which the signal is generated by bob , sent over to alice who modulates its phase , then sent back to be measured by bob .",
    "in this paper we analyze interferometric based qkd schemes .",
    "specifically , we discuss different ways to implement bb84 using interferometers .",
    "we also discuss implementations of more general schemes , such as the six - state qkd protocol .",
    "once a protocol is implemented via photons and interferometers , the implementation differs from the ideal protocol ( that uses abstract qubits ) since the `` ideal world '' two - dimensional qubit space is replaced with a `` real world '' larger quantum space .",
    "this is due to two reasons : first , interferometers inherently introduce a higher - dimension space ; and second , having pulses with zero photons , or more than one photon , implies a higher dimension as well .",
    "here we focus on the first space enlargement .",
    "the usage of an enlarged quantum space requires a more careful security analysis of such implementations .",
    "since eve controls this large space ( or parts of it ) , rather than the ideal qubit space , she can perform a much stronger attack than on the theoretical protocol . in this paper",
    "we design a novel type of attack , the _ reversed - space attack _ , based on considering this large space .    as proving",
    "the security of a scheme is usually difficult , in this work we consider _ robustness _ , the ability to identify attacks on the protocol .",
    "although robustness is a weaker property than security , showing robustness might be a first step towards a full security analysis .",
    "on the positive side , we show that many of the interferometric implementations are indeed robust ( against a limited adversary ) , which might hint at the security of these implementations . on the other hand ,",
    "we demonstrate a reversed - space attack on several bb84 implementations used in recent experiments  @xcite proving them to be insecure . other realizations ( e.g.  @xcite ) , extend the above variants and use an even larger hilbert space .",
    "the security of such extensions should be analyzed as well , potentially using the tools we present here .",
    "this work joins a line of research that examines the security of qkd implementations .",
    "although bb84 has been proven secure against the most powerful attacks  @xcite , these proofs do not apply to realistic variants , and specific attacks were presented to exploit limitations of specific implementations ( e.g. ,  @xcite ) .",
    "several security analyses have been published for special cases  @xcite : e.g. , a specific protocol variant ( dps - qkd , plug&play , etc . ) , or a specific eavesdropping method .",
    "in addition , recent analyses have considered the security of protocols realized using imperfect equipment , such as faulty sources and detectors  @xcite . still , a general framework that considers such realistic qkd protocols , _ as well as _",
    "attacks on such protocols , is still missing .",
    "we mainly focus on implementations of the bb84 protocol  @xcite . in bb84 alice",
    "uses two conjugate bases ( say , @xmath0 and @xmath1 ) to encode each of her bits as one of the states @xmath2 , @xmath3 , @xmath4 , or @xmath5 .",
    "let @xmath6 be the quantum space alice holds ( here alice is ideal , therefore @xmath7 ) .",
    "the security of the protocol is based on limiting the error - rate measured by bob , under the assumption that when no eavesdropping has occurred , bob should perfectly retrieve the bits encoded by alice .",
    "see more details in , e.g. ,  @xcite .",
    "note that in the theoretical ( ideal ) protocol , alice and bob use the same two - dimensional space @xmath8 .",
    "however , in a non - ideal world , the spaces @xmath6 and @xmath9 , held by alice and bob respectively , might be larger .",
    "an important demonstration of such a case is given in  @xcite , where a realistic photonic source is analyzed , such that the cases of zero photons and two photons are added , and as a result @xmath10 .",
    "surprisingly , when interferometers are used , even in the case where @xmath11 and all the devices are ideal , bob measures six orthogonal states that are correlated to the pulse sent by alice .",
    "if bob actually measures these 6 states , his measured - space becomes much larger than @xmath8 , specifically , @xmath12 .",
    "an eavesdropper can perform various kinds of attacks , however we focus on individual - particle attacks .",
    "the most simple attack eve can compose is a basic _ measure - resend _ attack , in which eve measures the qubit sent by alice and obtains a classical outcome .",
    "then , eve sends bob a different qubit , determined by the classical outcome she measured .",
    "a much stronger individual - particle attack can be done by attaching a separate auxiliary particle ( the ancilla @xmath13 ) to each one of the qubits sent by alice , and performing a unitary transformation @xmath14 on each qubit along with its ancilla , possibly entangling them . to be more accurate , on each qubit sent by alice",
    ", eve performs a unitary transformation @xmath15 where @xmath16 ( and @xmath17 ) are vectors in the computation basis .",
    "eve s ancillas ( denoted as the subsystem @xmath18 ) are kept for a later measurement , performed _ after _",
    "eve learns the basis used for each qubit . for attacking an ideal bb84 scheme , it is sufficient to have a small - dimension ancilla , namely @xmath19 , due to davies theorem  @xcite .",
    "the criterion of _ robustness _ is often used in security analyses of qkd protocols ( e.g. , see robustness analysis of the sarg protocol  @xcite , the bbm protocol  @xcite and the classical - bob protocol  @xcite ) .",
    "we follow the robustness definition of  @xcite to analyze interferometric qkd implementations .",
    "[ def : robust ] a protocol is said to be * completely robust * if nonzero information acquired by eve implies nonzero probability that the legitimate participants find errors on the bits tested by the protocol .",
    "a protocol is said to be * completely nonrobust * if eve can acquire the entire information transmitted in the protocol ( namely , the entire information string ) , without inducing any errors on the bits tested by the protocol .",
    "another closely - related definition is of _ partial robustness _",
    "@xcite : `` a protocol is said to be partly robust if eve can acquire some limited information on the information string without inducing any error on the bits tested by the protocol . ''",
    "partly - robust protocols could still be secure , yet completely nonrobust protocols are automatically proven insecure . as an illustrative example  @xcite , bb84 is fully robust if alice and bob use qubits , but it is not completely robust if instead of ( ideal ) qubits they send pulses , and those pulses sometimes contain more than one photon .",
    "proving robustness of ideal protocols against any attack is easier than proving its security . for complicated protocols and for practical implementations",
    "it is common that robustness is proven first , and the security proof is left for future work .      the focus of this paper is qkd implementations based on single _ photons _ as the quantum carriers . in order to describe a qubit using a single photon",
    ", one needs to define two possible orthogonal states .",
    "these orthogonal states ( called _ modes _ ) are commonly either an intrinsic property ( e.g.   the polarization of the photon , @xmath20 and @xmath21 ) , or a spatial separation ( e.g. , @xmath22 and @xmath23 for different times @xmath24 , @xmath25 ) . a very convenient way to describe photonic qubits is the _ fock space _ notations ( see appendix  [ focknotation ] ) .",
    "although our analysis is done using fock notations , we stick in this extended abstract to the standard notations , and refer the reader to the appendix for full details .    for simplicity ,",
    "we assume throughout the paper that alice s operations are ideal , namely she always succeeds in generating a qubit in the exact desired state . under this assumption , it is easier to see the novelty and importance of the attack that we suggest and analyze here .",
    "we restrict the adversary to sending only pulses with a single photon , a _ single - photon - limited eve _ ( in appendix  [ sec : robust2photon ] , we extend the robustness proof to an adversary which is limited to sending 2 photons ) .",
    "nevertheless , the adversary is capable to receive , hold and manipulate quantum systems of higher dimensions .",
    "moreover , all our robustness proofs are against individual - particle attacks .",
    "finally , we discuss the way losses are treated and differentiated from errors , since it can sometimes influence the robustness ( and security ) analysis , as we now explain .",
    "security proofs ( e.g. ,  @xcite ) determine the maximal error rate ( attributed to eve s attack ) that keeps eve s knowledge negligible .",
    "if bob considers each loss as a random bit obtained from alice , he adds an error with probability half , and thus increases the error - rate . in reality , the loss - rate is too high ( commonly , 90% or even 99% ) for considering each loss as half - an - error , since the resulting error - rate will exceed the threshold , and the protocol will always be aborted . allowing losses without defining a loss - rate threshold",
    "might allow eve to perform useful attacks that result in losses yet no errors , and thus can not be detected  @xcite . in such cases , one might be able to define a loss - rate threshold such that for a high loss - rate the protocol is completely nonrobust , while for a low loss - rate the protocol is partly robust , and might yield a secure final key .",
    "we now adapt the standard security analysis to the case where alice is ideal and bob measures a larger space ( for instance , bob uses interferometer for his measurements ) . as a first step we define the set of eve s attacks on that large space that can not be identified by the legitimate users , that is , attacks that cause no errors .",
    "later we consider the maximal amount of information eve may obtain by performing such an attack .",
    "assume that alice is ideal , and denote the basis states of her system by @xmath26 with @xmath27 .",
    "eve adds an ancilla in the state @xmath13 and performs her attack on the joint system @xmath28 and @xmath18 as described by equation  , using a unitary transformation @xmath14 .",
    "eve continues her attack by sending the subsystem @xmath28 to bob .",
    "however , eve can use an enlarged system ( e.g. by adding photons or modes ) .",
    "eve has incentive to send states beyond the qubit of alice if these influence bob s measurment",
    ". a more general attack can be described as @xmath29 where the subsystem @xmath30 ( rather than @xmath28 ) is sent over to bob , and @xmath31 are basis states of the system @xmath30 .",
    "obviously , @xmath32 is merely a special case , while in the more general case eve might send bob a system with different dimensions than @xmath28 .",
    "the subsystem @xmath33 , which remains in eve s hands to be measured afterwards , can therefore differ from the subsystem @xmath18 she initially had .",
    "moreover , both can be of any dimension as long as the dimension of the entire system does not change , @xmath34",
    ". let a general qubit sent by alice be @xmath35 with @xmath36 , then due to linearity , the attack on that qubit is @xmath37      in order to perform a general measurement , bob might manipulate the state sent by alice . for instance , bob might add an ancillary system @xmath38 , perform some unitary operation on the joint system and then perform a measurement of the joint system @xmath39 .",
    "we model bob s measurement as _",
    "( i ) _ adding the ancilla for all of his setups .",
    "this can always be justified , e.g. , by using a sufficiently large ancilla , such that the different setups potentially use different subsystems of that ancilla . ]",
    "@xmath40 ; _ ( ii ) _ performing a unitary transformation @xmath41 on @xmath42 ; and then _ ( iii ) _ measuring the joint system in the computation basis .",
    "note that @xmath41 changes according to the specific basis used by bob .",
    "for the case of bb84 , where bob uses a separate setup for the @xmath1 and the @xmath0 basis , we get @xmath43 the @xmath44 s are determined by the specific setup used by bob , and the states @xmath45 are bob s basis states in the computation basis , that is , the set of states that span @xmath46 .    as an illustrative example , assume that bob adds no ancilla and his detectors are set to the @xmath0-basis . therefore , for measuring the @xmath0 basis bob performs no transformation ( i.e. @xmath47 , the identity matrix ) , while for measuring the @xmath1-basis he must perform the hadamard transformation @xmath48 , so that @xmath49 and @xmath50 . since bob adds no ancilla , @xmath51 in this case .",
    "using the notations of equation  , we get @xmath52 thus @xmath53 and @xmath54 ; @xmath55 thus @xmath56 and @xmath57 . we can write @xmath44 as a matrix @xmath58 which gives @xmath59 , and in a similar way @xmath60 .",
    "it should be noted that bob s transformation @xmath41 is actually defined on bob s ancilla and the space entering his lab , @xmath61 ( rather than @xmath6 ) .",
    "eve has no incentive to send bob states that can _ never _ affect his measurement and we can assume eve sends exactly @xmath61 to bob ( any other system that can not affect bob is sent back to eve and considered as part of her ancilla  @xmath62 ) . in this case , bob performs a measurement of @xmath63 , rather than of @xmath39 .",
    "while a fully powerful eve knows the protocol space of alice and bob , and their equipment limitations , alice and bob themselves might not be aware of the fact that the system @xmath28 is replaced by the enlarged system @xmath30 .",
    "the above formulas  ( [ eqn : ub ] ) immediately generalize to this case , simply by replacing the subscript @xmath28 by the subscript  @xmath30 .",
    "the general final state @xmath64 ( held by bob and eve ) , can be written as @xmath65    there is a great deal of importance regarding the way bob interprets his measurement outcome .",
    "the states @xmath66 can be classified into sets according to bob s interpretation : some of these states indicate `` alice has sent the bit @xmath67 '' , others indicate `` alice has sent the bit @xmath68 '' .",
    "let us denote these two sets by @xmath69 and @xmath70 , respectively .",
    "an error occurs when alice sends a bit @xmath71 , while bob measures a state in @xmath72 . generally , for a specific transmission , we define by @xmath73 the set of all states that imply an error , so in the example above @xmath74 .",
    "when considering real implementations , there may be some outcomes that are not interpreted as a valid outcome .",
    "these outcomes can be divided into two groups :    1 .",
    "outcomes interpreted by bob as a loss  a failed transmission that is not considered as an error , because they naturally occur even when no eavesdropper interferes ( e.g.   a vacuum state ) .",
    "these outcomes are denoted as the set @xmath75 .",
    "2 .   invalid - erroneous outcomes @xmath76  outcomes that can never occur if the quantum system sent by alice reaches bob intact .",
    "it is bob s choice of interpretation that determines whether a specific outcome is considered a loss or an invalid result .",
    "generally speaking , when an invalid outcome increases the error rate , it is in @xmath76 .    in order to analyze the robustness of qkd protocols , we consider attacks that cause no errors or invalid outcomes at bob s end .",
    "formally , for any @xmath77 in @xmath73 or @xmath76 , we require the overlap @xmath78 to be zero .",
    "using equation  ( [ eqn : finalattackedstate ] ) we see that eve s attack causes no errors if and only if @xmath79 , for any @xmath80 .    [ zeroerrorrequirement ] for a given qkd implementation , eve s attack @xmath81 causes no errors if and only if for every state @xmath82 sent by alice , @xmath83 for any @xmath84 ( corresponding to the specific state @xmath85 ) .",
    "given a specific qkd implementation , the error rate is exclusively determined by the attack @xmath81 performed by eve .",
    "[ def : uzero ] let @xmath86 be the set of attacks on a given protocol , that cause no errors ( in all the possible setups of the protocol ) .    a scheme is robust if @xmath87 only consists of attacks that give eve no information about the key . for bb84 with bases @xmath88 , @xmath87 is determined by the intersection of the zero - error attacks for @xmath0-basis and @xmath1-basis .",
    "one can apply the reversed transformation @xmath89 on each possible @xmath66 , in order to identify the space that influences bob s outcome .",
    "we call an attack , designed according to this observation , a _ reversed - space attack_. the term  reversed \" here is borrowed from the  time reversal symmetry \" of quantum theory . the symmetry of quantum mechanics to the exchange of the prepared ( preselected ) state and the measured ( postselected ) state was suggested by  @xcite ( and was already used in quantum cryptography as well , see the time - reversed epr scheme  @xcite ) . to clarify this point , we stress that in eve s attack described above , our assumption is that eve sends bob a quantum system with space @xmath61 , instead of @xmath6 .",
    "eve has no incentive in sending systems of higher - dimension , thus she can limit @xmath61 to be the space given by the reverse method ( i.e. , the space obtained by considering @xmath90 ) . as a by product",
    ", this simplifies any security analysis , since there is no use in analyzing spaces of larger dimension than the reversed - space .    in the following sections we describe different bb84 implementations that use interferometers , and analyze their robustness via the reverse - space method , against an adversary that is limited to sending pulses with up to one photon .",
    "in this section we analyze a phase - encoded time - multiplexed qkd implementation  @xcite , and show it is robust against a limited adversary .      consider a bb84 implementation which uses two time - separated modes ( pulses ) . for every transmission , the first mode arrives to bob s lab at time @xmath91 , and the second mode at @xmath92 .",
    "we denote these pulses as @xmath93 and @xmath94 respectively .",
    "the users use the @xmath1 and @xmath95 bases , so that an ideal alice sends one of the following four states , @xmath96    bob measures the qubit using a mach - zender interferometer , which is a device composed of two beam splitters ( bs ) with one short path , one long path , and a controlled phase shifter @xmath97 , that is placed at the long arm of the interferometer .",
    "( see appendix  [ sec : interferometer ] for a full description of an interferometer , and analysis of its operation on single - photon modes ) . the length difference between the two arms",
    "is determined by @xmath98 : when the first pulse travels through the long arm , and the second through the short arm , they arrive together at the output .",
    "due to that exact timing of the pulses , each incoming qubit is transformed into a superposition of 6 possible modes : 3 time modes ( @xmath24 , @xmath25 , @xmath99 ) at the straight ( @xmath100 ) output arm of the interferometer , and 3 modes at the down ( @xmath101 ) output arm ; see figure  [ fig : lab - xy ] .",
    "( 9,0 ) ; ( 2,0 )  ( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ;    at ( phase ) [ label = above:(d ) ] @xmath102 ; at ( @xmath103 ) ( c ) ; at ( @xmath104 ) ( c ) ;    at ( 9.75,0 ) @xmath100 arm ; at ( 6,-3.25 ) @xmath101 arm ; at ( 8,-1 ) ( e ) ;    ( 0,-0.25 ) node[auto , left](a )  ( 0.5,-0.25 ) ; ( 1.75,-2 ) node[auto , below ] ( b)(1.75,-1.5 ) ;     ( 0,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 1,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6.25,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 7.25,0 ) sin + ( 0.08,0.2 * 0.75 ) cos + ( 0.08,-0.2 * 0.75 ) sin + ( 0.15 , 0.75 ) cos + ( 0.15,-0.75 ) sin + ( 0.08,0.2 * 0.75 ) cos + ( 0.08,-0.2 * 0.75 ) ; ( 8.25,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6.25,-1 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6.25,-2 ) sin + ( 0.08,0.2 * 0.75 ) cos + ( 0.08,-0.2 * 0.75 ) sin + ( 0.15 , 0.75 ) cos + ( 0.15,-0.75 ) sin + ( 0.08,0.2 * 0.75 ) cos + ( 0.08,-0.2 * 0.75 ) ; ( 6.25,-2.9 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    at ( 0.35,0.8 ) @xmath105 ; at ( 1.35,0.8 ) @xmath106 ;    at ( 6.6,0.8 ) @xmath99 ; at ( 8.6,0.8 ) @xmath24 ; at ( 7.6,1 ) @xmath25 ;    at ( 7,-0.75 ) @xmath99 ; at ( 7,-2.5 ) @xmath24 ; at ( 7,-1.7 ) @xmath25 ;    for the sake of simplicity we denote these modes as @xmath107 , and since we only consider pulses with zero or one photons , we can use the states , @xmath108 , @xmath109 , etc . , a basis state in bob s space is given given by @xmath110 , and we define @xmath111 ; @xmath112 ; @xmath113 ; @xmath114 ; @xmath115 ; @xmath116 , and the vacuum state @xmath117 . ] , along with the vacuum state @xmath118 ( a pulse that contains no photons ) .",
    "the intereferometer s operation ( see equation  ) is defined by @xmath119 and @xmath120 bob sets the phase @xmath102 according to the basis he wishes to measure : @xmath121 for the @xmath1-basis and @xmath122 for the @xmath95-basis .",
    "when alice s and bob s bases match , the input qubit evolves in the interferometer as @xmath123 bob opens his detectors at time @xmath25 at both the arms .",
    "a click at the `` down '' direction ( i.e. , measuring the state @xmath124 ) means the bit - value @xmath67 , while a click at the `` straight '' direction ( @xmath125 ) means @xmath68 .",
    "the other modes are commonly considered as a loss ( namely , they are not measured ) since they do not reveal the value of the original qubit .",
    "the above implementation is commonly used for qkd experiments  @xcite , and products  @xcite .",
    "we denote this implementation scheme by .    since measuring the other modes ( @xmath126 , etc .",
    ") does not reveal the bit alice has sent , measuring these modes can only help bob in noticing some eavesdropping attacks . on the other hand ,",
    "considering these modes complicates the security analysis since eve might send superpositions of the time - modes @xmath127 , and @xmath128 , which will not result in @xmath118 .",
    "we now prove the implementation to be completely robust against a single - photon limited eve .",
    "we begin by defining the set @xmath86 of attacks that induce no errors , according to definition  [ def : uzero ] .",
    "since we limit the parties to single - photon pulses , we only need to consider the sub - space that contains the vacuum state and the single - photon states , i.e. , the states @xmath118 , @xmath126 , @xmath125 , @xmath129 , @xmath109 , @xmath124 and @xmath130 defined above .",
    "the analysis must consider the space bob actually measures , @xmath9 , and the states ( sent by alice or eve ) that , after the interferometer , have a non - zero overlap with the modes measured by bob .",
    "this idea is what differentiates our analysis from previous methods of analyzing ( theoretical ) protocols .    in ,",
    "bob only measures time - bin @xmath25 , thus we are interested in the subspace spanned by @xmath131 , @xmath125 , @xmath132 . by applying @xmath133 on these three states , we get the states sent by eve that influence bob . following section  [ sec : zeconditions ] we refer to such an attack as the _ reversed - space attack _ on this specific scheme .    assuming a single - photon - limited adversary",
    ", the scheme is completely robust    we describe the measurement bob performs , for both bases , as @xmath134 ; @xmath135 ; @xmath136 ; and @xmath137 , where the set @xmath138 represents the computation basis of the space measured by bob , and the minus stands for set difference .",
    "eve might send the photon at any desired time - bin , or not send a photon at all .",
    "however , the photon will affect bob only in the case it is sent at time - bins @xmath106 or @xmath105 .",
    "thus , eve has no advantage in attacking a larger space than the one used by alice , and @xmath61 is spanned by @xmath139 .",
    "note that if we ignore the vacuum state , which can not be sent by an ideal alice , then @xmath140 .",
    "we use corollary  [ zeroerrorrequirement ] to define attacks that cause no errors at all . for this specific implementation",
    ", @xmath86 consists of the attacks that satisfy equation   in four cases , matching the four bb84 states sent by alice .",
    "bob s setup ( i.e.  the constants @xmath141 ) is determined by the basis he measures ; we denote the @xmath44 s imposed by the @xmath1-setup ( @xmath121 ) as @xmath142 , and the ones imposed by the @xmath95-setup @xmath143 by @xmath144 , and write @xmath44 in a matrix form .",
    "it is immediate from the operation of the interferometer equation   that , in section  [ sec : interf - xz ] below we discuss @xmath145 .",
    "thus we describe here @xmath44 s elements for this entire set ( omitting the vacuum state , since in any possible setup , @xmath146 ) . ]",
    "@xmath147{l } \\scriptstyle k=\\{t'_{-1},t'_0,t'_1,t'_2\\ } , \\\\[-3pt ] \\scriptstyle j=\\ { s_0 , s_1 , s_2 , d_0 , d_1,d_2\\}\\end{array } } \\!\\!\\!\\!\\!\\!= \\frac{1}{2}\\left (      \\begin{array}{cccccc }   -1   &   0    &   0   & i    &   0   &   0 \\\\   1    &   -1   &   0   & i    &   i   &   0 \\\\   0    &   1   &   -1   &   0   &   i   &   i \\\\   0    &   0   &    1   &   0   &   0   &   i      \\end{array }",
    "\\right ) ,   \\ ; \\ ; \\ ; \\beta^{y}_{\\begin{array}[t]{l } \\scriptstyle k=\\{t'_{-1},t'_0,t'_1,t'_2\\ } , \\\\[-3pt ] \\scriptstyle j=\\ { s_0 , s_1 , s_2 , d_0 , d_1,d_2\\}\\end{array } } \\!\\!\\!\\!\\!\\!= \\frac{1}{2}\\left (      \\begin{array}{cccccc }   -i   &   0   &    0   &   -1 &    0 &   0    \\\\   1    &   -i   &   0   & i    &   -1   &   0   \\\\   0    &   1   &   -i   &   0   &   i   &   -1   \\\\",
    "0    &   0   &    1   &   0   &   0   &    i      \\end{array } \\right ) .\\ ] ]    consider the case where alice sends @xmath148 , namely , @xmath149 .",
    "an error occurs if bob measures @xmath125 , @xmath150 , and by equation  , the attack causes no error if @xmath151 and when alice sends @xmath152 , @xmath153 which implies @xmath154 the same is repeated for the @xmath95-basis and we get the solution @xmath155 it follows that eve s attack must be of the form @xmath156 where @xmath157 is the probability that eve sends a qubit to bob rather than blocking it . for @xmath158",
    "this is the _ blocking _ attack and for @xmath159 it is the _ identity _ attack where eve transmits the qubit to bob intact . for these attacks ,",
    "either eve gets full information about alice s state , or bob does . in both cases , eve has no information about the bits used for the key , and the specific implementation is _ completely robust _ according to definition  [ def : robust ] .    in appedix",
    "[ sec : robust2photon ] we generalize this result and prove robustness against a more realistic , yet limited , adversary restricted to pulses with at most two photons .",
    "unfortunately , our method is not scalable to the general case .",
    "let us now extend the analysis to implementations that use the @xmath0-basis .",
    "this might be required , for instance , in order to implement the 6-state qkd protocol  @xcite , in which alice sends a qubit using the @xmath1 , @xmath95 and @xmath0 bases at random ; or in order to perform `` qkd with classical bob ''  @xcite in which one party is restricted to use only the ( classical ) @xmath0-basis , and either performs measurements in that basis or returns the qubits ( unchanged ) to the other party .",
    "we now describe a setup that bob can employ in order to measure the @xmath0-basis , e.g.   the states @xmath160 and @xmath161 . the implementation is rather straightforward  bob measures the pulses after the appropriate delay @xmath162 , so that the measurement of @xmath2 ( @xmath3 ) is done by opening a detector at time  @xmath24  ( @xmath25 ) ; see figure  [ fig : lab - z ] .",
    "the respective transformation @xmath163 is the identity operator @xmath164 where the other modes are not measured by bob , and are not relevant for this scheme .",
    "we use the mode @xmath124 instead of the more intuitive @xmath126 in order to be consistent with the modes representing the bit values @xmath67 and @xmath68 when the @xmath1 ( or @xmath95 ) setup is used is reflected to the @xmath101 arm . ] .     basis . ]",
    "we denote the bb84 protocol that uses @xmath1 and @xmath0 bases by alternating the setups ( adding and removing beam - splitters as needed ) , as . in the same manner , a six - state protocol implemented by alternating the above setups ( e.g. ,  @xcite ) is denoted as scheme .",
    "it is rather straightforward to extend the proof given in section  [ sec : robustxy ] to the scheme .",
    "define , for the @xmath0-basis setup , @xmath134 , @xmath135 and @xmath165 .",
    "the appropriate @xmath141 , following equation  , are given by @xmath166 it follows immediately from equation   that any attack that causes no errors must satisfy @xmath167 the set @xmath86 includes attacks that satisfy the above requirement as well as the @xmath1-basis requirement . as before ,",
    "the requirements yield the solution  , and the scheme is robust under our assumptions .",
    "it is easy to verify that the same result holds when using the @xmath95-basis instead of the @xmath1-basis .",
    "this proves the robustness of the scheme . combining this result with the result of the previous subsection",
    "immediately yields that the scheme is robust as well , under the same assumptions .    assuming a single - photon - limited adversary , the scheme is completely robust",
    "the implementation suffers from one main caveat : the need of a mechanical operation after each qubit - transmission , as the basis must be chosen at random .",
    "such an operation might take a lot of time and substantially decrease the maximal bit - rate allowed in the protocol .",
    "other implementations do not involve mechanical operation but use a beam - splitter to split the channel such that each output reaches a different setup ( see for instance  @xcite ) .",
    "these kinds of implementations suffer from a higher loss - rate and a lower bit - rate .",
    "let us describe a bb84 protocol that uses the @xmath0 and @xmath1 bases , in which bob s interferometric setup is fixed and independent of the basis used  @xcite .",
    "the idea is to use the setup @xmath168 for measuring both bases in the following manner . in order to perform a measurement in the @xmath1  basis",
    ", bob opens his two detectors at time - bin @xmath25 , so that he measures the states @xmath125 and @xmath124 .",
    "in addition , for measuring the @xmath0  basis , bob measures @xmath169 that implies the bit - value ` 0 ' and @xmath170 that implies ` 1 ' , ( see equations   and  ) .",
    "we denote this scheme as .",
    "bob measures different time - bins than @xmath25 , namely times @xmath24 and @xmath99 , and the set @xmath138 becomes @xmath171 , @xmath109 , @xmath124 , @xmath130 , @xmath126 , @xmath125 , @xmath172 .",
    "in contrast to previous schemes , in this scheme the input modes @xmath173 and @xmath174 might have a non - zero overlap with the modes measured by bob .",
    "the reverse - space - attack implies that the input space @xmath61 is much larger than @xmath6 : a state sent by eve is a superposition of modes @xmath173 to  @xmath175 .",
    "the scheme is completely nonrobust    let us repeat the above analysis for the scheme . for the non - robustness proof , it suffices to restrict eve ( as well as any natural noise ) to single photon pulses .",
    "the requirements for the @xmath1-basis remain as given in section  [ sec : robustxy ] ( equations   ) .",
    "in addition , when bob measures the @xmath0 basis , he interprets his outcome according to @xmath176 , @xmath177 , @xmath178 ( due to the single - photon assumption ) , and @xmath179 .",
    "the setup is joined for both the @xmath0 and the @xmath1 bases , @xmath180 , whose value is given in equation  .    following corollary  [ zeroerrorrequirement ] , an attack @xmath81 causes no errors if it satisfies @xmath181 corresponding to the case where alice sends @xmath2 , i.e.  @xmath182 , @xmath183 , and @xmath184 , as well as @xmath185 corresponding to the case where alice sends @xmath3 , i.e.  @xmath186 , @xmath187 , and @xmath188 .",
    "this leads to the constraints @xmath189 and @xmath190 .",
    "along with the requirements for the @xmath1-basis the only possible attacks are of the form @xmath191 with @xmath192 . using this result , it is easy to devise an attack and show the protocol is completely non - robust .",
    "for instance , let @xmath193 with orthogonal @xmath194 , @xmath195 .",
    "this attack never causes an error , yet it increases the loss rate  bob always gets a loss when using the @xmath1  basis .",
    "this means that only bits encoded using the @xmath0  basis are used for transferring information , and eve can copy the information .",
    "it follows that the is _ completely nonrobust _ according to definition  [ def : robust ] .",
    "( this specific attack is somewhat related to the `` fake state '' attack of  @xcite ) .",
    "as mentioned , in the above attack all the qubits passed by eve are in the @xmath0-basis ( i.e. , the loss - rate bob sees for the @xmath1-basis is 1 ) .",
    "we can compose an attack that does nt have such a property ( for instance , by letting @xmath196 ) , in which eve does not force a loss in the @xmath1-basis , yet she does not learn the information for that basis .",
    "finally , note that the above attack also applies to the unified six - state qkd scheme ( see  @xcite , for instance ) , making such realizations totally insecure .",
    "going beyond the schemes presented here is left for future research .",
    "we study robustness of common qkd implementations by formulating the conditions that make a specific attack undetectable . assuming a single - photon restricted adversary , we show that several of the implementations in use are robust ,",
    "while others are completely nonrobust ( and thus insecure ) : the adversary is capable of learning all of the information about the final key without causing any errors at the legitimate user s end .",
    "the security flaw emerges from the way the devices are used , rather than their imperfections or insecurity of the underlying bb84 ( or six - state ) protocol . a complete security proof of the implementations we prove robust is still missing .",
    "another question we leave open is whether the above robustness proof can be extended to the case of an unlimited adversary .",
    "we conclude that a security analysis of a qkd realization must be done according to the specific equipment in use .",
    "a security proof of a theoretical protocol is relevant only when the setup considered is proven to realize the theoretical protocol in an exact manner . yet",
    ", any realization deviates from the theoretical one , and this should be considered by the security analysis .",
    "a general framework for all possible deviations is still missing ( see discussion in a preliminary version of this paper  @xcite ) .",
    "this conclusion is crucial when considering off - the - shelf products , claiming to bring qkd with proven security .",
    "the authors would like to thank michel boyer for many useful suggestions .",
    "we also wish to thank akshay wadia , alan roytman and niek bouman for miscellaneous comments .",
    "59ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1103/physreva.53.2038 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.56.1163 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1007/s00453 - 002 - 0973 - 6 [ * * ,   ( ) ] @noop `` , ''   ( ) ,   @noop * * ,   ( ) @noop ( ) link:\\doibase 10.1103/physrevlett.68.3121 [ * * ,   ( ) ] @noop * * ,   ( ) in @noop _ _  ( , )  pp .",
    "link:\\doibase 10.1063/1.1738173 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.89.037902 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1063/1.118224 [ * * ,   ( ) ] @noop * * ,   ( ) http://www.idquantique.com/ ,  @noop http://www.magiqtech.com/ ,  @noop \\doibase    10.1049/el:20010508 [ * * ,   ( ) ] @noop `` , ''   ( ) link:\\doibase 10.1143/jjap.43.l1109 [ * * , ( ) ] link:\\doibase    10.1109/jstqe.2006.876175 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.91.087901 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2158719 [ * * ,   ( ) ] \\doibase doi :    10.1016/j.physleta.2006.06.080 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.85.441 [ * * ,   ( ) ] \\doibase http://doi.acm.org/10.1145/382780.382781 [ * * ,   ( ) ] _ _ ,  @noop ph.d .",
    "thesis ,  , ( ) ,   in  @noop _ _  ( ,  )  pp .",
    "link:\\doibase 10.1103/physrevlett.85.1330 [ * * , ( ) ] link:\\doibase 10.1103/physreva.61.052304 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.73.012344 [ * * ,   ( ) ] in  @noop _ _",
    "( ,  ,  )  p.   @noop * * ,   ( ) link:\\doibase 10.1140/epjd / e2007 - 00010 - 4 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.92.057901 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.68.557 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.99.140501 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrev.134.b1410 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.41.11 [ * * , ( ) ] link:\\doibase 10.1103/physreva.54.2651 [ * * ,   ( ) ] link:\\doibase    10.1103/revmodphys.74.145 [ * * ,   ( ) ] in \\doibase http://doi.acm.org/10.1145/863955.863982[__ ] ( ,  , )  pp .   in \\doibase doi : 10.1016/s0079 - 6638(06)49005 - 3 [ _ _ ] ,  vol .  ,  ( ,  )  pp .",
    "link:\\doibase 10.1103/physrevlett.81.3018 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.79.032341 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.79.052312 [ * * ,   ( ) ] link:\\doibase 10.1364/ol.30.001533 [ * * , ( ) ] @noop `` , ''   ( ) ,   link:\\doibase 10.1103/physrevlett.73.58 [ * * , ( ) ] @noop _ _  ( ,  ) link:\\doibase 10.1103/physreva.59.3295 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/revmodphys.79.135 [ * * ,   ( ) ] link:\\doibase 10.1063/1.123404 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1140/epjd / e2003 - 00287 - 1 [ * * , ( ) ]",
    "the fock - space ( fs ) notation is the best way to describe a quantum system where the `` players '' are indistinguishable particles such as photons , using the occupancy number basis .",
    "the fock - state @xmath197 represents @xmath198 particles in a given mode to indicate use of the occupancy number basis .",
    "] , for instance , the number of photons in a certain electromagnetic pulse that have the same horizontal polarization @xmath21 .",
    "when needed , a subscript is added to the fock - state in order to identify the specific mode , e.g.   @xmath199 or @xmath200 .",
    "when more than one mode is considered , we write the joint state @xmath201 to indicate @xmath202 photons in the @xmath16th mode . using this notation ,",
    "a description of a general single - photon qubit , @xmath203 , is based on using two modes ( say two orthogonal polarizations ) @xmath204 and @xmath205 .",
    "for instance , the states @xmath206 and @xmath207 commonly represent the two diagonal polarizations .",
    "unfortunately , in real life alice is unable to send perfect qubits ; due to the specific device used , alice often sends the vacuum state @xmath208 , and also sometimes sends more than a single photon ( i.e. , the states @xmath209 and @xmath210 ) . to be more precise , she actually sends the 2-mode multi - photon state @xmath211 , containing also terms with more than two photons .",
    "such terms usually have a negligible probability , and it is sufficient to analyze the 6-dimensional hilbert space of zero , one and two photons .",
    "alice might also ( unintentionally ) send more modes than she intended to .",
    "thus , the most general state alice could send is a @xmath212-mode multi - photon state @xmath213 .",
    "sending more than two modes could also have a negative effect on the security of the protocol .",
    "bob s ideal measurement of the fock - state @xmath197 is commonly assumed to be limited to a complete measurement that yields the number of photons occupying the mode , i.e.  the number @xmath198 .",
    "this can be extended to an ideal measurement of the @xmath212-mode fock - state @xmath214 which yields the numbers @xmath215 to @xmath216 . in appendix",
    "[ sec : realmes ] , we discuss more realistic measurements of a multi - photon state .    in addition , bob can measure other specific properties of the state using ( for instance ) beam splitters , phase shifters and mirrors  @xcite .",
    "for example , let us assume that bob wants to distinguish the state @xmath217 from @xmath218 , where the different modes are different paths of the photon .",
    "bob can perform a phase shift of @xmath219 on the path represented by the first mode , and then place a symmetric beam splitter to obtain @xmath220 or @xmath221 respectively at the outputs of the beam splitter ( up to a general phase ) .",
    "these two states can be distinguished by a simple measurement as described above .",
    "an interferometer  ( figure  [ fig : lab - xy ] ) is a device composed of two beam splitters ( bs ) with one short path , one long path , and a controlled phase shifter @xmath97 , that is placed at the long arm of the interferometer .",
    "we focus on the following case which is used for measuring differential phase - shift qkd .    in each transmission ,",
    "a superposition of two ( time ) modes enter the interferometer and result in a superposition of 6 modes ( figure  [ fig : lab - xy ] ) .",
    "the input modes are separated with a time difference of @xmath98 seconds , that is , the first mode arrives at time @xmath91 , and the second at @xmath92 .",
    "the first pulse travels through the short arm in @xmath222 seconds , and through the long arm in @xmath223 seconds , where the time difference between the two arms is exactly the time difference @xmath98 between the two incoming modes . due to traveling through both arms ,",
    "the first mode yields outgoing pulses both at time @xmath224 and at @xmath225 .",
    "when the second pulse enters the interferometer , it also travels through both arms .",
    "intuitively , the part of the @xmath105 mode that travels through the short arm interferes with the part of the @xmath106 mode that travels through the long arm , and the output exits the interferometer at @xmath25 .",
    "the part of the second pulse that travels through the long arm exits the interferometer at time @xmath226 . as a result",
    ", we can actually see six pulses at the two output arms , three in each direction , with the two middle pulses determined by the interference between the two pulses arriving into bob s lab .",
    "we shall now write this formally .",
    "each one of the beam splitters has two input arms ( modes 1 , 2 ) and two output arms ( modes 3 , 4 ) , see figure  [ fig : bs ] .",
    "each entering photon is transmitted ( or reflected ) with probability @xmath227 ; the transmitted part keeps the same phase as the incoming photon , while the reflected part gets an extra phase of @xmath228 .",
    "specifically , @xmath229 and @xmath230 .",
    "thus , for a single photon state , the transformation is of the form @xmath231    it is important to note that when a single mode ( carrying a single photon ) enters a beam splitter from one arm , and nothing ( namely , vacuum ) enters the other arm ( say , @xmath232 ) , there are still _ two _ output modes .",
    "this means that the other ( vacuum ) entry must be considered as an additional mode  an ancilla carrying no photons .",
    "( 0,-2.5 ) node[right ] ( 2 ) ",
    "( 0,2.5 ) node[right ] ( 4 ) ; ( -2.5,0 ) node[above ] ( 1 ) ",
    "( 2.5,0 ) node[above ] ( 3 ) ; ( -1,-0.125 ) rectangle ( 1,0.125 ) ;      the controlled phase shifter @xmath97 performs a phase shift on the input state by a given phase @xmath102 , i.e.  @xmath233 , see  @xcite .",
    "the users can change the phase according to the specific basis in use .",
    "clearly , the transformation changes only the mode which travels through the phase shifter ( on the long arm ) , while the other modes do not change .      when a single mode , carrying one or more photons , enters the interferometer , three ancillas in a vacuum state",
    "are added by the interferometric setup ( see figure  [ fig:1evo ] ) . as mentioned above ,",
    "the mode entering the interferometer at time @xmath106 , yields two modes at time @xmath24 , and two modes at time @xmath25 .",
    "these four output modes are : times @xmath24 , @xmath25 at the ` s ' ( straight ) arm of the interferometer , and times @xmath24 , @xmath25 at the ` d ' ( down ) arm of the interferometer .",
    "a basis state of this fock - space can be written as @xmath234 .",
    "m0.35 m0.62     ( 0,0 )  ( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 )  ( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ; ( 1,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;     ( 2,-1 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    ; at ( 1.35,0.9 ) ( 1 ) ; at ( 3.1,-0.75 ) ( 1 ) ;    & pulse ( 1 ) is about to enter the interferometer .",
    "a vacuum ancilla ( 1 ) is added at the input of the first beam splitter , @xmath235 .",
    "m0.35 m0.62     ( 0,0 ) ",
    "( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ; ( 2.75,1.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 5,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;     ( 6,0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    ; at ( 3.1,2.5 ) ( 3 ) ; at ( 5.35,0.9 ) ( 2 ) ; at ( 6.35,1.4 ) ( 2 ) ;    & pulses ( 1 ) and ( 1 ) interfere in the first beam splitter ( @xmath235 ) and yield a superposition of ( 2 ) and ( 3 ) in the short and long arms of the interferometer , respectively , @xmath236 .",
    "pulse ( 2 ) is about to enter the second beam splitter ( @xmath237 ) so a vacuum ancilla is added ( 2 ) .",
    "m0.35 m0.62     ( 0,0 ) ",
    "( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ;     ( 5,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    ; ( 6,0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6,-2 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 7.3,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 5.35,0.9 ) ( 3 ) ; at ( 6.35,1.4 ) ( 3 ) ; at ( 6.35,-1.1 ) ( 4 ) ; at ( 7.65,0.9 ) ( 5 ) ;    & pulses ( 4 ) and ( 5 ) are created by pulses ( 2 ) and ( 2 ) , @xmath238 . pulse ( 3 )",
    "is about to enter the second beam - splitter so a vacuum ancilla is added ( 3 ) .",
    "m0.35 m0.62     ( 0,0 ) ",
    "( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ; ( 6,-2 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 8.3,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6,-3 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 7,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 7.35,0.9 ) ( 7 ) ; at ( 7,-2.7 ) ( 4 ) ; at ( 6.35,-1.1 ) ( 6 ) ; at ( 8.65,0.9 ) ( 5 ) ;    & pulses ( 6 ) and ( 7 ) are created by the interference of ( 3 ) and ( 3 ) . @xmath239 .",
    "assume that a single photon enters the interferometer at time @xmath106 . using the above notations , the interferometer s transformation is given by @xmath240",
    "note the three vacuum ancillas that were added .",
    "also note that a pulse which is sent at a different time ( say , @xmath105 , or @xmath173 , etc . ) results in the same output state , with appropriate delays .",
    "that is , a pulse entering the interferometer at time @xmath241 results in the state @xmath242 in a fock - space with basis states @xmath243 .",
    "we are now ready to consider the setup of figure  [ fig : lab - xy ] and two input modes , @xmath106 and @xmath105 , that enter the interferometer one after the other , with exactly the same time difference @xmath98 as the interferometer s arms . as a result of this precise timing",
    ", the two modes are transformed into a superposition of only six modes ( instead of eight modes ) at the outputs ( see figure  [ fig:2evo ] ) .",
    "four ( vacuum state ) ancillas are added during the process and the resulting six modes are @xmath24 , @xmath25 , @xmath99 at the ` s ' arm and the ` d ' arm of the interferometer .",
    "a basis state of this fock - space is therefore @xmath110 .",
    "if exactly one photon enters the interferometer , we can use equation   to obtain @xmath244 recall that @xmath245 and @xmath246 .",
    "it follows that an arbitrary qubit is transformed as @xmath247    m0.35 m0.62     ( 0,0 )  ( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ; ( 1,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;     ( 2,-1 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    ; ( 0,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 1.35,0.9 ) ( 1 ) ; at ( 3.1,-0.75 ) ( 1 ) ; at ( 0.35,0.9 ) ( 2 ) ;    & a general single - photon qubit , @xmath248 , enters the interferometer ( modes ( 2 ) and ( 1 ) ) .",
    "bob adds a vacuum ancilla ( 1 ) that interferes with mode ( 1 ) at the first beam splitter ( @xmath235 ) .",
    "m0.35 m0.62     ( 0,0 ) ",
    "( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ; ( 1,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;     ( 2,-1 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    ; at ( 1.35,0.9 ) ( 2 ) ; at ( 3.1,-0.75 ) ( 2 ) ; ( 2.75,1.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 5,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;     ( 6,0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    ; at ( 3.1,2.4 ) ( 4 ) ; at ( 5.35,0.9 ) ( 3 ) ; at ( 6.35,1.4 ) ( 3 ) ;    & pulses ( 1 ) and ( 1 ) interfere and yield pulses ( 3 ) and ( 4 ) in the short arm and the long arm respectively , @xmath249 . pulse ( 3 ) is about to enter @xmath237 , so a vacuum ancilla ( 3 ) is added .",
    "pulse ( 2 ) is about to enter @xmath235 so a vacuum ancilla ( 2 ) is added .",
    "m0.35 m0.62     ( 0,0 ) ",
    "( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ; ( 2.75,1.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 5,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6,0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 3.1,2.4 ) ( 6 ) ; at ( 5.35,0.9 ) ( 5 ) ; at ( 6.35,1.4 ) ( 4 ) ; ( 6,-2 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 7.3,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 6.35,-1.1 ) ( 7 ) ; at ( 7.65,0.9 ) ( 8) ;    & pulses ( 7 ) and ( 8) are created by the interference of ( 3 ) and ( 3 ) @xmath250 . pulses ( 5 ) and ( 6 )",
    "are created by the interference of ( 2 ) and ( 2 ) in @xmath235 @xmath251 .",
    "m0.35 m0.62     ( 0,0 ) ",
    "( 9,0 ) ; ( 2,0 )  ( 2,1.35 )  ( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ;     ( 5,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ;    ; ( 6,0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 5.35,0.9 ) ( 6 ) ; at ( 6.35,1.4 ) ( 6 ) ; ( 6,-2 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 8.3,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6,-3 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 7,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 7.35,0.9 ) ( 10 ) ; at ( 7,-2.7 ) ( 7 ) ; at ( 7,-1.7 ) ( 9 ) ; at ( 8.65,0.9 ) ( 8) ;    & pulses ( 9 ) and ( 10 ) are created by the interference of ( 4 ) and ( 5 ) in the second beam - splitter @xmath252 . pulse ( 6 ) is about to enter @xmath237 so a vacuum ancilla is added ( 6 ) .",
    "m0.35 m0.62     ( 0,0 ) ",
    "( 9,0 ) ; ( 2,0 ) ",
    "( 2,1.35 ) ",
    "( 6,1.35 ) ",
    "( 6,0 ) ; ( 2,0 ) ",
    "( 2,-2 ) ; ( 6,0 ) ",
    "( 6,-3 ) ; ( 1.75,-0.25 )  node ( bs1 ) ( 2.25,0.25 ) ( 5.75,0.25) node ( bs2 ) ( 6.25,-0.25 ) ; ( phase ) at ( 4,1.35 ) [ circle , fill = black!40,draw = black , thick ] ; ; ( 6,-1 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6.5,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 6.8,0.9 ) ( 12 ) ; at ( 7,-0.7 ) ( 11 ) ; ( 6,-2 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 8.3,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 6,-3 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; ( 7.4,0 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) sin + ( 0.15 , 0.5 ) cos + ( 0.15,-0.5 ) sin + ( 0.08,0.2 * 0.5 ) cos + ( 0.08,-0.2 * 0.5 ) ; at ( 7.7,0.9 ) ( 10 ) ; at ( 7,-2.7 ) ( 7 ) ; at ( 7,-1.7 ) ( 9 ) ; at ( 8.6,0.9 ) ( 8) ;    & pulses ( 11 ) and ( 12 ) are created by the interference of ( 6 ) and ( 6 ) in @xmath237 @xmath253 .",
    "in this section we prove that the scheme is robust against an adversary that can send pulses with up to 2 photons .",
    "although we believe that the protocol is robust against an unlimited eve our proof is not scalable to the general case .",
    "recall that a general ( ideal ) measurement of the @xmath212-mode fock - state @xmath214 yields the numbers @xmath215 to @xmath216 . however , we assume that bob uses imperfect devices which might restrict him to perform only limited measurement  @xcite .",
    "a realistic bob performs an incomplete measurement , in which some modes might not be measured , and some modes he can not detect the exact number of photons .",
    "for instance , bob might measure a mode @xmath16 using a threshold detector and only determine whether the mode is empty or non - empty ( i.e. , whether or not the number of received photons equals @xmath67 ) , described as the projection @xmath254 , where @xmath255 for @xmath256 .",
    "a better measurement could ( theoretically ) allow him to distinguish the exact number of photons populating the mode ; this is done using a device named _ a counter _ , also known as a _ photon - number - resolving _",
    "detector  @xcite .    in the following ,",
    "we consider the case in which bob s detectors can not distinguish between detecting a single photon or more .",
    "we stress that our robustness proof holds even for the limited ( realistic ) bob described above , and not only for an ideal bob .",
    "[ prop : twophotonsinterference ] if the time modes @xmath91 and @xmath257 contain exactly @xmath258 photons , the pulse evolves in the interferometer in the following manner : @xmath259 \\end{split } \\\\",
    "\\begin{split } u_\\text{it}{| { 11 } \\rangle^{\\!\\text{\\tiny f}}}_{t'_0t'_1}= \\frac{1}{4}\\bigl [    & { | { 110000 } \\rangle^{\\!\\text{\\tiny f } } } + i{| { 100010 } \\rangle^{\\!\\text{\\tiny f } } } + i{| { 010100 } \\rangle^{\\!\\text{\\tiny f } } } - { | { 000110 } \\rangle^{\\!\\text{\\tiny f } } }   \\\\    & + e^{i\\phi } \\bigl ( -\\sqrt{2}{| { 020000 } \\rangle^{\\!\\text{\\tiny f } } } -\\sqrt{2}{| { 000020 } \\rangle^{\\!\\text{\\tiny f } } }       - { | { 101000 } \\rangle^{\\!\\text{\\tiny f}}}\\\\    & \\phantom{+e^{i\\phi } ( }       + i{| { 100001 } \\rangle^{\\!\\text{\\tiny f } } }   -i { | { 001100 } \\rangle^{\\!\\text{\\tiny f } } } - { | { 000101 } \\rangle^{\\!\\text{\\tiny f } } }   \\bigr ) \\\\    & + e^{i\\cdot 2\\phi } \\bigl (      { | { 011000 } \\rangle^{\\!\\text{\\tiny f } } } -i{| { 010001 } \\rangle^{\\!\\text{\\tiny f } } } -i { | { 001010 } \\rangle^{\\!\\text{\\tiny f } } } - { | { 000011 } \\rangle^{\\!\\text{\\tiny f } } } \\bigr )   \\bigr ] \\end{split}\\end{aligned}\\ ] ] with basis @xmath110 .",
    "note that @xmath260 is immediate from @xmath261 .",
    "consider the evolution of a pulse with @xmath258 photons through a beam - splitter  @xcite @xmath262 composing the two beam - splitters and phase shift , with the appropriate delays immediately leads to the above result .        1 .",
    "there are 0 photons in modes @xmath106 and @xmath105 : for instance , eve sends the state @xmath263 or @xmath264 .",
    "these kinds of states always cause a loss since they never reach bob s detectors at time @xmath25 .",
    "eve can send a superposition of any such states , and bob will not be able to distinguish them from the case that eve sends @xmath118 .",
    "such states are in @xmath75 and do not affect the error rate .",
    "2 .   there is a single photon in modes @xmath106 and @xmath105 : for instance , eve sends @xmath265 .",
    "this case is not the same as sending a single photon , but since only one photon can be measured at time @xmath25 , we can consider this case as giving eve the second photon , instead of sending it to bob .",
    "thus , we can use the robust proof for a single photon of section  [ sec : robustxy ] to deal with this case as well .",
    "3 .   both photons are in modes @xmath106 and @xmath105 : assume eve sends bob a 2-photon state of the form @xmath266 .",
    "we show that if eve causes no errors , corollary  [ zeroerrorrequirement ] restricts the state to be a multiple - photon version of the state expected by bob .",
    "e.g.  if bob expects @xmath148 , the only 2-photon state that causes no errors is @xmath267 .",
    "+ we demonstrate the above only for the case of @xmath148 .",
    "the other cases can be achieved in a similar way . recall that in this case an error happens if bob s @xmath268 detector clicks .",
    "this means that in order to have no errors , we must require that @xmath269 for any element with @xmath270 .",
    "+ a zero overlap with @xmath271 implies @xmath272 .",
    "the element @xmath273 since it causes a click in both detectors , which implies an inconclusive result ( that must be interpreted as an error , since alice s states are assumed to contain only a single photon ) . since @xmath274 and @xmath275 a zero - overlap requires @xmath276 .",
    "the only solution for the above constraints is @xmath277 , and one can easily verify that @xmath278 causes no error if bob expects @xmath148 , i.e.  bob s detector at @xmath279 will never click .",
    "+ note that eve can not perform an attack that always sends bob a perfect 2-photon copy of the state sent by alice , due to no - cloning .",
    "last , we consider superpositions of states with different numbers of photons ( e.g. , @xmath280 , etc . ) .",
    "we note that the overlap of states with different numbers of photons is always zero .",
    "since @xmath281 , then if @xmath282 , the overlap must be zero .",
    "it follows that in order to have zero overlap with a state @xmath283 we only need to consider pulses with the same number of photons as @xmath284 ."
  ],
  "abstract_text": [
    "<S> photonic quantum key distribution is commonly implemented using interferometers , devices that inherently cause the addition of vacuum ancillas , thus enlarging the quantum space in use . </S>",
    "<S> this enlargement sometimes exposes the implemented protocol to new kinds of attacks that have not yet been analyzed .    </S>",
    "<S> we consider several quantum key distribution implementations that use interferometers , and analyze the enlargement of the quantum space caused by the interferometers . </S>",
    "<S> while we prove that some interferometric implementations are robust ( against simple attacks ) , we also show that several other implementations used in qkd experiments _ are totally insecure_.    this result is somewhat surprising since although we assume ideal devices and an underlying protocol which is proven secure ( e.g. , the bennett - brassard qkd ) , the realization is insecure . </S>",
    "<S> our novel attack demonstrates the risks of using practical realizations without performing an extensive security analysis regarding the specific setup in use . </S>"
  ]
}