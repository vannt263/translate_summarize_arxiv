{
  "article_text": [
    "let @xmath0 be a prime . in this paper , by a _",
    "@xmath0-group _ we mean a finite group whose order is a power of @xmath0 . recall that every @xmath0-group is nilpotent , and in particular solvable .",
    "given a property @xmath2 of groups , a group @xmath3 is called _ residually @xmath2 _ if for every @xmath4 with @xmath5 there exists a morphism @xmath6 onto a group @xmath7 enjoying property @xmath2 such that @xmath8 .",
    "for example , a group @xmath3 being residually a @xmath0-group ( residually @xmath0 , for short ) simply means that the intersection of all @xmath0-power index normal subgroups of  @xmath3 is trivial .",
    "being residually @xmath0 is a very strong property : e.g. , every finite subgroup of a residually @xmath0 group is a @xmath0-group , and every non - abelian subgroup of a residually @xmath0 group has a quotient isomorphic to @xmath9 .",
    "free groups and finitely generated torsion free nilpotent groups are well - known to be residually  @xmath0 for all @xmath0 .    in this paper",
    "we study @xmath1-manifold groups ( i.e. , groups which are fundamental groups of @xmath1-manifolds ) . throughout this paper",
    "we assume that the manifolds are connected and compact , but unless otherwise stated , we make no assumptions on orientability or on the type of boundary .",
    "compactness is not a serious restriction : every finitely generated group which is the fundamental group of a non - compact @xmath1-manifold also appears as the fundamental group of a compact @xmath1-manifold ( and hence is finitely presentable ) , cf .",
    "it is well - known that every finitely presentable group can be realized as the fundamental group of a compact , closed , connected , smooth manifold of dimension @xmath10 ( or higher ) .",
    "however , there are severe restrictions on which groups may occur as fundamental groups of @xmath1-dimensional manifolds ; for example , it is well - known that every @xmath1-manifold group is residually finite .",
    "( this was first shown for haken manifolds @xcite , and since perelman s proof of the geometrization conjecture , the proof now extends to include all @xmath1-manifolds . )",
    "residual finiteness of @xmath1-manifold groups leads to easy proofs for the decidability of the word problem in @xmath1-manifold groups , and for the decidability of knot triviality . in general , however , @xmath1-manifold groups tend to be far from being residually @xmath0 or even just being residually finite solvable .",
    "indeed , let @xmath11 be a knot and @xmath12 , where @xmath13 is a tubular neighborhood of @xmath14 in @xmath15 .",
    "it follows from dehn s lemma that @xmath16 if and only if @xmath14 is the trivial knot . but it is a consequence of stallings theorem ( * ? ? ?",
    "* theorem  3.4 ) that any map from @xmath3 to a nilpotent group necessarily factors through the abelianization @xmath17\\cong\\z$ ] .",
    "furthermore , if @xmath14 is a knot with trivial alexander polynomial , then in fact any map from @xmath3 to a solvable group necessarily factors through @xmath18 .",
    "the purpose of this paper is to show that virtually the picture is very different .",
    "one says that a group @xmath3 is _ virtually @xmath2 _ if there exists a finite index subgroup of @xmath3 which is @xmath2 .",
    "( subgroups of residually @xmath0 groups are again residually @xmath0 , so virtually residually @xmath0 is equivalent to residually @xmath0-by - finite . )",
    "we call a finitely generated group _ linear _ if it admits an embedding into @xmath19 for some @xmath20 and some field  @xmath14 of characteristic zero ( which may always chosen to be @xmath21 ) .",
    "many linear groups are not residually solvable ( for example , @xmath22 for @xmath23 , since these groups are perfect ) . on the other hand",
    ", it is well - known that linear groups are , for all but finitely many @xmath0 , virtually residually @xmath0 ; see , e.g. , ( * ? ? ?",
    "* theorem  4.7  ( i ) ) or ( * ? ? ?",
    "* window  7 ,  proposition  9 ) .",
    "( this is essentially due to mal@xmath24cev @xcite ; however , he only showed the weaker statement that linear groups are residually finite . ) therefore , each @xmath1-manifold group which is linear is virtually residually @xmath0 for all but finitely many @xmath0 . as is well - known , the fundamental group of each hyperbolic @xmath1-manifold and of each seifert fibered manifold is linear ( cf .",
    "sections  [ sec : hyperbolic ] and [ sec : seifert ] below ) , but it is not known whether this is true for all @xmath1-manifold groups .",
    "our main result now is the following .",
    "let @xmath25 be a @xmath1-manifold .",
    "then for all but finitely many primes @xmath0 the group @xmath26 is virtually residually @xmath0 .",
    "our proof of this theorem is substantially more involved than the proof of residual finiteness in @xcite .",
    "indeed , in order to show that the fundamental group  @xmath27 of a given @xmath1-manifold @xmath25 is residually finite , one first easily reduces to the case that @xmath25 is closed , orientable and prime . then @xmath25 admits a jsj decomposition ,",
    "hence may be viewed as the topological realization of a finite graph of based cw - complexes whose vertex spaces @xmath28 are either seifert fibered or hyperbolic @xmath1-manifolds , and whose edge spaces @xmath29 are tori . by virtue of the seifert - van kampen theorem",
    ", this gives rise to a description of @xmath3 as the fundamental group  @xmath30 of a ( finite ) graph of groups @xmath31 whose vertex groups @xmath32 are linear groups , and whose edge groups @xmath33 are free abelian of rank  @xmath34 .",
    "( see section  [ sec : graphs of groups ] below for a definition of a graph of groups . )",
    "as remarked , finitely generated linear groups are residually finite ( in fact , virtually residually @xmath0 for all but finitely many @xmath0 ) .",
    "so one may assume that the jsj decomposition of @xmath25 is non - trivial .",
    "let now @xmath4 , @xmath5 . by choosing suitable filtrations of the vertex groups  @xmath35 ,",
    "one then constructs a group morphism @xmath36 where @xmath37 is the fundamental group of a graph @xmath38 of _ finite _ groups ( with the same underlying graph as @xmath31 ) , such that @xmath8 .",
    "it now simply remains to prove that such a graph of finite groups has residually finite fundamental group ( * ? ? ?",
    "* proof of theorem  3.1 ) .",
    "( for the special cases of amalgamated products or hnn extensions , this was known much earlier @xcite . )",
    "in contrast to this , amalgamated products and hnn extensions of @xmath0-groups , although always residually finite , are rarely residually  @xmath0  @xcite , making it necessary to deviate from the flow of the argument in @xcite for the proof of our main theorem .",
    "another subtle difficulty is posed by the fact that for an infinite group @xmath3 , the intersection of all @xmath0-power index subgroups of @xmath3 being trivial does not guarantee that the intersection of all @xmath0-power index _ normal _ subgroups of @xmath3 is trivial ( i.e. , that @xmath3 is residually @xmath0 ) : it is easy to see that for every fibered @xmath1-manifold @xmath25 the intersection of all @xmath0-power index subgroups of the fundamental group @xmath3 of @xmath25 is trivial ( cf .  proposition  [ prop : fibered implies weakly residually p ] ) ; but there are fibered @xmath1-manifolds which are not residually nilpotent ( e.g. , as mentioned above , the fundamental group of a non - trivial fibered knot complement ) .",
    "we outline the overall strategy of our proof after discussing a few applications , and some commonalities between @xmath1-manifold groups and linear groups .",
    "our theorem may be used to significantly simplify the proof @xcite that twisted alexander polynomials detect fibered knots .",
    "more precisely , our main theorem replaces the ad hoc argument given in sections 5 and 6 of @xcite .",
    "this is explained in detail in @xcite .",
    "here , we restrict ourselves to discussing two more immediate applications .    first ,",
    "combining the theorem above with the fact ( proved in @xcite ) that the automorphism group of every finitely generated virtually residually @xmath0 group is also virtually residually @xmath0 , we obtain :    [ cor : corollary 1 ] the automorphism group @xmath39 of every @xmath1-manifold group @xmath3 is virtually residually @xmath0 for all but finitely many @xmath0 , and hence virtually torsion free . therefore , every torsion subgroup of @xmath39 is finite , and there is an upper bound on the orders of the finite subgroups of @xmath39 .",
    "this corollary complements @xcite where it was shown that if @xmath25 is a haken @xmath1-manifold which is not seifert fibered , then there is an upper bound on the orders of the finite subgroups of the group @xmath40 of outer automorphisms of  @xmath27 .",
    "however , since not every finite subgroup of @xmath40 lifts to a finite subgroup of  @xmath39 ( see  @xcite ) , this result is not immediately subsumed by corollary  1 .",
    "it seems not to be known whether the group of outer automorphisms of a @xmath1-manifold group is virtually residually @xmath0 .",
    "suppose @xmath25 is a closed aspherical @xmath1-manifold .",
    "then there is a bound on the size of finite groups of self - homeomorphisms of @xmath25 having a common fixed point .",
    "this follows immediately from corollary  1 and the fact that under the assumptions made here , for every effective action of a finite group @xmath41 on @xmath25 with a fixed point , the natural morphism @xmath42 is injective , cf .",
    "( questions similar to the one addressed in corollary  2 are posed in kirby s list @xcite , see problem  3.39 . )      the main theorem of this paper stated above can also been seen as further evidence to the conjecture ( due to thurston ) that @xmath1-manifold groups are linear .",
    "( this is problem  3.33  ( a ) in @xcite . )",
    "it is known that every linear group @xmath3 has the following group - theoretic properties .",
    "( recall from above that in our parlance , `` linear '' includes the condition of being finitely generated . )",
    "@xmath3 is virtually residually @xmath0 for all but finitely many primes @xmath0 ( in particular , @xmath3 is residually finite and virtually torsion free ) .",
    "@xmath3 is either virtually solvable of finite rank ( hence has polynomial subgroup growth ) or the subgroup growth of @xmath3 is at least of type @xmath43 .",
    "@xmath3 satisfies the tits alternative : either @xmath3 is virtually solvable or @xmath3 contains a non - abelian free group .",
    "4 .   @xmath3 satisfies the lubotzky alternative : either @xmath3 is virtually solvable , or @xmath3 has `` large finite quotients . ''",
    "( see ( * ? ? ?",
    "* window  9 ) for a precise statement . )",
    "@xmath3 has property @xmath44 : if @xmath14 is a non - nilpotent normal subgroup ( not necessarily finitely generated ) of @xmath3 , then there is a normal subgroup @xmath45 of @xmath3 such that @xmath46 and @xmath47 is finite and non - nilpotent .",
    "we refer to @xcite , @xcite and ( * ? ?",
    "* windows  7  and  9 ) for proofs of statements ( 1)(5 ) above .",
    "property @xmath44 was isolated and studied in @xcite .",
    "examples for groups with property @xmath44 ( besides all linear groups ) include all polycyclic - by - finite groups .",
    "this class of groups is of interest since for a finitely presented group with property @xmath44 , one can algorithmically decide whether a given finitely generated normal subgroup is nilpotent . moreover , every group @xmath3 with property @xmath44 is an fgh ( ` frattini - gaschtz - hall ' ) group in the sense of @xcite , meaning that various important characteristic subgroups of @xmath3 ( among them the fitting subgroup of @xmath3 and the hirsch - plotkin radical of @xmath3 ) agree and are nilpotent .",
    "it is a consequence of the proof of the geometrization conjecture and the work of various authors that statements ( 1)(4 ) also hold for all @xmath1-manifold groups @xmath3 : property ( 1 ) is our main theorem .",
    "( virtual torsion freeness also follows from the fact that irreducible @xmath1-manifolds with infinite fundamental group @xmath3 are eilenberg - mac  lane spaces of type @xmath48 . ) property ( 1 ) also yields property ( 2 ) by ( * ? ? ? * theorem  8.3 ) .",
    "however , a stronger estimate is proved in ( * ? ? ?",
    "* theorem  1.1 ) : if @xmath3 is a @xmath1-manifold group which is not virtually solvable , then the subgroup growth of @xmath3 is at least of type @xmath49 . the fact that ( 3 ) holds for @xmath1-manifold groups is well - known to the experts . it is also known ( and implicit in ( * ? ? ?",
    "* theorem  4.1 ) ) that every @xmath1-manifold group @xmath3 satisfies a ` weak lubotzky alternative ' : either @xmath3 is virtually solvable or @xmath50 for every prime @xmath0 . here , given a ring @xmath51 the virtual first @xmath51-betti number @xmath52 of a group @xmath3 is the defined as the supremum ( possibly @xmath53 ) of all first @xmath51-betti numbers of normal , finite index subgroups of @xmath3 . ( the weak lubotzky alternative for linear groups is a consequence of the lubotzky alternative , cf .",
    "* theorem 1.3 ) . ) property ( 5 ) appears not to be known for arbitrary @xmath1-manifold groups ; in a future publication we plan address this issue .    in @xcite , lubotzky gave a group - theoretic characterization of linear groups among finitely generated virtually residually @xmath0 groups , and it is tempting to employ it in combination with the methods in the present paper to prove the linearity of @xmath1-manifold groups .",
    "however , in general it seems to be difficult to verify that a given group satisfies this criterion .",
    "( for some rare cases where this has been done successfully see @xcite . )",
    "let @xmath25 be a @xmath1-manifold .",
    "in order to show that the finitely presentable group @xmath27 is virtually residually @xmath0 for all but finitely many @xmath0 , we proceed in five steps .      we first show that it suffices to consider only @xmath1-manifolds which are closed , orientable and prime .",
    "suppose @xmath25 satisfies these requirements .",
    "then @xmath25 admits a jsj decomposition , so @xmath54 for a graph of groups @xmath31 whose vertex groups @xmath32 are fundamental groups of hyperbolic or seifert fibered @xmath1-manifolds ( and hence are linear groups ) , and whose edge groups  @xmath33 are free abelian of rank @xmath34 .",
    "( below we identify the fundamental group @xmath55 of every boundary torus @xmath29 of a jsj component @xmath28 of @xmath25 with a subgroup of @xmath32 in the natural way . )",
    "since finitely generated linear groups are virtually residually @xmath0 for all but finitely many @xmath0 , we may assume from now on that the jsj decomposition of @xmath25 is non - trivial .",
    "we say that @xmath25 is _ seifert simple _ if every seifert fibered component in its jsj decomposition is of the form @xmath56 for some orientable surface @xmath57 which is either closed or has at least two boundary components . after passing to a finite cover of @xmath25 , we can further assume that @xmath25 is seifert simple .",
    "( this step of the proof is analogous to the first part of the proof of residual finiteness in @xcite . )",
    "next , we show that with the exception of finitely many primes @xmath0 , after passing to another finite cover of @xmath25 , we can construct what we call a _ complete boundary compatible @xmath0-filtration @xmath58 _ on each vertex group @xmath32 .",
    "this is a descending sequence of normal subgroups @xmath59 of @xmath60 such that @xmath61 is an elementary abelian @xmath0-group , which exhausts @xmath35 ( i.e. , @xmath62 ) , subject to further conditions , which we refrain from spelling out completely here ( see chapter  [ ch : proof of the main results ] for the precise definition ) ; for example , we require that @xmath63 separates the fundamental group @xmath33 of every boundary torus @xmath29 of @xmath28 ( i.e. , for each @xmath64 there is some @xmath65 with @xmath66 ) , and that it intersects to the lower central @xmath0-filtration of @xmath55 ( i.e. , @xmath67 for all @xmath65 ) .",
    "the construction of these filtrations is inspired by the proof of the fact that linear groups are virtually residually @xmath0 for all but finitely many @xmath0 , but needs further ingredients : a localization theorem for finitely generated integral domains ( which we prove by using a combination of elementary commutative algebra and model theory ) and some facts about congruence subgroups . from now on until the end of this discussion we assume that on each @xmath35 we are given such a complete boundary compatible @xmath0-filtration @xmath63 .",
    "( in some cases , e.g. , for graph manifolds , we can arrange for the lower central @xmath0-filtration @xmath68 of @xmath35 to be a complete boundary compatible @xmath0-filtration . )      a general criterion for the fundamental group of a graph of groups to be residually @xmath0 ( proposition  [ hempel criterion residually p ] ) reduces our task to showing that for all @xmath65 , the graph of groups @xmath69 , obtained by replacing each vertex group @xmath35 and each edge group @xmath55 by their ( @xmath0-power ) quotients @xmath70 respectively @xmath71 , has residually @xmath0 fundamental group .",
    "the case @xmath72 plays an important role .",
    "if @xmath73 for each vertex @xmath74 , then @xmath75 is the `` mod @xmath0 homology graph of @xmath31 '' : its vertex and edge groups are the first homology groups with @xmath76-coefficients @xmath77 and @xmath78 of the vertex respectively edge groups of @xmath31 .",
    "let @xmath79 be a maximal subtree of the graph underlying the graph of groups @xmath31 .",
    "the fundamental group @xmath80 of @xmath75 can be described as an iterated hnn extension of the fundamental group @xmath81 of the restriction  @xmath82 of @xmath75 to @xmath79 .",
    "replacing @xmath81 in this iterated hnn extension by the fiber sum @xmath83 ( colimit in the category of abelian groups ) of the tree  @xmath82 of elementary abelian @xmath0-groups , we obtain a `` partial abelianization '' of  @xmath80 along  @xmath79 , which we denote by @xmath84 . in this step",
    "we show that , possibly excluding finitely many more primes , if @xmath84 is residually @xmath0 , then all the fundamental groups of the quotient graphs @xmath69 are residually @xmath0 ( and hence @xmath27 is residually @xmath0 by step  3 ) ; cf .  theorem  [ thm : reduction theorem ] .",
    "this requires two main ingredients : an amalgamation theorem for _ filtered",
    "_ @xmath0-groups ( theorem  [ thm : higman ] ) which sharpens a result of higman  @xcite , the proof of which requires some facts about wreath products and group rings ; and analogous criteria for iterated hnn extensions of @xmath0-groups to be residually @xmath0 ( corollary  [ cor : chatzidakis ] ) , related to work of chatzidakis  @xcite .      a sufficient condition for @xmath84 to be residually @xmath0 is the existence of a group morphism @xmath85 to a finite abelian @xmath0-group @xmath86 which is injective on each vertex groups of @xmath75 .",
    "hence , in order to finish the proof , we show that after passing to a suitable finite cover of @xmath25 , we can achieve exactly this .",
    "now , the identification morphisms between the fundamental groups of boundary tori yield a collection of isomorphisms @xmath87 between subgroups of  @xmath88 which provide obstructions to the existence of such a morphism . extending each @xmath87 to an automorphism of @xmath88",
    "yields a morphism @xmath89 which is trivial on each vertex group of @xmath31 . to obtain the desired finite cover of @xmath25",
    ", we introduce a construction , which we call the _ unfolding of @xmath31 along @xmath90 , _ which produces a morphism of graphs of groups @xmath91 and complete boundary compatible @xmath0-filtrations on the vertex groups of @xmath38 ( which give rise to the associated quotient graph of elementary abelian @xmath0-groups @xmath92 ) such that the induced morphism @xmath93 is injective with image @xmath94 , and such that for some maximal subtree @xmath95 of the underlying graph of @xmath38 , we do have a morphism @xmath96 to a @xmath0-group which is injective on the vertex groups of @xmath92 as required .",
    "it is legitimate to wonder whether our main theorem is but the echo of a more general fact .",
    "for example , one may ask : _ is every finitely presented residually finite torsion free group , for all but finitely many @xmath0 , virtually residually @xmath0 ? _ if we replace `` finitely presented '' by `` finitely generated '' and drop the condition `` torsion free , '' then the answer to this question is `` no '' : if @xmath3 is a group which is virtually residually  @xmath0 for two distinct primes  @xmath0 , then @xmath3 is virtually torsion free ; however , for every prime @xmath0 there are examples of @xmath0-torsion groups which are infinite , finitely generated , and residually finite , constructed by golod @xcite . ( on the other hand , it seems to be unknown whether there exist infinite _",
    "finitely presented _ periodic groups . )",
    "if we replace `` finitely presented '' by `` finitely generated , '' then the answer is also negative : it is a well - known theorem of grigorchuk @xcite ( see also ( * ? ? ?",
    "* interlude  e ) ) that if @xmath3 is a finitely generated residually @xmath0 group which has word growth @xmath97 , then @xmath3 is virtually nilpotent ( and hence has polynomial growth ) .",
    "grigorchuk @xcite also constructed a finitely generated residually finite torsion free group @xmath98 whose word growth is intermediate ( i.e. , between polynomial and exponential ) and which is therefore not virtually residually @xmath0 for _ any _ @xmath0 .",
    "( for a while , the question whether every finitely generated group of intermediate growth is residually finite was open ( * ? ? ?",
    "* vi.64 ) , but this turned out to be false @xcite . )    we also note that it might be difficult to find a @xmath1-manifold @xmath25 for which the set of exceptional primes in our main theorem is non - empty : it has been conjectured ( by thurston ) that every irreducible @xmath1-manifold which is not a graph manifold has a finite cover which is fibered ; on the other hand , our techniques easily yield :    let @xmath25 be a fibered @xmath1-manifold . then for _ every _ prime @xmath0 the group @xmath26 is virtually residually @xmath0 .",
    "topics of this kind are also discussed , employing other arguments , in @xcite .",
    "the method for proving residual properties of @xmath1-manifold groups introduced in this paper is quite flexible .",
    "for example , it yields the following improvement of our main theorem for graph manifolds :    let @xmath25 be a graph manifold . then for _ every",
    "_ prime @xmath0 the group @xmath26 is virtually residually @xmath0 .    in @xcite , perron and shalen",
    "introduce the notion of a ` weakly residually @xmath0-nilpotent ' group , and show that all graph manifold groups have a finite index subgroup which is weakly residually @xmath0-nilpotent for every @xmath0 ( * ? ? ?",
    "* proposition  0.3 ) .",
    "however , the proof for that claim has a gap @xcite : in fact , one may show that a group is weakly residually @xmath0-nilpotent if and only if it is residually @xmath0 , and if @xmath25 is a sol - manifold , then @xmath26 does _ not _ have a finite index subgroup which is residually @xmath0 for every @xmath0 .",
    "these matters will be discussed further in @xcite .",
    "proposition  2 may be refined to show that virtually , the pro-@xmath0 topology on the fundamental group of a graph manifold @xmath25 interacts well with the structure of the graph of groups arising from the jsj decomposition of @xmath25 . to make this precise ,",
    "suppose we are interested in a property @xmath2 of groups .",
    "the pro-@xmath2 topology on a group  @xmath3 is the group topology with fundamental system of neighborhoods of the identity given by the normal subgroups @xmath99 such that @xmath100 is a @xmath2-group .",
    "inspired by a notion introduced in @xcite , we say that a @xmath1-manifold @xmath25 is _",
    "if @xmath25 is closed prime orientable ( so the jsj decomposition of @xmath25 exists ) , its fundamental group @xmath27 is residually @xmath2 , and for each jsj component  @xmath28 of  @xmath25 and each component @xmath29 of the boundary of @xmath28 , the fundamental groups  @xmath32 and @xmath33 , identified with subgroups of @xmath3 in the natural way , the following conditions hold :    1 .   @xmath35 and @xmath55 are closed in the pro-@xmath2 topology on @xmath3 ; 2 .",
    "the pro-@xmath2 topology on @xmath3 induces the pro-@xmath2 topology on @xmath35 and on @xmath55 .",
    "wilton and zalesskii @xcite showed that all closed prime orientable @xmath1-manifolds are @xmath2-efficient , for @xmath2 the property of being finite .",
    "we show :    let @xmath25 be a closed graph manifold .",
    "then for every @xmath0 , @xmath25 has a finite cover which is @xmath0-efficient .",
    "it seems plausible that this result might play the same role in studying the ( virtual ) conjugacy @xmath0-separability of graph manifold groups as finite efficiency does in the proof of their conjugacy separability , which was also established in @xcite .",
    "we do not pursue this issue further in the present paper ; however , we note that proposition  3 also implies that virtually , the fundamental group of a closed graph manifold group and its pro-@xmath0 completion have the same mod @xmath0 cohomology in a certain sense , explained in section  [ sec : coh p - completeness ] .",
    "we do not know whether every closed prime @xmath1-manifold is , for all but finitely many @xmath0 ( or even just for infinitely many @xmath0 ) , virtually @xmath0-efficient .",
    "this question will be discussed further in section  [ sec : p - efficiency in general ] .",
    "we note here that if @xmath25 is a @xmath0-efficient @xmath1-manifold with fundamental group @xmath3 , then condition  ( 2 ) of @xmath0-efficiency implies that there exists some @xmath20 such that for every jsj component @xmath28 of @xmath25 with fundamental group @xmath35 ( identified in the natural way with a subgroup of @xmath3 ) , we have @xmath101 . as an indication that every closed prime @xmath1-manifold might indeed be virtually @xmath0-efficient for all but finitely many @xmath0 , we show that we can achieve this condition on @xmath102 in a finite cover .",
    "in fact , we may take @xmath72 , and so our result may be phrased as a statement about the mod @xmath0 homology of finite covers of @xmath1-manifolds as follows :    every closed prime @xmath1-manifold @xmath25 has , for all but finitely many  @xmath0 , a finite cover @xmath103 such that for every jsj component @xmath104 of @xmath103 , the natural morphism @xmath105 is injective .      as should be apparent from the outline of the strategy given above , the proof of the main result of this paper involves going through several technical prerequisites ; some of those can be assumed as black boxes in a first reading .",
    "we recommend that the reader should first only skim the preliminary chapter  [ ch : preliminaries ] , and take the main results of chapter  [ ch : embedding theorems ] for granted before immediately moving to chapters  [ ch : residual properties of graphs of groups ] and [ ch : proof of the main results ] , which contain the essence of steps  35 in the proof strategy indicated above .",
    "the various subsections labeled `` digression '' may also be skipped upon a first reading of the paper . in the final chapter  [ ch : graph manifolds ]",
    "we give proofs of propositions  24 from above .      throughout this paper , @xmath106 ,",
    "@xmath20 range over the set @xmath107 of natural numbers .",
    "unless otherwise noted , @xmath0 denotes a prime number . by a @xmath0-group we mean a finite group whose order is a power of @xmath0 .",
    "the fields institute in toronto provided kind hospitality to the first - named author while a part of the work on this paper was done .",
    "he was also partially supported by national science foundation grant dms-0556197 .",
    "the second - named author was partially supported by a crm - ism fellowship and by cirget .",
    "we would like to thank steve boyer for many insightful conversations .",
    "we are also grateful to ian agol , christian haesemeyer , marc lackenby , yehuda shalom , and stefano vidussi for helpful comments .",
    "we also thank the referee for a careful reading of the manuscript .",
    "we begin by introducing basic terminology and fundamental facts concerning filtrations of groups .",
    "facts stated without proof or reference are standard ; for more information on filtrations ( in particular the connection to lie algebras , not explicitly exploited here ) , see @xcite . throughout this section",
    "we let @xmath3 be a group .",
    "we call a descending sequence @xmath108 of subgroups of @xmath3 a _ filtration _ of @xmath3 .",
    "we say that a filtration @xmath109 as above is _ complete _ if @xmath110 .",
    "we call a filtration @xmath111 of @xmath3 _ normal _ if each subgroup @xmath112 is normal in @xmath3 ; in this case , we write @xmath113 for the @xmath20th `` layer '' of @xmath111 .",
    "a _ filtered group _ is a pair @xmath114 where @xmath3 is a group and @xmath111 is a filtration of  @xmath3 .",
    "the class of filtered groups are the objects of a category , where a morphism of filtered groups @xmath115 is a group morphism @xmath116 such that @xmath117 for all @xmath20 .",
    "note that if @xmath118 is a morphism between normal filtered groups , then for each @xmath20 , @xmath119 induces an injective group morphism @xmath120 .",
    "the category of filtered groups has direct products : if @xmath121 and @xmath122 are filtrations of @xmath3 respectively @xmath7 , then @xmath123 is a filtration of @xmath124 ( the _ product _ of the filtrations @xmath111 and @xmath125 ) .",
    "if both @xmath111 and @xmath125 are normal , then so is @xmath126 , with @xmath127 for all @xmath20 .",
    "let @xmath121 be a filtration of @xmath3 , and let @xmath128 .",
    "we call the filtration @xmath129 of @xmath14 the _ intersection _ of @xmath111 with @xmath14 .",
    "if @xmath130 is a filtration of a subgroup of @xmath3 with @xmath131 , or equivalently , if the natural inclusion @xmath132 is a morphism of filtered groups @xmath133 , then we say that @xmath111 _ intersects to @xmath134 _ on @xmath14 .",
    "we say that filtrations @xmath121 and @xmath135 of @xmath3 are _ equivalent _ if @xmath136 notation : @xmath137 .",
    "clearly @xmath138 is an equivalence relation on filtrations of @xmath3 .",
    "we say that @xmath111 _ induces _ a filtration @xmath134 on a subgroup @xmath14 of @xmath3 if @xmath139 .",
    "the following is obvious :    [ lem : refine ] let @xmath14 be a common subgroup of @xmath3 and another group @xmath7 .",
    "let @xmath111 be a filtration of @xmath3 and @xmath125 be a filtration of @xmath7 with @xmath140 .",
    "we say that @xmath111 , @xmath125 _ induce the same filtration on @xmath14_. then there are filtrations @xmath141 of @xmath3 and @xmath142 of @xmath7 with @xmath143 .",
    "let @xmath121 and @xmath135 be filtrations of @xmath3 .",
    "we say that _ @xmath144 refines  @xmath111 _ ( and @xmath144 is called a _ refinement _ of @xmath111 ) if there exists a strictly increasing map @xmath145 such that @xmath146 and @xmath147 for all @xmath65 .",
    "if in addition @xmath148 then we say that _",
    "@xmath144 stretches @xmath111 _ ( and @xmath144",
    "is called a _ stretching _ of @xmath111 ) .",
    "note that in this case @xmath141 , and the layers of @xmath149 are given by @xmath150 given a collection @xmath151 of groups , and for each @xmath152 a filtration @xmath153 of @xmath3 and a stretching @xmath149 of @xmath111 , we say that the @xmath149 ( where @xmath3 ranges over @xmath151 ) are _ compatible _ if  @xmath154 can be chosen uniformly for all pairs @xmath155 .",
    "given @xmath156 , we say that a filtration @xmath121 of @xmath3 has _ length @xmath157 _",
    "if @xmath158 ; the smallest such @xmath20 is called the length of @xmath111 , and if no such @xmath20 exists , then @xmath111 is said to have infinite length .",
    "we sometimes write a finite - length filtration of @xmath3 simply in the form @xmath159 with the understanding that @xmath160 for all @xmath161 .    given a subgroup @xmath7 of @xmath3 we say that a filtration @xmath121 of @xmath3 _ separates @xmath7 _ if @xmath162 , and we simply say that @xmath111 is _ separating _ if it separates the trivial subgroup @xmath163 of @xmath3 .",
    "we say that a filtration of @xmath3 separates a collection of subgroups of @xmath3 if it separates each member",
    ".    given two filtrations @xmath121 and @xmath135 of @xmath3 , we say that _ @xmath111 descends faster than @xmath144 _ ( in symbols : @xmath164 ) if @xmath165 for all @xmath20 .",
    "let @xmath121 be a complete filtration of @xmath3 .",
    "we say that @xmath111 is a _",
    "central filtration _ of @xmath3 if @xmath166\\leq g_{n+1}$ ] for all @xmath20 .",
    "every such central filtration @xmath111 of @xmath3 is automatically normal , and the successive quotients @xmath167 are central , that is , @xmath168 for all @xmath20 . in particular , the groups @xmath169 are abelian , and every refinement of a central filtration is central .",
    "the _ lower central filtration _ of @xmath3 is the fastest descending central filtration @xmath170 of @xmath3 , defined by @xmath171\\text { for $ n\\geq 1$.}\\ ] ] the @xmath172 are totally invariant subgroups of @xmath3 .",
    "the first quotient @xmath173 $ ] is the abelianization @xmath174 of @xmath3 . for each @xmath65 , the commutator map @xmath175\\colon \\gamma_n(g)\\times g\\to\\gamma_{n+1}(g)\\ ] ] yields a surjective morphism @xmath176 thus if @xmath177 is finitely generated ( in particular , if @xmath3 is finitely generated ) , then so is each quotient @xmath178 .",
    "( see , e.g. , ( * ? ? ? * ( 4.6 ) ) . )    given @xmath20 , there exists a central separating filtration of @xmath3 of length @xmath157 if and only if @xmath179 ; in this case , @xmath3 is said to be nilpotent of class @xmath157 .",
    "moreover , the group  @xmath3 is residually nilpotent if and only if there exists a separating central filtration of @xmath3 , and in this case the lower central filtration of @xmath3 is separating .",
    "a _ strongly central filtration _ of @xmath3 is a complete filtration @xmath180 of @xmath3 with the property that @xmath181\\leq g_{n+m}$ ] for all @xmath20 and @xmath106 .",
    "( this is called an `` @xmath25-series '' in @xcite , and sometimes called a `` lazard filtration . '' ) the lower central filtration of @xmath3 is indeed strongly central .",
    "let @xmath121 be a filtration of @xmath3 .",
    "we say that @xmath111 is a _ @xmath0-filtration _ if @xmath182 for all @xmath65 .",
    "thus if @xmath111 is a normal @xmath0-filtration of  @xmath3 then each non - trivial element of the quotient @xmath167 has order @xmath0 .",
    "a filtration of @xmath3 equivalent to a @xmath0-filtration of @xmath3 is itself a @xmath0-filtration .",
    "similarly , the intersection of a @xmath0-filtration of @xmath3 with any subgroup @xmath14 of @xmath3 is a @xmath0-filtration of  @xmath14 , and the product of two @xmath0-filtrations is a @xmath0-filtration .",
    "( all these statements , of course , also hold with `` central filtration '' respectively `` strongly central filtration '' in place of `` @xmath0-filtration '' everywhere . )",
    "an important role in this paper is played by central @xmath0-filtrations : @xmath111 is a central @xmath0-filtration of @xmath3 precisely if @xmath183 ( g_n)^p \\leq g_{n+1}\\text { for all $ n\\geq 1$.}\\ ] ] in this case , each successive quotient @xmath184 has a natural structure of an @xmath76-linear space .",
    "the _ lower central @xmath0-filtration _",
    "@xmath185 of @xmath3 is defined by @xmath186 \\gamma^p_n(g)^p\\text { for $ n\\geq 1$.}\\ ] ] the @xmath187 are totally invariant : if @xmath188 is a group morphism , then @xmath189 for all @xmath65 .",
    "we have @xmath190 and if @xmath3 is a @xmath0-group , then @xmath191\\ , g^p$ ] is the frattini subgroup of @xmath3 .",
    "the lower central @xmath0-filtration is the fastest descending central @xmath0-filtration of @xmath3 .",
    "it was introduced in @xcite , and some of its basic properties are described in detail in ( * ? ? ?",
    "* chapter  viii ) ( under the name `` @xmath192-series '' ) , for example :    [ prop : lower p ] for all @xmath193 :    1 .",
    "@xmath194\\leq \\gamma^p_{m+n}(g)$ ] ; 2 .   @xmath195 .    for",
    "a proof see ( * ? ? ?",
    "* chapter  viii , theorem  1.5 ) .",
    "[ lem : canonical filtration ] let @xmath196 .",
    "suppose there exists a central @xmath0-filtration @xmath121 of @xmath3 which intersects to the lower central @xmath0-filtration on @xmath79 .",
    "then every central @xmath0-filtration @xmath144 of @xmath3 with @xmath197 intersects to the lower central @xmath0-filtration of  @xmath79 .",
    "in particular , the lower central @xmath0-filtration of @xmath3 intersects to the lower central @xmath0-filtration of @xmath79 .",
    "suppose @xmath144 is a central @xmath0-filtration of @xmath3 with @xmath197",
    ". then @xmath198 . on the other hand",
    ", @xmath199 is a central @xmath0-filtration of @xmath79 , hence @xmath200 .",
    "the following is shown by induction on @xmath106 ( simultaneously for all @xmath20 ) ; we leave the details to the reader .",
    "[ lem : iterated gamma ] let @xmath121 be a central @xmath0-filtration of @xmath3 . then @xmath201    if there exists a central separating @xmath0-filtration of @xmath3 of length @xmath157 , then we have @xmath202 , and in this case we say that @xmath3 has _",
    "lower @xmath0-length @xmath157 ; _ the smallest such @xmath20 ( if it exists ) is the _",
    "lower @xmath0-length _ of @xmath3 .",
    "so for example , @xmath3 has lower @xmath0-length  @xmath163 if and only if @xmath3 is a non - trivial elementary abelian @xmath0-group . in general ,",
    "a finite group is a @xmath0-group if and only if it has finite lower @xmath0-length .",
    "a finitely generated group @xmath3 is residually @xmath0 if and only if there exists a separating central @xmath0-filtration of @xmath3 ; in this case the lower central @xmath0-filtration of @xmath3 is separating .      a strongly central filtration  @xmath180 of @xmath3",
    "is called a _",
    "dimensional @xmath0-filtration _ if @xmath203 for all @xmath65 .",
    "( so every dimensional @xmath0-filtration is indeed a @xmath0-filtration . )",
    "the fastest descending dimensional @xmath0-filtration  @xmath204 of @xmath3 is given by @xmath205\\quad \\text{for $ n>1$.}\\ ] ] the @xmath206 are called the _ dimension subgroups _ of @xmath3 in characteristic @xmath0 . if we want to stress the dependence of @xmath206 on @xmath3 and @xmath0 , we write @xmath207 .",
    "we call @xmath204 the _ lower dimensional @xmath0-filtration _ of @xmath3 .",
    "( this is also variously called the zassenhaus , jennings or lazard series of @xmath3 in the literature .",
    "dimensional @xmath0-filtrations are called `` @xmath208-series '' in @xcite . )",
    "its length will be called the _ lower dimensional @xmath0-length _ of the group @xmath3 .",
    "note that the @xmath206 are totally invariant , and clearly @xmath209 for all @xmath65 .",
    "a closed formula for @xmath210 is due to lazard ( cf .",
    "* theorem  11.2 ) ) : @xmath211 ( the groups @xmath206 will only appear in chapter  [ ch : embedding theorems ] . )      we say that a complete normal finite - length filtration @xmath121 of @xmath3 is a _ chief filtration _ of @xmath3 if each quotient @xmath167 is either trivial or a minimal non - trivial subgroup of @xmath212 .",
    "every chief filtration of @xmath3 induces a chief filtration on any subgroup of @xmath3 .",
    "the quotients @xmath184 in a chief filtration of @xmath3 are called the _",
    "chief factors _ of the filtration .",
    "every finite group has a chief filtration of finite length .",
    "every normal filtration of finite length of a finite group may be refined to a chief filtration of finite length .",
    "in particular , if @xmath3 admits a finite - length chief filtration and @xmath25 is any normal subgroup of @xmath3 , then one can always find a finite - length chief filtration in which @xmath25 is one of the terms .",
    "every chief factor of a finite nilpotent group is central , and every chief factor of a @xmath0-group has order @xmath0 .",
    "( hence every chief filtration of a @xmath0-group is a central @xmath0-filtration . )",
    "let @xmath213 be an operation which associates to a group @xmath214 a totally invariant subgroup @xmath215 of @xmath214 , i.e. , every group morphism @xmath216 restricts to a group morphism @xmath217 .",
    "recall that a subgroup @xmath7 of @xmath3 is called a _ retract _ of @xmath3 if the natural inclusion @xmath218 left splits .",
    "note that if @xmath7 is a free factor of @xmath3 , i.e. , if there exists a subgroup @xmath219 of @xmath3 such that @xmath3 is ( isomorphic to ) the free product @xmath220 , then @xmath7 is a retract of @xmath3 .",
    "[ lem : lower central for semidirect products ] if @xmath221 is a retract of @xmath3 , then @xmath222 if @xmath223 where @xmath224 and @xmath221 , then @xmath225    let @xmath221 .",
    "we have @xmath226 , and if @xmath6 is a morphism which is the identity on @xmath7 , then @xmath227 .",
    "this shows the first statement . for the second statement ,",
    "assume @xmath223 , where @xmath221 , and let @xmath228 be the natural morphism .",
    "then @xmath229 , thus @xmath230 as required .",
    "this lemma applies in particular to the operation @xmath88 which , for given @xmath65 , yields the @xmath20th term in the lower central filtration @xmath231 , lower central @xmath0-filtration @xmath232 , or lower dimensional @xmath0-filtration @xmath210 , respectively .",
    "we also note :    [ lem : retract ] let @xmath221 be a retract of @xmath3 , and suppose @xmath3 is residually @xmath0",
    ". then @xmath233 separates @xmath7 .",
    "let @xmath6 be a morphism which is the identity on @xmath7 .",
    "let @xmath234 .",
    "let @xmath65 , and take @xmath235 with @xmath236 .",
    "then @xmath237 and hence @xmath238 .",
    "since this holds for every  @xmath65 , and @xmath239 , we obtain @xmath240 as required .      for every @xmath65",
    "we write @xmath241 . recall that each @xmath242 is in a natural way an @xmath76-linear space .",
    "if @xmath177 is finitely generated , then each of the layers @xmath242 is finite ( cf .",
    "ii ) ; see also @xcite ) .",
    "note that if @xmath3 is abelian and written additively , then @xmath243 and so @xmath244 , for all @xmath20 . if @xmath7 denotes the abelianization @xmath245 $ ] of @xmath3 , with natural morphism @xmath228 , then @xmath246 for every @xmath65 , and the restriction of @xmath247 to @xmath187 induces a surjective morphism @xmath248 which is an isomorphism for @xmath249 .    in the rest of this subsection",
    "we develop some further basic facts about the groups @xmath242 .",
    "the main tool is a precise version of the hall - petrescu formula ( * ? ? ?",
    "* theorem  1.1.30 ) . in the theorem and its corollaries below",
    ", we let  @xmath250 ,  @xmath251 range over  @xmath3 .",
    "[ thm : hp ] for all @xmath193 , @xmath252^{m\\choose 2}\\ , r_{mn}\\mod \\gamma_{n+1}(g)\\ ] ] where @xmath253 is a product of powers @xmath254 with @xmath255 and @xmath256 is a @xmath18-linear combination of @xmath257 , for some @xmath258 with @xmath259 .",
    "this yields a sharpening of ( * ? ?",
    "* lemma  11.9 ) :    [ cor : hp ] let @xmath260 .",
    "then @xmath261^{2^{m-1 } } \\mod \\gamma_2(g)^{2^m}\\gamma_3(g)^{2^{m-1}}\\prod_{d=2}^m \\gamma_{2^d}(g)^{2^{m - d}},\\ ] ] and if @xmath0 is odd , then @xmath262    we apply the previous theorem with @xmath263 and @xmath264 in place of  @xmath106 .",
    "if @xmath0 is odd then @xmath265 and hence @xmath266^{p^m\\choose 2}\\in\\gamma_2(g)^{p^m}$ ] .",
    "for @xmath267 note that @xmath266^{2^m\\choose 2}\\equiv [ x , y]^{2^{m-1}}\\bmod\\gamma_2(g)^{2^m}$ ] since @xmath268^{2^m\\choose 2 } = [ y , x]^{2^{2m-1}-2^{m-1}}=[y , x]^{2^{2m-1}}[x , y]^{2^{m-1}}.\\ ] ] it is well - known that if @xmath269 where @xmath270 , @xmath271 not divisible by @xmath0 , then @xmath272 is divisible by @xmath273 .",
    "therefore every @xmath18-linear combination of the binomial coefficients @xmath274 is divisible by @xmath275 where @xmath276 .",
    "so each of the powers @xmath254 in theorem  [ thm : hp ] lies in @xmath277 .",
    "therefore each @xmath254 lies in @xmath278 , since @xmath279 .",
    "we might have @xmath280 , but in this case @xmath254 actually lies in @xmath281 , since @xmath282 and so @xmath283 .",
    "similarly , we have that if @xmath267 and @xmath284 , then @xmath285 .",
    "therefore the corollary follows from theorem  [ thm : hp ] .",
    "we note some consequences of this corollary :    [ cor : hp , 2 ] let @xmath260 .",
    "then @xmath261^{2^{m-1 } } \\mod \\gamma^2_{m+2}(g),\\ ] ] and if @xmath0 is odd , then @xmath286    we have @xmath287 as well as @xmath288 and @xmath289 if @xmath290 and @xmath291 , or if @xmath267 and @xmath292 , then we have @xmath293 and thus @xmath294 .",
    "hence the corollary follows from corollary  [ cor : hp ] .",
    "if @xmath3 is abelian ( written additively ) , then @xmath244 for every @xmath65 , and multiplication by @xmath0 on @xmath3 induces a group morphism @xmath295 .",
    "( if in addition @xmath3 does not have @xmath0-torsion , then for every @xmath65 , this morphism is actually an isomorphism . )",
    "more generally , we have :    [ cor : phi_n ] let @xmath121 be a central @xmath0-filtration of @xmath3 , and let @xmath65 .",
    "suppose @xmath296 or @xmath297\\leq g_{n+2}$ ] .",
    "then for every @xmath260 the map @xmath298 is a group morphism whose kernel contains @xmath299 .",
    "this follows from corollary  [ cor : hp , 2 ] ( applied to @xmath112 in place of @xmath3 ) and lemma  [ lem : iterated gamma ] . for @xmath300 , the previous corollary shows that unless @xmath267 , @xmath249 , and @xmath301 , the map in induces group morphisms @xmath302 in general , the morphisms @xmath303 are not injective .",
    "however , we do have :    [ lem : phin injective ] suppose @xmath296 , @xmath304 , or @xmath305 .",
    "also assume that for @xmath306 , the group @xmath307 is @xmath0-torsion free or equivalently , the sections @xmath308 are @xmath0-torsion free for @xmath309 .",
    "then the group morphisms  @xmath303  @xmath260 are injective .",
    "this lemma is a consequence of the following fact , elucidating the structure of the elementary abelian @xmath0-groups @xmath242 .",
    "we set @xmath310 for @xmath65 .    for every @xmath65 the map @xmath311 where @xmath312 and @xmath313 , is a surjection , and a group morphism unless @xmath0 is odd and @xmath249 .",
    "if for @xmath306 , the group @xmath307 is @xmath0-torsion free , then this map is also injective .    for a proof of this theorem see ( *",
    "* chapter  viii , theorems  1.8 and 1.9 ) .",
    "( theorem  1.9 of loc .",
    "cit .  has the more restrictive assumption that @xmath314 is torsion free for @xmath306 , but inspection of the proof shows that only @xmath0-torsion needs to be excluded . )",
    "note that this theorem in particular implies that if @xmath177 is finitely generated , then for each central @xmath0-filtration @xmath111 of @xmath3 , all layers @xmath184 are finite .    in the situation of lemma  [ lem : phin injective ] , we now have a commutative diagram @xmath315 \\ar[r ] & l^p_n(g ) \\ar[d]_{\\phi_{n , m } } \\\\",
    "\\gamma_1\\times\\cdots\\times\\gamma_n \\times\\gamma_{n+1}\\times\\cdots\\times\\gamma_m \\ar[r ] & l^p_{n+m}(g ) } \\ ] ] where the top horizontal map is a bijection , and the left vertical map is given by @xmath316 and hence injective .",
    "this yields lemma  [ lem : phin injective ] .",
    "suppose that @xmath0 is odd or @xmath317 .",
    "then for each @xmath260 we have a group morphism @xmath318 which is given by @xmath319 if the abelian group @xmath320 does not have @xmath0-torsion , then for each @xmath260 , the morphism @xmath321 is injective .",
    "let now @xmath121 be an arbitrary central @xmath0-filtration of @xmath3 .",
    "in corollary  [ cor : phi_n ] we saw that if @xmath0 is odd or @xmath322\\leq g_3 $ ] , then for each @xmath65 , exponentiation to the power @xmath323 on @xmath3 induces a group morphism @xmath324 , and above we gave a criterion , in the case @xmath300 , for these morphisms to be injective .",
    "the following definition captures this phenomenon :    we say that @xmath111 is _ @xmath0-potent _ if for every @xmath65 , the map @xmath325 is a group morphism whose kernel _ equals _ @xmath326 . in this case , we have an induced injective group morphism @xmath327 , which we denote by @xmath328",
    ".    it will be useful to have terminology for a few variants of this definition available : we say that @xmath111 is _ strongly @xmath0-potent _ if for every @xmath65 , the map @xmath329 is a morphism with kernel @xmath299 .",
    "in this case we have induced injective morphisms @xmath330 .",
    "we call @xmath111 _ uniformly @xmath0-potent _ if @xmath111 is strongly @xmath0-potent and each @xmath331 ( @xmath65 ) is an isomorphism .",
    "we simply say that @xmath3 is _ @xmath0-potent _ if @xmath233 is @xmath0-potent .",
    "( similarly for strongly @xmath0-potent respectively uniformly @xmath0-potent . )",
    "clearly uniformly @xmath0-potent @xmath332 strongly @xmath0-potent @xmath332 @xmath0-potent .    1 .   if @xmath3 is abelian @xmath0-torsion free , then @xmath3 is uniformly @xmath0-potent .",
    "2 .   every uniformly powerful pro-@xmath0 group is ( almost by definition ) uniformly @xmath0-potent ; see ( * ? ? ?",
    "* chapter  4 ) .",
    "( this explains our choice of terminology . )",
    "examples may be obtained by considering the congruence subgroups of @xmath333 . for simplicity assume",
    "@xmath0 is odd , and for each  @xmath65 define @xmath334 then the groups @xmath335 form a uniformly @xmath0-potent separating filtration of the pro-@xmath0 group @xmath336 , and in fact @xmath337 for every @xmath65 ; see ( * ? ? ?",
    "* theorem  5.2 ) , and also section  [ sec : csg ] below .",
    "we say that a central @xmath0-filtration @xmath111 of @xmath3 has finite rank if there exists an integer  @xmath338 such that @xmath339 for all @xmath65 .    1 .",
    "if @xmath3 admits a separating strongly @xmath0-potent filtration , then @xmath3 is torsion  free . 2 .",
    "if @xmath121 is a strongly @xmath0-potent filtration of @xmath3 having finite rank , then for some @xmath260 , the filtration @xmath340 of @xmath341 is uniformly @xmath0-potent .",
    "our chief interest in uniformly @xmath0-potent filtrations is in the case of example  ( 1 ) above . for sake of completeness , we note :    [ lem : linearity ] suppose @xmath3 is finitely generated . if @xmath3 admits a separating strongly @xmath0-potent filtration of finite rank , then @xmath3 is necessarily linear over @xmath342 .",
    "conversely , if @xmath3 is linear , then for all but finitely many @xmath0 , some finite index normal subgroup of @xmath3 admits a separating uniformly @xmath0-potent filtration .",
    "this is essentially lubotzky s linearity criterion @xcite ( see also interlude  b in @xcite ) : suppose @xmath111 is a separating strongly @xmath0-potent filtration of finite rank ; then @xmath111 is a @xmath0-congruence system of finite rank in the sense of ( * ? ? ?",
    "* definition  b.2 ) , hence @xmath3 is linear over @xmath342 by proposition  b.3 of loc .",
    "conversely , suppose @xmath3 is linear .",
    "then for all but finitely many @xmath0 , the group @xmath3 admits an embedding into @xmath333 for some @xmath343 ( * ? ? ?",
    "* lemma  b.4 ) .",
    "assuming now that @xmath0 is odd and @xmath344 , the filtration @xmath121 of @xmath3 given by @xmath345 is separating and , as filtration of @xmath346 , strongly @xmath0-potent of finite rank .",
    "now use the preceding remark  ( 2 ) .",
    "every normal filtration @xmath121 of @xmath3 gives rise to a topology on @xmath3 making @xmath3 into a topological group with a fundamental system of neighborhoods of the identity given by the groups @xmath112 .",
    "we denote by @xmath347 the associated completion of @xmath3 , that is , the topological group @xmath348 we have a natural continuous morphism @xmath349 , which is injective precisely if @xmath111 is separating .",
    "if all @xmath112 are of finite index in @xmath3 , then @xmath347 is a profinite group .",
    "in particular , if @xmath177 is finitely generated and @xmath300 , then we obtain the pro-@xmath0 topology on @xmath3 , and @xmath350 is the pro-@xmath0 completion of @xmath3 .",
    "the proof of ( * ? ? ?",
    "* proposition  b.3 ) shows that if @xmath111 is a strongly @xmath0-potent filtration of @xmath3 having finite rank , then @xmath347 is isomorphic ( qua topological group ) to a @xmath0-adic analytic group .",
    "( this was originally shown in ( * ? ? ?",
    "* thorme  3.1.7 ) . )",
    "if @xmath177 is @xmath0-torsion free , then @xmath3 is @xmath0-potent for all odd primes @xmath0 ( by corollary  [ cor : phi_n ] ) , but not in general for @xmath267 .",
    "however , assuming that both @xmath351 and @xmath352 are @xmath34-torsion free ensures that @xmath3 always has a fully characteristic subgroup ( of @xmath34-power - index if @xmath3 is finitely generated ) carrying a @xmath34-potent filtration .",
    "more precisely , and more generally :    [ lem:2-potent ] let @xmath353 , where @xmath354 , and for @xmath65 define @xmath355 .",
    "then @xmath356 is a strongly central @xmath0-filtration of @xmath357 , and for every @xmath65 , the map @xmath358 induces a group morphism @xmath359 . if @xmath360 is @xmath0-torsion free for @xmath361 , then @xmath144 is @xmath0-potent .",
    "if @xmath360 is @xmath0-torsion free for every @xmath65 , then @xmath144 is strongly @xmath0-potent .",
    "it is clear that @xmath144 is a strongly central @xmath0-filtration of @xmath357 ( cf .",
    "proposition  [ prop : lower p ] ) . by corollary  [ cor : phi_n ]",
    ", @xmath358 induces a group morphism @xmath359 .",
    "the rest follows from lemma  [ lem : phin injective ] .",
    "we are mainly interested in this lemma when @xmath3 is free , in which case @xmath360 actually is torsion free for every @xmath65 .",
    "we note that the assumption that @xmath360 is torsion free for every @xmath65 is also satisfied in other interesting situations , e.g. , for primitive @xmath163-relator groups @xcite , such as surface groups , and primitive link groups ( * ? ? ?",
    "* theorems  2 and 1 ) .      in this section",
    "we summarize some basic definitions and facts concerning graphs of groups and their fundamental groups .",
    "we refer to @xcite for missing details .      a _ graph _ @xmath362 consists of a set @xmath363 of _ vertices _ and a set @xmath364 of _ edges _ , and two maps @xmath365 and @xmath366 , subject to the following condition : for each @xmath367 we have @xmath368 , @xmath369 , and @xmath370 .",
    "we call @xmath370 and @xmath371 the _ origin _ respectively the _ terminus _ of @xmath372 . the edge @xmath373",
    "is called the _ inverse edge _ of @xmath372 .",
    "we call the set @xmath374 a _ topological edge _ of @xmath362 .    given a graph @xmath362 as above , a _",
    "subgraph of @xmath362 _ is a graph @xmath375 whose vertex and edge sets @xmath376 and @xmath377 are subsets of @xmath378 respectively @xmath379 such that @xmath380 and @xmath381 for all @xmath382 , and such that the maps @xmath383 , @xmath384 and @xmath385 on @xmath375 are the restrictions of the corresponding maps from @xmath379 to @xmath377 . if @xmath386 is a vertex of  @xmath362 we denote by @xmath387 the subgraph of @xmath362 with vertex set @xmath388 and edge set @xmath389 .",
    "similarly , if @xmath390 we denote by @xmath391 the subgraph of @xmath362 with vertex set @xmath378 and edge set @xmath392 .    given graphs @xmath362 ,",
    "@xmath375 , a morphism @xmath393 consists of two maps @xmath394 and @xmath395 , both also denoted by @xmath396 , with the property that @xmath397 we say that a morphism @xmath398 is an embedding if the corresponding maps @xmath399 and @xmath395 are injective .",
    "if @xmath362 is a subgraph of @xmath375 , then the natural inclusions @xmath399 and @xmath395 form an embedding @xmath398 .    let @xmath362 be a graph , and let @xmath379 denote a subset of the edge set @xmath400 of @xmath362 which is closed under taking inverses .",
    "an _ orientation _ of @xmath379 is a subset @xmath401 of @xmath379 such that @xmath379 is the disjoint union of @xmath401 and @xmath402 . by an orientation of @xmath362",
    "we mean an orientation of @xmath400 .",
    "an _ oriented graph _ is a graph together with one of its orientations . given two sets @xmath378 and @xmath401 and a map @xmath403 there exists ( up to isomorphism ) a unique graph @xmath362 with vertex set @xmath378 such that  @xmath401 is an orientation of @xmath362 and such that the origin and terminus maps on @xmath401 are given by @xmath383 and @xmath384 respectively .",
    "( the set of edges of @xmath362 is the disjoint union @xmath404 where @xmath402 is a copy of @xmath401 . )",
    "note that given graphs @xmath362 and @xmath375 and an orientation @xmath401 of @xmath362 , in order to specify a morphism @xmath398 it suffices to give maps @xmath399 and @xmath405 , both here denoted by @xmath396 , such that @xmath406 and @xmath407 for all @xmath408 .",
    "let @xmath409 denote the graph with vertex set @xmath410 and orientation given by @xmath411 with @xmath412 , @xmath413 .",
    "a _ path _ of length @xmath20 in the graph @xmath362 from a vertex @xmath414 to a vertex @xmath415 is a morphism @xmath416 such that @xmath417 and @xmath418 .",
    "such a path @xmath0 is determined by the sequence @xmath419 of edges @xmath420 with @xmath421 , @xmath422 for @xmath423 , and @xmath424 ; we also write @xmath425 .",
    "a _ circuit _ of length @xmath20 in @xmath362 ( where @xmath426 ) is a path @xmath427 such that the vertices @xmath428 are pairwise distinct , and @xmath429 .",
    "a _ tree _ is a graph which is connected ( for all vertices @xmath74 , @xmath430 there is a path from @xmath74 to @xmath430 ) and without circuits . if @xmath362 is a tree , then for any pair @xmath431 of vertices of @xmath362 there exists a unique path of shortest length from @xmath74 to @xmath430 , called the _ geodesic _ from @xmath74 to @xmath430 in @xmath362 .    _ in the rest of this paper , unless otherwise noted , we assume that all graphs are finite i.e. , their vertex sets and edge sets are finite and connected",
    ". _      let @xmath362 be a graph .",
    "a _ graph @xmath151 of groups based on @xmath362 _ consists of families @xmath432 and @xmath433 of groups satisfying @xmath434 for every @xmath435 , together with a family @xmath436 of group embeddings @xmath437 ( @xmath435 ) .",
    "( we also call @xmath362 the _ underlying graph _ of @xmath31 . )",
    "let @xmath31 be a graph of groups based on a graph @xmath362 .",
    "we recall the construction of the fundamental group @xmath54 of @xmath31 from ( * ? ? ?",
    "* i.5.1 ) .",
    "first , consider the group @xmath438 ( the _ path group _ of @xmath31 ) generated by the groups @xmath35 ( @xmath439 ) and the elements @xmath435 subject to the relations @xmath440 by a _ path _ of length @xmath20 in @xmath31 from a vertex @xmath414 to a vertex @xmath415 we mean a sequence @xmath441 where @xmath419 is a path of length @xmath20 in @xmath362 from @xmath74 to @xmath430 and where @xmath442 for @xmath443 , with @xmath444 and @xmath445 for @xmath446 .",
    "if @xmath447 for every @xmath258 then @xmath231 is called an _",
    "edge path_. we say that the path @xmath231 _ represents _ the element @xmath448 of @xmath438 .",
    "such a path @xmath231 in @xmath31 is _ reduced _ if it satisfies the following conditions :    1 .   if @xmath449 then @xmath450 ; 2 .",
    "if @xmath426 then @xmath451 for each index @xmath258 such that @xmath452 .",
    "it is easy to see that every @xmath5 in @xmath438 is represented by a reduced path in @xmath31 ( namely , a path of minimal length representing @xmath453 ) .",
    "conversely , if @xmath453 is represented by a reduced path in @xmath31 , then @xmath5 ( * ? ? ?",
    "* i.5.2 , theorem  11 ) .",
    "in particular , the natural morphisms @xmath454 are injective ( * ? ? ?",
    "* i.5.2 , corollary  1 ) .",
    "let now @xmath386 be a fixed vertex of @xmath362 .",
    "the fundamental group @xmath455 of @xmath31 ( with base point @xmath386 ) is defined to be the subgroup of @xmath438 consisting of the elements represented by paths in @xmath31 from @xmath386 back to itself .",
    "if @xmath456 is another base point , and @xmath453 is an element of @xmath438 represented by a path from @xmath386 to @xmath457 , then @xmath458 is an isomorphism ; by abuse of notation we write  @xmath30 to denote @xmath455 if the particular choice of base point is irrelevant . given a subgraph @xmath375 of @xmath362 ,",
    "we denote by @xmath459 the restriction of the graph of groups  @xmath31 to @xmath375 , defined in the obvious way ; given a base point @xmath460 , the natural inclusion @xmath461 induces an injective morphism @xmath462 ( * ? ? ?",
    "* corollary  1.14 ) .",
    "an alternative description of @xmath455 , which is often useful , is as follows : let  @xmath79 be a maximal subtree of @xmath362 .",
    "the fundamental group @xmath463 of @xmath31 relative to @xmath79 is defined by contracting @xmath79 to a point : @xmath464 the natural projection @xmath465 restricts to an isomorphism @xmath466 , cf .",
    "* i.5.1 , proposition  20 ) .",
    "identifying @xmath455 with @xmath463 via this isomorphism , for each @xmath414 we obtain a group morphism @xmath467 .",
    "this group morphism is injective and given by @xmath468 where @xmath469 is represented by the reduced edge path in @xmath470 from @xmath386 to @xmath74 .",
    "we often tacitly identify the vertex groups @xmath35 with subgroups of @xmath455 in this way .",
    "this depends on the choice of maximal subtree @xmath79 of @xmath362 , but for a different choice of @xmath79 we obtain a conjugate subgroup of @xmath455 , so this dependence is generally harmless .    for every @xmath435 let @xmath471 and let @xmath472 .",
    "fix an orientation @xmath401 of @xmath379 .",
    "the identification of @xmath473 with @xmath463 means that @xmath3 may be described as the iterated hnn extension @xmath474 of @xmath475 , where the latter group is itself an iterated amalgamated product ( of the vertex groups of @xmath470 , with identifications @xmath476 for @xmath477 , @xmath478 ) .",
    "let @xmath362 be a graph , @xmath363 , @xmath364 .",
    "a _ graph of based cw - complexes _",
    "@xmath479 with underlying graph @xmath362 consists of a collection of connected cw - complexes @xmath480 and @xmath481 such that @xmath482 for every @xmath367 together with a collection @xmath483 of cellular embeddings .",
    "furthermore we require a choice of base points for each @xmath484 ( @xmath367 ) and @xmath485 ( @xmath414 ) , with @xmath484 and @xmath486 being assigned the same base point , and for each @xmath367 a choice of path in @xmath487 connecting the base points of @xmath488 and @xmath487 .",
    "finally we demand that the following hold :    for each @xmath367 the map @xmath489 induces an embedding @xmath490 of groups ( henceforth also denoted by @xmath489 ) ;    given @xmath414 the images of the maps @xmath491 with @xmath492 are disjoint ; and    given @xmath414 the set @xmath493 is non - empty .",
    "( conditions ( 2 ) and ( 3 ) can always be achieved by attaching products , without changing the homotopy types of the complexes @xmath485 and @xmath484 ) .",
    "let @xmath479 be a graph of based cw - complexes with underlying graph @xmath362 .",
    "the _ topological realization _ of @xmath479 is the following cw - complex : @xmath494 \\right ) \\bigg/ \\sim \\qquad \\text{(disjoint union)}\\ ] ] where for @xmath495 we set @xmath496 and for @xmath497 $ ] we set @xmath498 $ ] .",
    "note that we have canonical inclusion maps of @xmath485 and @xmath499 into @xmath500 .",
    "we identify @xmath485 and @xmath501 with their images in @xmath500 .",
    "the collections @xmath502 and @xmath503 together with the group embeddings @xmath504 form a graph of groups based on @xmath362 , whose fundamental group ( as defined above ) is naturally isomorphic to the fundamental group of the topological space @xmath505 ; see ( * ? ? ?",
    "* theorem  2.1 ) .",
    "conversely , every graph of groups @xmath31 based on @xmath362 gives rise to a graph @xmath479 of based cw - complexes with underlying graph @xmath362 such that @xmath506 , @xmath507 , and with the embeddings @xmath508 inducing the edge morphisms @xmath437 of @xmath31 .",
    "( by choosing for each @xmath485 and @xmath484 classifying spaces @xmath509 respectively @xmath510 . )",
    "let now @xmath31 and @xmath511 be graphs of groups , based on the graphs @xmath362 respectively @xmath375 .",
    "a _ morphism _ @xmath512 of graphs of groups consists of the following data : a morphism @xmath398 of graphs , also denoted by @xmath396 ; families of group morphisms @xmath513 and families of elements @xmath514 and @xmath515 of @xmath516 , satisfying the following conditions , with @xmath74 ranging over @xmath517 and @xmath372 over @xmath400 :    1 .",
    "@xmath518 ; 2 .",
    "@xmath519 ; 3 .",
    "for @xmath520 we have @xmath521 , and 4 .   the diagram @xmath522^{{\\operatorname{ad}}(\\delta_e)\\circ f'_{\\phi(e ) } } & g'_{\\phi(v ) } \\\\",
    "g_e \\ar[u]^{\\phi_e } \\ar[r]^{f_e } & g_{v } \\ar[u]^{\\phi_{v } } } \\end{split}\\ ] ] commutes . here , given a group @xmath3 and @xmath523",
    ", @xmath524 denotes the inner automorphism @xmath525 of @xmath3 .",
    "every such morphism of graphs of groups as above induces a group morphism @xmath526 between path groups satisfying @xmath527 given a base point @xmath528 for @xmath529 and taking the base point @xmath530 for @xmath531 , this morphism restricts to a morphism @xmath532 .",
    "* proposition  2.4 ) . ) given an integer @xmath533 we say that @xmath396 has degree @xmath343 if @xmath534=d$ ] .",
    "every finite index subgroup of the fundamental group of a graph of groups arises in this way :    [ thm : bass - serre ] let @xmath31 be a graph of groups with underlying graph @xmath362 , and let  @xmath7 be a finite index subgroup of @xmath54 .",
    "then there exists a graph of groups @xmath535 and a morphism @xmath536 such that @xmath537 is injective with image @xmath7 .",
    "this may be seen as a consequence of the main structure theorem of the bass - serre theory of groups acting on trees ( cf .",
    "* section  4 ) ) .",
    "alternatively , one may employ the topological interpretation of @xmath30 sketched in section  [ sec : morphisms of graphs of groups ] ( cf .",
    "@xcite ) : if @xmath479 is a graph of based cw - complexes based on a graph @xmath362 , with topological realization @xmath538 , and @xmath539 is a finite covering map , then @xmath540 is in a natural way the topological realization of a graph of based cw - complexes @xmath541 : the vertex spaces of @xmath541 are given by the components of @xmath542 , @xmath439 , and the edge spaces of @xmath541 are given by the components of @xmath543 , @xmath435 .",
    "let @xmath544 be the underlying graph of @xmath541 ; the covering map @xmath545 induces a morphism of graphs @xmath546 which we also denote by @xmath247 .",
    "the edge spaces and vertex spaces of @xmath541 are then endowed with base points covering the base points of @xmath479 ; and for @xmath547 , @xmath548 , we pick a path connecting the base points of @xmath549 and @xmath550 .",
    "this data gives rise to a morphism @xmath551 between the graphs of groups @xmath552 and @xmath31 associated to @xmath553 respectively @xmath479 such that @xmath554 agrees with the group morphism @xmath555 induced by @xmath247 .    in the context of the previous theorem , one can choose the vertex groups of @xmath535 to be @xmath556 , where @xmath74 ranges over the vertices of @xmath362 and @xmath453 over a suitable set of @xmath557-double coset representatives , and the edge groups to be @xmath558 , where @xmath372 ranges over the edges of @xmath362 and @xmath453 over a suitable set of @xmath559-double coset representatives ( * ? ? ?",
    "* section  8.5 , theorem  27 ) .",
    "in particular , if @xmath7 is a _",
    "normal _ subgroup of @xmath3 , then one can choose @xmath535 such that its vertex groups are of the form @xmath560 , and its edge groups of the form @xmath561 .",
    "let @xmath31 , @xmath511 be graphs of groups based on the graphs @xmath362 , @xmath375 , respectively .",
    "then @xmath511 is a _ subgraph of subgroups _ of @xmath31 if    1 .",
    "@xmath375 is a subgraph of @xmath362 ; 2 .",
    "@xmath562 for each @xmath563 ; 3 .",
    "@xmath564 and @xmath565 for each @xmath382 ; 4 .",
    "@xmath566 for all @xmath382 , @xmath520 .    in this case , the natural inclusions @xmath567 ( @xmath563 ) and",
    "@xmath568 ( @xmath382 ) form a morphism @xmath569 of graphs of groups , and given @xmath460 , the induced morphism @xmath570 is injective ( * ? ? ?",
    "* corollary  1.14 ) .",
    "we say that a subgraph of subgroups @xmath511 of @xmath31 is _ normal _ if @xmath571 for each @xmath563 .",
    "( then @xmath572 for each @xmath382 by condition ( 4 ) . )",
    "for example , given a subgraph @xmath375 of @xmath362 , the graph of groups @xmath459 is a normal subgraph of subgroups of @xmath31 .    a subgraph of subgroups @xmath511 of @xmath31 is called a _ graph of subgroups _ of @xmath31 if the underlying graph @xmath375 of @xmath511 is the same as the underlying graph @xmath362 of @xmath31 .",
    "let @xmath511 be a normal graph of subgroups of @xmath31 .",
    "then we obtain a graph of groups based on the graph @xmath362 , which we denote by @xmath573 , with vertex groups @xmath574 ( @xmath439 ) , edge groups @xmath575 and edge morphisms @xmath576 induced by @xmath489 @xmath577 ) .",
    "the natural surjections @xmath578 and @xmath579 yield a morphism @xmath580 of graphs of groups , which in turn yields a group morphism @xmath581 , which we denote by @xmath582 .    a graph of subgroups of @xmath31 is completely determined by its family of vertex groups : suppose we are given a family @xmath583 of subgroups @xmath562 ( @xmath439 ) which is _ compatible _ in the sense that @xmath584 then there is a unique graph of subgroups of @xmath31 with vertex groups @xmath585 , which we continue to denote by the same symbol @xmath511 .",
    "( in particular , we may write @xmath586 . )",
    "let @xmath7 be a normal subgroup of @xmath54 .",
    "then the collection @xmath587 of normal subgroups is compatible ; moreover , there is a unique morphism @xmath588 such that the diagram @xmath589_{\\pi_{\\scrh}}\\ar[dr]^{\\text{natural projection } } \\\\",
    "\\pi_1(\\scrg/\\scrh )   \\ar[rr ] & & g / h}\\ ] ] commutes .",
    "[ prop : commoncover ] let @xmath590 be a compatible collection of finite index normal subgroups of @xmath31 .",
    "then there exists a graph of groups @xmath552 based on a graph @xmath544 and a morphism @xmath551 with the following properties :    1 .",
    "@xmath396 has finite degree ; 2 .   for each @xmath591",
    ", @xmath592 is an isomorphism @xmath593 ; 3 .   for each @xmath547",
    ", @xmath594 is an isomorphism @xmath595 .",
    "this is sketched in ( * ? ? ?",
    "* theorem  2.2 ) ; for the convenience of the reader , we give a proof .",
    "we employ covering space theory .",
    "thus , let @xmath479 be a graph of based cw - complexes based on @xmath362 , with topological realization @xmath505 , such that @xmath596 , as described in section  [ sec : graphs of cw - complexes ] . the collections @xmath597 and @xmath598 of subgroups of the vertex respectively edge groups of @xmath31 give rise to collections @xmath599 of coverings of the vertex respectively edge spaces of @xmath479 which are also compatible in the following sense :    for each @xmath435 we have @xmath600 , and    for each @xmath435 and for each component @xmath601 of @xmath602 there exists an embedding @xmath603 with image @xmath601 which covers @xmath491 .",
    "we will show that the various covering spaces can be glued together to give a connected covering @xmath539 such that    for each @xmath439 and each component @xmath604 of @xmath542 the covering @xmath605 corresponds to @xmath606 , and    for each @xmath435 and each component @xmath607 of @xmath543 the covering @xmath608 corresponds to @xmath609 .",
    "then every morphism of graph of groups @xmath610 associated to @xmath247 as in section  [ sec : graphs of cw - complexes ] has the required properties .",
    "we proceed by induction on the number of topological edges of @xmath362 .",
    "the case where @xmath362 has no topological edge ( and hence only one vertex ) being obvious , let us first consider the case that the graph @xmath362 has a single topological edge @xmath374 and hence either one or two vertices .",
    "first assume that @xmath362 has a single vertex @xmath74 .",
    "in that case @xmath611 and @xmath612 have the same number @xmath20 of components .",
    "matching up these components in pairs and connecting them via @xmath20 copies of @xmath607 , the resulting complex @xmath540 has the desired property .",
    "now assume @xmath362 has two distinct vertices @xmath457 and @xmath613 such that @xmath614 and @xmath615 . let @xmath616 be the number of components of @xmath617 , for @xmath618 .",
    "we get the cover @xmath619 by taking @xmath620 copies of @xmath621 and @xmath622 copies of @xmath623 and by connecting each copy of a component of @xmath624 with a copy of a component of @xmath625 via a copy of @xmath607 .",
    "we now turn to the case of graphs with more than one topological edge .",
    "since  @xmath362 is connected , either there is an edge @xmath372 such that the graph @xmath626 obtained by deleting the edge @xmath372 from @xmath362 is connected , or there is an edge @xmath372 such that one of the components of @xmath627 consists of a single vertex with no topological edge .",
    "first consider the case that we have an edge @xmath372 such that @xmath628 is connected .",
    "we denote by @xmath629 the subgraph of based cw - complexes of @xmath479 with underlying graph @xmath375 , and write @xmath630 .",
    "we identify @xmath631 with a topological subspace of @xmath632 in the natural way . by inductive hypothesis",
    "there exists a covering @xmath633 with the desired properties .",
    "we now consider the graph of cw - complexes @xmath634 whose underlying graph has a single vertex @xmath430 and a single topological edge @xmath635 , vertex space @xmath636 , edge spaces @xmath637 , and edge maps @xmath638 , @xmath639 given by @xmath640 respectively @xmath641 .",
    "writing @xmath642 we note that @xmath643 .",
    "clearly the finite index subgroup @xmath644 of @xmath645 forms a compatible collection of subgroups ( of the graphs of groups associated to @xmath634 ) .",
    "since we already showed that the conclusion of the proposition holds for graphs with one edge we now get a cover @xmath646 which has the desired properties .    a similar argument deals with the case that we have an edge @xmath372 such that one component of @xmath647 consists of a single vertex with no topological edge .    1",
    "assume that the indices of the normal subgroups @xmath648 are powers of  @xmath0 .",
    "in that case the indices of the normal subgroups @xmath649 are powers of  @xmath0 . with the notation introduced in the proof above we have @xmath650}{[g_e : h_e ] } \\text { and }    n_i=\\frac{[g_{v_i}:h_{v_i}]}{[g_e : h_e ] } \\text { for $ i=1,2$.}\\ ] ] in particular @xmath20 , @xmath651 and @xmath652 are powers of @xmath0 .",
    "it is now clear that the degree of the cover @xmath539 ( and hence the degree of the associated morphism @xmath610 of graphs of groups ) constructed in the proof is a power of @xmath0 .",
    "2 .   there is no guarantee that the resulting cover constructed in the proof will be regular ( i.e. , that @xmath653 will be a normal subgroup of @xmath30 ) .",
    "let @xmath31 be a graph of groups with underlying graph @xmath362 .",
    "we say that a collection @xmath654 of filtrations @xmath655 of @xmath35 ( one for each vertex @xmath74 ) is a _ filtration _ of @xmath31 if for each @xmath65 , the collection @xmath656 of subgroups of the vertex groups is compatible .",
    "let @xmath654 be a filtration of @xmath31 .",
    "then for each @xmath435 we obtain a filtration @xmath657 of @xmath55 where @xmath658 for every @xmath65 .",
    "note that @xmath489 is a morphism @xmath659 of filtered groups , and @xmath660 for all @xmath435 .",
    "suppose that @xmath111 is normal ( i.e. , each @xmath63 is normal ) .",
    "then for each @xmath65 we have three graphs of groups with same underlying graph @xmath362 associated to @xmath31 :    1 .",
    "the graph of subgroups @xmath661 of @xmath31 ; 2 .",
    "the quotient graph of groups @xmath662 associated to @xmath661 , with vertex groups @xmath70 , edge groups @xmath663 and edge morphisms @xmath664 induced by @xmath489 ; and 3 .   the graph @xmath665 , whose vertex and edge groups are the @xmath20th layers @xmath666 of @xmath63 respectively @xmath667 of @xmath668 , and with the morphisms @xmath669 induced by @xmath489 as the edge morphisms .",
    "we say that another filtration @xmath670 of @xmath31 is a _",
    "compatible stretching _ of @xmath111 if the filtrations @xmath671 , as @xmath74 ranges over @xmath517 , form a compatible collection of stretchings of the @xmath63 as defined in section  [ subsec : filtrations ] above .",
    "note that in this situation , for each @xmath65 , either every vertex group of @xmath672 is trivial , or @xmath673 for some @xmath260 .",
    "given a property @xmath2 of filtrations , we say that @xmath111 has the property @xmath2 if @xmath63 has @xmath2 for each @xmath439 .",
    "for example , we say that @xmath111 is separating if for each @xmath439 , the filtration @xmath63 of @xmath35 is separating : @xmath674 .",
    "we also say that _",
    "@xmath111 separates the edge groups of @xmath31 _ if for each @xmath435 and @xmath520 , the filtration @xmath63 of @xmath35 separates @xmath675 : @xmath676 .    in the next lemmas ,",
    "let @xmath677 be a morphism of graph of groups .",
    "[ lem : morphisms and filtrations , 1 ] let @xmath678 be a compatible collection of normal subgroups of @xmath511 . then @xmath679 is a compatible collection of normal subgroups of @xmath31 .",
    "the proof of this lemma is a routine verification , using the diagram ( left to the reader ) . in the rest of this section",
    "let @xmath680 be a normal filtration of @xmath511 .",
    "then @xmath681 is a normal filtration of @xmath31 , by lemma  [ lem : morphisms and filtrations , 1 ] , and if @xmath680 is central , a @xmath0-filtration , or @xmath0-potent , then clearly @xmath682 also has the respective property .",
    "[ lem : separating , 1 ] suppose each @xmath683 is injective",
    ". then    1 .   if @xmath680 is separating , then @xmath682 is separating ; 2 .",
    "if each @xmath684 is bijective and @xmath680 separates the edge groups of @xmath511 , then @xmath682 separates the edge groups of @xmath31 ; 3 .",
    "if each @xmath684 maps @xmath55 isomorphically onto the first group @xmath685 in the filtration @xmath686 of @xmath687 , and @xmath680 separates the edge groups of @xmath511 , then @xmath682 separates the edge groups of @xmath31 .",
    "if @xmath680 is separating , then @xmath688 for each @xmath74 , hence @xmath682 is separating .",
    "for each @xmath372 and @xmath520 , denoting by @xmath689 the inverse of @xmath683 , by we also have @xmath690 assume now that each @xmath684 is bijective and @xmath680 separates the edge groups of @xmath511 .",
    "then for all @xmath372 and @xmath520 , we have @xmath691 hence @xmath682 separates the edge groups of @xmath31 .",
    "this shows ( 2 ) .",
    "part ( 3 ) is proved in a similar way .    in the next lemmas",
    "we fix @xmath435 , and write @xmath520 , @xmath692 , @xmath693 .",
    "[ lem : separating , 2 ] suppose that for each @xmath65 , the morphism @xmath684 restricts to an isomorphism @xmath694 , and @xmath695 is a uniformly @xmath0-potent filtration of  @xmath696 .",
    "then @xmath697 is a uniformly @xmath0-potent filtration of @xmath675 .",
    "note that the hypothesis that @xmath695 be uniformly @xmath0-potent is equivalent to the filtration @xmath698 of @xmath699 being uniformly @xmath0-potent , and that it is enough to show that @xmath700 is a uniformly @xmath0-potent filtration of @xmath55 .",
    "now by assumption , @xmath684 induces isomorphisms @xmath701 , for each @xmath65 .",
    "hence for each @xmath65 , @xmath358 yields a surjective group morphism @xmath702 whose kernel equals @xmath703 , as required .",
    "the following two lemmas are not used until section  [ sec : mod p homology graph ] , and may be skipped upon first reading .",
    "[ lem : separating , 3 ] suppose @xmath683 is injective and @xmath684 is bijective , and @xmath260 such that @xmath704 then @xmath705    note that @xmath706 and , since @xmath684 is bijective : @xmath707 hence for @xmath708 : @xmath709 since @xmath683 is injective , this yields @xmath710 the lemma follows , since @xmath711 is the fastest descending central @xmath0-filtration of  @xmath675 .",
    "[ lem : separating , 4 ] suppose @xmath55 is abelian , @xmath683 is injective , @xmath684 maps @xmath55 isomorphically onto the first group @xmath712 in the filtration @xmath713 of @xmath699 , and @xmath714 such that @xmath715 then @xmath716    as in the proof of the previous lemma , it suffices to show that @xmath717 let @xmath65 . by hypothesis @xmath718",
    "since @xmath699 is abelian and @xmath719 , we have @xmath720 and thus @xmath721 as required .",
    "let @xmath31 be a graph of groups with fundamental group @xmath54 .",
    "let @xmath401 be an orientation of the underlying graph @xmath362 of @xmath31 .",
    "then for each @xmath3-module @xmath722 , there is an exact sequence @xmath723 where each morphism @xmath724 occurring in this sequence is induced by the inclusion @xmath725 , and each composition @xmath726 where @xmath727 denotes the natural projection onto @xmath728 , is given by @xmath729 ( respectively @xmath730 ) if @xmath520 ( respectively @xmath731 ) , and is @xmath732 otherwise .",
    "@xcite or ( * ? ? ?",
    "* section  ii.2.8 ) . )",
    "dually , there is also a mayer - vietoris sequence in cohomology , which we wo nt formulate explicitly here .",
    "in this chapter we consider two types of embedding theorems for @xmath0-groups : one for amalgamating ( filtered ) @xmath0-groups , and one for extending partial automorphisms between subgroups of a given @xmath0-group to inner automorphisms of a larger @xmath0-group .",
    "these results will be basic for establishing in the next chapter that certain fundamental groups of graphs of groups are ( virtually ) residually @xmath0 .",
    "an _ amalgam _ of groups consists of a pair @xmath733 of groups with a common subgroup  @xmath734 ; notation : @xmath735 .",
    "an _ embedding _ of an amalgam @xmath735 into a group  @xmath736 is a pair @xmath737 consisting of injective group morphisms @xmath738 , @xmath739 such that @xmath740 .",
    "( figure  [ fig : embedding ] . )",
    "@xmath741^{\\alpha } &   & h \\ar@{.>}[ul]_{\\beta}\\\\ & \\ar[ul ]   u   \\ar[ur ] & } \\ ] ]    such an embedding of @xmath735 into @xmath736 is said to be _ strong _ if in addition @xmath742 .",
    "the following is a variant of a theorem of higman @xcite .",
    "the equivalences of ( 1)(4 ) may also be deduced from ( * ? ? ? * theorem  2 ) ; for our application in section  [ sec : a reduction theorem ] , we are mostly interested in the addendum .    [ thm : higman ]",
    "let @xmath735 be an amalgam of @xmath0-groups .",
    "the following are equivalent :    1 .",
    "@xmath735 is strongly embeddable into a @xmath0-group .",
    "2 .   @xmath735 is embeddable into a @xmath0-group .",
    "3 .   there exist finite - length chief filtrations of @xmath3 and @xmath7 inducing the same filtration of @xmath734 .",
    "4 .   there exist finite - length central @xmath0-filtrations @xmath111 of @xmath3 and @xmath125 of @xmath7 inducing the same filtration of @xmath734 .",
    "moreover , if we are given @xmath111 and @xmath125 as in , then there exists a strong embedding  @xmath737 of @xmath735 into a @xmath0-group @xmath736 and a central @xmath0-filtration @xmath743 of @xmath736 of finite length which induces @xmath744 on @xmath745 and @xmath746 on @xmath747 .",
    "note that the implication `` ( 1 )  @xmath332  ( 2 ) '' is trivial .",
    "if @xmath736 is a @xmath0-group containing both @xmath3 and @xmath7 as subgroups , then any chief filtration of @xmath736 induces a chief filtration on @xmath3 and a chief filtration on @xmath7 .",
    "this shows `` ( 2 )  @xmath332  ( 3 ) '' , and `` ( 3 )  @xmath332  ( 4 ) '' follows from the fact that each chief filtration of a @xmath0-group is a central @xmath0-filtration .",
    "hence it remains to give the proof of `` ( 4 )  @xmath332  ( 1 ) '' in the stronger formulation given in the `` moreover '' part .",
    "the class of _ elementary abelian _ @xmath0-groups has the ( strong ) amalgamation property , i.e. : every amalgam of elementary abelian @xmath0-groups @xmath735 always admits a strong embedding into an elementary abelian @xmath0-group @xmath736 . somewhat more generally , let @xmath3 and @xmath7 be abelian groups ( written additively ) , and let @xmath748 , @xmath749 be injective morphisms from a group @xmath734 to @xmath3 respectively @xmath7 .",
    "then @xmath750 is a subgroup of @xmath751 , and @xmath752 is called the fiber sum of @xmath3 and @xmath7 over @xmath734 ( via @xmath119 , @xmath90 ) .",
    "it is easy to check that the natural morphisms @xmath753 and @xmath754 are injective .",
    "the fiber sum @xmath755 is the solution to an universal problem : it is the push - out , in the category of abelian groups , of the diagram @xmath756 .",
    "( in connection with this construction it is interesting to note that no varieties of groups other than the variety of all groups and varieties of abelian groups are known to have the amalgamation property ; cf .  @xcite . )",
    "let now @xmath735 be an amalgam of @xmath0-groups and @xmath757 and @xmath758 be central @xmath0-filtrations of @xmath3 respectively @xmath7 as in . for showing the rest of theorem  [ thm : higman ] , after refining @xmath111 and @xmath125 suitably",
    ", we may assume that @xmath759 .",
    "( lemma  [ lem : refine ] . ) in this case , we actually have a more precise result :    [ prop : higman , more precise ] let @xmath735 be an amalgam of @xmath0-groups , and suppose @xmath111 and  @xmath125 are finite - length central @xmath0-filtrations of @xmath3 respectively @xmath7 which intersect to the same filtration of @xmath734",
    ". then there exists a @xmath0-group @xmath736 containing both @xmath3 and  @xmath7 as subgroups , with @xmath760 , a finite - length central @xmath0-filtration @xmath761 of @xmath736 , as well as compatible stretchings @xmath149 of @xmath111 respectively @xmath762 of @xmath125 , with the following properties :    * @xmath763 and @xmath764 ; * for each @xmath765 , identifying @xmath766 and @xmath767 with subgroups of @xmath768 in the natural way , and similarly @xmath769 with subgroups of @xmath766 and @xmath767 , where @xmath770 , we have @xmath771 hence @xmath768 embeds @xmath772 in a natural way .",
    "the remainder of this section is occupied by the proof of this proposition .",
    "the main idea of the argument is to apply the fiber sum construction inductively to the layers of the given filtrations @xmath111 and @xmath125 .",
    "before we can carry this out , we need some preliminary observations on group algebras , wreath products , and a construction of central filtrations on semidirect products .",
    "let @xmath51 be a commutative ring and @xmath3 be a group , and let @xmath773 $ ] be the group algebra of @xmath3 over @xmath51 .",
    "( as a general reference for group algebras we use @xcite .",
    ")    the _ augmentation ideal _ of @xmath773 $ ] is the kernel @xmath774)$ ] of the @xmath51-algebra morphism @xmath773\\to r$ ] given by @xmath775 for every @xmath4 .",
    "( here and below , `` ideal '' will always mean `` two - sided ideal '' unless noted otherwise . )",
    "it is easy to see ( cf .",
    "* lemma  3.1.1 ) ) that @xmath776(1-g).\\ ] ] note that if @xmath51 has characteristic @xmath0 , then @xmath773=r\\otimes_{\\f_p}\\f_p[g]$ ] and hence @xmath777)^n = r\\otimes_{\\f_p}\\omega(\\f_p[g])^n$ ] for every @xmath20 .",
    "given an ideal @xmath778 of @xmath773 $ ] we say that a descending sequence @xmath779 of ideals of @xmath773 $ ] satisfying @xmath780 and @xmath781 for all @xmath106 , @xmath20 is a _ filtration _ of @xmath778 .",
    "every strongly central filtration @xmath782 of @xmath3 gives rise to a filtration @xmath783 of the ideal @xmath784 as follows : for each @xmath4 define @xmath785 to be the largest @xmath786 for which @xmath787 , where we set @xmath788 .",
    "for each @xmath65 let @xmath789 be the left @xmath51-submodule of @xmath773 $ ] spanned by all products of the form @xmath790 for some @xmath106 with @xmath791 .",
    "it is easily seen that @xmath783 is a filtration of @xmath784 ; cf .",
    "conversely , let @xmath792 be a filtration of @xmath784",
    ". then we associate to @xmath783 a filtration @xmath180 of @xmath3 by setting @xmath793 if @xmath51 has characteristic @xmath0 , then @xmath180 is a dimensional @xmath0-filtration of @xmath3 ; cf .",
    "* lemma  3.3.2 ) .",
    "in particular , taking @xmath794 for every @xmath20 , we obtain a corresponding dimensional @xmath0-filtration of @xmath3 .",
    "in fact , this filtration turns out to be exactly the lower dimensional @xmath0-filtration @xmath204 of @xmath3 :    [ thm : jennings ] suppose @xmath51 is of characteristic @xmath0 and @xmath3 is a @xmath0-group .",
    "then @xmath795 moreover , the filtration of @xmath784 determined by @xmath204 is precisely @xmath796 , the powers of the augmentation ideal .",
    "the ideal @xmath784 is nilpotent of nilpotency class @xmath797    this theorem is due to jennings @xcite ; for a proof see ( * ? ? ?",
    "* theorems  3.3.6 and 3.3.7 ) .",
    "the _ nilpotency class _ of an ideal @xmath778 of @xmath773 $ ] is the smallest @xmath533 , if it exists , such that @xmath798 . by the theorem ,",
    "the nilpotency class of @xmath784 is an upper bound on the lower @xmath0-length ( and hence the nilpotency class ) of @xmath3 .",
    "we denote by @xmath799 the left annihilator of @xmath784 ( a left ideal of @xmath773 $ ] ) .",
    "note that if @xmath800 then @xmath801 contains @xmath802 .",
    "if @xmath3 is finite we define @xmath803.\\ ] ] note that @xmath804 for all @xmath4 , hence @xmath805 is central in @xmath773 $ ] .",
    "it is easy to see that if @xmath3 is finite , then @xmath806 ; cf .",
    "* lemma  3.1.2 ) .",
    "the following observation is standard ( cf .",
    "@xcite ) :    suppose @xmath3 is a @xmath0-group , and @xmath51 is a field of characteristic @xmath0 .",
    "then every non - zero ideal @xmath778 of @xmath773 $ ] contains @xmath805 .",
    "let @xmath807 be an ideal of @xmath773 $ ] .",
    "the ideal @xmath784 is nilpotent , so we can choose an integer @xmath808 maximal with @xmath809 .",
    "then clearly @xmath810 and thus @xmath811 since @xmath51 is a field .",
    "applying this lemma to the prime field @xmath76 in place of @xmath51 and using that @xmath773=r\\otimes_{\\f_p } \\f_p[g]$ ] yields :    [ cor : hatg ] suppose @xmath3 is a @xmath0-group and @xmath812 .",
    "then @xmath813 where @xmath343 denotes the nilpotency class of @xmath784 .",
    "wreath products play an important role in the proof of the main result of @xcite , and so naturally also in the proof of theorem  [ thm : higman ] .",
    "we recall the definition : let @xmath538 , @xmath7 be groups .",
    "we turn the set @xmath814 of maps @xmath815 into a group under the coordinate - wise operations .",
    "we have a right action @xmath816 of @xmath7 on @xmath814 , given by @xmath817 the ( unrestricted ) _ wreath product _ of @xmath538 and @xmath7 is a semidirect product @xmath818 ; its underlying set is @xmath819 , with group operation @xmath820 the group @xmath814 is called the _ base group _ of @xmath821 .",
    "both @xmath814 and the group @xmath7 can be naturally identified with subgroups of @xmath821 .",
    "( note that then for every @xmath235 and @xmath822 the conjugate @xmath823 of @xmath824 by @xmath825 is conveniently given by @xmath826 . )",
    "if @xmath14 is a subgroup ( respectively normal subgroup ) of @xmath7 , then @xmath827 is a subgroup ( respectively normal subgroup ) of @xmath821 .",
    "note also that if @xmath538 is a subgroup of a group @xmath362 , then @xmath821 is a subgroup of @xmath828 .",
    "the wreath product @xmath821 contains a copy of every extension of @xmath7 by @xmath538 ( theorem of kaluzin - krasner ) : in fact , given a group morphism @xmath829 ( not necessarily surjective ) with kernel @xmath538 there always exists a map @xmath830 such that the map @xmath831 is an injective group morphism ( cf .",
    "the map @xmath832 is obtained as follows : one first chooses a _ countermap _ to @xmath833 , that is , a map @xmath834 ( not necessarily a group morphism ) such that @xmath835 or , in other words : @xmath836 such countermaps always exist : choose a system @xmath837 of right coset representatives of the subgroup @xmath838 of @xmath7 , and for @xmath235 denote the unique @xmath839 such that @xmath840 by @xmath841 . for every @xmath235 choose @xmath842 such that @xmath843 , and for each @xmath839 choose an arbitrary @xmath844 .",
    "then @xmath845 defines a countermap to @xmath833 .",
    "( so for example , if @xmath833 is surjective then every right inverse of @xmath833 is a countermap to @xmath833 . )",
    "now set @xmath846 note that @xmath847 indeed lies in @xmath848 , so @xmath849 is an element of @xmath814 . if we want to stress the dependence of @xmath832 on the choice of countermap @xmath850 , we write @xmath851 instead of @xmath849 .",
    "we call an embedding @xmath852 of the form @xmath853 a _ standard embedding _ of @xmath214 into @xmath821 .",
    "if in addition @xmath538 is given as a subgroup of a group @xmath362 , we also speak of the composition @xmath854 of a standard embedding @xmath852 with the natural inclusion @xmath855 as a _ standard embedding _ of @xmath214 into @xmath828 .    in the following",
    "let @xmath856 be the wreath product of the groups @xmath538 and @xmath7 .",
    "it is well - known ( cf .",
    "@xcite ) that if @xmath857 and @xmath7 is finite , then @xmath736 is nilpotent if and only if there is a prime @xmath0 such that @xmath538 is a nilpotent of finite @xmath0-power exponent and @xmath7 is a @xmath0-group .",
    "we are mostly interested in the case where the group @xmath7 is a @xmath0-group , and @xmath538 is an elementary abelian @xmath0-group , and hence may be construed as the additive group of a finite - dimensional @xmath76-algebra . somewhat more generally ,",
    "_ from now on we assume that @xmath538 is the additive group of a commutative ring @xmath51 and  @xmath7 is finite . _ below we simply denote @xmath538 by @xmath51 .",
    "we now can and will canonically identify the additive group of the group algebra @xmath858 $ ] of @xmath7 over @xmath51 with the base group @xmath859 of the wreath product @xmath860 .",
    "after this identification , the action of @xmath7 on @xmath859 is related to the action of @xmath7 by left multiplication on the group ring @xmath858 $ ] via @xmath861 $ , $ h\\in h$.}\\ ] ] ( to avoid confusion between the group operation in @xmath862 and the multiplication in the ring @xmath858 $ ] , we will always use a dot @xmath863 to denote the latter .",
    "we also reserve  @xmath824 , possibly with decorations , to denote elements of @xmath858 $ ] and @xmath825 for the elements of the subgroup @xmath7 of @xmath736 . )",
    "we therefore have the useful identity @xmath864 } [ f , h ] = ( h^{-1}-1)\\cdot f \\qquad ( f\\in r[h ] , h\\in h),\\ ] ] where the commutator @xmath865=f^{-1}h^{-1}fh$ ] is computed in @xmath736 and the right - hand side in the group algebra @xmath858 $ ]",
    ".    we let @xmath247 be the natural map @xmath866 $ ] , which is not a group morphism in general : in fact , for elements @xmath867 and @xmath868 of @xmath736 ( where @xmath869 , @xmath870 $ ] ) , we have @xmath871 for @xmath872 $ ] , @xmath235 , @xmath873 we obtain @xmath874 and for later use we also record that if in addition @xmath875 $ ] then @xmath876 multiplication @xmath877 in @xmath858 $ ] by a fixed element @xmath878 extends uniquely to an endomorphism of @xmath736 which is the identity on @xmath7 .",
    "we also note :    [ lem : fully inv ] let @xmath3 be a fully invariant subgroup of @xmath736",
    ". then @xmath879 $ ] is a left ideal of @xmath858 $ ] , with @xmath879=\\pi(g)$ ] .",
    "moreover , if @xmath837 is a generating set for @xmath3 , then @xmath880 generates the left ideal @xmath879 $ ] .",
    "clearly @xmath879 $ ] is an additive subgroup of @xmath858 $ ] contained in @xmath881 .",
    "the subgroup @xmath3 of @xmath736 being fully invariant implies that @xmath882)$ ] and thus @xmath879=\\pi(g)$ ] .",
    "since @xmath3 is fully invariant , @xmath879 $ ] is also closed under multiplication by elements from @xmath51 , and if @xmath883 $ ] and @xmath235 , then @xmath884 since @xmath3 is normal .",
    "hence @xmath879 $ ] is a left ideal of @xmath858 $ ] .",
    "now let @xmath837 be a generating set for @xmath3 .",
    "then @xmath881 clearly contains the left ideal @xmath885\\,\\pi(s)$ ] of @xmath858 $ ] generated by @xmath880 , and the identities and yield @xmath886 .    the following theorem due to buckley @xcite shows that there is a close relationship between the lower central series of the wreath product @xmath860 and the powers of the ideal @xmath887)$ ] of the group ring @xmath858 $ ] .",
    "for every @xmath20 we have @xmath888 = \\omega^n.\\ ] ]    since the proof of the theorem above given in @xcite is somewhat roundabout ( it is deduced from properties of polynomial functions on groups ) , we give a direct proof of a refinement valid in the situation of interest to us , namely , where @xmath812 .",
    "_ from now until the end of this subsection",
    "we therefore assume that  @xmath51 has characteristic @xmath0 .",
    "_    [ prop : buckley ] for all @xmath20 : @xmath889 = \\gamma^p_{n+1}(w)\\cap r[h ] =   \\gamma_{n+1}(w)\\cap r[h ] = \\omega^n.\\ ] ]    since @xmath890 it is enough to show that @xmath891 \\leq \\omega^n \\leq \\gamma_{n+1}(w)\\cap r[h].\\ ] ] we proceed by induction on @xmath20 , the case @xmath449 holding vacuously .",
    "suppose we have established for some @xmath20 .",
    "then for every @xmath892 and @xmath235 , by we have @xmath893\\in [ \\gamma_{n+1}(w),w]\\leq\\gamma_{n+2}(w).\\ ] ] lemma  [ lem : fully inv ] now yields @xmath894 $ ] . for the inclusion on the left in  , recall first that the subgroup @xmath895\\ ] ] of @xmath736 is fully invariant .",
    "thus by lemma  [ lem : fully inv ] it suffices to show the following claim , where we abbreviate @xmath896 :    suppose @xmath897 and @xmath898 $ ] are such that @xmath899 then @xmath900 \\big ) \\in \\omega^{n+1}.\\ ] ]    for the first part , we note that , writing @xmath901 , we have @xmath902 $ ] by lemma  [ lem : fully inv ] , and hence @xmath903 by inductive hypothesis .",
    "this yields @xmath904 and thus @xmath905 .",
    "we obtain @xmath906 using theorem  [ thm : jennings ] . for the second part , by standard commutator formulas ( cf . ,",
    "e.g. , ( * ? ? ?",
    "* section 0.1 ) ) we have @xmath907 = [ h_i , h_jf_j]^{f_i}[f_i , h_if_j ] = [ h_i , f_j]^{f_i } [ h_i , h_j]^{f_jf_i } [ f_i , h_j]^{f_j } \\\\ = [ h_i , f_j ] [ h_i , h_j]^{f_jf_i } [ f_i , h_j],\\end{gathered}\\ ] ] using that @xmath908=1 $ ] as well as @xmath909^{f_i}=[h_i , f_j]$ ] and @xmath910^{f_j}=[f_i , h_j]$ ] ( since @xmath909,[f_i , h_j]\\in r[h]$ ] ) . by this yields",
    "@xmath911 \\big ) = ( 1-[h_j , h_i])\\cdot ( f_i+f_j ) + [ h_j , h_i]\\cdot ( 1-h_i^{-1})\\cdot f_j - ( 1-h_j^{-1})\\cdot f_i.\\ ] ] by theorem  [ thm : jennings ] we have @xmath912 , @xmath913 , and @xmath914\\in\\omega^{n+2}$ ] ; and by inductive hypothesis @xmath915 and @xmath916 .",
    "this implies the second part of our claim .    combining this proposition with lemma  [ lem : lower central for semidirect products ] and jennings theorem ( theorem  [ thm : jennings ] above ) we obtain :",
    "suppose @xmath7 is a @xmath0-group .",
    "then @xmath860 is nilpotent , and the nilpotency class , lower @xmath0-length , and lower dimensional @xmath0-length of @xmath736 all equal @xmath917    in the proof of the main result of this section we need :    [ cor : buckley ] let @xmath214 be a group containing @xmath51 as a central subgroup , let @xmath829 be a group morphism to a @xmath0-group @xmath7 not necessarily surjective with kernel @xmath51 , and let @xmath918 be a corresponding standard embedding",
    ". then @xmath919=r\\widehat{h}\\ ] ] where @xmath343 is the nilpotency class of @xmath887)$ ] .",
    "let @xmath850 be a countermap to @xmath833 such that @xmath920 for all @xmath921 . since @xmath922 we have for all @xmath878 , @xmath235 : @xmath923 and hence @xmath924 $ ] .",
    "now use corollary  [ cor : hatg ] and proposition  [ prop : buckley ] .",
    "assume that the group @xmath223 is a semidirect product of its subgroups @xmath925 and @xmath7 , with @xmath224 .",
    "the following is easy to verify :    [ lem : filtration of semidirect product ] let @xmath926 be a filtration of @xmath7 . then @xmath927 defines a filtration of @xmath223 . if @xmath926 is normal , then so is @xmath928 , and for every @xmath929 the natural morphism @xmath930 is an isomorphism .",
    "so if @xmath926 is a central filtration , or a central @xmath0-filtration , then @xmath928 also has the respective property .",
    "let now @xmath180 be a central filtration of @xmath3 , and put @xmath931 for each @xmath20 .",
    "note that @xmath932\\leq b$ ] , hence @xmath933\\leq b_{n+1}$ ] for each @xmath20 .",
    "assume also that a central finite - length filtration @xmath934 of @xmath7 is given .",
    "we can then combine the central filtration @xmath935 of @xmath925 with the central filtration @xmath928 of @xmath3 to a central filtration @xmath936 of @xmath3 .",
    "( this construction of filtrations on semidirect products is used in the next subsection . )",
    "we need yet another lemma , indicating how an embedding of an amalgam into a wreath product can be constructed inductively . for this ,",
    "let @xmath735 be an amalgam of groups .",
    "an amalgam @xmath937 is called a _ subamalgam _ of @xmath735 if @xmath938 , @xmath939 and @xmath940 .",
    "the subamalgam @xmath937 of @xmath735 is called _ normal _ if @xmath538 is normal in @xmath3 and  @xmath362 normal in @xmath7 . in this case , identifying @xmath941 with @xmath942 in the natural way , we can form the _ factor amalgam _ @xmath943 . the first part of the following lemma is ( * ? ?",
    "* lemma  2 ) :    let @xmath937 be a normal subamalgam of the amalgam @xmath735 , and suppose @xmath378 is central in both @xmath3 and @xmath7 .",
    "if @xmath937 embeds into a group @xmath79 and @xmath943 embeds into a group @xmath14 , then @xmath735 embeds into @xmath944 .",
    "an analogous statement holds for strong embeddings in place of embeddings .",
    "suppose @xmath79 is a group containing both @xmath538 and @xmath362 as subgroups , and @xmath945 , @xmath946 are group morphisms with @xmath848 , @xmath947 and @xmath948 .",
    "then by ( * ? ? ?",
    "* lemma  2 ) there are standard embeddings @xmath949 and @xmath950 which form an embedding of @xmath735 into @xmath944 .",
    "this is already the first part of the lemma .",
    "however , for the statement concerning strong embeddings , we need a more detailed description of how @xmath951 and @xmath952 are constructed .",
    "first one chooses a countermap @xmath953 to @xmath954 .",
    "this yields a standard embedding @xmath955 one can show ( cf .",
    "* lemma  1 ) ) that there exists a countermap @xmath956 to @xmath945 such that the map @xmath957 defined by @xmath958 is constant on each right coset of @xmath959 in @xmath14 .",
    "similarly , there exists a countermap @xmath960 to @xmath946 such that the map @xmath961 defined by @xmath962 is constant on each right coset of @xmath959 in @xmath14 .",
    "this yields standard embeddings @xmath963 and @xmath964 in the manner described above .",
    "note that for @xmath965 and @xmath966 we have @xmath967 since @xmath378 is central in @xmath3 .",
    "similarly we have @xmath968 for all @xmath965 .",
    "hence the diagram in figure  [ img : embeddings ] is commutative .",
    "@xmath969 & & y\\wr k\\ar[ul ] \\\\    & \\ar[ul ] v\\wr k\\ar[ur ]   & \\\\ g \\ar[uu ] &     & h \\ar[uu]\\\\ & \\ar[ul ]   u \\ar[uu ] \\ar[ur ] & } \\ ] ]    to see the statement about strong embeddings , suppose that @xmath970 as subgroups of @xmath79 and @xmath971 .",
    "let @xmath4 , @xmath235 such that @xmath972 .",
    "then @xmath973 , hence @xmath974 and @xmath975 for all @xmath966 , and @xmath976 , hence @xmath977 for all @xmath966 .",
    "since @xmath378 is central in @xmath3 , this yields @xmath978 for all @xmath966 , and similarly @xmath979 this yields @xmath980 .    with these tools at hand",
    ", we can now give the proof of proposition  [ prop : higman , more precise ] .",
    "given a filtration @xmath981 of a group , we call the number of distinct non - trivial groups occurring among @xmath982 the _ essential length _ of @xmath111 . note that the essential length of @xmath111 is an invariant of the equivalence class of @xmath111 .",
    "the length of @xmath111 is never smaller than its essential length .",
    "let @xmath735 be an amalgam of @xmath0-groups , and let @xmath757 and @xmath758 be finite - length central @xmath0-filtrations of @xmath3 respectively @xmath7 with @xmath759 .",
    "we proceed by the maximum @xmath983 of the essential lengths of @xmath111 and @xmath125 to show that there exists a strong embedding of @xmath735 into a @xmath0-group @xmath736 and a central @xmath0-filtration of @xmath736 as well as compatible stretchings @xmath144 of @xmath111 and @xmath984 of @xmath125 satisfying conditions ( a1 ) and ( a2 ) in proposition  [ prop : higman , more precise ] ( after identifying @xmath3 and @xmath7 with their images under the embedding of @xmath735 into @xmath736 ) .",
    "if @xmath985 , then there is nothing to show , so assume @xmath986 . let @xmath20 be the maximum of the lengths of @xmath111 and @xmath125 .",
    "then @xmath987 is central in @xmath3 and @xmath988 is central in @xmath7 , and both groups are elementary abelian @xmath0-groups ; their fiber sum  @xmath79 over @xmath989 is an elementary abelian @xmath0-group , and @xmath970 after identifying @xmath538 and @xmath362 in the natural way with subgroups of @xmath79 . by induction and after replacing @xmath111 and @xmath125 by compatible stretchings if necessary , we may assume that we have group morphisms @xmath945 and @xmath946 such that @xmath990 as well as a central @xmath0-filtration @xmath991 of @xmath14 such that    1 .",
    "@xmath992 and @xmath993 for @xmath994 ; 2 .",
    "@xmath995 and @xmath996 for @xmath997 ; 3 .",
    "@xmath998 ( as subgroups of @xmath999 ) for @xmath1000 , where @xmath1001 .    put @xmath1002 , and following the proof of the lemma above take standard embeddings @xmath1003 and @xmath1004 which form a strong embedding of @xmath735 into @xmath736 . now for every @xmath1005 , where @xmath1006 , define the normal subgroup @xmath1007 of @xmath736 , and for @xmath1008 , where @xmath1009 , set @xmath1010 then @xmath1011 is a central @xmath0-filtration of @xmath736 .",
    "( see the remark following lemma  [ lem : filtration of semidirect product ] . )",
    "it remains to show that there are compatible stretchings @xmath144 of @xmath111 and @xmath984 of  @xmath125 which , together with @xmath1012 , satisfy conditions ( a1 ) and ( a2 ) in proposition  [ prop : higman , more precise ] .",
    "clearly @xmath1013 on the other hand , by the construction of @xmath1014 in the proof of the preceding lemma , the image of @xmath1014 is contained in the subgroup @xmath1015 of @xmath736 , and by corollary  [ cor : buckley ] , @xmath1016 = x\\widehat{k } = \\alpha(x),\\ ] ] hence @xmath1017 .",
    "therefore @xmath1018 thus the stretching @xmath1019 of @xmath111 defined by @xmath1020 has the property that @xmath1021 .",
    "similarly one argues that the stretching @xmath1022 of @xmath125 defined by @xmath1023 satisfies @xmath1024 ; note that @xmath144 and @xmath984 are compatible .",
    "this shows condition ( a1 ) .",
    "we also have , with @xmath1025)$ ] : @xmath1026 moreover @xmath1027 and similarly for @xmath1028 . property ( a2 ) follows .      throughout this section",
    "we let @xmath3 be a @xmath0-group , and we let @xmath1029 ( @xmath1030 ) be partial automorphisms of @xmath3 , i.e. , isomorphisms between subgroups of @xmath3 . in this section",
    "we want to discuss the following question :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ under which conditions on the @xmath1031 is there a @xmath0-group @xmath7 which contains @xmath3 as a subgroup such that each @xmath1031 extends to an inner automorphism of @xmath7 ? _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    this issue is of interest to us since the existence of @xmath7 as in the question above is equivalent to the iterated hnn extension @xmath1032 of @xmath3 to be residually @xmath0 .",
    "( see lemma  [ residual p criterion ] below . )",
    "it is clear that in order to find such @xmath7 it suffices to produce a @xmath0-group @xmath357 which contains @xmath3 as a subgroup and for each @xmath258 an extension @xmath1033 of @xmath1031 to an automorphism of @xmath357 such that the subgroup @xmath214 of @xmath1034 generated by @xmath1035 has @xmath0-power order : in this case , the semidirect product @xmath1036 has the right property .",
    "note however that it is not enough to have , for each @xmath258 individually , an extension of @xmath1031 to a @xmath0-automorphism of some @xmath0-group containing @xmath3 as a subgroup :    suppose @xmath1037 , and consider the automorphisms @xmath1038 and @xmath1039 of @xmath3 .",
    "then @xmath119 and @xmath90 both have order @xmath0 ; however @xmath119 and @xmath90 do not commute .",
    "since every @xmath0-subgroup of @xmath1040 is conjugate to a subgroup of the group @xmath1041 of upper unitriangular matrices ( see , e.g. , @xcite ) , and @xmath1042 is abelian , there are no extensions of @xmath119 , @xmath90 to automorphisms of a @xmath0-group containing @xmath3 as a subgroup and which generate a @xmath0-group .",
    "given a partial automorphism @xmath1043 of @xmath3 , we say that a filtration @xmath109 of @xmath3 is _ @xmath119-invariant _ if @xmath1044 for all @xmath20 ; in this case , if in addition @xmath111 is normal , then for each @xmath20 , @xmath119 induces an automorphism between the canonical images @xmath1045 and @xmath1046 of @xmath214 respectively @xmath925 in @xmath1047 , which we denote by @xmath1048 .",
    "the following proposition was shown in ( * ? ? ?",
    "* lemma  1.2 ) ( and later rediscovered in  @xcite ) .",
    "it may be seen as an analogue for hnn extensions of higman s theorem  @xcite discussed in the previous section ; the proof given in @xcite also employs wreath products .",
    "let @xmath1043 be a partial automorphism of @xmath3 .",
    "suppose that @xmath3 admits a @xmath119-invariant chief filtration @xmath121 such that @xmath1049 then @xmath3 embeds into a @xmath0-group @xmath7 such that @xmath119 extends to an inner automorphism of @xmath7 and @xmath111 is induced by a chief filtration of @xmath7 .",
    "this fact easily yields the following corollary , which generalizes a well - known characterization of unipotent subgroups of the general linear group over a field of characteristic @xmath0 ; cf .",
    "@xcite :    [ cor : chatzidakis ] the following are equivalent :    1 .",
    "there exists a @xmath0-group @xmath7 which contains @xmath3 as a subgroup such that each @xmath1031 extends to an inner automorphism of @xmath7 .",
    "2 .   there exists a @xmath0-group @xmath357 which contains @xmath3 as a subgroup and extensions of @xmath1031 to automorphisms of @xmath357 which generate a @xmath0-subgroup of @xmath1034 .",
    "3 .   there exists a chief filtration @xmath1050 of @xmath3 which is @xmath1031-invariant for each @xmath258 and such that @xmath1051    the equivalence of ( 1 ) and ( 2 ) was already noted above . the implication ( 3 )",
    "@xmath332  ( 1 ) follows from the proposition above by induction on @xmath338 . for the converse note that every chief filtration of a @xmath0-group containing @xmath3 as a subgroup induces a chief filtration of @xmath3 , and that every central filtration is invariant under inner automorphisms .",
    "criterion ( 3 ) may actually be relaxed slightly :    [ lem : hnn ] suppose there exists a finite - length central filtration @xmath1052 of @xmath3 which is @xmath1031-invariant for each @xmath258 and such that for each @xmath1053 there is a @xmath0-group  @xmath1054 containing @xmath1055 as a subgroup and for each @xmath258 an extension of the partial automorphism @xmath1056 of @xmath1055 induced by @xmath1031 to an inner automorphism of @xmath1054 .",
    "then there exists a @xmath0-group @xmath7 which contains @xmath3 as a subgroup such that each @xmath1031 extends to an inner automorphism of @xmath7 .    for each @xmath1053",
    "there is a chief filtration @xmath1057 of the @xmath1053th layer @xmath1055 of @xmath111 which is @xmath1058-invariant for each @xmath258 and such that @xmath1059 for each @xmath1053 let @xmath1060 be the natural epimorphism .",
    "then @xmath1061 lifts to a complete filtration @xmath1062 of @xmath1063 .",
    "the @xmath1064 combine to a complete filtration @xmath144 of @xmath3 : @xmath1065 this filtration refines @xmath111 and hence is central .",
    "moreover , for @xmath1066 , the @xmath1067th layer of @xmath1068 is @xmath1069 , whereas for @xmath1070 the @xmath1067th term of @xmath1068 is @xmath1071 , and @xmath1072 hence @xmath144 is a chief filtration satisfying condition ( 3 ) in corollary  [ cor : chatzidakis ] .    as an application of this lemma",
    "we obtain :    [ cor : generate hnn ] suppose @xmath3 is abelian , and let @xmath7 be a subgroup of @xmath3 containing all @xmath1073 and @xmath1074 @xmath1030",
    ". then the following are equivalent :    1 .",
    "there are a @xmath0-group @xmath1075 and extensions of each @xmath1031 to an inner automorphism of @xmath1076 .",
    "there are a @xmath0-group @xmath1077 and extensions of each @xmath1031 to an inner automorphism of @xmath357 .",
    "clear ( 2 ) implies ( 1 ) .",
    "suppose conversely that ( 1 ) holds .",
    "then @xmath1078 is a central filtration of @xmath3 satisfying the conditions of the previous lemma , which yields ( 2 ) .",
    "this corollary immediately implies :    [ cor : generate hnn , 2 ] suppose @xmath3 is abelian , and let @xmath1079 @xmath1030 be partial automorphisms of an abelian @xmath0-group @xmath1080 .",
    "let @xmath1081 be a morphism which , for @xmath1030 , restricts to morphisms @xmath1082 and @xmath1083 making @xmath1084^{\\varphi_i}\\ar[d]^{\\phi } & b_i \\ar[d]^{\\phi } \\\\",
    "a_i ' \\ar[r]^{\\varphi_i ' } & b_i ' } \\ ] ] commutative . if @xmath1085 is injective and @xmath1032 is residually @xmath0 , then @xmath1086 is residually @xmath0 .",
    "this fact will be used in the next chapter , however only in the trivial case where @xmath3 and @xmath1080 are elementary abelian @xmath0-groups .",
    "we would like to take the opportunity to stress that the analogue of the last corollary without the requirement that @xmath1085 be injective is false , as a simple example based on permutation matrices shows :    let @xmath1087 , and consider @xmath1088 and its subgroups @xmath1089 , @xmath1090 .",
    "let @xmath1091 be the automorphism of @xmath3 given by @xmath1092 .",
    "then @xmath1091 has order @xmath1 , and @xmath1091 restricts to an isomorphism @xmath1043 .",
    "hence the hnn extension @xmath1093 of @xmath3 with associated subgroups @xmath214 , @xmath925 identified via @xmath119 is residually @xmath1 .",
    "now consider the morphism @xmath1094 given by @xmath1095 .",
    "then @xmath1085 restricts to isomorphisms @xmath1096 and @xmath1097 , and if we let @xmath1098 be the automorphism of @xmath1080 given by @xmath1099 , then @xmath1100 .",
    "hence @xmath1085 gives rise to a surjective morphism @xmath1101 however , @xmath219 is not residually @xmath1 , since @xmath1098 has order @xmath34 .",
    "this phenomenon forced us to include the condition that the morphisms @xmath328 arising in the definition of a @xmath0-potent filtration of a group ( cf .",
    "section  [ sec : p - potent ] ) to be _ injective . _",
    "we say that a filtration @xmath1102 of a graph of groups @xmath31 with underlying graph @xmath362 is _ @xmath0-excellent _ if    1 .",
    "@xmath111 is normal with @xmath1103<\\infty$ ] for each @xmath439 and @xmath65 ; 2 .",
    "@xmath111 , construed as a complete filtration of @xmath1104 , is @xmath0-potent ; 3 .",
    "@xmath111 is separating ; 4 .",
    "@xmath111 separates the edge groups of @xmath31 ; and 5 .   for each @xmath435 , the filtration @xmath1105 intersects to a uniformly @xmath0-potent filtration on the subgroup @xmath675 of @xmath1106 .",
    "the main result of this chapter is :    [ thm : reduction theorem , 2 ] let @xmath31 be a graph of finitely generated groups admitting a @xmath0-excellent filtration . then @xmath30 is virtually residually @xmath0 .",
    "we prove this result in the last section of this chapter .",
    "after some general facts concerning residual properties of fundamental graphs of groups ( section  [ sec : residual properties of graphs of groups ] ) we first establish a useful criterion for fundamental groups to be residually @xmath0 ( section  [ sec : a reduction theorem ] ) and introduce an unfolding procedure on graphs of groups ( section  [ sec : unfolding a graph of groups ] ) .",
    "following @xcite , we say that a property @xmath2 of groups is a _ root property _ if    1 .",
    "every subgroup of a group with property @xmath2 has property @xmath2 ; 2 .",
    "every direct product of two groups with property @xmath2 has property @xmath2 ; 3 .",
    "if @xmath3 is a group and @xmath1107 are such that @xmath100 , @xmath1108 have property @xmath2 , then @xmath14 contains a subgroup @xmath45 , _ normal in @xmath3 , _ such that @xmath1109 is @xmath2 .",
    "important root properties are : solvability , finiteness , and having order a power of a given prime @xmath0 ( see @xcite ) .",
    "( nilpotence does not satisfy ( 3 ) and hence is not a root property . )",
    "this notion is tailor - made for the proof of the following lemma to go through :    ( * ? ? ? * lemma  1.5)[lem : gruenberg ] let @xmath41 be a group and @xmath1110 , and let @xmath2 be a root property .",
    "if the group @xmath25 is residually @xmath2 and @xmath1111 has property @xmath2 , then @xmath41 is residually @xmath2 .    in the rest of this section",
    "we let @xmath2 be a root property , we let @xmath31 be a graph of groups based on a graph @xmath362 , and write @xmath54 .",
    "we are interested in conditions which force @xmath3 to be residually @xmath2 .",
    "in the rest of this section we assume that @xmath2 is residually satisfied by every finitely generated free group .",
    "_ of course , the case where @xmath2 is the property of having @xmath0-power order is the one of most interest for us , but the extra generality comes at little additional cost , and might be useful for further applications .",
    "probably the most interesting example for a root property @xmath2 of the type considered here which does not include the condition of finiteness is the property of being a solvable group . in connection with this",
    "it is worth noting that there is a distinction between `` residually solvable '' and `` residually finite solvable '' : there do exist finitely presentable solvable groups which are not residually finite , cf .",
    "@xcite .",
    "if each vertex group of @xmath31 is a @xmath0-group , then @xmath3 always has a free ( but not necessarily normal ) subgroup whose index is the least common multiple of the orders of the vertex groups ( hence a power of @xmath0 ) , cf .",
    "* ii.2.6 , lemmas  8 and 10 ) ; to have a free _ normal _ subgroup of @xmath0-power index is equivalent to @xmath3 being residually @xmath0 . more generally :",
    "[ residual p criterion ] suppose that each vertex group of @xmath31 is a finite @xmath2-group .",
    "then the following are equivalent :    1 .",
    "@xmath3 has a free normal subgroup @xmath25 such that @xmath1112 has @xmath2 .",
    "@xmath3 is residually @xmath2 .",
    "3 .   there is a morphism @xmath1113 to a @xmath2-group @xmath86 such that @xmath1114 is injective for every @xmath439 .",
    "the implication `` ( 1 )  @xmath332  ( 2 ) '' follows from lemma  [ lem : gruenberg ] and the assumption that free groups are residually @xmath2 .",
    "suppose @xmath3 is residually @xmath2 .",
    "then for every @xmath439 and @xmath1115 there is a normal subgroup @xmath1116 of @xmath3 with @xmath1117 satisfying  @xmath2 and @xmath1118 .",
    "let @xmath25 be the intersection of all @xmath1116 as @xmath453 ranges over @xmath1119 .",
    "then @xmath25 is a normal subgroup of @xmath3 with @xmath1112 satisfying  @xmath2 , and the natural morphism @xmath1120 is injective on each @xmath35 .",
    "this shows `` ( 2 )  @xmath332  ( 3 ) . '' finally ,",
    "given @xmath1113 as in ( 3 ) , the kernel @xmath25 of @xmath90 is a normal subgroup of @xmath3 with @xmath1112 satisfying @xmath2 , and @xmath25 is free by ( * ? ? ?",
    "* ii.2.6 , lemma  8) .",
    "this shows `` ( 3 )  @xmath332  ( 1 ) . ''    the proof of the implications `` ( 3 )  @xmath332  ( 1 )  @xmath332  ( 2 ) '' did not use the finiteness of the @xmath35 , and the proof of `` ( 2 )  @xmath332  ( 3 )  @xmath332  ( 1 ) '' is valid without assuming that free groups are residually @xmath2 .",
    "[ cor : residually p quotient ] let @xmath7 be a normal subgroup of @xmath3 such that @xmath100 satisfies @xmath2",
    ". then @xmath1121 is residually @xmath2 , where @xmath587 .",
    "the unique morphism @xmath588 making commutative is injective on each vertex group @xmath1122 of @xmath1123 , so @xmath1121 is residually @xmath2 by the implication `` ( 3 )  @xmath332  ( 2 ) '' in lemma  [ residual p criterion ] ( the proof of which did nt need finiteness of the @xmath1122 ) .",
    "suppose the underlying graph @xmath362 of @xmath31 is a tree , and fix a vertex @xmath386 of @xmath362 .",
    "assume that for each edge @xmath372 of @xmath362 , the morphism @xmath1124 extends to an isomorphism @xmath1125 , such that @xmath1126 for all @xmath372 .",
    "for each vertex @xmath74 of @xmath362 we then have an isomorphism @xmath1127 given as the composition @xmath1128 where @xmath419 is the geodesic in @xmath362 from @xmath74 to @xmath386 .",
    "in particular , @xmath1129 , and @xmath1130 for every edge @xmath372 of @xmath362 .",
    "this yields a simple but useful fact about the iterated amalgamated product @xmath54 :    [ lem : special amalgam ] there exists a unique morphism @xmath1131 such that for each vertex @xmath74 of @xmath362 , the diagram @xmath1132^{\\varphi } & g_{v_0 } \\\\",
    "g_v\\ar[u ] \\ar[ur]_{\\varphi_v } & } \\ ] ] commutes , where @xmath725 is the natural morphism .",
    "the following application ( not used later ) of lemmas  [ residual p criterion ] and [ lem : special amalgam ] is implicit in @xcite .",
    "a finite group @xmath41 is homogeneous ( in the sense of model theory ) if every isomorphism between subgroups of @xmath41 is induced by an automorphism of @xmath41 .",
    "finite homogeneous groups have been completely classified @xcite ; for example , given a prime @xmath0 , the group of the form @xmath1133 ( for some @xmath1067 ) are homogeneous , and if @xmath0 is odd , then these are the only homogeneous @xmath0-groups .",
    "( there are two non - abelian homogeneous @xmath34-groups . )",
    "suppose @xmath362 is a tree , every vertex group @xmath35 is a finite homogeneous @xmath2-group , and @xmath1134 for all @xmath1135 .",
    "then @xmath3 has a free normal subgroup @xmath25 with @xmath1136 , hence @xmath3 is residually @xmath2 .",
    "the following is a generalization of the criterion for residual finiteness of fundamental groups of graphs of groups found in ( * ? ? ?",
    "* theorem  3.1 ) and , with a different proof , in @xcite ( see also ( * ? ? ?",
    "* section  ii.2.6 ) ) .",
    "it unifies and generalizes several criteria for groups to be residually @xmath0 in the literature .",
    "( for example , it can be used to easily deduce ( * ? ? ?",
    "* corollary  3.5 , theorems  4.2 and 4.3 ) . )",
    "[ hempel criterion residually p ] suppose that the following hold :    * for each @xmath528 and each @xmath1137 there is a compatible collection @xmath1138 of normal subgroups such that @xmath1139 and @xmath1121 is residually @xmath2 .",
    "* for all @xmath1140 and @xmath1141 , @xmath309 there exists a compatible collection @xmath1138 of normal subgroups such that @xmath1142 for @xmath309 and @xmath1121 is residually @xmath2 .",
    "then @xmath3 is residually @xmath2 .    in this proof @xmath535",
    "ranges over all compatible collections of normal subgroups such that @xmath1121 is residually @xmath2 .",
    "the natural morphisms @xmath1143 combine to a morphism @xmath1144 since @xmath357 is residually @xmath2 , it is enough to show that @xmath247 is injective .",
    "let @xmath5 be an element of @xmath3 , and represent @xmath453 by a path @xmath1145 in @xmath31 as in section  [ sec : pi1 ]",
    ". then @xmath1146 is represented by the path @xmath1147 in @xmath1123 . moreover ,",
    "if @xmath231 is reduced , then assumptions ( a ) and ( b ) yield that for some  @xmath535 , the path @xmath1148 is reduced as well , in particular @xmath1149 .",
    "therefore we have @xmath1150 .",
    "we do not know whether in general we can simplify condition ( b ) by requiring this condition to hold only for a single edge at a time ( i.e. , for @xmath249 ) .",
    "next , we indicate a few situations where this is possible .",
    "the first one concerns the case where we can choose all subgroups in @xmath1151 to have finite index :    [ cor : vertex and edge groups closed ] suppose that the following hold :    * for each @xmath528 and each @xmath1137 there is a compatible collection @xmath1138 of finite index normal subgroups such that @xmath1139 and @xmath1121 is residually @xmath2 .",
    "* for all @xmath1152 and @xmath1153 there exists a compatible collection @xmath1138 of finite index normal subgroups such that @xmath1154 and @xmath1121 is residually @xmath2 .",
    "then @xmath3 is residually @xmath2 .",
    "moreover , every vertex and edge group of @xmath31 identified with a subgroup of @xmath3 in the natural way is closed in the pro-@xmath2 topology on @xmath3 .",
    "recall here that the pro-@xmath2 topology on a group @xmath41 is the topology with fundamental system of neighborhoods of @xmath163 given by the normal subgroups @xmath1110 with @xmath1111 a @xmath2-group .",
    "the first statement in this corollary is a consequence of proposition  [ hempel criterion residually p ] and the following lemma , for which we let @xmath1155 @xmath618 be compatible collections of normal subgroups , and set @xmath1156 then @xmath1157 is a compatible collection of normal subgroups , and we have a natural group morphism @xmath1158 which is injective on vertex groups .",
    "[ lem : intersect h ] suppose @xmath1159 is finite for @xmath618 and every vertex @xmath74 . if @xmath1160 and @xmath1161 are residually @xmath2 , then so is @xmath1162 .",
    "suppose @xmath1160 and @xmath1161 are residually @xmath2 .",
    "since we have @xmath1163<\\infty$ ] for @xmath618 and all @xmath74 , by lemma  [ residual p criterion ] there exist group morphisms @xmath1164 to @xmath2-groups @xmath1165 such that @xmath1166 is injective , for @xmath618 and all @xmath74 .",
    "composing with the morphism , we obtain a group morphism @xmath1167 which is injective on vertex groups , and this shows ( again by lemma  [ residual p criterion ] ) that @xmath1162 is residually @xmath2 .    for showing the second statement in corollary  [ cor : vertex and edge groups closed ] we use the following simple observation ( the proof",
    "of which we skip ) :    [ lem : separate finite subgroups ] suppose @xmath41 is a residually @xmath2 group , and let @xmath1168 be a finite subgroup of @xmath41",
    ". then for every @xmath1169 with @xmath1170 there exists a morphism @xmath1171 to a @xmath2-group such that @xmath1172 .",
    "as remarked , the first statement in this corollary follows from proposition  [ hempel criterion residually p ] and lemma  [ lem : intersect h ] .",
    "let @xmath1173 , @xmath528 .",
    "by the proof of proposition  [ hempel criterion residually p ] there exists a compatible collection @xmath535 of finite index normal subgroups such that @xmath1121 is residually @xmath2 and @xmath1174 .",
    "since @xmath1175 is finite , there exists a morphism @xmath1176 to a @xmath2-group such that @xmath1177 , by lemma  [ lem : separate finite subgroups ] .",
    "hence @xmath1178 is closed in @xmath3 .",
    "similarly ones sees that each edge group of @xmath31 is closed in @xmath3 .",
    "if all the edge groups @xmath55 of @xmath31 are trivial , then every collection @xmath590 of subgroups @xmath1179 of the vertex groups is compatible , and if @xmath1155 ( @xmath618 ) are collections of normal subgroups , then the morphism is injective ; hence if in addition the fundamental group of @xmath1180 is residually @xmath2 for @xmath618 , then so is the fundamental group of @xmath1181 .",
    "so in this special case , proposition  [ hempel criterion residually p ] also simplifies :    suppose that @xmath1182 for every @xmath435 .",
    "if @xmath31 satisfies condition in the previous proposition , then @xmath3 is residually @xmath2 .",
    "we record two ( presumably well - known ) consequences :    [ cor : trivial edge groups ] the fundamental group of every graph of groups whose vertex groups are residually @xmath2 and whose edge groups are trivial is residually @xmath2 .    by the previous corollary ,",
    "it is enough to show that if @xmath528 is such that @xmath1178 is a @xmath2-group and @xmath1183 for all @xmath439 with @xmath1184 , and @xmath1182 for all @xmath435 , then @xmath3 is residually @xmath2 .",
    "however , this is immediate by the equivalence of ( 3 ) and ( 2 ) in lemma  [ residual p criterion ] .",
    "in particular , the previous corollary shows that the free product of finitely many residually @xmath0 groups is residually @xmath0 , and ( combined with theorem  [ thm : bass - serre ] ) that the free product of finitely many virtually residually @xmath0 groups is virtually residually @xmath0 .",
    "[ cor : crucial , preparation ] assume that all vertex groups of @xmath31 are residually @xmath2 , and suppose there exists a morphism @xmath1185 to a finite @xmath2-group @xmath86 which is injective when restricted to each subgroup @xmath675 of @xmath3 .",
    "then @xmath3 is residually @xmath2 .    by theorem  [ thm : bass - serre ]",
    ", the kernel @xmath25 of @xmath90 is the fundamental group of a graph of groups whose vertex groups are of the form @xmath1186 , and whose edge groups are of the form @xmath1187 .",
    "however , since @xmath1188 is injective , we have @xmath1189 for each @xmath372 .",
    "thus @xmath25 is the fundamental group of a graph of groups with residually @xmath2 vertex groups and trivial edge groups .",
    "hence @xmath25 is residually @xmath2 by corollary  [ cor : trivial edge groups ] , and so @xmath3 is residually @xmath2 by lemma  [ lem : gruenberg ] .",
    "finally , we note that in later sections , we will apply proposition  [ hempel criterion residually p ] with the  @xmath535 coming from a filtration of @xmath31 ; in this case , this proposition reads as follows :    [ cor : hempel , cor ] let @xmath111 be a normal separating filtration of @xmath31 which separates the edge groups of @xmath31 , such that @xmath1190 is residually @xmath2 for every @xmath65 .",
    "then @xmath3 is residually @xmath2 .",
    "( the material in the rest of this section is not used later . )",
    "it is interesting to ask whether the conditions ( a ) and ( b ) in the previous proposition are necessary for @xmath3 to be residually @xmath2 . from corollary  [ cor :",
    "residually p quotient ] we immediately obtain :    [ lem : a ] if @xmath3 is residually @xmath2 , then @xmath31 satisfies .",
    "the situation for condition ( b ) is slightly less clear . here",
    "we can only show :    [ lem : b ] suppose for each edge @xmath435 , either    1 .",
    "the subgroup @xmath675 of @xmath1106 is maximal with respect to being verbal with respect to a collection @xmath1191 of words ; or 2 .",
    "@xmath1192 is abelian and @xmath675 , @xmath1193 are proper subgroups of @xmath1106 , @xmath1192 , respectively .    if @xmath3 is residually @xmath2 , then @xmath31 satisfies .    in this context ,",
    "recall the following definition :    let @xmath736 be a collection of elements of a free group @xmath57 ( `` words '' ) .",
    "a group @xmath41 is _ verbal _ with respect to @xmath736 if every morphism @xmath1194 maps each @xmath1195 to @xmath163 .",
    "for example , a group @xmath41 is verbal with respect to @xmath1196 if and only if @xmath41 is abelian .",
    "we have the following generalization of a lemma from @xcite :    [ lem : verbal ] suppose @xmath41 is a group and @xmath7 is a subgroup of @xmath41 .",
    "assume that @xmath41 is residually @xmath2 and @xmath7 is verbal with respect to a collection of words @xmath736 .",
    "then @xmath1197 is also verbal with respect to @xmath736 .    for a normal subgroup @xmath14 of @xmath41 ,",
    "every substitution of elements of @xmath1198 into a word from @xmath736 yields an element of @xmath14 ( since such an element maps to @xmath163 under @xmath1199 ) .",
    "since @xmath41 is residually @xmath2 , the intersection of all @xmath1200 such that @xmath1201 has property @xmath2 is trivial .",
    "hence @xmath1076 is verbal with respect to @xmath736 .",
    "we now prove lemma  [ lem : b ] .",
    "so suppose @xmath54 is residually @xmath2 .",
    "let @xmath372 be an edge of @xmath362 , and @xmath1202 , where @xmath520 .",
    "in order to establish ( b ) it suffices to show : there is @xmath1203 such that @xmath1204 is a @xmath2-group and @xmath1205 . to see this note that if @xmath1206 are such that @xmath1207 is a @xmath2-group , @xmath618 , then @xmath1208 is also a @xmath2-group , and use corollary  [ cor : residually p quotient ]    assume first that @xmath675 is a maximal subgroup of @xmath1209 with respect to being verbal with respect to some @xmath1191 . considering @xmath1210 as a subgroup of @xmath3",
    ", we see that @xmath1076 as defined in lemma  [ lem : verbal ] is verbal with respect to @xmath736 , hence @xmath1211 .",
    "thus there is some @xmath1203 such that @xmath1204 has property @xmath2 and @xmath1212 .",
    "suppose next that @xmath1213 ( @xmath1214 ) is abelian and @xmath675 , @xmath1193 are proper subgroups of @xmath1209 , @xmath1215 , respectively .",
    "choose @xmath1216 .",
    "we may assume that our base point @xmath386 for @xmath529 agrees with @xmath430 .",
    "then @xmath1217=eg^{-1}\\overline{e } h^{-1 } e g \\overline{e } h$ ] is an element of @xmath3 which is not the identity .",
    "hence there is some @xmath1203 such that @xmath1204 has property @xmath2 and @xmath1218 .",
    "this yields @xmath1205 : otherwise @xmath1219 for some @xmath1220 , so @xmath1221 and hence @xmath1222 \\equiv 1 \\bmod k$ ] since @xmath1213 is abelian , a contradiction .    in both cases we found @xmath1203 such that @xmath1204 is a @xmath2-group and @xmath1205 as required .",
    "given an orientable @xmath1-manifold @xmath25 with incompressible toroidal boundary , the fundamental groups of the boundary components of @xmath25 are maximal abelian subgroups of @xmath26 ; cf .",
    "lemma  [ lem : maximal abelian ] below .",
    "this fact in combination with lemmas  [ lem : a ] and [ lem : b ] ,  ( 1 ) shows that in proving that the fundamental group of a @xmath1-manifold is residually @xmath2 , we essentially have to use proposition  [ hempel criterion residually p ] :    if @xmath25 is @xmath1-manifold which is closed , orientable , and prime , with non - trivial jsj decomposition , then @xmath26 is residually @xmath2 if and only if the graph of groups @xmath31 associated to the jsj decomposition of @xmath25 satisfies conditions and .",
    "( see section  [ sec : jsj ] for the definition of the graph of groups @xmath31 . )",
    "we now would like to apply the results of the previous chapter to establish a criterion for fundamental groups of certain graphs of groups to be residually @xmath0 .",
    "this is theorem  [ thm : reduction theorem ] at the end of this section .",
    "before we can formulate this theorem , we need to introduce a generalization of the fiber sum construction , which is then used to define the `` partial abelianization '' of a fundamental group of a graph of abelian groups .",
    "let @xmath151 be a graph of abelian groups , and let @xmath401 be an orientation of its underlying graph @xmath362 .",
    "the injective morphisms @xmath1223 combine to a natural morphism @xmath1224 whose cokernel we call the _ colimit _",
    "@xmath1225 of @xmath31 .",
    "( indeed , @xmath1225 may be seen as the colimit , in the sense of category theory , of a certain diagram of abelian groups . )",
    "the colimit of @xmath31 is determined , up to isomorphism , by the following universal property : for every abelian group @xmath7 and every collection @xmath1226 of morphisms with the property that for each edge @xmath408 , the diagram in figure  [ fig : colimit ] commutes , there exists a unique morphism @xmath1227 such that @xmath1228 for all @xmath439 , where @xmath1229 is the natural morphism . also note that @xmath1225 does not depend on the choice of orientation @xmath401 of @xmath362 .",
    "@xmath1230^\\psi & \\\\ g_{t(e ) } \\ar[ur]_{\\iota_{t(e ) } } \\ar@/^/[uur]^{\\psi_{t(e ) } }   & & g_{t(\\ol{e } ) } \\ar[ul]^{\\iota_{t(\\ol{e } ) } } \\ar@/_/[uul]_{\\psi_{t(\\ol{e } ) } } \\\\ & \\ar[ul]^{f_e } g_e\\ar[ur]_{f_{\\ol{e } } } & } \\ ] ]    if @xmath362 is a tree , we also speak of the _ fiber sum _",
    "@xmath1225 of @xmath31 .",
    "if @xmath362 has exactly two vertices @xmath386 , @xmath457 and one topological edge @xmath374 , then @xmath1225 is indeed the fiber sum of @xmath1178 and @xmath1231 over @xmath55 as introduced earlier .",
    "more generally , if @xmath386 is a terminal vertex of @xmath362 ( i.e. , there is only one edge @xmath372 with @xmath1232 ) , then in a natural way @xmath1233 where @xmath372 is the edge of @xmath362 with @xmath1232 , and @xmath1234 . by induction on the number of vertices of @xmath362 ,",
    "this yields in particular :    [ lem : injection into fiber sum ] suppose @xmath362 is a tree",
    ". then for each @xmath439 , the natural morphism @xmath1235 is injective .",
    "if @xmath362 is a tree , then the fiber sum of @xmath31 may also be identified with the abelianization of the fundamental group @xmath3 of @xmath31 ; more generally :    [ lem : homology and fiber sums ] let @xmath79 be a maximal subtree of @xmath362 , and @xmath472 .",
    "suppose @xmath1236 for all @xmath367 , where @xmath1237 , @xmath439 , is the natural morphism .",
    "then there is a natural isomorphism @xmath1238 if for some prime @xmath0 , all @xmath35 are elementary abelian @xmath0-groups , then we have @xmath1239    this follows easily from the mayer - vietoris sequence associated to a graph of groups ( cf .  section  [ sec : mv ] ) .    note that under the assumption of the previous lemma , for each vertex @xmath74 , the natural morphism @xmath725 induces an injective morphism @xmath1240 .",
    "this conclusion can also be achieved under a weaker hypothesis on @xmath31 : it is enough to require that there exists a morphism @xmath1241 to an abelian group which is injective on the vertex groups of @xmath31 ( since such a morphism factors through @xmath1242 ) .",
    "similarly , if there exists a morphism @xmath1241 to an elementary abelian @xmath0-group which is injective on the vertex groups of @xmath31 , then the induced morphisms @xmath1243 are injective .",
    "let @xmath31 be a graph of groups based on the graph @xmath362 .",
    "let @xmath79 be a maximal subtree of @xmath362 , let @xmath1244 , and let @xmath401 be an orientation of @xmath379",
    ". from section  [ sec : pi1 ] recall that the fundamental group @xmath3 of @xmath31 may be identified with the iterated hnn extension @xmath1245 of @xmath475 , where @xmath1246 suppose now that all vertex groups of @xmath31 are abelian .",
    "we let @xmath1247 the natural morphism @xmath1248 extends to a morphism @xmath1249 , which is injective on the vertex groups of @xmath31 .",
    "the natural morphism @xmath1250 factors through @xmath1251 . for this reason we call @xmath1252 the _ partial abelianization _ of @xmath3 along @xmath79 . note that although @xmath463 is independent ( up to isomorphism ) of the choice of @xmath79 , simple examples show that the group @xmath1252 in general depends on @xmath79 .    in the following let @xmath2 be a root property such that free groups are residually  @xmath2 . by lemma  [ residual p criterion ] , we have :    [ lem : residually p for partial abelianization ] suppose all vertex groups of @xmath31 are finite abelian groups . if @xmath1252 is residually @xmath2 , then @xmath1253 is also residually @xmath2 .",
    "we do not know whether the converse of the implication stated in the previous lemma holds in general ; however , we do have :    [ lem : crucial ] suppose there exists a morphism @xmath1254 to a finite abelian @xmath2-group @xmath86 , which is injective when restricted to each vertex group @xmath35 of @xmath31 .",
    "then @xmath1252 is residually @xmath2 .",
    "this is a consequence of corollary  [ cor : crucial , preparation ] and the following observation :    let @xmath1113 be a morphism to an abelian group @xmath86 .",
    "then there is a morphism @xmath1255 which agrees with @xmath90 on each vertex group of @xmath31 and such that @xmath1256 for @xmath408 .    by the universal property of the fiber sum , the restriction of @xmath90 to a morphism @xmath1257 factors through a morphism @xmath1258 .",
    "since @xmath86 is abelian , this morphism extends to a morphism @xmath1255 by @xmath1256 for @xmath408 which has the required properties .",
    "let @xmath31 be a graph of finitely generated groups with underlying graph @xmath362 , and let @xmath111 be a central @xmath0-filtration of @xmath31 .",
    "recall that the @xmath20th layer @xmath184 of @xmath111 is the graph of groups whose underlying graph is also  @xmath362 and whose vertex and edge groups are the elementary abelian @xmath0-groups @xmath1259 and  @xmath667 , respectively , with edge morphisms @xmath1260 .",
    "fix a maximal subtree @xmath79 of @xmath362 . for every @xmath65 we can form the partial abelianization @xmath1261 of the fundamental group of @xmath184 along @xmath79 .",
    "the following important theorem is the culmination of the results obtained so far in this paper .",
    "essentially , it reduces the question whether @xmath30 is residually @xmath0 to finding a filtration @xmath111 such that the partially abelianized fundamental group of the first layer @xmath1262 of @xmath111 is residually @xmath0 .",
    "[ thm : reduction theorem ] suppose the following hold :    1 .",
    "@xmath111 is @xmath0-potent ; 2 .   for each @xmath372 ,",
    "@xmath1105 intersects to a uniformly @xmath0-potent filtration on @xmath675 ; 3 .",
    "@xmath1263 is residually @xmath0 .",
    "then @xmath1190 is residually @xmath0 for each @xmath65 . if in addition @xmath111 is separating and separates the edge groups of @xmath31 , then @xmath54 is residually @xmath0 , and the vertex and edge groups of @xmath31 are closed in the pro-@xmath0 topology on @xmath30 .    for the proof of this theorem",
    "we first show that its hypotheses imply that the partial abelianization of each layer of @xmath111 is residually @xmath0 ( not only the first , as stipulated by condition ( 3 ) ) .",
    "below , we continue to use the notation introduced in section  [ sec : partial ab ] above . for every edge @xmath1264 we equip @xmath1265 and @xmath1266 with filtrations @xmath1267",
    "respectively @xmath1268 , and let @xmath1269 be the isomorphism induced by @xmath1270 .",
    "[ lem : reduction theorem ] suppose @xmath111 satisfies conditions in theorem  [ thm : reduction theorem ] . then for each @xmath65 , the group @xmath1261 is residually @xmath0 .",
    "by ( 1 ) and ( 2 ) we can take injective @xmath76-linear maps @xmath1271 such that for each edge @xmath372 with @xmath492 , @xmath1272 restricts to isomorphisms @xmath1273 and @xmath1274 , and the diagram @xmath1275^{l_{n+1}(\\varphi_{e } ) } & &   l_{n+1}(\\mathbf b_e)\\\\ l_1(\\mathbf a_e ) \\ar[u]^\\cong\\ar[rr]^{l_1(\\varphi_{e } ) } & & l_1(\\mathbf b_e ) \\ar[u]^\\cong } \\ ] ] commutes .",
    "the @xmath1276 give rise to an _ injective _ @xmath76-linear map @xmath1277 which restricts to isomorphisms @xmath1273 and @xmath1274 ( after identifying @xmath1278 and @xmath1279 with subgroups of @xmath1280 as usual ) .",
    "this morphism extends to a morphism @xmath1281 by the identity on @xmath401 .",
    "therefore , since the group @xmath1263 is residually @xmath0 ( by assumption ( 3 ) ) , so is @xmath1261 for each @xmath1282 , by corollary  [ cor : generate hnn , 2 ]",
    ".    we will deduce theorem  [ thm : reduction theorem ] from the following proposition :    [ prop : reduction ] assume that each vertex group of @xmath31 is a @xmath0-group and @xmath111 is of finite length .",
    "suppose moreover that @xmath1261 is residually @xmath0 for every  @xmath65 .",
    "then @xmath3 is residually @xmath0 .",
    "let us see how this proposition yields theorem  [ thm : reduction theorem ] .",
    "so suppose conditions ( 1)(3 ) hold .",
    "by lemma  [ lem : reduction theorem ] , the groups @xmath1261 are residually @xmath0 , for each  @xmath65 . by the proposition",
    "applied to @xmath662 in place of @xmath31 and the filtration of @xmath662 of length @xmath1283 given on vertex groups by @xmath1284 we obtain that @xmath1190 is residually @xmath0 , for each @xmath65 .",
    "this is the first conclusion of theorem  [ thm : reduction theorem ] .",
    "the rest of the theorem follows from this and corollaries  [ cor : hempel , cor ] and [ cor : vertex and edge groups closed ] of proposition  [ hempel criterion residually p ] .",
    "it remains to give a proof of proposition  [ prop : reduction ] .",
    "for this , we need a consequence of the main results of section  [ sec : an embedding theorem ] :    [ lem : higman , 2 ] suppose @xmath362 is a tree , all vertex groups of @xmath31 are @xmath0-groups , and @xmath111 has finite length .",
    "then there exists a @xmath0-group @xmath86 , a finite - length central @xmath0-filtration  @xmath1285 of @xmath86 , and for each @xmath439 a group embedding @xmath1286 and a compatible stretching @xmath1287 of @xmath111 such that    1 .",
    "@xmath1288 for every @xmath435 ; 2 .",
    "@xmath1289 is a morphism @xmath1290 of filtered groups , for every @xmath439 ; 3 .   for each @xmath65 , after naturally identifying each vertex group @xmath1291 of the tree @xmath672 of elementary abelian @xmath0-groups with its image in @xmath1292 , the latter group contains the internal fiber sum @xmath1293 of @xmath672 .    in particular",
    ", @xmath54 is residually @xmath0 .",
    "the proof of the first statements proceeds by an obvious induction on the number of vertices of @xmath31 , using proposition  [ prop : higman , more precise ] in the inductive step .",
    "the existence of the family of group embeddings @xmath1286 satisfying ( 1 ) together with lemma  [ residual p criterion ] yields that @xmath30 is residually @xmath0 .    with this lemma in hand , we now turn to :    note that the hypotheses of the proposition are preserved under passage from @xmath111 to a compatible stretching .",
    "( since free groups are residually @xmath0 . )",
    "thus , by lemma  [ lem : higman , 2 ] applied to the tree of groups @xmath470 in place of @xmath31 , we may assume that there exists a morphism @xmath1294 to a @xmath0-group  @xmath86 and a finite - length central @xmath0-filtration @xmath1285 of @xmath86 such that    1 .",
    "@xmath1295 for every @xmath477 ; 2 .",
    "@xmath90 restricts to an injective morphism @xmath1296 of filtered groups , for every @xmath439 ; and 3 .",
    "@xmath1297 for each @xmath65 ( after naturally identifying each vertex group @xmath1259 of @xmath1298 with its image in @xmath1292 under @xmath1299 ) .    for @xmath367",
    "define @xmath1300 the filtration @xmath1285 of @xmath86 is @xmath1301-invariant , for each @xmath367 . for each @xmath65 ,",
    "the iterated hnn extension @xmath1302 of @xmath1303 is residually @xmath0 , by assumption , hence by corollary  [ cor : generate hnn ] ( or simply because @xmath1303 is a direct summand of the @xmath76-linear space @xmath409 ) , there is a @xmath0-group containing @xmath409 and an extension of each @xmath1304 , @xmath408 , to an inner automorphism .",
    "hence by lemma  [ lem : hnn ] there is a @xmath0-group @xmath1305 and for each @xmath408 an element @xmath1306 such that @xmath1307 for all @xmath408 and @xmath1308 .",
    "hence @xmath90 extends to a morphism @xmath1309 by @xmath1310 for all @xmath408 and so by lemma  [ residual p criterion ] , @xmath3 is residually @xmath0 .    in section  [ sec : virtual res p ]",
    "we use the theorem above to prove a criterion for the fundamental group of a graph of groups to be _ virtually _ residually @xmath0 .",
    "a last missing ingredient is a procedure on graphs of groups introduced in the next section .",
    "let @xmath31 be a graph of groups with underlying graph @xmath362 and fundamental group @xmath54 .",
    "suppose @xmath1311 is a surjective group morphism to a finite group @xmath214 which is trivial on each vertex group @xmath35 of @xmath31 . by theorem  [ thm : bass - serre ]",
    ", the ( finite index , normal ) subgroup @xmath1312 of @xmath3 can also be realized as the fundamental group of a certain graph of groups whose vertex and edge groups are given by the vertex respectively edge groups of @xmath31 .",
    "we need an explicit description of such a graph of groups @xmath38 , which may be thought of as a kind of `` unfolding '' of @xmath31 along @xmath90 .",
    "we begin with a description of the underlying graph @xmath1313 of @xmath38 .",
    "let @xmath362 be a graph ; we write @xmath363 and @xmath364 .",
    "we denote by @xmath1314 the fundamental group of @xmath362 , i.e. , @xmath1315 where @xmath1316 is the graph of groups based on @xmath362 with trivial vertex groups .",
    "we fix a maximal subtree @xmath79 of @xmath362 , and identify @xmath1314 with @xmath1317 as indicated in .",
    "let @xmath214 be a finite group and @xmath1318 a surjective group morphism .",
    "note that then @xmath90 extends uniquely to a group morphism @xmath1319 .",
    "( this depends on the choice of @xmath79 . ) here @xmath1320 is the path group of @xmath1316 , i.e. , the group generated by @xmath379 subject to the relations @xmath1321 for @xmath367 .",
    "we have @xmath1322 for all @xmath477 .",
    "let now @xmath544 be the finite graph with vertex set @xmath1323 , edge set @xmath1324 , and @xmath1325 for all @xmath1326 .",
    "it is easy to see that @xmath544 is connected since @xmath1327 generates the group @xmath214 .",
    "we have a natural morphism @xmath1328 of graphs given by @xmath1329 we call @xmath396 the _ unfolding of the graph @xmath362 along @xmath90 . _",
    "ostensibly , @xmath396 seems to depend on the choice of @xmath79 .",
    "however , it is not hard to see ( e.g. , using covering spaces and proposition  [ prop : phistar ] below ) that in fact , given another choice @xmath1330 of maximal subtree of  @xmath362 and @xmath1331 constructed as above , there exists an isomorphism @xmath1332 of graphs such that @xmath1333 .",
    "if @xmath362 is a tree ( so @xmath1334 , then the group @xmath1314 and hence @xmath214 is trivial , and @xmath544 is naturally isomorphic to the original graph @xmath362 .",
    "there is an obvious connection between unfolding of graphs and cayley graphs of finite groups , as explained in the following example ( not used later ) :    recall that given a generating set @xmath837 of a group @xmath98 , the cayley graph of @xmath98 with respect to @xmath837 is the _ oriented _ ( possibly infinite ) graph @xmath1335 with vertex set @xmath1336 , orientation @xmath1337 , and @xmath1338 let @xmath401 be an orientation of @xmath362 ; then @xmath1339 generates @xmath214 , and @xmath1340 is an orientation of @xmath544 .",
    "thus the natural surjections @xmath1341 and @xmath1342 define a morphism @xmath1343 of graphs . in particular , if @xmath362 has only a single vertex , and @xmath1344 is injective , then @xmath544 is nothing but the cayley graph of @xmath214 with respect to its generating set @xmath1339 .",
    "we continue to use the notation introduced in the last subsection , but assume in addition that we are given a graph of groups @xmath31 based on @xmath362 .",
    "we define @xmath38 as the graph of groups with underlying graph  @xmath544 , vertex respectively edge groups @xmath1345 and edge morphisms @xmath1346 there is a natural morphism @xmath610 of graphs of groups with underlying morphism of graphs @xmath1347 , which is the identity on each vertex group @xmath1348 and on each edge group @xmath1349 .",
    "this morphism , also denoted by @xmath396 , yields a surjective morphism @xmath1350 , which restricts to a morphism @xmath1351 between fundamental groups .",
    "we call @xmath396 the _ unfolding of @xmath31 along @xmath90 . _ in the proposition below we continue to denote the extension of @xmath1352 to a morphism @xmath1353 with @xmath775 for @xmath1354 , @xmath414 , by the same symbol .    the following proposition may also be proved easily using the topological interpretation of graphs of groups ; we give a purely algebraic proof .",
    "[ prop : phistar ] the morphism @xmath554 is injective , with image @xmath1312 .",
    "let @xmath1355 be a base point of @xmath3 , that is , @xmath529 .",
    "we choose @xmath1356 as our base point for @xmath1357 .",
    "let @xmath1358 be an element of @xmath1359 : @xmath1360 where @xmath1361 , and @xmath1362 and @xmath1363 note that then @xmath1364 by and @xmath1365 by , so @xmath1366 conversely , given an element @xmath1367 of @xmath14 , defining @xmath1368 as in and yields an element @xmath1358 of @xmath1359 as above with @xmath1369 .",
    "this shows that @xmath1370 .",
    "now suppose @xmath1371 , and the representation of @xmath1358 above is reduced , that is , either    1 .",
    "@xmath449 and @xmath450 ; or 2 .",
    "@xmath426 and @xmath1372 for each @xmath258 such that @xmath1373 .",
    "since @xmath1374 , the image @xmath1375 of @xmath1358 under @xmath554 is also represented by a reduced path .",
    "thus @xmath554 is injective .",
    "the following simple observation is used in section  [ sec : virtual res p ] .",
    "[ lem : unfolding and quotients ] let @xmath1318 be a morphism onto a finite group , and let @xmath91 be the unfolding of @xmath31 along @xmath90 .",
    "let @xmath1376 be a compatible collection of normal subgroups of @xmath31 , and let @xmath1377 be the unfolding of @xmath1123 along @xmath90",
    ". then @xmath1378 as graphs of groups , where @xmath1379 .",
    "we leave the proof to the reader",
    ".      it might be instructive for the reader to see the unfolding procedure at work in a concrete simple example .",
    "( the material in this subsection is not used later . )",
    "suppose the underlying graph @xmath362 of  @xmath31 has only one vertex @xmath386 ; we write @xmath1380 .",
    "the fundamental group of @xmath31 is the iterated hnn extension @xmath1381 of @xmath88 , where @xmath401 is an orientation of @xmath362 . in this case , the definition of the unfolding @xmath38 of @xmath31 along @xmath90 given above simplifies somewhat : we may simply describe its underlying graph @xmath544 by @xmath1382 , @xmath1324 , and @xmath1383 and we have @xmath1384 for @xmath1326 .",
    "figure  [ fig : loop ] illustrates this for the case where @xmath362 has only one topological edge @xmath374 , and @xmath1385 is cyclic , with @xmath1386 .",
    "@xmath1387&\\quad } \\xygraph { !",
    "{ < 0cm,0cm>;<1cm,0cm>:<0cm,1 cm > : : } ! { ( 0,0);a(0)**{}?(2.0)}*+{\\sigma\\times 0}=\"g0 \" ! { ( 0,0);a(36)**{}?(2.0)}*+{\\sigma\\times 1}=\"g1 \" ! { ( 0,0);a(72)**{}?(2.0)}*+{\\sigma\\times 2}=\"g2 \" ! { ( 0,0);a(108)**{}?(2.0)}*+{}=\"g3 \" ! { ( 0,0);a(144)**{}?(2.0)}*+{}=\"gi-2 \" ! { ( 0,0);a(180)**{}?(2.0)}*+{\\sigma\\times i}=\"gi-1 \" ! { ( 0,0);a(216)**{}?(2.0)}*+{\\sigma\\times ( i+1)}=\"gi \" ! { ( 0,0);a(252)**{}?(2.0)}*+{}=\"gi+1 \" ! { ( 0,0);a(288)**{}?(2.0)}*+{}=\"gs-2 \" ! { ( 0,0);a(324)**{}?(2.0)}*+{\\sigma\\times ( s-1)}=\"gs-1 \" \" g0\":@/_0.5em/\"g1\"_{\\varphi } \" g1\":@/_0.5em/\"g2\"_{\\varphi } \" g2\":@/_0.5em/\"g3 \" \" g3\":@{.}@/_0.2em/\"gi-2 \" \" gi-2\":@/_0.5em/\"gi-1 \" \" gi-1\":@/_0.5em/\"gi\"_{\\varphi } \" gi\":@/_0.5em/\"gi+1 \" \" gi+1\":@{.}@/_0.2em/\"gs-2 \" \" gs-2\":@/_0.5em/\"gs-1 \" \" gs-1\":@/_0.5em/\"g0\"_{\\varphi } } \\ ] ]    suppose now that @xmath214 is a subgroup of @xmath1388 , and for each edge @xmath372 of @xmath362 , the automorphism @xmath1389 extends the partial automorphism @xmath1124 of @xmath88 .",
    "let @xmath95 be a maximal subtree of @xmath544 , and identify each vertex group @xmath1390 with a subgroup of @xmath1391 as usual .",
    "in this situation unfolding has the following desirable property :    [ lem : unfolding hnn ] there exists a morphism @xmath1392 which is bijective on each vertex group @xmath1390 of @xmath38 .    for all @xmath1326 ,",
    "the isomorphism @xmath1393 extends @xmath1394 , and the composition of the @xmath1393 along the geodesic @xmath1395 from the vertex @xmath1014 to @xmath163 in @xmath95 is the isomorphism @xmath1396 given by @xmath1397 .",
    "hence by lemma  [ lem : special amalgam ] there is a morphism @xmath1398 which , for each @xmath1399 , extends @xmath1400 ( and hence is bijective on @xmath1390 ) .",
    "now @xmath1401 , and therefore @xmath1402 ( see figure  [ fig : unfolding hnn ] . )",
    "this allows us to extend @xmath1091 to a morphism @xmath1403 by @xmath1404 for all edges @xmath1405 .",
    "an analogue of this fact will be established for general graphs of elementary abelian @xmath0-groups in proposition  [ prop : unfolded ] .",
    "@xmath1406      we now continue where section  [ sec : a reduction theorem ] left off , and put ourselves back in the setting of section  [ subsec : reduction theorem ] .",
    "that is , we let @xmath31 be a graph of finitely generated groups with underlying graph @xmath362 .",
    "we recall the statement of the main theorem of this chapter :    [ thm : reduction theorem , 3 ] if @xmath31 admits a @xmath0-excellent filtration , then the group @xmath54 is virtually residually @xmath0 .    throughout the rest of this section , we fix a maximal subtree @xmath79 of the underlying graph @xmath362 of @xmath31 .",
    "we identify @xmath3 with @xmath463 and in this way each vertex group  @xmath35 of @xmath31 with a subgroup of @xmath3 .",
    "theorem  [ thm : reduction theorem , 3 ] will be obtained by applying the reduction theorem ( theorem  [ thm : reduction theorem ] ) to a suitable finite index subgroup of @xmath30 ; the heart of the construction of such a subgroup is contained in the following proposition :    [ prop : unfolded ] suppose all vertex groups @xmath35 of @xmath31 are elementary abelian @xmath0-groups .",
    "then there exists a morphism @xmath1318 onto a finite group @xmath214 , with corresponding unfolding @xmath610 of @xmath31 , and a morphism @xmath1407 which is injective when restricted to each vertex group of @xmath38 .",
    "we exploit the homogeneity of the elementary abelian @xmath0-group @xmath1408 : choose an orientation @xmath401 of @xmath1244 , i.e. , @xmath379 is the disjoint union @xmath1409 ; and for every @xmath408 choose an extension of the partial automorphism @xmath1410 of @xmath88 to an automorphism @xmath1411 of @xmath88 .",
    "we denote the free group on the generators @xmath401 by @xmath57 .",
    "note that @xmath1412 .",
    "we let @xmath1413 be the morphism with @xmath1414 ( @xmath408 ) , and we consider the semidirect product @xmath1415 of @xmath57 with @xmath88 via @xmath90 : @xmath1416 we have a surjective morphism of the group @xmath1417 onto @xmath1415 which is the identity on @xmath88 and on @xmath401 .",
    "composing with the natural morphism @xmath1418 we thus obtain a morphism @xmath1419 which is injective on the vertex groups of @xmath31 .",
    "let @xmath214 be the subgroup of @xmath1388 generated by the @xmath1411 ( @xmath408 ) .",
    "writing @xmath1420 , we have a short exact sequence @xmath1421 note that @xmath98 acts trivially on @xmath88 , in particular , @xmath1422 . as in section  [ sec : unfolding a graph of groups ] we continue to denote the extension of @xmath1352 to a morphism @xmath1353 which is the trivial morphism on each vertex group @xmath35 by the same symbol @xmath90 .",
    "then the following diagram commutes : @xmath1423^\\psi \\ar[dr]^\\psi & f\\ltimes\\sigma \\ar[d ] \\\\        & a. } \\ ] ] we let @xmath91 be the unfolding of @xmath31 along @xmath1424 as constructed in section  [ subsec : unfolding ] above . then by proposition  [ prop : phistar ]",
    "@xmath1425 and thus @xmath1426 so there is a morphism @xmath1427 making the diagram @xmath1428_{\\phi _ * } \\ar[r]^{\\widetilde{\\psi } } & \\gamma\\ltimes\\sigma \\ar[d ] \\\\",
    "\\pi_1(\\scrg ) \\ar[r]^\\psi   & f\\ltimes\\sigma } \\ ] ] commute .",
    "clearly @xmath1429 is injective on the vertex groups of @xmath38 .",
    "let @xmath247 be the natural projection @xmath1430 .",
    "then @xmath1431 is injective on the vertex groups of @xmath38 .    for the following corollary of proposition  [ prop : unfolded ] , let @xmath1376 be a compatible collection of normal subgroups of @xmath31 with @xmath1432 for all @xmath439 .",
    "( later this will be applied to @xmath1433 where @xmath111 is a complete @xmath0-excellent filtration of @xmath31 . )",
    "then @xmath1123 is a graph of elementary abelian @xmath0-groups based on @xmath362 . given a morphism @xmath91 we denote by @xmath1434 the compatible collection of normal subgroups of @xmath552 defined in lemma  [ lem : morphisms and filtrations , 1 ] .",
    "note that then @xmath1435 for all vertices @xmath1436 of the underlying graph @xmath544 of @xmath38 .",
    "[ cor : unfolded , 1 ] there exists a morphism @xmath1437 of graphs of groups with the following properties :    1 .",
    "each group morphism @xmath1438 and @xmath1439 is bijective ; 2 .",
    "the induced group morphism @xmath1440 is injective ; 3 .",
    "its image @xmath653 is a finite index normal subgroup of @xmath3 ; and 4 .   for every maximal subtree @xmath95 of the graph underlying the graph of groups  @xmath38 ,",
    "the group @xmath1441 is residually @xmath0 .",
    "applying proposition  [ prop : unfolded ] with @xmath1123 in place of @xmath31 , we obtain a morphism @xmath1442 to a finite group , with corresponding unfolding @xmath1377 of @xmath1123 , and a morphism @xmath1443 to an elementary abelian @xmath0-group which is injective when restricted to each vertex group of @xmath1444 .",
    "let @xmath91 be the unfolding of @xmath31 along @xmath90 . then ( 1)(3 )",
    "hold by proposition  [ prop : phistar ] . by lemma  [ lem : unfolding and quotients ]",
    "we have @xmath1445 , hence ( 4 ) follows from lemma  [ lem : crucial ]",
    ".    we can now prove theorem  [ thm : reduction theorem , 3 ] .",
    "suppose first that @xmath111 is a _",
    "complete _ @xmath0-excellent filtration of @xmath31 .",
    "apply corollary  [ cor : unfolded , 1 ] with @xmath1446 , and let @xmath91 have properties ( 1)(4 ) in that corollary . by ( 1 ) and lemmas  [ lem : separating , 1 ] and [ lem : separating , 2 ] ,",
    "the filtration @xmath1447 of @xmath38 remains @xmath0-excellent .",
    "this together with ( 4 ) shows that @xmath38 satisfies the hypotheses of theorem  [ thm : reduction theorem ] .",
    "hence @xmath1359 is residually @xmath0 , and thus by ( 2 ) and  ( 3 ) , the group @xmath30 is virtually residually @xmath0 .",
    "if @xmath111 is an arbitrary @xmath0-excellent filtration of @xmath31 , we consider a morphism of graphs of groups satisfying ( 1)(3 ) in proposition  [ prop : commoncover ] applied to the compatible collection of normal subgroups @xmath1448 of @xmath31 .",
    "the pullback of @xmath111 under such a morphism is complete and , by lemmas  [ lem : separating , 1 ] and [ lem : separating , 2 ] , remains @xmath0-excellent . in this way we reduce to the case of complete",
    "@xmath111 treated above .",
    "in this chapter we first define ( in section  [ sec : p - compatible ] ) what we mean by a filtration of a group to be @xmath0-compatible with a given collection of subgroups , and then show ( in section  [ sec : p - compatible linear ] ) a general theorem which allows to construct filtrations of finitely generated linear groups which are @xmath0-compatible with certain abelian subgroups . in section  [ sec :",
    "proof of the main theorem ] we then apply this theorem to give a proof of our main theorem from the introduction .",
    "section  [ sec : approx ] fills in the proof of a commutative algebraic fact used earlier ( in section  [ sec : p - compatible linear ] ) , and section  [ sec : fibered ] discusses the main theorem in the special case of fibered @xmath1-manifolds .",
    "we make the following somewhat ad - hoc definition ( which is related to the `` @xmath0-congruence systems '' of ( * ? ? ?",
    "* interlude  b ) ) :    let @xmath3 be a group , let @xmath1449 be a collection of subgroups of @xmath3 , and let @xmath714 be an integer .",
    "we say that a filtration @xmath1450 of @xmath3 is _",
    "@xmath0-compatible of level @xmath1451 with @xmath1449 _ if the following hold :    1 .",
    "@xmath111 is a normal filtration of @xmath3 with @xmath1452<\\infty$ ] for each @xmath65 ; 2 .",
    "@xmath111 , construed as a complete filtration of @xmath346 , is @xmath0-potent ; 3 .",
    "@xmath111 is separating ( i.e. , @xmath1453 ) ; 4 .",
    "@xmath111 separates @xmath1449 ( i.e. , @xmath1454 for every @xmath1455 ) ; and 5 .   for every @xmath1455 the filtration @xmath111 intersects to the lower central @xmath0-filtration @xmath1456 of @xmath79 , shifted by @xmath1451 terms to the left , i.e. , @xmath1457 .",
    "a filtration of @xmath3 which is @xmath0-compatible of level @xmath732 with @xmath1449 will simply said to be @xmath0-compatible with @xmath1449 .",
    "( we will only encounter @xmath0-compatible filtrations of level @xmath732 or  @xmath163 below . )",
    "if the group @xmath3 admits a filtration which is @xmath0-compatible with some collection of subgroups , then @xmath3 is virtually residually @xmath0 .",
    "we introduced the notion of @xmath0-compatible filtration because it furnishes a `` local '' version of the concept of @xmath0-excellent filtration of a graph of groups considered in the previous chapter : let  @xmath714 be an integer ; then , given a graph of groups @xmath31 and for each vertex @xmath74 a filtration  @xmath63 of @xmath35 which is @xmath0-compatible of level @xmath1451 with the subgroups @xmath675 of @xmath35 , where @xmath372 ranges over all edges with @xmath492 , we obtain a filtration @xmath1458 of @xmath31 .",
    "we say that a filtration @xmath111 of @xmath31 arising in this way is _",
    "@xmath0-compatible of level @xmath1451 .",
    "_ such a @xmath0-compatible filtration @xmath111 of level @xmath1451 of @xmath31 automatically satisfies conditions ( 1)(4 ) in the definition of @xmath0-excellency ; if in addition the lower central @xmath0-series of the edge groups of @xmath31 , shifted by @xmath1451 terms to the left , is uniformly @xmath0-potent ( e.g. , if the edge groups of @xmath31 are abelian @xmath0-torsion free , see section  [ sec : p - potent ] ) , then every @xmath0-compatible filtration of level @xmath1451 is @xmath0-excellent . from the main result ( theorem  [ thm : reduction theorem , 2 ] ) of the preceding chapter we therefore immediately obtain :    [ thm : virt res p for graphs of linear groups , 1 ] let @xmath31 be a graph of finitely generated groups , and suppose all edge groups @xmath55 are abelian @xmath0-torsion free .",
    "suppose for some @xmath714 , @xmath31 admits a @xmath0-compatible filtration of level @xmath1451 .",
    "then @xmath30 is virtually residually @xmath0 .    in the next section",
    "we construct filtrations of linear groups which are @xmath0-compatible with certain abelian subgroups . in section  [ sec : proof of the main theorem ] we ll apply this construction together with the criterion in theorem  [ thm : virt res p for graphs of linear groups , 1 ] above in the case of graphs of groups arising from @xmath1-manifolds .    in the rest of this section",
    "we collect a few more observations on @xmath0-compatible filtrations , and record an application of theorem  [ thm : virt res p for graphs of linear groups , 1 ] .",
    "first we note that under natural conditions , if there is a complete @xmath0-compatible filtration at all , then there is a canonical one , by lemma  [ lem : canonical filtration ] :    [ lem : canonical filtration , 2 ] let @xmath3 be a group and let @xmath1449 be a collection of subgroups of @xmath3 . if  @xmath111 is a central @xmath0-filtration of @xmath3 such that @xmath1459 for every @xmath1455 , then @xmath1460 for every @xmath1455 . therefore , assuming that @xmath233 is @xmath0-potent and @xmath177 is finitely generated , if there exists a complete filtration of @xmath3 which is @xmath0-compatible with @xmath1449 , then @xmath233 is @xmath0-compatible with @xmath1449 .",
    "examples of @xmath0-compatible filtrations of free groups may be obtained via the following :    [ lem : p - compatible for free groups ] let @xmath3 be a finitely generated residually @xmath0 group with @xmath0-torsion free quotients @xmath1461 , for @xmath1462 , and let @xmath1449 be a collection of retracts of @xmath3 . if @xmath0 is odd , then the complete filtration @xmath1463 of @xmath3 is @xmath0-compatible with  @xmath1449 . for arbitrary @xmath0 ,",
    "the filtration @xmath1464 is @xmath0-compatible of level @xmath163 with @xmath1449 .    by lemma",
    "[ lem : retract ] , @xmath233 separates @xmath79 , and by lemma  [ lem : lower central for semidirect products ] we have @xmath1465 .",
    "this shows that @xmath233 satisfies conditions ( 1 ) and ( 3)(5 ) in the definition of @xmath0-compatibility . if @xmath0 is odd , then @xmath233 is @xmath0-potent by corollary  [ cor : phi_n ] , hence @xmath233 is @xmath0-compatible with @xmath1449 . for general @xmath0 , shifting @xmath233 by @xmath163 to the left yields a @xmath0-potent filtration of @xmath1466 , by lemma  [ lem:2-potent ] .",
    "[ retract ]    by virtue of the previous lemma , theorem  [ thm : virt res p for graphs of linear groups , 1 ] applies to graphs of finitely generated residually @xmath0 groups with abelian @xmath0-torsion free edge groups , such that for each edge @xmath372 , the image of the edge group @xmath55 under the edge morphism @xmath489 is a retract of @xmath1106 .",
    "this leads to a refinement of a result of wise :    let @xmath31 be a graph of free groups of finite rank with cyclic edge groups , and @xmath54 .",
    "suppose that @xmath3 is _ balanced , _",
    "i.e. , there are no @xmath4 , @xmath5 , and non - zero integers @xmath106 , @xmath20 with @xmath1467 such that @xmath1468 and @xmath1469 are conjugate . then for every @xmath0 , @xmath3 is virtually residually @xmath0 .",
    "wise @xcite showed that the balancedness condition formulated in this corollary implies that there exists a morphism @xmath1470 of graphs of groups having finite degree and such that @xmath1471 is _ clean _ , that is , each of the ( cyclic ) edge groups of @xmath1471 maps to a free factor of the target ( free ) vertex group under the edge morphism .",
    "he then proved that fundamental groups of clean graphs of free groups are residually finite ; in fact , much better , they are subgroup separable .",
    "our theorem  [ thm : virt res p for graphs of linear groups , 1 ] shows that they are , for each @xmath0 , virtually residually @xmath0 .",
    "note that if @xmath3 is a balanced group , then @xmath3 does not contain any baumslag - solitar group .",
    "hsu and wise @xcite recently showed that if @xmath31 is a graph of free groups with cyclic edge groups and @xmath54 contains no baumslag - solitar group , then @xmath3 virtually embeds into a right - angled artin group , and hence has a finite - index subgroup which is residually @xmath0 for every  @xmath0 ( and is linear over @xmath18 ) ; this also implies the corollary above in a stronger form .",
    "given a commutative ring @xmath51 , we denote by @xmath1472 the group of upper unitriangular @xmath1473-matrices with entries in @xmath51 ( a subgroup of @xmath1474 ) .",
    "a matrix in @xmath1475 is called unipotent if it is conjugate to an element of @xmath1472 , and a subgroup of @xmath1475 is called unipotent if it is conjugate to a subgroup of @xmath1472 .",
    "( if @xmath14 is a field , then every subgroup of @xmath19 consisting entirely of unipotent matrices is unipotent , cf .",
    "* corollary  1.21 ) . ) a subgroup @xmath79 of a group @xmath1476 is said to be maximal unipotent if @xmath79 is unipotent and not contained in a strictly larger unipotent subgroup of @xmath3 .",
    "the main result of this section is :    [ thm : virt res p for graphs of linear groups , 2 ] let @xmath3 be a finitely generated linear group , and let @xmath1449 be a finite collection of finitely generated abelian unipotent subgroups of @xmath3 , such that for each  @xmath1455 ,    1 .",
    "@xmath79 is maximal abelian or maximal unipotent ; and 2 .",
    "the image of @xmath79 in @xmath1477 has rank @xmath1478 .",
    "then for all but finitely many @xmath0 , there exists a filtration of @xmath3 which is @xmath0-compatible of level @xmath163 with @xmath1449 .",
    "the proof of this theorem is given in section  [ sec : proof of thm : virt res p for graphs of linear groups , 2 ] below .",
    "theorem  [ thm : virt res p for graphs of linear groups , 2 ] together with theorem  [ thm : virt res p for graphs of linear groups , 1 ] immediately yields a criterion for the fundamental group of certain graphs of linear groups to be virtually residually @xmath0 ( which refines ( * ? ? ?",
    "* theorem  5.1 ) ) :    [ cor : virt res p for graphs of linear groups ] let @xmath31 be a graph of finitely generated linear groups .",
    "suppose that each edge group @xmath55 maps to a finitely generated abelian unipotent subgroup of  @xmath35 where @xmath520 which is maximal abelian or maximal unipotent in @xmath35 and whose image in @xmath1479 has rank @xmath1480 .",
    "then for all but finitely many  @xmath0 , the group @xmath30 is virtually residually @xmath0 .",
    "the hypothesis  ( 2 ) on @xmath79 in the theorem above is satisfied if @xmath79 is free abelian of rank @xmath34 and maps to an infinite subgroup of @xmath1477 ; this is the situation of interest in our later applications .",
    "hypothesis  ( 2 ) , however , also holds if @xmath79 is cyclic ; hence from the previous corollary we obtain :    let @xmath31 be a graph of finitely generated linear groups with cyclic unipotent edge groups .",
    "suppose that for each edge @xmath372 , the image of @xmath55 in @xmath1209 , where @xmath520 , is maximal abelian .",
    "then for all but finitely many @xmath0 , the group @xmath30 is virtually residually @xmath0 .",
    "before we turn to the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] we present an instructive example :    consider the subgroup @xmath1481 of @xmath1482 , which has a presentation @xmath1483 ( so @xmath3 is the baumslag - solitar group @xmath1484 ) .",
    "the group @xmath3 is metabelian , and its ( unique ) maximal unipotent subgroup is the normal subgroup @xmath1485 \\\\ 0 & 1\\end{smallmatrix } \\right)$ ] of @xmath3 ( isomorphic to the additive group of @xmath1486 $ ] , in particular , not finitely generated ) .",
    "this shows that in general , the assumption in our theorem that @xmath3 be finitely generated does not force its abelian maximal unipotent subgroups to be finitely generated .",
    "( however , if @xmath3 is discrete , then each abelian maximal unipotent subgroup of @xmath3 is finitely generated , so the assumption in our theorem that each member of @xmath1449 be finitely generated may be dropped . )",
    "this example can also be used to show that the hypothesis in corollary  [ cor : virt res p for graphs of linear groups ] that each edge group maps onto a maximal abelian or maximal unipotent subgroup of the target vertex group can not be omitted : let @xmath1487 , a unipotent abelian subgroup of @xmath3 ( which , however , is clearly neither maximal abelian nor maximal unipotent ) .",
    "it was shown by higman @xcite that the amalgamated product @xmath1488 of @xmath3 with itself via the identity @xmath1489 is non - hopfian and hence not residually finite .",
    "of course , examples for this phenomenon ( in the form of hnn extensions of @xmath18 ) are also provided by baumslag - solitar groups : as is well - known , for integers @xmath106 , @xmath20 with @xmath1490 and @xmath1491 , the group @xmath1492 is not residually finite .      a key algebraic ingredient for the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] in full generality is the following fact .",
    "let @xmath51 be a finitely generated subring of @xmath1493 .",
    "it is well - known that for all but finitely many @xmath0 there exists a maximal ideal @xmath1494 of @xmath51 such that @xmath1495 .",
    "( see , e.g. , proposition  [ non - trivial and reduced ] below . ) evidently the characteristic of @xmath1496 then divides @xmath1497 , for every @xmath765 . but in general we do not have @xmath1498 .",
    "( consider , e.g. , @xmath1499 $ ] , @xmath1500 and @xmath267 . )",
    "the following theorem implies that by judicious choice of @xmath0 we can exclude this phenomenon :    [ thm : proprmi ] for all but finitely many primes @xmath0 there exists a maximal ideal  @xmath1501 of @xmath51 such that the localization @xmath1502 of @xmath51 at @xmath1501 is regular unramified of residue characteristic @xmath0 .",
    "we refer to section  [ sec : approx ] below for an explanation of the concepts from commutative algebra mentioned in the conclusion of this theorem . for its application in the present section",
    ", the reader only needs to be aware of one aspect of this conclusion , namely :    [ lem : dividing by p ] let @xmath1503 be a regular unramified local ring of residue characteristic  @xmath0 . then for all @xmath1504 and @xmath1505 : @xmath1506 here @xmath1507 .",
    "this follows immediately from lemma  [ criterion ] below .",
    "in particular , given a prime  @xmath0 and a maximal ideal @xmath1501 as in theorem  [ thm : proprmi ] , we do have @xmath1508 for every  @xmath765 .",
    "it may be worth noting that our theorem thus implies a more precise version of ( * ? ? ?",
    "* proposition  2 ) , which states that except for a finite number of primes @xmath0 , for every @xmath765 there exists a morphism @xmath1509 to some finite ring @xmath1510 such that @xmath1511 .    we postpone the proof of theorem  [ thm : proprmi ] to section  [ sec : approx ] .",
    "we do note here , however , that in the case where @xmath51 is a ring of integers in a number field , this fact is quite easy to show :    suppose @xmath51 is the ring of integers in a number field @xmath14 , and let @xmath1512 be the discriminant of @xmath14 ( a non - zero integer ) .",
    "for every @xmath0 there exists a prime ( hence maximal ) ideal @xmath1494 of @xmath51 , and @xmath1513 is a dvr ( hence regular ) of residue characteristic @xmath0 .",
    "moreover , if @xmath0 does not divide @xmath1512 , then for every such @xmath1494 , @xmath1513 is unramified .",
    "( see any standard text in algebraic number theory , e.g. , ( * ? ? ?",
    "* chapter  iii , section  2 ) . )",
    "this allows us to give a proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] in the case relevant to our applications to @xmath1-manifolds ( namely , where @xmath3 is a lift of a finite covolume torsion free kleinian group ) which bypasses theorem  [ thm : proprmi ] ; this point will be addressed in section  [ sec : kleinians ] .",
    "before we now turn the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] , we make some observations on congruence subgroups .",
    "let @xmath1514 be a complete noetherian local ring whose residue field @xmath1515 is finite of characteristic @xmath0 . for every @xmath765",
    "the natural surjective ring morphism @xmath1516 induces a surjective group morphism @xmath1517 whose kernel is called the _ @xmath258-th congruence subgroup _ of @xmath1474 , and denoted by @xmath1518 .",
    "note that @xmath1496 and hence @xmath1519 are finite , for any @xmath765 . in the following we abbreviate @xmath1520 , and set @xmath1521 .",
    "if @xmath51 is an integral domain , then @xmath1522 by the krull intersection theorem , hence the normal filtration @xmath1523 of @xmath1474 is separating ( and thus @xmath1474 is residually finite ) .",
    "proofs of the following properties of congruence subgroups can be found in @xcite ( see also ( * ? ? ?",
    "* chapter  13 ) ) . given an ideal @xmath1524 of @xmath51 ,",
    "we write @xmath1525 for the @xmath258-th cartesian power of the set @xmath1524 ( not to be confused with the @xmath258-th power @xmath1526 of the ideal @xmath1524 ) .    [",
    "prop : ls94 ] for all integers @xmath1527 :    1 .",
    "@xmath1528 an elementary abelian @xmath0-group ; 2 .",
    "@xmath1529 \\subseteq g_{i+j}$ ] ; 3 .",
    "@xmath1530 if @xmath51 has equal characteristic @xmath0 .    in particular , by ( 1 ) and ( 2 ) , @xmath1523 is a ( strongly ) central @xmath0-filtration of @xmath1531 , hence @xmath1532 for every @xmath765 .",
    "if @xmath51 has equal characteristic @xmath0 , then @xmath1523 is also dimensional , by ( 3 ) , so @xmath1533 for every @xmath765 . under additional assumptions ,",
    "these statements can be strengthened :    ( * ? ? ?",
    "* proposition  3.2 ) if @xmath1534 or @xmath1535 , then @xmath1536 and if in addition @xmath51 is of equal characteristic @xmath0 , then @xmath1537    the following lemma combined with the previous proposition shows that for odd @xmath0 and well - behaved @xmath51 , the filtration @xmath1523 of @xmath3 is strongly @xmath0-potent :    suppose that @xmath0 is odd and @xmath1514 is regular unramified .",
    "then for every @xmath765 , the morphism @xmath1538 induced by @xmath1539 is injective .",
    "let @xmath1540 , @xmath765 , such that @xmath1541 ; we need to show @xmath1542 .",
    "write @xmath1543 where @xmath1544",
    ". then @xmath1545 we have @xmath1546 since @xmath296 , and @xmath1547 .",
    "moreover , for @xmath1548 , every binomial coefficient @xmath1549 is divisible by @xmath0 .",
    "therefore @xmath1550 . since @xmath1514 is regular unramified of residue characteristic @xmath0 , this yields @xmath1551 as required ( lemma  [ lem : dividing by p ] ) .",
    "let @xmath51 be a commutative ring .",
    "given an @xmath1473-matrix @xmath1552 with entries in @xmath51 and @xmath1553 , we call the @xmath1554-tuple @xmath1555 the @xmath1067th codiagonal of @xmath25",
    ". so the @xmath732th codiagonal is the main diagonal of @xmath25 ; an upper triangular matrix whose main diagonal is zero is called strictly upper triangular . if @xmath25 is strictly upper triangular and the @xmath258th codiagonal of @xmath25 vanishes for @xmath1556 , then @xmath1557 .",
    "the following lemma is obvious if @xmath72 ( the case of interest in the situation arising from @xmath1-dimensional topology considered in section  [ sec : proof of the main theorem ] ) .",
    "[ lem : order ] suppose @xmath51 has characteristic @xmath1558 where @xmath291 and @xmath1559",
    ". then @xmath1472 has exponent @xmath1558 .",
    "if @xmath25 is a non - zero strictly upper triangular @xmath1473-matrix over @xmath51 and some entry in the first non - zero codiagonal of @xmath25 is a unit in @xmath51 , then @xmath1560 has order @xmath1558 .    note that every element @xmath722 of @xmath1561 has the form @xmath1543 where @xmath25 is strictly upper triangular ( in particular , @xmath1562 )",
    "; hence @xmath1563 since for @xmath1564 , the binomial coefficient @xmath1565 is divisible by @xmath1558 .",
    "now suppose in addition that @xmath1566 and some entry in the first non - zero codiagonal of @xmath25 is a unit in @xmath51 .",
    "say this entry occurs in the @xmath1067th codiagonal of @xmath25 , where @xmath1567 .",
    "then all entries in the @xmath1067th codiagonal of @xmath1568 are zero .",
    "since for every @xmath765 , @xmath1569 and a unit of @xmath51 has order @xmath1558 as element of the additive group of @xmath51 , we see that  @xmath1570 has order @xmath1558 .",
    "let now @xmath3 be a finitely generated linear group , and suppose @xmath1571 is a collection of finitely generated abelian unipotent subgroups of @xmath3 , such that each @xmath1572 is maximal abelian or maximal unipotent , and @xmath1573 we write @xmath1572 additively ; also , the natural morphism @xmath1574 is an isomorphism , and in the following we identify these two groups using this map .",
    "we pick a family @xmath1575 of elements of @xmath1572 which form a basis for @xmath1576 . in the case that @xmath1577 we choose @xmath1578 to lie in @xmath1579 .    in order to prove",
    "the theorem we may and shall assume that @xmath1580 for some @xmath1581 .",
    "take @xmath1582 such that @xmath1583 .",
    "since @xmath3 is finitely generated there is a finitely generated subring @xmath51 of @xmath1584 which contains all the entries of each element of @xmath3 , as well as all entries of @xmath1585 for @xmath1030 and the multiplicative inverses of the non - zero entries of @xmath1586 , for @xmath1030 . by theorem  [ thm : proprmi ]",
    "there exists a finite set @xmath86 of primes such that for any prime @xmath1587 there exists a maximal ideal @xmath1494 of @xmath51 such that @xmath1588 is regular unramified of residue characteristic @xmath0 .",
    "we write @xmath1589 . as",
    "a consequence of the elementary divisors theorem for subgroups of finitely generated free abelian groups ( * ? ? ?",
    "* theorem  iii.7.8 ) , after enlarging @xmath86 suitably if necessary , we may assume that for any  @xmath1587 , any @xmath1590 and any @xmath1591 we have @xmath1592 in the case that @xmath1577 , the element @xmath1593 maps to zero under the map @xmath1594 .",
    "again , after enlarging @xmath86 if necessary , we may also assume that @xmath86 contains all primes @xmath157 .",
    "let now @xmath0 be a prime with @xmath1595 .",
    "let @xmath1494 be a maximal ideal of @xmath51 such that the local ring @xmath1588 , whose completion we denote by @xmath1596 , is regular unramified of residue characteristic @xmath0 .",
    "the natural ring morphisms @xmath1597 are injective , hence give rise to a group embedding @xmath1598 .",
    "we denote the map @xmath1599 by @xmath1600 , and the map @xmath1601 by  @xmath833 . given @xmath1591 we denote the map @xmath1602 by  @xmath1603 , and we denote the map @xmath1604 by  @xmath1605 .",
    "for @xmath1591 we now let @xmath1606 we claim that the filtration @xmath1607 of @xmath3 is @xmath0-compatible with @xmath1449 of level  @xmath163 . by the results in section  [ sec : csg ] , @xmath111 is a separating normal @xmath0-filtration of @xmath3 with each  @xmath1608 of finite index in @xmath3 , and considered as a complete filtration of @xmath346 , @xmath111 is central and ( strongly ) @xmath0-potent .    to see that @xmath111 separates @xmath1449 ,",
    "let @xmath1609 and @xmath1610 .",
    "if @xmath1611 is maximal unipotent , we have @xmath1612 ; since @xmath1613 there exists @xmath1591 such that @xmath1614 .",
    "if @xmath1572 is maximal abelian , then there is some @xmath1615 with @xmath1616\\neq 1 $ ] ; as before , there is some @xmath1067 such that @xmath1617 ) = [ \\ol{\\rho}(g),\\ol{\\rho}(t)]$ ] in @xmath1618 . in both cases we obtain @xmath1619 , i.e. , @xmath1620 .",
    "it remains to show that @xmath1621 since @xmath1572 ( being unipotent ) is torsion free , we have @xmath1622 ; we need to show that @xmath1623 recall that @xmath1624 note that by choice of @xmath51 and @xmath1501 , lemma  [ lem : order ] implies that the matrix @xmath1625 has order @xmath1626 in @xmath1618 .",
    "so in the case that @xmath1627 we clearly have @xmath1628 as desired . if @xmath1577 then @xmath1629 , whereas @xmath1625 has order @xmath1630 ; thus also in this case @xmath1628 .",
    "suppose in the proof of the theorem , in addition to @xmath1595 we also require that @xmath0 is such that @xmath352 is @xmath0-torsion free .",
    "then the filtration @xmath1631 of @xmath1466 is @xmath0-potent , by lemma  [ lem:2-potent ] .",
    "moreover , by proposition  [ prop : lower p ] ,  ( 2 ) we have @xmath1632 with equality for @xmath1633 . hence ( identifying @xmath3 with its image in @xmath1634 under @xmath1600 ) , the filtration @xmath1635 of @xmath3 defined by @xmath1636 is also @xmath0-compatible with @xmath1449 of level @xmath163 , cf .",
    "lemma  [ lem : canonical filtration ] .      in this section",
    "we give a proof of the main theorem as stated in the introduction , by applying the results of the previous section .",
    "we begin by first discussing the special cases of hyperbolic @xmath1-manifolds and seifert fibered manifolds .",
    "it is a well - known fact that the fundamental group of every hyperbolic @xmath1-manifold is linear and hence virtually residually @xmath0 , for all but finitely many @xmath0 .",
    "we need a more precise formulation of this fact :    let @xmath25 be a @xmath1-manifold which is either closed or has incompressible boundary .",
    "let @xmath1449 be the collection of fundamental groups of the boundary components of @xmath25 , considered as subgroups of @xmath27 in the natural way .",
    "given a prime @xmath0 and an integer @xmath714 we say that a filtration @xmath111 of @xmath3 is a _ boundary compatible @xmath0-filtration of level @xmath1451 _ for @xmath25 if @xmath111 is @xmath0-compatible of level @xmath1451 with the collection of subgroups @xmath1637 , @xmath1455 .    [ prop : virtphyp ] let @xmath25 be an orientable @xmath1-manifold with empty or toroidal and incompressible boundary such that the interior of @xmath25 has a complete hyperbolic structure .",
    "then for all but finitely many @xmath0 , there exists a boundary compatible @xmath0-filtration of level @xmath163 for @xmath25 .",
    "we need a topological lemma sketched in @xcite :    [ lem : maximal abelian ] let @xmath25 be an orientable @xmath1-manifold with toroidal incompressible boundary , and let @xmath79 be a component of @xmath1638 .",
    "then @xmath1637 is a maximal abelian subgroup of @xmath26 , i.e. , no element of @xmath1639 commutes with @xmath1637 .",
    "suppose @xmath1640 and @xmath1637 generate an abelian subgroup  @xmath214 of @xmath26 which properly contains @xmath1637 .",
    "since @xmath25 is not a @xmath1-torus , @xmath1641 by ( * ? ?",
    "* theorem  9.13 ) .",
    "denote by @xmath1642 the covering of @xmath25 corresponding to @xmath214 .",
    "there exists a compact submanifold @xmath722 of @xmath103 such that @xmath1643 is an isomorphism ( * ? ? ?",
    "* theorem  8.6 ) .",
    "we can assume that @xmath722 contains a homeomorphic lifting @xmath837 of @xmath79 in its boundary .",
    "since @xmath1637 is of finite index in  @xmath214 and since @xmath25 is orientable , we can apply ( * ? ? ? * theorem  10.5 ) to conclude that @xmath722 is a product @xmath1644 $ ] with possibly some @xmath1-balls removed . in particular",
    "@xmath1645 is an isomorphism , which implies that @xmath1646 is an isomorphism , contradicting our assumption that @xmath1647 .",
    "now let @xmath25 be an orientable @xmath1-manifold with empty or toroidal and incompressible boundary .",
    "suppose moreover that @xmath25 is hyperbolic , so @xmath27 has a faithful representation to a discrete torsion free subgroup of @xmath1648 .",
    "thurston showed ( cf . ,",
    "e.g. , ( * ? ? ?",
    "* proposition  3.1.1 ) or @xcite ) that this representation lifts to a discrete and faithful representation @xmath1649 ; we identify @xmath3 with its image under this embedding .",
    "let now @xmath79 be one of the ( toroidal ) components of @xmath1638 .",
    "standard poincar duality arguments yield that the natural image of @xmath1650 in  @xmath1477 has rank @xmath1651 .",
    "every discrete abelian subgroup of @xmath1652 of rank @xmath34 is unipotent ( cf .",
    "hence @xmath1637 is unipotent ; in fact , by the previous lemma , @xmath1637 is a maximal unipotent subgroup of @xmath3 .",
    "proposition  [ prop : virtphyp ] now is a consequence of theorem  [ thm : virt res p for graphs of linear groups , 2 ] .      in the proof of theorem  [ thm :",
    "virt res p for graphs of linear groups , 2 ] in the previous section , given a finitely generated subgroup @xmath3 of @xmath1653 , we chose a certain finitely generated subring @xmath51 of @xmath1584 so that @xmath1654 , and we appealed to theorem  [ thm : proprmi ] to obtain , for all but finitely many @xmath0 , a maximal ideal @xmath1501 of @xmath51 such that @xmath1655 for every @xmath1591 . above , this result has been applied in the context where @xmath3 is a lift from @xmath1648 of a finite covolume torsion free kleinian group .",
    "thurston observed that then the mostow rigidity theorem implies that @xmath3 is conjugate ( in @xmath1652 ) to a subgroup of @xmath1656 where @xmath14 is a number field .",
    "( in fact , @xmath14 can be taken to be a quadratic extension of the trace field @xmath1657 of @xmath3 , see ( * ? ? ?",
    "* corollary  3.2.4 ) . ) hence in this case , the ring @xmath51 introduced in the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] may be assumed to be a subring of a ring @xmath1658 of @xmath837-integers of a number field @xmath14 .",
    "the ring @xmath1658 is not finitely generated in general .",
    "however , all but finitely many @xmath0 are unramified in @xmath14 and do not become units in  @xmath1658 , and for those @xmath0 , if we choose the prime ideal @xmath1659 of @xmath1658 which contains @xmath0 , then @xmath1659 is maximal and @xmath1660 is regular unramified with finite residue field of characteristic @xmath0",
    ". we may now carry out the rest of the argument in the proof above with @xmath51 and @xmath1494 replaced by @xmath1658 respectively @xmath1659 .",
    "thus , in this application of theorem  [ thm : virt res p for graphs of linear groups , 2 ] one may avoid the use of theorem  [ thm : proprmi ] at the cost of appealing to a non - trivial fact from hyperbolic geometry . in general , however , theorem  [ thm : virt res p for graphs of linear groups , 2 ] can not simply be reduced to the number field case : there do exist finitely presented linear groups which admit no faithful representation as linear groups over global fields whatsoever @xcite .",
    "in the case of seifert fibered spaces we have :    [ prop : seifert res p ] let @xmath25 be a seifert fibered space .",
    "then @xmath26 has a finite index subgroup which is residually @xmath0 for every @xmath0 .",
    "rhemtulla @xcite showed that every group which is residually @xmath0 for infinitely many @xmath0 is bi - orderable .",
    "hence the previous proposition also yields another proof of the result ( obtained in ( * ? ? ?",
    "* corollary  1.6 ) ) that fundamental groups of seifert fibered spaces are virtually bi - orderable . by similar arguments as the ones used below in the proof of this proposition one",
    "may also show the folklore result that the fundamental group of a seifert fibered space is linear over @xmath18 ; we will not pursue this here .",
    "[ lem : s1-bundles res p ] suppose @xmath1661 is an @xmath1662-bundle where @xmath57 is an orientable surface with @xmath1663 . then @xmath26 has a finite index subgroup which is residually @xmath0 for each @xmath0 .",
    "if @xmath25 has non - empty boundary , then @xmath57 also has non - empty boundary and we obtain @xmath1664 , hence the euler class of the @xmath1662-bundle @xmath1661 is trivial . we therefore conclude that @xmath25 is a trivial @xmath1662-bundle , i.e. , @xmath1665 .",
    "but then @xmath1666 is the direct product of @xmath18 with a free group , hence @xmath26 is residually @xmath0 for each @xmath0 .",
    "now assume that @xmath25 and hence @xmath57 is closed .",
    "the subgroup @xmath1667 of @xmath26 generated by a regular fiber @xmath384 is normal and infinite cyclic , and we have a short exact sequence @xmath1668 let @xmath1669 be the euler class of @xmath57 .",
    "a presentation for @xmath1670 is given by @xmath1671=t^e,\\ \\text{$t$ central}\\right\\rangle.\\ ] ] let @xmath1672=u,\\ \\text{$u$ central}\\right\\rangle.\\ ] ] one verifies easily that the finitely presented group @xmath7 is torsion free , @xmath1673 , and @xmath1674 ( hence @xmath7 is nilpotent ) .",
    "thus @xmath7 is residually @xmath0 for every @xmath0 ( * ? ? ? * theorem  2.1  ( i ) ) .",
    "let @xmath55 be the subgroup of @xmath3 generated by the @xmath1675 , @xmath1676 and @xmath1677 .",
    "the assignment @xmath1678 yields a morphism @xmath1679 .",
    "let also @xmath1680 be the composition @xmath1681 then @xmath1682 is an embedding .",
    "it is well - known that orientable surface groups , such as @xmath1683 , are residually free ( cf .",
    "@xcite ) and hence residually @xmath0 for each @xmath0 .",
    "this shows that the finite index subgroup @xmath55 of @xmath3 is residually @xmath0 for each @xmath0",
    ".    clearly we only have to consider the case that the fundamental group of @xmath25 is infinite . in that case",
    "it is well - known that @xmath25 is finitely covered by a @xmath1-manifold which is an @xmath1662-bundle over an orientable surface @xmath57 with @xmath1663 ( cf .",
    "now use lemma  [ lem : s1-bundles res p ] .",
    "analogous to proposition  [ prop : virtphyp ] we also have , for certain trivial @xmath1662-bundles :    [ prop : seifert simple lower p - central ] suppose @xmath1665 where @xmath57 is an orientable surface with at least two boundary components , and @xmath27",
    ". then for any @xmath0 there exists a boundary compatible @xmath0-filtration of level @xmath163 for @xmath25 .",
    "this follows immediately from lemma  [ lem : p - compatible for free groups ] , observing that since @xmath57 has at least two boundary components , its fundamental group @xmath1684 is free , and for each @xmath1685 representing a boundary curve of @xmath57 , the subgroup @xmath1686 of @xmath98 generated by @xmath1687 is a free factor of @xmath98 .",
    "let @xmath57 be an orientable surface .",
    "it is a classical fact ( fricke ) that @xmath1688 has a faithful representation as a fuchsian group such that each boundary curve @xmath1687 of @xmath57 is represented by a parabolic transformation @xcite .",
    "that is , there is a faithful representation @xmath1689 where each @xmath1687 is represented by a unipotent matrix in @xmath1690 .",
    "every such @xmath1691 lifts to a representation @xmath1692 .",
    "in fact , one may choose @xmath1691 to have image in @xmath1693 ; this follows from teichmller theory ( * ? ? ? * theorem  1 ) ( see also ( * ? ? ?",
    "* section  4.9 ) ) .",
    "one may therefore also try to apply theorem  [ thm : virt res p for graphs of linear groups , 2 ] to prove the proposition above ( even if @xmath1694 ) . however , this only yields the existence of a boundary compatible @xmath0-filtration of level  @xmath163 for @xmath1665 for cofinitely many @xmath0 .",
    "let @xmath25 be a @xmath1-manifold .",
    "we have to show that for all but finitely many @xmath0 the group @xmath27 is virtually residually @xmath0 .    [",
    "[ reduction - to - the - case - of - orientable - and - closed - prime - manifolds ] ] reduction to the case of orientable and closed prime manifolds + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    by gluing in @xmath1-balls if necessary we can always assume , without changing @xmath3 , that @xmath1638 has no spherical components .",
    "in this situation we have :    [ lem : incomp ] suppose @xmath25 has no spherical boundary components",
    ". then there exist @xmath1-manifolds @xmath1695 whose boundaries are incompressible and without spherical components , and a free group @xmath57 such that @xmath1696 .",
    "let @xmath1697 be a compressible component .",
    "by dehn s lemma there exists a properly embedded disk @xmath1698 such that @xmath1699 is homologically essential .",
    "let @xmath1700 be the result of capping off the spherical boundary components of @xmath1701 by @xmath1-balls . if @xmath1700 is connected , then @xmath1702 , otherwise @xmath1703 where @xmath1704 , @xmath1705 are the two components of @xmath1700 .",
    "the lemma now follows by induction on the lexicographically ordered pair @xmath1706 since we have either @xmath1707 ( in the case that @xmath88 is not a torus ) , or @xmath1708 and @xmath1709 ( in the case that @xmath88 is a torus ) .",
    "combining lemma  [ lem : incomp ] with the remark following corollary  [ cor : trivial edge groups ] we see that it suffices to consider @xmath1-manifolds with incompressible boundary .",
    "suppose @xmath25 has non - empty incompressible boundary .",
    "then we consider the double @xmath1710 , which is a closed @xmath1-manifold .",
    "then the natural morphism @xmath1711 is injective , and since the property of being virtually residually @xmath0 restricts to subgroups we can from now on assume that @xmath25 is in fact closed . by going to a double cover , if necessary , we can and will also assume that @xmath25 is orientable",
    ". finally , by the remarks after corollary  [ cor : trivial edge groups ] again it suffices to show that prime @xmath1-manifold groups are virtually residually @xmath0 for all but finitely many @xmath0 .",
    "[ [ sec : jsj ] ] the setup for the case of a closed orientable prime @xmath1-manifold + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    now suppose @xmath25 is a closed orientable prime @xmath1-manifold .",
    "if @xmath25 is hyperbolic or seifert fibered , it follows immediately from propositions  [ prop : virtphyp ] respectively [ prop : seifert res p ] that @xmath3 is virtually residually @xmath0 for all but finitely many @xmath0 .",
    "assume that @xmath25 has a non - trivial jsj decomposition ; that is , there are pairwise distinct , incompressible embedded tori @xmath1712 ( @xmath1713 ) such that the components @xmath1714 of @xmath25 cut along @xmath1715 are either seifert fibered or algebraically atoroidal ( and thus , by geometrization , hyperbolic ) .",
    "we associate a graph  @xmath362 to this decomposition of @xmath25 as follows : take a set @xmath1716 of @xmath1717 distinct vertices and an orientation @xmath1718 of its edge set ( with @xmath1719 ) , and for every  @xmath258 choose distinct vertices @xmath1720 and @xmath1721 such that @xmath1722 and @xmath1723 and set @xmath1724 , @xmath1725",
    ". we may describe @xmath25 as the topological realization of a graph @xmath1726 of based cw - complexes with underlying graph @xmath362 , whose vertex spaces are the @xmath1727 and whose edge spaces are the tori @xmath1572 .",
    "we let @xmath31 be the associated graph of groups with underlying graph @xmath362 ( cf .",
    "section  [ sec : graphs of cw - complexes ] ) ; so @xmath1728 .",
    "[ [ sec : reduction to seifert simple ] ] reduction to seifert simple manifolds + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the following we say that a closed orientable prime @xmath1-manifold is _ seifert simple _ if any seifert fibered component in its jsj decomposition is of the form @xmath56 for some orientable surface @xmath57 , where  @xmath57 is either closed or has at least two boundary components .",
    "we now show that there exists a finite cover @xmath1642 such that @xmath103 is seifert simple .",
    "we first prove the following lemma which is a slight variation on well - known lemmas ( cf .",
    ", e.g. , @xcite , ( * ? ? ?",
    "* lemma  6 ) , or ( * ? ? ? * proposition  2.5 ) ) .",
    "[ lem : sfsq ] let @xmath722 be a seifert fibered manifold with non - empty incompressible boundary .",
    "let @xmath1729 be a prime with @xmath1730 .",
    "then there exists a finite index subgroup  @xmath1731 of @xmath1732 with the following properties :    for any torus @xmath1733 the group @xmath1734 is the unique characteristic subgroup of @xmath1637 of index @xmath1735 ; and    the cover @xmath1736 corresponding to @xmath1731 is of the form @xmath56 for some orientable surface @xmath57 with @xmath1737 .",
    "let @xmath1729 be a prime with @xmath1730 .",
    "denote by @xmath1738 the base orbifold of @xmath722 and denote the boundary curves by @xmath1739 ( @xmath1591 ) .",
    "we denote by @xmath1740 the @xmath34-orbifold with underlying space @xmath1741 and cone angle @xmath1742 and finally we denote by @xmath1743 copies of @xmath1740 .",
    "we let @xmath1744 be the closed orbifold given by gluing to each boundary component @xmath1745 of @xmath1738 the @xmath34-orbifold @xmath1746 .",
    "note that @xmath1747 in particular the images of @xmath1739 are now elements of order @xmath1729 in the orbifold fundamental group @xmath1748 .",
    "since @xmath1749 we see that @xmath1744 is a good orbifold ( see ( * ? ? ?",
    "* theorem  13.3.6 ) ) , i.e. , there exists an epimorphism @xmath1750 to a finite group @xmath3 such that the corresponding finite cover @xmath1751 has the property that @xmath1752 is a surface .",
    "note that we can and will assume that @xmath1753 .",
    "the preimages of @xmath1746 are disks , and this implies that the image of @xmath1754 has order @xmath1729 . since @xmath1755 it follows that @xmath1756 has order @xmath1729 .    also note that the preimage of @xmath1757 under @xmath453 is a surface @xmath57 . since @xmath1758 is surjective",
    "we see that @xmath1759 is connected .",
    "note that @xmath1760 we now return to the study of @xmath722 .",
    "first note that since @xmath722 has non - empty incompressible boundary we know that @xmath1761 is infinite and hence the subgroup @xmath1762 generated by a regular fiber is normal and infinite cyclic ( cf .",
    "note that there exists a canonical isomorphism @xmath1763 .",
    "we denote by  @xmath1764 the map @xmath1765 defined as the composition @xmath1766 now let @xmath1767 be the cover corresponding to @xmath1764 . then @xmath1768 is a seifert fibered space with base orbifold the surface @xmath57 , i.e. , @xmath1768 is a @xmath1662-bundle over the surface @xmath57 ( see also ( * ? ? ?",
    "* theorem  11.10 ) ) . as in the proof of lemma [ lem :",
    "s1-bundles res p ] we conclude that @xmath1768 is in fact a product @xmath1769 .",
    "the boundary components of @xmath722 are given by @xmath1770 ( @xmath1771 ) , in particular @xmath1772 is the free abelian group generated by @xmath384 and @xmath1745 .",
    "also note that @xmath1773 is generated by @xmath384 and @xmath1774 .",
    "finally note that @xmath1775 .",
    "it is easy to see that the cover of @xmath1768 given by @xmath1776 gives rise to a cover of @xmath722 with the desired properties .",
    "we now let @xmath1730 be a prime such that all hyperbolic manifolds @xmath1727 admit a subgroup @xmath1777 such that for any boundary component  @xmath1778 of  @xmath1727 , @xmath1779 is the unique characteristic subgroup of @xmath1780 of index @xmath1735",
    ". we can find such @xmath1729 and such subgroups by proposition [ prop : virtphyp ] .",
    "furthermore , given any @xmath1781 such that @xmath1727 is seifert fibered we now pick a subgroup @xmath1777 as in the above lemma .",
    "the collection of subgroups @xmath1782 is clearly a compatible collection of finite index subgroups of the graph of groups @xmath31 .",
    "we now let @xmath1783 be the finite cover arising from ( the proof of ) proposition  [ prop : commoncover ] .",
    "recall that the manifold @xmath103 is in a canonical way the topological realization of a graph @xmath1784 of based cw - complexes where the vertex spaces are the components of @xmath1785 , @xmath1786 and the edge spaces are the components of @xmath1787 , @xmath1030 .",
    "it now follows that @xmath103 is seifert simple .",
    "hence , after replacing @xmath25 by @xmath103 if necessary , we may assume that @xmath25 is seifert simple .",
    "[ [ sec : conclusion ] ] conclusion of the proof + + + + + + + + + + + + + + + + + + + + + + +    by the discussion above it remains to prove the main theorem in the case where @xmath25 is a closed orientable prime @xmath1-manifold which has a non - trivial jsj decomposition and is seifert simple .",
    "in this situation , by propositions  [ prop : virtphyp ] and [ prop : seifert simple lower p - central ] , for all but finitely many @xmath0 , each jsj component of  @xmath25 admits a boundary compatible @xmath0-filtration of level @xmath163 , and so by theorem  [ thm : virt res p for graphs of linear groups , 1 ] , the group @xmath54 is virtually residually @xmath0 .      in this section",
    "we finally give the proof of theorem  [ thm : proprmi ] .",
    "for the reader s convenience we repeat the statement . in the following ,",
    "`` ring '' will mean `` commutative noetherian ring with unit @xmath163 , '' and @xmath51 will always denote a ring with @xmath1788 .",
    "[ main - theorem ] [ mt ] suppose @xmath51 is a finitely generated integral domain of characteristic zero . then for all but finitely many @xmath0 there",
    "exists a maximal ideal @xmath1494 of @xmath51 such that @xmath1588 is regular unramified of residue characteristic @xmath0 .",
    "we first recall the concepts mentioned in the conclusion of the theorem . a sequence @xmath1789 ( where @xmath426 ) of elements of @xmath51 is said to be _ regular _ if @xmath1790 and for @xmath1791 , the canonical image of @xmath1792 is not a zero divisor of the ring @xmath1793 .",
    "for example , the sequence @xmath1794 of indeterminates in a polynomial ring @xmath1795 $ ] over a ring @xmath837 is a regular sequence . in general ,",
    "regular sequences in @xmath51 do behave very much like indeterminates in a polynomial ring : if @xmath1789 is a regular sequence in @xmath51 , then the associated graded ring of the ideal @xmath1796 , @xmath1797 is a polynomial ring over @xmath1798 ; more precisely , the morphism of graded @xmath1798-algebras @xmath1799 \\to \\operatorname{gr}_i(r)\\qquad\\text{with $ x_i\\mapsto x_i+i^2 $ for every $ i$}\\ ] ] is an isomorphism ; in particular , @xmath1800 for every @xmath258 and @xmath343 ( * ? ? ? * theorem  16.2 ) .",
    "if @xmath1801 is a local ring , then @xmath51 is called regular if its maximal ideal @xmath1494 can be generated by a regular sequence ; in general , the ring @xmath51 is called regular if each localization @xmath1802 of @xmath51 at one of its prime ideals @xmath1803 is a regular local ring .    if @xmath1801 is local of residue characteristic @xmath0 _ unramified _ if @xmath1804 . in general , we need a criterion to determine whether the localization @xmath1513 of @xmath51 at one of its maximal ideals @xmath1494 is regular unramified .",
    "this is provided by the following lemma ( a special case of theorem  14.2 in @xcite ) :    [ criterion ] let @xmath1801 be a regular local ring , and let @xmath1805 , @xmath1806",
    ". then the following are equivalent :    1 .",
    "@xmath1494 is generated by a regular sequence containing @xmath1807 ; 2 .",
    "@xmath1808 ; 3 .",
    "the local ring @xmath1809 is also regular .",
    "we equip , as usual , the set @xmath1810 of prime ideals of the ring @xmath51 with its zariski topology , with sub - basis given by the open sets of the form @xmath1811 recall that @xmath1812 for all @xmath1813 ; in particular any open subset of  @xmath1810 contains an open set of the form @xmath1814 , @xmath1815 . also , @xmath1816 if and only if @xmath824 is nilpotent .",
    "we denote by @xmath1817 the regular locus of @xmath51 , that is , the set of all @xmath1818 such that the localization @xmath1802 is regular .",
    "it is well - known that @xmath1817 is open if @xmath51 is a finitely generated algebra over a field ( zariski ) or over a dedekind domain ( e.g. ,  @xmath18 ) of characteristic zero ( nagata ) ; see ( 6.12.5 ) respectively ( 6.12.6 ) of @xcite .",
    "recall that @xmath51 is said to be _ reduced _ if @xmath51 contains no non - zero nilpotent elements ; equivalently , if the intersection of all prime ideals of @xmath51 is trivial .",
    "clearly a domain is in particular reduced .",
    "we also need the notion of a _ jacobson ring _",
    "( also sometimes called a _ hilbert ring _ ) .",
    "this is a ring each of whose prime ideals is the intersection of maximal ideals .",
    "examples include all fields as well as every principal ideal domain with infinitely many pairwise non - associated primes ( like the ring of integers ) .",
    "if @xmath51 is a jacobson ring , then so is every finitely generated @xmath51-algebra @xmath837 , and the pullback of each maximal ideal of @xmath837 is a maximal ideal of @xmath51 .",
    "( see ( * ? ? ?",
    "* iv.3.4 ) . )",
    "[ regular maximal ideal ] suppose @xmath51 is a reduced ring whose regular locus is open",
    ". then @xmath1817 is non - empty , and if @xmath51 is jacobson , then @xmath1817 contains a maximal ideal .",
    "since @xmath51 is reduced , for every minimal prime ideal @xmath1803 of @xmath51 , the localization @xmath1802 is a field ( isomorphic to the fraction field of @xmath1819 ) , hence @xmath1820 . in particular , @xmath1817 is a non - empty open subset of @xmath1821 , and therefore contains an open subset @xmath1814 , for some non - zero @xmath1815 .",
    "if @xmath51 is jacobson , then the intersection of all maximal ideals of @xmath51 is zero ; hence there exists a maximal ideal @xmath1494 of  @xmath51 not containing @xmath824 , and thus @xmath1822 .",
    "our final ingredient is the following fact , whose proof we postpone :    [ non - trivial and reduced ] suppose @xmath51 is finitely generated .",
    "then @xmath51 has characteristic zero if and only if for all but finitely many primes @xmath0 , we have @xmath1823 .",
    "moreover , if @xmath51 is reduced then for all but finitely many primes @xmath0 the ring @xmath1824 is reduced .    1 .",
    "the converse of the second statement in the proposition is false : if @xmath1825/(4x)$ ] , then @xmath51 is not reduced , yet @xmath1824 is reduced for every prime @xmath1534 . note also that the analogous statement for the property of being an integral domain is also false , since there are polynomials in @xmath1826 $ ] ( e.g. , @xmath1827 ) which are irreducible over @xmath1828 but reducible modulo every prime .",
    "( in fact , for each composite natural number @xmath20 there is a monic polynomial in @xmath1826 $ ] of degree @xmath20 with this property , cf .",
    "@xcite . ) 2 .",
    "after a first version of this manuscript had been completed , pascal adjamagbo informed us that in the course of investigations around the dixmier conjecture on weyl algebras , he also established a version of proposition  [ non - trivial and reduced ] .    assuming this proposition ,",
    "let us outline how theorem  [ main - theorem ] follows : suppose  @xmath51 is a finitely generated integral domain of characteristic zero .",
    "by lemma  [ regular maximal ideal ] and the remark preceding it we know that @xmath1817 is open and non - empty .",
    "in particular there exists a non - zero @xmath1815 such that @xmath1829 .",
    "the prime ideals in @xmath1814 are in one - to - one correspondence with the prime ideals of @xmath1830 $ ] , and the corresponding localizations of @xmath51 and @xmath837 are isomorphic .",
    "hence @xmath837 is regular .",
    "thus , replacing @xmath51 by @xmath837 , we may assume from the outset that @xmath51 is regular .",
    "let now @xmath0 be such that the ring @xmath1831 is non - trivial and reduced , as in the proposition above .",
    "let @xmath1494 be a maximal ideal of @xmath51 containing @xmath0 whose image @xmath1832 under the natural morphism @xmath1833 is in @xmath1834 .",
    "( such @xmath1494 exists by lemma  [ regular maximal ideal ] applied to the finitely generated @xmath1835-algebra @xmath1836 . ) note that @xmath1837 .",
    "therefore @xmath1588 is unramified regular of residue characteristic @xmath0 , by lemma  [ criterion ] .      in the proof of proposition  [ non - trivial and reduced ] , we use results about dependence on parameters for certain properties of ideals in polynomial rings , formulated in lemmas  [ member ] and [ radical ] below",
    ". the elements of the boolean algebra of subsets of @xmath1810 generated by the sets @xmath1814 with @xmath1815 , i.e. , the smallest collection of subsets of @xmath1810 which contains the sub - basis of @xmath1810 and which is stable under finite union and complementation ( and hence , also under finite intersection ) are called _ constructible . _",
    "it is easy to see that each constructible subset of @xmath1810 is a finite union of sets of the form @xmath1838 where @xmath1839 .",
    "see ( * ? ? ?",
    "* chapter  2 ) for more on constructible sets , and ( * ? ? ?",
    "* section  12.2 ) on the connection with `` constructible properties '' exploited below .",
    "fix a tuple @xmath1840 of pairwise distinct indeterminates , and let @xmath1841 be another pairwise distinct tuple of indeterminates ( thought of as placeholders for parameters ) distinct from @xmath1842 . given a field @xmath14 and @xmath1843",
    "we let @xmath1844 denote the kernel of the ring morphism @xmath1845\\to k$ ] with @xmath1846 for every @xmath258 .",
    "note that for @xmath1847 $ ] we have @xmath1848 if and only if @xmath1849 in @xmath14 .",
    "more generally , a constructible subset @xmath88 of @xmath1850)$ ] expressed in the form contains @xmath1844 if and only if @xmath1687 satisfies the corresponding system of inequalities and equalities @xmath1851 for @xmath1852 and a prime number @xmath0 we set @xmath1853 , and we extend this notation to @xmath722-tuples @xmath1854 in the natural way : @xmath1855 then @xmath1848 if and only if @xmath1856 for all but finitely many prime numbers @xmath0 , and @xmath1857 if and only if @xmath1858 for all ( equivalently , all but finitely many ) primes @xmath0",
    ". thus , we obtain the following principle for the reduction of constructible properties from characteristic zero to finite characteristic :    [ reduction mod p ] let @xmath88 be a constructible subset of @xmath1850)$ ] , and let @xmath1859 . then @xmath1860 if and only if for all but finitely many prime numbers @xmath0 we have @xmath1861 .",
    "the following is a theorem by chevalley , also discovered by tarski ( and known among logicians as `` quantifier elimination for algebraically closed fields '' @xcite ) .",
    "[ chevalley ] let @xmath88 be a constructible subset of @xmath1862)$ ] , where @xmath210 is a new indeterminate .",
    "then there exists a constructible subset @xmath1863 of @xmath1864)$ ] such that for every field @xmath14 with algebraic closure @xmath1865 and every @xmath1866 , @xmath1867    see ( * ? ? ?",
    "* theorem  12.2.10 ) for a proof .",
    "( the proof given there in fact shows how to construct , in an effective way , a description of the constructible set @xmath1863 from a description of @xmath88 . )",
    "let @xmath1868 $ ] .",
    "for a tuple @xmath1869 we denote by @xmath1870 the ideal of @xmath1871 $ ] generated by the polynomials @xmath1872 .",
    "the next lemma ( applied with @xmath1873 ) says in particular that the property of @xmath1870 being a proper ideal is a constructible property of the parameters @xmath1687 :    [ member ] there is a constructible subset @xmath88 of @xmath1850)$ ] such that for every field @xmath14 and @xmath1866 , we have @xmath1874    for the following lemma recall that a field @xmath14 with @xmath1875 is called _ perfect _ if @xmath1876 .",
    "note that @xmath76 is perfect .",
    "a field of characteristic zero is always referred to as perfect .",
    "we now have the following lemma .    [ radical ]",
    "there is a constructible subset @xmath1877 of @xmath1850)$ ] such that for every perfect field @xmath14 and @xmath1866 , @xmath1878    let us first see how proposition  [ non - trivial and reduced ] follows from the previous lemmas .",
    "suppose  @xmath51 is finitely generated .",
    "we may assume @xmath1825/i$ ] for an ideal @xmath1879 of @xmath1826=\\z[x_1,\\dots , x_n]$ ] , for some @xmath25 .",
    "let @xmath1859 be the tuple of coefficients of the polynomials @xmath1880 ( in some order ) ; so we may write @xmath1881 where @xmath1882 $ ] ( with each non - zero coefficient of @xmath1883 equal to @xmath163 )",
    ". now @xmath51 has characteristic zero if and only if @xmath1884 , if and only if @xmath1885=i(c , x)$ ] .",
    "moreover , @xmath51 is reduced if and only if @xmath778 is radical ; we have @xmath1886 = \\sqrt{i\\q[x]}$ ] , hence if @xmath778 is radical then so is @xmath1887 $ ] .",
    "similarly , for a prime @xmath0 , we have @xmath1823 if and only if the ideal @xmath1888 of @xmath1889 $ ] is proper , and @xmath1824 is reduced if and only if @xmath1888 is radical .",
    "proposition  [ non - trivial and reduced ] is now a consequence of lemma  [ reduction mod p ] applied to the constructible sets @xmath88 and @xmath1877 associated to the polynomials @xmath1890 and @xmath1891 in lemmas  [ member ] and [ radical ] , respectively .",
    "the first part of proposition  [ non - trivial and reduced ] ( which is related to grothendieck s ` generic freeness lemma ' ( * ? ? ?",
    "* theorem  24.1 ) ) may also be proved in different ways .",
    "for example , by the noether normalization lemma , there exists a non - zero integer @xmath1512 and an injective morphism @xmath1892[x ] \\to r[\\frac{1}{\\delta}]$ ] , for some tuple @xmath1840 of indeterminates , such that @xmath1893 $ ] is a finite module over the image @xmath837 of @xmath154 .",
    "suppose @xmath0 does not divide @xmath1512 .",
    "then the natural morphism @xmath1894 induces an isomorphism @xmath1895 .",
    "moreover , @xmath0 generates a prime ideal of @xmath837 ; let @xmath1803 be a prime ideal of @xmath1896 with @xmath1897",
    ". then the natural inclusion @xmath1898 yields an inclusion @xmath1889\\cong s / ps \\to r'/\\pp$ ] ; in particular , @xmath1899 and thus @xmath1900 .",
    "another ( algorithmic ) proof of this part of proposition  [ non - trivial and reduced ] , employing grbner basis theory , can be deduced from @xcite .",
    "it is also an immediate consequence of the non - trivial fact that the unit group of a finitely generated integral domain is finitely generated @xcite .",
    "we now turn to the proof of lemmas  [ member ] and [ radical ] .",
    "these can probably be deduced from the results in of @xcite ; however , we prefer to follow a slightly less sophisticated approach , based on :    [ vddries - schmidt ] there exists an integer @xmath1014 depending on the @xmath1883 with the following property : for every field @xmath14 and @xmath1866 , we have @xmath1901 if and only if there are @xmath1902 $ ] of degree at most @xmath1014 with @xmath1903 moreover , there exists an integer @xmath1904 such that for every field @xmath14 and @xmath1866 , if the implication @xmath1905 holds for all @xmath1906 $ ] of degree at most @xmath1904 , then the ideal @xmath1870 is radical .    for a simple model - theoretic proof of this fact see @xcite .",
    "it is known , essentially since hermann s work @xcite ( see also @xcite ) , that @xmath1907 suffices , where @xmath343 is the maximal degree of @xmath1908 in @xmath538 ; in the important case @xmath1873 , by @xcite we may take @xmath1909 where @xmath1910 for @xmath1911 and @xmath1912 for @xmath1913 . analyzing one of the common algorithms to construct the radical of an ideal in a polynomial ring ( see , e.g. , @xcite ) also would allow one , in principle , to explicitly compute an integer @xmath1904 ( depending on @xmath25 and @xmath343 ) with the required property .    by theorem  [ vddries - schmidt ] , @xmath1901 if and only if a certain ( very large ) system of linear equations over @xmath14 , obtained ( uniformly in  @xmath14 and @xmath1687 ) from the equation by comparing the coefficients corresponding to equal monomials in @xmath538 on both sides , has a solution in @xmath14 ( namely , the coefficient tuple of the polynomials @xmath1914 of degree at most @xmath1014 ) .",
    "that is , there exists a @xmath1915-matrix @xmath1916 with entries in @xmath1845 $ ] and a column vector @xmath1917^k$ ] ( for some  @xmath1067 ,  @xmath1918 ) such that for every field @xmath14 and @xmath1866 , the ideal @xmath1870 contains @xmath1919 if and only if the system @xmath1920 of linear equations has a solution in @xmath14 , that is , if and only if @xmath1921 the rank of a matrix over a field is the least @xmath1922 such that all of its @xmath1923-minors vanish .",
    "it is now routine to construct a finite family @xmath1924 of systems as in such that for given @xmath14 and @xmath1687 , the equality holds if and only if @xmath1687 satisfies one of the @xmath1925 .",
    "using the `` rabinovich trick , '' lemma  [ member ] yields :    [ member - cor ] there is a constructible subset @xmath1926 of @xmath1850)$ ] such that for every field @xmath14 and @xmath1866 , we have @xmath1927    let @xmath362 be an indeterminate distinct from @xmath1842 .",
    "then for every  @xmath14 and @xmath1687 we have @xmath1928 if and only if the ideal @xmath1929 of @xmath1930 $ ] contains the constant polynomial @xmath163 .",
    "we now turn to :    given a field extension @xmath1931 of a perfect field @xmath14 , an ideal @xmath1932 of @xmath1933 $ ] is radical if and only if @xmath1934 $ ] is radical ( * ? ? ?",
    "* chapitre  v ,  15 ,",
    "proposition  5 ) .",
    "hence it is enough to show the existence of a constructible subset @xmath1877 of @xmath1864)$ ] satisfying for every @xmath722-tuple @xmath1687 of elements of an _ algebraically closed _",
    "field @xmath14 .",
    "let @xmath1935 $ ] be a polynomial of degree at most @xmath1904 with indeterminate coefficients ( where @xmath210 is a tuple of new indeterminates ) .",
    "using lemma  [ member ] and corollary  [ member - cor ] , let @xmath1936 , @xmath1937 be constructible subsets of @xmath1862)$ ] such that for every field @xmath14 and tuples @xmath1687 , @xmath343 of elements of @xmath14 of the appropriate lengths , @xmath1938 and @xmath1939 consider the constructible subset @xmath1940)\\setminus\\sigma_1\\big ) \\cup \\sigma_2\\ ] ] of @xmath1862)$ ] : by theorem  [ vddries - schmidt ] , the ideal @xmath1870 is radical if and only if for every tuple @xmath343 of elements of @xmath14 we have @xmath1941 .",
    "one now obtains @xmath1877 from @xmath88 by applying theorem  [ chevalley ] .",
    "we show proposition  1 in a more general form :    [ prop : fibered ] let @xmath31 be a graph of finitely generated virtually residually  @xmath0 groups such that for each edge @xmath372 of its underlying graph , the morphism @xmath489 is bijective .",
    "then the group @xmath30 is virtually residually @xmath0 .",
    "the _ mapping torus _ of a group endomorphism @xmath1942 is the group @xmath1943 more generally , given group endomorphisms @xmath1944 , the mapping torus of @xmath1945 is the group @xmath1946 here and below , @xmath1947 denotes the free group on @xmath338 generators .",
    "the proposition above immediately yields :    [ cor : fibered ] the mapping torus of finitely many automorphisms of a finitely generated virtually residually @xmath0 group is virtually residually @xmath0 .",
    "this corollary readily implies proposition  1 : suppose @xmath25 is a fibered @xmath1-manifold , so @xmath1948 where @xmath1949 is the fundamental group of a surface @xmath57 .",
    "thus  @xmath57 is either the free group @xmath1947 on @xmath338 generators ( for some @xmath338 ) or a surface group ( that is , the fundamental group of a closed surface ) .",
    "free groups are residually @xmath0 for all  @xmath0 , and orientable surface groups are residually free @xcite and hence residually  @xmath0 for all  @xmath0 .",
    "every non - orientable surface group of genus @xmath453 contains a characteristic subgroup of index @xmath34 which is isomorphic to the orientable surface group of genus  @xmath1950 . in any case , the group @xmath3 is virtually residually @xmath0 , for every @xmath0 , and hence so is @xmath26 by corollary  [ cor : fibered ] .    corollary  [ cor : fibered ] can be seen as a more general and precise version of the result @xcite that the mapping torus of an automorphism of a free group of finite rank is residually finite .",
    "( in fact , the mapping torus of an _ endo_morphism of a linear group is always residually finite , as shown by borisov and sapir @xcite ; they also showed that the mapping torus of an endomorphism of a finite - rank free group is virtually residually @xmath0 for all but finitely many @xmath0 @xcite . )",
    "as remarked in  @xcite , the linearity of the braid group @xmath1951 @xcite implies that the mapping torus of an automorphism of @xmath1952 is a linear group ; in fact , the holomorph of @xmath1952 is linear @xcite .",
    "it is unknown whether a mapping torus of an automorphism of @xmath1947 is always linear for @xmath1953 , cf .",
    "* problem  5 ) .    for the proof of proposition  [ prop : fibered ]",
    "we first note that it suffices to treat the special case of mapping tori : given a graph of groups @xmath31 such that for each edge @xmath372 of the underlying graph @xmath362 of @xmath31 , the morphism @xmath489 is bijective , for every maximal subtree  @xmath79 of @xmath362 and every @xmath439 we have @xmath1954 and thus @xmath1955 , where @xmath1956 .",
    "so suppose now that @xmath1957 is the mapping torus of the automorphisms @xmath1945 of the finitely generated group @xmath3 .",
    "every finite index subgroup of the finitely generated group @xmath3 contains a finite index subgroup of @xmath3 which is fully characteristic ( even verbal ) in @xmath3 .",
    "thus , if @xmath3 is virtually residually @xmath0 , then @xmath3 contains a finite index residually @xmath0 subgroup which is fully characteristic . using proposition  [ prop : commoncover ]",
    "we thus reduce to proving that `` @xmath3 residually @xmath0 '' implies `` @xmath357 virtually residually @xmath0 . ''",
    "the next lemma shows that our best chance for showing that @xmath357 is residually @xmath0 is by showing that the @xmath1031 act unipotently on @xmath1958 :    [ lem : unipotent on homology ] let @xmath1959 be the mapping torus of the automorphisms @xmath1960 of @xmath1961 induced by @xmath1945 .",
    "then @xmath1076 is residually @xmath0 if and only if the automorphisms @xmath1960 generate a @xmath0-subgroup of @xmath1962 .",
    "if @xmath3 and @xmath1076 are residually @xmath0 , then so is @xmath357 .",
    "the first statement follows from the equivalence of ( 1 ) and ( 2 ) in corollary  [ cor : chatzidakis ] .",
    "suppose @xmath3 and @xmath1076 are residually @xmath0 . to show that @xmath357 is residually  @xmath0",
    ", it is enough to show , by proposition  [ hempel criterion residually p ] and lemma  [ lem : hnn ] , that for each @xmath65 , the mapping torus of the automorphisms of @xmath242 induced by the @xmath1031 is residually @xmath0 .",
    "this follows from the first statement and lemma  [ lem : induced automorphisms ] below .    for every @xmath65 , by restriction",
    "we obtain a natural group morphism @xmath1963 .",
    "if @xmath1964 induces the identity on @xmath1965 , then @xmath1680 induces the identity on @xmath242 for each @xmath65 ( * ? ? ?",
    "* chapter  viii , theorem  1.7 ) .",
    "therefore :    [ lem : induced automorphisms ] if the image of a subgroup @xmath214 of @xmath39 in @xmath1966 is a @xmath0-group , then the image of @xmath214 in @xmath1967 is a @xmath0-group for every @xmath65 .",
    "suppose now that @xmath3 is residually @xmath0 .",
    "then by corollary  [ cor : unfolded , 1 ] we see that the mapping torus @xmath357 has a finite index normal subgroup which is itself ( isomorphic to ) the mapping torus of finitely many automorphisms of @xmath3 , and such that the mapping torus of the corresponding induced automorphisms of @xmath1968 is residually  @xmath0 .",
    "hence by lemma  [ lem : unipotent on homology ] , @xmath357 is virtually residually @xmath0 .",
    "this finishes the proof of proposition  [ prop : fibered ]",
    ".    it may be instructive to contrast corollary  [ cor : fibered ] with the following proposition , which shows that fundamental groups of fibered @xmath1-manifolds always satisfy , without passing to a finite index subgroup , a very weak variant of being residually @xmath0 .",
    "( this proposition also fills in the details for a claim made in the introduction . )",
    "[ prop : fibered implies weakly residually p ] let @xmath98 be the fundamental group of a fibered @xmath1-manifold .",
    "then for every @xmath1969 with @xmath1970 there is a subgroup @xmath1731 of @xmath98 of @xmath0-power index such that @xmath1971 .    as above",
    "we write @xmath1972 where @xmath3 is a free group of finite rank or a surface group .",
    "then @xmath3 is residually @xmath0 .",
    "now , for any non - zero integer @xmath1067 we can consider the subgroup of @xmath1973 generated by @xmath1974 and @xmath3 , which we denote by @xmath1975 ; this subgroup is normal in @xmath98 of index @xmath1976 .",
    "for any @xmath65 we may also consider the subgroup of @xmath41 generated by @xmath384 and @xmath187 , denoted by @xmath1977 ; note that @xmath1977 is of @xmath0-power index in @xmath41 , and this subgroup is not normal in general .",
    "now suppose @xmath1978 where @xmath1979 , @xmath4 .",
    "if @xmath1980 , then there exists an  @xmath20 such that @xmath1981 .",
    "if @xmath1982 and @xmath5 , then there exists an @xmath65 such that  @xmath1983 .",
    "it is not surprising that in the special case of graph manifolds , our methods yield more refined results .",
    "we first restate and prove proposition  2 from the introduction :      if @xmath25 is seifert fibered , then @xmath26 has a finite index subgroup which is residually @xmath0 for every @xmath0 , by proposition  [ prop : seifert res p ] .",
    "so we may assume from now on that  @xmath25 is not seifert fibered .",
    "the rest of the argument is as in sections  [ sec : reduction to seifert simple][sec : conclusion ] in the proof of the main theorem : after passing to a finite cover of @xmath25 if necessary , we may assume that @xmath25 is seifert simple",
    ". then , by proposition  [ prop : seifert simple lower p - central ] , for all @xmath0 , each jsj component of @xmath25 admits a boundary compatible @xmath0-filtration of level  @xmath163 , and so @xmath3 is virtually residually @xmath0 by theorem  [ thm : virt res p for graphs of linear groups , 1 ] .    in the rest of this chapter",
    "we prove proposition  3 from the introduction .",
    "we also discuss @xmath0-cohomological completeness and obstacles towards a proof of virtual @xmath0-efficiency for arbitrary @xmath1-manifolds , and establish proposition  4 .                1 .",
    "@xmath54 is residually @xmath0 ; 2 .   for all vertices @xmath74 and edges @xmath372 , the subgroups @xmath35 and @xmath55 of @xmath3 are closed in the pro-@xmath0 topology on @xmath3 ; 3 .   for all vertices @xmath74 and edges @xmath372 , the pro-@xmath0 topology on @xmath3 induces the pro-@xmath0 topology on @xmath35 and on @xmath55 .",
    "so a closed orientable prime @xmath1-manifold @xmath25 is @xmath0-efficient precisely if its associated graph of groups is . for the proof of proposition  [ prop : prop 2 restated ] , we first need to establish a criterion for @xmath0-efficiency of a graph of groups , which is corollary  [ cor : p - efficiency criterion ] of the following sequence of lemmas .    given a filtration @xmath111 of a group @xmath3 by @xmath0-power index normal subgroups , we say that @xmath111 induces the pro-@xmath0 topology on @xmath3 if the group topology on @xmath3 with fundamental system of neighborhoods of the identity given by @xmath111 agrees with the pro-@xmath0 topology on @xmath3 ; equivalently , for every @xmath0-power index normal subgroup @xmath7 of  @xmath3 there is some @xmath260 with @xmath1984 .",
    "( if @xmath177 is finitely generated , it suffices to require this for @xmath7 of the form @xmath1985 , @xmath65 . )        1 .   for each vertex @xmath74",
    ", the filtration @xmath63 induces the pro-@xmath0 topology on @xmath35 ; 2 .   for each edge",
    "@xmath372 , the filtration @xmath668 induces the pro-@xmath0 topology on @xmath55 ; and 3 .   for every @xmath65 ,",
    "the group @xmath1190 is residually @xmath0 .",
    "then the pro-@xmath0 topology on @xmath54 induces the pro-@xmath0 topology on each vertex and edge group of @xmath31 . if in addition @xmath111 is separating and separates the edge groups of @xmath31 , then @xmath31 is @xmath0-efficient .    by condition",
    "( 2 ) , the vertex groups induce the pro-@xmath0 topology on the edge groups , so it is enough to show that @xmath3 induces the pro-@xmath0 topology on each vertex group .",
    "fix a vertex @xmath386 and a normal subgroup @xmath1986 of @xmath1178 of @xmath0-power index ; we need to find a normal subgroup @xmath7 of @xmath3 of @xmath0-power index with @xmath1987 . by hypothesis",
    "( 1 ) there is some @xmath65 such that @xmath1988 .",
    "denote the natural morphism @xmath1989 by @xmath247 . by ( 3 ) and since @xmath1990 is finite , there exists a normal subgroup @xmath14 of @xmath1190 of @xmath0-power index with @xmath1991 .",
    "then @xmath1992 is a @xmath0-power index normal subgroup of @xmath3 with @xmath1993 as desired .",
    "the last statement now follows from the first in combination with corollaries  [ cor : hempel , cor ] and [ cor : vertex and edge groups closed ] .        1 .   for each vertex @xmath74 ,",
    "the filtration @xmath63 induces the pro-@xmath0 topology on @xmath1994 ; 2 .   for each edge",
    "@xmath372 , the filtration @xmath668 induces the pro-@xmath0 topology on @xmath1995 .",
    "we argue as in the proof of theorem  [ thm : reduction theorem , 3 ] .",
    "first we apply proposition  [ prop : commoncover ] to @xmath1448 in order to reduce to the case that @xmath111 is complete . from now on we assume this to be the case .",
    "next , we apply corollary  [ cor : unfolded , 1 ] with @xmath1996 and let @xmath91 have properties ( 1)(4 ) in that corollary .",
    "let @xmath1997 .",
    "then by theorem  [ thm : reduction theorem ] , the group  @xmath37 is residually @xmath0 , the vertex and edge groups of @xmath38 are closed in the pro-@xmath0 topology on @xmath1998 , and for every @xmath65 , the group  @xmath1999 is residually @xmath0 .",
    "moreover , by condition ( 1 ) in corollary  [ cor : unfolded , 1 ] , for each vertex @xmath1436 of the graph underlying @xmath38 , the filtration @xmath2000 induces the pro-@xmath0 topology on @xmath2001 , and for each edge @xmath2002 , @xmath2003 induces the pro-@xmath0 topology on @xmath2004 .",
    "thus by lemma  [ lem : p - efficient ] , @xmath38 is @xmath0-efficient .",
    "[ cor : p - efficiency criterion ] suppose that all edge groups @xmath55 are abelian @xmath0-torsion free .",
    "assume moreover that @xmath111 is @xmath0-compatible of some level @xmath714 and for each vertex @xmath74 , the filtration @xmath63 induces the pro-@xmath0 topology on the subgroup @xmath1994 of @xmath35 .",
    "then there is a finite degree morphism @xmath610 of graphs of groups such that @xmath38 is @xmath0-efficient",
    ".    we can now prove proposition  [ prop : prop 2 restated ] .",
    "so let @xmath25 be a closed prime graph manifold .",
    "if @xmath25 seifert fibered , then there is nothing to do except to apply proposition  [ prop : seifert res p ] .",
    "suppose @xmath25 is not seifert fibered .",
    "then , after passing to a finite cover of @xmath25 if necessary , we may assume that @xmath25 is seifert simple .",
    "in the proof of proposition  [ prop : seifert simple lower p - central ] we showed that for every jsj component @xmath28 of @xmath25 , the filtration @xmath2005 of @xmath32 is a boundary compatible @xmath0-filtration of level @xmath163 for @xmath28 .",
    "clearly @xmath63 induces the pro-@xmath0 topology on @xmath2006 . hence by the previous corollary",
    ", @xmath25 admits a finite @xmath0-efficient cover .",
    "the usefulness of the notion of @xmath0-efficiency is to be found in connection with a description of the pro-@xmath0 completion of the fundamental group of a @xmath0-efficient graph of groups , which we give now .",
    "for simplicity we restrict our attention to graphs of finitely generated groups .    for a ( discrete ) group @xmath3",
    "we denote by @xmath2007 the pro-@xmath0 completion of @xmath3 , that is , the inverse limit of the system of @xmath0-group quotients of @xmath3 .",
    "the group @xmath2007 comes equipped with a topology making it a compact totally disconnected topological group , and we have a natural morphism @xmath2008 which is injective precisely if @xmath3 is residually  @xmath0 .",
    "let first @xmath31 be a graph of finitely generated pro-@xmath0 groups , i.e. , a graph of groups all of whose vertex and edge groups are ( topologically ) finitely generated pro-@xmath0 groups , and all of whose edge morphisms are continuous .",
    "in this situation , the is defined to be the pro-@xmath0 completion of @xmath54 : @xmath2009 .",
    "we have a natural continuous group morphism @xmath2010 , were @xmath3 is equipped with the pro-@xmath0 topology .",
    "unlike the case of the ordinary fundamental group , the natural morphisms @xmath2011 are usually not injective ( cf .",
    "* example  9.2.9 ) ) .",
    "one says that @xmath31 is _ proper _ if all morphisms @xmath2011 are injective .",
    "now let @xmath31 be an arbitrary graph of ( abstractly ) finitely generated groups .",
    "suppose the pro-@xmath0 topology on each vertex group @xmath35 induces the pro-@xmath0 topology on  @xmath675 for each edge @xmath372 with @xmath492 .",
    "( this will be satisfied if @xmath31 is @xmath0-efficient . )",
    "then the induced continuous group morphisms @xmath2012 between the pro-@xmath0 completions are injective , hence the graph of groups @xmath2013 with same underlying graph as @xmath31 , vertex groups @xmath2014 , edge groups @xmath2015 , and edge morphisms @xmath2016 , is a graph of finitely generated pro-@xmath0 groups as above .",
    "we have a natural morphism @xmath2017 of graphs of groups and hence a group morphism @xmath2018 .",
    "[ lem : p - efficient implies proper ] suppose @xmath31 is a @xmath0-efficient graph of finitely generated groups . then applying the pro-@xmath0 completion functor to the morphism @xmath2019 yields a continuous isomorphism @xmath2020 , and @xmath2013 is proper .    this is well - known in the profinite case ; we only sketch the proof .",
    "first note that @xmath0-efficiency implies that the natural morphism @xmath2021 is injective . using the commutative diagram one sees that @xmath2022 induces the pro-@xmath0 topology on @xmath54 , and @xmath3 is dense in @xmath2022 .",
    "hence the continuous morphism @xmath2020 remains injective and has dense image in @xmath2023 .",
    "since @xmath2007 is compact and @xmath2023 is hausdorff , this image in fact equals @xmath2023 .",
    "hence @xmath2020 is an isomorphism . since @xmath3 induces the pro-@xmath0 topology on each @xmath35 , the natural injective morphisms @xmath725 give rise to injective morphisms @xmath2024 .",
    "thus @xmath2013 is proper .      following @xcite we call a group @xmath3 _ cohomologically @xmath0-complete _ if the natural morphism @xmath2025 induces an isomorphism @xmath2026 for each  @xmath65 . here",
    ", @xmath2027 is the usual ( discrete ) cohomology of @xmath3 , and @xmath2028 is the continuous cohomology ( sometimes called galois cohomology @xcite ) of the pro-@xmath0 group @xmath2007 . in both cases the action on @xmath76",
    "is assumed to be trivial .",
    "cohomological @xmath0-completeness can be characterized in different ways :      1 .",
    "@xmath3 is cohomologically @xmath0-complete ; 2 .   for every finite @xmath0-primary @xmath3-module @xmath722 and @xmath65",
    ", the natural morphism @xmath2025 induces an isomorphism @xmath2029 ; 3 .   for every finite @xmath0-primary @xmath3-module @xmath722 and @xmath65 ,",
    "@xmath2030 4 .   for all @xmath65 , @xmath2031      for the implication ( 1 )  @xmath332  ( 2 ) see ( * ? ? ?",
    "* lemma  4.7 ) .",
    "the equivalences ( 1 )  @xmath2032  ( 4 ) and ( 2 )  @xmath2032  ( 3 ) follow from ( * ? ? ?",
    "* exercise  1 , section  i.2.6 ) .",
    "( this exercise is stated in terms of profinite completion , but extends easily to the pro-@xmath0 case . )",
    "see @xcite for more on this notion .",
    "a group which is cohomologically @xmath0-complete for every @xmath0 is said to be _ cohomologically complete . _",
    "( this class of groups is of interest in connection with atiyah s conjecture on the integrality of @xmath2033-betti numbers of compact manifolds with torsion free fundamental group @xcite . )",
    "free groups are cohomologically complete , as are right - angled artin groups @xcite and primitive link groups @xcite . ( the argument in ( * ? ? ?",
    "* theorem 1.2.1 ) claiming that all link groups are cohomologically complete seems to have a gap , cf .  @xcite . ) by induction on the nilpotency class , the following fact implies that finitely generated nilpotent groups are cohomologically complete :        [ prop : seifert virtually cc ] let @xmath25 be a seifert fibered space .",
    "then @xmath26 is virtually cohomologically complete . if @xmath1665 for some orientable surface @xmath57 , then @xmath26 is cohomologically complete .",
    "as in the proof of proposition  [ prop : seifert res p ] , after passing to a finite index subgroup if necessary , we may assume that @xmath25 is an @xmath1662-bundle over an orientable surface @xmath57 .",
    "if @xmath1665 for some orientable surface @xmath57 , then @xmath25 is already of this form . in any case , @xmath26 fits into an exact sequence @xmath2036 with ( the image of ) @xmath18 central in @xmath26 .",
    "proof of lemma  [ lem : s1-bundles res p ] . )",
    "now @xmath1683 is either free or an orientable surface group ; either way , @xmath1683 is a primitive one - relator group and hence cohomologically complete by ( * ? ? ?",
    "* exemple ( 2 ) , p. 144 ) .",
    "thus @xmath26 is also cohomologically complete , by proposition  [ prop : cc and central extensions ] .    on the other hand",
    ", it does not seem to be known which fundamental groups of hyperbolic @xmath1-manifolds are cohomologically @xmath0-complete . in @xcite ( with generalizations and different proofs in @xcite ) it is shown that if @xmath3 is the fundamental group of a closed hyperbolic @xmath1-manifold which is not virtually haken ( i.e. , a hypothetical counterexample to thurston s virtually haken conjecture ) , whose pro-@xmath0 completion is infinite , then @xmath3 is cohomologically @xmath0-complete .",
    "we have :      this complements a result by wilton and zalesskii @xcite who showed that every graph manifold group @xmath3 is _ good _ in the sense of serre ( * ? ? ?",
    "* section  2.6 , exercises ) , that is , with @xmath805 denoting the profinite completion of @xmath3 , for every finite @xmath3-module @xmath722 and @xmath65 , the natural morphism @xmath2037 induces an isomorphism @xmath2038 . for the proof of proposition  [ prop : virt cohomological p - completeness for graph manifolds ] we use the following well - known fact ,",
    "a consequence of lemma  [ lem : p - efficient implies proper ] ( cf .",
    "* proof of proposition  4.3 ) ) :    suppose @xmath31 is a @xmath0-efficient graph of finitely generated groups with underlying graph @xmath362 and fundamental group @xmath54 .",
    "let @xmath401 be an orientation of @xmath362 and @xmath363 .",
    "then for every @xmath0-primary @xmath3-module there is a commutative diagram @xmath2039 & h^{n}(g;m ) \\ar[r ] & \\bigoplus\\limits_{v\\in v } h^n(g_v;m ) \\ar[r ] & \\bigoplus\\limits_{e\\in e_+ } h^n(g_e;m ) \\ar[r ] & h^{n+1}(g;m ) \\ar[r]&\\cdots \\\\ \\cdots\\ar[r ] & h^{n}(\\widehat{g};m ) \\ar[r]\\ar[u ] & \\bigoplus\\limits_{v\\in v } h^n(\\widehat{g_v};m ) \\ar[r]\\ar[u ] & \\bigoplus\\limits_{e\\in e_+ } h^n(\\widehat{g_e};m ) \\ar[r]\\ar[u ] & h^{n+1}(\\widehat{g};m)\\ar[u ] \\ar[r]&\\cdots}\\ ] ] with exact rows . here",
    "the hats indicate pro-@xmath0 completion , the groups in the bottom row are continuous cohomology groups , and the vertical maps are induced by the natural embeddings of the groups into their pro-@xmath0 completions .",
    "suppose @xmath31 is a @xmath0-efficient graph of finitely generated groups .",
    "suppose all vertex and edge groups of @xmath31 are cohomologically @xmath0-complete .",
    "then @xmath54 is cohomologically @xmath0-complete .",
    "the results for graph manifolds in the previous sections naturally raise the question whether _ every _ closed prime @xmath1-manifold is , for all but finitely many @xmath0 , virtually @xmath0-efficient .",
    "( if the answer was `` yes , '' then every closed prime @xmath1-manifold also would be , for all but finitely many @xmath0 , virtually cohomologically @xmath0-complete . ) now , by corollary  [ cor : p - efficiency criterion ] , a positive answer to this question is implied by a positive answer to the following :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ let @xmath25 be an orientable hyperbolic @xmath1-manifold with non - empty toroidal incompressible boundary .",
    "does @xmath25 , for all but finitely many  @xmath0 , admit a boundary compatible @xmath0-filtration @xmath121 of some level which induces the pro-@xmath0 topology on @xmath2041 ? _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _      to investigate this issue more closely , let us return to the setting of the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] , in the case where @xmath72 and @xmath27 is the fundamental group of a @xmath1-manifold @xmath25 as in the question above , identified with a subgroup of @xmath1652 .",
    "we employ the modifications of this proof outlined in section  [ sec : kleinians ] , in order to take advantage of the special properties of @xmath3 : after conjugating @xmath3 suitably in @xmath1652 we may and shall assume that @xmath3 is defined over a ring @xmath51 of @xmath837-integers of a number field .",
    "suppose @xmath1494 is a maximal ideal of @xmath51 such that @xmath1513 is regular unramified with finite residue field of characteristic @xmath0 .",
    "for all but finitely many @xmath0 there will be such @xmath1494 .",
    "then @xmath1596 is a finite ring extension of @xmath342 .",
    "let @xmath86 be the finite set of exceptional primes as defined in the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] .",
    "in particular , @xmath1589 is @xmath0-torsion free for @xmath1595 .",
    "we note that long and reid @xcite showed , as a consequence of chebotarev s density theorem and the availability of a complete list of all subgroups of @xmath2042 ( cf .",
    "* section  3.6 ) ) :      in the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] , given @xmath1595 , we constructed a boundary compatible @xmath0-filtration @xmath2046 of level @xmath163 for @xmath25 by setting @xmath2047 in particular we have @xmath2048 now the following three possibilities for answering the question posed above present themselves :    1 .   _",
    "show that @xmath111 induces the pro-@xmath0 topology on @xmath346 .",
    "_ ( if so , we would be done . ) 2 .   _ show that @xmath3 induces the pro-@xmath0 topology on @xmath346 .",
    "_ ( if so , by remark  ( 2 ) following the proof of theorem  [ thm : virt res p for graphs of linear groups , 2 ] , the filtration @xmath2049 of @xmath3 defined by @xmath2050 would be a boundary compatible @xmath0-filtration of level @xmath163 for @xmath25 which clearly induces the pro-@xmath0 topology on @xmath2051 . )",
    "_ show that @xmath2052 is @xmath0-torsion free . _",
    "( if so , @xmath346 would be @xmath0-potent , hence by lemma  [ lem : canonical filtration , 2 ] , @xmath2053 would be a boundary compatible @xmath0-filtration of level  @xmath163 for @xmath25 . )",
    "this follows from an important result of lubotzky ( * ? ? ?",
    "* theorem  2.3  ( b ) ) : if @xmath98 is a finitely presentable group whose @xmath0-adic completion is analytic and @xmath2056 , then its deficiency @xmath2057 ( number of generators @xmath2058 number of relations ) satisfies the inequality @xmath2059 where @xmath2060 . on the other hand , it is well - known ( cf .",
    "@xcite ) that @xmath2055 has deficiency @xmath163 .",
    "thus @xmath2055 is not @xmath0-adic analytic .",
    "suppose @xmath2064 .",
    "let @xmath2065 denote the finite regular cover corresponding to @xmath2066 , and let @xmath79 be a boundary component of @xmath1638 .",
    "then @xmath2067}{[t : g_1\\cap t ] } \\geq \\frac{p^2(p^2 - 1)}{p^2}\\geq 3.\\ ] ] hence @xmath2068 by the previous lemma .",
    "if @xmath111 induced the pro-@xmath0 topology on @xmath346 , then the pro-@xmath0 completion of @xmath2069 would be @xmath0-adic analytic ( cf .",
    "the remark following the proof of lemma  [ lem : linearity ] ) , contradicting theorem  [ thm : lubotzky ] .",
    "let us now turn to the second approach . in order to show that @xmath3 induces the pro-@xmath0 topology on @xmath346 ,",
    "it is convenient to refine the normal series @xmath2070 : @xmath2071 note that @xmath346 has @xmath0-power index in @xmath2072 and @xmath2072 is residually @xmath0 ; hence @xmath2072 induces the pro-@xmath0 topology on @xmath346 , by the following well - known fact ( cf .",
    "* lemma  3.1.4  ( a ) ) ) :    let @xmath2073 be a group extension where @xmath214 is finitely generated , @xmath41 is residually @xmath0 , and @xmath2035 is a @xmath0-group .",
    "then @xmath41 induces the pro-@xmath0 topology on @xmath214 .",
    "thus it remains to show that @xmath3 induces the pro-@xmath0 topology on @xmath2072 .",
    "we do nt know whether this is the case .",
    "we do , however , have the following general fact ( inspired by ( * ? ? ?",
    "* proposition  4.23 ) ) , which might be of general interest . for this proposition and the lemmas used in its proof below",
    ", we fix a group extension @xmath2074 as a matter of convenience we shall assume that @xmath2075 and @xmath154 is just the natural inclusion map .",
    "note that @xmath41 acts on @xmath214 by conjugation , and this action descends to an action of @xmath2035 on @xmath2076 and hence on @xmath2077 .",
    "we say that @xmath2035 acts unipotently on @xmath2077 if the image of the associated morphism @xmath2078 is a @xmath0-group .",
    "[ prop : pro - p induced ] suppose @xmath214 is finitely generated , @xmath2035 is finite and perfect , and @xmath2079 is coprime to @xmath0 .",
    "suppose @xmath2035 acts unipotently on @xmath2077 .",
    "then @xmath41 induces the pro-@xmath0 topology on @xmath214 .",
    "here @xmath2080 denotes the schur multiplier of a finite group @xmath2035 .",
    "this proposition applies to extensions of @xmath2081 : if the sylow @xmath0-subgroups of a finite group @xmath2035 are cyclic for @xmath296 and each sylow @xmath34-subgroup of @xmath2035 is a generalized quaternion @xmath34-group , then @xmath2082 ( * ? ? ?",
    "* section  2.9 ) .",
    "this holds for @xmath2081 , for every @xmath0 ( cf .",
    "* section  3.6 ) ) . also recall that if @xmath2083 then the only proper normal subgroup of @xmath2042 is its center , hence @xmath2042 is perfect .",
    "we need to show that there exists a normal subgroup @xmath7 of @xmath41 of @xmath0-power index with @xmath2085 .",
    "we consider @xmath214 as a trivial @xmath2035-module . since @xmath2035 is perfect , we have @xmath2086 . now",
    "@xmath214 is a @xmath0-group and @xmath2079 is not divisible by @xmath0 , hence @xmath2087 .",
    "thus @xmath2088 , and this yields the existence of @xmath7 as desired .",
    "let @xmath2089 be the morphism arising from the action of @xmath41 on  @xmath214 , and let @xmath14 be its kernel",
    ". then lemma  [ lem : induced automorphisms ] and the assumption that @xmath2035 acts unipotently on @xmath2077 shows that @xmath14 has @xmath0-power index in @xmath41 .",
    "the normal subgroup  @xmath2090 of @xmath2035 has @xmath0-power index , hence equals @xmath2035 since the latter group is perfect .",
    "thus we have a central group extension @xmath2091 by the previous lemma there exists a normal subgroup @xmath7 of @xmath14 of @xmath0-power index such that @xmath2092 .",
    "since @xmath41 is finitely generated , after replacing  @xmath7 by its normal core in @xmath41 we may achieve that @xmath7 is normal in @xmath41 .",
    "we have to show : for every normal @xmath0-power index subgroup @xmath925 of @xmath214 , there is a normal subgroup @xmath7 of @xmath41 of @xmath0-power index with @xmath2093 .",
    "by replacing @xmath925 by its normal core in @xmath41 we may reduce to the case that @xmath925 is normal in @xmath41 .",
    "we thus obtain a group extension @xmath2094 where @xmath2095 is a finite @xmath0-group and @xmath2035 acts unipotently on @xmath2096 . by lemma  [ lem : pro - p unipotent ]",
    "applied to this group extension there exists a @xmath0-power index subgroup @xmath2097 of @xmath2098 with @xmath2099 .",
    "then the preimage @xmath7 of @xmath2097 under the natural surjection @xmath2100 has the desired property .    with @xmath2064 as in proposition  [ prop : long - reid ] , @xmath3 and @xmath2072 fit into a short exact sequence @xmath2101 in order to be able to apply our proposition  [ prop : pro - p induced ] , we would need @xmath2035 to act unipotently , and hence trivially , on @xmath2102 . however , this is not the case :    [ prop : q acts non - trivially ] let @xmath722 be an orientable hyperbolic @xmath1-manifold with non - empty boundary , and suppose @xmath2103 be the cover corresponding to a surjective morphism @xmath2104 , where @xmath2105",
    ". then @xmath2035 acts non - trivially on @xmath2106 .    for the proof of this proposition we use the well - known fact ( cf .",
    "* chapter  iv , corollary  6.8 ) and @xcite ) that for odd @xmath0 , the mod @xmath0 cohomology ring of @xmath2081 has the form @xmath2107/(y^{2}),\\ ] ] equipped with the grading given by @xmath2108 , @xmath2109 . hence @xmath2110    we assume for a contradiction that @xmath2035 acts trivially on @xmath2106 .",
    "we have @xmath2111 as @xmath2035-modules . also , the natural morphism @xmath2112 is a surjective morphism of @xmath2035-modules , hence @xmath2035 acts trivially on @xmath2113 and thus , by poincar - lefschetz duality , on @xmath2114",
    ". therefore the hochschild - serre spectral sequence of the short exact sequence @xmath2115 looks like @xmath2116 where both @xmath2117 and @xmath2118 are trivial @xmath2035-modules . using the description of @xmath2119 above",
    "we now see that since @xmath2105 , the @xmath76 with the coordinates @xmath2120 , @xmath2121 , in the bottom row of the second sheet @xmath2122 only get hit by the zero differentials , hence survive in @xmath2123 , contradicting the fact that @xmath2124 is finite - dimensional .",
    "this proposition shows that in order to successfully complete approach  ( 2 ) to answering our question , i.e. , to show that @xmath3 induces the pro-@xmath0 topology on @xmath346 , one would have to use other methods than proposition  [ prop : pro - p induced ] .",
    "as to approach  ( 3 ) , that is , to prove that @xmath2052 is @xmath0-torsion free , it may be useful to again refine @xmath2070 , this time as @xmath2125 this leads to two subquestions , given @xmath25 as above .    1 .",
    "are there only finitely many @xmath0 such that for the cover @xmath2126 corresponding to the natural group morphism @xmath2127 , the abelian group @xmath2128 has non - trivial @xmath0-torsion ?",
    "are there only finitely many @xmath0 such that for the cover @xmath2129 corresponding to the group morphism @xmath2130 , @xmath2131 has non - trivial @xmath0-torsion ?",
    "concerning subquestion  ( 1 ) : currently available technology allows one to extract information about the prime - to-@xmath0-torsion in the homology of abelian @xmath0-power covers from algebraic data associated to @xmath3 , cf .",
    ", e.g. , @xcite ; however , little seems to be known about @xmath0-torsion in the homology of such covers .",
    "it is known that if @xmath722 is a knot complement in @xmath15 and @xmath2132 is a @xmath0-power cyclic cover of @xmath722 , then @xmath2133 has trivial @xmath0-torsion @xcite .",
    "moreover , by ( * ? ? ?",
    "* theorem  5.11 ) , if @xmath722 is the complement of a @xmath34-component link @xmath2134 in @xmath15 and @xmath0 does not divide the linking number of @xmath2135 and @xmath2136 , then for every abelian @xmath0-power index cover @xmath2132 of  @xmath722 , again @xmath2133 has only trivial @xmath0-torsion .",
    "this leads us to conjecture that at least for link complements , subquestion  ( 1 ) has a positive answer .    as to ( 2 )",
    ", we do not know the answer .",
    "we note that reznikov ( * ? ? ?",
    "* theorem  9.2 ) proved a result pointing to a negative answer ; however his result only holds for certain covers of _ closed _ @xmath1-manifolds : if @xmath722 is a closed @xmath1-manifold , and @xmath2137 the cover corresponding to a surjective group morphism @xmath2138 where @xmath2105 , and @xmath2139 , then @xmath2140 has non - trivial @xmath0-torsion .",
    "[ prop : injective on mod p homology ] every closed orientable prime @xmath1-manifold @xmath25 has , for all but finitely many @xmath0 , a finite cover @xmath103 such that for every jsj component @xmath104 of @xmath103 , the natural map @xmath105 is injective .        in this subsection",
    "we let @xmath31 be a graph of finitely generated groups based on a graph @xmath362 , and we let @xmath79 be a maximal subtree of @xmath362 .",
    "we assume that for a given @xmath0 , we have @xmath2142 then the collection @xmath2143 of normal subgroups is compatible , and for each edge @xmath372 of @xmath362 , the edge morphism @xmath2144 ( where @xmath520 ) induces an injective morphism @xmath2145 we call the graph of groups @xmath2146 the _ mod @xmath0 homology graph _ of @xmath31 , and denote it by @xmath2141 .",
    "it has the same underlying graph @xmath362 as @xmath31 , vertex and edge groups @xmath2147",
    "respectively @xmath2148 , and edge morphisms @xmath2149 .    the fundamental groups of @xmath31 and of @xmath2141 have the same first mod @xmath0 homology : the natural surjections @xmath2150 and @xmath2151 define a morphism @xmath2152 of graphs of groups , hence yield a surjective morphism @xmath2153 which induces an isomorphism in homology mod @xmath0 , by the following lemma :    [ lem : iso in homology ] let @xmath722 be a trivial @xmath3-module , and let @xmath1138 be a compatible collection of normal subgroups of @xmath31 such that for each @xmath439 and @xmath435 , the natural surjections @xmath2154 induce isomorphisms @xmath2155 then the natural surjective morphism @xmath2156 induces an isomorphism @xmath2157    this is shown by an easy application of the five - lemma in combination with the mayer - vietoris sequence of @xmath31 , cf .  section  [ sec : mv ]",
    "this fact together with the remark following lemma  [ lem : homology and fiber sums ] yields :    suppose there exists a morphism @xmath2158 to an elementary abelian @xmath0-group which is injective on the vertex groups of @xmath31 . then the natural inclusions @xmath725 yield injective morphisms @xmath2159 .",
    "[ lem : injective on homology ] suppose @xmath31 satisfies .",
    "then there exists a morphism of graphs of groups @xmath610 of finite degree such that for each vertex @xmath591 , the natural inclusion @xmath2160 yields an embedding @xmath2161 .",
    "we apply the same argument as in the proof of corollary  [ cor : unfolded , 1 ] with @xmath2162 .",
    "we obtain a morphism @xmath1442 to a finite group , with corresponding unfolding @xmath1377 of @xmath1123 , and a morphism @xmath1443 to an elementary abelian @xmath0-group which is injective when restricted to each vertex group of @xmath1444 .",
    "let @xmath91 be the unfolding to @xmath31 along @xmath90 .",
    "since @xmath2163 , the graphs of groups @xmath1444 and @xmath2164 are naturally isomorphic , and by lemma  [ lem : separating , 3 ] , @xmath38 also satisfies .",
    "thus the previous corollary applies to @xmath38 in place of @xmath31 .",
    "suppose all edge groups of @xmath31 are abelian @xmath0-torsion free , and suppose for some @xmath714 , @xmath31 admits a @xmath0-compatible filtration of level @xmath1451 .",
    "then there exists a morphism @xmath610 of graphs of groups such that the image of @xmath37 in @xmath30 has finite index , and for each vertex @xmath591 , the natural inclusion @xmath2160 yields an embedding @xmath2161 .    let @xmath111 be a @xmath0-compatible filtration of @xmath31 of level @xmath1451 ; then @xmath111 is @xmath0-excellent . arguing as in the proof of theorem  [ thm : reduction theorem , 3 ] , we let @xmath91 be a morphism of graphs of groups obtained by applying proposition  [ prop : commoncover ] to the compatible collection of normal subgroups @xmath2165 of @xmath31 .",
    "then the filtration @xmath1997 of @xmath38 is complete ; in fact , @xmath2166 is a central @xmath0-filtration of @xmath38 .",
    "now , in the proof of theorem  [ thm : reduction theorem , 3 ] we simply applied lemma  [ lem : separating , 2 ] to show that @xmath2166 intersects to a uniformly @xmath0-potent filtration on the image of each edge group of @xmath38 under the edge morphisms .",
    "however , the somewhat more complicated lemma  [ lem : separating , 4 ] shows that in our situation , these intersections are precisely the lower central @xmath0-filtrations of the images of the edge groups under the edge morphisms . by lemma  [ lem : canonical filtration , 2 ] ,",
    "the lower central @xmath0-filtration @xmath2167 of  @xmath38 also has this property , i.e. , @xmath38 satisfies .",
    "so may now apply lemma  [ lem : injective on homology ] to @xmath38 in place of @xmath31 to complete the proof .",
    "let @xmath25 be a closed orientable prime @xmath1-manifold @xmath25 .",
    "clearly we may assume that @xmath25 has a non - trivial jsj decomposition .",
    "as shown in section  [ sec : reduction to seifert simple ] , after replacing @xmath25 by a finite cover if necessary , we may then reduce to the case that @xmath25 is seifert simple . then ,",
    "by propositions  [ prop : virtphyp ] and [ prop : seifert simple lower p - central ] , for all but finitely many @xmath0 , each jsj component of @xmath25 admits a boundary compatible @xmath0-filtration of level @xmath163 , and so by the previous lemma , the proposition follows .",
    "h. bass and a. lubotzky , _ linear - central filtrations on groups , _ in : w. abikoff et al .",
    "( eds . ) , _ the mathematical legacy of wilhelm magnus : groups , geometry and special functions , _ pp",
    ". 4598 , contemp .",
    "169 , amer .",
    "soc . , providence , ri , 1994 .",
    "p. e. conner and f. raymond , _ manifolds with few periodic homeomorphisms , _ in : h. t. ku et al .",
    ", _ proceedings of the second conference on compact transformation groups univ .",
    "massachusetts , amherst , mass .",
    ", 1971 , _ part ii , pp . 175 , lecture notes in math .",
    "299 , springer - verlag , berlin , 1972 .",
    "l. van den dries , _ big cohen - macaulay modules in equal characteristic @xmath732 _ , london mathematical society lecture note series , vol . 145 , ch .  12 , pp .  221284 , cambridge university press , cambridge , 1990 .",
    "g. a. fernndez - alcober , i. v. kazachkov , v. n. remeslennikov , and p. symonds , _ comparison of the discrete and continuous cohomology groups of a pro-@xmath0 group _ , st . petersburg math .",
    "j. * 19 * ( 2008 ) , 961973 .",
    "s. friedl and s. vidussi , _ twisted alexander polynomials and fibered @xmath1-manifolds _ , in : m. usher ( ed . ) , _ low - dimensional and symplectic topology _ ,",
    "proceedings of symposia in pure mathematics , vol .",
    "82 , pp .  111130 , american mathematical society , providence , ri , 2011 .",
    "j. hempel , _ residual finiteness for @xmath1-manifolds _ , in : s. m. gersten and j. r. stallings ( eds . ) , _ combinatorial group theory and topology alta , utah , 1984 _ , pp .  379396 , ann .",
    "111 , princeton univ . press , princeton , nj , 1987 .",
    "j. hillman , d. matei , and m. morishita , _",
    "pro-@xmath0 link groups and @xmath0-homology groups , _ in : t. kohno and m. morishita ( eds . ) , _ primes and knots , _ pp .  121136 , contemp .",
    "416 , amer .",
    "soc . , providence , ri , 2006 .",
    "r. kirby , _ problems in low - dimensional topology , _ in : w. h. kazez ( ed . ) , _ geometric topology , _ pp . 35473 , ams / ip studies in advanced mathematics , vol .",
    "2.2 , american mathematical society , providence , ri ; international press , cambridge , ma , 1997 .",
    "scott and t. wall , _ topological methods in group theory , _ in : c. t. c. wall ( ed . ) , _ homological group theory proc .",
    "sympos . , durham , 1977 , _ pp . 137203 , london math .",
    "lecture note ser .",
    "36 , cambridge univ . press , cambridge - new york , 1979 ."
  ],
  "abstract_text": [
    "<S> given a prime @xmath0 , a group is called residually @xmath0 if the intersection of its @xmath0-power index normal subgroups is trivial . </S>",
    "<S> a group is called virtually residually @xmath0 if it has a finite index subgroup which is residually @xmath0 . </S>",
    "<S> it is well - known that finitely generated linear groups over fields of characteristic zero are virtually residually @xmath0 for all but finitely many @xmath0 . in particular , fundamental groups of hyperbolic @xmath1-manifolds </S>",
    "<S> are virtually residually @xmath0 . </S>",
    "<S> it is also well - known that fundamental groups of @xmath1-manifolds are residually finite . in this paper </S>",
    "<S> we prove a common generalization of these results : every @xmath1-manifold group is virtually residually @xmath0 for all but finitely many  @xmath0 . </S>",
    "<S> this gives evidence for the conjecture ( thurston ) that fundamental groups of @xmath1-manifolds are linear groups .    </S>",
    "<S> dedicated to the memory of + sr .  </S>",
    "<S> m.  benigna  fehlner ( 19222008 ) + who , as their teacher in kindergarten , first introduced the authors to each other . </S>"
  ]
}