{
  "article_text": [
    "electronic structure theory describes the energies and distributions of electrons , and is essential in characterizing the microscopic structures of molecules and materials in condensed phases . among all the different formalisms of electronic structure theory ,",
    "kohn - sham density functional theory ( ksdft )  @xcite achieves so far the best compromise between accuracy and efficiency , and has become the most widely used electronic structure model for condensed matter systems .",
    "kohn - sham density functional theory gives rise to a nonlinear eigenvalue problem , which is commonly solved using the self - consistent field iteration method  @xcite . in each iteration",
    ", the kohn - sham hamiltonian is constructed from a trial electron density and is discretized into a finite dimensional matrix .",
    "the electron density is then obtained from the low - lying eigenfunctions , called kohn - sham orbitals , of the discretized hamiltonian .",
    "the resulting electron density and the trial electron density are then mixed and form a new trial electron density .",
    "the loop continues until self - consistency of the electron density is reached .",
    "an efficient algorithm therefore contains three phases : discretization of the hamiltonian ; evaluation of the electron density from the discretized hamiltonian ; and self - consistent iteration . in this paper , we focus on the discretization of the hamiltonian and the evaluation of the electron density in the pseudopotential framework  @xcite .",
    "if space is uniformly discretized , the kohn - sham hamiltonian generally requires a basis set with a large number of degrees of freedom per atom . for most chemical systems , the kinetic energy cutoff typically ranges from @xmath2ry to @xmath3ry for standard planewave discretization in the norm - conserving pseudopotential framework  @xcite , which amounts to about @xmath4 basis functions per atom .",
    "the required number of basis functions per atom is even larger for uniform discretization methods other than planewaves , such as finite difference method  @xcite and finite element method  @xcite .",
    "the large number of basis functions per atom originates from the rapid oscillation of the kohn - sham orbitals .",
    "the kohn - sham orbitals oscillate rapidly around the nuclei and become smooth in the interstitial region of the nuclei .",
    "physical intuition suggests that the rapid oscillations around the nuclei are inert to changes in the environment .",
    "a significant part of the rapid oscillations can already be captured by the orbitals associated with isolated atoms .",
    "these orbitals are called atomic orbitals .",
    "numerical methods based on atomic orbitals or similar ideas have been designed based on this observation  @xcite .",
    "environmental effect is not built into the atomic orbitals directly , but can only be approximated by fine tuning the adjustable parameters in these atomic orbitals .",
    "the values of the adjustable parameters therefore vary among different chemical elements and exchange - correlation potentials , and sometimes vary among the different ambient environment of atoms .",
    "the quality of the atomic orbitals are difficult to be improved systematically , but relies heavily on the experience of the underlying chemical system .",
    "atomic orbitals and uniform discretization methods can be combined , as in the mixed basis methods  @xcite .",
    "the quality of the basis functions can therefore be systematically improved by incorporating the uniform discretization methods . however , fine tuning the adjustable parameters is still necessary due to the absence of the environmental effect in the basis functions , and in certain circumstances the number of basis functions per atom is still large .    in this paper",
    "we propose a novel discretization method to build the environmental effects into the basis set to achieve further dimension reduction of the basis set .",
    "the basis functions are constructed adaptively and seamlessly from the atomic configuration in local domains , called elements .",
    "the basis functions are discontinuous at the boundary of the elements , and they form the basis set used in the discontinuous galerkin ( dg ) framework .",
    "the flexibility of the dg framework allows us to employ these discontinuous basis functions to approximate the continuous kohn - sham orbitals , and allows us to achieve high accuracy ( less than @xmath0mev ) in the total energy calculation with a very small number ( @xmath1 ) of basis functions per atom .. our method is implemented in parallel with a rather general data communication framework , and the current implementation is able to calculate the total energy for systems consisting of thousands of atoms .",
    "the discontinuous galerkin framework has been widely used in numerical solutions of partial differential equations ( pde ) for more than four decades , see for example @xcite and the references therein .",
    "one of the main advantages of the dg method is its flexibility in the choice of the basis functions .",
    "the idea of constructing basis functions adaptively from the local environment has also been explored in other circumstances in numerical analysis such as reduced basis method  @xcite and multi - scale discontinuous galerkin method  @xcite for solving pde . in the current context",
    ", we apply the dg algorithm to solve eigenvalue problems with oscillatory eigenfunctions , and the basis functions are constructed by solving auxiliary local problems numerically .",
    "the paper is organized as follows .",
    "section  [ sec : dg ] introduces the discontinuous galerkin framework for kohn - sham density functional theory .",
    "the construction of the adaptive local basis functions is introduced in section  [ sec : basis ] .",
    "section  [ sec : impel ] discusses implementation issues in more detail .",
    "the performance of our method is reported in section  [ sec : numer ] , followed by the discussion and conclusion in section  [ sec : discussion ] .",
    "the kohn - sham energy functional in the pseudopotential framework  @xcite is given by : @xmath5 { \\,\\mathrm{d}}x,\\end{gathered}\\ ] ] where @xmath6 and the @xmath7 s satisfy the orthonormal constraints : @xmath8 in , we have taken the kleinman - bylander form of the pseudopotential  @xcite .",
    "the pseudopotential is given by @xmath9 for each @xmath10 , @xmath11 is a function supported locally in the real space around the position of one of the atoms , @xmath12 or @xmath13 , and we have used the dirac bra - ket notation .",
    "we have ignored the spin degeneracy and have adopted the local density approximation ( lda )  @xcite for the exchange - correlation functional .",
    "the proposed method can also be used for more complicated exchange - correlation functionals and when spin degeneracy is involved .",
    "the kohn - sham equation , or the euler - lagrange equation associated with reads @xmath14 \\psi_i = ( - \\tfrac{1}{2 } \\delta + v_{{\\mathrm{eff}}}[\\rho ]    + \\sum_{\\ell } \\gamma_{\\ell } { \\lvertb_{\\ell}\\rangle } { \\langleb_{\\ell}\\rvert } )     \\psi_i = e_i \\psi_i,\\ ] ] where the effective one - body potential @xmath15 is given by @xmath16(x ) = v_{{\\mathrm{ext}}}(x ) + \\int \\frac{\\rho(y)}{{\\left\\lvertx - y\\right\\rvert}}{\\,\\mathrm{d}}y    + { \\epsilon_{\\mathrm{xc}}}'[\\rho(x)].\\ ] ] note that is a nonlinear eigenvalue problem , as @xmath15 depends on @xmath17 , which is in turn determined by @xmath7 .",
    "the electron density is self - consistent if both   and   are satisfied . after obtaining the self - consistent electron density ,",
    "the total energy of the system can be expressed using the eigenvalues @xmath18 and @xmath17 as  @xcite @xmath19 { \\,\\mathrm{d}}x - \\int { \\epsilon_{\\mathrm{xc}}}'[\\rho(x ) ] \\rho(x ) { \\,\\mathrm{d}}x .",
    "\\label{eqn : etot}\\ ] ] the goal of kohn - sham density functional theory is to calculate the total energy @xmath20 and the self - consistent electron density @xmath17 given the atomic configuration .",
    "numerical algorithms for kohn - sham density functional theory can be broadly divided into two categories : one may try to directly minimize the energy functional with respect to the kohn - sham orbitals @xmath7 ( see e.g. @xcite ) ; one may also try to look for a solution for , usually by using the self - consistent iteration .",
    "the self - consistent iteration goes as follows .",
    "starting with an initial guess @xmath21 , one looks for a solution of iteratively :    1 .",
    "discretization of the hamiltonian : determine the effective hamiltonian @xmath22 $ ] from the input density at the @xmath23-th step @xmath24 ; 2 .",
    "evaluation of the electron density : obtain @xmath25 from the effective hamiltonian @xmath22 $ ] ; 3 .",
    "self - consistent iteration : determine the input density at the @xmath26-th step @xmath27 from @xmath24 and @xmath28 , for instance : @xmath29 with some parameter @xmath30 .",
    "4 .   if @xmath31 , stop ; otherwise , go to step @xmath32 with @xmath33 .",
    "the mixing step above is called linear mixing in the literature , which is the simplest choice .",
    "more advanced mixing schemes  @xcite can be used as well .",
    "the mixing scheme used in our current implementation is the anderson mixing scheme  @xcite , but we will not go into the details of mixing schemes in this work .",
    "in this paper we focus on the discretization of the hamiltonian and the evaluation of the electron density .",
    "given an effective potential @xmath15 , we find @xmath28 from @xmath34 where the @xmath7 s are the first @xmath35 eigenfunctions of @xmath36 .",
    "@xmath37 note that the @xmath7 s minimize the variational problem @xmath38 with the orthonormality constraints @xmath39 .",
    "the evaluation of the electron density is clearly the main bottleneck in the self - consistent iteration , which is the focus of the numerical algorithms for kohn - sham density functional theory .",
    "we consider efficient and accurate discretization for the evaluation of the electron density in this work .",
    "the discontinuous galerkin ( dg ) methods have been developed for different types of partial differential equations @xcite .",
    "one of the main advantages of the dg method is its flexibility in the choice of the approximation space , as the dg method does not require the continuity condition of the basis functions across the interfaces of the elements .",
    "this flexibility is important for constructing effective discretization schemes for kohn - sham density functional theory .",
    "we present in the following a dg method for the evaluation of the electron density . among the different formalisms in the dg framework",
    ", we will use the interior penalty method @xcite . the interior penalty method",
    "naturally generalizes the variational principle  .",
    "we denote by @xmath40 the computational domain with the periodic boundary condition , which corresponds to @xmath41 point sampling in the brillouin zone .",
    "@xmath40 is also referred to as the global domain in the following discussion .",
    "bloch boundary conditions can be taken into account as well , and this will appear in future publications .",
    "let @xmath42 be a collection of quasi - uniform rectangular partitions of @xmath40 ( see fig .",
    "[ fig : na1dpartition ] for an example with four elements ) : @xmath43 and @xmath44 be the collection of surfaces that correspond to @xmath42 .",
    "each @xmath45 is called an element of @xmath40 . for a typical choice of partitions used in practice ,",
    "the elements are chosen to be of the same size .",
    "for example , for a crystalline material , elements can be chosen as integer multiples of the conventional cell of the underlying lattice . as a result , unlike the usual finite element analysis , the element size will remain the same .- refinement . ]    in the following discussion , we use extensively the inner products defined as below @xmath46 in the discontinuous galerkin method ( the interior penalty method ) , the discrete energy functional corresponding to is given by @xmath47    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } }    + { \\left\\langle v_{{\\mathrm{eff } } } , \\rho \\right\\rangle}_{{\\mathcal{t } } } \\\\",
    "+ \\frac{\\alpha}{h } \\sum_{i=1}^n { \\left\\langle{\\big[\\hspace{-0.7 mm } \\big [ \\psi_i \\big ]    \\hspace{-0.7 mm } \\big ] } ,      { \\big[\\hspace{-0.7 mm } \\big [ \\psi_i \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } } + \\sum_{\\ell } \\gamma_{\\ell } \\sum_{i=1}^n     { \\left\\lvert{\\left\\langleb_{\\ell } , \\psi_i\\right\\rangle}_{{\\mathcal{t}}}\\right\\rvert}^2.\\end{gathered}\\ ] ] here the last term comes from the non - local terms in eq .  , and @xmath48 and @xmath49    \\hspace{-0.7 mm } \\big]}$ ] are the average and the jump operators across surfaces , defined as follows . for @xmath50",
    "the set of interior surfaces , we assume @xmath51 is shared by elements @xmath52 and @xmath53 .",
    "denote by @xmath54 and @xmath55 the unit normal vectors on @xmath51 pointing exterior to @xmath52 and @xmath53 , respectively . with @xmath56 , @xmath57",
    ", we set @xmath58    \\hspace{-0.7 mm } \\big ] } = u_1 n_1 + u_2 n_2 \\quad \\text{on } s.\\ ] ] for @xmath59 where @xmath60 is the union of the surfaces on the boundary , we set @xmath58    \\hspace{-0.7 mm } \\big ] } = u n \\quad \\text{on } s,\\ ] ] where @xmath23 is the outward unit normal . for vector - valued function @xmath61",
    ", we define @xmath62 where @xmath63 , and @xmath64 note that in the current context @xmath65 since we assume periodic boundary condition for the computational domain , and every surface is an interior surface .",
    "the constant @xmath30 in is a positive penalty parameter , which penalizes the jumps of functions across element surfaces to guarantee stability .",
    "the choice of @xmath30 will be further discussed in section  [ sec : numer ] .",
    "assume that we have chosen for each element @xmath66 a set of basis functions @xmath67 , where @xmath68 is the number of basis functions in @xmath66 .",
    "we extend each @xmath69 to the whole computational domain @xmath40 by setting it to be @xmath70 on the complement set of @xmath66 .",
    "define the function space @xmath71 as @xmath72    we minimize for @xmath73 .",
    "the energy functional in the approximation space @xmath71 leads to the following eigenvalue problem for @xmath74 . for any @xmath75 , @xmath76    \\hspace{-0.7 mm } \\big ] } , { \\big\\ { \\hspace{-0.7 mm } \\big\\ { \\nabla \\psi_i \\big\\ }    \\hspace{-0.7 mm } \\big\\}}\\right\\rangle}_{{\\mathcal{s } } } -\\frac{1}{2 }    { \\left\\langle{\\big\\ { \\hspace{-0.7 mm } \\big\\ { \\nabla v \\big\\ }    \\hspace{-0.7 mm } \\big\\ } } , { \\big[\\hspace{-0.7 mm } \\big [ \\psi_i \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } }    + \\frac{\\alpha}{h } { \\left\\langle{\\big[\\hspace{-0.7 mm } \\big [ v \\big ]    \\hspace{-0.7 mm } \\big ] } , { \\big[\\hspace{-0.7 mm } \\big [ \\psi_i \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s}}}\\\\    + { \\left\\langlev , v_{\\mathrm{eff}}\\psi_i\\right\\rangle}_{{\\mathcal{t } } } + \\sum_{\\ell } \\gamma_{\\ell }    { \\left\\langlev , b_\\ell\\right\\rangle}_{{\\mathcal{t } } } { \\left\\langleb_\\ell , \\psi_i\\right\\rangle}_{{\\mathcal{t } } } =    \\lambda_i { \\left\\langlev , \\psi_i\\right\\rangle}_{{\\mathcal{t}}}.\\end{gathered}\\ ] ] setting @xmath77 and @xmath78 we arrive at the following linear system @xmath79    \\hspace{-0.7 mm } \\big ] } ,      { \\big\\ { \\hspace{-0.7 mm } \\big\\ { \\nabla { \\varphi}_{k , j } \\big\\ }    \\hspace{-0.7 mm } \\big\\}}\\right\\rangle}_{{\\mathcal{s } } } \\\\    -\\frac{1}{2}{\\left\\langle{\\big\\ { \\hspace{-0.7 mm } \\big\\ { \\nabla { \\varphi}_{k',j ' } \\big\\ }    \\hspace{-0.7 mm } \\big\\ } } ,      { \\big[\\hspace{-0.7 mm } \\big [ { \\varphi}_{k , j } \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } } + \\frac{\\alpha}{h }    { \\left\\langle{\\big[\\hspace{-0.7 mm } \\big [ { \\varphi}_{k',j ' } \\big ]    \\hspace{-0.7 mm } \\big ] } , { \\big[\\hspace{-0.7 mm } \\big [ { \\varphi}_{k , j } \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } }    + { \\left\\langle{\\varphi}_{k',j ' } , v_{\\mathrm{eff}}{\\varphi}_{k , j}\\right\\rangle}_{{\\mathcal{t } } } \\\\",
    "+ \\sum_\\ell \\gamma_{\\ell } { \\left\\langle{\\varphi}_{k',j'},b_\\ell\\right\\rangle}_{{\\mathcal{t } } }    { \\left\\langleb_\\ell , { \\varphi}_{k , j}\\right\\rangle}_{{\\mathcal{t } } } \\biggr ) c_{i;k , j } =    \\lambda_{i } \\sum_{k , j }    { \\left\\langle{\\varphi}_{k',j ' } , { \\varphi}_{k , j}\\right\\rangle } c_{i;k , j}. \\label{eq : dgimpl}\\end{gathered}\\ ] ] we define @xmath80 to be the matrix with entries given by the expression in the parentheses , @xmath81 to be the matrix with entries @xmath82 , and @xmath83 to be the vector with components @xmath84 , we have the following simple form of generalized eigenvalue problem @xmath85 for @xmath86 . following the standard terminologies in the finite element method , we call @xmath80 the ( dg ) stiffness matrix , and @xmath81 the ( dg ) mass matrix . in the special case",
    "when the dg mass matrix @xmath81 is equal to the identity matrix , we have a standard eigenvalue problem @xmath87 .",
    "once @xmath88 are available , the electron density is calculated by @xmath89",
    "the proposed framework in the last section is valid for any choice of basis functions . to improve the efficiency of the algorithm , it is desirable to use less number of basis functions while maintaining the same accuracy . in order to achieve this goal",
    ", the choice of the functions @xmath90 is important . in this section",
    ", we discuss a way to construct the basis functions @xmath90 that are adapted to the local environment .",
    "the starting point is the following observation .",
    "the kohn - sham orbitals @xmath7 exhibit oscillatory behavior around the nuclei . in a full electron calculation",
    ", the nuclei charge density is the summation of delta functions located at the positions of the nuclei ( or numerical delta function after discretization ) and the kohn - sham orbitals have cusp points at the positions of the atoms . in the pseudopotential framework which involves only valence electrons",
    ", one can still see that the kohn - sham orbitals and the electron density are much more oscillatory near the atom cores than in the interstitial region , as illustrated in fig .",
    "[ fig : sing ] . in the setting of real space method or planewave method , in order to resolve the kohn - sham orbitals around the atom cores where the derivatives of kohn - sham orbitals become large one has to use a uniform fine mesh .",
    "therefore , the number of mesh points becomes huge even for a small system .",
    "this makes the electronic structure calculation expensive .    in order to reduce the cost , we note that the kohn - sham orbitals are smooth away from the atoms and the uniform fine discretization is not efficient enough .",
    "adaptive refinement techniques can be used to improve the efficiency by reducing the number of basis functions per atoms .",
    "techniques of this type include finite element based adaptive mesh refinement method  @xcite , finite volume based adaptive mesh refinement method , and multiresolution basis functions  @xcite , to name a few .",
    "our approach builds the oscillatory behavior the kohn - sham orbitals near the atom cores into the basis functions .",
    "hence , a small number of basis functions are enough to characterize the kohn - sham orbitals .",
    "this idea is not entirely new .",
    "for example , the philosophy of pseudopotential techniques is quite similar , though the reduction is done at the analytic level . on the side of numerical methods ,",
    "the ideas behind atomic orbital basis or numerical atomic basis are closely related  @xcite .",
    "the main difference from the previous approaches is that instead of predetermining basis functions based on the information from isolated atoms , our approach builds the information from the local environment into the basis functions as well .",
    "thanks to the flexibility of the discontinuous galerkin framework , this can be done in a seamless and systematic way .",
    "the basis functions form a complete basis set in the global domain @xmath40 .",
    "the basis set is therefore efficient , and at the same time the accuracy can be improved systematically .",
    "this is an important difference between this approach and the previous methods along the same line .",
    "the basis functions @xmath91 are determined as follows . given the partition @xmath42 and the effective potential @xmath15 ,",
    "let us focus on the construction of @xmath91 , @xmath92 for one element @xmath93 . as discussed above ,",
    "our approach is to adapt @xmath90 to the local environment in @xmath66 .    for each element @xmath66",
    ", we take a region @xmath94 .",
    "@xmath95 is called the extended element associated with the element @xmath66 .",
    "the set @xmath96 is called the buffer area",
    ". we will choose @xmath97 which extends symmetrically along the @xmath98 directions from the boundary of @xmath66 .",
    "the length of the buffer area extended beyond the boundary of @xmath45 along the @xmath98 direction is called the `` buffer size along the @xmath99 direction '' .",
    "we restrict the effective hamiltonian on @xmath95 by assuming the periodic boundary condition on @xmath100 and denote by @xmath101 the restricted hamiltonian .",
    "@xmath101 is discretized and diagonalized , and the corresponding eigenfunctions are denoted by @xmath102 , indexed in increasing order of the associated eigenvalues .",
    "we restrict the first @xmath68 eigenfunctions @xmath102 from @xmath95 to @xmath66 , denoted by @xmath91 .",
    "each @xmath103 is therefore defined locally on @xmath66 . as discussed before we extend each @xmath69 to the global domain @xmath40 by setting the value to be @xmath70 on the complement of @xmath66 .",
    "the resulting functions , still denoted by @xmath90 are called the adaptive local basis functions .",
    "numerical result suggests that we can take very small @xmath68 to achieve chemical accuracy .",
    "the reason why we choose the periodic boundary condition on @xmath95 for the restriction @xmath101 is twofold . on one hand",
    ", the periodic boundary condition captures better the bulk behavior of the system ( than the dirichlet boundary condition for example ) ; on the other hand , the periodic boundary condition makes the solution of @xmath101 more easily adapted to existing dft algorithms and packages , as most of them can treat periodic boundary conditions .",
    "other choices such as the neumann boundary condition are possible , and the optimal choice of boundary conditions remains to be an open question .    the basis functions constructed from the buffer region capture well the local singular behavior of kohn - sham orbitals near the nuclei . hence , the approximation space formed by @xmath90 gives an efficient and accurate discretization to the problem , as will be illustrated by numerical examples in section  [ sec : numer ] .",
    "note that the @xmath104 s are the eigenfunctions of the self - adjoint operator @xmath101 on @xmath95 , and therefore form a complete basis set on @xmath95 when @xmath105 .",
    "this implies that after restriction , the functions @xmath90 also form a complete basis set on @xmath66 as @xmath105 . the accuracy can therefore be systematically improved in the electronic structure calculation .",
    "eq .   proposes a generalized eigenvalue problem . from numerical point of view",
    "it would be more efficient if we can choose @xmath90 such that the dg mass matrix is an identity matrix and that eq .",
    "becomes a standard eigenvalue problem .",
    "moreover , as @xmath106 increases , the basis functions @xmath90 can become degenerate or nearly degenerate , which increases the condition number . both problems can be solved at the same time by applying a singular value decomposition ( svd ) filtering step , resulting in an orthonormal basis set @xmath90 :    1 .   for each @xmath107",
    ", form a matrix @xmath108 with @xmath69 ; 2 .   calculate svd decomposition @xmath109 , @xmath110 where @xmath111 are singular values of @xmath112 ordered decreasingly in magnitude ; 3 .   for a threshold @xmath113 ,",
    "find @xmath114 such that @xmath115 and @xmath116 ( @xmath117 if all singular values are larger than the threshold ) .",
    "take @xmath118 be the @xmath119-th column of @xmath120 , @xmath121 ; 4 .",
    "set @xmath122 and @xmath123 for @xmath121 .",
    "although the threshold @xmath113 can avoid numerical degeneracy of the basis functions , the numerical degeneracy is not observed for the cases studied in section  [ sec : numer ] . in other words , we will take @xmath124 , @xmath125 .    after constructing the basis functions @xmath126",
    ", we then apply the discontinuous galerkin framework to solve @xmath127 and hence @xmath17 corresponding to @xmath36 .",
    "we summarize the overall algorithm as follows :    1 .",
    "set @xmath128 , let @xmath42 be a partition of @xmath40 into elements , and @xmath129 be an initial trial electron density ; 2 .",
    "form the effective potential @xmath130 $ ] and the effective hamiltonian @xmath22 $ ] ; 3 .   for each element @xmath93 ,",
    "calculate the eigenfunctions corresponding to the hamiltonian @xmath131 on the extended element @xmath95 , and obtain the orthonormal adaptive local basis functions @xmath90 ; 4 .   solve to obtain the coefficients @xmath132 for the kohn - sham orbitals and reconstruct the electron density @xmath28 by ; 5 .   mixing step :",
    "determine @xmath27 from @xmath24 and @xmath28 .",
    "if @xmath31 , stop ; otherwise , go to step @xmath133 with @xmath33 .",
    "we remark that due to the flexibility of the dg framework one can supplement the functions @xmath90 constructed above by other functions in @xmath66 , such as local polynomials in @xmath66 , gaussian functions restricted to @xmath66 , and other effective basis functions based on physical and chemical intuition . from practical point of view , we find that the adaptive basis set constructed above already achieves satisfactory performance .",
    "this section explains the implementation details for the above algorithm .",
    "specialists of the dg methods can skip this section and go directly to the numerical results in section  [ sec : numer ] .",
    "this section is mostly written for the readers who are less familiar with the dg implementation .",
    "the above algorithm involves three types of domains : the global domain @xmath40 , the extended elements @xmath134 , and the elements @xmath135 .",
    "quantities defined on these domains are discretized with different types of grids .    * on @xmath40",
    ", the quantities such as @xmath17 and @xmath136 are discretized with a uniform cartesian grid with a spacing fine enough to capture the singularities and oscillations in these quantities . *",
    "the grid on @xmath95 is simply the restriction of the uniform grid of @xmath40 on @xmath95 .",
    "this is due to the consideration that all quantities on @xmath95 are treated as periodic and hence a uniform grid is the natural choice . *",
    "the grid on @xmath66 is a three - dimensional cartesian legendre - gauss - lobatto ( lgl ) grid in order to accurately carry out the operations of the basis functions @xmath90 such as numerical integration and trace operator for each element @xmath66 .",
    "transferring various quantities between these three grids requires the following interpolation operators .",
    "* @xmath40 to @xmath95 .",
    "this is used when we restrict the density @xmath24 and the effective potential @xmath136 to the extended element @xmath95 . since the grid on @xmath95 is the restriction of the grid on @xmath40 , this interpolation operator simply copies the required values . *",
    "@xmath95 to @xmath66 .",
    "this is used when one restricts @xmath104 and their derivatives to @xmath66 .",
    "as the grid on @xmath95 is uniform , the interpolation is done by fourier transform . due to the fact that both grids are cartesian ,",
    "the interpolation can be carried out dimension by dimension , which greatly improves the efficiency . *",
    "@xmath66 to @xmath40 .",
    "this is used when one assembles the kohn - sham orbitals @xmath7 from the coefficients @xmath132 of the elements .",
    "the interpolation from the lgl grid to the uniform grid is done by lagrange interpolation , again carried out dimension by dimension .",
    "averaging is performed for the grid points of @xmath40 shared by multiple elements .",
    "the non - local pseudopotentials are used both in solving @xmath137 on each @xmath95 and in the numerical integration step on the lgl grid of each @xmath45 . in our implementation , the non - local pseudopotentials are directly generated in real space on @xmath97 and on @xmath45 without further interpolation between the grids .",
    "we use planewaves in each extended element @xmath95 to discretize the local effective hamiltonian @xmath101 and the lobpcg algorithm  @xcite with the preconditioner proposed in  @xcite to diagonalize the discretized hamiltonian .",
    "the resulting eigenfunctions @xmath138 of @xmath101 are restricted to @xmath66 and interpolated onto its lgl grid . within the svd filtering step ,",
    "the inner product that we adopt is the discrete weighted @xmath139 product with the lgl weights inside @xmath66 .",
    "the main advantage of the svd filtering step is that the discontinuous galerkin method results in a standard eigenvalue problem .",
    "the assembly of the dg stiffness matrix follows and consists of the following steps .",
    "* for the first term @xmath140 and the fifth term @xmath141 , their contributions are non - zero only when @xmath142 since otherwise two basis functions have disjoint support .",
    "hence , for each fixed @xmath107 , we compute @xmath143 and @xmath144 .",
    "the integration is done numerically using the lgl grid on @xmath66 .",
    "part of the stiffness matrix corresponding to these two terms clearly has a block diagonal form .",
    "* for the second , third , and fourth terms of , one needs to restrict basis functions and their derivatives to element faces .",
    "as the one - dimensional lgl grid contains the endpoints of its defining interval , this is done simply by restricting the values of the three - dimensional lgl grid to the element faces .",
    "one then calculates these three terms using numerical integration on these resulting two - dimensional lgl grids . since the integral is non - zero only when @xmath66 and @xmath145 are the same element or share a common face , part of the stiffness matrix corresponding to these three terms is again sparse . * the last term of is @xmath146 .",
    "the integration is again approximated using the lgl grids of the elements .",
    "notice that the contribution is non - zero iff @xmath147 and @xmath148 overlap with the support of a common @xmath149 . since each @xmath149 is localized around a fixed atom , @xmath148 and @xmath147",
    "need to be sufficiently close for this term to be non - zero . as a result ,",
    "part of the stiffness matrix corresponding to this last term is also sparse .    though the dg stiffness matrix @xmath80 is sparse , this property is not yet exploited in the current implementation .",
    "the eigenvalues and eigenvectors of the dg stiffness matrix are calculated using the routine of scalapack by treating it as a dense matrix .",
    "we plan to replace it with more sophisticated solvers that leverage the sparsity of @xmath80 in future .",
    "our algorithm is implemented fully in parallel for message - passing environment . to simplify the discussion , we assume that the number of processors is equal to the number of elements .",
    "it is then convenient to index the processors @xmath150 with the same index @xmath107 used for the elements . in the more general setting where the number of elements is larger than the number of processors , each processor takes a couple of elements and the following discussion",
    "will apply with only minor modification .",
    "each processor @xmath151 locally stores the basis functions @xmath152 for @xmath153 and the unknowns @xmath132 for @xmath154 and @xmath153 .",
    "we further partition the non - local pseudopotentials @xmath155 by assigning @xmath149 to the processor @xmath151 if and only if the atom associated to @xmath149 is located in the element @xmath66 .",
    "the eigenfunctions of the local hamiltonian @xmath131 are calculated on each processor @xmath151 . in order to build the local hamiltonian @xmath131 ,",
    "the processor @xmath151 needs to access all the non - local pseudopotentials of which the associated atoms are located in @xmath95 .",
    "this can be achieved by communication among @xmath66 and its nearby elements .",
    "once these pseudopotentials are available locally , the eigenfunctions of @xmath131 are computed in parallel without any extra communication between the processors .",
    "the parallel implementation of the dg solve is more complicated :    * for the calculation of the first and the fifth terms of the dg stiffness matrix @xmath80 in eq .",
    ", each processor @xmath151 performs numerical integration on @xmath66 . since the local basis functions @xmath152 are only non - zero on @xmath66 , this step",
    "is carried out fully in parallel . * to calculate the second , third , and fourth terms , each processor @xmath151 computes the surface integrals restricted to the _ left , front , _ and _ bottom _ faces of @xmath66 .",
    "this requires the basis functions of the left , front , and bottom neighboring elements . *",
    "to calculate the sixth term , each processor @xmath151 computes the parts associated with the non - local pseudopotentials @xmath155 located on @xmath151 .",
    "this requires the access to the basis functions of all elements that overlap with @xmath149 .    to summarize , each processor @xmath151 needs to access the basis functions from its neighboring elements and from the elements that overlap with the support set of the non - local pseudopotentials located on the elements associated with @xmath151 .",
    "due to the locality of the non - local pseudopotentials , these elements are geometrically close to @xmath151",
    ". since the size of the elements is generally equal to or larger than one unit cell , the support set of the non - local pseudopotentials are generally within the range of the neighboring elements",
    ". therefore , the number of the non - local basis functions required by @xmath151 is bounded by a small constant times the typical number of the basis functions in an element .",
    "the use of the routine of scalapack for solving the eigenvalue problem   results in another source of communication .",
    "scalapack requires @xmath80 to be stored in its block cyclic form and this form is quite different from the distribution in which the dg stiffness matrix is assembled ( as mentioned above ) . as a result , one needs to redistribute @xmath80 into this block cyclic form before calling and then redistribute the eigenfunctions afterwards .    in order to support these two sources of data communication , we have implemented a rather general communication framework that only requires the programmer to specify the desired non - local data .",
    "this framework then automatically fetches the data from the processors that store them locally .",
    "the actual communication is mostly done using asynchronous communication routines and .",
    "in order to illustrate how our method works in practice , we present numerical results for the ground state electronic structure calculation , using sodium ( na ) and silicon ( si ) as representative examples for metallic and insulating systems , respectively . we find that very high accuracy ( less than @xmath156 au per atom ) can be achieved by using only a small number of adaptive local basis functions . because of the small number of basis functions per atom , the dg scheme already exhibits significant speedup in computational time for a small system containing @xmath157 na atoms .",
    "we demonstrate that the current implementation is able to solve systems with thousands of atoms , and that the algorithm has a potential to be applied to much larger systems with a more advanced implementation .",
    "this section is organized as follows : section  [ subsec : setup ] introduces the setup of the test systems and how the error is quantified .",
    "section  [ subsec:1dperiodic ] applies the adaptive local basis functions to disordered quasi-1d sodium and silicon system , followed by the result for the disordered quasi-2d and bulk 3d systems in section  [ subsec:2d3d ] .",
    "we discuss the effect of the penalty parameter @xmath30 in section  [ subsec : penalty ] .",
    "finally we demonstrate the computational performance of our parallel implementation of the adaptive local basis functions in section  [ subsec : efficiency ] .",
    "we use the local density approximation ( lda )  @xcite for the exchange - correlation functional , and hartwigsen - goedecker - hutter ( hgh ) pseudopotential  @xcite with the local and non - local pseudopotential fully implemented in the real space  @xcite .",
    "all quantities are reported in atomic units ( au ) .",
    "all calculations are carried out on the hopper system maintained at national energy research scientific computing center ( nersc ) .",
    "each compute node on hopper has @xmath158 processors ( cores ) with @xmath159 gigabyte ( gb ) of memory ( 1.33 gb per core ) .",
    "the performance of the adaptive local basis functions are tested using na and si as representative examples for simple metallic and insulating systems , respectively .",
    "the crystalline na has a body centered cubic ( bcc ) unit cell , with 2 atoms per cell and a lattice constant of @xmath160  au .",
    "the crystalline si has a diamond cubic unit cell , with 8 atoms per cell and a lattice constant of @xmath161  au .",
    "each atomic configuration in the following tests is obtained by forming a supercell consisting @xmath162 unit cells with perfect crystal structure , and a random displacement uniformly distributed in @xmath163 $ ] au is then applied to each cartesian coordinate of each atom in the supercell .",
    "the resulting atomic configuration is therefore mildly disordered in order to avoid the possible cancellation of errors for the case of perfect crystalline systems .",
    "a system is called quasi-1d if @xmath164 , quasi-2d if @xmath165 , and 3d bulk if @xmath166 , respectively . in all the tests below",
    ", the element is chosen to be the ( conventional ) unit cell of the lattice .",
    "[ fig : na1dpartition ] shows how a quasi-1d na system with 8 atoms extended along the @xmath167 direction are partitioned in order to generate adaptive local basis functions .",
    "the global domain is partitioned into 4 elements @xmath168 with @xmath169 atoms per element .",
    "the red area represents one of the elements @xmath170 , and the corresponding extended element @xmath171 consists of both the red area and the blue area ( buffer ) .",
    "we recall that the buffer size along the @xmath99 direction refers to the length of the buffer area extended beyond the boundary of the element @xmath45 along the @xmath99 direction .",
    "the unit of buffer size is the lattice constant for the perfect crystalline system .",
    "[ fig : na1dpartition ] shows the case with the buffer size of @xmath172 along the @xmath167 direction , and @xmath173 along the @xmath174 and @xmath175 directions .",
    "we quantify the error of the adaptive local basis functions the error of the total energy per atom which is defined as follows .",
    "first , the electronic structure problem is solved by using planewaves on the global domain starting from a random initial guess of the electron wavefunctions .",
    "the total energy after reaching self - consistency is denoted by @xmath176 . then , the same electronic structure problem is solved by the dg formulation starting from a random initial guess of the adaptive local basis functions on each element . the total energy after reaching self - consistency is denoted by @xmath177 . the global domain calculation and the dg calculation using adaptive local basis functions are therefore completely independent , and the error of the total energy per atom",
    "is defined to be @xmath178 . for simplicity",
    "only @xmath41 point is used in the brillouin zone sampling .",
    "the proposed method can be easily generalized to @xmath107-point sampling .",
    "@xmath179 lobpcg iterations are used in each scf iteration for the global domain calculation , and @xmath180 lobpcg iterations are used in each scf iteration for generating the adaptive local basis functions in the dg calculation .",
    "a small number of lobpcg iterations is already sufficient , since the electron wavefunctions in the global domain calculation and the adaptive local basis functions in the dg calculations at the end of each scf iteration can be reused as the initial guess in the consequent scf iteration for continuous refinement .",
    "anderson mixing is used for the scf iteration with a fictitious electron temperature set to be @xmath181 k to facilitate the convergence of the scf iteration .",
    "the grid spacing for the global domain calculation is @xmath182 au for na and @xmath183 au for si .",
    "this translates to a grid of size @xmath184 to discretize one na unit cell and a grid of size @xmath185 to discretize one si unit cell .",
    "the legendre - gauss - lobatto ( lgl ) grid for each element is @xmath186 for na and @xmath187 for si .",
    "the lgl grid is only used for the purpose of numerical integration in the assembly process of the dg matrix .",
    "we remark that this grid is denser than what is commonly used for the electronic structure calculation for three reasons : 1 ) the hgh pseudopotential used in the present calculation is more stiff than many other pseudopotentials such as the troullier - martins pseudopotential  @xcite ; 2 ) the potentials and wavefunctions are represented in the real space rather than in the fourier space ; 3 ) most importantly , a dense grid in the real space is needed in both global domain calculations and dg calculations in order to reliably reflect the error of the total energy per atom .",
    "we remarked in the end of section  [ sec : basis ] that the dg framework is very flexible and can incorporate not only the adaptive local basis functions but also other basis functions such as local polynomials . in practice",
    "we find that the adaptive local basis functions are computationally more efficient than polynomials .",
    "therefore in the following discussion only adaptive local functions will be used in the basis set .",
    "the number of adaptive local functions per atom is also referred to as the degrees of freedom ( dof ) per atom .",
    "the error of the total energy per atom with respect to different buffer sizes and different numbers of basis functions per atom ( dof per atom ) is illustrated for the disordered quasi-1d sodium system in fig .",
    "[ fig : nasienrich ] ( a ) and for the disordered quasi-1d silicon system in fig .",
    "[ fig : nasienrich ] ( b ) .",
    "the penalty parameter @xmath30 is @xmath188 . in both cases ,",
    "the error decreases systematically when the buffer size and the number of basis functions per atom increase . for na ,",
    "the error of the total energy per atom is already below @xmath189 au using as few as @xmath190 basis functions per atom with a small buffer of size @xmath172 ( black diamond with solid line ) .",
    "when the buffer size is increased to @xmath191 ( blue star with dashed line ) , the error of the total energy per atom is @xmath192 au or @xmath193 mev using @xmath179 adaptive local basis functions per atom .",
    "similar behavior is found for the silicon system . for a small",
    "buffer of size @xmath172 ( black diamond with solid line ) , the error of the total energy per atom is @xmath194 au with @xmath195 basis functions per atom . for the buffer of size @xmath191 ( blue star with dashed line ) ,",
    "the error of the total energy per atom is @xmath196 au or @xmath197 mev using as few as @xmath198 basis functions per atom .",
    "physical intuition suggests that the minimum number of basis functions is @xmath190 , which reflects one @xmath199 and three @xmath200 atomic orbitals .",
    "@xmath201 number of basis functions per atom is generally required to achieve good accuracy if gaussian type orbitals or numerical atomic orbitals are to be used  @xcite .",
    "therefore for the quasi-1d systems tested here , our algorithm achieves nearly the optimal performance in terms of the number of basis functions per atom .",
    "the behavior of the error found above depends weakly on the number of atoms of the quasi-1d system extended along the @xmath167 direction .",
    "the error of the total energy per atom for disordered quasi-1d systems of different numbers of atoms is shown for na in fig .",
    "[ fig : nasi_1dlong ] ( a ) and for si in fig .",
    "[ fig : nasi_1dlong ] ( b ) , respectively . in both cases",
    "the buffer size is @xmath172 , and the penalty parameter is @xmath188 . here",
    "@xmath190 and @xmath195 adaptive local basis functions per atom are used for na and si , respectively .",
    "this section studies the relation between the error of the total energy per atom and the dimensionality of the system .",
    "the partition of the domain for systems of higher dimension is similar to that in the quasi-1d case .",
    "[ fig : na2dpartition ] shows the partition of a quasi-2d system with @xmath159 sodium atoms , viewed along the @xmath174 direction .",
    "the domain is partitioned into @xmath202 disjoint elements .",
    "the length of each element ( red area ) is equal to the length of the lattice constant of the crystalline unit cell .",
    "the corresponding extended element for solving the adaptive local basis functions includes both the element ( red area ) and the buffer ( blue area ) .",
    "[ fig : na_2d3d ] ( a ) shows the behavior of the error for a disordered quasi-2d sodium system containing @xmath159 atoms with the buffer of size @xmath172 ( black diamond with solid line ) and of size @xmath191 ( blue star with dashed line ) , respectively . for the case with the buffer size equal to @xmath172 , the error of the total energy per atom is @xmath203 au using @xmath198 basis functions per atom .",
    "the error of the total energy per atom can reach @xmath204 au with @xmath202 basis functions per atom and buffer size @xmath191 .",
    "[ fig : na_2d3d ] ( b ) shows the behavior of the error for a disordered bulk 3d sodium system containing @xmath157 atoms with the buffer of size @xmath172 ( black diamond with solid line ) and of size @xmath191 ( blue star with dashed line ) , respectively . for the case with the buffer size equal to @xmath172 ,",
    "the error of the total energy per atom is @xmath205 au using @xmath158 basis functions per atom .",
    "the error of the total energy per atom can reach @xmath206 au or @xmath207 mev with @xmath208 basis functions per atom and buffer size @xmath191 . compared to the quasi-1d case , the number of adaptive local basis functions per atom increases significantly in order to reach the same accuracy .",
    "the increasing number of basis functions is partly due to the increasing number of na atoms in the extended element . in this case , the numbers of the na atoms in the extended element with a buffer size of @xmath191 are @xmath209 for quasi-1d , quasi-2d and bulk 3d systems , respectively .",
    "the increased number of na atoms in the extended elements requires more eigenfunctions in the extended elements , and therefore more adaptive local basis functions per atom in the elements .",
    "the interior penalty formulation of the discontinuous galerkin method contains an important parameter @xmath30 to guarantee stability .",
    "@xmath210 has been applied uniformly to all the examples studied so far .",
    "the @xmath30-dependence of the error of the total energy per atom is shown for the quasi-1d sodium system in fig .",
    "[ fig : nasi_alpha ] ( a ) and for the quasi-1d silicon system in fig .",
    "[ fig : nasi_alpha ] ( b ) , respectively . for na ,",
    "the buffer size is @xmath191 , and the number of basis functions per atom is @xmath198 .",
    "the error of the total energy per atom is empirically proportional to @xmath211 up to @xmath212 . for si ,",
    "the buffer size is @xmath191 , and the number of basis functions per atom is @xmath195 .",
    "the error of the total energy per atom is empirically proportional to @xmath213 up to @xmath212 .",
    "we also remark that the dg formulation can become unstable for @xmath30 smaller than a certain threshold value .",
    "for example , the error of the total energy per atom is @xmath214 au for na with @xmath215 , and the error of the total energy per atom is @xmath216 au for si with @xmath217 .",
    "therefore the penalty parameter @xmath30 plays an important role in the stability of the algorithm , but the dg scheme can be accurate and stable with respect to a large range of @xmath30 values .",
    "the small number of the adaptive basis functions per atom can lead to significant savings of the computational time .",
    "we illustrate the efficiency of our algorithm using a disordered bulk 3d sodium system with the buffer size of @xmath191 and with @xmath202 basis functions per atom .",
    "[ fig : na_2d3d ] ( b ) suggests that the error of the total energy per atom is about @xmath189 au for this choice of the parameters .",
    "the size of each element is equal to the lattice constant with @xmath169 na atoms in each element .",
    "the size of the global domain @xmath40 ranges from @xmath218 unit cells with @xmath157 na atoms to @xmath219 elements with @xmath220 atoms .",
    "the number of processors ( cores ) used is proportional to the number of elements , and @xmath221 processors are used in the problem with @xmath219 elements .",
    "we compare the wall clock time for one step self consistent iteration with @xmath180 lobpcg iterations for solving the adaptive basis functions in the extended elements .",
    "[ fig : na3dtime ] compares the wall clock time for solving the dg eigenvalue problem using scalapack function ( red triangle with solid line ) , the time for generating the adaptive local basis functions in the extended elements using lobpcg solver ( blue diamond with dashed line ) , and the time for the overhead in the dg calculation ( black circle with dot dashed line ) .",
    "the buffer size is @xmath191 , and the number of basis functions per atom is @xmath202 .",
    "since both the size of the extended elements and the number of basis functions per atom are fixed , the computational time for solving the adaptive basis functions does not depend on the global domain size .",
    "the overhead in the dg calculation method includes mainly the assembly process of the dg hamiltonian matrix via numerical integration and data communication .",
    "all numerical integrations are localized inside each element and its neighboring elements .",
    "our implementation ensures that the data communication is restricted to be within nearest neighboring elements .",
    "therefore the time for the overhead increases mildly with respect to the global system size . the complexity of the dg eigensolver using scales cubically with respect to global system size in the asymptotic limit , and starts to dominate the cost of computational time for system containing more than @xmath222 atoms . since the number of processors is proportional to the number of elements , the asymptotic wall clock time for the dg eigensolver should scales quadratically with respect to the number of atoms .",
    "the practical wall clock time for solving the dg eigensolver is found to be proportional to @xmath223 ( magenta dashed line in fig .",
    "[ fig : na3dtime ] ) , indicating that the asymptotic cubic scaling has not yet been reached . in the largest example with @xmath220 atoms , the matrix size of the dg hamiltonian matrix is @xmath224 .",
    "the efficiency due to the dimension reduction of the adaptive basis functions can be illustrated by the comparison between the cost of the computational time of the lobpcg eigensolver in the global domain calculation ( global ) , and that of the dg eigenvalue problem with the adaptive basis functions ( dg ) , as reported in table  [ tab : ctime ] .",
    "the global domain calculation uses @xmath179 lobpcg iteration steps per scf iteration . on a single processor ,",
    "the global domain calculation costs @xmath225 sec for the bulk 3d sodium system with @xmath157 atoms , and @xmath226 sec for the bulk 3d sodium system with @xmath227 atoms . by assuming that the global domain calculation can be ideally parallelized , the third column of table  [ tab : ctime ] reports the computational time of the global domain calculation measured on a single processor divided by the number of processors used in the corresponding dg eigensolver .",
    "the fourth column reports the wall clock time for the dg eigensolver executed in parallel .",
    "we remark that the computational time for solving the adaptive local basis functions is not taken into account , since we are comparing the savings of the computational time due to the dimension reduction of the basis functions .",
    "it is found that the saving of the computational time is already significant even when the system size is relatively small .",
    ".the comparison of the cost of the wall clock time using the lobpcg iteration on the global domain ( performed with a single processor and divide the time by the number of processors in column @xmath169 , assuming that the lobpcg are perfectly parallelized ) and the wall clock time using the adaptive local basis functions ( only count the dg eigenvalue solver using scalapack with the number of processors in column @xmath169 ) .",
    "the systems under study are the bulk 3d sodium system with @xmath218 elements ( @xmath157 na atoms ) , and with @xmath228 elements ( @xmath227 na atoms ) , respectively . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]",
    "in this paper we proposed the adaptive local basis functions for discretizing the kohn - sham hamiltonian operator , and demonstrated that the adaptive local basis functions are efficient for calculating the total energy and electron density , and can reach high accuracy with a very small number of basis functions per atom .",
    "the adaptive local basis functions are discontinuous in the global domain , and the continuous kohn - sham orbitals and electron density are reconstructed from these discontinuous basis functions using the discontinuous galerkin ( dg ) framework . the environmental effect is automatically built into the basis functions , thanks to the flexibility provided by the dg framework .",
    "the current implementation of the dg method is already able to perform the total energy calculation for systems consisting of thousands of atoms .",
    "the performance of the dg method can be improved by taking into account the block sparsity of the dg stiffness matrix .",
    "furthermore , the local nature of the adaptive basis functions allows us to incorporate the recently developed pole expansion and selected inversion type fast algorithms  @xcite into the dg framework .",
    "the capability of the resulting algorithm is expected to be greatly enhanced compared to the current implementation .",
    "this is our ongoing work .    in order to generalize the current framework to the force calculation and further to the geometry optimization and the _ ab initio _ molecular dynamics simulation , the adaptive local basis functions and their derivatives with respect to the positions of the atoms ( called pulay force  @xcite )",
    "should be both accessible .",
    "recently we propose the optimized local basis functions  @xcite that is able to systematically control the magnitude of the pulay force , which is a further improvement of the adaptive local basis functions .",
    "this is also our ongoing work .",
    "this work is partially supported by doe under contract no .",
    "de - fg02 - 03er25587 and by onr under contract no .",
    "n00014 - 01 - 1 - 0674 ( w.  e and l.  l. ) , and by a sloan research fellowship and by nsf career grant dms-0846501 ( l.  y. ) .",
    "we thank the national energy research scientific computing center ( nersc ) , and the texas advanced computing center ( tacc ) for the support to perform the calculations .",
    "l.  l. and j.  l. thank the university of texas at austin for the hospitality where the idea of this paper starts .",
    "direction , viewed along the @xmath174 direction .",
    "the length of each empty box is equal to the lattice constant for the perfect na crystal .",
    "the red area represents one of the elements @xmath170 .",
    "the corresponding extended element @xmath229 consists of both the red area and the blue area ( buffer ) .",
    "the buffer size is @xmath172 ( in the unit of lattice constant ) along the @xmath167 direction , and is @xmath173 along the @xmath174 and @xmath175 directions .",
    ", scaledwidth=70.0% ]     and the @xmath167 directions , viewed along the @xmath174 direction .",
    "the red area represents one of the elements @xmath230 , and the corresponding extended element @xmath231 consists of both the red area and the blue area ( buffer ) .",
    "the buffer size is @xmath172 ( in the unit of lattice constant ) along the @xmath175 and the @xmath167 directions , and is @xmath173 along the @xmath174 direction.,scaledwidth=60.0% ]     axis ) for solving disordered bulk 3d sodium systems of different sizes ( @xmath174 axis ) with one step self - consistent field iteration .",
    "the number of processors is chosen to be proportional to the number of atoms , with @xmath221 processors used for the largest problem solved here ( @xmath220 na atoms ) .",
    "the total wall clock time is broken down into the time for solving the dg eigenvalue problem using scalapack function ( red triangle with solid line ) , the time for generating the adaptive local basis functions in the extended elements using lobpcg solver ( blue diamond with dashed line ) , and the time for the overhead in the dg calculation , including the matrix assembly and data communication ( black circle with dot dashed line ) .",
    "the buffer size is @xmath191 , and the number of basis functions per atom is @xmath202 .",
    "the scaling of the wall clock time for solving the dg eigenvalue problem using with respect to the number of atoms is illustrated by the magenta dashed line.,scaledwidth=60.0% ]                                                      b.  cockburn , g.  karniadakis , c .- w .",
    "shu , discontinuous galerkin methods : theory , computation and applications , vol .",
    "11 of lecture notes in computational science and engineering , springer - verlag , berlin , 2000 .",
    "y.  maday , a.  patera , g.  turinici , global a priori convergence theory for reduced - basis approximations of single - parameter symmetric coercive elliptic partial differential equations , c. r. acad .",
    "paris , ser .",
    "i 335 ( 2002 ) 289294 .",
    "e.  cancs , c.  le  bris , y.  maday , n.  nguyen , a.  patera , g.  pau , feasibility and competitiveness of a reduced basis approach for rapid electronic structure calculations in quantum chemistry , in : high - dimensional partial differential equations in science and engineering , vol .",
    "41 of crm proc .",
    "lecture notes , amer .",
    "soc . , providence , ri , 2007 , pp .",
    "1547 .",
    "m.  payne , m.  teter , d.  allan , t.  arias , j.  joannopoulos , iterative minimization techniques for ab initio total - energy calculations : molecular dynamics and conjugate gradients , rev .",
    "64 ( 1992 ) 10451097 .",
    "l.  genovese , a.  neelov , s.  goedecker , t.  deutsch , s.  ghasemi , a.  willand , d.  caliste , o.  zilberberg , m.  rayson , a.  bergman , r.  schneider , daubechies wavelets as a basis set for density functional pseudopotential calculations , j. chem .",
    "( 2008 ) 014109 .",
    "l.  lin , j.  lu , l.  ying , r.  car , w.  e , fast algorithm for extracting the diagonal of the inverse matrix with application to the electronic structure analysis of metallic systems , commun .",
    "7 ( 2009 ) 755777 .",
    "l.  lin , c.  yang , j.  lu , l.  ying , w.  e , a fast parallel algorithm for selected inversion of structured sparse matrices with application to 2d electronic structure calculations , siam j. sci .",
    "33 ( 2011 ) 1329 ."
  ],
  "abstract_text": [
    "<S> kohn - sham density functional theory is one of the most widely used electronic structure theories . in the pseudopotential framework </S>",
    "<S> , uniform discretization of the kohn - sham hamiltonian generally results in a large number of basis functions per atom in order to resolve the rapid oscillations of the kohn - sham orbitals around the nuclei . </S>",
    "<S> previous attempts to reduce the number of basis functions per atom include the usage of atomic orbitals and similar objects , but the atomic orbitals generally require fine tuning in order to reach high accuracy . </S>",
    "<S> we present a novel discretization scheme that adaptively and systematically builds the rapid oscillations of the kohn - sham orbitals around the nuclei as well as environmental effects into the basis functions . </S>",
    "<S> the resulting basis functions are localized in the real space , and are discontinuous in the global domain . </S>",
    "<S> the continuous kohn - sham orbitals and the electron density are evaluated from the discontinuous basis functions using the discontinuous galerkin ( dg ) framework . </S>",
    "<S> our method is implemented in parallel and the current implementation is able to handle systems with at least thousands of atoms . </S>",
    "<S> numerical examples indicate that our method can reach very high accuracy ( less than @xmath0mev ) with a very small number ( @xmath1 ) of basis functions per atom </S>",
    "<S> .    electronic structure , kohn - sham density functional theory , discontinuous galerkin , adaptive local basis set , enrichment functions , eigenvalue problem    71.15.ap , 31.15.e- , 02.70.dh    65f15 , 65z05 </S>"
  ]
}