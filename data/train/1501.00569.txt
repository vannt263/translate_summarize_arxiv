{
  "article_text": [
    "a central problem in the theory of formal languages is to characterize and understand the expressive power of high level specification formalisms .",
    "monadic second order logic ( mso ) is such a formalism , which is both expressive and robust . for several classes of structures , such as words or trees , it has the same expressive power as finite automata and defines the class of regular languages . in this paper",
    ", we investigate fragments of mso over words . in this context , understanding the expressive power of a fragment is associated to two decision problems : the _ membership problem _ and the _ separation problem_.    for a fixed logical fragment @xmath1 , the",
    "_ @xmath1-membership problem _ asks for a decision procedure that tests whether some input regular language can be expressed by a formula from  @xmath1 . to obtain such an algorithm , one has to consider and understand _ all _ properties that can be expressed within @xmath1 , which requires a deep understanding of the fragment @xmath1 .",
    "on the other hand , the _ @xmath1-separation problem _ is more general .",
    "it asks for a decision procedure that tests whether given _ two _ input regular languages , there exists a third one in @xmath1containing the first language while being disjoint from the second one .",
    "since regular languages are closed under complement , membership reduces to separation : a language is in @xmath1if and only if it can be separated from its complement .",
    "usually , the separation problem is more difficult than the membership problem but also more rewarding with respect to the knowledge gained on the investigated fragment @xmath1 .",
    "these two problems have been considered and solved for many natural fragments of monadic second order logic . among these ,",
    "the most prominent one is first - order logic , @xmath2 , equipped with a predicate @xmath3 for the linear ordering .",
    "the solution to the membership problem , known as the mcnaughton - papert - schtzenberger theorem  @xcite , has been revisited until recently  .",
    "the theorem states that a regular language is definable in @xmath2if and only if its _",
    "syntactic semigroup _ is aperiodic .",
    "the syntactic semigroup is a finite algebraic object that can be computed from any regular language . since aperiodicity can be defined as an equation that needs to be satisfied by all of its elements , this yields decidability of @xmath2-definability .",
    "this result now serves as a template , which is commonly followed in this line of research .",
    "the separation problem has also been successfully solved for first - order logic  @xcite .",
    "actually , the problem was first addressed in a purely algebraic framework , and was later identified as equivalent to our separation problem  @xcite . as for membership ,",
    "this problem is still revisited today and a new self - contained and combinatorial proof was obtained in  @xcite .",
    "* motivation*.    we are interested in natural fragments of @xmath2obtained by restricting either the number of variables or the number of quantifier alternations allowed in formulas . such restrictions in general give rise to several variants of the same fragment .",
    "indeed , in most cases , the drop in expressive power forbids the use of natural relations that could be defined from the linear order in @xmath2 .",
    "the main example considered in this paper is @xmath4 , the _ successor relation _ , together with predicates @xmath5 and @xmath6 for the first and last positions in a word .",
    "this means that one can define two distinct variants of the same fragment depending on whether we decide to explicitly add these predicates in the signature or not .",
    "an example is the fragment @xmath7 , which consists of first - order formulas whose prenex normal form has at most  @xmath8 quantifier alternations and starts with an existential block . since defining  @xmath4 requires an additional quantifier alternation , @xmath9 has indeed stronger expressiveness than @xmath10 .",
    "the motivation of this paper is to obtain decidability results for such enriched fragments .",
    "* state of the art*.    even when the weak fragment is known to have decidable membership , proving that the enriched one has the same property can be nontrivial .",
    "examples include the membership proofs of @xmath11 ( boolean combinations of @xmath12 formulas ) and @xmath13 , which require difficult and intricate combinatorial arguments  @xcite or a wealth of algebraic machinery  @xcite .",
    "another issue is that most proofs directly deal with the enriched fragment . given the jungle of such logical fragments , it is desirable to avoid such an approach , treating each variant of the same fragment independently . instead , a satisfying approach is to first obtain a solution of the membership and separation problems for the less expressive variant and then to lift it to other variants via a generic transfer result .",
    "this approach has first been investigated by straubing for the membership problem  @xcite in an algebraic framework , and later adapted to be able to treat classes not closed under complement  @xcite .",
    "transferring the logical problem to this algebraic framework requires preliminary steps , still _",
    "specific _ to the investigated class , to prove that :    1 .",
    "[ item:1 ] a language is definable in the fragment if and only if its syntactic semigroup belongs to a specific algebraic variety @xmath14 ( _ e.g. _ , the variety of aperiodic monoids for  @xmath2 ) , and 2 .",
    "[ item:2 ] membership to  @xmath15 is decidable .    next , though this is not immediate , for most fragments of @xmath2 , it has been proved that    1 .",
    "[ item:3 ] when the weaker variant corresponds to a variety v , the variant with successor corresponds to the variety @xmath16 , built generically from v.    hence , straubing s approach was to prove that    1 .",
    "[ item:4 ] the operator @xmath17 preserves decidability .    unfortunately , this is not true in general  @xcite .",
    "actually , while decidability is preserved for all known logical fragments , there is no generic result that captures them all . in particular , for the less expressive fragments , one has to use completely _ ad hoc _ proofs . in the separation setting , things behave well : it has been shown that decidability of separation is preserved by the operation @xmath18  @xcite .",
    "while interesting when already starting from algebra , this approach has several downsides :    * dealing with algebra hides the logical intuitions , while our primary goal is to understand the expressiveness of logics . *",
    "going from logic to algebra requires to be acquainted with new notions and vocabulary , as well as involved theoretical tools .",
    "proofs are also often nontrivial and require a deep understanding of complex objects , which may be scattered in the bibliography . * despite step [ item:4 ] , which is generic to some extent , arguments specific to the investigated class are pushed to steps [ item:1][item:3 ] , and they are often nontrivial .    * contributions*.    we give a new proof that decidability of separation can be transferred from a weak to an enriched fragment .",
    "we present the result in two different forms .",
    "the first one is non - algebraic : we work directly with the logical fragments , without using varieties .",
    "the transfer result is generic and its proof mostly is : the only specific argument is an ehrenfeucht - frassgame that can be adapted to all natural fragments with minimal difficulty .",
    "the benefits of this new proof are that :    1 .",
    "it is self - contained and much simpler than previous ones .",
    "it only relies on two basic well - known notions : recognizability by semigroups and ehrenfeucht - frass  games .",
    "it works with classes that are not closed under complement , contrary to  @xcite .",
    "this allows us to capture the @xmath19 and @xmath20 levels in the quantifier alternation hierarchy of first - order logic .",
    "3 .   under an additional hypothesis on the logical fragment , which is met for most fragments we investigate and",
    "easy to check , the decidability result of the separation problem also extends to the membership problem .",
    "4 .   the proof adapts smoothly to infinite words using the notion of @xmath21-semigroups .",
    "the second form of our result is algebraic and generic .",
    "we prove that @xmath22 preserves the decidability of separation for varieties , hence giving an elementary proof of a result of  @xcite . even in this algebraic form ,",
    "we completely bypass involved constructions or notions , such as pointlike sets for categories developed in  @xcite , thus making the proof  accessible .    as corollaries ,",
    "since @xmath23 and @xmath24 both enjoy decidable separation  @xcite , we obtain that this is also the case for the fragments @xmath11 and @xmath25 , known as levels 1 and 3/2 of the dot - depth hierarchy .",
    "these new results strengthen the previous ones  @xcite that showed decidability of membership and were considered as difficult .",
    "we actually obtain that separation for @xmath9 reduces to separation for  @xmath10 . since we also transfer decidability of the membership problem , and since the fragments @xmath26 of boolean combinations of @xmath24 formulas and @xmath27 have decidable membership  @xcite we deduce that the same holds for @xmath28 and @xmath29 , known as levels 2 and 5/2 of the dot - depth hierarchy .",
    "* organization of the paper*.    in section  [ sec : prelims ] , we set up the notation and we present the separation problem and the logics we deal with . in section  [ sec : contrib - overview ] , we present an overview of our main contribution .",
    "section  [ sec : wfwords ] is devoted to our technical tool : languages of well - formed words . in section  [ sec : special ] , we use it to prove our transfer result for all fragments from the logical perspective . in section",
    "[ sec : algebra ] , we establish that decidability of the separation problem for the variety @xmath30entails the same for @xmath31 . in order to instantiate this result for concrete logical fragments , thus obtaining an alternate proof of our transfer result , we rely on algebraic properties from the bibliography for each fragment and its enrichment : they are presented in section  [ sec : algebraic - charac ] .",
    "this paper is the full version of  @xcite .",
    "in this section , we provide preliminary definitions on regular languages defined by logical fragments and on separation .",
    "* words , languages*.    we fix a finite alphabet @xmath32 .",
    "let @xmath33 be the set of all nonempty finite words and let @xmath34 be the set of all finite words over @xmath32 . if @xmath35 are words , we denote by @xmath36 or by @xmath37 the word obtained by concatenating @xmath38 and @xmath39 . for convenience ,",
    "we only consider , without loss of generality , languages that do not contain the empty word .",
    "that is , a language is a subset of  @xmath33 .",
    "we work with regular languages , that is , languages definable by finite  automata .",
    "* separation*.    given three languages @xmath40 , we say that @xmath41 _ separates _",
    "@xmath42 from @xmath43 if @xmath44 if @xmath0is a class of languages , we say that @xmath42 is _",
    "@xmath0-separable _ from @xmath43 if there exists @xmath45 that separates @xmath42 from @xmath43 .",
    "note that if @xmath0is closed under complement , @xmath42 is @xmath0-separable from @xmath43 if and only if @xmath43 is @xmath0-separable from @xmath42 .",
    "however , this is not true for a class @xmath0not closed under complement , such as the classes @xmath10 of the quantifier alternation hierarchy , which we shall  consider .    given a class @xmath0 , the _ @xmath0-separation problem _ asks for an algorithm which , given as input two regular languages @xmath46 , decides whether @xmath42 is @xmath0-separable from  @xmath43 . the @xmath0-membership problem , which asks whether an input regular language belongs to @xmath0 , reduces to the @xmath0-separation problem , as a regular language belongs to @xmath0iff  it is @xmath0-separable from its  complement .",
    "* logics*.    we investigate several fragments of first - order logic on finite words .",
    "we view a finite word as a logical structure made of a sequence of positions labeled over @xmath32 .",
    "we work with first - order logic @xmath2using a unary predicate @xmath47 for each @xmath48 , which selects positions labeled with an @xmath49 , as well as binary predicates ` @xmath50 ' for equality and ` @xmath3 ' for the linear order .",
    "such a formula defines the regular language of all words that satisfy it",
    ". we will freely use the name of a logical fragment of @xmath2to denote the class of languages definable in this fragment .",
    "observe that @xmath2is powerful enough to express the following logical relations :    * first position , @xmath51:@xmath52 .",
    "* last position , @xmath53:@xmath54 .",
    "* successor , @xmath55:@xmath56 .",
    "however , for most fragments of @xmath2this is not the case .",
    "for example , in the two - variables restriction @xmath57of @xmath2 , it is not possible to express successor , as it requires quantifying over a third variable . for these fragments",
    "@xmath58 , adding the predicates @xmath5 , @xmath6 and @xmath4 yields a strictly more powerful logic @xmath59 .",
    "our goal is to prove a transfer result for such fragments : given a fragment , if the separation problem is decidable for the weak variant  @xmath58 , then it is decidable as well for the strong variant @xmath59 obtained by enriching @xmath58 with the above relations .",
    "the technique is _ generic _ , meaning that it is not bound to a particular logic .",
    "in particular , our transfer result applies to the following well - known logical fragments :    * @xmath60 , the restriction of @xmath2 in which the linear order can not be used , and only equality between two positions can be tested . the enriched fragment @xmath61",
    "( @xmath5 and @xmath6 can be eliminated from the formulas ) defines locally threshold testable languages  @xcite . *",
    "all levels in the quantifier alternation hierarchy of first - order logic .",
    "a first - order formula is @xmath10 ( resp .",
    "@xmath62 ) if its prenex normal form contains at most @xmath8 quantifier alternations and starts with an @xmath63 ( resp .",
    "a  @xmath64 ) quantifier block . finally , a @xmath65 formula is a boolean combination of @xmath10 and @xmath62 formulas .",
    "+ since for all fragments above @xmath66 , a formula involving @xmath5 and @xmath6 can be expressed without these predicates in the same logic , we shall denote the enriched fragments by 1 , , and then by @xmath67 ,  * @xmath57 , the restriction of @xmath2using only two reusable variables .",
    "the corresponding enriched fragment is @xmath68 , since @xmath5 and @xmath6 can again be eliminated from the formulas .",
    "[ fig : frag ] summarizes all fragments the technique applies to .    [ cols=\"^,^,^,^,^\",options=\"header \" , ]",
    "in this short section , we explain our main contribution . we prove the following  result .",
    "[ thm : transfer ] let @xmath1and @xmath59 be respectively the weak and strong variants of one of the logical fragments in  [ fig : frag ] .",
    "then @xmath69-separability can be effectively reduced to @xmath58-separability .",
    "we actually establish two versions of this theorem :    * the first form , theorem  [ thm : sdo ] , is obtained by purely logical means .",
    "it is not entirely generic , since one of the directions of the reduction proof relies on ehrenfeucht - frassgames adapted to the fragment under consideration . on the other hand",
    ", it has the advantage of having a direct , self - contained and elementary proof , built on a constructive reduction : from two regular languages , we effectively build two new regular languages , and we exhibit an @xmath59 separator for the original languages from an @xmath58 separator for the new  ones . * the second form , theorem  [ thm : main ] , is based on algebraic tools .",
    "the transfer result in this statement is presented on classes of finite ordered monoids or semigroups associated to the weak and enriched fragments respectively , through eilenberg s correspondence .",
    "it has the advantage of being completely generic : no hypothesis on the algebraic class is assumed .",
    "even if this approach requires some vocabulary and machinery from algebra , its presentation is still much simpler than the previous one  @xcite .",
    "an issue however is that , in order to apply this theorem to a specific fragment , one has to find beforehand which algebraic classes correspond to the weak and enriched fragments . in other terms",
    ", the statement indeed isolates a generic transfer property , but it relies on specific correspondences in order to be instantiated on a given fragment .",
    "fortunately , the correspondences we need for treating all classes of  [ fig : frag ] have already been established .",
    "they will be recalled in section  [ sec : algebraic - charac ] .",
    "all logical fragments from  [ fig : frag ] have a rich history and have been extensively studied in the literature .",
    "in particular , the separation problem is known to be decidable for the following fragments : @xmath60 , @xmath57 , 1 , 1 , 2  @xcite .",
    "this means that , from our results , we obtain decidability of separation for @xmath70 , , 1 , 1 and @xmath71 .    note that for @xmath70 , @xmath68and @xmath11 , the results could already be obtained as corollaries of algebraic theorems of steinberg  @xcite and almeida  @xcite . as explained above , an issue with this approach",
    "is that the proof of steinberg s result relies on deep algebraic arguments and is _ a priori _ not tailored to separation : the connection with separation is made by almeida  @xcite .    for 1 and @xmath71 , the result is new , as steinberg s result does not apply to classes of languages that are not closed under complement .",
    "in this section , we define the main tools used for the logical approach in this paper .",
    "* we first recall the well - known semigroup based definition of regular languages : a language is regular if and only if it can be recognized by a finite semigroup . * our second tool , _ well - formed words _ , is specific to our problem and plays a key role in our transfer result .",
    "it is presented in section  [ sec : well - formed - words ] .",
    "the tools specific to the algebraic approach are postponed to section   [ sec : tools - algebr - appr ] .",
    "we work with the algebraic representation of regular languages . here",
    "we briefly recall the main definitions .",
    "we refer the reader to  @xcite for additional details .",
    "* semigroups*.    a _ semigroup _ is a set @xmath72 equipped with an associative product , written @xmath73 or @xmath74 .",
    "monoid _ is a semigroup @xmath72 having a neutral element @xmath75 , _",
    "i.e. _ , such that @xmath76 for all @xmath77 .",
    "if @xmath72 is a semigroup , then @xmath78 denotes the monoid @xmath79 where @xmath80 is a new element , acting as neutral element .",
    "note that we add such a new identity even if @xmath72 is already a  monoid .",
    "a semigroup morphism is a mapping @xmath81 from one semigroup to another which respects the algebraic structure : for all @xmath82 , we have @xmath83 . for a monoid morphism",
    ", we require additionally @xmath72 and @xmath84 to be monoids and @xmath85 .    an element @xmath86 is _ idempotent _ if @xmath87 .",
    "we denote by @xmath88 the set of idempotents of  @xmath72 .",
    "semigroup @xmath72 , it is folklore and easy to see that there is an integer @xmath89 ( denoted by @xmath21 when @xmath72 is understood ) such that for all @xmath90 of @xmath72 , @xmath91 is idempotent :  @xmath92 .",
    "note that @xmath33 and @xmath93 equipped with concatenation are respectively a semigroup and a monoid called the _",
    "free semigroup over @xmath32 _ and the _ free monoid over @xmath32_. let @xmath94 be a language and @xmath72 be a semigroup ( resp .  a monoid ) .",
    "we say that @xmath42 is",
    "_ recognized by @xmath72 _ if there exist a morphism @xmath95 ( resp .",
    "@xmath96 ) and a set @xmath97 such that  @xmath98 .    *",
    "semigroups and separation*.    the separation problem takes as input two regular languages @xmath46 .",
    "it is convenient to work with a single object recognizing both of them , rather than having to deal with two .",
    "let @xmath99 be semigroups recognizing @xmath46 together with the associated morphisms @xmath100 , respectively .",
    "clearly , @xmath42 and @xmath43 are both recognized by @xmath101 with the morphism @xmath102 mapping @xmath103 to @xmath104 . from now on ,",
    "we work with such a single semigroup recognizing both languages . replacing @xmath105 with its image under @xmath106",
    ", one can also assume that this morphism is surjective . to sum up",
    ", we assume from now on , without loss of generality , that @xmath42 and @xmath43 are recognized by a single surjective morphism .      in this section ,",
    "we define our main tool for this paper .",
    "assume that @xmath1is the weak variant of one of the logical fragments of  [ fig : frag ] and let @xmath59 be the corresponding enriched variant . to any semigroup morphism @xmath107 into a finite semigroup @xmath72 , we associate a new alphabet  @xmath108 called the alphabet of _ well - formed words_. the main intuition behind this notion is that the @xmath59-separation problem for any two regular languages recognized by @xmath109 can be reduced to the @xmath1-separation problem for two regular languages over @xmath108 .",
    "the alphabet @xmath110 , called _ alphabet of well - formed words of @xmath109 _ , is defined from @xmath107 by : @xmath111 we will not be interested in all words of @xmath112 , but only in those that are well - formed .",
    "a word @xmath113 is said to be _ well - formed _ if one of the following two properties holds :    * @xmath114is a single letter @xmath77 , * @xmath114has length @xmath115 and is of the form @xmath116 with @xmath117 for all @xmath118 .",
    "[ fct : reg ] the set of well - formed words of @xmath112 is a regular language .",
    "we now define a morphism @xmath119 as follows . if @xmath77 , we set @xmath120 , if @xmath121 , we set @xmath122 , if @xmath123 , we set @xmath124 and if @xmath125 , we set @xmath126 .    * associated language of well - formed words*.    to any language @xmath94 that is recognized by a morphism @xmath127 into a finite semigroup  @xmath72 , one associates a language of well - formed words @xmath128 : @xmath129 by definition , the language @xmath128 is the intersection of the language of well - formed words with @xmath130 . therefore , it is immediate by fact  [ fct : reg ] that it is regular , more precisely :    [ fct : reg2 ] let @xmath94 be a language recognized by a morphism @xmath109 into a finite semigroup",
    ". then , the associated language of well - formed words @xmath128 is a regular language that one can effectively compute from a recognizer of  @xmath42 .",
    "in this section , we prove theorem  [ thm : transfer ] from a logical perspective . we begin with presenting our _ separation _ theorem , which will entail the _ membership _ theorem as a simple consequence .",
    "[ thm : sdo ] let @xmath1and @xmath59 be respectively the weak and strong variants of one of the logical fragments in  [ fig : frag ] .",
    "let @xmath46 be two languages recognized by a morphism @xmath131 into a finite semigroup  @xmath72 .",
    "let @xmath132 be the languages of well - formed words associated with @xmath46 , respectively .",
    "then @xmath42 is @xmath59-separable from @xmath43 iff @xmath133 is @xmath58-separable from @xmath134 .",
    "theorem  [ thm : sdo ] reduces @xmath59-separation to @xmath1-separation .",
    "the latter was already known to be decidable for several weak variants in  [ fig : frag ] , namely for @xmath60  @xcite , @xmath57  @xcite , @xmath135  @xcite , @xmath23  @xcite and @xmath66  @xcite .",
    "hence , we get the following corollary .",
    "[ cor : sdp ] let @xmath46 be regular languages",
    ". then the following problems are decidable :    * whether @xmath42 is @xmath70-separable from @xmath43 . *",
    "whether @xmath42 is @xmath68-separable from @xmath43 . * whether @xmath42 is @xmath12-separable from @xmath43 .",
    "* whether @xmath42 is @xmath11-separable from @xmath43 . * whether @xmath42 is @xmath71-separable from @xmath43 .",
    "notice that since the membership problem reduces to the separation problem , this also gives a new proof that all these fragments have a decidable membership problem .",
    "this is of particular interest for @xmath136 , @xmath11 and @xmath71for which the previous proofs , which can be found in , or derived from  @xcite , @xcite , and @xcite respectively , are known to be quite involved .",
    "it turns out that for @xmath71 , we can do even better and entirely avoid separation . indeed , when @xmath1is expressive enough , theorem  [ thm : sdo ] can be used to prove a similar theorem for the membership  problem .",
    "[ thm : memb ] let @xmath1and @xmath59 be respectively the weak and strong variants of one of the logical fragments in  [ fig : frag ] .",
    "moreover , assume that for any alphabet of well - formed words , the set of well - formed words over this alphabet is definable in @xmath1 .",
    "let @xmath42 be a language recognized by a morphism @xmath95 into a finite semigroup  @xmath72 .",
    "let @xmath137 be the language of well - formed words associated with @xmath42 .",
    "then @xmath42 is definable in @xmath59 iff @xmath133 is definable in @xmath58 .",
    "set @xmath138 and let @xmath139be the associated language of well - formed words .",
    "observe that by definition , @xmath140 is the set of all well - formed words .",
    "if @xmath133 is definable in @xmath58 , then @xmath133 is @xmath58-separable from @xmath139 , hence by theorem  [ thm : sdo ] , @xmath42 is @xmath59-separable from @xmath41 , and so @xmath42 is definable in @xmath59 .",
    "conversely , if @xmath42 is definable in @xmath59 , then @xmath42 is @xmath59-separable from @xmath41 and by theorem  [ thm : sdo ] , @xmath141is @xmath58-separable from @xmath139 .",
    "since @xmath140 is the set of all well - formed words , @xmath141is the intersection of the separator with the set of all well - formed words , which by hypothesis is also definable in @xmath1 . therefore ,",
    "@xmath141is definable in  @xmath1 .",
    "observe that being well - formed can be expressed in @xmath142 : essentially , a word is well - formed if for all pairs of positions , either there is a third one in - between , or the labels of the two positions are `` compatible '' .",
    "hence , among the fragments of  [ fig : frag ] , theorem  [ thm : memb ] applies to all fragments including and above @xmath142 in the quantifier alternation hierarchy .",
    "while such a transfer result was previously known  @xcite , the presentation and the proof are new . in particular , since membership is known to be decidable for @xmath142  @xcite , @xmath143  @xcite and @xmath144  @xcite , we obtain new and simpler proofs of the following results .",
    "[ cor : memb ] given a regular language @xmath42 , one can decide whether    * @xmath42 is definable by a @xmath71(resp . by a @xmath145 )",
    "* @xmath42 is definable by a @xmath146formula .",
    "* @xmath42 is definable by a @xmath147(resp . by a @xmath148 )",
    "formula .",
    "it remains to prove theorem  [ thm : sdo ] .",
    "we devote the rest of the section to this proof .",
    "an important remark is that the proof of the right to left direction , presented in section  [ sec : from - fod - to - fodp ] , is constructive : we start with an @xmath58 formula that separates @xmath133 from @xmath134 and use it to construct an @xmath59 formula that separates @xmath42 from @xmath43 .",
    "note that the argument is generic for all fragments we consider",
    ".    on the other hand , the converse direction to which section  [ sec : from - fodp - to - fod ] is devoted , namely proposition  [ prop : corr ] below , requires a specific argument tailored to each fragment : a straightforward but tedious ehrenfeucht - frassargument .",
    "we now prove that if @xmath133 is @xmath58-separable from @xmath134 , then @xmath42 is @xmath59-separable from  @xmath43 .",
    "we do so by building an @xmath59-definable separator .",
    "this proof is constructive and entirely generic .",
    "we rely on a construction that associates to any word @xmath149 a canonical well - formed word @xmath150 .    *",
    "canonical well - formed word associated to a word*.    to any word @xmath103 of @xmath33 , we associate a canonical well - formed word @xmath151 such that @xmath152 .",
    "this construction is adapted from  @xcite and is originally inspired by @xcite .",
    "fix an arbitrary order on the set @xmath88 . for a position @xmath153 of @xmath103 ,",
    "let @xmath154 be the infix of @xmath103 obtained by keeping only positions @xmath155 to @xmath153 .",
    "if position @xmath155 does not exist , @xmath156 is just the prefix of @xmath103 ending at @xmath153 .",
    "a position @xmath153 is said _ distinguished _ if there exists an idempotent @xmath157 such that @xmath158 .",
    "additionally , we always define the rightmost position as distinguished , even if it does not satisfy the property . set @xmath159 as the distinguished  positions in  @xmath103 , so that @xmath160 is the rightmost position .",
    "let @xmath161 be such that for all @xmath162 , @xmath163 is the smallest idempotent such that @xmath164 .    if @xmath165 , _ i.e. _ , if the only distinguished position is the rightmost one , set @xmath166 . otherwise , we define @xmath151 as the word : @xmath167 where @xmath168 is the prefix of @xmath103 ending at position @xmath169 , for all @xmath170 , @xmath171 is the infix of @xmath103 obtained by keeping positions @xmath172 to @xmath173 , and @xmath174 is the suffix of @xmath103 starting at position @xmath175 .",
    "note that by construction , @xmath176 is well - formed .",
    "the next statement follows from the definition of @xmath177 , and from the fact that by definition of the words @xmath171 and of the chosen idempotents , we have @xmath178 .",
    "[ fct : sametype ] for all @xmath149 , we have @xmath152 .",
    "therefore , @xmath179 iff @xmath180 and @xmath181 iff @xmath182 .    to any distinguished position @xmath183 in @xmath103 , we now associate the position @xmath184 in @xmath176 .",
    "our main motivation for using this construction is its local canonicity , which is stated in the following lemma .",
    "[ lem : canonic ] let @xmath149 .",
    "then we have the following properties :    1 .   [ item:5 ] whether a position @xmath153 is distinguished in  @xmath103 , and if so the label of position @xmath185 in @xmath176 only depends on the infix of  @xmath103 of length @xmath186 ending at position @xmath153 .",
    "that is , if the infixes of length @xmath186 ending at @xmath153 and @xmath187 are equal , then @xmath153 is distinguished iff so is @xmath187 , and in that case , the labels of @xmath185 and @xmath188 in @xmath176 are equal .",
    "the label of the last position of @xmath189 only depends on the suffix of length @xmath186 of @xmath103 .",
    "it is immediate that whether @xmath153 is distinguished and if so the associated idempotent only depends on the infix @xmath156 of length at most @xmath190 ending at @xmath153 .",
    "therefore , to prove  [ item:5 ] , it suffices to show that all infixes @xmath171 used in   are of size at most @xmath190 , or in other words , that among @xmath191 consecutive positions , at least one is distinguished .",
    "so let us consider an infix @xmath192 of @xmath103 of length @xmath191 .",
    "it is immediate from the pigeonhole principle that there exist @xmath193 such that @xmath194 .",
    "hence , the position corresponding to @xmath195 is distinguished .",
    "the proof of the second assertion is similar .",
    "* @xmath42 is @xmath59-separable from @xmath43 .",
    "* we can now construct our separator .",
    "the construction follows from the next proposition .",
    "[ prop : comp ] let @xmath196 that can be defined using an @xmath58 formula @xmath197",
    ". then there exists an @xmath59 formula @xmath198 over alphabet @xmath32 such that for every word @xmath149 : @xmath199    proposition  [ prop : comp ] follows from the following simple consequence of lemma  [ lem : canonic ] .",
    "[ clm : canonic ] for any @xmath200 there exists a formula @xmath201 of @xmath59 with a free variable  @xmath153 , such that for any @xmath202 and any position @xmath153 of @xmath103 , we have @xmath203 iff @xmath153 is distinguished and @xmath185 has label @xmath204 in @xmath176 .",
    "this claim holds since by lemma  [ lem : canonic ] , formula @xmath201 only needs to explore the neighborhood of size @xmath186 of @xmath153 , which is trivially possible for all fragments @xmath59 we consider . to conclude the proof of proposition  [ prop : comp ] , it suffices to define @xmath198 as the formula constructed from @xmath197 by restricting all quantifiers to positions that are distinguished and to replace all tests @xmath205 by  @xmath201 .",
    "we can now finish the proof of theorem  [ thm : sdo ] .",
    "assume that @xmath133 is @xmath58-separable from @xmath134 and let @xmath197 be an @xmath58 formula defining a separator .",
    "we denote by @xmath198 the @xmath59 formula obtained from @xmath197 as defined in proposition  [ prop : comp ] .",
    "we prove that @xmath198 defines a language separating @xmath42 from @xmath43 .",
    "we first prove that @xmath206 .",
    "assume that @xmath207 .",
    "then by fact  [ fct : sametype ] , we have @xmath208 .",
    "hence , @xmath209 and so @xmath210 by definition of @xmath198 .",
    "the proof that @xmath211 is identical : if @xmath212 , we have @xmath213 by fact  [ fct : sametype ] .",
    "hence , @xmath214 and @xmath215 by definition of @xmath198 .      to complete the proof of theorem  [ thm : sdo ] , it remains to prove that if @xmath42 is @xmath59-separable from @xmath43 , then @xmath133 is @xmath58-separable from @xmath134 .",
    "the proof is this time specific to each fragment , as it requires , in one direction of the reduction , a dedicated ( but simple ) ehrenfeucht - frassargument .",
    "we actually prove the contrapositive : if @xmath133 is _ not _",
    "@xmath58-separable from @xmath134 , then @xmath42 is _ not _",
    "@xmath59-separable from  @xmath43 .",
    "we rely on a construction that is dual to the one used previously : to any well - formed word @xmath216 and any integer @xmath217 , we associate a canonical word @xmath218 .    * canonical word associated to a well - formed word*.    to any @xmath219 , we associate an arbitrarily chosen nonempty word @xmath220 such that @xmath221 ( which is possible since @xmath109 has been chosen surjective )",
    ". let @xmath217 . from a well - formed word @xmath216 , we build a word @xmath218 as follows .",
    "if @xmath222 , then @xmath223 for all @xmath224 . otherwise , we have by definition @xmath225 for a natural @xmath226 , we set @xmath227 recall that @xmath177 is the morphism @xmath228 mapping @xmath229 to @xmath230 .",
    "since @xmath231 for all @xmath232 , it is immediate that @xmath233 , hence we get the following fact :    [ fct : cons1 ] for all @xmath226 and all well - formed @xmath216 , we have @xmath234 ( resp .",
    "@xmath235 ) if and only if @xmath236 ( resp @xmath237 ) .",
    "we now proceed with the proof .",
    "we use the classical preorders associated to fragments of first - order logic .",
    "the _ ( quantifier ) rank _ @xmath238 of a first - order formula @xmath197 is the largest number of quantifiers along a branch in the parse tree of  @xmath197 .",
    "formally , @xmath239 if @xmath197 is an atomic formula , @xmath240 , @xmath241 and @xmath242 .    given @xmath243",
    ", we write @xmath244 if any @xmath59 formula of rank @xmath245 that is satisfied by @xmath38 is satisfied by @xmath39 as well . similarly , for @xmath246 , we write @xmath247 if any @xmath58 formula of rank @xmath245 that is satisfied by @xmath229 is satisfied by @xmath248 as well .",
    "one can verify that @xmath249 and @xmath250 are preorders , as well as the following standard fact : @xmath251 note that when @xmath58 and @xmath59 are closed under complement , then @xmath249 and @xmath250 are actually equivalence relations .",
    "we can now state the main proposition of this direction .",
    "[ prop : corr ] for any @xmath252 , there exist @xmath253 and @xmath254 such that for any well - formed words @xmath255 satisfying @xmath256 , we have @xmath257 .    before proving proposition  [",
    "prop : corr ] , we explain how to use it to show the first direction of theorem  [ thm : sdo ] .",
    "we argue by contrapositive : assume that @xmath133 is _ not _",
    "@xmath58-separable from @xmath134 . by definition",
    "this means that no language definable in @xmath1separates @xmath141from @xmath134 .",
    "in particular , for any @xmath258 , the language @xmath259 which is definable in @xmath58 by  , can not be a separator .",
    "note that this language contains @xmath141 .",
    "hence , for all @xmath253 , there exist @xmath260 and @xmath261 such that @xmath256 .",
    "we deduce from proposition  [ prop : corr ] and fact  [ fct : cons1 ] that for all @xmath262 , there exist @xmath263 and @xmath264 such that @xmath265",
    ". it follows , again by  , that @xmath42 is _ not _",
    "@xmath59-separable from @xmath43 , which concludes the  proof .",
    "we now prove proposition  [ prop : corr ] for fragments we are interested in .",
    "as already explained , this proposition is proved using classical , but specific ehrenfeucht - frassarguments for each fragment .",
    "while each proof is specific , the underlying ideas are similar .    here , we consider two main cases , @xmath266 and @xmath267 for some @xmath268 .",
    "note that we will obtain the case @xmath269 as a simple consequence of the case @xmath270 .",
    "finally , we leave out the case @xmath271 , as the argument is essentially a copy and paste of the argument for @xmath272 .      observe that since @xmath57and @xmath68are both closed under complement , the preorders @xmath249 and @xmath250 are actually equivalence relations . to avoid confusion with other fragments ,",
    "we denote by @xmath273and @xmath274 , these two equivalences .",
    "we prove the following proposition , which clearly entails proposition  [ prop : corr ] .",
    "[ prop : fodcor ] for any @xmath252 , given @xmath255 we have the following implication : @xmath275    this is proved using an ehrenfeucht - frassargument .",
    "we first define the ehrenfeucht - frassgame associated to @xmath276 ( _ i.e. , _ corresponding to @xmath273 ) and then explain how to adapt it to @xmath277 .",
    "* game*.    the board of the @xmath276-game consists of two words and lasts a predefined number @xmath245 of rounds .",
    "there are two players called _ spoiler and duplicator_. at any time during the game there is one pebble placed on a position of one word and one pebble placed on a position of the other word , and both positions have the same label .",
    "when the game starts , both pebbles are placed on the first position of each words .",
    "each round starts with spoiler choosing one of the pebbles , and moving it inside its word from its original position @xmath153 to a new position @xmath187 .",
    "duplicator must answer by moving the other pebble in the other word from its original position @xmath278 to a new position @xmath279 .",
    "moreover , @xmath278 and @xmath279 must satisfy the same relations as @xmath153 and @xmath187 among @xmath3 and the label predicates .",
    "duplicator wins if she manages to play for all @xmath245 rounds .",
    "spoiler wins as soon as duplicator is unable to play .    the @xmath68-game is defined similarly with additional constraints for duplicator .",
    "when spoiler makes a move , duplicator must choose her answer @xmath279 so that @xmath278 and @xmath279 satisfy the same relations as @xmath153 and @xmath187 among @xmath4 , @xmath3 and the label predicates .",
    "[ lem : efgame ] for any integer @xmath245 and any words @xmath280 , we have the following facts :    * @xmath281 iff duplicator has a winning strategy in the @xmath245-round @xmath57-game on @xmath39 and @xmath282 .",
    "* @xmath283 iff duplicator has a winning strategy in the @xmath245-round @xmath68-game on @xmath39 and  @xmath282 .    to prove proposition  [ prop : fodcor ] , let @xmath284 , and set @xmath285 and @xmath286 .",
    "we want to show that @xmath287 . in view of lemma",
    "[ lem : efgame ] , it is enough to prove to exhibit a winning strategy for duplicator in the @xmath245-round @xmath68-game played on @xmath38 and @xmath288 .",
    "we call @xmath289this game .",
    "the strategy involves playing a shadow @xmath57-game @xmath290 on @xmath291and @xmath292 .",
    "observe that by hypothesis and by lemma  [ lem : efgame ] , duplicator has a winning strategy for @xmath245 rounds in the game @xmath293 .",
    "we begin by setting up some notation to help us define duplicator s strategy in @xmath294 .    * notation*.    assuming that @xmath295 , we need to prove that @xmath287 .",
    "if @xmath296 or @xmath297 , then @xmath298 ( since the only well - formed word that contains letter @xmath77 is @xmath90 itself ) and the result is immediate .    otherwise , by hypothesis , the words @xmath229 and @xmath292 are of the form @xmath299 in particular , observe that since @xmath295 and the labels of the leftmost and rightmost positions occur only at these positions in @xmath229 and @xmath292 , we have @xmath300 and @xmath301 . for the sake of simplifying the presentation , we assume that for all @xmath302 , we have @xmath303 and @xmath304 ( this does not harm the generality of the proof ) .",
    "similarly , for all @xmath305 , we assume that @xmath306 and @xmath307 . by definition , we have @xmath308 to treat the beginning and the end of the words uniformly as the other factors , we set @xmath309 as the empty word .",
    "* winning strategy*.    let @xmath258 be the number of remaining rounds at some point in the game .",
    "we define an invariant @xmath310 that duplicator has to satisfy when playing .",
    "assume that the pebbles in @xmath311 are at positions @xmath312 in @xmath289and that the pebbles in @xmath313 are at positions @xmath314 in @xmath293 .",
    "then , @xmath310 holds when so do all following properties :    1 .",
    "[ item:6 ] duplicator has a winning strategy for playing @xmath258 rounds in @xmath293 .",
    "in particular , this means that @xmath314 have the same label , and therefore that @xmath315 .",
    "[ item:7 ] pebbles @xmath153 and @xmath278 are inside the identical factors @xmath316 and @xmath317 , and at the same relative position .",
    "[ item:8 ] there are at least @xmath258 copies of @xmath318 ( resp @xmath319 ) to the left of @xmath153 ( resp .",
    "@xmath278 ) and @xmath258 copies of @xmath320 ( resp .",
    "@xmath321 ) to the right of @xmath153 ( resp .",
    "@xmath278 ) .",
    "it is clear that @xmath322 holds at the beginning of the game .",
    "moreover , since duplicator will follow her strategy in @xmath293 , item  [ item:6 ] will be fulfilled .",
    "assume now that @xmath323 holds and that there are @xmath324 rounds left to play .",
    "we explain how duplicator can answer a move by spoiler while enforcing @xmath310 .",
    "assume that spoiler moves the pebble in @xmath38 to a new position  @xmath187 ( the dual case , when spoiler plays in @xmath288 , is treated similarly ) .",
    "there are two distinct cases .    *",
    "if @xmath187 remains in the factor @xmath316 and satisfies item  [ item:8 ] of @xmath310 , then duplicator simply copies spoiler s move in @xmath317 .",
    "the positions @xmath224 and @xmath325 remain unchanged and @xmath310 is clearly satisfied . * otherwise , observe that by @xmath323 , spoiler s move @xmath187 can not be equal to @xmath326 .",
    "this means that duplicator has to answer in the same direction and on the same label as spoiler did , but not on positions @xmath327 .",
    "because item  [ item:8 ] is not satisfied , position @xmath187 belongs to some @xmath328 with @xmath329 , with at least @xmath258 copies of @xmath330 to its left and @xmath258 copies of @xmath331 to its right . to compute her answer",
    ", duplicator simulates a move by spoiler in  @xmath293 by moving the pebble from position @xmath224 to position @xmath232 . from her winning strategy in  @xmath293 , she obtains a position @xmath332 in @xmath292 such that @xmath333 .",
    "she picks as position @xmath279 the same relative position in @xmath334 as @xmath187 in @xmath328 .",
    "observe that since @xmath329 , we have @xmath335 . hence , this is a legal move for duplicator . the new positions @xmath336 satisfy @xmath310 , which terminates the proof .",
    "we fix some @xmath337 .",
    "we keep using the symbols @xmath249 and @xmath250 to denote the preorders associated to @xmath10 and @xmath9 .",
    "furthermore , we denote by @xmath338 and @xmath339 the equivalence relations associated to @xmath65 and @xmath340 .",
    "we prove the following proposition , which again yields proposition  [ prop : corr ] with @xmath341 and @xmath342 .",
    "[ prop : sicor ] for any @xmath252 , given @xmath255 we have the following implications : @xmath343      { \\ensuremath{{{\\mbox{\\usefont{u}{bbm}{m}{n}u}}}}\\xspace}{{\\ensuremath{\\cong_{k}}\\xspace}}{\\ensuremath{{{\\mbox{\\usefont{u}{bbm}{m}{n}u}}}}\\xspace } ' & \\rightarrow & { \\ensuremath{\\left\\lceil { \\ensuremath{{{\\mbox{\\usefont{u}{bbm}{m}{n}u}}}}\\xspace}\\right\\rceil}\\xspace}_{2^{k+1 } } { { \\ensuremath{\\cong^{+1}_{k}}\\xspace}}{\\ensuremath{\\left\\lceil { \\ensuremath{{{\\mbox{\\usefont{u}{bbm}{m}{n}u}}}}\\xspace } ' \\right\\rceil}\\xspace}_{2^{k+1}}.    \\end{array}\\ ] ]    observe first that the second implication is an immediate consequence of the first one .",
    "indeed , since @xmath344 formulas are boolean combinations of @xmath345 formulas , we have @xmath346    v { { \\ensuremath{\\preccurlyeq^{+1}_{k}}\\xspace}}v ' \\text { and } v ' { { \\ensuremath{\\preccurlyeq^{+1}_{k}}\\xspace}}v & \\text{if and only if } & v { { \\ensuremath{\\cong^{+1}_{k}}\\xspace}}v ' . \\end{array}\\ ] ] therefore , we concentrate on the first implication . as for @xmath57 , this an ehrenfeucht - frassargument .",
    "we first define the ehrenfeucht - frassgame associated to @xmath10 ( _ i.e. , _ corresponding to @xmath347 ) and then explain how to adapt it to @xmath250 .",
    "* game*.    the board of the @xmath10-game consists of two words @xmath280 and there are two players , again called _ spoiler and duplicator_. moreover , initially , there exists a distinguished word among @xmath280 that we call the _ active word _ ( this word may change as the game progresses ) .",
    "the game is set to last a predefined number @xmath245 of rounds .",
    "when the game starts , both players have @xmath245 pebbles .",
    "contrary to the @xmath57-game , once a pebble is dropped , it can not be moved again during the game .",
    "finally , there is a parameter that gets updated during the game , a counter @xmath348 called the _",
    "alternation counter_. initially , @xmath348 is set to @xmath349",
    ". it may be incremented , but it has to remain bounded by @xmath350 .    at the start of each round @xmath258 , spoiler chooses a word , either @xmath39 or @xmath282 .",
    "spoiler can always choose the active word , in which case both @xmath348 and the active word remain unchanged .",
    "however , spoiler can only choose the word that is not active when @xmath351 , in which case the active word is switched and @xmath348 is incremented by @xmath352 ( in particular , this may happen at most @xmath350 times ) . if spoiler chooses @xmath39 ( resp .",
    "@xmath282 ) , he puts a pebble on a position @xmath353 in @xmath39 ( resp .",
    "@xmath354 in  @xmath282 ) .",
    "duplicator must answer by putting a pebble at a position @xmath354 in @xmath282 ( resp .",
    "@xmath353 in @xmath39 ) .",
    "moreover , duplicator must ensure that all pebbles that have been placed up to this point verify the following condition : for all @xmath355 , the labels at positions @xmath356 are the same , and @xmath357 if and only if @xmath358 .",
    "duplicator wins if she manages to play for all @xmath245 rounds , and spoiler wins as soon as duplicator is unable to play .",
    "the @xmath359-game is defined similarly with the following additional constraint for duplicator : at any time , for all @xmath360 , we have @xmath361 if and only if @xmath362 , @xmath363 if and only if @xmath364 and @xmath365 if and only if @xmath366 .    [ lem : efgame2 ] for all @xmath252 and @xmath280 , we have the following facts :    * @xmath367 iff duplicator has a winning strategy in the @xmath245-round @xmath272-game on @xmath39 and @xmath282 with @xmath39 as initial active word . *",
    "@xmath368 iff duplicator has a winning strategy in the @xmath245-round @xmath359-game on @xmath39 and  @xmath282 with @xmath39 as initial active word .",
    "we now prove proposition  [ prop : sicor ] .",
    "let @xmath284 .",
    "we have to prove that @xmath369 . in view of lemma  [ lem : efgame2 ] , this can be done by giving a winning strategy for duplicator in the corresponding @xmath245-round @xmath359-game .",
    "we call @xmath289this game . duplicator s strategy involves playing a @xmath272-game @xmath293 , called the shadow game , on @xmath291and @xmath292 . by hypothesis and by lemma  [ lem : efgame2 ]",
    ", she has a winning strategy in @xmath245 rounds in the shadow game @xmath293 .",
    "we begin by setting up some notation that will help us define duplicator s strategy .    *",
    "notation*.    set @xmath370 and @xmath371 .",
    "assuming that @xmath372 , we need to prove that @xmath265 . if @xmath296 or @xmath297 , then @xmath298 ( again , the only well - formed word that contains the letter @xmath77 is @xmath90 ) .",
    "therefore , @xmath373 and the result is immediate .    otherwise , by hypothesis , the words @xmath229 and @xmath292 are of the form @xmath374 in particular , observe that since @xmath372 and the labels of the leftmost and rightmost positions occur only at these positions in @xmath229 and @xmath292 , we have @xmath300 and @xmath301 . for the sake of simplifying the presentation , we assume that for all @xmath302 , we have @xmath303 and @xmath304 ( this does not harm the generality of the proof ) .",
    "similarly , for all @xmath305 , we assume that @xmath306 and @xmath307 . by definition , we have @xmath375 again , to treat the beginning and the end of the words uniformly as the other factors , we set @xmath309 as the empty word .    *",
    "winning strategy*.    let @xmath258 be the number of remaining rounds at some point in the game .",
    "we define an invariant @xmath310 that duplicator has to satisfy when playing .",
    "as she plays , duplicator associates to each position @xmath376 , ( resp .",
    "@xmath377 ) a set of positions in @xmath38 ( resp .",
    "@xmath288 ) called the set of _ marked positions _ for @xmath224 ( resp .  for @xmath325 ) .",
    "all marked positions for @xmath224 ( resp .  for @xmath325 )",
    "must belong to the @xmath378 , @xmath195 or @xmath320 ( resp .",
    "@xmath319 , @xmath379 or @xmath380 ) positions in @xmath38 ( resp .  in  @xmath288 ) .",
    "initially , for all @xmath224 ( resp .",
    "@xmath325 ) , only @xmath195 ( resp .",
    "@xmath379 ) is marked for @xmath224 ( resp .  for @xmath325 ) .",
    "duplicator may define more positions as marked as the game progresses .",
    "all these new marked positions will be positions holding pebbles in @xmath289 .",
    "assume that there are @xmath258 rounds left to play and that pebbles have already been placed on @xmath311 in the main game @xmath289and on @xmath313 in @xmath293 in a way that satisfies the conditions of both ehrenfeucht - frassgames .",
    "we denote by @xmath381 the alternation counter of the main game @xmath289and by @xmath382 that of the shadow game @xmath290 . for all @xmath376 ( resp .",
    "@xmath377 ) we denote by @xmath383 ( resp .",
    "@xmath384 ) the marked positions for @xmath224 ( resp .",
    "@xmath325 ) .",
    "then @xmath310 holds if the following properties hold :    1 .",
    "[ item:9 ] duplicator has a winning strategy for playing at least @xmath258 more rounds in @xmath293 .",
    "furthermore , either @xmath385 , or @xmath386 and the active words in @xmath293and @xmath289are either @xmath229 and @xmath38 , or @xmath292 and  @xmath288 .",
    "2 .   [ item:10 ] any position @xmath387 ( resp .",
    "@xmath388 ) that holds a pebble in @xmath289 is marked for some @xmath376 ( resp .",
    "@xmath377 ) holding a pebble in @xmath293 .",
    "conversely , any position that is marked for @xmath389 , ( resp .",
    "@xmath377 ) is either @xmath195 ( resp .",
    "@xmath379 ) or a position holding a pebble in @xmath289 .",
    "[ item:11 ] for all @xmath376 ( resp .",
    "@xmath377 ) , we have @xmath390 ( resp .",
    "@xmath391 ) . moreover , there are at least @xmath392 copies of @xmath320 ( resp .",
    "@xmath321 ) that are strictly between these two positions . 4 .   [ item:12 ] let @xmath314 be positions of @xmath313 on which there are corresponding pebbles in @xmath293(meaning that one position corresponds to a move of spoiler and the other one is duplicator s answer ) . observe that since @xmath314 have the same label , we have @xmath393 , @xmath394 and @xmath395 . in that case , the number of marked positions for @xmath224 is the same as the number of marked positions for @xmath325 , that is @xmath396 .",
    "furthermore , for all @xmath397 : * @xmath398 is the @xmath393 position of @xmath38 iff @xmath399 is the @xmath393 position of @xmath288 , and * @xmath398 holds a pebble of @xmath289iff @xmath399 holds the corresponding pebble .",
    "+ finally , given @xmath400 , let @xmath401 and @xmath402 be the number of positions that are strictly between @xmath398 and @xmath403 ( resp .  between @xmath399 and @xmath404 ) . note that by the condition above these positions are all labeled by @xmath405 , or all labeled by @xmath406 .",
    "we require that either @xmath407 , or @xmath408 and @xmath409 .",
    "\\(u ) at ( -2,0 ) @xmath288 ; ( cu ) at ( -2,-1.5 ) @xmath292 ; ( uend ) at ( 15,0 ) ; ( cuend ) at ( 15,-1.5 ) ; ( ca1 ) at ( 0,-1.5 ) ; ( ca7 ) at ( 14,-1.5 ) ;    = [ draw , thin , circle , inner sep=1pt , radius=3pt , minimum size=.2cm , fill = black!50 ] ; ( a1 ) at ( 0,0 ) ; ( a2 ) at ( 6,0 ) ; ( a3 ) at ( 7.2,0 ) ; ( a4 ) at ( 10,0 ) ;    ( b1 ) at ( 6,-1.5 ) ;    = [ above=-3pt ] ; at ( a1.north ) @xmath410 ; at ( a2.north ) @xmath411 ; at ( a3.north ) @xmath412 ; at ( a4.north ) @xmath413 ; = [ below=-2pt ] ; at ( @xmath414 ) @xmath415 ;    ( b1 ) to ( a1 ) ; ( b1 ) to ( a2 ) ; ( b1 ) to ( a3 ) ; ( b1 ) to ( a4 ) ;    ( a1 ) to ( a2 ) to ( a3 ) to ( a4 ) to ( @xmath416 ) ; ( u ) to ( a1 ) ; ( a4 ) to ( uend ) ;    ( @xmath417 ) to ( b1 ) to ( @xmath418 ) ; ( @xmath419 ) to ( a1 ) ; ( cu ) to ( ca1 ) ; ( ca7 ) to ( cuend ) ; = [ ] ;    \\(u ) at ( -2,0 ) @xmath38 ; ( cu ) at ( -2,1.5 ) @xmath229 ; ( uend ) at ( 15,0 ) ; ( cuend ) at ( 15,1.5 ) ; ( ca1 ) at ( 0,1.5 ) ; ( ca7 ) at ( 14,1.5 ) ;    = [ draw , thin , circle , inner sep=1pt , radius=3pt , minimum size=2mm , fill = black!50 ] ; ( a1 ) at ( 0,0 ) ; ( a2 ) at ( 3,0 ) ; ( a3 ) at ( 4.2,0 ) ; ( a4 ) at ( 7,0 ) ;    ( a5 ) at ( 10.2,0 ) ; ( a6 ) at ( 12,0 ) ; ( a7 ) at ( 14,0 ) ;    ( b1 ) at ( 3,1.5 ) ; ( b2 ) at ( 12,1.5 ) ;    = [ below=-2pt ] ; at ( a1.south ) @xmath420 ; at ( a2.south ) @xmath421 ; at ( a3.south ) @xmath422 ; at ( a4.south ) @xmath423 ;    at ( a5.south ) @xmath424 ; at ( a6.south ) @xmath425 ; at ( a7.south ) @xmath426 ;    = [ above=-3pt ] ; at ( b1.north ) @xmath427 ; at ( b2.north ) @xmath428 ;    ( b1 ) to ( a1 ) ; ( b1 ) to ( a2 ) ; ( b1 ) to ( a3 ) ; ( b1 ) to ( a4 ) ;    ( b2 ) to ( a5 ) ; ( b2 ) to ( a6 ) ; ( b2 ) to ( a7 ) ;    ( a1 ) to ( a2 ) to ( a3 ) to ( a4 ) to ( a5 ) to ( a6 ) to ( a7 ) to ( @xmath429 ) ; ( u ) to ( a1 ) ; ( a7 ) to ( uend ) ;    ( @xmath417 ) to ( b1 ) to ( b2 ) to ( @xmath418 ) ; ( @xmath419 ) to ( a1 ) ; ( cu ) to ( ca1 ) ; ( ca7 ) to ( cuend ) ; ( @xmath430 )  ( @xmath431 ) ; ( @xmath432 )  ( @xmath433 ) ; at ( @xmath434 ) @xmath435 ; at ( @xmath436 ) @xmath437 ; = [ ] ;    [ fig : marked ] shows positions @xmath224 and @xmath438 in @xmath229 and  @xmath325 in @xmath292 corresponding to @xmath224 in the @xmath293-game , as well as marked positions for @xmath224 and @xmath438 in  @xmath38 ( resp .  for @xmath325 in  @xmath288 ) .",
    "greyed positions are the ones holding a pebble .",
    "note that by item  [ item:10 ] , all marked positions in @xmath38 ( resp .",
    "@xmath288 ) except possibly some @xmath195 ( resp .",
    "@xmath439 ) positions have to hold a pebble .",
    "item  [ item:12 ] means that the picture for @xmath288 and @xmath292 look the same : for instance , since there are @xmath440 marked positions for @xmath224 in  @xmath38 , there are also 4 marked positions for @xmath325 in @xmath288 , where @xmath224 and @xmath325 are corresponding moves in @xmath293 .",
    "furthermore , all are marked except the @xmath441 position in both @xmath38 and @xmath288 , and this position has the same index in both lists of marked positions for @xmath224 ( resp .",
    "@xmath325 ) , namely index  2 .",
    "finally , distances between `` corresponding '' consecutive marked positions in @xmath38 and @xmath288 are either equal , or both are at least  @xmath442 . in  [ fig : marked ] , @xmath443 , therefore these quantities have to be at least @xmath442 .",
    "it is clear that @xmath322 holds before the initial round .",
    "assume now that there are @xmath324 rounds left to play and that @xmath323 holds .",
    "we explain how duplicator can play in order to enforce @xmath310 .",
    "assume that spoiler puts a pebble at a position @xmath444 in @xmath289(the case when spoiler plays in @xmath288 is symmetric ) .",
    "duplicator first defines a position @xmath325 in @xmath292 as follows .",
    "if there is already a pebble on @xmath224 in @xmath293 , then we set @xmath325 as the position holding the matching pebble in @xmath292 .",
    "otherwise , duplicator simulates a move by spoiler in @xmath293by putting a pebble on position @xmath224 and sets @xmath325 as the answer she obtains from her strategy in @xmath293 .",
    "note that by hypothesis all pebbles in @xmath313 ( including @xmath314 ) satisfy the conditions of the @xmath272-game .",
    "we now distinguish two cases depending on the position @xmath153 .",
    "* there exists @xmath376 such that @xmath445*.    we distinguish two subcases :    * if @xmath153 is already a marked position @xmath398 for @xmath224 , then duplicator answers by putting a corresponding pebble on @xmath446 .",
    "note that this answer is correct by hypothesis on @xmath314 for the @xmath272-game and by hypothesis on the marked positions for @xmath314 as stated in item  [ item:10 ] of @xmath323 .",
    "since both positions were already marked for @xmath314 , it is then simple to verify that @xmath310 holds .",
    "* assume now that @xmath153 is not yet marked .",
    "since @xmath195 positions are always marked , @xmath153 is a @xmath378 or a @xmath320 position .",
    "assume that @xmath153 is a @xmath378 position ( the other case is similar ) .",
    "recall that @xmath396 by item  [ item:10 ] in @xmath323 .",
    "let @xmath232 be such that @xmath447 . by item  [ item:12 ] of @xmath448",
    "it is immediate than one can find an answer @xmath388 such that @xmath449 and item  [ item:12 ] of @xmath310 remains satisfied with @xmath312 as new marked positions for @xmath314 .",
    "again this answer is correct by hypothesis on @xmath314 for the @xmath272-game and by hypothesis on the marked positions for @xmath314 as stated in item  2 of @xmath323 .",
    "it is then simple to verify that @xmath310 remains satisfied .",
    "* there exists @xmath376 such that @xmath450*.    from item  [ item:11 ] in @xmath323 , we know that there are at least @xmath451 copies of @xmath318 between @xmath452 and @xmath453 .",
    "it follows that there are either at least @xmath392 copies of @xmath318 between @xmath452 and @xmath153 or at least @xmath392 copies of @xmath318 between @xmath153 and @xmath453",
    ". since both cases are symmetric , assume that we are in the first case : there are at least @xmath392 copies of @xmath318 between @xmath452 and @xmath153 .",
    "let @xmath401 be the number of copies of @xmath378 between @xmath153 and @xmath453 , _",
    "i.e. _ , @xmath454 .",
    "if @xmath455 , we set @xmath388 as the position @xmath456 .",
    "otherwise we set @xmath388 as the position @xmath457 . in both cases , @xmath278 is duplicator s answer and we set @xmath312 as new marked positions for @xmath314 . note that this answer is correct by hypothesis on @xmath314 for the @xmath272-game .",
    "it is immediate that @xmath310 are satisfied by choice of @xmath278 .",
    "in this section , we set up the terminology needed for the algebraic version of our result .",
    "as explained in the introduction , we use varieties to capture our classes of separator languages .",
    "informally , a variety is a class of finite algebras canonically associated to such a class of separators .",
    "we build our algebraic version of the transfer theorem from a weak fragment @xmath1to its enriched version @xmath59 on three ingredients :    1 .",
    "[ item:13 ] a solution to the separation problem for @xmath1 , as in the logical approach .",
    "2 .   [ item:14 ] an algebraic description of the weak variant @xmath1as a variety @xmath30 .",
    "[ item:15 ] an algebraic description of the strong variant @xmath59 as the variety @xmath458 , built from @xmath459 and from a fixed variety @xmath460 with an operator called the semidirect product .",
    "these three points have already been solved for all fragments of  [ fig : frag ] . the transfer result , theorem  [ thm : main ] below , reduces separability by languages associated with @xmath458 to separability by languages associated with @xmath459 .",
    "therefore , relying on the solution of items  [ item:14 ] and [ item:15 ] , it provides a reduction from the separation problem by  @xmath1languages to the separation problem by @xmath59  languages .",
    "if in addition item  [ item:13 ] if fulfilled , then the latter problem is decidable .",
    "this section is devoted to making these notions precise .",
    "it is organized as follows : we first recall the notion of variety of ordered semigroups and monoids , and how varieties can be used to capture classes of regular languages we are interested in .",
    "we then recall the construction of the semidirect product of two varieties in order to define the variety @xmath458 .",
    "we finally present a bibliography giving , for each fragment @xmath58 in  [ fig : frag ] , references for solving the above questions  [ item:13][item:15 ] .",
    "the statement and the proof of the transfer result , theorem  [ thm : main ] , is postponed to section  [ sec : algebra ] .      a _ variety of semigroups ( resp .",
    "monoids ) _ is a class of finite semigroups ( resp .",
    "monoids ) closed under three natural operations : finite direct product , subsemigroup ( or submonoid ) , and homomorphic image .",
    "this makes it possible to define classes of regular languages based on the monoids that recognize these languages : a variety @xmath30defines the class of all languages recognized by semigroups ( resp .",
    "monoids ) in  @xmath30 .",
    "there is an issue however : all classes of languages defined in this way have to be closed under complement , since the set of languages recognized by any semigroup is closed under complement .",
    "this prevents us from capturing logical fragments that are not closed under complement , such as @xmath66 .",
    "this problem has been solved in  @xcite with the notions of _ ordered semigroups and monoids_. intuitively , such a semigroup is parametrized by a partial order and the set of languages it recognizes is then restricted with respect to this partial order .",
    "let us recall this notion , which leads to the definition of variety of ordered semigroups or monoids .",
    "all classes considered in this paper may be defined in terms of such varieties .",
    "* ordered semigroups*.    an ordered semigroup is a pair @xmath461 where @xmath72 is a semigroup and  @xmath462 is a partial order on @xmath72 , which is compatible with multiplication : @xmath463 and @xmath464 imply @xmath465 . to simplify the notation",
    ", we will often omit the partial order @xmath462 when it is clear from the context and simply speak of an ordered semigroup @xmath72 . observe that any semigroup endowed with equality as the partial order is an ordered semigroup .",
    "in particular we view @xmath33 as an ordered semigroup with equality as the partial order .",
    "if @xmath466 and @xmath467 are ordered semigroups , an ordered semigroup morphism is a mapping @xmath468 which is a semigroup morphism and preserves the partial order , _",
    "i.e. _ , for all @xmath469 , @xmath470 .",
    "let @xmath94 and @xmath461 be an ordered semigroup .",
    "then , @xmath42 is said to be _ recognized by @xmath461 _ if there exist an ordered semigroup morphism @xmath95 and @xmath97 , such that @xmath98 and @xmath471 is _ upward closed _ ,",
    "that is : @xmath472 when @xmath462 is trivial , then any subset of @xmath72 is upward closed , and we recover exactly the classical notion of recognizability by semigroups presented just above .",
    "however , when @xmath462 is nontrivial , the set of recognized languages gets restricted because of the additional condition on the recognizing set  @xmath471 .",
    "in particular it may happen that a language is recognized by @xmath461 , while its complement is not ( its complement is recognized by @xmath473 ) .",
    "* varieties of ordered semigroups*.    a _ variety of finite ordered semigroups _ is a class @xmath30of finite ordered semigroups that satisfies the following properties :",
    "1 .   @xmath30is closed under ordered subsemigroup : if @xmath474 , then @xmath475 when @xmath84 is a subsemigroup of @xmath72 and the order on @xmath84 is the restriction of the order on @xmath72 .",
    "2 .   @xmath30is closed under ordered quotient : if @xmath474 and @xmath476 is a surjective ordered semigroup morphism , then we have @xmath475 .",
    "3 .   @xmath30is closed under cartesian direct product : if @xmath477 , then we have @xmath478 , where the semigroup @xmath479 is equipped with the componentwise multiplication and @xmath480 if @xmath481 and @xmath482 .    note that for technical reasons , we have to consider both varieties of semigroups and monoids : non - enriched fragments correspond to varieties of monoids while enriched ones correspond to varieties of semigroups . for the sake of simplifying the presentation",
    ", we only give the definitions for semigroups . ordered monoids and varieties of ordered monoids",
    "are defined in a similar way , as well as the non - ordered versions .    * varieties and classes of languages*.    to any variety @xmath30of ordered semigroups ( resp .  of ordered monoids ) ,",
    "we can associate the class of all languages that are recognized by an ordered semigroup ( resp .  ordered monoid ) in @xmath30 . as for logics and for the sake of simplifying the presentation , we may abuse notation and use @xmath30to denote both a variety and the class of languages it defines .",
    "it turns out that all classes from  [ fig : frag ] can be defined in such a way .",
    "therefore , they all have an associated a variety .",
    "this follows actually from a general result , eilenberg s theorem .",
    "one should however keep in mind that in this framework , there is :    1 .",
    "[ item:16 ] eilenberg s theorem , a generic result establishing a correspondence between varieties and classes of languages ( indexed by alphabets ) enjoying certain closure properties : closure under boolean operations , inverse morphisms and left and right residuals .",
    "it was first obtained by s.  eilenberg for classes closed under complement , and later generalized by j.e .",
    "pin  @xcite when this assumption does not necessarily hold .",
    "[ item:17 ] specific instances of eilenberg s theorem , one for each particular class , relating such a class of languages with a corresponding variety of ordered semigroups or monoids",
    ".    we will not state eilenberg s theorem precisely , as we do not need it . on the other hand , item  [ item:17 ]",
    "is useful to provide an alternate version of our transfer result , theorem  [ thm : sdo ] , in the algebraic framework of section  [ sec : algebra ] .",
    "this alternate version , theorem  [ thm : main ] , is generic , in the sense that it transfers decidability of the separation problem for a variety @xmath459 to the variety @xmath458 , with no assumption on the variety @xmath30 .",
    "however , in order to instantiate this generic theorem for our logical fragments , we need item  [ item:15 ] above , _",
    "i.e. _ , to show that for each weak fragment  @xmath1 , if the variety associated to @xmath1is @xmath30 , then the variety associated to the enriched variant  @xmath59 is @xmath483 . in other words ,",
    "we shall rely on the aforementioned specific connections , item  [ item:17 ] above , between a class of languages and a variety of ordered semigroups or monoids .",
    "each fragment will be described in section  [ sec : algebraic - charac ] , and the fact that for all of them , if @xmath1corresponds to the variety @xmath30 , then @xmath59 corresponds to the variety @xmath458 is stated in theorem  [ thm : vstard ] .",
    "let @xmath484 be an ordered monoid and let @xmath84 be an ordered semigroup .",
    "semidirect product _ of @xmath484 and @xmath84 is an operation which is parametrized by an _ action _",
    "of @xmath84 on @xmath484 and outputs a new ordered semigroup , whose base set is @xmath485 . in particular",
    ", one can obtain different semidirect products out of the same @xmath484 and @xmath84 , depending on the chosen  action .",
    "let ` @xmath486 ' and ` @xmath487 ' be the operations of @xmath484 and @xmath84 respectively .",
    "note that we choose to denote the operation on @xmath484 additively .",
    "this is for the sake of simplifying the presentation .",
    "however , this does not mean that we assume @xmath484 to be commutative .",
    "an _ action _ ` @xmath488 ' of @xmath84 on @xmath484 is a mapping @xmath489 from @xmath490 to @xmath484 such that , for all @xmath491 and all @xmath492 :    2    * @xmath493 .",
    "* @xmath494 . * if @xmath495 , then @xmath496 .",
    "* @xmath497 .",
    "* @xmath498 . *",
    "if @xmath499 , then @xmath500 .    given a fixed action ` @xmath488 ' of @xmath84 on @xmath484 , the _ semidirect product @xmath501 of @xmath484 and @xmath84 with respect to action @xmath488 _ is the set @xmath502 equipped with the following operation : @xmath503 and the componentwise order : @xmath504 one can verify that this does yield an ordered semigroup , see  @xcite .    given a variety @xmath30of ordered monoids and a variety @xmath505of ordered semigroups , we denote by @xmath506 the variety of ordered semigroups generated by all semidirect products of the form @xmath507 , with @xmath508 and @xmath509 , where @xmath488 ranges over all possible actions of @xmath84 on  @xmath484 .    * the variety @xmath510*.    we will only use the semidirect product with semigroups @xmath84 from a specific variety , denoted by @xmath460 .",
    "this is because such a semidirect product @xmath483 of @xmath459 with @xmath460 is often related to the enrichment with the successor relation of the fragment captured by @xmath459 .",
    "the variety @xmath510consists of all finite ordered semigroups @xmath72 such that for all @xmath77 and all @xmath157 , we have @xmath511 . from a language perspective",
    ", a language @xmath42 is recognized by a semigroup in @xmath510iff there exists @xmath252 such that membership of a word @xmath103 to  @xmath42 only depends on the suffix of length @xmath245 of @xmath103 .",
    "the reason why we introduce such semidirect products is the following theorem , which gathers several nontrivial results from the literature listed in section  [ sec : algebraic - charac ] , and which answer our requirement  [ item:15 ] towards our transfer theorem .",
    "[ thm : vstard ]",
    "let @xmath30be a variety corresponding to a fragment @xmath1from the ones presented in  [ fig : frag ] .",
    "then , the variety corresponding to the fragment @xmath59 is @xmath31 .      in this section ,",
    "we consider items  [ item:14 ] and [ item:15 ] , which were to be solved in order to apply our generic theorem .",
    "all logical fragments of  [ fig : frag ] correspond to varieties that have been fully identified .",
    "we present , for each such fragment , bibliographic references relating its weak and strong variants to varieties .",
    "in particular , we will see that theorem  [ thm : vstard ] holds : for each fragment whose non - enriched variant corresponds to a variety @xmath30of ordered monoids , its enriched version corresponds to the variety of ordered semigroups @xmath458 built from  @xmath459 .",
    "the logic @xmath60is the restriction of @xmath2 in which the linear order can not be used , and only equality between two positions can be tested .",
    "it is folklore that @xmath60-definable languages are exactly those that can be defined using a monoid in the variety of monoids acom of aperiodic and commutative monoids .",
    "the enriched fragment is @xmath61 , as @xmath5 and @xmath6 can be eliminated in the formulas .",
    "it defines locally threshold testable languages  @xcite . in  @xcite , it was proved that @xmath70-definable languages are exactly those that can be defined in @xmath512 . in particular this",
    "was used to solve the membership problem for @xmath70 .",
    "that separation is decidable for @xmath60is simple ( essentially , the problem can be reduced to the decision of presburger logic , see  @xcite ) . hence theorem  [ thm : sdo ] and theorem  [ thm : main ] yield two different proofs of the following corollary .",
    "[ cor : ltt ] let @xmath46 be regular languages .",
    "it is decidable to test whether @xmath42 is @xmath70-separable from @xmath43 .    as we already explained , while the proof of corollary  [ cor : ltt ] is new , the result itself is not .",
    "a specific proof was presented in  @xcite and the result can also be obtained through indirect means by combining results from  @xcite .",
    "one can classify first - order formulas by counting the number of alternations between @xmath63 and @xmath64 quantifiers in the prenex normal form of the formula . for @xmath254 ,",
    "a formula is said to be @xmath513 ( resp .",
    "@xmath514 ) if its prenex normal form has @xmath515 quantifier alternations ( that is , @xmath224 blocks of quantifiers ) and starts with an @xmath63 ( resp .",
    "a  @xmath64 ) quantifier .",
    "for example , a formula whose prenex normal form is @xmath516 is 3 . observe that a @xmath514 formula is by definition the negation of a @xmath513 formula . finally , a @xmath517 formula is a boolean combination of @xmath513 formulas .",
    "both this hierarchy and the enriched variant are known to be strict  @xcite .",
    "furthermore , they correspond to well - known hierarchies of classes of languages : the non - enriched hierarchy corresponds to the straubing - thrien hierarchy  @xcite , while the enriched hierarchy corresponds to the dot - depth hierarchy  @xcite .",
    "note that for all fragments above @xmath66 , the predicates @xmath5 and @xmath6 can be eliminated from the logic .",
    "hence , we denote the enriched fragments by 1 , , @xmath518    solving the membership problem for all levels in both hierarchies has been an open problem for a long time . as of today , only the lower levels are known to be decidable .",
    "historically , 1 and 1 have been investigated first .",
    "it is known from  @xcite that 1 has decidable membership and corresponds to the variety of monoids  j. for 1 , decidability was proved in  @xcite , as well as the correspondence with the variety of semigroups @xmath519 in  @xcite .",
    "the fragments 1 and 2 were shown to have decidable membership in  @xcite . moreover",
    ", the authors also prove that each of these two fragments correspond to varieties of ordered monoids and that 1 and @xmath71correspond to the varieties of semigroups obtained by taking the semidirect product with @xmath510 . from this correspondence , they obtain decidability of 1 .",
    "this is more involved for @xmath71and was proved later in  @xcite .",
    "recently , membership has been shown to be decidable for both 2 and 3  @xcite .",
    "these results can be transferred to @xmath146and @xmath147using a result by straubing  @xcite , or theorem  [ thm : memb ] in this paper .",
    "for all levels above , the membership problem is open .",
    "separation is known to be decidable for 1  @xcite , 1  @xcite and @xmath66  @xcite .",
    "hence theorem  [ thm : sdo ] and theorem  [ thm : main ] yield two different proofs of the following corollary .",
    "let @xmath46 be regular languages , then the following problems are decidable :    * whether @xmath42 is @xmath12-separable from @xmath43 .",
    "* whether @xmath42 is @xmath11-separable from @xmath43 . * whether @xmath42 is @xmath71-separable from @xmath43 .    as we explained in section",
    "[ sec : prelims ] , the result for 1 as it can also be obtained through indirect means by combining results from  @xcite . on the other hand ,",
    "the results are new for both @xmath12 and @xmath71 .",
    "the logic @xmath57is the restriction of @xmath2using only two ( reusable ) variables .",
    "the corresponding enriched fragment is @xmath68(@xmath5 and @xmath6 can be eliminated from the logic ) .    in  @xcite",
    ", it was proved that @xmath57and @xmath68correspond respectively to the varieties da and @xmath520",
    ". this immediately yields decidability of membership for @xmath57 . for @xmath68 ,",
    "this additionally requires a deep algebraic result by almeida  @xcite ( a simpler self - contained proof also exists  @xcite ) .",
    "the separation problem has been proved to be decidable for @xmath57 in  @xcite .",
    "hence theorem  [ thm : sdo ] and theorem  [ thm : main ] yield two different proofs of the following corollary .    [ cor : dodp ] let @xmath46 be regular languages .",
    "it is decidable to test whether @xmath42 is @xmath68-separable from @xmath43 .    as we explained in section",
    "[ sec : prelims ] , while the proof is new , the result itself is not .",
    "it can also be obtained through indirect means , again by combining results from  @xcite .",
    "we are now ready to prove theorem  [ thm : main ] .",
    "recall that we have a non - trivial variety @xmath30of ordered monoids , two languages @xmath42 and @xmath43 recognized by a morphism @xmath95 , and @xmath521 the associated languages of well - formed words .",
    "we prove that @xmath42 is @xmath522-separable from @xmath43 if and only if @xmath141is @xmath30-separable from @xmath134 .",
    "we prove each direction in its own subsection .",
    "we now present an algebraic version of theorem  [ thm : sdo ] : the operator @xmath17 preserves decidability of separation .",
    "we would like to emphasize again that the ideas behind this theorem are essentially the same as for theorem  [ thm : sdo ] .",
    "in particular , proofs only rely on elementary notions , thus bypassing complex constructions usually used to prove this kind of result , even if the statement itself requires some additional algebraic  vocabulary .",
    "the section is organized in three parts .    *",
    "we first briefly recall how classes of languages corresponding to our logical fragments are given an algebraic definition : for each fragment , an associated class of finite semigroups ( or monoids )  @xmath30 , a _ variety _ , has already been characterized , such that the class of languages definable in the  fragment is exactly the class of languages that are recognized by a semigroup ( or monoid ) of @xmath30 . *",
    "in the second part , we define what `` adding the successor relation '' means in this context . given a variety",
    "@xmath30 , this generally corresponds to considering a new variety built on top of  @xmath30via an operation called the _",
    "semidirect product_. this new variety is denoted @xmath458 . * finally ,",
    "in the last part , we state our main theorem : for any variety @xmath30 , separability for the variety @xmath458 reduces to separability for the variety  @xmath30 .",
    "we have now the machinery needed to state our main theorem . for any variety of ordered monoids",
    "@xmath30 , we reduce @xmath522-separability to @xmath459-separability .    [ thm : main ] let @xmath30be a non - trivial variety of ordered monoids",
    "let @xmath42 and @xmath43 be two languages both recognized by the same morphism @xmath95 into a finite semigroup  @xmath72 .",
    "set @xmath523 as the languages of well - formed words associated to @xmath46 , respectively .",
    "then , @xmath42 is @xmath522-separable from @xmath43 if and only if @xmath133 is @xmath30-separable from @xmath134 .    in view of theorem  [ thm : vstard ] ,",
    "theorem  [ thm : main ] applies to all fragments we introduced .",
    "this means that theorem  [ thm : sdo ] can be given an alternate indirect proof within this algebraic framework by combining theorem  [ thm : main ] and theorem  [ thm : vstard ] .",
    "hence , this also yields another proof of corollary  [ cor : sdp ] .",
    "the proof of theorem  [ thm : main ] is presented in the rest of this section . as it was the case for theorem  [ thm : sdo ] ,",
    "the proof is both elementary and constructive : if there exists a separator for @xmath141and @xmath134 in @xmath30 , we use it to construct a separator for @xmath42 and @xmath43 in @xmath458 .    this rest of the section is divided in three parts . in the first one , we recall the formal definition of the semidirect product operation . in the next two ones ,",
    "we prove both directions of theorem  [ thm : main ] .",
    "we prove that if @xmath42 is @xmath524-separable from @xmath43 , then @xmath133 is @xmath30-separable from @xmath134 .",
    "note that we reuse the construction which associates a canonical word @xmath525 to every word @xmath113 and natural @xmath526 ( see section  [ sec : from - fodp - to - fod ] for details ) .",
    "assume that @xmath42 is @xmath524-separable from @xmath43 .",
    "this means that there exists an element of @xmath524 separating @xmath42 and @xmath43 . by (",
    "3.5 ) , such an ordered semigroup is an ordered quotient of an ordered subsemigroup of a semidirect product @xmath527 , with @xmath528 and @xmath529 .",
    "therefore , @xmath527 itself separates @xmath42 and @xmath43 .",
    "hence , there is some upward closed @xmath530 and a morphism @xmath531 such that @xmath532 separates @xmath42 from @xmath43 .",
    "we construct a separator in @xmath30for @xmath141and @xmath134 .",
    "set @xmath533 and observe that since @xmath459 is non - trivial , it contains an ordered monoid @xmath534 containing at least @xmath268 distinct elements .",
    "we choose @xmath268 such elements @xmath535 of @xmath534 .",
    "the choice is essentially arbitrary , but we ask @xmath535 to be pairwise incomparable with respect to the partial order @xmath462 .",
    "we prove that @xmath141can be separated from @xmath134 using the ordered monoid @xmath536 ( recall that a variety is closed under cartesian product ) . for an element @xmath537 of @xmath84 ,",
    "we denote by @xmath538 the element @xmath539 of @xmath534 .",
    "we define a morphism @xmath540 as follows .",
    "let @xmath21 be the idempotent power @xmath541 of @xmath527 .",
    "set @xmath542 , so that @xmath543 .",
    "let @xmath544 and @xmath545 .",
    "we define @xmath546 as follows : @xmath547 this defines a morphism @xmath548 .",
    "it remains to prove that @xmath549 recognizes a separator of @xmath133 and @xmath134 .",
    "this is a consequence of the next lemma .",
    "[ lem : msowillneverdie ] let @xmath113 be well - formed , and set @xmath550",
    ". then @xmath551 .    before proving the lemma",
    ", we use it to conclude the proof .",
    "define @xmath552 by @xmath553 .",
    "one can verify that @xmath554is upward closed .",
    "we claim that @xmath555 separates @xmath141from @xmath134 .",
    "assume first that @xmath556 .",
    "by fact  [ fct : cons1 ] , @xmath557 , hence @xmath558 .",
    "it then follows from lemma  [ lem : msowillneverdie ] that @xmath559 . conversely if @xmath560 , we have @xmath561 .",
    "it then follows from lemma  [ lem : msowillneverdie ] that @xmath562 which terminates the proof .",
    "we now prove lemma  [ lem : msowillneverdie ] .",
    "we first show that the first component in @xmath484 of @xmath563 and of @xmath564 are equal .",
    "the proof consists in a straightforward but tedious computation .",
    "set @xmath565 that is well - formed . set @xmath566 and recall that , in view of the definition of @xmath567 given in section  [ sec : from - fodp - to - fod ] ,",
    "we have chosen words @xmath568 and @xmath569 such that : @xmath570 for each idempotent @xmath571 , set @xmath544 and for each element @xmath572 , let @xmath573 .",
    "note that by definition of @xmath21 , the element @xmath574 is idempotent , so @xmath575 .",
    "in particular , @xmath576 is idempotent in @xmath84 .",
    "further , we have for all @xmath224 : @xmath577 for each @xmath566 , we then have @xmath578 where , for computing the 2nd component , we used the fact that @xmath579 is idempotent in @xmath580 . similarly , by definition we have @xmath581 , and @xmath582 again , for the last equality , we used the definition of the semidirect product and the fact that each @xmath579 is an idempotent in @xmath84 , which implies , since @xmath583 , that @xmath584 for all @xmath585 .",
    "using for each @xmath224 , one can replace @xmath586 in   by @xmath587 .",
    "taking into account that @xmath579 is idempotent in @xmath84 , this yields for this first component of @xmath563 the value @xmath588    observe that since @xmath589 is well - formed , @xmath590 , hence @xmath591 , which is the neutral element for the ` @xmath486 ' operation on @xmath484 .",
    "in the same way , @xmath592 , hence @xmath593 , and therefore , using the last axiom of an action , we deduce that @xmath594 .",
    "hence , these two elements can be removed from the expression of the first component of @xmath563 .",
    "therefore , this first component can be rewritten , using associativity , as : @xmath595    on the other hand , in view of   and by definition of @xmath549 , the first component of @xmath596 is @xmath597 therefore , one can compute the first component of @xmath598 by summing the values   for @xmath599 ( recall that the operation on @xmath484 is noted additively ) , which gives the value computed in .",
    "hence we have shown that the first component in @xmath484 of @xmath563 and of @xmath564 are equal .",
    "it remains to check that when the second component of @xmath563 is equal to some @xmath585 , then the second component of @xmath564 is the corresponding element @xmath600 .",
    "this is simpler : by definition of a well - formed word , we have @xmath601 for @xmath602 , and @xmath592 . by definition of @xmath549",
    ", it follows that the second component of @xmath564 is the second component of @xmath603 , namely @xmath604 .",
    "now , since @xmath583 , the second component of @xmath605 is @xmath606 , which concludes the proof .",
    "we prove that if @xmath133 is @xmath30-separable from @xmath134 , then @xmath42 is @xmath524-separable from @xmath43 .",
    "note that we reuse the construction which associates to every word @xmath149 a canonical word @xmath150 ( see section  [ sec : from - fod - to - fodp ] for details ) .",
    "assume that @xmath141is @xmath30-separable from @xmath134 .",
    "this means that we have a morphism @xmath607 with @xmath608an ordered monoid in @xmath30and @xmath552 upward - closed such that @xmath555 separates @xmath141from @xmath134 .",
    "we need to construct a separator in @xmath458 for @xmath42 and @xmath43 .",
    "the main idea is to define a morphism , which given @xmath149 , computes @xmath609 .",
    "this is slightly technical however as the morphism needs some machinery to make this computation .",
    "we begin with some notations . to every word @xmath149 , we associate an element @xmath610 .",
    "let @xmath153 be the last position in @xmath103 and consider the construction of @xmath176 . if @xmath153 is distinguished , we set @xmath611 with @xmath204 the label of @xmath185 in @xmath176 . otherwise , we simply set @xmath612 .",
    "we can now start the construction of our separator .",
    "we have to define the following objects :    * an ordered semigroup @xmath529 .",
    "* an ordered monoid @xmath613 . * an action of @xmath84 on @xmath484 yielding a semidirect product @xmath614 . * a morphism @xmath615 which recognizes the desired separator .    * definition of @xmath84*.    we set @xmath84 as the set @xmath616 equipped with the following operation . if @xmath617 , we set @xmath618 as the suffix of length @xmath186 of the word @xmath619 when @xmath619 has length @xmath620 and as @xmath619 otherwise .",
    "one can verify that this operation is indeed associative and that @xmath621 .",
    "we use equality as the partial order on @xmath84 .",
    "observe that we have a natural morphism @xmath622 such that @xmath623 is @xmath103 if @xmath624 , and @xmath623 is the suffix of length @xmath186 of @xmath103 otherwise .",
    "observe that by lemma  [ lem : canonic ] , we have the following fact .",
    "[ fct : canonic ] for every @xmath149 , @xmath625 .",
    "* definition of @xmath484*.    we set @xmath613 as the cartesian product @xmath626 ( recall that as a variety of ordered monoids , @xmath30is closed under cartesian product ) .    since we intend to take a semidirect product of @xmath484 and @xmath84",
    ", we will denote the semigroup operations of both @xmath484 and @xmath627 additively in order to clarify the presentation .",
    "* definition of @xmath527*.    if @xmath628 and @xmath629 ( _ i.e. _ , @xmath630 is a mapping @xmath631 ) , we set @xmath632 as the mapping @xmath633 such that @xmath634 .",
    "one can verify that @xmath487 is an action of @xmath84 on @xmath484 .",
    "in the remainder of the proof , we denote by @xmath527 the semidirect product of @xmath484 and @xmath84 with respect to this action .    * definition of @xmath635*.    set @xmath636 defined as follows .",
    "we set @xmath637 and @xmath638 when @xmath628 .",
    "we can now define @xmath639 .",
    "let @xmath640 , we set @xmath641 as the pair @xmath642 where @xmath643 , _ i.e. _ , the mapping @xmath644 .",
    "it now remains to prove that @xmath635 does recognize a separator of @xmath42 from @xmath43 .",
    "this is a consequence of the following lemma .",
    "[ lem : thisistheend ] let @xmath149 , @xmath645 and @xmath646 as the label of the last position in @xmath647 .",
    "then , @xmath648    we first use the lemma to conclude the proof . set @xmath649 as the set @xmath650 one can verify that @xmath471 is upward closed ( this is essentially because @xmath554is upward - closed ) .",
    "it is immediate from lemma  [ lem : thisistheend ] that @xmath651 iff @xmath652 .",
    "we claim that @xmath532 separates @xmath42 from @xmath43 .",
    "assume first that @xmath179 , we need to prove that @xmath653 .",
    "by fact  [ fct : sametype ] , we have @xmath208 , hence @xmath652 and @xmath654 .",
    "similarly , if @xmath212 , @xmath213 , hence @xmath655 and @xmath656 which terminates the proof .",
    "it finally remains to prove lemma  [ lem : thisistheend ] .",
    "set @xmath657 and @xmath658 . by definition",
    ", we have : @xmath659 by definition of @xmath660 and by fact  [ fct : canonic ] this means that : @xmath661 it is then immediate from the definition of @xmath189 that @xmath662 .",
    "hence @xmath663 .",
    "this finishes the proof since @xmath38 is the suffix of length @xmath186 of @xmath103 , and therefore @xmath664 by lemma  [ lem : canonic ] .",
    "we proved that separation is decidable over finite words for the following logical fragments : @xmath70 , , 1 , @xmath71and @xmath68 . to achieve this , we presented a simple reduction to the same problem for the weaker fragments @xmath60 , , 1 , @xmath66and @xmath57 .",
    "the reduction itself is entirely generic to all fragments and its proof is elementary , and also mostly generic . in particular , the technique can be used to prove that the reduction works for other natural fragments of first - order logic . an interesting example to which these results apply is the quantifier alternation hierarchy within @xmath57(known as the trotter - weil hierarchy , and which is decidable  @xcite ) .",
    "however , the separation problem for classes in this hierarchy has yet to be investigated .",
    "we also obtained direct proofs that membership is decidable for @xmath28 and @xmath29 .",
    "finally , we presented an algebraic formulation of this reduction , which recovers a previously known result by steinberg  @xcite , while having a much simpler proof .",
    "one can expect extending these results to other fragments , such as enrichment with modulo predicates .",
    "another advantage of this technique is that it can be extended in a straightforward way to the same logical fragments over words of infinite length .",
    "this yields identical transfer results .",
    "we leave the presentation of these results for further work .",
    "wojciech czerwiski , wim martens , and tom masopust .",
    "efficient separability of regular languages by subsequences and suffixes . in _ proceedings of the 40th international colloquium on automata , languages , and programming , icalp13 _ , volume 7966 of _ lecture notes in computer science _ , pages 150161 .",
    "springer , 2013 .",
    "thomas place , lorijn van rooijen , and marc zeitoun . separating regular languages by locally testable and locally threshold testable languages . in _ proceedings of the 34th iarcs annual conference on foundations of software technology and theoretical computer science , fsttcs13",
    "_ , volume  24 of _ lipics _ , pages 363375 .",
    "schloss dagstuhl - leibniz - zentrum fuer informatik , 2013 .",
    "thomas place , lorijn van rooijen , and marc zeitoun . separating regular languages by piecewise testable and unambiguous languages . in",
    "_ proceedings of the 28th mfcs13 _ , volume 8087 of _ lecture notes in computer science _ , pages 729740 .",
    "springer , 2013 .",
    "thomas place and marc zeitoun .",
    "going higher in the first - order quantifier alternation hierarchy on words . in _ proceedings of the 41th international colloquium on automata , languages , and programming , icalp14 _ , volume 8573 of _ lecture notes in computer science _ ,",
    "pages 342353 , 2014 .",
    "http://arxiv.org/pdf/1404.6832v1 .",
    "thomas place and marc zeitoun . separating regular languages with first - order logic . in _ proceedings of the joint meeting of the 23rd eacsl annual conference on computer science logic ( csl14 ) and the 29th annual acm / ieee symposium on logic in computer science ( lics14 )",
    "_ , 2014 .    thomas place and marc zeitoun . separation and the successor relation",
    ". in _ proceedings of the 32nd symposium on theoretical aspects of computer science , stacs15 _ , lipics .",
    "schloss dagstuhl - leibniz - zentrum fuer informatik , 2015 .",
    "denis thrien and thomas wilke . over words ,",
    "two variables are as powerful as one quantifier alternation . in _ proceedings of the 30th annual acm symposium on theory of computing , stoc98 _ , pages 234240 .",
    "acm , 1998 ."
  ],
  "abstract_text": [
    "<S> we investigate two problems for a class @xmath0of regular word languages . the @xmath0-membership problem asks for an algorithm to decide whether an input language belongs to @xmath0 . </S>",
    "<S> the @xmath0-separation problem asks for an algorithm that , given as input two regular languages , decides whether there exists a third language in @xmath0containing the first language , while being disjoint from the second . </S>",
    "<S> these problems are considered as means to obtain a deep understanding of the class @xmath0 .    </S>",
    "<S> it is usual for such classes to be defined by logical formalisms . </S>",
    "<S> logics are often built on top of each other , by adding new predicates . </S>",
    "<S> a natural construction is to enrich a logic with the successor relation . in this paper , we obtain new and simple proofs of two transfer results : we show that for suitable logically defined classes , the membership , resp .  </S>",
    "<S> the separation problem for a class enriched with the successor relation reduces to the same problem for the original  class .    </S>",
    "<S> our reductions work both for languages of finite words and infinite words . </S>",
    "<S> the proofs are mostly self - contained , and only require a basic background on regular languages . </S>",
    "<S> this paper therefore gives simple proofs of results that were considered as difficult , such as the decidability of the membership problem for the levels 1 , 3/2 , 2 and 5/2 of the dot - depth hierarchy . </S>"
  ]
}