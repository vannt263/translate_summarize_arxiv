{
  "article_text": [
    "massive multiple - input and multiple - output ( mimo ) has been considered as a key technology for the next - generation cellular system@xcite , where multiple users ( mu ) are simultaneously served at the same frequency band by the base station ( bs ) equipped with a large number of antennas .",
    "the benefits brought by massive bs antennas include high energy efficiency , high spectrum efficiency , high spatial resolution , and so on@xcite . for mu massive mimo systems , downlink ( dl )",
    "transmission relies on the precocding to reduce inter - user interference ( iui ) . in time",
    "division duplex ( tdd ) systems where channel reciprocity holds , the channel state information ( csi ) required by dl precoding can be obtained via uplink ( ul ) pilots to avoid the significant training overhead @xcite .",
    "clearly , the ul channel estimation and the dl precoding are the foundation of the tdd massive mimo systems .    when the number of the antennas approaches infinity , channel vectors corresponding to different users are spatially orthogonal and the optimal dl precoding is simply the matched filtering .",
    "however , if there are a finite number of antennas in practical systems , such an orthogonality does not hold and the massive mimo system naturally turns into a non - orthogonal multiple access ( noma ) system . therefore , more sophisticated precoding schemes are necessary .",
    "the concept of noma has been originally proposed to enhance the spectrum efficiency by allowing multiple users allocated different power levels to share the same resource block @xcite .",
    "another dominant noma category is code - domain multiplexing ( cdm ) , including multiple access low - density spreading ( lds ) cdma @xcite , sparse - code multiple access ( scma ) @xcite , multi - users shared access ( musa ) @xcite , and so on .",
    "several other multiple access schemes have also been put forward , such as pattern - division multiple access ( pdma ) , bit - division multiplexing ( bdm ) @xcite , and interleave - division multiple access ( idma ) @xcite .",
    "an earlier study of spatially non - orthogonal multiple access scheme has been presented in @xcite for conventional mimo where multiple users are served by non - orthogonal beams . like other noma systems , understanding the rationale behind the channel non - orthogonality in massive mimo will definitely benefit the system design .",
    "another critical issue of massive mimo is the practical cost associated with a large number of rf chains . as a cost - effective solution ,",
    "massive antennas with limited rf chains have attracted a great deal of attention , where the precoding is performed in a hybrid manner by combining phase shifters based analog precoding and a much smaller size digital precoding . since its first appearance under the name of antenna soft selection @xcite ,",
    "hybrid precoding has been studied extensively , as we can see from @xcite and the references therein .",
    "however , it is still unclear how to well form analog precoding , especially for low - cost phase shifters with _ finite resolution_.    meanwhile , most existing hybrid precoding schemes depend on the perfect knowledge of the channel . however , when there are only limited rf chains available , channel estimation becomes challenging .",
    "an adaptive algorithm to estimate the hybrid mmwave channel parameters has been developed in @xcite , where the poor scattering nature of the channel is exploited and adaptive compressed sensing ( cs ) has been employed .",
    "the accuracy of the cs method is limited by the finite grid and its computational complexity is also high for the practical deployment .",
    "a beam training procedure has been provided in @xcite , which aims to search only several candidate beam pairs for fast channel tracking .",
    "although this category of schemes work well for the point - to - point scenarios , the pilot overhead is very high for the multi - user scenarios .",
    "a beam cycling method has been developed in @xcite , where channel estimation comparable to the full digital system is achieved by sweeping the beam directions over all spatial region .",
    "a priori knowledge aided hybrid channel tracking scheme has been developed in @xcite for tera - hertz beamspace massive mimo systems , which excavates a temporal variation law of the physical direction for predicting the support of the beamspace channel . however , the prior knowledge of the user is not always known in practice and the method can not be applied for the more general case .",
    "recently , an array signal processing aided channel estimation scheme has been proposed in @xcite , where the angle information of the user is exploited to simplify the channel estimation .",
    "nevertheless , the scheme is only applicable for full digital systems and can not be directly extended to hybrid systems .    in this paper",
    ", we develop a new hybrid massive mimo transmitter from the angle domain perspective .",
    "we first analyze _ instantaneous _ channels in a tdd massive mimo system , where the bs is equipped with an @xmath0-antenna uniform linear array ( ula ) and each user has single antenna .",
    "it is shown that the channel vectors corresponding to different users are asymptotically orthogonal as @xmath0 goes large when the angles of arrival ( aoas ) of users are different . using the discrete fourier transform ( dft ) ,",
    "the _ cosine _ of the aoa can be estimated with a resolution proportional to @xmath1 .",
    "the resolution can be further enhanced by using zero padding technique with fast fourier transform ( fft ) .",
    "we then decompose the channel matrix into an angle domain basis matrix and a corresponding channel matrix .",
    "the former can be formulated either by the orthogonal or the non - orthogonal steering vectors and the latter has the same size as rf chains .",
    "accordingly , the precoding scheme consists of either orthogonal or non - orthogonal beamforming towards users and an angle domain precoding dealing with the iui . by mapping the above beamforming and precoding matrices to the analog and the digital precoding , respectively",
    ", the proposed scheme perfectly matches the hybrid precoding with _ finite resolution _",
    "phase shifters . from the aoa - based analysis",
    ", the mu massive mimo can be viewed as an angle division multiple access ( adma ) system . as a result",
    ", a novel hybrid channel estimation scheme can be designed that significantly saves the overhead compared to the conventional beam cycling method .",
    "the rest of the paper is organized as follows : section ii investigates the channel orthogonality from the viewpoint of aoa , and then training - based aoa estimation is discussed in section iii .",
    "next , angle - domain decomposition aided hybrid precoding is proposed in section iv , followed by a novel hybrid channel estimation scheme in section v. simulation results are presented in section vi , and section vi concludes the paper .",
    "consider an mu massive mimo system , where the bs is equipped with a ula of @xmath0 elements to serve @xmath2 single - antenna users .",
    "for the sake of convenience , only one cell is considered here and therefore there is no pilot contamination while similar principle can be easily extended to multi - cell cases . from the well - established narrowband transmission model@xcite",
    ", the ul channel vector between the @xmath3th user and the bs can be expressed as @xmath4 where @xmath5 is the number of i.i.d paths , @xmath6 is the complex gain of the @xmath7th path of the @xmath3th user , and @xmath8 is the steering vector . the steering vector can be expressed as @xmath9,\\end{aligned}\\ ] ] where @xmath10 is the bs antenna spacing , @xmath11 is the wavelength of the carrier frequency , and @xmath12 $ ] is a random aoa .",
    "the matrix form of ( [ hk ] ) can be written as @xmath13 where @xmath14 $ ] and @xmath15^t$ ] .",
    "then , based on channel model in ( [ eq : hkmatrix ] ) , we can prove the following lemma in appendix a , which will be very useful to the design of an mu massive mimo system .",
    "for any two channel vectors , @xmath16 and @xmath17 @xmath18 , if they have no common path , namely @xmath19 for any @xmath20 and @xmath21 , then they are asymptotically orthogonal when @xmath0 is sufficiently large",
    ". that is , @xmath22 , where @xmath23 .",
    "the result in the lemma does not rely on any statistical properties of the channel tap gain vectors @xmath24 and @xmath25 , thus _ can directly apply to instantaneous channels .",
    "_ consequently , when the bs array is large enough and the channels do not share the same paths , they are always orthogonal regardless of whether their fading coefficients are correlated or not . on the other hand , when there are common paths between two instantaneous channels , the orthogonality depends on their instantaneous fading coefficients@xcite,@xcite .",
    "from section ii , the aoa plays a fundamental role in the analysis of massive mimo system and thus needs to be obtained .",
    "aoa estimation is a classical problem in the area of array signal processing , and there are many well - known approaches .",
    "for example , the parametric algorithms music @xcite and esprit @xcite have already demonstrated their superior resolution capability compared to the non - parametric counterparts .",
    "however , most existing aoa estimation methods are based on the statistics of the received signal , say the signal covariance , because traditional aoa estimation is _ passive _ and blind , and the targets do not want to be detected and do not have any interplay with the array .",
    "on the other hand , in the area of wireless communications , the users want to be connected by the bs array and therefore help the bs estimate their aoas by sending pilot signals .",
    "for example , @xmath2 users can send @xmath2 orthogonal training sequences of length @xmath2 to the bs to estimate the instantaneous ul channel vector , @xmath26 , for each user @xcite .",
    "the next question is how aoa is related to or can be obtained from @xmath26",
    ".    denote @xmath27 , then @xmath28 in ( [ eq : hkmatrix ] ) can be expressed as @xmath29.\\end{aligned}\\ ] ] from ( [ ak ] ) , the aoa estimation here is equivalent to the well - known _ multiple - frequency estimation _ problem , where the _ frequencies _ to be estimated are @xmath30 .",
    "it is obvious that @xmath31 since @xmath32 . in the following discussion , we let @xmath33 , for the sake of convenience .    a simple way is to apply the dft on @xmath26 , which can be implemented by the fft if @xmath0 is power of @xmath34 .",
    "the resolution of the estimation is @xmath35 .",
    "therefore , it may not be possible to recover all the angle and gain parameters if the number of antennas are finite . in other words , two  frequencies \" with a difference less than @xmath1 can not be distinguished if there are @xmath0 antennas at the bs .",
    "fortunately , we do not need all these @xmath5 aoas of the same user for the hybrid precoding design , as we can see later . for a massive mimo system ,",
    "i.e. , @xmath36 , it is possible to recover all @xmath30 as well as @xmath37 since there are much more observations than unknown variables .     and",
    "@xmath38 , @xmath39.,width=491 ]    as in fig.[aoa_narrow_as_ly ] , we have the following assumption : _ the incoming aoas of any user are restricted in a small region , i.e. , @xmath40 $ ] for @xmath41 , where the angular spread @xmath42 .",
    "_ this happens when the bs is installed on very tall building and there are a limited number of surrounding scattering@xcite or when millimeter wave ( mmwave ) scenario is exploited@xcite .    with the above assumption ,",
    "@xmath43 s are very close to each other and @xmath8 s are highly correlated .",
    "hence , @xmath26 in ( [ eq : hkmatrix ] ) can be re - expanded more compactly by a much smaller number of steering vectors .",
    "denote    @xmath44\\end{aligned}\\ ] ]    as the dft matrix , where @xmath45 .",
    "it is obvious that @xmath46 .    as in fig.[aoa_narrow_as_ly ] , for any @xmath40 $ ] , denote @xmath47 , which decomposes the steering vector @xmath48 using inverse dft . from fig .",
    "[ aoa_narrow_as_ly ] , only the @xmath49th to the @xmath50th elements of @xmath51 will be significant , while other elements are negligibly small .",
    "therefore ,    @xmath52 \\nonumber \\\\ &",
    "= & \\mathbf f[\\mathbf a_{k,1},\\ldots,\\mathbf a_{k , p } ] \\nonumber \\\\ & \\approx & \\frac{1}{\\sqrt{m } } \\left [ \\begin{array}{ccccc } & 1 & \\ldots & 1 &   \\\\ \\ldots &   e^{-j2\\pi k_1\\delta f } & \\ldots & e^{-j2\\pi k_2\\delta f } & \\ldots \\\\ \\ldots & \\vdots & \\vdots & \\vdots & \\ldots\\\\ \\ldots & e^{-j2\\pi ( m-1)k_1\\delta f } & \\ldots & e^{-j2\\pi ( m-1)k_2\\delta f } & \\ldots \\end{array } \\right ] \\left [ \\begin{array}{ccc } \\vdots & \\vdots & \\vdots \\\\ 0 & \\ldots & 0",
    "\\\\ a_{k,1}(k_1 ) & \\ldots & a_{k , p}(k_1 ) \\\\ \\vdots & \\vdots & \\vdots \\\\ a_{k,1}(k_2 ) & \\ldots & a_{k , p}(k_2 ) \\\\ 0 & \\ldots & 0 \\\\ \\vdots & \\vdots & \\vdots   \\end{array } \\right ] \\nonumber \\\\ & = & \\tilde{\\mathbf a}_k \\left [ \\begin{array}{ccc } \\frac{a_{k,1}(k_1)}{\\sqrt{m } } & \\ldots & \\frac{a_{k , p}(k_1)}{\\sqrt{m } } \\\\ \\vdots & \\vdots & \\vdots \\\\ \\frac{a_{k,1}(k_2)}{\\sqrt{m } } & \\ldots & \\frac{a_{k , p}(k_2)}{\\sqrt{m } } \\end{array } \\right],\\end{aligned}\\ ] ]    where @xmath53,\\end{aligned}\\ ] ] and @xmath54 is the @xmath20th element of @xmath55 . from ( [ eq : hkmatrix ] ) , we have @xmath56 \\left [ \\begin{array}{c } \\frac{\\alpha_{k,1}}{\\sqrt{p } } \\\\ \\vdots \\\\ \\frac{\\alpha_{k , p}}{\\sqrt{p } } \\end{array } \\right ] \\nonumber \\\\ & = & { \\tilde { \\mathbf a}}_k { \\tilde { \\boldsymbol \\alpha}}_k , \\label{eq : gao2}\\end{aligned}\\ ] ] where @xmath57^t.\\end{aligned}\\ ] ] if @xmath58 is small , then @xmath59 is also small and @xmath60 . consequently , the decomposition of @xmath26 in ( [ eq : gao2 ] ) is much more compact than that in ( [ eq : hkmatrix ] ) , which facilitates channel estimation and hybrid precodng design in mu massive mimo systems .",
    "obviously , the accuracy of the approximation in ( [ eq : gao2 ] ) depends on @xmath0 , @xmath58 , @xmath61 , @xmath5 , as well as the instantaneous @xmath62 . with ( [ eq : gao2 ] )",
    ", now the aoa estimation becomes to estimate @xmath63 equivalent aoas or orthogonal  frequencies , \" namely @xmath64 , which can be done by applying the @xmath0-point dft on @xmath26 . in the following",
    ", we will not discriminate the term equivalent aoa and aoa , and also call estimating @xmath64 as aoa estimation .",
    "it is also noteworthy that the above aoa estimation is performed per user even if the users have some common paths because their channels @xmath26 can be estimated / separated first by orthogonal pilots .",
    "hence , the subsequent aoa estimation is immune to uplink iui caused by the common paths , which is not achievable by the conventional blind aoa estimation approaches .",
    "what we have done until now is exactly the spatial sampling in the area of array signal processing , where the sampling interval is @xmath65 and the number of samples is @xmath0 .",
    "recall @xmath27 , we know that decreasing @xmath65 will not affect the range of aoa estimation . increasing @xmath65 to over @xmath66 , the range of @xmath30 will be beyond the capable estimation range of @xmath67 .",
    "a well - known explanation is to consider @xmath65 as the sampling period in the time - domain sampling@xcite .",
    "a small @xmath65 will increase the sampling frequency , therefore will not affect the estimation . on the contrary , a @xmath65 larger than @xmath66 will cause aliasing .",
    "meanwhile , the dft actually transfers the spatial domain to the angle / beam domain .",
    "a natural question now is what can we benefit from the knowledge of the aoas ?",
    "since the aoas are obtained from the channels , one may expect that it can help design the dl precoding . for hybrid transmitter where there are a limited number of rf chains",
    ", we will show that the overall dl precoding can be decomposed into angular beamforming towards the users and the beam domain precoding that resolves the remaining iui . depending on",
    "whether the angular beamformings of different users are orthogonal or not , we provide the following two different designs , respectively .      since @xmath27 , we may estimate the _ cosine _ of the aoa rather than the aoa itself .",
    "therefore , the estimation has a uniform resolution on @xmath38 , but a non - uniform resolution on @xmath68 , as we can see in fig.[aoa_narrow_as_ly ] .",
    "the equally spaced @xmath38 forms an orthogonal beamspace ( obs ) with the corresponding steering vectors .",
    "another type of obs in @xcite is obtained from the eigenvector of the channel covariance matrix .",
    "however , such an eigenvector has no steering vector structure and the corresponding obs is determined by both the aoas and the path gains of the users .",
    "obviously , eigen - space beamforming is more accurate than the angle - space beamforming but the former requires the statistic knowledge of the channel , which is hard to obtain for massive mimo .",
    "furthermore , eigen - space beamforming is not suitable for hybrid transmission since the eigenvector lacks the steering vector structure and therefore requires full digital operation on each antenna weight .",
    "nevertheless , the angle - based obs can asymptotically approach the eigen - based one when the number of antennas at the bs , @xmath0 , is very large @xcite .    from the previous section , one way to project the channels of all @xmath2 users onto the obs",
    "can be done by the dft matrix @xmath69 with angular resolution @xmath1 and only a small number of orthogonal beams are significant .",
    "let @xmath70 denote the beam domain channel of the @xmath3th user .",
    "if the angle spread is with a small region , from ( [ eq : gao2 ] ) , @xmath71^t.\\end{aligned}\\ ] ] nevertheless , we use @xmath72 to represent the index set of @xmath73 elements of @xmath74 , whose magnitudes are larger than a threshold @xmath75 . obviously , @xmath76 is a subset of @xmath77 .",
    "the index of total beams occupied by @xmath2 users is given by @xmath78 whose size is denoted by @xmath79 .",
    "since the number of users is much fewer than the number of antennas at the bs , that is , @xmath80 and further considering the possible overlapped beams among different users , it is reasonable to assume that @xmath79 is much smaller than @xmath0 , that is @xmath81 . specifically , given the @xmath82 channel matrix @xmath83,\\end{aligned}\\ ] ] and denote @xmath84 then , only @xmath79 rows @xmath85 in @xmath86 have significant norms . by removing @xmath87 rows of @xmath86 with small norms",
    ", we have @xmath88 or @xmath89 , where @xmath90^{\\mathcal h } , $ ] and @xmath91 is the @xmath92th row of the @xmath93 dft matrix .    owing to the channel reciprocity , the dl channel is @xmath94 , where @xmath95 is an equivalent dl mimo channel whose size is @xmath96 .",
    "then , the corresponding dl precoding matrix is given by @xmath97 where @xmath98 and @xmath99 are the @xmath100 orthogonal beamforming matrix and the @xmath101 beam domain precoding matrix , respectively .",
    "because of @xmath102 , as long as @xmath103 , @xmath99 can be calculated from @xmath104 using the existing precoding schemes , for example , the well - known minimum - mean square error ( mmse ) precoding in @xcite .",
    "let the transmission power constraint be @xmath105 , the mmse precoder can be calculated as @xmath106 and then normalized by @xmath107 .",
    "since the beamforming vectors are orthogonal , no interference exists among formulated beams .",
    "the iui left is to be handled by the subsequent beam domain precoding matrix , which is much smaller in size .",
    "meanwhile , from ( [ precoder ] ) , it is clear that the obs - based precoding is a perfect match to the hybrid precoding since @xmath108 consists only phase shifters and can be implemented in the analog domain and @xmath99 is with much smaller size and can be implemented in the digital domain .",
    "furthermore , _ the aoa estimation resolution can be directly linked to the finite resolution of phase shifter in the analog precoding_.    let @xmath109 be the number of available rf chains .",
    "when @xmath110 , a beam selection process to find the best @xmath109 beams for transmission is necessary . in practical design ,",
    "@xmath109 is usually fixed and a smaller one is always better in terms of the cost .",
    "it is known that the minimum number of rf chains for a @xmath2-user system is @xmath2@xcite , we then can limit the following discussion to @xmath111 due to the stringent cost requirement , for example , in a mmwave massive mimo system .",
    "below , we provide a beam selection algorithm , which basically selects the most significant beam of each user by substituting @xmath111 into the function .",
    "obtain @xmath0 and @xmath2 from the size of @xmath86 return error @xmath112 record @xmath92 to @xmath76 record @xmath92 to @xmath113 @xmath114 and record its size @xmath79 form the matrix @xmath115 from @xmath86 using @xmath116 sort the rows of @xmath115 in descending order of norm reorder @xmath116 accordingly let @xmath117 be the first @xmath118 indexes of @xmath119 return @xmath120 return @xmath116      the obs based scheme relies on the fixed - directional beams towards the equally spaced aoas due to the usage of the @xmath93 dft matrix .",
    "hence , obs has two critical drawbacks :    * the aoa resolution is only @xmath1 ; * the orthogonal beams obtained may not necessarily point to the strongest direction of users , and thus will suffer some performance loss .    if the aoa of the user is not exactly an integer times of @xmath1 , then the dft leakage will cause wider beam occupancy and subsequently a large @xmath79 . in other words , the orthogonal beamforming constraint may bring unnecessary beam spread .",
    "since we only have @xmath2 rf chains , that is , one beam for each user , it is desirable to improve the accuracy of the analog beamforming such that the beam domain channel gain of a single element can be maximized .",
    "an effective way is to consider non - orthogonal beams to suppress the dft leakage and narrow the beam spread .    for the cs based beamforming @xcite",
    ", there is no obvious way to form non - orthogonal beams because the dictionary matrix should be predesigned . on the contrary , for angle - based beamforming , the non - orthogonal beams can be easily obtained via rotating the beam by a small angle such that the beams will point to the strongest direction of the users .",
    "for rotating obs , let us introduce a refining angle for each user .",
    "denote @xmath121 to be the refining angle for user @xmath3 , and @xmath122 we can also denote @xmath123 similar to ( [ gkapprox ] ) , we can calculate @xmath124 then , the optimal refining angle for the @xmath3th user will be determined by @xmath125 where @xmath126 is the maximum element of @xmath127 and the position of @xmath126 in @xmath127 is denoted as @xmath128 .",
    "the estimation of the optimal refining angle in ( [ bia ] ) needs a one - dimensional search over the range in ( [ iar ] ) .",
    "however , bearing in mind that @xmath129 is a small @xmath38 , we actually need a high resolution  frequency \" estimation via digital approach with finite grid . with the dft operation",
    ", such high resolution estimation can be performed by padding zeros at the end of channel vector .",
    "let @xmath130 be an integer lager than @xmath131 , we can calculate @xmath132,\\end{aligned}\\ ] ] where @xmath133 is the @xmath134 dft matrix .",
    "then , we can obtain @xmath130 vectors @xmath135 where the @xmath136th vector @xmath137 is formed by the @xmath138th entry of @xmath139 with @xmath140 . from the basic sampling theory , we know @xmath141 which implies that the cost function in ( [ bia ] ) is evaluated for @xmath142 .",
    "then , one can easily obtain @xmath143 and @xmath128 by comparing the @xmath144 elements in @xmath137 , @xmath145 .",
    "compared to the original @xmath146 , the beam domain resolution improves from @xmath1 to @xmath147 , as illustrated in fig .",
    "[ beamsinc ] with @xmath148 for a simple case of @xmath149 .",
    "hence , a valid approximation to @xmath150 with one beam vector is written as @xmath151 where @xmath152 is the @xmath128th row of @xmath153 .",
    "in fact , steps ( [ gvm ] ) to ( [ eq : gao3 ] ) can be viewed as high - resolution aoa estimation for the @xmath3th user .",
    "since we have @xmath0 spatial samples of the user channel , the @xmath0-point dft only provide @xmath0 angle / beam domain responses within a  bandwidth \" of @xmath154 .",
    "the zero - padding and the @xmath144-point dft actually further divide the  bandwidth \" by @xmath144 to obtain @xmath144 angle / beam domain responses .    the overall channel matrix for all @xmath2 users can be approximated by @xmath155,\\end{aligned}\\ ] ] for which the strongest beam of each user channel is chosen and is handled with only one rf chain .",
    "hence , the non - orthogonal analog beamforming vector for the @xmath3th user can be selected as @xmath156 .",
    "bearing in mind that @xmath157 is a diagonal matrix , the analog precoding matrix becomes @xmath158^t.\\end{aligned}\\ ] ] the @xmath2 non - orthogonal beams @xmath159 actually form a non - orthogonal beamspace , or strictly speaking , non - orthogonal angle space ( noas ) , pointing to the strongest direction of each user while the caused inter beam interference ( ibi ) will be handled by the digital precoding part . with the noas - based beamforming , the precoding matrix @xmath160 can be calculated from @xmath161 , where the calculation of @xmath162 can be significantly simplified using the result in ( [ ckn ] ) .",
    "the structure of the proposed noas - based hybrid precoding schemes is shown in fig .",
    "[ noas ] . in practice , the phase shifter with continuous variable phase is not only inaccurate but also expensive .",
    "in contrast , a phase shifter with finite phase shift is with low - cost and can be controlled precisely . in the obs - based hybrid precoding ( @xmath163 ) , we basically need @xmath164 phase shifters with a relatively - lower resolution of @xmath1 .",
    "the high - resolution noas - based hybrid precoding ( @xmath165 ) requires @xmath164 phase shifters with a high resolution of @xmath166 .",
    "therefore , only finite resolution phase shifters are required in the proposed hybrid precoding scheme and a low - cost implementation is possible .",
    "till now , there are three beamforming methods in the literatures from different space viewpoint , which are summarized as follows :    1 .   as in fig .",
    "[ fig:1a ] , the eigen - space method utilizes the best eigen - directions for beamforming @xcite , @xcite .",
    "specifically , the beamforming vectors of this method do not physically formulate beams towards users but rather change the amplitude and the phase of each antennas such that the optimal signal - to - interference - noise ( sinr ) ratio ( or other criterion ) can be achieved at users .",
    "hence , the method is only valid for full digital operation .",
    "2 .   as in fig .",
    "[ fig:1b ] , the angle - space method utilizes the orthogonal steering vectors for beamforming , as proposed in section iv.a and in @xcite , @xcite ( sometimes called beamspace method ) .",
    "specifically , the beamforming vectors of this method are chosen from the steering vectors with equally spaced @xmath38 , such that the beamforming vectors physically formulate orthogonal beams towards the fixed directions .",
    "however , the beam directions generally do not point to the exact directions of users and will suffer from power leakage , since users are randomly distributed .",
    "this method is valid both for full digital and hybrid operation .",
    "3 .   as in fig .",
    "[ fig:1c ] , the angle - space method utilizes the non - orthogonal steering vectors for beamforming , as presented in section iv.b .",
    "specifically , the beamforming vectors of this method are also chosen from the steering vectors but the beams point to the exact directions of users .",
    "hence , the beams are non - orthogonal to each other and there will be ibi . this method is valid both for full digital and hybrid operation .",
    "the observation from the spatial and the angle / beam domains implies that in the case of single user , the ula - based massive mimo system can be viewed as an orthogonal beam division multiplexing ( obdm ) system ( with more than one rf chains for this user from orthogonal columns of dft matrix ) , which is analogous to the orthogonal frequency division multiplexing ( ofdm ) system as compared in table i. it is then clear that the existing research results of ofdm systems can be directly applied to the su massive mimo system by projecting the user channel onto the dft - based obs .    .obdm versus ofdm [ cols=\"^,^\",options=\"header \" , ]     on the other hand , for the case of multi - user multiple access , there is a fundamental difference between the massive mimo and the orthogonal frequency division multiple access ( ofdma ) systems . in ofdma systems ,",
    "the bandwidth is defined on the frequency domain , and therefore and the orthogonality among different users can be easily maintained .",
    "in contrast , the `` bandwidth '' in the massive mimo systems is defined on the angle / beam domain and depends on the users spatial location .",
    "therefore the orthogonality among different users is out of our control .",
    "consequently , an mu massive mimo system could either be an orthogonal adma system by using obs or be a non - orthogonal adma system by using noas , where the former removes ibi with the sacrifice on power leakage while the latter does reversely .",
    "it can then be imagined that when the number of the rf chains is very small , the power leakage will be the dominant issue and noas would performs better , while when the number of the rf chains is very large , the power leakage is very small and the obs may perform better .",
    "all previous discussions are based on the availability of channel matrix @xmath167 and the corresponding aoas . with limited rf chains ,",
    "such channel estimation is normally obtained by sequentially sending the pilot and sweeping the beam on all directions , named as beam cycling @xcite . however , from the angle domain viewpoint , it is possible to reduce the amount of beam sweeping , and thus greatly reduce the training overhead .",
    "let @xmath168 denote the @xmath169 unitary pilot matrix in the ul .",
    "the received pilot signal at the bs is @xmath170 where the additive white gaussian noise has been ignored for the sake of convenience .",
    "let us consider the phase shifters at the rf chains as an analog combiner represented by a @xmath171 matrix @xmath172 .",
    "then , we right - multiply the output of the @xmath2 rf chains by @xmath173 and left - multiply by @xmath172 to obtain a @xmath169 matrix @xmath174 where we have used the property of @xmath175 .",
    "we next explore the sparsity of @xmath167 in the angle domain to recover @xmath176 from @xmath177 .",
    "the similarity of adma to the ofdm / ofdma system inspires us that we are actually dealing a problem similar to frequency domain ofdma channel estimation .",
    "in particular , we know that the user channel is quite sparse in frequency domain even if we do not know the position",
    ". moreover , due to the limited number of rf chains , we only have part of its spatial ( time ) domain impulse response depending on how the rf chains are connected to antennas .",
    "the problem becomes _ ofdm sparse frequency domain channel estimation with insufficient impulse response _ .    due to the orthogonal pilots , these portions of user channels have been separated ,",
    "namely , the @xmath3th column of @xmath177 can be expressed as @xmath178 since we do not know the aoa information of the users , we require the training @xmath168 to be sent twice .",
    "the key idea is that if the index of significant beams in ( [ dotgindex ] ) is known , i.e. , the aoa information , we can let the phase shifters at each row of the analog combiner @xmath172 act as the corresponding rows of the dft matrix to obtain @xmath177 , which will become a fine estimate of the angle / beam domain response of the spatial channel @xmath167",
    ". in other words , each row of the analog combiner can become a _ receive beamformer _ if the aoa information is available .",
    "for the current case of @xmath2 rf chains , we actually need to know the index of the most significant beam ( imsb ) for each user .",
    "hence , in the first time training , we target at roughly achieving the aoa information of each user . without loss of generality , we propose the following structure for the analog combiner matrix , @xmath179,\\end{aligned}\\ ] ] that is , we simply connect @xmath2 rf chains to the first @xmath2 antennas .",
    "then , from the previously discussions , we can apply the dft approach to achieve aoa estimation by @xmath180.\\end{aligned}\\ ] ] since @xmath181 is the dft of an deficient sampling of @xmath26 , @xmath181 does not have the same envelope as @xmath74 but is rather a `` fatter version '' of @xmath74 . hence , @xmath181 would have the its maximum value at a position close to that of @xmath182 .",
    "an example of @xmath74 and @xmath183 calculated from a normalized @xmath26 is given in fig .",
    "[ zp ] with @xmath184 , @xmath185 , and @xmath149 . from the figure , @xmath181 and @xmath182 ,",
    "though with different shape , would have the same maximum value at the same position . therefore , we can obtain an estimate of imsb from @xmath181 in the first place .    th user .",
    ", width=340 ]     +      when @xmath163 , i.e. , the obs scheme , let @xmath186 be the imsb of the @xmath3th user .",
    "the analog combiner @xmath187 at the second time training is set as @xmath188^t.\\end{aligned}\\ ] ] with @xmath187 , which is exactly an obs - based receive beamformer , we can obtain @xmath189 in fact , @xmath190 can be considered as a size - reduced approximation of the beam domain equivalent mimo channel @xmath115 . for @xmath165 , i.e. , noas scheme",
    ", we can obtain an approximation of @xmath161 because @xmath187 becomes the noas - based receive beamformer .",
    "in summary , the proposed channel estimation approach includes two steps , the imsb estimation and the beam domain channel estimation ( @xmath163 ) , which are shown in fig . [ fig_bdoe ] and fig .",
    "[ fig_bdce ] , respectively .",
    "since the dl transmitting and the ul receiving share the same beamforming vectors , once the analog receive beamformer @xmath187 is fixed , the dl transmission is just the calculation using the digital precoding matrices , corresponding the obs or the noas based beamformers , respectively .    for conventional beam cycling based hybrid channel estimation @xcite , it needs to sweep the beam over all @xmath0 antennas , which costs @xmath191 times of training . in comparison ,",
    "the proposed method needs two times of training , which greatly saves overhead .",
    "in this section , we will present simulation results to verify our discussion before . in our simulation",
    ", we consider a tdd massive mimo system , where the ula at the bs has @xmath184 antennas .",
    "there are @xmath2 single - antenna users uniformly located inside a semicircular cell with a radius of one kilometer , and the users angular spread is @xmath192 . the channel fading coefficients are generated from the urban micro model in the 3gpp standard @xcite with @xmath193 .",
    "the path loss is given by @xmath194 where @xmath195 is the distance between a user to the bs , and @xmath196ghz .",
    "also , a bulk log normal shadowing with a standard deviation of @xmath197 db is applied to all sub - paths . for the ul training , the signal - to - noise ratio ( snr ) observed at the bs is @xmath198 db . for the dl precoding ,",
    "the bs power constraint is @xmath199 dbm , and the noise variance at the user side is @xmath200 dbm .",
    "the proposed noas - based hybrid precoding ( noas - hp ) and the obs - based hybrid precoding ( obs - hp ) are compared with the matched filter based maximum ratio transmission ( mrt ) precoding and the mmse precoding in terms of sum - rate .",
    "the mrt and the mmse precodings are full - digital ( fd ) while the digital part in the proposed hybrid precoding schemes is an mmse precoder .",
    "+     the cumulative distribution funciton ( cdf ) of the sum rate of all @xmath2 users are shown in fig .",
    "[ fig : cdf ] for different @xmath2 and @xmath58 , respectively . from fig .",
    "[ cdf1 ] and fig .",
    "[ cdf2 ] , it can be seen that when the angular spread is @xmath201 , both the proposed obs- and noas - based hybrid precoding schemes combined with the proposed channel estimation significantly outperform the mrt .",
    "the reason is that when @xmath0 is not infinitely large and when the channel paths are not infinitely rich ( @xmath193 ) , then the real channel @xmath150 s have very poor orthogonality .",
    "however , our angle domain approaches do not require such property and hence the performances are satisfactory .",
    "especially , the noas - based hybrid precoding scheme presents performance very close to the high - complexity all - digital mmse precoding because it forms more `` focusing '' beams to increase the gain of the equivalent mimo channel . for the same reason",
    ", the noas - based scheme has the sum rate @xmath202 bps / hz higher than that of the obs - hp . with larger angle spread of @xmath203 , the results in fig .",
    "[ cdf3 ] and fig .",
    "[ cdf4 ] show that mrt is still not good while mmse becomes apparently better than the proposed methods .",
    "the reason is that the proposed methods assign only @xmath2 rf chains for @xmath2 users , i.e. , one rf chain per user . in this case",
    ", the one beam approximation of the whole channel would become worse as @xmath58 increases .",
    "nevertheless , such performance degradation could be mitigated if more rf chains are available for transmission , say in full digital transmission .",
    "moreover , the performance gap between the obs - hp and the noas - hp narrows down to around @xmath34 bps / hz because a single rotation would not catch more power of the channel with a single beam compared with non - rotation case under wide angular spread .",
    "hence , in terms of throughput , the proposed hybrid schemes , especially the noas one , are more suitable for narrow angular spread scenario , such as in the mmwave case .",
    "figure [ nmse ] demonstrates the normalized mse of the proposed channel estimation for different @xmath2 . from the figure , with the increase of snr , both methods performs better but",
    "will meet an error floor at a high snr . in all cases ,",
    "the noas - based channel estimation can achieve better nmse performance than the obs - based estimation because it forms more `` focusing '' beams towards the strongest direction of the users by sacrificing the orthogonality among users .",
    "meanwhile , increasing @xmath2 also increases the number of rf chain .",
    "the reason is that we assume @xmath2 spatial sampling in the first around and increasing @xmath2 will improve the accuracy of imsb estimation , which in turn results in a better estimation performance .",
    "moreover , the performance gap between the noas - based channel estimation and the obs - based one reduces as @xmath2 increases , because when @xmath2 is large , the step one can already provide good prediction of imsb with @xmath163 .    .",
    ", width=340 ]",
    "in this paper , we have proposed a novel hybrid transmission scheme for a mu massive mimo system from the array signal processing perspective .",
    "efficient channel estimation and aoa estimation algorithms under limited rf chains have been investigated . with the aoa information",
    ", the channel matrix can be decomposed into an angle domain basis matrix and the corresponding angle domain channel matrix .",
    "we then present two adma schemes , i.e. , the orthogonal obs and the non - orthogonal noas , to serve multiple users wth hybrid precoding .",
    "it has been shown that by pointing to the strongest direction of the user , the noas scheme can alleviate power leakage effect and performs better than the obs .",
    "from ( [ eq : hkmatrix ] ) , the orthogonality between two user channel vectors @xmath26 and @xmath204 can be measured by the correlation @xmath205 where @xmath206 .",
    "the @xmath207th entry of @xmath208 can be written as @xmath209 where @xmath210 . since @xmath19 for @xmath211 , @xmath212 for @xmath211 .",
    "therefore , @xmath213 is bounded as @xmath36 , and @xmath214 .",
    "similar to ( [ ckn ] ) , we have @xmath215 and @xmath216 for @xmath217 .",
    "direct calculation yields that @xmath218 and therefore @xmath219 .",
    "99 e. g. larsson , f. tufvesson , o. edfors , and t. l. marzetta ,  massive mimo for next generation wireless systems , \" _ ieee commun .",
    "2 , pp . 186195 , feb . 2014 .",
    "f. rusek , d. persson , b. k. lau , e. g. larsson , t. l. marzetta , o. edfors , and f. tufvesson ,  scaling up mimo : opportunities and challenges with very large arrays , \" _ ieee signal process . mag .",
    "4060 , jan . 2013 .",
    "l. lu , g. y. li , a. l. swindlehurst , a. ashikhmin , and r. zhang ,  an overview of massive mimo : benefits and challenges , \" _",
    "ieee j. sel .",
    "topics signal process . _ , vol . 8 , no .",
    "5 , pp . 742758 , oct . 2014 .",
    "t. l. marzetta ,  noncooperative cellular wireless with unlimited numbers of base station antennas , \" _ ieee trans .",
    "wireless commun .",
    "_ , vol . 9 , no . 11 , pp .",
    "35903600 , nov .",
    "2010 .",
    "y. liu , z. qin , m. elkashlan , et al .",
    ", `` enhancing the physical layer security of non - orthogonal multiple access in large - scale networks , '' to appear in _ ieee trans . on wireless commun .",
    "_ , available at arxiv preprint arxiv:1612.03901 , 2016 .",
    "r. hoshyar , f. p. wathan , and r. tafazolli , `` novel low density signature for synchronous cdma systems over awgn channel , '' _ ieee trans .",
    "signal prococessing _ , vol .",
    "4 , pp . 16161626 , apr . 2008 . m. al - imari et al . , `` uplink nonorthogonal multiple access for 5 g wireless networks , '' _ proc .",
    "wireless commun .",
    "2014 , pp . 781785 .",
    "h. nikopour and h. baligh , `` sparse code multiple access , '' _ in proc . of inter .",
    "symp . on pers .",
    ", ind . and mob .",
    "( pimrc ) _ , sept .",
    "2013 , pp . 332336 .",
    "z. yuan , g. yu , and w. li , `` multi - user shared access for 5 g , '' _ telecommun .",
    "network technology _ , vol . 5 , no .",
    "5 , pp . 2830 , may 2015",
    ". j. huang et al . , `` scalable video broadcasting using bit division multiplexing , '' _ ieee trans . broadcast .",
    "701706 , dec . 2014 .",
    "k. kusume , g. bauch , and w. utschick , `` idma vs. cdma : analysis and comparison of two multiple access schemes , '' _ ieee trans .",
    "wireless commun .",
    "1 , pp . 7887 , jan .",
    ". m. xia , y .- c .",
    "wu , and s. aissa ,  non - orthogonal opportunistic beamforming : performance analysis and implementation , \" _ ieee trans . wireless .",
    "4 , pp . 14241433 , apr . 2012 .",
    "a. alkhateeb , o. e. ayach , g. leus , and r. w. heath jr . , ",
    "channel estimation and hybrid precoding for millimeter wave cellular systems , \" _ ieee j. sel .",
    "topics signal process . _ , vol .",
    "5 , pp . 831846 , oct . 2014 .",
    "j. wang , z. lan , c .- w .",
    "pyo , t. baykas , et al . , ",
    "beam codebook based beamforming protocol for multi - gbps millimeter - wave wpan systems , \" _ ieee j. sel .",
    "areas commun .",
    "27 , no . 8 , pp .",
    "13901399 , oct .",
    "r. w. heath , n. g. prelcic , s. rangan , w. roh , and a. sayeed , `` an overview of signal processing techniques for millimeter wave mimo systems , '' _ ieee j. sel .",
    "topic signal process .",
    "436453 , apr .",
    "2016 .",
    "j. tsai , r.m .",
    "buehrer , b.d .",
    "woerner ,  the impact of aoa energy distribution on the spatial fading correlation of linear antenna array , \" _ proc .",
    "ieee vtc spring _ , 2002 .",
    "h. yin , d. gesbert , m. filippou , and y. liu ,  a coordinated approach to channel estimation in large - scale multiple - antenna systems , \" _ ieee j. sel .",
    "area commun .",
    "2 , pp . 264273 , feb . 2013 .",
    "a. adhikary , j. nam , j. -y ahn , and g. caire ,  joint spatial division and multiplexing : the large - scale array regime , \" _ ieee trans .",
    "inf . theory _",
    "64416463 , oct .",
    "c. sun , x. gao , s. jin , m. matthaiou , z. ding , and c. xiao ,  beam division multiple access transmission for massive mimo communications , \" _ ieee trans .",
    "63 , no . 6 , pp",
    ". 21702184 , june 2015 .",
    "x. gao , o. edfors , f. tufvesson , and e. g. larsson , `` massive mimo in real propagation environments : do all antennas contribute equally ? '' _ ieee trans .",
    "39173928 , july 2015 .",
    "m. joham , k. kusume , m. h. gzara , w. utschick , and j. a. nossek ,  transmit wiener filter for the downlink of tddds - cdma systems , \" _",
    "ieee 7th international symposium on spread spectrum techniques and applications _ , 2002 , pp .",
    "913 .    c. b. peel , b. m. hochwald , and a. l. swindlehurst ,  a vector - perturbation technique",
    "for near - capacity multiantenna multiuser communcations - part i : channel inversion and regularization , \" _ ieee trans .",
    "1 , pp . 195202 , jan ."
  ],
  "abstract_text": [
    "<S> this paper introduces a new view of multi - user ( mu ) hybrid massive multiple - input and multiple - output ( mimo ) systems from array signal processing perspective . </S>",
    "<S> we analyze a time division duplex massive mimo system where the base station ( bs ) is equipped with a uniform linear array and each user has a single antenna , and show that the _ instantaneous _ channel vectors corresponding to different users are asymptotically orthogonal as the number of antennas at the bs goes large when the angles of arrival ( aoas ) of users are different . applying the discrete fourier transform ( dft ) , </S>",
    "<S> the _ cosine _ of aoa can be estimated with a resolution inverse proportional to the number of antenna at the bs , and this resolution can be enhanced via zero padding technique with fast fourier transform ( fft ) . </S>",
    "<S> we then decompose the channel matrix into an angle domain basis matrix and the corresponding channel matrix . </S>",
    "<S> the former can be formulated by steering vectors and the latter has the same size as the number of rf chains , which perfectly matches the structure of hybrid precoding . </S>",
    "<S> hence , the mu massive mimo system with the proposed hybrid precoding can be viewed as angle division multiple access ( adma ) , either orthogonal or non - orthogonal , to simultaneously serve multiple users at the same frequency band . </S>",
    "<S> based on the new view of hybrid massive mimo , a novel hybrid channel estimation is designed and can save much overhead compared to the conventional beam cycling method . </S>",
    "<S> finally , the performance of the proposed scheme is validated by computer simulation results .    </S>",
    "<S> massive mimo , angle division multiple access ( adma ) , angle of arrival ( aoa ) , channel estimation , hybrid precoding . </S>"
  ]
}