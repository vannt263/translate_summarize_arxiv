{
  "article_text": [
    "gravitational lensing provides an important technique to study the matter distribution in the universe ( e.g. , kochanek , schneider & wambsganss 2004 ) . on galaxy - scales ,",
    "simple smooth isothermal models appear to match the gravitational lenses reasonably well ( e.g. , kochanek 1991 ) , although there are some difficulties in accurately reproducing the observed flux ratios . at present , it is unclear what causes these `` anomalous flux ratios '' ( e.g. , kochanek & dalal 2005 ; mao et al .",
    "2004 ; macci et al .",
    "2006 ; macci & miranda 2006 ) . on cluster scales , it became clear early on that smooth spherical models under - predict the number of giant arcs by orders of magnitude ( e.g. , bartelmann & weiss 1994 ; bartelmann et al . 1995 ; bartelmann et al .",
    "ellipticity and substructures in clusters have dramatic effects on the lensing cross - sections of giant arcs .",
    "this is because many massive clusters are more or less super - critical , so a small change in the surface density or the shear can have a large nonlinear effect on the lensing properties .",
    "the effects of ellipticity and substructures are difficult to model analytically . the most realistic way to account for these is to use numerical simulations .",
    "@xmath0-body simulations can accurately track the evolution of dark matter particles to highly non - linear regimes .",
    "state - of - the - art simulations can resolve dark matter haloes with several million ( or more ) particles within the virial radius . even at such high resolutions ,",
    "each particle in the simulation is only a monte carlo realization of the underlying ( smooth ) density field . to predict the lensing properties of the discrete particle distributions ,",
    "the first step is to obtain an accurate smoothed surface density field .",
    "the fluctuations of the smoothed surface density maps directly affect the shapes , magnifications and orientations of images , and as a consequence , the lensing cross - sections and optical depths .",
    "in addition , high - resolution @xmath0-body simulations indicate that there are also many substructures in galaxies and clusters of galaxies .",
    "a good smoothing algorithm must be able to obtain a surface density map with sufficiently low noise level while retaining the information of substructures .",
    "previous workers have proposed many different algorithms for smoothing .",
    "bartelmann et al .",
    "( 1998 , hereafter b98 ) used a three - dimensional gaussian kernel to calculate the density on a three - dimensional grid and then integrate along the line of sight to obtain the surface density .",
    "bradac al . (",
    "2002 ) directly obtained the surface density using a gaussian kernel with a fixed smoothing length on the projected particle distributions .",
    "( 2005 ) and macci et al .",
    "( 2006 ) used adaptive kernels commonly used in the smoothed particle hydrodynamics ( sph ) with similar numbers of neighbors to obtain the surface density .",
    "the most complex method was used by bradac et al .",
    "( 2004 ) who obtained the volume density using the delaunay tessellation field estimator ( schaap & van de weygaert 2000 ) . and",
    "then projected the 3d density onto a 2d grid .",
    "other methods can also operate on a 2d particle distribution with simple smoothing kernels , such as the nearest grid points , cloud - in - cell , and triangular shaped clouds ( see bartelmann 2003 for a review ) .",
    "it is straightforward to show that for smoothing kernels ( such as gaussian kernels ) with a fixed smoothing length , the same results are obtained if one directly smoothes the 2d projected particle distribution or if one first obtains the three - dimensional density distribution and then performs the projection .",
    "furthermore , the noise levels from these two methods are identical .",
    "therefore , if one uses smoothing kernels with a fixed length , there is no need to perform the smoothing in 3d , one can simply perform the smoothing on the projected particle distributions , saving both memory and cpu time . of course , the particles in the @xmath0-body simulations are not really infinitesimal points , they in fact represent monte carlo realizations of a small but finite volume in the phase space .",
    "the volume a particle occupies is inversely proportional to the local mass density : in high density regions , the particles occupy a smaller volume and vice versa .",
    "adaptive smoothing is therefore essential to account for the large variation in the local densities .    in general , the noise level is higher if one first projects the particle positions to 2d and then smoothes the density rather than first smoothing the density in 3d and then performing the projection",
    "this is because in the first method , when we use adaptive smoothing ( e.g. , for a fixed number of neighbors in sph ) , there is an extra noise contribution due to chance alignments .",
    "this effect is particularly serious for low - density regions .",
    "in addition , substructures will be more difficult to identify in the projected particle distributions .",
    "it is therefore important to adaptively smooth the density field in 3d and perform the projection afterwards , in order to reduce the noise level and retain the substructures .",
    "the delaunay tessellation field estimator used by bradac et al .",
    "( 2004 ) is a significant step , but the method , as the authors pointed out , is quite time - consuming . to improve the computational efficiency ,",
    "ascalibar & binney ( 2004 ) proposed a new method , fiestas , which can calculate the phase - space density distribution ( in 6d ) efficiently .",
    "however , in this method , there is some ambiguity about the smoothing length and kernel . in this paper , we concentrate on the sph smoothing in 3d , and show that it can be used to obtain low - noise surface density maps while at the same time retaining the substructures . in  2 , we discuss our method . in  3 , we study the noise properties of the method for a uniform density field and an isothermal ellipsoid ; analyses of noise properties for these simple cases have not yet been performed in great detail in the literature ( see lombardi & schneider for a general discussion ) .",
    "we then take a cluster from cosmological simulations of structure formation , and study the reality of high - order singularities , and how they are connected with substructures and satellite streams . as shown by bradac et al .",
    "( 2004 ) , these tend to produce large flux anomalies compared with simple analytical predictions , so it is crucial to check what produced these and whether they are real and not from numerical noise . for this purpose",
    ", we also present a detailed comparison between our method and the delaunay tessellation method ( schaap & van de weygaert 2000 ) used by bradac et al .",
    "( 2004 ) for their simulated galaxy . in  4",
    ", we discuss the implications of our results on the detections of substructures in lensing galaxies and clusters .",
    "the central idea of the new smoothing algorithm is to use the three - dimensional density field information , but smooth the density in two - dimensions with sph kernels .",
    "( our method also applies to gaussian smoothing kernels , as long as we choose the smoothing length accordingly . ) specifically , we first choose the smoothing length according to the number of neighbors ( @xmath1 ) in 3d .",
    "the sph smoothing kernel is given by @xmath2 where @xmath3 is the number of dimensions , @xmath4 is a normalization with the values : @xmath5 , @xmath6 , @xmath7 in one , two and three dimensions respectively , and @xmath8 is the radius of a sphere ( or a circle in 2d and half - length in 1d ) which contain all the neighbours .",
    "this method is fully adaptive : for high - density regions , the smoothing length will be smaller and vice versa .",
    "once the smoothing length is determined , we distribute the particle mass onto the surrounding grid points . the weights are derived from the sph kernel in two dimensions , using the particle s smoothing length and its distance from the grid point in the projection plane .",
    "this corresponds to the `` scatter '' method in calculating the density in sph , see hernquist & katz ( 1989 ) . the smoothed surface density on a grid point along any projection",
    "can then be obtained by simply adding up the contributions of all the grid points that have non - vanishing contributions .",
    "we refer our method as the `` scatter and integrate '' ( si ) method .",
    "this method uses three - dimensional density information , but as the partition of the particle weight onto the grid points is performed only once , it can be implemented efficiently .",
    "in the following , we will apply our method and examine its performance in three cases .",
    "1 ) a uniform density field , in order to understand the noise property of this method ; 2 ) an isothermal ellipsoid ; in this case , we will examine how different smoothing methods reproduce the well - known analytical critical curves and caustics .",
    "we will also check whether noise can produce high - order singularities such as swallowtails .",
    "3 ) a simulated galaxy cluster taken from jing & suto ( 2002 ) . for this cluster , we will check how well the ( sub)structures are preserved in the smoothed surface density maps , and how they affect high - order singularities and the cusp relation in different smoothing methods in  [ sec : cluster ] . in  3.4",
    ", we make detailed comparisons of our method with the delaunay tessellation method for the simulated galaxy used by bradac et al .",
    "( 2004 ) .",
    "we randomly generate @xmath9 point particles in a cube with a unit sidelength .",
    "we use @xmath10 , and 3072000 ; they roughly span the range found from low - resolution to high - resolution simulated clusters within the virial radius . for each simulated cube , we then obtain the volume density @xmath11 at 4000 random positions in 3d using the sph kernel with @xmath12 , and the surface density @xmath13 on a @xmath14 grid using the si method we discussed above and the standard 2d sph smoothing with the same number of neighbors , @xmath1 .",
    "obviously both the volume and surface densities have an expectation value of unity , @xmath15 and @xmath16 .    the left panel in fig .",
    "[ fig : formula ] shows the noise behavior for the volume density .",
    "the standard deviation of the volume density can be well fitted as . if we smooth the density field using sph kernels directly in the projected particle distribution , we find that = 1.698   _ | [ eq:2d ] the factor @xmath17 arises because the noise contribution along the line of sight has been eliminated due to integration .",
    "if we use the scatter and integrate ( si ) method discussed above , we find that the noise scales as ( _ |)_si=1.627 ^1/3 ^1/6 [ eq : si ] this fitting formula matches the noise properties in our simulations quite well , as can be seen in fig .",
    "[ fig : formula ] .",
    "it may appear that eqs .",
    "( [ eq:2d ] ) and ( [ eq : si ] ) are very different .",
    "in fact , for the same fixed smoothing length , these two formulae are related . in the following arguments , to avoid confusion , we label the number of neighbor in 2d and 3d explicitly . for an @xmath18 neighbor in 3d , the smoothing length scales as @xmath19",
    ". the number of neighbors in 2d will be @xmath20 .",
    "putting this into eq .",
    "( [ eq:2d ] ) yields @xmath21 , identical to the dependence on @xmath9 and @xmath1 as given in eq .",
    "( [ eq : si ] ) . for a non - uniform field , however , our method will yield a more exact local density since the chance alignments due to projections are eliminated and , more importantly , the information of substructures and voids is better kept .",
    "we will illustrate these in  [ sec : nbody ] .",
    "[ sec : uniform ]      isothermal ellipsoids ( e.g. , kormann , schneider & bartelmann 1994 ; keeton & kochanek 1998 ) are reasonable models for galaxy - scale lenses .",
    "they have analytical critical curves and caustics , so they offer an ideal model to test and calibrate different smoothing algorithms .",
    "we generated many realizations of an oblate isothermal cluster .",
    "its physical density is given by ( cf .",
    "2 in keeton & kochanek 1998 ) @xmath22 where @xmath23 is the circular velocity of the halo , @xmath24 is the core radius , @xmath25 is the ratio of the minor axis to the other two equally long axes , and @xmath26 .",
    "we take @xmath23 to be 1500@xmath27 , @xmath28kpc , and @xmath29 .",
    "the cluster is viewed along one of the two major axes , resulting in elliptical isophotes with an axial ratio of 0.5 .",
    "we generate particles within a cube of sidelength of @xmath30 .",
    "below we present the results from two realizations .",
    "the low - resolution simulation has a total of @xmath31 particles in the box , each with mass @xmath32 , while the high - resolution simulation has @xmath33 and @xmath34 . here , @xmath35 is the hubble constant in units of @xmath36 .",
    "they roughly span low - resolution and high - resolution clusters typically found in numerical simulations .",
    "the redshift of the lens and source are taken to be 0.3 and 1.0 respectively , and we assume the @xmath37cdm cosmological model ( see  [ sec : cluster ] ) .",
    "different @xmath38 maps on a 2048@xmath39 2048 grid are produced by the 2d sph and si method for these two monte - carlo simulations .",
    "the lensing potential is then obtained using the fast fourier transform method ( bartelmann et al . 1998 ) . to resolve the critical curves well ,",
    "we perform cubic spline interpolations of the lensing potential on a finer grid ( li et al .",
    "at the same time , we derive the magnification and the lens mapping from the image plane to the source plane on the whole grid . to locate the critical curves",
    ", we use the fact that they separate regions of different signs of magnifications in the image plane ( see , e.g. , bartelmann 2003 for a practical implementation ) .",
    "[ fig : shapem1.6 ] shows the surface density obtained for the low - resolution simulation for different smoothing algorithms and parameters together with the predicted analytical surface density .",
    "the surface density is plotted as a function of the ellipsoidal radius .",
    "as can be seen , the analytical surface density is reproduced quite well by both the 2d sph and the si method , except in the inner - most regions where the numerical results are lower due to smoothing .",
    "the noise in the surface density is obtained from the fluctuations in the surface density of all pixels within each elliptical annulus . for the 2d sph smoothing , this is a function of the number of neighbors only , and is independent of @xmath9 or the distribution of the surface density .",
    "( [ eq:2d ] ) appears to match the noise in the data quite well ( see the top panels in fig .",
    "2 ) . on the other hand , for the si method",
    ", the surface density is obtained by an integration of the volume density along the line of sight . while the relative error of the volume density only depends on the number of neighbors used , the absolute error depends on the local density through the integration along the line of sight . from the lower panels in fig .",
    "[ fig : shapem1.6 ] , we see that the noise level changes with radius , but it appears that eq .",
    "( [ eq : si ] ) still provides a reasonable approximation to the errors except in the innermost regions .",
    "however , the noise in @xmath0-body simulations is not completely poissonian because the particles follow dynamical evolution and their phases are correlated .",
    "studies about the errors in @xmath0-body simulations ( monaghan 1992 ; niedereiter 1978 ) show that they are generally smaller than a naive estimate from pure poissonian noise . nevertheless , we believe our empirical formula eq .",
    "( [ eq : si ] ) still provides an approximate measure of the noise in the surface density from cosmological @xmath0-body simulations .",
    "[ fig : critm1.6 ] shows the resulting critical curves and caustics for the smoothed density field of the low resolution realization .",
    "it is clear that for the 2d sph smoothing , when @xmath40 , the critical curves show large deviations from the analytical results , and the caustics show a large number of high - order singularities , such as swallowtails and butterflies .",
    "the agreement is substantially better when @xmath1 is increased to 512 in the 2d sph smoothing , in this case all the prominent higher - order singularities disappear ( in agreement with analytical predictions ) .",
    "this demonstrates that these are due to artifacts of inappropriate smoothing . for the si method , with @xmath41 , the critical curves and caustics already resemble the analytical results quite well , with no apparent high - order singularities .",
    "increasing @xmath1 by a factor of 2 does not change the critical curves and caustics substantially .",
    "the results are similar for the high - resolution monte carlo simulation . compared with the lower resolution , the surface density ( fig .",
    "[ fig : shapem0.05 ] ) is reproduced well even in the inner - most regions due to the increased particle number . again",
    "the 2d sph smoothing algorithm appears to produce artificial high - order singularities ( see fig .",
    "[ fig : critm0.05 ] ) for @xmath40 ; some remain even for @xmath42 . in contrast , the si method does not produce prominent higher - order singularities .",
    "the si method is also computationally efficient . for the low resolution cluster ,",
    "the speed for the si method is similar to that for the 2d sph smoothing method .",
    "but for the high resolution simulation , for the same noise level , the si method is much faster , as the 2d sph smoothing algorithm requires many more neighbors to be taken into account .",
    "as we mentioned before , the fluctuations in the monte carlo simulations discussed above for the uniform density field and the isothermal ellipsoid arise due to poisson statistics . in @xmath0-body simulations ,",
    "the noise may be significantly smaller than the poisson noise .",
    "furthermore , substructures can not be properly accounted for in our simple simulations . to remedy this",
    ", we study a numerically simulated cluster .",
    "the cosmological model considered here is the current popular @xmath37cdm model with the matter - density parameter @xmath43 and the cosmological constant @xmath44 ( @xmath37cdm ) .",
    "the shape parameter @xmath45 and the amplitude @xmath46 of the linear density power spectrum are taken to be 0.21 and 0.9 , respectively , where @xmath47 is again the hubble constant in units of @xmath36 . a cosmological @xmath0-body simulation with a box size @xmath48 , which was generated with a vectorized - parallel @xmath49 code ( jing & suto 2002",
    "; jing 2002 ) , is used in this paper .",
    "the simulation uses @xmath50 particles , so the particle mass @xmath51 is @xmath52 .",
    "the gravitational force is softened with the @xmath53 form ( hockney & eastwood 1981 ) with the softening parameter @xmath54 taken to be @xmath55 .",
    "notice that this simulation has higher resolution than the one used in li et al .",
    "( 2005 ) , which has @xmath56 and a mass resolution of @xmath57 .    a cluster with a virial mass of @xmath58 and a virial radius of @xmath59 at redshift 0.326 is selected from this simulation for illustrative purposes . and",
    "we assume the source is at redshift 2 .",
    "( this redshift is chosen so that we have large and well - resolved caustics ) .",
    "we consider the projected surface mass density in a cube with sidelength of @xmath30 .",
    "the lens center is taken to be the center of the cluster and there are @xmath60 particles in the cube .",
    "bound substructures are found using the algorithm subfind ( springel et al 2001 ) .",
    "this method does not find unbound substructures , such as disrupted satellite galaxies which may manifest themselves as satellite streams ( e.g. , sagittarius in the milky way ) .    in principle , at least two different algorithms can be used to identify these streams and investigate their influence on higher - order singularities .",
    "one is to trace the particles in the phase space ( e.g. , helmi et al .",
    "2003 ; ascasibar & binney 2005 ) , while the other is explicitly following the evolution of accreted satellite galaxies .",
    "we tried both methods , but the results from these two methods are similar , so we present mainly those from the method where the substructures are identified in the phase space ( see below for details ) .",
    "the second ( trace - back ) method revealed that the cluster consists of two subclusters at redshift unity , which eventually merge to produce the cluster we see at @xmath61 .",
    "the virialization in the cluster formation is however incomplete , as can also be seen from the density contours in fig .",
    "[ fig : contours ] .    to identify the satellite streams in the phase space , we first removed the bound substructures we found from the cluster using subfind .",
    "all the substructure particles within the lensing box are excluded .",
    "the volume density of each particle , @xmath62 is then calculated with the sph method using 64 neighbors .",
    "a characteristic length is defined as @xmath63 .",
    "then the friends - of - friends ( fof ) algorithm is used to find the structures in the phase space .",
    "we find that the density of particles in velocity space is approximately constant as a function of radius , hence a constant linking length in the velocity of @xmath64 is appropriate , where @xmath4 is the velocity dispersion for all the particles relative to the cluster center . in the real space , the volume density changes rapidly as a function of position , so we use a variable linking length , @xmath65 .",
    "such a linking length allows us to extract a stream that has a volume density a factor of @xmath66 smaller than the local volume density , but discards streams with a much lower amplitude",
    ". our method can easily find coherent short - wavelength structures but can not extract very low - amplitude large - scale features in the phase space .",
    "[ fig : streams ] shows the streams we have found : there are 690 particles in the region with a total mass of @xmath67 .",
    "this is about 1% of the projection mass in the plotted region ( @xmath68 ) in fig .",
    "[ fig : streams ] .",
    "we now consider the projected surface mass densities with and without substructures and streams using the si smoothing method in fig .",
    "[ fig : contours ] .",
    "the number of neighbors in the si algorithm is set to 64 .",
    "the top panel in fig .",
    "[ fig : contours ] shows the surface density contours and critical curves when all the particles are included , and the corresponding caustics are shown in the top panel of fig .",
    "[ fig : caustics ] .",
    "the top right panel in fig .",
    "[ fig : contours ] shows the surface density contour when we exclude the bound substructures identified by subfind .",
    "the corresponding caustics are shown in fig .",
    "[ fig : caustics ] .",
    "comparisons show that there is very little difference between the contours of the two sets of surface densities and caustics .",
    "the exclusion of streams , however , makes one wiggle in the critical curves less prominent ( indicated by a box in the bottom left panel of fig .",
    "[ fig : contours ] ) , and this causes one of the higher - order singularities to disappear .",
    "this case can be explained by the stream at ( 45 , 15 ) kpc identified in fig .",
    "[ fig : streams ] .",
    "most wiggles in the critical curves and many perturbations in the surface density plane still remain unchanged .",
    "it thus appears that streams ( in addition to substructures ) can explain one of the high - order singularities for this cluster .",
    "however , it looks that the majorities of high - order singularities in this case are caused by other reasons .",
    "one possibility is large - scale ( low - amplitude ) fluctuations in the main halo .",
    "such fluctuations are a natural result of incomplete virialization in the merging process on cluster scales .",
    "however , this may be difficult to prove , as we show below that particle noise can also cause similar levels of high - order singularities .",
    "we first fit the density contours as ellipses , and find the radial density profile as a function of the elliptical coordinate , @xmath69 , where @xmath70 and @xmath71 is the axial ratio .",
    "this creates a smooth representation of our numerical cluster .",
    "the critical curve and caustics for this fitted elliptical model are shown in fig .",
    "[ fig : ellipse ] .",
    "there are no high - order singularities for this smooth model .",
    "we then study the effect of shot noise by populating the fitted smooth elliptical with particles in elliptical annuli . for each annulus",
    ", the simulated monte carlo cluster has the same number of particles as the numerical one , but the angular positions of particles are randomized .",
    "[ fig : ellipse ] shows the resulting critical curves and caustics for the monte carlo resampled cluster .",
    "a number of high - order singularities appear which are clearly due to discrete particle noise ( about 4.5% in our case ) .",
    "we return to the issue of noise at the end of this section .",
    "one key objective of a good smoothing algorithm is the ability to maintain the information of substructures . in the bottom panel of fig .",
    "[ fig : contours ] , we show the difference in the obtained surface densities for the 2d and 3d sph smoothing algorithms . to keep roughly the same noise level , 1400 neighours are used in the 2d sph smoothing based on the condition found by equating eqs .",
    "( [ eq : si ] ) and ( [ eq:2d ] ) . following the discussions in  [ sec : uniform ] and ",
    "[ sec : sie ] , the noise level in the si method will in general be lower than that in the 2d sph smoothing method as the si method reduces noise due to chance alignments in projection . to show the difference more clearly , pixels with values outside the limits of the color bar are set equal to the upper or lower limit .",
    "we can clearly see that most bound structures identified by subfind are located in the positive region , i.e. , the si method picks out these overdense substructures more reliably , i.e. , the 2d sph algorithm may have over - smoothed .",
    "we believe this also applies to the central region .",
    "there are relatively few bound substructures around the critical curve because most substructures are destroyed by the tidal force . as we mentioned before , we traced the evolution of the cluster out to redshift unity and found that in total 88 progenitors eventually merge to produce the cluster  many of the particles in these clumps are not yet virialized , as can be seen in the satellite streams in fig .",
    "[ fig : streams ] .",
    "so fluctuations ( shown as red ) in the inner region are real , highlighting the over - smoothing by the 2d sph smoothing method .",
    "sources close to and inside cusps in general will produce three close images .",
    "the properties of such images have been studied theoretically ( blandford & narayan 1986 ; blandford 1990 ; schneider & weiss 1992 ; mao 1992 & zakharov 1995 ) .",
    "the magnifications of the three close images follow a simple relation : @xmath72 where a , b and c are three images in the cusp system and @xmath73 is the sum of unsigned magnifications of these three images ( the denominator in the equation above ) .",
    "cusp images are more sensitive to the presence of substructures ( mao & schneider 1998 ; keeton , gaudi , & petters 2003 ) than the separation of images or arc numbers .",
    "if the lensing potential is smooth , then @xmath74 must vanish asymptotically as a source gets close to a cusp .",
    "we use the cusp relation to check the difference in the lensing properties of the 2d and 3d sph smoothing algorithms . for a given surface density",
    ", the lensing potential is obtained using the fft method ( e.g. , bartelmann et al .",
    "1998 ; li et al . 2005 ) .",
    "a regular grid is put on the source plane and the newton - raphson method is used to find all the images and their corresponding magnifications .    for a source position which produces more than three images ,",
    "we first determine the polar angles for all the images measured from the cluster center .",
    "the opening angle between any two images with the same parity are measured .",
    "the two images with the smallest opening angle are selected as the two outer cusp images .",
    "the third image can be easily identified as it has the opposite parity and lies inside the two outer cusp images .",
    "we restrict cusp systems to the lenses where @xmath73 is larger than 30 .",
    "this is a simple way of selecting systems that have three highly - magnified close images .",
    "[ fig : caustics]d shows the probability distribution of @xmath74 for the 2d and 3d sph smoothing algorithms .",
    "the 2d sph method decreases the probability for high @xmath74 because it tends to over - smooth the structures compared with the si method .",
    "however , the most striking result is that the monte carlo resampled cluster also produces large deviations , just as seen in the numerical simulated cluster , showing that the noise can mimic the high - order singularities ( see fig .",
    "[ fig : ellipse ] ) .",
    "the problem is due to the poisson noise whose level is still too high , @xmath75 .",
    "notice that , to decrease the noise level , we can not simply increase the number of neighbors in the si smoothing because this may over - smooth and remove crucial information on substructures and voids .",
    "of course , we expect the cusp relation to be better satisfied if we increase the number of particles in our volume and approach the limit of a smooth potential . to verify this , we generated a new cluster for which we increase the number of particles by a factor of 16 .",
    "the mass of each particle is lowered by the same factor so as to keep the total mass of the cluster the same .",
    "if we take the @xmath76 in the 2d sph smoothing kernel to be @xmath77 , then the predicted relation still shows large deviations from the smooth elliptical density distribution ( see fig .",
    "[ fig : rcusp16 ] ) .",
    "however , when @xmath76 are increased by a factor of 16 , the probability distribution of @xmath74 resembles that of a perfect smooth elliptical distribution . from eq .",
    "( [ eq : si ] ) , the noise level drops to about @xmath78 . in this case",
    ", the level of noise appears to be low enough to reproduce the theoretically expected cusp magnification relation . according to our comparisons of surface densities with different noise levels ,",
    "this value is approximately the highest tolerable level for reliably reproducing the cusp relation for this cluster .",
    "this means that , in order to suppress the impact of noise or quantify the effect of ( sub)structures on the cusp relation , the mass resolution should be increased by a factor of 16 . in our case , the particle number , @xmath79 , should be increased to @xmath80 or more . furthermore , @xmath76 sets a threshold for the smallest ( sub)structures that we can resolve reliably .",
    "substructures with @xmath81 particles will be over - smoothed . in other words , for a given lower mass limit of ( sub)structures above which we we want to investigate the cusp relation , the particle number needed in simulations can be very approximately estimated using eq .",
    "( [ eq : si ] ) for a desired surface density fluctuation .",
    "the best @xmath1 needs to be chosen on the balance of the lowest mass of clumps we want to resolve and the noise level one can tolerate .",
    "bradac et al .",
    "( 2004 ) presented a detailed study of the lensing properties of a numerically simulated elliptical galaxy ( meza et al .",
    "they used the delaunay tessellation method in three dimensions to obtain the surface density maps .",
    "they also added an external shear and calculated the resulting critical curves , caustics and the cusp relation ( cf .",
    "[ eq : rcusp ] ) . in this subsection , we present comparisons between their results and ours for this galaxy .",
    "the top left panel of fig .",
    "[ fig : bradackappa ] presents the surface density map and the critical curve for the galaxy projected along the @xmath82-axis by bradac et al .",
    "the other three panels show the surface density maps obtained using the si method with @xmath1=8 , 16 and 32 .",
    "it is clear that the maps are similar , particularly the one with @xmath83 seems to match the bradac et al .",
    "surface density map ( the top left panel ) , including the substructures",
    ". the @xmath41 surface density map may be somewhat over - smoothed , as the clumps appear circular .",
    "the corresponding caustics for the four surface density maps are shown in fig .",
    "[ fig : bradaccaustics ] . for the @xmath83 ,",
    "the caustics match that obtained through their delaunay tessellation method quite well . in short",
    "our method yields results that are consistent with those obtained with the delaunay tessellation method .",
    "bradac et al .",
    "( 2004 ) also assessed the reality of high - order singularities and the violation of the cusp relation seen in their simulated galaxy .",
    "to do this , they created an ellipsoidal galaxy with a power - law density profile , @xmath84 .",
    "the steep slope is adopted to match that seen in the simulated cluster around the outer critical curve .",
    "their simulated galaxy shows no higher - order singularities and violations of the cusp relation ( see their fig .",
    "this is different from our monte carlo simulation ( see fig . [",
    "fig : rcusp16 ] ) where violations of the cusp relation ( and high - order singularities ) seem to persist .",
    "to understand the behavior seen in their simulations , we created several monte carlo realizations of a prolate galaxy for different axis ratios and external shear .",
    "we use the same number of particles ( @xmath85 ) within the virialized region as they used and the surface density is obtained along the projection of one of the major axes . for the first realization",
    ", we use an axis ratio 0.8 and the main axis has an angle of @xmath86 with respect to the horizontal axis . in this case , the caustics are small and show many high - order singularities ( see the top right panel in fig . [",
    "fig : comp_shear ] ) .",
    "if the axis ratio is changed to 0.6 ( the bottom left panel ) , the caustics are a factor of two larger , but the high - order singularities are less important . if we add an external shear ( as in bradac et al .",
    "2004 ) to the case with an axis ratio of 0.8 , then we obtain similar caustics ( the black - line in the top left panel of fig .",
    "[ fig : comp_shear ] ) as the one shown in their fig .",
    "notice that the caustics are much larger and there are no more high - order singularities . in all three realizations ,",
    "the shapes of their critical curves are rather similar ( see the bottom panel ) .",
    "this exercise demonstrates that high - order singularities are not only a function of the surface density fluctuations but also the detailed form of the smooth component of the lens potential , including the ellipticity and shear .",
    "a more quantitative understanding can be achieved using the results in evans & witt ( 2001 ) where they modeled the lensing potential as an isothermal sphere with arbitrary angular dependences ( see also witt , mao & keeton 2000 ) .",
    "they showed that for galaxies with higher ellipticities ( which usually have larger caustic sizes ) require a higher level of fluctuations to exhibit higher order singularities ( see their fig . 3 and eq .",
    "we believe the difference between our results and those in bradac et al . can be understood due to the difference in the adopted potential forms .",
    "the external shear in their monte carlo simulation may act as a large effective ellipticity which enlarges the caustics relative to those seen in our monte carlo simulations with ellipticities 0.5 and 0.7 . as a result",
    ", the importance of high - order singularities may be suppressed with similar fluctuations in the surface densities .",
    "this also explains the difference between figs . 5 and .",
    "the noise levels around the critical curves are quite similar in these two cases ( both are around 5% )",
    ". however , there are no visually striking singularities in the caustics for the isothermal ellipsoid case while for the simulated cluster , higher - order singularities are quite prominent .",
    "this arises because for the sie cluster , the axis ratio is 0.5 while for the numerically simulated cluster , the axis ratio is larger ( 0.7 ) .",
    "the caustic size for the sie cluster is correspondingly larger .",
    "the difference in the axis ratio and caustic sizes means that the same level of fluctuation has different effects on the high - order singularities .",
    "we verified that if we adopt a more spherical isothermal cluster ( increasing @xmath25 close to 1 ) , the caustics becomes smaller . when the axis ratio and caustics are similar to that of the simulated cluster , then at the same noise level , high - order singularities also appear .",
    "[ sec : nbody ]",
    "we have used sph smoothing algorithms in both 2d and 3d to obtain the surface densities of galaxy clusters .",
    "we used monte carlo simulations of a uniform density field , an isothermal ellipsoid and an @xmath0-body numerical cluster to compare these two sph smoothing algorithms .",
    "we find that in general the 3d smoothing algorithm is superior to the smoothing of the 2d projected particle distribution .",
    "in particular , our scatter and integrate method , for which we first scatter the particle mass in the nearby grid points in 3d and then integrate to obtain the surface density , appears to reproduce the underlying surface density well . with @xmath41 or 64 , no prominent artificial higher - order singularities are produced for the isothermal ellipsoid we simulated .",
    "these high - order singularities are particularly important for the anomalous flux ratio problem . as shown by bradac et al .",
    "( 2004 ) , these often appear close to the cusps , and produce large cross - sections which violate the cusp relation . for our high - resolution numerical cluster , we have critically examined how these high - order singularities arise .",
    "it appears that one of the higher order singularities is related not to bound substructures but to a satellite stream identified in the phase space .",
    "for the ten most massive clusters in our @xmath0-body simulation , we found that there are always one or more compact unbound structures in the inner region of clusters .",
    "so the effects of streams may be important for cluster lensing .",
    "our results show that the importance of high - order singularities will be a sensitive function of the cluster ellipticity and external shears , as also demonstrated by evans & witt ( 2001 ; see keeton , mao & witt 2000 ) .",
    "this implies that the maximum noise level allowed to produce reliable predictions will depend on the detailed form of the lensing potential .",
    "galaxies with small ellipticities are particularly sensitive to the shot noise , and hence will require many more particles to make reliable predictions .",
    "if the high - order singularities are due to true large - scale fluctuations induced , for example , by merging , then their presence is sensitive to the merging state of clusters .",
    "as the merger rate likely increases at higher redshift and for the most massive clusters , it will be interesting to examine how these higher - order singularities change as a function of redshift and cluster mass .",
    "these higher - order singularities provide regions that can form sextuplet and octuplet images ( keeton , mao & witt 2000 ; evans & witt 2001 ) .",
    "evans & witt ( 2001 ) estimated that perhaps @xmath87 of galaxy - scale lenses may be sextuplet and octuplet imaged systems . this fraction may be higher for clusters because they have much more irregular mass distributions .",
    "upcoming large surveys ( e.g. , wittman et al .",
    "2006 ) will discover a large number of clusters , the chance of seeing these systems may be quite realistic .",
    "it is however less clear whether such high - order singularities should be as prevalent as in galaxies .",
    "this is because most lensing galaxies are ellipticals which may have little evolution since redshift of @xmath88 .",
    "so the substructures in galaxies may be more effectively destroyed .",
    "as even state - of - art simulations can not reproduce galaxies realistically in a cosmological setting ( e.g. kawata 2001 ; westera et al .",
    "2002 ; adadi et al .",
    "2003 ) , the importance of bound subhaloes and , particularly , streams in numerical simulations remain to be seen .",
    "we thank dr .",
    "y. ascasibar for helpful discussions and the referee for an insightful report .",
    "we are indebted to dr .",
    "m. bradac for providing us the data for the numerical galaxy presented in ",
    "[ sec : comparison ] and many helpful discussions .",
    "the research in shanghai is supported by nkbrsf ( g19990754 ) , by nsfc ( nos .",
    "10125314 , 10373012 , 10303004 ) , and by shanghai key projects in basic research ( no . 04jc14079 ) .",
    "sm and lgl acknowledge partial financial support of chinese academy of sciences and the european community s sixth framework marie curie research training network programme , contract no .",
    "mrtn - ct-2004 - 505183  angles \" .",
    "abadi , m. g. , navarro , j. f. , steinmetz , m. , & eke , v. r. 2002 , , 591 , 499 ascasibar , y. , & binney , j. 2005 , mnras , 356 , 872 bartelmann , m. 2003 , gravitational lensing winter school , aussois , la vieille europe ( astro-0304162 ) bartelmann , m. , huss , a. colberg , j. m. , jenkins , a. , & pearce , f. r. 1998 , a&a , 330 , 1 ( b98 ) bartelmann , m. , & weiss , a. 1994 , , 284 , 285 bartelmann , m. , steimetz , m. & weiss , a. 1995 , , 297 , 1 bartelmann , m. , meneghetti , m. , perrotta , f. , baccigalupi , c. , & moscardini , l. 2003 , a&a , 409 , 449 blandford , r. , & narayan , r. 1986 , , 310 , 568 blandford , r. d. 1990 , qjras , 31 , 305 bradac , m. , schneider , p. , steinmetz , m. , lombardi , m. , king , l. j. , & porcas , r. 2002 , , 388 , 373 bradac , m. , schneider , p. , lombardi , m. , steinmetz , m. , koopmans , l. v. e. , & navarro , j. f. 2004 , , 423 , 797 dalal , n. , holder , g. , & hennawi , j. f. 2004 , , 609 , 50 evans , n. w. , & witt , h. j. 2001 , , 327 , 1260 helmi a. , white s. d. m. , & springel v. 2003 , mnras , 339 , 834 hernquist , l. , & katz , n. 1989 , apjs , 70 , 419 hockney , r. w. , & eastwood , j. w. 1981 , computer simulation using particles ( mcgraw - hill : new york ) jing , y. p. , & suto y. 2002 , apj , 574 , 538 kawata , d. 2001 , , 558 , 598 keeton , c. r. , kochanek , c. s. 1998 , , 495 , 157 keeton , c. r. , mao , s. , & witt , h. j. 2000 , , 537 , 697 keeton , c. r. , gaudi b. s. , & petters a. o. , 2003 , , 598 , 138    kochanek , c. s. , 1991 , , 373 , 354 kochanek , c. s. , & dalal , n. 2005 , , 610 , 69 kochanek , c.s . , schneider ,",
    "p. , wambsganss , j. , 2004 , gravitational lensing : strong , weak & micro , proceedings of the 33rd saas - fee advanced course , g. meylan , p. jetzer & p. north , eds .",
    "( springer - verlag : berlin ) kormann , r. , schneider , p. , & bartelmann , m. 1994 , a&a , 284 , 285 li , g. l. , mao , s. , jing , y. p. , kang , x. , bartelmann , m. , & meneghetti , m. 2005 , apj , 635 , 795 lombardi , m. , schneider , p. , , 392 , 1153 macci , a. v. , moore , b. , stadel , j. , diemand j. 2006 , , 366 , 1529 macci , a. v. , miranda , m. 2006 , , 368 , 599 mao , s. 1992 , , 389 , 63 mao , s. , & schneider , p. 1998",
    ", , 295 , 587 mao , s. , jing , y. p. , ostriker , j. p. , & weller , j. 2004 , , 604 , 5 meneghetti , m. , bolzonella , m. , bartelmann , m. , moscardini , l. , & tormen , g .. 2000 , , 314 , 338 meneghetti , m. , bartelmann , m. , & moscardini , l. 2003 , , 346 , 67 meneghetti , m. , bartelmann , m. , dolag , k. , moscardini , l. , perrotta , f. , baccigalupi , c. , & tormen , g. 2004 , new astronomy reviews , 49 , 111 meza , a. , navarro , j. f. , steinmetz , m. , eke , v. r. 2003 , apj , 590 , 619 monaghan , j. 1992 , araa , 30 , 543 navarro , j. f. , frenk , c. s. , & white , s. d. m. 1997 , , 490 , 493 niedereiter , h. 1978 , bull .",
    "soc , 84 , 957 puchwein , e. , bartelmann , m. , dolag , k. , & meneghetti , m. 2005 , , 442 , 405 schaap , w.e . , &",
    "van de weygaert , r. 2000 , a&a , 363 , l29 schneider , p. , & weiss , a. 1992,a&a , 260 , 1 springel , v. , white , s. d. m. , tormen , g. , & kauffmann , g. 2001 , , 328 , 726 torri , e. , meneghetti , m. , bartelmann , m. , moscardini , l. , rasia , e. , & tormen , g. 2004 , , 349 , 476 wambsganss , j. , bode , p. , & ostriker , j. p. , van de weygaert , r. 1994 , a&a , 283 , 361 2004 , apj , 606 , l93 ( w04 ) westera , p. , samland , m. , buser , r. , & gerhard , o. e. a&a , 389 , 761 wittman , d. , dellantonio , i. p. , hughes , j. p. , margoniner , v. e. , tyson , j. a. , cohen , j. g. , & norman , d. 2006 , , 643 , 128 zakharov , a. f. 1995 , a&a , 293 , 1"
  ],
  "abstract_text": [
    "<S> we propose a new smoothing method for obtaining surface densities from discrete particle positions from numerical simulations . </S>",
    "<S> this is an essential step for many applications in gravitational lensing . </S>",
    "<S> this method is based on the `` scatter '' interpretation of the discrete density field in the smoothed particle hydrodynamics . </S>",
    "<S> we use monte carlo simulations of uniform density fields and one isothermal ellipsoid to empirically derive the noise properties , and best smoothing parameters ( such as the number of nearest neighbors used ) . a cluster from high - resolution simulations is then used to assess the reality of high - order singularities such as swallowtails and butterflies in caustics , which are important for the interpretation of substructures in gravitational lenses . </S>",
    "<S> we also compare our method with the delaunay tesselation field estimator using the galaxy studied by bradac et al . </S>",
    "<S> ( 2004 ) , and find good agreements . </S>",
    "<S> we show that higher order singularities are not only connected with bound subhaloes but also with the satellite streams </S>",
    "<S> . however , the presence of high - order singularities are sensitive to not only the fluctuation amplitude of the surface density , but also the detailed form of the underlying smooth lensing potential ( such as ellipticity and external shear ) . </S>"
  ]
}