{
  "article_text": [
    "the multiconfiguration time - dependent hartree ( mctdh ) method @xcite has become over the last decade the tool of choice to accurately describe the dynamics of complex multidimensional quantum mechanical systems , providing in many cases reference results that are used to benchmark other approaches or determine the behavior of approximate methods .",
    "mctdh was initially formulated with molecular quantum dynamics in mind , where the degrees of freedom are distinguishable and the potential operator correlates in principle all vibrational degrees of freedom of the system .",
    "many successful applications over the years deal with the spectroscopy of molecules  @xcite , isomerisation and intramolecular vibrational energy redistribution ( ivr )  @xcite , inelastic and reactive scattering calculations  @xcite , scattering of atoms or molecules at surfaces  @xcite , etc .",
    "more recently , the potential of the mctdh method for the treatment of systems of indistinguishable particles , either fermions or bosons , has been realized as well , and many applications can be counted nowadays in such new directions  @xcite . although the equations of motion remain the same in such cases , the symmetry properties of the wavefunction and the often two - body nature of the interactions has lead to the appearance of dedicated programs that specifically and efficiently deal with such cases  @xcite .    in general , the solution of the time - dependent schrdinger equation in a direct - product basis of 1d functions ( primitive functions ) scales exponentially as @xmath2 , where @xmath3 is the number of primitive basis functions per degree of freedom and @xmath4 is the number of degrees of freedom . in the mctdh",
    "_ ansatz _ one introduces an optimal time - dependent ( td ) basis ( called spf for single particle function ) for each degree of freedom , which can be kept smaller than the underlying primitive basis , leading to a better scaling of the number of configurations @xmath5 . in this way",
    ", mctdh can deal with larger systems than the standard method , although the exponential scaling with @xmath4 remains , but to a lower base .",
    "the base can be further reduced by grouping degrees of freedom together in what are called combined modes or logical coordinates .",
    "one obtains in this way a smaller number of effective degrees of freedom @xmath6 , leading to a smaller number of configurations , but the td basis functions that have to be now propagated are multidimensional . for a given problem ,",
    "it is possible to find mode - combination schemes that provide an optimum balance between the effort of propagating the expansion coefficients of each configuration ( the a - vector in usual mctdh terminology ) and the effort of propagating the multidimensional spfs . with increasing dimensionality",
    ", however , the multidimensional spfs , the a - vector , or both , become harder and harder to propagate . as a rule of thumb and very generally ,",
    "the number of degrees of freedom that can be treated for a correlated vibrational problem nowadays is about 20 , but for systems well suited for mctdh more than 60 degrees of freedom ( dof ) have been accounted for  @xcite .",
    "multilayer ( ml ) mctdh represents a powerful extension of the usual mctdh approach , in which a multiconfigurational _ ansatz _ is used for the multidimensional spfs themselves .",
    "this results in an extra layer of td coefficients that have to be propagated and hence the name .",
    "one way to think of the ml wavefunction _ ansatz _ ( given below ) is to see the standard propagation method and mctdh as particular cases of a ml wavefunction . in the standard propagation method",
    "a single layer of expansion coefficients with respect to some time - independent ( ti ) basis is present .",
    "mctdh contains a first layer of expansion coefficients with respect to the spf basis , and a second layer of td expansion coefficients that parameterize the time evolution of the spfs . expanding multidimensional spfs using a mctdh - like _ ansatz _",
    "one obtains a three - layer scheme .",
    "schemes with more than three layers are of course possible . in passing we note that the ml - mctdh _ ansatz _ can be connected to tensor contraction techniques in the mathematical literature  @xcite and to density matrix renormalization group ( dmrg ) theory  @xcite .    ml - mctdh was first formulated by wang and thoss , who also provided an implementation of the method for three layers ( in the present paper mctdh is regarded as a two - layer scheme ) and showed its applicability on the spin - boson model and on an electron - transfer model  @xcite .",
    "a formally identical formulation , but without an implementation , was given independently at the same time by meyer and worth  @xcite , who termed it cascading mctdh .",
    "over the last years wang and thoss have further developed ml - mctdh , expanding the number of layers that their code can handle and treating condensed phase model hamiltonians of large dimensionality between 100 and a few thousand dof  @xcite .",
    "the same authors also described how ml - mctdh can be used to deal with identical particles , which is accomplished defining the problem in fock space and directly working in the occupation - number representation  @xcite .",
    "( note that ml - mctdh can not be applied to identical particles in the usual first - quantized formulation because the grouping of dof into combined modes destroys the necessary exchange symmetry properties of the wavefunction . )",
    "recently , manthe provided a recursive formulation of the ml - mctdh equations of motion ( eom ) for any number of layers and described the recursive algorithm that has to be used to compute all quantities entering the eom  @xcite .    in this contribution , we present the implementation of the eom and recursive algorithm proposed by manthe , and discuss its applicability and performance on a henon - heiles ( hh ) model system and on a realistic non - adiabatic molecular case , full dimensional 24d pyrazine .",
    "the resulting implementation is fully general and it can handle standard method ( one layer ) , normal mctdh ( two layers ) and any desired multilayering scheme . in this paper , we report on simulations with three layers and up to a seven - layer case for the 1458d hh hamiltonian .",
    "we also simulate pyrazine using five and six layer schemes .",
    "the ml - mctdh concept , eom and recursive algorithm are discussed first , emphasizing some aspects of our implementation such as the treatment of the separable parts of the hamiltonian .",
    "we have tried to keep such discussion self - contained and to reflect the way our code operates , but for an in - deep discussion ref .",
    "@xcite should be read .",
    "the performance and correctness of the recursive implementation are tested on the hh hamiltonian . for this system , 6d calculations with varying coupling strength",
    "are carried on first , which are directly compared to mctdh results .",
    "for such a low dimensionality , the algorithmic complexity of ml - mctdh does not yet pay off , and mctdh is more efficient than ml - mctdh . for 18d",
    "hh we find that ml - mctdh starts to be competitive .",
    "for this case we analyze the convergence properties of the method with respect to the number of basis functions at each layer .",
    "simulations of 1458d hh are also reported , showing the power of this approach .",
    "the ml - mctdh implementation is then applied to the photoabsorption spectrum of pyrazine using the 24d vibronic - coupling hamiltonian of raab and coworkers  @xcite .",
    "this is a realistic molecular hamiltonian involving the presence of a conical intersection between the electronic state @xmath7 initially populated by photoabsorption and the @xmath8 electronic state to which the system decays within some ten fs .",
    "the hamiltonian of ref .",
    "@xcite has been used to test several quantum dynamical approaches . in the case of ml - mctdh , we find that the method performs very efficiently and provides already well converged spectra in about a fifth of the cpu time used by the smallest of the mctdh reference results using extremely few computational resources . tolerating a larger error",
    "one can reduce the computation time to 7 minutes and still get a spectrum with all basic features in place .",
    "this is amazingly fast , considering that one is dealing with a fully correlated 24-dimensional quantum dynamics calculation .",
    "no other quantum dynamical method applied up to date to the pyrazine hamiltonian offers the extreme quality / cost relation provided by ml - mctdh . when pushing ml - mctdh towards convergence with the pyrazine hamiltonian , we find that it still offers results of at least the same quality ( if not better ) than the best benchmark results available from mctdh calculations with about @xmath9 configurations , at a lower computational cost .",
    "the paper is organized as follows : section [ sec : theory ] discusses the ml - mctdh equations and implementation .",
    "section [ sec : hh ] discusses the results on the hh hamiltonian and section [ sec : pyr ] discusses the application of ml - mctdh to the photoabsorption spectrum of pyrazine .",
    "section [ sec : conclusion ] summarizes the results and provides some future perspectives for the method .",
    "the wavefunction of a system of distinguishable degrees of freedom , e.g. representing molecular vibrations , can be conveniently represented as an expansion in terms of direct products of orthonormal basis functions , one for each degree of freedom @xmath10 following the notation introduced by manthe  @xcite , the @xmath11 denote the td coefficients of the first ( and by now the only ) layer of td expansion terms .    in the mctdh approach",
    ", the wavefunction is expanded in terms of direct products of orthonormal _ time - dependent _ single particle functions ( spf ) @xmath12 which are themselves expanded in terms of the underlying primitive basis @xmath13 therefore , mctdh can be seen as a 2-layer scheme with td coefficients @xmath14 at the top layer , and sets of second layer td coefficients @xmath15 for each degree of freedom .",
    "we usually refer to the 1-layer scheme as the standard method , to the 2-layer scheme simply as mctdh , and to deeper layering schemes as ml - mctdh .",
    "note the important detail that all spfs of a certain degree of freedom are expanded in terms of the same underlying basis , i.e. the @xmath16 functions in eq .",
    "( [ eq : ansatz3 ] ) have no @xmath17 index .",
    "the computational gain of mctdh with respect to the standard method arises from the expansion orders @xmath18 being in general smaller than the size of the underlying primitive basis @xmath19 , which leads to a smaller number of td coefficients to be propagated .",
    "however , the total number of td coefficients is still given by @xmath20 , and therefore the computational effort raises exponentially with the number of degrees of freedom .",
    "hence , mctdh does not eliminate the exponential scaling but reduces the base to which the scaling occurs ( for a detailed analysis of the computational scaling of mctdh see for example ref .",
    "@xcite ) . the base can be further reduced by combining the physical coordinates @xmath21 into logical coordinates ( also referred to as combined modes ) @xmath22 , such that each logical coordinate comprises one or several of the physical coordinates , as @xmath23 . here",
    "a more general notation to designate a combined coordinate has been introduced , that will be useful when discussing deeper layering schemes .",
    "mode combination has been extensively used in many applications of the mctdh method .",
    "similarly as in eq .",
    "( [ eq : ansatz2 ] ) , the mctdh wavefunction now reads @xmath24 and the td basis functions @xmath25 are now multidimensional . introducing mode - combination ,",
    "the computational effort is switched from the propagation of a large vector of @xmath26 coefficients and one - dimensional spfs , to a shorter vector of coefficients but multi - dimensional , harder to propagate spfs .",
    "it is often the case , that some experience and knowledge of the system under consideration is necessary to find an efficient mode - combination scheme for a given problem .",
    "the mode - combined spfs are given by @xmath27 where the last equation resembles the _ ansatz _ in eq .",
    "( [ eq : ansatz1 ] ) in that multidimensional spfs are represented as a multiconfigurational expansion in terms of underlying time - independent basis functions . in the same way a td basis was introduced above in going from the standard _",
    "ansatz _ to mctdh , effectively adding a second layer of td expansion coefficients , an mctdh expansion can be used to represent the @xmath28 spfs , effectively adding a third layer of expansion coefficients .",
    "this results in a 3-layer ml - mctdh _",
    "ansatz_.    the ml - mctdh layering scheme can be very flexible . in a high dimensional system one",
    "combines groups of degrees of freedom into high dimensional spfs until the size of the vector of coefficients in eq .",
    "( [ eq : ansatz4 ] ) becomes manageable .",
    "however , the combined spfs are too large to be efficiently propagated",
    ". then , one breaks the combined modes into even smaller groups of logical coordinates introducing a new layer of coefficients , whose size is manageable .",
    "this procedure can be repeated over and over until the ( possibly combined ) primitive degrees of freedom are reached .",
    "owing to the flexibility of the layering scheme , and the fact that ml - mctdh wavefunctions can be many layers deep , it is convenient to introduce a diagrammatic notation to represent these objects  @xcite . in this notation",
    ", wavefunctions are represented by _ trees _ ,",
    "i.e. connected graphs without loops .",
    "each node in the tree represents a set of vectors of coefficients @xmath29 , where @xmath30 denotes the layer depth , @xmath31 denote the indices of the logical degrees of freedom starting from the top node and down to a particular node ( path from the top down to a given node ) , @xmath17 indicates the different vectors within this node , and finally @xmath32 are the tensor indices of each particular array of coefficients within the node .",
    "some ml diagrams are presented later when discussing the various applications ( see figs .",
    "[ fig : tree6],[fig : tree18],[fig : treepyr ] ) .",
    "the lines connecting one node with its descendant nodes in such diagrams represent the tensor indices @xmath33 , one line per index , and the numbers at the side of each line refer to the maximum possible value of the corresponding index .",
    "each node is uniquely described by the values of its label @xmath34 .",
    "the ml - mctdh equations of motion ( eom ) have been derived and discussed by wang and thoss  @xcite and manthe  @xcite . in ref .",
    "@xcite a fully general derivation of the ml - mctdh eom for arbitrary layering schemes is provided , together with an algorithm for the recursive evaluation of all intermediate quantities entering the eom .",
    "we reproduce here the eom and hint the key elements of the recursive algorithm for the sake of completeness .",
    "later we discuss some specific aspects of our implementation .",
    "the ml - mctdh eom have a very similar structure to the usual mctdh equations , and for the top layer coefficients they are identical to the mctdh ones @xmath35 where the top layer configurations @xmath36 , are defined as direct products of spfs and the multi - index @xmath37 has been implicitly introduced .",
    "the eom for the propagation of the spfs are formally the same for all layers @xmath38 where @xmath39 is the projector onto the space spanned by the @xmath40 spfs , @xmath41 is a density matrix and @xmath42 is a matrix of mean - field operators acting on the @xmath40 functions .",
    "the symbol @xmath43 is a shorthand for the indices specifying a node , @xmath44 , and for further reference we introduce @xmath45 , and similar for @xmath46 . in its form above , the eom for the spfs look identical to the usual eom for the spfs in the usual mctdh  @xcite .",
    "only the computation of the density matrices and mean - fields entering the eom is now more involved than in a single - layer mctdh scheme .    before describing how in practice the recursive calculation of mean - fields and density matrices is performed ,",
    "we first restrict ourselves to the case in which the hamiltonian is given by sums of products of operators acting on the primitive ( but possibly combined ) degrees of freedom @xmath47",
    "@xmath48 this form of the operator is necessary to avoid the computation of high dimensional integrals , and has been thoughtfully discussed in the mctdh literature .",
    "terms which usually do not follow the product form are , e.g. general potential energy surfaces .",
    "there exist however algorithms to bring general potentials to product form  @xcite .",
    "furthermore , mctdh and ml - mctdh formulations based on time - dependent grids that by - pass this restriction ( so - called cdvr approach ) have also been provided  @xcite , but here we always will assume hamiltonians in product form , eq .",
    "( [ eq : hamil1 ] ) .    in order to discuss the practical computation of the mean - field elements @xmath49 appearing in eq .",
    "( [ eq : eom2 ] ) , we center our attention on a particular node @xmath50 .",
    "this node relates to the logical coordinate @xmath51 , which can be further decomposed into a combination of logical coordinates @xmath52 and holds vectors of coefficients denoted by @xmath53 .",
    "these coefficients are expansion coefficients of spfs in layer @xmath54 expanded in terms of spfs in layer @xmath30 .",
    "this is better seen by extending eqs .",
    "( [ eq : ansatz3],[eq : ansatz5 ] ) to the fully general multilayer case    [ eq : phiml ] @xmath55    where the configurations @xmath56 are the multilayer generalization of the configurations introduced in eq .",
    "( [ eq : eom1 ] ) .",
    "the operator summands in eq .",
    "( [ eq : hamil1 ] ) can be written as    [ eq : hamil2 ] @xmath57    where @xmath58 acts on the logical coordinate @xmath59 , while @xmath60 acts on the corresponding remaining space . as seen from eq .",
    "( [ eq : hamil2]b ) , @xmath58 can as well be written as a direct product of operators @xmath61 , which act on logical coordinates @xmath62 .",
    "in fact , both operators @xmath60 and @xmath58 can be broken down to a simple product of operators which act on one primitive ( but possibly combined ) coordinate only ( see eq .",
    "( [ eq : hamil1 ] ) ) .",
    "the matrix elements of the mean - field operators at the right - hand - side of eq .",
    "[ eq : eom2 ] for one particular summand @xmath63 are given by @xmath64 which is readily seen if the spfs in eq .",
    "( [ eq : eom2 ] ) are written in their explicit form given in eq .",
    "( [ eq : phiml]b ) .",
    "these are the most cumbersome quantities to compute within the ml - mctdh scheme . by substituting eqs .",
    "( [ eq : hamil2]a , b ) into eq .",
    "( [ eq : meanf1 ] ) one arrives at    [ eq : meanf2 ] @xmath65_{ij } \\\\       & = &          \\langle \\hat{\\mathcal{h}}_r^{\\ensuremath{{l;\\kappa_1,\\ldots,\\kappa_l}}}\\rangle_{jm}^{\\ensuremath{{l;\\kappa_1,\\ldots,\\kappa_l}}}\\cdot          \\prod_{\\kappa_{l+1}=1}^{p_{\\kappa_{l+1 } } }              \\left [ \\hat{h}_r^{{\\ensuremath{{l+1;\\kappa_1,\\ldots,\\kappa_{l+1 } } } } } \\right]_{i_{\\kappa_{l+1},j_{\\kappa_{l+1 } } } }    \\end{aligned}\\ ] ]    with    [ eq : meanf3 ] @xmath66_{ij } & = &        \\langle \\phi_{i}^{z\\!+\\!1 } |           \\hat{h}_r^{{\\ensuremath{{z,\\kappa_l } } } }      |        \\phi_{j}^{z\\!+\\!1 } \\rangle   \\\\",
    "\\left [ \\hat{h}_r^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } } \\right]_{i_{\\kappa_{l+1},j_{\\kappa_{l+1 } } } } & = &        \\langle \\varphi_{i_{\\kappa_{l+1}}}^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } } |           \\hat{h}_r^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } }      |        \\varphi_{j_{\\kappa_{l+1}}}^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } } \\rangle    \\end{aligned}\\ ] ]    ( the mean - field tensor @xmath67 will be discussed below , eq .",
    "( [ eq : meanfgen ] ) ) .",
    "it remains therefore to be seen , how the quantities appearing in the right - hand - side of eq .",
    "( [ eq : meanf2]b ) can be recursively computed .",
    "the expression for the @xmath68-matrices is found by starting from eq .",
    "( [ eq : meanf3]b ) and explicitly writing the spfs in layer @xmath69 in terms of those in layer @xmath70 @xmath71_{a_{\\kappa_{l+1}},b_{\\kappa_{l+1 } } }     & = & \\langle \\varphi_{a_{\\kappa_{l+1}}}^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } } |                       \\hat{h}_r^{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1}}}}| \\varphi_{b_{\\kappa_{l+1}}}^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } }   \\rangle       \\\\     & = & \\langle \\varphi_{a_{\\kappa_{l+1}}}^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } } |      \\displaystyle\\prod_{\\kappa_{l+2}=1}^{p_{\\kappa_{l+2 } } } \\hat{h}_r^{{\\ensuremath{{z\\!+\\!2,\\kappa_{l+2 } } } } }           | \\varphi_{b_{\\kappa_{l+1}}}^{{\\ensuremath{{z\\!+\\!1,\\kappa_{l+1 } } } } }   \\rangle       \\\\",
    "\\nonumber     & = & \\displaystyle\\prod_{\\kappa_{l+2}=1}^{p_{\\kappa_{l+2 } } }         \\displaystyle\\sum_{j^{\\kappa_{l+2 } } }         \\displaystyle\\sum_{i , j }       a_{a_{k_{l+1}};j_{i}^{\\kappa_{l+2}}}^{*\\;z\\!+\\!2 }           \\left [ \\hat{h}_r^{{\\ensuremath{{z\\!+\\!2,\\kappa_{l+2 } } } } } \\right]_{i , j }       a_{b_{k_{l+1}};j_{j}^{\\kappa_{l+2}}}^{z\\!+\\!2}.    \\end{aligned}\\ ] ] here multi - indices @xmath72 and @xmath73 have been introduced to make the notation more compact .",
    "the former contains all indices except for the @xmath74-th one , while the latter has index @xmath74 set to @xmath17 .",
    "( [ eq : tmat ] ) tells us that the computation of the matrix elements of @xmath75 requires the previous knowledge of the matrix elements of @xmath76 .",
    "therefore , one starts at the lowest layer with the matrix elements of @xmath77 with respect to the underlying time - independent basis @xmath78_{i_{\\kappa},j_{\\kappa } } =      \\left [ \\hat{h}_r^{\\mathrm{prim};\\kappa } \\right]_{i_{\\kappa},j_{\\kappa } }        = \\langle \\chi_{i_\\kappa}^{(\\kappa ) } |                       \\hat{h}_r^{\\mathrm{prim};\\kappa }   |                  \\chi_{j_\\kappa}^{(\\kappa ) } \\rangle\\ ] ] where @xmath79 denotes the maximal layer , i.e. @xmath80 for normal mctdh , and proceeds bottom up through the tree structure building the matrix representations of the @xmath81 operators , which will subsequently be used to build the matrix elements of @xmath58 operators , and so on .",
    "the mean - field matrix elements are computed in practice in a similar way to eq .",
    "( [ eq : tmat ] ) . for the top layer ,",
    "the mean - field elements are given as @xmath82_{i , j }           a_{1;j_{n , j}^{\\kappa_{1,\\nu}}}^{1},\\ ] ] where the composite indices @xmath83 and @xmath84 are defined similarly as @xmath72 and @xmath73 .",
    "( [ eq : meanftop ] ) corresponds to the normal way of calculating the mean - fields in standard mctdh , and is an alternate way of writing , e.g. eq .  ( 67 ) in ref .",
    "@xcite . for a given deeper layer ,",
    "the calculation involves the mean - fields of the above layer and is given by  @xcite @xmath85_{i , j }           a_{b;j_{n , j}^{\\kappa_{1},\\nu}}^z \\ ; ,    \\end{aligned}\\ ] ] where @xmath86 and @xmath87 run over the @xmath88th layer spfs , which are contained in the @xmath30th layer spf @xmath17 and @xmath89 , respectively .",
    "therefore , the mean - fields can be computed if the mean - fields of the layers above , as well as the matrix elements of the @xmath90 operators , are known .",
    "the density matrices are computed in a very similar way to eq .",
    "( [ eq : meanfgen ] ) , but application of the @xmath90 matrices to @xmath91 vectors on the right side of eq .",
    "( [ eq : meanfgen ] ) disappears .",
    "( [ eq : meanftop]-[eq : meanfgen ] ) are obtained after introducing the so called single - hole functions , which are defined as the variation of the total wavefunction with respect to a particular spf .",
    "we leave this more specialized step out of this discussion and refer the interested reader , e.g. to refs .",
    "@xcite or @xcite .",
    "the recursive algorithm proceeds then as follows : 1 ) starting from the bottom of the tree and proceeding up , the @xmath68-matrix elements are evaluated after eq .",
    "( [ eq : tmat ] ) .",
    "2 ) starting from the top of the tree and proceeding down the mean - fields and density matrices are computed as in eq .",
    "[ eq : meanfgen ] .",
    "3 ) the right - hand - side of the eoms , eqs .",
    "( [ eq : eom1],[eq : eom2 ] ) , is evaluated .",
    "the efficiency of the ml - mctdh calculations is increased if one takes advantage of the terms @xmath92 in eq .",
    "( [ eq : hamil1 ] ) that are unit operators .",
    "the kinetic energy part of the hamiltonian contains usually many unit terms . also common models such as henon - heiles , vibronic",
    "coupling , system - bath , etc . have as well many unit terms in the potential energy part of the operator .",
    "the obvious way to obtain computational savings is to flag all unit terms as such , so that they do not have to be stored as unit matrices and they do not have to be explicitly multiplied .",
    "this is done from the bottom of the tree and proceeding recursively upwards .",
    "if all @xmath93 , then @xmath94 is flagged as @xmath95 .",
    "our implementation keeps track of all unit @xmath68-terms at all layers , which saves resources in the recursive construction of the @xmath68-matrices in eq .",
    "( [ eq : tmat ] ) , in the mean - fields construction in eq .",
    "( [ eq : meanfgen ] ) and in the equations of motion .",
    "once the unit operators at all layers have been flagged as such , it is possible to identify non - correlated terms for a particular node , i.e. terms that decompose as @xmath96 such that the non - unit parts of @xmath97 operate only on the combined coordinate @xmath98 .",
    "the step of identifying separable terms is conveniently done from the top of the tree and proceeding downwards . to illustrate this",
    "let us refer to a simple 4d example and the operator summand @xmath99 the considered tree structure has four primitive nodes @xmath100 , @xmath101 , @xmath102 and @xmath103 with @xmath68-terms @xmath104 , @xmath105 , @xmath106 and @xmath107 , which are the matrix representation of the primitive product terms in eq .",
    "( [ eq : op4d ] ) .",
    "the two nodes at the intermediate layer , namely @xmath108 and @xmath109 , have therefore @xmath68-terms @xmath110 and @xmath111 for node @xmath108 and @xmath68-terms @xmath112 and @xmath113 for node @xmath109 .",
    "the top node @xmath114 has @xmath68-terms @xmath115 and @xmath116 . only in the case",
    "that both @xmath110 and @xmath111 would have been unit operators , would @xmath115 have been marked as a unit operator as well .",
    "now we turn to the identification of non - correlated terms starting from the top of the tree .",
    "@xmath63 is marked as correlated in node @xmath114 because both @xmath115 and @xmath116 are different from the unit operator . at first sight , the @xmath63 term could be flagged as non - correlated in node @xmath108 because only one of the @xmath68-terms is different from unity .",
    "however , the parent node had this term marked as correlated , and therefore @xmath63 is marked as correlated in node @xmath108 .",
    "the reason why this happens is that @xmath63 acts also on node @xmath109 , which is in another branch of the tree .",
    "it is then clear that a convenient way to spot situations of this kind is to proceed recursively from the top of the tree , as illustrated .",
    "ultimately , the @xmath63 term is marked correlated in node @xmath108 because the mean - field matrix elements @xmath117 and @xmath118 correlate the motion of spfs @xmath119 and @xmath120 with the dynamics proceeding in node @xmath109 and below .",
    "the coupling to the dynamics in the other branch arises from the relation of the mean - field elements just mentioned to the mean - fields @xmath121 in the top node , as shown in eq .",
    "( [ eq : meanfgen ] ) .",
    "once the non - correlated terms have been identified for each node , one can exploit , in the same way as in standard mctdh , that for them the mean - field matrix elements become identical to the elements of the density matrix @xmath122 hence , for a particular node with @xmath63 terms @xmath123 to @xmath124 non - correlated , and terms @xmath125 to @xmath126 correlated , eq .",
    "( [ eq : eom2 ] ) can be rewritten as @xmath127 which is the eom for the spfs on which our implementation is based .",
    "the eom for the coefficients follows directly from this equation and eq .",
    "( [ eq : phiml ] ) @xmath128 there is no contribution from @xmath129 because , due to the projector , the spfs are orthogonal to their time derivatives .",
    "hence one may write compactly @xmath130 where a detailed expression for the matrix @xmath131 follows from eqs .",
    "( [ eq : eom2sep ] , [ eq : eom2coef ] , [ eq : phiml ] ) .    as a final comment ,",
    "it is worth mentioning that in large systems with groups of coordinates strongly correlated among them but weakly correlated to other groups , i.e. with some sort of locality , the identification of the correlated terms node by node may become very important .",
    "in such cases there will be many correlated terms in nodes at lower layers , but less of them as one proceeds up to the top of the tree .",
    "such an example is given by be the hh model to be introduced below , where each harmonic oscillator is coupled only to its next neighbors . for similar reasons , when dealing with system - bath hamiltonians with ml - mctdh , it may be advantageous in most cases to separate system and bath already at the top layer .",
    "the ml - mctdh algorithm and implementation described above are applied to two paradigmatic systems . on the one hand",
    "we simulate the hh model for various dimensionalities , and on the other hand we test our implementation on the pyrazine system using the second - order vibronic - coupling hamiltonian of ref .",
    "@xcite .",
    "the hh hamiltonian @xmath132 written here in dimensionless units , offers a convenient playground to investigate the convergence properties and performance of ml - mctdh .",
    "the hh model was used in ref .",
    "@xcite to benchmark the mctdh method and the same hamiltonian with similar parameters is used here for the bechmarking of ml - mctdh . for all simulations we set @xmath133 .",
    "the degree of anharmonicity and coupling are controlled by the single parameter @xmath134 , for which different values are chosen .",
    "the initial amount of energy in the system is easily controlled by the position at which the initial wavepacket is centered for each degree of freedom .",
    "the initial wavepacket is always taken as a hartree product of gaussian functions of width corresponding to the ground vibrational state of the harmonic part of the hamiltonian .",
    "initially , all momenta are set to zero , @xmath135 , and similarly all positions , except for a few coordinates which are displaced by two length units with respect to @xmath136 .",
    "the hh hamiltonian in eq .",
    "( [ eq : hh_model ] ) has dissociative channels due to the cubic terms , which are accessible in the energy range of the reported simulations . to avoid reflections from the grid edges ,",
    "the hamiltonian is augmented with a complex absorbing potential ( cap ) as @xmath137",
    ". further details on the cap used are found in ref .",
    "@xcite . a sine - dvr ( for discrete variable representation )",
    "primitive basis with points between @xmath138 and @xmath139 length units and @xmath140 grid points is used for all coordinates throughout the hh simulations .",
    "all propagations on hh models are carried on up to 30 time units , which roughly corresponds to five oscillation periods @xmath141 in the harmonic limit .",
    "* figure [ fig : tree6 ] around here *    we first concentrate on a 6d hh model .",
    "calculations with @xmath142 and @xmath143 are performed , for @xmath144 .",
    "a value of @xmath144 allows to compare with other works that use the same hamiltonian  @xcite . for the reported 6d calculations ,",
    "the initial wavepacket is centered at @xmath145 for coordinates @xmath146 , @xmath147 and @xmath148 .",
    "standard mctdh ( 2-layer ) and ml - mctdh calculations using a 3-layer scheme are compared , and the trees representing the mctdh and ml - mctdh wavefunctions are displayed in figs .",
    "[ fig : tree6]a and [ fig : tree6]b , respectively . in the mctdh case",
    "every two primitive dof are combined , and @xmath149 equals the number of dvr grid points ( primitive basis functions ) for each dof . in the ml - mctdh wavefunction",
    "an extra layer of td coefficients is introduced , effectively representing the 2d spfs of the combined modes in the original mctdh wavefunction by a new multiconfigurational expansion .",
    "it is worth noting that in the case of having @xmath150 for the ml - mctdh wavefunction , the lowest layer is treated exactly and both mctdh with mode combination and ml - mctdh provide numerically identical results ( for the same number of spfs @xmath151 at the top layer ) .",
    "the different propagations are compared by inspecting the autocorrelation function obtained as @xmath152 .",
    "( this trick  @xcite yields an autocorrelation function which is twice as long as the propagation ) .",
    "the autocorrelation at long times is difficult to converge , since the ( ml-)mctdh wavefunction accumulates error as time increases , providing an adequate quantity to compare the different propagations .",
    "conversely , the spectra corresponding to the autocorrelation functions have the error averaged over the whole energy range , and therefore are not such a good quantity to look at for a stringent comparison .",
    "* figure [ fig : auto6d1 ] around here *    * figure [ fig : auto6d2 ] around here *    results for the low ( @xmath142 ) and high ( @xmath143 ) coupling regimes are shown in figs .",
    "[ fig : auto6d1 ] and [ fig : auto6d2 ] , respectively , where the absolute value of @xmath153 is displayed . in both figs .",
    "[ fig : auto6d1 ] and [ fig : auto6d2 ] , the numbers in parenthesis correspond to @xmath154 in the trees in fig .",
    "[ fig : tree6 ] . for mctdh",
    "@xmath149 equals the number of grid points and is given only for completeness .",
    "in the case of low coupling ( fig .",
    "[ fig : auto6d1 ] ) , all calculations yield almost indistinguishable autocorrelation functions . fig .  [",
    "fig : auto6d1]b displays the difference between autocorrelation functions of the ml - mctdh calculations and the best converged ( 50,24 ) mctdh calculation .",
    "the ( 50,20 ) ml - mctdh calculation is very close to the reference mctdh result .",
    "the calculations that diverge earlier with respect to the reference result are the ( 30,10 ) and ( 50,10 ) ones due a poorer convergence of the lower layer , while the ml - mctdh ( 30,20 ) calculation starts to deviate from the reference result after the system has completed five to six oscillation cycles .",
    "after doubling the strength of the coupling parameter , the situation becomes more complex . in fig .",
    "[ fig : auto6d2]a one sees that after two oscillation periods the autocorrelation functions of the different propagations start to diverge on an appreciable scale . only the best mctdh calculation ( 50,24 ) , and the best ml - mctdh ( 50,20 ) result in very close autocorrelations up to 60 time units .",
    "[ fig : auto6d2]b shows the difference between the ml - mctdh results and the ( 50,24 ) mctdh calculation .",
    "the two worst calculations are clearly the ones with @xmath155 . in this case , the correlation at the lowest layer , i.e. between dof @xmath156 , @xmath157 and @xmath158 is not well represented .",
    "it is important to note that the ( 50,10 ) calculation does _ not _ offer an improvement over the ( 30,10 ) one .",
    "the missing correlation within the logical coordinates in the lowest layer can not be regained by having more spfs in higher layers .",
    "similarly as in standard mctdh calculations , the eigenvalues of the density matrices at each layer , the natural populations ( np ) , provide an indication of the degree of convergence of a calculation . as a rule of thumb , the smallest np should be of the order of @xmath159 to provide good results in many cases , although this can vary depending on what quantity one is trying to compute . for the ( 50,10 ) and ( 50,20 ) ml - mctdh calculations at @xmath160 , the smallest np of the three logical coordinates at the top layer are @xmath161 and @xmath162 , respectively .",
    "therefore , the convergence at the top layer is slightly worse for the ( 50,20 ) case than for the ( 50,10 ) case , even though by comparison to the standard mctdh calculation it is clear that the ( 50,20 ) calculation provides better converged results than the ( 50,10 ) .",
    "hence , by allowing more spfs at the second layer , the evolution of the top layer spfs becomes more complex since they have more variational freedom .    as a remark to the 6d simulations , in this case standard mctdh calculations are more efficient than ml - mctdh ones .",
    "only in the case of having a larger number of dvr points per degree of freedom resulting in very large 2d combined coordinates , would the introduction of a further layer ( compare figs .  [",
    "fig : tree6]a and [ fig : tree6]b ) constitute an advantage .",
    "efficiency issues are discussed later in relation to the larger hh simulations and to pyrazine .",
    "* figure [ fig : tree18 ] around here *    next we discuss simulations on a 18d hh model with @xmath142 .",
    "the initial wavepacket is centered at @xmath145 for coordinates @xmath147 , @xmath163 , @xmath164 and @xmath165 , resulting in an initial energy of @xmath166 .",
    "as in the 6d case , wavepackets are propagated up to 30 time units . for this model we run standard mctdh calculations in which the 18 physical coordinates are grouped into 6 combined modes ( logical coordinates ) with three primitive dofs each .",
    "the tree representation of the mctdh wavefunction is given in fig .  [",
    "fig : tree18]a .",
    "there , @xmath151 is the number of spfs per combined mode and @xmath167 is the number of dvr functions per dof .",
    "two standard mctdh calculations were performed , using @xmath168 and @xmath169 spfs per combined mode , resulting in @xmath170 and @xmath171 configurations , respectively .",
    "ml - mctdh calculations based on the tree structure in fig .",
    "[ fig : tree18]b and using the same hamiltonian and initial conditions were performed as well . in the",
    "ml calculations various basis sizes were employed , always keeping @xmath151 equal to @xmath149 .",
    "the autocorrelation functions resulting from the mctdh and ml - mctdh calculations are presented in fig .",
    "[ fig : auto18d ] , where the numbers in the legend correspond to @xmath151 for mctdh , and to @xmath151 and @xmath149 for ml - mctdh . at the scale shown in fig .",
    "[ fig : auto18d]a all simulations yield very similar results . fig .",
    "[ fig : auto18d]b shows the last revival of @xmath172 in more detail .",
    "the worst result appears to be the standard mctdh calculation with @xmath168 .",
    "the various ml - mctdh calculations approach the @xmath173 result as the size of the basis increases , while the standard mctdh with @xmath169 seems not to be yet be fully converged with respect to the trend of the ml - mctdh simulations .",
    "* figure [ fig : auto18d ] around here *    the set of simulations described above were repeated doubling coupling parameter . for this coupling strength the revivals of the autocorrelation function decay after a few oscillations .",
    "the different simulations yield still similar autocorrelation functions ( fig .",
    "[ fig : auto18dsi]a ) , but differences are now larger than in the small coupling parameter case , which can be seen by inspecting fig .",
    "[ fig : auto18dsi]b . there",
    ", the autocorrelation function between 10 and 30 time units is shown in detail , and after this time the autocorrelation has almost vanished . by looking at the autocorrelation functions of the various mctdh and ml - mctdh simulations",
    "one sees that full convergence with respect to the number of spfs has not been completely reached , even at short propagation times .",
    "full convergence of the 18d hh model with a coupling parameter of @xmath143 is a very demanding task .",
    "the @xmath169 mctdh simulation was run on 8 processors using shared - memory parallelization , for which a speed factor of about 3 can be expected  .",
    "such calculation required 71 hours of wall clock time on the 8 processors and would have taken about 200 hours on a single processor .",
    "about 5 gb of main memory were used for the wavepacket propagation .",
    "in contrast to this , the largest ml - mctdh calculation with @xmath174 required 136 hours of wall - clock time running on a _ single _ processor and the wavepacket propagation used less than 500 mb of main memory , while the @xmath175 ml - mctdh calculation needed only 7 hours on a single processor .",
    "all calculations reported in this paper are performed on an quad - core opteron , processor type 2384 , 2.7 ghz .",
    "* figure [ fig : auto18dsi ] around here *    if we now look at the spectra of the propagated wavepackets obtained by fourier transform ( ft ) of the corresponding autocorrelation functions we see that they are very similar .",
    "the spectra of two mctdh calculations with @xmath176 and @xmath169 are shown in fig .",
    "[ fig : spec18dsi ] .",
    "the @xmath168 case ( not shown ) yields a spectrum very similar to the larger mctdh calculation .",
    "the spectra of two ml - mctdh calculations are also presented in fig .",
    "[ fig : spec18dsi ] , namely the smallest and largest calculations of the ml series .",
    "the spectrum of the mctdh calculation with @xmath176 yields somewhat different intensities in the higher energy range than the other simulations . when closely inspecting the lower energy range ( fig .",
    "[ fig : spec18dsi]b ) one finds a non - negligible energy shift of the spectrum of the small mctdh calculation to higher energies .",
    "interestingly , the @xmath176 standard mctdh propagation required 17 hours running on 8 parallel processors in the same conditions as discussed above .",
    "the number of spfs for this simulation was chosen such that the cost would be comparable to that of the smaller @xmath175 ml - mctdh calculation .",
    "the smaller ml - mctdh calculation required 7 hours of wall - clock time on a single cpu running on the same hardware , and its spectrum is already very similar to the spectra of the larger mctdh and ml - mctdh calculations .    *",
    "figure [ fig : spec18dsi ] around here *    the size of the 18d hh model is such that standard mctdh calculations can still be conducted to a good accuracy .",
    "contrary to the 6d case however , for this dimensionality it already pays off to introduce a further layer in the calculation , and 3-layer ml calculations offer results of similar quality than the standard mctdh ones with a noticeably smaller cost .",
    "finally , we report ml - mctdh simulations on a hh model with 1458 dof and coupling constant @xmath142 .",
    "the system is described in this case by a 7-layer wavefunction . at the top level",
    "the coordinates are divided in three groups of 486 coordinates , which are subsequently divided again in three groups , and so on . this is repeated until groups of two primitive dof are reached in the seventh layer , which are then kept combined . for this deeply layered wavefunction",
    "two limiting cases are numerically investigated .",
    "in example ( 1 ) , dof @xmath177 and @xmath178 are displaced for @xmath179 such that @xmath180 . since the two degrees of freedom are adjacent , there is a coupling term in the hamiltonian between them .",
    "however , @xmath177 and @xmath178 belong to different logical coordinates at all layers of the tree .",
    "they belong to logical coordinates @xmath181 and @xmath182 at the top layer and to coordinates @xmath183 and @xmath184 at the bottom layer , respectively .",
    "in example ( 2 ) , dof @xmath185 and @xmath186 are initially set at @xmath187 .",
    "again , these two dof are coupled in the hamiltonian , but in this case they belong to the same logical coordinate at all levels , starting from logical coordinate @xmath182 at the top layer and down to the same combined mode @xmath188 at the bottom layer . in both cases ,",
    "decoupled reference calculations are also conducted in which the coupling term between dof @xmath177 and @xmath178 for case ( 1 ) and between dof @xmath185 and @xmath186 for case ( 2 ) are eliminated from the hamiltonian .",
    "the simulated system corresponds to a long chain of coupled oscillators . in both cases ( 1 ) and ( 2 ) , the initially displaced degrees of freedom are far from the ends of the chain .",
    "therefore the system dynamics in both cases should be very similar , since the extremes of the chain will play a role only at much longer times than simulated .    * figure [ fig : huge ] around here *    fig .",
    "[ fig : huge]a shows the autocorrelation function of the two decoupled reference calculations . in both cases the wavefunction consists of 5 spfs for each logical coordinate at all layers , which results in @xmath189 td coefficients .",
    "since there is no coupling term in the hamiltonian between the two initially displaced dof , their distance along the tree structure should be irrelevant , and in fact both simulations yield nearly identical results .",
    "when the interaction is turned on , however , the distance between two coupled dof along the tree does matter . in case ( 2 ) the tree distance between dof @xmath185 and @xmath186 is the shortest possible .",
    "[ fig : huge]b shows the autocorrelation of two propagations for case ( 2 ) .",
    "one of them is based on the same wavefunction as the reference results .",
    "a second propagation is based on a wavefunction with 20 spfs for the combined mode containing @xmath185 and @xmath186 , @xmath188 , and 15 spfs for the two neighboring combined modes @xmath190 and @xmath191 .",
    "one layer above the wavefunction has 10 spfs for logical coordinates @xmath192 and its two neighbors @xmath193 and @xmath194 .",
    "further up in the tree , logical coordinates containing @xmath185 and @xmath186 and its two neighbor coordinates have 7 spfs each .",
    "all other logical coordinates at all layers are represented by 4 spfs .",
    "this scheme results in @xmath195 td coefficients . as seen in fig .",
    "[ fig : huge]b , both wavefunctions yield very similar autocorrelations until the end of the simulation . by inspecting the natural populations at the final time for both case ( 2 ) simulations one notices however that the convergence at the lowest layer is rather poor for the homogeneous wavefunction with 5 spfs overall , with a population of the order of @xmath196 for the last natural orbital of coordinate @xmath188 .",
    "when inspecting the populations of the propagation with more spfs for logical coordinates close to the displaced mode @xmath188 , substantially improved values of at least @xmath197 are obtained for all logical coordinates containing @xmath188 at all levels .",
    "example ( 1 ) , in which the distance between both initially displaced dof @xmath177 and @xmath178 is the largest possible within the tree , has a different convergence behavior . fig .",
    "[ fig : huge]c compares two autocorrelations for case ( 1 ) .",
    "a first propagation is based in the same homogeneous wavefunction already discussed for case ( 2 ) .",
    "a second simulation is based on a wavefunction with 15 spfs for logical coordinates @xmath183 and @xmath184 , which respectively contain dof @xmath177 and @xmath178 , and with 7 spfs for logical coordinates containing also @xmath177 and @xmath178 at all layers .",
    "all other logical coordinates have 4 spfs and total number of td coefficients is now @xmath198 . now",
    ", both autocorrelations start to diverge after about 30 time units , and they also start to diverge from the autocorrelations of case ( 2 ) after about the same propagation time . interestingly however , the least populated natural orbitals for logical coordinates @xmath183 and @xmath184 have populations of the order of @xmath199 to @xmath197 , and this is substantially improved to @xmath197 to @xmath159 for the non - homogeneous wavefunction .",
    "all other natural populations in the whole tree structure , for both wavefunctions , remain in the order of @xmath197 or below .",
    "the spectra of cases ( 1 ) and ( 2 ) for the non homogeneous wavefunctions ( fig .",
    "[ fig : huge]d ) agree to each other rather well .",
    "the differences in the autocorrelations are however reflected in a appearance of a few spurious lines with low intensity in the low energy part of the spectrum for case ( 1 ) .",
    "the analysis of case ( 2 ) indicates that when correlated dof are close to each other in the tree structure , i.e. they are connected in the deeper layers of the tree , it is easy to achieve convergence by increasing the number of spfs close to such dof in the tree structure .",
    "even most importantly , one can expect an early convergence to the correct trend , since even with not very good natural populations at low layers the results are already correct .",
    "case ( 1 ) , on the contrary , is an example of the wrong choice of tree structure .",
    "even with natural populations smaller than case ( 2 ) for the homogeneous wavefunction , and populations of the order of @xmath197 in most layers , the results are different from case ( 2 ) and also differ between the two different wavefunctions tried for case ( 1 ) . in case",
    "( 1 ) a general and substantial increase of spfs for the whole tree structure would probably be needed to obtain better converged results . the early convergence of the method with the number of spfs appears to be damaged in case ( 1 ) in light of the difference in results of for the two different wavefunctions tried .",
    "we now turn our attention to the photophysics of pyrazine using the 24d second - order vibronic - coupling hamiltonian of raab _ et al .",
    "_  @xcite . in pyrazine",
    ", the spectrum obtained from excitation to the second excited electronic state @xmath7 presents a broad feature due to the fast decay of the system into the @xmath8 electronic state through a conical intersection .",
    "such a decay occurs during a few ten fs after photoexcitation .",
    "although obtaining the right position and approximate shape of the broad band is relatively straightforward and several different approaches can claim to have achieved it , reproducing the fine details of the absorption spectrum is quite hard , since a good quality propagation up to relatively long times is needed .",
    "therefore , the 24d model of pyrazine in ref .",
    "@xcite has often been used to benchmark different quantum dynamical approaches including semiclassical methods  @xcite , the multiple - spawning method  @xcite , the coupled coherent state method  @xcite , the matching - pursuit / split - operator fourier - transform method  @xcite , and the gaussian - mctdh method  @xcite .    in the 24d simulations reported here",
    ", we use the same dvr and grid points as in the mctdh simulations of refs .",
    "@xcite and @xcite .",
    "these mctdh calculations were based on mode combination scheme in which the 24 primitive coordinates were grouped into the 8 combined modes @xmath200 $ ] , @xmath201 $ ] , @xmath202 $ ] , @xmath203 $ ] , @xmath204 $ ] , @xmath205 $ ] , @xmath206 $ ] and @xmath207 $ ] .",
    "a description of these vibrational modes is found in ref .",
    "@xcite and it is beyond the purpose of this paper to reproduce their discussion here .",
    "all but one of the reported ml - mctdh simulations are based on this set of combined modes , which are then grouped in the ml tree as depicted in fig .",
    "[ fig : treepyr ] .",
    "this makes the ml - mctdh calculations numerically easier to compare to previous mctdh calculations , for example when computing wavefunction overlaps , since the ml - mctdh wavefunction can be easily expanded into the corresponding mctdh form ( if the expanded form is still of a manageable size ) in a similar way as an mctdh wavefunction can be expanded to a standard wavefunction on the primitive grid , eq .",
    "( [ eq : ansatz1 ] ) . in the simulation named ml - mctdh-1 , however , we further divide modes @xmath208 and @xmath209 , which contain coordinates with large primitive grids , in order to better exploit the capabilities of ml - mctdh .",
    "we used @xmath210 as above but : @xmath211 $ ] , @xmath212 $ ] , @xmath213 $ ] , @xmath214 $ ] , @xmath215 $ ] , and @xmath216 $ ] .",
    "this division is accomplished by adding a further ( a sixth ) layer to the tree depicted in fig .",
    "[ fig : treepyr ] .",
    "* figure [ fig : treepyr ] around here *    for non - adiabatic systems with more than one electronic state mctdh is often used in its multi - set formulation  @xcite , in which different sets of spfs are used for each electronic dof .",
    "all pyrazine mctdh calculations discussed here were done using the multi - set formalism . in the multi - set formalism",
    "the spfs of each state are optimal for that state , so that a smaller number of spfs per state are needed than in a single - set calculation .",
    "the computational cost grows exponentially with the product of spfs in each state , but linearly with the number of spfs in different electronic states , which makes multi - set calculations often advantageous with respect to single - set ones for the same system . in ml - mctdh",
    ", a multi - set formulation would be extremely cumbersome because one would end up with several tree structures to be specified , one for each electronic state , and a much more complex algorithm .",
    "on the other hand , the favorable scaling of ml - mctdh with the number of dof makes it unnecessary to use a multi - set ml formulation . in simulations of non - adiabatic systems with ml - mctdh the electronic dof is hence just another coordinate that indexes the electronic states , as in usual single - set mctdh calculations , and the ml - mctdh algorithm remains unchanged .",
    "consequently , in constructing the ml tree , one is free to group the electronic dof in any convenient way with other coordinates and set it in any level of the tree where it may seem appropriate .",
    "for example , if only a subset of coordinates couple the different electronic states and the rest act as a bath , it may make sense to group the electronic dof with the coordinates that control the non - adiabatic coupling , and then the system - bath separation can be placed one level above . in our simulations ,",
    "the top layer contains coordinates @xmath217 , where @xmath218 groups the 24 vibrational modes of the system and @xmath219 denotes the electronic dof .",
    "@xmath218 is further divided into two groups of coordinates , one containing modes @xmath220 and the other one containing the rest of modes .",
    "modes @xmath221 define the `` system '' in 4d models of pyrazine  @xcite , while the rest have been usually termed `` bath '' modes . therefore , the first branching of the tree after separating electronic and vibrational coordinates can be understood as a system - bath separation . the resulting system and bath coordinates",
    "are further divided until modes of a manageable size are reached , as seen in fig .",
    "[ fig : treepyr ] .",
    "* table [ tab : pyr ] around here *    table  [ tab : pyr ] presents some results for a set of ml - mctdh simulations and three different mctdh reference calculations .",
    "the calculation named here mctdh-1 was reported in ref .",
    "the mctdh-2 result was an mctdh reference calculation in ref .",
    "@xcite , while the mctdh-3 calculation is a new reference result for this system and corresponds to the largest mctdh calculation reported for pyrazine to date .",
    "all simulations were run up to a propagation time of 150 fs .    * figure [ fig : pyrauto ] around here *    * figure [ fig : pyrspec_fast ] around here *    fig .",
    "[ fig : pyrauto ] presents the absolute value of the autocorrelation function for the ml - mctdh and mctdh calculations in table  [ tab : pyr ] . as in the hh cases above",
    ", the autocorrelation is computed using the relation for real initial states and symmetric hamiltonians @xmath222 . in fig .",
    "[ fig : pyrauto]b one sees that the ml - mctdh-1 simulation presents severe deficiencies in @xmath172 , only following the general shape of the initial decay and the small revivals between 25 and 45 fs .",
    "this simulation is however extremely fast , needing only 7 minutes to run and consuming an incredibly small amount of resources . regarding peak positions and intensities , the general features of the spectrum in fig .",
    "[ fig : pyrspec_fast]a , although not too accurate , are there .",
    "the details of the peaks below 2.1 ev are not reproduced and the high energy tail , above 2.5 ev , shows an artificial oscillatory behavior .",
    "but beside this , the main peak is amazingly well reproduced , considering the inexpensiveness of the calculation .",
    "the larger ml - mctdh-2 simulation , needing 33 hours ( five times faster than the mctdh-1 reference result ) , already presents the correct trends in the autocorrelation function up to 70 fs , resulting in a much improved spectrum ( figs .",
    "[ fig : pyrspec]a and [ fig : pyrspec]c ) .",
    "the autocorrelations of the two most accurate ml - mctdh simulations present features that resemble closely those of the most accurate mctdh result .",
    "in fact , when comparing the various structures of @xmath172 in fig .",
    "[ fig : pyrauto]c , the tendency of the mctdh-1 , -2 , and -3 simulations is towards the ml - mctdh-8 simulation , which seems to indicate that the best ml - mctdh results are better converged than the best mctdh run .",
    "this can be seen in the height of the structure between 30 and 40 fs , and also in the position of the three peak structures between 55 and 70 fs . when turning to the spectra in fig .",
    "[ fig : pyrspec ] , similar conclusions can be drawn , for example examining closely the peaks at 2.2 and 2.35 ev in fig .",
    "[ fig : pyrspec]b .",
    "it is remarkable that simulation ml - mctdh-7 , which seems to be already better converged than the best mctdh result reported , required about 25% of runtime and 1% of memory ( in terms of wavefunction size ) than the latter .    *",
    "figure [ fig : pyrspec ] around here *    in terms of efficiency , the second column in table  [ tab : pyr ] contains the wall - clock time of each calculation .",
    "all ml - mctdh calculations were run on a single - processor , so cpu time equals in this case wall - clock time , and used the variable mean - field ( vmf )  @xcite propagation scheme .",
    "the mctdh calculations were run using the shared - memory parallelized mctdh code  @xcite and 8 processors in parallel , using the constant mean - field ( cmf ) propagation scheme .",
    "@xcite the speed - up factor of the mctdh parallel computations is 2.9 , 3.3 , and 3.7 for mctdh-1 , -2 , and -3 , respectively , and this factor has been already multiplied to the mctdh wall - clock times , yielding the cpu time that would have been taken on a single cpu so that they can be readily compared to the ml - mctdh values .",
    "these speed - up are reasonable but not particularly good , which is due to the relatively small hamiltonian operator of the pyrazine model and better scalings have been obtained , e.g. for the zundel cation h@xmath223o@xmath224",
    "all calculations were run on the same machine and cpu type ( see caption of table  [ tab : pyr ] ) .",
    "all reported simulations , including the hh ones but except for ml-1 , were run with a rather high integrator precision of @xmath225 .",
    "this was done to exclude any numerical artifacts and to ensure that all discussed effects originate form various sizes of sets of spfs .",
    "the fast but low - accuracy calculation ml-1 was run with an integrator precision of @xmath159 .",
    "reducing the high integrator precision will speed - up the calculations by factors between 1.5 and 2 without introducing visible changes into the spectra .    the third column in table  [ tab : pyr ]",
    "contains the total number of time - dependent coefficients in the wavefunction representation .",
    "two aspects are remarkable here .",
    "first , ml - mctdh wavefunctions are much more compact than mctdh ones .",
    "second , the cpu time divided by the number of coefficients is about one order of magnitude larger in ml - mctdh , this factor remaining quite stable along the series of calculations .",
    "therefore , integrating each coefficient in ml - mctdh is harder than in mctdh due to the natural overhead of the ml - mctdh algorithm .",
    "however , this is compensated by the much smaller number of coefficients in the wavefunction .",
    "such scaling effects become more and more pronounced with the size of the system , as was seen for the hh case , and ml - mctdh propagations seem to become more efficient than mctdh ones in terms of cpu time for systems larger than about 20 dofs .",
    "simulations ml - mctdh-2 to -8 could be made even more efficient further dividing the largest combined modes at the lowest layer in a similar way as it was done for ml - mctdh-1 .",
    "running on 8 processors , mctdh-3 needed about 1000 hours to complete ( unscaled wall - clock time ) , keeping up with the wall - clock time of the best ml - mctdh calculations through parallelization .",
    "the mctdh-3 calculation could in principle be made faster than ml - mctdh using more hardware .",
    "however , for a molecular system doubling the size of pyrazine , a normal mctdh calculation would be probably not doable , or at least not with a reasonable spf basis size .",
    "on the contrary , that case would require an additional layer in a ml - mctdh calculation , and the cpu cost would scale approximately linearly , rendering the simulation still doable . regarding the different approaches tried on the pyrazine hamiltonian over the years , ml - mctdh offers by far the best quality / cost relation .",
    "the ml - mctdh-2 simulation , which is already of a reasonable quality , takes about one day on a single cpu using little resources .",
    "the various ml - mctdh simulations on the cheaper end yield spectra of a quality that other approaches hardly reach  @xcite or reach only by using a much larger amount of cpu and memory resources  @xcite . and",
    "again , accepting slightly larger deviations in the spectrum , an ml - mctdh calculation on pyrazine takes only 7 minutes .",
    "we presented the implementation of the ml - mctdh approach into the heidelberg mctdh package , which is based on the recursive algorithm proposed by manthe .",
    "a discussion of the concept of multilayer was given , and the working equations were provided making emphasis on the key points of the approach . for a comprehensive derivation of the working scheme one should see ref  @xcite .",
    "the use of the separable terms in the hamiltonian in the recursive construction of the @xmath68-matrices and mean - fields at the different layers was discussed here with some detail .",
    "the implementation , numerical performance , and general features of the ml - mctdh approach have been tested by running simulations on the henon - heiles model and on pyrazine . for henon - heiles , simulations for the 6d , 18d and a large 1458d case have been reported . in the 6d and 18d cases ,",
    "normal mctdh calculations are performed for identical parameter sets for comparison , and for the 6d case mctdh is more efficient than ml - mctdh .",
    "the situation already changes for the 18d simulations , in which ml - mctdh outperforms mctdh . with respect to the natural populations , which are often used as a convergence criterion in mctdh calculations",
    ", it is observed that when increasing the number of spfs at lower layers for a given number of spfs at higher layers , the convergence of the higher layer becomes worse although the overall quality may improve .",
    "this is due to the fact that the dynamics at the higher layers becomes more complex after increasing the size of the basis below .",
    "hence , with respect to convergence , all layers have to be monitored when changing the basis size in some other layer .    for pyrazine",
    ", we test ml - mctdh on the second - order vibronic - coupling hamiltonian of raab _ et .",
    "al _ , which has been used in testing several quantum dynamical methods .",
    "by properly choosing the tree scheme , we report a ml - mctdh simulation that takes _ only _ 7 minutes of cpu time in one processor and very few memory , and that recovers the main spectral features reasonably well .",
    "on the other hand , we report ml - mctdh simulations which are converged to at least the same degree as the best reference mctdh results available , taking only 25% of the cpu time and 1% of wavefunction storage space with respect to such reference results .",
    "as seen in the pyrazine case , ml - mctdh allows for a consistent separation of the degrees of freedom considered as system and the ones considered as bath , providing the variationally optimal system - bath evolution for the particular selection of the basis size and the layering scheme . by using ml - mctdh for system - bath problems , schemes that simplify the system - bath _ ansatz _",
    "@xcite or schemes that reduce a larger bath to a subset of effective modes  @xcite , become unnecessary .",
    "ml - mctdh is an efficient tool for model systems , which had already been demonstrated by works of wang and thoss .",
    "ml - mctdh has been shown here to be a very powerful tool to treat more realistic molecular hamiltonians as well .",
    "the fact that a tree structure needs to be chosen , often based on intuition or experience , and that convergence has to be monitored at the different layers , makes its use less straightforward than mctdh .",
    "therefore , some work in the direction of automating certain decisions regarding the tree structure will have to be carried on . regarding efficiency",
    ", it will be interesting to develop good dedicated constant mean - field ( cmf ) propagation schemes @xcite for the ml case . and",
    ", of course , parallelizing the ml - code will be an important step , as ml - mctdh is for treating large systems . beyond applications of ml - mctdh to problems involving nuclear dynamics ,",
    "for which it has certainly a large potential , new directions will have to be explored in the future .",
    "we believe that methods based on or taking advantage of the ml - mctdh concept can be useful in a wide range of situations .",
    "for example , we envisage that in simulations of mixtures of different kinds of particles ( different kinds of fermions and bosons , electrons and nuclei in molecules , etc . ) , the different types of particles can be separated and correlated to each other at the top layer , while the internal dynamics of each group takes place in the layers below .",
    "ml - mctdh constitutes a consistent and powerful tool for the quantum - dynamical description of high dimensional molecular systems .",
    "this and other kinds of challenging applications remain the subject of future investigations .",
    "financial support by the deutsche forschungsgemeinschaft ( dfg ) is gratefully acknowledged .",
    "10    h .- d .",
    "meyer , u.  manthe , and l.  s. cederbaum , chem .",
    "phys .  lett . *",
    "165 * , 73 ( 1990 ) .",
    "u.  manthe , h .-",
    "meyer , and l.  s. cederbaum , j.  chem .",
    "phys . * 97 * , 3199 ( 1992 ) .",
    "m.  h. beck , a.  jckle , g.  a. worth , and h .- d .",
    "meyer , phys .",
    "rep * 324 * , 1 ( 2000 ) .",
    "meyer and g.  a. worth , theor .",
    "acc . * 109 * , 251 ( 2003 ) .",
    "meyer , f.  gatti , and g.  a. worth , editors , , wiley - vch , weinheim , 2009 .",
    "a.  raab , g.  worth , h .-",
    "meyer , and l.  s. cederbaum , j.  chem .",
    "* 110 * , 936 ( 1999 ) .",
    "a.  markmann , g.  worth , s.  mahapatra , h .-",
    "meyer , h.  kppel , and l.  cederbaum , j.  chem .",
    "123 * , 204310 ( 2005 ) .",
    "l.  j. doriol , f.  gatti , c.  iung , and h .- d .",
    "meyer , j.  chem .",
    "* 129 * , 224109 ( 2008 ) .",
    "g.  a. worth , h .-",
    "meyer , h.  kppel , and l.  s. cederbaum , int .",
    "phys .  chem .",
    "* 27 * , 569 ( 2008 ) .",
    "o.  vendrell , f.  gatti , and h .- d .",
    "meyer , j.  chem .",
    "phys . * 131 * , 034308 ( 2009 ) .",
    "f.  richter , p.  rosmus , f.  gatti , and h .- d .",
    "meyer , j.  chem .",
    "* 120 * , 6072 ( 2004 ) .    c.  iung , f.  gatti , and h",
    "meyer , j.  chem .",
    "phys . * 120 * , 6992 ( 2004 ) .    s.  sukiasyan and h .- d .",
    "meyer , j.  chem .",
    "phys . * 116 * , 10641 ( 2002 ) .",
    "f.  otto , f.  gatti , and h .- d .",
    "meyer , j.  chem .  phys . * 128 * , 064305 ( 2008 ) .",
    "t.  wu , h .- j .",
    "werner , and u.  manthe , science * 306 * , 2227 ( 2004 ) .",
    "r.  van harrevelt , g.  nyman , and u.  manthe , j.  chem .  phys . * 126 * , 084303 ( 2007 ) .",
    "s.  bhattacharya , a.  n. panda , and h .- d .",
    "meyer , j.  chem .",
    "phys . * 132 * , 214304 ( 2010 ) .",
    "heitz and h .- d .",
    "meyer , j.  chem .",
    "phys . * 114 * , 1382 ( 2001 ) .",
    "r.  van harrevelt and u.  manthe , j.  chem .  phys . * 121 * , 3829 ( 2004 ) .    c.  crespos , h .-",
    "meyer , r.  c. mowrey , and g.  j. kroes , j.  chem .",
    "phys . * 124 * , 074706 ( 2006 ) .",
    "k.  sakmann , a.  i. streltsov , o.  e. alon , and l.  s. cederbaum , phys .",
    "* 103 * , 2206011 ( 2009 ) .",
    "o.  e. alon , a.  i. streltsov , and l.  s. cederbaum , phys .",
    "a * 373 * , 301 ( 2009 ) .",
    "s.  zllner , h .-",
    "meyer , and p.  schmelcher , phys .",
    "lett . * 100 * , 040401 ( 2008 ) .",
    "t.  b. j.  zanghellini , m.  kitzler and a.  scrinzi , j.  phys .",
    "b * 37 * , 763 ( 2004 ) .",
    "g.  jordan and a.  scrinzi , new  j.  phys .",
    "* 10 * , 025035 ( 2008 ) .",
    "m.  nest , r.  padmanaban , and p.  saalfrank , j.  chem .",
    "phys . * 126 * , 214106 ( 2007 ) .",
    "s.  sukiasyan , c.  mcdonald , c.  destefani , m.  y. ivanov , and t.  brabec , phys .",
    "lett . * 102 * , 223002 ( 2009 ) .",
    "j.  zanghellini , m.  kitzler , c.  fabian , t.  brabec , and a.  scrinzi , laser phys .",
    "* 13 * , 1064 ( 2003 ) .",
    "m.  nest , t.  klamroth , and p.  saalfrank , j.  chem .",
    "* 122 * , 124102 ( 2005 ) .    o.  e. alon , a.  i. streltsov , and l.  s. cederbaum , phys .",
    "a * 77 * , 033613 ( 2008 ) .",
    "h.  wang , j.  chem .",
    "* 113 * , 9948 ( 2000 ) .",
    "m.  nest and h .- d .",
    "meyer , j.  chem .",
    "phys . * 119 * , 24 ( 2003 ) .",
    "s.  r. chinnamsetty , m.  espig , b.  n. khoromskij , and w.  hackbusch , j.  chem .  phys . * 127 * , 084110 ( 2007 ) .",
    "s.  r. white and r.  l. martin , j.  chem .  phys . * 110 * , 4127 ( 1999 ) .    h.  wang and m.  thoss , j.  chem .",
    "phys . * 119 * , 1289 ( 2003 ) .    h.  wang and m.  thoss , j.  chem .  phys . *",
    "124 * , 034114 ( 2006 ) .",
    "i.  r. craig , h.  wang , and m.  thoss , j.  chem .  phys . * 127 * , 144503 ( 2007 ) .",
    "i.  kondov , m.  ek , c.  benesch , h.  wang , and m.  thoss , j. phys .",
    "c * 111 * , 11970 ( 2007 ) .",
    "h.  wang and m.  thoss , new journal of physics * 10 * , 115005 ( 2008 ) .    h.  wang and m.  thoss , j.  chem .  phys . *",
    "131 * , 024114 ( 2009 ) .",
    "u.  manthe , j.  chem .  phys . * 128 * , 164116 ( 2008 ) .",
    "u.  manthe , j.  chem .  phys . * 130 * , 054109 ( 2009 ) .",
    "a.  jckle and h .- d .",
    "meyer , j.  chem .",
    "phys . * 104 * , 7974 ( 1996 ) .",
    "a.  jckle and h .- d .",
    "meyer , j.  chem .",
    "phys . * 109 * , 3772 ( 1998 ) .",
    "l.  d. lathauwer , b.  d. moor , and j.  vandewalle , siam journal on matrix analysis and applications * 21 * , 1253 ( 2000 )",
    ".    l.  d. lathauwer , b.  d. moor , and j.  vandewalle , siam journal on matrix analysis and applications * 21 * , 1324 ( 2000 ) .",
    "u.  manthe , j.  chem .  phys . * 105 * , 6989 ( 1996 ) .    m.  nest and h .- d .",
    "meyer , j.  chem .",
    "phys . * 117 * , 10499 ( 2002 ) .",
    "m.  thoss , w.  h. miller , and g.  stock , j.  chem .",
    "phys . * 112 * , 10282 ( 2000 ) .",
    "m.  ben - nun and t.  j. martnez , adv .",
    "chem . phys . * 121 * , 439 ( 2002 ) .",
    "d.  v. shalashilin and m.  s. child , j.  chem .  phys .",
    "* 121 * , 3563 ( 2004 ) .",
    "d.  shalashilin , j.  chem .  phys . *",
    "132 * , 244111 ( 2010 ) .",
    "x.  chen and v.  s. batista , j.  chem .",
    "* 125 * , 124313 ( 2006 ) .",
    "i.  burghardt , k.  giri , and g.  a. worth , j.  chem .",
    "* 129 * , 174104 ( 2008 ) .",
    "m.  brill , o.  vendrell , f.  gatti , and h .- d .",
    "meyer , shared memory parallelisation of the multi - configuration time - dependent hartree method and application to the dynamics and spectroscopy of the protonated water - dimer , in _ high performance computing in science and engineering 07 _ , edited by w.  e. nagel , d.  b. krner , and m.  resch , pages 141156 , heidelberg , 2008 , springer .",
    "m.  brill , o.  vendrell , and h .- d .",
    "meyer , shared memory parallelization of the multiconfiguration time - dependent hartree method and application to the dynamics and spectroscopy of the protonated water dimer , in _ advances in the theory of atomic and molecular systems _ , edited by p.  piecuch , j.  maruani , g.  delgado - barrio , and s.  wilson , volume  20 , page  69 , springer verlag , 2009 .",
    "m.  h. beck and h .- d .",
    "meyer , z.  phys .",
    "d * 42 * , 113 ( 1997 ) .",
    "u.  manthe , chem .",
    "phys . * 329 * , 168 ( 2006 ) .",
    "m.  brill , o.  vendrell , and h .- d .",
    "meyer , distributed memory parallelisation of the multi - configuration time - dependent hartree method , in _ high performance computing in science and engineering 09 _ , edited by w.  e. nagel , d.  b. krner , and m.  resch , pages 147163 , heidelberg , 2010 , springer .",
    "s.  lpez - lpez and m.  nest , j.  chem .",
    "* 132 * , 104103 ( 2010 ) .",
    "e.  gindensperger , i.  burghardt , and l.  s. cederbaum , j.  chem .  phys . *",
    "124 * , 144103 ( 2006 ) .",
    "* figure [ fig : tree6 ] : * tree structures for the mctdh and ml - mctdh wavefunctions of the 6d henon - heiles simulations .",
    "( a ) mctdh wavefunction tree , in which the coordinates are combined in groups of two . @xmath149 refers in this particular case to the number of primitive basis functions or grid points .",
    "( b ) ml - mctdh wavefunction tree .",
    "this tree is similar to the mctdh tree , but the three combined modes have been separated by adding an extra layer . for",
    "the ml - mctdh wavefunction @xmath226 corresponds now the number of primitive basis functions and for @xmath227 ( and same @xmath151 ) the ml - mctdh case becomes numerically identical to the mctdh one .",
    "* figure [ fig : auto6d1 ] : * ( color ) ( a ) absolute value of the autocorrelation function for various mctdh and ml - mctdh 6d henon - heiles simulations with a coupling parameter @xmath228 . the numbers in parenthesis correspond to ( @xmath229 ) in fig .",
    "[ fig : tree6 ] . in the key ,",
    "plain numbers indicate mctdh calculations and the symbol ml designates ml - mctdh calculations .",
    "( b ) difference between the autocorrelations of the ml - mctdh simulations and the ( 50,24 ) mctdh calculation .",
    "* figure [ fig : auto6d2 ] : * ( color ) ( a ) absolute value of the autocorrelation function for various mctdh and ml - mctdh 6d henon - heiles simulations with a coupling parameter @xmath230 .",
    "the numbers in parenthesis correspond to ( @xmath229 ) in fig .",
    "[ fig : tree6 ] .",
    "( b ) difference between the autocorrelations of the ml - mctdh simulations and the ( 50,24 ) mctdh calculation . in the key , ml is for ml - mctdh .",
    "* figure [ fig : tree18 ] : * tree structures for the mctdh and ml - mctdh wavefunctions of the 18d henon - heiles simulations .",
    "the mctdh wavefunction ( a ) consists of six combined modes , each of them grouping three primitive coordinates .",
    "the ml - mctdh wavefunction ( b ) starts dividing the system in three logical coordinates , and each of them is further divided in three combined modes .",
    "the resulting tree has three layers of td coefficients .",
    "* figure [ fig : auto18d ] : * ( color ) ( a ) absolute value of the autocorrelation function for various mctdh and ml - mctdh 18d henon - heiles simulations with a coupling parameter @xmath228 . for",
    "the mctdh cases the number in parenthesis refers to @xmath151 in fig .",
    "[ fig : tree18]a . for the ml - mctdh cases the number in parenthesis refers to @xmath151 and @xmath149 in fig .",
    "[ fig : tree18]b , which are set equal in the reported simulations .",
    "( b ) detailed view of the last recurrence structure between 55 and 60 time units . in the key",
    ", ml is for ml - mctdh .",
    "* figure [ fig : auto18dsi ] : * ( color ) ( a ) absolute value of the autocorrelation function for various mctdh and ml - mctdh 18d henon - heiles simulations with a coupling parameter @xmath230 . for",
    "the mctdh cases the number in parenthesis refers to @xmath151 in fig .",
    "[ fig : tree18]a . for the ml - mctdh cases",
    "the number in parenthesis refers to @xmath151 and @xmath149 in fig .",
    "[ fig : tree18]b , which are equal in the reported simulations .",
    "( b ) detailed view of the recurrence structures between 10 and 30 time units . in the key",
    ", ml is for ml - mctdh .",
    "* figure [ fig : spec18dsi ] : * ( color ) ( a ) spectra for various mctdh and ml - mctdh 18d henon - heiles simulations with a coupling parameter of @xmath230 .",
    "the numbers in parenthesis have the same meanings as in fig .",
    "[ fig : auto18dsi ] .",
    "( b ) detailed view of the three first peaks between @xmath231 and @xmath232 energy units . in the key",
    ", ml is for ml - mctdh .",
    "the spectra are obtained by a fourier - transform of the autocorrelation function using a @xmath233 filter  @xcite to minimize spurious effects known as gibbs phenomenon .",
    "* figure [ fig : huge ] : * ( color ) absolute value of the autocorrelation of the ml - mctdh 1458d henon - heiles simulations for time units 30 to 60 . ( a ) reference results without coupling term between the two displaced coordinates for case ( 1 ) ( red dashed ) , in which the two initially displaced degrees of freedom belong to different logical coordinates at all layers , and case ( 2 ) ( blue line ) , in which the two initially displaced degrees of freedom belong to the same logical coordinate at all layers .",
    "( b ) for case ( 2 ) , homogeneous wavefunction ( red dashed ) and non homogeneous wavefunction with more spfs at low layers ( blue line ) .",
    "( c ) for case ( 1 ) , homogeneous wavefunction ( red dashed ) and non homogeneous wavefunction ( blue line ) .",
    "the pairs of autocorrelation functions presented in plots ( b ) and ( c ) are almost identical until about 15 time units , but the autocorrelation functions of case ( 1 ) and ( 2 ) start to differ already after 5 time units .",
    "these differences increase with time and can be inspected for the time interval 30 to 60 by comparing figure ( b ) with ( c ) .",
    "( d ) spectra of the calculations with the non homogeneous wavefunctions for cases ( 1 ) and ( 2 ) .",
    "the spectra are obtained by a fourier - transform of the autocorrelation function using a @xmath233 filter  @xcite to minimize spurious effects known as gibbs phenomenon .",
    "* figure [ fig : treepyr ] : * tree structure used in most of the ml - mctdh simulations of 24d pyrazine .",
    "the maximum depth of the tree is five layers , and the first one separates the 24 vibrational coordinates and the discrete electronic degree of freedom .",
    "the number of spfs denoted @xmath234 need not be necessarily the same , and in fact in some of the ml - mctdh simulations they are chosen to be different .",
    "the same is true for the three @xmath235 s , which can be different .",
    "for the fast ml-1 calculation a 6th layer was added , see text .",
    "* figure [ fig : pyrauto ] : * ( color ) absolute value of the autocorrelation function for the 24d pyrazine calculations .",
    "the numeration of the calculations is consistent with table  [ tab : pyr ] .",
    "( a ) best mctdh result and two best ml - mctdh results from 0 to 300 fs .",
    "( b ) detailed view of the recurrences between 20 and 70 fs for all reported mctdh simulations and the best ml - mctdh simulation ( b ) , and for the two worst and two best converged ml - mctdh runs ( c ) . in the key , ml is for ml - mctdh .",
    "* figure [ fig : pyrspec_fast ] : * ( color ) ( a ) spectra of the fastest ml - mctdh 24d pyrazine calculation ( @xmath236 td coeff .",
    ", 7 min . of cpu ) and the best reference mctdh result ( @xmath0 td coeff .",
    ", 2901 hours of cpu ) .",
    "( b ) detailed view of the energy domain between 2.1 and 2.6 ev .",
    "the spectra are obtained by a fourier - transform of the autocorrelation function using a @xmath233 filter  @xcite to minimize spurious effects known as gibbs phenomenon .",
    "the numeration of the calculations is consistent with table  [ tab : pyr ] . in the key ,",
    "ml is for ml - mctdh .",
    "* figure [ fig : pyrspec ] : * ( color ) ( a ) spectra of the three reference mctdh simulations and three of the ml - mctdh simulations , among them the two best results , for 24d pyrazine .",
    "the spectra are obtained by a fourier - transform of the autocorrelation function using a @xmath233 filter  @xcite to minimize spurious effects known as gibbs phenomenon .",
    "the numeration of the calculations is consistent with table  [ tab : pyr ] . for the energy domain between 2.1 and 2.6 ev : ( b ) the three reference mctdh calculations compared to the best ml - mctdh result and ( c ) ml - mctdh simulations 2 , 7 and 8 . in the key , ml is for ml - mctdh ."
  ],
  "abstract_text": [
    "<S> the multilayer multiconfiguration time - dependent hartree ( ml - mctdh ) method is discussed and a fully general implementation for any number of layers based on the recursive ml - mctdh algorithm given by manthe [ j. chem . </S>",
    "<S> phys . * 128 * , 164116 ( 2008 ) ] is presented . </S>",
    "<S> the method is applied first to a generalized henon - heiles ( hh ) hamiltonian . </S>",
    "<S> for 6d hh the overhead of ml - mctdh makes the method slower than mctdh , but for 18d hh ml - mctdh starts to be competitive . </S>",
    "<S> we report as well 1458d simulations of the hh hamiltonian using a seven layer scheme . </S>",
    "<S> the photoabsorption spectrum of pyrazine computed with the 24d hamiltonian of raab _ et . </S>",
    "<S> al . _ </S>",
    "<S> [ j. chem . </S>",
    "<S> phys . * 110 * , 936 ( 1999 ) ] provides a realistic molecular test case for the method . </S>",
    "<S> quick and small ml - mctdh calculations needing a fraction of the time and resources of reference mctdh calculations provide already spectra with all the correct features . accepting slightly larger deviations , the calculation can be accelerated to take only 7 minutes . when pushing the method towards convergence , </S>",
    "<S> results of similar quality than the best available mctdh benchmark , which is based on a wavepacket with @xmath0 time - dependent coefficients , are obtained with a much more compact wavefunction consisting of only @xmath1 coefficients and requiring a shorter computation time . </S>"
  ]
}