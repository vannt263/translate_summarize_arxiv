{
  "article_text": [
    "the calculus of relations @xcite consists of five natural operations on binary relations : union , intersection , complementation , composition , and converse . these operators can be applied to given binary relations , combined with the four standard constant relations : empty , all , identity , and diversity .",
    "the calculus of relations is a very natural formalism and occurs within logics for reasoning about binary relations , notably dynamic and description logics @xcite .",
    "the calculus also has historically motivated the development of the theory of relation algebras @xcite . in the present paper , however , we are not looking at abstract relation algebras , but rather at the question of _ indistinguishability _ of two given finite binary relational structures within the calculus of relations .",
    "this paper has been inspired by the authors ongoing research program to understand in a precise way the expressive power of the calculus of relations as a database query language for binary relation structures @xcite .",
    "indistinguishability of structures in various logics is one of the most basic tools in the study of the expressive power of database query languages as well as in finite model theory @xcite . indeed",
    "the calculus of relations , as a core relational algebra query language on binary relations , is very relevant to the field of databases .",
    "binary relations ( directed graphs ) show up naturally in data on the web @xcite , dataspaces @xcite , linked data @xcite , and rdf data @xcite .",
    "moreover , in restriction to directed graphs that are trees , the relational calculus is closely tied to the xml query language xpath , and the expressive power of xpath and various fragments has been intensively investigated @xcite .    here , working with general finite binary relation structures rather than trees , we consider , in addition to the five binary relation operations and four constant binary relations mentioned above , also four derived operations that are well known in the literature : set difference ; projection ; coprojection ; and residuation .",
    "these derived operations can be expressed in terms of the other operations and constants , but can still be interesting on their own when considering fragments where some other operations or constants have been left out .",
    "we consider set difference because it is the standard domain - independent alternative to complementation in database query languages @xcite .",
    "we consider projection and coprojection ( existential and universal quantification ) because they are standard logical operations , and have been shown important in the xpath setting @xcite , so it is natural to study their behaviour when generalising from trees to general graphs .",
    "finally , we consider residuation because it is similar to the standard relational division operation in databases , and corresponds to the set containment join @xcite .",
    "obviously , one could keep on inventing additional operations on binary relations and study their interdependencies , but our chosen set of operations is not too large and well - motivated from the point of view of query languages .",
    "our goal now is to understand the relative importance of the various operations and the effect of their presence on indistinguishability .",
    "thereto we consider all possible fragments of the calculus of relations that can be constructed as follows .",
    "the most basic fragment we consider has the empty and identity relations as constants , and the operations union , composition , and intersection .",
    "then all other fragments arise by adding any choice of the remaining operations and constants .",
    "for each fragment , we provide a characterization of when two finite binary relation structures are indistinguishable by expressions in the fragment .",
    "our approach follows the one outlined by goranko and otto @xcite : we provide new notions of finite - round ( degree - bounded ) bisimulations , appropriate for fragments of the calculus of relations , and give characteristic expressions for them . for finite structures , such an approach immediately leads to a hennessy  milner - type theorem @xcite .",
    "one may ask why intersection is present in all the fragments we consider .",
    "intersection is the most basic query language primitive @xcite .",
    "our results rely heavily on its presence , in the same way as the classical hennessy ",
    "milner theorem relies heavily on the presence of conjunction in the modal logic .",
    "intersection is known not to be `` safe for bisimulation '' @xcite .",
    "nevertheless , the question whether or not all operations in a certain query language are safe for bisimulation appears to be quite different from the problem of the present paper : that of determining whether or not two given structures can be distinguished in a certain query language .",
    "this is not to say , however , that indistinguishability of structures in fragments lacking intersection is uninteresting .",
    "but it changes the nature of the problem so drastically that we leave omitting intersection outside the scope of the present paper .",
    "for example , consider the fragment consisting only of composition and nothing else .",
    "then indistinguishability of finite structures amounts to the equivalence problem for finite automata , which is pspace - complete @xcite .",
    "in contrast , for all fragments considered in this paper , we will see that indistinguishability is decidable in polynomial time .",
    "as mentioned above , bisimilarity - like characterizations of indistinguishability are common in modal logics . for non - modal logics , such as first - order logic",
    ", indistinguishability is typically captured by ehrenfeucht - frass games .",
    "there also exist intermediate fragments of first - order logic , such as the guarded and the packed fragments @xcite , where indistinguishability can still be captured by appropriate notions of bisimulation .",
    "note , however , that most of the fragments considered in this paper are not subsumed by the packed fragment . for example , the expressions @xmath0 , or @xmath1 , or @xmath2 , are not expressible in the packed fragment .",
    "stands for the left residual , @xmath3 stands for set difference , and @xmath4 stands for coprojection ; these operators will be defined in the next section . ]",
    "note als that projection such as as occurring in , e.g. , @xmath5 , is in general not equivalent to guarded existential quantification . only the `` positive '' fragments , that include none of the residuals , set difference , complementation , and coprojection , fall in the packed fragment .    to conclude this introduction",
    ", we note another motivation to understand indistinguishability in database query language fragments , apart from the relevance to expressive power and the intrinsic foundational motivation .",
    "this is the new approach of _ structural _ indexing to database query processing , proposed by some of us and others @xcite , whereby a given query expression is processed by accessing blocks of data indistinguishable by the operations used in the given expression . by the results of our work",
    ", these blocks can be computed using similarity or bisimilarity checks .",
    "[ [ summary ] ] summary + + + + + + +    the further contents of this paper may be summarized as follows . in section  2",
    "we define the language fragments formally , and define the notion of indistinguishability . in section  3",
    "we discuss different ways how indistinguishability can be characterized ; in particular we discuss the connection with multi - dimensional modal logics , and the 3-variable fragment of first - order logic . in section  4 , we define finite - round bisimulations appropriate for the fragments with the set difference operation . in section  5 , we define finite - round simulations appropriate for the fragments without set difference . in section  6 we given hennessy  milner - type theorems for indistinguishability of finite structures .",
    "we conclude in section  7 .",
    "we assume an infinite universe of atomic data elements , denoted by @xmath6 .",
    "a _ binary relation _ on @xmath6 is a subset of @xmath7 .",
    "we further fix an arbitrary finite set @xmath8 of _ relation names _ , called the _ vocabulary_. in the calculus of relations , a _ structure _ is a pair @xmath9 where @xmath10 is a subset of @xmath6 and each @xmath11 is a binary relation on @xmath10 .",
    "the set @xmath10 is called the set of nodes of @xmath12 ; the vocabulary @xmath13 can be thought of as a set of edge labels whereby @xmath12 can be thought of as an edge - labeled directed graph .",
    "when @xmath10 is finite , the structure is said to be a _ finite _ structure .",
    "expressions in the calculus of relations are built recursively from the relation names @xmath14 , and the constant symbols empty ( @xmath15 ) , all ( @xmath16 ) , diversity ( @xmath17 ) , and identity ( @xmath18 ) , using the following standard and/or derived operations .",
    "the standard operations are union @xmath19 , intersection @xmath20 , complementation @xmath21 , composition @xmath22 , and converse @xmath23 ; the derived operations we consider are set difference @xmath24 , projection ( @xmath25 or @xmath26 ) , co - projection ( @xmath27 or @xmath28 ) , left residual ( @xmath29 ) and right residual ( @xmath30 ) . ) for set difference . ]",
    "semantically , on any structure @xmath12 as above , an expression @xmath31 defines a binary relation , denoted by @xmath32 . for convenience",
    ", we recall the semantics of the constants and the standard operations . @xmath33",
    "the semantics of the derived operations is as follows : @xmath34    [ ex : intro - example ] figure  [ fig : intro - example ] shows a finite structure @xmath12 .",
    "the set of nodes equals @xmath35 , and the vocabulary @xmath13 equals @xmath36 .",
    "* the doctors ( i.e. , persons having patients ) , can be retrieved from @xmath12 by the expression @xmath37 resulting in @xmath38 . *",
    "the people and the doctors they know can be obtained by the expression @xmath39 resulting in @xmath40 . * the doctors and the hospitals where they practice : @xmath41 * ill people without medical care : @xmath42 * healthy doctors : @xmath43 *",
    "finally , the doctors who know all the patients of some other doctor can be retrieved by the expression @xmath44 which on our example graph yields the empty relation , since the graph contains only one doctor .",
    "expressions in the calculus of relations express queries .",
    "formally , a _ query _ is a mapping @xmath45 from the set of all structures to the set of all binary relations on @xmath46 , such that for each structure @xmath12 , if @xmath47 is the node set of @xmath12 , then @xmath48 is a binary relation on @xmath47 .",
    "obviously the query @xmath45 expressed by an expression @xmath31 is simply defined by @xmath49 .",
    "two expressions @xmath50 and @xmath51 are now called _",
    "equivalent _ , denoted by @xmath52 , if they express the same query , i.e. , if @xmath53 for all possible structures @xmath12 .",
    "the following equivalences demonstrate that the derived operations are indeed derived , and also present some additional interdependencies among the constants and operations considered in this paper : @xmath54    of course the above list of equivalences is by no means complete .",
    "for example , another well - known equivalence is @xmath55",
    ". it will be useful to have the following generalization of this equivalence :    [ convprop ] every expression @xmath31 is equivalent to an expression @xmath56 that uses the same operations as @xmath31 , and in which converse is only applied to relation names .",
    "we actually show the claim not for @xmath31 but for @xmath57 ; the claim for @xmath31 then follows by applying it to each topmost application of converse within @xmath31 .",
    "we go by induction on the structure of @xmath31 .",
    "the case where @xmath31 is a relation name is trivial .",
    "the constants are all equivalent to their converse .",
    "when @xmath31 is of the form @xmath58 , we have @xmath59 , which can be put in the required form by the induction hypothesis . when @xmath31 is @xmath60 , we have @xmath61 , and similarly when @xmath31 is @xmath62 or @xmath63 . when @xmath31 is @xmath64 , we have @xmath65 . when @xmath31 is @xmath66 , we have @xmath67 , and similarly for @xmath68 , @xmath69 , and @xmath70 .",
    "finally , we have @xmath71 and @xmath72 .",
    "we will consider various fragments of the calculus of relations .",
    "the most basic fragment we consider is denoted by @xmath73 : it has the constants @xmath15 and @xmath18 and the operators composition , union , and intersection .",
    "all other fragments are defined by adding to @xmath73 some additional constants and operators .    formally , for any subset and @xmath74 ) or none of them , and similarly for coprojection .",
    "this simplification is not essential to our results , however . ]",
    "@xmath75 of @xmath76 , we define the fragment @xmath77 consisting of the expressions built up from the relation names , @xmath78 , @xmath18 , and the constants from @xmath75 , using the operations composition , union , intersection , and the operations from @xmath75 .",
    "the fragment @xmath79 already amounts to the full calculus , since , by the equivalences listed above , all other operations can be derived in it .",
    "more precisely , from the listed equivalences , we can note the following :    * any fragment containing complement also includes @xmath16 , @xmath17 , difference , projection , and coprojection . *",
    "any fragment containing @xmath17 also includes @xmath16 . *",
    "any fragment containing converse , @xmath17 , or coprojection , also includes projection . *",
    "any fragment containing projection and difference also contains coprojection .",
    "* any fragment containing both converse and complement also contains both residuals .",
    "accordingly , we say about a fragment @xmath77 that    * _ 1 is present in @xmath77 at degree 0 _ if @xmath75 contains 1 , @xmath80 , or complement ; * _ 1 is present in @xmath77 at degree 1 _ if 1 is not present at degree 0 , and @xmath75 contains the left or right residual .",
    "* _ 1 is absent from @xmath77 _ if 1 is neither present at degree 0 nor at degree 1 .",
    "the idea behind these notions is that @xmath81 is expressible as @xmath82 or as @xmath83 .",
    "we will see later that these two expressions have degree one , as opposed to the expressions for 1 that have degree zero , viz .",
    ", 1 itself , @xmath84 , or @xmath85 .",
    "the distinction between presence at degree 0 , presence at degree 1 , and absence of 1 in a fragment will manifest itself in definition  [ defpath ] .    that @xmath81 is expressible in terms of @xmath78 and the residuals shows that our choice in this paper to include @xmath78 by default in all fragments is not totally innocent , at least not in the presence of the residuals .",
    "we do not anticipate , however , that adapting the results of this paper to a setting where @xmath78 is absent should require new techniques . on a related note",
    ", it is also interesting to point out that using @xmath78 and the left residual , the first coprojection becomes expressible as @xmath86 .",
    "it is customary in finite model theory @xcite to parameterize characterizations of indistinguishability by the quantifier rank of formulas . in our setting",
    ", the role of quantifier rank will be played by what we call the degree .    for an expression @xmath31",
    ", we define the _ degree _ @xmath87 of @xmath31 as follows . every relation name and constant symbol",
    "has degree zero .",
    "then , @xmath88 the degree of an expression is the maximum depth of nested applications of the composition , projection , co - projection , and the left and right residual operation .",
    "intuitively , the degree corresponds to the quantifier rank of @xmath31 translated into first - order logic .    for a fragment @xmath75 of the calculus of relations and a natural number @xmath89",
    ", we denote the set of expressions in @xmath77 of degree at most @xmath89 by @xmath90 .    before introducing the crucial definition  [ defpath ] below ,",
    "we need to agree on a natural way to view structures as directed , or as undirected graphs .",
    "[ defgraph ] let @xmath91 be a structure .",
    "then @xmath92 is defined as the directed graph @xmath93 where @xmath94 equals the set of all pairs @xmath95 in @xmath96 such that @xmath97 for some @xmath14 .",
    "moreover , @xmath98 is defined as the undirected version of @xmath99 , i.e. , as the undirected graph @xmath100 where @xmath101 is the set of all unordered pairs @xmath102 such that @xmath95 or @xmath103 belongs to @xmath94 .    for any natural number @xmath89",
    ", we further define @xmath104 as the set of all pairs @xmath95 in @xmath96 such that there is a path from @xmath105 to @xmath106 in @xmath92 of length at most @xmath107 .",
    "( the length of a path equals its number of edges , and we agree that there is a path of length @xmath78 from @xmath105 to @xmath105 for any @xmath108 , i.e. , @xmath109 is always in @xmath104 for any @xmath89 . )",
    "we define @xmath110 similarly , but considering paths in the undirected graph @xmath111 .",
    "we now give :    [ defpath ] let @xmath77 be a fragment of the calculus of relations and let @xmath12 be a structure . for any natural number @xmath89 , we define @xmath112 as follows .",
    "* first , consider the case where 1 is absent in @xmath77 .",
    "if @xmath75 does not contain converse , then @xmath112 is defined to be @xmath104 ; if @xmath75 does contain converse , then @xmath112 is defined to be @xmath110 .",
    "* next , assume 1 is present at degree 1",
    ". then @xmath113 is defined exactly as above for @xmath114 , but @xmath112 for @xmath115 is simply @xmath116 . * finally , 1 is present at degree 0 , then @xmath112 is again simply @xmath116 for all @xmath89 including zero .",
    "we immediately note the following    [ lempaths ] for each @xmath75 and each @xmath89 , the query @xmath117 is expressible in @xmath90 .    in the ( easy ) proof of the lemma , we will use the notion of _ atomic expression _ which will also be used throughout the paper , so we define it separately here :    [ defatom ] the _ atomic _ expressions are those from the finite set @xmath118 .",
    "the set of atomic expressions belonging to @xmath77 is denoted by @xmath119 .",
    "note that by proposition  [ convprop ] , we can indeed assume for any expression that the leaves of its syntax tree are labeled by atomic expressions .",
    "now to the    when 1 is absent , the lemma follows from the following equivalences : @xmath120    when 1 is present at degree 1 , @xmath121 is expressed as above and @xmath117 being equivalent to 1 , can be expressed by @xmath82 or @xmath83 . when 1 is present at degree 0 , @xmath122 is again equivalent to 1 and expressible by 1 itself , @xmath84 , or @xmath85 .",
    "the next proposition shows the relevance of @xmath117 .",
    "[ leminpaths ] let @xmath75 be a fragment of the calculus of relations and let @xmath12 be a structure . for any natural number @xmath89 and any expression @xmath123 , we have @xmath124 .    by the definition of @xmath117 , the statement of the lemma is trivial when 1 is present in @xmath77 at degree 0 .",
    "also when 1 is present at degree 1 , the lemma is trivial , except for the case @xmath114 , but then @xmath125 where @xmath126 is obtained from @xmath75 by removing the residuals .",
    "note that 1 is absent in @xmath126 and that @xmath127 .",
    "hence , it suffices to prove the lemma for the case that 1 is absent from @xmath77 .",
    "this means that @xmath75 does _ not _ contain 1 , @xmath80 , complement , and the residuals .",
    "we now proceed by structural induction on @xmath31 .",
    "if @xmath128 , then @xmath129 by definition of @xmath113 .",
    "if @xmath31 is @xmath60 , @xmath62 , or @xmath63 , the result follows immediately from the induction hypothesis .",
    "if @xmath31 is @xmath66 , @xmath68 , @xmath69 , or @xmath130 , the result is immediate because @xmath131 .",
    "( similarly for @xmath68 , @xmath69 , and @xmath130 . )    finally , if @xmath31 is @xmath132 , let @xmath133 , @xmath134 , and @xmath135 .",
    "note that @xmath136 .",
    "now assume @xmath137 .",
    "then , for some @xmath138 , we have @xmath139 and @xmath140 . by induction , we have @xmath141 and @xmath142 , whence @xmath143 as desired .      a _ marked structure _",
    "@xmath144 is a pair @xmath145 where @xmath12 is a relational structure , and @xmath146 is an ordered pair of nodes from @xmath12 .",
    "let @xmath77 be a fragment of the calculus of relations , and let @xmath89 be a natural number .",
    "the _ @xmath90-type _ of @xmath144 , denoted by @xmath147 , is defined as the set of all expressions @xmath148 such that @xmath149 . for two marked structures @xmath150 and @xmath151",
    ", we write @xmath152 if @xmath153 , i.e. , for every expression @xmath148 such that @xmath154 , also @xmath155 .",
    "we then say that @xmath156 is _ one - sided indistinguishable _ from @xmath157 in @xmath90 .",
    "when both @xmath152 and @xmath158 , we say that @xmath157 and @xmath156 are _ indistinguishable in @xmath90 _ and denote this by @xmath159 .",
    "recalling definition  [ defatom ] , we also define the _ atomic _ @xmath75-type of @xmath144 , denoted by @xmath160 , as @xmath161 .",
    "note that @xmath160 is always a subset of @xmath119 .",
    "since indistinguishability is the same as one - sided indistinguishability in both directions , it is more general to look for a characterization of one - sided indistinguishability , and that is what we will do . on the other hand , when the fragment contains complement or difference , one - sided indistinguishability actually coincides with indistinguishability , except in a trivial case :    [ vier ] let @xmath77 be a fragment of the calculus of relations so that @xmath75 contains complement or difference .",
    "let @xmath162 and @xmath163 be two marked structures , and let @xmath89 be a natural number .",
    "then @xmath164 whenever @xmath165 . when @xmath166 , the one - sided indistinguishability @xmath167 holds trivially , and @xmath159 holds if and only if @xmath168 .",
    "we first show that , when @xmath169 , then @xmath152 implies @xmath170 .",
    "thereto , let @xmath148 such that @xmath171 ; we must show that @xmath172 belongs to @xmath173 .",
    "assume , for the sake of contradition , that it does not . then @xmath174 .",
    "note that when @xmath75 would not contain difference , it would contain complement , and then the expression @xmath175 can be equivalently written in @xmath77 as @xmath176 . in either case , the expression has degree @xmath89 , so , since @xmath177 , we have @xmath178 . in particular it follows @xmath179 which yields the desired contradiction .",
    "when @xmath166 , then @xmath152 is indeed voidly satisfied , since in that case , by proposition  [ leminpaths ] , the @xmath180 is empty .",
    "moreover then , clearly @xmath159 iff @xmath181 does not belong to @xmath173 , for any @xmath148 , either .",
    "we now note that the latter holds iff @xmath182 . indeed ,",
    "the only - if is clear since @xmath183 belongs to @xmath90 ; the if - direction is again given by proposition  [ leminpaths ] .",
    "similarly to indistinguishability in @xmath90 , i.e. , for a fixed degree @xmath89 , we are also interested in indistinguishability in an entire fragment @xmath77 .",
    "thus define the _",
    "@xmath75-type _ of a marked structure @xmath144 , denoted by @xmath184 , as the set of all expressions @xmath31 from @xmath77 such that @xmath149 . using this notion of type",
    "we can now define the indistinguishability notions @xmath185 and @xmath186 similarly to the fixed - degree case .",
    "before discussing indistinguishability for fragments of the calculus of relations , let us first look at the full calculus @xmath187 , with @xmath188 consisting of complement and converse .",
    "tarski and givant showed that the calculus has equal expressive power as fo@xmath189 : the formulas with two free variables in the three - variable fragment fo@xmath190 of first - order logic @xcite .",
    "for fo@xmath190 , we have the three - pebble ehrenfeucht - frass game as a characterization  @xcite .",
    "marx and venema , however , showed that fo@xmath189 has also the same expressive power as arrow logic  @xcite , a branch of multi - dimensional modal logic devised to provide a formalization for simple reasoning about objects that are thought of as arrows . by this correspondence , bisimulations in terms of back - and - forth conditions that are well known from modal logic",
    "can be used to characterize fragments of fo@xmath190 , and , hence , of the calculus of relations .    concretely , the language of arrow logic is a modal language with the dyadic operator @xmath191 , the monadic operator @xmath192 , and the modal constant @xmath193 .",
    "formulas in arrow logic are built up from a set of propositional variables and the modal constant @xmath193 , using the operators @xmath191 and @xmath192 , and the boolean connectives @xmath194 , @xmath195 , @xmath196 . using propositional variables to denote edge labels ; by interpreting the modal constant @xmath193 as being true for pairs @xmath197 of identical nodes ; by interpreting the monadic operator @xmath192 as being true for pairs @xmath198 of `` arrows '' such that the first arrow is the converse of the second arrow ; and finally , by interpreting the dyadic operator @xmath191 as being true for triples @xmath199 of arrows",
    "such that the first one is obtained by composing the second and the third arrow , we can apply the characterization theorem of modal logic to immediately obtain a characterization for the full calculus of relations .",
    "we will next make this more precise .",
    "the notion of bisimulation for multi - dimensional modal logic , specialized to the above interpretation of arrow logic , becomes the following :    [ def : bisim - arrow ] let @xmath200 and @xmath201 be two structures with node sets @xmath202 and @xmath203 , respectively .",
    "a non - empty relation @xmath204 is an _ arrow - logic bisimulation _ between @xmath200 and @xmath201 if it satisfies the following conditions :    atoms : :    if @xmath205 is in @xmath206 , then    @xmath207 if and only if    @xmath208 , for all    @xmath14 ; forth : :    if @xmath209 , then    +    composition(@xmath191 ) ; ;      for each @xmath210 there exist      @xmath211 such that both      @xmath212 and @xmath213      are in @xmath206 ;    identity(@xmath193 ) ; ;      if @xmath214 then @xmath215 ;    converse(@xmath192 ) ; ;      @xmath216 ; back : :    if @xmath205 is in @xmath206 , then    +    composition(@xmath191 ) ; ;      for each @xmath211 there exist      @xmath210 such that both      @xmath212 and @xmath213      are in @xmath206 ;    identity(@xmath193 ) ; ;      if @xmath215 then @xmath214 ;    converse(@xmath192 ) ; ;      @xmath216 .    a marked structure @xmath217 is said to be _ arrow - logic bisimilar _ to a marked structure @xmath218 if there is an arrow - logic bisimulation @xmath206 between @xmath200 and @xmath201 containing @xmath205 .",
    "the following characterization is now given by the hennessy - milner theorem ( * ? ? ?",
    "* theorem 2.24 ) :    let @xmath150 and @xmath219 be _ finite _ marked structures .",
    "then @xmath220    in the field of databases ( * ? ? ?",
    "* chapter  5 ) , it is good practice to employ `` safe '' query languages , meaning that 1 is not expressible , i.e. , queries are domain - independent .",
    "this would mean replacing the complementation operator by the difference operator , and removing the diversity relation , leading to the fragment @xmath221 , with @xmath222 consisting of difference and converse .",
    "furthermore , in database theory much attention is being paid to `` positive '' query languages , i.e. , without the difference operator .",
    "since it is still important to understand the distinction between safe and unsafe query languages , one might add the diversity relation back in , which would lead one to fragments such as @xmath223 .",
    "( note that adding diversity to @xmath222 would bring us back to the full calculus , since 1 is expressible as @xmath224 and then complement @xmath225 as @xmath226 . ) also , one may be interested in understanding the power of following relations backwards , and study fragments where converse is removed , such as @xmath227 or @xmath228 . then again one may add derived operations ( projection , coprojection , residuals ) that become primitive in specific fragments , leading to new fragments such as @xmath229 or @xmath230 .    for some fragments discussed above",
    ", the hennessy - milner theorem adapts easily . as a case in point ,",
    "consider the positive fragment with diversity , @xmath223 . to account for the absence of complementation",
    ", it suffices in the definition of bisimulation to remove the back condition , thus obtaining a kind of _ simulation _ rather than bisimulation . to account for the diversity relation , it suffices to add it as a nullary modality by adding the following part to the forth - condition :    diversity(@xmath231 ) : :    if @xmath232 , then @xmath233 .",
    "we can then analogously show that @xmath234 if and only if there exists such a diversity - simulation from @xmath200 to @xmath201 containing @xmath205 .",
    "many other fragments , however , require much less obvious adaptations to the notion of bisimulation for arrow logic .",
    "for instance , the coprojection and residual operations can not simply be considered to be extra modalities in arrow logic .",
    "another difficulty arises when we remove the converse operator or the diversity relation .",
    "expressions in such fragments always return paths in the graph formed by the atomic steps ( proposition  [ leminpaths ] )",
    ". it does not suffice now to remove the converse - forth or the diversity - forth parts in the definition of bisimulation ; we also need to adapt the composition - forth part .    in the remainder of this paper",
    ", we will show how appropriate notions of simulation and bisimulation can be defined for all fragments @xmath77 of the calculus of relations considered in this paper .",
    "we conclude the present section with a few examples of ( in)distinguishability .",
    "thereto we introduce five example structures in the vocabulary of a single relation name @xmath235 , shown in figure  [ figraphs ] .    c@c    c @xmath236 +    \\(1 ) at ( 0,0 ) [ scale=0.6,circle , fill , label = below:@xmath81 ] ; ( 2 ) at ( 1,0 ) [ scale=0.6,circle , fill , label = below:@xmath238 ; ( 3 ) at ( 2,0 ) [ scale=0.6,circle , fill , label = below:@xmath239 ; ( 4 ) at ( 3,0 ) [ scale=0.6,circle , fill , label = below:@xmath240 ; ( 5 ) at ( 4,0 ) [ scale=0.6,circle , fill , label = below:@xmath241 ; ( 1 ) edge[- > ] ( 2 ) ( 2 ) edge[- > ] ( 3 ) ( 3 ) edge[- > ] ( 4 ) ( 4 ) edge[- > ] ( 5 ) ;    &    c @xmath242 +    \\(2 ) at ( 1,0 ) [ scale=0.6,circle , fill , label = below:@xmath238 ; ( 3 ) at ( 2,0 ) [ scale=0.6,circle , fill , label = below:@xmath239 ; ( 4 ) at ( 3,0 ) [ scale=0.6,circle , fill , label = below:@xmath240 ; ( 5 ) at ( 4,0 ) [ scale=0.6,circle , fill , label = below:@xmath241 ; ( 2 ) edge[- > ] ( 3 ) ( 3 ) edge[- > ] ( 4 ) ( 4 ) edge[- > ] ( 5 ) ;     +    c @xmath243 +    \\(1 ) at ( 0,0 ) [ scale=0.6,circle , fill , label = below:@xmath81 ] ; ( 2 ) at ( 1,0 ) [ scale=0.6,circle , fill , label = below:@xmath238 ; ( 3 ) at ( 2,0 ) [ scale=0.6,circle , fill , label = below:@xmath239 ; ( 4 ) at ( 3,0 ) [ scale=0.6,circle , fill , label = below:@xmath240 ; ( 5 ) at ( 4,0 ) [ scale=0.6,circle , fill , label = below:@xmath241 ; ( 6 ) at ( 0.8,1 ) [ scale=0.6,circle , fill , label = below:@xmath244 ; ( 7 ) at ( 1.6,1 ) [ scale=0.6,circle , fill , label = below:@xmath245 ; ( 8) at ( 2.4,1 ) [ scale=0.6,circle , fill , label = below:@xmath246 ; ( 9 ) at ( 3.2,1 ) [ scale=0.6,circle , fill , label = below:@xmath247 ; ( 1 ) edge[- > ] ( 2 ) ( 2 ) edge[- > ] ( 3 ) ( 3 ) edge[- > ] ( 4 ) ( 4 ) edge[- > ] ( 5 ) ( 1 ) edge[- > ] ( 6 ) ( 6 ) edge[- > ] ( 7 ) ( 7 ) edge[- > ] ( 8) ( 8) edge[- > ] ( 9 ) ( 9 ) edge[- > ] ( 5 ) ;    &    c @xmath248 +    \\(1 ) at ( 0,0 ) [ scale=0.6,circle , fill , label = below:@xmath81 ] ; ( 2 ) at ( 1,-0.5 ) [ scale=0.6,circle , fill , label = below:@xmath238 ; ( 3 ) at ( 2,-0.5 ) [ scale=0.6,circle , fill , label = below:@xmath239 ; ( 4 ) at ( 1,0.5 ) [ scale=0.6,circle , fill , label = below:@xmath240 ; ( 1 ) edge[- > ] ( 2 ) ( 2 ) edge[- > ] ( 3 ) ( 1 ) edge[- > ] ( 4 ) ;     + &    c @xmath249 +    \\(1 ) at ( 0,0 ) [ scale=0.6,circle , fill , label = below:@xmath81 ] ; ( 2 ) at ( 1,-0.5 ) [ scale=0.6,circle , fill , label = below:@xmath238 ; ( 3 ) at ( 2,-0.5 ) [ scale=0.6,circle , fill , label = below:@xmath239 ; ( 1 ) edge[- > ] ( 2 ) ( 2 ) edge[- > ] ( 3 ) ( 1 ) edge[->,out=30,in=135 ] ( 3 ) ;    let us begin by comparing the marked structures @xmath250 and @xmath251 .",
    "they are distinguishable in the full calculus , for example , by the expression @xmath252 which belongs to @xmath253 but not to @xmath254 .",
    "in contrast , we have @xmath255 , i.e. , the two marked structures are indistinguishable in @xmath227 .",
    "the intuition , following proposition  [ leminpaths ] , is that expressions in this fragment that return a pair @xmath146 on a structure are confined to the part of the structure formed by all directed paths from @xmath256 to @xmath257 ; on @xmath236 and @xmath242 , the parts between @xmath258 and @xmath259 are identical .",
    "one way to make such an indistinguishability claim formal will be our main result , which includes a notion of bisimulation appropriate for the fragment @xmath227 .",
    "consider now a positive fragment such as @xmath260 .",
    "we obviously have @xmath261 since the expression @xmath50 above belongs to @xmath260 .",
    "nevertheless , in the other direction we do have @xmath262 , as again will follow from our main result .",
    "on the other hand , in the fragment @xmath263 we have @xmath264 by the expression @xmath265 .",
    "we can illustrate degree - bounded indistinguishability by @xmath266 .",
    "indeed , degree - two expressions in @xmath221 are limited to paths of length at most four , and both structures are identical inasfar as such paths between 1 and 5 are concerned .",
    "of course , the two marked structures are distinguishable in degree three ; by the expression is expressible in degree three as @xmath267 . ]",
    "@xmath268 we already have distinguishability @xmath269 in the most basic fragment @xmath73 .",
    "finally let us compare the marked structures @xmath270 and @xmath271 .",
    "clearly , in @xmath260 , we have @xmath272 as witnessed by the expression @xmath273 . in the other direction , however , we even have @xmath274 . on the other hand , adding diversity , we have @xmath275 by the expression @xmath276 .",
    "in this and the following section , we proceed as announced in the preceding sections and define , for any fragment @xmath77 and any natural number @xmath89 , an appropriate notion of bisimulation or simulation between structures .",
    "we will then show the adequacy of the proposed notions in capturing indistinguishability in @xmath90 .    in the present section , we deal with fragments containing complement or difference .",
    "let @xmath200 and @xmath201 be two structures with node sets @xmath278 and @xmath279 respectively .",
    "let @xmath280 be an arbitrary element of @xmath281 , and let @xmath206 be an arbitrary subset of the same set @xmath281 .    for any given calculus fragment @xmath77 that contains complement or difference , we define the following suite of conditions .",
    "the conditions are relative to @xmath75 in that they refer to @xmath282 and @xmath283 .",
    "all the conditions are also clearly relative to @xmath200 and @xmath201",
    ".    atoms forth : :    we say that @xmath280 has the _ atoms forth    property _ if    @xmath284 atoms back : :    we say that @xmath280 has the _ atoms back    property _",
    "if    @xmath285    furthermore , let @xmath286 be an arbitrary natural number .",
    "composition forth : :    we say that @xmath280 has the _ composition    forth property at degree @xmath287 with respect to    @xmath206 _ if for every @xmath288 in @xmath278    with @xmath289 and @xmath290 in    @xmath291 ,    there exists @xmath292 in @xmath279 such that both    @xmath293 and @xmath294 .",
    "composition back : :    we say that @xmath280 has the _ composition    back property at degree @xmath287 with respect to    @xmath206 _ if for every @xmath292 in @xmath279    with @xmath295 and @xmath296 in    @xmath297 ,    there exists @xmath288 in @xmath278 such that both    @xmath298 and    @xmath299 .",
    "projection forth : :    we say that @xmath280 has the _ projection    forth property at degree @xmath287 with respect to    @xmath206 _ if either @xmath232 , or    @xmath214 and @xmath215 and for every    @xmath288 in @xmath278 with @xmath289 in    @xmath291 ,    there exists @xmath292 in @xmath203 such that    @xmath300 . moreover , if    @xmath214 then also for every @xmath288 in    @xmath278 with @xmath301 in    @xmath291 ,    there must exist @xmath292 in @xmath203 such that    @xmath302 .",
    "projection back : :    we say that @xmath280 has the _ projection back    property at degree @xmath287 with respect to @xmath206 _ if    either @xmath233 , or @xmath215 and    @xmath214 and for every @xmath292 in    @xmath279 with @xmath295 in    @xmath297 ,    there exists @xmath288 in @xmath202 such that    @xmath300 .",
    "moreover , if    @xmath215 , then also for every @xmath292 in    @xmath279 with @xmath303 in    @xmath297 ,    there must exist @xmath288 in @xmath202 such that    @xmath302 .",
    "left residual forth : :    we say that @xmath280 has the _ left residual    forth property at degree @xmath287 with respect to    @xmath206 _ if for every @xmath292 in @xmath279    with @xmath304 in    @xmath297 ,    there exists @xmath288 in @xmath278 such that both    @xmath305 and either    @xmath306 or    @xmath298 .",
    "left residual back : :    we say that @xmath280 has the _ left residual    back property at degree @xmath287 with respect to    @xmath206 _ if for every @xmath288 in @xmath278    with @xmath307 in    @xmath308 ,    there exists @xmath292 in @xmath279 such that both    @xmath305 and either    @xmath309 or    @xmath298 .",
    "right residual forth : :    we say that @xmath280 has the _ right residual    forth property at degree @xmath287 with respect to    @xmath206 _ if for every @xmath292 in @xmath279    with @xmath303 in    @xmath310 ,    there exists @xmath288 in @xmath278 such that both    @xmath311 and either    @xmath312 or    @xmath294 .",
    "right residual back : :    we say that @xmath280 has the _ right residual    back property at degree @xmath287 with respect to    @xmath206 _ if for every @xmath288 in @xmath278    with @xmath301 in    @xmath308 ,    there exists @xmath292 in @xmath279 such that both    @xmath302 and either    @xmath313 or    @xmath294 .",
    "now let @xmath89 be a natural number and let @xmath314 be a decreasing sequence of relations with @xmath315 , decreasing in the sense that @xmath316 for each @xmath317 .",
    "we lift the above conditions to apply to such sequences @xmath318 as follows :    * we say that @xmath318 has the atoms forth property if every element of @xmath319 has this property , and similarly for the atoms back property . * for any of the other properties ( from composition forth to right residual back ) , we say that @xmath318 has a certain property if for every @xmath320 , every element of @xmath321 has that property at degree @xmath287 with respect to @xmath322 .",
    "we are finally ready for our main definition .",
    "the following definition is the most natural and easy to state , but we will see later in corollary  [ unnecessary ] that in some cases , some of the conditions are actually redundant .",
    "[ defbisim ] we call @xmath318 an _ @xmath277-bisimulation from @xmath200 to @xmath201 _ if @xmath318 has    * the atoms forth and back properties ; * the composition forth and back properties ; * the projection forth and back properties when @xmath75 contains projection ; * the left ( right ) residual forth and back properties when @xmath75 contains left ( right ) residual .",
    "given two marked structures @xmath323 and @xmath219 , when there exists an @xmath277-bisimulation @xmath318 from @xmath200 to @xmath201 such that @xmath324 , we say that @xmath157 and @xmath156 are _",
    "@xmath277-bisimilar _ , and denote this by @xmath325 .",
    "note that in any bisimulation @xmath318 , since both the forth and back versions of the atoms property must be satisfied , and since identity is always present in our fragments , for each @xmath326 we have @xmath214 iff @xmath215 . from this",
    "it follows that @xmath232 iff @xmath233 , so it does not matter whether or not @xmath17 belongs to @xmath75 .",
    "hence , there really are only two variants of the atoms properties , depending on whether or not @xmath75 contains converse .",
    "both variants stipulate @xmath214 iff @xmath215 as just seen .",
    "when @xmath75 does not contain converse , the atoms conditions stipulate furthermore that exactly the same relations @xmath235 from @xmath13 must hold for @xmath172 and @xmath181 ; moreover , when @xmath75 does contain converse , also the converse relations that hold must be the same .",
    "one may wonder why there are no conditions corresponding to the coprojection operation .",
    "the reason is that in fragments containing difference , coprojection plays no additional role beyond that of projection , because @xmath327 .",
    "formally , we will see in the invariance lemma that coprojections are also preserved by bisimulations .",
    "we establish :    [ water ] for any fragment @xmath77 where @xmath75 contains complement or difference , we have @xmath328 if and",
    "only if @xmath159 .    we will prove the only - if direction in the invariance lemma , where we will need the following immediate property :    [ leminduction ] let @xmath115 and let @xmath329 be an @xmath277-bisimulation from @xmath200 to @xmath201 .",
    "then @xmath330 is an @xmath331-bisimulation from @xmath200 to @xmath201 .",
    "we now give :    [ invariant ] if @xmath328 then @xmath159 .",
    "let @xmath31 be an expression in @xmath90 ; we may assume by proposition  [ convprop ] that converse is only applied to relation names .",
    "we prove by induction on the structure of @xmath31 that for any marked structures @xmath332 , we have @xmath154 if and only if @xmath155 .",
    "let @xmath202 and @xmath203 be the node sets of the structures @xmath200 and @xmath201 , respectively .",
    "let @xmath318 be an @xmath277-bisimulation from @xmath200 to @xmath201 such that @xmath324 .    for the base case , where @xmath31 is an atomic expression , the result follows immediately from the atoms forth and back properties applied to @xmath324 .",
    "if @xmath31 is @xmath60 , @xmath62 , @xmath63 , or @xmath333 , the result follows immediately from the induction hypothesis .    for the case where @xmath31 is @xmath132 , consider the only - if , i.e. , assume that @xmath154 . by definition of composition ,",
    "there exists @xmath288 in @xmath202 with @xmath334 and @xmath335 . since @xmath50 and @xmath51 have depth at most @xmath336 , by proposition  [ leminpaths ] , both @xmath289 and @xmath290 are in @xmath337 . by the composition forth",
    "condition , there exists @xmath292 in @xmath203 such that both @xmath212 and @xmath213 belong to @xmath338 .",
    "hence , by induction ( and using lemma  [ leminduction ] ) , we have @xmath339 and @xmath340 , whence @xmath341 . the argument for the",
    "if - direction is similar , using composition back instead of composition forth .    for the case where @xmath31 is @xmath66 , consider the only - if",
    ", i.e. , assume @xmath342 .",
    "by definition of projection , we have @xmath343 , and there exists @xmath288 in @xmath202 with @xmath344 . by proposition  [ leminpaths ] , we have @xmath289 in @xmath337 . by the projection forth condition , there exists @xmath292 in @xmath203 such that @xmath345 . hence , by induction , we have @xmath339 , whence @xmath346 . the argument for the",
    "if - direction is similar , using projection back instead of projection forth .",
    "the argument for the case where @xmath31 is @xmath68 is analogous .",
    "the case where @xmath31 is @xmath347 now follows readily from the preceding as @xmath348 .    finally , for the case where @xmath31 is @xmath349 , consider the only - if",
    ", i.e. , assume @xmath154 .",
    "suppose now that @xmath350 .",
    "then , by definition of the left residual , there exists @xmath292 in @xmath203 such that @xmath351 and @xmath352 . by proposition  [ leminpaths ]",
    ", we have that @xmath304 in @xmath353 . by the left residual forth condition",
    ", there exists @xmath288 in @xmath202 such that both @xmath354 and @xmath212 belong to @xmath338 .",
    "hence , by induction , we obtain @xmath355 and @xmath356 .",
    "now , this @xmath288 contradicts that @xmath357 . the argument for the",
    "if - direction is similar , using left residual back .",
    "the case of a right residual is completely analogous to that of a left residual .",
    "the other direction of the adequacy theorem will be established by the characteristic expression lemma .",
    "for the proof of that lemma we need to introduce the construction of the maximal bisimulation .",
    "this construction by successive refinement is a classical technique ( * ? ? ?",
    "* section  3.5 ) and is used as well in algorithms for classical bisimilarity @xcite and for color refinement @xcite .",
    "[ defmax ] given a fragment @xmath75 as above and structures @xmath200 and @xmath201 with node sets @xmath278 and @xmath279 respectively , we construct an infinite decreasing sequence @xmath358 by induction on @xmath89 as follows .    1 .",
    "@xmath319 is the set of all elements of @xmath281 that have the atoms forth and back properties relative to @xmath75 , @xmath200 and @xmath201 .",
    "2 .   @xmath321 , for @xmath286 , is the set of all elements in @xmath322 that have * the composition forth and back properties at degree @xmath287 with respect to @xmath322 ( still relative to @xmath75 , @xmath200 and @xmath201 ) ; * the projection forth and back properties at degree @xmath287 with respect to @xmath322 , if @xmath75 contains projection ; and * the left ( right ) residual forth and back properties at degree @xmath287 with respect to @xmath322 , if @xmath75 contains left ( right ) residual .",
    "we denote this constructed sequence by @xmath359 .",
    "the relevant property about @xmath359 is the following .",
    "it follows immediately from the definitions .",
    "[ propmax ]    let @xmath360 .",
    "then for each natural number @xmath89 , the sequence @xmath361 is an @xmath277-bisimulation from @xmath200 to @xmath201 .",
    "furthermore , it is the maximal bisimulation in the sense that , for any other such @xmath277-bisimulation @xmath362 , we have @xmath363 for each @xmath364 .    as an immediate corollary",
    ", we have :    [ cormax ] @xmath365 .",
    "another relevant property is the following .",
    "[ pathpreserving ] let @xmath360 .",
    "then @xmath321 , for every @xmath287 , is _ path - preserving at degree @xmath287 _ , in the sense that if @xmath366 and @xmath367 , then also @xmath368 .    by induction on @xmath287 .",
    "the base case @xmath369 is clear from the definition of @xmath319 .",
    "for the case @xmath286 we may assume that 1 is absent from @xmath75 , since otherwise the claim is trivial .",
    "we can thus rely on the equivalence @xmath370 .",
    "if @xmath371 , then , since @xmath316 , the claim follows directly by induction . otherwise , there exists @xmath210 such that @xmath289 and @xmath290 are in @xmath308 . by the composition forth",
    "property , there exists @xmath211 such that @xmath212 and @xmath213 belong to @xmath206 . by induction",
    ", we have @xmath295 and @xmath296 in @xmath310 , whence @xmath368 as desired .",
    "note that , since the above proposition shows path - preservation for the maximal bisimulation , path - preservation also holds for any arbitrary bisimulation .",
    "we are now ready for :    [ karakter ] let @xmath89 be a natural number and let @xmath372 be a marked structure .",
    "then there exists an expression @xmath373 in @xmath90 such that for every structure @xmath201 we have @xmath374    the construction of the required expression is by induction on @xmath89 . for the base of the construction we put @xmath375 , where @xmath376 it is clear that @xmath377 iff @xmath378 , which is necessary and sufficient for @xmath379 to hold .    for the inductive step of the construction , let @xmath115 .",
    "our approach , based on corollary  [ cormax ] , is to show that each of the properties @xmath380 involved in definition  [ defmax ] , @xmath380 ranging from composition forth until right residual back , is expressible in @xmath90 , in the following way .",
    "let @xmath278 be the node set of the fixed structure @xmath200 , and let @xmath279 be the node set of any structure @xmath201 to which our expressions will be applied .",
    "we may represent a set @xmath381 by the family of binary relations consisting of , for each @xmath382 , the binary relation @xmath383 note that these relations make only the `` slice '' of @xmath206 visible governed by the constraint @xmath384 .",
    "we can add all these relations to @xmath201 , yielding an expanded structure , denoted by @xmath385 , over the expansion of the given vocabulary @xmath13 with relation names @xmath386 for each @xmath382 .",
    "( here , we are abusing notation a bit by making no formal distinction between the relation name and its contents . ) furthermore , for our purpose , it will be sufficient to assume that @xmath206 is path - preserving at degree @xmath336 in the sense of proposition  [ pathpreserving ] .",
    "now we are going to express each property @xmath380 by an expression @xmath387 over the expanded vocabulary , in the sense for any @xmath201 and any @xmath206 as above , @xmath387 applied to @xmath385 returns the set of pairs @xmath388 for which @xmath205 satisfies the @xmath380 property at degree @xmath89 with respect to @xmath206 , relative to @xmath200 , @xmath201 , and @xmath75 .",
    "there is a caveat : if @xmath200 is infinite , there are infinitely many pairs @xmath382 , so also infinitely many relations @xmath386 .",
    "accordingly , we will allow the expression @xmath387 to be infinitary , in that it can use infinite unions and intersections .",
    "we will see later in the inductive argument that normal , finitary expressions are still obtained in the end .",
    "for example , for the composition forth property , we have the following expression , whose correctness is evident :    @xmath389    here and below , it is understood that an empty intersection vanishes from the expression .",
    "empty unions , as usual , are replaced by the expression 0 .    for the projection",
    "forth property , if @xmath232 , we can simply define @xmath390 otherwise , if @xmath343 , we use @xmath391 again the correctness is evident .    for the projection",
    "back property , if @xmath232 , we can simply define @xmath392 indeed , if @xmath393 then @xmath394 , in which case @xmath205 voidly satisfies the projection back property .",
    "conversely , if @xmath395 and @xmath205 satisfies the projection back property , but @xmath396 , then @xmath397 must hold as well so @xmath393 as desired .",
    "if @xmath343 , we put @xmath398 let us verify the correctness in this case .",
    "let @xmath399 . then clearly @xmath395 .",
    "we must show that @xmath205 satisfies the projection back property at degree @xmath89 with respect to @xmath206 .",
    "if @xmath233 this is trivial so assume @xmath400 .",
    "then @xmath401 , so , considering the expression @xmath402 , this means that ( i ) @xmath403 and ( ii ) @xmath404 .",
    "now let @xmath211 such that @xmath405 .",
    "we must show there exists @xmath210 such that @xmath300 .",
    "for the sake of contradiction , assume the contrary ; then @xmath406 . by ( i ) , this is impossible .",
    "similarly , using ( ii ) , we obtain that for any @xmath211 such that @xmath407 there exists @xmath210 such that @xmath302 .",
    "hence the projection back property holds as desired .",
    "the converse direction , that any @xmath395 must belong to @xmath408 if @xmath205 satisfies the projection back property at degree @xmath89 with respect to @xmath206 , is argued similarly .",
    "for the composition back property , the expression is a little bit less evident : @xmath409    to see the correctness of the above expression , we must show for any @xmath388 that @xmath410 if and only if @xmath205 has the composition back property at degree @xmath89 with respect to @xmath206 . for the only - if direction , assume @xmath410 .",
    "let @xmath211 such that both @xmath295 and @xmath296 are in @xmath411 .",
    "we must show that there exists @xmath210 such that both @xmath212 and @xmath213 belong to @xmath206 .",
    "for the sake of contradiction , suppose such @xmath288 does not exist , i.e. , for each @xmath210 either @xmath412 or @xmath413 ( or both ) .",
    "then , letting @xmath414 , we have for any @xmath415 that @xmath416 .",
    "hence , through @xmath292 , we see that @xmath417 which contradicts @xmath418 .    for the if - direction , assume that @xmath205 has the composition back property at degree @xmath89 with respect to @xmath206 , and we must show that @xmath181 belongs to @xmath419 . for the sake of contradiction , assume there exists @xmath420 and @xmath421 such that @xmath422 for all @xmath423 , and @xmath424 for all @xmath415 .",
    "this simply means that there exists @xmath211 such that @xmath295 and @xmath296 both belong to @xmath411 , but for which there exists no @xmath210 such that both @xmath212 and @xmath213 belong to @xmath206 .",
    "thus we obtain a direct contradiction with the composition back property .",
    "the expressions for the left and right residual back properties are more straightforward again :    @xmath425    @xmath426    let us show the correctness of the left residual back expression ; the argument for the right residual is completely analogous .",
    "let @xmath395 .",
    "we see that @xmath427 if and only if there does _ not _ exist @xmath428 such that @xmath429 , and such that for each @xmath211 with @xmath430 we have @xmath431 .",
    "equivalently , @xmath432 iff for all @xmath210 with @xmath429 , there exists @xmath211 such that @xmath433 and @xmath434 and @xmath435 . by the path - preserving property of @xmath206 ,",
    "the qualification @xmath433 is redundant .",
    "moreover , @xmath436 means that either @xmath437 or @xmath438 .",
    "thus we get exactly the formulation of the left residual back property .",
    "finally , the left and right residual forth properties are expressed using a similar approach as for the composition back property :    @xmath439\\end{gathered}\\ ] ]    @xmath440\\end{gathered}\\ ] ]    let us show the correctness of the left residual forth expression ; again the argument for the right residual is completely analogous .",
    "we must show for any @xmath388 that @xmath441 if and only if @xmath205 has the left residual forth property at degree @xmath89 with respect to @xmath206 .",
    "for the only - if direction , assume @xmath441 .",
    "let @xmath211 such that @xmath442 .",
    "we must show that there exists @xmath210 such that @xmath443 and either @xmath444 or @xmath300 .",
    "if there exists @xmath210 with @xmath445 such that @xmath446 , there is nothing to prove .",
    "so , suppose no such @xmath288 exists , and consider @xmath447 .",
    "then @xmath448 hence , since @xmath449 , we have @xmath450 , i.e. , there exists @xmath451 such that @xmath300 and @xmath434 , as desired .    for the if - direction , assume that @xmath205 has the left residual forth property at degree @xmath89 with respect to @xmath206 , and let @xmath420 be arbitrary .",
    "let @xmath211 such that @xmath448 by the residual forth property , there exists @xmath452 such that @xmath443 ( in particular , @xmath415 ) and either @xmath444 or @xmath300 .",
    "the possibility @xmath453 can not occur , however , because @xmath454 hence , @xmath455 and @xmath300 , whence @xmath456 , since @xmath206 was assumed to be path - preserving .",
    "we conclude that @xmath457 as desired .",
    "we are now ready to conclude the construction of the required expression @xmath373 .",
    "this expression , applied to any @xmath201 , should return the set of all pairs @xmath181 such that @xmath458 . by definition ,",
    "these are the pairs @xmath181 for which @xmath459 , and such that @xmath205 has all the properties @xmath380 , required by definition  [ defmax ] , at degree @xmath89 with respect to @xmath460 .",
    "we have just seen that each such property @xmath380 is expressible by the infinitary expression @xmath387 .",
    "hence , we can obtain @xmath373 simply as the intersection of @xmath461 ( obtained by induction ) and the expressions @xmath387 for the different properties @xmath380 required by @xmath277-bisimulation .",
    "the only problem remaining is that each expression @xmath387 is still infinitary , and referring to extra relation names of the form @xmath386 . for our purpose ,",
    "such a relation name should hold the relation @xmath462 . by the induction hypothesis",
    "however , we can express this relation by the expression @xmath463 .",
    "so , in @xmath387 , we can replace each occurrence of @xmath386 by @xmath463 and obtain an expression of degree @xmath89 over the original given vocabulary @xmath13 .",
    "the resulting expression still has infinite unions and intersections .",
    "these unions and intersections are over sets of expressions of degree @xmath89 , however .",
    "hence , since , up to equivalence , there are only finitely many expressions of degree @xmath89 over the fixed finite vocabulary @xmath13 , we can equivalently replace the infinite unions and intersections by finite ones .",
    "the reason why there are only a finite number of inequivalent expression of degree @xmath89 is the same as why there are only a finite number of inequivalent first - order logic formulas of quantifier rank @xmath89 @xcite .",
    "we can conclude the proof of the adequacy theorem as follows :    the only - if direction is proven by lemma  [ invariant ] .",
    "the if - direction for @xmath114 is clear .",
    "so now assume @xmath464 with @xmath115 .",
    "we distinguish two possibilities .",
    "if @xmath182 , then @xmath75 can not contain the residuals , for otherwise @xmath465 .",
    "( the only exception is when @xmath279 is empty , but then @xmath278 must be empty as well and the theorem becomes trivial . ) moreover , since @xmath183 is expressible by an expression of degree @xmath89 and @xmath464 , also @xmath466 .",
    "but in that case we can see that the atoms forth and back , the composition forth and back , as well as the projection forth and back properties are void , so @xmath467 holds trivially .",
    "hence , the nondegenerate case is where @xmath388 and @xmath468 , which allows us to invoke the charasteristic expression lemma .",
    "we argue as follows .",
    "first , we note that @xmath469 trivially holds ; indeed , we can take the bisimulation @xmath318 where @xmath470 for each @xmath287 .",
    "hence , by the characteristic expression lemma , we have @xmath471 .",
    "since @xmath464 , this implies @xmath472 .",
    "again by the characteristic expression lemma this implies @xmath473 and we are done .    to conclude this section we note as an immediate corollary that the projection properties , or the left ( right ) residual properties , can be omitted from the definition of bisimulation in those cases where the corresponding operation is not primitive :    [ unnecessary ]    *",
    "let @xmath77 be a calculus fragment where @xmath75 contains projection , and either converse is present as well or 1 is present at degree 0 .",
    "let @xmath126 be @xmath75 without projection .",
    "then @xmath277-bisimilarity is the same as @xmath474-bisimilarity . * similarly , when @xmath75 contains the left ( right ) residual and also converse , and 1 is present at degree 0 as well , then @xmath277-bisimilarity is the same as @xmath474-bisimilarity where @xmath126 is @xmath75 without left ( right ) residual .",
    "in the present section , we deal with fragments not containing difference , for which we will capture one - sided indistinguishability by appropriate notions of simulation between structures .",
    "the treatment will largely parallel that for fragments with difference from the previous section .",
    "nevertheless , simulations differ from bisimulations in that they consist of two separate sequences @xmath318 and @xmath475 of relations , one for each direction . the two separate directions are needed to be able to deal with the nonmonotonic operations of coprojection and left and right residual , in the absence of complement and difference .    when the fragment contains neither difference , nor coprojection , nor residuals , it will be evident that the definition of simulation boils down to a simpler situation where only the sequence @xmath318 is needed .",
    "let @xmath200 and @xmath201 be two structures with node sets @xmath278 and @xmath279 respectively .",
    "let @xmath280 be an arbitrary element of @xmath281 , and let @xmath206 and @xmath476 be arbitrary subset of @xmath477 .    in parallel to section  [ subconditions ]",
    ", we define a suite of conditions , but now appropriate for calculus fragments @xmath77 containing neither complement nor difference .",
    "the atoms forth and back are unmodified .",
    "also the composition forth and back , and projection forth and back are unmodified with respect to their definitions in section  [ subconditions ] , with the exception that they are now defined with respect to two sets @xmath206 and @xmath476 .",
    "the left and right residual forth and back properties , however , are modified in that they `` cross over '' between @xmath206 and @xmath476 . in the same spirit",
    "we also define coprojection forth and back properties .",
    "composition and projection forth : :    we say that @xmath280 has the _ composition    forth , or projection forth , property at degree @xmath287 with    respect to @xmath478 _ if @xmath280 has    that property at degree @xmath287 with respect to the set    @xmath206 , as defined in section  [ subconditions ] .",
    "composition and projection back : :    we say that @xmath280 has the _",
    "composition    back , or projection back , property at degree @xmath287 with    respect to @xmath478 _ if @xmath280 has    that property at degree @xmath287 with respect to the set    @xmath476 , as defined in section  [ subconditions ] .",
    "left residual forth : :    we say that @xmath280 has the _ left residual    forth property at degree @xmath287 with respect to    @xmath478 _ if for every @xmath292 in @xmath279    with @xmath304 in    @xmath310 ,    there exists @xmath288 in @xmath278 such that    @xmath479 and either    @xmath480    or @xmath300 .",
    "left residual back : :    we say that @xmath280 has the _ left residual    back property at degree @xmath287 with respect to    @xmath478 _ if for every @xmath288 in @xmath278    with @xmath307 in    @xmath308 ,    there exists @xmath292 in @xmath279 such that both    @xmath434 and either    @xmath481    or @xmath482 .",
    "right residual forth : :    we say that @xmath280 has the _ right residual    forth property at degree @xmath287 with respect to    @xmath478 _ if for every @xmath292 in @xmath279    with @xmath303 in    @xmath310 ,    there exists @xmath288 in @xmath278 such that both    @xmath483 and either    @xmath484    or @xmath485 .",
    "right residual back : :    we say that @xmath280 has the _ right residual    back property at degree @xmath287 with respect to    @xmath478 _ if for every @xmath288 in @xmath278    with @xmath301 in    @xmath308 ,    there exists @xmath292 in @xmath279 such that both    @xmath302 and either    @xmath486    or @xmath487 .",
    "coprojection forth : :    we say that @xmath280 has the _ projection    forth property at degree @xmath287 with respect to    @xmath478 _ if either @xmath232 , or    @xmath214 and @xmath215 and for every    @xmath292 in @xmath279 with @xmath295 in    @xmath297 ,    there exists @xmath288 in @xmath202 such that    @xmath482 .",
    "moreover , if    @xmath214 , then also for every @xmath292 in    @xmath279 with @xmath303 in    @xmath297 ,    there must exist @xmath288 in @xmath202 such that    @xmath488 .",
    "coprojection back : :    we say that @xmath280 has the _ coprojection    back property at degree @xmath287 with respect to    @xmath478 _ if either @xmath233 , or    @xmath215 and @xmath214 and for every    @xmath288 in @xmath278 with @xmath289 in    @xmath291 ,    there exists @xmath292 in @xmath203 such that    @xmath300 .",
    "moreover , if    @xmath215 then also for every @xmath288 in    @xmath278 with @xmath301 in    @xmath291 ,    there must exist @xmath292 in @xmath203 such that    @xmath302 .",
    "now let @xmath89 be a natural number and let @xmath489 and @xmath490 be decreasing sequences of relations with @xmath319 and @xmath491 subsets of @xmath281 .",
    "we now lift the above conditions to apply to such pairs @xmath492 of sequences .",
    "plainly , the forth properties apply to @xmath318 and the back properties to @xmath475 .",
    "* we say that @xmath493 has the atoms forth property if every element of @xmath319 has this property .",
    "* we say that @xmath493 has the atoms back property if every element of @xmath491 has this property . *",
    "we say that @xmath493 has the composition forth , or the projection forth , or the coprojection forth , or the left or right residual forth property , if for every @xmath320 , every element of @xmath321 has that property at degree @xmath287 with respect to @xmath494 . *",
    "we say that @xmath493 has the composition back , or the projection back , or the coprojection back , or the left or right residual back property , if for every @xmath320 , every element of @xmath495 has that property at degree @xmath287 with respect to @xmath494 .",
    "we then naturally have the following :    [ sim ] we call @xmath493 an _ @xmath277-simulation from @xmath200 to @xmath201 _ if @xmath493 has    * the atoms forth and back properties ; * the composition forth and back properties ; * the projection forth and back properties when @xmath75 contains projection ; * the coprojection forth and back properties when @xmath75 contains coprojection ; * the left ( right ) residual forth and back properties when @xmath75 contains left ( right ) residual .",
    "given two marked structures @xmath323 and @xmath219 , when there exists an @xmath277-simulation @xmath493 from @xmath200 to @xmath201 such that @xmath324 , we say that @xmath157 is _ @xmath277-similar _ to @xmath156 , and denote this by @xmath496 .",
    "it is instructive to remark that , in the case where @xmath75 does not have coprojection or residual , only @xmath318 matters ; the component @xmath475 is then entirely redundant , in the sense that the sequence @xmath497 ( @xmath498 times ) would do fine , as it trivially satisfies the composition and projection back properties .",
    "only when coprojection or residual are present , there is a significant interplay between @xmath318 and @xmath475 .",
    "after definition  [ defbisim ] of bisimilarity , we observed that there it does not matter whether or not @xmath17 belongs to the fragment .",
    "in contrast , here this matters , since the atoms forth property applies only to @xmath318 and the atoms back property applies only to @xmath475 .",
    "the following important property follows immediately from the symmetries in the definition of simulation . for any @xmath499",
    ", we define @xmath500 .",
    "we then have :    [ symmetric ] if @xmath501 is an @xmath277-simulation from @xmath200 to @xmath201 , then @xmath502 is an @xmath277-simulation from @xmath201 to @xmath200 .",
    "we also note the following analogue of lemma  [ leminduction ] :    [ lemsiminduction ] let @xmath115 and let @xmath503 be an @xmath277-simulation from @xmath200 to @xmath201 .",
    "then @xmath504 is an @xmath331-simulation from @xmath200 to @xmath201 .",
    "we establish :    [ simwater ] for any fragment @xmath77 where @xmath75 contains neither complement nor difference , we have @xmath496 if and only if @xmath152 .",
    "we have the following analogue of lemma  [ invariant ] :    [ siminvariant ] if @xmath496 then @xmath152 .",
    "let @xmath31 be an expression in @xmath90 .",
    "we prove by induction on the structure of @xmath31 that for marked structures @xmath505 and any @xmath154 , we also have @xmath155 .",
    "let @xmath202 and @xmath203 be the node sets of the structures @xmath200 and @xmath201 , respectively .",
    "let @xmath493 be an @xmath277-simulation from @xmath200 to @xmath201 such that @xmath324 .    for the cases where @xmath31 is an atomic expression , a union , an intersection , a composition , or a projection , the reasoning is identical to the corresponding only - if cases in the proof of lemma  [ invariant ] .",
    "consider the case where @xmath31 is @xmath69 . by definition of coprojection",
    ", we have @xmath214 , whence @xmath215 by the atoms forth condition .",
    "we have to show that there does not exist @xmath506 with @xmath339 . for the sake of contradiction , suppose there exists such @xmath292 . by lemma  [ leminpaths ] , we have @xmath507",
    ". then by the coprojection forth property , there exists @xmath210 such that @xmath508 .",
    "hence , by proposition  [ symmetric ] , lemma  [ lemsiminduction ] , and the induction hypothesis , we obtain @xmath344 which is in contradiction with @xmath509",
    ".    finally , consider the case where @xmath31 is @xmath349 .",
    "so we have to show that @xmath510 .",
    "thereto , let @xmath211 such that @xmath511 . by proposition  [ leminpaths",
    "] , we have that @xmath304 in @xmath353",
    ". then by the left residual forth condition , there exists @xmath288 in @xmath202 such that @xmath512 and either @xmath513 or @xmath345 . by induction",
    ", we have @xmath355 .",
    "hence , since @xmath514 , we have @xmath334 so @xmath515 .",
    "thus , the above qualification @xmath513 is redundant , and @xmath345 . again applying the induction hypothesis",
    "we obtain @xmath339 as desired .",
    "the case of a right residual is completely analogous to that of a left residual .    in order to prove the simulation - analogue of the characteristic expression lemma",
    ", we now present the maximal simulation in analogy to definition  [ defmax ] , and state its properties .",
    "[ defmaxsim ] given a fragment @xmath75 as above and structures @xmath200 and @xmath201 with node sets @xmath278 and @xmath279 respectively , we construct two infinite decreasing sequences @xmath358 and @xmath516 by induction on @xmath89 as follows .    1 .",
    "@xmath319 is the set of all elements of @xmath281 that have the atoms forth property relative to @xmath75 , @xmath200 and @xmath201 .",
    "@xmath491 is the set of all elements of @xmath281 that have the atoms back property ( still relative to @xmath75 , @xmath200 and @xmath201 ) .",
    "@xmath321 , for @xmath286 , is the set of all elements in @xmath322 that have * the composition forth property at degree @xmath287 with respect to @xmath322 ; * the projection forth property at degree @xmath287 with respect to @xmath322 , if @xmath75 contains projection ; * the coprojection forth property at degree @xmath287 with respect to @xmath517 , if @xmath75 contains coprojection ; * the left ( right ) residual forth property at degree @xmath287 with respect to @xmath517 , if @xmath75 contains left ( right ) residual .",
    "4 .   similarly , @xmath495 , for @xmath286 , is the set of all elements in @xmath518 that have * the composition back property at degree @xmath287 with respect to @xmath518 ; * the projection back property at degree @xmath287 with respect to @xmath518 , if @xmath75 contains projection ; * the coprojection back property at degree @xmath287 with respect to @xmath517 , if @xmath75 contains coprojection ; * the left ( right ) residual back property at degree @xmath287 with respect to @xmath517 , if @xmath75 contains left ( right ) residual .",
    "we denote the constructed sequence @xmath519 by @xmath520 , and @xmath521 by @xmath522 .",
    "[ propmaxsim ]    let @xmath523 and @xmath524 .",
    "then for each natural number @xmath89 , the pair of sequences @xmath525 is an @xmath277-simulation from @xmath200 to @xmath201 .",
    "furthermore , it is the maximal simulation in the sense that , for any other such @xmath277-bisimulation @xmath526 , we have @xmath527 and @xmath528 for each @xmath364 .    [ cormaxsim ] @xmath529 .    [ simpathpreserving ]",
    "let @xmath523 and @xmath530 , and let @xmath287 be a natural number . if @xmath366 and @xmath367 , then also @xmath368 .",
    "similarly , if @xmath531 and @xmath368 , then also @xmath367 .",
    "we are now ready for :    [ karaktersim ] let @xmath89 be a natural number and let @xmath372 be a marked structure .",
    "then there exists an expression @xmath373 in @xmath90 such that for every structure @xmath201 we have @xmath532    analogous to the proof of lemma  [ karakter ] , our approach is now based on corollary  [ cormaxsim ] and will show that each of the properties @xmath380 involved in definition  [ defmaxsim ] is expressible in @xmath90 .",
    "since these properties are now with respect to two sets @xmath206 and @xmath476 , and since the expressions can not use complement or difference , we must adapt the approach from the proof of lemma  [ karakter ] as follows .",
    "let @xmath278 be the node set of the fixed structure @xmath200 , and let @xmath279 be the node set of any structure @xmath201 to which our expressions will be applied .",
    "as in the proof of lemma  [ karakter ] , we represent the first set @xmath381 by the family of binary relations consisting of , for each @xmath382 , the binary relation @xmath383 the second set @xmath533 , however , is represented in a complementary manner . specifically , we represent @xmath476 by the family of binary relations consisting of , for each @xmath534 , the binary relation @xmath535 the underscore is used to remind us that the relations @xmath536 give us the complement of @xmath476 .    as before we can add all these relations to @xmath201 , yielding an expanded structure , denoted by @xmath537 , over the expansion of the given vocabulary @xmath13 with relation names @xmath386 and @xmath538 for each @xmath382 .",
    "furthermore , for our purpose , it will be sufficient to assume that @xmath206 and @xmath476 are path - preserving in the sense of proposition  [ simpathpreserving ] .",
    "now we are going to express each property @xmath380 by an expression @xmath539 over the expanded vocabulary , in the following sense .",
    "* if @xmath380 is a forth property , then for any @xmath201 and any @xmath206 and @xmath476 as above , @xmath539 applied to @xmath537 returns the set of pairs @xmath388 for which @xmath205 satisfies the @xmath380 property at degree @xmath89 with respect to @xmath206 , relative to @xmath200 , @xmath201 , and @xmath75 .",
    "* complementarily , if @xmath380 is a back property , then @xmath539 applied to @xmath537 returns the set of pairs @xmath388 for which @xmath205 does _ not _ satisfy the @xmath380 property .",
    "it turns out that the required expressions @xmath539 can be deduced easily from the expressions @xmath387 given in the proof of lemma  [ karakter ] . indeed , in all these expressions",
    ", it turns out that whenever in some property a @xmath206 must be changed to a @xmath476 due to the new modified properties that cross over between @xmath206 and @xmath476 , we already used subexpressions of the form @xmath540 in the right places",
    ". hence , it suffices to replace these subexpressions by @xmath538 to obtain @xmath539 from @xmath387 .",
    "moreover , the expressions for the back properties already were expressed as complements relative to @xmath541 ; there we can simply keep the parts on the right - hande side of the set difference operator .",
    "the correctness proofs are then completely analogous .",
    "specifically , the required expressions are as follows .    @xmath542    @xmath543    @xmath544    @xmath545    @xmath546    @xmath547    @xmath548\\end{gathered}\\ ] ]    @xmath549\\end{gathered}\\ ] ]    @xmath550    @xmath551    we are now ready to present the construction of the required expression @xmath373 , by induction on @xmath89 . actually , we will simultaneously construct an expression @xmath552 with the property that for every @xmath201 we have @xmath553 thus complementing expression @xmath373 which must satisfy @xmath554    for the base of the construction , we put @xmath555    for @xmath115 , expression @xmath373 , applied to any @xmath201 , should return the set of all pairs @xmath395 such that @xmath556 . by definition ,",
    "these are the pairs @xmath181 for which @xmath557 , and such that @xmath205 has all the forth properties required by definition  [ defmaxsim ] , at degree @xmath89 with respect to @xmath558 .",
    "we have just seen that each forth property @xmath380 is expressible by @xmath539 .",
    "hence , we can obtain @xmath373 simply as the intersection of @xmath461 ( obtained by induction ) and the expressions @xmath539 for the different forth properties @xmath380 required by definition  [ defmaxsim ] .",
    "complementarily , expression @xmath552 should return the set of all pairs @xmath395 such that @xmath559 .",
    "this means that @xmath560 must _ not _ satisfy at least one of the back properties required by definition  [ defmaxsim ] , at degree @xmath89 with respect to @xmath558 .",
    "we have just seen that the complement of each back property @xmath380 is expressible by @xmath539 .",
    "hence , we can obtain @xmath373 simply as the intersection of @xmath541 with the union of the expressions @xmath539 for the different back properties @xmath380 required by definition  [ defmaxsim ] .    in analogy to the proof of lemma  [ karakter ] , in the resulting expressions",
    ", we replace each relation name @xmath386 by @xmath463 ; furthermore , we replace each relation name @xmath538 by @xmath561 .",
    "the reduction to a finitary expression , based on quantifier rank , is exactly as in the proof of lemma  [ karakter ] , and we are done .",
    "the bisimilarity characterizations we have given of when two structures are indistinguishable by expressions of @xmath90 , for some fixed degree @xmath89 and some fixed fragment @xmath75 , are valid for arbitrary structures . for finite structures , by classical arguments",
    "@xcite , our methods lead immediately to hennessy  milner - style theorems about indistinguishability in the full fragment @xmath77 , without a degree restriction , as we will show in the present section .",
    "it also follows that indistinguishability in @xmath77 is decidable in polynomial time .",
    "let @xmath77 be a fragment containing complement or difference .",
    "we want to define a natural notion of @xmath75-bisimulation without a degree restriction @xmath89 .",
    "thereto we must make two small adaptations .    1",
    ".   recalling definition  [ defgraph ] , let us define @xmath562 as the set of all pairs @xmath95 in @xmath96 such that * there is a directed path from @xmath105 to @xmath106 in @xmath92 , if @xmath75 does not contain converse ; or * there is an undirected path from @xmath105 to @xmath106 in @xmath111 , if @xmath75 contains converse .",
    "2 .   recall the suite of forth and back properties introduced in section  [ subconditions ] .",
    "we naturally introduce variants of these properties that are no longer degree - restricted .",
    "it suffices to replace each reference to @xmath563 or @xmath564 by @xmath565 , so that the degree parameter @xmath287 becomes irrelevant .",
    "we now define an _",
    "@xmath75-bisimulation from @xmath200 to @xmath201 _ as a relation @xmath381 such that each of its elements has the atoms forth and back properties , as well as the ( degree - unrestricted versions of the ) composition forth and back properties with respect to @xmath206 , and also the projection ( left residual , right residual ) forth and back properties with respect to @xmath206 depending on whether @xmath75 contains projection ( left residual , right residual ) , as usual .",
    "when there exists an @xmath75-bisimulation from @xmath200 to @xmath201 containing @xmath205 , we say that @xmath323 and @xmath219 are _",
    "@xmath75-bisimilar _ and denote this by @xmath566 .",
    "we show :    [ hennessymilner ] for finite marked structures @xmath157 and @xmath156 , we have @xmath567 if and only if @xmath568 .",
    "( the only - if implication actually holds for all structures , finite or infinite . )",
    "let @xmath323 and @xmath219 , and assume @xmath567 by the bisimulation @xmath206 .",
    "in order to show @xmath568 , we must show that @xmath159 holds for all degrees @xmath89 .",
    "so , let @xmath89 be arbitrary .",
    "consider the sequence @xmath569 that simply consists of @xmath498 times @xmath206 .",
    "it is now readily verified that @xmath318 is an @xmath277-bisimulation from @xmath200 to @xmath201 . since @xmath209 , we conclude @xmath159 by lemma  [ invariant ] .",
    "conversely , assume @xmath159 for every degree @xmath89 .",
    "this means that @xmath570 for every @xmath89 .",
    "let @xmath571 . recall that this is a decreasing sequence .",
    "hence , since @xmath200 and @xmath201 are finite , there exists a degree @xmath572 such that @xmath573 for all @xmath574 . as a consequence",
    ", @xmath575 is an @xmath75-bisimulation from @xmath200 to @xmath201 and we are done .      for any fragment @xmath77 containing neither complement nor difference , in an entirely analogous manner",
    "we can define degree - unrestricted versions of the properties for simulations listed in section  [ subsim ] .",
    "then an @xmath75-simulation from @xmath200 to @xmath201 is a pair @xmath576 of subsets of @xmath281 such that each element of @xmath206 has all forth properties with respect to @xmath576 corresponding to the operators present in @xmath75 , and each element of @xmath476 has all back properties with respect to @xmath576 .",
    "we can then again show that @xmath577 if and only if there exists an @xmath75-simulation @xmath576 from @xmath200 to @xmath201 such that @xmath209 .      as a corollary of the above ,",
    "we obtain :    for any fixed fragment @xmath77 , it can be decided in polynomial time whether or not two given finite marked structures are indistinguishable in @xmath77 .",
    "we give the proof for fragments with complement or difference ; the case for the other fragments is entirely analogous .",
    "let @xmath323 and @xmath219 be finite marked structures .",
    "let @xmath578 ( @xmath579 ) be the number of nodes of @xmath200 ( @xmath201 ) .",
    "let @xmath571 .",
    "recall from the proof of theorem  [ hennessymilner ] that there exists @xmath572 such that @xmath573 for all @xmath580 , and @xmath568 if and only if @xmath581 .",
    "let @xmath572 be the smallest such @xmath572 . then in the worst case",
    ", for each @xmath582 , there is exactly one element less in @xmath583 compared to @xmath321 .",
    "hence , @xmath584 which is polynomial in @xmath578 and @xmath579 .",
    "moreover , it is evident from definition  [ defmax ] that @xmath583 can be computed from @xmath321 in time polynomial in @xmath578 , @xmath579 , and the size of @xmath321 which is itself bounded by @xmath585 .",
    "hence , we can compute @xmath575 by performing a polynomial number of iterations where each iteration takes polynomial time , and we are done .",
    "we have always included the identity relation and the three operations union , intersection and composition in the logics that we consider . as already mentioned in the introduction",
    ", it is an interesting topic for further research to see what happens if some of these operators are left out .",
    "the results of the present paper provide the tools to continue the research on the relative expressive power of fragments of the calculus of relations . in earlier work @xcite",
    "the precise relationships between all fragments were clarified , ignoring residuals however . since in the present paper",
    "we have fully integrated the residuals , an interesting direction for further research is now to throw the residuals in the picture .",
    "for example , it is an intriguing question how the fragments @xmath227 and @xmath586 relate to each other in their power to express boolean queries ( where ` true ' is represented by any nonempty answer and ` false ' is represented by the empty answer ) .",
    "both fragments extend the basic fragment @xmath73 with significant nonmonotonic operators , viz .",
    ", difference on the one hand and the residuals on the other hand .",
    "we actually conjecture that the two expressive powers are incomparable .",
    "for example , following the standard approach @xcite , one may try to prove that @xmath586 is not subsumed by @xmath227 for boolean queries by exhibiting an expression @xmath31 in @xmath586 and , for each degree @xmath89 , two structures @xmath587 and @xmath588 such that for each @xmath89 the following holds :    * @xmath589 ; * for any pair @xmath146 of nodes of @xmath587 there exists a pair @xmath590 of nodes of @xmath588 such that @xmath591 .",
    "this indeed implies that no expression @xmath56 in @xmath586 can correctly express the boolean query expressed by @xmath31 . for , because @xmath592 , any such expression should return at least one pair @xmath146 on @xmath587 , but then by the similarity relationship",
    ", it will also return a pair @xmath590 on @xmath588 , in contradiction with @xmath593 .    for fragments with set difference or complementation",
    ", we have worked with bisimulations ; for fragments without set difference , we have worked with simulations . in modal logic",
    "there are results ( * ? ? ?",
    "* theorem 2.78 ) that turn this around , showing that formulas invariant under simulations are in fact equivalent to positive - existential formulas .",
    "it is an interesting direction to see how such a result could be formulated in the setting considered in the present paper .",
    "we thank the two anonymous referees for their critical comments on an earlier draft of this paper .",
    "l.  aceto , a.  ingolfsdottir , and j.  srba .",
    "the algorithmics of bisimilarity . in d.",
    "sangiorgi and j.  rutten , editors , _ advanced topics in bisimulation and coinduction _ , chapter  3 .",
    "cambridge university press , 2011 .",
    "fletcher , m.  gyssens , d.  leinders , j.  van  den bussche , d.  van  gucht , s.  vansummeren , and y.  wu . relative expressive power of navigational querying on graphs . in _",
    "proceedings 14th international conference on database theory _ , 2011 .",
    "fletcher , m.  gyssens , d.  leinders , j.  van  den bussche , d.  van  gucht , s.  vansummeren , and y.  wu . the impact of transitive closure on the expressiveness of navigational query languages on unlabeled graphs . , 2013 . published online , 2 april .",
    "m.  gyssens , j.  paredaens , d.  van  gucht , et  al .",
    "structural characterizations of the semantics of xpath as navigation tool on a document . in _",
    "proceedings 25th acm symposium on principles of database systems _ , pages 318327 .",
    "acm press , 2006 .",
    "m.  gyssens , l.v .",
    "saxton , and d.  van  gucht .",
    "tagging as an alternative to object creation . in j.c .",
    "freytag , d.  maier , and g.  vossen , editors , _ query processing for advanced database systems _ , chapter  8 .",
    "morgan kaufmann , 1994 .",
    "f.  picalausa , y.  luo , g.h.l .",
    "fletcher , j.  hidders , and s.  vansummeren . a structural approach to indexing triples . in e.",
    "simperl et  al . ,",
    "editors , _",
    "proceedings 9th extended semantic web conference _ , volume 7295 of _ lecture notes in computer science _ , pages 406521 .",
    "springer , 2012 .",
    "sarathy , l.v .",
    "saxton , and d.  van  gucht . algebraic foundation and optimization for object based query languages . in _",
    "proceedings 9th international conference on data engineering _ , pages 8190 .",
    "ieee computer society , 1993 ."
  ],
  "abstract_text": [
    "<S> motivated by applications in databases , this paper considers various fragments of the calculus of binary relations . </S>",
    "<S> the fragments are obtained by leaving out , or keeping in , some of the standard operators , along with some derived operators such as set difference , projection , coprojection , and residuation . for each </S>",
    "<S> considered fragment , a characterization is obtained for when two given binary relational structures are indistinguishable by expressions in that fragment . </S>",
    "<S> the characterizations are based on appropriately adapted notions of simulation and bisimulation .    </S>",
    "<S> * keywords : * calculus of relations , indistinguishability , bisimulation , simulation , coprojection , residuation </S>"
  ]
}