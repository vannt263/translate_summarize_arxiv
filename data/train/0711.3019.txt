{
  "article_text": [
    "quantum cryptography has brought us new ways of exchanging a secret key between two users ( known as alice and bob ) .",
    "the security of such quantum key distribution ( qkd ) methods is based on a very basic rule of nature and quantum mechanics  the `` no - cloning '' principle .",
    "the first qkd protocol was suggested in a seminal paper by bennett and brassard  @xcite in 1984 , and is now known as bb84 . during recent years",
    "many security analyses were published @xcite which proved the information - theoretical security of the bb84 scheme against the most general attack by an unlimited adversary ( known as eve ) , who has full control over the quantum channel .",
    "those security proofs are limited as they always consider a theoretical qkd that uses perfect qubits .",
    "although these security proofs do take errors into account , and the protocols use error correction and privacy amplification ( to compensate for these errors and for reducing any partial knowledge that eve might have ) , in general , they avoid security issues that arise from the implementation of qubits in the _",
    "real world_.    a pivotal paper by brassard , ltkenhaus , mor , and sanders  @xcite presented the `` photon number splitting ( pns ) attack '' and exposed a security flaw in experimental and practical qkd : one must take into account the fact that alice does not generate perfect qubits ( 2 basis - states of a single photon ) , but , instead , generates states that reside in an enlarged hilbert space ( we call it `` quantum space '' here ) , of six dimensions .",
    "the reason for that discrepancy in the size of the used quantum space is that each electromagnetic pulse that alice generates contains ( in addition to the two dimensions spanned by the single - photon states ) also a vacuum state and three 2-photon states , and these are extremely useful to the eavesdropper .",
    "that paper proved that , in contrast to what was assumed in previous papers , eve can make use of the enlarged space , and get a lot of information on the secret key , sometimes even full information , without inducing any noise .",
    "many attacks on the practical protocols then followed ( e.g. ,  @xcite ) , based on extensions of the quantum spaces , exploring various additional security flaws ; other papers  @xcite suggested possible ways to overcome such attacks . on the one hand , several security proofs , considering specific imperfections , were given for the bb84 protocol @xcite . yet on the other hand , it is generally impossible now to prove the security of a practical protocol , since _ a general framework _ that considers such realistic qkd protocols , _ and _ the possible attacks on such protocols , is still missing .",
    "we show that the pns attack , and actually all attacks directed at the channel , are various special cases of a general attack that we define here , the _ quantum - space attack _ ( qsa ) .",
    "the qsa generalizes existing attacks and also offers novel attacks .",
    "the qsa is based on the fact that the `` qubits '' manipulated in the qkd protocol actually reside in a larger hilbert space , and this enlarged space _ can be assessed_. although this enlarged space is not fully accessible to the legitimate users , they can still analyze it , and learn what a fully powerful eavesdropper can do .",
    "we believe that this assessment of the enlarged `` quantum space of the protocol '' is a vital step on the way to proving or disproving the unconditional security of practical qkd schemes .",
    "we focus on schemes in which the quantum communication is uni - directional , namely , from alice s laboratory ( lab ) to bob s lab .",
    "we consider an adversary that can attack all the quantum states that come out of alice s lab , and all the quantum states that go into bob s lab .",
    "the paper is organized as follows : definitions of the quantum spaces involved in the realization of a protocol , and of the `` quantum space of the protocol '' , are presented and discussed in section  [ sec : qsop ] .",
    "the `` quantum - space attack '' is defined and discussed in section  [ sec : qsa ] . using the general framework when the information carriers are photons is discussed in section  [ sec : qsaphotonicworld ] .",
    "next , in section  [ sec : knownqsa ] we show that the best known attacks on practical qkd are special cases of the qsa .",
    "section  [ sec : interferobb84 ] demonstrates and analyzes a novel qsa on an interferometric implementation of the bb84 and the six - state qkd protocols .",
    "last , we discuss a few subtleties and open problems for future research in section  [ sec : conclusion ] .",
    "we would like to emphasize that our ( crypt)analysis presents the difficulty of proving unconditional security for practical qkd setups , yet also provides an important ( probably even vital ) step in that direction .",
    "the quantum space attack ( qsa ) is the most general attack on the quantum channel that connects alice to bob .",
    "it can be applied to any realistic qkd protocol , yet here we focus on uni - directional schemes and on implementations of the bb84 protocol and the six - state protocol .",
    "we need to have a proper model of the protocol in order to understand the hilbert space that an unlimited eve can attack .",
    "this space has never been analyzed before except for specific cases .",
    "our main finding is a proper description of this space , which allows , for the first time , defining the most general eavesdropping attack on the channel .",
    "we start with a model of a practical `` qubit '' , continue with understanding the spaces used by alice and bob , and end by defining the relevant space , the _ quantum space of the protocol _ ( qsop ) , used by eve to attack the protocol .",
    "the attacks on the qsop are what we call _ quantum - space attacks_.      in most qkd protocols , alice sends bob qubits , namely , states of 2 dimensional quantum spaces ( @xmath0 ) .",
    "a realistic view should take into account any deviation from theory , caused by alice s equipment .",
    "for example , alice might encode the qubit via a polarized photon : @xmath1 via a photon polarized horizontally , and @xmath2 polarized vertically .",
    "this can be written using fock notation are called fock states , see section  [ sec : qsaphotonicworld ] . ] as @xmath3 where @xmath4 ( @xmath5 ) represents the number of horizontal ( vertical ) photons ; then @xmath6 and @xmath7 .",
    "when alice s photon is lost within her equipment ( or during the transmission ) , bob gets the state @xmath8 , so that alice s realistic space becomes @xmath9 .",
    "alice might send multiple photons and then @xmath10 is of higher dimension , see section  [ sec : alicerealphotonic ] .",
    "[ def : ha ] * alice s realistic space , @xmath10 , * is the minimal space containing the actual quantum states sent by alice to bob during the qkd protocol .    in the bb84 protocol , alice sends qubits in two , etc . ]",
    "fixed conjugate bases .",
    "theoretically , alice randomly chooses a basis and a bit value and sends the chosen bit encoded in the appropriate chosen basis as a state in @xmath0 ( e.g.  @xmath1,@xmath2 , @xmath11 , and @xmath12 ) .",
    "to a better approximation , the states sent by alice are four different states @xmath13 ( @xmath14 ) in her realistic space @xmath10 , spanned by these four states .",
    "this space @xmath10 is of dimension @xmath15 , commonly between 2 and 4 , depending on the specific implementation .",
    "as practical instruments often diverse from theory , alice might send quite different states . as an extreme example , see the _ tagging attack _",
    "( section  [ sec : tagasqsa ] ) , which is based on the fact that alice s space could contain more than just these four theoretical states , so that @xmath16 is possible .",
    "bob commonly receives one of several possible states @xmath17 sent by alice , and measures it .",
    "the most general measurement bob can perform is to add an ancilla , perform a unitary transformation on the joint system , perform a complete measurement , and potentially `` forget '' some of the outcomes . however ,",
    "once alice s space is larger than @xmath0 , the extra dimensions provided by alice could be used by bob for his measurement , _ instead of _ adding an ancilla . interestingly , by his measurement bob might be _ extending _ the space vulnerable to eve s attack well beyond @xmath10 .",
    "this is possible since in many cases the realistic space , @xmath10 , is embedded inside a larger space @xmath18 .",
    "[ def : m ] the space @xmath18 is the space in which @xmath10 is embedded , @xmath19 . the space @xmath18 is the actual space available for alice and an eavesdropper .    due to the presence of an eavesdropper ,",
    "bob s choice whether to add an ancilla or to use the extended space @xmath18 is vital for security analysis . in the first case",
    "the ancilla is added by bob , inside his lab , while in the second it is controlled by alice , transferred through the quantum channel and exposed to eve s deeds .",
    "eve might attack the extended space @xmath18 , and thus have a different effect on bob , considering his measurement method .",
    "for example , suppose alice sends two non - orthogonal states of a qubit , @xmath20 and @xmath21 , with a fixed and known angle @xmath22 .",
    "bob would like to distinguish between them , while allowing inconclusive results sometimes , but no errors  @xcite .",
    "bob can add the ancilla @xmath23 and perform the following transformation  @xmath24 : @xmath25 where @xmath26 .",
    "this operation leads to a conclusive result with probability @xmath27 ( when the measured ancilla is @xmath28 ) , and inconclusive result otherwise .",
    "it is simple to see that the same measurement can be done , _ without the use of an ancilla _",
    ", if the states @xmath29 and @xmath30 are embedded at alice s lab in a larger space @xmath18 , e.g.   @xmath31 , using bob s transformation @xmath32 in the general case , the space @xmath18 might be very large , even infinite .",
    "bob might use only parts of it , for his measurements .",
    "a complication in performing security analysis is due to bob s option to _ both _ use an ancilla and extend the space used by alice .",
    "our analysis in the following sections starts with the space extension only ( sections [ sec : hb][sec : hp ] ) , and later on deals with the general case ( sections [ sec : hb+anc][sec : hp+anc ] ) .",
    "let us formulate the spaces involved in the protocol , as described above .",
    "assume alice uses the space @xmath10 according to definition  [ def : ha ] , which is embedded in a ( potentially larger ) space @xmath18 .",
    "ideally , in the bb84 protocol , bob would like to measure just the states in @xmath10 , but in practice he usually can not do so .",
    "each one of alice s states @xmath33 is transformed by bob s equipment into some pure . for the notion of mixed states or quantum mixture see  @xcite .",
    "] state @xmath34 .",
    "the space which is spanned by those states contains all the information about alice s states @xmath35 .",
    "more important , bob might be measuring un - needed subspaces of @xmath18 which alice s states do not span .",
    "for instance , examine the case where bob uses detectors to measure the fock states @xmath36 and @xmath37 .",
    "bob is usually able to distinguish a loss ( the state @xmath8 ) or an error ( e.g.  @xmath38 , one horizontal photon and one vertical photon ) , from the two desired states , but he can not distinguish between other states containing multiple photons .",
    "this means that bob measures a much larger subspace of the entire space @xmath18 , but ( inevitably ) interprets outcomes outside @xmath10 as legitimate states ; e.g.  the states @xmath39 , @xmath40 , etc .",
    "are ( mistakenly ) interpreted as @xmath36 .",
    "see further discussion in section  [ sec : photonicextension ] .",
    "we denote bob s setup ( beam splitters , phase shifters , etc . ) by the unitary operation @xmath41 , followed by a measurement ; all these operations are operating on the space @xmath18 ( or parts of it ) .",
    "bob might have several different setups ( e.g.  a different setup for the @xmath42-basis and for the @xmath43-basis ) .",
    "let @xmath44 be the set of unitary transformations in all bob s setups .",
    "[ def : hb ] * [ this definition is temporary . ] * given a specific setup - transformation @xmath45 , let @xmath46 be the subsystem actually measured by bob , having @xmath47 basis states @xmath48 .",
    "the set of * bob s measured spaces * is the set @xmath49 of @xmath50 spaces .",
    "we have already seen that bob might be measuring un - needed dimensions . on the other hand he might not measure certain subspaces of @xmath18 , even when alice s state might reach there . in either case , the deviation is commonly due to limitations of bob s equipment .",
    "the `` quantum space of the protocol '' ( qsop ) is in fact alice s _ extended _ space , taking into consideration its _ extensions _ due to bob s measurements .",
    "the security analysis of a protocol depends on the space @xmath51 defined below .",
    "[ def : hb-1 ] * [ this definition is temporary . ] * * the reversed space @xmath51 * is the hilbert space spanned by the states @xmath52 , for each possible setup @xmath53 , and for each basis state @xmath54 of the appropriate @xmath55 .",
    "the space @xmath51 usually resides in a larger space than @xmath10 .",
    "for instance , using photons , the ideal space @xmath10 consists of two modes with 2 basis states , see section  [ sec : qsaphotonicworld ] .",
    "now @xmath51 could have an infinite space in each mode , but also could have more modes .    in order to derive the quantum space of the protocol we need to define the way alice s space",
    "is extended according to @xmath51 , for this simple case where bob does not add an ancilla . in this case",
    ", the space @xmath51 simply extends alice s space to yield the qsop via @xmath56 . formally speaking    [ def : hp ]",
    "* [ this definition is temporary . ] * * the quantum space of the protocol * , @xmath57 , is the space spanned by the basis states of the space @xmath10 and the basis states of the space @xmath51 .    if alice s realistic space is fully measured by bob s detection process , then @xmath10 is a subspace of @xmath51 , hence @xmath58 .      in the general case , one must consider bob s option to add an ancilla during his measurement process .",
    "this addition causes a considerable difficulty in analyzing a protocol , however it is often an inherent part of the protocol , and can not be avoided .",
    "we denote the added ancilla as the state @xmath59 that resides in the space @xmath60 .",
    "[ def : m+anc ] @xmath61 is the space that includes the physical space used by alice as defined in definition  [ def : m ] , in addition to bob s ancilla , @xmath62 .",
    "bob measures a subspace of the space @xmath61 , so the ( permanent ) definitions of his measured spaces @xmath63 and the reversed space @xmath51 should be modified accordingly .",
    "[ def : hb+anc ] given a specific setup - transformation @xmath45 let @xmath64 be the subsystem actually measured by bob , having @xmath47 basis states @xmath48 .",
    "the set of * bob s measured spaces * , is the set @xmath49 of @xmath50 spaces .",
    "the quantum space of the protocol is still alice s _ extended _ space , while considering its _ extensions _ due to bob s measurements .",
    "yet , the added ancilla makes things much more complex .",
    "the security analysis of a protocol depends now _ not _ on the space @xmath51 defined below , but on a ( potentially _ much larger _ ) space obtained from it by tracing - out bob s ancilla .",
    "as before , we first define the reversed space .",
    "[ def : hb-1+anc ] * the reversed space @xmath51 * is the hilbert space spanned by the states @xmath52 , for each possible setup @xmath53 , and for each basis state @xmath54 of the appropriate @xmath65 .",
    "once a basis state of one of bob s measured spaces @xmath54 is reversed by @xmath66 we result with a state that might , partially , reside in bob s ancillary space @xmath60 .",
    "since eve has no access to this space it must be traced - out ( separated out ) , for deriving the qsop .",
    "let us redefine the qsop given the addition of the ancilla :    [ def : hp+anc ] * the quantum space of the protocol , @xmath57 * , is the space spanned by * ( a ) * the basis states of the space @xmath10 ; and * ( b ) * the states @xmath67 $ ] , ( namely , after tracing out bob ) , for each possible setup @xmath53 , and for each basis state",
    "@xmath54 of the appropriate space @xmath63 .    whenever @xmath41 entangles bob s ancilla with the system sent from alice , tracing out bob s ancilla after performing @xmath68 might cause an increase of the qsop to the dimension of bob s ancillary space . for instance , assume alice s state is embedded in an @xmath69-qubit space to which bob adds an ancilla of @xmath69-qubits and performs a unitary transformation @xmath24 , such that for one state measured by bob , @xmath70 . tracing out bob from this state yields the maximally mixed state @xmath71 , so that in this example the whole @xmath69-qubits space is spanned .",
    "when alice and bob use qubits , in theoretical qkd , eve can attack the protocol in many ways . in her simplest attack , the so - called `` measure - resend attack '' ,",
    "eve performs any measurement ( of her choice ) on the qubit , and accordingly decides what to send to bob .",
    "a generalization of that attack is the `` translucent attack '' , in which eve attaches an ancilla , in an initial state @xmath72 ( and in any dimension she likes ) , and entangles the ancilla and alice s qubit , using @xmath73 where @xmath74 is a basis for alice s qubit , and eve s states after the unitary transformation are @xmath75 . using this transformation",
    "one can define the most general `` individual - particle attack ''  @xcite , and also the most general `` collective attack ''  @xcite . in the individual - particle attack eve",
    "delays the measurement of her ancilla till after learning anything she can about the qubit ( e.g. , its basis ) , while in the collective attack eve delays her measurements further till she learns anything she can about _ all _ the qubits ( e.g. , how the final key is generated from the obtained string of shared bits ) , so she attacks directly the _",
    "final key_.    the most general attack that eve could perform on the channel is to attack all those qubits transmitted from alice to bob , using _",
    "one _ large ancilla .",
    "this is the `` joint attack '' .",
    "security , in case eve tries to learn a maximal information on the final key , was proven in  @xcite via various methods .",
    "the attack s unitary transformation is written as before , but with @xmath76 a binary string of @xmath69 bits , and so is @xmath77 , @xmath78 .      by replacing the qubit space @xmath0 by alice s realistic `` qubit '' in the space @xmath10 , and by defining eve s attack on the entire space of the protocol @xmath57 , we can generalize each of the known attacks on theoretical qkd to a `` quantum space attack '' ( qsa ) .",
    "we can easily define now eve s most general _ individual - transmission qsa _ on a realistic `` qubit '' , which generalizes the individual - particle attack earlier described .",
    "eve prepares an ancilla in a state @xmath79 , and attaches it to alice s state , but actually her ancilla is now attached to the entire qsop .",
    "eve performs a unitary transformation @xmath80 on the joint state .",
    "if eve s attack is only on @xmath10 , we write the resulting transformation on any basis state of @xmath10 , @xmath74 , as @xmath81 , where the sum is over the dimension of @xmath10 .",
    "the photon - number - splitting attack ( see section  [ sec : pnsasqsa ] ) is an example for such an attack .",
    "the most general individual - transmission qsa is based on a translucent qsa on the qsop , @xmath82 where the sum is over the dimension of @xmath57 .",
    "the subsystem in @xmath57 is then sent to bob while the rest ( the subsystem @xmath83 ) is kept by eve .",
    "we write the transformation on any basis state of @xmath57 , @xmath84 , but note that it is sufficient to define the transformation on the different states in @xmath10 , namely for all states of the form @xmath74 , since other states of the qsop are never sent by alice ( any other additional subsystem of the qsop is necessarily at a known state when it enters eve s transformation ) .",
    "attacks that are more general than the _ individual transmission qsa _ , the _ collective qsa _ and the _ joint qsa _ , can now be defined accordingly . in the most general collective qsa ,",
    "eve performs the above translucent qsa on many ( say , @xmath69 ) realistic `` qubits '' ( potentially a different attack on each one , if she likes ) , waits till she gets all data regarding the generation of the final key , and she then measures all the ancillas together , to obtain the optimal information on the final key or the final secret .",
    "the most general attack that eve could perform on the channel is to attack all those realistic `` qubits '' transmitted from alice to bob , using _",
    "one _ large ancilla .",
    "this is the `` joint qsa '' . the attack s unitary transformation is written as before , but with @xmath76 a string of @xmath69 digits rather than a single digit ( digits of the relevant dimension of @xmath57 ) , and so is @xmath77 , @xmath85 eve measures the ancilla , after learning all classical information , to obtain the optimal information on the final key or the final secret . as before ,",
    "it is sufficient to define the transformation on the different input states from @xmath86 .",
    "we would like to emphasize several issues : 1. when analyzing specific attacks , or when trying to obtain a limited security result , it is always legitimate to restrict the analysis to the relevant ( smaller ) subspace of the qsop , for simplicity , e.g. , to @xmath10 , or to @xmath51 , etc .",
    "2. any bi - directional protocol will have a much more complicated qsop , thus it might be extremely difficult to analyze any type of qsa ( even the simplest ones ) on such protocols .",
    "this remark is especially important since bi - directional protocols play a very important role in qkd , since they appear in many interesting protocols such as the plug - and - play  @xcite , the ping - pong  @xcite , and the classical bob  @xcite protocols .",
    "specifically they provided ( via the plug - and - play ) the only commerical qkd so far  @xcite .",
    "3. it is well known that the collective or joint attack is only finished after eve gets all quantum and classical information , since she delays her measurements till then  @xcite ; if she expects more information , she better wait and attack the final secret rather than the final key ; it is important to notice that if the key will be used to encode quantum information ( say , qubits ) then the quantum - space of the protocol will require a modification , potentially a major one ; it is interesting to study if this new notion of qsop has an influence on analysis of such usage of the key as done ( for the ideal qubits ) in  @xcite .",
    "since most of the practical qkd experiments and products are done using photons , in this section we demonstrate our qsop and qsa definitions and methods via photons .",
    "our analysis uses the fock - space notations for describing photonic quantum spaces . for clarity , states written using the fock notation are denoted with the superscript ` f ' , e.g.  @xmath87 , @xmath88 , and @xmath89 .",
    "a photon can not be treated as a quantum system in a straightforward way .",
    "for instance , unlike dust particles or grains of sand , photons are indistinguishable particles , meaning that when a couple of photons are interacting , one can not define the evolution of the specific particle , but rather describe the whole system .",
    "let us examine a cavity , for instance .",
    "it can contain photons of specific wavelengthes ( @xmath90 , @xmath91 , etc . ) and the energy of a photon of wavelength @xmath92 is directly proportional to @xmath93 . while one can not distinguish between photons of the same wavelength",
    ", one can distinguish between photons of different wavelengths .",
    "therefore , it is convenient to define distinguishable `` photonic modes '' , such that each wavelength corresponds to a specific mode ( so a mode inside a cavity can be denoted by its wavelength ) , and then count the number of photons in each mode . if a single photon in a specific mode carries some unit of energy , then @xmath69 such photons of the same wavelength carry @xmath69 times that energy .",
    "if the cavity is at its ground ( minimal ) energy level , we say that there are `` no photons '' in the cavity and denote the state as @xmath87the vacuum state . the convention is to denote only those modes that are potentially populated , so if we can find @xmath69 photons in one mode , and no photons in any other mode , we write , @xmath94 . if two modes are populated by @xmath95 and @xmath96 photons , and all other modes are surely empty , we write @xmath97 ( or @xmath98 ) .",
    "when there is no danger of confusion , and the number of photons per mode is small ( smaller than ten ) , we just write @xmath99 for @xmath100 photons in one mode and @xmath69 in the other .",
    "in addition to its wavelength , a photon also has a property called polarization , and a basis for that property is , for instance , the horizontal and vertical polarizations mentioned earlier .",
    "thus , two modes ( in a cavity ) can also have the same energy , but different polarizations .    outside",
    "a cavity photons travel with the speed of light , say from alice to bob , yet modes can still be described , e.g. , by using `` pulses '' of light  @xcite .",
    "the modes can then be distinguished by different directions of the light beams ( or by different paths ) , or by the timing of pulses ( these modes are denoted by non - overlapping time - bins ) , or by orthogonal polarizations .    a proper description of a photonic qubit is commonly based on using two modes ` @xmath101 ' and ` @xmath102 ' which are populated by exactly a single photon , namely , a photon in mode @xmath101 , so the state is @xmath103 , or a photon in mode @xmath102 , so the state is @xmath104 .",
    "however , a quantum space that consists of a single given photonic mode ` @xmath101 ' is not restricted to a single photon , and can be populated by any number of photons . a basis for this space is @xmath105 with @xmath106 , so that the quantum space is infinitely large , @xmath107 .",
    "theoretically , a general state in this space is can be written as the superposition @xmath108 , with @xmath109 , @xmath110 .",
    "similarly , a quantum space that consists of two photonic modes has the basis states @xmath97 , for @xmath111 and a general state is of the form @xmath112 with @xmath113 , @xmath114 .",
    "this quantum space is described as a tensor product of two `` systems '' @xmath115 . using _",
    "exactly _ two photons in two different ( and orthogonal ) modes assists in clarifying the difference between photons and dust particles ( or grains of sand ) : due to the indistiguishability of photons , only 3 different states can exist ( instead of 4 ) : @xmath116 , @xmath117 and @xmath118 .",
    "the last state has one photon in mode ` @xmath101 ' and another photon in ` @xmath102 ' , however , exchanging the photons is meaningless since one can never tell one photon from another .",
    "a realistic model of a photon source ( in a specific mode ) is of a coherent pulse ( a poissonian distribution ) @xmath119 including terms that describe the possibility of emitting any number @xmath69 of photons . as the number of photons increases beyond some number , the probability decreases , so it is common to neglect the higher orders . in qkd , experimentalists commonly use a `` weak '' coherent state ( such that @xmath120 ) and then terms with @xmath121 can usually be neglected . there is also a lot of research about sources that emit ( to a good approximation ) single photons , and then , again , terms with @xmath121 can usually be neglected .",
    "while the theoretical qubit lives in @xmath0 , a realistic view defines the space actually used by alice to be much larger .",
    "the possibility to emit empty pulses increases alice s realistic space into @xmath9 , due to the vacuum state @xmath122 . when alice sends a qubit using two modes , using a weak coherent state ( or a `` single - photon '' source ) , her realistic space , @xmath10 , is embedded in @xmath123 .",
    "terms containing more than two photons can be neglected , so these are excluded from alice s space @xmath10 .",
    "the appropriate realistic quantum space of alice , @xmath10 , is now a quhexit : the six - dimensional space spanned by @xmath124 , @xmath125 , @xmath126 , @xmath127 , @xmath128 , @xmath129 . the pns attack demonstrated in section  [ sec : pnsasqsa ] , is based on attacking this 6 dimensional space @xmath10 .",
    "note also that terms with more than two photons still appear in @xmath18 , and thus could potentially appear in the qsop ( and then used by eve ) .    at times ,",
    "alice s realistic space is even larger , due to extra modes that are sent through the channel , and are not meant to be a part of the protocol .",
    "these extra modes might severely compromise the security of the protocol , since they might carry some vital information about the protocol .",
    "a specific qsa based on that flaw is the `` tagging attack '' ( section  [ sec : tagasqsa ] ) . note that even if alice uses exactly two modes , the quantum space @xmath18 where @xmath10 is embedded , certainly contains other modes as well .",
    "let us discuss bob s measurement of photonic spaces .",
    "there are ( mainly ) two types of detectors that can be used .",
    "the common detector can not distinguish a single photon from more than one photon ( these kind of detectors are known as _ threshold detectors _ ) .",
    "the hilbert space where bob s measurement is defined is infinite by some large number @xmath130 . ] , since a click in the detector tells bob that the number of photons occupying the mode is `` not zero '' i.e.the detector clicks when @xmath94 is detected , for @xmath131 .",
    "this means that bob measures the state @xmath87 , or he measures @xmath132 , @xmath133 , @xmath134 but then `` forgets '' how many photons were detected .",
    "bob might severely compromise the security , since he inevitably interprets a measurement of a state containing multiple photons as the `` legal '' state that contains only a single photon .",
    "an attack based on a similar limitation is the `` trojan - pony '' attack described below , in section  [ subsec : trojan ] . in order to avoid false interpretations of the photon number reaching the detector",
    ", bob could use an enhanced type of detector known as the _ photon - number resolving detector _ or a _ counter _ ( which is still under development ) .",
    "this device distinguishes a single photon from @xmath135 photons , hence any eavesdropping attempt that generates multi - photon states can potentially be noticed by bob .",
    "a much enhanced security can be achieved now , although the qsop is infinite also in this case , due to identifying correctly the legitimate state @xmath132 , from various legitimate states .",
    "the number of modes in the qsop depends on bob s detectors as well .",
    "bob commonly increases the number of measured modes by `` opening '' his detector for more time - bin modes or more frequency modes .",
    "for instance , suppose bob is using a detector whose detection time - window is quite larger than the width of the pulse used in the protocol , since he does not know when exactly alice s pulse might arrive .",
    "the result is an extension of the space used by alice , so that the qsop includes the subspace of @xmath18 that contains all these measured modes .",
    "when a single detector is used to measure more than one mode _ without distinguishing them _ , the impact on the security might be severe , see the `` fake state '' attack ( section  [ sec : fakeasqsa ] ) .",
    "in addition to the known attacks described in the following subsection , a new qsa is analyzed in section  [ sec : interferobb84 ] , where we examine the more general case of qsa , in which bob adds an ancilla during the process .",
    "all known attacks can be considered as special cases of the quantum - space attack . in this section",
    "we show a description of several such attacks using qsa terms . for each and every attack we briefly describe the specific protocol used , the quantum space of the protocol , and a realization of the attack as a qsa .",
    "* the protocol . * consider a bb84 protocol , where alice uses a `` weak pulse '' laser to send photons in two modes corresponding to the vertical and horizontal polarizations when using the @xmath42 basis ( the diagonal polarizations then relate to using the @xmath43 basis ) .",
    "bob uses a device called a pockel cell to rotate the polarization ( by @xmath136 ) for measuring the @xmath43 basis , or performs no rotation if measuring the @xmath42 basis .",
    "the measurement of the state is then done using two detectors and a `` polarization beam splitter '' that passes the first mode to one detector and the second mode to the other detector ( for a survey of polarization - based qkd experiments , see  @xcite ) .",
    "* the quantum space of the protocol . * every pulse sent by alice is in one of four states , each in a superposition of the 6 orthogonal states @xmath137 , @xmath125 , @xmath138,@xmath127,@xmath128 , @xmath139 , where the space used by alice is @xmath140 .",
    "bob uses two setups , @xmath141 for the @xmath42 basis , and @xmath142 for the @xmath43 basis , which is more complex and described in appendix  [ app : polu ] .",
    "the detectors used by bob can not distinguish between modes having single photon and multiple photons .",
    "each one of his two detectors measures the basis elements @xmath143 for @xmath144 ( of the specific mode directed to that specific detector ) , where bob interprets the states @xmath143 with @xmath145 as measuring the state @xmath132 of the same mode .",
    "bob s measured space @xmath146 is thus infinite and spanned by the states @xmath147 for @xmath148 .",
    "the qsop @xmath57 is equal to @xmath149 ( @xmath150 ) since performing @xmath151 does not change the dimensionality of the spanned space ( in both setups ) .    *",
    "the attack . * eve measures the number of photons in the pulse , using non - demolition measurement . if she finds that the number of photons is @xmath152 , she blocks the pulse and generates a loss . in the case",
    "she finds that the pulse consists of 2 photons , she splits one photon out of the pulse and sends it to bob , keeping the other photon until the bases are revealed , thus getting full information of the key - bit .",
    "eve sends the eavesdropped qubits to bob via a lossless channel so that bob will not notice the enhanced loss - rate . as is common in experimental qkd , bob is willing to accept a high loss - rate ( he does not count losses as errors ) , since most of alice s pulses are empty .",
    "see the precise mathematical description of this attack in appendix  [ app : mathpns ] .",
    "* the protocol . * consider a bb84 qkd protocol in which alice sends an enlarged state rather than a qubit .",
    "this state contains , besides the information qubit , a _ tag _ giving eve some information about the bit .",
    "the tag can , for example , tell eve the basis being used by alice . for a potentially realistic example , let the tag be an additional qutrit indicating if alice used the @xmath43-basis , or the @xmath42-basis , or whether the basis is _ unknown _ : whenever alice switches basis , a single photon comes out of her lab prior to the qubit - carrying pulse , telling the basis , say using the states @xmath153 and @xmath154 , and when there is no change of basis , what comes out prior to the qubit is just the vacuum @xmath155 .    * the quantum space of the protocol . * in this example",
    ", alice is using the space @xmath156 .",
    "bob , unaware of the enlarged space used by alice , expects and receives only the subspace @xmath0 .",
    "we assume that bob ideally measures this space with a single setup @xmath157 , therefore @xmath158 .",
    "since bob s setup does not change the space , @xmath159 as well . however , the tag is of a much use to eve , and indeed the qsop following definition  [ def : hp ] , defined to be @xmath160 .    * the attack .",
    "* eve uses the tag in order to retrieve information about the qubit without inducing error ( e.g.via cloning the qubit in the proper basis ) .",
    "the attack is then an intercept - resend qsa .",
    "we mention that this attack is very similar to a side - channel cryptanalysis of classic cryptosystems .",
    "12 pt * a short summery . * it can be seen that the pns attack described above is actually a special case of the tagging attack , where the _ tag _ in that case is in fact another copy of the transmitted qubit .",
    "this copy is kept by eve until the bases are revealed , then it can be measured so the the key - bit value is exposed with certainty .",
    "both those qsa attacks are based on the fact that alice ( realistic ) space is larger than the theoretical one .",
    "although in the pns example , the qsop is further extended due to bob s measurement , the attack is not based on that extension but on the fact that @xmath10 is larger than @xmath0 . in the following attacks",
    "bob s measurements cause the enlargement of the qsop , allowing eve to exploit the larger qsop for her attack .      in trojan - pony attacks",
    "eve modifies the state sent to bob in a way that gives her information .",
    "in contrast to a `` trojan - horse '' that goes in - and - out of bob s lab , the `` pony '' only goes in , therefore , it is not considered an attack on the lab , but only on the channel .",
    "we present here an interesting example  @xcite .    *",
    "the protocol .",
    "* assume a polarization - encoded bb84 protocol , in which alice is ideal , namely , sending perfect qubits ( @xmath161 ) .",
    "however , bob uses realistic threshold detectors that suffer from losses and dark counts , and that can not distinguish between one photon and @xmath162 photons for @xmath163 . in order to be able to `` prove '' security , for a longer distance of transmission bob wants to keep the error - rate low although the increase of dark counts impact with the distance  @xcite .",
    "therefore , bob assumes that eve has no control over dark counts , and whenever both detectors click , alice and bob agree to consider it as _ a loss _ since it is outside of eve s control ( i.e.  the qsop is falsely considered to be @xmath0 ) .",
    "namely , they assume that _ an error _ occurs only when bob measures in the right basis , and only one detector clicks , ( which is the detector corresponding to the wrong bit - value ) .",
    "* the quantum space of the protocol . * same as in section  [ sec : pnsasqsa ] , bob s measured spaces @xmath149 , @xmath164 , the reversed space @xmath51 as well as the qsop @xmath57 , are merely the spaces describing two modes ( with up to @xmath130 photons ) , @xmath165 .",
    "bob s detectors can not distinguish between receiving a single - photon pulse from a multi - photon pulse , so his measurement is properly described as a projection of the received state onto the space containing @xmath166 followed by `` forgetting '' the exact result , and keeping only one of three results : `` @xmath167 detector-1 clicks '' , `` @xmath168 detector-2 clicks '' , and else it is @xmath169 , a `` loss '' . in formal , _ generalized - measurements _ language ( called povm , see  @xcite ) these three possible results are written as : @xmath170 , @xmath171 , @xmath172 , and their sum is the identity matrix .    * the attack . * eve s attack is the following : ( a ) randomly choose a basis ( b ) measure the arriving qubit in that specific chosen basis ( c ) send bob @xmath100-photons identical to the measured qubit , where @xmath173 . obviously , when eve chooses the same basis as alice and bob then bob measures",
    "the exact value sent by alice , and eve gets full information .",
    "otherwise , both of his detectors click , implying a `` loss '' , except for a negligible probability , @xmath174 , thus eve induces no errors .",
    "the main observation of this measure - resend qsa is that treating a count of more than a single photon as a loss , rather than as an error , is usually not justified .",
    "a second conclusion is that letting bob use counters instead of threshold detectors ( to distinguish a single photon from multiple photons ) , together with treating any count of more than one photon as an error , could be vital for proving security against qsa .",
    "the price is that dark counts put severe restrictions on the distance to which communication can still be considered secure , as suggested already by  @xcite .      *",
    "the protocol .",
    "* in this example , we examine a polarization encoded bb84 protocol , and an ideal alice ( @xmath175 ) .",
    "this time bob s detectors are imperfect so that their detection windows do not fully overlap , meaning that there exist times in which one detector is blocked ( or it has a low efficiency ) , while the other detector is still regularly active .",
    "thus , if eve can control the precise timing of the pulse , she can control whether the photon will be detected or lost .",
    "the setup is built four detectors and a rotating mirror ( since bob does not want to spend money on a pockel cell ( polarization rotator ) , he actually uses 2 fixed different setups ) .",
    "using the rotating mirror bob sends the photon into a detection setup for basis @xmath42 or a detection setup for basis @xmath43 .",
    "suppose the two detection setups use slightly different detectors , or slightly different delay lines , or slightly different shutters , and eve is aware of this ( or had learnt it during her past attacks on the system ) . for simplicity",
    ", we model the non - overlapping detection windows , as additional two modes , one slightly prior to alice s intended mode ( the pulse ) , and one right after it .    * the quantum space of the protocol . *",
    "the original qubit is sent in a specific time - bin @xmath176 ( namely , @xmath161 ) .",
    "the setup @xmath177 is a set of two detectors and a polarized beam splitter , separating the horizontal and the vertical modes to the detectors , where @xmath178 separate the diagonal modes into a set of two ( different ) detectors .",
    "let the detectors for one basis , say @xmath42 , be able to measure a pulse arriving at @xmath176 or @xmath179 , while the detectors for the other basis ( @xmath43 ) measure pulses arriving at @xmath180 or @xmath176 .    for simplicity ,",
    "we degenerate the space to contain one or less photons . ] , so that @xmath149 is @xmath181 , i.e. two possible time - bins consisting each of two ( polarization ) modes of one or less photons .",
    "the measured space of the @xmath43-setup has two possible time - bins and two possible polarization modes , thus @xmath182 as well , however , the two time - bins for this setup are @xmath176 and @xmath179 .",
    "following definition  [ def : hb-1 ] we get that that the reversed space @xmath51 contains three time - bins ( @xmath180 , @xmath176 and @xmath179 ) with two polarization modes in each , therefore @xmath183 , under the single - photon assumption .",
    "the qsop , following definition  [ def : hp ] equals @xmath51 since @xmath184 .    * the attack . *",
    "eve exploit the larger space by sending `` fake '' states using the external time bins ( @xmath180 and @xmath179 ) .",
    "eve randomly chooses a basis , measures the qubit sent by alice , and sends bob the same polarization state she found , but at @xmath180 if she have used the @xmath43 basis , or at @xmath185 if she have used the @xmath42 basis . since no ancilla is kept by eve , this is an intercept - resend qsa .",
    "bob will get the same result as eve if he uses the same basis , or _ a loss _ otherwise .",
    "the mathematical description of the attack is as follows : eve can generate superpositions of states of the form @xmath186 , where the index @xmath187 denotes this mode has vertical or horizontal polarization , and its subscript denotes the time - bin of the mode .",
    "eve s measure - resend attack is described as measuring alice s qubit in the @xmath43 basis , creating a new copy of the measured qubit , and performing the transformation @xmath188 ; @xmath189 or as performing a measurement in the @xmath42 basis , and performing the transformation @xmath190 ; @xmath191 on the generated copy .",
    "12 pt * a short summery * we see that eve can `` force '' a desired value ( or a loss ) on bob , thus gaining all the information while inducing no errors ( but increasing the loss rate ) .",
    "bob can use a shutter to block the irrelevant time - bins but such a shutter could generate a similar problem in the frequency domain .",
    "this attack is actually a special case of the trojan - pony attack , in which the imperfections of bob s detectors allow eve to send states that will be un - noticed unless the measured basis equals to eve s chosen basis .",
    "in order to demonstrate the power of qsa , and to see its advantages , this section presents a partial security analysis of some interferometric bb84 and 6-state schemes .",
    "interferometric schemes are more common than any other type of implementation in qkd experiments  @xcite and products  @xcite . in this section",
    "we define the specific equipment used by bob , and we formulate @xmath41 and bob s measurements .",
    "we then find the spaces @xmath10 , @xmath63 , @xmath51 and the qsop , @xmath57 . finally , we demonstrate a novel attack which is found to be very successful against a specific variant of the bb84 interferometric scheme ; this specific qsa , which we call the `` reversed - space attack '' , is designed using the tools developed in sections  [ sec : qsop ] and  [ sec : qsa ] .",
    "we begin with a description of interferometric ( bb84 and six - state ) schemes , which is based on sending phase - encoded qubits arriving in two time - separated modes  @xcite .",
    "alice encodes her qubit using two time - bins @xmath192 and @xmath193 , where a photon in the first mode , @xmath194 , represents the state @xmath1 , and a photon in the other mode , @xmath195 , represents @xmath2 .",
    "the bb84 protocol of  @xcite ( and many others ) uses the @xmath43 and @xmath196 bases , meaning that alice ( ideally ) sends one of the following four states : @xmath197 ; @xmath198 ; @xmath199 ; and @xmath200 .",
    "bob uses an interferometer built from two beam splitters with one short path and one long path ( figure  [ fig : lab - xy ] ) . a pulse of light travels through the short arm of the interferometer in @xmath201 seconds , and through the long arm in @xmath202 seconds , where @xmath203 is also _ precisely _ the time separation between the two arriving modes of the qubit , @xmath204 . a controlled phase shifter @xmath205 ,",
    "is placed in the long arm of the interferometer .",
    "it performs a phase shift by a given phase @xmath206 , i.e. @xmath207 . the phase shifter is set to @xmath208 ( @xmath209 ) when bob measures the @xmath43 ( @xmath196 ) basis .     and @xmath196 basis .",
    "( a ) alice sends a qubit ; ( b ) vacuum states are added in the interferometer ; ( c ) , ( d ) beam - splitters ; ( e ) phase shifter @xmath205 . ]    each beam splitter interferes two input arms ( modes 1 , 2 ) into two output arms ( modes 3 , 4 ) , in the following way ( for a single photon ) : @xmath210 , and @xmath211 .",
    "the photon is transmitted / reflected with a probability of @xmath212 ; the transmitted part keeps the same phase as the incoming photon , while the reflected part gets an extra phase of @xmath213 , if it carries a single photon .",
    "when a single mode , carrying at least a single photon , enters a beam splitter from one arm , and nothing enters the other input arm , we must consider the other entry to be an additional mode ( an ancilla ) in a vacuum state .",
    "when a single mode ( carrying one or more photons ) enters the interferometer at time @xmath192 , see figure  [ fig : lab - xy ] , it yields two modes at time @xmath176 due to traveling through the short arm , and two modes at time @xmath179 due to traveling through the long arm .",
    "those four output modes are : times @xmath176 , @xmath179 in the ` @xmath214 ' ( straight ) arm of the interferometer , and times @xmath176 , @xmath179 in the ` @xmath215 ' ( down ) arm .",
    "a basis state in this fock space is then @xmath216 . in the case of having that single mode carrying exactly a single photon , the transformation , which requires three additional empty ancillas .",
    "] , is @xmath217 . note that a pulse which is sent at a different time ( say , @xmath218 ) results in the same output state , but with the appropriate delays , i.e.   @xmath219 where the resulting state is defined in the fock space whose basis states are @xmath220 .",
    "let us now examine any superposition of two modes ( @xmath192 and @xmath193 ) that enter the interferometer one after the other , with exactly the same time difference @xmath203 as the difference lengths of the arms .",
    "the state evolves in the following way ( see appendix  [ app : modesevo ] ) : @xmath221 describing the evolution for any possible bb84 state sent by alice ( @xmath222 , @xmath223 , @xmath224 , @xmath225 determined by the value of @xmath226 , @xmath227 , @xmath228 , @xmath229 respectively , when @xmath230 ) . as a result of this precise timing",
    ", these two modes are transformed into a superposition of 6 possible modes ( and not 8 modes ) at the outputs , due to interference at the second beam splitter .",
    "only four vacuum - states ancillas ( and not six ) are required for that process .",
    "the resulting 6 modes are @xmath176 , @xmath179 , @xmath231 in the ` @xmath214 ' arm and in the ` @xmath215 ' arm of the interferometer .",
    "denote this fock space as @xmath232 , with basis elements @xmath233 .",
    "the measurement is performed as follows : bob opens his detectors at time @xmath179 in both output arms of the interferometer .",
    "a click in the `` down '' direction means measuring the bit - value @xmath234 , while a click in the `` straight '' direction means @xmath235 .",
    "the other modes are commonly considered as a loss ( they are not measured ) since they give an inconclusive result regarding the original qubit .",
    "we refer this bb84 variant as `` @xmath236-bb84 '' .",
    "one might want to use the @xmath42 basis in his qkd protocol ( using @xmath226 , and @xmath237 or @xmath238 ) , for instance , in order to avoid the need for a controlled phase shifter or for another equipment - related reason , or in order to perform `` qkd with classical bob ''  @xcite .",
    "a potentially more important reason might be to perform the 6-state qkd  @xcite protocol , due to its improved immunity against errors ( 27.4% errors versus only 20% in bb84  @xcite ) .",
    "a possible and easy to implement variant for realizing a measurement in the @xmath42 basis is the following : bob uses the setup @xmath239 ( i.e.  he sets @xmath205 to @xmath240 ) , and opens his detectors at times @xmath176 and @xmath231 , corresponding to the bit - values @xmath234 and @xmath235 respectively ( see equation  ( [ eqn : interf_evu ] ) ) . unfortunately",
    ", technological limitations , e.g.  of telecommunication wavelength ( ir ) detectors , might make it difficult for bob to open his detectors for more than a single detection window per pulse .",
    "bob could perform a measurement of _ just _ the states @xmath241 , opening the @xmath215 arm detector at time @xmath176 ( to measure @xmath1 ) and the @xmath214 arm detector at time @xmath231 ( to measure @xmath2 ) .",
    "we refer this variant as `` @xmath242-six - state '' .",
    "we assume alice to be almost ideal , having the realistic space @xmath243 ( a qubit or a vacuum state ) , using two time - bin modes .",
    "as we have seen , four ancillary modes in vacuum states are added to each transmission .",
    "therefore , the interferometer setups @xmath239 and @xmath244 transform the 2-mode states of @xmath10 into a subspace that resides in the 6 modes space @xmath232 . for simplicity",
    ", we assume that eve does not generate @xmath69-photon states , with @xmath135 , so we can ignore high photon numbers in the @xmath232 space , this assumption is not legitimate when proving unconditional security of a protocol . ] .",
    "therefore , we redefine @xmath245 , the space spanned by the vacuum , and the six single - photon terms in each of the above modes .    using the @xmath43 and @xmath196 bases , bob measures only time - bin @xmath179 , so his actual measured spaces consist of two modes : time - bin @xmath179 in the ` @xmath214 ' arm and the ` @xmath215 ' arm . in that case , the measured spaces are @xmath246 , spanned by the states @xmath247 , @xmath248 , @xmath249 .",
    "when bob uses the @xmath42 basis , he measures two different modes , so @xmath149 is spanned by the states @xmath247 , @xmath250 , @xmath251 .",
    "let us define the appropriate space @xmath51 for the 6-state protocol , according to definition  [ def : hb-1+anc ] .",
    "the space @xmath51 is spanned by the states given by performing @xmath252 on @xmath253 , @xmath254 , @xmath255 , as well as the states given by performing @xmath256 on @xmath253 , @xmath257 , @xmath258 .",
    "interestingly , once applying @xmath151 , the resulting states are embedded in an 8-mode space defined by the two incoming arms of the interferometer , ` @xmath101 ' ( from alice ) and ` @xmath102 ' ( from bob ) , at time bins @xmath259 , @xmath260 , @xmath261 , and @xmath262 .",
    "the basis states of @xmath51 are listed in appendix  [ app : interf_hb-1_basis ] .    following definition  [ def : hp+anc ] , the qsop @xmath57 of this implementation for the 6-state protocol , is the subsystem of @xmath51 which is _ controlled _ by eve .",
    "it is spanned by the 8-mode states spanning @xmath51 after tracing out bob .",
    "the space that contains those `` traced - out '' states has only four modes that are controlled by eve , specifically , input ` @xmath101 ' of the interferometer at times @xmath259 to @xmath263 , having a basis state of the form @xmath264 . given the single - photon restriction , we get @xmath265 , namely , the space spanned by the vacuum state , and a single photon in each of the four modes , i.e. @xmath266 , @xmath267 , @xmath268 , @xmath269 , @xmath270 . this same result is obtained also if bob measures all the six modes in @xmath232 .",
    "bob might want to see how the basis states of the 4-mode qsop , @xmath57 , evolve through the interferometer in order to place detectors on the resulting modes , which will be used to identify eve s attack .",
    "it is interesting to note , that those basis states result in _ 10 different non - empty modes ( ! ) _ .",
    "if bob measures all these modes , he _ increases _ the qsop , and maybe allows eve to attack a larger space , and so on and so forth .",
    "therefore , in order to perform a security analysis , one must first fix the scheme and only then assess the qsop . otherwise , a `` ping - pong '' effect might increase the spaces dimensions to infinity . a similar ,",
    "yet reversed logic , hints that it could actually be better for bob , in terms of the simplicity of the analysis for the `` @xmath236-bb84 '' scheme , to measure _ just _ the two modes at @xmath179 ( i.e.  the space spanned by @xmath271 ) , thus reducing the qsop to a 2-mode space , @xmath272 , see appendix  [ app : qsop2modesintf ] .",
    "although eve is allowed to attack a larger space than this two - mode @xmath57 , she has no advantage in doing so : pulses that enter the interferometer on different modes ( i.e.  other time - bins than @xmath192 and @xmath193 ) , never interfere with the output pulses of time - bin @xmath179 measured by bob .",
    "therefore , state occupying different modes can not be distinguished from the states in which those modes are empty .      consider a bb84 variant in which bob uses only the @xmath43 and the @xmath42 bases , using a single interferometer , where the @xmath42-basis measurement is performed according to the description in the last few lines of section  [ sec : xy - setup ] .",
    "we refer this variant as `` @xmath273-bb84 '' .",
    "the qsop of this scheme , @xmath57 is the space described above for the `` @xmath242-six - state '' protocol .",
    "the following attack @xmath274 which we call `` the reversed - space attack '' , allows eve to acquire information about the transmitted qubits , without inducing _ any _ errors .",
    "the states @xmath275 denote eve s ancilla which is not necessarily a photonic system .",
    "the state @xmath276 and @xmath277 are the regular states send by alice , where we added the relevant extension of @xmath10 in @xmath57 .",
    "when @xmath278 is sent by alice , the attacked state @xmath279 reaches bob s interferometer , and interferes in a way such that it can never reach bob s detector at time @xmath231 , i.e. @xmath280 . although the attacked state @xmath281 reaches modes that alice s original state @xmath278 can never reach , bob never measures those modes , and can not notice the attack .",
    "a similar argument applies when alice sends @xmath282 .    as for the @xmath43 basis , etc . ]",
    ", this attack satisfies @xmath283",
    "@xmath284 the first element in the sum results in the desired interference in bob s lab , while the second is not measured by bob s detectors at time @xmath179 . by letting eve s probes @xmath285 and @xmath286 be orthogonal states , eve gets a lot of information while inducing no errors at all . yet",
    ", we find that eve is increasing the loss rate by this attack to 87.5% , but a very high loss rate is anyhow expected by bob ( as explained in the analysis of the pns  @xcite and the tagging  @xcite attacks ) .    in conclusion",
    ", this attack demonstrates the risk of using various setups without giving full security analysis for the _ specific _ setup .",
    "we are not familiar with any other security analysis that takes into account the enlarged space generated by the inverse - transformation of bob s space .",
    "in this paper we have defined the qsa , a novel attack that generalizes all currently known attacks on the channel .",
    "this new attack brings a new method for performing security analysis of protocols .",
    "the attack is based on a realistic view of the quantum spaces involved , and in particular , the spaces that become larger than the theoretical ones , due to practical considerations .",
    "although this paper is explicitly focused on the case of uni - directional implementations of a few schemes , its main observations and methods apply to any uni - directional qkd protocol , to bi - directional qkd protocols , and maybe also to any realistic quantum cryptography scheme beyond qkd .",
    "the main conclusion of this research is that the quantum space which is attacked by eve can be assessed , given a proper understanding of the experimental limitations .",
    "this assessment requires a novel cryptanalysis formalism  analyzing the states generated in alice s lab , as well as the states that are to be measured by bob ( assessing them as if they go backwards in time from bob s lab ) ; this type of analysis resembles the two - time formalism in quantum theory  @xcite .",
    "open problems for further theoretical research include : 1. generalization of the qsa to other conventional protocols ( such as the two - state protocol , epr - based protocols , d - level protocols , etc . )",
    "; such a generalization should be rather straightforward .",
    "2. proving unconditional security ( or more limited security results such as `` robustness ''  @xcite ) against various qsas .",
    "this is especially important for the interferometric setup , where the qsop is much larger than alice s six - dimensional space ( the one spanned by @xmath287 ) .",
    "3. describing the qsa for more complex protocols , such as two - way protocols @xcite in which the quantum communication is bi - directional , and protocols which use a larger set of states such as data - rejected protocols @xcite or decoy - state protocols @xcite . 4. extend the analysis and results to composable qkd  @xcite .",
    "5(a). in some cases , if bob uses `` counters '' and treats various measurement outcomes as errors , the effective qsop relevant for proving security is potentially _ much smaller _ than the qsop defined here .",
    "5(b). adding counters on more modes increases the qsop defined here , but might allow analysis of a smaller `` attack s qsop '' , if those counters are used to identify eve s attack .",
    "more generally , the connection between the way bob interprets his measured outcomes , and the `` attack s qsop '' is yet to be further analyzed .",
    "[ [ acknowledgments . ] ] * acknowledgments . * + + + + + + + + + + + + + + + + + +    we thank michel boyer , dan kenigsberg and hoi - kwong lo for helpful remarks .    10    d.  z. albert , y.  aharonov , and s.  damato .",
    "curious new statistical prediction of quantum mechanics .",
    ", 54(1):57 , jan 1985 .",
    "s.  m. barnett , b.  huttner , and s.  j.  d. phoenix . . ,",
    "40:25012513 , dec .",
    "1993 .    h.  bechmann - pasquinucci and n.  gisin . .",
    ", 59(6):42384248 , jun . 1999 .",
    "m.  ben - or , m.  horodecki , d.  w. leung , d.  mayers , and j.  oppenheim .",
    "the universal composable security of quantum key distribution . in _",
    "tcc 2005 : second theory of cryptography conference _ , pages 386406 , jan . 2005 .    c.  h. bennett and g.  brassard . .",
    ", pages 175179 , dec . 1984 .",
    "e.  biham , m.  boyer , p.  o. boykin , t.  mor , and v.  p. roychowdhury .",
    "a proof of the security of quantum key distribution . in _ proceedings of the 32nd annual acm symposium on theory of computing ( stoc ) _ , pages 715724 , new york , 2000 .",
    "acm press .",
    "e.  biham , m.  boyer , p.  o. boykin , t.  mor , and v.  p. roychowdhury .",
    "a proof of the security of quantum key distribution .",
    ", 19(4):381439 , 2006 .",
    "e.  biham , m.  boyer , g.  brassard , j.  van de graaf , and t.  mor . . , 34:372388 ,",
    "e.  biham and t.  mor .",
    "security of quantum cryptography against collective attacks .",
    ", 78(11):22562259 , mar 1997 .",
    "k.  bostrm and t.  felbinger .",
    "deterministic secure direct communication using entanglement .",
    ", 89(18):187902 , oct 2002 .",
    "m.  boyer , d.  kenigsberg , and t.  mor . quantum key distribution with classical bob .",
    "arxiv quantum physics e - prints , 2007 .",
    "quant - ph/0703107 .",
    "g.  brassard , n.  ltkenhaus , t.  mor , and b.  c. sanders . .",
    "eurocrypt 2000 : international conference on the theory and application of cryptographic techniques _",
    ", lncs 1807:289299 , 2000    g.  brassard , n.  ltkenhaus , t.  mor , and b.  c. sanders . . , 85:13301333 ,",
    "k.  j.  blow , r.  loudon , s.  phoenix and t.  j.  shepherd .",
    ", 42(7):41024114 , oct . 1990 .    d.  bru . . , 81:30183021 ,",
    "h.  f.  chau . .",
    ", 66(6):060302 , dec .",
    "_ for different ( slightly smaller ) numbers , see  @xcite .",
    "_    m.  dusek , n.  lutkenhaus , and m.  hendrych . .",
    "arxiv quantum physics e - prints , jan .",
    "quant - ph/0601207 .    c.  elliott , d.  pearson , and g.  troxel .",
    "quantum cryptography in practice . in _",
    "sigcomm 03 : proceedings of the 2003 conference on applications , technologies , architectures , and protocols for computer communications _ , pages 227238 , new york , ny , usa , 2003 .",
    "acm press .",
    "a.  ekert , b.  huttner , g.  palma and a.  peres .",
    "eavesdropping on quantum - cryptographical systems .",
    ", 50(2):10471056 , aug .",
    "1994 .    c.  fuchs , n.  gisin , r.  griffiths , c.s .",
    "niu and a.  peres .",
    "optimal eavesdropping in quantum cryptography .",
    "i. information bound and optimal strategy .",
    ", 56(2):11631172 , aug . 1997 .",
    "n.  gisin , s.  fasel , b.  kraus , h.  zbinden , and g.  ribordy . .",
    ", 73(2):022320+ , feb .",
    "n.  gisin , b.  kraus , and r.  renner .",
    "lower and upper bounds on the secret key rate for qkd protocols using one  way classical communication .",
    ", 95:080501 , 2005 .",
    "n.  gisin , g.  ribordy , w.  tittel , and h.  zbinden . . ,",
    "74:145195 , jan .",
    "d.  gottesman , h .- k .",
    "lo , n.  ltkenhaus , and j.  preskill .",
    "security of quantum key distribution with imperfect devices .",
    ", 5:325360 , 2004 .",
    "quantum key distribution with high loss : toward global secure communication .",
    ", 91(5):057901 , aug .",
    "hwang , i .-",
    "lim , and j .- w .",
    "no - clicking event in quantum key distribution .",
    "arxiv quantum physics e - prints , 2004 .",
    "quant - ph/0412206 .",
    "h.  inamori , n.  ltkenhaus , and d.  mayers . .",
    ", 41:599627 , mar .",
    "lo and h.  f. chau . unconditional security of quantum key distribution over arbitrarily long distances . , 283:20502056 , 1999 .",
    ", 1(2):8194 , aug .",
    "lo , x.  ma , and k.  chen . . ,",
    "94(23):230504+ , jun . 2005 .",
    "v.  makarov , a.  anisimov , and j.  skaar .",
    "effects of detector efficiency mismatch on security of quantum cryptosystems . , 74:022313 , 2006 .    c.  marand and p.  townsend , 20:16951697 , aug .",
    "a.  muller , t.  herzog , b.  huttner , w.  tittel , h.  zbinden and n.  gisin . .",
    ", 70:793395 , feb 1997 .    v.  makarov and d.  r. hjelme . . , 52:691705 ,",
    "may 2005 .",
    "d.  mayers .",
    "unconditional security in quantum cryptography .",
    ", 48(3):351406 , 2001 , _ based on  @xcite_.    a.  niederberger , v.  scarani , and n.  gisin .",
    "photon - number - splitting versus cloning attacks in practical implementations of the bennett - brassard 1984 protocol for quantum cryptography .",
    ", 71:042316 , 2005 .",
    "m.  a. nielsen and i.  l. chuang . .",
    "cambridge university press , cambridge , uk , 2000 .",
    "a.  peres . .",
    ", 128:19 , mar 1988 .",
    "a.  peres . .",
    "kluwer , dordrecht , 1993 .",
    "v.  scarani , a.  acn , g.  ridbory and n.  gisin .",
    "quantum cryptography robust against photon number splitting attacks for weak laser pulse implementations .",
    ", 92(5):057901+ , feb .",
    "m.  scully and m.  s.  zubairy . .",
    "cambridge university press , cambridge , united kingdom , 1997 .",
    "p.  w. shor and j.  preskill .",
    "simple proof of security of the bb84 quantum key distribution protocol .",
    ", 85:441444 , 2000 , _ based on  @xcite_.    p.  d.  townsend . . , 30:809811",
    "l.  vaidman , y.  aharonov , and d.  z. albert . how to ascertain the values of @xmath288 , @xmath289 , and @xmath290 of a spin-1/2 particle . , 58(14):13851387 , apr .",
    "x.  b.  wang . .",
    ", 94:230503 , jun . 2005 .",
    ", pages 6775 , las vegas , navada , united states , 1995 .",
    "z.  l. yuan , a.  w. sharpe , and a.  j. shields . .",
    ", 90:1118+ , jan . 2007 .",
    "the pns attack can be realized using ( an infinite set of ) polarization independent beams splitters .",
    "eve uses a beam splitter to split photons from alice s state . using a non - demolition measurement eve measures the number of photons in one output of the beam splitter , and repeat the splitting until she acquires exactly one photon .",
    "formally @xmath80 is defined : @xmath291 whenever alice sends a pulse with two photons of the same polarization , eve and bob end up , each , with having a single photon of the original polarization .",
    "eve s pns attack for a pulse of 2 photons , gives eve full information while inducing no errors .",
    "according to its definition it is trivial to verify the attack for the horizontal and vertical polarizations @xmath292 and @xmath293 ( where @xmath294 means @xmath162 photons having polarization @xmath295 ) . using the standard creation and annihilation operators ( @xmath296 and @xmath101 ) ,",
    "we can write the state of two photons in the diagonal polarization ( @xmath43 basis ) : @xmath297 , similarly @xmath298 .",
    "@xmath299    @xmath300    which completes the proof .",
    "a polarization based qkd protocol makes a use of a pockel cell ( @xmath239 ) , rotating the polarization of the photons going through it . for a single photon ,",
    "its action is trivial , @xmath301 for a state that contains multiple photons , the transformation is not intuitive , and most simply defined using the creation and annihilation operators . in a somewhat simplified way , the pokcel cell can be considered as performing @xmath302 and @xmath303 , so that a state is transformed in the following way @xmath304",
    "in order to simplify the analysis ( a simplification that is not allowed when proving the full security of a scheme ) we look at the ideal case in which exactly one photon ( or none ) is sent by alice .",
    "the basis states are then the vacuum @xmath305 , and the six states ( that we denote for simplicity by ) @xmath306 ; @xmath307 ; @xmath308 ; @xmath309 ; @xmath310 and @xmath311 .",
    "the full transformation of a single photon pulse through the interferometer is given by equation  .",
    "alice sends photons at time bins @xmath192 and @xmath193 only , so the interferometer transformation on alice s basis states is @xmath312 , and @xmath313 where @xmath314 denotes ancilla added during the process ) are originated by alice extended space @xmath57 and by bob ( @xmath60 ) . performing @xmath151 reveals the exact origin of those ancillas . ] .",
    "equation  [ eqnb+-on01 ] can be used to describe the interferometer effect on a general qubit , shown in equation  .",
    "the states sent by alice during the `` @xmath236-bb84 '' protocol evolve in the interferometer as follows : @xmath315 bob can distinguish the computation basis elements of bases @xmath43 and @xmath196 , measuring time - bin @xmath179 , i.e.  the states @xmath316 for @xmath317 and @xmath318 for @xmath319 in the measured basis .",
    "other states give bob no information about the state sent by alice .",
    "let bob be using interferometric setups @xmath239 and measuring 6 modes ( corresponding the space with a basis state @xmath320 ) with one or less photons . following definition  [ def : hb-1+anc ] , the states spanning the space @xmath51 can be derived using equation   ( adjusted to the appropriate space ) : @xmath321 defined over the space @xmath322 with basis state @xmath323 .",
    "note that performing @xmath151 requires an additional ancilla , since the modes number increases from six to eight .",
    "assume bob measures only time - bin @xmath179 in both output arms of the interferometer , i.e.  the measured space is @xmath232 subspace spanned by @xmath271 . assuming a single - photon restriction , the reversed space , of that measured space that is spanned by : @xmath324 as can be verified using equation  .",
    "the space @xmath51 is embedded in a 4-mode space @xmath325 , having the basis element @xmath326 , i.e. alice modes at times @xmath192 and @xmath193 and bob s added ancillary modes at times @xmath192 and @xmath193 respectively .",
    "the resulting six states span a 4-dimensional space , i.e.  @xmath327 .",
    "the qsop in this special case is @xmath328 , spanned by @xmath329 with one or less photons ."
  ],
  "abstract_text": [
    "<S> theoretical quantum key distribution ( qkd ) protocols commonly rely on the use of qubits ( quantum bits ) . in reality , however , due to practical limitations , the legitimate users are forced to employ a larger quantum ( hilbert ) space , say a quhexit ( quantum six - dimensional ) space , or even a much larger quantum hilbert space . </S>",
    "<S> various specific attacks exploit of these limitations . </S>",
    "<S> although security can still be proved in some very special cases , a general framework that considers such realistic qkd protocols , _ as well as _ </S>",
    "<S> attacks on such protocols , is still missing .    </S>",
    "<S> we describe a general method of attacking realistic qkd protocols , which we call the ` quantum - space attack ' . </S>",
    "<S> the description is based on assessing the enlarged quantum space actually used by a protocol , the ` quantum space of the protocol ' . </S>",
    "<S> we demonstrate these new methods by classifying various ( known ) recent attacks against several qkd schemes , and by analyzing a novel attack on interferometry - based qkd . </S>"
  ]
}