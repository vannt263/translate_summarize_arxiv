{
  "article_text": [
    "the formation of ripples and dunes at the surface of an erodible sand bed results from the interplay between the relief , the flow and the sediment transport .",
    "the aim of these two companion papers is to propose a coherent and detailed picture of this phenomenon in the generic and important case of a unidirectional turbulent stream .",
    "this first part is devoted to the study of the stationary flow over a wavy rough bottom . in the second part",
    "we propose a common theoretical framework for the description of the different modes of sediment transport .",
    "hydrodynamics and transport issues at hand , we then revisit the linear instability of a flat sand bed submitted to a water shear flow and show that , in contrast to ripples , subaqueous dunes can not form by a primary linear instability .",
    "it has long been recognised that the mechanism responsible for the formation and growth of bedforms is related to the phase - lag between sediment transport and bed elevation ( @xcite ) .",
    "it has been shown in the context of aeolian dunes that this lag comes from two contributions , which can be considered as independent as the time scale involved in the bed evolution is much slower than the hydrodynamics relaxation ( @xcite ) .",
    "first there is a shift between the bed and the basal shear stress profiles .",
    "this shift purely results from the hydrodynamics and its sign is not obvious _ a priori _",
    ", i.e. the stress maximum can be either upstream or downstream the bed crest depending on the topography or the proximity of the free surface .",
    "the second contribution comes from the sediment transport : the sediment flux needs some time / length to adapt to some imposed shearing .",
    "this relaxation mechanism induces a downstream lag of the flux with respect to the shear . when the sum of these two contributions results in a maximum flux upstream the bed crest , sediment deposition occurs on the bump , leading to an unstable situation and thus to the amplification of the disturbance . in part 1",
    ", we shall focus on the first of these contributions , the second one being treated in part 2 .",
    "@xmath1 is perpendicular .",
    "the bottom profile is @xmath2 . in that experiment ,",
    "the wavelength and amplitude of the bumps are @xmath3  m and @xmath4  m , for a water depth @xmath5  m ) .",
    "the point of maximum shear on the bump ( where the lines are squeezed ) is located upstream the crest .",
    "[ wavyschematic ] ]    we consider here the generic case of a flow over a fixed sinusoidal bottom of wavelength @xmath6 ( see figure  [ wavyschematic ] for an illustration of the geometry and some notations ) . in order to obtain the basal shear stress and in particular its phase shift with respect to the topography",
    ", the equations of hydrodynamics must be solved in this geometry .",
    "the case of viscous flows has been investigated by @xcite .",
    "the first attempts to model the high reynolds number regime in the context of ripples and dunes in rivers have dealt with potential flows ( @xcite ) , for which the velocity field does not present any lag with respect to the bottom .",
    "the shallow - water approximation ( @xcite ) implies that the bedforms spread their influence on the whole depth of the flow .",
    "however , patterns only have a significant influence within a vertical distance on the order of their wavelength .",
    "it is then crucial to compute explicitly the vertical flow structure , taking into account the turbulent fluctuations .    in order to overcome the flaws of the perfect flow",
    ", constant eddy viscosity closures have been tried to improve kennedy s original model ( @xcite ) .",
    "further progress has been made by @xcite , who used a more sophisticated modelling with an additional equation on the turbulent energy and a closure which involves a prandtl mixing length in the expression of the eddy viscosity .",
    "@xcite made use of the same turbulent modelling , but in the case of an infinite water depth .",
    "a mixing length approach was also used by @xcite to improve benjamin s laminar description .    in the meteorological context of atmospheric flows over low hills ,",
    "a deep and fundamental understanding of the physics of turbulent flows over a relief has been developed from the 70 s ( see the review by @xcite ) .",
    "starting with the seminal work of @xcite , further refined by @xcite and @xcite , the gross emerging picture is that the flow can be thought of as composed of two ( or more ) layers , associated with different physical mechanisms and different length scales .",
    "@xcite have been able to compute analytically the basal shear stress for asymptotically large patterns , under an infinite flow depth assumption .",
    "their ideas have been discussed in a rather vast literature .",
    "the predictions of these calculations , and in particular this layered structure of the flow , has been compared with experiments ( see e.g. @xcite ) , or field measurements on large scale hills ( see e.g. the review paper by @xcite ) , with a good degree of success , especially on the upstream side of the bumps . moreover , they have been tested against the results of the numerical integration , in various configurations , of navier - stokes equations closed with different turbulent closures ( @xcite ) .",
    "the relevance of this approach for the description of the flow and the stresses around aeolian sand dunes has also been investigated ( see e.g. @xcite ) , and is amongst the current directions of research in that community ( @xcite ) .    because the prediction of the stable or unstable character of a flat sand bed submitted to a turbulent shear flow is very sensitive to the way both hydrodynamics and transport issues are described and intermixed , we find it useful to discuss at length , in the two parts of this paper , the different mechanisms and scales involved at the different steps of the modelling .",
    "it is indeed particularly revealing that , despite the fact that the approach presented here is very close to those of @xcite and @xcite and has been motivated by these works , we basically disagree with their conclusions , especially that river dunes are initiated by the linear instability of a flat bed .",
    "the detail discussion we provide here gives also the opportunity to revisit the still debated question of the subaqueous ripple size selection ( see @xcite and references therein ) , as well as the important issue of the classification of bedforms ( @xcite ) .",
    "this article is structured as follows . in the next section",
    ", we briefly recall the equations for the base flow over a uniform bottom .",
    "we then study the linear solution in the case of wavelengths much smaller than the flow depth .",
    "importantly , the sensitivity of these linear results with respect to various changes in the modelling is tested in sections [ controlzzero ] and [ robust ] .",
    "section [ nl ] is devoted to the derivation of the first non - linear corrections . in section [ fs ]",
    ", we investigate the effect of the free surface in the case of wavelengths comparable or larger than the flow depth and interpret it in terms of topography induced standing gravity waves .",
    "finally , we provide in section [ qualitativesummary ] a qualitative summary of the main results of the paper .",
    "the most technical considerations are gathered in appendices .",
    "we consider a turbulent flow over a relief . following reynolds decomposition between average and fluctuating ( denoted with a prime ) quantities , the equations governing the mean velocity field @xmath7",
    "can be written as : @xmath8 where @xmath9 is the reynolds stress tensor ( @xcite ) . for the sake of simplicity ,",
    "we omit the density factor @xmath10 in front of the pressure @xmath11 and the stress tensor .",
    "the aim of this paper is to describe quantitatively the average flow over a fixed corrugated boundary within this framework .",
    "the reference state is the homogeneous and steady flow over a flat bottom , submitted to an imposed constant shear stress @xmath12 .",
    "the turbulent regime is characterised by the absence of any intrinsic length and time scales . at a sufficiently large distance @xmath1 from the ground ,",
    "the only length - scale limiting the size of turbulent eddies ",
    "the so - called mixing length @xmath13   is precisely @xmath1 ; the only mixing time - scale is given by the velocity gradient @xmath14 .",
    "as originally shown by @xcite , it results from this dimensional analysis that the only way to construct a diffusive flux is a turbulent closure of the form : @xmath15 where the mixing length is @xmath16 and @xmath17 is",
    "the ( phenomenological ) von krmn constant . after integration",
    ", one obtains that the velocity has a single non zero component along the @xmath18-axis , which increases logarithmically with @xmath1 ( @xcite ) : @xmath19 where @xmath20 is a constant of integration called the hydrodynamical roughness .",
    "this expression does not apply for @xmath21 .",
    "there should be layer of thickness @xmath22 close to the bottom , called the surface layer , matching the logarithmic profile to a null velocity on the ground .",
    "the hydrodynamical roughness @xmath20 should be distinguished from the geometrical ( or physical ) roughness of the ground , usually defined as the root mean square of the height profile variations .",
    "@xmath20 is defined as the height at which the velocity would vanish , when extrapolating the logarithmic profile to small @xmath1 .",
    "the physical mechanism controlling @xmath20 can be of different natures .",
    "if the ground is smooth enough , a viscous sub - layer of typical size @xmath23 must exist , whose matching with the logarithmic profile determines the value of @xmath20 . on the contrary",
    ", if the geometrical roughness is larger than the viscous sub - layer , turbulent mixing dominates at small @xmath1 with a mixing length controlled by the ground topography . in the case of a static granular bed composed of grains of size @xmath24 , reported values of the hydrodynamical roughness are reasonably consistent ( @xmath25 in @xcite , @xmath26 in @xcite and @xmath27 ( @xcite ) . in section  [ nl ]",
    ", we will justify the connection between geometrical and hydrodynamical roughness on a rigourous basis and show that they are not simply proportional .",
    "the situation is of course different in the presence of sediment transport , which may ( or not ) induce some negative feedback on the flow . in this case , the hydrodynamical roughness @xmath20 may directly be controlled by the transport characteristics ( e.g. mass flux and grain trajectories ) .",
    "nature presents many other physical processes controlling the roughness : for instance , the flexible stems of wetland plants in low marshes or , for the wind , the canopy or the waves over the ocean . in all these cases , it can be assumed that the logarithmic law is a good approximation of the velocity profile above the surface layer , with a single known parameter @xmath20 .",
    "we will first consider the asymptotic limit in which the typical relief length ",
    "say , the dune wavelength @xmath6   is much larger than the surface layer thickness @xmath22 .",
    "the relief is locally flat at the scale @xmath22 , so that there must be a region close to the ground where the velocity profile shows a logarithmic vertical profile .",
    "we will then discuss the case of moderate values of the ratio @xmath28 , for which the flow becomes sensitive to the details of the mechanisms controlling the roughness .      in the logarithmic boundary layer",
    ", the normal stresses can be written as : @xmath29 where @xmath30 is a second phenomenological constant estimated in the range @xmath31 .",
    "note that @xmath30 does not have any influence on the results as it describes the isotropic component of the reynolds stress tensor , which can be absorbed into the pressure terms .",
    "normal stress anisotropy is considered in section  [ robust ] and appendix  [ avi ] . introducing the strain rate tensor @xmath32 and its squared modulus @xmath33 , we can write both expressions ( [ tauxzprandtl ] ) and ( [ taullprandtl ] ) in a general tensorial form : @xmath34 in this paper",
    ", we focus on 2d steady situations , i.e. on geometries invariant along the transverse @xmath35-direction , see figure  [ wavyschematic ] .",
    "as they are of permanent use for the rest of the paper , we express the components of the velocity and stress equations in the @xmath18- and @xmath1-directions .",
    "the navier - stokes equations read : @xmath36 the stress expressions are the following : @xmath37 in these expressions , the strain tensor components are given by @xmath38 and the strain modulus by : @xmath39",
    "we now consider the turbulent flow over a wavy bottom constituting the floor of an unbounded boundary layer . in rivers",
    ", this corresponds to the limit of a flow depth @xmath40 much larger than the bed - form wavelength @xmath6 .",
    "the solution is computed as a first order linear correction to the flow over a uniform bottom , using the first order turbulent closure previously introduced .      for small enough amplitudes",
    ", we can consider a bottom profile of the form @xmath41 without loss of generality .",
    "@xmath42 is the wavelength of the bottom and @xmath43 the amplitude of the corrugation , see figure  [ wavyschematic ] .",
    "the case of an arbitrary relief can be deduced by a simple superposition of fourier modes .",
    "we introduce the dimensionless variable @xmath44 , the dimensionless roughness @xmath45 and the function : @xmath46 we also switch to the standard complex number notation : @xmath47 ( real parts of expressions are understood ) .",
    "we wish to perform the linear expansion of equations ( [ nscont])-([strainmod ] ) with respect to the small parameter @xmath48 .",
    "the mixing length is still defined as the geometrical distance to the bottom : @xmath49 .",
    "we introduce the following notations for the two first orders : @xmath50 , \\label{defu}\\\\ u_z & = & u _ * k\\zeta e^{ikx } w , \\label{defw}\\\\ \\tau_{xz } & = & \\tau_{zx}= - u_*^2 \\left[1+k\\zeta e^{ikx } s_t\\right ] , \\label{defst}\\\\ p+\\tau_{zz } & = & p_0+u_*^2 \\left [ \\frac{1}{3}\\chi^2 + k\\zeta e^{ikx } s_n\\right ] , \\label{defsn}\\\\ \\tau_{zz } & = & u_*^2   \\left [ \\frac{1}{3}\\chi^2 + k\\zeta e^{ikx } s_{zz}\\right ] , \\label{defszz}\\\\ \\tau_{xx } & = & u_*^2   \\left [ \\frac{1}{3}\\chi^2 + k\\zeta e^{ikx } s_{xx}\\right ] . \\label{defsxx}\\end{aligned}\\ ] ] the quantities @xmath51 , @xmath52 , etc , are implicitly considered as functions of @xmath53 .",
    "an alternative choice is to consider functions of the coordinate @xmath54 .",
    "such alternative functions are denoted with a tilde to make the distinction .",
    "this important   but somehow technical   issue of the choice of a representation is discussed in appendix  [ rep ] .",
    "although the curvilinear and cartesian systems of coordinates are equivalent , the distinction between the two is of importance when it comes to the expression of the boundary conditions , and for the range of amplitudes @xmath43 for which the linear analysis is no more valid ( see section [ nl ] ) .",
    "in particular , vertical profiles in the forthcoming figures will be mostly plotted as a function of the shifted variable @xmath55 .",
    "the linearised strain rate tensor reads @xmath56 finally the navier - stokes equations lead to @xmath57 taking the difference of equations ( [ relaxsxx ] ) and ( [ relaxszz ] ) , one can compute @xmath58 to obtain four closed equations : @xmath59 introducing the vector @xmath60 , we finally get at the first order in @xmath61 the following compact form of the equation to integrate : @xmath62 the general solution of this equation is the linear superposition of all solutions of the homogeneous system ( i.e. with @xmath63 ) , and a particular solution @xmath64 .",
    "four boundary conditions must be specified to solve the above equation ( [ systlinplaque ] ) .",
    "the upper boundary corresponds to the limit @xmath65 , for which we ask that the vertical fluxes of matter and momentum vanish asymptotically .",
    "this means that the first order corrections to the shear stress and to the vertical velocity must tend to zero : @xmath66 and @xmath67 . in practice , a boundary at finite height @xmath40 ( at @xmath68 ) is introduced , at which we impose a null vertical velocity @xmath69 and a constant tangential stress @xmath70 so that @xmath71 .",
    "this corresponds to a physical situation where the fluid is entrained by a moving upper plate , for instance a stress - controlled couette annular cell .",
    "then , we consider the limit @xmath72 , i.e. when the results become independent of @xmath40 .    the lower boundary condition must be specified on the floor ( @xmath73 ) .",
    "we consider here the limit in which the surface layer thickness @xmath22 is much smaller than the wavelength @xmath6 .",
    "this allows to perform an asymptotic matching between the solution and the surface layer , whatever the dynamical mechanisms responsible for the hydrodynamical roughness @xmath20 are . indeed , focusing on the surface layer , we know that in the limit @xmath74 , the asymptotic behaviour of the local tangential velocity @xmath75 should be a logarithmic profile controlled by the local shear stress @xmath76 and the roughness @xmath77 .",
    "the solution of ( [ systlinplaque ] ) should thus match this asymptotic behaviour as @xmath73 .",
    "thus , @xmath20 is the only parameter inherited from the surface layer in the limit @xmath78 .",
    "we will investigate the situation where this approximation is not valid anymore in section  [ controlzzero ] .    in the limit @xmath79 , the homogeneous solution of ( [ systlinplaque ] )",
    "can be expanded in powers of @xmath53 and @xmath80 and expressed as the sum over four modes . adding the asymptotic behaviour of the particular solution @xmath81 , the full solution writes : @xmath82 the next terms in this expansion are @xmath83 .    .",
    "@xmath54 is the distance to the bottom , rescaled by the wavenumber . in all panels ,",
    "the solid lines represent the real parts of the functions , whereas the dotted lines represent the imaginary ones .",
    "dashed lines show the asymptotic behaviours ( [ uasymp]-[snasymp ] ) used as boundary conditions .",
    "they match the solutions in the inner layer , which extends up to @xmath84 here .",
    "we note @xmath85 and @xmath86 .",
    "close to the boundary , a plateau of constant shear stress can be observed , which corresponds to the logarithmic zone .",
    "it is embedded into a slightly larger zone of constant pressure in which the shear stress varies linearly . ]    the values of the four coefficients @xmath87 , ... , @xmath88 are selected by the matching with the surface layer .",
    "@xmath87 would correspond to a non vanishing normal velocity through the surface layer and should thus be null .",
    "@xmath89 precisely corresponds to the logarithmic profile with a roughness @xmath20 and a basal shear stress modulation @xmath89 .",
    "this gives @xmath90 .",
    "@xmath91 would correspond to a modulation of the local roughness ",
    "more precisely of its logarithm .",
    "we do not consider such a modulation so that @xmath92 .",
    "@xmath88 corresponds to a sub - dominant behaviour associated to the basal pressure modulation ( @xmath93 ) . in summary",
    ", the functions @xmath51 , @xmath52 , @xmath94 and @xmath95 should follow the following asymptotic behaviour : @xmath96 the region of thickness @xmath97 in which this asymptotic behaviour constitutes a good approximation of the flow field is called the inner layer .",
    "equation  ( [ snasymp ] ) means that the total pressure @xmath98 is constant across this boundary layer : @xmath99 and equation  ( [ stasymp ] ) that the shear stress decreases linearly with height according to : @xmath100 the tangential pressure gradient is balanced by the normal shear stress , which means that inertial terms are negligible or equivalently that the fluid is in local equilibrium . in terms of energy ,",
    "the space variation of the internal energy ( pressure ) is dissipated in turbulent `` friction '' .",
    "these two equations correspond to the standard lubrication approximation for quasi - parallel flows .      in practice , we solve the equations using a fourth order runge - kutta scheme with a logarithmic step . the integration is started at an initial value of @xmath53 inside the inner layer i.e. which verifies @xmath101 ) .",
    "we write the solution as a linear superposition of the form @xmath102 , where the different terms verify : @xmath103 the boundary conditions on the bottom are then automatically satisfied , and the top ones give algebraic equations on the real and imaginary parts of @xmath104 and @xmath105 , which can be solved easily .",
    "we have checked that the result is independent of the initial value of @xmath53 , as long as it remains in the announced range .",
    "( aspect ratio @xmath106 ) , computed from the linearised equations ( @xmath107 ) .",
    "the flow direction is from left to right .",
    "note the left - right asymmetry of the streamlines around the bump in the inner layer ( grey lines ) .",
    "note also the onset of emergence of a recirculation bubble in the troughs .",
    "the thick line in the top right corner shows the positions that maximises the velocity along a streamline . ]",
    "the velocity and stress profiles resulting from the integration of equation ( [ systlinplaque ] ) are displayed in figure  [ modesverticaux ] .",
    "looking at panel ( c ) , one can clearly see the region close to the bottom where the shear stress is constant , while the horizontal velocity component ( panel a ) exhibits a logarithmic behaviour .",
    "this plateau almost coincides with the inner layer , which is the zone where the solution is well approximated by the asymptotic behaviour derived above .",
    "the inner layer is embedded in a wider region characterised by a constant pressure ( panel d ) .",
    "the estimate of the thickness @xmath97 is of crucial importance for the transport issue ( see next section and part 2 ) .",
    "@xmath97 is the scale at which inertial terms are of the same order as stress ones in the reynolds averaged navier - stokes equations .",
    "the original estimation of @xmath97 given by @xcite was further discussed in several later papers ( see e.g. @xcite ) .",
    "our data are in good agreement with the scaling proposed by @xcite @xmath108 consistently , this scaling relationship is precisely that of the first neglected terms in the asymptotic expansion ( [ assymptotexpansion ] ) .",
    "away from the bottom , all profiles tend to zero , so that one recovers the undisturbed flow field ( [ uzero ] ) at large @xmath53 .",
    "the shape of these profiles are very consistent with the work of @xcite , who have compared the influence of the closure scheme on the linear flow over a relief , which means that the precise choice of the turbulent closure does not affect significantly the results .    .",
    "( a ) lin - lin plot in the shifted representation .",
    "( b ) lin - log plot in the non - shifted representation .",
    "the solid lines correspond to the real part and the dotted line to the imaginary one .",
    "the velocity disturbance decreases exponentially over one wavelength ( dashed line ) . in this outer region",
    ", the reynolds stress can be neglected . ]    , @xmath109 , @xmath110 and @xmath111 as a function of @xmath112 .",
    "these plots show the dependence of the basal shear and normal stresses with the number of decades separating the wavelength @xmath6 from the soil roughness @xmath20 , for a given bump aspect ratio .",
    "the solid line corresponds to the results of the model , using the asymptotic matching with the surface layer .",
    "the dashed lines represent the analytical formula deduced from @xcite by @xcite .",
    "they agree well at very small @xmath113 . ]    in order to visualise the effect of the bottom corrugation on the flow , the flow streamlines are displayed in figure  [ streamlines ] ( see appendix [ streamlines ] for explanations about their computation ) .",
    "it can be observed that the velocity gradient is larger on the crest than in the troughs as the streamlines are closer to each other .",
    "the flow is disturbed over a vertical distance comparable to the wavelength .",
    "a subtler piece of information concerns the position along each streamline at which the velocity is maximum .",
    "these points are displayed in the right corner of figure  [ streamlines ] .",
    "away from the bottom , they are aligned above the crest of the bump . very close to it , however , they are shifted upstream . in other words ,",
    "the fluid velocity is in phase with the topography in the upper part of the flow , but is phase advanced in the inner boundary layer where the shear stress tends to its basal value . in this inner layer , the profile is well approximated by its asymptotic expression ( [ uasymp ] ) .",
    "an inspection of the velocity profile evidences two distinct regions ( see figures [ modesverticaux ] and [ perfectfluidinner ] ) , in which we recognise those at the basic partitioning of the flow in jackson & hunt work ( 1975 ) , and subsequent papers .",
    "there is an outer region ( @xmath114 ) , where @xmath51 decreases exponentially with @xmath53 ( figure  [ perfectfluidinner](b ) ) .",
    "seeking for asymptotic solutions decreasing as @xmath115 , one has to solve the eigenvalue problem @xmath116 for asymptotically large values of @xmath53 .",
    "at the two leading orders , the decrease rate @xmath117 is given by : @xmath118 the asymptotic behaviour is an oscillatory relaxation corresponding to @xmath119 .",
    "however , the observed decrease corresponds to the intermediate asymptotic regime @xmath120 for which the solution is @xmath121 .",
    "this behaviour is reminiscent from that of an inviscid potential flow . in other words ,",
    "the effect of the turbulent shear stress on the flow disturbance can be neglected .",
    "the intermediate region between the inner and the outer layers is responsible for the asymmetry of the flow as well as the upstream shift of the maximum velocity discussed above .",
    "let us emphasise again that this is the physical key point for the formation of bedforms .",
    "one can understand the reason of the phase shift with the following argument .",
    "the external layer can be described as a perfect irrotational flow .",
    "since the elevation profile is symmetric ,",
    "the streamlines are symmetric too , as the flow is solely controlled by the balance between inertia and the pressure gradient induced by the presence of the bump . as a consequence ,",
    "the velocity is maximum at the vertical of the crest .",
    "now , inside the inner layer , this flow is slowed down by turbulent diffusion of momentum .",
    "focusing on the region of matching between these outer and inner regions , the velocity needs some time to re - adapt to a change of shear stress , due to inertia .",
    "thus , the shear stress is always phase - advanced with respect to the velocity .",
    "one concludes that the basal shear stress is phase - advanced with respect to the bump .    as mentioned in the introduction , we are especially interested in the shear stress and pressure distributions on the bottom .",
    "we note @xmath85 and @xmath86 .",
    "the ratio @xmath122 is the tangent of the phase shift between the shear stress and the topography .",
    "it is positive as the shear stress is phase advanced .",
    "the four coefficients @xmath123 , @xmath109 , @xmath110 and @xmath111 are displayed as a function of @xmath113 in figure  [ abcdlin ] .",
    "their overall dependence with @xmath113 is weak , meaning that the turbulent flow around an obstacle is mostly scale invariant .",
    "more precisely , following jackson & hunt s work ( @xcite ) , it has been shown that , for asymptotically small @xmath113 , one expects logarithmic dependencies : @xmath124 where euler s constant is @xmath125 , @xmath126 is defined by the equation @xmath127 and with @xmath128 .",
    "note that @xmath123 tends to @xmath129 and @xmath109 to @xmath130 as @xmath131 , as expected when the inner layer thickness @xmath97 vanishes . in this limit ,",
    "the basal shear stress is directly proportional to the square of the velocity inherited from the outer layer , which is solution of the potential flow problem .",
    "these expressions agree well with our numerical results for very small @xmath113 .",
    "however , for realistic values of @xmath113 , e.g. @xmath132 , this approximation can not be accurately used as it leads to errors of order one   note that jackson & hunt s expressions tend to diverge at larger @xmath113 . in comparison to @xmath123 and @xmath109",
    ", we observe that the normal stress coefficients @xmath110 and @xmath111 are more robust with respect to the details of the model . in the limit of a perfect flow ,",
    "the pressure varies as the square of the velocity . here",
    ", one needs to consider the velocity at the scale @xmath6 of the perturbation , say @xmath133 , where the logarithmic factor @xmath134 should be evaluated for @xmath53 of order unity . from this argument",
    ", we predict that the pressure coefficient @xmath110 should scale as the square of @xmath135 ( a parabola in figure  [ abcdlin ] ) , which is very accurately verified . more precisely , @xmath136 ^ 2 $ ]",
    "is an almost perfect approximation .",
    "finally , it can be observed that the normal stress is also in phase advance with respect to the bottom profile .",
    "the coefficient @xmath111 is positive and shows a linear variation with @xmath135 .",
    "so far , the computation of the velocity and stress fields has been obtained without any specification of the physics at the scale of @xmath20 , as the integration of equation ( [ systlinplaque ] ) was started in the inner layer rather than on the bottom .",
    "this is of course possible only if this layer is sufficiently thick , i.e. if @xmath97 ( or @xmath6 ) is much larger than the thickness of the surface layer @xmath22 introduced in section  [ unif ] .",
    "we now discuss several ways to describe the flow inside the surface layer , and investigate the subsequent effect on the shape of the stress coefficients as functions of @xmath113 .",
    "these coefficients should be independent of the physics at work in this surface layer when @xmath113 is small enough , but we expect larger differences for larger values of @xmath113 .",
    "we first present a convenient phenomenological model of geometrically induced roughness , which does not involve additional parameters .",
    "because of its simplicity , it will be used in the next sections , as well as in the second part of the paper .",
    "the results will be compared to a rigourous treatment resulting from the weakly non - linear hydrodynamical calculation in section  [ nl ] .",
    "we then consider the case of a viscous surface layer .",
    "inspired from the aeolian transport properties , we finally discuss the focus point assumption as a possible way to describe the situation in which the surface layer is governed by the presence of sediment transport .     and",
    "@xmath109 ( dashed lines ) computed with the phenomenological model of geometrically induced roughness ( [ uzerogeom ] ) . for comparison",
    ", the solid lines display the reference case shown in figure  [ abcdlin ] . ]      for an hydrodynamically rough bottom , the `` small scale '' roughness elements are larger than the viscous sub - layer . they are submitted to a turbulent drag from the fluid and reciprocally , their presence slows down the flow .",
    "the exchanges of momentum in the surface layer are thus dominated by the turbulent fluctuations . following @xcite and others ,",
    "a convenient phenomenological model is to define the mixing length involved in the turbulent closure ( [ tauijprandtl ] ) as @xmath137 . in this way",
    ", @xmath13 is still essentially the geometrical distance to the bottom , except that it can not be smaller than the roughness length .",
    "this choice reflects in a intuitive manner the physical picture one can infer from experiments or simulations where square - shaped roughness elements are glued on a flat wall ( see e.g. @xcite ) .",
    "we will show in section  ( [ nl ] ) that this picture must be refined when dealing with blunt roughness elements of moderate aspect ratio   for instance the surface of a sand bed .    with this expression for the mixing length ,",
    "the integration of starting equations in the uniform and steady case gives @xmath138 where the lower boundary condition @xmath139 can now be taken in @xmath140 .",
    "this expression is well approximated by the pure logarithmic profile ( eq .  [ uzero ] ) as soon as @xmath1 is larger than , say , few @xmath20 .",
    "in other words , for this model , @xmath141 .    the above description of the linear analysis , and in particular the expression of the matrix @xmath142 and the vector @xmath143 involved in ( [ systlinplaque ] ) , in the case of a wavy bottom is still valid , but now with the following expression for the function @xmath144 the solution of ( [ systlinplaque ] ) can again be written as a linear superposition @xmath102 , where these three vectors are solutions of @xmath145 this decomposition ensures the requirement that both components of the velocity vanish on the bottom , leading to @xmath146 and @xmath147 . as in the previous section , the coefficients @xmath104 and @xmath105 are found by the upper boundary conditions .",
    "the coefficients @xmath123 and @xmath109 resulting from this integration are displayed in figure  [ abcdgeom ] .",
    "one can see that , for @xmath148 , they are not very much different from those obtained in the previous section",
    ". however , one can notice significant differences for @xmath149 . as the mixing length in the surface layer is larger in this case ( @xmath150 ) than in the asymptotic case ( @xmath151 ) , the turbulent ` diffusion ' is more efficient .",
    "this results into a larger phase advance for the shear stress ( fig .",
    "[ abcdgeom ]  c ) . for practical purposes and for later use in the second part of this paper , a very good empirical fit of the coefficients @xmath123 and @xmath109",
    "is obtained with @xmath152 with @xmath153 , @xmath154 and @xmath155 .",
    "and @xmath109 computed with a viscous surface layer .",
    "dotted line : @xmath156 ; dashed line : @xmath157 . as in figure",
    "[ abcdgeom ] , the solid lines display the reference case of figure  [ abcdlin ] . ]      in hydraulically smooth situations , it is natural to expect that , very close to the bottom , the flow must be laminar and thus described by the equation @xmath158 whose solution is @xmath159 we thus neglect here the possibility of a phase shift across the viscous surface layer .",
    "the transition from viscous to turbulent regime is governed by the reynolds number and occurs at a typical value @xmath160 .",
    "the surface layer thickness can then be easily computed as @xmath161 . at @xmath162 , both viscous and turbulent expressions for the velocity must coincide : @xmath163 from this equality , we can deduce the hydrodynamical roughness seen from the inner layer , due to this viscous surface layer : @xmath164 in the case of a sand bed , the transition between the hydrodynamically smooth and rough regimes occurs when the viscosity induced roughness ( eq .",
    "[ z0viscous ] ) is of the order of the geometrically induced roughness ( @xmath165 ) .    with the corresponding value for @xmath112",
    ", we solve equation ( [ systlinplaque ] ) in the usual manner , writing the solution in the form of the linear superposition as described above , except that the integration is started at the initial value @xmath166 , in which we impose that the velocity is parallel to the bed and equal to @xmath167 . at linear order ,",
    "this leads to @xmath168 the resulting shear stress coefficients @xmath123 and @xmath109 are displayed in figure  [ abcdhfufviscous ] . as one can expect , in comparison to the reference case , they are smaller for larger values of @xmath169 , and all different curves collapse as @xmath131 .",
    "the viscous diffusion of momentum is less efficient than that induced by turbulent fluctuations .",
    "moreover , in the stokes regime , for reynolds numbers much smaller than @xmath170 , the kinematic reversibility leads to a shear stress in phase with the topography .",
    "consistently , it can be observed in figure  [ abcdhfufviscous](c ) that the phase advance is reduced in the hydrodynamically smooth regime .",
    "we will show in the second part of this article that this explains the fact that the wavelength at which ripples appear is larger as the reynolds number decreases .",
    "experiments in the hydraulically smooth regime have been performed by @xcite , who measured the ionic mobility between two nearby electrodes .",
    "this current is assumed to be related , without any spatial or temporal lag , to the basal shear stress .",
    "the measured phase shift between the signal and the bottom topography could reach values as high as @xmath171 .",
    "this would correspond to @xmath172 .",
    "within the present model , the phase shift remains much lower than the measured @xmath171 .",
    "this unexpected value has been interpreted as the signature of a lag of the laminar - turbulent transition with respect to the reynolds number criterion @xmath173 .",
    "further experiments based on a different measure principle are needed to understand this discrepancy .",
    "this viscous surface layer model is an effective way to take bedload transport into account . as a matter of fact , anticipating on the part 2 of this paper where the dynamical mechanisms governing the sediment transport are discussed , transported particles are not passive and exert a stress on the fluid .",
    "close to the transport threshold , their influence on the flow is negligible .",
    "however , as their density increases , transport induces a negative feedback on the flow , which should be taken into consideration in the hydrodynamics description .",
    "the simplest model of multi - layer sheet flow would be a newtonian fluid whose viscosity increases with the concentration of moving sediments . in this large shear velocity regime , one thus expects a decrease of the phase - lag responsible for the ripples instability and possibly , a restabilisation of the bed .     and @xmath109 computed in the presence of a ` focus point ' at height @xmath22 , where the velocity is @xmath167 , as a function of @xmath113 .",
    "@xmath123 and @xmath109 are larger for larger values of @xmath174 ( @xmath170 , @xmath129 , @xmath175 and @xmath176 ) . however , the ratio @xmath122 is less sensitive to this parameter , up to @xmath177 .",
    "again , the solid lines display the reference case of figure  [ abcdlin ] . ]",
    "an alternative manner to take the feedback of the transport on the flow into account can be achieved in analogy with the aeolian case , which provides the archetype of such a situation . in this case",
    ", it has been shown that the moving grains slow down the flow in the transport layer , whose thickness @xmath22 is independent of the shear velocity @xmath178 .",
    "note that in the subaqueous case , the transport layer thickness is observed to gently increase with the shear stress ( @xcite ) close to the threshold , in the erosion limited regime ( see part 2 ) . above @xmath22 , the effect of the particles on the flow is negligible and",
    "one recovers the undisturbed logarithmic velocity profile , but with a roughness larger than that without transport .",
    "below @xmath22 , the flow velocity is reduced and is independent of @xmath178 ( @xcite ) . as shown experimentally by @xcite",
    ", the velocity vertical profiles measured for different shear velocities thus cross at the ` focus point ' @xmath162 and @xmath179 . at this point",
    "we have @xmath180 which means that the effective roughness in the logarithmic region , due to this transport layer , is @xmath181 to determine the flow field in such a situation , the crucial point is to compare @xmath22 with the thickness of the inner layer @xmath97 , i.e. the size of the constant stress plateau ( see figure  [ modesverticaux ] ) .",
    "if @xmath22 is larger than @xmath97 , it means that one can not reduce the transport issue to a relationship between the sediment flux and the basal shear stress only . in that case , the whole vertical velocity profile , which depends on the entire bottom elevation , is involved .",
    "conversely , for @xmath182 , one can account for transport by modifying the bottom boundary conditions as follows .",
    "following what we have done in the previous sub - section , we can impose that the fluid velocity at @xmath183 is parallel to the bed and equal to @xmath167 . at the linear order",
    ", we then get : @xmath184 the result of this choice is shown for the stress coefficients in figure  [ abcdhfuf ] for various values of @xmath174 . @xmath123 and @xmath109 are larger for increasing focus velocities , or equivalently larger focus altitude . as in the viscous surface layer case , all curves collapse for @xmath131 because @xmath97 gets larger in this limit ( see equation ( [ ellscaling ] ) ) .",
    "interestingly , as far as bedforms are concerned ( see part 2 ) , the ratio @xmath122 is much less sensitive to variations of @xmath174 , at least in the region @xmath185 .",
    "finally , it should be noted that the focus point model only applies to the momentum limited transport regime ( see part 2 ) .",
    "close to the transport threshold , in the erosion limited regime , the feedback of the particle transport on the flow is negligible and the transport should not to be taken into account in the hydrodynamical calculation .",
    "this approach should be distinguished from that used by @xcite . in those articles ,",
    "the flow boundary conditions are taken on the bottom , below the transport layer ( vanishing velocities ) , meaning that the feedback of the transport on hydrodynamics is neglected .",
    "however , the stresses are evaluated in @xmath22 , above the transport layer .",
    "this does not constitute a self - consistent choice .",
    "moreover , this introduces a free parameter in the model which can be tuned to choose the phase shift at will .",
    "we will present in the second part experimental evidences that this choice is not correct .",
    ", which is a non dimensional parameter encoding the time lag between a change in the strain rate and that of the reynolds stress .",
    "( a - c ) vertical profiles of the horizontal component of the velocity @xmath186 for @xmath107 for ( a ) @xmath187 , ( b ) @xmath188 and ( c ) @xmath189 respectively .",
    "one can see that the profiles develop oscillations as @xmath190 increases , but that the behaviour close to the bottom ( in log scale ) remains the same . in panels ( d ) and ( e ) , we plot the coefficients @xmath123 , @xmath109 , @xmath110 and @xmath111 _ vs _ @xmath190 ( still for @xmath107 ) .",
    "they are weakly affected , meaning again that the behaviour close to the bottom is almost unchanged . ]      for these three dynamical mechanisms controlling the hydrodynamical roughness @xmath20 , we have seen that the asymptotic regime is recovered when the surface layer thickness @xmath22 is smaller than the inner layer thickness @xmath97 . as @xmath97 is much smaller than the wavelength @xmath6 ( for standard bedforms , @xmath191 ) , this constitutes a rather restrictive condition .",
    "whenever @xmath22 is larger than @xmath97 , specific hydrodynamic models should be derived to determine the relations between stresses and topography .    the phase shift between the basal shear stress and the topography originates from the interplay between inertia and shear stress .",
    "the different models of surface layer correspond to different ways of mixing momentum in the direction normal to the wall .",
    "although the argument is general , one sees that the precise value of the phase shift is rather sensitive to the physical origin of the momentum fluxes .",
    "in particular , viscous diffusion leads to a much smaller phase advance than turbulent mixing .",
    "in the same spirit as the previous section , where we have investigated the effect of different ways to treat the surface layer on the stress coefficients @xmath123 and @xmath109 , we would like now to show the robustness of the results when considering a second order turbulent closure , reynolds stress anisotropy or a moving bottom .      as already stated , to solve quantitatively the ` dune problem ' , we need to take correctly into account the effects inducing a phase shift between the stresses and the relief . as a matter of fact , a first order closure assumes that the turbulent energy adapts instantaneously to the mean strain tensor . to take into account the lag between the stress and the strain tensors",
    ", one needs to formulate a second order turbulent closure .",
    "this can be achieved by deriving dynamical equations for @xmath192 , which relax the stresses towards their steady state expression prescribed by equation  ( [ tauijprandtl ] ) ( see appendix  [ 2ndorder ] ) .",
    "@xmath193 . \\label{2ndme}\\ ] ] in this relation , the parameter @xmath190 encodes the time lag between an increase of the mean shear strain rate and the corresponding re - adjusment of the fluctuations of the shear stress .",
    "we expect @xmath190 to be on the order of unity .    in figure  [ betaeffect ]",
    ", we show the effect of this new parameter .",
    "as expected for inertial effects in a relaxation process , finite values of @xmath190 generate oscillations in the vertical profiles of the velocities and stresses .",
    "the example of the horizontal velocity is displayed in the panels ( a ) , ( b ) and ( c ) .",
    "the amplitude and the frequency of these oscillations increase with @xmath190 .",
    "interestingly , these oscillations do not affect much the behaviour of the modes close to the bottom . as a consequence , the coefficients @xmath123 , @xmath109 , @xmath110 and @xmath111",
    "are weakly affected by @xmath190 , see panels ( d ) and ( e ) .",
    "interestingly , both @xmath123 and @xmath109 decrease as @xmath190 increases and their ratio remains roughly constant .",
    "@xmath190 has thus a negligible effect on the emergence of bedform , and we shall keep it to zero in the rest of the paper , as well as in part 2 .    , @xmath109 , @xmath110 and @xmath111 as a function of @xmath113 for different values of @xmath194 ( @xmath195 , @xmath170 , @xmath175 and @xmath176 ) .",
    "the dashed lines correspond to the isotropic case .",
    "inset ( e ) : ratio @xmath122 .",
    "arrows indicate increasing normal stress anisotropy . ]",
    "it is an experimental fact that , in a turbulent boundary layer close to a rough wall , the reynolds stress tensor is _ not _ isotropic : @xmath196 is significantly larger than the other components ( @xcite ) .",
    "besides , anisotropy seems less pronounced for a larger bottom roughness ( @xcite ) , an issue which is however still matter of debate ( @xcite ) .    to account for this reynolds stress anisotropy",
    ", it is easy to generalise the prandtl - like first order turbulent closure ( [ tauijprandtl ] ) with the following expression : @xmath197 where the value of @xmath198 now differs from that of @xmath199 . following the above - cited literature",
    ", we expect @xmath200 to be around @xmath201@xmath202 .",
    "the modification of the matrix @xmath142 due to this new closure is detailed in appendix  [ avi ] .",
    "it is shown that the relevant anisotropic parameter entering the equations is @xmath194 , for which a realistic value is on the order of unity . as evidenced in figure  [ abcdanis ] , the corresponding values of the functions @xmath123 , @xmath109 , @xmath110 and @xmath111",
    "are not much affected by this anisotropy in the relevant range of @xmath113 .",
    "this is particularly true for the coefficients @xmath110 and @xmath111 , as well as for the ratio @xmath122 as soon as @xmath203 .",
    "the normal stress anisotropy has thus a negligible influence on ripple and dune formation , and we will not take it into account in the rest of the paper , as well as in part 2 .     and @xmath109 as a function of @xmath113 for different values of the bottom growth rate @xmath117 ( panels ( a ) and ( b ) ) , and different values of the bottom pulsation @xmath204 ( panels ( c ) and ( d ) ) .",
    "arrows indicate increasing values of @xmath117 and @xmath204 . in panels ( a ) and ( b )",
    ", grey dotted lines correspond to @xmath205 , @xmath175 , @xmath129 , @xmath170 and @xmath206 , the black dotted line being for @xmath207 .",
    "the black dashed line corresponds to @xmath208 , the grey dashed lines being for @xmath209 , @xmath210 , @xmath211 , @xmath212 and @xmath213 . in panels ( c ) and",
    "( d ) grey dotted lines correspond to @xmath214 and @xmath170 , the black dotted line being for @xmath215 .",
    "the black dashed line correspond to @xmath216 , the grey dashed line being for @xmath217 and @xmath211 . for comparison , in all panels the solid lines correspond to the static case @xmath218 , @xmath219 . ]      in order to investigate the effect of a moving bottom on the stress coefficients , we consider a bottom profile of wavevector @xmath220 like in ( [ bottomprofile ] ) , but which is now function of both position @xmath18 and time @xmath221 : @xmath222 in this expression , @xmath117 represents the growth rate of the profile , and @xmath223 its phase velocity . as discussed in @xcite ,",
    "this investigation is important as we wish to use the present hydrodynamical study in the context of the formation and development of bedforms , which do have a ( small ) growth rate and a ( small ) velocity .",
    "following expression ( [ movingbottom ] ) , we modify those for the functions @xmath51 , @xmath52 , @xmath94 and @xmath95 by inserting the extra - factor @xmath224 , along the lines of ( [ defu]-[defsn ] ) .    in this new case , the linearised equations ( [ nsxlin ] ) and ( [ nszlin ] ) of section  [ unboundedcase ]",
    "must then be modified in the following manner : @xmath225 the linear equation ( [ systlinplaque ] ) is then the same , but now with the modified matrix @xmath226 with the surface layer model described in section  [ geom ] , the non - slip boundary conditions on the bottom can be written as @xmath227 the result of the integration of this new system is shown in figure  [ abcdsigmaomega ] for the shear coefficients @xmath123 and @xmath109 .",
    "one can see that departure from the static case @xmath218 and @xmath219 is noticeable only for values of @xmath228 and @xmath229 of order one .",
    "the effect of the wave propagation of the bedform can be understood by a simple argument . when the bedforms propagate upstream ( @xmath230 ) the relative flow velocity seen by the structure is larger so that it induces a larger shear stress modulation .",
    "as @xmath231 is by definition the basal shear stress rescaled by @xmath232 , both @xmath123 and @xmath109 get larger .",
    "reciprocally , when the bedforms propagate downstream ( @xmath233 ) , these coefficients are reduced . consistently with this argument , the ratio @xmath122 is only weakly affected by @xmath204 ( not shown ) .",
    "the growth rate @xmath117 affects @xmath123 and @xmath109 in opposite ways and thus changes the phase shift between the shear stress and the topography . for @xmath234 , @xmath123",
    "is increased while @xmath109 is reduced .",
    "we have not been able to interpret this behaviour in a simple way .    as discussed in part 2 , for ripples in water",
    "flows these dimensionless numbers are respectively on the order of @xmath235 and @xmath236",
    ". they would be even smaller for bedforms of larger wavelength . as a consequence ,",
    "the assumption that the bottom can be treated as fixed for the study of bedforms is definitively valid ( see also the discussion of figure  [ deltasigmaomega ] below ) .",
    "in this section , we investigate the non - linear effects at finite values of the rescaled bottom corrugation amplitude @xmath61 .",
    "in particular , we wish to address two issues : we wish to relate the hydrodynamic roughness to geometrical quantities ; we aim also to describe the first non - linear corrections to the basal stress coefficients @xmath123 , @xmath109 , @xmath110 and @xmath111 .",
    "these results will be used in the second part of this work , to determine the equilibrium height of ripples . in this context , few authors have studied the influence the non - linear terms from hydrodynamics on the shape ( @xcite ) or the stability ( @xcite ) of the bedforms .",
    "in contrast to the present paper , however , both of these works describe the turbulent closure with a constant eddy viscosity . in a very empirical manner , @xcite computed the flow over two - dimensional bedforms of arbitrary amplitude by the use of a wake function , as described in @xcite , coupled with a potential flow modified to take into account the velocity logarithmic law . finally , the linear results of @xcite have also recently been extended to the weakly non - linear situation ( @xcite ) .      for this purpose ,",
    "we perform an expansion with respect to the bottom corrugation amplitude , and introduce non - dimensional the following functions for the different orders : @xmath237 , \\\\ u_z & = & u _ * \\left[(k\\zeta ) e^{ikx }",
    "w_1+(k\\zeta)^2 w_{0}+(k\\zeta)^2   e^{2ikx } w_{2}+(k\\zeta)^3 e^{ikx } w_{3}\\right ] , \\\\ \\tau_{xz } & = &   - u_*^2 \\left[1+(k\\zeta ) e^{ikx } s_{t1}+(k\\zeta)^2 s_{t0}+(k\\zeta)^2   e^{2ikx } s_{t2}+(k\\zeta)^3 e^{ikx } s_{t3}\\right ] , \\\\ p+\\tau_{zz } & = & p_0+u_*^2 \\left[(k\\zeta ) e^{ikx } s_{n1}+(k\\zeta)^2 s_{n0}+(k\\zeta)^2   e^{2ikx } s_{n2}+(k\\zeta)^3 e^{ikx } s_{n3}\\right],\\\\ \\tau_{zz}- \\tau_{xx } & = & u_*^2   \\left[(k\\zeta ) e^{ikx } s_{d1}+(k\\zeta)^2 s_{d0}+(k\\zeta)^2   e^{2ikx } s_{d2}+(k\\zeta)^3 e^{ikx } s_{d3}\\right].\\end{aligned}\\ ] ] terms in @xmath238 , which do not contribute to the harmonic response ( i.e. to the stress coefficients ) , as well as terms of higher order than @xmath239 are neglected .",
    "although the principle of the expansion in amplitude is simple , the actual calculations are painful , and the technical details have been gathered in appendix  [ wnlc ] . in summary",
    ", the non - linear effects result from the expansion of the mixing length ( terms in @xmath240 ) and from the self - interaction of the linear perturbations : in particular , the combination of terms @xmath241 generates second order terms in @xmath240 .",
    "all involved functions are complex , except @xmath134 and those related to the second order homogeneous corrections ( index @xmath130 ) . to avoid the determination of the asymptotic behaviours in this case , we have chosen to treat the surface layer by the simple phenomenological model of section  [ controlzzero ] . plugging the above expressions into the navier - stokes and turbulent closure equations , one eventually obtains a linear hierarchy of linear differential equations : @xmath242 where @xmath243 .",
    "of course , @xmath244 and @xmath245 are the matrix and vector of expression ( [ systlinplaque ] ) .",
    "we find that @xmath246 , whereas @xmath247 is slightly different and @xmath248 is very simple : @xmath249 @xmath250 all the heaviness of the method is encoded in the expressions of the right hand terms @xmath251 : the components of such vectors at a given order depend on the lower order functions @xmath252 and their derivatives .",
    "the integration has thus to follow the hierarchy of the equations , one order after the other .",
    "( a ) and @xmath253 ( b ) .",
    "these curves have been computed with @xmath254 .",
    "@xmath255 tends towards a negative constant value @xmath256 at large @xmath55 , which corresponds to an increased roughness at large distance from the wall .",
    "notice also that , close to the bottom , @xmath253 has a constant value , reminiscent of the inner layer . ]      the boundary conditions must be specified in order to perform the integration . following the geometrically induced roughness model ( section  [ controlzzero ] )",
    ", we require that both components of the velocity should vanish on the bottom .",
    "these conditions express easily in the shifted representation , i.e. written in terms of the curvilinear coordinates ( see appendix  [ rep ] ) : they simply read @xmath257 and @xmath258 . in terms of the cartesian functions , we get : @xmath259 , \\\\",
    "u_2(0 ) & = & -\\frac{1}{4 } \\mu''(0 ) - \\frac{1}{2 } \\kappa \\mu'^2(0 ) - \\frac{1}{4 } \\mu'(0 ) s_{t1}(0 ) , \\\\ u_3(0 ) & = & -\\frac{1}{8 } \\mu'''(0 ) + \\frac{9}{8 } \\mu'(0 ) - \\frac{3}{4 } \\kappa^2 \\mu'^3(0 ) -\\frac{1}{16 } \\left [ \\mu''(0 ) + 2 \\kappa \\mu'^2(0 ) \\right ] \\left [ 2s_{t1}(0)+s_{t1}^*(0 ) \\right ] \\nonumber \\\\ & & + \\frac{1}{32 } \\mu'(0 ) s_{t1}(0 ) \\left [ s_{t1}(0)+2s_{t1}^*(0 ) \\right ] - \\frac{i}{16 } \\mu'(0 ) \\left [ 2s_{n1}(0)+s_{n1}^*(0 ) \\right ] \\nonumber \\\\ & & - \\frac{1}{4 } \\mu'(0 ) \\left [ 2s_{t0}(0)+s_{t2}(0 ) \\right ] , \\end{aligned}\\ ] ] and @xmath260.\\end{aligned}\\ ] ]     for @xmath261 , @xmath262 and @xmath263 .",
    "the extrapolation to @xmath130 of the upper part of the curves gives the value of the hydrodynamical roughness seen at a distance from the bottom .",
    "( b ) coefficient @xmath264 as a function of @xmath113 .",
    "a good fit of this function is given by @xmath265 . ]    as in previous sections , for each order , the solution is expressed as a linear superposition of the form : @xmath266 , where the different vectors are solutions of the following equations : @xmath267 again , for the top boundary conditions , we introduce a lid at finite height @xmath40 , impose @xmath268 and @xmath269 , and look at the limit @xmath72 , i.e. when the results become independent of @xmath40 .",
    "these conditions lead to two equations on @xmath270 and @xmath271 , whose solutions give @xmath272 and @xmath273 respectively .",
    "( a ) and @xmath274 ( b ) .",
    "the solid lines represent the real parts of the functions , whereas the dashed lines represent the imaginary ones .",
    "these curves have been computed with @xmath254 .",
    "notice again the inner layer where the stresses are constant .",
    "we write @xmath275 and @xmath276 .",
    "note that both @xmath277 and @xmath278 are negative . ]",
    "we first consider the corrections to the homogeneous base solution ( index @xmath130 ) .",
    "the corresponding velocity profile @xmath279 and shear stress profile @xmath253 are displayed in figure  [ modenlzero ] .",
    "the term in @xmath240 of the velocity decreases continuously from @xmath280 to @xmath281 and tends towards a negative constant @xmath256 far from the bottom",
    ". correspondingly , the shear stress decreases and tends to @xmath130 far from the ground , as requested .",
    "the calculation thus predicts an increase of the turbulent drag ( i.e. of the basal shear stress ) with the corrugation amplitude , due to the non - linearities . in terms of the velocity profile",
    ", this translates into a hydrodynamic roughness @xmath282 of geometrical origin . identifying the expression of the velocity profile far from the bottom with @xmath283",
    ", we simply get : @xmath284 as a consequence , @xmath282 increases with @xmath264 and with the aspect ratio @xmath48 . for the seek of illustration ,",
    "several vertical profiles of the homogeneous part of the velocity @xmath285 are plotted in figure  [ rugose](a ) for different values of @xmath48 . by definition , @xmath282 is the extrapolation of the asymptotic part of the curves to vanishing velocities .",
    "interestingly , the large scale roughness @xmath282 can not be related to a single geometrical length , namely to the corrugation amplitude @xmath43 ( @xcite ) .",
    "in particular ,",
    "we predict that the macroscopic roughness @xmath282 associated to a wavy surface still depends on the microscopic roughness @xmath20 : as shown in figure  [ rugose](b ) , for a given aspect ratio , the apparent roughness @xmath282 is larger for smaller @xmath113 . furthermore , expression ( [ defzg ] ) is consistent with numerical observations of @xcite and computations of @xcite , who respectively report linear ( in the range @xmath286 ) and quadratic variations for the coefficient @xmath264 as a function of @xmath287 . here ,",
    "the best fit of this function gives @xmath288 .",
    ", @xmath278 , @xmath289 and @xmath290 as a function @xmath113 .",
    "comparing the signs with those of @xmath291 , @xmath292 , @xmath293 and @xmath294 , it can be inferred that the non - linearities oppose the linear effects . in particular , as the amplitude increases , the point of maximum shear stress drifts downstream , i.e. @xmath295 decreases . ]",
    "the first non - linear corrections to the harmonic terms scale on @xmath239 . in figure",
    "[ modenlthree ] , we show the corresponding profiles for the stresses . as in the first order case , there exists a layer close to the bottom where the stresses are almost constant ( inner layer ) . as requested , both components vanish far from the ground .",
    "we note @xmath275 and @xmath276 the shear and normal stresses acting on the boundary .",
    "these coefficients are plotted as a function of @xmath113 in figure  [ abcdthree ] .",
    "both @xmath277 and @xmath278 are negative while @xmath291 and @xmath292 are positive , which means that the first non - linearities oppose the linear effects .",
    "we will show in part 2 that this is responsible for the selection of the height of current ripples .",
    "the calculation of the non - linear corrections allows to determine the range of amplitude @xmath43 for which the linear approximation is valid .",
    "the representation of the linear solution with the fixed system of coordinates ( @xmath296 ) is valid only when @xmath43 is much smaller than @xmath20 .",
    "however , the representation of the same linear solution in the curvilinear coordinates ( @xmath297 ) is valid up to @xmath43 of the order of the inner layer thickness @xmath97 .",
    "it is important to recall that all the descriptions of the flow equivalent at the linear order ( including the real solution of the fully non - linear problem ) can have very different domains of validity .",
    "this weakly non - linear computation is illustrated in figure  [ streamlinesnonlinear ] , which shows the streamlines for different aspect ratios .",
    "it can be seen that the separation of streamlines and the subsequent formation a recirculation bubble occurs above an aspect ratio of @xmath298 , in agreement with observations . by comparison ,",
    "the linear calculation , shown in figure  [ streamlines ] , leads to the emergence of a recirculation bubble for an aspect ratio of @xmath299 i.e. twice larger .",
    "the non - linear corrections are thus essentials to capture quantitatively the flow features .",
    "panel  [ streamlinesnonlinear]c ) , computed for an aspect ratio of @xmath300 shows a well - developed recirculation bubble .",
    "the distortion of the separation streamline is not realistic , indicating the upper limit of validity of the model .",
    "fortunately , the aspect ratio of ripples and dunes is typically smaller than @xmath0 , which falls into the domain of validity of the calculation .",
    "several experiments in flumes or wind tunnels have been performed to measure velocity and reynolds stress profiles over two - dimensional fixed symmetric or asymmetric bedforms ( @xcite ) .",
    "closer to our calculations , several experiments with a sinusoidal bottom are also reported in the literature ( e.g. @xcite )",
    ". direct or large eddy numerical simulations of navier - stokes equations have also been performed in this geometry ( e.g. @xcite ) . for comparison with our model , data from @xcite",
    "have been chosen .",
    "they have been performed in a wind tunnel over sixteen waves with a wavelength @xmath301  mm and a trough - to - crest amplitude @xmath302  mm , covered with a carpet to make them aerodynamically rough .",
    "this corresponds to an aspect ratio of @xmath299 much too large to be in the domain where the model is quantitative .",
    "unfortunately , we have not found any better data - set for the seek of comparison .",
    "the vertical profiles of the velocity measured at different locations are shown in figure  [ nonlinearexperiment](a ) .",
    "more precisely , these authors have measured the average of the instantaneous velocity modulus i.e. a quantity that is always positive and that mixes the average velocity and the fluctuations .",
    "although a recirculation bubble is present , these data can not show it .",
    "we compare these profiles to those computed at the upper limit of validity of the non - linear calculation ( @xmath263 ) . yet ,",
    "the agreement with our computation is fair ; in particular , the way the flow is accelerated over crests and decelerated in troughs in qualitatively well reproduced .",
    "the profiles at @xmath303 and @xmath304 from the crest are close to each other , indicating a re - symmetrisation of the flow by non - linearities .",
    "note that the slight difference between these profiles is qualitatively reproduced by the model .",
    "looking at the upper part of the experimental profiles , one sees that they would extrapolate to @xmath130 around @xmath305 mm while the ground roughness is slightly smaller than @xmath170  mm .",
    "these two roughness are particularly visible on the profile measured on the crest .",
    "the model is particularly successful in reproducing this feature .",
    "the non - linear effects on the flow over obstacles are often described in terms of boundary layer separation .",
    "it has been proposed by @xcite ( see also @xcite ) that one could still use the linear flow calculation in that case , introducing a fictive surface enveloping the obstacle and the recirculation bubble downstream of it .",
    "as such an envelope creates a fictive bump maximum displaced downstream , it artificially moves the point of maximum shear stress on the bump in the same direction ( @xcite ) .",
    "although this trick is of practical use to simulate dunes , this envelope technique is not based on any firm theoretical ground .",
    "the weakly non - linear calculation performed here is thus of extreme interest to incorporate non - linear turbulent effects in dune numerical models in a more controlled way .",
    "more generally , it can be used in any problem in which a good approximation of the mean flow is needed at low calculation cost , including separation .",
    "for instance , it may find direct applications in the control of turbulence around vehicles .",
    "an important limit of such reynolds averaged calculation is that they do not take vortex shedding into account .    ,",
    "@xmath306 and @xmath307 from top to bottom .",
    "the fluid flows from left to right .",
    "note the progressive development of a recirculation bubble for larger acpect ratios . ]",
    "in this section , we investigate the effect of the additional presence of a free surface at a finite distance @xmath40 to the bottom .",
    "this situation is relevant to the flow above river dunes ( see part 2 ) .",
    "we follow the outline of the section  [ unboundedcase ] , but staying for easiness with linear calculations in two - dimensional situations .      in the case of a river inclined at an angle @xmath308 on the horizontal ,",
    "the shear stress must balance gravity .",
    "it thus varies linearly as @xmath309 and vanishes at the free surface . by definition of the shear velocity @xmath178",
    ", we also write @xmath310 . in the context of a mixing length approach to describe turbulence ,",
    "this length should vanish at the free surface .",
    "for the sake of simplicity , following the discussion of section  [ controlzzero ] , we take @xmath311 .",
    "this choice results in a base flow that is logarithmic as in the unbounded situation : @xmath312 which is consistent with field and experimental observations .",
    "the stress balance equation along the @xmath1-axis allows to get the pressure , which reads : @xmath313 we define the froude number as the ratio of the surface velocity @xmath314 to the velocity of gravity surface waves in the shallow water approximation : @xmath315 in the literature , the froude number is sometime defined as the ratio of the mean velocity to the velocity of gravity waves .",
    "we will justify this choice in the next paragraph .",
    "the froude number of natural sandy rivers lies in general between @xmath195 and @xmath306 as they flow on very small slopes .",
    "larger froude numbers are reached in flume experiments .",
    "( @xmath316 ) .",
    "@xmath317 is the free stream reference velocity .",
    "the symbols correspond different longitudinal locations , as shown in the schematics below the data ( crests @xmath318 , troughs @xmath319 and half ways up- @xmath320 and down - stream @xmath321 ) .",
    "( b ) velocity profile predicted by the present model with a sinusoidal bottom of aspect ratio @xmath0 ( @xmath322 ) , plotted with the same symbol code . dotted line : base velocity profile . ]      in the same manner as in section  [ unboundedcase ] , we consider now a wavy bottom @xmath323 .",
    "we note again @xmath324 and @xmath68 .",
    "we write the first order corrections to the base flow as @xmath325 , \\label{defufs } \\\\",
    "u_z & = & u _ * k\\zeta e^{ikx } w , \\label{defwfs } \\\\",
    "\\tau_{xz } & = & \\tau_{zx}= - u_*^2 \\left[1 - \\frac{\\eta}{\\eta_h } + k\\zeta e^{ikx } s_t \\right ] , \\label{defstfs } \\\\ p+\\tau_{zz } & = & p_0+u_*^2 \\left[\\frac{1}{\\tan\\theta } \\left(1-\\frac{\\eta}{\\eta_h}\\right)+k\\zeta e^{ikx } s_n \\right ] , \\label{defsnfs}\\end{aligned}\\ ] ] where , in accordance with equation ( [ uxfreesurface ] ) , the function @xmath134 is defined by the relation ( [ mu2etageom ] ) .",
    "the free surface is also disturbed by the presence of the non - uniform bottom , and we denote @xmath326 the flow depth at the position @xmath18 .",
    "the modified expression for the mixing length then reads @xmath327 linearising the free surface profile as @xmath328 , one can expand @xmath13 to the first order as @xmath329 \\right \\}.\\ ] ] the shear stress closure as well as the reynolds averaged navier - stokes equations can be linearised in the same way as before , and we finally get at the first order in @xmath61 a system of differential equations which can be written under the following form : @xmath330 with @xmath331      again , making use of the linearity of the equations , we seek the solution under the form @xmath332 , where the vector @xmath333 is solution of equation : @xmath334 while @xmath335 , @xmath336 and @xmath337 are still solutions of equations   ( [ equaxsgeom])-([equaxngeom ] ) .",
    "the bottom boundary conditions @xmath338 and @xmath339 are then automatically satisfied . at the free surface , we impose the material nature of the surface , @xmath340 , and vanishing stresses : @xmath341 and @xmath342 .",
    "these last three conditions select the coefficients @xmath343 and @xmath344 as well as the value of @xmath345 .",
    "finally note that the analytical approximation of the solution close to the bottom in the limit @xmath131 is the same as in the unbounded case  it does not depend on the position of the upper boundary  and expressions ( [ uasymp])-([snasymp ] ) are thus still correct in the limit @xmath346 .     and",
    "@xmath109 as functions of @xmath113 for @xmath347 and @xmath348 ( solid line ) or @xmath349 ( dotted line ) . in the right part of the plots , the curves collapse on the shape displayed in panels ( a ) and ( b ) of figure  [ abcdgeom ] .",
    "they differ at smaller @xmath113 , showing a resonance peak and a divergence at @xmath131 . ]     ( a)-(b ) , and @xmath350 ( c ) , with @xmath351 .",
    "the velocity profiles ( bold lines ) are compared to their asymptotic behaviour in the inner and outer layers ( thin lines ) .",
    "the solid lines represent the real part of the functions , and the dotted lines the imaginary ones .",
    "( a ) and ( b ) show the very same profile , but with a logarithmic scale in ( a ) to emphasize the inner region .",
    "the thin lines in ( a ) and ( c ) represent the asymptotic behaviour in the inner layer . those in ( b )",
    "correspond to a sum of an increasing and a decreasing exponential of the form @xmath352 , as for an inviscid potential flow . ]      in order to evidence the role of the free surface , we have plotted the stress coefficients @xmath123 and @xmath109 as functions of @xmath113 in figure  [ stretchlimo ] , for different values of @xmath353 . for a large enough wave - number @xmath220 ( a small enough wavelength @xmath6 ) , one recovers the plots of the panels ( a ) and ( b ) of figure  [ abcdgeom ] , independently of @xmath353 .",
    "this means that for a bottom wavelength much smaller than the flow depth @xmath40 ( i.e. for subaqueous ripples ) , the free surface has a marginal effect and the results of section  [ unboundedcase ] apply . for smaller @xmath113 , however , the curves exhibit a peak , whose position depends on the value of @xmath353 , followed by a diverging behaviour when @xmath131 . as discussed below",
    ", this peak can be ascribed to a resonance of standing waves at the free surface , excited by the bottom topography , meaning that the proper scale is now @xmath40 and not @xmath20 . as the ratio @xmath354 is the key parameter separating ripples from dunes , we shall turn extensively in part 2 to this point .",
    "the analysis of velocity profiles for different values of @xmath355 gives the following physical picture .",
    "for @xmath356 , as for the unbounded case the flow can be thought of as being divided into two regions : an inner layer close to the bottom where it can be described by the equilibrium approximation and an outer layer behaving like an inviscid potential flow , where the profiles can be decomposed into the sum of decreasing and increasing exponentials @xmath357 . for smaller values of @xmath355",
    ", this outer region progressively vanishes and the whole flow is controlled by the inner layer .    ) .",
    "the flow is from left to right .",
    "note the squeezing of the lines _",
    "downstream _ the crest of the bump .",
    "amplitude @xmath358 ( b ) and phase @xmath359 ( c ) of the free surface as a function of @xmath355 for @xmath360 .",
    "the peak in amplitude and the phase shift from @xmath130 to @xmath361 correspond to the resonance .",
    "the two schematics illustrate the situations in phase or in antiphase . ]     as a function of @xmath355 for @xmath362 ( dotted dashed line ) , @xmath363 ( dashed line ) , @xmath364 ( thin solid line ) , @xmath365 ( long dashed line ) , @xmath360 ( dotted line ) and @xmath366 ( solid line ) , and @xmath367 . crossing the resonance , the phase shifts from @xmath130 to @xmath361 .",
    "( c ) and ( d ) , same for the friction force analytical model . ]",
    "we display the phase and amplitude of the free surface as a function of @xmath355 in figure  [ resonancefs](b - c ) .",
    "the peak in amplitude accompanied by the phase shift of @xmath361 are the signature of a surface wave resonance .",
    "the source of disturbances is of course the corrugation of the bed . for @xmath355 larger than its resonant value ,",
    "the bottom and the free surface are in phase ; conversely , for @xmath355 below the resonance , they are in antiphase . in between , at the resonance",
    ", the phase shift is @xmath368 ( figure  [ resonancefs](a ) ) so that the streamlines are squeezed downstream to the crest .",
    "this resonance is model - independent as it comes from a very robust physical mechanism .",
    "as the fluid flows over the periodic bottom , gravity surface waves are excited at the wavelength @xmath6 .",
    "the latter propagate at the velocity : @xmath369 with respect to the bottom ( see the friction force model derived in appendix  [ ffc ] ) . as in the sound barrier phenomenon ,",
    "the wave energy induced by the bottom disturbances accumulate when this velocity vanishes i.e. for : @xmath370 in the shallow water approximation ( @xmath371 ) , this resonant condition gives @xmath366 as standardly obtained in hydraulics . in the deep water approximation , it gives @xmath372 or equivalently @xmath373 ( @xcite ) .",
    "so , for a bottom of wavelength @xmath6 , the flow is subcritical at low @xmath374 and low @xmath355 and supercritical at large @xmath374 and @xmath355 .",
    "ignoring dissipation , the bernoulli relation states that the sum of the gravitational potential energy @xmath375 and the kinetic energy @xmath376 is constant along the free surface .",
    "the subcritical regime corresponds to deep slow flows dominated by gravity : as the velocity increases over a bump , the corresponding increase of kinetic energy must be balanced by a loss of gravitational potential energy . as a consequence ,",
    "the free surface is pinched over the bump ( @xmath377 , see figure  [ resonancefs]c ) .",
    "the supercritical regime corresponds to thin rapid flows dominated by kinetic energy . by conservation of the flow rate",
    ", a pinch of the free surface would lead to an increased velocity . as the bump pushes up the free surface , the corresponding gain of potential energy",
    "should be balanced by a decrease of kinetic energy which is achieved by a deformation of the free surface in phase with the bump ( @xmath378 , see figure  [ resonancefs]c ) . in summary",
    ", the free surface responds in phase with the excitation at small wavelength and becomes delayed as @xmath354 increases . as in a standard second order linear system , the disturbance and the system response are in quadrature at the resonance .",
    "the phase @xmath379 and the rescaled amplitude @xmath358 of the free surface are displayed in figure  [ deltasurfacelibre](a)-(b ) for different values of @xmath374 . in panels  [ deltasurfacelibre](c)-(d ) , they are compared to the analytical predictions obtained using a much simpler closure ( appendix  [ ffc ] ) .",
    "one can see that the amplitude of the resonance increases with the froude number .",
    "for very small @xmath374 , the phase curve is more complicated to interpret , but note that this corresponds to a vanishing amplitude @xmath345 : the resonance essentially disappears . for @xmath380 ,",
    "the free surface amplitude seems to converge to some finite value , but the phase slowly goes back to @xmath130 .",
    "this gentle crossover is indeed expected at very large wavelength , a situation for which the free surface must follow the bottom topography .",
    "it is interesting to investigate how the resonance is affected by the fact that the bottom moves i.e. can grow or propagate . following the notations introduced in  [ movingboundary ] , we display in figure  [ deltasigmaomega ] the amplitude of the free surface @xmath358 as a function of @xmath355 for different values of the growth rate @xmath117 and the pulsation @xmath204 . for positive growth rates",
    "@xmath117 , the q - factor of the resonance gets smaller but the resonant wavenumber is not affected .",
    "a bottom propagating at the velocity @xmath223 moves the resonant peak along the @xmath355-axis . for a positive propagation velocity @xmath223 the surface velocity with respect to the bottom and thus the effective froude number",
    "get reduced . as a consequence",
    ", the resonant wavelength gets smaller   and @xmath355 larger .",
    "conversely , the peak moves to smaller wavenumber for an upstream moving bottom .",
    "as in sub - section  [ movingboundary ] , these effects are noticeable for values of @xmath228 and @xmath229 of order one , while realistic values are respectively on the order of @xmath236 and @xmath235 . for the ripples and dunes problem ( part 2 ) , the bedform motion can thus be safely ignored in the hydrodynamical calculation and the effect of free surface interpreted in terms of surface standing waves .     as a function of @xmath355 for different values of the growth rate @xmath117 ( a ) and the pulsation @xmath204 ( b ) of the bottom boundary .",
    "arrows indicate increasing values of @xmath117 and @xmath204 .",
    "these graphs have been computed with @xmath349 and @xmath360 . in panel",
    "( a ) , the grey dashed line is for @xmath381 , the back dashed line for @xmath382 , the black dotted line for @xmath195 and the two grey dotted lines for @xmath170 and @xmath129 . in panel ( b ) , the two grey dashed lines is for @xmath383 and @xmath211 , the black dashed line for @xmath382 , the black dotted line for @xmath195 and the three grey dotted lines for @xmath170 , @xmath129 and @xmath175 . for comparison , in all panels the solid lines correspond to the fixed case @xmath218 , @xmath219 . ]",
    "the basal shear stress and pressure and subsequently the coefficients @xmath123 , @xmath109 , @xmath110 and @xmath111 are modified by the presence of the free surface when @xmath355 is of order one and below . in figure",
    "[ abcdfreesurface ] , the coefficients are plotted as functions of @xmath355 for different values of the froude number .",
    "one can see that the resonance peak is more pronounced for larger @xmath374  they are actually not visible when @xmath374 is too small . in agreement with the streamlines of figure  [ resonancefs](a ) , which shows a squeezing downstream the bump crest , the peak of @xmath109 is negative , corresponding to a phase delay of the stress with respect to the bottom .",
    "furthermore , the curves corresponding to the presence of a rigid lid at the same height @xmath40 do not exhibit these peaks .",
    "finally , the diverging behaviour of @xmath109 as @xmath380 is also a free surface effect as , in the same limit , @xmath109 reaches a plateau in the case of a rigid top boundary .",
    "the behaviours of @xmath123 , @xmath109 , @xmath110 and @xmath111 at small @xmath355 ( below the resonant condition ) can be determined analytically using the simple closure proposed in the appendix  [ ffc ] . for small @xmath355 , we get @xmath384 , @xmath385 , @xmath386 and @xmath387 .",
    "these scalings fit fairly well the solutions of the full equations .    as a conclusion ,",
    "there are two situations in which the excitation of standing waves by the topography affects significantly the characteristics of the inner layer : ( i ) around the resonance , since the surface wave amplitude is very large and ( ii ) for vanishing @xmath355 , when the distance @xmath40 between the topography and the free surface becomes so small that the inner layer invades the whole flow .    , @xmath109 , @xmath110 and @xmath111 as functions of @xmath355 , for",
    "@xmath388 ( dotted dashed line ) , @xmath360 ( dotted line ) and @xmath366 ( solid line ) .",
    "the dashed lines correspond to a rigid boundary at the same height @xmath40 .",
    "the plots have been computed for @xmath367 . comparing a free surface to a rigid boundary condition ( or to the case @xmath389 )",
    ", it can be inferred that the hydrodynamics is controlled by the surface waves .",
    "in particular , the resonance leads to a drop of the shear stress component @xmath109 i.e. to a downstream shift of the point of maximum shear stress . ) ]",
    "as this article is based on a rather technical ground , it is useful to sum up , in a qualitative manner , our key results and to put them in perspective with respect to the second part of the paper . in the context of the formation of ripples and dunes from a flat sand bed submitted to a turbulent flow , a central issue is the description of the basal shear stress , which controls bed load transport . due to the scale separation between the typical evolution time of the bedforms and that of the flow , the bottom can be considered as quasi - static .",
    "the hydrodynamics can be investigated independently of the transport issue .    in the traces of the seminal work of @xcite",
    ", three main regions can be evidenced in the turbulent flow over a wavy bottom .    *",
    "an outer layer , away from the bottom , in which the flow is well described by inviscid potential equations , i.e. where the perfect flow approximation is valid .",
    "the streamlines follow the topography so that the velocity is in phase with the bottom . * an inner layer , which corresponds to the region where the inertial terms of the navier - stokes equation are negligible , and thus where the longitudinal pressure gradient is balanced by the transverse mixing of momentum due to turbulent fluctuations i.e. by the reynolds shear stress transverse gradient .",
    "the thickness @xmath97 of the inner layer is related to wavelength by @xmath390 . at the transition between the inner and outer layers ,",
    "the fluid velocity is slowed down by the shear stress . due to inertia , the velocity is always phase delayed with respect to the shear stress .",
    "as the velocity is inherited from the outer layer , the shear stress is phase - advanced with respect to the topography . * a thin surface layer of thickness @xmath22 , which is responsible for the hydrodynamical roughness @xmath20 seen from the inner layer .",
    "the dominant physical mechanism at work in this surface layer can be of different nature .",
    "for instance , @xmath20 can result from the mixing due to roughness elements , the predominance of viscous dissipation , or the presence of bed - load transport .",
    "specific scaling laws for @xmath20 and @xmath22 are obtained for each of theses cases .",
    "the linear relationship between the stresses and the bottom profile can be encoded into two complex coefficients @xmath231 and @xmath391 . the tangent of the phase between the stresses and the bottom is given by the ratios @xmath122 and @xmath392 respectively .",
    "these coefficients are key inputs for the sediment transport issue ( see part 2 ) , and are needed to compute the dispersion relation of the bedforms , i.e. the growth rate as a function of the bedform wavenumber , which tells whether a given wavelength is stable or unstable .",
    "their dependencies with respect to several important parameters such as the length scale ratios @xmath393 or @xmath394 have been determined .",
    "their sensitivity to different ways of modelling turbulence or of imposing the bottom boundary conditions have also been discussed .",
    "our conclusions regarding these functions can be summed up as follows :    * @xmath123 and @xmath109 are generically positive , whereas @xmath110 is positive and @xmath111 negative .",
    "this means that the shear stress profile reaches its maximum before the crests of the bumps .",
    "this effect can be visualised on the streamlines , which are squeezed at this pint of maximum shear . for the normal stresses ,",
    "the situation is opposite : the pressure maximum is slightly delayed after the crests . as the pressure is almost constant across the inner boundary layer , this phase shift @xmath392 is less pronounced by an order of magnitude .",
    "@xmath123 , @xmath109 , @xmath110 and @xmath111 have weak dependencies on the ratio @xmath395 .",
    "the shear stress phase shift @xmath122 vanishes for asymptotically small @xmath396 and gently increases with @xmath397 .",
    "as the inner layer thickness @xmath97 becomes of the order of the surface layer thickness @xmath22 , the phase shift drops .",
    "* these features are robust to ( i ) the turbulent closure , ( ii ) the existence of a reynolds stress anisotropy , ( iii ) the motion ( growth or propagation ) of the bottom . * much more important is the role of the free surface in the case of a water depth @xmath40 on the order of the bottom wavelength @xmath6 .",
    "the undulations of the bottom excite standing gravity waves at the free surface .",
    "resonant conditions are reached when these waves precisely propagate at a velocity equal to that of the flow , i.e. when @xmath398 . at the resonance ,",
    "the response of the free surface is in quadrature with the disturbance . when the froude number is large enough , the deformation @xmath358 of the free surface at the resonance is so large that it has a strong effect on the flow close to the bottom . in particular , the streamlines are squeezed downstream the crests of the bump , so that the shear stress becomes phase - delayed with respect to the topography ( @xmath399 ) . *",
    "another effect due to the presence of a free surface is found for @xmath380 . in this limit",
    ", the water depth becomes very thin in comparison to the wavelength , and the inner layer invades the whole flow ( i.e. @xmath400 ) .",
    "in this situation , the shear stress and the bottom profiles tend to be in phase so that @xmath401",
    ". moreover , the shear stress becomes phase delayed ( @xmath399 ) below a threshold value of @xmath355 that increases with the froude number .",
    "* the shear stress profile is insensitive to the mechanisms at work in the surface layer provided that its thickness @xmath22 is smaller than the inner layer thickness @xmath97 : the hydrodynamical roughness @xmath20 is the single quantity inherited from the surface layer .",
    "the asymptotic calculation performed by @xcite is recovered but only for asymptotically large @xmath402 , a limit hardly reached in real problems .",
    "when @xmath22 is comparable or larger than @xmath97 , the shear stress coefficients @xmath123 and @xmath109 are smaller in the hydraulically smooth regime where the roughness is due to viscosity than in the hydraulically rough regime . in the later case ,",
    "the mixing of momentum in the surface layer is dominated by the turbulent fluctuations induced by the roughness elements . in the ripples and dunes problem",
    ", these results directly apply to the case where sediments are transported with negligible feedback on the flow ( erosion limited transport , see part 2 ) .",
    "when the extra - stress due to bedload transport is significant ( momentum limited transport ) , we predict that @xmath123 and @xmath109 become larger .",
    "but with an almost identical phase shift @xmath122 .",
    "* the normal stress profile is almost independent of the surface layer model .    beyond the linear case ,",
    "we have expended the hydrodynamical calculation to the third order in @xmath61 .",
    "in contrast to the linear calculation , the separation of streamlines , when the shear stress and the pressure gradient are antagonist , and the associated formation of a recirculation bubble are obtained for realistic values of the aspect ratio . at the quadratic order",
    ", we get a correction to the mean velocity profile which corresponds to a roughness @xmath282 at large scale due to bottom corrugation .",
    "this roughness of geometrical origin depends on the ` microscopic ' roughness @xmath20 inherited from the surface layer and is not simply proportional to the amplitude of the bottom profile .",
    "we get the scaling law : @xmath403 , where the factor @xmath264 weakly depends on @xmath395 .",
    "looking at the shear stress modulation , we have shown that the phase shift between the shear stress and the bottom profile is reduced by non - linear corrections and change sign at some particular aspect ratio . in the second part of this paper",
    ", this non - linear analysis is used to predict the selection of the aspect ratio of mature ripples and dunes .    ' '' ''    the understanding of the qualitative reason for the upstream shift of the maximum shear stress on a bump has been meditated with a.b . murray .",
    "this work has benefited from the financial support of the french minister of research .",
    "we thank louv for hospitality , where part of this paper was written .",
    "the calculations of section  [ unboundedcase ] can be generalised in the case of the following anisotropic stress - strain relationship : @xmath404 at the linear order , the velocity , pressure and stress fields read : @xmath50 , \\label{defu_avi}\\\\ u_z & = & u _ * k\\zeta e^{ikx } w , \\label{defw_avi}\\\\ \\tau_{xz } & = & \\tau_{zx}= - u_*^2 \\left[1+k\\zeta e^{ikx } s_t\\right ] , \\label{defst_avi}\\\\ p+\\tau_{zz } & = & p_0+u_*^2 \\left [ \\frac{1}{3}\\chi_z^2 + k\\zeta e^{ikx } s_n\\right ] , \\label{defsn_avi}\\\\ \\tau_{zz } & = & u_*^2   \\left [ \\frac{1}{3}\\chi_z^2 + k\\zeta e^{ikx } s_{zz}\\right ] , \\label{defszz_avi}\\\\ \\tau_{xx } & = & u_*^2   \\left [ \\frac{1}{3}\\chi_x^2 + k\\zeta e^{ikx } s_{xx}\\right ] , \\label{defsxx_avi}\\end{aligned}\\ ] ] and the stress equations can be simplified into @xmath405 the normal stress difference is this time : @xmath406 so that on gets the following four closed equations : @xmath407 as before , they can be written in the usual compact matrix form ( [ systlinplaque ] ) , now with @xmath408",
    "the dynamical equations governing the second - order moments @xmath192 can be derived rigorously . under the assumption of turbulence isotropy at the dissipative scale",
    ", it can be written under the form : @xmath409 @xmath410 is the dissipation rate ; @xmath411 is the spatial flux of turbulent energy induced by fluctuations ; the pressure term @xmath412 conserves energy and is usually responsible for the isotropisation of fluctuations .",
    "we wish to get a stress tensor that relaxes towards its steady state expression prescribed by equation  ( [ tauijprandtl ] ) . for dimensional reasons ,",
    "we write the relaxation rate under the form @xmath413 , where @xmath190 is a phenomenological constant , and keep the mixing length @xmath13 fixed by the geometrical distance to the wall .",
    "the second moment equation then takes the form of a first order relaxation equation : @xmath193 .",
    "\\label{2ndme_2ndorder}\\ ] ] setting @xmath187 , one recovers the stationary solutions ( [ tauijprandtl ] ) .",
    "a finite value of @xmath190 introduces a lag between a change of the flow velocity field and the point / time at which the reynolds stress readapts to this change .      for 2d steady situations ,",
    "the stress relaxation equations are the following : @xmath414 , \\label{relaxxz_2ndorder}\\\\ u_x \\partial_x \\tau_{xx}+u_z \\partial_z \\tau_{xx } & = & \\frac{|\\dot \\gamma|}{\\beta } \\left[-\\kappa^2 l^2 |\\dot \\gamma| \\dot \\gamma_{xx}+ \\frac{1}{3 } \\kappa^2 \\chi^2 l^2 |\\dot \\gamma|^2-\\tau_{xx } \\right ] , \\label{relaxxx_2ndorder}\\\\ u_x \\partial_x \\tau_{zz}+u_z \\partial_z \\tau_{zz } & = & \\frac{|\\dot \\gamma|}{\\beta } \\left[-\\kappa^2 l^2 |\\dot \\gamma| \\dot \\gamma_{zz}+ \\frac{1}{3 } \\kappa^2 \\chi^2 l^2 |\\dot \\gamma|^2-\\tau_{zz } \\right ] .",
    "\\label{relaxzz_2ndorder}\\end{aligned}\\ ] ] at linear order , they simplify into : @xmath415 taking the difference of equations ( [ relaxsxx_2ndorder ] ) and ( [ relaxszz_2ndorder ] ) , one can compute @xmath416 to obtain four closed equations : @xmath417 as before , they can be written in the usual compact matrix form ( [ systlinplaque ] ) , now with @xmath418",
    "recall that @xmath47 is the bottom profile whose wavelength is @xmath42 , and @xmath324 the dimensionless vertical coordinate . at the linear order ,",
    "we write all the relevant quantities under the form : @xmath419 an alternative is to use the curvilinear coordinates @xmath420 and write the field @xmath421 as : @xmath422 we call these expressions respectively the ` non - shifted ' and ` shifted ' representations of @xmath421 .",
    "they lead to the same linearised equations as they are related to each other at the linear order by @xmath423 in practice , this is especially relevant for @xmath51 , for which @xmath424 is not constant : @xmath425 is the shifted representation of the first order correction to the horizontal velocity .",
    "however , @xmath426 , @xmath427 and @xmath428 .",
    "importantly , note that the range in @xmath53 for which these two representations are valid is not the same _ a priori_.      all fields are expanded up to the third order in @xmath61 , neglecting also non - harmonic terms in @xmath429 .",
    "non - shifted representation of the streamwise velocity : @xmath430 shifted representation of the same quantity : @xmath431 expanding the functions @xmath432 with respect to @xmath61 , one can relate a representation to the other as : @xmath433 conversely : @xmath434 the passage from a representation to the other for the other fields works the same , except that there is no zeroth order ( function @xmath134 ) in the expressions .",
    "to compute the streamlines , we introduce the so - called stream function @xmath435 , defined by @xmath436 and @xmath437 .",
    "this function is such that @xmath438 , so that the iso - contours @xmath439 precisely show the streamlines . using the continuity equation ( [ nscont ] )",
    ", it is easy to show that a solution is @xmath440 .",
    "this integral is computed between @xmath441 ( the bottom ) and @xmath442 .",
    "we note @xmath54 the rescaled distance to the bottom . restricting to the linear order , with the relation @xmath443 ( equation ( [ equaw ] ) ) , we end up with @xmath444 \\right \\},\\ ] ] where the function @xmath134 is given by expression ( [ mu2etageom ] ) .",
    "in the situation with a free surface , one can use the following representation for the field @xmath421 : @xmath445 this curvilinear variable @xmath55 vanishes on the bottom @xmath446 , and @xmath447 at the surface @xmath448 . the new function @xmath449 is related to those of the non - shifted representation @xmath450 and @xmath451 as : @xmath452 for @xmath453",
    ", we have @xmath424 and @xmath454 .",
    "consequently , the new stream function is @xmath455 \\right \\}.\\ ] ] one can check that the free surface is indeed a streamline itself , as one of the top boundary conditions is @xmath456 .    in the non - linear ( and unbounded )",
    "case , we get : @xmath457",
    "definition of the different functions involved in the expansion : @xmath237 , \\\\",
    "u_z & = & u _ * \\left[(k\\zeta ) e^{ikx } w_1+(k\\zeta)^2   e^{2ikx } w_{2}+(k\\zeta)^3 e^{ikx } w_{3}\\right ] , \\\\ \\tau_{xz } & = &   - u_*^2 \\left[1+(k\\zeta ) e^{ikx } s_{t1}+(k\\zeta)^2 s_{t0}+(k\\zeta)^2   e^{2ikx } s_{t2}+(k\\zeta)^3 e^{ikx } s_{t3}\\right ] , \\\\",
    "p+\\tau_{zz } & = & p_0+u_*^2 \\left[(k\\zeta ) e^{ikx } s_{n1}+(k\\zeta)^2 s_{n0}+(k\\zeta)^2   e^{2ikx } s_{n2}+(k\\zeta)^3 e^{ikx } s_{n3}\\right],\\\\ \\tau_{zz}- \\tau_{xx } & = & u_*^2   \\left[(k\\zeta ) e^{ikx } s_{d1}+(k\\zeta)^2 s_{d0}+(k\\zeta)^2   e^{2ikx } s_{d2}+(k\\zeta)^3 e^{ikx } s_{d3}\\right].\\end{aligned}\\ ] ] expansion of the mixing length : @xmath458 expansion of the strain tensor components : @xmath459 which gives for the strain modulus : @xmath460,\\end{aligned}\\ ] ] and then @xmath461\\nonumber\\\\ & + & ( k\\zeta)^2 \\left[\\frac{\\kappa^2\\mu'}{2}-\\frac{\\kappa}{2\\mu'}(u_1'+u_1'^*+iw_1-iw_1^*)+\\frac{1}{\\mu'^2}\\left(u_0'+\\frac{u_1u_1^*}{\\mu'}\\right)\\right]\\nonumber\\\\ & + & ( k\\zeta)^2 e^{2ikx}\\left[\\frac{\\kappa^2\\mu'}{2}-\\frac{\\kappa}{\\mu'}(u_1'+iw_1)+\\frac{1}{\\mu'^2}\\left(u_2'+2iw_{2}-\\frac{u_1 ^ 2}{\\mu'}\\right)\\right]\\nonumber\\\\ & + & ( k\\zeta)^3 e^{ikx}\\left[\\frac{\\kappa^2}{4}\\left(2u_1'+u_1'^*+2iw_1-iw_1^*\\right)-\\frac{\\kappa}{\\mu ' } \\left(2u_0'+\\frac{u_1(2u_1^*-u_1)}{\\mu'}+u_2'+2iw_{2}\\right)\\right.\\nonumber\\\\ & + & \\left.\\frac{1}{\\mu'^2}\\left(u_3'+iw_{3}-\\frac{u_1 u_1^*}{\\mu'^2}(u_1'+iw_1)+\\frac{u_1 ^ 2}{2\\mu'^2}(u_1'^*-iw_1^*)+\\frac{4u_1^*u_2}{\\mu'}\\right)\\right].\\end{aligned}\\ ] ] expressions of the different functions corresponding to the normal stresses @xmath462 : @xmath463 expressions of the different @xmath251 : @xmath464 $ \\\\ \\quad & $ - \\,\\,\\ , \\frac{\\mu'}{4}(u_1'^*-iw_1^*)\\left[\\kappa^2\\mu'+\\frac{2}{\\mu'^2}(u_2'+2iw_{2})\\right]$ \\end{tabular } \\\\ $ 0 $ \\\\ \\begin{tabular}{ll } $ i u_0 u_1 $ & $ + \\,\\,\\ , \\frac{i}{2 } u_2 u_1^ * + u_0 ' w_1 + \\frac{1}{2 } w_1^ * u_2 ' + \\frac{1}{2 } w_2 u_1'^*$ \\\\ \\quad & $ + \\,\\,\\ , \\frac{4}{\\mu'^2}u_2(u_1'^*-iw_1^*)-8\\kappa u_2+\\kappa^2\\mu ' ( 2u_1-u_1^*)+\\frac{6}{\\mu'^3}u_1 ^ 2u_1^*$ \\\\ \\quad & $ + \\,\\,\\ , \\frac{2\\kappa}{\\mu'}(u_1'+iw_1)(u_1^*-u_1)-\\frac{2\\kappa}{\\mu'}u_1(u_1'^*-iw_1^*)+\\frac{4}{\\mu'^2}u_1u_0'$ \\\\ \\quad & $ - \\,\\,\\ , \\frac{2}{\\mu'^2}u_1^*(u_2'+2iw_{2})$ \\end{tabular } \\\\ $ -i u_0 w_1 - \\frac{3i}{2 } w_2 u_1^ * + \\frac{3i}{2 } u_2 w_1^*$ \\end{tabular } \\right ) .\\end{aligned}\\ ] ]",
    "several of the free surface effects can be recovered within a simple friction force model , for which analytical expressions of the linear solution of the flow can be derived .",
    "in particular , the resonance condition as well as the behaviour of the basal stress coefficients @xmath123 , @xmath109 , @xmath110 and @xmath111 for @xmath380 can be found and interpreted .",
    "we start from the navier - stokes equations for a perfect flow , with a crude additional turbulent friction term as an approximation of the stress derivatives : @xmath465 physically , the force applied to a fluid particle is directly related to the relative velocity with respect to the ground . at an angle @xmath308 ,",
    "the following plug flow is an homogeneous solution of the above equations : @xmath466 in order to estimate the value of the friction coefficient , one can make use of the fact that typical turbulent velocity vertical profiles are logarithmic .",
    "however , as the logarithm varies slowly when @xmath1 is much larger than @xmath20 , we write @xmath467 . identifying the shear stress on the bottom as @xmath468",
    ", we finally get with the relation ( [ ux0_ffc ] ) @xmath469 for @xmath353 in the range @xmath470-@xmath471 , we get a typical value for @xmath472 on the order of few @xmath235 .",
    "we now normalize quantities by @xmath473 and @xmath40 and get a single non - dimensional ( froude ) number : @xmath474      the starting equations can be linearised around the above reference state . looking a the flow over a corrugated bottom @xmath47 , it is easy to show that the solution is of the following form @xmath475 , \\\\ u_z & = & \\overline{u}ik\\zeta e^{ikx } \\left [ a_+ e^{kz } + a_- e^{-kz } \\right ] , \\\\ p & = & g \\cos \\theta ( h - z ) + \\overline{u}^2 ( kh - i 2\\omega ) \\frac{\\zeta e^{ikx}}{h } \\left [ a_+ e^{kz } - a_- e^{-kz } \\right ] , \\end{aligned}\\ ] ] where @xmath476 and @xmath477 must be determined by the boundary conditions .",
    "this exponential form is characteristic of potential flows .",
    "we require that the velocity normal to the bottom vanish . following the notations of the main part of the paper , we define @xmath478 such that the free surface is at the altitude @xmath479 .",
    "it is a material line where the pressure vanishes .",
    "the three boundary conditions are then : @xmath480 where , as before , @xmath345 is defined as @xmath328 .",
    "the constants @xmath476 and @xmath477 , as well as @xmath345 are thus solutions of @xmath481 from which we get : @xmath482 , \\\\",
    "a_- & = & \\frac{1}{2 } \\left [ 1 + \\frac{(kh - i2\\omega)\\tanh kh - \\frac{1}{{{\\mathcal{f}}}^2 } }       { ( kh - i2\\omega ) - \\frac{1}{{{\\mathcal{f}}}^2 } \\tanh kh } \\right ] .\\end{aligned}\\ ] ]      the shear stress is not part of the variables of this model , but we can consistently define it as @xmath483 .",
    "looking at the shear stress @xmath484 and normal stress @xmath485 on the bottom , in accordance with the notations of the previous sections of the paper , we introduce the coefficients @xmath123 , @xmath109 , @xmath110 and @xmath111 as @xmath486 , \\\\",
    "p_b & = & gh\\cos\\theta + \\omega \\overline{u}^2 ( c+id ) k\\zeta e^{ikx},\\end{aligned}\\ ] ] which gives @xmath487 \\tanh kh - \\frac{1}{{{\\mathcal{f}}}^2 } \\ , kh [ \\tanh^2 kh+1 ] } { \\left ( kh-\\frac{1}{{{\\mathcal{f}}}^2}\\tanh kh \\right ) ^2 + 4\\omega^2 } \\ , , \\\\",
    "b & = & \\frac{2\\omega}{{{\\mathcal{f}}}^2 } \\ , \\frac{[\\tanh^2 kh-1 ] } { \\left ( kh-\\frac{1}{{{\\mathcal{f}}}^2}\\tanh kh \\right ) ^2 + 4\\omega^2 } \\ , , \\\\ c & = & \\frac{1}{2\\omega } \\left ( -a-\\frac{2\\omega b}{kh }",
    "\\right ) , \\\\ d & = & \\frac{1}{2\\omega } \\left ( -b+\\frac{2\\omega a}{kh } \\right ) .\\end{aligned}\\ ] ] it is worth noting that the friction force model predicts negative values of @xmath109 for any @xmath355 .",
    "this means that there is always a phase delay of the shear stress with respect to the bottom , which is a clear disagreement with the full solution . in order to fix this flaw",
    ", one would need to empirically introduce an imaginary part to @xmath472 .",
    "finally , this discrepancy shows that a precise description of the phase between the basal friction and the relief is a subtle and difficult issue that fully justify the use of a rigorous but heavy formalism .",
    "ayotte , k.w .",
    ", xu , d. & taylor , p.a .",
    "1994 the impact of turbulence closure schemes on predictions of the mixed spectral finite - difference model for flow over topography .",
    "_ boundary - layer met . _ * 68 * , 1 - 33 .",
    "prandtl , l. 1925 bericht ber untersuchungen zur ausgebildeten turbulenz .",
    "_ * 3 * , 136 - 139 . after ,",
    "bradshaw , p. 1974 possible origin of prandt s mixing - length theory , _ nature _ * 249 * , 135 - 136 ."
  ],
  "abstract_text": [
    "<S> in the context of subaqueous ripple and dune formation , we present here a reynolds averaged calculation of the turbulent flow over a topography . using a fourier decomposition of the bottom elevation profile , we perform a weakly non - linear expansion of the velocity field , sufficiently accurate to recover the separation of streamlines and the formation of a recirculation bubble above the some aspect ratio . </S>",
    "<S> the normal and tangential basal stresses are investigated in details ; in particular , we show that the phase shift of the shear stress with respect to the topography , responsible for the formation of bedforms , appears in an inner boundary layer where shear stress and pressure gradients balance . </S>",
    "<S> we study the sensitivity of the calculation with respect to ( i ) the choice of the turbulence closure , ( ii ) the motion of the bottom ( growth or propagation ) , ( iii ) the physics at work in the surface layer , responsible for the hydrodynamic roughness of the bottom , ( iv ) the aspect ratio of the bedform and ( v ) the effect of the free surface , which can be interpreted in terms of standing gravity waves excited by topography . </S>",
    "<S> the most important effects are those of points ( iii ) to ( v ) , in relation to the intermixing of the different length scales of the problem . </S>",
    "<S> we show that the dynamical mechanisms controlling the hydrodynamical roughness ( mixing due to roughness elements , viscosity , sediment transport , etc ) have an influence on the basal shear stress when the thickness of the surface layer is comparable to that of the inner layer . </S>",
    "<S> we evidence that non - linear effects tend to oppose linear ones and are of the same order for bedform aspect ratios of the order of @xmath0 . </S>",
    "<S> we show that the influence of the free surface on the basal shear stress is dominant in two ranges of wavelength : when the wavelength is large compared to the flow depth , so that the inner layer extends throughout the flow and in the resonant conditions , when the downstream material velocity balances the upstream wave propagation .    </S>",
    "<S> leer.eps gsave 72 31 moveto 72 342 lineto 601 342 lineto 601 31 lineto 72 31 lineto showpage grestore </S>"
  ]
}