{
  "article_text": [
    "this paper addresses the efficient evaluation of finite - temperature response functions @xmath1 for quantum many - particle systems on one - dimensional ( 1d ) lattices in the framework of the _ density matrix renormalization group _ ( dmrg ) @xcite . from the theoretical perspective",
    ", such quantities occur for example in the context of linear response theory @xcite and characterize the effect of a perturbation @xmath2 of the system at time zero on the expectation value of an observable @xmath3 at time @xmath4 .",
    "initially , the system is in thermal equilibrium , where @xmath5 is the inverse temperature and @xmath6 .",
    "the units are chosen such that boltzmann s and planck s constants are @xmath7 and @xmath8 .",
    "such response functions contain important information on the many - body physics and are addressed in many experimental setups .",
    "for example , recent advances in neutron - scattering techniques make very precise measurements possible .",
    "see for example refs .",
    "it is hence very important to have numerical tools at hand that allow for an efficient and precise evaluation of thermal response functions for ( strongly - correlated ) condensed matter models in order to match theoretical models to actual materials and to gain an understanding of the underlying physical processes .    as discussed and demonstrated in several works @xcite , finite - temperature response functions for strongly - correlated 1d systems",
    "can be evaluated up to some maximum reachable time by using the time - dependent density matrix renormalization group ( tdmrg ) @xcite applied to a _ purification",
    "_ @xcite of the density matrix . in the dmrg approach ,",
    "those purifications are approximated with a controllable precision by _ matrix product states _ ( mps ) @xcite . to address finite - temperature states with tdmrg",
    "was suggested in refs .",
    "@xcite with first applications in refs .",
    "a difficulty in the simulations of time - evolved states is the growth of entanglement with time @xcite . in tdmrg calculations",
    ", this leads to a corresponding , typically exponential , increase of the computation cost with time and a strong limitation of the maximum reachable times , depending on the available computational resources and the desired accuracy of the simulation .",
    "the effect is much more drastic for mixed states .",
    "the focus of this paper is hence to study the computation cost of the different tdmrg schemes for the evaluation of thermal response functions and to suggest novel more efficient approaches that allow for a substantial increase in the maximum reachable times .",
    "the results of such simulations can be fourier transformed to study the spectral properties of the response . in order to avoid ringing artifacts from the fourier transformation of the data on a restricted time interval , one can either use filters , which result in an artificial broadening , or use linear prediction @xcite .",
    "this was employed first in ref .",
    "@xcite for @xmath9 and in ref .",
    "@xcite for @xmath10 .",
    "see also refs .",
    "@xcite , for further applications of linear prediction in dmrg calculations at @xmath9 .",
    "earlier alternative dmrg approaches for finite - temperature response functions have built on the _ transfer matrix renormalization group _",
    "( tmrg ) @xcite . in a first step ,",
    "analytic continuation techniques as in _ quantum monte carlo _ ( qmc ) were employed @xcite . in a second development ,",
    "transfer matrices comprising the imaginary- and the real - time evolution were used to access autocorrelation functions @xcite . in finite - temperature qmc calculations ( e.g.  positive - definite path integral @xcite or stochastic series expansion with directed loops @xcite ) , real - time or real - frequency response functions have to be extracted by analytic continuation from imaginary - time results @xcite which is ill - conditioned and numerically challenging .",
    "finite temperatures have also been addressed by a hybrid algorithm based on monte carlo and tdmrg @xcite .    in this paper ,",
    "i discuss how the simulation based on the evolution of a certain mps purification of the thermal density matrix as described in @xcite can actually be understood as evolving a _ matrix product operator _",
    "( mpo ) representation of the square root of the thermal density matrix .",
    "the description in terms of purifications is in this sense superfluous .",
    "a decisive observation is now that there are considerable degrees of freedom for the choice of a specific evaluation scheme .",
    "for the two specific schemes , corresponding to refs .",
    "@xcite ( _ scheme a _ ) and ref .",
    "@xcite ( _ scheme b _ ) , respectively , i examine the scaling of the computation cost with time .",
    "it turns out that _ scheme a _ has some advantage at low temperatures and _ scheme b _ is advantageous at higher temperatures , for which i give an explanation on the basis of quasi - locality @xcite .",
    "the maximum reachable times @xmath11 and @xmath12 differ , for the same computation cost and accuracy , by a factor of order one .",
    "it is then shown that an optimized evaluation scheme , for which one optimizes over the aforementioned degrees of freedom , yields maximum reachable times that are at least twice as large as for _ scheme b _ , specifically @xmath13 . in all cases",
    "one finds that @xmath14 as @xmath15 varies slowly as a function of @xmath16 .",
    "we can devise a new _ scheme c _ that does not require any optimization , but outperforms _ scheme b _ by a factor of two in the maximum reachable time .",
    "it is only outdone by _",
    "scheme a _ at very low temperatures . to go beyond _ scheme c _ , one can study the computation cost for calculating mpo approximations of operators @xmath17 to determine optimized evolution schemes . finally , the connection between _ scheme a _ and an earlier tmrg approach @xcite is explained . for each of the tdmrg schemes",
    ", one can devise a corresponding tmrg variant .    due to the substantially increased reachable times and its simplicity ( no need for optimization ) , the novel _ scheme c _ , which was introduced recently in ref .",
    "@xcite and is explained here in detail , can be expected to be the method of choice for future applications . in ref .",
    "@xcite , it allowed us to show that the thermal spectral functions of 1d bosons in the quantum critical regime with dynamic critical exponent @xmath18 follows a universal scaling form and to compute the corresponding scaling function precisely .",
    "as described for example in refs .",
    "@xcite , the ( unnormalized ) thermal density matrix @xmath19 for a chain of @xmath20 sites can be obtained in the form of an mps purification    [ eq : mps_purify ] @xmath21    where the @xmath22 label orthonormal site basis states for @xmath23 , the auxiliary hilbert space @xmath24 is isomorphic to @xmath23 , and @xmath25 label orthonormal site basis states for @xmath24 .",
    "the mps is constructed from @xmath26 matrices @xmath27 , where @xmath28 . the matrix sizes @xmath29 are also called _ bond dimensions _ ; see for example the review @xcite .    in order for @xmath30 to be a purification of @xmath31",
    ", it needs to be constructed such that @xmath32 this can be achieved by choosing the infinite - temperature purification to be @xmath33 which can be written as an mps with bond dimensions @xmath34 . in this so - called ancilla approach , finite - temperature purifications can be calculated by imaginary - time evolution @xmath35 and response functions are evaluated after a subsequent real - time evolution @xmath36{\\hat{b}}\\big[e^{-i{\\hat{h}}t}{\\hat{a}}|{\\rho}_\\beta{\\rangle}\\big].\\ ] ] the evolution of the mps can for example be implemented by decomposing the propagators into circuits of local gates by a trotter - suzuki decomposition @xcite as described in section  [ sec : tdmrg_vs_tmrg ] .",
    "the square brackets in eq .",
    "indicate which parts of the expression are represented as mps after the evolution .",
    "note that @xmath37 , which is required in eq .",
    ", can be determined as @xmath38 .",
    "equivalently , one can work with purifications @xmath30 that are normalized to one .    in each step of the tdmrg , the evolved states @xmath39 are approximated by an mps with bond dimensions @xmath40 that are as small as possible for a given constraint on the desired precision of the approximation @xcite .",
    "this is achieved through _",
    "truncations_. for every splitting of the system into a left and a right part , one does a schmidt decomposition @xmath41 of the state @xcite which boils down to doing singular value decompositions of the tensors @xmath42 .",
    "the corresponding reduced density matrices are @xmath43 and @xmath44 .",
    "the bond dimension is then reduced from @xmath45 to some value @xmath46 by retaining only the @xmath47 largest schmidt coefficients and truncating all smaller ones . @xmath48",
    "the precision is in each step of the algorithm controlled by bounding the _ truncation weight _",
    "@xmath49    an mps purification @xmath50 and the corresponding mpo @xmath51 , according to the isomorphism . in the graphical representation ,",
    "boxes represent the tensors @xmath42 that define the mps or mpo , and lines represent partial tensor contractions .",
    "the diagram for @xmath52 represents the tensor network that has to be contracted in order to evaluate the trace of two mpos @xmath51 and @xmath53 , and a local observable @xmath54 as occurring in the tdmrg schemes for the evaluation of thermal response functions .",
    "see for example eq .  .",
    "the computational cost is determined by the bond dimensions of the mpos as in eq .",
    ".,scaledwidth=90.0% ]    as a matter of fact , the notation of this procedure as an algorithm on purifications is in a sense superfluous . due to the fact that @xmath55 , the space of linear maps on @xmath23 , and the tensor product space @xmath56 are isomorphic , everything can be rewritten in terms of mpos in @xmath55 instead of mps purifications in @xmath56 , @xmath57 examples for this one - to - one relation are @xmath58 where the transposition is to be executed in the @xmath59 basis . in particular , the counterpart of the mps purification is the mpo @xmath60 see for example refs .",
    "@xcite for discussions of mpos .",
    "applying evolution operators @xmath61 or @xmath62 to the left or right of an mpo @xmath51 can be done by tdmrg in exactly the same way as for mps , for example , by a trotter - suzuki decomposition as described in section  [ sec : tdmrg_vs_tmrg ] .",
    "the truncation weight , which is kept below a certain bound in order to control the precision , is then given by @xmath63 where @xmath64 is the schatten 2-norm .",
    "this is the natural norm within the dmrg framework .",
    "evaluation _ scheme a _ as described and employed in refs .",
    "@xcite corresponds to eq .  .",
    "in the mpo notation it reads @xmath65{\\hat{b}}\\big[e^{-i{\\hat{h}}t}{\\hat{a}}e^{-\\beta{\\hat{h}}/2}\\big]\\right).\\ ] ] the square brackets indicate which parts of the expression are represented as mpos after the evolution .",
    "figure  [ fig : schemesab ] shows the algorithm diagrammatically .",
    "the partition function @xmath37 can be obtained from the schatten 2-norm @xmath66\\vert}_{2})^2 $ ] . in the dmrg method , multiplications of the matrices @xmath67 and singular value decompositions , required for the truncations of the mpos , dominate the computation costs .",
    "hence , the computation costs for a single evolution step for the first mpo ( bond dimensions @xmath68 ) and the second mpo ( bond dimensions @xmath69 ) , and for the final evaluation of eq .   scale as @xmath70 respectively @xcite ; see figure  [ fig : mpo ] .",
    "_ schemes a _ and _ b _ for the evaluation of the response function according to equations and . in the tdmrg simulations ,",
    "the operators in square brackets are approximated as mpos .",
    "the computation costs for given @xmath4 and @xmath71 depend on the chosen scheme and the desired accuracy of the mpo approximations.,scaledwidth=80.0% ]    for a nonsingular operator @xmath72 , the value of is invariant under transformations    [ eq : trafo ] @xmath73      & \\quad\\longrightarrow\\quad & & \\big[\\hat t e^{-\\beta{\\hat{h}}/2 } e^{i{\\hat{h}}t}\\big]\\\\      \\big[e^{-i{\\hat{h}}t}{\\hat{a}}e^{-\\beta{\\hat{h}}/2}\\big ]      & \\quad\\longrightarrow\\quad & & \\big[e^{-i{\\hat{h}}t}{\\hat{a}}e^{-\\beta{\\hat{h}}/2}\\hat t^{-1}\\big]\\end{aligned}\\ ] ]    of the involved mpos @xcite .",
    "this is a considerable degree of freedom that can be exploited to reduce , for given @xmath71 , @xmath4 , and @xmath74 , the bond dimensions @xmath68 of the mpos and , hence , to reduce the computation cost . in cases where such a reduction is possible , one can extend the simulation to longer times @xmath4 .",
    "some numerical experiments showed that the corresponding computation cost for the optimization of @xmath75 scales exponentially with the system size .",
    "so a search for globally optimal @xmath75 seems to be a hopeless exercise .",
    "it is hence reasonable to constrain ourselves to certain classes of transformations , e.g. , @xmath76 and to optimize with respect to the degrees of freedom of the class  @xmath77 and @xmath78 in that case .",
    "see section  [ sec : opt ] .    the modified evaluation _",
    "scheme b _ ( see fig .  [",
    "fig : schemesab ] ) employed in refs .",
    "@xcite corresponds to the choice @xmath79 and reads in the operator notation @xmath80{\\hat{b}}\\big[e^{-i{\\hat{h}}t}{\\hat{a}}e^{-\\beta{\\hat{h}}/2}e^{i{\\hat{h}}t}\\big]\\right)\\nonumber\\\\           \\label{eq : chi_schemeb }      & = \\frac{1}{z_\\beta}{\\operatorname{tr}}\\left(\\big[e^{-\\beta{\\hat{h}}/2}\\big]{\\hat{b}}\\big[e^{-i{\\hat{h}}t}{\\hat{a}}e^{-\\beta{\\hat{h}}/2}e^{i{\\hat{h}}t}\\big]\\right).\\end{aligned}\\ ] ]",
    "zero - temperature phase diagram of the spin-@xmath0 xxz heisenberg model in a magnetic field .",
    "the ground state is fully polarized in the ferromagnetic phase . in the nel phase",
    ", it has a finite staggered magnetization .",
    "the system is critical ( vanishing energy for excitations ) in the xy , or spin - liquid , phase ( gray ) .",
    "the phase boundaries can be obtained from the bethe ansatz @xcite . in this work ,",
    "the properties of different tdmrg schemes for the evaluation of thermal response functions are exemplified with this model at the three points @xmath81 with @xmath82.,scaledwidth=55.0% ]    computation cost per time step ( @xmath83 ) for _ scheme a _ ( top ) and _ scheme b _ ( bottom ) with @xmath84 and @xmath85 , @xmath86 @xcite , and truncation weights per time step @xmath87 , @xmath88 .",
    "the contour lines correspond to maximum reachable times for different computational resources ( per time step ) and the predefined precision of the simulations ( @xmath89 , @xmath90 ) .",
    ", scaledwidth=95.0% ]    maximum bond dimensions @xmath91 for _ scheme a _ ( top ) and _ scheme b _",
    "( bottom ) with @xmath84 and @xmath85 , @xmath86 , and truncation weights per time step @xmath87 , @xmath88.,scaledwidth=95.0% ]    in order to study the computational costs of evaluation _ schemes a _ and _ b _ [ eqs .   and ] , as functions of time and temperature , let us choose as an example the spin-@xmath0 xxz heisenberg model @xmath92 the phase diagram @xcite , as derived by the bethe ansatz , is shown in figure  [ fig : xxz ] .",
    "the simulations are carried out for vanishing magnetic field @xmath82 , system size @xmath93 , and coupling constants @xmath94 and @xmath95 , where the model is gapless , and at @xmath96 , where the model is in its gapped antiferromagnetic phase . for the time evolution , a fourth order trotter - suzuki decomposition with step sizes @xmath97",
    "the truncation weights in the imaginary - time and real - time evolutions were fixed to values @xmath89 and @xmath90 which are specified in the captions of the corresponding figures .",
    "figure  [ fig : ab_sp63_cost ] shows the computation cost per time step for the operators @xmath86 in eqs .   and",
    ", i.e. , spin - flips in the middle of the system @xcite .",
    "the density plots show , as a function of time and temperature , the number of operations needed for a single time step as measured by @xmath83 . for _ scheme a _ ,",
    "the cost is dominated by the cost for the computation of the mpo @xmath98.\\ ] ] for _ scheme b _ , the computation of the mpo @xmath99\\ ] ] dominates the numerical costs .",
    "hence , the bond dimensions @xmath100 of those operators were used in the diagrams . please notice the logarithmic scale for @xmath5 and the cost , i.e. , the color coding and the distances of the contour lines @xcite .",
    "the contour lines correspond to maximum reachable times for certain computational resources and a predefined precision of the simulation , determined by @xmath89 and @xmath90 .",
    "figure  [ fig : ab_sp63_dim ] shows , for the same simulations , the maximum bond dimensions @xmath101}m_i(\\beta , t)$ ] .",
    "first of all , the results show that the computation costs increase , for fixed temperature , exponentially with time @xmath4 .",
    "this corresponds to a linear increase of the entanglement entropy in the evolution of pure states after a quench @xcite . for the noncritical case , @xmath96 , the costs per time step become @xmath71-independent for temperatures that are sufficiently below the excitation gap . at higher temperatures , the cost for _ scheme b _",
    "is systematically smaller than that for _ scheme a_. the effect is strongest for the non - interacting system at @xmath94 . for @xmath95 and @xmath96 ,",
    "the increase in the maximum reachable times is more moderate with a factor of @xmath102 . at lower temperatures , _ scheme",
    "a _ is more efficient than _ scheme b_. this trend strengthens when the accuracy of the simulation is reduced ( higher truncation weights @xmath89 and @xmath90 ) as documented in the left part of figure  [ fig : ab_sp63sk0_cost ]",
    ". figure  [ fig : ab_sp63_dim ] shows that the maximum bond dimensions @xmath91 evolve almost in the same way as the computation costs . for the noncritical case @xmath96 ,",
    "one sees however that the maximum bond dimensions occurring in _ scheme a _ are for all temperatures smaller than those occurring in _ scheme b _ , whereas the computation cost for _ scheme b _ is lower at higher temperatures .",
    "also , for @xmath95 , the maximum bond dimensions occurring in the two schemes are quite similar .",
    "computation cost per time step ( @xmath83 ) for _ schemes a _ and _ b_. left : @xmath95 , and @xmath86 with ( increased ) truncation weights @xmath103 , @xmath104 .",
    "right : @xmath95 and @xmath85 , and @xmath105 with the usual truncation weights @xmath87 , @xmath88.,scaledwidth=98.5% ]    evolution of the mpos and as occurring in _ schemes a _ and _ b _ , respectively .",
    "the plots show the bond dimensions @xmath40 for @xmath106 , high as well as low temperatures , and the critical point @xmath95 as well as the gapped @xmath96 . the truncation weights were @xmath87 and @xmath88 . unlike in _ scheme a _ ,",
    "the mpo for _ scheme b _ remains unchanged outside a certain space - time cone also at high temperatures .",
    "this is due to the quasi - locality ( right ) ; see eq .",
    ".,scaledwidth=98.5% ]    these findings can be explained as follows . in ref .  @xcite it was pointed out that the operator of _ scheme b _ is time - independent for the simple case @xmath107 , whereas the computation cost for the mpo , occurring in _ scheme a _ , can increase with time , even in this trivial case .",
    "more generally , the following argument applies for all operators @xmath2 with finite spatial support @xmath108 .",
    "the typical condensed matter systems are _ quasi - local _",
    "@xcite , i.e. , the spatial support of operators like @xmath109 , occurring in _ scheme b _ , grows only linearly with time .",
    "more precisely , outside a certain space - time cone originating from @xmath108 , the evolved operator acts almost like the identity and does hence not change the entanglement in that region ; see figure  [ fig : ab_sp63_slices ] . in mathematical terms",
    ", quasi - locality means @xmath110 where all terms @xmath111 in the hamiltonian @xmath112 are required to be short - ranged and norm - bounded , @xmath113 is the hamiltonian truncated to a vicinity @xmath114 of the spatial support of the operator @xmath2 ( @xmath115 ) , @xmath116 is the boundary of @xmath114 , and @xmath117 is the lieb - robinson velocity @xcite .",
    "so the norm - distance between the exactly evolved operator and the operator , evolved on the subsystem @xmath114 only , decays exponentially with increasing distance of @xmath116 to a space - time cone defined by the lieb - robinson velocity @xmath118 , and originating from @xmath108 at time zero .",
    "as the evolved operator @xmath109 , hence , behaves up to exponentially small corrections like the identity outside the specified space - time cone , it does not alter the operator @xmath119 $ ] in that region  in particular , not the mpo bond dimensions @xmath68  for the product occurring in _ scheme b_. this effect is very well visible in the plots for @xmath95 and @xmath120 shown in figure  [ fig : ab_sp63_slices ] .",
    "for both tdmrg schemes , the maximum bond dimensions occur in the middle of the system , where @xmath106 acts , and grow ( exponentially ) with time @xmath4 .",
    "the maxima have comparable values .",
    "whereas , in _ scheme b _ , @xmath68 remains unchanged outside the lieb - robinson space - time cone due to the quasi - locality , they grow for all bonds in _ scheme a_. this implies according to eq .   an increased cost for _ scheme a _ at those temperatures .",
    "nevertheless , as figures  [ fig : ab_sp63_cost][fig : ab_sp63_slices ] exemplify , _ scheme a _ is often advantageous at low temperatures , especially for noncritical systems . for low temperatures ,",
    "the quasi - locality is not essential as @xmath121 limits the effect of the real - time propagators @xmath122 to a low - energy subspace . sufficiently far away from the support of @xmath2 ,",
    "the resulting dynamics is then very restricted and can not lead to a big increase of the bond dimensions .",
    "this is true for both schemes .",
    "furthermore , in the middle of the system , where @xmath106 acts , the growth of the bond dimensions is slower for _ scheme a _ which can be attributed to the fact that one acts with one propagator in eq .   instead of acting with two propagators in eq .  .",
    "as the plots for @xmath123 and @xmath124 in figure  [ fig : ab_sp63_slices ] exemplify , the effect is much more pronounced for gapped systems .",
    "the described properties have also been found for other local operators @xmath2 and @xmath3 like @xmath125 etc",
    ". the behavior for non - local operators like @xmath126 is also quite similar as exemplified in figure  [ fig : ab_sp63sk0_cost ] for @xmath127 .",
    "please note that @xmath128=0 $ ] in the isotropic case @xmath95 for which the evolution of @xmath129 is hence trivial .",
    "the computation cost per time step @xmath83 ( top and bottom ) and the maximum bond dimension @xmath91 ( middle ) for the optimized evaluation scheme with @xmath84 and @xmath85 , respectively . with @xmath130",
    ", the schemes have been optimized with respect to @xmath77 and @xmath78 .",
    "the corresponding efficiency measures were chosen to be the computation cost per time step for the top and bottom rows of diagrams , and the maximum bond dimension was chosen for the middle row of diagrams . in all computations ,",
    "the truncation weights were chosen as @xmath87 , @xmath88.,scaledwidth=95.0% ]    _ schemes a _ and _ b _ , eqs .   and , are typically far from optimal .",
    "one has a lot of freedom in designing a scheme that is as efficient as possible .",
    "the choice for a specific measure for the efficiency of a scheme can depend on the available computational resources . in this paper , the computation cost per time step as quantified by @xmath83 [ eq .  ] and , as an alternative , the maximum bond dimension @xmath91 are considered as useful measures . with a nonsingular operator @xmath75 , the most generic scheme involving two mpos is @xmath131 \\big[\\hat t^{-1}e^{-i{\\hat{h}}t}{\\hat{a}}e^{-\\beta{\\hat{h}}}\\big]\\big)$ ] . as pointed out in section  [ sec : schemesab ] , to optimize efficiently with respect to generic @xmath75 is in general not possible .",
    "thus , it is reasonable to constrain ourselves to a certain subclass of schemes and to optimize the efficiency over the remaining degrees of freedom of that class .",
    "let us consider the class of schemes @xmath132 \\big[e^{-i{\\hat{h}}(t - t'')}{\\hat{a}}e^{-(\\beta-\\beta'){\\hat{h}}}e^{i{\\hat{h}}(t - t')}\\big]\\right).\\ ] ] as before , the two factors in square brackets are to be approximated by mpos @xcite . for given inverse temperature @xmath71 , time @xmath4 , and accuracy as quantified by the truncation weight @xmath74 [ eq .",
    "] one can now optimize the chosen efficiency measure with respect to @xmath77 , @xmath78 , and @xmath133 .",
    "_ scheme a _ corresponds to the choice @xmath134 , _ scheme b _ to @xmath135 , and the choice @xmath136 for example to the heisenberg picture . in actual applications",
    ", one can first study the computation cost , for obtaining operators @xmath137 $ ] and @xmath138 $ ] . from the results ,",
    "one can then conclude on optimal values for @xmath77 , @xmath78 , and @xmath133 in the evaluation of the response function according to eq .  .",
    "for the demonstrational purposes of this paper , it is sufficient to not explore the full three - dimensional parameter space , but to constrain ourselves in the following to the subspace with @xmath139 , i.e. , to the schemes @xmath140 \\big[{\\hat{a}}(t'-t ) e^{-(\\beta-\\beta'){\\hat{h}}}\\big]\\right)\\\\      \\label{eq : chi_schemefull2 }      & = \\frac{1}{z_\\beta}{\\operatorname{tr}}\\left(\\big[e^{i{\\hat{h}}t'}e^{-\\beta'{\\hat{h}}}{\\hat{b}}e^{-i{\\hat{h}}t'}\\big ] \\big[e^{-i{\\hat{h}}(t - t')}{\\hat{a}}e^{-(\\beta-\\beta'){\\hat{h}}}e^{i{\\hat{h}}(t - t')}\\big]\\right).\\end{aligned}\\ ] ]    figure  [ fig : opt_sp63spk0 ] shows , with @xmath141 @xcite , the computation cost per time step and the maximum bond dimensions for the optimized scheme .",
    "the maximum reachable times @xmath142 of the optimized scheme are at least twice as large as the reachable times @xmath143 for _ scheme b _ , specifically @xmath144 .",
    "see also figure  [ fig : cmp_sp63 ] .",
    "the factor @xmath0 in the temperature argument is inessential as one finds that @xmath145 .",
    "this is due to the fact that @xmath15 varies slowly as a function of @xmath16 for all response functions considered in this paper .",
    "let us discuss the possible scenarios for the optimum values of @xmath77 and @xmath78 for the case @xmath141 : the computation cost for _ scheme b _ is dominated by the tdmrg computation of the operator @xmath146 $ ] in eq .  .",
    "the corresponding maximum time , reachable for some given computational resources , truncation weight @xmath74 , and inverse temperature @xmath77 , is denoted by @xmath147 .",
    "the maximum reachable time for the scheme as a function of @xmath71 is then given by @xmath148 there are two possible scenarios , as depicted in figure  [ fig : schemeopt ] . if @xmath147 is concave on the interval @xmath149 $ ] , the optimal scheme corresponds to @xmath150 .",
    "otherwise , there will be an optimum @xmath151 . in the examples studied here ,",
    "@xmath147 was found to be almost concave in the relevant temperature ranges .    as this direct comparison for @xmath95 and @xmath86 shows ( all time axes have the same scales ) ,",
    "the maximum reachable times in the optimized scheme exceed those of the earlier schemes roughly by a factor of two . the efficiency measure for the optimization",
    "was chosen to be the computation cost per time step ( left ) and the maximum bond dimension ( right ) , respectively .",
    "the truncation weights were chosen as @xmath87 , @xmath88.,scaledwidth=100.0% ]     left : two possible scenarios for the maximum times @xmath142 [ eq .  ]",
    "reachable with the optimizable tdmrg scheme for the case @xmath152 and given computational resources .",
    "if @xmath147 is non - concave on the interval @xmath149 $ ] , the optimal scheme corresponds to some nontrivial @xmath77 .",
    "this can for example occur for systems with dynamics on different energy scales .",
    "if @xmath147 is concave , the optimal scheme is given by @xmath150 , i.e. , _ scheme c_. in the examples studied here , @xmath147 was found to be almost concave in the relevant temperature ranges .",
    "right : _ scheme c _ for the evaluation of the response function according to eq .",
    ".,scaledwidth=100.0% ]    one can hence devise a corresponding _ scheme c _ that is near - optimal among the schemes ( at least for @xmath141 ) , does not require any optimization , but outperforms _ scheme b _ by a factor of two in the maximum reachable times .",
    "it is only outdone by _ scheme a _ at very low temperatures .",
    "the scheme corresponds to the choice @xmath150 in eq .",
    "@xmath153 \\big[{\\hat{a}}(-t_a ) e^{-\\beta){\\hat{h}}/2}\\big]\\right)\\\\      \\label{eq : chi_schemec }      & = \\frac{1}{z_\\beta}{\\operatorname{tr}}\\left(\\big[e^{i{\\hat{h}}t_b}e^{-\\beta{\\hat{h}}/2}{\\hat{b}}e^{-i{\\hat{h}}t_b}\\big ] \\big[e^{-i{\\hat{h}}t_a}{\\hat{a}}e^{-\\beta{\\hat{h}}/2}e^{i{\\hat{h}}t_a}\\big]\\right).\\end{aligned}\\ ] ] after the imaginary - time evolution that yields @xmath154 $ ] , one runs two real - time tdmrg simulations to obtain mpos @xmath155 $ ] and @xmath156 $ ] . with eq .",
    "one then obtains @xmath157 ; see figure  [ fig : schemeopt ] .",
    "the accuracy of the mpos should be kept under control during the whole simulation , for example , as described in section  [ sec : dmrg ] by bounding the truncation error @xcite . if this is done properly ,",
    "it is of minor importance what specific @xmath158 and @xmath159 are chosen to evaluate @xmath160 for a given time @xmath4 .",
    "the maximum reachable time @xmath4 is of course given by the sum of the maximum reachable @xmath158 and @xmath161 . for the case",
    "@xmath152 ( or cases where @xmath162 is for example simply a translate of @xmath2 @xcite ) , the maximum reachable times for @xmath158 and @xmath161 are equal , and the total maximum reachable time with this scheme is then twice as large as the maximum time of _ scheme b_. this makes many more physical applications accessible .    as pointed out above , _",
    "scheme c _ is optimal among the classes of schemes corresponding to eq .   if @xmath147 is a convex function . for the cases studied here it was indeed found to be convex or almost convex in the considered temperature ranges .",
    "one can expect a different behavior for example for systems with dynamics on different energy scales .",
    "in such cases one can achieve considerable performance improvements by optimizing among the class of schemes or . in exceptional cases",
    "it also occurs that evolved operators @xmath163 have an mpo representation with a time - independent bond dimension .",
    "this implies @xmath164 and one can compute the response function for arbitrary times by using @xmath165 and @xmath166 in eq .  .",
    "one such case is the operator @xmath167 for the xy model ( @xmath168 ) which can for all times be written as an mpo of bond dimension @xmath169 @xcite .",
    "the time evolution of matrix product states or density operators , as employed in the presented evaluation schemes for thermal response functions , can be implemented within the tdmrg framework in several different ways .",
    "the results for the computation costs of the different evaluation schemes are essentially independent of the chosen time evolution algorithm . the currently most common choice @xcite employs a trotter - suzuki decomposition @xcite .",
    "alternatively , one can use for example the arnoldi method , runge - kutta method or other krylov subspace approaches @xcite .",
    "let us consider in the following a hamiltonian @xmath170 with nearest - neighbor interactions @xmath171 , operators @xmath2 and @xmath3 with finite spatial support ( for simplicity single sites ) , and implementing the time evolution with a trotter - suzuki decomposition .",
    "this case allows for an alternative evaluation of the thermal response functions on the basis of the transfer matrix renormalization group ( tmrg ) @xcite .",
    "the trotter - suzuki decompositions of real- or imaginary - time propagators read @xmath172 where @xmath173 or @xmath174 , respectively , @xmath175 is the time step , and @xmath176 contain the hamiltonian terms on even and odd bonds , respectively .",
    "the coefficients @xmath177 and @xmath178 sum up to one ( @xmath179 ) and define different decompositions of order @xmath180 and number of stages @xmath181 per time step .",
    "a common choice is the leapfrog algorithm which has @xmath182 stages and order @xmath183 with @xmath184 and @xmath185 . in this work ,",
    "a decomposition with @xmath186 stages and order @xmath187 was used . when the operator exponentials occurring in the formula @xmath188 for the response function in _ scheme a _ , eq .",
    ", are decomposed by such a trotter - suzuki decomposition , one ends up with the task of contracting a 2d tensor network ( quantum cellular automaton ) of local gates as displayed in figure  [ fig : tdmrg_vs_dmrg ] with the space direction being horizontal and the time direction being vertical .",
    "similar tensor networks result for the other evaluation schemes .",
    "visualization of the 2d tensor network that has to be contracted for the evaluation of the thermal response function @xmath189 on the basis of _ scheme a _ when using a trotter - suzuki decomposition of the operator exponentials ( nearest - neighbor interactions ) .",
    "this can be done either using tdmrg or using tmrg . in the tdmrg method , one contracts one row of local gates after another ( with intermediate truncation steps ) , evolving two mpos that are oriented horizontally .",
    "the final evaluation of the response function according to eq .   corresponds to taking the hilbert - schmidt scalar product of the two mpos .",
    "alternatively , one can contract this tensor network with tmrg . in this case",
    "the meaning of states and dual states is changed as indicated on the right side of the figure .",
    "one starts on the left and on the right with vertically oriented mps .",
    "one column of local gates after another , the transfer matrices , is applied to those mps , again with intermediate truncation steps to reduce the bond dimensions .",
    "finally , the expectation value is obtained by evaluating the scalar product of the two mps.,scaledwidth=80.0% ]    the tdmrg approach _",
    "scheme a _ corresponds to starting with a trivial mpo @xmath190 $ ] that represents the identity with bond dimensions @xmath34 @xmath191}$ ] .",
    "beginning at the bottom , one then contracts one row of local gates after another to that mpo until reaching the row that contains operator @xmath3 , yielding @xmath192 $ ] . multiplying , in every step of this iteration , one row of gates with the current mpo in an exact manner , gives a resulting mpo with increased bond dimensions .",
    "a subsequent truncation step reduces the bond dimensions again . the degree",
    "to which the bond dimensions are reduced in the truncation steps is controlled by the predefined truncation weight which determines the accuracy of the computation . similarly , starting from the top , one contracts rows of gates to obtain @xmath193 $ ] . finally , one computes the response function by evaluating the hilbert - schmidt scalar product as visualized in figure  [ fig : mpo ] .    in the tmrg approach ,",
    "the columns of local gates in figure  [ fig : tdmrg_vs_dmrg ] are interpreted as transfer matrices @xmath194 ( also @xmath195 and @xmath196 ) and operate on a hilbert space of dimension @xmath197 , where @xmath198 denotes the dimension of the single - site hilbert space .",
    "the last column corresponds to a pure state @xmath199 and the first column to a dual state @xmath200 .",
    "those transfer matrices and states have matrix product representations with bond dimensions @xmath201 @xmath202 .",
    "starting from the left and the right with the states @xmath203 or @xmath204 , respectively , one transfer matrix after another is applied with intermediate truncation steps , for example , until one reaches the column containing operator @xmath3 . the response function",
    "is then given by the overlap of the two resulting mps , @xmath205[\\hat t_{{\\hat{b}}}\\hat t\\dotsb\\hat t|\\psi_l{\\rangle}]$ ] .",
    "the advantages of the tdmrg approaches , pursued in this work , are that , ( i ) , the number of matrices in the mpos is fixed by the lattice size @xmath20 instead of growing linearly with the time @xmath4 and inverse temperature @xmath71 in the tmrg approach ,",
    "( ii ) , the operators @xmath2 and @xmath3 can have non - local support , ( iii ) , one can evaluate the spectral function for all times @xmath4 , up to the maximum reachable time , by two tdmrg runs whereas , in the tmrg approach , one has to do a new calculation for every time @xmath4 of interest .",
    "concerning ( ii ) , it should be pointed out that non - local operators @xmath2 and @xmath3 would also be accessible in the tmrg approach as long as they are mpos with sufficiently small bond dimensions . in refs .",
    "@xcite the focus was on autocorrelation functions of local operators in the thermodynamic limit @xmath206 . in this case , one does not need to contract one column after another , but can evaluate the response function directly from the left and right transfer matrix eigenvectors with maximum eigenvalue . when one uses the so - called infinite - system dmrg @xcite to obtain those eigenvectors ( a single build - up sweep for the finite imaginary - time lattice ; not to be mistaken with the algorithm presented in ref .",
    "@xcite which generates translationally invariant mps for infinite systems ) , problem ( iii ) does not occur and autocorrelation functions can be evaluated for all accessible times",
    "@xmath4 in a single run .",
    "one should however be careful in applying infinite - system dmrg only , as this algorithm has several pitfalls @xcite .",
    "at least for larger times , finite - system dmrg ( multiple sweeps ) should be necessary .",
    "in this paper , i have studied and explained the computation costs of different tdmrg schemes for the efficient and precise evaluation of finite - temperature response functions of strongly correlated quantum systems . simplifying the notation to some extent by formulating everything in terms of mpos , elucidated the effects of quasi - locality on the costs . the new class of optimizable evaluation schemes , eqs .   and",
    ", typically outperforms the earlier schemes from the literature in terms of the maximum reachable times by a factor of @xmath207 .",
    "this gives access to many more physical applications .",
    "the novel _ scheme c _ , that requires no additional optimization and is near - optimal in many typical examples , can be expected to be the method of choice for future applications . for more complex models , like systems with dynamics on different energy scales , _ scheme c",
    "_ still outperforms the older tdmrg methods , but one can achieve further substantial performance gains by first studying the costs for the computation of operators @xmath137 $ ] , and then using this information to determine the optimal parameters for the scheme . finally , it has been argued that the tdmrg schemes are in some respects favorable to corresponding tmrg variants . as a first application , _",
    "scheme c _ has been used in ref .",
    "@xcite to calculate , for 1d bosons in the quantum critical regime with dynamic critical exponent @xmath18 , the universal scaling function for the thermal spectral function",
    ".    discussions with j.  barthel , c.  karrasch , a.  kolezhuk , i.  p.  mcculloch , t.  nishino , s.  sachdev , j.  sirker , and u.  schollwck as well as financial support through dfg for 801 are gratefully acknowledged .",
    "b. nachtergaele and r. sims , in _ new trends in mathematical physics . selected contributions of the xvth international congress on mathematical physics _ , edited by v. sidoravicius ( springer , heidelberg , 2009 ) , pp",
    ". 591614 .",
    "please note that bond dimensions @xmath68 , as studied in this paper , depend to some extent on the particular implementation .",
    "the logarithmic maximum bond dimensions @xmath208 and computation costs @xmath209 , shown in the density plots , are however robust measures .",
    "particularly , @xmath210 is the so - called hartley entropy @xcite , and the @xmath211 limit of the rnyi entropy .",
    "please note that the expressions , , , and for the response function in the different evaluation schemes give the same values , the exact @xmath212 of eq .",
    ", only if the mpo representations of the operators in square brackets are exact  corresponding to exponentially big bond dimensions with @xmath213 .",
    "a guiding principle of the dmrg approach is that in typical condensed matter applications such exponentially big @xmath68 are not required .",
    "corresponding truncations of the mpos result in slight deviations of the values from the different evaluation schemes .",
    "it is essential to keep the errors in these mpo truncations controlled and small at all times .",
    "it might seem restrictive to only provide data for the choice @xmath214 .",
    "however , the cases where @xmath3 is a translate of @xmath215 are very similar .",
    "this covers the typical cases of interest like @xmath216 , @xmath217 etc . if neither site @xmath218 nor site @xmath219 are close to the boundaries of the system , the resulting computation costs and maximum bond dimensions are very similar to those occurring for @xmath220 .",
    "the peaks in the bond dimensions simply occur at different locations in the lattice , but have similar shape and height ; compare to figure  [ fig : ab_sp63_slices ] .",
    "mikeska and a.  k. kolezhuk , in _ quantum magnetism _ ,",
    "645 of _ lecture notes in physics _ , edited by u. schollwck , j. richter , d.  j.  j. farnell , and r.  f. bishop ( springer , berlin , 2004 ) , pp ."
  ],
  "abstract_text": [
    "<S> this paper provides a study and discussion of earlier as well as novel more efficient schemes for the precise evaluation of finite - temperature response functions of strongly correlated quantum systems in the framework of the time - dependent density matrix renormalization group ( tdmrg ) . </S>",
    "<S> the computational costs and bond dimensions as functions of time and temperature are examined for the example of the spin-@xmath0 xxz heisenberg chain in the critical xy phase and the gapped nel phase . </S>",
    "<S> the matrix product state purifications occurring in the algorithms are in one - to - one relation with corresponding matrix product operators . </S>",
    "<S> this notational simplification elucidates implications of quasi - locality on the computational costs . based on the observation that there is considerable freedom in designing efficient tdmrg schemes for the calculation of dynamical correlators at finite temperatures , a new class of optimizable schemes , as recently suggested in arxiv:1212.3570 , </S>",
    "<S> is explained and analyzed numerically . a specific novel near - optimal scheme that requires no additional optimization reaches maximum times that are typically increased by a factor of two , when compared against earlier approaches . </S>",
    "<S> these increased reachable times make many more physical applications accessible . for each of the described tdmrg schemes </S>",
    "<S> , one can devise a corresponding transfer matrix renormalization group ( tmrg ) variant .    0.4 </S>"
  ]
}