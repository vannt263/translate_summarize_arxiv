{
  "article_text": [
    "in the theory of population genetics , the central aim is to understand the change in allele frequencies in populations which are subject to the processes of mutation , genetic drift , natural selection , and migration between subpopulations  @xcite . even in the simple case of a gene with two alleles at a single locus in a haploid individual ,",
    "this is still a challenging task .",
    "in two recent papers  @xcite we introduced an approximation procedure which reduced a model of migration between an arbitrary number of islands to one on a single island , but with effective parameters which included those describing the network structure and the population size of the islands .",
    "the analytic predictions of the reduced model were generally found to be in very good agreement with simulations of the original model in the case when genetic drift and selection were included .",
    "the aim of this paper is twofold .",
    "one is to include mutation in the formalism ; our original studies did not include mutation , only drift , migration and selection . adding mutation changes the long - time nature of the system . without mutation ,",
    "one of the alleles eventually dies out ( the other is then fixed ) , and the quantities that one attempts to predict are the probabilities of this happening for the various alleles and how long this takes on average . with mutation present , they need never die out , and instead one asks what the stationary probability distribution function ( pdf ) of the system is",
    ". the other aim of the paper is to explore the nature of the approximation further . in our previous papers",
    "@xcite we stressed the intuitive understanding of the approximation , but did not pursue the questions of why the approximation worked quite so well , and how and why it was superior to another scheme we used in the past  @xcite .",
    "we address these questions here .    to carry out the approximation one begins with a neutral metapopulation moran model .",
    "it is neutral because the birth / death rates of both alleles are the same .",
    "it is a metapopulation model because it consists of an arbitrary number of islands ( or demes in the language of population genetics ) between which genes can migrate .",
    "the islands are labeled by an index @xmath0 and the migration rate from island @xmath1 to island @xmath2 , denoted by @xmath3 , is assumed to be given .",
    "finally , the evolutionary dynamics is taken to be a moran process  @xcite , since this is perhaps the simplest model to analyze which has the necessary structure to illustrate the approach .",
    "the effect of selection ( and , as we shall discuss , mutation ) is governed by a small parameter , and can be added on to the neutral metapopulation model as a perturbative correction .",
    "the basic idea behind the approximation is that , although the neutral metapopulation moran model is described by @xmath4 variables , after a short time ( relative to those that interest us here ) the dynamics of the system can be described by a single variable .",
    "this is illustrated in fig .",
    "[ fig_timescale_separation ] , where it is seen that effectively the composition of the islands cease to differ to any great extent after a short time . in mathematical terms",
    "there are @xmath5 fast variables which quickly collapse onto a center manifold ; the system effectively then moves on this ( slow ) center manifold until eventually one of the alleles becomes extinct . including selection or mutation on top of this structure changes some of the details , but as long as the selection strength or the mutation rates are small",
    ", there will still be a timescale separation between the fast variables and the single slow variable , and the same methodology will be applicable .",
    "individuals on each island @xmath2 , @xmath6 , for a neutral six - island metapopulation moran model . over short times ( upper panel )",
    "the proportions of individuals on each island become almost equal .",
    "after this the trajectories of each island are coupled , so that over long times ( lower panel ) the system behaves approximately as a well - mixed model with effective parameters .",
    ", title=\"fig:\",scaledwidth=44.0% ]   individuals on each island @xmath2 , @xmath6 , for a neutral six - island metapopulation moran model . over short times ( upper panel )",
    "the proportions of individuals on each island become almost equal .",
    "after this the trajectories of each island are coupled , so that over long times ( lower panel ) the system behaves approximately as a well - mixed model with effective parameters .",
    ", title=\"fig:\",scaledwidth=44.0% ]    .",
    "the outline of the paper is as follows . in section [ sec_model ] the general model , which includes all four evolutionary processes ,",
    "is formulated , and the diffusion approximation is applied to obtain the fokker - planck equation ( fpe ) for the stochastic dynamics of these processes . restricting our attention to the case in which selection is not present , a reduced - dimension description of the metapopulation model with mutation is obtained in section [ sec_mutation ] .",
    "we find that the reduced model is exactly a one - island moran model with an effective noise - strength and effective mutation rates which depend on the migration and mutation rates , and island sizes of the original model . in section [ sec_mutation_selection ] ,",
    "the reduced system is derived with selection included . in all cases we show that the approximation leads to results which agree extremely well with simulations of the original model .",
    "the approximation method we use is one of a large class of similar methods , and in section [ sec_relate ] we look at a simple model to obtain some insight into the features which make it successful . finally , in section [ sec_conclusion ] , we conclude .",
    "for the purposes of this paper , it is most clear to introduce the model in its full generality , that is , with mutation and selection included .",
    "this is because it is essentially no more complicated to make the diffusion approximation with all processes included as it is to use just the neutral version of the model ( see appendix [ app_diffusion ] and also appendix a of @xcite ) .",
    "we will assume the simplest constituents of the moran model : only two types of haploid organisms , one carrying allele x and the other allele y. each of the @xmath4 islands contains @xmath7 organisms of type @xmath8 and @xmath9 organisms of type @xmath10 , where the number of organisms on island @xmath2 , @xmath11 , is fixed .",
    "the state of the system at any given time is then given by the vector @xmath12 .",
    "the islands may contain different numbers of organisms , but it is assumed that these are not orders of magnitude different from each other , so that we may write @xmath13 , where @xmath14 is a typical number of organisms on an island , and @xmath15 is a number of order one .",
    "the stochastic dynamics is assumed to be markovian , that is , the rate of making a transition from the current state @xmath16 to a new state @xmath17 only depends on these two states , and not on the previous history of the system .",
    "we denote this rate by @xmath18 .",
    "the dynamics is then completely specified by the master equation  @xcite @xmath19 , \\label{master}\\ ] ] with given initial conditions .",
    "the precise form of the transition rates @xmath18 define the model .",
    "the transition rates for the neutral metapopulation moran model are a natural generalization of the rules of the well - mixed ( one - island ) moran model  @xcite .",
    "they have the form  @xcite @xmath20 where the dependence of the probability transition rates , @xmath21 , on elements of @xmath16 that do not change in the transition has been suppressed .",
    "the subscripts zero indicate that this is a neutral process .",
    "each of the four factors in these expressions represents a stage in picking an organism to reproduce and an organism to die .",
    "the first term in the sums is the probability of choosing island @xmath1 , denoted by @xmath22 , the second is the probability of picking an organism on island @xmath1 to reproduce , the third is the probability that the offspring of this organism migrates to island @xmath2 ( @xmath3 , @xmath23 ) or that it stays on island @xmath1 ( @xmath24 ) , and finally the fourth is the probability of picking the organism to be replaced by the offspring .",
    "note that since the population of each island is assumed fixed , the process of birth / death is necessarily coupled to migration .",
    "we now wish to extend this formalism to account for selection and mutation .",
    "let us first consider mutation .",
    "it is worthwhile noting that there is more than one way that mutation can be modeled  @xcite ; here we will assume that the mutation events are independent of the birth / death events .",
    "we allow birth / death / migration events to happen a fraction @xmath25 of the time , and mutation events a fraction @xmath26 of the time .",
    "if we denote @xmath27 to be the mutation rate from @xmath10 to @xmath8 on island @xmath2 and @xmath28 to be the mutation rate from @xmath8 to @xmath10 on island @xmath2 , then the transition rates are @xmath29 where the rates @xmath30 are given by eq .",
    "( [ eq_neutral_rates ] ) and where the subscript @xmath31 denotes ` mutation ' .",
    "we have allowed for the mutation rates to vary from island to island .",
    "the concept of mutation varying with habitat is perhaps less intuitive than that of selective pressure changing according to the environment .",
    "however , there have been experimental studies of certain species that suggest that mutation rates can increase as a result of external environmental stress factors ( see , for example  @xcite ) .",
    "note that since there is no selective pressure , the probability of birth / death / migration events is still proportional to the neutral transition rates , albeit moderated by a factor @xmath25 .",
    "we now turn to how selection is incorporated into the metapopulation moran model .",
    "if a well - mixed system features selection , it is assumed that the probability of each of the types reproducing is weighted by some factor , rather than simply being proportional to the frequencies of the respective types .",
    "these weightings increase or decrease the propensity of the individuals to reproduce with respect to one another , which generates a selective pressure . here , these weightings are given by the vectors @xmath32 and @xmath33 whose @xmath34 elements give the fitness weightings on the @xmath34 island of types @xmath8 and @xmath10 respectively .",
    "the transition rates for the metapopulation model with selection are then @xmath35_{j}n_{j}}{[w_{x}]_{j}n_{j}+   [ w_{y}]_{j}(\\beta_{j}n - n_{j } ) }    \\times \\nonumber \\\\   & & m_{ij } \\frac{(\\beta_i n - n_{i})}{\\beta_{i}n - \\delta_{ij } }    , \\nonumber \\\\   t_{s}(n_{i}-1|   n_{i } ) & = & \\sum_{j=1}^{\\mathcal{d } }   f_{j }   \\frac { [ w_{y}]_{j}(\\beta_{j}n- n_{j})}{[w_{x}]_{j}n_{j}+   [ w_{y}]_{j}(\\beta_{j}n - n_{j } ) }    \\times \\nonumber \\\\ & & m_{ij } \\frac{n_{i}}{\\beta_{i}n-\\delta_{ij } }     \\ , , \\label{eq_rates_selection}\\end{aligned}\\ ] ] where the normalization of the fitness terms has been chosen to keep the birth / death rate of the system fixed",
    "finally , we wish to include both selection and mutation .",
    "since mutation and selection are independent processes , we would still expect the mutation to be controlled by the term with the prefactor @xmath26 in eq .",
    "( [ eq_rates_mutation ] ) .",
    "however , we would expect the birth / death / migration events , moderated by the factor @xmath25 , to now include the selective pressures described by the rates eq .",
    "( [ eq_rates_selection ] ) .",
    "this leads to the transition rates @xmath36 since we are free to rescale time in the master equation by a factor of @xmath25 , and absorb a factor of @xmath37 into the mutation rates , this expression for the transition rates can be simplified to @xmath38 these transition rates , along with the master equation  ( [ master ] ) , define a metapopulation moran model with migration , mutation and selection .",
    "we have now constructed a model containing migration , mutation and selection which , being stochastic , also takes account of genetic drift .",
    "however , the master equation is a set of @xmath39 difference equations with which it is very difficult to make analytic progress .",
    "however , a standard way to simplify the system is available via the diffusion approximation .",
    "the assumption at the heart of the diffusion approximation is that , for large enough system size ( in this case the island size @xmath40 ) , the system can be described by a set of approximately continuous variables @xmath41 .",
    "if additionally the transitions between states are sufficiently local , in this case guaranteed by the fact that transitions from a state @xmath42 only take the system to neighboring states @xmath43 and @xmath44 , a taylor expansion of the master equation in the continuous variables @xmath45 can be be conducted in the small parameter @xmath46 .",
    "the full procedure is described mathematically in appendix [ app_diffusion ] .",
    "here we simply note that using eqs .",
    "( [ f_defn ] ) and ( [ aandb ] ) , together with the transition rates  ( [ eq_rates_mutation_selection ] ) , the master equation for the system with migration , selection and mutation can be approximated by the fokker - planck equation @xmath47 \\nonumber \\\\ & + & \\frac{1}{2n^{2}}\\sum_{i=1}^{\\mathcal{d}}\\frac{\\partial^{2}}{\\partial x_{i}^{2 } } \\left[b_{ii}(\\bm{x})p(\\bm{x},t)\\right ] .",
    "\\label{fpe}\\end{aligned}\\ ] ] the drift vector has elements @xmath48_{j } - [ w_{y}]_{j})x_{j } + [ w_{y}]_{j } } \\times   \\nonumber \\\\   & & \\left\\ { [ w_{x}]_{j } x_{j } - [ w_{y}]_{j } x_{i } - ( [ w_{x}]_{j } - [ w_{y}]_{j } ) x_{i } x_{j } \\right\\ } \\nonumber \\\\ & & + \\frac{1}{\\beta_{i } } \\left [ \\kappa_{1i } - ( \\kappa_{1i } + \\kappa_{2i } ) x_{i } \\right ] , \\ , \\label{a_general}\\end{aligned}\\ ] ] and the diffusion matrix is @xmath49_{j } - [ w_{y}]_{j } ) x_{j } + [ w_{y}]_{j } } \\times \\nonumber \\\\   \\left\\ { [ w_{x}]_{j } x_{j } + [ w_{y}]_{j } x_{i } - ( [ w_{x}]_{j } + [ w_{y}]_{j } ) x_{i } x_{j } \\right\\ } + \\mathcal{o } ( \\bm{\\kappa}_{1 } , \\bm{\\kappa}_{2 } ) \\nonumber \\\\ \\label{b_general}\\end{aligned}\\ ] ] where the vectors @xmath50 and @xmath51 have been introduced and where @xmath52 . the parameters @xmath53 and @xmath54 are assumed to be small , of the order of @xmath55 , so that the order @xmath56 and @xmath57 terms in eq .",
    "( [ b_general ] ) are of the same order as the @xmath58 terms neglected in the expansion of the master equation , and so may be similarly neglected .    in what follows",
    ", we will make use of the equivalence  @xcite between the fpe ( [ fpe ] ) and the it stochastic differential equation ( sde ) @xmath59 where the dot indicates differentiation with respect to @xmath60 , and @xmath61 is a gaussian white noise with zero mean and correlation functions @xmath62 it is useful to think of this intuitively as the deterministic system , @xmath63 , with a small amount of added noise . with the full details of the fokker - planck equation now in hand , we may proceed to analyze the behavior of the system .",
    "to begin our analysis , we consider first the metapopulation moran model with mutation but no selection ; @xmath64_{i}=[w_{y}]_{i}=0 $ ] for each island .",
    "once again the fpe for this system is given by eq .",
    "( [ fpe ] ) but now with the elements of the drift vector taking the simplified form @xmath65 \\ , ,   \\label{a_mutation}\\end{aligned}\\ ] ] where the elements of the matrix @xmath66 are given by eq .",
    "( [ defineh ] ) .",
    "the diagonal elements of the diffusion matrix meanwhile are given by @xmath67 where the higher order terms @xmath56 and @xmath57 in eq .",
    "( [ b_general ] ) have been neglected .    .",
    "the stochastic trajectories follow an approximately deterministic trajectory to the center manifold , indicated by the black arrows.,scaledwidth=40.0% ]    .    to understand how fast - variable elimination",
    "can be used to simplify this system , it is best to briefly consider the neutral deterministic system obtained by taking @xmath68 for all @xmath2 , and @xmath69 . in this case , the deterministic system is linear : @xmath70 , and has a very simple dynamics .",
    "this is a consequence of the fact that the eigenvalue spectrum of the matrix @xmath66 is such that its largest eigenvalue , @xmath71 is zero , and the remaining @xmath5 eigenvalues , @xmath72 , @xmath73 , have a negative real part  @xcite .",
    "therefore , as long as these negative real parts are not too close to zero , the dynamics will consist of a rapid collapse of @xmath5 ` fast ' variables , onto the center manifold , defined by the right - eigenvector of @xmath66 corresponding to the zero eigenvalue .",
    "the equation for this line is given by @xmath74 for all @xmath2 and @xmath1 ( see appendix [ app_remove_fast ] ) .",
    "the remaining eigenvectors are used to determine the fast directions . for finite @xmath14",
    "there is still a collapse to the center manifold which is dominated by the deterministic dynamics , but near to the center manifold , the dynamics consists of stochastic drift along the center manifold , until an axis is reached , and fixation occurs .",
    "an illustrative case for three islands is presented in fig .",
    "[ fig_3d_traj ] .    since",
    "@xmath53 and @xmath54 are assumed to be small , we still expect the separation between the fast and slow timescales to hold when mutation is included , which should allow us to eliminate the @xmath5 fast modes , leaving an effective model with one degree of freedom . that this is the case",
    "is illustrated in fig .",
    "[ fig_traj_m ] .",
    "however now there is no center manifold , but instead a slow subspace .",
    "this leaves us with a problem ; without a line of fixed points about which we can linearize , there are no eigenvectors with which to characterize the fast and slow modes .",
    "our solution to this difficulty , which worked extremely well when selection was added  @xcite , is to continue to use the eigenvectors found when mutation is absent .",
    "since the mutation rates are very small , this should , and as we will see does , provide a reduced model which is an excellent approximation to the original ibm .    to recap then , the fast - mode elimination procedure consists of eliminating the dynamics in the @xmath5 fast directions , and keeping only the dynamics in the ` slow ' direction .",
    "there is more than one way to carry this out , as will be discussed in section [ sec_relate ] .",
    "while a more detailed summary of the method discussed in @xcite and @xcite is given in appendix [ app_remove_fast ] , here we will content ourselves with stating the main features of the procedure .    ) , is plotted as a blue dashed line .",
    "a histogram of trajectories of the original ibm are overlaid in orange .",
    "having relaxed to the slow subspace , they can be seen to be confined to its vicinity.,scaledwidth=40.0% ]    .",
    "the method makes extensive use of the left- and right - eigenvectors of @xmath66 , denoted @xmath75 and @xmath76 respectively . in the case of the neutral system , @xmath77 is coincident with the slow ( stationary ) direction , while the vectors @xmath78 for @xmath79 give information about the fast directions .",
    "the vectors @xmath75 meanwhile form an orthogonal set such that @xmath80 the method we use in this paper consists of two separate steps .",
    "the first is that the system is restricted to the slow subspace of the deterministic system .",
    "obtaining an analytic description for this line is not straightforward , however a very good approximation can be obtained as the solution to the equation @xmath81 here the slow subspace is approximated as the space on which the drift vector has no components in the fast directions of the neutral system . to complete the reduction procedure",
    ", we apply a projection matrix to the sde ( evaluated on the slow subspace ) , to remove any further contributions from the fast directions .",
    "the projection matrix in this case takes the particularly simple form @xmath82 essentially this maps the deterministic dynamics on the slow subspace onto the line @xmath83 while simultaneously removing any contribution from the noise in the fast directions .",
    "we now wish to apply this method to the sde  ( [ generalsde ] ) with drift vector eq .",
    "( [ a_mutation ] ) and diffusion matrix eq .",
    "( [ b_mutation ] ) .",
    "we begin by decomposing the coordinate @xmath84 as follows : @xmath85 where @xmath86 is the slow mode , the @xmath87 are the fast modes .",
    "if we now apply the condition in eq .",
    "( [ general_slow_subspace ] ) , but to @xmath88 given by eq .",
    "( [ a_mutation ] ) , we find in terms of the coordinates @xmath86 and @xmath87 that @xmath89 +   \\mathcal{o}(\\kappa^2 ) , \\label{slow_variables_mut}\\ ] ] where by @xmath90 we mean any product of two or more of the @xmath53 or @xmath28 , @xmath0 . in essence , eqs .",
    "( [ decompose ] ) and ( [ slow_variables_mut ] ) tell us the following .",
    "when there is no mutation present , the deterministic system rapidly collapses to the center manifold @xmath91 , for all @xmath2 .",
    "when mutation is introduced , the collapse still happens , but now it is to the slow subspace , which from eqs .",
    "( [ decompose ] ) and ( [ slow_variables_mut ] ) is seen to be given by @xmath92 , \\label{slow_subspace_mut}\\ ] ] where @xmath0 and where we have again neglected @xmath90 terms . since in practice the mutation rates are tiny , the deviation of the slow subspace defined in eq .",
    "( [ slow_subspace_mut ] ) from the the line @xmath91 is almost impossible to see on any plot .",
    "furthermore , to calculate quantities to first order in the mutation strength the specific form of eq .",
    "( [ slow_subspace_mut ] ) is not required , as we shall see below .",
    "however , we will use the concept of a slow subspace in a more substantive way in section [ sec_mutation_selection ] , when selection is introduced .",
    "therefore the application of the fast mode elimination procedure now first consists of evaluating @xmath88 and @xmath93 on the slow subspace , and then using the projection operator ( [ defineprojection ] ) , to obtain @xmath94 and @xmath95^{2 } b_{ii}(z)$ ] , the effective drift and diffusion terms on the center manifold . the first term in eq .",
    "( [ a_mutation ] ) does not contribute , since when acted upon by @xmath96 it vanishes .",
    "in the second term we only need to set @xmath84 equal to @xmath86 to this order , and so using the definition of @xmath97 we find @xmath98 +   \\mathcal{o}(\\kappa^2)\\ , .",
    "\\label{abar_mut}\\ ] ] to this order @xmath99 is identical to that found without mutation ( see eqs .",
    "( [ definebbar_app])-([b_1 ] ) ) , that is @xmath100 with @xmath101^{2}g_{ik}\\beta_{i}^{-2}. \\label{define_b_1}\\ ] ]    therefore the reduced fpe is @xmath102 + \\frac{1}{2n } \\frac{\\partial^2 } { \\partial z^2 } \\left [ \\bar{b}(z ) p \\right ] , \\label{reduced_fpe}\\ ] ] where @xmath103 to leading order in @xmath53 and @xmath54 . here",
    "@xmath104 is given by eq .",
    "( [ define_b_1 ] ) and @xmath105    the drift and diffusion coefficients of the effective model , given by eq .",
    "( [ abar_bbar_mut ] ) have precisely the form of a well - mixed moran model , but with a noise strength enhanced by a factor of @xmath104 and mutation rates expressed by eq .",
    "( [ kappa_hats_defn ] ) .",
    "even if the mutation rates do not vary from island to island , they will still be enhanced by a non - trivial factor of @xmath106 .",
    "as we have already stressed , having non - zero mutation rates ensures that the system never reaches fixation .",
    "instead it will eventually approach a stationary pdf which , because the fpe is that of a one - island model , has the well - known form  @xcite @xmath107 where @xmath108 is a normalization constant and where @xmath109 the effect of the structure of the network of islands on the dynamics can now be investigated .     connected by a symmetric migration matrix with diagonal entries @xmath110 .",
    "the mutation rates are @xmath111 for each island .",
    "the filled orange histogram is obtained from stochastic simulations of the ibm , while the solid black line is obtained from theory ( eq .  ( [ spdf_mut ] ) ) .",
    "the dashed line is the theoretical prediction of a well - mixed model with the same average mutation rates and a population size @xmath112.,scaledwidth=44.0% ]    in order to examine the effect of the metapopulation structure , the predictions of the effective models will be compared with those obtained from a well - mixed , unstructured analog . the unstructured analog is taken to be a well - mixed one - island model with the mean mutation rates of the metapopulation model ( weighted by island size ) .",
    "we begin by considering the most simple case , that when all islands are the same size , @xmath113 @xmath114 , and where the matrix @xmath115 is symmetric . if @xmath115 is symmetric it is straightforward to show  @xcite that @xmath116 is given by @xmath117 and @xmath118 by @xmath119 . therefore if in addition @xmath120 , one obtains @xmath121 and @xmath122 .",
    "the effective mutation rates are simply equal to the mean of the mutation rates across demes .",
    "the effect of the term @xmath123 in eq .",
    "( [ c_mut ] ) is not so straightforward .",
    "recalling that the total population is given by @xmath124 in this situation , one finds @xmath125 .",
    "the reduced system therefore has a greater effective system size than its well - mixed unstructured analog .",
    "this means that , in the case where the matrix @xmath115 is symmetric , the effect of the population structure is to reduce the effect of the noise on the stationary distribution .",
    "an example of such a case is given in fig .",
    "[ fig_destroy_bistable ] .",
    "the noise induced bistability found in the well - mixed unstructured analogue of the model  @xcite is no longer present , and the deterministic dynamics dominate .",
    "in general , it is found that the effect of population structure identified above is seen in most other parameter regimes .",
    "that is , the effect of population structure is in general to reduce the effect of the noise on the stationary distribution , relative to a well - mixed system with the same total population size and mean mutation rates .",
    "however , there do exist some cases where the converse is true , where the population structure _ increases _ the effect of noise relative to the well - mixed model . in fig .",
    "[ fig_enhance_bistable ] , the stationary distributions for a well - mixed model and a two - island system are plotted for a situation in which this is the case .",
    "we note that numerically it appears that such behavior is only possible if the elements of @xmath56 and @xmath57 are allowed to vary significantly across demes . more investigation",
    "is clearly needed to explore the full range of behavior possible in this system .",
    "however , as demonstrated in fig .",
    "[ fig_range_parameters ] , the analytic predictions derived from the reduced model provide remarkably good agreement with the results from gillespie simulation of the full model , across a range of parameters .",
    "but for a two - island system with asymmetric migration , differing islands sizes and varying mutation rates . while for brevity most parameters are not stated here , we note that the mutation rates differ by many magnitudes over the islands ( see appendix [ app_parameters ] ) .",
    "numerical investigations suggest this is necessary in order to enhance the bistability of the system relative to the well - mixed unstructured analog ( with the same total population size and mean mutation rates ) the pdf of which is here plotted as the dashed black line .",
    ", scaledwidth=44.0% ]    .",
    "once again the solid black line is obtained from theory , the orange histogram from simulations of the original ibm , and the dashed line from a well mixed model with the same total system size and average mutation rates ( weighted by island size).,scaledwidth=48.0% ]",
    "we now proceed to obtain a reduced - dimension description for the model with mutation and selection .",
    "we have applied fast mode elimination techniques to moran metapopulation models with selection elsewhere  @xcite , and we will use many of the results previously obtained in the analysis we carry out here .",
    "there are , however , some ways in which our previous analysis and the current one differ . for instance , here we will include mutation as well as selection .",
    "since we treat these as independent processes , they can be added separately , at least to the order at which we are working . however , as in sec .",
    "[ sec_mutation ] , the alleles will not fix , and the focus will instead be on the stationary pdf of the fpe ( [ reduced_fpe ] ) .",
    "we recall that the model with mutation and selection is approximated by the fpe  ( [ fpe ] ) with drift and diffusion elements specified by eqs .",
    "( [ a_general ] ) and ( [ b_general ] ) respectively .",
    "note that we have not as yet made any assumption about the size of the selection weightings @xmath64_{i}$ ] and @xmath126_{i}$ ] ; the diffusion approximation can be made for arbitrary selection strengths .",
    "however , as seen in the previous section , the fast - variable elimination technique which we seek to implement relies on small departures from the neutral ( linear ) model . to make progress",
    ", we therefore wish to consider the limit of weak selection . in this spirit , we assume that the relative fitness of alleles @xmath8 on island @xmath2 is @xmath64_i = 1 + s\\rho_i$ ] , and correspondingly @xmath126_i = 1 + s\\sigma_i$ ] for allele @xmath10 on island @xmath2 , where the strength of selection parameter , @xmath127 , is small .",
    "this particular choice for the weightings gives another difference from our earlier work , in which we took @xmath128 ( and denoted @xmath129 as @xmath130 )  @xcite .",
    "we will find that the choice made in this paper is a less restrictive assumption concerning the nature of the relative finesses of alleles @xmath8 and @xmath10 .",
    "since the parameter @xmath127 is assumed to be small , having substituted the fitness weightings @xmath64_i = 1 + s\\rho_i$ ] , and @xmath126_i = 1 + s\\sigma_i$ ] into eq .",
    "( [ a_general ] ) and eq .",
    "( [ b_general ] ) , a taylor expansion of the resulting expressions can be conducted in @xmath127 .",
    "one then obtains @xmath131 \\nonumber \\\\ & & + \\frac{s}{\\beta_i } \\sum_{j=1}^{\\mathcal{d } } g_{ij } x_j \\left ( 1 - x_j \\right ) \\left ( \\rho_j - \\sigma_j \\right ) \\left [ 1 - s\\sigma_j - s\\left ( \\rho_j - \\sigma_j \\right ) x_j \\right]\\ , , \\nonumber \\\\",
    "\\label{a_general_s}\\end{aligned}\\ ] ] to the order we are working , and with @xmath132 which takes the same form as the neutral model , again to the order we are working .",
    "the phrase ` to the order we are working ' in the case of the drift coefficient means that we neglect order @xmath133 terms .",
    "this is because we either assume that @xmath127 is of order @xmath55 or smaller , or alternatively of the order of @xmath134 or smaller .",
    "in addition , we will always assume that @xmath53 and @xmath54 are of the order of @xmath55 or smaller .",
    "the motivation for these choices are the small values of these parameters typically found in practice  @xcite .",
    "the scaling with @xmath14 is purely a mathematical convenience however , and while there do exist cases in which the selection strengths of competing genotypes are large  @xcite , we do not consider such regimes here . by a similar argument",
    "we neglect all corrections to the diffusion matrix which involve powers of @xmath135 or @xmath54 .     for systems in which both selection and mutation are present .",
    "the precise parameters can once again be found in appendix [ app_parameters ] .",
    "once more the the orange histogram is obtained from simulations of the original ibm , while the solid black line is obtained from reduced theory .",
    "the theory once again matches simulations extremely well , especially in comparison with the predictions of a well - mixed model with the same total system size and average mutation rates weighted by island size ( black dashed line).,scaledwidth=48.0% ]    we can now apply the fast mode elimination procedure , following the method in section [ sec_mutation ] for mutation without selection . there are some differences however .",
    "one is that we are keeping terms of order @xmath136 , and so we will need the explicit form for the equation of the slow subspace ( the analog of eq .",
    "( [ slow_subspace_mut ] ) , but for selection ) to determine @xmath97 to order @xmath136 .",
    "another difference from mutation is that the selection terms in eq .",
    "( [ a_general_s ] ) are nonlinear .",
    "nonetheless , as we have already stressed , mutation and selection may be treated as independent processes to the order at which we are working , and the calculation of the equation of the slow subspace and of the resulting form of @xmath97 has already been carried out  @xcite . taking over these results",
    "we find that the fast coordinates @xmath87 may be expressed in terms of the slow coordinate @xmath86 as @xmath137 where @xmath138 and where by @xmath139 we mean of order @xmath53 or @xmath54 .",
    "in fact these order @xmath140 terms are exactly given by the expression in eq .",
    "( [ slow_variables_sel ] ) , which we have seen in section [ sec_mutation ] is not required to find @xmath97 to first order in @xmath140 .",
    "evaluating the drift on the slow subspace , and using the projection operator @xmath141 , as in section [ sec_mutation ] allows us to find @xmath97 .",
    "the result is the sum of that found in section [ sec_model ] for mutation and that found in ref .",
    "@xcite for selection , and is given by @xmath142 z(1-z )   \\nonumber \\\\ & + & s^{2 } \\left [ a_{2 } - 2a_3 \\right ] z^{2}(1-z )   + \\hat{\\kappa}_1 - \\left ( \\hat{\\kappa}_1 + \\hat{\\kappa}_2 \\right)z \\ , , \\nonumber \\\\ \\label{abar - mut_sel}\\end{aligned}\\ ] ] with @xmath99 still taking on the neutral form @xmath143 .",
    "the constants @xmath144 and @xmath145 are given by @xmath146\\ , , \\nonumber \\\\ & & a_{4 } = - \\sum_{i , j=1}^{\\mathcal{d}}u^{(1)}_{i } \\frac{g_{ij}\\sigma_j \\alpha_j } { \\beta_{i}}\\ , , \\label{a's}\\end{aligned}\\ ] ] where @xmath147 and with @xmath148 and @xmath149 being given by eq .",
    "( [ kappa_hats_defn ] ) .",
    "note that while to first order it is only the difference between @xmath150 and @xmath151 , @xmath152 , which impacts the effective strength of selection , at second order the specific forms of @xmath150 and @xmath151 are relevant .",
    "though in many applications these second order effects are too small to be noticed , the metapopulation structure allows for migration selection balance , in which the sum of the elements of @xmath152 tend to zero . in cases such as these the precise form of @xmath150 and @xmath151 must be determined .    ) . in these plots , along with the results from simulations ( orange histograms ) , the predictions from the approximation eq .",
    "( [ spdf_mut_sel ] ) ( solid black lines ) and the predictions from a well - mixed system without the metapopulation structure ( black dashed lines ) , the prediction of eq .",
    "( [ spdf_mut_sel ] ) at first order in @xmath127 has also been given ( blue dotted line ) .",
    ", title=\"fig:\",scaledwidth=44.0% ] ) . in these plots , along with the results from simulations ( orange histograms ) , the predictions from the approximation eq .",
    "( [ spdf_mut_sel ] ) ( solid black lines ) and the predictions from a well - mixed system without the metapopulation structure ( black dashed lines ) , the prediction of eq .  ( [ spdf_mut_sel ] ) at first order in @xmath127 has also been given ( blue dotted line ) .",
    ", title=\"fig:\",scaledwidth=44.0% ]    as in section [ sec_mutation ] , the long - time behavior of the system is encapsulated in the stationary pdf .",
    "mathematically this is found by solving the reduced fpe ( [ reduced_fpe ] ) with reflecting boundary conditions , that is , zero probability current at the boundaries .",
    "this gives  @xcite @xmath153 substituting in the explicit form for @xmath97 from eq .",
    "( [ abar - mut_sel ] ) and @xmath154 , one finds the stationary pdf to be @xmath155 where @xmath108 is a normalization constant , @xmath156 and @xmath157 are given by eq.([c_mut ] ) and @xmath158\\ , , \\ \\",
    "c_4 = \\frac{n}{2b_1 } s^2 \\left [ a_2 - 2 a_3 \\right]\\ , .",
    "\\label{c_sel}\\ ] ] we note that once again the predictions from the reduced theory match results from simulation extremely well ( see fig . [ fig_selection_range_parameters ] ) .",
    "the exponential correction to the result without selection ( eq.([spdf_mut ] ) ) for the well - mixed ( single island ) case , that is , with @xmath159 , is well - known  @xcite . here",
    "the metapopulation structure has induced an extra ( @xmath160 ) term , giving a gaussian form to the correction due to second - order selection effects .",
    "one may wonder how such second - order effects can be important .",
    "the answer is in some part addressed in  @xcite ; in the absence of mutation , if the direction of selection varies from island to island , a migration - selection balance can occur , wiping out first order effects in selection pressure ( see parameter @xmath161 in eq .",
    "( [ a s ] ) ) . in these cases the second order term in @xmath127 can influence the shape of the stationary pdf , as seen in fig .",
    "[ fig_mig_selec_balance ] , where parameters have been chosen which allow this balance . in both plots , the parameters are such that @xmath162 ; while the effective theory then predicts that there is no selective pressure at first order , at second order a contribution to the dynamics is made .",
    "this second order contribution matches the results from stochastic simulation .",
    "further , as mentioned earlier , at second order the specification of @xmath163 and @xmath164 become important ; while both the upper and lower panels of fig .",
    "[ fig_mig_selec_balance ] have the same @xmath165 on each island , they have distinct @xmath163 and @xmath164 .",
    "this leads to a symmetric stationary pdf in the upper panel , while the lower panel shows the development of an asymmetry .",
    "once again we note that both of these effects are well - predicted by the reduced - dimension theory , eq .",
    "( [ spdf_mut_sel ] ) .",
    "the elimination method we use clearly works very well , but it has been presented as a prescription , albeit an intuitively motivated one . this is because the general idea behind the method is very easily understood : at the deterministic level , it is clear that the system should decay to the center manifold or the slow subspace , although the precise definition of the slow subspace may vary .",
    "it is also clear how the noise will modify this picture , although once again there are many different ways that this can be implemented mathematically . as a consequence , there is a very large literature on the subject ( for an extensive list of references see ref .",
    "@xcite ; recent references not given there include @xcite ) , and it is variously described as ` fast - mode elimination ' , ` adiabatic elimination ' , ` quasi - steady - state approximation ' , among other terms . while it is an almost impossible task to relate all these methodologies , we will in this section try to give an explanation as to the success of the method we use by applying it to a ` toy ' model consisting of a linear system with additive noise",
    ". we will also explore a different method of reducing the noise which appears more sophisticated , but eventually turns out to perform less well than the method we have used .    by restricting our attention to a system with a linear drift term and a constant diffusion term ,",
    "the fpe of the system is linear .",
    "further , it is assumed that all the eigenvalues of the system are real and non - positive .",
    "if these eigenvalues obey the inequalities @xmath166 then a separation of timescales exists in the system .",
    "the fast directions are identified as the right - eigenvectors @xmath167 , while the slow directions are given by the eigenvectors @xmath168 .",
    "these eigenvectors form a basis into which we can transform for clarity .",
    "the variables in the slow - fast basis are denoted @xmath169 @xmath170 and @xmath171 @xmath172 . in this basis , the dynamics of the system is described by @xmath173 where the correlation structure of @xmath174 is given by @xmath175 here the matrix @xmath176 is a diagonal matrix of eigenvalues @xmath72 , and the matrix @xmath177 is constant ( independent of the state of the system ) , since we are assuming the noise to be additive . finally ,",
    "if we assume that the boundaries lie at @xmath178 , the pdf described by the associated fpe is gaussian  @xcite ( since the fpe is linear ) and can thus be described in terms of the time - evolution of its mean and covariance .",
    "the equations for the mean and covariance are soluble  @xcite ; the solutions for the mean quantities , @xmath179 and @xmath180 , have the form @xmath181 where @xmath182 and @xmath183 are constants determined from the initial conditions , while the solution for the covariance matrix @xmath184 is  @xcite @xmath185 since in this basis @xmath176 is diagonal , the solution for the components of @xmath184 can be expressed in the particularly neat form @xmath186    having specified the system , we now apply the approximation procedure to it , that is , we find a reduced form of the sdes , obtained under the assumption that the inequalities ( [ eigenvalue_ranking ] ) hold . to do this , we introduce the partitioned @xmath187 matrix @xmath188 which is analogous to the @xmath189 term appearing in eq .",
    "( [ generalsde1d ] ) , so that the reduced system is @xmath190 where @xmath191 .",
    "the structure of @xmath192 is dependent on the projection matrix ( see appendix [ app_remove_fast ] ) , which we now discuss .    constructing the @xmath193 matrices @xmath194 and @xmath195 , whose @xmath34 columns are defined to be the @xmath34 left- and right - eigenvectors , @xmath75 and @xmath76 for @xmath196 , the equation for the projection matrix is  @xcite @xmath197 this is a generalization of eq .",
    "( [ defineprojection ] ) , for which the number of slow variables was one , @xmath198 .",
    "in the particular case of the system ( [ diagonal_sde ] ) , the projection matrix takes a very simple from as a result of the fact that the system is already in the slow - fast basis . the left- and right - eigenvectors are equal ( @xmath176 is symmetric ) and one finds @xmath199 where @xmath200 is the @xmath201 identity matrix and the @xmath202 are @xmath203 zero - matrices . applying this projection to the noise @xmath204",
    ", one finds that the form of the correlations of @xmath205 is @xmath206_{ij } \\ , , \\",
    "i , j= 1,\\ldots , r . \\label{b_bar_linear_example}\\ ] ] if we partition the matrix @xmath177 in the same way as @xmath207 : @xmath208 then @xmath209 .",
    "the solution for the time - evolution of the mean of @xmath210 is clearly unaltered , since the system is linear and @xmath211 is diagonal and partitioned from @xmath176 .",
    "what form does the the covariance matrix in the reduced system take ? denoting the covariance matrix of the reduced system s pdf @xmath212 , from eq .",
    "( [ equation_linear_covariance_solution ] ) we find @xmath213_{ij}\\ , , \\",
    "i , j=1,\\ldots{r } \\ , .",
    "\\label{reduced_linear_covariance_projection}\\end{aligned}\\ ] ]    since the system is completely specified by the mean and the variance , we will see that the reduced system is equivalent to taking the limit @xmath214 @xmath215 in the original system . in this case , the inequalities ( [ eigenvalue_ranking ] ) are enforced to the greatest possible degree . in this limit",
    "the elements of the distribution ( [ full_linear_distribution ] ) take the form @xmath216 comparing this result to eq .",
    "( [ reduced_linear_covariance_projection ] ) , and recalling the partition eq .",
    "( [ partition ] ) , we see that for a system with a linear fpe , the reduced system obtained via the projection matrix method provides an exact agreement with the full system in the limit of @xmath217 for @xmath218 .",
    "we now move to considering how an alternative method , the sde conditioning method developed in @xcite , compares to the projection matrix method when applied to this linear system .",
    "the conditioning method bears many similarities to the projection matrix method . as in the projection matrix method ,",
    "the system is first restricted to a slow subspace , defined by eq .",
    "( [ general_slow_subspace ] ) . of course",
    ", the use of this approximation relies on the identification of a linear slow - fast basis . in the non - linear systems analyzed in @xcite ,",
    "these fast and slow directions were taken to be the eigenvectors of the deterministic system linearized about a fixed point .",
    "while formally this results in the deterministic approximation being only locally valid , in the systems addressed in @xcite it was found that the approximation remained successful far from the fixed point .",
    "however , applying the method to the system described in this section we avoid such concerns , since the system under consideration , eq .",
    "( [ diagonal_sde ] ) , is strictly linear .",
    "once the stochastic system is restricted to the slow subspace , there are ( by construction ) no deterministic dynamics in the fast - variables @xmath219 .",
    "however there are still stochastic dynamics in the fast - directions which we wish to eliminate . in the method discussed in this paper ,",
    "the action of the projection matrix on the noise is effectively to neglect the contribution of the noise terms in the fast directions . in @xcite",
    "however , the restriction of the system to the deterministic slow subspace was made explicit by conditioning the noise matrix on the assumption that there was no noise in the fast - direction . applying the methodology described there to the system eq .",
    "( [ diagonal_sde ] ) , one once again obtains a reduced system of the form eq .",
    "( [ linear_reduced_sde ] ) , but now the correlation structure of the noise @xmath192 is no longer given by the components of the noise in the slow directions @xmath220 .",
    "instead its correlation structure is that of the slow direction conditioned on the noise in the fast direction being zero ( see @xcite , appendix b ) : @xmath221 since the remainder of the reduced equation is identical to the expression arrived at through the projection matrix method , we can simply substitute this into the equation for @xmath212 , eq .",
    "( [ reduced_linear_covariance_projection ] ) , to find that the conditioning method predicts @xmath222_{ij } \\ , ,",
    "\\quad \\quad \\quad   \\ , i , j=1,\\ldots{r } \\ , .",
    "\\end{aligned}\\ ] ] comparing this with eqs .",
    "( [ reduced_linear_covariance_projection ] ) and ( [ comparing_limit_lyapunov ] ) we see that deterministically both methods reduce to the full system in the limit of @xmath217 for @xmath218 , but while the conditioning method gives a different expression for the noise correlations in the reduced subspace , the projection method gives precisely the right form of the correlations . from this",
    "we would expect that the projection matrix method provides a better approximation to the full variable system than conditioning .",
    "we would however expect the two methods to give similar results if the correlation between the fast and slow noise variables , @xmath223 , is small .",
    "numerical investigations show that these statements continue to hold when the techniques are applied to the metapopulation moran model .",
    "the projection matrix method gives a more accurate reduced description of the full system , as the conditioning method tends to underestimate the magnitude of the noise ( essentially a consequence of the term @xmath224 in eq .",
    "( [ conditioned_b_bar ] ) ) .",
    "however the results converge as the noise covariance between the fast and slow variables decreases .    in this section",
    "it has been shown that in the limit of an infinite timescale separation , the projection matrix method provides an exact description of the time - evolution of the slow variables in a linear fpe .",
    "while this only holds for linear systems , it goes some way to explaining the success of the methods in the region of a fixed point ( or line of fixed points , in the case of the center manifold ) .",
    "we have not addressed in a formal way however , how the fpe for a full non - linear system may collapse to the results obtained from the projection matrix method .",
    "a positive step in this direction would be to relate the method to others described in the literature , for instance the projection operator formalism used in the context of the fokker - planck equation  @xcite .",
    "nevertheless , given the accuracy of the results we have obtained , we would contend that there may be little need to include any additional contributions from the noise reduction , given the attendant increase in complexity of the formalism that this would entail .",
    "in this paper we have investigated a model of population genetics which included all of the four main evolutionary processes of mutation , genetic drift , natural selection , and migration between subpopulations , albeit in a simple model of a single locus in haploid individuals having two alleles .",
    "however even in this simple setting , it is extremely rare to find studies which include this range of processes , and we are not aware that the fpe containing all of these processes appears in the literature .",
    "of course , part of the reason why the fpe for such a general system has not been constructed is the general belief that it is in any case too complicated to work with , and extracting any meaningful prediction would be extremely difficult , if not impossible . we have shown here that this is not always the case : by using a fast - mode elimination procedure , we have been able to obtain an approximate expression for stationary pdf of this general fpe , which we showed to be in very good agreement with the results of numerical simulations of the original ibm .",
    "the method of fast - mode elimination ( which goes under many other names ) is widely used and has an extremely long history .",
    "essentially if there exist modes which decay on time scales which are short compared to those of interest to us , then we expect that we may be able to neglect their detailed dynamics and write down an effective theory in terms of only the ` slow modes ' .",
    "the particular variant that we use here is quite specific : it relies on the system under consideration having a deterministic limit which consists of a set of linear equations together with a small perturbation . specifically , the perturbations are the processes of mutation and selection which are described in terms are parameters @xmath225 and @xmath127 , which are sufficiently small that taylor expansions about the model with no mutation or selection can be truncated at first or second order",
    ". the model without mutation or selection is described by the deterministic equations @xmath226 , where @xmath66 is a constant matrix with a zero eigenvalue and @xmath227 label the islands of the metapopulation .",
    "all other eigenvalues of @xmath66 have a negative real part , and so as long as these are non - zero , one sees immediately that the deterministic system decays to the center manifold defined by the eigenvector of the zero eigenvalue .",
    "this picture does not change significantly if stochastic effects ( genetic drift ) or perturbations ( mutation and selection ) are added .    of course ,",
    "even if this broad picture does not change , it is the effects of genetic drift , mutation and selection that we are interested in , and it is necessary to develop a formalism to be able to calculate these effects .",
    "this has been the subject of the current paper in the case when mutation is present .",
    "we had previously introduced the method @xcite to deal with genetic drift , but without allowing for mutation . with the inclusion of stochasticity",
    ", it was found that an additional condition was needed to ensure the existence of a separation of timescales : the leading non - zero eigenvalue of @xmath66 , @xmath228 , must have a real part whose magnitude is larger than that of the fluctuations , @xmath229  @xcite , in order to ensure that the deterministic collapse to the center manifold is of sufficient strength to quench fluctuations away from it .",
    "of course , @xmath228 depends on the network structure , and future work could include trying to understand in more detail for what type of network a timescale separation will be present .",
    "for instance , it is clear that if the network consisted of two highly connected clusters , but which were only weakly coupled by migration to one another , the collapse to the center manifold may not occur fast enough for the approximation to be valid .",
    "however for a given network and island size structure , we can always calculate the magnitude of the real part of @xmath228 and check that it is not too small .    including the process of mutation means that the alleles do not fix , but instead their frequency tends to",
    "the stationary pdf previously mentioned .",
    "mutation rates in practice are sufficiently small that their effects need only be treated within a first order calculation . indeed this assumption , along with that of weak selection , is also essential to the fast - mode elimination procedure described in this paper . the parameters @xmath230 and @xmath127 must be small in order that the approximations based on the neutral model ( namely the existence of fast and slow directions ) are not invalidated .",
    "of course , determining precise limits for these parameters is a difficult task , especially for a system as general as that which we present .",
    "however , it is clear that the probability of mutation must be much lower than that of migration in order for the approximation to accurately capture the dynamics of the full system .",
    "we showed that the effect of mutation and selection to this order in our approximation scheme is equivalent to having a one - island ( well - mixed ) system with effective mutation rates which depend on the network structure and island size .    even within the quite specific framework we are working there",
    "are variations in the techniques and approaches used .",
    "one of these is the exact way that the noise terms in the sde are treated within the reduction procedure .",
    "we specifically examined two different ways of proceeding , and showed why the one we adopted was superior .",
    "our focus has been in obtaining simple effective models from rather complex population genetic models involving generic network structure .",
    "our aim has not been to provide a rigorous mathematical underpinning to the method detailed here , however when applied to the metapopulation moran model , it is hard to imagine the method performing better . in this sense",
    "we have shown that the more complex machinery involved in many fast - variable elimination techniques is not always entirely necessary . to a certain extent",
    ", the stochastic nature of the problems investigated contributes to the success of the techniques , as unimportant trends which the reduced model may not capture are averaged out when considering the ensemble .",
    "not least among the strengths of the method is that it can be applied to many other , more complex , problems in population genetics .",
    "in fact , most of the restrictions made in this paper can be lifted .",
    "for instance , we have already shown elsewhere that the constraint of having fixed island population sizes , inherent in the use of moran models , can be relaxed  @xcite , and we expect many other generalizations will be possible .",
    "we hope to explore and discuss these in future publications .",
    "in this appendix the diffusion approximation is outlined and applied to the metapopulation moran model with mutation and selection discussed in the main text . while in principle the dynamics for the process is given by eqs .",
    "( [ master ] ) and ( [ eq_rates_mutation_selection ] ) , in practice it is impossible to make analytical progress without making approximations .",
    "this usually involves making the diffusion approximation : replacing the discrete variables @xmath7 by @xmath231 .",
    "the assumption is made that @xmath14 is sufficiently large that @xmath84 can be assumed to be continuous .",
    "the form of the transition rates in eq .",
    "( [ eq_rates_mutation_selection ] ) is such that we can use the same procedure as in the neutral case ( discussed in appendix a of ref .",
    "@xcite ) , and so we drop the index on the rates , since the method is the same with and without mutation or selection .",
    "we begin by defining @xmath232 so that we may write the master equation ( [ master ] ) as @xmath233 \\nonumber \\\\ & + &   \\sum_{i=1}^{\\mathcal{d } } \\left [ f^{-}(x_{i}+\\frac{1}{\\beta_{i}n})p(x_{i}+\\frac{1}{\\beta_{i}n } ) - f^{-}_{i}(x_{i})p(x_{i},t ) \\right]\\ , , \\nonumber \\\\",
    "\\label{master_f}\\end{aligned}\\ ] ] where now @xmath234 is a function of @xmath235 and @xmath236 .",
    "the diffusion approximation then consists of performing a taylor series expansion in @xmath55 ( up to order @xmath237 ) of the terms in the sums in eq .",
    "( [ master_f ] ) , to obtain the fpe ( [ fpe ] ) of the main text with  @xcite @xmath238\\ , , \\nonumber \\\\ b_{ii}(\\bm{x } ) & = & \\frac{1}{\\beta^2_i}\\,\\left [ f^{+}_{i}(\\bm{x } )   + f^{-}_{i}(\\bm{x } ) \\right ] .",
    "\\label{aandb}\\end{aligned}\\ ] ]    as an example , we can use the transition rates for the neutral model given by eq .",
    "( [ eq_neutral_rates ] ) to calculate the @xmath239 . doing this , and then using eq .",
    "( [ aandb ] ) , gives @xmath240 where @xmath241 .",
    "the matrix @xmath242 , has been introduced since it is central to the understanding of the fast - mode elimination method discussed in section [ sec_mutation ] , and is defined as @xmath243 the neutral metapopulation moran model in the diffusion approximation is thus given by the fokker - planck equation ( fpe ) ( [ fpe ] ) , with a rather simple drift term ( eq .",
    "( [ neutral_a ] ) ) , but a more complex diffusion term ( eq .  ( [ neutral_b ] ) ) .",
    "the parameters of the model are @xmath244 and @xmath14 ; the probability of choosing island @xmath1 for the birth of an offspring , @xmath22 , is taken to be proportional to the population of that island : @xmath245 , and so is specified by @xmath246 . starting from eqs .",
    "( [ eq_rates_selection ] ) or ( [ eq_rates_mutation_selection ] ) for the transition rates with mutation and selection , and proceeding as above , gives us eqs .",
    "( [ a_general ] ) and ( [ b_general ] ) in the main text .",
    "in this appendix the removal of fast degrees of freedom from the neutral metapopulation moran model is illustrated .",
    "this is given by the sde system ( [ generalsde ] ) with @xmath88 and @xmath93 given by eqs .",
    "( [ neutral_a ] ) and ( [ neutral_b ] ) respectively .",
    "the system in itself is not trivial to solve : the multiplicative nature of the noise makes analytic progress difficult .",
    "however the deterministic dynamics are particularly simple .",
    "the deterministic system is not only entirely linear , but the structure of the matrix @xmath66 , defined in eq .",
    "( [ defineh ] ) , is such that each row sums to exactly zero .",
    "this allows one to show  @xcite that the largest eigenvalue of @xmath66 is zero , @xmath247 , and all other eigenvalues have negative real part .",
    "the deterministic system therefore quickly collapses along as set of directions specified by the right - eigenvectors @xmath248 to lie on a point in the direction @xmath77 , along which there are no further dynamics .",
    "this subspace is termed the center manifold , and it is this behavior which causes a separation of timescales between the dynamics occurs in the direction @xmath77 and the other directions . while this is not strictly true for the stochastic system , in which @xmath14 is finite , one would expect that for large enough @xmath14 this separation of timescales would still be present .",
    "this is indeed what has been found  @xcite ; the stochastic trajectories quickly collapse along the directions @xmath248 to the region of the center manifold .",
    "now however , rather than staying at one point on this line indefinitely , the stochastic dynamics move the system along the line , until fixation of one or other of the alleles occurs . to take advantage of this behavior ,",
    "we seek to systematically remove the fast - mode components of the system , while leaving the slow mode intact .    in the approach to fast - mode elimination that we use in this paper",
    ", we assume that there is no noise in the fast direction , so that both @xmath249 and @xmath61 are proportional to @xmath77 .",
    "since the entries of @xmath77 are all equal ( and we take them to be one ) , the equation of the center manifold is @xmath250 , and we denote this coordinate as @xmath86 .",
    "this procedure may be formalized by defining a projection operator  @xcite @xmath251 which when applied to any vector wipes out the fast directions @xmath76 for @xmath252 , but leaves the component along the direction @xmath77 , untouched .",
    "since @xmath77 has all entries equal to one , and using the orthonormality condition ( [ orthonormal ] ) , the projection operator reduces to @xmath253 , as given by eq .",
    "( [ defineprojection ] ) of the main text .    applying the projection operator to the sde ( [ generalsde ] )",
    "one finds that @xmath254 where @xmath255 and where the bar indicates evaluation on the center manifold . in the case of the neutral metapopulation model , @xmath256 , and so @xmath257 , since @xmath258 is a left - eigenvector of @xmath66 with eigenvalue zero .",
    "so the sde assumes the simple form @xmath259 , with @xmath260 a gaussian correlated white noise with zero mean and correlation function @xmath261 here @xmath262 which for the neutral metapopulation model becomes @xmath263^{2}g_{ik } \\beta_{i}^{-2 } \\equiv 2 b_{1 } z ( 1 - z)\\,,\\ ] ] where we have introduced the constant @xmath101^{2}g_{ik}\\beta_{i}^{-2}\\ , .",
    "\\label{b_1}\\ ] ]    applying this form of fast mode elimination therefore reduces the neutral metapopulation moran model to an effective well - mixed moran model of @xmath14 organisms , but with a noise strength which is increased by the factor of @xmath104 given in eq .",
    "( [ b_1 ] ) . finally , to completely define the reduced model , we need to give the initial value of the system on the center manifold . since the decay to the center manifold is largely deterministic , we simply take it to be the component of the full initial condition @xmath264 , along @xmath265 : @xmath266    the validity of the approximation has been explored in refs .",
    "@xcite and @xcite by finding the probability of an allele to fixate and the mean time for fixation to occur .",
    "these were found by carrying out gillespie simulations  @xcite of the original individual based model .",
    "they were then compared with the results from an analytic and numerical calculation of the reduced model .",
    "we now turn to the incorporation of other processes to this metapopulation model , such as selection and mutation .",
    "the effect of these processes is to break the degeneracy of the deterministic dynamics ( see eqs .",
    "( [ a_mutation ] ) and ( [ a_general_s ] ) ) ; there is no longer a line of fixed points defined by @xmath267 .",
    "this is needed in order to perform a linearization and so define the eigenvectors @xmath76 and @xmath75 , which are then used to characterize the fast and slow modes . to combat this",
    ", we assume that the nonlinear effects of mutation and selection are small enough that the left- and right - eigenvectors of @xmath66 remain a good approximation for the fast and slow directions .",
    "we may therefore continue to use eq .",
    "( [ general_slow_subspace ] ) to define the slow subspace onto which the system quickly relaxes ( but with @xmath88 taken from the system being considered ) and the projection matrix @xmath207 to remove the fast degrees of freedom from the model .",
    "throughout this paper , figures which show the stationary pdf of a metapopulation system are accompanied by the stationary pdf of the ` well - mixed unstructured analog ' of that system . in all these cases ,",
    "the well - mixed unstructured analog is taken to be a well - mixed system with the same total size as the structured model , and mutation rates corresponding the the average mutation rates across the structured population . denoting the well mixed parameters with a subscript @xmath268 ,",
    "this means the system size of the well - mixed analog may be expressed @xmath269 , while the mutation rates are the weighted means @xmath270 and @xmath271 .",
    "likewise , the selection parameters of the well - mixed system are taken to be the weighted means across the structured population ; @xmath272 and @xmath273    in fig .",
    "[ fig_enhance_bistable ] , the parameters used in the illustrated system are @xmath274 , @xmath275 , @xmath276 and @xmath277 the well - mixed unstructured analog system therefore has @xmath278 and @xmath279 .    in fig .",
    "[ fig_range_parameters ] ( a ) , the parameters used in the illustrated system are @xmath280 , @xmath275 , @xmath281 , @xmath282 , @xmath283 and @xmath284 the well - mixed unstructured analog system therefore has @xmath285 , @xmath286 and @xmath287 .    in fig .",
    "[ fig_range_parameters ] ( b ) , the parameters used in the illustrated system are @xmath288 , @xmath289 , @xmath290 , @xmath291 , @xmath292 and @xmath293 the well - mixed unstructured analog system therefore has @xmath294 and @xmath295 and @xmath296 .    in fig .",
    "[ fig_range_parameters ] ( c ) , the parameters used in the illustrated system are @xmath297 , @xmath289 , @xmath298 and @xmath299 the well - mixed unstructured analog system therefore has @xmath300 , @xmath301 and @xmath302 .    in fig .",
    "[ fig_range_parameters ] ( d ) , the parameters used in the illustrated system are @xmath303 , @xmath289 , @xmath304 and @xmath305 the well - mixed unstructured analog system is therefore taken to have @xmath306 , @xmath307 and @xmath308 .    in fig .",
    "[ fig_selection_range_parameters ] ( a ) , the parameters used are @xmath309 , @xmath310 , @xmath110 , @xmath311 , @xmath312 , @xmath313 and @xmath314 , @xmath315 , @xmath316 the well - mixed unstructured analog system therefore has @xmath317 , @xmath318 , @xmath319 , @xmath320 and @xmath321 .    in fig .",
    "[ fig_selection_range_parameters ] ( b ) , the parameters used are @xmath297 , @xmath322 , @xmath290 , @xmath323 , @xmath324 , @xmath325 and @xmath326 with @xmath327 the well - mixed unstructured analog system therefore has @xmath328 , @xmath329 , @xmath330 , @xmath331 and @xmath332 .    in fig .",
    "[ fig_selection_range_parameters ] ( c ) , the parameters used are @xmath303 , @xmath289 , @xmath281 , @xmath333 , @xmath334 , @xmath335 and @xmath336 , @xmath337 the well - mixed unstructured analog system therefore has @xmath338 , @xmath339 , @xmath319 , @xmath340 and @xmath341 .    in fig .",
    "[ fig_selection_range_parameters ] ( d ) , the parameters used are @xmath280 , @xmath322 , @xmath290 , @xmath342 , @xmath343 , @xmath344 and @xmath345 with @xmath346 the well - mixed unstructured analog system therefore has @xmath285 , @xmath347 , @xmath348 , @xmath349 and @xmath350 .    in the upper panel of fig .",
    "[ fig_mig_selec_balance ] , the parameters used are are @xmath274 , @xmath322 , @xmath281 , @xmath351 , @xmath352 , @xmath353 , and @xmath354 , @xmath355 the well - mixed unstructured analog system therefore has @xmath300 , @xmath356 , @xmath357 .    in the lower panel of fig .",
    "[ fig_mig_selec_balance ] , the parameters used are are @xmath274 , @xmath322 , @xmath290 , @xmath358 , @xmath334 , @xmath353 , and @xmath354 , @xmath359 the well - mixed unstructured analog system therefore has @xmath300 , @xmath356 , @xmath360 ."
  ],
  "abstract_text": [
    "<S> we construct an individual - based metapopulation model of population genetics featuring migration , mutation , selection and genetic drift . in the case of a single ` island ' </S>",
    "<S> , the model reduces to the moran model . using the diffusion approximation and timescale separation arguments , an effective one - variable description of the model </S>",
    "<S> is developed . </S>",
    "<S> the effective description bears similarities to the well - mixed moran model with effective parameters which depend on the network structure and island sizes , and is amenable to analysis . </S>",
    "<S> predictions from the reduced theory match the results from stochastic simulations across a range of parameters . the nature of the fast - variable elimination technique we adopt is further studied by applying it to a linear system , where it provides a precise description of the slow - dynamics in the limit of large timescale separation . </S>"
  ]
}