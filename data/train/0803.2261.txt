{
  "article_text": [
    "solar and stellar oscillations are a powerful tool to probe the interior of stars . in this paper",
    "we classify stellar oscillations into solar - like or deterministic .",
    "solar - like oscillations are stochastically excited by turbulent convection and are present in the sun and other main - sequence , subgiant , and giant stars ( see _ e.g. _",
    "@xcite , @xcite and references therein ) .",
    "deterministic oscillations are seen in classical pulsators and have mode lifetimes much longer than any typical observational run ; one of the best studied objects in this class is the pre - white dwarf pg1159@xmath2035 also known as gw  vir @xcite . in practice , observations of solar - like or deterministic pulsations always have an additional stochastic component due to instrumental , atmospheric , stellar , or photon noise .",
    "an important aspect of helio- and asteroseismology is the determination of the parameters of the global modes of oscillation , especially the mode frequencies . in the case of the sun , it is known @xcite that the measurement precision is limited by the stochastic nature of the oscillations ( realization noise ) . and have shown that realization noise is expected to scale like @xmath3 , where @xmath0 is the total duration of the observation . a common practice is to extract the solar mode parameters from the power spectrum using maximum likelihood estimation ( mle , see _",
    "e.g. _  ; ; ; ; ) . in its current form ,",
    "however , this method of analysis is only valid for uninterrupted time - series .",
    "this is a significant limitation because gaps in the data are not uncommon ( daily cycle , bad weather , technical problems ) .",
    "the gaps complicate the analysis in fourier space : the convolution of the data with the observation window leads to correlations between the different fourier components .",
    "the goal of this paper is to extend the fourier analysis of solar and stellar oscillations to time series with gaps , using appropriate maximum likelihood estimators based on the correct statistics of the data .",
    "section  [ section : problem ] poses the problem of the analysis of gapped time series in fourier space . in section  [ section : pdf_correlation ] we derive an expression for the joint probability density function ( pdf ) of the observations , taking into account the frequency correlations .",
    "our answer is consistent with an earlier ( independent ) derivation by .",
    "based on this pdf , we derive maximum likelihood estimators in section  [ section : likelihood_estimation ] . in section  [ section : fitting_nocorr ]",
    "we recall the `` old method '' of maximum likelihood estimation based on the unjustified assumption that frequency bins are statistically independent .",
    "section  [ section : test_setup ] explains the set up of the monte - carlo simulations , used to test the fitting methods on artificial data sets . in section",
    "[ section : fitting_results ] we present the results of the monte - carlo simulations and compare the new and old fitting methods . for the sake of simplicity",
    ", we consider only one mode of oscillation at a time ( solar - like or sinusoidal ) .",
    "we present several cases for which our new fitting method leads to a significant improvement in the determination of oscillation parameters , and in particular the mode frequency .",
    "let us denote by @xmath4 the time series that we wish to analyse .",
    "it is sampled at times @xmath5 , where @xmath6 is an integer in the range @xmath7 , and @xmath8  one minute is the sampling time .",
    "all quantities with a tilde are defined in the time domain .",
    "the total duration of the time series is @xmath9 . by choice ,",
    "all of the missing data points were assigned the value zero : this enables us to work on a regularly sampled time grid .",
    "formally , we write @xmath10 where @xmath11 is the uninterrupted time series that we _ would _ have observed if there had been no gaps and @xmath12 is the window function defined by @xmath13 if an observation is recorded at time @xmath14 and @xmath15 otherwise .",
    "the @xmath11 is drawn from a random process , whose statistical properties will be discussed later .",
    "we define the discrete fourier transform @xmath16 of @xmath17 by @xmath18 where @xmath19 is the frequency and @xmath20 .",
    "note that @xmath21 and @xmath22 , where the star denotes the complex conjugate .",
    "the fourier transform has periodicity @xmath23 or twice the nyquist frequency .",
    "our intention is not to fit the complete fourier spectrum , but a rather small interval that contains one ( or a few ) modes of stellar oscillation .",
    "thus , we extract a section of the data of length @xmath24 starting from a particular frequency @xmath25 , as shown in figure  [ fig : convolution_scheme](c ) .",
    "this subset of the data is represented by the vector @xmath26^t$ ] with components @xmath27 using the above definition of the fourier transform , the vector @xmath28 is given by the convolution of @xmath29 with the window @xmath30 : @xmath31 the integer @xmath32 in equation ( [ equ : fourier_elements ] ) refers to the cutoff frequency @xmath33 beyond which the observation window has no significant power .",
    "truncating the window function at frequency @xmath33 is a simplification of the general problem .",
    "our main goal , however , is , given a known window function , to study its effects on the determination of the parameters of stellar oscillations .",
    "figure [ fig : convolution_scheme ] is a schematic representation in fourier space of the convolution of a single mode of oscillation by the window function .",
    "the observed signal is spread over some frequency range and , as we shall see later , its statistical properties are affected .",
    "we note that , in practice , one can never completely isolate one single mode of oscillation in the power spectrum .",
    "in particular , other modes with frequencies outside of the fitting range can leak into it after convolution by the temporal window function . hence , fitting one mode of oscillation is a simplification .",
    "but our first objective is to try to study the effects of gaps , independently from the complications associated with a badly specified model .     with the window function @xmath30 .",
    "for the sake of simplicity , only the power spectra of the different quantities are shown here .",
    "panel ( a ) shows the window function @xmath30 and its cutoff frequency @xmath33 , panel ( b ) the unconvolved signal @xmath29 , and panel ( c ) the observed signal @xmath16 .",
    "note that the selected section of the observed signal , starting at frequency @xmath33 , is of length @xmath24 , while the unconvolved signal is of length @xmath34 .",
    ", scaledwidth=95.0% ]    equation ( [ equ : fourier_elements ] ) can be rewritten in matrix form as @xmath35 where the vector @xmath36^t$ ] of length @xmath37 is defined by @xmath38 and @xmath39 $ ] is the @xmath40 rectangular window matrix with elements @xmath41 , where @xmath42 and @xmath43 : @xmath44 .",
    "\\label{equ : windowmatrix}\\ ] ] note that @xmath45 and that @xmath46 is of rank @xmath24 .",
    "equation  ( [ equ : fourier_signal ] ) is the master equation .",
    "our goal is to extract the stellar oscillation parameters ( contained in @xmath47 ) , given the uncomplete information @xmath28 .",
    "here we describe the basic assumptions that we make about the statistics of the data in the fourier domain .",
    "the unconvolved signal [ @xmath47 ] consists of a deterministic component [ @xmath49 and a zero - mean stochastic component [ @xmath50 such that @xmath51 the deterministic component @xmath52 may include deterministic stellar oscillations that are long - lived compared to the total length of the observation .",
    "the stochastic component @xmath53 may include various sources of noise ( _ e.g. _ stellar convection , photon noise , atmospheric noise , _ etc . _ ) and stochastically excited pulsations as observed on the sun .",
    "we assume that the @xmath54 are @xmath37 independent random variables in the fourier domain .",
    "this is equivalent to saying that the stochastic component of the signal in the time domain is stationary .",
    "we further assume that @xmath53 is a gaussian random vector with independent real and imaginary parts and covariance matrix @xmath55=\\sigma_i^2 \\delta_{ij } , \\quad i , j = 0,1,\\dots , m+2p-1 , \\label{equ : sigma^2}\\ ] ] where @xmath56 denotes the expectation value and @xmath57 is the standard deviation of @xmath54 at frequency @xmath58 .",
    "one may invoque the central limit theorem to justify the choice of gaussian distributions .",
    "the quantity @xmath59 is the expected power spectrum at frequency @xmath58 , which may include background noise and peaks corresponding to the modes of oscillations @xcite . in terms of a complex gaussian random vector @xmath60 with unit covariance matrix , @xmath61=i_{m+2p}$ ]",
    ", we can rewrite @xmath53 as @xmath62 where @xmath63 is the @xmath64 diagonal matrix @xmath65 we emphasize that , although the @xmath54 are uncorrelated random variables , the @xmath66 are correlated because of the multiplication of @xmath47 by the window matrix [ equation  ( [ equ : fourier_signal ] ) ] .",
    "in this section we derive an expression for the joint probability density function of the observed signal @xmath28 .",
    "this problem had already been solved by .",
    "we reach the same conclusion , independently and with more compact notations .",
    "we start by rewriting the master equation , equation ( [ equ : fourier_signal ] ) , as @xmath67 where @xmath68 is a @xmath69 matrix with rank @xmath24 and singular value decomposition @xcite @xmath70 here the superscript @xmath71 denotes the hermitian conjugate and @xmath72 and @xmath73 are unitary matrices of dimensions @xmath74 and @xmath64 respectively , _",
    "i.e. _ @xmath75 and @xmath76 .",
    "the @xmath69 matrix @xmath77 can be written as @xmath78 , \\quad \\lambda=\\mbox{diag}(\\lambda_0,\\lambda_1 , \\dots , \\lambda_{m-1 } ) ,    \\label{equ : svd}\\ ] ] where @xmath79 are the @xmath24 ( positive ) singular values of the matrix @xmath80 .",
    "thus , there exists a vector @xmath81 such that @xmath82 \\xi .",
    "\\label{equ : fourier_signal_xi}\\ ] ] since @xmath60 has unit covariance matrix and @xmath73 is unitary , the vector @xmath83 is a complex gaussian random vector of size @xmath37 with unit covariance matrix .",
    "it is obvious from equation  ( [ equ : fourier_signal_xi ] ) that there exists a lower - rank complex gaussian random vector of length @xmath24 , @xmath84^t$ ] , such that @xmath85 the variables @xmath86 are dummy variables , which do not enter in the description of @xmath28 .",
    "equation  ( [ equ : signalll ] ) is an important step , as the vector @xmath28 of length @xmath24 is now expressed in terms of @xmath24 independent complex gaussian variables .",
    "this enables us to write the pdf of @xmath28 as @xmath87 where @xmath88 denotes the pdf of @xmath89 and @xmath90 is the jacobian of the linear transformation @xmath91 . since @xmath89 is a complex gaussian random vector with unit covariance , _",
    "i.e. _ @xmath92=i_m$ ] , we have @xmath93 where we used the notation @xmath94 . since @xmath72 is unitary and @xmath95 is diagonal and real , the jacobian of the transformation is given by @xmath96 combining equations  ( [ equ : pdf_transorm ] ) , ( [ eq.pdf_eta ] ) , and ( [ equ : jacobian ] ) , we get the joint pdf of the observed vector @xmath28 : @xmath97 the above expression is , perhaps , more elegantly written as @xmath98 in terms of @xmath99 , the @xmath100 moore - penrose generalized inverse of @xmath80 @xcite,@xmath101 where @xmath102 is the transpose of @xmath77 in which the singular values are replaced by their inverse .",
    "one may ask , after the fact , if the quantity @xmath103 in equation ( [ equ : pdf_transorm ] ) is always defined . the answer would appear to be yes since the moore - penrose generalised inverse of @xmath80 is perfectly well defined .",
    "it is not excluded , however , that some singular values @xmath104 could be infinitesimally small .",
    "we have not encountered any such difficulty with the test cases given in section [ section : fitting_results ]",
    ". should @xmath80 be ill - conditioned in other cases , a simple truncated svd would help avoiding a numerical problem .    before discussing the implementation of the method in section  [ section : likelihood_estimation ] , we should like to draw attention to a parallel between fitting data with temporal gaps and fitting data with spatial gaps .",
    "in order to understand this analogy , we refer the reader to the work of @xcite ( 1998 , section 3.3.4 ) who discuss how to interpret the spatial leaks of non - radial oscillations that arise from the fact that only half of the solar disk can be observed from earth .",
    "their approach is similar to the one developed in this paper .",
    "let us assume that the stellar oscillation model that we are trying to fit to the data depends on a set of @xmath105 parameters @xmath106 .",
    "these parameters may be the amplitude , the phase , the frequency , the line asymmetry , the noise level , _ etc_. the basic idea of maximum likelihood estimation is to pick the estimate @xmath107 that maximizes the likelihood function . the likelihood function is another name for the joint pdf [ equation  ( [ equ : pdf ] ) ] evaluated for the sample data . in practice ,",
    "one minimizes @xmath108 rather than maximizing the likelihood function itself . in the above expression , the quantities @xmath99 and @xmath104 all depend implicitly on the model parameters @xmath109 through the covariance matrix @xmath63 .",
    "the vector @xmath52 also depends on the model parameters in the case deterministic oscillations .",
    "the probability of observing the sample data is greatest if the unknown parameters are equal to their maximum likelihood estimates @xmath110 : @xmath111 the method of maximum likelihood has many good properties @xcite . in particular , in the limit of a large sample size ( @xmath24 large ) , the maximum likelihood estimator is unbiased and has minimum variance .",
    "what is particularly new about our work is the minimization of the likelihood function given by equation  ( [ equ : likelihood ] ) .",
    "we use the direction set method , or powell s algorithm , to solve the minimization problem with a computer . in practice ,",
    "the result of the fit depends on the initial guess and the fractional tolerance of the minimisation procedure ( the relative decrease of @xmath112 in one iteration ) .",
    "the dependence of the fitted parameters on the initial guess is due to the fact that the function @xmath112 may have local minima in addition to the global minimum .",
    "we will address this issue in more detail in section [ section : fitting_results ] .      in the case of solar - like oscillations",
    ", there is no deterministic component and the log - likelihood becomes @xmath113      if background white noise is the only stochastic component then @xmath114 the log - likelihood function becomes @xmath115 splitting the unknowns @xmath116 into the parameters describing the oscillations , @xmath117 and the noise level @xmath118 , the minimization problem reduces to finding the most likely estimates @xmath119 where @xmath120 .",
    "the noise level is explicitly given by @xmath121 \\| .\\ ] ]",
    "maximum likelihood estimation has been used in the past to infer solar and stellar oscillation parameters , even in the case of gapped time series .",
    "the joint pdf of the observations was assumed to be the product of the pdfs of the individual @xmath66 , as if the frequency bins were uncorrelated . for comparison purposes",
    ", we briefly review this ( unjustified ) approach .    according to equation  ( [ equ : fourier_signal_2 ] ) ,",
    "the pdf of @xmath66 is a normal distribution @xmath122 with mean @xmath123 and variance @xmath124 under the ( wrong ) assumption that the @xmath66 are independent random variables , the joint pdf of @xmath28 becomes @xmath125 where the superscript `` nc '' stands for `` no correlation '' .",
    "this joint pdf uses the correct mean ( @xmath126 ) and variance ( @xmath127 ) of the data , but it ignores all the non - vanishing cross - terms @xmath128 $ ] . in other words , the spread of power implied by the convolution with the window is taken care of , but not the proper statistics .",
    "under the same simplifying `` no correlation '' assumption , the log - likelihood function is @xmath129 where the @xmath126 and @xmath127 are implicit functions of the model parameters @xmath109 .      if the signal has no deterministic component ( @xmath130 ) , then the power spectrum [ @xmath131 has the expectation value @xmath132= v_i$ ] .",
    "thus , in the case of purely solar - like oscillations , we recover the standard expression @xcite : @xmath133 while the above expression is perfectly valid for uninterrupted data , it is not justified when gaps are present .",
    "the parameters @xmath134 that minimize @xmath135 are not optimal , as will be shown later using monte - carlo simulations .",
    "when @xmath136 , the `` no - correlation '' log - likelihood function simplifies to @xmath137 the minimization problem becomes @xmath138 where @xmath139 depends on the oscillation parameters @xmath117 .",
    "the noise level is explicitly given by @xmath140",
    "so far we have considered a general signal which includes a deterministic component and a stochastic component .",
    "the parametrisation of each component depends on prior knowledge about the physics of the stellar oscillations .",
    "solar - like pulsations are stochastic in nature and no deterministic component is needed in this case . on the other hand ,",
    "long - lived stellar pulsations are treated as deterministic .",
    "some stars may support both deterministic and stochastic oscillations . in this section , we model the two cases separately .",
    "we want to test the fitting method [ equations ( [ equ : likelihood ] ) and ( [ equ : likelihood - estimator ] ) ] by applying it to simulated time series with gaps . for comparison",
    ", we also want to apply the old fitting method ( section  [ section : fitting_nocorr ] ) to the same time series .",
    "we need to generate many realizations of the same random process in order to test the estimators for bias and precision : this is called monte - carlo simulation . in section",
    "[ section : window_function ] we discuss the generation of the synthetic window functions .",
    "we then discuss the parametrisation of the solar - like oscillations ( section  [ section : model_solar_like ] ) and the deterministic oscillations ( section  [ section : model_deterministic ] ) used to simulate the unconvolved signal .      ]",
    "used in this paper . from top to bottom , the duty cycle is ( a ) 100% , ( b ) 66% , ( c ) 30% , and ( d ) 15% .",
    "the main periodicity of the window is 24 hours for cases ( b ) and ( c ) , and 48  hours for window ( d ) .",
    "all windows are truncated at frequency @xmath141  @xmath109hz.,scaledwidth=80.0% ]    we generate three different observation windows , corresponding to different duty cycles .",
    "the observation windows are first constructed in the time domain . by definition , @xmath142",
    "is set to one if an observation is available and zero otherwise .",
    "the total length of all time series is fixed at @xmath143 days ( frequency resolution @xmath144hz ) .",
    "a window function is characterized by two main properties : the duty cycle ( fraction of ones ) and the average periodicity .",
    "a typical window function for a single ground - based site has a 24-hour periodicity . in order to deviate slightly from purely periodic window functions we introduce some randomness for the end time of each observation block .",
    "figure  [ figure : windowfunction](b)(d ) shows the power spectra of the three window functions .",
    "the first and second window functions have a main periodicity of 24  hours and duty cycles of @xmath145 and @xmath146 respectively .",
    "two side lobes occur at frequencies @xmath147hz and @xmath148hz . the non - vanishing power between the side lobes is due to the deviation from a purely periodic window .",
    "the third window function has a main periodicity of 48  hours and a duty cycle of only 15% .",
    "all of these window functions are not unrealistic .",
    "we apply a sharp low - pass filter at frequency @xmath141  @xmath109hz ( @xmath149 ) to all window functions .",
    "the power at higher frequencies corresponds to about 5% of the total power in the windows .",
    "this truncation is needed to apply the fitting algorithm , which assumes that there exists a frequency @xmath33 beyond which the power in the window vanishes , _",
    "i.e. _ that the window function is band limited .",
    "we generate the realizations of the unconvolved solar - like oscillation signal directly in the fourier domain .",
    "we consider a purely stochastic signal ( @xmath130 ) and a single mode of oscillation .",
    "since we assumed stationarity in the time domain , the fourier spectrum of the unconvolved signal for one single mode can be written as @xmath150^{1/2 } \\eta_i , \\quad i=0,1,\\dots , m+2p-1 , \\ ] ] where @xmath151 describes the line profile of the mode in the power spectrum , @xmath152 is the mode s maximum power , @xmath153 is the variance of the background noise , and @xmath154 is a centered complex gaussian random variable with unit variance and independent real and imaginary parts .",
    "solar - like oscillations are stochastically excited and intrinsically damped by turbulent convection @xcite .",
    "the expectation value of the power spectrum is nearly lorentzian , except for some line asymmetry ( _ e.g. _ , ) . here",
    "we use a simple asymmetric line profile : @xmath155 where @xmath156 is the resonant frequency , @xmath157 is the asymmetry parameter of the line profile ( @xmath158 ) , and @xmath159 is a measure of the width of the line profile .",
    "we refer to @xmath160 as the signal - to - noise ratio in the power spectrum .",
    "as @xmath157 tends to zero , @xmath159 becomes the full width at half maximum ( fwhm ) of the power spectrum and @xmath161 the mode lifetime .",
    "there are five model parameters , @xmath162 .",
    "once the unconvolved signal @xmath47 has been generated in the fourier domain , the observed signal @xmath28 is obtained by multiplication with the window matrix @xmath46 , as explained above .      in the time domain , we consider a purely sinusoidal function on top of white background noise : @xmath163 the first term describes the deterministic component of the signal , where @xmath164 is the amplitude , @xmath156 the mode frequency , and @xmath165 the phase of the mode .",
    "the second term is stochastic noise with standard deviation @xmath166 .",
    "the @xmath167 are @xmath168 normally distributed independent real random variables with zero mean and unit variance . the observed signal is obtained by multiplying @xmath169 by the window @xmath142 in the time domain .",
    "the model parameters are @xmath170 .",
    "we have defined the signal and the noise in the time domain , but a definition of signal - to - noise ratio in the fourier domain is desirable . on the one hand ,",
    "the variance of the noise in the fourier domain is @xmath171 where @xmath172 is the total power in the window . on the other hand ,",
    "the maximum power of the signal in fourier space is @xmath173 , where @xmath174 is the power of the window at zero frequency .",
    "thus , by analogy with the solar - like case , it makes sense to define the signal to noise ratio in the fourier domain as @xmath175 in practice we fix @xmath164 and @xmath160 and deduce the corresponding noise level @xmath166 .",
    "several hundreds of realizations are needed in order to assess the quality of a fitting method .",
    "we do not intend to test all possible combinations of mode parameters but we want to show a few cases for which the new fitting method provides a significant improvement compared to the old fitting method .",
    "figure  [ fig : realization_fit_stoch ] shows one realization of a simulated mode of solar - like oscillation with input parameters @xmath176  @xmath109hz , @xmath177  @xmath109hz , @xmath178 , @xmath179 , and @xmath180 . the signal to noise ratio is @xmath181 and the window function is 30% full ( see figure  [ figure : windowfunction](c ) ) . the mode lifetime is @xmath182  hours . figure  [ fig : realization_fit_stoch](a ) displays the real and imaginary parts of the fourier transform @xmath28 , together with the standard deviation of the data ( nc fit in blue , new fit in red , expectation value in green ) .",
    "figure [ fig : realization_fit_stoch](b ) shows the power spectrum and the fits .",
    "notice the sidelobes introduced by the convolution of the signal with the window functions .",
    "the `` no - correlation '' fit is done on the power spectrum [ equation  ( [ eq.nc ] ) ] , while the new fit is performed in complex fourier space [ equation  ( [ equ : likelihood ] ) ] .",
    "hz , linewidth @xmath183hz , and @xmath181 .",
    "the window function is 30% full .",
    "panel ( a ) shows the real and imaginary parts of the fourier spectrum .",
    "panel ( b ) shows the power spectrum .",
    "the vertical dashed lines represent the width of the window function .",
    "also shown are the new fit ( red ) , the old fit ( blue ) , and the expectation value ( green ) . ]    each fit shown in figure  [ fig : realization_fit_stoch ] corresponds in fact to the best fit out of five fits with different initial guesses . for each realization",
    ", we use the frequency guesses @xmath184  @xmath109hz for @xmath156 .",
    "the last two frequency guesses correspond to the frequencies of the two main sidelobes of the window function ( figure  [ figure : windowfunction]c ) . for the other parameters , we choose random guesses within @xmath185% of the input values .",
    "the reason for using several guesses is to ensure that the fit converges to the global maximum of the likelihood , not to a nearby local maximum , _",
    "i.e. _ that the estimates returned by the code are the mle estimates defined by equation  ( [ equ : likelihood - estimator ] ) . in some cases , the global maximum coincides with a sidelobe at @xmath186  @xmath109hz from the main peak .",
    "we note that the new fitting method requires a much longer computing time than the old nc method : typically , three hours on a single cpu core for a single realization ( five guesses , five fits ) .    for the particular realization of figure  [ fig : realization_fit_stoch ] ,",
    "the new fit is closer to the expectation value ( _ i.e. _ is closer to the answer ) than the old nc fit .",
    "no conclusions should be drawn , however , from looking at a single realization .    in order to test the reliability of each fitting method",
    ", we computed a total of 750 realizations with the same input parameters as in figure  [ fig : realization_fit_stoch ] and the same window function ( 30% full ) .",
    "the quality ( bias and precision ) of the estimators can be studied from the distributions of the inferred parameters . as shown by the distributions of figure  [ fig : distr_stoch_sn30_wa ]",
    "the new fitting method is superior to the old nc method .",
    "this is true for all the parameters , in particular the mode frequency @xmath156 .",
    "the distributions for the mode frequency ( figure  [ fig : distr_stoch_sn30_wa](a ) ) are quite symmetric and gaussian - like , although the old fitting method leads to a significant excess of values beyond the two-@xmath187 mark .",
    "we note that , in general , the old fitting method is more sensitive to the initial frequency guess .",
    "also the estimates of the linewidth @xmath159 and the mode power @xmath152 are significantly more biased with the old fitting method than with the new one ( figures  [ fig : distr_stoch_sn30_wa]b , [ fig : distr_stoch_sn30_wa]c ) .",
    "it is worth noting that the fits return a number of small @xmath159/large @xmath152 estimates away from the main peaks of the distributions , less so for the new fits .",
    "these values correspond to instances when the signal barely comes out of the noise background .",
    "the new fit returns the noise level [ @xmath153 ] with a higher precision and a lower number of underestimated outliers than the old method ( the ouliers are represented by the vertical bars in figure  [ fig : distr_stoch_sn30_wa](d ) ) . although the estimation of the asymmetry parameter is unbiased with the new fitting method ( figure  [ fig : distr_stoch_sn30_wa](e ) ) , the uncertainty on @xmath157 is so large that it probably could have been ignored in the model .    , ( b ) linewidth @xmath159 , ( c ) mode power @xmath152 , ( d ) noise level @xmath153 , and ( e ) asymmetry parameter @xmath157 . the black lines show the results obtained with the new fitting method and the grey lines show the old `` no - correlation '' fits .",
    "the vertical dashed line in each plot indicates the input value .",
    "the horizontal lines in panel ( a ) are intervals containing 68% of the fits for the new ( black line ) and the old ( grey line ) fitting methods .",
    "the thick black and grey vertical lines in panel ( d ) give the numbers of outliers with @xmath189 . ]",
    "quantitative estimates of the mean and the dispersion of the estimators are provided in table  1 . because the distributions of the estimated parameters are not always gaussian and may contain several outliers , we compute the median ( instead of the mean ) and the lower and upper bounds corresponding to @xmath190% of the points on each side of the median ( instead of the one-@xmath187 dispersion ) .",
    "this definition has the advantage of being robust with respect to the outliers .",
    "the notation @xmath191",
    "@xmath109hz in the first row of table  [ table : freq_uncertainty ] means that the median mode frequency is @xmath192  @xmath109hz and that @xmath193 of the fits belong to the interval @xmath194 $ ]  @xmath109hz .",
    "we emphasize that the subscript @xmath195 and the superscript @xmath196 do not refer to an uncertainty in the determination of the median : the median is known to a much higher precision thanks to the large number of realizations .",
    "later we relax the language and refer to the `` one-@xmath187 uncertainty '' to mean the average @xmath197 .",
    "rrrr mode parameter & input value & new fitting & old fitting +   + @xmath156 [ @xmath109hz ] & @xmath192 & @xmath198 & @xmath199 + @xmath200)$ ] & @xmath201 & @xmath202 & @xmath203 + @xmath204 & @xmath205 & @xmath206 & @xmath207 + @xmath208 & @xmath209 & @xmath210 & @xmath211 + @xmath157 & @xmath212 & @xmath213 & @xmath214 +    the numbers from the last two columns in table  1 confirm the analysis of figure  [ fig : distr_stoch_sn30_wa ] .",
    "the mode frequency can be measured with a precision of @xmath215  @xmath109hz , which is exactly twice better with the new fitting method than with the old one .",
    "this gain in precision is very significant and potentially important .",
    "since measurement uncertainty scales like @xmath216 @xcite , one may equate the gain in using the proper fitting procedure to an effective increase in the total length of the time series by a factor of four .",
    "as seen in table  1 , the linewidth , the mode power , the background noise , and the line asymmetry parameter are all less biased and more precise with the new fitting method than the old one .",
    "notice that the larger dispersions in the old - fit case are due in part to non - gaussian distributions with extended tails .",
    "@xmath109hz , title=\"fig : \" ] +  @xmath109hz , title=\"fig : \" ]    cccccc & + duty cycle & main period & average gap & new fitting & old fitting +   + 100% &  &  & @xmath217 & @xmath217 + 66% & 24  hours & 7.4  hours & @xmath218 & @xmath219 + 30% & 24  hours & 16.4  hours & @xmath220 & @xmath221 + 15% & 48  hours & 40.7  hours & @xmath222 & @xmath223 +    ] as a function of the window duty cycle [ @xmath224 .",
    "the window functions are as defined in section  [ section : window_function ] .",
    "the red curve shows the 1-@xmath187 monte - carlo mle uncertainties for the new fitting method .",
    "the black curve shows the 1-@xmath187 monte - carlo mle uncertainties for the old no - correlation fitting method .",
    "the blue curves show the mean cramr - rao lower bounds ( formal error bars ) .",
    "the square symbol with a cross at @xmath225 in the left panel is a rough estimate ( see text ) . in the left panel ,",
    "the input linewidth is @xmath177  @xmath109hz ( see also numbers in table 1 ) . in the right panel , the input linewidth is @xmath226  @xmath109hz , all of the other parameters being the same as in the left panel . in both panels",
    "the signal - to - noise ratio is @xmath181 . for reference ,",
    "the dashed lines have slope @xmath227 . ]      here we study how bias and precision change as the window function changes , in particular as the duty cycle changes .",
    "we consider the four window functions defined in section [ section : window_function ] with duty cycles [ @xmath224 equal to 15% , 30% , 66% , and 100% .",
    "first we consider input parameters of solar - like oscillations that are exactly the same as in the previous section : @xmath176  @xmath109hz , @xmath177  @xmath109hz , @xmath178 , @xmath181 , and @xmath180 . figure  [ fig : distribution_window ] shows the distributions of the inferred mode frequencies and linewidths , using the old ( figures  [ fig : distribution_window]a , [ fig : distribution_window]b ) and the new ( figures  [ fig : distribution_window](c ) , [ fig : distribution_window](d ) ) fitting methods .",
    "each fit is the best fit from five different @xmath156 guesses ( see section [ sec : results_solar_like ] ) .",
    "the distributions for the 100%-window are identical for the two fitting methods ; this is expected since the old and new fitting methods are equivalent in the absence of gaps .    the precision on @xmath156 using the old `` no - correlation '' mle drops fast as the duty cycle decreases ( figure  [ fig : distribution_window](a ) ) .",
    "this drop is much faster than in the case of the fits that take the frequency correlations into account ( figure  [ fig : distribution_window](c ) ) . when the duty cycle is @xmath228 , the frequency estimate is five times better with the new than the old method .",
    "the difference is perhaps even more obvious for the linewidth .",
    "for the 15% window , it is almost impossible to retrieve @xmath159 with the old fitting method ( figure [ fig : distribution_window]b ) , while the new method gives estimates that are almost as precise as in the no - gap case ( figure  [ fig : distribution_window]d ) .",
    "the estimates of @xmath159 are significantly less biased with the new method .",
    "figure  [ fig : distribution_window ] confirms the importance of using the correct expression for the likelihood function .",
    "table  [ table : freq_uncertainty2 ] gives the medians and half - widths of the @xmath156 distributions .",
    "the one-@xmath187 dispersions are plotted as a function of the duty cycle @xmath229 in the left panel of figure  [ fig : sigma_nu0 ] .",
    "the improvement in the fits is quite spectacular .",
    "for example , when @xmath230 the dispersion on @xmath156 is five times less with the new fitting method ( @xmath231  @xmath109hz vs. @xmath232  @xmath109hz ) .    with the old method ,",
    "the uncertainty on @xmath156 increases much faster than @xmath227 as the duty cycle @xmath229 drops ( @xmath233 between the 30% and 15% windows ) . this steep dependence on @xmath229 is worse than `` predicted '' by . in his paper , libbrecht suggested to use the uncertainty @xmath234 where @xmath235 ^ 3 $ ] and @xmath236 is an `` effective '' noise - to - signal ratio .",
    "he suggested that the main effect of the gaps is to increase the noise - to - signal ratio @xmath237 , presumably by a factor @xmath238 , itself proportional to @xmath239 .",
    "this leads however to a dependence of @xmath240 on @xmath229 which , in our particular case , is closer to @xmath227 than @xmath241 .",
    "we suspect that the libbrecht formula underestimates the dispersion because it ignores the frequency correlations .",
    "the new fitting method returns a @xmath156 uncertainty that is much less sensitive to the duty cycle , with a variation like @xmath242 ( red curve , left panel of figure  [ fig : sigma_nu0 ] ) .",
    "this is quite remarkable . that the frequency uncertainty could remain nearly constant for @xmath243 is not really surprising since the average gap ( see numbers in table  2 ) is less than the mode lifetime @xmath244  hours",
    "this regime was studied by using a gap - filling method : as long as the signal - to - noise ratio is large enough , the signal can be reconstructed .",
    "why the new fit is doing such a good job for duty cycles @xmath245 is , however , puzzling ( at first sight ) , since the average gap ( @xmath246  hours ) is larger than the mode lifetime .",
    "this can be understood as follows . for small duty cycles ,",
    "the time - series is effectively a collection of nearly independent blocks of data , which , for the 30% window function , are eight - hour long on average . since mle simulations tell us that the uncertainty on the mode frequency for an uninterrupted series of eight hours is about @xmath247  @xmath109hz , we would expect for the gapped time series ( @xmath143  days , 24-hour periodicity ) to be able to reach the uncertainty @xmath248  @xmath109hz .",
    "this value , represented by the box with a cross in figure  6 , is found to be very close to the mle estimate from the new fits .",
    "hence , what matters at very low duty cycle is the number of independent blocks of continuous data .",
    "the new fitting method captures this very well , which is satisfying . by comparison",
    ", the old no - correlation fitting method does poorly ( black line ) .    in order to further investigate this last point , we ran another set of simulations using a mode linewidth @xmath249hz corresponding to a mode lifetime @xmath250  hours , which is significantly smaller than the average gap lengths of the 30% and the 15% windows .",
    "the other input parameters remained the same as above .",
    "we computed and fitted 1350 realizations .",
    "the results are shown in the right panel of figure  6 .",
    "for the new fitting method , the dependence of the frequency uncertainty on the duty cycle is about @xmath251 , which is comparable to the previous simulations with @xmath177  @xmath109hz .",
    "we conclude that it is really worth solving for the correct minimization problem and that fitting for the phase information in complex fourier space is important to get a good match between the model and the data . of course",
    ", this can only be done properly when we have a perfect knowledge of the model , which is the case with these numerical simulations , but is rarely the case with real observations .",
    "@xmath109hz ( see figure 5c ) and the right panel is for @xmath226  @xmath109hz .",
    "the different curves correspond to different window functions , as indicated in the legend .",
    "the means of these distributions ( cramr - rao lower bounds ) give the blue curves plotted in figure  [ fig : sigma_nu0 ] . ]",
    "monte - carlo simulations are very useful in order to assess the variance and the bias of a particular estimator .",
    "when fitting real observations , however , the variance of the estimator can not be computed directly by monte - carlo simulation since the input parameters are , by definition , not known .",
    "hopefully , the fit can return a formal error from the shape of the likelihood function in the neighborhood of the global maximum .",
    "the cramr - rao lower bound @xcite achieves minimum variance among unbiased estimators .",
    "it is obtained by expanding @xmath112 about its minimum .",
    "the formal error @xmath252 on the parameter @xmath253 is given by @xmath254 where @xmath255 is the @xmath6th element on the diagonal of the inverse [ @xmath256 of the hessian matrix with elements @xmath257 the cramr - rao formal errors have been used in helioseismology by , for example , , , and .",
    "we have computed the formal error on the mode frequency for many realizations and for all window functions .",
    "the resulting distributions are shown in figure  7 . the mean formal error from each distribution",
    "is plotted in figure  6 .",
    "overall the cramr - rao lower bound is remarkably close to the monte - carlo mle uncertainty using the new fitting method ; they are even undistinguishable when @xmath226  @xmath109hz .",
    "this is useful information as it means that , on average , the hessian method provides reasonable error estimates .",
    "it should be clear , however , that the distributions shown in figure  7 show a significant amount of scatter : the formal error from the hessian may be misleading for particular realizations .      .",
    "the observation window has a duty cycle of 30% .",
    "the simulated data is the thick grey line .",
    "the thin black line shows the fit to the data using the new fitting method .",
    "the fit with the old method is not shown since it is almost identical . ]",
    "figure [ fig : realization_fit_determin ] shows the fourier spectrum of a simulated time series containing a sinusoidal mode of oscillation on top of a white noise background as described in section [ section : model_deterministic ] . in this particular case the observation window with a duty cycle of 30% is used ( see figure  [ figure : windowfunction](c ) ) .",
    "the input parameters of the sinusoidal function are the mode frequency @xmath258hz , the amplitude @xmath259 , and the phase @xmath260 .",
    "the signal - to - noise ratio is @xmath261 .",
    "the fit shown in figure [ fig : realization_fit_determin ] was obtained with the new fitting method .",
    "since we found no significant difference between the old and the new fitting methods in this case , the old fitting method is not shown .",
    "differences between the data and the fit are essentially due to the noise .    .",
    "the window function with a duty cycle of 30% is used .",
    "the black and the grey lines are for the new and old fitting methods respectively .",
    "the vertical dashed line in each plot indicates the input value .",
    "the parameters shown are ( a ) the mode frequency [ @xmath156 ] , ( b ) the logarithm of the mode amplitude [ @xmath263 , ( c ) the phase of the oscillation [ @xmath264 , and ( d ) the logarithm of the noise level [ @xmath265 ( see section  6.3 ) .",
    "notice that the estimate of the noise is biased when frequency correlations are ignored ( old nc fit ) , although by a very small amount .",
    "]    we computed 500 realizations of sinusoidal oscillations with the same mode parameters ( frequency , amplitude , phase ) as above , the same observation window ( 30% full ) , but with a signal - to - noise ratio @xmath266 .",
    "the resulting distributions of the inferred parameters obtained with the two fitting methods are shown in figure [ fig : distribution_deterministic ] .",
    "for this simulation , the known input values were used as an initial guess to speed up the minimization ; we checked on several realizations that it is acceptable to do so when the signal to noise ratio is large .",
    "the distributions of the inferred parameters ( figure [ fig : distribution_deterministic ] ) show that for sinusoidal oscillations , the new fitting method does not provide any significant improvement compared to the old fitting method .",
    "we emphasize that the fitting parameters can be determined with a very high precision when the noise level is small .",
    "in particular , we confirm that the uncertainty of the frequency estimator can be much smaller than @xmath1 ( see figure [ fig : distribution_deterministic](a ) ) .",
    "figure [ fig : fsn_det ] shows the median and the standard deviation of the mode frequency for different signal - to - noise ratios .",
    "each symbol and its error bar in figure [ fig : fsn_det ] is based on the computation of 500 realizations of sinusoidal oscillations with the same mode parameters as above , the same observation window ( 30% full ) , but various signal - to - noise ratios .",
    "since we did not find any significant difference between the two fitting methods , only the results obtained with the new fitting method are shown .",
    "figure [ fig : fsn_det ] illustrates that even for a relatively low signal - to - noise ratio of @xmath267 , the standard deviation of the inferred mode frequency is smaller than @xmath1 by a factor of four . for higher signal - to - noise ratios",
    "the precision is even more impressive : when @xmath268 , the standard deviation of the mode frequency is about 20 times smaller than @xmath1 .",
    "the theoretical value of the standard deviation of the mode frequency obtained by can be extended to the case of gapped data ( cuypers , 2008 , private communication ) as follows : @xmath269 where @xmath164 is the amplitude of the sinusoid in the time domain , @xmath270 is the rms value of the noise , @xmath271 is the number of recorded data points , and @xmath0 is the total observation length .",
    "this theoretical uncertainty is overplotted in figure [ fig : fsn_det ] .",
    "the match with our monte - carlo measurements is excellent .",
    "this confirms that , in this case , it is equivalent to perform the fits in the temporal and in the fourier domains . note that equation ( [ equ : freq_error_determin ] ) is only valid under the assumption that the noise is uncorrelated in the time domain , a condition fulfilled by our simulations .",
    "the main reason why the measurement precision is only limited by the noise - to - signal ratio is because perfect knowledge of the model is assumed .    ] as a function of signal - to - noise ratio @xmath160 .",
    "the duty cycle is 30% .",
    "only the results obtained with the new fitting method are shown .",
    "the horizontal grey line shows the input mode frequency .",
    "the dashed grey lines show the theoretical value of frequency uncertainty , @xmath240 , given by equation  ( [ equ : freq_error_determin ] ) .",
    "the vertical axis of the plot spans the interval @xmath272hz.,scaledwidth=90.0% ]",
    "in this paper we derived an expression for the joint pdf of solar or stellar oscillations in complex fourier space , in agreement with the work of .",
    "this joint pdf explicitly takes into account frequency correlations introduced by the convolution with the window function .",
    "we implemented a maximum likelihood estimation method to retrieve the parameters of stellar oscillations .",
    "both stochastic solar - like oscillations and deterministic sinusoidal oscillations were considered .    in the case of solar - like oscillations , we performed monte - carlo simulations to show that the improvement provided by our fitting method can be very significant in comparison with a fitting method that ignores the frequency correlations .",
    "the results are summarized in figure  6 .",
    "in one particular example , using an observation window with a duty cycle @xmath273% and a signal - to - noise ratio @xmath181 , the new fitting method increased the precision of the mode frequency by a factor of two and the estimates of the linewidth and mode power were less biased and more precise . for a window with a duty cycle @xmath274% , the precision on the mode frequency estimate",
    "was increased by a factor of five .",
    "we also found that the cramr - rao lower bounds ( formal errors ) can provide reasonable estimates of the uncertainty on the mle estimates of the oscillation parameters .    in the case of",
    "long - lived , purely sinusoidal oscillations , we did not find any significant improvement in using this new fitting method .",
    "yet , we confirm that the standard deviation of the mode frequency can be measured in fourier space with a precision much better than @xmath1 for large signal - to - noise ratios , in accordance with a previous time - domain calculation ( cuypers , 1987 ; cuypers , 2008 , private communication ) .",
    "the analysis of time series containing many gaps can benefit from our work .",
    "applications may include , for example , the re - analysis of solar oscillations from the early days of the bison network @xcite or the solar - like oscillations of @xmath229 centauri observed from the ground with two telescopes @xcite .",
    "we thank t.  appourchaux for useful discussions , in particular for the suggestion to compute the cramr - rao lower bounds .",
    "t.  stahn is a member of the international max planck research school on physical processes in the solar system and beyond at the universities of gttingen and braunschweig .",
    "the mle source code is available from the internet platform of the european helio- and asteroseismology network ( helas , funded by the european union ) at http://www.mps.mpg.de / projects / seismo / mle_softwarepackage/.                                      miller , b.a . , hale , s.j .",
    ", elsworth , y. , chaplin , w.j . ,",
    "isaak , g.r . , new , r. : 2004 . in : danesy , d. ( ed . ) , _ proc .",
    "soho 14/gong 2004 workshop , helio- and asteroseismology : towards a golden future _ , esa * sp-559 * , esa pub .",
    "div . , noordwijk , 571 .",
    "winget , d.e . ,",
    "nather , r.e .",
    ", clemens , j.c . ,",
    "provencal , j. , kleinman , s.j .",
    ", bradley , p.a . ,",
    "wood , m.a . ,",
    "claver , c.f . ,",
    "frueh , m.l . ,",
    "grauer , a.d .",
    ", hine , b.p . , hansen , c.j . ,",
    "fontaine , g. , achilleos , n. , wickramasinghe , d.t .",
    ", marar , t.m.k . ,",
    "seetha , s. , ashoka , b.n . ,",
    "odonoghue , d. , warner , b. , kurtz , d.w . ,",
    "buckley , d.a . ,",
    "brickhill , j. , vauclair , g. , dolez , n. , chevreton , m. , barstow , m.a . ,",
    "solheim , j.e . ,",
    "kanaan , a. , kepler , s.o . ,",
    "henry , g.w . ,",
    "kawaler , s.d .",
    ": 1991 , _ astrophys .",
    "j. _ * 378 * , 326 ."
  ],
  "abstract_text": [
    "<S> quantitative helio- and asteroseismology require very precise measurements of the frequencies , amplitudes , and lifetimes of the global modes of stellar oscillation . </S>",
    "<S> it is common knowledge that the precision of these measurements depends on the total length ( @xmath0 ) , quality , and completeness of the observations . except in a few simple cases , </S>",
    "<S> the effect of gaps in the data on measurement precision is poorly understood , in particular in fourier space where the convolution of the observable with the observation window introduces correlations between different frequencies . </S>",
    "<S> here we describe and implement a rather general method to retrieve maximum likelihood estimates of the oscillation parameters , taking into account the proper statistics of the observations . </S>",
    "<S> our fitting method applies in complex fourier space and exploits the phase information . </S>",
    "<S> we consider both solar - like stochastic oscillations and long - lived harmonic oscillations , plus random noise . </S>",
    "<S> using numerical simulations , we demonstrate the existence of cases for which our improved fitting method is less biased and has a greater precision than when the frequency correlations are ignored . </S>",
    "<S> this is especially true of low signal - to - noise solar - like oscillations . </S>",
    "<S> for example , we discuss a case where the precision on the mode frequency estimate is increased by a factor of five , for a duty cycle of 15% . in the case of </S>",
    "<S> long - lived sinusoidal oscillations , a proper treatment of the frequency correlations does not provide any significant improvement ; nevertheless we confirm that the mode frequency can be measured from gapped data at a much better precision than the @xmath1 rayleigh resolution . </S>"
  ]
}