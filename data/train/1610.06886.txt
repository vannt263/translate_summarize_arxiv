{
  "article_text": [
    "given that previous studies that used the maximum entropy principle to explore the probability landscape of neural population activity have primarily used highly repeated stimulus ensembles , it was not previously addressed whether or how the result of a proliferation of local maxima in the modeled response probability landscape depends on the stimulus .",
    "in particular , how does this feature depend on the repeat structure of the stimulus ensemble ? for a highly - repeated stimulus ensemble - such as the natural movie used in @xcite , which was comprised of @xmath11 repeats of a @xmath12 movie clip - the exact same stimulus is sampled on many trials .",
    "it is thus plausible that the previously reported non - silent probability local maxima could correspond with the ` average ' response pattern elicited by the same stimulus , with the width of the local maximum being attributable to noise . to investigate whether a proliferation of local maxima is a general feature which is independent of the stimulus repeat structure , we first applied the same k - pairwise maxent model used in @xcite to a large , experimental dataset of the responses of @xmath13 retinal ganglion cells to a mildly - repeated natural movie stimulus ( see _ methods : visual stimulus display _ ) .",
    "we will refer to this stimulus ensemble throughout as movie @xmath14 .",
    "consistent with past work , we defined the joint activity pattern @xmath15 as the binary @xmath0-dimensional vector of instantaneous states of each neuron in the population at time bin @xmath16 : the @xmath17th entry @xmath18 being 1 if the @xmath17th neuron spiked , and 0 if it was silent .",
    "after fitting the model to the data ( see _ methods : fitting the k - pairwise maximum entropy model _ ) , we then searched for local maxima of the modeled probability landscape using the same numerical method as in @xcite , which we term  single spin flip ascent . \"    in practice , this involves taking each population activity pattern observed in the data , and moving  uphill \" on the modeled joint probability landscape ( see _ methods : exploring the modeled probability landscape _ ) .",
    "the termination patterns of this procedure are by definition local maxima of the modeled probability landscape , when only allowing the state of a single neuron to change ( i.e. using a hamming distance of one as the distance metric ) .",
    "this single spin flip procedure can be thought of as a mapping from the full joint response space of @xmath1 states to the space of local probability maxima .    as shown in fig 2a , performing the single spin flip ascent procedure ( using the probability landscape of joint activity obtained by fitting the k - pairwise maxent model ) on the mildly - repeated stimulus dataset resulted in 65 unique local maxima .",
    "of the 175,002 observed population responses in the data , @xmath19 were mapped via single spin flip ascent to the all - silent local maximum ( i.e. @xmath20 ) , and @xmath21 were mapped to the rank-2 local maximum .",
    "this is in stark contrast to the @xmath22 of responses which were mapped via single spin flip ascent to the all - silent local maximum for the highly - repeated stimulus dataset in @xcite .",
    "retinal ganglion cells responding to movie @xmath14 , a mildly - repeated stimulus . *",
    "* ( a , c ) * results using the k - pairwise maximum entropy model ( 8385 parameters ) . * ( a ) * the spike count , denoted by @xmath23 , for each of the 65 unique local maxima identified ( @xmath24-axis , ranked ) . * ( c ) * log - log plot of the proportion ( @xmath25-axis , denoted by @xmath26 ) of the 175,002 population responses observed in the data which were mapped via single spin flip ascent to the corresponding unique local maximum indicated on the @xmath24-axis ( ranked ) . *",
    "( b , d ) * results using the tree hidden markov model ( 8379 parameters ) .",
    "the panels are as described in ( a ) and ( c ) , but for the tree hmm results . ]",
    "we also fit the tree hidden markov model ( see _ methods : fitting the tree hidden markov model _ ) to the same mildly - repeated stimulus dataset , and then performed - using the stationary distribution of the markov chain - single spin flip ascent on the corresponding modeled probability landscape .",
    "since the number of free parameters constitutes an important consideration for model comparison , we selected the number of tree hmm modes so as to match the total number of free parameters as closely as possible to the k - pairwise maxent model .",
    "as shown in fig 2b , 31 unique local maxima were found after performing single spin flip ascent on the probability landscape modeled by the tree hmm . of the 175,002 observed population responses in the data ,",
    "@xmath27 were mapped to the all - silent local maximum , and @xmath28 were mapped to the rank-2 local maximum .",
    "this result is consistent with that obtained for the k - pairwise maxent model , indicating that the paucity of true local maxima is an intrinsic feature of the probability landscape rather than an artifact of one specific model .",
    "this exceptionally high percentage of observed states mapped via single spin flip ascent to the all - silent local maximum was even higher when we performed the above procedure on a dataset of 152 ganglion cells responding to a _ non - repeated _ natural movie stimulus , which we will refer to throughout as movie @xmath29 ( see _ methods : visual stimulus display _ ) .",
    "for this non - repeated stimulus dataset , performing single spin flip ascent on the probability landscape modeled by the tree hmm identified only two local maxima ( see s1 fig ) .",
    "moreover , of the 90,001 observed population responses in the data , @xmath30 were mapped to the all - silent local maximum ( s1 fig ) .    to probe the relationship between stimulus repeat structure and prevalence of non - silent local maxima more systematically ,",
    "we next performed an analysis which allowed us to take the number of stimulus repeats as a parameter .",
    "specifically , two separate experiments were performed in which we presented one of two different movie stimuli : a binary white - noise checkerboard movie , or a natural movie .",
    "we will refer to these throughout as movie @xmath31 and movie @xmath32 , respectively .",
    "both movie stimuli were similarly designed such that unique , non - repeated movie clips were interleaved with presentations of a fixed  target \" clip ( see _ methods : parametric repeat analysis _ for details ) . a schematic illustrating the experimental setup for the interleaved white - noise checkerboard stimulus ( i.e. movie @xmath31 )",
    "is shown in fig 3a .",
    "for each of the two movie stimuli , we then generated  subset movies \" , which were comprised of a subset of the movie clips appearing in the original full - length movie ( see _ methods : parametric repeat analysis _ ) .",
    "different subset movies included a different ratio of the number of repeated target clips to unique movie clips .",
    "note that we held the duration of each subset movie constant , so as to eliminate the potentially confounding effect of different stimulus durations on our sampling of population neural activity . to ensure that there was no dependence on the specific choice of the movie clips included",
    ", we also performed multiple independent random permutations to generate the subset movie corresponding with each repeat ratio . for each permutation and for each repeat ratio",
    ", we then fit the tree hmm to the set of rgc population responses observed during the corresponding subset movie .",
    "the cross - validated log - likelihood results ( used to select the latent dimensionality of the model ; see _ methods : fitting the tree hidden markov model _ ) for different repeat ratios are shown in fig 3b for the interleaved white - noise checkerboard dataset , and in fig 3e for the interleaved natural movie dataset .",
    "for both datasets , there was a general shift toward a larger optimal latent dimensionality as the number of included repeats increased .",
    "after fitting the tree hmm to the subset of rgc population responses corresponding with each subset movie , we then performed the single spin flip ascent procedure on the modeled probability landscape .",
    "averaged over all permutations , for both datasets we observed a predominantly monotonic increase in the number of unique local maxima as a function of repeat ratio .",
    "specifically , for the white - noise checkerboard ( movie @xmath31 ) dataset , we found @xmath33 unique local maxima corresponding with the case of 0 included repeats , which increased to @xmath34 identified local maxima when 68 repeats were included ( fig 3c ) .",
    "likewise , for the interleaved natural movie ( movie @xmath32 ) dataset , increasing the number of included repeats from 0 to 70 corresponded with a drastic increase in the average number of identified local maxima , from @xmath35 to @xmath36 ( fig 3f ) .",
    "moreover , for both datasets , the weight of non - silent local maxima - that is , the percentage of the rgc population responses observed during each respective subset movie which were not mapped via single spin flip ascent to the all - silent local maximum - increased mostly monotonically as a function of the repeat ratio . in particular",
    ", for the white - noise checkerboard dataset we found that the weight of non - silent local maxima increased from @xmath37 for the non - repeated case , to @xmath38 for the case of 68 repeats ( fig 3d ) . for the interleaved natural movie dataset ,",
    "the effect was stronger , with the corresponding values being @xmath39 for the non - repeated case , and @xmath40 when 70 repeats were included ( fig 3 g ) .    in summary",
    ", we have found that the qualitative structure of the rgc population response probability landscape strongly depended on the repeat structure of the stimulus ensemble .",
    "more specifically , within the non- and mildly - repeated stimulus ensemble regime , we found that for both white - noise and natural movie stimuli the modeled response probability landscape was essentially comprised of a single global maximum , the all - silent local maximum , @xmath20 .",
    "however , when particular stimuli were repeated sufficiently , this resulted in the incorporation of significant non - silent local maxima in the modeled probability landscape .",
    "as a check on the validity of these results , we note that the model fitting and spin flip ascent code used here was vetted on multiple analytical test cases ; see _ methods : analytical test cases _ and s2 fig for details .      in recent past work",
    "it was found that for broad , non - repeated stimulus ensembles , the population activity of ganglion cells naturally partitions into a discrete set of  collective modes \" @xcite . in particular ,",
    "these partitions were captured by the latent modes formalized in a tree hidden markov model .",
    "moreover , of particular relevance to the present paper , while the exact same input stimulus typically evoked a highly variable set of population response patterns over trials , these disparate response patterns were found to preferentially map to the same mode .",
    "this is important , because it suggests that this mode representation could constitute a form of error - correction coding .",
    "moreover , since the authors in @xcite identified the modes by fitting the tree hmm only to the _ non - repeated _ portion of the three different stimulus datasets they tested ( and then calculated the mode reproducibility on the held - out repeat trials ) , this error - correction capacity was obtained for the non - repeated stimulus regime .",
    "since these noise - robust collective modes were defined statistically , this leaves open the following question : what is the geometric interpretation of these modes in relation to the response probability landscape ?",
    "based on the past maximum entropy work showing a proliferation of non - silent local maxima in the rgc response probability landscape for the _ highly - repeated _ stimulus regime , we initially expected the collective modes in @xcite to correspond geometrically with local maxima .",
    "however , we have seen here in the previous section that , for the non- and mildly - repeated stimulus regime , non - silent local maxima are exceedingly rare .",
    "this result indicates that collective modes do not necessarily have the geometric structure of a local maximum in the probability landscape .",
    "we thus next sought to determine what the empirically - correct geometric interpretation of the collective modes is . as a first step",
    ", we postulated that there is low - dimensional structure in the high - dimensional joint response probability landscape that could potentially be exploited by downstream processing areas .",
    "in particular , based on our result in the previous section that sparseness dominates the response probability landscape in the low - repeat stimulus regime ( that is , there are exceedingly few local maxima outside of the all - silent global maximum , @xmath20 ) , we speculated that spike count may constitute one important dimension that could be exploited .",
    "note that one conceptual advantage of choosing the spike count as a relevant dimension is that it has an immediate biological interpretation .",
    "the importance of spike count in shaping the probability landscape is further suggested by the monotonic decrease in the average normalized empirical probability of a response pattern as a function of the pattern s spike count , a result we consistently observed for all of our datasets ( fig 4 ) .",
    ", as a function of spike count @xmath9 .",
    "the scaled count distribution is defined as the empirical probability of observing a population response with @xmath9 spikes , normalized by the analytical number of possible joint response patterns with spike count @xmath9 ( see _ methods : scaled count distribution _ ) .",
    "results are shown for three of the different datasets analyzed in the present paper : movie @xmath14 ( blue ; @xmath13 ganglion cells ) , movie @xmath29 ( black ; @xmath41 ganglion cells ) , and movie @xmath31 ( green ; @xmath42 ganglion cells ) .",
    "note that the @xmath25-axis is shown on a log scale . ]",
    "to explore this idea , we first investigated whether there are identifiable response patterns which are local maxima when we _ condition _ on spike count .",
    "in other words , these states are not necessarily local maxima of the probability landscape , when all possible single spin flips are allowed . to this end",
    ", we introduce the following definition :    [ def:1 ] a response state @xmath43 is a _",
    "@xmath9-soft local maximum _ if and only if @xmath44 > p[\\vec{\\sigma}]$ ] @xmath45 such that @xmath46 and @xmath47 , where @xmath48 denotes spike count ( hamming weight ) and @xmath49 denotes hamming distance .",
    "that is , @xmath9-soft local maxima are by definition local maxima when we restrict our search to the metric subspace ( of the full joint response space , which is the @xmath0-dimensional hamming cube ) defined on the set of all possible joint response patterns with fixed spike count @xmath9 .",
    "we will subsequently refer to each such metric subspace as the  @xmath9-th spike count level . \" the geometric intuition behind this definition is illustrated in fig 5 .",
    "-soft local maxima and ridge points .",
    "* * ( a ) * cartoon of a multivariate probability mass function and its  ambient \" ( i.e. prior to projection ) domain . for ease of visualization ,",
    "the ambient domain is shown in two dimensions , and is represented in polar coordinates . here",
    "we denote the radial coordinate by @xmath9 ( where @xmath9 assumes positive integer values ) , and the polar coordinate by @xmath50 . if we take the radial coordinate @xmath9 to correspond with spike count , then the analogue of the @xmath9-soft local maxima defined in def .",
    "( @xmath51 ) for this conceptual example are the points which are local maxima of the conditional probability @xmath52 , i.e. after we project onto a fixed value of @xmath9 . for illustration ,",
    "two example @xmath9-soft local maxima are shown , denoted by circles and labeled @xmath53 ( blue ) and @xmath54 ( green ; see arrows ) . *",
    "( b ) * after projecting onto the radial coordinate for the respective values of @xmath9 , we see that @xmath53 is a local maximum of @xmath55 and likewise that @xmath54 is a local maximum of @xmath56 . *",
    "( c ) * illustrated is the projection onto the polar coordinate , for an arbitrary fixed value of @xmath50 .",
    "note that since soft local maxima are local maxima of a function defined on a lower - dimensional subspace of the original domain , they are candidates for a type of  ridge point , \" and as shown in panel ( a ) could theoretically form discrete  ridges \" which span across different @xmath9 levels . ]    in practice , we used the following numerical procedure , which we term  neuron pair relaxation , \" to find soft local maxima : we start with a population response pattern @xmath57 that appears in the data , and attempt to ` flip ' a randomly - chosen pair @xmath58 of neurons which have opposite responses within time bin @xmath16 . specifically , by ` flipping ' the response state of neurons @xmath17 and @xmath59 , we mean that we set @xmath60 , where @xmath61 denotes mod 2 addition .",
    "flipping is retained if the resulting pattern has a higher probability than the original pattern ( see _ methods : finding soft local maxima _ ) .",
    "this procedure is iterated until none of the @xmath62 neuron pairs with opposite instantaneous responses can be flipped to increase the probability ; the terminating pattern is by definition a soft local maximum . as with our single spin flip ascent code , we vetted the combination of our model fitting and neuron pair relaxation code on analytical test cases to ensure correct implementation ( see _ methods : analytical test cases _ and s3 fig ) .",
    "to check for the presence ( or absence ) of soft local maxima in the joint probability landscape , we implemented the above - described neuron pair relaxation procedure for two large datasets .",
    "based on the results of another analysis ( see _ methods : choice of probability model _ ) , which demonstrated that the tree hmm more accurately captures the empirical @xmath63-soft local maxima than the k - pairwise maxent model , we chose the tree hmm as our underlying model of the probability landscape .",
    "we first examined the dataset of @xmath64 ganglion cells responding to movie @xmath29 , which was a 30-min duration non - repeated natural movie stimulus .",
    "as shown in fig 6a , for all spike counts @xmath65 examined , we found that multiple soft local maxima were always present .",
    "moreover , the number of identified unique soft local maxima monotonically increased with spike count ( fig 6a , grey curve ) . to investigate how robust the mapping from the dataset of all observed responses with @xmath9 spikes to the set of unique @xmath9-soft local maxima was , for this dataset we performed @xmath66 iterations of our mapping procedure , where each iteration involved a different , independent random sequence of permutations for the neuron pair relaxation algorithm ( see _ methods : finding soft local maxima _ ) . for each value of @xmath9",
    ", we then computed the mean pairwise overlap ratio between the identified sets of unique @xmath9-soft local maxima for each of the 4950 iteration pairs .",
    "as seen in fig 6a ( upper left - hand inset ) , for @xmath67 , the identity of the mapped set of unique soft local maxima was perfectly conserved . for @xmath68 , when restricted to iterations for which the cardinality of the mapped set of unique @xmath9-soft local maxima was largest , the mean pairwise overlap ratio was also very high ( @xmath69 ) , indicating a high degree of robustness .",
    "ganglion cells responding to movie @xmath29 , which was a non - repeated natural movie stimulus ; and * ( b , d ) * the dataset of @xmath70 rgcs responding to the original version of movie @xmath32 ( see _ methods : visual stimulation _ ) .",
    "* ( a ) * shown in grey is the mean number of unique @xmath9-soft local maxima identified ( @xmath25-axis ) by performing neuron pair relaxation on the response probability landscape modeled by the tree hmm ( @xmath71 latent modes ) for each examined spike count level @xmath9 , averaged over @xmath66 mapping iterations .",
    "error bars denote one standard deviation over the @xmath66 iterations . _",
    "upper left inset _ : the mean pairwise overlap ratio ( see _ methods : finding soft local maxima _ ) for each value of @xmath9 ( blue ) , averaged over all 4950 iteration pairs .",
    "error bars denote one standard deviation . _ lower right inset _ : total number of observed population responses in the data ( purple ) for each spike count level . *",
    "( b ) * same format as in panel ( a ) . for this dataset , one iteration of mapping from observed population responses to the set of unique @xmath9-soft local maxima was performed . *",
    "( c ) * example results for a specific spike count level @xmath9 , arbitrarily chosen here to be @xmath72 .",
    "shown is a log - log plot of the proportion of the 5795 observed responses in the data with 5 spikes which were mapped , via neuron pair relaxation , to the corresponding @xmath73-soft local maximum indicated on the @xmath24-axis . *",
    "( d ) * log - log plot of the proportion of the @xmath74 observed population responses in the data with 5 spikes which were mapped to the corresponding @xmath73-soft local maximum indicated on the @xmath24-axis . ]",
    "we next examined the responses of @xmath75 ganglion cells responding to the original version of movie @xmath32 , which was a 2.5-hour duration natural movie stimulus in which every @xmath76 alternated between a unique movie clip and a repeated fixed target clip . as shown in fig 6b , we similarly found a proliferation of soft local maxima for all examined spike counts .",
    "consistent with the previous results , we observed a monotonic increase in the number of identified unique soft local maxima as a function of spike count ; in particular , 227 unique @xmath77-soft local maxima were identified ( fig 6b , grey curve ) .",
    "so far we have restricted our attention to the set of all activity patterns having a fixed number of spikes , @xmath9 . within the disciplines of computer vision and differential geometry ,",
    "there is a well - studied notion of ridges , which are curves or hypersurfaces composed of so - called  ridge points \" @xcite .",
    "although multiple definitions for ridge points can be found in the computer vision literature , one popular definition that is considered successful is the _ height definition _ @xcite .",
    "this definition stipulates that a necessary condition for a point @xmath6 to be a ridge point of a multivariate function @xmath78 is that it must be a _",
    "generalized maximum _",
    ", which conceptually is a local maximum of @xmath78 when we restrict our search to a subspace of the function s domain .",
    "although generalized maxima are technically only defined for continuous functions on vector space domains , we can see that the @xmath9-soft local maxima defined in definition [ def:1 ] are a type of discrete analogue , where we have chosen the restricted metric subspace of the domain ( which is the hamming cube in our case ) to be the set of all activity patterns with a fixed spike count , @xmath9",
    ".    given this potential conceptual connection to ridge points , we thus next sought to investigate whether the soft local maxima found in the previous section are naturally organized _ across _ spike count levels such that they comprise discrete  ridges . \" toward this purpose , we introduce the following definition :    [ def:2 ] a soft local maximum @xmath79 is _ u - reachable _ from another soft local maximum @xmath6 if and only if @xmath80 , and @xmath81 neuron @xmath82 the set of neurons which have a silent response , @xmath83 , such that :    * performing neuron pair relaxation on @xmath84 results in @xmath79 , and * @xmath85 < p[\\vec{\\sigma}]$ ] ( to ensure that @xmath84 is not a local maximum )    where @xmath86 denotes spike count , @xmath84 denotes the joint response pattern which differs from @xmath6 only in neuron @xmath17 s response , and @xmath87 .    intuitively , the motivation behind this definition is to identify the soft local maximum @xmath79 at the @xmath88-th spike count level which is ` closest ' to the @xmath9-soft local maximum of interest ( denoted in def . [ def:2 ] by @xmath6 ) , while accounting for potential energy barriers .",
    "a schematic illustrating the notion of @xmath89-reachable as defined in def . 2",
    "is shown in fig [ fig7]a .",
    "this allows us to define a progression of nearest soft local maxima spanning across low to high spike count levels .",
    "an analogous notion conducive to exploring soft local maxima organization across high to low spike count levels , which we term @xmath90-reachable , is similarly defined :    [ def:3 ] a soft local maximum @xmath79 is _ d - reachable _ from another soft local maximum @xmath6 if and only if @xmath91 , and @xmath81 neuron @xmath82 the set of neurons which have an active response , @xmath92 , such that :    * performing neuron pair relaxation on @xmath84 results in @xmath79 , and * @xmath85 > p[\\vec{\\sigma}]$ ]    where @xmath93 .",
    "this notion of @xmath90-reachable is illustrated in fig [ fig7]b .",
    "( blue filled circle ) represents a @xmath9-soft local maximum , and @xmath94 ( green filled circle ) represents a ( @xmath95)-soft local maximum .",
    "the different metric subspaces @xmath96 of the full joint response space @xmath97 , which are defined as @xmath98 and which we also refer to as ",
    "spike count levels \" , are represented by colored concentric rings .",
    "the center - most yellow ring corresponds with the @xmath99th spike count level . in this example",
    ", @xmath94 is @xmath89-reachable from @xmath100 .",
    "this is because : ( 1 ) there exists a silent neuron @xmath17 such that changing neuron @xmath17 s instantaneous response from @xmath101 to @xmath51 ( represented by the black arrow ) will ( 2 ) result in a joint response pattern @xmath102 ( orange filled circle ) at the @xmath88-th spike count level that will be mapped via neuron pair relaxation ( represented by the purple arrow ) to @xmath94 . *",
    "( b ) * in this cartoon diagram , the @xmath103-soft local maximum @xmath104 ( green filled circle ) is @xmath90-reachable from the @xmath9-soft local maximum @xmath100 ( blue filled circle ) .",
    "this is because : ( 1 ) there exists an active neuron @xmath17 such that changing neuron @xmath17 s instantaneous response from @xmath105 to @xmath99 ( represented by the black arrow ) will ( 2 ) result in a joint response pattern @xmath106 ( orange filled circle ) at the @xmath103-th spike count level that will be mapped via neuron pair relaxation ( purple arrow ) to @xmath104 . ]",
    "we visualized examples of soft local maxima organization across low to high spike count levels via a breadth - first search - like ( bfs ) algorithm , which was used to construct a rooted weighted directed graph ( digraph ) starting with a given  root \" @xmath9-soft local maximum ( see _ methods : visualizing ridges _ for full details ) .",
    "the nodes of this rooted weighted digraph represent soft local maxima , and a directed edge @xmath107 is drawn if and only if soft local maximum @xmath94 is @xmath89-reachable from @xmath108 .",
    "since the neuron pair relaxation algorithm is not deterministic , for each neuron @xmath17 in the silent set of the current @xmath9-soft local maximum , @xmath109 ( of which there are up to @xmath110 choices ) , we performed @xmath111 iterations of the neuron pair relaxation procedure on @xmath112 .",
    "we then set the weight of each directed edge @xmath113 , which we denote by @xmath114 , as the proportion of the @xmath111 relaxation iterations which resulted in @xmath94 .",
    "the weight of each edge is represented by edge thickness in the digraph visualizations ( figs 8 and 9 ) . to mitigate effects due to noise",
    ", for each unique @xmath88-soft local maximum @xmath115 reached after performing the above procedure on a given @xmath108 , we further only included the directed edge @xmath116 if the corresponding edge weight @xmath114 exceeded a reliability threshold @xmath117 . in practice , we used @xmath118 .    via this approach , we thus algorithmically define a discrete ridge as the set of soft local maxima which are organized across low to high spike count levels such that each respective pair of @xmath9- and @xmath88-soft local maxima is ` connected ' , in the sense of being @xmath89-reachable .",
    "we show example rooted weighted digraphs obtained for the dataset of @xmath64 ganglion cells responding to the non - repeated natural movie ( movie @xmath29 ) , for the choice of starting spike count level @xmath119 and terminating spike count level @xmath120 ( figs 8 and 9 ) . in most examples ,",
    "a @xmath89-reachable soft local maximum had one active neuron added ; i.e. that neuron was silent at spike count level @xmath9 and spiking at level @xmath95 .",
    "many digraphs exhibited one or a few neurons added at each @xmath89-reachable step ; these digraphs formed simple ridges .",
    "note that in theory , it is possible that a discrete ridge descending from the global maximum ( which occurs for this dataset at the @xmath99th spike count level ) could terminate at a lower spike count level @xmath9 than the one we arbitrarily choose our numerical procedure to explore out to ; an example occurrence of this scenario is shown in fig 8c .",
    "further , it is theoretically possible for a ridge to branch into multiple ridges .",
    "consequently , each output rooted digraph could potentially contain more than one ridge . to aid in visualizing distinct ridges , we further assigned an @xmath24- and @xmath25-coordinate to each node in the output rooted digraphs , with the intuition behind the @xmath24-coordinate assignment being to quantify whether or not there is a ` jump ' between ridges based on the amount of overlap between the different soft local maxima ( see _ methods : visualizing ridges _ ) .",
    "since the @xmath89-reachable qualification alone does not capture the scenarios of early ridge termination and branching , we then extended our algorithmic definition of a distinct ridge by further qualifying that it must be comprised of soft local maxima which share the same @xmath24-coordinate , as formulated in eq .",
    "[ eq:11 ] .              for each soft local maximum @xmath79 appearing as a node in the rooted digraph visualizations , we also computed the maximum _ a posteriori _ ( map ) estimate of its associated tree hmm mode @xmath121 , given by eq .",
    "[ eq:14 ] ( see _ methods : visualizing ridges _ ) . to visualize this information",
    ", we then assigned a color to each node in the output rooted digraphs , which uniquely identifies the map estimate of the associated tree hmm mode .",
    "overall , there was a strong tendency for each distinct ridge to be comprised of soft local maxima which shared the same map estimate for the associated tree hmm collective mode ( fig 8) . to broadly characterize the digraph visualization results in terms of the degree of correspondence between ridges and collective modes , we classified each unique ridge as belonging to one of two disjoint categories , which are defined in table  [ table1 ] . conceptually , a ",
    "type i \" classification denotes that the given ridge has a ` perfect ' correspondence with one of the latent tree hmm modes .",
    "note that we chose to classify on the basis of ridges , rather than on the basis of the rooted digraph examples , to avoid potentially double - counting ridges when computing global statistics . applying this classification scheme for the dataset of 152 rgcs responding to movie @xmath29",
    ", we observed that 13 of the 17 total identified unique ridges , i.e. @xmath122 , were type i. comparably , for the dataset of 170 rgcs responding to the original version of movie @xmath32 , we found that 32 of the 44 total identified unique ridges , i.e. @xmath123 , were type i. hence for both a non - repeated as well as a moderately - repeated stimulus ensemble , we found that there was a substantial correspondence between the statistically - defined tree hmm modes and the geometrically - defined discrete ridges .",
    "+     i & the ridge corresponds with exactly one tree hmm mode , and this mode moreover uniquely corresponds with this ridge .",
    "that is , there is a bijective mapping .",
    "+ ii & there is not a bijective mapping between this ridge and one of the tree hmm modes .",
    "e.g. the ridge is associated with more than one tree hmm mode , and/or the mapped tree hmm mode is associated with more than one ridge .",
    "+    [ table1 ]      as shown in fig 9 , even in the few cases where there was not a perfect one - to - one bijective mapping between a given geometric ridge and a tree hmm mode , we consistently found that each identified ridge corresponded with a specific group of active neurons that we will here term a  neuron community . \" in particular , for each distinct ridge , a group of neurons in the population could be identified such that every soft local maximum @xmath79 comprising the ridge had an active set of neurons , defined as @xmath124 , which was a subset of this identifiable group .",
    "neurons outside of this identifiable  neuron community \" were always silent for all soft local maxima comprising the associated ridge .    to investigate how the full population clusters into these ridge - associated neuron communities , for each neuron @xmath17 ( where @xmath125 ) we recorded all of the neuron communities it was a member of based on the compilation of the rooted digraph results .",
    "we then visualized this information in the form of an undirected graph , where each node in the graph represents a neuron in the population , and an edge @xmath58 is present if and only if neurons @xmath17 and @xmath59 are members of at least one common neuron community ( see _ methods : visualizing neuron communities _ ) . by definition ,",
    "the maximal cliques of this graph , which we refer to as the  ridge union graph \" for the population , correspond with the ridge - associated neuron communities .",
    "the ridge union graph for the dataset of @xmath64 ganglion cells responding to the non - repeated natural movie is shown in fig 10 . as seen in fig 10 , mixed membership , i.e. the case of a neuron having membership in more than one neuron community , was prevalent .",
    "more specifically , averaged over the @xmath126 retinal ganglion cells which were assigned to at least one neuron community , a given rgc belonged to a mean ( @xmath127 sem ) of @xmath128 neuron communities .",
    "this high degree of mixed membership may be a signature of a combinatorial neural population code .",
    "rgcs responding to the non - repeated natural movie stimulus , i.e. movie @xmath29 .",
    "nodes in this undirected graph represent individual rgc neurons in the population , where each inscribed number indicates the index of the corresponding neuron .",
    "the presence of an edge @xmath58 denotes that neurons @xmath17 and @xmath59 share at least one common ridge - associated neuron community ( see _ methods : visualizing neuron communities _ ) .",
    "each color uniquely identifies one of the @xmath129 distinct ridge - associated neuron communities for this dataset . neurons which exhibited mixed membership - i.e. were members of more than one neuron community - are depicted with ",
    "pie \" nodes ; in this case , each constituent color denotes the respective neuron community ( see key ) . *",
    "( b ) * histogram of the breakdown of the different degrees of mixed membership across the population ( for the same dataset as in panel a )",
    ". represented on the @xmath24-axis is the number of ridge - associated communities a given ganglion cell was a member of , which we term the  membership count .",
    "\" green denotes the same as purple , except that it also includes the @xmath130 rgcs which were not a part of any community .",
    "the purple histogram only includes the @xmath126 rgcs which were a member of at least one community . ]",
    "finally , we sought to ascertain that correlations in the data were necessary to give rise to the soft local maxima and discrete ridge structures observed here , as opposed to these features trivially arising from the structure of the underlying tree hmm probability model . due to the large population sizes of the datasets we analyzed",
    ", it is intractable to empirically determine the joint response p.m.f . , and consequently intractable to directly investigate the presence of these geometric features in the empirical probability landscape . to control for the possibility that these features are solely attributable to our specific choice of the underlying probability model , we compared the results obtained for the true dataset of 152 rgcs responding to movie @xmath29 with those obtained by fitting the tree hmm to two manipulated cases in which only limited structure was preserved ( fig 11 ) .",
    "details of the construction of both controls are reported in _ methods : shuffled controls_. in brief , both controls were constructed so as to completely eliminate the signal and noise correlations in the original data ; one of the two controls retained heterogeneous firing with the ganglion cell population , while the other control imposed homogeneous firing .        as seen in fig 11a",
    ", there was a categorical difference between the cross - validated log - likelihood ( cv - ll ) curves obtained when the tree hmm was fit to the original data , versus when the tree hmm was fit to the control data . whereas the cv - ll curve for the original data exhibited a well - defined peak at 19 modes , when fit to each control dataset , the cv - ll curve instead achieved its maximum at only one mode .",
    "the soft local maxima results were likewise substantially different for the original data versus the controls ( fig 11b ) . in particular , there was a monotonic increase in the proliferation of soft local maxima at all spike count levels for the original data , with 74 unique soft local maxima identified at spike count level @xmath131 .",
    "in contrast , the modeled probability landscapes for both controls exhibited a constant and low number of unique soft local maxima across all spike count levels .",
    "specifically , for the first control , in which the firing rates of each neuron in the original data were preserved and thus heterogeneous over the population , one unique soft local maximum was present at each spike count level .",
    "as expected analytically for an independent neuron population with heterogeneous firing rates , we confirmed that the single soft local maximum identified via our procedures at each spike count level @xmath9 corresponded with the @xmath9 ganglion cells which had the highest firing rates ( s6 fig ) .",
    "for the second control , in which each neuron was moreover assigned the same firing rate , no soft local maxima were found for any of the tested spike count levels .",
    "this is consistent with the analytical result and expectation for an independent population of homogeneous neurons , as the symmetry in the homogeneous case implies that the probability landscape depends only on @xmath9 ( and thus all joint responses within the same spike count level have identical probability ) .",
    "thus , the soft local maxima results , and by extension the ridge results , obtained via our approach for the original data are non - trivially dependent on the empirical correlation structure of the measured neural activity .",
    "it is well established that the manner in which local neural circuits encode information generally involves the cooperation of many neurons @xcite , and that noise is prevalent throughout the nervous system @xcite . partitioning noisy output patterns into fault - tolerant clusters corresponding with  codewords \"",
    "is a long - standing idea which has been utilized in traditional error - correcting codes in communications engineering @xcite .",
    "however , whether this idea is actually realized in neuronal population codes is a question which has only very recently begun to be empirically investigated @xcite . in particular , two independently - conducted studies employing activity ( i.e. unsupervised ) models to investigate",
    "rgc population response data have revealed support for this idea , but via different definitions of codewords @xcite . specifically , the results in ref .",
    "@xcite suggested that geometrically - defined local maxima in the joint response probability landscape ( which was modeled via a maxent model ) could potentially correspond with codewords , whereas the results in ref .",
    "@xcite suggested that potential candidates for codewords are captured by the statistically - defined latent modes of the fit tree hidden markov model .    in this work , we first sought to investigate how these two different definitions of rgc population codewords are related .",
    "we have shown that the qualitative structure of the rgc joint response probability landscape , which is fundamentally shaped by correlations among ganglion cells , depends on the stimulus ensemble statistics .",
    "in particular , we have found that for both a natural and artificial movie stimulus , the number of non - negligible local maxima comprising the modeled probability landscape is strongly influenced by the number of stimulus repeats ( fig 3 ) . whereas a sufficiently high - repeat stimulus regime corresponded with a response probability landscape characterized by a proliferation of local maxima , consistent with past results @xcite , in the low - repeat stimulus regime , we found instead that only a negligible number of activity states were mapped onto non - silent local maxima ( figs 2 and 3 ) . yet for the natural movie stimulus in the non - repeated regime , there were still many tree hmm modes ( fig 3e ; @xcite ) .",
    "thus , at least in the low - repeat stimulus regime , the geometrically - defined local maxima examined in ref . @xcite and the statistically - defined tree hmm modes introduced in ref .",
    "@xcite are not the same .",
    "we then sought to determine the geometric correlate of the tree hmm modes in the non - repeated stimulus regime . using a new method of analysis",
    ", we showed that these collective modes correspond closely with algorithmically - defined discrete  ridges \" in the response probability landscape ( figs 8 and 9 ) .",
    "moreover , we found that each ridge also corresponded with an active neuron  community \" , a notion from computer science @xcite .",
    "this organization of the rgc population into a community structure with a high degree of mixed membership ( fig 10 ) is reminiscent of the concept of  cell assemblies \" hypothesized over sixty years ago by donald hebb @xcite . in hebb s view , individual neurons did not work in isolation , but rather were suggested to participate in multiple different cell assemblies @xcite .",
    "the first four defining properties of hebb s original cell assembly concept are ( paraphrased ; see @xcite for details ) : ( @xmath17 ) overlapping set coding of information items ; ( @xmath132 ) sparse coding ; ( @xmath133 ) dynamic construction and reconstruction ; and ( @xmath134 ) dynamic persistence .",
    "the neuron community results found here are highly consistent with properties ( @xmath17 ) and ( @xmath132 ) .",
    "in particular , we found that communities are overlapping sets of neurons : for the non - repeated natural movie dataset , a given ganglion cell was a member of on average @xmath128 different communities , and a given community overlapped with on average @xmath135 other communities .",
    "moreover , any individual community contained a small subset ( on average @xmath136 rgcs ) of the @xmath64 total neurons in the population , consistent with the sparse coding property .",
    "we can not comment on how our ridge - associated neuron community results relate to hebb s properties ( @xmath133 ) and ( @xmath134 ) , since these are dynamic properties , and the geometric ridges and consequently communities are features which were extracted from the modeled _",
    "static _ probability landscape ( see _ methods _ ) .",
    "the neuron community results obtained here are also consistent with the fifth and final defining property of hebb s original cell assembly concept : the dynamic completion property , which stipulates that activation of a large enough subset of a cell assembly results in activation of the complete cell assembly @xcite .",
    "although intrinsic dynamics are not applicable in our case , there is a strong parallel between property ( @xmath137 ) and our observation that population responses which had instantaneous activation of a large enough subset of the neuron community were typically mapped to the same tree hmm mode .",
    "it was shown in ref .",
    "@xcite that the tree hmm modes were robustly reproducible across stimulus repeats , which combined with the present work suggests that communities are likewise fault - tolerant coding features . in combination , the three properties of overlapping set coding , sparse coding , and robust completion were previously shown to offer theoretical advantages to overcome the deficiencies of the single - neuron doctrine @xcite .",
    "in particular , the development of these ideas in the older literature was essentially motivated by considerations of the trade - off between rate ( i.e. the number of information items which could be represented by the assemblies ) and error - correction performance ; this fundamental trade - off has been rigorously formalized in communications engineering @xcite .    within the more modern body of literature in the field ,",
    "there have been many different proposals for how to study population neural codes .",
    "one particularly formative approach has been to apply information - theoretic techniques @xcite . in past work which applied such information - theoretic methods to quantify combinatorial coding in the salamander and guinea pig retina ,",
    "it was found that whereas synchronous spiking was mostly redundant , combinations of spiking and silence were generally synergistic @xcite . in the present work , we found that ganglion cells in the population cluster into groups ( which we call  neuron communities \" ) that are specific to each ridge identified in the probability landscape . within a given ridge ,",
    "population responses exhibit active neurons that are members of this identifiable group , combined with silence from all neurons outside of this group .",
    "this result is consistent with the previous synergy from silence results @xcite , and can be thought of as a generalization of the previous result to populations of @xmath138 neurons . in particular",
    ", we found that neural activity patterns having different numbers of active neurons but the same silent set were mapped to the same ridge .",
    "thus , the number of active neurons within a given community embodies a form of error - correction , while the identity of the silent neurons is , in some sense , more important in defining the population codeword .    based on a similar motivation to understand the role of network noise on the rgc population code",
    ", another recent approach has been to investigate the possibility of clustering in the response space using a _ semantic _ distance metric @xcite .",
    "using a hierarchical agglomerative clustering algorithm on the matrices formed by computing the semantic distance between each pair of observed joint responses for populations of @xmath139 rgcs , it was found that the resulting ordered matrices exhibited an almost perfect block structure @xcite .",
    "this result was shown to be non - trivial and indicates that , empirically , the @xmath139-bit rgc population responses cluster in the response space based on semantic similarity . unfortunately , we can not directly compare the ridge - associated communities found here with the previously - reported semantic clusters , since the approach in ref .",
    "@xcite is a supervised approach that requires a high - repeat stimulus regime , whereas our analyses in the present work were applied to the non - repeated stimulus regime .",
    "given our finding that the rgc joint response probability landscape is proliferated by local maxima for the high - repeat regime , we believe that the previously - reported semantic clusters largely correspond geometrically with local maxima .",
    "however , we speculate that the probability landscape in the vicinity of such local peaks still has an extended , ridge - type geometry for the highly - repeated dataset analyzed in ref .",
    "@xcite . in this case , the finding in ref .",
    "@xcite that simple linear and bilinear distance metrics do not correspond with semantic distance is also consistent with our findings , as we would not expect simple linear or bilinear clustering routines to succeed well in capturing this type of asymmetric syntactic structure .",
    "finally , our community results are also highly consistent with the finding in ref .",
    "@xcite that population responses belonging to the same semantic cluster exhibited some shared structure in terms of having a common subset of neurons which were always active , and other neurons which were always silent .",
    "our results make a further connection between clustering structure within the functional network of rgcs , and geometric features ( specifically ridges ) in the joint response probability landscape .",
    "another related , recently - proposed approach has been to use a perturbed maximum entropy framework to characterize the organization of rgc population responses in the response space @xcite . by combining a mean - field approximation and the message passing algorithm @xcite , the authors in ref .",
    "@xcite were able to estimate the number of population responses at a given hamming distance from a chosen reference population activity pattern .",
    "conceptually , introducing a strong perturbative coupling field that is proportional to a given neural activity state corresponds with a probability distribution that is an approximate delta function around the chosen reference state .",
    "then , reducing the perturbation allows the probability to relax into larger and larger neighborhoods around the reference state . using this approach for both hopfield networks and retinal network data ,",
    "it was found that the response space was partitioned into multiple clusters ; moreover , for the retinal network data , there was greater clustering around local maxima than around non - local maxima @xcite .",
    "it is important to note that the retina network dataset analyzed in ref .",
    "@xcite was the same as in refs .",
    "consequently , these results pertain to the highly - repeated stimulus regime , i.e. the regime in which local maxima proliferate the probability landscape . to our knowledge",
    ", our work here is the first to extend similar clustering results for rgc population responses to the non / mildly - repeated stimulus regime .    when studying neural population codes , it is important to make the distinction between the symbolic structure of the code , versus the mapping between inputs and output responses .",
    "here we have addressed only the former of these two issues .",
    "this leaves open the question : do the ridges and/or communities have any meaningful relationship to the stimulus ensemble , and if so , what stimulus features do they encode ?",
    "for the low - repeat stimulus regime , we have established numerically that the tree hmm modes appear to correspond closely with geometric ridges in the joint response probability landscape , and moreover with neuron communities .",
    "thus , by extension , we would expect that the ridges and neuron communities encode similar stimulus features as the corresponding tree hmm modes .",
    "previous work has shown that coding symbols based on multi - neuron responses , including the tree hmm modes , encode stimulus features which are distinct from those encoded by single neuron responses @xcite . via estimating each tree hmm mode s receptive field ( rf ) as the mode - triggered stimulus average",
    ", it was found in ref .",
    "@xcite that approximately half of the mode rfs resembled the intersection of many individual ganglion cells rfs .",
    "this property represents a straightforward mechanism by which the retinal population code can achieve greater spatial acuity than individual cells .",
    "similar intersection features have been reported to be encoded by the simultaneous spiking patterns of groups of 2 - 4 rgcs @xcite .",
    "additionally , other tree hmm mode rfs were found to resemble either the union of the underlying individual cells rfs , or intriguingly , an oriented dipole profile @xcite .",
    "these properties may be useful for enabling a form of position invariance , and detection of oriented contrast edges , respectively . in all of these cases ,",
    "the visual features represented by tree hmm modes were different from those represented by individual ganglion cells .",
    "thus , the set of all tree hmm modes appears to constitute a new  vocabulary \" with which to represent the visual world .",
    "the fact that the geometry of the probability landscape of ganglion cell population activity is qualitatively different in the high - repeat versus low - repeat stimulus regimes raises an obvious question : which regime corresponds to the visual stimuli falling on the eye during real behavior ? answering",
    "this question depends on understanding on a more fundamental level how a  stimulus ensemble \" is defined from the viewpoint of the retina and downstream brain areas .",
    "in particular , there are two component considerations : ( 1 ) the duration of sampling of the stimulus space , and ( 2 ) whether readout processing is context - specific . regarding ( 1 ) , in the real animal",
    ", readout circuits can potentially accumulate sampling over long time periods . in the case",
    "that sampling occurs over the entire lifetime of the organism , then the corresponding stimulus ensemble will be over all possible natural visual stimuli in the animal s environment , which has been shown to have conserved second - order statistics @xcite .",
    "consequently , for the retinal code in this limit , the stimulus ensemble would lack repeated features .",
    "thus , for the case in which sampling occurs over the lifetime of the animal , we would expect that the rgc joint response probability landscape more closely resembles the ridge ( i.e. non - repeated stimulus ) regime studied here .",
    "however , regarding ( 2 ) , past work has shown that the neural code can be multiplexed , such that there is not necessarily one single interpretation extracted by downstream processing areas , but instead multiple context - specific interpretations which serve different purposes @xcite .",
    "it is possible that some downstream circuits which read out the ganglion cell population code could be gated by contextual signals , i.e. that these readout circuits only sample from the ganglion cell population under particular contexts .",
    "for example , an animal being in different environmental locations could constitute different contexts , signaled by feedback from the hippocampus ; another example is running versus stationary movement , which is known to induce contextual modulation in v1 responses @xcite .",
    "these types of contextual signals could therefore restrict sampling to subsets of the visual environment in which some visual features repeat frequently . in this case",
    ", the probability landscape of ganglion cell population activity would have at least some local peaks that downstream circuits might benefit from identifying .    within the scope of the full information processing system of the animal , these two regimes of sampling over the animal s life span versus contextually - modulated sampling are not mutually exclusive .",
    "indeed , we would suggest that both regimes are actively realized in the full system .",
    "accordingly , we do not interpret our results as necessarily implying that true local maxima are impracticable candidates for error - robust  codewords \" .",
    "rather , we would speculate that a more likely alternative is that the retinal population code contains at least two _ types _ of error - robust  codewords \" : e.g. ridges may constitute one type which encode more general stimulus features such as classes of related stimuli , whereas local maxima may constitute another type which encode more specific , individual stimulus features that occur in a given context .",
    "the question of how these two different types of retinal population ",
    "codewords \" are decoded biologically by downstream processing areas is , of course , an open and important question for future work .",
    "this study was performed in strict accordance with the recommendations in the guide for the care and use of laboratory animals of the national institutes of health .",
    "the protocol was approved by the institutional animal care and use committee ( iacuc ) of princeton university ( protocol 1828 ) .",
    "we analyzed recordings from larval tiger salamander ( _ ambystoma tigrinum _ ) retinal ganglion cells responding to either naturalistic or white noise checkerboard movie clips . in brief , animals were euthanized according to institutional animal care standards .",
    "for the white - noise checkerboard experiment , eyes were removed in darkness and the retina separated from the pigment epithelium .",
    "the natural movie experiments were conducted with the pigment epithelium intact and surgery performed in dim light .",
    "the isolated retina was then transferred as quickly as possible into oxygenated ringer s medium at room temperature , in order to optimize the long - term stability of recordings .",
    "tissue was flattened and attached to a dialysis membrane using polylysine .",
    "the retina was then lowered with the ganglion cell side against a custom 252-electrode multi - electrode array .",
    "raw voltage traces were digitized and stored for offline analysis using a 252-channel preamplifier ( multichannel systems , germany ) .",
    "offline spike sorting was performed using custom software .",
    "detailed recording and analysis methods , including the spike - sorting algorithm , are described in @xcite .",
    "for the three natural movie experiments , 128 , 152 , and 170 neurons passed the standard tests for waveform stability and lack of refractory period violations , respectively .",
    "for the binary white noise checkerboard experiment , 155 neurons passed the standard tests .",
    "stimuli were projected onto the array from a crt monitor at a frame rate of 60 hz , and gamma corrected for the display .",
    "we presented two stimulus classes , in a total of four different experiments : a natural movie ( three experiments ) , and a binary white noise checkerboard ( one experiment ) .",
    "the natural movie consisted of a 7-min gray scale recording of leaves and branches blowing in the wind .",
    "we conducted the natural movie experiments with three different designs : ( 1 ) in the first , which we refer to throughout ",
    "movie @xmath14 \" , the full 7-min movie was looped ( i.e. repeated ) ten times , for a total movie length of approximately @xmath140 min ; ( 2 ) in the second , which we refer to as  movie @xmath29 \" , the movie was looped five times , but with a different pixel centered on the recording area for each repeat ; ( 3 ) in the third , which we refer to as  movie @xmath32 \" , we interleaved 73 unique movie clips , each 60 s in duration , with 73 repeats of a fixed 60-s  target \" movie clip",
    ". design ( 2 ) was constructed this way to provide a non - repeated stimulus : since the patch of retina recorded by the multi - electrode array subtended only a small portion of the stimulus , the retinal input was effectively non - repeated over the full recording session . the binary white noise stimulus , which we refer to throughout as  movie @xmath31 \" , consisted of a @xmath141 array of @xmath142 squares whose light intensity was randomly selected to be either bright or dark every 30 ms .",
    "this flickering checkerborad stimulus was formatted into 30 s periods that alternated between non - repeated ( unique ) stimulation and a repeated 30-s  target \" clip .",
    "a total of 69 unique 30-s clips , and 69 repeats of the same 30-s target clip , were presented .      for each dataset",
    ", we discretized spike trains into 20 ms time bins , as in previous work @xcite .",
    "this produces a sequence of binary population response vectors , which we denote as @xmath143 , where @xmath144 labels the neuron identity and @xmath16 the time bin .",
    "we set @xmath145 whenever neuron @xmath17 fired at least one spike within bin @xmath16 , and @xmath99 otherwise .",
    "the analytical form of the k - pairwise maximum entropy distribution is @xcite : @xmath146 and where the  energy function \" @xmath147 is given by : @xmath148 where @xmath149 is the kronecker delta ( i.e. @xmath150 if @xmath151 and @xmath99 otherwise ) , and @xmath152 is the hamming weight of the population response @xmath153 .",
    "we used the same learning procedure presented in ref .",
    "@xcite to compute the parameters of the hamiltonian for the k - pairwise maximum entropy model given measured constraints .",
    "the proof of convergence for the core of this l1-regularized maximum entropy algorithm is given in ref .",
    "the code used to fit the model was written in c++ and matlab ( combined using mex files ) .",
    "the tree hmm models the sequence of observed population responses as ( see ref .",
    "@xcite ) : @xmath154^t } \\left ( \\prod_{t=1}^t q_{\\alpha_t } \\big ( \\vec{\\sigma}(t ) \\big ) \\gamma_{\\alpha_{t-1},\\alpha_t } \\right)\\end{aligned}\\ ] ]    where @xmath155 denotes the total number of time bins , @xmath156 denotes the sequence of latent mode identities , and @xmath157 denotes the emission distribution for mode @xmath158 \\equiv \\{1,\\cdots , m\\}$ ] . in practice , we assume that the transition matrix @xmath159 , which has entries @xmath160 , is stationary ( i.e. time - independent ) .    each emission distribution @xmath161 in the model is a tree graphical model ( see ref .",
    "@xcite ) . let @xmath162 , \\mathcal{e}_{\\alpha } \\big)$ ] denote the underlying graph corresponding with @xmath161 , and let @xmath163 denote the number of possible responses of neuron @xmath17 . in practice , we allow the underlying graph to be a forest ,",
    "so let @xmath164 denote the number of connected components .",
    "then the number of free parameters contributed by each @xmath161 is : @xmath165 } \\big(\\text{deg}(i ) - 1\\big ) r_i - p \\\\ & = \\sum_{(i , j ) \\in \\mathcal{e}_{\\alpha } } r_i r_j - \\sum_{i \\in [ n ] }   r_i \\cdot \\text{deg}(i ) \\\\   & \\:\\:\\ : + \\sum_{i \\in [ n ] } r_i - \\underbrace{\\left(n - \\sum_{(i , j ) \\in \\mathcal{e}_{\\alpha } } 1 \\right)}_p \\\\ & = \\sum_{(i , j ) \\in \\mathcal{e}_{\\alpha } } ( r_i - 1 ) ( r_j -1 ) + \\sum_{i \\in [ n ] } r_i - n \\end{split}\\ ] ]    @xmath10 + in practice , we assume that all neuron responses are binary .",
    "thus , the total number of free parameters for the entire model is : @xmath166    where @xmath167 denotes cardinality .",
    "if the stationary distribution of the markov chain is used , then the total number of free parameters reduces to @xmath168 .    for a fixed number of latent modes @xmath169",
    ", the model was fit to data using the same learning procedure presented in ref .",
    "@xcite . in brief , the model parameters were inferred by maximum likelihood , using the baum - welch algorithm with an m - step modified to accommodate the tree graphical model form of the emission distributions @xmath161 .",
    "full details of the algorithm are described in ref .",
    "the code used to fit the model was written in c++ .    to select the number of latent modes @xmath169 , also called the ",
    "latent dimensionality \" @xcite , we carried out a 2-fold cross - validation procedure in which we randomly chose half of the time bins in the data to assign to the training set ( with the other non - overlapping half assigned to the test set ) .",
    "for the natural movie datasets , @xmath169 was then chosen to be the value which maximized the cross - validated log likelihood ( cv - ll ) , averaged over the 2 folds .",
    "note that to mitigate overfitting , we also incorporated a regularization parameter @xmath170 $ ] in this procedure ( in practice , @xmath171 was used throughout ) , as in @xcite .",
    "for the white noise checkerboard dataset in the high repeat regime , in practice the cv - ll curve often began to saturate at a lower latent dimensionality than the peak .",
    "for this case , as in lakshmanan _",
    "( 2015 ) @xcite , we report the latent dimensionality at which each cv - ll curve reached @xmath172 of its total height , where the height of each cv - ll curve is the difference between its maximum and minimum values over the range of dimensionalities tested .",
    "the motivation behind this choice is that it provides a more parsimonious representation of the data .    in the _ results _ section",
    ", we also report the _",
    "normalized _ cross - validated log - likelihood , @xmath173 , which we define for a given latent dimensionality @xmath174 as : @xmath175}{\\max_m \\big [ \\big \\langle \\mathcal{l}(m,\\theta ) \\big \\rangle \\big ] - \\min_m \\big [ \\big \\langle \\mathcal{l}(m,\\theta ) \\big \\rangle \\big]}\\end{aligned}\\ ] ]    where @xmath176 denotes the log - likelihood of the test dataset @xmath177 for the parameter values @xmath50 obtained via fitting the model to the training set , @xmath178 denotes the average over all @xmath179 cross - validation folds , and the minimum and maximum are taken over all latent dimensionality values @xmath169 considered . note that when exploring the probability landscape modeled by the tree hmm ( see the following section ) , we used the stationary distribution @xmath180 of the fit markov chain ( assumed to be stationary ) , which is defined as the left eigenvector of the transition matrix @xmath159 with unity eigenvalue ( i.e. @xmath181 ) and satisfies @xmath182 ( where @xmath183 denotes vector transpose ) .",
    "this allows us to write the modeled joint probability , @xmath184 , for a single population response @xmath153 as : @xmath185 since for a stationary markov chain , as time @xmath186 , the overall proportion of time spent in mode @xmath121 converges to @xmath187 .      for the parametric repeat analysis using movie @xmath31 , which was an interleaved binary white - noise checkerboard movie stimulus , we normalized the length of each generated subset movie to seventy 30-s movie clips , corresponding with a total duration of 2100 s each .",
    "we quantified the  repeat ratio \" as @xmath188 , where @xmath189 denotes the number of included repeats of the fixed target clip . in practice , @xmath189 varied between 0 and 68 repeats . for each repeat ratio ,",
    "the specific choice of which @xmath189 of the 68 original repeat target clips to include , and the choice of which @xmath190 of the 70 original unique clips to include in the corresponding subset movie , was made in accordance with one of five random sequence permutations .",
    "for the parametric repeat analysis using movie @xmath32 , which was an interleaved natural movie stimulus , we normalized the length of each generated subset movie to seventy - two 60-s movie clips , corresponding with a total duration of 4320 s each . in practice , @xmath189 varied between 0 and 72 repeats . for each repeat ratio ,",
    "the choice of which @xmath189 of the 72 original repeat target clips to include , and the choice of which @xmath191 of the 74 original unique clips to include in the corresponding subset movie , was made in accordance with one of two random sequence permutations .      to coarsely characterize the effect of spike count on the empirical joint response probability landscape , we defined the  scaled count distribution \" , denoted @xmath192 , as : @xmath193    where @xmath194    where @xmath195 denotes the spike count of the population response observed in time bin @xmath16",
    ", @xmath155 denotes the total number of time bins in the data , and @xmath196 denotes the kronecker delta function .",
    "we sought to find the ( true ) local maxima of the modeled probability landscape for our datasets , as defined in ref .",
    "note that this definition is equivalent to what would be termed a  @xmath197-mode \" in applied math @xcite :    a point is a @xmath198__-mode _ _ if and only if its probability is higher than all points within distance @xmath199 under a distance metric @xmath200 .    to our knowledge , with the exception of single tree graphical models ,",
    "it is currently computationally intractable to find all of the local maxima of a discrete high - dimensional probability distribution . since in their general forms neither the maximum entropy models nor the tree hidden markov model are members of this tractable category , we used the same numerical procedure as in @xcite , which is implemented as follows : we start with a population response @xmath6 that appears in the data , and attempt to ` flip ' the responses of neurons @xmath201 , where @xmath202 is a randomly chosen permutation of the @xmath0 neuron indices .",
    "( a different random permutation is independently generated for each starting response @xmath6 .",
    "that is , we attempt to set @xmath203 , where @xmath61 denotes mod 2 addition .",
    "a flip is retained if @xmath204 , where @xmath205 denotes the new response configuration obtained by flipping neuron @xmath206 s response . when none of the @xmath0 neurons can be flipped , the resulting pattern is recorded as a local maximum .",
    "we refer to this numerical procedure throughout as  single spin flip ascent .",
    "\" implementation of the single spin flip ascent procedure was done in matlab .      to find soft local maxima , we used a numerical procedure which we refer to throughout as  neuron pair relaxation . \" conceptually",
    ", the algorithm is implemented as follows : we start with a population response pattern @xmath57 that appears in the data , and attempt to ` flip ' a randomly - chosen pair @xmath58 of neurons ( where @xmath207 $ ] ) which have opposite responses within time bin @xmath16 . that is , @xmath60 , where @xmath61 denotes mod 2 addition .",
    "flipping is retained if the resulting pattern has a higher probability than the original pattern .",
    "note that the order in which these pairs are checked is chosen according to a random permutation , which is independently generated for each iteration of the algorithm .",
    "this procedure is iterated until none of the @xmath62 neuron pairs with opposite instantaneous responses can be flipped to increase the probability ; the terminating pattern is by definition a soft local maximum .",
    "implementation of the neuron pair relaxation procedure was done in matlab .    to investigate how robust the mapping from the dataset of all observed responses with @xmath9 spikes to the set of unique @xmath9-soft local maxima was , we performed @xmath66 independent iterations of our mapping procedure for the movie @xmath29 dataset .",
    "for each iteration , a distinct random sequence of permutations was used for the choice of neuron pairs when implementing the neuron pair relaxation algorithm . for each value of @xmath9",
    ", we then computed the mean pairwise overlap ratio between the identified set of unique @xmath9-soft local maxima for each iteration pair @xmath208 ( there was a total of @xmath209 iteration pairs ) , defined as : @xmath210    where @xmath211 and @xmath169 index one of the 100 mapping iterations performed , @xmath212 denotes the set of unique @xmath9-soft local maxima obtained for the @xmath211-th mapping iteration , and @xmath167 denotes set cardinality .",
    "note that the the mean pairwise overlap ratio values are reported as percentages in fig 6a .",
    "we considered two models of the joint probability mass function ( p.m.f . ) of the rgc population responses : the k - pairwise maximum entropy model and the tree hidden markov model ( recently developed , respectively , in refs . @xcite and @xcite ) .",
    "for our purposes , it is important that the model we choose accurately captures the soft local maxima present ( or not ) in the empirical probability landscape . due to limited sampling",
    ", it is intractable to determine the full empirical probability landscape and hence to make a complete comparison .",
    "however , population response states with low spike count are far better sampled than response states with high spike count .",
    "in particular , we have sufficient sampling of response states with @xmath213 spikes .",
    "thus , we computed the empirical @xmath63-soft local maxima .",
    "this was done by performing @xmath179 iterations ( in practice , we performed @xmath214 iterations ) of the following cross - validation procedure : for each iteration , we    1 .   randomly split the data ( i.e. the set of all responses with 2 spikes ) into two training sets .",
    "2 .   for each of the two training sets , we estimated the empirical p.m.f .",
    "of an observed response state @xmath6 as : @xmath215 where @xmath15 denotes the population response observed in time bin @xmath16 , @xmath155/2 was the total number of time bins in each respective training set , and @xmath216 denotes the kronecker delta function .",
    "3 .   for each of the two training sets",
    ", we then performed neuron pair relaxation on all unique observed responses in the given training half , using the respective estimated empirical p.m.f . to find @xmath63-soft local maxima .    to quantify the results of the above",
    ", we then computed the union of all unique empirical @xmath63-soft local maxima found over the @xmath217 iteration halves . over @xmath218 iterations ( i.e. @xmath219 different splits of the data ) , we found a total of @xmath220 unique @xmath63-soft local maxima . to check",
    "how reliable these results were , we then computed the proportion of occurrence of each of the @xmath220 unique @xmath63-soft local maxima , defined as follows : @xmath221 where @xmath79 denotes the soft local maximum of interest , @xmath222 denotes the set of unique @xmath63-soft local maxima found after performing anti - correlated neuron pair relaxation on the data in half @xmath223 ( where @xmath224 ) , and @xmath225 denotes the indicator function ( i.e. @xmath226 if @xmath227 , 0 otherwise ) .",
    "the resulting proportions of occurrence are shown in fig 12 ( black trace ) .",
    "it is possible that differences obtained between the two splits of the data in the exact identities of the empirical soft local maxima could arise from noise , attributable to limited sampling upon halving the data . to account for this possibility",
    ", we also performed a  relaxed \" version of the above empirical analysis .",
    "in the relaxed version , for each of the 68 unique empirical @xmath63-soft local maxima found combined over all iterations , we performed the following : for each of the @xmath179 iterations , we checked if the given @xmath63-soft local maximum - which we will call @xmath228 - was found when using one data half but not the other .",
    "if so , e.g. if it was found using the first half but not the second , then we performed neuron pair relaxation on @xmath228 , importantly using the p.m.f .",
    "estimated from the data in the second half .",
    "if this resulted in a @xmath63-soft local maximum that had been found originally in the second half - we will call this state @xmath229 - then we say that @xmath228 and @xmath229 are equivalent .",
    "( i.e. in math terms , we identify @xmath228 and @xmath229 as members of the same equivalence class ) . in this case , we updated the proportion of occurrence of @xmath228 by adding a term of @xmath230 . otherwise , the proportion of occurrence of @xmath228 was unmodified",
    ". the updated proportions of occurrence for the relaxed empirical analysis are shown in fig 12 ( light blue trace ) .      to verify that the procedures and code used in the present paper were correct and bug - free , we developed multiple test cases in which the number and identity of local maxima and/or soft local maxima is analytically known .",
    "details are provided in the _ supporting information_. all test cases were successfully passed ( s2 and s3 figs ) .      to visualize specific examples of soft local maxima organization across low to high spike count ( @xmath9 ) levels",
    ", we used a breadth - first search ( bfs)-like algorithm .",
    "the input to this algorithm is a given  root \" soft local maximum , and the output is a rooted digraph which is specific to the input .",
    "nodes of this output rooted digraph represent soft local maxima , and a directed edge @xmath231 exists if and only if soft local maximum @xmath79 is @xmath89-reachable from @xmath6 , as defined in definition [ def:2 ] . given a fixed spike count level @xmath9 ( in practice we used @xmath119 ) , we chose each input  root \" to be one of the @xmath9-soft local maximum found by performing the previously - described neuron pair relaxation procedure on the probability landscape obtained by fitting the tree hmm to data .",
    "since the neuron pair relaxation algorithm involves a random permutation of the sequence of neuron pairs to flip , i.e. is not deterministic , for each neuron @xmath17 in the silent set of the current @xmath9-soft local maximum , @xmath109 , we performed @xmath111 iterations of the neuron pair relaxation procedure on @xmath112 , each time using a different , independent choice of the random permutation .",
    "we then set the weight of each directed edge @xmath116 , which we denote by @xmath114 , as the proportion of the @xmath111 relaxation iterations which resulted in @xmath94 . to mitigate effects due to noise",
    ", for each unique @xmath88-soft local maximum @xmath115 reached after performing the above procedure on a given @xmath108 , we further only included the directed edge @xmath116 if @xmath114 exceeded a reliability threshold @xmath118 .    to aid with visualizing distinct ridges",
    ", we also assigned an @xmath24- and @xmath25-coordinate to each node @xmath108 ( i.e. soft local maximum ) in the output rooted digraphs as follows :    1 .",
    "the @xmath25-coordinate , denoted @xmath232 , was set to @xmath9 ( i.e. the spike - count of @xmath108 ) .",
    "our choice of formulation for the @xmath24-coordinate was based on two motivating criteria : first , we wanted to be able to visualize potential  jumps \" in ridge organization , due to the current identified ridge either terminating at a lower spike count level than the one we chose arbitrarily to explore out to , or / and branching into multiple distinct ridges .",
    "examples of this scenario can be seen in figs 8c and 9b .",
    "second , we wanted to visualize only  genuine \" jumps or branching , with respect to the notion of neuron communities . specifically",
    ", after inspection of preliminary digraph visualizations , we noticed that ` connected ' ( i.e. @xmath89-reachable ) soft local maxima seemed to each have an activity set of active neurons that was a subset of a larger unique group ( which we term the  neuron community \" ) .",
    "we thus post - hoc formulated our definition of the @xmath24-coordinate for our digraph visualizations to aid us in examining how prevalent this property was .",
    "since community structure is a clustering property in the graph of neurons , we needed to define an overlap measure between the activity sets of different soft local maxima .",
    "the natural distance metric based on overlap is : @xmath233 + where @xmath234 denotes a higher spike - count level , @xmath235 denotes the  activity set \" ( i.e. set of active neurons ) of soft local maximum @xmath79 , and @xmath167 denotes cardinality .",
    "note that if there is complete overlap of the activity sets , i.e. @xmath236 , then @xmath237 , and thus @xmath238 .",
    "+ conceptually , for a given @xmath108 , we first computed the succession of all pairwise @xmath89-reachable soft local maxima out to the chosen maximum spike count level , and allowed the algorithm to potentially consider all soft local maxima @xmath239 at a higher spike count level ( i.e. @xmath240 ) .",
    "we then chose to assign to @xmath108 the same @xmath24-coordinate as the soft local maximum which was closest in terms of overlap , @xmath241 , plus an offset equal to the overlap distance between @xmath108 and @xmath241 .",
    "that is , formally , we assigned : @xmath242 where @xmath243 + in the case of a tie for eq . [ eq:14 ]",
    "( for example , if the considered @xmath244 had complete overlap of its activity set with both @xmath245 and @xmath246 ) , we chose the soft local maximum at the nearest spike count level to be @xmath241 ( i.e. in the above example , we would choose @xmath247 , and would assign @xmath244 the same @xmath24-coordinate as @xmath245 ) .",
    "+ fig 8a provides an example of why this formulation considering all higher spike count levels is advantageous for our purposes of assigning the @xmath24-coordinate based on only pairwise overlap : if the latter were used , then @xmath248 in fig 8a would be assigned an @xmath24-coordinate offset from @xmath249 by @xmath51 unit , resulting in a new branch",
    ". however , this branch would be artificial with respect to the notion of a neuron community , since @xmath250 and @xmath251 .",
    "thus , @xmath249 should be assigned the same @xmath24-coordinate at @xmath252 .",
    "in addition , we assigned a color to each node in each output rooted digraph visualization , which uniquely corresponds with the map ( maximum _ a posteriori _ ) estimate @xmath121 of the latent tree hmm mode for the associated soft local maximum @xmath79 , given by : @xmath253 \\\\ & = \\arg\\max_{\\alpha } \\left [ \\psi_{\\alpha } q_{\\alpha}(\\vec{\\gamma } ) \\right ] \\end{split}\\ ] ]    where @xmath254 denotes the stationary distribution of the markov chain , and @xmath157 is the emission distribution for mode @xmath121 ( see _ methods : fitting the tree hidden markov model _ ) .",
    "for the dataset of @xmath41 ganglion cells responding to the non - repeated natural movie ( i.e. movie @xmath29 ) , the optimal latent dimensionality was 19 tree hmm modes ; there were thus 19 unique possible colors .",
    "visualization of the rooted digraphs computed via the bfs algorithm ( examples of which are shown in figs 8 and 9 ) was automated using the _ igraph _ package in r.    we also investigated the organization of soft local maxima across high to low spike count ( @xmath9 ) levels ; example results are shown in s7 fig .",
    "for this analysis , a rooted digraph was constructed , but where each root node was taken to be a soft local maximum found ( by performing neuron pair relaxation on the data ) at a high @xmath9 level ( e.g. @xmath255 ) , and where a directed edge @xmath256 was added if and only if soft local maximum @xmath79 is @xmath90-reachable from @xmath6 ( see definition [ def:3 ] ) .",
    "note that we report the @xmath89-reachable version ( i.e. starting from a low spike count root node and progressing out to higher spike count levels ) in the main text , as we have more reliable sampling of the data at low spike count levels .",
    "fig 10a was made using the _ igraph _ package in r.        to generate this control , for each neuron @xmath17 in the population we performed a  complete shuffle \" on neuron @xmath17 s discretized spike train ( binned into @xmath155 total @xmath257 time bins ) occurring in the data , by implementing a random permutation of the @xmath155 time bins .",
    "note that an independent random permutation was implemented for each neuron .",
    "this complete shuffling procedure eliminates all signal and noise correlations among neurons in the population , but retains the firing rate of each neuron over the course of the experimental recording .",
    "thus , the control ` dataset ' of joint responses generated via this procedure corresponds with a population of neurons which fire independently , but which have heterogeneous firing rates that match the original data .      to generate this control , we first computed the average firing rate from the data , @xmath258 , over the entire population of @xmath0 ganglion cells , where @xmath259 .",
    "we then simulated an independent population of matched size @xmath0 in which each neuron @xmath17 was assigned to have its firing rate @xmath260 .",
    "thus , the control ` dataset ' of joint responses generated via this procedure corresponds with a population of neurons which fire independently , and moreover have homogeneous firing rates .",
    "10    perkel d , bullock t. .",
    "neurosci res program bull .",
    "1968;6:221343 .",
    "rieke f , warland d , de ruyter van steveninck r , bialek w. .",
    "mit press ; 1999 .",
    "dayan p , abbott l. .",
    "mit press ; 2001 .",
    "kalaska jf , crammond dj . .",
    "science . 1992;255:1517 - 23 .",
    "ahissar m , ahissar e , bergman h , vaadia e. .",
    "j neurophysiol . 1992;67:203 - 215 .",
    "georgopoulos ap . .",
    "trends neurosci . 1995;18:506 - 510 .",
    "nicolelis mal , baccala la , lin rc , chapin jk . .",
    "1995;268:13531358 .",
    "sakurai y. .",
    "neurosci res . 1996;26:1 - 16 .",
    "ghazanfar aa , nicolelis mal . .",
    "j neurophysiol . 1997;78:506 - 510 .",
    "nicolelis mal , fanselow ee , ghazanfar aa . .",
    "neuron . 1997;19:219 - 21 .",
    "stopfer m , vivek j , gilles l. .",
    "2003;39(6):991 - 1004 .",
    "puchalla jl , schneidman e , harris ra , berry mj . .",
    "2005 ; 46(3):493 - 504 .",
    "mazor o , laurent g. .",
    "2005;48:661673 .",
    "fujisawa s , amarasingham a , harrison mt , buzsaki g. .",
    "nat neurosci .",
    "2008 ; 11:823833 .",
    "truccolo w , hochberg lr , donoghue jp . .",
    "nat neurosci .",
    "2010;13:105111 .",
    "harvey cd , coen p , tank dw . .",
    "2012;484:6268 .",
    "ganmor e , segev r , schneidman e. .",
    "2015;4:e06134 .",
    "greenberg ds , houweling ar , kerr jnd . .",
    "nat neurosci . 2008;11:749 - 751 .",
    "shlens j , field gd , gauthier jl , greschner m , sher a , litke am , chichilnisky ej . .",
    "j neurosci .",
    "2009 apr 15;29(15):5022 - 31 .",
    "marre o , amodei d , deshmukh n , sadeghi k , soo f , holy te ,",
    "_ et al_. .",
    "j neurosci .",
    "2012 oct 24;32(43):14859 - 38 .",
    "ahrens mb , orger mb , robson dn , li jm , keller pj . .",
    "nat methods .",
    "2013 march 12;10:413 - 20 .",
    "schneidman e , berry mj ii , segev r , bialek w. .",
    "2006;440:10071012 .",
    "pillow jw , shlens j , paninski l , sher a , litke am , chichilnisky ej , simoncelli ep . .",
    "2008;454:995999 .",
    "osborne lc , palmer se , lisberger sg , bialek w. .",
    "j neurosci .",
    "2008 dec 10;28(50):13522 - 31 .",
    "marre o , boustani ei , fregnac y , destexhe a. .",
    "phys rev lett .",
    "2009 april 2;102(13):138101 .",
    "ohiorhenuan ie , mechler f , purpura kp , schmid am , hu q , victor jd . . nature .",
    "2010 jul 29;466(7306):617 - 21 .",
    "ganmor e , segev r , schneidman e. .",
    "proc natl acad sci usa .",
    "2011;108:96799684 .",
    "schwartz g , macke j , amodei d , tang h , berry mj , 2nd . .",
    "j neurophysiol . 2012;108:10691088 .",
    "zohary e , shadlen mn , newsome wt . .",
    "1994;370:140143 .",
    "abbott lf , dayan p. .",
    "neural comput .",
    "1999;11:91101 .",
    "sompolinsky h , yoon h , kang k , shamir m. .",
    "phys rev e. 2001 oct 17;64:051904 .    da silveira ra , berry mj , 2nd . .",
    "plos comput biol .",
    "2014 nov 20;10(11):e1003970 .",
    "vidne m , ahmadian y , shlens j , pillow jw , kulkarni j , litke am , chichilnisky ej , simoncelli e , paninski l. .",
    "j comput neurosci . 2012;33(1):97 - 121 .",
    "granot - atedgi e , tkacik g , segev r , schneidman e. .",
    "plos comput biol .",
    "2013;9(3):e1002922 .",
    "prentice js , marre o , ioffe ml , tkacik g , berry mj , 2nd . .",
    "plos comput biol .",
    "2016 . in press .",
    "shlens j , field gd , gauthier jl , grivich mi , petrusca d , sher a , litke am , chichilnisky ej . .",
    "j neurosci .",
    "2006 aug 9;26(32):8254 - 66 .",
    "vasquez jc , o , palacios ag , berry mj , 2nd , cessac b. . arxiv;2011:1112.2464v1 .",
    "ganmor e , segev r , schneidman e. .",
    "j neurosci .",
    "2011 feb 23;31(8):3044 - 3054 .",
    "nasser h , marre o , cessac b. .",
    "j stat mech .",
    "2013 march 12;03p03006 .",
    "watanabe t , hirose s , wada h , imai y , machida t , shirouzu i , konishi s , miyashita y , masuda n. .",
    "nat commun .",
    "2013 jan 22;1370 .",
    "tkacik g , marre o , amodei d , schneidman e , bialek w , berry mj , 2nd . .",
    "plos comput biol .",
    "2014 jan;10(1):e1003408 .",
    "mora t , deny s , marre o. .",
    "phys rev lett .",
    "2015 feb 20;114:078105 .",
    "parisi g , mezard m , virasoro ma . .",
    "world scientific ; 1987 .",
    "mainen zf , sejnowski tj . .",
    "1995;268:15031506 .",
    "schneidman e , freedman b , segev i. .",
    "neural comput .",
    "1998;10:16791703 .",
    "osborne lc , lisberger sg , bialek w. .",
    "nature . 2005;437:412 - 6 .",
    "faisal aa , selen lp , wolpert dm . .",
    "nat rev neurosci .",
    "2008;9:292303 .",
    "berry mj , warland dk , meister m. .",
    "proc natl acad sci usa .",
    "1997;94:54115416 .",
    "de ruyter van steveninck rr , lewen gd , strong sp , koberle r , bialek w. . science .",
    "1997;275:18051808 .",
    "reich ds , mechler f , victor jd . .",
    "2001;294:25662568 .",
    "shannon , ce . .",
    "bell labs tech j. 1948 ; 27:379423 , 623656 .",
    "roth , rm . .",
    "cambridge university press ; 2006 .",
    "sreenivasan s , fiete i. .",
    "nat neurosci .",
    "2011;14:13301337 .",
    "curto c , itskov v , morrison k , roth z , walker jl . .",
    "neural comput .",
    "2013;25:18911925 .    fortunato s. .",
    "2010;485(3):75 - 132 .",
    "chen c , liu h , metaxas dn , zhao t. . adv neural inf process syst .",
    "2014 dec;27:5533 - 51 .",
    "haralick r. .",
    "cvgip . 1983;22:28 - 38 .",
    "eberly d , gardner r , morse b , pizer s , scharlach c. .",
    "j math imaging vis . 1994;4:353 - 373 .",
    "dudik m , phillips sj , schapire re .",
    ". proceedings 17th annual conference on learning theory . 2004 .",
    "meila m , jaakkola t. .",
    "stat comput .",
    "2006 jan;16(1):7792 .",
    "lakshmanan kc , sadtler pt , tyler - kabara ec , batista ap , yu bm . .",
    "neural comput . 2015;27:1825 - 56 .",
    "schneidman e , puchalla jl , segev r , harris ra , bialek w , berry mj , 2nd . .",
    "j neurosci .",
    "nov 2;31(44):1573215741 .",
    "huang h , toyoizumi t. .",
    "phys rev e. 2016;93 .",
    "hebb do . .",
    "new york : wiley and sons ; 1949 .",
    "wickelgren wa . .",
    "concepts neurosci . 1992;1:1 - 53 .",
    "leg@xmath261ndy cr . .",
    "math biosci . 1967;1:555 - 597 .",
    "kanerva p. .",
    "cambridge : mit press ; 1988 .",
    "barlow , hb . perception . 1972;1:371 - 394 .",
    "brenner n , strong sp , koberle r , bialek w , de ruyter van stevenick rr . .",
    "neural comput .",
    "2000;12:1531 - 1552 .",
    "quian quiroga r , panzeri s. .",
    "nat rev neurosci .",
    "2009 mar;10(3):173 - 85 .",
    "schnitzer mj , meister m. .",
    "2003 feb;37:499 - 511 .",
    "mezard m , montanari a. .",
    "oxford university press , oxford ; 2009 .    dong dw , atick jj . . network .",
    "1995;6:345358 .",
    "victor jd , purpura kp . .",
    "j neurophysiol .",
    "1996 aug;76(2):1310 - 27 .",
    "victor jd , purpura kp . .",
    "j neurophysiol .",
    "1998 aug;80(2):554 - 71 .",
    "meister m , berry mj , 2nd . .",
    "1999 mar;22:435450 .",
    "fairhall al , lewen jd , bialek w , de ruyter van stevenick rr . .",
    "2001 aug;412:787 - 92 .",
    "ayaz a , saleem ab , scholvinck ml , carandini m. .",
    "curr biol .",
    "2013;23:890894 .    @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 +",
    "to verify that the procedures presented in the main text were correct , and that the corresponding code was bug - free , we developed three test cases in which the number of local maxima and/or soft local maxima was analytically known .",
    "a detailed description of each analytical test case is provided in the following .",
    "the number and identity of all true local maxima in the probability landscape is analytically known for this test case , which we define as follows : let @xmath262 denote the stimulus space , where @xmath263 , i.e. denotes a random variable which is uniformly distributed .",
    "the scenario is a population of @xmath0 neurons , where each neuron @xmath17 has its firing rate @xmath163 defined as @xmath264 = \\left\\ {          \\begin{array}{ll }              c & , \\ : i \\in z_l \\subset [ n ] \\\\              0 & , \\ : o.w .",
    "\\end{array }      \\right .",
    "\\label{eq:1}\\ ] ] where @xmath265 $ ] ( i.e. @xmath211 indexes stimuli and @xmath17 indexes neurons ) , and @xmath266 = 0 \\:\\ : \\forall \\ : i \\in [ n ]",
    "\\setminus \\cup_l z_l$ ] . without loss of generality , we take @xmath267 , @xmath268 , @xmath269 , and take the constant @xmath270 .",
    "let @xmath271 , where @xmath272 , @xmath273 , and @xmath274 .",
    "note that neurons in this scenario fire independently conditioned on the stimulus , i.e. @xmath275 = \\frac{1}{3 } \\sum_{l=1}^{3 } \\left [ \\prod_{i \\in [ n ] } r_i[s_l]^{\\sigma_i } ( 1-r_i[s_l])^{(1-\\sigma_i ) } \\right ] \\label{eq:2}\\ ] ]    thus , combining eqs .",
    "[ eq:1 ] and [ eq:2 ] , @xmath275 = \\left\\ {          \\begin{array}{ll }              \\frac{1}{3 } \\cdot c^3 & , \\ : \\vec{\\sigma } \\in \\mathcal{m } \\\\",
    "\\frac{1}{3 } \\left[c^2(1-c ) \\right ] & , \\ : \\exists \\:\\ : l \\ : \\text{s.t . } \\ : \\{i | \\sigma_i = 1 \\ } \\cap z_l = 2 , \\:\\ : \\ & \\:\\ : w_h(\\vec{\\sigma } ) = 2 \\\\",
    "\\frac{1}{3 } \\left[c(1-c)^2 \\right ] & , \\ : \\exists \\:\\ : l \\ : \\text{s.t . }",
    "\\{i | \\sigma_i = 1 \\ } \\cap z_l = 1 , \\:\\ : \\ & \\:\\ : w_h(\\vec{\\sigma } ) = 1 \\\\              ( 1-c)^3 & , \\ : \\vec{\\sigma } = \\vec{0 } \\\\              0 & , \\ : otherwise          \\end{array }      \\right.\\ ] ] where @xmath153 denotes a possible population response pattern , and @xmath86 denotes hamming weight .",
    "note that @xmath276 \\setminus \\left(z_1 \\cup z_2",
    "\\cup z_3 \\right)$ ] , a state with @xmath277 will introduce a @xmath99 in the product for all three summand terms in eq .",
    "( @xmath278 ) , which is why @xmath279 = 0 $ ] for all other states than those listed in eq .",
    "( @xmath280 ) .",
    "thus , if a hamming distance of one is used as the distance metric , then there are exactly three local maxima : @xmath281 , @xmath282 and @xmath283 . for illustrative purposes ,",
    "an example possible energy descent trajectory is ( where below we use the index set notation for a response state , i.e. the bijective mapping @xmath284 | \\sigma_i = 1 \\}$ ] ) : @xmath285 test case i was successfully passed by the combination of our tree hmm fitting code and single spin flip ascent code ( see s2a fig for results ) .",
    "the number and identity of all local maxima in the probability landscape is analytically known for this test case , defined as follows : let @xmath286 denote the stimulus space , where @xmath287 .",
    "the scenario is a population of @xmath0 neurons , where each neuron @xmath17 s firing rate @xmath163 is given by : @xmath288 & = \\left\\ {          \\begin{array}{ll }              c_1=0.7 & , \\ :",
    "i \\in [ 20 ] \\\\              0 & , \\ : 21 \\leq i \\leq n          \\end{array }      \\right .",
    "\\\\ r_i[s_2 ] & = \\left\\ {          \\begin{array}{ll }              0 & , \\ : i \\in [ 20 ] \\\\              c_1=0.7 & , \\ :",
    "21 \\leq i \\leq n          \\end{array }      \\right .",
    "\\\\ r_i[s_4 ] & = \\left\\ {          \\begin{array}{ll }              c_2=0.8 & , \\ : i \\in \\{1,n\\ } \\\\              0 & , \\ : otherwise          \\end{array }      \\right . \\end{split}\\ ] ] and @xmath289 = 0 \\ : \\forall i \\in [ n]$ ] .",
    "there are exactly four analytically - known local maxima : @xmath20 , @xmath290 , @xmath291 , and @xmath292 ( where we have represented each binary response pattern by its set of active neurons ) .",
    "it can be shown analytically that for each of these four response states , changing any one neuron s response will result in a response state with higher energy than the original state .",
    "test case ii was successfully passed by the combination of our tree hmm fitting code and single spin flip ascent code ( see s2b fig for results ) .      in this test case ,",
    "all possible ( @xmath119)-soft local maxima of the probability landscape are analytically known .",
    "the scenario is a stimulus space , @xmath293 , consisting of six uniformly - presented stimuli , i.e. @xmath294 , where @xmath295 .",
    "each stimulus @xmath296 maps to one of six population response vectors of hamming weight @xmath297 or @xmath99 in the population response space , @xmath97 ( where here @xmath298 neurons ) .",
    "i.e. the population of @xmath219 neurons is partitioned into six  communities \" of subsets of neurons . in particular",
    ", this toy system uses the following encoding : @xmath299 noise is introduced according to a binary asymmetric channel ( bac ) , where @xmath300 $ ] , @xmath264 \\equiv p[\\sigma_i=1 | s_l ] = \\left\\ {          \\begin{array}{ll }              p \\equiv 0.2 & , \\ :",
    "i \\in c_l \\\\              q \\equiv 0.001 & , \\ : o.w .",
    "\\\\          \\end{array }      \\right.\\ ] ] in this scenario , neuron responses are conditionally independent given the stimuli , i.e.    @xmath275 = \\frac{1}{6 } \\sum_{l=1}^6 \\left [ \\prod_{i=1}^{30 } r_i[s_l]^{\\sigma_i } ( 1-r_i[s_l])^{(1-\\sigma_i ) } \\right]\\ ] ]    in this case , there is only one true local maxima : the all - silent state , @xmath301 .",
    "however , if we restrict ourselves to only looking at population responses with spike count @xmath9 ( e.g. @xmath119 ) , then any state @xmath153 which satisfies @xmath302 for some @xmath303 will be stable under anti - correlated neuron pair relaxation dynamics ( i.e. will be a @xmath9-soft local maximum ) .",
    "test case iii was successfully passed by the combination of our tree hmm fitting code and anti - correlated neuron pair relaxation code ( see s3 fig for results ) ."
  ],
  "abstract_text": [
    "<S> throughout the brain , local circuits encode information using large populations of neurons , yet the structure of this population code remains poorly understood . </S>",
    "<S> previous studies applying the maximum entropy principle to retinal multi - electrode array data have shown that the joint probability distribution over all retinal ganglion cell population states is proliferated by local maxima , which represents a form of clustering of visual stimuli into a discrete set of categories . however , these studies focused on responses to highly repeated stimuli . </S>",
    "<S> another recent study using a hidden markov model approach likewise found that ganglion cell population activity partitioned into noise - robust clusters , and further that this clustering was present for the non - repeated stimulus regime . here </S>",
    "<S> , we investigate the relationship between the clusters found using these two different modeling approaches . </S>",
    "<S> we first demonstrate that local maxima in the probability landscape result from the repeat structure of the stimulus ensemble , and are absent in the more realistic , non - repeated stimulus regime . </S>",
    "<S> nonetheless , we show that structure is still present in the non - repeated stimulus regime in the form of what we call  soft local maxima , \" which are local maxima within the subspace of all neural activity states that are restricted to have the same spike count . using a numerical approach </S>",
    "<S> , we show that soft local maxima are organized into a reliable sequence across the different spike count levels , which altogether has the geometry of a  ridge . \" </S>",
    "<S> these ridges closely corresponded with the clusters formulated by the hidden markov model , and moreover with neuron  communities , \" in the sense defined in computer science . </S>",
    "<S> these findings suggest a unified description of the ganglion cell population code across different stimulus repeat statistics , and suggest that ridges or communities may be an important feature of the output population activity extracted by visual processing areas downstream of the retina .    </S>",
    "<S> while the manner in which information is represented in the brain has been intensively studied at the single neuron level @xcite , ample experimental evidence and theoretical consideration have made it evident that neural circuits generally encode and transmit information using large populations of neurons @xcite . with the advent of new experimental technologies </S>",
    "<S> , it is becoming increasingly tractable to record from large neuron populations @xcite , facilitating questions about the empirical nature of neural population coding that were previously unaddressable . </S>",
    "<S> fundamental to most conceptual approaches toward answering these questions is , as with the single neuron case , characterizing the probability distribution over all neural responses . </S>",
    "<S> the key additional issue when considering the multi - neuron scenario however , is the nature of correlations among neurons , which fundamentally shape the joint probability distribution of population response patterns . </S>",
    "<S> recent information theoretic and statistical model - based approaches applied to data have established that pairwise and higher - order correlations are highly non - negligible in real , large neuron populations @xcite . </S>",
    "<S> moreover , analytical studies have shown that the structure of correlations has a profound effect on shaping the capacity of neural population codes @xcite .    </S>",
    "<S> due to the combinatorial explosion of possible joint responses - i.e. a population of @xmath0 neurons , with binarized spiking , could theoretically encode @xmath1 distinct binary population response patterns - and limited sampling , it is generally empirically intractable to determine the joint probability mass function ( p.m.f . ) for @xmath2 neurons . </S>",
    "<S> this is problematic , given that the relevant population coding units in many brain regions are of the order of hundreds of neurons . </S>",
    "<S> for example , in the salamander retina , it is known that a single region of visual space maps onto a population of retinal ganglion cells ( rgcs ) numbering @xmath3200 cells @xcite . to give another example </S>",
    "<S> , an average single pyramidal neuron receives synaptic inputs from tens of thousands of excitatory synapses , and several thousand inhibitory synapses @xcite . </S>",
    "<S> thus , in order to investigate questions about population coding at the relevant scale , a model of the joint p.m.f is needed .    within computational neuroscience </S>",
    "<S> , there are two fundamentally distinct methodologies that have been used to create probabilistic models of network activity . the traditional approach - which includes linear - nonlinear - poisson ( lnp ) and generalized linear models ( glms ) - attempts to explicitly capture the dependence of neuron responses on the stimulus @xcite . here </S>",
    "<S> we will refer to such models as  encoding models , \" as this term has been previously used @xcite . </S>",
    "<S> the second approach , which we call the  activity model \" approach , involves directly modeling the structure of population activity , without any reference to the stimulus . </S>",
    "<S> an important advantage of activity models is that they correspond with the unsupervised problem actually faced by downstream brain areas , which lack direct access to both the external stimuli and biophysical parameters of the upstream area . </S>",
    "<S> the most well - studied activity models are the class of maximum entropy ( maxent ) models @xcite . </S>",
    "<S> conceptually , the central idea of the maxent framework is to choose the unique model of the p.m.f . which reproduces a given set of experimental observations , while importantly being the least structured among all possible models that likewise satisfy these constraints . </S>",
    "<S> the well - studied pairwise maxent model takes as constraints the experimentally - estimated mean firing rates and pairwise correlations @xcite .    </S>",
    "<S> a notable feature of the pairwise maxent approach is that the mathematical form of the modeled probability distribution is equivalent to a well - known distribution in statistical physics : the boltzmann distribution of an ising spin glass model at a temperature @xmath4 @xcite . </S>",
    "<S> the pairwise interaction parameters ( see eq . ( [ eq:2 ] ) in _ methods _ ) learned by fitting maxent models have been reported to feature both positive and negative values @xcite . in spin glass models , </S>",
    "<S> such disordered interactions are known to lead to an energy function with many local minima , also called  basins \" ( see fig 1b ) . </S>",
    "<S> consistent with this , previous work which fit the k - pairwise maxent model ( see _ methods _ ) to a large dataset of rgcs responding to a highly - repeated natural movie stimulus reported a proliferation of basins in the energy landscape @xcite . </S>",
    "<S> thus , arising from the maximum entropy literature was the idea that a proliferation of local maxima is a feature of the rgc population response probability landscape .    -dimensional space . </S>",
    "<S> the actual domain of the joint p.m.f . </S>",
    "<S> considered in the present paper is discrete and high - dimensional ; in particular , an @xmath0-dimensional hypercube . * </S>",
    "<S> ( b ) * cartoon of basins in the energy landscape corresponding with the probability landscape shown in panel ( @xmath5 ) . </S>",
    "<S> a response state @xmath6 which is a local maximum of the joint p.m.f . @xmath7 equivalently corresponds with a basin in the associated energy landscape , since the energy @xmath8 . ]    </S>",
    "<S> the reason why this feature is important , is due to its connections with another critical issue that must be considered when attempting to discern the nature of neural population codes : noise . </S>",
    "<S> noise is prevalent at all levels throughout the nervous system @xcite . </S>",
    "<S> consequently , even when presented with identical stimuli , sensory neuron populations exhibit joint response patterns with high trial - to - trial variability @xcite . how the brain solves the problem of accurately decoding population activity in the presence of noise is unknown . in communications engineering , </S>",
    "<S> a similar problem of achieving the high degree of reliability required by modern data transmission and storage systems has been addressed by the design of what are called  error - correcting codes \" , which are encoding schemes that enable accurate decoding even when the transmitted information has been corrupted by noise @xcite . traditionally , engineered error - correcting codes achieve this robustness by introducing redundancy so that the full space of possible output patterns is partitioned into subsets , such that all noise - corrupted versions of the same input message map to the same subset . </S>",
    "<S> consistent with this notion , it has been empirically found that the retinal code is highly redundant @xcite . </S>",
    "<S> likewise consistent , the authors in @xcite found that the set of disparate population responses elicited by repeated presentations of an identical stimulus could be mapped to a basin assignment which was reproducible across the repeats . </S>",
    "<S> this noise - robust partitioning idea has also gained attention by other recent works in the field @xcite .    in particular , using another type of activity model called the tree hidden markov model ( hmm ) , which was recently developed in @xcite , it was found that the joint responses of large populations of rgcs naturally partitions into a discrete set of  collective modes . </S>",
    "<S> \" moreover , the many disparate response patterns evoked by an identical stimulus were found to preferentially map to the same collective mode @xcite . </S>",
    "<S> importantly , these latent modes were identified by fitting the tree hmm only to the portion of responses elicited by _ non - repeated _ stimulus segments . </S>",
    "<S> thus , in contrast to @xcite , this error - correction capacity was obtained for the non - repeated stimulus regime . </S>",
    "<S> it should be emphasized that the collective modes in @xcite were explicitly formulated by the tree hmm statistical model , whereas the local maxima reported in @xcite were defined geometrically after fitting the maxent model . </S>",
    "<S> this thus leaves open the question : how are these two different definitions of population  codewords \" related ? </S>",
    "<S> more specifically , what , if any , is the precise geometric interpretation of the collective modes in relation to the rgc joint response probability landscape ?    here , we address this question . </S>",
    "<S> we obtained multi - electrode array data from large datasets of salamander rgcs simultaneously responding to various visual stimuli ( population sizes ranged from 128 to 170 rgcs ) , and modeled the corresponding response probability landscapes with either the tree hmm or @xmath9-pairwise maxent model . </S>",
    "<S> we found that the qualitative structure of the rgc joint response probability landscape depended strongly on the repeat structure of the stimulus ensemble . </S>",
    "<S> in particular , for non- and mildly - repeated stimulus ensembles , non - silent local maxima were exceedingly rare . </S>",
    "<S> we then introduced a new notion of structure , here termed  soft local maxima , \" which conceptually are local maxima in the space of all neural responses that are restricted to have the same spike count , @xmath9 . </S>",
    "<S> these soft local maxima were robustly prevalent at each spike count level examined . using a numerical approach </S>",
    "<S> , we then explored their organization across spike count levels . </S>",
    "<S> this approach leads to an algorithm that links together different soft local maxima into a discrete  ridge \" , which is a geometric feature of the joint probability landscape of neural activity . </S>",
    "<S> we found that there was a close correspondence between these ridges and the collective modes formulated by the tree hmm . </S>",
    "<S> our results moreover indicate that these ridges may correspond with neuron  communities , \" a notion from computer science @xcite . </S>",
    "<S> thus , our results suggest a unified picture linking statistically - defined noise - robust modes of the retinal population code and geometric structure in the joint probability landscape . </S>",
    "<S> specifically , we find that under broad stimulus ensembles , neural population responses cluster into a discrete set of ridges ; but when particular stimuli are encountered frequently , local peaks are additionally formed in the probability landscape . </S>",
    "<S> @xmath10 + @xmath10 + @xmath10 + @xmath10 + @xmath10 + </S>"
  ]
}