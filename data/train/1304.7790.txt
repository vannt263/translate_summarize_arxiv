{
  "article_text": [
    "permutations realized by the orbits of a map on a one - dimensional interval have received a significant amount of attention in the last few years  @xcite .",
    "these are the permutations given by the relative order of the elements of the sequence obtained by successively iterating the map , starting from any point in the interval .",
    "one the one hand , understanding these permutations provides a powerful tool to distinguish random from deterministic time series , based on the remarkable fact  @xcite that every piecewise monotone map has forbidden patterns , i.e. , permutations that are not realized by any orbit .",
    "permutation - based tests for this purpose have been developed in  @xcite .",
    "on the other hand , the set of permutations realized by a map ( also called allowed patterns ) is closed under consecutive pattern containment .",
    "this gives rise to enumerative questions about pattern - avoiding permutations whose answer provides information about the associated dynamical systems . for example , determining the asymptotic growth of the number of allowed patterns of a map reveals its so - called topological entropy , an important measure of the complexity of the system .    among the dynamical systems most commonly studied from the perspective of forbidden patterns",
    "are shifts , and more generally signed shifts  @xcite .",
    "signed shifts form a large family of maps that includes the tent map , which is equivalent to the logistic map in terms of forbidden patterns .",
    "as we will see , signed shifts have a simple discrete structure which makes them amenable to a combinatorial approach , yet they include many important chaotic dynamical systems .",
    "permutations realized by shifts were first considered in  @xcite , and later characterized and enumerated in  @xcite .",
    "more recently , permutations realized by the more general @xmath0-shifts have been studied in  @xcite . for the logistic map ,",
    "some properties of their set of forbidden patterns were given in  @xcite .",
    "if instead of considering an arbitrary initial point in the domain of the map we restrict our attention to periodic points , the permutations realized by the relative order of the entries in the corresponding orbits ( up until the first repetition ) are called _",
    "periodic patterns_. in the case of continuous maps , sharkovskii s theorem  @xcite gives a beautiful characterization of the possible periods of these orbits .",
    "more refined results that consider which periodic patterns are forced by others are known for continuous maps  @xcite . in an equivalent form ,",
    "periodic orbits of the tent map were studied in  @xcite in connection to bifurcations of stable periodic orbits in a certain family of quadratic maps .",
    "however , little is known when the maps are not continuous , as is the case for shifts and for most signed shifts .",
    "the subject of study of this paper are periodic patterns of signed shifts .",
    "our main result is a characterization of the periodic patterns of an ( almost ) arbitrary signed shift , given in theorem  [ thm : description of periodic patterns ] .",
    "for some particular cases of signed shifts we obtain exact enumeration formulas : the number of periodic patterns of the tent map is given in theorem  [ thm : enumtent ] , recovering a formula of weiss and rogers  @xcite , and the number of periodic patterns of the ( unsigned ) shift map is given in theorem  [ thm : enum shift ] . for the reverse shift , which is not covered in our main theorem ,",
    "formulas for the number of periodic patterns , which depend on the residue class of @xmath1 , are given in sections  [ sec : reverse ] and  [ sec : reverse2odd ] .",
    "an interesting consequence of our study of periodic patterns is that we obtain new results ( and some old ones ) regarding the enumeration of cyclic permutations that avoid certain patterns .",
    "these are described in section  [ sec : patternsincycles ] .      given a linearly ordered set @xmath2 and a map @xmath3 , consider the sequence @xmath4 obtained by iterating the function starting at a point @xmath5 .",
    "if there are no repetitions among the first @xmath6 elements of this sequence , called the _ orbit _ of @xmath7 , then we define the _ pattern _ of length @xmath6 of @xmath8 at @xmath7 to be @xmath9 where @xmath10 is the _ reduction _ operation that outputs the permutation of @xmath11= \\{1,2,\\dots , n\\}$ ]",
    "whose entries are in the same relative order as @xmath6 entries in the input .",
    "for example , @xmath12 .",
    "if @xmath13 for some @xmath14 , then @xmath15 is not defined .",
    "the set of _ allowed patterns _ of @xmath8 is @xmath16    we say that @xmath17 is an _",
    "@xmath6-periodic point _ of @xmath8 if @xmath18 but @xmath19 for @xmath20 , and in this case the set @xmath21 is called an @xmath6-periodic orbit . if @xmath7 is an @xmath6-periodic point , the permutation @xmath15 is denoted @xmath22 , and is called the _ periodic pattern _ of @xmath8 at @xmath7 .",
    "let @xmath23 and let @xmath24 be the set of _ periodic patterns _ of @xmath8",
    ". for a permutation @xmath25 , let @xmath26=\\{\\pi_i\\pi_{i+1}\\dots\\pi_n\\pi_1\\dots\\pi_{i-1}:1\\le i\\le n\\}$ ] denote the set of cyclic rotations of @xmath27 , which we call the _ equivalence class _ of @xmath27 .",
    "it is clear that if @xmath28 , then @xmath26\\subset{\\mathcal p}(f)$ ] .",
    "indeed , if @xmath27 is the periodic pattern at a point @xmath7 , then the other permutations in @xmath26 $ ] are realized at the other points in the periodic orbit of @xmath7 .",
    "thus it is convenient to define the set @xmath29:\\pi\\in{\\mathcal p}_n(f)\\}$ ] , consisting of the equivalence classes of periodic patterns of @xmath8 of length @xmath6",
    ". we will be interested in finding the cardinality of this for certain maps @xmath8 , which we denote @xmath30 .",
    "given linearly ordered sets @xmath2 and @xmath31 , two maps @xmath3 and @xmath32 are said to be _ order - isomorphic _ if there is an order - preserving bijection @xmath33 such that @xmath34 . in this case ,",
    "@xmath35 for every @xmath5 and @xmath36 .",
    "in particular , @xmath37 and @xmath38 .",
    "let @xmath39 be fixed , and let @xmath40 be the set of infinite words",
    "@xmath41 over the alphabet @xmath42 .",
    "let @xmath43 denote the lexicographic order on these words .",
    "we use the notation @xmath44 , and @xmath45 .",
    "if @xmath46 is a finite word , @xmath47 denotes concatenation of @xmath46 with itself @xmath48 times , and @xmath49 is an infinite periodic word .",
    "fix @xmath50 .",
    "let @xmath51 and @xmath52 , and note that these sets form a partition of @xmath42 .",
    "we give two definitions of the signed shift with signature @xmath53 , and show that they are order - isomorphic to each other .    the first definition , which we denote by @xmath54 , is the map @xmath55 defined by @xmath56 the order - preserving transformation @xmath57 , < ) \\\\ & s_1s_2s_3s_4 \\dots & \\mapsto & \\sum_{i\\ge0 }   s_i k^{-i-1 } \\end{array}\\ ] ] can be used to show ( see  @xcite ) that @xmath54 is order - isomorphic to the piecewise linear function @xmath58\\to[0,1]$ ] defined for @xmath59 , for each @xmath60 , as @xmath61 as a consequence , the allowed patterns and the periodic patterns of @xmath54 are the same as those of @xmath62 , respectively .",
    "a few examples of the function @xmath62 are pictured in figure  [ fig : signedshifts ] .     for @xmath63 , @xmath64 , @xmath65 and @xmath66 , respectively.,title=\"fig : \" ]   for @xmath63 , @xmath64 , @xmath65 and @xmath66 , respectively.,title=\"fig : \" ]   for @xmath63 , @xmath64 , @xmath65 and @xmath66 , respectively.,title=\"fig : \" ]    we next give another definition of the signed shift that will be more convenient when studying its periodic patterns .",
    "let @xmath67 be the linear order on @xmath40 defined by @xmath68 if one of the following holds :",
    "1 .   @xmath69 , 2 .",
    "@xmath70 and @xmath71 , or 3 .",
    "@xmath72 and @xmath73 .",
    "equivalently , @xmath74 if , letting @xmath75 be the smallest such that @xmath76 , either @xmath77 is even and @xmath78 , or @xmath79 is odd and @xmath80 .",
    "the signed shift is the map @xmath81 defined simply by @xmath82 .    to show that the two definitions of the signed shift as @xmath83 and @xmath54 are order - isomorphic , consider the order - preserving bijection @xmath84 that maps a word @xmath85 to the word @xmath86 where @xmath87 it is easy to check that @xmath88 , and so @xmath89 . using the definition of the signed shift as @xmath83 , it is clear that its @xmath6-periodic points are the periodic words in @xmath40 with period @xmath6 , that is , words of the form @xmath90 where @xmath91 is _ primitive _ ( sometimes called _ aperiodic _ ) , that is , not a concatenation of copies of a strictly shorter word .",
    "we denote by @xmath92 the set of periodic words in @xmath40 with period @xmath6 , and by @xmath93 the set of @xmath6-periodic orbits , where each orbit consists of the @xmath6 shifts of an @xmath6-periodic word .",
    "for example , if @xmath94 , then @xmath95 is an @xmath96-periodic point of @xmath83 , and @xmath97 .    if @xmath98 , then @xmath67 is the lexicographic order @xmath43 , and @xmath83 is called the _",
    "@xmath99-shift_. when @xmath100 , the map @xmath83 is called the _",
    "reverse @xmath99-shift_. when @xmath101 , the map @xmath83 is the well - known _",
    "tent map_.      let @xmath102 denote the set of permutations of @xmath11 $ ] .",
    "we write permutations in one line notation as @xmath25 .",
    "we say that @xmath103 _ contains _",
    "@xmath104 if there exist indices @xmath105 such that @xmath106 . otherwise , we say that @xmath107 _ avoids _ @xmath108 .",
    "we denote by @xmath109 the set of permutations avoiding @xmath108 , and we define @xmath110 analogously as the set of permutations avoiding all the patterns @xmath111 .",
    "a set of permutations @xmath112 is called a _ ( permutation ) class _ if it is closed under pattern containment , that is , if a @xmath113 and @xmath107 contains @xmath108 , then @xmath114 .",
    "sets of the form @xmath110 are permutation classes .",
    "for example , @xmath115 is the class of decreasing permutations .    given classes @xmath116 , their juxtaposition , denoted @xmath117 $ ] , is the set of permutations that can be expressed as concatenations @xmath118 where @xmath119 for all @xmath120 .",
    "for example , @xmath121 $ ] is the set of _ unimodal _ permutations , i.e. , those @xmath122 satisfying @xmath123 for some @xmath124 .",
    "the juxtaposition of permutation classes is again a class , and as such , it can be characterized in terms of pattern avoidance .",
    "for example , @xmath125 = \\operatorname{av}(213 , 312)$ ] .",
    "atkinson  @xcite showed that if @xmath126 can be characterized by avoidance of a finite set of patterns for each @xmath127 , then the same is true for @xmath117 $ ] .",
    "let @xmath50 as before .",
    "in order to characterize the periodic patterns of @xmath83 , we define a class @xmath128 of permutations , called the _",
    "@xmath53-class _ , which also appeared in  @xcite .",
    "let @xmath128 be the juxtaposition @xmath129 $ ] where , for @xmath120 , @xmath130 for example , @xmath131 is the class of unimodal permutations , and @xmath132 is the class of _ grassmannian _ permutations , i.e. , those with at most one descent . let @xmath133 .",
    "some examples of elements in @xmath134 $ ] are the permutations @xmath135 and @xmath136 , drawn in figure  [ fig : perm ] .",
    "note that the empty permutation belongs to @xmath137 and to @xmath115 , so one trivially has @xmath138 , for example .",
    "if @xmath139 , a _ @xmath53-segmentation _ of @xmath107 is a sequence @xmath140 satisfying that each segment @xmath141 is increasing if @xmath142 and decreasing if @xmath143 . by definition , permutations in @xmath128 are precisely those that admit a @xmath53-segmentation .",
    "( 0,0 ) grid ( 12,12 ) ; ( 0,0 )  ( 12,12 ) ; ( .5,.5 ) (.5,2.5 ) ; ( .5,2.5 ) (2.5,2.5);(2.5,2.5 ) (2.5,7.5 ) ; ( 2.5,7.5 ) (7.5,7.5);(7.5,7.5 ) (7.5,.5 ) ; ( 7.5,.5 ) (.5,.5);(1.5,1.5 ) (1.5,4.5 ) ; ( 1.5,4.5 ) (4.5,4.5);(4.5,4.5 ) (4.5,10.5 ) ; ( 4.5,10.5 ) (10.5,10.5);(10.5,10.5 ) (10.5,3.5 ) ; ( 10.5,3.5 ) (3.5,3.5);(3.5,3.5 ) (3.5,8.5 ) ; ( 3.5,8.5 ) (8.5,8.5);(8.5,8.5 ) (8.5,11.5 ) ; ( 8.5,11.5 ) (11.5,11.5);(11.5,11.5 ) (11.5,1.5 ) ; ( 11.5,1.5 ) (1.5,1.5);(5.5,5.5 ) (5.5,6.5 ) ; ( 5.5,6.5 ) (6.5,6.5);(6.5,6.5 ) (6.5,5.5 ) ; ( 6.5,5.5 ) (5.5,5.5);(0,2 )  ( 1,3 ) ; ( 0,3 )  ( 1,2);(1,4 ) ",
    "( 2,5 ) ; ( 1,5 ) ",
    "( 2,4);(2,7 ) ",
    "( 3,8 ) ; ( 2,8 ) ",
    "( 3,7);(3,8 ) ",
    "( 4,9 ) ; ( 3,9 ) ",
    "( 4,8);(4,10 ) ",
    "( 5,11 ) ; ( 4,11 ) ",
    "( 5,10);(5,6 ) ",
    "( 6,7 ) ; ( 5,7 ) ",
    "( 6,6);(6,5 ) ",
    "( 7,6 ) ; ( 6,6 ) ",
    "( 7,5);(7,0 ) ",
    "( 8,1 ) ; ( 7,1 ) ",
    "( 8,0);(8,11 ) ",
    "( 9,12 ) ; ( 8,12 ) ",
    "( 9,11);(9,9 ) ",
    "( 10,10 ) ; ( 9,10 ) ",
    "( 10,9);(10,3 ) ",
    "( 11,4 ) ; ( 10,4 ) ",
    "( 11,3);(11,1 ) ",
    "( 12,2 ) ; ( 11,2 )  ( 12,1 ) ;    ( 0,0 ) grid ( 12,12 ) ; ( 0,0 )  ( 12,12 ) ; ( .5,.5 ) (.5,1.5 ) ; ( .5,1.5 ) (1.5,1.5 ) ; ( 1.5,1.5 ) (1.5,4.5 ) ; ( 1.5,4.5 ) (4.5,4.5 ) ; ( 4.5,4.5 ) (4.5,10.5 ) ; ( 4.5,10.5 ) (10.5,10.5 ) ; ( 10.5,10.5 ) (10.5,6.5 ) ; ( 10.5,6.5 ) (6.5,6.5 ) ; ( 6.5,6.5 ) (6.5,3.5 ) ; ( 6.5,3.5 ) (3.5,3.5 ) ; ( 3.5,3.5 ) (3.5,9.5 ) ; ( 3.5,9.5 ) (9.5,9.5 ) ; ( 9.5,9.5 ) (9.5,11.5 ) ; ( 9.5,11.5 ) (11.5,11.5 ) ; ( 11.5,11.5 ) (11.5,5.5 ) ; ( 11.5,5.5 ) (5.5,5.5 ) ; ( 5.5,5.5 ) (5.5,7.5 ) ; ( 5.5,7.5 ) (7.5,7.5 ) ; ( 7.5,7.5 ) (7.5,2.5 ) ; ( 7.5,2.5 ) (2.5,2.5 ) ; ( 2.5,2.5 ) (2.5,8.5 ) ; ( 2.5,8.5 ) (8.5,8.5 ) ; ( 8.5,8.5 ) (8.5,.5 ) ; ( 8.5,.5 ) (.5,.5 ) ; ( 0,1 )  ( 1,2 ) ; ( 0,2 )  ( 1,1 ) ; ( 1,4 ) ",
    "( 2,5 ) ; ( 1,5 ) ",
    "( 2,4 ) ; ( 2,8 ) ",
    "( 3,9 ) ; ( 2,9 ) ",
    "( 3,8 ) ; ( 3,9 ) ",
    "( 4,10 ) ; ( 3,10 ) ",
    "( 4,9 ) ; ( 4,10 ) ",
    "( 5,11 ) ; ( 4,11 ) ",
    "( 5,10 ) ; ( 5,7 ) ",
    "( 6,8 ) ; ( 5,8 ) ",
    "( 6,7 ) ; ( 6,3 ) ",
    "( 7,4 ) ; ( 6,4 ) ",
    "( 7,3 ) ; ( 7,2 ) ",
    "( 8,3 ) ; ( 7,3 )  ( 8,2 ) ; ( 8,0 ) ",
    "( 9,1 ) ; ( 8,1 ) ",
    "( 9,0 ) ; ( 9,11 )  ( 10,12 ) ; ( 9,12 ) ",
    "( 10,11 ) ; ( 10,6 ) ",
    "( 11,7 ) ; ( 10,7 ) ",
    "( 11,6 ) ; ( 11,5 ) ",
    "( 12,6 ) ; ( 11,6 ) ",
    "( 12,5 ) ;    we denote by @xmath144 ( respectively , @xmath145 , @xmath146 ) the set of cyclic permutations in @xmath102 ( respectively , @xmath128 , @xmath147 ) . in figure",
    "[ fig : perm ] , the permutation on the right is in @xmath145 while the permutation on the left is not",
    ". it will be useful to define the map @xmath148 where if @xmath149 in one - line notation , then @xmath150 in cycle notation , that is , @xmath151 is the cyclic permutation that sends @xmath152 to @xmath153 , @xmath153 to @xmath154 , and so on .",
    "writing @xmath155 in one - line notation , we have that @xmath156 for @xmath157 , with the convention that @xmath158 .",
    "for example , if @xmath159 , then @xmath160 .",
    "the map @xmath161 also plays an important role in  @xcite .",
    "note that all the elements in the set @xmath26 $ ] of cyclic rotations of @xmath27 are mapped to the same element @xmath162 .",
    "thus , letting @xmath163:\\pi\\in { \\mathcal s}_n\\}$ ] , this map induces a bijection @xmath164 between @xmath165 and @xmath144 , defined by @xmath166)={\\hat{\\pi}}$ ] .",
    "the main theorem of this paper is the following characterization of the periodic patterns of the signed shift @xmath83 , except in the case of the reverse shift . throughout the paper",
    "we assume that @xmath39 .",
    "[ thm : description of periodic patterns ] let @xmath167 , @xmath168 .",
    "then @xmath169 if and only if @xmath170 .    an equivalent restatement of this theorem",
    ", whose proof will require a few lemmas , is that @xmath164 restricts to a bijection between @xmath171 and @xmath146 .",
    "the following lemma describes some conditions satisfied by the periodic patterns of @xmath83 , proving the forward direction of theorem  [ thm : description of periodic patterns ] . for convenience",
    ", we will use the notation @xmath172 or @xmath173 instead of @xmath174 .",
    "thus , for @xmath167 , @xmath175 is a surjective map from @xmath92 to @xmath176 .",
    "if @xmath122 , we will say that a word @xmath91 is _ @xmath27-monotone _ if @xmath177 whenever @xmath178 .",
    "[ lem : ppat ] let @xmath179 be arbitrary , let @xmath180 , and let @xmath181 be such that @xmath182 . for @xmath183 , let @xmath184:s_i < t\\}|$ ] , and let @xmath185 .",
    "the following statements hold :    1 .   the word @xmath91 is _ @xmath27-monotone _ , that is , @xmath186 if and only if @xmath187 .",
    "2 .   if @xmath188 , then @xmath189 if @xmath142 , and @xmath190 if @xmath191 , where we let @xmath158 .",
    "3 .   the sequence @xmath192 is a @xmath53-segmentation of @xmath151 .",
    "in particular , @xmath170 .    since @xmath193 , it is clear for all @xmath194 $ ] , @xmath178 implies @xmath177 , from where part 1 follows . to prove part 2 , suppose that @xmath188 , and so @xmath195 . by part 1",
    ", we have @xmath196 . if @xmath142 , then @xmath197 , and so @xmath189 .",
    "similarly , if @xmath191 , then @xmath198 , and so @xmath190 .    now let @xmath120 , and suppose that the indices @xmath199 such that @xmath200 are @xmath201 , ordered in such a way that @xmath202 , where @xmath203 .",
    "then part 1 implies that @xmath204 for @xmath205 , and part 2 implies that @xmath206 if @xmath207 , and @xmath208 if @xmath143 .",
    "using that @xmath209 , this is equivalent to @xmath210 if @xmath207 , and @xmath211 if @xmath143 .",
    "note that @xmath212 , so this condition states that @xmath192 is a @xmath53-segmentation of @xmath151 . since @xmath151 is a cyclic permutation , this proves that @xmath213 .",
    "the next three lemmas will be used in the proof of the backward direction of theorem  [ thm : description of periodic patterns ] .",
    "[ lem : csigma ] let @xmath179 be arbitrary , let @xmath122 , and suppose that @xmath140 is a @xmath53-segmentation of @xmath151 .",
    "suppose that @xmath214 for some @xmath215 .",
    "then @xmath189 if @xmath142 , and @xmath190 if @xmath191 , where we let @xmath158 .    since @xmath214 ,",
    "both @xmath216 and @xmath217 lie in the segment @xmath218 .",
    "if @xmath142 , this segment is increasing , so @xmath219 .",
    "the argument is analogous if @xmath191 .",
    "it is important to note that for any @xmath122 and any sequence @xmath140 , there is a unique @xmath27-monotone word @xmath91 such that @xmath220:s_i < t\\}|=e_t$ ] for every @xmath127 .",
    "this word is defined by letting @xmath221 whenever @xmath222 .",
    "we say that @xmath91 is the _",
    "@xmath27-monotone word induced by _",
    "@xmath223 .",
    "[ lem : sisj ] let @xmath167 be arbitrary , and let @xmath122 be such that @xmath170 . take any @xmath53-segmentation of @xmath151 , and let @xmath224 be the @xmath27-monotone word induced by it .",
    "let @xmath225 .",
    "if @xmath226 are such that @xmath227 , then either @xmath228 or @xmath229 .",
    "in particular , if @xmath224 is primitive , then @xmath193 .",
    "suppose that @xmath227 . if @xmath230 , let @xmath231 be the smallest such that @xmath232 , and let @xmath233 . if @xmath234 is even , then lemma [ lem : csigma ] applied @xmath235 times shows that @xmath236 . since @xmath237 , we must then have @xmath238 , because of @xmath27-monotonicity .",
    "thus , @xmath239 by definition of @xmath67 , since the word @xmath240 has an even number of letters in @xmath241 .",
    "similarly , if @xmath234 is odd , then lemma [ lem : csigma ] shows that @xmath242 . since @xmath237",
    ", we must have @xmath243 , and thus @xmath239 by definition of @xmath67 .",
    "if @xmath224 is primitive , the case @xmath228 can never occur when @xmath244 , and so @xmath227 if and only if @xmath229 .",
    "it follows that @xmath193 .",
    "[ lem : s1sn ] let @xmath167 be arbitrary . if @xmath100 , additionally assume that @xmath245 .",
    "let @xmath122 be such that @xmath170 .",
    "then there exists a @xmath53-segmentation of @xmath151 such that the @xmath27-monotone word @xmath224 induced by it is primitive , and the word @xmath246 satisfies @xmath193 .",
    "furthermore , if @xmath247 or @xmath100 , then _ every _ @xmath53-segmentation of @xmath151 has this property .    since @xmath170 , it admits some @xmath53-segmentation .",
    "pick one , say @xmath140 , and let @xmath224 be the @xmath27-monotone word induced by it . in this proof",
    "we take the indices of @xmath27 mod @xmath6 , that is , we define @xmath248 for @xmath249 $ ] .",
    "suppose that @xmath224 is not primitive , so it can be written as @xmath47 for some @xmath250 and some primitive word @xmath46 with @xmath251 .",
    "then , @xmath252 for all @xmath253 .",
    "let @xmath254 :   s_i \\in t^-_\\sigma\\}|$ ] .",
    "fix @xmath253 , and let @xmath255 .",
    "because of the way that @xmath224 is defined , we must have @xmath256 , so we can apply lemma  [ lem : csigma ] to this pair .",
    "suppose first that @xmath257 is even . if @xmath258 , then applying lemma  [ lem : csigma ] @xmath259 times we get @xmath260 , since the inequality involving @xmath261 and @xmath262 switches exactly @xmath257 times as @xmath263 increases from @xmath264 to @xmath259 .",
    "starting with @xmath265 and applying this argument repeatedly , we see that if @xmath266 , then @xmath267 , which is a contradiction .",
    "a symmetric argument shows that if @xmath268 , then @xmath269 .",
    "it remains to consider the case that @xmath257 is odd . if @xmath48 is even and @xmath270 , then letting @xmath271 we have @xmath272 . letting @xmath273 and @xmath274 :   s_i \\in t^-_\\sigma\\}|=2g$ ] , the same argument as above using @xmath275 and @xmath276 yields a contradiction .",
    "if @xmath48 is odd , suppose without loss of generality that @xmath266 .",
    "note that applying lemma  [ lem : csigma ] @xmath259 times to the inequality @xmath258 ( respectively @xmath277 ) yields @xmath278 ( respectively @xmath260 ) in this case , since the inequality involving @xmath261 and @xmath262 switches an odd number of times . consider two cases :    * if @xmath279 , then lemma  [ lem : csigma ] applied repeatedly in blocks of @xmath280 times yields @xmath281 .",
    "applying now lemma  [ lem : csigma ] @xmath259 times starting with @xmath282 gives @xmath283 , which contradicts the assumption @xmath266 .",
    "* if @xmath284 , applying lemma  [ lem : csigma ] @xmath259 times we get @xmath285 , and by repeated application of the lemma in blocks of @xmath280 times it follows that @xmath286 , contradicting again the assumption @xmath266 .",
    "the only case left is when @xmath257 is odd and @xmath287 , that is , when @xmath288 and @xmath46 has an odd number of letters in @xmath241 .",
    "note that this situation does not happen when @xmath98 ( since in this case @xmath289 ) and , although it can happen when @xmath100 , in this case we would have that @xmath290 , and so @xmath291 , which we are excluding in the statement of the theorem .",
    "thus , we can assume that there exists some @xmath292 such that @xmath293 is either @xmath294 or @xmath295 .",
    "we will show that there is a @xmath53-segmentation @xmath296 of @xmath151 such that the @xmath27-monotone word @xmath297 induced by it is primitive .",
    "suppose that @xmath298 ( the case @xmath299 is very similar )",
    ". then @xmath300 and @xmath301 .",
    "if @xmath302 ( respectively , @xmath303 ) , let @xmath304 ( respectively , @xmath305 ) , and @xmath306 for all @xmath307 . clearly @xmath308 is a @xmath53-segmentation of @xmath151 .",
    "its induced @xmath27-monotone word @xmath309 differs from the original word @xmath310 by one entry , making the number of @xmath263s that appear in @xmath309 be odd instead of even .",
    "thus , @xmath309 can no longer be written as @xmath311 for any @xmath312 , so it is primitive by the above argument .",
    "we have shown that there is always a @xmath53-segmentation of @xmath151 such that the @xmath27-monotone word induced by it is primitive .",
    "denote this word by @xmath224 , and let @xmath246 .",
    "now lemma  [",
    "lem : sisj ] shows that @xmath193 .",
    "we can now combine the above lemmas to prove our main theorem .    if @xmath169 , then @xmath170 by part 3 of lemma [ lem : ppat ] .",
    "conversely , @xmath122 is such that @xmath170 , then the word @xmath313 constructed in lemma  [ lem : s1sn ] satisfies @xmath193 , and so @xmath169 .    for @xmath100 , the same proof yields the following weaker result .",
    "[ prop : description reverse ] let @xmath314 .",
    "if @xmath180 , then @xmath315 . additionally , the converse holds if @xmath316 .    in section",
    "[ sec : reverse2odd ] , when we enumerate the periodic patterns of the reverse shift , we will see exactly for how many patterns the converse fails when @xmath316 .",
    "we end this section describing the effect ( also mentioned in  @xcite ) of reversing @xmath53 on the allowed patterns of @xmath83 .",
    "define the reversal of @xmath317 to be @xmath318 .",
    "if @xmath122 , then the complement of @xmath27 is the permutation @xmath319 where @xmath320 for @xmath157 .",
    "[ prop : pi complement ] for every @xmath179 , @xmath321 if and only if @xmath322 , and @xmath169 if and",
    "only if @xmath323 .    given @xmath324 , let @xmath325 be the word whose @xmath253th letter is @xmath326 for all @xmath253 .",
    "for the first statement , it is enough to show that @xmath327 if and only if @xmath328 .",
    "this will follow if we show that for words @xmath313 and @xmath127 , @xmath74",
    "if and only if @xmath329 . to prove this claim , let @xmath199 be the first position where @xmath313 and @xmath127 differ .",
    "then @xmath199 is also the first position where @xmath330 and @xmath331 differ , and @xmath78 if and only if @xmath332 . by definition , @xmath333 if and only if @xmath334 , from where the claim follows .    since @xmath313 is periodic of period @xmath6 if and only if @xmath330 is as well , the result for periodic patterns holds as well .",
    "proposition  [ prop : pi complement ] can be stated more generally for any function @xmath335\\to[0,1]$ ] as follows . if we define @xmath336\\to[0,1]$ ] by @xmath337 , we see by induction on @xmath253 that @xmath338 for @xmath339 .",
    "it follows that @xmath340 for all @xmath341 $ ] , and so @xmath8 and @xmath257 have the same number of allowed and periodic patterns .",
    "for particular values of @xmath53 , we can give a formula for the number of periodic patterns of @xmath83 .",
    "this is the case when @xmath342 ( equivalently , when @xmath343 ) , @xmath98 , and @xmath344 , for any @xmath39 .",
    "recall that @xmath345 is the number of equivalence classes @xmath26 $ ] of periodic patterns of @xmath83 .",
    "[ lem : periodic orbits ] for any @xmath179 with @xmath346 , the number of @xmath6-periodic orbits of @xmath83 is @xmath347 where @xmath348 denotes the mbius function .",
    "recall that @xmath93 is the set of @xmath6-periodic orbits of @xmath83 , and that each such orbit consists of the @xmath6 shifts of an @xmath6-periodic point @xmath349 , where @xmath91 is primitive .",
    "thus , @xmath350 is the number of primitive words of length @xmath6 over a @xmath99-letter alphabet up to cyclic rotation . in different terminology , this is the number of @xmath6-bead primitive necklaces with @xmath99 colors , which is well - known to equal the formula in the statement .    in some of the proofs in this section , it will be useful to refer to the diagram in figure  [ fig : maps ] , which summarizes some of the maps involved . if @xmath179 , we denote by @xmath351 ( or @xmath352 ) the map from @xmath93 to @xmath171 that sends the periodic orbit of @xmath353 to the equivalence class @xmath26 $ ] , where @xmath182 .",
    "this map is clearly well defined .",
    "\\(m ) [ matrix of math nodes , row sep=2.5em , column sep=4em , minimum width=2em ] w_k , n & p_n ( _ ) & + _ k , n & _ n ( _ ) & c_n^ + ; ( m-1 - 1 ) edge [ dashed ] ( m-2 - 1 ) edge node [ above ] @xmath175 ( m-1 - 2 ) ( m-1 - 2 ) edge [ dashed ] ( m-2 - 2 ) edge node [ above right ] @xmath161 ( m-2 - 3 ) ( m-2 - 1 ) edge node [ above ] @xmath351 ( m-2 - 2 ) ( m-2 - 2 ) edge node [ above ] @xmath164 ( m-2 - 3 ) ;    the following lemmas will also be needed when counting periodic patterns of shifts and reverse shifts .",
    "[ lem : iff ] suppose that @xmath247 , or that @xmath100 and @xmath354 .",
    "let @xmath180 ( equivalently , by theorem  [ thm : description of periodic patterns ] and proposition  [ prop : description reverse ] , @xmath355 ) , and let @xmath356",
    ". then @xmath313 satisfies @xmath193 if and only if @xmath224 is the @xmath27-monotone word induced by some @xmath53-segmentation of @xmath151 .    if @xmath193 , then by lemma  [ lem : ppat ] , @xmath224 is the @xmath27-monotone word induced by the @xmath53-segmentation @xmath192 , where @xmath184:s_i < t\\}|$ ] .",
    "conversely , given any @xmath53-segmentation @xmath223 of @xmath151 , then the last statement in lemma  [ lem : s1sn ] implies that the @xmath27-monotone word @xmath224 induced by it satisfies @xmath357 .",
    "we denote the tent map by @xmath358 .",
    "recall that @xmath359 is order - isomorphic to the map on the unit interval whose graph appears on the left of figure  [ fig : maps ] .",
    "the characterization of the periodic patterns of @xmath359 follows from theorem [ thm : description of periodic patterns ] , noticing that permutations in the class @xmath360 $ ] are precisely unimodal permutations .",
    "[ cor : pptent ] @xmath361 if and only if @xmath151 is unimodal .    the proof of the next theorem , which gives a formula for the number of periodic patterns of the tent map , is closely related to a construction of weiss and rogers  @xcite aimed at counting unimodal cyclic permutations , even though the notion of periodic patterns of a map had not yet been developed .",
    "[ thm : enumtent ] @xmath362    let @xmath363 be the set of binary words @xmath364 where the primitive word @xmath224 has an odd number of ones .",
    "we will show that the map @xmath365 restricts a bijection between @xmath363 and @xmath366 .",
    "we will prove that for each @xmath367 there are either one or two elements @xmath368 such that @xmath369 , and that exactly one of them is in @xmath363 .",
    "fix @xmath367 , and recall from corollary  [ cor : pptent ] that @xmath370 for some @xmath48 .",
    "let @xmath364 be such that @xmath369 , and let @xmath371 .",
    "by part 3 of lemma  [ lem : ppat ] , we have @xmath372 and @xmath373 .",
    "it follows that @xmath374 or @xmath375 , corresponding to the two @xmath294-segmentations of @xmath151 .",
    "since @xmath224 is @xmath27-monotone by part 1 of lemma  [ lem : ppat ] , the words corresponding to these two possibilities for @xmath376 differ only in one position ( specifically , in @xmath377 , where @xmath199 is such that @xmath378 ) . in general , as shown in the proof of lemma  [ lem : s1sn ] , the word @xmath224 induced by a @xmath294-segmentation of @xmath151 may not be primitive .",
    "however , this can only happen when @xmath6 is even and @xmath379 , in which case @xmath224 would have an even number of ones .",
    "thus , among the two possibilities for @xmath376 , the one in which @xmath224 has an odd number of ones guarantees that this word is primitive , and so @xmath380 and @xmath369 .    to find @xmath381 we use the mbius inversion formula .",
    "let @xmath382 be the number of primitive binary words of length @xmath6 with an odd number of ones , and note that @xmath383 .",
    "let @xmath384 be the number of binary words ( not necessarily primitive ) of length @xmath6 with an odd number of ones .",
    "it is well known that @xmath385 .",
    "every such word can be written as @xmath386 , where @xmath46 is primitive and has an odd number of ones , and @xmath376 is an odd number that divides @xmath6 .",
    "it follows that @xmath387 writing @xmath388 , where @xmath48 is odd , and letting @xmath389 and @xmath390 , the above formula becomes @xmath391 thus , by mbius inversion , @xmath392 which is equivalent to @xmath393 it follows that @xmath394    the proof of theorem [ thm : enumtent ] , in combination with corollary [ cor : pptent ] , shows that the map @xmath395 is a bijection between primitive binary necklaces ( words up to cyclic rotation ) with an odd number of ones and unimodal cyclic permutations .",
    "[ cor:-+ ] @xmath396    this follows immediately from proposition [ prop : pi complement ] and theorem [ thm : enumtent ] .",
    "recall that the @xmath99-shift is the map @xmath83 where @xmath397 .",
    "let us denote this map by @xmath398 for convenience .",
    "the second picture in figure  [ fig : maps ] shows the graph of a map on the unit interval that is order - isomorphic to @xmath399 .",
    "the allowed patterns of the @xmath99-shift were characterized and enumerated by elizalde  @xcite , building up on work by amig _",
    "et al . _",
    "@xcite .    in this section",
    "we describe and enumerate the periodic patterns of the @xmath99-shift .",
    "denote the descent set of @xmath122 by @xmath400:\\pi_i>\\pi_{i+1}\\}$ ] , and by @xmath401 the number of descents of @xmath27 . in the case of the @xmath99-shift ,",
    "theorem [ thm : description of periodic patterns ] states that @xmath402 if and only if @xmath151 is a cyclic permutation that can be written as a concatenation of @xmath99 increasing sequences .",
    "the following corollary follows from this description .",
    "[ cor : ppshift ] @xmath402 if and only if @xmath403",
    ".    in other words , @xmath164 gives a bijection between @xmath404 and permutations in @xmath144 with at most @xmath405 descents .",
    "it will be convenient to define , for @xmath157 , @xmath406 we start by giving a formula for the number of periodic patterns of the binary shift .",
    "recall the formula for @xmath407 given in eq .  .",
    "[ thm : enum2shift ] for @xmath408 , @xmath409    when @xmath408 , there are no permutations in @xmath144 with no descents . by proposition  [ prop : description reverse ] , the map @xmath164 gives a bijection between @xmath410 and @xmath411 , so @xmath412 .",
    "next we show that the map @xmath413 is a bijection , and therefore so is the map @xmath414 ( see figure  [ fig : maps ] ) , which implies that @xmath415 by lemma  [ lem : periodic orbits ] . by definition ,",
    "the map @xmath413 is surjective , so we just need to show that it is injective as well .",
    "let @xmath416 , and let @xmath417 be such that @xmath418 . by lemma  [ lem : iff ] , @xmath224 is the @xmath27-monotone word induced by some @xmath419-segmentation of @xmath151 .",
    "since @xmath151 has one descent , there is only one such segmentation , so @xmath313 is uniquely determined .    for @xmath420",
    ", we have the following result .",
    "[ thm : enum shift ] for @xmath420 and @xmath408 , @xmath421    by corollary  [ cor : ppshift ] , @xmath422 if and only if @xmath423 , and so @xmath164 is a bijection between @xmath424 and @xmath6-cycles with @xmath405 descents , from where @xmath425 .    to prove the recursive formula for @xmath426 , we find the cardinality of @xmath93 in two ways .",
    "on one hand , this number equals @xmath407 by lemma  [ lem : periodic orbits ] . on the other hand , consider the map @xmath427 , which is surjective , but in general not injective .",
    "we can obtain @xmath350 by adding the cardinalities of the preimages of the elements of @xmath404 under this map .    for fixed @xmath428 ,",
    "let us count how many words @xmath353 satisfy @xmath429 ( equivalently , how many orbits in @xmath93 are mapped to @xmath26 $ ] by @xmath430 ) . by lemma  [ lem : iff ] , this number is equal to the number of @xmath431-segmentations of @xmath151 . if @xmath432 , it is a simple exercise to show that there are @xmath433 such segmentations @xmath140 , since @xmath434 has to be a subset of @xmath435 .    by corollary  [ cor : ppshift ] , for each @xmath436 , the number of equivalence classes @xmath26\\in{\\overline{\\mathcal p}}_n(\\sigma_k)$ ] where @xmath432 is @xmath437 .",
    "it follows that @xmath438 which is equivalent to the stated formula .",
    "it is clear from theorem  [ thm : enum shift ] that for @xmath408 , @xmath439 let us show an example that illustrates how , in the above proof , the words @xmath353 with @xmath429 are constructed for given @xmath27 .",
    "let @xmath440 , and let @xmath441 .",
    "then @xmath442 , which has descent set @xmath443 .",
    "the @xmath444-segmentation with @xmath445 , @xmath446 , @xmath447 induces the @xmath27-monotone word @xmath448 .",
    "the @xmath444-segmentation with @xmath449 , @xmath450 , @xmath451 , @xmath452 induces @xmath453 .",
    "we conclude by mentioning that the second equality in theorem [ thm : enum shift ] also follows from a result of gessel and reutenauer ( * ? ? ?",
    "* theorem 6.1 ) , which is proved using quasi - symmetric functions .",
    "the reverse @xmath99-shift is the map @xmath83 where @xmath344 .",
    "we denote this map by @xmath455 in this section .",
    "the third picture in figure  [ fig : maps ] shows the graph of a map on the unit interval that is order - isomorphic to @xmath456 .",
    "denote the ascent set of @xmath122 by @xmath457:\\pi_i<\\pi_{i+1}\\}$ ] , and by @xmath458 the number of ascents of @xmath27 .",
    "proposition [ prop : description reverse ] gives a partial characterization of the periodic patterns of @xmath455 . for patterns of length @xmath459 ,",
    "it states that @xmath460 if and only if @xmath151 can be written as a concatenation of @xmath99 decreasing sequences .",
    "the next corollary follows from this description .",
    "the case @xmath461 will be discussed in section [ sec : reverse2odd ] .",
    "[ cor : rev shift ] let @xmath122 , where @xmath462",
    ". then @xmath463 if and only if @xmath464 .    to enumerate periodic patterns of @xmath455 of length @xmath465",
    ", we use an argument very similar to the one we used for @xmath398 . for @xmath157 , let @xmath466 by definition , we have @xmath467 .",
    "the following result is analogous to theorem  [ thm : enum2shift ] for the reverse binary shift .",
    "[ thm : enum2rs ] for @xmath468 with @xmath462 , @xmath469    since @xmath468 , there are no permutations in @xmath144 with no ascents . by theorem  [ thm : description of periodic patterns ] , the map @xmath164 gives a bijection between @xmath470 and @xmath471 , so @xmath472 .",
    "next we show that the map @xmath473 is a bijection , and therefore so is the map @xmath474 , which implies that @xmath475 by lemma  [ lem : periodic orbits ] . as in the proof of theorem",
    "[ thm : enum2shift ] , it is enough to show that @xmath476 is injective .",
    "let @xmath477 , and let @xmath417 be such that @xmath478 . by lemma  [ lem : iff ] , @xmath224 is the @xmath27-monotone word induced by some @xmath479-segmentation of @xmath151 .",
    "since @xmath151 has one ascent , there is only one such segmentation , so @xmath313 is uniquely determined .",
    "[ thm : enumrs ] for @xmath468 with @xmath462 and @xmath420 , @xmath480    this proof is analogous to that of theorem  [ thm : enum shift ] . by corollary  [ cor : rev shift ] , @xmath481 if and only if @xmath482 , and so @xmath164 is a bijection between @xmath483 and cyclic permutations with @xmath405 ascents , from where @xmath484 .    for the second equality of the statement",
    ", we find the cardinality of @xmath93 in two ways . by lemma",
    "[ lem : periodic orbits ] , this number equals @xmath407 . on the other hand , since the map @xmath485 is surjective , but in general not injective , we can obtain @xmath350 by adding the cardinalities of the preimages of the elements of @xmath486 under this map .",
    "for fixed @xmath460 , we count how many words @xmath353 satisfy @xmath487 ( equivalently , how many orbits in @xmath93 are mapped to @xmath26 $ ] by @xmath488 ) . by lemma  [ lem : iff ] , this number is equal to the number of @xmath489-segmentations of @xmath151 .",
    "if @xmath490 , there are @xmath433 such segmentations @xmath140 , since @xmath491 has to be a subset of @xmath435 .    by corollary  [ cor : rev shift ] , for each @xmath436 , the number of equivalence classes @xmath26\\in{\\overline{\\mathcal p}}_n({\\sigma^-}_k)$ ] where @xmath490 is @xmath492",
    "it follows that @xmath493 which is equivalent to the stated formula .",
    "combining theorems [ thm : enum2shift ] , [ thm : enum shift ] , [ thm : enum2rs ] and  [ thm : enumrs ] , we obtain the following .",
    "[ cor : cc ] for @xmath462 and @xmath494 , @xmath495    this equality is equivalent to the symmetry @xmath496 , which is not obvious from the recursive formula in theorem [ thm : enum shift ] .",
    "corollary  [ cor : cc ] also follows from a more general result of gessel and reutenauer ( * ? ? ?",
    "* theorem 4.1 ) , which states that if @xmath462 , then for any @xmath497 $ ] , @xmath498 the proof in @xcite involves quasisymmetric functions . even though we do not know of a direct bijection proving eq .",
    ", our construction can be used to give the following bijection between @xmath499 and @xmath500 .",
    "given @xmath501 such that @xmath502 ( where @xmath503 ) , let @xmath122 be such that @xmath504 .",
    "let @xmath356 be defined by @xmath186 if @xmath505 , for @xmath157 , where we let @xmath506 and @xmath507 ( in our terminology , @xmath91 is the @xmath27-monotone word induced by the @xmath431-segmentation @xmath508 of @xmath151 ) .",
    "let @xmath509 , and define @xmath510)$ ] .    when @xmath354 , the map @xmath511 defined above is a bijection between @xmath499 and @xmath500 .",
    "let @xmath512 , where @xmath513 , and let @xmath514 be the set of words @xmath515 satisfying @xmath220:w_i < t\\}|=d_t$ ] for all @xmath127 .",
    "first note that the map @xmath511 is well defined , in the sense that @xmath516 does not depend on the choice of @xmath122 with @xmath504 .",
    "this is because any other choice of an element in @xmath26 $ ] would produce a word in the same periodic orbit as @xmath313 , and so its image under @xmath517 would still be a permutation in @xmath518 $ ] .",
    "the map @xmath511 can thus be viewed as a composition @xmath519 , where @xmath520 maps @xmath26 $ ] to @xmath518 $ ] , with @xmath521 as defined above . to conclude that @xmath511 is a bijection",
    ", we will show that the map @xmath522 is a bijection between @xmath523 and @xmath524 .",
    "let us first show that the map @xmath525 restricts to a bijection between @xmath514 and @xmath526 .",
    "given @xmath527 , it is clear that @xmath528 by part 3 of lemma  [ lem : ppat ] . to see that the map is surjective , suppose that @xmath529 , and let @xmath313 be as defined above ( that is",
    ", @xmath91 is the @xmath27-monotone word induced by the @xmath431-segmentation @xmath508 of @xmath151 ) . then @xmath530 and @xmath429 by lemma  [ lem : iff ] . besides , since this is the only segmentation of @xmath151 whose induced @xmath27-monotone word is in @xmath514 , lemma  [ lem : iff ] implies that @xmath313 is unique , and so the map is injective .",
    "similarly , the map @xmath531 restricts to a bijection between @xmath514 and @xmath532 .",
    "given @xmath527 , part 3 of lemma  [ lem : ppat ] shows that @xmath533 . to see that",
    "the map is surjective , suppose that @xmath534 , and let @xmath225 , where @xmath91 is the @xmath521-monotone word induced by the @xmath489-segmentation @xmath508 of @xmath535",
    ". then @xmath530 and @xmath536 by lemma  [ lem : iff ] . since this is the only segmentation of @xmath535 whose",
    "induced @xmath521-monotone word is in @xmath514 , the word @xmath313 is unique , and so the map is injective .",
    "finally , the map @xmath522 is a bijection because it is the composition of the above two bijections , as shown in this diagram : @xmath537    let us see an example of the bijection @xmath511 for @xmath538 and @xmath539 .",
    "let @xmath540 , and suppose that @xmath541 .",
    "then we get @xmath542 in this case @xmath543 , but this is not the case in general .",
    "another consequence of theorem  [ thm : enumrs ] is that , when @xmath544 , @xmath545      the results in section  [ sec : reverse ] do not apply to the case @xmath461 .",
    "corollary [ cor : rev shift ] fails in that there are certain permutations @xmath122 with @xmath464 that are not periodic patterns of @xmath455 .",
    "in other words , the map @xmath547 is not surjective . for @xmath548 ,",
    "the following result is the analogue of theorem  [ thm : enum2rs ] .",
    "[ thm : enum2rs2mod4 ] for @xmath468 with @xmath549 , @xmath550    to prove that @xmath551 , we show that the map @xmath473 is a bijection , and therefore so is the map @xmath474 . as in the proof of theorem",
    "[ thm : enum2shift ] , it is enough to show that @xmath476 is injective .",
    "let @xmath477 , and note that @xmath552 by proposition  [ prop : description reverse ] , since there are no cycles with no descents of length @xmath553 .",
    "suppose that @xmath417 is such that @xmath478 .",
    "if @xmath376 is the number of zeros in @xmath224 , we have by part 3 of lemma [ lem : ppat ] that @xmath554 is a @xmath479-segmentation of @xmath151 , and so @xmath555 .",
    "it follows by part 1 of lemma [ lem : ppat ] the word @xmath224 is uniquely determined .",
    "next we prove that @xmath556 let @xmath557 . by proposition  [ prop : description reverse ] , the map @xmath164 restricts to an injection from @xmath558 to @xmath471 .",
    "it suffices to show that the cardinality of @xmath559 , or equivalently , the cardinality of @xmath560 , is @xmath561 .",
    "we do this by constructing a bijection @xmath562 between @xmath563 and @xmath564 . using that @xmath565\\in{\\overline{{\\mathcal s}}}_r:\\operatorname{asc}(\\hat\\rho)=1\\}$ ] by proposition  [ prop : description reverse ] ,",
    "since @xmath259 is an odd number , the map @xmath164 gives a bijection from @xmath564 to @xmath566 , and so the sequence of bijections in the second row of figure  [ fig : varphi2 ] proves that @xmath567 .",
    "\\(m ) [ matrix of math nodes , row sep=2.5em , column sep=2em , minimum width=2em ] & \\{_n : ( ) = 1}p_n(^-_2 ) & p_r(^-_2 ) & + c_n^(_n(^-_2 ) ) & b = \\{[]_n : ( ) = 1 } _",
    "n(^-_2 ) & _ r(^-_2 ) & c_r^ + ; ( m-1 - 2 ) edge [ dashed ] ( m-2 - 2 ) edge node [ above ] @xmath568 ( m-1 - 3 ) ( m-1 - 3 ) edge [ dashed ] ( m-2 - 3 ) edge node [ above right ] @xmath569 ( m-2 - 4 ) ( m-2 - 2 ) edge node [ above ] @xmath562 node [ below ] @xmath570 ( m-2 - 3 ) ( m-2 - 3 ) edge node [ above ] @xmath164 node [ below ] @xmath570 ( m-2 - 4 ) ( m-2 - 2 ) edge node [ above ] @xmath164 node [ below ] @xmath570 ( m-2 - 1 ) ;    let us first define a map @xmath568 from @xmath571 to @xmath572 as follows",
    ". given @xmath27 in the former set , note that the fact that @xmath552 implies that @xmath151 has a unique @xmath479-segmentation .",
    "let @xmath91 be the @xmath27-monotone binary word induced by this segmentation .",
    "this word can not be primitive , because if it were , then lemma  [ lem : sisj ] would imply that @xmath573 , contradicting that @xmath574 .",
    "in fact , the proof of lemma  [ lem : s1sn ] shows that the only way for this word not to be primitive is if @xmath575 for some primitive binary word @xmath46 of length @xmath259 .",
    "let @xmath576 , and define @xmath577 .",
    "it is clear from the above construction that cyclic rotations of @xmath27 produce cyclic rotations of the word @xmath91 , which in turn lead to cyclic rotations of @xmath46 and @xmath108 .",
    "if @xmath577 , then the @xmath6 elements of @xmath26 $ ] are mapped by @xmath568 to the @xmath259 elements of @xmath578 $ ] , so @xmath568 induces a map @xmath562 from @xmath579\\in{\\overline{{\\mathcal s}}}_n:\\operatorname{asc}({\\hat{\\pi}})=1\\}\\setminus{\\overline{\\mathcal p}}_n({\\sigma^-}_2)$ ] to @xmath564 .",
    "we will prove that @xmath568 is a 2-to-1 map , which is equivalent to the fact that @xmath562 is a bijection .",
    "first we prove that @xmath568 is surjective .",
    "let @xmath580 . for convenience ,",
    "define @xmath581 for @xmath582 .",
    "define a permutation @xmath122 by @xmath583 note that this construction produces a permutation because @xmath259 is odd .",
    "we will show that @xmath552 , @xmath574 , and @xmath577 .",
    "we claim that for @xmath582 , we have @xmath584 and @xmath585 . indeed ,",
    "letting @xmath586 be such that @xmath587 , it follows from the definition of @xmath27 that @xmath588 , and similarly @xmath589 .",
    "it is clear from this description of @xmath151 that @xmath590 .",
    "moreover , if @xmath591 , then @xmath592 , which determines the unique @xmath479-segmentation of @xmath151 .    now suppose that there is some @xmath593 such that @xmath594 .",
    "by part 1 of lemma [ lem : ppat ] , @xmath595 is a @xmath27-monotone word having @xmath596 zeros .",
    "since by construction @xmath597 for all @xmath582 , a binary @xmath27-monotone word with an even number of zeros satisfies @xmath598 , and so it is not primitive , which contradicts that @xmath593 .",
    "it follows that @xmath574 .    to show that @xmath577 , let @xmath91 be the @xmath27-monotone word induced by the unique @xmath479-segmentation @xmath599 of @xmath151 . by definition , @xmath600 . on the other hand",
    ", @xmath601 is a @xmath108-monotone word with @xmath376 zeros , and thus induced by the @xmath479-segmentation @xmath602 of @xmath603 .",
    "lemma  [ lem : iff ] implies that @xmath604 .",
    "it remains to show that every @xmath580 has exactly two preimages under  @xmath568 .",
    "let @xmath27 be such that @xmath577 . by construction of @xmath568",
    ", we have @xmath605 as well .",
    "we will show that there are no other elements in @xmath571 whose image by @xmath568 is @xmath108 .",
    "let @xmath606 be such that @xmath607 , and note that @xmath313 is unique because @xmath476 is a bijection .",
    "since @xmath577 , we know that @xmath608 is the @xmath27-monotone word induced by the unique @xmath479-segmentation of @xmath151 . letting @xmath376 be the number of zeros in @xmath609 , this segmentation is @xmath599 . if @xmath610 are such that @xmath611 , then lemma [ lem : sisj ] implies that @xmath227 if and only if @xmath612 .",
    "it follows that @xmath613 and @xmath614 .",
    "in addition , since @xmath615 and @xmath616 for @xmath617 , the four inequalities @xmath612 , @xmath618 , @xmath619 and @xmath620 are equivalent , and so the four inequalities @xmath227 , @xmath621 , @xmath622 , @xmath623 must be either all true or all false .",
    "this implies that @xmath624 for @xmath582 .",
    "we claim that once the relative order of @xmath152 and @xmath625 is chosen , the rest of the entries of @xmath27 are uniquely determined by induction .",
    "indeed , having determined the relative order of @xmath626 and @xmath627 , say @xmath628 , then lemma  [ lem : csigma ] implies that @xmath629 , so these entries are forced to be @xmath630 and @xmath631 .",
    "note that lemma  [ lem : csigma ] can be applied because either @xmath632 or @xmath633 .",
    "here is an example to illustrate the above proof of the fact that @xmath568 is surjective .",
    "suppose that @xmath634 . then equation   yields @xmath635 . in this case ,",
    "@xmath636 and @xmath637 .",
    "it is easy to check that indeed @xmath577 , since the @xmath27-monotone word induced by the @xmath479-segmentation @xmath638 of @xmath151 is @xmath639 , and @xmath640 .    combining theorems  [ thm : enum2shift ] , [ thm : enum2rs ] and [ thm : enum2rs2mod4 ] , we get the following relationship between cycles with one ascent and cycles with one descent .",
    "[ cor : k=2 relation ] for @xmath553 , @xmath641    next we extended the argument used to prove theorem  [ thm : enum2rs2mod4 ] to arbitrary @xmath99 , obtaining a formula for the number of periodic patterns of the reverse @xmath99-shift in terms of the number of cyclic permutations with a fixed number of ascents .",
    "[ thm : enumrs2mod4 ] for @xmath468 with @xmath549 and @xmath420 , @xmath642    by proposition  [ prop : description reverse ] , the map @xmath164 restricts to an injection from @xmath486 to @xmath643 .",
    "noting that @xmath644 , it follows that @xmath645 let @xmath646 .",
    "it suffices to show that @xmath647 , or equivalently , the cardinality of @xmath648 , is @xmath649 .",
    "we do this by constructing a bijection @xmath562 from @xmath563 to @xmath650 \\in { \\overline{{\\mathcal s}}}_r : \\operatorname{asc}(\\hat\\rho ) = k-1\\}$ ] .",
    "since @xmath164 clearly gives a bijection between the latter set and the set of cycles in @xmath651 with @xmath405 ascents , it will follow that @xmath652 .",
    "a diagram of the maps used in this proof appears in figure  [ fig : varphi ] .",
    "it is useful to note that @xmath653\\in{\\overline{{\\mathcal s}}}_n : \\operatorname{asc}({\\hat{\\pi } } ) \\leq k-1\\}$ ] .",
    "\\(m ) [ matrix of math nodes , row sep=1.4em , column sep=1em , minimum width=2em ] \\{_n : ( ) k-1}p_n(^-_k ) & \\{_r : ( ) = k-1 } & + & & + b = \\{[]_n : ( ) k-1}_n(^-_k ) & \\ { [ ] _ r : ( ) = k-1 } & \\{c_r : ( ) = k-1 } + c_n^-^k(_n(^-_k ) ) & & + ; ( m-1 - 1 ) edge [ dashed ] ( m-3 - 1 ) edge node [ above ] @xmath568 ( m-1 - 2 ) ( m-1 - 2 ) edge [ dashed ] ( m-3 - 2 ) edge node [ above right ] @xmath569 ( m-3 - 3 ) ( m-3 - 1 ) edge node [ above ] @xmath562 node [ below ] @xmath570 ( m-3 - 2 ) ( m-3 - 2 ) edge node [ above ] @xmath164 node [ below ] @xmath570 ( m-3 - 3 ) ( m-3 - 1 ) edge node [ left ] @xmath164 node [ right ] @xmath654 ( m-4 - 1 ) ;    we will first define a map @xmath568 from @xmath655 to @xmath656 .",
    "we claim that if @xmath27 is in the former set , then @xmath657 .",
    "indeed , for every @xmath489-segmentation @xmath658 of @xmath151 , the @xmath27-monotone word @xmath659 induced by it is not primitive , because otherwise , by lemma  [ lem : sisj ] , it would satisfy @xmath660 , contradicting that @xmath661 .",
    "in fact , this word has to be of the form @xmath662 , and so all the @xmath663 are even , since each letter appears an even number of times .",
    "but if @xmath664 , then @xmath151 would have @xmath489-segmentations without this property , since any sequence @xmath658 such that @xmath665 would be a @xmath489-segmentation of @xmath151 .    to define the map @xmath568 , let @xmath666 be such that @xmath657 , and let @xmath659 be the @xmath27-monotone word induced by the unique @xmath489-segmentation of @xmath151 . by the proof of lemma  [ lem : s1sn ] , we have @xmath662 for some primitive word @xmath46 of length @xmath259 .",
    "let @xmath667 , and define @xmath668 .",
    "let us first check that such @xmath108 satisfies @xmath669 .",
    "let @xmath670 .",
    "denote the @xmath405 ascents of @xmath151 by @xmath671 , in increasing order , so that @xmath672 is the unique @xmath489-segmentation of @xmath151 .",
    "note that @xmath673 must be even for all @xmath127 , since each letter appears an even number of times in @xmath674 .",
    "letting @xmath675 , we will show that @xmath676 for @xmath677 .",
    "since @xmath405 is an upper bound on @xmath678 by proposition  [ prop : description reverse ] , it will follow that @xmath669 .",
    "let @xmath679 be such that @xmath680 and @xmath681 . by construction of @xmath224",
    ", we have @xmath682 , and so @xmath683 . taking indices @xmath684 , we have @xmath685 .",
    "thus , @xmath686 , because by lemma  [ lem : sisj ] , for any @xmath687 such that @xmath688 and @xmath178 , we must have @xmath689 . by construction",
    ", the word @xmath310 has @xmath675 entries less than or equal to @xmath690 , namely those entries @xmath691 for which @xmath692 . by lemma  [ lem : sisj ] , these entries satisfy @xmath693 , with equality only when @xmath694 .",
    "thus , letting @xmath695 , the word @xmath696 has @xmath697 entries @xmath691 such that @xmath698 , and so @xmath699 .",
    "similarly , @xmath91 has @xmath700 entries @xmath691 satisfying @xmath701 , with equality only when @xmath702 .",
    "thus , letting @xmath703 , the word @xmath46 has @xmath704 entries @xmath691 such that @xmath705 , and so @xmath706 . since @xmath686 , we have @xmath707 , taking indices @xmath708 .",
    "it follows that @xmath709 , so @xmath676 as claimed .",
    "it is clear from the definition of @xmath568 that cyclic rotations of @xmath27 lead to cyclic rotations of @xmath659 , which in turn lead to cyclic rotations of @xmath108 .",
    "if @xmath577 , then the @xmath6 elements of @xmath26 $ ] are mapped by @xmath568 to the @xmath259 elements of @xmath578 $ ] , so @xmath568 induces a map @xmath562 from @xmath710\\in { \\overline{{\\mathcal s}}}_n : \\operatorname{asc}({\\hat{\\pi } } ) = k-1\\}\\setminus { \\overline{\\mathcal p}}_n({\\sigma^-}_k)$ ] to @xmath650 \\in { \\mathcal s}_r : \\operatorname{asc}(\\hat\\rho ) = k-1\\}$ ] .",
    "we will prove that @xmath568 is a 2-to-1 map , which is equivalent to the fact that @xmath562 is a bijection .",
    "first , we prove that @xmath568 is surjective .",
    "let @xmath711 be such that @xmath712 . for convenience ,",
    "define @xmath713 for @xmath714 .",
    "define a permutation @xmath715 by @xmath716 we will show that @xmath482 , @xmath661 , and @xmath577 .    as in the proof of theorem  [ thm : enum2rs2mod4 ] , we have @xmath584 and @xmath585 for @xmath582 .",
    "it follows that @xmath717 .",
    "moreover , if @xmath718 , then @xmath719 , which determines the unique @xmath489-segmentation of @xmath151 .",
    "suppose that there is some word @xmath720 such that @xmath721 . by part 1 of lemma [ lem : ppat ]",
    ", @xmath595 is a @xmath27-monotone word having @xmath722 copies of the letter @xmath127 for @xmath60 ( with the convention @xmath185 and @xmath723 ) .",
    "since by construction @xmath597 for all @xmath582 , a @xmath27-monotone word with an even number of copies of each letter satisfies @xmath598 , and so it is not primitive , which contradicts that @xmath724 .",
    "it follows that @xmath661 .    to show that @xmath577 , let @xmath91 be the @xmath27-monotone word induced by the unique @xmath489-segmentation @xmath725 of @xmath151 . by definition , @xmath726 . on the other hand ,",
    "@xmath601 is a @xmath108-monotone word having @xmath727 copies of @xmath127 for each @xmath728 , and thus induced by the @xmath479-segmentation @xmath729 of @xmath603 .",
    "lemma  [ lem : iff ] implies that @xmath730 .",
    "it remains to show that every @xmath731 with @xmath669 has exactly two preimages under @xmath568 .",
    "suppose that @xmath27 is such that @xmath577 . by construction of @xmath568",
    ", we have @xmath605 as well .",
    "we will show that there are no other elements in @xmath732 whose image by @xmath568 is @xmath108 .",
    "since @xmath259 is odd and @xmath669 , proposition [ prop : description reverse ] implies that @xmath733 , so there is some @xmath734 such that @xmath735 .",
    "in fact , such an @xmath313 is unique by lemma  [ lem : iff ] , because it is the @xmath108-monotone word induced by the unique @xmath489-segmentation of @xmath603 , which we denote by @xmath736 . since @xmath577 , we know that @xmath608 is the @xmath27-monotone word induced by the unique @xmath489-segmentation of @xmath151 .",
    "it follows that this segmentation must be @xmath737 .",
    "exactly as in the proof of theorem  [ thm : enum2rs2mod4 ] , we can show that @xmath624 for @xmath582 , and that once the relative order of @xmath152 and @xmath625 is chosen , the rest of the entries of @xmath27 are uniquely determined by induction .",
    "lemma  [ lem : csigma ] can be applied in this case because for every @xmath582 , we have @xmath738 for some @xmath739 , where @xmath185 and @xmath723 .    theorem  [ thm : enumrs2mod4 ] alone does not give a practical way to compute @xmath740 when @xmath741 , unlike theorem  [ thm : enumrs ] for the case @xmath354 .",
    "note that since @xmath742 , the term @xmath743 on the right hand side of equation   can be easily computed by the recurrence in theorem  [ thm : enumrs ] .",
    "our next goal is to give a recurrence to compute @xmath492 when @xmath744 .    for @xmath468 with @xmath549 and @xmath420 , @xmath745.\\ ] ]    since @xmath746 by lemma  [ lem : periodic orbits ] , it is enough to show that the right hand side also counts @xmath6-periodic orbits of @xmath455 .",
    "consider the map @xmath747\\in{\\overline{{\\mathcal s}}}_n:\\operatorname{asc}({\\hat{\\pi } } ) \\leq k-1\\}$ ] .",
    "we can obtain @xmath350 by adding the cardinalities of the preimages of the elements of @xmath486 under this map , or equivalently , the cardinalities of the preimages of the elements of @xmath748 under the map @xmath517 , as in the proof of theorems [ thm : enum shift ] and [ thm : enumrs ] .",
    "however , the difference here is that not every permutation @xmath715 with @xmath749 is in the image of this map , because when @xmath741 , corollary  [ cor : rev shift ] does not apply .",
    "let @xmath715 be such that @xmath490 , where @xmath750 .",
    "if @xmath353 is such that @xmath487 , then , by lemma  [ lem : ppat ] , @xmath91 is the @xmath27-monotone word induced by some @xmath489-segmentation @xmath140 of @xmath151 .",
    "there are @xmath433 such segmentations , since @xmath491 has to be a subset of @xmath435 .",
    "however , unlike in the proof of theorem [ thm : enumrs ] , it is not the case that the @xmath27-monotone word induced by every such segmentation is necessarily primitive .",
    "when this word is not primitive , the proof of lemma [ lem : s1sn ] implies that it must be a _",
    "i.e. , a word of the form @xmath674 for some primitive word @xmath46 of length @xmath751 .",
    "we will count how many times this induced word is a square .",
    "first , note that if the @xmath27-monotone word induced by some @xmath489-segmentation of @xmath151 is a square , then the @xmath27-monotone word induced by the unique @xmath752-segmentation of @xmath151 ( which consists of the ascents of @xmath491 , and thus is a subset of any @xmath489-segmentation ) must be a square as well .",
    "it follows that @xmath753 in this case . for each such @xmath27 , any @xmath489-segmentation @xmath754 of @xmath151",
    "whose induced @xmath27-monotone word is a square must satisfy @xmath755 ( by definition of @xmath489-segmentation ) and have all @xmath673 even .",
    "conversely , every segmentation satisfying these conditions induces a square @xmath27-monotone word , because , as shown in the proof of theorem [ thm : enumrs2mod4 ] , for every @xmath586 the entries @xmath756 and @xmath757 have consecutive values , with the largest one being even .",
    "the number of @xmath489-segmentations satisfying the two conditions is @xmath758 .    for each @xmath436",
    ", there are @xmath437 equivalence classes @xmath26\\in{\\overline{{\\mathcal s}}}_n$ ] with @xmath490 .",
    "we showed in the proof of theorem [ thm : enumrs2mod4 ] that @xmath759 of them satisfy that @xmath760 ; in other words , that @xmath761\\in{\\overline{{\\mathcal s}}}_n : \\operatorname{asc}({\\hat{\\pi}})=i-1\\}\\setminus { \\overline{\\mathcal p}}_n({\\sigma^-}_i)|=c'(r , i)$ ] .",
    "it follows that the number of preimages under @xmath488 of the set @xmath762\\in{\\overline{{\\mathcal s}}}_n : \\operatorname{asc}({\\hat{\\pi}})=i-1\\}$ ] is @xmath763    [ cor : recc ] for @xmath468 with @xmath549 and @xmath420 , @xmath764 + c'(\\frac{n}{2 } , k).\\ ] ]    the equality @xmath765 , which holds for @xmath354 ( see corollary  [ cor : cc ] ) , is no longer valid when @xmath741 . in this case , we know that @xmath766 by corollary [ cor : k=2 relation ] . for general @xmath99",
    ", an intricate formula expressing @xmath767 in terms of @xmath426 and @xmath768 for @xmath769 can be derived from corollary  [ cor : recc ] .",
    "using theorem  [ thm : description of periodic patterns ] , the formulas that we have found for the number of periodic patterns of the tent map , the @xmath99-shift and the reverse @xmath99-shift have implications to the enumeration of cyclic permutations that avoid certain patterns .",
    "we denote by @xmath770 the set of cycles of length @xmath6 avoiding the patterns @xmath111 .",
    "the enumeration of pattern - avoiding cycles is a wide - open problem , part of its difficulty stemming from the fact that it combines two different ways to look at permutations : in terms of their cycle structure and in terms of their one - line notation .",
    "the question of finding a formula for @xmath771 where @xmath53 is a pattern of length  3 was proposed by richard stanley  @xcite and is still open .",
    "however , we are able to answer some related questions in theorem  [ thm : patternsincycles ] . the first formula below , which counts unimodal cycles , was first obtained by weiss and rogers  @xcite using methods from  @xcite .",
    "more generally , the cycle structure of unimodal permutations has been studied by gannon  @xcite and thibon  @xcite .",
    "the other formulas in theorem  [ thm : patternsincycles ] are new to the extent of our knowledge .",
    "the formula for @xmath773 is a consequence of theorem  [ thm : enumtent ] and corollary  [ cor : pptent ] , together with the fact that a permutation is unimodal if and only if it avoids the patterns @xmath774 and @xmath775 .",
    "the equality with @xmath776 follows from corollary  [ cor:-+ ] .",
    "the second formula follows from theorem  [ thm : enum2shift ] , using that the set of permutations with at most one descent is @xmath777=\\operatorname{av}(321,2143,3142)$ ] ( see  @xcite ) .",
    "finally , the third formula is a consequence of corollary [ cor : k=2 relation ] and theorem  [ thm : enum2shift ] , noting that the class of permutations with at most one ascent is @xmath778=\\operatorname{av}(123,2413,3412)$ ] ."
  ],
  "abstract_text": [
    "<S> the periodic ( ordinal ) patterns of a map are the permutations realized by the relative order of the points in its periodic orbits . we give a combinatorial characterization of the periodic patterns of an arbitrary signed shift , in terms of the structure of the descent set of a certain cyclic permutation associated to the pattern . </S>",
    "<S> signed shifts are an important family of one - dimensional dynamical systems that includes shift maps and the tent map as particular cases . </S>",
    "<S> defined as a function on the set of infinite words on a finite alphabet , a signed shift deletes the first letter and , depending on its value , possibly applies the complementation operation on the remaining word . for shift maps , </S>",
    "<S> reverse shift maps , and the tent map , we give exact formulas for their number of periodic patterns . as a byproduct of our work , we recover results of gessel  reutenauer and weiss  rogers and obtain new enumeration formulas for pattern - avoiding cycles .    </S>",
    "<S> * keywords : * periodic pattern ; signed shift ; cyclic permutation ; descent ; pattern avoidance ; reverse shift ; periodic orbit . </S>"
  ]
}