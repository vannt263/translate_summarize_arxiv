{
  "article_text": [
    "there has been great progress in classifying the complexity of counting problems recently .",
    "one important success is for counting constraint satisfaction problems ( # csp ) , where a sweeping complexity dichotomy is proved  @xcite .",
    "while the landscape of exact counting becomes clearer , the complexity of approximate counting remains mysterious .",
    "two typical classes of problems have been identified : 1 ) those that have a fully polynomial - time randomized approximation scheme ( fpras ) , and 2 ) those that are # sat - hard with respect to approximation preserving reductions ( ap - reductions ) @xcite . if @xmath0 then # sat  admits no fpras  @xcite , and therefore neither does any problem in the second class .",
    "these two classes are analogous to p - time tractable vs.  np - hard decision or optimization problems .",
    "interestingly , in approximate counting , there has emerged a third distinct class of natural problems , which seems to be of intermediate complexity .",
    "it is conjectured  @xcite that the problems in this class do not have an fpras but that they are not as hard as # sat  to approximate .",
    "a canonical problem in this class has been identified , which is to count the number of independent sets in a bipartite graph ( # bis ) . despite many attempts , nobody has found an fpras for # bis  or an ap - reduction from # sat  to # bis .",
    "the conjecture is that neither exists .",
    "mossel et al .",
    "@xcite showed that the gibbs sampler for sampling independent sets in bipartite graphs mixes slowly even on bipartite graphs of degree at most  @xmath1 .",
    "another interesting attempted markov chain for # bisby ge and tefankovi @xcite was also shown later to be slowly mixing by goldberg and jerrum @xcite .    # bis  plays an important role in classifying counting problems with respect to approximation .",
    "a trichotomy theorem is shown for the complexity of approximately solving unweighted boolean counting csps , where in addition to problems that are solvable by fprases and those that are ap - reducible from # sat , there is the intermediate class of problems which are equivalent to # bis  @xcite .",
    "many counting problems are shown to be # bis - hard and hence are conjectured to have no fpras @xcite , including estimating the partition function of the the ferromagnetic potts model  @xcite . moreover , under ap - reductions",
    "# bis  is complete in a logically defined class of problems , called # rh@xmath2 , to which an increasing variety of problems have been shown to belong . other typical complete problems in #",
    "rh@xmath2 include counting the number of downsets in a partially ordered set @xcite and computing the partition function of the ferromagnetic ising model with local external fields @xcite .",
    "the problem of counting independent sets ( # is ) can be viewed as a special case in the general framework of spin systems , which originated from statistical physics to model interactions between neighbors on graphs . in this paper , we focus on two - state spin systems .",
    "in general such a system is parameterized by edge weights @xmath3 and a vertex weight @xmath4 .",
    "an instance is a graph @xmath5 .",
    "a configuration @xmath6 is a mapping @xmath7 from vertices to ( two ) spins .",
    "the weight @xmath8 of a configuration @xmath6 is given by @xmath9 where @xmath10 is the number of @xmath11 edges given by the configuration @xmath6 , @xmath12 is the number of @xmath13 edges , and @xmath14 is the number of vertices assigned @xmath15 .",
    "we are interested in computing the partition function , which is defined by @xmath16 the partition function is the normalizing factor of the gibbs distribution , which is the distribution in which a configuration  @xmath6 is drawn with probability @xmath17 . the spin system is called _ ferromagnetic _ if @xmath18 and _ antiferromagnetic _ if @xmath19 . in particular ,",
    "when @xmath20 , such a system is the famous _ ising model _ , and when @xmath21 and @xmath22 , it is the _ hard - core gas model _ , the partition function of which counts independent sets when @xmath23 .",
    "the external field @xmath24 is typically referred to as the activity or fugacity of the hard - core model .    approximating the partition function of the hard - core model",
    "is especially well studied .",
    "we now know that the complexity transition from easy to hard corresponds exactly to the uniqueness of the gibbs measure in infinite @xmath25-ary trees @xmath26 ( for details of these notions , see @xcite ) .",
    "notice that @xmath25-ary trees are graphs of maximum degree @xmath27 , hence our use of the notation @xmath26 . on the algorithmic side",
    ", weitz presented a fully polynomial - time approximation scheme ( fptas ) for the hard - core gas model on graphs of maximum degree @xmath27 when uniqueness holds @xcite . on the other hand ,",
    "sly showed that the approximation problem is # sat - hard for a small interval beyond the uniqueness threshold @xcite .",
    "building on their work , it is now established that for all antiferromagnetic 2-spin systems there is an fptas for graphs of maximum degree @xmath27 up to the uniqueness threshold @xcite ( see also @xcite ) , whereas non - uniqueness implies # sat - hardness under ap - reductions on @xmath27-regular graphs @xcite ( see also @xcite ) .",
    "the only place that remains unclear is exactly at the uniqueness threshold .",
    "a key feature of spin systems in the antiferromagnetic non - uniqueness region is the ability to support a gadget with many vertices whose spins are highly correlated with the phase of the gadget ( which is either @xmath28 or @xmath29 ) , but are nearly independent among themselves conditioned on that phase .",
    "such a gadget was used by sly  @xcite to show inapproximability of the partition function of the hard - core model when @xmath24 is just above the uniqueness threshold .",
    "a different gadget with similar properties was used by goldberg et al .",
    "@xcite to show inapproximability on a planar graph when @xmath24 is much larger .",
    "we abstract this notion of nearly - independent phase - correlated spins .",
    "it is this feature that enables us to reduce from # sat  to approximating the partition function of antiferromagnetic two - spin systems in the non - uniqueness region .",
    "restricted to bipartite graphs , it appears that supporting nearly - independent phase - correlated spins alone is not enough to imply # bis - hardness .",
    "it was shown that sly s gadget is applicable to the antiferromagnetic ising model without an external field by galanis et al .",
    "however , such a system has an fpras on bipartite graphs .",
    "the reason is that this system is perfectly symmetric on bipartite graphs and therefore can be translated into a ferromagnetic ising system , whose partition function can be approximated using the fpras of jerrum and sinclair @xcite ( see corollary  [ cor : ising : w / o ] in section [ sec : sym ] for details ) . to get around this perfectly symmetric case",
    ", we introduce the second key concept called unary symmetry breaking .",
    "unary symmetry breaking is about the availability of non - trivial",
    " unary weights \" which can be built in the model .",
    "the availability of unary weights is relevant to counting complexity , for example in the context of counting csps .",
    "unary symmetry breaking simply means that some ( any ) non - trivial unary weight can be built .",
    "formal definitions of the two notions  nearly - independent phase - correlated spins and unary symmetry breaking",
    " can be found in section  [ sec : def ] .",
    "our main technical theorem is the following .",
    "suppose a tuple of parameters @xmath30 with @xmath31 and @xmath32 supports nearly - independent phase - correlated spins and unary symmetry breaking",
    ". then the partition function ( [ eq : pfdef ] ) of two - spin systems @xmath33 is # bis - hard to approximate on bipartite graphs with maximum degree @xmath27 .",
    "[ thm : main ]    previous hardness proofs for the problem  # is  and for the problem of estimating the partition function of antiferromagnetic 2-spin systems typically reduce from max - cut or from the problem of counting certain types of cuts @xcite .",
    "however such a technique sheds little light in the bipartite setting as cut problems are trivial on bipartite graphs .",
    "reductions between # bis - equivalent problems typically involve transformations that `` blow up '' vertices and edges into sets of vertices that are completely connected , so they do not apply to bounded - degree graphs either .",
    "a key property of sly s gadget is that either phase occurs with probability bounded below by an inverse polynomial",
    ". this bound is sufficient in sly s setting to reduce from max - cut , but it is not enough to construct ap - reductions for our use .",
    "we resolve this issue by introducing a balancing construction .",
    "the construction takes two copies of a gadget with nearly - independent phase - correlated spins , and produces a new gadget with similarly - correlated spins , but in the new gadget the two phases occur with probability close to @xmath34 .",
    "the proof of theorem  [ thm : main ] utilizes an intermediate problem , that is , computing the partition function of antiferromagnetic ising systems with non - uniform external fields on bipartite graphs .",
    "a non - uniform external field means that the instance specifies a subset of vertices on which the external field acts .",
    "a 2-spin system with a non - uniform external field is very similar to a boolean # csp with one binary symmetric non - negative valued function ( corresponding to edge weights ) and one unary non - negative valued function ( corresponding to vertex weights ) ( see , for example @xcite ) .",
    "our reduction implements an external field , and this is where unary symmetry breaking comes into play .",
    "as discussed earlier , the partition function of the ising model without an external field has an fpras , so the unary symmetry breaking gadget seems necessary . in fact , we show ( lemma  [ lem : sym : break ] ) that unary symmetry breaking holds for all 2-spin systems except for the ising model without an external field or degenerate systems ( i.e. , systems satisfying @xmath35 ) .",
    "we also prove ( lemma [ lem : indpt - phases ] ) that all antiferromagnetic 2-spin systems support nearly - independent phase - correlated spins in the non - uniqueness region .",
    "taking lemmas  [ lem : indpt - phases ] and  [ lem : sym : break ] together with theorem [ thm : main ] yields our main result :    [ thm : bis - nonuniq ] for all tuples of parameters @xmath30 with @xmath36 and @xmath19 , except for the case @xmath37 , if the infinite @xmath27-regular tree @xmath26 is in the non - uniqueness region then approximating the partition function ( [ eq : pfdef ] ) on bipartite graphs with maximum degree @xmath27 is # bis - equivalent under ap - reductions .",
    "there is an fpras for the exceptional case ( @xmath38 ) ( corollary  [ cor : ising : w / o ] ) .",
    "let us now survey the approximability picture that this theorem helps establish . for general antiferromagnetic 2-spin models with soft constraints (",
    "i.e. , @xmath39 ) , non - uniqueness holds if and only if @xmath40 and @xmath41 for some critical values @xmath42 and @xmath43 depending on @xmath44 , @xmath45 , and @xmath27 ( see ( * ? ? ? * lemma 5 ) ) .",
    "hence , for all @xmath46 where @xmath19 , and all @xmath36 the following holds :    1 .",
    "if @xmath47 , for all @xmath24 , there is an fptas to approximate the partition function for @xmath27-regular graphs @xcite ( this extends to graphs of maximum degree @xmath27 in an appropriate sense , see @xcite for details ) .",
    "2 .   if @xmath40 , then there exists @xmath48 so that : 1 .   for all @xmath49 $ ] , there is an fptas to approximate the partition function for @xmath27-regular graphs @xcite ( this again extends in an appropriate sense to graphs of maximum degree @xmath27 @xcite ) .",
    "2 .   for all @xmath50 ,",
    "it is # sat - hard to approximate the partition function on @xmath27-regular graphs @xcite .",
    "3 .   for all @xmath50 ,",
    "it is # bis - hard to approximate the partition function on bipartite graphs of maximum degree @xmath27 ( theorem [ thm : bis - nonuniq ] in this paper ) .    for the particular case of the hard - core model the critical value ( i.e. , critical activity @xmath51 )",
    "is more easily stated . for the hard - core model ( i.e. , @xmath52 and @xmath53 ) kelly @xcite showed that non - uniqueness holds on @xmath26 if and only if @xmath54 . as a consequence we get the following corollary for the hard - core model .    for all @xmath36 , all @xmath55 , it is # bis - hard to approximate the partition function of the hard - core model on bipartite graphs of maximum degree @xmath27 .",
    "[ cor : hardcore ]    we also get a corollary concerning the more general partition function as long as @xmath44 and @xmath45 are less than  @xmath15 and the degree bound  @xmath27 is sufficiently large . for and",
    "@xmath44 and @xmath45 satisfying @xmath56 and any @xmath4 , there exists a @xmath27 such that @xmath33 is in the non - uniqueness region of @xmath26 ( * ? ? ?",
    "* lemma 21.2 ) .",
    "this implies the following corollary .    for every @xmath56 and @xmath4 ,",
    "there exists a @xmath27 such that the 2-spin system with parameters @xmath57 and with uniform or non - uniform external field @xmath24 on bipartite graphs with degree bound @xmath27 is # bis - equivalent under ap - reductions , except when @xmath20 and @xmath23 , in which case it has an fpras .",
    "[ cor : general - graphs ]    more generally , for antiferromagnetic 2-spin systems we get the following picture for the complexity of approximating the partition function on general graphs . as usual",
    "there is a difficulty classifying the complexity of approximating the partition function at the boundary between uniqueness and non - uniqueness . to address this issue , for parameters @xmath30 ,",
    "@xcite define a notion of _ up - to-@xmath27 unique _ which is equivalent to the parameters lying in the interior of the uniqueness region for the infinite @xmath58-ary tree @xmath59 for all @xmath60 ( see definition 7 in  @xcite ) .",
    "moreover , the parameters @xmath33 satisfy _ @xmath61-strict - uniqueness _ if it is up - to-@xmath61 unique .- strict - uniqueness is called universally unique in ( * ? ? ?",
    "* definition 7 ) ) . ] on the other side , we say the parameters @xmath33 satisfy _ @xmath61-non - uniqueness _ if for some @xmath36 the tree @xmath26 has non - uniqueness .",
    "the only gap between the notions of @xmath61-strict - uniqueness and @xmath61-non - uniqueness is the case when the parameters @xmath33 are at the uniqueness / non - uniqueness threshold of @xmath26 for some @xmath27 .",
    "the following result detailing the complexity for general graphs is now established .",
    "[ cor : dichotomy ] for all tuples of parameters @xmath33 with @xmath19 , the following holds :    1 .",
    "if the parameters satisfy @xmath61-strict - uniqueness then there is a fptas for the partition function for all graphs ( * ? ? ?",
    "* theorem 2 ) .",
    "if the parameters satisfy @xmath61-non - uniqueness then : 1 .",
    "it is # sat - hard to approximate the partition function on graphs @xcite .",
    "2 .   except when @xmath20 and @xmath23",
    ", it is # bis - hard to approximate the partition function on bipartite graphs ( theorem [ thm : bis - nonuniq ] in this paper ) .    a recent paper of liu et al .",
    "@xcite shows that our theorem  [ thm : main ] can also be used to analyse the complexity of _ ferromagnetic _ partition functions ( where @xmath62 ) . in particular , it uses theorem [ thm : main ] to show # bis - hardness for approximating the partition function for ferromagnetic 2-spin systems when @xmath63 for sufficiently large external field @xmath24 . an interesting problem that remains open is to prove # bis - hardness for the entire non - uniqueness region for ferromagnetic 2-spin systems with @xmath63 .",
    "the remainder of the paper is organized as follows .",
    "we begin by formally defining ap - reductions and the problems that we use in our reductions in section [ sec : prelim ] . in section [ sec : def ] we formally define nearly - independent phase - correlated spins and unary symmetry breaking , and present the main lemmas concerning these concepts .",
    "we prove theorem [ thm : main ] in section [ sec : proof - main ] .",
    "finally , in sections [ sec : proof - balanced - gadget ] , [ sec : sym ] , and [ sec : indpt - phases ] we prove the various lemmas about the two key concepts that are presented in section [ sec : def ] .",
    "we are interested in the complexity of approximate counting .",
    "let @xmath64 be a finite alphabet .",
    "we want to approximate the value of a function @xmath65 . a _",
    "randomized approximation scheme _ is an algorithm that takes an instance @xmath66 and a rational error tolerance @xmath67 as inputs , and outputs a rational number @xmath68 such that , for every @xmath69 and  @xmath70 , @xmath71\\geq\\frac{3}{4}.\\ ] ] a _ fully polynomial randomized approximation scheme _ ( fpras ) is a randomized approximation scheme which runs in time bounded by a polynomial in @xmath72 and @xmath73 .",
    "note that the quantity @xmath74 can be changed to any value in the interval @xmath75 or even @xmath76 for a problem of size @xmath77 without changing the set of problems that have fully polynomial randomized approximation schemes since the higher accuracy can be achieved with only polynomial delay by taking a majority vote of multiple samples .",
    "dyer _ et al . _",
    "@xcite introduced the notion of approximation - preserving reductions .",
    "suppose @xmath78 and @xmath79 are two functions from @xmath80 to @xmath81 . an _ approximation - preserving reduction _",
    "( ap - reduction ) from @xmath78 to @xmath79 is a randomized algorithm @xmath82 to approximate @xmath78 using an oracle for @xmath79 .",
    "the algorithm @xmath82 takes an input @xmath83 , and satisfies the following three conditions : ( i ) every oracle call made by @xmath82 is of the form @xmath84 , where @xmath85 is an instance of @xmath79 , and @xmath86 is an error bound satisfying @xmath87 ; ( ii ) the algorithm @xmath82 meets the specification for being a randomized approximation scheme for @xmath78 whenever the oracle meets the specification for being a randomized approximation scheme for @xmath79 ; ( iii ) the run - time of @xmath82 is polynomial in @xmath72 and @xmath73 .    if an ap - reduction from @xmath78 to @xmath79 exists , we write @xmath78@xmath88@xmath79 , and say that @xmath78 is _ ap - reducible _ to @xmath79 .",
    "if @xmath78@xmath88@xmath79 and @xmath79@xmath88@xmath78 , then we say that @xmath78 and @xmath79 are _ ap - interreducible _ or _ ap - equivalent _ , and write @xmath78@xmath89@xmath79 .",
    "the problem # bis  is defined as follows .",
    "* # bis . + * instance . * a bipartite graph @xmath90 . + * output . *",
    "the number of independent sets in @xmath90 .",
    "+ in this paper , we are interested in 2-spin systems over bounded degree bipartite graphs parametrized by a tuple @xmath33 .",
    "we say a real number @xmath68 is _ efficiently approximable _ if there is an fpras for the problem of computing @xmath68 . throughout the paper we only deal with non - negative real parameters that are efficiently approximable . for efficiently approximable non - negative real numbers @xmath91 and a positive integer @xmath27",
    ", we define the problem of computing the partition function of the 2-spin system @xmath92 with external field @xmath24 on bipartite graphs of bounded degree @xmath27 , as follows .",
    "* bi-(m-)2-spin@xmath30 .",
    "+ * instance . * a bipartite ( multi)graph @xmath93 with degree bound @xmath27 . +",
    "* output . *",
    "the quantity @xmath94    notice that we also introduced a multigraph version of the same problem .",
    "it will be useful later .",
    "we drop the parameter @xmath27 when there is no degree bound , that is , bi-2-spin@xmath33 is the same as bi-2-spin@xmath95 .",
    "we also found the notion of non - uniform external field useful in the reductions .",
    "the following problems are introduced as intermediate problems .",
    "we also introduce a multigraph version , but as intermediate problems we do not need the bounded degree variant . + * name . *",
    "+ * instance . * a bipartite ( multi)graph @xmath93 and a subset @xmath96 . +",
    "* output . * the quantity @xmath97",
    "in this section we define two key concepts : nearly - independent phase - correlated spins and unary symmetry breaking .    we first describe the basic setup of a certain gadget . for positive integers @xmath27 , @xmath98 and @xmath77 where @xmath77 is even and",
    "is at least @xmath99 , let @xmath100 and @xmath101 be disjoint vertex sets of size  @xmath98 and let @xmath102 be a size-@xmath103 superset of  @xmath100 and @xmath104 be a size-@xmath103 superset of  @xmath101 which is disjoint from  @xmath102 .",
    "let @xmath105 and @xmath106 .",
    "let @xmath107 be the set of bipartite graphs with vertex partition @xmath108 in which every vertex has degree at most  @xmath27 and every vertex in @xmath109 has degree at most  @xmath110 .",
    "we refer to the vertices in @xmath109 as `` terminals '' .",
    "vertices in @xmath101 are `` positive terminals '' and vertices in  @xmath100 are `` negative terminals '' .",
    "when the gadget @xmath111 is drawn from @xmath107 , we use the notation @xmath112 to refer to the set of terminals .",
    "each configuration @xmath113 is assigned a unique phase @xmath114 .",
    "roughly in our applications of the definitions below the phase of a configuration @xmath6 is @xmath115 if @xmath116 contains more vertices with spin @xmath15 than does @xmath117 .",
    "we define measures @xmath118 and @xmath119 .",
    "fix some @xmath120 . for any positive integer  @xmath98 ,    *",
    "@xmath118 is the distribution on configurations @xmath121 such that , for every @xmath122 , @xmath123 independently with probability  @xmath124 and , for every @xmath125 , @xmath123 independently with probability  @xmath126 , and * @xmath119 is the distribution on configurations @xmath121 such that , for every @xmath127 , @xmath123 independently with probability  @xmath124 and , for every @xmath122 , @xmath123 independently with probability  @xmath126 .    to give a rough sense for the values @xmath128 and @xmath129 they will correspond to the marginal probabilities of the root of an infinite tree obtained by taking limits of finite trees with appropriate boundary conditions , see section [ sec : indpt - phases ] for more details .    to prove the # bis - hardness",
    "we need a gadget where the spins of the terminals are drawn from distributions close to @xmath118 or @xmath119 conditioned on the phase @xmath28 or @xmath29 .",
    "the following definition formalises this notion .",
    "the definition will be crucial for obtaining our @xmath130-hardness results for antiferromagnetic models in the non - uniqueness region . while the definition is stated for general 2-spin systems ,",
    "it is most useful for antiferromagnetic systems ; a ferromagnetic 2-spin system is not going to satisfy the conditions of the definition since one expects that for such systems @xmath131 or , equivalently , there is no notion of a binary  phase \" .",
    "[ def : sly ] a tuple of parameters @xmath30 * supports nearly - independent phase - correlated spins * if there are efficiently - approximable values @xmath132 such that the following is true",
    ". there are functions @xmath133 , @xmath134 , and @xmath135 ,",
    "each of which is bounded from above by a polynomial in  @xmath98 and  @xmath136 , and for every  @xmath98 and  @xmath70 there is a distribution on graphs in @xmath137 such that a gadget @xmath5 with terminals @xmath109 can be drawn from the distribution within @xmath134 time , and the probability that the following inequalities hold is at least  @xmath138 :    1 .",
    "the phases are roughly balanced , i.e. , @xmath139 2 .   for a configuration @xmath140 and any @xmath121 , @xmath141    in fact , given a gadget with the above property",
    ", one can construct a gadget where the phases are ( nearly ) uniformly distributed as detailed in the following definition .",
    "[ def : balsly ] we say that the tuple of parameters @xmath30 supports * balanced * nearly - independent phase - correlated spins if definition [ def : sly ] holds with replaced by : @xmath142 where @xmath143 is quantified as in definition [ def : sly ] .",
    "the following lemma shows that for essentially all 2-spin systems , definition [ def : sly ] implies definition [ def : balsly ] .",
    "hence , in the proof of theorem [ thm : main ] we assume the existence of a gadget with balanced phases .",
    "[ lem : gettingbal ] if the parameter tuple @xmath30 with @xmath144 supports nearly - independent phase - correlated spins , then it supports balanced nearly - independent phase - correlated spins .",
    "the main technical result for proving # bis - hardness for 2-spin antiferromagnetic systems in the tree non - uniqueness region is the following lemma , which is proved in section [ sec : indpt - phases ] .",
    "[ lem : indpt - phases ] for all @xmath36 , all @xmath145 where @xmath146 , if the infinite @xmath27-regular tree @xmath26 is in the non - uniqueness region then the tuple of parameters @xmath30 supports balanced nearly - independent phase - correlated spins .",
    "the second property of the gadget is the notion of unary symmetry breaking which is relatively simple .",
    "[ def : symmetry ] we say that a tuple of parameters @xmath30 * supports unary symmetry breaking * if there is a bipartite graph  @xmath147 whose vertices have degree at most  @xmath27 which has a distinguished degree-@xmath15 vertex  @xmath148 such that @xmath149",
    ".    we will prove in section  [ sec : sym ] that unary symmetry breaking holds for all 2-spin models except for two cases .",
    "assume @xmath150 .",
    "the parameters @xmath30 support unary symmetry breaking unless ( i )  @xmath35 or ( ii )   @xmath20 and @xmath23 .",
    "[ lem : sym : break ]",
    "in this section we prove theorem [ thm : main ] .",
    "we first show how the two notions of `` nearly - independent phase - correlated spins '' and `` unary symmetry breaking '' lead to # bis - hardness .",
    "the goal of this section is to show that it is # bis - hard to approximate the partition function of antiferromagnetic ising models with non - uniform non - trivial external fields on bipartite graphs .    for any @xmath151 , @xmath4 and @xmath152 , [ lem :",
    "bis : ising ]    by flipping @xmath153 to @xmath15 and @xmath15 to @xmath153 for each configuration @xmath6 , we see that bi - m - nonuniform-2-spin@xmath154  is in fact the same as bi - m - nonuniform-2-spin@xmath155 .",
    "hence we may assume @xmath156 .",
    "let @xmath157 and @xmath158 note that @xmath159 and @xmath160 , so @xmath161 .",
    "let @xmath93 be an input to  @xmath130 with @xmath162 and @xmath163 .",
    "let @xmath164 be the number of independent sets of  @xmath90 .",
    "let @xmath70 be the desired accuracy of the reduction .",
    "we will construct an instance  @xmath165 with a specified vertex subset @xmath166 for bi - m - nonuniform-2-spin@xmath154  such that @xmath167 where @xmath168 is a quantity that is easy to approximate .",
    "therefore it suffices to call oracle bi - m - nonuniform-2-spin@xmath154  on @xmath169 with the specified subset @xmath170 with accuracy @xmath171 and approximate @xmath168 within @xmath171 .",
    "the construction of @xmath169 involves two positive integers @xmath172 and @xmath173 .",
    "let @xmath172 be the least positive integer such that @xmath174 note that @xmath172 depends on @xmath77 and @xmath70 and there is a polynomial @xmath175 in  @xmath77 and @xmath136 such that @xmath176 .",
    "let @xmath173 be the least positive integer depending on  @xmath77 , @xmath70 and  @xmath172 such that @xmath177 once again , @xmath173 is bounded from above by a polynomial in  @xmath77 and  @xmath136 .    given the integers  @xmath172 and  @xmath173 , the graph  @xmath169 is constructed as follows ( see figure  [ fig : toy ] for an illustrative diagram ) .",
    "let @xmath178 for each @xmath179 where @xmath180 is the degree of @xmath181 in @xmath90 .",
    "let @xmath182 for any @xmath179 and @xmath183 .",
    "let @xmath184 the vertex set of @xmath169 is @xmath185 .",
    "note that @xmath186 and @xmath187 .",
    "we add @xmath172 parallel edges in @xmath169 between @xmath188 and @xmath181 for each @xmath189 and add edges between @xmath181 and every vertex in @xmath190 , and between @xmath191 and every vertex in @xmath192 for each @xmath179 and @xmath183 .",
    "formally the edge set of @xmath169 is @xmath193 where @xmath194 denotes a disjoint union as a multiset of @xmath172 copies of @xmath195 , @xmath196 and @xmath197 for each @xmath181 and @xmath198 .",
    "let @xmath199 and @xmath200    for each @xmath201 , let @xmath8 be the contribution to @xmath202 of configurations that are consistent with @xmath6 .",
    "first consider configurations @xmath6 such that @xmath203 for all @xmath204 .",
    "denote by @xmath64 the set of all such configurations on @xmath205 .",
    "then for @xmath206 , we have @xmath207 to see , note that @xmath208 separates the vertices in @xmath170 from the rest of the vertices of @xmath169 . since @xmath6 specifies the spins of all vertices in @xmath208 , the weight @xmath8 is the product of : ( i ) the weights induced on edges that do not involve vertices in @xmath170 , and ( ii ) the weights induced on edges with endpoints in @xmath170 . item ( i ) is just @xmath209 . for item ( ii ) , we need to sum over all possible assignments on @xmath170 ; the factor @xmath210 gives the value of this sum as can be seen by expanding the expression @xmath211    let @xmath212 be the subset of configurations which induce an independent set on the vertices @xmath213 and @xmath214 be its contribution to @xmath202 .",
    "let @xmath215 and @xmath216 be its contribution . if  @xmath217 then @xmath218 . otherwise , @xmath219 .",
    "it implies @xmath220 since @xmath172 satisfies eq .",
    "( [ eqn : t1 ] ) .",
    "next consider configurations  @xmath6 on @xmath205 such that @xmath221 for at least one @xmath204 .",
    "denote this set by @xmath222 and its contribution by @xmath223 .",
    "then for @xmath224 , @xmath225 it implies @xmath226 since @xmath227 and @xmath173 satisfies eq .",
    "( [ eqn : t2 ] ) .    by eq .",
    "( [ eqn : sigma ] ) and eq .",
    "( [ eqn : sigmaprime ] ) we have @xmath228 and clearly @xmath229 .",
    "it is also clear that @xmath168 can be approximated accurately enough given fprases for @xmath24 and @xmath230 .",
    "this finishes our proof .      in this section",
    "we prove the following lemma .",
    "suppose @xmath44 , @xmath45 and @xmath24 are efficiently approximable reals satisfying @xmath3 , @xmath4 and @xmath31 .",
    "suppose that @xmath27 is either an integer that is at least  @xmath231 or @xmath232 ( indicating that we do not have a degree bound ) .",
    "if @xmath30 supports nearly - independent phase - correlated spins and unary symmetry breaking , then there exist efficiently approximable @xmath151 and @xmath233 such that @xmath234 and [ lem : main ]    we prove the antiferromagnetic case first , that is , @xmath19 .",
    "@xmath230 and @xmath235 are chosen as follows .",
    "recall that @xmath236 and @xmath237 .",
    ". then @xmath239 . therefore @xmath240 and",
    "let @xmath241 .",
    "moreover , suppose @xmath147 is the unary symmetry breaking gadget with distinguished vertex @xmath148 .",
    "let @xmath242 where @xmath243 denote @xmath244 for spin @xmath245 and @xmath246 .",
    "let @xmath247 , and @xmath248 .",
    "it is easy to verify that @xmath234 as @xmath249 by the unary symmetry breaking assumption .    given @xmath250 and a bipartite multigraph @xmath93 with a subset @xmath96 where @xmath251 , @xmath252 , and @xmath253 , our reduction first constructs a bipartite graph @xmath169 with degree at most @xmath27 .",
    "the construction of @xmath169 involves a gadget @xmath111 .",
    "since @xmath30 supports nearly - independent phase - correlated spins , by lemma  [ lem : gettingbal ] @xmath30 also supports balanced nearly - independent phase - correlated spins . therefore we draw @xmath254 such that eq .  (",
    "[ eqn : balance ] ) and eq .",
    "( [ eqn : near : ind ] ) hold with probability at least @xmath138 , where @xmath255 and @xmath256 .",
    "assume @xmath111 satisfies them and otherwise the reduction fails .",
    "we will construct @xmath169 such that @xmath257 where we use the abbreviated expressions @xmath258 , @xmath259 , and @xmath260 .",
    "the lemma follows by one oracle call for @xmath261 with accuracy @xmath262 , one oracle call for @xmath263 with accuracy @xmath264 , and an approximation of other terms in the denominator with accuracy @xmath262 using fprases for @xmath126 , @xmath124 , @xmath44 , @xmath45 and  @xmath24 .",
    "the graph @xmath169 is constructed as follows . for each vertex",
    "@xmath179 we introduce a copy of @xmath111 , denoted by @xmath265 with vertex set @xmath266 .",
    "moreover , for each vertex @xmath267 we introduce a copy of @xmath147 , denoted by @xmath268 . whenever a terminal vertex is used in the construction once ,",
    "we say it is occupied . for each @xmath189 , we connect one currently unoccupied positive ( and respectively negative ) terminal of @xmath269 to one currently unoccupied positive ( and respectively negative ) terminal of @xmath265 .",
    "denote by @xmath270 all these edges between terminals .",
    "for each @xmath267 , we identify an unoccupied positive terminal of @xmath269 with the distinguished vertex @xmath271 of @xmath268 .",
    "we denote this terminal by @xmath272 .",
    "the resulting graph is @xmath169 .",
    "it is clear that @xmath169 is bipartite and has bounded degree @xmath27 .",
    "let @xmath273 be a configuration of the phases of the @xmath265 s .",
    "let @xmath274 be the contribution to @xmath261 from the configurations  @xmath6 that are consistent with @xmath275 in the sense that , for each @xmath179 , @xmath276 .",
    "then @xmath277 . let @xmath109 be the set of all terminals @xmath278 and @xmath121 be a configuration on @xmath109 .",
    "let @xmath279 be the configuration @xmath280 restricted to @xmath281 .",
    "recall that for @xmath282 , @xmath283 is the contribution to @xmath284 from configurations that have phase @xmath115 and are consistent with @xmath279 . also , @xmath285 moreover , for each @xmath267 and each spin @xmath245 , let @xmath286 be the contribution to @xmath287 from configurations  @xmath6 with @xmath288 .",
    "hence , @xmath289 we express @xmath274 as @xmath290 where @xmath291 is the contribution of edges in @xmath270 given configuration @xmath280 .",
    "notice that we divide the last factor by @xmath24 when @xmath292 because we counted the vertex weight twice in that case .",
    "define @xmath293 to be an approximation version of the partition function where on each @xmath281 the spins are chosen exactly according to @xmath294 .",
    "that is , @xmath295 let @xmath296 .",
    "( [ eqn : near : ind ] ) implies that @xmath297 and @xmath293 are close , that is , @xmath298 moreover eq .  ( [ eqn : balance ] ) implies that @xmath299 notice that here @xmath284 is the same for any @xmath179 as the @xmath265 s are identical copies of @xmath111 .    then we calculate the following quantity given @xmath275 @xmath300 as the measure @xmath294 is i.i.d .",
    ", we may count the weight of each edge in @xmath270 independently .",
    "notice that @xmath301 is the edge contribution when one end point is chosen with probability @xmath302 and the other @xmath303 . for an edge @xmath304 ,",
    "if @xmath188 and @xmath181 are assigned the same phase @xmath28 , then an edge in @xmath270 connecting one @xmath28 terminal of @xmath269 and one @xmath28 terminal of @xmath265 gives a weight of @xmath305 and an edge connecting two @xmath29 terminals gives @xmath306 .",
    "the total weight is @xmath307 .",
    "similarly if @xmath188 and @xmath181 are assigned the same phase @xmath29 , the total weight is @xmath308 as well . on the other hand",
    "if @xmath188 and @xmath181 are assigned distinct phases @xmath28 and @xmath29 , the total weight is @xmath309 .",
    "recall that @xmath310 .",
    "moreover , for each @xmath267 , if @xmath311 , then the contribution of @xmath268 is @xmath312 and otherwise @xmath313 .",
    "notice that here @xmath287 is the same for any @xmath267 as the @xmath268 s are identical copies of @xmath147 .",
    "recall that @xmath314 .",
    "plug these calculation into eq .",
    "( [ eqn : tildez ] ) , we have @xmath315 where @xmath316 denotes the number of edges of which the two endpoints are of the same phase given @xmath275 , and @xmath317 denotes the number of vertices in @xmath170 that are assigned @xmath28 given @xmath275 . apply eq.([eqn : ratio : balance ] ) to eq.([eqn : tildezsig ] ) , @xmath318 then we sum over @xmath275 in eq .",
    "( [ eqn : tildez : sig ] ) , @xmath319 however notice that @xmath320 by just mapping @xmath29 to @xmath153 and @xmath28 to @xmath15 in each configuration @xmath275 .",
    "combine eq.([eqn : ratio : z : tildez ] ) , and eq.([eqn : tildezb ] ) , @xmath321 recall that @xmath256 and we get the desired bounds .",
    "the other case is ferromagnetic , that is , @xmath18 .",
    "notice that in this case @xmath322 , so we choose @xmath323 and @xmath235 to be the same as the antiferromagnetic case .",
    "the construction of @xmath169 is similar to the previous case , with the following change . for each @xmath189 , we connect one unoccupied positive terminal of @xmath269 to one unoccupied negative terminal of @xmath265 , and vice versa .",
    "the rest of the construction is the same . with this change ,",
    "given a configuration @xmath324 , if two endpoints are assigned the same spin , the contribution is @xmath325 and otherwise @xmath326 .",
    "therefore the effective edge weight is @xmath159 when the spins are the same , after normalizing the weight to @xmath15 when the spins are distinct .",
    "the rest of the proof is the same .",
    "we can now conclude the proof of theorem [ thm : main ] .",
    "# bis - hardness in theorem [ thm : main ] follows directly from lemma  [ lem : bis : ising ] and lemma  [ lem : main ] .",
    "the other direction , # bis - easiness , follows fairly directly from theorem 47 of @xcite ( the full version of @xcite ) .",
    "an edge in the instance graph can be viewed as a constraint of arity  2 . if @xmath327 , then the constraint on the edge is `` weakly log - supermodular '' and the vertex weight can be viewed as a unary constraint , which is taken as given in a `` conservative '' csp . if @xmath328 , then reverse the interpretation of @xmath153 and @xmath15 on one side of the bipartition of the instance graph , so that the effective interaction along an edge is given by the matrix @xmath329 .",
    "this constraint is also `` weakly log - supermodular '' since @xmath330 . after the reversing",
    "there are two vertex weights @xmath24 and @xmath331 , which are also allowed for `` conservative '' csp instances .",
    "in this section we prove lemma [ lem : gettingbal ] that a gadget with nearly - independent phases can be used to construct a gadget with balanced phases .    before proving the lemma",
    ", we introduce some notation .",
    "let @xmath332 let @xmath129 and @xmath128 be the quantities from definition  [ def : sly ] and let @xmath333 the two columns of  @xmath334 correspond to spin  @xmath153 and spin  @xmath15 .",
    "the first row corresponds to the distribution induced on a positive terminal from  @xmath335 and the second to the distribution induced from  @xmath336 .",
    "similarly the first row also corresponds to the distribution induced on a negative terminal from @xmath336 and the second to the distribution induced from @xmath335 .",
    "notice that @xmath337 .",
    "when the parameters  @xmath44 , @xmath45 and @xmath24 are clear , we sometimes make the notation more concise , referring to the partition function as @xmath263 rather than as @xmath338 .",
    "also , given a configuration @xmath339 and a subset @xmath340 of  @xmath341 , we often use the notation @xmath342 to denote the restriction @xmath343 . for",
    "a gadget @xmath111 drawn from @xmath137 , let @xmath344 be the contribution of phase @xmath345 to the partition function @xmath263 .",
    "moreover , for a subset @xmath346 , suppose @xmath347 is a configuration on terminals in @xmath340 .",
    "let @xmath348 be the contribution of configurations that are consistent with @xmath349 and belong to phase @xmath350 , that is , @xmath351 where @xmath8 is the weight of configuration @xmath6 defined in ( [ ourdefw ] ) .",
    "it is easy to see that for @xmath345 , @xmath352 and @xmath353    we are now prepared to prove the lemma which is the focus of this section .",
    "let @xmath70 satisfy @xmath250 . by assumption we may draw a gadget @xmath111 from @xmath354 such that it satisfies eq .",
    "( [ eqn : rough : balance ] ) and eq .",
    "( [ eqn : near : ind ] ) with probability at least 3/4 , where @xmath355 and @xmath356 will be specified later .",
    "assume @xmath111 does",
    ". otherwise the construction fails .",
    "we consider first the antiferromagnetic case @xmath19 .",
    "we construct a gadget @xmath357 such that @xmath357 satisfies eq .",
    "( [ eqn : balance ] ) and eq .",
    "( [ eqn : near : ind ] ) .",
    "we make two copies of @xmath111 , say @xmath358 and @xmath359 .",
    "let the terminals of @xmath360 be @xmath361 for @xmath362 .",
    "for each @xmath345 , we add a set of edges that form a perfect matching between @xmath355 terminals in @xmath363 and @xmath355 terminals in @xmath364 .",
    "denote by @xmath365 the edges of the two perfect matchings.@xmath357 is the resulting graph .",
    "denote by @xmath366 the vertices of @xmath360 that are endpoints of @xmath365 .",
    "the terminals of @xmath357 are those @xmath99 terminal nodes in @xmath367 that are still unmatched , that is @xmath368 for @xmath345 , and @xmath369 .",
    "denote by @xmath370 the terminals of @xmath359 that are unmatched .",
    "we define the phase of @xmath357 to be the phase of @xmath358 , that is , @xmath357 is said to have phase @xmath28 or @xmath29 if and only if @xmath358 has the same @xmath28 or @xmath29 phase regardless of the phase of @xmath359 .",
    "let @xmath371 be a vector denoting the phases of @xmath358 and @xmath359 where @xmath372 .",
    "then the @xmath28 phase of @xmath357 corresponds to the vector @xmath373 and the @xmath29 phase corresponds to @xmath374 . for two configurations @xmath375 and @xmath376 with @xmath377 , let @xmath378 be the joint configuration on @xmath379 .",
    "then we have the following : @xmath380 where @xmath381 denote the contribution from edges of @xmath365 given configurations @xmath382 and @xmath383 , and @xmath384 .",
    "moreover by eq .",
    "( [ eqn : near : ind ] ) , for @xmath362 and any subset @xmath385 , we have @xmath386 where we have used @xmath387 to denote the probability that the configuration on terminals in  @xmath340 is  @xmath349 in the distribution  @xmath388 . therefore by eq .",
    "( [ eqn : zk : tau ] ) , @xmath389 we need to calculate the quantity @xmath390 recall our definitions of @xmath391 and @xmath334 .",
    "let @xmath392 where @xmath393 means transposition . then @xmath394 .",
    "we write @xmath395 and let @xmath396 . here",
    "@xmath301 is the edge contribution when one end point is chosen with probability @xmath302 and the other @xmath303 .",
    "also notice that each edge is independent under @xmath397 so we can count them separately .",
    "then the quantity in eq.([eqn : mudef ] ) is @xmath398 plug eq .",
    "( [ eqn : mu ] ) in eq .",
    "( [ eqn : zk+ ] ) , @xmath399 summing over @xmath400 in eq .",
    "( [ eqn : zk+:tau : upper ] ) we get @xmath401 similarly we get an estimate for @xmath402 : @xmath403 let @xmath404 .",
    "notice that @xmath405 as @xmath358 and @xmath359 are identical copies .",
    "combine eq .",
    "( [ eqn : zk+:upper ] ) and eq .",
    "( [ eqn : zk-:lower ] ) , @xmath406 by eq .",
    "( [ eqn : rough : balance ] ) there is @xmath407 such that @xmath408 and @xmath407 is bounded above by a polynomial in @xmath409 and @xmath410 . to show eq .",
    "( [ eqn : balance ] ) it suffices to show @xmath411 and @xmath412 .",
    "clearly @xmath411 can be achieved by picking @xmath413 and @xmath414 in eq .",
    "( [ eqn : zk : ratio ] ) . to show @xmath412 is similar and therefore omitted .",
    "establishing that eq .",
    "( [ eqn : near : ind ] ) still holds is easy to show",
    ". we will show @xmath415 and the other bounds are similar . by an argument similar to eq .",
    "( [ eqn : zk+ ] ) , we have @xmath416 moreover , summing over @xmath400 in eq .",
    "( [ eqn : zk+ ] ) we get : @xmath417 the desired bound follows as @xmath413 .",
    "the other case is ferromagnetic , that is , @xmath18 .",
    "we construct @xmath357 in the same way as in the previous case , but with the following change .",
    "to form the perfect matching @xmath365 , we match @xmath418 terminals of @xmath358 to @xmath419 terminals of @xmath359 .",
    "the proof goes similarly but @xmath420 .",
    "however since we made a twist in connecting @xmath358 and @xmath359 , it follows that @xmath421 therefore we continue with the new constant @xmath422 and the rest of the proof is the same .",
    "in this section we prove lemma [ lem : sym : break ] that almost all 2-spin models support unary symmetry breaking .",
    "consider the sequence of gadgets @xmath423 , defined as follows .",
    "the vertex set of @xmath424 is @xmath425 , and @xmath188 is considered the attachment vertex .",
    "the edge set of @xmath424 is @xmath426 we shall argue that if the first three graphs in the sequence , namely @xmath427 , @xmath428 and @xmath429 , all fail to be symmetry breakers then one of conditions ( i ) or ( ii ) holds . the graph @xmath427 has an isolated vertex that could clearly be removed ; we leave it in to make the calculations uniform .",
    "note that the maximum degree of any vertex in these graphs is  @xmath231 .",
    "let @xmath430 , @xmath431 and @xmath432 .",
    "then the effective weight of vertex @xmath188 is given by the column vector , @xmath433 where @xmath434 for @xmath435 to be a symmetry breaker we require the vector @xmath436 not to be a multiple of @xmath437 .",
    "suppose @xmath438 , @xmath439 and @xmath440 all fail to be symmetry breakers .",
    "then they must all lie in a one - dimensional subspace of @xmath441 .",
    "one way this can happen is if the matrix @xmath109 is rank  1 , i.e. , if @xmath35 .",
    "this is case  ( i ) .",
    "otherwise , @xmath442 and @xmath443 and @xmath444 lie in a one - dimensional subspace , namely the one generated by @xmath445 .",
    "this implies @xmath446 and @xmath447 , or recasting , @xmath448 so either @xmath449 , or ( dividing the second equation by the first ) @xmath450 and @xmath23 . in either case",
    ", substituting for @xmath451 , @xmath452 and @xmath453 in terms of @xmath44 , @xmath45 , @xmath24 , we obtain either @xmath454 ( which belongs to case ( i ) ) or @xmath20 and @xmath23 ( which is case ( ii ) ) .",
    "there are two exceptional cases .",
    "the first is @xmath35 .",
    "it is well - known that in this case the 2-spin system can be decomposed and hence tractable .",
    "the other case of @xmath20 and @xmath23 is perfectly symmetric and this symmetry can not be broken .",
    "this system is the ising model without external fields . for this system ,",
    "the marginal probability of any vertex in any graph is exactly @xmath34 .",
    "regarding the ferromagnetic case , jerrum and sinclair @xcite presented an fpras for the ferromagnetic ising model with consistent external fields . on the other hand , anti - ferromagnetic ising models without external field on bipartite graphs are actually equivalent to ferromagnetic ising models .",
    "the trick is to flip the assignment on only one part of the bipartition , which has been used before by goldberg and jerrum @xcite .    for @xmath151 , bi-2-spin@xmath455  @xmath456  bi-2-spin@xmath457 .",
    "[ lem : ising : w / o ]    let @xmath458 be a bipartite graph where @xmath459 and @xmath460 are two partitions of vertices .",
    "let @xmath252 .",
    "then we have @xmath461 where in the second line we flip the assignment of @xmath462 .    combining lemma  [ lem : ising : w / o ] with the fpras by jerrum and sinclair @xcite for the ferromagnetic ising model yields the following corollary .    for any @xmath463",
    ", bi-2-spin@xmath455 has an fpras .",
    "[ cor : ising : w / o ]    as explained in the introduction , this corollary helps explain why the notion of unary symmetry breaking is necessary to achieve # bis - hardness .",
    "in this section we prove lemma [ lem : indpt - phases ] that for 2-spin antiferromagnetic systems in the tree non - uniqueness region there is a gadget with nearly - independent phase - correlated spins .",
    "recall that the gibbs distribution is the distribution in which a configuration  @xmath6 is drawn with probability @xmath464 let @xmath465 be the infinite @xmath25-ary tree .",
    "a _ gibbs measure _ on @xmath465 is a measure such that for any finite subtree @xmath466 , the induced distribution on @xmath109 conditioned on the outer boundary is the same as that given by ( [ eqn : gibbs ] ) .",
    "there may be one or more gibbs measures ( see , e.g. ,  @xcite for more details ) .",
    "a gibbs measure is called _ translation - invariant _ if it is invariant under all automorphisms of @xmath465 , and is _ semi - translation - invariant _ if it is invariant under all parity - preserving automorphisms of @xmath465 . in our context , the gibbs measures that will be of interest are the two extremal semi - translation - invariant gibbs measures corresponding to the all @xmath15 s and all @xmath153 s boundary conditions .",
    "these two measures are different in the non - uniqueness region of @xmath465 .",
    "let @xmath467 be the two marginal probabilities of the root having spin  @xmath15 in the two extremal semi - translation - invariant gibbs measures .",
    "more precisely , one can define @xmath468 as follows . for @xmath469 ,",
    "let @xmath470 denote the probability that the root is assigned spin  @xmath15 in the @xmath25-ary tree of depth @xmath471 in the gibbs distribution where the leaves are fixed to spin @xmath472 . in standard terminology , fixing the configuration on the leaves to all 1 s or all 0 s is most commonly referred to as the @xmath473 boundary conditions , respectively ( and hence the indices @xmath473 in our notation of @xmath468 ) .",
    "it is not hard to show that @xmath474 is decreasing in @xmath471 , while @xmath475 is increasing .",
    "let @xmath476 and let @xmath477 .",
    "the two quantities @xmath124 and @xmath126 satisfy the standard tree recursion in the following sense .",
    "let @xmath478 for @xmath345 , and @xmath479 . then @xmath480      sly ( @xcite , theorem 2.1 )  showed that for every @xmath36 , there exists @xmath481 such that the hard - core model @xmath482 supports nearly - independent phase - correlated spins for any @xmath24 satisfying @xmath483 .",
    "this region is a small interval just above the uniqueness threshold . in the same paper sly also showed that @xmath484 supports nearly - independent phase - correlated spins .",
    "the quantities defining measures @xmath397 in definition  [ def : sly ] are exactly the marginal probabilities @xmath485 on @xmath486 .",
    "galanis et al .",
    "@xcite extended the applicable region of sly s gadget for the hard - core model to all @xmath487 for @xmath488 and @xmath489 .",
    "the gap of @xmath490 and @xmath491 is later closed @xcite . in the later paper galanis et al .",
    "@xcite also verified sly s gadget for parameters @xmath30 such that @xmath19 , @xmath492 , and @xmath33 is in the non - uniqueness region of infinite tree @xmath486 . using @xcite we extend the applicable region of sly s gadget to the entire non - uniqueness region for all 2-spin antiferromagnetic models .",
    "sly s construction is based on a technical analysis of the configurations with the largest contribution to the partition function of a random bipartite @xmath27-regular graph .",
    "this required a second moment argument involving a optimization which posed technical difficulties .",
    "following recent developments in @xcite , we describe how to obtain the properties of sly s gadget for all 2-spin antiferromagnetic systems ( including the case with an external field ) in the non - uniqueness region .",
    "we will give an overview of the second moment approach and how to tackle it using the technique in @xcite .",
    "we begin by presenting the relevant definitions and describing the construction of the gadget .      1 .",
    "@xmath494 is supported on bipartite graphs .",
    "the two parts of the bipartite graph are labelled by @xmath473 and each is partitioned as @xmath495 where @xmath496 , @xmath497 for @xmath498 .",
    "@xmath170 denotes the set @xmath499 and similarly @xmath208 denotes the set @xmath500 .",
    "2 .   to sample @xmath501 , sample uniformly and independently @xmath27 matchings : ( i ) @xmath25 random perfect matchings between @xmath502 and @xmath503 , ( ii ) a random perfect matching between @xmath504 and @xmath505 .",
    "the edge set of @xmath111 is the union of the @xmath27 matchings .",
    "thus , vertices in @xmath170 have degree @xmath27 , while vertices in @xmath208 have degree @xmath110 .",
    "the case @xmath506 will also be important , in which case we denote the distribution as @xmath507 .",
    "note that @xmath507 is supported on bipartite @xmath27-regular graphs .",
    "strictly speaking , @xmath508 are supported on multi - graphs , but it is well known that every statement that holds asymptotically almost surely on these spaces continues to hold asymptotically almost surely conditioned on the event that the graph is simple .",
    "we are now ready to give the construction of the gadget . for",
    "constants @xmath509 , let @xmath510 .",
    "note that @xmath511 .",
    "first , sample @xmath111 from the distribution @xmath512 conditioning on @xmath111 being simple .",
    "next , for @xmath513 , attach @xmath98 disjoint @xmath25-ary trees of even depth @xmath471 ( with @xmath514 and @xmath515 ) to @xmath516 , so that every vertex in @xmath516 is a leaf of exactly one tree ( this is possible since @xmath517 ) .",
    "denote by @xmath518 the roots of the trees , so that @xmath519 .",
    "the trees do not share common vertices with the graph @xmath111 , apart from the vertices in @xmath208 .",
    "the final graph @xmath520 is the desired gadget , where the terminals @xmath109 are the roots of the trees . we denote the family of graphs that can be constructed this way by @xmath521 . note that the size of the construction is @xmath522 which is bounded above by a polynomial in @xmath98 when @xmath27 is a fixed constant .",
    "moreover , any @xmath520 drawn from @xmath521 is bipartite .",
    "the terminals of @xmath520 are @xmath523 , and @xmath101 and @xmath100 are on distinct partitions of the bipartite graph .",
    "next we show that if @xmath91 lie in the non - uniqueness regime of @xmath26 , then the gadget @xmath520 satisfies definition [ def : sly ] .",
    "lemma  19 in @xcite shows that this is true , assuming that a certain technical condition is true ( * ? ? ?",
    "* condition 1 ) .",
    "we will introduce this condition and then show that it always holds when @xmath91 lie in the non - uniqueness regime of @xmath26 .",
    "the technical condition involves asymptotics of the leading terms of the first and second moments",
    ". we will derive expressions for these shortly .",
    "moreover , the condition is stated for the case when @xmath506 , as @xmath524 is relatively small and @xcite shows that it does not affect the leading terms .",
    "suppose that @xmath525 .",
    "we look at the contribution of configurations which assign a prescribed fraction of vertices in @xmath526 the spin 1 , with a view to identifying the phases of the gadget . here",
    "@xmath527 and @xmath528 and @xmath529 . for @xmath530 , let @xmath531 where @xmath532 denotes the set of vertices assigned the spin @xmath15 in the configuration @xmath6 .",
    "denote by @xmath533 the total contribution to the partition function of @xmath111 by the configurations in @xmath534 , that is , @xmath535 we will calculate the leading term in the exponent ( as a function of @xmath77 ) of the first and second moment of @xmath533 .    by linearity",
    "we have @xmath536=\\sum_{\\sigma\\in \\sigma^{\\chi^{+},\\chi^{-}}}{\\ensuremath{\\mathbf{e}}}_{{\\ensuremath{\\mathcal{g}}}_n}\\big[w_g(\\sigma)\\big]$ ] .",
    "fix @xmath537 . for convenience ,",
    "set @xmath538 .",
    "let @xmath539 be the number of @xmath13 edges in a random perfect matching between @xmath540 under the configuration @xmath6 .",
    "note that @xmath541 , where @xmath542 and @xmath543 .",
    "it is not hard to see that @xmath544=\\lambda^{n(\\chi^+_n + \\chi^-_n ) }   \\left(\\sum_{\\chi_n\\leq x_n\\leq\\chi_n ' } \\kappa^{\\chi^{+}_n,\\chi^{-}_n}_{x_n } \\right)^{\\delta } , \\mbox { where } \\kappa^{\\chi^{+}_n,\\chi^{-}_n}_{x_n } =    \\frac { \\binom{n\\chi^+_n}{nx_n } \\binom{n(1-\\chi^+_n)}{n(\\chi^-_n - x_n ) } }   { \\binom{n}{n\\chi^-_n } } \\beta^ { n(1-\\chi^+_n-\\chi^-_n+x_n ) }   \\gamma^{nx_n}.\\ ] ] by the linearity of expectation and symmetry , we then have @xmath545 = \\big|\\sigma^{\\chi^+,\\chi^-}\\big|\\ , { \\ensuremath{\\mathbf{e}}}_{{\\ensuremath{\\mathcal{g}}}_n}\\big[w_g(\\sigma)\\big ] , \\mbox { where } \\big|\\sigma^{\\chi^+,\\chi^-}\\big|=\\binom{n}{n\\chi^+_n}\\binom{n}{n\\chi^-_n}. \\label{two2april}\\end{aligned}\\ ] ]    let @xmath546 and @xmath547 .",
    "note that as @xmath548 , @xmath549 . in section  [ sec : asymptotics ] , using stirling s approximation , it is shown that @xmath550=\\psi_{1;\\beta,\\gamma,\\lambda}(\\chi^+,\\chi^-)+o(1),\\ ] ] where , under the convention @xmath551 , @xmath552 note that all the quantities in are independent of @xmath77 .    to calculate the second moment",
    ", the approach is completely analogous though we need to introduce more variables . for @xmath553 ,",
    "let @xmath554 let @xmath555 .",
    "notice that @xmath556 is the contribution to @xmath557 from pairs of configurations in @xmath534 with overlap @xmath558 and @xmath559 .",
    "then , we have @xmath560    = \\sum_{\\upsilon^+,\\upsilon^-}{\\ensuremath{\\mathbf{e}}}_{{\\ensuremath{\\mathcal{g}}}_n}\\left[y^{\\chi^+,\\chi^-}_{\\upsilon^+,\\upsilon^-}\\right],\\ ] ] where the sum is over integer multiples @xmath561 and @xmath562 of  @xmath563 . later",
    "we will replace this sum with a maximum and consider general real numbers  @xmath561 and  @xmath562 . to unify the notation in both cases , set @xmath564 and @xmath565 .",
    "note that the overlap @xmath566 is at most @xmath567 and at least @xmath568 and similarly for the minus side .    to get an expression for",
    "@xmath569 $ ] , fix arbitrary @xmath570 . the configurations",
    "@xmath571 and @xmath572 divide each of  @xmath573 and  @xmath505 into @xmath574 subsets . let the subsets chosen for spin  @xmath15 by both  @xmath571 and  @xmath572 be numbered  @xmath15 on the  @xmath28 side and the  @xmath29 side . similarly , let the subsets chosen for spin  @xmath15 in  @xmath571 and for spin  @xmath153 in  @xmath572 be numbered  @xmath575 and the subsets chosen for spin  @xmath153 in  @xmath571 and spin  @xmath15 in  @xmath572 be numbered  @xmath231 . finally , let the subsets chosen for spin  @xmath153 in both  @xmath571 and  @xmath572 be numbered  @xmath574 .",
    "let @xmath576 be the number of edges between subset @xmath577 on one side and subset @xmath198 on the other , and @xmath578 .",
    "define @xmath579 observe that the @xmath580 satisfy @xmath581,\\quad \\sum_i y_{ijn}=r_{jn},~\\text { for } j\\in[4],\\\\    y_{ijn}\\geq 0~\\text { and } y_{ijn } \\text { is an integral   multiple of $ 1/n$}. \\end{gathered}\\ ] ] then we have @xmath582=\\lambda^{2n(\\chi^+_n + \\chi^-_n)}\\bigg ( \\sum_{\\mathbf{y_n}}\\xi^{\\chi^+_n , \\chi^-_n}_{\\upsilon^+_n,\\upsilon^-_n,\\mathbf{y}_n}\\bigg)^{\\delta},\\label{longeq}\\ ] ] where @xmath583 to see why is true note that a random matching may be obtained by fixing the permutation within each of the @xmath584 subsets @xmath585 of the `` @xmath29 '' side and then choosing the @xmath584 corresponding blocks of the `` @xmath28 '' side giving the denominator @xmath586",
    ". then the numerator counts all matchings consistent with  @xmath571 and  @xmath572 giving @xmath587 .",
    "the factors @xmath588 cancel , giving the first line in .",
    "the second line is just @xmath589 .    to account for the cardinality of @xmath590 , by the linearity of expectation and symmetry ,",
    "we obtain @xmath591    = { n\\choose nl_{1n},nl_{2n},nl_{3n},nl_{4n}}{n\\choose nr_{1n},nr_{2n},nr_{3n},nr_{4n}}\\ , { \\ensuremath{\\mathbf{e}}}_{{\\ensuremath{\\mathcal{g}}}_n}[w(\\sigma_1)w(\\sigma_2)]\\ ] ]      using again stirling s approximation , in section  [ sec : asymptotics ] it is shown that @xmath595 = \\psi_{2;\\beta,\\gamma,\\lambda}'(\\chi^+,\\chi^-,\\upsilon^+,\\upsilon^-)+o(1),\\end{aligned}\\ ] ] where @xmath596 where the maximum is over non - negative ( real vectors ) @xmath597",
    "satisfying @xmath598 , \\quad \\sum_i y_{ij}=r_j,~\\text { for } j\\in[4].\\\\\\ ] ]    to obtain the leading term of the second moment @xmath599 $ ] , define @xmath600 in section  [ sec : asymptotics ] , we will show @xmath601    = \\psi_{2;\\beta,\\gamma,\\lambda}(\\chi^+,\\chi^-)+o(1),\\ ] ] where @xmath602    we want to focus on @xmath603 which maximize @xmath604 .",
    "it is shown in ( * ? ? ?",
    "* lemma 1 ) that when non - uniqueness holds , there exist @xmath605 with @xmath606 such that @xmath607 is the unique maximizer ( up to symmetry ) of @xmath604 .",
    "we should note here that the values @xmath605 are the analogues of @xmath468 for the infinite @xmath27-regular tree ( observe that the infinite @xmath27-regular tree differs from @xmath26 only at the degree of the root ) .",
    "the technical condition from @xcite is as follows .      to see that our version of condition  [ cond : cond ] is equivalent to the version in @xcite , use ( [ lastone ] )",
    "our interest in condition  [ cond : cond ] is justified by the following lemma which is proved in @xcite .",
    "we will establish condition [ gsv12:condition1 ] when @xmath33 lies in the non - uniqueness region of @xmath26 . to do so",
    ", we apply results from @xcite .",
    "the next lemma is a specialization of theorem @xmath231 from @xcite to our setting for the case that there is no field .",
    "for the first equation , note from the definition of @xmath615 that @xmath616 thus , from the definition of @xmath617 , we have @xmath618 similarly , from the definition of @xmath619 , we have @xmath620 and from the definition of @xmath621 , @xmath622 however by @xmath623 therefore we have @xmath624 as @xmath625 is the maximum of @xmath619 over @xmath597 and @xmath626 is the maximum of @xmath625 over @xmath627 , the second and the third equations hold .",
    "lemma  [ lem : new ] shows that modulo a constant term , the expressions  @xmath617 and  @xmath626 are preserved by the standard transformation on @xmath27-regular graphs whereby an external field  @xmath24 is pushed into the edge interactions .",
    "using this lemma , we can now draw conclusions about the maximisation of these quantities in our setting .",
    "[ lem : first and second moment ] for any parameter set @xmath33 and @xmath36 , if @xmath33 lies in the non - uniqueness region of @xmath26 , then @xmath628 and @xmath629 maximizes both @xmath604 and @xmath630 .",
    "first , using equalities ( [ ssone ] ) and ( [ sstwo ] ) , and the fact that @xmath631 \\geq { \\ensuremath{\\mathbf{e}}}[x]^2 $ ] , @xmath632 + o(1)\\\\ & \\geq     \\frac{1}{n}\\log { \\left ( { \\ensuremath{\\mathbf{e}}}_{{\\ensuremath{\\mathcal{g}}}_n}\\big[z_g^{p^+,p^-}\\big ] \\right)}^2 + o(1)\\\\ & =   2 \\frac{1}{n}\\log   { \\ensuremath{\\mathbf{e}}}_{{\\ensuremath{\\mathcal{g}}}_n } \\big[z^{p^+,p^-}_g\\big ]   + o(1)\\\\ & = 2 \\psi_{1;\\beta,\\gamma,\\lambda}(p^+,p^-)+o(1).\\end{aligned}\\ ] ]                          from corollary  [ cor : new ] , we have that for all @xmath641 and @xmath642 and all @xmath643 , @xmath646 in particular , this holds for @xmath647 and @xmath648 . together with lemma  [ lem : first and second moment ] , it gives us that for all @xmath649 , @xmath650 it implies that @xmath608 is maximized at @xmath651 , which is condition [ gsv12:condition1 ] .",
    "the proof is a rather lengthy formalisation of the following main idea : as @xmath77 grows large , the sums in the expressions for the first and second moments are dominated by their maximum terms and the integrality conditions for the variables may be dropped introducing only @xmath652 ( additive ) error in the asymptotics of the logarithms .",
    "we will use the following lemma .",
    "recall that for a metric space @xmath653 , an @xmath70-cover of a set @xmath654 is a set @xmath655 such that every point in @xmath656 is within distance @xmath70 from a point in @xmath657 .",
    "note that we do _ not _ require @xmath658 . recall also that @xmath659 is a limit point of @xmath656 if @xmath69 is in the closure of @xmath660 .",
    "[ lem : maximalimit ] let @xmath661 be a continuous function on @xmath662 .",
    "let @xmath663 be a compact subregion of @xmath664 . for @xmath665",
    ", let @xmath666 be an @xmath667-cover of @xmath663 , where @xmath668 as @xmath592 .",
    "assume further that the @xmath669 are uniformly bounded and that the set of limit points of @xmath670 is a subset of @xmath663 .",
    "then , as @xmath592 , it holds that @xmath671      we first prove the right - most inequality in .",
    "assume for the sake of contradiction that @xmath676 .",
    "then , there exist sequences @xmath677 with @xmath678 and @xmath679 such that @xmath680 for some @xmath681 .",
    "since the @xmath669 are uniformly bounded , @xmath682 are bounded , and so they have a convergent subsequence , whose limit we denote by @xmath683 . from the continuity of @xmath674",
    ", we obtain @xmath684 .",
    "we claim that @xmath685 , and thus obtain a contradiction to the choice of @xmath673 .",
    "indeed , if there exists @xmath686 such that @xmath687 for all @xmath688 , we have @xmath685 by compactness of @xmath663 .",
    "otherwise , by restricting to a subsequence of @xmath682 if necessary , @xmath683 is a limit point of @xmath670 , and hence @xmath685 .    to show the left - most inequality in ,",
    "let @xmath689 be such that @xmath690 .",
    "since the @xmath669 are @xmath667-covers of @xmath663 and @xmath691 , there exists a sequence @xmath692 with @xmath693 such that @xmath694 .",
    "note that @xmath695 and thus , from the continuity of @xmath674 , we obtain @xmath696 .",
    "this finishes the proof of .",
    "we will now prove equations  , and .",
    "we start with the first moment @xmath536 $ ] . under the convention @xmath697",
    ", @xmath698 is continuous for @xmath699 and @xmath700 .",
    "we will write @xmath701 for @xmath702 .",
    "the function @xmath701 is continuous over the region @xmath703    the following asymptotic expressions are obtained from stirling s approximation for @xmath704 and @xmath705 using equations and .",
    "@xmath706 note that the sum over  @xmath707 in the expression which is used in for @xmath536 $ ] has at most @xmath77 terms , so obviously the number of terms is at most a polynomial in  @xmath77 .",
    "thus , we may approximate the sum by its maximum term to obtain @xmath708= \\log(\\lambda)(\\chi^+_n+\\chi^-_n)+(\\delta-1){f}_1(\\chi^+_n,\\chi^-_n)+\\delta \\max_{x_n\\in[\\chi_n,\\chi_n ' ] } { g}_{1}(x_n,\\chi^+_n,\\chi^-_n)+o(1).\\ ] ] where , recall , @xmath709 . moreover , as @xmath592 , we have @xmath710}{g}_{1}(x_n,\\chi^+_n,\\chi^-_n)&\\rightarrow \\max_{x\\in[\\chi,\\chi ' ] } { g}_{1}(x,\\chi^+,\\chi^-)\\label{eq : ng1},\\end{aligned}\\ ] ] where recall that @xmath711 .",
    "the limit follows from @xmath712 and the continuity of @xmath713 . to establish the limit we use lemma  [ lem : maximalimit ] for the function @xmath615 , with @xmath714 as defined in ( [ eq : rg ] ) , @xmath715 and @xmath716 .",
    "the @xmath669 are @xmath717-covers of @xmath663 ( with room to spare for the constant 10 ) under the euclidean metric on @xmath718 .",
    "it is also immediate to verify that the set of limit points of @xmath719 is a subset of @xmath663 as a consequence of @xmath720 .",
    "we next turn to the second moment @xmath722 $ ] .",
    "the reasoning is almost identical , though carrying out the arguments is more cumbersome due to the larger number of variables .",
    "let @xmath723 the function @xmath724 is continuous over  @xmath725 .",
    "we will also write @xmath726 instead of @xmath727 . note that @xmath726 is continuous over @xmath728 , y_{ij } \\geq 0\\}$ ] . by analogy",
    "to , define @xmath729 for @xmath730 , define @xmath731 } \\mid   \\forall i , j\\in[4 ] , y_{ij } \\geq 0,\\sum_j y_{ij}=l _ i , \\sum_i y_{ij } = r_j   \\big\\}.\\ ] ] let @xmath732 and let @xmath733 .",
    "we are now set to compute the asymptotics of @xmath738 $ ] , for which we have derived an expression in .",
    "approximating the sums in the expression by their maximum terms only introduces @xmath652 error , so we obtain @xmath739&=2\\log(\\lambda)(\\chi^+_n+\\chi^-_n)+(\\delta-1){f}_2(\\chi^+_n,\\chi^-_n , \\upsilon^+_n,\\upsilon^-_n)+\\delta \\max_{\\mathbf{y}_n\\in \\mathcal{c}_n } { g}_{2}(\\mathbf{y}_n)+o(1).\\end{aligned}\\ ] ]    taking limits as @xmath592 , we will now derive analogues of and : @xmath740 equation  ( [ eq : nf2 ] ) follows from the continuity of  @xmath741 .",
    "equation  ( [ eq : ng2 ] ) follows by lemma  [ lem : maximalimit ] .",
    "combining , and gives @xmath742=2\\log(\\lambda)(\\chi^++\\chi^-)+ ( \\delta-1){f}_2(\\chi^+,\\chi^- , \\upsilon^+,\\upsilon^-)+\\delta \\max_{\\mathbf{y}\\in \\mathcal{t}(\\chi^+,\\chi^- , \\upsilon^+,\\upsilon^- ) } { g}_{2}(\\mathbf{y})+o(1).\\ ] ] the right - hand side is @xmath743 , so we have established  .    to obtain , the sum yields @xmath744&=2\\log(\\lambda)(\\chi^+_n+\\chi^-_n)\\\\ & + \\max_{(\\upsilon^+_n,\\upsilon^-_n,\\mathbf{y}_n)\\in \\mathcal{o}_n}\\ { ( \\delta-1){f}_2(\\chi^+_n,\\chi^-_n , \\upsilon^+_n,\\upsilon^-_n)+\\delta { g}_{2}(\\mathbf{y}_n)\\}+o(1 ) , \\end{aligned}\\ ] ] where @xmath745 yet another application of lemma  [ lem : maximalimit ] yields @xmath746 where @xmath747 . combining and yields , as desired .",
    "andrei  a. bulatov , martin dyer , leslie  ann goldberg , mark jerrum , and colin mcquillan .",
    "the expressibility of functions on the boolean domain , with applications to counting csps . , 60(5):32:132:36 , october 2013 .",
    "xi  chen , martin  e. dyer , leslie  ann goldberg , mark jerrum , pinyan lu , colin mcquillan , and david richerby .",
    "the complexity of approximating conservative counting csps .",
    "preprint , 2012 .",
    "available from the arxiv at : http://arxiv.org/abs/1208.1783            andreas galanis , qi  ge , daniel tefankovi , eric vigoda , and linji yang .",
    "improved inapproximability results for counting independent sets in the hard - core model . in _ approx - random _ ,",
    "pages 567578 , 2011 .",
    "andreas galanis , daniel tefankovi , and eric vigoda .",
    "inapproximability of the partition function for the antiferromagnetic ising and hard - core models .",
    "preprint , 2012 .",
    "available from the arxiv at : http://arxiv.org/abs/1203.2226[http://arxiv.org/abs/1203.2226v3 ] andreas galanis , daniel tefankovi , and eric vigoda .",
    "inapproximability for antiferromagnetic spin systems in the tree non - uniqueness region .",
    "preprint , 2013 . to appear in _ stoc _ , 2014 .",
    "available from the arxiv at : http://arxiv.org/abs/1305.2902[http://arxiv.org/abs/1305.2902v2 ] qi  ge and daniel tefankovi . a graph polynomial for independent sets of bipartite graphs . in _",
    "fsttcs _ , pages 240250 , 2010 .",
    "leslie  ann goldberg , mark jerrum , and colin mcquillan . approximating the partition function of planar two - state spin systems .",
    "preprint , 2012 .",
    "available from the arxiv at : http://arxiv.org/abs/1208.4987            liang li , pinyan lu , and yitong yin .",
    "correlation decay up to uniqueness in spin systems . in _ soda _ ,",
    "pages 6784 , 2013 .",
    "available from the arxiv at : http://arxiv.org/abs/1111.7064[http://arxiv.org/abs/1111.7064v2 ]"
  ],
  "abstract_text": [
    "<S> counting independent sets on bipartite graphs ( # bis ) is considered a canonical counting problem of intermediate approximation complexity . </S>",
    "<S> it is conjectured that # bis  neither has an fpras nor is as hard as # sat  to approximate . </S>",
    "<S> we study # bis  in the general framework of two - state spin systems on bipartite graphs . </S>",
    "<S> we define two notions , nearly - independent phase - correlated spins and unary symmetry breaking . </S>",
    "<S> we prove that it is # bis - hard to approximate the partition function of any 2-spin system on bipartite graphs supporting these two notions . as a consequence , </S>",
    "<S> we classify the complexity of approximating the partition function of antiferromagnetic 2-spin systems on bounded - degree bipartite graphs . </S>"
  ]
}