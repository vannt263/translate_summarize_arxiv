{
  "article_text": [
    "constraint satisfaction problems ( csps ) occur widely in practice , both as natural problems , and as an underlying framework for constraint programming ; see a text such as tsang  @xcite . when the template is restricted to some fixed finite domain",
    ", these problems still cover many important practical problems as well as providing an important framework for theoretical considerations in computational complexity . in the case of boolean ( 2-element ) domains , constraint problems coincide with the @xmath2 variants examined by schaefer  @xcite . in his paper , schaefer proved a famous dichotomy : he showed that the complexity of csps over a fixed boolean constraint language is either decidable in polynomial time or is np - complete . since schaefer s seminal contribution",
    ", there have been enormous advances toward a more general dichotomy for constraint satisfaction problems on non - boolean domains . in  @xcite ,",
    "feder and vardi argue that fixed template csps emerge as the broadest natural class for which a dichotomy might hold and propose the well - known _",
    "dichotomy conjecture_. numerous extensions of schaefer s result are now known .",
    "the broadest of these include the case of three - element domains ( bulatov  @xcite ) , list homomorphism problems ( bulatov  @xcite ) , and the case of directed graphs without sources and sinks ( barto , kozik and niven  @xcite ) .",
    "in addition to direct extensions of schaefer s results , many variants of constraint satisfaction problems have been shown to experience similar dichotomies , such as counting csps ( bulatov  @xcite ) , balanced csps ( schnoor and schnoor  @xcite ) and equivalence problems ( bhler , hemaspaandra , reith and vollmer  @xcite ) . in the present work ,",
    "we explore computational complexity for variants of the csp where instead of asking for the existence of a single solution , one asks for enough solutions to witness a range of conditions .",
    "we focus in particular on _ separability _ and _ robust satisfiability_. the separation problem @xmath3 asks if it is true that , for every pair of distinct variables @xmath4 and @xmath5 , there is a solution giving @xmath4 a different value to @xmath5 . the @xmath6-robust satisfiability problem asks if every compatible partial assignment on @xmath7 variables extends to a full solution . as explained in jackson  @xcite ,",
    "the @xmath3 condition arises naturally in universal algebraic considerations , and is also closely related to problems without a backbone : problems ( typically sat variants ) where no variable is forced to take some fixed value .",
    "implicit constraints such as these are widely associated with computational difficulty ; see monasson et al .",
    "@xcite , beacham and culberson @xcite and culberson and gent  @xcite . in the language of  @xcite for example",
    ", the @xmath3 condition corresponds to the `` unfrozenness of equality '' .",
    "robust constraint problems have been studied in a number of different contexts , including beacham  @xcite and gottlob  @xcite , with the general concept formulated in abramsky , gottlob and kolaitis  @xcite .",
    "the @xmath8-robustness condition is an extension of the robustness condition of @xcite .    a remarkable result of gottlob  @xcite states that for any @xmath7 , the decision problem ( @xmath9)@xmath2 experiences a striking  gap property \" : subject to @xmath10",
    ", there is no polynomial - time decidable class of instances containing those for which every possible partial assignment on @xmath7 variables extends to a satisfying solution and disjoint from the set of no instances of the corresponding @xmath11 .",
    "in fact , every such class is @xmath1-hard .",
    "abramsky , gottlob and kolaitis  @xcite and then jackson  @xcite showed that gaps of this style are also to be found for some other well - known @xmath1-complete problems , including @xmath12 , @xmath13 , @xmath14 , and positive @xmath15-in-@xmath16 @xmath2 .",
    "we investigate computational gap theorems in the boolean case , establishing a gap trichotomy theorem ( theorem [ thm : maingap ] ) that provides dichotomies for an entire family of computational problems , including @xmath3 and @xmath17-robust satisfiability , with all intractable cases exhibiting a gap property .",
    "in particular , we completely characterise the tractability of @xmath3 and @xmath17-robust satisfiability in the case of boolean domains , as well recovering schaefer s dichotomy theorem in case of core relational structures .    a pivotal development in the classification of fixed template @xmath11 complexity , including the aforementioned extensions of schaefer s dichotomy for boolean csps , was the introduction of universal algebraic methods ; starting with the work of jeavons @xcite , jeavons , cohen , gyssens @xcite , with the full framework presented in bulatov , jeavons , krokhin @xcite .",
    "the algebraic method concerns the analysis of `` polymorphisms '' ( see definition [ defn : poly ] below ) of the template . for some computational problems",
    ", polymorphism analysis appears too coarse ; this is true for @xmath3 and robust satisfiability , as well as other variants of the @xmath11 considered in @xcite and @xcite . in these cases , it is necessary to move to partial polymorphisms . as a second main result , we show that the basic universal algebraic methods can nevertheless be established in this setting , including many of the @xmath11 variants just listed .",
    "the present article is comprised of eight sections : section  [ sec : seprob ] introduces four computational problems that will be of primary interest .",
    "section  [ sec : back ] covers the minimum required background for the full statement of our first main result . in section  [ sec : mainresults ] , we give the necessary notion of a gap property and present the gap trichotomy theorem , as well as numerous dichotomy theorems that are immediate consequences .",
    "section  [ sec : weakbase ] covers preliminary concepts required for the main arguments ; these relate to weak co - clones and strong partial clones .",
    "sections  [ sec : gaps ] and [ sec : tractable ] are dedicated to establishing the gap trichotomy theorem ; more specifically , section  [ sec : gaps ] deals with the intractable cases , and section [ sec : tractable ] with the tractability cases . in section  [ sec :",
    "algebra ] , we investigate how algebraic methods for studying @xmath11 complexity can be recovered for computational problems amenable to partial polymorphism analysis .",
    "we begin by introducing four computational problems that will be of primary focus in the present article .",
    "let @xmath18 be a set of relation symbols , each with an associated finite arity .",
    "a _ template _ is a pair @xmath19 consisting of a _",
    "set @xmath20 together with an interpretation of each @xmath21-ary relation symbol @xmath22 as a subset @xmath23 of @xmath24 .",
    "the set @xmath25 is often referred to as a _ constraint language over domain _",
    "@xmath20 .",
    "when the context is clear , we will blur the distinction between a constraint language and the corresponding set of relation symbols by omitting the superscript  @xmath26 .",
    "let @xmath19 be a template .",
    "we define a _ constraint instance for @xmath27 _ or a _ @xmath27-instance _ to be a triple @xmath28 consisting of    * a set of variables @xmath29 , * the domain set @xmath20 , and * a set of constraints @xmath30 .",
    "each constraint @xmath31 is a pair @xmath32 , where @xmath23 is a @xmath7-ary relation in @xmath33 and @xmath34 is a @xmath7-tuple involving variables from @xmath29 .",
    "we define a _ solution _ of @xmath35 to be any assignment @xmath36 satisfying @xmath37 , for each @xmath38 in @xmath39 .",
    "+   +   +    note that every yes instance of a @xmath3 problem is a yes instance of the corresponding @xmath11 problem .    from an algebraic perspective ,",
    "a constraint satisfaction problem over template @xmath40 coincides with the homomorphism problem for the relational structure  @xmath26 : an instance @xmath28 becomes a @xmath18-structure @xmath41 , by letting @xmath42 , for each @xmath7-ary relation @xmath43 .",
    "if we let @xmath44 be the class of all finite @xmath18-structures admitting a homomorphism into @xmath26 , then the constraint satisfaction problem over @xmath26 is equivalent to deciding membership in this class . in a similar way",
    ", we can view a separation problem @xmath45 as deciding membership in the class @xmath46 , which consists of all finite @xmath18-structures for which there is an injective homomorphism into a finite direct power of @xmath26 .",
    "see jackson  @xcite for a more detailed discussion .    before we can introduce the fourth computational problem of interest , we require some definitions .",
    "let @xmath47 be a set of finitary relation symbols and let @xmath48 be a set of pairwise distinct variables .",
    "a formula in the language of @xmath47 is called an _ atomic formula _ if it takes one of the following two forms :    * @xmath49 for some @xmath50 ; * @xmath51 , for some @xmath7-ary relation symbol @xmath52 and some variables @xmath53 .",
    "we refer to formulas of the second form _",
    "@xmath47-constraints _ or _",
    "@xmath47-tuples_. a formula in the language of @xmath47 is called a _ primitive - positive formula _ ( abbreviated to pp - formula ) if , for some @xmath54 and @xmath55 , it is of the form : @xmath56 where @xmath57 are distinct variables , and @xmath58 is an atomic formula with variables amongst @xmath59 , for each @xmath60 . a quantifier - free pp - formula ( corresponding to @xmath61 )",
    "is called a _ conjunct - atomic formula _ , and called a _ equality - free conjunct - atomic formula _ if it is a conjunct - atomic formula involving only @xmath47-constraints .",
    "let @xmath19 be a template .",
    "let @xmath62 , let @xmath63 be pairwise distinct variables and let @xmath64 be a pp - formula in the language @xmath18 .",
    "the formula @xmath65 defines a @xmath7-ary relation @xmath66 on @xmath20 : @xmath67 this extends to systems @xmath68 of variables constrained by relations in @xmath27 : include constraint @xmath69 if there exist @xmath70 in @xmath29 such that constraint @xmath71 is in @xmath72 for each @xmath73 .",
    "we refer to @xmath74 as the _ constraint defined by @xmath65 from @xmath39_.    let @xmath75 be a finite set of pp - formul in the language of @xmath76 .",
    "we define the following constraint language over @xmath20 : @xmath77 we let @xmath78 and for any instance @xmath68 of @xmath27 we let @xmath79 be the constraints defined by @xmath80 from @xmath72 .",
    "we sometimes refer to the constraints in @xmath79 as _",
    "@xmath80-constraints_.    let @xmath27 be a constraint language over a finite set @xmath20 , let @xmath80 be a finite set of pp - formul in the language of @xmath18 and let @xmath81 be a @xmath27-instance . for a subset @xmath82 , we say that an assignment @xmath83 is _",
    "@xmath75-compatible _ if it preserves all constraints in @xmath79 on tuples from @xmath84 , equivalently , if @xmath85 is a solution of @xmath86 in @xmath87 .    in other words ,",
    "if for some @xmath88 and some tuple @xmath89 the formula @xmath90 is true in @xmath81 , then @xmath91 must be true in @xmath92 .",
    "in the following , we let @xmath7 be a nonnegative integer and @xmath75 be a finite set of pp - formul in the language of @xmath18 .",
    "+    ' '' ''    in the case where @xmath75 consists of the set of pp - formul defining all projections of relations in @xmath27 , the notion of @xmath75-compatibility has been called `` local compatibility '' and @xmath8-robust satisfiability called `` @xmath7-robust satisfiability '' , see abramsky , gottlob and kolaitis  @xcite , or  @xcite for example . when @xmath75 consists of these formul , we will use the abbreviated notation @xmath7-@xmath93 to refer to the @xmath8-robust satisfiability problem over @xmath26 . in (",
    "* lemma  @xmath94 ) , jackson proposes that @xmath75-compatibility is a natural local compatibility condition .",
    "we are primarily concerned with computational problems over finite constraint languages , however it will be useful to have a notion of tractability for constraint problems over infinite languages ( over finite domains ) .",
    "the following definition is in line with bulatov , jeavons and krokhin  ( * ? ? ?",
    "* definition  2.7 ) , though we use `` locally tractable '' in preference to `` tractable '' .",
    "let @xmath20 be a finite non - empty set and let @xmath76 be a set of relations on  @xmath20 , and let @xmath95 be any of the computational problems @xmath11 , @xmath96 , @xmath3 , or @xmath6-@xmath97 .",
    "* if @xmath76 is an infinite set , then we say that @xmath98 is _ locally tractable _ if , for every finite subset @xmath47 of @xmath18 , the problem @xmath99 is tractable . *",
    "the problem @xmath100 is @xmath101-complete if there is a finite subset @xmath102 for which @xmath103 is @xmath101-complete .",
    "we will sometimes abbreviate @xmath100 to @xmath104 .",
    "the precise boundaries given in the gap trichotomy theorem are more easily expressed using the language clone of theory . in this section ,",
    "we introduce background material required to state the main results in full detail .",
    "the reader familiar with clone theory may skip this section and proceed to the main results in section  [ sec : mainresults ] .",
    "let @xmath20 be a non - empty set . for @xmath105",
    ", we define an _ operation _ of arity @xmath21 on @xmath20 to be a map @xmath106 .",
    "we define    * to be the set of all non - empty , non - nullary finitary relations on @xmath20 , and * to be the set of all non - empty , non - nullary finitary operations on  @xmath20 .",
    "[ defn : poly ] let @xmath20 be a non - empty set , let @xmath107 , let @xmath108 be a @xmath21-ary operation and let @xmath109 be a @xmath7-ary relation on the set @xmath20 .",
    "we say that @xmath85 _ preserves _ @xmath109 or @xmath109 is _ invariant under _ @xmath85 or @xmath85 is a _ polymorphism _ of @xmath109 , if whenever @xmath110 are tuples in @xmath111 , then @xmath112 if @xmath113 is set of operations then we say that @xmath109 is invariant under @xmath113 if @xmath109 is invariant under every operation in @xmath113",
    ".    let @xmath20 be a non - empty set and let @xmath114 .",
    "then @xmath39 is a _",
    "clone _ on the set @xmath20 if the following two conditions hold :    1 .",
    "@xmath30 contains all projection operations : that is , for all @xmath115 , the @xmath116th projection @xmath117 given by @xmath118 belongs to @xmath39 ; 2 .",
    "@xmath30 is closed under compositions .    for a set @xmath113 of total operations",
    ", we can define @xmath119 $ ] to be the smallest clone containing @xmath113 and we refer to @xmath119 $ ] as the _ clone generated by _ @xmath113 .",
    "the set @xmath113 is sometimes called a _ base _ for the clone @xmath119 $ ] .",
    "let @xmath20 be a non - empty set .",
    "a subset @xmath47 of @xmath120 is called a _ co - clone _ or _ relational clone _ if it is closed under the formation of pp - definable relations .",
    "we can define @xmath121 to be the smallest co - clone containing @xmath47 and we refer to @xmath121 as the _ co - clone generated by _ @xmath47 .",
    "the set @xmath47 is sometimes called a _ base _ for @xmath121 .",
    "recall that for any non - empty set @xmath20 , the set of all clones ( co - clones ) on @xmath20 ordered by set inclusion forms an algebraic intersection structure .",
    "the sets @xmath122 and @xmath123 are complete lattices , where @xmath124 is the powerset operator . the following well - known result was first observed by geiger @xcite .",
    "[ thm : geiger ] let @xmath20 be a non - empty set .",
    "the following pair of maps @xmath125 and @xmath126 form a galois connection between @xmath122 and @xmath123 .",
    "@xmath127 for each @xmath128 and each @xmath129 .",
    "we list some useful consequences of theorem  [ thm : geiger ] .",
    "* @xmath130 , $ ] for all @xmath131 .",
    "* @xmath132 , for all @xmath133 . *",
    "the lattice of all clones on @xmath20 is dually isomorphic to the lattice of all co - clones on @xmath20 . *",
    "every clone @xmath39 corresponds to a unique co - clone @xmath134 .",
    "note that large clones correspond to small co - clones .",
    "a characterisation of all clones on the two - element set @xmath135 was given by post  @xcite and the lattice of these `` boolean clones '' is usually called _",
    "post s lattice_. in fact , there is a countable infinity of clones ( co - clones ) in the boolean case .",
    "an up - set of the boolean co - clone lattice is given in figure  [ clo : dualpost ] ; the table included gives definitions of the shaded vertices in terms of relations invariant under basic operations .",
    "the operations @xmath136 and @xmath137 are the constant unary functions to @xmath138 and  @xmath15 , respectively , and @xmath139 is the usual negation operation on @xmath135 .",
    "the shaded co - clones play a key role in formulating the main results ; see section  [ sec : mainresults ] for a full discussion .",
    "we refer the reader to schnoor  ( * ? ? ?",
    "* table  @xmath94 ) for a full list of bases and definitions of all boolean co - clones .",
    "abbreviates @xmath134 , for each boolean clone  @xmath39 . ]",
    "the first main result presents a trichotomy of computational gap theorems for boolean constraint languages . as consequences , we obtain dichotomy theorems for each of the four computational problems described in section  [ sec : seprob ] . we first introduce the notion of a `` gap property '' and fix some useful notation .    in the following ,",
    "let @xmath18 be a finite set of relations on @xmath135 and let @xmath140 and @xmath141 be disjoint sets of @xmath18-instances .",
    "let @xmath18 be a finite set of relations on @xmath135 , let @xmath142 and let @xmath75 be a finite set of pp - formul in the language of @xmath18 .",
    "we use    * @xmath143 to denote the set of no instances for @xmath144 , * @xmath145 to denote the set of no instances for @xmath146 , * @xmath147 to denote the set of yes instances for ( @xmath148)-@xmath149 , * @xmath150 to denote the set of yes instances for @xmath7-@xmath149 , * @xmath151 to denote the set of yes instances for @xmath152 , * @xmath153 to denote the set of instances in @xmath154 .",
    "when the context refers to a specific constraint language @xmath18 , we omit @xmath18 from this notation .",
    "[ thm : maingap ] let @xmath18 be a constraint language on @xmath135 .    1 .",
    "if @xmath155 or @xmath156 , then @xmath18 satisfies @xmath157 , for some finite set @xmath75 of pp - formul in @xmath76 .",
    "2 .   if @xmath158 , then @xmath18 satisfies @xmath159 , for some finite set @xmath75 of pp - formul in @xmath76 .",
    "3 .   in all other cases , the satisfiability problem @xmath160-@xmath149 and the separation problem @xmath152 are solvable in polynomial - time , for any finite set @xmath75 of pp - formul in @xmath76 .    shaded vertices in figure  [ clo : dualpost ] give the precise information for the gap trichotomy theorem : constraint languages falling under the first item are coloured blue / dark grey in figure [ clo : dualpost ] .",
    "those falling under the second item are green / light grey .",
    "we now list four _ dichotomy _ theorems that are immediate consequences of the gap trichotomy theorem .",
    "the dichotomy theorem for @xmath96 is a known result of creignou and hbrard  ( * ? ? ?",
    "* proposition @xmath161 ) .",
    "let @xmath18 be a constraint language on @xmath135 .    * if @xmath162 then @xmath160-@xmath149 is @xmath1-complete , for some finite set @xmath75 of pp - formul in @xmath76 . * otherwise , @xmath160-@xmath149 is solvable in polynomial - time , for all finite sets @xmath75 of pp - formul in @xmath76 .",
    "let @xmath18 be a constraint language on @xmath135 .    * if @xmath162 then @xmath152 is @xmath1-complete . * otherwise , @xmath152 is solvable in polynomial - time .",
    "* dichotomy theorem for @xmath163 ) let @xmath18 be a constraint language on @xmath135 .    * if @xmath162 then @xmath146 is @xmath1-complete . * otherwise , @xmath146 is solvable in polynomial - time .    in the following it useful to recall that a finite relational structure ( template ) is a core if all of its unary polymorphisms are bijective .",
    "we observe that the intractability cases of schaefer s dichotomy theorem are recovered from theorem  [ thm : maingap ] in the case of core templates ( boolean csps over non - core templates are trivial ) . indeed ,",
    "when @xmath164 is a core template and @xmath162 , we have @xmath156 or @xmath155 . by theorem  [ thm : maingap ]",
    ", it follows that @xmath18 has gap property @xmath165 , for some finite set @xmath75 of pp - formal in the language of @xmath18 . as @xmath166 and is disjoint from @xmath167",
    ", it follows that @xmath144 is @xmath101-complete .",
    "let @xmath18 be a constraint language on @xmath135 such that @xmath164 is a core template .    * if @xmath162 then @xmath144 is @xmath1-complete . * otherwise , @xmath144 is solvable in polynomial - time .",
    "we now give more technical definitions that are required for the main arguments .    for @xmath105 , we define a _ partial operation _ of arity @xmath21 on @xmath20 to be a map @xmath168 , where @xmath169 and define @xmath170 to be the set of all non - empty , non - nullary finitary partial operations on  @xmath20 .",
    "let @xmath107 , let @xmath168 be a @xmath21-ary partial operation and let @xmath109 be a @xmath7-ary relation on the set @xmath20 .",
    "we say that @xmath85 _ preserves _ @xmath109 or @xmath109 is _ invariant under _ @xmath85 or @xmath85 is a _ partial polymorphism _ of @xmath109 , if whenever @xmath110 are tuples in @xmath171 , then the implication of definition  [ defn : poly ] holds . if @xmath113 is set of partial operations then we say that @xmath109 is invariant under @xmath113 if @xmath109 is invariant under every operation in @xmath113 .",
    "let @xmath172 , let @xmath173 be @xmath174-ary and let @xmath175 be @xmath21-ary .",
    "the _ composition _",
    "@xmath176 is an @xmath21-ary partial operation defined by @xmath177 where @xmath178 is the set @xmath179    let @xmath180 .",
    "we say that @xmath85 is a _ restriction _ of @xmath181 or that @xmath85 _ extends _ to  @xmath181 if @xmath182 and @xmath85 agrees with @xmath181 on @xmath171 .",
    "let @xmath20 be a non - empty set and let @xmath183 .",
    "then @xmath39 is a _ strong partial clone _ if the following three conditions hold :    1 .",
    "@xmath30 contains all total projection operations ; 2 .",
    "@xmath30 is closed under composition with non - empty domain ; 3 .",
    "@xmath30 is closed under arbitrary restriction of partial operations .    for a set @xmath113 of partial operations",
    ", we can define @xmath119_p$ ] to be the smallest strong partial clone containing @xmath113 and we call @xmath119_p$ ] the _ strong partial clone generated _ by @xmath113 . the set @xmath113 is sometimes called a _ base _ for the strong partial clone @xmath119_p$ ] .",
    "let @xmath20 be a non - empty set .",
    "a subset @xmath47 of @xmath184 is called a _ weak co - clone _ or _ weak system _ if it is closed under the formation of conjunct - atomic definable relations .",
    "we can define @xmath185 to be the smallest weak co - clone containing @xmath47 and we refer to @xmath185 as the _ weak co - clone generated by _ @xmath47 .",
    "the set @xmath47 is sometimes called a _ base _ for the weak system @xmath185 .    a subset @xmath47 of @xmath184 is called an _ equality - free weak co - clone _ or an _ equality - free weak system",
    "_ if it is closed under the formation of equality - free conjunct - atomic definable relations .",
    "we define @xmath186 to be the smallest equality - free weak co - clone containing @xmath47 and we refer to @xmath186 as the _ equality - free weak co - clone generated by _ @xmath47 . the set @xmath47 is sometimes called a _ base _ for the equality - free weak system @xmath187 .    if we weaken the operators @xmath188 and @xmath189 , introduced in section  [ sec : back ] ,",
    "to allow partial operations to be included in the definition , we obtain a refined galois connection between the complete lattices @xmath190 and @xmath123 . the galois connection is finer in the sense that sets of relations are further separated on the basis of their expressibility power .",
    "the next theorem was first observed by romov  @xcite .",
    "it can also be obtained as a special case of a galois connection given in davey , pitkethly , and willard  ( * ? ? ?",
    "* section  @xmath191 ) .",
    "[ thm : strgweak ] let @xmath20 be a non - empty set .",
    "the following pair of maps @xmath192 and @xmath193 form a galois connection between the complete lattices @xmath190 and @xmath123 .",
    "@xmath194 for each @xmath195 and @xmath129 .    in a similar way that the galois connection between operations and relations on a non - empty set @xmath20 is connected to clones and co - clones , the galois connection between partial operations and relations is closely related to strong partial clones and weak co - clones .",
    "in particular , sets of the form @xmath196 are precisely the weak co - clones and sets of the form @xmath197 are precisely the strong partial clones , for @xmath198 and @xmath199",
    ". there are analogous consequences to those listed in section  [ sec : back ] , given for clones and co - clones .",
    "the lattice of strong partial clones on @xmath135 is complicated ; it is uncountable and a complete classification appears difficult , see schlzel  @xcite for example .",
    "nevertheless , post s lattice provides a useful approximation to lattice of strong partial clones in the boolean setting : for each boolean clone @xmath39 , is it known that the set of all strong partial clones whose total operations agree with @xmath39 forms an interval , and there are known generators for the top and bottom elements in each of these intervals .    in @xcite ,",
    "schnoor and schnoor give a characterisation of the largest strong partial clone corresponding to a clone  @xmath39 , and use this characterisation to give a canonical construction for finding a base for the smallest element of the associated interval in the weak co - clone lattice , see ( * ? ? ?",
    "* theorem  @xmath200 ) or ( * ? ? ?",
    "* theorem  @xmath201 ) .",
    "such bases are referred to as _ weak bases _ , and from a complexity perspective , are crucial for establishing hardness results . on the other hand , generators for the largest elements of these intervals , referred to as _",
    "plain bases _ , are in general key to proving tractability results ; however an alternative approach is taken in this article .",
    "we mention only for completeness that plain bases for all boolean co - clones can be found in creignou , kolaitis and zanuttini  ( * ? ? ?",
    "* table  @xmath202 ) .",
    "[ defn : weakbase ] let @xmath20 be a non - empty set , let @xmath39 be a clone on @xmath20 and let @xmath18 be a set of finitary relations on @xmath20 .",
    "we call @xmath18 a _ weak base _ for the co - clone @xmath134 if @xmath203 , where @xmath204 is the largest strong partial clone corresponding to @xmath39",
    ".    we will often present relations in a matrix form .",
    "the representation is not unique , but it is succinct .    let @xmath205 be a @xmath7-ary relation on a non - empty set @xmath20 with @xmath206 .",
    "we define the matrix representation of @xmath109 to be the @xmath207 matrix @xmath208 over @xmath20 with rows equal to the constraints of @xmath109 .",
    "[ defn : cols3 ] define @xmath209 to be the @xmath210-ary relation over @xmath135 : @xmath211    let @xmath39 be clone on a non - empty set @xmath20 and let @xmath109 be a relation on  @xmath20",
    ". define @xmath212 to be the smallest relation containing @xmath109 that is invariant under every operation in @xmath39 : @xmath213 following @xcite , we refer to @xmath212 as the @xmath39-closure of the relation @xmath109 and we say that @xmath109 is a @xmath39-core of @xmath214 .    using the work of schnoor and schnoor  @xcite and schnoor (",
    "* table 3.1 ) , the following construction gives weak - bases for each of the boolean co - clones shaded in figure  [ clo : dualpost ] .",
    "( ( * ? ? ?",
    "* theorem 4.11 ) , ( * ? ? ?",
    "* table 3.1))[pro : weakbase ] let @xmath215 be any of the boolean co - clones listed in the table within figure  [ clo : dualpost ] .",
    "then @xmath216 is a weak - base for @xmath215 .",
    "[ eg : bigweirdosat ] to construct a weak base for the boolean co - clone @xmath217 , we simply close the relation @xmath209 under @xmath139 .",
    "thus , @xmath218    schnoor and schnoor  @xcite observe that often the more restricted closure operator @xmath219 fits more naturally to problems than the operator @xmath220 .",
    "this fact appears to be true of the computational problems considered in the present article .",
    "the following irredundancy condition ensures conjunct - atomic definability without equality .",
    "* definition 5.1)[defn : irrednt ] let @xmath109 be a @xmath7-ary relation on a non - empty set @xmath20 .",
    "we say that the relation @xmath109 is _ @xmath221-redundant _ if there exist a pair of equal columns in the matrix representation of @xmath109 , and we say that @xmath109 is _ @xmath222-redundant _ if there is a relation @xmath223 of arity @xmath224 such that the columns of @xmath109 are exactly the columns of @xmath225 .",
    "a relation @xmath109 is _ irredundant _ if it is neither @xmath221-redundant nor @xmath222-redundant .",
    "a set @xmath18 of finitary relations on @xmath20 is _ irredundant _ if every relation @xmath109 belonging to @xmath18 is irredundant .",
    "all six of the relations in proposition [ pro : weakbase ] are easily seen to be irredundant .",
    "weak bases that generate not only the smallest weak - system , but also the smallest equality - free weak - system of relations generating the same co - clone , will be critical in establishing the main proofs to come .",
    "* corollary  @xmath226)[thm : eqfreeweak ] let @xmath20 be a non - empty set , let @xmath39 be a clone on @xmath20 and let @xmath18 be an irredundant weak base for the co - clone @xmath134 . if @xmath227 is set of relations on @xmath20 such that @xmath228 , then @xmath229 .",
    "we now establish gap properties for relations generating the boolean co - clones @xmath230 , @xmath231 , @xmath232 , @xmath233 , @xmath234 or @xmath235 ; recall exact definitions given in figure [ clo : dualpost ] .",
    "each co - clone must be considered separately , however the proofs follow the same structure : we first establish a gap property for the irredundant weak - base and then use the fact that gap properties are preserved by the @xmath236 operator .",
    "we begin with three results that are crucial for establishing gap properties .",
    "the first theorem is an abridged version of ( * ? ? ?",
    "* theorem  @xmath237 ) , and reveals that positive @xmath15-in-@xmath16 @xmath2 has the gap property @xmath238 , where @xmath239 is a particular subset of @xmath240 ; see theorem  [ thm:1in3gap ] below for the precise definition of @xmath241 . recall that @xmath242 denotes the positive @xmath15-in-@xmath16 @xmath2 template @xmath243 .",
    "@xcite[thm:1in3gap ] let @xmath239 be the set consisting of all positive @xmath15-in-@xmath16 @xmath2 instances @xmath35 with the following properties :    * no variable appears more than once in each constraint tuple of @xmath35 , * @xmath35 is @xmath202-robustly positive @xmath15-in-@xmath16 satisfiable .",
    "any set of positive @xmath15-in-@xmath16 @xmath2 instances containing @xmath239 and contained within the members of @xmath244 has @xmath1-hard membership with respect to polynomial - time karp reductions .",
    "the next lemma summarises the basic method employed in abramsky , gottlob and kolaitis  @xcite and jackson  @xcite .",
    "it is essentially the definition of reduction for promise problems ; see ( * ? ? ?",
    "* definition  @xmath16 ) , for example .",
    "[ lem : gap ] let @xmath18 and @xmath227 be finite sets of relations on @xmath135 .",
    "let @xmath20 and @xmath245 be disjoint sets of @xmath18-instances and let @xmath241 and @xmath246 be disjoint sets of @xmath247-instances .",
    "further , let @xmath18 have the gap property @xmath248 .",
    "if there is a polynomial - time computable function @xmath249 satisfying :    1 .",
    "@xmath250 , 2 .",
    "@xmath251 ,    then @xmath227 has the gap property @xmath252 . in particular",
    ", @xmath227 has the gap property @xmath253    it is well known that the complexity of @xmath144 depends only on the co - clone generated by @xmath18 , see ( * ? ? ?",
    "* theorem  @xmath254 ) or alternatively ( * ? ? ?",
    "* theorem 2.16 ) for a proof explicitly using pp - formul .",
    "we give an analogous result relating equality - free conjunct atomic definitions to reductions for @xmath3 and @xmath255-robust satisfiability .",
    "this result is stated below as theorem  [ thm : krobustred ] and will be crucial for establishing hardness results in this section .",
    "we first introduce a lemma that will help streamline the proof .",
    "[ lem : caequivsolns ] let @xmath27 be a constraint language over a finite set @xmath20 and let @xmath256 be a finite set of relations in @xmath257 .",
    "there is a polynomial - time construction that transforms any instance @xmath28 of @xmath258 into an instance @xmath259 of @xmath260 , and moreover , the solutions of @xmath35 are exactly the solutions of @xmath259 .",
    "the following construction is borrowed from ( * ? ? ?",
    "* theorem 2.16 ) . given an instance @xmath28 of @xmath261 ,",
    "construct an instance @xmath262 of @xmath263 in the following way .",
    "for each constraint @xmath264 with @xmath23 representable by the equality - free conjunct - atomic formula : @xmath265 where @xmath266 , and @xmath267 , we add the constraints @xmath268 to @xmath39 , and remove @xmath269 from @xmath39 . since @xmath270 is true in @xmath26 if and only if @xmath271 , for @xmath272 and @xmath273 , it follows that the solutions of @xmath35 are precisely the solutions of @xmath259 .",
    "[ thm : krobustred ]",
    "let @xmath27 be a constraint language over a set @xmath20 , let @xmath256 be any finite set of relations in @xmath257 , let @xmath75 be a finite set of pp - formul in the language of @xmath47 and let @xmath274 .",
    "there is a polynomial - time computable function that reduces    1 .",
    "@xmath258 to @xmath260 , 2 .",
    "@xmath275 to @xmath276 , and 3 .",
    "@xmath8-@xmath277 to @xmath278-@xmath279 , for some finite set @xmath280 of pp - formul in the language of @xmath18 .",
    "we transform an @xmath47-instance @xmath28 into a @xmath18-instance @xmath262 according to the construction given in the proof of lemma  [ lem : caequivsolns ] .",
    "the reduction from @xmath258 to @xmath260 is then obtained immediately from lemma  [ lem : caequivsolns ] .",
    "this proves  ( @xmath15 ) .",
    "we now prove ( @xmath202 ) .",
    "since the solutions of @xmath281 in @xmath258 are precisely the solutions of @xmath259 in @xmath260 , it follows that separating solutions of @xmath35 are exactly the separating solutions of @xmath259 .",
    "hence @xmath35 is a yes instance of @xmath275 if and only if @xmath259 is a yes instance of @xmath276 .    for ( @xmath16 ) , consider @xmath52 of arity @xmath282 and abstractly expressible by an equality - free conjunct - atomic formula @xmath283 in the language of @xmath18 . for each pp - formula @xmath284",
    ", we construct a pp - formula @xmath285 in the language of @xmath18 in the following way : replace every occurrence of an @xmath282-ary relation symbol @xmath109 in @xmath65 with its conjunct - atomic defining formula @xmath283 .",
    "let @xmath286 .",
    "then since @xmath287 is true in @xmath288 if and only if @xmath289 is true in @xmath290 for @xmath291 and @xmath284 , it follows that the @xmath75-compatible assignments on @xmath7 variables of @xmath35 are exactly the @xmath280-compatible assignments on @xmath7 variables of @xmath259 .",
    "thus , since the solutions of @xmath35 are precisely the solutions of @xmath259 , by lemma   [ lem : caequivsolns ] , it then follows that @xmath35 is a yes instance of @xmath8-@xmath277 if and only if @xmath259 is a yes instance of @xmath278-@xmath279 .",
    "theorem  [ thm : krobustred ] holds more generally : with some caveats and proper amendment to the proof , the assumption that @xmath292 can be weakened to @xmath293 .",
    "however , this result is not required for establishing our main theorems .",
    "we refer the reader to section  [ sec : algebra ] for a proof .    for the purpose of easy reference",
    ", we extract the following consequence of theorem  [ thm : krobustred ] .",
    "[ cor : gapred ] let @xmath18 be a set of relations on @xmath135 , let @xmath47 be a finite set of relations in @xmath294 and let @xmath75 be a finite set of pp - formul in the language of  @xmath47 .",
    "there is a polynomial - time computable function taking    * @xmath295 to @xmath143 , and * @xmath296 to @xmath297 , for some finite set @xmath280 of pp - formul in @xmath18 .",
    "the first two subsections cover the co - clones @xmath298 and @xmath299 corresponding to statement @xmath15 of the gap trichotomy theorem .",
    "recall the relation @xmath300 given in definition  [ defn : cols3 ] . by proposition  [ pro : weakbase ] ,",
    "the relation @xmath301 , is a weak base for @xmath298 .",
    "we will use @xmath302 to denote the template @xmath303 and @xmath304 as notation for the constraint problem @xmath305 . in the following ,",
    "it is useful to remember that the positive @xmath15-in-@xmath16 @xmath2 relation has gap property @xmath238 , where @xmath239 satisfies the properties given in theorem  [ thm:1in3gap ] .",
    "[ pro : weirdogap ] the relation @xmath306 satisfies @xmath307 .",
    "we begin by showing there is a polynomial - time karp reduction from @xmath308 to @xmath304 .",
    "we then show that this reduction takes instances with the properties given in theorem  [ thm:1in3gap ] to instances in @xmath309 .",
    "the result will then follow from theorem  [ thm:1in3gap ] and lemma  [ lem : gap ] .    we motivate the following construction by observing that columns @xmath310 , @xmath311 and @xmath312 of @xmath306 are the negations of columns @xmath15 , @xmath202 and @xmath16 , respectively ; refer to defintion  [ defn : cols3 ] .",
    "given an instance @xmath313 of positive @xmath15-in-@xmath16 @xmath2 , we construct an instance @xmath314 of @xmath304 in the following way .    1",
    ".   first let @xmath315 be a disjoint copy of @xmath29 , and then construct @xmath316 , where @xmath317 , 2 .",
    "for each constraint @xmath318 in @xmath39 , we add the constraint @xmath319 to @xmath30 and remove @xmath318 .",
    "any solution @xmath320 of @xmath35 in @xmath308 can be extended to a solution @xmath321 of @xmath322 in the following way . for each @xmath323 , define @xmath324 , @xmath325 , @xmath326 and @xmath327 , where @xmath139 is the usual boolean complement . for the converse direction , observe that the projection @xmath328 , thus if @xmath329 is a solution of @xmath322 in @xmath304 , then the restriction @xmath330 is a solution of @xmath35 in @xmath308 .",
    "hence we have shown that any solution @xmath331 of @xmath35 extends uniquely to a solution @xmath332 of @xmath322 .",
    "now assume that @xmath35 has the properties listed in theorem  [ thm:1in3gap ] .",
    "since @xmath35 is @xmath202-robustly satisfiable and no variable appears more than once in each constraint tuple , it follows that @xmath35 has the following properties .    1 .   for every pair of distinct variables @xmath333 and @xmath334 in @xmath29",
    ", there are solutions @xmath335 , @xmath336 and @xmath337 of @xmath35 satisfying @xmath338 2 .",
    "if @xmath333 and @xmath334 do not appear in a common constraint tuple , then there is a solution @xmath339 of @xmath35 satisfying @xmath340 .",
    "we first show that @xmath341 .",
    "let @xmath342 be a pair of distinct variables in @xmath343 and let @xmath344 be an assignment that is locally compatible for @xmath322 .",
    "there are four cases to consider .",
    "_ case @xmath15_. assume that @xmath345 .",
    "_ subcase _",
    "@xmath15(a ) : if @xmath4 and @xmath5 appear in a common constraint tuple , then there are three locally compatible assignments to check : @xmath346 satisfying @xmath347 from ( @xmath348 ) , there is a solution of @xmath35 extending each of these assignments , namely @xmath335 , @xmath336 and @xmath337 , respectively .",
    "using the fact that every solution of @xmath35 extends to a solution of @xmath322 , we get solutions @xmath349 , @xmath350 and @xmath351 of @xmath322 which extend in the required ways .",
    "_ subcase _",
    "@xmath15(b ) : if @xmath4 and @xmath5 do not appear in a common constraint tuple , then every possible assignment for @xmath352 is locally compatible . now apply ( @xmath348 ) and ( @xmath353 ) and the fact that every solution @xmath35 extends to a solution of @xmath322 , to get solutions of @xmath322 for every possible assignment .    _ case _",
    "assume that @xmath354 and @xmath355 .",
    "we will consider cases only up to symmetry .",
    "_ subcase _",
    "@xmath202(a ) : if @xmath356 . in this case there two locally compatible assignments for @xmath352 : @xmath357 or @xmath358 . consider first @xmath346 satisfying @xmath357 . using ( @xmath348 ) , there is a solution @xmath336 of @xmath35 extending this assignment .",
    "since @xmath336 satisfies @xmath359 , it follows that @xmath360 and @xmath361 .",
    "hence @xmath350 is a solution of @xmath322 extending this assignment .",
    "the case for @xmath358 is similar .",
    "_ subcase _",
    "@xmath202(b ) : if @xmath362 , for some @xmath363 with @xmath364 , then there are two subcases to check .",
    "@xmath202(b)(i ) : if @xmath4 and @xmath365 ( and hence @xmath5 ) appear in a common constraint tuple .",
    "there are three locally compatible assignments for @xmath352 to check in this case : @xmath346 satisfying @xmath366 consider first @xmath357 . from ( @xmath348 ) , there is a solution @xmath335 of @xmath35 satisfying @xmath367 .",
    "it then follows that @xmath368 and @xmath369 .",
    "hence we have found a solution of @xmath322 extending this assignment .",
    "now consider @xmath370 .",
    "there is a solution @xmath337 of @xmath35 satisfying @xmath371 , guaranteed by ( @xmath348 ) .",
    "it follows that @xmath372 and @xmath373 . in the case where @xmath346 satisfies @xmath374 , the solution @xmath350 gives the required extension .",
    "@xmath202(b)(ii ) : if @xmath4 and @xmath5 do not appear in a common constraint tuple , then every possible assignment for @xmath352 is locally compatible . for the assignments @xmath357 , @xmath370 and @xmath374 , we apply subcase  @xmath202(b)(i ) .",
    "it remains to show there is a solution extending @xmath358 . from ( @xmath353 ) , there is a solution @xmath339 of @xmath35 satisfying @xmath375 .",
    "it follows that @xmath376 and @xmath377 .",
    "_ case _  @xmath16 .",
    "assume that @xmath378 .",
    "then @xmath379 for some @xmath380 and @xmath362 , for some @xmath363 .",
    "apply case @xmath15 to the pair @xmath381 .",
    "@xmath310 : if @xmath382 then there are three subcases to consider .",
    "_ subcase _",
    "@xmath310(a ) : if @xmath383 , then up to symmetry the only locally compatible assignment is @xmath384 .",
    "a solution of @xmath322 extending this assignment is obtained from any solution of @xmath35 .",
    "_ subcase _",
    "@xmath310(b ) : if @xmath354 , then up to symmetry in the second coordinate there are two locally compatible assignments to consider : @xmath346 satisfying @xmath385 or @xmath386 . for the assignment @xmath385 , use any solution @xmath320 of @xmath35 satisfying @xmath387 guaranteed by @xmath388 ; since the extension @xmath321 of any solution of @xmath35 satisfies @xmath326 . for @xmath386 use any solution @xmath320 of @xmath35 satisfying @xmath387 guaranteed by @xmath388 .    _",
    "subcase _",
    "@xmath310(b ) : if @xmath389 , for some @xmath363 . in this case",
    ", we apply subcase  @xmath310(b ) to the pair @xmath390 .    to show @xmath391 observe that cases @xmath15 and @xmath202 above show that for any pair of distinct variables @xmath342 in @xmath343 , there is a solution of @xmath322 in @xmath305 separating @xmath4 and @xmath5 .",
    "[ rem : bottop ] it is immediate from the proof that there is no loss of generality if the following extra condition is included in proposition [ pro : weirdogap ] as an allowed assumption on instances : there are variables @xmath392 and @xmath222 , such that in every constraint tuple , the final two coordinates are @xmath392 and @xmath222 , in that order .",
    "the next result follows immediately from proposition [ pro : weirdogap ] .",
    "[ cor : npweirdosat ] the following problems are @xmath1-complete .    * the @xmath202-robust satisfiability problem @xmath202-@xmath393 . * the separation problem @xmath394 .",
    "we are now ready to give the main result for this subsection .",
    "[ thm : gapii2 ] let @xmath18 be a constraint language on @xmath135 such that @xmath155",
    ". then @xmath18 has the gap property @xmath395 , for some finite set @xmath280 of pp - formul in the language of @xmath18 , and consequently both @xmath396-@xmath149 and @xmath152 are @xmath101-complete .    since @xmath306 is an irredundant weak - base for the co - clone @xmath298 , by theorem  [ thm : eqfreeweak ] we have @xmath397 . from proposition",
    "[ pro : weirdogap ] , we have @xmath306 satisfies @xmath307 . now applying corollary  [ cor : gapred ] , it follows from lemma  [ lem : gap ] , that @xmath18 has the gap property @xmath398 , for some finite set @xmath280 of pp - formul in the language of @xmath18 , and consequently @xmath396-@xmath149 and @xmath152 are @xmath101-complete .",
    "recall that the relation @xmath399 constructed in example  [ eg : bigweirdosat ] is a weak base for @xmath231 .",
    "we will use @xmath400 to denote the corresponding template @xmath401 and @xmath231-@xmath2 as notation for the constraint problem @xmath402 .",
    "[ pro : bigwgap ] the relation @xmath399 satisfies @xmath307 .",
    "we show there is polynomial - time karp reduction from positive @xmath15-in-@xmath16 @xmath2 to @xmath231-@xmath2 that takes instances satisfying the properties listed in theorem  [ thm:1in3gap ] to instances in @xmath403 .",
    "the result then follows from theorem  [ thm:1in3gap ] and lemma  [ lem : gap ] .",
    "given an instance @xmath313 of positive @xmath15-in-@xmath16 @xmath2 , we construct an instance @xmath404 of @xmath231-@xmath2 in the following way :    1 .   for each variable @xmath323",
    ", we add the variable @xmath405 to @xmath29 ( each of the variables @xmath405 is a new variable not in @xmath29 ) , 2 .",
    "add the new variables @xmath222 and @xmath392 to @xmath29 , 3 .",
    "for each constraint @xmath318 in @xmath39 , we add the constraints @xmath406 to @xmath30 and remove @xmath318 from @xmath39 .",
    "any solution @xmath320 of @xmath35 in @xmath308 can be extended to a solution @xmath407 of @xmath408 in @xmath304 in the same way as in proposition  [ pro : weirdogap ] : for all @xmath323 , define @xmath409 , @xmath410 , @xmath411 and @xmath412 . for the converse direction",
    ", we will show that for any solution @xmath407 of @xmath408 , either @xmath407 or @xmath413 can be restricted to a solution of @xmath35 . since the map @xmath414 is an automorphism of @xmath400 , it follows that @xmath415 is solution of @xmath408 , whenever @xmath407 is a solution of @xmath408 .",
    "thus , without loss of generality we may assume that @xmath416 .",
    "this implies that @xmath417 satisfies constraints of the form @xmath418 into the subset @xmath306 of @xmath399 ( that is , the first three rows of @xmath399 ) .",
    "then @xmath419 is a solution of @xmath35 for positive @xmath15-in-@xmath16 @xmath2 .",
    "now assume that @xmath35 has the properties given in theorem  [ thm:1in3gap ] .",
    "we show that @xmath420 by showing that every locally compatible assignment on two variables extends to a solution of @xmath408 .",
    "recall the instance @xmath421 constructed in proposition  [ pro : weirdogap ] .",
    "the following fact will be useful .",
    "1 .   for every solution @xmath321 of @xmath322 in @xmath422 , both @xmath321 and @xmath423 is a solution of @xmath408 in @xmath422 .",
    "let @xmath352 be distinct variables in @xmath29 and let @xmath344 be an assignment that is locally compatible for @xmath408 .",
    "there are two cases to consider .",
    "if @xmath346 is locally compatible assignment for @xmath322 , then use the fact that @xmath322 is in @xmath424 to extend @xmath346 to a solution @xmath425 of @xmath322 , which is also a solution of @xmath408 by ( @xmath426 ) .    _",
    "if @xmath346 is not locally compatible for @xmath322 then is it straightforward to check that @xmath427 is a locally compatible for @xmath428 .",
    "we then use the fact that @xmath322 is in @xmath424 to extend @xmath429 to a solution @xmath332 of @xmath322 .",
    "then @xmath430 is a solution of @xmath408 by ( @xmath426 ) and extends  @xmath346 .",
    "it remains to show @xmath431 .",
    "let @xmath342 be any pair of distinct variables in @xmath432 . then @xmath433 .",
    "since @xmath391 , there is a solution @xmath321 of @xmath322 separating @xmath4 and @xmath5 .",
    "then @xmath321 is a solution of @xmath408 that separates @xmath4 and @xmath5 , by  @xmath434 .",
    "[ rem : bottop2 ] as with remark [ rem : bottop ] , we may additionally add the following technical assumption to proposition [ pro : bigwgap ] : there are two variables @xmath392 and @xmath222 and every constraint tuple has its final two coordinates equal to either @xmath392,@xmath222 or @xmath222,@xmath392 .",
    "the next result immediately follows from proposition [ pro : bigwgap ] .",
    "[ cor : npbigwsat ] the following problems are @xmath1-complete .    * the @xmath202-robust satisfiability problem @xmath202-@xmath435 . * the separation problem @xmath436 .",
    "we state the main result for this subsection .",
    "[ thm : gapin2 ] let @xmath18 be a constraint language on @xmath135 such that @xmath156 . then @xmath18 has the gap property @xmath437 , for some finite set @xmath280 of pp - formul in the language of @xmath18 , and consequently the problems @xmath438 and @xmath152 are @xmath101-complete .    it is easily verified that the weak base @xmath399 is irredundant . by theorem",
    "[ thm : eqfreeweak ] , it follows that @xmath439 . from proposition",
    "[ pro : bigwgap ] , we have @xmath399 satisfies @xmath307 . applying corollary  [ cor : gapred ] , it follows from lemma  [ lem : gap ] , that @xmath18 has the gap property @xmath395 , for some finite set @xmath280 of pp - formul in the language of @xmath18 , and consequently @xmath396-@xmath149 and @xmath152 are @xmath101-complete .    for the remaining clones @xmath440 corresponding to statement 2 in the gap dichotomy theorem  [ thm : maingap ]",
    ", we can reuse the same fundamental construction used for @xmath230 and @xmath231 . in all cases",
    ", the proof proceeds as follows : to lie in @xmath441 or @xmath442 , it is necessary to have an assignment in which @xmath392 and @xmath222 take different values .",
    "we then argue that this forces solutions into @xmath230 or @xmath231 .      from proposition  [ pro : weakbase ]",
    ", the relation @xmath443 is a weak base for the co - clone @xmath233 : @xmath444 we will use @xmath445 to denote the template @xmath446 and @xmath447 to denote @xmath448 .",
    "observe that the constraint satisfaction problem @xmath447 is trivial : every instance @xmath35 has a solution ; specifically , the map that sends every variable of @xmath35 to @xmath15 . recall that @xmath449 is the set of all instances of @xmath447 that admit only a trivial solution .",
    "note that instances in @xmath449 are precisely the instances of @xmath447 with at most one solution .",
    "we establish the following gap property for @xmath443 .",
    "[ pro : gapwsat1 ] the relation @xmath443 satisfies @xmath450 .",
    "we show there is a polynomial - time reduction taking no instances of the problem @xmath304 to instances in @xmath451 and @xmath452 to @xmath453 .",
    "the final result will then follow from proposition  [ pro : weirdogap ] and lemma  [ lem : gap ] .",
    "given an instance @xmath35 of @xmath304 , construct an instance @xmath454 of @xmath447 by replacing each constraint @xmath455 in @xmath39 with @xmath456 . clearly",
    "every solution of @xmath35 is a solution of @xmath454 . by remark [ rem : bottop ]",
    ", we will also assume that there are a variables @xmath392 and @xmath222 such that every constraint tuple has @xmath392,@xmath222 in the final two positions .",
    "now assume that @xmath457 .",
    "we first show that @xmath454 is in @xmath458 .",
    "let @xmath352 be a pair of distinct elements in @xmath29 and consider an assignment @xmath459 that is locally compatible for @xmath454 .",
    "if @xmath346 is locally compatible for @xmath35 , then we can use the fact that @xmath35 is in @xmath424 to extend @xmath346 to a solution of @xmath35 , which is also a solution of @xmath454 .    _ case _",
    "@xmath202 : if @xmath346 is not locally compatible for @xmath35 , then @xmath346 satisfies @xmath460 and in this case , we can extend @xmath346 to a solution of @xmath454 by mapping every variable in @xmath461 to @xmath15 .    to see that @xmath462 , observe that solutions for @xmath35 also are solutions for @xmath454 , and",
    "the assumption @xmath463 shows that there are enough solutions to separate all pairs of variables .",
    "we now show that if @xmath35 is a no instance of @xmath304 then @xmath454 has only a trivial solution .",
    "we prove the contrapositive .",
    "suppose @xmath454 has a non - trivial solution @xmath329 in @xmath447 .",
    "hence @xmath464 .",
    "then @xmath329 is also a solution of @xmath35 in @xmath304 . hence @xmath35 is not a no instance of @xmath304 .",
    "the following problems are @xmath1-complete .    * the @xmath202-robust satisfiability problem @xmath202-@xmath465 * the separation problem @xmath466 .",
    "we establish a gap theorem for any set of relations generating @xmath233 .",
    "[ thm : gapii1 ] let @xmath18 be a constraint language on @xmath135 such that @xmath467",
    ". then @xmath18 has the gap property @xmath468 , for some finite set @xmath280 of pp - formul in the language of @xmath18 , and consequently the problems @xmath438 and @xmath152 are @xmath101-complete .    the relation @xmath469 is easily seen to be an irredundant weak base for the co - clone @xmath233 .",
    "thus , from theorem  [ thm : eqfreeweak ] , we have @xmath470 , and from proposition  [ pro : gapwsat1 ] , we have @xmath469 satisfies @xmath471 . the reduction given in theorem  [ thm : krobustred ]",
    "preserves not only the instances in @xmath472 ( subject to a change in @xmath75 ) , but also solutions of instances and hence it preserves instances in @xmath473 . by lemma  [ lem : gap ]",
    ", it then follows that @xmath18 satisfies @xmath474 , and so @xmath438 and @xmath152 are @xmath101-complete .",
    "since the co - clone @xmath232 is dual to @xmath233 , we obtain the following results via a symmetrical argument .    in the following ,",
    "let @xmath475 be the template @xmath476 .",
    "the following problems are @xmath1-complete .    * the @xmath202-robust satisfiability problem @xmath202-@xmath477 * the separation problem @xmath478 .",
    "[ thm : gapii0 ] let @xmath18 be a constraint language on @xmath135 such that @xmath479",
    ". then @xmath18 has the gap property @xmath474 , for some finite set @xmath280 of pp - formul in the language of @xmath18 , and consequently the problems @xmath438 and @xmath152 are @xmath101-complete .      by proposition  [ pro : weakbase ]",
    ", the following relation is a weak base for the co - clone @xmath234 .",
    "@xmath480 we will use @xmath481 to denote the template @xmath482 and @xmath483 to denote the constraint problem @xmath484 .",
    "we remark that instances in @xmath485 are exactly the instances of @xmath483 with at most two solutions .",
    "[ pro : gapwsat01 ] the relation @xmath486 satisfies @xmath487 .",
    "we show there is a polynomial - time reduction taking @xmath488 to @xmath485 and taking instances in @xmath489 to instances in @xmath490 .",
    "the final result is then obtained from proposition  [ pro : weirdogap ] and lemma  [ lem : gap ] .",
    "given an instance @xmath35 of @xmath304 , construct an instance @xmath491 of @xmath483 by replacing each constraint @xmath492 in @xmath39 with @xmath493 . clearly",
    "every solution of @xmath35 is a solution of @xmath491 .",
    "we again call on remark [ rem : bottop ] to assume that @xmath392 and @xmath222 record the final two positions of every constraint tuple .",
    "assume that @xmath35 is in @xmath489 .",
    "we first show that @xmath491 is in @xmath494 .",
    "let @xmath352 be a pair of distinct elements in @xmath29 and let @xmath459 be an assignment that is locally compatible for @xmath491 .",
    "@xmath15 : if @xmath346 is locally compatible for @xmath35 , then we can use the fact that @xmath495 to extend @xmath346 to a solution of @xmath35 , which is also a solution of @xmath491 .    _",
    "@xmath202 : if @xmath346 is not locally compatible for @xmath35 , then @xmath346 satisfies @xmath385 or @xmath460 . in the first case , we can extend @xmath346 to a solution of @xmath491 by mapping every variable in @xmath496 to @xmath138 , and in the second case we extend @xmath346 by mapping every variable in @xmath496 to @xmath15 .",
    "now @xmath497 follows immediately from the fact that @xmath35 is in @xmath498 .",
    "since every non - trivial solution of @xmath491 in @xmath483 separates @xmath392 from @xmath222 , it follows that a nontrivial solution of @xmath491 in @xmath483 is also a solution of @xmath35 in @xmath304 . in the contrapositive : if @xmath35 is a no instance of @xmath304 , then @xmath499 has only trivial solutions .",
    "[ cor : wsat01np ] the following problems are @xmath1-complete .    * the @xmath202-robust satisfiability problem @xmath202-@xmath500 . * the separation problem @xmath501 .",
    "[ thm : gapii ] let @xmath18 be a constraint language on @xmath135 such that @xmath502",
    ". then @xmath18 has the gap property @xmath468 , for some finite set @xmath280 of pp - formul in the language of @xmath18 , and consequently the problems @xmath438 and @xmath152 are @xmath101-complete .",
    "since @xmath503 is an irredundant weak base for @xmath234 , from theorem  [ thm : eqfreeweak ] , we have @xmath504 , and from proposition  [ pro : gapwsat01 ] , the relation @xmath503 has gap property @xmath471 .",
    "since the reduction given in theorem  [ thm : krobustred ] preserves instances in @xmath505 ( subject to a change in @xmath75 ) and instances in @xmath506 , then from lemma  [ lem : gap ] , the relation @xmath18 satisfies @xmath507 , and so @xmath438 and @xmath152 are @xmath101-complete .      by proposition  [ pro : weakbase ] ,",
    "the following relation is a weak base for the co - clone @xmath235 .",
    "@xmath508 we will use @xmath509 to denote the template @xmath510 and @xmath511 to denote the constraint problem @xmath512 .",
    "[ pro : gapbigwsat01 ] the relation @xmath513 satisfies @xmath471 .",
    "we show there is a polynomial - time reduction taking no instances of the constraint problem @xmath422 to instances in @xmath514 and taking instances in @xmath515 to instances in @xmath516 .",
    "the final result will then follow from proposition  [ pro : bigwgap ] and lemma  [ lem : gap ] .",
    "given an instance @xmath517 of @xmath422 , construct an instance of @xmath518 of @xmath511 by replacing each constraint @xmath519 in @xmath39 with @xmath520 . clearly",
    "every solution of @xmath35 is a solution of @xmath518 .",
    "we will use the assumption that @xmath392 and @xmath222 are the only variables that appear in the final two positions of a constraint tuple , which is justified by remark  [ rem : bottop2 ] .",
    "now assume that @xmath35 belongs to @xmath521 .",
    "we first show that @xmath522 .",
    "let @xmath352 be a pair of distinct elements in @xmath29 and consider an assignment @xmath459 that is locally compatible for @xmath518 .",
    "if @xmath346 is locally compatible for @xmath35 , then we can use the fact that @xmath35 is in @xmath523 to extend @xmath346 to a solution of @xmath35 , which is also a solution of @xmath518 .    _ case _",
    "if the assignment @xmath346 is not locally compatible for @xmath35 , then @xmath346 satisfies @xmath385 or @xmath460 . in the first case",
    ", we can extend @xmath346 to a solution of @xmath518 by sending every variable in @xmath29 to @xmath138 and in the second , we extend by sending every variable in @xmath29 to @xmath15 .",
    "now @xmath524 follows from the fact that @xmath525 : we use the separating solutions of @xmath35 , which are also solutions of @xmath518 , to separate distinct pairs of elements of @xmath518 .",
    "now assume that @xmath518 has a non - trivial solution @xmath329 in @xmath511 .",
    "then @xmath329 separates @xmath392 from @xmath222 , so is also a solution of @xmath35 in @xmath422 . in the contrapositive : if @xmath35 is a no instance of @xmath422 , then @xmath518 has only trivial solutions for @xmath511 .",
    "[ cor : npbigwsat01 ] the following problems are @xmath1-complete .    * the @xmath202-robust satisfiability problem @xmath202-@xmath526 . * the separation problem @xmath527 .",
    "[ thm : gapin ] let @xmath18 be a constraint language on @xmath135 such that @xmath528",
    ". then @xmath18 has the gap property @xmath474 , for some finite set @xmath280 of ppositive formul in the language of @xmath18 , and consequently the problems @xmath438 and @xmath152 are @xmath101-complete .",
    "since @xmath529 is an irredundant weak base for the co - clone @xmath235 , from theorem  [ thm : eqfreeweak ] , we have @xmath530 , and from proposition  [ pro : gapbigwsat01 ] , the relation @xmath529 has gap property @xmath487 . since the reduction given in theorem  [ thm : krobustred ] preserves instances in @xmath531 ( subject to a change in @xmath75 ) and instances in @xmath473 , then by lemma  [ lem : gap ] , that @xmath18 satisfies @xmath507 , for some finite set @xmath280 of pp - formul , and consequently @xmath438 and @xmath152 are @xmath101-complete .",
    "in this section , we investigate tractability for @xmath152 and @xmath160-@xmath149 over constraint languages @xmath18 on @xmath135 .",
    "we establish a theorem that covers all cases that are solvable in polynomial - time , see theorem  [ thm : tractable ] below .    in the following it useful to recall that a finite relational structure ( template ) is a core if all of its unary polymorphisms are bijective .",
    "the following theorem appears in ( * ? ? ?",
    "* proposition  @xmath532 ) ; strictly speaking , the result in @xcite holds for @xmath7-robust satisfiability , however the proof is applicable to the broader setting of @xmath6-robust satisfiability .",
    "we list only the properties required to establish our main results .",
    "* proposition  @xmath532)[thm : tract ] let @xmath18 be a constraint language on a finite set @xmath20 and let @xmath26 be the corresponding template .",
    "consider @xmath533 .",
    "there is a logspace turing reduction from the following computational problems to @xmath534 .",
    "* @xmath6-@xmath93 , for any @xmath535 and any finite set @xmath75 of pp - formulae in the language of @xmath18 . * @xmath45 .",
    "recall that to a core structure @xmath26 we can add all singleton unary relations without increasing the complexity of @xmath536 , see ( * ? ? ?",
    "* theorem  @xmath537 ) .",
    "thus , it follows from theorem  [ thm : tract ] , that in the case where @xmath26 is a core , each of the problems listed is reducible to @xmath536 .",
    "[ thm : tractable ] let @xmath18 be a constraint language on @xmath135 .",
    "if @xmath538 , then the computational problems @xmath152 and @xmath160-@xmath149 are solvable in polynomial - time .",
    "when @xmath538 , it follows from post s co - clone lattice ( see figure [ clo : dualpost ] ) , that @xmath539 and then it is known that the constraint problem @xmath540 is tractable ; this can be found in schaefer s original argument for example ; see ( * ? ? ?",
    "* lemma  4.1 ) . then from theorem  [ thm : tract ] , the problems @xmath152 and @xmath160-@xmath149 are solvable in polynomial - time .",
    "the algebraic analysis of polymorphisms has been a very powerful tool in the study of @xmath11 complexity ; for the main development of this approach see  @xcite . in particular , the existence of polymorphisms satisfying certain equations has been shown to ensure tractability ( see  @xcite for example ) and can be used to identify appropriate algorithmic methods for solvability  @xcite .",
    "conversely , the absence of polymorphisms satisfying certain equations ensures intractability  @xcite . a first step in developing",
    "the algebraic theory was recognising that @xmath11 complexity is preserved under the operator @xmath541 ; this goes back to schaefer @xcite .",
    "a second step was connecting the algebra of polymorphisms to fundamental concepts in universal algebra : first variety theory , then the deeper analysis of tame congruence theory ; much of the universal algebraic analysis is built on the work of  @xcite . for a comprehensive overview of the algebraic approach see @xcite .",
    "we have seen that for some computational problems the @xmath541 operator appears too coarse .",
    "when the weaker operator @xmath542 can be substituted , conventional polymorphism analysis can be replaced by the analysis of _ partial _ polymorphisms . in this section ,",
    "we examine which aspects of the second step in the algebraic analysis of @xmath11 complexity can be recovered for problems amenable to the @xmath542 operator . in particular , we investigate how the computational complexity of @xmath3 , @xmath8-@xmath97 and other variants of the @xmath11 relate to variety - like properties of the partial polymorphism algebra and establish theorems that are analogous to some of the main contributions in bulatov et al .",
    "* theorems @xmath537 , @xmath543  &  @xmath544 ) .",
    "we first prove a more general version of theorem  [ thm : krobustred ] .",
    "the addition of equality presents complications for @xmath160-robust satisfiability , and we require the use of a gap property to carry through the reduction .",
    "the proof for @xmath3 is similar , however a further slight variation of the proof is necessary .",
    "we will say that an equality constraint @xmath545 is non - trivial if @xmath546 , otherwise it is trivial .",
    "[ thm : weaksysgap ] let @xmath20 be a non - empty finite set and let @xmath18 be a constraint language over @xmath20 .",
    "let @xmath47 be any finite subset of @xmath547 and let @xmath75 be a finite set of pp - formul in the language of @xmath47 .",
    "then there is a polynomial - time karp reduction from @xmath548 to @xmath152 .",
    "moreover , if @xmath47 has gap property @xmath549 , then @xmath18 satisfies @xmath550 , for some finite set @xmath280 of pp - formul in the language of @xmath18 .",
    "first fix some no instance @xmath551 of @xmath152 , ensuring that if @xmath144 is nontrivial , then @xmath551 is a no instance of @xmath144 ( which is automatically a no instance of @xmath152 ) .",
    "we now make a small adjustment to the proof of lemma [ lem : caequivsolns ] . given an @xmath47-instance @xmath35 , we construct a @xmath18-instance @xmath259 . again",
    ", each constraint @xmath552 is to be replaced by constraints built from the conjuncts in the formula defining @xmath109 from @xmath18 .",
    "however , now there may be equality conjuncts .",
    "_ case  @xmath15_. if there is a non - trivial equality constraint @xmath545 introduced , then @xmath35 was a no instance of @xmath548 as no satisfying solution can separate @xmath553 and @xmath554 . thus , for @xmath259 we may output @xmath551 .",
    "_ case  @xmath202_. if all equality constraints constructed are trivial , then we may omit these from the conjuncts .",
    "all of the conjuncts are now equality - free and so we are in the situation encountered in lemma [ lem : caequivsolns ] : the solutions of the instance @xmath35 are identical to those of @xmath259 .",
    "hence @xmath35 is a yes instance of @xmath548 if and only if @xmath35 is a yes instance of @xmath152 . as this is trivially true in case 1 also , we have the desired reduction .",
    "assume that @xmath47 satisfies @xmath549 .",
    "it follows that @xmath555 is nontrivial and so @xmath144 is non - trivial as @xmath555 reduces to @xmath144 .",
    "assume @xmath35 is a no instance of @xmath555 .",
    "if case  @xmath15 applies , then @xmath556 is no instance of @xmath144 , as required .",
    "if case  @xmath202 applies , then @xmath259 can not have a solution .",
    "so @xmath259 is again a no instance of @xmath144 .",
    "now assume @xmath557",
    ". then case @xmath202 applies and the solutions of the instance @xmath35 are identical to those of @xmath259 .",
    "we are then essentially in the equality - free case considered in ( @xmath202 ) and ( @xmath16 ) of theorem  [ thm : krobustred ] . using the set @xmath558 and argument given there",
    ", it follows that @xmath259 is in @xmath559 .",
    "the final result is obtained by lemma  [ lem : gap ] .",
    "results of bulatov , jeavons and krokhin provide the fundamental connection between csp complexity and the tame - congruence theoretic analysis of polymorphism algebras ; see  ( * ? ? ?",
    "* theorems @xmath543 , @xmath544 ) or ( * ? ? ?",
    "* theorem  @xmath560 ) for a refined version .",
    "we now prove a variation of this result , which we establish through a series of polynomial - time reductions , presented in the form of lemmas .",
    "the constructions used for substructures ( lemma  [ lem : parsubred ] ) and homomorphisms ( lemma  [ lem : homredn ] ) are based on those in  @xcite , given in the standard csp setting . in the case of taking substructures , @xmath3 and @xmath160-@xmath97 carry through using the standard construction ( subject to a change in the local compatibility condition @xmath75 ) .",
    "the homomorphism case however requires proper amendment , including the addition of extra relations and non - trivial usage of the gap property .    for partial algebras",
    "there are a number of reasonable ways to define the concepts of subalgebra and homomorphism ; see grtzer @xcite for example .",
    "we take the definition of subalgebra coinciding with the model - theoretic notion of substructure and take the weakest ( that is , most general ) definition of homomorphism of the standard definitions .",
    "let @xmath113 be a set of finitary partial operation symbols .",
    "the partial algebra @xmath561 is a _",
    "subalgebra _ of the partial algebra @xmath562 , if @xmath563 and for each @xmath21-ary @xmath564 , we have @xmath565 , and @xmath566 agrees with @xmath567 on this set .",
    "let @xmath113 be a set of finitary partial operation symbols and let @xmath568 and @xmath569 be partial algebras .",
    "a map @xmath570 is a _ homomorphism _ if , for every @xmath21-ary @xmath564 and @xmath571 , we have @xmath572 and @xmath573 .",
    "we say that @xmath574 is a _ homomorphic image _ of @xmath575 if there exists a surjective homomorphism @xmath576 .",
    "note that homomorphic images are not uniquely determined by the map @xmath577 .    in the following preliminary lemmas",
    ", it may be useful to recall that , for any non - empty set @xmath20 and set @xmath113 of partial operations on @xmath20 , a @xmath7-ary relation @xmath109 on @xmath20 is in @xmath196 precisely when @xmath109 is a subuniverse of the partial algebra @xmath578 .",
    "[ lem : homredn ] let @xmath113 be a set of finitary partial operation symbols , let @xmath568 and @xmath569 be finite partial algebras and let @xmath579 be a surjective homomorphism .",
    "let @xmath18 be a finite subset of @xmath580 , let @xmath75 be a finite set of pp - formul in the language of @xmath18 and let @xmath142 .",
    "then for some finite set @xmath581 there is a polynomial - time computable function reducing    1 .",
    "@xmath582 to @xmath583 , 2 .",
    "@xmath584 to @xmath585 , for some finite set @xmath280 of pp - formul in the language of @xmath227 ,    and taking @xmath151 to @xmath586 .",
    "we use a slight variation to the construction given in the proof of ( * ? ? ?",
    "* theorem  @xmath544 ) .",
    "we begin by finding a subset @xmath227 of @xmath587 : for each @xmath7-ary relation @xmath109 in @xmath580 , construct the following set @xmath588 and let @xmath589 .",
    "certainly @xmath590 is finite and it is an easy exercise to check that @xmath591 is a subuniverse of @xmath592 and @xmath593 , for each @xmath109 in @xmath580 .    given an instance @xmath594 of @xmath582 , we construct an instance @xmath262 of @xmath583 by replacing each constraint @xmath595 with @xmath596 .",
    "thus , @xmath597 .",
    "the proof for ( @xmath15 ) is identical to the proof of ( * ? ? ?",
    "* theorem  @xmath544 ) . for ( @xmath202 )",
    ", we begin by finding a set @xmath280 of pp - formul in the language of @xmath227 . for each @xmath598",
    "we construct a pp - formula @xmath599 in the language of @xmath227 by replacing every occurrence of @xmath600 with @xmath601 and every occurrence of @xmath602 with @xmath591 .",
    "observe that @xmath603 is true in @xmath604 if and only if @xmath605 is true in @xmath606 , for any @xmath607 and @xmath598 .",
    "now assume that @xmath594 is a yes instance of @xmath584 and consider an assignment @xmath608 with @xmath609 .",
    "if @xmath346 is @xmath280 compatible for @xmath259 , then @xmath610 is @xmath75-compatible for @xmath35 .",
    "we can extend @xmath611 to a solution @xmath331 of @xmath35",
    ". then any function @xmath612 such that @xmath613 , for all @xmath323 , is a solution of @xmath259 that extends @xmath346 . for",
    "the converse direction , begin by assuming that @xmath262 is a yes instance of @xmath585 and consider an assignment @xmath614 with @xmath609 that is @xmath75-compatible for @xmath35 .",
    "then any @xmath615 such that @xmath616 , for all @xmath323 is @xmath280-compatible for @xmath259 .",
    "we can extend @xmath181 to a solution @xmath331 of @xmath259 .",
    "then @xmath617 is a solution of @xmath35 that extends @xmath618 .    to prove ( @xmath16 ) , assume that @xmath35 is a yes instance of @xmath619 .",
    "let @xmath620 be a pair of distinct variables in @xmath29 and let @xmath621 be a separating solution of @xmath35 for the pair @xmath622 guaranteed by the assumption",
    ". then any function @xmath623 such that @xmath624 , for all @xmath323 , is a separating solution of @xmath259 for the pair @xmath620 .",
    "hence @xmath259 is a yes instance of @xmath625 .",
    "[ lem : parsubred ] let @xmath113 be a set of finitary partial operation symbols , let @xmath626 be a finite partial algebra and let @xmath561 be a subalgebra of @xmath575 .",
    "let @xmath18 be a finite subset of @xmath627 , let @xmath75 a finite subset of pp - formul in the language of @xmath18 and let @xmath274 .",
    "then for some finite set @xmath227 of @xmath628 there is a polynomial - time reduction from    1 .",
    "@xmath582 to @xmath583 , 2 .",
    "@xmath619 to @xmath625 , 3 .",
    "@xmath584 to @xmath585 , for some finite set @xmath280 of pp - formul in the language of @xmath227 .",
    "we first show that @xmath629 .",
    "let @xmath109 be a @xmath7-ary relation on the set @xmath245 and assume that @xmath109 is invariant under @xmath630 .",
    "we will show that @xmath109 is invariant under @xmath631 .",
    "let @xmath632 be @xmath21-ary , and let @xmath110 be tuples in @xmath633 .",
    "now assume that for all @xmath634 , we have @xmath635 .",
    "since @xmath109 is a relation on @xmath245 , we have @xmath636 and since @xmath637 on this set , it follows that @xmath638 and hence @xmath639 .",
    "now since @xmath640 is a subalgebra of @xmath641 , the set @xmath245 , viewed as a unary relation on @xmath20 , belongs to @xmath628 .",
    "so let @xmath642 .",
    "the following construction is borrowed from ( * ? ? ?",
    "* theorem  @xmath543 ) and gives a reduction from @xmath582 to @xmath583 , proving ( @xmath15 ) .",
    "given an instance @xmath594 of @xmath643 , we construct an instance of @xmath262 of @xmath644 in the following way . for each @xmath323 , add the constraint @xmath645 to @xmath39 .",
    "so @xmath646 .",
    "note that the solutions of @xmath594 are identical to those of @xmath262 .",
    "it follows that the separating solutions of @xmath35 are precisely the separating solutions of @xmath259 .",
    "hence @xmath35 is a yes instance of @xmath619 if and only if @xmath259 is a yes instance of @xmath625 .",
    "this proves ( @xmath202 ) .    for ( @xmath16 ) ,",
    "assume that @xmath35 is a yes instance of @xmath6-@xmath647 and let @xmath648 .",
    "every @xmath280-compatible assignment on @xmath7 variables of @xmath259 preserves @xmath75-constraints into @xmath245 as @xmath645 is a constraint of @xmath259 , for all @xmath323 .",
    "thus , every @xmath280-compatible assignment on @xmath7 variables for @xmath259 is an @xmath75-compatible assignment for  @xmath35 , and conversely .",
    "the reduction from @xmath649 to @xmath650 then follows from the fact that the solutions of @xmath594 are exactly the solutions of @xmath262 .",
    "we are now ready to prove the first main result of this section .",
    "for any partial algebra @xmath575 we let @xmath651 be the smallest class of partial algebras in the same signature closed under the formation of homomorphic images ( @xmath652 ) and subalgebras ( @xmath653 ) .",
    "[ thm : hsgap ] let @xmath654 and @xmath655 be templates , let @xmath75 be a finite set of pp - formul in the language of @xmath47 and let @xmath142 .",
    "if @xmath84 has gap property @xmath549 and there exist partial algebras @xmath656 and @xmath657 such that    1 .",
    "@xmath658 , 2 .",
    "@xmath659 , and 3 .",
    "@xmath660 ,    then @xmath47 has gap property @xmath550 .",
    "the result is established by carrying the gap property through items ( @xmath15 ) , ( @xmath202 ) and ( @xmath16 ) .",
    "this requires showing there is a series of polynomial - time reductions preserving no instances of @xmath11 and instances that are simultaneously yes instances of @xmath3 and @xmath8-@xmath97 .    from ( @xmath15 ) , we have @xmath661 and so @xmath662 . from  ( @xmath202 )",
    ", there is a surjective homomorphism @xmath663 , where @xmath664 is a subalgebra of @xmath575 .",
    "thus , by lemma  [ lem : homredn ] , there is a finite subset @xmath665 of @xmath666 and a polynomial - time reduction taking instances in @xmath667 to @xmath668 , and instances in @xmath669 to @xmath670 , for some finite set @xmath671 of pp - formul in the language of @xmath665 .",
    "hence @xmath665 satisfies @xmath672 .",
    "now since @xmath673 is a subalgebra of @xmath575 , by lemma  [ lem : parsubred ] , there is a finite set @xmath674 of @xmath675 and a polynomial - time reduction taking instances in @xmath668 to @xmath676 , and instances in @xmath677 to @xmath678 , for some finite set @xmath679 of pp - formul in the language of @xmath674 .",
    "hence @xmath674 satisfies @xmath680 . from ( @xmath16 ) , it follows that @xmath681 .",
    "thus , @xmath674 is a finite subset of @xmath682 . by theorem  [ thm : weaksysgap ]",
    ", it then follows that @xmath47 has gap property @xmath683 , for some finite set @xmath280 of pp - formul in the language of @xmath47 .    when @xmath684 , theorem  [ thm : hsgap ] lifts the complete classification given by the gap trichotomy theorem on boolean domains to many problems on templates with non - boolean domains . with further effort , direct products ( @xmath685 )",
    "can be incorporated into condition ( @xmath202 ) of theorem  [ thm : hsgap ] , however the argument is beyond the scope of the present article , and will appear in subsequent work .",
    "for now we establish a weaker version .",
    "we first introduce the following equivalence relations .",
    "let @xmath20 be a non - empty set and @xmath686 .",
    "for any pair of elements @xmath687 in @xmath688 and for every @xmath689 , we define @xmath690    for any @xmath691 , there are @xmath692 equivalence relations of the form @xmath693 , for @xmath694 .",
    "the basis for the following construction was inspired by ( * ? ? ?",
    "* lemma  @xmath695 ) , however the reduction requires significant modification with the main addition being a pre - processing `` local reflection '' procedure .",
    "[ lem : powerred ] let @xmath113 be a set of finitary partial operation symbols , let @xmath562 be a finite partial algebra and consider @xmath696 .",
    "let @xmath18 be a finite subset of @xmath697 and let @xmath75 be a finite set of pp - formul in the language of @xmath18 . then for some finite set @xmath698 there is a polynomial - time function taking    1 .",
    "@xmath143 to @xmath699 , 2 .   and @xmath700 to @xmath586 .",
    "we begin by fixing the subset @xmath227 of @xmath628 . a @xmath7-ary relation @xmath109 on @xmath688",
    "can be considered as a @xmath701-ary relation @xmath702 on @xmath20 , by replacing each @xmath7-tuple of @xmath282-tuples @xmath703 by the @xmath701-ary tuple @xmath704 in particular , if @xmath568 is a partial algebra and @xmath109 is a subuniverse of the direct power @xmath705 , then @xmath706 is the corresponding subuniverse of @xmath707 .",
    "hence @xmath708 and so let @xmath709 .",
    "the reduction now proceeds in two steps .",
    "given an instance @xmath710 of @xmath144 where @xmath711 , we begin by constructing an instance @xmath712 of @xmath713 in the following way .    1 .",
    "let @xmath714 , and 2 .",
    "replace each constraint @xmath715 in @xmath39 with @xmath716    at this point in the construction , we denote the instance by @xmath717 . to complete the construction of @xmath718 ,",
    "we apply the following `` local reflection '' procedure to @xmath35 . for every @xmath719 ,",
    "select some number @xmath720 with @xmath721 . for every @xmath722 and @xmath723 with @xmath724 ,    *",
    "if every @xmath75-compatible assignment @xmath725 maps maps @xmath726 into @xmath727 , we add the constraint @xmath728 ,    and for every distinct pair @xmath729 in @xmath29 and @xmath723 ,    * if every @xmath75-compatible assignment @xmath730 maps @xmath731 into @xmath727 , we add @xmath732 .",
    "we now construct an instance @xmath733 of @xmath734 , by eliminating all constraints involving @xmath735 in the usual way : fix some arbitrary total order @xmath736 on @xmath737 and let @xmath738 denote the reflexive transitive closure of the relation @xmath739 on @xmath740 . for any @xmath741 , let @xmath742 denote the @xmath736-smallest element of the @xmath743-class of @xmath741 . then @xmath744 is simply @xmath745 , but with each appearance of @xmath746 replaced by @xmath742 ( and all @xmath739 constraints removed ) .    for ( @xmath15 )",
    ", we prove the contrapositive .",
    "if @xmath320 is a solution of @xmath744 in @xmath734 , then @xmath747 is a solution of @xmath718 and therefore is also a solution of @xmath717 .",
    "the map @xmath748 defined by @xmath749 , for all @xmath750 , is a solution of @xmath35 in @xmath144 .    for ( @xmath202 ) ,",
    "assume that @xmath35 is a yes instance of @xmath160-@xmath149 .",
    "we will show that @xmath744 is a yes instance of @xmath751 .",
    "let @xmath752 be a distinct pair of variables in @xmath753 .",
    "we consider two cases .",
    "_ case  @xmath15_. if @xmath754 and @xmath724",
    ". then there was some @xmath75-compatible assignment @xmath725 mapping @xmath726 into @xmath755 . hence @xmath756 .",
    "we can extend @xmath346 to a full solution @xmath320 of @xmath35 in @xmath144 as we are assuming that @xmath35 is @xmath160-robustly satisfiable .",
    "then the map @xmath757 defined by @xmath758 , for all @xmath759 and @xmath760 , is a solution of @xmath744 that separates the pair @xmath761 .",
    "_ case  @xmath202_. if @xmath762 and @xmath723 . since @xmath741 and @xmath763 were not identified by the above construction , there must have been some @xmath75-compatible assignment",
    "@xmath764 mapping @xmath731 into @xmath765 .",
    "hence @xmath766 .",
    "we can extend @xmath346 to a solution @xmath320 of @xmath35 in @xmath144 .",
    "then the map @xmath757 defined by @xmath758 , for all @xmath759 and @xmath767 , is a solution of @xmath744 that separates the pair @xmath752 .",
    "it follows from case  @xmath15 and @xmath202 that @xmath744 is a yes instance of @xmath751 .",
    "[ thm : hspgap ] let @xmath768 and @xmath769 be templates and let @xmath75 be a finite set of pp - formul in the language of @xmath47",
    ". if @xmath84 has the gap property @xmath770 and there exist partial algebras @xmath656 and @xmath657 such that    1 .",
    "@xmath658 , 2 .",
    "@xmath771 , and 3 .",
    "@xmath660 ,    then @xmath47 satisfies @xmath772 .",
    "the argument follows the proof of theorem  [ thm : hsgap ] up to and including the application of lemma  [ lem : parsubred ] , except now @xmath673 is a subalgebra of @xmath773 , for some @xmath774 .",
    "we then apply lemma  [ lem : powerred ] before continuing on to the application of condition ( @xmath16 ) .",
    "the conclusion that @xmath47 has gap property @xmath772 is then established from the proof of theorem  [ thm : weaksysgap ] ( in contrast to theorem  [ thm : weaksysgap ] directly ) .",
    "we now observe that @xmath775 theorems can be obtained for other variants of the constraint satisfaction problem .",
    "the following _ equivalence problem _ has been studied in bhler , hemaspaandra , reith and vollmer  @xcite and @xcite , and the _ implication problem _ has been studied in @xcite .",
    "+    as observed in @xcite , the two problems are closely related , in fact they are equivalent under polynomial - time turing reductions : a pair @xmath776 is a yes instance of @xmath777 if and only if @xmath778 is a yes instance of @xmath779 , while @xmath776 is a yes instance of @xmath779 if and only if both @xmath776 and @xmath780 are yes instances of @xmath777 .    in the case of boolean domains , both @xmath781 and @xmath782 have been shown to experience @xmath783 versus co@xmath1 dichotomies with identical boundaries to those established for @xmath3 and @xmath160-@xmath97 ; see @xcite for the original proof and @xcite for a simplified proof using clone - theoretic techniques .",
    "the @xmath775 theorem for @xmath781 and @xmath782 ( theorem  [ thm : hsequiv ] below ) lifts the complete classifications given by these dichotomies on boolean domains to templates with non - boolean domains .",
    "this is particularly useful for @xmath781 and @xmath782 as it is unknown if the operator @xmath784 can be applied in the case of non - boolean domains .",
    "even the operator @xmath220 is unknown to be compatible with @xmath781 in the non - boolean case .",
    "the weaker operator @xmath219 is known to be applicable ( see lemma  [ lem : impred ] below ) , but this imposes the additional assumption of irredundancy .",
    "the proof of the @xmath775 theorem for @xmath781 and @xmath782 relies on the following two results",
    ". it may be useful to recall the notion of irrendundancy given in definition  [ defn : irrednt ] .",
    "* proposition  3.11)[lem : irred ] let @xmath47 be a constraint language over a non - empty finite set @xmath20 and let @xmath84 be a finite subset of @xmath682 . if @xmath84 is irredundant , then @xmath785 .",
    "* proposition  @xmath786)[lem : impred ] let @xmath47 be a constraint language over a non - empty finite set @xmath20 and let @xmath785 .",
    "then there is polynomial - time reduction from @xmath787 to @xmath788 and from @xmath789 to @xmath790 .",
    "[ thm : hsequiv ] let @xmath654 and @xmath655 be templates",
    ". if @xmath84 is irredundant and there exist partial algebras @xmath656 and @xmath657 such that    1 .",
    "@xmath658 , 2 .",
    "@xmath659 , and 3 .",
    "@xmath660 ,    then there is a polynomial - time reduction from @xmath787 to @xmath788 and from @xmath789 to @xmath790 .",
    "we prove the result only for @xmath782 as the proof for @xmath781 is similar .",
    "condition ( @xmath15 ) implies that @xmath661 and so @xmath662 .",
    "condition  ( @xmath202 ) gives a surjective homomorphism @xmath663 , where @xmath664 is a subalgebra of @xmath575 .",
    "we first show that for some @xmath791 , the problem @xmath792 is reducible to @xmath793 in polynomial - time .",
    "we use the construction given in the proof of lemma  [ lem : homredn ] , except now there is no need for the inclusion of the relation @xmath591 .",
    "let @xmath794 .",
    "given an instance @xmath795 of @xmath792 , we construct an instance @xmath796 of @xmath797 by letting @xmath798 , for each @xmath799 . now assume that @xmath35 is a yes instance of @xmath800 .",
    "consider a solution @xmath801 of @xmath802 .",
    "then @xmath803 is a solution of @xmath804 and is therefore a solution of @xmath805 .",
    "then any function @xmath806 satisfying @xmath807 is a solution of @xmath808 . in particular",
    ", @xmath329 is a solution of @xmath808 .",
    "conversely , assume that @xmath259 is a yes instance of @xmath809 and consider a solution @xmath621 of @xmath804 .",
    "let @xmath810 be any function satisfying @xmath811 .",
    "then @xmath812 is a solution of @xmath802 and therefore also a solution of @xmath808 .",
    "it then follows that @xmath813 is a solution of @xmath805 , as required .",
    "we now show that for some @xmath814 , there is a polynomial - time reduction from @xmath793 to @xmath815 . in the degenerate case that @xmath816 , we let @xmath817",
    ". otherwise we use the construction given in the proof of lemma  [ lem : parsubred ] .",
    "let @xmath818 .",
    "given an instance @xmath819 of @xmath793 , we construct an instance @xmath820 of @xmath815 in the following way : for each @xmath799 , we let @xmath821 .",
    "the reduction immediately follows from the fact that the solutions of @xmath822 are identical to those of @xmath823 , for each @xmath799 .    now from ( @xmath16 ) , we have that @xmath681 .",
    "thus , @xmath674 is a finite subset of @xmath682 .",
    "observe that the constructions applied to the constraint languages @xmath84 and @xmath665 above preserve irredundancy , and so @xmath674 is also irredundant . by lemma  [ lem : irred ] , it follows that @xmath674 is a finite subset of @xmath824 .",
    "then lemma  [ lem : impred ] gives the final reduction from @xmath815 to @xmath825 .",
    "a further useful simplification in the standard csp setting has been the restriction to so - called idempotent polymorphisms ; see ( * ? ? ?",
    "* theorem  @xmath537 ) .",
    "a partial polymorphism @xmath826 is _ idempotent _ if @xmath827 for every @xmath828 for which @xmath829 . as a final result",
    "we show that when analysing the complexity of @xmath3 problems we may restrict to idempotent partial polymorphisms .",
    "we first fix some useful notation . for a template @xmath830 , let @xmath831 be a copy of @xmath20 given by @xmath832 ( to be treated as variables ) , and let @xmath833 denote the equality - free positive atomic diagram of @xmath575 : @xmath834    let @xmath835 denote the union of @xmath18 with the set of all singleton unary relations @xmath836 for @xmath828 .",
    "the proof of the following theorem is based on examples described by jackson @xcite .",
    "[ thm : unaryred ] let @xmath18 be a constraint language over a finite non - empty set @xmath20 . if @xmath830 is a core relational structure , then @xmath152 is equivalent to @xmath837 , with respect to a polynomial - time turing reduction .",
    "every instance of @xmath152 is an instance of @xmath837 as @xmath838 , and is equivalently a yes instance ( or no instance ) of both problems .",
    "hence @xmath152 reduces to @xmath837 in constant - time .",
    "we now show there is a polynomial - time turing reduction from @xmath837 to @xmath152 . for a given instance @xmath28 of @xmath837 ,",
    "we begin by constructing a new instance @xmath839 of @xmath837 in the following way : first let @xmath840 be the disjoint union @xmath841 and construct @xmath842 by replacing every constraint @xmath843 in @xmath39 with @xmath844 , and then taking the disjoint union with @xmath833 .",
    "we will show there is a polynomial - time computable family @xmath845 of @xmath18-instances satisfying the property that @xmath35 is a yes instance of @xmath837 if and only if there exists @xmath846 such that @xmath259 a yes instance @xmath152 .    _",
    "case  @xmath15_. if there exists @xmath828 and constraints @xmath847 with @xmath848 , then @xmath35 is automatically a no instance of @xmath837 as any satisfying solution of @xmath35 must identify @xmath849 and @xmath850 . in this case , we let @xmath845 be the set containing a single fixed no instance of @xmath152 .    _",
    "case  @xmath202_. for every @xmath828 at most one variable in @xmath29 is constrained to @xmath836 . in this case",
    "there may be some @xmath828 for which @xmath836 does not appear in any constraint in @xmath39 .",
    "let @xmath674 be the set of all such  unused \" elements in @xmath20 and let @xmath851 be the set of all variables in @xmath29 that are not constrained to any singleton unary relation .",
    "we first examine the number of ways to extend @xmath852 to include singleton constraints from @xmath674 without falling back into case  @xmath15 .",
    "each member of @xmath845 will be constructed from such an extension . for every subset @xmath853 and injective function @xmath854 from @xmath674 into @xmath851 , let @xmath855 .",
    "let @xmath856 and let @xmath857 be the number of @xmath116-element subsets of @xmath674 , for each @xmath858 .",
    "let @xmath859 .",
    "the number of injective functions from an @xmath116 element set to @xmath851 is the @xmath116-permutation @xmath860 .",
    "then the total number of instances included in @xmath845 is @xmath861 as @xmath862 is bounded by a constant and @xmath863 , there is a uniform polynomial bound on the number of instances included in @xmath845 ( in fact , the total number of instances in @xmath845 is in @xmath864 ) ) .",
    "consider an extension @xmath865 of @xmath35 .",
    "apply the usual procedure to @xmath866 for eliminating all constraints involving the equality relation ; the resulting variables will be denoted @xmath867 .",
    "when @xmath868 , it is notationally convenient to use both @xmath5 and @xmath869 to denote the same point of @xmath867 after this identification : this is justified by the observation that in this construction there are no sequences of equalities of length more than one , so that distinct elements of @xmath29 , as well as distinct elements of @xmath831 , remain distinct after the identification . in particular , this abuse of notation allows us to consider both @xmath831 and @xmath29 as ( overlapping ) subsets of  @xmath840 .",
    "let @xmath870 be the set of these constructed instances .",
    "assume there is some @xmath871 such that @xmath259 is a yes instance of @xmath152 .",
    "so for every pair @xmath620 of distinct variables in @xmath867 there is a separating solution @xmath320 for that pair . since @xmath320 preserves @xmath833 , the restriction @xmath872 determines an automorphism  @xmath346 of @xmath26 , by way of @xmath873 if @xmath874 .",
    "then the map @xmath875 is a solution of @xmath35 separating the pair @xmath620 .",
    "hence @xmath35 is a yes instance of @xmath837 .",
    "now assume that @xmath35 is a yes instance of @xmath837 .",
    "we will show there exists some @xmath259 in @xmath845 such that @xmath259 is a yes instance of @xmath152 .",
    "we first apply the following reflection procedure to @xmath876 . for each @xmath877 , if every homomorphism from @xmath35 to @xmath878 maps @xmath877 to some @xmath879 , then we add the constraint @xmath880 to @xmath842 .",
    "note that for distinct @xmath881 we can not have both @xmath880 and @xmath882 added , as we are assuming there is a solution separating @xmath5 from @xmath883 . thus the instance constructed in this way coincides with one of the extensions from case @xmath202 .",
    "find the @xmath846 corresponding to this extension .",
    "for every pair of distinct variables @xmath622 in @xmath29 there is a solution @xmath329 of @xmath35 separating @xmath849 and @xmath850 .",
    "extend the separating solution @xmath329 for @xmath622 to a separating solution of @xmath259 by sending @xmath869 to @xmath884 .",
    "hence @xmath259 is a yes instance of @xmath152 .",
    "let @xmath113 be a set of finitary partial operation symbols and let @xmath885 be a finite partial algebra .",
    "we define the partial algebra @xmath886}_p)\\rangle,\\ ] ] where @xmath887_p)$ ] consists of all idempotent operations from the strong partial clone generated by @xmath631 .",
    "we refer to @xmath888 as the _ full idempotent reduct of @xmath641_.    notice that @xmath889_p)={\\operatorname{inv}(f^{\\bf a})}_{\\operatorname{con}}$ ] .",
    "the next result is an immediate consequence of theorem  [ thm : unaryred ]    let @xmath890 be a finite partial algebra and consider the full idempotent reduct @xmath888 of @xmath641 . if @xmath891 is a core relational structure , then @xmath892 is equivalent to @xmath893 , with respect to a polynomial - time turing reduction .",
    "the results obtained demonstrate that gap properties can prove very powerful in the study of the complexity of constraint problems .",
    "in particular , the gap trichotomy theorem provides dichotomies for an entire family of constraint problems on boolean domains .",
    "gap properties also facilitated an algebraic approach to the study of constraint problems amenable to partial polymorphism analysis : validity of most of the reductions relied intrinsically on the assumption of a gap property . a possible future direction for work might be to extend this analysis to a tame - congruence theoretic approach .",
    "this would require a reworking of tame - congruence theory to adjust for partial algebras .",
    "could such an analysis lead to algebraic dichotomy conjectures for new variants of the constraint satisfaction problem ?    in future work , our focus will extend beyond @xmath894 versus @xmath1 dichotomies to a finer - grained analysis of the complexity of the reductions given above .",
    "while we did not develop these directions in the present article , arguments in the style of larose and tesson @xcite can be used to perform all of the reductions in log - space , and most using first order reductions .",
    "details for tightening the reductions will given in a subsequent paper , where we examine natural extensions of the @xmath3 and ( @xmath895)-@xmath97 conditions and their degree of compatibility with the operator  @xmath541 .",
    "a gap dichotomy of the style given in the present article is believed to be true for these problems , however more technical machinery is required .",
    "samson abramsky , georg gottlob , and phokion  g. kolaitis . robust constraint satisfaction and local hidden variables in quantum mechanics . in francesca",
    "rossi , editor , _ ijcai 2013 , proceedings of the 23rd international joint conference on artificial intelligence , beijing , china , august 3 - 9 , 2013_. ijcai / aaai , 2013 .",
    "elmar bhler , edith hemaspaandra , steffen reith , and heribert vollmer .",
    "equivalence and isomorphism for boolean constraint satisfaction . in julian  c. bradfield , editor , _ computer science logic , 16th international workshop , csl 2002 , 11th annual conference of the eacsl , edinburgh , scotland , uk ,",
    "september 22 - 25 , 2002 , proceedings _",
    ", volume 2471 of _ lecture notes in computer science _ ,",
    "pages 412426 .",
    "springer , 2002 .",
    "georg gottlob . on minimal constraint networks . in jimmy",
    "ho - man lee , editor , _ principles and practice of constraint programming - cp 2011 - 17th international conference , cp 2011 , perugia , italy , september 12 - 16 , 2011 . proceedings _ , volume 6876 of _ lecture notes in computer science _ , pages 325339 .",
    "springer , 2011 .",
    "peter jeavons , david  a. cohen , and marc gyssens . a unifying framework for tractable constraints .",
    "in _ principles and practice of constraint programming - cp95 , first international conference , cp95 , cassis , france , september 19 - 22 , 1995 , proceedings _ , pages 276291 , 1995 .",
    "thomas  j. schaefer .",
    "the complexity of satisfiability problems . in richard  j. lipton , walter  a. burkhard , walter  j. savitch , emily  p. friedman , and alfred  v. aho , editors , _ proceedings of the 10th annual acm symposium on theory of computing , may 1 - 3 , 1978 , san diego , california , usa _ , pages 216226 .",
    "acm , 1978 .",
    "henning schnoor and ilka schnoor .",
    "partial polymorphisms and constraint satisfaction problems . in nadia",
    "creignou , phokion  g. kolaitis , and heribert vollmer , editors , _ complexity of constraints - an overview of current research themes [ result of a dagstuhl seminar ] .",
    "_ , volume 5250 of _ lecture notes in computer science _ , pages 229254 .",
    "springer , 2008 ."
  ],
  "abstract_text": [
    "<S> a computational problem exhibits a  gap property \" when there is no tractable boundary between two disjoint sets of instances . </S>",
    "<S> we establish a gap trichotomy theorem for a family of constraint problem variants , completely classifying the complexity of possible @xmath0-hard gaps in the case of boolean domains . as a consequence , </S>",
    "<S> we obtain a number of dichotomies for the complexity of specific variants of the constraint satisfaction problem : all are either polynomial - time tractable or @xmath1-complete . </S>",
    "<S> schaefer s original dichotomy for @xmath2 variants is a notable particular case .    </S>",
    "<S> universal algebraic methods have been central to recent efforts in classifying the complexity of constraint satisfaction problems . a second contribution of the article is to develop aspects of the algebraic approach in the context of a number of variants of the constraint satisfaction problem . </S>",
    "<S> in particular , this allows us to lift our results on boolean domains to many templates on non - boolean domains .    </S>",
    "<S> this article is a heavily expanded version of an extended abstract submitted to the 2016 isaac proceedings , and differs by the inclusion of full proofs and most results of section  [ sec : algebra ] . ] </S>"
  ]
}