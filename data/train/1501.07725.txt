{
  "article_text": [
    "counting perfect matchings in a bipartite graph is an important computational problem : the permanent of 0 - 1 matrix .",
    "this , and the computationally equivalent problem of sampling matchings uniformly at random , has applications in statistics and other areas . in  @xcite , diaconis , graham and holmesconsidered the applications of the 0 - 1 permanent to statistics , in particular where the 0 - 1 matrix has recognisable structure , which they called _ truncated _ or _ interval - restricted_.    the truncated 0 - 1 matrices are those for which the columns can be permuted to give the _ consecutive  1 s _ property on rows .",
    "that is , no two 1 s in any row are separated by one or more 0 s .",
    "diaconis , graham and holmes  @xcite considered `` one - sided '' truncation , where the consecutive 1 s appear at the left of each row , and `` two - sided '' truncation , where the consecutive 1s can appear anywhere in a row . for two - sided truncation",
    ", they considered two special cases . in the first",
    ", both the rows and columns can be permuted so that they have the consecutive 1 s property . in the second",
    ", the rows and columns can be permuted so that the consecutive 1 s have a `` staircase '' presentation , the _ monotone _",
    "case , which is of interest in statistical applications  @xcite .",
    "diaconis , graham and holmes  @xcite proposed a markov chain for sampling perfect matchings in a bipartite graph , which we call the _",
    "switch chain_. they showed ergodicity of the chain for the truncated matrices considered in  @xcite , and conjectured that it would converge rapidly . computing the 0 - 1 permanent is a well - solved problem from a theoretical viewpoint .",
    "it is # p - complete to compute exactly  @xcite , but there is a polynomial time approximation algorithm  @xcite .",
    "however , the switch chain gives a simpler and more practical algorithm than that of  @xcite , making it worthy of consideration .",
    "thus diaconis , graham and holmes s conjecture was subsequently studied in the phd theses of matthews  @xcite and blumberg  @xcite , and we will discuss their results below .",
    "a 0 - 1 matrix is equivalently the biadjacency matrix of a bipartite graph , and we will study the graphs corresponding to the matrices considered by diaconis , graham and holmes  @xcite .",
    "we identify the largest hereditary graph class in which the switch chain is ergodic : chordal bipartite graphs .",
    "the graphs considered in  @xcite form an ascending sequence within this class .",
    "we examine the mixing time behaviour of the switch chain for graphs from these classes , extending the work of  @xcite ,  @xcite and  @xcite .",
    "we also discuss the difficulty of computing the permanent _ exactly _ in these classes , where valiant s result  @xcite does not necessarily imply # p - completeness .    in particular , we show for the first time that the mixing time of the switch chain is polynomial on monotone graphs .",
    "this is proved by a novel application of a simple combinatorial lemma , the solution to the so - called _ mountain climbing problem _  @xcite .",
    "though this lemma is well known , there appears to be no worst - case analysis of this problem in the literature .",
    "therefore we provide such an analysis as an appendix .",
    "after this paper was written , we learned that bhatnagar , randall , vazirani and vigoda  @xcite had used a similar approach for a rather different problem .",
    "they analysed the jerrum - sinclair chain  @xcite for generating random bichromatic matchings in a graph that has its edges partitioned into two colour classes .    for the necessary background information on markov chains ,",
    "see  @xcite . for the relevant graph - theoretic background ,",
    "see  @xcite .",
    "let @xmath0 denote the natural numbers .",
    "if @xmath1 , let @xmath2=\\{1,2,\\ldots , n\\}$ ] and , if @xmath3 , let @xmath4=\\{n_1,n_1 + 1,\\ldots , n_2\\}$ ] .    we will also use the notation @xmath2'=\\{1',2',\\ldots , n'\\}$ ] and @xmath4'=\\{n'_1,(n_1 + 1)',\\ldots , n'_2\\}$ ] . here",
    "the prime serves only to distinguish @xmath5 from @xmath6 . ordering and arithmetic for @xmath2'$ ] elements",
    "follows that for @xmath2 $ ] .",
    "thus , for example , @xmath7 and @xmath8 .",
    "a graph @xmath9 is _ bipartite _ if its vertex set @xmath10\\cup[n]'$ ] and there is no ( undirected ) edge @xmath11 such that @xmath12 $ ] or @xmath13'$ ] .",
    "thus @xmath14 comprises two independent sets @xmath15 $ ] and @xmath2'$ ] .",
    "bipartite graphs @xmath16\\cup[n]',e_1)$ ] and @xmath17\\cup[n]',e_2)$ ]",
    "are _ isomorphic _ if there are permutations @xmath18 of @xmath15 $ ] and @xmath19 of @xmath2'$ ] such that @xmath20 if and only if @xmath21 .",
    "let @xmath22\\cup[n]',e)$ ] be a bipartite graph .",
    "we consider @xmath15 $ ] and @xmath2'$ ] to have the usual linear ordering , and we will abuse notation by denoting these ordered sets simply by @xmath15 $ ] and @xmath2'$ ] .",
    "then let @xmath23 denote the @xmath24 _ biadjacency matrix _ of @xmath25 , with rows indexed by @xmath15 $ ] and columns by @xmath2'$ ] , such that @xmath26 if @xmath27 , and @xmath28 otherwise .",
    "we will use the graph and matrix terminology interchangeably .",
    "for example , we refer to rows and columns of @xmath25 , or edges in @xmath23 .",
    "the neighbourhood in @xmath25 of a vertex @xmath29\\cup [ n]'$ ] will be denoted by @xmath30 . to avoid trivialities",
    ", we will assume that @xmath25 has no isolated vertices , unless explicitly stated otherwise .",
    "a _ matching _ in a bipartite graph @xmath22\\cup[n]',e)$ ] is a set of independent edges , that is , no two edges in the set share an endpoint .",
    "perfect _ matching is a set of edges such that every vertex of @xmath25 lies in exactly one edge .",
    "for a bipartite graph @xmath22\\cup[n]',e)$ ] this requires @xmath31 , and @xmath32 independent edges in @xmath33 . in particular",
    ", @xmath25 can have no isolated vertices .",
    "we will call a bipartite graph with @xmath31 _",
    "balanced_.    equivalently , a perfect matching may be viewed as @xmath32 independent @xmath34 s in the @xmath35 0 - 1 matrix @xmath23 .",
    "thus a perfect matching @xmath36 has edge set @xmath37\\}$ ] , where @xmath38 is a permutation of @xmath2 $ ] .",
    "equivalently , @xmath36 has edge set @xmath39\\}$ ] , where @xmath18 is a permutation of @xmath2 $ ] .",
    "note that @xmath40 as elements of the symmetric group  @xmath41 .",
    "we may identify the matching  @xmath36 with the permutations @xmath38 and  @xmath18 .",
    "an example is shown in fig .",
    "[ med : fig001 ] below .",
    "the total number of perfect matchings in a bipartite graph @xmath25 is called the _ permanent _ , which we denote by @xmath42 when @xmath43",
    ".      the permanent has been studied extensively in combinatorics and computer science .",
    "valiant showed that computing the permanent _ exactly _ is # p - complete for a general 0 - 1 matrix  @xcite .",
    "no algorithm running in sub - exponential time is known for the exact evaluation of the permanent of 0 - 1 matrices .",
    "jerrum , sinclair and vigoda  @xcite showed that the 0 - 1 permanent has a _ fully polynomial randomised approximation scheme _ ( fpras ) , using an algorithm for randomly sampling perfect matchings .",
    "this improved a markov chain algorithm of jerrum and sinclair  @xcite , which was not guaranteed to have polynomial time convergence for all bipartite graphs .",
    "the algorithm of  @xcite is simple , but involves polynomially many repetitions of a polynomial - length sequence of related markov chains .",
    "the best bound known for the running time of this algorithm is @xmath44 , due to bezkov , tefankovi , vazirani and vigoda  @xcite .",
    "jerrum , valiant and vazirani  @xcite showed that sampling almost uniformly at random and approximate counting have equivalent computational complexity for many combinatorial problems , including the permanent .",
    "technically , the problem must be _ self - reducible_.    from the viewpoint of theoretical computer science , these results entirely settle the question of sampling and counting perfect matchings in bipartite graphs .",
    "however , simpler methods have been proposed for special cases of this problem , and here we consider one such proposal .",
    "diaconis , graham and holmes  @xcite proposed the following markov chain for sampling perfect matchings from a balanced bipartite graph @xmath45\\cup[n]',e)$ ] almost uniformly at random , which we will call the _ switch chain_. a transition of the chain will be called a _ switch_. diaconis ,",
    "graham and holmes  @xcite called this a `` transposition '' .",
    "the switch chain generalises the transposition chain for generating random permutations .    1",
    ".   * switch chain * 2 .",
    "let the perfect matching @xmath46 at time @xmath47 be the permutation @xmath38 of @xmath2 $ ] .",
    "set @xmath48 , and let @xmath49 be any perfect matching of @xmath25 .",
    "4 .   choose @xmath50 $ ] , uniformly at random , so @xmath51.[chain : step2 ] 5 .",
    "if @xmath52 and @xmath53 are both in @xmath33 , + set @xmath54 . 6 .",
    "otherwise , set @xmath55 .",
    "set @xmath56 .",
    "if @xmath57 , repeat from step  [ chain : step2 ] . otherwise , stop .",
    "note that the switch chain is invariant under isomorphisms of @xmath25 , so properties of the chain can be investigated from the viewpoint of graph theory .",
    "an example of a switch is shown below , with the edges @xmath58 being switched for @xmath59 .",
    "the first question we might ask about the switch chain is : for which class of graphs is it ergodic ?",
    "we wish to have a graph - theoretic answer to this question , so that we can recognise membership of graphs in the class .",
    "therefore , we restrict attention to _ hereditary _ graph classes , that is , those for which all ( vertex ) induced subgraphs of every graph in the class are also in the class .",
    "hereditary classes are central in modern graph theory , and are most usually characterised by describing a minimal set of `` excluded subgraphs '' , induced subgraphs which can not be present .",
    "for example , _ perfect graphs _ are those which exclude all odd - length cycles ( _ odd holes _ ) of length at least 5 , or their complements ( _ odd antiholes _ )  @xcite .",
    "thus , in particular , the class of perfect graphs contains all bipartite graphs , which exclude all odd holes and antiholes .",
    "all the graphs we consider here are bipartite , and hence perfect .    in our application",
    ", there is a further technical reason for preferring to work with hereditary graph classes .",
    "we then have self - reducibility for most problems in # p , including the permanent .",
    "this property implies the equivalence between almost uniform sampling and approximate counting referred to in section  [ sec : permanent ] .",
    "see  @xcite for details .",
    "the switch chain is ergodic on a graph @xmath9 if the state space of the chain , the set of perfect matchings , is connected by switches .",
    "we extend this to include graphs with no perfect matching , where the state space is empty",
    ". then we will say that a graph @xmath25 is _ hereditarily ergodic _ if , for every @xmath60 , the induced subgraph @xmath61 $ ] is ergodic . a class of graphs will be called hereditarily ergodic if every graph in the class is hereditarily ergodic .",
    "diaconis , graham and holmes  @xcite observed that the switch chain is not ergodic for all balanced bipartite graphs .",
    "they gave the example :    this graph has two perfect matchings , but the switch chain can not move between them .",
    "this is because the graph is a chordless @xmath62-cycle .",
    "in fact , this property characterises the class of graphs for which the switch chain is not ergodic , as we now show .",
    "we say a graph @xmath25 is _ chordal bipartite _ if it has no chordless cycle of length other than four .",
    "the class of chordal bipartite graphs is clearly hereditary .",
    "note that the definition of chordal bipartite graphs is an excluded subgraph characterisation . to show that the switch chain is ergodic for this class , we require the following `` excluded submatrix '' characterisation .    a ( gamma ) in a 0 - 1 matrix is an induced submatrix of the form @xmath63 ( 0,0)--(0,1.5)--(1,1.5);}{\\hspace*{0.5pt}}}\\xspace}\\;\\textup { : } \\hspace*{10pt}\\begin{bmatrix } 1 & 1\\\\ 1 & 0 \\end{bmatrix}.\\ ] ] a matrix is called -freeif it has no such induced submatrix .",
    "lubiw  @xcite gave the following characterisation .",
    "[ med : thm001 ] a bipartite graph is chordal bipartite if and only if it is isomorphic to a graph @xmath25 such that @xmath23 is -free .",
    "moreover , lubiw  @xcite showed that this characterisation can be used to recognise chordal bipartite graphs in @xmath64 time .",
    "this was subsequently improved to @xmath65 time by uehara  @xcite . for the switch chain",
    "we have :    [ med : lem001 ] the largest hereditary class of bipartite graphs for which the switch chain is ergodic is the class of balanced chordal bipartite graphs . in this class , if @xmath45\\cup[n]',e)$ ] , the diameter of the chain is at most @xmath32 .",
    "clearly any graph with an induced cycle of length greater than 4 can not be in the class , so we need only show ergodicity for chordal bipartite graphs .",
    "the chain is aperiodic , since there is a loop probability at least @xmath66 at each step , from choosing @xmath67 in step  [ chain : step2 ] .",
    "thus we must show that the chain is irreducible . from theorem  [ med : thm001 ]",
    ", we may suppose that @xmath23 is given with a -freepresentation .",
    "let @xmath68 be the transition graph of the switch chain , with @xmath69 the set of perfect matchings in @xmath25 , and @xmath70 the set of transitions .",
    "we must show that @xmath71 is connected , and has diameter at most @xmath32 .",
    "let @xmath38 and @xmath18 be any two perfect matchings in @xmath25 , and let @xmath72 .",
    "note that @xmath73 , and @xmath74 implies @xmath75 .",
    "let @xmath76 be the smallest index such that @xmath77 and , without loss of generality , suppose @xmath78 .",
    "then there exists @xmath79 such that @xmath80 , and hence @xmath81 .",
    "then we have @xmath82 , @xmath79 and @xmath78 . @xmath83",
    "the -freeproperty of @xmath23 then implies @xmath84 .",
    "thus we have @xmath85 and @xmath86",
    ". therefore @xmath87 and @xmath88 , where @xmath89 note that @xmath90 for @xmath91 . however , @xmath92 , but @xmath93 .",
    "also @xmath94 , but @xmath95 if @xmath96 .",
    "thus @xmath97 .",
    "hence there is a path of at most @xmath32 edges in @xmath71 between any pair of matchings @xmath98 .",
    "therefore the diameter of @xmath71 is at most  @xmath32 .",
    "computing the permanent exactly is known to be # p - complete for the class of chordal bipartite graphs  @xcite , though this result does not extend even to chordal bipartite graphs of bounded degree .",
    "the complexity of exact computation of the permanent is unknown for all the subclasses of chordal bipartite graphs considered below .",
    "that is , with the exception of bounded - degree _ convex graphs _ , which we consider in section  [ sec : convex ] below , and _ chain graphs _ , which we examine in section  [ sec : chain ] .",
    "the largest class of graphs considered by diaconis , graham and holmes  @xcite were those with `` two - sided restrictions '' .",
    "these are bipartite graphs @xmath25 for which @xmath23 has the _ consecutive  1 s _ property .",
    "these have been called _ convex _ graphs in the graph theory literature .",
    "they were introduced by glover  @xcite , who gave a simple greedy algorithm for finding a maximum matching in such a graph .",
    "the consecutive  1 s property can be recognised in @xmath65 time by the well - known algorithm of booth and lueker  @xcite .",
    "a bipartite graph is _ convex _ if it is isomorphic to a graph @xmath22\\cup[n]',e)$ ] such that @xmath99 is an interval @xmath100 \\subseteq [ n]'$ ] for all @xmath101 $ ] . note that this property remains true under an arbitrary permutation of @xmath15 $ ] .",
    "then    [ med : lem003 ] convex graphs are a proper hereditary subclass of chordal bipartite graphs .",
    "it is easy to see that the class convex is hereditary . to see that it is a subclass of chordal bipartite graphs , we permute rows so that @xmath102 when @xmath103 .",
    "now we can show that @xmath23 is -free .",
    "if not , there is a in some rows @xmath104 and columns @xmath105 .",
    "@xmath106 we have @xmath103 but , since the rows of @xmath23 have consecutive  1 s , @xmath107 .",
    "this contradicts our ordering of the rows of @xmath23 . to see that it is a proper subclass , note that there are at most @xmath108 labelled convex graphs with @xmath32 rows and columns , whereas spinrad  @xcite has shown that there are @xmath109 chordal bipartite graphs .",
    "( spinrad also gives in ( * ? ? ?",
    "9.16(c ) ) an explicit example of a graph that is chordal bipartite but not convex . )    it is possible to give excluded subgraph and excluded submatrix characterisations of convex graphs , but we will not explore this here , since they are not easy to describe , and appear to have little algorithmic application . see  @xcite for details .",
    "blumberg  @xcite gave an @xmath110 bound on the mixing time of the switch chain for convex graphs with @xmath111}\\deg(i)$ ] .",
    "this is a hereditary subclass of convex graphs , since it is easy to see that graphs with bounded row- or column - degree form a hereditary subclass of any hereditary class",
    ". we will give _ exact _ algorithms for counting and sampling in this subclass of convex graphs .",
    "first we will show that these graphs also have bounded column degree .",
    "[ med : lem004 ] let @xmath45 \\cup [ n]',e)$ ] be a convex graph containing a perfect matching .",
    "let @xmath111}\\deg(i)$ ] and @xmath112}\\deg(j')$ ]",
    ". then we have @xmath113 .",
    "let @xmath36 be any perfect matching of @xmath25 .",
    "we first permute the rows of @xmath23 so that @xmath36 is the diagonal of @xmath114 , i.e. @xmath115\\}$ ] . to bound @xmath116 ,",
    "consider any edge @xmath117 .",
    "since @xmath25 is convex , and @xmath118 , we have @xmath119 $ ] and so @xmath120 .",
    "hence @xmath121\\cap[n]$ ] , and so @xmath122\\cap[n]$ ] .",
    "therefore we have @xmath113 .",
    "it is known that there is an exact algorithm for computing the permanent which is linear in @xmath32 for all graphs of bounded _",
    "treewidth _",
    "* thm .  1 ) .",
    "convex graphs with @xmath111}\\deg(i)$ ] have treewidth at most @xmath123 .",
    "unfortunately , the general algorithm of courcelle , makowsky and rotics  @xcite is superexponential in the treewidth .",
    "an algorithm of frer  ( * ? ? ?",
    "3 ) , for counting independent sets in graphs of bounded treewidth , could also be applied , since the treewidth of the line graph of a convex graph can be bounded by @xmath124 .",
    "( we will not prove these facts about treewidth here , since we do not use them . )",
    "combined with frer s algorithm , this gives an algorithm for the permanent which is linear in @xmath32 , but exponential  in  @xmath125 .",
    "however , we will not use either of these approaches , since the following dynamic programming algorithm has better time complexity for the problem at hand .",
    "[ med : lem005 ] let @xmath45 \\cup [ n]',e)$ ] be a convex graph containing a perfect matching , and let @xmath111}\\deg(i)$ ] .",
    "then , for any subgraph @xmath126 of @xmath25 , the permanent of @xmath127 can be evaluated exactly in time @xmath128 .",
    "hence the permanent can be evaluated in polynomial time for all convex graphs with degree bound @xmath129 .",
    "let @xmath130 .",
    "the algorithm uses triangular windows @xmath131 of width @xmath132 and height @xmath132 , with corners at @xmath133 , @xmath134 and @xmath135 .",
    "note , from lemma  [ med : lem004 ] , that @xmath131 cuts @xmath25 as shown below .",
    "moreover , for every edge of @xmath25 there is an index @xmath5 such that the corresponding entry of @xmath114 appears in the window @xmath131 .    at iteration @xmath5 of the algorithm ,",
    "a _ subperfect _",
    "matching @xmath136 will be a matching of @xmath126 , such that    1 .",
    "every row @xmath137 has a matching edge ; 2 .",
    "every column @xmath138 has a matching edge ; 3 .",
    "no row @xmath139 has a matching edge ; 4 .",
    "no column @xmath140 has a matching edge .",
    "note that a subperfect matching can not always be extended to a perfect matching of @xmath126 .",
    "we consider the set @xmath141 note that @xmath142 , since each column of @xmath131 is either empty or contains a unique edge in any of positions @xmath143 , for @xmath144 . for @xmath145 , let @xmath146 be the number of subperfect matchings represented by @xmath36 .",
    "initially , @xmath147 and @xmath148 will be the set of all matchings in @xmath149 such that every vertex @xmath150 has a matching edge .",
    "when @xmath151 , all the subperfect matchings represented in @xmath152 will be perfect matchings , and so we will have @xmath153 we must show how to update the @xmath36 and @xmath154 from @xmath131 to @xmath155 .",
    "let @xmath156 .",
    "first we remove row @xmath5 .",
    "we remove all @xmath145 such that row @xmath5 contains no matching edge , since they can not correspond to a subperfect matching at iteration @xmath157 .",
    "then we delete the matching edge in row @xmath5 from @xmath36 , for all @xmath145 .",
    "this will produce a set @xmath158 of matchings in @xmath159 , @xmath160 we must now add column @xmath161 to @xmath155 . for all @xmath162",
    ", we attempt to augment each @xmath163 with a matching edge @xmath164 in column @xmath161 .",
    "note that @xmath164 must be in @xmath155 , and @xmath164 can be in any row which has no matching edge in @xmath163 .",
    "if no such row exists , we delete @xmath163 from @xmath158 , since it can not correspond to a subperfect matching at iteration @xmath165 .",
    "otherwise , for each possible choice of @xmath164 , we add @xmath166 to @xmath167 , and set @xmath168 this completes the description of the algorithm .",
    "the operations in the update require @xmath169 time , except for the removal of duplicates , which can be implemented in @xmath170 time .",
    "therefore , since @xmath171 and @xmath172 updates must be performed , the overall time complexity of the algorithm is @xmath128 .",
    "this is polynomial in @xmath32 if @xmath173 .",
    "we can extend the algorithm of lemma  [ med : lem005 ] to sample a matching uniformly at random . to do this",
    ", we must retain the sets @xmath174 and the counts @xmath154 ( @xmath145 ) used in the permanent evaluation .",
    "then the sampling algorithm is a standard dynamic programming traceback through @xmath175 ,   ,  @xmath174 ,   ,  @xmath148 , using the @xmath154 to select matchings with the correct probability .",
    "see  @xcite for a more complete description of similar uses of traceback sampling .",
    "the time complexity for sampling a single matching is @xmath176 .",
    "thus dynamic programming is superior to markov chain sampling for convex graphs with small degree bound , at least if the chain must be run for its a guaranteed mixing time .",
    "diaconis , graham and holmes  @xcite considered the following subclass of convex graphs .",
    "a graph @xmath22\\cup[n]',e)$ ] is _ biconvex _ if it is convex and @xmath177 is an interval @xmath178\\subseteq [ n]$ ] for all @xmath179'$ ] .",
    "thus @xmath23 has the consecutive  1 s property for both rows and columns .",
    "[ med : lem006 ] biconvex graphs are a proper hereditary subclass of convex graphs .",
    "it is easy to see that the class biconvex is a hereditary subclass of convex . to see that it is a proper subclass ,",
    "consider the example : @xmath180 in a biconvex ordering , row 2 must be adjacent to row 1 and row 3 .",
    "otherwise , columns @xmath181 and @xmath182 can not be convex .",
    "but row 4 must also be adjacent to row 2 , or column @xmath183 can not be convex .",
    "these conditions clearly can not be satisfied simultaneously .",
    "as with convex graphs , it is possible to give excluded subgraph and excluded submatrix characterisations of biconvex graphs . since these are a little easier to describe than for convex graphs , we will give the excluded subgraph characterisation .",
    "tucker shows  ( * ? ? ?",
    "10 ) that a bipartite graph is biconvex if and only if it does not contain the graphs @xmath184 for @xmath185 , @xmath186 , @xmath187 , @xmath188 , @xmath189 and @xmath190 as induced subgraph . here",
    "@xmath184 is a chordless cycle @xmath191 , @xmath186 is the _ triomino _ and @xmath188 is the _",
    "tripod_.    ( 2,4 ) node ( 1b ) ( 0,4 ) node ( 1w ) ( 0,2 ) node ( 2b ) ( 0,0 ) node ( 2w ) ( 2,0 ) node ( 3b ) ( 4,0 ) node ( 3w ) ( 4,2 ) node ( 4b ) ( 2,2 ) node ( 4w ) ; ( 1b ) ",
    "( 2w )  ( 3b ) ",
    "( 3w )  ( 4b ) ",
    "( 1b ) ; ( 2b ) ",
    "( 4w )  ( 3b ) ;    ( 0,0.5 ) node ( c ) ( 0.86,0.25 ) node ( a1 ) ( 1.73,0 ) node ( a2 ) ( -0.86,0.25 ) node ( b1 ) ( -1.73,0 ) node ( b2 ) ( 0,1.25 ) node ( c1 ) ( 0,2 ) node ( c2 ) ; ( b2)(b1)(c)(a1)(a2 ) ( c)(c1)(c2 ) ;    ( 0,1 ) node ( 1b ) ( 0,3 ) node ( 1w ) ( 2,3 ) node ( 2b ) ( 3,4 ) node ( 2w ) ( 4,3 ) node ( 3b ) ( 6,3 ) node ( 3w ) ( 6,1 ) node ( 4b ) ( 4,1 ) node ( 4w ) ( 3,0 ) node ( 5b ) ( 2,1 ) node ( 5w ) ; ( 1b ) ",
    "( 2w )  ( 3b ) ",
    "( 3w ) ; ( 3w )  ( 4b ) ",
    "( 1b ) ; ( 2b ) ",
    "( 4w )  ( 3b ) ",
    "( 2b ) ;    ( 6,4 ) node ( 1b ) ( 4,4 ) node ( 1w ) ( 2,4 ) node ( 2b ) ( 0,2 ) node ( 2w ) ( 2,0 ) node ( 3b ) ( 4,0 ) node ( 3w ) ( 6,0 ) node ( 4b ) ( 6,2 ) node ( 5b ) ( 4,2 ) node ( 5w ) ; ( 1b )  ( 1w ) ",
    "( 2w )  ( 3b ) ",
    "( 4b ) ; ( 2b ) ",
    "( 3b ) ( 5w )  ( 5b ) ;    ( 6,4 ) node ( 1b ) ( 4,4 ) node ( 1w ) ( 2,4 ) node ( 2b ) ( 0,4 ) node ( 2w ) ( 0,2 ) node ( 3b ) ( 0,0 ) node ( 3w ) ( 2,0 ) node ( 4b ) ( 4,0 ) node ( 4w ) ( 6,0 ) node ( 5b ) ( 2,2 ) node ( 6w ) ( 4,2 ) node ( 6b ) ; ( 1b )  ( 1w )  ( 2b )  ( 2w )  ( 3b )  ( 3w )  ( 4b )  ( 4w )  ( 5b ) ; ( 2b )  ( 6w )  ( 4b ) ( 3b )  ( 6w )  ( 6b ) ;    we know that the switch chain converges eventually on biconvex graphs , but how quickly is this guaranteed to occur ? unfortunately , the convergence may be exponentially slow .",
    "both matthews  @xcite and blumberg  @xcite gave the following examples @xmath192\\cup[n]',\\mathscr{e}_k{\\hspace*{0.5pt}}\\big)$ ] , where @xmath193 : @xmath194                    i= k\\mbox {   and } 1'\\leq j'\\leq n ' ; \\\\[0.5ex ]                    k < i \\leq n \\mbox {   and } ( i - k)'\\leq j'\\leq k ' .",
    "\\end{array }                \\right.\\ ] ] for example , @xmath195 is @xmath196",
    "let @xmath38 be any perfect matching . then choosing @xmath197 forces @xmath198 for @xmath199 $ ] , and similarly choosing @xmath200 forces @xmath201 for @xmath199 $ ] .",
    "thus the set of perfect matchings of @xmath202 is @xmath203 , where @xmath204 and @xmath205 .    clearly @xmath206 , for a single matching @xmath18 .",
    "moreover , it is not difficult to show that there are @xmath207 ways to extend a partial matching @xmath38 with @xmath198 for @xmath199 $ ] to a perfect matching .",
    "one way is to note that the submatrix induced by rows @xmath208 $ ] and columns @xmath209'$ ] is a _ chain graph _ , for which the permanent is easy to compute .",
    "( see section  [ sec : chain ] below and the formula presented there . )",
    "thus @xmath210 and @xmath211 , and hence @xmath212 .    therefore ,",
    "if the switch chain is started at a random matching in @xmath148 , it will need @xmath213 time before it reaches @xmath18 , and it can not enter @xmath214 before this occurs .",
    "this gives an @xmath213 lower bound on the mixing time of the chain .",
    "this argument can be made completely rigorous , see  @xcite or  @xcite , but we will not do so here .",
    "diaconis , graham and holmes  @xcite considered a structured subclass of biconvex graphs , which they called _ monotone _ , and showed that the switch chain is ergodic on monotone graphs .",
    "however , note that lemma  [ med : lem001 ] gives a stronger result for the larger class of chordal bipartite graphs .",
    "diaconis , graham and holmes  @xcite conjectured further that the switch chain mixes rapidly in the class monotone .    a bipartite graph @xmath22\\cup[n]',e)$ ] will be called _ monotone _ if it is isomorphic to a convex graph such that @xmath215 and @xmath102 for all @xmath216 $ ] with @xmath103 .",
    "thus @xmath23 has a `` staircase '' structure .",
    "an example is shown in fig .",
    "[ med : fig012 ] .",
    "we will always assume that @xmath25 has the labelling of the definition , unless otherwise stated .",
    "first we show that , if @xmath25 is row - monotone , it is also column - monotone .",
    "[ med : lem007 ] a monotone graph is biconvex , and @xmath217 , @xmath218 if @xmath219'$ ] and @xmath220",
    ".    for @xmath221 $ ] , let @xmath222 and @xmath223 . if @xmath224 , then @xmath225 and @xmath226 , so @xmath227={\\mathcal{n}}(i)$ ] and hence @xmath228 .",
    "thus @xmath177 is the interval @xmath229 $ ] , so we may take @xmath230 , @xmath231 .",
    "hence @xmath232\\}$ ] and @xmath233\\}$ ] , so @xmath220 implies @xmath217 .",
    "similarly @xmath220 implies @xmath218 .",
    "next we show a `` forbidden submatrix '' characterisation of monotone graphs , extending that of lubiw  @xcite for chordal bipartite graphs .",
    "[ med : lem008 ] a bipartite graph is monotone if and only if it is isomorphic to a graph @xmath25 such that @xmath23 has none of the following as an induced @xmath234 submatrix :    @xmath235 ,    @xmath236 ,    @xmath237 .",
    "suppose @xmath25 is monotone , but @xmath114 contains or in rows @xmath5 and @xmath238 , with @xmath103 .",
    "then row - convexity implies @xmath239 , a contradiction .",
    "similarly , if @xmath23 contains a @xmath240 ( 0,0)--(1,0)--(1,1.5);}{\\hspace*{0.5pt}}}\\xspace}$ ] , then row - convexity implies @xmath241 , again a contradiction .",
    "thus , if @xmath25 is a monotone graph , @xmath23 can not contain , or .",
    "now assume @xmath23 contains no ,  or .",
    "suppose @xmath99 is not an interval , so there exist @xmath242 so that @xmath243 , but @xmath244 . since @xmath245 , there exists @xmath246 $ ] such that @xmath247 .",
    "if @xmath248 , then @xmath23 contains the first configuration below , which is either a  or a , a contradiction . if @xmath249 , then @xmath23 contains the second configuration below , which is either a  or a , also a contradiction",
    "@xmath250 @xmath251    therefore suppose that @xmath103 , but @xmath241 .",
    "then @xmath23 contains the first configuration below , which is a  or , a contradiction .",
    "similarly , if @xmath239 , @xmath23 contains the second configuration below , which is a  or , again a contradiction .",
    "hence @xmath25 is monotone .",
    "@xmath252 @xmath253    a _ bipartite permutation graph _ is a _ permutation graph _ which is also bipartite .",
    "a graph @xmath9 is a permutation graph if there are permutations @xmath254 of @xmath14 so that @xmath255 if and only if @xmath256 and @xmath257 .",
    "this can be given an _ intersection _",
    "presentation , where @xmath254 are on parallel lines , and connected by lines @xmath258 , for all @xmath259 . then @xmath11 if and only if corresponding lines @xmath258 and @xmath260 cross .",
    "spinrad , brandstdt and stewart  @xcite studied this class of graphs , and gave @xmath65 time algorithms for recognising membership in the class , and for constructing a crossing representation .",
    "an example is shown in fig .",
    "[ med : fig003 ] below .",
    "+    our reason for introducing this class of graphs is that the bipartite permutation graphs are precisely the monotone graphs .",
    "[ med : lem009 ] a graph is monotone if and only if it is a bipartite permutation graph .",
    "the condition of lemma  [ med : lem008 ] is equivalent to the following . if @xmath261 are such that @xmath103 and @xmath262 , then @xmath263 , @xmath264 .",
    "the conclusion now follows from the characterisation of bipartite permutation graphs given in  @xcite , in particular definition  3 and theorem  1 .",
    "note that lemma  [ med : lem008 ] is not a `` forbidden subgraph '' characterisation in the usual graph - theoretic sense .",
    "however , such a characterisation is known .",
    "[ med : lem010 ] a graph is monotone if and only if it is chordal bipartite ( i.e.  it has no chordless cycle of length other than 4 ) , and it contains none of the three graphs shown in fig .",
    "[ med : fig004 ] as an induced subgraph .",
    "( 0:0 ) node[fill = black ] ( c ) ( -30:1 ) node ( a1 ) ( -30:2 ) node[fill = black ] ( a2 ) ( 90:1 ) node ( b1 ) ( 90:2 ) node[fill = black ] ( b2 ) ( 210:1 ) node ( c1 ) ( 210:2 ) node[fill = black ] ( c2 ) ; ( a2)(a1 ) ( b1)(c)(a1 ) ( c)(c1 ) ( b2)(b1 ) ( c2)(c1 ) ;    ( 2,0 ) node[fill = black ] ( a ) ( 0,0 ) node ( b ) ( 2,0.75 ) node ( c ) ( 0,0.75 ) node[fill = black ] ( d ) ( 2,1.5 ) node[fill = black ] ( e ) ( 0,1.5 ) node ( f ) ( 0,3 ) node[fill = black ] ( g ) ; ( g)(f)(e)(c)(d)(b ) ( a)(c ) ( d)(f ) ;    ( 0,0 ) node ( a ) ( 1,0 ) node[fill = black ] ( b ) ( 2,0 ) node ( c ) ( 0,1 ) node[fill = black ] ( d ) ( 1,1 ) node ( e ) ( 2,1 ) node[fill = black ] ( f ) ( 1,3 ) node[fill = black ] ( g ) ; ( a)(b)(c)(f)(e)(d)(a ) ( b)(e)(g ) ;     +    for example , the graph @xmath25 given in fig .",
    "[ med : fig005 ] contains the armchair as a subgraph .",
    "[ med : lem011 ] monotone graphs are a proper hereditary subclass of biconvex graphs .",
    "the hereditary property follows easily from the definitions .",
    "the inclusion follows from lemma  [ med : lem007 ] , and strict inclusion follows from the example of fig .",
    "[ med : fig005 ] .",
    "to apply the switch chain to a monotone graph , we need to know whether it contains any perfect matching .",
    "if it does , we need to identify one efficiently , in order to start the chain",
    ". however , these are easy questions .    [ med : lem012 ] a monotone graph @xmath45\\cup[n]',e)$ ] contains a perfect matching if and only if it contains the _ diagonal matching _ @xmath265\\}$ ] .",
    "we prove this by induction on @xmath32 .",
    "if @xmath266 , @xmath267 , and there is nothing to prove .",
    "so , suppose @xmath268 .",
    "clearly @xmath269 , or else either @xmath34 or @xmath181 is an isolated vertex , and hence @xmath25 has no perfect matching .",
    "we will show that there is a perfect matching @xmath163 which contains @xmath270 . therefore , suppose that @xmath36 is any perfect matching in @xmath25 , with @xmath271 .",
    "then @xmath272 for some @xmath273 , @xmath274 , and we have @xmath269 .",
    "hence @xmath27 , or else @xmath23 would contain a .",
    "@xmath275{\\draw ( 0,0 ) node[rectangle , line width=0.5pt , inner sep=1pt , fill = none , minimum size=4mm , anchor = base ] ( char ) { 1};}}\\\\      i &   { \\tikz[baseline=(char.base)]{\\draw ( 0,0 ) node[rectangle , line width=0.5pt , inner sep=1pt , fill = none , minimum size=4mm , anchor = base ] ( char ) { 1 } ; } } & ? } \\vspace{1ex}\\ ] ] thus @xmath276 is a perfect matching containing the edge @xmath270 .",
    "now we use induction on the graph @xmath126 given by deleting @xmath34 and @xmath181 from @xmath25 , which contains the perfect matching @xmath277",
    ".    we will be particularly interested in _ hamiltonian _ monotone graphs , and there is also an easy criterion for hamiltonicity of a monotone graph . to state this , we consider the graph illustrated below , the _ ladder _ @xmath278 .",
    "[ med : lem013 ] @xmath278 is a hamiltonian monotone graph .",
    "clearly @xmath278 is bipartite , and @xmath279 , @xmath280 , @xmath281 ,  , @xmath282 , @xmath283 are , respectively , @xmath284 so are non - empty intervals satisfying the required ordering conditions .",
    "finally , @xmath278 has the hamilton cycle @xmath285",
    ".    then we have the following .    [ med : lem014 ] a monotone graph @xmath25 is hamiltonian if and only if it contains the ladder as a spanning subgraph .",
    "if @xmath25 has a spanning ladder , the hamilton cycle in the ladder is also a hamilton cycle in @xmath25 , and so @xmath25 is hamiltonian .",
    "if @xmath22\\cup[n]',e)$ ] is hamiltonian , it has a perfect matching , so @xmath31 and @xmath25 contains the diagonal matching @xmath286 , from lemma  [ med : lem012 ] .",
    "we will show by induction that @xmath25 contains @xmath278 , and so has a spanning ladder .",
    "the base case is @xmath287 .",
    "then @xmath25 must be a 4-cycle , so @xmath288 .    if @xmath289 , consider any hamilton cycle @xmath290 in @xmath25 . vertices @xmath34 and @xmath181 lie on this cycle",
    ". there are two cases :    1 .   the cycle @xmath290 contains the edge @xmath270 .",
    "let @xmath291 be adjacent on @xmath290 to @xmath34 , and @xmath292 be adjacent on @xmath290 to @xmath181 . since @xmath293 , biconvexity implies @xmath294 and @xmath295 .",
    "thus the three edges @xmath270 , @xmath296 , @xmath297 of @xmath278 are in @xmath33 .",
    "also @xmath27 , since @xmath25 is -free .",
    "hence @xmath298 is a hamilton cycle @xmath299 in the monotone graph @xmath126 obtained by deleting @xmath34 and @xmath181 from @xmath25 .",
    "2 .   the cycle @xmath290 does not contain the edge @xmath269 .",
    "let @xmath300 be the vertices of @xmath290 adjacent to @xmath34 , and @xmath301 the vertices of @xmath290 adjacent to @xmath181 , so that @xmath290 contains paths @xmath302 and @xmath303 , avoiding @xmath34 and @xmath181 .",
    "now , since @xmath25 is -free , @xmath304 . since @xmath269 , and @xmath305 for @xmath306 , convexity implies that @xmath294 .",
    "similarly , since @xmath307 , with @xmath273 , convexity implies that @xmath295 .",
    "thus the three edges @xmath270 , @xmath296 , @xmath297 of @xmath278 are in @xmath33 .",
    "also @xmath308 is a hamilton cycle @xmath299 in the monotone graph @xmath126 obtained by deleting @xmath34 and @xmath181 from @xmath25 .    in both cases ,",
    "the edges @xmath270 , @xmath296 , @xmath297 of @xmath278 are in @xmath33 , and we have a hamiltonian monotone graph @xmath126 with bipartition @xmath309\\cup[2,n]'$ ] .",
    "it now follows by induction that @xmath25 contains @xmath278 .",
    "diaconis , graham and holmescalled the simplest class of graphs they considered `` one - sided restriction '' graphs .",
    "these are usually called _ chain graphs _ in the graph theory literature  @xcite , and form a proper subclass of monotone graphs .",
    "a chain graph is isomorphic to a graph @xmath22\\cup[n]',e)$ ] where @xmath310'$ ] for all @xmath311 $ ] , with @xmath312 .",
    "hence chain graphs are a subclass of monotone graphs , given by taking @xmath313 , @xmath314 , for all @xmath315 $ ] .",
    "an example is shown in fig .",
    "[ med : fig015 ] .",
    "the following easy fact is then true .",
    "[ med : lem002 ] @xmath316 $ ] for all @xmath317'$ ] with @xmath318 .",
    "since @xmath319 , @xmath27 implies @xmath320 .",
    "let @xmath321 .",
    "we note here that chain graphs have a very simple excluded subgraph characterisation .",
    "a bipartite graph is a chain graph if and only if it does not contain @xmath322 , the graph with four vertices and two disjoint edges , as an induced subgraph .",
    "[ lem : chainvsmonotone ] chain graphs are a proper hereditary subclass of monotone graphs .",
    "the hereditary property and the inclusion are clear from the definition .",
    "the inclusion is strict because a chain graph is a monotone graph with @xmath313 for all @xmath315 $ ] .",
    "hence the biadjacency matrix contains a column of 1 s . but there exist monotone graphs which do not have a column of 1 s . the graph in fig .",
    "[ med : fig012 ] is an example .",
    "diaconis , graham and holmes  @xcite observed that there is a `` classical '' explicit formula for the permanent of a chain graph @xmath25 .",
    "of course , we must have @xmath31 . then , if @xmath43 , @xmath323 $ ; } \\\\                         \\prod_{i=1}^n ( a_i - i+1 ) , & \\hbox{otherwise . }",
    "\\end{array }                     \\right.\\ ] ] for example , if @xmath324 after noting that the first @xmath325 columns of @xmath114 are all 1 s , and hence identical , this formula can be proved by an easy induction on the row order .",
    "the proof method can also be used to sample a perfect matching uniformly at random in @xmath172 time .",
    "matthews  @xcite showed , using a coupling argument , that the mixing time of the switch chain for chain graphs is bounded by @xmath326 .",
    "blumberg  @xcite gave a detailed study of the eigenvalues of the transition matrix of the switch chain for this class , based on earlier work of hanlon  @xcite .",
    "these results clearly have little computational application , but establishing the mixing time of the switch chain for graphs in the the class chain is far from trivial .",
    "for example , there are chain graphs for which the original jerrum and sinclair markov chain  @xcite has exponential mixing time .",
    "consider the graph @xmath25 for which @xmath23 is lower triangular , so @xmath327 if @xmath328 , @xmath329 otherwise .",
    "then @xmath330 , from the formula above , but the graph @xmath126 given by deleting vertices @xmath34 and @xmath331 has @xmath332 by the same formula , where @xmath333 .",
    "thus @xmath25 has one perfect matching , but an exponential number of near - perfect matchings .",
    "therefore the algorithm of  @xcite will need exponential time to sample a perfect matching almost uniformly .",
    "in section  [ sec : classes ] we have seen that the hereditary graph classes considered by diaconis , graham and holmes  @xcite form an ascending sequence : @xmath334 we know from lemma  [ med : lem001 ] that the switch chain is ergodic for ( balanced ) bipartite graphs in all these classes , and has diameter at most @xmath32 .",
    "here we consider the mixing time of the switch chain for these classes , that is , the time required to reach near - stationarity .",
    "we will define this more formally below .    here",
    "we take the computer science viewpoint of trying to distinguish only between polynomial time ( rapid ) mixing , and superpolynomial time ( slow ) mixing .",
    "we have observed that the switch chain may have exponential mixing time in the class biconvex , and the switch chain has mixing time @xmath326 in the class chain  @xcite .",
    "therefore we need only determine whether or not the class monotone has polynomial mixing time .",
    "the remainder of this section will be devoted to showing that this class does indeed have polynomial mixing time .",
    "it is usual to measure deviation from the stationary distribution in terms of variation distance . for a ergodic markov chain on state space  @xmath335 , transition probabilities @xmath336 $ ] and stationary distribution  @xmath38 , the distance to stationary at time  @xmath47 , starting in state @xmath337 ,",
    "is @xmath338 .",
    "then the _ mixing time _ , @xmath339 ,",
    "is the first time at which the markov chain is @xmath340-close to stationarity , maximised over the choice of starting state  @xmath341 : @xmath342 two remarks about this definition .",
    "first , the function @xmath343 is monotonically non - increasing in  @xmath47 , so once the @xmath47-step distribution of the markov chain is @xmath340-close to stationarity , it remains that way .",
    "second , the dependence on of  @xmath344 on  @xmath340 is weak , typically a multiplicative factor @xmath345 , so it is usual to quote the mixing time as a function of the size of the problem instance , in our case  @xmath32 , and ignore the dependence on @xmath340 ( or set @xmath340 to some conventional value , usually @xmath346 ) . for",
    "more on mixing time , and the general context for this section of the paper , refer to ( * ? ? ?",
    "* chaps.3 &  4 ) and ( * ? ? ?",
    "* chaps.3 &  5 ) .",
    "although there are other approaches to bounding the mixing time of markov chains , here we will attempt only to apply the canonical paths approach of jerrum and sinclair  @xcite . for any symmetric markov chain , this may be described briefly as follows .",
    "suppose the problem size is @xmath32 .",
    "the method requires constructing paths of transitions of the chain @xmath347 , between every pair of states @xmath348 and @xmath349 in the state space @xmath335 , such that the length @xmath350 of each path is at most polynomial in @xmath32 .",
    "this is often easy to achieve , but to obtain a good upper bound on mixing time it is essential that the paths are `` spread out '' over the state space , and do not overload any particular transition .",
    "the degree of success in achieving this end is measured by the congestion of the set of paths .",
    "denote the ( canonical ) path from @xmath348 to @xmath349 by @xmath351 .",
    "then the congestion  @xmath352 of the chosen paths is given by @xmath353 where @xmath354 denotes the length of the path @xmath351 , and the maximisation is over all transitions @xmath355 , i.e. , all pairs with @xmath356 and @xmath357 , and the sum is over all paths that use the transition @xmath355 .",
    "polynomial mixing time will follow from a polynomial upper bound on congestion . for the switch markov chain , where @xmath38 is uniform over @xmath335",
    ", it can be seen from the definition of @xmath352 that this is equivalent to ensuring that the number of canonical paths through any transition is bounded by @xmath358 , possibly multiplied by a polynomial factor . a possible strategy for obtaining a good bound on congestion",
    "is therefore the following . fix a transition @xmath355 . for",
    "every canonical path @xmath351 from @xmath348 to  @xmath349 that uses transition @xmath359 , specify an _ encoding _ @xmath360 , such that , given @xmath361 and @xmath362 additional bits of information , we can identify @xmath348 and @xmath349 uniquely .",
    "it is common to refer to the additional information as `` guesses '' . in this setting , the mixing time @xmath344 of the chain",
    "can be bounded by @xmath363 .",
    "ideally , we seek @xmath364 , since this will give a polynomial bound on the mixing time .",
    "the strategy just described is the one we will apply in this section to the switch chain on monotone graphs . in the proof of lemma",
    "[ med : lem001 ] we implicitly constructed canonical paths for the more general situation of chordal bipartite graphs .",
    "the counterexample @xmath365 from section  [ sec : biconvex ] demonstrates that the congestion of those canonical paths is in fact exponentially large , necessarily so even for biconvex graphs .",
    "achieving low congestion in the monotone setting is a delicate matter , and will be addressed in the following section .",
    "it only remains to present a precise relationship between congestion and mixing time , as given in  ( * ? ? ?",
    "* cor.5.9 ) , based on sinclair  @xcite .",
    "[ lem : mixvscongestion ] the mixing time of a symmetric markov chain with uniform stationary distribution is bounded by @xmath366 where @xmath352 is the congestion with respect to any set of canonical paths .",
    "technically , this result applies to a so - called `` lazy '' version of the markov chain , in which which a fair coin is flipped at each step .",
    "a transition is made if the coin comes up `` heads '' , and no transition is made if the coin comes up `` tails '' . in our case , the loop probabilities , which are at least @xmath66 , are sufficient to avoid the introduction of the lazy version .",
    "then the factor  2 could be saved in the mixing time bound , but we will not use this refinement .      our goal is to construct canonical paths between arbitrary pairs @xmath348 , @xmath349 of perfect matchings in  @xmath25 . in general , @xmath367 is a subgraph of @xmath25 that is composed of alternating cycles @xmath368 , and isolated edges @xmath369 .",
    "assume that these cycles are ordered deterministically in some way .",
    "( for example , order the cycles according to the smallest unprimed vertex in each cycle . )",
    "then we may switch each of the cycles in order , using the procedure we will describe below .",
    "the isolated edges can be left untouched .",
    "thus , it is sufficient to construct the canonical path for a single alternating cycle .",
    "in fact , we may specialise the canonical path construction even further . since monotone is a hereditary class ,",
    "if @xmath290 is any alternating cycle in @xmath25 , it is a hamilton cycle in a smaller monotone graph @xmath370 $ ] .",
    "thus we will assume that @xmath370=g$ ] in the remainder of this section , and let @xmath290 be the ( hamilton ) cycle with vertices @xmath371 .",
    "so our initial and final matchings are as follows : @xmath372 where we will choose @xmath373 as the initial vertex of the cycle .    with each pair @xmath374\\times[n]'$ ]",
    "( which may or may not correspond to an edge of  @xmath25 ) we associate a point @xmath375 in @xmath376 . in particular , we associate the edges in  @xmath348 with the points @xmath377\\}$ ] and those in  @xmath349 with points @xmath378\\}$ ] ( interpreting @xmath379 as @xmath380 ) .",
    "we can think of this mapping as assigning cartesian coordinates to the entries of the adjacency matrix @xmath23 in such a way that the pattern of entries plotted in @xmath376 looks exactly like the pattern of entries in the matrix @xmath23 as conventionally written : the @xmath341 coordinate increases with increasing column number , and the @xmath381-coordinate decreases with increasing row number .",
    "denote the @xmath341- and @xmath381-coordinates of point @xmath382 by @xmath383 and  @xmath384 , so that @xmath385 .",
    "let @xmath386 ^ 2 $ ] .",
    "the alternating ( hamilton ) cycle @xmath387 corresponds to the cyclic sequence @xmath388 of points .",
    "join the adjacent points in this sequence by line segments ( omitting the return segment from @xmath389 to @xmath390 ) to yield a continuous path  @xmath391 from @xmath390 to  @xmath389 .",
    "this path consists of alternating horizontal and vertical segments . by the choice @xmath373 for the initial vertex we have that @xmath392 , i.e. , that the path begins and ends at the lowest point ( corresponding to the final row of the matrix ) .",
    "somewhere along the way the path reaches the highest point @xmath393 ( corresponding to the first row of the matrix ) .",
    "the following lemma is inspired by the `` mountain climbing problem '' ( see , for example  @xcite ) , and is proved in the appendix .",
    "[ lem : climbing ] suppose @xmath391 is as above .",
    "there are continuous functions @xmath394\\to\\pi$ ] satisfying @xmath395 , @xmath396 , @xmath397 , @xmath398 , and @xmath399 for all @xmath400 $ ] .",
    "moreover the set of events @xmath401:\\focusa(t)\\in p\\text { or } \\focusb(t)\\in p\\big\\}\\ ] ] has cardinality at most @xmath402 .",
    "note that the trajectories of @xmath403 and @xmath404 will not , in general , move in a uniform sense along  @xmath391 : it may be necessary for either or both of @xmath403 and @xmath404 to retreat along  @xmath391 for periods in order to make progress later .    before entering into the details of the construction of canonical paths , here",
    "is a high - level overview .",
    "we regard the general points @xmath2 ^ 2 $ ] , the special points @xmath405 , and the path  @xmath391 as forming a _ board _ , on which we play out a game involving @xmath32  _ tokens_. movements of the tokens will mirror switches in the canonical path from @xmath348 to  @xmath349 . place the tokens initially on the points @xmath406 that represent the initial matching  @xmath348 .",
    "our aim is to move these @xmath32 tokens to the points @xmath407 in a manner consistent with switches in the original graph .",
    "thus , at each step , we will take two tokens and move them to new locations .",
    "note that the two tokens we choose form the endpoints of the diagonal of some axis - aligned rectangle , say  @xmath408 .",
    "we remove these tokens and replace them on the endpoints of the opposite diagonal of  @xmath408 . for this operation to represent a valid switch in the original graph ,",
    "it is necessary for the new locations for the tokens to correspond to 1 s in the matrix @xmath23 . ensuring that this happens at every step requires the tokens to be moved in a very particular order .",
    "describing this order is at the heart of the matter .",
    "we think of each of @xmath403 and @xmath404 as being a _ focus _ [ of activity ] . as time passes from from 0 to  1 , and points @xmath403 and @xmath404 trace out their trajectories along  @xmath391 , we shall move tokens in the neighbourhood of the foci according to certain rules .",
    "( refer to figure  [ fig : casei ] for a pictorial description of such a rule . )",
    "if we remove the points @xmath403 and @xmath404 from the path  @xmath391 , we separate @xmath391 into three connected pieces .",
    "denote the points in @xmath405 lying in the middle piece by  @xmath409 and the remaining points by @xmath410 .",
    "note that @xmath411 , except at events @xmath47 , when @xmath412 or @xmath413 .",
    "we shall ensure that tokens lying in @xmath414 are in their original locations ( i.e. , points of the form  @xmath415 ) , while those in @xmath416 are in their final locations ( i.e. , points of the form  @xmath417 ) .",
    "as time passes , @xmath418 tends to increase in size and @xmath419 tends to decrease , corresponding to tokens passing from the initial points @xmath420 to the final points @xmath421 .    the arrangement of tokens on the board at time  @xmath47 ( viewed as a subset of points in @xmath2 ^ 2 $ ] )",
    "will be called the _ configuration _ of tokens and denoted @xmath422 . as we want @xmath18 to correspond to a perfect matching in  @xmath25",
    ", we insist that it contain one point from every row @xmath423 $ ] of the board and one point from every column @xmath424 $ ] . in what follows",
    ", it may be worth bearing in mind the basic underlying strategy , which is to keep the tokens as far as possible on the points  @xmath405 .",
    "if this can done effectively , it will be possible to provide an encoding of the current state ( in the sense described of the previous section  [ sec : paths ] ) by forming a perfect matching  @xmath361 guided by the points of @xmath405 that are not in the current configuration  @xmath18 .",
    "as the foci trace out their trajectories , there will be periods ( open time intervals ) when both @xmath403 and @xmath404 are both on ( open ) vertical segments , and during these periods @xmath425 and @xmath426 are either both monotonically increasing or both monotonically decreasing ; call these _ v - periods_. the v - periods are separated by _ h - periods _ , closed time intervals during which one of @xmath403 or  @xmath404 is stationary and the other is moving horizontally . during v - periods , @xmath427 is constant and well defined , in a manner that will be explained presently .",
    "we do not examine the configuration during h - periods , so its definition there is not important ; one could decree , e.g. , that the configuration there is the same as during the previous v - period .    during a v - period ,",
    "neither @xmath403 nor @xmath404 is a member of  @xmath405 ; as a consequence , @xmath411 , so that every point in  @xmath405 is assigned either to @xmath418 or @xmath419 .",
    "so assume that @xmath403 and @xmath404 are both on ( open ) vertical segments .",
    "for convenience we introduce a local naming scheme around @xmath403 and @xmath404 .",
    "denote by @xmath325 and @xmath428 the lower and upper ends of the line segment containing  @xmath403 .",
    "continue the numbering @xmath429 along the path  @xmath391 as far as necessary ; this convention provides a local numbering of some subsequence of @xmath430 , or its reversal . in a similar way ,",
    "introduce names for the points around @xmath404 , with @xmath431 and @xmath432 being the lower and upper ends of the line segment containing @xmath404 .",
    "suppose @xmath433 ^ 2 $ ] is a configuration of tokens .",
    "hole - pair _ is a pair @xmath290 of adjacent points @xmath434 or @xmath435 of  @xmath405 such that @xmath436 . as the foci move",
    ", we attempt to maintain the following invariant  i , which is a conjunction of i1i3 :    1 .",
    "@xmath437 is a hole - pair .",
    "2 .   if @xmath438 then @xmath439 is a hole - pair ; otherwise @xmath440 is a hole - pair .",
    "3 .   the are no hole - pairs beyond these two .",
    "a number of consequences follow from i1i3 : ( i )  @xmath427 is completely determined by @xmath403 and @xmath404 , ( ii )  @xmath441 , ( iii )  @xmath442 , and ( iv )  @xmath443 .",
    "( starting from a hole - pair , and working around @xmath391 , successive points in  @xmath405 are forced to be alternately in and out of  @xmath18 ; this demonstrates  ( i ) , and the other conclusions follow as byproducts of this argument . )",
    "invariant  i may fail after a token - switch , but when this happens it will be immediately reinstated at the following switch",
    ". there will generally be a single token ( and exceptionally three ) lying outside @xmath405 ( i.e. , @xmath444 or exceptionally @xmath445 ) .",
    "the position of such a token(s ) will be called a _ dislocation _ , and is denoted @xmath446 ( or @xmath447 or  @xmath448 ) in figures  [ fig : casei][fig : caseiv ] below .",
    "initially @xmath449 so invariant  i will certainly not be satisfied at the outset .",
    "a similar remark applies to the final configuration @xmath450 .",
    "we will see how to finesse this issue later . for the time being , we assume that we are under way , that invariant  i is satisfied , and that @xmath47 is in a v - period , so that @xmath403 and @xmath404 are on vertical line segments @xmath451 and @xmath452 . we assume first that @xmath403 ( and hence @xmath404 ) is moving upwards , i.e. , that the rate of change of @xmath425 is positive .",
    "( it transpires that the situation when @xmath403 is moving downwards creates little extra work , as it can be handled by symmetry , specifically by rotating the board through an angle  @xmath38 .",
    "more detail will be provided immediately after we have dealt with the focus - moving - upwards situation . )",
    "depending on the ordering of @xmath453 and @xmath454 one of two events occurs first : either @xmath455 ( an @xmath456-event ) or @xmath457 ( a @xmath458-event ) .",
    "we consider the situation just before this event and just after , and , in particular , what action needs to be taken to maintain the invariant .",
    "( by `` just after '' here , we mean `` at a point in time just after the start of the next v - period '' . )    we proceed by case analysis .",
    "there are eight cases i  iv and i*iv*. first we split on whether @xmath438 ( cases i and ii ) or @xmath459 ( cases iii and iv ) , i.e. , on the horizontal relationship between @xmath403 and @xmath404 before the event .",
    "then we split on whether @xmath460 ( cases i and iii ) or @xmath461 ( cases ii and iv ) , i.e. , on whether it is an @xmath456-event or a @xmath458-event that occurs .",
    "finally we split on whether @xmath403 and @xmath404 have the same horizontal relationship after the event ( unstarred cases ) or opposite ( starred cases ) .",
    "note that the eight cases i  iv * are exhaustive .",
    "we consider the eight cases in turn below .",
    "cases i and i * illustrate most of the issues , so we treat them in more detail ; the remaining cases will leave more for the reader . some shorthand terminology will be useful in describing these cases .",
    "let @xmath462 be points .",
    "we say that @xmath463 is _ to the left of _",
    "@xmath464 ( and @xmath464 is _ to the right of _",
    "@xmath463 ) if @xmath465 and @xmath466 .",
    "we say that @xmath463 is _ above _",
    "@xmath464 ( and @xmath464 is _ below _",
    "@xmath463 ) if @xmath467 and @xmath468 .    ( 1,0 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1.5 ) node [ notok ] ( a2 ) @xmath428 + + ( -1,0 ) node [ tok ] ( a3 ) @xmath469 + + ( 0,2 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 )  ( a2 )  ( a3 )  ( a4 ) ; ( 2,0.5 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2 ) node[notok ] ( b2 ) @xmath432 + + ( 1,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b1 )  ( b2 )  ( b3 ) ; ( 1,2.5 ) node[tok ] @xmath446 ; ( -0.5,1 )  ( 3.5,1 ) ; ( 3.7,0.8 )  ( 3.7,1.2 ) ; ( -0.7,0.8 )  ( -0.7,1.2 ) ; ( 1,1 ) node[focus ] ; ( 0.7,0.8 ) node[empty ] @xmath456 ; ( 2,1 ) node[focus ] ; ( 2.3,1.25 ) node[empty ] @xmath458 ; ( 4.5,1.5 ) node[empty ] @xmath472 ;    ( 1,0 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1.5 ) node [ tok ] ( a2 ) @xmath428 + + ( -1,0 ) node [ notok ] ( a3 ) @xmath469 + + ( 0,2 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 )  ( a2 )  ( a3 )  ( a4 ) ; ( 2,0.5 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2 ) node[notok ] ( b2 ) @xmath432 + + ( 1,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b1 )  ( b2 ) ",
    "( b3 ) ; ( 0,2.5 ) node[tok ] @xmath447 ; ( -0.5,2 )  ( 3.5,2 ) ; ( 0,2 ) node[focus ] ; ( 0.4,2.2 ) node[empty ] @xmath456 ; ( 2,2 ) node[focus ] ; ( 2.2,1.75 ) node[empty ] @xmath458 ;     + case i applies when @xmath438 , @xmath460 and @xmath473 .",
    "( 0,-0.5 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1.5 ) node [ notok ] ( a2 ) @xmath428 + + ( 3,0 ) node [ tok ] ( a3 ) @xmath469 + + ( 0,1.5 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 ) ",
    "( a2 )  ( a3 )  ( a4 ) ; ( 2,0 ) node[notok ] ( b0 ) @xmath474 + + ( -1,0 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2 ) node [ notok ] ( b2 ) @xmath432 + + ( 1.5,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b0 )  ( b1 )  ( b2 )  ( b3 ) ; ( 0,2 ) node[tok ] @xmath446 ; ( -0.5,0.5 )  ( 3.5,0.5 ) ; ( 3.7,0.3 )  ( 3.7,0.7 ) ; ( -0.7,0.3 ) ",
    "( -0.7,0.7 ) ; ( 0,0.5 ) node[focus ] ; ( -0.3,0.3 ) node[empty ] @xmath456 ; ( 1,0.5 ) node[focus ] ; ( 1.3,0.75 ) node[empty ] @xmath458 ; ( 4.5,1 ) node[empty ] @xmath472 ;    ( 0,-0.5 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1.5 ) node [ notok ] ( a2 ) @xmath428 + + ( 3,0 ) node [ notok ] ( a3 ) @xmath469 + + ( 0,1.5 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 ) ",
    "( a2 )  ( a3 )  ( a4 ) ; ( 2,0 ) node[notok ] ( b0 ) @xmath474 + + ( -1,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,2 ) node [ notok ] ( b2 ) @xmath432 + + ( 1.5,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b0 )  ( b1 )  ( b2 )  ( b3 ) ; ( 0,2 ) node[tok ] @xmath446 ; ( 1,1 ) node[tok ] @xmath448 ; ( 3,0 ) node[tok ] @xmath447 ; ( 0,0.5 ) node[focus ] ; ( -0.3,0.3 ) node[empty ] @xmath456 ; ( 1,0.5 ) node[focus ] ; ( 1.3,0.6 ) node[empty ] @xmath458 ; ( 4,1 ) node[empty ] @xmath472 ;    ( 0,-0.5 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1.5 ) node [ tok ] ( a2 ) @xmath428 + + ( 3,0 ) node [ notok ] ( a3 ) @xmath469 + + ( 0,1.5 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 )  ( a2 )  ( a3 )  ( a4 ) ; ( 2,0 ) node[notok ] ( b0 ) @xmath474 + + ( -1,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,2 ) node [ tok ] ( b2 ) @xmath432 + + ( 1.5,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b0 )  ( b1 )  ( b2 )  ( b3 ) ; ( 3,0 ) node[tok ] @xmath447 ; ( -0.5,1.5 )  ( 3.5,1.5 ) ; ( 3,1.5 ) node[focus ] ; ( 3.3,1.7 ) node[empty ] @xmath456 ; ( 1,1.5 ) node[focus ] ; ( 1.2,1.25 ) node[empty ] @xmath458 ;     + case i * applies when @xmath438 , @xmath460 and @xmath475 .",
    "_ case i. _ this case is characterised by @xmath438 , @xmath460 and @xmath473 .",
    "( refer to figure  [ fig : casei ] , which illustrates the layout of the board in the vicinity of the foci . ) in this figure and the later ones the conventions are as follows .",
    "the dotted - and - dashed line is @xmath476 and marks the current @xmath381-coordinate of the foci .",
    "points with tokens are grey / red and points without tokens are white .",
    "the `` before '' picture is to the left and the `` after '' to the right . the current location of the dislocation is marked  @xmath446 .",
    "note that @xmath446 must always be the intersection of the vertical line through @xmath325 and @xmath428 , and either the horizontal line through @xmath474 and @xmath431 , or through @xmath432 and @xmath471 , as appropriate ; this is a consequence of the fact that the board contains a token on every horizontal and vertical line .",
    "the action to be taken in this case is to switch the tokens at @xmath469 and  @xmath446 .",
    "recall that `` switch '' , in the token interpretation , means drawing the axis - aligned rectangle with @xmath469 and  @xmath446 at the endpoints of one diagonal , and moving the tokens to the endpoints of the other diagonal . in this case",
    ", the tokens end up at  @xmath428 and a new dislocation  @xmath447 .",
    "the most demanding check to make is that the dislocation  @xmath447 is legally placed after the switch .",
    "recall that , to be legal , @xmath447 must be a point corresponding to a 1 in the matrix @xmath23 .",
    "this part of the argument will always appeal to monotonicity . in this instance",
    "we see that the new dislocation  @xmath447 is above @xmath469 and to the left of  @xmath432 ; since @xmath469 and @xmath432 both correspond to 1s in the matrix then so does @xmath447 , by monotonicity . once this point has been established , and noting that the new hole - pairs are @xmath477 and @xmath439 , it is easy to check that i1i3 have been preserved .    a note of caution . when checking the invariant , it is important to bear in mind that , there are no relations between points beyond the ones explicitly stated , and the ones implied by the line segments being parallel to the axes . thus in figure  [",
    "fig : casei ] , @xmath469 ( respectively , @xmath471 ) may be to the left or right of @xmath428 ( respectively @xmath432 ) , and @xmath470 may be above or below  @xmath469 .",
    "( in case @xmath470 is below @xmath478 , the foci will end up below where they have been drawn , but on the same vertical lines . )",
    "it is crucial not to make use of any unintended relationships between points .",
    "it would have been impractical ( and unnecessary ) to display all the possible combinations .",
    "( 0,0 ) node[notok ] ( a1 ) @xmath325 + + ( 0,3 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 ) ",
    "( a2 ) ; ( 2,-1.0 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2 ) node[notok ] ( b2 ) @xmath432 + + ( 1,0 ) node [ notok ] ( b3 ) @xmath471 + + ( 0,1 ) node [ tok ] ( b4 ) @xmath478 + + ( -2,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b1 )  ( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 0,1 ) node[tok ] @xmath446 ; ( 3,-0.5 ) node[ghost ] ( x ) @xmath478 ; ( b3 )  ( x ) ; ( -0.5,0.5 )  ( 3.5,0.5 ) ; ( 3.7,0.3 )  ( 3.7,0.7 ) ; ( -0.7,0.3 )  ( -0.7,0.7 ) ; ( 0,0.5 ) node[focus ] ; ( 0.4,0.7 ) node[empty ] @xmath456 ; ( 2,0.5 ) node[focus ] ; ( 2.2,0.2 ) node[empty ] @xmath458 ; ( 3,0.5 ) node[focus ] ; ( 3.3,0.2 ) node[empty ] @xmath480 ; ( 4.5,1.5 ) node[empty ] @xmath472 ;    ( 0,0 ) node[notok ] ( a1 ) @xmath325 + + ( 0,3 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 ) ",
    "( a2 ) ; ( 2,-0.5 ) node[tok ] ( b1 ) @xmath431 + + ( 0,1.5 ) node[notok ] ( b2 ) @xmath432 + + ( 1,0 ) node [ tok ] ( b3 ) @xmath471 + + ( 0,1 ) node [ notok ] ( b4 ) @xmath478 + + ( -2,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b1 )  ( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 0,2 ) node[tok ] @xmath447 ; ( -0.5,1.5 )  ( 3.5,1.5 ) ; ( 0,1.5 ) node[focus ] ; ( 0.3,1.3 ) node[empty ] @xmath456 ; ( 3,1.5 ) node[focus ] ; ( 3.4,1.75 ) node[empty ] @xmath458 ;     + case ii applies when @xmath438 , @xmath461 and @xmath481 .",
    "only perform this switch if @xmath482 ; otherwise , just move focus @xmath458 to @xmath480 .",
    "( 2,0 ) node[notok ] ( a1 ) @xmath325 + + ( 0,3 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 3,0.5 ) node[tok ] ( b1 ) @xmath431 + + ( 0,1.5 ) node[notok ] ( b2 ) @xmath432 + + ( -2,0 ) node [ notok ] ( b3 ) @xmath471 + + ( 0,-1 ) node [ tok ] ( b4 ) @xmath478 + + ( -1,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b1 )  ( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 2,2 ) node[tok ] @xmath446 ; ( 1,3.5 ) node[ghost ] ( x ) @xmath478 ; ( b3 )  ( x ) ; ( -0.5,1.5 )  ( 3.5,1.5 ) ; ( 2,1.5 ) node[focus ] ; ( 1.8,1.3 ) node[empty ] @xmath456 ; ( 2,2.5 ) node[focus ] ; ( 2.3,2.6 ) node[empty ] @xmath483 ; ( 3,1.5 ) node[focus ] ; ( 3.2,1.25 ) node[empty ] @xmath458 ; ( 1,2.5 ) node[focus ] ; ( 1.3,2.6 ) node[empty ] @xmath480 ; ( 4.5,1.5 ) node[empty ] @xmath472 ;    ( 2,0 ) node[notok ] ( a1 ) @xmath325 + + ( 0,3 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 3,0.5 ) node[tok ] ( b1 ) @xmath431 + + ( 0,1.5 ) node[notok ] ( b2 ) @xmath432 + + ( -2,0 ) node [ tok ] ( b3 ) @xmath471 + + ( 0,-1 ) node [ notok ] ( b4 ) @xmath478 + + ( -1,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b1 )  ( b2 ) ",
    "( b3 )  ( b4 )  ( b5 ) ; ( 2,1 ) node[tok ] @xmath447 ; ( -0.5,1.5 )  ( 3.5,1.5 ) ; ( 2,1.5 ) node[focus ] ; ( 2.3,1.7 ) node[empty ] @xmath456 ; ( 1,1.5 ) node[focus ] ; ( 0.6,1.25 ) node[empty ] @xmath458 ;     + case ii * applies when @xmath438 , @xmath461 and @xmath484 .",
    "only perform this switch if @xmath485 ; otherwise , just move the foci to @xmath483 and @xmath480 .",
    "_ case i*. _ this case is similar to the previous one , but with @xmath475 replacing @xmath473 .",
    "the fact that @xmath403 starts to the left of @xmath404 and ends up on the right creates an additional complication , whose resolution necessitates an extra switch .",
    "the first action to be taken is to switch the tokens at @xmath469 and @xmath431 creating two new dislocations at @xmath447 and  @xmath448 .",
    "this is legal because @xmath447 is below @xmath469 and to the right of  @xmath431 , and because @xmath448 is to the left of  @xmath469 and above @xmath431 .",
    "( note that we use here both of the valid modes of reasoning arising from monotonicity . ) at this point we have three dislocations , which is a worst case .",
    "note that we have temporarily violated  i3 , but we will put this right at the following step , when we switch @xmath446 and  @xmath448 .",
    "this switch requires no justification , as we are moving tokens to their official locations in  @xmath405 . as an aside",
    ", we remark that @xmath470 may be below  @xmath469 , in which case @xmath403 and @xmath404 will end up lower than drawn in the figure . in any case , it is routine to check that invariant  i is satisfied after the second switch .    _ case ii . _",
    "this case is characterised by @xmath438 , @xmath461 and @xmath481 .",
    "( refer to figure  [ fig : caseii ] . )",
    "a new feature here is that the switch is conditional , and is only made when @xmath478 is above  @xmath471 . in that case , we switch @xmath478 and @xmath446 ; this is legal because the new dislocation  @xmath447 is above  @xmath325 and to the left of  @xmath478 .    if @xmath478 is below @xmath471 ( indicated by the ghostly @xmath478 in the figure ) then no switch is required to maintain the invariant ; all that is needed is to move the focus  @xmath458 rightwards to  @xmath480 .",
    "_ case ii*. _ this case is similar to the previous , but with @xmath484 replacing @xmath481 .",
    "again the switch is conditional , this time only being made when @xmath478 is below @xmath471 . in that case",
    "we switch @xmath478 and @xmath446 ; this is legal because the new dislocation  @xmath447 is below  @xmath428 and to the right of  @xmath478 .",
    "otherwise we just move the foci to @xmath483 and  @xmath480 .",
    "( 2,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1 ) node [ notok ] ( a2 ) @xmath428 + + ( 1,0 ) node [ tok ] ( a3 ) @xmath469 + + ( 0,1.5 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 )  ( a2 )  ( a3 )  ( a4 ) ; ( 0,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,3 ) node [ tok ] ( b2 ) @xmath432 ; ( b0 )  ( b1 ) ",
    "( b2 ) ; ( 2,0 ) node[tok ] @xmath446 ; ( -0.5,1.5 )  ( 3.5,1.5 ) ; ( 1,1.5 ) node[focus ] ; ( 0.8,1.25 ) node[empty ] @xmath458 ; ( 2,1.5 ) node[focus ] ; ( 1.6,1.3 ) node[empty ] @xmath456 ; ( 3.7,1.3 )  ( 3.7,1.7 ) ; ( -0.7,1.3 )  ( -0.7,1.7 ) ; ( 4.5,1.5 ) node[empty ] @xmath472 ;    ( 2,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1 ) node [ tok ] ( a2 ) @xmath428 + + ( 1,0 ) node [ notok ] ( a3 ) @xmath469 + + ( 0,1.5 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 )  ( a2 )  ( a3 ) ",
    "( a4 ) ; ( 0,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,3 ) node [ tok ] ( b2 ) @xmath432 ; ( b0 )  ( b1 )  ( b2 ) ; ( 3,0 ) node[tok ] @xmath447 ; ( -0.5,2.5 )  ( 3.5,2.5 ) ; ( 1,2.5 ) node[focus ] ; ( 0.8,2.25 ) node[empty ] @xmath458 ; ( 3,2.5 ) node[focus ] ; ( 2.7,2.7 ) node[empty ] @xmath456 ;     + case iii applies when @xmath459 , @xmath460 and @xmath475 .",
    "( 3,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1 ) node [ notok ] ( a2 ) @xmath428 + + ( -2,0 ) node [ tok ] ( a3 ) @xmath469 + + ( 0,1 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 )  ( a2 )  ( a3 )  ( a4 ) ; ( 0.5,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1.5,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,4 ) node [ tok ] ( b2 ) @xmath432 + + ( -2,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b0 )  ( b1 )  ( b2 )  ( b3 ) ; ( 3,0 ) node[tok ] @xmath446 ; ( -0.5,1.5 ) ",
    "( 3.5,1.5 ) ; ( 3.7,1.3 ) ",
    "( 3.7,1.7 ) ; ( -0.7,1.3 )  ( -0.7,1.7 ) ; ( 3,1.5 ) node[focus ] ; ( 2.6,1.3 ) node[empty ] @xmath456 ; ( 2,1.5 ) node[focus ] ; ( 1.7,1.25 ) node[empty ] @xmath458 ; ( 4.5,2 ) node[empty ] @xmath472 ;    ( 3,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1 ) node [ notok ] ( a2 ) @xmath428 + + ( -2,0 ) node [ notok ] ( a3 ) @xmath469 + + ( 0,1 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 )  ( a2 )  ( a3 )  ( a4 ) ; ( 0.5,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1.5,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,4 ) node [ notok ] ( b2 ) @xmath432 + + ( -2,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b0 )  ( b1 ) ",
    "( b2 )  ( b3 ) ; ( 3,0 ) node[tok ] @xmath446 ; ( 1,4 ) node[tok ] @xmath447 ; ( 2,2 ) node[tok ] @xmath448 ; ( 4,2 ) node[empty ] @xmath472 ;    ( 3,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,1 ) node [ tok ] ( a2 ) @xmath428 + + ( -2,0 ) node [ notok ] ( a3 ) @xmath469 + + ( 0,1 ) node [ notok ] ( a4 ) @xmath470 ; ( a1 ) ",
    "( a2 )  ( a3 )  ( a4 ) ; ( 0.5,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1.5,0 ) node [ tok ] ( b1 ) @xmath431 + + ( 0,4 ) node [ notok ] ( b2 ) @xmath432 + + ( -2,0 ) node [ notok ] ( b3 ) @xmath471 ; ( b0 )  ( b1 )  ( b2 )  ( b3 ) ; ( 1,4 ) node[tok ] @xmath447 ; ( -0.5,2.5 )  ( 3.5,2.5 ) ; ( 1,2.5 ) node[focus ] ; ( 1.35,2.7 ) node[empty ] @xmath456 ; ( 2,2.5 ) node[focus ] ; ( 2.3,2.75 ) node[empty ] @xmath458 ;     + case iii * applies when @xmath459 , @xmath460 and @xmath473 .",
    "_ case iii .",
    "_ this case is characterised by @xmath459 , @xmath460 and @xmath475 .",
    "( refer to figure  [ fig : caseiii ] . ) here we switch @xmath469 and  @xmath446 ; this is legal because the new dislocation @xmath447 is below @xmath469 and to the right of  @xmath431 .",
    "_ case iii*. _ this case is similar to the previous , but with @xmath473 replacing @xmath473 .",
    "first we switch @xmath469 and @xmath432 , creating new dislocations at @xmath447 and  @xmath448 ; this is legal because the positions of @xmath447 and @xmath448 relative to @xmath469 and @xmath432 .",
    "we finish by switching @xmath446 and  @xmath448 .",
    "( 3,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,2 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 0,-0.5 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,2.5 ) node[tok ] ( b2 ) @xmath432 + + ( 1,0 ) node [ notok ] ( b3 ) @xmath471 + + ( 0,-2 ) node [ tok ] ( b4 ) @xmath478 + + ( -1.5,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b0 )  ( b1 )  ( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 3,-0.5 ) node[tok ] @xmath446 ; ( -0.5,1.5 ) ",
    "( 3.5,1.5 ) ; ( 3,1.5 ) node[focus ] ; ( 2.7,1.7 ) node[empty ] @xmath456 ; ( 1,1.5 ) node[focus ] ; ( 0.7,1.25 ) node[empty ] @xmath458 ; ( 3.7,1.3 )  ( 3.7,1.7 ) ; ( -0.7,1.3 ) ",
    "( -0.7,1.7 ) ; ( 4.5,1.5 ) node[empty ] @xmath472 ;    ( 3,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,2 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 0,-0.5 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2.5 ) node[notok ] ( b2 ) @xmath432 + + ( 1,0 ) node [ notok ] ( b3 ) @xmath471 + + ( 0,-2 ) node [ tok ] ( b4 ) @xmath478 + + ( -1.5,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b0 )  ( b1 ) ",
    "( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 3,2 ) node[tok ] @xmath448 ; ( 2,3.5 ) node[ghost ] ( x ) @xmath478 ; ( b3 )  ( x ) ; ( 3,2.5 ) node[focus ] ; ( 2.7,2.5 ) node[empty ] @xmath483 ; ( 2,2.5 ) node[focus ] ; ( 1.7,2.5 ) node[empty ] @xmath480 ;    ( 4,1.5 ) node[empty ] @xmath472 ;    ( 3,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,2 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 0,-0.5 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2.5 ) node[notok ] ( b2 ) @xmath432 + + ( 1,0 ) node [ tok ] ( b3 ) @xmath471 + + ( 0,-2 ) node [ notok ] ( b4 ) @xmath478 + + ( -1.5,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b0 )  ( b1 ) ",
    "( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 3,0 ) node[tok ] @xmath447 ; ( -0.5,1.5 )  ( 3.5,1.5 ) ; ( 3,1.5 ) node[focus ] ; ( 2.7,1.7 ) node[empty ] @xmath456 ; ( 2,1.5 ) node[focus ] ; ( 1.7,1.25 ) node[empty ] @xmath458 ;     + case iv applies when @xmath459 , @xmath461 and @xmath484 . only perform the second switch if @xmath485 ; otherwise , stop after the first with the foci at @xmath483 and @xmath480 .",
    "( 2,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,3 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 0,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[notok ] ( b1 ) @xmath431 + + ( 0,2 ) node[tok ] ( b2 ) @xmath432 + + ( 2,0 ) node [ notok ] ( b3 ) @xmath471 + + ( 0,1 ) node [ tok ] ( b4 ) @xmath478 + + ( -2.5,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b0 )  ( b1 )  ( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 2,0 ) node[tok ] @xmath446 ; ( -0.5,1.5 ) ",
    "( 3.5,1.5 ) ; ( 2,1.5 ) node[focus ] ; ( 1.8,1.7 ) node[empty ] @xmath456 ; ( 1,1.5 ) node[focus ] ; ( 0.7,1.25 ) node[empty ] @xmath458 ; ( 3.7,1.3 )  ( 3.7,1.7 ) ; ( -0.7,1.3 ) ",
    "( -0.7,1.7 ) ; ( 4.5,1.5 ) node[empty ] @xmath472 ;    ( 2,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,3 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 0,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2 ) node[notok ] ( b2 ) @xmath432 + + ( 2,0 ) node [ notok ] ( b3 ) @xmath471 + + ( 0,1 ) node [ tok ] ( b4 ) @xmath478 + + ( -2.5,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b0 )  ( b1 ) ",
    "( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 2,2 ) node[tok ] @xmath448 ; ( 3,0.5 ) node[ghost ] ( x ) @xmath478 ; ( b3 )  ( x ) ; ( 2,1.5 ) node[focus ] ; ( 1.7,1.5 ) node[empty ] @xmath483 ; ( 3,1.5 ) node[focus ] ; ( 2.7,1.5 ) node[empty ] @xmath480 ; ( 4.5,1.5 ) node[empty ] @xmath472 ;    ( 2,1 ) node[notok ] ( a1 ) @xmath325 + + ( 0,3 ) node [ notok ] ( a2 ) @xmath428 ; ( a1 )  ( a2 ) ; ( 0,0 ) node[notok ] ( b0 ) @xmath474 + + ( 1,0 ) node[tok ] ( b1 ) @xmath431 + + ( 0,2 ) node[notok ] ( b2 ) @xmath432 + + ( 2,0 ) node [ tok ] ( b3 ) @xmath471 + + ( 0,1 ) node [ notok ] ( b4 ) @xmath478 + + ( -2.5,0 ) node [ notok ] ( b5 ) @xmath479 ; ( b0 )  ( b1 ) ",
    "( b2 )  ( b3 )  ( b4 )  ( b5 ) ; ( 2,3 ) node[tok ] @xmath447 ; ( -0.5,2.5 )  ( 3.5,2.5 ) ; ( 2,2.5 ) node[focus ] ; ( 1.8,2.3 ) node[empty ] @xmath456 ; ( 3,2.5 ) node[focus ] ; ( 2.6,2.25 ) node[empty ] @xmath458 ;     + case iv * applies when @xmath459 , @xmath461 and @xmath481 . only perform the second switch if @xmath482 ; otherwise , stop after the first with the foci at @xmath483 and @xmath480",
    "_ case iv .",
    "_ this case is characterised by @xmath459 , @xmath461 and @xmath484 .",
    "( refer to figure  [ fig : caseiv ] . ) here and in the final case , we have an obligatory switch followed by a conditional one . first we switch @xmath432 and @xmath446 , which is legal because the new dislocation  @xmath448 is below @xmath428 and to the right of @xmath432 .",
    "if @xmath478 is above @xmath471 ( indicated by the ghostly @xmath478 in the middle frame of the sequence ) , we stop at this point , with the foci at @xmath483 and  @xmath480 . otherwise ( @xmath478 is below @xmath471 ) , we switch @xmath478 and  @xmath448 , which is legal as the new dislocation  @xmath447 is below @xmath428 and to the right of  @xmath478 .",
    "_ case iv*. _ this case is similar to the previous , but with @xmath481 replacing @xmath484 .",
    "first we switch @xmath432 and @xmath446 , which is legal because the new dislocation  @xmath448 is below @xmath428 and to the right of @xmath432 .",
    "if @xmath478 is below @xmath471 , we stop at this point , with the foci at @xmath483 and  @xmath480 .",
    "otherwise ( @xmath478 is above @xmath471 ) , we switch @xmath478 and  @xmath448 , which is legal as the new dislocation  @xmath447 is above @xmath325 and to the left of  @xmath478 .",
    "( 0,2 ) node[notok ] ( q1 ) @xmath486 + + ( 0,-1 ) node [ tok ] ( p1 ) @xmath390 + + ( 1,0 ) node[notok ] ( qn ) @xmath389 + + ( 0,2 ) node [ tok ] ( pn ) @xmath487 ; ( q1 )  ( p1 ) ; ( qn )",
    " ( pn ) ; ( -0.4,1 ) node [ empty , left ] @xmath488 ;    ( 0,2 ) node[notok ] ( q1 ) @xmath486 + + ( 0,-2 ) node [ notok ] ( p1 ) + + ( 4,0 ) node[tok ] ( qn+1 ) + + ( 0,1 ) node[notok ] ( pn+1 ) + + ( -3,0 ) node[notok ] ( qn ) @xmath389 + + ( 0,2 ) node [ tok ] ( pn ) @xmath487 ; ( q1 ) ",
    "( p1 ) ; ( qn+1 )  ( pn+1 )  ( qn )  ( pn ) ; ( 4.4,1 ) node [ empty , right ] @xmath489 ; ( 4.4,0 ) node [ empty , right ] @xmath490 ; ( -0.4,0 ) node [ empty , left ] @xmath491 ; ( 0,1 ) node[tok ] @xmath446 ; ( -0.5,0.5 ) ",
    "( 4.5,0.5 ) ; ( 0,0.5 ) node[focus ] ; ( 0.35,0.7 ) node[empty ] @xmath456 ; ( 4,0.5 ) node[focus ] ; ( 3.55,0.75 ) node[empty ] @xmath458 ;    cases  1iv * exhaust all the possibilities with @xmath403 is moving upwards . to deal with the situation",
    "when @xmath403 is moving downwards , we appeal to symmetry .",
    "the argument is as follows .",
    "rotate the board through an angle of  @xmath38 , an operation which is equivalent to the change of coordinates @xmath492 and @xmath493 .",
    "note that , relative to the new coordinates , the configuration is still legal , satisfying invariant  i. note also that the underlying matrix is still monotonic , since monotonicity of a matrix is preserved by rotation through  @xmath38 .",
    "however , @xmath403 is now moving upwards in the new coordinate system .",
    "now apply the switch or switches dictated by the relevant one of the cases  i - iv * described above .",
    "finally rotate the board back through an angle  @xmath38 to obtain a new configuration satisfying invariant  i.    we now have to deal with the issue that the initial and final configurations do not satisfy the invariant .",
    "( there are no hole - pairs . ) to get the procedure above going , we need to create one horizontal and one vertical hole - pair .",
    "we make space for this by extending the board and adding three `` virtual points '' @xmath494 , @xmath495 and @xmath496 .",
    "suppose the coordinates of @xmath390 are @xmath488 .",
    "delete the point @xmath390 and add points @xmath491 , @xmath489 and @xmath490 .",
    "( in terms of the graph @xmath25 , this corresponds to adding new vertices @xmath497 and @xmath498 and new edges @xmath499 , @xmath500 and @xmath501 , together with any further edges implied by monotonicity . ) integrate these new points into the path @xmath391 as illustrated in figure  [ fig : finesse ] . add a token to @xmath496 and leave the existing tokens in place ( including the one at the point formally known as  @xmath390 , which now becomes dislocation  @xmath446 ) .",
    "place the foci @xmath456 and @xmath458 just below @xmath446 and @xmath495 .",
    "the invariant is now satisfied , and the arrangement of tokens within the original extent of the board is unchanged .",
    "we can now start the canonical path construction as described earlier .",
    "a similar construction ( rotated through @xmath38 ) works to finish the path .",
    "two important points to note .",
    "the new board is consistent with monotonicity .",
    "( in this context , recall that the edge @xmath502 must be present in  @xmath25 , and hence the point @xmath503 is a valid position for a token . ) moreover , even though @xmath390 has been placed to the left of @xmath389 in the figure , the construction works equally well with @xmath390 to the right .      in lemma  [ lem :",
    "climbing ] , reverse the role of @xmath456 and @xmath458 , so that @xmath504 , @xmath505 , @xmath506 and @xmath507 .",
    "place the @xmath32  tokens initially on the points @xmath421 , and denote the configuration at time  @xmath47 by @xmath508 . since the trajectories of @xmath403 and @xmath404 are oblivious of the tokens , @xmath410 and @xmath409 are unchanged .",
    "according to the invariant , the configuration  @xmath509 satisfies @xmath510 , @xmath511 and @xmath512 . at any legal time",
    "@xmath47 , then , @xmath513    consider a canonical path @xmath514 constructed by the method of the section  [ sec : pathconstruct ] .",
    "some of cases i  iv * involved making two switches ; in these cases , call the middle configuration between the two switches ( and the corresponding perfect matching @xmath515 ) _ transitory_. note the configurations that are not transitory are of the form @xmath427 for some  @xmath47 , and these configurations satisfy invariant  i. if @xmath515 is not transitory , consider a time @xmath47 at which configuration @xmath427 corresponds to  @xmath515 .",
    "then @xmath508 is a near complement to @xmath427 with respect to  @xmath405 , and its corresponding perfect matching @xmath516 is a near complement to @xmath515 with respect to @xmath387 ; specifically , from equation  ( [ eq : complement ] ) , @xmath517 .",
    "suppose @xmath359 is a valid transition ( switch ) of the markov chain .",
    "in the usual way , we wish to provide every canonical path through @xmath359 with a unique encoding , and hence bound the total number of paths using @xmath359 .",
    "in fact , our encoding will be an element of @xmath518 $ ] .",
    "so suppose the transition of interest occurs at @xmath519 in a canonical path of the above form from @xmath348 to  @xmath349 .",
    "we suppose first that @xmath520 is a single cycle .",
    "at least one of @xmath515 and @xmath521 is not transitory , say , @xmath515 .",
    "our encoding will be the near complement @xmath516 together with some additional data .",
    "consider @xmath522 .",
    "noting that @xmath523 , the first piece of extra data we provide is the identity of the ( at most ) two edges in @xmath524 that need to be deleted from  @xmath525 in a bid to recover @xmath526 : there are @xmath527 possibilities .",
    "now we need to add two edges , but there are only two ways this can be done so that the result is a cycle . finally , we need to signal that the near complement was taken with respect to @xmath515 and not @xmath521 : a further two possibilities .",
    "this gives us our encoding within the set @xmath528 $ ] .",
    "in general , the symmetric difference of @xmath348 and @xmath349 is a union of several cycles , say @xmath529 , where the cycles are presented in the agreed order , and @xmath530 is the cycle currently being switched using the procedure described in section  [ sec : pathconstruct ] . to construct the perfect matching @xmath360 that forms the main element of the encoding ,",
    "proceed as follows .",
    "except on the cycle  @xmath530 , the matching  @xmath361 is given by the symmetric difference of @xmath348 , @xmath349 and  @xmath515 .",
    "thus , denoting the vertex set of  @xmath530 by  @xmath531 , and the complement @xmath532 by  @xmath533 , we have @xmath534=(x\\oplus y\\oplus z_i)[\\,\\vbar\\,]$ ] . on @xmath530 itself ,",
    "@xmath535 $ ] is given by the single - cycle construction from section  [ sec : pathconstruct ] .",
    "the additional data is encoded by an integer in @xmath536 $ ] as before .",
    "note that we can reconstruct the common edges @xmath369 of the initial and final states , and all the cycles of @xmath537 except @xmath530 , by examining @xmath538 and @xmath539 .",
    "knowing that @xmath540 have been switched and @xmath541 have not , we may then recover @xmath542 $ ] and @xmath543 $ ] .",
    "finally , we recover @xmath544 $ ] and @xmath545 $ ] as in the single - cycle case .",
    "summarising , there are at most @xmath546 canonical paths using any given transition .",
    "we have all the quantities needed for the calculation of the congestion  @xmath352 . from the definition of the switch chain , @xmath547 . from lemma  [ lem :",
    "climbing ] , the maximum length of a canonical path is @xmath402 . substituting these values into ( [ eq : congestion ] ) yields @xmath548 then , from lemma  [ lem : mixvscongestion ] , noting that the state space @xmath335 has cardinality at most @xmath549",
    ", we obtain the sought for bound on mixing time .",
    "[ thm : mixingtime ] the switch markov chain has mixing time @xmath550 for any graph @xmath45\\cup[n]',e)$ ] in the class monotone .    the big - o estimate comes from the observation that , if we were to set @xmath551 smaller than @xmath552 , say , we could not distinguish between the output of the chain and the uniform distribution within polynomial time . by comparison with theorem  [ thm : mixingtime ] , the algorithm of @xcite has running time @xmath44 , with no bound given on the implied constant .",
    "it may be possible to improve the analysis here , but it is highly unlikely that we could match the @xmath553 bound conjectured by diaconis , graham and holmes  @xcite .",
    "currently , this has not even been established for chain graphs .",
    "the hierarchy of hereditary graph classes studied in this paper provides a framework for understanding the ergodicity and mixing time of the switch chain for perfect matchings . unfortunately , while we have identified the largest class for ergodicity , it seems difficult to characterise the largest hereditary class having polynomial time mixing .",
    "indeed , it is not even clear that such a class exists .    a simpler question would be to exhibit proper superclasses of monotone graphs for which the switch chain mixes rapidly . from the examples",
    "@xmath202 given in subsection [ sec : biconvex ] , we see that such a superclass can not contain all biconvex graphs .",
    "more precisely , it can not contain @xmath202 for all @xmath76 .",
    "thus we might consider the class which excludes @xmath202 for some @xmath76 , and try to determine the largest @xmath76 for which this class has rapid mixing .",
    "note that the class excluding @xmath202 also excludes @xmath554 for all @xmath79 , since @xmath202 is an induced subgraph of @xmath554 .",
    "the graph @xmath555 is monotone .",
    "therefore the class of @xmath555-free biconvex graphs , that is , biconvex graphs that have no induced subgraph isomorphic to @xmath555 , is not a superclass of monotone graphs .",
    "however , for every fixed @xmath556 the class of all @xmath202-free biconvex graphs does contain all monotone graphs .",
    "this can be proved by observing inclusions among the forbidden subgraphs in figs .",
    "[ fig : tucker ] and  [ med : fig004 ] .",
    "unfortunately , we know very little about the structure of the graphs in these classes , let alone whether their structure might support rapid mixing .",
    "we thank mary cryan for useful discussions .",
    "let @xmath557 be an ordered sequence of points @xmath558 such that @xmath559 and @xmath560 ( @xmath561 $ ] ) .",
    "we will assume that @xmath562 for @xmath52 , unless @xmath563 .",
    "otherwise , we replace @xmath564 by @xmath565 ( @xmath566 ) , for small enough @xmath567",
    ". then the line segments @xmath568 $ ] ( @xmath569 $ ] ) will be called _",
    "slopes_. the _ range _ @xmath391 is then the point set @xmath570 .",
    "the set @xmath571 will be called the _ nodes _ of the range .",
    "observe that @xmath391 is a connected one - dimensional manifold with boundary @xmath572 , in which the nodes of @xmath405 appear in order .",
    "the _ height _ @xmath573 ( @xmath574 ) is the piecewise linear function defined by interpolation on the @xmath564 @xmath575 $ ] ) .",
    "thus , if @xmath576 is such that @xmath577 , then @xmath578 .",
    "a node @xmath415 will be called a _",
    "peak _ if it is a local maximum of @xmath381 , a _ valley _ if it is a local minimum of @xmath381 , and _",
    "monotone _ otherwise .",
    "the _ summit _",
    "@xmath579 of @xmath391 is the highest peak , so @xmath580 .",
    "we will say that two ranges @xmath581 are _ isomorphic _ if there is bijection between @xmath405 and @xmath582 such that @xmath583 if and only if @xmath584 .",
    "the bijection is extended linearly to the @xmath585 . if @xmath586 , then @xmath587 .",
    "hence , for any range @xmath391 , there is an isomorphic range @xmath588 such that @xmath589 ( @xmath315 $ ] ) . for illustration",
    ", we will generally use this _ standard presentation _ of @xmath391 . then , for example , we will say a point @xmath590 is to the left or right of a point @xmath591 if it is true in the standard presentation .",
    "an example range with @xmath592 is shown below , first in the standard presentation , and then in an isomorphic presentation . here",
    "@xmath593 are peaks , @xmath594 are valleys , and @xmath595 are monotone .",
    "the summit is @xmath596 .",
    "we wish to show the existence of continuous functions @xmath597\\to \\pi$ ] , with @xmath598 , @xmath599 , @xmath600 , such that @xmath601 for all @xmath400 $ ] .",
    "an _ event _ will be any value of @xmath47 such that @xmath602 or @xmath603 , and we will let @xmath604 be the set of events . our assumption that @xmath605 only if @xmath67 or @xmath563 implies that , for any @xmath415 ( @xmath606 ) , @xmath607 only if @xmath463 is in the interior of some line segment @xmath608 .",
    "this can be viewed as the intersection of a horizontal line through @xmath415 with the line segment @xmath608 .",
    "if this intersection exists , we will denote it by @xmath609 .",
    "the set of such intersections determines all potential events .",
    "it is a superset of @xmath604 , and is clearly preserved under isomorphism .",
    "note that , in the interval @xmath610 between two successive events , we may take @xmath611 to be functions defined by linear interpolation : @xmath612 thus @xmath611 may be taken as piecewise linear functions .",
    "these functions clearly transform in an obvious way , under isomorphism .",
    "they are completely determined by the set @xmath604 .",
    "hence we wish to determine a tight upper bound on @xmath613 .",
    "this is usually posed as the ( discrete parallel ) _",
    "mountain climbers problem _ , and we will use its terminology here .",
    "( see , for example ,  @xcite . ) for example , we refer to the parameter @xmath47 as `` time '' .",
    "two climbers , starting at @xmath390 and @xmath487 , attempt to meet by moving continuously on the slopes of the standard presentation of the range @xmath391 , so that they are always at the same height . note that one climber must always remain to the left of the summit , and the other to the right , since if either reaches the summit , so must the other .",
    "thus , if they meet , they must meet at @xmath579 .",
    "can they always meet and , if so , how many events are required to ensure that they meet ?",
    "note that ( a version of ) this problem first arose in analysis , as a problem concerning continuous functions .",
    "( see , for example ,  @xcite . )",
    "this continuous version is somewhat different .",
    "there are pathological cases in which the climbers can not meet and , even when they can , there may be no finite bound on the number of events .",
    "there appears to be no worst - case analysis of the discrete version of this problem in the literature , although  @xcite gave an @xmath614 upper bound on the number of events .",
    "since this problem is central to the canonical path construction in this paper , we give an analysis here .      the _ range graph _",
    "@xcite @xmath615 has a vertex for each intersection @xmath609 , with @xmath616 or @xmath617 .",
    "these are intersections from points to the left of the summit with slopes to the right , and vice versa , representing all possible events during the climb .",
    "we also add vertices for the initial and final states @xmath618 and @xmath619 .",
    "it is easy to see that this vertex set is the same for isomorphic ranges and can have cardinality at most @xmath620 , by simple counting .",
    "however , this bound can be improved .",
    "suppose there are @xmath622 slopes to the left of the summit , and @xmath623 to the right , so @xmath624 .",
    "let @xmath625 be the maximum number of vertices in @xmath615 .",
    "we will show by induction that @xmath626 .",
    "first , it is easy to see that @xmath627 .",
    "next , if any of the nodes from @xmath628 to @xmath629 is monotone , consider the range given by removing such a node .",
    "its range graph will have at most @xmath630 vertices , by induction .",
    "adding back the removed node gives rise to at most @xmath623 new vertices , as shown below ( in the case that the removed node is @xmath628 ) , so @xmath631 vertices .",
    "finally , if there are no monotone nodes and hence @xmath628 is a peak , consider the range given by removing both node @xmath628 and node @xmath632 , which is necessarily a valley .",
    "its range graph will have @xmath633 vertices , using the induction .",
    "adding back @xmath628 and @xmath632 gives the situation shown below .",
    "the only new vertices will be in the window determined by the slope to the right of the new first peak , i.e. , between @xmath628 and  @xmath632 .",
    "the window partitions the range to the right of the summit into some number @xmath634 of disjoint paths .",
    "suppose that the @xmath238th path has @xmath635 slopes ( @xmath636 ) , so @xmath637 .",
    "then it is easy to see that the @xmath238th path gives rise to exactly @xmath638 new vertices .",
    "thus the total number of vertices added is @xmath639 .",
    "thus @xmath640 , and we need only observe that @xmath641 has a maximum of @xmath642 , when @xmath643 .",
    "there is an edge between two vertices in @xmath615 if the ends of the two horizontal lines defining the vertices are connected by slopes .",
    "thus there is an edge between vertices @xmath609 and @xmath644 if either @xmath645 and @xmath646 , or @xmath647 and @xmath648 .",
    "the edges of @xmath615 correspond to possible intervals between successive events .",
    "for example , @xmath649 is adjacent to @xmath650 in the range graph of the example range above , as illustrated .",
    "it is clear that each vertex , other than @xmath618 and @xmath619 , is adjacent to exactly two other vertices , corresponding to moving left or right on the range at a peak or valley , and up or down from a monotone node .",
    "thus all vertices in the graph have degree 2 , apart from @xmath618 and @xmath619 , which have degree 1 , since it is only possible to move up from @xmath618 , or down from @xmath619 .",
    "hence the range graph comprises a unique path joining @xmath618 to @xmath619 , and possibly some disjoint cycles .",
    "the number of edges on this path is at most @xmath642 .",
    "this example illustrates that @xmath615 need not be connected , and may have fewer vertices than the upper bound .",
    "in fact , the range graph may have as few as @xmath654 vertices , for example when @xmath655 .",
    "there can not be fewer , since there must be at least one vertex for each of the @xmath656 nodes other than @xmath657 , plus the two vertices @xmath618 , @xmath619 .",
    "note also that the effect on @xmath615 of removing the perturbations @xmath658 , used to make heights unique , is to merge pairs of vertices @xmath659 and @xmath609 into a single vertex @xmath660 .",
    "the merged vertex may have degree 4 in the range graph , so the component of @xmath615 containing @xmath618 and @xmath619 may contain cycles . in this case , the path from @xmath618 to @xmath619 in @xmath615 may no longer be unique .",
    "see  @xcite for an example .",
    "the proof given above is essentially that of tucker  @xcite .",
    "other authors ( e.g.  @xcite ) define the range graph to include all intersections @xmath609 , and even all `` intersections '' @xmath661 , but use essentially the same proof .",
    "unfortunately , the range graph proof does not provide a lower bound on the worst case , since the component structure of @xmath615 is opaque . to do this",
    ", we give an equally easy proof of the upper bound by induction on @xmath32 . if @xmath662 , there is a single peak , and nothing to prove .",
    "otherwise , we divide the problem into three stages .",
    "assume , without loss of generality , that the second highest peak @xmath663 is to the left of the summit @xmath579 , so @xmath664 .",
    "let the deepest valley between @xmath663 and @xmath579 be @xmath665 , so @xmath666 .",
    "we construct the horizontal line @xmath148 from @xmath663 to the slope @xmath667 to the right of @xmath579 , and the horizontal line @xmath214 from @xmath665 to the first slope encountered to its right .",
    "this produces three subproblems , climbing up from @xmath618 to summit @xmath148 , climbing down from @xmath148 to summit @xmath214 , and then climbing up from @xmath214 to the true summit @xmath619 . by `` climbing down '' we mean replacing the height function @xmath381 with @xmath668",
    "each stage has a range with fewer nodes than the original problem , so each has a path to its summit , by induction . joining these paths together gives a path for the original problem .",
    "note that the summits @xmath148 and @xmath214 in stages 1 and 2 must be shrunk to a point so that the ranges correspond to the definition , but this does not affect the path .        if @xmath669 , range @xmath670 has @xmath671 , @xmath672 , @xmath76 peaks @xmath415 at @xmath673 ( @xmath674 ) , and @xmath675 valleys @xmath415 at @xmath676 ( @xmath677 ) .",
    "if @xmath76 is odd , @xmath678 is the summit , and @xmath679 is the second highest peak .",
    "if @xmath76 is even , @xmath680 is the summit , and @xmath681 is the second highest peak .",
    "thus @xmath682 if @xmath76 is odd , and @xmath683 if @xmath76 is even . the case @xmath684 is shown below , together with the three ranges constructed in the inductive proof above",
    ".    the range of stage 1 can be transformed to @xmath685 by minor changes of coordinates .",
    "clearly stages 2 and 3 each contribute @xmath686 edges to the path in @xmath687 .",
    "thus , if @xmath688 is the number of edges in the path from @xmath689 to @xmath619 in @xmath687 , we have @xmath690 , and @xmath691 , from which we can easily deduce @xmath692 .",
    "the path from @xmath618 to @xmath619 is unique , and has path length @xmath693 in @xmath687 . observe that this closely matches our upper bound @xmath642 .",
    "we can compute the number of vertices in @xmath687 exactly . if @xmath76 is even ( resp .",
    "odd ) , the total number of horizontal intersections from peaks to the left ( resp .",
    "right ) of @xmath579 with slopes to its right ( resp .",
    "left ) is @xmath694 the total number of horizontal intersections from valleys to the left ( resp .",
    "right ) of @xmath579 with slopes to its right ( resp .",
    "left ) is @xmath695 these total @xmath696 , whether @xmath76 is odd or even .",
    "the total number of horizontal intersections from peaks to the right ( resp . left ) of @xmath579 with slopes to its left ( resp .",
    "right ) is @xmath697 and the total number of horizontal intersections from valleys to the right ( resp .",
    "left ) of @xmath579 with slopes to its left ( resp .",
    "right ) is @xmath698 these also total @xmath696 .",
    "so the number of vertices in @xmath687 is @xmath699 .",
    "hence @xmath687 is a single path from @xmath618 to @xmath619 .",
    "suppose @xmath391 is as above .",
    "there are continuous functions @xmath394\\to\\pi$ ] satisfying @xmath395 , @xmath396 , @xmath397 , @xmath398 , and @xmath399 for all @xmath400 $ ] .",
    "moreover the set of events @xmath401:\\focusa(t)\\in p\\text { or } \\focusb(t)\\in p\\big\\}\\ ] ] has cardinality at most @xmath402 .                        , _ statistical problems involving permutations with restricted positions _ , in state of the art in probability and statistics , vol .",
    "36 of lecture notes ",
    "monograph series , institute of mathematical statistics , 2001 , pp .",
    "195222 .                                      , _ counting the number of matchings in chordal and chordal bipartite graph classes _ , in graph - theoretic concepts in computer science , vol .",
    "5911 of lecture notes in computer science , springer , 2010 , pp .  296307 ."
  ],
  "abstract_text": [
    "<S> we study a simple markov chain , the switch chain , on the set of all perfect matchings in a bipartite graph . </S>",
    "<S> this markov chain was proposed by diaconis , graham and holmes as a possible approach to a sampling problem arising in statistics . </S>",
    "<S> we ask :  for which classes of graphs is the markov chain ergodic and for which is it rapidly mixing ? we provide a precise answer to the ergodicity question and close bounds on the mixing question . </S>",
    "<S> we show for the first time that the mixing time of the switch chain is polynomial in the case of monotone graphs , a class that includes examples of interest in the statistical setting . </S>"
  ]
}