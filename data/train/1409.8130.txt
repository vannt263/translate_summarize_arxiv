{
  "article_text": [
    "in order to exploit the new generation of massively parallel supercomputers that are becoming available , weather and climate models will require good parallel scalability .",
    "this requirement has driven the development of numerical methods that do not depend on the orthogonal coordinate system and quadrilateral structure of the longitude - latitude grid , whose polar resolution clustering is predicted to lead to a scalability bottleneck .",
    "a significant challenge is to obtain good scalability without sacrificing accuracy ; in particular conservation , balance , and wave propagation are important for accurate modelling of the atmosphere @xcite .",
    "building on earlier work @xcite , @xcite presented a finite volume scheme for the shallow water equations on polygonal meshes .",
    "they start from the continuous shallow water equations in the so - called vector invariant form : @xmath0 where @xmath1 , the geopotential , is equal to the fluid depth times the gravitational acceleration , @xmath2 is the total geopotential at the fluid s upper surface including the contribution from orography , @xmath3 is the velocity , @xmath4 is the mass flux , and @xmath5 .",
    "the @xmath6 symbol is defined by @xmath7 where @xmath8 is the unit vertical vector .",
    "finally , @xmath9 is the potential vorticity ( pv ) , where @xmath10 is the absolute vorticity , with @xmath11 the coriolis parameter and @xmath12 the relative vorticity , and @xmath13 is the pv flux . by the use of a c - grid placement of prognostic variables , and by ensuring that the numerical method mimics key mathematical properties of the continuous governing equations ( hence the term ` mimetic ' )",
    ", the scheme was designed to have good conservation and balance properties .",
    "these good properties were verified in numerical tests on hexagonal and cubed sphere spherical meshes",
    ". however , their scheme has a number of drawbacks .",
    "most seriously , the coriolis operator , whose discrete form is essential to obtaining good geostrophic balance , is numerically inconsistent and fails to converge in the @xmath14 norm @xcite . also ,",
    "although the gradient and divergence operators are consistent , their combination to form the discrete laplacian operator also fails to converge in the @xmath14 norm in some cases .",
    "these inaccuracies are clearly visible in idealized convergence tests , and give rise to marked ` grid imprinting ' for initially symmetrical flows . although they are less conspicuous in more complex flows , they are clearly undesirable .",
    "@xcite ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ) showed that the same mimetic properties can be obtained using a certain class of mixed finite element method .",
    "the mimetic properties follow from the choice of an appropriate hierarchy of function spaces for the prognostic and diagnostic variables ( e.g.  section  [ sec_compound ] below ) , which also provides a finite element analogue of the c - grid placement of variables , or a higher - order generalization .",
    "( the use of such a hierarchy goes by various names in the literature , including ` mimetic finite elements ' , ` compatible finite elements ' , and ` finite element exterior calculus ' ; see @xcite for a discussion of the shallow water equation case in the language of exterior calculus . )",
    "importantly , the resulting schemes are numerically consistent .    while the mimetic finite element approach appears very attractive , it is not yet clear which particular choice of mesh and function spaces is most suitable .",
    "standard finite element methods use triangular or quadrilateral elements . for the lowest - order mimetic finite element scheme on triangles ,",
    "the dispersion relation for the linearized shallow water equations suffers from extra branches of inertio - gravity waves , which are badly behaved numerical artefacts @xcite , analogous to the problem that occurs on the triangular c - grid @xcite .",
    "higher - order finite element methods also typically exhibit anomalous features in their wave dispersion relations , such as extra branches , frequency gaps , or zero group velocity modes .",
    "some progress has been made in reducing these problems , at least on quadrilateral meshes , through the inclusion of dissipation or modification of the mass matrix ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , though the remedies are somewhat heuristic except in the most idealized cases .",
    "finally , coupling to subgrid models of physical processes such as cumulus convection or cloud microphysics may be less straightforward with higher - order elements ( p.  lauritzen , pers .  comm . ) .",
    "these factors suggest that it may still be worthwhile investigating lowest - order schemes on quadrilateral and hexagonal meshes .",
    "the above arguments raise two related questions .",
    "can the mimetic finite element method inspire a development to fix the inconsistency of the mimetic finite volume method ?",
    "alternatively , can the mimetic finite element method at lowest order be adapted to work on polygonal meshes such as hexagons ?",
    "below we answer the second question by showing that the mimetic finite element method can indeed be adapted .",
    "in fact , from a certain viewpoint the mimetic finite volume and mimetic finite element schemes have very similar mathematical structure .",
    "the notation below is chosen to emphasize this similarity any vector , such as @xmath15 in ( [ uperp ] ) . ] . moreover ,",
    "the similarity is sufficiently strong that much of the code of the mimetic finite volume model of @xcite could be re - used in the model presented below .",
    "this , in turn , facilitates the cleanest possible comparison of the two approaches .",
    "the adaptation of the mimetic finite element method employs two novel features .",
    "the first is the definition of a suitable hierarchy of finite element function spaces on polygonal meshes .",
    "this is achieved by defining compound elements built out of triangular subelements , and is described in section  [ sec_compound ] .",
    "the second ingredient is the introduction of a dual family of function spaces that are defined on the dual of the original mesh .",
    "this permits the definition of a spatially averaged mass field that lives in the same function space as the vorticity and potential vorticity fields ; this , in turn , enables the use of an accurate finite volume scheme on the dual mesh for advection of potential vorticity , and keeps the formulation of the finite element model as close as possible to that of the finite volume model .",
    "the scheme described here is suitable for arbitrary two - dimensional polygonal meshes on flat domains or , as used here , curved surfaces approximated by planar facets .",
    "two particular meshes are used to obtain the results in section  [ sec_results ] , namely the same variants of the hexagonal - icosahedral mesh and the cubed sphere mesh used by @xcite , in order to facilitate comparison with their results .",
    "coarse - resolutions versions are shown in fig .",
    "[ fig_grids ] .",
    "any polygonal mesh has a corresponding dual mesh .",
    "( we will refer to the original mesh as the ` primal ' mesh where necessary to distinguish it from the dual . )",
    "each primal cell contains one dual vertex ; each dual cell contains one primal vertex ; each primal edge corresponds to one dual edge and these usually cross each other . figure  [ fig_grids ] shows both primal and dual edges for the two meshes .",
    "the mimetic properties of the scheme arise from the relationships between the finite element function spaces .",
    "three function spaces are used on the primal mesh ( @xmath16 , @xmath17 , and @xmath18 ) , and three on the dual mesh ( @xmath19 , @xmath20 , and @xmath21 ) . figure  [ fig_spaces ]",
    "indicates that @xmath22 ( i.e.  @xmath23 ) maps from @xmath16 to @xmath17 and @xmath24 maps from @xmath17 to @xmath18 and @xmath25 ( like @xmath26 and @xmath24 ) can both be defined as intrinsic operations on a curved surface , without reference to @xmath8 or a third dimension . ] .",
    "more precisely , the primal function spaces satisfy the following properties",
    ".    * property list 1 *    * @xmath27 . *",
    "@xmath28 with @xmath29 .",
    "* @xmath30 . *",
    "@xmath31 , and @xmath32 .",
    "that is , @xmath22 maps onto the kernel of @xmath24  .",
    "the second condition assumes spherical geometry so that there are no lateral boundaries .",
    "the same assumption will be made throughout this paper ; in particular , no boundary terms will arise when integrating by parts in 2d is @xmath33 where @xmath1 is a potential , @xmath34 is a stream function , and @xmath35 is a harmonic vector field , i.e.  one satisfying @xmath36 the fourth condition in property list  1 implies that all nondivergent fields @xmath3 can be written as @xmath37 , which rules out the possibility of harmonic vector fields .",
    "this is appropriate for spherical geometry , since there exist no non - zero harmonic vector fields on the sphere .",
    "however , for a doubly period plane , for example , for which a constant vector field is harmonic , we would have to extend the fourth condition to allow for harmonic vector fields .",
    "this issue does not affect any of the discussion below except for the discrete helmholtz decomposition ( section  [ deriv2 ] ) , which would only need to be extended in the obvious way to allow for harmonic vector fields . ] .    in a similar way , fig .",
    "[ fig_spaces ] indicates that @xmath26 maps from @xmath21 to @xmath20 and @xmath25 maps from @xmath20 to @xmath19 .",
    "more precisely , the dual function spaces satisfy the following properties",
    ".    * property list 2 *    * @xmath38 . * @xmath39 with @xmath40 .",
    "* @xmath41 .",
    "* @xmath42 , and @xmath43 .",
    "that is , @xmath26 maps onto the kernel of @xmath25  .",
    "as noted earlier , standard finite element schemes in two dimensions typically use triangular or quadrilateral elements .",
    "several families of mixed finite elements that satisfy property list  1 on such meshes are known . however , in order to apply our scheme on more general polygonal meshes we will need to define families of mixed finite elements satisfying property list  1 on those meshes .",
    "one way to do this is to use _",
    "compound elements_. any polygonal element can be subdivided into a number of triangular subelements . a basis function on the polygonal element",
    "can then be defined as a suitable linear combination of basis functions on the subelements .",
    "the allowed linear combinations are determined by the requirement to satisfy property list  1 or  2 ; see below .",
    "the desire to use a dual mesh increases the need for finite element spaces on polygons , and hence for compound elements . only in special cases ( such as the cubed sphere , fig .",
    "[ fig_grids ] ) can both the primal and dual meshes be built of triangles and quadrilaterals ; other cases require higher degree polygons for either the primal or dual mesh ( or both ) .    for a triangular primal mesh , @xcite describe a scheme for the construction of a dual hierarchy of function spaces .",
    "the dual mesh elements are compound elements , similar , though not identical , to those used here .",
    "however , their scheme is limited to the case of a triangular primal mesh and a barycentric refinement for the construction of the dual .    in a complementary study",
    ", @xcite describes how finite element basis functions satifying property list  1 may be constructed on arbitrary polygonal elements , without the need to divide into subelements , through a process of _ harmonic extension_. for example , let @xmath44 be a basis function for @xmath16 associated with primal vertex  @xmath45 .",
    "define @xmath44 to equal  @xmath46 at vertex  @xmath45 and zero at all other vertices .",
    "next extend @xmath44 harmonically along primal mesh edges ; that is , its second derivative should vanish so that its gradient is constant along each edge",
    ". then extend @xmath44 harmonically into the interior of each element ; that is , solve @xmath47 subject to the dirichlet boundary conditions given by the known values of @xmath44 on element edges . in a similar way ,",
    "let @xmath48 be a basis function for @xmath17 associated with edge  @xmath49 .",
    "define the normal component of @xmath48 to be a nonzero constant along edge  @xmath49 ( some arbitrary sign convention must be chosen to define the positive direction ) and zero at all other edges .",
    "then extend @xmath48 harmonically into the interior of each element ; that is , solve @xmath50 and @xmath51 subject to the known values of the normal component at element edges , for example by writing @xmath52 , implying @xmath53 and @xmath54 for constants @xmath55 and @xmath56 .",
    "the boundary conditions determine the value of @xmath55 , but not @xmath56 .",
    "however , condition  ( [ harmonicv0 ] ) along with the fourth property in list  1 implies that we must choose @xmath57 , so that ( [ harmonicv1b ] ) reduces to @xmath58 for the last function space @xmath18 the basis function associated with cell  @xmath59 is defined to be a nonzero constant in cell  @xmath59 and zero in all other cells . it",
    "may then be verified that the properties in list  1 do indeed hold for the spaces spanned by these basis functions .",
    "although the harmonic extension approach provides a general method for constructing the lowest order mimetic finite element spaces on polygonal meshes , its drawback is that , except for the simplest element shapes , the basis functions can not be found analytically .",
    "even if they are found numerically , the inner products required for the finite element method can not be computed exactly , either analytically or by numerical quadrature .",
    "here we take inspiration from both @xcite and @xcite to construct spaces of compound finite elements for arbitrary polygonal primal and dual meshes , by a process that might be called _ discrete harmonic extension_. for the function spaces on the primal mesh , in effect , we solve a finite element discretization of ( [ harmonicv0 ] ) , ( [ harmonicv1a ] ) , and ( [ harmonicv1c ] ) on the mesh of triangular subelements in order to construct the compound basis elements for the original polygonal mesh . for this discretization",
    "we use the lowest order mimetic finite element spaces on the triangular subelements , in which @xmath16 comprises continuous piecewise linear elements , @xmath17 comprises the lowest order raviart - thomas elements , and @xmath18 comprises piecewise constant elements ; @xmath60 in standard shorthand .",
    "although only discrete versions of ( [ harmonicv0 ] ) , ( [ harmonicv1a ] ) , and ( [ harmonicv1c ] ) are solved , it may be verified that the properties in list  1 hold exactly .",
    "the basis functions on the triangular subelements are known analytically , and the compound elements are linear combinations of these ; therefore , integrals of products of basis functions , for example to compute entries of a mass matrix , can all be computed exactly .",
    "the resulting compound elements provide a generalization to polygonal meshes of the @xmath60 hierarchy of spaces , so we will refer to them as compound @xmath60 elements . like the non - compound spaces described by @xcite , the expansion coefficients for @xmath16 correspond to mesh vertices , for @xmath17 to edges , and for @xmath18 to cells .",
    "thus , this hierarchy provides a finite element analogue of the polygonal c - grid if we choose to represent velocity in @xmath17 and the mass variable in @xmath18 .    the construction of basis elements for the dual spaces proceeds in a very similar way , except that the basis function for @xmath61 is given by @xmath62 the solution of ( [ harmonicv1a ] ) and ( [ harmonicv1c ] ) .",
    "this gives rise to a compound @xmath63 hierarchy of spaces , where n0 refers to the lowest order two - dimensional ndlec elements .",
    "an important detail concerns the number of subelements needed .",
    "it may appear natural to subdivide an @xmath64-gon cell into @xmath64  triangular subelements .",
    "however , it will be necessary to calculate integrals on the overlap between primal and dual elements ( section  [ massmatrices ] ) . in order to be able to do this",
    "when the domain is a curved surface approximated by plane triangular subelement facets , both the primal and dual compound element meshes must be built from triangular subelements of the the same supermesh .",
    "to achieve this we divide @xmath64-gon cells ( whether primal or dual ) into @xmath65  subelements ( fig .",
    "[ fig_supermesh ] ) .",
    "it is convenient to normalize the basis functions as follows : @xmath66 here @xmath67 is the unit normal vector to primal edge @xmath49 and @xmath68 is the unit tangent vector to dual edge @xmath49 , with @xmath68 and @xmath67 pointing in the same sense ( i.e.  @xmath69 , though they need not be parallel if the dual edges are not orthogonal to the primal edges ) , as in @xcite . the normalization is chosen so that degrees of freedom for fields in @xmath18 and @xmath19 correspond to area integrals of scalars over primal cells and dual cells , respectively , degrees of freedom for a field in @xmath17 correspond to normal fluxes integrated along primal edges , degrees of freedom in @xmath20 correspond to circulations integrated along dual edges , and degrees of freedom for fields in @xmath16 and @xmath21 correspond to nodal values of scalars at primal vertices and dual vertices respectively .",
    "again , this corresponds closely to the framework of @xcite .",
    "@xcite have analyzed the wave dispersion properties for finite element discretizations of the linear shallow water equations using these compound elements . that paper gives explicit expressions for the @xmath17 and @xmath18 compound element basis functions for the cases of a square mesh and a regular hexagonal mesh on a plane .",
    "for more general meshes it is straightforward and convenient to construct the compound element basis functions numerically .",
    "figure  [ fig_elements ] shows typical basis elements for the three primal mesh function spaces for quadrilateral and hexagonal cells .    ; middle row @xmath70 ; bottom row @xmath71 . in the middle row , at subelement edges the normal components of the basis vectors are continuous . , title=\"fig:\",width=188 ]   ; middle row @xmath70 ; bottom row @xmath71 . in the middle row , at subelement edges the normal components of the basis vectors are continuous . , title=\"fig:\",width=188 ]    ; middle row @xmath70 ; bottom row @xmath71 . in the middle row , at subelement edges the normal components of the basis vectors are continuous . ,",
    "title=\"fig:\",width=226 ] ; middle row @xmath70 ; bottom row @xmath71 . in the middle row , at subelement edges the normal components of the basis vectors are continuous .",
    ", title=\"fig:\",width=264 ]    ; middle row @xmath70 ; bottom row @xmath71 . in the middle row , at subelement edges the normal components of the basis vectors are continuous .",
    ", title=\"fig:\",width=226 ]   ; middle row @xmath70 ; bottom row @xmath71 . in the middle row , at subelement edges the normal components of the basis vectors are continuous .",
    ", title=\"fig:\",width=226 ]    the fields used in the computation are represented as expansions in terms of these basis elements .",
    "for example , @xmath72 for the prognostic geopotential and velocity fields , and @xmath73 for the relative vorticity field . here the sums are global sums over all basis elements in the relevant spaces . in some cases it will be useful to introduce dual space representations of fields ; these will be indicated by a hat symbol where necessary to distinguish them from the corresponding primal space representations .",
    "for example , @xmath74 the fields @xmath1 and @xmath75 have the same number of degrees of freedom , and it is possible construct a well - conditioned and reversible map between them by demanding that they agree when integrated against any test function in the primal space @xmath18 .",
    "similarly , the fields @xmath3 and @xmath76 have the same number of degrees of freedom , and it is possible construct a well - conditioned and reversible map between them by demanding that they agree when integrated against any test function in the primal space @xmath17 .",
    "it will also be useful to introduce spatially averaged versions of some fields .",
    "for example , @xmath77 here , @xmath78 and @xmath79 have the same number of degrees of freedom , and it is possible construct a well - conditioned and reversible map between them by demanding that they agree when integrated against any test function in the primal space @xmath16 .",
    "@xmath78 or @xmath79 can be obtained from @xmath1 by demanding that they agree when integrated against any test function in @xmath16 ; in effect this provides an averaging operation from @xmath18 to @xmath16 or @xmath19 .",
    "( however , we should not expect to be able to obtain @xmath1 from @xmath78 or @xmath79 , as this would require an un - averaging operation , which will be ill - conditioned if it exists at all . )",
    "it will be convenient to be able to refer to the vector of degrees of freedom for any field . to do this",
    ", we will use the same letter ( with hat , tilde or bar if needed ) but in upper case .",
    "thus , for example , @xmath80 will be the vector of values @xmath81 , @xmath82 will be the vector of values @xmath83 , etc .",
    "finite element schemes solve the governing equations by approximating the solution in the chosen function spaces , written as expansions in terms of basis functions ( e.g.  ( [ eqn_exp_v2 ] ) , ( [ eqn_exp_v1 ] ) ) , and demanding that the equations be satisfied in weak form , that is , when multiplied by any test function in the appropriate space and integrated over the domain . in this approach ( [ ctsmass ] ) becomes @xmath84 or , regarding the integral as an inner product for which we introduce angle backet notation , @xmath85 similarly , ( [ ctsvel ] ) becomes @xmath86 or @xmath87 ( the construction of the nonlinear terms @xmath88 , @xmath89 and @xmath90 is discussed in section  [ nonlinearswe ] below . )",
    "the method generally leads to a system of algebraic equations for the unknown coefficients in the expansion of the solution .",
    "the following subsections show how the mimetic finite element method can be re - expressed in terms of certain matrix operators acting on the coefficient vectors @xmath80 , @xmath91 , etc .",
    "the notation is chosen to highlight the similarity to the finite volume scheme of @xcite .",
    "the velocity basis elements are constructed and normalized so as to have constant divergence over the cell upwind of the edge where the degree of freedom resides , with area integral equal to @xmath46 , and constant divergence over the cell downwind of this edge , with area integral equal to @xmath92 , with zero velocity and hence zero divergence in all other cells .",
    "thus @xmath93 where @xmath94 is equal to @xmath46 when the normal at edge @xmath49 points out of cell @xmath59 , equal to @xmath92 when the normal at edge @xmath49 points into cell @xmath59 , and is zero otherwise .",
    "we will write @xmath95 for the matrix whose transpose has components @xmath94 .",
    "@xmath95 is called an incidence matrix because it describes some aspects of the grid topology .",
    "hence , the divergence @xmath96 of an arbitrary velocity field @xmath3 is @xmath97 equating coefficients of @xmath98 gives @xmath99 or , in matrix - vector notation @xmath100 note we could have demanded that ( [ eqn_div ] ) should hold when integrated against any test function in @xmath18 , to obtain the same result .",
    "however , this would obscure the fact that ( [ eqn_div ] ) actually holds at every point in the domain ( except on cell edges where all terms are discontinuous ) , not just when integrated against a test function . in this sense",
    ", @xmath101 is a _",
    "strong _ derivative operator .",
    "similarly , the basis elements in @xmath16 are constructed so that @xmath102 where @xmath103 is defined to equal @xmath46 if edge @xmath49 is incident on vertex @xmath45 and the unit tangent vector @xmath104 at edge @xmath49 points towards vertex @xmath45 , @xmath92 if it points away from vertex @xmath45 , and zero otherwise",
    ". the unit normal and unit tangent at any edge are related by @xmath105 .",
    "hence , a stream function @xmath34 is related to the corresponding rotational velocity field @xmath3 by @xmath106 equating coefficients of @xmath48 and defining @xmath107 to be the matrix whose entries are @xmath103 gives the matrix - vector form @xmath108 equation ( [ eqn_gradperp ] ) holds pointwise ( again with the exception of discontinuities ) , so @xmath109 is a strong derivative operator .",
    "the matrices @xmath107 and @xmath95 are exactly the same as in the finite volume framework of @xcite . in particular , they have the property that @xmath110 giving a discrete analogue of the continuous property @xmath111 .",
    "analogous relations hold on the dual spaces .",
    "@xmath112 implies that the discrete analogue of @xmath113 is @xmath114 where @xmath115 .",
    "similarly @xmath116 implies that the discrete analogue of @xmath117 is @xmath118 where @xmath119 .",
    "again , these are strong derivative operators .    the matrices @xmath120 and @xmath121 have the property @xmath122 giving a discrete analogue in the dual space of the continuous relation @xmath123 .",
    "define the following mass matrices for the primal function spaces : @xmath124 the expressions in parentheses indicate that @xmath125 maps @xmath18 to itself , etc .",
    "( analogous mass matrices may be defined for the dual spaces ; however , they will not be needed here . )",
    "the following matrices are also needed .",
    "@xmath126 for completeness we may also define @xmath127 though we will not need to employ this matrix in the shallow water scheme .    one further operator will be needed to construct the kinetic energy per unit mass .",
    "it is @xmath128 where @xmath129 is the area of primal cell  @xmath59 .",
    "all of these matrices can be precomputed , so that no quadrature needs to be done at run time .",
    "moreover , they are all sparse , so they can be efficiently stored as lists of stencils and coefficients .",
    "let @xmath15 be the coefficients of the expansion of the projection of @xmath130 into @xmath17 : @xmath131 using ( [ massm ] ) and ( [ operw ] ) gives the discrete version of the @xmath6 operator : @xmath132    demanding agreement between ( [ eqn_exp_v2 ] ) and ( [ eqn_exp_v0 ] ) when integrated against any test function in @xmath18 leads to @xmath133 similarly , demanding agreement between ( [ eqn_exp_v1 ] ) and ( [ eqn_exp_v1 ] ) when integrated against any test function in @xmath17 gives @xmath134 while demanding agreement between ( [ eqn_exp_v0 ] ) and ( [ eqn_exp_v2 ] ) when integrated against any test function in @xmath16 gives @xmath135 the relations ( [ eqn_hodge02 ] ) , ( [ eqn_hodge11 ] ) , ( [ eqn_hodge20 ] ) provide invertible maps between the primal and dual function spaces .",
    "thus , they are examples of discrete hodge star operators ( e.g. * ? ? ?",
    "they may be contrasted with the analogous relations employed by @xcite and @xcite for the finite volume case , which do not involve mass matrices .    demanding agreement between ( [ eqn_exp_v2 ] ) , ( [ eqn_exp_v0_bar ] ) , and ( [ eqn_exp_v2_tilde ] ) when integrated against any test function in @xmath16 leads to @xmath136 this is the matrix representation of the averaging operator discussed in section  [ sec_compound ] .",
    "a field in @xmath18 is discontinuous , so its gradient in @xmath17 can only be defined in a _ weak _ sense , by integrating against all test functions in @xmath17 .",
    "for example , @xmath137 must be approximated as @xmath138 where @xmath28 , @xmath139 .",
    "expanding both @xmath1 and @xmath140 in terms of basis elements and integrating by parts then leads to the matrix form @xmath141    similarly , the curl of a vector field in @xmath17 must be defined by integration against all test functions in @xmath16 .",
    "for example , the discrete analogue of @xmath142 after expanding in basis functions and integrating by parts , is @xmath143    combining these two results , the discrete analogue of @xmath144 is @xmath145 which is identically zero .    these derivative operators can be combined to obtain the laplacian of a scalar . for a scalar @xmath28 ,",
    "the discrete laplacian is @xmath146 . for a scalar @xmath147 ,",
    "the discrete laplacian is @xmath148 .",
    "the operators introduced above lead to a discrete version of the helmholtz decomposition , in which an arbitrary vector field is decomposed into its divergent and rotational parts : @xmath149 figure  [ opermap ] summarizes how the operators introduced here map between the different function spaces .",
    "the operators defined above satisfy some key relations that underpin the mimetic properties of the scheme .",
    "we have already seen that @xmath150 and @xmath122 leading to discrete analogues of @xmath111 and @xmath123 .",
    "next , note that the basis elements @xmath44 give a partition of unity , that is @xmath151 at every point in the domain .",
    "consequently @xmath152 and @xmath153    now let @xmath154 by considering the projection of @xmath155 into @xmath17 @xmath156 and integrating by parts and using the matrices defined in sections  [ deriv1 ] and  [ massmatrices ] , we obtain @xmath157 this identity is key to obtaining the steady geostrophic mode property ( section  [ geostrophic ] below ) .",
    "a rough interpretation is that averaging velocities to construct the coriolis terms ( @xmath158 ) then taking their divergence ( @xmath121 ) gives the same result as computing the velocity divergence ( @xmath95 ) followed by averaging to @xmath16 ( @xmath159 ) .",
    "one consequence is @xmath160 .",
    "an identical formula to ( [ trisk ] ) relating @xmath159 and @xmath158 was obtained by @xcite for the finite volume case .",
    "the result was originally derived for the construction of the coriolis terms on orthogonal grids by @xcite , and @xcite showed that it could be embedded in a more general framework applicable to nonorthogonal grids .",
    "moreover , @xcite showed that , for any given @xmath159 with the appropriate stencil ( which we have here ) and satisfying ( [ sumr ] ) , there is a unique antisymmetric @xmath158 satisfying ( [ trisk ] ) , and gave an explicit construction for @xmath158 in terms of @xmath159 .",
    "thus , although the context and interpretation are slightly different here , we can , nevertheless , use the thuburn et al .",
    "construction in implementing the mixed finite - element version of the @xmath158 operator !",
    "now consider the two representations of any vector field @xmath161 , @xmath162 related by @xmath163 so that @xmath164 since @xmath165 , @xmath166 and integrating by parts gives @xmath167 hence @xmath168 finally , substituting from ( [ uuhat ] ) and noting that @xmath82 is arbitrary gives @xmath169 the interpretation of this identity is that , for a velocity field in @xmath20 , taking the curl followed by mapping to the primal space is equivalent to mapping the velocity field to the primal space then taking its curl .",
    "one consequence is that @xmath170 .",
    "finally , let @xmath171 and @xmath172 be two discrete representations of a scalar field related by @xmath173 so that @xmath174 since @xmath175 for any @xmath70 , we have @xmath176 or , using ( [ xxhat ] ) and noting that @xmath177 is arbitrary , @xmath178    using these identities and the hodge star operators , it can be seen that taking a weak derivative in the primal space is equivalent to applying a hodge star to map to the dual space , taking a strong derivative in the dual space , and applying another hodge star to map back to the primal space : @xmath179 @xcite .",
    "thus , certain paths in fig .  [ opermap ] commute .",
    "weak derivative operators in the dual space can be defined by demanding a similar equivalence with primal space strong derivatives ; however , the resulting formulas are less elegant and , in any case , will not be needed .",
    "we first examine the spatial discretization of the linear shallow water equations to illustrate how some key conservation and balance properties arise .",
    "the rotating shallow water equations ( [ ctsmass ] ) , ( [ ctsvel ] ) when linearized about a resting basic state with constant geopotential @xmath180 and with constant coriolis parameter @xmath11 become @xmath181 by writing these in weak form ( analogous to ( [ weakmass ] ) and ( [ weakvel ] ) ) , expanding @xmath1 and @xmath3 in terms of basis functions , and using the notation and operators defined above , we obtain @xmath182      mass conservation is trivially satisfied ( for both the linear and nonlinear equations ) because the discrete divergence is a strong operator , so the domain integral of the discrete divergence of any vector field vanishes .      for the linearized equations the total energy is given by @xmath183 hence",
    ", the rate of change of total energy is @xmath184 where we have used the fact that @xmath125 and @xmath185 are symmetric , @xmath158 is antisymmetric , and @xmath186 .",
    "the linear shallow water equations support steady non - divergent flows in geostrophic balance . a numerical method must respect this property in order to be able to represent geostrophic balance .",
    "however , it is non - trivial to achieve this property because several ingredients must fall into place .",
    "* the geopotential @xmath1 must be steady .",
    "the steadiness of @xmath1 follows immediately from the assumption that @xmath187 .",
    "* the relative vorticity @xmath188 must be steady ; neither the pressure gradient nor the coriolis term should generate vorticity .",
    "first note that , from property list  1 , @xmath189 for some @xmath190 . taking the curl of the momentum equation",
    "then gives @xmath191 the pressure gradient term does not contribute because @xmath192 , and the coriolis term does not contribute because @xmath193 .",
    "* there must exist a geopotential @xmath1 that balances the coriolis term so that the divergence is steady .",
    "taking the divergence of the momentum equation gives the divergence tendency @xmath194 if we define @xmath195 and use the transpose of ( [ trisk ] ) we find that @xmath196 does indeed vanish ; thus the required @xmath1 does exist .",
    "consequently , the scheme does support steady geostrophic modes for the linearized equations .",
    "( note , it is not necessarily true that any given @xmath1 field can be balanced by some non - divergent velocity field . on some meshes , particularly those with triangular primal cells , there might not be enough velocity degrees of freedom to balance all possible @xmath1 fields . )",
    "a generalization of the steady geostrophic mode property is that the scheme should have a suitable pv equation . in this section",
    "we consider the linear case ; the nonlinear case is dealt with in section  [ nonlinearpv ] .",
    "the mass field @xmath1 and the vorticity field @xmath188 live in different spaces . to construct a suitable discrete pv",
    "we need an averaged mass field @xmath78 that lives in the same space as @xmath188 .",
    "the linearized pv should be independent of time .",
    "for this to hold , @xmath188 and @xmath78 must see the same divergence field .    for a general ( possibly divergent ) velocity field @xmath3",
    ", the vorticity equation ( [ linvort ] ) becomes @xmath197 define @xmath78 using ( [ eqn_avephi ] ) .",
    "then the evolution of @xmath78 is given by @xmath198 ( using ( [ trisk ] ) ) .",
    "thus , @xmath199 and @xmath200 see the same divergence @xmath201 ; consequently the linearized pv @xmath202 is independent of time .",
    "the nonlinear rotating shallow water equations are ( [ ctsmass ] ) and ( [ ctsvel ] ) . writing these in weak form ( [ weakmass ] ) and ( [ weakvel ] ) , and letting @xmath203 , @xmath204 , and @xmath205 be the vectors of coefficients for the discrete representations of the mass flux @xmath4 , the pv flux @xmath13 , and the kinetic energy per unit mass @xmath206 , the nonlinear discretization becomes @xmath207 the remaining issue is how to construct suitable values of the three nonlinear terms @xmath205 , @xmath203 , and @xmath208 .",
    "the discretization of @xmath90 follows the standard finite element construction , which is to project @xmath209 into @xmath17 .",
    "it may easily be verified that this is equivalent to projecting @xmath90 into @xmath18 before taking the weak gradient . using the @xmath210 operator defined in section  [ massmatrices ] ,",
    "the expansion coefficients @xmath205 of the projected @xmath90 are given by @xmath211      because the @xmath1 field is approximated as piecewise constant , its degrees of freedom can be interpreted as primal cell integrals .",
    "similarly , the degrees of freedom of the @xmath3 field are the integrals of the normal velocity fluxes across primal cell edges , and the @xmath95 operator looks exactly like a finite volume divergence operator .",
    "thus , it is straightforward to use a finite volume advection scheme for advection of @xmath1 .",
    "the mass flux is constructed using a forward in time advection scheme , identical to that used by @xcite , using the fluxes @xmath91 and the mass field @xmath80 as input .",
    "we write this symbolically as @xmath212 the subscript @xmath46 indicates that this version of the advection scheme operates on the primal mesh and works with densities or concentrations .",
    "so far we have not needed to use the dual mesh representation of any field . however , in order to use the same finite volume advection scheme as @xcite to compute pv fluxes , we need a piecewise constant representation of the pv field on dual cells , and a representation of the mass flux field in terms of components normal to dual cell edges .",
    "these are naturally given by the dual function spaces : @xmath213 and @xmath214 applying ( [ perp ] ) followed by ( [ eqn_hodge11 ] ) to the mass flux gives @xmath215    now consider the evolution of the dual mass field @xmath216 .",
    "@xmath217 i.e.   @xmath218 since @xmath121 acts exactly like a finite volume divergence operator on the dual mesh , @xmath216 behaves exactly as if it were evolving according to a finite volume advection scheme .",
    "next , in order for pv to evolve in a way consistent with the mass field @xmath216 , we construct pv fluxes in @xmath20 using the dual mesh finite volume advection scheme : @xmath219 the subscript  2 indicates that this version of the advection scheme operates on the dual mesh and works with quantities analogous to mixing ratios ( such as pv @xmath220 ) .",
    "finally , these dual mesh pv fluxes are mapped to the primal mesh for use in the momentum equation : @xmath221    it may be verified that the resulting vorticity equation for @xmath222 is indeed analogous to ( [ phibar ] ) , involving the potential vorticity flux @xmath223 . using ( [ eqn_hodge20 ] ) , ( [ xi ] ) , ( [ mudot ] ) and ( [ jdeqdh ] ) , we have @xmath224 hence , @xmath225 which is of the desired form .",
    "the similarity of ( [ dualpv ] ) and ( [ phibar ] ) means that it is possible to construct pv fluxes from the dual mass fluxes @xmath226 such that the evolution of the pv is consistent with the evolution of @xmath227 .",
    "the same time integration scheme as in @xcite is used .",
    "@xmath228 here , @xmath229 indicates the usual ( possibly off - centred ) crank - nicolson approximation to the integral over one time interval : @xmath230 ( for any field @xmath34 ) where @xmath231 .",
    "all results presented below use @xmath232 .",
    "@xmath233 is an approximation to the time integral of the mass flux across primal cell edges computed using the advection scheme .",
    "the velocity field used for the advection is @xmath234 .",
    "we write this symbolically as @xmath235 ( the notation @xmath236 , as distinct from @xmath237 in ( [ adv1 ] ) , indicates that here we are working with time integrals @xmath234 and @xmath233 . )    finally , @xmath238 is an approximation to the time integral of the pv flux across dual edges computed using the advection scheme .",
    "dual grid time integrated mass fluxes are calculated from the primal grid time integrated mass fluxes as @xmath239 these are then used in the dual grid advection scheme to compute the time integrated pv fluxes : @xmath240      the system ( [ timephi ] ) , ( [ timeu ] ) is nonlinear in the unknowns @xmath241 , @xmath242 .",
    "it can be solved efficiently using an incremental method ; this may be viewed as a newton method with an approximate jacobian .",
    "after @xmath243 iterations ( [ timephi ] ) and ( [ timeu ] ) will not be satisfied exactly but will have some residuals @xmath244 , @xmath245 defined by : @xmath246 here @xmath247 and @xmath248 are the approximations after @xmath243 iterations to @xmath241 and @xmath242 and it is understood that these have been used in evaluating @xmath233 , @xmath238 , and @xmath249 .",
    "we then seek updated values @xmath250 that will reduce the residuals , where the increments @xmath251 , @xmath252 satisfy @xmath253 @xmath254 here , @xmath255 is a reference value of @xmath1 ; in the current implementation it is given by @xmath256 interpolated to cell edges . to avoid the appearance of the non - sparse matrix @xmath257 in the helmholtz problem below ,",
    "a sparse approximation @xmath258 has been introduced . the construction of @xmath258 is briefly discussed in the appendix .",
    "eliminating @xmath252 leaves a helmholtz problem for @xmath251 : @xmath259 in the current implementation , the helmholtz problem is solved using a single sweep of a full multigrid algorithm .",
    "this gives sufficient accuracy to avoid harming the convergence rate of the newton iteration .",
    "once @xmath251 is found , @xmath252 is obtained by backsubstitution in ( [ uinc ] ) .",
    "finally , ( [ increment ] ) is used to obtain improved estimates for the unknowns .",
    "testing to date has given satisfactory results with 4  newton iterations .",
    "the algorithm requires the inversion of several of the linear operators represented as matrices above .",
    "the appendix describes how this is done .",
    "the same tests were applied to the finite element shallow water model as were applied to the finite volume model of @xcite .",
    "only a subset of results are shown here to emphasize the differences between the two models .",
    "other aspects are the following .",
    "* * stability . *",
    "all experimentation to date suggests the two models have the same stability limit : with no temporal off - centring ( @xmath232 ) the models are stable for large gravity wave courant numbers and advective courant numbers less than  1 . * * advection . *",
    "the same advection scheme is used in the two models to compute mass , pv , and tracer fluxes on primal and dual meshes . in particular , the models share the consistency between mass and pv , between mass and tracers , and between primal mass and dual mass discussed by @xcite . *",
    "* balance .",
    "* the balance test discussed in section  6.8 of @xcite was repeated for the finite element shallow water model .",
    "the results on both the hexagonal and cubed sphere meshes were very similar to those for the finite volume model and the endgame semi - implicit semi - lagrangian model @xcite , implying that any spurious numerical generation of imbalance is extremely weak . * * computational rossby modes . *",
    "the experiment to test the ability of the scheme on hexagonal meshes to handle grid - scale vorticity features was not repeated here .",
    "however , given the general arguments in @xcite ( see also * ? ? ?",
    "* ) , and the similarities between the numerics of the finite volume and finite element models , the results are expected to be very similar for the finite element model .        the discrete laplacian defined in section  [ deriv2 ] was applied to the @xmath18 representation of the field @xmath260 on the unit sphere , where @xmath261 is latitude and @xmath262 is longitude , and the @xmath14 and @xmath263 errors computed on different resolution meshes .",
    "the results are shown in table  [ tab : laplacian ] .",
    "for the inverses that occur once per time step , 10 jacobi iterations are used . for those that occur at every newton iteration ,",
    "2 jacobi iterations are used taking the solution obtained at the previous newton iteration as the first guess ( or ( [ jacobi_fg ] ) on the first newton iteration ) .",
    "a sparse approximate inverse @xmath258 of the @xmath17 mass matrix is needed for the helmholtz problem . on the hexagonal mesh",
    "it is sufficient to use a diagonal approximation @xmath264 however , on the cubed sphere mesh , whose dual and primal edges are not mutually orthogonal , such a diagonal approximation is less accurate and limits the convergence of the newton iterations",
    ". therefore we use instead an approximation based on a single jacobi iteration towards the inverse of @xmath185 : @xmath265 where @xmath266 is the identity matrix .",
    "this approximate inverse is not diagonal but has the same stencil as @xmath185 itself .",
    "cotter ,  c.  j. and thuburn ,  j. : a  finite element exterior calculus framework for the rotating shallow - water equations , j. comp .",
    ", 257 , 15061526 , 2014 .",
    "danilov ,  s. : on the utility of triangular c - grid type discretization for numerical modeling of large - scale ocean flows , ocean dyn . , 60 , 13611369 , 2010 .",
    "heikes ,  r. and randall ,  d. : numerical integration of the shallow - water equations on a  twisted icosahedral grid , part ii : a  detailed description of the grid and analysis of numerical accuracy , mon .",
    "weather rev .",
    ", 123 , 18811997 , 1995b",
    ".      le roux ,  d.  y. , rostand ,  v. , and pouliot ,  b. : analysis of numerically induced oscillations in 2d finite - element shallow - water models .",
    "part i : inertia - gravity waves , siam j. sci .",
    ", 29 , 331360 , 2007 .",
    "lock , s .- j . ,",
    "bitzer , h .- w . ,",
    "coals ,  a. , gadian ,  a. , and mobbs ,  s. : demonstration of a cut - cell representation of 3d orography for studies of atmospheric flows over very steep hills , mon .",
    "weather rev .",
    ", 140 , 411424 .",
    "mcrae , a.  t.  t. and cotter ,  c. : energy- and enstrophy - conserving schemes for the shallow - water equations , based on mimetic finite elements , submitted to q. j. r. meteorol .",
    "( available at http://dx.doi.org/10.1002/qj.2291 ) .",
    "ringler ,  t.  d. , thuburn ,  j. , klemp ,  j.  b. , and skamarock ,  w.  c. : a  unified approach to energy conservation and potential vorticity dynamics for arbitrarily structured c - grids , j. comput .",
    "phys . , 229 , 30653090 , 2010 .",
    "thuburn  j. , cotter ,  c.  j. , and dubos ,  t. : a  mimetic , semi - implicit , forward - in - time , finite volume shallow water model : comparison of hexagonal  icosahedral and cubed sphere grids , geosci . model dev . ,",
    "7 , 909929 , 2014 .",
    "ullrich ,  p.a .",
    ": understanding the treatment of waves in atmospheric models .",
    "part 1 : the shortest resolved waves of the 1d linearized shallow - water equations , quart .",
    "meteorol . soc . , 140 , 14261440 , 2014 .        williamson , d. l. , drake , j. b. , hack , j. j. , jakob , r. , and swartztrauber , p. n. : a standard test set for numerical approximations to the shallow water equations in spherical geometry , j. comput .",
    "phys . , 102 , 211224 , 1992 .",
    "zerroukat , m. , wood , n. , staniforth , a. , white , a. a. , and thuburn , j. : an inherently mass - conserving semi - implicit semi - lagrangian discretization of the shallow water equations on the sphere , quart .",
    "soc . , 135 , 11041116 , 2009 ."
  ],
  "abstract_text": [
    "<S> a new numerical method is presented for solving the rotating shallow water equations on a rotating sphere using quasi - uniform polygonal meshes . </S>",
    "<S> the method uses special families of finite element function spaces to mimic key mathematical properties of the continuous equations and thereby capture several desirable physical properties related to balance and conservation . </S>",
    "<S> the method relies on two novel features . </S>",
    "<S> the first is the use of _ compound finite elements _ to provide suitable finite element spaces on general polygonal meshes . </S>",
    "<S> the second is the use of _ dual finite element spaces _ on the dual of the original mesh , along with suitably defined discrete hodge star operators to map between the primal and dual meshes , enabling the use of a finite volume scheme on the dual mesh to compute potential vorticity fluxes . </S>",
    "<S> the resulting method has the same mimetic properties as a finite volume method presented previously , but is more accurate on a number of standard test cases .    </S>",
    "<S> compound finite element , dual finite element , mimetic , shallow water </S>"
  ]
}