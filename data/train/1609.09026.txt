{
  "article_text": [
    "let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath8 or in @xmath17 .",
    "let @xmath23 denote the number of incidences between the points of @xmath0 and the lines of @xmath2 ; that is , the number of pairs @xmath24 with @xmath25 , @xmath26 , and @xmath27 . if all the points of @xmath0 and all the lines of @xmath2 lie in a common 2-flat , then , in the real case , the classical szemerdi  trotter theorem  @xcite yields the worst - case tight bound @xmath28 the same bound also holds in the complex plane , as shown later by tth  @xcite and zahl  @xcite .",
    "this bound clearly also holds in @xmath8 and in @xmath17 , for any @xmath29 , by projecting the given lines and points onto some generic 2-flat .",
    "moreover , the bound will continue to be worst - case tight by placing all the points and lines in a common 2-flat , in a configuration that yields the planar lower bound .    in the 2010 groundbreaking paper of guth and katz  @xcite ,",
    "an improved bound for the real case has been derived for @xmath23 , for a set @xmath0 of @xmath1 points and a set @xmath2 of @xmath3 lines in @xmath30 , provided that not too many lines of @xmath2 lie in a common plane .",
    "specifically , they showed : input lines , but then they are able also to bound the number of intersection points of the lines .",
    "moreover , if one also assumes that each point is incident to at least three lines then the term @xmath1 in the bound can be dropped . ]    [ ttt ] let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath30 , and let @xmath31 be a parameter , such that no plane contains more than @xmath6 lines of @xmath2 .",
    "then @xmath32    this bound ( or , rather , an alternative formulation thereof ) was a major step in the derivation of the main result of @xcite , which was an almost - linear lower bound on the number of distinct distances determined by any finite set of points in the plane , a classical problem posed by erds in 1946  @xcite .",
    "guth and katz s proof uses several nontrivial tools from algebraic and differential geometry , most notably the cayley  salmon ",
    "monge theorem on osculating lines to algebraic surfaces in @xmath30 , and various properties of ruled surfaces .",
    "all this machinery comes on top of the major innovation of guth and katz , the introduction of the _ polynomial partitioning technique_.    for the purpose of the analysis in this paper , it is important to recall , right away , that the polynomial partitioning technique holds only over the reals",
    ". this will be the major stumbling block that we will face as we handle the complex case .",
    "we overcome ( or rather bypass ) it by exploiting the fact that all the lines are also contained in the given variety ; see below for details .    in four dimensions , and for the real case ,",
    "the authors established in @xcite a sharper and ( almost ) optimal bound .",
    "more precisely , they have shown :    [ th : mainfocs ] let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath4 , and let @xmath33 be parameters , such that ( i ) no hyperplane or quadric contains more than @xmath34 lines of @xmath2 , and ( ii ) no 2-flat contains more than @xmath6 lines of @xmath2 .",
    "then , @xmath35 for suitable ( absolute ) constant parameters @xmath36 and @xmath37",
    ". moreover , except for the factor @xmath38 , the bound is tight in the worst case , for all @xmath1 and @xmath3 and suitable ranges of @xmath34 and @xmath6 . for certain ranges of @xmath1 and @xmath3 the bound holds without that factor .",
    "[ [ our - results . ] ] our results .",
    "+ + + + + + + + + + + +    in this work we `` contest '' the leading terms @xmath39 ( for @xmath12 ) and @xmath40 ( for @xmath41 ) , and show that in many situations they can be significantly improved .",
    "see item ( 2 ) in the discussion in section  [ se : dis ] for further elaboration of this issue .",
    "a major feature of this work is that , in the setups considered here , the analysis can also be carried over to the complex domain , except for a small penalty that we pay for bypassing the polynomial partitioning technique , which , as noted , only holds over the reals .",
    "concretely , we assume that the points of @xmath0 lie on some algebraic variety , and derive significantly improved bounds when the degree of the variety is not too large . in the former case we assume that the points and the lines lie on a two - dimensional variety , which is allowed to be embedded in any @xmath8 , for @xmath9 . in the latter case",
    "we assume that the points ( but not necessarily the lines ) lie on a three - dimensional variety , embedded in any @xmath8 , for @xmath42 . in the former ( resp . ,",
    "latter ) case we also assume that the variety contains no plane ( resp . , no hyerplane or quadric ) .",
    "thus , in addition to improving the respective bounds in theorems  [ ttt ] and [ th : mainfocs ] , for the special cases under consideration , and in extending them to the complex domain , we obtain an extra bonus by extending the results to two - dimensional and three - dimensional varieties embedded in any higher dimension .",
    "[ [ points - on - a - two - dimensional - variety . ] ] points on a two - dimensional variety .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we derive two closely related results , one that holds over the real field and one that holds also over the complex field .",
    "it is simplest to think of the variety as embedded in @xmath30 or in @xmath16 .",
    "the real case is a special case of the setup of guth and katz  @xcite , where there is no need to use the polynomial partitioning method , because we assume that the points and lines all lie in a common surface ( the zero set of a polynomial ) of degree @xmath5 .",
    "this very assumption is also the one that lets us derive the ( slightly weaker ) version that holds over @xmath43 , thereby constituting a significant progress over the existing theory of incidences in three ( and higher ) dimensions .",
    "( to be more precise , over the reals we do apply the polynomial partitioning technique ( as a step in the application of the guth - katz bound ) , but only to a small subset of the lines . )    concretely , our first main result , for this setup , is the following theorem .",
    "[ th : main3d ] * ( a ) the real case : * let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath8 , for any @xmath9 , and let @xmath44 be two integer parameters , so that all the points and lines lie in a common two - dimensional algebraic variety @xmath45 of degree @xmath5 that does not contain any 2-flat , and so that no 2-flat contains more than @xmath6 lines of @xmath2 .",
    "then @xmath46    * ( b ) the complex case : * under exactly the same assumptions , when the ambient space is @xmath17 , for any @xmath9 , we have @xmath47    the assumption that @xmath6 is at most @xmath5 can be dropped , because , for any 2-flat @xmath48 , the intersection @xmath49 is a one - dimensional plane algebraic curve of degree at most @xmath5 in @xmath48 ( this holds since @xmath45 does not contain any 2-flat ) , and can therefore contain at most @xmath5 lines .",
    "we also have the following easy and interesting corollary .",
    "[ cor : main ] let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath8 or in @xmath17 , for any @xmath9 , such that all the points and lines lie in a common two - dimensional algebraic variety of constant degree that does not contain any 2-flat",
    ". then @xmath50 , where the constant of proportionality depends on the degree of the surface .    for @xmath12 ,",
    "the corollary can also be derived , for the real case , from the analysis in guth and katz  @xcite , using a somewhat different approach . moreover , although not explicitly stated there , it seems that the argument in @xcite also works over @xmath43 . as a matter of fact , the corollary can also be extended ( with a different bound though ) to the case where the containing surface may have planar components .",
    "see a remark to that effect in corollary  [ cor : mainx ] in the concluding section .",
    "we also exploit the proof technique of theorem  [ th : main3d ] to derive an upper bound of @xmath51 on the number of _",
    "@xmath52-rich points _ determined by a set of @xmath3 lines contained in a variety , as above , in both the real and complex cases .",
    "see section  [ se : dis ] for details .",
    "we note that if we only assume that the points lie on @xmath45 but the lines are arbitrary , we will incur the term @xmath14 , which we are trying to avoid . in the case of three - dimensional varieties , discussed below",
    ", we can not avoid this term even when the lines lie on the variety .",
    "the significance of theorem  [ th : main3d ] is fourfold :    \\(a ) first and foremost , the theorem yields a new incidence result for points and lines on a two - dimensional variety _ over the complex field _ , in three and higher dimensions .",
    "incidence results over the complex domain are rather rare .",
    "they include ( as already mentioned ) tth s extension of the szemerdi - trotter bound to the complex plane  @xcite , which was the only result of that kind that predated the introduction of the algebraic machinery by guth and katz , and several more recent works  @xcite ( where the latter work  @xcite provides an alternative algebraic derivarion of tth s bound ) .",
    "\\(b ) in the real three - dimensional case , the bound improves the guth ",
    "katz bound when @xmath53 , for two - dimensional varieties @xmath45 that do not contain planes .",
    "note that the threshold @xmath54 is a natural one because , as is well known and easy to show , any set of @xmath3 lines in @xmath30 admit a polynomial of degree @xmath55 whose zero set contains all the lines ; a simple modification of the construction applies in higher dimensions too .",
    "( of course the comparison is far from perfect , because this polynomial may have many linear components , in which case our bound does not apply .",
    "still , it offers some basis for evaluating the quality of our bound . ) in three dimensions , this threshold is in fact larger than the standard degree @xmath56 used in the analysis of guth and katz  @xcite , when @xmath57 .",
    "\\(c ) another significant feature of our bound is that it does not contain the term @xmath58 , which arises naturally in @xcite and other works , and seems to be unavoidable when @xmath0 is an arbitrary set of points .",
    "when @xmath59 is not a constant , this becomes a crucial feature of the new bound , which has already been exploited in the analysis in  @xcite , and is also used in the second main result of this paper , theorem  [ th : main4d ] below .",
    "does contain the term @xmath58 , it still crucially relies on the absence of this term in the bound for two - dimensional varieties . ]",
    "see an additional discussion of this feature at the end of the paper .",
    "\\(d ) it offers a sharper point - line incidence bound in arbitrary dimensions , for the special case assumed in the theorem ( which again holds over the complex field too ) .",
    "theorem  [ th : main3d](a ) has been used , as one of the key tools , in the analysis in our paper  @xcite on incidences between points and lines in four dimensions ( see below ) . in this application ,",
    "the absence of the term @xmath58 is a crucial feature of our result , which was required in the scenario considered in @xcite .",
    "the proof of theorem  [ th : main3d ] makes extensive use of several properties of ruled surfaces in @xmath30 or in @xmath16 .",
    "while these results exist as folklore in the literature , and short proofs are provided for some of them , e .. g . , in @xcite , we include here detailed and rigorous proofs thereof , making them more accessible to the combinatorial geometry community .",
    "other recent expositions include guth s recent survey  @xcite and book  @xcite , and a survey by kollr  @xcite .",
    "[ [ points - on - a - three - dimensional - variety . ] ] points on a three - dimensional variety .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    our second main result deals with the case where the points lie on a three - dimensional variety , embedded in @xmath4 or in @xmath19 , or in any higher dimension .",
    "similar to the three - dimensional case discussed above , we have to be careful here too , because hyperplanes and 3-quadrics ( in @xmath4 , and , aposteriorily , in @xmath19 too ) admit `` too many '' incidences in the worst case .",
    "that is , by a generalization of elekes s construction  @xcite , there exists a configuration of @xmath1 points and @xmath3 lines on a 3-flat with @xmath60 incidences .",
    "more recently , solomon and zhang  @xcite established an analogous statement for three - dimensional quadrics , when @xmath61 . concretely , for such values of @xmath1 and @xmath3 , they have constructed a quadric @xmath62 , a set @xmath0 of @xmath1 points on @xmath63 , and a set @xmath2 of @xmath3 lines contained in @xmath63 , so that ( i ) the number of lines in any common 2-flat is @xmath64 , ( ii ) the number of lines in any hyperplane is @xmath65 , and ( iii ) the number of incidences between the points and lines is @xmath66 , which is asymptotically larger than the corresponding bound in ( [ ma : in0 ] ) ( for @xmath67 ) , when @xmath68 .    in other words , when studying incidences with points on a variety in @xmath4 or in @xmath19 , the cases where the variety is ( or contains ) a hyperplane or a quadric are special and do not yield sharper bounds .",
    "( in the real case , the case of a hyperplane puts us back in @xmath30 , where the best bound is guth and katz s in theorem  [ ttt ] , and the case of a quadric reduces to the same setup via a suitable generic projection onto @xmath30 . ) in the second main result of this paper , we show that if all the points lie on a three - dimensional algebraic variety of degree @xmath59 without 3-flat or 3-quadric components , and if no 2-flat contains more than @xmath6 lines , then , if @xmath59 and @xmath6 are not too large , the bound becomes significantly smaller .",
    "moreover , here too we get a real version and a complex version of the theorem .",
    "specifically , we show :    [ th : main4d ] * ( a ) the real case : * let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath8 , for any @xmath69 , and let @xmath6 and @xmath59 be parameters , such that ( i ) all the points of @xmath0 lie on a three - dimensional algebraic variety of degree @xmath5 , without 3-flat or 3-quadric components , and ( ii ) no 2-flat contains more than @xmath6 lines of @xmath2 .",
    "then @xmath70 when @xmath59 and @xmath6 are constants , we get the linear bound @xmath71 .    *",
    "( b ) the complex case : * under exactly the same assumptions , when the ambient space is @xmath17 , for any @xmath42 , we have @xmath72    * remarks . ( 1 )",
    "* note that for @xmath73 , our bound for the real case is sharper than the bound of guth and katz  @xcite ( note that @xmath74 is the degree of the partitioning polynomial used in the analysis of @xcite for @xmath75 ) . on the other hand , when @xmath76 , our bound is not the best possible . indeed , in this case we can project @xmath0 and @xmath2 onto some generic @xmath77-flat , and apply instead the bound of  @xcite to the projected points and lines ( we also show that a generic choice of the image @xmath77-flat also ensures that no @xmath52-flat contains more than @xmath6 of the projected lines ) , which is sharper than ours for these values of @xmath59 . in the complex case",
    ", we also need to assume that @xmath59 is small enough so that the term @xmath78 does not dominate the other terms , so as to make the bound look like the bound in the real case .",
    "[ ma : incplx ]    * ( 2 ) * as already noted earlier , here we do not have to insist that the lines of @xmath2 be contained in the variety .",
    "a line not contained in a variety of degree @xmath59 can intersect it at most @xmath59 time , so the number of incidences with such lines is at most @xmath58 .",
    "( the actual argument that yields this term is more involved , because we apply the argument to a variety of larger degree ; see below for details . ) for two - dimensional varieties , since we want to avoid this term , we require the lines to be contained in the variety . here , since we allow this term , the lines can be arbitrary .    *",
    "( 3 ) * the assumption that the points of @xmath0 lie on a variety is not as restrictive as it might sound , because , in four dimensions , one can always construct a polynomial @xmath79 of degree @xmath80 whose zero set contains all the given points , or alternatively , a polynomial @xmath79 of degree @xmath81 whose zero set fully contains all the given lines .",
    "the assumptions become restrictive , and the bound becomes more interesting , when @xmath59 is significantly smaller .",
    "in addition , the constructed polynomial @xmath79 could be one for which @xmath82 does contain 3-flats or 3-quadrics , so another restrictive aspect of our assumptions is that they exclude these situations .",
    "similar to the case of a two - dimensional variety , we also have the following easy and interesting corollary ( it does not hold when @xmath45 contains 3-flats or 3-quadrics , in light of the lower bound constructions in @xcite ) .",
    "[ cor : main4d ] let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath8 or in @xmath17 , for any @xmath42 , such that all the points and lines lie in a common three - dimensional algebraic variety @xmath45 of constant degree that does not contain any 3-flats or 3-quadrics , and no 2-flat contains more than @xmath64 lines of @xmath2",
    ". then @xmath50 , where the constant of proportionality depends on the degree of @xmath45 .",
    "theorem  [ th : main3d ] is a key technical ingredient in the proof of theorem  [ th : main4d ] .",
    "the proofs of both theorems are somewhat technical , and use a battery of sophisticated tools from algebraic geometry .",
    "some of these tools are borrowed and adapted from our previous work  @xcite .",
    "other tools involve properties of ruled surfaces , which , as already said , are established here rigorously , for the sake of completeness .",
    "since most of the presentation and derivation of these results is within the scope of algebraic and differential geometry , we delegate most of this part to an appendix , keeping only a brief overview in the following section .",
    "the proof of theorem  [ th : main3d ] is then presented in section  [ ssec : pfa ] , and the proof of theorem  [ th : main4d ] is presented in section [ sec : pfmain ] . the concluding section  [ se : dis ] discusses our results , establishes a few consequences thereof , and raises several related open problems .",
    "in this section we present a brief overview of ruled surfaces and some of the algebraic machinery .",
    "full details are given in the appendix .",
    "[ [ ruled - surfaces . ] ] ruled surfaces .",
    "+ + + + + + + + + + + + + + +    we say that a real ( resp . ,",
    "complex ) surface @xmath45 is _ ruled by real _",
    ", _ complex _ ) _ lines _ if every point @xmath83 is incident to a real ( resp .",
    ", complex ) line that is fully contained in @xmath45 .",
    "the surface is _ doubly ruled _ if each point is incident to two distinct lines that are fully contained in @xmath45 .",
    "see the appendix for a slightly looser definition and more details , including the not - so - extensive literature on ruled surfaces .",
    "the recent survey  @xcite and book  @xcite , as well as an exposition in  @xcite make up for this sparsity .",
    "[ [ flecnodes - in - three - dimensions - and - the - cayleysalmonmonge - theorem . ] ] flecnodes in three dimensions and the cayley  salmon  monge theorem .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we first recall the classical theorem of cayley and salmon , also due to monge .",
    "consider a polynomial @xmath84 $ ] of degree @xmath85 .",
    "flecnode _ of @xmath79 is a point @xmath86 on the zero set @xmath82 of @xmath79 , for which there exists a line that is incident to @xmath86 and _ osculates _ to @xmath82 at @xmath86 to order three .",
    "that is , if the direction of the line is @xmath87 then @xmath88 , and @xmath89 , where @xmath90 are , respectively , the first , second , and third - order derivatives of @xmath79 in the direction @xmath87 .",
    "the _ flecnode polynomial _ of @xmath79 , denoted @xmath91 , is the polynomial obtained by eliminating @xmath87 , via resultants , from these three homogeneous equations ( where @xmath86 is regarded as a fixed parameter ) . as shown in salmon  ( * ? ? ?",
    "* chapter xvii , section iii ) , the degree of @xmath91 is at most @xmath92 . by construction , the flecnode polynomial of @xmath79 vanishes on all the flecnodes of @xmath79 , and in particular on all the lines fully contained in @xmath82 .",
    "[ th : flec2a ] let @xmath84 $ ] be a polynomial of degree @xmath93",
    ". then @xmath82 is ruled by ( complex ) lines if and only if @xmath94 .    the notions of flecnodes and of the flecnode polynomial can be extended to four dimensions , as done in  @xcite . informally ,",
    "the _ four - dimensional flecnode polynomial _",
    "@xmath95 of a 4-variate polynomial @xmath79 is defined analogously to the three - dimensional variant @xmath91 , and captures the property that a point on @xmath82 is incident to a line that osculates to @xmath82 up to the _ fourth _ order .",
    "it is obtained by eliminating the direction @xmath87 of the osculating line , using resultants , from the four homogeneous equations given by the vanishing of the first four terms of the taylor expansion of @xmath96 near @xmath86 . clearly , @xmath95 vanishes identically on every line that is fully contained in @xmath82 . as in the three - dimensional case",
    ", its degree can be shown to be @xmath97 .",
    "landsberg  @xcite derives an analog of theorem  [ th : flec2a ] that holds for three - dimensional surfaces ( see  ( * ? ? ?",
    "* theorem 2.11 ) ) .",
    "specifically , landsberg s theorem asserts that if @xmath95 vanishes identically on @xmath82 , then @xmath82 is ruled by ( possibly complex ) lines .",
    "we will discuss this in more detail in section  [ sec : pfmain ] .",
    "these theorems , in three and four dimensions , play an important role in the proofs of the main theorems .",
    "[ [ reguli . ] ] reguli .",
    "+ + + + + + +    a _ regulus _ is the surface ( in @xmath30 or @xmath16 ) spanned by all lines that meet three pairwise skew lines in @xmath77-space . for an elementary proof that a doubly ruled surface over @xmath98 must be a regulus",
    ", we refer the reader to fuchs and tabachnikov  ( * ? ? ?",
    "* theorem 16.4 ) .",
    "we give in the appendix a proof of the following more general characterization of doubly ruled surfaces in @xmath30 or @xmath16 .",
    "[ doubly ] let @xmath45 be an irreducible ruled surface in @xmath30 or in @xmath16 which is not a plane , and let @xmath99 be an algebraic curve , such that every non - singular point @xmath100 is incident to exactly two lines that are fully contained in @xmath45 . then @xmath45 is a regulus .    [ [ singly - ruled - surfaces . ] ] singly ruled surfaces .",
    "+ + + + + + + + + + + + + + + + + + + + + +    ruled surfaces that are neither planes nor reguli are called _ singly ruled _ surfaces ( a terminology justified by theorem  [ singly ] , given below ) .",
    "a line @xmath101 , fully contained in an irreducible singly ruled surface @xmath45 , such that every point of @xmath101 is `` doubly ruled '' , i.e. , every point on @xmath101 is incident to another line fully contained in @xmath45 , is called an _ exceptional _ line of @xmath45 .",
    "a point @xmath102 that is incident to infinitely many lines fully contained in @xmath45 is called an _ exceptional _ point of @xmath45 .    the following result is another folklore result in the theory of ruled surfaces , used in many studies ( such as guth and katz  @xcite ) .",
    "it justifies the terminology `` singly - ruled surface '' , by showing that the surface is generated by a one - dimensional family of lines , and that each point on the surface , with the possible exception of points lying on some curve , is incident to exactly one generator .",
    "it also shows that there are only finitely many exceptional lines ; the property that their number is at most two ( see  @xcite ) is presented later .",
    "we give ( in the appendix ) a detailed and rigorous proof , to make our presentation as self - contained as possible ; we are not aware of any similarly detailed argument in the literature .",
    "[ singly ] ( a ) let @xmath45 be an irreducible ruled two - dimensional surface of degree @xmath103 in @xmath30 ( or in @xmath16 ) , which is not a regulus . then , except for finitely many exceptional lines , the lines that are fully contained in @xmath45 are parameterized by an irreducible algebraic curve @xmath104 ( in the parametric plcker space @xmath105 that represents lines in 3-space ; see the appendix ) , and thus yield a 1-parameter family of generator lines @xmath106 , for @xmath107 , that depend continuously on the real or complex parameter @xmath108 . moreover , if @xmath109 , and @xmath110 , then there exist sufficiently small and disjoint neighborhoods @xmath111 of @xmath112 and @xmath113 of @xmath114 , such that all the lines @xmath106 , for @xmath115 , are distinct .",
    "\\(b ) there exists a one - dimensional curve @xmath99 , such that any point @xmath86 in @xmath116 is incident to exactly one line fully contained in @xmath45 .",
    "[ [ exceptional - lines - on - a - singly - ruled - surface . ] ] exceptional lines on a singly ruled surface .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in view of theorem  [ singly ] , every point on a singly ruled surface @xmath45 is incident to at least one generator .",
    "hence an exceptional ( non - generator ) line is a line @xmath117 such that every point on @xmath101 is incident to a generator ( which is different from @xmath101 ) . we establish in the appendix the following property .",
    "[ only2exc ] let @xmath45 be an irreducible ruled surface in @xmath30 or in @xmath16 , which is neither a plane nor a regulus .",
    "then ( i ) @xmath45 contains at most two exceptional lines , and ( ii ) @xmath45 contains at most one exceptional point .    [ [ generic - projections - preserve - non - planarity . ] ] generic projections preserve non - planarity .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the analysis in section  [ ssec : pfa ] , the goal is to project @xmath8 onto some generic 3-flat so that non - coplanar triples of lines do not project to coplanar triples .",
    "this is easily achieved by repeated applications of the following technical result , reducing the dimension one step at a time .",
    "[ ap : th ] let @xmath118 be three non - coplanar lines in @xmath8 , for @xmath42 .",
    "then , under a generic projection of @xmath8 onto some hyperplane @xmath119 , the respective images @xmath120 of these lines are still non - coplanar .",
    "[ [ real-vs.complex . ] ] real vs.  complex .",
    "+ + + + + + + + + + + + + + + + +    with a few exceptions , our analysis holds over the complex field too , and therefore most of the unfolding analysis is carried out over @xmath43 , the main reason being that most of the basic tools in algebraic geometry only hold over @xmath43 ( or other algebraically closed fields ) .",
    "there are a few places , though , where the analysis holds only over the reals , such as in the ( explicit or implicit ) applications of the polynomial partitioning technique of guth and katz  @xcite .",
    "passing to the complex domain ( and sometimes also to the projective setting ) does not pose any difficulties for upper bounds in real incidence problems  every real incidence will be preserved , and at worst we will be counting additional incidences , on the non - real portion of the extended varieties . with this understanding , and with the appropriate caution , we will move freely between the real and complex domains , as convenient , staying mostly in the complex domain .",
    "in most of the analysis in this section , we will consider the case @xmath12 .",
    "the reduction from an arbitrary dimension to @xmath12 will be presented at the end of the section .",
    "we will prove both parts of the theorem `` hand in hand '' , bifurcating ( in a significant manner ) only towards the end of the analysis .",
    "for a point @xmath86 on an irreducible singly ruled surface @xmath45 , which is not the exceptional point of @xmath45 ( see section  [ se : pre ] and the appendix for its definition ) , we let @xmath121 denote the number of generator lines incident to @xmath86 and fully contained in @xmath45 ( so if @xmath86 is incident to an exceptional line , we do not count that line in @xmath121 ) .",
    "we also put @xmath122 .",
    "finally , if @xmath45 is a cone and @xmath123 is its exceptional point ( that is , apex ) , we put @xmath124 .",
    "we also consider a variant of this notation , where we are also given a finite set @xmath2 of lines ( where not all lines of @xmath2 are necessarily contained in @xmath45 ) , which does not contain any of the ( at most two ) exceptional lines of @xmath45 .",
    "for a point @xmath83 , we let @xmath125 denote the number of lines in @xmath2 that pass through @xmath86 and are fully contained in @xmath45 , with the same provisions as above , namely that we do not count incidences with exceptional lines , nor do we count incidences occurring at an exceptional point , and put @xmath126 . if @xmath45 is a cone with apex @xmath123 , we put @xmath127 .",
    "we clearly have @xmath128 and @xmath129 , for each point @xmath86 .",
    "[ firstflip ] let @xmath45 be an irreducible singly ruled two - dimensional surface of degree @xmath103 in @xmath30 or in @xmath16 .",
    "then , for any line @xmath101 , except for the ( at most ) two exceptional lines of @xmath45 , we have @xmath130    * proof . * to streamline the analysis and avoid degenerate situations that might arise over the reals , we confine ourselves to the complex case",
    "; as already mentioned , the incidence bounds that we will obtain will automatically hold over the reals too .",
    "we note that the difference between the two cases arises because we do not want to count @xmath101 itself ",
    "the former sum would be infinite when @xmath101 is fully contained in @xmath45 .",
    "note also that if @xmath45 is a cone and @xmath131 , we ignore in the sum the infinitely many lines incident to @xmath123 and contained in @xmath45 .",
    "the proof is a variant of an observation due to salmon  @xcite and repeated in guth and katz  @xcite over the real numbers , and later in kollr  @xcite over the complex field and other general fields .    by theorem  [ singly](a ) , excluding the exceptional lines of @xmath45 , the set of lines fully contained in @xmath45 can be parameterized as a ( real or complex ) 1-parameter family of generator lines @xmath106 , represented by the irreducible curve @xmath132 .",
    "let @xmath133 denote the locus of points of @xmath45 that are incident to at least two generator lines fully contained in @xmath45 . by theorem  [ singly](b ) , @xmath133",
    "is contained in some one - dimensional curve @xmath134 .",
    "let @xmath135 be a point incident to @xmath136 generator lines of @xmath45 , other than @xmath101 , for some @xmath137 . in case @xmath45",
    "is a cone , we assume that @xmath138 . denote the generator lines incident to @xmath86 ( other than @xmath101 , if @xmath117 , in which case it is assumed to be a generator ) as @xmath139 , for @xmath140 and for @xmath141 .",
    "( if @xmath142 is a singular point of @xmath143 , it may arise as @xmath144 for several values of @xmath145 , and we pick one arbitrary such value . ) let @xmath48 be a generic plane containing @xmath101 , and consider the curve @xmath146 , which is a plane curve of degree @xmath59 .",
    "since @xmath147 is one - dimensional , a generic choice of @xmath48 will ensure that @xmath148 is a discrete set ( since @xmath101 is non - exceptional , it too meets @xmath133 in a discrete set ) .",
    "there are two cases to consider : if @xmath101 is fully contained in @xmath45 ( and is thus a generator ) , then @xmath149 contains @xmath101 . in this case , let @xmath150 denote the closure of @xmath151 ; it is also a plane algebraic curve , of degree at most @xmath152 .",
    "otherwise , we put @xmath153 . by theorem  [ singly](a ) , we can take , for each @xmath141 , a sufficiently small open ( real or complex ) neighborhood @xmath154 along @xmath104 containing @xmath145 , so that , for any @xmath155 , all the lines @xmath106 , for @xmath156 , are distinct . put @xmath157 . recall that @xmath158 is either a simple arc or a union of simple arcs meeting at @xmath86 ( depending on whether or not @xmath142 is a regular point of @xmath104 ) ; in the latter case , take @xmath159 to be any one of these arcs .",
    "each of the arcs @xmath159 is incident to @xmath86 and is contained in @xmath150 .",
    "moreover , since @xmath48 is generic , the arcs @xmath159 are all distinct .",
    "indeed , for any @xmath160 , and any point @xmath161 , there exist @xmath162 such that @xmath163 , and @xmath164 ( by the properties of these neighborhoods ) . therefore , any point in @xmath165 is incident to ( at least ) two distinct generator lines fully contained in @xmath45 .",
    "again , the generic choice of @xmath48 ensures that @xmath166 is a discrete set , so , in particular , @xmath159 and @xmath167 are distinct .",
    "we have therefore shown that ( i ) if @xmath101 is not contained in @xmath45 then @xmath86 is a singular point of @xmath150 of multiplicity at least @xmath136 ( for @xmath168 ; when @xmath169 the point does not have to be singular ) , and ( ii ) if @xmath101 is contained in @xmath45 then @xmath86 is singular of multiplicity at least @xmath170 .",
    "we have @xmath171 ( resp . ,",
    "@xmath172 ) if @xmath101 is not fully contained ( resp .",
    ", is fully contained ) in @xmath45 .",
    "as argued at the beginning of section  [ sec : ruled ] , the line @xmath101 can intersect @xmath150 in at most @xmath5 points , _ counted with multiplicity _ , and the result follows .    50 @xmath173 = 0    we also need the following result , established by guth and katz  @xcite ; see also @xcite .",
    "it is an immediate consequence of the cayley  salmon ",
    "monge theorem ( theorem  [ th : flec2a ] ) and a suitable extension of bzout s theorem for intersecting surfaces ( see fulton  ( * ? ? ?",
    "* proposition 2.3 ) ) .",
    "[ guth and katz ] [ caysala ] let @xmath45 be an irreducible two - dimensional variety in @xmath16 of degree @xmath5 .",
    "if @xmath45 fully contains more than @xmath174 lines then @xmath45 is ruled by ( complex ) lines .",
    "[ co : caysala ] let @xmath45 be an irreducible two - dimensional variety in @xmath16 of degree @xmath5 that does not contain any planes",
    ". then the number of lines that are fully contained in the union of the non - ruled components of @xmath45 is @xmath175 .",
    "* let @xmath176 denote those irreducible components of @xmath45 that are not ruled by lines . by proposition  [ caysala ] , for each @xmath177 ,",
    "the number of lines fully contained in @xmath178 is at most @xmath179 .",
    "summing over @xmath141 , the number of lines fully contained in the union of the non - ruled components of @xmath45 is at most @xmath180 .",
    "50 @xmath173 = 0    the following theorem , which we believe to be of independent interest in itself , is the main technical ingredient of our analysis .",
    "note that it holds over both real and complex fields .",
    "[ salta ] let @xmath45 be a possibly reducible two - dimensional algebraic surface of degree @xmath181 in @xmath30 or in @xmath16 , with no linear components .",
    "let @xmath0 be a set of @xmath1 distinct points on @xmath45 and let @xmath2 be a set of @xmath3 distinct lines fully contained in @xmath45 .",
    "then there exists a subset @xmath182 of at most @xmath175 lines , such that the number of incidences between @xmath0 and @xmath183 satisfies @xmath184    * remark . *",
    "an important feature of the theorem , already noted for the more general theorem  [ th : main3d ] , and discussed in more detail later on , is that the bound in ( [ lmlstara ] ) avoids the term @xmath58 , which arises naturally in many earlier works , e.g. , when bounding the number of incidences between points on @xmath45 and lines not crossing @xmath45 .",
    "this is significant when @xmath59 is large ",
    "see below .",
    "* proof . * as in the proof of lemma  [ firstflip ] , we only work over @xmath43 , and the results are then easily transported to the real case too . consider the irreducible components @xmath185 of @xmath45 . by corollary  [ co : caysala ] ,",
    "the number of lines contained in the union of the non - ruled components of @xmath45 is @xmath175 , and we place all these lines in the exceptional set @xmath186 . in what follows",
    "we thus consider only ruled components of @xmath45 . for simplicity , continue to denote them as @xmath185 , and note that @xmath187 .",
    "we further augment @xmath186 as follows .",
    "we first dispose of lines of @xmath2 that are fully contained in more than one ruled component @xmath188 .",
    "we claim that their number is @xmath189 . indeed , for any pair @xmath188",
    ", @xmath190 of distinct components , the intersection @xmath191 is a curve of degree ( at most ) @xmath192 , which can therefore contain at most @xmath192 lines ( by the generalized version of bzout s theorem  ( * ? ? ?",
    "* proposition 2.3 ) , already mentioned in connection with proposition  [ caysala ] ) . since @xmath193",
    ", we have @xmath194 as claimed .",
    "we add to @xmath186 all the @xmath189 lines in @xmath2 that are contained in more than one ruled component , and all the exceptional lines of all singly ruled components .",
    "the number of lines of the latter kind is at most @xmath195 , so the size of @xmath196 is still @xmath189 .",
    "hence , each line of @xmath197 is fully contained in a unique ( singly or doubly ) ruled component of @xmath45 , and is a generator of that component .",
    "the strategy of the proof is to consider each line @xmath101 of @xmath198 , and to estimate the number of its incidences with the points of @xmath0 in an indirect manner , via lemma  [ firstflip ] , applied to @xmath101 and to each of the ruled components @xmath190 of @xmath45 .",
    "we recall that @xmath101 is fully contained in a unique component @xmath188 , and treat that component in a somewhat different manner than the treatment of the other components .    in more detail",
    ", we proceed as follows .",
    "we first ignore , for each singly ruled _ conic _ component @xmath188 , the incidences between its apex ( exceptional point ) @xmath199 and the lines of @xmath198 that are contained in @xmath188 .",
    "we refer to these incidences as _ conical incidences _ and to the other incidences as _ non - conical_. when we talk about a line @xmath101 incident to another line @xmath200 at a point @xmath86 , we will say that @xmath101 is _ conically incident _ to @xmath200 ( at @xmath86 ) if @xmath86 is the apex of some conic component @xmath188 and @xmath200 is fully contained in @xmath188 ( and thus incident to @xmath86 ) . in all other cases , we will say that @xmath101 is _ non - conically incident _ to @xmath200 ( at @xmath86 ) .",
    "( note that this definition is asymmetric in @xmath101 and @xmath200 ; in particular , @xmath101 does not have to lie in the cone @xmath188 . )",
    "we note that the number of conical point - line incidences is at most @xmath3 , because each line of @xmath198 is fully contained in a unique component @xmath188 , so it can be involved in at most one conical incidence ( at the apex of @xmath188 , when @xmath188 is a cone ) .",
    "we next prune away points @xmath25 that are non - conically incident to at most three lines of @xmath198 .",
    "( note that @xmath86 might be an apex of some conic component(s ) of @xmath45 ; in this case @xmath86 is removed if it is incident to at most three lines of @xmath198 that are not contained in any of these components . )",
    "we lose @xmath201 ( non - conical ) incidences in this process .",
    "let @xmath202 denote the subset of the remaining points .",
    "[ claim:4d ] each line @xmath203 is non - conically incident , at points of @xmath202 , to at most @xmath204 other lines of @xmath198 .",
    "* fix a line @xmath203 and let @xmath188 denote the unique ruled component that fully contains @xmath101 .",
    "let @xmath190 be any of the other ruled components .",
    "we estimate the number of lines of @xmath198 that are non - conically incident to @xmath101 and are fully contained in @xmath190 .",
    "if @xmath190 is a regulus , there are at most four such lines , since @xmath101 meets the quadratic surface @xmath190 in at most two points , each incident to exactly two generators ( and to no other lines contained in @xmath190 ) . in this case , we write the bound @xmath205 as @xmath206 .",
    "assume then that @xmath190 is singly ruled .",
    "by lemma  [ firstflip ] , we have @xmath207 note that , by definition , the above sum counts only non - conical incidences ( and only with generators of @xmath190 , but the exceptional lines of @xmath190 have been removed from @xmath198 anyway ) .",
    "we sum this bound over all components @xmath208 , including the reguli .",
    "denoting the number of reguli by @xmath209 , which is at most @xmath210 , we obtain a total of @xmath211 consider next the component @xmath188 containing @xmath101 .",
    "assume first that @xmath188 is a regulus .",
    "each point @xmath212 can be incident to at most one other line of @xmath198 contained in @xmath188 ( the other generator of @xmath188 through @xmath86 ) . since @xmath86 is in @xmath202",
    ", it is non - conically incident to at least @xmath213 other line of @xmath198 , contained in some other ruled component of @xmath45 .",
    "that is , the number of lines that are ( non - conically ) incident to @xmath101 and are contained in @xmath188 , which apriorily can be arbitrarily large , is nevertheless at most the number of other lines ( not contained in @xmath188 ) that are non - conically incident to @xmath101 , which , as shown above , is at most @xmath214 .",
    "if @xmath188 is not a regulus , lemma  [ firstflip ] implies that @xmath215 where again only non - conical incidences are counted in this sum ( and only with generators ) .",
    "that is , the number of lines of @xmath198 that are non - conically incident to @xmath101 ( at points of @xmath202 ) and are contained in @xmath188 is at most @xmath5 . adding the bound for @xmath188 , which has just been shown to be either @xmath59 or @xmath216 , to the bound @xmath214 for the other components , the claim follows .    50 @xmath173 = 0    to proceed ,",
    "choose a threshold parameter @xmath217 , to be determined shortly .",
    "each point @xmath218 that is non - conically incident to at most @xmath219 lines of @xmath2 contributes at most @xmath219 ( non - conical ) incidences , for a total of at most @xmath220 incidences .",
    "( recall that the overall number of conical incidences is at most @xmath3 . ) for the remaining non - conical incidences , let @xmath101 be a line in @xmath198 that is incident to @xmath108 points of @xmath202 , so that each such point @xmath86 is non - conically incident to at least @xmath221 lines of @xmath198 ( one of which is @xmath101 ) .",
    "it then follows from lemma  [ claim:4d ] that @xmath222 .",
    "hence , summing this over all @xmath223 , we obtain a total of at most @xmath224 incidences .",
    "we can now bring back the removed points of @xmath225 , since the non - conical incidences that they are involved in are counted in the bound @xmath220 .",
    "that is , we have @xmath226 we now choose @xmath227 . for this choice to make sense",
    ", we want to have @xmath217 , which will be the case if @xmath228 . in this case",
    "we get the bound @xmath229 . if @xmath230 we take @xmath231 and obtain the bound @xmath201 . combining these bounds , and adding the at most @xmath3 conical incidences",
    ", the theorem follows .    50 @xmath173 = 0    [ [ the - final - stretch - the - real - case . ] ] the final stretch : the real case .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    it remains to bound the number @xmath232 of incidences involving the lines in @xmath186 .",
    "we remark that , in both the real and the complex cases , no special properties need to be assumed for the lines of @xmath186 ; the only thing that matters is that their number is small .",
    "we have @xmath233 . in the real case",
    ", we estimate @xmath232 using guth and katz s bound ( @xcite ; see theorem  [ ttt ] ) , recalling that no plane contains more than @xmath6 lines of @xmath186 .",
    "we thus obtain @xmath234 combining the bounds in theorem  [ salta ] and in ( [ lstar ] ) yields the asserted bound on @xmath23 .",
    "we remark that in the first term in ( [ lstar ] ) we have estimated @xmath235 by @xmath236 instead of the sharper estimate @xmath237 .",
    "this is because the term @xmath238 appears in theorem  [ salta ] anyway , so the sharper estimate has no effect on the overall asymptotic bound .",
    "[ [ the - final - stretch - the - complex - case . ] ] the final stretch : the complex case .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we next estimate @xmath232 in the complex case .",
    "again , we have @xmath239 .",
    "we may ignore the points of @xmath0 that are incident to fewer than three lines of @xmath186 , as they contribute altogether only @xmath201 incidences . continue to denote the set of surviving points as @xmath0 .",
    "a point @xmath86 that is incident to at least three lines of @xmath186 is either a singular point of @xmath45 ( when not all its incident lines are coplanar ) or a flat point of @xmath45 ( see the appendix , and also guth and katz  @xcite ) .",
    "we need the following lemma , adapted ( with almost the same proof , which we omit ) from a similar lemma that was established in our earlier work @xcite for the four - dimensional case ( see also section  [ sec : pfmain ] ) .",
    "[ le : lar ] let @xmath240 $ ] be an irreducible polynomial .",
    "if a line @xmath241 is flat , then the tangent plane @xmath242 is fixed for all the non - singular points @xmath27 .",
    "we decompose @xmath45 into its irreducible components , and assign each point @xmath25 ( resp .",
    ", line @xmath243 ) to the first component that ( fully ) contains it .",
    "similar to what has been observed above , the number of `` cross - incidences '' , between points and lines assigned to different components of @xmath45 , is @xmath244 .",
    "we therefore assume , as we may , that @xmath45 is irreducible ( over @xmath43 ) , and write @xmath245 , for an irreducible trivariate polynomial @xmath79 of degree @xmath59 .",
    "we call a line _ flat _ if all its non - singular points are flat .",
    "as argued in the appendix and in earlier works ( see , e.g. ,  @xcite ) , since @xmath82 is not a plane , there exists a certain polynomial @xmath246 satisfying ( i ) @xmath247 , ( ii ) @xmath248 is a curve , and ( iii ) the flat points of @xmath0 and the flat lines of @xmath186 are contained in @xmath248 .",
    "all this implies , arguing as in previous works  @xcite , that a line @xmath243 that is non - singular and non - flat contains at most @xmath249 points of @xmath0 ( each of which is either singular or flat ) .",
    "we prune away these lines from @xmath186 , losing at most @xmath250 incidences with the points of @xmath0 .",
    "continue to denote the subset of surviving lines as @xmath186 .",
    "therefore , it remains to bound the number of incidences between the surviving points and the surviving lines , each of which is either singular or flat .",
    "write @xmath0 as the union of the subset @xmath251 of flat points and the subset @xmath252 of singular points .",
    "similarly , write @xmath186 as the union of the subset @xmath253 of flat lines and the subset @xmath254 of singular lines .",
    "a singular line contains no flat points , and a flat line contains at most @xmath255 singular points .",
    "thus , @xmath256 by lemma  [ le : lar ] , all the non - singular points of a flat line have the same tangent plane .",
    "assign each point @xmath257 ( resp .",
    ", line in @xmath253 ) to its tangent plane @xmath242 ( resp .",
    ", @xmath242 for some non - singular point @xmath258 ; we only consider lines in @xmath253 that are incident to at least one point in @xmath251 ) .",
    "we have therefore partitioned the points in @xmath251 and the lines in @xmath253 among planes in some finite set @xmath259 , and we only need to count incidences between points and lines assigned to the same plane . within each @xmath260 ,",
    "we have a set @xmath261 of @xmath262 points in @xmath263 , and a set @xmath264 of @xmath265 lines contained in @xmath263 . using the planar bound ( [ inc2 ] ) , which also holds in the complex plane , the number of incidences within @xmath263 is @xmath266 .",
    "summing these bounds over @xmath260 , and using hlder s inequality , and the fact that @xmath267 for each @xmath263 , we obtain a total of @xmath268 incidences .    [ [ bounding - incidences - involving - singular - points - and - lines . ] ] bounding incidences involving singular points and lines .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    bounding the number of incidences between the singular points and lines is done via degree reduction .",
    "assuming , without loss of generality , that @xmath269 does not vanish identically on @xmath82 , the points of @xmath252 and the lines of @xmath254 are then ( fully ) contained in @xmath270 , and @xmath271 .",
    "we thus construct a sequence of partial derivatives of @xmath79 that are not identically zero on @xmath82 .",
    "for this we assume , as we may , that @xmath79 , and each of its derivatives , are square - free ; whenever this fails , we replace the corresponding derivative by its square - free counterpart before continuing to differentiate . without loss of generality , assume that this sequence is @xmath272 , and so on .",
    "denote the @xmath273-th element in this sequence as @xmath274 , for @xmath275 ( so @xmath276 , @xmath277 , and so on ) .",
    "assign each point @xmath25 to the first polynomial @xmath274 in the sequence for which @xmath86 is non - singular ; more precisely , we assign @xmath86 to the first @xmath274 for which @xmath278 but @xmath279 ( recall that @xmath280 is always @xmath281 by assumption .",
    "similarly , assign each line @xmath101 to the first polynomial @xmath274 in the sequence for which @xmath101 is fully contained in @xmath282 but not fully contained in @xmath283 ( again , by assumption , there always exists such a polynomial @xmath274 ) .",
    "if @xmath101 is assigned to @xmath274 then it can only contain points @xmath86 that were assigned to some @xmath284 with @xmath285 .",
    "indeed , if @xmath101 contained a point @xmath86 assigned to @xmath284 with @xmath286 then @xmath287 but @xmath101 is fully contained in @xmath288 , since @xmath289 ; this is a contradiction that establishes the claim .",
    "fix a line @xmath26 , which is assigned to some @xmath274 .",
    "an incidence between @xmath101 and a point @xmath25 , assigned to some @xmath284 , for @xmath290 , can be charged to the intersection of @xmath101 with @xmath283 at @xmath86 ( by construction , @xmath86 belongs to @xmath283 ) .",
    "the number of such intersections is at most @xmath291 , so the overall number of incidences of this sort , over all lines @xmath26 , is @xmath292 .",
    "it therefore suffices to consider only incidences between points and lines that are assigned to the same zero set @xmath293 .",
    "the reductions so far have produced a finite collection of up to @xmath59 polynomials , each of degree at most @xmath59 , so that the points of @xmath0 are _ partitioned _ among the polynomials and so are the lines of @xmath2 , and we only need to bound the number of incidences between points and lines assigned to the _ same _ polynomial",
    ". moreover , for each @xmath273 , all the points assigned to @xmath274 are non - singular , by construction . for each @xmath273 , let @xmath294 and @xmath295 denote the subsets of @xmath0 and of @xmath186 , respectively , that are assigned to @xmath274 , and put @xmath296 and @xmath297 .",
    "we have @xmath298 and @xmath299 .",
    "we would like to apply the preceding analysis to @xmath294 and @xmath295 , but we face the technical issue that @xmath274 might be reducible and have some linear factors .",
    "( the theorem does not require the variety to be irreducible , but forbids it to have linear components . )",
    "we therefore proceed as follows .",
    "we first consider only those points and lines that are ( fully ) contained in some nonlinear component of @xmath282 .",
    "we apply the preceding analysis to these sets , and obtain the incidence bound @xmath300 summing these bounds over all @xmath274 s , using hlder s inequality , we get the overall bound @xmath301 to bound the number of incidences involving points and lines in the linear components of @xmath282 , for any fixed @xmath273 , we reason as we did above , when handling the flat points and lines .",
    "that is , we order arbitrarily the planar components of @xmath282 , assign each point to first component that contains it , and assign each line to the first component that fully contains it .",
    "as @xmath282 has at most @xmath59 such components , the number of `` cross incidences , '' between points and lines assigned to different components , is @xmath302 . for the number of `` same component '' incidences",
    ", we use the tth - zahl extension of the szemerdi - trotter bound  @xcite in each plane , and sum them up , exactly as in the case of flat points and lines , and get a total bound of @xmath303 and , summing these bounds over all @xmath274 s , as above , we get the overall bound @xmath304 thereby completing the proof of part ( b ) ( for the case where the ambient space is three - dimensional ) .    [",
    "[ reduction - to - three - dimensions . ] ] reduction to three dimensions .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to complete the analysis , we need to consider the case where @xmath45 is a two - dimensional variety embedded in @xmath8 , for @xmath305 .",
    "let @xmath119 be a generic 3-flat , and denote by @xmath306 , and @xmath307 the respective projections of @xmath308 , and @xmath45 onto @xmath119 .",
    "since @xmath119 is generic , we may assume that all the projected points in @xmath309 are distinct , and so are all the projected lines in @xmath310 .",
    "clearly , every incidence between a point of @xmath0 and a line of @xmath2 corresponds to an incidence between the projected point and line .",
    "since no 2-flat contains more than @xmath6 lines of @xmath2 , and @xmath119 is generic , repeated applications of lemma  [ ap : th ] imply that no plane in @xmath119 contains more than @xmath6 lines of @xmath310 .",
    "one subtle point is that the set - theoretic projection @xmath307 of @xmath45 does not have to be a real algebraic variety ( in general , it is only a semi - algebraic set ) , but it is always contained in a two - dimensional real algebraic variety @xmath311 , which we call , as we did in an earlier work  @xcite , the _ algebraic projection _ of @xmath45 ; it is the zero set of all polynomials belonging to the ideal of polynomials vanishing on @xmath45 , after eliminating variables in the complementary space of @xmath119 ( this is also known as an _ elimination ideal _ of @xmath45 ; see cox et al .",
    "@xcite for details ) , and is equal to the zariski closure of @xmath307 . since the closure of a projection does not increase the original degree ( see , e.g. , harris  @xcite ) ,",
    "that @xmath311 does not contain a 2-flat follows by a suitable adaptation of the argument in  ( * ? ? ?",
    "* lemma 2.1 ) ( which is stated there for @xmath41 over the reals ) , that applies for general @xmath29 and over the complex field too .    in conclusion",
    ", we have @xmath313 , where @xmath309 is a set of @xmath1 points and @xmath310 is a set of @xmath3 lines , all contained in the two - dimensional algebraic variety @xmath311 , embedded in 3-space , which is of degree at most @xmath59 and does not contain any plane , and no plane contains more than @xmath6 lines of @xmath310 .",
    "the preceding analysis thus implies that the bound asserted in the theorem applies in any dimension @xmath9 .",
    "50 @xmath173 = 0",
    "in most of this section we assume that the ambient space is four - dimensional , and work , with a few exceptions , over the complex field .",
    "the reduction from higher dimensions to four dimensions is handled as the reduction to three dimensions just discussed .",
    "we exploit the following useful corollary of theorem  [ th : main3d ] ( recall that we are now in four dimensions ) .",
    "note that in the bound given below , the term @xmath58 does not appear yet .",
    "[ th : degsquared ] let @xmath79 and @xmath314 be two @xmath205-variate polynomials , over @xmath98 or @xmath43 , of degree @xmath97 , such that @xmath315 is two - dimensional over @xmath43 .",
    "let @xmath0 be a set of @xmath1 points and @xmath2 a set of @xmath3 lines , such that all the points of @xmath0 and all the lines of @xmath2 are ( fully ) contained in the union of the irreducible components of @xmath315 that are not 2-flats .",
    "assume also that no 2-flat contains more than @xmath6 lines of @xmath2 .",
    "then we have + * ( a ) in the real case : * @xmath316 * ( b ) and in the complex case : * @xmath317    * proof .",
    "* let @xmath318 be the decomposition of @xmath315 into its irreducible components . by the generalized version of bzout s theorem  @xcite , we have @xmath319 .",
    "assume that @xmath320 are the components that are not 2-flats , for some @xmath321 , and let @xmath322 denote their union . as just observed , @xmath323 .",
    "applying to @xmath322 theorem  [ th : main3d](a ) ( over the reals ) or theorem  [ th : main3d](b ) ( over the complex ) thus completes the proof .",
    "50 @xmath173 = 0    * remark . * corollary  [ th : degsquared](a ) is significant when @xmath324 . for larger values of @xmath59 , we can project @xmath0 , @xmath2 , and @xmath315 onto some generic 3-flat , and apply the incidence bound of guth and katz , as given in theorem  [ ttt ] , within that 3-flat . when @xmath325 , the resulting bound is better than the one in ( [ cor:3d ] ) .",
    "the proof of theorem  [ th : main4d ] revisits the proof of theorem  [ th : mainfocs ] , as presented in  @xcite , and applies corollary  [ th : degsquared ] as a major technical tool .",
    "the only difference between the real and the complex cases is in the application of that corollary . except for this application",
    ", we will work over the complex domain , but the analysis carries over , in a straightforward manner , to the real case too .",
    "each line @xmath326 that is not fully contained in @xmath45 contributes at most @xmath59 incidences , for a total of @xmath14 incidences .",
    "we thus assume , as we may , that all the lines of @xmath2 are contained in @xmath45 .",
    "let @xmath327 be the decomposition of @xmath45 into its irreducible components , and assign each point @xmath25 , ( resp .",
    ", line @xmath326 ) to the first @xmath178 that contains it ( resp .",
    ", fully contains it ; such a @xmath178 always exists ) .",
    "it is easy to verify that points and lines that are assigned to different @xmath178 s contribute at most @xmath58 incidences .",
    "indeed , any such incidence @xmath24 can be charged to an intersection point of @xmath101 with the component @xmath178 that @xmath86 is assigned to , and thus there are at most @xmath328 such incidences for each @xmath101 , for an overall number of @xmath14 such incidences .",
    "therefore , it suffices to establish the bound in ( [ ma : in ] ) or in ( [ ma : incplx ] ) for the number of incidences between points and lines assigned to the same component .",
    "the exponents in the first two terms in either of these bounds are favorable , in the sense that they sum up to @xmath329 ( ignoring the factors @xmath59 and @xmath330 ) , thereby allowing us to estimate the sum of the resulting bounds , over the components of @xmath45 , via hlder s inequality , to obtain the bounds in theorem  [ th : main4d ] ( see below for details ) .",
    "we thus assume that @xmath45 is irreducible , and write @xmath245 , for some real or complex irreducible polynomial @xmath79 of degree @xmath59 .",
    "we assume for now that @xmath0 consists exclusively of _ non - singular _ points of the _ irreducible _ variety @xmath82 .",
    "the treatment of the singular points , similar to the handling of singular points in the proof of theorem  [ th : main3d](b ) , will be given towards the end of the proof .",
    "we recall the defintion of the _ four - dimensional flecnode polynomial _",
    "@xmath95 of @xmath79 , as given in section  [ se : pre ] .",
    "that is , @xmath95 vanishes at each _ flecnode _ @xmath331 , namely , points @xmath86 for which there exists a line that is incident to @xmath86 and osculates to @xmath82 up to the fourth order .",
    "it is obtained by eliminating ( in a standard manner , using resultants ) the direction @xmath87 of the osculating line from the four homogeneous equations given by the vanishing of the first four terms of the taylor expansion of @xmath96 near @xmath86 ( @xmath87 is a point in projective @xmath77-space , and its elimination from these four equations yields a single polynomial equation in @xmath86 ) . clearly , @xmath95 vanishes identically on every line of @xmath2 , and thus also on @xmath0 ( assuming that each point of @xmath0 is incident to at least one line of @xmath2 ) . as in the three - dimensional case",
    ", its degree can be shown to be @xmath97 .",
    "if @xmath95 does not vanish identically on @xmath82 , then @xmath332 is a two - dimensional variety that contains @xmath0 and all the lines of @xmath2 , and is of degree @xmath333 ( so we are in the setup assumed in corollary  [ th : degsquared ] ) .",
    "the other possibility is that @xmath95 vanishes identically on @xmath82 , and then a theorem of landsberg  @xcite ( see also  @xcite for details ) implies that @xmath82 is ruled by ( real or complex ) lines .",
    "( landsberg s theorem is a generalization of theorem  [ th : flec2a ] , the classical cayley  salmon ",
    "monge theorem  @xcite in three dimensions . )",
    "* first case : @xmath334 is two - dimensional . * put @xmath335 and apply corollary  [ th : degsquared ] to @xmath79 and @xmath314 . in the real case",
    "we obtain the bound @xmath336 and in the complex case we obtain the bound @xmath337 over all components of @xmath334 that are not 2-flats .",
    "* incidences within 2-flats fully contained in @xmath334 . * from this point on in the proof , there is no distinction between the real and complex cases , so we work over the complex domain .",
    "the strategy here is to distribute the points of @xmath0 and the lines of @xmath2 among the 2-flats that contain them ( lines not contained in any 2-flat are fully contained in some other component of @xmath334 and are dealt with , as above , within that component ) .",
    "see also below for a more detailed account of this strategy .",
    "points that belong to at most two such 2-flats get duplicated at most twice , and we bound the number of incidences with these points by applying the planar bound ( [ inc2 ] ) ( which , as we recall , also holds in the complex plane  @xcite ) to each 2-flat separately , and sum up the bounds , to get @xmath338 , using hlder s inequality , combined with the assumption that no 2-flat contains more than @xmath6 lines of @xmath2 .    extending to four dimensions ( and in the complex domain ) the notation for the three - dimensional case from guth and katz  @xcite ( see the appendix , @xcite , and also pressley  @xcite and ivey and landsberg  @xcite for more basic references ) , we call a non - singular point @xmath86 of @xmath82 _ linearly flat _",
    ", if it is incident to at least three distinct 2-flats that are fully contained in @xmath82 ( and thus also in the tangent hyperplane @xmath242 ) .",
    "linearly flat points can then be shown to be _ flat _ , meaning that the second fundamental form of @xmath79 vanishes at them ( see the appendix and  @xcite ) .",
    "this property , at a point @xmath86 , can be expressed by several polynomials of degree @xmath339 vanishing at @xmath86 ( see  ( * ? ? ?",
    "* section 2.5 ) ) .",
    "we call a line _ flat _ if all its non - singular points are flat",
    ". each line of @xmath2 that is not flat contains at most @xmath97 flat points , and thus the non - flat lines contribute a total of at most @xmath14 incidences with flat points , so we assume in what follows that the points of @xmath0 and the lines of @xmath2 are all flat .",
    "since @xmath82 is not a hyperplane , the second fundamental form does not vanish identically on @xmath82 ( this property holds in any dimension ; see , e.g.  ( * ? ? ?",
    "* exercise 3.2.12.2 ) ) , and it then follows from the characterization of flat points that there exists a certain polynomial @xmath246 satisfying ( i ) @xmath247 , ( ii ) @xmath248 is two - dimensional , and ( iii ) the ( flat ) points of @xmath0 and the ( flat ) lines of @xmath2 are contained in @xmath248 .",
    "in this case we partition the points of @xmath0 among their tangent hyperplanes , and denote the resulting set of hyperplanes by @xmath119 .",
    "similar to lemma  [ le : lar ] , we have the property that all the ( flat ) points that lie on the same flat line have the _ same _ tangent hyperplane to @xmath82 ( see  ( * ? ? ? * lemma 2.15 ) ) .",
    "we use this property to obtain a partition of the points and lines into distinct ( tangent ) hyperplanes , so that it suffices to bound the number of incidences within each hyperplane in @xmath119 .    for each @xmath340",
    ", we have a set @xmath341 of @xmath262 points in @xmath263 , a set @xmath342 of @xmath265 lines contained in @xmath263 , and a set @xmath343 of 2-flats contained in @xmath344 ; the 2-flats of @xmath343 are the 2-flat components of @xmath344 ( ignoring singularities , which are treated later , these 2-flats are necessarily contained in the corresponding tangent hyperplanes ) .",
    "notice that each 2-flat in @xmath343 is also contained in the two - dimensional surface @xmath345 , which is of degree @xmath59 , so , by the generalized version of bzout s theorem  @xcite , we have @xmath346 .",
    "we assign each point @xmath347 ( resp .",
    ", line @xmath348 ) to the first 2-flat in @xmath343 that ( fully ) contains it .",
    "similar to what has been observed above , the number of `` cross - incidences '' , between points and lines assigned to different @xmath52-flats , within @xmath263 is at most @xmath349 , for a total , over the hyperplanes @xmath260 , of at most @xmath58 incidences .",
    "again , using the planar bound ( [ inc2 ] ) and hlder s inequality , the numbers of incidences within the 2-flats of @xmath263 sum up to @xmath350 , and , summing over the hyperplanes @xmath260 , using hlder s inequality once again , and the fact that @xmath267 , we obtain a total of @xmath351 incidences",
    ".    * remark . *",
    "the novel feature of this step of the proof , as compared with the analogous argument used in @xcite , is that the number of 2-flats in @xmath343 , for any fixed @xmath263 , is at most @xmath59 .",
    "this allows us to bound the number of incidences within each hyperplane @xmath260 separately , so that , within each such hyperplane , instead of using the guth - katz bound ( in the real case ) , we partition the points and lines among at most @xmath59 planes , and then use the szemerdi - trotter bound in the real case , or the tth - zahl bound in the complex case . the fact that there are at most @xmath59 planes within each hyperplane @xmath260 guarantees that the number of `` cross - incidences '' ( within @xmath263 ) is at most @xmath349 , for a total of @xmath58 incidences (",
    "notice that , in contrast , the _ total _ number of planes ( over all @xmath260 ) can be arbitrarily large ) .    * second case : @xmath82 is ruled by ( complex ) lines . * we next consider the case where the four - dimensional flecnode polynomial @xmath95 vanishes identically on @xmath82 . by landsberg s theorem  @xcite mentioned above",
    ", this implies that @xmath82 is ruled by ( complex ) lines .    as in the three - dimensional case treated in the appendix ( see , e.g. , the proof of theorem  [ singly ] ) , we denote by @xmath352 ( resp . , @xmath353 ) , for @xmath331 , the set of all lines that are incident to @xmath86 and osculate to @xmath82 to order @xmath77 at @xmath86 ( resp",
    ", are contained in @xmath82 ) .",
    "we put @xmath354 , and @xmath355 .",
    "( @xmath356 is the _",
    "fano variety _ of ( lines contained in ) @xmath82 , now represented in a higher - dimensional projective space . )    in  @xcite , we proved that , for each @xmath25 , either @xmath357 or @xmath353 is infinite . in the interest of completeness , we recall here the outline of this argument .",
    "the analysis provides an algebraic characterization of points @xmath86 of the latter kind , which uses an auxiliary polynomial @xmath358 , called the _",
    "@xmath359-resultant _ , defined in terms of @xmath79 and its derivatives at @xmath86 ( see  @xcite and also  @xcite for details ) , where @xmath360 denotes the direction of a line incident to @xmath86 ( in homogeneous coordinates ) .",
    "the polynomial @xmath361 is of degree @xmath97 in @xmath86 and is a homogeneous polynomial of degree six in @xmath359 .",
    "the characterization is that @xmath352 is infinite if and only if @xmath362 , as a polynomial of @xmath359 , at @xmath86 . in the complementary case",
    ", bzout s theorem  @xcite can be used to show that there are only six lines in @xmath352 , and thus at most six lines in @xmath353 .",
    "pruning away points @xmath363 with @xmath364 ( the number of incidences involving these points is at most @xmath365 ) , we may then assume that @xmath352 is infinite for every @xmath25 .",
    "if @xmath366 does not vanish identically ( as a polynomial in @xmath367 ) at every point @xmath368 , then at least one of its coefficients , call it @xmath369 , which is a polynomial in @xmath86 , of degree @xmath97 , does not vanish identically on @xmath82 . in this case , as @xmath361 vanishes identically at every point of @xmath0 ( as a polynomial in @xmath367 ) , we have @xmath370 , which is a two - dimensional variety",
    ". the machinery developed in the first case can then be applied here ( with @xmath371 ) , and the bounds and properties derived for that case hold here too .",
    "we may therefore assume that @xmath372 at every non - singular point @xmath368 ( as a polynomial in @xmath367 ) .",
    "by the aforementioned characterization via @xmath359-resultants , it follows that @xmath352 is then infinite at each such point .",
    "we now use another theorem of landsberg  ( * ? ? ?",
    "* theorem 3.8.7 ) : let @xmath79 be a polynomial over @xmath373 , such that there exists an irreducible component @xmath374 with the property that , for every point @xmath86 in a zariski - open set @xmath375 , @xmath376 , where @xmath377 is the set of lines in @xmath378 incident to @xmath86 .",
    "landsberg s theorem then asserts that , for every point @xmath379 , all lines in @xmath377 are fully contained in @xmath82 ; that is , for each @xmath380 , @xmath377 is equal to the set @xmath381 of lines incident to @xmath86 and fully contained in @xmath82 .",
    "since @xmath352 is infinite at each non - singular point @xmath331 , its dimension is @xmath382 at each such point .",
    "as shown in  @xcite , the main condition in landsberg s theorem , about the existence of a component @xmath378 of @xmath383 with the required properties , is satisfied too .",
    "one can then argue that the conclusion of landsberg s theorem holds at _ every _ point of @xmath82 ; see lemma  [ le : rs ] in the appendix for a similar claim concerning two - dimensional surfaces .",
    "that is , @xmath82 is _ infinitely ruled _ by ( complex ) lines , in the sense that each point @xmath368 is incident to infinitely many ( complex ) lines that are fully contained in @xmath82 , and , moreover , @xmath384 at each @xmath86 .",
    "that is , @xmath378 is contained in @xmath356 . denoting this",
    "set as @xmath104 , it is shown ( in full detail ) in  @xcite that the union of the lines in @xmath104 is equal to @xmath82 , and that @xmath385",
    ".    * severi s theorem . *",
    "the following theorem was already used in  @xcite , and we make a similar use thereof here too .",
    "it has been obtained by severi @xcite in 1901 .",
    "a variant of this result has also been obtained by segre  @xcite ; see also the more recent works @xcite .",
    "we state here a special case of the theorem that we need .",
    "[ th : sev ] let @xmath386 be a three - dimensional irreducible variety , and let @xmath104 be a component of maximal dimension of the fano variety @xmath387 of @xmath388 , such that the lines of @xmath104 cover @xmath388",
    ". then the following holds .",
    "( i ) if @xmath389 , then @xmath388 is a hyperplane .",
    "( ii ) if @xmath390 , then either @xmath388 is a quadric , or @xmath388 is ruled by 2-flats .",
    "informally , @xmath390 corresponds to the case where @xmath388 is infinitely ruled by lines of @xmath104 : there are four degrees of freedom to specify a line in @xmath104 , three to specify @xmath391 , and one to specify the line in @xmath381 .",
    "( we can assume that @xmath381 is one - dimensional , because if it were two - dimensional , then @xmath388 would have been a hyperplane .",
    ") however , one degree of freedom has to be removed , to account for the fact that the same line ( being contained in @xmath388 ) arises at each of its points .",
    "severi s theorem asserts , again informally , that in this case the infinite family of lines of @xmath381 must form a 2-flat , unless @xmath388 is a quadric or a hyperplane .",
    "moreover , by  ( * ? ? ?",
    "* theorem 3.9 ) ( whose proof is based on theorem  [ th : harr ] , given in the appendix ) , @xmath104 has maximal dimension .    applying the second case in severi s theorem to @xmath82 , which is justified by the preceding arguments ,",
    "we conclude that either @xmath82 is a quadric or it is ruled by 2-flats .",
    "the cases where @xmath82 is a quadric or a hyperplane are ruled out by our assumption , so we only need to consider the case where @xmath82 is ruled by ( complex ) @xmath52-flats .",
    "[ [ 2flat ] ] the case where @xmath82 is ruled by @xmath52-flats .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    handling this last step is somewhat intricate ; it resembles the analysis of flat points and lines in the first case , where here points and lines are partitioned among the ruling 2-flats . in this case , every point @xmath368 is incident to at least one 2-flat @xmath392 .",
    "let @xmath393 denote the set of 2-flats that are incident to @xmath86 and are contained in @xmath82 .    for a non - singular point @xmath331 ,",
    "if @xmath394 , then @xmath86 is a ( linearly flat and thus ) flat point of @xmath82 .",
    "recall that we have bounded the number of incidences involving flat points ( and lines ) by partitioning them among a finite number of containing hyperplanes , and by bounding the incidences within each hyperplane .",
    "lines incident to fewer than @xmath339 points of @xmath0 have been pruned away , losing only @xmath14 incidences , and the remaining lines are all flat . repeating this argument here , noticing that here too , the number of 2-flats contained in a hyperplane is at most @xmath59 , we obtain the bound @xmath395 in what follows we therefore assume that all points of @xmath0 are non - singular and non - flat ( call these points , as in @xcite , _ ordinary _ for short ) , and therefore @xmath396 or @xmath52 , for each such @xmath86 .",
    "put @xmath397 ( resp .",
    ", @xmath398 ) for the 2-flat ( resp . , two 2-flats ) in @xmath393 , when @xmath396 ( resp . ,",
    "@xmath399 ) .    clearly ,",
    "each line in @xmath2 , containing at least one ordinary point @xmath400 , is fully contained in at most two 2-flats fully contained in @xmath82 ( namely , the 2-flats of @xmath393 ) .",
    "assign each ordinary point @xmath25 to _ each _ of the at most two 2-flats in @xmath393 , and assign each line @xmath326 that is incident to at least one ordinary point to the at most two 2-flats that fully contain @xmath101 and are fully contained in @xmath82 ( it is possible that @xmath101 is not assigned to any @xmath52-flat  see below ) . changing the notation ,",
    "enumerate these 2-flats , over all ordinary points @xmath25 , as @xmath401 , and , for each @xmath141 , let @xmath402 and @xmath403 denote the respective subsets of points and lines assigned to @xmath404 , and let @xmath405 and @xmath406 denote their cardinalities .",
    "we then have @xmath407 and @xmath408 , and the total number of incidences within the 2-flats @xmath404 ( excluding lines not assigned to any 2-flat ) is at most @xmath409 .",
    "this incidence count can be obtained exactly as in the first case of the analysis , with the aid of hlder s inequality , and yields the bound @xmath410 as noted , this bound does not take into account incidences involving lines which are not contained in any of the 2-flats @xmath404 ( and are therefore not assigned to any such 2-flat ) .",
    "it suffices to consider only lines of this sort that are non - singular and non - flat , since singular or flat lines are only incident to singular or flat points , and we assumed above that all the points of @xmath0 are ordinary points . if @xmath101 is a non - singular and non - flat line , and is not fully contained in any of the @xmath404 , we call it a _ piercing line _ of @xmath82 .",
    "we need the following lemma from  @xcite .    [ ] [ le : pierc2 ] let @xmath331 be an ordinary point",
    ". then @xmath86 is incident to at most one piercing line .",
    "therefore , each ordinary point @xmath25 is incident to at most one piercing line , and the total contribution of incidences involving ordinary points and piercing lines is at most @xmath1 .    in conclusion , combining the bounds that we have obtained for the various subcases of the second case , we get the desired bound in ( [ ma : in ] ) .",
    "[ [ sing ] ] incidences involving singular points of @xmath82 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the forthcoming reasoning is very similar to the handling of singular points and lines in the proof of theorem  [ th : main3d](b ) , although it is somewhat more involved because we need to ensure that the resulting polynomials that we construct be irreducible ; we present the analysis in detail , for the sake of clarity .    in the analysis presented so far",
    ", we have assumed that the points of @xmath0 are non - singular points of @xmath82 . to reduce the general setup to this situation we proceed as follows ;",
    "an identical reduction has also been used in  @xcite .",
    "we only handle lines that are fully contained in @xmath82 , because the other lines contribute at most @xmath14 incidences .",
    "we construct a sequence of partial derivatives of @xmath79 that are not identically zero on @xmath82 . for this we assume , as we may , that @xmath79 , and each of its derivatives , are square - free ; whenever this fails , we replace the corresponding derivative by its square - free counterpart before continuing to differentiate . without loss of generality , assume that this sequence is obtained by always differentiating with respect to @xmath411 , and denote the @xmath273-th element in this sequence as @xmath274 , for @xmath275 .",
    "that is , @xmath276 , @xmath277 , with repeated factors removed , @xmath412 is the @xmath411-derivative of @xmath413 , again with repeated factors removed , and so on .",
    "assign each point @xmath25 to the first polynomial @xmath274 in the sequence for which @xmath86 is non - singular ; more precisely , we assign @xmath86 to the first @xmath274 for which @xmath278 but @xmath279 ( recall that @xmath280 is always @xmath281 by assumption ) .",
    "similarly , assign each line @xmath101 to the first polynomial @xmath274 in the sequence for which @xmath101 is fully contained in @xmath282 but not fully contained in @xmath283 ( again , by assumption , there always exists such a @xmath273 ) .",
    "if @xmath101 is assigned to @xmath274 then it can only contain points @xmath86 that were assigned to some @xmath284 with @xmath285 .",
    "indeed , if @xmath101 contained a point @xmath86 assigned to @xmath284 with @xmath286 then @xmath287 but @xmath101 is fully contained in @xmath288 , since @xmath289 ; this is a contradiction that establishes the claim .",
    "fix a line @xmath26 , which is assigned to some @xmath274 .",
    "an incidence between @xmath101 and a point @xmath25 , assigned to some @xmath284 , for @xmath290 , can be charged to the intersection of @xmath101 with @xmath283 at @xmath86 ( by construction , @xmath86 belongs to @xmath283 ) .",
    "the number of such intersections is at most @xmath291 , so the overall number of incidences of this sort , over all lines @xmath26 , is @xmath14 .",
    "it therefore suffices to consider only incidences between points and lines that are assigned to the same zero set @xmath293 .",
    "the reductions so far have produced a finite collection of up to @xmath97 polynomials , each of degree at most @xmath59 , so that the points of @xmath0 are _ partitioned _ among the polynomials and so are the lines of @xmath2 , and each point @xmath86 is non - singular with respect to the polynomial it is assigned to , and we only need to bound the number of incidences between points and lines assigned to the _ same _ polynomial .",
    "this is not the end yet , because the various ( reduced forms of the ) partial derivatives might be reducible , which we want to avoid .",
    "thus , in a final decomposition step , we split each derivative polynomial @xmath274 into its irreducible factors , and reassign the points and lines that were assigned to @xmath282 to the various factors , by the same `` first come first served '' rule used above .",
    "the overall number of incidences that are lost in this process is again @xmath14 .",
    "the overall number of polynomials is @xmath189 , as can easily be checked .",
    "note also that the last decomposition step preserves non - singularity of the points in the special sense defined above ; that is , as is easily verified , a point @xmath414 with @xmath279 , continues to be a non - singular point of the irreducible component it is reassigned to .",
    "we now fix one such final polynomial , call it @xmath274 , denote its degree by @xmath415 ( which is upper bounded by the original degree @xmath59 ) , and denote by @xmath294 and @xmath295 the subsets of the original sets of points and lines that are assigned to @xmath274 , and by @xmath416 and @xmath417 their respective cardinalities .",
    "we now may assume that @xmath294 consists exclusively of _ non - singular _ points of the _ irreducible _ variety @xmath282 .",
    "the preceding analysis yields the bound  ( [ ma : in ] ) for each @xmath273 @xmath418 summing these bounds , upper bounding @xmath415 by @xmath59 , and using hlder s inequality for the first two terms , we get the bound  ( [ ma : in ] ) for the entire sets @xmath0 and @xmath2 .",
    "this completes the proof for the case where the variety containing @xmath0 and the lines of @xmath2 are embedded in @xmath4 .    [ [ reduction - to - the - four - dimensional - case . ] ] reduction to the four - dimensional case . + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to complete the analysis , we need to consider the case where @xmath45 is a three - dimensional variety embedded in @xmath8 , for @xmath419 .",
    "the analysis follows closely the one at the end of the proof of theorem  [ th : main3d ] , in section  [ ssec : pfa ] .",
    "concretely , let @xmath119 be a generic 4-flat , and denote by @xmath306 , and @xmath307 the respective projections of @xmath308 , and @xmath45 onto @xmath119 .",
    "since @xmath119 is generic , we may assume that all the projected points in @xmath309 are distinct , and so are all the projected lines in @xmath310 .",
    "clearly , every incidence between a point of @xmath0 and a line of @xmath2 corresponds to an incidence between the projected point and line .",
    "since no 2-flat contains more than @xmath6 lines of @xmath2 , and @xmath119 is generic , repeated applications of lemma  [ ap : th ] imply that no 2-flat in @xmath119 contains more than @xmath6 lines of @xmath310 .    as in section  [ ssec : pfa ] , the set - theoretic projection @xmath307 of @xmath45 does not have to be a real algebraic variety , so we use instead the algebraic projection @xmath311 of @xmath45 that contains @xmath307 .",
    "that @xmath311 does not contain a hyperplane or quadric follows by a suitable adaptation of the preceding argument ( see  ( * ? ? ?",
    "* lemma 2.1 ) ) .",
    "the case of a hyperplane is straightforward ( reasoning as in the preceding section ) . for quadrics",
    "we have :    * claim .",
    "* let @xmath388 be a three - dimensional real algebraic variety in @xmath8 , for @xmath420 , such that a generic ( real ) algebraic projection of @xmath45 on @xmath4 is a quadric .",
    "then @xmath388 is a quadric in @xmath8 .",
    "* proof . *",
    "assume to the contrary that @xmath388 is not a quadric in @xmath8 .",
    "this implies that , for a generic @xmath421-flat @xmath263 , the curve @xmath422 is not a quadratic curve .",
    "for any 2-flat @xmath423 , let @xmath424 denote the projection of @xmath425 onto @xmath314 .",
    "this implies that for a generic choice of @xmath314 and a @xmath421-flat @xmath263 satisfying @xmath426 , the curve @xmath424 is not a quadratic planar curve ( that is , a conic section ) in @xmath314 .",
    "next , by taking a suitable rotation of the coordinate frame , we may assume that @xmath314 is the @xmath427-flat , and @xmath263 is the @xmath428-flat .",
    "in these coordinates , it is easy to verify that @xmath424 can be obtained by first projecting @xmath388 onto the @xmath429-flat , and then cutting it with the @xmath427-plane .",
    "but the projection of @xmath388 onto the @xmath429-flat ( which is actually a generic 4-flat ) is a 3-quadric by assumption , and then cutting it with any 2-flat yields a quadratic planar curve , a contradiction that completes the proof .    50 @xmath173 = 0    in conclusion , we have @xmath313 , where @xmath309 is a set of @xmath1 points and @xmath310 is a set of @xmath3 lines , all contained in the three - dimensional algebraic variety @xmath311 , embedded in 4-space , which is of degree at most @xmath59 and does not contain any hyperplane or quadric component , and no 2-flat contains more than @xmath6 lines of @xmath310 .",
    "the preceding analysis thus implies that the bound asserted in the theorem applies in any dimension @xmath42 .",
    "50 @xmath173 = 0",
    "* ( 1 ) * as already emphasized , most of the analysis in the proof of theorem  [ th : main3d](a ) is carried out over the complex domain .",
    "the only place where the proofs of ( a ) and ( b ) bifurcate is in the final step . over the reals we bound @xmath232 using the bound of guth and katz ( which only holds over the reals , because of the polynomial partitioning that it employs ) , as a `` black box '' . over the complex field",
    ", we use a variant of the analysis to bypass this step , and obtain more or less the same bound , except for the additional term @xmath430 , which becomes insignificant for @xmath431 , say .    for three - dimensional varieties , the proof of both parts of theorem  [ th : main4d ]",
    "are more or less the same , with the main difference being the application of the real or complex version of corollary  [ th : degsquared ] .",
    "another difference is in the application of the planar point - line incidence bound ",
    "the bound is the same in both cases , but the sources ( szemerdi - trotter or tth - zahl ) are different .",
    "the derivation of fairly sharp point - line incidence bounds over the complex domain in higher dimensions constitutes , in our opinion , significant progress in this theory .    *",
    "( 2 ) * in view of the lower bound constructions in @xcite , the new bounds in theorems  [ th : main3d ] and [ th : main4d ] do not hold without the assumption that the points lie on a variety of relatively small degree .",
    "we also note that , for a three - dimensional variety , we also get rid of the term @xmath432 ; this term may arise only when we consider points on hyperplanes or quadrics , but in our case the variety does not contain any such components .",
    "therefore , our theorems indicate that these terms may _ only _ arise if the variety contains such components .    * ( 3 ) * as mentioned in the introduction , corollary  [ cor : main ] can be extended to the case where @xmath45 , which is of constant degree @xmath5 , also contains planes . here too , we assume that no plane contains more than @xmath6 lines of @xmath2 , but this time it is not necessarily the case that @xmath433 .",
    "let @xmath434 denote the planar components of @xmath45 , where @xmath435 . for each @xmath141 , the number of incidences within @xmath436 , namely ,",
    "between the set @xmath402 of points contained in @xmath436 and the set @xmath403 of lines fully contained in @xmath436 , in both real and complex cases , is @xmath437 summing these bounds over the @xmath438 planes , we get the same asymptotic bound for the overall number of the incidences within these planes . any other incidence between a point @xmath86 lying in one of these planes @xmath436 and a line @xmath101 not contained in @xmath436 can be uniquely identified with the intersection of @xmath101 with @xmath436 .",
    "the overall number of such intersections is at most @xmath439 .",
    "this leads to the following extension of corollary  [ cor : main ] .",
    "[ cor : mainx ] let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath8 or in @xmath17 , for any @xmath9 , and let @xmath31 be a parameter , such that all the points and lines lie in a common two - dimensional algebraic surface of constant degree , and no 2-flat contains more than @xmath6 lines of @xmath2 .",
    "then @xmath440 where the constant of proportionality depends on the degree of the surface .    * ( 4 ) * as already noted , one of the significant achievements of the analysis in theorem  [ th : main3d ] is that the bound there does not include the term @xmath51 .",
    "such a term arises naturally , when one considers incidences between points lying in some irreducible component of @xmath45 and lines not contained in that component .",
    "these incidences can be bounded by @xmath441 , by charging them , as above , to line - component intersections .",
    "when @xmath59 is large , eliminating the term @xmath58 can be crucial for the analysis , as demonstrated in our earlier work  @xcite .    *",
    "( 5 ) * another interesting challenge is to establish a similar bound for @xmath23 , for the case where the points of @xmath0 lie on a two - dimensional variety @xmath45 , but the lines need not be contained in @xmath45 .",
    "a trivial extension of the proof adds the term @xmath14 to the bound .",
    "the challenge is to avoid this term ( if possible ) ; see also remark ( 4 ) above .",
    "* ( 6 ) * similar to item ( 2 ) , theorem  [ th : main4d](a ) can be extended to the case where @xmath45 also contains hyperplane and quadric components , albeit only for the real case . here , as in theorem  [ th : mainfocs ]",
    ", we add the condition that no hyperplane or quadric contains more than @xmath34 lines of @xmath2 .",
    "let @xmath442 denote the hyperplane and quadric components of @xmath45 , where @xmath443 .",
    "assign , whenever applicable , each point ( resp . ,",
    "line ) to the first @xmath444 that ( fully ) contains it . as observed above , the number of `` cross - incidences '' is @xmath14 . by  (",
    "* proposition 3.6 ) , the total number of incidences within the hyperplanes and quadrics @xmath444 , for @xmath445 , is @xmath446 this leads to the following extension of theorem  [ th : main4d](a ) .",
    "[ cor : main4dx ] let @xmath0 be a set of @xmath1 distinct points and @xmath2 a set of @xmath3 distinct lines in @xmath8 , for any @xmath42 , and let @xmath447 be parameters , such that all the points and lines lie in a common three - dimensional algebraic surface of degree @xmath59 , and assume that ( i ) no 3-flat or 3-quadric contains more than @xmath34 lines of @xmath2 , and ( ii ) no 2-flat contains more than @xmath6 lines of @xmath2 .",
    "then @xmath448    * ( 7 ) * an interesting offshoot of lemma  [ claim:4d ] is the following result .",
    "[ 2rich ] let @xmath45 be a possibly reducible two - dimensional algebraic surface of degree @xmath181 in @xmath30 or in @xmath16 , with no plane or regulus components , and let @xmath2 be a set of @xmath3 distinct lines fully contained in @xmath45 .",
    "then the number of @xmath52-rich points ( points incident to at least two lines of @xmath2 ) is @xmath14 .",
    "* proof . * partition @xmath2 into the subsets @xmath198 and @xmath186 , as in the proof of theorem  [",
    "th : main3d ] .",
    "( recall that @xmath186 is the set of all lines that are either contained in non - ruled components of @xmath45 , or contained in more than one component , or are exceptional lines on ruled components . ) by lemma  [ claim:4d ] , each line of @xmath198 is non - conically incident to only @xmath97 other lines of @xmath198 , for a total of @xmath14 @xmath52-rich points of this sort .",
    "note that we now carry out the analysis without pruning any point ( we do not want to do that ) , because @xmath45 does not contain any plane or regulus component .",
    "the number of 2-rich points that are exceptional points is at most the number of irreducible components of @xmath45 , that is , at most @xmath59 , so this number is negligible .",
    "the number of lines in @xmath186 is @xmath189 .",
    "let @xmath263 be a plane or a regulus .",
    "the number of lines of @xmath186 contained in @xmath263 is at most @xmath449 ( this holds if we assume , as we may , that @xmath450 ) .",
    "it therefore follows from guth and katz  @xcite that the number of 2-rich points involvoing the lines of @xmath186 is @xmath451 .",
    "it remains to consider 2-rich points that are intersection points of a line in @xmath186 and a line in @xmath198 . by construction , each line @xmath223 is contained in precisely one ( ruled ) component @xmath322 of @xmath45 .",
    "if @xmath452 is also incident to a line @xmath453 then , again by construction , @xmath200 is fully contained in another component @xmath454 of @xmath45 , which does not fully contain @xmath101 .",
    "hence @xmath101 intersects @xmath454 in at most @xmath455 points ( one of which is @xmath86 ) , for a total of at most @xmath456 points .",
    "therefore , the number of 2-rich points involving one line in @xmath198 and another in @xmath186 is at most @xmath457 .",
    "as we have exhausetd all cases , the assertion follows .",
    "@xmath173    * ( 8) * challenging directions for further research are ( a ) to bound the number of incidences between points and lines on @xmath458-dimensional varieties in @xmath8 ( or in higher dimensions ) , for @xmath420 , ( b ) to bound the number of 2-rich points in a finite set of lines contained in such a variety , and ( c ) to bound the number of incidences between points on a variety and @xmath136-flats ( under suitable restrictions ) in three , four , or higher dimensions .    99    a. beauville , _ complex algebraic surfaces _ , vol .",
    "34 , cambridge university press , cambridge , 1996 .",
    "m.  beltrametti , _ lectures on curves , surfaces and projective varieties : a classical view of algebraic geometry _ , european mathematical society , 2009 .",
    "d. cox , j. little and d. oshea , _ ideals , varieties , and algorithms : an introduction to computational algebraic geometry and commutative algebra , _ springer verlag , heidelberg , 2007 .",
    "w. l. edge , _ the theory of ruled surfaces _ , cambridge university press , cambridge , 2011 .",
    "g. elekes , sums versus products in number theory , algebra and erds geometry  a survey , in _ paul erds and his mathematics",
    "ii , bolyai math .",
    "soc . , stud .",
    "11 , budapest , 2002 , pp .",
    "241290 .",
    "g. elekes , h. kaplan and m. sharir , on lines , joints , and incidences in three dimensions , _",
    "j. combinat .",
    "theory , ser .",
    "a _ 118 ( 2011 ) , 962977 .",
    "also in arxiv:0905.1583 .",
    "p.  erds , on sets of distances of @xmath3 points , _ amer .",
    "monthly _ 53 ( 1946 ) , 248250 .",
    "d. fuchs and s. tabachnikov , _ mathematical omnibus : thirty lectures on classic mathematics _ , amer .",
    "soc . press , providence , ri , 2007 .",
    "w.  fulton , _ introduction to intersection theory in algebraic geometry _",
    ", expository lectures from the cbms regional conference held at george mason university , june 27july 1 , 1983 , vol . 54 .",
    "ams bookstore , 1984 .",
    "p.  griffiths and j.  harris , _ principles of algebraic geometry _ , vol .",
    "52 , john wiley & sons , new york , 2011 .",
    "l.  guth , ruled surface theory and incidence geometry , in arxiv:1606.07682 .",
    "l.  guth , _ polynomial methods in combinatorics _ , university lecture series , vol .",
    "64 , amer .",
    "soc . press , providence , ri , 2016 .    l. guth and n. h. katz , algebraic methods in discrete analogs of the kakeya problem ,",
    "_ advances math . _ 225 ( 2010 ) , 28282839 . also in arxiv:0812.1043 .",
    "l. guth and n. h. katz , on the erds distinct distances problem in the plane , _ annals math .",
    "_ 181 ( 2015 ) , 155190 . also in arxiv:1011.4105 .",
    "j.  harris , _ algebraic geometry : a first course _ , vol .",
    "springer - verlag , new york , 1992 .",
    "r.  hartshorne , _ algebraic geometry _ , springer - verlag , new york , 1983 .",
    "t. a. ivey and j. m. landsberg , _",
    "cartan for beginners : differential geometry via moving frames and exterior differential systems _ , graduate studies in mathematics , volume 61 , amer . math .",
    "soc . , providence , ri , 2003 .",
    "n.  h.  katz , the flecnode polynomial : a central object in incidence geometry , in arxiv:1404.3412 .",
    "j. kollr , szemerdi  trotter - type theorems in dimension 3 , _ advances math . _ 271 ( 2015 ) , 3061 .",
    "also in arxiv:1405.2243 .",
    "e. kunz , _ introduction to commutative algebra and algebraic geometry _",
    ", springer - verlag , heidelberg , 2012 .",
    "j.  m.  landsberg , is a linear space contained in a submanifold ? on the number of derivatives needed to tell ,",
    "_ j. reine angew . math . _ 508 ( 1999 ) , 5360 .",
    "e. mezzetti and d. portelli , on threefolds covered by lines , in _ abhandlungen aus dem mathematischen seminar der universitt hamburg _ , vol .",
    "1 , springer verlag , heidelberg , 2000 .    g. monge , _ application de lanalyse  la geometrie _ , bernard , paris , 1809 .",
    "a. pressley , _ elementary differential geometry _",
    ", springer undergraduate mathematics series , springer verlag , london , 2001 .    s. richelson , _ classifying varieties with many lines _ , a senior thesis , harvard university , 2008 .",
    "e. rogora , varieties with many lines , _ manuscripta mathematica _ 82.1 ( 1994 ) , 207226 .",
    "g.  salmon , _ a treatise on the analytic geometry of three dimensions _ ,",
    "2 , 5th edition , hodges , figgis and co. ltd . , dublin , 1915 .",
    "b. segre , sulle @xmath459 contenenti pi di @xmath460 , nota i e ii , _ rend .",
    "lincei _ 5 ( 1948 ) , 193197 , 275280 .",
    "f. severi , intorno ai punti doppi impropri etc .",
    "15 ( 10 ) ( 1901 ) , 3351 .",
    "i. r. shafarevich , _ basic algebraic geometry _",
    "197 , springer - verlag , new york , 1977 .",
    "m. sharir and n. solomon , incidences between points and lines in three dimensions , in _ intuitive geometry _ ( j. pach , ed . ) , to appear . also in _ proc .",
    "31st sympos .",
    "_ ( 2015 ) , 553568 , and in arxiv:1501.02544 .",
    "m. sharir and n. solomon , incidences between points and lines in @xmath4 , _ proc .",
    "30th annu .",
    "geom . _ , 2014 , 189197 .",
    "m. sharir and n. solomon , incidences between points and lines in four dimensions , _ discrete comput .",
    "_ , in press . also in _ proc .",
    "56th ieee symp . on foundations of computer science _",
    "( 2015 ) , 13781394 , and in arxiv:1411.0777 .",
    "a. sheffer and j. zahl , point - curve incidences in the complex plane , in arxiv:1502.07003 .",
    "n. solomon and r. zhang , highly incidental patterns on a quadratic hypersurface in @xmath4 , in arxiv:1601.01817 .",
    "j.  solymosi and t.  tao , an incidence theorem in higher dimensions , _ discrete comput .",
    "_ 48 ( 2012 ) , 255280 .    j. solymosi and f. de zeeuw , incidence bounds for complex algebraic curves on cartesian products , in arxiv:1502.05304 .",
    "m.  r.  spiegel , s. lipschutz , and d. spellman , _ vector analysis _ , 2nd edition , schaum s outlines , mcgraw - hill , 2009 .",
    "e. szemerdi and w.  t. trotter , extremal problems in discrete geometry , _ combinatorica _ 3 ( 1983 ) , 381392 .",
    "tth , the szemerdi - trotter theorem in the complex plane , _ combinatorica _ 35 ( 2015 ) , 95126 . also in arxiv:0305283 ( 2003 ) .",
    "j. zahl , a szemerdi - trotter type theorem in @xmath461 , _ discrete comput .",
    "_ 54 ( 2015 ) , 513572 . also in arxiv:1203.4600",
    "in this section we review the preliminary algebraic ( and differential ) geometry infrastructure needed for our analysis , and then go on to establish the properties of ruled surfaces that we will use .",
    "these properties are considered folklore in the literature ; having failed to find rigorous proofs of them ( except for several short proofs or proof sketches for some of them ) , we provide here such proofs for the sake of completeness . some of the notions covered in this section are also discussed in our study  @xcite on point - line incidences in four dimensions .",
    "the notion of singularities is a major concept , treated in full generality in algebraic geometry ( see , e.g. , kunz  ( * ? ? ?",
    "* theorem vi.1.15 ) and cox et al .",
    "@xcite ) . here",
    "we only recall some of their properties , and only for a few special cases that are relevant to our analysis .",
    "let @xmath45 be a two - dimensional variety in @xmath30 or @xmath16 of degree @xmath59 , given as the zero set @xmath82 of some trivariate polynomial @xmath79 .",
    "assuming @xmath79 to be square - free , a point @xmath331 is _ singular _ if @xmath462 .",
    "for any point @xmath331 , let @xmath463 be the taylor expansion of @xmath79 near @xmath86 , where @xmath274 is the @xmath273-th order term in the expansion ( which is a homogeneous polynomial of @xmath411 of degree @xmath273 ) , and where we assume that there are no terms of order ( i.e. , degree ) smaller than @xmath464 .",
    "( the terms @xmath274 also depend on @xmath86 , which we regard as fixed in the present discussion . ) in general , we have @xmath465 , @xmath466 , where @xmath467 is the hessian matrix of @xmath79 , and the higher - order terms are similarly defined , albeit with more involved expressions .",
    "if @xmath86 is singular , we have @xmath468 . in this case",
    ", we say that @xmath86 is a singular point of @xmath245 of _ multiplicity _ @xmath469 .",
    "for any point @xmath331 , we call the hypersurface @xmath470 the _ tangent cone _ of @xmath82 at @xmath86 , and denote it by @xmath471 . if @xmath472 , then @xmath86 is non - singular and the tangent cone coincides with the ( well - defined ) tangent plane @xmath242 to @xmath82 at @xmath86 .",
    "we denote by @xmath473 the locus of singular points of @xmath45 .",
    "this is a subvariety of dimension at most @xmath329 ; see , e.g. , solymosi and tao  ( * ? ? ? * proposition  4.4 ) .",
    "we say that a line @xmath101 is a _ singular line _ for @xmath45 if all of its points are singular points of @xmath45 .",
    "similarly , let @xmath150 be a one - dimensional algebraic curve in @xmath474 or in @xmath475 , specified as @xmath82 , for some bivariate square - free polynomial @xmath79 .",
    "then @xmath331 is _ singular _ if @xmath476 .",
    "the _ multiplicity _",
    "@xmath464 of a point @xmath477 is defined as in the three - dimensional case , and we denote it as @xmath478 ; the multiplicity is at least @xmath52 when @xmath86 is singular .",
    "the singular locus @xmath479 of @xmath150 is now a discrete set .",
    "indeed , the fact that @xmath79 is square - free guarantees that @xmath79 has no common factor with any of its first - order derivatives , and bzout s theorem ( see , e.g. , ( * ? ? ?",
    "* theorem 8.7.7 ) ) then implies that the common zero set of @xmath79 , @xmath269 , @xmath480 , and @xmath481 is a ( finite ) discrete set .    still in two dimensions ,",
    "a line @xmath101 , not fully contained in the curve @xmath150 , can intersect it in at most @xmath59 points , _ counted with multiplicity_. to define this concept formally , as in , e.g. , beltrametti  ( * ? ? ?",
    "* section 3.4 ) , let @xmath101 be a line and let @xmath482 , such that @xmath101 is not contained in the tangent cone of @xmath150 at @xmath86 .",
    "intersection multiplicity _ of @xmath150 and @xmath101 at @xmath86 is the smallest order of a nonzero term of the taylor expansion of @xmath79 at @xmath86 in the direction of @xmath101 .",
    "as it happens , the intersection multiplicity is also equal to @xmath483 ( informally , this is the number of branches of @xmath150 that @xmath101 crosses at @xmath86 , counted with multiplicity ; see ( * ? ? ?",
    "* section 8.7 ) for a treatment on the intersection multiplicity in the plane ) . the intersection between a line @xmath101 and a curve @xmath150 ( not containing @xmath101 ) consists of at most @xmath484 points , counted with their intersection multiplicities .",
    "we say that a non - singular point @xmath486 is _ flat _ if the second - order taylor expansion of @xmath79 at @xmath411 vanishes on the tangent plane @xmath487 , or alternatively , if the _ second fundamental form _ of @xmath45 vanishes at @xmath411 ( see , e.g. , pressley  @xcite ) .",
    "as argued , e.g. , in elekes et al .",
    "@xcite , if @xmath411 is a non - singular point of @xmath45 and there exist three lines incident to @xmath86 that are fully contained in @xmath45 ( this property is captured by calling @xmath86 a _ linearly flat _ point ) then @xmath411 is a flat point .",
    "following guth and katz  @xcite , elekes et al .",
    "* proposition 6 ) proved that a non - singular point @xmath488 is flat if and only if certain three polynomials , each of degree at most @xmath339 , vanish at @xmath86 . a non - singular line @xmath101 is said to be _ flat _ if all of its non - singular points are flat . by guth and katz  @xcite",
    "( see also elekes et al .",
    "* proposition 7 ) ) , the number of flat lines fully contained in @xmath45 is at most @xmath489 , unless @xmath45 is a plane .    as in the proof of theorem",
    "[ th : main4d ] , the notions of linear flatness and flatness can be extended to any higher dimension .",
    "for example , for a three - dimensional surface @xmath45 in @xmath4 or in @xmath19 , which is the zero set of some polynomial @xmath79 of degree @xmath59 , a non - singular point @xmath486 is said to be _ linearly flat _",
    ", if it is incident to at least three distinct 2-flats that are fully contained in @xmath245 ( and thus also in the tangent hyperplane @xmath242 ) .",
    "linearly flat points can then be shown to be _ flat _ , meaning that the second fundamental form of @xmath79 vanishes at them .",
    "this property , at a point @xmath86 , can be expressed by several polynomials of degree @xmath339 vanishing at @xmath86 ( see  ( * ? ? ?",
    "* section 2.5 ) ) . as in the three - dimensional case",
    ", the second fundamental form vanishes identically on @xmath82 if and only if @xmath82 is not a hyperplane .",
    "this property holds in any dimension ; see , e.g.  ( * ? ? ?",
    "* exercise 3.2.12.2 ) ) . as in three dimensions ,",
    "we call a line fully contained in @xmath45 _ flat _ if all its non - singular points are flat .      for a modern approach to ruled surfaces ,",
    "there are many references ; see , e.g. , hartshorne  ( * ? ? ?",
    "* section v.2 ) , or beauville  ( * ? ? ?",
    "* chapter iii ) ; see also salmon  @xcite and edge  @xcite for earlier treatments of ruled surfaces .",
    "three relevant very recent additions are the survey  @xcite and book  @xcite of guth , as well as a survey in kollr  @xcite , where this topic is addressed in detail .",
    "we say that a real ( resp . ,",
    "complex ) surface @xmath45 is _ ruled by real _",
    ", _ complex _ ) _ lines _ if every point @xmath86 in a zariski - open is the smallest ( by containment ) algebraic variety @xmath45 that contains @xmath490 .",
    "@xmath490 is zariski closed if it is equal to its closure ( and is therefore a variety ) , and is ( relatively ) zariski open if its complement ( within a given variety ) is zariski closed .",
    "see cox et al .",
    "* section 4.2 ) for further details . ]",
    "dense subset of @xmath45 is incident to a real ( complex ) line that is fully contained in @xmath45 .",
    "this definition has been used in several recent works , see , e.g. ,  @xcite ; it is a slightly weaker condition than the classical condition where it is required that _ every _ point of @xmath45 be incident to a line contained in @xmath45 ( e.g. , as in  @xcite ) .",
    "nevertheless , similarly to the proof of lemma 3.4 in guth and katz  @xcite , a limit argument implies that the two definitions are in fact equivalent .",
    "we give , in lemma  [ le : rs ] below , a short algebraic proof of this fact , for the sake of completeness .",
    "[ [ flecnodes - in - three - dimensions - and - the - cayley - salmon - monge - theorem . ] ] flecnodes in three dimensions and the cayley - salmon - monge theorem .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we first recall the classical theorem of cayley and salmon , also due to monge .",
    "consider a polynomial @xmath84 $ ] of degree @xmath85 .",
    "a _ flecnode _ of @xmath79 is a point @xmath331 for which there exists a line that is incident to @xmath86 and _ osculates _ to @xmath82 at @xmath86 to order three .",
    "that is , if the direction of the line is @xmath87 then @xmath88 , and @xmath89 , where @xmath90 are , respectively , the first , second , and third - order derivatives of @xmath79 in the direction @xmath87 ( compare with the definition of singular points , as reviewed earlier , for the explicit forms of @xmath491 and @xmath492 ) .",
    "the _ flecnode polynomial _ of @xmath79 , denoted @xmath91 , is the polynomial obtained by eliminating @xmath87 from these three homogeneous equations ( where @xmath86 is regarded as a fixed parameter ) . as shown in salmon  ( * ? ? ?",
    "* chapter xvii , section iii ) , the degree of @xmath91 is at most @xmath92 . by construction , the flecnode polynomial of @xmath79 vanishes on all the flecnodes of @xmath79 , and in particular on all the lines fully contained in @xmath82 .",
    "* theorem 2.1 . *",
    "( cayley and salmon  @xcite , monge  @xcite ) _ let @xmath84 $ ] be a polynomial of degree @xmath93",
    ". then @xmath82 is ruled by ( complex ) lines if and only if @xmath94 . _ ( note that the correct formulation of theorem  [ th : flec2a ] is over @xmath43 ; earlier applications , over @xmath98 , as the one in guth and katz  @xcite , require some additional arguments to establish their validity ; see katz  @xcite for a discussion of this issue . )    [ le : rs ] let @xmath84 $ ] be an irreducible polynomial such that there exists a nonempty zariski open dense set in @xmath82 so that each point in the set is incident to a line that is fully contained in @xmath82 . then @xmath91 vanishes identically on @xmath82 , and @xmath82 is ruled by lines .    *",
    "* let @xmath493 be the set assumed in the lemma . by assumption and definition",
    ", @xmath91 vanishes on @xmath361 , so @xmath361 , and its zariski closure , are contained in @xmath494 .",
    "since @xmath361 is open , it must be two - dimensional .",
    "indeed , otherwise its complement would be a ( nonempty ) two - dimensional subvariety of @xmath82 ( a zariski closed set is a variety ) . in this case",
    ", the complement must be equal to @xmath82 , since @xmath79 is irreducible , which is impossible since @xmath361 is nonempty .",
    "hence @xmath494 is also two - dimensional , and thus , by the same argument just used , must be equal to @xmath82 .",
    "theorem  [ th : flec2a ] then implies that @xmath82 is ruled by ( complex ) lines , as claimed .",
    "the notions of flecnodes and of the flecnode polynomial can be extended to four dimensions , as done in  @xcite .",
    "informally , the _ four - dimensional flecnode polynomial _ @xmath95 of @xmath79 is defined analogously to the three - dimensional variant @xmath91 , and captures the property that a point on @xmath82 is incident to a line that osculates to @xmath82 up to the _ fourth _ order .",
    "it is obtained by eliminating the direction @xmath87 of the osculating line from the four homogeneous equations given by the vanishing of the first four terms of the taylor expansion of @xmath96 near @xmath86 . clearly , @xmath95 vanishes identically on every line that is fully contained in @xmath82 . as in the three - dimensional case",
    ", its degree can be shown to be @xmath97 .",
    "landsberg  @xcite derives an analog of theorem  [ th : flec2a ] that holds for three - dimensional surfaces ( see  ( * ? ? ?",
    "* theorem 2.11 ) ) .",
    "specifically , landsberg s theorem asserts that if @xmath95 vanishes identically on @xmath82 , then @xmath82 is ruled by ( possibly complex ) lines .",
    "we will discuss this in more detail in section  [ sec : pfmain ] .",
    "these theorems , in three and four dimensions , play an important role in the proofs of the main theorems .",
    "[ harris  ] [ th : harr ] let @xmath388 be a projective variety and @xmath495 be a homogeneous polynomial map ( i.e. , the coordinate functions @xmath496 are homogeneous polynomials ) ; let @xmath497 denote the image of @xmath388 .",
    "for any @xmath498 , let @xmath499 .",
    "then @xmath500 is an upper semi - continuous function of @xmath86 in the zariski topology on @xmath490 ; that is , for any @xmath1 , the locus of points @xmath501 such that @xmath502 is zariski closed in @xmath490 . moreover , if @xmath503 is any irreducible component , @xmath504 its image , and @xmath505 the minimum value of @xmath500 on @xmath506 , then @xmath507      [ harris  ] [ th : harrdim ] let @xmath508 be the map induced by the standard projection map @xmath509 ( which retains @xmath510 of the coordinates and discards the rest ) , where @xmath511 , where @xmath512 and @xmath513 are projective varieties , @xmath388 is irreducible , and @xmath490 is the image of @xmath388 ( which is also irreducible ) .",
    "then the general fiber of the map @xmath79 is finite if and only if @xmath514 . in this case",
    ", the number of points in a general fiber of @xmath79 is constant .    in particular ,",
    "when @xmath490 is two - dimensional ( and @xmath515 are arbitrary ) , there exist an integer @xmath516 and an algebraic curve @xmath517 , such that for any @xmath518 , we have @xmath519 . with the notations of theorem  [",
    "th : harrdim ] , the set of points @xmath520 , such that the fiber of @xmath79 over @xmath521 is not equal to @xmath516 is a zariski closed proper subvariety of @xmath490 . for more details ,",
    "we refer the reader to shafarevich  ( * ? ? ?",
    "* theorem ii.6.4 ) , and to hartshorne  ( * ? ? ?",
    "* exercise ii.3.7 ) .",
    "[ harris  ] [ le : harr ] let @xmath522 be a polynomial map between two projective varieties @xmath388 , @xmath490 , with @xmath523 irreducible .",
    "suppose that all the fibers @xmath524 of @xmath48 , for @xmath501 , are irreducible and of the same dimension .",
    "then @xmath388 is also irreducible .",
    "we rederive here the following ( folklore ) characterization of _ doubly ruled _ surfaces in @xmath30 or @xmath16 , namely , irreducible algebraic surfaces , each of whose points is incident to at least two distinct lines that are fully contained in the surface .",
    "recall that a _ regulus _ is the surface spanned by all lines that meet three pairwise skew lines in @xmath77-space . for an elementary proof that a doubly ruled surface must be a regulus",
    ", we refer the reader to fuchs and tabachnikov  ( * ? ? ?",
    "* theorem 16.4 ) .",
    "their proof however is analytic and works only over the reals .",
    "* lemma 2.2 . *",
    "_ let @xmath45 be an irreducible ruled surface in @xmath30 or in @xmath16 which is not a plane , and let @xmath99 be an algebraic curve , such that every non - singular point @xmath100 is incident to exactly two lines that are fully contained in @xmath45 . then @xmath45 is a regulus . _ , a regulus is either a hyperbolic paraboloid or a one - sheeted hyperboloid . over @xmath43 ,",
    "balls ( equivalent to hyperboloids ) and paraboloids ( equivalent to hyperbolic paraboloids ) are also reguli , and are indeed doubly ruled by complex lines .",
    "not all quadrics are reguli , though : for example , the cylinder @xmath525 is not a regulus . ] * proof . *",
    "as mentioned above ( see also @xcite ) , the number of singular lines in @xmath45 is finite ( it is smaller than @xmath526 ) . for any non - singular line @xmath101 , fully contained in @xmath45 , but",
    "not in @xmath527 , the union of lines @xmath528 intersecting @xmath101 and fully contained in @xmath45 is a subvariety of @xmath45 ( see sharir and solomon  ( * ? ? ?",
    "* lemma 8) for the easy proof ) . by assumption ,",
    "each non - singular point in @xmath529 is incident to another line ( other than @xmath101 ) fully contained in @xmath45 , and thus @xmath530 is the union of infinitely many lines , and is therefore two - dimensional .",
    "since @xmath45 is irreducible , it follows that @xmath531 .",
    "next , pick any triple of non - singular and non - concurrent lines @xmath118 that are contained in @xmath45 and intersect @xmath101 at distinct non - singular points of @xmath532 .",
    "there has to exist such a triple , for otherwise we would have an infinite family of concurrent ( or parallel ) lines incident to @xmath101 and contained in @xmath45 ( where the point of concurrency lies outside @xmath101 ) , and the plane that they span would then have to be contained in ( the irreducible ) @xmath45 , contrary to assumption .",
    "see figure  [ freg ] for an illustration .",
    "the argument given for @xmath101 applies equally well to @xmath533 , @xmath534 , and @xmath535 ( by construction , neither of them is fully contained in @xmath527 ) , and implies that @xmath536 .",
    "assume that there exists some line @xmath537 intersecting @xmath533 at some non - singular point @xmath538 , and that @xmath539 .",
    "( we treat lines here as projective varieties , so this assumption means that @xmath540 and @xmath534 are skew to one another ; parallel lines are considered to be intersecting . ) since @xmath541 , there exists some line @xmath542 intersecting @xmath534 , such that @xmath543 . hence there exist three distinct lines , namely @xmath544 and @xmath545 , that are incident to @xmath86 and fully contained in @xmath45 .",
    "since @xmath86 is non - singular , it must be a flat point ( as mentioned above ; see  @xcite ) . repeating this argument for @xmath546 non - singular points @xmath547",
    ", it follows that @xmath533 contains at least @xmath546 flat points , and is therefore , by the properties of flat points noted earlier , a flat line .",
    "as is easily checked , @xmath533 can be taken to be an arbitrary non - singular line among those incident to @xmath101 , so it follows that every non - singular point on @xmath45 is flat , and therefore , as shown in @xcite , @xmath45 is a plane , contrary to assumption .",
    "therefore , every non - singular line that intersects @xmath533 at a non - singular point also intersects @xmath534 , and , similarly , it also intersects @xmath535 .",
    "this implies that the intersection of @xmath45 and the surface @xmath548 generated by the lines intersecting @xmath549 , and @xmath535 is two - dimensional , and is therefore equal to @xmath45 , since @xmath45 is irreducible . since @xmath549 and @xmath535 are pairwise skew , @xmath550 is a regulus , as asserted .",
    "expanding on the comment at the end of section  [ se : pre ] , let us elaborate about the field over which the variety @xmath45 is defined .",
    "most of the basic algebraic geometry tools have been developed over the complex field @xmath43 , and some care has to be exercised when applying them over the reals .",
    "a major part of the theory developed in this section is of this nature .",
    "for example , both theorems  [ th : harr ] and  [ th : harrdim ] hold only over the complex field . as another important example ,",
    "one of the main tools at our disposal is the cayley  salmon ",
    "monge theorem ( theorem  [ th : flec2a ] ) , whose original formulation also applies only over @xmath43 .",
    "expanding on a previously made comment , we note that even when @xmath45 is a variety defined as the zero set of a real polynomial @xmath79 , the vanishing of the flecnode polynomial @xmath91 only guarantees that the set of complex points of @xmath45 is ruled by complex lines .",
    "( a very simple example that illustrates this issue is the unit sphere @xmath551 , given by @xmath552 , which is certainly not ruled by real lines , but the flecnode polynomial of @xmath553 vanishes on @xmath551 ( since the equation @xmath554 that participates in its construction is identically zero for any quadratic polynomial @xmath79 ) .",
    "this is the condition in the cayley ",
    "monge theorem that guarantees that @xmath551 is ruled by ( complex ) lines , and indeed it does , as is easily checked ; in fact , for the same reason , every quadric is ruled by complex lines . )      this is just one example of many similar issues that one must watch out for .",
    "it is a fairly standard practice in algebraic geometry that handles a real algebraic variety @xmath45 , defined by real polynomials , by considering its complex counterpart @xmath555 , namely the set of complex points at which the polynomials defining @xmath45 vanish .",
    "the rich toolbox that complex algebraic geometry has developed allows one to derive various properties of @xmath555 , but some care might be needed when transporting these properties back to the real variety @xmath45 , as the preceding note concerning the cayley  salmon  monge theorem illustrates .",
    "fortunately , though , passing to the complex domain ( and sometimes also to the projective setting ) does not pose any difficulties for deriving upper bounds in incidence problems  every real incidence will be preserved , and at worst we will be counting additional incidences , on the non - real portion of the extended varieties . with this understanding , and with the appropriate caution , we will move freely between the real and complex domains , as convenient .",
    "we note that most of the results developed in section  [ ssec : pfa ] of this paper also apply over @xmath43 , except for one crucial step ( where we resort to the application of the result of guth and katz  @xcite , which holds only over the reals ) , due to which we do not know how to extend theorem  [ th : main3d ] to the complex domain .",
    "nevertheless , we can derive a weaker variant of it for the complex case  see a remark to that effect in section  [ se : dis ] .      in preparation for the key technical theorem  [ singly ] , given below",
    ", we make the following comments .",
    "lines in three dimensions are parameterized by their _",
    "plcker coordinates _ , as follows ( see , e.g. , griffiths and harris  ( * ? ? ?",
    "* section 1.5 ) ) . for two points @xmath556 , given in projective coordinates as @xmath557 and @xmath558 , let @xmath559 denote the ( unique ) line in @xmath560 incident to both @xmath411 and @xmath521 .",
    "the plcker coordinates of @xmath559 are given in projective coordinates in @xmath105 as @xmath561 , where @xmath562 . under this parameterization",
    ", the set of lines in @xmath560 corresponds bijectively to the set of points in @xmath105 lying on the _ klein quadric _ given by the quadratic equation @xmath563 ( which is indeed always satisfied by the plcker coordinates of a line ) .",
    "given a surface @xmath45 in @xmath560 , the set of lines fully contained in @xmath45 , represented by their plcker coordinates in @xmath105 , is a subvariety of the klein quadric , which is denoted by @xmath143 , and is called the _",
    "fano variety _ of @xmath45 ; see harris  ( * ? ? ?",
    "* lecture 6 , page 63 ) for details , and ( * ? ? ?",
    "* example 6.19 ) for an illustration , and for a proof that @xmath143 is indeed a variety .",
    "the plcker coordinates are continuous , in the sense that if one takes two points @xmath101 , @xmath200 on the klein quadric that are near each other , the lines in @xmath560 that they correspond to are also near to one another , in an obvious sense whose precise details are omitted here .",
    "we note again that our analysis is carried out in the complex projective setting , which makes it simpler , and facilitates the application of numerous tools from algebraic geometry that are developed in this setting .",
    "the passage from the complex projective setup back to the real affine one is straightforward ",
    "the former is a generalization of the latter .    given a plane @xmath48 by a homogeneous equation @xmath564 , and a line @xmath101 not fully contained in @xmath48 , given in plcker",
    "coordinates as @xmath561 , their point of intersection is given in homogeneous coordinates by @xmath565 , where @xmath566 , @xmath567 , and where @xmath568 stands for the scalar product , and @xmath569 for the vector product ; see , e.g. ,  @xcite .",
    "this , together with the continuity argument stated above , implies that , if the fano variety @xmath143 is one - dimensional , and @xmath101 is a line represented by a non - singular point of @xmath143 , then the cross section of the union of the lines that lie near @xmath101 in @xmath143 with a generic plane @xmath48 is a simple arc .",
    "when @xmath101 is a singular point of @xmath143 , then the cross section of the union of the lines that lie near @xmath101 in @xmath143 with a generic plane @xmath48 is a union of simple arcs meeting at @xmath570 where some of these arcs might appear with multiplicity ; the number of these arcs is determined by the multiplicity of the singularity of @xmath101",
    ".      ruled surfaces that are neither planes nor reguli are called _ singly ruled _ surfaces ( a terminology justified by theorem  [ singly ] , given below ) .",
    "a line @xmath101 , fully contained in an irreducible singly ruled surface @xmath45 , such that every point of @xmath101 is `` doubly ruled '' , i.e. , every point on @xmath101 is incident to another line fully contained in @xmath45 , is called an _ exceptional _ line fully contained in an irreducible singly ruled surface @xmath45 , is called _ exceptional _ if it contains infinitely many `` doubly ruled '' points , each incident to another line fully contained in @xmath45 .",
    "our definition appears to be stricter , but , as the proof below will reveal , the two notions are equivalent . ] of @xmath45 .",
    "a point @xmath571 that is incident to infinitely many lines fully contained in @xmath45 is called an _ exceptional _ point of @xmath45 .    the following result is another folklore result in the theory of ruled surfaces , used in many studies ( such as guth and katz  @xcite ) .",
    "it justifies the terminology `` singly - ruled surface '' , by showing that the surface is generated by a one - dimensional family of lines , and that each point on the surface , with the possible exception of points lying on some curve , is incident to exactly one generator .",
    "it also shows that there are only finitely many exceptional lines ; the property that their number is at most two ( see  @xcite ) is presented later .",
    "we give a detailed and rigorous proof , to make our presentation as self - contained as possible ; we are not aware of any similarly detailed argument in the literature .",
    "* theorem 2.3 . *",
    "_ ( a ) let @xmath45 be an irreducible ruled two - dimensional surface of degree @xmath103 in @xmath30 ( or in @xmath16 ) , which is not a regulus . then , except for finitely many exceptional lines , the lines that are fully contained in @xmath45 are parameterized by an irreducible algebraic curve @xmath104 in the plcker space @xmath105 , and thus yield a 1-parameter family of generator lines @xmath106 , for @xmath107 , that depend continuously on the real or complex parameter @xmath108 .",
    "moreover , if @xmath109 , and @xmath572 , then there exist sufficiently small and disjoint neighborhoods @xmath111 of @xmath112 and @xmath113 of @xmath114 , such that all the lines @xmath106 , for @xmath115 , are distinct .",
    "_    _ ( b ) there exists a one - dimensional curve @xmath99 , such that any point @xmath86 in @xmath116 is incident to exactly one generator line of @xmath45 . _ * remark . * for a detailed description of the algebraic representation of @xmath45 by generators , as in part ( a ) of the theorem , see edge  ( * ? ? ?",
    "* section ii ) .    *",
    "* assume first that we are working over @xmath43 .",
    "consider the fano variety @xmath143 of @xmath45 , as defined above .",
    "we claim that all the irreducible components of @xmath143 are at most one - dimensional .",
    "informally , if any component @xmath104 of @xmath143 were two - dimensional , then the set @xmath573 would be three - dimensional , so , `` on average '' , the set of lines of @xmath143 incident to a point @xmath83 would be one - dimensional , implying that most points of @xmath45 are incident to infinitely many lines that are fully contained in @xmath45 , which can happen only when @xmath45 is a plane ( or a non - planar cone , which can not arise with a non - singular point @xmath86 as an apex ) , contrary to assumption .",
    "@xmath322 can formally be defined as the zero set of suitable homogeneous polynomials ; briefly , with the plcker parameterization of lines in @xmath560 , and putting the point @xmath86 into homogeneous coordinates , the condition @xmath452 can be expressed as the vanishing of two suitable homogeneous polynomials , and the other defining polynomials of @xmath322 are those that define the projective variety @xmath143 .",
    "therefore , @xmath322 is a projective variety .",
    "consider an irreducible component @xmath104 of @xmath143 ( which is also a projective variety ) ; put @xmath577 since @xmath322 and @xmath104 are projective varieties , so is @xmath578 .",
    "as is easily verified , @xmath579 ( that is , @xmath580 is surjective ) .",
    "we claim that @xmath578 is irreducible . indeed , for any @xmath581",
    ", the fiber of the map @xmath582 over @xmath101 is @xmath583 which is ( isomorphic to ) a line , and is therefore irreducible of dimension one .",
    "as @xmath104 is irreducible , lemma  [ le : harr ] implies that @xmath578 is also irreducible , as claimed .    for a point @xmath584 , consider the set @xmath585 , put @xmath586 , and let @xmath587 . by the theorem of the fibers ( theorem  [ th : harr ] ) , applied to the map @xmath588",
    ", we have @xmath589 we claim that @xmath590 .",
    "in fact , @xmath591 for all points @xmath83 , except for at most one point . indeed ,",
    "if @xmath592 for some point @xmath83 , then @xmath381 is ( at least ) one - dimensional , and @xmath45 , being irreducible , is thus a cone with apex at @xmath86 ; since @xmath45 can have at most one apex , the claim follows .",
    "hence @xmath593 , and therefore @xmath594 next , assume , for a contradiction , that @xmath595 .",
    "for a point ( i.e. , a line in @xmath560 ) @xmath596 , the set @xmath597 is one - dimensional ( the equality follows from the way @xmath578 is defined ) .",
    "conforming to the notations in the theorem of the fibers , we have @xmath598 , and thus @xmath599 . also , by assumption , @xmath600 . by the theorem of the fibers , applied this time to @xmath601 , we thus have @xmath602 contradicting equation  ( [ eq : fibcon ] ) . therefore , every irreducible component of @xmath143 is at most one - dimensional , as claimed .",
    "let @xmath104 be such an irreducible component , and let @xmath603 , as above .",
    "as argued , for every @xmath604 , the fiber of @xmath605 over @xmath86 is non - empty and finite , except for at most one point @xmath86 ( the apex of @xmath45 if @xmath45 is a cone ) .",
    "since @xmath578 is irreducible , theorem  [ th : harrdim ] implies that there exists a zariski open set @xmath606 , such that for any point @xmath379 , the fiber of @xmath605 over @xmath86 has fixed cardinality @xmath516 . put @xmath607 . being the complement of a zariski open subset of the two - dimensional irreducible variety @xmath45 , @xmath608 is ( at most ) a one - dimensional variety .",
    "if @xmath609 , then , by lemma  [ doubly ] , @xmath45 is a regulus .",
    "otherwise , @xmath610 ( @xmath516 can not be zero for a ruled surface ) , meaning that , for every @xmath611 , there is exactly one line @xmath101 , such that @xmath612 , i.e. , @xmath104 contains exactly one line incident to @xmath86 and contained in @xmath45",
    ".    moreover , we observe that the union of lines of @xmath104 is the entire variety @xmath45 . indeed , by equations ( [ eq : fiber ] ) and ( [ eq : fibcon ] ) , we have @xmath613 .",
    "that is , the variety @xmath614 , which is the union of the lines of @xmath104 , must be the entire variety @xmath45 , because it is two - dimensional and is contained in the irreducible variety @xmath45 .    to recap",
    ", we have proved that if @xmath104 is a one - dimensional component of @xmath143 , then the union of lines that belong to @xmath104 covers @xmath45 , and that there exists a one - dimensional subvariety ( a curve ) @xmath99 such that , for every @xmath615 , @xmath104 contains exactly one line incident to @xmath86 and contained in @xmath45 .",
    "since @xmath45 is a ruled surface , some component of @xmath143 has to be one - dimensional , for otherwise we would only have a finite number of lines fully contained in @xmath45 .",
    "we claim that there is exactly one irreducible component of @xmath143 which is one - dimensional .",
    "indeed , assume to the contrary that @xmath616 are two ( distinct ) one - dimensional irreducible components of @xmath143 . as we observed , the union of lines parameterized by @xmath104 ( resp .",
    ", @xmath617 ) covers @xmath45 .",
    "let @xmath618 , @xmath619 denote the respective excluded curves , so that , for every @xmath620 ( resp .",
    ", @xmath621 ) there exists exactly one line in @xmath104 ( resp . ,",
    "@xmath617 ) that is incident to @xmath86 and contained in @xmath45 .    next ,",
    "notice that the intersection @xmath622 is a subvariety strictly contained in the irreducible one - dimensional variety @xmath104 ( since @xmath104 and @xmath617 are two distinct irreducible components of @xmath143 ) , so it must be zero - dimensional , and thus finite .",
    "let @xmath623 denote the union of the finitely many lines in @xmath622 , and put @xmath624 .",
    "for any point @xmath100 , there are two ( distinct ) lines incident to @xmath86 and fully contained in @xmath45 ( one belongs to @xmath381 and the other to @xmath625 ) .",
    "lemma  [ doubly ] ( with @xmath527 as defined above ) then implies that @xmath45 is a regulus , contrary to assumption .    in other words ,",
    "the unique one - dimensional irreducible component @xmath104 of @xmath143 serves as the desired 1-parameter family of generators for @xmath45 .",
    "( the local parameterization of @xmath104 can be obtained , e.g. , by using a suitable plcker coordinate to represent its lines . )",
    "in addition to @xmath104 , there is a finite number of zero - dimensional components ( i.e. , points ) of @xmath143 .",
    "they correspond to a finite number of lines , fully contained in @xmath45 , and not parameterized by @xmath104 .",
    "since the union of the lines in @xmath104 covers @xmath45 , any of these additional lines @xmath101 is _ exceptional _ , since each point on @xmath101 is also incident to a generator ( different from @xmath101 ) , and is thus `` doubly ruled '' .",
    "this establishes part ( a ) of the theorem , when @xmath45 is defined over @xmath43 .",
    "we remark that guth and katz  ( * ? ? ?",
    "* corollary 3.6 ) argue that there are at most two such exceptional lines , so there are at most two zero - dimensional components of @xmath143 . for the sake of completeness , we sketch a proof of our own of this fact , in lemma  [ only2exc ] below .",
    "if @xmath45 is defined over @xmath98 , we proceed as above , i.e. , consider instead the complex variety @xmath555 corresponding to @xmath45 . as we have just proven , the unique one - dimensional irreducible component @xmath104 of @xmath143 ( regarded as a complex variety ) is a ( complex ) 1-parameter family of generators for the set of complex points of @xmath45 . since @xmath45 is real , the ( real ) fano variety of @xmath45 consists of the real points of @xmath143 , i.e. , it is @xmath626 .",
    "as we have mentioned above , the ( complex ) @xmath143 is the union of @xmath104 with at most two other points .",
    "if @xmath627 were zero - dimensional , the real @xmath143 would also be discrete , as there is only one one - dimensional component @xmath104 , so @xmath45 would fully contain only finitely many ( real ) lines , contradicting the assumption that @xmath45 is ruled by real lines . therefore , @xmath628 is a one - dimensional irreducible component of the real fano variety of @xmath45 .",
    "( it is irreducible , since otherwise the complex @xmath104 would be reducible too , as is easily checked . )    summarizing , we have shown that there exists exactly one irreducible one - dimensional component @xmath104 of @xmath143 , and a corresponding one - dimensional subvariety @xmath629 , such that , for each point @xmath611 , @xmath104 contains exactly one line that is incident to @xmath86 ( and contained in @xmath45 ) .",
    "in addition to @xmath104 , @xmath143 might also contain up to two zero - dimensional ( i.e. , singleton ) components , whose elements are the exceptional lines mentioned above .",
    "let @xmath630 denote the union of @xmath608 and of the at most two exceptional lines ; @xmath631 is clearly a one - dimensional subvariety of @xmath45 .",
    "then , for any point @xmath632 , there is exactly one line incident to @xmath86 and fully contained in @xmath45 , as claimed .",
    "this establishes part ( b ) , and thus completes the proof of the theorem .        in view of the proofs of theorem  [ singly ] and lemma  [ le : rs ] , every point on a singly ruled surface @xmath45 is incident to at least one generator .",
    "hence an exceptional ( non - generator ) line is a line @xmath117 such that every point on @xmath101 is incident to a generator ( which is different from @xmath101 ) .    * lemma 2.4 . *",
    "_ let @xmath45 be an irreducible ruled surface in @xmath30 or in @xmath16 , which is neither a plane nor a regulus .",
    "then ( i ) @xmath45 contains at most two exceptional lines , and ( ii ) @xmath45 contains at most one exceptional point . _ * proof . * ( i ) we use the property , established in  @xcite and already used in the proof of lemma  [ doubly ] , that for a line @xmath101 fully contained in @xmath45 , the union @xmath633 of the lines that meet @xmath101 and are fully contained in @xmath45 is a variety in the complex projective space @xmath634 .",
    "moreover , if @xmath101 is an exceptional line of @xmath45 , then it follows by  ( * ? ? ? * lemma 8) that @xmath635 .",
    "( indeed , @xmath633 must be two - dimensional , since otherwise it would consist of only finitely many lines .",
    "since @xmath45 is irreducible , @xmath633 must then be equal to @xmath45 . )",
    "if @xmath45 contained three exceptional lines , @xmath636 and @xmath535 , then @xmath45 would have to be either a plane or a regulus . indeed ,",
    "otherwise , by theorem  [ singly ] ( whose proof does not depend on the number of exceptional lines ) , there would exist a one - dimensional curve @xmath99 ( that includes @xmath637 ) , such that every point @xmath100 is incident to exactly one line @xmath638 fully contained in @xmath45 . as @xmath639 and @xmath640 , for @xmath641 , it follows that @xmath638 intersects @xmath549 , and @xmath535 .",
    "if @xmath549 , and @xmath535 are pairwise skew , @xmath86 belongs to the regulus @xmath642 of all lines intersecting @xmath643 and @xmath535 .",
    "we have thus proved that @xmath644 is contained in @xmath642 , and as @xmath642 is irreducible , it follows that @xmath645 .",
    "if @xmath549 , and @xmath535 are concurrent but not coplanar then , arguing similarly , @xmath45 is a cone with their common intersection point as an apex .",
    "since a ( non - planar ) cone has no exceptional lines , as is easily checked , we may ignore this case .    finally if any pair among @xmath549 , @xmath535 , say @xmath533 , @xmath534 , are parallel then @xmath45 must be the plane that they span , contrary to assumption . if @xmath533 and @xmath534 intersect at a point @xmath219 , disjoint from @xmath535 , then @xmath45 is the union of the plane spanned by @xmath533 and @xmath534 and the plane spanned by @xmath219 and @xmath535 , again a contradiction .",
    "\\(ii ) by theorem  [ singly ] and ( i ) , all the lines that are fully contained in @xmath45 , except for possibly two such lines , are parameterized by an irreducible algebraic curve @xmath104 in the plcker space @xmath105 .",
    "let @xmath86 be an exceptional point of @xmath45 .",
    "the set @xmath646 of lines incident to @xmath86 is an algebraic curve contained in the irreducible curve @xmath104 , implying that @xmath647 .",
    "this clearly implies that there is at most one exceptional point ( and then it does not contain any exceptional line ) , and the proof of ( ii ) is complete too .          in the analysis in section  [ ssec : pfa ] , the goal is to project @xmath8 onto some generic 3-flat so that non - coplanar triples of lines do not project to coplanar triples .",
    "this is easily achieved by repeated applications of the following technical result , reducing the dimension one step at a time .",
    "* lemma 2.5 . *",
    "_ let @xmath118 be three non - coplanar lines in @xmath8 .",
    "then , under a generic projection of @xmath8 onto some hyperplane @xmath119 , the respective images @xmath120 of these lines are still non - coplanar . _",
    "* proof . *",
    "assume without loss of generality that the ( generic ) hyperplane @xmath119 onto which we project passes through the origin of @xmath8 , and let @xmath648 denote the unit vector normal to @xmath119 .",
    "the projection @xmath649 is then given by @xmath650 .",
    "assume first that two of the three given lines , say @xmath549 , are skew ( i.e. , not coplanar ) .",
    "let @xmath651 denote their projection onto @xmath119 .",
    "if @xmath652 are coplanar they are either intersecting or parallel . if they are intersecting , then there are points @xmath653 that project to the same point , i.e. , @xmath654 has the same direction as @xmath648",
    ". then @xmath648 belongs to the set @xmath655 .",
    "since this is a two - dimensional set , it will be avoided for a generic choice of @xmath648 , which is a generic point in @xmath656 , a set that is at least three - dimensional .",
    "if @xmath651 are parallel , let @xmath657 denote the directions of @xmath549 .",
    "since @xmath658 and @xmath659 are vectors in the directions of @xmath660 , and are thus parallel , it follows that @xmath648 must be a linear combination of @xmath661 and @xmath662 .",
    "since @xmath663 , the resulting set of possible directions is only one - dimensional , and , again , it will be avoided with a generic choice of @xmath648 .",
    "we may therefore assume that every pair of lines among @xmath118 are coplanar .",
    "since these three lines are not all coplanar , the only two possibilities are that either they are all mutually parallel , or all concurrent .",
    "assume first that they are concurrent , say they all pass through the origin ( even though the origin belongs to @xmath119 , this still involves no less of generality ) .",
    "their projections are in the directions @xmath664 , for @xmath641 .",
    "if these projections are coplanar then there exist coefficients @xmath665 , not all zero , such that @xmath666 .",
    "that is , putting @xmath667 , we have @xmath668 , so @xmath359 is parallel to @xmath648 . in this case",
    "@xmath648 belongs to the set @xmath669 .",
    "again , being a two - dimensional set , it will be avoided by a generic choice of @xmath648 .    in the remaining case ,",
    "the lines @xmath533 , @xmath534 , @xmath535 are mutually parallel , i.e. , they all have the same direction @xmath87 .",
    "put , for @xmath641 , @xmath670 , and choose @xmath671 so that @xmath672 .",
    "the plane @xmath673 spanned by @xmath674 is projected to the plane @xmath48 spanned by the points @xmath675 , for @xmath641 ( since @xmath676 , @xmath677 , @xmath678 are not collinear , they will not project into collinear points in a generic projection ) , and the three lines project into a common plane if and only if their projections are fully contained in @xmath48 , meaning that the projection @xmath679 is parallel to @xmath48 , so it must be a linear combination of @xmath680 , @xmath681 , and @xmath682 .",
    "a similar argument to those used above shows that a generic choice of @xmath648 will avoid the resulting two - dimensional set of forbidden directions .",
    "this completes the proof ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a set of @xmath1 points and @xmath2 a set of @xmath3 lines in @xmath4 , such that the points of @xmath0 lie on an algebraic three - dimensional surface of degree @xmath5 that does not contain hyperplane or quadric components , and no 2-flat contains more than @xmath6 lines of @xmath2 . </S>",
    "<S> we show that the number of incidences between @xmath0 and @xmath2 is @xmath7 for some absolute constant of proportionality . </S>",
    "<S> this significantly improves the bound of the authors  @xcite , for arbitrary sets of points and lines in @xmath4 , when @xmath5 is not too large . </S>",
    "<S> moreover , when @xmath5 and @xmath6 are constant , we get a _ linear _ bound . </S>",
    "<S> the same bound holds when the three - dimensional surface is embedded in any higher dimensional space .    for the proof of this bound </S>",
    "<S> , we revisit certain parts of  @xcite , combined with the following new incidence bound , for which we present a direct and fairly simple proof . </S>",
    "<S> let @xmath0 be a set of @xmath1 points and @xmath2 a set of @xmath3 lines in @xmath8 , for @xmath9 , which lie in a common two - dimensional algebraic surface of degree @xmath5 ( assumed to be @xmath10 ) that does not contain any 2-flat , so that no 2-flat contains more than @xmath6 lines of @xmath2 ( here we require that the lines of @xmath2 also be contained in the surface ) . then the number of incidences between @xmath0 and @xmath2 is @xmath11 when @xmath12 , this improves the bound of guth and katz  @xcite for this special case , when @xmath13 . </S>",
    "<S> moreover , the bound does not involve the term @xmath14 . </S>",
    "<S> this term arises in most standard approaches , and its removal is a significant aspect of our result . </S>",
    "<S> again , the bound is linear when @xmath15 .    </S>",
    "<S> finally , we also obtain ( slightly weaker ) variants of both results over the complex field . for two - dimensional varieties , </S>",
    "<S> when the ambient space is @xmath16 ( or any higher - dimensional @xmath17 ) , under the same assumptions as above , we have @xmath18 for three - dimensional varieties , embedded in @xmath19 ( or any higher - dimensional @xmath17 ) , under the same assumptions as above , we have @xmath20 these new incidence bounds are among the very few bounds , known so far , that hold over the complex field . </S>",
    "<S> the bound for two - dimensional ( resp . </S>",
    "<S> , three - dimensional ) varieties coincides with the bound in the real case when @xmath21 ( resp . , @xmath22 ) . </S>"
  ]
}