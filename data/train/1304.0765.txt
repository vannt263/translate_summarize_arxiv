{
  "article_text": [
    "according to the contemporary cosmological paradigm , cosmic structures emerge from the gravitational growth of primordial dark matter density fluctuations .",
    "a central problem in the last four decades has been the connection between this primordial fluctuation field and the abundance and assembly history of the virialized dark matter haloes ; in more detail , their mass function ( mf ) , mass aggregation histories ( mahs ) , and merger rates ( mrs ) . since the seminal work by press & schechter ( 1974 ; hereafter ps ) , many statistically - based analytical formalisms were developed in order to perform such a connection ( see for reviews e.g. , zentner 2007 ; mo , van den bosch & white 2010 ) .    in order to achieve an association between the density fluctuation field and the virialized haloes , one needs : a statistical description of the density fluctuation field , an inventory of the overdense regions which will be associated to the virialized objects , and a model for the dynamical evolution of the overdensities , including an operational criterion of collapse ( virialization ) .",
    "ps assumed a gaussian density field and used the spherical collapse model ( gunn & gott 1972 ) .",
    "a region of the density field is assumed to end as a virialized halo when its linearly evolving overdensity exceeds a critical value @xmath1 . the virialized mass at a fixed scale is assumed to be given by the contributions of the regions of this scale overdense by @xmath1 ( the _ ps ansatz _ ) plus the underdense regions of the same scale contained in larger regions overdense by @xmath1 ; the latter statement enunciates the so - called _ cloud - in - cloud problem_. in order to account for all mass , ps assumed that the second contribution equals to the first one , which justifies this the fudge factor of 2 introduced in their inferred halo mf .    based on a more rigorous statistical description , the excursion set ( es ) ,",
    "also know as extended ps ( eps ) formalism ( peacock & heavens 1990 ; bond et al .",
    "1991 ) , allows to overcome the cloud - in - cloud problem .",
    "the es formalism applied to a gaussian field provides a tool to compute , besides the unconditional mf , the conditional mf that can be used for generating halo merger trees ( bond et al .",
    "1991 ; lacey & cole 1993 ) . in this formalism , the result depends critically on the filter used to average the linear density fluctuation field at different mass scales .",
    "the mathematical solution is straightforward when a sharp @xmath2-space filter is adopted . for this filter",
    ", the ps result including the fudge factor of 2 is recovered . in the calculation of the merger trees ,",
    "the sharp @xmath2-space filter implies independent steps ( markovian random walks ) along the mass trajectory .",
    "note that the es formalism has a conceptual problem for predicting the halo mass in which a particular mass element ends up ( mo et al .",
    "2010 ,   7.2.2 ) , problem that may lead to an inaccurate buildup of mahs and mrs .",
    "with the advent of large cosmological n - body simulations , the whole non - linear process of dark matter gravitational evolution and collapse into virialized haloes could be followed , though with strong limitations due to mass resolution . do approaches based on the gaussian es formalism allow to describe correctly the results from the simulations ?",
    "in particular , _ do results from these approaches agree at the same time with the mf , mahs , and mrs of haloes as measured in simulations ? _    a non - negligible discrepancy between the mfs obtained in the es formalism and",
    "the n - body simulations has been early reported .",
    "the introduction in the es formalism of the elliptical gravitational collapse instead of the spherical one ( mass - dependent instead of constant @xmath1 , respectively ) helped to overcome this problem ( sheth , mo & tormen 2001 ) .",
    "however , in this case the es formalism does not provide an analytic formula for the conditional mf , and the merger trees based on the gaussian es formalism show deviations with respect to simulations in the progenitor mass distributions ( sheth & tormen 2002 ) , the mass contained within all the progenitors ( neistein et al .",
    "2006 ) , and the average main progenitor mahs and mrs ( wechsler et al . 2002 ; van den bosch 2002 ) .",
    "on the other hand , direct measures of the conditional mfs in n - body simulations show that they depart from the corresponding functions calculated with the es formalism for a gaussian field ( cole et al .",
    "2008 ; neistein et al .",
    "thus , a possible source of the discrepancies lies in the strict assumption of gaussianity in the es formalism .",
    "note that the question is not about primordial non - gaussianity ; the n - body simulations use indeed a gaussian density field that is evolved analytically ( e.g. , by means of the zeldovich approximation ) until the quasi - linear regime is reached .",
    "the point is that non - negligible deviations from gaussianity at the scales of interest have likely happen already during this regime ( coles & jones 1991 ) . here , we set aside gaussianity and the es formalism and handle the problem of the inventory of overdense regions in arbitrary random fields .",
    "we present an approach aimed to state the problem of the inventory of overdense regions in random ( gaussian or non - gaussian ) fields from a very general point of view .",
    "we assume that the density fluctuation field is fully characterized by its field conditional probability function . in order to face the problem of associating the halo mass to the overdensity in an alternative way to the es formalism ( see the reference mo et al .",
    "2010 cited above ) we proceed as follows . in our _ conditional formalism _ ( hereafer cf ) , we make use of the concept of _ isolated regions _ introduced by jedamzik ( 1995 ; see also yano , nagashima & gouda 1996 ; nagashima 2001 ) as a natural way to connect overdensities to virialized regions .",
    "we enunciate the _ isolated overdense regions inventory _ theorem , through which the given field conditional probability function of the random field is linked to the inventory of isolated overdense regions inside larger isolated regions of lower overdensity , being the former those that eventually collapse into virialized haloes if their overdensities equal to @xmath1 .",
    "the cf offers an alternative eps formulation .",
    "it gives an easy way to develop a monte carlo algorithm for calculating the mah and mr of the growing virialized haloes , because it supplies naturally the progenitor conditional probability function of finding a specific isolated region ( progenitor ) inside a given isolated region ( descendent ) .",
    "when the problem of finding isolated overdense regions inside larger ones is extended to the overall universe , then such conditional probability reduces to an unconditional probability , which gives the halo mf .",
    "nevertheless , if one starts from an unconditional probability function , for example on the basis of a halo mf obtained from n - body simulations , and tries to go back to the conditional probability function , in order to build merger trees compatible with the given mf , then multiple possibilities appear .",
    "the cf offers useful tools to make a choice . as we will discuss in ",
    " 4.2 , we decide to leave to the gaussian hypothesis even if , for simplicity , we retain the ( gaussian ) ps ansatz in a generalized version .",
    "the cf might be a powerful tool for economically describing _ in a consistent way the simulation results related to the mf , mahs , and mrs of the virialized haloes_. these descriptions can then be easily implemented in semi - analytical and semi - empirical models of galaxy evolution , and can be extended to masses and epochs , where the resolution is a limit for the simulations . on the other hand ,",
    "the cf may allow to explore economically cosmic structure formation in alternative cosmologies or in cases where the density fluctuation field is intrinsically non - gaussian .",
    "our approach could be applied also in other astrophysical problems , where random density fields are introduced , e.g. , the formation and evolution of dense gas structures in the interstellar medium as giant molecular clouds , massive clumps and cores ( hopkins 2012 ) .",
    "this paper is organized as follows .",
    "section 2 is devoted to present the cf ; in   2.1 , an equation for the isolated overdense regions inventory is derived , and in   2.2 the algorithms to build up the merger trees are introduced .",
    "section 3 deals with the particular case of gaussian random fields .",
    "the halo mf is derived in ",
    " 3.1 , while the mah and mr are calculated in ",
    "a discussion on the moving barrier effects is presented in ",
    " 3.3 . in view of the discrepancies obtained when using as input the gaussian statistics , in section 4 an heuristic approach , based on the use of the halo mf from simulations as input ,",
    "is presented . in ",
    " 4.1 we approach the problem of the difference on the mass estimates in the analytic method and in the simulations , and remark the necessity to introduce a mass rescaling , representative of a diffuse matter component , to connect the two standpoints . the results concerning mahs and mrs are presented in ",
    "our conclusions are given in section 5 .",
    "we adopt a flat @xmath3cdm cosmology with @xmath4 .",
    "the es formalism provides a means to derive the halo mf , accounting for the cloud - in - cloud problem , and to build up the halo mahs .",
    "however , as mentioned above , the gaussian es formalism seems to have difficulties for predicting at the same time the mf , mah , and mrs in agreement with numerical simulations . also , with the es formalisms it is not easy to deal with non - gaussian random fields ( inoue & nagashima 2002 ) , though some progress has been made recently by introducing a stochastic barrier and non - markovian corrections ( maggiore & riotto 2010 ) , by manipulating the step - size distribution of the random walks ( lam & sheth 2009 ) or by accounting for correlations between steps ( musso & paranjape 2012 ) .",
    "on the other hand , being the es formalism focussed on a generic mass element , the virialized halo mass is associated to a smoothing scale , which may lack of a real physical meaning . in order to overcome these shortcomings",
    ", we introduce below the conditional formalism ( cf ) inspired by the jedamzik ( 1995 ) approach .",
    "this formalism is based on a complete inventory of the isolated overdense regions of a random density field described by a _ cumulative field conditional probability function_.      let start with some key definitions .    _ isolated regions _ : an isolated region with overdensity @xmath5 is a connected region not included in a larger connected region with overdensity @xmath6 , while at the same time , outside of the totality of isolated regions with overdensity @xmath5 there does not exist any region with overdensity @xmath6 .",
    "hereafter we will refer to an isolated region with overdensity @xmath5 by means of the symbol @xmath7 .",
    ", one can cut an arbitrary region of such space along a specific border .",
    "the consequence will be that some @xmath8 will be internal , others will be external and finally some of them will be on the border of that region . by definition , when no one of the isolated regions @xmath8 will be on the border , such region will be named _",
    "suitable _ with respect to its internal isolated regions overdense by @xmath5 .",
    "it is straightforward to see that an isolated region @xmath7 is a _ suitable _ region with respect to all its internal isolated regions more overdense than @xmath5 .",
    "another example is given by an isolated region @xmath7 where one ( or more ) internal isolated region(s ) @xmath9 with @xmath10 has ( have ) been removed .",
    "the result is a _ suitable _ region @xmath11 with respect to its internal isolated regions @xmath12 , its overdensity is less than @xmath5 , and typically it will not be an isolated region .",
    "any region of @xmath11 more overdense than @xmath13 is contained inside an internal isolated region @xmath12 .",
    "afterwards when we will refer to a region @xmath11 actually we will refer to a region _",
    "suitable _ with respect to the internal isolated regions overdense by @xmath5 involved by the problem . ]",
    "_ virialized regions _ :",
    "a virialized region is an isolated region whose overdensity @xmath5 is equal to a critical value @xmath1 .",
    "@xmath14 : is the _ field conditional probability _ to find a region of mass @xmath15 with an overdensity between @xmath13 and @xmath16 , contained inside a larger region of mass @xmath17 and overdensity @xmath5 .",
    "@xmath18 : is the number of isolated regions , i.e. the _ conditional mf _ , with overdensity @xmath13 and mass between @xmath15 and @xmath19 , contained inside a larger region @xmath11 with overdensity @xmath5 and mass @xmath17 .    the _ cumulative field conditional probability _ to find a region of mass @xmath15 with overdensity @xmath20 inside a larger region of mass @xmath17 and overdensity @xmath5 is @xmath21    our cf concerns random fields that can be defined by such conditional probability .",
    "following , a theorem focussed on an _ isolated overdense regions inventory _ and aimed to establish a connection between the cumulative field conditional probability , @xmath22 , and the conditional mf , @xmath23 with @xmath24 , is presented .",
    "consider a region @xmath11 with overdensity @xmath5 and mass @xmath17 .",
    "define an arbitrary mass @xmath25 .",
    "a decomposition of the mass range @xmath26 into @xmath27 ordered steps , @xmath28 , identifies a sequence of @xmath29 isolated regions @xmath12 with overdensity @xmath13 and masses between @xmath30 and @xmath31 inside @xmath11 .    for any given @xmath32 ,",
    "the amount of mass in @xmath11 assembled by regions with mass @xmath33 and overdensity between @xmath34 and @xmath35 is @xmath36 this mass is also given by the sum of the regions of mass @xmath33 with overdensity between @xmath34 and @xmath35 located in each one of the isolated regions @xmath12 with masses between @xmath30 and @xmath31 , and overdensity @xmath13 of the above defined sequence : @xmath37 no other contribution exists because outside the totality of the isolated regions @xmath12 in @xmath11 there are not regions with overdensity @xmath38 . by equating the last two contributions , we can write @xmath39 from which we derive the following integral equation : @xmath40 by integration on @xmath34 between @xmath13 and @xmath41 , the previous equation writes in terms of the cumulative field conditional probability : @xmath42    an alternative formulation of eq .",
    "( [ fundeqa ] ) is obtained introducing the _ conditional probability _ @xmath43 of finding an isolated region of mass between @xmath15 and @xmath19 and overdensity @xmath13 inside a region @xmath11 .",
    "given a region @xmath11 with overdensity @xmath5 and mass @xmath17 , our interest is now to identify inside it an isolated region with overdensity @xmath13 .",
    "the quantity @xmath44 gives the amount of mass of @xmath11 assembled by isolated regions with overdensity @xmath13 and mass between @xmath45 and @xmath46 .",
    "therefore , the probability that an arbitrary mass element of @xmath11 is part of an isolated region with overdensity @xmath13 and mass between @xmath45 and @xmath46 is @xmath47 that is @xmath48    the previous statement is equivalent to say that @xmath49 is the probability to find an isolated region with overdensity @xmath13 and mass between @xmath45 and @xmath46 inside @xmath11 . introducing eq .",
    "( [ prob ] ) into eq .",
    "( [ fundeqa ] ) , we obtain @xmath50 which is basically a volterra integral equation .    the fundamental aspect of eq .",
    "( [ fundeqa ] ) is that for any given cumulative field conditional probability @xmath51 , it gives the conditional mf , @xmath23 .",
    "its main difference with the jedamzik ( 1995 ) result is that eq .",
    "( [ fundeqa ] ) is applied to any region @xmath11 with overdensity @xmath5 and mass @xmath17 and not only to the overall universe . for this reason",
    "the cumulative field conditional probability @xmath51 appears now on both sides of the equation .",
    "such property highlights the intrinsic meaning of the cf .",
    "it is interesting to remark that the previous _ isolated overdense regions inventory _ theorem solves automatically the cloud - in - cloud problem .",
    "( [ fundeqa ] ) represents the generalization of the ps formalism .",
    "such formalism may be recovered for the special random fields wherein @xmath52 with @xmath2 constant . in such case eq .",
    "( [ fundeqa ] ) writes @xmath53 the ps ansatz in terms of the conditional probability and including already the fudge factor of 2 , is obtained in the particular case of @xmath54 ( corresponding namely to gaussian fields , see below ) .    a random field for which eq .",
    "( [ anscon ] ) is satisfied is very simple to handle in terms of eq .",
    "( [ ans ] ) .",
    "note that not only gaussian fields obey eq .",
    "( [ anscon ] ) but also a variety of non - gaussian fields .",
    "therefore , in order to find an analytical formalism in agreement with simulations and to avoid the complex numerical integration of eq .",
    "( [ fundeqa ] ) , it is natural for us to look at first among random fields which satisfy eq .",
    "( [ anscon ] ) .",
    "this is the strategy followed in section 4 .",
    "a merger tree realization needs to identify progenitors of a given descendant .",
    "this is done by means of a monte carlo algorithm that uses the conditional probability and mf .",
    "the choice of a monte carlo algorithm is not unique and may hide subtle physical and technical questions ( for a review see zhang et .",
    "al . 2008 ) .",
    "the simplest criterion establishes that the monte carlo algorithm has to reproduce the conditional probability and mf predicted by the theory . however , this criterion is not sufficient , because the overall meaning of the involved probability , i.e. the stocahstic nature of the problem , has to be taken in to account .",
    "we will introduce a monte carlo algorithm optimized to build up a merger tree .",
    "afterwards we will check our algorithm with tests that involve the conditional probability and mf , as well as the mah and mr in order to verify also the agreement with the stochastic nature of the problem .    only in this section , to ease the reading of the formulae , we will indicate the variables of the extracted regions by a lower case letter .    integrating @xmath55 between @xmath56 and @xmath57 and identifying the obtained cumulative probability with",
    "a random number @xmath58 uniformly distributed in the interval [ @xmath56@xmath59 , we write @xmath60 which represents the basis for a monte carlo approach to build up merger trees .    given an isolated region @xmath61 with overdensity @xmath62 and mass @xmath63 , the extraction of the random number @xmath64 by eq .",
    "( [ mont ] ) allows to identify inside it a first isolated region @xmath65 of mass @xmath66 with a given overdensity @xmath13 . taking into account that the _ isolated overdense regions inventory _ theorem has been proved for general regions ( see footnote@xmath67 ) , after the identification of the isolated region @xmath65 , the extraction may continue on the complementary region @xmath68 with mass @xmath69 and volume @xmath70 obtained from @xmath61 removing @xmath65 from its inside . in terms of the density , from the volume relation",
    "we write @xmath71 being the region density @xmath72 , where @xmath73 is the background density and @xmath5 the overdensity , we have @xmath74 and finally @xmath75    at this point the extraction of the next isolated region can be carried out on the region @xmath68 with overdensity @xmath76 and mass @xmath77 . to perform such extraction , for simplicity ,",
    "we will use eq .",
    "( [ mont ] ) with a new random number @xmath78 , applied on the region @xmath68 . by proceeding in this way",
    "we implicitly assume that the same statistics of @xmath61 holds for @xmath68 , excluding any sort of correlation . for a discussion of possible correlations , see sheth & lemson ( 1999 ) .",
    "according to what has been said above , afterwards we will proceed to test the robustness of such hypothesis",
    ".    a recurrent algorithm may be particularly useful now . from the @xmath79 complementary region @xmath80 of mass @xmath81 with overdensity @xmath82 calculated by the previous method , using eq .",
    "( [ mont ] ) with a random number @xmath83 we can identify inside it an isolated region @xmath84 with mass @xmath85 and overdensity @xmath13 . at this point",
    "the next complementary region @xmath86 with mass @xmath87 will have the overdensity @xmath88 equations ( [ mcon ] ) and ( [ overev ] ) guarantee a mass conservation and make the procedure particularly handy because they do not make explicit reference to the previous i - steps .    equations ( [ mont][overev ] ) are particularly useful for constructing the halo merger trees .",
    "suppose a simple case when the isolated virialized regions are defined by a critical overdensity @xmath1 function of @xmath89 only .",
    "given a _ descendant _ at @xmath89 with overdensity @xmath90 , the _ progenitors _ at @xmath91 have overdensity @xmath92 .",
    "the finding of such progenitors ( branches ) is performed by applying the monte carlo extractions of eq .",
    "( [ mont ] ) to the ( complementary ) region described by eqs .",
    "( [ mcon ] ) and ( [ overev ] ) .",
    "this procedure identifies a sequence of progenitors at @xmath91 that can be sorted in order of decreasing mass .",
    "the largest ( primary ) progenitor identifies the main progenitor by which the _ mass aggregation history , _ mah , is obtained .",
    "the overall population of less massive progenitors fulfills the _ merger tree _ and allows to find the _ merger rate _",
    ", mr , along the mah .",
    "note that the condition @xmath93 implies @xmath94 .",
    "therefore , for the complementary regions , the progenitor extractions can be performed meanwhile @xmath95 .",
    "this means that the progenitors are extracted until all matter in the volume is exhausted , which implies that the entire mass contained in the descendant should come from virialized structures .",
    "however , the physics of halo mass assembly is more complex . a fraction of the mass can be present as diffuse matter .",
    "the strict limit @xmath96 implies lack of diffuse matter . in this paper",
    "we explore solutions with @xmath96 , however we will have in mind the physical consequences of such a hypothesis .",
    "the above described method has been extensively used in the case of gaussian cdm density fields for generating the initial conditions ( the mahs ) for the virialization process of dark haloes ( avila - reese , firmani & hernandez 1998 ) , and the subsequent formation and evolution of disc galaxies inside them ( firmani & avila - reese 2000,2009 ; avila - reese & firmani 2000 ) .",
    "the obtained halo properties agree with those found in cosmological numerical simulations ( avila - reese et al . 1999 ) .",
    "it is interesting to remark that the mass distribution of the first progenitor obtained with the monte carlo method can be compared with the conditional probability function , while the mass distribution of all the progenitors can be compared with the conditional mf .",
    "this offers a first test of our monte carlo algorithm by comparing its one - step results with the straight analytic formulae from the statistics ( in   3.2 we will show this point in some detail ) .",
    "it is important to highlight that the mean halo mah has to be a convergence solution of the monte carlo algorithm for the integration redshift step @xmath97 , otherwise it is physically meaningless . because of the stochastic nature of the problem , this property is dependent on the behavior of the given cumulative field conditional probability .",
    "we will focus on _ well behaved cumulative field conditional probabilities , such that guaranty @xmath97 convergence in the mah buildup_.",
    "in the case of a gaussian random field , the cumulative field conditional probability to find a region with mass @xmath15 and overdensity @xmath38 contained inside the region of mass @xmath17 with overdensity @xmath5 is given ( see bower 1991 ) by : @xmath98 where @xmath99 and @xmath100 is the mass variance calculated from the density fluctuation power spectrum of the random field . making the limit @xmath101 , eq .",
    "( [ gaussdist ] ) gives @xmath102 which is eq .",
    "( [ anscon ] ) with @xmath54 .",
    "( [ ans ] ) reduces to @xmath103 this is just the ps ansatz in terms of the conditional probability with the fudge factor of 2 included .",
    "introducing eq .",
    "( [ gaussdist ] ) into eq .",
    "( [ psans ] ) we obtain @xmath104 it is easy to verify that such conditional probability is normalized , i.e. , its integral in @xmath15 from @xmath56 to @xmath17 ( @xmath105 from @xmath56 to @xmath41 ) is 1 .",
    "( [ psgen ] ) is applied to a region of mass @xmath17 and overdensity @xmath5 .",
    "we can extend such region to the entire universe making @xmath106 , @xmath107 , and @xmath108 .",
    "hereafter , in such limit case of the entire universe , the superscript @xmath109 will be omitted .",
    "a recipe for the collapse criterion may be obtained from the top - hat spherical gravitational collapse , which establishes that an isolated region at redshift @xmath89 is virialized when its overdensity is equal to a critical value @xmath1 ( navarro frenk & white 1997 ) . for a flat cosmology with cosmological constant ( @xmath110 ) : @xmath111 where @xmath112 is the linear growth factor normalized to 1 at @xmath113 .    by defining the number density per mass unit @xmath114 definition that is not limited to gaussian fields , and introducing @xmath115",
    "we obtain the halo mf @xmath116 which coincides with the ps mf .    in fig .",
    "[ psmafun ] , the solid red curves show the gaussian - case ( ps ) halo mf obtained from eq .",
    "( [ ps ] ) at @xmath117 , while black solid curves are the accurate fitting formulae to cosmological n - body simulations provided by tinker et al .",
    "( 2008 ; hereafter tinker08 ) ; the parameters for the virial mass at the overdensity @xmath118 ( bryan & norman 1998 ) corresponding to our cosmology were used .",
    "the comparison reveals the well known excess ( deficit ) of intermediate ( high ) mass haloes predicted by the ps formalism .",
    "the tinker08 fitting curves are valid for halo masses above @xmath119 , which corresponds to the minimal mass at which haloes are reasonable resolved in the simulations studied by these authors ; this limitation makes uncertain the normalization of the overall mf .",
    "just in order to explore possibilities to approximate the ps mf to the simulations mf , @xmath1 has been rescaled by a factor @xmath120 to fit the high mass cut - off of the n - body ( tinker08 ) curves ( for similar earlier attempts see e.g. , carlberg & couchman 1989 ; klypin & rhee 1994 ) , and the normalization has been lowered by a factor @xmath121 to fit the maxima ( red dotted curves ) .",
    "note that the ps mf is normalized independently of @xmath1 , and that the dotted curves imply now a not normalized mf .",
    "it is evident that in spite of these mass - independent transformations of the ps mf , the comparison with simulation results continue failing .",
    "the exercise presented above is congruent with the one carried out in sheth & tormen ( 1999 ) , where they showed that besides these operations , the ps mf should be multiplied by a @xmath122 ( mass)-dependent factor in order to fit the numerical simulations analyzed by them .      for a gaussian field and the critical overdensity given by eq .",
    "( [ dlc ] ) , if @xmath123 , then @xmath124 , @xmath125 and @xmath126 . using eqs .",
    "( [ psans ] ) and ( [ gaussdist ] ) , eq .",
    "( [ mont ] ) writes as @xmath127 this operation is equivalent to make a random choice of a number @xmath105 with a normal deviate , zero mean and variance @xmath128 .",
    "hence , using eq .",
    "( [ gamma ] ) and making reference to ",
    " 2.2 , we obtain : @xmath129 where the symbols are the same as in ",
    " 2.2 , and @xmath130 is the ( rescaled critical ) overdensity of the descendant at redshift @xmath89 , while @xmath131 is the ( rescaled critical ) overdensity of a progenitor at redshift @xmath132 .",
    "the @xmath133 sequence defines the complementary regions of mass @xmath134 with overdensity @xmath135 , as well as the progenitors of mass @xmath30 with overdensity @xmath136 .",
    "equations ( [ mcon ] ) , ( [ overev ] ) and ( [ meq ] ) , togheter , define the monte carlo algorithm to build the merger tree of a virialized halo with a given mass at a given redshift .    in fig .",
    "[ psmafr ] , we plot the average of @xmath137 different mahs corresponding to a present - day halo of mass @xmath138 ( red solid line ; in this case , the critical overdensity is not rescaled ) . as in fig .",
    "[ psmafun ] , the red dotted line corresponds to the rescaling in the critical overdenstiy and the amplitude - reduction correction of the mf mentioned above .",
    "the dashed line represents the fit to the corresponding average mah measured in the millennium simulations ( fakhouri , ma & boylan - kolchin 2010 ) .    for present - day haloes of @xmath138 , fig .",
    "[ psmefr ] shows the mean mr histories _ per unit of redshift _ with merger ratios greater than @xmath139 ( @xmath140 and @xmath141 are the masses of the primary and secondary progenitors , respectively ) . from bottom to top , @xmath142 and @xmath143 ( green lines ) and @xmath144 , @xmath145 , and @xmath146 ( blue lines ) .",
    "the coding of solid and dotted lines is the same as in fig .",
    "[ psmafr ] .",
    "the average halo mrs as a function of the @xmath147 threshold at @xmath113 compare well with the results reported in fig .",
    "3a by fakhouri et al .",
    "the small change of these mean mrs with @xmath89 is also in general agreement with the numerical simulation results reported in fakhouri & ma ( 2008 ) and fakhouri et al .",
    "( 2010 ) .",
    "( red , left abscissa ) and the conditional mass function @xmath148 ( green , right abscissa ) per unitary progenitor mass natural logarithm as a function of the progenitor mass .",
    "the dots show the average distribution obtained by the monte carlo algorithm for the first progenitor ( bottom ) and for the entire progenitor collection ( top ) using eqs .",
    "( [ mcon ] ) and ( [ overev ] ) .",
    "the descendant mass is @xmath149 , the redshift @xmath113 while the redshift step @xmath150 ( upper panel ) and @xmath151 ( lower panel ) . ]",
    "( green ) per unitary progenitor mass natural logarithm as a function of the progenitor mass .",
    "the dots show the average distribution obtained by the monte carlo algorithm for the entire progenitor collection using eqs .",
    "( [ mcon ] ) and ( [ overev ] ) . in the upper panel",
    "the descendant masses are @xmath152 and @xmath153 , the redshift @xmath113 and the redshift step @xmath150 , while in the lower panel the descendant mass is @xmath149 , the redshift @xmath154 and the redshift step @xmath150 . ]",
    "the main conclusion from the exercise presented here is that for a gaussian density field ( ps ) , the predicted average halo mah and mrs agree reasonably well with the results from numerical simulations . and [ psmefr ] ) . in what follows ,",
    "unless otherwise stated , we will use the rescaled critical overdensity case .",
    "] however , the predicted halo mf , as it is well known , has an excess at intermediate masses and a deficit at high masses as compared to simulations at the mass range they are able to resolve ( e.g. , tinker08 ) .",
    "particularly interesting are the one - step results shown in fig .",
    "[ test1 ] for a descendant mass of @xmath149 at @xmath113 and redshift intervals of @xmath150 ( upper panel ) and @xmath151 ( lower panel ) , respectively .",
    "the red curve ( left abscissa ) shows the analytic conditional probability @xmath155 per unitary progenitor mass natural logarithm , while the green curve ( right abscissa ) shows the conditional mf @xmath148 per unitary progenitor mass natural logarithm as a function of the progenitor mass . here",
    "@xmath5 correspond to @xmath113 while @xmath13 to @xmath156 .",
    "the dots show an average distribution obtained with our monte carlo algorithm for the first progenitor ( bottom region ) and for the entire progenitor collection ( top region ) . the total number of extractions , not reported here because unnecessary ,",
    "is regulated in each case to reduce the scatter at reasonable levels .",
    "the marginal differences appearing in the graphics can arise from numerical effects , as well as from some departure from the hypothesis made in ",
    " 2.2 about the complementary regions . fig .",
    "[ test2 ] shows a similar test carried out for the masses @xmath152 and @xmath153 at @xmath113 ( upper panel ) and for @xmath149 but at @xmath154 ( lower panel ) , being in both cases @xmath150 .",
    "we conclude that the agreement between the analytic conditional probability and mf and the monte carlo results as well as the comparison of the mahs and mrs with simulations ( see above ) are fully satisfactory , and it indicates that our merger tree algorithm works properly . for our main calculations we will assume a redshift step close to @xmath157 , while for step invariance tests we will assume @xmath158 .      so far , we have used the spherical collapse critical overdensity ( eq . [ dlc ] ) , which is function of @xmath89 but not of mass ; this corresponds to a _",
    "fixed barrier _ in the es formalism .",
    "the adoption of a mass - dependent critical overdensity , i.e. a _ moving barrier , _ compatible with an ellipsoidal collapse , improves the agreement between the analytic and the numerical results regarding the halo ( unconditional ) mf ( sheth et al .",
    "2001 ; sheth & tormen 2002 ) .",
    "we extend now the test to the halo mah and mr .",
    "we assume the same gaussian random field as in section 3 described by eqs .",
    "( [ gaussdist])([psgen ] ) and eqs .",
    "( [ cmf])([ps ] ) , and adopt the moving barrier @xmath160 where @xmath161 , @xmath162 is a function that in sheth et al .",
    "( 2001 ) is @xmath163 , and @xmath164 , @xmath165 , and @xmath166 are free parameters .",
    "the cf can be used now to explore the effects of a mass - dependent critical overdensity on the mf , mah and mr , under the anstaz that the cumulative field conditional probability is the same as given in eq .",
    "( [ gaussdist ] ) . using eq .",
    "( [ ps ] ) with the parameter values given in sheth et al .",
    "( 2001 ) , @xmath167 , @xmath168 and @xmath169 , we recover almost the same halo mf proposed by sheth & tormen ( 1999 ) as a fit to numerical simulations , and justified in sheth et al .",
    "( 2001 ) as an indication of elliptical collapse ( fig .",
    "[ stmf ] ; note that both the obtained mf and the sheth & tormen one are close to the mf given in tinker08 ) .",
    "the excellent agreement shows that our ansatz is quite reasonable . within the framework of the es approach",
    ", recent work on random walks with correlated steps suggests that substituting @xmath170 into eq .",
    "( [ gamma ] ) could be indeed a good approximation ( c.f .",
    "paranjape , lam & sheth 2012 ; musso & sheth 2012 ) .    to find the mah and mr , we use eqs .",
    "( [ gaussdist])([psans ] ) with @xmath170 given by eq .",
    "( [ dlec ] ) . for @xmath171 ( @xmath172 ) , @xmath125 only if @xmath173 , while @xmath174 when @xmath175 and @xmath176 for @xmath177 .",
    "in these three cases , @xmath178 is @xmath179 , a value between @xmath56 and @xmath179 , and @xmath56 , respectively .",
    "( [ psans ] ) , eq .",
    "( [ mont ] ) now writes @xmath180 this equation does not have a solution when @xmath181 , while it does have a solution when @xmath173 for each value of @xmath182 , and for @xmath175 only if @xmath183 . within the framework of our approach ,",
    "we conclude that a mass - dependent critical overdensity , as the one inferred from the moving barrier analysis suggested in sheth et .",
    "al ( 2001 ) , does not offer a consistent description of the halo mah and mr , though , the limiting `` square - root '' moving barrier ( @xmath175 ) suggested by moreno et al .",
    "( 2008 ) in principle could offer a solution .",
    "the results obtained by the monte carlo method using the _ square - root _ moving barrier show that both the average halo mah and mr depart significantly from those found in the simulations .",
    "the mah is now too extended towards the past , revealing a low contribution of major mergers in the halo assembly .",
    "the major mrs ( @xmath184 ) are indeed rare with respect to the simulation results .",
    "we have explored the obtained effects varying the @xmath185 parameters without any interesting result .",
    "nonetheless , the most serious difficulty in our formalism when using a mass - dependent critical overdensity is that the convergence of the monte carlo algorithm , when redshift step @xmath97 , does not accomplish anymore .",
    "it is not surprising that some rough agreement with the results from simulations is obtained only when @xmath186 , owing to the `` correct '' behavior of @xmath105 as a function of the progenitor mass in this case ( see below ) .",
    "indeed , by using the large @xmath186 time step , moreno et al .",
    "( 2008 ) have showed that the moving barrier predictions agree with the simulation conditional probability .",
    "simple considerations help us to understand the failure of the mass - dependent critical overdensity in our scheme .",
    "figure [ gamplot ] allows to understand the reduction of the major merger rate . for a fixed barrier ( @xmath1 independent of mass ; dashed lines ) ,",
    "@xmath105 increases monotonically with mass and eq .",
    "( [ psgen ] ) leads to a conditional probability that makes possible the existence of low - mass progenitors . for the `` square - root '' moving barrier ( moreno et al .",
    "2008 ; solid lines ) , @xmath105 shows a decreasing shape on a very extended low - mass range of progenitors ; here the conditional probability eq .",
    "( [ psgen ] ) is physically meaningless and no low mass progenitors are possible . only in a small range immediately below the descendant mass , @xmath105 increases with mass , allowing at this range for a physical conditional probability , such that the progenitors are more massive than in the fixed barrier case .",
    "when @xmath187 the `` correct '' monotonic increasing of @xmath105 with the progenitor mass is recovered .",
    "furthermore , a necessary condition to obtain a redshift - step convergence is that @xmath125 when @xmath97 with @xmath188 .",
    "this tendency is not fulfilled for the moving barrier case .",
    "we conclude that , _ when using a mass - dependent critical overdensity ( moving barrier ) in our approach , the halo mf is correctly described but the predicted halo mah and mr fail in reproducing the simulation results . _",
    "an exhaustive analysis of this shortcoming and the reason behind it is deserved for a future work .",
    "in view of the difficulty of proposing a random fluctuation field described by an analytic cumulative field conditional probability function and being able to generate at the same time the halo mf , mah , and mr obtained in the numerical simulations , we turn on to an inductive ( semi - empirical ) approach : the probability function will be inferred numerically from the tinker08 halo mf , which was obtained from simulations .",
    "we split the problem into two parts .",
    "firstly , in  4.1 we extend the unconditional probability corresponding to the tinker08 mf ( defined only above @xmath189 ) down to small masses by an algebraic extrapolation , taking care that such an extrapolation does not imply a sharp change in the functionality ; furthermore , we introduce a mass rescaling in order to take into account any halo mass defect due to some diffuse matter ( see   2.2 ) .",
    "secondly , in  4.2 , based on the properties of eq .",
    "( [ fundeqa ] ) , we extend the definition of the unconditional probability to the conditional probability , and using it within the context of the cf , we calculate the halo mah and mrs .",
    "tinker08 provided an analytical fit to the halo mfs measured in numerical simulations at different redshifts and above a minimum ( resolution ) mass .",
    "we can calculate from these mfs the cumulative unconditional probability functions expressed in terms of the commonly used scaled variable @xmath122 or , what is the same , @xmath190 , where @xmath191 is the same as in eq .",
    "( [ gamma ] ) but applied to the entire universe , i.e. for @xmath192 ( @xmath193 ) and @xmath194 . due to the lower limit in mass in the tinker08 mfs , the cumulative unconditional probability should be constructed by integrating the mf from each mass @xmath195 at a given redshift , corresponding to the argument @xmath191 , to infinity .",
    "we define the following function : @xmath196 where @xmath197 , given by eq .",
    "( [ cmf ] ) , is the halo mf , and the mass @xmath198 is an intrinsic function of @xmath191 for a given @xmath89 .",
    "as long as the integral in eq .",
    "( [ tpro ] ) is correctly normalized , @xmath199 represents the cumulative probability to find an isolated region with overdensity @xmath90 ( collapsed region ) and mass @xmath200 ( or @xmath191 less than the value corresponding to @xmath195 for the given @xmath89 ) . when we apply eq .",
    "( [ psans ] ) to the gaussian ( ps ) case , we obtain @xmath201 .",
    "since in such case @xmath202 is function of @xmath191 only , the dependence of @xmath203 on @xmath89 vanishes ( @xmath204 depends on @xmath89 but through @xmath191 ) ; this is the well known fact that for a gaussian field , the halo multiplicity function is universal when expressed in terms of the scaled variable @xmath122 ( or @xmath191 ) .",
    "vs. @xmath191 ( eq . [ tpro ] ) for the tinker08 mf at @xmath117 ( solid black lines ) . in each panel",
    "the virial mass in the mf is rescaled by the factor shown by the label inside .",
    "the dashed black lines show a cubic extrapolation down to the origin for @xmath113 , fitting the low limit of the cumulative probability up to the second derivative .",
    "the ps case is displayed in each panel just for visual reference ( red dot dashed line , see text ) ]    by using the tinker08 halo mf in the first equality of eq .",
    "( [ tpro ] ) , the cumulative probability function @xmath199 can be obtained numerically .",
    "the result is shown in the top left panel of fig .",
    "[ cpf ] down to the limit mass at each epoch ( solid black lines for @xmath117 ) .",
    "the corresponding result for the gaussian ( ps ) case , with @xmath1 rescaled by a factor @xmath120 in order to fit the high - mass end of the tinker08 mf , is also plotted ( red dot - dashed curves ) .",
    "it is interesting to note that for the tinker08 mf , the dependence of @xmath205 on @xmath89 is negligible , which suggests that @xmath205 as inferred from the simulations deviates only slightly from a universal function . in",
    "what follows , we will consider that the function @xmath205 is the same at all redshifts , omitting the explicit argument @xmath89 .    in order to make @xmath205 physically meaningful as a cumulative probability , we need to know its entire profile , i.e. down to @xmath206 ( @xmath207 ) .",
    "then , we proceed first by smoothly extrapolating the tinker08 @xmath205 applying a cubic polynomial calculated with the conditions to be @xmath56 when @xmath208 , and fitting the low limit of the numerical curve up to the second derivative .",
    "the result is shown by the dashed black curve in the left upper panel of fig .",
    "the plot highlights the difference between the tinker08 and the ps cases in the @xmath205 shape when @xmath209 .",
    "while the latter reaches the origin following a straight line , the first one shows a curved shape .",
    "the physical reason of such difference can be due to the lack of normalization in the tinker08 mf ; such a lack of normalization can arise from the presence of diffuse matter in simulations unaccounted in the mf ( see below ) .    in the following , we discuss critical issues that appear when a confrontation between analytical approaches ( e.g. , es and cf ) and the n - body simulations is carried out .",
    "then , taking into account these issues , we propose an economical strategy that makes compatible for the cf the , the cumulative probability @xmath210 ) inferred from simulations and extrapolated to low masses .",
    "in the analytic formalisms , the linear overdense region of mass @xmath17 is linked to a collapsed halo of the same mass ( mass conservation ; see discussion in   2.2 ) , and the progenitor distributions at each redshift take into account _ all the available mass as part of collapsed halos_. the question is whether the simulations account for the mass in the same way .",
    "first , in the simulations the range of halo masses is limited ; there is no information below the halo mass resolution limit .",
    "if one extrapolates the fitted halo mf to lower masses and integrate the obtained multiplicity function from 0 to infinity , then one finds a deficit .",
    "this implies that the fitted mf should change its slope ( be steeper ) at smaller masses , and/or that some fraction of the mass is actually not in the virialized halos .",
    "the latter brings to consideration a second issue : in the simulations a non - negligible fraction of mass is indeed _ diffuse _",
    "( not in halos ) .",
    "the presence of diffuse matter is due to several reasons :    1 .",
    "a halo is counted only if it contains tens of particles ; groups with less particles are part of what is considered as diffuse matter .",
    "several authors have shown that a significant fraction of the gravitationally bounded particles are actually further away from the spherical virial radius ( e.g. , prada et al .",
    "2006 ; cuesta et al . 2008 ; lacerna & padilla 2011 ; anderhalden & diemand 2011 ) .",
    "it is not easy to determine the halo radius that contains all the bounded particles , and likely this radius presents a large variation from case to case , depending on environment , epoch , previous assembly history , mass , etc .",
    "let us call @xmath211 the average mass fraction of matter gravitationally bounded to halos but not accounted in the conventional spherical virial mass .",
    "3 .   due to true dynamical processes , e.g. ,",
    "when halos collide , some fraction of the particles are ejected from the merged system ( wang et al . 2011 ) ; let @xmath212 be the overall fraction of such ejected mass . + the diffuse mass produced by all of these effects may eventually infall on to the growing halos .",
    "therefore , at difference of the analytical formalisms , the mass growth of halos in simulations happens also in the form of diffuse accretion , which is expected to reduce the minor merger rates as compared to the analytical formalisms . in the current simulations , at least 30% of the @xmath113 halo masses came in diffuse accretion ( c.f .",
    "genel et al .",
    "2011 ; wang et al .",
    "it was suggested also a background of diffuse matter , remnant of the cut - off in the mass power spectrum due to the relativistic free - streaming damping ( e.g. , @xmath213  for the neutralino ) ; at very high redshifts , most of this matter due to the cut - off seems to be diffuse ( angulo & white 2010 ) , but at the redshifts of significant halo mass assembly , the effects mentioned above dominate over this .",
    "the diffuse matter in simulations implies that the mass originally linked to a given overdensity is less than that defined inside the spherical virial radius . due to these effects ,",
    "the conventional virial masses deplete on average by the fraction @xmath214 .",
    "now , considering the issues discussed above and that in the cf the diffuse matter is not taken into account , we need to make as compatible as possible the cumulative probability @xmath210 ) inferred from simulations with the one ( correctly normalized from 0 to infinity ) to be used in the cf . in the case of item ( ii ) above , the solution is simple : a mass rescaling allows us to recover the mass inside the collapsed halo proper of the analytical formalism . with this correction the analytic approach",
    "is justified .",
    "the ejected matter ( item iii ) may be considered a simple extension of this approximation .",
    "after several experiments , we find that an economical way is using a strategy based on the following ideas : @xmath164 ) a mass rescaling allows to pass from a model ( tinker08 ) @xmath205 to another @xmath215 , where the complications of the ejected matter and incorrect halo mass definition in simulations are avoided , in such a way that the masses are now roughly compatible with the ones of the analytic case and @xmath215 can be handled with the cf ; @xmath165 ) a good empirical criterion is to choose @xmath215 with a reduced curvature when extrapolated to low masses in agreement with the shape of @xmath216",
    ". finally the choice of the mass rescaling factor is justified by the result , i.e. the mahs and mrs being in agreement with simulations .    following this strategy",
    ", we explore now the effects of a simple constant mass rescaling of the tinker08 halo mf on @xmath215 .",
    "the panels of fig .",
    "[ cpf ] show the cases of virial mass rescaling by factors @xmath217 , and @xmath218 , respectively .",
    "it is noteworthy that for @xmath219 , the extrapolation of @xmath215 to low @xmath191 values is close to a straight line and , in general , this probability function approaches to @xmath216 .",
    "moreover , from the papers mentioned above , it can be said that an average halo mass correction by @xmath220 ( assumed to be mass independent ) is within the uncertainties .",
    "we conclude that this exercise , changing the shape of @xmath205 obtained from simulations so that it is closer to the shape of the analytic ( ps ) gaussian probability , implies a mass rescaling of @xmath221 , in rough agreement with measures of gravitationally bounded halo mass and diffuse matter considerations in simulations .",
    "we do not attempt to follow a more rigorous exercise , for instance introducing a mass dependence in @xmath162 , because of the large uncertainties involved in the simulation analysis , and because at this point we require only an indicative mass correction that encompasses all the complexity implied in passing from the linear overdensity to a virialized structure .",
    "the function @xmath205 given by eq .",
    "( [ tpro ] ) and obtained from the tinker08 halo mf is the cumulative unconditional probability to find an isolated region with overdensity @xmath1 and mass @xmath222 inside the entire universe , being in this case the _ cosmic _ @xmath223 .",
    "now , in order to apply the cf , we need to pass from such unconditional probability to a conditional probability . taking into account the generalized ps ansatz given by eq .",
    "( [ ans ] ) and according to the definition of @xmath105 in eq .",
    "( [ gamma ] ) , the simplest random field compatible with the previous reasoning is @xmath224 in this way , even if the statistics is not any more gaussian , eq . ( [ ans ] ) by construction is satisfied and the involved mathematics is simple . from fig .",
    "[ cpf ] one can see that our inferred p(@xmath105 ) from the tinker08 mfs is different from the one corresponding to a gaussian field ( see for a similar conclusion cole et al .",
    "2008 ; neistein et al .",
    "2010 ) .",
    "the probability @xmath225 to find an isolated region with overdensity @xmath13 and mass between @xmath15 and @xmath226 inside an isolated region with overdensity @xmath5 and mass @xmath17 , according to eqs .",
    "( [ psans ] ) and ( [ nongauss ] ) , is : @xmath227 we can apply now the monte carlo method to find the halo mah and mrs according to the procedure defined in ",
    " 2.2 .    for @xmath137 monte carlo realizations ,",
    "we calculate the average mahs and mrs by using the cumulative probability @xmath228 inferred from the tinker08 mf ( without any mass rescaling , i.e. @xmath229 ) .",
    "the left panels of fig .",
    "[ tmah ] show the average mah ( upper panel , solid line ) and mrs ( lower panel , the same five threshold ratios @xmath147 as in fig .",
    "[ psmefr ] ) .",
    "the corresponding average mah from the millennium simulations ( fakhouri et al .",
    "2010 ) is shown with the dashed line .",
    "the predicted mrs are higher at all epochs , but more at lower redshifts , than those measured in the simulations by fakhouri & ma ( 2008 ) and fakhouri et al .",
    "( 2010 ; thick ticks in the @xmath230 axis correspond to the @xmath113 mrs as reported by these authors ) .",
    "this produces also a too fast mass growth of haloes as seen in the upper panel . on the ground of these results",
    ", we conclude that the cumulative probability inferred from the original tinker08 halo mf leads to halo mahs and mrs in disagreement with those measured in numerical simulations .    in the right panels of fig .",
    "[ tmah ] we present the same as in the left panels but now for @xmath228 inferred from the tinker08 halo mf with the virial mass rescaled by the factors @xmath231 , @xmath232 , and @xmath233 ( see fig .",
    "[ cpf ] ) .",
    "the solid curves are for @xmath234 and the left / right ( upper / lower ) curves are for @xmath235 in the top ( bottom ) panel .",
    "the predicted average halo mah and mrs are now close to those measured in the simulations ( certainly within the scatter and uncertainties ) for the case @xmath234 .",
    "it is remarkable that the value @xmath234 is close to that one which provides a @xmath215 with a shape similar to the shape of @xmath216 according to the discussion in ",
    "these two findings are completely independent between them .",
    "besides , the value @xmath236 seems to be consistent with measures of the diffuse matter component in the simulations _ ( see for references   4.1 ) .",
    "note that the mah and mrs measured from the simulations could change if the virial mass is rescaled ; however , we do not expect significant changes because in the case of the mah and mr the physics has to do with _",
    "mass ratios_.    for completeness , we have applied the same procedure to the fitting mf given by sheth & tormen ( 1999 ) .",
    "we have obtained practically the same results as for the tinker08 mf , which for economy we do not repeat here .    summarizing , through a mass rescaling that makes compatible the masses between simulations and the analytic framework , we have derived from the halo tinker08 mf a conditional field probability function given by eq . ( [ nongauss ] )",
    "particularly handy in the sense that it is compatible with the ps ansatz ( eq . [ ans ] ) , in spite of it deviates from the one of a gaussian density fluctuation field . starting from such probability , our cf allows to calculate the halo mahs and mrs .",
    "the obtained average mahs and mrs are consistent with numerical simulations when the virial mass in the input tinker08 halo mf is rescaled .    for economy",
    ", we plotted results regarding the average mah and mrs only for one descendant mass , @xmath237 .",
    "the conclusions are similar for other masses .",
    "figure [ f - m ] shows the value of @xmath162 required to agree with the fakhouri et al .",
    "( 2010 ) average mahs at the redshift one - half ( solid line ) and one - tenth ( dashed line ) of the mass for @xmath113 descendants of @xmath238 and @xmath239 .",
    "as is seen , the mass rescaling factor is roughly the same for masses below @xmath240 , something in between 1.30 and 1.34 , in order to agree with the mahs down to one - tenth of the @xmath113 descendant mass . for larger masses ,",
    "this factor should be slightly larger .",
    "we conclude that , taking into account a mass rescaling of @xmath232 , the cf allows for a reasonable good description of the halo mfs , and the average mahs and mrs of halos @xmath241   obtained in numerical simulations .",
    "probably , a better tuning of this description can be attained by varying @xmath162 with mass , however , this task becomes difficult due to by subtle aspects , for example , the way the averaging is carried out when calculating the average mahs and mrs .",
    "we deserve such an exploration for future works .    the level of normalization on the tinker08 mf influences our result .",
    "suppose that @xmath242 is a correction factor on the mf .",
    "the model establishes that @xmath243 , that is a renormalization on the mf produces the same effect of a mass rescaling .",
    "if @xmath244 , no mass rescaling should be necessary at all . a defect in the mf normalization and a defect in the halo mass are related aspects of a same problem .",
    "if the diffuse matter plays the role that we argued in our reasonings above , then the tinker08 mf does not include all the dark matter in the cosmological boxes , and consequently it is not normalizable .",
    "tinker08 indeed acknowledge that this is the case .    , required to agree with the average mah from fakhouri et al .",
    "( 2010 ) at the redshift one - half ( solid line ) and one - tenth ( dashed line ) obtained for a wide range of present - day halo masses . ]",
    "we develop an approach able to connect the overdensities of the density fluctuation field with the abundance and assembly history of the virialized haloes . starting from a very general basis , our _ conditional formalism _ ( cf ) concerns the inventory of the isolated overdense regions given the field conditional probability function of the density fluctuation field .",
    "this formalism allows us to calculate at the same time and in a simple way : the halo mass function mf at any @xmath89 , the halo mass aggregation histories mahs , and the halo merger rate histories mrs .",
    "after that , our main goal is to identify a strategy that allows us to use the cf for describing optimally the numerical simulation results regarding these three halo statistical and evolutionary features . in the way of attaining this goal",
    ", we arrived to some important conclusions :    * for the gaussian density field ( the generalized ps ansatz , eq .",
    "( [ ans ] ) , applies ) , the predicted average halo mah and mrs agree roughly with those measured in current cosmological ( @xmath3cdm ) simulations , but the halo mf , as previously found , is overabundant at intermediate masses and deficient at high masses as compared to simulations , e.g. , with the tinker08 mf . *",
    "the introduction of @xmath1 depending on mass ( moving barrier ; sheth et al .",
    "2001 ) instead of the constant one , improves the halo mf as compared to simulations , but dramatically spoils the average mah and mrs . nonetheless , the major problem with the mass - dependent @xmath1 is the excessive sensitivity of the mah and mrs to the redshift step used in the monte carlo merger tree construction . * a cumulative field",
    "unconditional probability function can be inferred from the halo mf measured in simulations ( tinker08 ) , being this almost the same ( universal ) at different redshifts when expressed in terms of @xmath245 ; its definition has to be complemented by adequately extrapolating it to low masses .",
    "this inference is particularly suitable regarding the shape when the halo virial mass is rescaled by @xmath236 .",
    "remarkably , this rescaling makes the halo mass compatible with the mass used in the analytical formalisms having in mind that in simulations not all the mass is in halos . on the ground of the cf",
    ", the conditional probability function is obtained from the unconditional one by making the former compatible with the ps ansatz , in spite of that the shape of the latter deviates from the one corresponding to a gaussian statistics .",
    "such a situation allows us to easily use the cf and our monte carlo algorithm for calculating the halo mahs and mrs .",
    "the obtained average mahs and mrs depend critically on the mass rescaling factor .",
    "if this factor , assumed constant , is @xmath236 , then the agreement with the average mah and mrs in simulations becomes remarkable , at least for descendant halos up to @xmath240 .",
    "it is encouraging that the rescaling of the virial mass in the tinker08 halo mf by a factor @xmath236 allows both for a well behaved overall cumulative field unconditional probability function and for halo mahs and mrs in agreement with simulations .",
    "it is important to remark that the value of @xmath162 depends on the resolution limit of numerical simulations . *",
    "dark matter in simulations exhibits a rather complex structure .",
    "not all the mass is counted in the halos defined up to the conventional virial radius , but a diffuse component is present because of at least three reasons : a ) the mass resolution limit on halo identification , b ) the not counting of gravitationally bounded particles that are further away the virial radius , and c ) the mass ejection generated by mergers .",
    "the contribution a ) has to do with the low mass extension of the mf . due to b ) and c ) the mass accounted in the virialized halo is smaller than in the original overdense region , producing this a normalization defect in the mf .",
    "the disagreement between the simulation and analytic mfs seems to lie on these last two effects as well as on a departure from the gaussian distribution of the density fluctuations .",
    "the conditional probability function inferred from simulations with our approach and its use in the cf allow for an estimate of about @xmath246 for the diffuse mass fraction related to effects b ) and c ) , and show that the conditional probability corresponds to a density fluctuation field ( slightly ) deviated from gaussianity .",
    "in agreement with the previous argument , the tinker08 mf does not include all the dark matter present in the cosmological boxes and consequently it is not normalizable .    a consistent description of the cosmological simulations results regarding the halo mf , mahs , and mrs through an analytical (",
    "statistical ) formalism has been achieved .",
    "the interesting finding is that such a description could not be attained for a gaussian density fluctuation field , as well as without taking into account the complex distribution of dark matter in simulations . in this sense ,",
    "our results urge for a revision of two questions :    1 .",
    "_ the correct accounting in simulations of the mass in virialized halos and of diffuse matter .",
    "_ in the analytical formalisms there is an exact equality between the mass of a linear overdensity and that of the collapsed halo used for the counting in the mf , while in the numerical simulations this is not the case because of effects b ) and c ) above mentioned .",
    "therefore , when confronting the halo mf calculated in the analytical formalisms with that one measured in simulations , these issues should be taken into account .",
    "our approach is a first approximation to this complex problem .",
    "further exploration is necessary .",
    "2 .   _ the correct introduction of the statistics in analytical formalisms . _",
    "the hierarchical structure formation implies that in the same density field coexist collapsed structures at small scales with regions in the linear regime at large scales .",
    "then , even if the primordial statistics is gaussian , at the time the analytical approach is applied the density field at the scales of interest could already have deviated from gaussian initial conditions ( e.g. , coles & jones 1991 ) , as numerical simulations suggest .    in any case , the cf and the heuristic approach presented here , allow us to overcome some of the difficulties related to these questions , and attain a consistent description of the halo mf , mahs and mrs measured in cosmological numerical simulations .",
    "we thank the anonymous referee for his / her comments and suggestions which helped to improve this paper . c. f. is grateful to dr .",
    "flavio firmani from the university of victoria ( bc , ca ) for the encouraging support to carry out this work .",
    "v. a. acknowledges conacyt grant 167332-f for partial funding ."
  ],
  "abstract_text": [
    "<S> in order to attain a statistical description of the evolution of cosmic density fluctuations in agreement with results from the numerical simulations , we introduce a probability conditional formalism ( cf ) based on a complete inventory of isolated overdense regions in a density random field . </S>",
    "<S> this formalism is a useful tool for describing at the same time the mass function ( mf ) of virialized dark haloes , their mass aggregation histories ( mahs ) and merging rates ( mrs ) . </S>",
    "<S> the cf focuses on virialized regions in a self - consistent way rather than in mass elements , and it offers an economical description for a variety of random fields . within the framework of the cf , we confirm that , for a gaussian field , it is not possible to reproduce at the same time the mf , mah , and mr of haloes , both for a constant and moving barrier . </S>",
    "<S> then , we develop an inductive method for constraining the cumulative conditional probability from a given halo mf description , and thus , using the cf , we calculate the halo mahs and mrs . by applying this method to the mf measured in numerical simulations by tinker et al . , we find that a reasonable solution , justified by a mass conservation argument , is obtained if a rescaling increment by @xmath0 of the virial mass defined in simulations is introduced , and a ( slight ) deviation from gaussianity is taken into account . </S>",
    "<S> thus , both the mah and mr obtained by a monte carlo merger tree agree now with the predictions of numerical simulations . </S>",
    "<S> we discuss on the necessity of rescaling the virial mass in simulations when comparing with analytical approaches on the ground of the matter not accounted as part of the halos and the halo mass limit due to numerical resolutions in the simulations . </S>",
    "<S> our analysis supports the presence of a diffuse dark matter component that is not taken into account in the measured halo mfs inasmuch as it is not part of the collapsed structures .    </S>",
    "<S> [ firstpage ]    cosmology : dark matter  large - scale structure of universe  galaxies : haloes  galaxies : formation  methods : statistical  methods : analytical </S>"
  ]
}