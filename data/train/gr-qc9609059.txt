{
  "article_text": [
    "black holes are among the most fascinating predictions in the theory of general relativity .",
    "the black holes most likely to be observed by future gravitational wave observatories ( ligo and virgo  @xcite ) are those in highly dynamical evolutions , such as two colliding black holes .",
    "moreover , events which are important for observations ( i.e. , events that occur more frequently and emit stronger radiation ) are not expected to have a high degree of symmetry ; for example , the inspiraling coalescence is a more probable scenario than the axisymmetric head  on collision of two black holes .",
    "the most powerful tool in studying such highly dynamical and intrinsically non - linear events is numerical treatment .",
    "the essential characteristics of a black hole are its horizons , in particular , the apparent horizon ( ah ) and the event horizon ( eh ) .",
    "one needs to determine the location and the structure of the eh s in numerical studies to understand the properties of black holes , and indeed even to assert the existence of the holes .",
    "algorithms for doing this have recently been developed  @xcite .",
    "in contrast , the problem of determining the location of the ah in a general numerically constructed 3d spacetime has not yet been solved satisfactorily .",
    "the present paper represents a step in this direction .",
    "the apparent horizon is defined to be the outer - most marginally trapped surface  @xcite , a surface for which the divergence of the out - going null normal is zero ( c.f . , eq .",
    "( 1 ) below ) .",
    "the surface is defined locally in time , in contrast to the eh , which can only be identified after the numerical simulation is complete .",
    "the ah , as a characteristic of black holes , can be used _ during _ the numerical construction of the spacetime . as discussed in a number of publications , apparent horizons are useful not only for studying the dynamics of black hole spacetimes@xcite , but also for use as an inner boundary in numerical evolutions of black holes@xcite .",
    "the so - called apparent horizon boundary condition ( ahbc ) is currently being developed by many groups as a promising method for use in computing the long term evolution of 3d black hole systems .",
    "with ahbc one would like to be able to track the ah throughout the numerical evolution .",
    "for these reasons , it is important to develop efficient methods for locating apparent horizons in numerically constructed spacetimes",
    ".    there are many well developed methods for determining the location of ah s in lower dimensional spacetimes  @xcite , e.g. , in axisymmetry .",
    "the partial differential equation ( pde ) defining a marginally trapped surface ( eq . ( 1 ) below ) reduces to an ordinary differential equation ( ode ) in the axisymmetric case , and the symmetry conditions also provide boundary conditions for starting the integration of the ode .",
    "this simplifies tremendously the problem , and enables the construction of efficient methods for finding the ah .",
    "however , as these methods rely strongly on the symmetry assumptions , they are not generalizable to 3d ; going from 2d to 3d does not amount to simply adding one more spatial dimension . for the general 3d case , there is no symmetry and the ah surface to be determined is a _ closed _ surface ( hence no boundary conditions for starting the integration ) described by a non - linear elliptical pde . at present",
    "there are no efficient algorithms for solving such a partial differential problem in general .",
    "we are aware of three independent efforts in determining the ah in the general 3d case .",
    "the first method is based on an expansion of the ah surface in terms of spherical harmonics , with the expansion coefficients determined by an integral equation . the equation is then solved iteratively  @xcite .",
    "the second method attempts to solve directly the elliptic pde  @xcite .",
    "the third method  @xcite is based on expanding the closed surface in terms of orthogonal functions , in particular symmetric trace  free ( stf ) tensors , and using a minimization procedure to determine the expansion coefficients .",
    "variations on this idea were explored by brill and lindquist  @xcite and by eppley  @xcite .",
    "the essential difference of this method with the first method is in the way the expansion coefficients are determined , and the use of stf tensor expansions for 3d cartesian codes .",
    "the major advantage of this method is that the numerical solution of the minimization problem is much better understood than the corresponding pde problem . in ref .",
    "@xcite , we demonstrated that our method can be efficiently applied to testbeds made up of analytically given data sets representing time ",
    "symmetric slices of spacetime . in ref .",
    "@xcite , the convergence of the symmetric trace  free tensor expansion for similar testbeds is studied in detail . in this paper , we follow up on our earlier work and give a more detailed discussion of this method .",
    "we also push the application of it in two directions : ( 1 ) application of the method to arbitrary data sets which are not time  symmetric ( non  zero extrinsic curvature ) , and ( 2 ) application of the method to data obtained in actual numerical evolutions of dynamical spacetimes .",
    "the spacetimes we studied include schwarzschild and kerr black holes , black hole plus brill wave , and misner two black hole spacetimes in full 3d .",
    "we demonstrate that our method is in principle applicable to general 3 + 1 spacetimes .",
    "another method presently under development also uses a series expansion as in the present method , but it evolves the trial surface to the ah in an algorithm that combines elements of the ah finder of  @xcite and of a curvature flow method  @xcite .    in  [ sec : implement ] we discuss the formulation of our method , and the numerical algorithm in detail .",
    "section [ sec : testbeds ] gives the results of various testbed calculations , with ",
    "[ subsec : initial ] concentrating on initial data sets , and  [ subsec : evolved ] on spacetime evolutions .",
    "section [ sec : conclusion ] concludes with a discussion of where we stand in the construction of a general method for finding apparent horizons in 3d numerical relativity .",
    "defining @xmath0 to be the outward  pointing spacelike unit normal of a two  sphere @xmath1 embedded in a constant time slice @xmath2 with unit normal @xmath3 , we can construct the outgoing null normal to any point on @xmath1 as @xmath4 .",
    "the surface @xmath1 is called a _ marginally trapped surface _",
    "( mts ) if the divergence of the outgoing null vectors vanishes @xmath5 , or equivalently @xcite @xmath6 where @xmath7 is the expansion of the outgoing rays , @xmath8 the covariant derivative with respect to the 3metric @xmath9 , @xmath10 the extrinsic curvature of @xmath2 , and @xmath11 the trace of @xmath10 .",
    "the ah is defined as the outer ",
    "most trapped surface .",
    "first suppose we are searching for the ah of a single black hole in spherical coordinates .",
    "as the ah is topologically a 2sphere @xcite , its position can be represented as @xmath12 the unit normal @xmath13 @xmath14 can then be expressed in terms of the function @xmath15 . substituting ( [ capf ] ) and ( [ s ] ) into equation ( [ expansion ] )",
    ", one gets an elliptic equation for @xmath16 . instead of solving this elliptic equation directly , we proceed by expanding @xmath17 in terms of the usual spherical harmonics @xmath18 : @xmath19 equation ( [ expansion ] ) then gives @xmath7 in terms of the expansion coefficients @xmath20 .",
    "the ah can be determined by finding the set of coefficients @xmath20 which make @xmath21 .    for 3d codes in cartesian coordinates , instead of the spherical harmonic expansion ( [ exf ] )",
    ", we choose to expand the trial surfaces in terms of symmetric trace  free ( stf ) tensors : @xmath22 where @xmath23 are cartesian coordinates and @xmath24 the cartesian points interior to the @xmath25 surface representing the horizon center . in expanding the function @xmath17 in equation ( [ stf1 ] )",
    ", we have adopted the notation from reference @xcite .",
    "the stf tensors @xmath26 are coordinate independent coefficients , the subscript @xmath27 is abbreviated notation for the vector product @xmath28 , and the @xmath29 are unit directional vectors @xmath30    to determine the set of @xmath26 which makes ( 5 ) the ah , we use a minimization procedure . in general , the ah surface is the outer - most surface represented by the set of @xmath26 and @xmath24 which satisfy @xmath31 @xmath32 is semi  positive definite .",
    "@xmath33 is a positive definite weighting function which can be chosen to improve the accuracy of the minimization procedure depending on the construction of the trial surface . in this paper",
    "we do not investigate the use of this parameter and set @xmath34 . with this",
    "we have converted the elliptic condition ( 1 ) to a standard minimization problem .",
    "there are efficient minimization algorithms to search the space of ( @xmath35 ) coefficients for the surface closest to the apparent horizon among all test surfaces so parameterized .",
    "the strength of our method lies in that the minimization problem is much better understood than the numerical solution of the corresponding differential equation ( 1 ) .",
    "an obvious potential difficulty of this method is that there is no guarantee that the summation ( [ stf1 ] ) converges , or converges rapidly . for black holes not in highly dynamical situations",
    ", we do expect the ah surface to be smooth and one needs only the first few lower rank tensors to find the surface accurately ( as demonstrated in section [ sec : testbeds ] ) .",
    "this is usually the case through most of the simulations , and our method will be more efficient at these times . however , we also expect that , for the cases we would like to simulate , there are often periods of time when the black hole ( or holes ) goes through highly dynamical evolutions , e.g. , around the moment of the coalescence of two black holes . in such cases , one needs higher order stf expansions .",
    "although stf tensor expressions are available in the literature , we find it convenient to include in our code a routine for the automatic generation of stf tensors to an arbitrarily high order .",
    "the procedure takes advantage of the fact that we can associate the @xmath29 with essentially @xmath36 , @xmath37 or @xmath38 in three dimensions .",
    "we can therefore construct all symmetric and independent permutations of @xmath39 subject to the constraint @xmath40 , where @xmath41 is the rank of the corresponding symmetric tensor , or equivalently the order of the multipole expansion , and @xmath42 is the normalization factor making the rhs dimensionless .",
    "there are @xmath43 such independent combinations .",
    "the combinations constructed in this fashion can be supplemented with the @xmath44 independent conditions imposed on the symmetric permutations to make the rank @xmath41 tensor trace ",
    "free by contracting on any two indices .",
    "the function @xmath17 can be expanded as @xmath45 where @xmath46 are coordinate independent coefficients , and @xmath47 denotes stf combinations @xcite .",
    "partial derivatives @xmath48 and @xmath49 needed to evaluate @xmath7 on the trial surfaces are then easily computed from ( [ capf ] ) and ( [ multipole ] ) .",
    "the simplicity of the form ( [ multipole ] ) also allows one to easily construct the multipole expansion to take advantage of any symmetries present in the problem .",
    "for instance , our current implementation , by setting a flag , can invoke either the even or odd multipoles independently of the other , enforce axisymmetry , fix the surface centers @xmath24 , or allow the most general parametric expansion .",
    "the numerical problem is to find a set of parameters ( @xmath46 , @xmath24 ) that minimizes the lhs of ( [ the ] ) .",
    "minimization techniques ( such as conjugate gradient or quasi - newton methods ) that evaluate both the function and all its various partial derivatives are often preferred , as a means to increase the convergence rate , to those that do not require derivative information .",
    "however , because of the complexity of equation ( [ expansion ] ) , in this first generation 3d ah finder we have chosen to implement a multi  dimensional method that does not require knowledge of derivatives , namely a direction set or powell s method @xcite .",
    "the method is based on successive line minimizations , whereby the function @xmath50 is successively minimized along different vector directions using the one  dimensional brent s method with parabolic interpolation .",
    "we find powell s method to be generally robust , with a good convergence rate and computational speed , for surface functions parameterized by fewer than about fifteen or so parameters ( see section [ sec : testbeds ] ) .",
    "although solutions can still be found for parametrizations of higher order , the computational cost becomes overly excessive , especially when compared to the evolution cycle time .",
    "a two  grid system is utilized to evaluate the expansion function @xmath7 . the first grid ( which we refer to as grid @xmath51 )",
    "is the cartesian  based computational grid on which the einstein evolution and constraint equations are solved , and the metric and extrinsic curvature components are defined .",
    "a second grid @xmath52 is used to evaluate the surface function @xmath53 .",
    "this second grid need not be structured in the same way as the first .    assuming a guess position for the horizon center @xmath54 on the structured cartesian grid @xmath51 , and some prescription for distributing points throughout this mesh to construct nodes for the second grid @xmath52",
    ", we can evaluate the expansion @xmath7 on the nodes of grid @xmath52 once @xmath16 is determined .",
    "here we choose to distribute the nodes uniformly over a sphere , centered on @xmath24 : the nodes are evenly spaced in both the polar and azimuthal angles to cover the full sphere @xmath55 and @xmath56 ( or a single octant for the axi and equatorial symmetric spacetimes ) . however , this procedure can easily be generalized to , for example , weight the node distribution according to the coordinate surface curvature , as might be desirable for highly distorted horizons . along the radial direction ,",
    "the nodes of grid @xmath52 are placed uniformly with an inter ",
    "node spacing @xmath57 typically equal to the cell resolution of grid @xmath51 on which the einstein equations are solved .",
    "we have also implemented a procedure to constrain the range of radii over which the solver searches for the ah , as might be desirable in cases where multiple trapped surfaces exist in the data set . in these cases ,",
    "the radial grid spacing is set by @xmath58 , where @xmath59 is the number of radial nodes , and @xmath60 and @xmath61 are the lower and upper bounds of allowable radii . representing the number of nodes on grid @xmath52 as @xmath62",
    ", we set @xmath63 along the angular directions in a single octant , and @xmath64 along the radial direction , where @xmath65 is the minimum number of cells among the three orthogonal axes in grid @xmath51 .    once the spherical grid @xmath52 is constructed and centered on @xmath24 , the function @xmath66 in equation ( [ capf ] ) is evaluated on the nodes of grid @xmath52 for a fixed set of coefficients ( @xmath67 ) that the powell routines compute . along each radial line",
    ", a search is made for @xmath25 , by scanning from large to small radii , until the condition @xmath68 is met , and then linearly interpolating between adjacent neighbors to find the approximate cartesian coordinates of the surface corresponding to @xmath25 .",
    "the extrinsic curvature and the metric functions and their derivatives are then evaluated at these positions by interpolating ( either linearly or quadratically ) from the computational grid @xmath51 on which they are defined and used in equation ( [ expansion ] ) to evaluate @xmath32 on the surface .",
    "the process of constructing a spherical grid @xmath52 centered on @xmath24 , evaluating @xmath66 on grid @xmath52 , searching for the surface coordinates for which @xmath25 , interpolating the geometric data to the surface , and evaluating the expansion ( [ expansion ] ) on the surface is repeated through powell s procedure until a minimum of @xmath69 in the parameter space ( @xmath67 ) is realized .    to reduce the computational time spent in finding apparent horizons and to make the finder usable in real time evolutions of black hole spacetimes ,",
    "it is important to implement the solver in a parallel fashion .",
    "fortunately , the calculations performed at each node on the trial 2d surfaces are independent of the other node calculations . a natural parallel implementation , which we have adopted ,",
    "thus distributes the different surface calculations to different computational processors , achieving a speedup of @xmath70 compared to a purely scalar code .",
    "in addition , a large percentage of the cpu time is spent interpolating the field variables from grid @xmath51 onto the 2d surface . to speedup this bottleneck procedure ,",
    "we have written and implemented generalized algorithms designed to interpolate ( both linearly and quadratically ) 3d data onto different nodes within a 2d surface in parallel .",
    "the computationally intensive elements of the horizon finder have been optimized for both the cray c90 and the massively parallel thinking machines cm5 computers .",
    "in order to test the basic solver described above , we have developed both 2d and 3d ah finders based on this minimization method .    for the 2d finder ,",
    "the ah determined can be directly compared to those obtained with the standard integration method . as testbeds , we used data obtained from a code developed by bernstein _ et al._@xcite .",
    "this code evolves a black hole distorted by an axisymmetric distribution of gravitational waves ( brill waves)@xcite . the black holes can be highly distorted by the incoming waves , leading to ah s with extremely prolate or oblate geometric shapes . in some cases",
    "the ratio of polar to equatorial circumference can exceed @xmath71 . when these systems are evolved , the horizons undergo dynamic oscillations , eventually settling down to a schwarzschild black hole at late times @xcite . for such dynamic spacetimes ,",
    "we compared the results obtained with our new ah finder algorithm with those from the ah finder constructed using the standard ode method @xcite . for test surfaces with 16 coefficients , and using spherical harmonics @xmath72 as basis functions , we find that both methods produce the same results to within the given accuracy of the pde solvers .    as this paper is on a 3d implementation of these ideas for finding ah s , in the following we concentrate on results for the 3d case only .",
    "we have written a fortran routine that implements the above method for a general 3d spacetime in cartesian coordinates , and tested it on various spacetimes of interest .",
    "we discuss results from this code applied to various initial data sets containing one or more black holes (  [ subsec : initial ] ) , and to evolutions of some of these black hole spacetimes carried out with our 3d `` g '' code @xcite (  [ subsec : evolved ] ) .",
    "for all the 3d tests , we use the symmetric trace  free ( stf ) tensors as basis functions defined on a unit sphere .",
    "the simplest , most basic , test for any apparent horizon finder is the static schwarzschild initial data . the 3-metric can be written in cartesian coordinates as @xmath73 where @xmath74 is the mass of the black hole .",
    "the apparent horizon in this case is spherically symmetric and located at @xmath75 .",
    "although only the @xmath76 term should contribute to the surface that defines the apparent horizon , we tested the solver with a more general multipole expansion with the @xmath77 terms up to and including @xmath78 , a total of 28 coefficients .",
    "the computed surface is plotted in fig .",
    "[ fig : sch_init ] for four separate cases with various black hole masses .",
    "the grid resolution used in each case was @xmath79 , using @xmath80 cells .",
    "as expected , the surface is mostly defined by the @xmath81 contribution : the other higher order terms are small in comparison , roughly a factor of @xmath82 smaller .",
    "we find typical errors in the horizon radius of order 0.04% , and the numerical surfaces are indistinguishable from the analytic solution in fig .",
    "[ fig : sch_init ] . in each of the cases shown here , the finder converged to the correct surface in approximately 30 iterations .",
    "however , the number of iterations decreases significantly if fewer parameters are varied .",
    "for example , only 3 iterations are needed to converge if only the monopole term is varied , reducing the computational time by a factor of 60 . on average ,",
    "the cpu time scales approximately as @xmath83 , where @xmath83 is the number of parameters .",
    "hence , the method becomes rather cumbersome for highly distorted horizons which can only be described with a high order multipole expansion .",
    "we discuss this important issue further in the following more elaborate tests .",
    "the misner initial data set represents two equal mass black holes initially at rest , and is defined by the 3metric @xmath84 where @xmath85 and @xmath86 ^ 2}.\\ ] ] the parameter @xmath87 specifies the proper separation between the two holes and the total adm mass of the spacetime .",
    "apparent horizons in these data sets may consist of either a single surface surrounding both black holes if they are sufficiently close to one another ( @xmath88 ) @xcite , or two separate horizons located at the throats of the holes .",
    "in the cases where the two holes form a single encompassing horizon , the surface can be distorted significantly . to find the distorted horizons accurately , then , we need to keep higher order multipole terms , but _ a priori _ it is not clear how many terms will be required . in fig .",
    "[ fig : mis_init ] , we show the results of systematically increasing the number of axisymmetric expansion terms for the case @xmath89 . in each calculation",
    "we use a @xmath90 grid with @xmath91 and run the code on the 128 node partition of the cm5 .",
    "we also show the result obtained with our 2d , axisymmetric code described in ref.@xcite , which implements an independent ode integration method  @xcite .",
    "it is obvious that a high order expansion , up to @xmath78 , is required to accurately describe this surface which has a major to minor axis ratio of 1.5 .",
    "we expect that even higher multipole expansions would be required for more distorted surfaces . in table",
    "[ tab : misner ] , we show the number of iterations , cpu time and @xmath69 as a measure of convergence for each of the expansion orders . we note that timings reported here and throughout this paper refer to the thinking machines cm5 .    for @xmath92",
    ", there are two separate and spherical trapped surfaces on the initial slice , centered off the origin at @xmath93 . in the cases we have tested ( @xmath94 2.0 and 2.2 ) , the solver is able to locate both the center and radius of the offset horizons to an accuracy of better than 0.06% using general expansions to any order , @xmath76 to @xmath78 .",
    "we note that the iteration count ( and hence cpu time ) can increase by factors of between 2 to 10 , depending on the total number of parameters , as compared to the cases in which the throat center coordinates are not allowed to vary .",
    "the misner initial data family just discussed provides examples of both single perturbed horizons and two separate but spherical surfaces with offset centers for testing .",
    "however , black hole horizons in highly dynamic spacetimes can be extremely distorted geometrically , and the horizon finder must be able to locate these as well .",
    "the black hole plus brill wave initial data set is yet another solution that has been studied extensively in axisymmetry , and thus provides a useful testbed for highly distorted holes in three dimensions .",
    "this data describes the superposition of a black hole and a `` doughnut '' shaped brill wave surrounding the hole . in",
    "spherical coordinates , the 3-metric takes the form @xmath95 where @xmath96 and @xmath97 are functions of @xmath98 and @xmath99 only .",
    "the function @xmath96 is specified analytically as free data , and the hamiltonian constraint is solved for the conformal factor @xmath97 .",
    "the initial extrinsic curvature vanishes due to time symmetry .",
    "this data set has been studied with 2d , axisymmetric codes@xcite using a logarithmic radial coordinate @xmath100 , where @xmath101 is a scale parameter . in this coordinate system ( @xmath102 , @xmath99 , @xmath103 ) , the form of the @xmath96-function",
    "is written as @xmath104 where we set @xmath105 , and @xmath106 + \\exp \\left [ - \\left(\\frac{\\eta-\\eta_0}{\\sigma}\\right)^2 \\right].\\ ] ] we solve the hamiltonian constraint for the conformal factor in our 2d code and then interpolate these solutions onto a @xmath90 cartesian grid with @xmath107 to generate 3d data sets .",
    "the 3d horizon finder is tested against an independent solver developed for 2d calculations  @xcite .    in fig .",
    "[ fig : dist_init ] we show the coordinate location of the apparent horizon for various parameters of the @xmath96-function .",
    "the sequence shown corresponds to different values of the brill wave amplitude @xmath108 , for fixed `` shape '' parameters having the values @xmath109 .",
    "results from both the 2d and 3d calculations are shown . in the 3d case , we allowed searches up through @xmath110 , but for this case we include only the axisymmetric terms . in all cases shown ,",
    "the finder was able to locate the correct surface to within a third of a grid zone in just 6 iterations .",
    "[ fig : dist_conv ] is a resolution convergence study of the case @xmath111 in which the cell size is varied from @xmath112 0.6 , 0.3 and 0.15 with @xmath113 , @xmath114 and @xmath90 grids respectively .",
    "the solver clearly converges to the correct surface quadratically with cell size .    for negative values of the brill wave amplitude parameter @xmath108 ,",
    "the horizon is found off the throat , but for positive values below certain limits ( depending on the shape parameters ) the horizon is located on the throat at @xmath115 .",
    "we are also able to locate the ah at the same level of accuracy for these cases .",
    "although the surfaces shown in fig .  [ fig : dist_init ] appear to be almost spherical in coordinate space , the presence of strong gravitational waves can severely distort the horizons geometrically , much more so than the misner data solutions described above . in fig .",
    "[ fig : embed1 ] we show the ( axisymmetric ) geometric embedding of the two cases @xmath116 , using the method described in ref .",
    "for all negative values of the amplitude parameter , the horizon is oblate .",
    "the @xmath117 case is highly distorted geometrically into a prolate shape , with a ratio of polar to equatorial circumference of @xmath118 .",
    "the calculations presented so far have tested the ability of the solver to find single or multiple horizons of spherical and highly distorted black holes in 3d cartesian coordinates",
    ". however , the data in all these cases are time symmetric .",
    "the kerr initial data set describing a rotating black hole has nontrivial extrinsic curvature , and thus provides another important testbed with a known analytic solution .",
    "the 3-metric for this spacetime in boyer - lindquist coordinates is given by @xmath119 where @xmath120 in these coordinates , the non - vanishing components of the extrinsic curvature are @xmath121 \\sin^2 \\theta/\\left(r \\rho^4\\right ) , \\\\ \\hat{k}_{\\theta\\phi } & = & -2 a^3 m r \\sqrt{\\delta } \\cos\\theta \\sin^3\\theta \\rho^{-4 } , \\end{aligned}\\ ] ] where @xmath122 , and @xmath123    to construct this data in 3d , we first transform to an isotropic radial coordinate through the transformation @xmath124 as described in  @xcite . in this coordinate system ,",
    "the coordinate singularities at @xmath125 disappear .",
    "we then convert the metric and extrinsic curvature from isotropic coordinates to cartesian coordinates .",
    "the apparent horizon for the kerr data is a coordinate sphere , located at @xmath126    in table  [ tab : kerr_init ] we show results from runs with various values of the rotation parameter @xmath127 and expansion order @xmath128 .",
    "these runs were all done with general expansions , without restricting to axisymmetry . for the tests performed here , @xmath129 , @xmath130 and @xmath131",
    "were chosen to be approximately one tenth of the analytic ah radius , and the number of cells ( @xmath114 ) was kept the same in all cases . only the @xmath81 contributions are shown . as expected , the contributions from higher-@xmath41 terms are small , ranging from @xmath132 for @xmath133 to @xmath134 for @xmath135 . the reason that these terms , in the highly rotating cases , are not as small as in the schwarzschild case is because the metric is not conformally flat , so the interpolations within the finder are not as accurate .",
    "although we do not display embeddings of these horizons , we note that rotating black hole horizons can be extremely oblate , and for rotation parameters @xmath136 a global embedding into euclidean space is not possible .",
    "the horizon finder has no difficulty in locating these surfaces to within a grid zone , although we note , again , the high computational cost for large order multipole expansions as indicated by the @xmath137 sequence of calculations .      the above test cases , although treated in full 3d , have all been axisymmetric . in this section we test our finder on data which does not have any particular symmetry , and for which we can derive the correct solution in order to gauge the accuracy of the solver . to this end",
    ", we chose to find the apparent horizon on a schwarzschild initial slice using a coordinate system in which the horizon surface does not appear to be axisymmetric .",
    "the coordinate transformation we use is @xmath138 where @xmath98 is the radial isotropic coordinate of ( 10 ) .",
    "this @xmath139 has surface modes of @xmath140 .",
    "the apparent horizon location is then defined by @xmath141 .",
    "the solver was allowed to search coefficients with terms up to @xmath142 and @xmath143 . in all cases for the @xmath142 tests ,",
    "the finder successfully found the horizon to high accuracy .",
    "each non - zero coefficient was accurate to better than a tenth of one percent , and the largest value found for a coefficient that was supposed to be zero was less than 2% of the smallest non - zero component .",
    "we note that better accuracy can be achieved if one uses full knowledge of the analytic form of the metric .",
    "when the finder was generalized to allow searches with coefficients up to @xmath143 , the horizon was again successfully found and to comparable accuracy .",
    "however with the large number of search parameters , some care was necessary in choosing the initial search direction of the powell routine in order to avoid getting trapped at local minima in @xmath32 generated in the discretized representation of the spacetime .",
    "when the resolution of spacetime grid is increased , such local minima will diappear / change in location , in sharp contrast to the actual @xmath144 point ( the actual location of the ah , which converges to a fixed location with increased resolution . ) in fig .",
    "[ fig : trnsch_init ] , we show the apparent horizon found and the analytic solution in one quadrant of each of the coordinate planes .",
    "the numerical results shown in this figure were obtained with a run in which coefficients up to @xmath143 were allowed to vary .",
    "the tests described thus far have shown that the horizon finder can locate horizons in a variety of distorted black hole spacetimes , but these have all been initial data sets with a somewhat restricted 3metric and extrinsic curvature , and with a large part of the data prescribed analytically . in general 3d",
    "black hole evolutions , all metric and curvature components will be present , and the data will be contaminated with numerical inaccuracies generated during the course of evolution .",
    "the horizon finder must work under these conditions for it to be a useful tool in the numerical construction of spacetimes .",
    "in this section , we discuss results derived from the implementation of the horizon solver into our 3d `` g '' code @xcite that solves the einstein evolution equations in cartesian coordinates .",
    "the tests discussed here were carried out using multipole expansions up to and including the @xmath143 terms . however , in order to save computational time , we restricted the search to axisymmetric surfaces .",
    "we have verified that a more general expansion does not change the results significantly .",
    "the results for a 3d schwarzschild spacetime , evolved with both geodesic and maximal slicings with zero shift , are shown in figs .",
    "[ fig : sch_ev_geo ] and [ fig : sch_ev_max ] respectively . a @xmath90 ( @xmath145 ) grid with @xmath146 0.15 ( 0.2 ) was used for the geodesic ( maximal ) case with @xmath147 . only the @xmath81 contribution to the surface",
    "is plotted .",
    "the other parameters remain small ( @xmath148 ) during the entire evolutions , as expected . in both cases ,",
    "the surface locations are compared against the corresponding results from 1d calculations .",
    "the two results agree to a small fraction of a grid zone throughout the evolution .",
    "the late time deviation in the maximal run is attributed to errors in the 3d spacetime evolution , which becomes inaccurate for @xmath149 , although we note that the difference at the end of the run is still only about a grid zone .    in both the geodesic and maximal cases ,",
    "the ah finder accounted for a large portion of the total cpu time . for the geodesic case the code ran 160 timesteps , invoking the finder once every @xmath150 in time ( 11 times total ) . in this case , the finder constituted approximately 90% of the cpu time .",
    "for the maximal slicing case the code was run for 1100 timesteps , calling the finder every @xmath151 ( 14 times total ) . in this case , 40% of the cpu time was spent in finding the horizon .",
    "the horizon finder with a @xmath143 axisymmetric multipole expansion is thus approximately 50100 times slower than a single update cycle in the hyperbolic evolution ( although we note that when the elliptic maximal slicing equation is solved , the relative performance in the solver improves significantly ) .",
    "a factor of roughly 10 can be gained by reducing the expansion order to @xmath76 .",
    "a more difficult evolution scenario is to capture the horizon surfaces as two black holes collide and merge .",
    "our `` g '' code is used to evolve the two black hole misner data set , described in  [ sec : misnerinit ] , for a time sufficiently long that we can test the ah finder on this dynamic spacetime .    to evolve the initial data",
    ", we use a zero shift vector and an algebraic lapse of the form @xmath152 where @xmath153 is the conformal 3metric determinant and @xmath154 is the lapse on the initial time slice , which we take to be the cadez @xcite lapse @xmath155 . \\label{cadezlapse}\\ ] ] the solution ( [ cadezlapse ] ) solves the maximal equation in time symmetry with @xmath156 as a boundary condition on the throats .",
    "algebraic lapses of the form ( [ alglapse ] ) are singularity avoiding and produce evolutions similar to maximally sliced spacetimes @xcite .",
    "the calculation is run on a @xmath90 grid with @xmath91 for a time of @xmath157 using an expansion to order @xmath143 .",
    "as our interest is in testing the ability of the solver to locate the ah before and after the surface merger event , it suffices to evolve a data set with a low value for the misner parameter , which is computationally less expensive in evolution .",
    "here we show results for the @xmath158 case which has , as initial data , two coalesced black holes with a common event horizon , but two _ distinct _ trapped surfaces at the two throats . a common apparent horizon encircling both throats forms at time @xmath159 .",
    "figure [ fig : misner_ev ] plots the surfaces found at each time the finder is called ( @xmath160 0 , 2.5 , 5 , 7.5 and 10@xmath74 , where @xmath74 is the adm mass , and with the surfaces increasing in radius at the later times ) . at @xmath161 ,",
    "the solver correctly finds the throat as the surface , centered off the origin .",
    "the finder can subsequently be prevented from locking onto the throat ( which remains a trapped surface throughout the evolution ) by restricting the range of radii over which the function @xmath162 is evaluated , and by resetting the center of the surface .",
    "unfortunately , there is no analytic result to compare against the computed location of the ah at the later times .",
    "instead , we overlay the 3d computed ah surfaces with the results from our 2d axisymmetric code evolving the same initial data .",
    "the surfaces determined with these two different methods ( 3d minimization vs. ode integration ) applied to the two different constructions of the spacetime ( 3d cartesian evolution vs. 2d axisymmetric evolution ) basically agree with one another . nevertheless , we note that in the figure the two sets of surfaces are not exactly the same in coordinate space , as they should _ not _ be , since we are using different lapse and shift functions in the two cases .",
    "however , the shift vector is of magnitude @xmath163 in the region of the ah , so we do not expect this effect to exceed the grid spacing scale over the time interval of the calculation . also , the algebraic lapse used in the 3d code is typically larger than the maximal slicing lapse in the 2d code by a fractional difference @xmath164 near the ah .",
    "this should also have a small effect on the coordinate position of the ah except at late times .",
    "in fact , the maximum differences in the ah location between the 2d and 3d calculations is only slightly more than a grid cell .",
    "the differences may also be attributed to inaccuracies in the evolution ; as born out in computing the mass of the ah at different times . at @xmath165 , after a common surface forms to surround both throats , we find @xmath166 , compared to the 2d result of 2.36 . however , by @xmath157 , the error in the mass of the computed surface increases to roughly @xmath167 as the evolution becomes less accurate .",
    "these errors are attributable to numerical inaccuracies in the evolution and not the ah finder routine , in particular , they are unrelated to the multipole order used , since the surface becomes more spherical in time .",
    "one final test of the solver in real time evolutions is a schwarzschild black hole plus a brill wave .",
    "the initial data is the same as that discussed in ",
    "[ sec : dbhinit ] with shape parameters ( @xmath168 , @xmath169 , @xmath170 ) = ( 0 , 1 , 2 ) , scale parameter @xmath171 and amplitude @xmath172 . for this set of parameters ,",
    "the adm mass of the spacetime is @xmath173 .",
    "the hamiltonian constraint is solved for the conformal factor in our 2d axisymmetric code , then interpolated onto a @xmath174 cartesian grid with @xmath175 .",
    "the data is evolved with a timestep @xmath176 , calling the horizon finder once every @xmath177 intervals of time .",
    "the shift vector is set to zero and the lapse function is computed from the maximal slicing condition .",
    "figure [ fig : ev_brill_surf ] shows the horizon shapes and locations in the 3d calculation at various times with intervals of @xmath178 , starting at @xmath161 .",
    "the multipole order used in this calculation is @xmath143 , with @xmath179 to reduce the computational time .",
    "the higher order expansion is needed here to describe the oblate shape of the horizons .",
    "for the most part , the solver required only about five iterations to converge when the previous solution is given as the initial guess to the finder . also shown in fig .",
    "[ fig : ev_brill_surf ] are the corresponding surfaces found in our 2d axisymmetric code .",
    "once more we note that the slicing and shift conditions differ in the two cases , so we do not expect the surfaces to coincide precisely .",
    "however as the differences between the lapse functions and shift vectors are small ( @xmath180 and @xmath181 in regions near the horizon except near the @xmath182axis ) , the solutions do agree nicely . in and around the @xmath183 plane",
    ", the solutions match to within half a grid cell .",
    "greater differences , however , are found along the @xmath182axis , where the two surfaces are displaced by a maximum of roughly two grid cells .",
    "this is attributed in part to a bigger @xmath184 ( @xmath185 ) near the @xmath182axis , which results from the imposed asymmetry in the lapse function due to the nearness of the outer boundaries , where we enforce the spherical schwarzschild lapse as a boundary condition in the maximal equation used in the 2d simulation .    again , a more geometrical comparison or test of the solver is the mass of the surface found .",
    "the horizon mass is defined as @xmath186 , where @xmath187 is the area of the surface .",
    "figure [ fig : ev_brill_mass ] plots the ah mass as a function of time for the 2d and the @xmath143 , 3d evolutions . in both cases ,",
    "the mass increases at first , as the gravitational waves fall into the black hole , reaching @xmath188 at @xmath189 .",
    "the masses in the two cases differ by only 0.1% at @xmath189 . for comparison we also plot @xmath190 for the surface found using a lower order @xmath142 multipole expansion . at early times ,",
    "when the horizon is most distorted , the @xmath142 expansion is clearly not adequate to resolve the horizon shape , as evidenced by the ah mass which exceeds the adm mass by about 1% .",
    "however , as the black hole settles down into a quasi  static state , the surface becomes more spherical and the @xmath142 solution approaches both the 2d and the @xmath143 , 3d results , differing from the 2d result by about 0.35% at @xmath189 .",
    "we have developed a promising general 3d method of finding the ah in a numerically constructed spacetime based on a minimization procedure . in this paper",
    "we have applied the method and demonstrated that it works for spacetime data which are not time symmetric , and data sets which are obtained in actual numerical evolutions .",
    "the major advantage of this method is that the minimization procedure is much better understood than the corresponding problem of solving the elliptic equation , and well  tested routines are available for solutions .",
    "the major drawback of the method is that , for ah surfaces which are not smooth , and which deviate significantly from sphericity in coordinate space , the higher dimensional minimization procedure can be computationally expensive . with our present implementation of the finder using powell s routine , we are limited to searching for ah surfaces at every 50 , or so , evolution cycles , instead of continually monitoring the ah throughout the numerical evolution , as would be our final goal . in future implementations of the method , we anticipate developing a more sophisticated minimization routine using derivative information to speed up the procedure , as well as other means to improve the robustness and efficiency of the code .",
    "our code , which is optimized for both the c90 and massively parallel cm5 machines , together with documentation , will be made available on our servers http://jean-luc.ncsa.uiuc.edu and http://wugrav.wustl.edu .",
    "we gratefully acknowledge the assistance of andrey odintsov and david rosnick , who helped in testing and coding various components of the code described in this paper .",
    "we also thank thomas baumgarte for discussions and john shalf for help in visualization of the horizon surfaces presented in this paper .",
    "this research is supported by the national center for supercomputing applications , the pittsburgh supercomputing center , and nsf grants nos .",
    "phy94 - 04788 , phy94 - 07882 , phy96 - 00507 and phy / asc93 - 18152 ( arpa supplemented ) .",
    "wms would also like to thank the institute of mathematical sciences of the chinese university of hong kong for hospitality during his visit .",
    "j. libson , j. mass , e. seidel , and w .- m .",
    "suen , in _ the seventh marcel grossman meeting : on recent developments in theoretical and experimental general relativity , gravitation , and relativistic field theories _ , edited by r. t. jantzen , g. m. keiser , and r. ruffini ( world scientific , singapore , 1996 ) , p. 631 .                                  .",
    "the effect of the ( axisymmetric ) multipole order @xmath128 on finding the correct horizon surface is demonstrated here for the two black hole misner data with @xmath89 . the number of iterations and cpu time required by the solver is tabulated along with the expansion summed over all points on the surface .",
    "the timings were performed on the 128-node partition of the cm5 , using a 3d grid of size @xmath90 and a @xmath191 mesh to cover the 2d horizon surface in a single quadrant . [ cols=\"^,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> we have developed a general method for finding apparent horizons in 3d numerical relativity . instead of solving for the partial differential equation describing the location of the apparent horizons , </S>",
    "<S> we expand the closed 2d surfaces in terms of symmetric trace  free tensors and solve for the expansion coefficients using a minimization procedure . </S>",
    "<S> our method is applied to a number of different spacetimes , including numerically constructed spacetimes containing highly distorted axisymmetric black holes in spherical coordinates , and 3d rotating , and colliding black holes in cartesian coordinates . </S>"
  ]
}