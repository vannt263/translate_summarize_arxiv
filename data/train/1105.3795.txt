{
  "article_text": [
    "examples of the use of digital control algorithms , rather than analog electronics , to lock the frequency of single @xcite and multiple @xcite lasers date back to 1998 .",
    "this progression has been motivated by the fact that a digital system can offer distinct advantages over its analog counterpart .",
    "these include cost savings , as features can be programmed rather than manufactured or purchased , and space savings , as most of the features can be included in the code they take up only as much space as the hardware needed to run it .",
    "mostly , however , the advantage of digital locking over analog systems lies in its flexibility : the ability to change the functionality of the system by altering the control code rather than having to purchase new equipment or physically modify old equipment .",
    "this makes a digital system easily reproducible , as well as having the ability to add complex logic which would be difficult to include with analog circuits alone ( for examples see ref.s @xcite and @xcite ) .",
    "using the added power of digital control has lead many to develop novel methods for frequency stabilizing lasers ( for example see ref.s @xcite ) .",
    "+ quantum optics is one branch of science which can benefit from digitization and computer control . here",
    "we present a code designed for quantum optics experiments using field programmable gate arrays ( fpgas ) programmed with national instruments labview@xmath0 software .",
    "this code is freely available to be downloaded @xcite and to be modified , as both a pedagogical tool , and to allow individual users to tailor it to their specific needs .",
    "+      one component common to many quantum optics experiments is the cavity - for instance mode - cleaner style cavities to select only one spatial mode of an input field or fabry - perot cavities to select a specific frequency .",
    "cavities are not just used for filtering , however , and can also be an integral part of an experiment .",
    "for instance , cavities containing non - linear optical crystals ( known as optical parametric oscillators - opos ) are used to produce entanglement @xcite and squeezing @xcite , two powerful quantum resources .",
    "these effects are extremely sensitive to noise or loss in the system .",
    "therefore the properties of the system used to lock an opo must be stringently monitored . as well as",
    "the use of cavities , another issue of concern is the relative phase between various fields .",
    "for instance , homodyne detection using a local oscillator @xcite .",
    "+ quantum optics experiments can require many locking loops and sophisticated data acquisition , and therefore these experimental systems can become highly complex . as an example , in 2003 bowen _",
    "_ demonstrated the teleportation of the quadrature amplitudes of two light fields @xcite . to achieve this the experiment required a frequency doubling cavity , a high finesse ring cavity used to seed a pair of opos , as well as two homodyne detector set - ups requiring phase control . + more recently , another example of the complexity of quantum optics experiments is the work carried out by yukawa _",
    "et al . _ in 2008 to generate four - mode cluster states for use in quantum computing @xcite .",
    "this experiment required a frequency doubler , which was used to pump four opos , and four homodyne set - ups were required for the measurements . from these examples",
    "it can be seen that a digital control system for quantum optics experiment would need to be extendible to many locks , flexible in the style of locks it can control , as well as be as effective , or better , than current analog controller in reducing noise . + as more complex experiments are developed to investigate further into the quantum realm , the practicality of digital control will become more apparent .",
    "this is because digital control allows for integration of all relevant information about the system to be accessed , and controlled , from one location .",
    "this , in turn , allows the system to take into account the sequential nature of the locks comprizing the experiment .",
    "also , the complete system information can be used for conditional acquisition , to ensure that data is only recorded when the system is in the desired state .",
    "+       and @xmath1 are the transfer functions of the plant and controller respectively , with @xmath2 the input noise and @xmath3 the output of the system ( i.e. error signal ) .",
    "also shown is the placement of a network analyzer , with @xmath4 the extra noise added to the system in the form of a swept sine wave ( sine ) or white noise ( wn ) .",
    "( b ) bode plot of the transfer function of a code - cleaner cavity for ( i ) a network analyzer ( model ms4630b from anritsu ) and ( ii ) a white noise generator included in the code . ]",
    "this section provides an overview of the relevant control theory , for a more in depth description see , for example , ref .",
    "[ fig : dl_controltheory](a ) shows the basics of a closed loop feedback system . a plant - the system to be controlled - having a transfer function ( i.e. frequency response ) @xmath5 produces some form of error signal @xmath3 .",
    "this is passed to the controller , having a transfer function @xmath1 , used to suppress the noise added to the system @xmath2 .",
    "the system transfer function is defined as @xmath6 where we take the shorthand @xmath7 . for quantum optics experiments , as with all locking servo applications , we are interested in three properties of the controller : how well it can suppress noise at low frequencies ; what frequency range it can achieve this over ; and how stable the lock is . here",
    "we define the bandwidth of the system to be the frequency @xmath8 at which the controller no longer suppresses noise , i.e. the unity gain frequency @xmath9 .",
    "the stability of the system is usually measured using the nyquist stability criterion @xcite using the phase margin ( pm ) defined by @xmath10 that is , the clearance of the phase of @xmath11 from @xmath12 . + one way of investigating the system transfer function is to use a network analyzer to add known noise @xmath13 to the system and measuring the frequency response . for commercial network analysers",
    "this extra noise is usually in the form of a swept sine wave , though white noise - that is noise with the same amplitude at all frequencies - can also be used .",
    "the placement of a network analyzer to measure the system transfer function is shown in fig .",
    "[ fig : dl_controltheory](a ) , and examples of magnitude and phase ( i.e. bode ) plots for an unlocked mode - cleaner cavity , measured using this method , are shown in fig . [ fig : dl_controltheory](b ) .",
    "+ another measure of the efficacy of a lock is the deviation of the error signal from its desired value over time .",
    "this is usually measured using the root mean squared ( rms ) method , which is expressed mathematically as @xmath14 here @xmath15 is the value of the error signal at a particular time @xmath16 , @xmath17 is the desired value of the error signal ( usually 0 ) , and @xmath18 is the number of points the rms was measured over .",
    "the digital control system presented here is based on the pound - drever - hall locking technique @xcite that uses modulation of the laser frequency to produce an anti - symmetric error signal ( see fig . [",
    "fig : apdl_setup](a ) inset ) which is then fed back to the actuating mechanism to keep the system locked to a desired position .",
    "the code allows for automatic , sequential locking , as well as analysis of the locks comprising the experiment to facilitate optimizing procedures .      ;",
    "pxi - pxi chassis ; fpga - field programmable gate array card ; freq .",
    "gen . - frequency generator ; rt - real time controller ; aip - analog input to fpga ( sampling frequency @xmath19 1 msps ) ; aop - analog output from fpga ( sampling frequency @xmath19 1 msps ) ; hs adc - high speed analog to digital converter ( 80 msps ) ; d - detector ; clock gen . - digital clock generation board ; fmod - modulation frequency for lock ; eom - electro - optic modulator ; pzt - piezo - electric transducer ; ppktp - periodically poled potassium titanyl phosphate crystal ; hv amp - high voltage amplifier ; and expt . - rest of experiment .",
    "inset shows the different signals which are used for locking ( dc - dc reflection signal ; error - error signal ; scan - scan function ) as a function of pzt position .",
    "( b ) depiction of labview@xmath0 code used to program fpga cards .",
    "cic - cascaded - integrator - comb filter ; pii controller - proportional , integral , double integral controller ; scan t - scan threshold ; lock t - lock threshold ; t - true ; f- false . ]    fig .",
    "[ fig : apdl_setup](a ) shows the basic setup for a single lock , in this case for an opo .",
    "a frequency generation ( fg ) signal at 80 mhz ( ni pxi-5404 ) is split in two ( minicircuits splitter zsc-2 - 1 ) , with one output being sent to a clock generator board ( cgb - ad9959 from analog devices ) and one to clock a high speed analog to digital convertor ( hs adc - ad9460bsvz-80 from analog devices at 80 m samples s@xmath20 ) .",
    "the output from the cgb is controlled via a field programmable gate array card ( fpga - ni pxi-7852r ) , and sends a sine wave of a desired frequency to some form of modulation device - here an electro - optic modulator ( eom ) - to modulate the phase of the input field .",
    "+ once the modulated signal passes through the cavity , part of it is reflected on to a detector which has two output ports - one ac coupled and one dc coupled .",
    "the ac component , containing the modulation signal , is sent to the hs adc .",
    "the dc component , if there is one , is sent to a low speed analog input ( aip @xmath21 m sample s@xmath20 ) of the fpga .",
    "the controller algorithm is discussed in the following section , with the output signal sent through a low speed analog output ( aop ) , via a high voltage amplifier to the piezo - electric transducer ( pzt ) controlling the round - trip cavity length .",
    "+ this system has been designed with scalability in mind to cater to experiments with large numbers of locks . using the same principle as above , up to eight locks can be implemented using two fpgas , two cgs , one fg , and eight hs adcs .",
    "this is achieved by splitting the 80 mhz fg signal as many times as necessary to send it to clock all hs adcs and one signal to each cgb ( both controlled by one of the fpgas ) .",
    "also , the 16 bit signals from pairs of hs adcs are combined into one 32 bit signal before being sent to an fpga .",
    "this is because the fpgas cards used here have only two 40 bit digital input / output ( dio ) connections , and in this way four locks can be implemented on each fpga .",
    "each fpga also has 8 low speed aips and 8 low speed aops , and another 16 dio lines all located on a mixed io connector .",
    "these are more than enough for the four dc input and four controller output signals required per fpga , as well as extra digital lines to control the cgbs .",
    "+ using this method up to 16 locks can be implemented on one pxi chassis ( here a ni pxi-1042q ) .",
    "the code was developed using labview 2010@xmath0 ( 32 bit ) .",
    "an overview of the fpga code is shown in fig . [",
    "fig : apdl_setup](b ) and consists of two loops : a high speed loop running at 80 m samples s@xmath20 ; and a low speed loop running at approximately 750 k samples s@xmath20 ( limited by the low speed aip / aop ) . in the high speed loop",
    "the modulated signal from the hs adc is demodulated with a cosine function generated using a look - up table at the same frequency as the modulation ( i.e. @xmath22 ) .",
    "this passes through a cascaded - integrator - comb ( cic ) filter @xcite to produce an error signal that is then sent to the low speed loop .",
    "+ there are two main components to the low speed loop : a lock mode ( consisting of a p , i and i@xmath23 - pii - controller ) ; and a scan mode ( consisting of a saw tooth scan function ) . once directed by the user to lock , the code will move from scan mode to lock mode depending on the user defined scan and lock thresholds set for the dc signal .",
    "when the user initiates locking , the code will move from scan mode to lock mode when the dc input dips below the scan threshold .",
    "the code will then remain in lock mode unless either the user disengages locking or the dc input rises above the lock threshold ( set higher than the scan threshold ) . in both cases",
    "the system will revert to scan mode . in the latter case , however , the system will move back to lock mode once the dc input again drops below the lock threshold . if the lock has no dc component ( i.e. a phase - style lock ) the absolute value of the error signal can be used to set the thresholds instead .",
    "+ the low speed loop includes a white noise generator , and this is used to measure the system transfer function as described in sec .",
    "[ sec : dl_control_theory ] .",
    "+ a master code runs on the odd numbered fpgas and a slave code runs on the even numbered fpgas .",
    "the codes differ in that the master code contains an internal pxi trigger for the fg ( only on the first fpga ) and also runs the cgb programming , ensuring that the @xmath22 used for demodulation in the high speed loop is the same frequency as that sent to drive the modulator , and with a fixed phase relation . + the real time ( rt ) code acts as the interface between the fpgas and the user , as well as to allow communication between fpgas .",
    "this allows for sequential locking logic to be implemented across all fpgas , with the user specifying the order of the locks , and which locks are dependent on which others .",
    "if a lock drops then the controller signal for any locks that depend on the dropped lock will freeze until such time as the first lock is restored .",
    "the rt code also includes an inbuilt scope which can display information about any of the locks such as error signal , dc signal and scan signal .",
    "in this section we present an experimental analysis of our locking system acting on a bow - tie opo cavity containing a periodically poled potassium titanyl phosphate ( ppktp ) crystal and co - resonant with light at 1064 and 532 nm .      ) and phase margin ( pm ) measured by the code . ]    in our analysis two tools were used to investigate the individual locks : the system transfer function and the rms of the error and dc signals , both measured internally using the code .",
    "for the transfer functions , the three key indicators were the amount of noise suppression at low frequencies , the range of frequencies for which noise was suppressed ( i.e. bandwidth ) and the stability of the lock as measured by the phase margin , as discussed in sec .",
    "[ sec : dl_control_theory ] .",
    "[ fig : dl_controltheory](b ) shows a comparison between the plant transfer function measured using a network analyzer ( model ms4630b from anritsu ) as well as using the internal white noise generator .",
    "as can be seen , the two match with excellent agreement from approximately 500 hz onwards , with the frequency range of the white noise generator extending to 100s of khz . at low frequencies",
    "there is extra noise present on the white noise transfer function .",
    "better resolution for these lower frequencies could be achieved by using greater averaging .",
    "[ fig : lock_optimisation ] illustrates an optimization procedure developed for a generic lock applied to the opo .",
    "firstly i , and then p , gains are increased iteratively , followed by i@xmath23 to increase noise suppression at low frequencies . fig .",
    "[ fig : lock_optimisation](a ) shows the system transfer functions for this process and the reduction in noise that occurs at low frequencies . fig .",
    "[ fig : lock_optimisation](b ) shows the average rms for these traces taken over 10 runs , which shows a reduction in noise as more gain is added to the system .",
    "also shown on this figure is the bandwidth and phase margin measured by the system .",
    "as can be seen , though the noise suppression seen on the transfer function traces does not increase significantly after the initial i gain is added , the bandwidth does increase while the rms decreases with increasing gain . in all cases",
    "the phase margin was kept above @xmath24 .",
    "+ though the amount and ratios of the gains required to optimize each individual lock will differ due to different plant resonances etc . ,",
    "the combination of the p , i , and i@xmath23 controllers allow for flexibility when optimizing .",
    "the long term stability of the opo cavity was investigated over a period of one hour . to accomplish this ,",
    "both the error and dc signals for the opo were measured at 1 second intervals using the code .",
    "the opo was locked firstly with the internally programmed pii controlled and then with an external analog pi controller developed in house .",
    "these analog pis have been used previously on many quantum optics experiments , including the one described in ref .",
    "the results of this comparison are shown in fig.s [ fig : dl_stability](a ) and ( b ) for the error and dc signals respectively , with the former converted to frequenc and the latter normalized to the maximum peak height .",
    "+ as can be seen , both the analog and digital controllers are stable over the period of one hour , though at one point , approximately 2200 s in to the run , it can be seen that the analog system jumped slightly , but not enough to lose lock .",
    "this stability was despite the fact that during an hour the laser resonant frequency was found to move by approximately 175 mhz , measured by monitoring the pii controller output during the digital stability run .",
    "this is shown in fig .",
    "[ fig : dl_stability](c ) .",
    "+ the amount of noise suppression over this time was again measured using transfer functions and rms values , with the former shown in fig .",
    "[ fig : dl_stability](d ) . from the rms values included in fig.s [ fig : dl_stability](a ) it can be seen that the rms for the digital error signal trace was approximately 0.3 mhz as opposed to the 0.4 mhz for the analog controller . for the dc rms , even removing the perturbed region around 2200 s from the analog trace , the rms is approximately the same ( @xmath15 being normalized to the total size of the peak and @xmath17 is taken to be the peak minima ) . also , from fig .",
    "[ fig : dl_stability](d ) it can be seen that the digital controller has 50 db greater noise suppression at low frequencies .",
    "+ these results will vary depending on the different analog and digital controllers developed and the gains used .",
    "for instance , the extra noise suppression at lower frequencies for the digital controller can mostly be attributed to the i@xmath23 component , which was not included in its analog counterpart .",
    "however , it is much easier to alter a digital , rather than an analog , controller and this comparison verifies the efficacy and long term stability of this general digital controller .",
    "so far we have presented results which are not specific to the field of quantum optics . in this section , the opo is inserted into a larger quantum optics experiment designed to characterize optical schrdinger cat states ( see , for instance , ref .",
    "this experiment , described in ref .",
    "@xcite and shown in fig .",
    "[ fig : dl_quantum](a ) , consists of 2 mode - cleaner cavities ( one at 532 nm and one at 1064 nm ) , the opo - which is used to produced squeezing on the 1064 nm beam , two phase locks , a double homodyne , and a tomographic homodyne lock to allow locking to any quadrature value .",
    "this is all controlled using the hardware and software described in sec .",
    "[ sec : dl_code ] and integrated into one user - controlled rt code . + as in many other quantum optics experiments , it is desirable to only take data when all components of the system are locked .",
    "also , in this case , vast quantities of data ( 100s of gbs ) are required to be able to produce the necessary tomographic reconstructions of the optical schrdinger cats that are characterized , and this is taken over many hours .",
    "it is also necessary to compare the squeezing data traces with dark noise ( dn - signal and local oscillator blocked ) and shot noise ( sn - only signal blocked ) traces at various times during data collection for normalization purposes .",
    "+ to accommodate these requirements , a second rt code was developed to take data using two data acquisition cards ( ni pxi-5124 ) .",
    "the data acquisition code communicates with the locking code to determine whether all components are locked , as well as to change locking parameters as desired . for instance , the phase of the single homodyne lock must be changed to allow for the tomographic reconstruction , and blocking of the various fields present using motorized control via the locking fpga is necessary for collecting dn and sn traces . the data is saved to the hard drive of the pxi controller and later extracted for examination . + a flow diagram of the data collection protocol is shown in fig .",
    "[ fig : dl_quantum](b ) .",
    "here the user determines the number of data traces to take for each tomographic lock angle @xmath25 , as well as the change in tomographic lock angle between measurements @xmath26 , the maximum tomographic lock angle @xmath27 , and the number of experimental runs @xmath28 for @xmath29 .",
    "it should be noted that the waiting time programmed in to the code is to allow time for the shutters to close or open , and the system check includes such functions as resetting error signal offsets so that all locks remain stable during the hours of data collection . if a lock does fail during the measurement of one angle , the protocol will reset and try again for that angle until it is successful .",
    "[ fig : dl_quantum](c ) shows an example of squeezing data collected from one such run with @xmath30 .",
    "approximately 1.5 db of noise suppression below the quantum noise limit ( qnl ) can be seen for a tomographic angle of @xmath31 , accompanied by an increase of 1.8 db in the opposite quadrature .",
    "+ this implementation of a digital control algorithm on a uniquely quantum system highlights the benefits digital control can bring to quantum optics experiments : the integration of information allowed for data to only be taken when all system components were locked to ensure only useful data was collected ; the automation of the locks meant that the experiment could be left unattended for many hours to collect the required amount of data as quickly as possible ; and the added flexibility allowed for automated acquisition of sn and dn , as well as the ability to alter the homodyne angle to perform the tomographic measurements .",
    "in conclusion , we have presented a digital locking system that allows for automatic and sequential locking and is easily scalable .",
    "this code was programmed using labview@xmath0 software and is free to download .",
    "we have shown how the inbuilt locking analysis tools can be used to help optimize individual locks , as well as demonstrated the efficacy and long term stability of the digital controller .",
    "finally , we used an example of a experiment used to characterize optical schrdinger cat states to illustrate the advantages of digital control for quantum optics experiments .",
    "this research was conducted by the _ australian research council centre of excellence for quantum computation and communication technology _ ( project number ce110001027 ) ."
  ],
  "abstract_text": [
    "<S> digital control of optics experiments has many advantages over analog control systems , specifically in terms of scalability , cost , flexibility , and the integration of system information into one location . </S>",
    "<S> we present a digital control system , freely available for download online , specifically designed for quantum optics experiments that allows for automatic and sequential re - locking of optical components . </S>",
    "<S> we show how the inbuilt locking analysis tools , including a white - noise network analyzer , can be used to help optimize individual locks , and verify the long term stability of the digital system </S>",
    "<S> . finally , we present an example of the benefits of digital locking for quantum optics by applying the code to a specific experiment used to characterize optical schrdinger cat states . </S>"
  ]
}