{
  "article_text": [
    "quantum monte carlo ( qmc ) is an approach capable of yielding highly accurate results in systems ranging from isolated molecules to the solid state@xcite .",
    "the success of most common qmc methods , namely variational monte carlo ( vmc ) and diffusion monte carlo ( dmc ) , depends crucially on the choice of trial wavefunction .",
    "indeed , the trial wavefunction limits both the statistical efficiency and accuracy of the simulation . in qmc methods ,",
    "the evaluation of the trial wavefunction becomes the most demanding part of the calculation especially when sufficiently large systems are considered or accurate simulations are required .",
    "this aspect of qmc was recognized even in the earliest dmc calculations , e.g. ref .",
    "consequently , the choice of trial wavefunction used in qmc calculations is motivated both by the accuracy and the speed of evaluation .",
    "the most common form of trial wavefunction is of the slater - jastrow type @xmath7 where , neglecting spin , @xmath8 is a slater determinant , @xmath9 is a jastrow function , and @xmath10 is a vector of the position @xmath11 of each electron . in qmc , the simulation commonly proceeds by proposing a local change to the electronic system configuration @xmath12 to @xmath13 . this local change in @xmath14",
    "is induced by the movement of one electron at a time from position @xmath11 to @xmath15 .",
    "the probability that the proposed local change is accepted is dependent on the transition probability , which depends on the ratio of @xmath16 , where @xmath17 is a new set of electron positions .",
    "this transition probability computation in turn requires the computation of the ratio of determinants @xmath18 and @xmath19 in the new and old configurations respectively .",
    "although a complete re - computation of @xmath20 can be made , an efficient algorithm that computes the necessary ratio @xmath21 without resorting to a complete independent calculation of each determinant can significantly increase the overall efficiency of qmc simulations .",
    "indeed , this efficiency measure is essential to the success of slater - jastrow wavefunctions ; for a single electron move , the conventional algorithms use sherman - morrison formula ( special case of sherman - morrison - woodbury formula @xcite ) which reduces the cost of evaluating @xmath21 to @xmath4 , with an @xmath2 cost if the move is accepted , compared with @xmath22 for a naive evaluation of the determinant .",
    "once the ratio of the determinants has been calculated , most quantities required in the monte carlo can be obtained through a simple multiplicative scaling@xcite . comparatively recently",
    ", `` linear scaling '' approaches have been developed to reduce the cost of evaluating the determinants@xcite by exploiting spatial locality in the studied physical system . in this paper , we explore alternative and complementary approaches to speedup the computation of transition probabilities and determinant ratios in qmc calculations .    the most accurate and commonly used qmc method is the dmc method performed in the fixed node approximation .",
    "this method exhibits a varational error in the energy depending on the quality of the nodal surfaces ( zeroes ) of the trail wavefunction . to improve the nodes as well as the variational quality of the trial function",
    ", it is now routine to utilize multiple determinant trial functions .",
    "these are commonly obtained from multiconfiguration quantum chemistry approaches such as the configuration interaction method where the ground state determinant @xmath23 is supplemented by single and double excitations from the ground state .",
    "that is ,    @xmath24e^{j({\\bf r})},\\ ] ]    where @xmath25 denotes a double excitation with orbitals @xmath26 and @xmath27 replaced by @xmath28 and @xmath29 respectively , and @xmath30 and @xmath31 denote the multi - determinant expansion coefficients .",
    "higher order excitations may be progressively included .",
    "such an expansion of the wavefunction allows the nodal surface to be improved .",
    "there are many strong motivations for minimizing the computational cost of multideterminant wavefunctions in qmc : recent benchmark tests of the accuracy achievable in all electron vmc utilized , for example , up to 499 determinants to obtain over 90% of the correlation energy in the first row atoms@xcite . to obtain a similar fraction of correlation energy in larger systems , more determinants are likely required .",
    "numerous recent studies @xcite have shown the utility of increased numbers of determinants for improved accuracy in atomic , molecular , and solid - state applications . in general",
    "this result is expected since quantum chemical techniques systematically improve the wavefunction with increased numbers of determinants .",
    "improved trial wavefunctions using multideterminants are required for large systems such as the @xmath32 fullerene where current trial wavefunctions are insufficient for computing accurate optical properties@xcite .",
    "multiple determinants may also be required to represent certain spin symmetries , e.g. ref .",
    "additionally , we have also recently shown that it is possible to sample the ground state wavefunction into a configuration expansion@xcite and subsequently improve the trial wavefunction@xcite .",
    "this application requires the use of large configuration interaction expansions consisting of potentially thousands of determinants .    in this paper",
    "we propose an efficient algorithm for utilizing slater - jastrow trial wavefunctions in qmc simulations .",
    "the algorithm is particularly efficient for multideterminant wavefunctions .",
    "extension to related alternative wavefunction forms such as multi - pfaffian and multi - backflow wavefunctions is straightforward . in section [ sec : alg ] we present the details of the algorithm .",
    "section [ sec : bench ] presents benchmark timing and efficiency measures for single determinant calculations using a variety of system sizes .",
    "the multideterminant case is analysed in section [ sec : mdetana ] .",
    "conclusions are given in section [ sec : conclusions ] .",
    "as mentioned earlier , in qmc , the monte carlo simulation proceeds by proposing a local change to the electronic system configuration @xmath12 to @xmath13 . the acceptance criterion for each such local change follows the traditional metropolis algorithm , which requires the computation of the transition probability .",
    "each time a local change is accepted , the slater matrix @xmath33 is updated to @xmath34 by modifying one of the rows of @xmath33 corresponding to an electron movement from @xmath35 to @xmath36 .",
    "the simulation then proceeds by proposing a new local change , which requires the re - computation of the determinant of slater matrix @xmath37 in the subsequent configuration @xmath38 .",
    "this progression of the simulation via local changes typically proceeds for many thousands to millions of steps until observables such as the total energy converge to a desired statistical accuracy .",
    "the slater matrix in configuration @xmath39 is given by @xmath40 \\label{apsi}\\end{aligned}\\ ] ] where @xmath11 and @xmath41 for @xmath42 indicate respectively the spatial coordinates and spin - orbitals of @xmath43-th electron . because we are moving a single electron ( say @xmath44-th electron ) at a time from position @xmath45 ,",
    "the slater matrix in the new electronic configuration @xmath46 is simply obtained by modifying the @xmath44-th row as @xmath47 \\label{apsip}\\end{aligned}\\ ] ] the metropolis probability to accept or reject the move is dependent on the ratio of determinants of slater matrices @xmath48 , where @xmath20 is the determinant of slater matrix @xmath34 and @xmath8 is the determinant of @xmath33 .",
    "the transition probability is in general proportional to @xmath49 , assuming real wavefunctions .",
    "if the move is accepted , then the system configuration changes to @xmath17 ; if not , the move is rejected and the system remains in configuration @xmath12 . in the following , whenever the context is clear , we denote @xmath20 by @xmath50 and @xmath8 by d.    for the monte carlo simulation to be efficient , all quantities related to the transition probability and any observables must be computed with minimum computational operations . in the case of a single determinant wavefunction the ratio @xmath51 is required .",
    "for a single electron move this corresponds to a change of a single row in the slater matrix . however , for the case of the multideterminant wavefunction , as in eq .",
    "[ eqn : mdwf ] , all ratios @xmath52 and @xmath53 are required .",
    "these ratios involve determinants with both orbital replacements and single electron moves ( i.e. , both row and column changes ) when compared to the original ground state determinant @xmath23 .    for a single electron move , the basic computational problem involved during the @xmath54-th mc step",
    "may be expressed as : _ given the determinanat @xmath55 of slater matrix @xmath56 , compute the determinant @xmath57 of @xmath58 _ such that @xmath59 where @xmath60 defines an index vector that maps @xmath61 such that @xmath62 , and @xmath63 denotes an unit vector with @xmath64 on the @xmath44-th entry and @xmath65 everywhere else .",
    "the vector @xmath66 corresponds to the _ change _ in slater matrix due to the displacement of the @xmath44-th electron during the @xmath54-th mc step and is given by @xmath67 a straight - forward computation of @xmath57 may be obtained as @xmath68 and @xmath69 can be evaluated as @xmath70    hence , for any given @xmath1 , @xmath71 can be evaluated efficiently in @xmath4 computations since @xmath72 can be interpreted as the @xmath44-th column of @xmath73 , i.e. , @xmath74 . however",
    ", repetitive computation of @xmath71 during each of the mc simulation steps ( for @xmath75 ) requires an efficient procedure to compute @xmath73 for each @xmath1 . for this purpose , traditional algorithms employ the sherman - morrison formula to update @xmath76 , which can be expressed as @xmath77 using this formula , @xmath73 can be updated to @xmath78 in @xmath2 computations .",
    "however , since the required number of mc steps in a typical monte carlo simulation readily extends to the thousands to millions range , and can increase with increasing system sizes , @xmath2 scaling of these traditional algorithms poses a significant hindrance for the simulation of large system sizes despite the fact that such large scale simulations are necessary to develop a better understanding of relevant chemistry and physics . as discussed in the introduction , sec [ sec : intro ] , multiple determinants compound this problem .",
    "alternatively , an efficient recursive algorithm for computing @xmath79 may be formulated by expressing eq .",
    "[ rank1 g ] as @xmath80 ~ { \\bf d}_{k}^{-1 } \\nonumber \\\\ & = & \\left[{\\bf i } - \\gamma_k { \\bf u}_k { \\bf v}_k^t \\right ] ~ { \\bf d}_{k}^{-1 } \\label{rank1ga}\\end{aligned}\\ ] ] where @xmath81 and @xmath82 . based on eq .",
    "[ rank1ga ] , a recursive scheme for computing @xmath79 may be formulated as @xmath83~ { \\bf d}_{0}^{-1 }   \\label{rank1gb}\\end{aligned}\\ ] ] an @xmath0 recursive algorithm based on eq .",
    "[ rank1 gb ] is presented in algorithm [ alg : qmc ] . for each additional step @xmath1 , this algorithm requires storage space for two vectors @xmath84 and @xmath66 of size @xmath3 .",
    "in addition , we need to store an index vector @xmath60 that maps @xmath61 such that @xmath62 .",
    "in order to compare the computational efficiency of the recursive algorithm with the traditional algorithm , we first tested the case of a single determinant wavefunction .",
    "an analysis of the multideterminant case is given in sec .",
    "[ sec : mdetana ] .",
    "we tested the algorithms on a randomly generated matrix @xmath85 .",
    "that is , since the algorithms are applicable for general matrices , we start with a matrix @xmath85 whose elements are randomly chosen between zero and one .",
    "then we consider rank-1 updates of @xmath85 as given by eq .",
    "[ eq1 ] for @xmath86 number of steps .",
    "the site locations @xmath44 are chosen sequentially , modulo @xmath3 , for these @xmath86 steps .",
    "the updated orbitals are chosen randomly .",
    "figure [ fig : timings ] presents the ratio of the computational timings obtained using the full matrix updating and recursive updating algorithms .",
    "the timings were obtained using a standalone benchmark code using double precision arithmetic .",
    "we used the same data structures both in our recursive and full qmc simulations .",
    "machine optimized linear algebra library calls were used for both algorithms .",
    "timings were obtained on a 2.73 ghz intel xeon processor with 12 mb cache .",
    "examining the timings shown in fig .",
    "[ fig : timings ] , we see that the recursive update algorithm is always significantly faster than the sherman - morrison algorithm for a small number of updates . for up to",
    "ten updates , the new algorithm @xmath87 times faster for a 100 sized matrix , while for a 6400 sized matrix the new algorithm is @xmath88 times faster . for increased numbers of updates",
    "the ratio of timings decreases .",
    "the crossover between the two algorithms occurs near the theoretically expected @xmath89 updates .    due to the iterative nature of both algorithms numerical errors",
    "accumulate over time .",
    "it is common practise in qmc simulations to fully recalculate the inverse cofactor matrices from time to time to limit these errors .",
    "such a recalculation requires @xmath22 operations .",
    "we have compared the numerical errors of the recursive update algorithm with the sherman - morrison algorithm and find the performance to be similar .",
    "figure [ fig : errors ] illustrates the build up of errors for both algorithms for a single run .",
    "figure [ fig : errors ] shows that both algorithms have good stability and on average give high accuracy , particularly for small numbers of updates .",
    "however , for both algorithms the average and maximum numerical error in the determinant ratio gradually increases with the number of updates and can become substantial . in both cases the maximum error for",
    "a fixed number of updates can deviate by several orders of magnitude from the average .",
    "this behavior appears to be due to the occasional mixture of very small and very large numbers in the update formulae which results in a significant loss of precision .",
    "this data shows that while the recursive algorithm performs similarly to the sherman - morrison algorithm , it is vital to check sufficient accuracy is obtained if large numbers of updates are performed .",
    "in the case of multiple determinant wavefunctions such as a configuration interaction expansion , all the excited slater matrices @xmath90 and @xmath91 are similar to the ground state matrix @xmath33 , and differ only by a few column interchanges .",
    "the use of the recursive algorithm provides an efficient way of calculating the transition probability compared to the traditional algorithm ; it is not only faster but also requires reduced storage of @xmath2 for storing _ only @xmath92 of the ground state matrix_. no other potentially large data must be stored , although it is advantageous to reuse the current determinant values between mc steps .",
    "the recursive algorithm is used to compute the non - ground state determinants via column changes to the ground state matrix .",
    "the cost of each particle move is constant and does not increase when many steps are taken .    for simplicity",
    "we analyse the case of a multiple determinant wavefunction consisting of only the ground state determinant and @xmath93 determinants doubly excited from this state .",
    "conventionally the @xmath92 as well as all the excited slater matrix inverses are stored in memory to enable fastest possible update using the traditional algorithm .",
    "when the recursive algorithm is applied to multiple determinant wavefunctions , we store only the @xmath92 of the ground state .",
    "conventional updates are performed on this determinant and the recursive algorithm is used to compute the other excited determinants since the excited and ground state slater matrices differ by a few column changes .",
    "note that successive row updates can be performed in @xmath0 operations using an algorithm similar to that of algorithm [ alg : qmc ] .",
    "however , successive row updates followed by multiple column updates always requires a @xmath2 cost associated with a matrix - vector multiplication . since proposed moves are usually accepted in dmc calculations with an acceptance ratio of @xmath94 , it is convenient to use the conventional ( sherman - morrison ) algorithm to update the inverse of the ground state slater matrix .",
    "it should also be noted that in the event the proposed move is accepted , the traditionally updated @xmath20 used in the evaluation of the excited state determinants can be reused : the recursive update algorithm then requires no additional @xmath2 work over a single determinant calculation .",
    "consequently , using the recursive algorithm an @xmath93 determinant wavefunction can be used with an updating cost scaling only linearly in @xmath93 and system size @xmath3 compared to an @xmath95 scaling cost using the traditional algorithm .    to evaluate determinant ratios such as @xmath96",
    "we first perform a traditional update to obtain @xmath97 . the recursive algorithm is then used to compute @xmath98 from @xmath99 .",
    "we assume that @xmath100 is stored and available from a previous mc step , but this can also be calculated using two applications of the recursive algorithm to @xmath101 . in table [ tab : mdcosts ] we compare the costs of evaluating the determinant ratios in @xmath102 .",
    "independent of the amount of storage chosen for the traditional scheme , the recursive scheme displays an improved computational cost by a factor @xmath6 , or @xmath93 times the cost of a complete single determinant update .",
    "the single determinant benchmarks of sec .",
    "[ sec : bench ] show that these updates , which are few in number and hence correspond to the left side of fig .",
    "[ fig : timings ] , are several orders of magnitude faster than the traditional algorithm .",
    "in this paper , we presented an efficient low - rank updating algorithm for qmc simulations .",
    "the algorithm requires only @xmath0 computations during @xmath1-th mc step compared with @xmath2 computations required by traditional algorithms .",
    "our numerical simulations indicate that for small numbers of updates of a single determinant this algorithm is orders of magnitude faster than traditional algorithms . for single determinant wavefunctions ,",
    "the traditional algorithms remain the preferred choice for more than @xmath4 updates . for multideterminant wavefunctions of @xmath5 determinants ,",
    "our algorithm is the preferred choice , being significantly faster and of particular interest for large systems .",
    "in addition , it enables workspace to be reduced by a factor @xmath6 .",
    "the speed and storage savings of this new algorithm enables qmc calculations to use thousands of determinants .",
    "1.00em*acknowledgment * + prck wishes to thank f. a. reboredo , j. kim , and r. q. hood for helpful conversations .",
    "this research is sponsored by the mathematical , information and computational sciences division , office of advanced scientific computing research and the center for nanophase materials sciences , office of basic energy sciences , both of the u.s .",
    "department of energy and under contract number de - ac05 - 00or22725 with ut - battelle , llc .",
    "the qmc endstation project is supported by the u.s .",
    "department of energy ( doe ) under contract number doe - de - fg05 - 08or23336 .",
    "a. j. williamson , r. q. hood , and j. c. grossman , phys .",
    "* 87 * , 246406 ( 2001 ) .",
    "f. a. reboredo and a. j. williamson , phys . rev .",
    "b * 71 * , 121105 ( 2005 ) .",
    "d. alfe and m. j. gillan , journal of physics : cond . mat .",
    "* 16 * , l305 ( 2004 ) .",
    "a. aspuru - guzik , r. salomon - ferrer , b. austin , and w. a. lester jr , j. comp .",
    "* 26 * , 708 - 715 ( 2005 ) .",
    "j. kussmann , h. riede , and c. ochsenfeld , phys .",
    "b * 75 * , 165107 ( 2007 ) .",
    ".cost of computing wavefunction ratios using traditional and recursive algorithms for proposed and accepted single electron moves .",
    "the wavefunction is of the configuration interaction doubles type consisting of @xmath93 double excitations from a single ground state determinant . for the storage costs we consider only the most significant @xmath2 and higher contributions . for at least the ground state determinant ,",
    "both the full matrix and its inverse are stored resulting in the lead factor of 2 in the storage costs . in the traditional algorithm ,",
    "the emphasis is on speed and hence all the excited state matrices and ground state matrix ( along with its inverses ) are stored . for the `` minimum storage traditional '' ,",
    "the emphasis is on limiting storage costs even at the expense of increased computational cost .",
    "hence , in the `` minimum storage traditional '' algorithm , we assume that the traditional algorithm is used but only the ground state matrix is stored and the remaining matrices are computed based on the ground state matrix . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> we present an efficient low - rank updating algorithm for updating the trial wavefunctions used in quantum monte carlo ( qmc ) simulations . </S>",
    "<S> the algorithm is based on low - rank updating of the slater determinants . in particular , </S>",
    "<S> the computational complexity of the algorithm is @xmath0 during the @xmath1-th step compared with traditional algorithms that require @xmath2 computations , where @xmath3 is the system size . for single determinant trial wavefunctions </S>",
    "<S> the new algorithm is faster than the traditional @xmath2 sherman - morrison algorithm for up to @xmath4 updates . for multideterminant configuration - interaction type trial wavefunctions of @xmath5 determinants , </S>",
    "<S> the new algorithm is significantly more efficient , saving both @xmath6 work and @xmath6 storage . </S>",
    "<S> the algorithm enables more accurate and significantly more efficient qmc calculations using configuration interaction type wavefunctions . </S>"
  ]
}