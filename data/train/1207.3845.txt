{
  "article_text": [
    "numerical simulations are a useful tool for many radiation hydrodynamic problems in astrophysics . however , numerical modeling of radiation hydrodynamic phenomena is very challenging for a number of reasons . to achieve a highly accurate description of the system",
    "usually requires a multidimensional treatment with high spatial resolution .",
    "it is also desirable to handle the radiation frequency variable properly , because radiation transport is a frequency - dependent process .",
    "moreover , the numerical algorithms for radiation hydrodynamics must be stable and efficient .",
    "core - collapse supernovae are such complex phenomena @xcite that neutrino radiation hydrodynamics simulations have been indispensable for helping understand the explosion mechanism .",
    "various algorithms have been developed to solve neutrino radiation hydrodynamics equations .",
    "because of the complexities involved in the problem and the limited computer resources available , various tradeoffs have to be made .",
    "many of these algorithms are 1d ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , or have used the so - called `` ray - by - ray '' approach , which does not truly perform multi - dimensional transport ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the two - dimensional code of @xcite is a gray flux - limited diffusion ( fld ) code that does not include order @xmath0 terms , where @xmath1 is the characteristic velocity of the system .",
    "the 2d multigroup multiangle code of @xcite does not include all order @xmath0 terms , and in particular it lacks direct coupling among radiation groups .",
    "the two - dimensional algorithm of @xcite is based on a mixed - frame formulation of a multigroup two - moment system that is correct to order @xmath0 , but it remains to be implemented in a working code . @xcite",
    "have developed a fully coupled 2d multigroup fld code based on a comoving frame formulation that is correct to order @xmath0 . besides the grid - based methods , smoothed particle hydrodynamics ( sph ) methods",
    "have also been applied to multi - dimensional neutrino radiation hydrodynamics simulations of core - collapse supernovae ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , but the sph scheme has not yet been extended to multigroup .",
    "recently @xcite developed a monte carlo method for neutrino transport , but hydrodynamics and radiation transport are not yet coupled in the scheme .    in this paper",
    ", we present a numerical algorithm for solving multi - dimensional multigroup photon and neutrino radiation hydrodynamics equations in the comoving frames that are correct to order @xmath0 .",
    "radiation quantities that are of interest are the radiation energy density , radiation flux , and radiation pressure tensor .",
    "it is more accurate to evolve both the radiation energy density and the radiation flux especially when the radiation is highly anisotropic and optically thin .",
    "however , the two - moment approach is very expensive in terms of computer time and memory for multi - dimensional multigroup radiation hydrodynamics simulations .",
    "thus , we have adopted the flux - limited diffusion approach @xcite for computational efficiency . in the fld approach",
    ", only the radiation energy density needs to be evolved over time , and the radiation flux is derived through a diffusion approximation .",
    "furthermore , we use an analytic closure for the radiation pressure tensor . we have adopted a multigroup method , in which the radiation frequency is discretized into multiple groups .",
    "the equations we solve are similar to those in @xcite .",
    "however , we have neglected inelastic scattering of neutrinos on matter , which is currently treated as elastic scattering . since the total cross section for the latter at the neutrino energies near and outside the neutrinospheres are @xmath2100 times smaller than the cross sections for scattering off nucleons and nuclei , not including inelastic effects at this stage has a minor effect on the qualitative behavior of collapse , bounce , and shock dynamics",
    "nevertheless , the approach of @xcite to handle inelasticity and energy redistribution can be incorporated into our scheme .",
    "another difference between our scheme and the scheme of @xcite is that we have developed a godunov scheme in which radiation is fully coupled into a characteristic - based riemann solver for the hyperbolic part of the system .",
    "many multigroup neutrino transport codes use a fixed eulerian grid .",
    "however , it is difficult to achieve sufficient resolution in multi - dimensional simulations with this simple approach . to efficiently achieve high resolution",
    ", we use an eulerian grid with block - structured adaptive mesh refinement ( amr ) . the amr algorithm we use",
    "has a nested hierarchy of logically - rectangular variable - sized grids and refines simultaneously in both space and time .",
    "amr techniques have been successfully used in multi - dimensional multigroup photon radiation transport @xcite .",
    "however , to the best of our knowledge , this is the first time that amr has been employed in a multi - dimensional multigroup neutrino solver .",
    "besides amr , the arbitrary lagrange eulerian ( ale ) method is an alternative approach for mesh refinement .",
    "we note that ale has been successfully employed in multi - dimensional multigroup neutrino transport @xcite and photon transport @xcite .",
    "we have implemented our algorithm in the compressible astrophysics code , castro .",
    "this is the third paper in a series on the castro code and its numerical algorithms . in our previous papers ,",
    "we describe our treatment of hydrodynamics , including gravity and nuclear reactions ( * ? ? ?",
    "* henceforth paper i ) , and our algorithm for flux - limited gray radiation hydrodynamics based on a mixed - frame formulation ( * ? ? ? * henceforth paper ii ) . here , we describe our algorithm for flux - limited multigroup radiation hydrodynamics based on a comoving - frame formulation .",
    "in   [ sec : rhd ] , we present the multigroup radiation hydrodynamics equations that castro solves .",
    "we show that the system can be divided into a hyperbolic subsystem (   [ sec : hyper ] ) , a subsystem of advection in frequency space (   [ sec : fspace ] ) , and a parabolic subsystem for radiation diffusion (   [ sec : para ] ) . analytic results for the mathematical characteristics of the hyperbolic subsystem are also presented in   [ sec : hyper ] .",
    "the hyperbolic and the frequency space advection steps are solved by an explicit solver , whereas the parabolic subsystems is solved by an iterative implicit solver .",
    "we describe the explicit solvers in ",
    "[ sec : explicit ] , followed by a description of the implicit solver in   [ sec : implicit ] .",
    "we also discuss acceleration schemes that can greatly improve the convergence rate of the iterative implicit solver (   [ sec : accel ] ) . in   [ sec : tests ] , we present results from a series of test problems .",
    "a scaling test is shown in   [ sec : performance ] to demonstrate the scaling behavior of the multigroup group radiation solver .",
    "finally , the results of the paper are summarized in   [ sec : sum ] .",
    "in this section , we present the multigroup radiation hydrodynamics equations that castro solves .",
    "our formulation is based on a comoving - frame approach , unlike our gray radiation hydrodynamics solver presented in paper ii . in the comoving - frame approach ,",
    "the radiation quantities and the opacities are measured in the comoving frames .",
    "the set of equations are correct to order @xmath0 .",
    "we then derive the multigroup radiation hydrodynamics equations using frequency space discretization .",
    "we also analyze the mathematical characteristics of the system . here",
    "we present the results in terms of neutrino radiation and indicate modifications needed for photon radiation .",
    "the system of neutrino radiation hydrodynamics that is correct to order @xmath0 can be described by @xmath3 @xcite .",
    "here @xmath4 , @xmath5 , @xmath6 , and @xmath7 are the mass density , velocity , pressure , and total matter energy per unit mass ( internal energy , @xmath8 , plus kinetic energy , @xmath9 ) , respectively .",
    "@xmath10 is the electron fraction defined to be the net electron number ( electrons minus positrons ) per baryon .",
    "@xmath11 is the external force on the fluid ( e.g. , gravitational force ) .",
    "@xmath12 , @xmath13 , and @xmath14 are the monochromatic radiation energy density , radiation flux , and radiation pressure tensor at frequency @xmath15 , measured in the comoving fluid frame , respectively .",
    "the speed of light is denoted by @xmath16 .",
    "the absorption coefficient is denoted by @xmath17 , and the total interaction coefficient including conservative scattering is given by @xmath18 .",
    "the emission coefficient is denoted by @xmath19 . for photon radiation @xmath20",
    "is zero , whereas for neutrinos @xmath20 is given by @xmath21 where @xmath22 is the baryon mass , @xmath23 is the planck constant , and @xmath24 for @xmath25 neutrinos , @xmath26 for @xmath27 neutrinos , and @xmath28 for other flavor neutrinos .",
    "also note that for neutrino radiation with multiple species , the integrals over frequency imply summation over the species .",
    "the colon product @xmath29 in @xmath30 indicates contraction over two indices as follows , @xmath31    the system of the radiation hydrodynamics ( equations [ eq : drhodt][eq : denudt ] ) is closed by an equation of state ( eos ) for matter , the diffusion approximation for radiation flux , and a closure relation for radiation that computes the radiation pressure tensor from radiation energy density and radiation flux . in the fld approximation @xcite ,",
    "the monochromatic radiation flux is written in the form of fick s law of diffusion , @xmath32 where @xmath33 is the flux limiter at frequency @xmath15 .",
    "we have implemented a variety of choices for the flux limiter ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "for example , one form of the flux limiter in @xcite is @xmath34 where @xmath35 in the optically thick limit , @xmath36 , @xmath37 , and the flux approaches the classical eddington approximation @xmath38 . in the optically thin limit , @xmath39 , @xmath40 , and @xmath41 as expected for streaming radiation . for the radiation pressure tensor",
    ", we use an approximate closure @xcite @xmath42 where @xmath43 is the scalar eddington factor , @xmath44 is the identity tensor of rank 2 , and @xmath45 .",
    "there are other choices for the scalar eddington factor .",
    "for example , @xcite has suggested @xmath46 note that in the optically thick limit , @xmath47 , and in the optically thin limit , @xmath48 .    using the fld approximation and the approximate closure",
    ", the equations of the radiation hydrodynamics now become @xmath49      to numerically solve equations ( [ eq : fdrhd - rho])([eq : fdrhd - enu ] ) , we first discretize the system in frequency space by dividing the radiation into @xmath50 energy groups .",
    "we define the radiation energy density in each group as @xmath51 where @xmath52 and @xmath53 are the frequency at the lower and upper boundaries , respectively , for the @xmath54-th group . for clarity , @xmath55 is denoted by @xmath56 hereafter .    in the multigroup methods , various group mean",
    "coefficients are introduced to the system .",
    "for example , the rosseland mean interaction coefficient is defined as @xmath57 where @xmath58 . in this paper",
    ", we will simply assume that @xmath59 where @xmath60 is the representative frequency for the @xmath54-th group .",
    "our simple treatment of group mean coefficients is sufficient for the transport of continuum radiation . in particular",
    ", it is sufficient for neutrino transport in the core - collapse supernova problem because the monochromatic opacities and emissivities of neutrinos are smooth functions of neutrino frequency .",
    "it should , however , be emphasized that our algorithm for radiation hydrodynamics does not rely on the simple treatment of group mean coefficients used in this paper .",
    "we also assume that the flux limiter is approximately independent of frequency within each group , and denote the flux limiter and the scalar eddington factor for the @xmath54-th group as @xmath61 and @xmath62 , respectively . as for the emissivity , we define @xmath63 where @xmath64 is the group width .",
    "however , in the case of photon radiation , we have adopted the polylogarithm function based method of @xcite for computing the group - integrated planck function .",
    "thus , assuming local thermodynamic equilibrium , we have for photon radiation @xmath65 where @xmath66 .",
    "using these definitions and approximations , we obtain the multigroup radiation hydrodynamics equations @xmath67 } \\mathrm{d}\\nu -      \\frac{3f_g-1}{2 } e_g \\hat{{\\mbox{\\boldmath$n$}}}\\hat{{\\mbox{\\boldmath$n$ } } } : \\nabla { \\mbox{\\boldmath$u$ } } , \\nonumber\\end{aligned}\\ ] ] where @xmath68 , @xmath69 , @xmath70 denotes @xmath71 .",
    "the system of multigroup radiation hydrodynamics ( equations [ eq : mgrhd - rho][eq : mgrhd - eg ] ) , similar to the system of gray radiation hydrodynamics we have studied in paper ii , has a hyperbolic subsystem , @xmath72 where @xmath68 .",
    "since @xmath10 is just an auxiliary variable that does not alter the characteristic wave speeds of the hyperbolic subsystem , we will neglect it in the remainder of this subsection for simplicity .",
    "gravitational force terms are source terms , and thus they are not included in the following analysis . the term @xmath73e_g \\hat{{\\mbox{\\boldmath$n$}}}\\hat{{\\mbox{\\boldmath$n$ } } } : \\nabla { \\mbox{\\boldmath$u$}}$ ] in equation  ( [ eq : mgrhd - eg ] ) is not included in the analysis of the hyperbolic subsystem here even though it becomes comparable to the term @xmath74 e_g { \\mbox{\\boldmath$u$}}\\}$ ] in equation  ( [ eq : hyper - eg ] ) in the streaming limit where @xmath75 . the first reason for not including the term is that the main purpose of including radiation in the hyperbolic subsystem is to improve the accuracy in the optically thick limit where the radiation can affect the hydrodynamics significantly .",
    "the term @xmath73e_g \\hat{{\\mbox{\\boldmath$n$}}}\\hat{{\\mbox{\\boldmath$n$ } } } : \\nabla { \\mbox{\\boldmath$u$}}$ ] is not significant in the optically thick limit where @xmath76 .",
    "the second reason is that in the streaming limit , where @xmath77 , radiation force has little impact on the motion of matter .",
    "thus , radiation is essentially decoupled from the hydrodynamics of matter in the streaming limit . moreover , in the streaming limit the diffusion term @xmath78 $ ] ( equation  [ eq : mgrhd - eg ] ) will dominate the term @xmath73e_g \\hat{{\\mbox{\\boldmath$n$}}}\\hat{{\\mbox{\\boldmath$n$ } } } : \\nabla { \\mbox{\\boldmath$u$}}$ ] and all the terms in equation  ( [ eq : hyper - eg ] ) .",
    "therefore , the term @xmath73e_g \\hat{{\\mbox{\\boldmath$n$}}}\\hat{{\\mbox{\\boldmath$n$ } } } : \\nabla { \\mbox{\\boldmath$u$}}$ ] is insignificant in both the diffusion limit and the streaming limit .    in castro",
    ", we solve the hyperbolic subsystem with a godunov method , which utilizes a characteristic - based riemann solver ( see   [ sec : explicit ] for details ) .",
    "the godunov method requires that we analyze the mathematical characteristics of the hyperbolic subsystem . for simplicity ,",
    "let us consider the system in one dimension , which can be written in terms of primitive variables as , @xmath79 where the primitive variables are @xmath80 and the jacobian matrix is @xmath81 where @xmath82 is the adiabatic index of the matter .",
    "this system is hyperbolic because the jacobian matrix is diagonalizable with @xmath83 real eigenvalues , @xmath84 here @xmath85 is the radiation modified sound speed , where @xmath86 is the sound speed without radiation and @xmath87 ( \\lambda_g e_g / \\rho)}$ ] is the contribution to the sound speed from each group .",
    "the corresponding right eigenvectors are , @xmath88 and the corresponding left eigenvectors are , @xmath89 where @xmath90 these @xmath83 eigenvectors define the characteristic fields for the one - dimensional system . by computing the product of the right eigenvectors and the gradients of their corresponding eigenvalues @xcite , we find that the first and second fields are genuinely nonlinear corresponding to either a shock wave or a rarefaction wave .",
    "the rest of the fields are linearly degenerate corresponding to a contact discontinuity in either density or radiation energy density of one group moving at a speed of @xmath91 .",
    "note that there is also a jump in fluid pressure such that the total pressure , @xmath92 , is constant across the contact discontinuity . obviously , in three dimensions , there are two additional contact discontinuities for transverse velocities just like the case of pure hydrodynamics .",
    "the integrals in equation  ( [ eq : mgrhd - eg ] ) form the following system , @xmath93 \\mathrm{d}\\nu ,   \\label{eq : fspace}\\ ] ] which can also be written in the conservation law form @xmath94 where @xmath95 and @xmath96 ( \\nabla \\cdot { \\mbox{\\boldmath$u$ } } ) - [ ( 3f-1)/2 ] \\hat{{\\mbox{\\boldmath$n$}}}\\hat{{\\mbox{\\boldmath$n$ } } } : \\nabla { \\mbox{\\boldmath$u$}}$ ] . here",
    "we have used equation  ( [ eq : egdef ] ) .",
    "equation  ( [ eq : fsp - e ] ) describes the advection of @xmath97 in logarithmic frequency space with an advection speed of @xmath98 . because @xmath99 is the integrated radiation energy , the system conserves energy .",
    "various terms in equation  ( [ eq : mgrhd - eg ] ) have been split between the hyperbolic subsystem (   [ sec : hyper ] ) and the system for the advection in the frequency space (   [ sec : fspace ] ) .",
    "there is however another way to look at equation  ( [ eq : mgrhd - eg ] ) .",
    "the evolution of the radiation energy density ( equation  [ eq : mgrhd - eg ] ) without the diffusion term @xmath100 $ ] and the source - sink term @xmath101 can also be split as @xmath102 .",
    "\\label{eq : fspace2}\\end{aligned}\\ ] ] equation  ( [ eq : fspace2 ] ) also represents an advection in logarithmic frequency space and can be written in the form @xmath103 where @xmath104 . here",
    "the conserved quantity is the number of radiation particles ( i.e. , @xmath105 ) .",
    "this new way of splitting will be further discussed later in section  [ sec : explicit ] .",
    "the parabolic part of the system consists of the radiation diffusion and source - sink terms , which were omitted from the discussion of the hyperbolic subsystem (   [ sec : hyper ] ) and advection in frequency space (   [ sec : fspace ] ) , @xmath106 where @xmath8 is the specific internal energy of the fluid , and @xmath107 .",
    "the term @xmath108 represents the energy exchange in the comoving frame between the matter and the @xmath54-th radiation group through absorption and emission of radiation .",
    "note that the terms on the right - hand side ( rhs ) of equations  ( [ eq : drhoe - i ] ) , ( [ eq : dye - i ] ) , and ( [ eq : deg - i ] ) all contain the speed of light @xmath16 .",
    "thus these are order @xmath109 terms in @xmath110 .",
    "an implicit treatment for these equations is usually necessary because of their stiffness . for photon radiation ,",
    "equation  ( [ eq : dye - i ] ) is not needed .",
    "castro uses a nested hierarchy of logically - rectangular , variable - sized grids with simultaneous refinement in both space and time .",
    "the amr algorithms for hyperbolic and radiation diffusion equations in castro have been described in detail in papers i and ii , respectively .",
    "the multigroup solver does not require any changes in the amr algorithms .",
    "thus , we will not describe them again in this paper .    in this section ,",
    "we describe the single - level integration scheme . for each step at a single level of refinement ,",
    "the state is first evolved using an explicit method for the hyperbolic subsystem ( equations  [ eq : hyper - rho][eq : hyper - eg ] ) and advection in frequency space (   [ sec : explicit ] ) .",
    "then an implicit update for radiation diffusion and source - sink terms is performed (   [ sec : implicit ] ) . in   [ sec : accel ] , we describe two acceleration schemes for speeding up the convergence rate of the implicit solver for multigroup radiation diffusion equations .      the hyperbolic subsystem (   [ sec : hyper ] ) is treated explicitly .",
    "our godunov algorithm for the hyperbolic subsystem of the multigroup radiation hydrodynamics is an extension of the hyperbolic solver for the gray radiation hydrodynamics presented in paper ii , which in turn is based on the hydrodynamics algorithm presented in paper i of this series .",
    "we refer the reader to papers i and ii for a detailed description of the integration scheme , which supports a general equation of state , self - gravity , nuclear reactions , the advection of nuclear species and electron fraction . here",
    "we will only present a brief overview of the godunov scheme .",
    "the time evolution of the hyperbolic subsystem can be written in the form @xmath111 where @xmath112 denotes the conserved variables , and @xmath113 is their flux .",
    "the conserved variables are defined at cell centers .",
    "we predict the primitive variables , including @xmath4 , @xmath5 , @xmath6 , @xmath114 , @xmath115 , where @xmath68 , from cell centers at time @xmath116 to edges at time @xmath117 and use an approximate riemann solver to construct fluxes , @xmath118 , on cell faces .",
    "this algorithm is formally second order in both space and time .",
    "the time step is computed using the standard courant - friedrichs - lewy ( cfl ) condition for explicit methods , and the sound speed used in the computation is now the radiation modified sound speed @xmath119 ( equation  [ eq : cs ] ) .",
    "the time step is also limited by maximally allowed changes in temperature and electron fraction in the implicit solver .",
    "additional constraints for the time step are applied if additional physics , such as burning , is included .",
    "castro solves the hyperbolic subsystem of radiation hydrodynamics with an unsplit piecewise parabolic method ( ppm ) with characteristic tracing and full corner coupling @xcite .",
    "an approximate riemann solver based on the riemann solver of @xcite and @xcite , that utilizes the eigenvectors of the system , is used to compute the godunov states and fluxes at the cell interface .",
    "advection in frequency space (   [ sec : fspace ] ) can also be treated explicitly because its time scale is comparable to that of the hyperbolic subsystem .",
    "one approach is to adopt an operator - splitting method and to evolve equation  ( [ eq : fsp - e ] ) with a godunov method .",
    "this is the approach taken by @xcite in the crash code for photon radiation .",
    "the term @xmath73e_\\nu \\hat{{\\mbox{\\boldmath$n$}}}\\hat{{\\mbox{\\boldmath$n$ } } } : \\nabla { \\mbox{\\boldmath$u$}}$ ] can be treated as a source term of equation  ( [ eq : fsp - e ] ) .",
    "the success of this approach for a number of test problems has been demonstrated by @xcite .",
    "we have also found that this approach can produce satisfactory results for all the photon test problems in section  [ sec : tests ] .",
    "however , we have found that erroneous results were obtained for core - collapse supernova simulations (   [ test - n ] ) , probably due to operator - splitting errors .",
    "one difficulty in core - collapse supernova simulations is that the divergence of velocity can be significant because there is a strong shock and the typical velocity in front of the shock is @xmath120@xmath121 . in the case of core - collapse supernovae ,",
    "the negative divergence of velocity will shift neutrinos towards high frequency ( equation  [ eq : fsp - e ] ) .",
    "the stronger conservative scattering at higher frequency can further amplify the neutrino energy density due to the work term @xmath122e_g\\}$ ] ( equation  [ eq : hyper - eg ] ) .",
    "these two processes can combine to cause unphysical results due to splitting errors .",
    "however , the origin of the various terms involved in these two processes is the term @xmath123 in equation  ( [ eq : denudt ] ) . to avoid operator - splitting errors ,",
    "it is therefore desirable to treat the term @xmath124 without splitting it .",
    "on the other hand , the term can also make significant contribution to the hyperbolic subsystem in the optically thick limit , and we do not wish to sacrifice accuracy of the hyperbolic subsystem by taking the traditional approach of leaving out radiation from the riemann solver for the hydrodynamics .    to avoid the operator - splitting without sacrificing the accuracy of the hyperbolic subsystem , we have adopted a new approach based on splitting the radiation energy density equation into equations  ( [ eq : eg2 ] ) and ( [ eq : fspace2 ] ) .",
    "note that the radiation diffusion and source - sink terms will be treated separately by an implicit solver (   [ sec : implicit ] ) .",
    "our new approach still utilizes the godunov scheme for the hyperbolic subsystem governed by equations  ( [ eq : hyper - rho])([eq : hyper - eg ] ) . after the godunov states and fluxes at the cell interfaces",
    "are obtained , all variables in the hyperbolic system except the radiation energy density are updated as usual . for the radiation energy density , two steps are taken .",
    "the radiation energy density is first updated according to equation  ( [ eq : eg2 ] ) with its rhs computed using the godunov states .",
    "then another godunov solver is used to evolve equation  ( [ eq : fsp - n ] ) , which is equivalent to equation  ( [ eq : fspace2 ] ) . the conversion between @xmath115 and @xmath12",
    "is performed according to @xmath125 .",
    "the godunov states at time @xmath117 of the first godunov solver are used in computing @xmath126 and @xmath127 to obtain the wave speed @xmath98 in the frequency space advection .",
    "the second godunov scheme for the frequency space advection is a standard approach based on the method of lines . for time",
    "integration we use the third - order total variation diminish runge - kutta scheme of @xcite .",
    "we use the piecewise linear method with a monotonized central slope limiter @xcite to reconstruct @xmath128 and @xmath98 in order to achieve high order in ( logarithmic frequency ) space .",
    "the reconstructed variables are used to compute the hlle flux @xcite .",
    "the frequency space advection has its own cfl condition for stability .",
    "since castro uses the hydrodynamic cfl condition with other additional constraints for the time steps , if necessary , subcycling in time is employed in order to satisfy the frequency space cfl condition .",
    "the implicit solver evolves the radiation and matter according to equations ( [ eq : drhoe - i ] ) , ( [ eq : dye - i ] ) , and ( [ eq : deg - i ] ) with the results of the explicit update (   [ sec : explicit ] ) as the initial conditions .",
    "our scheme is based on a first - order backward euler method .",
    "we solve the parabolic subsystem ( equations  [ eq : drhoe - i ] , [ eq : dye - i ] , and [ eq : deg - i ] ) iteratively via newton s method .",
    "we define @xmath129 where the @xmath130 superscript denotes the state following the explicit update , and @xmath68 .",
    "the desired solution is for @xmath131 , @xmath132 and @xmath133 to all be zero .",
    "we approach the solution by newton iteration , and in each iteration step we solve the following system @xmath134        ( { \\partial f_y}/{\\partial t})^{(k ) }        & ( { \\partial f_y}/{\\partial y_e})^{(k ) }        & ( { \\partial f_y}/{\\partial e_g})^{(k ) } \\\\[3pt ]        ( { \\partial f_g}/{\\partial t})^{(k ) }        & ( { \\partial f_g}/{\\partial y_e})^{(k ) }        & ( { \\partial f_g}/{\\partial e_g})^{(k ) }        \\end{array } \\right ]    \\left[\\begin{array}{c }        \\delta t^{(k+1)}\\\\        \\delta y_e^{(k+1)}\\\\        \\delta e_g^{(k+1 ) }        \\end{array}\\right ] = \\left[\\begin{array}{c }        - f_e^{(k)}\\\\        - f_y^{(k)}\\\\        - f_g^{(k ) }        \\end{array}\\right ] .",
    "\\label{eq : newton}\\ ] ] here @xmath135 , @xmath136 and @xmath137 , where the @xmath138 superscript denotes the stage of the newton iteration .",
    "the exact jacobian matrix in equation ( [ eq : newton ] ) is very complicated . for simplicity",
    ", we neglect the derivatives of the diffusion coefficient @xmath139 .",
    "this is a common practice in radiation transport , and does not appear to significantly degrade the convergence rate . with the approximate jacobian matrix , we can eliminate @xmath140 and @xmath141 from equation ( [ eq : newton ] ) and obtain the following equation for @xmath142 , @xmath143 \\\\     & +   \\theta_g    \\left[c \\sum_{g^{\\prime}}\\xi_{g^{\\prime}}\\left(\\kappa_{g^{\\prime } }        e_{g^{\\prime}}^{(k+1 ) } - j_{g^{\\prime } } \\right ) - \\frac{1}{\\delta t }      ( \\rho y_e^{(k ) } - \\rho y_e^{- } ) \\right ] .",
    "\\label{eq : mgdiff0 }   \\end{split}\\ ] ] to reduce clutter , we have dropped the @xmath138 superscript for @xmath61 , @xmath144 , @xmath145 , and @xmath146 . the newly introduced variables in equation ( [ eq : mgdiff0 ] ) are given by @xmath147 where @xmath148   , \\\\    \\eta_y = { } & \\frac{c\\delta t}{\\omega } \\left[c \\delta t",
    "\\sum_g      \\xi_g \\left(\\frac{\\partial j_g}{\\partial t } - \\frac{\\partial      \\kappa_g}{\\partial t } e_g^{(k ) } \\right ) \\right ] , \\\\    \\theta_t = { } & \\frac{c\\delta t}{\\omega } \\left [ \\rho \\frac{\\partial        e}{\\partial y_e } + c \\delta t \\sum_g         \\left(\\frac{\\partial j_g}{\\partial y_e } - \\frac{\\partial        \\kappa_g}{\\partial y_e } e_g^{(k)}\\right ) \\right ] , \\\\",
    "\\theta_y = { } & \\frac{c\\delta t}{\\omega } \\left[\\rho \\frac{\\partial        e}{\\partial t } + c\\delta t \\sum_g         \\left(\\frac{\\partial j_g}{\\partial t } - \\frac{\\partial      \\kappa_g}{\\partial t } e_g^{(k ) } \\right ) \\right ] , \\\\",
    "\\omega = { } & \\left[\\rho \\frac{\\partial        e}{\\partial t } + c\\delta t \\sum_g         \\left(\\frac{\\partial j_g}{\\partial t } - \\frac{\\partial      \\kappa_g}{\\partial t } e_g^{(k ) } \\right ) \\right ]        \\left[\\rho + c \\delta t      \\sum_g \\xi_g \\left(\\frac{\\partial j_g}{\\partial y_e } - \\frac{\\partial      \\kappa_g}{\\partial y_e } e_g^{(k)}\\right ) \\right ]    \\nonumber \\\\     & - \\left [ \\rho \\frac{\\partial        e}{\\partial y_e } + c \\delta t \\sum_g         \\left(\\frac{\\partial j_g}{\\partial y_e } - \\frac{\\partial        \\kappa_g}{\\partial y_e } e_g^{(k)}\\right ) \\right ]       \\left[c \\delta t \\sum_g      \\xi_g \\left(\\frac{\\partial j_g}{\\partial t } - \\frac{\\partial      \\kappa_g}{\\partial t } e_g^{(k ) } \\right ) \\right].\\end{aligned}\\ ] ] here all the derivatives are computed from the results of the previous newton iteration ( i.e. , the @xmath138 state ) .",
    "we now present our algorithm for solving equation ( [ eq : mgdiff0 ] ) , which is actually a set of @xmath50 equations coupled through the summation terms on the rhs of equation ( [ eq : mgdiff0 ] ) .",
    "the system is usually too large to be solved directly . instead",
    ", we solve it by decoupling the groups and utilizing an iterative method .",
    "note that the iteration here for solving equation ( [ eq : mgdiff0 ] ) is different from the newton iteration for solving the entire parabolic subsystem .",
    "the inner iteration here is embedded inside the outer newton iteration step . in our algorithm",
    ", we avoid the coupling by replacing the radiation energy density in the coupling terms with its state from the previous inner iteration .",
    "thus , each step of the inner iteration solves @xmath149 \\\\     & +   \\theta_g    \\left[c \\sum_{g^{\\prime}}\\xi_{g^{\\prime}}\\left(\\kappa_{g^{\\prime } }        e_{g^{\\prime}}^{\\ell } - j_{g^{\\prime } } \\right ) - \\frac{1}{\\delta t }      ( \\rho y_e^{(k ) } - \\rho y_e^{- } ) \\right ] .",
    "\\label{eq : mgdiff1 }   \\end{split}\\ ] ] where @xmath150 is the inner iteration index . here",
    ", we have dropped the @xmath151 superscript for @xmath152 and @xmath153 to reduce clutter .",
    "for the first inner iteration , the state of the previous inner iteration is set to the result of the previous outer iteration .",
    "the inner iteration for equation ( [ eq : mgdiff1 ] ) is stopped when the maximum of @xmath154 on the computational domain is below a preset tolerance ( e.g. , @xmath155 ) .",
    "castro can solve equations in the following canonical form ( paper ii ) @xmath156 where @xmath157 are cell - centered coefficients and @xmath158 , @xmath159 , and @xmath160 are centered at cell faces .",
    "we use the same approach for spatial discretization at the amr coarse - fine interface as in @xcite . for equation ( [ eq : mgdiff1 ] ) the @xmath159 and @xmath160",
    "coefficients are not used .",
    "the same canonical form works for cartesian , cylindrical , and spherical coordinates so long as appropriate metric factors are included in the coefficients and the rhs .",
    "castro uses the _ hypre _",
    "library @xcite to solve the linear system .",
    "when the numerical solution to equation ( [ eq : mgdiff0 ] ) is obtained via the inner iteration ( equation  [ eq : mgdiff1 ] ) , we update the matter and continue with the next outer iteration until convergence is achieved . using equation  ( [ eq : newton ] ) , we can obtain @xmath161 \\nonumber \\\\       & - \\theta_t\\left [      \\sum_g\\xi_g(\\kappa_ge_g^{(k+1 ) } - j_g ) - \\frac{\\rho        y_e^{(k ) } - \\rho y_e^-}{c\\delta t } \\right ] , \\label{eq : dt } \\\\",
    "\\delta y_e^{(k+1 ) } = { } & -\\eta_y \\left[\\sum_g(\\kappa_ge_g^{(k+1 ) } - j_g ) -      \\frac{\\rho e^{(k ) } - \\rho e^-}{c\\delta t } \\right ] \\nonumber \\\\       & + \\theta_y \\left [      \\sum_g\\xi_g(\\kappa_ge_g^{(k+1 ) } - j_g ) - \\frac{\\rho y_e^{(k ) } - \\rho        y_e^-}{c\\delta t } \\right].\\label{eq : dy}\\end{aligned}\\ ] ] thus we could update the matter temperature as @xmath162 and electron fraction as @xmath163 , and then compute the matter specific internal energy @xmath164 from @xmath165 and @xmath166 .",
    "however , the total energy ( radiation energy plus matter internal energy ) and lepton number would not be conserved in this type of updates .",
    "furthermore , our experience with this approach is that sometimes the update gives @xmath167 and @xmath10 that are out of the bounds of opacity and eos tables used in our core - collapse simulations and hence causes convergence issues .",
    "thus a different approach is taken in castro . to conserve the total energy and lepton number",
    ", we update the matter as follows , @xmath168 , \\label{eq : uprhoe}\\\\    \\rho y_e^{(k+1 ) } = { } & \\bar{\\theta } \\rho y_e^{(k ) } +    ( 1-\\bar{\\theta } ) \\rho y_e^- + \\bar{h } ( \\rho e^{(k ) } - \\rho    e^- ) \\nonumber \\\\    & + c\\delta t \\sum_g\\left[\\xi_g(\\kappa_ge_g^{\\ell+1 } - j_g ) -      ( \\bar{h } + \\bar{\\theta } \\xi_g ) ( \\kappa_ge_g^{\\ell } -      j_g)\\right ] , \\label{eq : uprhoye}\\end{aligned}\\ ] ] where @xmath169 , @xmath170 , @xmath171 , and @xmath172 .",
    "then we compute temperature @xmath165 and electron fraction @xmath166 from the newly updated @xmath173 and @xmath174 .",
    "we also compute the new absorption , scattering and emission coefficients using the new temperature and electron fraction . by updating the matter using equations ( [ eq : uprhoe ] ) and ( [ eq : uprhoye ] ) , the implicit algorithm conserves the total energy and electron lepton number regardless of the accuracy of the solution to the parabolic subsystem .",
    "the outer iteration for solving equations ( [ eq : drhoe - i ] )  ( [ eq : deg - i ] ) uses the following convergence criteria : @xmath175 , \\label{eq : crfe } \\\\",
    "|f_y^{(k+1)}| < { } & \\epsilon \\ , \\rho y_e^{(k+1 ) } , \\label{eq : crfy}\\end{aligned}\\ ] ] where @xmath176 is a small number such as @xmath177",
    ". we do not use the relative error of the matter specific internal energy @xmath8 because it may not accurately reflect the error since that @xmath8 can be shifted by an arbitrary amount .",
    "typically , the outer iteration is stopped only when all four conditions ( inequalities  [ eq : crt ]  [ eq : crfy ] ) are satisfied .",
    "but for problems with extremely high opacities , inequalities  ( [ eq : crfe ] ) & ( [ eq : crfy ] ) can be difficult to achieve , and only inequalities  ( [ eq : crt ] ) & ( [ eq : cry ] ) are used .",
    "we solve the multigroup diffusion equation ( equation  [ eq : mgdiff0 ] ) using an iterative method .",
    "the system of the multigroup radiation diffusion equations is coupled .",
    "each individual radiation group depends on the matter , which in turn depends on all radiation groups .",
    "when the coupling is strong ( e.g. , large opacity and small heat capacity ) and/or the time step is large , the convergence rate of the iterative method we have presented in   [ sec : inneriter ] can be very slow . to improve the convergence rate",
    ", we have extended the synthetic acceleration scheme of @xcite for photon radiation to neutrino radiation , and have developed two types of acceleration schemes .    [",
    "[ local - acceleration - scheme ] ] local acceleration scheme + + + + + + + + + + + + + + + + + + + + + + + + +    we define the error of radiation energy density after @xmath150 inner iterations as @xmath178 where @xmath179 is the exact solution of equation  ( [ eq : mgdiff0 ] ) and @xmath152 is the result of the @xmath150-th inner iteration via equation  ( [ eq : mgdiff1 ] ) . in our local acceleration scheme ,",
    "the spatial derivatives of @xmath180 are assumed to be zero .",
    "this is justified because the spatially constant limit corresponds to the most slowly convergent mode @xcite and our goal is to improve the convergence rate by curing the slowest decaying mode of the errors .",
    "using equations ( [ eq : mgdiff0 ] ) and ( [ eq : mgdiff1 ] ) , we derive an equation for the error in the @xmath54-th group , @xmath181 where @xmath182 eq .  [ eq : acc1 ] can be solved analytically , and gives @xmath183 where @xmath184 the improved solution is therefore @xmath185 the acceleration is placed after the convergence check for the inner iteration so that no unnecessary acceleration is applied to converged solutions .",
    "[ [ gray - acceleration - scheme ] ] gray acceleration scheme + + + + + + + + + + + + + + + + + + + + + + + +    the original acceleration scheme of @xcite utilizes a gray diffusion equation for errors .",
    "it is postulated that the normalized multigroup spectrum of the errors is given by the normalized equilibrium spectrum .",
    "note that our local acceleration scheme is based on the assumption of local equilibrium .",
    "therefore the spectrum defined as @xmath186 is postulated to be @xmath187 where @xmath188 is the solution of the local acceleration scheme ( equation  [ eq : local - a ] ) .",
    "substituting @xmath189 into eq .",
    "[ eq : mgdiff1 ] and summing over groups , we obtain @xmath190 where @xmath191 equation  ( [ eq : gray - a ] ) is in the canonical form that castro solves ( equation  [ eq : canon ] ) . the solution of the gray diffusion equation for error , @xmath192 , is used to obtain the improved multigroup solution @xmath193 we note again that the acceleration operation is placed after the convergence check for the inner iteration so that no unnecessary acceleration is applied to converged solutions .",
    "in this section we present detailed tests of the code demonstrating its ability to handle a wide range of radiation hydrodynamics problems .",
    "photon radiation problems are presented in section  [ test - p ] , whereas section  [ test - n ] shows neutrino radiation hydrodynamics simulations of core - collapse supernovae .",
    "note that not every term or equation in the full system of radiation hydrodynamics is included in every test .",
    "this allows various parts of the code to be tested separately .    a cfl number of 0.8 is used for these tests unless stated otherwise or a fixed time step is used . for photon radiation test problems ,",
    "no additional constraint is posed by the implicit solver . for core - collapse supernova simulations ,",
    "the time step is further constrained by limiting the estimated relative changes in temperature to less than 1% and the estimated absolute changes in electron fraction to less than 0.01 using the change rates from the previous time step , and in our simulations this only happens around the time of core bounce .",
    "the relative tolerances for both the outer and the inner iterations in the implicit update are @xmath155 .",
    "all convergence criteria for the outer iteration ( inequalities  [ eq : crt ]  [ eq : crfy ] ) are used except for the tests in sections  [ test : shocktube ] and [ test : hse ] with extremely high opacities . by default ,",
    "the radiation groups are uniform in logarithmic frequency space , and the representative frequency for the @xmath54-th group is @xmath194 . for amr simulations , the `` deferred sync ''",
    "scheme ( paper ii ) is used for flux synchronization between coarse and fine levels in the implicit solver .        in this problem",
    ", we simulate a linear multigroup diffusion test problem introduced by @xcite .",
    "this can test the multigroup diffusion part of the system @xmath195 to make the nonlinear system mathematically tractable , @xcite linearize the system using the following assumptions .",
    "first , the absorption coefficient is assumed to be proportional to @xmath196 , and the group - averaged absorption is given by @xmath197 where @xmath198 is a constant .",
    "second , radiation emission is assumed to obey wien s law rather than planck s law , and it is further modified so that @xmath199 t , \\label{eq : bg - lmd}\\ ] ] where @xmath200 is a fixed temperature .",
    "note that the group - integrated @xmath201 now has linear dependence on @xmath167 .",
    "finally , there is no scattering , and the diffusion is not flux limited . under these assumptions ,",
    "@xcite have obtained exact solutions for the linearized system .",
    "cccccc 0.00 & 0.0017 & 0.3209 & 0.51 & 4.8283 & 0.2585 + 0.20 & 0.0016 & 0.3220 & 0.52 & 1.8030 & 0.0232 + 0.40 & 0.0007 & 0.3460 & 0.53 & 1.0335 & 0.1495 + 0.46 & 0.0077 & 0.4095 & 0.54 & 0.7124 & 0.2330 + 0.47 & 0.0170 & 0.4443 & 0.60 & 0.3104 & 0.5469 + 0.48 & 0.0461 & 0.5136 & 0.80 & 0.5774 & 1.4067 + 0.49 & 0.2195 & 0.7169 & 1.00 & 1.3612 & 2.2413 + 0.50 & 0.0020 & 0.3712 & & &    the test we have simulated is the first problem in @xcite .",
    "we have set up the test using physical units rather than the dimensionless units of @xcite .",
    "the one - dimensional computational domain in physical units is @xmath202 , corresponding to @xmath203 in dimensionless units .",
    "we use a symmetry boundary condition at the lower boundary , and a marshak boundary with no incoming flux at the upper boundary ( i.e. , @xmath204 ) .",
    "the mass density is @xmath205 .",
    "the specific heat capacity of the matter at constant volume is @xmath206 .",
    "initially , the temperature is set to @xmath207 and @xmath208 , for @xmath209 and @xmath210 , respectively . here",
    ", @xmath211 is a dimensionless coordinate .",
    "the radiation energy density is initially set to zero everywhere .",
    "the constant @xmath198 is set to @xmath212 .",
    "the fixed temperature in the group - integrated radiation emission ( equation  [ eq : bg - lmd ] ) is @xmath213 , corresponding to @xmath214 in dimensionless units .",
    "we use 64 radiation groups with the lowest boundary at zero .",
    "the width of the first group is set to @xmath215 , corresponding to @xmath216 in dimensionless units , and the width of other groups is set to be 1.1 times the width of its immediately preceding group .",
    "the representative frequency for each group is set to @xmath217 , except that @xmath218 is set to @xmath219 for the first group .",
    "we have run a simulation with 2048 uniform cells .",
    "thus the dimensionless cell size is @xmath220 .",
    "the time step is fixed at @xmath221 , corresponding to @xmath222 in dimensionless units .",
    "no acceleration scheme is used in this test . figure  [ fig : sb ] shows the results after 200 steps . the comparison with the tabular data of @xcite",
    "is shown in table  [ tab : sb ] .",
    "relative errors are computed as @xmath223 and @xmath224 are the numerical and exact results , respectively .",
    "because the tabular data of the exact solution are located on the faces of numerical cells , averaging of the numerical data has been performed for the comparison .",
    "the results are in excellent agreement with the exact solution , and are comparable to the numerical results of @xcite .",
    "cccc 1/100 & 2/25 & 2.91e-3 & + 1/200 & 1/50 & 7.36e-4 & 2.0 + 1/400 & 1/200 & 1.90e-4 & 1.9 + 1/800 & 1/800 & 4.87e-5 & 2.0    cccc 1/50 , 1/100 & 4/25 , 2/25 & 3.58e-3 & + 1/100 , 1/200 & 1/25 , 1/50 & 1.05e-3 & 1.8 + 1/200 , 1/400 & 1/100 , 1/200 & 2.69e-4 & 2.0 + 1/400 , 1/800 & 1/400 , 1/800 & 6.82e-5 & 2.0    to assess the convergence behavior of our implicit scheme , we have performed a series of uniform - grid and amr simulations of the linear multigroup diffusion test problem with various resolutions .",
    "the initial setup is the same as above except for spatial resolution and time step .",
    "two levels are used in the amr runs with the dimensionless domain of ( 0.25,0.75 ) covered by the fine ( i.e. , level 1 ) grids . in the convergence study , when the spatial resolution changes by a factor of 2 from one run to another , we change the time step by a factor of 4 . because our implicit scheme is first - order in time and second - order in space , the expected convergence rate in the convergence study is second - order with respect to @xmath225 .",
    "tables  ( [ tab : uniform ] ) and ( [ tab : amr ] ) show the @xmath226-norm errors and convergence rate for the total radiation energy density on the dimensionless spatial domain of @xmath227 at the dimensionless time of 1 . here , the @xmath226-norm error of the total radiation energy density is computed as @xmath228 where @xmath229 is the numerical result for cell @xmath230 and @xmath231 is the `` exact '' solution obtained from a high - resolution uniform - grid simulation with @xmath232 and @xmath233 .",
    "the results of both uniform - grid and amr simulations demonstrate second - order convergence rate with respect to @xmath225 as expected . because only part of the domain in the amr runs is covered by fine grids , the amr runs have somewhat larger errors than the uniform - grid runs with the same resolution as the fine grids .",
    "@xcite have studied a nonequilibrium radiative transfer problem with a multigroup model , more specifically the picket - fence model .",
    "there are some special assumptions in this test problem . the volumetric heat capacity at constant volume is assumed to be @xmath234 , where @xmath167 is the matter temperature and @xmath235 is a parameter .",
    "the group - integrated planck function is assumed to be @xmath236 where @xmath237 is the radiation constant , and @xmath238 are parameters such that @xmath239 .",
    "it is also assumed that the absorption coefficient is independent of temperature and there is no scattering .",
    "@xcite have also defined dimensionless variables for convenience .",
    "the dimensionless spatial coordinate is defined as @xmath240 where @xmath241 is the coordinate in physical units , and @xmath242 the dimensionless time is defined as @xmath243 where @xmath244 is the time in physical units .",
    "the dimensionless variables @xmath245 for radiation energy density and @xmath246 for matter energy density are defined as @xmath247 where @xmath248 is a reference temperature . in this test problem",
    ", there is a constant radiation source that exists for a finite period of time @xmath249 on a finite range @xmath250 .",
    "@xcite have found analytic solutions to the problem for both transport and diffusion approaches .    here",
    ", we simulate the case c of @xcite by solving the multigroup diffusion equations ( equations  [ eq : drhoe - mgd ] & [ eq : deg - mgd ] ) , and compare the results with the diffusion solution of @xcite .",
    "two radiation groups are used in this test , with @xmath251 .",
    "the absorption coefficients are set to @xmath252 and @xmath253 .",
    "thus , @xmath254 . the constant @xmath235 in the expression for volumetric heat capacity is set to @xmath255 .",
    "the reference temperature is chosen as @xmath256 .",
    "the parameters for the radiation source are @xmath257 , and @xmath258 .",
    "when @xmath259 , the radiation source deposits radiation energy to the region @xmath260 and increases the radiation energy density at a rate of @xmath261 for each group .",
    "the computational domain is @xmath262 covered by 1024 uniform cells .",
    "the lower boundary is symmetric , and the radiation energy density outside the upper boundary is set to zero .",
    "initially , there is no radiation and the temperature is zero . a fixed time step @xmath263 is employed . the explicit solver is turned off in the simulation , and the radiation flux is not limited .",
    "no acceleration scheme is used in this test .",
    "the numerical results are shown in figure  [ fig : so ] .",
    "our results are in excellent agreement with the analytic solution .",
    "@xcite found an analytic solution for the spectrum of a radiating sphere in a medium with frequency - dependent opacity .",
    "this test was used by @xcite to test their v2d code . in this test ,",
    "a hot sphere with a fixed temperature is surrounded by a cold static medium .",
    "the absorption coefficient is assumed to be zero , and the radiative transfer is due to coherent and isotropic scattering .",
    "thus , there is no radiation - matter coupling or group coupling .",
    "the time - dependent spectrum at a given place in the medium is therefore the superposition of the black - body spectrum of the medium and the spectrum of the radiation originated from the hot sphere .",
    "we perform this test in one - dimensional spherical geometry .",
    "the computational domain is @xmath264 and is covered by 128 uniform cells .",
    "the hot sphere has a fixed temperature of @xmath265 , and the medium is at @xmath266 .",
    "we use 60 energy groups covering an energy range of @xmath267 to @xmath268 .",
    "the group rosseland mean coefficient is assumed to be @xmath269 .",
    "the explicit solver is turned off .",
    "no acceleration scheme is used in this test .",
    "there is no outer iteration in the implicit solver because the matter properties do not change .",
    "the time step is fixed at @xmath270 .",
    "the spectrum at @xmath271 and @xmath272 is shown in figure  [ fig : radsphere ] .",
    "the numerical results are again in good agreement with the analytic solution .      in this one - dimensional problem ,",
    "the initial conditions of the matter are @xmath273 , @xmath274 , @xmath275 and @xmath276 , @xmath277 , @xmath278 , where @xmath279 stands for the left half , and @xmath280 the right half of the computational domain ( @xmath281 ) .",
    "the gas is assumed to be ideal with an adiabatic index of @xmath282 and a mean molecular weight of @xmath283 .",
    "initially , the radiation is assumed to be in thermal equilibrium with the gas ( i.e. , @xmath284 ) .",
    "the interaction coefficients are set to @xmath285 and @xmath286 .",
    "thus , due to the huge opacities , the system is close to the limit of strong equilibrium with no diffusion , and is essentially governed by equations ( [ eq : hyper - rho])([eq : hyper - eg ] ) with @xmath287 and @xmath288 .",
    "the parameters of this test problem are chosen such that neither radiation pressure nor gas pressure can be ignored .",
    "this test is adapted from the shock tube problem in paper ii . however , the adiabatic index of the gas is now @xmath282 rather than @xmath289 so that we can compare the numerical results with the exact solution of a pure hydrodynamic riemann problem .",
    "furthermore , although this is a one - temperature gray problem due to the huge opacity , the numerical calculation is performed with 16 radiation groups with the lowest and uppermost boundaries at @xmath290 and @xmath291 , respectively .",
    "we use 128 uniform zones in this test .",
    "the numerical results are shown in figure  [ fig : shocktube ] . also shown",
    "are the exact solutions of a pure hydrodynamic riemann problem corresponding to the numerical problem .",
    "the results show good agreement .",
    "we also note that our scheme is stable without using small time steps even though the system is in the `` dynamic diffusion '' limit @xcite with @xmath292 , where @xmath293 is the optical depth of the system . either the gray acceleration scheme or the local acceleration scheme (   [ sec : accel ] )",
    "must be employed in this test , otherwise the implicit solver , which is responsible for the thermal equilibrium between radiation and matter , exhibits extremely slow convergence .      in this test",
    ", we simulate the mach 5 shock problem of @xcite . in paper ii , we showed results computed with the gray radiation hydrodynamics solver . here , we present the numerical results obtained with the multigroup radiation hydrodynamics solver . in this test ,",
    "the one - dimensional numerical region @xmath294 initially consists of two constant states : @xmath295 , @xmath296 , @xmath297 and @xmath298 , @xmath299 , @xmath300 , where @xmath279 stands for the left , and @xmath280 the right of the point @xmath301 , respectively .",
    "the gas is assumed to be ideal with an adiabatic index of @xmath302 and a mean molecular weight of @xmath283 .",
    "the setup is the same as that in paper ii except that 16 radiation groups are used in this paper .",
    "the lowest and uppermost boundaries of the groups are at @xmath303 , and @xmath304 , respectively .",
    "initially , the radiation is assumed to be in thermal equilibrium with the gas ( i.e. , @xmath284 ) .",
    "the interaction coefficients are set to @xmath305 and @xmath306 , respectively .",
    "the states at spatial boundaries are held at fixed values .",
    "four refinement levels ( five total levels ) are used with a refinement factor of 2 with the finest resolution being @xmath307 . in this test",
    ", a cell is tagged for refinement if the second derivative of either density or temperature exceeds certain thresholds ( paper ii ) .",
    "the initial conditions are set according to the pre - shock and post - shock states of the mach 5 shock .",
    "after a brief period of adjustment , the system settles down to a steady shock .",
    "the simulation is stopped at @xmath308 .",
    "the results are shown in figure  [ fig : m5 ] .",
    "the agreement with the analytic solution including the narrow spike in temperature is excellent , except that the numerical results in the figure had to be shifted by @xmath309 in space to match the analytic shock position .",
    "this discrepancy in shock position is due to the initial transient phase as the initial state relaxes to the correct steady - state profile .",
    "no flux limiter is used in this calculation because the analytic solution of @xcite assumes @xmath310 .",
    "we again found that the implicit solver would fail to converge without an acceleration scheme .",
    "both the gray acceleration scheme and the local acceleration scheme (   [ sec : accel ] ) work in this test .      in paper ii",
    ", we performed a test of advecting a radiation pulse by the motion of matter with the gray radiation hydrodynamics solver ( see also * ? ? ?",
    ", we repeat the test with small changes to exercise the multigroup aspect of castro .",
    "the setup is the same as that in paper ii , except that the absorption coefficient @xmath17 in this paper is given by @xmath311 \\,\\mathrm{cm}^{-1}. \\label{eq : kappulse}\\ ] ] as in the test in paper ii , the initial temperature and density profiles are @xmath312 where @xmath313 , @xmath314 , @xmath315 , @xmath316 , the mean molecular weight of the gas is @xmath317 , and @xmath280 is the ideal gas constant . initially the radiation is assumed to be in thermal equilibrium with the gas .",
    "no flux limiter is used in this test ( i.e. , @xmath310 and @xmath318 ) .",
    "if there were no radiation diffusion , the system would be in an equilibrium with the gas pressure and radiation pressure balancing each other .",
    "because of radiation diffusion , the balance is lost and the gas moves .",
    "the purpose of this test is twofold .",
    "first , we use this test to assess the ability of the code to handle radiation being advected by the motion of matter .",
    "we solve the problem numerically in different laboratory frames .",
    "then we compare the case in which the gas is initially at rest to the case in which the gas initially moves at a constant velocity .",
    "another purpose is to assess the effect of group resolution .",
    "since the opacity is very large , the system is close to thermal equilibrium between radiation and matter .",
    "hence , the results of multigroup radiation hydrodynamics simulations should become increasingly close to those of a gray radiation hydrodynamics simulation as more groups are used .",
    "we have performed four runs : an unadvected run with 8 radiation groups , an advected run with 8 groups , an advected run with 64 groups , and an advected run using the gray radiation hydrodynamics solver presented in paper ii .",
    "the velocity in the unadvected run is initially zero everywhere , whereas in the advected runs it is @xmath319 everywhere . for",
    "the multigroup runs , the lowest and uppermost group boundaries are at @xmath304 and @xmath320 , respectively . in the gray simulation , the single group planck mean coefficient , @xmath321 , and rosseland mean",
    "coefficient , @xmath322 , of the opacity given by equation  ( [ eq : kappulse ] ) are @xmath323 the computational domain in all four runs is a one - dimensional region of @xmath324 with periodic boundaries .",
    "the numerical grid consists of 512 uniform cells .",
    "the simulations are stopped at @xmath325 .",
    "figure  [ fig : pulse ] shows the density , velocity , and temperature profiles for all four runs .",
    "the results of the advected runs have been shifted in space for comparison .",
    "the profiles from the unadvected 8-group run and the advected 8-group run are almost identical demonstrating the accuracy of our scheme in handling radiation advection by the motion of matter .",
    "this is expected because the velocity is significantly smaller than the speed of light ( @xmath326 ) .",
    "the results from the advected 64-group run and the gray run are also almost identical as expected .",
    "it is clear that the 8-group results differ from the gray results .",
    "this is not surprising because we did not perform group averaging for interaction coefficients ( equations  [ eq : kappa - g ] & [ eq : chi - g ] ) .",
    "we also show the relative differences in figure  [ fig : pulse - error ] .",
    "the relative difference of the advected 8-group run with respect to the unadvected 8-group run is computed as ( advected - unadvected ) / unadvected , and the relative difference of the 64-group run with respect to the gray run is computed as ( multigroup - gray ) / gray .",
    "the figure shows that the difference between the advected 8-group and unadvected 8-group runs is less than 0.03% everywhere , and the difference between the 64-group and gray runs is less than 0.1% everywhere .      in paper ii",
    ", we have demonstrated that the gray solver can maintain a perfect static equilibrium in multiple dimensions because the radiation pressure and the gas pressure are coupled in the riemann solver . here",
    ", we repeat the test using the multigroup solver .",
    "the setup is the same as that in paper ii .",
    "the initial conditions for radiation and matter are the same as those in the test of the advecting radiation pulse (   [ test : pulse ] ) except that the interaction coefficients are set to a very high value , @xmath327 .",
    "thus , almost no diffusion can happen , and the radiation and the matter are in perfect thermal equilibrium .",
    "we have performed a calculation on a two - dimensional cartesian grid of @xmath328 and @xmath329 with 512 uniform cells in each direction .",
    "the initial velocity is zero everywhere . for the initial setup , the coordinate @xmath330 in equation ( [ eq : pulse ] ) is replaced by @xmath331 .",
    "we use 16 radiation groups with the lowest and uppermost boundaries at @xmath304 and @xmath320 , respectively .",
    "figure  [ fig : pulse - hse ] shows the velocity profile at @xmath332 ( after about 6000 steps ) .",
    "the maximal velocity at that time is @xmath333 , which is about @xmath334 of the sound speed .",
    "such a small gas velocity indicates that the multigroup solver in castro can also maintain a perfect static equilibrium in multiple dimensions , as does the gray solver in castro .      in this section",
    ", we present core - collapse supernova simulations in 1d spherical and 2d cylindrical coordinates .",
    "newtonian gravity with a monopole approximation is used in the 2d simulation for simplicity , although castro has a multigrid poisson solver for gravity . in the simulations ,",
    "there are three neutrino species : electron neutrinos , @xmath25 , electron antineutrinos , @xmath27 , and @xmath335 which stands for a combined species representing @xmath335 , @xmath336 , @xmath337 , and @xmath338 .",
    "we use a tabular equation of state that provides thermodynamic quantities as a function of temperature , density , and electron fraction and was constructed from the @xcite mean - field table , augmented with photons and a general electron / positron equation of state , and extended down to @xmath339 .",
    "the opacities used are fully described in @xcite .",
    "they include 1 ) elastic scattering off nucleons , alpha particles , and the single representative heavy nucleus at the peak of the binding energy curve calculated by @xcite , and 2 ) charged - current absorption cross sections off nucleons and nuclei ( the latter using the approach of @xcite ) .",
    "the scattering and absorption cross sections off nucleons are corrected for weak magnetism and recoil effects , the form factor , electron screening , and ion - ion correlation effects on freedman scattering off nuclei are applied , and pair production by nucleon - nucleon bremsstrahlung and electron - positron annihilation ( and their inverses ) are included as sources ( and sinks ) .",
    "the sink terms of the latter do not include fermi blocking corrections by the neutrinos in the final state .",
    "inelastic neutrino - electron scattering is treated as elastic scattering .",
    "we present here a core - collapse supernova simulation in one - dimensional spherical coordinates .",
    "the initial model is based on a @xmath340 progenitor of @xcite .",
    "the computational domain for this run is @xmath341 .",
    "the simulation employs four refinement levels ( five total levels ) with 1024 zones on the coarsest level ( i.e. , level 0 ) and a resolution of @xmath342 on the finest level ( i.e. , level 4 ) .",
    "the amr refinement factor is 2 .",
    "the regions where the density is greater than @xmath343 , or the enclosed mass is greater than @xmath344 are refined to level 2 .",
    "in addition , cells on level @xmath150 will be refined to level @xmath345 if @xmath346 , @xmath347 , @xmath348 , or @xmath349 , where @xmath350 , @xmath351 is entropy in units of @xmath352 , and @xmath353 is the cell width on level @xmath150 .",
    "we use 40 energy groups for electron neutrinos with the first group at @xmath354 and the last group at @xmath355 .",
    "we use 32 energy groups for electron antineutrinos with the first and last groups at @xmath354 and @xmath356 , respectively . for @xmath335 , we use 40 energy groups with the first and last groups at @xmath354 and @xmath355 , respectively . the flux limiter of @xcite is used is this simulation . the local acceleration scheme is employed .",
    "the inner boundary is symmetric .",
    "an outflow boundary condition is used for the outer boundary in the explicit solver .",
    "the modified marshak boundary of @xcite with zero incoming flux is used for the outer boundary in the implicit solver .",
    "thus , the region outside the outer boundary is essentially treated as a vacuum , and the radiation diffuses into the vacuum .",
    "note that in the usual marshak boundary based on the classical diffusion theory , the flux at the boundary does not have the correct behavior in the streaming limit , and the issue has been fixed in the modified marshak boundary of @xcite by using flux limited diffusion .",
    "the simulation is carried out to 200 ms after core bounce .",
    "figure  [ fig : ss1d ] shows four snapshots of density , velocity , temperature , entropy , electron fraction , and net electron lepton fraction ( @xmath357 ) .",
    "the infall of the material due to gravity results in the increase of the central density until the core bounces . at bounce ,",
    "the density reaches @xmath358 at the core .",
    "a shock appears around bounce at @xmath359 .",
    "the electron and lepton fractions at bounce are @xmath360 and @xmath361 , respectively , at the core .",
    "the core temperature at bounce is @xmath362 .",
    "the core entropy at bounce is @xmath363 .",
    "these properties are in agreement with previous studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "in a recent study , @xcite have obtained @xmath364 , @xmath365 , @xmath366 , and @xmath367 for their model n - fullop at bounce , and @xmath368 , @xmath369 , @xmath370 , and @xmath371 for their model n - reduceop at bounce . except for @xmath372 ,",
    "the properties of our model at bounce are in between those in models n - fullop and n - reduceop of @xcite .",
    "figure  [ fig : ss1d ] shows a spike near the shock in the @xmath10 and @xmath357 profiles shortly after bounce ( see also * ? ? ?",
    "the spike of @xmath357 is caused by electron neutrinos leaking out of the shock .",
    "the absorption of some of those neutrinos by the pre - shock material results in a spike of @xmath10 . in the post - shock region , the minimal @xmath10 drops rapidly for the first few milliseconds after bounce due to electron capture ; it then becomes steady at @xmath373 .",
    "the velocity in some region behind the shock is positive for the first @xmath374 2 ms after bounce ; the maximum positive velocity reaches @xmath375 similar to the maximum positive velocity in @xcite .",
    "the maximum temperature in the shocked region increases rapidly to @xmath376 at @xmath377 after bounce ; it then decreases quickly as the shock expands outward in radius ; it increases again and reaches @xmath378 at 200 ms after bounce due to compression and deleptonization as matter settles onto the proto - neutron star . the evolution of the temperature , electron fraction and velocity profiles is in agreement with that in previous studies ( e.g. , * ? ? ?",
    "* ) .    in figure",
    "[ fig : rshock1d ] , we show shock radius as a function of time . for the first few milliseconds after bounce",
    ", the shock expands very rapidly in radius , and reaches @xmath379 .",
    "the peak shock radius reaches @xmath380 at @xmath381 after bounce .",
    "after that the shock slowly shrinks in radius although it continues to grow in mass .",
    "the comoving frame luminosities of @xmath25 , @xmath27 , and @xmath335 neutrinos measured at 500 km are shown in figure  [ fig : l1d ] . in agreement with previous studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , there is a small dip in @xmath382 after the initial rise .",
    "the dip is followed by a large pulse in @xmath382 that reaches @xmath383 at 4 ms after bounce .",
    "the full width at half maximum for @xmath382 is @xmath384 .",
    "the peak @xmath382 in our model is about 20% larger than that in @xcite . in our results",
    ", there is also a noticeable spike in @xmath385 .",
    "note that @xcite have obtained somewhat similar spikes in their simulations that did not include inelastic scattering .",
    "the lack of inelastic scattering of neutrinos on electrons results in harder neutrino spectra , especially for @xmath335 , as shown in the rms average energies ( figure  [ fig : erms1d ] ) . here",
    "the rms average is defined as @xmath386^{1/2},\\ ] ] where @xmath387 is the neutrino energy and @xmath388 is the monochromatic neutrino number density .",
    "nevertheless we obtain @xmath389 after the initial phases , as expected . at 200",
    "ms after bounce , we obtain @xmath390 , @xmath391 , and @xmath392 . the luminosity spectra measured at 500 km in the comoving",
    "are shown figure  [ fig : spectra1d ] .",
    "the spectra are evidently harder than those in @xcite because inelastic scattering is not included in our model .      here",
    "we present a two - dimensional core - collapse supernova simulation .",
    "the computational domain for this 2d cylindrical run is @xmath393 and @xmath394 .",
    "two refinement levels ( three total levels ) with a refinement factor of 4 are used .",
    "the coarsest level has 256 and 512 cells at @xmath395-direction and @xmath241-direction , respectively .",
    "thus the size of the cells on the finest level is about @xmath396 .",
    "the same refinement criteria as those in the 1d simulation in section  [ sec : ccsn1d ] are used .",
    "we use 20 , 16 , and 20 groups with logarithmic spacing for @xmath25 , @xmath27 , and @xmath335 , respectively .",
    "the other aspects of this 2d run such as the outer boundary and flux limiter are the same as those in the 1d simulation in section  [ sec : ccsn1d ] .",
    "we start the 2d simulation from the result of a 1d simulation rather than the @xmath340 presupernova model .",
    "the initial model is obtained from the 1d simulation at about 10 ms before bounce . at that time",
    ", multi - dimensional effects are expected to still be small .",
    "the 1d simulation that provides the initial model for the 2d run has similar resolution as the 2d run .",
    "note that , other than resolution , the low - resolution 1d simulation here is essentially the same as the 1d high - resolution simulation in section  [ sec : ccsn1d ] .",
    "figure  [ fig : c2d1 ] shows the density , entropy , temperature , and electron fraction profiles at 1.5 ms after bounce .",
    "the profiles are still highly symmetric .",
    "spherically averaged profiles of density , velocity , temperature , entropy , electron fraction , and lepton fraction at 1.5 ms are shown in figure  [ fig : ss2d1 ] .",
    "also shown in figure  [ fig : ss2d1 ] are the results of the two 1d runs . at this point , the 2d results are only slightly different from the 1d results . however , in some region behind the shock , the gradient of entropy is negative .",
    "a negative entropy gradient region from @xmath397 to @xmath398 is also clearly visible in the entropy profile at 4.1 ms ( left panel of figure  [ fig : conv1 ] ) .",
    "the white and black contour lines in the left panel of figure  [ fig : conv1 ] denote @xmath399 and @xmath400 , respectively .",
    "convective instabilities can potentially develop in the region between @xmath401 and @xmath402 .",
    "in fact , convection does emerge quickly in our simulation . in the right panel of figure",
    "[ fig : conv1 ] , we show the entropy profile at 9.8 ms after bounce . also shown in the figure",
    "is the velocity field .",
    "high entropy plumes rise while some low entropy material falls down .",
    "secondary kelvin - helmholtz instabilities also develop in the shearing regions .",
    "the convection helps push the shock outwards because of the enhanced material energy transport from the inner hot region to the region behind the shock by the convective motion .",
    "figure  [ fig : c2d2 ] shows the density , entropy , temperature , and electron fraction profiles at 20 ms after bounce .",
    "the shock has moved to @xmath403 at 20 ms in the 2d simulation ( see also figure  [ fig : rshock2d ] ) . at 40 ms after bounce , the north pole and the south pole of the shock have moved to @xmath404 . in contrast , in the 1d simulation in section  [ sec : ccsn1d ] ( figure  [ fig : rshock1d ] ) , the shock radius is @xmath405 at 20 ms and it never exceeds @xmath406 .",
    "the comoving frame luminosities of @xmath25 , @xmath27 , and @xmath335 neutrinos measured at 500 km for the 2d simulation are shown in figure  [ fig : l2d ] .",
    "also shown in figure  [ fig : l2d ] are the results of the 1d low - resolution run , which are nearly identical to those of the 1d high - resolution results ( figure  [ fig : l1d ] ) . in the 2d results ,",
    "there is also a large narrow pulse in @xmath382 that rises and drops at roughly the same rate .",
    "however , after @xmath384 past bounce , the 2d results are qualitatively different from the 1d results because of the emergence of the convection .",
    "a major difference is that @xmath335 neutrinos are much less luminous in 2d than 1d , because the temperature in 2d is cooler than that in 1d due to the rapid expansion of 2d shock .",
    "since this paper is not on core - collapse supernova explosions per se , the 2d simulation is stopped at @xmath407 after bounce .",
    "a detailed analysis of the 2d simulation is beyond the scope of this paper on algorithm , implementation , and testing .",
    "in paper ii , we demonstrated that the gray radiation solver in castro has very good scaling behavior on up to 32768 cores via a weak scaling study .",
    "the multigroup radiation solver presented in this paper has similar good weak scaling behavior because the same module for solving equation  ( [ eq : canon ] ) is used in both solvers . here",
    "we present a strong scaling study that was carried out on hopper , a petascale cray xe6 supercomputer at the national energy research scientific computing center .",
    "we have performed a series of three - dimensional core - collapse supernova simulations in cartesian coordinates with the same resolution on various numbers of cores .",
    "a hybrid mpi / openmp approach with 6 openmp threads per mpi task was used for these simulations .",
    "pfmg , a parallel multigrid solver from _ hypre _",
    "@xcite , was used to solve the linear systems . in each run , we start the 3d simulation from the result of a 1d simulation at about 10 ms before bounce .",
    "we use 12 energy groups for each species ( @xmath25 , @xmath27 , and @xmath335 ) .",
    "the computational domain is a three - dimensional box with a size of @xmath408 in each dimension .",
    "three refinement levels ( four total levels ) are used with a refinement factor of 2 between level 0 and level 1 , and a refinement factor of 4 for other levels .",
    "the coarsest level has @xmath409 cells .",
    "the finest level , which approximately covers the inner region of @xmath410 , has a cell size of @xmath411 .",
    "figure  [ fig : scaling ] shows the wall clock time per coarse time step for a series of runs with the number of cores ranging from 1536 to 24576 . also shown in figure  [ fig : scaling ] is parallel efficient defined as @xmath412 where @xmath50 is the number of cores , @xmath413 is the wall clock time for the @xmath50-core run , @xmath414 is the number of cores in a baseline run ( i.e. , 1536-core run ) , and @xmath248 is the wall clock time for the baseline run . in this strong scaling study ,",
    "good scaling behavior is achieved on up to @xmath415 cores . however , because this is a strong scaling study , the work load per core diminishes as more cores are used .",
    "for example , the average number of cells for each core in the 24576-core run is about @xmath416 .",
    "an unfavorable consequence of small computational boxes is an increased communication overhead .",
    "another unfavorable consequence is that more computation is wasted at domain boundaries due to larger surface area to volume ratios of smaller boxes .",
    "hence , the degradation of parallel performance on more than 10000 cores is not surprising .",
    "in this paper , we have presented a multi - dimensional multigroup radiation hydrodynamics solver that is part of the castro code .",
    "block - structured amr is utilized in castro . in this paper , we focus attention on the single - level algorithms because the amr algorithms have been presented in papers i , ii , and references therein .",
    "our multigroup radiation hydrodynamics solver is based on a comoving frame formulation that is correct to order @xmath0 , and uses a fld approximation .",
    "our mathematical analysis shows that the system we solve contains a hyperbolic subsystem that is the usual hydrodynamics system modified by radiation , a frequency space advection part that accounts for the doppler shift of radiation due to the motion of matter , and a parabolic diffusion part .",
    "we have presented the mathematical characteristics of the hyperbolic subsystem .",
    "the eigenvalues and eigenvectors we have obtained are useful for characteristic - based godunov schemes .",
    "we also described our treatment of the frequency space advection part .",
    "an implicit solver involving two nested iterations is presented .",
    "we have also presented two acceleration schemes that improve the convergence rate of the implicit solver .",
    "extensive testing is presented demonstrating the accuracy and stability of castro to solve multigroup radiation hydrodynamics problems .",
    "we have presented a series of photon radiation test problems that cover a wide range of regimes .",
    "in addition to photon radiation problems , we have demonstrated the applicability of castro in core - collapse supernova simulations .",
    "recently , @xcite have argued , via a series of 1d simulations , that general relativistic effects and inelastic scattering of neutrinos on matter have significant effects on the numerical modeling of core - collapse supernova explosions .",
    "in contrast , @xcite have concluded that spatial dimensionality has far more impact than general relativistic effects or microphysics such as inelastic scattering .",
    "our 1d simulations are consistent with the assessment of @xcite on the effects of inelastic scattering .",
    "however , our 2d simulation supports the assessment of @xcite on the importance of spatial dimensionality .",
    "our simulations have shown that multidimensional effects ( e.g. , convective motion in the region behind the shock and exterior to the nascent neutron star ) appear less than 10 milliseconds after bounce , and 2d results are profoundly different from 1d results .",
    "thus , one should be cautious about assessment of various effects such as inelastic scattering that are based on 1d simulations that last several hundred milliseconds past bounce like the ones presented in @xcite .",
    "the main advantages of the castro code are the efficiency due to the use of amr and the accuracy due to the coupling of radiation force into the riemann solver .",
    "three - dimensional multigroup neutrino radiation hydrodynamics simulations of core - collapse supernovae with a good resolution using castro can be carried out , if not now , in the near future with faster computers . in the strong scaling study with a total of 36 radiation groups and a cell size of @xmath417 on the finest level ( section  [ sec : performance ] ) , it took about 0.8 hours to advance one coarse time step ( about @xmath418 ) on 12288 cores of hopper .",
    "thus , it would take 800 hours on 12288 cores of hopper to evolve to @xmath419 .",
    "admittedly , it is still very expensive to perform long - duration 3d simulations , but it is possible to study the first @xmath419 after bounce and investigate the development of turbulent convection region via 3d simulations .",
    "the work at lbnl was supported by the office of high energy physics and the office of advanced scientific computing research of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "the work performed at llnl was supported by the scidac program of the u.s .",
    "department of energy under the auspices of contract no.de-ac52-07na27344 .",
    "adam burrows was supported by the scidac program of doe under grant number de - fg02 - 08er41544 , the nsf under subaward no .",
    "nd201387 to the joint institute for nuclear astrophysics , and the nsf petaapps program , under award oci-0905046 via a subaward no .",
    "44592 from louisiana state university to princeton university .",
    "this research used resources of the national energy research scientific computing center , which is supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "the authors would like to thank s.e .",
    "woosley for many useful comments on the manuscript .",
    "falgout , r. , & yang ,",
    "u. 2002 , in lecture notes in computer science , vol .",
    "2331 , computational science  iccs 2002 , ed .",
    "p.  sloot , a.  hoekstra , c.  tan , & j.  dongarra ( springer berlin / heidelberg ) , 632641          graziani , f. 2008 , in lecture notes in computational science and engineering , vol .",
    "62 , computational methods in transport : verification and validation , ed . f.  graziani ( springer berlin heidelberg ) , 151167"
  ],
  "abstract_text": [
    "<S> we present a formulation for multigroup radiation hydrodynamics that is correct to order @xmath0 using the comoving - frame approach and the flux - limited diffusion approximation . </S>",
    "<S> we describe a numerical algorithm for solving the system , implemented in the compressible astrophysics code , castro . </S>",
    "<S> castro uses an eulerian grid with block - structured adaptive mesh refinement based on a nested hierarchy of logically - rectangular variable - sized grids with simultaneous refinement in both space and time . in our multigroup radiation solver , </S>",
    "<S> the system is split into three parts , one part that couples the radiation and fluid in a hyperbolic subsystem , another part that advects the radiation in frequency space , and a parabolic part that evolves radiation diffusion and source - sink terms . </S>",
    "<S> the hyperbolic subsystem and the frequency space advection are solved explicitly with high - order godunov schemes , whereas the parabolic part is solved implicitly with a first - order backward euler method . </S>",
    "<S> our multigroup radiation solver works for both neutrino and photon radiation . </S>"
  ]
}