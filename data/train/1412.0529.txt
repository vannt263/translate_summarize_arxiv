{
  "article_text": [
    "group discounts are offered by vendors to encourage consumers to use their services , to promote more efficient use of resources , to protect the environment , etc .",
    "examples include group tickets for museums , stadiums or leisure parks , discounted highway tolls or parking fees for high - occupancy vehicles , etc .",
    "it is common for the vendor to require all group members to identify themselves , but in reality this is seldom strictly necessary .",
    "we make the assumption that the important feature about the group is the _ number of its members _ , rather than their identities .",
    "a secondary feature that may often ( not always ) be relevant for a group discount is whether group members are physically together .    anonymously proving the number of group members and",
    "their being together is trivial in a face - to - face setting with a human verifier , who can see that the required number of people are present .",
    "however , with an automatic verifier and/or in an on - line setting , this becomes far from obvious .    in this paper",
    ", we propose a method to prove the number of people in a group while preserving the anonymity of group members and without requiring specific dedicated hardware , except for a computing device with some wireless communication capabilities ( _ e.g. _ nfc , bluetooth or wifi ) .",
    "also , we explore the option to include payment in our proposed system , which is necessary for group discounts .",
    "we complete the description of our method with a possible anonymous payment mechanism , _",
    "scratch cards_. the method presented here is a generalization of a specific protocol for toll discounts in high - occupancy vehicles , whose patent we recently filed  @xcite .",
    "the rest of the paper is structured as follows .",
    "section [ ab.sec.buildingblocks ] describes the building blocks of our method , namely a digital signature scheme , a key management scheme , an anonymous payment scheme and wireless communication technologies ; the latter technologies should be short - range in applications where one wants to check that the group members are physically together .",
    "section [ ab.sec.system ] describes our actual group size accreditation method , including the required entities and protocols .",
    "the security and the privacy of our proposal are analyzed in section  [ security ] . in section [ ab.sec.implementation ] ,",
    "we give a complexity estimation of our approach and describe precomputation optimizations .",
    "finally , section  [ ab.sec.conclusions ] summarizes conclusions and future work ideas .",
    "our group size accreditation method is based on an identity - based dynamic threshold ( _ ibdt _ ) signature scheme , namely a particular case of the second protocol proposed in  @xcite .",
    "threshold signature schemes are commonly based on @xmath0-threshold secret sharing schemes , such as the ones introduced in  @xcite and  @xcite , and they require a minimum number @xmath1 of participants to produce a valid signature .",
    "dynamic threshold signature schemes differ from the previous ones in that the threshold @xmath1 is not fixed during the setup phase , but is declared at the moment of signing .",
    "our method takes advantage of this feature to find out how many users participated in the signature of a particular message , and consequently how many people form a group . if one wishes to prove that the signature is not only computed by at least @xmath1 participants , but also that _ these are together in the same place _",
    ", the above signature schemes need to be complemented with short - range communication technologies .    on the other hand , identity - based public key signature schemes , theorized by shamir in  @xcite and with the first concrete protocol , based on the weil pairing , developed by boneh _",
    "_ in  @xcite , allow public keys @xmath2 to be arbitrary strings of some length , which we call _",
    "identities_. these strings are associated with a user @xmath3 and reflect some aspect of his identity , _",
    "e.g. _ his email address .",
    "the corresponding secret key @xmath4 is then computed by a trusted entity , the certification authority ( ca ) , taking as input the user s identity and , possibly , some secret information held only by the ca , and is sent to the user @xmath3 through some secure channel .",
    "identity - based public key signature schemes offer a great flexibility in key generation and management and our method takes advantage of this feature by proposing a key management scheme that allows preserving the anonymity of the participants .",
    "finally , in most group discounts , a fee must be paid after proving the number of group members , so an anonymous payment method is needed .",
    "indeed , this method should not reveal additional information about the group members to the service provider .",
    "we outline a general identity - based dynamic threshold signature scheme , namely the second protocol proposed in  @xcite .",
    "our protocol will be a slight modification of this general case ; we will point out differences when needed . a general _ ibdt _ signature scheme consists of the following five algorithms .",
    "[ ab.ibdtproto.setup ] * setup * is a randomized trusted setup algorithm that takes as input a security parameter @xmath5 , a universe of identities @xmath6 and an integer @xmath7 which is a polynomial function of @xmath5 and upper - bounds the possible thresholds ( _ i.e. _ @xmath7 is the maximum number of users that can participate in a threshold signature ) .",
    "it outputs a set of public parameters @xmath8 and a master key pair @xmath9 and @xmath10 .",
    "an execution of this algorithm is denoted as @xmath11    [ ab.ibdtproto.keygen ] * keygen * is a key extraction algorithm that takes as input the public parameters @xmath8 , the master key pair @xmath9 and @xmath10 , and an identity @xmath12 .",
    "the output is a private key @xmath13 .",
    "an execution of this algorithm is denoted as @xmath14    [ ab.ibdtproto.sign ] * sign * is a randomized signing algorithm that takes as input the public parameters @xmath8 , the master public key @xmath10 , a user s secret key @xmath13 , a message @xmath15 and a threshold signing policy @xmath16 where @xmath17 and @xmath18 .",
    "note that , in our case , @xmath1 will be strictly equal to @xmath19 .",
    "sign outputs a partial signature @xmath20 .",
    "we denote an execution of this algorithm as @xmath21    [ ab.ibdtproto.comb ] * comb * is a deterministic signing algorithm which takes as input the public parameters @xmath8 , the master public key @xmath10 , the secret key of the combiner user @xmath13 , a message @xmath22 , a threshold signing policy @xmath16 and a specific set @xmath23 of @xmath1 partial signatures .",
    "comb outputs a global signature @xmath24 .",
    "we denote the action taken by the signing algorithm as @xmath25    [ ab.ibdtproto.verify ] * verify * is a deterministic verification algorithm that takes as input the public parameters @xmath8 , a master public key @xmath10 , a message @xmath22 , a global signature @xmath24 and a threshold policy @xmath16 .",
    "it outputs @xmath26",
    "if the signature is deemed valid and @xmath27 otherwise . we denote an execution of this algorithm as @xmath28    for correctness , for any security parameter @xmath29 , any upper bound @xmath7 on the group sizes , any universe @xmath6 , any set of public parameters and master key pair @xmath30 , and any threshold policy @xmath16 where @xmath31 , it is required that for @xmath32 @xmath33 whenever the values @xmath8 , @xmath10 , @xmath9 have been obtained by properly executing the @xmath34 algorithm , @xmath35 , and for each @xmath36 , @xmath37 and @xmath38 .",
    "the anonymity provided by our accreditation method is a result of our key generation protocol and management solution . as we stated above ,",
    "identity - based public key cryptosystems allow using arbitrary strings as public keys . in our protocol ,",
    "every user @xmath39 is given an ordered list of public keys that depend on some unique identifier of the user , such as his national identity card number , his phone number , the imei number of his phone or a combination of any of them . we will call this identifier @xmath40 , where @xmath41 is the @xmath42-th",
    "last digit of @xmath43 and typically ranges from @xmath27 to @xmath44 .    to generate the list of public keys from an identifier @xmath43",
    ", we choose a value @xmath45 and take the @xmath46 last digits of @xmath43 .",
    "this results in a vector of public keys @xmath47 with every @xmath48 being an encoding of the digit and its position in @xmath43 , for example : @xmath49 where @xmath50 is the concatenation operation . to illustrate this process , imagine @xmath51 and @xmath52",
    ". the resulting public key list would be @xmath53    to prove the number of members in a group , the members will choose a common integer @xmath54 so that the @xmath42-th public key in their list , _ i.e. _ @xmath48 , is different for all of them",
    ". then they will perform the required operations with these public keys and their corresponding private keys . assuming that the values of the digits range from @xmath27 to @xmath44",
    ", this would provide anonymity to each of the users , since on average 10% of people will share the same public key @xmath48 for some value of @xmath42 .",
    "note that this approach limits the size of the groups that can be certified with our method to a maximum of 10 .",
    "moreover , intuition tells us that the closer the size of the group to this maximum size , the more difficult it becomes to find a value of @xmath42 for which each user has a different public key .",
    "the probability that our protocol fails depends on the number of keys each user is given , @xmath46 , and the size of the group @xmath7 ; more specifically for @xmath55 : @xmath56 that is very close to @xmath26 for values of @xmath7 close to @xmath57 .",
    "the limit on the maximum value of @xmath7 can be increased by assigning @xmath58 digits of @xmath43 to each of the @xmath46 public keys , instead of just one digit . by doing this",
    ", the maximum value for the size of the groups becomes @xmath59 , and the probability of failure , for values of @xmath60 , is    @xmath61 however , the price to be paid for choosing a larger @xmath62 is a loss of anonymity , since , if more digits are associated to each public key , less users share the same public key .",
    "for example , for @xmath63 a user would share each of his keys with only @xmath64 of the total number of users .",
    "the service provider will choose @xmath46 and @xmath62 depending on maximum number of keys that a user can store , the maximum allowed group size and the anonymity level to be guaranteed .",
    "group discounts are one of the applications of our method : after proving the group size , the group members must pay a fee that depends on that size .",
    "if proving the size has been done anonymously , it would be pointless to subsequently use a non - anonymous payment protocol ( such as credit card , paypal , etc . ) .",
    "hence , we need to use an anonymous payment mechanism along with our group size accreditation protocol .",
    "the simplest option for an anonymous payment method is to use cash if the application and the service provider allow it .",
    "unfortunately , this will not always be the case , and other payment methods have to be taken into account .",
    "electronic cash protocols such as  @xcite are good candidates for this role . nowadays",
    ", bitcoin  @xcite is a well - established electronic currency and , although it is not anonymous by design  @xcite , it can be a good solution if accompanied by careful key management policies .",
    "also , extensions of the original protocol as zerocoin  @xcite provide anonymity by design .    for completeness",
    ", we propose in this work to use a much simpler approach , based on prepaid scratch cards that users can buy at stores using cash ( for maximum anonymity ) .",
    "each such card contain a code @xmath65 which the service provider will associate with a temporary account holding a fixed credit specified by the card denomination .",
    "our accreditation method requires communication among the members of a group and between the members and some type of verifying device .",
    "if we want to prove not only that a group has a certain number of members , but also that these are together , the interactions with the verifying device must rely on short - range communication technologies , like nfc , bluetooth or wifi .    during the accreditation protocol",
    ", the users smartphones will be detected in some way by the verifying device and a communication channel will be established .",
    "the requirements and constraints of this process depend on the type of service and verifying devices , but nonetheless it is desirable that communication establishment be fast and not too cumbersome to the user .",
    "we propose to use bluetooth , and in particular _ bluetooth low energy _  @xcite to communicate with the verifying device .",
    "ble solves some of the main limitations of traditional bluetooth , _",
    "i.e. _ reduces detection and bonding times , requires much less work by the user than nfc and has a shorter range than both bluetooth and wifi , which is desirable in a method like ours .",
    "finally , ble is implemented by most major smartphone manufacturers , at least in recent models , unlike nfc .    regarding communication between the smartphones ,",
    "any of the three mentioned technologies , or a combination of them ( _ e.g. _ bluetooth pairing through nfc messages ) seems appropriate .",
    "the choice is up to the service provider .",
    "a service that implements our accreditation method includes the following elements :    * a service provider ( sp ) that publishes a smartphone application @xmath66 and distributes the necessary public parameters and keys of an _ ibdt _ signature scheme @xmath67 to users , after some registration process . * a smartphone application @xmath66 for each user @xmath3",
    "which : * * allows computing signatures with @xmath67 on behalf of @xmath3 ; * * allows computing ciphertexts with a public - key encryption scheme @xmath68 selected by sp , under sp s public key @xmath69 ; * * can be run on master or slave mode , which affects how @xmath66 participates in the accreditation protocol . *",
    "* includes some certificate which allows checking the validity of @xmath69 ; * * implements some communication protocol , relying in short - range communication technologies , such as nfc or bluetooth , to interact with the applications of the rest of the members of the group and with the verifying devices . * prepaid payment scratch cards available at stores .",
    "each card includes a code @xmath65 that the sp associates to an account with a fixed credit specified by the card denomination . *",
    "verifying devices installed at suitable places in the provider s infrastructures which : * * allow verifying signatures with @xmath67 ; * * hold the sp certificates as well as the keys needed to decrypt ciphertexts produced with @xmath68 under @xmath69 .",
    "* * have short - range communication capabilities and implement some protocol to communicate with the users devices . * some method to penalize or prevent the misuse of the system .",
    "the complete accreditation protocol runs as follows :    * system setup protocol . *    1 .",
    "sp chooses the user identifier to be used as @xmath70 and appropriate values for @xmath46 and @xmath62 .",
    "sp generates the parameters of the _ ibdt _ signature scheme @xmath67 as per algorithm @xmath71 ; 3 .",
    "sp generates the parameters of the public - key encryption scheme @xmath68",
    ".    * registration protocol . *    1 .",
    "a user @xmath3 with identifier @xmath70 authenticates himself to the service provider , face - to - face or by some other means .",
    "the user receives a pin code @xmath72 .",
    "2 .   the service provider associates to @xmath3 a vector of public keys of @xmath67 , @xmath73 as described in section  [ ab.subsec.keymgnt ] .",
    "3 .   the service provider computes the secret keys associated to @xmath73 as per algorithm @xmath74 : @xmath75 4 .",
    "the user downloads the smartphone application @xmath66 and , using the pin code @xmath72 , completes the registration protocol and receives the system parameters and keys , as well as the public key @xmath76 .",
    "* credit purchase . *    1 .   a user buys a prepaid card for the system , _",
    "e.g_. a scratch card , from a store . 2 .",
    "the card includes some code @xmath65 which has to be introduced in the smartphone application .",
    "[ ab.proto.gsetup ] * group setup protocol .",
    "*    1 .   some user @xmath77 , among the group of users @xmath78 who want to use the service , takes the leading role .",
    "this user will be responsible for most of the communication with the verifying device .",
    "@xmath77 sets his smartphone application to run in master mode and the others set it to work in slave mode .",
    "2 .   the users agree on a value @xmath79 such that the value of the @xmath42-th public key in @xmath73 is different for every user .",
    "* group size accreditation protocol.*[ab.proto.accr ]    1 .",
    "a verifying device detects the users devices and sends them a unique time - stamped ticket @xmath80 that may include a description of the service conditions and options .",
    "2 .   each user @xmath39 runs algorithm @xmath81 to compute a partial signature with @xmath67 under his secret key @xmath82 on message @xmath83 for the threshold predicate @xmath84 .",
    "it sends the resulting partial signature @xmath85 to @xmath86 .",
    "3 .   @xmath86 receives @xmath87 and runs algorithm @xmath88 to combine these signatures and output a final signature @xmath24 on behalf of @xmath89 .",
    "@xmath86 sends to the verifying device @xmath90 4 .",
    "the verifying device checks the validity of the signature by running @xmath91 note that this signature will only be valid if all users @xmath89 have collaborated in computing it , and thus it proves that the group of users is composed of at least @xmath1 people .",
    "if the signature is not valid , the group will be penalized in an application - dependent way , _",
    "e.g. _ with access denial , group discount denial , etc .",
    "otherwise , the service provider grants access to the group of users and tells the group the amount @xmath92 they have to pay depending on the group size .    * payment . *    1 .",
    "each group member @xmath3 in the ( sub)set @xmath93 of group members who want to collaborate in paying the bill sends to the verifying device via bluetooth or wifi his payment code encrypted under sp s public key : @xmath94 where @xmath95 is the code which user @xmath3 obtained from a prepaid scratch card and where @xmath96 is the public - key encryption algorithm of scheme @xmath68 .",
    "2 .   the verifying device decrypts the ciphertexts @xmath97 to obtain the payment codes of the users in @xmath93 .",
    "3 .   the verifying device substracts the quantity @xmath92 divided by the cardinal of @xmath93 to the accounts associated with the received payment codes .",
    "security and privacy are offered by design in our proposal :    * the chosen ibdt scheme ensures unforgeability of signatures under chosen message attacks even when an attacker can choose arbitrarily the threshold signing policy . in this case",
    ", this means that , for any @xmath98 , no group of less than @xmath1 buyers is able to deceive the service provider by producing a threshold signature with threshold @xmath1 .",
    "complete security proofs can be found in the original paper  @xcite . *",
    "no more than the pseudonyms and the number of participants of a group is revealed to the service provider during the execution of the protocol .",
    "buyer anonymity is guaranteed by the key management scheme described in section  [ ab.subsec.keymgnt ] _ within the community of buyers sharing the same public key_. for example , if each public key is associated to a combination of @xmath62 decimal digits , then on average this public key is shared by a community containing @xmath99 of the total number of users .",
    "* when payment is completely anonymous , whatever anonymity level achieved by key management is preserved after payment . for our given method ,",
    "this is ensured when a given @xmath65 can not be linked to a specific buyer .",
    "this can be achieved , for example , if the scratch card containing the @xmath65 is purchased using cash .",
    "our group size accreditation method is to be run by service providers , specialized verifying devices and the users smartphones .",
    "therefore , it is important that the computations of the underlying cryptographic protocol be as fast as possible , especially the algorithms that are executed by the smartphones , which have limited computational capabilities and rely on batteries .    in this section ,",
    "we analyze the performance of the underlying _ ibdt _ signature scheme .",
    "this scheme is a pairing - based cryptographic protocol and as such , the required operations are performed in elliptic curve groups .",
    "we analyze its performance by counting the number of point multiplications , point exponentiations and pairings , which are the most costly operations .",
    "table  [ ab.tab.ibdttimes ] shows the number of these operations for each of the algorithms in the _ ibdt _ signature scheme .",
    "the number of operations is counted as a function of the maximum number of possible participants in a signature , @xmath7 , and the size of the signing group @xmath1 . as we stated previously , @xmath100 .",
    ".operations required per algorithm [ cols=\"^,^,^,^ \" , ]",
    "we have presented a privacy - preserving mechanism for group discounts . the method is built upon an _ ibdt _ signature scheme , a concrete key generation and management solution , short - range communication technologies and anonymous payment mechanisms .",
    "our complexity analysis and initial tests show that the method is usable in practice .",
    "future work will consist of implementing the protocol , testing it and developing a generic app for privacy - preserving group discounts that can be easily customized for specific applications .",
    "the following funding sources are acknowledged : google ( faculty research award to the first author ) , government of catalonia ( icrea acadmia prize to the first author and grant 2014 sgr 537 ) , spanish government ( project tin2011 - 27076-c03 - 01 `` co - privacy '' ) , european commission ( fp7 projects `` dwb '' and `` inter - trust '' ) and templeton world charity foundation ( grant twcf0095/ab60 `` co - utility '' ) .",
    "the authors are with the unesco chair in data privacy .",
    "the views in this paper are the authors own and do not necessarily reflect the views of google , unesco or the templeton world charity foundation .",
    "a.  de  caro , v.  iovino , `` jpbc : java pairing based cryptography , '' _ computers and communication ( iscc ) , 2011 ieee symposium on _ , pp . 850855 , ieee , 2011 .",
    "available in http://gas.dia.unisa.it / projects / jpbc/.    j. domingo - ferrer , c. rfols and j. aragons - vilella , _ method and system for customized contactless toll collection in carpool lanes _",
    "( in spanish `` mtodo y sistema de cobro sin contacto , por el uso de una va , para vehculos de alta ocupacin '' ) , spanish patent ref .",
    "no : p201200215 .",
    "date filed : february 28 , 2012 .",
    "patent owner : universitat rovira i virgili ."
  ],
  "abstract_text": [
    "<S> we show how group discounts can be offered without forcing buyers to surrender their anonymity , as long as buyers can use their own computing devices ( _ e.g. _ smartphone , tablet or computer ) to perform a purchase . </S>",
    "<S> specifically , we present a protocol for privacy - preserving group discounts . the protocol allows a group of buyers to prove how many they are without disclosing their identities . coupled with an anonymous payment system , </S>",
    "<S> this makes group discounts compatible with buyer privacy ( that is , buyer anonymity ) . </S>",
    "<S> +   + * keywords : * buyer privacy , group discounts , cryptographic protocols , digital signatures </S>"
  ]
}