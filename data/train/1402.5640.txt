{
  "article_text": [
    "structure learning remains an important and challenging problem .",
    "often we seek to learn multiple graphs or _ networks _ @xmath0 that are expected to be related but that may be non - identical .",
    "for example in biomedical applications , multivariate data @xmath1 pertaining to the same biological process ( e.g. gene regulation or protein signaling ) may be obtained from multiple , related samples @xmath2 ( e.g. patients or laboratory models ) that are expected to be non - identical with respect to conditional independence structure @xcite . in such situations ,",
    "it is natural to consider joint learning that allows for information sharing between the inference problems indexed by @xmath2 .",
    "several techniques have been proposed for such joint structure learning , including bayesian techniques for graphical models @xcite and penalised likelihood estimators for gaussian graphical models ( gmms ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "these methods have been shown to improve estimation of individual graphs ( or networks , we use both terms interchangeably ) @xmath3 , especially in the regime where local sample sizes @xmath4 are not large .",
    "existing joint structure learning methods operate by shrinking estimated networks towards each other under an exchangeability assumption ( i.e. the @xmath5 are treated as exchangeable random variables ) .",
    "however , in practice , relationships between datasets @xmath1 ( and their underlying networks ) may be complex , e.g. hierarchical , with group and sub - group structure .",
    "for example , in biology , datasets from multiple species may be related according to a complex evolutionary history @xcite , while cells within a tumour are related according to their lineage within the tumour @xcite .",
    "similarly , in a data mining application , networks with nodes corresponding to products in an inventory @xcite may be arranged into groups and sub - groups based on market structure or region .",
    "this paper introduces a richer class of bayesian joint estimators known as structure learning trees ( slts ) that subsume previous exchangeable formulations whilst permitting more complex , non - exchangeable relationships between networks .",
    "an slt is a rooted tree @xmath6 whose vertices are themselves networks and whose edges describe relationships between the networks ( e.g. group and sub - group membership ) .",
    "the tree @xmath6 encodes possibly non - exchangeable relationships between networks that are exploited during joint structure learning . in this paper",
    "we restrict attention to the case where the tree @xmath6 can be reasonably specified _ a priori_. for example in biology , depending on the setting , established taxonomies such as phylogeny , tissue type , disease ( sub)-type etc .",
    "can be used to specify @xmath6 .",
    "such taxonomies are often supported by a wealth of experimental evidence , and it is therefore natural to leverage them for improved structure learning . in the case where @xmath6 may be uncertain , we provide empirical results that investigate the extent to which slt estimators are robust to @xmath6 misspecification .",
    "this paper is organised as follows : in section [ defs ] we introduce slts , generalising existing work on joint structure learning to the non - exchangeable setting .",
    "prior specification for slts is achieved by appealing to the intuitive notion that model constraints should be inherited along the edges of the tree .",
    "this heuristic allows specification of a default structural prior over all networks jointly that has essentially no user - set hyperparameters .",
    "section [ inference ] provides an exact belief propagation algorithm for inference of both data - generating and latent network structures , while section [ likelihood ] focuses on time series data and dynamic bayesian networks .",
    "empirical results on simulated data in section [ results 1 ] assess the performance of slts , including cases where the joint structural prior is misspecified .",
    "section [ results 2 ] shows results on proteomic time series data from multiple cancer cell lines that illustrate the use of slts in a topical application .",
    "finally we close with a discussion in section [ discussion ] .",
    "[ [ structure - learning - trees ] ] structure learning trees + + + + + + + + + + + + + + + + + + + + + + + +    we consider joint structure learning of multiple _ networks _",
    "@xmath7 , @xmath2 , that share the same _ vertex set _",
    "@xmath8 but may differ with respect to their _ edge sets _ @xmath9 .",
    "let @xmath10 denote the space of all networks over vertex set @xmath11 , up to restrictions associated with any particular model class ( e.g. acyclicity , undirected edges etc . ) .",
    "we define a _ structure learning tree _ @xmath12 as a rooted tree whose vertices are used and its corresponding network @xmath3 . ] to index individual networks @xmath3 , with all edges @xmath13 directed away from the root .",
    "examples of slts are displayed in figs .",
    "[ ex1 ] and [ panel ] .",
    "the root network is denoted by @xmath14 .",
    "existing methods for joint estimation ( see introduction ) can be regarded as a special case of the general slt where @xmath6 has a star topology with centre @xmath14 .",
    "[ [ latent - networks . ] ] latent networks .",
    "+ + + + + + + + + + + + + + + +    in classical structure learning , network structure is latent in the sense that it not directly observed .",
    "slts allow for further latency ; specifically we consider the situation in which data @xmath15 are available conditional upon only a subset @xmath16 of the networks of interest .",
    "the remaining nodes @xmath17 are _ doubly latent _ in the sense that neither they , nor data directly conditional upon them , are observed .",
    "latent nodes may be used to describe hidden ( e.g. group level ) structure ( as in our biological example in sec .",
    "[ results 2 ] ) .",
    "learning in an slt exploits relationships between networks as encoded in @xmath6 to allow joint estimation of _ all _ networks @xmath5 , whilst respecting non - exchangeable relationships between these networks .",
    "[ [ sec prior ] ] a default , subset prior .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    to formulate a joint statistical model we begin by placing a prior @xmath18 on the root network @xmath19 .",
    "henceforth @xmath20 represents the true ( unknown ) value of the network corresponding to @xmath2 whilst @xmath3 will be used to denote a possible structure for @xmath20 , and @xmath21 is a fixed `` prior network '' ( see below ) .",
    "then we define a joint structural prior over all networks @xmath22 that factorises along the edges of @xmath6 : @xmath23 previously proposed structural priors ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) could in principle be used to specify the conditional density @xmath24 .",
    "recent work on the joint estimation of multiple exchangeable networks has focused on boltzmann priors @xmath25 for some measure of distance @xmath26 @xcite and analogous penalised likelihoods @xcite .",
    "however , such priors can be difficult to specify in the exchangeable case @xcite and generalise poorly to the non - exchangeable case since each edge @xmath13 in principle introduces an associated hyperparameter @xmath27 .",
    "to control complexity of prior specification , we make use of the simple heuristic that network structure must be a subset of the structure of all network ancestors according to @xmath6 : @xmath28 here @xmath29 is the indicator function and @xmath30 provides multiplicity correction for varying @xmath31 ( see below ) . under eqn .",
    "[ model eq ] the prior @xmath18 encodes prior certainty that particular edges can not exist , in _ any _ network in @xmath22 .",
    "if the networks are interpreted as causal graphical models then @xmath21 describes a set of conditional independence assumptions .",
    "thus in our formulation , inferred causation is explicitly conditional on prior causal hypotheses @xmath21 @xcite .",
    "[ [ multiplicity - correction . ] ] multiplicity correction .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    multiplicity correction plays an important role in bayesian structure learning beyond the penalty on model complexity provided by the marginal likelihood .",
    "this is clearly illustrated in the context of variable selection , where a uniform prior over variable subsets has the undesirable property that the prior mass on all models with exactly one predictor goes to zero as the number of predictors grows large ; such a prior can not make sense in settings where one expects that a single predictor should have some reasonable prior mass .",
    "following @xcite we employ a binomial multiplicity correction @xmath32 where @xmath33 is the in - degree of vertex @xmath34 in @xmath35 . here",
    "@xmath36 represents a constraint on in - degree ; such constraints are widely used to facilitate inference in graphical models ( e.g. * ? ? ?",
    "[ [ inference ] ] marginal belief propagation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this section we describe how marginalisation and belief propagation combine to facilitate efficient , exact inference in slt models .",
    "taken together with a `` local '' likelihood @xmath37 , eqn .",
    "[ factors in slt ] defines a bayesian network on both discrete ( @xmath20 ) and possibly continuous ( @xmath38 ) variables ( sfig . [ model ] ) .",
    "efficient inference will require marginalisation of continuous variables ; for data @xmath39 we require that the `` marginal likelihoods '' @xmath40 are pre - computed and cached for all @xmath41 . here",
    "@xmath42 is a convenient shorthand for @xmath43 , the evidence for a particular topology @xmath44 , and @xmath38 are parameters required to specify the local data - generating model . for many models of interest , including dynamic bayesian networks ( see sec .",
    "[ likelihood ] ) , marginal likelihood may be computed in closed form by exploiting conjugate prior specifications .",
    "otherwise , monte carlo and related numerical techniques may be used to approximate marginal likelihood in more complex models ( e.g. @xcite ) .",
    "the marginalised slt ( sfig .",
    "[ marginal model ] ) is then a discrete bayesian network with respect to @xmath6 .",
    "a factor graph representation of the marginal slt model is shown in sfig .",
    "[ factor ] .",
    "exact inference over factor graphs can be achieved efficiently using belief propagation @xcite , provided the factor graph is acyclic . by restricting attention to tree structures @xmath6 in sec .",
    "[ defs ] we have guaranteed that the factor graph is acyclic",
    ". belief propagation therefore yields posterior distributions @xmath45 over structure for each @xmath2 .",
    "pseudocode for our approach is provided in supp .",
    "[ prop alg ] .",
    "[ [ model - averaging . ] ] model averaging .",
    "+ + + + + + + + + + + + + + + +    evidence in favour of an edge @xmath46 in a network @xmath20 is summarised by the posterior marginal inclusion probability obtained by averaging over all possible structures @xmath3 for @xmath20 : @xmath47 here @xmath48 contains all data .",
    "the subset constraints of eqn .",
    "[ model eq ] manifest in the posterior as @xmath49 whenever @xmath50 is a descendant of @xmath51 in @xmath6 .",
    "[ [ ffdbn - models . ] ] ffdbn models .",
    "+ + + + + + + + + + + + +    for graphical models and time series data we provide explicit formulae : we follow previous work by @xcite , adopting a `` feed - forward '' dynamic bayesian network ( ffdbn ) model for time series data . for clarity of notation",
    "we consider a specific fixed network @xmath35 , suppressing dependence upon @xmath2 .",
    "ffdbns prohibit contemporaneous edges ; this confers computational advantages ( see @xcite for full details ) .",
    "key features of ffdbns include ; ( i ) feedback can be explicitly modelled through time , ( ii ) the likelihood factorises over variables @xmath52 , reducing computational complexity ( see below ) , ( iii ) conjugate priors and closed form expressions for marginal likelihood are available , and ( iv ) experimental designs involving interventions may be integrated in line with a causal calculus @xcite .    in a ffdbn",
    "the value @xmath53 of variable @xmath34 at ( discrete ) time @xmath54 is dependent upon covariates @xmath55 $ ] .",
    "when multiple time series are available , the vector @xmath56 $ ] denotes the concatenated time series , with the subscript indexing a specific variable @xmath52 .",
    "we write @xmath57 for the parents of vertex @xmath34 in the network @xmath35 . in this paper we restrict attention to linear models that , for variable @xmath34 , may be expressed as @xmath58 where @xmath59 .",
    "the matrix @xmath60_{n \\times 2}$ ] contains a term for the initial time point in each series .",
    "the elements of @xmath61 corresponding to initial observations @xmath62 are simply set to zero .",
    "parameters @xmath63 are specific to variable @xmath34 and network @xmath35 . in the linear case the model - specific component @xmath61 of the design matrix consists of the predictors @xmath64 , where @xmath65 denotes the elements of the vector @xmath66 belonging to the set @xmath67 .",
    "[ [ intervention . ] ] intervention .",
    "+ + + + + + + + + + + + +    in sec . [ results ]",
    "we consider experimental designs that involve targeted intervention on vertices in the data - generating networks .",
    "we followed the approach described in @xcite to integrate interventional data in line with a causal calculus .",
    "specifically , for the type of intervention in the experimental data ( drug inhibition of kinases ) , using a `` perfect out fixed effects '' ( pofe ) approach ( we direct the interested reader to the reference for full details ) .",
    "this changes the network structure to model the intervention in line with the _",
    "do_-calculus @xcite and also includes a fixed effect @xmath68 in the regression model for @xmath69 , such that @xmath70 indicates whether or not intervention(s ) were used for each data - point .",
    "[ [ prior - specification . ] ] prior specification .",
    "+ + + + + + + + + + + + + + + + + + + +    we used a standard conjugate formulation for the linear model .",
    "specifically , we employed a jeffreys prior @xmath71 for @xmath72 over the common parameters .",
    "prior to inference , the non - interventional components of the design matrix were orthogonalised ( following * ? ? ?",
    "* ) using the transformation @xmath73 where @xmath74 .",
    "we then assumed a unit - information @xmath75-prior for regression coefficients @xcite , given by @xmath76 where @xmath77 .",
    "( when interventional designs are used , the pair @xmath78 are jointly assigned a @xmath75-prior . )    [ [ marginal - likelihood . ] ] marginal likelihood .",
    "+ + + + + + + + + + + + + + + + + + + +    with the above specification , the evidence in favour of @xmath57 can be obtained in closed - form : @xmath79 where @xmath80 , @xmath81 and @xmath77 .",
    "note that the left hand side of eqn .",
    "[ ml ] is an abuse of notation since dependence on covariates @xmath64 is suppressed ( a formal treatment is presented in @xcite ) .    [",
    "[ computation . ] ] computation .",
    "+ + + + + + + + + + + +    from the factorisation property of ffdbns , the total marginal likelihood is simply given by the product @xmath82 for ffdbns the parent sets @xmath57 ( @xmath83 ) are fisher - orthogonal ; computational complexity may therefore be significantly reduced by decomposing the slt into @xmath84 independent slts , each targeting one parent set @xmath57 .",
    "matlab r2013b code implementing our procedure is provided in the supplement .",
    "although we have focussed on ffdbns , our procedure applies to other classes of network models , such as bayesian networks and gaussian graphical models .",
    "the availability of explicit formulae for ffdbns motivates their use for the computational study presented below .",
    "to probe empirical performance of slts , we simulated data from a known tree @xmath6 and assessed ability to infer the true data - generating networks @xmath85 . in all experiments we placed @xmath86 edges uniformly at random to generate a root network @xmath19 subject to the in - degree constraint @xmath87 for all @xmath52 .",
    "two child networks @xmath88 were then generated , each containing @xmath84 edges drawn as described below .",
    "finally 10 networks @xmath89 were generated by sampling @xmath90 edges as described below .",
    "we use concatenated subscripts to uniquely identify nodes in @xmath6 ; for example @xmath91 corresponds to child 2 of network @xmath14 .",
    "existing joint structure learning methodologies require exchangeability of networks , while slt instead imposes a tree structure capturing non - exchangeable relationships .",
    "we considered 5 data - generating regimes designed to mimic various applied settings , including those in which the slt assumptions are violated :    1 .",
    "* disjoint sub - groups . *",
    "edges in each ( non - root ) network are drawn at random from the parent in @xmath6 , conditional upon the networks @xmath92 , @xmath93 having disjoint edge sets .",
    "this regime strongly violates the exchangeability assumption implicit in existing joint structure learning methodologies .",
    "weakly exchangable . * here networks @xmath92 , @xmath93 are generated independently , conditional upon @xmath19 , such that they are likely to share common edges .",
    "as above , all edges in each ( non - root ) network are drawn at random from the parent in @xmath6 . whilst exchangeability is violated , this regime ought to be more favourable to existing exchangeable estimators than regime ( 1 ) above .",
    "* fully exchangeable . *",
    "the networks @xmath94 are taken equal , rendering the networks @xmath89 fully exchangeable . in this regime slt should lack efficiency relative to exchangeable estimators .",
    "* misspecified tree .",
    "* this data - generating regime is equivalent to the disjoint sub - groups regime ( 1 ) , however the slt estimator is based not on the true data - generating tree , but rather on a tree @xmath95 uniformly sampled from the space of all trees .",
    "thus while the networks are non - exchangeable , the slt is misspecified with high probability .",
    "this mimics the scenario in which an _ a priori _ assumed tree is used that is in fact largely incorrect .",
    "* subset violation .",
    "* all edges in each ( non - root ) network are drawn such that 20% of edges in each child network are not edges in its parent network in @xmath6 . in this regime ,",
    "sub - groups exist among the networks , but the key assumption ( eqn .",
    "[ model eq ] ) of the parameter - free structural prior is violated with high probability .",
    "time series data @xmath96 of length @xmath97 were generated from each of the 10 networks @xmath89 according to a linear autoregressive process with interventions described in supp .",
    "[ sim set up ] .",
    "no data were made available on the networks @xmath98 , which are doubly latent .",
    "for all simulation experiments we fixed @xmath99 .",
    "the entire process was repeated 10 times .",
    "we compared slt to :    a.   non - joint network inference (  dbn \" ) , the default approach of carrying out structural inference using a ffdbn for each dataset @xmath96 independently . b.   joint network inference .",
    "this bayesian method is a special ( exchangeable ) case of our proposed slt methodology .",
    "hyperparameters were chosen according to the heuristics of @xcite .",
    "we note that alternative exchangeable estimators to ( b ) include @xcite and @xcite , but the former has not been adapted for time series data and heavy computational demands of the latter preclude systematic empirical comparison . to ensure fair comparison , the same in - degree restriction @xmath100 ( which includes the data - generating networks )",
    "was used for all methods . moreover , to prevent confounding by differing formulations of likelihood , we based each method on the same ffdbn likelihood ( as described in sec .",
    "[ likelihood ] ) .",
    "thus , all methods share the same basic time series formulation and differ only with respect to whether and how they share information between networks .",
    "no specific prior information was given regarding network topology , except for the tree structure @xmath6 ( in regimes 1 - 3,5 ) which was exploited by slt .",
    "0.32    0.32    0.32    we considered the thresholded network estimator , which consists of edges with marginal posterior inclusion probability ( eqn .",
    "[ mave ] ) @xmath101 .",
    "performance at sample size @xmath97 and density @xmath102 was quantified using metrics from classifier analysis ( see supp .",
    "[ metrics ] ) , averaged over all data - generating networks and all datasets .",
    "here we focus on the matthews correlation coefficient ( mcc ) , which is regarded as a balanced measure , suitable for use when the underlying class distribution is skewed . to quantify performance of the posterior inclusion probabilities themselves",
    ", we also considered the @xmath103 distance to the true data - generating networks .",
    "further details regarding performance measures ( including additionally aupr and auroc ) appear in supp .",
    "[ metrics ] .",
    "intuitively , slt should provide an advantage over jni when the data structure contains distinct sub - groups with respect to network topology .",
    "[ ex1 ] displays typical inferences in the `` disjoint sub - group '' regime ( 1 ) when @xmath104 , @xmath105 ; slt is noticeably sparser than jni and dbn whilst achieving high mcc ( fig .",
    "[ reg1 ] ) and essentially perfect precision ( sfig .",
    "[ sim res1 ] ) . as a consequence , over all sample sizes @xmath97 which we considered , slt is considerably closer than jni and dbn to the true network structures in the @xmath103 norm ( fig .",
    "[ reg1 ] ) .",
    "this ability to generate a clear decision boundary in the posterior is not demonstrated by jni and dbn , which produce less sparse matrices of posterior inclusion probabilities ( fig .",
    "[ reg ] ) .",
    "this is expected , since jni erroneously shares information _ equally _ among all networks , whilst dbn is statistically inefficient and therefore subject to higher variance .",
    "next , we relaxed the distinct sub - group architecture that likely favours slt by allowing @xmath92 , @xmath93 to share edges ( `` weakly exchangeable '' regime ( 2 ) ; sfig .",
    "[ ex2 ] ) .",
    "results ( fig .",
    "[ reg2 ] and sfig .",
    "[ sim res2 ] ) in this regime closely mirrored those of the disjoint sub - group regime , suggesting that slts offer improved estimation in more realistic weakly exchangeable settings .",
    "however in the fully exchangeable regime ( 3 ) ( sfig . [ ex3 ] ) there was a decrease in performance of slt with respect to jni as quantified by aupr , auroc and the misclassification rate among top ranked edges ( sfig .",
    "[ sim res3 ] ) .    in order to probe robustness of slt to prior mis - specification we considered two scenarios in which assumptions encoded in the joint structural prior are violated .",
    "firstly , we investigated whether the performance of slt deteriorates when the tree @xmath6 itself is misspecified ( in fact chosen randomly ; regime ( 4 ) , sfig .",
    "[ ex4 ] ) .",
    "these results showed that slt remains superior to jni and dbn terms of mcc , and remains competitive in terms of aupr and auroc ( sfig .",
    "[ sim res4 ] ) .",
    "secondly , we considered strongly violating the subset inclusions ( regime ( 5 ) ; sfig .",
    "[ ex5 ] ) .",
    "the mcc performance of slt in this regime was competitive with jni and dbn ( fig .",
    "[ reg3 ] ) .",
    "however slt performed worse than jni and dbn in terms of aupr , auroc and misclassification rate ( sfig .",
    "[ sim res5 ] ) .",
    "robustness of slts is therefore dependent upon which aspects of performance are being considered .",
    "the above experiments were performed at constant edge density @xmath105 , however slt tends to produce sparser networks _",
    "a priori_. we therefore repeated the above experiments whilst varying the true density @xmath102 and holding the number of samples constant at @xmath104 .",
    "results ( fig .",
    "[ reg ] , sfigs .",
    "[ sim res1]-[sim res5 ] ) showed that , in all regimes , performance of slt improves in sparse settings whilst the performance of both jni and dbn deteriorate .",
    "examining the density of estimated networks relative to the data - generating networks ( sfigs .",
    "[ sim res1]-[sim res5 ] ) we found that jni and dbn dramatically over - estimate density in sparse regimes ; in contrast slt automatically adjusts to the density of the data - generating networks .",
    "this appealing property results from our novel subset prior of eqn .",
    "[ model eq ] .",
    "this work was motivated by the problem of inference for protein signalling networks ( psns ) over a diverse panel of breast cancer cell lines .",
    "the cell lines under study are expected to differ with respect to psn structure but can be grouped into sub - types based on underlying biology , as described below . here independent estimation is likely to be inefficient , since the cell lines have a common lineage and share much of their biology . on there other hand , since sub - types may be quite different from one another , exchangeability within sub - type is arguably a more reasonable assumption than exchangeability between sub - type .",
    "amplification of the her2 gene ( denoted as  her2 + \" ) is a key biomarker used to stratify breast cancer samples and cell lines .",
    "her2 codes for a receptor that is a member of the egfr family of receptors and",
    "it is believed that signalling related to these receptors may differ between these two sub - types .",
    "however , it is challenging to study signalling at the group level _ per se _ , since within each sub - type there remains considerable genetic diversity .",
    "we therefore applied slt to learn both cell - line - specific and group - level psns , whilst controlling for confounding due to both her2 status and line - specific genomic characteristics .",
    "specifically , we constructed a tree @xmath6 such that the doubly latent networks @xmath106 define her2+/- sub - types respectively and the data - generating networks @xmath89 correspond to psns in cell lines @xmath50 of sub - type @xmath51 .",
    "we used an informative prior network @xmath21 derived from the signalling literature ( fig .",
    "[ panel ] , top left ) .",
    "reverse phase protein array data @xcite were obtained over a panel of 10 breast cancer cell lines @xcite of which half were her2 + and half her2- .",
    "data consisted of @xmath107 protein expression levels , observed at 0.5,1,2,4,8,24,48,72 hours following ligand stimulation .",
    "a total of 4 time series were obtained , under treatment with dmso , a egfr / her2 inhibitor ( lapatinib ) , an akt inhibitor ( akti ) and lapatinib + akti in combination , giving a total sample size of @xmath108 . from a modelling perspective , the drugs lapatinib and akti are perturbations in the causal sense of intervening upon a node in the network .",
    "we assumed perfect interventions , corresponding to 100% removal of the target s activity with 100% specificity .",
    "full experimental protocol is provided in the supp .",
    "[ protocol ] .",
    "[ panel ] displays the inferred root network @xmath19 , the sub - type and cell line networks .",
    "it is noticeable that her2 signalling plays a more prominent role in the her2 + sub - type in line with biological intuition .",
    "interestingly we infer regulation of bad by her2 ( via akt ) ; dephosphorylation of bad initiates apoptosis and this may help to explain a differential efficacy of her2 inhibitors observed between her2+/- sub - types .",
    "these results illustrate application of slts in a topical applied problem ; however , inference of network structure from biological data remains extremely challenging @xcite and experimental validation of inferred topology is necessary .",
    "in this paper we introduced a novel methodology , slt , which generalises joint estimation of multiple networks to the non - exchangeable setting .",
    "our empirical results support the notion that slts can offer improved estimation relative to existing estimators based on exchangeability .",
    "we illustrated the use of the slt framework using ffdbns for which joint estimation could be carried out in a computationally efficient manner .",
    "however the general slt approach is applicable in principle to any probabilistic network model for which marginal likelihoods are available .",
    "thus , in principle slt formulations could be developed for bayesian networks , ggms , or more sophisticated local likelihoods , for example based on differential equations @xcite .    in empirical studies we considered ffdbns of dimension @xmath109 10 and 17 ; in this setting , exact inference using slts was massively faster than ( exchangeable ) alternatives based on mcmc @xcite .",
    "the ( serial ) computational complexity of our approach applied to a tree @xmath6 is at worst @xmath110 , where @xmath111 is the number of networks that are tree distance @xmath51 from the root network @xmath14 and @xmath54 is the number of tiers in @xmath6 .",
    "thus in our cancer example , inclusion of more cancer sub - types or cell lines is computationally cheap ( linear in both @xmath112 and @xmath113 ) . for ffdbns , @xmath114 so that slt has the same computational complexity as a fully exchangeable formulation ( jni ) , but requires @xmath115 more computation than the classical non - joint approach .    extensions of theoretical interest include : ( i ) the case where @xmath6 itself is unknown ; here the challenge is to jointly learn both individual - specific networks and tree structure . in principle this could be accomplished using the slt model described here , but further work would be needed to render this tractable for non - trivial applications .",
    "( ii ) the case of arbitrarily - structured populations , where @xmath6 need not be a tree , or where data may be associated with multiple networks ; here mcmc methods similar to @xcite or approximate inference algorithms such as loopy belief propagation may prove effective .      the authors wish to thank frank dondelinger , steven hill , dan woodcock and chris penfold .",
    "data courtesy james korkola and joe w. gray , oregon health and science university .",
    "cjo supported by uk epsrc ep / e501311/1 .",
    "sm supported by nci u54 ca112970 and the cancer systems center grant from the netherlands organisation for scientific research .",
    "99999    baumbach _ et al . _",
    "( 2009 ) reliable transfer of gene regulatory networks between taxonomically related organisms . _",
    "bmc bioinformatics _ * 3*:8 .",
    "calderhead , b. , girolami , m. ( 2009 ) estimating bayes factors via thermodynamic integration and population mcmc .",
    "data an . _ * 53*:4028 - 4045 .",
    "chiquet , j. , grandvalet , y. , ambroise , c. ( 2011 ) inferring multiple graphical structures .",
    "_ * 21*(4):537 - 553 .",
    "danaher , p. , wang , p. , witten , d.m .",
    "( 2014 ) the joint graphical lasso for inverse covariance estimation across multiple classes .",
    "_ j. r. statist .",
    "b _ , in press .    deltell _ et al . _",
    "( 2012 ) criteria for bayesian model choice with application to variable selection .",
    "_ * 40*(3):1550 - 1577 .",
    "dondelinger , f. , lebre , s. , husmeier , d. ( 2012 ) non - homogeneous dynamic bayesian networks with bayesian regularization for inferring gene regulatory networks with gradually time - varying structure . _ mach .",
    "_ * 90*(2):191 - 230 .",
    "( 2012 ) intratumor heterogeneity and branched evolution revealed by multiregion sequencing . _",
    "_ * 366*(10):883 - 892 .",
    "guo _ et al . _",
    "( 2011 ) joint estimation of multiple graphical models .",
    "_ biometrika _ * 98*(1):1 - 15 .",
    "hennessy _ et al . _",
    "( 2010 ) a technical assessment of the utility of reverse phase protein arrays for the study of the functional proteome in nonmicrodissected human breast cancer .",
    "proteom . _ * 6*:129 - 151 .",
    "( 2012 ) bayesian inference of signaling network topology in a cancer cell line .",
    "_ bioinformatics _ * 28*(21):2804 - 2810",
    ".    mohan _ et al . _",
    "( 2014 ) node - based learning of multiple gaussian graphical models .",
    "_ j. mach .",
    "_ , in press .",
    "mukherjee , s , speed , t.p .",
    "( 2008 ) network inference using informative priors .",
    "usa _ * 105*(38):14313 - 14318 .",
    "murphy , k. ( 2002 ) dynamic bayesian networks : representation , inference and learning .",
    "phd thesis , university of california , berkeley .",
    "nelander _ et al . _",
    "( 2008 ) models from experiments : combinatorial drug perturbations of cancer cells . _",
    "biol . _ * 4*(1):216 .",
    "neve _ et al . _",
    "( 2006 ) a collection of breast cancer cell lines for the study of functionally distinct cancer subtypes .",
    "_ cancer cell _ * 10*(6):515 - 527 .",
    "oates , c.j . , mukherjee , s. ( 2012 ) network inference and biological dynamics .",
    "stat . _ * 6*(3):1209 - 1235 .",
    "oates _ et al . _",
    "( 2013 ) joint estimation of multiple networks from time course data",
    ". _ crism working paper series , university of warwick _ * 13*:03 .",
    "pearl , j. ( 1982 ) reverend bayes on inference engines : a distributed tree approach",
    ". _ proceedings of the second national conference on artificial intelligence .",
    "aaai-82 : pittsburgh , pa .",
    "menlo park , california : aaai press .",
    "_ , 133 - 136 .    pearl , j. ( 2009 ) causal inference in statistics : an overview . _ stat . surveys _ * 3*:96 - 146 .",
    "penfold _ et al . _",
    "( 2012 ) nonparametric bayesian inference for perturbed and orthologous gene regulatory networks .",
    "_ bioinformatics _ * 28*(12):i233-i241 .",
    "scott , j.g . ,",
    "berger , j.o .",
    "( 2010 ) bayes and empirical - bayes multiplicity adjustment in the variable - selection problem .",
    "stat . _ * 38*(5):2587 - 2619 .",
    "spencer , s. , hill , s.m . , mukherjee , s. ( 2012 ) dynamic bayesian networks for interventional data . _ crism working paper series , university of warwick _ * 12*:24 .",
    "taylor , m. , fox , c. ( 2011 ) inventory management with dynamic bayesian network software systems .",
    "_ business information systems : springer lecture notes in business information processing _ * 87*:290 - 300 .",
    "werhli , a.v . , husmeier , d. ( 2008 ) gene regulatory network reconstruction by bayesian integration of prior knowledge and/or different experimental conditions .",
    "_ j. bioinf .",
    "biol . _ * 6*(3):543 - 572 .",
    "yang _ et al . _",
    "( 2012 ) fused multiple graphical lasso .",
    "arxiv:1209.2139 .",
    "zellner , a. ( 1986 ) on assessing prior distributions and bayesian regression analysis with g - prior distributions , _ bayesian inference and decision techniques - essays in honor of bruno de finetti , eds . p. k. goel and a. zellner _",
    ", 233 - 243 .",
    "following marginalisation of continuous parameters @xmath116 , inference for slts reduces to inference for a discrete bayesian network whose nodes are themselves graphical models ( sfig . [ various graphs ] ) . in this section",
    "we describe the use of belief propagation ( bp ; @xcite ) for inference in this setting and provide pseudocode for the 2-tier slt model .",
    "denote by @xmath117 a vector of random variables whose density factorizes according to @xmath118 where @xmath119 denotes the components of vector @xmath120 upon which the factor @xmath121 depends .",
    "the factor graph corresponding to the 2-tier slt model is shown in sfig .",
    "[ factor ] .",
    "we use @xmath122 to denote a message passed from a variable @xmath123 to a factor @xmath121 , whereas @xmath124 will be used to denote a message passed from a factor @xmath121 to a variable @xmath123 .",
    "the message from a variable @xmath123 to a factor @xmath121 takes the following form : @xmath125 where @xmath126 denotes the neighbours of variable @xmath123 according to the factor graph . similarly the message from a factor @xmath121 to",
    "a variable @xmath123 takes the form @xmath127 where @xmath128 denotes the neighbours of factor @xmath121 according to the factor graph .    to simplify notation",
    ", we describe our algorithm using subscript notation as in the main text ; e.g. @xmath89 denotes the network that is the @xmath50th child of the @xmath51th child of the root network @xmath19 in @xmath6 .",
    "bp nominates one node in the factor graph as a `` root '' ; of the remaining nodes , those with degree one are known as `` leaves '' . for bp applied to slt we nominate the network @xmath19 as the root node .",
    "messages are initiated at the leaves of the factor graph ; specifically , in our 2-tier example , each variable node @xmath129 is initialised with an atomic distribution @xmath130 centered on the observed data @xmath96 .",
    "messages are passed through to the root node before being returned to the leaves .",
    "once the message passing has been completed , it is possible to extract marginals of interest by taking products of messages from factors neighboring the random variable of interest : @xmath131 alg .",
    "[ mp ] contains pseudocode for the bp algorithm in the context of 2-tier slts .                  from each network",
    "@xmath89 we generated time series data @xmath96 , each containing @xmath97 time points , according to a linear var@xmath146 process . for each time",
    "series one variable was selected uniformly at random to be the target of a perfect intervention @xcite .",
    "dynamical parameters were assigned such that for each edge @xmath147 we select a data - generating coefficient @xmath148 uniformly at random . for all experiments we used a noise magnitude @xmath149 . in each regime",
    "we generated data of varying sample size @xmath97 and edge density @xmath102 .",
    "specifically , we considered both varying @xmath97 for fixed @xmath150 and varying @xmath102 for fixed @xmath151 .",
    "denote the true data - generating ( binary ) adjacency matrix by @xmath152 . in this work we considered the performance of two kinds of estimator ; ( i ) the weighted adjacency matrices @xmath153 produced by collecting together posterior marginal inclusion probabilities , and ( ii ) the binary adjacency matrices @xmath154 with @xmath147th entry @xmath155 , i.e. including edges if and only if the corresponding posterior marginal inclusion probabilities exceed a threshold @xmath156 .",
    "write tp@xmath157 , fp@xmath157 , tn@xmath157 , fn@xmath157 for , respectively , the true positive , false positive , true negative and false negative counts obtained by comparing @xmath154 to @xmath152 .",
    "further write tpr@xmath157 = tp@xmath157 / ( tp@xmath157 + fn@xmath157 ) , fpr@xmath157 = fp@xmath157 / ( tn@xmath157 + fp@xmath157 ) , ppv@xmath157 = tp@xmath157 / ( tp@xmath157 + fp@xmath157 ) .",
    "1 .   matthews correlation coefficient @xmath163 + 2 .   misclassification rate @xmath164 ( fp + fn ) / @xmath165 + 3",
    ".   misclassification rate ( top @xmath166 edges ) @xmath164 as for the misclassification rate , but with @xmath156 chosen such that @xmath154 contains exactly @xmath166 non - zero entries , where @xmath166 is the number of edges in the true data - generating network .",
    "precision @xmath164 tp / ( tp + fp )",
    ".      sfigs .",
    "[ ex2 ] , [ ex3 ] , [ ex4 ] , [ ex5 ] display typical simulation examples for regimes 2 - 5 respectively , and sfigs .",
    "[ sim res1]-[sim res5 ] display full simulation results for each of the the 5 regimes described in the main text .",
    "cells were plated into 10 @xmath167 dishes at a density of @xmath168 cells . after 24 hours",
    ", cells were treated with 250 @xmath169 lapatinib or 250 @xmath169 akti ( gsk690693 ) .",
    "dmso served as a control .",
    "cells were grown in 10% fbs and harvested in rppa lysis buffer at 30 min , 1h , 2h , 4h , 8h , 24h , 48h , and 72h",
    "post - treatment .",
    "cell lysates were quantitated , diluted , arrayed , and probed following @xcite .",
    "imaging and quantitation of signal intensity was done following @xcite .",
    "the particular protein species analysed were 4ebp1(pt37 ) , akt(ps473 ) , bad(ps112 ) , c - myc(pt58 ) , egfr(py1173 ) , elk1(ps383 ) , er , foxo3a(ps318 ) , gsk3ab(ps21 ) , her2 , irs1(ps307 ) , mapk(pt202 ) , mek1/2(ps217 ) , p38(pt180 ) , p53 , pr and s6(ps240 ) .",
    "tibes _ et al . _",
    "( 2006 ) reverse phase protein array : validation of a novel proteomic technology and utility for analysis of primary leukemia specimens and hematopoietic stem cells . _",
    "cancer ther .",
    "_ * 5*(10):2512 - 2521 ."
  ],
  "abstract_text": [
    "<S> several methods have recently been developed for joint structure learning of multiple ( related ) graphical models or networks . </S>",
    "<S> these methods treat individual networks as exchangeable , such that each pair of networks are equally encouraged to have similar structures . </S>",
    "<S> however , in many practical applications , exchangeability in this sense may not hold , as some pairs of networks may be more closely related than others , for example due to group and sub - group structure in the data . here </S>",
    "<S> we present a novel bayesian formulation that generalises joint structure learning beyond the exchangeable case . </S>",
    "<S> in addition to a general framework for joint learning , we ( i ) provide a novel default prior over the joint structure space that requires no user input ; ( ii ) allow for latent networks ; ( iii ) give an efficient , exact algorithm for the case of time series data and dynamic bayesian networks . </S>",
    "<S> we present empirical results on non - exchangeable populations , including a real data example from biology , where cell - line - specific networks are related according to genomic features . </S>"
  ]
}