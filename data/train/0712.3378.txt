{
  "article_text": [
    "given finite sets @xmath2 , diaconis and fulton @xcite defined the _ smash sum _ @xmath3 as a certain random set whose cardinality is the sum of the cardinalities of @xmath4 and @xmath5 .",
    "write @xmath6 . to construct the smash sum ,",
    "begin with the union @xmath7 and for each @xmath8 let @xmath9 where @xmath10 is the endpoint of a simple random walk started at @xmath11 and stopped on exiting  @xmath12 .",
    "then define @xmath13 .",
    "the key observation of @xcite is that the law of @xmath14 does not depend on the ordering of the points @xmath11 .",
    "the sum of two squares in @xmath15 overlapping in a smaller square is pictured in figure  [ smashsumfigure ] .            in theorem  [ dfsum ] ,",
    "below , we prove that as the lattice spacing goes to zero , the smash sum @xmath3 has a deterministic scaling limit in @xmath1 . before stating our main results , we describe some related models and discuss our technique for identifying their common scaling limit , which comes from the theory of free boundary problems in pde .",
    "the diaconis - fulton smash sum generalizes the model of _ internal diffusion limited aggregation _",
    "( `` internal dla '' ) studied in @xcite , and in fact was part of the original motivation for that paper . in classical internal dla , we start with @xmath16 particles at the origin @xmath17 and let each perform simple random walk until it reaches an unoccupied site . the resulting random set of @xmath16 occupied sites in @xmath0 can be described as the @xmath16-fold smash sum of @xmath18 with itself .",
    "we will use the term internal dla to refer to the same process run from an arbitrary starting configuration of particles . in this broader sense of the term , both the diaconis - fulton sum and",
    "the model studied in @xcite are particular cases of internal dla .",
    "in defining the smash sum @xmath14 , various alternatives to random walk are possible .",
    "rotor - router walk is a deterministic analogue of random walk , first studied by priezzhev et al .",
    "@xcite under the name `` eulerian walkers . '' at each site in @xmath15 is a _ rotor _ pointing north , south , east or west .",
    "a particle performs a nearest - neighbor walk on the lattice according to the following rule : during each time step , the rotor at the particle s current location is rotated clockwise by @xmath19 degrees , and the particle takes a step in the direction of the newly rotated rotor . in higher dimensions , the model can be defined analogously by repeatedly cycling the rotors through an ordering of the @xmath20 cardinal directions in @xmath0 .",
    "the sum of two squares in @xmath15 using rotor - router walk is pictured in figure  [ smashsumfigure ] ; all rotors began pointing west .",
    "the shading in the figure indicates the final rotor directions , with four different shades corresponding to the four possible directions .",
    "the _ divisible sandpile _",
    "model uses continuous amounts of mass in place of discrete particles .",
    "a lattice site is _ full _ if it has mass at least @xmath21 .",
    "any full site can _ topple _ by keeping mass @xmath21 for itself and distributing the excess mass equally among its neighbors . at each time step , we choose a full site and topple it . as time goes to infinity , provided each full site is eventually toppled , the mass approaches a limiting distribution in which each site has mass @xmath22 ; this is proved in @xcite .",
    "note that individual topplings do not commute .",
    "however , the divisible sandpile is `` abelian '' in the sense that any sequence of topplings produces the same limiting mass distribution ; this is proved in lemma  [ abelianproperty ] .",
    "figure  [ smashsumfigure ] shows the limiting domain of occupied sites resulting from starting mass @xmath21 on each of two squares in @xmath15 , and mass @xmath23 on the smaller square where they intersect .",
    "figure  [ smashsumfigure ] raises a few natural questions : as the underlying lattice spacing becomes finer and finer , will the smash sum @xmath14 tend to some limiting shape in @xmath1 , and if so , what is this shape",
    "? will it be the same limiting shape for all three models ? to see how we might identify the limiting shape , consider the divisible sandpile _ odometer function _ @xmath24 since each neighbor @xmath25 emits an equal amount of mass to each of its @xmath20 neighbors , the total mass received by @xmath26 from its neighbors is @xmath27 , hence @xmath28 where @xmath29 and @xmath30 are the initial and final amounts of mass at @xmath26 , respectively . here",
    "@xmath31 is the discrete laplacian in @xmath0 , defined by @xmath32 .",
    "equation ( [ netchangeinmass ] ) suggests the following approach to finding the limiting shape .",
    "we first construct a function on @xmath0 whose laplacian is @xmath33 ; an example is the function @xmath34 where in dimension @xmath35 the green s function @xmath36 is the expected number of times a simple random walk started at @xmath26 visits @xmath37 ( in dimension @xmath38 we use the recurrent potential kernel in place of the green s function ) .",
    "the sum @xmath39 is then a superharmonic function on @xmath0 ; that is , @xmath40 .",
    "moreover if @xmath41 is any superharmonic function lying above @xmath42 , then @xmath43 is superharmonic on the domain @xmath44 of fully occupied sites , and nonnegative outside @xmath45 , hence nonnegative everywhere .",
    "thus we have proved the following lemma of @xcite .",
    "[ discretemajorant ] let @xmath46 be a nonnegative function on @xmath0 with finite support .",
    "then the odometer function for the divisible sandpile started with mass @xmath29 at each site @xmath26 is given by @xmath47 where @xmath42 is given by ( [ theobstacleintro ] ) , and @xmath48 is the _ least superharmonic majorant _ of @xmath42 .    for a reformulation of this lemma as a `` least action principle , '' see lemma  [ leastaction ]",
    ".     corresponding to starting mass @xmath21 on each of two overlapping disks ( top ) and mass @xmath49 on each of two nonoverlapping disks.,title=\"fig : \" ] +    corresponding to starting mass @xmath21 on each of two overlapping disks ( top ) and mass @xmath49 on each of two nonoverlapping disks.,title=\"fig : \" ]    lemma  [ discretemajorant ] allows us to formulate the problem in a way which translates naturally to the continuum . given a function @xmath46 on @xmath1 representing the initial mass density , by analogy with ( [ theobstacleintro ] ) we define the _ obstacle _ @xmath50 where @xmath51 is the harmonic potential on @xmath1 proportional to @xmath52 in dimensions @xmath53 and to @xmath54 in dimension two .",
    "we then let @xmath55 the _ odometer function _ for @xmath46 is then given by @xmath56 , and the final domain of occupied sites is given by @xmath57 this domain @xmath45 is called the _ noncoincidence set for the obstacle problem _ with obstacle @xmath42 ; for an in - depth discussion of the obstacle problem , see @xcite .    if @xmath58 are bounded open sets in @xmath1 , we define the _ smash sum _ of @xmath4 and @xmath5 as @xmath59 where @xmath45 is given by ( [ thenoncoincidencesetintro ] ) with @xmath60 . in the two - dimensional setting ,",
    "an alternative definition of the smash sum in terms of quadrature identities is mentioned in @xcite .    by analogy with the discrete case",
    ", we would expect that @xmath61 where @xmath62 denotes lebesgue measure in @xmath1 .",
    "this is proved in corollary  [ volumesadd ] .",
    "more generally , if @xmath63 is a superharmonic function on @xmath0 , and @xmath46 is a mass configuration for the divisible sandpile ( so each site @xmath64 has mass @xmath29 ) , the sum @xmath65 can only decrease when we perform a toppling .",
    "thus @xmath66 where @xmath67 is the final mass configuration .",
    "we therefore expect the domain @xmath45 given by ( [ thenoncoincidencesetintro ] ) to satisfy the _ quadrature inequality _",
    "@xmath68 for all integrable superharmonic functions @xmath63 on @xmath45 . for a proof under suitable smoothness assumptions on @xmath46 and @xmath63 ,",
    "see proposition  [ boundaryregularitysmooth ] ; see also @xcite .",
    "a domain @xmath69 satisfying an inequality of the form ( [ quadratureineq ] ) is called a _ quadrature domain _ for @xmath46 .",
    "such domains are widely studied in potential theory and have a variety of applications in fluid dynamics @xcite . for more on quadrature domains and their connection with the obstacle problem ,",
    "see @xcite .",
    "equation ( [ discretequadrature ] ) can be regarded as a discrete analogue of a quadrature inequality ; in this sense , the three aggregation models studied in this paper produce discrete analogues of quadrature domains .",
    "indeed , these aggregation models can be interpreted as discrete analogues of hele - shaw flow @xcite , which produces quadrature domains in the continuum .",
    "the main goal of this paper is to prove that if any of our three aggregation models ",
    "internal dla , rotor - router , or divisible sandpile  is run on finer and finer lattices with initial mass densities converging in an appropriate sense to @xmath46 , the resulting domains of occupied sites will converge in an appropriate sense to the domain @xmath45 given by ( [ thenoncoincidencesetintro ] ) .    in order to state our main result ,",
    "let us define the appropriate notion of convergence of domains , which amounts essentially to convergence in the hausdorff metric .",
    "fix a sequence @xmath70 representing the lattice spacing . given domains @xmath71 and @xmath69 ,",
    "write @xmath72 if for any @xmath73 @xmath74 for all sufficiently large @xmath16 . here",
    "@xmath75 and @xmath76 denote respectively the inner and outer @xmath77-neighborhoods of @xmath45 : @xmath78 where @xmath79 is the ball of radius @xmath77 centered at @xmath26 .    for @xmath80 we write @xmath81^d$ ] . for @xmath82 write @xmath83 for the closest integer to @xmath84 , rounding up if @xmath85 .",
    "the initial data for each of our lattice models consists of a function @xmath86 representing the number of particles ( or amount of mass ) at each lattice site ; we think of @xmath87 as a density with respect to counting measure on @xmath88 , and refer to it as the `` initial density . ''    throughout this paper , to avoid trivialities we work in dimension @xmath89 .",
    "our main result is the following .",
    "[ intromain ] let @xmath90 , @xmath91 be a bounded open set , and let @xmath92 be a bounded function which is continuous almost everywhere , satisfying @xmath93 .",
    "let @xmath94 be the domains of occupied sites formed from the divisible sandpile , rotor - router model , and internal dla , respectively , in the lattice @xmath88 started from initial density @xmath95 then as @xmath96 @xmath97 and if @xmath98 , then with probability one @xmath99 where @xmath45 is given by ( [ thenoncoincidencesetintro ] ) , and the convergence is in the sense of  ( [ convergenceinthehausdorffmetric ] ) .",
    "when forming the rotor - router domains @xmath100 , the initial rotors in each lattice @xmath88 may be chosen arbitrarily .    as an immediate consequence ,",
    "all three lattice models have a rotationally - invariant scaling limit .",
    "this follows from the rotational symmetry of the obstacle problem : if @xmath101 is a rotation of @xmath1 , and @xmath45 is the noncoincidence set ( [ thenoncoincidencesetintro ] ) for initial density @xmath46 , then the noncoincidence set for initial density @xmath102 is @xmath103 .",
    "we prove a somewhat more general form of theorem  [ intromain ] which allows for some flexibility in how the discrete density @xmath87 is constructed from @xmath46 .",
    "in particular , taking @xmath104 we obtain the following theorem , which explains the similarity of the three smash sums pictured in figure  [ smashsumfigure ] .",
    "[ dfsum ] let @xmath105 be bounded open sets whose boundaries have measure zero .",
    "let @xmath94 be the smash sum of @xmath106 and @xmath107 , formed using divisible sandpile , rotor - router and internal dla dynamics , respectively . then as @xmath96 @xmath108 and if @xmath98 , then with probability one @xmath109 where @xmath3 is given by ( [ smashsumdef ] ) , and the convergence is in the sense of  ( [ convergenceinthehausdorffmetric ] ) .    for the divisible sandpile , theorem  [ intromain ] can be generalized by dropping the requirement that @xmath46 be integer valued",
    "; see theorem  [ domainconvergence ] for the precise statement",
    ". taking @xmath46 real - valued is more problematic in the case of the rotor - router model and internal dla , since these models work with discrete particles .",
    "still , one might wonder if , for example , given a domain @xmath110 , starting each even site in @xmath106 with one particle and each odd site with two particles , the resulting domains @xmath111 would converge to the noncoincidence set @xmath45 for density @xmath112 .",
    "this is in fact the case : if @xmath87 is a density on @xmath88 , as long as a certain `` smoothing '' of @xmath87 converges to @xmath46 , the rotor - router and internal dla domains started from initial density @xmath87 will converge to @xmath45 .",
    "see theorems  [ rotordomainconvergence ] and  [ idlaconvergence ] for the precise statements",
    ".     started from two point sources on the @xmath26-axis .",
    "the boundary of the limiting shape is an algebraic curve ( [ twosourcequartic ] ) of degree  @xmath113 . ]",
    "one interesting case not covered by theorems  [ intromain ] and  [ dfsum ] is the case of multiple point sources .",
    "lawler , bramson and griffeath @xcite showed that the scaling limit of internal dla in @xmath0 with a single point source of particles is a euclidean ball . in @xcite , the present authors showed that for rotor - router aggregation and the divisible sandpile in @xmath0 with a single point source , the scaling limit in both cases is also a euclidean ball .    for @xmath114 write @xmath115 for the closest lattice point in @xmath88 , breaking ties to the right .",
    "our shape theorem for multiple point sources , which is deduced from theorem  [ dfsum ] using the main results of @xcite and @xcite , is the following .",
    "[ multiplepointsources ] fix @xmath116 and @xmath117 .",
    "let @xmath118 be the ball of volume @xmath119 centered at @xmath120 .",
    "fix a sequence @xmath70 , and for @xmath80 let @xmath121 let @xmath122 be the domains of occupied sites in @xmath88 formed from the divisible sandpile , rotor - router model , and internal dla , respectively , started from initial density @xmath87 . then as @xmath123 @xmath124 and if @xmath125 , then with probability one @xmath126 where @xmath127 denotes the smash sum ( [ smashsumdef ] ) , and the convergence is in the sense of  ( [ convergenceinthehausdorffmetric ] ) .",
    "implicit in ( [ smashsumofballs ] ) is the associativity of the smash sum operation , which is not readily apparent from the definition ( [ smashsumdef ] ) .",
    "for a proof of associativity , see lemma  [ associativity ] .",
    "alternatively , the associativity follows from basic properties of `` partial balayage '' operators on measures on @xmath1 ; see ( * ? ? ?",
    "* theorem 2.2(iii ) ) . for related results in dimension two , see ( * ? ? ?",
    "* prop .  3.10 ) and @xcite .",
    "we remark that a similar model of internal dla with multiple point sources was studied by gravner and quastel @xcite , who also obtained a variational solution . in their model , instead of starting with a fixed number of particles , each source @xmath120 emits particles according to a poisson process .",
    "the shape theorems of @xcite concern convergence in the sense of volume , which is a weaker form of convergence than that studied in the present paper .    in proposition  [ ballquadrature ] , we show that the smash sum of balls @xmath128 arising in theorem  [ multiplepointsources ] obeys the classical quadrature inequality @xmath129 for all integrable superharmonic functions @xmath63 on @xmath128 , with equality if @xmath63 is harmonic .",
    "this can be regarded as a generalization of the classical mean value property of harmonic functions , which corresponds to the case @xmath130 .",
    "let @xmath131 be disks in @xmath132 with distinct centers @xmath133 . from ( [ classicalquadrature ] ) and work of aharonov and shapiro @xcite and gustafsson @xcite it follows that that the boundary @xmath134 lies on an algebraic curve of degree @xmath135 .",
    "more precisely , there is a polynomial @xmath136 $ ] of the form @xmath137 and there is a finite set of points @xmath138 , possibly empty , such that @xmath139    for example , if @xmath140 and @xmath141 are disks of equal radius @xmath142 centered at @xmath143 and @xmath144 , then @xmath145 is given by the quartic curve @xcite @xmath146 this curve describes the shape of the rotor - router model with two point sources pictured in figure  [ rotortwosource ] .",
    "in this section we review the basic properties of superharmonic potentials and of the least superharmonic majorant .",
    "the proofs are deferred to section  [ potentialtheoryproofs ] . in view of the diverse readership who might be interested in the models we study ,",
    "we have elected to include somewhat more than the usual amount of background material .      since we will often be working with functions on @xmath1 which may not be twice differentiable , it is desirable to define superharmonicity without making reference to the laplacian",
    ". instead we use the mean value property .",
    "a function @xmath147 on an open set @xmath90 is _ superharmonic _ if it is lower - semicontinuous and for any ball @xmath148 @xmath149 here @xmath150 is the volume of the unit ball in @xmath1 .",
    "we say that @xmath147 is subharmonic if @xmath151 is superharmonic , and harmonic if it is both super- and subharmonic .",
    "the following properties of superharmonic functions are well known ; for proofs , see e.g.  @xcite , @xcite or @xcite .",
    "[ basicproperties ] let @xmath147 be a superharmonic function on an open set @xmath90 extending continuously to @xmath152",
    ". then    1 .",
    "@xmath147 attains its minimum in @xmath152 on the boundary .",
    "2 .   if @xmath63 is continuous on @xmath152 , harmonic on @xmath153 , and @xmath154 on @xmath155 , then @xmath156 .",
    "3 .   if @xmath157 , then @xmath158 4 .   if @xmath147 is twice differentiable on @xmath153 , then @xmath159 on @xmath153 . 5 .",
    "if @xmath160 is an open ball , and @xmath161 is a function on @xmath153 which is harmonic on  @xmath5 , continuous on @xmath162 , and agrees with @xmath147 on @xmath163 , then @xmath161 is superharmonic .    given a function @xmath42 on @xmath1 which is bounded above , the _ least superharmonic majorant _ of @xmath42 ( also called the solution to the obstacle problem with obstacle @xmath42 ) is the function @xmath164 note that since @xmath42 is bounded above , the infimum is taken over a nonempty set .",
    "[ majorantbasicprops ] let @xmath42 be a uniformly continuous function which is bounded above , and let @xmath165 be given by ( [ majorantdef ] )",
    ". then    1 .",
    "@xmath165 is superharmonic .",
    "@xmath165 is continuous .",
    "@xmath165 is harmonic on the domain @xmath166      next we describe the particular class of obstacles which relate to the aggregation models we are studying . for a bounded measurable function @xmath46 on @xmath1 with compact support , write @xmath167 where @xmath168 here @xmath169 , where @xmath150 is the volume of the unit ball in @xmath1 .",
    "note that ( [ greenskernel ] ) differs by a factor of @xmath20 from the standard harmonic potential in @xmath1 ; however , the normalization we have chosen is most convenient when working with the discrete laplacian and random walk .",
    "the following result is standard ; see ( * ? ? ?",
    "* theorem 1.i.7.2 ) .",
    "let @xmath46 be a measurable function on @xmath1 with compact support .",
    "[ smoothnessofpotential ]    1 .   if @xmath46 is bounded , then @xmath170 is continuous .",
    "if @xmath46 is @xmath171 , then @xmath170 is @xmath172 and @xmath173    regarding ( ii ) , if we remove the smoothness assumption on @xmath46 , equation ( [ laplacianofpotential ] ) remains true in the sense of distributions . for our applications , however , we will not need this , and the following lemma will suffice .",
    "[ superharmonicpotential ] let @xmath46 be a bounded measurable function on @xmath1 with compact support .",
    "if @xmath174 on an open set @xmath90 , then @xmath175 is superharmonic on @xmath153 .    by applying lemma  [ superharmonicpotential ] both to @xmath46 and to @xmath176 , we obtain that @xmath170 is harmonic off the support of @xmath46 .",
    "let @xmath177 be the ball of radius @xmath178 centered at the origin in @xmath1 .",
    "we compute in dimensions @xmath35 @xmath179 likewise in two dimensions @xmath180    fix a bounded nonnegative function @xmath46 on @xmath1 with compact support , and let @xmath181 let @xmath182 be the least superharmonic majorant of @xmath42 , and let @xmath183 be the noncoincidence set .",
    "[ laplacianofobstacle ]    * @xmath184 is subharmonic on @xmath1 . *",
    "if @xmath185 on an open set @xmath90 , then @xmath186 is superharmonic on @xmath153 .    [ laplacianofodometer ] let @xmath187 , where @xmath42 and @xmath165 are given by ( [ theobstacle ] ) and ( [ themajorant ] ) . then    * @xmath188 is superharmonic on @xmath1 . * if @xmath185 on an open set @xmath90 , then @xmath189 is subharmonic on @xmath153 .",
    "[ startingdensitygreaterthan1 ] let @xmath45 be given by ( [ thenoncoincidenceset ] ) .",
    "then @xmath190 .",
    "the next lemma concerns the monotonicity of our model : by starting with more mass , we obtain a larger odometer and a larger noncoincidence set ; see also ( * ? ? ?",
    "* lemma  7.1 ) .",
    "[ monotonicity ] let @xmath191 be functions on @xmath1 with compact support , and suppose that @xmath192 .",
    "let @xmath193 let @xmath194 be the least superharmonic majorant of @xmath195 , let @xmath196 , and let @xmath197 then @xmath198 and @xmath199 .",
    "our next lemma shows that we can restrict to a domain @xmath90 when taking the least superharmonic majorant , provided that @xmath153 contains the noncoincidence set .",
    "[ majorantonacompactset ] let @xmath200 be given by ( [ theobstacle])-([thenoncoincidenceset ] ) .",
    "let @xmath90 be an open set with @xmath201 .",
    "then @xmath202      next we turn to the regularity of the solution to the obstacle problem ( [ themajorant ] ) and of the free boundary @xmath203 .",
    "there is a substantial literature on boundary regularity for the obstacle problem . in our setting , however , extra care must be taken near points where @xmath204 : at these points the obstacle ( [ theobstacle ] ) is harmonic , and the free boundary can be badly behaved .",
    "one approach , adopted in @xcite , is to reformulate the obstacle problem in  @xmath1 as an obstacle problem on the set @xmath205 .",
    "the results of @xcite apply in the situation that @xmath206 everywhere , but we will want to relax this condition .",
    "we show only the minimal amount of regularity required for the proofs of our main theorems .",
    "much stronger regularity results are known in related settings ; see , for example , @xcite .",
    "the following lemma shows that if the obstacle is sufficiently smooth , then the superharmonic majorant can not separate too quickly from the obstacle near the boundary of the noncoincidence set . as usual , we write @xmath207 for the inner @xmath77-neighborhood of @xmath45 .    [ smoothdensity ] let @xmath46 be a @xmath171 function on @xmath1 with compact support .",
    "let @xmath200 be given by ( [ theobstacle])-([thenoncoincidenceset ] ) , and write @xmath208 .",
    "then @xmath147 is @xmath171 , and for @xmath209 we have @xmath210 , for a constant @xmath211 depending on @xmath46 .",
    "next we show that mass is conserved in our model : the amount of mass starting in @xmath45 is @xmath212 , while the amount of mass ending in @xmath45 is @xmath213 , the lebesgue measure of @xmath45 . since no mass moves outside of @xmath45 , we expect these two quantities to be equal .",
    "although this seems intuitively obvious , the proof takes some work because we have no _ a priori _ control of the domain  @xmath45 . in particular , we first need to show that the boundary of @xmath45 can not have positive @xmath214-dimensional lebesgue measure .",
    "[ boundaryregularitysmooth ] let @xmath46 be a @xmath171 function on @xmath1 with compact support , such that @xmath215 .",
    "let @xmath45 be given by ( [ thenoncoincidenceset ] )",
    ". then    * @xmath216 . * for any function @xmath217 which is superharmonic on @xmath45 , @xmath218    note that by applying ( ii ) both to @xmath63 and to @xmath219 , equality holds whenever @xmath63 is harmonic on @xmath45 .",
    "in particular , taking @xmath220 yields the conservation of mass : @xmath221 .    we will also need a version of proposition  [ boundaryregularitysmooth ] which does not assume that @xmath46 is @xmath171 or even continuous .",
    "we can replace the @xmath171 assumption and the condition that @xmath215 by the following condition .",
    "@xmath222 for a constant @xmath223 .",
    "then we have the following result .    [ boundaryregularity ]",
    "let @xmath46 be a bounded function on @xmath1 with compact support .",
    "let @xmath45 be given by ( [ thenoncoincidenceset ] ) , and let @xmath224 . if @xmath46 is continuous almost everywhere and satisfies ( [ boundedawayfrom1again ] ) , then    * @xmath225 .",
    "* @xmath226 . * @xmath227 .",
    "in particular , taking @xmath60 , we have @xmath228 where @xmath127 denotes the smash sum ( [ smashsumdef ] ) . from ( iii )",
    "we obtain the volume additivity of the smash sum .",
    "[ volumesadd ] let @xmath105 be bounded open sets whose boundaries have measure zero .",
    "then @xmath229    our next lemma describes the domain resulting from an initial mass density @xmath230 on a ball in @xmath1 .",
    "not surprisingly , the result is another ball , concentric with the original , of @xmath231 times the volume .",
    "in particular , if @xmath231 is an integer , the @xmath231-fold smash sum of a ball with itself is again a ball .",
    "[ relaxingaball ] fix @xmath230 , and let @xmath45 be given by ( [ thenoncoincidenceset ] ) with @xmath232",
    ". then @xmath233 .    since @xmath234 is spherically symmetric and the least superharmonic majorant commutes with rotations , @xmath45 is a ball centered at the origin . by proposition  [ boundaryregularity](ii )",
    "we have @xmath235 .",
    "next we show that the noncoincidence set is bounded ; see also ( * ? ? ?",
    "* lemma  7.2 ) .",
    "[ occupieddomainisbounded ] let @xmath46 be a function on @xmath1 with compact support , satisfying @xmath236 .",
    "let @xmath45 be given by ( [ thenoncoincidenceset ] )",
    ". then @xmath45 is bounded .",
    "let @xmath177 be a ball containing the support of @xmath46 . by lemmas",
    "[ monotonicity ] and  [ relaxingaball ] , the difference @xmath237 is supported in @xmath238 .",
    "in broad outline , many of our arguments have the following basic structure : @xmath239 an appropriate convergence of starting densities is built into the hypotheses of the theorems . from these hypotheses we use green s function estimates to deduce the relevant convergence of obstacles .",
    "next , properties of the obstacle can often be parlayed into corresponding properties of the least superharmonic majorant .",
    "finally , deducing convergence of domains ( i.e. , noncoincidence sets ) from the convergence of the majorants often requires additional regularity assumptions .",
    "the following lemma illustrates this basic three - step approach .",
    "[ threesteps ] let @xmath46 and @xmath87 , @xmath240 be densities on @xmath1 satisfying @xmath241 for a constant @xmath242 and ball @xmath243 . if @xmath244 in @xmath245 , then    1 .",
    "@xmath246 uniformly on compact subsets of @xmath1 .",
    "@xmath247 uniformly on compact subsets of @xmath1 , where @xmath248 are the least superharmonic majorants of the functions @xmath249 , and @xmath250 , respectively .",
    "3 .   for any @xmath73",
    "we have @xmath251 for all sufficiently large @xmath16 , where @xmath252 are the noncoincidence sets @xmath253 and @xmath254 , respectively .    according to the following lemma",
    ", a nonnegative function on @xmath0 with bounded laplacian can grow at most quadratically .",
    "[ atmostquadratic ] fix @xmath255 .",
    "there is a constant @xmath256 such that any nonnegative function @xmath257 on @xmath0 with @xmath258 and @xmath259 in @xmath260 satisfies @xmath261    we will also use the following continuous version of lemma  [ atmostquadratic ] .",
    "[ continuumatmostquadratic ] fix @xmath255 .",
    "there is a constant @xmath262 such that the following holds .",
    "let @xmath257 be a nonnegative function on @xmath1 with @xmath258 , and let @xmath263 if @xmath264 is subharmonic and @xmath265 is superharmonic in @xmath260 , then @xmath266    in the following lemma , @xmath267 denotes the inner @xmath77-neighborhood of @xmath4 , as defined by ( [ innerepsilonneighborhood ] ) .",
    "[ pointset ] let @xmath105 be bounded open sets .",
    "for any @xmath73 there exists @xmath268 with @xmath269      [ boxandpoints ]    .notation for transitioning between euclidean space and the lattice . [ cols=\">,<,<\",options=\"header \" , ]     fix a sequence @xmath70 with @xmath270 . in this section",
    "we relate discrete superharmonic potentials in the lattice @xmath88 to their continuous counterparts in  @xmath1",
    ". if @xmath4 is a domain in @xmath88 , write @xmath271^d\\ ] ] for the corresponding union of cubes in @xmath1 .",
    "if @xmath4 is a domain in @xmath1 , write @xmath272 .",
    "given @xmath114 , write @xmath273^d \\cap \\delta_n \\z^d\\ ] ] for the closest lattice point to @xmath26 , breaking ties to the right .",
    "for a function @xmath257 on @xmath88 , write @xmath274 for the corresponding step function on @xmath1 . likewise , for a function @xmath257 on @xmath1 , write @xmath275 .",
    "these notations are summarized in table  1 .",
    "we define the discrete laplacian of a function @xmath257 on @xmath88 to be @xmath276 according to the following lemma , if @xmath257 is defined on @xmath1 and is sufficiently smooth , then its discrete laplacian on @xmath88 approximates its laplacian on  @xmath1 .    [ thirdderiv ] if @xmath277 has continuous third derivative in a @xmath278-neighborhood of @xmath80 , and @xmath4 is the maximum pure third partial of @xmath257 in this neighborhood , then @xmath279    in three and higher dimensions , for @xmath280 write @xmath281 where @xmath282 is the green s function for simple random walk on @xmath0 .",
    "the scaling in ( [ definitionofg_n ] ) is chosen so that @xmath283 . in two dimensions ,",
    "write @xmath284 where @xmath285 is the recurrent potential kernel on @xmath15 .",
    "[ greensfunctionconvergence ] in all dimensions @xmath91 , @xmath286 where @xmath287 is given by ( [ greenskernel ] ) .",
    "our next result adapts lemma  [ threesteps](i ) to the discrete setting .",
    "we list here our standing assumptions on the starting densities .",
    "let @xmath46 be a function on @xmath1 with compact support , such that @xmath288 for some absolute constant @xmath242 .",
    "suppose that @xmath46 satisfies @xmath289 where @xmath290 denotes the set of points in @xmath1 where @xmath46 is discontinuous .",
    "for @xmath291 let @xmath87 be a function on @xmath88 satisfying @xmath292 and @xmath293 finally , suppose that @xmath294 although for maximum generality we have chosen to state our hypotheses on @xmath46 and @xmath87 separately , we remark that the above hypotheses on @xmath87 are satisfied in the particular case when @xmath87 is given by averaging @xmath46 over a small box : @xmath295    in parallel to ( [ thepotential ] ) , for @xmath80 write @xmath296 where @xmath297 is given by ( [ definitionofg_n ] ) and ( [ definitionofg_ndimension2 ] ) .",
    "since @xmath298 is discrete harmonic except at  @xmath26 , where it has discrete laplacian @xmath299 , we have for any function @xmath257 on  @xmath88 with bounded support @xmath300 the first equality can be seen directly from the symmetry @xmath301 of the green s function , or else by observing that the operators @xmath31 and @xmath302 are both defined by convolutions , so they commute .    [ greensintegralconvergencecont ] if @xmath46 , @xmath87 satisfy ( [ absolutebound])-([uniformcompactsupport ] ) , then @xmath303 uniformly on compact subsets of @xmath1 .",
    "our next result adapts lemma  [ majorantonacompactset ] to the discrete setting .",
    "let @xmath87 be a function on @xmath88 with finite support , and let @xmath304 be the function on @xmath88 defined by @xmath305 let @xmath306 be the discrete least superharmonic majorant of @xmath304 , and let @xmath307    [ discretemajorantonacompactset ] let @xmath308 be given by ( [ thediscreteobstacle])-([thediscretenoncoincidenceset ] ) . if @xmath309 satisfies @xmath310 , then @xmath311",
    "it will be useful here to prove the abelian property for the divisible sandpile in somewhat greater generality than that of @xcite .",
    "we work in continuous time .",
    "fix @xmath312 , and let @xmath313 \\rightarrow \\z^d$ ] be a function having only finitely many discontinuities in the interval @xmath314 $ ] for every @xmath315 .",
    "the value @xmath316 represents the site being toppled at time @xmath84 .",
    "the odometer function at time @xmath84 is given by @xmath317\\right),\\ ] ] where @xmath62 denotes lebesgue measure .",
    "we will say that @xmath318 is a _ legal toppling function _ for an initial configuration @xmath319 if for every @xmath320 @xmath321 where @xmath322 is the amount of mass present at @xmath26 at time @xmath84 .",
    "if in addition @xmath323 , we say that @xmath318 is _",
    "complete_.    [ abelianproperty ] ( abelian property ) if @xmath324 \\rightarrow \\z^d$ ] and @xmath325 \\rightarrow \\z^d$ ] are complete legal toppling functions for an initial configuration @xmath319 , then for any @xmath64 @xmath326 in particular , @xmath327 and the final configurations @xmath328 , @xmath329 are identical .    for @xmath330 write @xmath331 \\right ) ; \\\\      & \\eta^i_t(x ) = \\eta_0(x ) + \\delta u^i_t(x ) .",
    "\\end{aligned}\\ ] ] write @xmath332 and @xmath333 .",
    "let @xmath334 and let @xmath335 be the points of discontinuity for @xmath336 .",
    "let @xmath337 be the value of @xmath336 on the interval @xmath338 .",
    "we will show by induction on @xmath339 that @xmath340 note that for any @xmath341 , if @xmath342 , then letting @xmath343 be maximal such that @xmath344 , since @xmath345 on the interval @xmath346 , it follows from the inductive hypothesis ( [ inductivehypothesis ] ) that @xmath347 since @xmath336 is legal and @xmath348 is complete , we have @xmath349 hence @xmath350 since @xmath336 is constant on the interval @xmath338 we obtain @xmath351 by ( [ strongerformofindhyp ] ) , each term in the sum on the right side is nonnegative , completing the inductive step .",
    "since @xmath352 as @xmath353 , the right side of ( [ strongerformofindhyp ] ) converges to @xmath354 as @xmath353 , hence @xmath355 .",
    "after interchanging the roles of @xmath336 and @xmath348 , the result follows .    the next lemma is a simple reformulation of lemma  [ discretemajorant ] , but is sometimes more convenient to use .",
    "( least action principle ) [ leastaction ] let @xmath46 be a nonnegative function on  @xmath0 with finite support , and let @xmath147 be its divisible sandpile odometer function . if @xmath356 satisfies @xmath357 then @xmath358 .",
    "from lemma  [ discretemajorant ] we have @xmath187 . since @xmath359 the sum @xmath360 is superharmonic on @xmath0 . since @xmath361 is nonnegative",
    ", it follows that @xmath362 , hence @xmath358 .",
    "note that @xmath361 need not have finite support .",
    "the moniker `` least action principle '' comes from the following interpretation .",
    "starting from @xmath46 , and toppling each site @xmath64 for time @xmath363 without regard to whether these topplings are legal , equation ( [ stabiliizingodom ] ) says that the resulting configuration is stable : no site has mass greater than  @xmath21 .",
    "clearly the odometer  @xmath147 is such a stabilizing function .",
    "the least action principle says that @xmath147 is ( pointwise ) minimal among all such functions .      by the odometer function for the divisible sandpile on @xmath88 with initial density @xmath87",
    ", we will mean the function @xmath364    [ odomconvergence ] let @xmath365 be the odometer function for the divisible sandpile on @xmath88 with initial density @xmath87 . if @xmath46 , @xmath87 satisfy ( [ absolutebound])-([uniformcompactsupport ] ) , then @xmath366 where @xmath367 @xmath170 is given by ( [ thepotential ] ) , and @xmath165 is the least superharmonic majorant of @xmath42 .",
    "[ bigballs ] let @xmath368 be the set of fully occupied sites for the divisible sandpile in @xmath88 started from initial density @xmath87 .",
    "there is a ball @xmath90 with @xmath369    let @xmath370 be the set of fully occupied sites for the divisible sandpile in @xmath88 started from initial density @xmath371 , where @xmath5 is given by ( [ uniformcompactsupport ] ) . from the abelian property , lemma  [ abelianproperty ] , we have @xmath372 . by the inner bound of ( * ? ? ?",
    "* theorem 1.3 ) if we start with mass @xmath373 at the origin in @xmath88 , the resulting set of fully occupied sites contains @xmath374 ; by the abelian property it follows that if we start with mass @xmath375 at the origin in @xmath88 , the resulting set @xmath376 of fully occupied sites contains @xmath370 . by the outer bound of (",
    "* theorem 1.3 ) , @xmath376 is contained in a ball @xmath153 of volume @xmath377 . by lemma  [ occupieddomainisbounded ]",
    "we can enlarge @xmath153 if necessary to contain @xmath45 .    for @xmath80 write @xmath378 where @xmath302 is defined by ( [ thediscretepotential ] ) .",
    "denote by @xmath379 the least superharmonic majorant of @xmath304 in the lattice @xmath88 .",
    "[ gammaupperbound ] let @xmath153 be as in lemma  [ bigballs ] .",
    "there is a constant @xmath380 independent of @xmath16 , such that @xmath381 in @xmath382 .    by lemma  [ greensfunctionconvergence ] we have for @xmath383 @xmath384 for a constant @xmath385 depending only on @xmath214 , where @xmath386 is the radius of @xmath153 .",
    "it follows that @xmath387 in @xmath382 .",
    "[ alphabounds ] fix @xmath388 , and for @xmath389 let @xmath390 there are constants @xmath391 depending only on @xmath214 , such that    1 .   @xmath392 .",
    "2 .   if @xmath393 , then @xmath394 .",
    "\\(i ) by lemma  [ greensfunctionconvergence ] , if @xmath395 then @xmath396 for a constant @xmath385 depending only on @xmath214 . integrating over @xmath397 gives the result .",
    "\\(ii ) let @xmath398 .",
    "by lemma  [ greensfunctionconvergence ] , we have @xmath399 writing @xmath400 , the integrand can be expressed as @xmath401 where @xmath402 since @xmath403 , we have by taylor s theorem with remainder @xmath404    [ truncatedlaplacian ] let @xmath153 be an open ball as in lemma  [ bigballs ] , and let @xmath405 be a ball with @xmath406 .",
    "let @xmath407 then @xmath408 uniformly on @xmath153 .",
    "let @xmath409 be the amount of mass present at @xmath26 in the final state of the divisible sandpile on @xmath88 .",
    "by lemma  [ discretemajorant ] we have @xmath410 , hence @xmath411 in particular , @xmath412 .",
    "note that @xmath413 whereas @xmath414 in @xmath382 , by ( [ inverseoflaplacian ] ) .",
    "hence for @xmath415 @xmath416 where @xmath417 is given by ( [ alphadef ] ) . now write @xmath418 where @xmath419 is supported on the inner boundary of @xmath420 and given there by @xmath421 while @xmath422 is supported on the outer boundary of @xmath420 and given there by @xmath423 the sum in ( [ herecomethealphas ] ) now takes the form @xmath424    let @xmath425 be the radii of @xmath426 . by lemma  [ alphabounds](i ) , summing in spherical shells about @xmath26 , the first sum in ( [ interiorandboundaryterms ] ) is bounded in absolute value by @xmath427 to bound the second sum in ( [ interiorandboundaryterms ] ) , note that @xmath428 outside @xmath153 , so @xmath429 by lemmas  [ gammaupperbound ] and  [ alphabounds](ii ) , the first term is bounded by @xmath430 fix @xmath73 , and let @xmath431 be a ball with @xmath432 . since @xmath42 is uniformly continuous on @xmath431 , and @xmath433 uniformly on @xmath431 by lemma  [ greensintegralconvergencecont ] , for sufficiently large @xmath16 we have @xmath434 thus by lemma  [ alphabounds](i ) the second term in ( [ twogradients ] ) is bounded by @xmath435 since @xmath415 and @xmath37 is adjacent to @xmath436 , we have @xmath437 , so the second sum in ( [ interiorandboundaryterms ] ) is bounded in absolute value by @xmath438 for sufficiently large @xmath16 .",
    "[ majorantconvergence ] @xmath439 uniformly on compact subsets of @xmath1 .    by lemma  [ bigballs ]",
    "there is a ball @xmath153 containing @xmath45 and @xmath440 for all @xmath16 .",
    "outside @xmath153 we have @xmath441 uniformly on compact sets by lemma  [ greensintegralconvergencecont ] .    to show convergence in @xmath153 , write @xmath442 where @xmath443 is the standard smooth mollifier @xmath444 normalized so that @xmath445 ( see ( * ? ?",
    "* appendix c.4 ) ) .",
    "then @xmath446 is smooth and superharmonic .",
    "fix @xmath73 . by lemma  [ majorantbasicprops](ii ) and",
    "compactness , @xmath165 is uniformly continuous on @xmath152 , so taking @xmath447 sufficiently small in ( [ mollified ] ) we have @xmath448 in @xmath153 .",
    "let @xmath267 be the maximum third partial of @xmath446 in @xmath153 .",
    "by lemma  [ thirdderiv ] the function @xmath449 is superharmonic in @xmath382 . by lemma  [ greensintegralconvergencecont ]",
    "we have @xmath450 uniformly in @xmath153 . taking @xmath451 large enough so that @xmath452 in @xmath153 and @xmath453 in @xmath382 for all @xmath454",
    ", we obtain @xmath455 in @xmath382 .",
    "in particular , the function @xmath456 is superharmonic in @xmath382 . by lemma  [ discretemajorantonacompactset ]",
    "it follows that @xmath457 , hence @xmath458 in @xmath382 . by the uniform continuity of @xmath165 on @xmath152 , taking @xmath451 larger if necessary we have @xmath459 in @xmath153 , and hence @xmath460 in @xmath153 for all @xmath454 .    for the reverse inequality , let @xmath461 where @xmath405 is an open ball containing @xmath152 . by lemma  [ truncatedlaplacian ]",
    "we have @xmath462 and hence @xmath463 on @xmath153 for sufficiently large @xmath16 . since @xmath464 is nonnegative on @xmath153 , by lemma  [ superharmonicpotential ] the function @xmath465 is superharmonic on @xmath153 , so by ( [ abovegamma ] ) the function @xmath466 is superharmonic on @xmath153 for sufficiently large @xmath16 . by lemma  [ majorantonacompactset ]",
    "it follows that @xmath467 , hence @xmath468 on @xmath153 for sufficiently large @xmath16 .",
    "let @xmath153 be as in lemma  [ bigballs ] . by lemmas  [ greensintegralconvergencecont ] and  [ majorantconvergence ] we have @xmath469 and @xmath470 uniformly on @xmath153 .",
    "by lemma  [ discretemajorant ] , we have @xmath471 . since @xmath472 off @xmath153",
    ", we conclude that @xmath473 uniformly .",
    "in addition to the conditions ( [ absolutebound])-([uniformcompactsupport ] ) assumed in the previous section , we assume in this section that the initial density @xmath46 satisfies @xmath474 for a constant @xmath223 .",
    "we also assume that @xmath475 moreover , we assume that for any @xmath73 there exists @xmath476 such that @xmath477 and @xmath478 as before , we have chosen to state the hypotheses on @xmath46 and @xmath87 separately for maximum generality , but all hypotheses on @xmath87 are satisfied in the particular case when @xmath87 is given by averaging @xmath46 in a small box ( [ averageinabox ] ) .",
    "we set @xmath479 with @xmath165 the least superharmonic majorant of @xmath42 and @xmath480 we also write @xmath481 for a domain @xmath110 , denote by @xmath267 and @xmath482 its inner and outer open @xmath77-neighborhoods , respectively .",
    "[ domainconvergence ] let @xmath46 and @xmath87 satisfy ( [ absolutebound])-([uniformcompactsupport ] ) and ( [ boundedawayfrom1])-([discretetechnicality ] ) .",
    "for @xmath483 let @xmath368 be the domain of fully occupied sites for the divisible sandpile in @xmath88 started from initial density @xmath87 .",
    "for any @xmath73 we have for large enough @xmath16 @xmath484    according to the following lemma , near any occupied site @xmath485 lying outside @xmath486 , we can find a site @xmath37 where the odometer @xmath365 is relatively large .",
    "this is a discrete version of a standard argument for the obstacle problem ; see for example friedman @xcite , ch .",
    "2 lemma 3.1 .",
    "[ quadraticgrowth ] fix @xmath73 and @xmath485 with @xmath487 .",
    "if @xmath16 is sufficiently large , there is a point @xmath488 with @xmath489 and @xmath490    by ( [ closureofinterior ] ) , we have @xmath491 .",
    "thus if @xmath492 , the ball @xmath493 is disjoint from @xmath494 .",
    "in particular , if @xmath495 , then by ( [ discretetechnicality ] ) we have @xmath496 on @xmath5 .",
    "thus the function @xmath497 is subharmonic on @xmath498 , so it attains its maximum on the boundary . since @xmath499 , the maximum can not be attained on @xmath500 , where @xmath365 vanishes ; so it is attained at some point @xmath501 , and @xmath502 since @xmath503 , the proof is complete .    fix @xmath73 . by lemma  [ pointset ]",
    "we have @xmath504 for some @xmath268 .",
    "let @xmath187 .",
    "since the closure of @xmath505 is compact and contained in @xmath45 , we have @xmath506 on @xmath505 for some @xmath507 . by theorem  [ odomconvergence ] , for sufficiently large @xmath16 we have @xmath508 on @xmath509 , hence @xmath510 .",
    "likewise , by ( [ sillytechnicality ] ) we have @xmath511 for large enough @xmath16 .",
    "thus @xmath512 .    for the other inclusion ,",
    "fix @xmath513 with @xmath492 . since @xmath147 vanishes on the ball @xmath514 , by theorem  [ odomconvergence ] we have @xmath515 on @xmath516 for all sufficiently large @xmath16 . by lemma  [ quadraticgrowth ]",
    "we conclude that @xmath517 , and hence @xmath518 .",
    "in trying to adapt the proofs of theorems  [ odomconvergence ] and  [ domainconvergence ] to the rotor - router model , we are faced with two main problems .",
    "the first is to define an appropriate notion of convergence of integer - valued densities @xmath87 on @xmath88 to a real - valued density @xmath46 on @xmath1 .",
    "the requirement that @xmath87 take only integer values is of course imposed on us by the nature of the rotor - router model itself , since unlike the divisible sandpile , the rotor - router works with discrete , indivisible particles .",
    "the second problem is to find an appropriate analogue of lemma  [ discretemajorant ] for the rotor - router model .",
    "although these two problems may seem unrelated , the single technique of _ smoothing _ neatly takes care of them both . to illustrate the basic idea ,",
    "suppose we are given a domain @xmath110 , and let @xmath87 be the function on @xmath88 taking the value @xmath21 on odd lattice points in @xmath519 , and the value @xmath23 on even lattice points in @xmath519 , while vanishing outside @xmath519 .",
    "we would like to find a sense in which @xmath87 converges to the real - valued density @xmath112 .",
    "one approach is to average @xmath87 in a box whose side length @xmath520 goes to zero more slowly than the lattice spacing : @xmath521 while @xmath522 as @xmath96 .",
    "the resulting `` smoothed '' version of @xmath87 converges to @xmath46 pointwise away from the boundary of @xmath4 .    by smoothing the odometer function in the same way",
    ", we can obtain an approximate analogue of lemma  [ discretemajorant ] for the rotor - router model . rather than average in a box as described above , however , it is technically more convenient to average according to the distribution of a lazy random walk run for a fixed number @xmath523 of steps .",
    "denote by @xmath524 the lazy random walk in @xmath88 which stays in place with probability @xmath525 and moves to each of the @xmath20 neighbors with probability @xmath526 . given a function @xmath257 on @xmath88 ,",
    "define its @xmath339-_smoothing _ @xmath527 from the markov property we have @xmath528 .",
    "also , the discrete laplacian can be written as @xmath529 in particular , @xmath530 .",
    "for @xmath291 let @xmath87 be an integer - valued function on @xmath531 satisfying @xmath532 .",
    "we assume as usual that there is a ball @xmath533 containing the support of @xmath87 for all @xmath16 .",
    "let @xmath46 be a function on @xmath1 supported in @xmath5 satisfying ( [ absolutebound ] ) and ( [ discontmeasurezero ] ) . in place of condition ( [ convergingdensities ] )",
    "we assume that there exist integers @xmath534 with @xmath535 such that @xmath536    by the odometer function for rotor - router aggregation starting from initial density @xmath87 , we will mean the function @xmath537 if @xmath538 particles start at each site @xmath37 .    [ rotorodomconvergence ] let @xmath365 be the odometer function for rotor - router aggregation on @xmath531 starting from initial density @xmath87 . if @xmath539 satisfy ( [ absolutebound])-([discreteabsolutebound ] ) , ( [ uniformcompactsupport ] ) and ( [ smootheddensityconvergence ] ) , then @xmath473 uniformly , where @xmath50 and @xmath165 is the least superharmonic majorant of @xmath42 .    given a function @xmath257 on @xmath88 , for a directed edge @xmath540 write @xmath541 given a function @xmath542 on directed edges in @xmath88 , write @xmath543 the discrete laplacian on @xmath88 is then given by @xmath544 the following  rescaled \" version of ( * ? ? ?",
    "* lemma 5.1 ) is proved in the same way .",
    "[ scaledodomflow ] for a directed edge @xmath540 in @xmath88 , denote by @xmath545 the net number of crossings from @xmath26 to @xmath37 performed by particles during a sequence of rotor - router moves .",
    "let @xmath546 then @xmath547 for some function @xmath101 on directed edges in @xmath88 satisfying @xmath548 for all directed edges @xmath540 .",
    "writing @xmath549 for the number of particles routed from @xmath26 to @xmath37 , for any @xmath550 we have @xmath551 since @xmath552 , we obtain @xmath553 hence @xmath554    let @xmath100 be the final set of occupied sites for rotor - router aggregation on  @xmath88 starting from initial density @xmath87 . since each site @xmath26 starts with @xmath555 particles and ends with either one particle or none accordingly as @xmath556 or @xmath557 , we have @xmath558 taking the divergence in ( [ scaledgradodom ] ) we obtain @xmath559 in particular , since @xmath560 , and @xmath561 , we have @xmath562 on all of @xmath88 .",
    "recall that the divisible sandpile odometer function has laplacian @xmath563 inside the set @xmath368 of fully occupied sites .",
    "the next lemma shows that the same is approximately true of the smoothed rotor - router odometer function  @xmath564 .",
    "denote by @xmath565 and @xmath566 the probability and expectation operators for the lazy random walk @xmath567 defining the smoothing ( [ smoothingdef ] ) , started from @xmath568 .",
    "[ laplacianofsmoothing ] there is a constant @xmath211 depending only on @xmath214 , such that @xmath569    let @xmath542 and @xmath101 be defined as in lemma  [ scaledodomflow ] .",
    "using the fact that @xmath570 and  @xmath31 commute , we obtain from ( [ laplacianofrotorodom ] ) @xmath571 since @xmath572 and @xmath542 are antisymmetric , @xmath101 is antisymmetric by ( [ scaledgradodom ] ) .",
    "thus the last term in ( [ divergenceerrorterm ] ) can be written @xmath573 where the sums are taken over all pairs of neighboring sites @xmath574 .",
    "we can couple lazy random walk @xmath575 started at @xmath26 with lazy random walk @xmath576 started at a neighbor @xmath577 of @xmath26 so that the probability of not coupling in @xmath339 steps is at most @xmath578 , where @xmath385 is a constant depending only on  @xmath214  @xcite .",
    "since the total variation distance between the distributions of @xmath575 and @xmath576 is at most the probability of not coupling , we obtain @xmath579 using the fact that @xmath580 in ( [ readyfortirangleineq ] ) , taking @xmath581 completes the proof .",
    "the next lemma shows that smoothing the rotor - router odometer function does not introduce much extra error .",
    "[ smoothingdist ] @xmath582 .",
    "from ( [ deltaintermsofsmoothing ] ) we have @xmath583 but by lemma  [ laplacianofsmoothing ] @xmath584 summing over @xmath585 yields the result .",
    "let @xmath586 and let @xmath379 be the least superharmonic majorant of @xmath304 . by lemma  [ discretemajorant ] , the difference @xmath587 is the odometer function for the divisible sandpile on @xmath88 starting from the smoothed initial density @xmath588 .",
    "note that by lemma  [ bigballs ] , there is a ball @xmath90 containing the supports of @xmath237 and of @xmath587 for all @xmath16 .",
    "the next lemma compares the smoothed rotor - router odometer for the initial density @xmath87 with the divisible sandpile odometer for the smoothed density @xmath589 .",
    "[ smoothedodomlowerbound ] let @xmath90 be a ball centered at the origin containing the supports of @xmath237 and of @xmath587 for all @xmath16 .",
    "then @xmath590 on all of @xmath88 , where @xmath178 is the radius of @xmath153 .    since @xmath591 by lemma  [ laplacianofsmoothing ]",
    "the function @xmath592 is superharmonic on @xmath88 .",
    "since @xmath593 on @xmath382 , the function @xmath594 is superharmonic on @xmath382 , hence @xmath595 by lemma  [ discretemajorantonacompactset ] .",
    "thus @xmath596 on @xmath382 , so ( [ onesidedodomcomparison ] ) holds on @xmath382 and hence everywhere .",
    "[ rotorbigballs ] let @xmath100 be the set of occupied sites for rotor - router aggregation in @xmath88 started from initial density @xmath87 .",
    "there is a ball @xmath90 with @xmath597 .    by assumption",
    "there is a ball @xmath533 containing the support of @xmath87 for all @xmath16 .",
    "let @xmath370 be the set of occupied sites for rotor - router aggregation in @xmath88 started from initial density @xmath371 . from the abelian property we have @xmath598 .",
    "by the inner bound of ( * ? ? ?",
    "* theorem  1.1 ) , if @xmath599 particles perform rotor - router aggregation starting at the origin in @xmath88 , the resulting set of occupied sites contains @xmath374 ; by the abelian property it follows that if we start with @xmath600 particles at the origin , the resulting set @xmath376 of fully occupied sites contains @xmath370 . by the outer bound of (",
    "* theorem  1.1 ) , @xmath376 is contained in a ball @xmath153 of volume @xmath377 .",
    "let @xmath601 the following lemma shows that the rotor - router odometer grows at most quadratically as we move away from the boundary of @xmath100 .",
    "[ rotoratmostquadratic ] for any @xmath602 , if @xmath603 , then for any @xmath604 @xmath605 where @xmath606 is the constant in lemma  [ atmostquadratic ] .",
    "if @xmath603 , then there is a point @xmath607 with @xmath608 . since @xmath609 , we have by ( [ rotorlaplacianbound ] ) and lemma  [ atmostquadratic ] @xmath610    by lemma  [ bigballs ] there is a ball @xmath153 containing the support of @xmath237 and of @xmath587 for all @xmath16 . by lemma  [ rotorbigballs ]",
    "we can enlarge @xmath153 if necessary to contain the support of @xmath611 for all @xmath16 .",
    "by lemma  [ laplacianofsmoothing ] , the function @xmath612 is subharmonic on the set @xmath613 since @xmath614 for @xmath615 .    given a point @xmath616 , we have by lemma  [ rotoratmostquadratic ] @xmath617 now by lemma  [ smoothingdist ] , @xmath618 the right side is at most @xmath619 , where @xmath620 . since @xmath621 , we obtain for all @xmath622 @xmath623 where @xmath178 is the radius of @xmath153 . by the maximum principle , ( [ smalloutsider_ntilde ] ) holds for all @xmath624 .",
    "now from lemma  [ smoothedodomlowerbound ] we obtain @xmath625 on all of @xmath88 .    by lemmas  [ greensintegralconvergencecont ] and  [ majorantconvergence ] we have @xmath469 and @xmath470 uniformly on @xmath153 .",
    "since @xmath534 and @xmath535 , we conclude from ( [ twosidedbound ] ) that @xmath626 uniformly on @xmath153 . since both @xmath611 and @xmath237 vanish outside @xmath153 , this convergence is uniform on @xmath1 . by lemma  [ smoothingdist ]",
    "we have @xmath627 uniformly on @xmath88 , and hence @xmath628 uniformly on @xmath1 .",
    "in addition to the assumptions of the previous section , in this section we require that @xmath629 we also assume that @xmath630 moreover , we assume that for any @xmath73 there exists @xmath476 such that @xmath631 and @xmath632    [ rotordomainconvergence ] let @xmath46 and @xmath87 satisfy ( [ absolutebound])-([discreteabsolutebound ] ) , ( [ uniformcompactsupport ] ) , ( [ smootheddensityconvergence ] ) and ( [ rotorboundedawayfrom1])-([rotordiscretetechnicality ] ) . for @xmath483 , let @xmath100 be the final domain of occupied sites for rotor - router aggregation in @xmath88 started from initial density @xmath87 . for any @xmath73 we have for all sufficiently large @xmath16 @xmath633 where @xmath634    [ bootstrappinggrowth ] fix @xmath73 and @xmath635 . given @xmath636 and @xmath637 , let @xmath638 if @xmath639 on @xmath640 , then @xmath641    by ( [ rotorclosureofinterior ] ) , we have @xmath642 .",
    "the ball @xmath640 is disjoint from @xmath643 , so by ( [ rotordiscretetechnicality ] ) we have @xmath644 for all @xmath645 . since at least @xmath646 particles must enter the ball @xmath647 , we have @xmath648 there are at most @xmath649 nonzero terms in the sum on the left side , and each term is at most @xmath650 , hence @xmath651    the following lemma can be seen as a weak analogue of lemma  [ quadraticgrowth ] for the divisible sandpile . in lemma  [ rotorquadraticgrowth ] , below , we obtain a more exact analogue under slightly stronger hypotheses .",
    "[ slowgrowth ] for any @xmath73 , if @xmath16 is sufficiently large and @xmath652 with @xmath636 , then there is a point @xmath653 with @xmath654 and @xmath655    take @xmath635 large enough so that @xmath656 .",
    "let @xmath231 be the maximum value of @xmath657 on @xmath658 .",
    "since @xmath652 we have @xmath659 . iteratively applying lemma  [ bootstrappinggrowth ] , we obtain @xmath660 for large enough @xmath16 we have @xmath661 hence @xmath662 solving for @xmath231 yields the result .",
    "[ rotorquadraticgrowth ] fix @xmath73 and @xmath663 , where @xmath211 is the constant in lemma  [ laplacianofsmoothing ] .",
    "there is a constant @xmath664 such that if @xmath652 , @xmath665 satisfies @xmath666 and @xmath16 is sufficiently large , then there exists @xmath667 with @xmath668 and @xmath669    let @xmath620 .",
    "note first that by lemma  [ smoothingdist ] and ( [ decentsized ] ) @xmath670 so @xmath671 by lemma  [ rotoratmostquadratic ] .    by lemma  [ laplacianofsmoothing ]",
    ", we have @xmath672 note that @xmath673",
    ". take @xmath674 large enough so that @xmath675 ; then @xmath676 vanishes on the ball @xmath677 by ( [ rotordiscretetechnicality ] ) .",
    "thus the function @xmath678 is subharmonic on @xmath679 , so it attains its maximum on the boundary .",
    "if @xmath680 , then by lemma  [ rotoratmostquadratic ] @xmath681 from lemma  [ smoothingdist ] we obtain @xmath682 thus @xmath683 . since @xmath615 , it follows that @xmath257 can not attain its maximum in @xmath684 at a point @xmath685 , and hence must attain its maximum at a point @xmath501 . since @xmath686",
    "we conclude that @xmath687    fix @xmath73 .",
    "let @xmath187 and @xmath688 .",
    "by lemma  [ pointset ] we have @xmath504 for some @xmath268 .",
    "since the closure of @xmath505 is compact and contained in @xmath45 , we have @xmath506 on @xmath505 for some @xmath507 . by theorem  [ rotorodomconvergence ] , for sufficiently large @xmath16 we have @xmath689 on @xmath509 , hence @xmath690 .",
    "likewise , by ( [ rotorsillytechnicality ] ) we have @xmath691 for large enough @xmath16 .",
    "thus @xmath692 .    for the other inclusion ,",
    "fix @xmath80 with @xmath492 . since @xmath147 vanishes on the ball @xmath693 , by theorem  [ rotorodomconvergence ] we have @xmath694 on @xmath374 for all sufficiently large @xmath16 .",
    "let @xmath695 , and take @xmath16 large enough so that @xmath696",
    ". then @xmath697 on the ball @xmath698 . by lemma  [ rotorquadraticgrowth ]",
    "it follows that @xmath699 on the smaller ball @xmath700 .",
    "in particular , for @xmath701 we have @xmath702 where  @xmath703 is a constant depending only on  @xmath214 . for sufficiently large @xmath16",
    "the right side is at most @xmath704 , so we conclude from lemma  [ slowgrowth ] that @xmath705 .",
    "our hypotheses for convergence of internal dla domains are the same as those for the rotor - router model : @xmath46 is a bounded , nonnegative , compactly supported function on @xmath1 that is continuous almost everywhere and @xmath706 on its support ; and @xmath707 is a sequence of uniformly bounded functions on @xmath88 with uniformly bounded supports , whose `` smoothings '' converge pointwise to @xmath46 at all continuity points of @xmath46 .",
    "[ idlaconvergence ] let @xmath46 and @xmath87 satisfy ( [ absolutebound])-([discreteabsolutebound ] ) , ( [ uniformcompactsupport ] ) , ( [ smootheddensityconvergence ] ) and ( [ rotorboundedawayfrom1])-([rotordiscretetechnicality ] ) .",
    "for @xmath483 let @xmath708 be the random domain of occupied sites for internal dla in @xmath88 started from initial density @xmath87 .",
    "if @xmath98 , then for all @xmath73 we have with probability one @xmath709 where @xmath634      fix @xmath710 , and label the particles in @xmath88 by the integers @xmath711 , where @xmath712 . let @xmath120 be the starting location of the particle labeled @xmath713 , so that @xmath714 for each @xmath715 let @xmath716 be a simple random walk in @xmath88 such that @xmath717 , with @xmath718 and @xmath719 independent for @xmath720 .    for @xmath721 and @xmath73 , consider the stopping times @xmath722 the stopping time @xmath723 is defined inductively in @xmath713 with @xmath724 .",
    "we think of building up the internal dla cluster one site at a time , by letting the particle labeled @xmath713 walk until it exits the set of sites already occupied by particles with smaller labels . thus @xmath723 is the number of steps taken by the particle labeled @xmath713 , and @xmath725 is the location where it stops .",
    "fix @xmath726 and consider the random variables @xmath727 these sums can be interpreted in terms of the following two - stage procedure . during the first stage , we let each particle walk until it either reaches an unoccupied site or exits @xmath728 . in the second stage , we let each particle that did not already exit @xmath728 continue walking until it exits @xmath728 . then @xmath729 counts the number of particles that visit @xmath730 during both stages , while @xmath731 counts the number of particles that visit @xmath730 during the second stage . in particular ,",
    "if @xmath732 , then @xmath730 was visited during the first stage and hence belongs to the occupied cluster @xmath708 .",
    "the sum @xmath731 is difficult to estimate directly because the indicator random variables in the sum are not independent .",
    "following @xcite , we can bound @xmath731 by a sum of independent indicators as follows .",
    "for each site @xmath733 , let @xmath734 be a simple random walk in @xmath88 such that @xmath735 , with @xmath736 and  @xmath737 independent for @xmath738 .",
    "let @xmath739 where @xmath740 thus @xmath741 counts the number of walks @xmath742 that hit @xmath730 before exiting @xmath728 . since the sites @xmath725 are distinct , we can couple the walks @xmath743 and @xmath744 so that @xmath745 .    define @xmath746 where @xmath747 is the green s function for simple random walk in @xmath88 stopped on exiting @xmath728 .",
    "then @xmath748 where in the last step we have used the identity @xmath749 thus @xmath750 solves the dirichlet problem @xmath751    note that the divisible sandpile odometer function @xmath365 for the initial density @xmath87 solves exactly the same dirichlet problem , with the domain @xmath728 in ( [ laplacianoff ] ) and ( [ boundarycondf ] ) replaced by the domain @xmath752 of fully occupied sites .",
    "our strategy will be first to argue that since the domains @xmath368 and @xmath45 are close , the solutions to the dirichlet problems in @xmath368 and @xmath728 should be close ; next , by theorem  [ odomconvergence ] , since @xmath753 it follows that the functions @xmath750 and @xmath147 are close . since @xmath147 is strictly positive in @xmath75 , we obtain in this way a lower bound on @xmath750 , and hence a lower bound on @xmath754 . finally , using large deviations for sums of independent indicators ,",
    "we conclude that with high probability @xmath755 , and hence with high probability every point @xmath726 belongs to the occupied cluster @xmath708 .",
    "the core of the argument is lemma  [ coreoftheargument ] , below , which gives the desired lower bound on @xmath750 .    in order to apply theorem  [ odomconvergence ]",
    ", we must have discrete densities which converge pointwise to @xmath46 at all continuity points of @xmath46 .",
    "recall , however , that in order to allow @xmath46 to assume non - integer values , we have chosen not to assume that @xmath87 converges to @xmath46 , but rather only that the _ smoothed density _ @xmath756 converges to @xmath46 ; see ( [ smootheddensityconvergence ] ) .",
    "the next lemma shows that this initial smoothing step does not change the divisible sandpile odometer by very much .",
    "[ odometerofsmoothing ] let @xmath757 be an integer , and let @xmath365 ( resp .",
    "@xmath758 ) be the odometer function for the divisible sandpile on @xmath88 started from initial density @xmath87 ( resp .",
    "@xmath676 ) .",
    "if @xmath87 has finite support and @xmath560 , then @xmath759    from ( [ deltaintermsofsmoothing ] ) we have the identity @xmath760 . by induction on @xmath339",
    ", it follows that @xmath761 where @xmath762 since @xmath763 for all @xmath585 , we have @xmath764 .",
    "let @xmath765 ( resp .",
    "@xmath766 ) be the final mass density on @xmath88 for the divisible sandpile started from initial density @xmath87 ( resp .",
    "@xmath676 ) .",
    "then @xmath767 since @xmath768 and @xmath769 , lemma  [ leastaction ] yields @xmath770 .",
    "likewise @xmath771 since @xmath772 and @xmath773 , lemma  [ leastaction ] yields @xmath774 .",
    "the next lemma adapts theorem  [ odomconvergence ] to our current setting .",
    "the hypotheses are identical to those of theorem  [ odomconvergence ] , except that the convergence of smoothed densities ( [ smootheddensityconvergence ] ) replaces ( [ convergingdensities ] ) .",
    "[ unsmoothedconvergence ] let @xmath365 be the odometer function for the divisible sandpile on @xmath88 with initial density @xmath87 , and let @xmath775 . if @xmath46 and @xmath87 satisfy ( [ absolutebound])-([discreteabsolutebound ] ) , ( [ uniformcompactsupport ] ) and ( [ smootheddensityconvergence ] ) , then @xmath776 uniformly .",
    "moreover , for any @xmath73 we have @xmath777 for all sufficiently large @xmath16 .",
    "let @xmath758 be the odometer function for the divisible sandpile on @xmath88 started from initial density @xmath756 .",
    "then @xmath778 uniformly by theorem  [ odomconvergence ] .",
    "by lemma  [ odometerofsmoothing ] , we have for all @xmath779 @xmath780 since the right side tends to zero as @xmath96 , we obtain @xmath781 uniformly .",
    "let @xmath604 be the minimum value of @xmath147 on @xmath782 .",
    "taking @xmath16 large enough so that @xmath783 , we have @xmath784 on @xmath728 , hence @xmath777 .",
    "[ coreoftheargument ] fix @xmath73 , and let @xmath604 be the minimum value of @xmath187 on @xmath782 .",
    "there exists @xmath785 such that for all sufficiently large @xmath16 @xmath786    since @xmath147 is uniformly continuous on @xmath787 and vanishes outside @xmath45 , we can choose @xmath268 small enough so that @xmath788 outside @xmath505 . since @xmath789 on @xmath782 , we have @xmath790 .",
    "let @xmath365 be the odometer function for the divisible sandpile on @xmath88 started from initial density @xmath87 , and let @xmath791 be the resulting domain of fully occupied sites in @xmath88 .",
    "we have @xmath792 uniformly by lemma  [ unsmoothedconvergence ] , so for @xmath16 sufficiently large we have @xmath793 , hence @xmath794 on @xmath795 .",
    "by lemma  [ unsmoothedconvergence ] we have @xmath796 for all sufficiently large @xmath16 . now ( [ laplacianoff ] ) implies that the difference @xmath797 is harmonic on @xmath509 , so it attains its minimum on the boundary . since @xmath798 vanishes on @xmath799 , we obtain for @xmath800 @xmath801 since @xmath802 in @xmath728 , we conclude that @xmath803 in @xmath728 .",
    "[ exittime ] we have @xmath804 moreover @xmath805    by ( [ greensquotient ] ) and the symmetry of @xmath806 ,",
    "we have @xmath807 the sum in the last line is @xmath808 .    to prove the inequality for @xmath809 , note that @xmath809 is bounded above by @xmath242 times the sum on the right side of ( [ exactforl ] )",
    "the next lemma , using a martingale argument to compute the expected time for simple random walk to exit a ball , is well known .",
    "[ ballexittime ] fix @xmath810 and let @xmath811 , and let @xmath318 be the first hitting time of @xmath812 . then @xmath813    since @xmath814 is a martingale with bounded increments , and @xmath815 , by optional stopping we have @xmath816    the next lemma , which bounds the expected number of times simple random walk returns to the origin before reaching distance @xmath178 , is also well known .",
    "[ ballgreens ] fix @xmath810 and let @xmath811 , and let @xmath817 be the green s function for simple random walk stopped on exiting @xmath5 .",
    "if @xmath16 is sufficiently large , then @xmath818    in dimension @xmath35 the result is trivial since simple random walk on @xmath88 is transient . in dimension two , consider the function @xmath819 where @xmath297 is the rescaled potential kernel defined in ( [ definitionofg_ndimension2 ] ) .",
    "since @xmath257 is harmonic in @xmath5 it attains its maximum on the boundary , hence by lemma  [ greensfunctionconvergence ] we have for @xmath820 @xmath821 since @xmath822 , the result follows on setting @xmath823 .",
    "we will use the following large deviation bound ; see ( * ? ? ?",
    "a.14 ) .",
    "[ alonspencer ] if @xmath451 is a sum of finitely many independent indicator random variables , then for all @xmath824 @xmath825 where @xmath826 is a constant depending only on @xmath447 .",
    "let @xmath827 where @xmath723 is given by ( [ stoppingtimefortheithparticle ] ) , and @xmath828 the inner estimate of theorem  [ idlaconvergence ] follows immediately from the lemma below .",
    "although for the inner estimate it suffices to prove lemma  [ stronginnerestimate ] with @xmath708 in place of @xmath829 , we will make use of the stronger statement with @xmath829 in the proof of the outer estimate in the next section .",
    "[ stronginnerestimate ] for any @xmath73 , @xmath830    for @xmath831 , let @xmath832 be the event that @xmath833 . by borel - cantelli it suffices to show that @xmath834 by lemma  [ pointset ] , since @xmath224 we have @xmath835 for some @xmath836 . by ( [ rotorsillytechnicality ] ) , for @xmath837 the terms in ( [ borelcantelliwiths ] ) with @xmath838 vanish , so it suffices to show @xmath839    by lemma  [ coreoftheargument ] there exists @xmath840 such that @xmath841 for all sufficiently large @xmath16 , where @xmath604 is the minimum value of @xmath147 on @xmath842 . fixing @xmath843 , since @xmath844 we have @xmath845 for a real number @xmath846 to be chosen below . by lemma  [ alonspencer ] ,",
    "since @xmath847 and @xmath848 are sums of independent indicators , we have @xmath849 where @xmath850 depends only on @xmath447 , chosen below . now",
    "since @xmath851 and @xmath45 is bounded by lemma  [ occupieddomainisbounded ] , we have @xmath852 hence by lemma  [ ballexittime ] @xmath853 by lemma  [ exittime ] it follows that @xmath854 .",
    "taking @xmath855 in ( [ choiceofa ] ) , and letting @xmath856 in ( [ largedevbounds ] ) , we have @xmath857 hence @xmath858 moreover , from ( [ fromthecore ] ) we have @xmath859 hence by ( [ thisfollowsfromthedefinitions ] ) @xmath860    thus we obtain from ( [ choiceofa ] ) and ( [ largedevbounds ] ) @xmath861 by lemmas  [ exittime ] and  [ ballgreens ] along with ( [ quadraticexittimebound ] ) @xmath862 using ( [ largedev ] ) , the sum in ( [ borelcantelliwithd ] ) is thus bounded by @xmath863      for @xmath64 write @xmath864 for the cube of side length @xmath865 centered at @xmath26 . according to the next lemma , if we start a simple random walk at distance @xmath63 from a hyperplane @xmath866 , then the walk is fairly `` spread out '' by the time it hits @xmath867 , in the sense that its chance of first hitting @xmath867 at any particular point @xmath730 has the same order of magnitude as @xmath730 ranges over a @xmath868-dimensional cube of side length order @xmath63 .",
    "[ boxshells ] fix @xmath869 with @xmath870 , and let @xmath318 be the first hitting time of the hyperplane @xmath871 .",
    "let @xmath872 .",
    "for any @xmath873 we have @xmath874 for a constant @xmath846 depending only on @xmath214 .    for fixed @xmath875 ,",
    "the function @xmath876 is harmonic in the ball @xmath877 . by the harnack inequality ( *",
    "* theorem 1.7.2 ) we have @xmath878 for a constant @xmath879 depending only on @xmath214 . by translation invariance",
    ", it follows that for @xmath880 , letting @xmath881 we have @xmath882 iterating , we obtain for any @xmath883 @xmath884 let @xmath885 be the first exit time of the cube @xmath886 . since @xmath887 is a boundary face of this cube , we have @xmath888 .",
    "let @xmath889 be the closest point to @xmath37 in @xmath867 .",
    "taking @xmath890 , we have @xmath883 whenever @xmath891 . summing ( [ harnackincube ] ) over @xmath891 , we obtain @xmath892 now for any @xmath893 , taking @xmath894 and @xmath895 in ( [ harnackincube ] ) , we conclude that @xmath896    [ thetrenches ] let @xmath897 be positive integers .",
    "let @xmath451 be the number of particles that ever visit the cube @xmath898 during the internal dla process , if one particle starts at each site @xmath899 , and @xmath339 additional particles start at sites @xmath900 . if @xmath901 , then @xmath902 where @xmath903 is a constant depending only on @xmath214 .",
    "let @xmath904 be a half - space defining a face of the cube @xmath905 , such that dist@xmath906 .",
    "let @xmath907 be the closest point to @xmath10 in @xmath904 , and let @xmath908 .",
    "let @xmath909 be the random set of sites where the particles starting at @xmath910 stop .",
    "since @xmath911 , there is a hyperplane @xmath912 parallel to @xmath904 and intersecting @xmath913 , such that @xmath914 denote by @xmath915 the event that the particle starting at @xmath10 ever visits @xmath916 . on this event , the particle must pass through @xmath912 at a site which was already occupied by an earlier particle .",
    "thus if @xmath917 is the random walk performed by the particle starting at @xmath10 , then @xmath918 where @xmath318 is the first hitting time of @xmath912 . by lemma  [ boxshells ]",
    ", every site @xmath919 satisfies @xmath920 from ( [ sparseslice ] ) , since @xmath921 we obtain @xmath922 , hence @xmath923 where @xmath924 , and @xmath925 is the @xmath46-algebra generated by the walks performed by the particles starting at @xmath926 .",
    "thus we can couple the indicators @xmath927 with i.i.d .",
    "indicators @xmath928 of mean @xmath929 to obtain @xmath930    the next lemma shows that if few enough particles start outside a cube @xmath931 , it is highly unlikely that any of them will reach the smaller cube @xmath898 .",
    "[ cubedeath ]",
    "let @xmath932 be positive integers with @xmath933 where @xmath903 is the constant in lemma  [ thetrenches ] .",
    "let @xmath451 be the number of particles that ever visit the cube @xmath898 during the internal dla process , if one particle starts at each site @xmath934 , and @xmath339 additional particles start at sites @xmath935 .",
    "then @xmath936 where @xmath937 are constants depending only on @xmath214 .",
    "let @xmath938 be the number of particles that ever visit the cube @xmath939 , where @xmath940 let @xmath941 , and let @xmath915 be the event that @xmath942 .",
    "taking @xmath943 in lemma  [ thetrenches ] , since @xmath944 we obtain @xmath945 hence @xmath946 where in the second line we have used lemma  [ alonspencer ] with @xmath947 .",
    "now let @xmath948 so that @xmath949 .",
    "on the event @xmath915 , at most @xmath101 particles visit the cube @xmath950 . since the first particle to visit each cube @xmath951 stops there , at most @xmath952 particles visit @xmath951 .",
    "taking @xmath953 we obtain @xmath954 . from ( [ conditionalprobintermsofbinomial ] )",
    "we conclude that @xmath955 the right side is at least @xmath956 for suitable constants @xmath957 .",
    "the inner estimate is immediate from lemma  [ stronginnerestimate ] . for the outer estimate ,",
    "let @xmath958 be the number of particles that leave @xmath959 before aggregating to the cluster .",
    "let @xmath960 , where @xmath929 is the constant in lemma  [ thetrenches ] . for @xmath73 and @xmath961 , consider the event @xmath962 by ( [ rotorboundedawayfrom1 ] ) and ( [ rotorclosureofinterior ] ) , the closure of @xmath963 contains the support of @xmath46 , so by proposition  [ boundaryregularity ] , @xmath964 moreover , by proposition  [ boundaryregularity](i ) , for sufficiently small @xmath443 we have @xmath965 taking @xmath16 large enough so that @xmath966 , we obtain @xmath967 thus for sufficiently large @xmath16 , on the event @xmath968 we have @xmath969 where in the last line we have used ( [ fromconservationofmass ] ) . from lemma  [ stronginnerestimate ]",
    "we obtain @xmath970 as @xmath971 .    by compactness",
    ", we can find finitely many cubes @xmath972 of side length @xmath973 centered at points @xmath974 , with @xmath975 . taking @xmath976 and @xmath977 in lemma  [ cubedeath ] , since the cube of side length @xmath978 centered at @xmath120 is disjoint from @xmath963 , we obtain for @xmath979 @xmath980 since @xmath981 , summing over @xmath713 yields @xmath982 by borel - cantelli , if @xmath983 is the event that @xmath984 for infinitely many @xmath16 , then @xmath985 . from ( [ probtendingto1 ] )",
    "we conclude that @xmath986 .",
    "this section is devoted to proving theorem  [ multiplepointsources ] .",
    "we further show in proposition  [ ballquadrature ] that the smash sum of balls arising in theorem  [ multiplepointsources ] is a classical quadrature domain . in particular",
    ", the boundary of the smash sum of  @xmath339 disks in  @xmath132 lies on an algebraic curve of degree at most  @xmath135 .      in this section",
    "we establish a few basic properties of the smash sum ( [ smashsumdef ] ) . in lemma  [ associativity ]",
    "we show that the smash sum is associative . in lemma  [ volumecontinuity ]",
    "we show that the smash sum is continuous with respect to the metric on bounded open sets @xmath105 given by @xmath987 where @xmath988 denotes the symmetric difference @xmath989 , and @xmath62 is lebesgue measure on  @xmath1 .",
    "lastly , in lemma  [ sumofneighborhoods ] we show that the smash sum is also continuous in a variant of the hausdorff metric .",
    "[ associativity ] let @xmath990 be bounded open sets whose boundaries have lebesgue measure zero .",
    "then @xmath991 where @xmath45 is given by ( [ thenoncoincidenceset ] ) with @xmath992 .",
    "let @xmath993 and @xmath994 let @xmath208 and @xmath995 , where @xmath996 are the least superharmonic majorants of @xmath997 . then @xmath998 let @xmath765 be the final mass density for the divisible sandpile in @xmath88 started from initial density @xmath999 , and let @xmath365 be the corresponding odometer function . by theorem  [ odomconvergence ]",
    "we have @xmath1000 as @xmath123 .",
    "moreover , by theorem  [ domainconvergence ] we have @xmath1001 for all @xmath1002 .",
    "let @xmath1003 be the odometer function for the divisible sandpile on @xmath88 started from initial density @xmath1004 . by proposition",
    "[ boundaryregularity](i ) the right side of ( [ restatementofdomainconvergence ] ) is continuous almost everywhere , so by theorem  [ odomconvergence ] we have @xmath1005 as @xmath123 . on the other hand , by the abelian property , lemma  [ abelianproperty ] , the sum @xmath1006 is the odometer function for the divisible sandpile on @xmath88 started from initial density @xmath1007 , so by theorem  [ odomconvergence ] we have @xmath1008 , where @xmath1009 and @xmath446 is the least superharmonic majorant of @xmath1010 .",
    "in particular , @xmath1011 so the right side of ( [ sumofodometers ] ) is equal to @xmath1012 .",
    "[ volumecontinuity ] let @xmath1013 be bounded open subsets of @xmath1 whose boundaries have measure zero .",
    "then @xmath1014    let @xmath1015 , and @xmath1016 for @xmath330 . then by lemma  [ associativity ] , @xmath1017 by corollary  [ volumesadd ] , @xmath1018 hence @xmath1019 by the triangle inequality",
    ", we conclude that @xmath1020    the following lemma shows that the smash sum of two sets with a small intersection can not extend very far beyond their union . as usual",
    ", @xmath482 denotes the outer @xmath77-neighborhood ( [ neighborhoods ] ) of a set @xmath110 .",
    "[ limitedexpansion ] let @xmath105 be bounded open sets whose boundaries have measure zero , and let @xmath1021 .",
    "there is a constant @xmath879 , independent of @xmath4 and @xmath5 , such that @xmath1022    let @xmath1023 be given by ( [ theobstacle ] ) and ( [ themajorant ] ) with @xmath1024 , and write @xmath187 .",
    "fix @xmath1025 and let @xmath1026 dist@xmath1027 .",
    "let @xmath1028 .",
    "by lemma  [ majorantbasicprops](iii ) , @xmath165 is harmonic in @xmath1029 , so by lemma  [ superharmonicpotential ] the function @xmath1030 is harmonic on the intersection @xmath1031 ; hence it attains its maximum on the boundary . since @xmath1032 the maximum can not be attained on @xmath1033 , so it is attained at some point @xmath1034 , and @xmath1035    if @xmath730 is any point outside @xmath14 , then by lemma  [ laplacianofodometer ] and lemma  [ continuumatmostquadratic ] with @xmath1036 , there is a constant @xmath1037 such that @xmath1038 on @xmath1039 for all @xmath63 .",
    "taking @xmath1040 , we conclude from ( [ largeodom ] ) that @xmath1041 . since @xmath1042 is disjoint from @xmath1043 , we have by corollary  [ volumesadd ] @xmath1044 hence @xmath1045 . taking @xmath1046 yields @xmath1047 .",
    "the next lemma , together with lemma  [ monotonicity ] , shows that the smash sum is continuous with respect to the metric @xmath1048 on bounded open sets @xmath105 . here",
    "@xmath1049 and @xmath1050 denote the inner and outer neighborhoods ( [ neighborhoods ] ) of  @xmath4 .",
    "this metric , which we call the _ inner - outer hausdorff metric _",
    ", is related to the usual hausdorff metric @xmath1051 by @xmath1052    [ sumofneighborhoods ] let @xmath105 be bounded open sets whose boundaries have measure zero . for any @xmath73 there",
    "exists @xmath268 such that @xmath1053    by lemma  [ pointset ] , since @xmath1054 , we have @xmath1055 for some @xmath836 . by lemma  [ threesteps](iii ) with @xmath1024 and @xmath1056 , for sufficiently small @xmath443 we have @xmath1057 .",
    "this proves the first inclusion in ( [ threeinclusions ] ) .",
    "the second inclusion is immediate from lemma  [ monotonicity ] .    for the final inclusion , write @xmath1058 and @xmath1059 . since @xmath1060 and @xmath1061 as @xmath1062 , for small enough @xmath443 we have by lemmas  [ associativity ] and  [ limitedexpansion ]",
    "@xmath1063      in this section we deduce theorem  [ multiplepointsources ] from our other results , using the main results of @xcite and @xcite .",
    "the following theorem collects the results of ( * ? ? ?",
    "* theorem 1.3 ) for the divisible sandpile , ( * ? ?",
    "* theorem 1.1 ) for the rotor - router model , and ( * ? ? ? * theorem 1 ) for internal dla .",
    "[ singlepointsource ] fix @xmath824 and a sequence @xmath70 , and let @xmath368 be the domain of fully occupied sites for the divisible sandpile in @xmath88 started from mass @xmath1064 at the origin .",
    "likewise , let @xmath1065 be the domains of occupied sites in @xmath88 formed respectively from the rotor - router model ( with initial rotors configured arbitrarily ) and internal dla , starting with @xmath231 particles at the origin .",
    "for any @xmath73 , we have @xmath1066 where @xmath5 is the ball of volume @xmath447 centered at the origin in @xmath1 . moreover , if @xmath1067 , then with probability one @xmath1068    for @xmath1069 let @xmath1070 be the domain of occupied sites in @xmath88 starting from a single point source of @xmath1071 particles at @xmath1072 . by theorem  [ singlepointsource ] , for any @xmath268 we have with probability one @xmath1073 and if @xmath1067 , then with probability one @xmath1074    next we argue that the domains @xmath122 can be understood as smash sums of @xmath1070 as @xmath713 ranges over the integers @xmath1075 . by the abelian property @xcite , the domain @xmath708 is the diaconis - fulton smash sum in @xmath88 of the domains @xmath1076 . likewise",
    ", if @xmath1077 is an arbitrary rotor configuration on @xmath88 , let @xmath1078 be the smash sum of @xmath1079 and @xmath1080 formed using rotor - router dynamics with initial rotor configuration @xmath1077 , and let @xmath1081 be the resulting final rotor configuration . for @xmath1082",
    "define @xmath1083 inductively as the smash sum of @xmath1084 and @xmath1085 formed using rotor - router dynamics with initial rotor configuration @xmath1086 , and let @xmath1087 be the resulting final rotor configuration .",
    "then @xmath1088 . finally , by lemma  [ abelianproperty ] , the domain @xmath368 contains the smash sum of domains @xmath1089 formed using divisible sandpile dynamics , and @xmath368 is contained in the smash sum of the domains @xmath1090 .",
    "fixing @xmath73 , by theorem  [ dfsum ] and lemma  [ monotonicity ] , it follows from ( [ singlepointsources ] ) and ( [ singlepointsourcesidla ] ) that for all sufficiently large @xmath16 @xmath1091 where @xmath4 is the smash sum of the balls @xmath1092 , and @xmath1093 is the smash sum of the balls @xmath1094 . by lemma  [ sumofneighborhoods ]",
    "we can take @xmath443 sufficiently small so that @xmath1095 where @xmath1096 .",
    "together with ( [ squeezed ] ) , this completes the proof .",
    "[ ballquadrature ] fix @xmath116 and @xmath1097 .",
    "let @xmath118 be the ball of volume @xmath119 centered at @xmath120",
    ". then @xmath1098 for all integrable superharmonic functions @xmath63 on @xmath128",
    ".    we could deduce proposition  [ ballquadrature ] from proposition  [ boundaryregularitysmooth ] by integrating smooth approximations to @xmath63 against smooth densities @xmath87 converging to the sum of the indicators of the @xmath118 . however , it more convenient to use the following result of m. sakai , which is proved by a similar type of approximation argument .",
    "7.5 ) [ fromsakai ] let @xmath90 be a bounded open set , and let @xmath46 be a bounded function on @xmath1 supported on @xmath152 satisfying @xmath1099 on @xmath153 .",
    "let @xmath1100 be given by ( [ theobstacle])-([thenoncoincidenceset ] ) .",
    "@xmath1101 for all integrable superharmonic functions @xmath63 on @xmath45 .",
    "we remark that the form of the obstacle in @xcite is superficially different from ours : taking @xmath1102 and @xmath1103 in section  7 of @xcite , the obstacle is given by @xmath1104 for a large ball @xmath5 , rather than our choice ( [ theobstacle ] ) of @xmath1105 note , however that @xmath1106 is constant on @xmath5 by ( [ ballpotential ] ) and ( [ ballpotentialdim2 ] ) . thus if @xmath5 is sufficiently large , the two obstacle problems have the same noncoincidence set @xmath45 by lemmas  [ majorantonacompactset ] and  [ occupieddomainisbounded ] .",
    "to prove proposition  [ ballquadrature ] using theorem  [ fromsakai ] , we must produce an appropriate density @xmath46 on @xmath1 strictly exceeding @xmath21 on its support .",
    "we will take @xmath46 to be twice the sum of indicators of balls of half the volume of the @xmath118 .",
    "let @xmath1107 be the ball of volume @xmath1108 centered at @xmath120 , and consider the sum of indicators @xmath1109 let @xmath1100 be given by ( [ theobstacle])-([thenoncoincidenceset ] ) . by theorem  [ fromsakai ] and the mean value proprerty for superharmonic functions ( [ meanvalueproperty ] ) , we have @xmath1110 for all integrable superharmonic functions @xmath63 on @xmath45 .",
    "it remains to show that @xmath1096 . by lemma  [ startingdensitygreaterthan1 ]",
    "we have @xmath1111 for all @xmath713 , hence by lemma  [ associativity ] @xmath1112 by lemma  [ relaxingaball ] we have @xmath1113 , completing the proof .    from proposition  [ ballquadrature ]",
    "it follows @xcite ( see also ( * ? ? ?",
    "* lemma 1.1(a ) ) ) that if @xmath133 are distinct points in @xmath132 , and @xmath118 is a disk centered at @xmath120 , the boundary of the smash sum @xmath128 lies on an algebraic curve of degree @xmath135 .",
    "the methods of @xcite rely heavily on complex analysis , which is why they apply only in dimension two .",
    "indeed , in higher dimensions it is not known whether classical quadrature domains have boundaries given by algebraic surfaces ( * ? ? ?",
    "* ch .  2 ) .",
    "in this section we collect the proofs of the background results stated in section  [ potentialtheorybackground ] . for more background on potential theory in general , we refer the reader to @xcite ; for the obstacle problem in particular , see @xcite .",
    "\\(i ) let @xmath41 be continuous and superharmonic",
    ". then @xmath1114 . by the mean value property ( [ meanvalueproperty ] )",
    ", we have @xmath1115 taking the infimum over @xmath257 on the left side , we conclude that @xmath1116 .",
    "it remains to show that @xmath165 is lower - semicontinuous .",
    "let @xmath1117 since @xmath1118 the function @xmath1119 is continuous , superharmonic , and lies above @xmath42 , so @xmath1120 since @xmath42 is uniformly continuous , we have @xmath1121 as @xmath1122 , hence @xmath1123 as @xmath1122 .",
    "moreover if @xmath1124 , then by lemma  [ basicproperties](iii ) @xmath1125 thus @xmath165 is an increasing limit of continuous functions and hence lower - semicontinuous .",
    "\\(ii ) since @xmath165 is defined as an infimum of continuous functions , it is also upper - semicontinuous .",
    "\\(iii ) given @xmath1126 , write @xmath1127 .",
    "choose @xmath1128 small enough so that for all @xmath1129 @xmath1130 let @xmath257 be the continuous function which is harmonic in @xmath5 and agrees with @xmath165 outside @xmath5 . by lemma  [ basicproperties](v ) , @xmath257 is superharmonic . by lemma  [ basicproperties](i ) ,",
    "@xmath257 attains its minimum in @xmath1131 at a point @xmath1132 , hence for @xmath1133 @xmath1134 it follows that @xmath1135 everywhere , hence @xmath1114 . from lemma  [ basicproperties](ii )",
    "we conclude that @xmath1136 , and hence @xmath165 is harmonic at @xmath26 .",
    "suppose @xmath148 .",
    "since for any fixed @xmath37 the function @xmath1137 is superharmonic in @xmath26 , we have @xmath1138    \\(i ) by lemma  [ superharmonicpotential ] , since @xmath46 is nonnegative , the function @xmath1139 is subharmonic on @xmath1 .",
    "\\(ii ) let @xmath243 be a ball containing the support of @xmath46 . by ( [ ballpotential ] ) and ( [ ballpotentialdim2 ] ) , for @xmath820 we have @xmath1140 where @xmath1141 and @xmath1142 for @xmath53 .",
    "hence for @xmath820 we have @xmath1143 since @xmath1144 on @xmath153 , by lemma  [ superharmonicpotential ] the function @xmath1145 is superharmonic in @xmath1146 .",
    "since this holds for all sufficiently large @xmath386 , it follows that @xmath1145 is superharmonic on all of @xmath153 .",
    "\\(i ) by lemmas  [ majorantbasicprops](i ) and  [ laplacianofobstacle](i ) , the function @xmath1147 is the difference of a superharmonic and a subharmonic function , hence superharmonic on @xmath1 .",
    "\\(ii ) with @xmath1049 defined by ( [ meanvalueproperty ] ) , we have @xmath1148 by lemma  [ laplacianofobstacle ] we have @xmath1149 since @xmath1150 is continuous and superharmonic , it follows that @xmath1151 , hence @xmath1152 thus @xmath1153 is subharmonic on @xmath1 , and hence by lemma  [ laplacianofobstacle](ii ) the function @xmath1154 is subharmonic on @xmath153 .",
    "if @xmath1099 in a ball @xmath1155 , by ( [ ballpotential ] ) and ( [ ballpotentialdim2 ] ) , for @xmath1133 we have @xmath1156 by lemma  [ superharmonicpotential ] it follows that @xmath42 is subharmonic in @xmath5 . in particular , @xmath1157 in @xmath5 , so @xmath1126 .",
    "let @xmath1158 then @xmath446 is continuous and superharmonic , and since @xmath1159 we have @xmath1160 hence @xmath1161 .",
    "now @xmath1162 since @xmath1163 is the support of @xmath1164 , the result follows .",
    "let @xmath257 be any continuous function which is superharmonic on @xmath153 and @xmath1165 . by lemma  [ majorantbasicprops](iii ) ,",
    "@xmath165 is harmonic on @xmath45 , so @xmath1166 is superharmonic on @xmath45 and attains its minimum in @xmath787 on the boundary .",
    "hence @xmath1166 attains its minimum in @xmath1167 at a point @xmath26 where @xmath1168 . since @xmath41",
    "we conclude that @xmath1114 on @xmath153 and hence everywhere .",
    "thus @xmath165 is at most the infimum in ( [ majorantinadomain ] ) . since the infimum in ( [ majorantinadomain ] )",
    "is taken over a strictly larger set than that in ( [ themajorant ] ) , the reverse inequality is trivial .      for the proof below , we follow the sketch in caffarelli ( * ? ? ?",
    "* theorem 2 ) .",
    "fix @xmath1169 , and define @xmath1170 since @xmath46 is @xmath171 , we have that @xmath42 is @xmath172 by lemma  [ smoothnessofpotential](ii ) .",
    "let @xmath4 be the maximum second partial of @xmath42 in the ball @xmath1171 .",
    "by the mean value theorem and cauchy - schwarz , for @xmath820 we have @xmath1172 where @xmath1173 .",
    "hence @xmath1174 thus the function @xmath1175 is nonnegative and superharmonic in @xmath5 .",
    "write @xmath1176 , where @xmath1177 is harmonic and equal to @xmath1178 on @xmath812",
    ". then since @xmath1179 , we have @xmath1180 by the harnack inequality , it follows that @xmath1181 on the ball @xmath1182 , for a suitable constant @xmath1183 .",
    "since @xmath1184 is nonnegative and vanishes on @xmath812 , it attains its maximum in @xmath162 at a point @xmath1185 in the support of its laplacian .",
    "since @xmath1186 , by lemma  [ majorantbasicprops](iii ) we have @xmath1187 , hence @xmath1188 where in the last step we have used ( [ secondordererror ] ) .",
    "we conclude that @xmath1189 on @xmath1190 and hence @xmath1191 on @xmath1190 .",
    "thus on @xmath1190 we have @xmath1192 in particular , @xmath147 is differentiable at @xmath1193 , and @xmath1194 .",
    "since @xmath165 is harmonic in @xmath45 and equal to @xmath42 outside @xmath45 , it follows that @xmath147 is differentiable everywhere , and @xmath171 off @xmath203 .",
    "given @xmath209 , let @xmath1193 be the closest point in @xmath203 to @xmath37 . since @xmath1195 , by lemma  [ majorantbasicprops](iii ) the function @xmath1178 is harmonic on @xmath1196 , so by the cauchy estimate ( * ? ? ?",
    "* theorem 2.4 ) we have @xmath1197 since @xmath1198 , the right side of ( [ fromcauchyest ] ) is at most @xmath1199 , hence @xmath1200 where @xmath1201 .",
    "thus @xmath147 is @xmath171 on @xmath203 as well .",
    "we now turn to the proof of proposition  [ boundaryregularitysmooth ] .",
    "the first part of the proof follows friedman ( * ? ? ?",
    "* ch .  2 ,",
    "theorem  3.5 ) .",
    "it uses the lebesgue density theorem , as stated in the next lemma .",
    "[ density1 ] let @xmath110 be a lebesgue measurable set , and let @xmath1202 then @xmath1203 .    to prove the first part of proposition  [ boundaryregularitysmooth ] , given a boundary point @xmath1204 , the idea is first to find a point @xmath37 in the ball @xmath79 where @xmath187 is relatively large , and then to argue using lemma  [ smoothdensity ] that a ball @xmath1205 must be entirely contained in @xmath45 .",
    "taking @xmath1206 in the lebesgue density theorem , we obtain that @xmath1207 .",
    "the proof of the second part of proposition  [ boundaryregularitysmooth ] uses green s theorem in the form @xmath1208 here @xmath1209 is the union of boxes @xmath1210 that are contained in @xmath45 , and @xmath1211 is the volume measure in @xmath1209 , while @xmath1212 is the @xmath868-dimensional surface measure on @xmath1213 .",
    "the partial derivatives on the right side of ( [ greensidentity ] ) are in the outward normal direction from @xmath1213 .",
    "\\(i ) fix @xmath1214 . for @xmath1204 with @xmath1215 , for small enough @xmath77 we have @xmath1216 on @xmath79 . by lemma",
    "[ laplacianofobstacle](ii ) the function @xmath1217 is superharmonic on @xmath1218 , so by lemma  [ majorantbasicprops](iii ) the function @xmath1219 is subharmonic on @xmath1218 . since @xmath1220 , its maximum is not attained on @xmath203 , so it must be attained on @xmath1221 , so there is a point @xmath37 with @xmath1222 and @xmath1223    by lemma  [ smoothdensity ] we have @xmath1224 in the ball @xmath1205 .",
    "taking @xmath1225 , we obtain for @xmath1226 @xmath1227 thus for any @xmath1228 @xmath1229 by the lebesgue density theorem it follows that @xmath1230 by lemma  [ startingdensitygreaterthan1 ] we have @xmath1231 on @xmath203 .",
    "taking @xmath1232 in ( [ fromthedensitytheorem ] ) , we obtain @xmath1233    \\(ii ) fix @xmath1234 and let @xmath1235 where @xmath1236^d$ ] . by lemmas  [ majorantbasicprops](iii ) and  [ smoothnessofpotential](ii ) , in @xmath1209 we have @xmath1237 now by green s theorem ( [ greensidentity ] ) , since @xmath147 is nonnegative and @xmath63 is superharmonic , @xmath1238 where @xmath1239 denotes the unit outward normal vector to @xmath1213 . by lemma  [ smoothdensity ] , the integral on the right side",
    "is bounded by @xmath1240 where @xmath1241 denotes @xmath868-dimensional lebesgue measure .",
    "let @xmath1242 since @xmath1243 , given @xmath73 we can choose @xmath1128 small enough so that @xmath1244 .",
    "since @xmath1245 , we have @xmath1246 since @xmath45 is open , @xmath1247 as @xmath1248",
    ". taking @xmath1249 smaller if necessary so that @xmath1250 , we obtain from ( [ greensthm ] ) and ( [ surfaceintegral ] ) @xmath1251 where @xmath242 is the maximum of @xmath1252 .",
    "since this holds for any @xmath73 , we conclude that @xmath1253 .",
    "\\(i ) fix @xmath73 .",
    "since @xmath46 is continuous almost everywhere , there exist @xmath171 functions @xmath1254 with @xmath1255 . scaling by a factor of @xmath1256 for sufficiently small @xmath1128",
    ", we can ensure that @xmath1257 , so that @xmath1258 and @xmath1259 satisfy the hypotheses of proposition  [ boundaryregularitysmooth ] . for @xmath1260 let @xmath1261 and let @xmath194 be the least superharmonic majorant of @xmath195 .",
    "choose @xmath1262 with @xmath1263 such that @xmath1264 for @xmath1260 , and write @xmath1265 by ( [ boundedawayfrom1again ] ) we have @xmath1266 , hence by lemma  [ monotonicity ] @xmath1267 for @xmath1260 write @xmath1268 by proposition  [ boundaryregularitysmooth](ii ) with @xmath1269 , we have @xmath1270 for @xmath1271 , we have @xmath1272 since @xmath1273 on @xmath1274 , the first term is bounded by @xmath1275 where the equality in the middle step follows from ( [ conservation ] ) .    by proposition  [ boundaryregularitysmooth](i )",
    "we have @xmath1276 , hence @xmath1277 .",
    "taking @xmath1278 we obtain from ( [ leftsqueeze ] ) , ( [ rightsqueeze ] ) , and ( [ thisissmall ] ) @xmath1279 since this holds for any @xmath73 , the result follows .",
    "( ii ) write @xmath1280 from ( [ conservation ] ) we have @xmath1281 the left and right side differ by at most @xmath77 . since @xmath1282 , and @xmath73 is arbitrary , it follows that @xmath1283 , hence @xmath1284",
    "\\(iii ) by lemma  [ startingdensitygreaterthan1 ] , if @xmath1285 and @xmath1286 , then @xmath46 is discontinuous at  @xmath26 .",
    "thus @xmath1287 almost everywhere on @xmath1288 , and we obtain from ( [ conservationind ] ) @xmath1289      \\(i ) since @xmath1290 are supported on @xmath5 , we have for @xmath114 @xmath1291 fix @xmath1292 .",
    "since @xmath1293 , we have by ( [ ballpotential ] ) and ( [ ballpotentialdim2 ] ) @xmath1294 now let @xmath1295 .",
    "since @xmath244 in @xmath1296 , we can take  @xmath16 large enough so that @xmath1297 , obtaining @xmath1298 thus the right side of ( [ triangleineq ] ) can be made arbitrarily small for sufficiently large @xmath16 .",
    "\\(ii ) by lemmas  [ monotonicity ] and  [ relaxingaball ] , the noncoincidence sets @xmath252 are contained in the ball @xmath1299 . given @xmath73 and a compact set @xmath1300 containing @xmath140 ,",
    "choose @xmath451 large enough so that @xmath1301 on @xmath1300 for all @xmath1302 .",
    "then @xmath1303 on @xmath1300 , so the function @xmath1304 max@xmath1305 is superharmonic on @xmath1300 . by lemma  [ majorantonacompactset ]",
    "we have @xmath457 , and hence @xmath1306 on @xmath1300 .",
    "likewise @xmath1307 on @xmath1300 , so the function @xmath1308 max@xmath1309 is superharmonic on @xmath1300 . by lemma  [ majorantonacompactset ]",
    "we have @xmath1310 and hence @xmath1311 on @xmath1300 .",
    "thus @xmath247 uniformly on @xmath1300 .",
    "\\(iii ) let @xmath604 be the minimum value of @xmath237 on @xmath782 , and choose @xmath451 large enough so that @xmath1312 on @xmath787 for all @xmath1313 .",
    "then @xmath1314 on @xmath75 , hence @xmath251 for all @xmath1313 .",
    "consider the functions @xmath1315 by hypothesis , @xmath264 is subharmonic and @xmath265 is superharmonic on @xmath260 . given @xmath1316 , let @xmath1026 min@xmath1317 , and let @xmath1318 be the harmonic function on the ball @xmath1319 which agrees with @xmath1320 on @xmath812 .",
    "then @xmath1321 by the harnack inequality ( * ? ? ?",
    "* theorem 1.7.2 ) there is a constant @xmath1322 such that @xmath1323 since @xmath1324 we have from ( [ f_+upperbound ] ) @xmath1325 hence @xmath1326 with @xmath1327 .",
    "lemma  [ continuumatmostquadratic ] is proved in the same way as lemma  [ atmostquadratic ] , using the continuous harnack inequality in place of the discrete one , and replacing @xmath1328 by @xmath1329 in ( [ quadraticcorrection ] ) .",
    "let @xmath1300 be the closure of @xmath1330 , and let @xmath1331 . since @xmath1300 is contained in @xmath1332 , the sets @xmath1333 form an open cover of @xmath1300 , which has a finite subcover , i.e.  @xmath1334 for some @xmath16 .",
    "by taylor s theorem with remainder @xmath1335 for some @xmath1336 .",
    "summing over @xmath1337 and dividing by @xmath1338 gives the result .    in dimensions @xmath35 we have from ( [ definitionofg_n ] ) and the standard estimate for the discrete green s function @xcite",
    "( see also ( * ? ? ?",
    "* theorem 1.5.4 ) ) @xmath1339 likewise , in dimension two , using the standard estimate for the potential kernel @xcite ( see also ( * ? ? ? * theorem 1.6.2 ) ) in ( [ definitionofg_ndimension2 ] ) gives @xmath1340    let @xmath1341 be compact . by the triangle inequality @xmath1342 by lemma  [ threesteps](i ) the second term on the right side is @xmath1343 on @xmath1300 for sufficiently large @xmath16 .",
    "the first term is at most @xmath1344 by lemma  [ greensfunctionconvergence ] , we have @xmath1345 for a constant @xmath385 depending only on @xmath214 . integrating ( [ gotitwherewewantit ] ) in spherical shells about @xmath26 , we obtain @xmath1346 where @xmath386 is the radius of @xmath5 . taking @xmath16 large enough so",
    "that the right side is @xmath1343 , the proof is complete .",
    "let @xmath257 be any function which is superharmonic on @xmath153 and @xmath1347 . since @xmath379 is harmonic on @xmath368 , the difference @xmath1348 is superharmonic on @xmath368 and attains its minimum in @xmath1349 on the boundary .",
    "hence @xmath1348 attains its minimum in @xmath1350 at a point @xmath26 where @xmath1351 . since @xmath1352",
    "we conclude that @xmath596 on @xmath153 and hence everywhere .",
    "thus @xmath379 is at most the infimum in ( [ discretemajorantinadomain ] ) . since the infimum in ( [ discretemajorantinadomain ] )",
    "is taken over a strictly larger set than that in ( [ thediscretemajorant ] ) , the reverse inequality is trivial .",
    "we conclude by mentioning two simple variants of aggregation models which appear to have interesting limit shapes , but about which we can not prove anything at present . in the first variant ,",
    "particles start at the origin and perform rotor - router walks in @xmath15 until either reaching an unoccupied site or hitting the positive @xmath26-axis .",
    "the resulting set of occupied sites is shown on the left in figure  [ cardioidandspiral ] . in the second variant , shown on the right ,",
    "particles again start at the origin and perform rotor - router walks until reaching an unoccupied site , except that the rotors on the positive @xmath26-axis do not rotate but instead always point downward .    . in the left figure ,",
    "particles are killed on hitting the positive @xmath26-axis . in the right figure , sites on the positive @xmath26-axis send all particles in the downward direction.,title=\"fig : \" ]   . in the left figure ,",
    "particles are killed on hitting the positive @xmath26-axis . in the right figure ,",
    "sites on the positive @xmath26-axis send all particles in the downward direction.,title=\"fig : \" ]    our simulations indicate that limiting shapes exist for both of these variants .",
    "pavel etingof ( personal communication ) has found exact solutions to the analogous hele - shaw flow problems in the continuum .",
    "the challenge is to extend our methods to prove that the lattice models produce shapes converging to these hele - shaw solutions .",
    "jim propp was the first to suggest that the diaconis - fulton smash sum should have a well - defined deterministic scaling limit . thanks also to jim for bringing the rotor - router model to our attention , and for many fruitful discussions .",
    "matt cook s work on the rotor - router model inspired our approach using the odometer function .",
    "in addition , we thank misha sodin for suggesting that we use the least superharmonic majorant , craig evans for pointing us to helpful references on the obstacle problem , and darren crowdy for a helpful discussion on quadrature domains .",
    "we also had useful discussions with scott armstrong , oded schramm , and scott sheffield .",
    "itamar landau helped create several of the figures .",
    "we thank david jerison for pointing out an error in the proof of lemma  [ coreoftheargument ] in an earlier draft ."
  ],
  "abstract_text": [
    "<S> we study the scaling limits of three different aggregation models on @xmath0 : internal dla , in which particles perform random walks until reaching an unoccupied site ; the rotor - router model , in which particles perform deterministic analogues of random walks ; and the divisible sandpile , in which each site distributes its excess mass equally among its neighbors . as the lattice spacing tends to zero , all three models are found to have the same scaling limit , which we describe as the solution to a certain pde free boundary problem in @xmath1 . in particular </S>",
    "<S> , internal dla has a deterministic scaling limit . </S>",
    "<S> we find that the scaling limits are quadrature domains , which have arisen independently in many fields such as potential theory and fluid dynamics . </S>",
    "<S> our results apply both to the case of multiple point sources and to the diaconis - fulton smash sum of domains . </S>"
  ]
}