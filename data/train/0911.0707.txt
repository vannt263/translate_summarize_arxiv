{
  "article_text": [
    "the study of gamma - ray bursts ( grbs ) has been greatly advanced following the launch of the swift gamma - ray explorer ( gehrels et al .",
    "2004 ) on november 20 , 2004 .",
    "thanks to its rapid slewing capability , multi - wavelength observations of grb afterglows , usually as soon as @xmath3 seconds after the burst trigger , have been performed regularly for many bursts . the x - ray telescope ( xrt , burrows et al .",
    "2005a ) aboard this satellite has given us unprecedented access to early afterglows in the x - ray band .",
    "for most grbs , xrt has observed smoothly decaying power - law or broken power - law afterglows ( nousek et al .",
    "2006 ; obrien et al . 2006 ; zhang et al . 2007 ; liang et al .",
    "2007 , 2008 ; evans et al . 2009 ) . in about half of grbs , superimposed on the background x - ray afterglow ,",
    "one or more x - ray flares are seen ( burrows et al .",
    "2005b ; romano et al .",
    "2006 ; falcone et al . 2006 , 2007",
    "; chincarini et al . 2007 ) .    flares among the bursts share some common properties , which include the following :    * the morphology of flares is similar : they all show a smooth , rapid rise and a rapid fall ( romano et al .",
    "* they are superimposed on a background power - law decay afterglow component with the slope before the flaring equal to that after the flare ( burrows et al .",
    "* the width of flares is typically narrow , with @xmath4 on average , where @xmath5 is the emission time of the flare .",
    "however , flares can become wider ( @xmath6 becomes larger ) as the time of their emission increases , and no sharp flares are seen at late times ( chincarini et al .",
    "2007 ; kocevski et al . 2007 ) .",
    "* similar flaring activity has been detected in both types of grbs : those believed to be of massive star origin ( type ii , typically long duration ) and those believed to be of compact star merger origin ( type i , typically short , e.g. in grb 050724 , barthelmy et al .",
    "this suggests that the phenomenon is insensitive to the progenitor type ( perna et al .",
    "* flares are spectrally harder than the underlying afterglow ( burrows et al . 2005b ; romano et al .",
    "2006 ; falcone et al .",
    "* for a small sample of bright flares whose time - dependent spectral analysis can be performed , flares are found to soften as they decay ( burrows et al .",
    "2005b , c ; falcone et al . 2006 , 2007 ) , reminiscent of grb prompt emission .",
    "* average x - ray flare luminosity decays with time as a power - law with slope @xmath7 -1.5 for a sample of flares from many grb s .",
    "this temporal relationship also seems to hold among flares from a single multi - flared burst ( lazzati , perna & begelman 2008 )",
    ".    flares also vary from burst to burst , from flare to flare , in the following ways :    * the shape of flares can be best fit with a number of different profiles : gaussian , log - normal distributions , exponential or power - law rise or decay with differing slopes for both the rising and falling portion of the flare ( chincarini et al . 2007 ) . *",
    "the number of flares seen per burst varies from modal value of 1 , mean value of @xmath7 2.5 and maximum value of 8 ( chincarini et al .",
    "* the fluence seen in flares can vary from a few percent of the burst fluence to larger than the burst itself ( e.g. for grb050502b , burrows et al .",
    "2005b , c ; falcone et al .",
    "* the emission time of flares varies from perhaps before the slew of xrt ( e.g. grb060607 ) to late flares at @xmath8 seconds ( e.g. grb050904 , cusumano et al .",
    "2006 ) to @xmath9 seconds ( for the type i grb050724 , barthelmy et al .",
    "some flares are superimposed on other flares ( e.g. grb050916 , burrows et al .",
    "2005b , c ; chincarini et al .",
    "although most flares happen early , from 100 to 1000 seconds , the distribution of @xmath5 tails off to @xmath10 seconds ( chincarini et al . 2007 ) .",
    "a few properties of x - ray flares suggest that they are connected to internal emission processes due to a restarting of the central engine at late times ( burrows et al .",
    "2005b ; falcone et al .",
    "2006 ; romano et al . 2006 ; zhang 2007 ) .",
    "the arguments in favor of such a `` late internal '' model ( in contrast to the external shock model ) are the following : first , the rapid rise and fall of flares with @xmath11 strongly disfavors external shock models that involve a large angular area over which radiation would be emitted ( zhang et al .",
    "2006 , see also ioka et al .",
    "2005 ; fan & wei 2005 ; lazzati & perna 2007 ) .",
    "second , the connected , underlying continuum which has the same slope both before and after the flare suggests that flares are not related to the canonical afterglow and are instead superimposed on top of this regular afterglow decay ( chincarini et al .",
    "third , given the same observed x - ray flare amplitude , the internal model requires a much smaller energy budget than the external shock model ( zhang et al .",
    "while the internal model can produce significant x - ray flares with energy much less than that during the prompt emission , the external shock model requires an energy budget at least comparable to that of the initial blast wave in order to make a noticeable change in flux ( zhang & mszros , 2002 ) .",
    "internal models are much more `` economical '' as far as energy budget is concerned .",
    "next , liang et al . ( 2006 ) have shown that as long as the central engine clock is reset to zero at the beginning of each flaring episode , the curvature effect can naturally explain the spectral index and the temporal decay index of the decay phase of flares . finally , although there is no correlation between the number of prompt emission burst pulses and x - ray flares in any given burst ( chincarini et al . 2007 )",
    ", x - ray flares do exhibit the same spectral softening as grb prompt emission ( burrows et al .",
    "2005b , c ; falcone et al . 2006 , 2007 ) .",
    "this suggests that the properties of x - ray flares make them likely to be caused by the same mechanism as prompt emission seen in gamma - rays .",
    "any x - ray flare model must be able to explain the bulk similarities and differences among flares enumerated above .",
    "the leading `` internal '' model is the internal shock model ( rees & mszros 1994 ) , which invokes internal collisions of shells within an unsteady central engine wind .",
    "previous internal shock models have focused on interpreting prompt gamma - ray emission properties ( e.g. kobayashi et al . 1997 ; panaitescu et al .",
    "1999 ; spada et al .",
    "2000 ; guetta et al .",
    "kobayashi et al . (",
    "1997 ) have shown that internal shocks can explain the highly variable profiles seen in grbs . in their model ,",
    "shells of matter with varying lorentz factors ejected from the central engine produce about as many collisions as the number of shells , and the time of ejection of the shell is highly correlated to the time of collision of the shells , indicating that there is essentially no delay between energy ejection by central engine emission and the time when that emission is seen .",
    "recently , using a model where collisions are not perfectly inelastic , li & waxman ( 2008 ) studied the effect of residual collisions in optical emission which would be slightly delayed from gamma - ray prompt emission .    within the context of x - ray flares ,",
    "the internal shock model has been discussed by a number of authors .",
    "zhang et al . ( 2006 ) and fan & wei ( 2005 ) discussed how a late internal shock may produce a softer flare than prompt gamma - ray emission .",
    "( 2005 ) discussed both late internal and external shock models to study x - ray flares and concluded that at least some flares have to be produced by late internal shocks .",
    "lazzati & perna ( 2007 , see also zhang 2007 ) proved the suggestions of burrows et al .",
    "( 2005b ) and zhang et al .",
    "( 2006 ) that late flares must require late injection of shells and can not be produced by late collisions of shells ejected during the prompt phase .",
    "yu & dai ( 2009 ) studied the shock physics and radiation processes of late internal shocks that may be responsible for x - ray flares .    in this paper",
    ", we focus on another aspect of the internal shock model for x - ray flares . extending the work of kobayashi et al .",
    "( 1997 ) to concentrate on x - ray flares , we have created a grb fireball model with a central engine that can eject multiple episodes of matter shells with any lorentz factor , thickness and mass distributions .",
    "this code is used to address the question of what kind of central engine activities are demanded in order to reproduce the observed properties of x - ray flares . the conclusion drawn from this study",
    "may be taken as the requirements of some central engine models on x - ray flares ( e.g. king et al .",
    "2005 ; perna et al .",
    "2006 ; proga & zhang 2006 ; dai et al . 2006 ; lee et al .",
    "2009 ) . in  2 , we first examine the physics of two - shell collisions and describe our phenomenological treatment of the spectrum and lightcurve of individual collisions . in  3 , we discuss blast wave evolution , which sets an outer boundary for the internal collisions that are relevant to x - ray flares .",
    "we then dedicate our discussion (  4 ) to multiple collisions for multiple ejection episodes and use the observations to diagnose the required central engine activities .",
    "our results are summarized in  5 with some discussion .",
    "our model represents the grb central engine as a variable source that ejects many randomized shells of matter over some period of time .",
    "shells ejected later with higher lorentz factors catch up with slower shells , colliding and creating `` internal shocks '' ( rees & mszros , 1994 ) .",
    "as the modeled shells move outward from the central engine , the energy released from each collision is calculated , allowing the two colliding shells to combine and continue to move outward to collide with other shells . in the model ,",
    "each shell is given four initial parameters : ejection time @xmath12 , relativistic lorentz factor @xmath13 , mass @xmath14 , and thickness @xmath15 .",
    "we assume that shell collisions are inelastic , so that a fast shell ( f ) and a slow shell ( s ) merge to form a merged shell ( m ) . using conservation of momentum and energy , the lorentz factor of the combined shell",
    "can be written @xmath16 each collision then releases an internal energy given by ( kobayashi et al .",
    "1997 ) @xmath17 the efficiency of each collision can be defined as @xmath18 it has been known that this efficiency is usually low ( kumar 1999 ; panaitescu et al .",
    "1999 ) although depending on input parameters , it can vary in a wide range . to test this , we simulated 100 shells that are randomly injected during 0 - 100 s. we allow the mass of each shell to be randomly drawn in the range of @xmath19 g in log space , and investigate how lorentz factor contrast affects the distribution of the efficiency .",
    "we randomly generate shell lorentz factors in log space within a range of @xmath20 .",
    "table 1 shows the mean efficiency of @xmath21 and its standard deviation @xmath22 for varying @xmath23 .",
    "it is evident that the mean value of @xmath21 rises steadily with @xmath24/@xmath25 .",
    "however , even for a very high lorentz factor contrast @xmath24/@xmath25 = 1000 , the mean efficiency still only reaches a level of @xmath7 26% .",
    "values of @xmath22 are on the order of @xmath21 , which means that very low and very high @xmath21 can be expected for extreme parameters of the two shells .",
    "the right pane of table 1 shows the efficiency for the same simulation , but with shell masses standardized to all be @xmath26 g. these results are on order with the efficiency study with varying shell masses .",
    "@xmath22 & @xmath23 & @xmath21 & @xmath22 + & + 1000 & 26% & 26% & 1000 & 28% & 27% + 100 & 14% & 17% & 100 & 19% & 20% + 10 & 5% & 7% & 10 & 7% & 8% + 5 & 0.5% & 0.7% & 5 & 0.6% & 0.9% +    for our model , we do not follow the internal shock physics in detail .",
    "this has been done by yu & dai ( 2009 ) , who showed that for reasonable parameters , the emission from internal shocks can well reproduce the x - ray flare phenomenology .",
    "our goal is to model many collisions and to investigate the time history of central engine activity , collision , and grb emission . like many other previous work in this direction ( e.g. kobayashi et al .",
    "1997 ; panaitescu et al .",
    "1999 ) , we adopt an empirical approach to calculate the spectrum and lightcurve of each collision event .    _ spectral model . _",
    "the spectrum of grbs is typically a smoothly - joint - broken - power - law spectrum , or `` band''-function ( band et al .",
    "1993 ) @xmath27 where @xmath28 and @xmath29 are the power law photon spectral indices below and above the break energy @xmath30 in the asymptotic regime , @xmath31 is a normalization factor .",
    "the break energy can be written as @xmath32 , where @xmath33 is the spectral peak energy in the grb energy spectrum . since evidence strongly suggests that grb prompt emission and x - ray flares",
    "originate from similar physical events ( e.g. burrows et al . 2005c ; chincarini et al . 2007 ; falcone et al . 2007 ;",
    "krimm et al .",
    "2007 ) , we assume that the spectrum of x - ray flares is also a band - function .",
    "the band - function parameters of x - ray flares are determined in the following way in our calculations : the typical values for the spectral indices are taken as @xmath34 , and @xmath35 . for @xmath33 , we calculate it through an empirical relation between the isotropic emission energy @xmath36 and @xmath33 , which is generally valid among grbs ( amati et al . 2002 ; krimm et al .",
    "2009 ) and within a burst ( liang et al .",
    "2004 ; ghirlanda et al .",
    "we assume the validity of this correlation @xmath37 and apply @xmath38 to estimate @xmath33 .",
    "this is because electrons in the shock are in the `` fast - cooling '' regime , and lose their energy rapidly .",
    "as long as the electron equipartition parameter @xmath1 is close to unity , essentially all the internal energy can be radiated away . for @xmath39 ,",
    "this estimate gives an upper limit on the brightness of x - ray flares .",
    "we require that the spectrum - integrated bolometric energy @xmath40 equals @xmath41 and then solve for the normalization factor @xmath31 . then reinserting this constant",
    ", we can calculate the energy of each pulse @xmath42 within each band @xmath43 , e.g. 15 to 150 kev for bat , 0.1 to 10 kev for xrt .",
    "_ temporal model .",
    "_ the total energy released in a particular band for a particular pulse is distributed in time throughout the x - ray flare temporal profile .",
    "different functions of grb pulses and x - ray flares have been adopted in the literature ( kobayashi et al .",
    "1997 ; chincarini et al .",
    "2007 ) , but for the purpose of our study , the shape of the flare profile is not crucial . for simplicity ,",
    "we adopt the following temporal profile @xmath44 where the temporal width @xmath45 scales as the physical width of the shell , @xmath15 . for a shell with initial width",
    "@xmath46 moving outward from the central engine , spreading will occur after the sound wave travels across the shell at @xmath47 ) .",
    "so in general , the shell width can be expressed as ( mszros et al .",
    "1993 ; kobayashi et al .",
    "1999 ) @xmath48    we require that the temporal integral of the profile @xmath49 equals the internal energy in the specified energy band ( bat or xrt ) .",
    "when shells collide , the duration of the x - ray flare pulse is defined by the width of the faster shell .",
    "this is because the reverse shock is typically the one that dominates the x - ray flare emission ( yu & dai 2009 ) .",
    "after the collision , which occurs at @xmath50 , the width of the the combined shell is taken to be @xmath51 , i.e. the width in the spreading regime .",
    "the width of the shell keeps spreading as @xmath52 thereafter .    in the central engine frame ,",
    "the shells collide at @xmath53 .",
    "the relevant observation time is @xmath54 where @xmath12 and @xmath13 can be taken as the ejection time and lorentz factor of either of the two colliding shells .",
    "the peak time of a flare is defined as the observed collision time plus the observed shock crossing time , which is roughly estimated as @xmath55",
    "in order to define `` internal '' collisions , we need to track the location of the `` external '' shock .",
    "as the first shell moves outward into the ambient medium , it slows down due to an external shock mechanism as it sweeps up the ambient medium .",
    "as time goes by , more and more trailing shells collide onto the leading decelerating shell .",
    "the motion of this decelerating ejecta along with the medium collected along the way , known as the `` blast wave '' , is governed by the following differential equations ( chiang & dermer 1999 ; huang et al .",
    "2000 ) : @xmath56    @xmath57    @xmath58    here @xmath5 is the time in the rest frame of the central engine , @xmath59 is the distance from the central engine , @xmath60 is the density of the ambient medium , @xmath13 is the lorentz factor of the shell , @xmath14 is the swept - up mass , and @xmath61 is the total mass including internal energy of the blast wave , where @xmath62 is the initial mass of the ejecta . as a result ,",
    "one has another differential equation @xmath63 equation ( [ position ] ) simply states how radius changes as a function of time for an object moving with constant velocity . equation ( [ gammamass ] ) is a statement of conservation of energy and momentum across the blast wave ( blandford and mckee 1976 ) .",
    "although these expressions are valid only when the blast wave is in the relativistic regime , they are adequate for our calculation , since x - ray flares usually happen early before the blast wave enters the trans - relativistic regime .",
    "the amount of swept up mass in shell of surface area @xmath64 is described by equation ( [ density ] ) .",
    "the solution of this system is found to be @xmath65    the leading shell initially expands freely until the momentum of the swept up matter is about equal to the initial mass of the shell , @xmath62 .",
    "the radius of deceleration , @xmath66 , is found from @xmath67 , where the subscript `` 0 '' represents initial values ( rees and mszros , 1992 ) . for typical values of @xmath68 , @xmath69 g and @xmath70 , one has @xmath71 cm .",
    "the relativistic blast wave decays as @xmath72 , until reaching the sedov radius , at which the rest mass of the ambient medium becomes as large as the rest mass of the blast wave , i.e. @xmath73 .",
    "after this point , the expansion enters the non - relativistic regime with dimensionless velocity @xmath74 ( sedov 1969 )",
    ".    in our model , trailing shells collide amongst themselves and later land onto the blast wave as the it slows down , altering the blast wave dynamics .",
    "the dynamics of such a collision is very complicated , invoking three shocks and several distinct dynamical stages ( zhang & mszros 2002 ) .",
    "for the purpose of this study ( tracking the location of the blast wave ) , we adopt the following simple treatment : if a trailing fast shell with mass @xmath75 and lorentz factor @xmath76 collide on to the blast wave with lorentz factor of @xmath13 before the blast wave has begun decelerating , the collision is treated as an internal shock and the merged lorentz factor are calculated as prescribed by eq.([momentum ] ) .",
    "if the collision of a fast shell onto the blast wave occurs after the blast wave has begun to decelerate , we first assume that there is no blast wave , and calculate the post - collision product the same way as the internal shock calculations , record the new effective initial mass and lorentz factor , and re - solve the blast wave for the new parameters .",
    "we then jump the blast wave solution from the old ( low ) @xmath13 value to the new ( high ) @xmath13-value at the same @xmath59 .",
    "the code then tracks this new solution until next collision happens . with each new collision onto the blast wave , we then calculate the new solution by changing the effective mass and initial @xmath13 factor . by doing so",
    ", the blast wave evolution shows several `` glitches '' with decreasing amplitude , since the ratio between the trailing shell energy and the blast wave energy drops with time as the energy of the blast wave grows ( see figure [ chopbw ] ) .",
    "the location @xmath59 and lorentz factor @xmath13 of the blast wave are traced at any instant @xmath5 .",
    "this information is used to screen out the collisions that are not `` internal '' . without such a blast wave screening",
    ", shells injected from the central engine can collide at any location at any time .",
    "if the relative lorentz factor of two shells is small , they can in principle collide at a much larger radius than the blast wave radius .",
    "should these collisions have happened , both shells have already entered the `` spreading '' regime , so that the width of the shells can become very large .",
    "this would introduce some `` fat '' x - ray flares which are not observed .",
    "the blast wave essentially restricts such collisions , ensuring that they would never happen . instead ,",
    "both shells collide onto the blast wave and boost up the blast wave energy .",
    "the inclusion of the blast wave dynamics is therefore essential , screening out many `` fat '' flares .",
    "this also explains the lack of very `` fat '' flares in the x - ray afterglow data .    in order to reproduce the data , we adopt a typical afterglow template according to the data ( nousek et al .",
    "2006 ; obrien et al . 2006",
    "; liang et al . 2007 ) to denote the underlying x - ray afterglow .",
    "this is a broken power law with decay indices -1/2 and -1.25 , with a break time @xmath77s and a break flux @xmath78 .",
    "the origin of the x - ray afterglow , especially the shallow decay phase , still remains a mystery .",
    "a number of very different physical mechanisms have been proposed to explain its origin ( see zhang 2007 for a review ) . although the refreshed shock model is mostly discussed ( zhang et al .",
    "2006 ; nousek et al . 2006 ; granot & kumar 2006 ) , some optical afterglows do not show a similar temporal break around the x - ray break time ( panaitescu et al .",
    "2006 ; liang et al .",
    "2007 ) suggesting that this model can not interpret all the x - ray afterglow data .",
    "other ideas / models include a central engine powered afterglow ( ghisellini et al . 2007 ;",
    "kumar et al .",
    "2008 ) , a long - lasting reverse - shock - dominated afterglow ( genet et al . 2007 ; uhm & beloborodov 2007 ) , two - component external shock ( racusin et al . 2008 ; de pasquale et al . 2009 ) , dust scattering ( shao & dai 2007 ) , up - scattering of blast wave photons by a trailing lepton - rich ejecta ( panaitescu 2008 ) and an emission component prior to the grb trigger ( yamazaki 2009 ; liang et al . 2009 ) .",
    "since none of the scenarios have been robustly proven , we do not demand our model to interpret the power law x - ray afterglow segments self - consistently .    on the other hand",
    ", the expected external shock x - ray afterglow flux can be calculated from our model . applying the standard afterglow model ( sari et al .",
    "1998 ) , we can calculate the x - ray lightcurve for a particular simulation . calculating the flux for either the fast cooling case @xmath79 or slow cooling case @xmath80 using the minimum lorentz factor of the electrons @xmath81 , the comoving magnetic field strength @xmath82 , and the cooling lorentz factor of electrons @xmath83,one can calculate the critical synchrotron frequencies @xmath84 and @xmath85 using @xmath86 .",
    "standard values are taken for @xmath87 , @xmath88 , @xmath89 , @xmath90 ( panaitescu & kumar 2002 ) and @xmath91 , @xmath92 , @xmath93 and @xmath94 are the proton mass , electron mass , fundamental charge and thompson cross - section , respectively . combining this with @xmath95 where @xmath96 is the distance from the observer , here taken to be @xmath97 cm ,",
    "@xmath98 is the frequency in the x - ray band , taken to be @xmath99 hz , one can calculate the x - ray flux density , @xmath100 as a function of radius taking care to switch between fast and slow cooling cases where appropriate ( sari , piran & narayan 1998 ) .    shells colliding onto the blast wave will produce `` glitches '' in the regular afterglow flux decay .",
    "successive solutions , shown as dotted lines in fig.[glitchplot ] , depend upon the energy contained in the blast wave and therefore on both the lorentz factor , @xmath101 , and @xmath62 , the effective mass of the blast wave .",
    "we use the calculated @xmath13-evolution to calculate the evolution of the x - ray flux . in order to plot the flux as a function of time instead of radius ,",
    "points are plotted as abscissa @xmath102 and ordinate flux where both flux and gamma are calculated by matching radius .",
    "since the blast wave is accelerating in the rising part of fig.[glitchplot ] , here points appear to move back in time as the next solution is taken . in this part of the plot ,",
    "blast wave solutions have simply been connected vertically . in the falling part of fig.[glitchplot ] , solutions appear to move forward in time as collisions occur . in general , all these abrupt jumps are artificial . in reality",
    ", one needs to consider the effect of equal arrival times , which smear out all the abrupt jumps so that the lightcurve would appear smoothed without noticeable individual glitches .    also shown in fig.[glitchplot ]",
    "are another blast wave solution for @xmath103 , and the afterglow template adopted in other calculations throughout the paper . as evident from the figure , for the standard value @xmath88 as derived from broad band afterglow modeling ( e.g. wijers & galama 1999 ; panaitescu & kumar 2002 ; yost et al .",
    "2003 ) , the x - ray flux predicted by the external shock model out - shines the template flux level ( which is based on observations ) by about three orders of magnitude .",
    "this is also emphasized in fig.[glitchfull ] which compares the simulated lightcurve ( including the contributions from the prompt emission and x - ray flares superimposed on the template ) and the calculated external shock lightcurve .",
    "it is evident that no steep decay phase and x - ray flares are observable if @xmath88 is adopted to calculate the afterglow level .",
    "this issue is carried over from the low efficiency problem of the internal shock model",
    ". if the observations are to be reproduced , there are two possibilities .",
    "the first is that the blast wave radiation efficiency is much lower .",
    "we test this possibility by lowering @xmath1 , and found that the predicted afterglow level can be roughly reproduced if @xmath1 is as low as @xmath2 ( figs.[glitchplot ] and [ glitchfull ] ) .",
    "the pile - up effect of shells onto the blast wave naturally produces a shallow decay phase ( after smoothing the abrupt jump features ) , which is an attractive feature of this internal - external - shock model .",
    "however , the anomalously small @xmath1 is inconsistent with the values derived from the previous broadband afterglow modeling , suggesting that this is likely not the correct approach to solve the problem .",
    "the second possibility is that the radiative efficiency of the prompt gamma - ray emission is very high ( e.g. zhang et al . 2007 ) .",
    "this requires a more efficient mechanism to generate the prompt emission .",
    "the data of the recent grb 080916c ( abdo et al .",
    "2009 ) suggests that the outflow is very likely poynting flux dominated ( zhang & peer 2009 ) .",
    "within such a picture , zhang & yan ( 2009 ) proposed an internal collision - induced magnetic reconnection and turbulence ( icmart ) model , which retains the merits of the internal shock model but significantly increases the prompt emission efficiency .",
    "the time history analysis of our shell model is also applicable to the icmart model .",
    "the prompt emission and x - ray flare features can be retained , but the radiation efficiency is increased .",
    "within such a scenario , the external shock level can be lowered to satisfy the observational constraint .",
    "one can estimate the amplitude of `` glitches '' in the x - ray light curves .",
    "in general , collisions onto the blast wave are not energetic enough to produce a prominent signature on the afterglow light curve , unless the injection energy is comparable to that already in the blast wave ( zhang & mszros , 2002 ) . in any case ,",
    "small glitches from arriving shells , although not individually seen , could effectively bump up the normal decay phase , making it appear shallower .",
    "postcollisions of shells sorted by decreasing lorentz factor by internal collisions could produce an observable signature in early afterglow lightcurves and may be seen as temporal variability or a deviation from power - law decay ( kumar & piran , 2000 ) .",
    "the amplitude of glitches produced by postcollisions can be calculated knowing the initial mass and lorentz factor of both the blast wave and colliding shell and will essentially represent how far in the vertical direction successive solutions are separated .",
    "for the first few postcollisions , the amplitudes of the glitches are rather large as the added shells have both lorentz factor and mass comparable to that of the blast wave itself . in this first stage",
    ", there is no simple approximation for calculating the jump in solution .",
    "the percent increases ( @xmath104 ) are 3000% , 1000% , 500% and 150% for the presented simulation . during the deceleration phase , the x - ray flux density @xmath105 for @xmath106 and @xmath107 for @xmath108 , where @xmath109 is the total energy in the blast wave .",
    "the glitch amplitude is simply determined by the increase of the blast wave energy during each collision . during the collision",
    ", there is a reverse shock propagating to the trailing shell .",
    "however , this reverse shock usually does not contribute significantly into the x - ray band , since its density is higher , and hence , the typical electron lorentz factor is much lower .",
    "its dominant output is in the optical band ( mszros & rees 1997 ; sari & piran 1999 ; zhang & mszros 2002 ) .",
    "it has been argued that for grbs with large peaks followed by deep troughs could be used to put an upper limit on the value of @xmath101 ( zou & piran , 2009 ) .",
    "the external shock component will be superimposed on the internal shock prompt pulses and if this external shock does not rise above the level of the trough and/or threshold sensitivity of the detector at that point , this could be used to put an upper limit on the lorentz factor of this first blast wave shell by knowing how high successive blast wave solutions will rise in flux .",
    "we find that this method , in principle , is a feasible method of putting a upper limit on @xmath101 with a few caveats in mind .",
    "figure [ glitchfull ] shows the blast wave solutions and blast wave ( external shock component ) plotted with the internal shock component lightcurve for one simulation . in general , the first shell of the external shock component will not be energetic enough to rise to the level of the prompt emission .",
    "as more and more shells pile onto the blast wave , the flux level rises and so looking for a solution that could be extrapolated backwards to find the initial @xmath101 is problematic since the external shock component , especially early on , will not be a smooth function of time .",
    "another complication is that the flux level of the blast wave emission sensitively depends on the unknown @xmath1 parameter , making the derived upper limit of @xmath101 subject to large uncertainty .",
    "we first model collisions of a group a shells that are injected in a single emission episode .",
    "this is relevant to grbs that have prompt emission without distinct gaps between pulses . allowing the central engine to eject multiple randomized shells which go on to collide , we track the information of individual shells .",
    "an example is shown in figs.[treeplot100shells]a and [ prompt]a . in this simulation ,",
    "100 shells are ejected where shell initial thickness , lorentz factor and mass are chosen from random distributions in log space : lorentz factors : @xmath110 , mass : @xmath111 , initial thickness : @xmath112 , all in cgs units .",
    "ejection times from the central engine are chosen from a linear random distribution @xmath113 seconds in the rest frame of the grb central engine .",
    "when two shells collide , we let them merge , drop one shell , and adopt the merged shell parameters ( @xmath14 , @xmath13 , @xmath15 ) as the new values of the remaining shell . in order to keep track of future collisions",
    ", we also need to re - set the `` effective '' ejection time of this new shell , which is taken as @xmath114 , where @xmath115 .",
    "the code then runs again with one shell reduced .",
    "the same procedure is applied when each collision happens , so that the code can track all the collision / merging processes for any arbitrarily designed central engine activity .",
    "figure [ treeplot100shells]a displays the `` tree - plot '' of this simulation . the upper panel displays how shells with different lorentz factors are ejected , collide and merge at various distances .",
    "the time information is not displayed , but the collision times @xmath116 ( again in the rest frame of the central engine ) can be read off from the lower panel .",
    "this time is translated into the observed time according to eq.([time ] ) to calculate the lightcurve ( fig.[prompt]a ) .",
    "the evolution of the blast wave is also marked in the upper panel as a thick red line .",
    "collisions are `` disallowed '' if the shells collide with the blast wave ( i.e. they would have collided at a radius greater than that of the blast wave , had the blast wave not existed . ) .",
    "these shells are included to boost the blast wave energy and become part of the blast wave after the collision and are therefore no longer traced in the later simulation .",
    "our results suggest that a single episode can reproduce prompt emission of some grbs . even for simulations with a large number of shells , the ejection time in the frame of the central engine ( @xmath12 )",
    "is correlated to the observed time of the collision ( @xmath117 ) with little scatter ( fig .",
    "[ corrplot2 ] , see also kobayashi et al .",
    "there are indeed collisions with much larger collision times ( red crosses ) , but they are `` excluded '' by the blast wave constraint . if prompt emission and x - ray flares are indeed produced by the same mechanism , late flares are unlikely to be produced by shells that are ejected early . as discussed in the following , they demand re - activation of the central engine",
    "lightcurves are produced by considering the spectral model and temporal model as discussed in  2 .",
    "the xrt band lightcurve of this particular simulation is shown in fig.[prompt]a . the relevant detector threshold ( thick , dotted line ) is also added .",
    "( d. n. burrows , 2008 , private communication ) .",
    "it is evident that without late central engine activity , no x - ray flares can be detected .      in order to reproduce the observed x - ray flares that occur in distinct emission episodes from the prompt emission , we are obliged to simulate multiple ejection episodes from the central engine .",
    "the results are displayed in figs .",
    "[ bololightcurve ] , [ treeplot100shells]b , [ prompt]b and [ fluxlightcurves ] . in these simulations",
    ", three groups of shells ( `` _ _ a _ _ '' , `` _ _ b _ _ '' and `` _ _ c _ _ '' ) are released .",
    "the _ a _ group consisting of 50 shells is released in the first 100 seconds .",
    "the majority of these shells merge with each other producing _ aa _ type collisions .",
    "the energy released in each collision is shown as `` aa '' in fig.[bololightcurve ] .",
    "similar to the previous simulation (  4.1 ) , most _ aa _ type collisions occur before 100 seconds . after 3000 seconds , we release a set of 5 _ b _ group shells with energies reduced by @xmath7 20 times on average .",
    "these shells can have two types of collisions : _ bb _ type collisions or _",
    "_ type collisions ( see fig.[bololightcurve ] ) . both the _ ab _ and _ bb",
    "_ type collisions could produce x - ray flares , as long as they are bright enough to stick out above the power law afterglow level ( the broken power law template ) .",
    "for late x - ray flares , the energy of these collisions is of the `` goldilocks type '' : high enough to be above the background decay , but small enough to peak in the x - ray band and therefore remain undetectable by bat .",
    "after 30,000 seconds , a third batch of _ c _ shells are released with energy lower than that of the _ b _ shells by @xmath7 20 times again .",
    "this can in principle produce _ cc , ac _ or _",
    "bc _ collisions , but for this particular simulation , _ ac _ and _ bc _ collisions are lacking ( fig.[bololightcurve ] ) .",
    "these cross collisions are disfavored since their collision radii tend to be large ( due to the large ejection gap between the shells ) , so that the leading shells likely have collided onto the blast wave before the trailing shell catches up .",
    "progressively less energy in _ a _ , _ b _ and _ c _ shells allows progressively degrading energetics of the x - ray flares , as is commonly observed .",
    "this is also generally consistent with various central engine models , where the accretion or magnetic power of the engine tends to die off with time .",
    "another interesting topic is to investigate how the observed widths of x - ray flares can be reproduced . in particular",
    ", the observed @xmath118 trend suggests that the later flares ( larger @xmath5 ) are wider ( larger @xmath119 ) .",
    "this requires that the shell width @xmath15 broadens with time .",
    "a natural broadening mechanism is shell spreading ( eq.[[shellspreading ] ] ) .",
    "after a shell enters the spreading regime , the width of the shell is proportional to the radius , so that resultant x - ray flare width can be wide if the collision radius is large . without placing the blast wave constraint ,",
    "one indeed expects many `` fat '' flares , corresponding to very large radius collisions . with the blast wave constraint ,",
    "the number of `` fat '' flares reduces significantly .",
    "figure [ widthinfo]a displays the model - predicted flare width as a function of their occurrences for a narrow distribution of the initial width @xmath46 ( between @xmath120 cm , with the @xmath121 line over plotted .",
    "the blue pluses are allowed but the red crosses are disallowed .",
    "the result suggests that although the predicted values are around the @xmath121 line , the scatter is broader than what is observed .",
    "in particular , many narrow flares are predicted ( those without significant spreading ) .",
    "the lightcurve for this simulation is presented in fig.[latefatshells]a , which shows narrow late time flares that are not observed by the swift / xrt data . in order to reproduce the observations ,",
    "one is required to increase the initial shell width @xmath46 for late ejection episodes .",
    "figures [ widthinfo]b and [ latefatshells]b show an example of late injection of `` fat '' shells . generally , @xmath122 is needed to reproduce the observed data .",
    "this is consistent with the expectations of some central engine models .",
    "for example , in the fragmented disk model proposed by perna et al .",
    "( 2006 ) , the clumps at larger radii have lower densities and tend to be more spread out so that the accretion time scale is longer .",
    "the ejected shells correspondingly also have longer durations .",
    "we have developed a numerical code to model the internal collisions of an unsteady wind with arbitrary central engine activities .",
    "this is an extension of the internal shock models previously developed to model grb prompt emission ( e.g. kobayashi et al . 1997 ) , with a focus on x - ray flares that are commonly observed in grb x - ray afterglows ( e.g. chincarini et al .",
    "our motivation is to diagnose the required central engine activities based on the observational properties of x - ray flares as summarized in  1 .",
    "the following conclusions can be reached :    * the internal shock model with multiple ejection episodes can generally reproduce the properties of x - ray flares .",
    "our shell model naturally explains both prompt emission and x - ray flares , suggesting that they originate from very similar mechanisms .",
    "* we find that the number of pulses / flares is directly related to the number of shells released from the central engine .",
    "more shells means more flares . in general",
    ", we find that the number of collisions is slightly smaller than the number of the shells ejected ( e.g. the most probable values are : @xmath123 less for 100 simulated shells , @xmath124 less for 50 simulated shells , 8 collisions for 10 simulated shells and 1 collision for 4 simulated shells , see fig.[stats ] for distributions ) .",
    "for a modal number of observed flares of 1 , between 2 and 5 shells need to be released on average . *",
    "the correlation between @xmath12 and @xmath117 ensures that the shells that are responsible for creating flares must be ejected just prior to being seen .",
    "this is because the second term in the right hand side of eq.([time ] ) is typically much shorter than the first term .",
    "this means that not only the central engine activity must be prolonged , but it must also be episodic .",
    "steady energy injection can not produce flare - like features .",
    "in other words , early flares are created by shells ejected early , while late flares by shells ejected late .",
    "since flares are seen as late as @xmath10 seconds , this means that the central engine can be active for a long time after the prompt emission .",
    "these conclusions are consistent with zhang et al .",
    "( 2006 ) , liang et al .",
    "( 2006 ) and lazzati & perna ( 2007 ) . * the large variance of fluences seen in flares can be explained by the different energies ( @xmath125 ) of the ejected shells .",
    "the peak luminosity of a flare also depends on the width of the pulse , which is either related to shell spreading or intrinsically different durations of shell ejection .",
    "* this study seems to rule out uniform ( or narrow distribution ) thickness shells .",
    "the observed widths of flares can not be reproduced solely by spreading effects .",
    "one requires that later ejection episodes eject shells with larger widths to explain the typical flare width of @xmath126 .",
    "since most shells collide before spreading , typical late collisions would be too narrow if later ejected shells had the same width as the initial prompt ejection episodes .",
    "sharp flares where the width is near 1/10 of the emission time of the flare are common , but `` fat '' flares are seen occasionally as well .",
    "for example , the giant flare of grb050502b has a @xmath127 ( chincarini et al .",
    "2007 ) implying that shells may either have spread before colliding or may simply have had a large width when ejected .",
    "shells which have spread significantly before colliding will have energies spread over a large log - gaussian shape and may be too dim to reach above the afterglow decay .",
    "* for goldilocks type shells , flares are seen in the xrt band only .",
    "the gamma - ray component of the x - ray flare ( band - function extension ) is below the bat detector threshold .",
    "figure [ fluxlightcurves ] shows light curves from a few typical simulations and these features can be seen .",
    "* flares superimposed on other flares are simply shells that collide near the same time with different widths and fluences .",
    "the observed x - ray afterglow is a superposition of flares due to prolonged central engine activity and a background afterglow radiation , whose origin is not addressed in our paper . *",
    "the decrease in average flare luminosity as a function of time indicates shells released at later times must create less energetic collisions ( lazzati et al .",
    "2008 ) . in order to produce the results",
    "seen , late released shells must be wider , less dense , slower or a combination of the above in order to create less energetic collisions seen .",
    "* the same shell model can give a prediction on the x - ray afterglow emission from the blast wave .",
    "due to the continuous piling up of late - ejection shells onto the blast wave , the lightcurve can show a shallow decay phase that is commonly observed .",
    "however , if a standard value @xmath128 is adopted , the predicted x - ray lightcurve is much brighter than what is seen , by about three orders of magnitudes . in order to reproduce the observed data , either a much lower @xmath1 ( as low as @xmath2 ) needs to be introduced , or the internal emission that powers the prompt emission and x - ray flares has to be much more efficient than internal shock predictions .",
    "recently there has been interest in optical flares ( krhler et al .",
    "2009 , melandri et al .",
    "these flares can be naturally interpreted in our model by invoking collisions between low energy shells or wide shells .",
    "such collisions could be seen in optical bands but may be missed in higher energy bands .",
    "a direct expectation from this model is that optical flares should on average have lower energies and broader profiles than x - ray flares .",
    "an internal shock origin of optical flares was also proposed by wei ( 2007 ) .",
    "finally , we want to emphasize that observationally flares have been seen in both type i ( e.g. grb 050724 ) and type ii grbs .",
    "this requires that both types of progenitor have a similar central engine , which can eject an episodic wind to power late central engine activities which is a requirement of any central engine models for x - ray flares .",
    "we thank shiho kobayashi and dave burrows for discussion , and the anonymous referee for helpful comments . this work is supported by nasa under grants nnx08an24 g ,",
    "nnx08ae57a , ar9 - 0006x , and by nsf under grant ast-0908362 ."
  ],
  "abstract_text": [
    "<S> x - ray afterglow light curves have been collected for over 400 swift gamma - ray bursts with nearly half of them having x - ray flares superimposed on the regular afterglow decay . </S>",
    "<S> evidence suggests that gamma - ray prompt emission and x - ray flares share a common origin and that at least some flares can only be explained by long - lasting central engine activity . </S>",
    "<S> we have developed a shell model code to address the question of how x - ray flares are produced within the framework of the internal shock model . </S>",
    "<S> the shell model creates randomized grb explosions from a central engine with multiple shells and follows those shells as they collide , merge and spread , producing prompt emission and x - ray flares . </S>",
    "<S> we pay special attention to the time history of central engine activity , internal shocks , and observed flares , but do not calculate the shock dynamics and radiation processes in detail . using the empirical @xmath0 ( amati ) relation with an assumed band function spectrum for each collision and an empirical flare temporal profile , we calculate the gamma - ray ( swift / bat band ) and x - ray ( swift / xrt band ) lightcurves for arbitrary central engine activity and compare the model results with the observational data . </S>",
    "<S> we show that the observed x - ray flare phenomenology can be explained within the internal shock model . </S>",
    "<S> the number , width and occurring time of flares are then used to diagnose the central engine activity , putting constraints on the energy , ejection time , width and number of ejected shells . </S>",
    "<S> we find that the observed x - ray flare time history generally reflects the time history of the central engine , which reactivates multiple times after the prompt emission phase with progressively reduced energy . </S>",
    "<S> the same shell model predicts an external shock x - ray afterglow component , which has a shallow decay phase due to the initial pile - up of shells onto the blast wave . </S>",
    "<S> however , the predicted x - ray afterglow is too bright as compared with the observed flux level , unless @xmath1 is as low as @xmath2 . </S>"
  ]
}