{
  "article_text": [
    "quantum dynamics of bosonic systems @xcite is a highly active branch of modern physics .",
    "it plays a crucial role in experiments with trapped ultra cold atomic or molecular clouds especially when external trap potentials are varied in time .",
    "theoretical predictions on the dynamics of quantum systems in these cases are highly desirable .",
    "quantum dynamics is usually governed by the time - dependent schrdinger equation @xcite . to solve it means to define an initial condition , i.e.",
    ", initial wave packet , and to find the evolution of this initial state in time , i.e. , to propagate it . in this work",
    "we are interested in the many - body dynamics of quantum systems made of indistinguishable bosons . specifically , to solve the time - dependend multi - boson schrdinger equation we use a the multiconfigurational time - dependent hartree method for bosons ( mctdhb ) , developed recently in refs .",
    "the mctdhb(@xmath2 ) is a very efficient and successful propagation tool , because it utilizes a very powerful ansatz for @xmath3-boson wave function , defined in a complete fock subspace , and spanned by all possible many - body basis functions ( permanents ) appearing as permutation of @xmath3 bosons over @xmath2 time - dependent self - consistent orbitals .",
    "the key idea of the original mctdh technique ref .",
    "@xcite was to consider as many - body basis functions the hartree products build of @xmath3 time - dependent orbitals , which can be , in principle , identical .",
    "this method has been widely and successfully applied ( see ref .",
    "@xcite ) to study multi - dimensional quantum dynamics of polyatomic molecules , where each vibrational mode has been assigned to a distinguishable quasi - particle .",
    "lately , it was realized that by applying anti - symmetrization operation to the hartree products one can study dynamics of fermionic systems , so the original mctdh method has been expanded in ref .",
    "@xcite to the mctdhf , here the letter `` f '' means fermions .",
    "analogously , we took symmetrized hartree products ( permanents ) as many - body basis functions in ref .",
    "@xcite and showed their applicability for stationary multi - boson problems and , for the first time in this context , reformulated the representation of the working equations in terms of elements of the reduced one- and two - body density matrices .",
    "this reformulation has provided a deeper insight onto the underlying structure of the mctdh `` ideology '' and allowed us to derive in refs .",
    "@xcite closed - from mctdhb equations for time - dependent bosonic problems and extend the mctdh ideas further in refs .",
    "@xcite to mixed systems of bosons , fermions and spinors , as well as to systems with particle conversion ref .  @xcite . in the latter case particles of one kind , e.g. , atoms , are allowed to undergo transformation and build up particles of another kind , i.e. , molecules , and vice - versa .",
    "the developed mctdhb theory has been successfully applied to study a splitting of a repulsive bosonic cloud by ramping - up a potential barrier in ref .",
    "an optimal control of this process has been addressed in ref .",
    "the first- and second - order correlation functions of the split sub - clouds have been analyzed in ref .",
    "@xcite . in ultra - cold atomic clouds with attractive inter - boson interactions",
    "the split phenomena take even more interesting forms . in ref .",
    "@xcite we have shown that by pumping energy into an initially - coherent localized attractive bosonic cloud one can fragment it into two dynamically stable sub - clouds , which are still strongly coupled . moreover , attractive bosonic systems also support another kind of dynamically stable fragmented states  the famous quantum superposition states . these can be formed by scattering an attractive cloud from a potential barrier , as was predicted independently by two groups using absolutely different many - body methods  @xcite . in ref .",
    "@xcite within the framework of the mctdhb method we have shown that there is a much more efficient way to generate the quantum superposition states  instead of scattering an initially - coherent attractive cloud from the potential barrier one can thread it by a barrier .",
    "the mctdh method is so numerically stable and powerfull that one can use the many - body basis sets made of non - symmetrized hartree products , originally proposed to describe distinguishable particles , to study systems of indistinguishable particles .",
    "the configurational spaces in these cases , however , are much larger than actually needed restricting the applicability of such a scheme to few - particle problems .",
    "nevertheless , numerically - exact studies of few - boson problems using this scheme have been successfully done in refs .",
    "@xcite .    to specify the many - body wave function in mctdhb means to provide two sets of complex numbers  a set of expansion coefficients , i.e. , a vector - array of the size of the respective fock subspace , and a set of @xmath2 one - particle functions usually defined on a real space grid .",
    "both these sets are time - dependent , i.e. , they are changing in time .",
    "the time - evolution of the expansion coefficients in the fock space and the orbitals in space are governed by the respective mctdhb equations @xcite . in ref .",
    "@xcite we have developed a novel , effective and general algorithm to operate with state vectors in fock space , without resorting to matrix representation of operators and even to its elements .",
    "now our goal is to utilize , implement , and apply these ideas to the mctdhb method .",
    "in particular , we expect that a parallel implementation of the mctdhb method augmented by the proposed algorithm allows us to propagate the time - dependent schrdinger equation faster and more efficiently for larger configurational spaces , and thus be able to attack bigger systems , and to propagate for longer times .    in this paper",
    "we apply the mctdhb method augmented by the invented algorithm  @xcite to study real - space dynamics of repulsive bosonic systems made of @xmath0 , 51 and 3003 bosons in triple - well traps with periodic boundaries . as initial wave packets",
    "we take fully threefold fragmented states and displace them suddenly and strongly out of equilibrium .",
    "the periodic trap used for the propagations supports at least six bound eigenstates per well , i.e. , six bands are available for the quantum dynamics . as a consequence of the displacement applied , the energies per particle of the evolving wave packets are located between the fourth and fifth bands which implies strongly non - equilibrium dynamics . on the one hand",
    ", we would like to see how the properties of these highly non - equilibrium systems change in time and what are the most relevant physical phenomena behind .",
    "for example , to clarify the role of finite @xmath3 effects we analyze and compare the quantum dynamics of the systems made of different number of bosons but characterized by very similar interparticle interaction energies . on the other hand",
    ", we also plan to demonstrate the convergence of the mctdhb(@xmath2 ) method , for short , intermediate and long propagation times .",
    "more specifically , we compare the computations done at different levels @xmath2 of the mctdhb(@xmath2 ) theory , i.e. , by systematically increasing the number @xmath2 of time - dependent self - consistent orbitals .",
    "the key methodological consequence of this study is to show that due to the algorithm used one can tackle large configurational spaces thus opening many new opportunities for the mctdhb method .",
    "the structure of the paper is as follows . in section [ secii ]",
    "we consider a general many - boson system in real space , define its hamiltonian and the @xmath3-boson state vector ( wave function ) .",
    "the basics of the multiconfigurational time - dependent hartree method for bosons ( mctdhb ) are given in subsection [ secii.1 ] .",
    "the implementation of the novel idea how to operate by a bosonic hamiltonian on a state vector within the mctdhb method is discussed in subsection [ secii.2 ] . in particular , we describe how to map and address permanents ( configurations ) , how to operate with one- and two - body operators as well as with total hamiltonian , and how to construct the respective expectation values .",
    "application of the mctdhb method to many - boson quantum dynamics in triple - well traps is illustrated in section [ seciii ] . in subsection [ seciii.1 ]",
    "we provide the specification of the systems under consideration  initial and final trap potentials , initial wave packets , interparticle interactions , etc .",
    "the detailed analysis of the evolving wave packets for the systems made of @xmath0 , 51 and 3003 bosons are reported in the subsections [ seciii.2 ] , [ seciii.3 ] , and [ seciii.4 ] respectively .",
    "section [ seciv ] summarizes and concludes .",
    "the quantum dynamics of a system made of @xmath3 bosons is governed by the many - body time - dependent schrdinger equation .",
    "this equation describes the evolution of a many - boson wave function @xmath4 in time : h ( t ) & = & i , [ mbse ] + h(_1,_2, ",
    ",_n ) & = & _ j=1^n",
    "h(_j ) + _ k > j=1^n",
    "w(_j-_k ) . [ mbse1 ]",
    "were @xmath5 , @xmath6 is the coordinate of the @xmath7-th boson , @xmath8 is the one - body hamiltonian containing kinetic and potential energy terms , and @xmath9 describes the pairwise interaction between the @xmath7-th and @xmath10-th bosons . in the most general case , the one - body potential @xmath11 and the two - body interaction @xmath9 and , hence , the many - boson hamiltonian @xmath12 itself may be time - dependent . to solve eq .",
    "( [ mbse ] ) means to specify initial conditions at @xmath13 and propagate the ansatz in time .",
    "more precisely , we have to specify the many - body wave function @xmath14 , i.e. , an object which depends on coordinates @xmath15 of each of @xmath3 particles and by using eq .",
    "( [ mbse ] ) find the many - boson wave function at desired time @xmath4 .",
    "general analytical solutions of the time ( in)dependent schrdinger are unknown , therefore , different numerical approaches are in use @xcite . in this section ,",
    "we consider one of them  the multiconfigurational time - dependent hartree method for bosons ( mctdhb ) .",
    "the general formulation and derivation of the mctdhb method have been given elsewhere , see refs .",
    "@xcite for the details . here , we present the final equations and give some remarks on the numerical realization of the novel ideas in @xcite how to operate in a configurational ( fock ) space without resorting to the matrix representation of the respective operators .",
    "the mctdhb ansatz , i.e. , the proposed structure of the many - boson wave function is a linear combination of time - dependent many - body basis functions @xmath16 : [ mctdhb_ansatz ] |(t ) > = ^n__c_(t)|;t>. for a system of indistinguishable bosons we take permanents as many - body basis functions .",
    "every permanent is constructed as a symmetrized hartree product of @xmath3 one - particle functions ( orbitals ) : [ basic_permanents_x ] _",
    "1,_2,_3,,_n    @xmath17 bosons reside in the first orbital , @xmath18 bosons reside in second one , etc . , and",
    "@xmath19 bosons reside in the @xmath2-th orbital .",
    "the possible occupation patterns @xmath20 , also called configurations , are constrainted only by the condition that the total number of particles is conserved @xmath21 .",
    "so , the complete configurational space of the standard mctdhb(@xmath2 ) method is formed by all possible permanents obtained by distributing @xmath3 bosons over @xmath2 orbitals @xcite : [ nconf ] n_= , where @xmath22 .",
    "the specification mctdhb(@xmath2 ) means that @xmath2 self - consistent time - adaptive orbitals have been used in the computation and the size of the respective fock space , i.e. , the total number of the configurations is determined by eq .",
    "( [ nconf ] ) .    at",
    "any given time the many - boson mctdhb(@xmath2 ) wave function @xmath23 is known if the set of expansion coefficients @xmath24 , i.e. , a complex array of @xmath25 elements and the set of @xmath2 one - particle functions @xmath26 are specified . here , we do not discuss how one - particle functions are represented because this depends on the dimensionality of the problem and on the particular realization of the code .",
    "for example , in 1d cases , one can represent each of these functions on a @xmath27-dimensional grid as a vector - array of complex numbers .",
    "the mctdhb(@xmath2 ) ansatz eq .",
    "( [ mctdhb_ansatz ] ) possesses a standard feature of any many - body time - dependent expansion  its expansion coefficients @xmath28 depend on time .",
    "it reflects the basic idea of quantum propagation : the many - body wave packet is composed of contributions of very many states ( configurations ) and these contributions are changing in time . the ansatz eq .",
    "( [ mctdhb_ansatz ] ) has an additional , the mctdhb- specific feature  dependency of the orbitals , i.e. , one - particle functions @xmath29 used to construct the permanents eq .",
    "( [ basic_permanents_x ] ) on time .",
    "the orbitals @xmath29 of the evolving many - boson wave packet are optimized at every point in time according to the dirac - frenkel variational principle @xcite , changing , thereby , the many - body basis permanents .",
    "we shall see later how this additional mctdhb - specific feature allows one to span effectively much larger configurational spaces in comparison to methods using fixed , i.e. , time - independent orbital basis sets",
    ".    in the mctdhb theory the expansion coefficients @xmath28 and the shapes of one - particle functions @xmath26 are considered as independent variational parameters , see refs .",
    "we substitute the mctdhb(@xmath2 ) ansatz eq .",
    "( [ mctdhb_ansatz ] ) into the hamiltonian and introduce lagrange multipliers to guarantee the normalization of the total wave function as well as orthonormalization of the orbitals .",
    "then , by utilizing the dirac - frenkel time - dependent variational principle @xcite we get a coupled system of integro - differential equations which have to be solved ( integrated ) simultaneously . according to the derivation",
    ", the coupled system is composed of two sets of the variational equations , one for the expansion coefficients @xmath28 and another one for the one - particle functions @xmath29 . in numerical implementations of these equations , it is usually assumed that during the elementary propagation of the first set of variational parameters , say expansion coefficients from @xmath28 to @xmath30 , the second one , i.e. , the orbital set @xmath29 , is kept fixed , and vice - versa , during the propagation of the orbitals from @xmath29 to @xmath31 the @xmath28-set is kept fixed .",
    "of course , the @xmath32 has to be sufficiently small .",
    "the first set of the mctdhb equations describes the evolution of @xmath25 expansion coefficients and can be rewritten as : [ mctdhb_ci ] i= ( t ) , where @xmath33 is the matrix representation of the hamiltonian . in this equation",
    "it is assumed that at each point in time , the shapes of the orbitals @xmath29 are known and , therefore , during an elementary numerical propagation time step they remain unchanged , i.e. , fixed . hence , the original real - space hamiltonian operator [ see eq .",
    "( [ mbse1 ] ) ] is represented now in the second quantized form : [ mb_ham ] h = _ k , q h_kq b_k^b_q + _ k , s , q , l w_ksql",
    "b_k^b_s^b_l b_q , where the elements @xmath34 of the one- and @xmath35 of the two - body operators are directly available as integrals over the discussed above orbitals : [ matrix_elements ] h_kq & = & _ k^(,t ) h ( ) _ q(,t ) d , + w_ksql & = & _ k^(,t ) _",
    "s^(,t ) w(- ) _ q(,t ) _",
    "l(,t ) dd.    the second set of the mctdhb equations , also called equations - of - motion for orbitals , describes the evolution of @xmath2 orbitals @xmath36 and can be written as : [ mctdhb_psi ] i|_j > & = & , j=1,,m , + & = & 1-_j=1^m|_j > , + _ kslq&=&. since the orbitals @xmath37 are time - dependent functions , the integrals @xmath38 and @xmath35 , computed according to eq .",
    "( [ matrix_elements ] ) become time - dependent functions even for time independent hamiltonians . hence",
    ", the price of using the self - consistent time - adaptive orbitals is that at every elementary numerical propagation time step one has to update these integrals , i.e. , the second quantized form of the hamiltonian , eq .",
    "( [ mb_ham ] ) .    having the mctdhb(@xmath2 )",
    "wave function @xmath23 at every given time , i.e. , the @xmath25 complex numbers @xmath28 and @xmath2 one - particle functions @xmath29 , we have an access to the elements of the reduced one- , two- or higher - order density matrices and can construct , thereby , respective correlation functions @xcite or compute any desired properties .",
    "specifically , in this work we construct and diagonalize the reduced one - body density matrix : [ no ] ( , ;t)&= & = + & = & _ k , q _ kq _ k^(,t ) _ q(,t)=n_k n_k(t ) _",
    "k^no(,t ) _",
    "k^no(,t ) , the obtained eigenvalues @xmath39 and eigenvectors @xmath40 are called natural occupation numbers and natural occupation orbitals , respectively .",
    "hence , this diagonalization procedure is often called natural analysis .",
    "a simple visualization of the reduced one - body density is obtained by plotting only its diagonal part @xmath41 , also referred to as density .",
    "summarizing , there are @xmath25 mctdhb equations ( [ mctdhb_ci ] ) describing the evolution of the expansion coefficients , and @xmath2 non - linear integro - differential equations ( [ mctdhb_psi ] ) describing the evolution of the one - particle functions . to propagate the initial state , we divide time onto small elementary slices or steps . during every elementary time step either set of expansion coefficients or one - particle functions",
    "is assumed to be unchanged .",
    "this allows within a given time step to integrate the mctdhb eqs .",
    "( [ mctdhb_ci ] ) and eqs .",
    "( [ mctdhb_psi ] ) independently , see refs .",
    "@xcite for more details .",
    "the evolution of the one - particle functions , i.e. , propagation of the respective eqs .",
    "( [ mctdhb_psi ] ) can be done by using general variable - order integrators , such as the adams - bashforth - moulton ( abm ) predictor - corrector integrator @xcite . to propagate eqs .",
    "( [ mctdhb_ci ] ) for expansion coefficients we can use the short iterative lanczos ( sil ) scheme @xcite , because in the present work we deal with hermitian hamiltonians , i.e. , with real traps and real interparticle interaction potentials .",
    "the key ingredient of the sil technique is a @xmath42-dimensional krylov subspace , formed by repeated operations of the hamiltonian : @xmath43 . to integrate the configurational part of the mctdhb(@xmath2 ) equations",
    "[ see eqs .",
    "( [ mctdhb_ci ] ) ] at a given point in time we need these vectors only .    in a standard computational scheme to construct krylov vectors at every integration step one",
    "first recalculates the hamiltonian matrix elements @xmath44 which is a quite tedious task that even for a moderate - sized systems .",
    "and then by multiplying this matrix with the complex vector - array of the expansion coefficients repeatedly one builds up the krylov subspace of the desired size . in ref.@xcite",
    "we invented an alternative technique to compute the action of the hamiltonian on a state vector .",
    "now , we discuss how to implement the proposed ideas to the mctdhb method to obtain quickly and efficiently all the required vectors without ( re)construction of the respective hamiltonian matrix at every point in time .",
    "this allows , as we shall demonstrate below , for faster operations in larger configurational spaces .",
    "the propagation of the mctdhb wave function within a given time interval consists of two steps : propagation of the expansion coefficients keeping the orbitals fixed , eqs .",
    "( [ mctdhb_ci ] ) , and propagation of the orbitals keeping the expansion coefficients unchanged , see eqs .",
    "( [ mctdhb_psi ] ) .",
    "the key operation at the first step is the action of the hamiltonian eq .",
    "( [ mb_ham ] ) on a state vector @xmath45 , having at hands the integrals @xmath34 and @xmath35 .",
    "at the second step we need to know the elements @xmath46 and @xmath47 of the reduced one- and two - body density matrices .",
    "this subsection shows how to get these quantities by implementing and utilizing the ideas reported in ref .",
    "@xcite .    as we have seen above , the set of the one - particle functions @xmath29 and the set of expansion coefficients @xmath28 , i.e. , the complex array of @xmath25 elements , specify the mctdhb wave function @xmath23 at any given time . we first introduce a simple and compact scheme to enumerate elements of the complex array @xmath48 .",
    "more strictly , we utilize the explicit scheme of ref .",
    "@xcite to map @xmath2 integers @xmath49 characterizing each configuration to one integer @xmath50 addressing it as a coordinate of the state vector .",
    "the address @xmath50 of the bosonic configuration @xmath51 in the state vector is computed as : @xmath52 technically , it means that for any given set of @xmath2 integer occupation numbers @xmath53 we can immediately compute one integer ",
    "its address @xmath50 . consequently , using this mapping we can access any desired element of the complex array @xmath48 by providing the respective set of the occupation numbers .",
    "the next question is how to access the elements of the @xmath48 array .",
    "let us take the definition of the mctdhb(@xmath2 ) ansatz ( [ mctdhb_ansatz ] ) and rewrite it : [ j_psi ] | > = ^n__j=1c_j|j ( ) > , where the summation index @xmath50 running over all @xmath25 configurations is associated with the above defined mapping index eq .",
    "( [ j - numbering ] ) .",
    "to access every @xmath54 element by starting one _ do-_loop over @xmath50 is inconvenient , because one has to , first , restore @xmath2 occupation numbers @xmath55 corresponding to every given address @xmath50 at every step , i.e. , to solve the respective inverse problem .",
    "that is in principle possible but not necessary . to avoid it ,",
    "we start , instead , @xmath2 nested _",
    "do-_loops running over occupation numbers @xmath56 with the condition that @xmath57 , the index @xmath50 is immediately available by applying eq .",
    "( [ j - numbering ] ) .",
    "hence , in the case of an @xmath2-loop implementation there is no need to solve the inverse problem at all .",
    "from now on , by writting a sum over index @xmath50 we actually mean that in practical implementations @xmath2 nested loops over @xmath56 are running instead .",
    "the repeated recomputations of the binomial coefficients needed by eq .",
    "( [ j - numbering ] ) can be avoided by introducing a small static two - dimensional array and filling it only once by the respective binomial integers .",
    "hence , to find the address @xmath50 corresponding to a given set @xmath55 of the occupation numbers one needs to sum up @xmath58 elements of this integer array .",
    "now , we approach the key issue  how to find the result of the action of the hamiltonian eq .",
    "( [ mb_ham ] ) on a bosonic state vector . within a standard quantum mechanical text - book approach , e.g. , ref .",
    "@xcite , to get @xmath59 one needs , first , to construct the respective hamiltonian matrix and then to multiply it by the complex vector of expansion coefficients @xmath48 . in ref .",
    "@xcite we propose a simple alternative to it .",
    "the hamiltonian is a sum of one - body @xmath60 and two - body @xmath61 terms . if the result of action of every basic one - body @xmath62 and two - body @xmath63 operator on a state vector is known , the total action of the hamiltonian is obtained by summing them up . in  @xcite",
    "we discussed these operations in great details , here we give only the final formulations .      in ref .",
    "@xcite we have seen that the action of the @xmath62 combination of creation and annihilation operators on every configuration @xmath64 of the incoming state vector can be interpreted as a re - addressing of this configuration to another one @xmath65 scaled by a statistics - dependent weight .",
    "therefore , using the introduced above mapping we can get the result of the action of the @xmath62 on every component of the bosonic state vector @xmath45 , for a given pair @xmath10 and @xmath66 : [ one - body_oper ] | ^kq >",
    "b^_kb_q | > = ^n__jc^kq_j|j ( ) > , + c^kq_j = c_j^kq . as we have discussed above , instead of running one _ do-_loop over index @xmath50",
    ", we start here @xmath2 nested _ do-_loops over @xmath56 . the occupation pattern of the current configuration @xmath50 is explicitly known @xmath67 .",
    "the occupation pattern of the configuration that we reffer to as @xmath68 is obtained from the current one by reducing the occupation number of the @xmath10-th orbital by one , i.e. , now it becomes @xmath69 and by increasing the occupation number of the @xmath66-th orbitals by one @xmath70 : @xmath71 .",
    "the change between @xmath66 and @xmath10 indices appears due to the change of the summation index , see ref .",
    "@xcite for more details .",
    "using eq .",
    "( [ j - numbering ] ) we compute the addresses of the current @xmath72 and referred @xmath73 configurations .",
    "the element @xmath74 with address @xmath50 of the resulting state vector is obtained as a product of the @xmath75 component of the incoming state vector , having address @xmath68 , and the @xmath76 prefactor .",
    "this simple and straightforward methodology is ideally suitable for programming .",
    "moreover , within the framework of this method we also get a direct access to the elements @xmath46 of the reduced one - body density matrix . indeed , according to the standard definition , for a given state vector @xmath45 , the one - body density matrix element reads : [ rho_ij ] _",
    "kq= ] = = ^n__jc^*_jc^kq_j .",
    "thus , the matrix elements @xmath46 can be immediately computed as a dot - product of the incoming @xmath45 and resulting @xmath77 state vectors .",
    "similarly , we get the action of the general ( @xmath78 ) two - body @xmath63 operator on the incoming state vector @xmath45 : [ two - body_oper ] |^kslq > b^_kb^_sb_lb_q| > = ^n__jc^kslq_j|j ( ) > , + c^kslq_j = c_j^kslq , where the current index @xmath79 of the resulting vector as well as the address of the incoming vector , which we refer to @xmath80 are computed using eq .",
    "( [ j - numbering ] ) .",
    "the respective element of the two - body density is obtained as a dot - product of the incoming @xmath45 and resulting @xmath81 state vectors : [ rho_ijkl ] _",
    "kslq= ] = = ^n__jc^*_jc^kslq_j .",
    "obviously , in the discussed scheme the elements of the one- and two - body density matrices , needed by the second part of the mctdhb(@xmath2 ) equations ( [ mctdhb_psi ] ) are naturally available .",
    "clearly , the elements of three- and higher - body density matrices can be obtained in a very similar way .",
    "the following strategy is implemented in the mctdhb(@xmath2 ) code to obtain the result of the action of the hamiltonian on a state vector .",
    "first , for a given vector @xmath45 , i.e. , a given set of the expansion coefficients @xmath48 , the actions of every one- and two - body basic operators are evaluated using eqs .",
    "( [ one - body_oper ] ) or ( [ two - body_oper ] ) . each of these actions can be computed independently , implying effective parallelization .",
    "namely , the @xmath48 array , corresponding to the incoming vector is copied over all the available nodes .",
    "then , on every node , independently , we start @xmath2 nested loops to get the resulting @xmath77 and @xmath81 vectors , corresponding to every pair @xmath82 and quartet @xmath83 .",
    "second , by taking the dot - product of the incoming and the resulting state vectors , i.e. , by using eqs .",
    "( [ rho_ij ] ) or ( [ rho_ijkl ] ) we obtain the respective elements @xmath46 and @xmath84 of the reduced one- and two - body density matrices .",
    "third , by multiplying all the elements of the resulting vectors by the corresponding integrals we get the desired actions of the respective @xmath85 and @xmath86 terms of the hamiltonian on the incoming state vector .",
    "fourth , by summing up the resulting vectors from all the terms we obtain the total action of the hamiltonian on the incoming state vector .",
    "finally , we easily compute the expectation value of the hamiltonian @xmath87 as a dot - product of the total resulting and incoming state vectors .      in principle",
    ", the desired vector @xmath59 can be obtained by collecting actions from one- and two- body operators into two separate groups and summing only two resulting vectors afterwards . using the results of the previous subsections we determine the total action of all the one - body terms on an initial state vector @xmath45 as : [ h - psi_one - body ] h | > & = & _ k , q h_kq = _ k , q h_kq |^kq>=^n__jc^h_j|j ( ) > , + c^h_j&= & _ k , q h_kq c^kq_j , where every component @xmath88 of the resulting vector having address @xmath72 , is obtained as a sum of the @xmath89 numbers evaluated for every given @xmath10 and @xmath66 according to eq .",
    "( [ one - body_oper ] ) .",
    "analogously , we group the contribution from all the two - body terms : [ h - psi_two - body ] w | > & = & _ k , s , q , l w_ksql = _ k , s , q , l w_ksql    c^w_j&=&_k , s , q , l w_ksql c^kslq_j , where @xmath90 are computed using eq .",
    "( [ two - body_oper ] ) for every given quartet @xmath83 of the summation indices .",
    "finally , the desired result @xmath59 is obtained as a sum of the two computed above vectors eqs .",
    "( [ h - psi_one - body ] ) and ( [ h - psi_two - body ] ) : [ hpsi ] h | & = & h |>+w    c^h_j&=&c^h_j + c^w_j , and the respective expectation value of the hamiltonian is given as a dot product : [ psihpsi ] ] + ] = ^n__jc^*_j ( c^h_j+c^w_j ) .",
    "these closed form results can be considered as a formal proof that one can operate with state vectors without construction of the corresponding hamiltonian matrix .",
    "it also justifies the used representation of eq .",
    "( [ mctdhb_ci ] ) .",
    "now , instead of the standard matrix representation of the time-(in)dependent schrdinger equations we can rewrite them in terms of the enumerated configurations , i.e. , in a formally `` vectorized '' form : [ newform ] i & = & c^h_j ,  j , + c^h_j & = & e c_j ,  j , where every @xmath91 element is computed according to eq .",
    "( [ hpsi ] ) as a sum of the respective one- ( [ one - body_oper],[h - psi_one - body ] ) and two - body ( [ two - body_oper],[h - psi_two - body ] ) contributions .",
    "let us conclude .",
    "we implement in the mctdhb(@xmath2 ) method the ideas proposed in ref .",
    "@xcite allowing to determine the result of the action of the hamiltonian written in second quantized form on a state vector without building up the respective hamiltonian matrix .",
    "the implemented computational scheme has several advantages comparing to the standard one .",
    "first of all it does not require the ( re)evaluation of the hamiltonian matrix elements in the given many - body basis set at each time step .",
    "consequently , there is no need to construct , store and address the hamiltonian matrix or its elements at all .",
    "second , the elements of the reduced one- and two - body matrices , needed by the mctdhb(@xmath2 ) method are immediately available as scalar products of the incoming and resulting state vectors , obtained by acting the respective combination of creation and annihilation operators .",
    "third , the proposed ideas can be easily extended to three - body and higher - order interactions potentials .",
    "last but not least , the proposed ideas are implemented using very effective parallelization schemes , which are of high demands in modern computational physics .",
    "condensation is one of the key physical phenomena taking place in quantum many - boson systems @xcite . to characterize a many - boson quantum state one constructs and diagonalizes the reduced one - body density matrix ,",
    "( [ no ] ) .",
    "according to penrose and onsager ref .",
    "@xcite the bosonic state is condensed if only one natural orbital has macroscopic occupation . on the other hand ,",
    "when several natural orbitals are macroscopically occupied the system becomes several - fold fragmented @xcite .",
    "fragmentation usually takes place in repulsive condensates due to multi - well structure of the external potentials trapping bosonic clouds .",
    "increasing , for example , the height of the barrier separating two wells of the double - well trap one can change the ground state property of a weakly - interacting repulsive many - boson system from almost pure condensed to fully twofold fragmented refs .",
    "analogously , ground state properties of repulsive bosons in optical lattices depend on the intensity of the laser light forming the lattice .",
    "the ground state of weakly interacting bosons in shallow optical lattices is superfluid , i.e. , condensed  @xcite . increasing the intensity of the optical potential ,",
    "i.e. , its depth , one can drive the system from the superfluid state to a completely different , so called mott insulating state  @xcite . considering an optical lattice as an extreme case of a multi - well trap , one can associate the fragmented states in multi - well systems with mott insulating states in optical lattices .",
    "of course , occupations of the fragments in fragmented states of multi - well systems are macroscopic , while in optical lattices the mott insulating states are usually characterized by population of a few bosons per site .    for trap potentials manipulated in time , the quantum dynamics starts to play a very crucial role .",
    "for example , when a repulsive bosonic cloud is split by ramping - up a potential barrier the final state reveals long - lived oscillatory dynamics between condensed and twofold fragmented states  @xcite .",
    "similarly , when the intensity of the optical lattice is driven non - adiabatically , one observes dynamical oscillations between superfluid and mott insulating states  @xcite .",
    "these oscillations are damped . in the numerical examples of the present section we consider many - boson systems trapped in a real - space one - dimensional triple - well potential and",
    "study their evolutions by manipulating the shape of the trap , and varying the number of bosons and their interaction strength . compared to numerous theoretical and experimental studies of bosonic systems trapped in double - well traps ,",
    "studies of bosonic systems in triple - wells are quite scarce .",
    "however , they can provide a deeper insight into the physics of the additional interactions appearing between neighboring wells due to the presence of the third one .",
    "this makes one step forward to more detailed understandings of the dynamical oscillations between superfluid and mott insulating states taking place in optical lattices .    in this work we use dimensionless units . to translate the time - dependent many - boson schrdinger equation eq .",
    "( [ mbse ] ) to dimensionless units we divide the hamiltonian by the energy unit @xmath92 , where @xmath93 is the mass of a boson and @xmath94 is a typical length scale of the system .",
    "the dimensionless one - body hamiltonian then reads @xmath95 .",
    "the bosons interact via the popular short - range contact repulsive potential @xmath96 of strength @xmath97 , see refs .",
    "@xcite and references therein .",
    "let us consider systems made of @xmath0 , 51 and 3003 repulsive bosons confined in a periodic triple - well potential .",
    "we use periodic boundary conditions to ensure that all three wells are equivalent . for weakly interacting bosons and sufficiently large barrier heights",
    "one expects that the ground state of the system becomes fully threefold fragmented , i.e. , according to the standard definition @xcite three natural orbitals in eq .",
    "( [ no ] ) acquire macroscopic occupations . from a perspective of optical lattice physics such a state",
    "can be associated with a perfect mott insulating state having occupation of @xmath98 bosons per site .",
    "we use these fully threefold fragmented states in our dynamical studies as initial wave packets for propagation . at the beginning of the propagation",
    "the optical potential has been suddenly shifted and ramped down to some final value @xmath99 .",
    "we summarize all the trap manipulations as follows : [ trap ] v(x , t)=v ( x/2+)^2 , x [ -3,3 ) \\ {    t<0 , v&=&v_0 , = 0 + t0 , v&=&v_final , = /4    .. here , @xmath100 is the barrier height of the initial trap where fully treefold fragmented states have been prepeared at @xmath101 .",
    "@xmath102 is the barrier height of the final trap where we study the dynamics for @xmath103 , and @xmath104 is the shift applied to this final potential .",
    "we propagate the time - dependent schrdinger equation for different numbers @xmath3 of bosons in real space within framework of the mctdhb(@xmath2 ) method , as described in the previous section [ secii ] .",
    "the interparticle interaction is chosen to be @xmath105 . in this case",
    "the systems made of different numbers @xmath3 of bosons become equivalent in the sense that the fraction of interparticle interaction energy , also associated with the total non - linearity strength @xmath106 , remains the same for every system .",
    "consequently , the total energies per particle in these systems are expected to be very close to each other .",
    "that allows us to compare their evolutions . in fig .",
    "[ fig.0 ] we schematically depict the initial and final  shifted trap potentials as well as the initial many - body density .",
    "the topology of the used triple - well trap implies triple degeneracy of the respective one - particle energy levels @xmath107 of @xmath108 , i.e. , @xmath109 , @xmath110 , etc . again , using the analogy between optical lattices and multi - well potentials we can associate each of these triples of quasi - degenerate levels with a band .",
    "the split between the levels forming a band is smaller for deeper bands . in fig .",
    "[ fig.0 ] we show the lowest - energy levels of each band .",
    "the energy per particle @xmath111 of the evolving systems is also depicted by a red solid bold line . generally speaking for different @xmath3 these energies",
    "are slightly different , see table .",
    "[ tab.1 ] , but at the plotted scale these differences are indistinguishable .",
    "it is important to stress that here we study the dynamics of the interacting bosonic systems in the periodic triple - well potential where at least six bands are available , see fig .",
    "[ fig.0 ] .",
    "the shift @xmath104 applied to the final potential means that every initial wave packet is pushed far away from equilibrium . due to this shift",
    "a lot of energy has been pumped into the system , such that the energy per particle of the initial wave packet is located around the fourth band .",
    "hence , the system is in a non - equilibrium highly excited state .",
    "after the sudden shift the total energy of the system is conserved because during the wave packet propagation the final trap potential remains unchanged and the respective hamiltonian is time - independent and hermitian .",
    "we first study the dynamics of the system made of @xmath0 bosons .",
    "the ground state of such a system becomes fully threefold fragmented already at the barrier height @xmath112 .",
    "however , to be able to relate later the results to those obtained for systems made of different numbers of bosons we choose as an initial state the ground state at a much higher barrier @xmath100 . to get the initial state we propagate the mctdhb(@xmath2 ) equations eqs .",
    "( [ mctdhb_ci],[mctdhb_psi ] ) in imaginary time until the total energy is converged to the desired precision of @xmath113 .",
    "we recall that throughout this work we use dimensionless units . to simplify the differentiation and integration operations appearing in eq .",
    "( [ mctdhb_psi ] ) we use a discrete variable representation ( dvr ) , see ref .",
    "@xcite , for the self - consistent time - adaptive orbitals .",
    "more specifically , each time - dependent orbital is represented in an exponential dvr grid with @xmath114 or @xmath115 points .",
    "so , in the present computations the linear combination of the @xmath116 primitive exponential functions define the shape of each orbital at every point in time .",
    "the quality of the used dvr grid can be seen in fig .",
    "[ fig.0 ] where the density of the initial state is plotted as a dotted line : every depicted point corresponds to the actual dvr point in coordinate space ( @xmath114 ) .",
    "we computed the ground state many - boson wave function at different levels of the mctdhb(@xmath2 ) theory , namely with @xmath1 , 6 , 9 and 12 self - consistent time - adaptive orbitals .",
    "the obtained ground state energies per particle @xmath117 of the initial fully threefold fragmented states are presented in table .",
    "[ tab.1 ] . from this table",
    "we clearly see that the ground state energy is converged with increasing size @xmath25 of the configurational subspace , i.e. , with increasing level @xmath2 of the mctdhb(@xmath2 ) theory .",
    "now , it is worthwhile to clarify the role of self - consistency in the mctdhb method . according to eq .",
    "( [ nconf ] ) , for @xmath0 bosons and three ( @xmath1 ) self - consistent orbitals the total number of configurations used to describe the many - boson wave function eq .",
    "( [ j_psi ] ) is @xmath118 .",
    "however , since in the numerical computations each orbital is represented as a sum of @xmath116 exponential dvr functions we can formally expand these sums and compute the total size of the fock subspace spanned by these _ fixed _ primitive dvr functions .",
    "for example , for @xmath114 exponential functions used in the present computation the formal dimension of the respective fock space is huge ",
    "@xmath119 , i.e. , it is larger than @xmath120 ! clearly , this is beyond reach and one can not carry out even approximately converged computations using the standard method of fixed orbitals .",
    "the mathematical role of the self - consistent orbitals in mctdhb is to contract the fixed primitive dvr basis functions ( exponential functions in the present example ) , according to the variational principle , and to project , thereby , the huge configurational subspace to the optimal and compact one . from a physical point of view",
    "this means that every excitation constructed using self - consistent orbitals actually utilizes a huge number of the primitive excitations built on the fixed dvr functions . as we see from table .",
    "[ tab.1 ] even a modest number of the self - consistent orbitals can provide a very accurate description of the quantum system .    from table .",
    "[ tab.1 ] we see that the ground state energy obtained at the three - orbital level of the mctdhb(@xmath1 ) theory is very close to those computed using @xmath121 , 9 , 12 self - consistent orbitals .",
    "we analyze the properties of the respective solutions by constructing and diagonalizing the reduced one body density [ see eq .",
    "( [ no ] ) ] and find that , indeed , only three natural orbitals are macroscopically occupied : @xmath122 .",
    "we conclude that a physically correct description of the ground state is obtained already at the mctdhb(@xmath1 ) level",
    ". further increase of the hilbert subspace does not lead to significant changes , but costs , of course , considerable computational efforts ( see @xmath25 in table .  [ tab.1 ] ) .",
    "the ground state density obtained for @xmath123 is depicted in fig .",
    "[ fig.0 ] .",
    "the ground state density profiles , obtained using @xmath1 , 6 , 9 self - consistent orbitals can not be distinguished from this one and , therefore , are not shown .    .",
    "the energies of the ground and evolving states , and the number of configurations @xmath25 obtained at different levels @xmath2 of mctdhb(@xmath2 ) theory , i.e. , by using different numbers @xmath2 of self - consistent time - adaptive orbitals .",
    "results are shown for systems made of @xmath0 , 51 and 3003 bosons . [ cols=\"<,^,^,<,<\",options=\"header \" , ]     we now turn to the propagation of the initial many - boson wave functions obtained above .",
    "let us first define the natural time - scale of the problem .",
    "the energy difference between the second and first bands of the periodic potential @xmath124 is @xmath125 , where @xmath126 and @xmath127 are the respective lowest - energy levels forming the first and second bands .",
    "this energy difference relates to oscillations of the density in each well ( on each site ) and can be used to define the time - scale of the problem @xmath128 .",
    "we present here the results of the propagation until @xmath129 which approximately corresponds to @xmath130 periods of oscillations of the one - site densities .    having obtained the initial - state wave function , i.e. , respective expansion coefficients and one - particle functions ( orbitals ) , we use them as initial conditions for integration of the mctdhb(@xmath2 ) equations ( [ mctdhb_ci ] ) and ( [ mctdhb_psi ] ) with @xmath1 , 6 , 9 , 12 orbital sets .",
    "we construct and diagonalize the reduced one - body density eq .",
    "( [ no ] ) at each integration time for every set of the orbitals .",
    "the diagonal parts of the reduced one - body densities obtained for a short @xmath131 , intermediate @xmath132 and long @xmath133 propagation times are depicted in the bottom , middle and upper panels of fig .",
    "[ fig.i_a ] respectively .",
    "it is clearly seen that the densities obtained at the mctdhb(@xmath1 ) level have only marginal deviations from the @xmath121 , 9 , 12 ones at all the presented times .",
    "so , the first conclusion is that three time - dependent ( self - consistent ) orbitals provide the physically correct description of the density of the evolving many - boson wave packets for quite long propagation times . the convergence with @xmath2 is clearly seen in fig .  [ fig.i_a ] .",
    "now , we compare more involved properties of the many - body wave functions",
    ". the most important characteristics of bosonic systems are the degrees of condensation and fragmentation .",
    "these quantities correspond to the values of the natural occupation numbers , computed according to eq .",
    "( [ no ] ) . in fig .",
    "[ fig.i_b ] we collect the evolutions of the occupation numbers as functions of propagation time computed at different levels @xmath2 of the mctdhb(@xmath2 ) theory , i.e. , within different numbers of the time - adaptive orbitals used .",
    "the upper left panel depicts evolutions of the twelve natural occupation numbers obtained at the @xmath123 level of computation  the best converged variational results which we use as a reference .",
    "we recall first that at @xmath134 the initial state is fully threefold fragmented or using the terminology of optical - lattice physics it is a pure mott insulating state with @xmath135 atoms per site .",
    "second , the evolution takes place in real space and the shapes of the wave packets are drastically changing in time , thereby demonstrating the importance of time - dependent orbitals .",
    "third , the applied shift of the trap potential results in considerable pumping of energy into the system  compare the energies listed in table .",
    "[ tab.1 ] for the initial ground @xmath136 ( @xmath101 ) and evolving @xmath137 ( @xmath138 ) wave packets .",
    "the evolving wave packets are located energetically between the fourth and fifth bands as schematically depicted in fig .",
    "[ fig.0 ] . nevertheless , despite such a highly non - equilibrium problem",
    ", we see that only three natural orbitals and the respective occupation numbers provide dominant contributions to the physics of the evolving wave packets , up to rather long propagation times . in other words ,",
    "three time - adaptive orbitals are capable to describe the many - boson quantum dynamics of the system .",
    "the evolutions of the three largest occupation numbers computed at different levels @xmath2 of the mctdhb(@xmath2 ) theory , are compared in the three other panels of fig .",
    "[ fig.i_b ] : @xmath17  in the right upper , @xmath18  in the left bottom , and @xmath139  in the right bottom panel .",
    "the plotted curves corresponding to the evolutions of @xmath140 and @xmath139 are not smooth because the natural occupation numbers obtained by numerical diagonalizing the density matrix eq .",
    "( [ no ] ) are sorted according to their values .",
    "therefore , instead of nicely separated crossing curves we see their connected parts . in fig .",
    "[ fig.i_b ] one can see that until @xmath141 all the mctdhb(@xmath2 ) curves for @xmath1 , 6 , 9 , 12 are indistinguishable on the resolution of the scale shown .",
    "in other words , for this time interval which is about @xmath142 on - site oscillations @xmath143 the three orbital ansatz provides essentially exact description of the many - body dynamics .    another interesting feature observed from figure fig .",
    "[ fig.i_b ] is that until @xmath144 the evolving system stays in a quite pure insulating state @xmath145 , despite the fact that the on - site densities undergo drastic changes  they are split onto three big humps separated by very deep dips , see lower panel of fig .",
    "[ fig.i_a ] . with time",
    "the many - body dynamics destroys the perfect threefold fragmentation of the initial state . during the propagation two of the three natural orbitals with largest occupancies are evolving in time in a very similar manner forming a pair , while the third orbital is split off and demonstrates a quite different behavior ,",
    "see upper left panel of fig .",
    "[ fig.i_b ] .",
    "we might associate these evolutions with the structure of the one - particle states of the triple - well trap used .",
    "we recall that each band of the triple - well periodic potential eq .",
    "( [ trap ] ) is formed by three discrete eigenstates . in the lowest bands",
    "all of them are almost degenerate , in the higher ones two of the three one - particle eigenstates are degenerate while the third one is split off .",
    "we thus conclude that the topology of the external trap might be responsible for the observed behavior of the natural occupation numbers of the evolving many - body wave packets .",
    "the structure of the evolving natural occupation numbers presented in fig .  [ fig.i_b ] has a very complicated character .",
    "we can consider two main scales : the general leading trend ",
    "gradual long - time oscillation with a period of @xmath146 , and small modulating short - time oscillations on top of it . comparing , first",
    ", these small modulating oscillations for different @xmath2 we conclude that they are nicely reproduced at all the presented levels of the mctdhb(@xmath2 ) computations , starting already at @xmath1 .",
    "the long - scale dynamics might be viewed as a damped oscillations around perfect threefold fragmented state .",
    "these oscillations may be attributed to periodic attempts to develop coherence in the system .",
    "alternatively , using optical - lattice terminology one may say that this behavior mimics the oscillations between mott insulating and superfluid states . till @xmath141 all",
    "the results practically coincide  one can not see the deviations at the presented scales of fig .  [ fig.i_b ] . for @xmath147",
    "the discrepancy in the long time behavior between @xmath1 and @xmath121 , 9 , 12 computations starts to develop , remaining nevertheless quite modest .",
    "this , again , indicates that the essential part of the evolution is nicely described at the mctdhb(@xmath1 ) level .",
    "let us now analyze the physical origin of the observed imperfection ( discrepancy ) in the long time behavior between the @xmath1 and @xmath121 , 9 , 12 results for the evolving natural occupation numbers depicted in fig .  [ fig.i_b ] .",
    "we recall first that in all the presented computations the total energy of the evolving systems is preserved and , second , temperature does not enter the computations at all .",
    "the key difference between @xmath1 and @xmath148 mctdhb(@xmath2 ) computations is the number of time - adaptive orbitals available for dynamics , i.e. , the number of excited states taken into account ( see respective dimensions @xmath25 listed in table .  [ tab.1 ] ) .",
    "we can suppose that excitations to higher orbitals , not available at the mctdhb(@xmath1 ) level , are responsible for the discrepancy .",
    "on the other hand , these quantum excitations deplete the occupations of the three leading fragments and , hence , we can call this process quantum depletion . the proposed explanation can be directly verified by comparing the details of the three - orbital and @xmath148 computations . in the @xmath148 cases the depletion",
    "is naturally described by populating higher time - adaptive orbitals .",
    "indeed , the mctdhb(@xmath2 ) results using @xmath121 , 9 and 12 time - adaptive orbitals are very close to each other and show that the populations of the higher @xmath148 natural orbitals increase with time .",
    "this can be seen from the left upper panel of fig .",
    "[ fig.i_b ] where all the natural occupation numbers for @xmath123 case are plotted .",
    "now , we elaborate more on the role of depletions in the three - orbital mctdhb(@xmath1 ) description .",
    "we recall that every time - adaptive orbital is a sum of primitive dvr functions ( plane waves in this study ) .",
    "hence , an excitation involving only a few time - dependent optimized orbitals actually contracts a huge number of excitations between the primitive plane waves .",
    "so , due to this mutual self - consistency of the mctdhb method large fraction of quantum depletion is simulated by readjustments of the orbitals shapes already at the three - orbitals level .",
    "since the total number of particles and self - consistent orbitals are kept fixed , the `` depleted '' populations can only be redistributed between available self - consistent orbitals , which is reflected as changes of the natural occupation numbers . of course ,",
    "at longer propagation times contributions from higher excited states become more and more relevant and a larger number of the time - adaptive orbitals are needed to provide a more accurate description of these excitations .",
    "this explains the small differences in the densities between @xmath1 and @xmath148 cases seen in fig .",
    "[ fig.i_a ] at long propagation times ( @xmath149 ) .    in the scenario studied here the processes of quantum depletion",
    "play a very important role ",
    "they lead to a considerable damping of the long - scale oscillation around the perfect threefold fragmented state .",
    "the general conclusion is that at the mctdhb(@xmath1 ) level of description almost all key physical features of the evolution are accurately reproduced , while numerically converged results are obtained using more time - adaptive orbitals .",
    "now we discuss the second numerical example with @xmath150 repulsive bosons trapped in the same triple - well potential as before , eq .",
    "( [ trap ] ) . as an initial state",
    "we take , again , the ground state of the system at @xmath100 and @xmath105 . similarly to the @xmath0 case , the ground state becomes fully treefold fragmented @xmath151 at smaller barrier heights starting at @xmath152 .",
    "we propagate the mctdhb(@xmath2 ) equations ( [ mctdhb_ci ] ) and ( [ mctdhb_psi ] ) using @xmath1 and @xmath121 time - adaptive orbitals in imaginary time to get the ground state expansion coefficients and respective one - particle functions .",
    "the obtained ground state energies per particle are listed in table .",
    "[ tab.1 ] .",
    "first of all , we see a convergence of the ground state energy with @xmath2 .",
    "second , comparing the results for @xmath0 and @xmath150 we conclude that these systems are indeed very similar from the point of view of energy per particle .    the next step is dynamics ",
    "we ramped down the periodic potential suddenly to the depth @xmath102 of the triple - well and shift it to @xmath104 , see eq .",
    "( [ trap ] ) , and then perform the real - time propagation .",
    "we again follow the evolution of the many - boson wave function and construct and diagonalize the reduced one - body density matrix according to eq .",
    "( [ no ] ) at each point in time .",
    "the representative densities obtained at @xmath131 , @xmath132 and @xmath133 , i.e. , at the short , intermediate and long evolution times are depicted in fig .",
    "[ fig.ii_a ] .",
    "the densities computed at the @xmath1 and @xmath121 levels of the mctdhb(@xmath2 ) theory are very similar at all the propagation times , indicating that three time - adaptive mctdhb(@xmath1 ) orbitals provide an adequate description of the evolution in this case as well , as far as the density is considered .",
    "the one - particle densities obtained at the @xmath1 and @xmath121 levels are plotted in fig .",
    "[ fig.ii_a ] using red and green colors . in fig .",
    "[ fig.ii_b ] we plot the evolutions of the corresponding natural occupation numbers as functions of time using the same color scheme  red and green curves represent mctdhb(@xmath2 ) results for the @xmath1 and @xmath121 computations .",
    "the general behavior of the system with @xmath150 bosons is quite similar to that discussed above for @xmath0 . until @xmath153 the system continues to stay in a quite pure threefold fragmented state . during this time the density , however , drastically changes , see the density profile at @xmath154 depicted in the lower panel of fig .",
    "[ fig.ii_a ] .",
    "afterwards , the occupations of two of the three initially equally occupied natural orbitals are reduced .",
    "the largest occupation number reveals an opposite tendency  it borrows particles from the other two natural orbitals , increasing thereby its own natural occupation .",
    "this picture described at the @xmath1 level is confirmed by the computation with @xmath121 orbitals .",
    "thus , short and intermediate time evolutions ( @xmath155 ) are identically described at the @xmath1 and @xmath121 levels of mctdhb theory . quantum depletions ",
    "excitations from three macroscopically - populated self - consistent time - adaptive orbitals to higher ones  also become relevant for this system as time proceeds and appear as a gradual decrease of the occupations of all the three fragments .",
    "as we have already mentioned above , the considered systems of @xmath0 and @xmath150 bosons are similar because we took the same trap potentials , the `` same '' initial state and very similar interparticle energies defined by the same @xmath156 .",
    "we can compare the behavior of the depletions as a function of time for these systems by comparing the occupations of higher @xmath148 natural orbitals .",
    "these are presented in the left upper panel of fig .",
    "[ fig.i_b ] for @xmath0 and in fig .",
    "[ fig.ii_b ] for @xmath150 .",
    "we conclude that quantum depletion develops slower for the system made of a larger number of bosons .",
    "let us now discuss the last numerical example , where we consider dynamics of @xmath157 repulsive bosons with contact interaction strength @xmath105 trapped in the same triple - well potential as before . to obtain a perfect threefold fragmented , i.e. , mott insulating state with 1001 bosons per site , the optical depth of the periodic potentials has to be very large , @xmath100 .",
    "we first propagate the mctdhb(@xmath2 ) equations with @xmath1 time - adaptive orbitals in imaginary time to get the ground state solution of this system . using eq .",
    "( [ no ] ) we verify that the obtained state is indeed threefold fragmented  the respective natural occupation numbers are @xmath151 .",
    "then , we suddenly shift the potential to @xmath104 and reduce its amplitude to @xmath102 as before , see eq .",
    "( [ trap ] ) , and apply the real - time propagation scenario .",
    "the computed energies of the initial system @xmath136 as well as of the evolving wave packet @xmath137 are presented in table .",
    "[ tab.1 ] .",
    "now , we analyze the results of the real - time propagation . in fig .  [ fig.iii_a ]",
    "we plot the densities at the short @xmath131 , intermediate @xmath132 and long @xmath133 propagation times . comparing these results with the respective densities depicted in fig .",
    "[ fig.i_a ] and fig .",
    "[ fig.ii_a ] for the bosonic systems made of @xmath0 and @xmath150 particles we conclude that all three systems exhibit very similar behaviors .",
    "we apply eq .",
    "( [ no ] ) to analyze the properties of the propagating wave packet and depict in fig .  [ fig.iii_b ] the obtained evolutions of the three available natural occupation numbers using blue lines .",
    "two of the three , initially equally occupied natural orbitals start to donate the bosons , i.e. , decrease their occupancies , while the third one accepts the particles , increasing its own occupation . then , around @xmath158 , the tendency changes and the most - occupied natural orbital starts to donate bosons , transferring them back to the two other orbitals .",
    "a signature of this imperfect oscillatory behavior can be observed during all the computed propagation times depicted in fig .",
    "[ fig.iii_b ] . for comparison in this figure",
    "we also plot the natural occupation numbers obtained at the @xmath1 level of the mctdhb(@xmath2 ) theory for the systems made of @xmath0 and @xmath150 bosons with red and green colors , respectively .",
    "this allows us to analyze the @xmath3-dependence of the evolutions .",
    "the key observation is that evolutions of all the three systems are qualitatively the same .",
    "moreover , the evolutions of the systems made of @xmath150 and @xmath157 bosons are much closer to each other than to the @xmath0 ones .",
    "therefore , we might speculate that for the present studies the many - body properties are saturated to some average values already at @xmath150",
    ". hence one can expect that key aspects of the dynamics of the initially threefold fragmented systems with larger @xmath3 will be very similar to those obtained for @xmath150 .",
    "let us now summarize all three studies .",
    "we have considered systems made of @xmath0 , @xmath150 and @xmath157 particles choosing the strength of the contact interparticle interaction potential such that the non - linearity parameter @xmath106 is the same for all systems .",
    "we have solved the many - particle time - dependent schrdinger equation using the scenario of eq .",
    "( [ trap ] ) ( see also fig .",
    "[ fig.0 ] ) for all the considered systems . comparing the diagonal parts of the reduced one - particle density matrices , i.e. , the densities computed at different propagation times and depicted for @xmath0 , @xmath150 , and @xmath157 bosons in figs .",
    "[ fig.i_a ] , [ fig.ii_a ] and [ fig.iii_a ] , respectively , we observe that the presented densities look very similar at the short , intermediate and long propagation times .",
    "we also verify that the energy per particle of the considered systems are very close to each other , as one can see by comparing the data collected in table .",
    "[ tab.1 ] .",
    "hence , we can conclude that the non - linearity parameter @xmath106 is useful to characterize the global behavior of the densities in the systems made of different numbers of particles , at least for the dynamical studies of the presented type .",
    "the compared results for the time - dependent densities are quite similar , but more involved properties reveal differences . indeed , the comparison of the properties of the evolving wave packets , e.g. , evolutions of the natural occupation numbers presented in figs .",
    "[ fig.i_b ] , [ fig.ii_b ] and [ fig.iii_b ] for @xmath0 , @xmath150 , and @xmath157 , respectively , shows that global tendencies are @xmath156 dependent , while the depletions , i.e. , excitations from the three most - occupied orbitals to higher ones depend in addition on total number @xmath3 of the bosons in the system as well as on their interaction strength @xmath97 .",
    "we conclude that in the presented study the dependence of the properties on the number of particles @xmath3 explicitly appears at longer propagation times and is related to the quantum depletion which is also found to grow with time .",
    "recently , in ref .",
    "@xcite we proposed a novel , effective and general theory to construct the result of action of any many - particle operator represented in the second quantized form on a state vector , without resorting to matrix representation of operators and even to its elements . in the present work we adopt the bosonic version of this theory to the mctdhb method .",
    "we first discuss the practical realization of the proposed ideas in the mctdhb(@xmath2 ) computational scheme and address its parallel implementation in some details . using this new tool we study highly non - equilibrium dynamics of repulsive systems made of @xmath0 , 51 , 3003 particles in real - space triple - well traps . as an initial wave packet",
    "we take the fully threefold fragmented quantum state , strongly displace it out of equilibrium and then , suddenly , reduce the depth of the potential wells .",
    "from the perspective of optical - lattice physics this scenario can be seen as a propagation of the initially pure mott insulating state , strongly displaced out of the potential minima . as a result of such a sequence of trap manipulations at least four bands of the periodic trap potential",
    "become energetically open , i.e. , available for excitations .",
    "we have shown that quantum dynamics for this scenario is very complicated .",
    "first , we have demonstrated the convergence of the mctdhb(@xmath2 ) approach with @xmath1 , 6 , 9 , 12 self - consistent time - adaptive orbitals by applying the described above scenario to study long - time dynamics of @xmath0 bosons .",
    "next , we see that a quite accurate description of the evolution for short and even intermediate propagation times is obtained already at the mctdhb(@xmath1 ) level of theory",
    ". this result provides , thereby , a confirmation of an intuitive supposition that many - body dynamics in three - well traps can qualitatively and sometimes quantitatively be described by using three self - consistent time - adaptive orbitals .",
    "we stress here the last point ",
    "each used self - consistent time - adaptive orbital actually contracts very many fixed ( primitive ) functions ( @xmath114 or 555 plane waves in our work ) , and , therefore , the mctdhb many - body wave function constructed by using these few self - consistent time - adaptive orbitals spans a huge effective fock space .    as a next step",
    "we compute the dynamics for the systems made of @xmath150 and @xmath157 bosons and characterized by the same total non - linearity parameter @xmath159 . in the region of the trap / state manipulations considered here",
    ", the total non - linearity @xmath156 appears to be quite a useful parameter . because the systems made of different numbers of atoms but with the same @xmath156 demonstrate very similar dynamical behavior at least for the evolving density profiles of the initially three - fold fragmented ( mott insulating ) states .",
    "more involved properties , like natural occupation numbers are more sensitive to the individual @xmath97 and @xmath3 parameters , especially for a small number of particles and at longer propagation times .",
    "the evolutions of the natural occupation numbers show up a tendency to a long - time oscillatory behavior around the initially perfect threefold fragmented state .",
    "however , quantum depletions , i.e. , excitations to higher orbitals lead to suppression or damping of these oscillations . for the short and intermediate propagation times this process is adequately reproduced already at the mctdhb(@xmath1 ) level due to mutual self - consistency of the time - adaptive orbitals used .",
    "however , for longer propagation times more self - consistent orbitals are needed for the correct description of the depletions and many - body dynamics . at higher levels of the mctdhb(@xmath148 ) description , e.g. , within @xmath121 self - consistent orbitals , the depletions are naturally included and with @xmath160 , 12 orbitals they are accurately described .",
    "the mctdhb theory augmented by the proposed , developed and implemented ideas for effective operations in the bosonic fock space allows for a faster solution of the time - dependent many - boson schrdinger equation in larger configurational spaces and for longer propagation times .",
    "this opens new perspectives for quantitative descriptions of the quantum many - body dynamics of larger systems , as recently announced through the numerically exact studies of the one - dimensional bosonic josephson junction problem @xcite",
    ".                            j. zanghellini , m. kitzler , c. fabian , t. brabec , and a. scrinzi , laser phys .",
    "* 13 * , 1064 ( 2003 ) ; t. kato and h. kono , chem .",
    "phys . lett . *",
    "392 * , 533 ( 2004 ) ; m. nest , t. klamroth , and p. saalfrank , j. chem . phys . * 122 * , 124102 ( 2005 ) .",
    "a. i. streltsov , o. e. alon and l. s. cederbaum , j. phys .",
    "b , * 42 * , 091004 ( 2009 ) s. zllner , h .- d",
    ". meyer , and p. schmelcher , phys .",
    "a * 74 * , 053612 ( 2006 ) ; s. zllner , h .- d .",
    "meyer , and p. schmelcher , phys .",
    "a * 74 * , 063611 ( 2006 ) ; c. matthies , s. zllner , h .- d .",
    "meyer , and p. schmelcher , phys .",
    "a * 76 * , 023602 ( 2007 ) ; s. zllner , h .- d .",
    "meyer , and p. schmelcher , phys .",
    "* 100 * , 040401 ( 2008 ) ; s. zllner , h .-",
    "meyer , and p. schmelcher , phys .",
    "a * 78 * , 013621 ( 2008 ) .",
    "a. u. j.  lode , a. i. streltsov , o. e. alon , h .-",
    "meyer , and l. s. cederbaum , j. phys .",
    "b , * 42 * , 044018 ( 2009 ) .",
    "a. i. streltsov , o. e. alon , and l. s. cederbaum , _",
    "`` a novel general mapping for bosonic and fermionic operators in fock space '' _ , arxiv:0910.2577v1 .                p.  nozires and d.  saint james , j.  phys .",
    "( paris ) * 43 * , 1133 ( 1982 ) ; p.  nozires , in bose - einstein condensation , edited by a.  griffin , d.w .",
    "snoke , and s.  stringari ( cambridge university press , cambridge , england , 1996 ) .",
    "a. fisher , p. b. weichman , g. grinstein , and d. s. fisher , phys .",
    "b * 40 * , 546 ( 1989 ) ; d. jaksch , c. bruder , j. i. cirac , c. w. gardiner , and p. zoller , phys .",
    ". lett . * 81 * , 3108 ( 1998 ) ; m. greiner , o. mandel , t. esslinger , t. w. hnsch , and i. bloch , nature ( london ) * 415 * , 39 ( 2002 ) ; t. stferle , h. moritz , c. schori , m. khl , and t. esslinger , phys .",
    "lett . * 92 * , 130403 ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> to solve the many - boson schrdinger equation we utilize the multiconfigurational time - dependent hartree method for bosons ( mctdhb ) . to be able to attack larger systems and/or to propagate the solution for longer times , we implement a parallel version of the mctdhb method thereby realizing the recently proposed [ streltsov _ et al . </S>",
    "<S> _ arxiv:0910.2577v1 ] novel idea how to construct efficiently the result of the action of the hamiltonian on a bosonic state vector . </S>",
    "<S> we study the real - space dynamics of repulsive bosonic systems made of @xmath0 , 51 and 3003 bosons in triple - well periodic potentials . </S>",
    "<S> the ground state of this system is three - fold fragmented . by suddenly strongly distorting the trap potential , the system performs complex many - body quantum dynamics . at long times </S>",
    "<S> it reveals a tendency to an oscillatory behavior around a threefold fragmented state . </S>",
    "<S> these oscillations are strongly suppressed and damped by quantum depletions . in spite of the richness of the observed dynamics , the three time - adaptive orbitals of mctdhb(@xmath1 ) are capable to describe the many - boson quantum dynamics of the system for short and intermediate times . for longer times , however , more self - consistent time - adaptive orbitals are needed to correctly describe the non - equilibrium many - body physics . </S>",
    "<S> the convergence of the mctdhb(@xmath2 ) method with the number @xmath2 of self - consistent time - dependent orbitals used is demonstrated . </S>"
  ]
}