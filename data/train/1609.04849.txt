{
  "article_text": [
    "neural networks have been successfully implemented in a plethora of prediction tasks ranging from speech interpretation to facial recognition . because of ground - breaking work in optimization techniques ( such as batch normalization [ 5 ] ) and model architecture ( convolutional , deep belief , and lstm networks ) , it is now tractable to use dnn methods to effectively learn a better feature representation compared to hand - crafted methods .",
    "however , one area where such methods have not been utilized is the space of adversarial multiagent systems - specifically when the multiagent behavior comes in the form of trajectories .",
    "there are two reasons for this : i ) procuring large volumes of data where deep methods are effective is difficult to obtain , and ii ) forming an initial representation of the raw trajectories so that deep neural networks are effective is challenging . in this paper",
    ", we explore the effectiveness of deep neural networks on a large volume of basketball tracking data , which contains the @xmath0 locations of multiple agents in an adversarial domain .    to throughly explore this problem , we focus on the following task :  given the trajectories of the players and ball in the previous five seconds",
    ", can we accurately predict the likelihood that a player with role @xmath1 will make the shot ? \"",
    "we express this as a ten - class prediction problem by considering the underlying role of the player . for this paper",
    ", player role refers to the position of the player such as a point guard . since we are utilizing an image - based technique , the cnn will not know which role shoots the ball , especially if there are multiple offensive players nearby .",
    "thus , solving as a ten - class problem is ideal for our deep - learning approach .",
    "our work contains three main contributions .",
    "first , we create trajectories for the offense , ball , and defense as an eleven channel image .",
    "each channel corresponds to the five offensive and defensive players , as well as the ball . in order to encode the direction of the trajectories , we fade the paths of the ball and players . in our case ,",
    "an instance is a possession that results in an shot attempt .",
    "second , we apply a combined convolutional neural network ( cnn ) and feed forward network ( ffn ) model on an adversarial multiagent trajectory based prediction problem .",
    "third , we gain insight into the nature of shot positions and the importance of certain features in predicting whether a shot will result in a basket .",
    "our results show that it is possible to solve this problem with relative significance .",
    "the best performing model , the cnn+fnn model , obtains an error rate of 26% .",
    "in addition , it is able to accurately create heat maps by shot location for each player role . during training we found that one particular feature , whether the player received a pass just before the shot , is highly predictive .",
    "other features , which are un - surprisingly important , are the number of defenders around the shooter and location of the ball at the time of the shot .",
    "with the rise of deep neural networks , sports prediction experts have new tools for analyzing players , match - ups , and team strategy in these adversarial multiagent systems .. trajectory data was not available at the time , so much previous work on basketball data using neural networks have used statistical features such as : the number of games won and the number of points scored .",
    "for example , bauer et .",
    "al . [ 7 ] , use statistics from 620 nba games and a neural network in order to predict the winner of a game .",
    "another interested in predicting game outcomes is mccabe [ 11 ] . on the other hand , nalisnick [ 12 ] in his blog",
    "discusses predicting basketball shots based upon the type of shot ( layups versus free throws and three - point shots ) and where the ball was shot from . in other sports related papers , chang et.al . [ 4 ] use a neural network to predict winners of soccer games in the 2006 world cup . also , wickramaratna et.al .",
    "[ 16 ] predict goal events in video footage of soccer games .    although aforementioned basketball work did not have access to raw trajectory data , lucey et.al .",
    "[ 9 ] use the same dataset provided by stats llc . for some of their work involving basketball .",
    "they explore how to get an open shot in basketball using trajectory data to find that the number of times defensive players swapped roles / positions was predictive of scoring",
    ". however , they explore open versus pressured shots ( rather than shot making prediction ) , do not represent the data as an image , and do not implement neural networks for their findings .",
    "other trajectory work includes using conditional random fields to predict ball ownership from only player positions [ 18 ] , as well as predicting the next action of the ball owner via pass , shot , or dribble [ 20 ] .",
    "goldsberry et .",
    "[ 1 ] use non - negative matrix factorization to identify different types of shooters using trajectory data . because of a lack of defensive statistics in the sport , goldsberry et .",
    "create counterpoints ( defensive points ) to better quantify defensive plays [ 2][3 ] .",
    "al . [ 13 ] make use of trajectory data by segmenting a game of basketball into phases ( offense , defense , and time - outs ) to then analyze team behavior during these phases .",
    "wang and zemel [ 17 ] use trajectory data representations and recurrent neural networks ( rather than cnn s ) to predict plays . because of the nature of our problem ,",
    "predicting shot making at the time of the shot , there is not an obvious choice of labeling to use for a recurrent network .",
    "they also fade the trajectories as the players move through time .",
    "similar to us , they create images of the trajectory data of the players on the court .",
    "our images differ in that we train our network on the image of a five second play and entire possession , while their training set is based on individual frames represented as individual positions rather than full trajectories .",
    "they use the standard rgb channels , which we found is not as effective as mapping eleven channels to player roles and the ball for our proposed classification problem . also , the images they create solely concentrate on offensive players and do not include defensive positions .    the final model that we implement , the combined network , utilizes both image and other statistical features .",
    "there is work that utilizes both image and text data with a combined model .",
    "recently , bengio et .",
    "al . [ 19 ] , fei fei et . al . [ 6 ] , ng et . al . [ 14 ] , erham et . al . [ 15 ] , and mao et",
    "10 ] all explore the idea of captioning images , which requires the use of generative models for text and a model for recognizing images .",
    "however , to the best of our knowledge , we have not seen visual data that incorporates a fading an entire trajectory for use in a cnn .",
    "the dataset was collected via sportsvu by stats llc .",
    "sportsvu is a tracking system that uses 6 cameras in order to track all player locations ( including referees and the ball ) .",
    "the particular data used in this study was from the 2012 - 2013 nba season and includes thirteen teams , which have approximately forty games each .",
    "each game consists of at least four quarters , with a few containing overtime periods .",
    "the sportvu system records the positions of the players , ball , and referees 25 times per second . at each recorded frame",
    ", the data contains the game time , the absolute time , player and team anonymized identification numbers , the location of all players given as ( x , y ) coordinates , the role of the player , and some event data ( i.e. passes , shots made / missed , etc . ) .",
    "it also contains referee positions , which are unimportant for this study , and the three - dimensional ball location .",
    "this dataset is very unique in that before sportvu , there was very little data available of player movements on the court and none known that provides frame - by - frame player locations . since it is likely that most events in basketball can be determined by the movements of the players and the ball , having the trajectory data along with the event data should provide a powerful mixture of data types for prediction tasks .",
    "there are a few ways to extract typical shot plays from the raw data .",
    "one is to choose a flat amount of time for a shooting possession . in our case",
    "we choose to include five seconds of a typical possession . to obtain clean plays , those that lasted less than 5 seconds due to possession changes and",
    "those in which multiple shots were taken were thrown out . after throwing out these cases ,",
    "we were left with 70,000 five second plays .",
    "the other way of obtaining play data would be to take the entire possession .",
    "thus , rather than having plays be limited to five seconds , possessions can be much longer or shorter . since the raw data does not contain labels for possession , we had to do this ourselves . to identify possession ,",
    "we calculate the distance between the ball and each of the players .",
    "the player closest to the ball would be deemed the ball possessor .",
    "since this approach may break during passes and other events during a game , we end the play of the possession when the ball is closer to the defensive team for 12 frames ( roughly 0.5 seconds ) .",
    "the procedure yields 72,200 possession examples .",
    "since the classification problem is also dependent upon a player s role , a player s role must be chosen for each play .",
    "one way to do this would be to identify the role of a player at the beginning of the play and hold it constant .",
    "however , a player s role at the beginning of the play is usually not the same as a player s role at the time of the shot .",
    "therefore , we decide to label a player s role via their position at end of the play in which the ball is shot .",
    "in terms of applying deep neural networks to multiagent trajectories , we first have to form an initial representation .",
    "a natural choice for representing these trajectories is in the form of an image . given that the basketball court is @xmath2x@xmath3 feet , we can form a @xmath2x@xmath3 pixel image . in terms of the type of image we use , there are multiple choices : i ) grayscale ( where we identify that a player was a specific location by making that pixel location 1 ) , ii ) rgb ( we can represent the home team trajectories in the red channel , the away team in the blue channel and the ball in the green channel , and the occurrence of a player / ball at that pixel location can be representing by a 1 ) , and iii ) 11-channel image ( where each agent has their own separate channel ) .",
    "examples of the grayscale and rgb approach are shown in figure 1 .",
    "the 11-channel approach requires some type of alignment . in this paper",
    ", we apply the ` role - representation ' which was first deployed by lucey et al . [",
    "the intuition behind this approach is that for each trajectory , the role of that player is known ( i.e. , point - guard , shooting guard , center , power - forward , small - forward ) .",
    "this is found by aligning to a pre - defined template which is learnt in the training phase .",
    "figure 1 shows examples of the methods we use to represent our data for our cnn . the grayscale image , which appears on the left , can accurately depict the various trajectories in our system",
    "however , because the image is grayscale , the cnn will treat each trajectory the same .",
    "since we have an adversarial multiagent system in which defensive and offensive behavior in trajectory data can lead to different conclusions , grayscale is not the best option for representation .",
    "therefore , to increase the distinction between our agents , we represent the trajectories with an rgb scale .",
    "we choose red to be offense , blue to be defense , and green to be the ball .",
    "this approach takes advantage of multiple channels to allow the model to better distinguish our adversarial agents .",
    "although the ball may be part of the offensive agent structure , we decide to place the ball in a channel by itself since the ball is the most important agent .",
    "this approach , although better than the gray images , lacks in distinguishing player roles . since we classify our made and missed shots along with the role of the player that shoots the ball , a cnn will have trouble distinguishing the different roles on the court .",
    "therefore , for our final representation , we decide to separate all agents into their own channel so that each role is properly distinguished by their own channel .",
    "the above ideas nearly creates ideal images ; however , it does not include time during a play .",
    "since each trajectory is equal brightness from beginning to end , it may be difficult to identify where the ball was shot from and player locations at the end of the play .",
    "therefore , we implement a fading variable at each time frame . we subtract a parameterized amount from each channel of the image to create a faded image as seen in figures 1 and 2 .",
    "thus , it becomes trivial to distinguish the end of the possession from the beginning and leads to better model performance .",
    "we create two options with our final faded image data : five seconds before the ball was shot and the total possession .",
    "five seconds likely performs better since full possession data contains more temporal information than cnn s can handle . in longer possessions , trajectories tend to cross more , which confuses the cnn model by adversely affecting the fading since new trajectories will be higher in value .",
    "in order to fully utilize the power of this dataset , we implement a variety of networks for our prediction task . for our base model",
    ", we use logistic regression with 197 hand - crafted features detailed later . to improve upon this basic model",
    ", we use a multi - layer ffn with the same features and utilize batch normalization during training .",
    "because of the nature of these two models , we could only include the positions of the players at the time of the shot .",
    "therefore , we craft images to include the position of the players throughout the possession",
    ". we then apply a cnn to these new image features .",
    "finally , we create a combined model that adopts both images and the original ffn features for training .",
    "for the first models , features with the knowledge of the game in mind were crafted .",
    "the list of features includes :    * player and ball positions at the time of the shot * game time and quarter time left * player speeds over either five seconds or an entire possession * distances and angles ( with respect to the hoop ) between players * whether the shooting player received a pass two seconds or less before the shot * number of defenders in front of the shooter ( @xmath4 of the shooter ) and within six feed based upon the angles calculated between players * individual time of ball possession for each offensive player    logistic regression and fnn both use the same calculated features .",
    "in addition , only the cnn does not incorporate the above features .      for our model",
    ", we use a cnn that consists of three full convolutional layers , each with 32 3x3 filters and a max - pooling layer with a pool - size of 2x2 following each convolutional layer .",
    "after the last pooling layer there is a fully connected layer with 400 neurons , and finally an output layer consisting of a softmax function and ten neurons .",
    "in addition , we use the relu function for our nonlinearity at each convolutional layer and the fully connected layer .",
    "we also implement alexnet and vgg-16 , but we did not garner significant improvement from either model .      the final network implemented is a combination of both the feed forward and convolutional networks . for this model , we use both the feed forward features and the fading trajectory images from the cnn . the idea behind the combined network is to have the model identify trajectory patterns in the images along with statistics that are known to be important for a typical basketball game .",
    "the cnn and ffn parts of the combined network have the exact same architecture as the stand - alone versions of each model .",
    "the final layers just before the softmax layer of each stand - alone network are then fully - connected to a feed - forward layer that consists of 1,000 neurons .",
    "this layer is then fed into the final softmax layer to give predictions . after performing experiments and measuring log loss , we found that adding layers to this final network or adding additional neurons to this layer did not improve our final results .",
    "all of the models ( fnn , cnn , and fnn + cnn ) use the typical log loss function as the cost function with a softmax function at the output layer .",
    "the weights are initialized with a general rule of @xmath5 where @xmath6 is the number of incoming units into the layer . for training",
    ", we implement the batch stochastic gradient method utilizing batch normalization .",
    "batch normalization is used on the convolutional and feed forward layers of the model . in addition , we train the models on a nvidia titan x using theano .    for the cnn and cnn+fnn networks",
    "we utilize our eleven channel images with fading . to justify our representation",
    ", we predict our classification problem with each crafted image set with the previously mentioned cnn architecture .",
    "figure 3 displays the log loss and error rate for each of our representations .",
    "evaluating our representations by log loss and error rate show a dramatic difference between our images .",
    "the eleven channel method is understandably the best choice since having eleven channels gives the cnn much more role information .",
    "figure 4 gives a summary of the results of the three different models .",
    "it is intriguing how poorly the convolutional neural network captures the adversarial multiagent properties without the addition of the hand - crafted features used in the ffn .",
    "theoretically , the image data contains all pertinent information related to the play .",
    "therefore , in our problem , hand - crafted features clearly remain essential for successful prediction .",
    "since the combined model surpasses the performance of either model separated , we presume that the networks find different features during training .",
    "while the performance of the eleven channel images is an improvement ( a 10% gain ) , there is still much potential progress .",
    "other methods include making each trajectory a different color in rgb space , varying the strength of the fading effect , and including extra channels of heat maps depicting the final ball position .",
    "therefore , successfully representing trajectory data in sport that outperforms traditional metrics is a nontrivial problem and is not further explored here .",
    "the remaining analyses are based on the combined model .",
    "in addition to assessing the accuracy of our model , we explore a basic heat map of basketball shots based upon the raw data . at the very least",
    ", we expect that our complete model should be able to recreate a heat map created via raw data .",
    "we make the heat map by taking a count of shots made against missed within a square foot of the basketball court . since our classification model gives probabilities of making a shot ( rather than a binary variable ) , we take the maximum probability to create a heat map equivalent to the raw data map .            in the raw data heat map ,",
    "figure 6 , we note that the best probability of making a shot lies on top of the basket .",
    "as we get farther back , the probability decreases with two dead zones ( lines of dark blue signifying very low probability ) : one right outside the paint and another just inside the three point line .",
    "the model results , figure 5 , expectedly prefers shots near the basket .",
    "the model also predicts a larger high value area surrounding the basket , which extends further into the paint of the court .",
    "the model dead - zones are less arc - like as well .",
    "there is a single dark - blue arc around the paint / basket , but the model predicts more pocket like behavior for missed shots than the raw data heat map .    to further explore our results ,",
    "we create heat maps solely based on the role of the player ( to break down scoring chances by agent ) .",
    "as before , each role represents an offensive player . in figure 7",
    "we present a few player roles and their representative heat maps .",
    "role 3 is obviously the center position from their respective shot selection and role 5 is the left guard .",
    "note that the model predicts a much smaller area of midrange scoring probability than from the raw data for role 3 .",
    "the model heat map for role 3 strictly covers the paint , while the raw data has significantly higher shot probabilities outside of the paint .",
    "role 5 , which depicts a guard has very similar heat maps for both the raw and model predictions .",
    "the only notable differences are the larger hot area at the basket and the pocket of low probability shots just outside the paint detailed in the model heat map .",
    "the probabilities that the combined model predicts for each shot may also provide useful insight into the game and our model s interpretation of high versus low value shots .",
    "we create these histograms by finding which examples the model gives the highest probability as a shot made or missed by player with role @xmath7 .",
    "we then group these examples together , and the probability of making a shot is reported in the histogram . in the histogram figure 8",
    "we see that the majority of shots have a low probability .",
    "this agrees with common basketball knowledge because many of a guard s shots are beyond the paint .",
    "on the other hand , a center lives primarily under the basket and in the paint .",
    "therefore , many of their shots are much more likely . watching a game live , a center getting a clean pass right under the basket",
    "often results in a successful goal .",
    "in addition , most roles tend to follow the probability pattern of role 5 with the exception of role 3 ( the center ) , which has a wider distribution and higher average probability of making a shot .",
    "a brief glance at nba statistics agrees with this interpretation as the players with the highest shooting percentage ( barring free throws ) tend to be centers .                    the large number of low probability shots is not limited to the combined model .",
    "the ffn has many low probability shots while the cnn does not .",
    "we probe this phenomena by leaving single features out of the ffn to find the ones responsible for causing low probability shots .",
    "we found that one feature in particular , pass - received , is the root cause .",
    "this feature detects whether the shooter received a pass two seconds before the shot was taken .",
    "we found that when a pass was received by the shooter during the two seconds before the shot the likelihood of missing the shot is much higher .",
    "in fact , when a player received a pass , 94% of the shots are missed .",
    "although counter - intuitive at first , two seconds is a small window to shoot . since two seconds",
    "is the maximum time for this particular feature , many of the shooters may have shot immediately after the pass .",
    "therefore , many of these shots are hurried explaining why a majority of them are missed .",
    "this one feature led to a nearly 10% decrease in the error rate .",
    "we also exhibit figure 9 to provide additional visual context for our model probabilities .",
    "these figures depict the final positions of all players on the court at the time of the shot .",
    "thus we can see how `` open '' the shot maker is at the time of the shot and the relative position of both the offensive and defensive players .",
    "the offensive players are blue , defensive players red , and the ball is green .",
    "each offensive and defensive player has the letter `` o '' and `` d '' respectively followed by a number signifying the role of that player at that time .",
    "there are some times where the model makes some pretty questionable predictions .",
    "for example , the three - point shot that is exhibited in the top left of figure 9 with a 0.892 probability is much too high .",
    "even unguarded the best three - point shooters in the game can not hit 89.2% .",
    "thankfully , these examples are very rare in our model . for the most part ,",
    "three - point shots are rated extremely low by the model garnering probabilities of less than 20% .",
    "in addition to three - point shots to having a generally low probability , shots that were well - covered by defenders had a much lower probability of success .",
    "this is an unsurprising well - known result , but it does add validity to our model .",
    "in addition , shots that are open and close to the basket are heavily favored in our model .",
    "for example , in the right pictures , both players have open shots right under the basket with the defense well out of position .    since our combined model predicts shots with more accuracy , we are curious to find the features that deep learning with a cnn observes with raw trajectory data .",
    "our images contain both more temporal and spatial data since we fade images and do not include all multiagent interactions ( since it is difficult to label all inter - player events ) .",
    "to investigate our raw trajectory approach , we use a simple gradient ascent method to create an image that most strongly reacts to the filters in our network .",
    "for example , in a problem that contains cats and dogs , some filters may be looking for long whiskers to help identify a cat .",
    "in addition , these filters help determine whether the network has been well - trained .",
    "networks having filters with little to no interpretation or appear random are usually poorly trained .",
    "figure 10 shows a few representative images that we craft with the gradient ascent method .                    in the first image of figure 10 from the left",
    ", we see that the model is searching for defensive positioning ( light blue ) and the ball ( green ) .",
    "there are clusters of these positions , which shows that the model is searching for the role that shoots the ball via ball positioning and the number of defensive players near the ball . on the other hand ,",
    "the filter on the far right only depicts ball locations and does not include defensive positioning .",
    "the second figure from the left is actually very similar to the far right filter ; however , it includes much more than simple ball information .",
    "this filter is specifically looking for ball location as well as offensive / defensive player locations near the ball .",
    "thus , the cnn model is likely more effective in capturing defensive structure and paths for shot prediction , which is difficult to construct by hand .",
    "for further research , it would be very interesting to identify time dependency in basketball plays . in our image data ,",
    "we subtract a flat amount at each equally spaced frame to cause the fading effect .",
    "however , this assumes that the data in time is linearly related .",
    "since this is not necessarily true , designing a recurrent model to find this temporal dependency could be a very interesting problem . instead of having a fading effect in the image data",
    ", we can design an lstm that takes a moving window of player and ball trajectories .",
    "one last aspect that was not taken into account during this study was the identities of teams and particular players .",
    "the focus of this research was to gather more insight on the average shooting plays of teams in the nba .",
    "however , teams in the nba have drastically different strategies .",
    "for example , the golden state warriors tend to rely on a three - point strategy while bigger teams , such the thunder , build their offensive strategy around being inside the paint .",
    "thus , new knowledge on basketball could be gathered if models were applied to different teams and possibly identify some overall team strategies .",
    "such a more fine - grained analysis will require much more data .",
    "[ 1 ] a. miller , l. bornn , r. adams , and k. goldsberry . ( 2014 ) `` factorized point process intensities : a spatial analysis of professional basketball . ''",
    "_ international conference on machine learning_.        [ 4 ] k.y .",
    "huang and w.l .",
    "( 2010 ) `` a neural network method for prediction of 2006 world cup football game . '' _ the 2010 international joint conference on .",
    "institute of electrical and electronics engineers . _ 74 [ 5 ] s. ioffe and c. szegedy .",
    "( 2015 ) `` batch normalization : accelerating deep network training by reducing internal covariate shift . '' _ international conference on machine learning_.        [ 8 ] p. lucey , a. bialkowski , p. carr , s. morgan , i. matthews and y. sheikh .  `` representing and discovering adversarial team behaviors using player roles . '' in _ ieee international conference on computer vision and pattern recognition . _    [ 9 ] p. lucey ,  a. bialkowski ,  p. carr ,  y. yue and i. matthews .",
    "( 2014 ) `` how to get an open shot : analyzing team movement in basketball using tracking data . '' in _ mit",
    "sloan sports analytics conference_.            [ 14 ] r. socher , a. karpathy , q. le , c. manning , a. ng .",
    "( 2014 ) `` grounded compositional semantics for finding and describing images with sentences . '' _ transactions of the association for computational linguistics 2 : 207 - 218 . _          [ 18 ] x. wei ,  l. sha ,  p. lucey ,  p. carr ,  s. sridharan and i. matthews .",
    "( 2015 ) `` predicting ball ownership in basketball from a monocular view using only player trajectories . ''",
    "_ knowledge discover and data mining workshop on large - scale sports analytics _ ,",
    "sidney , australia .",
    "[ 19 ] k. xu , j. lei ba , r. kiros , k. cho , a. courville , r. salakhutdinov , r. zemel , and y. bengio .",
    "`` show , attend and tell : neural image caption generation with visual attention . ''",
    "_ international conference on machine learning ( icml-15 ) ."
  ],
  "abstract_text": [
    "<S> in this paper , we predict the likelihood of a player making a shot in basketball from multiagent trajectories . </S>",
    "<S> previous approaches to similar problems center on hand - crafting features to capture domain specific knowledge . </S>",
    "<S> although intuitive , recent work in deep learning has shown this approach is prone to missing important predictive features . to circumvent this issue </S>",
    "<S> , we present a convolutional neural network ( cnn ) approach where we initially represent the multiagent behavior as an image . to encode the adversarial nature of basketball </S>",
    "<S> , we use a multi - channel image which we then feed into a cnn . additionally , to capture the temporal aspect of the trajectories we use `` fading . '' by using gradient ascent , we were able to discover what the cnn filters look for during training . </S>",
    "<S> last , we find that a combined fnn+cnn is the best performing network with an error rate of 26% . </S>"
  ]
}