{
  "article_text": [
    "[ [ section ] ]    let @xmath3 be a discrete valuation ring with perfect residue field @xmath4 . let @xmath2 be the fraction field of @xmath3 . let @xmath13 be the corresponding discrete valuation .",
    "let @xmath0 be a smooth , projective , geometrically integral curve of genus @xmath14 defined over @xmath2 .",
    "let @xmath6 .",
    "let @xmath15 be a proper , flat , regular @xmath8-scheme with generic fiber @xmath0 . the artin conductor associated to the model @xmath15",
    "is given by @xmath16 where @xmath17 is the euler - characteristic for the tale topology and @xmath18 is the swan conductor associated to the @xmath19-adic representation @xmath20 ( @xmath21 ) .",
    "the artin conductor is a measure of degeneracy of the model @xmath15 ; it is a non - positive integer that is zero precisely when @xmath22 is smooth or when @xmath23 and @xmath24 is smooth .",
    "if @xmath22 is a regular , semistable model , then @xmath22 equals the number of singular points of the special fiber @xmath25 .",
    "let @xmath26 denote the artin conductor associated to the minimal proper regular model of @xmath0 over @xmath3 . for hyperelliptic curves",
    ", there is another measure of degeneracy defined in terms of minimal weierstrass equations .",
    "assume that @xmath0 is hyperelliptic and that @xmath27 .",
    "an integral weierstrass equation for @xmath0 is an equation of the form @xmath28 with @xmath29 $ ] , such that @xmath0 is birational to the plane curve given by this equation .",
    "the discriminant of such an equation is the non - negative integer @xmath30 .",
    "a minimal weierstrass equation is an equation for which the integer @xmath30 is as small as possible amongst all integral equations .",
    "the corresponding integer @xmath31 is the minimal discriminant .",
    "the minimal discriminant of @xmath0 is zero precisely when the minimal proper regular model of @xmath0 is smooth over @xmath8 .",
    "when @xmath23 , we have @xmath32 by the ogg - saito formula ( * ? ? ?",
    "* , corollary 2 ) .",
    "when @xmath33 and @xmath5 , liu  ( * ? ? ?",
    "* , theoreme 1 and p.53 , theoreme 2 ) shows that @xmath34 ; he also shows that equality can fail to hold .",
    "our main result is an extension of liu s result to hyperelliptic curves of arbitrary genus under the hypothesis that the weierstrass points are rational .",
    "[ main ] let @xmath3 be a discrete valuation ring with perfect residue field @xmath4 .",
    "assume that @xmath5 .",
    "let @xmath2 be the fraction field of @xmath3 .",
    "let @xmath35 denote the fraction field of the strict henselization of @xmath3 .",
    "let @xmath0 be a hyperelliptic curve over @xmath2 of genus @xmath1 .",
    "let @xmath36 be the discrete valuation on @xmath2 .",
    "assume that the weierstrass points of @xmath0 are @xmath35-rational .",
    "let @xmath6 and let @xmath37 be the minimal proper regular model of @xmath0 .",
    "let @xmath31 denote the minimal discriminant of @xmath0 .",
    "then , @xmath38    the method of proof is different from the one adopted by liu in the case of genus @xmath39 curves . in @xcite",
    ", saito proves that for a proper regular model @xmath15 of a smooth curve , @xmath40 equals a certain discriminant defined by deligne in terms of powers of the relative dualizing sheaf @xmath41 .",
    "liu compares the deligne discriminant of the minimal proper regular model and the minimal discriminant by comparing both of them to a third discriminant that he defines , that is specific to genus @xmath39 curves ( * ? ? ?",
    "* , definition 1 , p.52 , theoreme 1 and p.53 , theoreme 2 ) .",
    "in fact , he obtains an exact formula for the difference that can be computed using the namikawa - ueno classification of fibers in a pencil of curves of genus @xmath39 @xcite . since the number of possibilities for the special fiber in a family of curves grows very quickly with the genus ( there are already over @xmath42 types for genus @xmath39 curves ! ) , we can not hope to use an explicit classification result and a case by case analysis to compare the deligne discriminant and the minimal discriminant .",
    "we instead proceed by constructing an explicit proper regular model for the curve @xmath0 ( section  [ construct ] ) .",
    "we can immediately reduce to the case where @xmath3 is a henselian discrete valuation ring with algebraically closed residue field .",
    "we may then write a minimal weierstrass equation for our curve of the form @xmath43 where @xmath44 is a monic polynomial in @xmath45 $ ] that splits completely .",
    "if the weierstrass points of @xmath0 specialize to distinct points of the special fiber , then the usual compactification of the plane curve @xmath43 in weighted projective space over @xmath3 is already regular . in the general case , we iteratively blow up @xmath46 until the weierstrass points have distinct specializations .",
    "after a few additional blow - ups , we take the normalization of the resulting scheme in the function field of the curve @xmath0 .",
    "this gives us a proper regular model for the curve @xmath0 ( theorem  [ xisregular ] ) ( not necessarily minimal ) .",
    "we have the relation @xmath47 for a regular model @xmath15 of the curve @xmath0 , where @xmath48 is the number of components of the special fiber of @xmath15 and @xmath49 is an integer that depends only on the curve @xmath0 and not on the particular regular model chosen .",
    "this tells us that to bound @xmath40 for the minimal proper regular model from above , it suffices to bound @xmath40 for some regular model for the curve from above .",
    "in section  [ explicitformula ] , we give an explicit formula for the deligne discriminant for the model we have constructed .",
    "after a brief interlude on dual graphs in section  [ dualgraphs ] , we restate the formula for the deligne discriminant using dual graphs ( section  [ dualgraphs ] ) .",
    "this formula tells us that the deligne discriminant decomposes as a sum of local terms , indexed by the vertices of the dual graph of the special fiber of the regular model we constructed ( section  [ ddanddual ] ) . in section  [ description ] , we give a description of the rest of the strategy to prove the main theorem using this formula .",
    "the additional ingredients that are necessary are a decomposition of the minimal discriminant into a sum of local terms ( section  [ breakupnaive ] ) and explicit formulae for the local terms in the deligne discriminant in terms of dual graphs ( section  [ localcontribution ] ) . in section  [ comparison ] ,",
    "we show how to compare the deligne discriminant for the model we have constructed and the minimal discriminant locally .",
    "to finish the proof , we sum the inequalities coming from all the local terms to obtain @xmath50 . as a corollary",
    ", we obtain upper bounds on the number of components in the special fiber of the minimal proper regular model ( corollary  [ number ] ) .",
    "this has applications to chabauty s method of finding rational points on curves of genus at least @xmath39 @xcite .    it might be possible to adapt the same strategy to extend the results to the case of non - rational weierstrass points .",
    "the main difficulties in making this approach work are in understanding the right analogues of the results in sections  [ breakupnaive ] and [ localcontribution ] .",
    "the invariants @xmath40 and @xmath31 are unchanged when we extend scalars to the strict henselization .",
    "so from the very beginning , we let @xmath3 be a henselian discrete valuation ring with algebraically closed residue field @xmath4 .",
    "let @xmath2 be its fraction field .",
    "assume that @xmath5 .",
    "let @xmath36 be the discrete valuation on @xmath2 .",
    "let @xmath51 be a uniformizer of @xmath3 ; @xmath52 .",
    "let @xmath6 .",
    "let @xmath0 be a hyperelliptic curve over @xmath2 with @xmath2-rational weierstrass points and genus @xmath53 .",
    "let @xmath54 be an for @xmath0 , i.e. , @xmath55 $ ] and @xmath0 is birational to the plane curve given by this equation .",
    "the of a weierstrass equation @xmath56 equals the discriminant of @xmath44 considered as a polynomial of degree @xmath57 .",
    "a for @xmath0 is a weierstrass equation for @xmath0 such that @xmath58 is as small as possible amongst all integral weierstrass equations for @xmath0 .",
    "the equals @xmath58 for a minimal weierstrass equation @xmath43 for @xmath0 .",
    "we will first show that we can find a minimal weierstrass equation such that @xmath44 is a monic , separable polynomial of degree @xmath57 in @xmath45 $ ] that splits completely ; @xmath59 in @xmath45 $ ] .",
    "let @xmath60 be any minimal weierstrass equation for @xmath0 .",
    "let @xmath61 .",
    "choose a point @xmath62 that is not a zero of @xmath63 and let @xmath64 be a lift of @xmath65 ; @xmath66 .",
    "since @xmath67 acts transitively on @xmath68 , we can find @xmath69 that sends @xmath70 to @xmath71 \\in { \\mathbb p}^1_r$ ] .",
    "then , if @xmath72 , then @xmath73 is of degree @xmath57 and @xmath74 is a unit .",
    "let @xmath75 . since @xmath5 and @xmath3 is henselian with algebraically closed residue field , we can find a @xmath76 such that @xmath77 .",
    "this tells us that by scaling @xmath78 by @xmath79 , we obtain a weierstrass equation @xmath43 for @xmath0 such that @xmath80 is monic and separable of degree @xmath57 .",
    "since @xmath81 is a unit in @xmath3 , and the discriminant of @xmath44 differs from the discriminant of @xmath82 by a power of @xmath81 , it follows that @xmath43 is a minimal weierstrass equation for @xmath0 .",
    "fix such an equation . for any proper regular curve @xmath83 over @xmath8",
    ", we will denote the special fiber of @xmath83 by @xmath84 , the generic fiber by @xmath85 and the geometric generic fiber by @xmath86 .",
    "we will denote the fraction field of an integral scheme @xmath83 by @xmath87 , the local ring at a point @xmath88 of a scheme @xmath83 by @xmath89 and the unique maximal ideal in @xmath89 by @xmath90 . the reduced scheme attached to a scheme @xmath83",
    "will be denoted @xmath91 .",
    "we first prove a lemma that gives sufficient conditions for the normalization of a regular @xmath39-dimensional scheme in a degree @xmath39 extension of its function field to be regular .",
    "[ useful ] let @xmath92 be a regular integral @xmath39-dimensional scheme and let @xmath44 be a rational function on @xmath92 that is not a square .",
    "assume that the residue field at any closed point of @xmath92 is not of characteristic @xmath39 .",
    "( weil divisors make sense on @xmath92 . )",
    "let @xmath93 .",
    "assume that    1 .",
    "any two @xmath94 for which @xmath95 is odd do not intersect .",
    "any @xmath94 for which @xmath95 is odd is regular .",
    "then the normalization of @xmath92 in @xmath96 is regular .",
    "we will sketch the details of the proof .",
    "the construction of the normalization is local on the base .",
    "therefore , it suffices to check that for every closed point @xmath78 of @xmath92 , the normalization of the corresponding local ring @xmath97 in @xmath96 is regular .",
    "there are two cases to consider .",
    "the first case is when @xmath95 is even for every @xmath94 that contains @xmath78 . in this case , since @xmath97 is a regular and hence a unique factorization domain , we can write @xmath98 for some @xmath99 and a unit @xmath100 . using the fact that @xmath39 is a unit in @xmath97 for every @xmath78 , a standard computation then shows that the normalization of @xmath97 in @xmath96 is @xmath101/(z^2-u)$ ] . from this presentation",
    ", we conclude that the normalization is tale over @xmath97 , and hence regular by ( * ? ? ?",
    "* , proposition 9 ) .",
    "the second case is when exactly one of the @xmath95 is odd for the @xmath94 that contain @xmath78 .",
    "let @xmath102 be an irreducible element of the unique factorization domain @xmath97 , corresponding to the unique @xmath94 for which @xmath95 is odd . in this case ,",
    "@xmath103 , where @xmath99 and @xmath104 is a unit in @xmath97 as before .",
    "one can then check that the normalization of @xmath97 in @xmath96 is @xmath101/(z^2-au)$ ] .",
    "since @xmath94 is regular at @xmath78 , we can find an element @xmath105 such that @xmath102 and @xmath106 generate the maximal ideal of @xmath97 .",
    "one can then check that @xmath88 and @xmath106 generate the unique maximal ideal of @xmath101/(z^2-au)$ ] .",
    "this implies that @xmath101/(z^2-au)$ ] is regular .    in our example , @xmath107 and the rational function @xmath44 is @xmath108 .",
    "the divisor of @xmath44 is just the sum of the irreducible principal horizontal divisors @xmath109 , all appearing with multiplicity @xmath110 in @xmath111 , and the divisor at @xmath112 ( the closure of the point at @xmath112 on the generic fiber ) , with multiplicity @xmath113 .",
    "if the @xmath114 belong to distinct residue classes modulo @xmath51 , then the condition in the lemma is satisfied and we get the regular scheme @xmath115}{y^2-z^{2g+2}f(x / z)}$ ] .",
    "if some of the @xmath114 belong to the same residue class , then the corresponding horizontal divisors would intersect at the closed point on the special fiber given by this residue class and we can not apply the lemma directly with @xmath107 .",
    "we will instead apply the lemma to the divisor of @xmath44 on an iterated blow - up of @xmath46 .",
    "the generic fiber of this new @xmath92 is still @xmath116 , so the regular scheme that we obtain will still be a relative @xmath8-curve with generic fiber the hyperelliptic curve we started with",
    ".    we will need another lemma to show that we can resolve the issue discussed above by replacing @xmath46 by an iterated blow - up of @xmath46 .",
    "the following lemma is a minor modification of ( * ? ? ?",
    "* , lemma 1.4 ) , where we consider irreducible divisors appearing in the divisor of an arbitrary rational function on a model ( instead of the rational function @xmath51 ) and the order of vanishing of @xmath44 along these divisors instead .",
    "we recover ( * ? ? ?",
    "* , lemma 1.4 ) by taking @xmath44 to be @xmath51 .",
    "[ valf ] let @xmath117 be a regular model of a curve @xmath118 .",
    "let @xmath44 be a rational function on @xmath92 .",
    "let @xmath0 and @xmath119 be irreducible divisors of @xmath92 that appear in the divisor of @xmath44 , and let the order of vanishing of @xmath44 along @xmath0 and @xmath119 be @xmath120 and @xmath121 respectively .",
    "let @xmath122 be a closed point , and let @xmath123 denote the model of @xmath124 obtained by blowing up @xmath92 at @xmath78 .",
    "let @xmath125 denote the exceptional divisor .    1 .",
    "if @xmath78 is a regular point of @xmath0 that does not belong to any other irreducible divisor appearing in @xmath111 , then the order of vanishing of @xmath44 along @xmath126 equals @xmath120 .",
    "2 .   if @xmath127 and does not belong to any other divisors appearing in @xmath111 , and if @xmath0 and @xmath119 intersect transversally at @xmath78 , then the order of vanishing of @xmath44 along @xmath126 is @xmath128 .    omitted .",
    "this can be seen using explicit equations of the blow - up in a neighbourhood of @xmath78 .",
    "we are now ready to construct the regular model @xmath15 of @xmath0 .",
    "a very similar construction already appears in @xcite under some additional simplifying hypotheses .",
    "the model that is obtained there turns out to be semi - stable .",
    "the regular model @xmath15 that is constructed below is not necessarily semi - stable .",
    "let @xmath129 be the irreducible principal horizontal divisor @xmath109 on @xmath46 .",
    "first blow - up @xmath46 at those closed points on the special fiber where any two of the @xmath129 intersect to obtain a new scheme @xmath130 . on this scheme ,",
    "the strict transforms of any two divisors @xmath129 and @xmath131 for which the @xmath114 agree mod @xmath51 and not mod @xmath132 will no longer intersect .",
    "if some of the @xmath114 agree mod @xmath132 as well , then continue to blow - up ( that is , now blow up @xmath130 at the closed points on the special fiber of @xmath130 where any two of the strict transforms of the divisors @xmath133 intersect , and call the result @xmath134 ) .",
    "since the @xmath114 are pairwise distinct , we will eventually end up with a scheme @xmath135 where no two of the irreducible horizontal divisors occuring in @xmath111 intersect .",
    "we may hope to set @xmath92 equal to @xmath135 , but the divisor of the rational function @xmath44 might now vanish along some irreducible components of the special fiber .",
    "lemma  [ valf ] now tells us that a single blow - up of @xmath135 based at a finite set of closed points will ensure that no two components where @xmath44 vanishes to odd order intersect .",
    "do this as well and call the resulting scheme @xmath92 .",
    "call an irreducible component of the special fiber of @xmath92 even if the order of vanishing of @xmath44 along this component is even .",
    "similarly define odd component . similarly define odd and even components of @xmath135 .",
    "recall the notion of a good model as defined in @xcite .",
    "a regular model @xmath136 of @xmath118 is good if it satisfies the following two conditions :    1 .",
    "the irreducible components of @xmath137 are smooth .",
    "each singular point of @xmath137 belongs to exactly two irreducible components of @xmath137 and these components intersect transversally .",
    "the blow - up of a good model at a closed point is again a good model .",
    "the model @xmath92 we have constructed is a good model of @xmath116 as it is obtained using a sequence of blow - ups starting from the good model @xmath46 of @xmath116 .",
    "the model @xmath135 is the model we would get using ( * ? ? ?",
    "* , lemma 1.9 ) if we start with the model @xmath46 and the divisor @xmath111 on it .",
    "set @xmath15 to be equal to the normalization of @xmath92 in @xmath96 .",
    "[ xisregular ] the scheme @xmath22 is regular .",
    "the components of @xmath137 are smooth and the divisor @xmath111 satisfies the conditions in the statement of lemma  [ useful ] .",
    "it follows that @xmath15 is regular .",
    "we will now prove that @xmath15 is a good model of @xmath0 and compute the multiplicities of the components of the special fiber of @xmath15 .",
    "let the divisor of @xmath51 on @xmath15 be @xmath138 ; here the sum runs over all irreducible components of the special fiber @xmath139 and the @xmath94 are integral divisors on @xmath15 .",
    "let @xmath140 denote the map @xmath141 .",
    "[ construction ]    1 .",
    "the scheme @xmath15 is a good model of @xmath0 .",
    "2 .   each @xmath95 is @xmath110 or @xmath39 .",
    "furthermore , @xmath142 if and only if either a.   @xmath143 is an odd component of @xmath144 , or , b.   @xmath145 for two distinct odd components @xmath146 and @xmath147 of @xmath144 .    1 .   let @xmath8 be the set of odd components of @xmath137 and let @xmath148 be the divisor @xmath149 where @xmath150 is the horizontal divisor that is the closure of the point @xmath114 on the generic fiber @xmath116 .",
    "since the map @xmath151 is finite of degree @xmath39 , the image of an irreducible component of @xmath139 is an irreducible component of @xmath137 , and there are at most two irreducible components of @xmath139 mapping down to an irreducible component of @xmath137 .",
    "all the irreducible components of @xmath137 are isomorphic to @xmath152 .",
    "there are two irreducible components of @xmath139 mapping down to a given component of @xmath137 only when the component of @xmath137 is an even component that does not intersect any of the irreducible divisors appearing in @xmath148 . in this case the two components in @xmath139 that map down to the given component of @xmath137 do not intersect , and are isomorphic to @xmath152 . in all other cases",
    "there is a unique component of @xmath139 mapping down to a component of @xmath137 .",
    "+ since at most two irreducible components of @xmath137 pass through any given point of @xmath137 , we see that this implies that at most two irreducible components of @xmath139 pass through any given point of @xmath139 .",
    "the intersection point @xmath153 of two irreducible components of @xmath139 has to map to the intersection point @xmath78 of two irreducible components of @xmath137 .",
    "if @xmath78 is the intersection of two even components , then the map @xmath140 is etale at @xmath153 , so the intersection is still transverse .",
    "if @xmath78 is the intersection of an even and odd component , because the intersection of these components is transverse , we can pick the function @xmath1 in the proof of lemma  [ useful ] to be a uniformizer for the even component .",
    "this shows that tale locally , the two components that intersect at @xmath153 are given by the vanishing of @xmath154 and @xmath1 and as these two elements generate the maximal ideal at @xmath153 tale locally , the intersection is transverse once again . for a closed point @xmath153 on @xmath139 lying on exactly one component @xmath146 of @xmath139 , the same argument shows that we can choose a system of parameters at the point such that one of them cuts out the component @xmath146 of @xmath139 .",
    "this shows that the irreducible components of @xmath139 are smooth .",
    "2 .   a repeated application of ( * ? ? ?",
    "* , lemma 1.4 ) tells us that the multiplicity of every irreducible component of @xmath144 is @xmath110 .",
    "the same lemma tells us that @xmath137 has a few additional components of multiplicity either @xmath110 or @xmath39 - if we blow up the closed point that is the intersection of an odd component of the special fiber of @xmath135 with a horizontal divisor appearing in @xmath111 , then we get a component of multiplicity @xmath110 in the special fiber and if we blow up the intersection of two odd components of the special fiber , we get a component of multiplicity @xmath39 .",
    "since @xmath44 vanishes to an even order along components of multiplicity @xmath39 in @xmath137 , each @xmath95 is either @xmath110 or @xmath39 - it is @xmath110 if @xmath94 maps down to an even component of @xmath137 and its image in @xmath144 does not equal the intersection point of two components of the special fiber and it is @xmath39 otherwise .",
    "this is because @xmath155 is an extension of discrete valuation rings ( here @xmath156 for an integral curve @xmath0 denotes its generic point ) , and the corresponding extension of fraction fields is of degree @xmath39 .",
    "@xmath51 is a uniformizer in @xmath157 , so its valuation above is either @xmath110 or @xmath39 depending on whether the extension is ramified at @xmath158 or not .",
    "the extension is not ramified if the image of @xmath94 in @xmath92 is an even component .",
    "the deligne discriminant of the model @xmath15 is @xmath159 , where @xmath18 is the swan conductor associated to the @xmath19-adic representation @xmath160 ( @xmath161 ) @xcite .",
    "@xmath162    since all irreducible components of @xmath139 have multiplicity either @xmath110 or @xmath39 in the special fiber and @xmath163 , ( * ? ? ?",
    "* , theorem 3 ) implies that @xmath164 .    using the intersection theory for regular arithmetic surfaces , for a canonical divisor @xmath2 on @xmath15",
    ", we have @xmath165 the last equality is obtained from @xmath166 .",
    "let @xmath167 be the natural map which is just the inclusion of each @xmath94 into @xmath168 .",
    "since the @xmath94 are smooth , ( * ? ? ?",
    "* , theorem 2.6 ) tells us that @xmath169 where @xmath170 . in our case",
    "@xmath171 is just the number of points where two components of @xmath139 meet .",
    "since the intersections in @xmath139 are all transverse , @xmath172 putting all this together , we can rewrite @xmath173 in the following form @xmath174 this expression , together with the formula above for @xmath175 gives @xmath176",
    "by the construction of @xmath15 we have a sequence of maps @xmath177 .",
    "let @xmath178 be the dual graph of @xmath139 , i.e. , the graph with vertices the irreducible components of @xmath139 , and an edge between two vertices with an edge if the corresponding irreducible components intersect . let @xmath179 be the dual graph of @xmath137 and @xmath180 the dual graph of @xmath144 . for a vertex @xmath181 of any of the graphs @xmath182 or @xmath180 , the irreducible component corresponding to the vertex in the respective dual graph",
    "will be denoted @xmath183 .",
    "let @xmath184 denote the map @xmath151 and let @xmath185 the map @xmath186 .",
    "let @xmath187 .",
    "we will denote the vertices of a graph @xmath188 by @xmath189 .",
    "for any @xmath190 , let @xmath191 ( for neighbours of @xmath181 ) denote the set of vertices @xmath192 for which there is an edge between @xmath181 and @xmath192 .",
    "if @xmath188 is a directed graph and @xmath190 , let @xmath193 ( for children of @xmath181 ) denote the set of vertices @xmath192 for which there is an edge pointing from @xmath181 to @xmath192 .",
    "the graph @xmath180 naturally has the structure of a rooted tree ( remembering the sequence of blow - ups , i.e. , whether the component was obtained as a result of a blow - up at a closed point of the other component ) .",
    "the graph @xmath179 is obtained from the graph of @xmath180 by attaching some additional vertices between two pre - existing vertices connected by an edge and some additional leaves , so @xmath179 is also a tree . by virtue of being rooted trees , the edges of @xmath180 and @xmath179 can be given a direction ( and we choose the direction that points away from the root ) .",
    "there is a natural surjective map @xmath194 : if the image of an irreducible component @xmath195 of @xmath139 under @xmath184 is an irreducible component @xmath196 of @xmath137 then let @xmath197 .",
    "if two vertices of @xmath178 are connected by an edge , so are their images in @xmath179 .",
    "we can use this surjection to transfer the direction on the edges of @xmath179 to the edges of @xmath178 ; this makes @xmath178 a directed graph . call a vertex of @xmath180 ( respectively ) if the order of vanishing of @xmath44 along the corresponding component is odd ( respectively even ) .",
    "similarly define odd and even vertices of @xmath179 .",
    "this definition is consistent with the earlier definition of odd and even components of @xmath92 and @xmath135 .",
    "the last term @xmath198 in the deligne discriminant can be thought of as the sum @xmath199 .",
    "we use this observation to decompose the deligne discriminant as a sum over the vertices of the graph @xmath178 .",
    "let @xmath200 be the multiplicity of @xmath195 in @xmath139 .",
    "we then have @xmath201",
    "to compare the discriminant @xmath202 of the polynomial @xmath44 with the valuation of the deligne discriminant of the model @xmath15 , it would be useful if we could decompose @xmath202 as a sum of local terms . in the next section",
    ", we will show that there is a way to decompose the minimal discriminant as a sum over the vertices of @xmath180 .",
    "there is a simple relation between the irreducible components of @xmath139 and those of @xmath203 ( which we will describe below ) , so we will be able to compare the two discriminants using this decomposition , by first comparing them locally .",
    "the image of an irreducible component of @xmath137 under @xmath185 is either an irreducible component of @xmath203 or a point that lies on exactly one of the irreducible components of @xmath203 or the intersection point of two irreducible components of @xmath203 .",
    "this induces a surjective map @xmath204 where the vertex corresponding to an irreducible component of @xmath137 is mapped either to the vertex corresponding to the unique irreducible component that its image is contained in or to the smaller of the two vertices ( by which we mean the vertex closer to the root ) corresponding to the two irreducible components that its image is contained in .",
    "let @xmath205 .",
    "we have written the deligne discriminant as @xmath206 and we can rewrite this sum as @xmath207 , so the deligne discriminant can be regarded as a sum over the vertices of @xmath180 .",
    "the discussion above implies the following lemma , which will be useful later on in an explicit computation of the deligne discriminant .",
    "[ adjacency ] let @xmath208 .    1 .   if @xmath209 , then @xmath210 . in particular , if @xmath211 , then @xmath212 .",
    "2 .   let @xmath209 .",
    "if @xmath213 is a point , then @xmath214 and @xmath215 is an odd vertex . otherwise , @xmath216 .",
    "to each vertex @xmath181 of @xmath180 , we want to associate an integer @xmath217 such that the minimal discriminant equals @xmath218 .",
    "we will now define @xmath217 by inducting on the vertices of @xmath180 .    for the base case , note that if the @xmath219 belong to distinct residue classes modulo @xmath51 , then @xmath220 and @xmath180 is the graph with a single vertex @xmath181 .",
    "the minimal discriminant is @xmath221 , so we set @xmath222 .    the scheme @xmath135 was obtained as an iterated blow - up of @xmath46 while trying to separate the horizontal divisors @xmath133 corresponding to the linear factors of @xmath44 .",
    "this can be done for any separable polynomial @xmath223 $ ] that splits completely ",
    "let @xmath224 denote the iterative blow up of @xmath46 that one obtains while trying to separate the divisors corresponding to the linear factors of @xmath1 . with this notation",
    "@xmath225 equals the scheme @xmath135 we had above .",
    "let @xmath226 be the set of residues of the @xmath114 modulo @xmath51 .",
    "for a residue @xmath227 , let the weight of the residue @xmath102 ( @xmath228 ) , be the number of @xmath114 belonging to the residue class of @xmath102 .",
    "observe that the subtrees of the root of @xmath180 are in natural bijection with the residues of weight strictly larger than @xmath110 .",
    "the minimal discriminant @xmath31 ( @xmath229 ) can be decomposed as follows : @xmath230    set @xmath231 .",
    "pick an element @xmath114 belong to the residue class @xmath227 of weight strictly bigger than @xmath110 .",
    "the subtree corresponding to the residue @xmath102 can naturally be identified with the dual graph of @xmath232 for the polynomial @xmath233 .",
    "let @xmath234 denote the discriminant of @xmath235 .",
    "then , @xmath236 now recursively decompose @xmath237 as a sum over the vertices of the dual graph of @xmath232 .",
    "identifying the dual graph of @xmath232 with the corresponding subtree in @xmath180 , this gives us a way to decompose the minimal discriminant as a sum over the vertices of @xmath180 .",
    "we will now prescribe a way to attach weights to the vertices of @xmath180 and give an explicit formula for @xmath217 in terms of these weights .",
    "suppose @xmath238 .",
    "let @xmath239 be the complete subtree of @xmath180 with root @xmath181 .",
    "the complete subtree of @xmath180 with root @xmath181 has as its set of vertices all those vertices of @xmath180 whose path to the root crosses @xmath181 .",
    "there is an edge between two vertices in this subtree if there is an edge between them when considered as vertices of @xmath180 .    for each vertex @xmath181 of @xmath180 ,",
    "define the weight of the vertex @xmath240 as follows : let @xmath241 be the set of all irreducible components of @xmath242 corresponding to the vertices that are in @xmath239 .",
    "let @xmath240 equal the total number of irreducible horizontal divisors that occur in the divisor @xmath111 in @xmath135 , not counting the divisor @xmath243 , that intersect any of the irreducible components in @xmath241 .",
    "thus , if @xmath183 was obtained as the exceptional divisor in the blow - up of an intermediate iterated blow - up @xmath83 between @xmath135 and @xmath46 at a smooth closed point of the special fiber @xmath244 , then @xmath240 is exactly the number of irreducible horizontal divisors that occur in @xmath111 that intersect @xmath84 at @xmath88 .",
    "this in turn implies the following :    [ weight ] if @xmath238 , then @xmath245 .",
    "[ formulaford ] for any vertex @xmath181 of @xmath180 , @xmath246    this will once again proceed through an induction on the number of vertices of the tree . for the base case ,",
    "note that the tree @xmath180 has only one vertex if and only if all the roots of the polynomial @xmath44 belong to distinct residue classes @xmath247 and in this case @xmath222 .",
    "now for the general case .",
    "it is clear that the equality holds for the root  for a residue class @xmath227 such that @xmath248 , the weight of the residue class as in the definition is just the weight of the subtree corresponding to the residue class . for any vertex @xmath181 at depth @xmath110",
    "( by which we mean one of the nearest neighbours of the root ) corresponding to a residue class @xmath102 such that @xmath248 , we first observe that the set of roots of the polynomial @xmath233 corresponding to the residue class @xmath102 is in natural bijection with a subset of the horizontal divisors of @xmath111  namely the ones corresponding to the strict transforms of the divisors @xmath249 on @xmath250 for @xmath251 .",
    "these are the divisors that intersect the special fiber at one of the irreducible components corresponding to the vertices in this subtree with root @xmath181 .",
    "these horizontal divisors are also in bijection with the horizontal divisors of the function @xmath235 different from @xmath243 on @xmath252 .",
    "the identification of horizontal divisors of @xmath252 and a subset of the horizontal divisors of @xmath225 is compatible with the identification of the subtree of @xmath180 with the dual graph of @xmath232 . by this",
    "we mean that the set of horizontal divisors intersecting the irreducible component corresponding to any given vertex match up .",
    "this tells us that the weight of a vertex of the dual graph of @xmath232 equals the weight of the corresponding vertex in @xmath180 . since the lemma holds for the complete subtree at vertex @xmath181 by induction ( where the weights to the vertices of @xmath232 are assigned using the horizontal divisors of @xmath252 ) , we are done .",
    "the goal of this section is to obtain explicit formulae ( theorem  [ localdel ] ) for the local terms appearing in the deligne discriminant in terms of the combinatorics of the tree @xmath180 ( definition  [ lrv ] ) .",
    "this involves a careful analysis of the special fiber of @xmath15 which we present as a series of lemmas .",
    "[ branchlocus ]    1 .",
    "the branch locus of the double cover @xmath253 is the set of all odd components of @xmath137 along with the strict transforms of the horizontal divisors @xmath133 on @xmath46 .",
    "2 .   if @xmath146 is an even component of @xmath137 and @xmath147 is an irreducible component of the branch locus that intersects @xmath146 , then @xmath254 .    1 .",
    "this is clear from the construction of @xmath15 as outlined in lemma  [ useful ] .",
    "2 .   from ( a )",
    ", it follows that @xmath146 does not belong to the branch locus and @xmath147 is either an odd component of @xmath137 or the strict transform of the horizontal divisor @xmath133 on @xmath46 for some @xmath114 .",
    "+ suppose @xmath147 is an odd component of @xmath137 .",
    "it follows from the construction of @xmath92 that if any two irreducible components of @xmath137 intersect , then they intersect transversally and there is at most one point in the intersection .",
    "this implies that @xmath254 .",
    "+ suppose @xmath147 is the strict transform of the horizontal divisor @xmath133 on @xmath46 for some @xmath114 .",
    "let @xmath255 be the iterated blow - up map that we obtain from the construction of @xmath92 .",
    "since @xmath256 is an iterated blow - up morphism , @xmath257 is a direct summand of @xmath258 , with a canonical projection map @xmath259 .",
    "let @xmath260 denote the weil divisor @xmath133 on @xmath46",
    ". then @xmath261 .",
    "@xmath262 this implies that @xmath254 .",
    "[ oddeven ] let @xmath238 and @xmath263",
    ". then @xmath264 .",
    "( here @xmath265 and @xmath266 denote the valuation of @xmath44 in the discrete valuation rings corrresponding to the irreducible divisors @xmath183 and @xmath267 of @xmath135 ) .",
    "in particular , if @xmath181 is even , then @xmath192 is odd if and only if @xmath268 is odd ; if @xmath181 is odd , then @xmath192 is odd if and only if @xmath268 is even .    the scheme @xmath135 was constructed as an iterated blow - up of @xmath46 .",
    "there exist intermediate iterated blow - ups @xmath269 and @xmath83 of @xmath46 with iterated blow - up maps @xmath270 , @xmath271 and @xmath272 such that    1 .",
    "the scheme @xmath269 is the blow - up of @xmath83 at a smooth closed point @xmath88 of the special fiber @xmath84 .",
    "the divisor @xmath273 is the strict transform of a vertical divisor @xmath119 on @xmath83 under the morphism @xmath274 .",
    "3 .   @xmath275 .",
    "the divisor @xmath276 is the strict transform of @xmath126 under the morphism @xmath270 , where @xmath126 denotes the exceptional divisor of @xmath271 .",
    "the valuation of @xmath44 along @xmath126 equals the multiplicity @xmath277 ( that is , the largest integer @xmath278 such that @xmath279 ) .",
    "there are @xmath268 distinct irreducible horizontal divisors of @xmath111 that intersect @xmath84 at @xmath88 , and @xmath88 is a smooth point on each of these divisors .",
    "this in particular implies that a uniformizer for each of the corresponding discrete valuation rings is in @xmath280 . from the factorization of @xmath44 and",
    "the fact that @xmath89 is a regular local ring ( in particular , a unique factorization domain ) , one can deduce that @xmath281 .",
    "this implies that @xmath266 and @xmath268 have the same parity if @xmath265 is even and have opposite parity if @xmath265 is odd .",
    "[ lrv ]    since @xmath135 was obtained by iteratively blowing up a regular scheme at smooth rational points on the special fiber , all the components of its special fiber are isomorphic to @xmath282 and @xmath139 is reduced .",
    "similarly , all the components of the special fiber of @xmath92 are also isomorphic to @xmath152 , though @xmath137 may no longer be reduced .",
    "[ lmod2 ] let @xmath238 be an even vertex .",
    "then @xmath283 is odd if and only if @xmath181 has an odd parent . in particular ,",
    "if @xmath181 is the root , then @xmath283 is even .",
    "suppose @xmath238 is even .",
    "then @xmath284 is a single irreducible component @xmath285 of @xmath137 and @xmath185 is an isomorphism above a neighbourhood of @xmath183 . using lemma  [ branchlocus](b ) and the riemann - hurwitz formula , we see that the branch locus of @xmath184 has to intersect @xmath285 at an even number of points .",
    "since @xmath181 is even , lemma  [ branchlocus](a ) and lemma  [ oddeven ] imply that @xmath285 intersects the branch locus at @xmath286 points if @xmath181 has an odd parent , and at @xmath283 points otherwise .",
    "[ oddy ] a component of @xmath137 is odd if and only if it is the strict transform of an odd component of @xmath144 .",
    "the exceptional divisors that arise when we blow up @xmath135 to obtain @xmath92 are all even by lemma  [ valf ] , as every point that is blown up in @xmath135 is at the intersection of two odd components .",
    "[ invimgphi ]    1 .",
    "let @xmath287 .",
    "then @xmath288 if @xmath196 intersects the branch locus of @xmath184 , and @xmath289 otherwise . if @xmath289 , then both irreducible components of @xmath139 corresponding to vertices in @xmath290 are isomorphic to @xmath152 .",
    "2 .   suppose @xmath238 is an even vertex .",
    "then @xmath291 is either @xmath110 or @xmath39 .",
    "it is @xmath110 if and only if @xmath284 intersects the branch locus of @xmath184 .",
    "if @xmath292 , then both irreducible components of @xmath139 corresponding to vertices in @xmath293 are isomorphic to @xmath152 .",
    "3 .   suppose @xmath238 is odd .",
    "let @xmath287 be the vertex corresponding to the strict transform of @xmath183 in @xmath92 .",
    "let @xmath294 let @xmath295 and @xmath296 . then a.   the sets @xmath297 and @xmath298 form a partition of @xmath299 . hence @xmath300 is a partition of @xmath293 .",
    "b.   we have that @xmath301 .",
    "suppose @xmath302 .",
    "then @xmath303 is odd , @xmath304 , and @xmath305 c.   we have that @xmath306 .",
    "if @xmath307 , then @xmath308 . if @xmath309 , then @xmath79 is not a leaf in @xmath179 .",
    "d.   we have that @xmath310 . if @xmath311 , then @xmath312 .",
    "e.   we have that @xmath313 f.   the map @xmath314 induces an isomorphism of graphs between @xmath299 and @xmath293 .",
    "g.   the graph @xmath299 is a tree with root @xmath303 and the graph @xmath293 is a tree with root @xmath315 .",
    "h.   if @xmath316 , then @xmath317 .    1 .",
    "all the components of @xmath137 are isomorphic to @xmath152 .",
    "let @xmath287 .",
    "the vertices in @xmath290 are the irreducible components of @xmath315 .",
    "if @xmath303 is even , then lemma  [ branchlocus](b ) tells us that if @xmath196 intersects the branch locus at all , it intersects it transversally .",
    "since ramified double covers of @xmath152 are irreducible , @xmath315 is irreducible if @xmath196 intersects the branch locus .",
    "if @xmath196 does not intersect the branch locus , as @xmath152 has no connected unramified double covers , we see that @xmath315 has two irreducible components , both of which are isomorphic to @xmath152 .",
    "this implies that @xmath318 is @xmath110 if @xmath196 intersects the branch locus of @xmath184 and is @xmath39 otherwise .",
    "2 .   suppose @xmath238 is even .",
    "then @xmath284 is a single irreducible component @xmath285 of @xmath137 and @xmath185 is an isomorphism above a neighbourhood of @xmath183 .",
    "let @xmath287 be such that @xmath319 . then @xmath320 and @xmath321 .",
    "apply ( a ) to @xmath303 .",
    "a.   the component @xmath196 of @xmath137 satisfies @xmath322 and it is the only component of @xmath137 with this property .",
    "it follows that @xmath323 .",
    "the other components @xmath324 of @xmath137 satisfying @xmath325 are the exceptional divisors of @xmath326 that get mapped to a point of @xmath183 that does not also lie on @xmath327 . since @xmath92 is the blow - up of @xmath135 at the finite set of points consistsing of the intersection of any two odd components of the special fiber and the intersection of an odd component of the special fiber with an irreducible horizontal divisor @xmath328 appearing in @xmath111 , it follows that @xmath329 is a partition of @xmath299 . since @xmath330",
    ", it follows that @xmath300 is a partition of @xmath293 .",
    "b.   lemma  [ oddy ] tells us @xmath196 is odd , and lemma  [ branchlocus](a ) tells us that @xmath184 is ramified over @xmath196 and therefore @xmath315 is irreducible , and isomorphic to @xmath152 .",
    "it follows that @xmath301 .",
    "since @xmath331 and @xmath181 is odd , lemma  [ construction](b ) tells us that @xmath304 .",
    "+ since @xmath332 , it follows that @xmath333 is not a point .",
    "conversely , suppose @xmath316 and @xmath334 is not a point .",
    "since @xmath329 is a partition of @xmath299 by ( a ) and @xmath335 is a point for @xmath336 , it follows that @xmath337 . c.   for every odd @xmath338",
    ", there exists a unique exceptional curve @xmath126 of the blow - up @xmath186 such that if @xmath339 is the vertex such that @xmath340 , then @xmath341 and @xmath342 .",
    "this shows that @xmath343 + suppose @xmath309 .",
    "let @xmath263 be an odd vertex such that @xmath344 .",
    "let @xmath345 be the vertex corresponding to the strict transform of @xmath267 in @xmath92 .",
    "then @xmath346 and @xmath347 .",
    "in particular , @xmath79 is not a leaf . since @xmath303 is odd , lemma  [ branchlocus](a ) and part ( a ) applied to @xmath79",
    "imply that @xmath348 .",
    "this tells us that @xmath306 .",
    "+ suppose @xmath307 .",
    "since @xmath181 is odd and @xmath349 , lemma  [ construction](b ) implies that @xmath308 .",
    "d.   for every irreducible horizontal divisor @xmath328 appearing in the divisor of @xmath111 on @xmath135 , there exists a unique exceptional curve @xmath126 of the blow - up @xmath186 such that if @xmath339 is the vertex such that @xmath340 , then @xmath341 and @xmath350 .",
    "this shows that @xmath351 + suppose @xmath352 .",
    "then @xmath346 .",
    "since @xmath303 is odd , lemma  [ branchlocus](a ) and part ( a ) applied to @xmath79 imply that @xmath348 .",
    "this tells us that @xmath310 . +",
    "suppose @xmath311 .",
    "then @xmath353 .",
    "this implies that @xmath334 is a point lying on a unique odd component of @xmath144 , namely @xmath183 .",
    "lemma  [ construction](b ) implies that @xmath312 .",
    "e.   we already observed that @xmath303 is the unique vertex of @xmath354 and that it is odd ( by lemma  [ oddy ] ) . if @xmath309 , then ( iii ) implies that @xmath79 is not a leaf .",
    "this shows @xmath355 if @xmath352 , then lemma  [ oddy ] implies that @xmath79 is even . since @xmath324 is the exceptional curve that is obtained by blowing up the point of intersection of an odd component and a horizontal divisor",
    ", @xmath79 is a leaf .",
    "this shows the opposite inclusion .",
    "f.   parts ( ii),(iii),(iv ) imply that @xmath356 and @xmath357 .",
    "since @xmath314 is a surjection and @xmath329 is a partition of @xmath299 , it follows that @xmath314 induces a bijection between @xmath293 and @xmath299 .",
    "+ if @xmath336 , let @xmath358 be the unique vertex such that @xmath359 .",
    "let @xmath360 .",
    "if @xmath336 , then @xmath346 .",
    "+ if @xmath336 , then @xmath361 .",
    "this implies that @xmath362 for any @xmath363 . if @xmath364 for some @xmath363 , then lemma  [ adjacency](a ) would imply @xmath365 .",
    "since @xmath346 , it follows that @xmath366 .",
    "+ if @xmath367 , then @xmath368 .",
    "it now follows from lemma  [ adjacency](a ) and the fact that @xmath369 that if @xmath370 , then @xmath371 .",
    "+ combining the previous three paragraphs , we get that @xmath314 induces an isomorphism of graphs between @xmath293 and @xmath299 .",
    "g.   the proof of ( vi ) shows that if @xmath336 , then @xmath346 and that if @xmath367 , then @xmath372 and @xmath373 do not intersect .",
    "it follows that @xmath299 is a tree with root @xmath303 . since ( vi ) shows @xmath314 induces an isomorphism of graphs between @xmath293 and @xmath299 , it follows that @xmath293 is a tree with root @xmath315",
    ". h.   we already observed in the proof of ( ii ) that if @xmath360 , then @xmath374 .",
    "+ suppose @xmath375 .",
    "let @xmath376 .",
    "then @xmath309 . let @xmath263 be an odd vertex such that @xmath377 .",
    "let @xmath378 be the vertex corresponding to the strict transform of @xmath267 in @xmath92 .",
    "then from the construction of @xmath92 , it follows that @xmath379 and @xmath347 .",
    "lemma  [ oddy ] implies that @xmath303 and @xmath378 are odd and @xmath79 is even .",
    "since @xmath380 and @xmath324 intersects the branch locus transversally at two points ( the points of intersection with @xmath196 and @xmath381 ) by lemma  [ branchlocus](a , b ) , the riemann - hurwitz formula implies that @xmath382 .",
    "+ suppose @xmath383 and @xmath376",
    ". then @xmath352 .",
    "like in the previous paragraph , we can argue that @xmath324 intersects the branch locus at exactly two points , corresponding to the point of intersection of @xmath324 with its odd parent @xmath196 and the point of intersection of @xmath324 with an irreducible horizontal divisor @xmath328 appearing in the divisor of @xmath111 , and that these intersections are transverse .",
    "the riemann - hurwitz formula would once again imply @xmath384 . since ( vi ) implies that @xmath385 is a partition of @xmath293 , this completes the proof .",
    "we have the following restatement of lemma  [ construction](b ) using @xmath386 and @xmath314 .",
    "[ mult2 ] suppose @xmath208 .",
    "then @xmath308 if and only if @xmath215 is odd and @xmath387 is not an even leaf .",
    "in particular , if @xmath215 is even , then @xmath312 .",
    "lemma  [ construction](b ) tells us that @xmath308 if and only if @xmath334 is an odd component , or , if @xmath388 for two odd vertices @xmath389 . let @xmath390 .",
    "if either of the conditions above hold , it follows from the definition of @xmath386 that the vertex @xmath181 is odd .",
    "so now assume @xmath181 is odd .",
    "let @xmath300 be the partition of @xmath293 as in lemma  [ invimgphi](c ) .",
    "lemma  [ invimgphi](c)(ii , iii , iv ) imply that @xmath308 if and only if @xmath391 .",
    "lemma  [ invimgphi](c)(v ) then tells us that @xmath391 if and only if @xmath387 is not an even leaf .",
    "putting all this together , we get that @xmath308 if and only if @xmath215 is odd and @xmath387 is not an even leaf .",
    "[ neigh ]    1 .",
    "suppose @xmath392 and @xmath393 is a point .",
    "a.   we have that @xmath394 if @xmath393 belongs to a unique odd component of @xmath144 , and @xmath395 otherwise",
    ". b.   if @xmath394 , then @xmath396 . if @xmath395 , then @xmath397 . c.",
    "if @xmath398 , then @xmath399 is an odd vertex .",
    "d.   if @xmath398 , then @xmath400 .",
    "2 .   suppose @xmath392 , @xmath398 , @xmath401 is odd and @xmath399 is even .",
    "then @xmath393 is not a point , and the component @xmath402 is the inverse image under @xmath184 of the strict transform of @xmath403 .    1 .",
    "let @xmath404 . since @xmath393 is a point",
    ", @xmath181 is odd .",
    "construct the partition @xmath405 of @xmath293 as in lemma  [ invimgphi](c ) . since @xmath393 is a point , lemma  [ invimgphi](c)(ii ) implies that @xmath363 .",
    "+ if @xmath375 , then @xmath406 for an odd vertex @xmath407 .",
    "let @xmath408 be the vertices in @xmath179 corresponding to the strict transforms of @xmath183 and @xmath409 respectively .",
    "since @xmath181 and @xmath192 are odd , lemma  [ oddy ] tells us that @xmath303 and @xmath378 are odd",
    ". then @xmath410 . by lemma",
    "[ invimgphi](a ) , the vertices @xmath411 of @xmath179 each have exactly one preimage under under @xmath314 .",
    "let @xmath412 such that @xmath197 and @xmath413 .",
    "the unique point @xmath414 has exactly one preimage under @xmath184 and therefore lies on both @xmath195 and @xmath402 .",
    "similarly , @xmath415 is nonempty .",
    "lemma  [ adjacency](a ) now tells us that @xmath416 .",
    "this implies that @xmath395 and @xmath397 .",
    "we also have @xmath417 and @xmath418 , and both @xmath181 and @xmath192 are odd vertices . since @xmath215 is odd and @xmath197 is odd , lemma  [ mult2 ] tells us that @xmath308 .",
    "similarly , we can show @xmath400 .",
    "+ if @xmath383 , then lemma  [ invimgphi](c)(v ) implies that @xmath419 is an even leaf of @xmath179 .",
    "lemma  [ invimgphi](c)(vii ) shows @xmath79 has a parent .",
    "let @xmath420 and @xmath421 .",
    "lemma  [ invimgphi](c)(ii , vii ) imply that @xmath303 is an odd vertex corresponding to the strict transform of @xmath183 in @xmath92 , and @xmath422 .",
    "let @xmath208 be such that @xmath197 .",
    "then the unique point in @xmath423 has exactly one preimage under @xmath184 and this preimage is contained in @xmath424 .",
    "lemma  [ adjacency ] now tells us that @xmath394 and @xmath396 .",
    "lemma  [ oddy ] implies that @xmath425 is odd .",
    "since @xmath417 is odd and @xmath197 is also odd , lemma  [ mult2 ] implies that @xmath308 .",
    "+ the definitions of @xmath426 in lemma  [ invimgphi](c ) show that the vertices in @xmath427 are exactly the ones corresponding to irreducible components of @xmath139 whose images under @xmath140 are contained in two odd components of @xmath144 and the vertices in @xmath428 are the ones corresponding to irreducible components of @xmath139 whose images under @xmath140 are contained in exactly one odd component .",
    "2 .   suppose @xmath392 , @xmath398 , @xmath401 is odd and @xmath399 is even .",
    "then part ( a ) of this lemma tells us that @xmath393 is not a point . if @xmath405 is the partition of @xmath429 as in lemma  [ invimgphi](c ) , then lemma  [ invimgphi](c)(ii ) implies that @xmath430 since @xmath393 is not a point . as @xmath431 has a unique vertex , and this vertex corresponds to the inverse image under @xmath184 of the strict transform of @xmath403 , we are done .",
    "[ intersect ] let @xmath412 .",
    "then @xmath432 . let @xmath433 and @xmath434 .",
    "then @xmath435 if and only if    a.   both @xmath181 and @xmath192 are even , b.   the vertices @xmath181 and @xmath192 are neighbours of each other , and , c.   both @xmath196 and @xmath381 intersect the branch locus of @xmath184 .    lemma  [ construction](b ) tells us that all intersections in @xmath139 are transverse , so the the number of points in the intersection of any two irreducible components in @xmath139 equals their intersection number .",
    "let @xmath412 . then @xmath436 .",
    "since @xmath184 is finite of degree @xmath39 , any point of @xmath92 has at most two preimages under @xmath184 and therefore @xmath437 .",
    "the set @xmath438 has at most one point since the dual graph @xmath179 of @xmath137 is a tree .",
    "this implies that @xmath439 .",
    "putting these together , we get @xmath440 it follows that @xmath441 .",
    "suppose that the three conditions in the lemma hold .",
    "then , conditions @xmath442 and @xmath443 imply that @xmath444 is nonempty and consists of a single point , say @xmath106 .",
    "then the strict transforms of @xmath183 and @xmath409 are @xmath196 and @xmath381 respectively and the map @xmath185 is an isomorphism above a neighbourhood of @xmath445 .",
    "let @xmath78 be the unique point in @xmath438 .",
    "as @xmath179 is a tree , the point @xmath78 does not lie on any other component of @xmath137 except @xmath196 and @xmath381 .",
    "lemma  [ oddy ] tells us that @xmath303 and @xmath378 are even .",
    "lemma  [ branchlocus](a ) now tells us that the point @xmath78 has two preimages under @xmath184 . since @xmath196 and @xmath381 intersect the branch locus ,",
    "their inverse images under @xmath184 are irreducible .",
    "this tells us @xmath446 and @xmath447",
    ". then @xmath448 .",
    "@xmath449    now assume @xmath435 .",
    "since the intersections in @xmath139 are transverse , the set @xmath450 has two points , say @xmath451 and @xmath452 .",
    "then , @xmath453 and @xmath454 must lie in @xmath438 .",
    "since any two components of @xmath137 can not intersect at more than one point , this tells us that @xmath455 .",
    "call this point of intersection @xmath78 .",
    "since @xmath78 has two preimages under @xmath184 , it can not lie on the branch locus of @xmath184 .",
    "lemma  [ branchlocus](a ) tells us that @xmath303 and @xmath378 must both be even . since @xmath456",
    ", it follows that @xmath334 is not a point .",
    "similarly @xmath457 is not a point .",
    "either @xmath209 or @xmath458 , and lemma  [ adjacency](b ) tells us that in both cases @xmath181 and @xmath192 are neighbours of each other . if @xmath196 did not intersect the branch locus , then lemma  [ invimgphi](a ) implies that @xmath315 must have two disjoint irreducible components , one of which is the @xmath195 we started with .",
    "let @xmath459 be the other .",
    "then there is exactly one point of @xmath460 in each @xmath195 and @xmath461 .",
    "this contradicts the fact that @xmath195 has both points of @xmath460 .",
    "a similar argument shows that @xmath381 intersects the branch locus .",
    "we now make some definitions motivated by sections @xmath462 and @xmath463 . for @xmath208 , define @xmath464 let @xmath238 .",
    "define @xmath465      suppose @xmath238 is an even vertex .",
    "we define @xmath467 as follows .",
    "@xmath468 then , @xmath469 . we will now compute @xmath470 for each @xmath471 in terms of @xmath472 and @xmath473 .",
    "[ evenfirst ] suppose @xmath238 is even",
    ". then , @xmath474 .",
    "suppose @xmath181 is an even vertex .",
    "lemma  [ mult2 ] implies that @xmath312 for every @xmath316 and therefore , @xmath475    [ evenprelim ] suppose @xmath238 is even .",
    "let @xmath316 and @xmath211 .",
    "let @xmath476 and @xmath477 .    1 .",
    "the vertex @xmath303 is even and @xmath320 .",
    "2 .   the multiplicity @xmath400 if and only if @xmath192 is odd .",
    "3 .   if @xmath458 , then @xmath478 . if @xmath209 , then @xmath263 .",
    "in particular , @xmath479 .",
    "if @xmath480 and @xmath283 is even , then every neighbour of @xmath181 is even .",
    "the branch locus of @xmath184 intersects @xmath196 at @xmath481 points , and all these intersections are transverse .",
    "6 .   if @xmath482 , then @xmath196 does not intersect the branch locus of @xmath184 and @xmath292 . 7 .   if @xmath483 , then @xmath196 intersects the branch locus of @xmath184 , @xmath484 and @xmath485 .",
    "if @xmath192 is odd , then @xmath486 .",
    "suppose @xmath487 is odd .",
    "then there exists a unique @xmath488 such that @xmath489 . if @xmath338 , then @xmath490 . if @xmath491 , then @xmath492 .",
    "suppose @xmath483 , @xmath209 and @xmath192 is even .",
    "then , @xmath493 . if @xmath494 , then @xmath435 . if @xmath495 , then @xmath486 .",
    "suppose @xmath483 and @xmath338 is even . if @xmath488 , then @xmath490 .",
    "12 . if @xmath482 , then @xmath486 . 13 .",
    "suppose @xmath482 and @xmath338 is even . if @xmath496 , then @xmath490 . if @xmath497 , then , after possibly interchanging @xmath498 and @xmath499 , we have that @xmath500 and @xmath501 .    1 .",
    "since @xmath502 and @xmath181 is even , lemma  [ oddy ] tells us that @xmath303 is even . 2 .",
    "first assume @xmath192 is odd .",
    "since @xmath303 is even , lemma  [ neigh](b ) implies that @xmath503 is the preimage under @xmath184 of the strict transform of @xmath409 in @xmath92 .",
    "in particular , lemma  [ oddy ] tells us that @xmath378 is odd , and therefore not an even leaf .",
    "lemma  [ mult2 ] applied to @xmath504 then implies that @xmath400 .",
    "+ conversely , assume @xmath400 .",
    "lemma  [ mult2 ] applied to @xmath504 implies that @xmath192 is odd .",
    "if @xmath192 is odd , since @xmath181 is even , lemma  [ neigh](b ) tells us that @xmath213 is not a point .",
    "if @xmath192 is even , then @xmath213 is not a point . since @xmath181 is",
    "even , @xmath334 is not a point . since @xmath211 , either @xmath458 or @xmath209 .",
    "since both @xmath334 and @xmath213 are not points , lemma  [ adjacency](b ) tells us that in the first case @xmath478 and in the second case @xmath263 .",
    "both of these imply @xmath479 .",
    "4 .   suppose @xmath480 and @xmath283 is even .",
    "since @xmath181 is even and @xmath480 , lemma  [ oddeven ] implies that every child of @xmath181 is even .",
    "since @xmath283 is even , lemma  [ lmod2 ] implies that @xmath181 does not have an odd parent .",
    "therefore every neighbour of @xmath181 is even .",
    "lemma  [ branchlocus](a ) and lemma  [ oddy ] tell us that @xmath196 does not belong to the branch locus since @xmath323 , which is even .",
    "lemma  [ branchlocus](b ) tells us that any component of the branch locus that intersects @xmath196 , intersects it transversally . *",
    "lemma  [ branchlocus](a ) tells us that the components of the branch locus are the odd components of @xmath137 and the irreducible horizontal divisors appearing in @xmath111 different from @xmath505 . *",
    "lemma  [ oddy ] tells us that the odd components of @xmath137 are the strict transforms of odd components of @xmath144 . *",
    "since @xmath181 is even , the map @xmath185 induces an isomorphism above a neighbourhood of @xmath183 .",
    "+ therefore , the number of components of the branch locus intersecting @xmath196 is the number of odd neighbours of @xmath181 added to the number of horizontal divisors different from @xmath505 appearing in the divisor of @xmath111 that intersect @xmath183 .",
    "the latter number is @xmath506 .",
    "since @xmath181 is even , lemma  [ oddeven ] tells us that the number of odd children of @xmath181 is @xmath507 .",
    "lemma  [ lmod2 ] tells us that the number of odd parents of @xmath181 is @xmath508 . since @xmath509 , the branch locus intersects @xmath196 at @xmath510 points .",
    "suppose @xmath482 .",
    "then @xmath511 .",
    "part ( e ) tell us that @xmath196 does not intersect the branch locus of @xmath184 . since @xmath181 is even , lemma  [ invimgphi](b ) implies that @xmath292 . 7 .",
    "suppose @xmath483 .",
    "then @xmath512 .",
    "part ( e ) tells us that @xmath196 intersects the branch locus of @xmath184 .",
    "lemma  [ invimgphi](b ) then implies that @xmath484 .",
    "it follows that @xmath485 .",
    "suppose @xmath192 is odd .",
    "since @xmath192 is odd , lemma  [ intersect ] tells us that @xmath513 . on the other hand , since @xmath211 , it follows that @xmath514 .",
    "suppose @xmath487 is odd .",
    "let @xmath79 be the vertex corresponding to the strict transform of @xmath515 in @xmath92 . as @xmath487 and @xmath185 is an isomorphism above a neighbourhood of @xmath516",
    ", it follows that @xmath517 .",
    "in fact , this shows that if @xmath338 , then @xmath346 ; if @xmath491 , then @xmath365 .",
    "+ lemma  [ oddy ] shows that @xmath79 is odd .",
    "lemma  [ branchlocus](a ) and lemma  [ invimgphi](a ) applied to @xmath79 show that there is a unique @xmath518 in @xmath519 such that @xmath359 .",
    "part ( a ) tells us that @xmath303 is even and @xmath320 .",
    "since @xmath196 intersects @xmath324 and @xmath79 is odd , lemma  [ branchlocus](a ) and lemma  [ invimgphi](a ) applied to the even vertex @xmath303 tell us that @xmath520 .",
    "since @xmath521 and @xmath522 , it follows that @xmath523 .",
    "since @xmath184 is surjective and @xmath524 is nonempty , it follows that @xmath489 .",
    "we also have @xmath525 .",
    "this proves the existence of @xmath488 such that @xmath489 .",
    "+ suppose that we are given @xmath488 such that @xmath489 . since @xmath181 is even and @xmath104 is odd , lemma  [ neigh](b ) forces @xmath518 to be the inverse image under @xmath184 of the strict transform of @xmath515 in @xmath92 .",
    "this proves uniqueness .",
    "+ lemma  [ adjacency](a ) tells us that if @xmath492 , then @xmath365 . if @xmath338 , then @xmath346 and therefore @xmath490 .",
    "similarly , one can show that if @xmath491 , then @xmath492 .",
    "part ( g ) tells us that @xmath196 intersects the branch locus of @xmath184 . since @xmath192 is even , lemma  [ invimgphi](b ) implies that @xmath493 . since @xmath181 and @xmath192 are even , @xmath526 .",
    "since @xmath209 , lemma  [ intersect ] tells us that @xmath527 .",
    "we have that @xmath181 and @xmath192 are even , @xmath263 ( by ( c ) ) and that @xmath196 intersects the branch locus ; thus , lemma  [ intersect ] implies that @xmath435 if @xmath381 intersects the branch locus , and @xmath486 if it does not .",
    "lemma  [ invimgphi](b ) applied to @xmath192 tells us that this can be restated as follows : if @xmath494 , then @xmath435 ; if @xmath495 , then @xmath486 .",
    "let @xmath339 be the vertex corresponding to the strict transform of @xmath515 in @xmath92 .",
    "let @xmath488 . *",
    "part ( g ) tells us that @xmath196 intersects the branch locus of @xmath184 and @xmath485 .",
    "therefore @xmath522 . *",
    "since @xmath185 is an isomorphism above a neighbourhood of @xmath183 , we have that @xmath346 .",
    "in particular , @xmath528 . * the map @xmath184 restricts to a surjection @xmath529 . +",
    "these three facts together imply that @xmath530 is not empty .",
    "in particular , @xmath489 .",
    "if @xmath492 , then lemma  [ adjacency](a ) would imply @xmath365 .",
    "since @xmath346 , lemma  [ adjacency](a ) implies that @xmath490 .",
    "suppose @xmath482 .",
    "part ( f ) tells us that @xmath196 does not intersect the branch locus .",
    "lemma  [ intersect ] applied to the pair @xmath531 tells us @xmath513 . on the other hand , since @xmath211 , we have that @xmath514 .",
    "therefore , @xmath486 . 13 .",
    "let @xmath339 be the vertex corresponding to the strict transform of @xmath515 in @xmath92 .",
    "since @xmath185 is an isomorphism above a neighbourhood of @xmath183 , we get that @xmath346 .",
    "+ suppose @xmath496 . since @xmath521 and @xmath184 restricts to a surjection @xmath532 , an appropriate modification of the argument in part(j ) tells us that @xmath490 .",
    "+ suppose @xmath497",
    ". then , lemma  [ invimgphi](a ) implies that @xmath324 does not intersect the branch locus .",
    "part ( f ) implies that @xmath196 does not intersect the branch locus .",
    "this implies that the map @xmath184 is tale above a neighbourhood of @xmath533 .",
    "since @xmath152 has no connected tale covers , this implies that @xmath534 has two connected components , each of which maps isomorphically on to @xmath533 via @xmath184 .",
    "this finishes the proof .",
    "[ evensecond ] suppose @xmath238 is even .",
    "then , @xmath535 .",
    "( here and subsequently @xmath536 is an integer in @xmath537 .",
    "it is @xmath221 if @xmath283 is even and @xmath110 if @xmath283 is odd . )",
    "suppose @xmath238 is even .",
    "we break up the computation of @xmath538 into two cases :    @xmath539    in this case , @xmath540    @xmath541    in this case , lemma  [ evenprelim](g ) implies that @xmath484 .",
    "let @xmath485 .",
    "then , @xmath542    [ eventhird ] suppose @xmath238 is even .",
    "then , @xmath543 .",
    "we break up the computation of @xmath544 into two cases :    @xmath539    in this case , lemma  [ evenprelim](f ) tells us that @xmath292 . since @xmath506 and @xmath507 are nonnegative , @xmath480",
    "then ,    @xmath545    @xmath541    in this case , lemma  [ evenprelim](g ) implies that @xmath484 .",
    "let @xmath546 .",
    "then ,    @xmath547    [ eventotal ] suppose @xmath238 is even .",
    "then , @xmath548    combine lemmas  [ evenfirst ] ,  [ evensecond ] and  [ eventhird ] .",
    "suppose @xmath238 is odd .",
    "let @xmath549 denote the partition of @xmath293 constructed in lemma  [ invimgphi](c ) .",
    "[ oddprelim ] suppose @xmath238 is odd .",
    "let @xmath550 and @xmath477 .    1 .",
    "the component @xmath196 is the strict transform of @xmath183 in @xmath92 and @xmath303 is odd .",
    "the image @xmath334 is not a point .",
    "we have that @xmath551 we also have that @xmath552 .",
    "3 .   if @xmath458 and @xmath400 , then @xmath553 and @xmath192 is odd .",
    "if @xmath554 is odd , there exists a unique @xmath555 such that @xmath492 .",
    "the map @xmath386 induces a bijection between the sets @xmath556 and @xmath557",
    "we have that @xmath486 .    1 .   since @xmath558 and @xmath559",
    ", it follows from lemma  [ invimgphi](c)(ii ) that @xmath196 is the strict transform of @xmath183 in @xmath92 . since @xmath197",
    ", it follows that @xmath560 . therefore @xmath334 is not a point .",
    "lemma  [ invimgphi](c)(ii ) also implies that @xmath303 is odd .",
    "2 .   suppose @xmath209 and @xmath400 .",
    "let @xmath434 .",
    "since @xmath209 , lemma  [ adjacency](a ) implies that @xmath561 . since odd components of @xmath92",
    "do not intersect and ( a ) implies that @xmath303 is odd , @xmath378 is even .",
    "since @xmath400 , lemma  [ mult2 ] tells us that @xmath192 is odd and @xmath378 is not an even leaf of @xmath179 .",
    "let @xmath562 be the partition of @xmath563 as in lemma  [ invimgphi](c ) .",
    "since @xmath378 is even , lemma  [ oddy ] tells us that @xmath564 . since @xmath378 is not an even leaf of @xmath179 , the displayed equation in the proof of lemma  [ mult2 ] shows that @xmath565 . since @xmath565 , lemma  [ invimgphi](c)(vii ) shows that @xmath566 . since @xmath561",
    ", it follows that @xmath567 and therefore @xmath568 , which implies that @xmath569 .",
    "finally , @xmath570 .",
    "+ conversely , suppose @xmath571 .",
    "since @xmath558 , lemma  [ invimgphi](c)(i , vii ) show that @xmath209 and @xmath400 .",
    "lemma  [ invimgphi](c)(iii ) implies that @xmath552 .",
    "3 .   suppose @xmath458 and @xmath400 .",
    "since @xmath458 and @xmath334 is not a point by ( a ) , lemma  [ adjacency](b ) tells us that @xmath478 .",
    "since @xmath400 , lemma  [ mult2 ] tells us that @xmath192 is odd .",
    "4 .   suppose @xmath554 is odd .",
    "let @xmath572 .",
    "let @xmath562 be the partition of @xmath573 as in lemma  [ invimgphi](c ) .",
    "let @xmath309 be the unique vertex such that @xmath574 .",
    "since ( a ) implies that @xmath196 is the strict transform of @xmath183 in @xmath92 , the proof of lemma  [ invimgphi](c)(iii ) in the case of the odd vertex @xmath104 shows that @xmath365 .",
    "lemma  [ invimgphi](c ) applied to the odd vertex @xmath104 tells us that @xmath314 induces a bijection between @xmath575 and @xmath573 .",
    "this shows that there exists a unique @xmath392 such that @xmath359 .",
    "since @xmath303 is odd by ( a ) , lemma  [ invimgphi](a ) and lemma  [ branchlocus](a ) then imply that @xmath522 . since @xmath576 , it follows that @xmath521",
    ". therefore , @xmath577 .",
    "this implies that either @xmath578 , or @xmath492 .",
    "since @xmath365 , lemma  [ adjacency](a ) implies that @xmath492 .",
    "this proves the existence of @xmath518 .",
    "+ suppose @xmath488 be such that such that @xmath492 .",
    "then , lemma  [ adjacency](a ) implies that @xmath579 .",
    "since @xmath303 is odd ( by ( a ) ) and @xmath580 intersects @xmath196 , lemma  [ branchlocus](a ) and lemma  [ invimgphi](a ) imply that @xmath581 .",
    "this proves uniqueness of @xmath488 such that @xmath492 .",
    "suppose @xmath582 and @xmath583 .",
    "we will first show @xmath213 is not a point .",
    "suppose @xmath213 is a point .",
    "since @xmath209 , lemma  [ adjacency](b ) implies that @xmath584 . since @xmath583 , lemma  [ invimgphi](c)(i ,",
    "ii , iii ) then imply that @xmath585 , which is a contradiction . therefore , @xmath213 is not a point .",
    "lemma  [ adjacency](a ) then implies that @xmath263 .",
    "+ suppose @xmath192 is odd .",
    "let @xmath434 . since @xmath213 is not a point , @xmath586 .",
    "part ( a ) applied to @xmath504 implies that @xmath378 is odd . part ( a ) implies that @xmath303 is odd .",
    "since @xmath209 , lemma  [ adjacency](a ) implies that @xmath561 .",
    "this is a contradiction since odd components of @xmath92 can not intersect .",
    "therefore @xmath192 is even .",
    "this shows one inclusion .",
    "+ now suppose @xmath338 is even .",
    "let @xmath339 be the vertex corresponding to the strict transform of @xmath515 in @xmath92 .",
    "part ( a ) implies that @xmath303 is the vertex corresponding to the strict transform of @xmath183 and @xmath303 is odd .",
    "lemma  [ oddy ] implies that @xmath79 is even .",
    "this in turn implies that @xmath185 is an isomorphism above a neighbourhood of @xmath587 , and therefore @xmath346 .",
    "since @xmath303 is odd and @xmath346 , lemma  [ invimgphi](b ) applied to @xmath104 implies that @xmath588 .",
    "let @xmath589 .",
    "since @xmath522 and @xmath521 , it follows that @xmath590 is not empty .",
    "in particular , @xmath489 .",
    "since @xmath591 , lemma  [ adjacency](a ) implies that @xmath490 .",
    "this shows the opposite inclusion .",
    "since @xmath417 is odd , lemma  [ intersect ] tells us that @xmath592 . on the other hand , since @xmath211 , we have that @xmath514 .",
    "we will now compute @xmath593 for each @xmath471 , in terms of @xmath472 and @xmath473 .",
    "[ odd0 ] suppose @xmath238 is odd .",
    "then @xmath594    let @xmath595 and @xmath596 .",
    "lemma  [ invimgphi](c)(ii ) implies that @xmath597 .",
    "let @xmath598 .",
    "since @xmath431 consists of a single vertex @xmath599 , @xmath600 we will compute each of the three terms in this sum separately .    by lemma",
    "[ invimgphi](c)(ii ) , @xmath601    now @xmath602    now @xmath603    adding the three previous equalities gives us @xmath604    [ odd1 ] suppose @xmath238 is odd .",
    "then @xmath605    let @xmath606 .",
    "let @xmath599 be the unique element of @xmath607 .",
    "suppose @xmath307 .",
    "lemma  [ invimgphi](c)(iii , viii ) tells us that @xmath317 , @xmath608 , @xmath308 and @xmath609 for an odd @xmath338 .    since @xmath334 is a point that belongs to two odd components of @xmath144 , lemma  [ neigh](a)(i , ii ) tell us that @xmath610 and @xmath611 .",
    "suppose @xmath211 .",
    "lemma  [ neigh](a)(iii , iv ) tell us that @xmath399 is odd and @xmath400 .",
    "since @xmath399 is odd , lemma  [ intersect ] tells us that @xmath513 . on the other hand , since @xmath211 , we have that @xmath514 .",
    "this implies that @xmath612 therefore @xmath613    [ odd2 ] suppose @xmath238 is odd .",
    "then @xmath614    let @xmath596 and @xmath615 .",
    "suppose @xmath311 .",
    "lemma  [ invimgphi](c)(iv , viii ) tells us that @xmath317 , @xmath608 , @xmath312 and @xmath616 where @xmath63 is an irreducible horizontal divisor occuring in @xmath111 on @xmath135 .    since @xmath334 is a point that belongs to a unique odd component of @xmath144 , lemma  [ neigh](a)(i , ii )",
    "tell us that @xmath617 and @xmath618 . since @xmath608 , we have that @xmath619 .",
    "lemma  [ invimgphi](c)(ii ) implies that @xmath304 .",
    "since @xmath620 and @xmath621 ( @xmath622 ) is odd , lemma  [ intersect ] applied to the pair @xmath623 tells us that @xmath513 . on the other hand , since @xmath620 , we have that @xmath514 .",
    "this implies that @xmath624 therefore @xmath625    [ oddtotal ] suppose @xmath238 is odd ( in particular , @xmath181 is not the root ) .",
    "then @xmath626    combine lemmas  [ odd0],[odd1],[odd2 ] .",
    "[ localdel ] let @xmath238 .",
    "then @xmath627    this follows directly from lemma  [ eventotal ] and lemma  [ oddtotal ] .",
    "one might hope that the inequality @xmath628 holds for every vertex @xmath238 , but this is not true .",
    "it is however true after a slight alteration of the function @xmath119 .",
    "define a new function @xmath126 on @xmath629 as follows : @xmath630 for @xmath238 , set @xmath631 .",
    "using lemma  [ oddeven ] , we get @xmath632 we can use this , along with theorem  [ localdel ] to simplify the expression of @xmath633 .",
    "@xmath634    [ breakupeq ] the following equalities hold .",
    "@xmath635 @xmath636 @xmath637    the first equality can be rewritten as @xmath638 since the root is an even vertex , every odd vertex has a parent .",
    "this implies that @xmath639 we have that @xmath640 we have that @xmath641    [ newsum ] @xmath642    the sum of the left hand sides of the three equalities in lemma  [ breakupeq ] equals @xmath643 , which is therefore @xmath221 .    for an odd @xmath238 such that @xmath644 , let @xmath645 .",
    "define a new function @xmath646 on @xmath629 as follows : @xmath647    [ newnewsum ] @xmath648    for an odd leaf @xmath238 such that @xmath649 , let @xmath650 denote the least ancestor of @xmath181 such that @xmath651 ( here least ancestor means the ancestor farthest away from the root ) ; such an ancestor exists as the root has weight @xmath652 .",
    "if @xmath238 is odd and @xmath649 , then @xmath554 must also be odd by lemma  [ oddeven ] .",
    "a repeated application of this fact tells us that if @xmath181 is an odd leaf such that @xmath649 , then @xmath650 is odd .    for any vertex @xmath238 ,",
    "let @xmath239 denote the complete subtree of @xmath180 with root @xmath181 ( see section 8 for the definition of complete subtree ) .",
    "suppose @xmath181 is an odd vertex such that @xmath644 .",
    "we will now prove the following three claims .",
    "* if @xmath653 and @xmath654 , then @xmath104 is odd and @xmath655 . * if @xmath653 , then @xmath656 is a chain ( that is , every vertex in @xmath656 has at most one child ) .",
    "* if @xmath657 is an odd leaf such that @xmath658 and @xmath659 , then there exists a unique @xmath653 such that @xmath660 .",
    "suppose @xmath653 and @xmath654 .",
    "since @xmath654 , the definition of the function @xmath661 tells us that @xmath662 . on the other hand , lemma  [ weight ] tells us that @xmath663 .",
    "therefore , @xmath655 . a repeated application of lemma  [ oddeven ] along the path from @xmath181 to @xmath104 tells us that @xmath104 is odd .",
    "this proves the first claim .",
    "suppose @xmath653 and @xmath654 .",
    "suppose @xmath664 are distinct .",
    "the first claim shows @xmath665 .",
    "the definition of @xmath661 then tells us that @xmath666 . since @xmath667 and @xmath668 ,",
    "this is a contradiction .",
    "therefore every vertex in @xmath239 has at most one child , and this proves the second claim .",
    "suppose @xmath657 is an odd leaf such that @xmath658 and @xmath659 .",
    "let @xmath192 be the greatest ancestor of @xmath303 such that @xmath667 ( here greatest ancestor means the ancestor closest to the root ) .",
    "then , @xmath669 .",
    "the definition of @xmath670 then implies @xmath671 .",
    "this implies that @xmath653 .",
    "if @xmath672 , then @xmath673 and @xmath674 have no vertices in common .",
    "this proves that every @xmath675 can belong to @xmath676 for at most one @xmath653 .",
    "this finishes the proof of the third claim .",
    "let @xmath677 .",
    "we will now use the claims above to show that there is a bijection @xmath678 .",
    "let @xmath653 .",
    "let @xmath303 be the unique leaf in the chain @xmath656 .",
    "then @xmath303 is an odd leaf and @xmath658 .",
    "furthermore , @xmath192 is an ancestor of @xmath303 such that @xmath679 and @xmath680 , which shows @xmath659 .",
    "set @xmath681 .",
    "the third claim shows that @xmath682 is a bijection .",
    "therefore @xmath683 .",
    "this implies that @xmath684 this tells us that @xmath685    [ weightls ]    1 .",
    "if @xmath238 , then @xmath686 2 .   if @xmath687 , then @xmath688 .    1 .",
    "suppose @xmath338 .",
    "lemma  [ weight ] tells us that @xmath663",
    ". if @xmath104 is of odd weight , then @xmath689 .",
    "therefore @xmath690 2 .   if @xmath687 , then @xmath691 and therefore @xmath692 .",
    "we are now ready to compare the two discriminants .",
    "we first compare the local contributions .",
    "[ localinequality ] if @xmath238 , then @xmath693 . if @xmath181 is even , then @xmath694 if and only if every even child of @xmath181 has weight @xmath39 .",
    "if @xmath181 is odd , then @xmath694 if and only if either @xmath649 or @xmath695 and @xmath181 has no even children .",
    "if @xmath238 is even , then @xmath696    from this , it follows that if @xmath181 is even , then @xmath694 if and only if the inequality above is actually an equality , that is , if and only if every even child of @xmath181 has weight @xmath39 .    from now on assume @xmath238 is odd .",
    "then @xmath697 where the first equality follows from lemma  [ formulaford ] and equation  [ formulaford ] .",
    "lemma  [ weight ] tells us that @xmath245 . we will handle vertices with @xmath649 and with @xmath698 separately .",
    "suppose @xmath649 .",
    "lemma  [ weightls](a ) implies that @xmath699 .",
    "this implies that @xmath480 .",
    "lemma  [ weightls](b ) implies that either    a.   @xmath700 and @xmath701 , or , b.   @xmath702 and @xmath703 .    in both cases , since @xmath480 and @xmath181 is odd , lemma  [ oddeven ] tells us that @xmath704 in case ( i ) , we have that @xmath181 is an odd leaf of weight @xmath39 and @xmath705 in case ( ii ) , we have that @xmath181 is not a leaf and @xmath649 and @xmath706    now suppose @xmath698 . by definition , @xmath707 .",
    "@xmath708    this implies that @xmath709    if @xmath181 is odd and @xmath694 , then either @xmath649 or @xmath695 and @xmath480 and @xmath710 . by lemma  [ oddeven ] , @xmath480 if and only if @xmath181 has no even children . since every child of @xmath181 has weight aleast @xmath39 and has weight bounded above by @xmath695 , lemma  [ oddeven ] tells us that @xmath711 .",
    "we are now ready to prove the main theorem .",
    "construct the proper regular model @xmath15 as above .",
    "let @xmath712 denote the number of irreducible components of the special fiber of @xmath15 and let @xmath713 be the number of components of the special fiber of the minimal proper regular model @xmath7 of @xmath0 .",
    "to prove @xmath50 , sum the inequality of lemma  [ localinequality ] over all vertices of @xmath180 and use lemmas  [ newsum ]  [ newnewsum ] .",
    "we have the equalities @xmath714 @xmath715 where @xmath49 is the conductor of the @xmath19-adic representation @xmath716 ( * ? ? ?",
    "* , proposition 1 ) .",
    "the minimal proper regular model can be obtained by blowing down some subset ( possibly empty ) of irreducible components of the special fiber of @xmath139 , so @xmath717 .    putting everything together , we get @xmath718    [ number ] let @xmath713 be the number of components of the special fiber of the minimal proper regular model of @xmath0 over @xmath3 .",
    "then , @xmath719    since the conductor @xmath49 is a nonnegative integer , @xmath720 .",
    "i would like to thank my advisor , bjorn poonen , for suggesting this problem to me .",
    "i would also like to thank him for several helpful conversations , for his careful reading of the manuscript and for all the suggestions for improving the exposition ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a hyperelliptic curve of genus @xmath1 over the fraction field @xmath2 of a discrete valuation ring @xmath3 . </S>",
    "<S> assume that the residue field @xmath4 of @xmath3 is perfect and that @xmath5 . </S>",
    "<S> assume that the weierstrass points of @xmath0 are @xmath2-rational . </S>",
    "<S> let @xmath6 . </S>",
    "<S> let @xmath7 be the minimal proper regular model of @xmath0 over @xmath8 . </S>",
    "<S> let @xmath9 denote the artin conductor of the @xmath8-scheme @xmath7 and let @xmath10 denote the minimal discriminant of @xmath0 . </S>",
    "<S> we prove that @xmath11 . as a corollary </S>",
    "<S> , we obtain that the number of components of the special fiber of @xmath7 is bounded above by @xmath12 . </S>"
  ]
}