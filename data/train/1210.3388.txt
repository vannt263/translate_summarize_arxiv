{
  "article_text": [
    "quantum computing can potentially solve a handful of otherwise intractable problems , such as factoring large integers  @xcite or simulating quantum physics  @xcite . though the number of applications with a known `` quantum speed - up '' is small , some are quite valuable , like the preceding examples .",
    "quantum computations depend on coherent entangled states which are very sensitive to noise , so fault - tolerant quantum computing addresses imperfections in physical hardware with error - correcting codes  @xcite , the most studied of which are stabilizer codes  @xcite . however , while quantum codes protect against noise , no code natively supports a universal set of transversal gates for simulating any quantum circuit  @xcite . to achieve universal quantum computing with error correction , bravyi and kitaev",
    "proposed a solution  @xcite that has received considerable attention : inject faulty `` magic states '' into the code , purify them using the error - corrected gates , then consume them to implement otherwise unavailable quantum circuits .",
    "these states are `` magic '' because it is possible to distill a subset of high - fidelity states from an ensemble of faulty states and because they enable universal fault - tolerant quantum computation .",
    "magic state distillation has been the subject of intense investigation in recent years .",
    "knill independently introduced a distillation procedure for @xmath9 , the ( + 1 ) eigenstate of the hadamard operation  @xcite , prior to the work by bravyi and kitaev  @xcite .",
    "reichardt showed that these protocols were equivalent and introduced an improvement which increased the threshold error rate  @xcite .",
    "more recently , meier  _ et al_. introduced a 10-to-2 distillation procedure based on a code with two encoded qubits  @xcite , and bravyi and haah introduced a ( @xmath10)-to-@xmath11 procedure using so - called triorthogonal codes with even @xmath11 encoded qubits  @xcite .",
    "the distillation procedures we develop herein continue this trend of using larger , multi - qubit codes .",
    "the relationship of magic - state distillation to other aspects of quantum information has also been an area of active study .",
    "fowler and devitt have proposed methods to reduce the size of distillation circuits when using topological quantum error correction  @xcite .",
    "magic - state distillation has been demonstrated experimentally in nmr  @xcite .",
    "additionally , distillation protocols for qudits have been proposed and analyzed  @xcite .    for a quantum state",
    ", we quantify the probability of it having an error using the infidelity @xmath12 , where @xmath13 is the fidelity between some mixed state @xmath14 and the ideal state @xmath15 .",
    "the initial @xmath9 states are prepared in a faulty manner before being injected into a fault - tolerant quantum code , and reichardt proved that the theoretical - limit infidelity for @xmath9 states to be distillable is about @xmath16  @xcite .",
    "campbell and browne examined further properties of mixed states that may be distilled  @xcite .",
    "the efficiency of distilling high - infidelity magic states to low infidelity is of great importance to fault - tolerant quantum computing .",
    "although magic states are the widely preferred method for achieving universality , distillation circuits are currently estimated to require the majority of resources in a quantum computer  @xcite .",
    "therefore , advances in distillation protocols are important steps toward making quantum computing possible .",
    "this paper presents two important , related results .",
    "first , we specify a family of @xmath17 $ ] calderbank - shor - steane ( css ) quantum stabilizer codes  @xcite known as `` @xmath18  codes '' with transversal hadamard operation , for even @xmath19 .",
    "a `` transversal '' quantum operation is one where a gate acting on a logical , encoded qubit is implemented by independent gates on each qubit in that code block ( see p. 483 of ref .",
    "the @xmath18  codes are dense , because the ratio of logical qubits to physical qubits @xmath20 as @xmath21 .",
    "second , we demonstrate that concatenated versions of @xmath18  codes allow for distillation of high - fidelity encoded magic states by consuming low - fidelity magic - state ancillas .",
    "we call this `` multilevel distillation , '' because each such protocol takes two types of magic - state inputs , which have different levels of infidelity and which are applied at different concatenation levels within the distillation circuit . multilevel protocols lead to the most efficient procedure for distilling magic states reported so far . for suitably small infidelity @xmath22 in each input magic state with independent errors , there exists a sequence of multilevel protocols that yields output magic states with infidelity @xmath1 and requires asymptotically @xmath2 input states per distilled output state .",
    "this efficiency comes close to the `` optimality '' bound conjectured in ref .",
    "@xcite . for the purposes of developing quantum devices",
    ", this result is useful for exposing limits for optimizing quantum error correction . while this result is interesting theoretically , we also numerically study the distillation efficiency for @xmath3 , which is of practical importance to fault - tolerant quantum computing .",
    "we find that multilevel distillation is superior to previously reported protocols when the final infidelity is below @xmath8 .    throughout this paper , we adopt the following notation for single - qubit pauli operators , for readability : @xmath23 , @xmath24 , and @xmath25 is the identity operator on a qubit",
    ". additionally , we use `` physical qubit '' to denote those qubits used to produce a quantum code , whereas `` logical qubits '' are the protected information inside the code , again for readability .",
    "it may be the case that physical qubits for one encoding level are themselves the logical qubits of another code , which is a standard technique of quantum code concatenation  @xcite .",
    "we define a family of css quantum codes which encode an even number @xmath11 logical qubits using @xmath26 physical qubits and possess a transversal hadamard operation , so we call them collectively `` @xmath18  codes '' and denote @xmath27 as the code using @xmath28 physical qubits",
    ". any @xmath18  code may be defined as follows .",
    "the stabilizer generators are @xmath29 , @xmath30 , @xmath31 , @xmath32 , where subscripts index over physical qubits and tensor product between pauli operators is implicit .",
    "the logical pauli operators ( corresponding to logical qubits ) , denoted with an over bar and indexed by @xmath33 , are @xmath34 and @xmath35 .",
    "the hadamard transform exchanges ` x ` and ` z ` operators , so application of transversal hadamard gates at the physical level enacts a transversal hadamard operation at the logical level , which will be a useful property when we later concatenate these codes .",
    "all @xmath18  codes have distance two , which means they can detect a single physical pauli error . the product of two logical pauli operators of the same type for two distinct logical qubits has weight two ( number of non - identity physical , single - qubit pauli operators ) ; the product of same - type pauli operators on all logical qubits is also weight - two at the physical level .",
    "the stabilizers come in matched ` x`/`z ` pairs , so there are no weight - one logical operators .    the @xmath36  eigenstate @xmath37 of the hadamard operator @xmath38 is a magic state for universal quantum computing  @xcite . in particular ,",
    "two of these magic states can be consumed to implement a controlled-@xmath39 operation  @xcite , enabling one to measure in the basis of @xmath39 ( see fig .",
    "[ had_distill_figure]a ) .",
    "our distillation procedure is as follows : ( a )  encode faulty @xmath9 magic states in an @xmath18  code ; ( b )  measure in the basis of the transversal hadamard gate by consuming @xmath9 ancillas ; ( c )  reject the output states if either the measure - hadamard or code - stabilizer circuits detect an error .",
    "for example , when an @xmath40  code is used for distillation , @xmath11 @xmath9 states are encoded as logical qubits using @xmath26 physical qubits .",
    "each transversal controlled - hadamard gate consumes two @xmath9 states  @xcite , and this gate is applied to all physical qubits , which results in the @xmath41-to-@xmath11 input / output distillation efficiency of these codes .",
    "a diagram of the quantum circuit for distillation using @xmath42 is shown in fig .  [ had_distill_figure]b .",
    "magic states using an @xmath18  code . *",
    "( a ) *  controlled - hadamard gate is constructed using @xmath43 and its inverse , each of which requires one @xmath9 state  @xcite . *",
    "( b ) *  initial @xmath9 states ( left ) are encoded with four additional qubits , initialized to @xmath44 here .",
    "the boxes `` encode '' and `` decode '' represent quantum circuits for encoding and decoding , which are not shown here.,title=\"fig:\",width=313 ] +",
    "multilevel distillation uses concatenated codes with transversal hadamard for distillation , in such a manner that the protocol takes as input magic states at two different levels of infidelity , and the two types of magic states enter at different concatenation levels in the code .",
    "the @xmath9 ancillas consumed for transveral controlled - hadamard measurement are of lower fidelity than the encoded logical @xmath9 states being distilled .",
    "when two quantum codes with transversal hadamard are concatenated , the resulting code also has transversal hadamard . under appropriate conditions , the distance of the concatenated code is the product of the distances for the individual codes : @xmath45  @xcite .",
    "thus the concatenation of two @xmath18  codes yields a distance-4 code with transversal hadamard , and @xmath46-level concatenation has distance @xmath47 .",
    "the concatenation conditions for @xmath18  codes are that , through all levels of concatenation , any pair of physical qubits have at most one encoding block ( at any level ) in common .",
    "the reasons for this restriction are that logical errors in the same block are correlated and that the statement above that distance multiplies through concatenation assumes independence of errors , so two qubits from the same encoding block can never be paired again in a different encoding block .",
    "the required arrangement of qubits can be given a geometric interpretation .",
    "arrange all physical qubits at points on a cartesian grid in the shape of a rectangular solid , with the number of dimensions given by the number of levels of concatenation .",
    "a square , cube , or hypercube are possible examples at dimensionality two , three , or four .",
    "each dimension is associated with a level of concatenation , and there must be an even @xmath19 qubits in each dimension to form an @xmath18  code . construct @xmath18  codes in the first dimension by forming an encoding block with each line of qubits in this direction , as in fig .",
    "[ h_code_concatenation]a .",
    "this will give rise to @xmath48 logical qubits along each line in this direction .",
    "repeat this procedure by grouping these first - level logical qubits in lines along the second dimension to form logical qubits in a two - level concatenated code , as in fig .",
    "[ h_code_concatenation]b .",
    "continuing in this fashion through all dimensions ensures that any pair of qubits have at most one encoding block in common",
    ".    codes . *",
    "( a ) * six physical qubits are coupled into an @xmath42  code with two logical qubits * ( b ) * a @xmath49 array of physical qubits are coupled into a concatenated two - level @xmath42  code.,title=\"fig:\",width=313 ] +    as with the @xmath18  codes , multilevel codes use a transversal logical hadamard - basis measurement to detect whether any one encoded qubit has an error ( an even number of encoded errors would not be detected ) .",
    "if the logical @xmath9 states have independent error probabilities @xmath50 , then the distilled states will have infidelity @xmath51 with perfect distillation .",
    "we must also consider whether the hadamard - basis measurement has an error .",
    "for a two - level code arranged as a square of side length @xmath52 , the transversal controlled - hadamard gates at the lowest physical level require @xmath53 @xmath9 magic states , each of which has infidelity @xmath54 . however , this is a distance-4 code , so for independent input error rates , the probability of failing to detect errors at the physical level is @xmath55 ( rigorous analysis is provided later )",
    ". the code can detect more errors in the magic states at the lower physical level , so these @xmath9 states can be of lower fidelity than the magic states encoded as logical qubits and successfully perform distillation .",
    "this is the essential distinction between multilevel distillation and all prior distillation protocols .",
    "when multiple rounds of distillation are required  @xcite , low - fidelity magic states are less expensive to produce , so multilevel protocols achieve higher efficiency .",
    "multilevel distillation protocols are applied in rounds , beginning with a small protocol ( such as an @xmath18  code ) and progressing to concatenated multilevel codes .",
    "let us denote the output infidelity from a single round by the function @xmath56 .",
    "for each such function , @xmath57 is the dimensionality ( number of levels of concatenation ) and @xmath58 are the sizes of each dimension , which need not all be the same . as before ,",
    "@xmath50 and @xmath54 refer to the independent error probabilities on logical and physical magic states , respectively . a typical progression of rounds using a source of @xmath9 states with infidelity @xmath59 might be @xmath60 , @xmath61 , _",
    "etc_.    multilevel distillation circuits tend to be much larger in both qubits and gates than other protocols . because there can be many encoded qubits",
    ", the protocol is still very efficient , but the size of the overall circuit may be a concern for some quantum computing architectures . at any number of levels , the distilled output states have correlated errors , so distilled magic - state qubits in our protocol must never meet again in a subsequent distillation circuit ( we require that errors are independent within the same encoding block , as in refs .",
    "let us suppose that one performs two rounds of distillation , where the first round uses one - level distillers with @xmath11 encoded magic states and the second round uses two - level distillers with @xmath62 encoded states . because the inputs to each distiller in the second round must have independent errors , there must be @xmath62 independent distillation blocks in the first round .",
    "therefore , to distill @xmath63 output states through two rounds , we require : @xmath64 + 2k^2(k+4 ) [ \\textrm{physical inputs } ] + 2k(k+4)^2 [ \\textrm{physical inputs } ] = 5k^3 + 24k^2 + 32k$ ] input states .",
    "consider a similar sequence through @xmath46 rounds with each distiller in round @xmath65 having @xmath66 encoded qubits .",
    "the total number of _ logical _ magic states is @xmath67 to ensure that errors are independent between logical magic states in every round . in the first round ,",
    "the number of consumed magic states is @xmath68 ; in any subsequent round @xmath69 , the number of consumed magic states is @xmath70 ( recall that the hadamard measurement is implemented @xmath71 times , meaning it is repeated for @xmath72 ) .",
    "the total number of input magic states can thus be expressed as @xmath73 k^{r(r+1)/2}.\\ ] ] for @xmath74 , this reproduces the expression above .",
    "what also becomes clear is that the total size of multilevel protocols becomes unwieldy as @xmath46 and @xmath11 increase .",
    "for example , the case of @xmath75 and @xmath76 would require about @xmath77 input magic states and a comparable number of quantum gates to distill @xmath78 output magic states . however , since efficient multilevel distillation protocols , measured in the ratio of low - fidelity @xmath9 input states consumed to yield a single high - fidelity @xmath9 output , use @xmath79 and multiple rounds , the greatest benefit from their application is seen in large - scale quantum computing , where a typical algorithm run may require @xmath80 magic states , each with error probability @xmath81  @xcite .",
    "moreover , alternative designs can circumvent these issues .",
    "if the first round uses a different protocol without correlated errors across logical magic states , such as bravyi - kitaev 15-to-1 distillation , then having multiple distillation blocks is unnecessary in the second round using a two - level concatenated protocol , which would lead to smaller multi - round , multilevel protocols .",
    "indeed , sec .",
    "[ analysis_section ] shows that optimal protocols found by numerical search happen to take this approach .",
    "the `` scaling exponent '' @xmath82 of a distillation protocol characterizes its efficiency .",
    "specifically , @xmath83 input states are required to distill one magic state of infidelity @xmath4 .",
    "scaling exponents for previous protocols are @xmath84 ( `` 15-to-1 ''  @xcite ) , @xmath85 ( `` 10-to-2 ''  @xcite ) , and @xmath86 ( triorthogonal codes  @xcite ) .",
    "moreover , bravyi and haah conjecture that no magic - state distillation protocol has @xmath87  @xcite . in this work , if each round of distillation uses one higher level of concatenation in the multilevel protocols , then the number of consumed inputs doubles . in the limits of @xmath88 , @xmath0 , multilevel protocols require @xmath89 input states to each output state for @xmath46 rounds of distillation , where the @xmath90 round is a level-@xmath46 distiller .",
    "the final infidelity is @xmath91 , so the scaling exponent is @xmath92 as @xmath93 , which is the closest any protocol has come to reaching the conjectured bound .",
    "we show later through numerical simulation that @xmath94 for error rates relevant to quantum computing .",
    "we make the conventional assumption that all quantum circuit operations are perfect , except for the initial @xmath9 magic states we intend to distill .",
    "this is a valid approximation if all operations are performed using fault - tolerant quantum error correction where the logical gate error is far below the final infidelity for distilled magic states  @xcite ; for a more explicit construction of fault - tolerant distillation circuits , see ref .",
    "@xcite . additionally , following the methodology in refs .",
    "@xcite , we can consider each magic state with infidelity @xmath22 as the mixed state @xmath95 , where @xmath96 is the @xmath97 eigenstate of the hadamard operation .",
    "determining the infidelity at the output of distillation becomes simply a matter of counting the distinct ways that errors lead to the circuit incorrectly accepting faulty states .",
    "this process is aided by the geometric picture from earlier , and details are given in appendix  [ analysis_appendix ] .",
    "it is essential that error probabilities @xmath50 and @xmath54 for each input magic state are independent .",
    "then a one - level , @xmath41-to-@xmath11 distiller using the @xmath40 code has output error rate on each @xmath9 state as @xmath98 where higher order terms denoted ( ... ) are omitted .",
    "our numerical results justify the use of lowest - order approximations as higher - order terms are negligible in optimally efficient protocols .",
    "the lowest - order error rates are both second order , because the hadamard basis measurement and @xmath40 code can together detect a single error in any magic state .",
    "the probability of the distiller detecting an error , in which case the output is discarded , is @xmath99 . if @xmath100 , then the output error rate of @xmath101 conditioned on success is the same as in ref .",
    "@xcite . using the two - level distiller constructed from concatenated @xmath40 codes ,",
    "the output infidelity for each distilled @xmath9 state is @xmath102 the probability of the two - level distiller detecting an error is @xmath103 .",
    "similar error suppression extends to higher multilevel protocols , as examined in appendix  [ analysis_appendix ] .",
    "states with @xmath3 consumed to produce a single output @xmath9 state with fidelity @xmath4 .",
    "multiple - round distillation can use different protocols in each round , and the markers indicate just the last round of distillation .",
    "the grey - shaded squares , triangles , and circles show , respectively , the best distillation possible with only  @xcite ,  @xcite , and triorthogonal - code  @xcite protocols . the dashed line is a linear fit @xmath7.,title=\"fig:\",width=313 ] +    figure  [ protocols_plot ] shows the performance of optimal multi - round distillation protocols identified by numerical search , indicating the number of input states with @xmath104 required to reach a desired output infidelity @xmath4 .",
    "the markers indicate the type of protocol in the last round of distillation , including bravyi - kitaev  @xcite , meier - eastin - knill  @xcite , and multilevel @xmath18  codes ( see appendix  [ numerical_appendix ] for details ) .",
    "the search attempts to identify the best distillation routines using any combination of known methods . note that the recent bravyi - haah protocols  @xcite have the same performance as one - level @xmath18  codes . as expected , there is a trend of using higher - distance multilevel protocols in the last round as the output error rate @xmath4 decreases ( earlier rounds may use different protocols ) . where present , open markers indicate the best possible performance of previously studied protocols without the advent of multilevel distillation , and multilevel distillation is dominant for @xmath105 , which is the regime pertinent to quantum computing .",
    "moreover , in this regime , input error rates are sufficiently small that only lowest - order terms in the @xmath106 output - error functions are significant .",
    "the linear fit provides empirical evidence that the scaling exponent is @xmath94 in this regime , which demonstrates that multilevel protocols are close to the conjectured optimal performance in practice .",
    "@xmath18  codes can distill magic states for @xmath107 , which may enable distillation of three - qubit magic states for controlled - controlled-`z ` , which is locally equivalent to the toffoli gate  @xcite ( see appendices  [ t_appendix ] and  [ toffoli_appendix ] for details ) . as a first pass at studying distillation protocols ,",
    "this work considered only average input - to - output efficiency .",
    "future work will more rigorously examine to entire costs in qubits and gates required to fault - tolerantly distill magic states using multilevel codes  @xcite .",
    "multilevel distillation is an important development for large - scale , fault - tolerant quantum computing , where the distillation of magic states is often considered the most costly subroutine  @xcite . other codes with high density , high distance , and transversal hadamard may yet be discovered , though for the present , @xmath18  codes are useful for their high efficiency and simple construction .",
    "the author would like to thank sergey bravyi and bryan eastin for assistance in analyzing protocols at levels three and higher .",
    "this work was supported by the univ .",
    "of tokyo special coordination funds for promoting science and technology , nict , and the japan society for the promotion of science ( jsps ) through its first program .",
    "23ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) link:\\doibase 10.1126/science.273.5278.1073 [ * * ,   ( ) ] @noop * * ,   ( ) @noop _ _ ,  ed .",
    "( ,  ) _ _ ,  @noop ph.d . thesis ,   ( ) link:\\doibase 10.1109/tit.2011.2161917 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.102.110502 [ * * , ( ) ] link:\\doibase 10.1103/physreva.71.022316 [ * * ,   ( ) ] @noop `` , ''   ( ) , @noop * * ,   ( ) @noop `` , ''   ( ) ,   link:\\doibase 10.1103/physreva.86.052329 [ * * ,   ( ) ] @noop `` , ''   ( ) ,   @noop * * ,   ( ) link:\\doibase 10.1103/physrevx.2.041021 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.104.030503 [ * * ,   ( ) ] in  @noop _ _  ( ) link:\\doibase 10.1103/physrevx.2.031007 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.54.1098 [ * * , ( ) ] link:\\doibase 10.1098/rspa.1996.0136 [ * * ,   ( ) ] @noop `` , ''   ( ) ,   @noop `` , ''   ( ) ,",
    "the multilevel codes analyzed here use concatenated @xmath18  codes . when two @xmath18  codes are concatenated , the logical qubits of the first level of encoding are used as physical qubits for completely distinct codes at the second level .",
    "consider a two - level scheme : if the codes at first and second levels are @xmath108 $ ] and @xmath109 $ ] , respectively , then the concatenated code is @xmath110 $ ] , as shown in fig .",
    "2b of the main text .",
    "this process can be extended to higher levels of concatenation .",
    "determining the potential errors and their likelihood in multilevel protocols requires careful analysis .",
    "let us enumerate the error configurations which are detected by the protocols ; the error probability is given by summing the probability of all error configurations that are not detected and that lead to error(s ) in the encoded @xmath9 states .",
    "as a first step , we may simplify the analysis of multilevel codes by considering each input magic state to our quantum computer as having an independent probability of @xmath111 error , as discussed in refs .",
    "this allows us to consider only one type of error stemming from each magic state used in the protocol .    identifying undetected error events in multilevel distillation , which lead to output error rate ,",
    "is aided by the geometric picture introduced in the main text .",
    "qubits which will form the code are arranged in a rectangular solid , then grouped in lines along each dimension for encoding .",
    "there are two error - detecting steps which together implement distillation : the hadamard - basis measurement and the error detection of the @xmath18  codes .",
    "the hadamard measurement registers an error for odd parity in the total of encoded state errors and physical - level errors in the first round of @xmath112 gates , and there is one of these for each qubit site in the code ( see fig .  1 of the main text ) .",
    "the second method for @xmath18  codes to detect errors is by measuring the code stabilizers .",
    "the code stabilizers detect any configuration of errors which is not a logical operator in the concatenated code . because of the redundant structure using overlapping @xmath18  codes , only a very small fraction of error configurations evade detection . before moving on , note that at each qubit site , there are two faulty gates applied , and two errors on the same qubit will cancel ( however , the first error will propagate to the hadamard - basis measurement ) .",
    "conversely , a single error in one of the two gates will propagate to the stabilizer - measurement round , but only an error in the first gate will also propagate to the hadamard measurement .",
    "the stabilizer - measurement round will only `` see '' the odd / even parity of the number of errors at each qubit site .",
    "one type of error event that occurs at concatenation levels three and higher requires special treatment .",
    "if there is an error in an encoded magic state and errors on two physical states used for the same controlled - hadamard gate at the physical level , then this combination of input errors is not detected by the distillation protocol , leading to logical output error .",
    "this event leads to the @xmath113 error probability from the main text , which is not an issue for two - level protocols , but it must be addressed in levels three and higher .",
    "the solution for @xmath57-level distillation , where @xmath114 , is to repeat the controlled - hadamard measurement @xmath115 times , consuming @xmath116 magic states at the physical level . after each transversal controlled - hadamard , the code syndrome checks for detectable error patterns . with this procedure",
    ", one encoded - state error would also require at least @xmath116 errors in physical - level magic states to go undetected , leading to probability of error that scales as @xmath117 .",
    "consider the pattern of errors after the two potentially faulty gates on each qubit in the @xmath57-dimensional cartesian grid arrangement .",
    "the many levels of error checking in the @xmath18 codes can detect a single error in any encoding block at any encoding level .",
    "for this analysis , let us separate the @xmath26 qubits in a single @xmath18  code block into two groups : the first four qubits are `` preamble '' qubits , while the remaining @xmath11 qubits are index qubits .",
    "the reason for distinction is that the logical @xmath118 operators , which would also be undetected error configurations , have common physical - qubit operators in the preamble , with a degeneracy of two : @xmath119 , because of the stabilizer @xmath120 .",
    "conversely , the logical operators are distinguished by the @xmath121 logical pauli operator having a physical pauli operator on the @xmath121 index qubit ( numbered @xmath122 when preamble is included ) .    with the preamble / index distinction , we can now identify the most likely error patterns . for any size @xmath18  code",
    ", there are two weight-2 errors in the preamble : @xmath123 and @xmath124 .",
    "logically , these represent the product of @xmath125 operators on all encoded qubits . in the index qubits ,",
    "any pair of errors is logical : @xmath126 .",
    "however , a pair of errors split with one each in preamble and index is always detectable by the code stabilizers .",
    "thus , any single encoded qubit could have a logical error stemming from a pair of errors in two different configurations in the preamble or @xmath127 configurations in the index qubits .",
    "there is also one weight - three error .",
    "each physical - state error configuration is multiplied by a degeneracy factor that is the number of ways an even number of errors occur before the ` cnot ` in fig .  1 , thereby evading the hadamard measurement . thus the probability of logical error is @xmath128 .",
    "the hadamard measurement fails to detect an even number of errors in the logical input states .",
    "there are @xmath127 ways that a pair of encoded input errors could corrupt any given qubit and @xmath129 ways four errors could corrupt any given qubit ( assuming @xmath130 ) .",
    "this contributes error terms @xmath131 .",
    "finally , it is possible for a single logical error and an odd number of physical errors before the ` cnot ` in fig .  1 of the main text , potentially in conjunction with other physical errors after `",
    "cnot ` , to occur simultaneously in a way that evades both checks .",
    "this contributes a term @xmath132 .    the numerical analysis detailed below shows that efficient use of one - level @xmath18  codes has similar error rates for @xmath50 and @xmath54 , and both are below 0.01 , so the relevant terms in the error functions for one - level @xmath18  codes are @xmath133 , which reproduces eqn .",
    "( 1 ) of the main text . as a result",
    ", the higher - order terms above can be neglected for this range of parameters so long as @xmath11 is not too large .",
    "simply put , if the higher terms become relevant ( _ i.e. _ @xmath50 , @xmath54 , or @xmath11 is sufficiently large in magnitude ) , then the distillation protocol is being used ineffectively , and it may in fact cause more errors than it corrects .",
    "these findings are supported by the numerical search for optimal protocols , and we proceed using this approximation .",
    "when @xmath18  codes are concatenated , the analysis of undetected error patterns becomes more complicated .",
    "in particular , logical errors from one layer of encoding must be `` matched '' with errors from other encoding blocks to go undetected at the next level .",
    "consider the case of the level - two - concatenated , square - array distiller , and focus on one of the encoded states .",
    "as before , a pair of encoded - state input errors evades the hadamard measurement , which contributes a term @xmath134 .",
    "the undetected errors resulting from consumed magic states are more complicated . within the upper encoding block ,",
    "there are two ways a logical error could be caused by a pair of errors in the preamble , and @xmath127 possibilities for logical error from a pair of index errors .",
    "however , each of the inputs to the second level are the logical qubits of distinct @xmath18  codes at the first level , which has additional error detection .",
    "the most likely errors from the first level come in pairs , but these pairs are sent to different codes at the second level . as a result",
    ", the error patterns from the first level must come in `` matched '' pairs that are also not detected at the second level .",
    "for any particular error configuration going into a block at the second level , there are four preamble configurations and @xmath127 index configurations at the first level that could have caused it .",
    "there are @xmath135 undetected error configurations at the second level , and the degeneracy factor of four physical errors is eight , so the consumed magic states contribute a term @xmath136 . finally , the most likely way that physical and encoded errors can occur in conjunction is a logical error on the magic state in question and two physical errors on the same qubit anywhere , which has probability @xmath137 .",
    "combined , these error terms reproduce the results in eqn .",
    "( 2 ) : @xmath138 .",
    "we drop terms at higher order because they are found to be negligible in optimal protocols .",
    "for example , the first optimal two - level protocol has parameters @xmath139 , @xmath140 , and @xmath141 , where both input types come from earlier rounds of distillation ( bravyi - kitaev and meier - eastin - knill , respectively ) .",
    "more details of the numerical search are given below .",
    "continuing this approach , one can show the significant error terms at level @xmath114 are given by @xmath142 these terms incorporate degeneracy in error configurations and repeated hadamard measurements .",
    "the coefficients of the second and third terms on the rhs of eqn .",
    "( 1 ) represent physical error configurations and encoded / physical combinations , respectively , and these grow rapidly as a function of @xmath46 .",
    "accordingly , the optimal - protocol search does not advocate the use of three - level protocols until the desired output error rate is below @xmath143 , which is beyond the needs of any quantum algorithm so far conceived .",
    "no four - level protocols were found to be optimal for output error rates above @xmath6 , which under practical considerations means they are not likely to ever be used .",
    "the next section considers the size of multilevel distillation circuits , which can also limit their usefulness .",
    "the claimed efficiency of multilevel distillation was examined quantitatively with a numerical search for optimal multi - round distillation protocols .",
    "each of the protocols is optimal in the sense that , for a given final infidelity @xmath4 , no other sequence requires fewer average input states , and , for a given average number of input states , no other protocol achieves lower @xmath4 .",
    "note that probability of rejection upon detected error is incorporated by considering average cost for distillation when failure - and - repeat steps are included .",
    "the protocols plotted in fig",
    ".  [ protocols_plot ] of the main text are just the last round of a distillation sequence .",
    "earlier rounds can be , and usually are , different protocols .",
    "the search space was constrained such that the number of rounds @xmath144 , number of encoded logical qubits @xmath145 for all @xmath18  codes , and multilevel codes are square @xmath146 , _ etc .",
    "_    generally speaking , smaller protocols handle large input error rates in early rounds better , while larger multilevel protocols are more inefficient at distillation when input error rates are low enough .",
    "for example , the protocols listed in table  [ optimal_protocols_table ] are the same ones plotted in fig .",
    "[ protocols_plot ] .",
    "note that when @xmath4 is smaller than @xmath8 , multilevel protocols are most efficient .",
    "should one desire @xmath147 , level - three protocols have the highest efficiency .",
    "higher levels of concatenation ( up to level five ) were part of the search , but they were not efficient for @xmath148 .",
    "the error - function notation @xmath106 from the main text is used to show how the inputs to later rounds of distillation may be the outputs of an earlier round .",
    "this notation neglects the total size of the distillers , which must be determined by using parallel distillation blocks whenever correlated errors on logical magic states are present .    for reference ,",
    "the best achievable results with prior protocols are also shown in table  [ optimal_protocols_table ] , in reverse chronological order of their discovery .",
    "the methods are cumulative , so the most recent bravyi - haah codes ( 2012 ) could also use meier - eastin - knill ( 2012 ) or bravyi - kitaev ( 2005 ) distillation , but the oldest bravyi - kitaev distillation is alone in its column .",
    "the best achievable results with older protocols are also shown in fig .",
    "[ protocols_plot ] for comparison .",
    "accordingly , the multilevel protocols can use any of the above protocols wherever the numerical search finds doing so to be optimally efficient .    the numerical simulation uses error functions @xmath106 for the bravyi - kitaev ( `` bk , ''  @xcite ) and meier - eastin - knill ( `` mek , ''  @xcite ) 10-to-2 protocols .",
    "the first three taylor - series terms of these functions near @xmath149 are : @xmath150 @xmath151 in the numerical search , @xmath152 , so the first term for each dominates .",
    "the bravyi - haah triorthogonal codes ( `` bh , ''  @xcite ) have the same error function as @xmath18  codes ( _ cf_. eqn .",
    "( 1 ) of the main text ) : @xmath153 this correspondence , combined with the results of reichardt  @xcite , suggests a connection between these code families .",
    "in addition to distilling hadamard states @xmath9 , @xmath18  codes can also distill the magic state , which is used to make the @xmath155 gate .",
    "this construction is useful by itself , but it can also be used to make toffoli magic states as shown in the next section .",
    "state @xmath156 is stabilized by the operator @xmath157 , which is also transversal in @xmath18 codes .",
    "distillation is performed by encoding @xmath156 states as logical qubits , then measuring the controlled-@xmath158 using @xmath156 states at the physical level , followed by routine error detection .",
    "a css quantum code  @xcite necessarily has a transversal ` cnot ` operation . a css code with transversal `",
    "t `  operation ( let us use the shorthand `` css+t '' ) will also have a transversal controlled - controlled-`z ` ( ccz ) operation , because the latter quantum gate can be decomposed into ` cnot ` and  ` t ` ( or @xmath159 ) , as shown in fig .",
    "[ ccz_circuit ] of this supplementary information .",
    "the ccz gate is locally equivalent to toffoli ( via hadamard transforms on the target qubit ) , so css+t codes can distill a magic state for the ccz gate , which is equivalent to distilling toffoli magic states ( see p.  488 of ref .",
    "@xcite ) , assuming clifford operations are freely available .",
    "@xmath160 & @xmath161 & protocol & @xmath162 & @xmath163 & @xmath164 & @xmath165 + 4 & 4.46 & @xmath166 & 17.44 & 17.44 & 17.44 & 17.44 + 5 & 5.14 & @xmath167 & 27.93 & 27.86 & 27.86 & 261.5 + 6 & 6.83 & @xmath168 & 56.07 & 56.07 & 83.99 & 261.5 + 7 & 7.11 & @xmath169 & 57.38 & 58.30 & 83.99 & 261.5 + 8 & 8.06 & @xmath170 & 67.52 & 89.26 & 139.3 & 261.5 + 9 & 9.08 & @xmath171 & 100.3 & 139.3 & 139.3 & 261.5 + 10 & 11.1 & @xmath172 & 110.7 & 179.4 & 261.7 & 261.5 + 11 & 11.1 & same as above & 110.7 & 179.4 & 261.7 & 261.5 + 12 & 12.1 & @xmath173 @xmath174 & 113.7 & 187.9 & 418.0 & 3923 .",
    "+ 13 & 13.0 & @xmath175 @xmath176 & 120.4 & 225.6 & 418.0 & 3923 .",
    "+ 14 & 14.1 & @xmath177 @xmath176 & 126.9 & 285.6 & 419.9 & 3923 .",
    "+ 15 & 15.0 & @xmath178 @xmath179 & 158.5 & 315.5 & 696.7 & 3923 .",
    "+ 16 & 16.3 & @xmath180 @xmath181 & 187.9 & 406.2 & 696.7 & 3923 .",
    "+ 17 & 17.0 & @xmath182 @xmath183 & 195.5 & 529.5 & 696.7 & 3923 .",
    "+ 18 & 18.0 & @xmath184 @xmath185 & 239.8 & 574.1 & 1260 . & 3923 .",
    "+ 19 & 19.5 & @xmath186 @xmath187 & 272.1 & 574.1 & 1260 . & 3923 .",
    "+ 20 & 20.0 & @xmath188 @xmath187 & 273.3 & 574.1 & 1260 . & 3923 .",
    "+ 21 & 21.6 & @xmath189 @xmath190 & 275.1 & 575.9 & 1260 . & 3923 .",
    "+ 22 & 22.0 & @xmath191 @xmath190 & 278.0 & 604.3 & 1308 . & 3923 .",
    "+ 23 & 23.3 & @xmath192 @xmath190 & 281.9 & 652.3 & 2090 . & 3923 .",
    "+ 24 & 24.2 & @xmath193 @xmath194 & 287.9 & 731.5 & 2090 . & 3923 .",
    "+ 25 & 25.1 & @xmath195 @xmath196 & 295.7 & 853.1 & 2090 . & 3923 .",
    "+ 26 & 26.1 & @xmath197 @xmath196 & 311.5 & 914.0 & 2090 . & 3923 .",
    "+ 27 & 27.1 & @xmath198 @xmath199 & 333.3 & 947.5 & 2100 . & 3923 .",
    "+ 28 & 28.1 & @xmath200 @xmath201 & 355.6 & 1015 . & 2181 . & 3923 .",
    "+ 29 & 29.3 & @xmath202 @xmath201 & 363.7 & 1125 . & 3483 . & 3923 .",
    "+ 30 & 30.7 & @xmath203 @xmath204 & 369.3 & 1301 .",
    "& 3483 . & 3923 .",
    "+ 31 & 31.0 & @xmath205 @xmath204 & 376.5 & & & 3923 .",
    "+ 32 & 32.4 & @xmath203 @xmath206 & 411.5 & & & 3923 .",
    "+ 33 & 33.0 & @xmath207 @xmath206 & 427.3 & & & 3923 .",
    "+ 34 & 35.2 & @xmath203 @xmath208 & 459.4 & & & 58838 .",
    "+ 35 & 35.2 & same as above & 459.4 & & & 58838 .",
    "+ 36 & 36.1 & @xmath209 @xmath210 & 470.8 & & & 58838 .",
    "+ 37 & 37.3 & @xmath211 @xmath212 & 471.0 & & & 58838 .",
    "+ 38 & 39.4 & @xmath213 @xmath212 & 472.6 & & & 58838 .",
    "+ 39 & 39.4 & same as above & 472.6 & & & 58838 ."
  ],
  "abstract_text": [
    "<S> we develop a procedure for distilling magic states used in universal quantum computing that requires substantially fewer initial resources than prior schemes . </S>",
    "<S> our distillation circuit is based on a family of concatenated quantum codes that possess a transversal hadamard operation , enabling each of these codes to distill the eigenstate of the hadamard operator . </S>",
    "<S> a crucial result of this design is that low - fidelity magic states can be consumed to purify other high - fidelity magic states to even higher fidelity , which we call `` multilevel distillation . '' when distilling in the asymptotic regime of infidelity @xmath0 for each input magic state , the number of input magic states consumed on average to yield an output state with infidelity @xmath1 approaches @xmath2 , which comes close to saturating the conjectured bound in [ phys . </S>",
    "<S> rev . </S>",
    "<S> a 86 , 052329 ] . </S>",
    "<S> we show numerically that there exist multilevel protocols such that the average number of magic states consumed to distill from error rate @xmath3 to @xmath4 in the range @xmath5 to @xmath6 is about @xmath7 ; the efficiency of multilevel distillation dominates all other reported protocols when distilling hadamard magic states from initial infidelity 0.01 to any final infidelity below @xmath8 . </S>",
    "<S> these methods are an important advance for magic - state distillation circuits in high - performance quantum computing , and they provide insight into the limitations of nearly resource - optimal quantum error correction . </S>"
  ]
}