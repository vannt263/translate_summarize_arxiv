{
  "article_text": [
    "the _ hierarchical reference theory _ of fluids ( ) pioneered by parola and reatto @xcite has been found well capable @xcite of describing structural and thermodynamic properties of fluids even in the vicinity of the critical point and for subcritical temperatures , yielding rigorously flat isotherms in the coexistence region ( thus eliminating the need for maxwell constructions ) and non - classical values for the critical exponents @xcite .",
    "still , adoption by a significant part of the liquid physics community of this renormalization group ( ) theoretical approach to the integral equation description of fluids has largely been lacking so far . while this may be partially attributed to s inherent difficulties and rather high computational cost , lack of an easy to use yet flexible , well - documented implementation of",
    "may also have played a _",
    "rle_. to fill this gap , we have written a program suited as a general framework for the exploration and application of  to simple one - component fluids with hard sphere reference systems with various combinations of physical systems , approximations , and solution algorithms . within the natural limitations of the method ,",
    "it has proved well applicable to a variety of model systems including the hard - core yukawa ( present contribution ) and hard - core multi - step potentials while most attention has been devoted to the square well fluid @xcite .",
    "of course , ours is not the first implementation of  for simple one - component fluids : indeed , there has been a series of earlier programs @xcite by the authors of the theory and their collaborators , but it was the one used in @xcite , henceforth referred to as the `` original '' implementation , that was a vital step in demonstrating the viability of  for continuous systems below the critical temperature ; though never published or formally released , it has been circulating among interested physicists for quite some time .",
    "our new software , on the other hand , differs from its precursors in many respects : adoption of a meta language in our version , programming style and documentation - to - code ratio may be most obvious , number and nature of hard - coded limitations , important details of the numerical procedure and a possible speed gain through generation of customized code might be less apparent . most importantly , though , the original implementation s structure makes experimentation with different combinations of approximations , partial differential equation ( )  solving algorithms , parameter settings and physical potentials rather cumbersome ; in contrast , the fully modular approach adoption of a meta language allowed us to take seems far better suited to a more general survey of s numerous attractive features .",
    "in addition to the necessary flexibility of our software , great care has been taken to ensure the numerical soundness of every step in the calculation and hence of the results produced , so that the generation of numerical errors necessarily arising from finite - precision arithmetic is uniformly spread over all of the problem s domain . to this end",
    "we introduce one central parameter , @xmath1 , characterizing the maximum relative error introduced at any step ; together with a number of criteria relying on @xmath1 , this parameter governs virtually all of the numerics . any deviation from this strategy",
    "is made explicit , as are all the other approximations entering the calculation .",
    "ultimately , our goal was to provide the liquid physics community with a general and versatile yet numerically reliable tool for the systematic exploration and assessment of and of the effects introduced by different approximations .    this paper is meant to serve a twofold purpose : to present the software we have written and its capabilities , and to provide its prospective users with some rudimentary documentation . to this end , after a brief presentation of the standard formulation of  for one - component fluids and some of the theory s properties as far as they concern our implementation ( section  [ sec : theory ] ) , we first give a general outline of our program in section  [ sec : global ] , only touching upon the meta - language it has been written in . due to our implementation s fully modular design it is only natural to then proceed by a discussion of the more important of its building blocks and the various approximations they implement ( sub - sections  [ sec : potential ] through [ sec : solver ] ) .",
    "presentation and critical assessment of the kind of results that can be attained with these and concluding remarks ( section  [ sec : discussion ] ) are followed by two appendices dealing with some technical aspects of the formulation used .",
    "while a much more detailed account with additional references can be found in the review article @xcite , in what follows we want to limit ourselves to only a rough sketch of ; in doing so we are going to stress several aspects  some of them hardly discussed in the literature  relevant to our implementation of , but only to the extent necessary for the discussion thereof .",
    "no prior knowledge of  is assumed .",
    "the basic ingredient of , already present in its precursor @xcite , is the gradual transition from a reference potential @xmath2 to the full potential @xmath3 describing the interaction between pairs of particles of a fluid , with any one of the intermediate potentials serving as a reference system with respect to which the properties of a successor potential are calculated [ superscripts always indicate the system a quantity refers to ] . in our work",
    "we have restricted ourselves to the case of a spherically symmetric pure two - body interaction , and we have taken advantage of the additional simplifications possible by identifying the reference system with a pure hard sphere system , @xmath4 , as can always be achieved via the well - known weeks - chandler - andersen scheme @xcite .",
    "note however that this restriction to a hard sphere reference system is not present in the original implementation of  @xcite ; on the other hand , our program s fully modular framework is flexible enough to accommodate any of these extensions should the need arise .",
    "other than @xcite ,  achieves the transition from @xmath5 to @xmath6 in infinitesimally small steps .",
    "inspired by momentum - space renormalization group ( ) theory , a cut - off wavenumber @xmath7 varying from infinity to zero is introduced , and for every @xmath7 the potential @xmath8 is defined such that fourier components @xmath9 of the perturbational part @xmath10 of the @xmath7-potential @xmath11 are strongly suppressed whereas those for @xmath12 coincide with those of the original potential @xmath13 .",
    "consequently , the reference system and the fully interacting system are recovered in the limits @xmath14 and @xmath15 , respectively : @xmath16 the _ rle _ of the @xmath7-potential just introduced becomes clear when we consider a functional expansion in @xmath17 of thermodynamic and structural properties of the system with pair interaction @xmath11 [ a tilde always denotes the fourier transform ] : as @xmath18 is small , the integrals in the expansion are effectively truncated for @xmath19 , in keeping with the  picture .    in principle , the precise manner in which the potential is cut off should not matter , and one can easily conceive of many different ways of doing so . on the other hand , for such a procedure to be usable it must not introduce instabilities when truncating the  hierarchy , which is usually done at the two - particle level . apart from approaches valid only for special types of potentials ,",
    "we are aware of only two cut - off procedures suitable at least for attractive potentials ( the standard formulation of  can easily be shown to become unstable for @xmath20 , as implicitly stated already in @xcite ) ; in our work we opted for the prescription presented in the review article @xcite which seems to have been used almost exclusively so far @xcite rather than the smooth cut - off formulation of @xcite , the latter being numerically cumbersome and predicting non - universal critical exponents .",
    "thus we define the @xmath7-potential @xmath21 by @xmath22 in @xmath23-space , @xmath10 differs from @xmath13 by the addition of a convolution integral , _ viz . _",
    "@xmath24 obviously this @xmath7-potential is a rather artificial function in @xmath23-space hardly resembling the full potential except in the limits of eq .",
    "( [ eq : potential : limits ] ) ; furthermore , the range in @xmath23-space over which @xmath11 has to be considered is bound to be much larger than that of the original potential  a property immediately carrying over to related quantities , the direct correlation functions in particular . as an immediate consequence ,",
    "numerical fourier transformations involving the @xmath7-potential or any of the correlation functions for the @xmath7-system are computationally expensive and must be treated with extreme care ; in fact , they should be avoided if possible at all , with obvious repercussions for the implementation of the core condition ( _ v .",
    "i. _ ) .    in the transition from @xmath5 to @xmath6 or ,",
    "equivalently , from @xmath25 to @xmath26 ,  treats the @xmath7-system as reference for the properties of the system with infinitesimally lower cut - off @xmath27 ; re - summation of terms in the resulting expansions in @xmath28 and identification of quantities with a well - defined limit for @xmath15 finally yields the  equations @xcite : for every density @xmath29 there is a formally exact hierarchy of coupled integro - differential equations involving a suitably modified free energy @xmath30 defined as @xmath31 ( @xmath32 , @xmath33 ; analogously , @xmath34 ) , a modified two - particle direct correlation function @xmath35 and all higher order correlation functions @xmath36 ,",
    "the additional terms introduced in @xmath30 and @xmath38 explicitly take into account a discontinuity at @xmath26 present in the unmodified free energy @xmath39 and direct pair correlation function @xmath40 ; as is apparent from eqs .",
    "( [ eq : cutoff ] ) , ( [ eq:0loop : a ] ) and ( [ eq:0loop : c ] ) , modified and unmodified quantities coincide for @xmath26 .  furthermore it should be noted that it is customary to include the ideal gas terms in the definition of the @xmath41 : for the two - particle case this is an additional term of @xmath42 so that the ornstein - zernike @xcite equation takes the form @xmath43 where @xmath44 is the usual two - particle total correlation function ; for the higher order correlation functions cf .",
    "@xcite .    the full hierarchy the derivation of which we just touched upon yields expressions for the total derivatives with respect to @xmath7 for @xmath38 and all the @xmath41 , @xmath37",
    "; for the evolution of @xmath30 we have the particularly simple relation @xmath45 as @xmath46 , @xmath47 , involves @xmath30 , @xmath38 and all higher order correlation functions up to @xmath48 ( so that , in particular , @xmath49 depends on @xmath50 and @xmath51 via eq .",
    "( [ eq:0loop : c ] ) ) , the equations never decouple and we have to introduce some kind of closure . in doing so ,",
    "it is usually desirable to retain thermodynamic consistency as embodied in the sum rule @xmath52 rigorously true for the exact solution of the full hierarchy ; the derivatives with respect to @xmath29 present in eq .",
    "( [ eq : consistency ] ) then mandate the transition from equations at fixed @xmath29 to a in the @xmath53-plane with boundary conditions supplied at two densities , @xmath54 and @xmath55 .",
    "in addition , we need to retain the core condition , _ viz . _",
    "@xmath56 for @xmath57 where @xmath58 is the pair distribution function ; indeed it is one of s main advantages to conserve information on all length scales , ranging from the hard - sphere diameter @xmath59 of the reference system at density @xmath29 and the associated core condition up to the cut - off wave length @xmath60 , in the limit @xmath15 allowing criticality to arise from fluctuations of arbitrarily large wave length .    as noted above , the long - ranged nature of @xmath10 and the correlation functions due to the cutting - off of eq .",
    "( [ eq : cutoff ] ) is a strong argument in favor of any closure allowing an approximate implementation of the core - condition without the need for costly fourier transforms .",
    "this is a likely reason for the up to now seemingly exclusive use of a closure in the spirit of the _ lowest - order @xmath61-ordered approximation _ ( , @xcite ) or the equivalent _ optimized random - phase approximation _ ( , @xcite ) despite this closure s known deficiencies @xcite : with the argument @xmath29 silently to be added in earlier equations when used within the context of the , we make the _ ansatz _ @xmath62 thereby introducing a set of @xmath7-independent basis functions @xmath63 and corresponding expansion coefficients @xmath64 . here , @xmath65 is chosen proportional to @xmath66 ( which has the undesirable effect that , from eqs .",
    "( [ eq : closure ] ) and ( [ eq:0loop : c ] ) , the correlation function @xmath67 of the @xmath7-system depends upon the full potential @xmath13 rather than @xmath10 , as would be appropriate ) and normalized so that @xmath68 ; the @xmath69 , @xmath70 , on the other hand , are taken to form a basis for a suitable function space over @xmath71 $ ] . with these provisions ,",
    "the problem of implementing both core condition and thermodynamic consistency reduces to that of an appropriate choice of the expansion coefficients @xmath72 , @xmath73 , for every point in the @xmath53-plane . with the short - hand notations @xmath74 and , for an arbitrary function @xmath75",
    ", @xmath76 = \\int_{{\\bbb r}^3 } { { { \\rm d}}^3k\\over(2\\pi)^3}\\,{\\psi(k,\\rho)\\over \\left(\\tilde c\\q_2(k,\\rho)\\right)^2}\\,,\\ ] ] the condition ( [ eq : consistency ] ) for thermodynamic consistency is easily re - written as @xmath77 and following @xcite the core condition can be shown to be equivalent to @xmath78 \\,{\\partial\\g\\q_n(\\rho)\\over\\partial q } = { q^2\\over2\\pi^2 }   \\,{\\tilde\\phi(q,\\rho)\\,\\tilde u_j(q,\\rho ) \\over\\tilde\\c\\q(q,\\rho ) \\,\\left(\\tilde\\c\\q(q,\\rho)-\\tilde\\phi(q,\\rho)\\right)}\\ , , \\qquad j \\ge 1.\\ ] ] the latter can be combined with eq .",
    "( [ eq : consistency : gamma ] ) to the more explicit @xmath79 \\,{\\partial\\g\\q_n(\\rho)\\over\\partial q}\\\\ = \\alpha\\q(\\rho)\\ , \\hat{\\cal i}\\q\\left[\\tilde u_j(k,\\rho)\\,\\tilde u_0(k,\\rho ) , \\rho\\right ]    + { q^2\\over2\\pi^2 } \\,{\\tilde\\phi(q,\\rho)\\,\\tilde u_j(q,\\rho ) \\over\\tilde\\c\\q(q,\\rho ) \\,\\left(\\tilde\\c\\q(q,\\rho)-\\tilde\\phi(q,\\rho)\\right)}\\ , , \\quad j\\ge1 ; \\end{array}\\ ] ] as both the sum rule and the core condition must hold for the reference system , the above evolution equations for the @xmath64 are readily supplemented with the initial conditions @xmath80 , @xmath81 .    as eq .",
    "( [ eq : matrix : infty ] ) stands , it is no more amenable to direct implementation than the previous formulation ; not only must this infinite - dimensional matrix equation be truncated to a finite number @xmath82 of basis functions , but even then the resulting integrals need to be evaluated at every @xmath7 and @xmath29  a tedious process no less demanding than the fourier transformations this approach is meant to replace .",
    "what makes this closure manageable , however , is the observation that the discontinuity in @xmath83 s integrand due to the appearance of @xmath84 instead of the continuous @xmath85 leads to a term in @xmath86 / \\partial q$ ] made up of functions evaluated at @xmath87 alone ; following @xcite , only this single term is retained , leading to the approximation @xmath88 = \\psi(q,\\rho)\\,{q^2\\over2\\pi^2}\\ ,   { 2\\,\\tilde\\c\\q(q,\\rho)\\,\\tilde\\phi(q,\\rho)-\\left(\\tilde\\phi(q,\\rho)\\right)^2 \\over \\left(\\tilde\\c\\q(q,\\rho)\\right)^2\\ , \\left(\\tilde\\c\\q(q,\\rho)-\\tilde\\phi(q,\\rho)\\right)^2}\\ ] ] leaving out the non - local contribution @xmath89\\*(\\partial\\g\\q_n(\\rho)/\\partial q)$ ] ; with the above approximation , the task of evaluating one of the integrals of eq .",
    "( [ eq : matrix : infty ] ) reduces to only an initial integration for the reference system followed by the solution of an ordinary differential equation ( ) coupled to the -as well as analogous s for all the other integrals of the @xmath90-type .    of course , to fully specify the mathematical problem ,",
    "the  must be amended by both initial and boundary conditions ; while the former take the simple form of vanishing expansion coefficients ( _ v .",
    "s. _ ) , the latter also impose some constraint on the @xmath64 .",
    "however , as long as we retain the core condition , such an additional constraint is already sufficient to determine the expansion coefficient @xmath91 ; unless the @xmath91 so found exactly reproduces eq .",
    "( [ eq : consistency : gamma ] ) , thermodynamic consistency can no longer be imposed without introducing mathematical inconsistencies . by the same token , eq .",
    "( [ eq : matrix : infty ] ) , derived by incorporating the sum rule ( [ eq : consistency ] ) into the core condition , is no longer valid but must be changed to @xmath92 \\,{\\partial\\g\\q_n(\\rho)\\over\\partial q } = & - \\hat{\\cal i}\\q\\left[\\tilde u_j(k,\\rho)\\,\\tilde u_0(k,\\rho ) , \\rho\\right ] \\,{\\partial\\g\\q_0(\\rho)\\over\\partial q}\\\\ & + { q^2\\over2\\pi^2 } \\,{\\tilde\\phi(q,\\rho)\\,\\tilde u_j(q,\\rho ) \\over\\tilde\\c\\q(q,\\rho ) \\,\\left(\\tilde\\c\\q(q,\\rho)-\\tilde\\phi(q,\\rho)\\right ) } \\,,\\quad j\\ge1 .",
    "\\end{array}\\ ] ] to reflect the transition from eq .",
    "( [ eq : consistency ] ) to said constraint determining the @xmath91 appearing on the above equation s right hand side ; furthermore , elimination of thermodynamic consistency obviously means decoupling the  to a set of s at fixed density .",
    "this is exactly what is needed at the boundaries @xmath54 and @xmath55 of the density interval considered where the @xmath29-derivatives defining @xmath93 can not be evaluated : while specialization to @xmath94 uniquely determines the solution there by virtue of the divergence of the ideal gas term @xmath95 in @xmath96 ( cf .",
    "appendix [ sec : app : rewrite ] ) , some prescription for finding @xmath91 , accompanied by the necessary modification of the truncated matrix equation according to eq .",
    "( [ eq : matrix : g0fixed ] ) , must be imposed at @xmath55 ; as long as we retain eq .",
    "( [ eq : matrix : infty ] ) in the s domain s interior and numerically evaluate @xmath93 there , it is natural to use the /  condition @xmath97 @xcite at the boundary , which is sufficient to also determine @xmath98 ( or , equivalently , appendix [ sec : app : rewrite ] s @xmath99 ) from the @xmath100 , @xmath70 , alone .",
    "unfortunately , it turns out that a scheme retaining @xmath93 in eq .",
    "( [ eq : matrix : infty ] ) for @xmath101 presents significant numerical problems for all but extremely high temperatures , precluding reaching @xmath102 at least for the potentials that we have looked at .",
    "this is where the so - called `` decoupling assumption '' comes into play : based upon the different ranges of @xmath103 and @xmath104 , @xmath70 , the authors of @xcite argue that @xmath105 might be a good approximation , thus eliminating the @xmath90-integral on the right hand side of eq .",
    "( [ eq : matrix : infty ] ) ; it turns out that this change , invariably adopted in all later publications , is often sufficient to allow generating a solution all the way to @xmath102 . from our previous discussion of conditions imposed on the @xmath64",
    "it should be obvious that this decoupling assumption is incompatible not only with the /condition @xmath106 retained in the original implementation for @xmath107 but also with thermodynamic consistency ( eq .",
    "( [ eq : consistency ] ) ) altogether ; thus we are left with only a few possibilities : we may either retain logical consistency by using the decoupling assumption @xmath105 as a closure for the -equations , reducing the  to a set of s in @xmath7 only ; or we may prefer to retain the structure of a  so as to make use of thermodynamic consistency at least to a certain degree ; yet another possibility is to maintain both mathematical and thermodynamic consistency by not implementing the core condition at all .",
    "the original implementation s approach relying on three mutually incompatible concepts , _ viz . _",
    "the /  condition at @xmath55 , decoupling , and the compressibility sum rule , seems particularly unattractive ; at least one should use the decoupling assumption as a boundary condition at high density instead .    retaining thermodynamic consistency in the form of eq .",
    "( [ eq : consistency : gamma ] ) as well as , in an approximate , way , the core condition via the truncated eq .  ( [ eq : matrix : infty ] ) or ( [ eq : matrix : g0fixed ] ) together with the approximation ( [ eq : dqc2int : approx ] ) , we thus arrive at a set of equations implementing  with the /-like closure ( [ eq : closure ] ) on the two - particle level well suited for numerical processing . while these expressions lend themselves to discretization in a straightforward way , it is computationally much more convenient to cast the  in a form superficially resembling a quasi - linear one @xcite so that an implicit finite - difference scheme requires only the inversion of a tridiagonal matrix . the re - writing we adopted  detailed in appendix  [ sec : app : rewrite ] , very similar to the one of @xcite  results in the introduction of an auxiliary function @xmath108 so that the  implied by eqs .",
    "( [ eq : dqa ] ) and ( [ eq : consistency ] ) can be written in the form @xmath109 + d_{01 } [ f , q,\\rho]\\,{\\partial\\over\\partial\\rho}f(q,\\rho ) + d_{02 } [ f , q,\\rho]\\,{\\partial^2\\over\\partial\\rho^2}f(q,\\rho ) \\,.\\ ] ]    now it is easy to demonstrate the s stiffness for subcritical temperatures : recalling the definitions of appendix  [ sec : app : rewrite ] , we find that the inverse isothermal compressibility @xmath110 of the system with potential @xmath6 can be written as @xmath111 , where @xmath112 . for subcritical temperatures there is a density interval @xmath113 $ ] where @xmath114 ( implying diverging @xmath115 and hence @xmath116 ) ; here , @xmath117 and @xmath118 are the densities of the coexisting vapor and liquid , respectively ( recall that  yields rigorously flat isotherms within the coexistence region , with binodal and spinodal coinciding in three dimensions @xcite ) . by construction , however , the limit @xmath15 is a continuous one ( cf .  eqs .",
    "( [ eq:0loop : a ] ) and ( [ eq:0loop : c ] ) ) so that @xmath116 , @xmath119 and related quantities must be large already well before @xmath26 is reached ; at the same time , the  mechanism introduced by the definition of @xmath10 via eq .",
    "( [ eq : cutoff ] ) precludes any divergence at non - vanishing  @xmath7 . considering the region of the @xmath53-plane where @xmath116 and @xmath119 are large , we easily find from the explicit expressions of appendix  [ sec : app : rewrite ]  that the @xmath120 , and hence @xmath121 , are of order @xmath122 ; restricting ourselves to a specific density @xmath29 and sufficiently small @xmath7 ( so that @xmath123 ; extension of the argument to a larger @xmath7-range is cumbersome but straightforward ) we can write @xmath124 where @xmath125 is now of order unity",
    ". inspection of the solution of this  immediately shows that the average of @xmath126 over the interval @xmath127 $ ] , @xmath128 , is rigorously bounded from above by @xmath129 or else there were a singularity in that @xmath7-interval ; translating back to @xmath116 we see that , while @xmath130 is still of order @xmath119 , @xmath116 must be a rapidly oscillating function of @xmath7 ( with a period of order @xmath131 ) , the average slope of which is much smaller , _ viz._of order @xmath60 .",
    "it should be noted that this stiffness is not an artifact of the re - formulation of the  as summarized in appendix  [ sec : app : rewrite ] but is manifest just the same when directly solving the  for the modified free energy @xmath132 rather than that for the auxiliary @xmath108 @xcite .",
    "the above argument relies only on some general properties of  in the current formulation as applied to one - component fluids : the divergence of the isothermal compressibility in the coexistence region ( the reproduction of which is one of s main achievements ) , continuity of the limit @xmath15 , and the suppression of divergences for @xmath133 as a result of the mechanism implemented via the truncated potential @xmath11 .",
    "the essential additional ingredient , _ viz .",
    "_  the behavior of the ratio of the @xmath7- and the @xmath29-derivatives as the divergence in the compressibility builds up , while obvious in the formulation via @xmath116 , is not easily seen in terms of @xmath132 ; this , however , comes as no surprise since @xmath116 is essentially the free energy s derivative with respect to @xmath7 so that we would have to reason about third- and second - order derivatives rather than first- and second - order ones if we were to repeat the arguments without resorting to the re - writing of appendix  [ sec : app : rewrite ] .",
    "with the theory and approximations outlined in the previous section , we are now in a position to undertake the task of implementing for one - component fluids in fully standards conforming fortran-90 ; the only non - standard feature we make use of is the availability of the special values nan and @xmath134 for numerically undefined values and signed overflows , respectively , as defined in the floating - point standard ieee  754 .",
    "these requirements should not pose a serious restriction for our program s possible users : after all , fortran-90  compilers have been available for a wide range of platforms for several years , and the desired floating - point behavior can usually be requested  albeit at a small performance penalty  via compiler switches . while our implementation is more appropriately described as a collection of mutually compatible building blocks rather than as a monolithic program",
    "so that the details of the numerical procedure are best left to these parts , for the combination of different selections to work all versions of all the modular constituents must adhere to a common model of the computation :    most obviously , we have to make the transition from the s domain , _ viz .",
    "_  the infinite strip @xmath135 $ ] , to a discrete mesh defined by a finite number of points in the @xmath53-plane .",
    "evidently , the placement of these `` nodes '' , as we shall call them , is of utmost importance for the quality of the discretization so that it is only natural to define @xmath1 , the central parameter governing all of the numerics , in terms of the properties of this mesh : the coarser a mesh we chose , the larger @xmath1 will be .  in principle , the locations of the nodes , the data structures of which are organized in linked lists , can be chosen freely ; in particular , the cut - offs @xmath7 of all the systems in such a list of nodes are not taken to necessarily coincide , even though this is usually the case except for a low - density boundary at @xmath136 . as for the densities of the nodes , implementation of the core condition via the truncated eq .",
    "( [ eq : matrix : infty ] ) and eq .",
    "( [ eq : dqc2int : approx ] ) makes anything but constant ( though not necessarily equispaced ) density values impractical ; if the grid is to be refined for low @xmath7 , additional nodes must be inserted at the same densities in all the node lists in the calculation . ",
    "after initialization of the nodes data structures , solution of the  proceeds by applying a ( possibly iterated ) predictor - corrector scheme to generate an approximate solution for the nodes most advanced towards @xmath26 from the information available through the node lists at higher @xmath7 ; in the interest of the code s simplicity , the number of such node lists has been fixed to exactly three , thus facilitating determination of appropriate step sizes @xmath137 .    as mentioned before , the goals set for our implementation of necessitate a fully modular architecture of our program ; and while we did not want to forgo the well - known advantages of fortran-90  for the numerical work , experience with prior versions of our code taught us that the kind of flexibility we need can not be accommodated within the rather rigid framework fortran-90 s modules with their one - way flow of information provide .",
    "instead we opted for a simple meta - language for self - configuring construction of code customized to the chosen combination of approximations and the physical system at hand , at the same time enhancing readability and maintainability of the source and encouraging modularization ; for a more detailed discussion of this approach and the numerous technical advantages it affords we refer the reader to @xcite .",
    "our software can best be understood as a collection of mutually compatible and freely exchangeable building blocks corresponding to the underlying physical and mathematical notions ; the resulting natural organization of the code cleanly separating conceptually unrelated approximations is a direct consequence of our adoption of a meta - language and the use of automatic code generation techniques .",
    "the implementation s modular constituents , henceforth dubbed `` main parts '' , must , however , be clearly distinguished from fortran-90 s modules : in general , there is no simple mapping from main parts to modules , and every main part may give rise to any number of modules , incorporating all the information available within the code base .",
    "in the following sub - sections we take a closer look at some of the main parts , their physical meaning , the algorithms and approximations implemented , and at some of the information they make available to the other parts ; we will , however , exclude from this discussion the program s infrastructure , _ e.  g. _  the implementation of logging , of reading and parsing of options files , handling of node lists and the definition of a versatile , lossless and storage - efficient albeit platform dependent file format for the results at @xmath102 . in a similar vein ,",
    "we only mention the assortment of accompanying tools for reading these files and dumping their content in human - readable or mathematica - usable form , for locating the critical point or calculating phase diagrams .",
    " thus only main parts `` potential '' , `` reference '' , `` ansatz '' and `` solver '' remain to be discussed :      first and foremost , we obviously have to provide information on the fluid s potential @xmath138 and its properties : this is the purpose of the main part labeled `` potential '' .",
    "just as the full potential is a sum of a reference part @xmath5 and a perturbational part @xmath13 , the functions and parameters to be provided by this main part fall into two distinct categories , pertaining to either @xmath5 or @xmath13 ; in addition , as the temperature enters the calculation only as a pre - factor to @xmath13 , _ viz .",
    "_  via @xmath139 , the inverse temperature @xmath140 is also defined here .    as far as the reference system is concerned , restriction to hard spheres ( for the rationale cf .",
    "section  [ sec : theory ] ) means that only a function returning the hard sphere diameter @xmath59 and a flag indicating any deviation of @xmath59 from the unit of length need to be made available .",
    " a similar parameter pertaining to the perturbational part @xmath13 of the potential , _ viz .",
    "_  a flag indicating any density - dependence of @xmath13 , also plays an important _ rle _ in many parts of the program as substantial simplifications and , in many cases , significant speed - ups by caching previous results are possible whenever @xmath141 only depends on @xmath7 .",
    "in addition , at every cut - off @xmath7 the program must have access to the fourier transforms @xmath142 and @xmath141 as well as the derivatives @xmath143 and @xmath144 , whereas powers of the volume integral , @xmath145 , and their derivatives @xmath146 obviously do not depend on @xmath7 ( here , @xmath147 and @xmath148 are appropriate integers known during code construction ) .    for the benefit of the -solving algorithm ,",
    "this main part also has to set a parameter @xmath149}$ ] related to the maximum relative curvature of the second @xmath7-derivative of @xmath141 , defined in such a way as to coincide with @xmath150 for the square well potential @xmath151}$ ] .",
    "indeed , most of our efforts so far @xcite have concentrated on this particularly simple type of potential given  by @xmath152}(r ) = \\left\\{\\begin{array}{ccc } -\\epsilon & : & r<\\lambda\\,\\sigma \\\\ 0         & : & r>\\lambda\\,\\sigma\\ , , \\end{array}\\right.\\ ] ] where the hard sphere diameter @xmath153 of the reference part and the strength @xmath154 of the potential are usually chosen as units of length and energy , respectively .",
    " another type of potential we have implemented is a generalized step potential , _",
    "i.  e. _  a succession of stretches of constant @xmath155 ; more specifically , the perturbational part @xmath155 of an @xmath148-step potential of this type is just a sum of square - well potentials , @xmath156}$ ] , @xmath157 , @xmath158 ; again , we have only considered the @xmath29-independent case , while all the potential s parameters should be assumed functions of @xmath29 when modeling a specific physical system .",
    " we have also implemented a @xmath29-independent hard - core yukawa potential @xmath159 , @xmath160}(r ) = \\left\\{\\begin{array}{ccc } -\\epsilon_0 & : & r<\\sigma \\\\",
    "-\\epsilon\\,{\\sigma\\over r}\\ , e^{-z\\,(r-\\sigma ) } & : & r>\\sigma\\ , , \\end{array}\\right.\\ ] ] where the parameter @xmath161 , the value of @xmath162 inside the core , defaults to @xmath163 , which again is usually chosen to coincide with the unit of energy ; any mismatch between @xmath161 and @xmath154 dominates @xmath164 for large @xmath165 and is found to render unstable at least the numerics .    regarding the stability of the , recall from section  [ sec : theory ] that an attractive potential ( so that @xmath166 ) is a necessary though not sufficient condition for the stability of the .",
    "due to the specialization of @xmath5 to hard spheres , the reference system enters the expressions of section  [ sec : theory ] only through the direct correlation function @xmath167 , implementation of which is the task set for main part `` reference '' : drawing upon the information from main part `` potential '' , only some initialization code and functions for the evaluation of @xmath168 and @xmath169 have to be exported .    in our program",
    "we have so far included two different versions implementing the percus - yevick @xcite approximation and the henderson - grundke @xcite description ; note that all results reported here have been obtained using the henderson - grundke @xmath170 : in a theory relying on internal consistency conditions like eq .",
    "( [ eq : consistency ] ) as heavily as , the thermodynamic inconsistency present in the percus - yevick solution seems particularly undesirable .",
    "main part `` ansatz '' , where all the approximations on the physical and mathematical level are combined to jointly define a reasonable numerical model of , is at the very core of the -solving machinery : for the potential the perturbational and reference parts of which have been described in the two previous sub - sections , the -  is discretized and solved according to a given set of approximations and on the mesh defined by the node - lists served by main part `` solver '' ( sub - section  [ sec : solver ] ) .",
    "more precisely , `` ansatz '' provides a set of facilities in the form of subroutines with standardized interfaces implementing the various stages of the computation , _ viz .",
    "_  initialization of the node lists at @xmath171 and solution of the  according to a predictor - corrector full approximation scheme .",
    "note , however , that the code must accommodate the possibilities of both iterating the corrector step ( which may allow reaching the numerical quality indicated by @xmath1 with somewhat larger step sizes , thus speeding up the calculation ) and of discarding part of the solution should @xmath1-based criteria not be met ; to aid `` solver '' in these decisions , care has to be taken to detect and signal numerical anomalies .",
    "once a step s results have been accepted , `` ansatz '' may perform additional manipulations of the data structures ; most importantly , the re - scaling of all quantities affected by exponentiation of @xmath116 necessary whenever @xmath116 is large ( cf .  our discussion of the s stiffness in section  [ sec : theory ] ) is adjusted only when the last corrector s result has been accepted .",
    "due to the eminent _ rle _ of the consistency condition eq .",
    "( [ eq : consistency ] ) in constructing a closure to the underlying  ( [ eq : dqa ] ) , the  ( [ eq : quasilinear ] ) for @xmath108 is of first order in @xmath7 and of second order in @xmath29 ; assuming the lowest possible number of nodes in the discretization ( extension to higher order is straightforward ) , we need at least a @xmath172 set of nodes .",
    "according to the general model of the computation presented in section  [ sec : global ] , however , we instead keep a third node list in order to allow monitoring of second @xmath7-derivatives , so that we use a discretization on the @xmath173 grid schematically presented in fig .",
    "[ fig : grid ] , including information available via that additional node list .",
    "locally , the discretization is derived from an expansion about the midpoint of the nodes labeled @xmath174 and @xmath175 in the schematic  [ fig : grid ] , evaluating the second @xmath29-derivative along the line of constant @xmath7 through this point ( thin horizontal line in fig .",
    "[ fig : grid ] ) by estimating the data at the intersection with the lines of constant density by interpolants defined from node triples @xmath176 and @xmath177 , respectively ; the resulting finite difference approximation is applied to every set of three adjacent node - triples , substituting suitable boundary conditions at @xmath54 and @xmath55 .    as indicated in fig .",
    "[ fig : grid ] , @xmath7 is not necessarily constant along a given node list , whereas the stability of the numerical scheme may impose certain geometrical constraints regarding the possible locations of the nodes , _",
    "e.  g. _  for ensuring that the courant - friedrichs - lewy criterion @xcite is met or for maintaining convexity of the remaining integration region ; a suitable representation of these constraints is exported and must be taken into account by main part `` solver '' .",
    "if the latter decides to insert nodes at intermediate densities , the code for initializing the inserted data structures and for interpolating appropriate quantities is negotiated between the main parts , depending upon the order of the interpolation formulavailable .",
    "a further consequence of having non - constant @xmath7 is that some parts of the density range may reach @xmath178 earlier than others ; in this case , the corresponding nodes are locked , preventing further modification , and all of the converged nodes except those necessary for providing a boundary condition for the remaining density interval are removed from the node lists available to main part `` ansatz '' .",
    "in addition to the discretization of the -  ( [ eq : quasilinear ] ) discussed so far , the implementation of the core condition along the lines of section  [ sec : theory ] and appendix  [ sec : app : rewrite ] is also of interest .",
    "relegating discussion of the choice of appropriate basis function @xmath63 , @xmath179 , to appendix  [ sec : app : basis ] , we only point out the extremely slow convergence of the @xmath83-integrals ( [ eq : c2int : def ] ) that have to be evaluated at @xmath171 ; furthermore , as the integrand is temperature dependent for @xmath180 , these integrals have to be evaluated for every isotherm  a problem that might be sidestepped by adopting the original implementation s strategy of consistently using the results for @xmath14 rather than those valid at @xmath181 for initialization even though such an approach introduces a discontinuity at @xmath171 .",
    "also , with the usual choice of @xmath182 , integration merely up to @xmath183 can hardly be deemed sufficient ; an appropriate upper integration limit can instead be found by comparing the integrand s asymptotic behavior with @xmath1 .",
    " main part `` ansatz '' also has to identify quantities suitable both for monitoring convergence of the full approximation scheme and for choosing appropriate step sizes @xmath137 and @xmath184 , and to make available code fragments for the inspection of nodes in various stages of the computation as well as a description of the boundary conditions at @xmath54 and @xmath55 including mandatory settings for either of these parameters if necessary ; in particular , most implementations require @xmath94 in order to be able to use the divergence of the ideal - gas term in @xmath185 as a @xmath7-independent boundary condition for @xmath116 ( cf.appendix  [ sec : app : rewrite ] ) .    it is this main part that defines the formulation of  and the set of approximations used in the calculations ; of the numerous versions of this main part we produced only a few are to be mentioned here : both the re - implementation of the original program s approximations for the core and boundary conditions and the approach combining the  with @xmath186 at all densities including @xmath55 , while mathematically inconsistent , retain thermodynamic consistency at least in some approximate way ( cf .",
    "our discussion of the decoupling assumption in section [ sec : theory ] ) ; in addition to these , the two possible approaches at least mathematically meaningful , _ viz . _  the s directly following from decoupling and the  resigning on the core condition for the benefit of the compressibility sum rule ( [ eq : consistency ] ) ( with the /prescription @xmath97 as high density boundary condition ) will also be used in section [ sec : discussion ] s presentation of the results our software yields .",
    "if main part `` ansatz '' is to provide a discretization on whatever mesh is handed to it , it is the task set for `` solver '' , the last of the main parts to be discussed here , to define this very mesh and to keep track of the numerical solution s quality .",
    "based primarily upon the value of @xmath1 and respecting any restrictions exported by `` ansatz '' , step sizes @xmath137 and @xmath184 have to be chosen and checked for compatibility with the solution generated , iterating or discarding steps if certain criteria are not met ; whenever `` ansatz '' signals an exception the last step is discarded , accepting the data in the node list corresponding to labels @xmath187 in fig .  [",
    "fig : grid ] as the best approximation to the solution for @xmath15 . at the same time",
    ", care has to be taken to locate and identify any problems in the solution , _",
    "i.  e._parts of the @xmath53-plane where the solution found does not appear smooth on the scales set by the step sizes , the most basic assumption underlying any finite - difference calculation ; whenever this assumption no longer holds , the algorithm will react by locally reducing @xmath188 and @xmath184 , inserting node triples ( cf .",
    "sub - section [ sec : ansatz ] ) in order to achieve the latter .",
    " once we find any nodes already holding the final results for their respective densities they must be taken care of as discussed in sub - section [ sec : ansatz ] ; integration of the  is ended when there is a node with @xmath189 for every density in the calculation , or when `` ansatz '' requests an end either because an error condition has occurred ( _ v .",
    "s. _ ) or because the current node list is sufficiently close to @xmath102 already .",
    " as noted in section  [ sec : global ] , the intimate link between this main part s task and the numerical quality of the solution generated makes it natural to here define @xmath1 , the central parameter governing the numerics , and it is this part of the program that relies upon @xmath1 and the associated criteria the most ; other main parts use @xmath1 for little more than for switching between full analytic expressions and asymptotic expansions ( for a slightly atypical example of which cf .  appendix  [ sec : app : basis ] ) .    of the two implementations of this main part",
    ", one has been written in the hopes of being able to avoid the problematic region of large @xmath108 altogether , as is indeed possible for some similar s. this implementation makes full use of @xmath1 , relying on numerous criteria to control the calculation ; in the following discussion the notation @xmath190}_{y}$ ] refers to customization parameters that should usually be taken as real numbers of order unity .",
    "a case in point is the choice of the density grid : even though this is not necessary , we decided to always start with an equispaced set of @xmath29-values ranging from @xmath54 to @xmath55 ; the number @xmath191 of such density values is related to @xmath1 by @xmath192}_{n_\\rho}}\\,,\\ ] ] reflecting the importance of second @xmath29-derivatives in the solution of the  as well as the static nature of this set of densities due to the @xmath90-approach to the core - condition .",
    " once @xmath1 has been determined , the system is ready to start determining appropriate step sizes @xmath137 ; in particular the assumption that the potential @xmath193 introduces length scales only in the range from @xmath59 to @xmath194}(\\rho)\\,\\sigma(\\rho)$ ] , where @xmath194}$ ] is related to the fourth derivative of @xmath195 with respect to @xmath165 ( cf .",
    "sub - section [ sec : potential ] ) , places an upper bound on the admissible step sizes , _ viz .",
    "_ @xmath196}_{\\delta q_{\\rm max } } } \\over\\lambda _ { [ v]}\\,\\sigma(\\rho)}\\,.\\ ] ] on the other hand , for a finite difference scheme to be meaningful at least a certain number of bits must remain significant in evaluating the differences , which implies a lower bound on @xmath137 proportional to @xmath7 , and the solution has to be smooth on the scales defined by the mesh , which also rules out abrupt changes in the step sizes ; consequently , the ratio of two consecutive @xmath137 steps at the same density is restricted to lie between @xmath197}_{\\rm ratio}$ ] and @xmath198}_{\\rm ratio}$ ] . in a similar vein , considering smoothness in the @xmath29-direction we have to postulate that @xmath199 is greater than either of @xmath200 and @xmath201 , where the labels coincide with those of the nodes of fig .",
    "[ fig : grid ] ; this condition , unlike the other rules mentioned so far , does not limit the step sizes @xmath137 at any density @xmath29 but rather determines whether @xmath184 should be reduced by the insertion of nodes at an additional density .",
    "but the most important criteria for choosing @xmath137 come from monitoring the solution generated : for every monitored quantity @xmath202 we make sure that @xmath203}_{x}}\\ , , \\\\",
    "\\vert x\\vert_q   = \\max_{k > q}\\vert x(k,\\rho)\\vert\\ , ; \\end{array}\\ ] ] the quantities taken for @xmath202 are , of course , defined by `` ansatz '' , and a usual choice is @xmath204 .",
    "a different set of quantities @xmath205 , also chosen by `` ansatz '' and usually comprising just @xmath206 , is used to monitor the convergence of the predictor - corrector scheme and to determine whether or not the corrector should be iterated : denoting the absolute difference of consecutive approximations of @xmath205 divided by @xmath207 by @xmath208 , iterations are performed until @xmath209}_{y}$ ] , and the ratio of two consecutive step sizes is bounded from above by @xmath210}_{y } ) ^ { 1/\\left(2+p^{[\\delta q]}_{n_{\\rm it}}\\right )",
    "} / \\sqrt{\\delta^{(1)}y}$ ] , where @xmath211 is @xmath208 evaluated after the first corrector step . according to simple heuristic arguments regarding the convergence of corrector iterations and ignoring the effect of other criteria , an average of @xmath212}_{n_{\\rm it}}$ ] calls of the corrector can be expected to solve the difference equations to within @xmath1 , and a setting of @xmath197}_{n_{\\rm it}}>1 $ ] may significantly speed up the calculation by allowing larger steps to be taken without loss of accuracy .  after finding and tentatively using a candidate @xmath188 , we still have to check that the assumptions leading to that particular choice for @xmath137 actually hold ; to this end we re - evaluate all the criteria with the obvious exception of the one involving @xmath211 after the predictor and discard the step unless a slightly smaller step size , _ viz .",
    "_  @xmath213}_{\\rm discard}$ ] ( @xmath197}_{\\rm discard}<1 $ ] ) , passes the tests .",
    "if no step size can be found satisfying all the constraints , the calculation is terminated .",
    "while the above set of prescriptions for finding suitable node locations has proved indispensible in understanding the behavior of the s solution , the oscillatory nature of @xmath108 invariably linked to the build - up of the isothermal compressibility s divergence for sub - critical temperatures prevent its use for @xmath214 : considering even the modest value @xmath215 , @xmath216 would have to be smaller than @xmath217 , which is obviously completely useless for any practical implementation .",
    "thus , even though it means loosing control over the level of accuracy in the solution , we have also implemented a version of this main part with predetermined step sizes that just happen to often be sufficient for reaching @xmath102 even well below the critical temperature while reproducing the overflow necessary for @xmath218 s divergence in a density interval the edges of which may then be identified with the coexisting phases densities @xmath117 and @xmath118 .",
    "recalling the behavior of @xmath116 wherever it is large we obviously have to drastically reduce @xmath137 as we approach @xmath219 ; for this we use the very prescription introduced by the authors of @xcite and evidently underlying all later published  calculations .",
    "one last aspect of this main part to be mentioned regards the choice of @xmath181 in both implementations : as the only reasonable initial condition for the core condition assumes that the structure at @xmath181 is basically the same as that for @xmath25 ( so that @xmath220 or , equivalently , @xmath221 , @xmath73 ) and the same set of parameters must also be used for the initialization of nodes at @xmath222 ( the nodes labled @xmath223 in fig .",
    "[ fig : grid ] in the first step ) , it is preferable to have @xmath224 at @xmath171 ; from eq .",
    "( [ eq : matrix : infty ] ) one immediately concludes that this is equivalent to @xmath225 whenever using the decoupling assumption .",
    "it is left to main part `` ansatz '' to decide whether @xmath181 should be determined in this way , thereby necessarily introducing @xmath29-dependent @xmath181 when dealing with a @xmath29-dependent potential .",
    "in the preceding sections we had to introduce a number of approximations , some of which may seem rather less justified ; their respective importance for and bearing on our program s predictions of structure and thermodynamics of simple liquids now remains to be assessed . as an exact solution with which to compare numerical results",
    "is lacking , for  as implemented by our software package to be considered a reliable tool well applicable to realistic physical potentials along the lines outlined so far it is necessary to demonstrate the limited effects variations in the numerical recipe have and to compare the results obtained with those available by other means for certain potentials . for this contribution",
    "we turn to the hard - core yukawa fluid with @xmath0 for illustration , a system that has also been considered in a recent study @xcite comparing various thermodynamically consistent approaches including  to short - ranged potentials .    among the approximations",
    "just mentioned , an important one is the necessary truncation of eq .",
    "( [ eq : matrix : infty ] ) to a finite number @xmath226 of basis functions @xmath63 and expansion coefficients @xmath64 , @xmath227 ; in fact , not only must @xmath228 be finite , it should also be rather small if evaluation of the slowly - convergent @xmath83-integrals at @xmath171 is not to dominate program execution time .",
    "an obvious test for the minimum number of basis functions to keep is to look at the @xmath228-dependence of the phase behavior predicted as summarized in table  [ tb : ncc ] , where the inverse critical temperature @xmath229 , the critical density @xmath230 , and the coexisting densities at @xmath231 are recorded ; the latter temperature is sufficiently far away from the critical point so that the differences in @xmath117 and @xmath118 are not merely to be attributed to the differences in @xmath229 while maintaining sufficient separation of the binodal from the boundaries at @xmath94 and @xmath55 ( _ v .  i. _ ) . from this",
    "we find inclusion of the core condition to be of vital importance in determining the fluid s phase behavior , while non - negligible variation of the results remains even for the highest @xmath228-values considered ; however , the amount of variation especially in @xmath229 drops significantly as soon as @xmath228 exceeds  5 . ",
    "the real test for the use of the truncated eq .",
    "( [ eq : matrix : infty ] ) and the _ ad hoc _ approximation ( [ eq : dqc2int : approx ] ) ( easily demonstrated to be inadequate at least for certain potentials @xcite ) , is the pair distribution function @xmath232 as obtained from the final values of the expansion coefficients @xmath233 by performing the inverse fourier transformation implied by the ornstein - zernike equation ( [ eq : oz ] ) : employing the s following from the consistent application of the decoupling assumption in order to isolate the approximations pertaining to the implementation of the core condition from other effects ( _ v .",
    "i. _ ) , the @xmath232 so obtained generally takes on rather large values for small @xmath23 while remaining within a few percent of the contact value @xmath234 for larger @xmath23 up to @xmath235 ; while increasing @xmath228 usually does not considerably reduce the magnitude of @xmath232 for @xmath23 close to  @xmath236 , it instead extends the @xmath23-range of rather small @xmath232 to ever smaller @xmath23 . at high density",
    "there is no substantial improvement in @xmath237 , @xmath238 , for @xmath239 , nor for @xmath240 at low density , a finding corroborated by direct inspection of the final values of the expansion coefficients @xmath233 @xcite .",
    "accordingly , @xmath228 should probably be chosen no less than 7 ( corresponding to a @xmath241 order polynomial in @xmath23 for @xmath242 inside the core ) , whereas @xmath243 may still be sufficiently accurate for some applications ; for @xmath244 , on the other hand , we can not expect significantly better results than those from consistently solving the  without implementing the core condition ( cf .",
    "sub - section [ sec : ansatz ] ) , which , of course , runs much faster and at least does not rely on inconsistent approximations . but note that the core condition is always but poorly met , irrespective of @xmath245 , whenever @xmath246 is large ( corresponding to the coexistence region or the critical point s vicinity in implementations relying on a ) . on the other hand ,",
    "when solving the  without implementing the core condition at all , @xmath232 , @xmath57 , can , of course , become arbitrarily large ; _ e.  g. _  for @xmath247 and @xmath248 , @xmath249 inside the core while the contact value is @xmath250 .",
    "all in all , while systematic shortcomings in the pair distribution function @xmath232 itself can not be avoided in an implementation relying on eqs .",
    "( [ eq : matrix : infty ] ) and ( [ eq : dqc2int : approx ] ) with finite @xmath228 , we needs must keep the core condition in the calculation due to its bearing on the phase behavior predicted ; this is somewhat at variance with earlier findings @xcite indicating only a modest influence of the core condition upon the results , a finding expressly referred to in @xcite .    on the other hand , as pointed out already in section  [ sec : theory ] , retaining the core condition is possible only when adopting the decoupling assumption , _ viz . _",
    "@xmath105 , an assumption that itself suffices to decouple the  to a set of s ( which is why we can use @xmath251 as a boundary condition ) .",
    "but if such a procedure is to be considered harmless , the results of the consistent application of this approximation to the closure  ( [ eq : closure ] ) should not differ much from those of the  applying the decoupling assumption only in order to get rid of the second @xmath90-integral in eq .",
    "( [ eq : matrix : infty ] ) . however , the calculations summarized in fig .",
    "[ fig : decoupling ] clearly show that the two approaches yield very different results so that we can not rule out a non - negligible effect on the structural and thermodynamic properties predicted : most importantly , the s can not reproduce well - defined phase boundaries , and they even yield slightly negative inverse compressibility @xmath110 in what would otherwise be the coexistence region . preserving the structure of the ,",
    "so that thermodynamic consistency is at least partly implemented by the s coefficients @xmath120 as defined in eq .",
    "( [ eq : d0i ] ) , seems sufficient to remedy these deficiencies ; at any rate , we have to accept the decoupling assumption as indispensable for the implementation of the core condition .",
    "let us now turn to a brief discussion of several other aspects of  in its present formulation and the potential problems they may present ; as most of these effects are much more prominent for the square - well and multistep potentials defined in sub - section [ sec : potential ] , we relegate more thorough treatment to @xcite .",
    " clearly , the importance of retaining the structure of a  mandates closer examination of the properties of the set of densities , especially since the terms corresponding to the finite difference approximation to the operator @xmath252 have been found the primary limiting factor for the quality of the numerical solution ( cf .  the definition of @xmath1 in sub - section  [ sec : solver ] ) ; while obvious for subcritical temperatures at low @xmath7 where the near - discontinuity of @xmath116 at the phase boundary betrays the smoothness assumptions underlying finite difference schemes , this is true even for rather small @xmath108 . for our hard - core yukawa system , however , the results stability with respect to a variation of the density grid or the location and nature of the high density boundary ( cf .  table  [ tb : ansatz ] ) is rather satisfactory as long as @xmath253 exceeds several @xmath184 : just as expected from fig .",
    "[ fig : decoupling ] , the  used at the boundary forces the corresponding density to lie outside the coexistence region , which carries over to nearby densities by virtue of the s discretization . despite the identical phase behavior found for different boundary conditions as evidenced by table  [ tb : ansatz ] , the question of which condition to impose at @xmath55 is far from irrelevant ; indeed , when imposing the /-condition @xmath254 at @xmath55 without making use of decoupling at all , inspection of the solution generated close to @xmath55 clearly shows the need to replace the original implementation s approach by an ansatz less inconsistent .  similarly , the stiffness of the  for subcritical temperatures shortly touched upon in section [ sec : theory ] is easily detected by employing the criteria discussed in sub - section  [ sec : solver ] ; still , for @xmath159 with @xmath0 and @xmath255 , using pre - determined step sizes and resigning on any control of the predictor - corrector scheme s convergence we obtain an approximate solution at @xmath219 sufficiently stable outside the coexistence region ; thus , while the solution generated in the region of large @xmath108 necessarily differs from the true solution in a fundamental way , the influence of which on the data produced outside the coexistence region is not assessed easily , stiffness here appears less pressing a concern than for other systems @xcite .",
    "in addition to the internal consistency of the results , we also have to make contact with data available by other means ; as this paper s purpose is presentation of our software and discussion of some general aspects of  rather than a comprehensive study of the hard - core yukawa system , we here restrict ourselves to the data of table  i of @xcite containing the predictions of various thermodynamically self - consistent liquid state theories including  in the original implementation , which are found to yield @xmath256 ranging from @xmath257 to @xmath258 ( @xmath259 between @xmath260 and @xmath261 ) , as well as the monte carlo ( ) result @xmath262 ( @xmath263 ) .",
    "as is apparent from our table  [ tb : ncc ] , our implementation s predictions for @xmath264 fall precisely into this range and , for @xmath265 , are well compatible with simulation results ; that very same @xmath228-range , on the other hand , we have seen ( _ v .",
    "s. _ ) is characterized by gross violation of the core condition due to an insufficient number of basis functions retained in the truncated eq .",
    "( [ eq : matrix : infty ] ) . as we further increase @xmath245 so that the core condition is obeyed to a certain extent ( _ v .",
    "s. _ ) , however , @xmath229 drops dramatically to values far outside the range quoted in @xcite ; while the trend of increasing @xmath229 evident for @xmath266 indicates that  might match the  predictions for @xmath267 , we have not performed these  intensive calculations .    with this",
    "we conclude our superficial sketch of the software we have written and the appraisal of the results it typically produces as illustrated for the hard - core yukawa potential @xmath159 with @xmath0 : it should be apparent that  in its current formulation , while presenting substantial difficulties discussed here as well as in @xcite , is well capable of predicting structural and thermodynamic properties of simple one - component fluids ; at the same time , the computational difficulties mentioned and the approximations introduced to render the numerics tractable can not always be shown to be harmless so that great care has to be exercised in the interpretation of isolated results .",
    "the fully modular design of our program and the high degree of flexibility brought about by the adoption of a meta language and code construction techniques are key factors in facilitating additional evaluations , providing a means of separating different approximations effects ; at the same time , our implementation makes for a versatile tool for the systematic exploration of  for one - component fluids in its present or alternative formulations .",
    "ar thanks g.  stell ( stony brook , n.y . ) and g.  pastore ( trieste ) for stimulating discussions , as well as d.  pini ( now in milan ) for sharing his experiences with hrt and the code of the original hrt program .",
    "the authors gratefully acknowledge support from _ sterreichischer forschungsfonds _ under project number p13062-tph .",
    "as noted in section  [ sec : theory ] , it is advantageous to replace the highly non - linear  in the modified free energy @xmath30 implied by eqs .",
    "( [ eq : dqa ] ) , ( [ eq : consistency ] ) , and the core condition , with a formulation akin to a quasi - linear one . in complete analogy",
    "to @xcite , we define the auxiliary function @xmath108 via @xmath268 in the ideal gas limit , _",
    "i.  e. _  for @xmath269",
    ", we immediately find from the divergence of the terms @xmath95 in @xmath96 and @xmath85 that @xmath270 = @xmath271 , which is a convenient boundary condition most implementations rely on . in the above definition",
    "we have taken advantage of some freedom regarding the @xmath116-term to reduce the number of floating - point multiplications ; as @xmath272 is usually chosen to be strictly proportional to @xmath273 , our @xmath116 differs only by a constant factor from the choice of @xcite which can be recovered by replacing the factor @xmath274 by @xmath275 ; note , however , that the expressions we give here remain valid for a slightly more general choice of @xmath272 , allowing the proportionality of the basis function and the perturbational part of the potential to hold only up to order @xmath276  a freedom that might be exploited to use more appropriate basis functions , giving @xmath38 a larger range in @xmath23-space . also we should point out that the condition of non - singular coefficients in the  ( [ eq : quasilinear ] ) , the very reason for the restriction on the relation between @xmath272 and @xmath273 just mentioned as well as for the introduction of the term involving @xmath277 , only fixes a minimum exponent for the @xmath278-factor with which to multiply @xmath116 @xcite .    inserting the above definition for @xmath116 into the relevant equations of section  [ sec : theory ] and eliminating the expansion coefficient @xmath91 via the consistency condition ( [ eq : consistency ] ) , we can easily re - cast the original  in the form of eq .",
    "( [ eq : quasilinear ] ) . dropping the obvious arguments and with the shorthand notations",
    "@xmath279 the coefficients of eq .",
    "( [ eq : quasilinear ] ) can be written as @xcite    @xmath280    when evaluating these expressions care has to be taken whenever @xmath141 is close to zero as all terms of orders @xmath281 and @xmath282 must cancel ; noting that @xmath283 , the coefficient of @xmath284 in @xmath285 , can be written in terms of the @xmath286-coefficient , in our numerical work the calculation of the terms affected by the cancellation for small @xmath141 proceeds via application of a fifth - order taylor expansion of @xmath287 ; one should note that , even though the criterion for switching between the full analytic expressions and said expansion depends on @xmath1 , the order of this expansion ( and a similar one for @xmath288 ) is not increased for very small values of @xmath1 , which is one of the few hard - coded limitations of our program .",
    "from the given expressions for the @xmath120 two more aspects are obvious : ( i ) there is substantial further simplification for a @xmath29-independent potential ( as @xmath272 depends upon the density only through the perturbational part @xmath273 of the potential , and the basis functions entering @xmath289 only through the reference system s hard - core radius @xmath59 ) , and ( ii ) the  does not fall into the class of quasi - linear s due to the presence of the second @xmath29-derivative of @xmath290 in the coefficient @xmath285 .",
    "while the basis function @xmath291 in the closure ( [ eq : closure ] ) is fixed by the potential used , in principle there is ample freedom in choosing the @xmath104 , @xmath70 . of course , when truncating eq .",
    "( [ eq : matrix : infty ] ) after @xmath82 basis functions it is natural to ask for the set @xmath292 to span the space of polynomials of order up to @xmath293 , so that @xmath104 will generally be a polynomial or order @xmath294 in @xmath23 ; but whereas different polynomials of this type do not alter the function space , their choice has implications for the numerical properties of the matrix equations implementing the core condition as well as , to a certain extent , for the convergence of the @xmath90-integrals to be evaluated at @xmath171 ( cf .",
    "sub - section  [ sec : ansatz ] ) .",
    "other than the original implementation that relied on an affine transformation of the legendre polynomials , we found it convenient to choose @xmath69 simply proportional to a power of @xmath23 and normalized to @xmath295 .",
    "thus , dropping the obvious argument @xmath29 , we have @xmath296 the fourier transform of which is @xmath297,\\ ] ] an expression used for @xmath298 only for numerical reasons . for smaller @xmath165",
    "we rely on the expansion @xmath299 truncating the series after @xmath300 terms , where @xmath300 is the smallest number such that @xmath301}_{n_n}\\ ] ] with a customization factor @xmath302}_{n_n}$ ] of order unity .",
    ".dependence of inverse critical temperature @xmath259 , coexisting densities @xmath117 and @xmath118 at @xmath231 , and critical density @xmath230 for a hard - core yukawa potential with @xmath0 on the number of basis functions .",
    "the results reported have been obtained from s retaining @xmath226 basis functions or ( first line ) not implementing the core condition at all , with @xmath303 and @xmath304 .",
    "we have checked that the differences summarized here can not be explained by the @xmath228-dependence of the upper integration limits in evaluating the @xmath305-integrals ( cf.sub-section  [ sec : ansatz ] ) . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> combining renormalization group theoretical ideas with the integral equation approach to fluid structure and thermodynamics , the hierarchical reference theory is known to be successful even in the vicinity of the critical point and for sub - critical temperatures . </S>",
    "<S> we here present a software package independent of earlier programs for the application of this theory to simple fluids composed of particles interacting via spherically symmetrical pair potentials , restricting ourselves to hard sphere reference systems . using the hard - core yukawa potential with @xmath0 for illustration </S>",
    "<S> , we discuss our implementation and the results it yields , paying special attention to the core condition and emphasizing the decoupling assumption s _ </S>",
    "<S> rle_.    # 1^(#1 )    c_2  </S>"
  ]
}