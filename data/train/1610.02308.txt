{
  "article_text": [
    "characterizing couplings between interacting systems plays an important role in numerous scientific fields , ranging from physics to the neurosciences  @xcite . over the last years",
    ", a large number of linear and nonlinear analysis techniques has been proposed to reveal couplings from passive observations of the systems behavior , e.g. , from time series of certain observables , and thus allow a data - driven quantification of the strength and direction of an interaction  @xcite .",
    "knowing interaction properties is important for the construction of functional network structures in diverse scientific fields  @xcite . among these techniques ,",
    "the information - theoretic concept of transfer entropy @xcite provides a model - free approach to characterizing directed interactions , because it can be viewed as transfers of information .",
    "transfer entropy is related to the concept of granger causality @xcite and to conditional mutual information @xcite , and has widely been used to distinguish the driving and responding elements and to detect asymmetry in the interaction of subsystems in various scientific fields . since its invention , techniques that allow a data - driven estimation of transfer entropy are being steadily improved  @xcite . among these improvements",
    "are methods that allow one to characterize information transfers at various time scales by incorporating delays  @xcite . knowing coupling delays is of importance as it allows for improved physical interpretations  @xcite .    in ref .",
    "@xcite , symbolic transfer entropy has been proposed as a permutation analogue of transfer entropy and constitutes an efficient and conceptually simple way of robustly quantifying the dominating direction of flow of information between time series from observed data . using this approach ,",
    "transfer entropy is estimated from the probabilities of ordinal patterns that are derived from the amplitude values of the time series via symbolization  @xcite .",
    "symbolic transfer entropy has been used to study interactions in various disciplines ranging from quantum  @xcite and laser physics  @xcite via neurology  @xcite , cardiology  @xcite and anesthesiology  @xcite to the neurosciences  @xcite .",
    "recently , an ordinal time series analysis technique has been introduced that detects the direction and the coupling delays of information exchange in coupled systems  @xcite . here",
    "we follow this line of approach and propose a straightforward extension of symbolic transfer entropy , which we refer to as delayed symbolic transfer entropy .",
    "this paper is organized as follows . in sec .",
    "[ sec_methods ] we briefly recall the definition of symbolic transfer entropy before we present our extension to detect coupling delays and to quantify the dominating direction of flow of information . in sec .",
    "[ sec_logistic_map ] we present our numerical simulation studies that aim at demonstrating the applicability of our method and at exploring its limitations . in sec .",
    "[ sec_eeg ] we present our findings obtained from inferring delayed directed interactions in the human epileptic brain before we draw our conclusions in sec .",
    "[ sec_conclusion ] .",
    "let @xmath0 and @xmath1 with @xmath2 denote time series of observables of systems @xmath3and @xmath4 .",
    "relating previous samples @xmath5 and @xmath6 in order to predict @xmath1 allows for a quantification of the deviation from the generalized markov property , @xmath7 , where @xmath8 denotes the conditional transition probability density . if system  @xmath3has no influence on system  @xmath4 , there is no deviation from the markov property .",
    "transfer entropy quantifies the incorrectness of this assumption and is formulated as kullback ",
    "leibler entropy between @xmath9 and @xmath10 .",
    "transfer entropy is non - symmetric under the exchange of  @xmath3and  @xmath4 .    in order to estimate the transition probabilities , the authors of ref .",
    "@xcite proposed to use a symbolization technique with symbols that are derived from reordering the amplitude values of time series  @xcite .",
    "let @xmath11  and  @xmath12denote the lag and embedding dimension , which have to be chosen appropriately for symbolization  @xcite , e.g. , by making use of embedding theorems  @xcite .",
    "then @xmath12amplitude values @xmath13 for a given , but arbitrary time @xmath14 are arranged in ascending order @xmath15 with rank  @xmath16 and @xmath17 .",
    "equal amplitude values are arranged by their time index , i.e. , such that @xmath18 if @xmath19 .",
    "this ensures that every @xmath20 is uniquely mapped onto one of the @xmath21 possible permutations , and a permutation symbol is defined as @xmath22 relative frequencies of symbols provide an estimator for joint and conditional probabilities of the sequences of permutation indices . with given symbol sequences @xmath23 and @xmath24 , symbolic transfer entropy is defined as  @xcite : @xmath25 where the sum runs over all symbols .",
    "@xmath26 is defined in complete analogy .",
    "@xmath27 is positive and explicitly non - symmetric under exchange of @xmath3and @xmath4since it measures the flow of information from @xmath3to @xmath4and not vice versa .",
    "the difference @xmath28 provides an estimate for the dominating flow of information and thus for the dominating direction of interaction .",
    "when analyzing empirical data , one often needs to account for delayed interactions ( cf .",
    "[ fig_coupling_scheme ] ) , where the flow of information from system @xmath3to system @xmath4needs some finite time @xmath29 ( and/or @xmath30from @xmath4to @xmath3 )  @xcite . addressing this issue , we here extend eq .",
    "[ eq_ste ] and allow for symbols in transition probabilities that are @xmath31(@xmath32 ) time steps past the actual symbol : @xmath33 @xmath31denotes the number of time steps into the systems own past and @xmath32the number of time steps into the past of the influencing system , i.e. , the system from which we expect the flow of information .",
    "we therefore did not interchange the parameters @xmath31and @xmath32 in the definition of @xmath34 .",
    "if there is a delayed flow of information from @xmath3to @xmath4(from @xmath4to @xmath3 ) and if @xmath35 ( @xmath36 ) , we expect _ delayed symbolic transfer entropy _",
    "@xmath37 ( @xmath34 ) to attain highest values for all @xmath31 .",
    "the use of the parameter @xmath31may seem somewhat arbitrary , but we will see in the next section that @xmath34 ( @xmath37 ) carries additional information for specific pairs @xmath38 , which can assist in detecting delayed directed interactions in empirical data . in the aforementioned definitions of entropies",
    ", we use a logarithm to base 2 , thus entropies are given in bit .",
    "in the following , we investigate the conditions under which delayed symbolic transfer entropy allows one to infer the coupling delays @xmath39and @xmath30and the direction of interaction . mimicking a typical experimental situation with a priori unknown coupling delays ,",
    "we perform a parameter scan with ( @xmath40 in a range where we expect our maximum coupling delays .",
    "we consider two delay - coupled logistic maps  @xcite @xmath41 with @xmath42 where @xmath43denotes the strength of coupling between systems @xmath3and @xmath4 , and @xmath44the respective strength between @xmath4and @xmath3 . for a slight mismatch of control parameter ( @xmath45 ) as well as for given coupling strengths ( @xmath43 ,  @xmath44 ) and coupling delays ( @xmath39 ,  @xmath30 ) , we generate 20 realizations of the system by randomly choosing the initial conditions ( @xmath46 ,  @xmath47 ) from the unit interval .",
    "these time series consist of @xmath48data points each after @xmath49 transients .",
    "if not stated otherwise , we will report mean values of the delayed symbolic transfer entropies obtained from the 20  realizations of the coupled systems .",
    "( top ) and @xmath34 ( middle ) and of the directionality index @xmath50(bottom ) for unidirectionally delay - coupled logistic maps ( @xmath51 , @xmath52 ; embedding parameters @xmath53 , @xmath54 ; @xmath55 data points ) .",
    "amplitude values are scaled linearly in @xmath56 $ ] and logarithmically otherwise . ]    in  fig .",
    "[ fig_logistic_te_single ] we show , as an example , @xmath37 , @xmath34 , and the _ directionality index _",
    "@xmath57 for unidirectionally delay - coupled maps ( @xmath58 and @xmath52 ) obtained with embedding parameters @xmath53 and @xmath59 and @xmath55 data points .",
    "when comparing findings for @xmath37 with those for @xmath34 there are two prominent effects :    first , if @xmath35 and for all @xmath31 , @xmath37 attains highest values ( up to three orders of magnitude larger than for other pairs ( @xmath60 ) , upper part of  fig .  [ fig_logistic_te_single ] ) , as expected and given our definition of delayed symbolic transfer entropy . in the following , we will refer to this structure as _ resonance - like pattern_.    second , we observe @xmath37 to attain lowest values , if @xmath61 and @xmath62 .",
    "the same holds for @xmath34 , if @xmath63 and @xmath64 .",
    "interestingly , this strongly diminished ( or even absent ) flow of information for these _ secondary diagonals _ in the plots shown in  fig .  [ fig_logistic_te_single ] ( upper part : upper diagonal ; middle part lower diagonal ) also provide information about delay and direction of interaction . for exactly these pairs ( @xmath60 ) , the delayed flow of information has just taken place and thus these past states of system  @xmath3and  @xmath4provide almost the same amount of information for the current state of system  @xmath4(cf .",
    "[ fig_coupling_scheme ] ) .",
    "this leads to only a few combinations of symbols contributing to the transition probabilities .",
    "consequently , the ratio of conditional probabilities in  eq .  [ eq_dste_single ] approaches 1 and thus @xmath37 approaches  0 ( the same holds for @xmath34 ) .",
    "for all other pairs ( @xmath60 ) not considered yet ( referred to as _ background _ in the following ) , the delayed flow of information @xmath37 ( @xmath34 ) only approaches  0 for an increasing number of data points and for appropriately chosen embedding parameters ( see above ) . for a wide range of coupling strengths differentiability of the secondary diagonals from the background ( i.e.",
    ", the difference to the background ) is thus best for small numbers of data points accompanied by non - optimally chosen embedding parameters as is often the case when analyzing empirical data . as an example , for embedding parameters @xmath65 and @xmath54 , which are optimal for the system considered here , differentiability is almost  0 for @xmath66 but increases almost exponentially with decreasing the number of data points to  @xmath67 .",
    "the directionality index @xmath50 , as defined here , provides information about delay and direction of interaction .",
    "if we exchange system  @xmath4for @xmath3 , this leads to a change of sign of values of the directionality index @xmath50 , since the resonance - like pattern and the upper secondary diagonal can now be observed with @xmath34 and the lower secondary diagonal with @xmath37 .    note that for @xmath68 , delayed symbolic transfer entropies correspond to the non - delayed ones and fail to correctly detect the delayed coupling , as expected ( cf .",
    "[ fig_coupling_scheme ] ) . since @xmath69",
    ", this also applies for the direction of interaction , independent on coupling strength , number of data points , and embedding parameters ( at least for the cases considered in this section ) .      for unidirectionally coupled maps ( @xmath70 ) with coupling delays @xmath71 and coupling strengths @xmath72 $ ] , we generate time series consisting of @xmath73 data points and estimate @xmath50for embedding dimensions @xmath74 and lags @xmath75 ( cf .",
    "@xcite ) .        in fig .",
    "[ fig_logistic_numdp ] we demonstrate exemplarily , how inference depends on the number of data points  @xmath48and on the embedding dimension  @xmath12 .",
    "when decreasing  @xmath48 , the amplitude of the resonance - like pattern decreases and , dependent on the chosen embedding dimension  @xmath12 , even vanishes . instead , for smaller  @xmath48 , the secondary diagonals can be observed . as a rule of thumb ( and at least for the systems investigated here ) , @xmath76 marks the border above which delay and direction of interactions can be inferred from the resonance - like pattern . below this border but above a lower",
    "bound which depends on system properties , the same information can be inferred from the secondary diagonals .",
    "the width of the patterns increases linearly with the embedding dimension  @xmath12 .",
    "this broadening can be attributed to the applied symbolization technique  @xcite , since the overlap of symbols grows linearly with the embedding dimension  @xmath12(cf .",
    "[ fig_coupling_scheme ] ) .",
    "the influence of the embedding lag  @xmath11is demonstrated exemplarily in  fig .",
    "[ fig_logistic_embedding ] for the resonance - like pattern .",
    "for given @xmath48  and  @xmath12and with @xmath77 , highest values of @xmath50can still be observed for @xmath78 and for all  @xmath31 , but we observe additional resonance - like patterns , if @xmath79 , for @xmath80 , however with lower values of @xmath50 . within these patterns , @xmath50attains lower values if @xmath81 , which again is linked to the applied symbolization technique . for these conditions ,",
    "permutation symbols share up to @xmath82 amplitude values and are therefore not independent .",
    "analogous observations hold for the secondary diagonals , and we obtained similar findings for other coupling delays .          in the following",
    ", we fix the embedding parameters ( @xmath65 and @xmath54 ) and investigate the impact of type and strength of coupling on the inference of delayed directed interactions . for unidirectional couplings with delay @xmath52",
    "we show , in  fig .",
    "[ fig_logistic_coupling_comparison ] , the dependence of delayed symbolic transfer entropies on the coupling strength and for two numbers of data points .",
    "we make use of a priori knowledge for which pairs ( @xmath60 ) we can expect the resonance - like pattern ( @xmath83 , upper row ) and the secondary diagonals ( @xmath84 , middle row , and @xmath85 , lower row ) ; the assignments for the opposite direction @xmath86 are analogous .",
    "in addition , we show the mean of both directions for a pair ( @xmath60 ) , for which there is no pattern , i.e. , from the background : @xmath87 .    for a larger number of data points ( here @xmath88 ) the flow of information can be inferred even for small coupling strengths ( @xmath89 ) and differentiability of @xmath90 from the background increases with increasing coupling strength up to a maximum at @xmath91 , for which the systems are lag - synchronized ( fig .  [ fig_logistic_coupling_comparison ] , upper row ) .",
    "for larger coupling strengths differentiability remains at its maximum value . for the opposite direction",
    ", there is no flow of information and we obtain @xmath92 for all coupling strengths , as expected . for smaller number of data points ( here @xmath93 ) , standard deviations of estimates",
    "are generally enlarged , as expected .",
    "in addition , mean values of estimates are increased , and the increase is stronger for @xmath94 ( and @xmath95 ) than for @xmath90 .",
    "inference of flow of information is thus diminished and restricted to coupling strengths @xmath96 .",
    "making use of information gained from the upper secondary diagonal ( fig .",
    "[ fig_logistic_coupling_comparison ] , middle row ) , the deviation of @xmath97 from @xmath94 for @xmath98 and  @xmath88 also indicates the inference of flow of information . for  @xmath93",
    ", inference can already be achieved for @xmath99 .",
    "again , @xmath100 for all coupling strengths and number of data points .",
    "note , however , that both means and standard deviations of estimates are increased by one order of magnitude when decreasing  @xmath48from @xmath101  to  @xmath102 .",
    "an even better inference of flow of information can be achieved from information gained from the lower secondary diagonal ( fig .",
    "[ fig_logistic_coupling_comparison ] , bottom row ) .",
    "although similar observations can here be made for means and standard deviations of estimators , @xmath103 ( and not @xmath104 , given our definitions ; see  eq .",
    "[ eq_dste ] ) deviates clearly from @xmath94 for coupling strengths @xmath105 for both numbers of data points considered here .    summarizing these findings , in the case of smaller number of data points ,",
    "directed interactions can be inferred for a larger range of coupling strengths with information from the lower secondary diagonal ( @xmath103 ) than from the resonance - like pattern ( @xmath90 ) .    for bidirectionally delay - coupled maps ,",
    "similar observations can be made ( data not shown here ) , as long as the coupling delays @xmath39  and  @xmath30as well as the coupling strengths @xmath43  and  @xmath44are not identical .",
    "even for the case @xmath106 the dominating delayed flow of information can be inferred , if the coupling strengths are sufficiently different ( cf .  fig .",
    "[ fig_logistic_coupling_comparison ] ) . as before ,",
    "inference is influenced by alterations of the patterns ( the resonance - like pattern and the secondary diagonals ) related to the choice of embedding parameters necessary for the applied symbolization technique .",
    "next we estimate the performance of our method , particularly with respect to the analysis of empirical data , by investigating the influence of noise on the inference of delayed directional couplings . for unidirectional couplings with delay @xmath52",
    ", we add noise to the time series @xmath0 of the driver and to the time series @xmath1 of the responder , and estimate @xmath50for signal - to - noise ratios @xmath107 $ ] ( @xmath108 , where @xmath109 and @xmath110 denote the standard deviations of the noise - free and the noise - contaminated time series ) .",
    "we use different types of noise as well as different noise - contamination schemes .",
    "with gaussian @xmath111-correlated noise , we simulate measurement errors , and with the concept of surrogates  @xcite , we generate in - band noise from the original time series , thus mimicking observational noise .",
    "the surrogate time series have a power spectrum and a distribution of amplitude values that are identical to those of the original time series . with each of these types of noise",
    "we contaminate both time series , @xmath0  and  @xmath1 , using either the same  @xmath112__(symmetric noise contamination ) _ _ or different  @xmath112for the driver and responder _ ( asymmetric noise contamination)_. the latter contamination scheme is more likely in field applications and is known to affect various time series analysis techniques aiming at an inference of the direction of interactions  @xcite .    in  fig .",
    "[ fig_logistic_noiselevel ] , we show exemplary findings for a symmetric contamination with in - band noise . for various @xmath112we plot the dependence of delayed symbolic transfer entropies on the coupling strength and for different number of data points .",
    "as in the previous subsection , we restrict ourselves to the pairs ( @xmath60 ) for which we can expect the correct direction of flow of information from the resonance - like pattern ( @xmath90 ) and from the secondary diagonals ( @xmath97 and @xmath103 ) .",
    "as expected , differentiability of all estimators of flow of information from the background @xmath94 decreases with an decreasing signal - to - noise ratio .",
    "likewise , the range of coupling strengths for which directed interactions can be inferred shrinks with decreasing the signal - to - noise ratio and is shifted towards higher coupling strengths . for a smaller number of data points , the inference of flow of information and with this the direction of interaction gained from the secondary diagonals ( @xmath97 and",
    "@xmath103 ) is more robust to noise contaminations than for a larger number of data points .",
    "as expected , the opposite is true for the inference gained from the resonance - like pattern ( @xmath90 ) .",
    "we obtained similar findings for the other types of noise and contamination schemes .",
    "taking advantage of the conceptual simplicity , efficiency , and robustness of symbolic transfer entropy , we demonstrated that our extension allows to infer of delayed directed interactions .",
    "our method provides information about delay and direction of couplings even for smaller number of data points and , moreover , for the case of a non - optimal choice of embedding parameters used for the symbolization .",
    "this renders delayed symbolic transfer entropy attractive for the analysis of empirical data .                   [ fig_fielddata_implscheme ]    in this section , we apply our method to check whether consistent delayed directed interactions between brain regions can be inferred from long - lasting , multichannel electroencephalographic ( eeg ) recordings .",
    "the eeg was recorded from an epilepsy patient using electrodes implanted under the skull , hence with high signal - to - noise ratio , prior to surgical treatment of a focal epilepsy .",
    "the patient had signed informed consent that her / his clinical data might be used and published for research purposes .",
    "the study protocol had previously been approved by the ethics committee of the university of bonn .",
    "we here consider eeg recordings from strip electrodes ( 8 or 16 contacts ) placed onto the cortex and from a pair of needle - shaped depth electrodes with 10 contacts each , implanted into deeper structures of the brain ( see upper left part of  fig .",
    "[ fig_fielddata_implscheme ] ) .",
    "data were sampled at ( sampling interval @xmath113 ) using a 16  bit analog - to - digital converter and filtered within the frequency band  .    for our analyses ,",
    "we consider a continuous recording of duration during the seizure - free interval , which covered different physiologic and pathophysiologic states of the patient . here",
    "we restrict ourselves to eeg data from six recording sites ( see upper part of  fig .",
    "[ fig_fielddata_implscheme ] ) : two from within the epileptic focus ( tr01 and tr05 ) , one remote site on the same brain hemisphere ( tlr04 ) , and three from homologous positions on the other brain hemisphere ( tl01 , tl05 , and tll04 ) .",
    "a widely used approach to analyze the dynamics of non - stationary systems is to perform the analysis in sliding windows with a duration , for which the dynamics can be regarded as approximately stationary . for the eeg , the duration of such a window typically amounts to duration  @xcite . using this approach",
    ", we perform  for each combination of pairs of recording sites  a time resolved estimation of delayed symbolic transfer entropies from non - overlapping eeg segments of duration ( corresponding to 4096 data points ) . following ref .",
    "@xcite , we set embedding parameters to @xmath114 and @xmath115 .",
    "since time delays in the human brain can vary considerably , depending on brain regions and functions , and may reach up to @xcite , we estimate @xmath50with @xmath116{ms } , \\ldots , \\unit[250]{ms}\\}$ ] . moreover , by time - averaging separately over all windows for data recorded during day and during night times",
    ", we check whether major delays as well as preferred directed interactions can be identified and whether delay and direction depend on the state of consciousness ( awake vs. asleep ) . in  fig .",
    "[ fig_fielddata_results ] , we show the mean directionality indices  @xmath50separately for data from day and night times for three exemplary pairs of recording sites . in general , we do not observe the resonance - like patterns , which is to be expected given the number of data points and embedding parameters .",
    "for some cases , however , we observe secondary diagonals , from which we can extract information about delay and direction of an interaction . in particular , we observe a consistent driving with an average delay of ( ) from posterior ( position tl05 ) to anterior sites ( position tl01 ) within the non - epileptic ( left ) mesial temporal brain structures both during day and night times ( upper right part of figure ) . for homologous recording sites within the epileptic ( right ) mesial temporal brain structures a similar directed driving with an average delay of ( ) can be observed for data recorded during night times ( lower left part of figure ) .",
    "this delay is comparable to findings gained from analyses of propagation of specific patterns during seizures  @xcite . identifying a delay for data recorded during day times , however , is more demanding , possibly due to multiple delays ( which may be associated with the epileptic process ) . interestingly , for @xmath68 , for which @xmath50corresponds to the non - delayed directionality index , we observe the direction of driving to be reversed , i.e. , from anterior to posterior sites",
    ". our findings for long - ranged interactions between regions in the left and right temporal lateral neocortex ( lower right part of figure ) also point to multiple delays , and it remains to be shown whether they differ from those obtained for the short - ranged interactions within the epileptic focus . for data recorded during day times , the brain region in the right temporal lateral neocortex constantly drives the homologous brain region in the left hemisphere .",
    "this unidirectional driving vanishes for data recorded during night times , and we can only speculate whether this is due to , e.g. , a bidirectional interhemispheric driving or a diminished interhemispheric interaction during sleep ( cf .",
    "we have proposed a straightforward extension of symbolic transfer entropy  @xcite that enables the inference of delayed directional relationships between coupled dynamical systems from time series . with numerical examples , which are representative of interacting chaotic systems contaminated with noise",
    ", we have exemplified the applicability of our approach and have shown that delay and direction of an interaction can be inferred with delayed symbolic transfer entropy even for smaller number of data points and , moreover , with non - optimally chosen parameters for the applied symbolization technique  @xcite . applying our method to infer delayed directed interactions in the human epileptic brain , we could show that major interaction delays can be identified , particularly from short - ranged interactions , and that these delays are influenced by the pathophysiology and by physiologic states of the brain .",
    "moreover , we could also show , that not taking into account possible delays in interactions can lead to a possibly erroneous inference of the direction of interactions .",
    "our approach can thus help to avoid misinterpretations and to further improve the construction of functional network structures from data  @xcite .    at present",
    ", our approach requires estimating the directionality index @xmath50with parameters ( @xmath117 ) in a range where we expect maximum coupling delays .",
    "although a more direct detection of coupling delays would be preferable , we note that the identification of delayed directed interactions from time series ( 4096 data points , embedding dimension @xmath114 ) for all @xmath118 can be performed in about on a cpu core due to the underlying conceptual simplicity , efficiency , and robustness of symbolic transfer entropy .",
    "we are grateful to gerrit ansmann , christian geier , stephan porz , and alexander rothkegel for critical comments on earlier versions of the manuscript .",
    "this work was supported by the deutsche forschungsgemeinschaft ( grant no : le 660/5 - 2 ) ."
  ],
  "abstract_text": [
    "<S> we propose a straightforward extension of symbolic transfer entropy to enable the investigation of delayed directional relationships between coupled dynamical systems from time series . </S>",
    "<S> analyzing time series from chaotic model systems , we demonstrate the applicability and limitations of our approach . </S>",
    "<S> our findings obtained from applying our method to infer delayed directed interactions in the human epileptic brain underline the importance of our approach for improving the construction of functional network structures from data .    </S>",
    "<S> 20cm(3cm,27 cm ) published as phys .  </S>",
    "<S> rev .  </S>",
    "<S> e * 90 * , 062706 ( 2014 ) . </S>",
    "<S> copyright 2014 by the american physical society . </S>"
  ]
}