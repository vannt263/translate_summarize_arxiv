{
  "article_text": [
    "this article is concerned with the numerical computation of the extended kohn - sham ground states of atoms for the reduced hartree - fock ( rhf , also called hartree ) and lda ( local density approximation ) models  @xcite .",
    "we consider the case of an isolated atom , as well as the case of an atom subjected to cylindrically symmetric external potential .",
    "we notably have in mind stark potentials , that are potentials of the form @xmath1 generated by a uniform electric field @xmath2 .",
    "we first propose a method to accurately solve the extended kohn - sham problem for cylindrically symmetric systems , using spherical coordinates and a separation of variables .",
    "this approach is based on the fact that , for such systems , the kohn - sham hamiltonian commutes with @xmath3 , the @xmath4-component of the angular momentum operator , @xmath4 denoting the symmetry axis of the system .",
    "we obtain in this way a family of 2d elliptic eigenvalue problems in the @xmath5 and @xmath6 variables , indexed by the eigenvalue @xmath7 of @xmath3 , all these problems being coupled together through the self - consistent density . to discretize the 2d eigenvalue problems , we use harmonic polynomials in @xmath6 ( or in other words , spherical harmonics @xmath8 , which only depend on @xmath6 ) to discretize along the angular variable , and high - order finite element methods to discretize along the radial variable @xmath9 $ ] .",
    "we then apply this approach to study numerically two kinds of systems .",
    "first , we provide accurate approximations of the extended kohn - sham ground states of all the atoms of the first four rows of the periodic table .",
    "these results allow us to test numerically the assumptions on the negative spectra of atomic rhf and kohn - sham lda hamiltonians that we used in previous theoretical works on density functional perturbation theory  @xcite and norm - conserving semilocal pseudopotentials  @xcite .",
    "we show in particular that for most atoms of the first four rows of the periodic table , the fermi level is negative and is not an accidentally degenerate eigenvalue of the rhf hamiltonian .",
    "we also observe that there seems to be no unoccupied orbitals with negative energies . on the other hand , for some chemical elements",
    ", the fermi level seems to be an accidentally degenerate eigenvalue ( for example the rhf 5s and 4d states of the palladium atom seem to be degenerate ) . for a few of them ,",
    "this accidentally degenerate eigenvalue is so close to zero that our calculations do not allow us to know whether it is slightly negative or equal to zero .",
    "for instance , our simulations seem to show that the 5s and 3d states of the iron atom seem to be degenerate at the rhf level of theory , and the numerical value of their energy we obtain with our code is about @xmath10 ha .",
    "second , we study an atom subjected to a uniform electric field ( stark effect ) . in this case",
    ", the system has no ground state ( the kohn - sham energy functional is not bounded below ) , but density functional perturbation theory ( see @xcite for a mathematical analysis ) can be used to compute the polarization of the electronic cloud caused by the external electric field .",
    "the polarized electronic state is not a steady state , but a resonant state , and the smaller the electric field , the longer its life time .",
    "another way to compute the polarization of the electronic cloud is to compute the ground state for a small enough electric field in a basis set consisting of functions decaying fast enough at infinity for the electrons to stay close to the nuclei .",
    "the gaussian basis functions commonly used in quantum chemistry satisfy this decay property . however , it is not easy to obtain very accurate results with gaussian basis sets , since they are not systematically improvable ( over - completeness issues ) .",
    "here we consider instead basis functions supported in a ball @xmath11 , where @xmath12 is a numerical parameter chosen large enough to obtain accurate results and small enough to prevent electrons from escaping to infinity ( for a given , small , value of the external electric field @xmath13 ) .",
    "we study the ground state energy and density as functions of the cut - off radius @xmath12 , and observe that for a given , small enough , uniform electric field , there is a plateau @xmath14 $ ] on which these quantities hardly vary . for @xmath15 ,",
    "the simulated system is too much confined , which artificially increases its energy , while for @xmath16 , a noticeable amount of charge accumulates at the boundary of the simulation domain , in the direction of @xmath13 ( where the potential energy is very negative ) . on the other hand , for @xmath17",
    ", the simulation provides a fairly accurate approximation of the polarization energy and the polarized density .",
    "the article is organized as follows . in section  [ sec : modeling ] , we recall the mathematical formulation of the extended kohn - sham model , and some theoretical results about the rhf and lda ground states of isolated atoms and of atoms subjected to an external cylindrically symmetric potential . in section  [ sec : numerical - method ] , we describe the discretization method and the algorithms used in this work to compute the extended kohn - sham ground states of atoms subjected to cylindrically symmetric external potentials .",
    "some numerical results are presented in section  [ sec : results ] .",
    "in this article , we consider a molecular system consisting of a single nucleus of atomic charge @xmath18 and of @xmath19 electrons . for @xmath20 ,",
    "this system is the neutral atom with nuclear charge @xmath21 , which we call atom @xmath21 for convenience .      in the framework of the ( extended ) kohn - sham model  @xcite ,",
    "the ground state energy of a system with one nucleus with charge @xmath21 and @xmath19 electrons is obtained by minimizing an energy functional of the form @xmath22 over the set @xmath23 where @xmath24 is the space of the self - adjoint operators on @xmath25 and @xmath26 .",
    "note that , @xmath27 is a closed convex subset of the space @xmath28 defined by @xmath29 endowed with norm @xmath30    the function @xmath31 is the attraction potential induced on the electrons by the nucleus , and @xmath32 is the density associated with the one - body density matrix @xmath33 . for @xmath34 , we have @xmath35 the last result is the hoffmann - ostenhof inequality  @xcite . therefore @xmath36 , and in particular , @xmath37 . for @xmath38 ,",
    "@xmath39 is equal to @xmath40 , where @xmath41 is the coulomb , also called hartree , potential generated by @xmath42 : @xmath43 recall that @xmath41 can be seen as a unitary operator from the coulomb space @xmath44 to its dual @xmath45 , where @xmath46 and @xmath47    the term @xmath48 is the exchange - correlation energy .",
    "we will restrict ourselves to two kinds of kohn - sham models : the rhf model , for which the exchange - correlation energy is taken equal to zero @xmath49 and the kohn - sham lda ( local density approximation ) model , for which the exchange - correlation energy has the form @xmath50 where @xmath51 is the sum of the exchange and correlation energy densities of the homogeneous electron gas .",
    "as the function @xmath52 is not explicitly known , it is approximated in practice by an explicit function , still denoted by @xmath51 for simplicity .",
    "we assume here that the approximate function @xmath51 is a @xmath53 function from @xmath54 into @xmath55 , twice differentiable on @xmath56 and obeying the following conditions @xmath57 note that these properties are satisfied by the exact function @xmath51 .",
    "they are also satisfied by slater s x@xmath0 model for which @xmath58 , where @xmath59 is the dirac constant .",
    "this model is used in the simulations reported in section  [ sec : results ] .",
    "the minimization set @xmath27 defined in  ( [ eq : admissibledm ] ) is the set of _ real spin - unpolarized _ first - order reduced density matrices .",
    "we will call its elements _ non - magnetic states_. the general ( complex non - collinear spin - polarized , see e.g.  @xcite ) rhf model being convex in the density matrix , and strictly convex in the density , the general rhf ground state density of a given molecular system in the absence of magnetic field , if it exists , is unique , and one of the minimizers is a non - magnetic state . indeed , using the notation of  @xcite , if @xmath33 is a complex non - collinear spin - polarized ground state , the non - magnetic state @xmath60 where @xmath61 is the complex conjugate ( not the adjoint ) of the operator @xmath62 , is a non - magnetic ground state .",
    "the general rhf ground state energy and density of a molecular system in the absence of magnetic field can therefore be determined by minimizing the rhf energy functional over the set @xmath27 .",
    "the lda model is not _ a priori _ strictly convex in the density , but it is convex over the set of complex non - collinear spin - polarized density matrices having a given density @xmath42 .",
    "therefore , the general lda ground state energy and densities can be obtained by minimizing the lda energy functional over the set @xmath27 .",
    "in contrast , this argument does not apply to the local spin density approximation ( lsda ) model , whose ground states are , in general , spin - polarized .    to avoid ambiguity , for any @xmath21 and @xmath19 in @xmath63 , we denote by @xmath64 where @xmath65 and @xmath66 where @xmath67    we recall the following two theorems which ensure the existence of ground states for neutral atoms and positive ions .",
    "let @xmath68 and @xmath69 . then the minimization problem ( [ eq : min_rhf ] ) has a ground state @xmath70 , and all the ground states share the same density @xmath71 .",
    "the mean - field hamiltonian @xmath72 is a bounded below self - adjoint operator on @xmath73 , @xmath74 , and the ground state @xmath70 is of the form @xmath75 where @xmath76 is the fermi level , @xmath77 and @xmath78 .",
    "if @xmath79 is negative and is not an accidentally degenerate eigenvalue of @xmath80 , then the non - magnetic ground state @xmath70 is unique .",
    "the numerical results presented in section  [ sec : numrhf ] indicate that , for neutral atoms , the assumption    @xmath81 is negative and is not an accidentally degenerate eigenvalue of @xmath82 ,    which guarantees the uniqueness of the non - magnetic rhf ground state density matrix , is satisfied for all the chemical elements of the first two rows of the periodic table , and for most of the elements of the third and four rows .",
    "surprisingly , we observe accidental degeneracies at the fermi level for sc and ti ( 4p and 3d shells ) , for v , cr , mn and fe ( 5s and 3d shells ) , for zr ( 5p and 4d shells ) , nb and mo ( 6s and 4d shells ) , and for pd and ag ( 5s and 4d shells ) .",
    "for some of these elements , the fermi level is clearly negative , and we can conclude the following :    * if the fermi level contains an s and a d shell , then the non - magnetic rhf ground state is unique ; * if the fermi level contains a p and a d shell , and if both shells are partially occupied ( which is suggested by our numerical simulations ) , then the non - magnetic rhf ground state is not unique .    indeed , in the former case , any rhf ground state is of the form @xmath83 where @xmath84 , @xmath85 and @xmath86 are matrices such that @xmath87 and where @xmath88 here , the @xmath89 s are the real spherical harmonics , and @xmath90 and @xmath91 are radial functions with respectively @xmath92 and @xmath93 nodes in @xmath94 .",
    "since all the ground state density matrices share the same density , the function @xmath95 where @xmath96 , must be a function of @xmath5 , independent of the chosen ground state density matrix .",
    "since @xmath90 has more nodes than @xmath91 ( we have seen above that @xmath97 or @xmath98 and @xmath99 or @xmath100 ) , this implies that @xmath101 is a scalar matrix , that @xmath102 , and that only one value for the pair @xmath103 is possible .",
    "this demonstrates the uniqueness of the non - magnetic ground state when the fermi level is negative and contains a pair of accidentally degenerate s and d shells .    in the case",
    "when the fermi level is negative and contains a pair of accidentally degenerate p and d shells , any non - magnetic ground state density matrix is of the form @xmath104 where @xmath105 , @xmath85 and @xmath106 are matrices such that @xmath107 and where @xmath108 here , @xmath109 and @xmath91 are radial functions with respectively @xmath110 and @xmath93 nodes in @xmath94 .",
    "since all the ground state density matrices share the same density , the function @xmath111 where @xmath96 , must be a function of @xmath5 , independent of the chosen ground state density matrix . since @xmath109 has more nodes than @xmath91 , this implies that @xmath0 and @xmath101 are scalar matrices and that , for @xmath0 and @xmath101 given , the function @xmath112 is a given function of @xmath5 .",
    "the vector spaces of homogeneous polynomials in @xmath113 of total degree equal to @xmath114 is of dimension 10 , and the matrix @xmath33 has 15 independent entries .",
    "provided @xmath0 and @xmath101 are not equal to @xmath115 ( which is suggested by our numerical simulations ) , an infinity of density matrices of the form ( [ eq : admdm ] ) satisfy the rhf equations , and are therefore admissible non - magnetic ground states .    for other chemical elements , such as iron ( @xmath116 ,",
    "the fermi level is so close to zero that the numerical accuracy of our numerical method does not allow us to know whether it is slightly negative or equal to zero .",
    "let @xmath68 and @xmath69 .",
    "suppose that ( [ cond : lda1])-([cond : lda3 ] ) hold .",
    "then the minimization problem ( [ eq : min_lda ] ) has a ground state @xmath117 .",
    "in addition , @xmath117 satisfies the self - consistent field equation @xmath118 where @xmath119 is the fermi level , @xmath120 , @xmath121 and the mean - field hamiltonian @xmath122 where @xmath123 and @xmath124 , is a bounded below self - adjoint operator on @xmath73 and @xmath125 .",
    "we now examine the response of the ground state density matrix when an additional external potential @xmath126 is turned on .",
    "the energy functional to be minimized over @xmath27 now reads @xmath127 and is well - defined for any @xmath34 , @xmath128 and @xmath129 .",
    "the parameter @xmath101 is called the coupling constant in quantum mechanics .",
    "denote by    @xmath130    the following theorem insures the existence of a perturbed ground state density matrix for perturbation potentials in @xmath131 .",
    "[ th : perturbc ] let @xmath68 , @xmath69 and @xmath132 .",
    "assume that the fermi level @xmath79 is negative and is not an accidentally degenerate eigenvalue of @xmath80",
    ". then the non - magnetic unperturbed rhf ground state , that is the minimizer of ( [ eq : min_rhf ] ) , is unique , and the perturbed problem ( [ eq : min_pert ] ) has a unique non - magnetic ground state @xmath133 , for @xmath129 small enough .",
    "the hamiltonian @xmath134 where @xmath135 , is a bounded below self - adjoint operator on @xmath73 with form domain @xmath136 and @xmath137 .",
    "@xmath133 and @xmath138 are analytic in @xmath101 , that is @xmath139 the above series being normally convergent in @xmath28 and @xmath140 respectively .    in the sequel , we will refer to @xmath141 as the @xmath142-th order perturbation of the density matrix .",
    "although we focus here on non - magnetic states , it is convenient to consider @xmath143 as an operator on @xmath144 in order to expand the angular part of the atomic orbitals on the usual complex spherical harmonics .",
    "it would of course have been possible to avoid considering complex wave functions by expanding on real spherical harmonics .",
    "however , we have chosen to work with complex wave function to prepare the ground for future works on magnetic systems .",
    "the unperturbed hamiltonian @xmath143 is a self - adjoint operator on @xmath144 invariant with respect to rotations around the nucleus ( assumed located at the origin ) .",
    "this operator is therefore block - diagonal in the decomposition of @xmath144 as the direct sum of the pairwise orthogonal subspaces @xmath145 : @xmath146 where @xmath147 is the angular momentum operator .",
    "since we are going to consider perturbation potentials which are not spherically symmetric , but only cylindrically symmetric , or in other words independent of the azimuthal angle @xmath148 in spherical coordinates , the @xmath149 s are no longer invariant subspaces of the perturbed hamiltonians .",
    "the appropriate decomposition of @xmath144 into invariant subspaces for hamiltonians @xmath150 with @xmath151 cylindrically symmetric , is the following : for @xmath152 , we set @xmath153 where @xmath3 is the @xmath4-component of the angular momentum operator @xmath154 ( @xmath155 ) .    note that @xmath156 and @xmath157 where @xmath158 are the spherical harmonics , i.e. the joint eigenfunctions of @xmath159 , the laplace - beltrami operator on the unit sphere @xmath160 of @xmath161 , and @xmath162 , the generator of rotations about the azimuthal axis of @xmath160 .",
    "more precisely , we have @xmath163 where , in spherical coordinates , @xmath164 these functions are orthonormal , in the following sense : @xmath165 where @xmath166 is the kronecker symbol and",
    "@xmath167 is the complex conjugate of @xmath158 .",
    "we also define @xmath168 so that @xmath144 and @xmath169 are decomposed as the following direct sums : @xmath170 each @xmath171 being @xmath150-stable ( in the sense of unbounded operators ) for @xmath151 cylindrically symmetric .",
    "this is due to the fact that , for @xmath151 cylindrically symmetric , the operator @xmath150 commutes with @xmath172 .",
    "note that @xmath173 .",
    "same arguments hold true for @xmath174 under the assumption that the ground state density @xmath175 is cylindrically symmetric ( which is the case whenever it is unique ) .",
    "we are interested in the stark potential @xmath176 which does not belong to @xmath131 , and thus does not fall into the scope of theorem  [ th : perturbc ] .",
    "we therefore introduce the classes of perturbation potentials @xmath177 where @xmath178 , which contain the stark potential @xmath179 whenever @xmath180 . for @xmath181 , the energy functional ( [ eq : pert_energy ] )",
    "is not necessarily bounded below on @xmath27 for @xmath182 .",
    "thus the solution of ( [ eq : min_pert ] ) may not exist .",
    "this is the case for the stark potential @xmath179 .",
    "however , the @xmath142-th order perturbation of the ground state may exist , as this is the case when the linear schrdinger operator of the hydrogen atom is perturbed by the stark potential @xmath179 ( see e.g  @xcite ) .",
    "the following theorem ensures the existence of the first order perturbation of the density matrix .",
    "[ th : stark_effect ] let @xmath68 , @xmath183 , such that @xmath79 is negative whenever @xmath184 ( see e.g.  @xcite ) .",
    "] and is not an accidentally degenerate eigenvalue of @xmath143 , @xmath185 and @xmath186 . in the rhf framework , the first order perturbation of the density matrix @xmath187 is well defined in @xmath28 .",
    "note that assumption ( [ cond : lda4 ] ) is used to establish the existence and uniqueness of the first order perturbation of the density matrix @xmath188 in @xmath28 .",
    "in this section , we present the discretization method and the algorithms we used to calculate numerically the ground state density matrices for ( [ eq : min_rhf ] ) , ( [ eq : min_lda ] ) and ( [ eq : min_pert ] ) for cylindrically symmetric perturbation potentials @xmath151 , together with the ground state energy and the lowest eigenvalues of the associated kohn - sham operator . from now on ,",
    "we make the assumption that the ground state density of ( [ eq : min_pert ] ) , if it exists , is cylindrically symmetric which is always the case for the rhf model . using spherical coordinates ,",
    "we can write @xmath189 ( since @xmath8 is independent of @xmath148 , we use the notation @xmath190 instead of @xmath191 ) . as the ground state density @xmath192",
    "is assumed to be cylindrically symmetric as well , one has @xmath193",
    "the hartree and the exchange - correlation potentials also have the same symmetry . for @xmath194 , we have @xmath195 where , for each @xmath196 , @xmath197 solves the following differential equation @xmath198 with boundary conditions @xmath199 while @xmath200 can be computed by projection on the spherical harmonics @xmath8 : @xmath201      recall that for @xmath186 and @xmath202 , the energy functional defined by ( [ eq : pert_energy ] ) is not necessarily bounded below on @xmath27 , which implies in particular that ( [ eq : min_pert ] ) may have no ground state .",
    "nevertheless , one can compute approximations of ( [ eq : min_pert ] ) in finite - dimensional spaces , provided that the basis functions decay fast enough at infinity .",
    "let @xmath203 and @xmath204 , and let @xmath205 be a free family of real - valued basis functions .",
    "we then introduce the finite - dimensional spaces @xmath206 and @xmath207 and the set @xmath208 note that since our goal is to compute non - magnetic ground states , we are allowed to limit ourselves to real linear combinations in ( [ eq : vmh ] ) and ( [ eq : xh ] ) .",
    "a variational approximation of ( [ eq : min_pert ] ) is obtained by minimizing the energy functional ( [ eq : pert_energy ] ) over the approximation set @xmath209 : @xmath210 any @xmath211 can be written as @xmath212 with @xmath213 @xmath214 the functions @xmath215 being in @xmath216 , they are of the form @xmath217 where for each @xmath218 , @xmath219 and @xmath220 , @xmath221 .",
    "note that @xmath222 .",
    "expanding the functions @xmath223 in the basis @xmath224 as @xmath225 and gathering the coefficients @xmath226 for fixed @xmath227 and @xmath142 in a rectangular matrix @xmath228 , any @xmath229 can be represented via ( [ eq : gammah])-([eq : expandul ] ) by at least one element of the set @xmath230 where @xmath231^t m_0 u^{m , k ' } ) = \\delta_{kk ' }   \\right\\},\\ ] ] and @xmath232 the matrix @xmath233 appearing in the definition of @xmath234 is the mass matrix defined by @xmath235_{ij } = \\int_0^{+\\infty } \\cx_i \\cx_j,\\ ] ] and the constraints @xmath236^t m_0 u^{m , k ' } ) = \\delta_{kk'}$ ] come from the fact that @xmath237_{ij } u_{j , l}^{m , k ' } = \\tr ( [ u^{m , k}]^t m_0 u^{m , k ' } ) .",
    "\\end{aligned}\\ ] ]    an interesting observation is that , if there is no accidental degeneracy in the set of the occupied energy levels of @xmath238 , and if the occupied orbitals are well enough approximated in the space @xmath216 , then the approximate ground state density matrix @xmath239 has a unique representation of the form ( [ eq : gammah])-([eq : expandul ] ) , up to the signs and the numbering of the functions @xmath240 , that is up to the signs and numbering of the column vectors of the matrices @xmath241 . by continuity",
    ", this uniqueness of the representation will survive if a small - enough cylindrically - symmetric perturbation is turned on .",
    "this is the reason why this representation is well - suited to our study .",
    "let us now express each component of the energy functional @xmath242 using the representation ( [ eq : gammah])-([eq : expandul ] ) of the elements of @xmath209 .",
    "for this purpose , we introduce the @xmath243 real symmetric matrices @xmath244 and @xmath245 , @xmath246 with entries @xmath247_{ij}=\\int_0^{+\\infty }   r^n \\cx_i(r ) \\cx_j(r ) \\ , dr.\\end{aligned}\\ ] ] the weighted mass matrices @xmath248 and @xmath249 are well - defined in view of the hardy inequality @xmath250 we assume from now on that the basis functions @xmath251 decay fast enough at infinity for the weighted mass matrix @xmath252 to be well - defined .    in the representation ( [ eq : gammah])-([eq",
    ": expandul ] ) , the kinetic energy is equal to @xmath253^t a u^{m , k } \\right ) + \\tr\\left ( d_m [ u^{m , k}]^t m_{-2 } u^{m , k } \\right )    \\right),\\ ] ] where @xmath254 is the diagonal matrix defined by @xmath255 all the other terms in the energy functional depending on the density @xmath256 we first need to express this quantity as a function of the matrices @xmath241 and the occupation numbers @xmath257 .",
    "as the function @xmath258 is in @xmath259 , we have @xmath260 inserting ( [ eq : phih ] ) in ( [ eq : rhoh ] ) , we get @xmath261 we recall the following equality  @xcite @xmath262 with @xmath263 where @xmath264 denote the wigner 3j - symbols . inserting the expansion ( [ eq : expandul ] ) in ( [ eq : rhohexp ] ) and using ( [ eq : prodylm ] ) and the fact that @xmath265 we obtain @xmath266y_l^0(\\theta),\\ ] ] from which we conclude that @xmath267 for @xmath268 , we introduce the matrix @xmath269 defined by @xmath270^t\\ ] ] where @xmath271 is the symmetric matrix comes from the following symmetry properties of the 3j - symbols : @xmath272 ] defined by @xmath273 so that @xmath274_{i , j } \\frac{\\cx_i(r)}{r}\\frac{\\cx_j(r)}{r } y_l^0(\\theta).\\ ] ] note that @xmath275 is the identity matrix , so that @xmath276^t\\ ] ] and @xmath277^t ) =   \\sum_{\\underset{1\\leq k\\leq ( m_h-|m|+1)\\times n_h}{-m_h\\leq m\\leq m_h}}n_{m , k } = n,\\ ] ] and that @xmath278 is a symmetric tridiagonal matrix whose diagonal elements all are equal to zero .",
    "the coulomb attraction energy between the nucleus and the electrons then is equal to @xmath279_{i , j } \\frac{\\cx_i(r)}{r}\\frac{\\cx_j(r)}{r }",
    "y_l^0(\\sigma ) \\right )   r^2 \\ , dr \\ , d\\sigma",
    "& = - z    \\int_0^{+\\infty } \\int_{\\s^2 } \\frac{1}{r }   \\ , \\left (   { \\displaystyle } \\sum_{l=0}^{2m_h}\\sum_{i , j=1}^{n_h } [ r_l]_{i , j } \\frac{\\cx_i(r)}{r}\\frac{\\cx_j(r)}{r } y_l^0(\\sigma ) \\right ) y_0 ^ 0(\\sigma)^\\ast \\ ,   r^2 \\ , dr \\ , d\\sigma \\\\",
    "& = -z { \\displaystyle } \\sum_{i , j=1}^{n_h}[r_0]_{i , j } [ m_{-1}]_{ij } = -z   \\tr(m_{-1}r_0),\\end{aligned}\\ ] ] where we have used the orthonormality condition ( [ eq : orthoylm ] ) and the fact that @xmath280 .    likewise , since @xmath281 , the stark potential ( [ eq : wstark ] ) can be written in spherical coordinates as @xmath282 and the potential energy due to the external electric field is then equal to @xmath283_{ij } [ m_{1}]_{ij}=   -\\frac{1}{\\sqrt 3}\\beta \\tr(m_1r_1).\\ ] ] let @xmath284 be a radial , continuous function from @xmath161 to @xmath285 vanishing at infinity and such that @xmath286 . the coulomb interaction energy can be rewritten as follows : @xmath287 the reason why we introduce the charge distribution @xmath284 is to make neutral the charge distributions @xmath288 in the first term of the right - hand side of ( [ eq : decd ] ) , in such a way that the physical solution @xmath289 to the equation ( [ eq : decd2 ] ) below for @xmath290 is in @xmath291 .",
    "introducing the real symmetric matrix @xmath292 with entries @xmath293_{ij}=\\int_0^{+\\infty }   [ v^{\\rm h}(\\mu)](r{\\mathbf e } )   \\cx_i(r)\\cx_j(r ) \\ , dr,\\ ] ] where @xmath294 is any unit vector of @xmath161 ( the value of @xmath295 is independent of @xmath294 since @xmath296 is radial ) the sum of the last two terms of the right - hand side of ( [ eq : decd ] ) can be rewritten as @xmath297 denoting by @xmath298 we have by symmetry @xmath299 and @xmath300(r,\\theta)= \\sum_{l=0}^{2m_h } \\widetilde v_l(\\rho^h_l)(r ) y_l^0(\\theta)=\\sum_{l=0}^{2m_h } \\frac{q_{l , r_l}(r)}{r } y_l^0(\\theta),\\ ] ] where @xmath301 is the unique solution in @xmath291 to the differential equation @xmath302_{ij } \\frac{\\cx_i(r)\\cx_j(r)}{r^2 } \\right)-n \\mu(r)\\delta_{l0 } \\right).\\ ] ] note that the mappings @xmath303 are linear .",
    "we therefore obtain @xmath304 finally , the exchange - correlation energy is @xmath305_{ij } \\frac{\\cx_i(r)}{r}\\frac{\\cx_j(r)}{r } y_l^0(\\theta ) \\right ) r^2 \\sin\\theta \\ , dr \\ ; d\\theta.\\ ] ]      except for very specific basis functions ( such as gaussian atomic orbitals ) , it is not possible to evaluate exactly the first contribution to the coulomb energy  ( [ eq : decd2 ] ) .",
    "it is therefore necessary to approximate it .",
    "for this purpose , we use a variational approximation of ( [ eq : poisson_l])-([eq : decd2 ] ) in an auxiliary basis set @xmath306 , which amounts to replacing @xmath307 by its lower bound @xmath308 where @xmath309 is the unique solution in @xmath310 to the problem @xmath311_{ij } \\frac{\\cx_i(r)\\cx_j(r)}{r^2 } \\right ) -n \\mu(r ) \\delta_{l0 } \\right)v_h(r)dr,\\end{aligned}\\ ] ] which is nothing but the variational approximation of ( [ eq : poisson_l ] ) in the finite dimensional space @xmath312 . expanding the functions @xmath309 in the basis",
    "set @xmath313 as @xmath314 and collecting the coefficients @xmath315 , @xmath316 in a vector @xmath317 , we obtain that the vector @xmath318 is solution to the linear system @xmath319 where the @xmath320 real symmetric matrices @xmath321 and @xmath322 are defined by @xmath323_{pq}=\\int_0^{+\\infty } \\frac{\\zeta_p(r)\\zeta_q(r)}{r^2 } \\ , dr,\\ ] ] where @xmath324 is the three - index tensor with entries @xmath325 and where @xmath326 is the vector with entries @xmath327 note that since @xmath328 , the mappings @xmath329 are in fact linear .",
    "we finally get @xmath330 where @xmath318 is the solution to ( [ eq : poisson_l_2 ] ) .",
    "we therefore end up with the following approximation of problem ( [ eq : min_pert ] ) : @xmath331 where @xmath332^t a u^{m , k } \\right ) + \\tr\\left ( d_m [ u^{m , k}]^t m_{-2 } u^{m , k } \\right )    \\right ) \\\\                                        & -z \\tr(m_{-1}r_0 )    + \\frac{1}{8\\pi } \\sum_{l=0}^{2m_h } q_l^t ( a^{\\rm a}+l(l+1)m_{-2}^{\\rm a } ) q_l      + n \\tr(v_\\mu r_0)\\\\   & - \\frac { n^2}2 d(\\mu,\\mu ) + e_{\\rm xc}(\\rho_h ) - \\frac{\\beta}{\\sqrt 3 } \\tr(m_1r_1 ) , \\end{aligned}\\ ] ] where for each @xmath333 , the matrix @xmath334 and the vector @xmath318 are respectively defined by ( [ eq : defrl ] ) and ( [ eq : poisson_l_2 ] ) , and where the last but one term in the right - hand side is given by ( [ eq : excrhoh ] ) .",
    "the gradient of @xmath335 with respect to @xmath241 is @xmath336 where for each @xmath337 , the @xmath338 real matrix @xmath339 is defined by @xmath340_{ij } = \\sqrt \\pi \\ , \\int_0^{+\\infty } \\int_0^\\pi v_{\\rm xc }   \\left(\\frac{1}{\\sqrt{4\\pi}}\\sum_{i , j=1}^{n_h } [ r_l]_{ij } \\frac{\\cx_i(r)\\cx_j(r)}{r^2}\\right ) \\cx_i(r ) \\cx_j(r ) y_l^0(\\theta ) \\ , \\sin\\theta \\ , dr \\ , d\\theta,\\ ] ] where @xmath341 is the exchange - correlation potential .",
    "diagonalizing simultaneously the kohn - sham hamiltonian and the ground state density matrix in an orthonormal basis , we obtain that the ground state can be obtained by solving the following system of first - order optimality conditions , which is nothing but a reformulation of the discretized extended kohn - sham equations exploiting the cylindrical symmetry of the problem : @xmath342^t m_0 u^{m , k ' } \\right ) = \\delta_{kk ' } , \\\\",
    "\\nonumber \\\\   & { \\displaystyle } \\left(a^{\\rm a}+l(l+1)m_{-2}^{\\rm a}\\right)q_l = f : r_l -   \\tr(m_0r_0 )   \\delta_{l0 } g , \\\\   \\nonumber \\\\ & \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! { \\displaystyle } [ v^l_{\\rm xc}]_{ij } = \\sqrt \\pi \\ , \\int_0^{+\\infty } \\int_0^\\pi v_{\\rm xc }   \\left(\\frac{1}{\\sqrt{4\\pi}}\\sum_{i , j=1}^{n_h } [ r_l]_{ij } \\frac{\\cx_i(r)\\cx_j(r)}{r^2}\\right ) \\cx_i(r ) \\cx_j(r ) y_l^0(\\theta ) \\ , \\sin\\theta \\ , dr \\ , d\\theta , \\\\",
    "\\nonumber \\\\ & { \\displaystyle } n_{m , k}=2 \\mbox { if } \\epsilon_{m , k } < \\epsilon_{\\rm f } , \\quad   0\\leq n_{m , k}\\leq 2\\mbox { if } \\epsilon_{m , k}= \\epsilon_{\\rm f } , \\quad   n_{m , k}=0 \\mbox { if } \\epsilon_{m , k } > \\epsilon_{\\rm f } ,",
    "\\\\   \\nonumber \\\\ & { \\displaystyle } \\sum_{\\underset{1\\leq k\\leq ( m_h-|m|+1 ) n_h}{-m_h\\leq m\\leq m_h}}n_{m , k}=n , \\\\",
    "\\nonumber \\\\ & { \\displaystyle } r_l = \\sum_{\\underset{1\\leq k\\leq ( m_h-|m|+1 ) n_h}{-m_h\\leq m\\leq m_h}}n_{m , k } u^{m , k } c^{l , m } [ u^{m , k}]^t,\\label{eq : eksequations-7 } \\end{aligned}\\ ] ] where the matrices @xmath244 , @xmath248 , @xmath249 , @xmath233 , @xmath252 , @xmath343 , @xmath344 , @xmath321 , @xmath322 , @xmath345 , the 3-index tensor @xmath346 and the vector @xmath347 are defined by ( [ matrices ] ) , ( [ eq : matdm ] ) , ( [ eq : matrixclm ] ) , ( [ def : v_mu ] ) , ( [ eq : matrices2 ] ) , ( [ tensorf ] ) , ( [ vectorg ] ) .      in our calculations , we use the same approximation space to discretize the radial components of the kohn - sham orbitals and the radial poisson equations ( [ eq : poisson_l ] ) , so that , in our implementation of the method , @xmath349 and @xmath350 . we choose a cut - off radius @xmath351 large enough and discretize the interval",
    "@xmath352 $ ] using a non - uniform grid with @xmath353 points @xmath354 .",
    "the positions of the points are chosen according to the following rule : @xmath355 where @xmath356 is a scaling parameter leading to a progressive refinement of the mesh when one gets closer to the nucleus ( @xmath357 . to achieve the desired accuracy , we use the @xmath348-finite element method .",
    "all the terms in the variational discretization of the energy and of the constraints can be computed exactly ( up to finite arithmetics errors ) , except the exchange - correlation terms ( [ eq : excrhoh ] ) and ( [ eq : vxcrhoh ] ) , which requires a numerical quadrature method . in our calculation , we use gaussian quadrature formulas  @xcite of the form @xmath358    where the @xmath359 ( resp .",
    "@xmath360 ) are gauss points for the @xmath5-variable ( resp . for the @xmath361-variable ) with associated weights @xmath362 ( resp .",
    "@xmath363 ) .",
    "more details about the practical implementation of the method are provided in appendix .      in order to solve the self - consistent equations ( [ eq : eksequations-1])-([eq : eksequations-7 ] )",
    ", we use an iterative algorithm .",
    "for clarity , we first present this algorithm within the continuous setting .",
    "its formulation in the discretized setting considered here is detailed below .",
    "the iterations are defined as follows : an ansatz of the ground state density @xmath364}$ ] being known ,    1 .",
    "construct the kohn - sham operator @xmath365 } = -\\frac 12 \\delta -\\frac z{|\\cdot|}+v^{\\rm h}(\\rho^{[n]})+v_{\\rm xc}(\\rho^{[n]})+\\beta w\\ ] ] where @xmath366 for the rhf model and @xmath367 for the kohn - sham lda model ; 2 .   for each @xmath7",
    ", compute the negative eigenvalues of @xmath368}_m:=\\pi_m h^{[n ] } \\pi_m$ ] , where @xmath369 is the orthogonal projector on the space @xmath171 : @xmath365}_m \\phi_{m , k}^{[n+1 ] }   = \\epsilon_{m , k}^{[n+1 ] } \\phi_{m , k}^{[n+1 ] } , \\qquad \\int_{\\r^3 }   { \\phi_{m , k}^{[n+1]}}^\\ast \\phi_{m , k'}^{[n+1 ] } = \\delta_{kk'};\\ ] ] 3 .",
    "construct a new density @xmath370 } _ * = \\sum_{m , k } n_{m , k}^{[n+1 ] } |\\phi_{m , k}^{[n+1]}|^2,\\ ] ] where @xmath371}=2 & \\mbox { if } & \\epsilon_{m , k}^{[n+1 ] } < \\epsilon_{\\rm f}^{[n+1 ] } , \\\\",
    "0\\leq n_{m , k}^{[n+1]}\\leq 2 & \\mbox { if } & \\epsilon_{m , k}^{[n+1 ] } = \\epsilon_{\\rm f}^{[n+1 ] } , \\\\",
    "n_{m , k}^{[n+1]}=0 & \\mbox { if } & \\epsilon_{m , k}^{[n+1 ] } > \\epsilon_{\\rm f}^{[n+1 ] } , \\end{array}\\right .",
    "\\qquad \\mbox{and } \\qquad \\sum_{(m , k ) } n_{m , k}^{[n+1]}=n;\\ ] ] 4 .",
    "update the density : @xmath370}=t_{n } \\rho^{[n+1 ] } _ * + ( 1-t_{n } ) \\rho^{[n]},\\ ] ] where @xmath372 $ ] either is a fixed parameter independent of @xmath373 and chosen _ a priori _ , or is optimized using the optimal damping algorithm ( oda ) , see below ; 5 .",
    "if some convergence criterion is satisfied , then stop ; else , replace @xmath373 with @xmath374 and go to step 1 .    in the non - degenerate case , that is",
    "when @xmath375}$ ] is not an eigenvalue of the hamiltonian @xmath368}$ ] , the occupation numbers @xmath376}$ ] are equal to either @xmath115 ( unoccupied ) or @xmath377 ( fully occupied ) , while in the degenerate case the occupation numbers at the fermi level have to be determined .",
    "we distinguish two cases : if @xmath378 , or more generally if @xmath151 is spherically symmetric , and if @xmath375}$ ] is not an accidentally degenerate eigenvalue of @xmath368}$ ] , then the occupation numbers at the fermi level are all equal ; otherwise , the occupation numbers are not known _ a priori_. in our approach we select the occupation numbers at the fermi level which provide the lowest kohn - sham energy .",
    "when the degenerate eigenspace at the fermi level is of dimension @xmath114 , that is when the highest energy partially occupied orbitals are perturbations of a three - fold degenerate p - orbital , the optimal occupation numbers can be found by using the golden search or bisection method  ( * ? ? ?",
    "* chapter 10 ) since , in this case , the search space can be parametrized by a single real - valued parameter ( this is due to the fact that the sum of the three occupation numbers is fixed and that two of them are equal by cylindrical symmetry ) . in the general case , more generic optimization methods have to be resorted to .    in the discretization framework",
    "we have chosen , the algorithm can be formulated as follows .",
    "* initialization . *    1 .",
    "choose the numerical parameters @xmath379 ( cut - off in the spherical harmonics expansion ) , @xmath12 ( size of the simulation domain for the radial components of the kohn - sham orbitals and the electrostatic potential ) , @xmath380 ( size of the mesh for solving the radial equations ) , @xmath381 ( number of gauss points for the radial quadrature formula ) , @xmath382 ( number of gauss points for the angular quadrature formula ) , and @xmath383 ( convergence threshold ) , 2 .",
    "assemble the matrices @xmath384 , @xmath385 , @xmath249 , @xmath233 , @xmath252 , @xmath345 , @xmath344 and the vector @xmath347 .",
    "the tensor @xmath346 can be either computed once and for all , or the contractions @xmath386}$ ] can be computed on the fly , depending on the size of the discretization parameters and the computational means available ; 3 .",
    "choose an initial guess @xmath387})_{0",
    "\\le l\\le 2m_h}$ ] for the matrices representing the discretized ground state density at iteration @xmath115 ( it is possible to take @xmath388 for all @xmath333 if no other better guess is known ) .",
    "* iterations . *",
    "the matrices @xmath389})_{0 \\le l\\le 2m_h}$ ] at iteration @xmath373 being known ,    1 .   construct the building blocks of the discretized analogues of the operators @xmath368}_m$ ] .",
    "for this purpose , 1 .   solve , for each @xmath390 , the linear equation @xmath391 } = 4\\pi\\left(f : r_l^{[n ] } -   n \\delta_{l0 } g\\right)\\ ] ] 2 .",
    "assemble , for each @xmath390 , the matrix @xmath392}$ ] by means of use gauss quadrature rules @xmath393}_{\\rm xc}]_{ij } = \\sqrt \\pi \\sum_{k=1}^{n_i } \\sum_{p=1}^{n_{{\\rm g},r } } \\sum_{q=1}^{n_{{\\rm g},\\theta } }    h_k w_{p,\\rm r } w_{q,\\theta }   f_{ij}^l(r_k+h_k t_{p,\\rm r } , t_{q,\\theta}),\\ ] ] where @xmath394_{i , j } \\frac{\\cx_i(r)\\cx_j(r)}{r^2}y_l^0(\\arccos t_\\theta)\\right ) \\cx_i(r ) \\cx_j(r ) y_l^0(\\arccos t_\\theta);\\ ] ] 2 .",
    "solve , for each @xmath395 , the generalized eigenvalue problem @xmath396 }   + \\frac 12 m_{-2 } u^{m , k,[n+1 ] } d_m - z   m_{-1 } u^{m , k,[n+1 ] }   + n v_\\mu   u^{m , k,[n+1 ] } + \\sum_{l=0}^{2m_h } ( q_l^{[n]t } \\cdot f ) ( u^{m , k,[n+1]}c^{l , m } ) \\nonumber \\\\   & \\qquad \\qquad { \\displaystyle } + \\sum_{l=0}^{2m_h } v_{{\\rm xc}}^{l,[n ] } u^{m , k,[n+1 ] } c^{l , m}-\\frac{\\beta}{\\sqrt 3 }     m_1 u^{m , k,[n+1 ] } c^{1,m } =   \\epsilon_{m , k}^{[n+1 ] } m_0 u^{m , k,[n+1 ] } ,    \\\\",
    "\\nonumber \\\\ & { \\displaystyle } \\tr\\left ( [ u^{m , k,[n+1]}]^t m_0 u^{m , k',[n+1 ] } \\right ) = \\delta_{kk ' } ,   \\label{eq : constraintsn } \\end{aligned}\\ ] ] 3 .",
    "build the matrices @xmath397}$ ] using the _ aufbau _ principle and , if necessary , optimizing the occupation numbers @xmath376}$ ] , by selecting the occupation numbers at the fermi level leading to the lowest kohn - sham energy : @xmath398 } =   \\sum_{\\underset{1\\leq k\\leq ( m_h-|m|+1 ) n_h}{-m_h\\leq m\\leq m_h}}n_{m , k}^{[n+1 ] } u^{m , k,[n+1 ] } c^{l , m } [ u^{m , k,[n+1]}]^t,\\ ] ] where @xmath371}=2 & \\mbox { if } & \\epsilon_{m , k}^{[n+1 ] } < \\epsilon_{\\rm f}^{[n+1 ] } , \\\\",
    "0\\leq n_{m , k}^{[n+1]}\\leq 2 & \\mbox { if } & \\epsilon_{m , k}^{[n+1 ] } = \\epsilon_{\\rm f}^{[n+1 ] } , \\\\",
    "n_{m , k}^{[n+1]}=0 & \\mbox { if } & \\epsilon_{m , k}^{[n+1 ] } > \\epsilon_{\\rm f}^{[n+1 ] } , \\end{array}\\right .",
    "\\qquad \\mbox{and } \\qquad \\sum_{(m , k ) } n_{m , k}^{[n+1]}=n;\\ ] ] 4 .",
    "update the density : @xmath399}=t_n r_{l,*}^{[n+1]}+(1-t_n)r_l^{[n]},\\ ] ] where @xmath400 $ ] either is a fixed parameter independent of @xmath373 and chosen _ a priori _ , or is optimized using the oda , see below ; 5 .   if ( for instance ) @xmath401 } - r_l^{[n ] } \\| \\le \\epsilon$ ] or @xmath402}-e^{[n]}| \\leq \\varepsilon$ ] then stop ; else go to step one .",
    "note that the generalized eigenvalue problem ( [ eq : eksequationsn])-([eq : constraintsn ] ) can be rewritten as a standard generalized eigenvalue problem of the form @xmath403 } \\m \\v_k , \\qquad \\v_k^t \\m \\v_{k ' } = \\delta_{kk'},\\ ] ] where the unknowns are vectors ( and not matrices ) by introducing the column vectors @xmath404 and the block matrices @xmath405 defined as @xmath406}_{\\cdot,|m| }    \\\\     \\hline \\cdot",
    "\\\\  \\cdot \\\\ \\cdot \\\\",
    "\\hline u^{m , k,[n+1]}_{\\cdot , m_h } \\end{array } \\right ) , \\qquad \\h^m = \\left ( \\begin{array}{c|c|c|c|c }   \\h^m_{|m|,|m| } & \\h^m_{|m|,|m|+1 }    & \\cdots   & \\h^m_{|m|,m_h-1 , }   &   \\h^m_{|m|,m_h } \\\\",
    "\\hline    \\h^m_{|m|+1,|m| } & \\h^m_{|m|+1,|m|+1 }    & \\cdots   & \\h^m_{|m|+1,m_h-1 , }   & \\h^m_{|m|+1,m_h }    \\\\ \\hline   \\cdots & \\cdots & \\cdots & \\cdots & \\cdots   \\\\ \\hline   \\h^m_{m_h-1,|m| } & \\h^m_{m_h-1,|m|+1 }    & \\cdots   & \\h^m_{m_h-1,m_h-1 , }   &   \\h^m_{m_h-1,m_h } \\\\",
    "\\hline    \\h^m_{m_h,|m| } & \\h^m_{m_h,|m|+1 }    & \\cdots   & \\h^m_{m_h , m_h-1 , }   & \\h^m_{m_h , m_h }     \\end{array } \\right),\\ ] ] and @xmath407 where each of the @xmath408 block @xmath409 is of size @xmath338 with @xmath410}]^t\\cdot f+v_{\\rm xc}^{l'',[n]}\\right)\\ ] ] @xmath411}]^t\\cdot f+v_{\\rm xc}^{l'',[n]}\\right ) -\\frac{\\beta}{\\sqrt 3 } c^{1,m } m_1 \\delta_{|l - l'|,1}.\\ ] ]    if @xmath412 and if the density @xmath413}$ ] is radial , then @xmath414}=0 $ ] for all @xmath415 , and the matrix @xmath416 is block diagonal . the generalized eigenvalue problem ( [ eq : gep ] )",
    "can then be decoupled in @xmath408 independent generalized eigenvalue problems of size @xmath417 .",
    "this comes from the fact that the problem being spherically symmetric , the kohn - sham hamiltonian is block diagonal in the two decompositions @xmath418    let us conclude this section with some remarks on the optimal damping algorithm ( oda )  @xcite , used to find an optimal step - length @xmath419 to mix the matrices @xmath397}$ ] and @xmath414}$ ] in step 4 of the iterative algorithm .",
    "this step - length is obtained by minimizing on the range @xmath420 $ ] the one - dimensional function @xmath421}_*+t\\gamma^{[n]},\\beta w\\right),\\ ] ] where @xmath422}$ ] is the current approximation of the ground state density matrix at iteration @xmath373 and @xmath423}_*= { \\displaystyle } \\sum_{\\underset{1\\leq k\\leq ( m_h-|m|+1)n_h}{-m_h\\leq m\\leq m_h}}n_{m , k}^{[n+1 ] } |\\phi_{m , k , h}^{[n+1]}\\rangle\\langle\\phi_{m , k , h}^{[n+1]}|,\\ ] ] with @xmath424}(r,\\theta,\\varphi)=\\sum_{l=|m|}^{m_h } \\sum_{i=1}^{n_h } u_{i , l}^{m , k,[n+1 ] }    \\frac{\\cx_i(r)}{r } y_{l}^{m}(\\theta,\\varphi),\\ ] ] a key observation is that this optimization problem can be solved without storing density matrices , but only the two sets of matrices @xmath425}:=(r_l^{[n]})_{0 \\le l \\le 2m_h}$ ] and @xmath426}:=(r_{l,*}^{[n+1]})_{0 \\le l \\le 2m_h}$ ] , and the scalars @xmath427 } : = \\tr \\left ( -\\frac 12 \\delta \\gamma^{[n]}\\right)\\ ] ] and @xmath428 } & : = \\tr \\left ( -\\frac 12 \\delta \\gamma^{[n+1]}_*\\right ) \\\\ & = \\frac 12{\\displaystyle } \\sum_{\\underset{1\\leq k\\leq ( m_h-|m|+1)\\times n_h}{-m_h\\leq m\\leq m_h } } n_{m , k}^{[n+1 ] }                     { \\displaystyle } \\left ( \\tr\\left ( [ u^{m , k,[n+1]}]^t a u^{m , k,[n+1 ] } \\right ) \\right.\\\\ & \\left.\\qquad\\qquad\\qquad\\qquad\\qquad+ \\tr\\left ( d_m [ u^{m , k,[n+1]}]^t m_{-2 } u^{m , k,[n+1 ] } \\right )    \\right).\\end{aligned}\\ ] ] indeed , we have for all @xmath429 $ ] , @xmath430}_*+t\\gamma^{[n]},\\beta w\\right ) =    ( 1-t ) e_{{\\rm kin},*}^{[n+1 ] } + t   e_{{\\rm kin}}^{[n ] }    + { \\cal f}^{\\rm rhf / lda } \\left ( ( 1-t)r_{*}^{[n+1 ] } + t r^{[n]},\\beta w \\right),\\ ] ] where the functional @xmath431 collects all the terms of the kohn - sham functional depending on the density only . when @xmath432 ( rhf model ) , the function @xmath433}_*+t\\gamma^{[n]},\\beta w\\right)\\ ] ] is a convex polynomial of degree two , and its minimizer on @xmath434 $ ] can therefore be easily computed explicitly . in the lda case ,",
    "the minimum on @xmath434 $ ] of the above function of @xmath435 can be obtained using any line search method .",
    "we use here the golden search method .",
    "once the minimizer @xmath419 is found , the quantity @xmath436}_{\\rm kin}$ ] is updated using the relation @xmath437}_{\\rm kin } =   ( 1-t_n ) e_{{\\rm kin},*}^{[n+1 ] } + t_n   e_{{\\rm kin}}^n.\\ ] ]",
    "as previously mentioned , we use in our code , written in fortran 95 language , the same basis to discretize the radial components of the kohn - sham orbitals and of the hartree potential , that is @xmath438 , and the @xmath348 finite elements method to construct the discretization basis .    in order to test our methodology on lda - type models",
    ", we have chosen to work with the x@xmath0 model  @xcite , which has a simple analytic expression : @xmath439 the exchange - correlation contributions must be computed by numerical quadratures .",
    "we use here the gauss quadrature method with @xmath440 and @xmath441 ( see section  [ sec : p4 ] ) .",
    "we start this section by studying the convergence rate of the ground state energy and of the occupied energy levels of the carbon atom ( @xmath442 ) as functions of the cut - off radius @xmath12 and the mesh size @xmath380 ( see section  [ sec : p4 ] ) .",
    "the errors on the total energy and on the occupied energy levels for the rhf and @xmath443 models are plotted in fig .",
    "[ fig : r - errors ] ( for @xmath444 and different values of @xmath380 ) and fig .",
    "[ fig : ng - errors ] ( for @xmath445 and different values of @xmath12 ) , the reference calculation corresponding to @xmath446 and @xmath447 .",
    "we can see that the choice @xmath444 and @xmath445 provide accuracies of about @xmath448 ha ( recall that chemical accuracy corresponds to 1 mha ) .    [",
    "cols=\"^,^ \" , ]     for @xmath449 and @xmath450 , we clearly see spurious boundary effects : part of the electronic cloud is localized in the region where the external potential takes highly negative values .",
    "this result is obviously not physical . on the other hand , for the x@xmath0 model and for @xmath451",
    "we simply observe a polarization of the electronic cloud .",
    "the perturbation potential being not spherically symmetric , it breaks the symmetry of the density .",
    "this numerical solution can probably be interpreted as a ( nonlinear ) resonant state .",
    "we will come back to the analysis of this interesting case in a following work .",
    "[ fig : polarization ] shows the amount of electrons of the carbon atom which escape to infinity as a function of the coupling constant @xmath101 ( for @xmath446 and @xmath445 ) , in the rhf and @xmath443 case .",
    "[ fig : polarization ]    in general , the standard oda is used to achieve convergence ( see section  [ sec : numerical - method ] ) . however , for @xmath101 small ( resp .",
    "large ) enough , the occupation numbers are selected as follows : @xmath452}=n_{0,2}^{[n]}=2 $ ] , @xmath453 and @xmath454}=2-n_{0,3}=2 t_0 $ ] , @xmath455 being the minimizer of @xmath456}_{0,*}+t\\gamma^{[n]}_{1,*},\\beta w\\right),\\ ] ] where @xmath457}_{0,*}=2\\sum_{1\\le k\\le 3}|\\phi_{0,k , h}\\rangle\\langle\\phi_{0,k , h}|\\quad\\mbox{and}\\quad   \\gamma^{[n]}_{1,*}=2\\sum_{1\\le k\\le 2}|\\phi_{0,k , h}\\rangle\\langle\\phi_{0,k , h}|+2|\\phi_{1,1,h}\\rangle\\langle\\phi_{1,1,h}|.\\ ] ] this modification of oda significantly increases the rate of convergence for @xmath101 small or large , but does not converge for all intermediate values of @xmath101 .    while @xmath458 and the corresponding variational problem has no minimizer , the first - order perturbation @xmath459 of the ground state density matrix does exist ( see theorem  [ th : stark_effect ] ) .",
    "if we consider the carbon atom , it can be expressed as a function of the unperturbed occupied kohn - sham orbitals and of their first - order perturbations .",
    "we indeed have @xmath460 where @xmath461 , where @xmath462 is the @xmath142-th lowest eigenvalue of @xmath463 in the subspace @xmath171 , @xmath464 an associated normalized eigenfunction and @xmath465 while @xmath466 , @xmath467 and @xmath468 satisfy the following self - consistent equation @xmath469    we denote by @xmath470 , @xmath471 , @xmath472 , @xmath473 and @xmath474 the approximations of @xmath462 , @xmath466 , @xmath464 , @xmath467 and @xmath468 , respectively . for each @xmath475 , define @xmath476 recall that , @xmath477 ( resp .",
    "@xmath478 ) are the eigenfunctions ( resp .",
    "eigenvalues ) of the density matrix @xmath479 , the minimizer of the approximated problem @xmath480 .",
    "let @xmath241 and @xmath481 be such that @xmath482 to show that @xmath483 when @xmath484 , it is enough to show that for each @xmath485     @xmath486^t\\cdot f)\\widetilde u_{.,l'}(\\beta )   + c^{l , m}_{l',l '' } ( [ \\widetilde q_{l''}(\\beta)]^t\\cdot f ) u_{.,l'}-\\epsilon^{(1)}m_0 u_{.,l}\\underset{\\beta\\rightarrow 0}{\\rightarrow } 0.\\label{eq:1st - pert}\\end{aligned}\\ ] ] the index @xmath487 is omitted for simplicity and the vector @xmath488 is the solution to the linear system @xmath489 with @xmath490^t + n_{m , k}^{(1 ) } \\widetilde u^{m , k } c^{l , m } [ u^{m , k}]^t.\\ ] ]    our numerical results show that , as expected by symmetry , @xmath491 for all @xmath475 , and that the left - hand side of ( [ eq:1st - pert ] ) converges to zero linearly in @xmath101 ( see fig.[fig:1st - perturbation ] ) .     where @xmath492 is the vector in the left - hand side of ( [ eq:1st - pert]).,scaledwidth=30.0% ]",
    "the authors are grateful to carlos garca - cervera and vikram gavini for valuable discussions .",
    "in this appendix , we elaborate on the details of the calculation .            *",
    "the 1d schrdinger equation is solved on the finite interval @xmath352 $ ] with zero dirichlet boundary conditions * the interval @xmath499 $ ] is decomposed in @xmath380 intervals of positive lengths @xmath500 .",
    "let @xmath354 be such that @xmath501 ; * we denote by @xmath502 ) \\mbox { s.t . }",
    "v|_{[r_k , r_{k+1 } ] } \\in \\p_4 , \\quad v(0)=v(l_e)=0 \\right\\}\\ ] ] the @xmath348 finite element space associated with the so - defined mesh .",
    "we have @xmath503 * we then set for all @xmath504 and @xmath505 , @xmath506 so that @xmath507 , and define the basis @xmath508 of @xmath509 as follows : @xmath510 } , \\quad \\chi_2(r)=p^1_4(r)\\1_{[r_1,r_2 ] } , \\quad \\chi_3(r)=p^1_5(r)\\1_{[r_1,r_2]},\\ ] ] and for all @xmath511 , @xmath512}+p^k_1(r)\\1_{[r_{k},r_{k+1 } ] } \\\\ \\chi_{4k-3}(r)=p^k_3(r)\\1_{[r_{k},r_{k+1 } ] } \\\\ \\chi_{4k-2}(r)=p^k_4(r)\\1_{[r_{k},r_{k+1 } ] } \\\\ \\chi_{4k-1}(r)=p^k_5(r)\\1_{[r_{k},r_{k+1 } ] } \\end{array}\\right.\\ ] ] * when considering an atom with fermi level very close or possible equal to zero , an extra basis function of the form @xmath513}+\\frac{r_{n_i+1}}{r}\\1_{[r_{n_i+1},\\infty[}\\ ] ] is added to the space @xmath509 . its derivative is equal to @xmath514r_{n_i+1},\\infty[.}\\ ] ]      let @xmath515 be the bijective mapping from @xmath516 to @xmath517 defined by @xmath518 recall that the density is equal to @xmath519_{i , j } \\frac{\\cx_i(r)}{r}\\frac{\\cx_j(r)}{r } y_l^0(\\theta).\\ ] ] using the finite element basis defined above , one gets that @xmath520 is equal to @xmath521_{4-i,4-j}\\frac{p^1_{\\lambda(i)}(r)}{r}\\frac{p^1_{\\lambda(j)}(r)}{r}y_l^0(\\theta )                                 & \\quad \\mbox{if}\\quad r\\in(r_1,r_2)\\\\ \\\\                            { \\displaystyle } \\sum_{l=0}^{2m_h}{\\displaystyle } \\sum_{i , j=0}^{4}[r_l]_{4k - i,4k - j}\\frac{p^k_{\\lambda(i)}(r)}{r}\\frac{p^k_{\\lambda(j)}(r)}{r}y_l^0(\\theta )                                 & \\quad \\mbox{if}\\quad r\\in(r_k , r_{k+1}),\\quad 1<k < n_i\\\\ \\\\                             { \\displaystyle } \\sum_{l=0}^{2m_h}{\\displaystyle } \\sum_{i , j={\\kappa}}^{4}[r_l]_{4n_i - i,4n_i - j}\\frac{p^{n_i}_{\\lambda(i)}(r)}{r}\\frac{p^{n_i}_{\\lambda(j)}(r)}{r}y_l^0(\\theta )                                 & \\quad \\mbox{if}\\quad r\\in(r_{n_i},r_{n_i+1}),\\end{array}\\right.\\ ] ] where @xmath522 equal to @xmath523 ( resp .",
    "@xmath115 ) if the discretization space @xmath509 ( resp .",
    "@xmath524 ) is considered . in particular , for @xmath525 and @xmath526 , we have that @xmath527 is equal to @xmath528_{4-i,4-j}z_{\\lambda(i)}(t_{p,\\rm r})z_{\\lambda(j)}(t_{p,\\rm r})\\sqrt{\\frac{2l+1}{4\\pi}}p_l(t_{q,\\theta } )                                 & \\quad \\mbox{if}\\quad k=1\\\\ \\\\    { \\displaystyle } \\sum_{l=0}^{2m_h}{\\displaystyle } \\sum_{i , j=0}^{4}[r_l]_{4k - i,4k - j}z_{\\lambda(i)}(t_{p,\\rm r})z_{\\lambda(j)}(t_{p,\\rm r})\\sqrt{\\frac{2l+1}{4\\pi}}p_l(t_{q,\\theta } )                                 & \\quad \\mbox{if}\\quad 1<k <",
    "n_i\\\\ \\\\    { \\displaystyle } \\sum_{l=0}^{2m_h}{\\displaystyle } \\sum_{i , j={\\kappa}}^{4}[r_l]_{4n_i - i,4n_i - j}z_{\\lambda(i)}(t_{p,\\rm r})z_{\\lambda(j)}(t_{p,\\rm r})\\sqrt{\\frac{2l+1}{4\\pi}}p_l(t_{q,\\theta } )                                 & \\quad \\mbox{if}\\quad k = n_i,\\end{array}\\right.\\label{density - at - pt}\\end{aligned}\\ ] ] where @xmath529 are the legendre polynomials , which can be calculated using the recurrence relation @xmath530 with @xmath531 and @xmath532 . note that system ( [ density - at - pt ] ) is used only to calculate the exchange - correlation potential , thus there is no need to define the density at radius greater than @xmath533 .    for @xmath534",
    ", then @xmath535 ( r{\\mathbf e})=\\frac{1}{r}\\left(1-e^{-\\eta r}\\right).\\ ] ] thus the vector @xmath347 in ( [ vectorg ] ) has one of the following form depending on the discretization space considered @xmath536^t,\\ ] ] or @xmath537^t,\\ ] ] where @xmath538 and @xmath539 we denote by @xmath540=\\sum_{l''=0}^{2m_h } c^{l , m}_{l',l '' } \\left([q_{l''}]^t\\cdot f\\right),\\ ] ] where @xmath345 , @xmath318 and @xmath346 are defined by ( [ eq : matrixclm ] ) , ( [ eq : poisson_l_2 ] ) and ( [ tensorf ] ) , respectively .",
    "all the matrices @xmath244 , @xmath248 , @xmath249 , @xmath233 , @xmath252 , @xmath344 , @xmath541 $ ] and @xmath542 $ ] defined in ( [ matrices ] ) , ( [ def : v_mu ] ) , ( [ eq : vxcrhoh ] ) and ( [ def : mat - coulumb ] ) , when considering the discretization space @xmath509 , are symmetric and have the same pattern :              the @xmath551 s are the entries of the elementary assembling matrices . the latter are defined for the matrices @xmath244 , @xmath248 , @xmath249 , @xmath233 , @xmath252 , @xmath344 , @xmath541 $ ] and @xmath542 $ ] as follows :        in the @xmath443-case , that is for @xmath554 , @xmath555 where @xmath556 and @xmath557 note that @xmath558 is calculated with the help of ( [ density - at - pt ] ) .",
    "the @xmath559 are defined for the matrices @xmath244 , @xmath248 , @xmath249 , @xmath560 , @xmath344 and @xmath561}$ ] as follows : @xmath562 @xmath563 @xmath564 @xmath565 @xmath566 and @xmath567 where @xmath568 .",
    "in addition to assembling the matrices , we need to deal with the following term @xmath569_{ij}\\ ] ] in order to calculate the right - hand side of ( [ eq : poisson_l_2 ] ) .",
    "let @xmath570 and @xmath571 , so that @xmath572",
    ". then the entries @xmath573_{ij}$ ] of the vector @xmath574 are computed as follows @xmath575_{4-i,4-j}\\quad \\mbox{if}\\quad k_n=1 \\\\ \\\\ { \\displaystyle } \\sum_{i , j=0}^4 f_{\\lambda(i)\\lambda(j)\\lambda(q_n)}^{k_n}[r_l]_{4k_n - i,4k_n - j }           \\quad \\mbox{if}\\quad q_n\\neq 4 \\quad \\mbox{and}\\quad",
    "1<k_n < n_i\\\\ \\\\ { \\displaystyle } \\sum_{i , j={\\kappa}}^4 f_{\\lambda(i)\\lambda(j)\\lambda(q_n)}^{n_i}[r_l]_{4n_i - i,4n_i - j }            \\quad \\mbox{if}\\quad q_n\\neq 4 \\quad \\mbox{and}\\quad k_n = n_i\\\\ \\\\ \\begin{array}{l}{\\displaystyle } \\sum_{i , j=0}^3 f_{2\\lambda(i)\\lambda(j)}^{1}[r_l]_{4-i,4-j}+ { \\displaystyle } \\sum_{i , j=0}^4 f_{1\\lambda(i)\\lambda(j)}^{2}[r_l]_{8-i,8-j } \\\\                \\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad \\mbox{if}\\quad q_n=4\\quad \\mbox{and}\\quad k=2\\end{array}\\\\ \\\\ \\begin{array}{c}{\\displaystyle } \\sum_{i , j=0}^4\\left [ f_{2\\lambda(i)\\lambda(j)}^{k_n-1}[r_l]_{4k_n-4-i,4k_n-4-j}\\right.\\\\ \\\\              \\left.+f_{1\\lambda(i)\\lambda(j)}^{k_n}[r_l]_{4k_n - i,4k_n - j}\\right]\\end{array}\\quad \\mbox{if}\\quad q_n=4\\quad\\mbox{and}\\quad 2<k < n_i\\\\",
    "\\\\ \\begin{array}{c}{\\displaystyle } \\sum_{i , j=0}^4 f_{2\\lambda(i)\\lambda(j)}^{n_i-1}[r_l]_{4n_i-4-i,4n_i-4-j}\\\\ \\\\                  + { \\displaystyle } \\sum_{i , j={\\kappa}}^4 f_{1\\lambda(i)\\lambda(j)}^{n_i}[r_l]_{4n_i - i,4n_i - j}\\end{array }              \\quad \\mbox{if}\\quad q_n=4\\quad\\mbox{and}\\quad k = n_i",
    ". \\end{array}\\right.\\ ] ]            e. cancs and c. le bris , _ can we outperform the diis approach for electronic structure calculations _",
    "j. quantum chem .",
    "79 ( 2000 ) 82 - 90 .",
    "e. cancs and c. le bris , _ on the convergence of scf algorithms for the hartree - fock equations _ ,",
    "m2an 34 ( 2000 ) 749 - 774"
  ],
  "abstract_text": [
    "<S> in this article , we consider the extended kohn - sham model for atoms subjected to cylindrically - symmetric external potentials . </S>",
    "<S> the variational approximation of the model and the construction of appropriate discretization spaces are detailed together with the algorithm to solve the discretized kohn - sham equations used in our code . using this code , we compute the occupied and unoccupied energy levels of all the atoms of the first four rows of the periodic table for the reduced hartree - fock ( rhf ) and the extended kohn - sham x@xmath0 models . </S>",
    "<S> these results allow us to test numerically the assumptions on the negative spectra of atomic rhf and kohn - sham hamiltonians used in our previous theoretical works on density functional perturbation theory and pseudopotentials . </S>",
    "<S> interestingly , we observe accidental degeneracies between s and d shells or between p and d shells at the fermi level of some atoms . </S>",
    "<S> we also consider the case of an atom subjected to a uniform electric - field . </S>",
    "<S> for various magnitudes of the electric field , we compute the response of the density of the carbon atom confined in a large ball with dirichlet boundary conditions , and we check that , in the limit of small electric fields , the results agree with the ones obtained with first - order density functional perturbation theory . </S>"
  ]
}