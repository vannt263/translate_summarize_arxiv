{
  "article_text": [
    "it is widely recognized by any practicing theoretical physicist that one seldom comes across exactly solvable problems in our day to day business .",
    "most problems have solutions that can not be expressed in a simple closed form .",
    "fortunately , there exist at least two strategies one can undertake to tackle such problems and still learn about their solutions .",
    "the first one is very popular these days due to the increasing processing power of computers .",
    "it is the `` brute force '' approach , the one that tries to solve numerically the complete problem .",
    "this approach has at least one disadvantage though .",
    "we can not track in a straightforward manner the contributions and relevance of the many different interactions among the system s constituents that we are studying .",
    "the other strategy , when applicable , is generally referred to as `` perturbation theories . ''",
    "it is particularly useful when the problem to be solved has a hamiltonian ( or lagrangian ) that can be split into two parts .",
    "one where the exact solution is known and another whose contribution to the overall hamiltonian is small relative to the first part . in this scenario",
    "one can express the solution to the original problem as a series expansion in terms of the perturbation .",
    "after achieving a desired accuracy , most of the time dictated by the necessity to explain experimental data , we may stop the series .",
    "if the series is convergent , the more terms we keep , the closer is the approximate solution to the exact one .",
    "all standard perturbation theories , time - dependent or time - independent , are more or less akin to this general framework .    restricting our attention to time - dependent perturbation theories , we notice that they are built assuming the system s hamiltonian can be cast as @xmath0 , where @xmath1 is a time - independent term and @xmath2 .",
    "the standard textbook time - dependent perturbation theory @xcite , developed by dirac in the early days of quantum mechanics , and the dyson series , are remarkable examples of such perturbation theories .",
    "consider now the following problem .",
    "we have a time - dependent hamiltonian @xmath3 that _ can not _ be written as above , but that varies with time _ very slowly _ , in a sense to be precisely defined later on . in this case , the evolution of the system is known to be determined by the adiabatic approximation ( aa ) @xcite . in a nutshell ,",
    "if a system is described by aa , during its whole time evolution , say @xmath4 $ ] , there are no transitions among different eigenstates ( for non - degenerate systems ) or among different eigenspaces ( for degenerate systems ) .",
    "the time scale @xmath5 is either an experimental constraint or may be freely chosen , according to other internal time scales of the system , to make the rate of change of @xmath3 slow enough .    to make the statements above quantitative and rigorous",
    ", two questions must be addressed .",
    "( a ) what are the conditions under which aa is actually a good approximation to the time evolution of the system ?",
    "in other words , what is the quantitative meaning of slow ? ( b ) if aa is not good enough , what are its _ perturbative _ corrections in terms of the rate at which @xmath3 is changing ? from the very beginning one thing is clear though .",
    "the standard time - dependent perturbation theories can not help us much in addressing rigorously these questions since they all assume the time - dependent part of @xmath3 is small when compared to the time - independent one . here",
    ", we do not assume @xmath3 has a perturbative component or even a time - independent part .",
    "both questions can be consistently tackled , nevertheless , with the aid of adiabatic perturbation theory ( apt ) for non - degenerate @xcite and degenerate systems @xcite . in particular , answers to the first question are what we call necessary and sufficient conditions for the validity of the adiabatic theorem ( at ) of quantum mechanics . the necessary condition is correctly handled with the recognition that the geometric phases , either abelian @xcite or non - abelian @xcite , are key pieces of aa .",
    "the sufficient conditions as well as perturbative corrections to aa in terms of the rate that @xmath3 changes are given by apt @xcite for non - degenerate systems or by the degenerate apt ( dapt ) @xcite for degenerate ones .",
    "a main goal of the current article is to present a thorough discussion of dapt , highlighting its main differences from standard perturbation theories as well as its range of validity .",
    "we aim at providing a systematic derivation of all mathematical details that were omitted in @xcite , where dapt was introduced , and in @xcite , where necessary and sufficient conditions for the validity of the degenerate at ( dat ) were presented . in particular , we stress some key properties needed to properly develop dapt that are usually not important in most standard perturbation theories .",
    "we also show that dapt reduces to apt when no degeneracy is present and apply all these ideas to a few new examples , where one can grasp the usefulness of dapt .",
    "most importantly , practical quantitative conditions for the validity of the adiabatic theorem are also of upmost relevance to the current problem of assessing the feasibility of any information processing scheme that uses the concept of majorana or parafermionic non - abelian braiding @xcite .",
    "dapt is in a unique position , as a theoretical tool , to estimate potential errors in the physical implementation of such topological gates .",
    "furthermore , dapt can also be employed to compute analytically the non - adiabatic corrections to the adiabatic population transfer and coherent control methods developed in @xcite for non - degenerate systems .    to guide the reader to the points she / he is most interested in",
    ", we divided this article into the following sections . in sec .",
    "[ notation ] we present the notation that best suits the mathematical formulation of dapt and dat .",
    "sections [ aa ] and [ dat ] introduces the degenerate aa ( daa ) and dat in their most general form .",
    "section [ dapt ] constitutes the core of the manuscript from which many of the other results follow .",
    "it includes the systematic development of dapt , where we also discuss its place among other perturbation theories , show its equivalence to apt when no degeneracy is present , and highlights the key ingredients needed to arrive at a consistent perturbation theory .",
    "this together with sec .",
    "[ notation ] are the sections one should read in order to get a general feeling of dapt .",
    "section [ nsc ] gives rigorous as well as practical necessary and sufficient conditions for the validity of dat . in sections",
    "[ example ] and [ examples ] we work out several examples that illustrate how dapt and the conditions for the validity of dat should be applied . in sec .",
    "[ example ] , in particular , we present all the calculation details leading to the exact solution , discovered in [ ] , of a time - dependent degenerate hamiltonian problem introduced in [ ] . finally , in sec .",
    "[ conclusion ] we summarize the crux of our dapt approach and briefly describe our main findings .",
    "in order to keep the equations concise , and as similar as possible to the ones for the non - degenerate case @xcite , we introduce what we call the `` vector of vectors '' or  vector of quantum states \" notation .",
    "it also helps in simplifying the mathematical manipulations leading to dapt .",
    "this new object represents all the degenerate states in a single notation . for example",
    ", a two - fold degenerate ground - eigenspace at a given time @xmath6 has the eigenstates @xmath7 and @xmath8 . in the `` vector of vectors ''",
    "notation one writes @xmath9    in general we have a @xmath10-fold degenerate eigenspace , @xmath11 we represent its @xmath12-th element by the following notation , @xmath13_{g_n,0 } = [ |\\mathbf{n}(t)\\rangle]_{g_n } =    development of dapt we often need the transposed vector of quantum states , @xmath14    the `` row vector of bras '' is defined as , @xmath15 and its transpose as @xmath16    in general each eigensubspace @xmath17 has a different number of degenerate states .",
    "however , it is mathematically convenient to keep the dimension fixed ( @xmath18 ) and pad zeros whenever the vector belongs to a less degenerate eigensubspace . in this way",
    ", every vector ( matrix ) that we will be dealing with will have the same dimension .",
    "for example , if the ground - eigenspace is two - fold degenerate and the first excited state three - fold we will have , @xmath19 @xmath20    with such a convention , we can also define a multiplication between these objects according to standard matrix multiplication rules .",
    "hence , for example , @xmath21 .",
    "here it is assumed that the hamiltonian operator @xmath3 acts as a `` scalar '' on the vector of vectors @xmath22 . in other words ,",
    "\\mathbf{h}(t)[|\\mathbf{\\psi}(t)\\rangle]_1 \\\\ \\vdots",
    "\\\\ \\mathbf{h}(t)[|\\mathbf{\\psi}(t)\\rangle]_{d_{\\sf max}-1 } \\end{array } \\right),\\ ] ] where @xmath24 , is the dimension of the most degenerate eigenspace .",
    "before we move on and to avoid any ambiguity , it is worth calling attention to two notational issues .",
    "first , we use the same symbol @xmath5 to represent transposition of matrices as well as the total time during which the system s hamiltonian is evolving .",
    "it is easy , though , to infer which meaning is assigned to it by the context where it appears .",
    "the transposition @xmath5 is always a superscript while the time @xmath5 is always on the baseline .",
    "second , many times throughout this article we will be dealing with the rescaled time @xmath25 , where @xmath26 is the rate of change of the hamiltonian . when formulating dapt it is convenient to work with @xmath27 while when working with the conditions for the validity of dat it is simpler to work with @xmath6 .",
    "thus , for instance , @xmath28 , represents the original vector @xmath29 with the substitution of @xmath6 by @xmath30 .",
    "note , however , that the dot always means derivative with respect to the argument , i.e. , @xmath31 or @xmath32 .",
    "an unambiguous and quantitative formulation of dat must necessary be related to daa .",
    "briefly , dat will be shown to be strictly connected to the conditions under which daa is valid . in order to present daa in a clear and consistent manner",
    "we follow refs .",
    "@xcite , where geometric phases are at the core of any meaningful aa .    let us consider an explicitly time - dependent hamiltonian @xmath3 , @xmath33 $ ] , with orthonormal eigenvectors @xmath34 .",
    "each degenerate eigenspace @xmath17 of dimension @xmath10 and eigenenergy @xmath35 possesses @xmath10 degenerate states .",
    "obviously @xmath36 and we assume that @xmath10 is fixed during the total time evolution @xmath5 ( see fig .",
    "[ fig1 ] ) .",
    "an arbitrary initial , @xmath37 , condition can be written as @xmath38 where @xmath39 is the probability of finding the system in eigenspace @xmath17 , while @xmath40 is the probability of measuring a specific degenerate eigenstate within a given eigenspace .",
    "the label @xmath41 specifies a particular initial condition within an eigenspace . if we include all initial conditions spanning an orthonormal eigenspace @xmath17 we arrive at the unitary matrix @xmath42 , such that @xmath43 .",
    "then , an arbitrary state at @xmath37 can be written as @xmath44 with the usual matrix multiplication rule implied .",
    "if we want to particularize to a specific initial condition , we just choose the corresponding element of the vector column @xmath45 .",
    "using this notation , the most general way of writing aa is @xmath46 with dynamical phase @xmath47 and unitary matrix @xmath48 given by the non - abelian wilczek - zee phase ( wz phase ) @xcite , @xmath49 where @xmath50 denotes a time - ordered exponential , @xmath51 , and @xmath52_{g_mh_n}=m^{nm}_{h_ng_m}(t)=\\langle n^{h_n}(t)| \\dot{m}^{g_m}(t)\\rangle , \\label{m}\\ ] ] a @xmath53 matrix .",
    "note how the subscripts and superscripts are defined from one equality to the other in eq .",
    "( [ m ] ) . with the vector of vectors notation @xmath52^t = [ \\langle \\mathbf{n}(t)|^t|\\dot{\\mathbf{m}}(t)\\rangle^{t}].\\ ] ]",
    "whenever @xmath54 , the eigenspace @xmath17 has no degeneracy and eq .",
    "( [ wzphase ] ) reduces to the exponential of the abelian berry phase .",
    "thus , eq . ( [ vector0 ] ) is the most general way of writing aa for degenerate as well as non - degenerate systems .",
    "the physical meaning of aa is clear , the system evolves without transitions between eigenspaces but within each eigenspace the relative weights of each degenerate eigenstate is dictated by the wz phase .",
    "had we started at a particular eigenstate , say the ground state @xmath55 for definiteness , we would have @xmath56 for @xmath57 and @xmath42 given above , the first element of @xmath58 will give the time evolution for the initial condition @xmath55 , the second for @xmath59 and so on .",
    "using eq .",
    "( [ initialvector ] ) we have for daa @xmath60 which implies @xmath61_{0}=|\\psi^{(0)}(t)\\rangle = \\sum_{g_0=0}^{d_0 - 1 } \\mathrm{e}^{-\\mathrm{i}\\omega_{0}(t ) } u^0_{0g_0}(t)|0^{g_0}(t)\\rangle,\\ ] ] if we focus on the first element of the vector @xmath58 , i.e. , the initial condition @xmath55 evolved up to time @xmath6 .",
    "the reader is directed to appendix [ appendixa ] for a derivation of daa , with the wz phase naturally appearing .",
    "the rigorous version of dat presented in sec . [ dat ] is nothing but a statement about the validity of daa as given by eq .",
    "( [ vector0 ] ) , in such a way that necessary and sufficient conditions to its validity can be formulated and proved .",
    "moreover , it is presented in a way such that when the system s dynamics can not be approximated by daa , dapt of sec .",
    "[ dapt ] furnishes perturbative corrections in a consistent fashion .",
    "the dynamics of a closed quantum system is generally governed by the schrdinger equation ( se ) @xmath62 the dat sets the conditions under which daa holds , or equivalently , sets the conditions on the rate of change of the hamiltonian that makes daa a good approximation to the solution of the se . in its most general formulation dat can be presented as follows .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if a system s hamiltonian @xmath3 changes _ slowly _ during the course of time , say from @xmath37 to @xmath63 , and the system is prepared in an arbitrary superposition of eigenstates of @xmath3 at @xmath37 ( eq .  ( [ boldpsi0 ] ) ) , then the transitions between eigenspaces @xmath17 of @xmath3 during the interval @xmath4 $ ] are _ negligible _ and the system _ evolves _ according to daa ( eq .  ( [ vector0 ] ) ) .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    note that this statement also applies for non - degenerate systems .",
    "dat as given above is more general than we usually see in the literature since we allow the system to start at an arbitrary superposition of eigenspaces .",
    "after the system starts evolving dat only tells us that no transition occurs between states with different energies . within a given eigenspace ,",
    "these transitions are given by the wz - phase .",
    "[ fig1 ] for an schematic representation of dat .",
    "( color online ) example of spectral time evolution . for dat and dapt",
    "be meaningful , each eigenspace @xmath17 can have an arbitrary number of _ fixed _ degeneracies , but there must always be a gap , constant or not , between different eigenspaces . in daa , no transitions occur between eigenspaces while within each eigenspace the system acquires the non - abelian wz phase.,width=302 ]    for the sake of comparison , we state dat in a form that resembles the standard way of presenting at for non - degenerate systems , namely , when one starts at a given eigenstate of the system ( or in a given eigenspace in the degenerate scenario ) . assuming , without loss of generality , that the system begins at the ground eigenspace @xmath64 , dat reads :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if a system s hamiltonian @xmath3 changes _ slowly _ during the course of time , say from @xmath37 to @xmath63 , and the system is prepared at the ground eigenspace of @xmath3 at @xmath37 , then the system _ evolves _ according to @xmath65 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    to avoid any possible misunderstanding it is worth stressing the following : daa is based on the assumption that the rate of change of @xmath3 is _",
    "slow_. intuitively , the latter notion can be understood as a relation between a characteristic _ internal _ time @xmath66 of the evolved system ( the inverse of its characteristic frequency , for instance ) encoded in @xmath3 and the total evolution time @xmath5 , related to the time it takes to drive @xmath3 throughout the parameter space to its final destination .",
    "it is the interplay between these internal and external times that dictates whether daa is a good approximation for the system time evolution . for a given path in parameter space one can always tune @xmath3 to make the system adiabatic , although for some hamiltonians this will reflect in an evolution time @xmath5 prohibitively large in a possible experimental implementation . in other words",
    ", one can always decrease the rate of change of @xmath3 by increasing the time to drive @xmath3 to its final configuration in parameter space .",
    "this state of affairs , although intuitive , is not satisfactory from a mathematical standpoint since it provides no quantitative notion of _",
    "slowness_. this lack of precise meaning of slow is a main source of controversy . by using dapt @xcite , a generalization of apt @xcite , we can give a precise meaning to this notion of slowness , which is crucial for the derivation of the necessary and sufficient conditions for the validity of dat .",
    "therefore , before we state and prove the necessary and sufficient conditions for the validity of dat , we need first to present dapt in its full generality and details .",
    "dapt is the tool we need to continue the discussion about dat and also the correct way to obtain higher order corrections to daa .",
    "moreover , as we will see , the geometric wz phase and daa will appear naturally as the zeroth order term of dapt .",
    "an important characteristic of dapt is its practical utility .",
    "as we will see , dapt can be actually employed to systematically approximate any time - dependent problem whose snapshot hamiltonian can be efficiently diagonalized . also , dapt is , to the best of our knowledge , the first perturbation theory specially designed for _ degenerate _ systems about aa .",
    "mathematically , it is a series expansion in terms of the small adiabatic parameter @xmath67 representing the rate of change of @xmath3 .",
    "moreover , higher order terms of the perturbative series are recursively obtained from their lower order terms .",
    "as extensively discussed for the non - degenerate case @xcite , the usefulness and success of apt are primarily connected to the choice of the _ right ansatz _ for the form of the solution to se .",
    "this can be seen by noticing that the perfect ansatz would _ factor out _ the dependence of all terms of order @xmath68 and below . in particular ,",
    "terms @xmath69 and below are the problematic ones when @xmath70 and should be handled with caution .",
    "in addition to this , an important insight behind the degenerate ansatz is the recognition that we have non - abelian phases , which are represented by matrices , and a dynamical phase .",
    "we have somehow to explore all these facts at the very beginning of the construction of the `` vector of vectors '' ansatz of dapt in order to make it work successfully .",
    "let us write down the ansatz and then explain the quantities appearing in it .",
    "we assume that the solution to the time - dependent se can be written as @xmath71 where @xmath72 and @xmath73 here @xmath74 , @xmath75 and @xmath76 are column vectors of dimension @xmath24 , while @xmath77 and @xmath78 are matrices with dimensions @xmath79 and @xmath53 , with @xmath10 and @xmath80 being the level of degeneracy of eigenspaces @xmath17 and @xmath81 .",
    "we call each element of the vectors and matrices as @xmath82_{g_n,0 } = [ \\mathbf{|\\psi}(s)\\rangle]_{g_n } $ ] , @xmath83_{h_mg_n } $ ] and @xmath84_{h_ng_n}. $ ]    note that we are now working with the rescaled time @xmath25 , @xmath85 $ ] for @xmath4 $ ] .",
    "this is crucial to correctly identify the order @xmath26 of each term appearing in the perturbative series expansion . in the rescaled time",
    "the dynamical phase is @xmath86 as we said in sec .",
    "[ notation ] , when we write @xmath87 we mean that the function @xmath35 , or any other function of @xmath6 , is written changing every @xmath6 by @xmath30 .",
    "hence , for example , @xmath88 gives @xmath89 .",
    "equation ( [ ansatz ] ) tells us that the solution to se is expressed as a series expansion in the perturbative parameter @xmath26 , with each order given by eq .",
    "( [ ansatza ] ) .",
    "had we stopped at eq .",
    "( [ ansatza ] ) we would have arrived at a deadlock after inserting the ansatz into se . in order to make progress and get a recursive relation that gives order @xmath90 coefficient as function of order @xmath91 , eq .",
    "( [ ansatzb ] ) is of utmost importance .",
    "putting all these pieces together the ansatz can be written as @xmath92    before we proceed , it is important to explain the physical meaning of the small parameter @xmath93 , whose choice is related to the `` velocity '' or rate at which @xmath94 changes with time .",
    "dapt is best suited for a system in which @xmath95 goes from an initial configuration at @xmath96 to a final one at @xmath97 .",
    "its change is driven by the evolution of @xmath98 throughout the parameter space , which can be , for instance , a varying external field or an internal coupling constant .",
    "the choice of @xmath26 , or equivalently the total time of the experiment @xmath5 , making dapt convergent depends on how fast or slow @xmath98 changes with time .",
    "it may happen that dapt does not converge for a particular combination of the values of the changing rate for @xmath98 and the total time @xmath5 employed to drive the system to the desired configuration in the parameter space .",
    "this fact simply implies that aa is not a good approximation for the system s whole evolution .",
    "however , by properly slowing down how @xmath98 evolves to its final desired configuration , which subsequently increases the duration @xmath5 of the experiment , one can make dapt converge and guarantee aa to be a good description to the system s _ whole _ evolution from @xmath37 to @xmath63 .",
    "more details about the meaning of @xmath26 are given when we apply dapt to several examples in secs .",
    "[ example ] and [ examples ] .",
    "in addition to the ansatz that correctly highlights each order @xmath26 and factors out the dynamical phase , where terms @xmath99 and below are present , dapt can only be realized if the initial conditions of the system are taken into account .",
    "this is a characteristic of dapt that differentiates it from all standard perturbation theories , where initial conditions only play a secondary role . here , however , initial conditions play a central role . when properly handled it introduces additional terms to the perturbation series , without which dapt fails",
    ".    the initial conditions and constraints imposed on the ansatz must satisfy :    * the zeroth order of dapt ( @xmath100 ) must be such that no transitions between different eigenspaces occur .",
    "* for @xmath101 we must have @xmath102 .",
    "condition ( i ) implies @xmath103 which leads to ( cf .",
    "( [ vector0 ] ) ) @xmath104 where we assume nothing about @xmath105 but the fact that it is a unitary matrix at @xmath96 .",
    "also , at @xmath96 we recover the initial wave function ( [ boldpsi0 ] ) . condition ( ii ) in turn implies for @xmath101 , @xmath106      in order to get recursive relations for the matrices @xmath78 we must work with the transposed ansatz , @xmath107 and the transposed se @xmath108 inserting eq .",
    "( [ ansatzt ] ) into eq .",
    "( [ set ] ) we get @xmath109 where @xmath110    now , if we left multiply eq .",
    "( [ vector1 ] ) by the column vector of bras @xmath111 we get after using @xmath112 , @xmath113 the first term @xmath114 in eq .",
    "( [ vector2 ] ) can be cast as follows if we explicitly isolate the @xmath100 term , @xmath115 employing the initial condition , eq .",
    "( [ b0 ] ) , we readily see that the last sum in ( [ divterm ] ) is zero and se is satisfied if the remaining terms multiplying @xmath116 in ( [ vector2 ] ) are zero .",
    "this leads to the following recursive condition , @xmath117 where we have swapped the indexes @xmath118 and taken the transpose .",
    "this is the main recursive relation , from which we are able to compute @xmath78 to all orders in @xmath93 and give consistent successive corrections to daa .",
    "as we show in appendix [ appendixb ] , it reduces to the recursive relation obtained in @xcite for non - degenerate hamiltonians .",
    "it is worth noting that the initial condition ( [ b0 ] ) was crucial to cancel the second term of ( [ divterm ] ) , whose limit as @xmath70 diverges .",
    "this highlights the importance of the initial conditions on the development of dapt . in what follows",
    ", we will encounter another instance where the other piece of the initial conditions , eq .",
    "( [ bnn0 ] ) , becomes relevant .",
    "we now explicitly compute @xmath78 up to first order , i.e. , we need to consider the instances where @xmath100 and @xmath119 with either @xmath120 or @xmath121 .      in this case eq .",
    "( [ recursiveb ] ) becomes , @xmath122 and using eq .",
    "( [ b0 ] ) we get @xmath123 since , in general , @xmath124 the term inside the parenthesis must necessarily be zero and it becomes @xmath125 , where @xmath126 .",
    "the formal solution to that equation is exactly the wz - phase , eq .",
    "( [ wzphase ] ) . in other words",
    ", the wz - phase naturally appears in the development of dapt , as anticipated in previous sections .",
    "it is the solution to the zeroth order recursive equation supplemented with the correct initial condition .      now",
    "( [ recursiveb ] ) becomes @xmath127 and using eq .",
    "( [ b0 ] ) we get @xmath128      in this scenario we can write eq .",
    "( [ recursiveb ] ) as follows , @xmath129 to solve this equation we make the following change of variables , @xmath130 which leads to @xmath131 the term inside the parenthesis is zero ( wz - phase ) , and using the unitarity of @xmath105 we can solve for @xmath132 , @xmath133 where we have changed @xmath134 . next we need to express the initial condition ( [ bnn0 ] ) in terms of the new variable @xmath132 . using the unitarity of @xmath105 and eq .",
    "( [ p0ndifferentm ] ) we can write eq .",
    "( [ bnn0 ] ) for @xmath119 as @xmath135 finally , inserting eqs .",
    "( [ p0ndifferentm ] ) and ( [ initialbtilde ] ) into ( [ almost_p1nequalsm ] ) and the result into ( [ change ] ) we get @xmath136 where we define @xmath137 note that the initial condition ( [ bnn0 ] ) is responsible for the first term of eq .",
    "( [ p1nequalsm ] ) and the second term depends on the history ( integration over time ) of the evolution of the system . in the appendix [ appendixc ] we show how to obtain the general solution of eq .",
    "( [ recursiveb ] ) , i.e. , we provide an explicit expression for @xmath138 in terms of @xmath139 .      with the previous coefficients we are able to write down the zeroth and first order wave functions that approximate the exact solution to se according to dapt .",
    "the zeroth order term in the expansion is daa since we have shown that dapt implies that @xmath140 is the wz - phase . for @xmath100 if we insert eq .",
    "( [ b0 ] ) into ( [ ansatz2 ] ) we get @xmath141    starting at the ground state @xmath55 we must add condition ( [ initialvector ] ) and we obtain @xmath142 the first element of the vector above expresses the zeroth order term for the initial condition @xmath55 as , @xmath143_0 & = &    & = & \\mathrm{e}^{-\\frac{\\mathrm{i}}{v}\\omega_{0}(s ) } [ \\mathbf{u}^{0}(s)\\mathbf{|0}(s)\\rangle]_0",
    "\\nonumber \\\\ & = & \\mathrm{e}^{-\\frac{\\mathrm{i}}{v}\\omega_{0}(s ) } \\sum_{g_0=0}[\\mathbf{u}^{0}(s)]_{0g_0}[\\mathbf{|0}(s)\\rangle]_{g_00 } \\nonumber \\\\ & = & \\mathrm{e}^{-\\frac{\\mathrm{i}}{v}\\omega_{0}(s ) } \\sum_{g_0=0}u^{0}_{0g_0}(s)|0^{g_0}(s)\\rangle .",
    "\\label{zeroth}\\end{aligned}\\ ] ]      setting @xmath119 in eq .",
    "( [ ansatza ] ) we can write it as @xmath144 inserting eqs .",
    "( [ p0ndifferentm ] ) and ( [ p1nequalsm ] ) we get    @xmath145    note that @xmath146 whether or not @xmath70 , as it should be , and that if we have no degeneracy we recover the results of @xcite . beginning at the ground state @xmath55 we should impose the additional condition ( [ initialvector ] ) , which leads to @xmath147 since the desired solution with the appropriate initial condition ( @xmath55 ) is the first element of the previous vector , @xmath148_0 $ ] , we get after reversing to the usual notation @xmath149_{0g_0}|0^{g_0}(s)\\rangle -\\mathrm{i}\\hbar \\!\\sum_{n=1}\\!\\ !",
    "\\mathrm{e}^{-\\frac{\\mathrm{i}}{v}\\omega_n(s ) } \\!\\sum_{g_n=0}\\!\\frac{[\\mathbf{u}^0(0)\\mathbf{m}^{0n}(0 ) \\left(\\mathbf{u}^n(0)\\right)^\\dagger \\mathbf{u}^n(s)]_{0g_n}}{\\delta_{n0}(0)}|n^{g_n}(s)\\rangle \\nonumber \\\\ & & + \\mathrm{i}\\hbar \\sum_{n=1 } \\mathrm{e}^{-\\frac{\\mathrm{i}}{v}\\omega_0(s ) } \\sum_{g_n=0}\\frac{[\\mathbf{u}^0(s)\\mathbf{m}^{0n}(s)]_{0g_n } } { \\delta_{n0}(s)}|n^{g_n}(s)\\rangle .",
    "\\label{first}\\end{aligned}\\ ] ]    it is important to stress , as indicated in ref .",
    "@xcite for the non - degenerate case , that the first term in the rhs of eq .",
    "( [ first ] ) is generally missing in standard corrections to aa @xcite .",
    "as we will see , when applying these ideas to an exactly solvable example , this term is also of upmost importance to obtain the correct first order correction to daa .",
    "now that we have developed the right tool , namely dapt , we are able to establish conditions for the validity of dat , as stated in sec .",
    "important to assess such conditions is the ansatz ( [ ansatz2 ] ) .",
    "since the highly oscillatory terms of order @xmath99 and below appear at any order @xmath91 , by properly choosing the small parameter @xmath26 one can always make dapt perturbative series converge .",
    "hence , the conditions that make dapt converge supplemented with the condition that the sum of all higher orders @xmath101 is negligible compared to the zeroth order , are sufficient conditions to guarantee the validity of dat .",
    "contrariwise , if dapt converges and the system is said to be well described by daa , then the sum of all higher order terms must be small when compared to the zeroth order term , showing this condition is necessary too .",
    "in other words , if dapt converges we can furnish rigorous necessary and sufficient conditions for the validity of dat . however , as we will see in sec .",
    "[ sc ] , testing for the convergence of dapt series is not an easy task in general . to overcome this limitation",
    "we develop practical necessary and sufficient conditions in the following sections .",
    "the necessary condition given in sec .",
    "[ nc ] is a generalization to degenerate systems of the standard quantitative condition recently proved to be necessary for non - degenerate hamiltonians @xcite . on the other hand , the sufficient condition of sec .",
    "[ sc ] relies heavily on dapt and on the conditions under which higher order terms appearing in the perturbative series of dapt are negligible when compared to the zeroth order .      to arrive at a necessary condition that is also practical we follow tong @xcite and others @xcite and assume that if dat is valid then the system is well described by daa and all measurements at _ any time _",
    "must indeed be consistent with this assumption .",
    "this has a profound implication on the approximate dynamics the system obeys in the following sense @xcite .",
    "it is not only the fidelity , @xmath150 , between the exact solution and daa that must be close to one for the system s dynamics to be considered adiabatic .",
    "the expectation values of any observable associated to the system should also be close to the ones computed with @xmath151 , in particular those related to its geometric phase .",
    "therefore , for that to be true , we must have that    * daa approximately satisfies se . *",
    "the transition probabilities to excited _ eigenspaces _ are negligible .",
    "mathematically , these two assumptions read    * @xmath152 and * @xmath153    where @xmath154 is the `` max norm '' , i.e. , the condition @xmath155 must be tested against the absolute value of all elements of the matrix above ( the bra - column vector and the ket - row vector are combined according to the usual matrix multiplication rule ) .    from these hypotheses",
    "we can derive some lemmas that will be employed in the forthcoming demonstration of the necessary condition .",
    "since daa approximately fulfill se ( assumption 1 ) _ then _ we may take it as a good approximation to the exact solution @xmath22 , i.e. , @xmath156    now , using se , lemma 1 , and assumption 1 we get @xmath157 leading finally to lemma 2 , @xmath158    it is worth noting , as tong did in the non - degenerate case @xcite , that ( [ lemma2 ] ) is not a trivial result obtained by differentiating both sides of ( [ lemma1 ] ) . equation ( [ lemma2 ] ) is a consequence of the fact that the state describing the time evolution of the system must satisfy se , at least approximately , which is what ( [ prooflemma2 ] ) is meant to show .",
    "our goal next is to prove that the quantitative condition @xmath159 , \\label{strongermat}\\ ] ] is a necessary condition for the validity of dat .",
    "in other words , we want to prove that ( [ strongermat ] ) follows from assumptions 1 and 2 ( or equivalently from lemmas 1 and 2 and assumption 2 ) . here",
    "@xmath160 is the maximum absolute column sum of matrix @xmath161 with dimensions @xmath162 .",
    "we start the proof writing the following identity for @xmath163 , @xmath164 using se , eq .  ( [ se ] ) , we get @xmath165 where the last mathematical step comes from eqs .",
    "( [ lemma1 ] ) and ( [ lemma2 ] ) . taking the transpose of ( @xmath166 ) we get @xmath167 which leads to @xmath168 inserting eqs .",
    "( [ noderivative ] ) and ( [ derivative ] ) into ( [ lemma1and2 ] ) and noting that @xmath169 since @xmath163 we obtain @xmath170^t } { \\delta_{n0}(t)}\\hspace{-.05cm}.\\end{aligned}\\ ] ] taking the max norm of both sides and using assumption @xmath171 we get the necessary condition @xmath172 .",
    "\\label{nec2}\\ ] ]    in order to get a phase - free necessary condition it is convenient to work with ( [ nec2 ] ) in the standard notation .",
    "first note that @xmath173^t_{j_0h_0 } & = & [ \\mathbf{u}^0(t)|\\dot{\\mathbf{0}}(t)\\rangle]_{h_0j_0 } \\nonumber \\\\ & = & \\sum_{g_0=0}^{d_0 - 1}[\\mathbf{u}^0(t)]_{h_0g_0}(t ) [ |\\dot{\\mathbf{0}}(t)\\rangle]_{g_0j_0 } \\nonumber \\\\ & = & \\sum_{g_0=0}^{d_0 - 1}u_{h_0g_0}^0(t)|\\dot{0}^{g_0}(t)\\rangle , \\label{almost1}\\end{aligned}\\ ] ] with @xmath174 , i.e. , @xmath175_{g_0j_0 } = [ |\\dot{\\mathbf{0}}(t)\\rangle]_{g_0}$ ] is a column vector and @xmath176^t_{j_0h_0}$ ] a row vector . also , with that in mind @xmath177_{g_nh_0 } & = & [ \\mathbf{\\langle n}(t)|]^t_{g_n0 } [ \\mathbf{u}^0(t)|\\dot{\\mathbf{0}}(t)\\rangle]^t_{0h_0}.\\nonumber \\\\ \\label{almost2}\\end{aligned}\\ ] ] using that @xmath178^t_{g_n0}=\\langle n^{g_n}(t)|$ ] and inserting ( [ almost1 ] ) into ( [ almost2 ] ) we get @xmath179_{g_nh_0 } & = & \\langle n^{g_n}(t)|\\sum_{g_0=0}^{d_0 - 1}u_{h_0g_0}^0(t )    & = & \\sum_{g_0=0}^{d_0 - 1}u_{h_0g_0}^0(t)\\langle n^{g_n}(t)|\\dot{0}^{g_0}(t)\\rangle \\nonumber \\\\ & = & \\sum_{g_0=0}^{d_0 - 1}u_{h_0g_0}^0(t)m_{g_ng_0}^{n0}(t ) .",
    "\\label{almost3}\\end{aligned}\\ ] ] finally , inserting eq .",
    "( [ almost3 ] ) into ( [ nec2 ] ) we obtain @xmath180    working with eq .",
    "( [ final ] ) we can finally arrive at ( [ strongermat ] ) by fully exploring the unitarity of @xmath181 , i.e. , if we use the fact that @xmath182 we have @xmath183 therefore , a stronger necessary condition is @xmath184 ,   \\label{strongernec}\\ ] ] which is exactly eq .",
    "( [ strongermat ] ) if we use ( [ m ] ) .",
    "note that if eq .",
    "( [ strongernec ] ) holds , the weaker necessary condition ( [ nec2 ] ) also holds and both reduce to the one in @xcite when no degeneracy is present .",
    "in such a case @xmath185 is a @xmath186 matrix leading to @xmath187_{00 } = \\langle n(t)| \\dot{0}(t)\\rangle$ ] .",
    "one last remark .",
    "if for @xmath188 we take the time derivative of the eigenvalue equation @xmath189 @xmath190 @xmath191 and left multiply the result by @xmath192 we get @xmath193 this last expression when inserted into ( [ strongernec ] ) indicates that the necessary condition for the validity of dat is connected to the square of the gap between eigenspaces and with the rate at which @xmath3 changes with time .      we can write formal rigorous sufficient conditions for the validity of dat by using the ratio test for ascertaining the convergence of dapt series . once the series is guaranteed to converge ,",
    "additional conditions must be applied to make daa ( dapt zeroth order ) the dominant term in the expansion .",
    "let us start writing the ansatz ( [ ansatz2 ] ) in a form better suited to the analysis that follows , @xmath194 with @xmath195    note that for each @xmath196 we have a series involving the matrix @xmath197 , @xmath198 , where the matrix element @xmath199_{h_ng_n}$ ] is the probability amplitude to order @xmath91 of the state @xmath200 in the expansion ( [ precn ] ) . as usual",
    ", @xmath41 handles different initial conditions and , without loss of generality , we stick with @xmath201 , any @xmath196 . for other initial conditions",
    "one would take @xmath202 , for any @xmath196 .",
    "[ dapt ] for details .",
    "therefore , we can apply the ratio test to all matrix elements of @xmath197 and test the convergence of dapt : @xmath203_{0g_n } } { [ \\mathbf{c}_{n}^{(p)}(s)]_{0g_n}}\\right| < 1 , \\hspace{.5 cm } \\forall n , g_n , \\hspace{.5 cm } s \\in [ 0,1 ] .",
    "\\label{ratio1}\\ ] ] if all matrix coefficients satisfy the above condition then dapt is convergent .    inserting eq .",
    "( [ cn ] ) into ( [ ratio1 ] ) we get @xmath204_{0g_n } } { [ \\mathbf{b}_{n}^{(p)}(s)]_{0g_n}}\\right| < 1 , \\hspace{.5 cm } \\forall n , g_n , \\hspace{.5 cm } s \\in [ 0,1],\\ ] ] which after using ( [ ansatzb ] ) becomes @xmath205_{0g_n } } { \\left[\\sum_{m=0 } \\mathrm{e}^{\\frac{\\mathrm{i}}{v}\\omega_{m}(s ) } \\mathbf{b}_{mn}^{(p)}(s)\\right]_{0g_n}}\\right|",
    "< 1 . \\label{inter}\\ ] ]    we can simplify further the previous equation by invoking the comparison test . let @xmath206 and @xmath207 represent two series",
    ". then the comparison test says that if @xmath208 converges and @xmath209 then @xmath210 also converges .",
    "if we define @xmath211_{0g_n},\\ ] ] which is just the element of the series we are testing in eq .",
    "( @xmath212 ) , and @xmath213_{0g_n}\\right|,\\ ] ] we clearly see that @xmath209 and if @xmath214_{0g_n}\\right| } { \\sum_{m=0 } \\left|\\left[\\mathbf{b}_{mn}^{(p)}(s)\\right]_{0g_n}\\right| } < 1 , \\hspace{.2 cm } \\forall n , g_n , \\hspace{.2 cm } s \\in [ 0,1 ] , \\label{strongersuf}\\ ] ] by the comparison test dapt also converges .",
    "it is interesting to note that the small parameter @xmath26 is in the numerator .",
    "then , in principle , we can always make the dapt series converge by choosing a small enough @xmath26 .",
    "of course , in pathological hamiltonians or in some real world experimental realizations , we may need a really small @xmath93 , indicating a prohibitively large @xmath5 .",
    "this is an indication that this particular hamiltonian can not be made to change adiabatically when constrained by the total execution time of the experiment . to solve this problem",
    ", we would need to either increase the running time of the experiment or build another device whose description is given by a different hamiltonian , best suited for the duration of that particular experiment .",
    "the convergence condition ( [ strongersuf ] ) plus @xmath215_{0g_n}\\right| & \\ll & \\left|[\\mathbf{c}_n^{(0)}(s)]_{0g_n}\\right| , \\label{strongersuf1b}\\end{aligned}\\ ] ] @xmath216 $ ] is what we call the rigorous sufficient condition .",
    "equation ( [ strongersuf1b ] ) guarantees that the sum of all higher orders coefficients are negligible when compared to the zeroth order .",
    "this condition is rather intuitive if we remember that from dapt ( see eq .",
    "( [ ansatz2 ] ) ) @xmath217_{0g_n}=v^p\\sum_{m=0}\\mathrm{e}^{-\\frac{\\mathrm{i}}{v}\\omega_m(s ) } \\left[\\mathbf{b}_{mn}^{(p)}(s)\\right]_{0g_n}$ ] gives the @xmath91-th order contribution of state @xmath200 to the exact solution .",
    "we can get dynamical phase - free sufficient conditions by noting that @xmath215_{0g_n}\\right| & \\leq & v^{p+1}\\sum_{m=0 } \\left|\\left[\\mathbf{b}_{mn}^{(p+1)}(s)\\right]_{0g_n}\\right|   \\label{eqsuf1}\\end{aligned}\\ ] ] and also , by using eq .",
    "( [ b0 ] ) , @xmath218_{0g_n}\\right| & = & \\left|b_n(0)[\\mathbf{u}^{n}(s)]_{0g_n}\\right| .",
    "\\label{eqsuf2}\\end{aligned}\\ ] ] therefore , inserting eqs .",
    "( [ eqsuf1 ] ) and ( [ eqsuf2 ] ) into ( [ strongersuf1b ] ) we obtain the following stronger sufficient condition @xcite , @xmath219_{0g_n}\\!\\right| & \\ll \\left|b_n(0)[\\mathbf{u}^{n}(s)]_{0g_n}\\right|,\\label{newsuf}\\end{aligned}\\ ] ] where we must test it for all @xmath196 , @xmath12 , and @xmath220 $ ] .",
    "the convergence condition ( [ strongersuf ] ) is not generally useful in practice since it is extremely difficult to compute the previous limit when @xmath221 .",
    "also , in order to apply ( [ newsuf ] ) we must know all higher order corrections .",
    "we can come up , though , with a practical condition of convergence by looking at the ratio for a couple of finite @xmath91 and truncating ( [ newsuf ] ) at some finite @xmath91 .",
    "for example , we can apply eq .",
    "( [ strongersuf ] ) for @xmath222 , and @xmath171 with the corresponding truncation of ( [ newsuf ] ) .",
    "if the previous equations are satisfied by these @xmath91 s we would have the first order contribution small compared to the zeroth order , the second small compared to the first , and the third order small compared to the second one .",
    "the simplest of all practical tests consists in setting @xmath100 in eq .",
    "( [ strongersuf ] ) and truncating the sum ( [ newsuf ] ) at @xmath100 . in this case",
    "( [ strongersuf ] ) and ( [ newsuf ] ) collapse to the same expression .",
    "in other words , eq .",
    "( [ newsuf ] ) for @xmath100 is what we call the practical sufficient condition and it can be cast as @xmath223_{0g_n}\\right| & \\ll & |b_n(0)|\\left|\\left[\\mathbf{u}^{n}(s)\\right]_{0g_n}\\right| , \\nonumber \\\\ & & \\hspace{.2 cm } \\forall n , g_n , \\hspace{.2 cm } s \\in [ 0,1].\\end{aligned}\\ ] ]    assuming the system starts at the ground state @xmath224 ( eq .  [ initialvector ] ) we get @xmath225_{0g_0}\\right| \\ll \\left|\\left[\\mathbf{u}^{0}(s)\\right]_{0g_0}\\right| , \\hspace{.3 cm } \\;\\forall g_0 , \\hspace{.3 cm } s \\in [ 0,1]\\ ] ] and @xmath226_{0g_n}\\right| \\ll 0 , \\hspace{.3 cm } \\forall n\\neq 0,\\ ; \\forall g_n , \\hspace{.3 cm } s \\in [ 0,1].\\ ] ] note that this last equation , and in particular the zero at the rhs , comes from the fact that @xmath227 if @xmath163 .",
    "but the lhs is always positive which means it should be zero .",
    "this is too strong a condition since in practice we may have a very tiny contribution from excited states .",
    "also , it may happen that one or more @xmath228_{0g_0}$ ] are zero .",
    "this means that one or more of the eigenstates belonging to the ground eigenspace has , to order zero , a null probability of being populated .",
    "thus , for practical purposes , we should only demand the lhs to be much smaller than the smallest _ non - null _ contributions coming from the coefficients of the zeroth order .",
    "this guarantees that order zero , and in turn daa , is the dominant term when compared with the first order correction .",
    "hence , putting all these pieces together the practical sufficient condition looks like @xmath223_{0g_n}\\right| & \\ll \\min\\limits_{\\forall g_0}\\!_+ \\left(\\left|\\left[\\mathbf{u}^{0}(s)\\right]_{0g_0}\\right|\\right ) , \\nonumber \\\\ & \\hspace{.3 cm } \\forall",
    "n , g_n , \\hspace{.3 cm } s \\in [ 0,1 ] , \\label{suf3}\\end{aligned}\\ ] ] where @xmath229 indicates that the minimum is taken over non - null terms only .",
    "it worth mentioning that we can increase the accuracy of the practical test by repeating the previous calculations for higher orders @xmath91 .",
    "the more orders we include the more restrictions we will have and the stronger the sufficient test will be . here , we are just presenting the simplest set of conditions which , nevertheless , turns out to be very useful as we show in sec .",
    "[ example ] .",
    "equation ( [ suf3 ] ) is the practical sufficient condition but it still depends on the geometric phase @xmath140 at the lhs . by a similar calculation to the one we did",
    "when working with the necessary condition , we can get rid of these unitary matrices though . this procedure gives us a stronger and phase - free practical sufficient test .    using eq .",
    "( [ first ] ) we can show that ( [ suf3 ] ) is equivalent to @xmath230_{0g_0}\\right| \\ll \\min\\limits_{\\forall g_0}\\!_+ \\left(\\left|\\left[\\mathbf{u}^{0}(s)\\right]_{0g_0}\\right|\\right ) \\label{76}\\ ] ] and    @xmath231_{0g_n}\\right| \\right .",
    "+ \\left|\\left [ \\mathbf{u}^0(0)\\mathbf{m}^{0n}(0 ) \\left(\\mathbf{u}^n(0)\\right)^\\dagger \\mathbf{u}^n(s ) \\right]_{0g_n}\\right| \\right ) \\ll \\min \\limits_{\\forall g_0}\\!_+ \\left(\\left|\\left[\\mathbf{u}^{0}(s)\\right]_{0g_0}\\right|\\right ) , \\hspace{.05 cm } \\forall n\\neq 0,\\ ; \\forall g_n , \\label{77}\\end{aligned}\\ ] ]    where we used @xmath232 to arrive at the last inequality . employing the schwarz inequality we can simplify further the previous two equations .",
    "let us start with the lhs of the first one , @xmath233_{0g_0}\\right| & \\leq & \\sum_{n=1}\\left|\\left[\\mathbf{j}^{0n0}(s)\\mathbf{u}^0(s)\\right]_{0g_0}\\right| = \\sum_{n=1}\\left|\\sum_{j_0=0}^{d_0 - 1}\\left[\\mathbf{j}^{0n0}(s)\\right]_{0j_0 } \\left[\\mathbf{u}^0(s)\\right]_{j_0g_0}\\right| \\nonumber \\\\",
    "& \\leq & \\sum_{n=1}\\sum_{j_0=0}^{d_0 - 1}\\left|\\left[\\mathbf{j}^{0n0}(s)\\right]_{0j_0}\\right| \\left|\\left[\\mathbf{u}^0(s)\\right]_{j_0g_0}\\right|   \\leq \\sum_{n=1}\\sum_{j_0=0}^{d_0 - 1}\\left|\\left[\\mathbf{j}^{0n0}(s)\\right]_{0j_0}\\right| , \\label{78}\\end{aligned}\\ ] ] where the last inequality comes from the fact that @xmath234 .",
    "we can further simplify the above equation looking at @xmath235 as given in eq .",
    "( [ j ] ) .",
    "working with the matrix element @xmath236_{0j_0}$ ] we have @xmath237_{0j_0}}{\\delta_{0n}(s')}\\right)\\right| \\leq \\int_0^s\\mathrm{d}s ' \\left(\\frac{\\left|[\\mathbf{u}^0(s')\\mathbf{m}^{0n}(s')\\mathbf{m}^{n0}(s ' ) \\left(\\mathbf{u}^0(s')\\right)^\\dagger]_{0j_0}\\right|}{|\\delta_{0n}(s')|}\\right ) \\nonumber \\\\ & = & \\int_0^s\\mathrm{d}s ' \\left(\\frac{\\sum_{k_0,l_n , i_0=0}^{d_0 - 1}|[\\mathbf{u}^0(s')]_{0k_0}[\\mathbf{m}^{0n}(s')]_{k_0l_n } [ \\mathbf{m}^{n0}(s')]_{l_ni_0 } [ \\left(\\mathbf{u}^0(s')\\right)^\\dagger]_{i_0j_0}|}{|\\delta_{0n}(s')|}\\right ) \\nonumber \\\\ & \\leq & \\int_0^s\\mathrm{d}s ' \\left(\\frac{\\sum_{k_0,l_n , i_0=0}^{d_0 - 1}|[\\mathbf{m}^{0n}(s')]_{k_0l_n } [ \\mathbf{m}^{n0}(s')]_{l_ni_0}| } { |\\delta_{0n}(s')|}\\right ) = \\int_0^s\\!\\!\\mathrm{d}s'\\ !      \\left(\\frac{\\sum_{k_0,i_0=0}^{d_0 - 1}|[\\mathbf{m}^{0n}(s ' ) ( \\mathbf{m}^{0n}(s'))^\\dagger]_{k_0i_0}| } { |\\delta_{0n}(s')|}\\right)\\ ! , \\label{74}\\end{aligned}\\ ] ] in which the last equation comes from the fact that @xmath238^\\dagger=-[\\mathbf{m}^{mn}(s)].$ ] returning to ( [ 78 ] ) with the aid of ( [ 74 ] ) we get after noting that its rhs does not depend on @xmath239 , @xmath240_{0g_0}\\right| \\leq \\sum_{n=1}\\sum_{j_0=0}^{d_0 - 1}\\left|\\left[\\mathbf{j}^{0n0}(s)\\right]_{0j_0}\\right| = d_0 \\int_0^s\\mathrm{d}s'\\sum_{n=1 } \\left(\\frac{\\sum_{k_0,i_0=0}^{d_0 - 1}|[\\mathbf{m}^{0n}(s ' ) ( \\mathbf{m}^{0n}(s'))^\\dagger]_{k_0i_0}|}{|\\delta_{0n}(s')|}\\right).\\end{aligned}\\ ] ] hence the first piece of our practical sufficient condition , eq .",
    "( [ 76 ] ) , becomes @xmath241_{k_0i_0}|}{|\\delta_{0n}(s')|}\\right ) \\ll \\min\\limits_{\\forall g_0}\\!_+ \\left(\\left|\\left[\\mathbf{u}^{0}(s)\\right]_{0g_0}\\right|\\right ) ,   \\hspace{.3 cm } s \\in [ 0,1 ] .",
    "\\label{altsuf1a}\\ ] ]    for the the second piece of the practical sufficient condition , eq .",
    "( [ 77 ] ) , it straightforwardly follows that @xmath242_{0g_n}\\right| \\leq \\sum_{k_0=0}^{d_0 - 1 } \\left|[\\mathbf{u}^0(s)]_{0k_0}[\\mathbf{m}^{0n}(s)]_{k_0g_n } \\right|   \\leq \\sum_{k_0=0}^{d_0 - 1 } \\left|[\\mathbf{m}^{0n}(s)]_{k_0g_n}\\right| \\label{77a}\\end{aligned}\\ ] ] and @xmath243_{0g_n}\\right| & \\leq & \\sum_{k_0,l_n , i_n=0}^{d_0 - 1,d_n-1 } \\left|[\\mathbf{u}^0(0)]_{0k_0 } [ \\mathbf{m}^{0n}(0)]_{k_0l_n}[\\left(\\mathbf{u}^n(0)\\right)^\\dagger]_{l_ni_n } [ \\mathbf{u}^n(s)]_{i_ng_n } \\right|\\nonumber \\\\ & \\leq & d_n\\sum_{k_0,l_n=0}^{d_0 - 1,d_n-1 } \\left| [ \\mathbf{m}^{0n}(0)]_{k_0l_n } \\right| .",
    "\\label{78a}\\end{aligned}\\ ] ] using eqs .",
    "( [ 77a ] ) and ( [ 78a ] ) , eq .",
    "( [ 77 ] ) becomes @xmath244_{k_0g_n}\\right| + d_n\\sum_{k_0,l_n=0}^{d_0 - 1,d_n-1 } \\left| [ \\mathbf{m}^{0n}(0)]_{k_0l_n } \\right|\\right)&\\hspace{-.1cm}\\ll\\hspace{-.1 cm } & \\min \\limits_{\\forall g_0}\\!_+ \\left(\\left|\\left[\\mathbf{u}^{0}(s)\\right]_{0g_0}\\right|\\right ) , \\hspace{.1 cm } \\forall n\\neq 0,\\ ; \\forall g_n , \\ ; s \\in [ 0,1 ] .",
    "\\label{altsuf1b}\\end{aligned}\\ ] ]    it is worth noting that the degeneracy level of the eigenspaces are relevant since in eq .",
    "( [ altsuf1a ] ) we have @xmath245 and in ( [ altsuf1b ] ) @xmath10 explicitly appearing in those equations .",
    "they also depend implicitly on the degeneracy level of the eigenspaces since the sums that remain to be computed will have more or less terms whether we have a higher or lower degree of degeneracy .",
    "we should also remark that the `` history '' of the time evolution of the state ( integration over time ) is important in the sufficient condition ( [ altsuf1a ] ) while the history does not show up in the necessary condition .",
    "finally , the practical sufficient conditions ( [ altsuf1a ] ) and ( [ altsuf1b ] ) can be expressed in terms of the real time variable @xmath6 as , @xmath246_{k_0i_0}|}{|\\delta_{0n}(t')|}\\right ) \\ll \\min \\limits_{\\forall g_0}\\!_+ \\left(\\left|\\left[\\mathbf{u}^{0}(t)\\right]_{0g_0}\\right|\\right ) , \\hspace{.5 cm } \\hspace{.5 cm } t \\in [ 0,t ] .",
    "\\label{suf1at}\\ ] ] and @xmath247_{k_0g_n}\\!\\right| + d_n\\hspace{-.5cm}\\sum_{k_0,l_n=0}^{d_0 - 1,d_n-1}\\hspace{-.5 cm } \\left| [ \\mathbf{m}^{0n}(0)]_{k_0l_n } \\right|\\right ) & \\ll & \\min \\limits_{\\forall g_0}\\!_+ \\left(\\left|\\left[\\mathbf{u}^{0}(t)\\right]_{0g_0}\\right|\\right),\\ ; \\forall n\\neq 0,\\ ; \\forall g_n , \\ ;",
    "t \\in [ 0,t ] .",
    "\\label{suf1bt } \\ ] ]",
    "an important aspect of any useful perturbation theory is that it should work when applied to simple problems whose exact solutions are known .",
    "it is decisive that the zeroth and higher order perturbative corrections exactly match the expansion of the exact solution in terms of the perturbative parameter .",
    "indeed , any error in this matching is an indication that a given perturbation theory is prone to failure when applied to more sophisticated problems .",
    "it is our next goal to apply dapt to an exactly solvable degenerate problem and compare its zeroth and first order terms with the equivalent ones obtained by expanding the exact solution about the perturbative parameter .",
    "as we will see , we obtain perfect correspondence between the expansion of the exact solution and dapt perturbative terms .    in order to test dapt , and the necessary and sufficient conditions of sec .",
    "[ nsc ] , we start by presenting for the first time all the details of the calculations that led us to exactly solve @xcite the time - dependent se for the degenerate hamiltonian of @xcite .",
    "this model is the simplest degenerate version of the exactly solvable time - dependent non - degenerate spin-1/2 system subjected to a classical rotating magnetic field about a fixed axis @xcite .",
    "let us consider a four - level system subjected to a rotating classical magnetic field @xmath248 whose magnitude is constant and given by @xmath249 .",
    "in spherical coordinates @xmath250 with @xmath251 and @xmath252 being the polar and azimuthal angles , respectively .",
    "the hamiltonian describing the four - level system is @xcite @xmath253 where @xmath254 is proportional to the field @xmath255 and @xmath256 are the dirac matrices @xmath257 , @xmath258",
    ". here @xmath259 are the usual pauli matrices , inducing the following algebra for @xmath260 , @xmath261 @xmath262 = 2\\mathrm{i}\\epsilon_{ijk}\\pi_k,\\ ] ] where @xmath263 is the identity matrix of dimension four , @xmath264 the kronecker delta , @xmath265 the levi - civita symbol , and @xmath266 .",
    "hamiltonian ( [ hb ] ) may represent a single four - level particle coupled to a rotating magnetic field with coupling constant @xmath267 or two interacting spin-1/2 particles since @xmath268 . in the latter case",
    "we have three types of interactions between the two particles , for @xmath269 , whose coupling constants are proportional to the components of @xmath270 . in the basis where @xmath271 is diagonal , latexmath:[$\\{|\\!\\!\\uparrow\\uparrow\\rangle,|\\!\\!\\uparrow\\downarrow\\rangle ,    snapshot eigenvectors of @xmath3 , eq .",
    "( [ hb ] ) , are @xmath273 if we deal with a two spin-1/2 system we also have , for instance , @xmath274 , where @xmath275 and @xmath276 are the eigenstates of @xmath277 .",
    "the first two eigenvectors are degenerate with energy @xmath278 while the last two have @xmath279 , @xmath280 resulting in a constant gap between the two eigenspaces , @xmath281 @xmath190 @xmath282 .    if @xmath283 , with @xmath284 being the frequency of the rotating magnetic field , we can solve the time - dependent problem exactly by employing techniques similar to those developed for the single spin-1/2 problem @xcite .",
    "we first define the rotated state @xmath285 with @xmath286 inserting eq .",
    "( [ psibar ] ) into the se one can show that @xmath287 evolves according to ( [ se ] ) with a new hamiltonian @xmath288 using eq .",
    "( [ urotate ] ) and the mathematical identity @xmath289 that results from the fact that @xmath290 = \\mathrm{i}2\\gamma_y$ ] and @xmath291 = -\\mathrm{i}2\\gamma_x$ ] , one can show that eq .",
    "( [ hbar ] ) can be written as @xmath292 since @xmath293 is time independent @xmath294 inverting eq .",
    "( [ psibar ] ) and noting that @xmath295 the solution to the original problem is @xmath296    we need now to rewrite the general solution ( [ psit ] ) in terms of the snapshot eigenvectors ( [ zerozerostate])-([oneonestate ] ) . for ease of notation ,",
    "we define the following vectors : @xmath297 where @xmath298 is the unity vector parallel to the @xmath299-direction and @xmath300 the angle between @xmath301 and @xmath302 .",
    "this gives for the magnitude of @xmath303 , @xmath304 the eigenvalues of @xmath293 are @xmath305 note that the transformed hamiltonian is no longer degenerate .",
    "its eigenvectors are respectively @xmath306    a general initial state @xmath307 can be written as @xmath308 with @xmath309 given by the initial conditions . inserting eq .",
    "( [ tilde0 ] ) into ( [ psit ] ) we get , latexmath:[\\[|\\psi(t)\\rangle = \\mathrm{e}^{-\\mathrm{i}\\frac{wt}{2}\\pi_z } \\sum_{j=1}^{4}\\mathrm{e}^{-\\mathrm{i}\\frac{\\tilde{e}_jt}{\\hbar}}\\tilde{a}_j(0 )     by looking at the definition of @xmath271 it is not difficult to see that @xmath311 , @xmath312 , @xmath313 , and @xmath314 . thus , @xmath315 becomes latexmath:[\\[|\\psi(t)\\rangle = \\sum_{j=1}^{4}\\mathrm{e}^{-\\mathrm{i}\\frac{\\tilde{e}_jt}{\\hbar}}\\tilde{a}_j(0 )    latexmath:[\\ ] ] with the following zeroth order term @xmath552    to prove that apt is a particular case of dapt we need to show that eqs .",
    "( [ nansatz2])-([nbn0s ] ) are equivalent to the ones derived from dapt when we assume no - degeneracy .    first , comparing eq .",
    "( [ nansatz2 ] ) with dapt ansatz ( [ ansatz2 ] ) we note that we must have @xmath553 for them to be equivalent . inserting eq .",
    "( [ bb ] ) into ( [ nrecursive1 ] ) and noting that @xmath554_{00}$ ] leads to @xmath555 which is exactly the recursive relation ( [ recursiveb ] ) of dapt .",
    "finally , for @xmath100 if we insert ( [ nbn0s ] ) into ( [ bb ] ) we get dapt zeroth order noting that for non - degenerate systems @xmath556 .",
    "our goal here is to manipulate eq .",
    "( [ recursiveb ] ) to explicitly obtain @xmath557 in terms of the lower order coefficients . for @xmath188 , eq .",
    "( [ recursiveb ] ) straightforwardly implies @xmath558    when @xmath559 , eq .",
    "( [ recursiveb ] ) gives @xmath560 making the following change of variable @xmath561 leads to @xmath562 the term inside the parenthesis is zero since @xmath105 is the wz - phase ( cf .",
    "( [ difwz ] ) ) . then , using the unitarity of @xmath105 , we can solve for @xmath563 ,    @xmath564    where we have changed @xmath134 . then , returning to the original variable @xmath565 where we have written the initial condition ( [ b0 ] ) as @xmath566 finally , using eq .",
    "( [ c1 ] ) we get @xmath567    equations ( [ c1 ] ) and ( [ c8 ] ) , together with the zeroth order term ( eq .",
    "( [ b0 ] ) ) , @xmath568 are all that we need to get perturbative corrections about daa to any order .",
    "however , in many applications of dapt , it is easier to use the recursive relation ( [ recursiveb ] ) directly .",
    "expanding up to first order in @xmath300 daa , eq .",
    "( [ examplead ] ) , and the exact solution , eq .",
    "( [ ground_exact ] ) , we get respectively @xmath570    comparing both expressions it is clear that if @xmath440 the probabilities to measure @xmath8 and @xmath398 are always of the same order in @xmath300 and , therefore , the system can not be properly described by daa .",
    "however , when @xmath571 it is clear that the probability to get @xmath398 vanishes and the one to obtain @xmath8 does not ( there is no @xmath441 in its denominator ) .",
    "this shows , as expected , that for slowly rotating fields daa is a good approximation to the system s evolution ."
  ],
  "abstract_text": [
    "<S> we present details and expand on the framework leading to the recently introduced degenerate adiabatic perturbation theory [ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 104 * , 170406 ( 2010 ) ] , and on the formulation of the degenerate adiabatic theorem , along with its necessary and sufficient conditions given in [ phys . </S>",
    "<S> rev . </S>",
    "<S> a * 85 * , 062111 ( 2012 ) ] . </S>",
    "<S> we start with the adiabatic approximation for degenerate hamiltonians that paves the way to a clear and rigorous statement of the associated degenerate adiabatic theorem , where the non - abelian geometric phase ( wilczek - zee phase ) plays a central role to its quantitative formulation . </S>",
    "<S> we then describe the degenerate adiabatic perturbation theory , whose zeroth order term is the degenerate adiabatic approximation , in its full generality . </S>",
    "<S> the parameter in the perturbative power series expansion of the time - dependent wave function is directly associated to the inverse of the time it takes to drive the system from its initial to its final state . with the aid of the degenerate adiabatic perturbation </S>",
    "<S> theory we obtain rigorous necessary and sufficient conditions for the validity of the adiabatic theorem of quantum mechanics . finally , to illustrate the power and wide scope of the methodology </S>",
    "<S> , we apply the framework to a degenerate hamiltonian , whose closed form time - dependent wave function is derived exactly , and also to other non - exactly - solvable hamiltonians whose solutions are numerically computed . </S>"
  ]
}