{
  "article_text": [
    "let @xmath7 be an integer .",
    "a set @xmath8 is said to be _ periodic _ if there exists a non - zero vector @xmath9 such that for all @xmath10 , @xmath11 belongs to @xmath12 if and only if @xmath13 belongs to @xmath12 .",
    "periodic sets in dimension greater than one have been investigated recently in the spirit of the celebrated morse  hedlund theorem .",
    "[ th : morse - hedlund ] let @xmath14 be a finite alphabet .",
    "let @xmath15 . denote by @xmath16 the number of factors of length @xmath1 appearing in @xmath0",
    ". then the following assertions are equivalent :    * @xmath0 is ultimately periodic ; * there exists @xmath1 such that @xmath17 ; * there exist @xmath18 and @xmath19 such that @xmath20 for all @xmath21 .",
    "observe that this theorem also can be transposed to any subset @xmath12 of @xmath22 by considering its characteristic sequence over the alphabet @xmath23 .",
    "the ultimate periodicity of this sequence is equivalent , for @xmath12 , to be a finite union of arithmetic progressions .",
    "we are interested in generalizations to higher dimensions , that is , to find conditions on the block counting function forcing ( a notion of ) periodicity .",
    "let us briefly mention some interesting works going in that direction .",
    "we were first motivated by _",
    "nivat s conjecture _",
    "@xcite stated in 1997 , see also , asserting that if for some pair @xmath24 the number of @xmath25-blocks appearing in @xmath26 is less or equal to @xmath27 , then @xmath12 is periodic . with the terminology introduced in it",
    "would show that there is a ( restricted ) _",
    "periodicity principle _ in @xmath28 .",
    "this is also strongly related to the _ period conjecture _ stated in .",
    "more details on nivat s conjecture , period conjecture and related works can be found in section  [ section : comments ] .    in this paper , we exhibit , thanks to theorem  [ theo : main ] given below , a complete extension of the morse  hedlund theorem to an arbitrary dimension @xmath6 and characterize sets of @xmath4 definable in @xmath5 in terms of some functions counting recurrent blocks , that is , blocks occurring infinitely often .",
    "note that we do not consider `` purely '' periodic sets in @xmath28 or even @xmath4 , with @xmath3 , i.e. , we are not looking at sets @xmath12 having a vector @xmath29 acting as `` global '' period .",
    "but instead we study what we consider as a natural extension of the notion of periodicity to a multidimensional setting .",
    "indeed , when a. l. semenov extended in @xcite the theorem of cobham @xcite to a multidimensional setting , it turns out that the notion of periodicity he used was not the pure periodicity but sets in @xmath4 defined by a first order formula of the presburger arithmetic @xmath5 .",
    "it is important to observe that the subsets of @xmath22 which are defined by a first order formula in @xmath30 are exactly the ultimately periodic sets ( i.e. , finite union of arithmetic progressions ) . as an example , if @xmath31 is considered as a formula in @xmath30 , then the set @xmath32 is ultimately periodic : for @xmath33 , @xmath34 if and only if @xmath35 . for a presentation of the sets in @xmath36 definable in the presburger arithmetic @xmath30 ,",
    "see for instance the very nice survey .",
    "except for the scope of the variables , there is no fundamental difference between the structures @xmath30 and @xmath5 .",
    "therefore , in this paper , for the sake of simplicity our results are described for the structure @xmath5 .",
    "notice that in @xmath30 , the relation @xmath37 can be easily defined by @xmath38 but this is no more true when @xmath39 are possibly negative and this is the reason why the order relation @xmath40 has to be added to the presburger arithmetic over @xmath41 .",
    "note that over @xmath5 the formula @xmath42 can be defined by @xmath43 and that @xmath44 can be defined by @xmath45 .    to obtain a characterization of sets @xmath12 in @xmath4 defined by a first order formula of presburger arithmetic",
    ", we estimate the function @xmath46 of different blocks of size @xmath1 occurring infinitely often in @xmath12 .",
    "collecting several results and observations about presburger arithmetic and mainly applying the powerful criterion of muchnik @xcite , we derive the following theorem .",
    "[ theo : main ] let @xmath12 be a subset in @xmath4 .",
    "this set is definable in @xmath5 if and only if @xmath47 and every section is definable in @xmath5 .    hence , we use a different notion of periodicity as the one occurring in nivat s conjecture and a different complexity function but what we obtain is a necessary and sufficient condition .",
    "note that in many recent papers , the given conditions are sufficient but are not necessary ( there are counter examples , see again section  [ section : comments ] ) .",
    "if we apply theorem  [ theo : main ] recursively , we can express definability in presburger arithmetic solely in terms of recurrent block complexity .",
    "more precisely , a set @xmath48 is definable in @xmath5 if and only if @xmath47 and for all @xmath49 every @xmath50-dimensional section has a recurrent block complexity in @xmath51 .    in section  [ sec:1 ]",
    ", we define the terminology .",
    "section  [ sec:2 ] contains several examples of definable and non - definable sets in @xmath28 to help the reader to develop some intuition about presburger arithmetic and complexity . in section  [ sec : proofmain1 ]",
    "we prove the necessary condition relying mainly on the elimination of quantifiers in presburger arithmetic .",
    "observe that for @xmath52 our main result corresponds to the morse  hedlund theorem : a set @xmath53 is periodic , i.e. , there exists @xmath54 such that , for all @xmath55 , @xmath56 , if and only if there exists @xmath1 such that @xmath57 . for @xmath58 we give , in the first part of section  [ sec : proofmain2 ] , a direct proof using a lemma already appearing in and . in the second part of section  [ sec : proofmain2 ] , we treat the general multidimensional case relying on completely different techniques developed by muchnik in @xcite . in section [ section : comments ] we describe some works around the nivat s conjecture , the periodicity principle and the period conjecture .",
    "moreover , under the extra hypothesis of uniform recurrence , we obtain partial answers to these questions for subsets of @xmath4 .",
    "let @xmath14 be a non - empty finite alphabet and @xmath6 be a positive integer .",
    "let @xmath59 .",
    "we consider the norm @xmath60    let @xmath61 .",
    "we define the _ @xmath62-neighborhood _ of size @xmath62 centered at @xmath11 by @xmath63 let @xmath64 be an infinite @xmath6-dimensional word over @xmath14 .",
    "it is convenient to consider @xmath65 as a map @xmath66 .",
    "let @xmath67 denote the _ finite block of size @xmath62 _ given by the restriction of @xmath65 to the domain @xmath68\\!]^d$ ] . in this paper ,",
    "when using notation like @xmath69\\!]$ ] with @xmath70 , it has to be understood that we consider the set of integers @xmath71 . if @xmath72 , we write @xmath73 instead of @xmath74 to denote the letter in @xmath65 pointed at @xmath11 . to compare blocks , the respective domains of @xmath67 and @xmath75",
    "can both be identified with @xmath76\\!]^d$ ] and the two maps can be compared .",
    "otherwise stated , we say that two blocks @xmath67 and @xmath75 of size @xmath62 are equal if and only if the mappings are the same , i.e. , for all @xmath77 such that @xmath78\\!]^d$ ] , we have @xmath79 .",
    "the _ block complexity _ of @xmath65 is the map @xmath80 counting for each @xmath1 the number of different blocks @xmath81 appearing in @xmath65 , i.e. , @xmath82 the _ recurrent block complexity _ of @xmath65 is the map @xmath83 counting for each @xmath1 the number of different blocks @xmath81 appearing infinitely often in @xmath65 . these blocks are called _",
    "recurrent blocks_. observe that we do not require to see such blocks in all quadrant .",
    "in other words , this latter function counts only the different blocks @xmath84 of size @xmath1 such that for all @xmath85 , there exists @xmath86 verifying @xmath87 and @xmath88 .",
    "the following inequalities are obvious @xmath89    [ rema : word - set ] if the alphabet @xmath14 is binary , say @xmath90 , then words in @xmath91 can be identified with subsets of @xmath4 and the definitions and notation given above can be applied to subsets of @xmath4 .",
    "for instance , we can speak of the block complexity and recurrent block complexity of a subset @xmath12 of @xmath4 .",
    "we denote these complexities respectively by @xmath92 and @xmath93 .",
    ". then @xmath95 and @xmath96 for all @xmath1 . with this example , we stress the fact that it is required to consider @xmath93 instead of @xmath92 in our main result .    for the sake of completeness , we recall some essential facts about sets definable by first order formulas in the presburger arithmetic @xmath5 . for more details ,",
    "we refer the reader to .",
    "[ rema : d=1 ] recall that the subsets of @xmath22 definable in @xmath30 are exactly the ultimately periodic sets in @xmath22 . when taking a subset @xmath12 of @xmath41 definable in @xmath5",
    ", we can consider the two subsets of @xmath22 , @xmath97 which are both definable in @xmath30 and therefore ultimately periodic .",
    "consequently , if @xmath98 is definable in @xmath5 , there exist @xmath99 ( which are chosen minimal ) such that for @xmath100 , @xmath34 if and only if @xmath101 and for @xmath102 , @xmath34 if and only if @xmath103 .",
    "notice that even in dimension one , if @xmath104 or @xmath105 , then @xmath12 which is definable in @xmath5 can not be `` purely '' periodic .",
    "as a trivial example , consider the set @xmath106 .",
    "then , @xmath107 for all @xmath108 .    in this context",
    ", presburger definability can be viewed as a natural extension of ultimate periodicity in dimensions higher than one . before stating the so - called muchnik s criterion",
    ", we need a few definitions .",
    "a set @xmath48 is said to be _ linear _ , if there exist @xmath86 and a finite set ( possibly empty ) @xmath109 such that @xmath110 a finite union of linear sets is a _ semi - linear _ set .",
    "let @xmath48 , @xmath111 and @xmath112 .",
    "the _ section _",
    "@xmath113 is given by @xmath114    let @xmath115 and @xmath116 .",
    "the set @xmath12 is said to be _",
    "@xmath77-periodic inside _",
    "@xmath117 if for any @xmath118 , @xmath119 ( i.e. , any two points inside x that differ by @xmath77 either both belong to @xmath12 or both do not belong to @xmath12 ) .",
    "we say @xmath77 is a _ local period _ for @xmath117 . when @xmath120 is a subset of @xmath121 , we say @xmath12 is _",
    "@xmath120-periodic inside _",
    "@xmath117 if @xmath12 is @xmath77-periodic inside @xmath117 for some @xmath122",
    ".    as we will see definability in @xmath123 can be expressed in terms of local periodicity as given in .",
    "[ def : localp ] a set @xmath48 is said to be _ locally periodic _ if there exists a finite set @xmath124 such that for some @xmath125 and @xmath126 , @xmath127 figure  [ fig : new01 ] illustrates this notion : far enough of the origin , the set @xmath12 is @xmath77-periodic inside any @xmath128-neigborhood for some @xmath122 .    in @xcite",
    "the following alternative definition of local periodicity is given , see also .",
    "moreover , in the authors also defined a related notion of local periodicity .",
    "let @xmath48 .",
    "if there exists a finite subset @xmath120 of @xmath129 verifying : for all @xmath130 there exists @xmath85 such that @xmath131 then we say that @xmath12 _ satisfies muchnik s condition_. a picture similar to the one in figure  [ fig : new01 ] should also illustrate this notion .    as shown by the following theorem , these two definitions play similar role to characterize definability .",
    "the reader may already notice that the sections of @xmath12 enter the picture .",
    "@xcite [ theo : muchnik ] let @xmath12 be a subset of @xmath4 .",
    "the following statements are equivalent .    1 .",
    "@xmath12 is definable in @xmath5 , 2 .",
    "@xmath12 is semi - linear , 3 .",
    "[ theo : equivlocper ] every section of @xmath12 is definable in @xmath5 and @xmath12 is locally periodic , 4 .",
    "[ theo : muchnikcond ] every section of @xmath12 is definable in @xmath5 and @xmath12 satisfies muchnik s condition .",
    "it is clear in theorem  [ theo : muchnik ] that condition implies condition , i.e. , muchnik s condition implies local periodicity .",
    "the converse is not so obvious and as observed in @xcite , a close inspection of the proof of theorem  [ theo : muchnik ] reveals that assuming is enough to derive the definability of @xmath12 and that this definability implies muchnik s condition .    let @xmath14 be a finite alphabet , @xmath7 and @xmath64 be a @xmath6-dimensional word over @xmath14 .",
    "for each @xmath132 , we define the set @xmath133    the word @xmath65 is _ definable _ in @xmath5 if and only if for all @xmath132 , the sets @xmath134 are definable in @xmath5 .",
    "we can now recall our main result ( stated in the introduction as theorem  [ theo : main ] ) .",
    "let @xmath12 be a subset in @xmath4 .",
    "this set is definable in @xmath5 if and only if @xmath47 and every section is definable in @xmath5 .",
    "the case @xmath52 is equivalent to morse  hedlund theorem and was already discussed in remark  [ rema : d=1 ] .",
    "notice that the number of recurrent factors occurring in an ultimately periodic word in @xmath135 is bounded by a constant .",
    "the proof of theorem  [ theo : main ] is given in section  [ sec : proofmain1 ] and section  [ sec : proofmain2 ] .",
    "but prior to these developments , let us make a few immediate comments .",
    "theorem  [ theo : main ] has an immediate application .",
    "[ coro:1 ] let @xmath14 be a finite alphabet and @xmath7 .",
    "a @xmath6-dimensional word @xmath64 is definable in @xmath5 if and only if @xmath136 and every section is definable in @xmath5 .",
    "let @xmath137 .",
    "a _ @xmath50-dimensional section _ of @xmath48 is a subset of @xmath138 where @xmath62 components have been fixed to constants .",
    "so we define the set @xmath139 viewed as a subset of @xmath138 .",
    "if we apply theorem  [ theo : main ] recursively , we get the following result expressing definability in presburger arithmetic solely in terms of recurrent block complexity .",
    "[ coro:2 ] a set @xmath48 is definable in @xmath5 if and only if @xmath47 and , for all @xmath140 , every @xmath50-dimensional section has a recurrent block complexity in @xmath51 .    using similar arguments as in remark  [ rema : d=1 ] we can replace in theorem  [ theo : main ] , corollary  [ coro:1 ] and corollary  [ coro:2 ] , @xmath4 by @xmath36 and @xmath5 by @xmath30 .",
    "we briefly give some examples that we hope could be helpful .",
    "[ exa:1 ] consider the set @xmath141 represented on the left in figure  [ fig:03 ] and defined by the formula @xmath142    one can show that the block complexity @xmath92 satisfies @xmath143 for @xmath1 large enough .",
    "a simple argument is to observe that the @xmath144 blocks of size @xmath1 , @xmath145\\!]^2 $ ] for @xmath146\\!]$ ] are all distinct .",
    "local periodicity is clear with a set of periods equal to @xmath147 , and , @xmath148 and @xmath149 .",
    "muchnik s condition is also obvious to check with the same set of periods .",
    "the recurrent block complexity is @xmath150 .",
    "[ exa:2 ] consider the set @xmath141 represented on the right in figure  [ fig:03 ] and defined by the formula @xmath151 notice that this set can also be defined with a quantifier - free formula @xmath152 where @xmath153 it is not difficult to compute that the recurrent block complexity is @xmath154 for all @xmath108 .",
    "the following two examples will be used to see that our main result can not be improved .",
    "let @xmath155 be the fibonacci word generated by the morphism @xmath156 .",
    "it is well - known that @xmath157 .",
    "now consider the word @xmath158 indexed by @xmath41 and defined by @xmath159 @xmath160 we have @xmath161 .",
    "consider the set @xmath162 defined by @xmath163 if and only if @xmath164 is such that @xmath165 .",
    "it is clear that @xmath166 is locally periodic and that @xmath167 .",
    "none of the sections @xmath168 for @xmath169 can be defined in @xmath5 . indeed , the fibonacci word is not ultimately periodic ( see ) and therefore not definable in @xmath30 .",
    "thus , the hypothesis on the sections can not be remove .",
    "it also shows that it is not enough to consider @xmath170 instead of @xmath171 .",
    "consider the set @xmath172 depicted in figure  [ fig:02 ] such that @xmath173    each section is definable in @xmath5 but the set is not locally periodic and does not satisfy muchnik s condition .",
    "it is not difficult to see that @xmath174 since the patterns represented in figure  [ fig:05 ] appear infinitely often .",
    "thus , the local periodicity property can not be remove .",
    "we call it _ toeplitzlike set _ because , one can obtain the heights of the successive `` heaps '' as follows . at first step ,",
    "consider the infinite word @xmath175 , on the second step , replace in order all the `` @xmath176 '' symbols with the letters of the infinite word @xmath177 . on the @xmath178-th step ,",
    "replace the remaining `` @xmath176 '' with the letters of the word @xmath179 .",
    "this process generates an infinite word over the alphabet @xmath22 whose @xmath180-th element is the height of the @xmath180-th heap .",
    "in what follows , as explained in remark  [ rema : word - set ] , we make no distinction between a subset of @xmath4 and its characteristic word which belongs to @xmath181 .",
    "we consider indifferently complexity functions of both subsets of @xmath4 and binary words indexed by @xmath4 . to count the number of different blocks of size",
    "@xmath1 it is convenient to use the following notation :    @xmath182\\!]^d   \\}.\\ ] ] one should avoid the confusion between the neighborhood @xmath183 centered at @xmath11 given in   and this set @xmath184 _ pointed _ at @xmath11 .",
    "if @xmath185 is definable in @xmath186 , then @xmath187 .    for a better understanding of the main arguments",
    ", we first give the proof for @xmath58 .",
    "let @xmath188 be definable in @xmath189 .",
    "we can assume @xcite that the formula defining @xmath117 is a finite boolean combination of formulas of the kind @xmath190 where the @xmath191 s are integers ( for an example , see for instance formula ) .",
    "therefore , except for a neighborhood of the origin , @xmath117 is made up of finite number of regions bounded by two half ( straight ) lines .",
    "inside such a region @xmath117 is periodic ( the period being determined with the constant @xmath192 appearing in the formulas given above ) . in figure  [ fig:01 ] , no two lines have the same slope .",
    "let us make this assumption first .",
    "let @xmath193 .",
    "note that bounded polygonal regions delimited by several lines remain in a finite domain close to the origin .",
    "hence , only infinite regions have to be taken into account to estimate @xmath194 .",
    "thus we consider one infinite region bounded by two lines @xmath195 , @xmath196 .",
    "since their slopes are different , there exists @xmath197 such that for any @xmath11 of norm @xmath198 , @xmath199 intersects at most one line .",
    "the number of distinct blocks of size @xmath1 lying completely in one region @xmath200 is bounded by a constant @xmath201 ( due to the periodicity given by a finite number of congruence relations ) .",
    "the number of different blocks of size @xmath1 intersecting two regions is bounded by @xmath202 where the constant @xmath19 depends on the periods within the two regions and the period on the line .",
    "indeed the number of relative positions of a square of size @xmath1 with respect to a given line is bounded by @xmath203 ( see figure  [ fig:13 ] ) .    for each such position ,",
    "the number of different patterns within the two regions and on the line is bounded respectively by three constants @xmath204 ( one for each region and one for each line ) .",
    "this gives a number of different blocks bounded by @xmath205 .",
    "the conclusion follows from the fact that the number of regions is finite .",
    "we have first considered the case where the ( infinite ) regions were defined by lines having distinct slopes .",
    "now , if several lines defining regions have the same slope as depicted in figure  [ fig : new02 ] , then one can proceed using the same arguments .",
    "parallel lines do not increase the linear bound on the complexity .",
    "indeed , the number of relative positions of a square of size @xmath1 with respect to given parallel lines is bounded by @xmath206 , for some @xmath207 .    now consider the general case .",
    "thanks to quantifier elimination in presburger arithmetic @xcite , we can assume that the formula defining @xmath117 is a finite disjunction of formulas @xmath208 , @xmath209 , where each such formula is a conjunction of the form    @xmath210    with @xmath211    or    @xmath212    where all the occurring constants are integers .",
    "notice that we can choose the same constant @xmath192 in every modular equation occurring in the definition of @xmath117 .",
    "each @xmath213 defines a domain defined by a conjunction of formulas of the kind .",
    "] of @xmath4 intersected with a pattern defined by a conjunction of formulas of the kind . ] .",
    "the following lemma is obvious .",
    "[ lem : nonintersecting ] the number of distinct blocks of size @xmath1 for a set @xmath214 defined by a boolean combination of formulas of the kind @xmath215 is bounded from above by @xmath216 .",
    "let @xmath217 be the hyperplane having equation @xmath218 corresponding to  .",
    "we define @xmath219 as the vector subspace having equation @xmath220 . for",
    "the sake of simplicity , let us enumerate all the distinct hyperplanes occurring in the quantifier - free formula as @xmath221 ( with the corresponding vector subspaces denoted by @xmath222 ) .",
    "let @xmath84 be a recurrent block of size @xmath1 , i.e. , there exist infinitely many @xmath223 in @xmath121 such that @xmath224 our aim is to estimate the number of distinct such blocks .",
    "assume that for large enough @xmath225 , @xmath226 intersect , does not intersect any hyperplane . ]",
    "no hyperplane in @xmath227 .",
    "then it lies completely in a single domain .",
    "we can apply the previous lemma .",
    "there are at most @xmath216 different such blocks for each domain and the number of domains is finite ( and determined by the formula ) .    in what follows , we may therefore assume that all the blocks @xmath228 intersect each of the hyperplanes @xmath229 and no other , the @xmath230 belonging to the same domain @xmath207 .",
    "we can do the reasoning for any subset of @xmath227 and any domain @xmath207 ( there are at most @xmath231 subsets of @xmath227 ) . for the sake of simplicity ,",
    "we have chosen the first @xmath180 elements in @xmath227 .",
    "then , it suffices to prove that there exists a constant @xmath19 , not depending on @xmath1 , such that the number of pairwise distinct recurrent blocks @xmath232 intersecting each of the hyperplanes @xmath229 and no other , with @xmath233 , is bounded by @xmath234 .",
    "[ lem : dimw ] let @xmath84 be a block of size @xmath1 . if there exist infinitely many ( different ) vectors @xmath235 such that , for all @xmath225 , @xmath226 intersects each of the hyperplanes @xmath229 , then @xmath236    assume to the contrary that the intersection of the vector subspaces @xmath237 is reduced to @xmath238 .",
    "therefore , for a given @xmath1 , there are finitely many hypercubes @xmath239^d$ ] of size @xmath1 intersecting simultaneously @xmath229 , with @xmath240 .",
    "now let us assume that @xmath241 is a vector space of dimension @xmath242 .",
    "let @xmath243 be a basis of @xmath244 .",
    "we can suppose the entries of @xmath245 are integers and multiples of @xmath192 .",
    "the first idea is to show that a move parallel to @xmath244 only produces a constant number of distinct blocks .",
    "[ lem:11 ] suppose @xmath246 , @xmath247 , intersects each of the hyperplanes @xmath229 and no other .",
    "then for all @xmath248 with @xmath249 , @xmath250 intersects each of the hyperplanes @xmath229 . furthermore",
    ", if @xmath251 and @xmath250 intersects no other hyperplane , then    @xmath252    by definition of @xmath244 , the hypercubes @xmath246 and @xmath250 have the same relative position with respect to @xmath229 ( e.g. , consider two intersecting planes in a space of dimension @xmath253 and assume that a cube intersects these two planes , then a translation of @xmath254 corresponds to a move in the direction of the intersection of the two planes , so the cube still intersects these two planes with a similar relative position of the cube compared with the planes ) .",
    "moreover , since in each domain the pattern is given by congruence relations modulo @xmath192 , we conclude thanks to the choice made for the basis ( each of the components is a multiple of @xmath192 ) .",
    "[ rem:11 ] there exist finitely many vectors of the kind @xmath255 belonging @xmath4 with @xmath256^\\ell$ ] .",
    "this observation and the periodicity induced by the previous lemma lead to the following fact .",
    "let @xmath247 be such that @xmath246 intersects each of the hyperplanes @xmath229 and no other .",
    "there exists a constant @xmath257 ( independent of @xmath1 ) such that the number of pairwise distinct blocks @xmath258 is bounded by @xmath257 when @xmath259 are such that @xmath260 , @xmath251 and @xmath250 intersects each of the hyperplanes @xmath229 and no other .",
    "let @xmath261 be integer vectors such that @xmath262 is a basis of the space @xmath263 .",
    "the idea is now to move in a direction not parallel to @xmath244 and show that we have @xmath264 degrees of freedom .",
    "[ lem:12 ] for all @xmath265 , there exists a constant @xmath266 such that for all @xmath199 intersecting @xmath229 at some point @xmath267 , the following holds :    * if @xmath268 intersects @xmath229 , then @xmath269 , * if @xmath270 , then @xmath268 does not intersect @xmath229 .    without loss of generality",
    ", we may assume @xmath271 .",
    "since @xmath272 does not belong to @xmath244 , there exists @xmath273 such that @xmath272 does not belong to the vector subspace @xmath274 . in a system of coordinates built on the basis @xmath262",
    ", we may assume @xmath275 has an equation of the kind @xmath276 and that @xmath277 belongs to @xmath275 . in this case",
    ", the equation of the corresponding vector subspace @xmath274 is @xmath278 .",
    "the components of @xmath272 in the basis @xmath262 are @xmath279 and they do not satisfy the equation of @xmath274 ( otherwise , we would get that @xmath280 ) . therefore , @xmath281 is non - zero .",
    "we can determine the values of @xmath62 such that @xmath282 belongs to @xmath275 for some @xmath283\\!]$ ] .",
    "indeed , this latter point belongs to @xmath275 if and only if @xmath284\\ ! ] : \\alpha_1^{(m)}\\ , k+\\alpha_2^{(m)}\\ ,      \\ell_2+\\cdots+\\alpha_d^{(m)}\\ , \\ell_d=0.\\ ] ] that is , if and only if @xmath285    thus , it suffices to take    @xmath286    where @xmath287 is the vector whose coordinates are the @xmath288 .",
    "we are now able to conclude this part of the proof .",
    "there are two kinds of recurrent blocks of size @xmath1 .",
    "those that do not intersect any hyperplane in @xmath227 and those that do .",
    "let us call @xmath289 the number of blocks of the first kind and @xmath290 the number of blocks of the second kind .",
    "lemma  [ lem : nonintersecting ] shows that @xmath289 is less than the constant @xmath291 . to bound @xmath292",
    ", we make our reasoning only on the recurrent blocks @xmath228 such that @xmath230 belongs to a given domain @xmath207 and @xmath226 intersects each of the hyperplanes @xmath229 and no other ( recall that there is only a constant number of such cases to take into account ) .",
    "thanks to lemma  [ lem:11 ] and remark  [ rem:11 ] , moving such a block in any direction parallel to @xmath244 leads to a number of pairwise distinct blocks bounded by a constant .",
    "on the other hand , when moving in a direction spanned by @xmath261 , lemma  [ lem:12 ] shows that we can have up to @xmath293 pairwise distinct blocks of size @xmath1 .",
    "recall from lemma  [ lem : dimw ] that @xmath294 belongs to @xmath295 .",
    "furthermore , as suggested by the following example , the bound on @xmath296 is tight .",
    "consider the hyperplanes having respectively equation @xmath297 , @xmath298 , ",
    ", @xmath299 defining @xmath300 regions of the kind @xmath301 with @xmath302 .",
    "let us define a set @xmath303 such that @xmath304 if and only if @xmath305 , i.e. , if the components of @xmath11 are non - zero , the fact that @xmath11 belongs to @xmath117 depends inly on the parity of the number of negative components amonst the @xmath264 first .",
    "observe that all @xmath246 where @xmath306 are such that , for all @xmath265 , @xmath307 give different blocks .",
    "notice also that there is no constraint on @xmath308 , modifying any of these components gives the same block and thus such blocks occur infinitely often .",
    "consequently , we get a number of distinct recurrent block equal to @xmath309 .",
    "in what follows , as explained in remark  [ rema : word - set ] , we make no distinction between a subset of @xmath4 and its characteristic word which belongs to @xmath181 .",
    "we consider indifferently complexity functions of both subsets of @xmath4 and binary words indexed by @xmath4 .",
    "the following lemma based on the pigeonhole principle is of particular importance in what follows .",
    "it is a first step to provide us with a set of relatively small local periods .",
    "the next step is corollary [ coro : lemmeqz ] which is more explicit respectively to our problem .",
    "this lemma is proven in for @xmath58 , we simply adapt it to our setting .",
    "[ lemmeqz ] let @xmath310 and @xmath311 be such that @xmath312 for all @xmath1 .",
    "let @xmath313 .",
    "there exists @xmath314 such that , for all @xmath315 satisfying @xmath316 and @xmath317 , and all @xmath318 , with @xmath319 , there exists a non - zero vector @xmath320 with @xmath321 , verifying @xmath322    far enough from the origin , every block is recurrent . formally , for all @xmath313 there exists @xmath323 such that if @xmath324 , then @xmath325 is recurrent in @xmath12 .",
    "let @xmath315 and @xmath326 be such that @xmath316 , @xmath317 and @xmath319 .",
    "if @xmath327\\!]^d$ ] , then @xmath328 . therefore , for all @xmath327\\!]^d$ ] , the blocks @xmath329 are recurrent .",
    "since @xmath330 , by the pigeonhole principle , there exist two distinct integer vectors @xmath331\\!]^d $ ] such that @xmath332 .",
    "let @xmath333 .",
    "we observe that @xmath334 . now",
    "consider @xmath11 in @xmath335\\!]^d$ ] , then @xmath11 and @xmath336 belong to @xmath337\\!]^d$ ] , and , @xmath11 and @xmath338 belong to @xmath339\\!]^d$ ] .",
    "the situation is depicted in figure  [ fig:14 ] .    .",
    "]    the conclusion follows from the fact that @xmath340 and from the overlap of the two blocks .",
    "the following corollary shows that lemma  [ lemmeqz ] is `` almost '' sufficient to complete the proof of theorem  [ theo : main ] .",
    "[ coro : lemmeqz ] let @xmath48 .",
    "suppose there exists @xmath311 such that @xmath341 for all @xmath1 .",
    "then , for all large enough @xmath128 there exists @xmath342 such that    @xmath343    suppose @xmath52 : @xmath344 for all @xmath1 .",
    "let @xmath345 be the characteristic word of @xmath12 .",
    "it suffices to show that there exists three words @xmath346 , @xmath347 and @xmath348 such that @xmath349 .",
    "we can of course suppose @xmath19 is an integer .",
    "there exists a positive integer @xmath18 such that all words of length @xmath350 appearing in @xmath351 and @xmath352 are recurrent ( i.e. , appear infinitely many times in these sequences ) .",
    "thus in @xmath353 and @xmath354 the number of words of length @xmath19 is less than @xmath19 .",
    "thus , due to morse  hedlund theorem ( theorem [ th : morse - hedlund ] ) both sequences are ultimately periodic : @xmath355 and @xmath356 where @xmath346 and @xmath347 are non - empty words .",
    "moreover it is classical to deduce from the proof of morse  hedlund theorem that @xmath357 and @xmath358 are both less than @xmath19 .",
    "this achieves the proof .",
    "thus we suppose @xmath359 .",
    "consider the following maps @xmath360 , @xmath361 and @xmath362 .",
    "let @xmath18 be such that    * @xmath363 is increasing on @xmath364 ; * @xmath365 for all @xmath21 ; * @xmath366 for all @xmath21 ; * @xmath367 for all @xmath21 .",
    "let @xmath368 be integers such that @xmath369 , @xmath370 and @xmath371 .",
    "let @xmath323 be given by lemma  [ lemmeqz ] .",
    "let @xmath315 be an integer satisfying @xmath372 .",
    "notice that @xmath315 satisfies the assumption of lemma  [ lemmeqz ] .",
    "we set @xmath373 .",
    "let @xmath374 satisfying @xmath375 .",
    "let @xmath376 be the vector consisting of ones . from lemma  [ lemmeqz ] , since @xmath377",
    ", there exists a vector @xmath77 , with @xmath378 such that @xmath379 .",
    "but as @xmath380 , we also have    @xmath381    thus , @xmath12 is @xmath382-periodic inside @xmath383 .",
    "moreover , from the choice of @xmath18 we obtain that    @xmath384 this completes the proof .    in order to obtain local periodicity",
    "as given in definition  [ def : localp ] leading to a proof of theorem  [ theo : main ] , it would be nice that corollary  [ coro : lemmeqz ] implies the existence of a set @xmath385 such that @xmath125 .",
    "this is the case in particular for @xmath58 ( as presented below ) .",
    "for @xmath386 we are not able to give such a direct proof as for @xmath58 .",
    "nevertheless this corollary is interesting because it provides us with a finite set of quite small local periods .",
    "we will use this when @xmath386 .",
    "the following two lemmata are also true in higher dimensions .",
    "the first one is another way to settle down the underlying idea of lemma  [ lemmeqz ] .",
    "let @xmath376 be the vector consisting of ones .",
    "[ lemma : distinctblocks ] let @xmath387 .",
    "suppose @xmath12 is @xmath77-periodic inside @xmath388 , for some @xmath389 , @xmath390 , and is not @xmath254-periodic for any @xmath254 with @xmath391 .",
    "then , the @xmath392 blocks @xmath393 with @xmath394\\!]^2 $ ] are pairwise distinct .",
    "suppose there exist two distinct vectors @xmath395 and @xmath396 in @xmath397\\!]^2 $ ] such that @xmath398 and @xmath399 are equal .",
    "let @xmath400 .",
    "then , @xmath391 and @xmath12 is @xmath254-periodic inside @xmath388 .",
    "[ lemme : vordonne ] let @xmath401 , @xmath387 and @xmath402 be vectors of @xmath403 such that    1 .",
    "@xmath404 are pairwise distinct ; 2 .   @xmath405 ; 3 .   for all @xmath225 , @xmath12 is @xmath406-periodic inside @xmath407 and is not @xmath254-periodic inside @xmath407 for any @xmath254 with @xmath408 ; 4 .",
    "[ lemme : enum:4 ] for all @xmath225 , @xmath12 is not @xmath409-periodic inside @xmath407 for @xmath410 .",
    "then , we have    @xmath411\\!]^2   , 1\\leq i \\leq k \\right\\ }   = \\sum_{i=1}^k ||\\mathbf{v}_i||^2 .\\ ] ]    from lemma  [ lemma : distinctblocks ] , for all @xmath225 , we have    @xmath412\\!]^2 \\right\\ }   =      and thus , when considering possibly larger blocks , we get    @xmath413\\!]^2 \\right\\ } =      let @xmath414 be such that @xmath415 .",
    "it is sufficient to prove that , for all vectors @xmath416\\!]^2 $ ] and @xmath417\\!]^2 $ ] , the blocks @xmath418 and @xmath419 are distinct .",
    "indeed , suppose there exist @xmath420 and @xmath421 such that @xmath418 and @xmath419 are equal .",
    "then , since @xmath422 is included in @xmath423 , @xmath12 would be @xmath409-periodic inside @xmath422 .",
    "this contradicts our assumption .",
    "let us conclude with the proof of theorem  [ theo : main ] for @xmath58 .",
    "let @xmath387 such that for some @xmath19 we have @xmath424 , for all @xmath1 , and having all its sections definable in @xmath5 . thanks to theorem  [ theo : muchnik ] , it suffices to prove that @xmath12 is locally periodic .    taking in corollary  [ coro : lemmeqz ] a large enough @xmath128 , @xmath12 satisfies the following property :    * ( p ) * there exist two positive integers @xmath128 and @xmath425 such that    1 .",
    "[ enum : vperiodic ] @xmath426 ; 2 .",
    "[ proof : enum : qz ] @xmath427 ; 3 .",
    "@xmath428 .",
    "let @xmath429 be such that if @xmath430 , then the block @xmath431 is recurrent .",
    "let @xmath432 be greater than @xmath433 .",
    "we need the following lemma .",
    "[ lemma : technique ] there exist vectors @xmath434 and @xmath435 such that    1 .",
    "for all @xmath436 , @xmath375 , there exists @xmath122 such that @xmath437 is @xmath77-periodic inside @xmath383 ; 2 .   for all @xmath225 , @xmath438 ; 3 .",
    "@xmath404 are pairwise distinct ; 4 .",
    "@xmath439 for all @xmath225 ; 5 .   for all @xmath225",
    ", @xmath12 is @xmath406-periodic inside @xmath440 and is not @xmath254-periodic inside @xmath441 for any @xmath254 with @xmath408 ; 6 .   for all @xmath225",
    ", @xmath12 is not @xmath409-periodic inside @xmath440 for @xmath410 .",
    "let @xmath442 be a sequence consisting of all vectors of @xmath443 , appearing only once , which is non - decreasing with respect to their norms .",
    "let @xmath444 be the set of recurrent blocks of size @xmath128 .",
    "note that from property * ( p ) * all elements of @xmath444 are @xmath77-periodic for some @xmath77 whose norm is less than @xmath445 .",
    "let @xmath446 be the set of recurrent blocks of size @xmath128 having @xmath447 as a local period .",
    "of course , @xmath446 can be empty .",
    "let @xmath448 be the subset of @xmath449 whose blocks have the local period @xmath450 .",
    "observe that these blocks do not have @xmath447 as a local period . continuing this way ,",
    "we obtain finitely many non - empty subsets @xmath451 of @xmath444 such that    1 .",
    "@xmath452 ; 2 .",
    "the blocks of @xmath453 have @xmath454 as a local period ; 3 .   for all @xmath455 and @xmath456",
    ", @xmath457 is not a local period for blocks in @xmath458 .",
    "property * ( p ) * ensures that for all @xmath459 , @xmath460 .",
    "we set @xmath461 . for all @xmath459 , there exists @xmath462 such that @xmath12 is @xmath463-periodic inside @xmath464 .",
    "the choice of @xmath432 allows us to suppose @xmath465 .",
    "this concludes the proof .",
    "let @xmath466 .",
    "lemma  [ lemma : technique ] provides us with vectors @xmath434 and a set @xmath435 fulfilling the hypothesis of lemma  [ lemme : vordonne ] . to get local periodicity",
    "it remains to show that @xmath467 .",
    "applying lemma  [ lemme : vordonne ] , we obtain    @xmath468    using property * ( p ) * , we deduce that @xmath469 .",
    "hence    @xmath470    let @xmath471 .",
    "then , we have    @xmath472    consequently , we get    @xmath473    hence , using cauchy  schwarz inequality , we deduce that    @xmath474    using the fact that , for all @xmath1 , @xmath475 we deduce that    @xmath476    this concludes the proof for @xmath58 .",
    "observe that this kind of computation gives nothing in dimension @xmath386 because , given some constants @xmath477 one should find some sufficiently large @xmath128 and a function @xmath478 such that @xmath479 .",
    "this is clearly not possible .",
    "but , maybe some of the above inequalities could be improved in order to have a direct proof for all @xmath386 .",
    "we leave this as an open question .",
    "in fact , as we did not used the assumption that each section of @xmath12 is definable , we prove more than what was expected .",
    "we have shown that the hypothesis @xmath480 implies the local periodicity of @xmath12 .",
    "thus , the definability of the sections is only needed to go from the local periodicity of @xmath12 to the definability of @xmath12 .",
    "we do not know whether it is true in higher dimensions .",
    "this is related to the previous remark .",
    "it remains to prove that if @xmath12 is a subset in @xmath4 such that @xmath47 and every section is definable in @xmath5 , then it is definable in @xmath5 .",
    "let us first recall some crucial results of muchnik .",
    "for all @xmath481 and @xmath482 , we define the _ border of @xmath14 in the direction @xmath77 _ as @xmath483     in the direction @xmath77 . ]    in figure  [ fig : new03 ] , points in @xmath14 are squares and points belonging to @xmath484 are inside circles .",
    "the following two lemmata show that it is sufficient to prove that , for some @xmath77 , the set @xmath485 is locally periodic .",
    "[ lemma : definablesections ] ( * ? ? ? * lemma  1.0 ) let @xmath481 and @xmath482",
    ". if all sections of @xmath14 are definable , then all sections of @xmath486 are definable .",
    "* lemma  1.2 ) [ lemma : definablewrtbd ] let @xmath481 and @xmath482 .",
    "the set @xmath14 is definable in terms of @xmath486 , @xmath487 and a finite number of sections of @xmath14 , i.e. , @xmath14 can be defined by a formula involving addition , order and unary predicates for the sets @xmath486 , @xmath487 and for a finite number of sections of @xmath14 .",
    "the next lemma suggests to proceed by induction on the cardinality of the set of local periods to prove that @xmath485 is locally periodic .",
    "* lemma  1.1 ) [ lemma : v - vperiodic ] let @xmath481 .",
    "suppose there exist @xmath128 , @xmath342 and a finite set @xmath488 verifying that , for all @xmath86 with @xmath87 , the set @xmath14 is @xmath120-periodic inside @xmath383 .",
    "then , for all @xmath482 and all @xmath86 with @xmath87 , the set @xmath486 is @xmath489-periodic inside @xmath383 .    to complete the proof of theorem  [ theo : main ] we will proceed by induction on the cardinality of @xmath120 .",
    "we will say that a set @xmath48 satisfies @xmath490 whenever :    1 .",
    "there exists @xmath311 such that , for all large enough @xmath491 , @xmath492 ; 2 .",
    "all sections of @xmath12 are definable ; 3 .",
    "[ pk : cond3 ] there exist @xmath128 , @xmath342 and @xmath488 verifying 1 .",
    "@xmath493 , 2 .",
    "@xmath494 , @xmath495 , and , 3 .",
    "@xmath496 .",
    "we note that , from corollary  [ coro : lemmeqz ] , the subsets of @xmath4 such that @xmath47 and having all its sections definable in @xmath5 , satisfy @xmath490 for some @xmath62 . hence , to complete the proof of theorem  [ theo : main ] it is sufficient to prove that the following assertion @xmath497 is true for all @xmath62 .",
    "@xmath498    if @xmath12 satisfies @xmath499 then corresponds to the local periodicity of @xmath12 .",
    "hence @xmath500 is true .",
    "let @xmath501 be such that @xmath502 are true .",
    "let @xmath12 be a subset of @xmath4 satisfying @xmath503 .",
    "it remains to prove that @xmath12 is definable .",
    "let @xmath19 , @xmath120 , @xmath128 and @xmath432 be given by @xmath503 for @xmath12 .",
    "[ lemma : epsilon - comp ] for all @xmath482 and @xmath504 there exists @xmath18 such that if @xmath21 , then @xmath505 .",
    "it suffices to see that @xmath506 for all @xmath313 .",
    "[ lemma : hypk ] for all @xmath122 the sets @xmath485 and @xmath507 satisfy @xmath490 .",
    "let @xmath508 . from lemma  [ lemma : epsilon - comp ]",
    "there exists @xmath504 such that    @xmath509    for all large enough @xmath1 . from lemma  [ lemma : definablesections ] all sections of @xmath510 are definable .",
    "we take for @xmath510 the constants @xmath511 and the set @xmath120 of @xmath12 . with lemma  [ lemma : v - vperiodic ]",
    "we know that @xmath510 is @xmath489-periodic inside @xmath383 for all @xmath11 with @xmath375 , and , thus satisfies @xmath490 .",
    "we can now conclude the proof of theorem  [ theo : main ] .",
    "let @xmath122 . from lemma  [ lemma : hypk ] , @xmath485 and @xmath507",
    "satisfy @xmath490 . by induction hypothesis",
    "both @xmath485 and @xmath507 are definable .",
    "hence , by lemma  [ lemma : definablewrtbd ] , @xmath12 is definable .",
    "we recall that for @xmath58 we do not need the definability of the sections to deduce the local periodicity .",
    "observe that for dimensions @xmath386 it is not the case : we need the definability of the sections to show that the boarders are definable and then , using the induction process and the muchnik criterion , to conclude the proof .",
    "in this section we recall some well - known works on the relations between the block complexity and the periodicity for subsets of @xmath4 and @xmath263 .",
    "we end this section with some comments , related to these works , on our main result with the additional hypothesis of repetitiveness .        1 .",
    "_ uniform discreteness_. each open ball of radius @xmath513 in @xmath263 contains at most one point of @xmath117 .",
    "2 .   _ relative density_. each closed ball of radius @xmath200 in @xmath263 contains at least one point of @xmath117 .",
    "the _ period lattice _ of a delone set @xmath117 is the lattice of translation symmetries given by @xmath515 .",
    "it is a free abelian group with rank between @xmath516 and @xmath6 .",
    "when the rank of @xmath517 is equal to @xmath6 , we say that @xmath117 is an _",
    "ideal crystal_.    let @xmath518 stands for the open ball centered in @xmath519 of radius @xmath54 .",
    "the set @xmath520 is called a @xmath54-patch of @xmath117 . in the sequel",
    "we will consider that two @xmath54-patches are equal when they are equal up to translation .",
    "the delone set @xmath117 is _ repetitive _ if for each @xmath54 there is @xmath521 such that every closed ball @xmath84 of radius @xmath54 contains all @xmath54-patches of @xmath117 ( up to translation ) .",
    "it is _ linearly repetitive _ if there exists a constant @xmath19 such that @xmath522 for all @xmath523 .",
    "we denote by @xmath524 the number ( possibly infinite ) of different @xmath54-patches ( up to translation ) .",
    "let @xmath12 be a subset of @xmath28 .",
    "if there exist @xmath534 such that the function @xmath92 counting the number of distinct @xmath25-blocks occurring in @xmath12 is such that @xmath535 , then @xmath12 is periodic .",
    "nivat s conjecture can not be an equivalence because the converse does not hold : there exists a periodic set @xmath12 in @xmath28 such that @xmath536 , for all @xmath537 , see .",
    "moreover , it can not be true for dimensions @xmath6 strictly greater than @xmath538 as shown in . a weaker form of nivat s conjecture is the following .",
    "let @xmath539 .",
    "if there exist @xmath534 such such that @xmath540 , then @xmath12 is periodic .",
    "it was proven for @xmath541 in and improved for @xmath542 in .",
    "this latter result is a consequence of the following one .",
    "[ theo : qz ] let @xmath12 be a subset of @xmath28 . if there exist @xmath534 such that for all @xmath543-blocks @xmath84 the function counting the maximum number of distinct @xmath25-blocks occurring in @xmath84 is less or equal to @xmath544 , then @xmath12 is periodic .",
    "let us recall some terminology introduced in .",
    "let @xmath545 .",
    "for all finite subset @xmath84 of @xmath4 we define the @xmath84-patterns of @xmath65 to be the functions @xmath546 defined by @xmath547 , @xmath548 .",
    "the set of all @xmath84-patterns is @xmath549 .",
    "when @xmath84 is a cube of size @xmath1 , then @xmath550 is equal to the block complexity @xmath551 . in the following conjecture",
    "is stated .",
    "it is shown in that the periodicity principle is true in dimension 1 and turns to be false in higher dimensions without some additional assumptions .",
    "if the nivat s conjecture holds true , it could be considered as a _ restricted _ periodicity principle for rectangle blocks .            1 .",
    "[ hyp1 ] @xmath47 and every section is definable in @xmath5 ; 2 .",
    "[ hyp2 ] for all @xmath49 every @xmath50-dimensional section of @xmath12 has a recurrent block complexity in @xmath51 ; 3 .",
    "@xmath12 is an ideal crystal .",
    "observe that in the above result , assumptions or are much stronger than those of the period conjecture .",
    "nevertheless we obtain a necessary and sufficient condition to be an ideal crystal in terms of block complexity .",
    "moreover , for @xmath553 , the period conjecture expects only two linearly independent periods when we obtain an ideal crystal , that is @xmath6 linearly independent periods .",
    "similar comments are also valid for the periodicity principle .",
    "thus , we obtain a restricted periodicity principle as it holds for cubic blocks @xmath84 .",
    "but we obtain a much stronger result than just a one dimensional periodicity conclusion .",
    "a natural question is whether theorem  [ theo : coromain ] remains true for any finite subset @xmath84 in order to have a periodicity principle for repetitive sets .",
    "another question is to ask whether the periodicity principle or the period conjecture are true for some well - known families of delone sets or tilings like those of finite type , linearly repetitive , substitutive , ..."
  ],
  "abstract_text": [
    "<S> a celebrated result of morse and hedlund , stated in 1938 , asserts that a sequence @xmath0 over a finite alphabet is ultimately periodic if and only if , for some @xmath1 , the number of different factors of length @xmath1 appearing in @xmath0 is less than @xmath2 . attempts to extend this fundamental result , for example , to higher dimensions , have been considered during the last fifteen years . </S>",
    "<S> let @xmath3 . </S>",
    "<S> a legitimate extension to a multidimensional setting of the notion of periodicity is to consider sets of @xmath4 definable by a first order formula in the presburger arithmetic @xmath5 . with this latter notion and using a powerful criterion due to muchnik </S>",
    "<S> , we exhibit a complete extension of the morse  hedlund theorem to an arbitrary dimension @xmath6 and characterize sets of @xmath4 definable in @xmath5 in terms of some functions counting recurrent blocks , that is , blocks occurring infinitely often . </S>"
  ]
}