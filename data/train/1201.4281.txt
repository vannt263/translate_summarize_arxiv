{
  "article_text": [
    "the virial theorem in classical and quantum mechanics has been known for a very long time .",
    "it appears for the first time in the classical works of clausius in 1870 @xcite in the context of statistical mechanics .",
    "see also @xcite for a historical account . already in 1930",
    ", fock @xcite derived the quantum mechanical version of the theorem that relates the expectation value of the kinetic energy in an eigenstate @xmath0 of the hamiltonian to that of the clausius virial function .",
    "more precisely @xmath1 the theorem was initially derived for eigenstates of non relativistic hamiltonian in flat space with potentials depending only on the position , but it can be generalized in many different ways : for relativistic systems , for a particle moving in an electromagnetic field , to many body systems , mixed states and for compact space @xcite-@xcite to mention a few .",
    "also recently it has been formulated a local version of the virial theorem for systems of fermions , see refs . @xcite and @xcite .",
    "another kind of generalization is the hypervirial theorem @xcite that works , in principle , for any operator @xmath2 and can be written @xmath3\\psi_n\\rangle=0.\\ ] ] the virial theorem in dimension @xmath4 is recovered when @xmath5    in this paper we want to discuss the domain of validity of these theorems and , for the cases in which they fail , we show how to modify them by adding the appropriate term related to the boundary conditions of the quantum system . in this way",
    "we extend the applicability of the virial and hypervirial theorem to these systems .    in concrete terms ,",
    "assume that the hamiltonian is defined over a domain @xmath6 .",
    "@xmath0 necessarily belongs to @xmath6 , but it may happen that @xmath7 . in this case",
    "the hypervirial theorem has to be modified by the addition of an extra term @xmath8 : @xmath9\\psi_n\\rangle={\\cal a},\\end{aligned}\\ ] ] with @xmath10 where @xmath11 is the energy eigenvalue of @xmath0 and @xmath12 is the closed extension of @xmath13 to a domain that includes @xmath14 .",
    "of course , the new term cancels if @xmath15 i.e. when @xmath16 , but if that is not the case it is different from zero in general .",
    "we will see that @xmath8 can be computed as the integration of a pure derivative term and , therefore , it depends only on the value of the wave function and its derivatives at the boundary .",
    "this fact is reminiscent of the analogous objects in quantum field theory like the chiral anomaly @xcite . we would like to remark that an additional term for the virial ( or hypervirial ) theorem in classical mechanics may appear also when the orbits are not bounded in phase space .",
    "this paper is organized in the following fashion : in the next section we discuss a simple example to motivate our study and obtain the generalization of the hypervirial theorem .",
    "then we give two examples of systems where this generalization is needed , in section iii we discuss the hydrogen atom problem with point interaction in three dimensions while the section iv is devoted to the isotropic harmonic oscillator .",
    "finally we sketch our conclusions in section v.",
    "before discussing the required generalization of the hypervirial theorem we would like to motivate our study by considering a very simple example .    consider a free particle in one dimension restricted to move in @xmath17 and subject to robin boundary conditions , i.e. @xmath18 with @xmath19 . in this case",
    "the free hamiltonian has a single eigenfunction @xmath20 with eigenvalue has a negative eigenvalue .",
    "note , however , that @xmath21 is not symmetric with robin boundary conditions and in fact one has @xmath22 and the second term on the right provides a negative contribution . ] @xmath23 if we use ( [ virial ] ) to compute the expectation value of the kinetic energy in this state we obtain that it vanishes , which is in contradiction with the real result @xmath24    the reason for this apparent contradiction is the fact that the domain of the hamiltonian is not preserved by the generator of the scale transformation @xmath25 and the virial theorem has to be modified .    to understand the origin of this modification let us consider in detail the derivation of the virial theorem .",
    "we assume a quantum system with infinite dimensional state space and a self - adjoint hamiltonian with domain @xmath6 . if @xmath16 we have @xmath26\\psi_n\\rangle&= & \\langle\\psi_n|hg\\psi_n\\rangle- \\langle\\psi_n|gh\\psi_n\\rangle = \\cr & = & \\langle h\\psi_n|g\\psi_n\\rangle- \\langle\\psi_n|gh\\psi_n\\rangle = 0\\end{aligned}\\ ] ] where in the second line we have used that @xmath13 is self - adjoint and that @xmath0 is its eigenstate .",
    "the problems appear if @xmath27 . in this case",
    "the expressions in the first line of ( [ virialder ] ) do not make sense unless we extend @xmath13 to a larger domain that includes @xmath14 . in principle",
    "it can be done in an arbitrary way but in this case there is a well defined prescription to obtain the required extension .",
    "first we restrict @xmath13 to an appropriate dense subspace @xmath28 , typically to functions whose support does not include the boundary . if we define @xmath29 , the extension @xmath12 is the adjoint of the previous restriction , i.e. @xmath30 .",
    "we will assume that the restriction is closed ( which could always be achieved by taking the closure of its graph ) and then we know @xmath31 .    with the previous machinery we can rewrite ( [ virialder ] ) in a meaningful way @xmath32\\psi_n\\rangle&= & \\langle\\psi_n|h_*g\\psi_n\\rangle- \\langle\\psi_n|gh\\psi_n\\rangle = \\cr & = & \\langle\\psi_n| ( h_*-e_n)g\\psi_n\\rangle\\equiv{\\cal a},\\end{aligned}\\ ] ] and obtain the generalized virial theorem as announced in the introduction .",
    "looking at the last line of this expression one could be tempted to take the adjoint of the operator @xmath12 and make it act in the left side of the scalar product . however ,",
    "this is not possible in general as the adjoint of @xmath12 is @xmath33 with a domain smaller than @xmath13 that may not contain @xmath0 .",
    "of course , if it so happens that @xmath34 the additional term cancels .",
    "we would like to show now that under certain assumptions ( that we actually meet in our examples ) the extra term is a boundary term , i.e. it depends only on the value of the functions and their derivatives at the boundary .",
    "first of all , we rewrite the extra term in a way that is appropriate for wave functions that are not necessarily eigenvectors of @xmath13 , @xmath35 then we will show that the value of @xmath8 does not change if we replace @xmath0 by @xmath36 with @xmath37 and @xmath38 .",
    "the difference reads @xmath39 now , given that @xmath40 , we can replace @xmath12 by @xmath13 in the first term of this expression and , if we take its adjoint , it cancels the second term . for the very same reason the last two terms cancel .",
    "also in the third term we can take the adjoint of @xmath12 , because @xmath41 is in the domain of @xmath31 , and therefore it cancels the fourth term and @xmath42 vanishes .",
    "then if , as we supposed before , the elements of @xmath28 are wave functions whose support does not contain the boundary we deduce that the extra term @xmath43 is invariant under deformations of @xmath0 that do not affect the values of the function and its derivatives at the boundary or , in other words , the extra term depends only on the latter .    as an illustration to these results and before discussing the examples of physical interest , we will compute the new term for the simple system introduced at the beginning of this section .",
    "one immediately gets @xmath44 which is a pure boundary term ( for any operator @xmath2 ) as stated .    in our particular case",
    "it amounts to @xmath45 now taking into account that @xmath46=2t$ ] and plugging these expressions into the generalized hypervirial theorem ( [ virialano ] ) we get @xmath47 from which ( [ expectationt ] ) follows .",
    "we have seen that if we modify appropriately the hypervirial theorem it can be applied to situations in which the action of the operator @xmath2 on the energy eigenstate puts it out of the domain of the hamiltonian . in the following sections we will apply this idea to the coulomb problem and later on to the isotropic harmonic oscillator .",
    "in this section we shall discuss the virial theorem for the coulomb problem in three dimensions .",
    "we shall see that with the chosen boundary conditions at the origin the extra term is required to cancel the divergence that appears in the application of the virial theorem .    consider the hamiltonian @xmath48 if we separate the angular variables from the radial one we obtain the hamiltonian for the latter @xmath49 that depends on the angular momentum number @xmath50 . here",
    "@xmath51 .",
    "we can simplify the hamiltonian by performing a similarity transformation @xmath52 . therefore the new wave functions @xmath53 are square integrable in @xmath17 with respect to the lebesgue measure .",
    "the new hamiltonian is then @xmath54 and it is symmetric with respect to the lebesgue measure in @xmath17 when acting on normalizable wave functions whose support does not contain the origin .    in order to have a self - adjoint hamiltonian we have to look for extensions of @xmath55 with such a property .",
    "this issue has been analyzed in detail in ( @xcite ) .",
    "the result is that if @xmath56 there is a single self - adjoint extension of @xmath55 whose domain are the wave functions that vanish at @xmath57 , while @xmath58 has an infinite number of self - adjoint extensions characterized by a single parameter @xmath59 .",
    "if we call @xmath60 such a self - adjoint extension , its domain is given by @xmath61 where the little-@xmath62 notation has been used .",
    "the case of wave functions that vanish at the origin ( the standard boundary conditions for the hydrogen atom ) is recovered when @xmath63 and @xmath64 , while the product @xmath65 remains finite",
    ".    the point - spectrum of @xmath60 is obtained from the solutions in @xmath66 to the equation @xmath67 such that @xmath68 . here",
    "@xmath69 is the euler s constant and @xmath70 is the digamma function , i.e. the logarithmic derivative of the gamma function .",
    "for a solution @xmath71 of the previous equation the eigenvalue of @xmath60 is @xmath72 in fig .",
    "1 we represent graphically the solutions of ( [ eqeigen ] ) for @xmath66 , as the intersection of the branches of the curve with the line of constant value @xmath73 . in the negative side @xmath74 has an asymptotic value @xmath75 .     in the horizontal axis and we plot @xmath76 .",
    "the point - spectrum of @xmath60 is obtained from the values of @xmath66 at the intersection of the graph of @xmath77 with the horizontal line at @xmath73 . only those values of @xmath66 with the same sign that @xmath78 are allowed.,scaledwidth=45.0% ]    note that even in the presence of a repulsive coulomb potential , @xmath79 , if we take @xmath80 there is a single bounded state associated to the negative solution for @xmath66 of the equation @xmath81 .",
    "the eigenfunction associated to the eigenvalue @xmath11 is given by the whittaker function @xcite conveniently normalized @xmath82 with the normalization constant given by @xmath83 where the prime denotes derivative .",
    "now we want to apply the generalized form of the virial theorem to this system .",
    "we take the operator @xmath84 , then the modified hypervirial theorem reduces to @xmath85 using the energy eigenvalue and integrating out the angular coordinates we can write for the radial wave function @xmath86 in this expression we can immediately see the necessity of an additional contribution to the virial theorem : the expectation value of the potential term diverges logarithmically at the origin ( recall that we must use the lebesgue measure in @xmath17  ) while the right hand side is finite .",
    "in fact , we shall see that an analogous divergence appears in the extra contribution so that both of them cancel to yield the correct finite result .",
    "we will sketch how to verify it .",
    "we first introduce a cut - off @xmath87 that removes the origin from the integration region .",
    "the extra term only depends on the boundary conditions of the wave function",
    ". we can take it from ( [ anomaly ] ) and in its",
    "_ regularized _",
    "version reads @xmath88 where the dots stand for terms that vanish when @xmath89 .",
    "we now compute the potential term @xmath90 to evaluate the expectation value we use @xmath91 where , as before , the dots represent terms that vanish when @xmath89 .",
    "the integral can be obtained using the identity @xcite @xmath92.\\end{aligned}\\ ] ] and the series expansion of @xmath93 @xcite .    putting everything together and given @xmath94 and ( [ eqeigen ] ) we obtain , @xmath95 in agreement with ( [ anocoulomb ] ) .",
    "in the previous section we saw that the verification of the virial theorem were plagued by infinities .",
    "this fact is not inherent to the generalized virial theorem itself but it is rather related to the singularity in the coulomb potential . to illustrate this fact we shall discuss now a new instance of the generalized virial theorem in three dimensions that is free of these divergences .",
    "we consider a @xmath96 dimensional harmonic oscillator given by the hamiltonian @xmath97 as before , we factorize the angular part and study the radial hamiltonian for the radial part @xmath98 of the wave function of angular momentum number @xmath50 : @xmath99 or acting on @xmath100 @xmath101 that is a symmetric operator with respect to the lebesgue measure in @xmath17 when acting on functions whose support does not include the point 0 .    in order to obtain a self - adjoint operator we have to extend @xmath55 to a larger domain . as it was the case in the previous section if @xmath56 the only self - adjoint extension is to functions that vanish at the origin . in this case",
    "the extra term cancels and the standard virial theorem holds .",
    "however , if @xmath102 , we have a whole family of self - adjoint extensions parametrized by @xmath103 .",
    "if we call @xmath104 such an extension its domain corresponds to robin boundary conditions , i.e. @xmath105    the normalized eigenfunctions of @xmath104 can be written in terms of the whittaker function as @xmath106 where @xmath107 , @xmath108 and the normalization constant @xmath109 is obtained from the condition @xmath110 the integral can be performed using ( [ prudnikov ] ) and finally we get @xmath111    only for specific values of @xmath112 the eigenstates ( [ eigen3 ] ) belong to domain ( [ domain2 ] ) , demanding @xmath113 we obtain the equation for @xmath112 @xmath114 the solutions are represented in fig .",
    "2 .     with @xmath112 in the horizontal axis .",
    "the point spectrum of @xmath104 are obtained from the values of @xmath112 at the intersection of the graph of @xmath115 with the horizontal line at @xmath116 .",
    "the possible values of @xmath112 are given as the intersection of the curve with the horizontal line at @xmath116.,scaledwidth=45.0% ]    in general the eigenvalues @xmath117 must be computed numerically .",
    "one particular case in which we have analytic solutions is @xmath118 , that correspond to neumann boundary conditions . in this case",
    "we get @xmath119 .",
    "we also have exact results for @xmath120 , dirichlet boundary conditions and @xmath121 .",
    "the latter corresponds to the harmonic oscillator without point interaction .",
    "note also that for @xmath122 , there is an eigenstate with negative energy . of course",
    ", as discussed in the footnote of section ii , there is not a contradiction between the negative eigenvalue and the fact that @xmath104 is the sum of squares of operators .",
    "the point is that with robin boundary conditions some of those operators are not self - adjoint and there is not any reason to argue that @xmath104 is semi - positive definite .",
    "the same applies to the coulomb potential with repulsive interaction that we discussed in the previous section .",
    "the generalized virial theorem , in terms of the radial wave function @xmath123 , reads @xmath124 were we have taken @xmath2 as before . using the energy eigenvalue we can rewrite the identity above in the following way @xmath125 and this is the expression that we will check .",
    "we first compute the additional term @xmath126 in the last equality condition ( [ eigenharm ] ) was used .",
    "the expectation value of the potential can be written @xmath127 where the change of variable @xmath128 was performed .",
    "now we can compute the previous integral with the help of the identity @xmath129 that we apply to one of the factors of the square inside the integral .",
    "we perform the resulting integrals using ( [ prudnikov ] ) and finally we obtain @xmath130 if we plug this expression and ( [ anoharmonic ] ) into ( [ anovirharmonic ] ) we can see that the identity holds .",
    "we proved that , when the dilations symmetry does not keep invariant the domain of definition of the hamiltonian , the exact virial theorem has an extra term that accounts for this fact .",
    "we have shown that this term is the integral of a pure derivative and , therefore , its value depends only of the behaviour of the wave function at the boundary .",
    "we have verified this generalization of the virial theorem in the cases of coulomb and harmonic oscillator with point interaction in three dimensions .    as an extension of our work",
    ", it could be interesting to study if a similar phenomenon occurs for the local virial theorem for fermions with harmonic potential @xcite@xcite , and the boundary conditions used in this paper .",
    "this work is supported by cicyt ( grant fpa2009 - 09638 ) and dgiid - dga ( grant 2010-e24/2 ) .",
    "m. brack , a. koch , m.v .",
    "murthy , j , roccia , j. phys .",
    "a * 43 * , no .",
    "25 , 255204 ( 2010 ) k. bencheikh , l.m .",
    "nieto , j. phys .",
    "a * 43 * , no .",
    "37 , 375002 ( 2010 ) .",
    "hirschfelder , j. chem . phys . * 33 * , 14621466 ( 1960 ) ."
  ],
  "abstract_text": [
    "<S> it is shown that under certain boundary conditions the virial theorem has to be modified . </S>",
    "<S> we analyze the origin of the extra term and compute it in particular examples . </S>",
    "<S> the coulomb and harmonic oscillator with point interaction have been studied in the light of this generalization of the virial theorem . </S>"
  ]
}