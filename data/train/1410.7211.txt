{
  "article_text": [
    "the surface electrocardiogram ( ecg ) is recognized as an invaluable tool for monitoring heart condition , since its analysis provides decisive information that can reveal critical deviations from normal cardiac behavior .",
    "recent developments in mobile sensors and mobile computing have enabled new scenarios for continuous ecg monitoring as an inexpensive tool for the early detection of some cardiac events@xcite , especially in those cases where symptoms appear intermittently .    as the monitoring period increases ,",
    "the interpretation task becomes more time consuming and decision - support tools are needed to help cardiologists to reduce the time spent on it . if a continuous follow - up is required , these tools become imperative .",
    "their main aim is to provide the cardiologists with a summary of all the acquired signals , enhanced with a fast locating of those anomalies detected .",
    "cardiac arrhythmias are the most relevant among the ecg findings .",
    "there are two main sources of arrhythmias : an automatism disorder , that is , a set of alterations in the beat activation point due to changes in its location or activation frequency ; or a conduction disorder , that is , an abnormal propagation of the beat wavefront through the cardiac tissue .",
    "they both have an effect on the ecg , affecting the beat morphology and/or beat rhythm . in order to support their identification , a method for separating the beats by their activation point and conduction pattern",
    "should be provided .",
    "beat classification arises as the task of assigning each beat in an ecg a label identifying its physiological nature .",
    "machine learning techniques have been applied to this task by estimating the underlying mechanisms that produce the data of a training set .",
    "the main drawback of this approach is its strong dependence on the pattern diversity present in the training set .",
    "thus , inter - patient differences show that it can not be assumed that a classifier trained on data of a large set of patients will yield valid results on a new patient @xcite , and intra - patient differences show that this can not be assumed even for the same patient throughout time .",
    "in addition , class labels only provide gross information about the origin of the beats in the cardiac tissue , loosing all the information about their conduction pathways .",
    "this approach does not distinguish the multiple morphological families present in a given class , as occurs in multifocal arrhythmias .",
    "in contrast , beat clustering aims at dividing the ecg recording in a set of beat clusters , each one of them preserving some similarity properties .",
    "previous proposals have focused on an offline approach , from a priori maximum number of clusters @xcite and they imply processing the ecg signal once the acquisition has been completed . this approach has given good noise robustness , but as a side effect a single morphology is usually replicated in several clusters and rare beat morphologies can be missed .",
    "it also omits the dynamic aspect of ecg and , in particular , ignores the temporal evolution of morphologies .",
    "furthermore , the detection of critical events can be deferred too long to provide timely attention .",
    "for all these reasons , a dynamic online approach must be considered .    in this paper , we present a real - time method for adaptive beat clustering , with a potential application not only as a previous step for classification @xcite , but also as a summary about those beat morphologies present in a certain period , their temporal evolution and variability , or even to detect the presence of alternating morphologies .",
    "the proposed method emulates the experts behavior in exploiting the temporal context for assigning each new beat to the most appropriate cluster . to this end",
    ", clusters are continuously adapting to the temporal evolution of beat morphologies , and they can be dynamically created , merged or modified , resulting in a variable number of clusters .",
    "beat clustering requires extracting from the ecg a set of representative measurements for every beat .",
    "bibliography shows a variety of proposals for beat representation that can be grouped into four categories : _ morphological features _ where the signal amplitude is directly used @xcite ; _ segmentation features _ like area , amplitude or interval duration from beat waves @xcite or amplitude and angle values from vectorcardiogram @xcite ; _ statistical features _ derived using high order cumulants@xcite and finally , _ transformed space features _ , defined in an alternative space using different transforms like karhunenloewe transform @xcite , hermite basis functions @xcite , discrete fourier transform @xcite or wavelet transform @xcite .",
    "all the previous works complete their feature sets with rhythm information to complement their description capabilities .",
    "the present paper proposes a new approach to represent a beat by reducing the qrs complex to a set of relevant points and support regions .",
    "this representation has some nice properties for beat clustering : it is stable against the usual variability and the presence of noise in the ecg , and it explicitly represents the temporal location of some qrs features .",
    "the proposed method processes a real - time multilead ecg signal through a set of data - driven stages as shown in fig .",
    "[ fig_scheme ] . in order to obtain comparable results , signals from two standard ecg signal databases",
    "are used as data source ( section [ databasesection ] ) .",
    "the pre - processing stage comprises real - time beat detection and baseline filtering ( section [ preprocessing ] ) .",
    "then , a fixed - length signal segment is selected for extracting and characterizing the qrs complex ( subsection [ clustering].a ) .",
    "qrs complexes are compared to the current set of clusters following a context - based criteria to obtain the best matching cluster ( subsections [ clustering].bd ) .",
    "afterwards , the current cluster set is updated in one of three ways : creating a new cluster , modifying the most similar one or merging two or more clusters ( subsection [ clustering].e ) .",
    "the next stage performs a noise analysis for each lead in order to detect noisy intervals and avoid the processing of noisy beats or discard the clusters created from them ( section [ noise ] ) . finally , the beats are classified by their rhythm type and a set of groups with common morphology and rhythm is obtained ( section [ rhythm ] ) .",
    "the ecg databases have been processed and their beat class labels have been used to validate the purity of the final cluster and group sets ( section [ results ] ) .",
    "these results are discussed in section [ discussion ] along with the conclusions of the work .",
    "the ecg databases recommended by the ansi / aami ec57 @xcite standard for reporting the performance of arrhythmia detectors were used for validation purposes : the mit - bih arrhythmia database and the aha ecg database .    the mit - bih arrhythmia database @xcite@xcite can be referred to as the golden standard for beat clustering and classification tasks and it is the reference database for almost all the literature in this field .",
    "this database is composed of 48 recordings of ambulatory ecg , obtained from 47 different patients which comprise a very complete set of examples of common and rare arrhythmias .",
    "each record has a duration of 30 min , and includes two channels with the same leads in almost all of them : a modified - lead ii ( mlii ) in the first one and lead v1 in the second one .",
    "mlii was replaced by lead v5 in three records and v1 was replaced by mlii , v2 , v4 or v5 on eight records .",
    "the signals were digitized at @xmath0hz and bandpass filtered with cutoff frequencies at 0.1 and 100hz .",
    "all beats present in the database were annotated by at least two expert cardiologists , and assigned a class label using a 16 label set .",
    "the aha ecg database was compiled by the american heart association and it is composed of 155 recordings of ambulatory ecg digitized at @xmath1hz containing the most relevant types of ventricular arrhythmias .",
    "each record is three hours long with two channels but only the last 30 minutes have been manually annotated by experts .",
    "the major drawback of processing long - term ecg signals is the presence of a high level of noise with multiple manifestations baseline wandering , power line interference or electromyographic activity so an initial filtering stage needs to be performed .",
    "the efforts have been focused on filtering the baseline wandering , as this is the most relevant source affecting the reliability of the clustering algorithm because of the distortion it can cause on the qrs morphology .",
    "the baseline filtering is performed through the estimation of the baseline wandering and its posterior elimination from the original ecg . to achieve this goal ,",
    "each signal is processed by two sequentially connected median filters of 200ms and 600ms , respectively , as described in @xcite .",
    "a global delay of 400ms is added by this process , independently of the sampling rate .      in order to carry out an evaluation of the clustering method separately from beat detector and provide a fair comparison framework for future algorithms",
    ", we used the beat position provided by the ecg databases as fiducial points .",
    "a beat detector is required for real scenarios , affecting the quality of results .",
    "however , it virtually does not increment the global computational complexity as qrs detection represents only a small fraction of it .",
    "the global delay would not be affected either , since the beat detection can be performed concurrently with baseline filtering with a shorter delay .",
    "in this paper the following notation is used .",
    "bold face variables ( e.g. , @xmath2 ) to represent vectors and sequences , lower case alphabets with subscripts to represent their components ( e.g. , @xmath3 ) or superscripts when a temporal index is used as a subscript ( e.g. , @xmath4 ) , upper case alphabets ( e.g. , @xmath5 ) to represent sets , and calligraphic letters to represent functions ( e.g. , @xmath6 ) .",
    "the aim of the clustering method is to group in real - time those beats which share the same activation area and propagation pattern in the cardiac tissue .",
    "the propagation of the electrical impulse through the heart is reflected in the ecg as a sequence of waves corresponding to the activity in the atria and ventricles .",
    "p wave and qrs complex are of particular interest since they show the atria and ventricular depolarization , respectively , thereby providing a fingerprint of the conduction pathway . since the noise level of ambulatory signals makes the detection of the p wave a very difficult task , we focus on the qrs morphology to characterize the beat . as a consequence ,",
    "beats with different atrial activation points or even with nodal activation points can share the same qrs morphology , and will be assigned to the same cluster . in the absence of a p wave analysis , rhythm information can be useful in some cases to detect this situation , as explained in section [ rhythm ] .",
    "the proposed method is intended to provide a real - time resume of the ecg signal as a dynamic set of clusters .",
    "whenever a new beat is detected , the set of clusters is updated .",
    "let @xmath7 denote a time series @xmath8 where @xmath9 is the set of clusters that represents those qrs morphologies which appeared from the beginning of the recording up to the beat @xmath10 , @xmath11 is the set of beats assigned to cluster @xmath12 and @xmath13 the number of clusters , both at beat @xmath10 .",
    "the clustering follows a data - driven flow triggered by the beat detector as shown in fig .",
    "[ fig_scheme ] .",
    "each new beat is compared to the set of clusters @xmath14 using concordance and dissimilarity measures in order to find the best matching and giving preference to those in its temporal context .",
    "a detailed explanation of this process follows in the remaining subsections : first , a beat characterization and a template - based representation of the clusters ; next , the alignment technique and the measures used to compare beats and clusters ; afterwards , the criteria for cluster selection and , finally , the process of updating the set of clusters .",
    "we adopt a strategy inspired by dominant point detection @xcite to characterize the qrs morphology through its constituent waves .",
    "let @xmath15 denote a time series which represents the multilead ecg signal , where @xmath16 is the number of leads and @xmath17 is the vector of samples at time @xmath18 for all leads . when the @xmath10th beat is detected with fiducial mark at time @xmath18 , a fixed - length subsequence of @xmath19 samples ( @xmath20 before and @xmath21 after @xmath18 ) is selected from each lead @xmath22 to represent its qrs complex ( see fig .",
    "[ fig_beatdp ] ) : @xmath23 where @xmath24 .",
    "we set @xmath25 and @xmath26 , which are wide enough to capture the longest qrs of abnormal beats @xcite ( v , f and f beat types , typically ) .",
    "most of this section describes operations over one lead , so for the sake of notation simplicity the @xmath22 superscript will be obviated unless multiple leads are involved .",
    "we define the * curvature * @xmath27 at @xmath28 as : @xmath29 where @xmath30 .",
    "the terms @xmath31 and @xmath32 denote the intervals used for calculating the curvature , and they are given by : @xmath33 where @xmath34 .",
    "the term @xmath35 is the maximum physiologically meaningful width of a qrs wave between its peak location and its left or right end , so that it is the upper limit of @xmath31 and @xmath32 .",
    "the term @xmath36 is the minimum height for a signal deflection to be considered physiologically relevant and , therefore , to be excluded from the calculation of curvature .",
    "we define the * dominance region * of a sample @xmath37 as : @xmath38,\\ ] ] where @xmath39 for any fixed @xmath40 and @xmath41 for any fixed @xmath42 .     for lead @xmath43 , of a beat at sample 4102 , @xmath44 , from record 108 of the mit - bih database .",
    "the relevant points detected by the algorithm are marked with * .",
    "the parameters involved in the relevant point detection are also shown.,width=335 ]    we define the set of * dominant points * of @xmath45 as : @xmath46 where @xmath47 .",
    "we define the set of * relevant points * of @xmath45 as : @xmath48 where @xmath49 is the minimum height for a signal deflection to be considered a relevant qrs wave , with @xmath50 .",
    "if @xmath51 , then it is redefined as : @xmath52 .",
    "the limits of @xmath53 can be located at any point in the edge of a wave .",
    "since we are interested in capturing its full extent , the * support region * of a relevant point @xmath54 is defined as : @xmath55\\ ] ] where @xmath56 and @xmath57 are the sample numbers nearest to @xmath58 and @xmath59 where slope sign changes : @xmath60 , \\delta q_{j , a}\\!>\\!\\delta q_{j , a+1}\\ } ) \\\\",
    "j^+\\!\\!=&\\!\\max_{k\\in i_j^+}(\\{k\\!\\mid\\!k\\!\\ge\\!r^+\\!\\wedge \\forall a\\!\\in\\![r^+,k ] , \\delta q_{j , a}\\!<\\!\\delta q_{j , a+1}\\}).\\end{aligned}\\ ] ] in consequence , adjacent support regions can now overlap .",
    "a relevant point @xmath61 is said to be in a concave wave if @xmath62 and @xmath63 .",
    "otherwise , it is said to be in a convex wave .",
    "the wave height is defined as @xmath64 .",
    "finally , the @xmath10th beat is represented by the qrs signal segment and the set of its relevant points and support regions @xmath65 and denoted by : @xmath66    there is not a consensus in the literature about the limits for width and height of qrs complex or individual qrs waves .",
    "the aami standard @xcite recommends a minimum amplitude of @xmath67 and duration of @xmath68ms for a qrs wave to be detected , and @xmath69 for peak - to - peak qrs amplitude , with a minimum duration of @xmath70 . on the other hand , the aha @xcite and cse @xcite report lower amplitude for qrs waves ( down to @xmath71 and @xmath68ms ) , based on measures over averaged beats with increased signal - to - noise ratio .",
    "these limits were not established for physiological reasons , but for signal noise level or instrumentation limitations .",
    "nothing is stated about maximum qrs width beyond a reference to case - based duration values ( e.g. the cse study @xcite reports a maximum qrs width of @xmath72ms ) . in our case , due to the signal - to - noise ratio present in the ambulatory signals , the value of @xmath49 is set to 150@xmath73v in order to avoid the detection of small waves caused by noise and the value of @xmath35 is set to @xmath74ms to accept qrs waves with a maximum width of @xmath75ms . the value of @xmath36 is set to @xmath76 following the aami standard @xcite and will be useful to detect noise contaminated qrs complexes .    in order to perform the comparison between a new beat @xmath77 and the current set of clusters @xmath78 , each cluster @xmath79 is represented by a template : @xmath80 where @xmath81 is derived from the qrs of the beats assigned to @xmath79 as will be explained in section [ clusterupdate ] .      in order to compare a beat @xmath77 with a cluster template @xmath82 , a temporal alignment of @xmath45 and @xmath83",
    "is performed using dynamic time warping ( dtw ) @xcite .",
    "the aim of this alignment process is twofold .",
    "first , to correct any temporal misalignment due to a misplaced fiducial mark . and second , to reduce the contribution of the height and width variability of the qrs waves to the dissimilarity measure .",
    "dtw was previously used for this purpose in @xcite , providing a relation @xmath84 between @xmath45 and @xmath83 called warping path , with @xmath85\\!\\times\\![1,\\!w ] , k\\!\\in\\![1,\\!k]$ ] and @xmath86 .",
    "each @xmath87 represents the alignment of the index @xmath88 of @xmath89 with the index @xmath90 of @xmath91 under three conditions : first , @xmath92 and @xmath93 ; second , @xmath94 and @xmath95 @xmath96 ; and third , @xmath97 .",
    "these conditions preserve the time - ordering of points and prevent some point being missed in the alignment .",
    "let @xmath98 denote the cost function associated to a warping path defined by @xmath99 , where @xmath100 is the local cost function associated with each element of @xmath101 .",
    "the optimal warping path is the one that minimizes @xmath98 .",
    "dtw aligns the original signal samples , so any component @xmath102 from @xmath101 where @xmath103 introduces a horizontal segment into the aligned signals .",
    "since this can lead to unacceptable distortion of the qrs , we adopt the derivative dynamic time warping ( ddtw ) @xcite which uses the estimation of the derivative instead of the signal itself .",
    "the derivative is approximated by the first difference : @xmath104 and @xmath105 with @xmath106 and @xmath107 .     and @xmath108 subsequences ; ( b ) @xmath109 and @xmath110 derivative approximations ; ( c ) optimally - aligned derivatives of length @xmath111 ; ( d ) subsequences @xmath112 and @xmath113 of length @xmath114 obtained from the optimally - aligned derivatives . in ( b ) and",
    "( c ) , the difference is equivalent to the local cost function @xmath115 .",
    "notice the temporal increment @xmath116 in ( c ) and ( d ) as a result of the process .",
    "the absolute difference may also be increased in ( d ) outside the support regions , but this is irrelevant.,width=326 ]    we imposed some additional conditions on the selected warping path so as to restrict the alterations of aligned signals .",
    "a global restriction is set in the search process by defining a warping window @xmath117 ( named sakoe - chiba band @xcite ) to limit the temporal distance between aligned samples so @xmath118 .",
    "we set @xmath119 , which corresponds to a distance of 14ms with @xmath0hz , and is long enough to deal with small misalignments of beat marks .",
    "a local restriction is also used to limit the number of times the same sample can be aligned , setting a slope constraint : @xmath120 .",
    "we set @xmath121 to limit the variation in the amplitude of the aligned signals .",
    "both conditions together allows the ddtw to cancel out wave differences up to three times in amplitude and up to @xmath117 samples in width .",
    "finally , after the optimal warping path @xmath101 is found , the aligned signals @xmath112 and @xmath122 are obtained with coordinates @xmath123 and @xmath124 for @xmath125 $ ] , where @xmath126 and @xmath127 .",
    "[ fig_sim ] shows the result of the alignment of the current qrs complex and a template .      in order to assign a beat @xmath77 to an existent cluster @xmath79",
    ", we design a similarity calculation that only considers the difference between signals over the support region of each relevant point , thus limiting the comparison to the constituent waves of the qrs . given a pair @xmath128)\\!\\in\\!p_n$ ] ,",
    "we are interested in verifying whether @xmath129 contains a similar wave in the same location of the qrs . in order to do so ,",
    "the interval @xmath130 $ ] of @xmath108 aligned with the interval @xmath131 $ ] of @xmath45 must be obtained ( see fig .",
    "[ fig_dissimilarity ] ) . to this end",
    ", the warping path @xmath101 is used to map @xmath132 and @xmath133 $ ] from @xmath45 into @xmath112 obtaining the equivalent index @xmath134 for the relevant point , and @xmath135 $ ] for its support region where : @xmath136 , @xmath137 and @xmath138 , being @xmath139 . afterwards , since @xmath113 and @xmath112 are already aligned by the application of ddtw , the same interval @xmath135 $ ] from @xmath113 is selected and mapped into @xmath83 using the warping path .",
    "the interval @xmath130 $ ] is given by @xmath140 and @xmath141 .",
    "once the aligned intervals are obtained we proceed to evaluate the concordance of both vectors .",
    "the segment @xmath83 is said to * concord with @xmath142 at @xmath61 * and denoted by @xmath143 if @xmath83 contains a deflection in @xmath144 $ ] with height @xmath145 likely to be considered a significant waveform , where @xmath146 being @xmath147 } q_i^c$ ] , @xmath148 } q_i^c$ ] and @xmath149 } q_i^c$ ] for @xmath61 in a convex wave ( see fig . [ fig_dissimilarity]a ) .",
    "otherwise , @xmath150 and @xmath151 functions are interchanged .",
    "we define the * concordance ratio * of @xmath83with respect to @xmath142 at @xmath61 , denoted by @xmath152 , as : @xmath153 if @xmath143 .",
    "otherwise , @xmath154 .    .",
    "solid and dashed lines represent beat and template data , respectively .",
    "( a ) shows parameters involved in concordance checking ; the support region @xmath131 $ ] and the derived intervals @xmath155 $ ] and @xmath130 $ ] are drawn ; ( b ) signal segments within the interval @xmath156 $ ] with a vertical alignment performed in the subintervals @xmath157 $ ] and @xmath158 $ ] independently ; @xmath159 and @xmath160 areas are shaded ; ( c ) the same signal segments shown in ( b ) with @xmath161 and @xmath162 areas shaded . ]",
    "we define the * local dissimilarity * of @xmath83 with respect to @xmath142 at @xmath61 , and denoted by @xmath163 , as a weighted relative area difference between @xmath113 and @xmath112 at the interval @xmath155 $ ] : @xmath164    the terms @xmath159and @xmath160 represent the areas under @xmath165 over the intervals @xmath166 $ ] and @xmath167 $ ] , respectively ( see fig .",
    "[ fig_dissimilarity]b ) .",
    "computing the area at each side of @xmath168 independently allows us to minimize the effect of vertical misalignment or amplitude variation on each interval by subtracting their own median . using the trapezoidal rule : @xmath169 where @xmath170}\\!a_k$ ] and @xmath171}\\!a_k$ ] .",
    "the terms @xmath172 and @xmath173 represent the areas below @xmath174 $ ] and @xmath167 $ ] intervals of @xmath112 , respectively ( see fig . [",
    "fig_dissimilarity]c ) .",
    "they are estimated using the trapezoidal rule : @xmath175 where @xmath176}\\!q_k$ ] and @xmath177}\\!q_k$ ] for @xmath61 in a convex wave . otherwise , @xmath151 is replaced by @xmath150 .",
    "we define the * piecewise similarity * of @xmath83 with respect to @xmath142 , denoted @xmath178 , as the sum of two bounded contributions from the set of concordant and non - concordant relevant points : @xmath179 where the sigmoid function @xmath180 keeps the contribution of each point in the interval @xmath181 $ ] .",
    "the parameter @xmath182 determines the decrease rate of the contribution as the local dissimilarity increases and , as a consequence , the weight of a high dissimilarity value in the final piecewise dissimilarity .",
    "we limit the contributions of those points out of a range of admissible local dissimilarity . in order to set such range we consider the effect of amplitude and temporal variability of qrs waves .",
    "a temporal misalignment of one signal sample between the qrs waves of @xmath183 and @xmath184 can lead to local dissimilarities of around 20% .",
    "then we set an interval of @xmath185 $ ] with a slightly greater upper bound and @xmath186 so the maximum contribution out of this interval is @xmath187 .",
    "the previous measure is asymmetric since it depends on the relevant points and areas of one signal , so we define the * similarity * between @xmath77 and @xmath188 as : @xmath189 thus obtaining a value which captures the concordance , similarity and morphological complexity of both signal segments .",
    "this measure allows us to select the most similar template within a set , but we need a reference scale to evaluate the degree of matching . to this end",
    ", we define the * normalized piecewise similarity * as : @xmath190 and the * normalized similarity * as : @xmath191 where @xmath192 is the set of relevant points of @xmath193 .",
    "the occurrence of different qrs morphologies in a segment of ecg signal is usually limited by a reduced set of activation points and conduction pathways .",
    "thereby we expect that the majority of qrs complexes in an ecg recording share their morphology with some of the qrs complexes present in a short previous temporal interval .",
    "for that reason , the search for the cluster @xmath194 that best matches a beat @xmath77 is first performed in the set of clusters present in its temporal context @xmath195 ( see fig . [ fig_cluster_selection ] ) .",
    "we define the temporal context as the set of @xmath196 beats previous to @xmath77 , @xmath197 and @xmath198 .",
    "the context length is set to @xmath199 beats , the number of beats displayed in the typical 10s ecg strip used by cardiologists for a heart rate of 80 beats / min .",
    "this context is long enough to include every qrs morphology present in multifocal arrhythmias . throughout this section ,",
    "the @xmath22 superscript is used to denote the lead .",
    "the similarity measure is used to identify the most similar template for each lead as @xmath200 and then the best matching cluster is obtained by majority vote as @xmath201\\}$ ] .",
    "if multiple clusters are selected , a second vote is performed to obtain a single one using the normalized similarity .",
    "beat @xmath77 is assigned to @xmath202 if the condition @xmath203 is fulfilled in all leads .",
    "then @xmath204 .",
    "we set a value of @xmath205 which corresponds to the maximum contribution of a point with local dissimilarity outside the admissible interval .",
    "when @xmath77 and @xmath202 are not similar enough , a new comparison is performed within the subset @xmath206 , obtaining the most similar cluster @xmath207 .",
    "if @xmath77 and @xmath207 are similar enough , the beat is assigned and @xmath208 .",
    "otherwise , the beat is not assigned to any existing cluster and its most similar cluster @xmath209 is selected between @xmath202 and @xmath207 using the same voting criteria previously seen .          in order to adaptively respond to the changing behavior of the ecg",
    ", clusters must be dynamically created , modified or merged whenever a new beat is detected :      if @xmath77 is not assigned to @xmath209 , a new cluster @xmath210 is created and its template is initialized for each lead using the beat representation : @xmath211 . then the cluster set is updated as @xmath212 .",
    "if @xmath77 is assigned to @xmath209 , then the cluster is updated to @xmath213 and the template @xmath214 is modified to @xmath215 for each lead . to this end",
    ", @xmath216 is calculated from @xmath217 and @xmath218 : @xmath219 where @xmath220 .",
    "the term @xmath221 is the coefficient of the exponential update .",
    "setting a value for @xmath221 implies a trade - off between plasticity and stability of the cluster template .",
    "we set @xmath222 so the last 16 beats assigned to the cluster provide 90% of the contributions to the current template .",
    "this allows the template to be adapted to the evolution of the qrs morphology .",
    "afterwards , the set of relevant points and support regions @xmath223 is obtained from @xmath216 and assigned to the template : @xmath224 .      during the clustering process",
    ", different clusters can evolve to represent the same qrs morphology , so they should be merged .",
    "this situation is common when qrs complexes suffer from transient distortions in their morphology due to intrinsic variability , which makes them fall below the similarity threshold for their proper clusters . in this case ,",
    "a new cluster is created which is subjected to an initial transient period during which the template for each lead can evolve getting closer to its most similar cluster .    in order to detect this situation",
    ", we define a relation @xmath225 which links each cluster with its most similar one among previous clusters .",
    "the relation is set for each new cluster as @xmath226 .",
    "as templates evolve with new assigned qrs complexes , the relation could have to be updated .",
    "when @xmath77 is assigned to @xmath209 , the cluster is updated to @xmath227 and its most similar cluster may change .",
    "the @xmath225 relation is updated when multiple clusters in the same set than @xmath209 , be it either @xmath228 or @xmath229 , fulfill the assigment condition @xmath230 in all leads ( see subsection [ clusterselection ] ) . since @xmath14 has been updated , getting more similar to @xmath77 , the best matching cluster @xmath231 for @xmath77 is selected within the remaining subset of clusters , where @xmath232 and the oldest of both clusters , @xmath209 or @xmath231 , is set as the new most similar cluster for the other .",
    "then the clusters @xmath227 and @xmath233 are checked for possibly merging , since their templates have evolved to be similar enough to the last beat ( see fig .",
    "[ fig_cluster_selection ] ) .",
    "the condition for merging those clusters will be analogous to the condition for beat assignment : @xmath234 , where @xmath235 , which corresponds to the maximum contribution of a point with local dissimilarity over 20% .",
    "the threshold value is increased with respect to @xmath236 since both signal segments are promediated templates with increased signal - to - noise ratio .",
    "afterwards , the special case of clusters within its transient period is considered .",
    "we establish the duration of this transitory state in terms of the number of assigned beats . hence ,",
    "if @xmath77 is assigned to @xmath209 and @xmath237 , the cluster is checked for merging with its closest one @xmath238 ( see fig .",
    "[ fig_cluster_selection ] ) .",
    "we set @xmath73 as the minimum number of beats assigned to the cluster to confirm it represents an independent morphology and we consider @xmath239 enough for this purpose .    when two clusters @xmath240 and @xmath11 are merged , the cluster set , cluster template and @xmath225 relation are updated accordingly ( we suppose that @xmath241 ) :    1 .   @xmath242 is updated to @xmath243 .",
    "@xmath244 is calculated by merging @xmath245 and @xmath246 : @xmath247 where @xmath248 remains unmodified .",
    "the template is modified to @xmath249 , where @xmath250 is the set of relevant points and support regions obtained of @xmath244 .",
    "the @xmath225 relation is updated by removing the @xmath251 pair and replacing @xmath252 by @xmath253 in all the pairs where the former appears .",
    "after the cluster @xmath252 gets merged , all the modified pairs of the @xmath225 relation are checked for merging .",
    "afterwards , the @xmath11 cluster is also checked for merging with its closest one .",
    "the dynamic creation of clusters entails the problem of identifying those qrs complexes contaminated by noise that could cause the proliferation of clusters .",
    "when noise appears in an ecg lead , the qrs can show different changes . in some cases ,",
    "ecg segments with low signal - to - noise ratio present a high number of waves , and these can be detected by an abnormal number of dominant points . in other cases , domain knowledge is needed to discern if changes respond to a new qrs morphology or to a noisy version of a previous one . some alterations are well known and described in literature , but others can be challenging even for an expert cardiologist , who compares every beat with those present in its temporal context in order to identify if it is related to a repetitive morphology change , a noisy interval or an isolated noisy beat .",
    "we follow a twofold , beat - based and context - based , approach to detect noisy qrs complexes .",
    "noise can be present in one or more leads , and the influence of each lead in the clustering of a given beat will be analyzed in the following .",
    "a state variable @xmath254 is defined to denote the existence of a _ noisy interval _ in lead @xmath22 containing the @xmath10th beat .",
    "such noisy interval begins when the first noisy beat is detected in that lead just after a sequence of previous noise - free beats .",
    "the beats contained within this interval can be either noisy or noise - free in @xmath22 and such condition will be represented as an attribute of the beat denoted by @xmath255 . during the noisy interval ,",
    "the characterization of any new beat @xmath77 can represent not only qrs waves but also noise artifacts , so the cluster selection and assignment rules ( subsection [ clusterselection ] ) are modified in lead @xmath22 : the dominant points of the beat are ignored , replacing @xmath256 by @xmath257 and @xmath258 by @xmath259 .",
    "therefore , the condition for beat assignment is : @xmath260 .",
    "the ending of a noisy interval in lead @xmath22 is set just before @xmath261 contiguous beats are considered noise - free in that lead .",
    "a beat @xmath77 is considered _ noise - free _ if @xmath262 and it is assigned either to its winner cluster with @xmath263 or to a new cluster .",
    "the _ beat - based noise detection _ is triggered when a new beat @xmath77 is detected .",
    "then the number of waves in the qrs is estimated as @xmath264 for each lead @xmath22 . if @xmath265 , @xmath77 is considered noisy in lead @xmath22 and @xmath255 is set to @xmath266 .",
    "the term @xmath267 is the maximum number of waves that could be present in a noisefree qrs .",
    "we set @xmath268 to admit complexes with q , r and s waves , mixed with r , s or spikes as occurs in paced , fusion or bundle branch block beats .",
    "additionally , if @xmath269 , the qrs complex is considered distorted with relevant waves caused by noise . if this happens in some but not all leads , such leads are ignored for cluster assignment and updating , but if it happens in all leads , the beat is considered failed and it is assigned to its most similar cluster .    the _ context - based noise detection _",
    "is activated when a new cluster is created for @xmath77 .",
    "then two possible explanations are explored .",
    "a first explanation represents a hypothesis of noise , and every noisy beat will be assigned to its most similar cluster .",
    "a second explanation simply represents a change in morphology , so creation of new clusters is allowed .",
    "the evaluation of these hypothesis is performed over a temporal context of @xmath196 beats defined as @xmath270 which is long enough to check the evolution of cluster diversity .    a hypothesis of noise , denoted by @xmath271 ,",
    "is set over each lead for every beat @xmath272 .",
    "the hypothesis is initialized using the current noise state for the first beat , @xmath273 , and the value of the previous beat for each new one , @xmath274 .",
    "this value can be further modified for a beat @xmath275 under three circumstances :    * if @xmath275 is considered noisy in lead @xmath22 by the beat - based noise detection , @xmath276 , then the hypothesis is set to @xmath277 . *",
    "if a new cluster is created for @xmath275 , we define @xmath278 as the set of leads with @xmath279 , which are responsible for its creation and candidates to be set as noisy . for these leads",
    ", we check the assignment under noisy interval conditions , @xmath280 .",
    "if the assignment condition is now fulfilled in all leads , the signal still resemble a previous qrs morphology and we set @xmath281 . * if @xmath275 is the last of @xmath282th consecutive noise - free beat , we set @xmath283 $ ]",
    ".    once the @xmath196 beats have been processed , the detection of noisy leads is addressed .",
    "let @xmath284 denote the set of new clusters created in @xmath285 .",
    "if @xmath286 we consider that an abnormal cluster proliferation exists since the appearance of more than 5 new qrs morphologies within an interval of 15 beats is an extremely rare condition .",
    "hence any lead @xmath22 that is a common cause of creation , that is , @xmath287 , for all @xmath288 such that @xmath289 , is discarded as noisy , setting @xmath290 $ ] .",
    "finally , the hypothesis is reviewed for every beat @xmath272 which caused the creation of a new cluster so as to decide about its noisy condition .",
    "if @xmath291 @xmath292 then we set @xmath293 , the created cluster is deleted and its beats assigned to its closest cluster .",
    "afterwards , @xmath294 is updated for the whole @xmath285 using the @xmath295 data to set the begining and ending of noise intervals for each lead .",
    "the resulting @xmath296 is the new noise state used in the analysis of the subsequent beats .",
    "the absence of an analysis of the p wave leads to the inability to discriminate premature , normal or ectopic beats which share a common qrs morphology .",
    "all previous clustering proposals include rhythm information within their beat characterization and claim its separation capabilities for this kind of arrythmias . in order to make our results comparable , we include a rhythm processing stage that allows us to separate those beats into different groups .",
    "distance for record 117 of mit - bih database is shown .",
    "solid points and squares represent normal and premature beats respectively .",
    "the solid line represents @xmath298 and the dotted lines enclose the @xmath299 and @xmath300 intervals.,width=335 ]    the beat to beat interval ( @xmath297 ) between normal beats , commonly known as @xmath301 interval , is the result of a non - stationary stochastic process regulated by the sympathetic and parasympathetic nervous systems .",
    "this implies that the @xmath297 value for beat @xmath77 , denoted by @xmath302 , should be put in context using the rhythm of the surrounding beats to analyze its normality . to this end",
    ", we model the @xmath301 series as a stochastic process with marginal distribution @xmath303 at the @xmath10th beat .",
    "the mean is estimated as @xmath304 , with @xmath305 for @xmath306 values labeled as normal ( as explained in next section ) .",
    "otherwise , @xmath307 .",
    "the standard deviation is estimated as @xmath308 using the last @xmath196 beats with normal rhythm .",
    "[ fig_rr ] shows the evolution of the @xmath297 in an excerpt with a premature beat from the record 117 of the mit - bih database to illustrate this point .    the first complete context , @xmath309 , is used to initialize @xmath310 and @xmath311 .",
    "let @xmath312 denote the set of the first @xmath196 values of @xmath297 and let @xmath313 denote any subset of @xmath297 values from consecutive beats .",
    "a value @xmath314 is said to be normal if @xmath315 such that @xmath316 , where @xmath317 is the normalized standard deviation of the @xmath313 set .",
    "let @xmath318 . if @xmath319 , then @xmath320\\}$ ] , where @xmath321 and @xmath322 are the mean and standard deviation of @xmath323 .",
    "if @xmath319 then the context in @xmath312 is repeatedly moved forward one beat until @xmath324 for a context @xmath325 .",
    "finally we set @xmath326 and @xmath327 @xmath328 $ ] .",
    "the aim of rhythm processing is the discrimination of those abnormal @xmath297 values associated with arrhythmic beats from the normal ones . to this end",
    ", the rhythm of the @xmath77 beat is characterized through a vector @xmath329 where @xmath330 and @xmath331 are the @xmath297 values for the previous and next beat , respectively .",
    "then , the model described in the previous section is used to establish a range of validity for the @xmath302 value which allows us to detect any alteration in the normal rhythm .",
    "we use seven rhythm labels to discern between four beat rhythm types : normal , with ( @xmath7 ) or without ( @xmath332,@xmath333,@xmath334 ) compensatory pause , premature ( @xmath335 ) , group of prematures ( @xmath336 ) and delayed ( @xmath337 ) .",
    "the explicit domain knowledge contained in table [ classifierrules ] models , for each rhythm type , the relation of an @xmath297 value with the normal rhythm from its temporal context .",
    "it also reflects the dependence of the rhythm type for an @xmath297 value on the rhythm type of its adjacent beats .",
    "this model allows us to assign a rhythm label to the beat @xmath77 based on the @xmath338 values and the rhythm label of the previous beat .",
    ".rules for rhythm label selection .",
    "@xmath339 stands for @xmath340 .",
    "the superscripts refer the conditions listed below and used when multiple candidate labels exist .",
    "they impose a minimum distance between normal and premature or delayed beats .",
    "the precedence of label candidates is set by order of appearance . [ cols=\"<,^,^,^,^,^,^,^ \" , ]      the proposed method processes an ecg recording with a bounded time delay comprising the intrinsic latency and computation time for the different stages .",
    "only the baseline filtering and rhythm labeling stages present an intrinsic latency due to non - causality : @xmath341ms and one beat , respectively .",
    "since they both are executed concurrently , their contribution to the delay is given by the maximum of both .",
    "the computation time can be evaluated through the time complexity which is constant in all stages but two : qrs alignment and template matching . in both cases ,",
    "the time complexity is constant for the best case , corresponding to beats assigned to a cluster in the context ; this happens in 95.35% of the total number of beats in mit - bih database .",
    "the time complexity is linear ( @xmath342 ) for the worst case , which corresponds to beats assigned to a new or an out - of - context cluster , representing the remaining 4.65% of the total number of beats .",
    "given the high degree of parallelism in both stages and the computational cost of processing a single cluster , it can be guaranteed that a beat is clustered before the next one arrives even with a set of hundreds of clusters . in order to support this claim ,",
    "the mit - bih arrhythmia database was processed with a non - optimized , non - parallelized matlab implementation of the method using a single core of an intel q9550 cpu .",
    "the following computation times for a single beat were obtained : qrs characterization ( maximum , mean ) : 4ms , 3ms ; cluster set selection : 323ms , 16ms ; cluster set updating : 110ms , 5ms ; noise analysis : 9ms , @xmath3431ms ; and rhythm - based labelling : 10ms , 5ms .",
    "globally , the whole method summed a maximum of 358ms and mean of 32ms . additionally , reducing groups for validation required a maximum of 190ms .",
    "purity is usually used to measure the goodness of a clustering method . nevertheless , in a multiclass problem like this one , after characterizing the clusters , the values of sensitivity ( se )",
    ", positive predictivity ( + p ) , and false positive rate ( fpr ) should also be provided for each class , in order to obtain a multidimensional measure of the quality of the results from the perspective of each class involved .",
    "a global purity of 98.56% is obtained for mit - bih arrhythmia database ( 98.84% with aami class labels ) and a 99.56% for the aha ecg database .",
    "the other values are shown in the last row of tables [ mit - bih_confusion_matrix][aami_confusion_matrix ] .",
    "we propose a new clustering method to dynamically separate qrs morphologies as they appear in a multichannel ecg signal , representing them with a dynamic number of clusters .",
    "this objective has not been previously addressed in the literature and only some partial solutions can be found , all of them restricted to offline processing @xcite and some of them even limited to single channel signals and to a fixed subset of beat classes @xcite .",
    "the performance of the qrs clustering technique without using rhythm data shows a global purity of 97.15% and 99.43% for mit - bih and aha databases , respectively .",
    "this confirms the validity of our approach , since no method , as far as we know , neither offline nor online , achieve this performance without using @xmath297 derived information .",
    "as expected , the main source of error is the group of supraventricular classes a , n , j , j , and e , that can only be separated using p wave and rhythm information .",
    "this is the reason for the difference between both results since aha database does not contain this type of beats .",
    "the validation results after using rhythm labels show a high sensitivity and positive predictivity for almost all classes while the purity increases .",
    "we observe in accordance with @xcite , that the largest number of errors in table [ mit - bih_confusion_matrix ] are caused by beats with similar morphology .",
    "fusion ( f ) of ventricular ( v ) and normal ( n ) beats are included with n or v clusters and viceversa .",
    "the same occurs with n , paced ( / ) and fusion of n and / beats ( f )",
    ". finally , beats with supraventricular or nodal activation points ( a ,",
    "n , j , j , and e ) with similar qrs are wrongly clustered when the rhythm information does not result determinant for their discrimination .",
    "this kind of errors represent 66% of the total .",
    "besides the clustering performance , the analysis of the number of clusters ( n ) generated for each record shows that it remains reduced : 34 records ( 71% ) have 15 or less clusters ; 12 records ( 25% ) have between 16 and 30 clusters , both included and only two records ( 4% ) has more than 30 clusters .",
    "the high number of clusters for record 207 is caused by the presence of an episode of ventricular flutter with qrs complexes replaced by irregular waves .",
    "the clustering results would be improved if an specific detection method were used for these kind of arrhythmias with absent qrs complex .",
    "the @xmath344 column of table [ clusters_per_record ] shows a general increase in the number of groups in all records with a mean of 24 groups per record .",
    "this increment reflects the presence of different rhythm labels in the beats assigned to the clusters although they do not always belong to different beat classes .",
    "records with irregular rhythm like those with auricular fibrillation , or sudden rhythm change will render the @xmath297 information useless to discriminate premature or delayed beats . in such cases ,",
    "the @xmath297 does not provide information about the beat activation point and the discrimination can not be performed without an analysis of the p wave .",
    "since no other method for online clustering has been reported , we compare our clustering performance with existing offline proposals .",
    "only the work of lagerholm et al.@xcite provides comparable results since others @xcite are designed to deal with a concrete subset of beat types and perform the evaluation over a single channel ( usually the one with lower noise ) .",
    "compared to @xcite our method provides a slightly better purity ( 98.56% vs 98.49% ) .",
    "the sensitivity is improved in our work for 11 out of the 16 beat classes and slightly worsened for 3 .",
    "special mention should be made for classes a , a , r , j and e where the improvement is remarkable .",
    "let us remember that @xcite rely on a som with 25 clusters to represent the different beat classes .",
    "this approach has two main drawbacks , first the clusters get saturated with dominant morphologies present in the learning stage , while rare morphologies are ignored as well as new morphologies that appear afterwards .",
    "second , the generated clusters are redundant in those records with a low number of morphologies . in contrast , our method dynamically adapts the number of clusters to the number of morphologies detected .",
    "the results of our proposal confirms the relevance of the temporal context for beat clustering .",
    "it allows us to switch from an offline to an online analysis achieving the same or even better results , and to address the temporal evolution of a beat morphology that otherwise would be projected into multiple clusters .",
    "the results of the experiments on ecg standard databases also show the adequacy of the present method for real - time ecg monitoring .",
    "our proposal provides the cardiologists with the information about the morphological diversity within a desired time frame and its temporal evolution .",
    "this information allows them to promptly detect the different conduction patterns and evaluate its relevance .",
    "it also can be useful for arrhythmia detection and classification which can be later addressed either automatically by classification algorithms or manually by the cardiologists .",
    "in conclusion , we have presented an adaptive , multichannel context - based method for clustering beat morphologies in real - time that has been validated over the whole mit - bih arrhythmia and aha ecg databases with performance results that outperform its offline counterparts in the field .",
    "p.  dechazal , m.  odwyer , and r.  b. reilly , `` automatic classification of heartbeats using ecg morphology and heartbeat interval features , '' _ ieee trans .",
    "_ , vol .",
    "51 , no .  7 , pp . 11961206 , 2004 .",
    "g.  de  lannoy , d.  franois , j.  delbeke , and m.  verleysen , `` weighted conditional random fields for supervised interpatient heartbeat classification , '' _ ieee trans .",
    "_ , vol .",
    "59 , no .  1 ,",
    "pp . 241247 , 2012 .",
    "m.  lagerholm , c.  peterson , g.  braccini , l.  edenbrandt , and l.  sornmo , `` clustering ecg complexes using hermite functions and self - organizing maps , '' _ ieee trans . biomed .",
    "_ , vol .  47 , no .  7 , pp . 838848 , 2000 .",
    "d.  cuesta - frau , m.  o. biagetti , r.  a. quinteiro , p.  mic - tormos , and m.  aboy , `` unsupervised classification of ventricular extrasystoles using bounded clustering algorithms and morphology matching , '' _ med .",
    "_ , vol .",
    "45 , no .  3 , pp .",
    "229239 , 2007 .",
    "j.  l. rodrguez - sotelo , d.  cuesta - frau , and g.  castellanos - domnguez , `` unsupervised classification of atrial heartbeats using a prematurity index and wave morphology features , '' _ med .",
    "comput . _ , vol .",
    "47 , no .  7 ,",
    "pp . 731741 , 2009 .",
    "i.  christov , g.  gmez - herrero , v.  krasteva , i.  jekova , a.  gotchev , and k.  egiazarian , `` comparative study of morphological and time - frequency ecg descriptors for heartbeat classification , '' _ med .",
    "_ , vol .  28 , no .  9 , pp .",
    "876887 , 2006 .",
    "a.  l. goldberger , l.  a.  n. amaral , l.  glass , j.  m. hausdorff , p.  c. ivanov , r.  g. mark , j.  e. mietus , g.  b. moody , c .- k .",
    "peng , and h.  e. stanley , `` physiobank , physiotoolkit , and physionet : components of a new research resource for complex physiologic signals , '' _ circulation _ ,",
    "vol . 101 , no .  23 , pp .",
    "e215e220 , 2000 .",
    "p.  kligfield , l.  s. gettes , j.  j. bailey , r.  childers , b.  j. deal , e.  w. hancock , g.  van herpen , j.  a. kors , p.  macfarlane , d.  m. mirvis , o.  pahlm , p.  rautaharju , and g.  s. wagner , `` recommendations for the standardization and interpretation of the electrocardiogram : part i. '' _ circulation _ , vol .",
    "115 , no .",
    "10 , pp . 13061324 , 2007 .",
    "daniel castro received the b.sc and m.sc .",
    "degrees in physics from the university of santiago de compostela , santiago de compostela , spain , in 1998 and 1999 , respectively .",
    "he is currently a researcher and ph.d .",
    "candidate at the centro singular de investigacin en tecnoloxas da informacin ( citius ) , university of santiago de compostela .",
    "his research interests include signal processing and its application to biomedical signals .",
    "paulo flix received the b.sc and ph.d .",
    "degrees in physics from the university of santiago de compostela , santiago de compostela , spain , in 1993 and 1999 , respectively .",
    "he is currently a researcher at the centro singular de investigacin en tecnoloxas da informacin ( citius ) , university of santiago de compostela .",
    "his research interests include temporal reasoning , machine learning and signal processing .",
    "jess presedo received the b.sc and ph.d .",
    "degrees in physics from the university of santiago de compostela , santiago de compostela , spain , in 1989 and 1994 , respectively .",
    "he is currently a researcher at the centro singular de investigacin en tecnoloxas da informacin ( citius ) , university of santiago de compostela .",
    "his research interests are biomedical digital signal processing , heart rate variability , non - linear dynamics , soft computing and the development of ubiquitous healthcare systems ."
  ],
  "abstract_text": [
    "<S> continuous follow - up of heart condition through long - term electrocardiogram monitoring is an invaluable tool for diagnosing some cardiac arrhythmias . in such context </S>",
    "<S> , providing tools for fast locating alterations of normal conduction patterns is mandatory and still remains an open issue . </S>",
    "<S> this work presents a real - time method for adaptive clustering qrs complexes from multilead ecg signals that provides the set of qrs morphologies that appear during an ecg recording . </S>",
    "<S> the method processes the qrs complexes sequentially , grouping them into a dynamic set of clusters based on the information content of the temporal context . </S>",
    "<S> the clusters are represented by templates which evolve over time and adapt to the qrs morphology changes . </S>",
    "<S> rules to create , merge and remove clusters are defined along with techniques for noise detection in order to avoid their proliferation . to cope with beat misalignment , </S>",
    "<S> derivative dynamic time warping is used . </S>",
    "<S> the proposed method has been validated against the mit - bih arrhythmia database and the aha ecg database showing a global purity of 98.56% and 99.56% , respectively . </S>",
    "<S> results show that our proposal not only provides better results than previous offline solutions but also fulfills real - time requirements .    </S>",
    "<S> 0.85(0.07,0.01 ) this is the author s version of an article that has been published in this journal . </S>",
    "<S> changes were made to this version by the publisher prior to publication . </S>",
    "<S> the final version of record is available at http://dx.doi.org/10.1109/jbhi.2014.2361659    0.96(0.02,0.95 ) 2014 ieee . </S>",
    "<S> personal use of this material is permitted . </S>",
    "<S> permission from ieee must be obtained for all other uses , in any current or future media , including reprinting / republishing this material for advertising or promotional purposes , creating new collective works , for resale or redistribution to servers or lists , or reuse of any copyrighted component of this work in other works .    </S>",
    "<S> adaptive clustering , electrocardiogram ( ecg ) , dominant points , dynamic time warping , qrs clustering . </S>"
  ]
}