{
  "article_text": [
    "the use of angular momentum algebra is inevitable in many body calculations of atoms and nuclei .",
    "it is essential to couple the single particle states to form many particle states or to evaluate matrix elements of tensor operators . to couple two angular momentum states , clebsch - gordan coefficients are the weight factors in the linear combinations of the direct product states .",
    "it reflects the geometric aspect of the coupled many particle state .",
    "then , for three angular momenta , it is the wigner @xmath0 symbols @xcite which are closely related to the racah recoupling coefficients @xcite .",
    "higher @xmath1 symbols are required to couple larger number of angular momentum states @xcite . as mentioned earlier , these coefficients also occur while evaluating the matrix elements of tensor operators in the angular momentum basis . in atomic many body theory ,",
    "@xmath0 symbols occur frequently while evaluating the matrix elements of the two - electron coulomb interaction @xcite .",
    "the number of times @xmath0s symbols are calculated increases substantially in structure or properties calculations , where the the coulomb interaction is treated perturbatively to high orders or non - perturbatively to all orders .    in this paper",
    ", we address the @xmath0 symbol evaluation requirements of coupled - cluster calculations , a non  perturbative many body theory @xcite , of heavy atoms .",
    "the theory is applicable to both , atomic structure and properties calculations . in these calculations , depending on the number of orbitals in the basis",
    "set chosen , the number of @xmath0 symbol evaluations could be as large as @xmath2 .",
    "it is found that , the @xmath0 symbol evaluations of this magnitude take a large fraction , in many instances about 3040 % , of the total computational time .",
    "this has severe implications in coupled - cluster calculations , where the working equations are a set of non linear algebraic equations .",
    "the number of @xmath0 symbol evaluations increases manifold in perturbed coupled - cluster theory , where the perturbation is an operator of rank one or higher in the electron space .",
    "the theory is appropriate to calculate the effects of discrete symmetry violations in atoms @xcite and transition properties .",
    "the large number of @xmath0 symbol in the perturbed cluster equations , set of linear algebraic equations , is a serious issue for calculating the properties of heavy atoms .",
    "further , the evaluations are repetitive as iterative schemes suitable method to solve the equations .    one solution to avoid the repeated evaluations of the @xmath0 sybmols and reduce",
    "the time of calculation is , evaluate all the needed @xmath0 symbols and tabulate it . however , this is easier said than done .",
    "the possible number of @xmath0 symbols upto a maximum value of angular momentum @xmath3 grows rapidly as @xmath3 is increased .",
    "then the tabulation require large arrays , which is an undesirable feature in large scale computations .",
    "employing the symmetry properties , it is possible to reduce the number significantly .",
    "but the disadvantage of incorporating the symmetries is , large number of binary operations are essential to retrieve the tabulated values .",
    "an optimal scheme is to tabulate with selected symmetry properties .",
    "the other approach is to improve efficiency of the @xmath0 symbol calculations is to employ a fast evaluation scheme @xcite .",
    "this scheme would be faster than the calculations with factorials .",
    "but it involves several binary operations as it has a summation , so the tabulation is a better choice .",
    "the paper is organized as follows in section.[rec_coeff ] , the expression and properties of @xmath0 symbols are described in brief .",
    "then in section.[6j_cc ] the reason for larger number of @xmath0 symbols in perturbed coupled - cluster calculations is discussed with an example .",
    "we have chosen an example from electric dipole moment calculations .",
    "then the method of tabulation and retrieval we have developed are given in section.[stor_retr ] .",
    "this is followed by results and discussions , and conclusions .",
    "consider a many particle system consisting of three particles , each having individual angular momenta @xmath4 , @xmath5 and @xmath6 .",
    "then the total angular momentum @xmath7 of the system is the vector sum of @xmath4 , @xmath5 and @xmath6 .    in general",
    ", there are three distinct ways of coupling the three angular momenta",
    ". these are @xmath8 , @xmath9 and @xmath10 , where @xmath11 represents coupling of @xmath12 and @xmath13 , and @xmath14 is the total angular momentum . among these possibilities , states of two different coupling schemes",
    "are related through a unitary transformation @xmath15 the elements of the transformation are the recoupling coefficients @xmath16 .",
    "the symmetric representation of these coefficients is @xmath17 \\times \\nonumber \\\\       & & \\left\\{\\begin{array}{ccc }             j_1 & j_{12 } & j_2 \\\\",
    "j_3 & j_{23 } & j \\end{array}\\right\\},\\end{aligned}\\ ] ] where @xmath18 is the @xmath0 symbol .",
    "it is invariant with respect to any column permutation and rows interchange for a pair of columns , which explains why it is the symmetric representation of recoupling coefficients . counting the number of invariant transformations , column permutations and row interchange",
    ", one @xmath0 symbol has 24 equivalent representations .",
    "then , the angular momenta in a @xmath0 symbol satisfy the triangular conditions    @xmath19    [ 6j_ineq ]    the @xmath0s symbols are products of four clebsch - gordan coefficients or equivalently four @xmath20 symbols , the symmetric representation of clebsch - gordan coefficients .",
    "besides coupling of angular momenta , the @xmath0 symbols are part of the angular factors in the matrix elements of coupled tensor operators .",
    "symbol.,width=113 ]    atomic structure and properties calculations involve calculations of matrix elements of a tensor operator in the single particle basis , which comprises of the radial and angular parts .",
    "the evaluation of the angular part involves the expansion of the matrix elements using the wigner - eckart theorem and rearranging the angular momenta couplings and tensor coupling of the operators .",
    "it then simplifies to product of @xmath20 and @xmath0 symbols , phase factors and constant factors .",
    "this procedure is sometimes tedious especially when the matrix element has several angular momenta and operators .",
    "a simpler way is to use angular momentum diagrams . in atomic many - body theory ,",
    "these are the goldstone diagrams where operator and angular momenta representations replace the interaction and orbital lines respectively @xcite .",
    "the diagrams are then simplified and evaluated based on rules which separate close or open parts to diagrammatic representation of angular momenta coupling identities . in this scheme ,",
    "the diagrammatic representation of @xmath0 symbols is shown in fig .",
    "[ 6jfig ] the diagram has a high degree of symmetry , which are equivalent to the symmetry of the algebraic representation .",
    "it is non - zero only if the angular momenta meeting at each vertex satisfy the triangular conditions listed in the earlier section .",
    "the @xmath0 symbols are normally calculated using the racah formula @xmath21 where @xmath22 is a triangle coefficient @xmath23 and @xmath24 the summation is over all integer values of @xmath25 for which @xmath26 is defined .",
    "in other words , values of @xmath25 which make the arguments of factorials in @xmath26 non negative . often , theoretical atomic and nuclear physics calculations require several values of @xmath0 symbols , for which one can refer to one of the several published tabulations .",
    "usually , in these tables , as mentioned earlier each @xmath0 symbol has twenty four equivalent representations , only one of the representations is listed .",
    "@xmath27 a unique choice of selecting the one representation is to impose the inequalities @xmath28 , @xmath29 , @xmath30 , @xmath31 and @xmath32 .",
    "the relations are symbolically represented in eq.([unique_6j ] ) , where @xmath33 denotes @xmath34 .",
    "coupled - cluster theory @xcite is considered to be one of the most accurate many - body theory .",
    "this is evident from the fact that it is an all order theory and proved through extensive calculations in atom , molecules and nuclei .",
    "recently , we have developed a coupled - cluster based method to calculate electric dipole moments of closed - shell atoms @xcite .",
    "the theory has cluster amplitudes arising from two interaction hamiltonians .",
    "first , the residual coulomb interaction @xmath35 and second , the discrete symmetry violating interaction @xmath36 . as a result ,",
    "the angular parts of the cluster equations have large number of @xmath0 symbols . to demonstrate , consider the single excitation diagram with @xmath35 as interaction shown in fig.[ccedm - ex ] .",
    "the equivalent algebraic expression is @xmath37 where @xmath38 is a rank zero and one cluster operators for @xmath35 and @xmath36 respectively , @xmath39 and @xmath40 are the occupied orbitals , and @xmath41 and @xmath42 , are the virtual orbitals .    ,",
    "the residual coulomb interaction .",
    "the solid and zigzag lines represent cluster operators arising from @xmath35 and @xmath36 respectively . in diagram ( a ) the cluster operator zero rank .",
    "whereas in ( b ) has rank one.,width=226 ]    the angular factor of the diagram ( a ) in the the figure is @xmath43 where @xmath44 are the allowed multipoles of the @xmath35 interaction and @xmath12 are the angular momenta of the orbitals .",
    "this angular factor , consisting of phase factor , a constant and kronecker delta is computationally not demanding .",
    "however , for the diagram ( b ) , where the cluster operator is rank one , the angular factor is @xmath45 from the expression of @xmath0 symbol , given in eq.([6jformula ] ) , it s evaluation has far larger number of arithmetic operations than calculation of eq.([cct0_ang ] ) .",
    "the present comparison is for one of the simpler diagrams .",
    "the occurrence of @xmath0 symbol is larger in diagrams of doubles and more complicated .",
    "calculating a larger number of @xmath0 symbols to solve the perturbed cluster amplitude equations is a serious performance issue .",
    "it is particularly severe for properties calculations of heavy atoms , the number of cluster amplitudes is in millions .",
    "another factor adding to the inefficiency is the repeated occurrence of the same @xmath0 symbol in several diagrams , the multiple evaluations is expensive .",
    "a trivial solution is tabulating the @xmath0 symbols , however this is not simple to implement .",
    "the optimal basis sets chosen for accurate structure and properties calculations of heavy atoms have single particle wave functions of high angular momenta . for example , for structure and properties calculations of atomic ytterbium , in @xmath46",
    "coupled scheme . the optimal basis set consist of orbitals upto @xmath47 symmetry , which has angular momenta @xmath48 and @xmath49",
    "this is an important consideration to describe the electron - electron correlation energies accurately .",
    "an immediate outcome is the large values of the angular momenta in the angular part of the matrix elements .",
    "then , the number of possible @xmath0 symbols which can occur is extremely large . for a basis set consisting of orbitals upto @xmath47 symmetry ,",
    "the maximum angular momenta which can occur in @xmath0 is @xmath50 .",
    "that is the maximum rank of the operator which satisfies triangular condition for matrix elements between two @xmath47 orbitals .",
    "the approximate total number of @xmath0s is then @xmath51 , which is a large number .",
    "one option to reduce the number of entries in the tabulations is to impose the inequalities , diagrammatically shown in fig.[unique_6j ] , to the angular momenta of the @xmath0 symbol .",
    "such a scheme reduces the number by a factor of 24 , the number of equivalent forms .",
    "another option is to apply the four triangular conditions in eq.([6j_ineq ] ) .",
    "however , as discussed in the results sections , the exact implementation of these conditions is computationally inefficient .",
    "an optimal selection of the inequalities from eq.[unique_6j ] are : @xmath52 , @xmath53 , @xmath54 and @xmath55 .",
    "these reduces the number of equivalent forms reasonably .",
    "tabulation of the @xmath0 symbol during computational calculations imply tagging each one with a unique integer and a scheme to evaluate the tag efficiently .",
    "the other considerations are , the tags be in a sequence and preserve the inequality conditions . a straight forward scheme is to take advantage of the three inequalities @xmath52 , @xmath53 and @xmath55 .",
    "tagging each @xmath56 pair is equivalent to indexing the elements of the lower triangular matrix and the integer tag is @xmath57 .",
    "the multiplication of @xmath4 and @xmath58 by two is essential as the angular momenta are in multiples of half .",
    "similarly , the @xmath59 are tagged .",
    "further , extending the scheme , the pairs @xmath56 and @xmath59 is mapped to a single integer number , which is like a super tag of @xmath60 combinations . for each tag ,",
    "the possible @xmath61 are considered .",
    "structurally , this can visualized as a stack of matrices @xmath61 , one for each @xmath60 .",
    "pairs for a specific @xmath62 combination is like a stack , each slot in one of the stacks represents one unique @xmath63 combination or @xmath0 .",
    ", width=264 ]    an important point is , unlike @xmath56 and @xmath59 pairings , tagging @xmath61 pairs is equivalent to indexing a full matrix .",
    "this follows from the absence of inequality between @xmath6 and @xmath64 . from the inequalities adopted for tagging ,",
    "the maximum number of @xmath61 pairs is @xmath65 .",
    "when the @xmath0 are stored in a one dimensional array , to retrieve one @xmath0 , skip the locations of previous @xmath66 combinations and then from @xmath61 evaluate the offset within the stack .",
    "a rough estimate of the efficiency of the tabulation and retrieval , compared to the actual calculation is to compare the number of binary operations in the two schemes .",
    "this include arithmetic and boolean binary operations . the number of binary operations to calculate @xmath0 symbol from is estimated from eq .",
    "[ 6jformula ] .",
    "the number of binary operations required to calculate each @xmath22 is thirteen . in total , to evaluate the product of the four @xmath22 require fifty six binary operations arithmetic operations .",
    "then the , for one @xmath25 , the number calculation of @xmath26 require twenty four binary operations . considering the summation over @xmath25 ,",
    "the total number of binary operations is @xmath67 , where @xmath68 is the number of values @xmath25 can have .",
    "this is without the binary operations to calculate the factorials , the assumption is these are precalculated . in comparison , for the scheme outlined to store and retrieve @xmath0 symbols ,",
    "the number of binary operations required to retrieve the @xmath0 symbols from memory is @xmath69 50 .",
    "this involves the arrangement of the six @xmath70 symbols to satisfy the inequality conditions adopted and calculation of the tag .",
    "approximately , the tabulation and retrieval of @xmath0 symbol is like calculating without the evaluation of @xmath26 .",
    "this indicates a significant gain in performance .",
    "to quantify the relative computational efficiency , between calculating the @xmath0 symbols from racah formula eq.([6jformula ] ) and retrieving from a tabulated list , we compare the execution time of the two schemes for calculating a set of @xmath0 symbols .",
    "the set chosen consists of @xmath0 symbols with all possible combinations of angular momenta upto a maximum angular momentum @xmath3 .",
    "the number of the @xmath0 symbols with and without the imposition of the symmetry conditions are shown in fig.[6j_num ] .",
    "symbol with a maximum angular momentum @xmath3 .",
    "black , maroon and tan are the number of @xmath0 symbols when no inequality , selected inequality and all inequalities are imposed to the angular momenta.,width=340 ]    the plots in the fig.[perf_notria ] shows the plots of computation time for the values of @xmath3 ranging from @xmath71 to @xmath72 . the inset plots in fig.[perf_notria ]",
    "is the ratio of the computation time to calculate the @xmath0 symbols from racah formula and retrieve from the tabulated list .",
    "the ratio has a maximum of @xmath733.4 around @xmath74 and is 2.5 for the largest @xmath75 case .",
    "there is a significant performance gain .",
    "for the largest @xmath3 , which is relevant for the coupled cluster calculations of heavy atoms , there is performance gain of @xmath73220% gain after compiler optimizations",
    ".     symbols with all the possible combinations upto the maximum angular momenta @xmath3 .",
    "the pair of curves at the bottom , connecting the @xmath76 and @xmath77 correspond to retrieval from the tabulated list .",
    "the pair at the top , @xmath78 and @xmath79 correspond to numerical calculation from the racah expression .",
    "the red and blue curves are with and without optimizations .",
    "the inset curves shows the ratio of the two .",
    ", width=340 ]    performance of the tabulation is enhanced further when an approximate form of the triangular conditions of the @xmath0 symbols in eq.([6j_ineq ] ) are imposed .",
    "the approximate form is to ensure that the sum of the three angular momenta , which should satisfy triangular condition , is integer .",
    "for example , consider the first inequality @xmath80 . instead of imposing the inequality , we check if the sum @xmath81 is integer .",
    "the retrieval scheme proceeds if it is integer , otherwise it returns a zero value .",
    "this improves the efficiency of the retrieval scheme by avoiding the steps to transform the arguments .     symbols with all the possible combinations upto the maximum angular momenta @xmath3 and imposing the triangular conditions approximately . the lower pair of curves connecting the @xmath76 and @xmath77 correspond to retrieval from the tabulated list . the upper pair , @xmath78 and @xmath79 correspond to numerical calculation from the racah expression .",
    "the red and blue curves are with and without optimizations .",
    "the inset curves shows the ratio of the two .",
    ", width=340 ]    a comparison of the run time of calculating @xmath0 symbols and retireving from the tabulated values is shown in fig.[perf ] .",
    "there is a marked improvement , retrieving from the table is more than 350% faster than the calculation .",
    "this is evident from the inset plot in fig.[perf ] . in coupled - cluster calculations of heavy atoms ,",
    "the number of times @xmath0 symbol is evaluated is extremely large .",
    "for example , consider the cluster amplitude calculations of hg with all the core orbitals and one virtual orbitals from each symmetry . at the linear level",
    "this calculation require @xmath82 evaluations of @xmath0 symbol .",
    "the number is higher for full scale coupled - cluster calculations and much higher in perturbed coupled - cluster calculations @xmath83 . in the later case ,",
    "perturbed coupled - cluster , implementing the tabulation scheme provides a @xmath84% performance improvement . in other words ,",
    "calculation of @xmath0 symbols takes @xmath84% of the total run time of coupled - cluster calculation , with tabulation this is reduced to less than 1% .",
    "tabulating the @xmath0 symbols coefficients improves the efficiency of the coupled - cluster computations significantly .",
    "the reduction of binary operations in the tabulation scheme , as explained earlier , accounts for the improvement .",
    "the optimal scheme of tabulation and retrieval is to impose a restricted set of symmetry properties and approximate triangular condition .",
    "strict implementation of the symmetry properties and triangular conditions compromises the efficiency of the tabulation scheme . in terms of evaluating the coefficients",
    ", the tabulation scheme is more than 350% faster than the actual evaluation .",
    "this translates to reducing more than 30% run time of coupled - cluster calculations .",
    "the work was supported by the dst - nsf project no .",
    "dst / int / us - nsf / rpo-154/04 .",
    "one of the author , da would like to thank the dmitry budker from university of califorrnia , berkeley for the hospitality and stimulating discussions during his recent visit .    1 e. p. wigner , in _ quantum theory of angular momentum _ ed . l. c. biedenharn and h. van dam , academic press , new york ( 1965 ) .",
    "g. racah , phys .",
    "* 62 * , 438 ( 1942 ) .",
    "d. a. varshalovich et al ,",
    "_ quantum theory of angular momentum : irreducible tensors , spherical harmonics , vector coupling coefficients , 3nj symbols _ , world scientific , singapore ( 1988 ) i. lindgren and j. morrison , _ atomic many - body theory _ , springer verlag , berlin ( 1982 ) .",
    "r.  j.  bartlett and m.  musial , rev .",
    "* 79 * , 291 ( 2007 ) .",
    "b. k. sahoo , r. chaudhuri , b. p. das , and d. mukherjee , phys .",
    "96 , 163003 ( 2006 ) ; b. k. sahoo , arxiv : physics/0611035 . k.  v.  latha , d.  angom , b.  p.  das , r.  k.  chaudhuri and b.  p.  das , j. phys .",
    "b * 41 * , 035005 ( 2008 ) .",
    "l. wei , comp .",
    ". comm . * 120 * , 222 ( 1999 ) .",
    "l. wei and a. dalgarno , j. phys .",
    "a * 37 * , 3259 ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> we have developed an efficient tabulation scheme to evaluate @xmath0 symbols for atomic calculations . </S>",
    "<S> the scheme is appropriate for coupled - cluster based calculations . in particular , for perturbed coupled - clusters calculations , which has another perturbation in addition to the residual coulomb interaction . </S>",
    "<S> the scheme relies on the symmetry of the @xmath0 symbol and the triangular conditions . </S>"
  ]
}