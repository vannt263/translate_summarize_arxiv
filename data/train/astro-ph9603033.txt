{
  "article_text": [
    "the field of cosmic microwave background ( cmb ) anisotropies has seen a rapid development since its first detection by the cobe satellite only a few years ago .",
    "there are now several reported experimental results that are detecting anisotropies on degree angular scales ( see @xcite and @xcite for a recent review ) , which together with a few upper limits on smaller angular scales already give interesting limits on cosmological models . with the development of the new generation of experiments",
    "now being proposed one hopes to accurately map the cmb sky from arcminute scales to several degree scales .",
    "the amount of data thus provided would allow for an unprecedented accuracy in the determination of cosmological parameters .",
    "as theoretical modelling shows ( @xcite ) , cmb anisotropies are sensitive to most of the cosmological parameters and have a distinctive advantage over other cosmological observations in that they probe the universe in the linear regime .",
    "this avoids the complications caused by physical processes in the nonlinear regime and allows to use powerful statistical techniques to search over the parameter space for the best cosmological model ( see e.g. @xcite ) .",
    "a large stumbling block in this program at present is the speed of theoretical model calculations , which are still too slow to allow for a rapid search over the parameter space .",
    "this limitation was partially removed by the development of appoximation methods ( @xcite , b ; @xcite ) , which can give fast predictions of cmb anisotropy with a 10% accuracy",
    ". however , these approximations are not accurate enough to exploit the complete amount of information that will be present in the future cmb observations .",
    "this is especially true for some of the more extreme cosmological models , where simple approximations break down and lead to systematic inaccuracies in the results .",
    "obviously , it would be useful to have a fast method that would not be based on any approximations and would lead to accurate results for any cosmological model .",
    "the purpose of this paper is to present a new method of cmb calculation that satisfies these requirements .",
    "theoretical calculations of the cmb anisotropies are based on linear theory of cosmological perturbations , developed first by lifshitz ( 1946 ) and applied to the cmb anisotropies by peebles and yu ( 1970 ) . in this early calculation only photons and baryons were included , but later workers extended the calculations to include dark matter ( bond & efstathiou 1984 , 1987 ; vittorio & silk 1984 ) , curvature ( wilson & silk 1981 ; sugiyama & gouda 1992 ; white & scott 1995 ) , gravity waves or tensor modes ( crittenden et al . 1993 ) and massive neutrinos ( bond & szalay 1983 ; ma & bertschinger 1995 ; dodelson , gates & stebbins 1995 ) .",
    "most of these and more recent calculations ( e.g. holtzmann 1989 ; stompor 1994 ; sugiyama 1995 ) solve for each fourier mode of temperature anisotropy @xmath0 by expanding it in legendre series up to some desired @xmath1 and then numerically evolve this system of equations in time from the radiation dominated epoch until today .",
    "typically this means evolving a system of several thousand coupled differential equations in time , a slow process even for the present day computers .",
    "in addition , because each multipole moment is a rapidly oscillating function one has to densely sample it in values of @xmath2 with typical number of evaluations of the order of @xmath1 .",
    "even the fastest codes at present require several hours of cpu time for each theoretical model ( sugiyama 1995 ) , while some numerically more accurate ones ( e.g. @xcite ) require more like tens or hundreds of hours .    in this paper",
    "we explore a different approach to compute cmb anisotropies based on integration of the sources over the photon past light cone .",
    "the method is a generalization of approximate method developed by one of the authors ( seljak 1994 ) .",
    "it differs from it in that it is exact , in the sense that it can achieve arbitrary precision within the limits of linear perturbation theory . by rewriting the system of equations in the integral form one can separate between the geometrical and dynamical contributions to the anisotropies .",
    "the former do not depend on the model and need to be computed only once , while the latter contain all the information on the particular model and can be computed with a small system of equations . solving for cmb anisotropies using this integral form",
    "greatly reduces the required computational time .",
    "the outline of the paper is as follows : in  2 we present the basic system of equations that needs to be solved both in the standard and in the integral method . in ",
    "3 we present in some detail a practical implementation of the integral method , highlighting the computational differences between it and the standard boltzmann method .",
    "we conclude in  4 by discussing possible applications where the new method can be particularly useful .",
    "in this section we first present the standard system of equations that needs to be solved for temperature anisotropies , which is based on solving boltzmann equation using legendre expansion of photon distribution function .",
    "this part follows closely the existing literature ( e.g. ma & bertschinger 1995 , bond 1996 and references therein ) and only the final results are given .",
    "we do not discuss the technical details of the standard boltzmann method , except where our approach differs significantly from it . in the second part of the section we present the integral solution of photon distribution , which is the basis of our method . in this paper",
    "we restrict the analysis to a spatially flat universe .",
    "the temperature anisotropy at position @xmath3 in the direction @xmath4 is denoted with @xmath5 . in principle",
    "it depends both on the direction and on the frequency , but because spectral distortions are only introduced at the second order the frequency dependence can in the lowest order be integrated out .",
    "anisotropy @xmath6 can be expanded in terms of fourier modes @xmath7 , which in linear perturbation theory evolve independently of one another .",
    "assuming perturbations are axially - symmetric around @xmath8 , we may further legendre expand the anisotropy in the angle @xmath9 , @xmath10 where @xmath11 is the legendre polynomial of order @xmath12 and @xmath13 is the associated multipole moment .",
    "a similar decomposition also applies to the amplitude of polarization anisotropy @xmath14 ( @xcite , critenden et al .",
    "1993 , kosowsky 1995 , zaldarriaga & harari 1995 ) .",
    "evolution of the temperature anisotropy is governed by the boltzmann equation ( @xcite , @xcite , @xcite ) .",
    "its collisionless part is given by the time component of the geodesic equation , which depends on the metric .",
    "here we will use the metric in the longitudinal gauge ( @xcite ; bertschinger 1996 ) , which is similar to the gauge - invariant formalism ( kodama & sasaki 1984 ) and gives expressions that are most similar to their newtonian counterparts .",
    "the choice of gauge is purely a matter of convenience and in some cases ( e.g isocurvature models ) other gauge choices such as synchronous gauge are computationally advantageous over the longitudinal gauge ( see e.g. @xcite , @xcite ) . in the longitudinal gauge",
    "the perturbations are specified with two scalar potentials @xmath15 and @xmath16 and a gauge - invariant tensor perturbation @xmath17 ( we will ignore vector perturbations in this paper , as they most likely have a negligible contribution to cmb anisotropy ) .",
    "the corresponding temperature and polarization anisotropies are denoted as @xmath18 , @xmath19 for scalar and @xmath20 , @xmath21 for tensor components . in linear perturbation theory",
    "the scalar and tensor perturbations evolve independently and the total power is given by the sum of the two contributions .",
    "the collisional part of the photon boltzmann equation is determined by the thomson scattering term .",
    "after angular and momentum integration the boltzmann evolution equations for scalar perturbations can be written as ( @xcite ) , @xmath22 \\pi\\ } \\nonumber \\\\",
    "\\pi&=&\\delta_{t2}^{(s ) } + \\delta_{p2}^{(s)}+ \\delta_{p0}^{(s)}. \\label{boltzmann}\\end{aligned}\\ ] ] here the derivatives are taken with respect to the conformal time @xmath23 and @xmath24 is the velocity of baryons .",
    "differential optical depth for thomson scattering is denoted as @xmath25 , where @xmath26 is the expansion factor normalized to unity today , @xmath27 is the electron density , @xmath28 is the ionization fraction and @xmath29 is the thomson cross section . the total optical depth at time @xmath23 is obtained by integrating @xmath30 , @xmath31 . a useful variable is the visibility function @xmath32 .",
    "its peak defines the epoch of recombination , when the dominant contribution to the cmb anisotropies arises .",
    "expanding the temperature anisotropy in multipole moments one finds the following hierarchy of coupled differential equations ( @xcite , @xcite , @xcite ) , @xmath33 + \\dot{\\kappa } ( { v_b \\over 3}-\\delta_{t1}^{(s)})\\,,\\nonumber\\\\ \\dot{\\delta}_{t2}^{(s ) } & = & { k \\over 5}\\left[2\\delta_{t1}^{(s)}-3 \\delta_{t3}^{(s)}\\right ] + \\dot{\\kappa } \\left[{\\pi \\over 10}-\\delta_{t2}^{(s)}\\right]\\ , , \\nonumber\\\\ \\dot{\\delta}_{tl}^{(s)}&=&{k \\over 2l+1}\\left[l\\delta_{t(l-1)}^{(s)}-(l+1 ) \\delta_{t(l+1)}^{(s)}\\right ] -\\dot{\\kappa}\\delta_{tl}^{(s ) } \\ , , l>2 \\nonumber \\\\",
    "\\dot{\\delta}_{pl}^{(s)}&=&{k \\over 2l+1}\\left[l\\delta_{p(l-1)}^{(s)}-(l+1 ) \\delta_{p(l+1)}^{(s)}\\right ] + \\dot{\\kappa}\\left[-\\delta_{pl}^{(s)}+{1 \\over 2}\\pi\\left ( \\delta_{l0}+{\\delta_{l2 } \\over 5}\\right)\\right ] , \\label{photon}\\end{aligned}\\ ] ] where @xmath34 is the kronecker symbol . a similar system of equations without the thomson scattering terms and polarization also applies for massless neutrinos . for the massive neutrinos the system of equations is more complicated , because the momentum dependence can not be integrated out of the expressions ( see e.g. @xcite ) .",
    "baryons and cold dark matter can be approximated as fluids and their evolution can be obtained from the local conservation of energy - momentum tensor .",
    "this gives the equations for cold dark matter density @xmath35 and its velocity @xmath36 , @xmath37 for baryons one has additional terms in the euler s equation caused by thomson scattering and pressure , @xmath38 here @xmath39 is the baryon sound speed and @xmath40 , @xmath41 are the mean photon and baryon densities , respectively .",
    "finally , the evolution of scalar metric perturbations is given by einstein equations , which couple the sources and the metric perturbations .",
    "only two equations are needed to specify the evolution . here",
    "we choose them to be the energy and momentum constraint equations , @xmath42 where @xmath43 and @xmath44 are the total density and momentum density perturbations , respectively .",
    "they are obtained by summing over the contributions from all species , @xmath45 , @xmath46 , @xmath47 and @xmath48 , where @xmath49 and @xmath50 are the mean density and pressure of the @xmath51-th species .    for tensor perturbations",
    "the boltzmann equation is given by ( crittenden et al .",
    "1993 ) , @xmath52 the only external source is that of the tensor metric perturbation which evolves according to the einstein equations as @xmath53 we ignored the source term on the right - hand side of equation above ( caused by neutrino and photon anisotropic stress ) , as it is always negligible compared to the terms on the left - hand side .    to obtain the temperature anisotropy for a given mode",
    "@xmath8 one has to start at early time in the radiation dominated epoch with initial conditions of the appropriate type ( e.g. isentropic or isocurvature ) and evolve the system of equations until the present .",
    "the anisotropy spectrum is then obtained by integrating over the initial power spectrum of the metric perturbation @xmath54 , @xmath55 analogous expression holds for the polarization spectrum and for the tensor spectrum ( where the initial power spectrum @xmath54 has to be replaced by the initial tensor power spectrum @xmath56 ) .",
    "the spectrum @xmath57 is related to the angular correlation function , @xmath58 to test a model on a given angular scale @xmath59 one has to solve for @xmath13 up to @xmath60 .",
    "if one is interested in small angular scales this leads to a large system of differential equations to be evolved in time and the computational time becomes long . for a typical spectrum with",
    "@xmath61 one has to evolve a system of 3000 differential equations ( for photon and neutrino anisotropy and photon polarization ) until the present epoch .",
    "moreover , the solutions are rapidly oscillating functions of time , so the integration has to proceed in small time increments to achieve the required accuracy on the final values .",
    "instead of solving the coupled system of differential equations ( [ photon ] ) one may formally integrate equations [ boltzmann ] along the photon past light cone to obtain ( e.g. zaldarriaga & harari 1995 ) , @xmath62+\\dot\\phi - ik\\mu\\psi\\ } \\nonumber \\\\",
    "\\delta_p^{(s ) } & = & -{1\\over 2}\\int_0^{\\tau_0 } d\\tau e^{i k \\mu ( \\tau -\\tau_0 ) } e^{-\\kappa } \\dot\\kappa    [ 1-p_2(\\mu ) ] \\pi . \\label{formal}\\end{aligned}\\ ] ] expressions above can be further modified by eliminating the angle @xmath63 in the integrand through the integration by parts .",
    "the boundary terms can be dropped , because they vanish as @xmath64 and are unobservable for @xmath65 ( i.e. only the monopole term is affected ) . this way each time a given term is multiplied by a @xmath63",
    ", it is replaced by its time derivative .",
    "this manipulation leads to the following expression , @xmath66 some of the terms in the source function @xmath67 are easily recognizable .",
    "the first two contributions in the first term are the intrinsic anisotropy and gravitational potential contributions from the last - scattering surface , while the third contribution is part of the velocity term , the other part being the @xmath68 term in the second row .",
    "these terms make a dominant contribution to the anisotropy in the standard recombination models .",
    "the first term in the second row , @xmath69 , is the so - called integrated sachs - wolfe term and is important after recombination .",
    "it is especially important if matter - radiation equality occurs close to the recombination or in @xmath70 models . in both cases gravitational",
    "potential decays with time , which leads to an enhancement of anisotropies on large angular scales .",
    "finally we have the terms caused by photon polarization and anisotropic thomson scattering , which contribute to @xmath71 .",
    "these terms affect the anisotropy spectra at the 10% level and are important for accurate model predictions .",
    "moreover , they are the sources for photon polarization .",
    "equation ( [ source ] ) is a generalization of the tight - coupling and instantaneous recombination approximation ( seljak 1994 ) and reduces to it in the limit where the visibility function is a delta - function and @xmath71 can be neglected . in that approximation one only needs to evaluate the sources at recombination and then free stream them to obtain the anisotropy today . in the more general case presented here",
    "one has to perform an additional integration over time , which includes the contributions arising during and after the recombination .",
    "moreover , because the tight - coupling approximation is breaking down at the time of recombination , both polarization and photon anisotropic stress are being generated and @xmath71 makes a non - negligible contribution to the anisotropy . for exact calculations one has to use ( [ source ] ) , which properly includes all the terms that are relevant in the linear perturbation theory .",
    "to solve for the angular power spectrum one has to expand the plane wave @xmath72 in terms of the radial and angular eigenfunctions ( spherical bessel functions and legendre polynomials , respectively ) , perform the ensemble average and integrate over the angular variable @xmath63 .",
    "this leads ( [ cl ] ) , where the multipole moment at present time @xmath73 is given by the following expression , @xmath74d\\tau , \\label{finalscalar}\\ ] ] where @xmath75 is the spherical bessel function .",
    "note that while angular eigenfunctions integrated out after angular averaging , radial eigenfunctions remained and enter in ( [ finalscalar ] ) .",
    "the main advantage of ( [ finalscalar ] ) is that it decomposes the anisotropy into a source term @xmath76 , which does not depend on the multipole moment @xmath12 and a geometrical term @xmath77 , which does not depend on the particular cosmological model .",
    "the latter thus only needs to be computed once and can be stored for subsequent calculations .",
    "the source term is the same for all multipole moments and only depends on a small number of contributors in ( [ source ] ) ( gravitational potentials , baryon velocity and photon moments up to @xmath78 ) . by specifying the source term as a function of time one can compute the corresponding spectrum of anisotropies .",
    "equation ( [ finalscalar ] ) is formally an integral system of equations , because @xmath79 moments appear on both sides of equations . to solve for these moments it is best to use the equations in their differential form ( [ photon ] ) , instead of the integral form above .",
    "once the moments that enter into the source function are computed one can solve for the higher moments by performing the integration in ( [ finalscalar ] ) ( see section 3 for more details ) .",
    "the solution for the tensor modes can similarly be written as an integral over the source term and the tensor spherical eigenfunctions @xmath80 .",
    "the latter are related to the spherical bessel functions ( @xcite ) , @xmath81 this gives @xmath82 where from equation [ tensorl ] follows @xmath83 equations ( [ source]-[sourcet ] ) are the main equations of this paper and form the basis of the line of sight integration method of computing cmb anisotropies . in the next section",
    "we will discuss in more detail the computational advantages of this formulation of boltzmann equation and its implementation .",
    "in the previous section we presented the expressions needed for the implementation of the line of sight integration method . as shown in ( [ finalscalar ] ) and ( [ finaltensor ] ) one needs to integrate over time the source term at time @xmath23 multiplied with the sperical bessel function evaluated at @xmath84 .",
    "the latter does not depend on the model and can be precomputed in advance .",
    "fast algorithms exist which can compute spherical bessel functions on a grid in @xmath2 and @xmath12 in short amount of time ( e.g. press et al . 1993 ) .",
    "the grid is then stored on a disk and used for all the subsequent calculations .",
    "this leaves us with the task of accurately calculating the source term , which determines the cmb spectrum for a given model .",
    "below we discuss some of the calculational techniques needed for the implementation of the method .",
    "we especially highlight the differences between this approach and the standard boltzmann integration approach .",
    "our goal is to develop a method which is accurate to 1% in @xmath57 up to @xmath85 over the whole range of cosmological parameters of interest .",
    "these include models with varying amount of dark matter , baryonic matter , hubble constant , vacuum energy , neutrino mass , shape of initial spectrum of perturbations , reionization and tensor modes .",
    "the choice of accuracy is based on estimates of observational accuracies that will be achiavable in the next generation of experiments and also on the theoretical limitations of model predictions ( e.g. cosmic variance , second order effects etc . ) .",
    "most of the figures where we discuss the choice of parameters are calculated for the standard cdm model .",
    "this model is a reasonable choice in the sense that it is a model which exhibits most of the physical effects in realistic models , including acoustic oscillations , early - time integrated sachs - wolfe effect and silk damping .",
    "one has to be careful however not to tune the parameters based on a single model .",
    "we compared our results with results from other groups ( bode & bertschinger 1995 ; sugiyama 1995 ) for a number of different models .",
    "we find a better than 1% agreement with these calculations over most of the parameter space of models .",
    "the computational parameters we recommend below are based on this more detailed comparison and are typically more stringent than what one would find based on the comparison with the standard cdm model only .      in the standard boltzmann method",
    "the photon distribution function is expanded to a high @xmath86 ( [ photon ] ) and typically one has to solve a coupled system of several thousand differential equations . in the integral method one",
    "evaluates the source terms @xmath87 as a function of time ( [ source ] ) , ( [ sourcet ] ) and one only requires the knowledge of photon multipole moments up to @xmath78 , plus the metric perturbations and baryon velocity .",
    "this greatly reduces the number of coupled differential equations that are needed to be solved . for an accurate evaluation of the lowest multipoles in the integral method one has to extend the hierarchy somewhat beyond @xmath78 , because the lower multipole moments are coupled to the higher multipoles ( [ photon ] ) .",
    "because power is only being transferred from lower to higher @xmath12 it suffices to keep a few moments to achieve a high numerical accuracy of @xmath88 moments .",
    "one has to be careful however to avoid unwanted reflections of the power being transferred from low @xmath12 to high @xmath12 , which occur for example if a simple cut - off in the hierarchy is imposed .",
    "this can be achieved by modifying the boundary condition for the last term in the hierarchy using the free streaming approximation ( @xcite , @xcite ) . in the absence of scattering ( the so - called free streaming regime ) , the recurrence relation among the photon multipoles in equation ( [ photon ] ) becomes the generator of spherical bessel functions .",
    "one can therefore use a different recurrence relation among the spherical bessel functions to approximate the last term in the hierarchy without reference to the higher terms . the same approximation can also be used for polarization and neutrino hierarchies .",
    "this type of closure scheme works extremely well and only a few multipoles beyond @xmath78 are needed for an accurate calculation of the source term .",
    "this is shown in figure [ fig1 ] , where a relative error in the spectrum is plotted for several choices of maximal number of photon multipoles .",
    "we choose to end the photon hierarchy ( both anisotropy and polarization ) at @xmath89 and massless neutrino at @xmath90 , which results in an error lower than @xmath91 compared to the exact case .",
    "instead of a few thousand coupled differential equations we therefore evolve about 35 equations and the integration time is correspondingly reduced .",
    "[ fig1 ]      in the standard boltzmann integration method one solves for the whole photon hierarchy ( [ photon ] ) and the resultant @xmath92 is automaticaly obtained for each @xmath12 up to some @xmath86 .",
    "the cmb spectra are however very smooth ( see figure [ fig1 ] ) , except for the lowest @xmath12 , where the discrete nature of the spectrum becomes important .",
    "this means that the spectrum need not be sampled for each @xmath12 and instead it suffices to sparsely sample the spectrum in a number of points and interpolate between them .",
    "figure [ fig2 ] shows the result of such interpolation with cubic splines ( see e.g. @xcite ) when every 20th , 50th or 70th @xmath12 is sampled beyond @xmath93 with an increasingly denser sampling towards small @xmath12 , so that each @xmath12 is sampled below @xmath94 . while sampling of every 70th @xmath12 results in maximal error of 1% , sampling in every 20th or 50th @xmath12 gives errors below 0.2 and 0.4% , respectively .",
    "we choose to compute every 50th @xmath57 beyond @xmath93 in addition to 15 @xmath12 modes below @xmath93 , so that a total of 45 @xmath12 modes are calculated up to @xmath95 .",
    "this gives a typical ( rms ) error of 0.1% , with excursions of up to 0.4% .",
    "the number of integrals in equation ( [ cl ] ) is thus reduced by 10 - 50 and the computational time needed for the integrals becomes comparable or smaller than the time needed to solve for the system of differential equations .",
    "[ fig2 ]      after recombination and in the absence of a time changing gravitational potential the source function often becomes negligible .",
    "this is the so called free streaming regime , where the photons are freely propagating through the universe .",
    "most of the standard boltzmann codes use a special free streaming algorithm to map the anisotropies from a given epoch @xmath96 into anisotropies today ( @xcite ) . in the line of sight integration method",
    "the free streaming regime is only a special case where @xmath97 after some time @xmath96 .",
    "thus one can stop the integration at the time @xmath96 beyond which the sources are not important and there is no need for a separate algorithm to evolve the anisotropies until today .",
    "for example , if one assumes that only the first term in ( [ source ] ) is important one only needs to integrate over the source where the visibility function @xmath98 appreciably differs from 0 . in the absence of reionization",
    "this restricts the time integration to a narrow interval during recombination around @xmath99 .",
    "although most of the contributions to the anisotropies come from this epoch , time dependent gravitational potential ( and , to a smaller extent , other source terms in equation ( [ source ] ) ) make a nonnegligible contribution to the anisotropies even after recombination . as mentioned earlier , this is especially important in @xmath70 models and in models with low @xmath100 . in the first case",
    "the gravitational potential is decaying at late times , while in the second class of models the matter - radiation equality during which gravitational potential changes in time is pushed to a lower redshift .",
    "even in standard cdm model ( @xmath101 ) gravitational potential is still significantly changing in time at moderately low redshifts of @xmath102 ( @xcite ) . similarly one can not use free streaming in the models with late reionization , where the visibility function is nonvanishing at low redshifts .",
    "we choose to integrate until the present time for most of the models , except for the models with @xmath103 , where we stop the integration at @xmath104 . in this case the computational time is reduced significantly ( typically 50% ) compared to that of evolving the equations until the present time .      for each fourier mode",
    "@xmath2 the source term is integrated over time @xmath23 ( [ finalscalar ] ) .",
    "the sampling in time need not be uniform , because the dominant contribution arises from the epoch of recombination around @xmath105 , the width of which is determined by the visibility function @xmath98 and is rather narrow in look - back time for standard recombination scenarios . during this epoch",
    "the sources acoustically oscillate on a time scale of @xmath106 , so that the longest wavelength modes are the slowest to vary . for short wavelengths",
    "the rate of sampling should therefore be higher .",
    "even for long wavelengths the source function should still be sampled in several points across the last - scattering surface .",
    "this is because the terms in ( [ source ] ) depend on the derivatives of the visibility function .",
    "if the visibility function @xmath98 is narrow then its derivative will also be narrow and will sharply change sign at the peak of @xmath98 .",
    "its integration will lead to numerical roundoff errors if not properly sampled , even though positive and negative contributions nearly cancel out when integrated over time and make only a small contribution to the integral .",
    "figure [ fig3 ] shows the error in integration caused by sampling this epoch with 10 , 20 or 40 points .",
    "based on comparison with several models we choose to sample the recombination epoch with 40 points , which results in very small ( @xmath107 0.1% ) errors .",
    "after this epoch the main contribution to the anisotropies arises from the integrated sachs - wolfe term .",
    "this is typically a slowly changing function and it is sufficient to sample the entire range in time until the present in 40 points .",
    "the exceptions here are models with reionization , where the visibility function becomes non - negligible again and a new last - scattering surface is created . in this case a more accurate sampling of the source is also needed at lower redshifts .    [ fig3 ]      the main computational cost of standard cmb calculations is solving the coupled system of differential equations .",
    "the number of @xmath2-modes for which the system is solved is the main factor that determines the speed of the method . for results accurate to @xmath86 one",
    "has to sample the wavenumbers upto a maximun value @xmath108 . in the line of sight integration method solving the coupled system of differential equations",
    "still dominates the computational time ( although for each mode the time is significantly shorter than in the standard boltzmann method because of a smaller system of equations ) .",
    "it is therefore instructive to compare the number of @xmath2 evaluations needed in each of the methods to achieve a given accuracy in the final spectrum .    in the standard boltzmann method one",
    "solves for @xmath109 directly , so this quantity must be sampled densely enough for accurate integration .",
    "figure [ fig4]a shows @xmath109 for @xmath110 in a standard cdm model .",
    "one can see that it is a rapidly oscillating function with a frequency @xmath111 .",
    "each oscillation needs to be sampled in at least a few points to assure an accurate integration . to obtain a smooth cmb spectrum",
    "one typically requires 6 points over one period , implying @xmath112 @xmath2-mode evaluations .",
    "this number can be reduced somewhat by filtering out the sampling noise in the spectrum ( @xcite ) , but even in this case one requires at least 1 - 2 points per each period or @xmath113 @xmath2-mode evaluations .    to understand the nature of these rapid oscillations in @xmath109 we will consider wavelenghts larger than the width of the last scattering surface . in this case the bessel function in ( [ finalscalar ] )",
    "can be pulled out of the integral as @xmath114 because the time at which recombination occurs , when the dominant contribution to @xmath109 is created , is much smaller than @xmath115 and @xmath116 ( @xmath117 is the interval of time for which the visibility function differs appreciably from zero ) .",
    "so the final @xmath109 is approximately the product of @xmath114 and @xmath118 integrated over time , if the finite width of the last scattering surface and contributions after recombination can be ignored .",
    "figure [ fig4]b shows the source term @xmath118 integrated over time and the bessel function @xmath114 .",
    "it shows that the high frequency oscillations in @xmath109 seen in figure [ fig4]a are caused by the oscillation of the spherical bessel functions , while the oscillations of the source term have a much longer period in @xmath2 .",
    "the different periods of the two oscillations can be understood using the tight coupling approximation ( @xcite , @xcite ) .",
    "prior and during recombination photons are coupled to the baryons and the two oscillate together with a typical acoustic timescale @xmath119 .",
    "the frequency of acoustic oscillations @xmath120 is therefore 50 times higher than the frequency of oscillations in spherical bessel functions , which oscillate as @xmath121 .",
    "[ fig4 ]    [ fig5 ]    because an accurate sampling of the source term requires only a few points over each acoustic oscillation , the total number of @xmath2 evaluations in the integral method can be significantly reduced compared to the standard methods .",
    "typically a few dozen evaluations are needed over the entire range of @xmath2 , compared to about 500 evaluations in the standard method when a noise filtering technique is used and 2000 otherwise ( for @xmath61 ) .",
    "once the source term is evaluated at these points one can interpolate it at points with preevaluated spherical bessel functions , which can be much more densely sampled at no additional computational cost .",
    "the end result is the same accuracy as in the standard method , provided that the source is sampled in sufficient number of points .",
    "figure [ fig5 ] shows the relative error in the cmb spectrum for the cases where the source term is calculated in 40 , 60 and 80 points between 0 and @xmath122 ( for @xmath123 ) .",
    "while using 40 points results in up to 1% errors , using 60 points decreases the maximum error to below 0.2% for this model .",
    "in general it suffices to use @xmath124 @xmath2 modes , which is at least an order of magnitude smaller than in the standard methods . note that with this method there is no need to filter the spectrum to reduce the sampling noise , because the latter is mainly caused by insufficient sampling of the spherical bessel functions , which are easy to precompute .",
    "the additional operations needed for a higher sampling ( summation and source interpolation ) do not significantly affect the overall computational time .",
    "moreover , if each @xmath57 is accurately calculated they can be sparsely sampled and interpolated ( section 3.2 ) , this would not be possible if they had a significant noise component added to them .",
    "in this paper we presented a new method for accurate calculations of cmb anisotropy and polarization spectra .",
    "the method is not based on any approximations and is an alternative to the standard boltzmann calculations , which are based on solving large numbers of differential equations .",
    "the approach proposed here uses a hybrid integro - differential approach in solving the same system of equations . by rewriting the boltzmann equations in the integral form the solution for the photon anisotropy spectrum",
    "can be written as an integral over a source and a geometrical term .",
    "the first is determined by a small number of contributors to the photon equations of motion and the second is given by the radial eigenfunctions , which do not depend on the particular cosmological model , but only on the geometry of space .",
    "one advantage of the split between geometrical and dynamical terms is that it clarifies their different contributions to the final spectrum .",
    "a good example of this is the temperature anisotropy in the non - flat universe , which can be be written using a similar decomposition , except that spherical bessel functions have to be replaced with their appropriate generalization ( @xcite ) .",
    "this will be discussed in more detail in a future publication , here we simply remark that replacing radial eigenfunctions in a non - flat space with their flat space counterpart ( keeping comoving angular distance to the lss unchanged ) is only approximate and does not become exact even in the large @xmath12 ( small angle ) limit .",
    "the geometry of the universe leaves its signature in the cmb spectra in a rather nontrivial way and does not lead only to a simple rescaling of the spectrum by @xmath125 ( @xcite ) .",
    "the main advantage of our line of sight integration method is its speed and accuracy . for a given set of parameters it is two orders of magnitude faster than the standard boltzmann methods , while preserving the same accuracy .",
    "we compared our results with the results by sugiyama ( 1995 ) and by bode & bertschinger ( 1995 ) and in both cases the agreement was better than 1% up to a very high @xmath12 for all of the models we compared to .",
    "the method is useful for fast and accurate normalizations of density power spectra from cmb measurements , which for a given model require the cmb anisotropy spectrum and matter transfer function , both of which are provided by the output of the method .",
    "speed and accuracy are even more important for accurate determination of cosmological parameters from cmb measurements . in such applications",
    "one wants to perform a search over a large parameter space , which typically requires calculating the spectra of a several thousand models ( e.g. @xcite ) .",
    "one feasible way to do so is to use approximation methods mentioned in the introduction .",
    "these can be made extremely fast , but at a cost of sacrificing the accuracy . while several percent accuracy is sufficient for analyzing the present day experiments , it will not satisfy the requirements for the future all - sky surveys of microwave sky .",
    "provided that foreground contributions can be succesfully filtered out ( see tegmark & efstathiou 1995 for a recent discussion ) one can hope for accuracies on the spectrum close to the cosmic variance limit , which for a broad band averages can indeed reach below 1% at @xmath126 .",
    "it is at this stage that fast and accurate cmb calculations such as the one presented in this paper will become crucial and might enable one to determine many cosmological parameters with an unprecedented accuracy .",
    "abbott , l. f. , & schaefer , r. k. 1986 , , 308 , 546 albrecht , a. , coulson , d. , ferreira , p. , & magueijo , j. 1995 , submitted to bardeen , j. m. 1980 , phys .",
    "d , 22 , 1882 bertschinger , e. 1996 , in `` cosmology and large scale structure '' , ed .",
    "r schaffer et . al .",
    "( elsevier science , netherlands ) bode , p. , & bertschinger , e. 1995 , proc .",
    "1995 acm / ieee supercomputing conference ( http://www.supercom.org/sc95/proceedings/ ) bond , j. r. et al .",
    "1994 , , 72 , 13 bond , j. r. 1996 , in `` cosmology and large scale structure '' , ed .",
    "r. schaeffer et .",
    "al . , ( elsevier science , netherlands ) bond , j. r. , & efstathiou , g. 1984 , , 285 , l45 bond , j. r. , & efstathiou , g. 1987 , mnras , 226 , 655 bond , j. r. , & szalay , a. 1983 , , 276 , 443 crittenden r. , bond , j. r. , davis , r. l. , efstathiou , g. , & steinhardt , p. j. 1993 , , 69 , 1856 dodelson , s. , gates , e. , & stebbins , a. 1995 , preprint astro - ph/9509147 jungman , g. , kamionkowski , m. , kosowsky , a. , & spergel , d. n. 1995 , preprint astro - ph/9507080 kodama , h. , & sasaki , m. 1984 , prog .",
    "78 , 1 kosowsky , a. 1995 , 1996 ann .",
    ": 49 - 85 holtzman , j. a. 1989 , apjs , 71 , 1 hu , w. , scott , d. , sugiayma , n. , & white , m. 1995 , phys.rev.d 52 , 5498 hu , w. , & sugiayma , n. 1995a , , 436 , 456 hu , w. , & sugiayma , n. 1995b , , 51 , 2599 hu , w. , sugiyama , n. , & silk , j. 1995 , nature in press ( astro - ph/9504057 ) .",
    "lifshitz , e. m. 1946 , j. phys .",
    "ussr , 10 , 16 ma , c .- p .",
    ", & bertschinger , e. 1995 , , 455 , 7 peebles , p. j. e. , & yu , j. t. 1970 , , 162 , 815 press , w. h. , teukolsky , s. a. , vetterling , w. t. , & flannery , b. p. 1992",
    ", numerical recipes in fortran , 2nd ed .",
    "( new york : cambridge university press ) scott , d. , silk , j. , & white , m. 1995 , science , 268 , 829 seljak , u. 1994 , , 435 , l87 stompor , r. 1994 , a&a , 287 , 693 sugiyama , n. 1995 , suppl .",
    ", 100 , 281 sugiyama , n. , & gouda , n. 1992 , prog .",
    ", 88 , 803 tegmark , m. , & efstathiou , g. 1995 , preprint astro - ph 9507009 vittorio , n. , & silk , j. 1984 , , 285 , l39 white , m. , & scott , d. 1995 , preprint astro - ph/9508157 wilson , m. l. , & silk , j. 1981 , , 243 , 14 zaldarriaga , m. , & harari , d. 1995 , phys .",
    "d , 52 , 3276"
  ],
  "abstract_text": [
    "<S> we present a new method for calculating linear cosmic microwave background ( cmb ) anisotropy spectra based on integration over sources along the photon past light cone . in this approach </S>",
    "<S> the temperature anisotropy is written as a time integral over the product of a geometrical term and a source term . </S>",
    "<S> the geometrical term is given by radial eigenfunctions which do not depend on the particular cosmological model . </S>",
    "<S> the source term can be expressed in terms of photon , baryon and metric perturbations , all of which can be calculated using a small number of differential equations . </S>",
    "<S> this split clearly separates between the dynamical and geometrical effects on the cmb anisotropies . </S>",
    "<S> more importantly , it allows to significantly reduce the computational time compared to standard methods . </S>",
    "<S> this is achieved because the source term , which depends on the model and is generally the most time consuming part of calculation , is a slowly varying function of wavelength and needs to be evaluated only in a small number of points . </S>",
    "<S> the geometrical term , which oscillates much more rapidly than the source term , does not depend on the particular model and can be precomputed in advance . </S>",
    "<S> standard methods that do not separate the two terms and require a much higher number of evaluations . </S>",
    "<S> the new method leads to about two orders of magnitude reduction in cpu time when compared to standard methods and typically requires a few minutes on a workstation for a single model . </S>",
    "<S> the method should be especially useful for accurate determinations of cosmological parameters from cmb anisotropy and polarization measurements that will become possible with the next generation of experiments . </S>",
    "<S> a programm implementing this method can be obtained from the authors .    </S>",
    "<S> # 1 </S>"
  ]
}