{
  "article_text": [
    "disease mapping involves the analysis of disease incidence or mortality data for a specified geographical region that has been subdivided into small areas .",
    "these data are typically area level counts , and are usually combined with data on area level covariates that could be considered as risk factors when assessing how the associated relative risks vary from area to area .    ecological regression is the analysis of the association between risk factors and disease incidence for these areas , while disease mapping is the estimation of their disease risk , based on ecological regression models .",
    "the area level counts used for this purpose typically exhibit overdispersion , and an empirical bayes approach ( referred to as eb below ) that uses a poisson - gamma model for relative risks was proposed by clayton and kaldor @xcite .",
    "subsequently , a hierarchical bayes generalization of this approach that allows for a spatial structure was developed by besag _",
    "@xcite ( hereafter bym ) .",
    "ecological disease mapping typically relies on regression models that use covariates to explain risk variation between areas and random effects to allow for this overdispersion .",
    "these models depend on distributional assumptions and require a formal specification of the random part of the model .",
    "furthermore , applications involving spatially heterogeneous data require predictors that are more flexible than the usual linear predictor ( see , for example , space varying coefficients models : @xcite and @xcite ) , while standard ecological regression models do not easily allow for outlier - robust inference , e.g. when outliers are due to the presence of area level covariates with measurement error ( e.g. @xcite , @xcite , @xcite and @xcite ) .    ecological regression for disease mapping can be regarded as a special case of small area estimation ( * ? ? ?",
    "* chapter 9 ) .",
    "in particular , the eb predictor of relative risk for an area belongs to the family of small area estimators defined by generalized linear mixed models .",
    "this family includes a wide variety of different models , ranging from models for binary and count data to models for a continuous response , e.g. linear mixed models with gaussian residuals . in the latter case ,",
    "eb and empirical best linear unbiased predictor ( eblup ) estimators coincide ( * ? ? ?",
    "* chapter 9 ) . for the case of a continuous response ,",
    "chambers and tzavidis @xcite proposed an approach to small area estimation based on linear regression m - quantiles .",
    "this approach involves weaker parametric assumptions than the linear mixed model , and is robust to outliers in the response because of its use of m - estimation .    in this paper , we define regression m - quantiles for count data that can be characterised as negative binomial , focussing on applications to ecological regression for disease mapping .",
    "this is referred to as the nbmq approach below .",
    "furthermore , since the data that are used in such applications typically exhibit spatial clustering , we extend the method to allow for the presence of this clustering , referring to it as nbmqsp below . as with other applications of m - quantile modelling for grouped data ,",
    "the nbmq approach does not use random effects to characterise groups , which in this case correspond to areas . instead",
    ", between area variation in the response is characterised by variation in area - specific values of quantile - like coefficients . furthermore , since this approach is based on an outlier - robust approach to fitting generalised linear models , it leads to outlier - robust inference when area level covariates are measured with error .",
    "we compare the nbmq approach with the eb and bym approaches using a simulation experiment based on the well known scottish lip cancer data .",
    "the results suggest that the new approach generates estimates of disease prevalence with smaller root mean square error than those generated using these standard mixed model based approaches to disease mapping .",
    "we also illustrate application of nbmq for disease mapping by comparing it with eb and bym when mapping low birth weight incidence rates for english local authorities .    the paper is organized as follows . in section [ over ] , the negative binomial model for overdispersed count data and",
    "disease mapping is reviewed . in section",
    "[ rob ] , the robust negative binomial model , which extends the class of models introduced by cantoni and ronchetti @xcite , is described . in section [ mq ] , the nbmq model for overdispersed count data",
    "is introduced and applied to disease mapping .",
    "this section also contains a description of the nbmqsp approach , which extends the disease - mapping application of nbmq to data that exhibit spatial clustering , and a description of a semiparametric bootstrap method for estimating the mse of both nbmq predictors .",
    "results from a simulation study that compares nbmq , eb and bym with respect to their bias and root mean squared error are discussed in section [ sim ] . in section [ exe ] , the method is illustrated through an example : low birth weight incidence data for @xmath6 local authority districts of england , during the period 2005 - 2010 .",
    "finally , in section [ con ] we draw some conclusions about the usefulness of the nbmq approach , and identify areas for further research .",
    "the poisson distribution is useful for modelling the mean behaviour of count data but can underestimate variability when these data are overdispersed .",
    "there are essentially three ways for dealing with this situation .",
    "one is to use the poisson maximum likelihood estimating function for the mean , but to then base inference on the heterogeneity robust sandwich covariance matrix estimator .",
    "the second is to use a quasi - poisson model ( see @xcite ) .",
    "the third is to model the overdispersed count data directly using a negative binomial model , i.e. as a gamma mixture of poisson distributions .",
    "we focus on this third approach in this paper .",
    "let @xmath7 with @xmath8 .",
    "the distribution generated by this compound process is called the negative binomial ( nb ) and has density    @xmath9 where @xmath10 can be characterized as the number of failures before @xmath11 successes , with success probability @xmath12 . the mean and variance of this distribution is @xmath13=\\theta / \\alpha$ ] and @xmath14=\\theta / \\alpha+\\theta/\\alpha^2 $ ] .",
    "we reparameterize , setting @xmath15 , to obtain @xmath16 where now @xmath17=\\mu$ ] and @xmath14=\\mu+\\frac{\\mu^2}{\\theta}$ ] . since the overdispersion ( relative to the poisson model ) in this distribution is a quadratic function of the mean , it is referred to as the negbin2 or nb2 model in @xcite .",
    "the value @xmath18 is directly related to the amount of overdispersion in the data : smaller values of @xmath11 suggest increasing amounts of overdispersion .    in the context of ecological regression",
    ", @xmath19 is a count and @xmath20 is a @xmath21 vector of explanatory variables ( which is assumed to include the constant term ) .",
    "the regression of @xmath22 on @xmath23 is modelled as @xmath24 , where @xmath25 is a vector of @xmath26 regression parameters .",
    "given @xmath27 observations this regression model can be written as @xmath28 . since the nb distribution is a member of the exponential family for fixed @xmath11 ,",
    "this model is a special case of the generalized linear model ( glm ) , with the @xmath29 link function . in line with standard practice ( @xcite , @xcite , @xcite )",
    ", glm methodology can be used to estimate @xmath25 , by replacing @xmath11 with a suitable estimate @xmath30 ( obtained using the method of moments , for example ) and by iterating estimation of @xmath25 given @xmath30 .",
    "log - linear ecological regression models for count data are the basic building blocks for estimating relative risk of disease ( including mortality ) from incidence data . in many applications",
    "these data are available at an aggregated geographic level , e.g. corresponding to a defined area on a map . in the next section we review these ` standard ' disease mapping methods , with the aim of using them as benchmarks for the nbmq and nbmqsp methods that we introduce later .",
    "consider a region partitioned into @xmath27 distinct areas , and let @xmath31 denote a count associated with area @xmath32 , e.g. the number of recorded cases of a disease or the number of deaths .",
    "each @xmath31 is assumed to be an independent realization of a random variable @xmath33 , where @xmath34 .",
    "here @xmath35 is a baseline expected count in area @xmath36 and @xmath37 is the relative risk .",
    "the mle for @xmath37 is @xmath38 .",
    "however , since such data are characteristically overdispersed , james - stein type estimators are preferred ( see @xcite ) .",
    "following clayton and kaldor @xcite the @xmath37 are assumed to be independently and identically distributed as gamma@xmath39 .",
    "the resulting compound model is a nb model with mean @xmath40 and variance @xmath41 .",
    "conditionally on the values of the other model parameters and the data , each @xmath37 then has a posterior gamma distribution with mean @xmath42=(y_i+\\theta)/(t_i+\\alpha)$ ] .",
    "the empirical bayes ( eb ) estimator of @xmath37 is the corresponding plug - in estimator of this parameter , defined by replacing @xmath43 and @xmath11 in this posterior mean by suitable estimates ( e.g. their mles ) . clearly , we can extend this to an ecological regression model by making @xmath37 , and hence @xmath44 , a function of a set of covariates .",
    "the eb method has been extended to a hierarchical bayes ( hb ) approach by besag _",
    "their standard model is of the form @xmath45 where @xmath46 represents an intercept , such as an overall risk level ; @xmath47 is a set of regression coefficients ; @xmath48 is a spatially correlated random effect ( the _ clustering _ effect ) , and @xmath49 is a spatially uncorrelated random effect ( the _ heterogeneity _ effect ) .",
    "prior distributions for the model parameters are typically specified as follows : the intercept @xmath46 is assumed to have a uniform prior distribution ; the coefficients @xmath50 are assumed to have a normal prior distribution with zero mean and small precision ; the heterogeneity effects @xmath49 are assumed to be independently distributed as normal with mean @xmath51 and variance @xmath52 ; and the clustering effects @xmath48 are assumed to be realisations of a gaussian markov random field ( gmrf ) , which is modelled by conditioning on the values of spatially neighbouring clustering effects in the sense that @xmath53 is assumed to follow a normal @xmath54 distribution , where @xmath55 .",
    "here @xmath56 denotes areas that are adjacent to area @xmath36",
    "( i.e. areas that share a boundary with area @xmath36 ) and @xmath57 is the number of areas that are adjacent to area @xmath36 . the parameters @xmath58 and @xmath59 are typically assumed to have gamma priors , see @xcite for further details .",
    "the marginal posterior distributions of the parameters of interest are then approximated by monte carlo markov chain methods .",
    "we refer to the hb estimates based on fitting this model by bymsp in what follows .",
    "note that ( [ hbstandard ] ) can also be fitted without a spatial clustering effect ( i.e. just with the heterogeneity effect @xmath49 ) .",
    "we use bym to refer to hb estimates based on such a fit in what follows .",
    "cantoni and ronchetti @xcite propose an approach to robust inference for generalized linear models based on quasi - likelihood .",
    "in particular , they consider a general class of m - estimators of mallows s type , where the influence of deviations on @xmath60 and on @xmath61 are bounded separately .",
    "their robust version of the estimating equations for the parameter @xmath25 of the glm is of the form @xmath62 where @xmath63 , @xmath64=\\mu_i$ ] , @xmath65=v(\\mu_i)$ ] , @xmath66 , @xmath67 is its derivative and @xmath68w(\\bx_i)\\mu_i^{\\prime}$ ] ensures the fisher consistency of the estimator .",
    "the function @xmath69 is a bounded function of model residuals that controls the influence of errors in @xmath60-space , whereas the weights @xmath70 are used to downweight leverage points .",
    "when @xmath71 cantoni and ronchetti @xcite call the estimator defined by the solution to ( [ creq ] ) the huber quasi - likelihood estimator , using it to obtain robust estimates for parameters of binomial and poisson models in the case where @xmath69 is defined by pearson residuals and the huber influence function .",
    "note that the solution to ( [ creq ] ) can be obtained numerically by a fisher scoring procedure .",
    "we extend this approach to robust fitting of the mean parameterized nb model , via the estimating equations @xmath72 where @xmath73 , @xmath74 are the pearson residuals , @xmath75 is the huber proposal 2 influence function , @xmath76 , @xmath77 is the tuning constant , @xmath78 , @xmath35 is the offset term , @xmath79 , @xmath80 and @xmath81 is a shape parameter .",
    "the correction term @xmath82 v^{-1/2 } ( \\mu_i ) w(\\bx_i ) \\mu_i^{\\prime}$ ] can be computed explicitly for the nb model , as shown in appendix . in order to ensure that the solution to ( [ crnb2eq ] ) is robust",
    ", the parameter @xmath11 is estimated using a robust method .",
    "we propose the use of the robust scale estimator @xcite defined by @xmath83\\right\\}=\\bzero,\\ ] ] where @xmath84 $ ] is a constant that ensures that the solution to ( [ nb2theta ] ) is fisher consistent ( see the appendix for its computation ) and @xmath85 is chosen as in ( [ crnb2eq ] ) .",
    "the equations ( [ crnb2eq ] ) and ( [ nb2theta ] ) can be solved by iterating between a solution to ( [ crnb2eq ] ) given @xmath11 and a solution to ( [ nb2theta ] ) given @xmath25 .    following cantoni and ronchetti",
    "@xcite we can write down a sandwich - type approximation to the variance of the solution to ( [ crnb2eq ] ) as @xmath86 here @xmath87 where @xmath88 is a diagonal matrix with elements @xmath89w^{2}(\\bx_i)\\frac{1}{v(\\mu_i ) } \\big ( \\frac{\\partial \\mu_i}{\\partial \\eta_i } \\big)^2 $ ] and @xmath90 where @xmath91 is a diagonal matrix with elements @xmath92\\frac{1}{v^{1/2}(\\mu_i)}w(\\bx_i)\\big ( \\frac{\\partial \\mu_i}{\\partial \\eta_i } \\big)^2 $ ] , with @xmath93 the conditional density of @xmath94 and @xmath95 .",
    "computational formulae for the elements of @xmath88 and @xmath91 are set out in the appendix .",
    "an estimator of the first order approximation ( [ sandwich ] ) is then @xmath96",
    "the m - quantiles of a random variable @xmath19 with continuous distribution function @xmath97 are a ` quantile like ' characterisation of @xmath98 and were introduced in @xcite , who noted that the relationship between an m - estimate of the location of @xmath98 and its corresponding sample m - quantiles is the same as that between its sample median and corresponding sample quantiles .",
    "m - quantile regression is a generalization of regression to the m - quantiles of the conditional distribution of @xmath19 given a vector @xmath20 of covariates . in particular ,",
    "the regression m - quantile of order @xmath99 for this distribution , @xmath100 , is defined as the solution @xmath101 to    @xmath102 = 0,\\ ] ]    where the expectation is conditional on @xmath20 , @xmath103 $ ] , @xmath104 is the scale of the random variable @xmath105 , and @xmath85 is an appropriately chosen influence function .",
    "a linear regression m - quantile of order @xmath99 satisfies @xmath106 , where @xmath107 is then the @xmath21 vector of regression coefficients that defines the m - quantile of order @xmath99 of the conditional distribution of @xmath19 given @xmath20 . by analogy with standard m - regression",
    ", an estimator of @xmath107 can be obtained as the solution to the set of estimating equations @xmath108 where @xmath109 and @xmath110 is a robust estimate of scale , e.g. the median absolute deviation estimate @xmath111 , where the @xmath112 are the residuals generated by an ols fit .",
    "it is straightforward to obtain a solution to ( [ lmqee ] ) using an iteratively re - weighted least squares algorithm .",
    "furthermore , if @xmath85 is continuous and monotone non - decreasing ( e.g. a huber - type function ) then this algorithm is guaranteed to converge to a unique solution @xcite .",
    "the quantile function of a discrete random variable is not generally a monotone increasing function of @xmath99 , so a unique solution to ( [ mquantile ] ) for distinct values of @xmath99 does not exist if @xmath19 is a count and @xmath113 , i.e. the influence function corresponding to the median",
    ". however , this is not the case if @xmath85 is a continuous monotone non - decreasing function , in which case a unique solution always exists provided the expectation exists .",
    "this allows the concept of regression m - quantiles to be extended to count data in a straightforward way . in the case of nb data , an appealing model for @xmath101",
    "is then @xmath114 where @xmath115 is the linear predictor and @xmath116 is a vector of offset terms ( expected or baseline cases ) that can potentially be included in the model .    in order to estimate @xmath107 we consider the extension of ( [ crnb2eq ] ) to the m - quantile case .",
    "in particular , we replace @xmath44 there by @xmath117 , leading to the estimating equations @xmath118 where @xmath119 $ ] , @xmath120 , @xmath121 , @xmath122 is a shape parameter and @xmath123 .",
    "furthermore , using the results in the appendix for robust negbin2 , @xmath124 where @xmath125 , @xmath126 and @xmath127 $ ] .",
    "as noted earlier , the equations ( [ crnb2mqeq ] ) can be solved using fisher scoring , with the parameter @xmath128 estimated analogously to ( [ nb2theta ] ) as the solution to @xmath129\\right\\}=\\bzero,\\ ] ] where @xmath130 $ ] is a constant that ensures fisher consistency for estimation of @xmath128 and @xmath131 was defined following ( [ crnb2mqeq ] ) .",
    "routines in ` r ` that solve these estimating equations are available from the authors , and we refer to the ` ensemble ' model defined by the solutions to ( [ crnb2mqeq ] ) and ( [ nb2thetamq ] ) for a range of values of @xmath99 as a nbmq model below .",
    "we note in passing that all fitted regression m - quantiles are potentially subject to the phenomenon of quantile crossing .",
    "theoretically , regression m - quantiles are strictly non - decreasing in @xmath99 at every @xmath20 .",
    "however , in practice two or more fitted regression m - quantiles can sometimes ` cross ' in the sense that this non - decreasing property does not hold at every sample value of @xmath20 .",
    "he @xcite proposed a posteriori adjustments to fitted regression quantiles to eliminate crossing , and pratesi _ et al . _",
    "@xcite adapted this procedure to p - spline regression m - quantiles .",
    "our implementation of regression m - quantiles based on ( [ nbmqmodel ] ) could use the approach proposed by he @xcite to define nbmq curves that do not cross .",
    "hb models like ( [ hbstandard ] ) characterise the variability associated with the conditional distribution of an overdispersed count variable @xmath19 given covariates @xmath20 in terms of latent clustering and heterogeneity effects .",
    "however , a nbmq model can also be used to characterise this overdispersion by associating a unique ` m - quantile coefficient ' with each observed count .    the m - quantile coefficient associated with the observed value @xmath31 of a continuously distributed random variable @xmath19 and an associated covariate value",
    "@xmath23 is the value @xmath132 such that @xmath133 , see @xcite .",
    "typically , this equation is solved by fitting the regression m - quantiles on a finite grid @xmath134 of @xmath135 values of @xmath99 and using linear interpolation .",
    "unfortunately , with nb data and @xmath117 defined by ( [ nbmqmodel ] ) , this definition can not be used without modification since an observed count @xmath136 can never be part of the strictly positive domain of @xmath117 . to overcome this problem we use the following definition : @xmath137 where @xmath138 denotes an appropriate strictly positive boundary function for the data set . note that this function can not be its convex hull , since that will take the value zero where @xmath139 .",
    "another possibility is @xmath140 .",
    "however this implies that the m - quantile coefficient for any value @xmath139 is @xmath141 , irrespective of the value of @xmath20 .",
    "one way to tackle this issue is to argue that the observation @xmath136 corresponds to a smaller @xmath99-value then the observation @xmath142 when @xmath143 . as a consequence , we put @xmath144^{-1 } \\}$ ] , where @xmath145 is a small positive constant . for @xmath146",
    ", this value can be set equal to @xmath147 , so that approximately half the observations with y = 0 have @xmath148 and the remainder have @xmath149 .",
    "the m - quantile coefficient associated with @xmath31 and @xmath23 is then @xmath132 , where @xmath150    focusing on the choice of the grid @xmath151 used to solve ( [ qvalue ] ) , we observe that bym ` borrows strength ' via specification of the variance parameter @xmath152 . in effect , as @xmath152 goes to infinity one ends up in the limit with glm behaviour , which , in the nbmq case , corresponds to a single point grid @xmath151 with @xmath153 .",
    "this implies that one way of capturing area heterogeneity in a nbmq model is via specification of @xmath151 . if we note that the @xmath99 values of the empirical sample quantiles of a distribution are defined by the set @xmath154 irrespective of the variance of this distribution , then @xmath155 is a robust default definition for the grid @xmath151 .    in environmental and epidemiological applications , observations that are spatially close may be more alike than observations that are further apart",
    "equivalently , m - quantile coefficients of observations that are spatially close should be similar .",
    "one way of incorporating this information is to spatially smooth the grid - based solutions to ( [ qvalue ] ) .",
    "this can be done in a variety of ways .",
    "for example , we can average grid - based solutions @xmath156 from adjacent areas using the formula @xmath157 other kinds of spatial averaging are possible .",
    "for example , we can average using weights @xmath158 whose values depends on the euclidean distance between the centroids of the areas @xmath36 and @xmath159 so that areas close to area @xmath36 receive more weight than those further away . in this case",
    "the spatially averaged m - quantile coefficient @xmath160 becomes @xmath161 a simple gaussian specification for this weighting function is @xmath162 , where @xmath163 is the bandwidth . in this case the spatial weight @xmath158 decreases exponentially as the distance @xmath164 increases , with the bandwidth @xmath165 determining the speed of this decay .",
    "following chambers and tzavidis @xcite we then note that the m - quantile coefficients defined by a nbmq model can be used to capture residual between - area variation by the deviation of the area - specific m - quantile regression coefficient @xmath166 from the ` median ' m - quantile coefficient @xmath167 .",
    "in particular , the nbmq predictor of the count in area @xmath36 is then @xmath168 the spatial version of ( [ prediction ] ) , referred to as nbmqsp below , is defined by replacing @xmath132 by @xmath169 .",
    "finally , we observe that we can write the nbmq model in a form that mimics the hb model ( [ hbstandard ] ) , via the identity @xmath170 the last term on the right - hand side of ( [ pseudo ] ) can be interpreted as a pseudo - random effect for area @xmath36 , allowing estimation of area effects .",
    "we propose a semiparametric bootstrap - based estimator for estimating the mse of ( [ prediction ] ) .",
    "this bootstrap is semiparametric in nature in the sense that area effects are generated using an empirical rather than a parametric distribution . given the @xmath27 values of the count variable @xmath171 the steps of this bootstrap procedure are summarized as follows :    * fit the model ( [ nbmqmodel ] ) to the data to obtain a predicted value @xmath172 , an estimated pseudo - random effect @xmath173 and an estimate @xmath174 of the shape parameter for each area @xmath36 .",
    "it is convenient to re - scale the @xmath175 so that they have mean exactly equal to zero . *",
    "construct the sets @xmath176 and @xmath177 . here",
    "@xmath178 and @xmath179 where @xmath180 is a random draw from the set @xmath181 .",
    "* generate a bootstrap data set of size @xmath27 , by generating values from a negative binomial distribution with @xmath182 @xmath183 to obtain bootstrap realizations @xmath184 , @xmath185 .",
    "* fit model ( [ nbmqmodel ] ) to these bootstrap data and calculate the bootstrap values @xmath186 of the nbmq predictors . *",
    "repeat steps 2 - 4 @xmath187 times . in the @xmath165-th bootstrap replication ,",
    "let @xmath188 be the quantity of interest for area @xmath36 , and let @xmath189 be the value of its corresponding nbmq predictor .",
    "the bootstrap estimator of the mse of ( [ prediction ] ) is then @xmath190    note that this bootstrap procedure can also be used for the nbmqsp predictor by replacing @xmath132 by @xmath160 .",
    "the scottish lip cancer dataset has been widely analysed in the disease mapping literature ( e.g. @xcite , @xcite and @xcite ) . here",
    "we use these data as the basis for a simulation study that compares the nbmq and nbmqsp approaches with the eb , bym and bymsp approaches to estimating the distribution of relative risk over a defined set of areas .    the data consist of the reported number of lip cancer cases , as well as the expected number based on population counts , together with an exposure - related covariate indicating the proportion of the population engaged in agriculture , fishing , or forestry for each of the 56 administrative areas of scotland over the period 1975 - 1980 . following standard practice",
    ", we use this proportion divided by ten as the covariate in the model .",
    "the data mechanism used in the simulations emulated the structure of these data , in the sense that independent @xmath191 counts were generated based on the model @xmath192 , where the expected cases @xmath35 and covariate values @xmath193 were the same as in the lip cancer dataset , and the values @xmath194 used for the model coefficients were defined by the corresponding eb estimates for these data .",
    "the heterogeneity effects @xmath195 were independently drawn from a normal distribution with zero mean and @xmath196 set equal to @xmath197 or @xmath198 .",
    "note that there were no clustering effects in this simulation model , so methods like bymsp and nbmqsp that assume the existence of spatial effects can be expected to be relatively inefficient . in the simulation @xmath199",
    "independent sets of counts were first generated , and each sample was then perturbed by adding @xmath200 to the covariate values of four randomly chosen areas ( from the @xmath201 that have a covariate value greater than @xmath202 ) .",
    "estimated relative risks for the @xmath203 areas were computed for each set of counts , using the different estimation methods discussed in this paper , i.e. standardised ratios ( smr ) , empirical bayes ( eb ) , hierarchical bayes assuming no clustering effects ( bym ) and assuming clustering effects ( bymsp ) , and negative binomial m - quantile modelling , without clustering effects ( nbmq ) and allowing for clustering effects ( nbmqsp ) . for each area ,",
    "the monte carlo bias ( bias ) and root mean squared error ( rmse ) of each estimation procedure was then calculated .",
    "the mean values of these performance measures over the @xmath203 areas are set out in table [ tabella ] .",
    "the results largely confirm our expectations . under both heterogeneity scenarios ( @xmath196=@xmath204 ) , eb and",
    "bym report smaller average values of bias than nbmq but also higher average values of rmse , reflecting the usual bias - variance trade - off in outlier - robust estimation .",
    "furthermore , given that the simulated data had no clustering effects , it is not surprising to see that bymsp is inferior to bym in terms of average rmse performance , with virtually identical average bias . essentially , there is a variance price to be paid for the overparameterized bymsp model .",
    "however , rather surprisingly , we see that nbmqsp is clearly better than nbmq in terms of average rmse , with only a small increase in average bias .",
    "the reason for this becomes clear once one considers the fact that the m - quantile coefficients used in nbmqsp are spatially averaged , see ( [ sp_qvalue ] ) .",
    "this means that the simulated outliers in the data , which have no spatial structure , had much less of an impact on the m - quantile coefficient used by nbmqsp for any particular area . in effect , spatial averaging , in the absence of real clustering in the data , results in m - quantile coefficients that are more stable and shrunk somewhat towards @xmath205 , leading to lower variability for the corresponding nbmqsp estimates .",
    "of course , this type of shrinkage also implies an increase in average bias , and this can be seen in the results for nbmqsp in table [ tabella ] .",
    "we finally examine the performance of the semiparametric bootstrap mse estimator ( [ bootnp ] ) .",
    "the left hand plot in figure [ boot ] shows the distributions over the 56 areas of the ratios of the monte carlo average of ( [ bootnp ] ) to the actual monte carlo mse of ( [ prediction ] ) , while the right hand plot in this figure shows the distributions of corresponding monte carlo coverages of nominal 95% gaussian prediction intervals based on ( [ bootnp ] ) .",
    "it is clear that using ( [ bootnp ] ) leads to very accurate estimates of the mse of nbmq with some undercoverage , while it leads to overestimation of the mse of nbmqsp with overcoverage .",
    "we illustrate the nbmq approach using data on low birth weight incidence over 2005 - 2010 for @xmath6 local authority districts ( lads ) in england .",
    "the low birth weight data consist of the number of cases of live and still births with a valid recorded birth - weight of less than 2500 grams .",
    "the data set was obtained from the uk public health observatory . expected numbers of cases",
    "were defined using internal standardization based on a set of age - gender specific rates .",
    "a preliminary nb - glm fit of these data indicated use of the covariates deprivation index 2007 and lad population density ( defined as population divided by land area in square miles ) for the low birth weight variable .",
    "figure [ pearson ] shows the distributions of pearson residuals generated by nb - glm fits to the low birth weight variable using these covariates .",
    "these plots indicate the presence of potential influential observations in the data , with a number of large residuals ( @xmath206 ) evident .",
    "further evidence for the presence of influential observations in these data is obtained when we fit them using robust nb - glm and note that although most observations receive a weight of @xmath207 , there are approximately @xmath208 that receive a weight of less than 0.25 .",
    "we also note that the values of the model covariates are obtained from uk public health observatory data using small area estimation methods , and so have both sampling and nonsampling error . substituting these estimates as covariates in the standard ecological regression models introduces an additional source of error for lad - level estimates of low birth weight . using an outlier - robust approach , such as one based on an m - quantile model with a bounded influence function",
    ", therefore seems reasonable .",
    "estimates based on fitting the eb , bym , bymsp , nbmq and nbmqsp ecological regression models to these data were obtained using ` r ` software .",
    "the ` ebayes ` function in the ` spatialepi ` library was used to fit the eb model , while the ` brugs ` library ( an ` r ` interface to the ` openbugs ` software ) was used to fit the bym and bymsp models .",
    "the nbmq and nbmqsp models were fitted using an ` r ` function , ` glm.mq.nb ` in the ` countmq ` library that is available from the authors .",
    "figure [ betalbw ] shows the change in the coefficients of the nbmq model coefficients as the quantile index @xmath99 varies between zero and one .",
    "we see that this change is rather non - linear , particular for values of @xmath99 near zero and near one , with the ` median ' regression m - quantile fit at @xmath205 typically quite different from the regression m - quantile fits at values of @xmath99 away from this central value .",
    "this is evidence of significant overdispersion in this data set .",
    "furthermore , different covariates have different effects on fitted regression m - quantiles , as the contour plots in figure [ contourlwb ] demonstrate . here",
    "we see that the contours of the fitted values of the regression m - quantiles of order @xmath209 , @xmath205 and @xmath210 all change faster as deprivation index 2007 increases compared with when population density increases .",
    "finally , the scatterplots in figure [ estimates ] show the relationships between smr values and the corresponding estimates of relative risk generated by the eb , bym , bymsp , nbmq and nbmqsp approaches .",
    "these estimates are in general agreement , with the smallest correlation ( between bym and nbmqsp ) being @xmath211 .",
    "note , however , that nbmqsp also leads to estimates that appear rather more shrunken towards a common value than those produced by the other approaches .",
    "figure [ maplbw ] shows the relative risk maps produced by the different approaches .",
    "these are in general agreement , and show the expected geographic differences due to variation in the model covariates .",
    "risk levels for low birth weight are higher in urbanized and socio - economic disadvantaged lads .",
    "of more interest is the spatial distribution of the m - quantile coefficients used in the nbmq approach , see equation ( [ qvalue ] ) , which reflects variability not accounted for by the model covariates .",
    "figure [ mapq ] shows this distribution .",
    "here we see pronounced geographic clustering of these indices , indicating a need for spatial averaging , and hence a preference for relative risk maps based on nbmqsp .",
    "we show how an ensemble model defined by the robust regression m - quantiles of a negative binomial distribution can be used to model the count data underpinning disease mapping applications .",
    "this modelling approach offers a natural way of characterising between area variability in count data without imposing prior assumptions about the source of this variability .",
    "in particular , with an ensemble m - quantile model there is no need to explicitly specify the latent variables believed to be the cause of between area variability ; rather , inter - area differences are captured via area - specific m - quantile coefficients . as a consequence ,",
    "the need for distributional assumptions is reduced , and estimation and outlier robust inference is relatively straightforward .",
    "the simulation results that we report in this paper provide some evidence that the proposed m - quantile modelling approach is a reasonable alternative to the use of mixed effects models for both ecological analysis and disease mapping .",
    "however , there remain important issues to be resolved . as with all other model - based methods in current use for disease mapping ,",
    "appropriate covariate specification is crucial under the m - quantile modelling approach , and further research is necessary to develop tools for covariate selection when using ensemble models like nbmq and nbmqsp . in this context",
    ", we note the work on robust quasi - deviance measures by cantoni and ronchetti @xcite .",
    "we also note that the m - quantile modelling approach described here specifically excludes modelling the quantiles of the count variable of interest , since these are not unique .",
    "recently , machado and santos silva @xcite and lee and neocleous @xcite have proposed an approach to quantile regression for count data that overcomes this uniqueness problem by jittering the count outcome using additive noise that is uniformly distributed over the interval @xmath212 .",
    "this form of jittering creates pseudo - smoothness in the outcome variable and so allows it to be modelled using standard quantile regression methods .",
    "another approach to quantile modelling of count data was proposed by efron @xcite , based on the use of asymmetric maximum likelihood estimation .",
    "further research is necessary to investigate the usefulness of these alternative quantile regression - based approaches for disease mapping and to compare them with the m - quantile method described here .",
    "finally , we note that further research is necessary to compare the robustness properties of the nbmq approach suggested in this paper with the approach of bernardinelli _ et al . _",
    "@xcite , which explicitly models errors in the covariates .",
    "we evaluate : @xmath213 ; \\ , \\ ,   \\mbox{(ii ) } e \\left [ \\psi \\left ( \\frac { y_i-\\mu_i}{v^{1/2}(\\mu_i)}\\right ) \\frac{y_i-\\mu_i}{v(\\mu_i)}\\right ] ; \\ , \\ , \\mbox{and ( iii ) } e \\left [ \\psi^2 \\left ( \\frac { y_i-\\mu_i}{v^{1/2}(\\mu_i)}\\right ) \\right];\\ ] ] where @xmath22 is distributed according to a negbin2 distribution ( see @xcite ) , that is , @xmath214 here @xmath11 is a positive integer , @xmath215 and @xmath216 . to simplify the notation ,",
    "the index @xmath36 is suppressed from now on .",
    "first , we evaluate @xmath217 $ ] and @xmath218 $ ] , where @xmath219 and @xmath220 are integers .",
    ". then @xmath222=e\\bigl[y\\,i(y\\in a)\\bigr]-a\\,p(y = a)+b\\,p(y = b).\\ ] ] using the transformation @xmath223 , one also obtains @xmath224 & = \\sum_{y\\in a+1}y\\,\\frac{\\gamma(y+\\theta)}{\\gamma(\\theta)\\,y!}\\,\\bigl(\\frac{\\mu}{\\mu+\\theta}\\bigr)^y\\,\\bigl(\\frac{\\theta}{\\mu+\\theta}\\bigr)^\\theta\\\\     & = \\frac{\\mu}{\\mu+\\theta}\\,\\sum_{z\\in a}(z+\\theta)\\,\\frac{\\gamma(z+\\theta)}{\\gamma(\\theta)\\,z!}\\,\\bigl(\\frac{\\mu}{\\mu+\\theta}\\bigr)^z\\,\\bigl(\\frac{\\theta}{\\mu+\\theta}\\bigr)^\\theta\\\\     & = \\frac{\\mu}{\\mu+\\theta}\\,\\sum_{z\\in a}(z+\\theta)\\,p(y = z ) \\\\     & = \\frac{\\mu}{\\mu+\\theta}\\,e\\bigl[\\,y\\,i(y\\in a)\\bigr]+\\frac{\\mu\\,\\theta}{\\mu+\\theta}\\,p(y\\in a ) .",
    "\\end{array}\\ ] ] equating these expressions , we see that @xmath225=\\frac{\\mu+\\theta}{\\theta}\\,\\left[a p(y = a)- b p(y = b)\\right]+\\mu \\,p(y\\in a).\\ ] ] we next apply the same argument to evaluating @xmath226 $ ] . in this case ,",
    "@xmath227=e\\left[y^2\\,i(y\\in a)\\right]-a^2\\,p(y = a)+b^2\\,p(y = b)\\ ] ] and @xmath228&= \\sum_{y\\in a+1}y^2\\,\\frac{\\gamma(y+\\theta)}{\\gamma(\\theta)\\,y!}\\,\\bigl(\\frac{\\mu}{\\mu+\\theta}\\bigr)^y\\,\\bigl(\\frac{\\theta}{\\mu+\\theta}\\bigr)^\\theta\\\\ & = \\frac{\\mu}{\\mu+\\theta}\\,\\sum_{z\\in a}(z+1)(z+\\theta)\\,\\frac{\\gamma(z+\\theta)}{\\gamma(\\theta)\\,z!}\\,\\bigl(\\frac{\\mu}{\\mu+\\theta}\\bigr)^z\\,\\bigl(\\frac{\\theta}{\\mu+\\theta}\\bigr)^\\theta\\\\ & = \\frac{\\mu}{\\mu+\\theta}\\,\\sum_{z\\in a}\\bigl(z^2+(\\theta+1)z+\\theta\\bigr)\\,p(y = z)\\\\ & = \\frac{\\mu}{\\mu+\\theta}\\,e\\bigl[\\,y^2\\,i(y\\in a)\\bigr]+\\frac{\\mu\\,(\\theta+1)}{\\mu+\\theta}\\,e\\bigl[\\,y\\,i(y\\in a)\\bigr]+\\frac{\\mu\\,\\theta}{\\mu+\\theta}\\,p(y\\in a ) . \\end{array}\\ ] ] again , equating these expressions yields @xmath229&=\\frac{\\mu+\\theta}{\\theta}\\,\\left[a^2 p(y = a)- b^2 p(y = b)\\right]+ \\frac{\\mu ( \\theta+1)}{\\theta}\\,e \\left[y\\,i(y\\in a)\\right]+\\mu\\,p(y\\in a)=\\\\ & = \\frac{\\mu}{\\theta}\\,\\left[\\theta+\\mu \\theta+\\mu\\right ] p(y\\in a)+\\frac{\\mu+\\theta}{\\theta}\\,\\left[a^2\\,p(y = a)-b^2\\,p(y = b)\\right]+\\\\ & + \\frac{\\mu ( \\mu+\\theta ) ( \\theta+1)}{\\theta^2}\\left[a p(y = a)- b p(y = b)\\right].\\\\ \\end{array}\\ ] ]    we are now in a position to evaluate ( i)@xmath230(iii ) given @xmath231 .",
    "define @xmath232 and set @xmath233 .",
    "let @xmath234 and @xmath235 .",
    "note that the results obtained below may change depending on whether or not @xmath236 is an integer . in what follows",
    ", we assume the non - integer case ; the integer case can be handled similarly .    * @xmath237= - c \\ , p\\left ( \\frac { y -\\mu } { v^{1/2}(\\mu ) } <",
    "-c \\right ) + c \\ , p\\left(\\frac { y -\\mu } { v^{1/2}(\\mu ) } >",
    "c\\right ) + \\ ] ] @xmath238=\\ ] ] since @xmath239 implies @xmath240 , as @xmath19 is integer valued , we have @xmath241 .",
    "analogously , @xmath242 implies @xmath243 , which , since @xmath244 is not integer , leads to @xmath245 ( when @xmath244 is integer to @xmath246 ) .",
    "moreover , @xmath247 implies @xmath248 which amounts to @xmath249 ( when @xmath244 is integer is @xmath250 ) .",
    "so @xmath237=-c \\ ,",
    "p\\left(y \\leq j_1\\right ) + c \\ , p \\left(y \\geq j_2 + 1 \\right ) + \\ ] ] @xmath251 - \\frac{\\mu}{v^{1/2}(\\mu ) } p(j_1 + 1 \\leq y \\leq j_2).\\ ] ] considering @xmath252 and also that @xmath253 we obtain @xmath254= \\mu p ( j_1 \\leq y \\leq j_2 - 1)- \\frac{\\mu } { \\theta } j_2 p(y = j_2)+\\frac{\\mu } { \\theta } j_1 p(y = j_1)\\ ] ] and finally @xmath255&=-c \\ , p\\left(y \\leq j_1\\right ) + c \\ , p \\left(y \\geq",
    "j_2 + 1 \\right)+\\\\ & + \\frac{\\mu } { v^{1/2}(\\mu ) } p ( y = j_1 ) \\left ( 1+\\frac{j_1}{\\theta}\\right ) - \\frac{\\mu } { v^{1/2}(\\mu ) } p(y = j_2 ) \\left(1+\\frac{j_2}{\\theta } \\right).\\\\ \\end{array}\\ ] ] * @xmath256= -\\frac{c}{v(\\mu ) } e \\left[(y - \\mu ) \\ , i(y \\leq j_1)\\right]+\\frac{c}{v(\\mu ) } e \\left[(y - \\mu ) \\ , i(y \\geq j_2 + 1)\\right]+\\ ] ] @xmath257=\\ ] ] @xmath258 @xmath259-\\frac{c}{v(\\mu ) } e\\left [ y \\ , i(y \\leq j_2)\\right ] -\\frac{2 \\ , \\mu } { v^{3/2}(\\mu ) } e \\left[y \\ ,   i(j_1 + 1 \\leq y \\leq j_2)\\right]+\\ ] ] @xmath260\\ ] ] from ( [ atteso1p ] ) , setting @xmath261 in ( [ atteso1 ] ) and using ( [ passo ] ) leads to @xmath262=-\\frac{\\mu } { \\theta } j_1 \\ , p(y = j_1)+ \\mu \\ , p(y \\leq j_1 - 1).\\ ] ] similarly , setting @xmath263 in ( [ atteso1 ] ) and using ( [ passo ] ) gives @xmath264=-\\frac{\\mu } { \\theta } j_2 \\ , p(y = j_2)+ \\mu \\ , p(y \\leq j_2 - 1).\\ ] ] finally , setting @xmath265 in ( [ atteso2 ] ) and using ( [ passo ] ) leads to @xmath266= \\frac{\\mu}{\\theta } \\ , ( \\theta+\\mu \\ , \\theta+\\mu ) \\ , p(j_1 + 1 \\leq y \\leq j_2)\\ ] ] @xmath267 \\left[\\frac{\\mu}{\\theta}\\ ,   j_1 \\ , p(y = j_1)+\\mu \\ , p(y = j_1)\\right]\\ ] ] @xmath268 \\left[\\frac{\\mu}{\\theta } \\ , j_2 \\ , p(y = j_2)+\\mu \\ , p(y = j_2)\\right].\\ ] ] finally , substituting ( [ atteso1p ] ) , ( [ e2 ] ) , ( [ e3 ] ) and ( [ atteso2p ] ) , @xmath269= \\frac{\\mu \\ , c}{v(\\mu ) } \\left [ p(y = j_1 ) \\frac{j_1+\\theta}{\\theta}+ p(y = j_2 ) \\frac{j_2+\\theta}{\\theta}\\right]\\ ] ] @xmath270\\ ] ] @xmath271 -   p(y = j_2 ) \\left [ \\frac{j_2-j_2 \\theta - \\theta^2}{\\theta^2}\\right ] + \\frac{1}{\\theta } p(j_1 \\leq y \\leq j_2 - 1)\\right\\}.\\ ] ] * @xmath272=c^2 \\left [ p(y \\leq j_1 ) + p(y \\geq j_2 + 1 ) \\right]+\\ ] ] @xmath273=\\ ] ] @xmath274 + \\frac{\\mu ^2}{v(\\mu ) } p(j_1 + 1 \\leq y \\leq j_2)\\ ] ] @xmath275 + \\frac{1}{v(\\mu ) } e[y ^2 \\ , i(j_1 + 1 \\leq y \\leq j_2)].\\ ] ] substituting the expected values ( [ atteso1p ] ) and ( [ atteso2p ] ) we obtain @xmath276 = c^2 \\ , \\ , [ 1- p(j_1 + 1 \\leq y \\leq j_2)]+\\ ] ] @xmath277+\\ ] ] @xmath278 -   p(y = j_2 ) \\left [ \\frac{j_2-j_2 \\theta - \\theta^2}{\\theta^2}\\right ] + \\frac{1}{\\theta }   p(j_1 \\leq y \\leq j_2 - 1 ) \\right\\}.\\ ] ]                  macnab  yc .",
    "bayesian multivariate disease mapping and ecological regression with errors in covariates : bayesian estimation of dalys and ` preventable ' dalys .",
    "_ statistics in medicine _ 2009 ; * 28 * : 13691385 ."
  ],
  "abstract_text": [
    "<S> we introduce a semi - parametric approach to ecological regression for disease mapping , based on modelling the regression m - quantiles of a negative binomial variable . </S>",
    "<S> the proposed method is robust to outliers in the model covariates , including those due to measurement error , and can account for both spatial heterogeneity and spatial clustering . </S>",
    "<S> a simulation experiment based on the well - known scottish lip cancer data set is used to compare the m - quantile modelling approach and a random effects modelling approach for disease mapping . </S>",
    "<S> this suggests that the m - quantile approach leads to predicted relative risks with smaller root mean square error than standard disease mapping methods . </S>",
    "<S> the paper concludes with an illustrative application of the m - quantile approach , mapping low birth weight incidence data for english local authority districts for the years 2005 - 2010 .    * disease mapping via negative binomial regression m - quantiles *    ray chambers@xmath0 , emanuela dreassi@xmath1 , nicola salvati@xmath2    @xmath3 national institute for applied statistics research australia , + university of wollongong , australia + @xmath4 dipartimento di statistica , informatica , applicazioni ( disia ) , + universit degli studi di firenze , firenze , italy + @xmath5 dipartimento di economia e management , + universit di pisa , pisa , italy +    * keywords : * ecological regression ; overdispersed count data ; robust models ; spatial correlation </S>"
  ]
}