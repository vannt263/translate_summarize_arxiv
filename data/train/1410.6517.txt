{
  "article_text": [
    "lithium remains an enigmatic element .",
    "because it captures a proton at such low temperatures ( about 2 million k ) we find that stars are much more efficient at destroying li than producing it .",
    "it is synthesized by cosmic ray spallation and was made only in trace amounts in the big bang . in 1982",
    "it was discovered that there is a baseline minimum li abundance in old stars in the galactic halo .",
    "this is known as the `` spite plateau '' after the discoverers @xcite , and corresponds to a value of li / h @xmath0 by number . with this background",
    "we are able to elucidate a number of so - called `` lithium problems '' .    1 .",
    "there remains a significant discrepancy between the predictions for the li abundance from big bang nucleosynthesis and the wmap results ( li / h @xmath1 or a(li)=2.716 where @xmath2 denotes the number density . ] ) compared to observations in the oldest population ii stars ( essentially the spite plateau ) which show a consistent li / h @xmath3 12@xmath4 or a(li)@xmath5 @xcite .",
    "2 .   there is also a dip in the spite plateau appearing over a narrow range of effective temperatures @xmath6@xmath7 ( corresponding to dwarf masses in the range @xmath8@xmath9 ) .",
    "this requires some form of mixing to transport the li to regions where it is destroyed , but which only acts over this narrow range in spectral type or mass . for reviews",
    "see @xcite .",
    "3 .   our sun has a surface li abundance about 140 times lower than predicted by the best models for the early evolution of the sun ( e.g. * ? ? ?",
    "4 .   in some ( galactic ) globular clusters ,",
    "both populations of stars ( usually interpreted as different generations ) seem to show the same li content despite the fact that one population shows the results of hot hydrogen burning , which should efficiently destroy any li present .",
    "this observation thus requires some li production but , curiously , it must occur at exactly the rate required to match the material that has not undergone burning @xcite .    such long - standing and confounding problems present headaches for stellar physicists , and make it ironic that li is used to treat depression in humans .",
    "lithium is involved in the classical pp chains of hydrogen burning , as shown in figure  [ reactions ] .",
    "the ppii and ppiii chains start with the production of be . at typical hydrogen burning temperatures",
    "the be can capture a proton which leads to the completion of the ppiii chain .",
    "but one can also produce li through electron capture on be , which occurs at all temperatures .",
    "this li is then destroyed by a proton capture , completing the ppii chain .",
    "however , it was pointed out some time ago by @xcite that if one can move the be to a cooler region before it captures a proton , the still rapid electron capture could lead to a net production of li .",
    "this is the basis of the `` cameron - fowler beryllium transport mechanism '' which is understood to be active in the more massive agb stars where we find hot - bottom burning . in these stars",
    "the convective envelope extends into the top of the hydrogen burning shell , with the result that nuclear burning happens in a very thin zone at the bottom of a dynamically active convective zone .",
    "models of this phase by @xcite and @xcite seem to explain the observed super - li - rich agb stars seen in the magellanic clouds @xcite .    in recent years",
    "it has been realised that during normal evolution along the red - giant branch , low mass stars will develop an inversion in their molecular weight distribution when the hydrogen shell reaches the maximum interior extent of the convective envelope during the first dredge - up episode ( hereafter fdu ) @xcite .",
    "this mixing is driven by the inversion in mean molecular weight created when the last reaction in the ppi chain takes place .",
    "although a fusion reaction , it replaces two he nuclei with three nuclei - one he and two protons . thus the mean molecular weight @xmath10 decreases .",
    "normally in a hydrogen burning region this decrease is more than compensated for by the increase from the other fusion reactions .",
    "but when the hydrogen burning shell has passed the abundance discontinuity left by fdu , the far - from - equilibrium he burns at a lower temperature than the hydrogen and reduces @xmath10 locally .",
    "this is a normal part of the life of a red - giant and should happen in almost all stars .",
    "studies by various authors @xcite have shown that the resultant mixing , usually referred to as thermohaline mixing in analogy to the case of salt and thermal diffusion in the oceans , seems to produce the required decrease in the @xmath11c/@xmath12c ratio beyond that predicted by fdu .",
    "it also produces a decrease in li @xcite as required by observations , and by destroying @xmath13he it produces agreement between big bang nucleosynthesis and observations of the @xmath13he content of the galaxy @xcite .",
    "@xcite have shown that it is also able to reproduce the observed abundances in carbon - normal and carbon - enhanced metal - poor ( cemp ) giants .",
    "in the region of this local minimum in @xmath10 we have both he and he at temperatures at which nuclear reactions are operating , and hence we expect be and li to be present . a quantitative study is needed to determine the overall impact of this process on the evolution of the envelope composition .",
    "thermohaline mixing is a prime candidate for production of li as well as destruction , and only careful study can reveal which dominates .",
    "indeed , we note that there is a need for some mechanism to produce li in low mass red giants as many li - rich giants are found at luminosities well below that required for hot - bottom burning , which is the usually favoured mechanism for li production @xcite .",
    "@xcite has shown that thermohaline mixing can match the li observations in carbon - enhanced metal - poor stars .    in this paper",
    "we investigate the sensitivity of li production and destruction to the numerical details of the calculation of the thermohaline mixing found on the first giant branch . we show that unless great care is taken , the same implementation of the mixing phenomenon in different codes can produce results that differ by orders of magnitude .",
    "we concentrate on li because of its extreme sensitivity to physical conditions in the model .",
    "although this work is done within the framework of the linear theory for thermohaline mixing as developed by @xcite and @xcite , the conclusions will apply to any mechanism that determines the abundance of the fragile element li .",
    "this is especially true if that process uses the composition to determine the efficiency of mixing , as we discuss below .",
    "this feedback ensures that care must be taken to obtain an accurate solution .",
    "@xcite showed that during the ascent of the first giant branch , red giants would naturally develop a molecular weight inversion when the hydrogen burning shell reached the abundance discontinuity left behind by the maximum inward extent of the convective envelope during fdu .",
    "although this particular application of thermohaline mixing was only recently realised , the process itself has been known for a long time .",
    "the linear theory has been developed by @xcite and extended to the non - perfect gas case by @xcite .",
    "they have cast the theory into a form suitable for a diffusion equation , although we would do well to remember that most forms of mixing are advective , not diffusive .",
    "nevertheless , this is a common approximation in stellar interior studies and it is the one we use here . the thermohaline mixing diffusion coefficient",
    "is given by @xmath14 where @xmath15 is the thermal diffusivity given by @xmath16 @xmath17 @xmath18 and all other symbols have their usual meaning .",
    "note that @xmath19 for a perfect gas , and that @xmath20 unless @xmath21 .",
    "the @xcite and @xcite formulations are equivalent , and depend on one unknown parameter @xmath22 , a non - dimensional coefficient theoretically related to the aspect ratio @xmath23 ( length / width ) of the mixing fingers .",
    "again , we caution that this is a highly idealized formulation , but within this model we have @xcite @xmath24 comparison with observations has led to the preferred value of @xmath25 to match the c / c ratio seen both in field stars and in globular clusters @xcite , and also abundances in cemp stars @xcite .",
    "it is remarkable that a single value produces so much agreement with observations . yet from a theoretical viewpoint",
    "the situation is far from satisfactory .",
    "various researchers have tried to improve our understanding of the mixing process by producing numerical simulations of one kind or another .",
    "calculations have been performed with the boussinesq approximation in 2d @xcite as well as 3d @xcite ; see also @xcite .",
    "these authors all agree that the resulting aspect ratio is too small to support the value @xmath26 required to match the observations . nevertheless , that the observations fit this theory so nicely is a compelling fact , also pointed out by @xcite .",
    "we note that the mechanism naturally starts at the correct place on the giant branch , and there is no freedom in choosing this as it is determined by the extent of first dredge - up and the temperature dependence of the pp chain reactions .",
    "so what are we to make of the seeming contradiction between the hydrodynamical simulations and the 1d models ? there are three things to consider :    1 .",
    "how reliable are the calculations that use the linear theory ? 2 .",
    "how reliable are the determinations of @xmath22 from observations ? 3 .",
    "how reliable are the hydrodynamical models ?",
    "the first question is the topic of this paper , but let us briefly address the other two questions .",
    "it is true that a value of @xmath27 seems to be required to match many observational constraints , as listed earlier .",
    "however recent work by @xcite has shown that a value of @xmath28 is required to match observations of li in various globular clusters .",
    "this is an order of magnitude smaller , and is getting closer to the values preferred by the existing hydrodynamical simulations .",
    "so which is correct : is it 100 or 1000 ? surely we can not choose a different value for each species . at this stage",
    "we can not say anything more definite .",
    "the thermohaline mechanism is under investigation from many different approaches and much is uncertain .",
    "for example , the linear theory assumes that a diffusion equation describes the mixing .",
    "but if it is more advective then this may not be appropriate , and the temperature history of a parcel of stellar material may be important .",
    "this may reveal itself as different values of @xmath22 for species with different sensitivities to the temperature .",
    "much work remains to be done ; the details are simply unknown at present .    as for the hydrodynamical simulations themselves , these are very difficult calculations .",
    "most are not performed under stellar conditions @xcite , and use extrapolations or asymptotic behaviour to try to extend the applicability .",
    "this is in contrast to the work of @xcite and @xcite who did simulate stellar conditions .",
    "@xcite found that their simulations did not support the linear theory , but agreed with those of @xcite although they believe the latter are under - resolved .",
    "we also note that @xcite estimated that a value of @xmath29 would be required to find li production .",
    "we show below that this can be achieved for @xmath30 , indicating again the need for extreme care in performing these calcualtions .",
    "finally , we refer to a recent paper by @xcite who investigated the hydrodynamics of thermohaline mixing in the presence of a horizontal inhomogeneity .",
    "they found that the efficiency of the mechanism was increased by orders of magnitude over the previous hydrodynamical estimates , and noted that this may bring the hydrodynamical calculations closer to successes of the linear theory .",
    "clearly the situation is far from settled . in the rest of this paper we will use the linear theory of @xcite , assuming that @xmath22 takes values consistent with the observations , and we will look at the resulting predictions from different codes for the same theory .",
    "debate about the correct theory belongs elsewhere - for now we are concerned only with the accurate numerical solution of the existing 1d theory in different stellar evolution codes .",
    "we repeat that although @xmath22 is formally related to the aspect ratio of the expected fingering convection ( see equation 5 ) , this association relies on the highly simplified idealized case .",
    "we prefer to treat @xmath22 as an arbitrary scaling parameter in the theory , much like @xmath31 in the mixing - length theory .",
    "it is prudent to note that any competing theory to thermohaline mixing that is intended to produce the required abundance changes in red giant stars , must operate over the same physical region in the star and hence its implementation would require the same sort of numerical care that we discuss below .",
    "such stringency is required by the fragility of lithium , rather than any specific mixing mechanism .",
    "this is exacerbated if the proposed mixing mechanism is dependent on the composition profile , as is the case in thermohaline mixing .",
    "it is the feedback from the composition on the mixing that makes the solution so sensitive to the numerical considerations we discuss below .",
    "this is likely to be true for other mechanisms also .",
    "we will compare calculations made with four different evolution codes , and two different versions of the same code , before and after a rewriting of the difference scheme and solution method .",
    "all calculations are made initially with each code s standard criteria for space and time resolution , so that no special demands are enforced .",
    "the results thus reflect what one might expect for a naive calculation from each code .",
    "salient features of the codes are described below .",
    "we note that the nuclear reactions involved are quite standard pp chains , and that there have been no significant changes in their rates for years , so we do not expect any differences to arise thereby .",
    "convective borders are determined using the normal schwarzschild criterion , with no overshoot .",
    "any variations from this are discussed in the subsections below , dealing with each code .",
    "the first code we will use is monstar , the stellar structure code developed at monash university .",
    "this code began life as the mt stromlo code @xcite but has been modified extensively since .",
    "we use the opal opacity from @xcite without allowing for changes in the envelope composition , which are small in the cases considered here .",
    "we use a mixing - length parameter @xmath32 from fitting the sun to the standard mixing - length theory .",
    "the solutions for the structure and the chemical composition ( as a result of burning and mixing ) are separate in this code .",
    "however , it is perhaps best to think of them as interleaved , because the latest structure iteration is used for determining the burning rates and mixing regions that are applied at the current iteration . at each iteration during the convergence process we update the composition by calculating the burning and mixing . in this way",
    "both structure and composition should converge to a self - consistent solution at the same time .",
    "we will see below that the timestep is crucial to the calculations we are investigating .",
    "we note that monstar has multiple criteria that must be met . broadly speaking these limit the timestep so that changes in dependent physical and composition variables ( at each mass shell ) , and the total luminosity ( from various sources ) are below specified limits .",
    "the stars code was originally written by @xcite , and has been subsequently updated by many authors ( e.g. * ? ? ?",
    "the version used here is that described in @xcite , which is publically available from the stars website - see ` http://www.ast.cam.ac.uk/\\simstars/ `",
    ". it also uses the opal opacities from @xcite , with a mixing length of 2.00 based on calibration to the sun .",
    "the solution of the compositions of species involved in energetically significant nuclear reactions are solved simultaneously with the structure equations @xcite .",
    "the implementation of thermohaline mixing in the code is described in @xcite and @xcite .",
    "we note that the calculation of the mean molecular weight @xmath10 is , in this code , made with the composition from the _ previous _ timestep .",
    "this is significant for the problem addressed in this paper , as we will see below . alongside the main evolution routines , the code has a set of nucleosynthesis subroutines that follow the evolution of 40 nuclear species @xcite .",
    "it is these routines that are used to calculate the lithium abundance .",
    "the timestep is controlled by restricting the sum of the changes in all variables at all mesh points to be equal to a specified value ; there is also a restriction on the maximum change allowed in any dependent variable at any timestep .",
    "we also make use of the recently developed mesa suite of stellar evolution codes - http://mesa.sourceforge.net and described in @xcite ; specifically we use mesa version 6208 .",
    "the formulation for thermohaline mixing in the mesa code is slightly different with @xcite : @xmath33 where @xmath34 is the thermal conductivity given by @xmath35 and @xmath36 is given by equation  6 in @xcite .",
    "referring to @xcite we see that @xmath37 and hence @xmath38 we use the ledoux criterion for convection , and @xmath39 in the @xcite implementation of the mixing - length theory .",
    "mesa selects its timestep via a two stage process @xcite .",
    "a timestep is calculated using a scheme based on digital control theory , which is then subjected to a wide range of tests that reduce this timestep if certain properties are changing faster than specified .",
    "such tests include limits similar to those discussed above for monstar and stars , including restrictions on changes in the solution mesh , composition , nuclear burning rates , etc .",
    "our final code is actually two variants of the starevol code used extensively by forestini , siess , charbonnel and collaborators .",
    "the first of these is the 2000 version of starevol @xcite as used by @xcite and @xcite .",
    "we shall call this the starevol - geneva - v2.3 code , or se - g - v2.3 for short .",
    "this code also uses the same opacity as the others above , @xmath40 and separate solution for the structure and the composition .",
    "the results we quote for this code are taken from @xcite .",
    "this code was largely rewritten recently during development of the binary stellar evolution code binstar @xcite . in this version",
    "the nuclear burning and diffusive transport of the chemicals are coupled and solved simultaneously , although it is of course possible to disable that option and solve separately for the nucleosynthesis and then the mixing .",
    "we will use this feature later in some of our tests .",
    "a major upgrade in the new version of this code is the differencing of the equations , and the ability to simultaneously solve for the structure variables as well as the composition ( including both nuclear burning and mixing ) , as is done in stars .",
    "however this fully coupled solution mode is slower and , as far as thermohaline mixing on the rgb is concerned , tests showed that it does not alter significantly the evolution of the surface abundances .",
    "therefore we do not use this method in any of the tests described below .",
    "rather , we solve for the structure and then the coupled mixing and burning ( except in clearly identified tests where we uncouple the mixing and burning )",
    ". we shall refer to this code as se - v5.5 .    in both starevol versions ,",
    "the same criteria are used to determine the evolution timestep @xmath41 .",
    "we employ the common sort of timestep constraints associated with changes in the structure variables .",
    "we check that at every grid point the physical variables do not change by more than a specified value between consecutive models .",
    "we further limit the timestep during the pre - main sequence and rgb phases not to exceed a fraction of the kelvin helmholtz timescale @xmath42 .",
    "the expression we use is @xmath43 a more appropriate estimate would be to consider the envelope relaxation time scale @xmath44 but this does not make a significant difference . for low and intermediate mass stars climbing the rgb , the constraint on @xmath41 is set ultimately by the requirement that the timestep does not exceed some specified fraction of the kelvin helmholtz timescale ( @xmath42 ) . in se - v5.5 , this limit is set to @xmath45 .",
    "our test case will be a model of @xmath46 with `` solar '' composition , as defined in @xcite , meaning x  @xmath47 , y=  @xmath48 and z  @xmath49 .",
    "in particular we take the initial mass fraction of he to be @xmath50 and the initial li is given by a(li)=3.25 on the zams .",
    "this is the case presented in some detail in @xcite and thus it allows us to compare the results for that work , using se - g - v2.3 , with the other codes above , giving us a total of five essentially independent implementations of the thermohaline mixing algorithm to compare .",
    "to introduce the important physics we show in figure  [ initialcase ] the internal structure of our test model not long after thermohaline mixing has started , when the model is at @xmath51 , just above the luminosity function ( lf ) bump in the hr diagram .",
    "because we will be concerned with mixing timescales we have used radius on the @xmath52-axis instead of mass . for our purposes in this paper",
    "it is far more intuitive to see the distances rather than masses .",
    "note that in the deepest layers where the temperature is higher the shortest timescale is that for li destruction .",
    "moving further out to cooler regions we see that there is a small region where li production dominates , and further out again the mixing timescale becomes the shortest .",
    "hence the effect of thermohaline mixing is to feed material to the hot region where li is rapidly destroyed .",
    "the destruction can be very quick , with timescales as low as days , at the time shown in the figure .",
    "hence the important determinant for the global evolution of the li abundance is the timescale of feeding li - rich material from the envelope into the hot region where it is almost instantly destroyed .",
    "conversely , if li ( or any other species ) is significantly produced then the important timescale is again that of the mixing which now drives the increase in the envelope abundance .",
    "hence it is vital to resolve this mixing adequately .",
    "we start by showing in figure  [ li1000 ] the results from all of our codes for the case @xmath53 .",
    "it is pleasing to see that the plots all have a similar shape , showing the decrease in li caused by fdu at log(l ) @xmath54 , reaching a similar value a(li ) @xmath55 until the start of thermohaline mixing , which occurs at log(l ) @xmath56@xmath57 depending on the code .",
    "this then results in a further decrease of li , except in some codes where there is a small _ increase _ found near the end of the evolution , at the tip of the giant branch .",
    "the first point of difference concerns the first dredge - up .",
    "we define the depth of first dredge - up , @xmath58 as the maximum inward extent of the convective envelope .",
    "clearly the final a(li ) value after fdu depends on this value : simple conservation of li demands that the deeper the maximum extent of fdu the lower is a(li ) .",
    "the luminosity at this time shall be denoted by @xmath59 . when the hydrogen burning shell approaches the step in composition caused by the retreat of the convective envelope after fdu the sudden increase in hydrogen fuel causes a hydrostatic readjustment of the structure , and the radiated luminosity temporarily decreases before beginning to rise again with the new shell structure .",
    "this produces the bump in the luminosity function seen in globular clusters .",
    "following @xcite we define the local minimum and maximum in luminosity as @xmath60 and @xmath61 .",
    "these values are all independent of thermohaline mixing .",
    "table  [ fdu ] gives these values for each of the codes used in this paper .",
    "we note that the discrepancies between different codes at fdu is a topic of considerable importance ; rather than discuss the details here we refer the reader to a recent paper on the subject by angelou et al .",
    "( 2014 ) .    [ cols=\"<,^,^,^,^\",options=\"header \" , ]     [ startthmtab ]         so just how long does it take for the thermohaline region to make contact with the convective envelope ?",
    "figure  [ startthm1 ] shows the results for two cases : se - g - v2.3 @xcite and monstar .",
    "the time delay between the start of thermohaline mixing and the appearance of its effects at the surface is given in table  [ startthmtab ] as @xmath62 .",
    "in se - g - v2.3 the connection between the two mixing zones takes about 45 million years , whereas in monstar it occurs in about 3 million years .",
    "the development of this region is crucially dependent on the propagation of the @xmath10 inversion and requires an accurate determination of the mixing because it is the mixing which feeds the burning and produces the inversion .",
    "fresh material rich in he must be brought down to the burning region , where it is transmuted into material with a lower @xmath10 prior to being transported away from the burning region .",
    "if the timestep is too large then we do not follow this development accurately with the result that the thermohaline mixing takes longer to connect to the convective envelope and hence for the surface abundances to show the effect of the burning .",
    "note that the mixing is driven by a @xmath10 inversion that is as small as 1 part in @xmath63 or so initially .",
    "indeed , as soon as any decrease in @xmath10 is resolved , then the algorithm will start mixing .",
    "how this propagates will depend on how the @xmath10 inversion is resolved and one can understand why small timesteps are needed .",
    "one can also imagine that in a real star , with magnetic fields , rotation , gravity waves etc , such small variations may not be established as easily as in this idealization we are modelling @xcite .",
    "we remind the reader that we are concerned here with an accurate calculation within the paradigm of the theory , rather than a test of the validity of the theory itself .    in any event we tried some tests with se - v5.5 .",
    "we took large timesteps , @xmath64 limited to be less than the total stellar kelvin - helmholtz timescale , @xmath42 , and small timesteps limited to @xmath65 .",
    "the differences are seen in figure  [ startthm2 ] , with @xmath66 million years for the larger time steps but reduced to only 2.19 million years when the smaller timesteps were used ; we discuss the reasons for this below .",
    "the next test was also performed with se - v5.5 .",
    "the kelvin - helmholtz timescale for the model is 68000y at this stage of the evolution .",
    "hence we used fixed @xmath41 of 68000y for the structure but took ten nucleosynthesis sub - steps where we kept the structure constant but mixed and burnt the composition .",
    "we did not update @xmath67 or @xmath68 , just the composition .",
    "this produced a slower growth of the thermohaline region : in one million years the region grows by only @xmath69 , whereas the convective envelope is about @xmath70 from the region where the thermohaline mixing begins ( as shown in figure  [ startthm2 ] ) . in the next test",
    "we also recomputed the @xmath68 in each of the sub - steps and hence updated the diffusion coefficient .",
    "that resulted in more rapid growth , with @xmath71 million years .",
    "this shows clearly that the feedback from the mixing on the diffusion coefficient is crucial for an accurate solution , and hence small timesteps must be taken .",
    "the thermohaline mixing timescale over a distance @xmath72 is just @xmath73 . so from the size of the mesh in the calculation at this stage we estimate the mixing time to be about 1000 years between mass shells",
    "the thermohaline region was resolved with about 50 mass zones .",
    "hence material could be mixed over just a few zones ( about 7 ) in each of the 6800y sub - steps .",
    "we then repeated the calculation with single evolutionary time steps of 3400 years .",
    "the mixing and burning is calculated without sub - steps each time the structure is converged . here",
    "the material should diffuse no more than 3 or 4 zones per timestep .",
    "this should resolve the behaviour much better , and it gives a total time for the thermohaline region to reach the convective envelope of about 1.5 million years , which agrees with the other codes when using small @xmath41 , as well as se - v5.5 results with @xmath41 limited to be @xmath74 , as reported in table  [ startthmtab ] .    as a final test we tried reverting to large timesteps ( 68000y ) but updating @xmath68 and @xmath67 after each iteration in the nucleosynthesis routine . in a run of 1.5 million years",
    "the thermohaline region had only reached about 1/3 of the way to the convective envelope .",
    "we conclude that there is no alternative but to take small timesteps during this part of the evolution as it determines when the surface abundance will begin to change .",
    "it is crucial that the value of @xmath67 be updated after even small changes in the composition  this drives the mixing and hence feeds back on itself .",
    "we are reasonably confident that the _ correct _ value for @xmath62 ( i.e. within the 1d diffusive model of @xcite and @xcite and for this particular stellar model ) is about 1 million years .",
    "this is significantly different to the @xcite value of 45 million years , which presumably did not resolve this initial phase adequately .",
    "it is this delay that is responsible for the offset in the se - g - v2.3 results for li destruction , as shown in figure  [ li1000 ] .",
    "this is also why the value of @xmath75 is much larger ( at @xmath76 ) than the other codes tested ( at about 5060 ; see table  [ startthmtab ] for a list of the tests performed ) .",
    "finally , we should be able to estimate the timescale for the growth of the thermohaline region from the structure .",
    "we have an estimate of the timescale of a diffusion process to move matter over a distance @xmath72 as @xmath77 .",
    "note that this is the time for material _ in the thermohaline region _ to move a distance @xmath72 .",
    "one may initially think that this is not the rate at which the borders of the zone grow .",
    "for example , the convective turnover time in a convective envelope is in no way related to the time it takes for first dredge - up to reach its deepest extent .",
    "the material inside the convective envelope moves with one speed , quite independent of the rate at which the edge of the convective zone moves . in this case the inner edge of the convective envelope is determined by the stellar structure responding to the expansion of the star as it ascends the giant branch , and is quite independent of the concomitant changes in abundance . the speed with which the inner edge of the convective envelope moves inward is typically @xmath78cm / sec , quite different to the speed of matter in the convective envelope , which the mixing length theory gives as @xmath79cm / sec . in the case of diffusion , however , the two speeds are the same .",
    "the edge of the mixed region moves _ precisely _ because it is diffusing into the homogeneous region .",
    "thus the growth of the thermohaline mixing region can be estimated from @xmath67 in the region .",
    "when thermohaline mixing first appears , long before the region has made contact with the convective envelope , we have @xmath80@xmath81/s .",
    "later when the regions have nearly joined @xmath67 has grown to @xmath82@xmath81/s .",
    "given that the mixing must cross a region of about @xmath83 we estimate that at the start the initial timescale for reaching the envelope is @xmath84myr .",
    "but the diffusion coefficient increases rapidly and by the time the regions have joined the timescale is down to @xmath85myr .",
    "this can only give us a crude consistency check , but it supports the result of our calculations giving about 1 million years for the actual time .",
    "we also performed some tests where we varied the spatial mesh , and these are reported in table  [ startthmtab ] .",
    "we found that the mesh spacing was not nearly as critical as the timestep , a result which will re - appear below .",
    "we show the results for @xmath86 in figure  [ li100 ] .",
    "note that we do not have results for se - g - v2.3 for this case .",
    "there is some scatter in the results , and by the time the models reach the tip of the giant branch there is 1 dex spread in the predicted final values for the li content .",
    "this is clearly not acceptable , but as we will see , the situation gets worse as @xmath22 increases .",
    "we have already shown in figure  [ li1000 ] the cases with @xmath53 , including se - g - v2.3 this time , from @xcite .",
    "the early evolution is the same in all codes , but once the thermohaline mixing starts we get a very diverse spread of results . there is a spread of up to 2 dex in the li abundance from different codes , and we even see an increase in the surface a(li ) near the tip of the giant branch in some cases , but not all .",
    "when we move to @xmath87 ( fig  [ li10000 ] ) then all codes except se - g - v2.3 show the increase of li near the tip of the rgb , and a maximum spread in a(li ) between codes of over 3 dex . to try to determine the cause of this variation we have performed a number of tests with the different codes .",
    "we begin by testing the effect of the timestep , since we have seen how crucial this is in the early stages of the evolution .",
    "we chose the case with @xmath53 , which is the preferred value for explaining various observations , as discussed above .",
    "tests were run with three codes , using the `` normal '' timestep constraints , which we refer to as `` @xmath41 '' , and then with increased or decreased timesteps given as multiples of this standard @xmath41 .",
    "the results are shown in figure  [ dttests ] .",
    "firstly consider the runs done with se - v5.5 .",
    "the `` normal '' case and the case with timesteps reduced by a factor of 3 seem to give essentially the same results .",
    "contrarily , if the timestep is increased by a factor of 3 then the results start to differ , with less li being destroyed due to the code not being able to follow accurately the flow of material into the top of the hydrogen burning shell where li is efficiently destroyed",
    ".    now consider the monstar runs . here",
    "the standard case seems to agree well with the converged cases found with the se - v5.5 code .",
    "however if the timestep is increased by a factor of 10 then the code is able to match the li destruction initially , but it starts to depart from the ( presumably ) correct solution and indeed begins to produce li as the model nears the tip of the rgb .",
    "note that li production is seen in the normal case also , for this code , but the production is not as significant with the smaller timestep . upon closer examination",
    "there is also a hint of an increase in li in the well resolved calculations by the se - v5.5 code .",
    "we address the cause of this rise in li in  [ seclirise ] .",
    "two tests were run with the stars code also , as shown in figure  [ dttests ] .",
    "this code does not destroy as much li as monstar and se - v5.5 , and it has not yet converged on our inferred solution .",
    "we note that it does show the same trends as the other codes , in that increasing the timestep stops the calculation from adequately following the flow of material from the convective envelope into the hot burning region resulting is a lower li depletion , as will be explained in sect 5.3 .",
    "as stated earlier , stars normally uses the composition at the previous timestep to calculate @xmath10 .",
    "this is not ideal for the present case where there is strongly coupled feedback between the mixing and the composition . to test this",
    "we ran cases where @xmath10 was calculated using the current composition .",
    "these are reported in table  2 with the notation `` @xmath10 '' and either the normal timestep criteria , @xmath41 , or 1/10 of those criteria , @xmath88 . in practice , the timesteps had to be greatly reduced to ensure convergence , and the results are very similar to the standard case with @xmath88 .",
    "we performed tests on the spatial resolution using stars and se - v5.5 .",
    "specifically , for stars we ran one case with 1999 mesh points , called med - res , and one case with 499 mesh points , called lo - res . as shown in figure  [ dmtests ] as we increase the spatial resolution we actually burn less li .",
    "this is in the opposite direction to the case where we increase the time resolution , and the reason for this will be discussed below .",
    "similar results were found for the se - v5.5 code in the three cases presented . in this case",
    "the low , standard and high resolution cases are defined in terms of the number of zones in the thermohaline region , being 60 , 100 and 170 respectively .",
    "again , increasing the resolution shows that less li is burned .",
    "both codes agree in this respect , although again the stars code seems to be less efficient in destroying li than the other codes .",
    "consider solving the diffusion equation for a quantity @xmath89 @xmath90 over a region with @xmath91 zones of constant width @xmath92 and with constant timestep @xmath41 and constant diffusion coefficient @xmath93 .",
    "we can write this as a fully implicit scheme as :    @xmath94    where superscripts refer to the timestep and subscripts refer to the spatial zone .",
    "we assume the boundary conditions @xmath95 = constant and @xmath96 = constant .",
    "hence can write this as the matrix equation @xmath97 where @xmath98 and @xmath99    here the parameter @xmath100 is simply    @xmath101    this is a tri - diagonal system which can be solved easily by the thomas algorithm , for example .",
    "it is always stable because the diagonal elements are always larger than the sum of the magnitudes of the sub- and super - diagonal elements .",
    "i.e. @xmath102 for all @xmath103 , which is the case here .",
    "the salient feature here is that , for this case with constant space and time steps , the solution is determined entirely by @xmath100 , which enables us to relate the chosen spatial and temporal mesh to the solution .",
    "for example , halving the timestep @xmath41 reduces @xmath100 by a factor of two .",
    "this is the same as using the original timestep but with @xmath93 reduced by a factor of two .",
    "hence we expect the solution with finer timesteps to be similar to solving the original equation with a smaller @xmath93 . similarly , if we halve the spatial mesh @xmath92 then @xmath100 increases by a factor of 4 , so that is equivalent to the using the initial @xmath92 but an increase in @xmath93 by a factor of 4 .    thus increasing the resolution in space and in time have opposite effects on the solution , which is consistent with the tests performed in the previous section",
    "of course , these changes are only indicative ; for instance , when halving the timestep we should actually compare the solution after two time steps with the original solution with the single timestep .",
    "similarly when we double the number of mass shells we should compare every second mesh - point in the new solution with the original solution .",
    "nevertheless , the discussion here gives some explanation for why the solution behaves differently for changes in @xmath92 and @xmath41 .",
    "understanding the dependence of the solutions on the time and mesh spacing is important but it does not guide us in finding an appropriate discretization for our calculations .",
    "we now address this question , through an examination of figure  [ initialcase ] .",
    "the lowest panel in the figure shows the important timescales . for the majority of the evolution the li is destroyed through mixing to the hot region at the bottom of the thermohaline zone .",
    "hence it is crucial to determine the rate at which this mixing occurs . in the region where destruction dominates",
    ", this nuclear burning is very fast .",
    "the efficiency of the destruction thus depends on how rapidly it can be fed by the mixing .",
    "likewise , in the case where production dominates , which we discuss below , the rate of increase is determined by the rate at which the created li can be injected into the envelope .",
    "thus the region where the li production and destruction timescales are equal is going to be crucial in determining the evolution of the surface li content .",
    "let us call this the equilibrium point .",
    "we must adequately resolve the region between this point and the convective envelope if we are to follow the li transport accurately .",
    "if the timestep is too long , or the spatial mesh too large , we connect the two regions at a different rate to what they would achieve in reality .",
    "we will define the timescale for mixing from this point to the bottom of the convective envelope as @xmath104 , and we suggest this is used as a typical timestep for the calculation .    to calculate this @xmath104 we note that @xmath105 where @xmath106 is the local mixing velocity and @xmath107 is the mean free path , or mixing length , of the moving parcel of gas .",
    "hence at mass shell @xmath108 we have @xmath109    let @xmath110 be the radial width of each mass shell . then the mixing timescale from shell @xmath108 to the convective envelope is @xmath111 where the sum extends from the current mesh point to the bottom of the convective envelope .",
    "if we write @xmath112 for some real numbers @xmath113 then we get @xmath114 hence we will define our preferred timestep @xmath115 by @xmath116 with the knowledge that we have ignored some constants , but maintained the essence of the physics .",
    "we return to our standard case with @xmath117 and run tests with se - v5.5 using a timestep that is limited by @xmath118 with @xmath119 and @xmath120 .",
    "clearly @xmath121 is related to the @xmath113 above , and we consider that it must be determined empirically .",
    "the results of these tests are shown in figure  [ ftests ] .",
    "we see that we appear to have converged on a solution for all except the case with @xmath122 .",
    "this confirms our claim that the important time is of order @xmath104 and as long as the timestep stays near this value , the solution should be reliable .",
    "note that for these tests we disabled the other timestep criteria ; this means that for the @xmath122 case for example , we continued to use @xmath123 even though we would normally be using a smaller @xmath41 as determined by another condition ( eg @xmath45 , as is normally used in se - v5.5 ) .",
    "hence if a normal timestep condition produces a @xmath41 that is below the critical value , then naturally the solution is reached .",
    "but to be sure of this , we suggest adding a condition that @xmath41 not exceed say @xmath124 .",
    "this should ensure an accurate solution .",
    "we note that the se - v5.5 code solves simultaneously for the burning and mixing , whereas not all codes do this ; e.g. monstar and se - g - v2.3 do not .",
    "hence we perform tests also with monstar , with the result that our timestep is not precisely a multiple of @xmath115 , but is always between 0.5 and 2.0 times the quoted value . ] to check if this affects the preferred choice of @xmath41 .",
    "we anticipate slightly the next section , and perform these tests with our preferred mesh spacing @xmath125 , although as we will show below , this is not crucial .",
    "figure  [ monstardttests ] shows results for @xmath53 ( left ) and @xmath126 ( right ) for various @xmath41 as multiples of @xmath115 .",
    "although the early changes in li content are not dependent on the timestep , a converged solution at later times requires a step no larger than about @xmath127 .",
    "this is about an order of magnitude smaller than required by se - v5.5 and reflects the advantage of a simultaneous solution for the burning and mixing .    to confirm this we repeated the calculations with se - v5.5 with the mixing and burning algorithms decoupled , as is done in many codes , including monstar and se - g - v2.3 .",
    "the results are shown in figure  [ decoupled ] , for tests with timestpes of @xmath118 . clearly to converge on the solution in this case",
    "requires a value of @xmath128 , in agreement with the results from monstar .",
    "we conclude that our critical timestep is verified , but whether one should use a limit of a few @xmath115 or a few @xmath129 depends on the solution scheme for the chemical composition that is used in the code in question .",
    "note also that it is imperative to apply this condition from the start of the thermohaline mixing ; i.e. from the time when a @xmath10 minimum first emerges .",
    "if the timestep is too large initially then we follow a solution that is not appropriate . using a smaller timestep",
    "later just ensures that we accurately follow an incorrect solution branch .",
    "there is no short cut  a small @xmath41 must be used from the start of the thermohaline mixing period .",
    "we also performed tests on the mesh spacing used in the calculations . because the thermohaline mixing is being driven by variations in @xmath10 , which are in turn driven by the burning of @xmath13he , we concentrate on fully resolving variations in the @xmath13he content .",
    "based on experience with such problems , we defined a preferred maximum mass spacing @xmath125 so that the maximum change in the mass fraction of @xmath13he between mesh points is no more than 1% of the maximum value of the @xmath13he abundance throughout the star .",
    "we performed the tests with monstar and the standard model , with @xmath117 and the very sensitive case of @xmath30 .",
    "the results are shown in fig  [ monstardmtests ] , where we have used our preferred timestep of @xmath130 these plots clearly show that if the timestep is short enough , then the mesh spacing is not critical , although it is more important in the @xmath87 case , as may be expected .",
    "but even here , we have to use @xmath131 to produce a significant degradation of the results .",
    "the choices of space and time resolution are in fact related . for a sufficiently poor resolution in one variable",
    "it is unlikely that the correct solution will be recovered for any choice of the other variable .",
    "here we test the interdependence of the spatial and temporal resolution criteria .",
    "again , tests were performed with the monstar code and for the two cases @xmath53 and @xmath87 . for each",
    "we have varied the timestep significantly for two choices of the mesh spacing : @xmath125 and @xmath131 .",
    "let us first examine the case for @xmath53 and @xmath125 , as shown in the left panel of figure  [ monstardttests ] .",
    "clearly the solution converges as the timestep is lowered , and with a maximum @xmath132 we believe we have essentially found the solution . with larger timesteps",
    "we obtain values that are quite different to the true solution , although the variations are not large until we begin producing li toward the tip of the rgb ( see  [ seclirise ] for a discussion of this phenomenon ) . for the case with @xmath30 in the right panel of figure  [ monstardttests ] the runs with larger @xmath41 are clearly wrong , with large discontinuities produced in the surface li abundance . as the timestep",
    "is decreased however we again appear to converge on a solution .",
    "we now wish to determine how sensitive is this result to the mesh spacing .",
    "hence we repeat the two tests above , but using a maximum mesh spacing of @xmath133 , as shown in figure  [ monstardttests100 dm ] .",
    "firstly we look at the left panel , for @xmath117 . again , as we decrease the timesteps the solution converges .",
    "what is interesting however is the red line , which is the converged solution using a mesh spacing that is 100 times smaller .",
    "this solution with @xmath134 matches the converged solution , even for the case with @xmath133",
    ". i.e. the thin red line and the thin black line are essentially the same .",
    "this tells us that it is the timestep that is by far the most important parameter in finding the solution to this problem .",
    "provided the timestep is small enough , the mesh spacing is not critical , to within relatively large factors .",
    "the same thing is seen in the right panel , for @xmath30 . here , with the larger timesteps there are discontinuities and large changes in the solution .",
    "decreasing the timesteps removes the erratic behaviour and produces a smooth solution .",
    "here again the red curve is the solution using 100 times smaller mesh spacing . in this more sensitive case",
    "there is still a difference between the solutions for the smallest timestep , so we conclude that in the extreme cases the mesh spacing is indeed important , although the crucial thing to be concerned with is the timestep chosen .",
    "the mesh spacing is important but not as critical , except in the most strongly mixed cases .                finally , to check that our preferred mesh and time spacing works , we show in figure  [ converged ] the results for @xmath53 and @xmath87 using both monstar and se - v5.5 .",
    "both codes use @xmath135 , while se - v5.5 uses @xmath136 and monstar uses @xmath132 , as determined earlier . we see that they do in fact agree sufficiently , and thus verify that the critical solution mesh proposed in this paper is suitable for calculations of the behaviour of li during the rgb phase , in different evolution codes .",
    "we have not tested our proposed solution mesh in the stars code .",
    "this code uses an elegant implicit method to solve for its preferred solution mesh .",
    "this does not lend itself to the sort of tests and controls we derived here , so we do not try to apply them to this code . nor have we implemented our preferred mesh in mesa .",
    "we have instead shown that our suggested solution mesh works well in two totally independent codes .",
    "we advise anyone who is interested in calculating thermohaline mixing of li to perform tests of the code being used , guided by our preferred @xmath115 and @xmath125 .",
    "we have seen that the models show a tendency to produce li as they get near to the tip of the giant branch . this tendency is stronger as @xmath22 increases , being essentially absent when @xmath86 but almost universal when @xmath87 ( the only exception being for the se - g - v2.3 code ) .",
    "our aim in this section is to understand why this happens .",
    "that deep - mixing can produce li is not a new result , having been discussed extensively by @xcite .",
    "the question is how and why do our models change from efficient destruction of li early on the rgb to efficient production later on the rgb .",
    "we defer to a companion paper ( church et al 2014 , in preparation ) the question about whether real stars behave this way ; our emphasis here is on the accurate solution of the numerical problem rather than a test of its applicability .    here",
    "we look at the case with @xmath30 since this is where the li production appears most easily .",
    "we show the results from se - v5.5 in figure  [ phases ] and identify three phases of the evolution . in phase  1",
    "we see a decrease in the envelope li content , which reaches a minimum at phase  2 , and then during phase  3 the li increases again .",
    "the left , middle and right panels in figure  [ lirise ] correspond to the three models denoted by asterisks in figure  [ phases ] .",
    "the upper panels show three timescales :    * @xmath137 ( blue line ) which is the timescale for the production of li , which is also the timescale for the destruction of be ( since the rate of proton capture on be is negligible ) ; * @xmath138 ( red line ) which is the timescale for the destruction of li ; * @xmath139 ( black line ) which is the timescale for the matter to diffuse from the given position to the bottom of the convective envelope ;    and the lower panels show the abundance profiles of @xmath140li , @xmath140be and @xmath13he",
    ".    in the bottom left panel we show the situation typical of phase  1 .",
    "the li content in the convective envelope ( shown hashed ) is higher than in the interior and li will diffuse inward . just below the envelope",
    "we see a region where the production of li is much faster than the destruction timescale",
    ". however this production is negligible compared to the amount of li transported from the envelope reservoir . the production and mixing contribute mostly to filling in the little dip in li seen at @xmath141 . a little further interior",
    "we see that li destruction is the dominant process , and indeed it is the transport of li from the surface into this region that leads to a reduction in its surface abundance .",
    "note that there is a region of enhanced be which is produced by @xmath100 captures on he .",
    "the destruction of be is only efficient at the very bottom of the thermohaline region ( @xmath142 ) where we see a decrease in the he be abundance profiles . as the other panels show , overall the be content increases during the rise up the rgb .    in the middle panel",
    "the li profile has flattened , and hence the diffusion inward must cease .",
    "we have reached a local extremum ( minimum ) in the surface li abundance . from the upper middle panel",
    "we see that the nuclear timescales have hardly changed , whereas the mixing timescale has shortened compared to phase  1 .",
    "we also see the be start to diffuse outward from where it was produced .",
    "this decrease in the mixing timescale continues into phase  3 , as shown in the right top panel .",
    "now the increase in be below the envelope results in a production of li in this region due to electron capture reactions .",
    "li is produced in the region at @xmath143@xmath83 , and it is efficiently transported into the envelope causing the surface li content to rise .    in summary ,",
    "the main change in the structure as the star ascends the rgb is that the diffusion becomes much quicker , allowing the be to escape from where it is produced .",
    "this is the classical cameron - fowler mechanism in operation .",
    "it remains for us to understand why the mixing timescale decreases as the model ascends the rgb .",
    "the mixing timescale is just the time taken to diffuse from a given radius to the bottom of the envelope .",
    "this is the sum of the terms @xmath144 for each shell across the region , emphasizing again the reason why we have plotted our graphs against radius instead of mass .",
    "the spatial extent of this region stays essentially the same , as shown in figure  [ lirise ] .",
    "( importantly , the mass in this region decreases from @xmath145through @xmath146to @xmath147for the three models shown in figure  [ lirise ] . )",
    "hence we expect that @xmath67 increases as the star ascends the rgb , and this is indeed what we find , as shown in figure  [ drise ] .",
    "the expression for @xmath67 is given in equation  ( 1 ) .",
    "we have investigated each term in this expression for @xmath67 to determine which is responsible for the increase .",
    "the dominant term is easily the thermal diffusivity @xmath15 , and within @xmath15 the largest change is due to the decrease in density as the star expands along the rgb .",
    "this can be understood as altering the fundamental physical structure of the region . as the thermal diffusivity increases then the heat can be transported very easily , making the material with a lower @xmath10 even more buoyant , and increasing the diffusive motions .",
    "in fact any changes that result in an expansion in this region would act to favour li production . since the strength of the hydrogen burning shell scales directly with the initial cno abundance",
    ", we would expect that li production would be more favoured in higher metallicity stars .",
    "lithium continues to cause problems for many branches of astrophysics . at the very least",
    "we need to understand how it behaves in stars .",
    "we have seen in this paper that even within the constraints of a well defined mathematical model for diffusive mixing we find dramatically different behaviours due to the high sensitivity of li to physical conditions in the star .",
    "we find that although the dominant effect of thermohaline mixing is to decrease the stellar surface content of li on the rgb , the cameron - fowler mechanism can operate near the tip of the rgb for sufficiently high values of the parameter @xmath22 that appears in the 1d diffusion theory for thermohaline mixing . further ,",
    "unless sufficient care is taken in the integration of the diffusion equation and the structure equations , one can easily find envelope lithium abundances that differ from a resolved solution by orders of magnitude .",
    "we present criteria to be used for determining the timesteps and spatial resolution needed for an accurate solution of the li content during thermohaline mixing .",
    "these criteria can be summarised as :    1 .",
    "the timestep @xmath41 should satisfy @xmath148 where the sum is taken from the point where the li production and destruction timescales are equal , to the bottom of the convective envelope ; @xmath149 is suitable for an implicit and simultaneous solution of burning and mixing , but if these processes are calculated separately then @xmath150 is required ; 2 .",
    "the spatial mesh spacing @xmath151 should be no larger than will permit a change in the @xmath13he abundance of a few percent of the maximum @xmath13he value in the model .    of these",
    ", the timestep criterion is the most important , in that if the behaviour is resolved in time then the spatial mesh is not crucial , except for higher values of @xmath22 .",
    "we show that by using these criteria we find the results produced by two totally independent codes are in agreement",
    ". it would be prudent for anyone interested in this problem to perform similar tests with the code they will be using , guided by our recommended mesh spacings .    finally we note that any mechanism that will determine the composition of fragile elements like li is likely to be very sensitive to numerical details of the kind discussed here .",
    "hence an analysis similar to that performed here would be wise when investigating any other proposed mechanism , especially one that has feedback between the composition profile and the details of the mixing .",
    "this research was supported under australian research council s discovery projects funding scheme ( project numbers dp0877317 , dp1095368 and dp120101815 ) . rpc is supported by the swedish research council ( grants 2012 - 2254 and 2012 - 5807 ) .",
    "rjs is the recipient of a sofja kovalevskaja award from the alexander von humboldt foundation .",
    "l.s . is research associate at the f.r.s .- fnrs ."
  ],
  "abstract_text": [
    "<S> in recent years much interest has been shown in the process of thermohaline mixing in red giants . in low and intermediate mass stars </S>",
    "<S> this mechanism first activates at the position of the bump in the luminosity function , and has been identified as a likely candidate for driving the slow mixing inferred to occur in these stars . </S>",
    "<S> one particularly important consequence of this process , which is driven by a molecular weight inversion , is the destruction of lithium . </S>",
    "<S> we show that the degree of lithium destruction , or in some cases production , is extremely sensitive to the numerical details of the stellar models . within the standard 1d diffusion approximation to thermohaline mixing </S>",
    "<S> , we find that different evolution codes , with their default numerical schemes , can produce lithium abundances that differ from one another by many orders of magnitude . </S>",
    "<S> this disagreement is worse for faster mixing . </S>",
    "<S> we perform experiments with four independent stellar evolution codes , and derive conditions for the spatial and temporal resolution required for a converged numerical solution . </S>",
    "<S> the results are extremely sensitive to the timesteps used . </S>",
    "<S> we find that predicted lithium abundances published in the literature until now should be treated with caution .    </S>",
    "<S> stars :  evolution , stars :  interiors , diffusion , hydrodynamics , instabilities , stars :  abundances </S>"
  ]
}