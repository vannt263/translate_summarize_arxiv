{
  "article_text": [
    "the upper bound @xmath2 on the number of palindromes occurring in a finite word @xmath3 given by x.  droubay , j.  justin , and g.  pirillo in @xcite initiated many interesting investigations on palindromes in infinite words as well .",
    "an infinite word for which the upper bound is attained for any of its factors is called rich or full . there",
    "exist several characterizations of rich words based on the notion of complete return words  @xcite , on the longest palindromic suffix and prefix of a factor  @xcite , on the palindromic and factor complexity  @xcite and most recently on the bilateral orders of factors  @xcite .",
    "brlek et al .",
    "suggested in @xcite to study the defect of a finite word @xmath3 defined as the difference between the upper bound @xmath2 and the actual number of palindromes contained in @xmath3 .",
    "the defect of an infinite word is then defined as the maximal defect of a factor of the infinite word . in this convention ,",
    "rich words are precisely the words with zero defect . in this paper",
    "we focus on uniformly recurrent words with finite defect .",
    "let us point out that periodic words with finite defect have been already described in  @xcite and in  @xcite . in section 2",
    "we introduce notation and summarize known results on rich words and words with finite defect . in section 3 the notion of oddities and the characterization of uniformly recurrent words with finite defect based on oddities from  @xcite is recalled and , as an immediate consequence , two more useful characterizations are deduced .",
    "the main result is a  new characterization of uniformly recurrent words with finite defect based on a  relation between the palindromic and factor complexity , see theorem  [ paladefect ] in section 4 .",
    "furthermore , we introduce a  class of morphisms @xmath0 closed under composition of morphisms and we show that a  uniformly recurrent word with finite defect is an image of a  rich word under a morphism of class @xmath0 , see theorem  [ obraz ] in section 5 . this class is closely related to the well - known class @xmath1 defined by hof , knill , and simon in  @xcite ; every morphism from @xmath0 is conjugate to a  morphism of class @xmath1 .",
    "by @xmath4 we denote a  finite set of symbols , usually called _",
    "letters _ ; the set @xmath4 is therefore called an _ alphabet_. a finite string @xmath5 of letters of @xmath4 is said to be a  _ finite word _ , its length is denoted by @xmath6 .",
    "finite words over @xmath4 together with the operation of concatenation and the empty word @xmath7 as the neutral element form a  free monoid @xmath8 .",
    "the map @xmath9 is a bijection on @xmath8 , the word @xmath10 is called the _ reversal _ or the _ mirror image _ of @xmath3 .",
    "a  word @xmath3 which coincides with its mirror image is a  _",
    "palindrome_.    under an _ infinite word _",
    "we understand an infinite string @xmath11 of letters from @xmath4 .",
    "a  finite word @xmath3 is a  _ factor _ of a  word @xmath12 ( finite or infinite ) if there exist words @xmath13 and @xmath14 such that @xmath15 . if @xmath16 , then @xmath3 is said to be a  _ prefix _ of @xmath12 , if @xmath17 , then @xmath3 is a  _ suffix _ of  @xmath12 .",
    "the _ language _ @xmath18 of an infinite word @xmath19 is the set of all its factors .",
    "factors of @xmath20 of length @xmath21 form the set denoted by @xmath22 .",
    "clearly , @xmath23 .",
    "we say that the language @xmath18 is _ closed under reversal _ if @xmath18 contains with every factor @xmath3 also its reversal @xmath10 .    for any factor @xmath24 , there exists an index @xmath25 such that @xmath3 is a prefix of the infinite word @xmath26 .",
    "such an index is called an _ occurrence _ of @xmath3 in @xmath19 . if each factor of @xmath20 has infinitely many occurrences in @xmath19 , the infinite word @xmath20 is said to be _",
    "recurrent_. it is easy to see that if the language of @xmath19 is closed under reversal , then @xmath19 is recurrent ( a  proof can be found in  @xcite ) . for a  recurrent infinite word @xmath19 , we may define the notion of a  _ complete return word _ of any @xmath27 .",
    "it is a  factor @xmath28 such that @xmath3 is a prefix and a suffix of @xmath12 and @xmath3 occurs in @xmath12 exactly twice . under a  _ return word _ of a factor @xmath3",
    "is usually meant a word @xmath29 such that @xmath30 is a complete return word of @xmath3 .",
    "if any factor @xmath31 has only finitely many return words , then the infinite word @xmath19 is called _",
    "uniformly recurrent_. if @xmath19 is a  uniformly recurrent word , we can assign to any @xmath32 the minimal number @xmath33 such that we have for any @xmath34 @xmath35 or equivalently , any piece of @xmath19 which is longer than or equal to @xmath36 contains already all factors of @xmath19 of length @xmath21 .",
    "the map @xmath37 is usually called the _ recurrence function _ of @xmath19 . in particular , any fixed point of a  primitive morphism",
    "is uniformly recurrent , where a  morphism @xmath38 over an alphabet @xmath39 is _ primitive _ if there exists an integer @xmath40 such that for every @xmath41 the @xmath40-th iteration @xmath42 contains all letters of @xmath39 .",
    "the _ factor complexity _ of an infinite word @xmath19 is a  map @xmath43 defined by the prescription @xmath44 . to determine the first difference of the factor complexity",
    ", one has to count the possible extensions of factors of length @xmath21",
    ". a  _ right extension _ of @xmath45 is any letter @xmath46 such that @xmath47 . of course , any factor of @xmath19 has at least one right extension .",
    "a  factor @xmath3 is called _ right special _ if @xmath3 has at least two right extensions . similarly , one can define a  _ left extension _ and a  _ left special _ factor .",
    "we will deal only with recurrent infinite words @xmath19 . in this case ,",
    "any factor of @xmath20 has at least one left extension .",
    "we say that @xmath3 is a  _ bispecial _ factor if it is right and left special .",
    "in our article we focus on words in some sense opulent in palindromes , therefore we will introduce several notions connected with palindromic factors .",
    "the _ defect _ @xmath48 of a  finite word @xmath3 is the difference between the utmost number of palindromes @xmath49 and the actual number of palindromes contained in @xmath3 .",
    "finite words with zero defects  called _ rich _ words  can be viewed as the most saturated by palindromes .",
    "this definition may be extended to infinite words as follows .",
    "an infinite word @xmath50 is called _ rich _ , if for any index @xmath51 the prefix @xmath52 of length @xmath21 contains exactly @xmath53 different palindromes .",
    "we keep here the terminology introduced by glen et al . in  @xcite in 2007 , which seems to us to be prevalent nowadays",
    ". however , brlek et al . in  @xcite",
    "baptized such words full already in 2004 .",
    "let us remark that not only all prefixes of rich words are rich , but also all factors are rich .",
    "a result from  @xcite will provide us with a  handful tool which helps to evaluate the defect of a factor .",
    "[ lps ] a finite or infinite word @xmath20 is rich if and only if the longest palindromic suffix of @xmath3 occurs exactly once in @xmath3 for any prefix @xmath3 of @xmath20 .",
    "the longest palindromic suffix of a factor @xmath3 will occur often in our considerations , therefore we will denote it by @xmath54 . in accordance with the terminology introduced in @xcite , the factor with a  unique occurrence in another factor is called _",
    "unioccurrent_. from the proof of the previous proposition directly follows the next corollary .",
    "[ kolikunioccurent ] the defect @xmath48 of a  finite word @xmath3 is equal to the number of prefixes @xmath55 of @xmath3 , for which the longest palindromic suffix of @xmath55 is not unioccurrent in @xmath55 .",
    "this corollary implies that @xmath56 whenever @xmath3 is a  factor of @xmath12 .",
    "it enables to give a  reasonable definition of the defect of an infinite word ( see  @xcite ) .",
    "the defect of an infinite word @xmath57 is the number ( finite or infinite ) @xmath58    let us point out several facts concerning defects that are easy to prove :    1 .",
    "if we consider all factors of a  finite or an infinite word @xmath20 , we obtain the same defect , i.e. , @xmath59 2 .   any infinite word with finite defect",
    "contains infinitely many palindromes .",
    "infinite words with zero defect correspond exactly to rich words .",
    "periodic words with finite defect have been studied in  @xcite and in  @xcite .",
    "it holds that the defect of an infinite periodic word with the minimal period @xmath3 is finite if and only if @xmath60 , where both @xmath13 and @xmath61 are palindromes . in @xcite words with finite defect",
    "have been baptized _ almost rich _ and the richness of a  word was described using complete return words .",
    "[ returnrich ] an infinite word @xmath19 is rich if and only if all complete return words of any palindrome are palindromes .    the authors of  @xcite who were the first ones to tackle this problem showed that sturmian and episturmian words are rich . in  @xcite ,",
    "an insight into the richness of periodic words can be found .",
    "the number of palindromes of a  fixed length occurring in an infinite word is measured by the so called _ palindromic complexity _",
    "@xmath62 , a  map which assigns to any non - negative integer @xmath21 the number @xmath63 the palindromic complexity is bounded by the first difference of factor complexity .",
    "the following proposition is proven in @xcite for uniformly recurrent words , however the uniform recurrence is not needed in the proofs , thus it holds for any infinite words with language closed under reversal .",
    "[ bamape ] let @xmath20 be an infinite word with language closed under reversal .",
    "then @xmath64 for all @xmath51 .",
    "it is shown in @xcite that this bound can be used for the characterization of rich words as well .",
    "the following proposition states this fact .",
    "[ rich_pal ] an infinite word @xmath19 with language closed under reversal is rich if and only if the equality in holds for all @xmath51 .",
    "the most recent characterization of rich words given in @xcite exploits the notion of the bilateral order @xmath65 of a factor and the palindromic extension of a  factor .",
    "the bilateral order was introduced in @xcite as @xmath66 the set of palindromic extensions of a palindrome @xmath67 is defined by @xmath68 .",
    "[ bw_a_pext ] an infinite word @xmath19 with language closed under reversal is rich if and only if any bispecial factor @xmath3 satisfies :    * if @xmath3 is non - palindromic , then @xmath69 , * if @xmath3 is a palindrome , then @xmath70",
    "uniformly recurrent words with finite defect are characterized using the notion of oddities in proposition 4.8 from  @xcite .",
    "it is based on the following lower bound .    for any infinite word",
    "@xmath20 it holds @xmath71    the set @xmath72 is called an _",
    "oddity_. it is clear that for uniformly recurrent words with a  finite number of distinct palindromes , the defect is infinite , however the number of oddities is finite .",
    "moreover , even for uniformly recurrent words with infinitely many palindromes , it can hold @xmath73 we take an example for this situation from  @xcite .",
    "let @xmath74 , where @xmath75 denotes an infinite repetition , then @xmath76 , but the number of oddities is equal to  @xmath77 .",
    "however , the defect of an aperiodic word can also exceed the number of oddities .",
    "for instance , if we replace in example  [ finite_defect ] the substitution @xmath78 with @xmath79 , then it is easy to show that @xmath80 , but the number of oddities is 3 .",
    "we can now recall the characterization of words with finite defect based on oddities .",
    "[ oddities_defect ] a  uniformly recurrent word @xmath20 has infinitely many oddities if and only if @xmath20 contains infinitely many palindromes and @xmath81 .    as an immediate consequence of proposition  [ oddities_defect ]",
    ", we obtain the following characterizations of infinite words with finite defect .",
    "[ vsechno ] let @xmath19 be a uniformly recurrent word containing infinitely many palindromes .",
    "then the following statements are equivalent :    1 .",
    "@xmath82 , 2 .",
    "@xmath20 has a  finite number of oddities , 3 .",
    "there exists an integer @xmath83 such that all complete return words of any palindrome from @xmath84 of length at least @xmath83 are palindromes , 4 .",
    "there exists an integer @xmath85 such that for any prefix @xmath86 of @xmath19 with @xmath87 the longest palindromic suffix of @xmath86 is unioccurrent in @xmath86 .    and _ 2 .",
    "_ are equivalent by proposition  [ oddities_defect ] .",
    "it follows directly from the definition of oddities that _ 2 . _ and _ 3 . _",
    "are equivalent .",
    "corollary  [ kolikunioccurent ] implies that _ 1 . _ and _ 4 . _",
    "are equivalent .",
    "it is easy to see that the last statement of theorem  [ vsechno ] can be equivalently rewritten as : there exists an integer @xmath85 such that for any factor @xmath86 of @xmath19 with @xmath87 the longest palindromic suffix of @xmath86 is unioccurrent in @xmath86 .",
    "let us stress that if we put in the previous theorem @xmath88 , the points _ 1 .",
    "_ , and _ 4 .",
    "_ become known results on rich words , see propositions  [ returnrich ] and  [ lps ] .    [ finite_defect ]",
    "let us provide an example of a  uniformly recurrent word @xmath20 with finite defect and let us find for @xmath20 the lowest values of constants @xmath83 and @xmath85 from theorem  [ vsechno ]",
    ". take the fibonacci word @xmath89 , i.e. , the fixed point of @xmath90 .",
    "define @xmath20 as its morphic image @xmath91 , where @xmath92 .",
    "it is easy to show that all palindromes of length greater than @xmath93 and the palindromes @xmath94 , @xmath95 , and @xmath96 have only palindromic complete return words .",
    "hint : long palindromes in @xmath97 contains in their center images of non - empty palindromes from @xmath89 that have palindromic complete return words by the richness of @xmath89 .",
    "the only non - palindromic complete return of @xmath98 is @xmath99 , thus there is exactly one oddity @xmath100 . in order to show that @xmath101 , it suffices to verify that no prefixes longer than @xmath99 have @xmath98 as their longest palindromic suffix .",
    "this follows directly from the form of @xmath78 .",
    "the lowest values of the constants @xmath83 and @xmath85 are : @xmath102 , @xmath103 .",
    "the aim of this section is to prove the following new characterization of infinite words with finite defect based on a  relation between the palindromic and factor complexity .",
    "[ paladefect ] let @xmath19 be a  uniformly recurrent word .",
    "then @xmath104 if and only if there exists an integer @xmath105 such that @xmath106 holds for all @xmath107 .",
    "notice that if we set @xmath108 in the previous theorem , then we obtain the known characterization of rich words from proposition  [ rich_pal ] ( which holds even under a  weaker assumption that @xmath109 is closed under reversal ) .    in the sequel , we will prove two propositions that together with the equivalent characterizations of words with finite defect from theorem  [ vsechno ] imply theorem  [ paladefect ] .",
    "as we have already mentioned , all words with language closed under reversal satisfy the inequality in proposition  [ bamape ] .",
    "a  direct consequence of its proof given in @xcite is a  necessary and sufficient condition for the equality in  . to formulate this condition in lemma [ tree ] ,",
    "we introduce two auxiliary notions .",
    "let @xmath20 be an infinite word with language closed under reversal and let @xmath21 be a given positive integer .",
    "an _ @xmath21-simple path _",
    "@xmath110 is a factor of @xmath20 of length at least @xmath53 such that the only special ( right or left ) factors of length @xmath21 occurring in @xmath110 are its prefix and suffix of length @xmath21 .",
    "if @xmath3 is the prefix of @xmath110 of length @xmath21 and @xmath12 is the suffix of @xmath110 of length @xmath21 , we say that the @xmath21-simple path @xmath110 starts in @xmath3 and ends in @xmath12 .",
    "we will denote by @xmath111 an undirected graph whose set of vertices is formed by unordered pairs @xmath112 such that @xmath113 is right or left special .",
    "we connect two vertices @xmath112 and @xmath114 by an unordered pair @xmath115 if @xmath110 or @xmath116 is an @xmath21-simple path starting in @xmath3 or @xmath10 and ending in @xmath12 or @xmath117 .",
    "note that the graph @xmath111 may have multiple edges and loops .    [ tree ]",
    "let @xmath20 be an infinite word with language closed under reversal .",
    "the equality in holds for an integer @xmath118 if and only if both of the following conditions are met :    1 .",
    "[ prvni ] the graph @xmath111 after removing loops is a tree .",
    "[ druha ] any @xmath21-simple path forming a  loop in the graph @xmath111 is a palindrome .",
    "[ pal_k ] let @xmath19 be an infinite word with language closed under reversal .",
    "suppose that there exists an integer @xmath105 such that for all @xmath119 the equality @xmath120 holds .",
    "then the complete return words of any palindromic factor of length @xmath107 are palindromes .",
    "assume the contrary : let @xmath121 be a  palindrome with @xmath122 and let @xmath12 be its complete return word which is not a  palindrome .",
    "clearly @xmath123 .",
    "then there exist a  factor @xmath86 ( possibly empty ) and two different letters @xmath124 and @xmath125 such that @xmath126 .",
    "let us consider the graph @xmath111 , where @xmath21 is the length of the factor @xmath127 , i.e. , @xmath107 .",
    "since the language of @xmath128 is closed under reversal , the factor @xmath3 is right special - the letters @xmath124 and @xmath125 belong to its right extensions .",
    "if the complete return word @xmath12 contains no other right or left special factors , then the non - palindromic @xmath12 is an @xmath21-simple path which starts in @xmath129 and ends in @xmath130 - a  contradiction with the condition  _ 2 . _ in lemma  [ tree ] .",
    "let @xmath12 contain other left or right special factors of length @xmath21 .",
    "we find the prefix of @xmath12 which is an @xmath21-simple path .",
    "this simple path starts in @xmath3 , its ending point is a special factor , we denote it by @xmath131 .",
    "since @xmath12 is a  complete return word of @xmath13 , we have @xmath132 .",
    "so in the graph @xmath111 , the vertices @xmath133 and @xmath134 are connected with an edge .",
    "similarly , we find the suffix of @xmath12 which is an @xmath21-simple path and we denote its starting point by @xmath135 , its ending point is @xmath10 .",
    "again , @xmath136 and the vertices @xmath137 and @xmath138 are connected with an edge .",
    "so in @xmath111 we have a  path with two edges which connects @xmath134 and @xmath139 and the vertex @xmath137 is its intermediate vertex .",
    "the special factors @xmath131 and @xmath135 are factors of @xmath140 , it means that in the graph @xmath111 there exists a walk , and therefore a path as well , between the vertices @xmath134 and @xmath138 which does not use the vertex @xmath112 .    finally ,",
    "if @xmath134 and @xmath138 coincide , then we have in @xmath111 a multiple edge between @xmath141 and @xmath142 .",
    "if @xmath143 , then in @xmath111 we have two different paths connecting @xmath134 and @xmath139 . together , @xmath111 is not a tree after removing loops - a  contradiction with the condition  _ 1 . _ in lemma  [ tree ] .",
    "[ alternace ] let @xmath19 be an infinite word whose language is closed under reversal .",
    "let @xmath19 have the following property : there exists an integer @xmath85 such that for any factor @xmath144 with @xmath87 the longest palindromic suffix of @xmath86 is unioccurrent in @xmath86 .",
    "let @xmath3 be a non - palindromic factor of @xmath19 with @xmath145 and @xmath12 be a palindromic factor of @xmath19 with @xmath146 .",
    "then    * occurrences of @xmath3 and @xmath10 in @xmath19 alternate , i.e. , any complete return word of @xmath3 contains the factor @xmath10 , * any factor @xmath110 of @xmath19 with a prefix @xmath3 and a suffix @xmath10 , which has no other occurrences of @xmath3 and @xmath10 , is a  palindrome , * any complete return word of @xmath12 is a  palindrome .    consider a  non - palindromic factor @xmath3 such that @xmath145 .",
    "let @xmath86 be a complete return word of @xmath3 .",
    "since @xmath147 , its complete return word satisfies @xmath148 .",
    "according to the assumption , @xmath149 , the longest palindromic suffix of @xmath86 , is unioccurrent in @xmath86 .",
    "its length satisfies necessarily @xmath150 - otherwise a contradiction with the unioccurrence of @xmath149 .",
    "clearly , the palindrome @xmath149 has a suffix @xmath3 and thus a prefix @xmath10 , i.e. , the complete return word @xmath86 of @xmath3 contains @xmath10 as well .",
    "moreover , we have proven that any factor @xmath110 , which has a  prefix @xmath10 and a  suffix @xmath3 and which has no other occurrences of @xmath3 and @xmath10 , is the longest palindromic suffix of a  complete return word of @xmath3 , therefore @xmath151 , i.e. , the factor @xmath110 is a  palindrome .",
    "consider a  palindromic factor @xmath12 , its complete return word @xmath86 and the longest palindromic suffix of @xmath86 . since @xmath12 is a  palindromic suffix of @xmath86 , necessarily @xmath152 .",
    "as @xmath153 , @xmath149 is unioccurrent in @xmath86 .",
    "hence , @xmath154 .",
    "if @xmath149 is shorter than the whole @xmath86 , then the complete return word @xmath86 contains at least three occurrences of @xmath3 - a contradiction .",
    "thus , @xmath155 , i.e. , @xmath86 is a  palindrome .",
    "[ h_pal ] let @xmath19 be an infinite word whose language is closed under reversal .",
    "let @xmath19 have the following property : there exists an integer @xmath85 such that for any factor @xmath144 with @xmath87 the longest palindromic suffix of @xmath86 is unioccurrent in @xmath86 .",
    "then @xmath156    we have to show that both conditions of lemma  [ tree ] are satisfied for any @xmath157 .",
    "+ the condition  _ 1 .",
    "_ : let @xmath112 and @xmath158 be two distinct vertices in the graph @xmath111 , where @xmath159 .",
    "we say that an unordered couple @xmath160 is a  _ realization _ of a path between these two vertices if    * either the factor @xmath86 or the factor @xmath161 has the property : @xmath3 or @xmath10 is its prefix and @xmath12 or @xmath117 is its suffix , * there exist indices @xmath162 such that either the factor @xmath86 or the factor @xmath161 coincides with the factor @xmath163 and factors @xmath3 , @xmath10 , @xmath12 , and @xmath117 do not occur in @xmath164 .",
    "the number @xmath25 is called an _",
    "index _ of the realization @xmath165 .",
    "since @xmath19 is recurrent , there exists at least one realization for any pair of vertices @xmath112 and @xmath166 and any realization has infinitely many indices .",
    "consider a realization @xmath160 and its index  @xmath25 .",
    "wlog @xmath167 and @xmath3 is a prefix of @xmath86 and @xmath12 a suffix of @xmath86 .",
    "since @xmath19 is recurrent , we can find the smallest index @xmath168 such that @xmath169 has a suffix @xmath10 . according to lemma [ alternace ] ,",
    "@xmath170 is a palindrome .",
    "therefore its suffix of length @xmath171 is exactly @xmath161 .",
    "this means that the index @xmath172 is an index of the same realization of a path between @xmath112 and @xmath158 . as the factor @xmath173",
    "does not contain neither the factor @xmath3 nor @xmath10 , no index @xmath174 strictly between @xmath25 and @xmath172 is an index of any realization of a path between @xmath112 and @xmath158 .",
    "we have shown that between any pair of two consecutive indices of one specific realization @xmath175 of a path between @xmath112 and @xmath176 there does not exist any index of any other realization @xmath177 of a path between @xmath112 and @xmath176 .",
    "this means that there exists a  unique realization of a path between @xmath112 and @xmath176 , which implies that in the graph @xmath111 there exists a  unique path between vertices @xmath112 and @xmath176 . since this is true for all pairs of vertices of @xmath111 , the graph @xmath111 after removing loops is a tree .",
    "+ the condition  _ 2 . _ : let @xmath24 be a special factor ( palindromic or non - palindromic ) with @xmath178 .",
    "an @xmath21-simple path @xmath86 starting in @xmath3 and ending in @xmath10 contains according to its definition no other special vertex inside the path , in particular @xmath3 and @xmath10 do not occur inside the path . according to lemma [ alternace ] ,",
    "the path @xmath86 is a palindrome .",
    "it is a  direct consequence of propositions  [ pal_k ] and  [ h_pal ] and of theorem  [ vsechno ] , where the last statement is replaced with an equivalent one : there exists an integer @xmath85 such that for any factor @xmath86 of @xmath19 with @xmath87 the longest palindromic suffix of @xmath86 is unioccurrent in @xmath86 .",
    "in this section , we will define a  new class of morphisms and we will reveal their relation with well - known morphisms of class @xmath1 ( defined in  @xcite ) .",
    "we will show an important role these morphisms play in the description of words with finite defect .",
    "[ def_pret ] we say that a morphism @xmath179 is of class @xmath0 if there exists a palindrome @xmath180 such that    * [ def_pret_1 ] @xmath181 is a palindrome for any @xmath182 , * [ def_pret_2 ] @xmath181 contains exactly @xmath183 occurrences of @xmath13 , one as a prefix and one as a suffix , for any @xmath182 , * [ def_pret_3 ] @xmath184 for all @xmath185 .    [ proppret ] the following properties of the morphisms of class @xmath0 are easy to prove .    1 .   [ vl_pret_1 ] @xmath186 , where @xmath187 , implies @xmath188 , i.e. , @xmath38 is injective , 2 .",
    "[ vl_pret_2 ] @xmath189 for any @xmath190 , 3 .",
    "[ vl_pret_3 ] @xmath191 is a palindrome if and only if @xmath192 is a palindrome .",
    "hint for the proof of the injectivity : if @xmath186 , then @xmath193 .",
    "this implies @xmath194 by induction on @xmath195 : the assertion is true for @xmath196 ( i.e. , @xmath197 , since the morphism @xmath38 is not erasing from the second point of definition  [ def_pret ] ) from the third point of definition  [ def_pret ] ; the induction is then proven using the second point of definition  [ def_pret ] .",
    "another class of morphisms closely related to defects is _ standard ( special ) morphisms of class @xmath1 _ defined in  @xcite .",
    "we will reveal their connection with @xmath0 in section  [ comments ] .",
    "the class @xmath0 is closed under the composition of morphisms , i.e. , for any @xmath198 we have @xmath199 ( if the composition is well defined ) .",
    "let @xmath200 and @xmath201 be the corresponding palindromes from the definition of @xmath0 of the morphisms @xmath38 and @xmath78 , respectively . then @xmath202 is a  palindrome by point _ ( 3 ) _ of remark  [ proppret ] for @xmath38 .",
    "it suffices to verify that @xmath203 plays the role of the palindrome @xmath13 for the morphism @xmath204 .    *",
    "take @xmath95 a letter .",
    "we have @xmath205 we obtain the following equalities using firstly point _ ( 2 ) _ of remark  [ proppret ] for @xmath38 and then for @xmath78 : @xmath206 i.e. , @xmath207 is a  palindrome for all @xmath95 .",
    "* since @xmath208 , there is a  one - to - one correspondence between the occurrences of @xmath209 in @xmath210 and the occurrences of @xmath211 in @xmath212 .",
    "as @xmath213 , the word @xmath212 contains @xmath211 only as a  prefix and as a  suffix .",
    "therefore @xmath214 has only two occurrences of @xmath215 - as a  prefix and as a  suffix . *",
    "the injectivity of @xmath38 and @xmath78 clearly guarantees that @xmath216 for all @xmath217 .    in @xcite another class of morphisms is defined .",
    "we say that a  morphism @xmath38 is of class @xmath1 if there exist a  palindrome @xmath13 and for every letter @xmath94 a  palindrome @xmath218 such that @xmath219 .",
    "the interest of the class @xmath1 has been awoken by the following question stated ibidem ( however formulated in terms of dynamical systems ) : `` given a  fixed point of a  primitive morphism @xmath38 containing infinitely many palindromes , can we find a  primitive morphism @xmath78 of class @xmath1 such that the factors of a  fixed point of @xmath78 are the same ? ''",
    "let us recall that for any primitive morphism , the languages of all its fixed points are the same .",
    "the previous question has been answered affirmatively in  @xcite for morphisms defined on binary alphabets and in  @xcite for periodic fixed points .    in order to reveal the relation between the classes @xmath1 and @xmath0",
    ", we have to define the conjugation of a  morphism .",
    "a  morphism @xmath78 is said to be _ conjugate _ to a  morphism @xmath38 defined on an alphabet @xmath39 if there exists a  word @xmath220 such that    * either for every letter @xmath221 , the image @xmath222 has @xmath3 as its prefix and the image @xmath223 is obtained from @xmath222 by erasing @xmath3 from the beginning and adding @xmath3 to the end ; we write @xmath224 , * or for every letter @xmath221 , the image @xmath222 has @xmath3 as its suffix and the image @xmath223 is obtained from @xmath222 by erasing @xmath3 from the end and adding @xmath3 to the beginning ; we write @xmath225 .",
    "if @xmath38 is a  morphism of class @xmath0 , then @xmath38 is conjugate to a  morphism of class  @xmath1 .",
    "let @xmath208 and let @xmath13 have the same meaning as in the definition of @xmath0 .",
    "we will write @xmath226 , where @xmath227 and @xmath124 is either the empty word or a letter .",
    "denote by @xmath78 a  morphism defined for all letters @xmath94 as @xmath228 .",
    "thus , @xmath38 is conjugate to @xmath78 .",
    "the word @xmath229 can be written as @xmath230 since @xmath231 is a prefix of @xmath232 . since @xmath233 is a palindrome ,",
    "@xmath234 is a palindrome too .",
    "therefore @xmath235 is a  palindrome and @xmath78 is of class @xmath1 .",
    "the implication can not be reversed .",
    "consider the alphabet @xmath236 and let @xmath237 and @xmath238 .",
    "it is clear that @xmath239 ( for @xmath240 ) , but @xmath38 is not conjugate to any morphism of class @xmath0 ( @xmath241 is not a  complete return word of @xmath94 ) .",
    "the following theorem shows the importance of morphisms of class @xmath0 for uniformly recurrent words with finite defect .",
    "[ obraz ] let @xmath242 be a  uniformly recurrent word with finite defect .",
    "then there exist a  rich word @xmath243 and a  morphism @xmath244 of class @xmath0 such that    @xmath245 the word @xmath246 is uniformly recurrent .    consider a  prefix @xmath247 of @xmath19 of length @xmath248 , where @xmath83 is the constant from theorem  [ vsechno ] and @xmath85 is an integer such that any factor of @xmath19 of length @xmath249 has its longest palindromic suffix unioccurrent .",
    "( let us recall that the existence of @xmath85 is also guaranteed by theorem  [ vsechno ] . ) since the language of @xmath19 is closed under reversal ( this follows from the fact that @xmath20 is uniformly recurrent and contains infinitely many palindromes ) , @xmath250 is a  factor of @xmath19 as well and its @xmath251 has a  unique occurrence in @xmath250 . as @xmath252 any factor shorter than or equal to @xmath83 occurs in @xmath250 at least twice .",
    "therefore , @xmath253 .",
    "hence , @xmath251 is a  palindromic prefix of @xmath19 of length greater than @xmath83 .",
    "denote @xmath254 . since @xmath19 is uniformly recurrent , the set of return words of @xmath13 is finite ,",
    "say @xmath255 is the list of all different return words .",
    "let us define a  morphism @xmath38 on the alphabet @xmath256 by @xmath257 for all @xmath258 .",
    "it is obvious that the morphism belongs to the class @xmath0",
    ". then we can write @xmath259 for some sequence @xmath260 .",
    "let us put @xmath261 .",
    "we will show that any complete return word of any palindrome in the word @xmath246 is a  palindrome as well .",
    "according to this implies the richness of @xmath246 .",
    "let @xmath14 be a  palindrome in @xmath246 and @xmath124 its complete return word .",
    "then @xmath262 has precisely two occurrences of the factor @xmath191 . as @xmath14 is a  palindrome",
    ", @xmath191 is a  palindrome as well of length @xmath263 .",
    "therefore @xmath262 is a  complete return word of a long enough palindrome and according to our assumption @xmath262 is a  palindrome as well .",
    "this together with point _",
    "( 3 ) _ in remark  [ proppret ] implies @xmath264 the point _ ( 2 ) _ then gives @xmath265 as we claimed .",
    "+ the uniform recurrence of @xmath246 is obvious .",
    "the reverse implication does not hold , i.e. , the set of uniformly recurrent words with finite defect is not closed under morphisms of class @xmath0 .",
    "let us provide a  construction of such a  word .",
    "[ ex_rich_na_nekonecno ]    let @xmath266 .",
    "for @xmath267 set @xmath268 , where @xmath269 denotes the shortest palindrome having @xmath3 as a  prefix .",
    "note that @xmath270 is a  prefix of @xmath271 for all @xmath25 .",
    "thus we can set @xmath272 and @xmath89 is uniformly recurrent by construction .",
    "denote by @xmath38 a morphism from @xmath0 defined by @xmath273    as we will show in the sequel , the word @xmath274 is rich and the defect @xmath275 .",
    "[ v_i_rich ] for all @xmath25 the palindrome @xmath271 from example  [ ex_rich_na_nekonecno ] is rich .",
    "we will show for all @xmath25 that @xmath271 is rich and @xmath276 furthermore , we will show that for all letters @xmath124 , the word @xmath277 contains exactly @xmath183 occurrences of @xmath271 and @xmath93 occurrence of @xmath278 .",
    "we will proceed by induction on @xmath25 . for @xmath279 and @xmath183",
    "it is left up to the reader to verify the proposition .",
    "suppose the fact holds for @xmath25 , @xmath280 .",
    "we will show the claim for @xmath281 .",
    "denote by @xmath3 the factor @xmath282 note that since @xmath283 contains exactly @xmath183 occurrences of @xmath284 for all letters @xmath124 , the factor @xmath3 contains exactly @xmath285 occurrences of @xmath284 .",
    "in other words , if we find @xmath93 occurrence of @xmath284 , we know all the other occurrences .",
    ".enumeration of palindromic factors of @xmath3 . [ cols=\"<,>,^,<,^\",options=\"header \" , ]     in we can see the total number of palindromic factors of @xmath3 . let us give a brief explanation for rows which may not be clear at first sight .",
    "let us recall that by the induction assumption @xmath276 since there are exactly @xmath286 occurrences of @xmath270 in @xmath284 , one can easily see that factors in rows @xmath183 , @xmath77 , and @xmath287 have not been counted in row @xmath93 . rows @xmath288 ,",
    "@xmath285 , and @xmath289 exploit the fact that for all letters @xmath124 @xmath277 contains @xmath93 occurrence of @xmath278 .",
    "one can see that the total number of palindromic factors is @xmath290 , therefore @xmath3 is rich from the definition .    as the right palindromic closure preserves the richness",
    ", we can see that @xmath291 is rich .",
    "moreover , since there are exactly @xmath183 occurrences of @xmath271 in @xmath277 for all letters @xmath124 , one can see that the closure will produce the following palindrome @xmath292 take a letter @xmath124 .",
    "we can now rewrite @xmath293 in terms of @xmath284 and see the factor @xmath294 occurs once and @xmath291 occurs twice again arguing by the known count of factors @xmath284 .",
    "the infinite word @xmath274 defined in is rich and @xmath275 , where @xmath38 is also defined in .    directly from the definition of @xmath274 , one can see using the previous lemma that all its prefixes @xmath271 are rich and therefore @xmath274 is rich .",
    "denote by @xmath13 the palindrome from the definition of @xmath0 for the substitution @xmath38 .",
    "one can see that @xmath295 .",
    "take @xmath296 , a factor of @xmath274 .",
    "we have @xmath297 , a factor of @xmath298 . using point _ ( 3 ) _ of remark  [ proppret ] , we can see that @xmath299 is a  palindrome .",
    "now take @xmath300 .",
    "one can see that @xmath301 .",
    "note again the palindromic factor @xmath302 .",
    "we will now look for complete return words of @xmath302 in @xmath303 , where @xmath304 the word @xmath305 is clearly a  factor of @xmath291 , therefore a factor of @xmath274 . the first occurrence of @xmath302 is produced by the factor @xmath296 in @xmath305 .",
    "since @xmath38 is injective , we need to look only at occurrences of @xmath271 in @xmath305 .",
    "the next two occurrences are in the factors @xmath306 and @xmath307 .",
    "one can see that @xmath308 and @xmath309 , i.e. , the factor @xmath302 does not occur in @xmath303 until the factor @xmath310 occurs .",
    "the complete return word of @xmath302 is then @xmath311 . by point _ ( 3 ) _ of remark  [ proppret ] , as @xmath312 is not a  palindrome , neither is the complete return word @xmath313 .",
    "therefore for each @xmath25 we have an oddity @xmath314 . according to",
    ", it implies the defect of @xmath298 is infinite .",
    "the last proposition concludes the counterexample [ ex_rich_na_nekonecno ] .",
    "it is clear that the defect of an image by a morphism of class @xmath0 of a word with finite defect depends on the morphism . as shows ,",
    "it depends also on the original word . to underline this fact we can take the morphism @xmath38 from and @xmath57 the tribonacci word , i.e. , the fixed point of the tribonacci morphism @xmath315 , @xmath316 and @xmath317 - a well - known rich word  @xcite .",
    "it is easy to see that @xmath318 .",
    "at the end of the article @xcite , the authors state several open questions , among them the following one : `` let @xmath319 be a  fixed point of a primitive morphism . if the defect is finite and non - zero , is the word @xmath319 necessarily periodic ? ''",
    "we are not able to answer this question .",
    "the following observation is just a  small comment to it .",
    "let @xmath319 be a fixed point of a primitive morphism and let its defect @xmath320 be finite .",
    "then there exists a rich word @xmath246 and a morphism @xmath208 such that @xmath321 and @xmath246 itself is a fixed point of a primitive morphism as well .",
    "the rich word @xmath246 , which we have constructed in the proof of , is a  derived word , as introduced by durand in @xcite .",
    "lemma 19 of @xcite says that any derived word of a fixed point of a primitive morphism is a fixed point of a primitive morphism as well .",
    "theorem [ obraz ] has the form of implication , which can not be reversed , since example [ ex_rich_na_nekonecno ] demonstrates that a morphism from @xmath0 does not preserve automatically the set of words with finite defect .",
    "it is thus natural to ask :    question 1 : :    is it possible to replace the class @xmath0 with a    smaller one in such a way that theorem [ obraz ] can be stated in the    form of equivalence ?",
    "question 2 : :    which morphisms from @xmath0 do preserve the set of rich    words ?",
    "question 3 : :    how to compute @xmath322 for a rich word    @xmath19 and a morphism from    @xmath208 ?",
    "question 4 : :    is it feasible to characterize morphisms @xmath38 on    @xmath323 with the property that    @xmath324 has finite defect for any infinite    word @xmath325 with finite    defect ?",
    "let us comment question 1 .",
    "the authors of  @xcite define another class of morphisms that play an important role in the study of finite defect .",
    "they call a  morphism @xmath38 on @xmath326 a  _ standard morphism of class @xmath1 _ ( or a  _ standard @xmath1-morphism",
    "_ ) if there exists a  palindrome @xmath327 ( possibly empty ) such that , for all @xmath328 , where the @xmath329 are palindromes .",
    "if @xmath327 is non - empty , then some ( or all ) of the palindromes @xmath329 may be empty or may even take the form @xmath330 with @xmath331 a  proper palindromic suffix of @xmath327 .",
    "they say that a  standard @xmath1-morphism is _ special _ if :    1 .",
    "all @xmath332 end with different letters , and 2 .   whenever @xmath333 , with @xmath334 , occurs in some @xmath335 , then this occurrence is @xmath336 for some @xmath337 with @xmath338 .",
    "they prove the following theorem .",
    "[ special_defect ] if @xmath38 is a  standard special @xmath1-morphism on @xmath326 and @xmath339 , then @xmath340",
    "if and only if @xmath341 .    however , as shown in the following proposition , standard special @xmath1-morphisms are not the only ones that preserve the set of uniformly recurrent words with finite defect , thus the class of standard special morphisms is too small as an answer to question 1 .",
    "let us add that standard special morphisms of class @xmath1 do not form a  subset of morphisms of class @xmath0 .",
    "for instance , @xmath342 is a  standard special @xmath1-morphism with @xmath343 , but does not belong to @xmath0 .",
    "[ binary ] let @xmath57 be a  binary uniformly recurrent word such that @xmath344 is finite .",
    "let @xmath38 be a  morphism of class @xmath0 .",
    "then @xmath345 is finite .",
    "[ conjugate_to_special ] let @xmath38 be a morphism of class @xmath0 on @xmath346 .",
    "then @xmath38 is conjugate to a  standard special @xmath1-morphism .",
    "let @xmath13 be the palindrome corresponding to @xmath38 in the definition of @xmath0 .",
    "denote by @xmath347 the longest common suffix of @xmath348 and @xmath349 .",
    "denote by @xmath350 a word such that @xmath351 is the longest common prefix of @xmath352 and @xmath353 . using properties of @xmath0 we have @xmath354 .",
    "define @xmath355 and @xmath356 .",
    "then @xmath38 is conjugate to @xmath78 and @xmath78 is a  standard special @xmath1-morphism with the corresponding palindrome @xmath357 .    by lemma  [ conjugate_to_special ]",
    "the morphism @xmath38 is conjugate to a  standard special @xmath1-morphism @xmath78 .",
    "clearly , the languages of @xmath358 and @xmath359 are the same , hence @xmath360 .",
    "theorem  [ special_defect ] implies that @xmath361 .",
    "we acknowledge financial support by the czech science foundation grant 201/09/0584 , by the grants msm6840770039 and lc06002 of the ministry of education , youth , and sports of the czech republic , and by the grant sgs10/085ohk4/1t/14 of the grant agency of the czech technical university in prague .",
    "10 j. p. allouche , m. baake , j. cassaigne , d. damanik , palindrome complexity , theoret .",
    "292 ( 2003 ) 9  31 .",
    "p. bali , z. maskov , e. pelantov , factor versus palindromic complexity of uniformly recurrent infinite words , theoret .",
    "380 ( 2007 ) 266  275 .",
    "l@xmath362. balkov , e. pelantov ,  .",
    "starosta , sturmian jungle ( or garden ? ) on multiliteral alphabets , arxiv : 1003.1224 ( 2010 ) , to appear in rairo - theor .",
    "a. blondin - mass , s. brlek , a. garon , s. labb , combinatorial properties of @xmath86-palindromes in the thue - morse sequneces , puma 19 ( 2008 ) 39  52 .",
    "s. brlek , s. hamel , m. nivat , c. reutenauer , on the palindromic complexity of infinite words , in j. berstel , j. karhumki , d. perrin , eds , combinatorics on words with applications , int . j. of found .",
    "15:2 ( 2004 ) 293  306 .",
    "m. bucci , a. de luca , a. glen , l. q. zamboni , a connection between palindromic and factor complexity using return words , adv . in appl .",
    "math 42 ( 2009 ) 60  74 .",
    "m. bucci , a. de luca , a. glen , l. q. zamboni , a new characteristic property of rich words , theoret . comput .",
    "410 ( 2009 ) 2860  2863 . j. cassaigne , complexity and special factors , bull .",
    "belg . math .",
    "simon stevin 4 1 ( 1997 ) 67  88 .",
    "x. droubay , g. pirillo , palindromes and sturmian words , theoret .",
    "223 ( 1999 ) 73  85 .",
    "x. droubay , j. justin , g. pirillo , episturmian words and some constructions of de luca and rauzy , theoret .",
    "255 ( 2001 ) 539  553 .",
    "f. durand , a characterization of substitutive sequences using return words , discrete math .",
    "179 ( 1998 ) 89  101 .",
    "a. glen , j. justin , s. widmer , l. q. zamboni , palindromic richness , eur . j. comb .",
    "30 ( 2009 ) 510  531 .",
    "a. hof , o. knill , b. simon , singular continuous spectrum for palindromic schrdinger operators , comm .",
    "( 1995 ) 149  159 .",
    "b. tan , mirror substitutions and palindromic sequences , theoret .",
    "389 ( 2007 ) 118  124 .",
    "l. vuillon , a  characterization of sturmian words by return words , eur .",
    "22 ( 2001 ) 263  275 ."
  ],
  "abstract_text": [
    "<S> in this paper , we provide a  new characterization of uniformly recurrent words with finite defect based on a  relation between the palindromic and factor complexity . </S>",
    "<S> furthermore , we introduce a  class of morphisms @xmath0 closed under composition and we show that a  uniformly recurrent word with finite defect is an image of a  rich ( also called full ) word under a morphism of class @xmath0 . this class is closely related to the well - known class @xmath1 defined by hof , knill , and simon ; every morphism from @xmath0 is conjugate to a  morphism of class @xmath1 . </S>"
  ]
}