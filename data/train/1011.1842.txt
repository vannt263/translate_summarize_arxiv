{
  "article_text": [
    "let @xmath0 be a linear map of a vector space @xmath1 into itself and let @xmath2 be a vector fin @xmath1 .",
    "the iterations of @xmath0 applied to @xmath3 define an _",
    "orbit _ @xmath4 ,",
    "i.e. the set @xmath5    in the present paper we discuss algorithmic issues related to orbits .",
    "we assume that @xmath1 is a rational coordinate space , so @xmath0 and @xmath3 are represented by their ( rational ) components .    _",
    "an orbit description problem _ consists in finding specific relations which either hold for all vectors in the orbit or are violated by at least one vector in the orbit . here",
    "we limit ourself to a simple case where the relations are formed from boolean combinations of linear equalities and inequalities ( see the exact definition below in section  [ orb&lrs ] ) .",
    "note that the most important case of the orbit problem is _ the chamber hitting problem_. in this particular case we check whether an orbit intersects a closed polyhedron ( i.e. a solution set for a finite system of nonstrict linear inequalities ) .",
    "the orbit description problems are related to some problems on linear recurrent sequences .    _ a linear recurrent sequence _ ( lrs ) @xmath6 of a degree @xmath7 is defined by : @xmath8    the famous skolem problem is perhaps the most known algorithmic problem on linear recurrences .    * the skolem problem .",
    "* let @xmath9 be a specified lrs with integer coefficients .",
    "whether @xmath10 for some @xmath11 ?",
    "the decidability of the skolem problem is presently an open question , but it is known that it is decidable for the degrees @xmath12 ( the cases @xmath13 are worked out by n.  vereshchagin  @xcite , and the case @xmath14 is solved by v.halava  et  al .",
    "@xcite ) .    in the opposite direction ,",
    "the best hardness result on the skolem problem is np - hardness  @xcite .",
    "lrs is called _ nonnegative _ if all its elements are nonnegative .",
    "one more important algorithmic question about lrs is called the _ nonnegativity problem _ and consists in checking nonnegativity of a lrs .",
    "this problem is at least as hard as the skolem problem .",
    "being a bit more formal it means that the skolem problem is turing reducible to the nonnegativity problem .",
    "this statement certainly belongs to the public mind , but see the proof of the statement in section  [ reduction1 ] .",
    "the nonnegativity problem is decidable for lrs of the degree  @xmath15 ( v.  laohakosol , p.  tangsupphathawat  @xcite ) .    in this paper",
    "we often use some standard constructions from the theory of algorithms and the complexity theory , e.g. , turing reducibility , @xmath16-reducibility , polynomial reducibility . in particular",
    ", turing reducibility of a _ problem i _ to _ problem ii _ means that while solving _ problem i _ the reduction may ask an oracle , who can give answers to _ problem ii _ ( see , further  @xcite . )",
    "the relations between the orbit description problems and lrs are described in section  [ orb&lrs ]",
    ".    these results are certainly not new but we include them for completeness sake and in order to introduce necessary notation and terminology .",
    "let briefly sketch the contents of the paper .",
    "we recall basic properties of lrs in section  [ alg - comb ] .",
    "lrs are closely related to regular languages . in particular ,",
    "any lrs can be represented as a _ difference _ of the generating functions of a pair of regular languages ( see , e.g. , ( * ? ? ?",
    "we will use a modification of this result ( see theorem  [ lr->2auto ] from section  [ hcp ] ) .",
    "( all necessary facts about regular languages could be found in  @xcite . )",
    "the main result of the present paper consists in an algorithmic equivalence between the chamber hitting problem and checking a particular property of the regular languages .",
    "namely , the property involved consists in checking whether a regular language contains at least one word from a special set of words .",
    "we call this set a _ permutation filter_. speaking informally , an arbitrary word from the permutation filter gives a permutation of all binary words of a fixed length  @xmath17 .",
    "see a formal statement in section  [ filter ] below .",
    "the permutation filter is denoted by @xmath18 and the corresponding problem of checking this property of regular languages is called @xmath18-realizability problem ( see , section  [ filter ] ) .",
    "the proof of an algorithmic equivalence of a problem of @xmath18-realizability and the chamber hitting problem ( theorem  [ permf = skolem ] from section  [ filter ] ) proceeds in several steps .    at first",
    ", we describe in section  [ hcp ] a polynomial reducibility of the chamber hitting problem to the @xmath19-realizability problem .",
    "the reducibility uses the aforementioned theorem  [ lr->2auto ] .    as a consequence of this result we prove ( see , theorem  [ nphardness ] ) np - hardness of a @xmath18-realizability problem",
    "this result may be of independent interest .    to construct a reduction in the opposite direction , i.e. a reduction of the @xmath18-realizability problem to the chamber hitting problem",
    ", we settle some technical difficulties .",
    "it turns out that a natural construction described in subsection  [ route ] gives a reduction of the @xmath18-realizability problem to the problem of hitting a translate of an integral polyhedral cone represented by generators . to reduce this problem to the problem of hitting a rational cone we use some additional technical tricks and",
    "their description is contained in subsection  [ zhitsubsect ] . as an intermediate step we consider the case of a simplicial cone ( the generating vectors are linear independent ) .",
    "the general case is reduced to the simplicial one using representation of an arbitrary integral cone as a union of a finite set and a finite family of translates of simplicial integral cones ( theorem  [ frobndim ] ) .",
    "this result may be regarded as a sort of an integral caratheodory s theorem .",
    "recall that integral variants of the caratheodory s theorem are actively studied ( see , for instance ,  @xcite ) and have important applications to combinatorial optimization .",
    "finally , in section  [ decid - and - undec ] we present some decidable and undecidable problems closely related to -realizability problem thus demonstrating its ` borderline ' status with respect to computability .",
    "below we remind some algebraic and combinatorial properties of lrs which will be used in the sequel . all needed proofs and references",
    "may be found in  @xcite .",
    "let @xmath20 and @xmath21 be , respectively , a linear operator and a linear function on a vector space @xmath1 and let @xmath22 .",
    "then the generating function @xmath23 is rational .",
    "the generating function of any lrs is rational and taylor s series expansion coefficients of an arbitrary rational function at any point in its domain form a lrs .",
    "the set of lrs is closed under componentwise addition and multiplication ( i.e. under hadamard product of sequences ) .    in the standard",
    "setting , the input to the skolem problem is an integer lrs .",
    "but if we are interested in signs of the elements of lrs involved only , then there is no difference between integral and rational cases .",
    "indeed , let a lrs be specified by rational data and let @xmath24 be the lcm of the denominators of all @xmath25 and @xmath26 .",
    "form an integral lrs @xmath27    [ q->z ] @xmath28 for all @xmath17 .",
    "for @xmath29 the statement follows from the definition  . for @xmath30",
    "we proceed by induction . assuming that the statement holds for all @xmath31 , we get @xmath32 thus the statement holds for @xmath33 .    trivially , using the euclidean algorithm , the identity @xmath34 and by proposition  [ q->z ] we can compute @xmath35 from @xmath6 in time polynomial in the length of the input data . so for algorithmic problems , which are concerned with the signs of lrs elements only , integral and rational cases are equivalent w.r.t .",
    "polynomial reductions .",
    "hereinafter we assume that in algorithmic problems an lrs is represented by the list of coefficients @xmath25 , @xmath36 written in binary .",
    "some lrs are solutions of enumeration problems and for this reason are nonnegative .",
    "for instance , the family of the so called @xmath37-rational sequences coincide with the set of generating functions of regular languages ( see ,  @xcite ) . in the sequel",
    "@xmath37-rational sequences are called _",
    "regular sequences_.    to be more precise , any deterministic automaton @xmath20 over the alphabet @xmath38 defines lrs @xmath39 , where @xmath40 exactly the sequences of the type   will be called regular .",
    "lrs are not regular as they may have negative elements , but nevertheless the following statement holds .",
    "[ diff - th ] any lrs is a difference of two regular sequences .",
    "in this section we state formally the orbit description problem and the related chamber hitting problem , and indicate relations of these problems to lrs .    let @xmath41 be a family of affine functions defined on a coordinate space @xmath42 .",
    "the sign patterns of these functions induce a partition of @xmath42 into chambers .",
    "formally , let @xmath43 .",
    "then _ a chamber _ is a set @xmath44 where @xmath45 is a standard sign function @xmath46    * orbit description problem * ( odp ) .",
    "input : a square matrix @xmath0 of order @xmath7 ; @xmath7-dimensional vector @xmath47 ; a family of affine functions @xmath41 on @xmath42 and a set of sign patterns @xmath48 .",
    "output : ` yes ' if any point of the orbit @xmath49 falls into the union of chambers @xmath50 , and ` no ' otherwise .",
    "we assume that matrices , vectors and affine functions in the odp and all related problems are represented by the component lists , where the components are written in binary .",
    "* chamber hitting problem * ( chp ) has the same input as the odp , but there is one sign pattern @xmath51 only .",
    "the output of chp is ` yes ' if the orbit @xmath49 intersects the chamber @xmath52 and ` no ' otherwise .",
    "[ chp = odp ] is turing - equivalent to .    to reduce the chp to the odp we take the complement in the set @xmath53 to the sign pattern of the chamber in the input of an instance of the chp and fix all other input parameters .",
    "we obtain an instance of the odp that outputs ` yes ' iff the instance of the chp outputs ` no ' .",
    "the reduction in the opposite direction is proved analogously . for any chamber not included in the input list of an instance of the odp we solve the corresponding chp .",
    "all the answers are ` no ' iff the instance of the odp reports ` yes ' .",
    "it is rather obvious that the chp is recursevely enumerable ( belongs to the  class @xmath54 of the arithmetic hierachy ) and the odp is co - enumerable ( belongs to the class @xmath55 ) .",
    "the proof of proposition  [ chp = odp ] shows that these problems are complementary in a broad sense .",
    "another pair of complementary problems is the chamber description problem ( the odp restricted to the case of one chamber ) and the problem of hitting the complement to a chamber .",
    "we do not know reducibilities between the chamber description problem and the chp .",
    "[ skolem = hit1 ] the nonnegativity problem is equivalent to the restricted to one linear function and a nonstrict inequality ( the chambers @xmath56 , @xmath57 ) .    the skolem problem is equivalent to the restricted to one linear function and equality ( the chamber @xmath56 ) .",
    "as is well known the lrs   is related to a linear operator  @xmath20 in the @xmath7-dimensional coordinate space given in matrix notation by @xmath58    it is easy to check by induction that @xmath59    thus , the skolem problem for the lrs   is reduced to the chp with @xmath60 , @xmath61 , @xmath62 and the chamber @xmath63 .",
    "analogously , the nonnegativity problem is reduced to the odp with the same input as above and two chambers @xmath63 , @xmath57 .",
    "the reductions in the opposite direction use standard facts about lrs listed in section  [ alg - comb ] .",
    "indeed , the generating function @xmath64 is rational .",
    "hence , the sequence @xmath65 is an lrs and both reductions follow .",
    "we do nt know whether the general odp and chp can be reduced to , respectively , the nonnegativity problem and the skolem problem , but we can indicate particular cases when such reductions do exist .",
    "* union of subspaces hitting problem * ( shp ) .",
    "input : a square matrix @xmath0 of order @xmath7 ; a @xmath7-dimensional vector @xmath47 ; a family of linear functions @xmath66 on @xmath42 , @xmath67 , @xmath68 .",
    "output : ` yes ' if the orbit @xmath49 intersects the union of affine subspaces @xmath69 and ` no ' otherwise .",
    "[ qhit->skolem ] the is reducible to the skolem problem .",
    "it follows from properties of lrs listed in section  [ alg - comb ] that the sequences @xmath70 are lrs . but as lrs are closed under componentwise sum and product , the sequence @xmath71 is also lrs .",
    "note that taking the input of the shp we can algorithmically compute the representation of  @xmath72 in the form  . and",
    "the reduction of the shp to the skolem problem follows as @xmath73 iff for some @xmath74 it holds @xmath75    note that @xmath16-reducibility in the proof above may not be a polynomial one as the degree of the sequence @xmath76 may be exponential w.r.t .",
    "the initial degree @xmath7 .",
    "but the answer to a general shp is disjunction of answers to separate subspace hitting problems .",
    "and for this particular case the reducibility described in the proof is polynomial .",
    "hence , we conclude that the shp can be solved in polynomial time with the skolem problem oracle . in other words ,",
    "the shp is polynomial time turing reducible to the skolem problem .",
    "the famous skolem - mahler - lech theorem  @xcite asserts that the set of zeroes of a lrs consists of a finite set and a union of a finite number of arithmetical progressions .",
    "the proof of lemma  [ qhit->skolem ] implies that the same is true for the shp .",
    "the set of those @xmath11 for which @xmath77 falls into the union of subspaces @xmath78 , is a union of a finite set and a a finite number of arithmetical progressions .",
    "* polyhedron localization problem * ( plp ) is a particular case of odp when the family of chambers forms a closed convex polyhedron ( i.e. a solution set of a system of nonstrict linear inequalities ) .",
    "[ qcover->nonneg ] the is reducible to the nonnegativity problem .",
    "we assume that the sign pattern of the interior of a polyhedron is @xmath79 and sign patterns for the faces of the polyhedron are obtained by replacing some @xmath80 s by @xmath81 s .",
    "indeed , all negative components in a sign pattern can be removed by a sign change . and",
    "all zero components in the sign pattern of the interior of a polyhedron can be removed after checking that the orbit falls into ( affine ) subspace resulting from the solution of a system of linear equations ( corresponding to zero components of the sign pattern ) .",
    "the last problem is certainly decidable as the affine hull of the orbit coincides with the affine hull of the first @xmath82 orbit points .",
    "now rearrange the sequences @xmath83 into one sequence @xmath72 by consequently putting the elements of @xmath84 into places with an index having residue @xmath74 modulo @xmath16 , i.e. @xmath85 . the resulting sequence @xmath72 is an lrs .",
    "indeed , its generating function @xmath86 is rational as it satisfies the identity @xmath87 where for any @xmath88 , a function @xmath89 is a generating function for @xmath84 .",
    "hence , @xmath86 is a finite sum of rational functions .",
    "the skolem problem is the weakest of all problems mentioned above .",
    "to decide the skolem problem it is enough to enumerate the family of lrs with nonnegative elements or the family of the plp instances with ` yes ' answers ( due to @xmath16-reducibility in lemma  [ qcover->nonneg ] ) .",
    "the following proposition belongs to folklore .",
    "[ reduction1 ] if the family of lrs with nonnegative coefficients is recursively enumerable then the skolem problem is decidable .",
    "if a sequence @xmath6 is a lrs then the sequence @xmath90 is also a lrs as the family of all lrs is closed under componentwise sum / difference and product , see , section  [ alg - comb ] .",
    "but the sequence @xmath90 has nonnegative elements iff @xmath91 for all  @xmath17 . to complete the proof",
    "we apply e.  post theorem  @xcite .",
    "we enumerate all lrs with nonnegative coefficients and compare them to @xmath90 . in parallel",
    "we enumerate all lrs having zeroes and compare them to @xmath90 also .",
    "one of these enumerations should eventually stop .",
    "in this section we relate the skolem problem to some properties of regular languages . to be more exact we define problems of _ regular realizability _ : whether a given regular language contains a word of a particular kind .",
    "it is convenient to describe the problem of realizability as follows .",
    "let @xmath92 be a language in a finite alphabet @xmath38 .",
    "informally , @xmath92 encodes a _ property _ that is checked .",
    "the input to the problem of @xmath92-realizability is a description of some regular language  @xmath93 and we are asked whether the intersection @xmath94 is nonempty .",
    "depending on a way of presentation of a regular language we obtain different in general variants of @xmath92-realizability problem .",
    "we assume that @xmath95 is given via deterministic automaton accepting it .",
    "these clarification is of course immaterial if we are interested in decidability only , but may be important for complexity estimates .    _",
    "the permutation filter _",
    "@xmath18 is a language over the alphabet @xmath96 of all words @xmath97 , where @xmath98 , and the set @xmath99 consists of all binary words of the length  @xmath17 .",
    "words from @xmath18 are called _",
    "permutation words_. informally , a permutaton word corresponds to a permutation of a set of all binary words of some fixed length  @xmath17 .",
    "this length is called the _ block rank _ of a permutation word .",
    "[ permf = skolem ] and @xmath18-realizability problem are turing equivalent .    to prove the theorem we construct reductions in both directions , but as a matter of fact , their complexities are essentially different .    in the next section",
    "we polynomially reduce the chp to the @xmath18-realizability problem and obtain as a corollary @xmath100-hardness of the last problem .",
    "this follows from the fact that the skolem problem is @xmath100-hard  @xcite and according to proposition  [ skolem = hit1 ] it is polynomially reducible to chp .    a different proof of @xmath100-hardness of the @xmath101-realizability problem can be derived from the properties of periodic filters , see  @xcite .",
    "the reduction in the opposite direction is shown in section  [ filter->qhit ] but it takes superexponential time .",
    "we briefly sketch the idea of the reduction . first , using   we associate a lrs with any linear constraint ( equality or inequality ) in the description of a chamber . then by proposition  [ q->z ]",
    "we convert this lrs into an integral one . according to theorem  [ diff - th ]",
    "this lrs can be represented as a difference of two regular sequences .",
    "it turns out that this construction is not enough to establish polynomial reduction and we elaborate it slightly and represent the integral lrs involved as a difference of two regular sequences on some explicit arithmetic progression of its indices .",
    "the last representation can be computed in polynomial time .",
    "next we find a special automaton that compares numbers of words of specified length in two regular languages provided the input is a permutation word .",
    "this trick gives a reduction of the skolem problem to the @xmath18-realizability problem .",
    "to finish the proof we need an additional construction converting several automata described above into one .",
    "we proceed to the proof .    at first note",
    "that for any square matrix @xmath20 of order @xmath7 , @xmath7-dimensional vector @xmath47 and a linear function @xmath21 having rational coefficients there is a polynomial time algorithm to recover the coefficients of lrs for the sequence @xmath65 .",
    "indeed , the degree of the lrs involved does not exceed the order of the matrix and , hence , the coefficients of lrs and the initial data can be determined if we solve the corresponding system of linear equations for the first @xmath102 elements of the sequence .    in this section",
    "we assume that all lrs involved have integer coefficients and integral initial data .",
    "this is possible due to proposition  [ q->z ] as we are interested in signs of the expressions @xmath65 only .",
    "next we express a lrs as a sum of weights of the walks in a digraph with fixed start and finish vertices .",
    "let @xmath103 be a digraph ( loops and parallel edges allowed ) and let @xmath104 be a weight function for edges of @xmath105 .",
    "a  weight of a walk is a product of weights over the edges of the walk .",
    "[ lr->gw ] there exists a polynomial time algorithm that takes an integer lrs @xmath9 and outputs a weighted digraph @xmath106 with two marked vertices @xmath51 and @xmath107 , such that the sum of weights over all walks of the length  @xmath17 starting at the vertex  @xmath51 and finishing at the vertex  @xmath107 equals  @xmath6 for all  @xmath108 .",
    "take a lrs   and construct a digraph @xmath106 as follows .",
    "( see fig .",
    "[ lrgraph ] . )",
    "connect the start vertex @xmath51 and the finish vertex @xmath107 by @xmath7 vertex - disjoint ( except for the terminals ) paths @xmath109 , ",
    ", @xmath110 such that the edge length of @xmath111 is  @xmath112 .",
    "add @xmath7 vertex - disjoint ( except for the terminal @xmath107 ) directed cycles @xmath113 , ",
    ", @xmath114 , passing through the vertex  @xmath107 .",
    "the edge length of  @xmath115 is also  @xmath112 .",
    "the cycles @xmath115 have no common vertices with the paths @xmath116 except for the vertex  @xmath107 .",
    "now set edge weighting of @xmath106 .",
    "all edges of @xmath106 except for the first edges of all paths @xmath111 and cycles @xmath117 has weight  @xmath80 .",
    "set the weight of the first ( outgoing from @xmath51 ) edge on the path @xmath111 to @xmath118 , and set the weight of the first ( outgoing from @xmath107 ) edge on the cycle @xmath115 to @xmath119 .",
    "let  @xmath120 be the sum of weights over all walks of the length  @xmath17 from  @xmath51 to @xmath107 .",
    "there is a recurrence on  @xmath120 .",
    "note that for @xmath121 there exists a walk of the length  @xmath17 from  @xmath51 to @xmath107 along a path of the digraph and for @xmath30 any walk of the length @xmath17 is obtained from a shorter one by adding a cycle .",
    "thus @xmath122 to ensure equalities @xmath123 set @xmath124 for @xmath125 equalities @xmath126 imply @xmath127    to complete the proof note that all computations above take a polynomial time .",
    "[ graph - numerical ] there exists a polynomial time algorithm that takes positive integers  @xmath17 ( in binary ) and @xmath11 ( in unary ) and outputs a digraph , a start vertex  @xmath51 and a finish vertex  @xmath107 such that the number of paths of the length  @xmath11 from  @xmath51 to @xmath107 equals  @xmath17 provided @xmath128 .",
    "let @xmath129 be a doubled directed path having @xmath130 vertices @xmath131 and pairs of parallel edges @xmath132 between any consecutive vertices @xmath112 and @xmath133 .",
    "clearly , there are exactly @xmath134 walks of the length  @xmath135 between vertices @xmath80 and @xmath130 .    a _ thread _ @xmath136 is a digraph obtained from @xmath137 by attaching a directed path of the length  @xmath138 to its finish vertex @xmath139 .",
    "the start and the finish vertices of a thread are , respectively , the start vertex of @xmath137 and the finish vertex of a path .",
    "let @xmath140 be the positions of nonzero bits in the binary representation  @xmath17 .",
    "take the threads @xmath141 and identify their start vertices and , respectively , their finish vertices into global start vertex @xmath51 and global finish vertex @xmath107 . by construction",
    "there are exactly  @xmath17 paths of the length @xmath11 from  @xmath51 to  @xmath107 in the resulting graph .",
    "the case of @xmath142 , @xmath143 is illustrated in fig .",
    "[ n - repr ] .",
    "evidently the algorithm is polynomial .",
    "now we are able to prove a variation of theorem  [ diff - th ] .",
    "[ lr->2auto ] there exists a polynomial time algorithm that takes an integer lrs @xmath6 and outputs an integer  @xmath144 that is polynomially bounded in the input length ( i.e. the total binary length of all coefficients and the initial data of the lrs ) and two deterministic automata @xmath20 , @xmath145 over the alphabet  @xmath146 such that @xmath147 for all  @xmath108 .",
    "the first step is described in the proof of lemma  [ lr->gw ] . as a result",
    "we obtain a digraph  @xmath148 .",
    "then we choose integers @xmath149 and @xmath150 .",
    "now the integer @xmath144 to output is set to @xmath151 .    at the next step",
    "we apply lemma  [ graph - numerical ] and transform the digraph  @xmath148 to a digraph satisfying two additiional properties :    \\1 ) the fan - out of each vertex is  @xmath152 ;    \\2 ) the absolute value of each weight is  @xmath80 .",
    "the transformation consists of the following steps .    \\1 . for",
    "each integer @xmath25 ( @xmath26 ) apply lemma  [ graph - numerical ] to construct a digraph @xmath153 ( @xmath154 ) having exactly @xmath155 ( @xmath156 ) paths of the length @xmath157 from the start to the finish .",
    "replace the first edges of all cycles @xmath115 ( respectively , of all paths @xmath111 ) of the graph  @xmath148 by pasting in the graphs @xmath153 ( respectively , @xmath154 ) .",
    "namely , the start vertex of a graph @xmath153 ( @xmath154 ) is identified with the initial vertex of an edge and the finish vertex is identified with the end vertex of the edge .",
    "other edges of the graph @xmath148 are replaced by directed paths of the length  @xmath144 .",
    "fan - outs of all vertices in the resulting digraph @xmath158 are at most  @xmath152 except for the start vertex @xmath51 and for the finish vertex  @xmath107 .",
    "note that fan - outs of the start and the finish vertices are at most @xmath159 .",
    "attach to the start and to the finish vertex of the graph  @xmath158 rooted directed binary trees of depth  @xmath11 having @xmath159  leaves . replace the starting vertex of each edge outgoing the start vertex ( the finish vertex ) by a leaf of the corresponding tree in such a way that the fan - out of each vertex in the resulting graph @xmath160 is at most  @xmath152 .    as a result",
    "we obtain a modified digraph  @xmath160 ( see fig .  [ h ] ) .",
    "it has vertices with the fan - out less than  @xmath152 .",
    "add an auxillary vertex @xmath161 and edges to the  @xmath161 from all vertices with the fan - out less than  @xmath152 in the digraph  @xmath158 to make all fan - outs equal  @xmath152 .",
    "then add two loops at the vertex  @xmath161 .",
    "after these operations we obtain a digraph  @xmath162 .",
    "now we assign weights to the edges of the digraph  @xmath162 .",
    "the weight of an  edge ingoing to the start vertex of a thread of a digraph  @xmath153 ( @xmath154 ) coincides with the sign of the corresponding integer @xmath25 ( @xmath26 ) .",
    "all other edges have weights  @xmath80 .",
    "it is clear from the construction that in the digraph  @xmath162 the sum of weights over all walks of the length @xmath163 from @xmath51 to @xmath107 equals  @xmath164 .",
    "now we construct automata @xmath20 and @xmath145 over the alphabet @xmath146 . for both of them",
    "the state set is @xmath165 .",
    "choose a labelling of the edges of the digraph  @xmath162 by 0 and 1 such that for each vertex edge labels of the two outgoing edges are different .",
    "( recall that the fan - out of any vertex of @xmath162 is  2 . )",
    "let s describe the automaton  @xmath20 .",
    "the initial state of the  @xmath20 is @xmath166 and the only accepting state is @xmath167 .",
    "reading a symbol  @xmath168 in the state @xmath169 the automaton  @xmath20 goes to the state  @xmath170 if the edge @xmath171 in the digraph  @xmath162 has label @xmath168 .",
    "if the edge @xmath171 has positive weight then @xmath172 .",
    "otherwise , @xmath173 .",
    "the rule is illustrated in fig .",
    "[ autp ] .",
    "the automaton  @xmath145 differs from the automaton  @xmath20 in the accepting state only .",
    "the accepting state of @xmath145 is  @xmath174 .",
    "it is clear that the lengths of all words accepted by the automata  @xmath20 and @xmath145 are multiples of  @xmath144 .",
    "note that both automata can be constructed from the initial lrs in polynomial time .",
    "to finish the proof we note that @xmath6 equals the difference between the number of words of the length @xmath163 accepted by the automata @xmath20 and @xmath145 .",
    "indeed , the walks of negative weight correspond to the words accepted by the  @xmath145 while the walks of positive weight correspond to the words accepted by the  @xmath20 .",
    "now we are ready to present a polynomial reduction of the skolem problem to the @xmath18-realizability problem .",
    "theorem  [ lr->2auto ] implies that for the reduction it is sufficient to build up an algorithm running in polynomial time such that takes a pair of automata @xmath20 , @xmath145 over the alphabet @xmath146 and an integer @xmath144 in unary and outputs the description of an automaton  @xmath175 such that @xmath176 iff @xmath177 holds for some @xmath17 .",
    "let informally explain how to construct such an automaton .",
    "the automaton @xmath175 is made of two automata @xmath178 and @xmath179 by the product construction .",
    "the automaton @xmath175 accepts iff @xmath180 and @xmath179 accept .",
    "recall that we are interested in operation of automata on permutation words , i.e. , words of the type @xmath181 , where @xmath182 .",
    "the block rank ( the length of each @xmath183 ) should be a multiple of @xmath184 .",
    "this last condition is verified by the automaton  @xmath179 .",
    "it counts the length of @xmath183 modulo @xmath184 and rejects in the case of a nonzero residue .",
    "otherwise it accepts .",
    "the automaton @xmath178 starts from an accepting state @xmath185 and reads the current block word @xmath183 separated by the delimiters @xmath186 .",
    "if @xmath183 belongs to @xmath187 then @xmath178 reads the next block word @xmath188 and checks whether it belongs to @xmath189 .",
    "if the last check fails then @xmath178 rejects , otherwise it returns to the state @xmath185 .",
    "if @xmath183 belongs to @xmath190 then @xmath178 rejects .",
    "if @xmath183 belongs to @xmath191 then @xmath178 passes to a new accepting state @xmath192 .",
    "starting from the state @xmath192 the automaton @xmath178 reads the current block word  @xmath183 .",
    "if the block belongs @xmath193 then @xmath178 rejects .",
    "otherwise it returns to the state @xmath192 .",
    "the structure of the automaton @xmath178 is pictured in fig .  [ auto= ] .",
    "let prove that @xmath175 gives the required reduction of the skolem problem to the @xmath18-realizability problem .",
    "first we must show that if an instance of the skolem problem has a positive answer then @xmath175 accepts at least one word from the permutation filter .    indeed , assume that some @xmath6 vanishes",
    ". then @xmath177 and there is a one - to - one correspondence between the words of the length  @xmath163 in @xmath194 and the words of the length  @xmath163 in @xmath190 . a required permutation word @xmath195",
    "is obtained by arranging corresponding words in pairs ( other words of the length  @xmath163 are arranged arbitrary after all pairs ) . by",
    "construction @xmath175 accepts  @xmath195 .    on the other hand , assume that @xmath175 accepts some word @xmath195 from the permutation filter .",
    "it follows from the construction that the block rank of @xmath195 is a multiple of @xmath144 .",
    "we can write @xmath195 in the form @xmath196 . here",
    "@xmath197 is prefix of @xmath195 that is a concatenation of @xmath198 , where @xmath199 and @xmath200 .",
    "and @xmath201 is a suffix of @xmath195 that is concatenation of @xmath202 , where @xmath203 .",
    "thus , @xmath204 .",
    "it means that @xmath205 and the instance of the skolem problem has a positive answer .",
    "clearly the size of the automata @xmath175 is polynomial in the size of the lrs .",
    "this finishes the proof of the reduction .    from the results of this section and the results from",
    "@xcite we get an immediate corollary .",
    "[ nphardness ] the problem of @xmath18-realizability is -hard .",
    "now we extend the previous result to the general chamber hitting problem .",
    "the construction of the automaton @xmath175 can be easily modified to accept a permutation word satisfying the condition @xmath206 . in the notation above to be accepted the suffix @xmath201 of a permutation word should contain at least one more occurence of a word from @xmath207 .",
    "the counter part of the modified automaton @xmath208 does not change .",
    "the structure of the automaton @xmath209 is pictured in fig .",
    ".    it is evident that the size of the modified automaton @xmath208 is upperbounded by the size of the automaton @xmath175 up to a constant factor .    to complete a reduction of the chamber hitting problem to the @xmath18-realizability problem",
    "we construct an automaton that checks several conditions of the form@xmath177 ( @xmath210 ) .    repeating the previous argument let s construct for each constraint @xmath211 ( or @xmath212 ) from the description of the chamber a pair of automata @xmath153 , @xmath154 and an integer @xmath144 common to all pairs @xmath153 , @xmath154 such that a constraint @xmath211 ( @xmath212 ) holds iff an inequality @xmath206 ( an equality @xmath213 ) holds .",
    "the main difficulty here stems from the condition that the block ranks @xmath163 of all permutation words certifying the corresponding constraints in the reducibility * must be equal*. to solve this problem we use the following arguments .    at first , choose the same integer @xmath144 for all pairs of automata .",
    "the required value of @xmath144 is @xmath80 plus the three times the maximum of all logarithms of all data for all lrs involved . then increase to @xmath214 the values of the parameters @xmath11 and @xmath157 from the proof theorem  [ lr->2auto ] .",
    "it  can be done by attaching paths to threads of the graphs constructed in lemma  [ graph - numerical ] .",
    "next step is to construct for each pair @xmath153 , @xmath154 , where @xmath215 and @xmath16 is the number of constraints of chp , the automaton @xmath216 that certifies the  inequality @xmath210 ( or the equality @xmath213 ) as described above .    if @xmath16 is not a power of  @xmath152 then by definition an automaton @xmath216 , where @xmath217 , @xmath218 , is a dummy automaton accepting all words .",
    "now all automata @xmath216 are combined into an automaton @xmath175 that checks all conditions @xmath219 for some length @xmath163 .",
    "the combined automaton has a product form @xmath220 and accepts words @xmath97 from the permutation filter that satisfy the following requirements .    * the block rank is @xmath221 for some @xmath17 ( in the sequel we denote @xmath222 , where @xmath223 ) .",
    "* prefixes @xmath224 form a nondecreasing sequence w.r.t . the lexicographic order .",
    "* for each @xmath225 let @xmath226 be the binary representation of @xmath227 of the length @xmath228 . form a subword @xmath229 that consists of all block words with the prefix @xmath226 .",
    "then the word @xmath230 is accepted by the automaton @xmath231 .",
    "the first requirement is verified by a counter @xmath232 . the second and",
    "the third requirements are verified by an automaton @xmath233 , which is a sort of a concatenation of modified automata @xmath234 . in a modified automaton",
    "@xmath235 each @xmath186-transition from a state @xmath236 to a state @xmath237 is changed by a @xmath186-transition from @xmath236 to the initial state of a copy of an auxiliary automaton @xmath238 .",
    "this automaton reads a  word @xmath226 of the length @xmath228 and compares it with @xmath228-length binary representations of @xmath239 and @xmath112 .",
    "if @xmath226 represents @xmath239 then @xmath238 passes to the state @xmath237 of the automaton @xmath216 .",
    "if @xmath226 represents @xmath112 and @xmath237 is an accepting state in the automaton @xmath216 then @xmath238 passes to the initial state of the automaton @xmath240 .",
    "otherwise it rejects .",
    "this modification is illustrated in fig .",
    "[ auto_i ] .",
    "the initial state of the automaton @xmath241 is the initial state of @xmath242 .",
    "the accepting states are the initial states of those copies of the auxiliary automaton @xmath243 that are inserted instead of @xmath186-transitions to accepting states of the automaton @xmath244 .",
    "the size of the automaton @xmath175 is @xmath245 , where @xmath246 is the maximum of the sizes over all automata  @xmath115 . indeed",
    ", an auxiliary automaton @xmath238 can be implemented using @xmath247 ) states .",
    "so the size of a modified @xmath216 is increased by a factor @xmath248 and we combine sequentially @xmath249 modified automata @xmath216 .",
    "let prove that the resulting automaton @xmath250 gives the required reduction of the chp to the @xmath18-realizability problem .",
    "suppose that for some @xmath17 all constraints in an instance of the chp are satisfied .",
    "then there exists a permutation of block words of the length @xmath163 , which satisfies the accepting requirements of the automaton @xmath115 for each @xmath251 . extending blocks by prefixes",
    "@xmath252 that represent @xmath239 in binary and arranging permutations in the order of  @xmath112 we obtain the permutation word satisfying all three requirements stated above .",
    "hence this word is accepted by @xmath250",
    ".    on the other hand , assume that @xmath250 accepts some word @xmath195 from the permutation filter .",
    "the counter @xmath232 accepts .",
    "so the block rank of @xmath195 is @xmath221 .",
    "the automaton @xmath241 accepts also .",
    "it follows from the construction that it must pass through all automata @xmath235 .",
    "there are @xmath253 possible prefixes of the length @xmath228 .",
    "so the construction of modified automata implies that the sequence of block prefixes of the length @xmath228 is uniquely determined .",
    "namely , it has a form @xmath254 thus acceptance by @xmath241 means that suffixes corresponding to each prefix @xmath226 , where @xmath226 is a binary representation of  @xmath239 , form a permutation of the binary words of the length @xmath163 and the corresponding permutation word is accepted by the automaton @xmath115 .",
    "the latter implies that @xmath112th constraint in the instance of the chp is satisfied .",
    "it implies that the answer for the instance of the chp is positive .",
    "the reduction is composed from several intermediate reductions .    at first , we show that the @xmath18-realizability problem is reducible to the walk weight hitting problem .",
    "the walks in this problem are walks in a digraph .",
    "let @xmath103 be a digraph .",
    "we assume that the edges of the digraph are colored in  @xmath51 colors from the set @xmath255 .    for a walk @xmath256",
    "we define a _ weight _ @xmath257 as an @xmath51-dimensional integer vector @xmath258 where @xmath259 equals the number of edges colored in the color  @xmath112 on the walk @xmath256 .",
    "* walk weight hitting problem * ( wwhp )    input : a digraph @xmath105 , an @xmath51-coloring of the edges of the @xmath105 , two vertices @xmath260 , @xmath261 of @xmath105 , an integer matrix @xmath0 of order  @xmath262 and an integer vector @xmath47 of dimension  @xmath51 .",
    "output : ` yes ' if the orbit @xmath49 intersects a set of weights of the walks from the vertex @xmath260 to the vertex  @xmath261 and ` no ' otherwise .",
    "[ permf->hitroute ] the @xmath18-realizability problem is turing reducible to the problem .    the proof of lemma  [ permf->hitroute ] is presented in subsection  [ route ] .",
    "then we will reduce the wwhp to the integer cone hitting problem . _ an integer cone _",
    "@xmath263 is the set of vectors @xmath264 where @xmath265 .",
    "we denote the set of nonnegative integers by @xmath266 .",
    "* integer cone hitting problem * ( ihp )    input : a square matrix @xmath0 of order @xmath7 ; a @xmath7-dimensional vector @xmath47 ; a family of vectors @xmath267 , @xmath268 .    output : ` yes ' if the orbit @xmath49 intersects the translate of the integer cone @xmath269 and ` no ' otherwise .",
    "[ wwhp->ihp ] the is turing reducible to the .",
    "the proof of lemma  [ wwhp->ihp ] is presented in subsection  [ integer - cones ] .",
    "next step is to reduce the ihp to the polyhedral cone hitting problem .",
    "this last intermediate problem is stated as follows .",
    "* polyhedral cone hitting problem * ( php )    input : a square matrix @xmath0 of order @xmath7 ; a @xmath7-dimensional vector @xmath47 ; a family of linear functions @xmath270 on @xmath42 ; a shift vector @xmath271 .",
    "output : ` yes ' if the orbit @xmath49 intersects the translate @xmath272 of the closed polyhedral cone @xmath273 and ` no ' otherwise .",
    "the php problem is turing - reducible to the odp problem .",
    "the proof is similar to the proof of proposition  [ chp = odp ] .",
    "so , the total chain of reductions is @xmath274    as mentioned above the last two reductions are based on proposition  [ chp = odp ] .",
    "so , to complete the reduction we should prove the following theorem .",
    "[ zhit->qhit ] the problem is turing reducible to the problem .",
    "the proof of theorem  [ zhit->qhit ] is contained in subsection  [ zhitsubsect ] .",
    "we start from some preliminary work .",
    "let @xmath95 be a regular language over the alphabet @xmath275 and let @xmath20 be a deterministic automaton with the state set @xmath276 accepting the language  @xmath95 .",
    "our goal is to check whether @xmath277 .",
    "let pass to the transition monoid and express this condition in terms of three maps @xmath278 , @xmath279 , @xmath280 of the set @xmath276 into itself induced by reading respective symbols .",
    "define @xmath281 , where @xmath282 , as @xmath283    we denote the initial state of the automaton by @xmath284 and the accepting set by @xmath285 .",
    "the reduction algorithm checks for each accepting state @xmath286 whether it can be reached from the initial state @xmath284 after reading some word from the permutation filter .",
    "formally this condition means that for some word @xmath287 we have @xmath288    it is important that to verify the condition   we do not need to know the sequence @xmath183 .",
    "it is sufficient to compute for each map @xmath289 the number @xmath290 of its representations in the form @xmath281 , where @xmath291 ( recall that @xmath292 ) .",
    "then the condition   is rewritten as @xmath293 where each map @xmath289 occurs exactly @xmath290 times in the sequence @xmath294 .",
    "it turns out that the integers @xmath290 can be expressed as the coordinates of the vectors taken from the orbit of a linear map .    in @xmath295-vector space",
    "@xmath296 equipped with the basis @xmath297 indexed by maps @xmath298 we define a linear map by the action on the basis vectors @xmath299 ( recall that map composition is taken from the right to the left . )",
    "[ 2phi ] @xmath290 equals the @xmath300-coordinate of the vector @xmath301 w.r.t . the basis @xmath297 . here",
    "@xmath302 is the identity map .    by induction on @xmath17 .",
    "the case of @xmath303 is trivial .",
    "if the statement holds for @xmath304 then it holds for  @xmath33 : @xmath305    now we are going to describe the condition   in terms of walk weights for a suitable graph .    for this purpose we will use the cayley graphs for monoids .",
    "let @xmath306 be a set of maps .",
    "it generates a monoid @xmath157 ( a  monoid operation is a map composition , recall that by definition a  monoid contains also the identity map . ) . by definition the vertices of _ the cayley graph _",
    "@xmath307 of the monoid are elements of the monoid @xmath157 and ( directed ) edges have the form @xmath308 for @xmath309 , @xmath310 .",
    "note that the edges of the cayley graph are naturally colored by elements of  @xmath162 .",
    "the cayley graph of a monoid may contain parallel edges as the equality @xmath311 for @xmath312 is possible for a monoid .",
    "let @xmath313 be a semigroup generated by the maps @xmath278 , @xmath279 of the automaton  @xmath20 .",
    "this semigroup is finite and can be described as the least set of maps from the state set @xmath276 to itself that contains the maps @xmath278 , @xmath279 and is closed w.r.t .",
    "multiplication by @xmath278 , @xmath279 .",
    "so , the semigroup @xmath313 can be constructed efficiently .    in a similar way",
    "we define a monoid @xmath157 generated by maps @xmath314 , @xmath315 .",
    "this monoid is also constructed efficiently .",
    "denote by @xmath316 the cayley graph of the monoid @xmath157 w.r.t .",
    "the set of generators @xmath317 .",
    "it follows from the construction that   holds iff there exist an integer @xmath17 and a walk @xmath256 on the digraph @xmath316 from the vertex @xmath302 to a vertex @xmath21 such that @xmath318 and @xmath319 holds for all @xmath320 .",
    "and we conclude that the condition   is equivalent to the condition @xmath321    note that the size of the monoid @xmath157 can be less than @xmath322 and @xmath0 acts on @xmath296 . to fix a difference in vector dimensions",
    "we extend the coordinates of walk weights by zero values for @xmath300 such that @xmath323 .",
    "thus the reduction algorithm solves with help of a wwhp - oracle several instances of the wwhp indexed by the accepting states @xmath324 and mappings @xmath21 such that@xmath318 .",
    "an instance has the following input data : a digraph is the cayley graph @xmath316 , colors are generators , the initial vertex is the identity map @xmath302 , the terminal vertex is @xmath21 , the matrix is defined by   and the initial vector is @xmath325 .",
    "if the answer is positive for some instance from the described set then the answer in the instance of the @xmath19-realizability problem involved is also positive due to proposition  [ 2phi ] and condition  .",
    "otherwise , it follows from the definition of the graph @xmath316 and proposition  [ 2phi ] that the answer in the instance of the @xmath19-realizability problem is negative .",
    "lemma  [ permf->hitroute ] is proved .",
    "we need the following auxillary lemma .",
    "[ basic ] let @xmath326 be vertices of a digraph @xmath105 colored in @xmath51 colors and let @xmath327 be the set of weights of all walks from the vertex  @xmath260 to the vertex  @xmath261 .",
    "the set @xmath327 is a finite union of translates of integer cones in @xmath328 .",
    "the list of the cones and the vectors of translation is constructed efficiently .",
    "writing a sequence of colors along a walk gives a word in the @xmath51-letter alphabet .",
    "the collection of such words for all walks from the vertex @xmath260 to the vertex  @xmath261 forms a regular language .",
    "the weight of a walk is just the parikh image of the corresponding word .",
    "so the statement of the lemma follows from parikh s theorem  @xcite .",
    "lemma  [ basic ] implies that to check the condition   it is sufficient to check several conditions of the form @xmath329 where @xmath330 in an integer @xmath51-dimensional vector and @xmath195 is an integer cone in  @xmath328 .",
    "it gives a reduction of the wwhp to the ihp .",
    "let @xmath331 be a rational cone generated by vectors @xmath332 , @xmath333 , @xmath334 .",
    "there is an algorithm ( see , e.g.  @xcite ) for passing to dual polyhedral description of @xmath335 .",
    "the cone @xmath335 may contain some additional integral points not belonging to integral cone @xmath195 so that conditions   should be modified .",
    "let us start with a simple case of an integral simplicial cone , when generating vectors @xmath336 are linear independent .",
    "[ simplex ] if vectors @xmath332 , ",
    ", @xmath334 are linear independent then representation @xmath337 , @xmath338 holds if and only if the following two representations hold : @xmath339 , @xmath340 and @xmath341 , @xmath342 .",
    "the implication @xmath343 is trivial and the opposite implication @xmath344 follows from linear independence of vectors @xmath336 , as the equality @xmath345 holds iff @xmath346 .",
    "vector @xmath3 can be represented in a form @xmath341 , where @xmath342 , iff @xmath3 is an element of the subgroup @xmath162 generated by vectors  @xmath336 in @xmath328 .",
    "and this condition in turn is a conjunction of two conditions .",
    "the first condition is simple : @xmath3 is in a subspace generated by vectors  @xmath336 in the vector space space @xmath347 . to formulate the second condition let extend the set @xmath336 of generators of @xmath162 to the basis of @xmath328 by adding some unit coordinate vectors @xmath348 so that the resulting system formed from @xmath336 and @xmath348 constitute a basis of @xmath328 .",
    "such extension is always possible in view of linear independence of @xmath336 .",
    "let @xmath349 be the group generated by @xmath336 and @xmath348 .",
    "[ subspace ] vector @xmath3 belongs to the subgroup @xmath162 generated by vectors  @xmath336 in the group @xmath328 iff @xmath3 is in the subspace generated by vectors  @xmath336 in @xmath347 and @xmath3 belongs to the subgroup @xmath349 .",
    "the implication @xmath343 is obvious . to prove the opposite implication @xmath344",
    "assume that @xmath350 . by construction of the subgroup",
    "@xmath349 it follows that @xmath351 where @xmath352 and @xmath348  denote those added coordinate unit vectors .",
    "now it follows from linear independence of @xmath336 and @xmath348 that if vector @xmath3 belongs to the subspace generated by vectors  @xmath336 in the coordinate vector space @xmath347 then all coordinates @xmath353 are zero .",
    "hence @xmath3 belongs to the subgroup  @xmath162 .",
    "it follows from the propositions  [ simplex ] and  [ subspace ] that a vector falls into integral conic hull of vectors @xmath336 if and only if three conditions are fulfilled .",
    "the first two conditions are @xmath354-linear and control whether a vector falls into the cone @xmath335 .",
    "the third condition consists in checking that a vector belongs to a fulldimensional lattice in @xmath328 ( a subgroup of @xmath328 having finite index in @xmath328 ) .",
    "checking the first and the second condition for the orbit of a linear map are particular variants of chp and the third condition holds for a nice family of orbit points .",
    "[ group ] let @xmath355 be rank  @xmath51 subgroup of @xmath328 , let @xmath330 be an integral vector in @xmath328 and let @xmath0 be an integral @xmath262 matrix .",
    "then the set @xmath356 is a union of a finite set @xmath63 and a finite set of arithmetic progressions .",
    "moreover , there is an algorithm to compute @xmath148 .",
    "first let @xmath162 be a diagonal subgroup whose generators are columns of the matrix @xmath357 the shift induced by @xmath162 is given by @xmath358    let @xmath359 be the least common multiple of @xmath360 .",
    "now calculating @xmath77 modulo @xmath359 we can find a finite set of exponents @xmath11 , and the corresponding arithmetic progressions @xmath361 , satisfying  . besides these arithmetic projections @xmath148 may include only numbers that should be less than initial terms of the progressions found on the previous step , so that we can directly compute this finite set .",
    "the general case is reduced to a diagonal one by reducing the generator matrix @xmath157 to the smith normal form ( see  @xcite ) if @xmath162 is a subgroup of @xmath328 of full rank then smith normal form is given by @xmath362 where @xmath363 , @xmath1  are unimodular matrices and @xmath246 is a nondegenerate diagonal matrix .",
    "@xmath1 corresponds to column transformations and gives a system of new generators @xmath364 ,  ,",
    "@xmath365 of  @xmath162 .",
    "@xmath363 corresponds to row transformations and shows how the vectors @xmath366 of the initial basis can be expressed as a linear combinations of the new basis vectors @xmath367 : @xmath368 by   the generator matrix @xmath369 of the group @xmath162 is diagonal in the basis @xmath367 .    to complete a reduction to the diagonal case",
    "we should express the matrix @xmath0 and the initial vectors @xmath47 , @xmath330 in the new basis @xmath370 .",
    "[ zsimplexhit->qhit ] if vectors @xmath332 , ",
    ", @xmath334 are linear independent then the is reduced to the .",
    "let us describe an algorithm with php - oracle that solves the ihp for instances of linear independent set of vectors @xmath332 , ",
    ", @xmath334 .",
    "first let find the set @xmath148 defined in proposition  [ group ] .",
    "we should check whether condition   holds for @xmath148 .",
    "the finite part @xmath371 can be checked directly . and",
    "for each arithmetic progression @xmath372 , @xmath373 in @xmath148 we compute a vector @xmath374 and a matrix @xmath375 . then using php - oracle we check whether there exists @xmath11 such that @xmath376 hits the rational cone  @xmath335 .",
    "if all such tests fail we answer ` no ' .",
    "otherwise we answer ` yes ' .    to check correctness of the algorithm",
    "involved note that it follows from the propositions  [ subspace ] and [ group ] that all tests fail if and only if the orbit @xmath377 either does not intersect the cone  @xmath335 at all or hits it for exponents  @xmath17 such that @xmath378 is not in the group  @xmath162 .",
    "hence , the answer in the ihp is negative .    on the other hand ,",
    "if some test is successful then we find  @xmath17 , such that @xmath378 is in the group @xmath162 and hits the cone  @xmath335 .",
    "it follows from proposition  [ simplex ] that the answer in the ihp is positive .",
    "now we discuss the general case .",
    "let @xmath379 be the set of integral linear combinations of  @xmath336 with nonnegative coefficients ( the integral cone generated by  @xmath336 ) .",
    "below we describe an algorithm that given any integral cone @xmath380 produces its representation as a union of a finite set @xmath381 of singular points and a finite set of translates of integral simplicial cones @xmath382 .",
    "recall that caratheodory s theorem ( see , e.g.  @xcite ) states that any vector in @xmath383 is a rational nonnegative linear combination of some @xmath384 ( where @xmath51 is the dimension ) vectors from the system @xmath332 ,  , @xmath334 .",
    "as one can form not more than @xmath385 systems of linear independent vectors out of @xmath386 vectors , then it is sufficient to consider the case of the intersection of the integral cone @xmath387 and a rational simplicial cone with @xmath51 generators chosen from the set @xmath388",
    ".    let @xmath389 be one of such simplicial cones and let @xmath390 be the set of its generating vectors .",
    "@xmath389 contains @xmath391 , but besides that @xmath389 may contain some extra integral points .",
    "now we use the fact that @xmath389 has _",
    "hilbert basis _ : a set of integral vectors @xmath392 , ",
    ", @xmath393 , such that @xmath394 in particular , it follows from   that @xmath395    recall that one can effectively find hilbert basis for  @xmath389 as it coincides with the set of integral points of the polytope @xmath396    some vectors from hilbert basis belongs to the subgroup @xmath397 , generated by @xmath336 , i.e. to the integral hull of @xmath336 .",
    "checking this condition is effective as it is reduced to solving linear diophantine equations .",
    "let take one of such vectors @xmath398 and let @xmath145 be maximum of modules of the coefficients @xmath26 .",
    "now all points of the intersection of @xmath399 and @xmath380 belong to the union of the finite set @xmath400 the integral cone @xmath401 and @xmath402 sets of the form @xmath403 each set in   is an intersection of the integral cone @xmath380 and a translate of some rational simplicial cone of the lower dimension @xmath404 .",
    "now we can give a complete description of the algorithm that given an integral cone @xmath380 and a translate of some rational simplicial cone whose generating vectors are taken from the set of generators of @xmath380 , finds representation of the intersection of the cones involved as a union of a finite set of singular points  @xmath381 and a finite set of translates of simplicial integral cones .",
    "the procedure is recursive . applying it to the intersection of @xmath380 and a @xmath135-dimensional rational simplicial cone @xmath389 we at first compute hilbert basis of  @xmath389 . then for any vector in hilbert basis that belongs to the integral hull of vectors @xmath332 ,  , @xmath334 , we find the sets  ,   and  .",
    "the set   is added to the singular part  @xmath381 .",
    "the simplicial integral cone   is included to the family of integral cones computed on the previous steps and the algorithm is continued recursively by processing all sets  .",
    "the procedure is finite as the sets   are empty for any one - dimensional cone .",
    "hence , the recursion tree has finite height and finite degree at any point .    thus the following theorem is proved .",
    "[ frobndim ] an integral translate of an integral cone @xmath405 can be represented as a union of a finite set and a finite family of translates of simplicial integral cones .",
    "there is an algorithm that finds such a representation from the list of vectors @xmath330 , @xmath406 .",
    "now the main result of this section easily follows .",
    "using algorithm from theorem  [ frobndim ] find representation of the integer cone as a union of a finite set of singular points and finite family of translates of simplicial integral cones . now for any cone in the family check whether the orbit hits it using php - oracle from lemma  [ zsimplexhit->qhit ] .",
    "checking whether or not the orbit hits a point ( and hence , any finite set of points ) is also reduced to the php as a point may be regarded as a translate of the zero cone .",
    "the skolem problem is open for almost eighty years . using slight abuse of language ,",
    "presently it falls ` on the border between decidability and undecidability ' @xcite . in this section",
    "we show that analogous ` borderline ' pattern holds for a more general -realizability problem and give some decidable and undecidable problems closely related to it .",
    "all these problems are problems of regular realizability . the languages specifying the problems consist of binary _ block words _ separated by the delimiter @xmath186 .",
    "all blocks have the same length ( the block rank @xmath17 ) .",
    "blocks of a block word form a multiset of binary words of the same length .",
    "we will define languages indicating the properties of this _",
    "block multiset_.            the problems of -realizability and -realizability are decidable .",
    "let s outline the proof .",
    "it turns out that both - or , respectively , - realizability can be reduced to some restricted versions of the integer cone hitting problem whose decidability follows from specific properties of maps  @xmath0 defined in subsection  [ route ] .",
    "repeat the arguments from the proof of lemma  [ permf->hitroute ] .",
    "now it is possible that some binary words in a block word are missed .",
    "it means that the condition   is replaced by @xmath415 applying the arguments from lemma  [ wwhp->ihp ] we see that   is transformed to   for cones appeared in the reduction from lemma  [ wwhp->ihp ] .",
    "dickson s lemma claims that there are no infinite antichains in the poset @xmath416 .",
    "so an orbit up - shadow is a finite union of translated copies of the orthant @xmath417 . in the case of an orbit",
    "down - shadow copies of the orthant are replaced by ` parallelepipedons ' ( the cartesian products of segments ) .",
    "thus the up - hitting problem as well as the down - hitting problem is reduced to the nonemptiness check for intersections of integer cones ( parallelepipedons ) , which is an integer linear programming problem , provided the representations mentioned above can be constructed efficiently .",
    "recall that an @xmath300-component of @xmath377 is expressed as the number @xmath290 of walks of the length  @xmath17 from the vertex @xmath418 to the vertex @xmath320 in the graph @xmath105 .",
    "the vertex set of the graph @xmath105 is @xmath419 and the edge set @xmath420 consists of pairs in the form @xmath421 or @xmath422 .",
    "( see subsection  [ route ] for a detailed exposition . )",
    "note that the integer @xmath290 is the number of words of the length @xmath17 in a regular language .",
    "this language is recognized by an automaton with the transition graph @xmath105 .",
    "thus the generating function @xmath423 for the language is a rational function and its representation in the form @xmath424 can be found efficiently .    in the arguments below",
    "we need some properties specific to generating functions of regular languages .",
    "so it is more suitable for our purposes to analyze the asymptotic behavior in combinatorial settings by considering walks on the graph @xmath105 .",
    "[ 1-letterpos ] for any vertex @xmath425 the set @xmath426 is a semilinear set ( a finite union of an exceptional finite set and finite collection of arithmetic progressions ) and its description can be constructed efficiently .",
    "[ divisors ] differences of all progressions in proposition  [ 1-letterpos ] are the cycle lengths in the graph @xmath105 .",
    "so they are divisors of the least common multiple of integers from @xmath80 to @xmath427 . in the sequel use",
    "we denote this common multiple by  @xmath24 .",
    "* @xmath429 consists of vertices @xmath430 such that some directed cycle ( possibly , a loop ) goes through the vertex @xmath430 . *",
    "@xmath431 consists of vertices @xmath430 such that there is a walk starting at the @xmath418 , finishing at the @xmath430 and passing through a vertex from the set  @xmath429 . *",
    "@xmath432 consists of all other vertices .",
    "now take a vertex @xmath439 .",
    "the set @xmath440 consists of vertices @xmath441 such that @xmath442 belongs to a walk from  @xmath418 to @xmath320 and for all walks of this type all vertices after the @xmath442 along a walk are in the set  @xmath431 .",
    "the subgraph @xmath443 is induced by the edges of all walks from a vertex in @xmath444 to @xmath320 .          from these properties",
    "we conclude that the graph @xmath443 is acyclic . by definition",
    "there are no directed cycles passing through vertices in the set @xmath431 .",
    "other vertices in the @xmath443 are in the set @xmath444 . there are no directed cycles passing through these vertices because there are no edges ingoing to them .",
    "it follows from lemma  [ sur->suporbit ] that it is enough to construct an integer cone representation for an orbit up - shadow .",
    "proposition  [ uniform - monotone ] implies that the orbit up - shadow is @xmath450 where @xmath16 is a dimension , i.e. the cardinality of @xmath451 .                  *",
    "the edge @xmath460 is not included in the cycle  @xmath175 ; * the cycle @xmath175 passes through the vertex @xmath461 ; * @xmath462 , where @xmath144 is the distance from @xmath461 to @xmath320 along the cycle  @xmath175 .",
    "prove now ` only if ' .",
    "suppose that @xmath464 for @xmath465 .",
    "for any directed cycle @xmath175 passing through @xmath320 and any edge satisfying ( i)(ii ) the first inequality in   implies that @xmath466 for @xmath465 .",
    "determine all unbounded components for all subsequences @xmath453 and the limit values for bounded components .",
    "for this purpose use proposition  [ 2infinity ] and the observations preceding it .",
    "then the down - shadow is the union of the sets @xmath467 over all @xmath452 . here",
    "@xmath468 are coordinates in the space @xmath469 .        in the construction we use a track product of languages consisting of block words ( _ block languages _ ) . here",
    "blocks are words over a finite alphabet @xmath38 and a block word consists of blocks of the same length separated by the delimiter  @xmath186 .      _",
    "the track product _ of two block languages @xmath477 ( over an alphabet @xmath470 ) and @xmath478 ( over the alphabet @xmath471 ) is a block language @xmath479 consisting of all block words over the alphabet @xmath480 such that the projection @xmath481 is in the language @xmath477 and the projection @xmath482 is in the language @xmath478 .",
    "( for consistency we assume that @xmath483 . )",
    "denote by @xmath484 the block language consisting of all periodic words over the alphabet @xmath38 ( all blocks of a word in @xmath484 are equal ) and by @xmath485 the block language consisting of permutation",
    "block words over the alphabet @xmath38 ( blocks of a word in @xmath485 form the set of all words in @xmath486 , where @xmath17 is the block rank ) .",
    "* zero in the upper right corner problem . *",
    "( the zurc problem . ) for a given collection of @xmath487 integer matrices @xmath488 check whether the multiplicative semigroup generated by @xmath489 contains a matrix @xmath157 such that @xmath490 .                    using the expansion  ( [ prod - expression ] , [ prod - element ] )",
    "we define the partition of words of the length @xmath511 over the alphabet @xmath512 into three sets @xmath513 , @xmath514 and @xmath515 , where @xmath516 .",
    "( below we drop out @xmath517 while the sequence @xmath517 is fixed . )",
    "it is convenient to represent a word over the alphabet @xmath472 , where @xmath518 are given by  , by a @xmath519-row table .",
    "a table column represents a symbol in the word .",
    "the first row bears symbols from @xmath470 while the remaining three columns represent symbols from @xmath471 ( they have three components as indicated in  ) .    a word in the set @xmath520 ( @xmath521 ) can be divided in @xmath144 subwords of the length @xmath522 .",
    "the @xmath523th subword has the form @xmath524 in the table representation defined above .",
    "the upper three elements in each row are the same in  .",
    "note that @xmath525 is the @xmath523th element of the sequence @xmath517 .",
    "the fourth row is a binary representation of an integer  @xmath526 .              restricting words in the set @xmath520 to the upper three rows one obtains all correct sequences @xmath256 such that @xmath528 .",
    "the same restriction for the set @xmath521 gives the sequences @xmath256 such that @xmath532 .",
    "the multiplicity of a sequence @xmath256 in the set @xmath535 depends on fourth rows of the tables .",
    "according to the requirement ( d ) and the permutation property there are exactly @xmath536 subwords bearing @xmath537 in the upper three rows .",
    "so the multiplicity of the sequence @xmath256 is @xmath538 , where @xmath538 is given by  .",
    "it follows from the above construction that the sets @xmath539 , where @xmath540 , do not intersect for different @xmath517 because the sequence @xmath517 is recovered from the first row in the table representation .",
    "we repeat the construction from section  [ hcp ] .",
    "the reduction algorithm takes an instance of the zurc problem ( @xmath494 , @xmath495 ) and constructs an automaton @xmath175 such that the condition   holds for some element in the semigroup generated by the input matrices if and only if @xmath546 .    the automaton expects an input @xmath547 from the language @xmath548 such that block rank is @xmath549 and the word @xmath547 is a certificate for zero representation  .",
    "a period in the first ( periodic ) component determines the sequence @xmath516 such that   holds .",
    "the automaton expects that each symbol in the sequence @xmath517 is repeated @xmath522 times . in the second ( permutation )",
    "component the automaton expects that the blocks from the sets @xmath550 , @xmath551 are paired and are followed by the blocks from the set @xmath552 .",
    "note that such a pairing exists iff @xmath553 .",
    "the structure of this part of the automaton @xmath175 is similar to the automaton @xmath178 described in section  [ hcp ] and shown in fig .",
    "[ auto= ] .",
    "the correctness of the reduction is proved in a way similar to the arguments in section  [ hcp ] .",
    "if the automaton accepts a word @xmath547 in the language @xmath548 then one can extract the sequence @xmath517 from the first components of symbols in the word  @xmath547 .",
    "the check in the second components guarantees that   holds for the sequence @xmath517 .",
    "we apply here proposition  [ pos - expansion ]",
    ".            13 _ bell , p. , potapov i. _ lowering undecidability bounds for decision questions in matrices . in developments in language theory .",
    "springer lecture notes in computer science , vol .",
    "4036 , 2006 .",
    "p.  375385 ."
  ],
  "abstract_text": [
    "<S> we settle the equivalence between the problem of hitting a polyhedral set by the orbit of a linear map and the intersection of a regular language and a language of permutations of binary words ( -realizability problem ) .    </S>",
    "<S> the decidability of the both problems is presently unknown and the first one is a straightforward generalization of the famous skolem problem and the nonnegativity problem in the theory of linear recurrent sequences .    to show a ` borderline ' status of -realizability problem with respect to computability we present some decidable and undecidable problems closely related to it .    </S>",
    "<S> this paper is an extended version of the journal publication @xcite and contains some additional results . </S>"
  ]
}