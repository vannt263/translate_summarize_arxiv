{
  "article_text": [
    "phylogenetic trees represent evolutionary relationships between a set @xmath0 of biological objects , typically genetic sequences obtained from different present - day species .",
    "internal vertices correspond to historic divergence events and the leaf vertices correspond to elements in @xmath0 .",
    "the tree are edge - weighted , and these weights represent the degree of evolutionary divergence between species .",
    "the set of all phylogenetic trees for a fixed set @xmath0 forms a geodesic metric space usually referred to as _ billera - holmes - vogtmann _ ( bhv ) _ tree - space _ @xcite .",
    "samples of trees arise from many biological analyses , for example by constructing a phylogenetic tree for each gene in a collection of different genes present in all species @xmath0 .",
    "medical images of branching structures in the body , such as blood vessels @xcite and lung airways @xcite , can also be represented as phylogenetic trees , and samples of images have been analysed using methods based in bhv tree - space .    to date",
    ", most methods for analysing data sets in bhv tree - space have involved least squares estimation using the geodesic metric : there are methods for computing sample means @xcite and for fitting principal geodesics @xcite , for example . on the other hand , development of fully probabilistic models",
    "is difficult due to the challenging problem of construction of useful probability distributions on tree - space .",
    "some recent work has focussed on kernel density estimation for non - parametric estimation of distributions on tree - space @xcite . in this article we consider stochastic processes on tree - space , and use brownian motion to construct probability distributions . consider particles undergoing brownian motion from some fixed point @xmath1 in tree - space : if we run the brownian motion for some fixed time duration @xmath2 then the corresponding distribution of particles will be denoted @xmath3 .",
    "this distribution consists of a ` bump ' of density on tree - space characterized by the location of the _ source _ @xmath1 and the time @xmath2 which plays the role of a _ dispersion _ parameter .",
    "if the same process runs in euclidean space then the corresponding distribution is the multivariate normal distribution with mean @xmath1 and variance - covariance matrix @xmath4 .",
    "the density function for @xmath3 for the space of rooted phylogenies has been explicitly calculated in the cases of @xmath5 and @xmath6 species @xcite . however , for @xmath7 calculation of the density function becomes very difficult since it involves gluing together spherical harmonics and higher dimensional analogues to create eigenfunctions of the laplacian on tree - space . rather than attempting to calculate the density function explicitly ,",
    "an alternative is to approximate brownian motion using a suitably defined random walk .",
    "this has the additional benefit that random walks are easy to simulate , and it opens the possibility of using stochastic processes on tree - space more generally .    in this paper",
    "we address two fundamental issues : ( i ) existence of brownian motion as a well - defined markov process on tree - space , and ( ii ) convergence of random walks to brownian motion under a certain limit .",
    "bhv tree - space is a manifold stratified space : it consists of a collection of regions which are isomorphic to the positive orthant in @xmath8 , with one such region for each labelled tree shape .",
    "these regions are glued along their faces in a way determined by the combinatorics of the tree shapes .",
    "brownian motion on tree - space proceeds in the same way as for @xmath8 on the interior of each such region . at boundaries between regions , the particles undergoing brownian motion move with equal probability into each of the neighbouring regions .",
    "we prove this gives rise to a well - defined markov process in theorem  [ thm : exist ] .",
    "the method of proof is adapted from @xcite , theorem 3.1 , which is an analogous result for the existence of brownian motion on @xmath9-dimensional euclidean complexes .",
    "our main result is theorem  [ thm : conv ] , in which we prove that suitably defined random walks converge to brownian motion on bhv tree - space .",
    "the method of proof involves projecting sample paths in tree - space down onto a single positive orthant @xmath10 .",
    "the reflection principle can then be used to calculate probabilities for sets of sample paths on tree - space in terms of the probability of the sets of projected paths .",
    "the remainder of the paper is structured as follows .",
    "section  [ sec : background ] contains background material on the geometry of tree - space and brownian motion in euclidean space ; we prove a result concerning intersections between brownian sample paths and coordinate hyperplanes which the proof of convergence relies on . in section  [ sec : bmtreespace ] we prove that brownian motion exists as a well - defined markov process on tree - space , and relate the probability measure on sample paths to the corresponding probability measure for reflected brownian motion in euclidean space . in section  [ sec : conv ] we define random walks on bhv tree - space and prove they converge to brownian motion under a certain limit .",
    "when @xmath1 is not a _ binary _ tree , both existence of the stochastic processes and convergence of the random walk require special attention , and we do not give complete results for this case .",
    "this situation is discussed in section  [ sec : unres ] .",
    "we give some concluding remarks in section  [ sec : conc ] .",
    "the combinatorial and geometric structure of billera - holmes - vogtmann tree - space was originally described in  @xcite .",
    "we give a brief description here of the essential elements we require , but more detail can be found in the original paper . in particular , we are more concerned with the combinatorial structure ; geodesics and the corresponding metric structure are not required for most of our results .",
    "tree - space @xmath11 is the set of edge - weighted unrooted trees with @xmath12 leaves labelled by a 1-to-1 correspondence with a fixed set of species @xmath13 .",
    "the space of rooted trees can easily be obtained from the unrooted space by adding an extra species @xmath14 to @xmath0 , so that @xmath14 is by definition attached to the root vertex .",
    "the edge weights take values in @xmath15 and are usually represented graphically as edge _ lengths_.",
    "each element of @xmath11 contains @xmath12 edges which end in a leaf , referred to as _ pendant _ edges .",
    "trees are called _ binary _ or ( from the biological literature ) _ fully - resolved _ if every vertex has degree @xmath16 apart from the leaves , in which case the tree contains exactly @xmath17 edges . a tree containing fewer internal edges",
    "is called _ unresolved _ , and will contain at least one vertex of degree @xmath6 or more . for convenience",
    "we define @xmath18 , the number of internal edges on a fully - resolved tree .",
    "two trees @xmath19 are said to have the same _ topology _ if they are identical when the edge weights are ignored .",
    "there are @xmath20 fully - resolved topologies for @xmath12 species .    a _ split _",
    "is a partition of @xmath0 into two disjoint subsets . given a tree @xmath21 , cutting any edge on @xmath22 partitions @xmath0 in eactly this way , so edges are determined by the splits they induce .",
    "any tree can therefore be regarded as a weighted set of splits which satisfy a certain compatibility relation .",
    "arbitrary sets of splits do not represent trees : for example two the splits @xmath23 and @xmath24 are not compatible and can not be simultaneously represented on a tree .",
    "given a tree @xmath22 and a split @xmath25 we write @xmath26 to denote the weight ( or length ) assigned to @xmath25 in @xmath22 , and define @xmath27 when @xmath25 does not correspond to any edge in @xmath22 .",
    "tree topologies correspond to unweighted sets of compatible splits .",
    "we say a fully - resolved topology @xmath28 _ resolves _ a topology @xmath29 when , as a set of splits , @xmath30 .",
    "splits are _ pendant _ if they correspond to pendant edges , or _",
    "internal _ otherwise .",
    "the weights associated with pendant edges will be ignored for the present .",
    "the set of all trees with some fixed fully - resolved topology @xmath28 can then be put into correspondence with the interior of the positive orthant @xmath31 by associating each internal split with a coordinate axis in @xmath32 . by taking a tree with topology @xmath28 and shrinking an edge down to length zero , so that the corresonding split is removed from the tree , a point on the boundary of @xmath33 is obtained .",
    "the boundary of @xmath33 therefore corresponds to the set of trees with topologies resolved by @xmath28 .",
    "specifically , each codimension-@xmath34 face of @xmath33 corresponds to a topology in which @xmath34 internal splits have been removed from @xmath28 .",
    "the _ orthant _ @xmath35 consists of all trees with topology @xmath28 together with all trees with unresolved topologies @xmath30 , and so @xmath36 .",
    "suppose a single edge is contracted down to length zero in a fully resolved tree with topology @xmath28 , and let @xmath29 denote the resultant unresolved topology .",
    "in particular , @xmath29 will contain a single vertex of degree @xmath6 , and suppose the four subtrees attached to this vertex are denoted @xmath37 .",
    "then there are three topologies which resolve @xmath29 ( including @xmath28 ) : @xmath38 , @xmath39 and @xmath40 .",
    "the process of continuously contracting an edge to give a degree-@xmath6 vertex , and then expanding out an alternative edge , is called _ nearest neighbour interchange _ ( nni ) .",
    "it follows that each codimension-1 face of an orthant @xmath41 corresponds to a set of trees which also lie on a codimension-1 face of exactly two other orthants related to @xmath28 by nni .",
    "then , ignoring pendant edge weights , tree - space is the union @xmath42 where the union is taken over fully resolved topologies , and triplets of orthants related by nni are glued along codimension-1 faces .",
    "the codimension-@xmath34 faces of the orthants for @xmath43 also overlap and are glued in a similar way . however , it turns out that brownian motion avoids these faces almost surely , and so the way they are glued together is much less important for our application than the codimension-1 faces .",
    "when the weights of pendant edges are introduced , tree - space is the product @xmath44 ; however , we will continue to ignore pendant edges for the remainder of the paper and take @xmath45 .",
    "we let @xmath46 be the set of trees containing at most @xmath47 internal edges for @xmath48 .",
    "equivalently , @xmath49 is the union of the codimension-@xmath34 faces of the orthants .",
    "it is helpful to consider the structure of tree - space for the cases @xmath50 and @xmath51 .",
    "when @xmath50 every tree has just one internal edge , and there are three possible fully resolved tree topologies , as specified in the previous paragraph .",
    "thus @xmath52 consists of three copies of @xmath53 glued together at the origin , and we write @xmath54 .",
    "each ` arm ' of @xmath52 corresponds to a different topology , and the position along the arm specifies the length of the internal edge .",
    "the origin corresponds to the tree with no internal edges , called a _ star _ tree . for @xmath51",
    "there are @xmath55 different fully resolved topologies , each containing @xmath9 internal edges . in this case",
    ", @xmath56 consists of @xmath55 copies of @xmath57 glued in sets of 3 along their edges . the origin of each orthant corresponds to the star tree .",
    "this article contains several figures showing a few orthants of @xmath56 laid side - by - side in the plane : see figure  [ fig : drop ] for example .",
    "billera , holmes and vogtmann proved the existence of a unique geodesic between any two points in @xmath11 consisting of straight line segments in each orthant , and such that the length of the geodesic is given by the sum of the @xmath58-lengths of the segments .",
    "we will refer to the corresponding metric as the _",
    "geodesic distance _ on tree - space . within each orthant",
    "it is the same as the euclidean ( @xmath58 ) metric .",
    "however , beyond this , the structure and properties of tree - space geodesics are not directly relevant to our application .",
    "although we ignore pendant edge weights for the remainder of this article , they are very readily dealt with . for each tree @xmath21 , the pendant edge weights correspond to a point in @xmath59 .",
    "if we consider brownian motion on this space , with reflection at the boundaries , then at time @xmath2 the distribution of particles starting from @xmath1 is given by a wrapped multivariate normal density with variance - covariance matrix @xmath4 .",
    "reflected random walks on @xmath59 converge to brownian motion .",
    "existence of brownian motion and convergence of random walks on the full tree - space @xmath44 therefore follow immediately if we can establish these properties for the internal edges .      before considering brownian motion in tree - space",
    ", we start by establishing a result in euclidean space , lemma  [ lem : planeseq ] . this will be used later to obtain a convenient partition of the set of brownian sample paths in tree - space .",
    "let @xmath60 , fix @xmath61 and fix a time @xmath62 .",
    "let @xmath63(x)}}$ ] denote the metric space of maps @xmath64\\rightarrow x$ ] continuous with respect to the euclidean metric @xmath65 on @xmath66 which satisfy @xmath67 .",
    "the metric between paths @xmath68(x)}}$ ] is defined by @xmath69 } d_2 ( \\eta_1(t),\\eta_2(t)).\\ ] ] then brownian motion on @xmath66 for particles starting from @xmath1 and of duration @xmath2 defines a distribution @xmath70 on @xmath63(x)}}$ ] equipped with the borel sigma algebra .",
    "define @xmath71 and @xmath72 any path @xmath73 drawn from @xmath70 misses the origin @xmath74 almost surely for all @xmath75 .",
    "in fact , because sample paths for brownian motion on @xmath76 miss the origin almost surely , it follows that any path @xmath73 drawn from @xmath70 will almost surely have no intersection with @xmath77 for @xmath78 .",
    "[ lem : planeseq ] if @xmath79 and @xmath73 is drawn from @xmath70 there exists almost surely a finite sequence @xmath80 for some @xmath81 such that the intersections of @xmath73 with @xmath82 lie on @xmath83 in turn , ignoring multiple consecutive intersections with the same hyperplane , so that @xmath84 for all @xmath85 .",
    "since @xmath73 misses @xmath77 almost surely , it follows that there is almost surely a well defined , though possibly infinite , set of intersections with @xmath86 , ordered according to increasing time .",
    "each such intersection is with a single hyperplane , and the corresponding time - ordered index set of hyperplanes is denoted @xmath87 . if @xmath88 for some @xmath89 and some @xmath90 , then it may be the case that there is an infinite set @xmath91 for some @xmath92 such that @xmath93 for all @xmath94 and such that @xmath95 for all @xmath96 and @xmath97 . in other words , given that @xmath73 hits a hyperplane @xmath98 there might be an infinite number of other hits with the same hyperplane before the path @xmath73 hits a different hyperplane .",
    "given @xmath73 we define the _ pairwise distinct _ sequence of hyperplanes @xmath99 to be the subsequence of @xmath87 obtained by ignoring any such repeated hits with the same hyperplane .",
    "therefore , to prove the lemma it remains to show that @xmath99 is finite almost surely .",
    "the basic idea is that for @xmath99 to be infinite , @xmath73 must hit @xmath77 , and this happens with zero probability .",
    "this method of proof is adapted from  @xcite , theorem @xmath100 , and we adopt similar notation .",
    "given a point @xmath101 let @xmath102 be the closed ball around @xmath22 with diameter @xmath103 .",
    "define random times @xmath104 and @xmath105 , @xmath106 for @xmath107 .",
    "if @xmath99 is infinite , then there will be an infinite sequence of pairs @xmath108 , bounded above by @xmath2 , so that @xmath109 .",
    "if we assume that the event @xmath99 is infinite occurs with positive probability , it follows that , with positive probability , the radius of @xmath110 tends to zero and that @xmath73 hits @xmath77 , since the domain @xmath111 $ ] is compact and the continuous function @xmath112 achieves its bounds .",
    "however , @xmath73 hits @xmath77 with probability zero , contradicting the assumption .",
    "it is also useful to consider the reflected brownian motion on the positive orthant @xmath113 .",
    "the positive orthant is equipped with the standard borel sigma algebra , and we assume that @xmath114 .",
    "the map @xmath115 defined on @xmath66 extends to give the reflection map @xmath116(x ) } } \\rightarrow { \\ensuremath{c_{x_0}[0,t_0](x_+)}}\\ ] ] which is continuous .",
    "this then yields a well - defined probability measure @xmath117 on @xmath63(x_+)}}$ ] defined by @xmath118 for any measurable set @xmath119 . as for brownian motion on @xmath66 , for any sample path @xmath73 of the reflected brownian motion the sequence @xmath99 is almost surely well - defined and finite .",
    "in this section we ( i ) give a brief proof of the existence of brownian motion as a markov process on tree - space , and ( ii ) relate the corresponding distribution of sample paths to brownian motion in @xmath32 .",
    "first , however , we briefly consider brownian motion on @xmath52 , as this plays an important role in the more general case .",
    "explicit solutions to the heat equation on @xmath120 have been constructed previously  @xcite and we briefly describe those solutions here .",
    "let @xmath121 denote a point in @xmath122 where @xmath123 and @xmath124 indexes the three ` arms ' .",
    "if brownian motion starts from @xmath125 , then at time @xmath2 the density function is @xmath126 where @xmath127 denotes the density of the normal distribution on @xmath128 with mean @xmath129 and variance @xmath130 .",
    "this is the same as a certain transition density used in theorem 3.1 of  @xcite and we make use of it in our proof of existence of brownian motion on tree - space below . by construction ,",
    "brownian motion on each arm is locally the same as brownian motion on @xmath128 ; and given a particle hits the origin in some time interval @xmath131 then it is equally likely to be on each of the three arms at time @xmath132 .",
    "if we project @xmath133 in the obvious way , the density function obtained is a wrapped normal distribution , corresponding to brownian motion on @xmath53 .    the space @xmath134 is called the _",
    "open book_. the heat equation is readily solved on this space : the density function at time @xmath135 is the product of equation  @xmath136 with the density of a @xmath137-dimensional isotropic multivariate normal distribution with variance @xmath135 .",
    "it has the same properties as brownian motion on @xmath138 : away from @xmath139 the process is the same as brownian motion on @xmath140 , and given a particle hits @xmath139 then it is equally likely to be found on each ` page ' of the book at future times .",
    "brownian motion in @xmath11 is defined in the following way . within each orthant , the process is identical to brownian motion in @xmath141 .",
    "then , when a diffusing particle hits the codimension-@xmath142 boundary of an orthant , it moves with equal probability into each of the three neighbouring orthants related by nni .",
    "brownian sample paths in @xmath143 hit codimension-2 faces with probability zero , and this essentially ensures the process on @xmath11 is well - defined .",
    "brin and kifer  @xcite proved the existence of brownian motion on @xmath9-dimensional euclidean complexes as well - defined markov processes .",
    "their construction and proof can be adapted to @xmath11 .",
    "we describe the steps involved below .",
    "our aim is to define _ in distribution _ the markov process @xmath144 corresponding to brownian motion in @xmath11 , for all @xmath145 .",
    "in fact , we restrict to the case @xmath146 .",
    "( the case @xmath147 is discussed in section  [ sec : unres ] . )",
    "we need some notation : suppose that @xmath148 so that @xmath149 and @xmath22 lies on the boundary of exactly three orthants @xmath150 , @xmath151 .",
    "let @xmath152 for @xmath151 be defined by @xmath153 where @xmath154 and @xmath155 denotes the edge length associated with split @xmath25 in tree @xmath156 .",
    "note that for exactly one split @xmath157 in each @xmath158 , @xmath159 and so the inequality in equation  @xmath160 becomes @xmath161 .",
    "let @xmath162 .",
    "then @xmath102 is isomorphic to @xmath163   \\right)\\times [ 0,a(x)]^{n'-1}$ ] , which is a subset of the open book discussed in section  [ sec : spider ] .    for a point @xmath164",
    "we define @xmath144 starting from @xmath1 as the standard @xmath165-dimensional brownian motion in the orthant @xmath166 containing @xmath1 , until it hits a face of @xmath166 . for an initial point @xmath167 , the process @xmath144 is defined to be the diffusion on the open book @xmath168 restricted to @xmath169 until it exits from @xmath169 .",
    "these rules are then applied in an alternating fashion to construct @xmath144 for all @xmath145 .",
    "brownian motion in the open book is identical to brownian motion in @xmath32 away from the ` spine ' , as explained above , and so the two rules are identical on the interior of each orthant .",
    "[ thm : exist ] when @xmath170 the above construction defines @xmath144 in distribution for all @xmath145 , and @xmath144 avoids @xmath171 almost surely .",
    "this is an adaptation of the proof of theorem 3.1 in  @xcite to the context of tree - space . since brownian motion in @xmath143",
    "hits @xmath77 with zero probability , it follows from the definition of brownian motion within each orthant that @xmath144 hits @xmath171 with zero probability .",
    "next , define random times @xmath104 and @xmath172 , @xmath173 for @xmath107 .",
    "then the construction above defines @xmath144 for all @xmath135 provided @xmath174 as @xmath175 with probability 1 .",
    "assume the converse , that @xmath176 with some positive probability .",
    "then , with positive probability , @xmath109 and the side length @xmath177 of @xmath178 tends to @xmath14 as @xmath175 .",
    "now , for @xmath48 , @xmath49 can be decomposed as @xmath179 where @xmath180 denotes the set of topologies containing @xmath47 internal edges and for each such topology @xmath28 , @xmath181 is the closure of the set of trees with that topology .",
    "it is therefore possible to find a subsequence @xmath182 such that @xmath183 for all @xmath89 and for a particular tree topology @xmath184 , since @xmath185 for all @xmath89 but there are only finitely many topologies in top@xmath186 to choose from .",
    "given any tree @xmath187 , @xmath188 is bounded away from zero , but since @xmath189 there exists a topology @xmath190 such that @xmath191 and @xmath192 .",
    "we can then consider the behaviour of @xmath144 on @xmath193 where the union is taken over all fully resolved topologies @xmath194 which resolve @xmath195 . by definition ,",
    "this region includes all the trees which resolve @xmath196 , and so contains @xmath182 . within this region",
    ", @xmath197 has the same distribution as the radial part of @xmath9-dimensional brownian motion ( the bessel process ) .",
    "this is because , within this region , the squared distance from @xmath198 is given by the sum of the squared edge lengths of the two edges contracted down by projection onto @xmath198 .",
    "however , the bessel process tends to the origin with zero probability  @xcite , and this contradicts the assumption that @xmath199 with positive probability .",
    "it follows that @xmath174 as @xmath175 with probability @xmath142 , and that the construction gives a well - defined markov process @xmath144 .",
    "the aim in this section is to relate the distribution of brownian sample paths on @xmath11 to that on @xmath143 .",
    "the main idea is that there is a natural way to project paths from @xmath11 to @xmath143 providing the initial point @xmath1 is fully resolved .",
    "paths on @xmath11 in the inverse image under projection of a path on @xmath143 differ from one another in the ` choice ' of orthant taken when traversing @xmath200 .",
    "the projection enables us to write down the probability measure for certain sets of sample paths of brownian motion on tree - space in terms of the probability measure on @xmath143 .     for @xmath56 .",
    "left : three of the 15 orthants of @xmath56 are shown together with a path starting at @xmath1 .",
    "right : projection of the path into @xmath201 .",
    "each section of the path in @xmath143 is a reflection of the corresponding section within a single orthant in @xmath56 . ]    in analogy to the notation in section  [ sec : euclidean ] , we let @xmath63({\\ensuremath{\\mathcal{t}_{n}}})}}$ ] be the metric space of continuous maps @xmath64\\rightarrow { \\ensuremath{\\mathcal{t}_{n}}}$ ] which satisfy @xmath67 . the metric is defined by @xmath69 } d ( \\eta_1(t),\\eta_2(t))\\ ] ] for any two @xmath68({\\ensuremath{\\mathcal{t}_{n}}})}}$ ] where @xmath202 denotes the geodesic distance .",
    "fix a fully resolved tree @xmath203 with topology @xmath28 . then , by fixing a particular ordering of the internal edges of the tree , we obtain a corresponding point in the interior of @xmath143 . by a slight abuse of notion",
    ", we also denote this point by @xmath1 .",
    "we then define the projection map @xmath204 on paths in the following way .",
    "let @xmath205 be the subset of @xmath63({\\ensuremath{\\mathcal{t}_{n}}})}}$ ] consisting of paths which do not meet @xmath171 for all @xmath206 and which lie in @xmath207 at time @xmath2 .",
    "for any path @xmath208 we define a corresponding path @xmath209(x_+)}}$ ] in the following way . under the correspondence between the orthant @xmath41 containing @xmath1 and @xmath143 , we define @xmath210 in the natural way until @xmath73 first hits a codimension-@xmath142 face . at this point a certain edge @xmath25 has zero length and the corresponding coordinate of @xmath210 is zero . then @xmath210 is continued back into the interior of @xmath143 , maintaining all the coordinate values corresponding to edges other than @xmath25 .",
    "the remaining coordinate is given by the length of the edge @xmath211 which replaced @xmath25 on the path @xmath73 ( so that @xmath211 is either @xmath25 itself or one of the two edges obtained by nni of @xmath25 in @xmath28 ) .",
    "this process continues for all @xmath212 $ ] to define @xmath210 and gives a continuous map @xmath213(x_+)}}$ ] .",
    "figure  [ fig : drop ] illustrates how @xmath204 is defined .",
    "next for any sequence @xmath214 define @xmath215 by @xmath216(x_+ ) } } : \\pi(\\eta)\\ \\text{is well defined}\\\\ \\text{with\\ } \\pi(\\eta)=(i_1,i_2,\\ldots , i_k)\\ \\text{and\\ } \\eta(t_0)\\in\\text{int}(x_+ ) \\}.    \\end{gathered}\\ ] ] this definition includes for @xmath217 the set @xmath218 of paths which do not meet any face .",
    "the results in section  [ sec : euclidean ] show that paths sampled from @xmath117 are contained in the union of the @xmath215 almost surely , so @xmath219 the second summation is over all sequences @xmath220 of integers in @xmath221 such that no consecutive pair of terms in the sequence are equal .",
    "we need to consider the pre - images @xmath222 which are all open subsets of @xmath205 .",
    "suppose for each codimension-@xmath142 face in @xmath11 we fix an arbitrary numbering @xmath223 of the adjacent orthants .",
    "then any path @xmath73 in @xmath224 determines a sequence @xmath225 such that @xmath226 is the number of the final orthant reached before face @xmath227 is hit for @xmath228 and @xmath229 is the number of the orthant containing @xmath230 .",
    "we then let @xmath231 be the subset of @xmath224 of paths which share the same sequence @xmath232 and note that @xmath233 is a disjoint union .",
    "it follows from the definition of @xmath204 that each set @xmath231 maps to @xmath234 : @xmath235    we will be particularly concerned with the set of brownian sample paths which end in some particular region of tree - space .",
    "let @xmath236 be any subset of @xmath11 .",
    "for any @xmath34 and sequences @xmath237 and @xmath238 , let @xmath239 be the subset of @xmath240 consisting of paths @xmath73 with @xmath241 .",
    "this set will be empty unless the sequences @xmath242 determine a sequence of topologies ending in an orthant which intersects @xmath236 .",
    "similarly , given @xmath237 let @xmath243    [ lem : symm ] for any subset @xmath236 of @xmath11 and any sequences @xmath237 and @xmath238 @xmath244    it is clear that @xmath245 contains @xmath239 , and @xmath246 since @xmath247 .",
    "it remains to show the left hand side of  @xmath248 contains no elements outside @xmath239 .",
    "so suppose @xmath249 and @xmath250 satisfy @xmath251 , so that @xmath252 is a general element of the left hand side of  @xmath248 .",
    "since both paths are contained in @xmath240 , it follows that @xmath230 and @xmath253 lie in the same orthant and also enter that orthant from the same codimension-1 face of tree - space . then @xmath251 implies that @xmath73 and @xmath252 are identical in the orthant containing time @xmath2 , and in particular @xmath254 so @xmath255 .",
    "this establishes equation  @xmath248 .",
    "note that it is not necessarily the case that @xmath256 : the paths can pass through different orthants whenever @xmath210 hits the same face of @xmath143 multiple consecutive times  see figure  [ fig : bounce ] .     in @xmath56 with @xmath257 .",
    "both paths lie in the same set @xmath240 with @xmath258 but traverse a different set of topologies .",
    "left : four of the 15 orthants of @xmath56 .",
    "right : projection of the paths into @xmath201 .",
    "the set of paths would be symmetrized around the vertical axis by adding a third path which reflects back into the top - left orthant . ]",
    "the following lemma , which relates the distribution of sample paths on @xmath11 to the distribution on @xmath143 can be thought of as a tree - space analogue of the reflection principle .",
    "equation  @xmath259 is fundamental : it is equivalent to saying that if a set of paths is fully symmetric with respect to ` reflection ' into the neighbouring",
    "@xmath16 orthants whenever a path hits a codimension-1 boundary , then the probability of a tree - space brownian sample path lying in that set is given by the probability of the projected set under brownian motion on @xmath143 .",
    "[ lem : reflect ] if @xmath260 is a borel set then for any @xmath237 and @xmath238 , @xmath261 is borel in @xmath63(x_+)}}$ ] , and @xmath262 where @xmath263 denotes the probability measure on @xmath63({\\ensuremath{\\mathcal{t}_{n}}})}}$ ] induced by brownian motion .",
    "let @xmath264 be a measurable set for some @xmath237 .",
    "then consider the set of paths @xmath265 .",
    "this set of paths is fully symmetric , in the sense that if it contains some path @xmath73 which hits a codimension-1 face in @xmath11 at time @xmath135 then it also contains the paths @xmath266 which are identical to @xmath73 up to time @xmath135 but then move into the other two possible orthants at time @xmath135 and satisfy @xmath267 .",
    "it follows from the way brownian motion is constructed on tree - space that @xmath268 if @xmath73 is sampled from @xmath263 , and given that @xmath269 for some @xmath237 , then it is equally likely that @xmath73 is contained in each possible set @xmath240 where @xmath270 since the direction taken when crossing codimension-@xmath142 faces is selected uniformly at random .",
    "since there are @xmath271 possibilities for @xmath272 , it follows that @xmath273 by substituting in @xmath274 and applying lemma  [ lem : symm ] , we obtain equation  @xmath275 .    we also need to consider measurability of sets of sample paths .",
    "first note that if @xmath276 is a borel set then so is @xmath277(x_+)}}:\\eta(t_0)\\in v\\}$ ] and hence also @xmath278 .",
    "next , fix some open set @xmath260 .",
    "then @xmath239 is open in @xmath63({\\ensuremath{\\mathcal{t}_{n}}})}}$ ] and @xmath279 is also open .",
    "in fact if @xmath41 is the orthant corresponding to the end - points of paths in @xmath240 then the action of @xmath204 determines an identification @xmath280 , and @xmath281 under this identification .",
    "then @xmath282 which is open .",
    "the steps taken to generate the borel @xmath283-algebras on @xmath11 and @xmath143 from open subsets can be applied to the sets of paths ending in those subsets of @xmath11 and @xmath143 .",
    "it follows that whenever @xmath260 is a borel set , then so is the set @xmath276 corresponding to the end - points of @xmath239 , and hence @xmath261 is a borel set .",
    "we aim to prove that certain random walks on @xmath11 converge to brownian motion on @xmath11 in an appropriate sense .",
    "we do this via random walks on euclidean space @xmath66 , which we define in the following way .",
    "fix a number of steps @xmath284 and consider the following algorithm :    [ alg : rw - euc ] start with @xmath285 . for @xmath286 where @xmath287 , repeat the following :    1 .",
    "pick @xmath34 uniformly at random from @xmath288 .",
    "2 .   sample a realization @xmath289 from @xmath290 and let @xmath291 where @xmath292 is the @xmath34-th coordinate of @xmath293 .",
    "3 .   set @xmath294 but then change the @xmath34-th coordinate to @xmath295 .    other versions of this algorithm could also be used .",
    "for example , rather than sampling which edge to change at step @xmath142 , a fixed permutation of edges can be used , with each edge incremented exactly @xmath284 times at step @xmath9 .",
    "this algorithm also produces paths which converge to brownian motion on @xmath66 .    by linearly interpolating between the collection of points @xmath296 produced by the algorithm , so that each segment has time duration @xmath297 , we obtain an element of @xmath63(x)}}$ ] .",
    "we denote the distribution on @xmath63(x)}}$ ] induced by this procedure as @xmath298 .",
    "standard theory of euclidean random walks shows that @xmath299 as @xmath300 where @xmath301 denotes weak convergence of the probability measures  @xcite .",
    "we obtain the random walk on @xmath143 by mapping paths on @xmath66 to @xmath143 via the reflection map . the corresponding distribution on @xmath63(x_+)}}$ ]",
    "is denoted @xmath302 and is defined by @xmath303 for any borel set @xmath119 .",
    "random walks on @xmath143 converge to brownian motion : @xmath304 this is a straightforward consequence of the convergence of the processes on @xmath66 .",
    "next we define the random walk on @xmath11 via the following algorithm .",
    "[ alg : rw - trees ] start with a fully resolved tree @xmath305 .",
    "we maintain a list @xmath306 throughout , with @xmath306 initially empty .",
    "for @xmath286 where @xmath287 repeat the following :    1 .   pick a split an internal split @xmath25 from @xmath307 uniformly at random .",
    "2 .   sample a realization @xmath289 from @xmath290 and let @xmath308 where @xmath309 is length of @xmath25 in @xmath310 .",
    "3 .   set @xmath311 but then change a single edge length as follows : 1 .   if @xmath312 set @xmath313 .",
    "2 .   otherwise let @xmath314 be a split selected uniformly at random from the set @xmath315 where @xmath316 are splits associated with the two edges obtained by performing nni of @xmath25 in @xmath310 .",
    "replace @xmath25 with @xmath314 in @xmath293 and set @xmath317 . if @xmath318 , let @xmath319 .",
    "modifications to the algorithm , which deal with the case that @xmath1 is unresolved , are discussed in section  [ sec : unres ] . as for algorithm  [ alg : rw - euc ] , there are alternative ways to define random walk on tree - space . for example , a fixed order of edges could be used at step @xmath142 of algorithm  [ alg : rw - trees ] rather than randomly sampling edges ; or a uniform distribution could be used to increment edge lenths at step @xmath9 .",
    "it is also possible to change all the edge lengths simultaneously by using a multivariate normal distribution , although the algorithm is more complicated and so we do not give the details here .     with each orthant shown as a shaded square . at each step of the random",
    "walk a single edge changes length or is replaced with an alternative .",
    "the path between points @xmath320 corresponds to a single step of the algorithm : from point @xmath321 , the random walk reflected back from point @xmath322 to give point @xmath323 in the original orthant . in terms of algorithm  [ alg : rw - trees ] , this corresponds to a step for which @xmath324 was negative and for which @xmath325 . ]",
    "we can use algorithm  [ alg : rw - trees ] to simulate paths @xmath326({\\ensuremath{\\mathcal{t}_{n}}})}}$ ] by linear interpolation via geodesic segments between the points @xmath327 generated by the algorithm .",
    "this process is illustrated in figure  [ fig : rw ] .",
    "each geodesic segment involves a single edge in the tree changing length and possibly being replaced with an nni alternative .",
    "each geodesics consists of either a straight line within a single orthant , or a straight line consisting of two segments in neighbouring orthants , as figure  [ fig : rw ] shows .",
    "the list @xmath306 records those steps of the algorithm when the simulated random walk meets a face of an orthant and moves into the same orthant rather than either of the two neighbours . in the case",
    "that @xmath328 , the points @xmath310 and @xmath329 are not joined directly by the geodesic @xmath330 , but by a path which touches the orthant boundary . specifically , if @xmath25 is the edge whose length differs between @xmath310 and @xmath329 , then the path consists of contracting @xmath25 down to zero length from @xmath310 and then expanding the edge out to hit @xmath293 .",
    "in figure  [ fig : rw ] such a step occurs between points @xmath320 .",
    "[ lem : drop ] if @xmath73 is a path generated via algorithm  [ alg : rw - trees ] then @xmath210 has the distribution @xmath302 .",
    "the vector of edge lengths defined by the algorithm is a random walk on on @xmath143 , generated in exactly the same way as performing algorithm  [ alg : rw - euc ] on @xmath66 followed by the action of the reflection map @xmath331 .",
    "let @xmath332 denote the distribution on @xmath63({\\ensuremath{\\mathcal{t}_{n}}})}}$ ] induced by algorithm  [ alg : rw - trees ] .",
    "we will not in fact prove that @xmath333 as @xmath300 , but rather prove that @xmath334 for certain sets @xmath119 consisting of all paths which end in given regions of @xmath11 at time @xmath2 .",
    "this result is sufficient to enable us to use algorithm  [ alg : rw - trees ] to simulate approximately the distribution of particles in tree - space at time @xmath2 assuming they have undergone brownian motion starting from @xmath1 .",
    "let @xmath335 denote the distribution on @xmath11 given by the end - points @xmath336 simulated by algorithm  [ alg : rw - trees ] , or equivalently given by sampling a path @xmath73 from @xmath332 and taking @xmath230 .",
    "similarly let @xmath3 be the distribution on @xmath11 induced in a similar way , but for which @xmath73 is drawn from @xmath263 .",
    "then @xmath337 for any measurable @xmath338 , where @xmath339 denotes the set of all paths which hit @xmath119 at time @xmath2 .",
    "if @xmath340 is a measure on a measurable metric space , then a @xmath340-continuity set @xmath236 is a borel set such that @xmath341 where @xmath342 is the boundary of @xmath236 . in order to prove weak convergence , it is sufficient to show that @xmath343 for any @xmath3-continuity set @xmath236 .",
    "[ lem : ctty ] if @xmath260 is a @xmath3-continuity set , then    a.   @xmath239 is a @xmath263-continuity set for any sequences @xmath242 , and b.   @xmath344 is a @xmath117-continuity set .",
    "fix a @xmath3-continuity set @xmath260 and sequences @xmath242 of length @xmath34 .",
    "let @xmath41 be the orthant corresponding to the end points of paths determined by the sequences @xmath242 .",
    "the boundary of @xmath345 decomposes into two pieces : @xmath346 and a set of paths which end at time @xmath2 on @xmath200 .",
    "both these have zero measure with respect to @xmath263 so : @xmath347 and @xmath239 is a @xmath263-continuity set .",
    "given @xmath242 , @xmath204 is an isomorphism between @xmath240 and @xmath348 .",
    "it follows that @xmath349 decomposes into two parts : @xmath350 and another set of paths which end on the boundary of @xmath143 and which therefore have zero measure with respect to @xmath117 .",
    "thus if @xmath236 is a @xmath3-continuity set , using lemma  [ lem : reflect ] we have : @xmath351 and so @xmath352 is a continuity set with respect to @xmath117 .",
    "[ thm : conv ] @xmath353 as @xmath300 .",
    "fix any borel set @xmath260 , and fix @xmath34 , @xmath237 and @xmath270 .",
    "the proof of lemma  [ lem : reflect ] also applies to random walks , giving @xmath354 which is analogous to equation  @xmath275 .",
    "if @xmath236 is a @xmath355-continuity set then as @xmath300 @xmath356 convergence in equation  @xmath357 occurs because random walk on @xmath143 converges weakly to brownian motion , and by lemma  [ lem : ctty ] @xmath261 is a continuity set with respect to @xmath117 .",
    "now for any continuity set @xmath236 @xmath358 since this is bounded above by @xmath142 , for any @xmath92 there exists @xmath359 such that : @xmath360 and @xmath361 then , by taking @xmath284 sufficiently large @xmath362 and so @xmath363 .",
    "this proves the weak convergence in equation  @xmath364 .",
    "in theorem  [ thm : exist ] it was assumed that @xmath1 contains at least @xmath365 edges , and in theorem  [ thm : conv ] it was assumed that @xmath1 was fully resolved . in this section",
    "we consider existence of brownian motion and convergence of random walks when these assumptions are dropped .",
    "first we need to extend algorithm  [ alg : rw - trees ] when @xmath1 is unresolved .",
    "this is achieved by redefining @xmath366 in the following way . a fully resolved topology which resolves @xmath1",
    "is chosen uniformly at random . then , as a set of weighted splits , @xmath366 is taken to have this topology .",
    "we set @xmath367 for all splits @xmath25 in @xmath1 but set @xmath368 for the remaining splits in the fully resolved topology .",
    "algorithm  [ alg : rw - trees ] then proceeds in the same manner , sampling @xmath369 in turn . with this definition in place",
    ", we turn attention to existence of the brownian motion .",
    "theorem  [ thm : exist ] above proves existence of brownian motion when @xmath1 is fully resolved or when @xmath370 . in the proof of existence of brownian motion on @xmath9-dimensional euclidean complexes in  @xcite , from which theorem  [ thm : exist ] was adapted , the case that the brownian motion starts from a vertex @xmath371 required special attention : see  @xcite , theorem 3.2 .",
    "it is this theorem we need to adapt to prove existence of the brownian motion for @xmath372 .",
    "the main idea is that there is a weak limit of the markov process transition probabilities as @xmath373 .",
    "this is shown in  @xcite by working in a form of polar coordinates around @xmath371 , to decompose the brownian motion into a radial component and a transverse component .",
    "the radial component is a bessel process , and it is shown that for small @xmath374 , the exit distribution of the brownian motion on a @xmath374-neighbourhood of @xmath375 is uniform .",
    "this motivates the definition of @xmath366 in the previous paragraph : in tree - space the brownian motion will move away from any unresolved @xmath1 into the interior of an orthant containing @xmath1 , with each orthant equally likely .",
    "however , it is difficult to extend the analysis in  @xcite , theorem 3.2 , over to tree - space due to the greater number of dimensions , and the different types of singularity in the space .",
    "for example , consider the case @xmath376 and a tree @xmath377 which contains a single internal edge with positive length .",
    "each such tree lies on an axis shared by several @xmath16-dimensional orthants .",
    "the brownian motion near @xmath1 decomposes as a bessel process representing the perpendicular distance from the axis ; a brownian motion along the axis ; and a stochastic process on a space consisting of one circular arc with angle @xmath378 for each orthant containing @xmath1 .",
    "thus the geometric decomposition of the brownian motion near @xmath1 depends on the codimension of the singularity represented by @xmath1 .",
    "however , when @xmath1 is the star - tree the brownian motion is tractable : at time @xmath135 the density on each orthant is proportional to a multivariate normal density at the origin and with variance - covariance matrix @xmath379 .",
    "it is evident that the random walk from @xmath1 converges to this distribution .",
    "the proof of theorem  [ thm : conv ] relies on the projection map @xmath204 being well - defined and continuous .",
    "in fact , when @xmath1 contains @xmath365 internal edges , the definition of @xmath204 in section  [ sec : sample_paths ] does not require any modification , and the proof of theorem  [ thm : conv ] still holds .",
    "however , when @xmath372 there is no canonical definition of @xmath204 .",
    "it is important to note that , due to non - trivial holonomy in tree - space , there is no continuous map @xmath380 which acts as an isomorphism @xmath280 on each orthant when @xmath381 .",
    "( the map @xmath204 defined in section  [ sec : sample_paths ] operates specifically on _ paths _ in tree - space , and so the existence of @xmath204 when @xmath1 is fully resolved does not contradict the previous statement . ) a proof of convergence when @xmath372 might consider a small @xmath374-neighbourhood of @xmath1 .",
    "the discussion in the previous paragraph suggests that the brownian motion will exit this neighbourhood at a fully - resolved tree uniformly at random on the boundary of the neighbourhood , and the proof of theorem  [ thm : conv ] would then apply from this point onwards .",
    "clearly , the extension of theorems  [ thm : exist ] and  [ thm : conv ] to the general case of unresolved @xmath1 requires more technical analysis than developed here , and we leave this as an open problem .",
    "we have introduced brownian motion on tree - space as a means of constructing a family of distributions @xmath3 .",
    "our aim is to use these distributions to build more sophisticated probability models on tree - space , and perform inference for these models .",
    "the simplest model is to consider a set of data points @xmath382 as being independent draws from @xmath3 .",
    "inference algorithms for the parameters @xmath383 under this model are being developed and will be the subject of future publications .",
    "however , these are based on the use of random walks to approximate brownian motion on tree - space , and so a very important first step has been to establish convergence , as demonstrated in this article .",
    "furthermore , the brownian motion studied in this article could be generalized in several different ways by analogy with diffusion processes in euclidean space .",
    "for example , it might be possible to construct a diffusion with a non - trivial covariance structure corresponding to a diffusion with ` preferred directions ' in tree - space .",
    "similarly , it seems possible to adapt brownian motion in tree - space in order to define a mean reverting stochastic process , an analogue of the ornstein - uhlenbeck process .",
    "inference for models using these stochastic process is likely to rely on forward simulation , and will therefore build on the existence and convergence results established in this article ."
  ],
  "abstract_text": [
    "<S> the set of all phylogenetic trees for a fixed set of species forms a geodesic metric space known as billera - holmes - vogtmann tree - space . in order to analyse samples of phylogenetic trees </S>",
    "<S> it is desirable to construct parametric distributions on this space , but this task is very challenging . </S>",
    "<S> one way to construct such distributions is to consider particles undergoing brownian motion in tree - space from a fixed starting point . </S>",
    "<S> the distribution of the particles after a given duration of time is analogous to a multivariate normal distribution in euclidean space . </S>",
    "<S> since these distributions can not be worked with directly , we consider approximating by suitably defined random walks in tree - space . </S>",
    "<S> we prove that as the number of steps tends to infinity and the step - size tends to zero , the distributions obtained by random walk converge to those corresponding to brownian motion . </S>",
    "<S> this result opens the possibility of statistical modelling using distributions obtained from brownian motion on tree - space . </S>"
  ]
}