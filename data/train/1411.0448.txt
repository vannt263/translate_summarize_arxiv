{
  "article_text": [
    "we have shown that a four - waveguide nonlinear waveguide array ( wga ) can be used to generate any linear combination of the set of bell states .",
    "in fact domain poling patterns in waveguide arrays provide nearly limitless freedom to produce different quantum states .",
    "this , combined with wga s dynamic all - optical reconfigurability , provides a very flexible source of quantum states of light .    to design a waveguide array capable of being optically reconfigured over a given output space",
    "the array must be able to produce the set of basis output states , @xmath66 , that define the full output space .",
    "if these states can be produced from the device by only varying the pumping lasers , then the device can be reconfigured over the full subspace to any state @xmath67 . as we will show in this section , degeneracies in wga s transverse modes mean that not every subspace defined by a set of arbitary @xmath66 can be spanned . in section",
    "[ sec : removing ] we show that this limitation is removed if the degeneracies are broken by introducing refractive index differences between waveguides .    to investigate the effect of degeneracies on the output space of a wga it is convenient to consider using domain poling structures in the wga with different poling periods in different locations .",
    "localized adjustment of the poling period allows phase matching with particular transverse modes of the array .",
    "this lets us to isolate and drive each transverse mode in different sections of the array , thus allowing any linear combination of these modes to be produced at the output of the array .",
    "hence any quantum state can be produced at the end of the array given that all the transverse modes can be driven individually . to demonstrate this we consider eq .",
    "( 2 ) from the main publication , showing the output from the array in terms of transverse modes @xmath68 ,    @xmath69    ) of the transverse modes , @xmath70 , for a four - waveguide array .",
    "the dashed line shows the axis of symmetry @xmath71 .",
    "the red rectangle shows the degenerate eigenvalues along the line @xmath72 , these all have propagation constants of zero , so can not be driven individually using varied poling periods . ]    here we see that poling the nonlinear coefficient , @xmath26 , with a frequency of @xmath73 will selectively drive transverse modes that have propagation constants ( ie : eigenvalues ) @xmath74 .",
    "hence transverse modes with unique propagation constants can be phase matched and driven individually , without affecting other modes . in order to determine which modes have unique propagation constants we must look at the spectrum of the modes eigenvalues as a function of @xmath75 and @xmath76 . in the main text",
    "this is given as ,    @xmath77 , \\label{values}\\ ] ]    and a plot of the modes propagation constants for @xmath78 is shown in fig .",
    "[ fig : first ] .",
    "first it is important to note that the equation is transcendental , so there will be some randomly occurring degeneracies , especially for large @xmath22 .",
    "there will also be some degeneracies that can be predicted analytically . here",
    "we will consider only the degeneracies that can be predicted analytically , since in wga s with only a few waveguides these are by far the most common type of degeneracy .",
    "the most obvious of these predictable degeneracies occurs because the signal and idler are indistinguishable , so naturally @xmath79 , and the eigenvalues are symmetric across the main diagonal .",
    "this degeneracy is not an obstacle to showing that the device can generate any quantum state because it arises from the particles themselves rather than from the wga .",
    "however there will also be degenerate eigenvalues when @xmath72 , since in this case @xmath80 for all @xmath75 .",
    "this degeneracy corresponds to the set of modes where the entangled signal and idler photons have equal and opposite propagation constants , so the net propagation constant of the state is zero .",
    "this presents a problem , because now the degenerate eigenvalues correspond to distinguishable states , but we can not drive these states independently with domain poling .    as a result of the degeneracy of the @xmath81 modes just choosing the domain poling period can not drive the modes individually .",
    "this limitation can be overcome by adjusting the pump intensity in each waveguide .",
    "the degenerate transverse modes , @xmath81 , have distinct spatial profiles for each @xmath75 . hence shaping the spatial profile of the laser driving of",
    "the device can drive one of the transverse modes without exciting the others . coupling the pump laser into different waveguides will change the rate each of the modes @xmath70 is driven at .",
    "we will call the rate each mode is driven at , @xmath82 , the pump profile . from eq .",
    "( [ main_sol_supp ] ) we can see the pump profile is given by    @xmath83    where @xmath19 denotes the waveguide numbers the pumping lasers are coupled to . now to control the driving rate of modes with degenerate eigenvalues we should look at @xmath84 ,    @xmath85    this is the rate that each of the degenerate modes @xmath81 is driven at when pumping each waveguide with an arbitary intensity and phase pump laser @xmath86 .",
    "it is equivalent to    @xmath87.\\ ] ]    now if we drive each waveguide with laser field given by @xmath88 then @xmath89 . here",
    "@xmath90 denotes the mode number of the pump .",
    "this pump profile allows the mode @xmath91 to be addressed individually , without exciting the other modes sharing its degenerate propagation constant . by using a linear combination of these pump profiles ,",
    "ie @xmath92 any linear combination of the degenerate modes can be driven .",
    "therefore the degeneracy in the modes propagation constants can be overcome by carefully shaping the pumping , @xmath86 , to exploit the spatial differences between degenerate modes .",
    "importantly pumping with the profiles @xmath93 never excites the degenerate @xmath94 modes .",
    "so this gives @xmath95 degrees of freedom for exciting other modes while simultaneously using the @xmath96 pumping profile to excite the @xmath95 degenerate @xmath94 modes .",
    "this could be useful for allowing reconfigurability , despite degeneracies , by appropriate shaping of the poling structures in the array .",
    "in conclusion we have shown that waveguide arrays can be designed to span large quantum output spaces via all - optical reconfigurability , even in the presence of degeneracies . through careful choice of which waveguide is driven to produce which basis state , @xmath66 , the desired output space can often be spanned .",
    "for example in the main publication we show that the set of four bell states can be spanned with pump excitation of individual waveguides .",
    ") will produce degenerate two photon propagation constants .",
    "also in ( a ) some transverse modes have no intensity in certain waveguides , meaning they can not be driven in that waveguide . in ( b ) we see that both the degeneracies in the propagation constants , and the zero points in the mode profiles have been removed . ]",
    "we now consider how degeneracies could be removed from a nonlinear waveguide array to allow it to span any @xmath22 dimensional biphoton output space .",
    "although , as shown in the main publication , arrays with small numbers of waveguides can span interesting output spaces such as the bell states , in principle not every output space can be spanned due to degeneracies .",
    "this becomes more important for large numbers of waveguides because increasing numbers of modes increases the probability that the transcendental equation for the eigenmodes ( eq . [ values ] ) will produce more degeneracies .",
    "degeneracies occur when the difference between two single - photon modes eigenvalues are the same .",
    "this can be shown by assuming a pair of two - photon modes are degenerate , @xmath97 then inverting to find a condition relating to the difference between eigenvalues of single - photon modes , @xmath98    so to remove degeneracies we require that all the differences between eigenvalues of single - photon modes , @xmath99 , are not equal .",
    "this could be achieved by tuning the refractive index in each waveguide to ensure eq .",
    "( [ cond ] ) is violated for all single photon modes . in fig .",
    "( [ fig : modes ] ) we give an example of this degeneracy breaking for an array of five waveguides .",
    "this shows that a small adjustment in refractive index can remove degenerate propagation constants as well as removing zero points from transverse modes .    allowing for different refractive indices in all waveguides the propagation of biphotons",
    "is determined by ,    @xmath100 + ( \\delta\\beta_{n_s}+\\delta\\beta_{n_i})\\psi_{n_s , n_i } , \\label{rimain}\\ ] ]    where @xmath101 is the sum of the propagation constants due to refractive index modulation in the waveguides occupied the by signal and idler photons .",
    "we now introduce a new set of transverse single - photon modes , @xmath102 , to account for the new propagation constants in the array .",
    "these are eigenmodes of the combined single - photon coupling and propagation operators from eq .",
    "( [ rimain ] ) , so for the @xmath103 mode    @xmath104 + \\delta\\beta_{n}u^{(k)}_{n } .",
    "\\label{singleri}\\ ] ]    the two - photon wavefunction produced by down conversion can be expressed in terms of pairs of single - photon modes such that , @xmath105 . writing eq ( [ rimain ] ) in terms of @xmath106 gives ,    @xmath107    here @xmath108 and @xmath109 is the spatial overlap between the pumping and the real space profile of the two - photon mode , @xmath110 .",
    "the solution to eq .",
    "( [ risol1 ] ) is @xmath111 this is analogous to eq ( [ main_sol_supp ] ) , but now with a new set of modes and eigenvalues . from this equation the two conditions to exclusively drive any two - photon mode in any waveguide are evident .    1 .",
    "the mode must have a unique eigenvalue , @xmath112 , so that mode can be selectively driven by poling at the resonant spatial frequency @xmath113 .",
    "2 .   it must be possible to drive the mode by pumping any waveguide , so the overlap of the mode , @xmath109 , must be nonzero , when each waveguide is driven individually .",
    "the first condition ensures that each mode can be driven exclusively , while the second condition ensures that this exclusive driving can occur in any waveguide . in fig .",
    "( [ fig : modes ] ) it is shown that both criteria are satisfied for an array of five waveguides , but only after one waveguide is given a different refractive index to the others , so that @xmath114 for one waveguide in eq .",
    "( [ rimain ] ) .",
    "these two criteria make it possible to design a wga to span any desired @xmath22 dimensional output space .",
    "this would be achieved by poling each waveguide with @xmath23 different segments of poling .",
    "each segment being poled with a period @xmath115 to phase match a particular mode .",
    "if the length of each segment is set so that @xmath116 then only the mode that is phase matched will be produced in a particular segment .",
    "then , by varying the relative length of each segment , any linear combination of modes can be produced at the end of the array .",
    "this process could be used in every waveguide , engineering each to produce a different state @xmath66 .",
    "then driving the waveguides simultaneously can span the entire space defined by the @xmath66 .",
    "since the @xmath66 can now , in the absence of degeneracies , be set to any state this means that the array can now be engineered to be all - optically reconfigured over any @xmath22 dimensional subspace .",
    "so in conclusion waveguide arrays can be engineered to span any @xmath22 dimensional quantum output space .",
    "however this will generally require some optimization of the refractive index in each waveguide in order to remove degeneracies .",
    "fabrication of complex domain poling patterns in waveguide array devices will no doubt involve some systematic and random errors .",
    "typically large numbers of devices with varied parameters will be fabricated on a single chip , and then the quantum properties of each device will be characterized .",
    "the task of characterising each device is very time consuming due to the difficulty of the quantum correlation measurements and the shear number of devices to be characterized . in order to efficiently test which devices operate correctly and which have unacceptably large fabrication errors one can use the stimulated emission tomography @xcite approach based on classical difference frequency generation as an alternative to measurements of the quantum correlations caused by spdc .",
    "this would provide a quick and efficient way of separating defective devices from correctly operating ones .",
    "then further more detailed characterization can be preformed on devices that pass the initial classical dfg testing .    here",
    "we show how to use classical difference frequency generation in a waveguide array to determine the quantum wavefunction that would be produced by spdc .",
    "spontaneous parametric down - conversion ( spdc ) is the quantum analogue of difference frequency generation ( dfg ) .",
    "the key difference being that dfg is stimulated by a specific photon state ( the seed laser ) where as spdc is stimulated via quantum vacuum fluctuations .",
    "this implies it is possible to reconstruct the biphoton wavefunction that would be produced by spdc by carefully choosing the seed field of dfg to mimic quantum vacuum fluctuations , as is demonstrated in @xcite .",
    "we show how to apply this technique to arrays of coupled waveguides , allowing characterization of the spdc wavefunction using classical dfg measurements .",
    "first we derive the equation for dfg in an array of coupled waveguides .",
    "then we show how seeding the array with a specific seed field profile allows reconstruction of an idler field proportional to the spdc wavefunction .",
    "finally we demonstrate that a complex seed profile is not actually needed to simulate spdc",
    ". we can instead simply seed one waveguide at a time , then add a linear combination of the output idler fields together to achieve the same output that would be produced by the seed with complex spatial profile .",
    "this is due to the linearity of idler field with respect to the seed field in the case of negligible pump depletion .",
    "the equation for the idler field produced by dfg in an array of coupled waveguides is @xmath117 \\\\",
    "+ \\sum\\limits_{n_p = 1}^{n } i{e_{n_{s}}^{(s)}}^ * a_{n_{p } }   d_{n_{p}}(z ) e^{i \\delta \\beta^{(0 ) } z } \\delta_{n_{i},n_{p } } \\delta_{n_{s},n_{p } } \\label{dif}\\ ] ] where we assume the fields of the pump ( @xmath1 ) , and seed ( @xmath118 ) lasers are undepleted , and also that only one waveguide ( @xmath14 ) is driven by the pump laser .",
    "we can solve this equation in the same way as for the spdc case . using reciprocal space defined by @xmath119",
    "we get ,                            equations ( [ spdc_f ] ) and ( [ dfg_f2 ] ) are very similar , except in the classical dfg case all the seed modes , @xmath31 , are summed over , eliminating the correlation between signal and idler . now in eq .",
    "( @xmath134 ) we can set @xmath135 so that the input seed is in some eigenstate of the coupling operator .",
    "this means that the output dfg state will be proportional to the spdc state @xmath136 .",
    "so by making n measurements of the dfg output for @xmath137 we can construct the full spdc wavefunction @xmath138 . also we give the initial seed mode a specific phase so that it matches the spdc equation , hence the required seed profile is @xmath139 , this gives             using the transformation in equation ( [ final_supp ] ) on the dfg output given in figure ( [ f ] ) .",
    "this confirms that the biphoton wavefunction produced by spdc would be the desired bell state , while avoiding the need to measure spacial entanglement between photons directly .",
    "( a ) gives the intensity and ( b ) the phase of the reconstructed wavefunction , @xmath144 . ]     using the transformation in equation ( [ final_supp ] ) on the dfg output given in figure ( [ f ] ) .",
    "this confirms that the biphoton wavefunction produced by spdc would be the desired bell state , while avoiding the need to measure spacial entanglement between photons directly .",
    "( a ) gives the intensity and ( b ) the phase of the reconstructed wavefunction , @xmath144 . ]    we have shown that dfg with the seed pulse in a particular transverse mode will be proportional to one row of the spdc wavefunction ( a phase factor is also required ) .",
    "so by taking multiple measurements of dfg ouput , with the seed in a different mode each time , it is possible to reconstruct the complete quantum mechanical wavefunction produced by spdc .",
    "however in practise it would be difficult to couple a seed laser into a waveguide array in a specific transverse mode .    typically the easiest quantity to measure",
    "would be the output idler field produced when seeding only one waveguide and pumping only one waveguide .",
    "so we will assume that this is the quantity that is actually measured , and show how to reconstruct the spdc wavefunction from the measured values .",
    "we denote the measured outputs dfg outputs @xmath145 , where @xmath32 is the transverse mode of the output , and @xmath146 the waveguide number that is seeded with the seed laser ( @xmath19 denotes the pumped waveguide , but it is unnecessary to use this as an index ) .      note",
    "that setting @xmath147 implies that the seed magnitude and phase remain the same when changing the seed laser to different waveguides , @xmath146 , to measure different elements of @xmath149 .",
    "in general it is not necessary to keep the intensity and phase the same , but any variations must be known to reconstruct the spdc wavefunction . here",
    "we assume for simplicity that the phase and intensity of the seed remains constant regardless of which waveguide is seeded .",
    "now once the idler output has been measured with the seed in each of the @xmath22 waveguides the spdc wavefunction can be mathematically reconstructed from the measured values .",
    "this gives a reconstructed function @xmath150 which is proportional to the spdc wavefunction in eq ( [ spdc_f ] ) , @xmath151    here we add together a superposition on the measured outputs , weighted by a @xmath152 function , and multiplied by a phase factor @xmath153 .",
    "the @xmath154 argument determines which column of the spdc wavefunction is reconstructed . to confirm that @xmath155 is a resonstruction of the spdc wavefunction we substitute in the full equation for @xmath145 then simplify , @xmath156 summing over the seeded waveguide number , @xmath146 @xmath157 this is proportional to the expression for the down converted wavefunction in eq .",
    "( [ spdc_f ] ) .",
    "the same transformation can be applied to the real space version of the dfg output ,      then the real space spdc wavefunction can be recovered by transforming back from @xmath154 space to @xmath159 space @xmath160 this transformation allows reconstruction of the quantum spdc wavefunction from measurements of the idler fields produced by dfg with only one waveguide seeded at a time .",
    "it would be straightforward to generalize this procedure to the case of inhomogeneous refractive indices considered in section [ sec : removing ] .",
    "so in principle fast classical characterization could be applied to arrays with varied refractive indices .",
    "we have shown that a complete set of intensity and phase measurements of the dfg output of a device can be used to fully reconstruct the spdc wavefunction .",
    "this will allow for quicker characterization of large numbers of devices .",
    "however this procedure will require measurements of phase difference between light in adjacent waveguides which will be much more difficult than intensity measurements .",
    "hence a good first step for characterization would be to measure the intensity in each waveguide produced by dfg and compare this with the intensity predicted by eq .",
    "( [ dfg_f2 ] ) using the target fabrication parameters . then",
    ", if the intensity measurements are in reasonable agreement with the target values , phase measurements could be taken to reconstruct the complete spdc wavefunction .",
    "if the reconstructed wavefunction matches that target spdc wavefunction then finally quantum correlation measurements of down converted photons can be used confirm the quantum properties of the device .",
    "this three - tiered characterization procedure will allow the majority of defective devices to be quickly identified and discarded using classical measurement techniques .",
    "hence less time will be spent preforming complex quantum correlation measurements on defective devices , considerably speeding up the characterization of quantum photonic chips ."
  ],
  "abstract_text": [
    "<S> we predict that all - optically reconfigurable generation of photon pairs with tailored spatial entanglement can be realized via spontaneous parametric down - conversion in integrated nonlinear coupled waveguides . </S>",
    "<S> the required elements of the output quantum wavefunction are directly mapped from the amplitudes and phases of the classical laser pump inputs in each waveguide . </S>",
    "<S> this is achieved through special nonuniform domain poling , which locally inverts the sign of quadratic nonlinear susceptibility and accordingly shapes the interference of biphoton quantum states generated along the waveguides . </S>",
    "<S> we demonstrate a device configuration for the generation of any linear combination of two - photon bell states .    </S>",
    "<S> entanglement is a key characteristic of quantum mechanics , and as shown by bell @xcite , is responsible for quantum theories violation of the classical principle of local relativistic causality . </S>",
    "<S> as well as being of fundamental scientific interest , quantum entanglement can enable powerful new technologies such as quantum computing @xcite , quantum communication @xcite , and quantum enhanced measurement @xcite . </S>",
    "<S> however the highly advantageous non - classical properties of these technologies will require a flexible interface between the classical and quantum worlds . </S>",
    "<S> indeed the development of such an interface is an area of active research @xcite , the dominant method being spontaneous parametric down - conversion ( spdc ) , where a classical laser interacts with a @xmath0 nonlinear medium to produce entangled photons @xcite .    </S>",
    "<S> photons are an ideal platform for creating and manipulating quantum information due to the low noise from the environment and ease of transmission . </S>",
    "<S> a qubit encoded into a photon can be easily sent between different photonic elements along an optical fiber , in analogy to the transmission of classical bits along electrical wires @xcite . </S>",
    "<S> furthermore , logic operations can be preformed on entangled photons by exploiting the nonlinearity inherent in quantum measurement , or by using the interaction between multiple light fields via a nonlinear medium @xcite . </S>",
    "<S> however in order for these properties to be fully utilized it must first be possible to quickly map information onto the quantum state of entangled photons . </S>",
    "<S> therefore an entangled photon source with fast all - optical reconfigurability of the output wavefunction would be an important step towards realizing new quantum technologies .     </S>",
    "<S> ( colour online ) ( a ) diagram of a nonlinear waveguide array . a pump laser field , </S>",
    "<S> @xmath1 , shown in blue , drives a waveguide in the nonlinear waveguide array , interaction between the laser and the nonlinearity of the driven waveguide produces entangled photons ( red ) via spdc . </S>",
    "<S> these entangled photons can couple into neighbouring waveguides , producing path - entangled states , @xmath2 , at the output . </S>",
    "<S> ( b ) top view of the array . </S>",
    "<S> each waveguide is divided into a number of segments , with different aggregate values of second order nonlinearity . </S>",
    "<S> the aggregate nonlinearity is controlled by varying the ratio of up - to - down poling ( the duty cycle ) of the nonlinear crystal . ]    </S>",
    "<S> the practicality of any of these technologies will be determined by their scalability and reliability ; this suggests the use of quantum photonic circuits will be essential . </S>",
    "<S> integrated circuits can produce and control entangled photons far more efficiently than traditional bulk optics . </S>",
    "<S> integrating optical elements onto a single chip reduces the systems contact with the environment , preserving the fidelity of the quantum entanglement @xcite . </S>",
    "<S> also integrated devices are compact and stable , so they can be combined to build complex quantum circuits that would be impossibly large using traditional bulk optics . hence a practical source of entanglement will require the reconfigurable generation and control of entangled photons to be integrated within a photonic chip .    </S>",
    "<S> the latest experimental developments @xcite suggest that the goal of a fully integrated and optically reconfigurable source of entangled photons is achievable , but there is still some way to go . </S>",
    "<S> for instance @xcite show that entangled photons could be created on - chip , while @xcite demonstrate that the reconfigurable manipulation of entangled photons in quantum photonic circuits is possible . indeed </S>",
    "<S> the on - chip generation of photon pairs and their interference using tunable phase shifters was demonstrated in @xcite , although all - optical reconfigurability as well as the ability to generate a full set of bell states and their superpositions are yet to be achieved .    in this work </S>",
    "<S> we predict that a photonic chip consisting of an array of coupled nonlinear waveguides @xcite can be designed for all - optically controlled generation of any set of path - entangled biphoton states . </S>",
    "<S> this device is particularly elegant because the output quantum wavefunction is directly mapped from the amplitudes and phases of the classical laser inputs . </S>",
    "<S> hence the device can be reconfigured in real time by varying classical inputs , providing a flexible interface between classical and quantum information .    </S>",
    "<S> we illustrate the device concept in fig .  </S>",
    "<S> [ fig : diagram](a ) . </S>",
    "<S> laser driving one of the waveguides in the nonlinear waveguide array ( wga ) will generate entangled photon pairs in the driven waveguide via spdc . </S>",
    "<S> the waveguides are coupled such that the biphotons ( entangled photon pairs ) can tunnel between neighbouring waveguides , but the pumping laser is confined to one waveguide . </S>",
    "<S> this is an example of a driven quantum walk @xcite of pairs of entangled particles . </S>",
    "<S> it has been shown that the interference between the probability amplitudes of different biphoton paths can lead to highly non - classical states at the output of the device @xcite . </S>",
    "<S> it remained an open question as to whether the wga could be tuned to produce custom and reconfigurable quantum states , and we demonstrate this can be achieved through specially designed domain poling , as illustrated in fig .  </S>",
    "<S> [ fig : diagram](b ) .    </S>",
    "<S> we consider a near - degenerate frequency range of the spdc output , such that the signal and idler photons frequencies are approximately equal to half the pump frequency , @xmath3 . </S>",
    "<S> then the state of biphotons within the array is described by the quantum wavefunction @xmath4 . here </S>",
    "<S> @xmath5 is the biphoton wavefunction , @xmath6 is the distance along the propagation direction of the wga , @xmath7 is the creation operator for a signal photon in the waveguide number @xmath8 $ ] , similarly @xmath9 is the creation operator for the correlated idler photon in waveguide @xmath10 , and @xmath11 is the vacuum state .    </S>",
    "<S> the biphoton wavefunction obeys the differential equation @xcite @xmath12 . \\label{main}\\end{gathered}\\ ] ] here the first term on the right is the generation of new biphotons via spdc , with classical laser driving amplitude @xmath1 and second order nonlinear coefficient @xmath13 in waveguide number @xmath14 , while the phase mismatch is denoted as @xmath15 . </S>",
    "<S> the last term on the right describes the evanescent coupling of signal and idler photons between neighboring waveguides with the coupling rate given by @xmath16 . due to the symmetry in eq .  </S>",
    "<S> ( [ main ] ) , for the initial vacuum state @xmath17 , the biphoton wavefunction is symmetric , @xmath18 , at all @xmath6 .    </S>",
    "<S> it is important to note that the propagation of biphotons in a nonlinear waveguide array is essentially linear . </S>",
    "<S> so if driving the waveguide @xmath19 with unity pump amplitude produces the quantum output state @xmath20 , then driving multiple waveguides produces the state @xmath21 . </S>",
    "<S> therefore by varying the @xmath22 classical laser inputs , @xmath1 , we can reconfigure the device in real time to produce any state in an @xmath22 dimensional quantum space . </S>",
    "<S> however this is only a subspace of the total quantum output space , which will have @xmath23 degrees of freedom , namely the probability amplitudes of pairs of photons occupying any two of n waveguides .    </S>",
    "<S> we determine that the total output space can be accessed by introducing special domain poling patterns in the wga [ fig .  </S>",
    "<S> [ fig : diagram](b ) ] . </S>",
    "<S> adjusting the domain poling pattern allows us to choose the exact form of the @xmath22 dimensional subspace that is spanned by varying the classical laser inputs to the device . </S>",
    "<S> this is achieved by optimizing the poling in each waveguide to produce a specific ` basis state ' , @xmath24 , when it is pumped individually . </S>",
    "<S> this method provides an all - optically reconfigurable quantum source .    </S>",
    "<S> the typical use of domain poling is to achieve quasi - phase matching ( qpm ) for @xmath0 nonlinear processes @xcite . </S>",
    "<S> qpm involves periodically inverting the orientation of the ferroelectric dipole moment in the nonlinear medium ; this corresponds to altering the sign of the second order nonlinearity in the medium . </S>",
    "<S> the technique has also been used to shape the wavefront of down converted photons in bulk nonlinear crystals @xcite . </S>",
    "<S> we utilize domain poling within the waveguide array structure to alter the sign of the nonlinear coefficient , @xmath13 , as a function of waveguide number , @xmath14 , and propagation length , @xmath6 . </S>",
    "<S> this effectively inverts the quantum phase of biphotons generated at different points along the array , enabling controlled interference between different biphoton paths .    </S>",
    "<S> as in qpm we alter the nonlinearity to create poling structure with periodicity that cancels out the phase mismatch of the spdc process . </S>",
    "<S> however we modulate the ratio of up to down poling ( the duty cycle ) to allow us to tune the efficiency of spdc , and effectively vary the aggregate value of the nonlinear coefficient along the length of each waveguide </S>",
    "<S> . we will show that this aggregate nonlinear coefficient makes it possible to find a general solution for the poling pattern required to produce any arbitrary biphoton wavefunction . </S>",
    "<S> this general solution amounts to solving eq .  </S>",
    "<S> ( [ main ] ) for @xmath25 and then inverting the result to express the poling structure , @xmath26 , in terms of @xmath25 . </S>",
    "<S> the role of the aggregate nonlinearity is to mediate between the discrete valued poling structure and the continuous valued biphoton wavefunction . </S>",
    "<S> the solution to eq . </S>",
    "<S> @xmath27 is found in terms of the discrete fourier sine transform of the wavefunction , @xmath28 ,     ( color online ) ( a),(b),(c),(d )  target output biphoton states produced when each of the four waveguides is pumped individually . </S>",
    "<S> the states are equivalent to bell states using dual - rail encoding @xcite , where the signal photon occupying waveguide 1(3 ) represents a logical 0(1 ) and similarly for the idler photon in waveguides 2 and 4 . </S>",
    "<S> ( e )  the values of the aggregate nonlinear coefficient , @xmath29 along the length of each waveguide . </S>",
    "<S> the pump laser interacts with these aggregate nonlinear coefficients to produce the corresponding target outputs in ( a),(b),(c),(d ) . ]    </S>",
    "<S> @xmath30    here @xmath31 and @xmath32 are the transverse momenta of the biphotons , @xmath33 is a new phase mismatch term resulting from the transverse momentum of photons within the array , and @xmath34 is the total length of the array .    in practical implementations of this type of waveguide array </S>",
    "<S> the phase mismatch inherent in the waveguide is much larger than the transverse mode phase mismatch , i.e. @xmath35 . therefore in eq .  </S>",
    "<S> ( [ main_sol ] ) we can separate the integral over the total phase mismatch into slowly and quickly varying terms , @xmath36 and @xmath37 respectively . under this approximation </S>",
    "<S> the integral over @xmath6 in eq . </S>",
    "<S> @xmath38 becomes , @xmath39 , where @xmath40 is a length scale over which the slowly varying term does nt change significantly but the quickly varying term has one or more complete periods .    </S>",
    "<S> we use a qpm poling structure such that @xmath13 is a square wave with periodicity @xmath41 . </S>",
    "<S> this results in the quickly varying term appearing to change linearly over length scales much longer than one period of the poling structure @xcite . </S>",
    "<S> the concept of aggregate nonlinearity gives an approximation of the average quantity of biphoton wavefunction generated from a qpm poling structure with arbitrary duty cycle . </S>",
    "<S> the aggregate nonlinearity is defined as , @xmath42 , where @xmath43 is the quasi - phase matching period . over each duty </S>",
    "<S> cycle the sign of @xmath13 will change from positive to negative at the point @xmath44 . </S>",
    "<S> so the aggregate nonlinearity produced by a given duty cycle is    @xmath45 . \\label{int}\\end{gathered}\\ ] ]    here @xmath46 is the absolute value of the nonlinear coefficient @xmath13 , which is unaffected by domain poling . </S>",
    "<S> the arbitrary phase @xmath47 simply results from translation of each section of the poling structure with respect to the driving laser . </S>",
    "<S> dividing by the poling period , @xmath43 , ensures that the aggregate nonlinearity represents the amount of biphoton wavefunction produced at an infinitesimal point , rather than the amount produced over a whole period . </S>",
    "<S> integration of ( [ int ] ) gives @xmath48\\\\ \\times\\sin\\left(\\delta\\beta^{(0)}\\frac{l_{n_{p}}(z)}{2}\\right ) . </S>",
    "<S> \\label{aggnl_sol}\\end{gathered}\\ ] ]    now by varying the translation , @xmath49 , and the length of the positive part of the duty cycle , @xmath44 , we can produce an aggregate nonlinearity with any phase and with any magnitude ( less than the optimal quasi - phase matching magnitude ) . </S>",
    "<S> hence by combining a few sections of different duty cycles along the length of each waveguide we can set the aggregate nonlinearity to different values in each section [ fig .  </S>",
    "<S> [ fig : fig2](e ) ] . </S>",
    "<S> this allows very flexible control over the creation of biphotons and therefore over the final output states of our device .    </S>",
    "<S> substituting the aggregate nonlinearity into eq . </S>",
    "<S> @xmath38 gives ,     ( color online ) ( a),(b),(c),(d )   the error between the target states in figure [ fig : fig2 ] ( a)-(d ) and the states resulting from using the poling structures in figure 3 ( e ) . </S>",
    "<S> ( e )  the poling structures used to achieve the aggregate nonlinearities in fig .  </S>",
    "<S> [ fig : fig2](e ) , colours represent the orientation of the ferroelectric dipole moment . </S>",
    "<S> note that the number of domains has been reduced by a factor of around 50 for visualization . ]    </S>",
    "<S> @xmath50    this equation can be inverted to solve for the aggregate nonlinearity , @xmath51 ( see the supplementary material for a detailed discussion of the solvability of the inverse problem ) . </S>",
    "<S> the aggregate nonlinearity is chosen to be an array with number of elements large enough that a solution exists for the target output state @xmath52 . </S>",
    "<S> generally this will require around @xmath23 different values for @xmath51 down the length of each waveguide , since this is the dimensionality of the output space .    to illustrate this general approach we design a four - waveguide device with poling to generate the set of two - photon bell states as the outputs @xmath24 [ fig .  </S>",
    "<S> [ fig : fig2](a)-(d ) ] . </S>",
    "<S> driving the waveguides simultaneously will produce a superposition of the four bell states , with the amplitude and phase of each bell state determined by the amplitude and phase of the classical laser driving the waveguide @xmath19 .    to be specific , </S>",
    "<S> we consider device realized on a lithium niobate ( linbo@xmath53 ) platform  @xcite , with a waveguide length of @xmath545  cm , a coupling rate between the waveguides @xmath55 m@xmath56 , and a poling period of @xmath57  18.5  @xmath58 </S>",
    "<S> m at 230@xmath59c for @xmath60  nm pump wavelength . </S>",
    "<S> using these parameters we solve eq .  </S>",
    "<S> ( [ main_sol2 ] ) for the four bell states [ fig .  </S>",
    "<S> [ fig : fig2](a)-(d ) ] , this provides the required aggregate nonlinearities in the four - waveguide array [ fig .  </S>",
    "<S> [ fig : fig2](e ) ] . from the values of the aggregate nonlinearity </S>",
    "<S> we can reconstruct the full poling structure , @xmath13 , using eq .  </S>",
    "<S> ( [ aggnl_sol ] ) , the reconstruction is shown in fig .  </S>",
    "<S> [ fig : fig3](e ) . to check our solutions </S>",
    "<S> numerically we compare the states produced by the full poling structure to the target bell states , the errors are shown in fig .  </S>",
    "<S> [ fig : fig3](a)-(d ) . </S>",
    "<S> the fidelities between the target states and the realized states are all greater than 0.999 , this shows that the approximate use of the aggregate nonlinear coefficient is valid for realistic parameters .    </S>",
    "<S> finally we formulate a fast classical characterization method for the device using stimulated emission tomography @xcite . by seeding the device with a signal pulse and measuring the idler output , we can calculate the expected biphoton state produced by spdc using the transformation    @xmath61    here @xmath62 refers to the idler field produced by difference frequency generation ( dfg ) in the waveguide number @xmath63 when the seed field is coupled to waveguide @xmath64 . </S>",
    "<S> ( see supplementary material for a detailed derivation ) .    in conclusion we have demonstrated how to create all - optically reconfigurable linear combinations of the set of two - photon bell states in an array of four coupled nonlinear waveguides with special poling . </S>",
    "<S> moreover the poling technique can be applied to a wga to enable it to produce any set of biphoton states . </S>",
    "<S> this opens the door for the design of a variety of reconfigurable entangled photon sources , with output quantum spaces tailored to specific technological applications . </S>",
    "<S> we also note that the nearest neighbour coupling interactions and nonlinear effects we consider here are common to many physical systems . for instance similar reconfigurable control of entangled photons </S>",
    "<S> could be achieved via spontaneous four - wave - mixing in @xmath65 media . </S>",
    "<S> further afield , our approach can be extended for controlling the state of pair - correlated atoms generated via spontaneous four - wave - mixing in bose - einstein condensates in lattices  @xcite .    </S>",
    "<S> 23ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] </S>",
    "<S>  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) link:\\doibase    10.1103/revmodphys.79.135 [ * * ,   ( ) ] link:\\doibase    10.1103/revmodphys.74.145 [ * * ,   ( ) ] </S>",
    "<S> link:\\doibase 10.1126/science.1104149 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.101.233601 [ * * ,   ( ) ] link:\\doibase 10.1038/ncomms1439 [ * * ,   ( ) ] link:\\doibase 10.1038/ncomms3582 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.113.103601 [ * * ,   ( ) ] link:\\doibase    10.1038/nature10463 [ * * ,   ( ) ] link:\\doibase    10.1126/science.1155441 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.110.160502 [ * * ,   ( ) ] link:\\doibase 10.1038/nphoton.2011.283 [ * * ,   ( ) ] link:\\doibase 10.1038/nphoton.2013.339 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.108.023601 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.113.083602 [ * * ,   ( ) ] link:\\doibase 10.1126/science.1193515 [ * * ,   ( ) ] link:\\doibase 10.1038/srep00562 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.100.063902 [ * * ,   ( ) ] link:\\doibase 10.1364/ol.29.000376 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.111.193602 [ * * ,   ( ) ] link:\\doibase 10.1038/ncomms4752 [ * * , ( ) ] , , , * * , ( ) , http://www.opticsinfobase.org/abstract.cfm?uri=josab-29-8-2199 . </S>"
  ]
}