{
  "article_text": [
    "effective hamiltonians provide a way to determine the low - energy eigenvalues of a ( possibly infinite dimensional ) hamiltonian by diagonalizing a matrix defined in a subspace of small dimension , called the _ model space _ and hereafter denoted by @xmath0 . because of this appealing feature",
    ", effective hamiltonians are used in nuclear , atomic , molecular , chemical and solid - state physics  @xcite .",
    "these theories are plagued with a tremendous combinatorial complexity because of the presence of folded diagrams ( to avoid singularities of the adiabatic limit ) , partial resummations , subtle `` linkedness '' properties and the exponential growth of the number of graphs with the order of perturbation .",
    "this complexity has two consequences : on the one hand , few results are proved in the mathematical sense of the word , on the other hand , it is difficult to see what is the underlying structure of the perturbative expansion that could lead to useful resummations and non - perturbative approximations .    to avoid these pitfalls ,",
    "we take a birds - eye view of the problem and consider a general time - dependent hamiltonian @xmath1 .",
    "this way , we disentangle the problem from the various particular forms that can be given to the hamiltonian and which have lead in the past to various perturbative expansions . to be precise , take the example of fermions in molecular systems .",
    "the coulomb interaction between the electrons ( say @xmath2 ) can be viewed as a perturbation of a `` free hamiltonian '' modeling the interaction with the nuclei ( in the born - oppenheimer approximation ) .",
    "one can take advantage of the particular form of @xmath2 ( which is a linear combination of products of two creation and two annihilation operators in the second quantization picture ) to represent the perturbative expansions using a given family of goldstone diagrams ( see e.g. ref .",
    "for such a family ) .",
    "however , the general results on perturbative expansions ( such as the convergence of the time - dependent wave operator ) do not depend on such a particular choice .",
    "thus , we consider an hamiltonian @xmath1 and we build its evolution operator @xmath3 , which is the solution of the schrdinger equation ( in units @xmath4 ) @xmath5 with the boundary condition @xmath6 . in perturbation theory",
    ", @xmath7 is the adiabatically switched interaction hamiltonian in the interaction picture ( here @xmath8 and @xmath2 stand respectively for the `` free '' and interaction terms of the initial hamiltonian ) and singularities show up in the adiabatic limit ( @xmath9 and @xmath10 ) .",
    "morita discovered  @xcite that , in this setting , the _ time - dependent wave operator _",
    "@xmath11 where @xmath12 is the projection onto the model space @xmath0 , has no singularity in the adiabatic limit .",
    "moreover , the wave operator determines the effective hamiltonian because @xmath13 however , as we have already alluded to , the effective computation of these operators raises several combinatorial and analytical problems that have been addressed in a long series of articles ( several of which will be referred to in the present article ) .    in the first sections of the paper , we consider a general time - dependent hamiltonian @xmath1 ( not necessarily in the interaction picture ) . in this broader",
    "setting , jolicard  @xcite found that the time - dependent wave operator provides also a powerful description of the evolution of quantum systems ( see ref .   for applications ) .",
    "then , we derive three ( rigorously proven ) series expansions of the wave operator .",
    "the first one is classical and can be physically interpreted as the replacement of causality ( i.e. the heaviside step function @xmath14 ) by a `` propagator '' @xmath15 , where @xmath16 .",
    "this `` propagator '' is causal out of the model space ( @xmath17 for @xmath18 on the image of @xmath19 ) and anticausal on it , like the feynman propagator of quantum field theory  @xcite .",
    "however , this sum of causal and anticausal orderings is cumbersome to use in practice .",
    "a second series expansion is obtained by writing the wave operator as a sum of integrals over all possible time orderings of the hamiltonians @xmath20 ( see sect .",
    "[ permutation - sect ] ) .",
    "this expansion , parametrized by all the permutations ( or equivalent families ) , is used in many - body theory and gives rise to a large number of complicated terms .",
    "the third expansion is obtained by noticing that some time orderings can be added to give simpler expressions .",
    "this series is naturally indexed by trees and is the main new tool developed in the present paper . among others ,",
    "we derive a very simple recurrence relation for the terms of the series .",
    "we also show that the very structure of the corresponding generalized iterated integrals showing up in the expansion is interesting on its own .",
    "these integrals carry naturally a rich algebraic structure that is connected to several recent results in the field of combinatorial hopf algebras and noncommutative symmetric functions .",
    "the corresponding algebraic results that point out in the direction of the existence of a specific lie theory for effective hamiltonians ( generalizing the usual lie theory ) are gathered in an appendix .    in the last sections of the paper ,",
    "we restrict @xmath1 to the interaction picture and we consider the adiabatic limit .",
    "we first prove that the adiabatic limit exists non perturbatively .",
    "we show that the effective hamiltonian defined by eq .",
    "( [ heff ] ) has the expected properties .",
    "then , we expand the series and we give a rigorous ( but lengthy ) proof that the term corresponding to each time ordering has an adiabatic limit",
    ". then , we consider the series indexed by trees and we give a short and easy proof of the existence of that limit .",
    "finally , we provide a direct rule to calculate the term corresponding to a given tree and establish the connection between the time - dependent approach and the time - independent equations discovered by lindgren  @xcite and kvasnika  @xcite",
    ".    the existence of this series indexed by trees can be useful in many ways : ( i ) it describes a sort of superstructure that is common to all many - body theories without knowing the exact form of the interaction hamiltonian ; ( ii ) it considerably simplifies the manipulation of the general term of the series by providing a powerful recurrence relation ; ( iii ) it provides simple algorithms to calculate the terms of the series ; ( iv ) the number of trees of order @xmath21 , @xmath22 being subexponential , it improves the convergence of the series  @xcite ; ( v ) it can deal with problems where the hamiltonian @xmath8 is not quadratic . indeed , many - body theories most often require the hamiltonian @xmath8 to be free , i.e. to be a quadratic function of the fields@xcite .",
    "as noticed by bulaevskii  @xcite , this is not the good point of view for some applications . for example , in the microscopic theory of the interaction of radiation with matter , it is natural to take for @xmath8 the hamiltonian describing electrons and nuclei in coulomb interaction  @xcite , the perturbation being the interaction with the transverse electric field . in that case ,",
    "quadratic free hamiltonians many - body theories break down whereas our approach is still valid .",
    "actually , it is precisely for that reason that we originally developed the tree series approach ; ( vi ) last , but not least , the tree - theoretical approach connects many - body theories with a large field of knowledge that originates in the `` birth of modern bijective combinatorics '' in the seventies with in particular the seminal works of foata , schtzenberger and viennot @xcite . see e.g. ref .   for a survey of the modern combinatorial theory of tree - like structures .    from the physical point of view",
    ", the tree expansion is particularly interesting in the adiabatic limit .",
    "indeed , the denominator of each of its terms is a product of @xmath23 factors , where @xmath24 is the energy of a state in the model space @xmath0 and @xmath25 the energy of a state not belonging to @xmath0 . in the usual many - body expansions , the denominators are products of @xmath26 factors , where the sums contain various numbers of elements ( corresponding therefore to multiple transitions between low - energy and excitated levels ) . in that sense ,",
    "the tree expansion is the simplest possible because each term is a product of single transitions between two states .    we now list the main new results of this paper : ( i ) a recursion formula that generates the simplified terms of the time - dependent perturbation series ( theorem  [ thmomegat ] ) ; ( ii ) when the interaction is adiabatically switched on , a non - perturbative proof of the convergence of the wave operator and a characterization of the states of the model space that are transformed into eigenstates of @xmath27 by the wave operator ( theorem  [ nonperthm ] ) ; ( iii ) a proof of the existence of the adiabatic limit for the terms of the series expansion of the wave operator ( theorem  [ convpermut ] ) ; ( iv ) a recursive formula ( lemma  [ lemmaneuf ] ) and an explicit form ( theorem  [ thmrs ] ) for the general term of the time - independent perturbation series .",
    "we consider a time - dependent hamiltonian @xmath1 , which is a self - adjoint operator on a hilbert space @xmath28 , and its evolution operator @xmath3 defined in eq .",
    "( [ dudt ] ) .",
    "since we are interested in the combinatorial aspects of the problem , we consider the simple case where @xmath1 is a strongly continuous map from @xmath29 into the bounded self - adjoint operators on @xmath28  @xcite . in that case , the picard - dyson series @xmath30 converges in the uniform operator topology to @xmath3 and @xmath3 is a jointly strongly continuous two - parameter family of unitaries on @xmath28 ( see section x.12 of ref .  ) .",
    "following morita  @xcite , jolicard  @xcite established a connection between the evolution operator and the effective hamiltonian approach by defining @xmath11 where @xmath12 is a projection operator onto @xmath0 and @xmath31 is the inverse of @xmath32 as a map from @xmath33 to itself .",
    "this map is invertible if and only if there is no state @xmath34 in @xmath0 such that @xmath35 .",
    "this condition is similar to the one of time - independent perturbation theory  @xcite .",
    "we assume from now on that the condition is satisfied and we define three expansions for @xmath36 .",
    "we start by proving an elegant expression for @xmath37 , that was stated by michels and suttorp  @xcite and dmitriev and solnyshkina  @xcite .",
    "@xmath38    where @xmath16 and @xmath39 , with @xmath40 the heaviside step function .",
    "we first rewrite the picard - dyson series as @xmath41 with @xmath42 and , for @xmath43 , @xmath44 then , by using @xmath45 , we notice that @xmath46 now , we replace @xmath47 by the sum of operators @xmath48 in the expression for @xmath49 .",
    "this gives us @xmath50 terms with various numbers of @xmath12 and @xmath51 .",
    "denote by @xmath52 the term with no @xmath12 ( with the particular case @xmath53 ) .",
    "take then any other term .",
    "there is an index @xmath54 such that the first @xmath12 from the left occurs after @xmath20 .",
    "therefore , the integrand of this term is @xmath55 observe that the integral over @xmath56 is independent from the integral over @xmath57 .",
    "the first integral gives @xmath58 , the second integral is a term of the picard - dyson series for @xmath59 .",
    "thus , the sum of the @xmath50 terms yields @xmath60 if we denote by @xmath61 the sum of all the @xmath52 with @xmath62 , we obtain @xmath63 , so that @xmath64 the operator @xmath65 is called the _ reduced evolution operator _ by lindgren and collaborators  @xcite . if we define @xmath66 , eq .",
    "( [ kpup ] ) becomes @xmath67 this equation can be simplified by using eq .",
    "( [ kpup ] ) again @xmath68 thus , @xmath69 and eq .",
    "( [ ms ] ) is satisfied .    despite its elegance ,",
    "( [ ms ] ) is not immediately usable . to illustrate this point , consider the third - order term @xmath70 if we expand @xmath39 , we obtain four terms @xmath71 the first and last terms have integration range @xmath72 and @xmath73 , respectively and give rise to iterated integrals .",
    "the integration range of the second term is @xmath74 and @xmath75 .",
    "such an integration range is not convenient because the relative position of @xmath76 and @xmath77 is not specified .",
    "the integration range has to be split into the two subranges @xmath78 and @xmath79 .",
    "each subrange defines now an iterated integral .",
    "for example @xmath78 gives @xmath80 similarly , the integration range of the third term ( @xmath81 and @xmath82 ) is the union of @xmath83 and @xmath84 .",
    "we see that @xmath85 is sum of six iterated integrals corresponding to the six possible orderings of @xmath76 , @xmath86 and @xmath77 .",
    "we consider again the previous example , and we change variables to have a fixed integration range @xmath87 .",
    "if we sum over all time orderings , we obtain @xmath88    in ref .",
    ", we showed that this result can be generalized to all orders and that @xmath89 is a sum of @xmath90 iterated integrals corresponding to all the orderings of @xmath91 .",
    "more precisely , we obtained the series expansion for @xmath37 @xmath92 where @xmath93 is the group of permutations of @xmath21 elements .",
    "the operators @xmath94 are defined , for @xmath95 , by @xmath96 and , for @xmath43 and any @xmath97 , by @xmath98 and @xmath99    each term of eq .",
    "( [ omegasigma ] ) is now written as an iterated integral .",
    "however , the expansion ( [ omegasigma ] ) is still not optimal because some of its terms can be summed to get a simpler expression . as an example , consider the fourth and fifth terms of eq .",
    "( [ omega3 ] ) , where we replace @xmath100 by @xmath101 .",
    "@xmath102 the first and second terms of the right hand side of this equation are denoted by @xmath103 and @xmath104 , respectively .",
    "we transform @xmath104 by exchanging variables @xmath86 and @xmath77 .",
    "@xmath105 where we also exchanged the order of the integrations over @xmath77 and @xmath86 .",
    "this can be added to @xmath103 and we obtain the simpler expression @xmath106 such a simplification is not possible for the other terms of @xmath107 . in the next section ,",
    "we determine how this simplification can be extended to the general term of @xmath37 .    before closing this section",
    ", we need to specify more precisely the relation between the permutations @xmath108 and the sequence of @xmath12 and @xmath19 in the expansion of eq .",
    "( [ ms ] ) . when we expand all the @xmath109 in eq .",
    "( [ ms ] ) , we obtain an integrand of the form @xmath110 , multiplied by a product of heaviside functions , where @xmath111 takes the value @xmath112 or @xmath19 .",
    "we aim to determine the relation between the sequence @xmath113 and the permutations @xmath108 in eq .",
    "( [ omegasigma ] ) . from the definition of @xmath114",
    ", it appears that @xmath115 if @xmath116 and @xmath117 if @xmath118 .",
    "the set of indices @xmath54 such that @xmath116 is called the _ descent set _ of @xmath108 , denoted by @xmath119 .",
    "it is also called the _",
    "shape _ of the permutation  @xcite .",
    "for instance , the descent set of the permutations @xmath120 and @xmath121 is @xmath122 , corresponding to @xmath123 .      in many - body physics ,",
    "the expansion in goldstone diagrams corresponds ( among other things ) to the expansion of @xmath124 into all time orderings @xmath125 . in that context",
    ", several authors noticed that some diagrams corresponding to different orderings can be added to give a simple sum  @xcite , as we saw in the previous section .",
    "these are special cases of the simplification that we shall present which , as far as we know , was never stated in full generality .",
    "the first difficulty is to find the proper combinatorial object to represent the sets of permutations that lead to simplified sums",
    ". we shall find it after a short algebraic detour meant to recall the notion of tree and its relation to permutations  @xcite .",
    "the trees we consider have received various names in the literature : binary trees in ref .  , but also ( to quote only a few occurrences ) plane rooted complete binary tree  @xcite , extended binary trees  @xcite or planar binary trees  @xcite .",
    "since these objects are rarely used in physics , we first link them with the trees commonly found in graph theory . this lengthy definition",
    "will then be replaced by a much easier one .",
    "a _ common tree _ is a connected graph without loops .",
    "in other words , a common tree is a set of vertices linked by edges such that there is a unique way to go from any vertex to any another one by travelling along edges .",
    "an example of a common tree is given in fig .",
    "[ fig : pbt](a ) . a _ rooted tree _ is a common tree where one vertex was selected .",
    "this particular vertex is called the _",
    "root_. the _ level _ of a vertex in a rooted tree is the number of edges that separates this vertex from the root .",
    "the root has level 0 .",
    "it is natural to draw a rooted tree by putting the root at the bottom and drawing a vertex above another one if its level is larger . the rooted tree of fig .",
    "[ fig : pbt](b ) was obtained by selecting as the root the lowest left vertex of fig .",
    "[ fig : pbt](a ) .",
    "the root is indicated by a white dot and a dangling line . in a rooted tree ,",
    "the _ children _ of a vertex @xmath126 are the vertices @xmath127 that are linked to @xmath126 by an edge and such that the level of @xmath127 is larger than the level of @xmath126 .",
    "a _ plane rooted binary tree _ is a rooted tree where each vertex has zero , one or two children , and each edge is oriented either to the left or to the right .",
    "if a vertex has two children , then one of the edges is oriented to the left and the other one to the right .",
    "[ fig : pbt](c ) shows one of the plane rooted trees that can be obtained from the rooted tree of fig .",
    "[ fig : pbt](b ) .",
    "the adjective `` plane '' means that an edge going to the right can not be identified with , or deformed into an edge going to the left .",
    "a _ plane rooted complete binary tree _ is a plane rooted binary tree where each vertex is `` completed '' by drawing _",
    "leaves _ as follows : if a vertex has no child , draw a leaf ( i.e. a line ) to the left and one to the right , if a vertex has one child , then draw a leaf to the right if the child is to the left and draw it to the left if the child is to the right .",
    "[ fig : pbt](d ) shows the plane rooted complete binary tree that is obtained from the plane rooted binary tree of fig .",
    "[ fig : pbt](c ) . in practice ,",
    "the vertices are no longer necessary and they are not drawn , as in fig .",
    "[ fig : pbt](f ) .",
    "if @xmath128 denotes the set of plane rooted complete binary trees with @xmath21 vertices , we see that @xmath129 , @xmath130 , @xmath131 .",
    "they are much more numerous than the common trees ( there is only one common tree with one , two or three vertices ) . for notational convenience , plane rooted complete binary trees will be simply called `` trees '' in the rest of the paper .    fortunately , there exists a much simpler definition of the trees , that use a sort of building rule . we first denote the _ empty tree _ ,",
    "i.e. the tree with no vertex , by@xmath132 , which is a dangling line without root ( a dangling line with a root and no other vertex belongs to the tree @xmath133 ) .",
    "then , for any integer @xmath21 , @xmath128 , is defined recursively by @xmath134 and , for @xmath62 , @xmath135 , where @xmath136 is the grafting of the two trees @xmath137 and @xmath138 , by which the dangling lines of @xmath137 and @xmath138 are brought together and a new root ( with its own dangling line ) is grown at their juncture . for example , @xmath139 , @xmath140 , @xmath141 .",
    "note that each tree of @xmath128 has @xmath21 vertices ( including a root ) and @xmath142 leaves .",
    "the order @xmath143 of a tree @xmath144 is the number of its vertices .",
    "if @xmath145 denotes the number of elements of @xmath128 , the recursive definition of @xmath128 implies that @xmath146 and @xmath147 , so that @xmath148 are the famous catalan numbers . for @xmath21=0 to 10 , @xmath145=1 , 1 , 2 , 5 , 14 , 42 , 132 , 429 , 1430 , 4862 , 16796 .",
    "the catalan numbers enumerate a large number of ( sometimes quite different ) combinatorial objects  @xcite .",
    "the main practical interest of trees with respect to other combinatorial interpretations is that their recursive definition is very easy to implement .",
    "we noticed in the previous section that , at order three , the terms @xmath125 corresponding to two specific permutations @xmath108 can be added to give a simple result . at the general order",
    ", we shall see that the sum of @xmath125 is simple if it is carried out over permutations @xmath108 associated with the same tree . but for this , we need to associate a tree to each permutation .",
    "the relevant map from permutations to trees belongs to `` the abc s of classical enumeration ''  @xcite and is historically one of the founding tools of modern bijective and algebraic combinatorics  @xcite .",
    "we describe it in the next section .",
    "we first map any @xmath21-tuple @xmath149 of distinct integers to a tree @xmath150 .",
    "the mapping @xmath151 is defined recursively as follows : if @xmath152 contains a single integer , then @xmath153 ; otherwise , pick up the smallest element @xmath154 of @xmath155 , then @xmath156 in the following , we frequently abuse notation by writing @xmath157 or even @xmath158 instead of @xmath159 . for a permutation @xmath97 ,",
    "the corresponding tree is @xmath160 .",
    "for example @xmath161 note that the two permutations @xmath120 and @xmath121 correspond to the same tree , and they are also the two permutations that add up to a simple sum in the calculation of @xmath162 at the end of section  [ permutation - sect ] .",
    "this is not a coincidence .    to simplify the proofs , we embrace the three cases of the definition of @xmath151 into a single one as follows .",
    "we first define the _ concatenation product _ of two tuples @xmath149 and @xmath163 as @xmath164 .",
    "we extend this definition to the case of the zero - tuple @xmath165 by @xmath166 .",
    "then , for any @xmath21-tuple @xmath155 of distinct integers , we define @xmath167 by @xmath168 if @xmath169 and @xmath170 otherwise , where @xmath171 and @xmath172 are determined by @xmath173 .",
    "note that @xmath171 or @xmath172 can be the zero - tuple .",
    "we first prove an easy lemma .    if the elements of the two @xmath21-tuples @xmath149 and @xmath174 of distinct integers have the same ordering ( i.e. if @xmath175 if and only if @xmath176 for all @xmath177 and @xmath178 in @xmath179 ) , then @xmath180 .",
    "the proof is by induction . if @xmath169 , then @xmath181 and @xmath182 .",
    "assume that the property is true for @xmath177-tuples of distinct integers up to @xmath183 and take two @xmath21-tuples @xmath155 and @xmath184 having the same ordering .",
    "then , the minimum element of both is at the same position @xmath177 ( i.e. @xmath185 and @xmath186 ) and @xmath187 , @xmath188 , where @xmath171 and @xmath189 ( @xmath172 and @xmath190 , respectively ) are two @xmath191-tuples ( @xmath192-tuples , respectively ) of distinct integers have the same ordering . by the recursion hypothesis",
    ", we have @xmath193 and @xmath194 and the definition of @xmath151 gives us @xmath195 .    as a useful particular case",
    ", we consider the situation where @xmath184 describes the ordering of the elements of @xmath155 : we order the elements of @xmath149 increasingly as @xmath196 .",
    "then @xmath197 is the position of @xmath198 in this ordering .",
    "more formally , @xmath199 , where @xmath200 is the permutation @xmath201 . the @xmath21-tuple @xmath184 is called the _ standardization _ of @xmath155 and it is denoted by @xmath202 .",
    "if we take the example of @xmath203 , the position of 5 , 8 and 2 in the ordering @xmath204 is 2 , 3 and 1 , respectively .",
    "thus , @xmath205 . by construction ,",
    "@xmath155 and @xmath202 have the same ordering and @xmath206 .",
    "we extend the standardization to the case of @xmath207 by @xmath208 .",
    "conversely , we shall need to know the permutations corresponding to a given tree : @xmath209 ( we extend this definition to the case of @xmath210 by defining the zero - element permutation group @xmath211 ) .",
    "the solution of this problem is given by    if @xmath212 , where @xmath213 and @xmath214 ( @xmath21 or @xmath215 can be zero ) , all the permutations of @xmath216 have the form @xmath217 , where @xmath171 is a subset of @xmath21 elements of @xmath218 ordered according to a permutation @xmath219 of @xmath220 ( i.e. @xmath221 ) and @xmath172 is the complement of @xmath171 in @xmath218 , ordered according to a permutation @xmath222 of @xmath223 ( i.e. @xmath224 ) .",
    "the proof is given in refs .   and , but we can sketch it here for completeness .",
    "the simplest examples are @xmath225 for @xmath210 and @xmath226 for @xmath227 .",
    "now take @xmath212 as in the lemma . by the definition of @xmath151 ,",
    "the minimum of the tuple @xmath228 is @xmath229 and @xmath217 , where @xmath230 and @xmath231 .",
    "we saw in the previous section that @xmath232 . by definition @xmath233",
    "is a permutation of @xmath93 .",
    "therefore , @xmath233 belongs to @xmath220 and , similarly , @xmath234 belongs to @xmath223 .",
    "it is now enough to check that each element of @xmath216 is obtained exactly once by running the construction over all orderings and all permutations of @xmath137 and @xmath138 .",
    "this lemma allows us to recursively determine the number of elements of @xmath216 , denoted by @xmath235 , by @xmath236 for @xmath210 and @xmath227 and , for @xmath212 , @xmath237 see ref .   for an alternative approach .",
    "example : consider the tree @xmath212 , with @xmath238 and @xmath239 , so that @xmath95 and @xmath240 .",
    "@xmath220 contains the single permutation @xmath241 and , according to the examples given in the previous section , the two permutations of @xmath223 are @xmath242 and @xmath243 .",
    "we choose the permutations @xmath219 and @xmath244 , we pick up @xmath95 element ( for example @xmath245 ) in the set @xmath246 , so that @xmath247 and we order the remaining elements @xmath248 according to @xmath244 , so that @xmath249 .",
    "this gives us @xmath250 .",
    "if we pick up the other elements of @xmath184 to build @xmath171 we obtain @xmath251 and @xmath252 . we add the elements obtained by choosing @xmath253 and we obtain eight permutations : @xmath254 we can check that eq .",
    "( [ nbst ] ) holds and that @xmath255 .",
    "the permutations corresponding to a tree can be used to make a partial summation of the terms of the picard - dyson expansion .    for any tree @xmath144",
    ", we define @xmath256 by @xmath257 if @xmath210 and @xmath258 otherwise , where @xmath259 .    with this notation",
    "we have obviously @xmath260 , with the notation @xmath261 and where @xmath108 runs over all permutations ( of all orders ) .",
    "the term of order 0 of this series is @xmath262 and the term of order one is @xmath263 for @xmath227 .",
    "the other terms enjoy a remarkably simple recurrence relation :    [ thmomegat ] if @xmath264 , then @xmath265 can be expressed recursively by @xmath266 where @xmath267 and @xmath268 .",
    "[ omegat ]    note that a similar recursive expression was conjectured by olszewski for the nondegenerate rayleigh - schrdinger expansion  @xcite .",
    "let us prove the theorem recursively .",
    "consider an arbitrary @xmath212 , @xmath264 , and assume the formulas to hold for all the trees @xmath269 with @xmath270 .",
    "consider for example the case where @xmath267 and @xmath268 ( the other cases are even simpler ) .",
    "we define : @xmath271 this first important point is that , for a given tree @xmath144 , all the permutations @xmath272 have the same descent set .",
    "this is a well - known fact  @xcite that can be deduced from the characterization of @xmath216 at the end of section [ permutation - tree ] . as a consequence , the sequence of operators @xmath12 , @xmath19 and @xmath27 is the same for all @xmath219 and @xmath222 in @xmath273 , and only the order of the arguments @xmath101 varies .",
    "therefore , the conditions of lemma  [ fundam ] ( see appendix [ crucial ] ) are satisfied and we get : @xmath274 where @xmath275 runs over the permutations such that @xmath276 , @xmath277 , @xmath278 .",
    "the set of permutations @xmath275 satisfying these equations is precisely @xmath216 , so that , finally : @xmath279 .",
    "this concludes the proof of the theorem .",
    "if we denote @xmath280 , then the recurrence relations add up to @xmath281 the derivative of this equation with respect to @xmath282 was obtained in a different way by jolicard  @xcite .",
    "we saw that , for a given tree @xmath144 , all permutations of @xmath216 have the same descent set .",
    "we can now give more details  @xcite .",
    "the relation between the trees and the sequences of operators @xmath12 and @xmath19 in eq .",
    "( [ ms ] ) is very simple .",
    "consider the sequence of leaves from left to right .",
    "each leaf pointing to the right corresponds to a @xmath12 , each leaf pointing to the left correspond to a @xmath19 .",
    "for example , the tree @xmath283 corresponds to the sequence @xmath284 . from the combinatorial point of view",
    ", this description emphasizes the existence of a relationship between trees and descent sets ( or , equivalently , hypercubes ) , see e.g. refs .   and our appendix .",
    "morita s formula is most often applied to an interaction hamiltonian @xmath285 .",
    "we write @xmath286 and @xmath287 for the eigenvalues of @xmath8 and for an orthogonal basis of corresponding eigenstates .",
    "we assume that the spectrum is discrete and that the eigenvalues are ordered by ( weakly ) increasing order .",
    "the ground state may be degenerate ( @xmath288 for a given @xmath177 ) .",
    "the model space @xmath0 ( see the introduction ) is the vector space generated by the lowest @xmath289 eigenstates of @xmath8 ( with @xmath290 ) .",
    "we assume that the energies of the eigenstates of @xmath0 are separated by a finite gap from the energies of the eigenstates that do not belong to @xmath0 .",
    "the projector @xmath12 is the projector onto the model space @xmath0 . following the notation of the introduction , the energies of the eigenstates that belong ( resp .",
    "do not belong ) to @xmath0 are denoted by @xmath291 ( resp .",
    "@xmath292 ) .    in this section ,",
    "we prove the convergence of each term of the perturbation expansion of the wave operator when @xmath10 . for notational convenience ,",
    "we assume that @xmath293 .",
    "we first give a nonperturbative proof of this convergence .",
    "then , we expand in series and we consider the different cases of the previous sections .",
    "the nonperturbative proof is important in this context because its range of validity is wider than the series expansion ( no convergence criterion for the series is required ) .",
    "moreover , the proof that the wave operator indeed leads to an effective hamiltonian is much easier to give in the nonperturbative setting .",
    "the first condition required in the nonperturbative setting is that the perturbation @xmath2 must be relatively bounded with respect to @xmath8 with a bound strictly smaller than 1 .",
    "this condition is satisfied for the hamiltonian describing nuclei and electrons interacting through a coulomb potential  @xcite . before stating the second condition",
    ", we define the time independent hamiltonian @xmath294 , its eigenvalues @xmath295 and its eigenprojectors @xmath296 , such that @xmath297 .",
    "the second condition is that the eigenvalues @xmath295 coming from the eigenstates of the model space ( i.e. such that @xmath298 ) are separated by a finite gap from the rest of the spectrum .",
    "according to kato  @xcite , the eigenvalues and eigenprojectors can be chosen analytic in @xmath299 .",
    "then , a recent version of the adiabatic theorem  @xcite shows that there exists a unitary operator @xmath300 , independent of @xmath301 , such that @xmath302 where @xmath303 is the evolution operator for the hamiltonian @xmath304 and @xmath305 in other words , the singularity of @xmath306 is entirely described by the factor @xmath307 .",
    "the operator @xmath300 satisfies the intertwining property @xmath308 . to connect this result with the case that we are considering in this paper",
    ", we have to choose a model space @xmath0 that satisfies the following condition : there is a set @xmath155 of indices @xmath309 such that @xmath310 , where @xmath12 is the projector onto @xmath0 .",
    "this enables us to give a more precise condition for the invertibility of @xmath311 .",
    "the adiabatic theorem shows that , for small enough @xmath301 , @xmath311 is invertible if and only if @xmath312 is invertible .",
    "if we rewrite @xmath313 , the unitarity of @xmath300 implies that @xmath312 is invertible iff the kernel of @xmath314 is trivial .",
    "we recover the well - known invertibility condition  @xcite that no state of the model space should be orthogonal to the vector space spanned by all the eigenstates of @xmath27 with energy @xmath315 , where @xmath309 runs over @xmath155 .",
    "note that , when the condition of invertibility is not satisfied , it can be recovered by adding the perturbation step by step  @xcite .",
    "then , we have    [ nonperthm ] with the given conditions , the wave operator @xmath316 is well defined . moreover , there are states @xmath317 in the model space such that @xmath318 is an eigenstate of @xmath27 with eigenvalue @xmath315 and the effective hamiltonian @xmath319 satisfies @xmath320 .",
    "we first define @xmath321 , for @xmath309 and @xmath177 in @xmath155 .",
    "then an inverse @xmath322 of @xmath323 is defined by @xmath324 where @xmath325 .",
    "then , @xmath326 and @xmath327 since the right hand side does not depend on @xmath301 , then @xmath328 has no singularity at @xmath329 and @xmath330 this proves the existence of the wave operator . to prove the existence of the states @xmath317 of the theorem , define @xmath331 , where @xmath332 is an eigenstate of @xmath333 : @xmath334 .",
    "indeed , we have @xmath335 where we used the intertwining property in the last equation",
    ". we can now check that @xmath318 is an eigenstate of @xmath27 with eigenvalue @xmath315 .",
    "@xmath336 finally , by multiplying eq .",
    "( [ homega ] ) by @xmath12 from the left , we obtain @xmath337 because @xmath338 and @xmath339 .    thus , the eigenvalues of @xmath340 are eigenvalues of the full hamiltonian @xmath27 .",
    "this is exactly what is expected from an effective hamiltonian . in practice ,",
    "the operator @xmath300 is not known and the states @xmath317 are obtained by diagonalizing @xmath340 .",
    "we consider again the series expansion in terms of permutations .",
    "a straightforward calculation  @xcite of the picard - dyson series gives us @xmath341 where we used the completeness relation @xmath342 .",
    "this expression clearly shows that the terms of the expansion ( and the evolution operator ) are divergent as @xmath10 when any @xmath343 is equal to @xmath344 .    for @xmath97 , we set @xmath345 .",
    "we then have @xmath346 where @xmath347 if @xmath348 and @xmath349 if @xmath350 .",
    "we replace @xmath351 by @xmath352 , then @xmath353 and the sum is over the image of @xmath19 , and if @xmath354 , then @xmath355 and the sum is over the image of @xmath12 .",
    "thus @xmath356 where @xmath357 is the number of elements of the descent set of @xmath108 , @xmath358 is the energy of @xmath359 and where the sum over @xmath360 is over the image of @xmath19 , the sum over @xmath361 is over the image of @xmath12 and the sum over @xmath362 for @xmath363 is over the image of @xmath19 if @xmath364 and over the image of @xmath12 otherwise .",
    "consider now the time integral @xmath365 where @xmath366 .",
    "the integral over @xmath367 is @xmath368 the integrand of the integral over @xmath369 becomes @xmath370 a straightforward recursive argument shows that @xmath371 where @xmath372 therefore , @xmath373      a few examples of @xmath374 are @xmath375 finally we consider two examples that will prove useful : @xmath376 by adding these two terms , we obtain a denominator involving only the difference of two energies .",
    "note that the sum is simpler than either @xmath378 or @xmath379 .",
    "this is a general statement and the simplification becomes spectacular at higher orders . for the example of @xmath380",
    ", there is a single tree @xmath144 which is the sum of 80 permutations , and the denominator of @xmath381 is simpler than the denominator of @xmath125 for any of the 80 permutations @xmath108 of @xmath216 .",
    "this will be proved in section  [ sect - trees ] .",
    "note also that , if we assume that the states in the image of @xmath12 ( i.e. the model space ) are separated from the states in the image of @xmath19 by a finite gap @xmath382 , so that @xmath383 , then the denominators of all the examples are non - zero when @xmath384 . in other words , the limit @xmath385 exists for all the examples . in the next section , we show that this result is true for all permutations @xmath108 .",
    "definition  ( [ defxsigma ] ) is convenient for a computer implementation but it does not make it clear that @xmath387 is nonzero if @xmath329 .",
    "for that purpose , we need an alternative expression for @xmath387 , which is essentially a corrected version of the graphical rule given by michels and suttorp  @xcite .",
    "we first extend any permutation @xmath97 to the sequence of @xmath388 integers @xmath389 . then , for @xmath390 , we define the two sets @xmath391 for example , if @xmath392 , then @xmath393 and @xmath394 . the graphical meaning of these sets",
    "is illustrated in figure [ fig : rule ] .",
    "notice that the vertical axis is oriented downwards in order to reflect the time - ordering in the integrals @xmath395 .     for @xmath392 .",
    "we build @xmath396 , we draw a continuous line @xmath397 starting from @xmath398 to @xmath399 , to @xmath400 , ",
    ", up to @xmath401 .",
    "to determine @xmath402 , we draw a horizontal dashed line just above 3 and we gather the segments of @xmath397 crossing the dashed line from above . in our case",
    "the segments are @xmath403 , @xmath404 and @xmath405 .",
    "@xmath402 is the set of abscissae of the first point of each segment : @xmath406 .",
    "similarly , @xmath407 is obtained from the segments that cross the dashed line from below : @xmath408 . ]",
    "\\(i ) @xmath409 can not be empty and ( ii ) @xmath409 and @xmath410 have the same number of elements .",
    "the lemma follows from the graphical interpretation of the construction of @xmath411 and @xmath412 .",
    "the graph of @xmath108 ( constructed as in figure 1 ) is a sequence of edges connecting the points @xmath413 . since the graph starts from @xmath414 and since there exists one point with ordinate @xmath21 , any horizontal line with non integer ordinate @xmath415 , @xmath416 , will be crossed from above by a segment ( remember the vertical axis is oriented downwards ) .",
    "a similar elementary topological argument shows that such a horizontal line is always crossed successively from above and below by segments , the series of crossings starting from above and ending from below , which implies @xmath417 .    the key step in",
    "the proof of convergence is    for @xmath97 and a given sequence @xmath418 , compatible with @xmath108 ( see eq .",
    "( [ omegasigma ] ) ) , we have @xmath419 where we write @xmath420 ( resp .",
    "@xmath421 ) when @xmath359 belongs to the image of @xmath19 ( resp . of @xmath12 ) .",
    "we first show that it is true for @xmath422 . indeed , @xmath423 .",
    "let @xmath424 , we have @xmath425 .",
    "then , either @xmath426 and @xmath427 is in the image of @xmath428 , or @xmath429 and @xmath97 implies @xmath430 , so that @xmath431 is in the image of @xmath428 .",
    "thus , in all cases , @xmath432 .",
    "consider now @xmath433 .",
    "either @xmath434 and @xmath435 is in the image of @xmath436 , or @xmath437 and @xmath438 , so that @xmath439 is in the image of @xmath12 .",
    "thus , in all cases , @xmath440 .",
    "therefore , @xmath441 . on the other hand , @xmath442 and @xmath443 since @xmath444 is the only point of the graph with ordinate @xmath21 .",
    "thus , the two members of eq .",
    "( [ xknew ] ) are equal for @xmath422 .",
    "assume now that eq .",
    "( [ xknew ] ) holds for all the @xmath445 with @xmath446 , @xmath447 , and consider the equation ( which is true by definition of the @xmath445s ) : @xmath448 where @xmath449 .",
    "we first treat the case @xmath450 .",
    "four possible situations can arise : ( i ) @xmath451 , ( ii ) @xmath452 , ( iii ) @xmath453 and ( iv ) @xmath454 . in case ( i )",
    ", we have @xmath455 and @xmath456 . on the other hand , condition ( i )",
    "implies @xmath457 , so that @xmath458 and @xmath459 is obtained from @xmath460 by removing @xmath461 and adding @xmath462 .",
    "( [ rec ] ) together with the hypothesis that eq .",
    "( [ xknew ] ) holds for @xmath387 imply that eq .",
    "( [ xknew ] ) holds for @xmath463 . case ( ii )",
    "implies @xmath464 and @xmath465 , case ( iii ) implies @xmath466 and @xmath467 , case ( iv ) implies @xmath464 and @xmath467 . in all cases ,",
    "these identities imply that the two expressions ( [ rec ] ) and ( [ xknew ] ) for @xmath463 do agree .",
    "it remains to treat the boundary cases . if @xmath426 , then @xmath468 and we have either ( i ) @xmath469 and @xmath470 or ( ii ) @xmath471 and @xmath472 .",
    "we know that @xmath473 , thus , case ( i ) corresponds to @xmath474 , so that according to eq .",
    "( [ xknew ] ) , @xmath475 in agreement with eq .",
    "( [ rec ] ) . in case ( ii )",
    "we have @xmath476 , which amounts to add @xmath477 and remove @xmath478 . again , eq .  ( [ xknew ] ) holds for @xmath479 . finally , if @xmath434 , then @xmath480 and we have ( i ) @xmath481 and @xmath482 or ( ii ) @xmath483 and @xmath484 . case ( i ) corresponds to @xmath485 , case ( ii ) corresponds to @xmath486 . in all cases ,",
    "the relation given by eq .",
    "( [ xknew ] ) is satisfied for @xmath479 and the induction proof is complete .",
    "we can now ready to prove    [ convpermut ] the limit @xmath487 is well - defined .    to prove the term - wise convergence of @xmath488 as @xmath384 ,",
    "consider eq .",
    "( [ xknew ] ) .",
    "the sets @xmath460 and @xmath489 have the same number of elements , say @xmath490 and , by the gap hypothesis , we have @xmath491 for any @xmath54 and @xmath309 .",
    "therefore , @xmath492 , since @xmath493 .",
    "thus , the denominator remains away from zero by a finite amount for any @xmath494 and the limit of @xmath495 for @xmath384 is well - defined .",
    "we showed that , for each permutation @xmath108 , the wave operator @xmath496 has a well - defined limit as @xmath384 .",
    "the detailed proof was rather lengthy and the final expression for @xmath387 suggests physically the simultaneous occurrence of transitions from states of the model space to states out of it .",
    "the convergence is actually much easier to show in terms of trees , and the expressions showing up in the expansion are simpler , mathematically and physically , each factor of the denominator corresponding to a single difference between an energy in the model space and an energy out of it .    in this section , if @xmath289 is the dimension of the model space , we write @xmath497 for @xmath498 and @xmath499 for @xmath500 , both for notational simplicity , and to emphasize the meaning of the indices , that correspond respectively to eigenstates in the image of @xmath19 and in the image of @xmath12 ( i.e. the model space ) .    [ omegateps ] if @xmath212 , then , for @xmath293 , @xmath501 where @xmath502 is obtained recursively by :    for @xmath227 , @xmath503    for @xmath504 , @xmath268 : @xmath505    for @xmath267 , @xmath506 : @xmath507    for @xmath267 , @xmath268 : @xmath508    the computation of @xmath509 follows from eq .",
    "( [ omegasigmat ] ) .",
    "let us consider for example the case @xmath504 , @xmath268 .",
    "then , by applying theorem  [ omegat ] : @xmath510 we replace @xmath19 by @xmath511 and obtain , by using @xmath512 , @xmath513 the two other cases can be treated similarly .",
    "since , for arbitrary @xmath54 and @xmath309 , @xmath514 , we get :    [ convtree ] the limit @xmath515 is well defined .",
    "kvasnika  @xcite and lindgren  @xcite independenty obtained an equation for the time - independent rayleigh - schrdinger perturbation theory of possibly degenerate systems : @xmath516}p & = & v { \\overline{\\omega}}p - { \\overline{\\omega}}p v { \\overline{\\omega}}p , \\label{lindgren}\\end{aligned}\\ ] ] where the time - independent wave operator @xmath517 transforms eigenstates @xmath518 of @xmath8 into eigenstates @xmath519 of @xmath520 and where @xmath521 ( see ref .",
    "p.  202 for details ) .",
    "equation  ( [ lindgren ] ) is an important generalization of bloch s classical results  @xcite because it is also valid for a quasi - degenerate model space ( i.e. when the eigenstates of @xmath8 in the model space have different energies ) .",
    "the relation between time - dependent and time - independent perturbation theory is established by the following proposition :    we have @xmath522 .",
    "we take the derivative of eq .  ( [ ichi ] ) with respect to time and",
    "we substitute @xmath280 .",
    "this gives us @xmath523 if we take @xmath524 and @xmath525 , we obtain by continuity @xmath526 when we compare this equation with eq .",
    "( [ lindgren ] ) , we see that @xmath517 and @xmath527 satisfy the same equation if @xmath528}. \\label{domega}\\end{aligned}\\ ] ] to show this , we prove it for each term @xmath381 .",
    "indeed , eq .  ( [ omegaalphan ] ) gives us @xmath529 and @xmath530 } & = &      \\sum_{i\\in q , j\\in p }    ( e_j^p - e_i^q )    { \\mathrm{e}}^{(\\imath e_i^q-\\imath e_j^p+ |t|\\epsilon)t }     \\omega^{i j}_t \\,|\\phi_i\\rangle\\langle \\phi_j|.\\end{aligned}\\ ] ] by continuity in @xmath301 , these two expressions are identical for all @xmath282 when @xmath10 .",
    "if we take @xmath524 and we sum over all trees @xmath144 , then we recover eq .",
    "( [ domega ] ) . therefore , @xmath517 and @xmath527 satisfy the same equation .",
    "it remains to show that they have the same boundary conditions : @xmath531 and @xmath338 . by eq .",
    "( [ ms ] ) , these two equations are true for @xmath532 with any value of @xmath282 and @xmath301 .    as a corollary , proposition [ omegateps ] provides a recursive construction of the wave operator @xmath527 .      in this section ,",
    "we show how @xmath533 can be obtained non - recursively from the knowledge of @xmath144 .",
    "the key idea is to replace @xmath144 by another combinatorial object , better suited to that particular computation .",
    "we write therefore @xmath534 for the smallest permutation for the lexicographical ordering in @xmath216 ( we view a permutation as a word to make sense of the lexicographical ordering : to @xmath535 corresponds the word @xmath536 , so that e.g. @xmath537 )",
    ". since @xmath216 is always non empty , the map @xmath538 is well - defined and an injection from the set of trees to the set of permutations .",
    "these permutations are called catalan permutations  @xcite , 312-avoiding permutations ( i.e. permutations for which there does not exist @xmath539 such that @xmath540 , see ref .",
    "p.  224 ) , kempf elements  @xcite or stack words  @xcite .",
    "various elementary manipulations can be done to understand such a map .",
    "we list briefly some obvious properties and introduce some notation that will be useful in our forthcoming developments .",
    "if @xmath541 is a sequence of integers , we write @xmath542 $ ] for the shifted sequence @xmath543",
    ".    then , let @xmath212 be a tree .",
    "the permutation @xmath544 ( that we identify with the corresponding word or sequence ) can be constructed recursively as @xmath545 , @xmath546 and @xmath547,1,\\gamma(t_2)[|t_1|+1])).\\ ] ] the left inverse of @xmath275 , say",
    "@xmath548 , is also easily described recursively as @xmath549 , @xmath550 and @xmath551 ) \\vee{\\cal t}((\\sigma(k+2), ... ,\\sigma(n))[-k-1]),\\ ] ] where @xmath97 , @xmath552 is in the image of @xmath275 .",
    "permutations in the image of @xmath275 can be characterized recursively similarly : with the same notation as in the previous paragraph , @xmath108 is in the image of @xmath275 if and only if @xmath553 $ ] and @xmath554 $ ] are in the image of @xmath275 , where @xmath177 is the integer such that @xmath555 ,    we are now in a position to compute @xmath533 .",
    "let us write @xmath556 for all the sequences @xmath557 associated to @xmath544 as in equation  ( [ omegasigma ] ) .",
    "we write , as usual , @xmath358 for the eigenvalue associated to @xmath359 . recall that @xmath558 , @xmath559 whereas @xmath560 is in @xmath19 if @xmath561 and in @xmath12 otherwise .",
    "these sequences are actually common to the expansions of all the @xmath562 ( this is because they depend only on the positions of descents in the permutations @xmath272 , as discussed in the proof of thm .",
    "[ thmomegat ] ) .",
    "they appear therefore in the expansion of @xmath563 .",
    "they actually also correspond exactly to the sequences of eigenvectors that show up in the recursive expansion of @xmath533 ( proposition  [ omegaalphan ] ) ( this should be clear from our previous remarks , but can be checked directly from the definition of the recursive expansion ) .",
    "we can refine the recursion of proposition  [ omegateps ] accordingly :    [ lemmaneuf ] we have : @xmath564 , where @xmath565 is defined recursively by : @xmath566 @xmath567 where @xmath212 and @xmath568 . for @xmath504 , we have @xmath569 and for @xmath506 , we have @xmath570 .",
    "let us now consider @xmath534 .",
    "for @xmath571 , we set : @xmath572 and @xmath573 . in words , @xmath574 is defined as follows : consider all the consecutive positions @xmath177 on the left of position @xmath54 , such that the value of the permutation @xmath575 is larger than @xmath576 .",
    "then , @xmath574 is the leftmost of these positions @xmath177 .",
    "similarly , @xmath577 is the rightmost position @xmath309 such that , on all positions @xmath177 between @xmath54 and @xmath309 , the permutation @xmath575 is larger than @xmath576 .",
    "[ thmrs ] we have : @xmath578 or , equivalently , @xmath579 where @xmath357 is the number of leaves of @xmath144 pointing to the right .",
    "for example , if @xmath580 , then @xmath581 , @xmath582 , @xmath583 and @xmath584    we show that @xmath585 as defined in theorem  [ thmrs ] satisfies the recursion relation of lemma  [ lemmaneuf ] .",
    "let us first consider that @xmath267 and @xmath268 .",
    "let @xmath586 denote the index such that @xmath587 , with @xmath588 .",
    "the term of the numerator corresponding to @xmath586 is @xmath589 , which is the central term of the recursion relation .",
    "we have @xmath590 and @xmath591 .",
    "thus , the denominator is @xmath592 , which is the denominator of the recursion relation .",
    "now we check that the product of terms for @xmath593 in theorem  [ thmrs ] is @xmath594 .",
    "the matrix elements @xmath595 obviously agree , so we must check that the denominators agree .",
    "thus , we verify that , for @xmath596 , @xmath597 and @xmath598 , where @xmath599 and @xmath600 denote the @xmath178 and @xmath601 vectors for tree @xmath144 .",
    "we know that @xmath602 for @xmath596 .",
    "thus , for @xmath603 , @xmath604 if and only if @xmath605 and @xmath597 . for @xmath600 , we notice that for @xmath606 we have @xmath607 and the relation @xmath608 does not hold",
    ". therefore , @xmath609 and @xmath598 by the same argument as @xmath597 .",
    "the same reasoning holds for @xmath138 and the recursion relation is satisfied .",
    "the cases @xmath504 or @xmath506 are proved similarly .",
    "we conclude this section with a geometrical translation of the previous theorem .",
    "consider a tree @xmath144 with @xmath610 and number its leaves from 1 for the leftmost leave to @xmath142 for the rightmost one . for each vertex @xmath126 of @xmath144",
    ", take the subtree @xmath611 for which @xmath126 is the root .",
    "in other words , @xmath611 is obtained by chopping the edge below @xmath126 and considering the half - edge dangling from @xmath126 as the dangling line of the root of @xmath611 . for each tree",
    "@xmath611 , build the pair @xmath612 which are the indices of the leftmost and rightmost leaves of @xmath611 . recall that @xmath613 belongs to the image of @xmath19 ( resp .",
    "@xmath12 ) if leaf @xmath54 points to the left ( resp .",
    "right ) : this implies in particular that @xmath614 and @xmath615 .",
    "then , the set of pairs @xmath612 where @xmath126 runs over the vertices of @xmath144 is the same as the set of pairs @xmath616 of the theorem .",
    "the formula for @xmath617 can be rewritten accordingly and this geometrical version can be proved recursively as theorem  [ thmrs ] .",
    "conversely , it can be used to determine the tree corresponding to a given denominator .",
    "we considered three expansions of the wave operator and we proved their adiabatic convergence .",
    "we proposed to expand the wave operator over trees , and proved that this expansion reduced the number of terms of the expansion with respect to usual ( tractable ) ones , simplified the denominators of the expansion into a product of the difference of two energies and lead to powerful formulas and recursive computational methods .",
    "we then showed that this simplification is closely related to the algebraic structure of the linear span of permutations and of a certain convolution subalgebra of trees .",
    "as far as the many - body problem is concerned , we showed that the simplification of diagrams is not due to the details of the hamiltonian but to the general structure of the wave operator . when the eigenstates and hamiltonian are expressed in terms of creation and annihilation operators and quantum fields , the algebra of trees mixes with the hopf algebraic structure of fields  @xcite .",
    "it would be interesting to investigate the interplay of these algebraic structures .",
    "the terms of the rayleigh - schrdinger series are usually considered to be `` quite complicated '' ( see ref .",
    "8) and difficult to work with .",
    "the general term of the rayleigh - schrdinger series for quasi - degenerate systems is obtained as the limit for @xmath10 of @xmath618 in theorem  [ thmrs ] . through our recursive and non - recursive expressions for these terms , many proofs of their properties",
    "become almost trivial .",
    "the tree structure suggests various resummations of this series , that will be explored in a forthcoming publication .",
    "this work was partly supported by the anr hopfcombop .",
    "one of the authors ( .m . ) was supported through the fellowship sfrh / bpd/48223/2008 provided by the portuguese science and technology foundation ( fct ) .",
    "in this appendix we state and prove a lemma that is crucial to demonstrate theorem [ thmomegat ] , which is one of the main results of our paper .",
    "we first need a noncommutative analogue of chen s formulas for products of iterated integrals .",
    "this analogue , proved in refs .   and , provides a systematic link between the theory of iterated integrals , the combinatorics of descents , free lie algebras and noncommutative symmetric functions ( see ref .   and appendix  [ sect - algebra ] of the present article for further details ) .",
    "let @xmath619 be an arbitrary sequence of time - dependent operators @xmath620 , satisfying the same regularity conditions as @xmath1 in section [ tdh ] .",
    "let @xmath108 be a permutation in @xmath93 and define : @xmath621    the notation is extended linearly to combinations of permutations , so that for @xmath622 , with @xmath623",
    ". then @xmath624 is defined as the linear combination @xmath625 for @xmath626 another sequence of time - dependent operators , we write @xmath627 for the concatenation product @xmath628 .",
    "we also need to define the convolution product of two permutations . if @xmath629 and @xmath630 , then @xmath631 is the sum of the @xmath632 permutations @xmath633 such that @xmath634 and @xmath635 . here , @xmath636 is the standardization map defined in section [ perm - tree ] .",
    "for instance , @xmath637 in words , the product of two permutations @xmath638 and @xmath630 is the sum of all permutations @xmath108 of @xmath639 such that the elements of the sequence @xmath640 are ordered as the elements of @xmath641 , in the sense that @xmath642 if and only if @xmath643 and the elements of @xmath644 are ordered as the elements of @xmath645 .",
    "now , we can state the noncommutative chen formula  @xcite ( see also remark 3.3 , p.  4111 of ref .  )",
    "[ ncchen ] we have : @xmath646    the following lemma can be proven similarly :    [ fundam ] we have , for @xmath397 and @xmath65 as above and @xmath184 a time - dependent operator : @xmath647 where @xmath275 runs over the permutations in @xmath648 with @xmath649 , @xmath650 , @xmath651 .",
    "we expand @xmath652 and @xmath653 @xmath654 this is the same formula as for the expansion of @xmath655 , up to the term @xmath656 and the integration @xmath657 that however do not change the underlying combinatorics .",
    "therefore , lemma  [ ncchen ] holds in the form @xmath658 where , by the definition of @xmath631 , the sum over @xmath108 is over all the permutations of @xmath639 such that @xmath659 and @xmath660 .",
    "now , we change variables to @xmath661 , @xmath662 for @xmath663 .",
    "the permutation @xmath275 of @xmath664 corresponding to the permutation @xmath108 of @xmath665 is characterized by @xmath649 ( because @xmath666 for all @xmath54 ) , @xmath667 for @xmath668 and @xmath669 for @xmath670 .",
    "therefore , @xmath671 where @xmath275 satisfies @xmath649 , @xmath650 , @xmath651 .",
    "the lemma is proved .",
    "notice that the same process would allow to derive combinatorial formulas for arbitrary products of iterated integrals and for integrals with integrands involving iterated integrals , provided these products and integrands have expressions similar to the ones considered in the two lemmas .",
    "our exposition of tree - parametrized time - dependent perturbation theory has focussed on the derivation of convergence results and explicit formulas for the time - dependent wave operator . however , the reasons why such an approach is possible and efficient are grounded into various algebraic and combinatorial properties of trees , descents and similar objects .",
    "these properties suggest that the theory of effective hamiltonians is grounded into a new `` lie theory '' generalizing the usual lie theory ( or , more precisely , generalizing the part of the classical lie theory that is relevant to the study of the solutions of differential equations ) .",
    "first indications that such a theory exists were already pointed out in our ref .  .",
    "indeed , we showed in this article that descent algebras of hyperoctahedral groups and generalizations thereof are relevant to the time - dependent perturbation theory .",
    "applications included an extension of the magnus expansion for the time - dependent wave operator .",
    "our results below provide complementary insights on the subject and further evidence that algebraic structures underly many - body theories .      we know from ref .   and sect  [ permutation - sect ] that the family of integrals @xmath672 is closed under the product .",
    "this closure property is reflected into the convolution product of permutations .",
    "this result is a natural noncommutative generalization of chen s formula for the product of iterated integrals .",
    "we show , in the present section , that the same result holds for integrals parametrized by trees .",
    "we will explain , in the next sections , why such a result -which may seem surprising from the analytical point of view- could be expected from the modern theory of combinatorial hopf algebras .    for @xmath619 a family of time - dependent operators ( with the usual regularity conditions ) , and @xmath144 a tree with @xmath21 internal vertices , we write @xmath673 this notation is extended to linear combinations of trees , so that e.g. if @xmath674 , where @xmath144 and @xmath269 are two arbitrary trees with the same number of vertices , then @xmath675 . for @xmath676 ,",
    "we write @xmath677 , @xmath678 .",
    "[ produ ] for @xmath619 and @xmath679 two families of time - dependent operators and @xmath212 , @xmath680 two trees , @xmath681 in the formula , one or several of the trees @xmath682 may be the trivial tree @xmath683 .",
    "recall the integration by parts formula . for any integrable functions @xmath684 and",
    "@xmath685 we define @xmath686 , @xmath687 and @xmath688 .",
    "then @xmath689 now , we use this identity with @xmath690 .",
    "it follows from the proof of theorem  [ omegat ] that @xmath691 is given by @xmath692 with a similar identity for @xmath693 .",
    "the proposition follows .",
    "this result may be formalized algebraically .",
    "let us write @xmath548 for the set of formal power series with complex coefficients over the set of trees .",
    "proposition  [ produ ] enables us to define a product on trees , denoted by @xmath695 , such that @xmath696 .",
    "this product is defined recursively by the equation  @xcite @xmath697    the empty tree @xmath132 is the unit for the product @xmath695 .",
    "assume that @xmath698 is defined and satisfies the recursive relation for all trees such that @xmath699 , and consider two trees @xmath144 and @xmath700 with @xmath701 .",
    "the first term on the right hand side of proposition  [ produ ] is @xmath702 . by the recursive relation",
    ", we have @xmath703 thus , the whole term can be written @xmath704 the second term of proposition  [ produ ] is treated similarly and we obtain @xmath705 therefore , the relation @xmath696 gives us @xmath706        of course , although the analysis of tree - shaped iterated integrals leads to a straightforward proof , the associativity property is a purely combinatorial phenomenon that originates ultimately from the associativity of the shuffle product .",
    ".   for the connections between the noncommutative chen formula and shuffle products , see also section 4 of ref .   for schtzenberger s classical ( but rarely quoted ) analysis of the formal properties of the shuffle product -in fact ,",
    "the splitting of the convolution product of trees reflects the classical splitting of shuffle products into left and right half - shuffle products that had appeared in the study of lie polynomials and was first encoded combinatorially in ref .  .",
    "the associativity can also be checked directly or deduced from the associativity of the convolution product @xmath695 of permutations , since one may verify easily , using e.g. our description of the permutations in @xmath216 that the convolution product as introduced above is nothing but the restriction to @xmath548 of the convolution product on the algebra @xmath707 $ ] .",
    "this fact that the linear span of trees ( often written @xmath708 ) defines a subalgebra of @xmath709 for the convolution product ( and even a hopf subalgebra , referred to as the hopf algebra of planar binary trees , whereas @xmath709 is referred to as the malvenuto - reutenauer or hopf algebra of free quasi - symmetric functions in the litterature ) is well - known .",
    "it was first observed in ref .   and",
    "further investigated in a series of papers  @xcite .",
    "there is however a slight subtelty here , since the embedding of @xmath708 in @xmath709 considered e.g. in ref .",
    "is not the one we consider ( another projection map from permutations to trees is used ) so that @xmath708 and @xmath548 , although isomorphic as algebras ( the product rule in @xmath708 is the same as the one in @xmath548 , see e.g. proposition  3.2 of ref .  , where @xmath708 is written @xmath710 $ ] ) do not agree as subalgebras of @xmath709 .",
    "however , a corollary of this isomorphism is that the structures existing on @xmath708 carry over to the analysis of the algebraic properties of tree - shaped iterated integrals .",
    "the existence of a hopf algebra structure seems particularly meaningful since the classical applications of the theory of free lie algebras to the analysis of differential equations can be rewritten using the framework of hopf algebras ( see e.g. the accounts in refs .  ) .",
    "the same observation holds for the direct sum of the hyperoctahedral group algebras , that also carries naturally a hopf algebra structure @xcite , and which applications to time - dependent perturbative hamiltonians were studied in ref .  .",
    "we leave for further research the investigation of the possible role of these hopf algebra structures in the context of many - body theories .",
    "another meaningful observation , along the same lines , is that the three expansions we derived , based respectively on sequences of @xmath12 and @xmath19 ( as in the first expression for @xmath711 ) , on trees ( third expression ) and on permutations ( second expression ) , reflect at the analytical level the existence of projection maps and embeddings between hypercubes ( or the descent algebra ) , planar binary trees , and permutations .",
    "following viennot  @xcite , these maps have been at the origin of modern enumerative combinatorics .",
    "we refer to refs .   for a detailed study of these maps that emphasizes the existence of underlying geometrical structures that go beyond the hopf algebraic ones .",
    "when @xmath8 is quadratic , the time - dependence of the annihilation operators is simply @xmath712 , where @xmath713 is the energy of the @xmath21th eigenvalue of @xmath8 ( see , e.g. ref .  ) .",
    "when @xmath8 is not quadratic , the time - dependent annihilation operators and the free feynman propagator can not be calculated explicitly .              this assumption can be relaxed by using the interaction picture ( see ref .",
    ", p.  283 and , p.  557 ) .",
    "in the adiabatic limit , we recover the rayleigh - schrdinger series , which is valid when the perturbation @xmath2 is relatively - bounded with respect to @xmath8 ( see chapter xii of ref .  ) .",
    "a.  a. agrachev and r.  v. gamkrelidze .",
    "the shuffle product and symmetric groups . in k.",
    "d. elworthy , w.  n. everitt , and e.  b. lee , editors , _ differential equations , dynamical systems and control science _ ,",
    "volume 152 of _ lecture notes in pure and applied mathematics _",
    ", pages 36582 .",
    "marcel dekker , inc . , new york , 1994 ."
  ],
  "abstract_text": [
    "<S> the computational complexity of time - dependent perturbation theory is well - known to be largely combinatorial whatever the chosen expansion method and family of parameters ( combinatorial sequences , goldstone and other feynman - type diagrams ... ) . </S>",
    "<S> we show that a very efficient perturbative expansion , both for theoretical and numerical purposes , can be obtained through an original parametrization by trees and generalized iterated integrals . </S>",
    "<S> we emphasize above all the simplicity and naturality of the new approach that links perturbation theory with classical and recent results in enumerative and algebraic combinatorics . </S>",
    "<S> these tools are applied to the adiabatic approximation and the effective hamiltonian . </S>",
    "<S> we prove perturbatively and non - perturbatively the convergence of morita s generalization of the gell - mann and low wavefunction . </S>",
    "<S> we show that summing all the terms associated to the same tree leads to an utter simplification where the sum is simpler than any of its terms . </S>",
    "<S> finally , we recover the time - independent equation for the wave operator and we give an explicit non - recursive expression for the term corresponding to an arbitrary tree . </S>"
  ]
}