{
  "article_text": [
    "chronic obstructive pulmonary disease ( copd ) , characterized by limitation of airflow , is a leading cause of morbidity and mortality @xcite .",
    "pulmonary emphysema , defined by a loss of lung tissue in the absence of fibrosis , overlaps considerably with copd .",
    "pulmonary emphysema is traditionally subcategorized into three standard subtypes , which were initially defined at autopsy , and can be visually assessed on computed tomography ( ct ) , according to the following definitions @xcite : _ centrilobular emphysema _ ( cle ) , defined as focal regions of low attenuation surrounded by normal lung attenuation ; _ panlobular emphysema _ ( ple ) , defined as diffuse regions of low attenuation involving entire secondary pulmonary lobules ; and _ paraseptal emphysema _ ( pse ) , defined as regions of low attenuation adjacent to visceral pleura ( including fissures ) .",
    "given that these subtypes are associated with distinct risk factors and clinical manifestations @xcite@xcite , they are therefore likely to represent different diseases and can help with the diagnosis of copd .",
    "radiologists interpretation of standard subtypes is labor - intensive , and has modest inter - rater agreements @xcite .",
    "automated texture - based analysis of emphysema offers the potential of automated copd diagnosis and catalyzing research ( e.g. discovering emphysema subtypes ) , and is receiving increasing interest @xcite .",
    "however , most existing approaches are limited to supervised emphysema subtype classification using manually annotated scans in local regions of interest ( rois ) , which are very costly and time - consuming to obtain .",
    "furthermore , it is unclear if the supervised classifiers generalize to other datasets with varying in - plane resolutions and scanner types .",
    "a recent clinical study @xcite demonstrated the reliability and clinical significance of global ( rather than local ) labeling of lung volumes using the three standard subtypes .",
    "global labeling generates weakly labeled data that was used for the classification of copd subjects with multiple instance learning ( mil ) @xcite .",
    "however , mil has only been demonstrated so far for binary labeling of emphysema versus normal tissue , rather than to distinguish the three subtypes , and can generate unreliable local roi labeling .    in this work",
    ", we present a novel framework to discover unsupervised fine - grained prototypes that go beyond but still have the power of encoding the three standard emphysema subtypes .",
    "our method clusters local rois of lung volumes into texture prototypes in an unsupervised manner , and builds signatures of lung volumes with texture prototype histograms .",
    "the extent of standard emphysema subtypes can be predicted from these prototype histograms with a constrained multivariate regression on global labels . to our knowledge , this is the first study whereby texture - based predictions are used to globally characterize the standard emphysema subtypes .",
    "three types of texture features were tested , extracted from 3d or 2d local rois , to generate the emphysema prototypes : 1 ) frequency histograms of textons ( called texton - based features ) , used in @xcite@xcite ; 2 ) soft histograms of intensities and difference of gaussian ( dog ) responses ( called dog2 features ) , used in @xcite ; and 3 ) joint histograms of local binary patterns ( lbp ) and intensities ( called lbp2 features ) , used in @xcite .",
    "our framework is divided into a learning stage in an unsupervised sense , and a prediction stage of radiological emphysema subtypes using globally annotated data .",
    "the intensity of lung voxels , inside lung masks generated using the apollo^^ software ( vida diagnostics , coralville , iowa ) , are rescaled from [ -1024 , -400 ] hu to [ 0 , 1 ] via either linear or sigmoidal mapping in pre - processing .    in the learning stage ,",
    "texture prototypes are learned and prototype histograms @xmath0 are built for each training lung volume .",
    "[ fig : framework ] illustrates the pipeline for generating prototype histograms .",
    "sample points are randomly extracted uniformly within the lung volumes .",
    "2d or 3d neighborhoods of sampled points are used as local rois , with a size of @xmath1 or @xmath2 , approximating the diameter of secondary pulmonary lobules .",
    "our target number of sample points per scan is @xmath3 . since we discard rois with more that 50% of non - lung field , we adjust the sample ratio @xmath4 so that @xmath5 .",
    "the value @xmath6 is suitable for the population of scans , leading to an average of 1,512 sample points per ct scan .",
    "rois are characterized with texture features ( texton - based , dog2 or lbp2 ) , and are clustered into @xmath7 texture prototypes in an unsupervised manner . for interpretation , prototypes are ordered according to the average intensity value of training rois belonging to each prototype .",
    "each sample point is labeled with the prototype centroid most similar to its roi ( i.e. with least distance in feature space ) .",
    "finally , other voxels within the lung volumes are labeled by assigning the prototype label of the nearest sample point .    in the prediction stage ,",
    "sample points and rois are extracted from test lung volumes and roi texture features are generated .",
    "rois are labeled by assigning the most similar prototype centroid .",
    "prototype histograms are then generated for test lung volumes following the same procedure as in the training stage .",
    "to evaluate our texture prototypes , we regressed their occurrence against global emphysema labels in @xcite on training scans , with a constrained multivariate model .",
    "global labels @xmath8 encode the extent of standard emphysema subtypes referred to as @xmath9 , @xmath10 , @xmath11 .",
    "the residual , denoted @xmath12 , corresponds to tissue without emphysema ( but maybe with some lung diseases ) .    in the following sections , we detail the texture features , the unsupervised learning of prototypes and the regression model .",
    "texton - based features characterize rois with the help of a texton codebook .",
    "the texton codebook is formed by the cluster centers of intensity values ( after linear mapping ) from small - sized local patches ( here 3 voxels in each dimension ) randomly extracted from rois in the training set .",
    "clustering is performed with _ k_-means . by projecting all small - sized patches onto the codebook ,",
    "the texton - based feature of the roi is the normalized histogram of texton frequencies .",
    "targeting 4 classes and 10 textons per class @xcite , the feature vector length is set to 40 , using a codebook with 40 textons .",
    "note that our texton prototype histogram uses the bag - of - words ( bow)@xcite model on two scales : 1 ) building of roi - level texture features based on a texton dictionary ; 2 ) building subject - level lung ct signatures based on texture prototypes . to our knowledge",
    ", bow has not been exploited for subject - level signatures before .",
    "the dog2 feature of a roi is a concatenation of four normalized soft histograms : one intensity histogram , and three histograms of dog responses at three octaves .",
    "using 10 bins for each histogram , following the setting in @xcite , leads to a feature vector of length 40 .",
    "intensity values in ct scans encode x - ray attenuations in hounsfield units ( hu ) and their range is very large . to focus the texture learning process on the intensity range of interest ( lung parenchyma and air ) , a sigmoid function is used , as in @xcite , to map values to the interval @xmath13 $ ] with the highest contrast assigned to the range @xmath14 $ ] hu where textural characteristics due to emphysema are presumed to be present .",
    "the lbp2 feature of a roi is the joint histogram of lbp codes and intensity values ( after linear mapping ) of each voxel within the roi .",
    "the lbp codes are obtained by thresholding samples in a local neighborhood around center voxel @xmath15 .",
    "formally :    @xmath16    where @xmath17 is the intensity of center voxel , @xmath18 are @xmath19 voxels sampled around @xmath15 at a given radial distance @xmath20 , and @xmath21 is the heaviside function .",
    "rotational invariance is achieved by rotating the radial sampling until the lowest possible @xmath22 value is found .",
    "we use 10 uniform rotational invariant lbp codes with r=1 and p=8 , and 4 bins for the intensity histogram to match with other feature length , making the total feature length also 40 ( @xmath23 ) .",
    "the number of prototypes @xmath7 should be large enough to handle the diversity of textures encountered in the lung volumes ( i.e. good intra - prototype homogeneity ) , but small enough to avoid redundancy ( i.e. good inter - prototype differences ) .",
    "our strategy is to first select an empirically large number @xmath7 so as to generate homogenous prototypes and then trim the set to a smaller number of sufficient prototypes ( number likely different for different texture features ) according to a dedicated metric .",
    "we choose _",
    "k_-means for the clustering task because of its efficiency at dealing with a large number of rois over scans .    to trim the number of prototypes , instead of testing smaller @xmath7 values with _",
    "k_-means , which tends to decrease all intra - cluster homogeneity , we propose to merge prototypes iteratively according to their inter - prototype distance and spatial co - occurrence .",
    "the inter - prototype distance is measured by averaging the @xmath24 distance ( common for histogram - based features ) between each pair in feature space .",
    "the spatial co - occurrence of two prototypes @xmath25 and @xmath26 ( @xmath27 ) is measured as :    @xmath28    where @xmath29 is the frequency of prototypes @xmath25 and @xmath26 appearing together in a pre - defined small neighborhood ( here 10 voxels in each dimension ) .",
    "at each iteration of the pruning process , each pair of prototypes is given a rank @xmath30 in inter - prototype distance ( smallest ranks first ) , and a rank @xmath31 in spatial similarity ( largest ranks first ) .",
    "the pair of prototypes to merge is the first one according to the rank : @xmath32 .",
    "the probability of voxel @xmath15 belonging to a lung tissue class can be modeled as :    @xmath33    where @xmath34 is the label of voxel @xmath15 as @xmath35 , and @xmath36 is the voxel prototype label @xmath37 with @xmath38 .",
    "if prototypes are homogeneous , @xmath39 can be assumed to be consistent throughout rois and subjects .",
    "we therefore infer the relation as :    @xmath40    where @xmath41 is the number of training scans .",
    "each row in @xmath42 is the global label @xmath43 $ ] for one scan , each row in @xmath44 is the prototype histogram @xmath45 $ ] for the same scan , and @xmath46 is the matrix of regression coefficients with @xmath47 , @xmath48 and @xmath49 .",
    "we propose to learn @xmath46 with the following constrained multivariate regression model :    @xmath50",
    "the dataset includes 321 full - lung ct scans from the multi - ethnic study of atherosclerosis ( mesa ) copd study @xcite , among which 4 scans are discarded due to excessive motion artifact or incomplete lung field of view .",
    "all ct scans were acquired at full inspiration with either a siemens 64-slice scanner or a ge 64-slice scanner , and reconstructed using b35/standard kernels with axial resolutions within the range [ 0.58 , 0.88]mm , and 0.625 mm slice thickness .",
    "all scans were acquired at 120 kvp , 0.5 seconds , with milliamperes ( ma ) set by body mass index following the spiromics protocol @xcite .",
    "global labels of standard emphysema subtypes are available for each scan , corresponding to the average of visually assessed scores by four experienced radiologists @xcite .",
    "inter - rater intraclass correlations , evaluated on 40 random scans , are reported in fig .",
    "[ fig : proto - pruning ] .",
    "the clinically - evaluated prevalence of emphysema in this dataset is 27@xmath51 , with 14@xmath51 cle - predominance , 9@xmath51 pse - predominance , and 4@xmath51 ple - predominance .",
    "confidence interval).,width=453 ]    the quality of the predictions is evaluated using intraclass correlation ( icc ) with ground truth global labels . to achieve a balance between the number of training scans ( large enough to learn lung textures ) and the number of test scans ( large enough so that the prediction performance is not biased by extreme points )",
    ", we used a 4-fold cross validation setup , with @xmath52 of scans used for training , and @xmath53 used for testing .",
    "all features were computed within 3d rois .",
    "texton - based features were also extracted in 2d rois for comparison .",
    "we select @xmath54 as our benchmark value , from which we iteratively merge prototypes .",
    "we report the evolution of prediction capabilities as @xmath7 is reduced in fig .",
    "[ fig : proto - pruning ] ( all @xmath55values @xmath56 0.01 ) .",
    "overall , texton - based and dog2 features give robust prediction that outperform the intra - rater agreement , while lbp2 features have poor to modest prediction capabilities .",
    "one reason might be that intensity information in lbp2 is compressed with our current feature length , while intensities improved the discriminative capability of the original lbp code in @xcite .",
    "however , we observed that a feature length over 50 decreases the robustness and drastically increases the convergence time for unsupervised prototype clustering .",
    "this makes lbp2 less favorable in our unsupervised learning context .",
    "the comparison of 2d versus 3d rois with texton - based features indicates that the richer information in 3d neighborhood is helpful for modeling emphysema subtypes , at the price of additional computational cost for feature extraction .    regarding the effect of prototype merging , icc values remain steady when @xmath57 for texton - based features .",
    "merging is capable of reducing model complexity with little sacrifice in prediction performance . for dog2 features ,",
    "the performance begins to decrease only after @xmath58 .",
    "for lbp2 features , however , the performance degrades immediately after merging , which may be because the lbp2-based prototypes are not sufficiently homogeneous from the beginning .",
    "note that using a high number of @xmath7 , much larger than the number of standard emphysema subtypes or than required for predictive power of these subtypes , is driven by our goal to be able to discover finer emphysema subtypes .",
    "the current arbitrary number @xmath54 will be further trimmed with an optimization metric incorporating respiratory symptoms and generalization capabilities to other datasets , which is ongoing work of our study .    , @xmath59 , @xmath60 , @xmath61 , @xmath62 and @xmath63 benchmark prototypes .",
    "the dog2 and lbp2-based prototypes are those having the most overlap with texton - based prototypes for roi labeling .",
    "window level : [ -1000 , -700 ] hu.,width=453 ]      reproducibility of prototypes is measured by computing the overlap of prototype labeling with two distinct training sets ( by randomly dividing the subjects into two groups ) , in a manner similar to @xcite .",
    "formally , we measure :    @xmath64    where @xmath65 and @xmath66 are prototype labeling with two different training sets , @xmath67 is the 0 - 1 loss function , @xmath68 denotes rois labeled with prototype @xmath69 , and @xmath70 denotes the permutations of the @xmath7 prototypes using the hungarian method @xcite for optimal matching .",
    "[ fig : proto ] ( a ) plots @xmath20 versus number of prototypes . for @xmath58 , reproducibility is high ( @xmath71 ) for all types of features .",
    "when @xmath57 , 3d texton - based prototypes are more reproducible ( @xmath72 with @xmath7 as large as 100 ) .",
    "hu.,width=453 ]      visual examples of prototypes generated with three different types of features using 3d rois are provided in fig .",
    "[ fig : proto ] ( b ) .",
    "texton and dog2-based prototypes have high intra - class similarity and show clearly distinct lung tissue patterns , while lbp2-based prototypes have lower intra - class homogeneity , which agrees with the poorer prediction results .",
    "we also provide in fig . 4 visual examples of prototypes that are likely to encode emphysematous lung tissues .",
    "first , subjects in the dataset were separated into two groups : _ disease _ ( visually assessed extent of emphysema [ 2 ] larger than 0 ) and _ normal _ ( visually assessed extent of emphysema equals to 0 ) .    out of the k = 100 benchmark prototypes , we selected the ones for which occurrence within the disease population was 3 times higher than in the normal population .",
    "this lead to subsets of @xmath73 disease prototypes when using respectively texton - based , dog2 and lbp2 features , in 3d rois .",
    "these subsets are illustrated in fig .",
    "[ fig : disease_like ] on group of 9 patches of size of @xmath74 from random disease subjects .",
    "the large patch size ( twice the length of the rois used for prototype generation ) is used to reveal the presence of nearby lung borders .",
    "in this work , we presented a novel framework to generate unsupervised lung texture prototypes that can be used to predict the overall extent of standard emphysema subtypes from a heterogeneous database of lung ct scans , using standard radiological global labels as the ground truth .",
    "we cluster unlabeled local rois into texture prototypes , and encode lung ct scans with prototype histograms .",
    "labeling of rois is tested in 2d or 3d , and using three types of features .",
    "the intraclass correlations between prediction and ground truth labeling indicate that texton and dog2 features are capable of learning homogenous prototypes and lead to very robust predictions of standard emphysema labels that outperform the inter - rater agreement , while lbp2 feature is less discriminative ( at least with similar feature vector length ) .",
    "we tested model reduction via prototype merging based on inter - prototype distance and spatial co - occurrence .",
    "results show that robust prediction can be achieved with at least @xmath7=60 merged prototypes for texton - based features and @xmath7=50 for dog2 features .",
    "reproducibility of texton - based prototypes is superior when @xmath57 .",
    "these homogeneous and reproducible texture prototypes show potential in new interpretations of lung ct scans with finer subtyping .",
    "since texture prototypes link image analysis - based discovery with radiological prior knowledge , and enable automated labeling of lung volumes and generation of scan signatures , they can be used for multiple tasks such as correlation with omic measures , sub - phenotyping of emphysema or image indexing and retrieval .",
    "our future work will focus on two aspects : 1 ) as texton - based feature and dog2 feature both demonstrated good capability at discovering lung texture prototypes , we would like to explore their combination to boost robustness and discovery power , which can be achieved by either feature concatenation followed by feature dimension reduction ( to reduce the computational complexity , as in @xcite ) , or post - clustering ensembling @xcite ; 2 ) the number of prototype @xmath7 will be further trimmed to find clinically significant sub - categories of emphysema , with an optimization metric incorporating clinical data and generalization capability .",
    "smith , b.m .",
    ", austin , j.h . ,",
    "newell , j.d . ,",
    "dsouza , b.m . ,",
    "rozenshtein , a. , hoffman , e.a . , ahmed , f. , barr , r.g .",
    ": pulmonary emphysema subtypes on computed tomography : the mesa copd study . the american journal of medicine 127(1 ) , 94.e723 ( 2014 )    dahl , m. , tybjaerg - hansen , a. , lange , p. , vestbo , j. , nordestgaard , b.g . : change in lung function and morbidity from chronic obstructive pulmonary disease in alpha1-antitrypsin mz heterozygotes : a longitudinal study of the general population .",
    "annals of internal medicine 136(4 ) , 270279 ( 2002 )      barr , r.g . , berkowitz , e.a .",
    ", bigazzi , f. , bode , f. , bon , j. , bowler , r.p . ,",
    "chiles , c. , crapo , j.d . , criner , g.j .",
    ", curtis , j.l . : a combined pulmonary - radiology workshop for visual evaluation of copd : study design , chest ct findings and concordance with quantitative evaluation .",
    "copd 9(2 ) , 151159 ( 2012 )    xu , y. , sonka , m. , mclennan , g. , guo , j. , hoffman , e. : mdct - based 3-d texture classification of emphysema and early smoking related lung pathologies .",
    "ieee transactions on medical imaging 25(4 ) , 464475 ( 2006 )      gangeh , m.j . , srensen , l. , shaker , s.b . ,",
    "kamel , m.s .",
    ", de  bruijne , m. , loog , m. : a texton - based approach for the classification of lung parenchyma in ct images . in : international conference on medical image computing and computer - assisted intervention ( miccai ) .",
    "595602 . springer ( 2010 )      depeursinge , a. , foncubierta - rodriguez , a. , van de  ville , d. , mller , h. : three - dimensional solid texture analysis in biomedical imaging : review and opportunities .",
    "medical image analysis 18(1 ) , 176196 ( 2014 )    cheplygina , v. , srensen , l. , tax , d.m . , de  bruijne , m. , loog , m. : label stability in multiple instance learning . in : international conference on medical image computing and computer - assisted intervention ( miccai ) .",
    "539546 . springer ( 2015 )    hame , y. , angelini , e.d . ,",
    "parikh , m.a . ,",
    "smith , b.m . , hoffman , e.a . ,",
    "barr , r.g . ,",
    "laine , a.f .",
    ": sparse sampling and unsupervised learning of lung texture patterns in pulmonary emphysema : mesa copd study . in :",
    "ieee 12th international symposium on biomedical imaging ( isbi ) . pp .",
    "ieee ( 2015 )      sieren , j.p . ,",
    "newell , jr , j.d . , barr , r.g . ,",
    "bleecker , e.r . ,",
    "burnette , n. , carretta , e.e . ,",
    "couper , d. , goldin , j. , guo , j. , han , m.k . : spiromics protocol for multicenter quantitative ct to phenotype the lungs .",
    "american journal of respiratory and critical care medicine ( ja ) ( 2016 )      lopez - sastre , r.j .",
    ": unsupervised robust feature - based partition ensembling to discover categories . in : proceedings of the ieee conference on computer vision and pattern recognition workshops .",
    ". 114122 ( 2016 )"
  ],
  "abstract_text": [
    "<S> pulmonary emphysema is traditionally subcategorized into three subtypes , which have distinct radiological appearances on computed tomography ( ct ) and can help with the diagnosis of chronic obstructive pulmonary disease ( copd ) . </S>",
    "<S> automated texture - based quantification of emphysema subtypes has been successfully implemented via supervised learning of these three emphysema subtypes . in this work , </S>",
    "<S> we demonstrate that unsupervised learning on a large heterogeneous database of ct scans can generate texture prototypes that are visually homogeneous and distinct , reproducible across subjects , and capable of predicting accurately the three standard radiological subtypes . </S>",
    "<S> these texture prototypes enable automated labeling of lung volumes , and open the way to new interpretations of lung ct scans with finer subtyping of emphysema . </S>"
  ]
}