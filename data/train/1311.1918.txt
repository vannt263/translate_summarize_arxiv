{
  "article_text": [
    "let @xmath18 with @xmath19 and consider the monge optimal transportation problem @xmath20 where @xmath0 is a _ convex norm _ in @xmath4 , namely a positively @xmath12-homogeneous function whose unit ball @xmath21 is a closed @xmath22-dimensional convex set @xmath23 with @xmath24 .",
    "the @xmath2-measurable maps @xmath25 satisfying @xmath26 are called _ transport maps_. well known examples show that if @xmath2 is not absolutely continuous w.r.t .",
    "@xmath5 , there may be no optimal transport maps ( see theorem 8.3 of @xcite ) .    due to the nonlinearity of the constraint @xmath27 , the classical approach to solve is first to consider the relaxed problem of finding optimal _ transference plans _",
    "@xmath28 defined by @xmath29 where @xmath30 and @xmath31 is the projection on the @xmath32-coordinate in the product space @xmath33 .",
    "assuming that @xmath34 by standard theorems in optimal transportation there always exists an optimal transference plan , without being in the degenerate situation where every plan @xmath35 is optimal .",
    "then , if one can show that there exists at least an optimal transport plan @xmath36 which is concentrated on a graph of a @xmath2-measurable map @xmath9 , i.e. @xmath37 , then @xmath9 is an optimal transport map solving .    the first strategy to show the existence of such a transference plan",
    "was proposed by sudakov in @xcite and consists in decomposing via disintegration of measures the optimal transportation problem into a family of transportation problems on @xmath6 , where @xmath7 are disjoint regions where the construction of an optimal map @xmath8 is simpler than in the original problem , and then to obtain @xmath9 by piecing together the maps @xmath10 .",
    "+ with additional regularity properties on the densities of @xmath2 , @xmath3 or on the norm , such as uniform convexity , an approach partially equal to the one proposed by sudakov was successfully followed in @xcite , @xcite , @xcite and @xcite .",
    "the most general case where up to now this approach has been successfully implemented ( see @xcite ) is the case in which @xmath0 is strictly convex , namely when the set @xmath23 is strictly convex .",
    "other approaches have also been used . in @xcite ,",
    "the problem for strictly convex norms has been solved using pde methods under the assumption that the marginals @xmath2 , @xmath3 have lipschitz continuous densities w.r.t .",
    "the problem was solved for crystalline norms in @xcite .    in @xcite",
    ", the authors solved the monge problem first with strictly convex and then with general convex norms using a different method , which does not pass through a geometric / measure theoretic decomposition of the optimal transportation problem into simpler ones , but is based on the selection among the optimal transference plans @xmath28 of a transference plan @xmath38 which is also minimizing a secondary cost : more precisely , one selects the ( unique ) transference plan @xmath38 such that @xmath39 and the main issue consists in proving that @xmath38 is actually induced by a transport map @xmath9 , which clearly satisfies .",
    "however , the problem of whether sudakov s strategy could be successfully implemented also in the case of general convex norms has remained open for a long time .",
    "the aim of this paper is to show how this problem can be solved . in order to introduce the notation that we need to state our main results and explain the new ideas and concepts in the case of general convex norms , we first resume briefly how sudakov s strategy works for strictly convex norms .",
    "the first step of sudakov s approach consists in finding a suitable partition in @xmath4 on which the transport occurs , namely s.t .",
    "the optimal plans move the initial mass inside the elements of the partition . by duality ( see e.g. @xcite ) , there exists a function @xmath40 , called _ kantorovich potential _ , which satisfies @xmath41 observe that , by , for all @xmath42 as in and @xmath43 @xmath44 the open oriented segments @xmath45x , y[\\,\\subset{\\mathbb{r}}^d$ ] ( where @xmath46 is a continuous parameter , @xmath12 referring to the dimension of the elements ) whose extreme points satisfy and which are maximal w.r.t . set inclusion",
    "are called _ optimal rays_. by strict convexity , if @xmath42 and @xmath47 , with @xmath48 , satisfy , then @xmath49x , z[.\\ ] ] in particular , if @xmath42 and @xmath50 satisfy but @xmath51 , then @xmath52x , y[\\,\\,\\cap\\,\\,]x',y'[=\\emptyset.\\ ] ] hence , the optimal rays @xmath53 form a borel partition of @xmath4 into @xmath12-dimensional open segments , up to the set of their _ initial points _ @xmath54 and of their _ final points _ @xmath55 , defined for every @xmath46 by @xmath56 being @xmath57 the half - line in @xmath4 giving the direction on @xmath58 along which the transport occurs , i.e. @xmath59 the partition into optimal rays with directions of transport @xmath60 is the simplest example of what we will call _ directed locally affine partition_. moreover , the set of initial / final points of the optimal rays is @xmath5-negligible ( and then also @xmath2-negligible ) . indeed , if @xmath42 satisfies and @xmath61 is differentiable at @xmath62 notice that this happens @xmath5-a.e .",
    "( and then @xmath2-a.e . )",
    "since @xmath61 is lipschitz , then @xmath63 where @xmath64 is the subdifferential of the convex norm , and , by strict convexity of @xmath0 , @xmath65 is an half - line corresponding to a unique @xmath57 .",
    "we recall that the convex cones of the form @xmath66 for some @xmath67 are called _ exposed faces _ of @xmath0 , while more generally the _ extremal faces _ of @xmath0 are by definition the projections on @xmath4 of the extremal faces of the convex cone @xmath68 . in the strictly convex case ,",
    "both concepts coincide and are given by half - lines .",
    "[ fi_casostrett_intro ]    assume w.l.o.g . that @xmath69 hence @xmath70 and that , for the moment , also @xmath71 .",
    "then , this first step yields that the optimal rays @xmath53 on which @xmath61 is differentiable form a partition in @xmath4 up to the @xmath5-negligible set ( thus also ( @xmath72)-negligible ) where @xmath61 is not differentiable s.t .",
    "@xmath73    the second step of the strategy consists in decomposing the transport problem in the sets @xmath74 .",
    "more precisely , for any given cone @xmath75 , let us denote by @xmath76 the cost function @xmath77 where @xmath78 is the indicator function of the set @xmath79 ( see ) . for notational convenience ,",
    "if @xmath80 $ ] is a borel cost function , we use the notation @xmath81 then , by and it follows that if @xmath82 , @xmath83 and @xmath84 denote the strongly consistent disintegrations ( see definition [ d_dis ] ) of @xmath36 w.r.t . @xmath85 and of @xmath2 and @xmath3 w.r.t .",
    "@xmath86 , one has @xmath87 being @xmath88 the plans of finite @xmath89-cost between @xmath90 and @xmath91 .",
    "in other words , the transport problem on @xmath4 reduces to a family of independent @xmath12-dimensional transport problems with linear cost and prescribed direction .",
    "if @xmath92 has no atoms , then the unique transference plan concentrated on a monotone graph in @xmath93 is actually concentrated on a map @xmath94 . in this setting , monotone means monotone w.r.t . the order induced by @xmath57 on @xmath58 , and",
    "the statement is a well known and simple result for 1-dimensional problems , which can be seen as a particular case of a more general structure result for optimal transportation problems with quadratic cost ( see for example @xcite ) .    then , the main problem in @xcite was to prove that the disintegration of @xmath5 ( and thus of @xmath2 ) on the optimal rays has non - atomic conditional measures .",
    "indeed , for a general borel partition into segments this might not be true , as discovered in a counterexample to the original sudakov s proof by alberti , kirchheim and preiss ( see personal communication in @xcite ) .",
    "the main issue was then to prove that the optimal rays satisfy an additional regularity property which guarantees that the conditional measures of @xmath5 are not atomic . in @xcite , @xcite , @xcite and @xcite , due to the additional regularity assumptions either on the measures @xmath2 , @xmath3 or on the norm , the unit vector field giving at each point of an optimal ray the direction of transport is locally lipschitz . then , via changes of variables using the classical coarea formula one can reduce to study the disintegration of the lebesgue measure on families of parallel segments , namely fubini theorem , which gives the absolute continuity of the conditional measures w.r.t .",
    "the @xmath12-dimensional hausdorff measure @xmath95 on the segments on which they are concentrated .",
    "the absolute continuity of the conditional measures w.r.t .",
    "the @xmath12-dimensional hausdorff measure on the optimal rays thus implying the solvability of the monge problem for general strictly convex norms was proved in @xcite . since in the general case",
    "no lipschitz regularity is available , the author used a technique first introduced for a partition into segments arising from a different variational problem in @xcite .",
    "such a technique is based on the validity for the family of segments ( in this case , the optimal rays ) of an approximation property via sequences of cone vector fields , that we call _ cone approximation property _ ( with the same terminology used in the first part of @xcite ) .",
    "we point out that , compared to the approach followed in @xcite , sudakov s approach for the monge problem gives and relies upon a deeper geometric characterization of the transport via optimal plans , namely the existence of a family of lower dimensional regions ( in the strictly convex case , @xmath12-dimensional ) on which the transport occurs and on which the existence of optimal maps becomes easier to prove .",
    "it remained unclear if the original strategy of sudakov can be successful not only in the case of strictly convex norms , thus giving a complete geometric characterization of the optimal transport plans via decomposition into lower dimensional transportation problems .",
    "the aim of this paper is to show how sudakov s approach can be carried on also in the general convex case . in the next section",
    "we define new concepts , which in the strictly convex case ( i.e. when the extremal faces of @xmath0 are 1-dimensional ) are trivially satisfied by the decomposition in optimal rays @xmath58 , and state our main results , giving an overall idea of the whole construction .",
    "recall that , for all @xmath42 as in , holds . in the strictly convex case",
    ", we have seen that and imply that whenever @xmath96 then @xmath62 belongs to a segment @xmath58 called optimal ray , which belongs to a partition on @xmath4 on which the transport occurs along the direction @xmath97 . however , for general convex norms , the optimal rays do not satisfy and then do not form a partition in @xmath4 .",
    "actually , @xmath98 , the sets @xmath99 called respectively _ superdifferential and subdifferential of @xmath61 at @xmath62 _ , may be contained in one or even more higher dimensional cones corresponding to extremal faces of @xmath0 . now , unlike in the strictly convex case , an extremal face is not in general a @xmath12-dimensional half line but a @xmath16-dimensional cone , with @xmath100 .",
    "hence sudakov claimed that the regions on which the transport occurs are relatively open subsets of affine planes whose dimension is equal to @xmath16 .",
    "however , even when considering the set of points in the super / subdifferential of @xmath61 at a certain point @xmath62 which are contained in a single @xmath16-extremal cone of @xmath101 , it may not be a convex @xmath16-dimensional set or more generally a set with a well defined affine dimension ( see figure [ fi_intro_supersub ] ) .",
    "when we faced this problem for general convex norms , the first main issue was to find other conditions which determine that a point @xmath62 belongs to one of the desired @xmath16-dimensional regions , thus generalizing the property that whenever @xmath102 , @xmath103 then @xmath104 and @xmath62 belongs to the optimal ray containing the segment @xmath105y'',y'[$ ] .",
    "the natural generalization of the partition into optimal rays for strictly convex norms is to look for a _ directed locally affine partition _",
    "@xmath106 of @xmath4 ( see definition [ d_locaffpart ] ) , namely a borel partition of @xmath4 into sets @xmath107 which are locally affine and @xmath16-dimensional , i.e. relatively open in their affine hull whose linear dimension is @xmath16 , together with an extremal cone @xmath108 of @xmath0 that will correspond to the union of directions of the optimal rays starting from @xmath109 .",
    "the first key idea is to observe that kantorovich duality - can be rewritten as follows ( see section [ ss_convex_norm_cone ] ) .",
    "let @xmath110 , @xmath111 and @xmath112 .",
    "one has @xmath113 where @xmath114 is the _ superdifferential of the set @xmath115_. in other words , tells us that studying the optimal transportation problem between @xmath2 and @xmath3 in @xmath4 is equivalent to study the finite cost transportation problem in @xmath116 for a convex cone cost ( precisely @xmath117 ) between measures ( @xmath118 , @xmath119 ) concentrated on a @xmath0-lipschitz graph ( namely @xmath120 ) or , by , to study transport plans which are concentrated on the superdifferential of the graph of the @xmath0-lipschitz function @xmath61 .",
    "the advantage of this point of view is that the properties of the super / subdifferential of @xmath61 which permit to generalize , and then to find a locally affine directed partition , can be more naturally expressed in terms of geometric properties of the super / subdifferential of @xmath120 where the subdifferential of @xmath120 is the set @xmath121 .",
    "first we will find a directed locally affine partition @xmath122 in @xmath116 for this transportation problem , whose direction cones @xmath123 are extremal faces of @xmath101 and on which the disintegration of the @xmath22-dimensional hausdorff measure @xmath124 on @xmath120 has conditional measures which are absolutely continuous w.r.t .",
    "@xmath125 , and then we will find the desired locally affine partition @xmath126 simply projecting it on @xmath4 . indeed ,",
    "the extremal faces of @xmath0 are by definition the projections on @xmath4 of the extremal faces of @xmath101 and the `` lifting map '' @xmath127 is bi - lipschitz , thus mapping negligible sets into negligible sets .",
    "the crucial properties of the super / subdifferential @xmath128 that we will use to find the partition are the so - called _ transitivity property _ @xmath129 and the _ completeness property _ of the @xmath0-lipschitz graph @xmath120 , that we define below .",
    "let @xmath130 be an extremal face of the convex cone @xmath101 and denote by @xmath131 its relative interior , namely its interior w.r.t .",
    "its affine hull .",
    "moreover , for any @xmath132 let @xmath133 the completeness property of @xmath120 is the following : @xmath134 where @xmath135 is convex and satisfies @xmath136 ( see proposition [ p_parall ] ) .    in the strictly convex case , the extremal faces @xmath130 of @xmath101 are half - lines .",
    "moreover , whenever ( resp . )",
    "holds @xmath137 is the extremal face of @xmath0 giving the direction of an optimal ray starting ( resp .",
    "arriving ) at @xmath138 , and @xmath139 $ ] .    in the general convex case ,",
    "the completeness property - then implies that whenever the directions of the optimal rays starting / arriving at a point @xmath140 are contained in a certain face @xmath130 and there exists a direction in @xmath131 , then they are a cone of directions coinciding with @xmath130 .",
    "moreover , by the transitivity property , whenever the same thing happens also for two points each belonging to one of the sets @xmath141 , then @xmath140 has a locally affine neighborhood , of the same dimension as @xmath130 and contained in @xmath142 , made of points for which the admissible directions of transport coincide with the directions of @xmath130 . roughly speaking , the relative interior of the extremal face @xmath130 plays the role of a direction of an optimal ray and the set @xmath143 the role of the segment @xmath144 $ ] inside such optimal ray in the strictly convex case ( see figure [ fi_intro_supersub ] ) .",
    "the suitable generalization of and its implications can then be found in the concept of what we call _ regular transport set _ @xmath145 .",
    "the notation will be clear in section [ s_foliations ] when we study the more general transport problem for @xmath146-lipschitz foliations , namely a family of graphs of @xmath147-lipschitz functions depending on a continuous parameter @xmath148 ( section [ s_foliations ] and proposition [ p_ex_fol ] ) .",
    "the study of @xmath146-lipschitz foliations will be one of the main issues to complete the construction of a suitable directed locally affine partition ( theorem [ t_final ] ) on which to solve .",
    "the points in @xmath149 are the points @xmath140 such that    1 .",
    "[ point_intro_loafpr1 ] the set of directions @xmath150 of the optimal rays starting in @xmath140 is convex in @xmath151 , and the same for the set of directions @xmath152 of the optimal rays arriving in @xmath140 , 2 .   [ point_intro_loafpr2 ]",
    "the two sets @xmath153 , @xmath154 coincide , 3 .",
    "[ point_intro_loafpr3 ] there are points @xmath155 , @xmath156 such that @xmath157 and points ( [ point_intro_loafpr1]-[point_intro_loafpr2 ] ) hold for @xmath155 , @xmath156 too",
    ".    then the sets @xmath158 , @xmath159 are now determined by @xmath160 such a directed locally affine partition will be called _",
    "differential partition_. one can see that the sets @xmath158 are relatively open in their affine hull , and that @xmath159 are extremal faces of @xmath101 . recall that the index @xmath16 denotes the affine dimension of @xmath158 , which coincides with the linear dimension of @xmath159 , while @xmath161 is an index of continuum cardinality .",
    "the second step in the strategy is then to show that the transport problem @xmath162 can be decomposed , via disintegration of measures , into a family of finite cost transport problems on @xmath163 with first marginals which are absolutely continuous w.r.t .",
    "the hausdorff measure @xmath164 on the @xmath16-dimensional set @xmath158 on which they are concentrated . since the definition of `` good points '' , i.e. of the regular transport set @xmath145 , is definitely more complicated than in the strictly convex case , it is perfectly understandable that the proof of the absolute continuity w.r.t . to the hausdorff measure on the @xmath16-dimensional sets @xmath165 of the conditional probabilities of the disintegration of @xmath124 ( and then of @xmath118 )",
    "are considerably more intricate .",
    "the main reference for the approach used in this part is @xcite , where the so - called _ cone approximation property _ introduced in @xcite ( with the terminology used in @xcite ) was first generalized to partitions into higher dimensional sets , showing the absolute continuity property for the conditional probabilities of the disintegration of the surface measure on the graph of a convex function w.r.t .",
    "the partition induced by the relative interior of the extremal faces .",
    "in particular , in section [ s_disintechnique ] it is shown that the differential partition satisfies both the _ forward _ and the _ backward cone approximation property _ , namely the cone approximation property holds both for the optimal rays starting at a point @xmath140 and for the points arriving at @xmath140 , thus giving that the conditional measures of @xmath124 are indeed equivalent to the @xmath16-dimensional hausdorff measure on the set on which they are concentrated .    as for the proof of the @xmath124-negligibility of the set @xmath166 , since for general convex norms",
    "the extremal faces may be more than the exposed ones , it is not possible to use the same reasoning as in the strictly convex case .",
    "however , we will show that the set @xmath166 is made of _ initial / final points _ for two other partitions ( the _ super / subdifferential partitions _ introduced in [ ss_regu_resi_set ] ) , which satisfy the ( initial / final ) _ forward / backward cone approximation property_. hence , the same disintegration technique used in @xcite permits to show that they are @xmath167-negligible ( see theorem [ t_fc_no_initial ] ) .    denoting with @xmath106 the projection of the differential partition @xmath168 on @xmath4 , in section [ s_theorem_1_proof ] we deduce the following theorem .",
    "the statement includes also the points which do not belong to any optimal ray , and in that case the dimension @xmath16 of the elements of the directed locally affine partition they belong to , is @xmath169 , as well as @xmath170 . since we will often write the graph of a directed locally affine partition @xmath14 as @xmath171 we will use also the notation @xmath172 notice that for costs @xmath173 of the form , one has clearly @xmath174 , since the only values of @xmath173 are @xmath175 , @xmath176 .",
    "[ t_1 ] let @xmath177 with @xmath19 and let @xmath0 be a convex norm in @xmath4 .",
    "then there exists a locally affine directed partition @xmath178 in @xmath4 with the following properties :    1 .",
    "[ point_1_t_1 ] for all @xmath161 the cone @xmath108 is a @xmath16-dimensional extremal face of @xmath0 ; 2 .",
    "[ point_2_t_1 ] @xmath179 ; 3 .",
    "[ point_3_t_1 ] the disintegration of @xmath5 w.r.t .",
    "the partition @xmath180 , @xmath181 , satisfies @xmath182 4 .",
    "[ point_4_t_1 ] for all @xmath183 , the disintegration @xmath184 w.r.t .",
    "the partition @xmath185 satisfies @xmath186 where @xmath187 is the disintegration w.r.t .",
    "the partition @xmath180 , and moreover @xmath188    if also @xmath189 , then for all @xmath190 @xmath191 where @xmath192 is the disintegration w.r.t .",
    "the partition @xmath180 , and the converse of point holds : @xmath193    a locally affine directed partition satisfying point is called _ lebesgue - regular _ ( see definition [ d_disint_regular ] ) .",
    "this concludes the first part of the paper .",
    "a remark is in order here : in point , the conditional second marginals @xmath194 are independent on the potential @xmath61 but _ depend _ on the particular transference plan @xmath36 which we are decomposing .",
    "this can be seen with elementary examples ( see example [ ex_2ndmarg ] in section [ ss_partitions_intro ] ) . from now on the analysis will be done in a class of transference plans which have the same conditional second marginals : in fact , we will see in a moment that the partition of theorem [ t_1 ] needs to be refined and by inspection one sees that such refinement changes when changing the conditional marginals .",
    "we will consider then nonempty subsets of the optimal plans of the form @xmath195 that is equivalent to fix a transport plan of finite @xmath196-cost @xmath197 and consider all transport plans @xmath198",
    ".    in the strictly convex case , theorem [ t_1 ] has been proven in @xcite . there",
    "the dimensions of the sets of the locally affine partition is equal to one , and it is classical and fairly easy to see that the optimal transportation problems @xmath199 where @xmath200 have a solution induced by a map @xmath201 . more precisely , one shows that any @xmath202-cyclically monotone transference plan is induced by a unique transport map @xmath94 .",
    "since the dependence of the maps @xmath94 on @xmath148 is @xmath203-measurable , the map @xmath204 is an optimal map for .",
    "actually , @xmath9 is the unique optimal transport map relative to the cost @xmath205    in the general convex case , the analogous way to solve would be to prove that the optimal transportation problems on the sets of the partition of theorem [ t_1 ] @xmath206 where @xmath207 have a solution induced by a map @xmath208 whose graph is the support of any @xmath209-cyclically monotone transference plan , and then to glue together the maps @xmath210 .",
    "this fact would be true , by classical results in optimal transportation , if there existed a pair of optimal potentials @xmath211 , @xmath212 for the cost @xmath213 .",
    "recall that , for a cost @xmath80 $ ] , one calls optimal potentials a pair of functions @xmath214 , @xmath61 s.t .",
    "@xmath215 recall also that , if @xmath216 is a carriage for @xmath36 and @xmath217 , then @xmath218 yield a pair @xmath214 , @xmath61 of optimal potentials provided @xmath214 is @xmath2-a.e .",
    "when @xmath173 is a convex norm , then @xmath219 is a kantorovich potential .    indeed , by formula , if @xmath220 optimal potentials w.r.t .",
    "@xmath213 then there exist also @xmath221 , @xmath222 optimal potentials for @xmath209 and it is then classical to show that any @xmath209-cyclically monotone transference plan is unique and induced by an optimal map @xmath223 .",
    "however , as shown in @xcite , in general the transport problem in @xmath224 on @xmath107 with cost @xmath213 does not have a potential @xmath211 ( see the final example of @xcite ) , thus the directed locally affine partition of theorem [ t_1 ] is not refined enough to give immediately the existence of transport maps in each of the sets @xmath225 .",
    "another approach that has been used at this point to show the existence of an optimal map assuming the existence of a directed locally affine partition is the one adopted in @xcite , which though uses techniques similar to @xcite , and then is not really simplifying the problem in the spirit of sudakov s strategy .    what we show in the second part of the paper , more precisely in section [ s_cfibr_cfol ] ,",
    "is that the directed locally affine partition of theorem [ t_1 ] can be refined into another directed locally affine partition @xmath226 such that , given a carriage of any @xmath209-cyclically monotone transference plan , a pair of optimal potentials @xmath227 , @xmath228 can be constructed on each of its elements @xmath229 .    in order to explain what we mean by a `` refinement '' of the partition of theorem [ t_1 ] ,",
    "referring to section [ ss_linear_pre_unique_transf ] for wider motivations and more precise statements , let us consider formula .",
    "the sequence of points @xmath230 is an _ axial path _ , and we say that the axial path is a _ @xmath231-axial path _ if @xmath232 for all couples @xmath42 in the axial path : since we can assume that @xmath233 , this condition is equivalent to @xmath234 .",
    "it is a well know fact that if @xmath2-a.a",
    ". points belong to an axial path starting from and ending in @xmath235 ( which will be called a _ @xmath236-cycle _ ) , then formula yields a @xmath2-a.e",
    ". finite potential @xmath214 .",
    "its dual @xmath61 turns out then to be finite and independent on @xmath62 for @xmath3-a.e . @xmath237 .",
    "it becomes then natural to ask for a directed locally affine partition @xmath14 that , in addition to , , and of theorem [ t_1 ] for all @xmath238 , it satisfies the following property . for all carriages @xmath239 s.t .",
    "@xmath240 for some @xmath238 , the sets @xmath107 are contained in a @xmath241-cycle up to a @xmath242-negligible set ( eventually depending on @xmath243 ) : the cost in each @xmath107 is the _ cone cost _ given by @xmath244 .    this cyclical connectedness condition is called in this paper _ @xmath245-cyclical connectedness _ ( see definition [ d_pimunuconn ] ) and , as discussed above , when verified it guarantees the existence of optimal potentials .",
    "the second main result of this paper claims the existence of such a partition .",
    "the fact that it is a refinement of an already existing locally affine partition , such as the one of theorem [ t_1 ] , namely that each of its sets is contained in some @xmath107 and the corresponding cone of directions is an extremal face of the cone @xmath17 , is expressed by saying that it is a _ subpartition _ of @xmath246 ( see definition [ d_dir_subpart ] ) .",
    "recall definition [ d_disint_regular ] of lebesgue - regular partition .",
    "[ t_subpart_final ] let @xmath247 be a _",
    "lebesgue - regular _ directed locally affine partition in @xmath4 and let @xmath248 , @xmath249 such that @xmath250 .",
    "then , for all @xmath251 there exists a directed locally affine subpartition @xmath226 of @xmath247 , up to a @xmath2-negligible set @xmath252 , such that @xmath253 and if @xmath254 , where @xmath255 is the conditional probability on the partition @xmath256 , then each set @xmath229 is @xmath257-cyclically connected , for all @xmath258 , @xmath259 .",
    "applying theorem [ t_subpart_final ] to the directed locally affine partition given by theorem [ t_1 ] , one obtains immediately the following result . as in the case of theorem [ t_1 ] ,",
    "the second part of point of the next theorem is a consequence of the precise analysis of the regions where the mass transport occurs .",
    "[ t_final ] let @xmath260 with @xmath248 and let @xmath0 be a convex norm in @xmath4 .",
    "then , for all @xmath261 there exists a locally affine directed partition @xmath262 in @xmath4 with the following properties :    1 .   for all @xmath161 the cone @xmath263 is a @xmath16-dimensional extremal face of @xmath0 ; 2 .",
    "@xmath264 ; 3 .",
    "the partition is _ lebesgue - regular _ ; 4 .   [ point_4_t_final ] the disintegration @xmath265 w.r.t .",
    "the partition @xmath266 satisfies @xmath267 where @xmath268 is the disintegration w.r.t .",
    "the partition @xmath269 , and moreover @xmath270 5 .",
    "the partition @xmath269 is @xmath271-cyclically connected .",
    "[ r_remark_str_conv ] we note that the elements of the locally affine partition @xmath272 given by the above theorem have maximal linear dimension @xmath273 in particular , if @xmath23 is strictly convex , the locally affine decomposition is made only of directed rays , and one recovers the results of @xcite for strictly convex norms .    in the case",
    "@xmath189 , the decomposition does not depends on the transference plan , as in the strictly convex case .",
    "in particular , we can say that it is universal , i.e. it is independent on the particular transference plan @xmath274 used .",
    "[ t_final_nu ] assume that @xmath71 .",
    "then the directed locally affine partition of theorem [ t_final ] satisfies the following properties :    1 .   for all @xmath161 the cone @xmath263",
    "is a @xmath16-dimensional extremal face of @xmath0 ; 2 .",
    "@xmath275 ; 3 .",
    "the partition is _ lebesgue - regular _ ; 4 .   for all @xmath276 , the disintegration @xmath265 w.r.t .",
    "the partition @xmath266 satisfies @xmath277 where @xmath268 , @xmath278 are the disintegration of @xmath2 , @xmath3 w.r.t . the partition @xmath269 ; 5 .   @xmath269 is @xmath279-cyclically connected .    in particular @xmath280 .",
    "the main step in the proof of theorem [ t_subpart_final ] is the following    [ t_subpart_step ] let @xmath247 be a lebesgue - regular directed locally affine partition in @xmath4 and let @xmath2 , @xmath3 be probability measures in @xmath281 such that @xmath248 and @xmath250 .",
    "then , for all fixed @xmath282 , there exists a directed locally affine subpartition @xmath283 of @xmath247 , up to a @xmath2-negligible set @xmath284 , such that @xmath285 and setting @xmath286 , where @xmath287 is the conditional probability on the partition @xmath288 , then the sets @xmath289 form a @xmath290-cyclically connected partition .",
    "theorem [ t_subpart_step ] allows to construct a locally directed affine subpartition @xmath283 to a directed locally affine partition @xmath247 such that the sets which do not lower their affine dimensions ( i.e. for which @xmath291 and @xmath292 ) are @xmath293-cyclically connected .",
    "since the subpartition @xmath294 is a lebesgue - regular directed locally affine partition , and as a subpartition of @xmath14 the index @xmath258 is decreasing of at least @xmath12 in each @xmath107 , by a finite iterative argument one immediately obtains theorem [ t_subpart_final ] .",
    "the proof of theorem [ t_subpart_step ] relies on nonstandard tools in measure theory namely , the sufficient condition for uniqueness / optimality of transference plans based on the existence of suitable borel linear preorders given in @xcite and on the existence of lebesgue - regular directed locally affine partitions for one parameter families of graphs of lipschitz functions w.r.t .",
    "convex norms ( called _ @xmath146-lipschitz foliations _ ) , whose construction generalizes the one of the differential partition of theorem [ t_1 ] .    we give now a brief scheme of the main steps of the proof of theorem [ t_subpart_step ] .",
    "then , we will go on stating its consequences , ending with the solution of monge s problem in theorem [ t_monge_final ] .",
    "first of all , one can reduce to study the finite cost transportation problem on directed locally affine partitions with fixed dimension @xmath16 and whose cones of directions are close to a given one , called _",
    "@xmath16-directed sheaf sets _",
    "( see section [ ss_mapping_sheaf_to_fibration ] , definition [ d_sheaf_set ] ) .",
    "moreover , by a change of variables which preserves the characteristics of the optimal transportation problem @xmath295 , one can assume that the sets @xmath107 of the sheaf set are contained in distinct parallel planes , thus studying the so called _ @xmath16-directed fibrations _ with cones of directions @xmath296 ( see definition [ d_fibration ] ) .",
    "@xmath297 is the cone of directions of the region @xmath107 .",
    "to give an idea of how the subpartition is constructed , in this introduction we assume that @xmath298 , so that the finite cost transportation problem on such @xmath299-directed fibration is a finite transportation problem for a single @xmath16-dimensional cone cost in @xmath300 . in the paper ,",
    "the variable @xmath301 plays the role of a parameter and is kept in all the constructions and definitions in order to show that the sufficient measurability conditions w.r.t .",
    "@xmath148 , which are needed in order to define global objects , are satisfied .    by the discussion made before theorem [ t_subpart_final ] ,",
    "it is natural to fix a carriage @xmath302 of some @xmath303 and to see whether the partition of @xmath300 into @xmath241-cycles satisfies our requirements .",
    "it turns out that in general this is not true , the first main reason being that not all the other transport plans are necessarily concentrated on its sets .",
    "however as proven for general cost functions @xmath173 in @xcite in order to give very general sufficient conditions for uniqueness / optimality of transport plans a partition on which all the transport plans @xmath304 are concentrated exists provided one can find a borel linear preorder ( i.e. , a transitive relation such that every two points can be compared ) which contains the set @xmath305 ( i.e , it is _",
    "@xmath213-compatible _ according to definition [ d_compatible ] ) and extends the linear preorder @xmath306 whose equivalence classes are the @xmath307-cycles ( i.e. , @xmath308 if there is a @xmath241-axial path of finite cost connecting @xmath309 to @xmath62 ) .    in section [ ss_gamma_order ] , theorem [ t_order_gamma ] , we show how to construct such a preorder . the preorder will be denoted in the following by @xmath310 , where @xmath311 is related to the countable procedure to construct the borel preorder ( see section [ s_cfibr_cfol ] ) .",
    "its equivalence classes turn out to be either families of graphs of @xmath312-lipschitz functions @xmath313 being @xmath314 or @xmath16-dimensional equivalence classes .",
    "such families of sets are called @xmath315-lipschitz foliations and are studied in section [ s_foliations ] . in particular , the finite cost transportation problem w.r.t .",
    "@xmath213 in @xmath300 reduces to a family of finite cost transportation problems w.r.t .",
    "@xmath213 on the sets of this @xmath316-lipschitz foliation .",
    "the equivalence classes @xmath317 which do not lower the affine dimension of the @xmath107 are connected by @xmath307-cycles , up to a @xmath2-negligible set , and then in principle they are candidate to be the @xmath16-dimensional sets of theorem [ t_subpart_step ] .",
    "however , they are not necessarily connected by @xmath318-cycles for the other carriages @xmath319 of plans in @xmath320 .",
    "in fact , changing @xmath243 , the borel preorder @xmath310 also varies .",
    "hence we need to use an abstract result on measure theory @xcite ( recalled here in appendix [ a_minimal_equivalence ] ) , assuring that there is a minimal borel linear preorder among the ones of the type @xmath310 : for this one , the sets which do not lower the dimension of the @xmath107 and are of positive @xmath242-measure are @xmath320-cyclically connected ( see theorem [ t_cfibrcfol ] ) .",
    "notice that this @xmath320-cyclically connectedness property can be indeed interpreted as a minimality or `` indecomposability '' property of the new @xmath16-dimensional sets .",
    "as for the finite cost transportation problem for the cost @xmath213 on the classes of the minimal equivalence relation which are graphs of @xmath312-lipschitz functions @xmath321 , one uses the same tools as in the proof of theorem [ t_1 ] to show the existence of a _ differential _ locally affine partition @xmath322 on which the transportation problem decomposes ( see section [ s_foliations ] ) .",
    "indeed , the sets of such partition which are contained in @xmath323 are constructed as the sets of the differential partition for the kantorovich potential @xmath61 : the only difference now is that one has to take care of the measurability of these sets w.r.t .",
    "the parameters @xmath324 .",
    "the only missing point in the proof that the union of the differential partition and of the @xmath16-dimensional equivalence classes @xmath325 satisfies the conclusions of theorem [ t_subpart_step ] is then the lebesgue - regularity .",
    "notice that now the directed locally affine partition is obtained applying the same reasoning as in theorem [ t_1 ] but for a family of norm - lipschitz graphs depending on a continuous parameter .",
    "hence one would be tempted to deduce the lebesgue - regularity property first disintegrating the lebesgue measure @xmath326 on such graphs and then using the cone approximation property ( as for the kantorovich potential ) for each conditional measure of @xmath326 on a single graph . however , as we will show in a counterexample ( see remark [ r_not_gener_potential ] ) , this is not possible because in general the conditional measures of @xmath326 on a family of lipschitz graphs might to be absolutely continuous w.r.t .",
    "the @xmath327-dimensional hausdorff measure on the graphs on which they are concentrated .",
    "in fact , the lebesgue - regularity property for the sets @xmath325 follows by the fact that the lipschitz graphs of @xmath328 are the equivalence classes of a @xmath213-compatible borel linear preorder on which all the transport plans in @xmath320 are concentrated . indeed , by the uniqueness theorem stated in @xcite one can prove the cone approximation property for the subpartition .",
    "the procedure is similar to the procedure followed in the case a single potential @xmath61 is present : however , the convergence of the cone approximating vector fields is now due to the uniqueness of a suitable transference plan ( see section [ s_cone_approx_folia ] ) .    as discussed before , theorem [ t_final ] gives as an application the possibility to construct optimal potentials w.r.t .",
    "secondary cost functions such as @xmath329 on each set of the partition @xmath330 . in the case in which the secondary cost function is obtained by minimizing the original transport problem w.r.t .",
    "another convex norm @xmath331 , one obtains a refinement of the directed locally affine partition of theorem [ t_final ] with cones of directions given by intersections of extremal faces of @xmath331 and @xmath0 .",
    "more precisely , let @xmath331 be a convex norm with unit ball @xmath332 , and consider the secondary minimization problem @xmath333 if @xmath38 is a minimizer of the above problem , by the fact that @xmath38 is also a minimizer of @xmath334 and that each @xmath330 is @xmath335-cyclically connected , proposition [ p_second_cost ] yields that in each @xmath336 there exists a potential pair @xmath211 , @xmath212 , and since @xmath337 satisfies the triangle inequality we can take @xmath338 . by the existence of such a potential , restricting then to a single set @xmath336 one can prove as in the proof of theorem [ t_1 ] the existence of a directed locally affine partition @xmath339 . in the resulting statement one has to replace the ambient space @xmath4 with @xmath330 , the measure @xmath5 with @xmath340 , the marginals @xmath2 , @xmath3 with @xmath242 , @xmath341 and the cost @xmath0 with @xmath342    more precisely , we obtain the following theorem .",
    "[ t_final_seconry ] let @xmath260 with @xmath248 and let @xmath38 be an optimal transport plan for the problem .",
    "then there exists a locally affine directed partition @xmath343 in @xmath4 with the following properties :    1 .   for all @xmath16 , @xmath161",
    ", the cone @xmath344 is an @xmath258-dimensional extremal face of the cost @xmath345 given by , i.e. the intersection of a @xmath16-dimensional face of @xmath0 with an extremal face of @xmath331 ; 2 .",
    "@xmath346 ; 3 .",
    "the partition is _ lebesgue - regular _ ; 4 .",
    "the disintegration @xmath347 w.r.t .",
    "the partition @xmath348 satisfies @xmath349 where @xmath350 is the disintegration w.r.t .",
    "the partition @xmath351 , and moreover @xmath352 5 .",
    "the partition @xmath351 is @xmath353-cyclically connected .",
    "a completely similar extension can be given to theorem [ t_final_nu ] .",
    "a particular case is when each extremal face of @xmath331 is contained in an extremal face of @xmath354 : in this case condition ( 1 ) becomes    1 .",
    "[ point_1_prime ] _ for all @xmath16 , @xmath161 , the cone @xmath344 is an @xmath258-dimensional extremal face of @xmath331 . _    the only difference w.r.t .",
    "theorem [ t_final ] is that now @xmath38 is a minimum for the secondary minimization problem , not a transference plan in @xmath355 .",
    "the case ( 1 ) above happens if for example @xmath331 is strictly convex , so that the @xmath356 are now directed segments , i.e. @xmath357 . by the standard analysis on transportation problems in 1-d , and the measurable dependence on @xmath16 , @xmath148 , @xmath259 , the existence of an optimal transport map @xmath9 for the monge problem follows as a simple corollary . in particular , the restriction @xmath358 is a monotone increasing map in the direction of @xmath359 on @xmath360 , for all @xmath16 , @xmath148 , @xmath259 .    [ t_monge_final ]",
    "let @xmath361 , @xmath248 .",
    "then , there exists an optimal transport map @xmath9 for the monge problem .",
    "the paper is organized as follows .    in section [ s_setting ]",
    "we collect the main notations , definitions and the basic tools we will need in the paper . after recalling some standard definitions of commonly used sets and @xmath362-algebras , we introduce some notations for functions and multifunctions in section [ ss_souslin_multifunction ] .",
    "the basic tools in convex analysis as well as the definitions of the polish spaces @xmath363 made of @xmath16-dimensional affine subspaces of the affine space @xmath364 and the polish space @xmath365 made of non degenerate @xmath16-dimensional cones of a vector space @xmath364 are listed in section [ ss_intro_affine_subspaces_cones ] .",
    "+ the fundamental tools on measure theory and the disintegration theorem are recalled in section [ ss_measure_disintegration ] , while the definition of the optimal transportation problem with the classical sufficient conditions for optimality of transference plans are listed in section [ ss_transference_plans ] . the key analysis on transportation problems for which no potential is available and the role of borel linear preorders",
    "is presented in section [ ss_linear_pre_unique_transf ] . in particular , we define @xmath366-cyclically connected partitions ( see definition [ d_pimunuconn ] ) , we state proposition [ p_second_cost ] yielding the existence of a family of potentials on the elements of a partition for secondary costs under the assumption of @xmath366-cyclical connectedness , and we show in theorem [ t_a2 ] @xcite that whenever a borel linear preorder is @xmath173-compatible and extends a @xmath367-preorder , then all the transport plans are concentrated on its equivalence classes .    in section [ s_conetransport ]",
    "we analyze the optimal transportation for cone costs of the form . in section [ ss_convex_norm_cone ]",
    "we show the equivalence between optimal transportation problems in @xmath4 with cost @xmath0 and marginals @xmath18 and optimal transportation problems in @xmath116 with cost @xmath368 and marginals @xmath369 , where the measures @xmath370 , @xmath371 are supported on a @xmath0-lipschitz graph @xmath120 and @xmath372 , @xmath373 . + in section [ ss_partitions_intro ]",
    "we generalize the single cone cost transportation problem to the transportation problem on a directed locally affine partition . here",
    "we introduce also the notion of initial and final points of a directed locally affine partition and the notion of conditional second marginals , as well as an example of their dependence w.r.t .",
    "the transference plan ( example [ ex_2ndmarg ] ) and a special case where the conditional second marginals correspond to the disintegration of @xmath3 ( proposition [ p_dispiani_2 ] ) . + a standard covering argument allows to decompose a directed locally affine partition into @xmath16-directed _ sheaf sets _ , i.e. directed locally affine partitions whose components @xmath107 and cones @xmath17 are close to a given reference plane @xmath374 and cone @xmath375 , and their projection on @xmath374 contains a given open @xmath16-dimensional cube , proposition [ p_countable_partition_in_reference_directed_planes ] and definition [ d_sheaf_set ] .",
    "this allows to map these sets into _ directed fibrations _",
    ", where the @xmath107 are contained in the planes @xmath376 , @xmath377 ( proposition [ p_map_sheaf_set_into_fibration ] ) .",
    "in this case the transport problem splits into a family of transport problems , each one moving mass on a plane of the form @xmath376 and with cost @xmath378 where @xmath379 a @xmath362-compact map with values in @xmath380 : since @xmath16 is fixed on a fibration , we can skip it in order to simplify the notation .",
    "+ the final part of the section shows that the mapping of a sheaf set into a fibration preserves the key structures of the optimal transportation problem needed in the proofs of theorems [ t_1 ] and [ t_subpart_final ] , and thus allows us to work from now onwards on fibrations .",
    "in section [ s_foliations ] we present a technique in order to find the so called _ differential _ directed locally affine subpartition of a given _ @xmath146-lipschitz foliation _ of a @xmath381-directed fibration .",
    "the reason why we introduce and study @xmath146-lipschitz foliations is that they are the natural generalization of the notions of graphs of cone - lipschitz functions as the kantorovich potential @xmath61 and equivalence classes of a @xmath213-compatible borel linear preorder ( see proposition [ p_ex_fol ] ) . for the terminology used to briefly list the content of this section we refer also to the discussion made in this introduction at the beginning of section [ ss_main_sud ] .",
    "+ due to the results of the previous section , when the differential subpartition is mapped back from the @xmath146-lipschitz foliation to the @xmath16-directed sheaf set , one obtains subpartitions of the sheaf sets covering a given directed locally affine partition , and thus we have a method which yields a subpartition of a given directed locally affine partition . + in section [ ss_cone_lipschitz_graph ] we first analyze the simplest example of @xmath146-lipschitz foliation : a _ @xmath382-lipschitz graph _ , namely a graph of a @xmath312-lipschitz function ( with @xmath383 ) in a fibration consisting of a single fiber @xmath376 , whose _ super / subdifferential _ satisfy the _ completeness property _ - ( as the graph of the kantorovich potential for the cost @xmath368 ) . + in section [ ss_cone_lipschitz ] we consider general @xmath146-lipschitz foliations , namely partitions of @xmath384 whose sets are contained in @xmath385 as @xmath148 varies in @xmath386 and are given by collections of complete @xmath382-lipschitz graphs ( see proposition [ p_fol_char ] ) .",
    "we extend to these families of sets the notion of super / subdifferential ( see definition [ d_partial_theta ] ) and in section [ ss_regu_resi_set ] we show that its completeness and transitivity properties permit to select regions called _ forward / backward regular set _ and _ regular set_. + these regions are respectively partitioned in the so called _ super / subdifferential partition _ and _ differential partition _ in section [ ss_partition_transport_set ] ( see theorem [ t_partition_e+- ] and corollary [ c_v ] ) .",
    "+ in section [ ss_analysis_residual_set ] we analyze the _ residual set _ , namely the complementary of the regular set , and characterize it as the union of the initial / final points of the super / subdifferential partition ( theorem [ t_partition_e ] ) .",
    "+ in section [ ss_optim_folia ] we give a descriptive characterization of the support of the optimal transportation problem on a @xmath146-lipschitz foliation in terms of the forward / backward regular set and initial / final points .",
    "section [ s_disintechnique ] concerns the problem of lebesgue - regularity of the disintegration on directed locally affine partitions .",
    "the main property which allows to deduce the regularity is the _ cone approximation property_. + first we consider @xmath12-directed sheaf sets made of segments whose projection on the line generated by the reference cone is a given interval .",
    "these particular sheaf sets are called _ model sets of directed segments _ ( see section [ ss_model_dir_segm ] ) . in the case of strictly convex norms it is sufficient to analyze this special case .",
    "+ the analysis is then extended to _",
    "@xmath16-dimensional model sets _ , namely @xmath16-directed sheaf sets whose projection on the @xmath16-dimensional plane generated by the reference cone is a given rhomboid ( section [ ss_k_dim_model_set ] ) .",
    "in this case , the _ cone approximation property _ refers to the cone approximation property of any of its @xmath12-dimensional slices , the latter being sections of a @xmath16-dimensional model set with @xmath387-dimensional planes transversal to the reference plane ( see definition [ d_1_dim_slice_sheaf ] ) : by transversality , on each of these planes the @xmath16-dimensional model set becomes a model set of directed segments .",
    "+ next the analysis is extended to @xmath16-dimensional sheaf sets ( section [ ss_k_dim_sheaf ] ) .",
    "the main observation is that one can partition the sheaf set into countably many @xmath16-dimensional model sets ( theorem [ t_one_d_slicing_fc ] ) .",
    "+ finally , the property of approximation by cone vector fields also for initial / final points yields the lebesgue - negligibility of the initial / final points by means of a technique developed first in @xcite , and then extended in @xcite ( see section [ ss_neglig_init_fin ] ) .    at this point all the techniques needed in order to prove theorem [ t_1 ] are presented , and its proof is done in section [ s_theorem_1_proof ] . indeed , in section [ s_foliations ] we develop a technique to find directed locally affine subpartitions by means of @xmath146-lipschitz foliations , and the graph of the potential @xmath61 is in particular a @xmath382-lipschitz graph .",
    "the only point which remains to be proved is that the disintegration of the lebesgue measure is regular , which is a consequence of the cone approximation property .",
    "the section is thus devoted to the proof of the cone approximation property for cone - lipschitz graphs ( theorem [ t_cone_graph ] ) .",
    "let @xmath388 be a directed fibration with the associated transportation problem ; as said before , we assume that @xmath389 . in section [ s_cfibr_cfol ] we show how to further partition @xmath390 into a @xmath391-lipschitz foliation , whose @xmath16-dimensional sets satisfy the assumptions of theorem [ t_subpart_step ] ( see theorem [ t_cfibrcfol ] ) .",
    "the key results are stated in theorem [ t_order_gamma ] and proposition [ p_equiv_coun ] .",
    "the sets of this @xmath391-lipschitz foliation are given by the equivalence classes of a @xmath391-compatible linear preorder on which all the transport plans in @xmath392 are concentrated ( called _ @xmath393-compatible _ linear preorder in definition [ d_cmunucomp ] ) , as anticipated after the statement of theorem [ t_subpart_step ] .",
    "in section [ s_cone_approx_folia ] we prove the cone approximation property for the differential partition of a @xmath146-lipschitz foliation whose sets are given by equivalence classes of a borel @xmath394-compatible linear preorder . since we do not have a potential , we need to use the uniqueness theorem of the linear preorder ( theorem [ t_coneappr_fol ] ) : as a corollary , one immediately obtains the lebesgue - regularity of the disintegration ( corollary [ c_infinnegl ] ) .",
    "+ the section is concluded which an example ( remark [ r_not_gener_potential ] ) which shows that this result can not be deduced as a consequence of the analysis of section [ s_theorem_1_proof ] , even if the level sets of @xmath395 are lipschitz graphs .",
    "in fact , the disintegration of the lebesgue measure on a lipschitz foliation is in general not absolutely continuous w.r.t .",
    "the natural hausdorff measures on the level sets : we show an example where the level sets of the function @xmath396 ^ 2 \\to [ 0,1]$ ] generating the foliation are @xmath397 , nevertheless the disintegration of @xmath398 ^ 2}$ ] on the level sets of @xmath395 have dirac masses .    the proof of theorems [ t_subpart_step ] and [ t_final_nu ] are done in section [ s_proff_main_th ] , and they are obtained as direct consequences of the results proved so far .    finally , in appendix [ a_minimal_equivalence ] we present one of the main result of @xcite about the minimality of equivalence relations and prove a key consequence used in our proof , corollary [ c_constant_for_minimal_equivalence ] .    in appendix [ a_appendix_nota ]",
    "we collect the notations used in this paper .",
    "as standard notation , we will write @xmath399 for the natural numbers , @xmath400 , @xmath401 for the rational numbers and @xmath402 for the real numbers . the sets of positive rational and real numbers will be denoted by @xmath403 and @xmath404 respectively .",
    "the @xmath22-dimensional real vector space will be denoted by @xmath4 .",
    "@xmath405 is the open unit ball in @xmath4 with center @xmath62 and radius @xmath406 and @xmath151 is the @xmath407-dimensional unit sphere .",
    "the scalar product of two vectors @xmath408 will be denoted by @xmath409 , and the euclidean norm of @xmath410 by @xmath411 . to avoid the analysis of different cases when parameters are in @xmath300 for @xmath100 or in @xmath399 , we set @xmath412 .",
    "we denote the first infinite ordinal number by @xmath413 .    given a set @xmath414 , @xmath415 is the power set of @xmath414 .",
    "the closure of a set @xmath79 in a topological space @xmath414 will be denoted by @xmath416 , and its interior by @xmath417 . if @xmath418 , then the relative interior of @xmath79 in @xmath419 is @xmath420 : in general the space @xmath419 will be clear from the context .",
    "the topological boundary of a set @xmath79 will be denoted by @xmath421 , and the relative boundary is @xmath422 .",
    "if @xmath79 , @xmath423 are subsets of a real vector space , we will write @xmath424 if @xmath425 , then we will write @xmath426 in particular @xmath427 .",
    "if @xmath428 is the product space of the spaces @xmath429 , we will denote the projection on the @xmath430-component either as @xmath431 or @xmath432 or @xmath433 : in general no ambiguity will occur .",
    "a multifunction @xmath434 will be considered either as a map @xmath435 or as a set @xmath436 .",
    "the set @xmath437 is called the _",
    "domain _ of @xmath434 . for every @xmath438 we will write @xmath439 the inverse of @xmath434",
    "will be denoted by @xmath440 similarly , if @xmath441 , then @xmath442 .    in the same spirit",
    ", we will often not distinguish between a single valued function @xmath443 and its graph , denoted by @xmath444 .",
    "we say that the function @xmath443 ( or the multifunction @xmath434 ) is _",
    "@xmath362-continuous _ if the set @xmath445 ( or @xmath446 ) is @xmath362-compact .",
    "note that we do not require its domain to be the entire space .    if @xmath443 , @xmath447 are two functions , their composition will be denoted by @xmath448 , with domain @xmath449 . if @xmath450 , @xmath451 , then the product map is denoted by @xmath452 .",
    "the epigraph of a function @xmath453 is the set @xmath454 the identity map will be written as @xmath455 , the characteristic function of a set @xmath79 will be denoted by @xmath456 and the indicator function of a set @xmath79 is defined by @xmath457      for @xmath458 , @xmath459 , define @xmath460 to be the set of @xmath16-dimensional subspaces of @xmath4 and let @xmath461 be the set of @xmath16-dimensional affine subspaces of @xmath4 . if @xmath462 , we define @xmath463 to be the set of @xmath464-dimensional affine subspaces of @xmath465 .",
    "we also denote by @xmath466 the projection map .",
    "if @xmath467 , then define its _ affine span _ as @xmath468 and its convex hull @xmath469 as the set given by the intersection of all convex sets of @xmath4 containing @xmath79 .",
    "given @xmath16 vectors @xmath470 , their linear span @xmath471 is denoted by @xmath472 , and the orthogonal space to @xmath473 is denoted by @xmath474 .",
    "notice that @xmath475 unless @xmath79 consists of a single point .",
    "if we set by convention @xmath476 , then the above formula holds also when @xmath79 is a singleton .",
    "the _ linear dimension _ of an affine subspace @xmath465 is denoted by @xmath477 , and we set accordingly @xmath478 for all @xmath479 .    if @xmath79 is convex , then its relative interior in @xmath480 , denoted by @xmath420 , is nonempty and @xmath481 .",
    "hence we define @xmath482 .",
    "an _ extremal face _ of a convex set @xmath483 is by definition any convex set @xmath484 such that @xmath485\\cap a'\\neq\\emptyset\\quad\\rightarrow\\quad[x , y]\\in a',\\quad \\forall\\,x , y\\in a. \\ ] ]    a convex set @xmath75 is a _ convex cone _ if @xmath486 in particular , @xmath175 is called the _ vertex _ of the convex cone . for all @xmath487 ,",
    "we let @xmath488 to be the set of closed @xmath16-dimensional convex cones in @xmath4 which are _ nondegenerate _ , meaning that @xmath489 for some @xmath16-dimensional half - plane @xmath490 .",
    "the extremal faces of a convex cone are still convex cones called _",
    "extremal cones_.    if @xmath23 is a @xmath22-dimensional compact convex set in @xmath4 and @xmath24 , then one can define the _",
    "( convex ) norm _ ( or _ minkowski functional _ ) @xmath0 generated by @xmath23 as @xmath491 where @xmath492 is the _ convex dual _ to @xmath23 .",
    "equivalently , @xmath493 is identified by the following properties : @xmath494 in particular , since @xmath0 is positively @xmath12-homogeneous , subadditivity can be equivalently replaced by convexity .",
    "[ r_cone_epi ] notice that the set @xmath495 belongs to @xmath496 , with the identification @xmath497 .",
    "viceversa , given a convex cone @xmath498 , if we fix a system of coordinates @xmath499 such that @xmath500 , then @xmath501 is the epigraph of a convex norm on @xmath502 .",
    "we will call _ extremal cones _ of a convex norm @xmath493 either the extremal cones of @xmath495 in @xmath116 or their projections on @xmath4 , being the distinctions between the two cases clear from the context .    for @xmath503",
    "we call @xmath504 the _ set of directions _ of @xmath501 . for @xmath505 we will also write @xmath506    if @xmath503 , @xmath406 , we also define the cone @xmath507 clearly @xmath508 for @xmath509 and @xmath510 . for @xmath511 we also define the cone @xmath512 so that @xmath513 : as before @xmath514 for @xmath509 . more generally , for @xmath503 we will use the notation @xmath515    by convention we set @xmath516 and we will often denote a convex cone @xmath501 as @xmath517 to emphasize its dimension .    on @xmath460 , @xmath461 and @xmath488",
    "we consider the topology given by the hausdorff distance @xmath518 in every closed ball @xmath519 of @xmath4 , i.e. @xmath520 for two generic elements @xmath79 , @xmath423 .",
    "if @xmath521 , its spherical convex envelope is defined as @xmath522      we will denote the lebesgue measure on @xmath4 by @xmath523 , and the @xmath16-dimensional hausdorff measure on @xmath462 as @xmath524 . in general , the restriction of a function / measure to a set @xmath525 will be denoted by the symbol @xmath526 ( or sometimes @xmath527 ) following the function / measure .",
    "the product of two locally finite borel measures @xmath528 , @xmath529 will be denoted by @xmath530 .",
    "the lebesgue points @xmath531 of a set @xmath467 are the points @xmath532 such that @xmath533 if @xmath534 is a locally bounded borel measure on @xmath4 , we will write @xmath535 if @xmath534 is _ absolutely continuous _ ( a.c . for brevity ) w.r.t . @xmath523 .    for a generic _ polish space _ @xmath414 ( i.e. , a separable and complete metric space ) , the borel sets and the set of borel probability measures will be respectively denoted by @xmath536 and @xmath537 .",
    "the _ souslin sets @xmath538 _ of a polish space @xmath414 are the projections on @xmath414 of the borel sets of @xmath539 .",
    "the @xmath362-algebra generated by the souslin sets will be denoted by @xmath540 .",
    "two radon measures @xmath528 , @xmath529 on @xmath414 are _ equivalent _ if for all @xmath541 @xmath542 and we denote this property by @xmath543 .",
    "if @xmath534 is a measure on a measurable space @xmath414 and @xmath544 is an @xmath534-measurable map , then the _ push - forward of @xmath534 _ by @xmath443 is the measure @xmath545 on @xmath419 defined by @xmath546    finally we briefly recall the concept of disintegration of a measure over a partition .",
    "[ d_part ] a _ partition _ in @xmath4 is a family @xmath547 of disjoint subsets of @xmath4 .",
    "we say that @xmath547 is a _ borel partition _",
    "if @xmath386 is a polish space , @xmath548 is borel and the _ quotient map _ @xmath549 , @xmath550 such that @xmath551 , is borel - measurable .",
    "we say that @xmath547 is _",
    "@xmath362-compact _ if @xmath552 for some @xmath553 , @xmath554 is @xmath362-compact and @xmath555 is @xmath362-continuous .",
    "the sets in the @xmath362-algebra @xmath556 are also called in the literature _ saturated sets_. notice that we do not require @xmath547 to be a covering of @xmath4 .",
    "[ d_dis ] given a borel partition in @xmath4 into sets @xmath13 with quotient map @xmath557 and a probability measure @xmath558 s.t .",
    "@xmath559 , a _ disintegration _ of @xmath534 w.r.t .",
    "@xmath13 is a family of probability measures @xmath560 such that @xmath561    as proven in appendix a of @xcite ( for a more comprehensive analysis see @xcite ) , we have the following theorem .    [ t_disint ] under the assumptions of definition [ d_dis ] , the disintegration @xmath562 is _ unique _ and _ strongly consistent",
    "_ , namely @xmath563    the measures @xmath562 are also called _ conditional probabilities_.    to denote the ( strongly consistent ) disintegration @xmath562 of a probability measure @xmath564 on a borel partition @xmath13 we will often use the formal notation @xmath565 with @xmath566 , @xmath555 being the quotient map .    since the conditional probabilities @xmath567 are defined @xmath203-a.e .",
    ", many properties ( such as @xmath568 ) should be considered as valid only for @xmath203-a.e .",
    "@xmath569 : for shortness , we will often consider the @xmath570 redefined on @xmath203-negligible sets in order to have statements valid @xmath571 .",
    "we also point out the fact that , according to definition [ d_dis ] , in order that a disintegration of @xmath534 over a partition can be defined , @xmath534 has to be concentrated on the union of the sets of the partition ( which do not necessarily cover the whole @xmath4 ) . in general ,",
    "if we remove this assumption , since the formulas - make sense nonetheless for @xmath572 , by means of formula we `` reconstruct '' only @xmath573 .",
    "let @xmath574 , @xmath575 such that @xmath576 then , one can define the probability measure @xmath577 on @xmath4 by @xmath578 the measure defined in will be denoted as @xmath579 notice that , despite the notation is the same as in , the family @xmath580 in the above definition is not necessarily a disintegration of @xmath577 , both because the measure @xmath581 is not necessarily a quotient measure of a borel partition and because the measures @xmath582 are not necessarily concentrated on the sets of a partition . in the rest of the paper , such an ambiguity will not occur , since we will always point out whether a measurable family of probability measures is generated by a disintegration or not .",
    "[ r_disint_lebesgue ] if instead of @xmath558 we consider the lebesgue measure @xmath523 ( more generally , a radon measure ) a disintegration @xmath583 is to be considered in the following sense .",
    "first choose a partition @xmath584 of @xmath4 into sets with unit lebesgue measure , then let @xmath585 be the standard disintegration of the probability measure @xmath586 , and finally @xmath587 clearly , in this definition the `` conditional probabilities '' @xmath588 and the `` image measure '' @xmath589 depend on the choice of the sets @xmath584 .",
    "for a generic polish space @xmath414 , measures @xmath590 and borel _ cost function _ @xmath591",
    "$ ] , we will consider the sets of probability measures @xmath592 @xmath593 @xmath594 the elements of the set defined in are called _ transference _ or _ transport plans _",
    "between @xmath2 and @xmath3 , those in _",
    "transference _ or _ transport plans with finite cost _ and the set defined in is the set of _ optimal plans_. the quantity @xmath595 is the _ transportation cost_.    in the following we will always consider costs and measures s.t .",
    "@xmath596 , thus @xmath597 .    the problem of showing that @xmath598 is called monge - kantorovich problem .",
    "we recall ( see e.g. @xcite ) that any optimal plan @xmath599 is _ @xmath173-cyclically monotone _ , i.e. there exists a @xmath362-compact _ carriage _ @xmath600 such that @xmath240 and for all @xmath601 , @xmath602 , @xmath603 where we set @xmath604 .",
    "any such @xmath243 is called _",
    "@xmath173-cyclically monotone carriage_. however , in order to deduce the optimality of a transference plan the @xmath173-cyclical monotonicity condition itself is not sufficient and one has to impose additional conditions . most of the conditions in the literature exploit the dual formulation of monge - kantorovich problem ( see @xcite ) , namely @xmath605 for example ( see lemma 5.3 of @xcite ) if there exists a pair of functions @xmath606 then @xmath607 are optimizers for the dual problem and @xmath599 .",
    "conditions on the cost guaranteeing the existence of such potentials ( and indeed of more regular ones ) are e.g. the following ones :    1 .",
    "[ point_boun_fg ] @xmath173 is l.s.c . and",
    "satisfies @xmath608 for some @xmath609 , @xmath610 ( @xcite ) ; 2 .",
    "@xmath173 is real - valued and satisfies the following assumption ( @xcite ) @xmath611 3 .",
    "@xmath612 is an open set @xmath613 minus a @xmath614-negligible set @xmath615 ( @xcite ) .    the weakest sufficient condition for optimality , which does not rely on the existence of global potentials and implies the results recalled above , has been given in @xcite . since such condition will be needed and of fundamental importance for the proofs of our main results ( in particular , theorem [ t_subpart_step ] ) , in the next section we give a brief explanation of the approach followed in @xcite and we state it in a form which will be more convenient for our purposes .",
    "let @xmath616 $ ] be a borel cost function on a polish space @xmath414 such that @xmath617 for all @xmath618 , let @xmath2 , @xmath619 be such that @xmath620 and let @xmath621 be a @xmath173-cyclically monotone carriage of some @xmath622 satisfying w.l.o.g .",
    "a standard formula for constructing a pair of optimal potentials is the following : for fixed @xmath217 and @xmath624 , define @xmath625 if one of the assumptions @xmath626-@xmath627 holds , then this @xmath214 , @xmath61 satisfy - .",
    "however , for general borel costs @xmath173 , the assumptions @xmath626-@xmath627 are not satisfied .",
    "in particular , for any choice of @xmath235 , there may be a set of positive @xmath2-measure on which @xmath214 is not well defined ( namely , the infimum in is taken over an empty set ) or takes the value @xmath628 ( see the examples in @xcite ) .    to explain why this can happen and briefly recall the strategy adopted in @xcite to overcome this problem in a more general setting , we need the following definition .    [ d_axpath ] an _ axial path with base points @xmath629 _ , @xmath630 , starting at @xmath631 and ending at @xmath632 is the sequence of points @xmath633 we will say that the axial path",
    "_ goes from _",
    "@xmath62 to @xmath632 : note that @xmath634 . a _ closed axial path _ or _",
    "cycle _ is an axial path with base points in @xmath243 such that @xmath635 .",
    "a _ @xmath236-axial path _ is an axial path with base points in @xmath243 whose points are contained in @xmath636 and a _",
    "@xmath231-cycle _ is a closed @xmath236-axial path .",
    "notice that , in order that is well defined , for @xmath2-a.e .",
    "point @xmath637 there must be a @xmath231-axial path going from @xmath638 to @xmath62 .",
    "moreover , being @xmath243 @xmath173-cyclically monotone , @xmath214 is surely finite valued in the case in which for @xmath2-a.e .",
    "point @xmath639 there exists also a @xmath231-axial path going from @xmath62 to @xmath638 ( and thus to a.a . any other point in @xmath243 ) . in particular ,",
    "@xmath62 and @xmath638 are connected by a @xmath231-cycle .    the first idea in @xcite",
    "is then to partition @xmath414 into the equivalence classes @xmath640 induced by the @xmath231-cycle equivalence relation and disintegrate @xmath2 , @xmath3 over @xmath640 and @xmath36 over @xmath641 .",
    "since @xmath642 @xmath643 and @xmath644 , then @xmath624 implies that @xmath62 and @xmath309 belong to the same @xmath231-cycle ( consider the path @xmath42 , @xmath645 , @xmath645 , @xmath42 ) and in particular that @xmath646    if the disintegration is strongly consistent ( see theorem [ t_disint ] ) , we get @xmath647 where @xmath648 because there exists at least a plan in @xmath649 in this case @xmath36 such that is satisfied .",
    "notice that the fact that @xmath36 is concentrated on the diagonal equivalence classes @xmath650 , i.e. formula , is equivalent to say that the quotient measure @xmath651 satisfies @xmath652 i.e. it is concentrated on the diagonal of @xmath653 ( see ) .",
    "now , as a consequence of the fact that @xmath654-a.a .",
    "points in @xmath655 can be connected to @xmath654-a.a .",
    "other points in @xmath655 by a @xmath656-cycle and @xmath657 @xmath173-cyclically monotone which is concentrated on @xmath658 , using we are able to construct optimal potentials @xmath659 , @xmath660 for the transportation problem in @xmath661 and conclude that @xmath662    let us then consider another @xmath663 .",
    "after the disintegration w.r.t .",
    "@xmath664 we get @xmath665 with @xmath666    hence one has the following theorem , which gives a sufficient condition for optimality based on behavior of optimal transport plans w.r.t .",
    "disintegration on @xmath231-cycle equivalence relations .",
    "[ t_a1 ] let @xmath243 be a @xmath173-cyclically monotone carriage of a transference plan @xmath667 . if the partition @xmath13 w.r.t .",
    "the @xmath231-cycle equivalence relation satisfies @xmath668 then @xmath36 is an optimal transference plan .    indeed ,",
    "if and are satisfied , then @xmath669 with @xmath670 and one obtains the conclusion by integrating w.r.t . @xmath203 the optimality of the conditional plans @xmath671 , namely @xmath672    the second crucial point in @xcite is then to find weak sufficient conditions such that the assumptions of theorem [ t_a1 ] are satisfied .    before introducing them ,",
    "we show how the request that the sets of a borel partition satisfying coincide with the equivalence classes of the @xmath231-cycle relation can be weakened , yet yielding the possibility of constructing optimal potentials on each class and then , as a corollary , to prove the optimality of a @xmath173-cyclically monotone plan @xmath36 .",
    "first , we need the following    [ def : gccyclconn ] a set @xmath673 is _ @xmath231-cyclically connected _ if @xmath674 there exists a @xmath231-cycle connecting @xmath62 to @xmath309 .",
    "according to the above definition , the equivalence classes of @xmath367 are maximal @xmath231-cyclically connected sets , namely @xmath231-cyclically connected sets which are maximal w.r.t . set inclusion .    then notice that , given a borel partition @xmath675 such that @xmath676 and whose sets are @xmath231-cyclically connected but not necessarily maximal , then it is still possible to define on each of them a pair of optimal potentials and prove the optimality of @xmath36 such that @xmath240",
    ".    moreover , one can weaken this condition by removing a @xmath2-negligible set in the following way .",
    "let @xmath677 , @xmath678 .",
    "[ d_gammaconn ] the partition @xmath679 is _ @xmath680-cyclically connected _ if @xmath681 @xmath2-conegligible s.t .",
    "@xmath682 is @xmath236-cyclically connected @xmath683 .",
    "equivalently , @xmath684 an @xmath581-conegligible set @xmath685 s.t .",
    "@xmath686 @xmath687 , with ",
    "@xmath688 , s.t .",
    "@xmath689 is @xmath236-cyclically connected .    when the @xmath680-cyclically connectedness property holds for all @xmath173-cyclically monotone carriages of all transport plans of finite cost hence it is possible to construct optimal potentials starting from any @xmath173-cyclically monotone @xmath243 we have the following    [ d_pimunuconn ] we say that @xmath690 is _ @xmath649-cyclically connected _ if it is @xmath680-cyclically connected @xmath691 @xmath173-cyclically monotone s.t .",
    "@xmath240 for some @xmath692 .",
    "notice that the @xmath2-conegligible set @xmath130 in the definition of @xmath693-cyclically connected partition depends on the set @xmath243 .    in this paper , in particular for the proof of theorems [ t_final_seconry ] and [ t_monge_final ] , the importance of @xmath649-cyclically connected partitions is given by the following proposition .",
    "[ p_second_cost ] let @xmath694 be a @xmath649-cyclically connected borel partition satisfying @xmath695 for a cost function of the form @xmath696 let @xmath697 $ ] be any _ secondary cost _ of the form @xmath698 where @xmath699 is l.s.c",
    ". and there exist @xmath700 s.t .",
    "then , any @xmath702-cyclically monotone plan @xmath703 is optimal for @xmath702 .",
    "more precisely , for any @xmath702-cyclically monotone set @xmath704 with @xmath705 , there exist borel functions @xmath706 , @xmath707 such that the restrictions @xmath708 are borel optimal potentials for @xmath709 , for all @xmath259 in an @xmath581-conegligible set @xmath710 .",
    "notice that @xmath711 .",
    "let @xmath712 be a @xmath702-cyclically monotone carriage for @xmath713 .",
    "then , there exists a conegligible set @xmath714 such that @xmath715 is @xmath716-cyclically connected for all @xmath717 .",
    "hence , formula , together with the validity of the point at page , yields potentials @xmath718 , @xmath719 for the transport problem in @xmath720 with cost @xmath702 .",
    "in particular , the conditional probability @xmath721 is optimal in @xmath720 , and thus by it follows as in theorem [ t_a1 ] that @xmath722 is optimal in @xmath723 .",
    "the fact that one can find borel functions @xmath724 , @xmath707 such that holds is an application of standard selection principles , and it can be found in @xcite .    in order to state the main result of @xcite which is at the core of their sufficient condition concerning optimality , we need the concept of ( linear ) preorder .",
    "[ d_preorder ] a _ preorder _ on @xmath414 is a set @xmath725 s.t . @xmath726",
    "a preorder @xmath725 is _ linear _ if @xmath727    the statement @xmath728 will also be denoted by @xmath729 and @xmath79 is also called the _ graph of the ( linear ) preorder @xmath730_. any preorder @xmath730 induces the equivalence relation @xmath731 on @xmath414 @xmath732 we also denote the graph of the equivalence relation @xmath731 by @xmath733    going back to our problem , one can see that the @xmath231-axial relation gives a borel preorder on @xmath414 , namely @xmath734    the reason for introducing ( linear ) preorders in this context is given by the following theorem @xcite .",
    "[ t_a2 ] let @xmath735 be a borel graph of a linear preorder on @xmath414 with equivalence classes @xmath736 satisfying @xmath737 then , the disintegration w.r.t .",
    "the partition @xmath736 is strongly consistent and @xmath738    for future convenience we give the following definition .",
    "[ d_compatible ] a preorder @xmath730 on @xmath414 is _",
    "@xmath173-compatible _ if holds .",
    "[ rem_pre ] let @xmath79 be a @xmath173-compatible linear preorder . whenever a carriage @xmath243 satisfies the @xmath367-equivalence classes are contained in the equivalence classes of @xmath731 and then , as noticed before , since @xmath739 and @xmath642 for all @xmath62 , @xmath740 viceversa , if @xmath741 for some @xmath742 and @xmath743 , then by the @xmath173-compatibility of @xmath79 @xmath744 and then also its equivalence classes are contained in the equivalence classes of @xmath731 . in particular , could also be rewritten as @xmath745 .",
    "we point out that , while a @xmath173-compatible linear preorder satisfying for some @xmath243 can always be constructed using the axiom of choice , may not hold if the linear preorder is not borel ( see @xcite ) : hence , the main assumption of the theorem is the borel regularity .",
    "finally , notice that the partition into equivalence classes of @xmath746 with @xmath319 as above is @xmath747-cyclically connected in the sense of definition [ d_gammaconn ] .    in order to prove theorem [ t_subpart_step ] , in section [ s_cfibr_cfol ]",
    "we will look for a particular class of cost functions of the form called _ cone - lipschitz costs associated to a directed fibration_ for @xmath366-cyclically connected partitions satisfying .",
    "therefore , by theorem [ t_a2 ] and remark [ rem_pre ] , we will construct a borel @xmath173-compatible linear preorder @xmath79 such that , for any carriage of finite cost @xmath319 , the equivalence classes of @xmath748 coincide up to a @xmath2-negligible set with those of @xmath731 .    for convenience",
    "we give also the following    [ d_cmunucomp ] if @xmath730 is @xmath173-compatible and holds for every @xmath692 , then @xmath79 is called _",
    "@xmath749-compatible_.    hence , theorem [ t_a2 ] can also be restated saying that whenever @xmath79 is a borel @xmath173-compatible linear preorder satisfying for some @xmath243 of finite cost , then it is @xmath749-compatible .    according to the terminology used in @xcite , @xmath749-compatibility",
    "can also be restated saying that the diagonal in the quotient space @xmath750 is a _ set of uniqueness _ for @xmath751 , where @xmath555 is the quotient map associated to the partition @xmath731 : this means that there exists a unique transference plan in @xmath751 , namely @xmath752 .",
    "let @xmath493 be a convex norm as defined in and @xmath753 .",
    "the transport plans with finite @xmath0-cost @xmath754 and the optimal plans w.r.t .",
    "@xmath0 @xmath755 are respectively given by the transference plans with finite cost and the optimal plans w.r.t .",
    "the cost function @xmath756 since the cost is a norm , we have the following well known results @xcite : if @xmath757 , then    1 .",
    "there exists at least one optimal transference plan @xmath758 ; 2 .",
    "if @xmath243 is a @xmath354-cyclically monotone carriage of @xmath758 , then for @xmath217 the function given by , @xmath759 is lipschitz continuous on @xmath4 and @xmath760 @xmath761    in particular , @xmath36 is an optimal plan if and only if @xmath762    in the following we will denote by @xmath61 the dual potential @xmath763 which will be called _",
    "kantorovich potential_. clearly @xmath764    [ d_super_sub_diff ] a function @xmath765 is _",
    "@xmath0-lipschitz _ if it satisfies @xmath766 the _ superdifferential _ of @xmath767 is the set @xmath768 while its _ subdifferential _ is the set @xmath769    hence , can be rephrased as @xmath770    let now @xmath771 .    [ d_cone_cost ]",
    "we define the _ convex cone cost associated to @xmath375 _ as the function @xmath772 $ ] given by @xmath773    given @xmath774 , let @xmath775 be the set of transport plans of finite cone cost .",
    "notice that @xmath776      the optimal transport problem w.r.t .",
    "@xmath0 can be casted as a convex cone optimal transportation problem on @xmath777 w.r.t .",
    "the convex cone cost @xmath778 associated to @xmath779 ( see definition [ d_cone_cost ] and remark [ r_cone_epi ] ) .",
    "define in fact the measures in @xmath780 @xmath781 where @xmath61 is the kantorovich potential of @xmath755 , formula , and for @xmath35 consider the plan in @xmath782 @xmath783    the fundamental observations are and the following : if @xmath767 is @xmath0-lipschitz , then @xmath784    [ d_subsuperdiff ] if @xmath785 is the graph of a @xmath0-lipschitz function , define its _ superdifferential _ and _ subdifferential _ respectively as @xmath786    then can be rewritten as @xmath787    hence the following proposition holds true .",
    "[ p_equivalence_lifting ] the following statements are equiveridical :    1 .   [ pcond_1_setting ] @xmath28",
    "[ pcond_2_setting ] @xmath788 , with @xmath370 , @xmath371 given by ; 3 .   [ pcond_3_setting ] @xmath789 for some @xmath790 , with @xmath370 , @xmath371 given by",
    "[ e_hat_pi_graph ] @xmath791 satisfies @xmath792 .",
    "observe that , since @xmath793 is bi - lipschitz , then if @xmath794 and @xmath795 , @xmath796      we first give the definition of directed locally affine partition .",
    "[ d_locaff ] we say that a nonempty subset @xmath797 is _ locally affine _ if there exist @xmath798 and @xmath462 such that @xmath799 and @xmath800 is relatively open in @xmath465 , i.e. @xmath801 .",
    "notice that , in the above definition , @xmath802 .",
    "whenever @xmath800 is a locally affine set of dimension @xmath16 we will often denote it as @xmath803 to emphasize its dimension .",
    "[ d_locaffpart ] a _ directed locally affine partition _ in @xmath4 is a partition into locally affine sets @xmath804 , endowed with a family of closed nondegenerate convex cones @xmath805 such that    1 .",
    "the set @xmath806 is @xmath362-compact ; 2 .",
    "@xmath807 for all @xmath808 .    for shortness we will use the notation @xmath809 for the conditional probabilities of a measure @xmath2 over a locally affine partition we will use the notation @xmath810 , with @xmath811 :",
    "the fact that the disintegration is strongly consistent is a consequence of the fact that the function @xmath812 has @xmath362-compact graph @xmath813 .",
    "notice that the quotient space of the partition is given by @xmath814 where @xmath815 denotes the disjoint union of sets .    given a locally affine directed partition @xmath816 one can define the sets of _ initial _ and _ final points _ as follows .    [ d_initial_final ] define for @xmath817 , @xmath161 the _ initial points of @xmath107 _ as @xmath818 and the _ final points of @xmath107 _ as @xmath819 finally , we call _ sets of initial points _ and _ sets of final points _ of the locally affine directed partition @xmath816 the sets given respectively by @xmath820    notice that the sets @xmath821 , @xmath822 do not need to be disjoint even if @xmath823 and @xmath824 , and the same for @xmath825 , @xmath826 . moreover , @xmath827 but the inclusion may be strict ( see figure [ fi_direct_fibra ] and figure [ fi_infin ] ) . the measurability of the sets of initial / final points is proven in the lemma [ l_regularity_initial_final_points ] . in the proof we use the concept of _ completeness _ of a directed locally affine partition",
    ", whose meaning will be clear in section [ s_foliations ] and whose definition is given below .",
    "since up to that section , when it will become crucial for our analysis of the super / subdifferential partitions , such a property will be used only in order to prove measurability issues , more precisely in the proofs of lemma [ l_regularity_initial_final_points ] and of proposition [ p_countable_partition_in_reference_directed_planes ] , a deeper understanding of its meaning is up to then not necessary and can be for the moment neglected .",
    "[ d_part_compl ] a directed locally affine partition @xmath14 is _ complete _ if @xmath828    in the proof of proposition [ p_parall ] , we will see that the set defined in is a convex set satisfying @xmath829    [ d_dir_subpart ] we will say that a directed locally affine partition @xmath830 in @xmath4 is a _ directed locally affine subpartition _ of @xmath831 if the following holds :    1 .",
    "[ e_same_base ] @xmath832 , where @xmath833 is the set given by for @xmath834 ; 2",
    ".   @xmath835 there exists @xmath836 s.t .",
    "@xmath837 and @xmath838 is an extremal face of @xmath108 .",
    "[ d_disint_regular ] we say that a locally affine ( @xmath362-compact ) partition @xmath839 is _ lebesgue - regular _ if the conditional probabilities @xmath840 of the disintegration of @xmath5 on the partition @xmath841 ( see remark [ r_disint_lebesgue ] ) satisfy @xmath842    from the definition of disintegration of a radon measure given in remark [ r_disint_lebesgue ] , it is not difficult to check that the validity of is independent on the partition into unit measure sets @xmath843 , hence definition [ d_disint_regular ] is consistent .    to",
    "a directed locally affine partition @xmath831 in @xmath4 , we associate the cost function @xmath844 notice that , since @xmath845 is @xmath362-compact , @xmath196 is @xmath362-continuous .",
    "indeed , @xmath846    let us consider @xmath753 satisfying @xmath847 by definition of @xmath848 , one can easily see that @xmath849 and @xmath850 let @xmath851 be the disintegration of @xmath2 w.r.t .",
    "the partition @xmath180 .",
    "we have the following characterization .    [ p_dispiani ]",
    "@xmath852 if and only if the strongly consistent disintegration @xmath853 of @xmath36 w.r.t . the partition @xmath854 satisfies the following properties :    [ e_l_dispiani ] @xmath855 @xmath856 where the measure on the l.h.s . of is defined as in .    if @xmath857 , then up to an @xmath203-negligible set one has @xmath858 , and since @xmath859 one deduces .",
    "the equality is a fairly easy consequence of @xmath860 .",
    "conversely , if @xmath36 satisfies , then the two formulas @xmath861 yield @xmath857 .",
    "in other words any optimal transference plan w.r.t . the cost associated to a directed locally affine partition can be decomposed as a family of transference plans on the @xmath16-dimensional affine hulls of the @xmath16-dimensional sets of the partition , moving the mass along the cones of directions , and viceversa it can be reconstructed given a family @xmath862 satisfying -",
    ".    in general is not a disintegration ( see section [ ss_measure_disintegration ] before remark [ r_disint_lebesgue ] ) , as the following example shows .",
    "[ ex_2ndmarg ]    for @xmath863 let @xmath864 \\times \\{0\\ } \\cup \\{1\\ } \\times [ 0,1/2 ] \\times \\{0\\ } } , \\quad \\nu : = 2 \\mathcal h^1 \\llcorner_{\\{0\\ } \\times [ 0,1/2 ] \\times \\{1\\}},\\ ] ] and consider the directed locally affine partition @xmath865 @xmath866 then , for every decomposition @xmath867 with @xmath868 , @xmath869 and clearly @xmath870 .",
    "example [ ex_2ndmarg ] motivates the following definition .",
    "[ d_pinu ] given a transference plan @xmath871 , we define the _ conditional second marginals _ of @xmath872 w.r.t . @xmath14 as @xmath873 we also set @xmath874 and we call the set of _ optimal transport plans on the directed locally affine partition @xmath845 _ w.r.t . @xmath2 and @xmath875 .",
    "therefore , in the following by _ optimal transportation problem on a directed locally affine partition @xmath876 _ we mean an optimal transportation problem w.r.t .",
    "the cost @xmath848 between measures @xmath2 and @xmath877 , being the latter _",
    "admissible second marginals _ , namely conditional second marginals of at least one transference plan @xmath878 .    notice that in example [ ex_2ndmarg ] the existence of more than one family of admissible second marginals for the given optimal transportation problem would be avoided provided @xmath879",
    "what implies in general is that any family of admissible second marginals @xmath875 is given by a relabeling of the disintegration of @xmath3 on @xmath107 , but it may not necessarily occur that @xmath880 ( see figure [ fi_notuniqe ] ) . in the next proposition",
    "we give a criterion namely , condition  in order that condition is satisfied and then there exists just one family of admissible second marginals .",
    "condition will be indeed satisfied by directed locally affine partitions called fibrations and @xmath315-foliations given by single lipschitz graphs ( see corollary [ c_plan_fibr ] and proposition [ p_hat_bf_d_graph ] ) .",
    "[ p_dispiani_2 ] assume that @xmath881 hence , @xmath882    moreover , if @xmath883 , one has that @xmath884    hence the conditional second marginals of @xmath885 are equal to the conditional probabilities of @xmath3 , computed via disintegration on @xmath107 .",
    "notice that part of the statement is that the quotient measure @xmath203 of @xmath3 is the same as for @xmath2 .",
    "it is fairly easy to see that implies that @xmath886 so that each @xmath857 is concentrated on @xmath887 and this concludes the proof .      in the first part of this section",
    "we show that a directed locally affine partition is a countable union of directed locally affine partitions whose elements are locally affine sets having the same dimension and whose direction cones are `` close '' to a fixed reference cone .",
    "this kind of partitions will be called _",
    "sheaf sets_. then , we will see that the optimal transportation problem on a _",
    "@xmath16-directed sheaf set _",
    "with @xmath16 denoting the dimension of its locally affine sets can be equivalently reformulated as an optimal transportation problem on a @xmath16-directed sheaf set whose sets are contained in distinct parallel @xmath16-dimensional planes , called _",
    "@xmath16-directed fibration_. the advantage of this reformulation is that on a @xmath16-directed fibration all the supports of the second marginals are disjoint , condition holds and then ( by corollary [ c_plan_fibr ] ) one can consider the quotient variables of the partition as parameters for a family of independent convex - cone optimal transportation problems in @xmath300 . since @xmath175-dimensional sets , i.e. single points in @xmath4 , are obviously not further partitionable , from now on we will consider partitions into sets of dimension @xmath888 .",
    "let @xmath889 be a locally affine directed partition in @xmath4 . if @xmath890 are vectors in @xmath4 , define the sets @xmath891 and @xmath892\\bigg\\}.\\ ] ]    recalling the definitions given in sections [ ss_intro_affine_subspaces_cones ] and [ ss_partitions_intro ] , and the completeness property of definition [ d_part_compl ] , we have the following result .",
    "[ p_countable_partition_in_reference_directed_planes ] there exists a countable covering of @xmath876 into disjoint directed locally affine partitions @xmath893 , with the following properties : @xmath894 .",
    ", set @xmath895 then , @xmath896 for all @xmath897 , i.e. the elements @xmath107 , @xmath17 have linear dimension @xmath16 , for @xmath898 , and there exist    * linearly independent vectors @xmath899 , with linear span @xmath900 * a given point @xmath901 , * constants @xmath902 , * a non degenerate cone @xmath903 , with @xmath904 ,    such that it holds :    1 .   [ point_1_proposition_p_countable_partition ] the enlargement of the cone @xmath375 by a factor @xmath905 is non - degenerate @xmath906 2 .",
    "[ point_2_proposition_p_countable_partition ] the projections on @xmath907 of the cones @xmath17 , @xmath898 , have a uniform opening containing @xmath375 @xmath908 3 .   [ point_3_proposition_p_countable_partition ] the projections on @xmath907 of the cones @xmath17 , @xmath898 , are strictly contained in the given cone @xmath909 @xmath910 4 .",
    "[ point_4_proposition_p_countable_partition ] the projection map on @xmath907 is nondegenerate @xmath911 5 .",
    "the projection of @xmath107 on @xmath907 contains a given cube @xmath912    moreover , if @xmath876 is complete , then the sets @xmath913 are borel .",
    "observe that from point and point above it follows that there exists @xmath914 such that @xmath915",
    "if @xmath505 , @xmath916 and given two real numbers @xmath917 such that @xmath918 , consider the subset @xmath919 of @xmath488 defined by @xmath920 if is fairly easy to see that for all @xmath921 as above the family @xmath922 generates a base of neighborhoods of @xmath488 . in particular , we can find a countable family of sets @xmath923 , covering @xmath488 being the latter separable .",
    "notice that @xmath924 is compact .",
    "then , define @xmath925 clearly @xmath926 is a covering of @xmath927 into disjoint sets , and it is fairly straightforward to prove that these sets are @xmath362-compact , because the sets @xmath928 are compact .",
    "for each @xmath16 , @xmath929 , @xmath930 , consider a family of @xmath16 linearly independent unit vectors @xmath931 in @xmath4 such that @xmath932 being the family of sets @xmath933 a base of the topology of @xmath907 , let @xmath934 be a countable base .",
    "define thus @xmath935 since the directed partition is complete ( see definition [ d_part_compl ] ) and point holds then @xmath936 let @xmath937 be the @xmath362-continuous map @xmath938 one has that @xmath939 is a @xmath362-compact set , thus @xmath940 is borel . relabeling the sets @xmath940 as @xmath941 , the proof is completed .",
    "[ r_sheaf_negl ] in the rest of this section , without further comments , we will assume that the directed locally affine partitions are complete , according to definition [ d_part_compl ] .",
    "indeed , this will be always the case for the partitions we analyze in the paper . since we will be interested into directed locally affine partitions up to sets which are @xmath534-negligible w.r.t .",
    "some fixed measure @xmath534 , we will also consider the sets of the countable partition @xmath913 as @xmath362-compact , which is always the case provided we remove an @xmath534-negligible set .",
    "[ d_sheaf_set ] for @xmath100 , we call",
    "_ @xmath16-(dimensional ) directed sheaf set _ a @xmath362-compact directed locally affine partition into @xmath16-dimensional sets @xmath942 which satisfy the same properties of the sets @xmath943 in proposition [ p_countable_partition_in_reference_directed_planes ] : there exist    * linearly independent vectors @xmath944 , with linear span @xmath945 * a given point @xmath946 , * constants @xmath947 , * a non degenerate cone @xmath903 , with @xmath948 ,    such that , denoting @xmath949 , @xmath950 , @xmath951 , it holds :    1 .",
    "@xmath952 ; 2 .",
    "@xmath953 ; 3 .",
    "@xmath954 for all @xmath955 4 .",
    "@xmath956 for all @xmath957 , @xmath955 ; 5 .",
    ".    the @xmath16-dimensional plane @xmath959 will be called _ reference plane _ , the cones @xmath960 _ base cones of directions _ , @xmath961 _ base point",
    "_ and @xmath962 _ base rectangle _ of the sheaf set .",
    "moreover , we can choose @xmath963 in this way the quotient space @xmath964 is a subset of a @xmath965-dimensional affine space .",
    "this will be our default choice for the quotient space @xmath966 of @xmath942 .    before going on , we prove the following lemma , announced in section [ ss_partitions_intro ] .",
    "[ l_regularity_initial_final_points ] if the directed locally affine partition is @xmath362-compact and complete , then the sets @xmath967 , @xmath968 are souslin .",
    "we prove the statement only for @xmath967 , since the proof for @xmath968 is analogous .",
    "moreover , we can consider w.l.o.g . a directed locally affine partition given by a @xmath362-compact directed sheaf set as in definition [ d_sheaf_set ] .",
    "let @xmath969 such that the sets @xmath970 are compact , and for @xmath971 define @xmath972 by the completeness property of the sheaf set , there exists @xmath973 such that @xmath974    since the set @xmath975 is borel , then by , reasoning as in the sets @xmath976 are borel too and finally @xmath977 is souslin .",
    "now we show that the graph @xmath942 of a @xmath16-directed sheaf set in @xmath4 can be mapped injectively into a subset of @xmath978 called _ fibration _ , consisting of a family of parallel @xmath16-dimensional locally affine sets . in this section , points in @xmath978 will be denoted as @xmath979 .",
    "[ d_fibration ] a _",
    "@xmath16-(dimensional ) directed fibration _ is a @xmath362-compact set @xmath980 endowed with a @xmath362-continuous map @xmath981 , @xmath982 , such that @xmath983 for all @xmath984 .    to a directed fibration",
    "@xmath985 we associate the cost @xmath986 recalling the definition given in , notice that @xmath987    [ p_map_sheaf_set_into_fibration ] let @xmath942 be a @xmath16-dimensional directed sheaf set with base cones @xmath988 , reference plane @xmath374 , base point @xmath961 and quotient space @xmath989 and define the map @xmath990 where @xmath991 are the identification maps .    then , @xmath992 is a bijection onto @xmath993 and @xmath994 maps the sheaf set @xmath995 into the elements of the fibration @xmath996 endowed with the direction map @xmath997    moreover , @xmath998 where @xmath999    finally @xmath1000    the functions @xmath1001 and @xmath1002 are @xmath362-continuous , because their graphs are projections of @xmath362-compact sets .",
    "the facts that @xmath1001 is a bijection and that @xmath1003 is a fibration are straightforward , observing that is satisfied by the cones @xmath1004 , @xmath1005 , thanks to @xmath1006 , @xmath627 and @xmath1007 of definition [ d_sheaf_set ] .    as for the last statements , it is sufficient to observe that @xmath1008 and that @xmath1009 is bi - lipschitz , @xmath1010 .    in the following , we set @xmath1011    [ rem_sheaffibr ] notice that , once we fix an orthogonal basis @xmath1012 and identify @xmath1013 , a @xmath16-directed fibration is the image through the map @xmath1014 of a @xmath16-directed sheaf set whose reference @xmath16-plane is @xmath1015",
    ". therefore , we can think of a @xmath16-directed fibration as a @xmath16-directed sheaf set whose sets are contained in disjoint parallel @xmath16-planes .",
    "in particular , when we speak about directed locally affine subpartitions of a fibration ( as e.g. in proposition [ p_sub_sheaf_fol ] ) we mean the image through the map @xmath1014 of directed locally affine subpartitions of the corresponding @xmath16-directed sheaf set .    [ p_sub_sheaf_fol ]",
    "let @xmath1016 be a locally affine directed subpartition of the sheaf set @xmath14 .",
    "then the sets @xmath1017 form a directed locally affine subpartition of the fibration @xmath1018 , and viceversa .    if moreover the subpartition @xmath1019 is regular , then also the subpartition @xmath1020 is regular , and viceversa .    since @xmath1021 is an invertible projection , the first part of the statement is obvious .",
    "the same reasoning holds for the regularity of the measures .    recalling propositions [ p_dispiani ] and [ p_dispiani_2 ] ,",
    "it is fairly easy to prove the following    [ c_plan_fibr ] let @xmath985 be a @xmath16-directed fibration and @xmath1022 , @xmath1023 s.t . @xmath1024 .",
    "then , @xmath1025 being @xmath1026 , @xmath1027 and @xmath1028 be respectively the disintegrations of @xmath1022 , @xmath1029 w.r.t .",
    "the partition @xmath1030 and the disintegration of @xmath1031 w.r.t . @xmath1032 .",
    "in the first part of this section we generalize the notion of graph of a @xmath0-lipschitz function up to the definition of a @xmath315-lipschitz foliation , where @xmath381 is the family of cones of directions associated to a given @xmath16-dimensional fibration @xmath1033 . from now",
    "on we fix @xmath16 and we drop the superscript @xmath16 in the notation for a @xmath16-directed fibration or @xmath16-dimensional cone",
    ". moreover we will replace the variable @xmath1034 with @xmath148 , since it is clear from proposition [ p_map_sheaf_set_into_fibration ] and remark [ rem_sheaffibr ] that the quotient spaces of a sheaf set and of the corresponding fibration can be identified .    in particular ,",
    "for any fixed @xmath1035 , the intersection of a @xmath146-lipschitz foliation with @xmath385 will be a suitable collection of disjoint _",
    "( complete ) @xmath1036-lipschitz graphs _",
    "namely , graphs of @xmath1037-lipschitz functions where @xmath1038 is convex set s.t .",
    "@xmath1039 ( see definition [ d_complete_g]) and at most countably many sets with nonempty interior .    next , we generalize the notion of super / subdifferentials given in definition [ d_subsuperdiff ] for single graphs of @xmath0-lipschitz functions to this new class of objects : at each point @xmath1040 , the superdifferential will be the intersection of the cone @xmath1041 with the @xmath382-lipschitz graph to which @xmath1042 belongs .",
    "our main result is theorem [ t_partition_e+- ] , in which we prove that , up to a residual set , a @xmath146-lipschitz foliation can be decomposed into a directed locally affine partition whose cone of directions at each point is given by the super / subdifferential .",
    "moreover , in theorem [ t_partition_e ] we characterize the residual set as the set of _",
    "initial_/_final points _ of the super / subdifferential partitions ( see definition [ d_initial_final ] ) .",
    "let @xmath1043 be the epigraph of a convex norm @xmath1044 : by remark [ r_cone_epi ] , as a subset of @xmath1045 , @xmath1046 .",
    "we denote variables in @xmath300 as @xmath1047 and we let @xmath1048 $ ] be the related _ convex cone cost _ ( see definition ) .",
    "now we introduce a class of subsets of @xmath300 which includes the graphs of @xmath1049-lipschitz functions @xmath1050 .",
    "in particular , when @xmath1051 and @xmath1052 , this class contains the graphs of the kantorovich potentials @xmath61 for the transport problem with cost ( see section [ ss_convex_norm_cone ] ) .",
    "[ d_complete_g ] a set @xmath1053 is a _",
    "@xmath1054-lipschitz graph _ if    [ e_g ] @xmath1055 moreover , a @xmath1054-lipschitz graph @xmath1056 is _ complete _ if @xmath1057    notice that is equivalent to @xmath1058 which can be rephrased as @xmath1059 the second condition yields @xmath1060    [ r_lipgraph ] if @xmath1061 with @xmath1062 @xmath1049-lipschitz and @xmath1063 , then @xmath1064 is a complete @xmath1054-lipschitz graph .",
    "the analysis of this particular case will be sufficient for the proof of theorem [ t_1 ] .",
    "if @xmath1065 , we anticipate that the `` completeness '' property is what we need to construct sets which preserve the properties of the @xmath1049-super / subdifferentials of lipschitz functions on @xmath1066 : these properties are fundamental for our later purposes , culminating with the proof of theorem [ t_partition_e+- ] .    recalling definition [ d_subsuperdiff ] of super / subdifferential of the graph of a @xmath0-lipschitz function @xmath767",
    "we give the following definition .",
    "[ d_tilde_c_diff ] given a set @xmath1056 , define the _",
    "@xmath1054-superdifferential _ and the _ @xmath1054-subdifferential _ of @xmath1064 respectively as @xmath1067    notice that @xmath1068 and since @xmath1069 one deduces the _ transitivity property _ @xmath1070",
    "the property of a set of being a complete @xmath1054-lipschitz graph can be equivalently restated in terms of its @xmath1054-super / subdifferentials as follows .",
    "[ p_compl_para_sd ] @xmath1056 is a complete @xmath1054-lipschitz graph if and only if    [ e_gprop_para_sd ] @xmath1071 @xmath1072    by definition [ d_tilde_c_diff ] , property is a rephrasing of , and is a rephrasing of .    recalling and",
    ", we notice that if @xmath1064 is a @xmath1054-lipschitz graph and @xmath1062 is the function satisfying , then @xmath1073    now we state a simple geometric characterization of the set @xmath1074 which will be fundamental in our study of the @xmath1054-super / subdifferentials of complete @xmath1054-lipschitz graphs .",
    "first we give the following definition .",
    "[ d_cww ] for @xmath1075 , we let @xmath1076 be the extremal cone of @xmath1043 satisfying @xmath1077 equivalently , @xmath1076 is the minimal cone w.r.t . set inclusion among the extremal cones of @xmath1043 containing @xmath1078 .",
    "notice that , by , if @xmath1079 and @xmath1080 then @xmath1081 , i.e. @xmath1076 is a proper extremal cone of @xmath1043 .",
    "[ p_parall ] @xmath1074 is the convex set given by @xmath1082 and there exists @xmath1083 such that @xmath1084 in particular , @xmath1085    by definition , @xmath1086 and since @xmath1087 , follows .",
    "let us assume that @xmath1088 and let @xmath130 be the smallest face of @xmath1089 such that @xmath1090 , @xmath1091 .",
    "notice that @xmath1092 .",
    "we set @xmath1093 and @xmath1094 , @xmath1095 w.r.t .",
    "coordinates s.t .",
    "@xmath130 is the epigraph of a convex norm @xmath1096 .",
    "hence , @xmath1097 and either @xmath1098 , or @xmath1099 and @xmath1100 . in the first case ,",
    "@xmath1101 , which implies @xmath1102 , contradicting the fact that @xmath1103 . in the second case",
    ", we get @xmath1104 , thus leading again to a contradiction .",
    "observe that , with the characterization of proposition [ p_parall ] and by projecting on @xmath1066 , can be equivalently restated in terms of the super / subdifferentials of @xmath1062 saying that , for all @xmath1105 , the set @xmath1106 contains the convex set @xmath1107 such that @xmath1108 and @xmath1109 being @xmath1110 the minimal extremal cone of @xmath1111 containing @xmath1112 ( see section [ ss_intro_affine_subspaces_cones ] for the definition of extremal cone ) .",
    "let @xmath1113 , @xmath1114 , be the convex cone direction map of a @xmath16-directed fibration satisfying and let @xmath146 be the cost function defined in . recall that , by @xmath1115 and @xmath1116 moreover , set @xmath1117 where @xmath1118 for some suitable orthonormal coordinates independent of @xmath148 .",
    "[ d_lip_fol ] a @xmath146-lipschitz foliation is a @xmath362-compact partition in @xmath1119 with quotient map @xmath1120 such that    [ e_compl_fol0 ] @xmath1121 @xmath1122    by , and recalling , we set @xmath1123 we note moreover that from one has @xmath1124 for some @xmath301 , thus in general @xmath1125 for some polish space @xmath1126 and @xmath1127 .",
    "hence , for simplicity of notation , from now onwards we will write when not leading to confusion @xmath1128 .",
    "the following definition is given to simplify the notation in proposition [ p_fol_char ] ( see remark [ r_nondeg ] ) .",
    "[ d_non_dege ] we call _ non - degeneracy set _ of a @xmath146-lipschitz foliation the set @xmath1129 we say that the partition @xmath1130 is _ non - degenerate _ if the set @xmath1131 coincides with its non - degeneracy set .    in other words ,",
    "the set @xmath1132 is non - degenerate if there are two points @xmath1042 , @xmath155 in @xmath1133 such that @xmath1134    [ p_fol_char ] let @xmath1130 be a non - degenerate @xmath146-lipschitz foliation .",
    "then , there exist two borel functions @xmath1135 such that    1 .",
    "[ prop_1_fol_char ] @xmath1136 are @xmath147-lipschitz functions for all @xmath1137 , where @xmath1138 and @xmath1139 is given by ; 2 .",
    "[ prop_2_fol_char ] @xmath1140 ; 3 .",
    "[ prop_3_fol_char ] @xmath1141 .",
    "in particular , @xmath1142    by , @xmath1143 satisfies . in particular , for all @xmath1144 the set @xmath1145 is a segment . thus define for @xmath1144    [ e_h_def ] @xmath1146 @xmath1147    since @xmath1148 is non degenerate , then for all @xmath1144 it follows that @xmath1149 where @xmath1042 , @xmath155 are the points of non - degeneracy , so that @xmath1150 , @xmath1151 are real valued functions .    using again property , one has also @xmath1152 @xmath1153 which show that @xmath1150 , @xmath1151 are @xmath147-lipschitz , proving point .",
    "points and of the statement are an immediate corollary of the definitions and property .",
    "finally is a straightforward consequence of the first part of the statement .",
    "[ r_nondeg ] from the proof of proposition [ p_fol_char ] it is clear that out of the non - degeneracy set there are three possibilities : either the function defined in is identically @xmath628 or the function in is identically @xmath1154 or both things happen .",
    "hence , for all @xmath301 there exist at most countably many @xmath1155 s.t .",
    "@xmath1156    in the following proposition we give the two examples of @xmath146-lipschitz foliations we will deal with in the rest of the paper .    [ p_ex_fol ] ( 1 ) let @xmath1157 be a complete @xmath1158-lipschitz graph .",
    "then , the trivial equivalence relation on @xmath1159 given by the constant quotient map @xmath1160 determines a @xmath146-lipschitz foliation in @xmath1161 , being @xmath381 the constant cone direction map @xmath1162 , which satisfies .",
    "\\(2 ) let @xmath1130 be the equivalence classes of a @xmath146-compatible linear preorder @xmath1163 on @xmath384 with @xmath362-compact graph ( see definition [ d_compatible ] ) .",
    "then they form a @xmath146-lipschitz foliation .    to prove the first part of the proposition , it is sufficient to notice that property corresponds to and is a consequence of .",
    "as for the second example , by observe that if @xmath1164 then @xmath1165    in view of , we extend definition [ d_tilde_c_diff ] to @xmath146-lipschitz foliations .",
    "[ d_partial_theta ] we define the _ superdifferential _ of a @xmath146-lipschitz foliation @xmath1148 as the set @xmath1166 defined by @xmath1167 analogously , we define its _ subdifferential _ as the set @xmath1168 given by @xmath1169    clearly @xmath1170 and since by @xmath1171 then for simplicity we will use the notation @xmath1172    recalling definition [ d_tilde_c_diff ] , notice that @xmath1173 and , in particular , as for @xmath1174-lipschitz graphs , we have the _ transitivity property _ @xmath1175      in this section we consider only the elements of a @xmath146-foliation whose @xmath1176-sections are partitions into complete @xmath382-lipschitz graphs , namely level sets of @xmath395 which satisfy .",
    "we go through a careful analysis of the geometric properties of the super / subdifferentials of @xmath146-lipschitz foliations , which finally leads to partition them into _ forward / backward regular sets _ and a _",
    "residual set_.    by , in the following definitions the variable @xmath1176 simply plays the role of a parameter .",
    "then , to understand the geometric structure of the problem one can also think from now onwards that @xmath1177 .",
    "the dependence on @xmath148 is kept in order to show that all the sets and functions constructed below depend measurably ( resp .",
    "borel or @xmath362-continuously ) on the parameter @xmath148 .",
    "we will define the following sets through their @xmath1176-sections .",
    "forward / backward transport set : :    the _ forward / backward transport sets _ are respectively defined by    +    [ e_forward_backward_set ] @xmath1178    @xmath1179 set of fixed points : :    the _ set of fixed points _ is given by    @xmath1180 forward / backward direction multifunction : :    the _ forward / backward direction multifunction _ are respectively given    by    +    [ e_forw_back_dir_theta ]    @xmath1181    @xmath1182    the following proposition collects the fundamental properties of the super / subdifferentials of @xmath146-lipschitz foliations .",
    "the most striking feature is that , due to the completeness property of its @xmath382-lipschitz graphs , the forward / backward direction multifunctions at a point of @xmath1143 contain all the information about the super / subdifferential at that point and also in a `` neighborhood '' of it ( see remark [ r_directionfaces ] ) .",
    "whenever @xmath1164 , we will define @xmath1183 and @xmath1184 as in definitions [ d_cww ] and for the convex cone @xmath1185 .",
    "[ pdirectionfaces1 ] let @xmath1186 be an extremal cone , @xmath1187 .",
    "the following conditions are equivalent :    1 .",
    "[ item1pfaces ] @xmath1188 ; 2 .",
    "[ item2pfaces ] there exists @xmath1189 such that @xmath1190 ; 3 .",
    "[ item4pfaces ] @xmath1191 for some @xmath155 such that @xmath1190 ; 4 .",
    "[ item3pfaces ] there exists @xmath1192 such that @xmath1193    in particular , if @xmath130 satisfies one of the above conditions , then for all @xmath155 as in ( [ item2pfaces]-[item4pfaces ] ) @xmath1194    finally , if @xmath130 is maximal w.r.t .",
    "set inclusion among the extremal cones of @xmath1195 satisfying ( [ item1pfaces]-[item3pfaces ] ) , then @xmath1196 where @xmath155 is chosen as in ( [ item2pfaces]-[item4pfaces ] ) .    _",
    "_ it is sufficient to take @xmath1198 s.t . @xmath1199 and recall definition [ d_cww ] .    _",
    "_ if @xmath155 satisfies , then follows from the completeness assumption in the definition of @xmath146-lipschitz foliation .    _",
    "_ it follows immediately from .    _",
    "_ it is a direct consequence of the definition of @xmath1200 .",
    "_ proof of .",
    "_ let @xmath1201 .",
    "then , by the geometric properties of @xmath1184 given in proposition [ p_parall ] , it is fairly easy to see that @xmath1202 , and @xmath1203 . since @xmath1201 , @xmath1204 .",
    "_ proof of .",
    "_ let now @xmath130 be maximal and @xmath1205 .",
    "by we already know that @xmath1206 .",
    "let us assume that there exists @xmath1207 such that @xmath1208 : being @xmath130 an extremal cone , then one has also @xmath1209 . by the transitivity property , @xmath1210 and , by simple geometrical considerations similar to those made in the proof of proposition [ p_parall ] , @xmath1211 with strict inclusion .",
    "hence , by the completeness assumption , this contradicts the maximality of @xmath130 .",
    "a completely similar proposition can be proved for @xmath1212 : we state it without proof .    [ pdirectionfaces1- ] let @xmath1186 be an extremal cone , @xmath1213 .",
    "the following conditions are equivalent :    1 .   [ item1pfaces- ] @xmath1214 ; 2 .",
    "[ item2pfaces- ] there exists @xmath1215 such that @xmath1216 ; 3 .",
    "[ item4pfaces- ] @xmath1217 for some @xmath156 such that @xmath1216 ; 4 .",
    "[ item3pfaces- ] there exists @xmath1218 such that @xmath1219    in particular , if @xmath130 satisfies one of the above conditions , then for all @xmath156 as in ( [ item2pfaces-]-[item4pfaces- ] ) @xmath1220    finally , if @xmath130 be maximal w.r.t .",
    "set inclusion among the extremal cones of @xmath1195 satisfying ( [ item1pfaces-]-[item3pfaces- ] ) , then @xmath1221 where @xmath156 is chosen as in ( [ item2pfaces-]-[item4pfaces- ] ) .",
    "[ r_directionfaces ] the radii of the balls @xmath1222 satisfying point in propositions [ pdirectionfaces1]-[pdirectionfaces1- ] for a fixed @xmath1223 might actually change as @xmath130 varies in the set of extremal cones satisfying point and even tend to zero for some sequence of distinct @xmath1224 .    finally , we define the _",
    "( @xmath258-dimensional ) forward / backward transport sets _ and the _ residual sets _ : they are defined in terms of properties of the forward / backward direction multifunctions , i.e. of `` local '' ( see remark [ r_directionfaces ] ) properties of their super / subdifferentials .",
    "@xmath258-dimensional forward / backward regular transport set : :    for @xmath1225 , the    _ @xmath258-dimensional forward / backward regular transport    sets _ are defined respectively as    +    [ e_ell_prime_forward_backward_regular_transport_set ]    @xmath1226 @xmath1227 forward / backward regular transport sets : :    the _ forward / backward regular transport sets _ are defined respectively    by @xmath1228 regular transport set : :    the _ regular transport set _ is defined by    @xmath1229 residual set : :    the _ residual set _ is defined by @xmath1230    property @xmath1231 ( @xmath1231 ) will be crucial in theorem [ t_partition_e+- ] in order to prove that the sets of points in @xmath1232 ( @xmath1233 ) which belong to the same level set of @xmath395 and whose superdifferentials ( subdifferentials ) have the same affine span are @xmath258-dimensional locally affine sets ( see definition [ d_locaff ] ) .",
    "we now prove that all the above sets , except @xmath1234 and @xmath1235 , are @xmath362-compact .",
    "[ p_borel_regu_transport_sets ] the sets @xmath1236 , @xmath1237 , @xmath1238 , @xmath1239 , @xmath1240 , @xmath1241 are @xmath362-compact .",
    "the sets @xmath1234 , @xmath1235 are borel .    for every set in the first statement of the proposition , we will construct @xmath362-compact subsets of a polish space whose projection corresponds to that particular set .",
    "_ subdifferential : _ consider the following sets :    1 .",
    "@xmath1242 : since the function @xmath146 is @xmath362-continuous , it follows that this set is @xmath362-compact ; 2 .",
    "@xmath1243 : the same reasoning of the previous point applies here , being @xmath395 a @xmath362-continuous function in definition [ d_lip_fol ] of @xmath1244-lipschitz foliation .",
    "it follows that the set @xmath1245 is @xmath362-compact .",
    "_ backward transport set : _ the set @xmath1246 is the projection of the @xmath362-compact set @xmath1247 and thus it is @xmath362-compact .",
    "_ backward directions : _ since @xmath1248 is continuous , it follows that @xmath1249 is @xmath362-compact , being the image of a @xmath362-compact set by a continuous function .",
    "_ backward regular transport sets : _ first notice that the map @xmath1250 is continuous w.r.t . the hausdorff topology and that the sets @xmath1251 are closed w.r.t . the hausdorff topology , for all @xmath1252 , @xmath1253 , @xmath1254 . since the function @xmath1255 is constant on these sets , then it is @xmath362-continuous .",
    "let us now prove that the set @xmath1256 is @xmath362-compact .",
    "this follows by considering the closed sets @xmath1257 , observing that @xmath1258 and writing the previous set as the union of countably many @xmath362-compact sets in the following way : @xmath1259    from proposition [ pdirectionfaces1- ] , we have moreover that @xmath1260    hence the set @xmath1261 is @xmath362-compact , being the finite intersection of @xmath362-compact sets , and thus @xmath1262 is @xmath362-compact too .",
    "the proof for @xmath1263 , @xmath1264 , @xmath1265 and @xmath1266 is analogous , and hence the @xmath362-compactness of @xmath1267 , @xmath1268 and @xmath1241 follows .    being the difference of two @xmath362-compact sets a borel set , the borel measurability of @xmath1234 and @xmath1235 is proved .      in this section",
    "we construct directed locally affine partitions of the forward regular sets and backward regular sets of a @xmath146-lipschitz foliation , which will be respectively called _ superdifferential directed partitions _ and _ subdifferential directed partitions_. as we will see , these partitions coincide on the regular set , thus giving a directed locally affine partition which will be called _",
    "@xmath146-differential directed partition_.    define the maps    [ e_partition_on_t ] @xmath1269 @xmath1270    in the following , when clear from the context , we identify sets @xmath1271 with @xmath1272 .",
    "[ t_partition_e+- ] the map @xmath1273 induces a ( complete ) directed locally affine partition on @xmath1267 into sets @xmath1274 with direction cones @xmath1275 such that the following holds : @xmath1276    analogously , the map @xmath1277 induces a ( complete ) directed locally affine partition of @xmath1268 into sets @xmath1278 with direction cones @xmath1279 such that the following holds : @xmath1280    as a corollary one obtains the following decomposition of @xmath1281 .",
    "[ c_v ] the two maps @xmath1273 , @xmath1277 coincide on @xmath1281 , i.e. @xmath1282 and the map @xmath1283 defined above induces on @xmath1281 a ( complete ) directed locally affine partition @xmath1284 , where , for all @xmath1285 and @xmath1252 , @xmath1286 in particular , both and are satisfied .    in the following",
    "we will use the following definitions .",
    "[ d_vpm ] given a @xmath146-lipschitz foliation @xmath395 , the directed locally affine partition induced on @xmath1267 by @xmath1273 is called the _ superdifferential directed partition _ , while the directed locally affine partition induced on @xmath1287 by @xmath1277 is called the _ subdifferential directed partition_.    the partition induced by @xmath1288 on the regular points @xmath1241 is called _",
    "@xmath146-differential directed partition_.    we prove the part of theorem [ t_partition_e+- ] which regards @xmath1267 and @xmath1273 , being the one about @xmath1268 and @xmath1277 completely symmetric .",
    "notice that in the proof is also shown that the map @xmath1289 is @xmath362-continuous .",
    "being a single - valued map , @xmath1273 clearly induces a partition of @xmath1267 .",
    "moreover , @xmath1273 is @xmath362-continuous by proposition [ p_borel_regu_transport_sets ] and the fact that the affine envelope of compact sets is @xmath362-continuous w.r.t .",
    "hausdorff topology .",
    "since , by @xmath1290 let @xmath1291 and @xmath1292 let @xmath1293 by ( i ) , for all @xmath1294 @xmath1295 thus , by ( iii ) , @xmath1296 and @xmath1297 satisfies .",
    "let us now show that @xmath1298 is relatively open in @xmath1299 .",
    "more precisely , we prove the following    [ cl_owwneigh ] for all @xmath1294 , there exist @xmath1300 such that @xmath1301    by @xmath1302 and there exists @xmath1303 s.t .",
    "@xmath1304 and by @xmath1231 there exists @xmath1305 s.t . @xmath1306 . by proposition [ p_parall ]",
    ", @xmath1307 is a relatively open neighborhood of @xmath1042 in @xmath1308 .",
    "let now @xmath1309 . by the completeness of the superdifferential , @xmath1310 hence , @xmath1311 thus implying that @xmath1312 .",
    "the proof of corollary [ c_v ] follows easily from the proof of theorem [ t_partition_e+- ] .",
    "if @xmath1313 , then @xmath1314 by the transitivity property one has that @xmath1315 hence , as in the proof of claim [ cl_owwneigh ] , @xmath1316 yielding the conclusion .    in the following we will use the notation @xmath1317 , @xmath1318 and @xmath1319 to denote the @xmath362-compact graphs of the directed locally affine partitions induced respectively by @xmath1273 , @xmath1277 and @xmath1288 , namely    [ e_sub_directed_partition_all ] @xmath1320 @xmath1321",
    "@xmath1322    we will also use the notations @xmath1323 , @xmath1324 , @xmath1325 . recalling that @xmath1114 and observing that , after the partition into sheaf sets as in proposition [ p_countable_partition_in_reference_directed_planes ] and the injection into a fibration , we can take as in @xmath1326 we let @xmath1327 , @xmath1252 .",
    "now we give a characterization of the residual set as the union of _ initial _ and _ final points _ respectively for the superdifferential partition and the subdifferential partition .",
    "moreover , we fully characterize the super / subdifferentials at each point of the super / subdifferential partitions in terms of the regular and initial / final points .    recalling definition [ d_initial_final ] of initial and final points of a directed locally affine partition , let @xmath1328 be the _ sets of initial points of the superdifferential partition @xmath1329 _ and let @xmath1330 be the _ set of final points of the subdifferential partition @xmath1331_.    [ t_partition_e ] the following holds : @xmath1332 and moreover    [ point_sudiff_is_partition_in_fin ] @xmath1333 @xmath1334    [ r_not_only_r ] notice that in general the points of the set @xmath1235 , i.e. the complement of the set of regular points @xmath1241 , may not belong to the set @xmath1335 , i.e. the set of initial and final points for the directed locally affine partition @xmath1019 induced by @xmath1288 on @xmath1241 ( see figure [ fi_infin ] ) .    the main observation in the proof of theorem [ t_partition_e ] is contained in the following    [ r_t+t - i+e- ] we observe the following properties of @xmath1336 , @xmath1337 : @xmath1338 the statements follow respectively from and , taking @xmath1339 equal to any maximal extremal cone of @xmath1340 .",
    "let @xmath1341 : then from definition , @xmath1342 if @xmath1343 , then by remark [ r_t+t - i+e- ] and definition [ d_initial_final ] it follows that @xmath1344 . if @xmath1345 , @xmath1213 by ( iii ) and then again by remark [ r_t+t - i+e- ] we conclude that @xmath1346 .",
    "+ analogously , @xmath1347 and @xmath1348 .",
    "this concludes the proof of .",
    "we prove , being the proof of analogous .",
    "we already know by that @xmath1349 let now @xmath1350 and @xmath1351 as in ( iii ) .",
    "then , as in claim [ cl_owwneigh ] , for all @xmath1352 one has @xmath1353 notice that now we do not need to specify that @xmath1354 because we already know @xmath1298 to be open in @xmath1355 .",
    "then there are two possibilities : either @xmath1356 or by transitivity @xmath1357 in case holds , it follows that @xmath1304 .",
    "otherwise , one has @xmath1358 and then as seen before @xmath1359 .",
    "+ to prove , it is sufficient to take a maximal backward extremal cone @xmath130 for @xmath155 as in containing @xmath1360 : by , @xmath1361 and then @xmath155 can not be a backward regular point .",
    "let @xmath1362 be a @xmath146-lipschitz foliation on @xmath1363 and consider two probability measures in @xmath1364 which can be disintegrated as @xmath1365 and satisfying    [ e_541 - 2 ] @xmath1366 @xmath1367    notice that , by definition [ d_partial_theta ] of superdifferential of @xmath395 , @xmath1368 by theorem [ t_partition_e ] , @xmath1369 hence @xmath1370 if and only if it has @xmath1022 and @xmath1029 as first and second marginal respectively and it is concentrated on the set @xmath1371.\\ ] ]    first notice that    [ e_descr ] @xmath1372 @xmath1373 @xmath1374    and thus the restrictions of all the transport plans in to the sets are concentrated on the diagonal @xmath1375 .",
    "hence , we will assume w.l.o.g . that @xmath1376 this is true e.g. if @xmath1377 .",
    "now we give , in the same spirit of theorem [ t_partition_e ] , a more accurate description of the set ( we will neglect the subsets by the above observation ) , independently of the measures @xmath1022 , @xmath1029 . as a consequence ( see proposition [ p_disint_fol ] below ) we will get that if @xmath1378 , then the class of transport plans coincides with the class of transport plans of finite cost on the directed locally affine partition of @xmath1379 with quotient map @xmath1273 defined in theorem [ t_partition_e+- ] and , if @xmath1380 , they are moreover of finite cost on the directed partition on @xmath1241 induced by the map @xmath1288 .    in table [ tab_poss_inter ] we put on the horizontal and vertical line the sets of a partition of @xmath1381 .",
    "if @xmath79 is a set belonging to the horizontal line and @xmath1382 belongs to the vertical , in the square @xmath1383 we write @xmath419 in case possibly @xmath1384 , and @xmath615 in case always @xmath1385 .",
    "recall that @xmath1386 , @xmath1387 , @xmath1388 , @xmath1389 , @xmath1390 are disjoint unions .",
    ".the possible intersection of @xmath1391 with a partition of @xmath1392 [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     [ tab_poss_inter ]    first of all , and yield immediately the row of @xmath1393 and the column of @xmath1394 , that we write just for symmetry .",
    "moreover , by remark [ r_t+t - i+e- ] , also the row of @xmath1394 and the column of @xmath1393 easily follow .    in order to prove the other squares we will use the following facts , which have already been proven and used in sections [ ss_partition_transport_set ] and [ ss_analysis_residual_set ] and are a consequence of and definitions and : @xmath1395    let us first prove the relations given by the squares containing the letter @xmath615 .",
    "let @xmath1396 and @xmath1352 .",
    "then , @xmath1397 by and we then conclude that @xmath1398 and by - that @xmath1399 , @xmath1400 .",
    "let us now deal with the relations given by the squares containing the letter @xmath419 .",
    "we refer to figure [ fi_structsubdiff ] .",
    "first we claim that @xmath1401 indeed , let e.g. @xmath1402 such that @xmath1403 and @xmath1352 s.t .",
    "@xmath1404    next we claim that @xmath1405 indeed , it is sufficient to take e.g. @xmath1406 with @xmath1407 and @xmath1408 s.t .",
    "@xmath1409    now let us prove that @xmath1410 take for example @xmath1411 and @xmath1412 as in with @xmath130 maximal face in @xmath1413 containing @xmath1414 .",
    "finally we claim that @xmath1415 hence , by the transitivity property , - immediately give all the remaining @xmath419 squares in the table .    in order to show ,",
    "let @xmath1416 with @xmath1417 then , let @xmath1418 s.t .",
    "@xmath1419    neglecting , we conclude that @xmath1420 = & ~ \\bigl [ \\partial^+ \\theta \\cap \\big ( \\mathcal r \\theta \\times ( \\mathcal r \\theta \\cup \\mathcal e^- \\theta ) \\big ) \\bigr ] \\label{e_subdiff_dec}\\\\ & ~ \\cup \\bigl [ \\partial^+ \\theta \\cap \\big ( ( \\mathcal r^+ \\theta \\cap \\mathcal e^- \\theta ) \\times \\mathcal e^- \\theta \\big ) \\bigr ] \\notag\\\\ & ~ \\cup \\bigl [ \\partial^+ \\theta \\cap ( \\mathcal i^+ \\theta \\times \\mathcal t^- \\theta ) \\bigr].\\notag\\end{aligned}\\ ] ] using , theorem [ t_partition_e+- ] and corollary [ c_v ] we have the following .    [ p_disint_fol ]",
    "let @xmath1421 be a @xmath146-lipschitz foliation and @xmath1422 such that and hold .",
    "if @xmath1378 , then @xmath1423 where @xmath1424 is the locally affine partition induced by @xmath1273 on @xmath1267 and @xmath1425 the related cost , as defined in .    moreover , if @xmath1378 and @xmath1426 then @xmath1427 where @xmath1428 is the locally affine partition induced by @xmath1429 on @xmath1241 and @xmath1430 the related cost",
    ".    we end this section with the following special case .",
    "[ p_hat_bf_d_graph ] let @xmath1431 , @xmath1432",
    ". then holds for the differential directed locally affine partition of the regular set of @xmath1433 @xmath1434    for @xmath1435 , let @xmath1436 where @xmath1437 is the directed locally affine partition of @xmath1438 .",
    "hence , @xmath1439 for some @xmath1440 , @xmath1441 and , since by assumption @xmath395 is constant ( namely , equal to @xmath1137 ) on @xmath1442 , then by definition of superdifferential @xmath1443 by the transitivity property and the fact that @xmath1444 is regular @xmath1445 which implies that @xmath1446 , thus @xmath1447 and @xmath1448 .",
    "hence , by definition of @xmath1288 , @xmath1449 contradicting our initial assumption .    [ r_4.27 ] by proposition [ p_hat_bf_d_graph ] , the differential partition of a single complete @xmath1174-lipschitz graph satisfies .    from proposition [ p_hat_bf_d_graph ] and proposition [ p_dispiani_2 ] ,",
    "one obtains immediately the following    [ c_transp_graph ] if @xmath1022 , @xmath1029 are as in proposition [ p_disint_fol ] and @xmath1378 , @xmath1380 , then @xmath1450 where @xmath1451 , @xmath1452 and @xmath1453 are respectively the disintegrations of @xmath1031 , @xmath1022 , @xmath1029 w.r.t .",
    "the partition induced by @xmath1288 .",
    "in this section we recall , in an abstract and more general setting , the main steps of the disintegration technique first introduced in @xcite for partitions into segments and then extended to locally affine partitions of any dimension in @xcite .",
    "this technique allows to prove the absolute continuity of the conditional probabilities of the lebesgue measure and to deduce that the _ initial _ and _ final points _ of a directed locally affine partition are lebesgue negligible , provided the direction map satisfies a suitable regularity assumption that we call ( _ initial / final _ ) _ forward / backward cone approximation property_. for more details on the proofs of the results contained in this section , we refer to @xcite , section 4 .",
    "we first deal with _ model sets of directed segments _ , namely @xmath12-dimensional sheaf sets whose projection on their reference line is a given segment . at the end of the paragraph , the forward / backward cone approximation property for these model sets will be introduced as a sufficient condition in order to have absolutely continuous disintegrations .",
    "[ d_modeldire_segm ] a _ model set of directed segments _ or _",
    "1-dimensional model set _ is a 1-dimensional directed sheaf set @xmath1454 with @xmath362-continuous direction vector field @xmath1455 and reference line @xmath1456 for which there exist @xmath1457 , @xmath1458 , such that @xmath1459    we will also call _ model set _ the set @xmath1460 , and we say that the triple @xmath1461 is a _ reference configuration_. moreover we assume that @xmath1462 for shortness we will sometimes use the notation @xmath1463 .",
    "we also set @xmath1464 as in @xmath1465 notice that @xmath1466    given a @xmath12-dimensional model set @xmath1454 with reference configuration @xmath1467 , define the perpendicular _ sections _",
    "@xmath1468.\\ ] ] clearly from definition [ d_initial_final ] one has @xmath1469 where @xmath1470 , @xmath1471 are the initial / final points of @xmath1454 .    for all",
    "@xmath1472 $ ] , denote also @xmath1473 where @xmath1474 , @xmath1475 are the multivalued extensions of @xmath1476 defined by @xmath1477    [ l_reg_tt_d_h_pm ] the sets @xmath1478 , @xmath1479 are @xmath362-compact , and hence there exist borel sections @xmath1480    w.l.o.g . , we prove the result only for @xmath1478 .    since @xmath1476 is @xmath362-compact ,",
    "let @xmath1481 such that @xmath1482 are compact and @xmath1483 is continuous .",
    "then it is fairly easy to see that the multivalued maps @xmath1484 are compact , and thus the regularity of @xmath1478 follows .",
    "the existence of sections @xmath1485 , @xmath1486 with borel regularity is standard for compact multifunctions ( see for example theorem 5.2.1 , page 189 of @xcite ) and an easy argument yields the conclusion .",
    "we will define the vector fields    [ e_tilde_tt_d_pm ] @xmath1487 ) , \\ z ' \\in \\dom\\,\\tilde{\\mathtt d}^{h^-}_+,\\ ] ] @xmath1488 ) , \\ z ' \\in \\dom\\,\\tilde{\\mathtt d}^{h^+}_-.\\ ] ]    in particular , @xmath1489 and @xmath1490 define for @xmath1491 , @xmath1492 $ ] the map @xmath1493 which sends each point of the section @xmath1494 in the unique point of @xmath1495 which belongs to the same segment of the model set .",
    "it is a bijection for @xmath1496 , with inverse @xmath1497 .",
    "given borel measurable selections @xmath1498 , as in and , one defines for @xmath1499 ( @xmath1500 $ ] ) , @xmath1492 $ ] the map @xmath1501 notice that @xmath1502 coincides with @xmath1503 for @xmath1504 .",
    "we recall that our problem is the following : if @xmath1505 is the disintegration of @xmath1506 w.r.t .",
    "the partition @xmath53 , then we ask whether @xmath1507 by the next lemma , the absolute continuity problem along the segments @xmath1508 can be reduced to an absolute continuity problem for the push - forward of @xmath1509 on the sections through the maps @xmath1510 .",
    "[ l_equivarea ] let us fix a section @xmath1495 of @xmath1511 , @xmath1496 .",
    "then , the following two statements are equivalent : @xmath1512 @xmath1513    moreover , also the following two statements are equivalent : @xmath1514 @xmath1515    in particular , whenever holds , @xmath1511 is a regular partition according to definition [ d_disint_regular ] .",
    "the proof of lemma [ l_equivarea ] is an application of fubini - tonelli theorem w.r.t .",
    "the projection on @xmath1456 and the change of variables formula for the maps @xmath1510 .",
    "we give a short proof for completeness .",
    "by @xmath1516 for some borel non - negative function @xmath443 , for a.e .",
    "@xmath1517 and thus by fubini - tonelli theorem we can write for a compactly supported function @xmath1518 @xmath1519 ds = \\int_{h^-}^{h^+ } \\bigg [ \\int_{p_t } \\phi(\\sigma^{t , s}(z ) ) d\\big ( \\sigma^{s , t}_\\ # \\mathcal h^{d-1 } \\llcorner_{p_s } \\big)(z ) \\bigg ] ds \\crcr = & ~ \\int_{h^-}^{h^+ } \\bigg [ \\int_{p_t } \\phi(\\sigma^{t , s}(z ) ) \\mathtt f(s , t , z ) d\\mathcal h^{d-1}(z ) \\bigg ] ds = \\int_{p_t } \\bigg [ \\int_{h^-}^{h^+ } \\phi(\\sigma^{t , s}(z ) ) \\mathtt f(s , t , z ) ds \\bigg ] d\\mathcal h^{d-1}(z ) .",
    "\\end{split}\\ ] ] by the uniqueness of the disintegration ( see theorem [ t_disint ] ) , this shows that is true . repeating the argument starting from the end",
    ", one can prove the equivalence of and .    by using the additional assumption ,",
    "@xmath1520 is @xmath1509-a.e .",
    "strictly positive on @xmath1495 , for a.e .",
    "@xmath1521 and the equivalence of with follows immediately .",
    "now we are ready to introduce the forward / backward cone approximation properties , which will imply the assumptions of lemma [ l_equivarea ] . for notational convenience",
    ", we will state the definition of cone vector field .",
    "[ d_cone_vector ] the _ cone vector field _ with base in @xmath1522 , and vertex @xmath1523 is defined as @xmath1524 we say that @xmath1476 is a _ finite union of cone vector fields _ with base in @xmath1525 and vertices in @xmath1526 if there exist finitely many cone vector fields @xmath1527 with bases in @xmath1525 and vertices @xmath1528 in @xmath1529 such that the sets @xmath1530 , z \\in \\mathrm{dom}\\ , \\mathtt",
    "d_i \\big\\ } , \\quad i = 1,\\dots , i,\\ ] ] satisfy @xmath1531 , for all @xmath1532 .",
    "[ d_forw_back ] we say that the model set of directed segments @xmath1463 has the _ forward cone approximation property _ if there exists @xmath1533 such that for all @xmath1496 there exists @xmath1534 finite union of cone vector fields with base in @xmath1535 and vertices in @xmath1536 such that @xmath1537 and @xmath1538 @xmath1539-a.e ..    analogously , we say that the model set of directed segments @xmath1540 has the _ backward cone approximation property _",
    "if there exists @xmath1533 such that for all @xmath1496 there exists @xmath1534 finite union of cone vector fields with base in @xmath1535 and vertices in @xmath1541 such that @xmath1537 and @xmath1542 @xmath1539-a.e ..    [ l_forward_esti_area ] if @xmath1463 has the forward cone approximation property , then for @xmath1543 @xmath1544    analogously , if @xmath1463 has the backward cone approximation property , then for @xmath1545 @xmath1546    we prove only the first estimate , since the proof of the second is completely similar .",
    "it is fairly easy to see that the estimates hold for the map @xmath1510 associated to a cone vector field with bases in @xmath1494 and vertices in @xmath1547 as in definition [ d_cone_vector ] by similitude criteria for triangles or equivalently by the polar change of coordinates in @xmath4 .",
    "hence , the same estimate holds also for the finite unions of cone vector fields approximating @xmath1548 as in definition [ d_forw_back ] .    restricting by egorov s theorem to continuous and uniformly convergent sequences @xmath1549 on compact subsets of @xmath1494 , by the u.s.c . of @xmath1509 on the hyperplanes perpendicular to @xmath1550 w.r.t .",
    "the hausdorff convergence of compact sets , the inequality immediately passes to the limit .",
    "it is straightforward to observe that implies and implies the first part of .",
    "hence we have the following    [ c_disinte_ac ] if @xmath1463 has either the forward cone approximation property or the backward cone approximation property , then @xmath1551    if both the forward cone approximation and the backward cone approximation properties hold , then @xmath1511 is a regular partition , i.e. @xmath1552    we can extend the forward / backward cone approximation properties to borel sections of initial / final points .",
    "this will be useful later ( see theorem [ t_fc_no_initial ] ) , when we will give conditions ensuring that @xmath1553/@xmath1554 for a directed locally affine partition @xmath1555 .",
    "[ d_initial_forward ] we say that @xmath1463 satisfies the _ initial forward cone approximation property _ if there exists a borel section @xmath1556 which satisfies the assumptions of the forward cone approximation property of definition [ d_forw_back ] for all @xmath1557 .",
    "similarly , @xmath1463 satisfies the _ final backward cone approximation property _",
    "if there exists a borel section @xmath1558 which satisfies the assumptions of the backward cone approximation property of definition [ d_forw_back ] for all @xmath1559 $ ] .",
    "the next lemma is the analogue of lemma [ l_forward_esti_area ] for the borel sections @xmath1498 .",
    "[ cinfin ] if @xmath1463 satisfies the initial ( final ) forward ( backward ) cone approximation property , then ( resp . ) holds for @xmath1560 ( @xmath1561 ) , for all @xmath1562 ( resp .",
    "@xmath1563 ) .      in this section",
    "we extend the results for @xmath12-dimensional model sets to the @xmath16-dimensional model sets defined below .",
    "[ d_k_dim_model ] a _",
    "@xmath16-dimensional model set _ is a @xmath16-dimensional directed sheaf set @xmath1564 with reference plane @xmath1565 , for which there exist @xmath1566 , @xmath1567 , with @xmath1568 for all @xmath1569 , such that @xmath1570    we will also call",
    "_ @xmath16-dimensional model set _ the set @xmath1571 .",
    "setting @xmath1572 for the direction map , sometimes we will use the more precise notation @xmath1573 and we say that the @xmath1574-tuple @xmath1575 is a _ reference configuration _ for the model set .    the absolute continuity problem for the disintegration of the lebesgue measure on a @xmath16-dimensional model set @xmath1576 can be reduced to the absolute continuity problem for @xmath12-dimensional model sets obtained cutting @xmath1576 with suitable @xmath387-dimensional planes , called _",
    "slices_.    indeed , for all @xmath1577 and @xmath1578 , set    @xmath1579    @xmath1580    [ d_1_sim_slice ] given a @xmath16-dimensional model set @xmath1581 we define _",
    "@xmath12-dimensional slice _ of @xmath1576 in the direction @xmath1582 any set of the form @xmath1583    the important observation is the following :    [ prop_1dim_slice ] by and point @xmath627 of definition [ d_sheaf_set ] , the @xmath12-dimensional slice is a model set of directed segments in the @xmath1584-dimensional space @xmath1585 with direction vector field @xmath1586 quotient space @xmath966 and reference configuration @xmath1587 .    as a consequence",
    "we obtain the following @xmath16-dimensional version of lemma [ l_forward_esti_area ] .",
    "[ l_one_d_slicing_fc ] if the forward ( or backward ) cone approximation property holds for all the @xmath12-dimensional slices of a @xmath16-dimensional model set @xmath1576 in the directions @xmath1588 , then @xmath1589 if both the forward and the backward properties hold for all the above slices , then @xmath1576 is regular , namely @xmath1590    w.l.o.g .",
    "we assume @xmath1591 to be the first @xmath16 unit vectors of a standard orthonormal base in @xmath4 , @xmath1592 @xmath1593 , and @xmath1594 .    for @xmath1595 ,",
    "consider the @xmath12-dimensional slice @xmath1596    by fubini - tonelli theorem @xmath1597 and applying lemma [ l_forward_esti_area ] in the case of forward ( or backward ) approximation property , we obtain the disintegration @xmath1598    now one repeats the procedure starting with the measure @xmath1599 restricted to the @xmath327-dimensional model set in @xmath1600 given by @xmath1601 and considering directions along @xmath1602 , which allows to write @xmath1603 hence by composing the two disintegrations one obtains @xmath1604 iterating the process @xmath16-times , one obtains the result . in case both approximation properties holds , the same analysis shows .",
    "now we apply the cone approximation property technique also to general @xmath16-directed sheaf sets .",
    "let @xmath1564 be a @xmath16-directed sheaf set with reference plane @xmath1605 , base rectangle @xmath1606 and direction map @xmath1607 for @xmath1608 @xmath362-compact , set @xmath1609    [ d_mathcal_d_cyl ] any @xmath16-dimensional model set @xmath1610 of the form @xmath1611 for which there exists @xmath1612 such that @xmath1613 is also a @xmath16-dimensional model set , will be called _",
    "@xmath16-dimensional @xmath1614-cylinder_.    in particular , by the above definition and definition [ d_k_dim_model ] @xmath1615    [ r_property ] notice that , since any @xmath107 is a relatively open set , then the sheaf set can be covered by a countable disjoint collection of @xmath16-dimensional @xmath1614-cylinders @xmath1616 up to the points which belong to the perpendicular sections @xmath1617 in particular , the @xmath16-dimensional @xmath1614-cylinders as in define a partition of the sheaf set @xmath1618 up to an @xmath523-negligible set .",
    "[ d_1_dim_slice_sheaf ] define _",
    "@xmath12-dimensional slices _ of a directed locally affine partition @xmath1619 the @xmath12-dimensional slices of any of the @xmath16-dimensional @xmath1614-cylinders given by , for any of the countably many @xmath16-directed sheaf sets @xmath1576 given by proposition .    [ r_slice0 ] notice that , for any @xmath12-dimensional slice of a @xmath1614-cylinder @xmath1620 as in , there exists @xmath1621 such that the set @xmath1622 is still a @xmath12-dimensional model set .",
    "this assures that the extreme points of the segments of the slice do not contain relative boundary points of the sets of the partition , and in particular the vector field @xmath1623 is single - valued up to the boundary of @xmath1624 .",
    "the main result of this section is then the following theorem .",
    "[ t_one_d_slicing_fc ] if either the forward cone approximation property or the backward cone approximation property holds for the @xmath12-dimensional slices of a directed locally affine partition @xmath1625 , then @xmath1626    if both properties hold , then @xmath1576 is regular , i.e. @xmath1627    by proposition [ p_countable_partition_in_reference_directed_planes ] and remark [ r_property ] , using a simple covering argument and @xmath362-additivity of measures one can reduce to study the absolute continuity of the disintegrations on @xmath1614-cylinders .",
    "then , by definition [ d_1_dim_slice_sheaf ] , one concludes using lemma [ l_one_d_slicing_fc ] .",
    "now we deal with the other measure - theoretic problem connected to directed locally affine partitions , namely to establish whether @xmath1628 it turns out that these properties are implied by the validity of the initial / final cone approximation properties for _ initial / final @xmath12-dimensional slices_.    [ l_init_fin_1_dim_slice ] an _ initial @xmath12-dimensional slice _ of a directed locally affine partition @xmath1619 is a @xmath12-dimensional model set of the form @xmath1629 for a @xmath16-directed sheaf set @xmath1630 with reference plane @xmath1631 , @xmath1632 , for which there exists @xmath1533 such that the set @xmath1633 is still a @xmath12-dimensional model set .",
    "similarly , a _",
    "final @xmath12-dimensional slice _ of a directed locally affine partition @xmath1619 is a @xmath12-dimensional model set of the form @xmath1634 for which there exists @xmath1612 such that the set @xmath1635 is still a @xmath12-dimensional model set .    by remark [ r_slice0 ]",
    ", the vector field @xmath1636 of an initial slice can be multivalued only at the points of the section @xmath1637 , while for a final slice it can be multivalued only on @xmath1638 .",
    "[ r_infinslices ] notice that a @xmath12-dimensional slice of a directed locally affine partition according to definition [ d_1_dim_slice_sheaf ] is both an initial / final @xmath12-dimensional slice .",
    "in particular , since the direction vector field of a @xmath12-dimensional slice is single - valued , its borel - measurable sections coincide trivially with itself and then the initial / final forward / backward cone approximation properties ( see definition [ d_initial_forward ] ) are simply an extension of the forward / backward cone approximation property ( see definition [ d_forw_back ] ) to the initial / final points of the slice . hence , saying that the initial / final @xmath12-dimensional slices of a directed locally affine partition satisfy the initial forward / final backward cone approximation property implies that the @xmath12-dimensional slices of that directed locally affine partition satisfy the forward / backward cone approximation property .",
    "the following theorem follows from corollary [ cinfin ] , as in the density lemma 4.19 proved in @xcite for the relative boundary points of the locally affine partition into the faces of a convex function .",
    "[ t_fc_no_initial ] if the initial @xmath12-dimensional slices of a directed locally affine partition satisfy the initial forward cone approximation property , then @xmath1639    similarly , if the final @xmath12-dimensional slices of a directed locally affine partition satisfy the final backward cone approximation property , then @xmath1640    we give only a sketch of the proof , since the details have already been given in lemma 4.19 of @xcite .",
    "we can restrict to a @xmath16-directed sheaf set @xmath1641 with reference @xmath16-plane @xmath1642 .",
    "let us then consider the map @xmath1643 by definition [ d_initial_final ] , @xmath1644 for all @xmath1645 , and then by a countable covering argument we need only to prove the negligibility of the set @xmath1646 with @xmath1647 fixed .",
    "assume that @xmath1648 and that @xmath1649 is a lebesgue point of @xmath1650 .",
    "then if @xmath1632 , at least one of the sets @xmath1651 has @xmath1652-positive measure , and we can assume that @xmath1444 is also a lebesgue point for @xmath1653 . for definiteness , we will assume that @xmath1654 for some @xmath1655 in the relative interior of the base rectangle of @xmath1656 , and let @xmath1657 be the multivalued maps defined in for the @xmath12-dimensional slice @xmath1658 defined by @xmath1659 where @xmath1660 is the sets of @xmath148 such that @xmath107 has an initial point @xmath140 on @xmath1661 and @xmath1662    if @xmath1485 is a borel section of @xmath1663 chosen accordingly to definition [ d_initial_forward ] , then consider the @xmath12-dimensional slice @xmath1664 defined by @xmath1665 where @xmath1666 is the set of @xmath148 satisfying @xmath1667 in other words , @xmath1668 is the @xmath12-dimensional slice whose initial points belong to @xmath1669 and whose segments are given by @xmath1670 , where @xmath1556 was defined in .",
    "clearly , by restricting to a @xmath362-compact @xmath1652-conegligible subset of @xmath1661 so that @xmath1671 is @xmath362-continuous , this procedure defines an initial @xmath12-dimensional slice .    by the initial forward cone approximation property , lemma [ cinfin ]",
    "implies that if @xmath1672 is a lebesgue point of @xmath1673 , then @xmath1674 = 1.\\ ] ] since @xmath1675 , this clearly contradicts the fact that @xmath1444 is a lebesgue point of @xmath1650 .    in view of theorems [ t_one_d_slicing_fc ] and [ t_fc_no_initial ] and recalling remark [ r_infinslices ] , for future convenience we give the following    [ d_coneapprpart ] a directed locally affine partition satisfies the ( initial / final ) forward / backward cone approximation property if its ( initial / final ) @xmath12-dimensional slices satisfy the ( initial / final ) forward / backward cone approximation property .",
    "this section is devoted to the proof of theorem [ t_1 ] , which we recall below .",
    "let @xmath177 with @xmath19 and let @xmath0 be a convex norm in @xmath4 .",
    "then there exists a locally affine directed partition @xmath178 in @xmath4 with the following properties :    1 .   for all @xmath161 the cone @xmath108 is a @xmath16-dimensional extremal face of @xmath0 ; 2 .",
    "@xmath1676 ; 3 .",
    "@xmath180 is regular , namely the disintegration of the measure @xmath5 w.r.t .",
    "the partition @xmath180 , @xmath181 , satisfies @xmath1677 4 .",
    "[ point_4_t_1_h ] for all @xmath183 , the disintegration @xmath184 w.r.t .",
    "the partition @xmath185 satisfies @xmath1678 where @xmath187 is the disintegration w.r.t .",
    "the partition @xmath180 , and moreover @xmath188    if also @xmath189 , then for all @xmath190 @xmath191 where @xmath192 is the disintegration w.r.t .",
    "the partition @xmath180 , and the converse of point holds : @xmath1679    we start the proof by recalling that , by proposition [ p_equivalence_lifting ] , @xmath1680 where @xmath40 is the @xmath0-lipschitz function given by a kantorovich potential and @xmath118 , @xmath119 , @xmath1681 are the push - forwards of @xmath2 , @xmath3 , @xmath36 on @xmath116 through the map @xmath1682 .    by remark [ r_lipgraph ] , @xmath1683 is a _",
    "complete @xmath117-lipschitz graph _ , according to definition [ d_complete_g ] .",
    "then , by proposition [ p_ex_fol ] , call @xmath1684 the trivial @xmath146-lipschitz foliation on @xmath116 associated to @xmath120 .",
    "we now show that theorem [ t_1 ] follows from , thanks to the results of sections [ s_foliations ] and [ s_disintechnique ] and the following theorem .",
    "[ t_cone_graph ] let @xmath785 be a complete @xmath117-lipschitz graph .",
    "then , the superdifferential partition satisfies the initial forward cone approximation property and the subdifferential partition satisfies the final backward approximation property .    indeed , recalling definition [ d_coneapprpart ] , first notice that if theorem [ t_cone_graph ] holds , then by theorem [ t_fc_no_initial ] @xmath1685 moreover , by remark [ r_infinslices ] and the fact that @xmath1686 ( see ) , theorem [ t_one_d_slicing_fc ] implies that the disintegration of the @xmath22-dimensional hausdorff measure on the differential partition @xmath1687 of @xmath1688 is regular , namely has conditional probabilities equivalent to the hausdorff measures on the locally affine sets on which they are concentrated .",
    "therefore , denoting the locally affine partition @xmath1687 as @xmath1689 and setting @xmath1690 for the @xmath175-dimensional partition of the fixed points @xmath1691 , by the sets @xmath1692 define a locally affine directed partition of @xmath1693 satisfying @xmath626 , @xmath1006 and @xmath627 .",
    "let us now use the fact that @xmath1694 is a kantorovich potential for @xmath755 and that @xmath1695 . by and",
    ", @xmath1696 then , by remark [ r_4.27 ] , proposition [ p_disint_fol ] applies to the locally affine partition @xmath1697 , giving that any transport plan @xmath1681 as in satisfies @xmath1698 . in particular , by proposition [ p_dispiani ] , the disintegration @xmath1699 w.r.t .",
    "the partition @xmath1700 satisfies @xmath1701 where @xmath1702 is the disintegration w.r.t .",
    "the partition @xmath1703 .",
    "moreover , by proposition [ p_hat_bf_d_graph ] , the partition @xmath1703 satisfies condition , which gives @xmath1704 then it is not difficult to see that the directed locally affine partition of @xmath4 given by @xmath1705 satisfies also point @xmath1007 of theorem [ t_1 ] . finally , if @xmath71 , by and we have also @xmath1706 then @xmath1707 and corollary [ c_transp_graph ] gives , when projected on @xmath4 , the last part of theorem [ t_1 ] .",
    "[ e_more_nat_form ] observe that the characterization given by proposition [ p_disint_fol ] of the optimal transport plans for the @xmath117-lipschitz set @xmath120 seems more natural than the one given by theorem [ t_1 ] for their projections on @xmath4 , namely the optimal transport plans for the original convex norm problem . indeed , in the first case we have a complete ( namely , if and only if ) geometric characterization of the transport plans by disintegrations into transport plans of finite cone cost w.r.t .",
    "their conditional marginals , even in the case in which @xmath3 is not absolutely continuous .",
    "this is due to the geometric condition , which is satisfied by the partition @xmath1708 and not by its projection on @xmath4 .",
    "in particular , there might be decompositions @xmath1709 of @xmath3 which are not obtained by projections of second marginals of disintegrations of @xmath1710 and such that @xmath1711 .    the proof will be given in two steps .",
    "we prove the initial forward cone approximation property for the superdifferential partition of the forward regular set , being the proof of the final backward cone approximation property for the subdifferential partition analogous .    by definition [ d_coneapprpart ] , let us consider an initial @xmath12-dimensional slice @xmath1712 where    1 .",
    "@xmath1713 reference plane of the sheaf set @xmath1714 , 2 .",
    "@xmath1715 , 3 .",
    "there exists @xmath1716 for which @xmath1717 is still a @xmath12-dimensional model set .",
    "let @xmath1636 be the direction vector field .",
    "_ step 1 . _",
    "assume @xmath1718 is injective .",
    "then , it is sufficient to prove the forward cone approximation property for the vector field @xmath1636 on a fixed perpendicular section , say e.g. @xmath1637 .",
    "first recall that , by the general properties of sheaf sets , i.e. point @xmath627 of definition [ d_sheaf_set ] , @xmath1719 by definition of @xmath12-dimensional slice , for all @xmath1720 one has @xmath1721 being @xmath1722 the unique point s.t .",
    "@xmath1723 since now we are dealing with the superdifferential partition , ( see theorems [ t_partition_e+- ] and [ t_partition_e ] ) for all @xmath1724 @xmath1725 then we conclude that @xmath1726 is the unique point of @xmath1727 s.t .",
    "@xmath1728 namely @xmath1729 is the unique maximizer of @xmath1730    hence one can construct the finite cone approximations of @xmath1731 as in @xcite , namely discretizing the set @xmath1727 and taking the cones given by the differential partition of an optimal potential w.r.t . a strictly convex cost obtained by perturbating the norm cost @xmath0 and whose second marginals are dirac deltas centered at the points of the discretization ( see @xcite ) . the convergence of the approximations to @xmath1732 at a.e .",
    "point @xmath1733 as the cost perturbation goes to @xmath175 and the points of the discretization become dense is given by the uniqueness of the @xmath1734 satisfying .",
    "lifting the approximating cones with the map @xmath1735 , one gets finite cones approximations of @xmath1736 as required .",
    "_ let now @xmath1718 be possibly multivalued . in order to prove the initial forward cone approximation property , we build as in step 1 finite cone approximations given by the differential partition of optimal potentials w.r.t .",
    "strictly convex approximating costs and second marginals given by dirac deltas in @xmath1727 .",
    "these will converge to a borel section @xmath1737 of the direction vector field @xmath1718 which by construction satisfies the cone approximation property .",
    "[ r_part_case_th7 ] the above theorem can also be proved as a particular case of the analysis done in section [ s_cone_approx_folia ] : in this case we have a single cone - lipschitz graph , and the uniqueness role of the linear order is trivial .",
    "this section is devoted to the proof of theorem [ t_cfibrcfol ] stated below , that will be the building block for proving of theorem [ t_subpart_step ] .",
    "let @xmath1738 be the @xmath362-compact direction map of a @xmath16-dimensional fibration @xmath1739 and @xmath1740 be the associated cost function .",
    "let @xmath1741 be probability measures on @xmath4 such that @xmath1742 and @xmath1743    recall definition [ d_compatible ] of @xmath749-compatible preorder , definition [ d_pimunuconn ] of @xmath366-cyclically connected partition and let @xmath1744 be the polish space of sequences in @xmath1745 endowed with the product topology .",
    "our main result is the following theorem .",
    "recall that @xmath413 is the first countable ordinal .",
    "[ t_cfibrcfol ] if and hold , then there exists a @xmath1746-compatible linear preorder @xmath1747 with borel graph on @xmath1119 @xmath1748 and equivalence classes @xmath1749 such that the subcollection of sets @xmath1750 defined by @xmath1751 is @xmath1752-cyclically connected .",
    "as noticed in proposition [ p_ex_fol ] , the equivalence classes of a @xmath1740-compatible linear preorder on @xmath384 with @xmath362-compact graph form a @xmath1740-lipschitz foliation .",
    "then , by definition of @xmath1746-compatible linear preorder and by disintegration of measures , theorem [ t_cfibrcfol ] claims that we can reduce the optimal transportation problem on a @xmath1753-fibration to a family of optimal transportation problems on the level sets of a @xmath1740-lipschitz foliation , whose @xmath16-dimensional classes of positive @xmath1754 measure ( see the characterization of @xmath1740-lipschitz foliations given in proposition [ p_fol_char ] ) satisfy the cyclically connectedness property w.r.t . @xmath1755 .    as noticed in the proposition [ p_ex_fol ] , since @xmath1756",
    "the equivalence classes of the preorder @xmath1747 constructed in theorem [ t_cfibrcfol ] will be contained in sections @xmath385 . at a first reading ,",
    "the geometry which lies behind the construction of @xmath1757 will be clear to the reader even assuming that @xmath1177 for some point @xmath1758 , and thus @xmath1740 is equal to a single convex cone cost .",
    "the variable @xmath301 plays in fact the role of a parameter on which the maps used to define the preorder have to depend in a suitably measurable way .    as a preliminary ,",
    "let us define the sets of @xmath362-compact _ carriages _ as follows : for @xmath1759 set @xmath1760 and define @xmath1761 the section of a carriage @xmath1762 will be also denoted as @xmath1763 .",
    "the main result of this section , which is the first step of the proof of theorem [ t_cfibrcfol ] , is the following theorem",
    ".    [ t_order_gamma ] for any @xmath1764 there exists a @xmath1746-compatible linear preorder @xmath1765 with borel graph @xmath1766 whose equivalence classes @xmath1767 satisfy @xmath1768    by the characterization of @xmath1740-lipschitz foliations given in proposition [ p_fol_char ] , must refer to @xmath16-dimensional equivalence classes .",
    "moreover , by remark [ rem_pre ] , @xmath1769 and then @xmath1770 the @xmath1771-cycle connecting @xmath62 to @xmath309 must be contained in @xmath1772 .",
    "the first step to prove theorem [ t_order_gamma ] is to select an @xmath1773-conegligible set @xmath1774 and a @xmath362-compact subset of @xmath1775 with @xmath148-sections countable and dense in @xmath1776 .",
    "[ l_z_n_dense_selections ] there exist an @xmath1773-conegligible @xmath362-compact set @xmath1777 and a countable family @xmath1778 of @xmath362-continuous functions @xmath1779 , @xmath897 , such that for all @xmath1780 @xmath1781    for shortness we use the notation @xmath1782    _ step 1 .",
    "_ let @xmath1783 and fix @xmath1716 . by standard selection theorems ( for example , theorem 5.2.1 of @xcite is sufficient in this setting )",
    ", there exists @xmath1784 borel such that @xmath1785 . by lusin theorem",
    "( 134 yd of @xcite ) we obtain an @xmath1773-conegligible set @xmath1786 such that @xmath1787 is @xmath362-continuous .",
    "define @xmath1788 these are clearly borel sets .",
    "let @xmath1789 , and define @xmath1790 as a @xmath362-compact set with the same @xmath1773-measure of @xmath1791 .",
    "if the borel set @xmath1792 and souslin set @xmath1793 are given , let @xmath1794 be a @xmath540-measurable selection s.t .",
    "@xmath1795 , where @xmath540 is the @xmath362-algebra generated by souslin sets : its existence is guaranteed by theorem 5.5.2 of @xcite . as in step 1 , find an @xmath1773-conegligible set @xmath1796 such that @xmath1797 is @xmath362-continuous . define the borel sets @xmath1798 if @xmath1799 , let @xmath1800 be a @xmath362-compact set with the same measure of @xmath1801 .",
    "extend also the @xmath362-compact function @xmath1802 to an @xmath1773-conegligible set by @xmath1803    _ step 3 .",
    "_ by repeating the above procedure countably many times , we obtain a countable family of @xmath362-continuous functions @xmath1804 , @xmath1805 , such that @xmath1806 taking a countable sequence @xmath1807 as @xmath1808 , the functions @xmath1809 satisfy clearly the statement when restricted to an @xmath1773-conegligible @xmath362-compact subset @xmath1810 of @xmath1811 .",
    "now we associate to each @xmath1812 the subset of @xmath385 of all the points @xmath1813 s.t .",
    "@xmath684 an axial path of finite @xmath1740-cost in @xmath1814 going from @xmath1815 to @xmath1813 ( see definition [ d_axpath ] ) .",
    "define @xmath1816 where @xmath1817 is the @xmath1818-axial preorder relation defined in .",
    "notice that @xmath1819 observe that , despite the notation , @xmath1820 does not depend only on @xmath1814 but also on the sections @xmath1821 selected in lemma [ l_z_n_dense_selections ] .",
    "[ p_hn_sigma_cpt_compatibility ] the set @xmath1820 is @xmath362-compact in @xmath1822 and the set @xmath1823 is borel .",
    "moreover @xmath1824    we prove the @xmath362-compactness of @xmath1820 , since is clear from the definition . observing that @xmath1825",
    "write @xmath1826 and @xmath1827 is given by @xmath1828 \\cap",
    "\\bigg [ \\bigcap_{i=1}^{i } \\big\\ { { \\mathtt c}_{\\c^k}(\\mathfrak a_{i+1},w_{i+1},\\mathfrak a'_{i},w'_{i } ) < \\infty \\big\\ } \\bigg].\\end{aligned}\\ ] ] since @xmath1829 is @xmath362-continuous , it follows that the set @xmath1830 is @xmath362-compact in @xmath1831 .",
    "hence , being @xmath1832 @xmath362-continuous and @xmath1833 @xmath362-compact , the set @xmath1834 is @xmath362-compact , thus also @xmath1835 , and finally @xmath1820 too .",
    "we are now ready to define the borel linear preorder of theorem [ t_order_gamma ] .",
    "if @xmath1836 is the countable family of sections constructed in lemma [ l_z_n_dense_selections ] , define the function @xmath1837 since each component @xmath1838 of @xmath1839 is borel , also @xmath1839 is borel in the product topology .    on the space @xmath1840 , @xmath1841 ordinal number ,",
    "let us consider the natural linear order given by the lexicographic order .",
    "namely , for @xmath1842 set @xmath1843 and define @xmath1844 let then @xmath1845 be the lexicographic linear order on @xmath1846 and define the linear preorder on @xmath1847 as @xmath1848 the induced equivalence relation on @xmath1849 is given by @xmath1850    the proof is given in two steps .",
    "_ in this step we prove that the relation @xmath1851 defined in is a @xmath1852-compatible linear preorder with borel graph . by remark [ rem_pre ] , this amounts to prove that @xmath1851 is borel , @xmath1740-compatible and holds for the carriage @xmath1814 .",
    "first of all , @xmath1851 is borel because it is the preimage under @xmath1839 , which is a borel map , of the lexicographic order @xmath1845 .    moreover @xmath1853 i.e. @xmath1851 is @xmath1740-compatible .",
    "formula follows directly from .",
    "_ now we prove .",
    "let @xmath1854 since @xmath1851 is @xmath1740-compatible , by proposition [ p_ex_fol ] its equivalence classes form a @xmath1740-lipschitz foliation and then , from point of proposition [ p_fol_char ] , there exists @xmath406 such that @xmath1855 hence , by the density of @xmath1856 stated in lemma [ l_z_n_dense_selections ] , there exist @xmath1857 , @xmath1858 such that @xmath1859 the first condition in implies that @xmath1860 the second condition implies that @xmath1861 hence , composing the three axial paths , @xmath1862 , and exchanging their roles we obtain a @xmath1863-cycle , thus concluding the proof .",
    "notice that actually the subset of a @xmath16-dimensional class @xmath1864 which is contained in the @xmath1865-cycle above is @xmath1866 in fact , by every couple of points @xmath1042 , @xmath155 in the above set satisfy for some @xmath1857 , @xmath1858 .",
    "now we apply theorem [ t_minimal_equival ] to the class of linear preorders @xmath1867 constructed in theorem [ t_order_gamma ] , in order to find a borel @xmath1868-compatible linear preorder as in theorem [ t_cfibrcfol ] .",
    "recall the definition of lexicographic order @xmath1869 on @xmath1870 , @xmath1841 ordinal number , given in , and recall also the definition of closure under countable intersection of a family of equivalence relations , definition [ d_clos_sigma_e ] and remark [ r_min_contain_e ] .",
    "[ p_equiv_coun ] the class of equivalence relations @xmath1871 is closed under countable intersections .",
    "let @xmath1872 and @xmath1873 be a countable family of @xmath1874-compatible borel linear preorders as in theorem [ t_order_gamma ] .",
    "fix @xmath1875 for some @xmath1876 . by definition [ d_cmunucomp ] of @xmath1874-compatibility , @xmath1877 and by remark [ rem_pre ]",
    "@xmath1878 let then @xmath1879 be a countable family of @xmath362-compact sections of @xmath1880 as in lemma [ l_z_n_dense_selections ] .",
    "then , by , it follows immediately that the @xmath1874-compatible borel linear preorder @xmath1881 constructed as in the proof of theorem [ t_order_gamma ] satisfies @xmath1882    we now have all the tools to prove theorem [ t_cfibrcfol ] .",
    "let @xmath1883 be the minimal equivalence relation in the class w.r.t .",
    "the measure @xmath1884 , whose existence is guaranteed by theorem [ t_minimal_equival ] .    we claim that it satisfies the conclusions of theorem [ t_cfibrcfol ] .",
    "thanks to theorem [ t_order_gamma ] , we only have to prove .",
    "recalling definitions [ d_pimunuconn ] and [ d_gammaconn ] , let @xmath1885 , @xmath1886 . by remark [ rem_pre ] , we can consider the carriage @xmath1887 and prove that the subcollection @xmath1750 of the equivalence classes of @xmath1757 defined by @xmath1888 is @xmath1889-cyclically connected .",
    "let @xmath1890 be a countable family of @xmath362-compact sections of @xmath1891 as in lemma [ l_z_n_dense_selections ] .",
    "hence , by , reasoning as in the proof of proposition [ p_equiv_coun ] , the equivalence classes of @xmath1892 are contained in those of @xmath1747 . by minimality of @xmath1893 and",
    "corollary [ c_constant_for_minimal_equivalence ] , there exists a @xmath1884-conegligible @xmath362-compact set @xmath1894 and a borel function @xmath1895 such that @xmath1896 the set @xmath1897 depends on @xmath1898 .    in particular",
    ", using this result for the equivalence classes of positive @xmath1899-measure of @xmath1900 , we deduce that there exists a set @xmath1901 such that @xmath1902 and for all @xmath1903 , for all @xmath1137 such that @xmath1904 , the function @xmath1905 is @xmath1754-a.e .",
    "constant on @xmath1893 .",
    "hence , using the assumption and condition for @xmath1892 , the sets @xmath1893 with @xmath1903 and of positive @xmath1899 measure are open ( see proposition [ p_fol_char ] ) and their set of lebesgue points is of full @xmath1899-measure and @xmath1906-cyclically connected .    by definition",
    "[ d_gammaconn ] , we thus conclude that these sets are @xmath1907-cyclically connected , and then applying the same reasoning to any transference plan @xmath1908 , we get that the subcollection of sets @xmath1750 defined by @xmath1909 is @xmath1752-cyclically connected , thus concluding the proof .",
    "[ r_why_this_meth ] we observe here that , being the equivalence relation @xmath1910 constructed in theorem [ t_cfibrcfol ] minimal in the family , by theorem [ t_minimal_equival ] the equivalence classes can not be further decomposed by equivalence relations of the form .",
    "however , the information on cyclical connectedness of the equivalence classes can be deduced only for the equivalence classes with positive @xmath1911-measure , because of the particular choice of the family satisfying theorem [ t_order_gamma ] .",
    "in this section we prove the following result .",
    "[ t_coneappr_fol ] let @xmath1912 , @xmath1913 , be a @xmath146-lipschitz foliation given by the equivalence classes of a borel @xmath1914-compatible linear preorder @xmath1163 on @xmath978 as in .",
    "then for all @xmath569 , the subdifferential partition of @xmath1915 satisfies the initial forward cone approximation property and the subdifferential partition of @xmath1916 satisfies the final backward cone approximation property .",
    "in particular , we conclude from theorem [ t_fc_no_initial ] that the initial and final points @xmath1917 , @xmath1918 are @xmath164-negligible and , by integration w.r.t . @xmath1652 on @xmath386 , the sets @xmath1919 , @xmath1920 are also @xmath5-negligible . moreover , by theorem [ t_one_d_slicing_fc ] , the disintegration of @xmath5 w.r.t . the differential partition of the regular set @xmath1241 is _ regular _ , i.e. it satisfies of definition [ d_disint_regular ] .",
    "since the disintegration of @xmath164 on equivalence classes of @xmath395 with positive @xmath164-measure is clearly regular , we thus have the following corollary .",
    "[ c_infinnegl ] if @xmath1921 is the partition of a @xmath146-lipschitz foliation given by the equivalence classes of a borel @xmath1914-compatible linear preorder obtained as the union of the differential partition and of the classes of positive @xmath164-measure , then the disintegration of the lebesgue measure @xmath523 restricted on the @xmath146-lipschitz foliation @xmath1922 satisfies @xmath1923    [ r_contin_quotient ] if the quotient set @xmath1924 is chosen to be a countable union of sets as in , then the quotient measure @xmath1925 satisfies @xmath1926 for some @xmath1927 .    in the following we identify @xmath385 with @xmath300 and",
    "omit the variable @xmath148 when clear from the context .",
    "unless explicitly stated , for the notions and notations used in the proof we refer to section [ s_disintechnique ] . since the proof of the initial forward cone approximation property is the same as the forward cone approximation property up to the borel selection given by lemma [ l_reg_tt_d_h_pm ] , for simplicity we prove the forward cone approximation property .",
    "the proof will be given in three steps , and we will restrict to the case of @xmath1928 , due to the structure of equivalence classes of positive @xmath164-measure given in proposition [ p_fol_char ] and the existence of at most two degenerate equivalence classes ( see definition [ d_non_dege ] ) , which are clearly of positive measure , as observed in remark [ r_nondeg ] .",
    "_ by definitions [ d_coneapprpart ] and [ d_1_dim_slice_sheaf ] , we have to prove the forward cone approximation property for the @xmath12-dimensional slices @xmath1614-cylinder ( see definition [ d_mathcal_d_cyl ] ) of the superdifferential partition of @xmath1915 ( @xmath1929 ) given by @xmath1930 with reference plane @xmath1931 and base rectangle @xmath1932 . by",
    ", the set @xmath1933 is a subset of @xmath1934 for some @xmath1935 .",
    "let us fix a @xmath12-dimensional slice of @xmath1936 with reference configuration @xmath1937 , @xmath1938 , @xmath1939 ( see definition [ d_1_sim_slice ] ) , i.e. @xmath1940 with @xmath1941 such that the set @xmath1942 is still a @xmath12-dimensional model set .",
    "let @xmath1943 be its direction vector field as in .    as in , by definition of @xmath12-dimensional slice and since",
    "the cones of directions are given by the directions of the superdifferential , for all @xmath1944 we have @xmath1945 where @xmath1946 is the unique point of @xmath1947 satisfying @xmath1948    _ step 2 .",
    "_ let @xmath1949 and set @xmath1950 .",
    "then clearly @xmath1951    in this step we prove that and the fact that @xmath1952 is induced by a borel @xmath146-compatible linear preorder @xmath1163 imply that @xmath1953    first of all observe that , by transversality of @xmath1954 w.r.t .",
    "@xmath1195 , @xmath1955    then , consider the borel linear preorder @xmath1956 \\e \\big ) .",
    "\\ ] ] its equivalence classes are given by the ( closed ) segments @xmath1957 \\e \\big ) , \\ ] ] from the transversality of @xmath1958 \\e)$ ] w.r.t .",
    "moreover , it is clearly @xmath1960-compatible and , since a carriage of @xmath872 is given by @xmath1961 then @xmath1962 by remark [ rem_pre ] and theorem [ t_a2 ] , we conclude that @xmath1747 is a borel @xmath1963-compatible linear preorder . in particular , by , any transport plan @xmath1964 must satisfy @xmath1965 and then since @xmath1966 and @xmath1967 are supported only on the sections @xmath1968 and @xmath1969 , implies that @xmath1970 .",
    "_ in this step we prove the cone approximation property for the @xmath12-dimensional slice @xmath1971",
    ". the sequence of approximating finite union of cone vector fields ( see definition [ d_cone_vector ] ) will be given by the transport rays of transport plans which are optimal w.r.t .",
    "the secondary cost @xmath1972 and whose first marginal is @xmath1966 and second marginal is given by finite sums of dirac deltas which are weakly converging to @xmath1967 , as given by the next lemma .",
    "[ l_appr_meas ] there exists a sequence @xmath1973 such that    1 .",
    "@xmath1974 is locally finitely atomic , @xmath1975 , 2 .",
    "@xmath1976 , 3 .",
    "@xmath1974 weakly converges to @xmath1977 in @xmath1978 .",
    "once the lemma is assumed to be valid , the proof of the theorem is concluded as follows .",
    "let @xmath1979 be optimal for @xmath1980 and let @xmath1981 be a @xmath1980-cyclically monotone carriage .",
    "a standard argument based on @xmath1982-cyclical monotonicity ( see e.g. @xcite ) implies the interiors of the segments @xmath1983 $ ] , with @xmath1983 \\in \\bar \\gamma''_n$ ] , do not intersect .",
    "since @xmath1981 can be decomposed as @xmath1984 up to a @xmath1966-negligible set , then the approximating sequence of finite unions of cone vector fields ( see definition [ d_cone_vector ] ) is given by @xmath1985 , z \\in b_i \\big\\}.\\ ] ]    let @xmath1986 be the borel function such that @xmath1987 , as it follows from .",
    "the uniqueness result proved in step 2 implies that the measure @xmath1988 converges weakly to the measure @xmath758 , which equivalently means that @xmath1989 then , the last condition for the forward cone approximation property required in definition [ d_forw_back ] is satisfied and the theorem is proved .",
    "we are left with the proof of lemma [ l_appr_meas ] .",
    "assume that @xmath1990 such that , for all @xmath1991 , @xmath1992 and @xmath1993 for some fixed system of coordinates @xmath1994 let @xmath1995 \\mathrm e'_j ,",
    "\\qquad \\bar q(z',r ) : = z ' + r \\bar q.\\ ] ] for @xmath897 , choose @xmath1996 sufficiently small such that @xmath1997 for all @xmath1998 ( clearly any @xmath1999 suffices ) .",
    "let @xmath2000 be a locally finite covering of @xmath2001 .",
    "then , define the map @xmath2002 by @xmath2003    the measures @xmath2004 satisfy @xmath2005 proving the lemma .",
    "[ r_not_gener_potential ] since the level sets of the function @xmath395 form a @xmath382-lipschitz foliation , then from proposition [ p_fol_char ] the equivalence classes of negligible @xmath164-measure are complete @xmath382-lipschitz graph .",
    "one could then suspect that the proof of theorem [ t_coneappr_fol ] can be deduced from the proof of theorem [ t_cone_graph ]",
    ".    this would be the case if the disintegration of the @xmath164-measure on the level sets of negligible @xmath164-measure of the generating @xmath395 were absolutely continuous w.r.t .",
    "@xmath2006 . here",
    "we show that in general this is not the case .",
    "in fact , we will construct a borel function @xmath2007 ^ 2 \\to [ 0,1]$ ] whose level sets are subsets of @xmath397-functions on @xmath2008 $ ] such that there exists a cantor set @xmath501 of positive @xmath2009-measure on which @xmath2010 is injective .",
    "this clearly implies that the disintegration of @xmath2011 w.r.t .",
    "@xmath2010 has conditional probabilities made of a single dirac @xmath2012-mass .",
    "let @xmath2013 \\to [ 0,1]$ ] be a strictly increasing @xmath397 function such that @xmath2014    consider the sequence of numbers @xmath2015    _ step 1 .",
    "_ if @xmath2016 \\times [ 0,b_1 ] = \\bigg [ 0,\\frac{7}{16 } \\bigg ] \\times \\bigg [ 0,\\frac{1}{4 } \\bigg]\\ ] ] and having fixed the points @xmath2017 consider the squares @xmath2018    we define the level sets of @xmath2010 outside the squares @xmath2019 as follows .",
    "first , in the strips @xmath2020 \\times \\bigg [ \\frac{7}{24 } , \\frac{1}{3 } \\bigg ] , \\quad [ 0,1 ] \\times \\bigg [ \\frac{15}{24 } , \\frac{2}{3 } \\bigg ] , \\quad [ 0,1 ] \\times \\bigg [ \\frac{23}{24 } , 1 \\bigg]\\ ] ] the level sets are horizontal segments @xmath2021 . in the remaining strips ,",
    "the construction is completely similar so that we show only the case @xmath2008 \\times [ 0,7/24]$ ] .    in the strip @xmath2022 \\times [ 1/4,7/24]$ ] the level lines are again @xmath2021 . in the remaining strip @xmath2023 \\times [ 0,7/24]$ ]",
    "we show how to use the function @xmath2024 to connect the points of the vertical segment @xmath2025 $ ] to the points of the vertical segment @xmath2026 $ ] : the construction in the remaining part is symmetrical . in this case , define the level set of @xmath2010 as the curves @xmath2027 \\big\\ } , \\quad y \\in [ 0,1/24].\\ ] ] due to the regularity of @xmath2024 , these curves are @xmath397 in the set of definition .",
    "_ in this step we show how to repeat the above construction in a square of the form @xmath2028 \\times [ 0,b_k]$ ] , in order to define the level sets of @xmath2010 outside finitely many squares of size @xmath2029 \\times [ 0,b_{k+1}]$ ] .",
    "define the points @xmath2030 the new squares which will be used in the next step are given by @xmath2031 \\times [ 0,b_{k+1 } ] , \\quad q^k_{1,j }",
    "= ( x_1,y_j ) + [ 0,a_{k+1 } ] \\times [ 0,b_{k+1}],\\ ] ] with @xmath2032 .    as before , in the strips @xmath2033 \\times \\bigg [ y_j - \\frac{1}{2 } \\cdot \\frac{b_{k+1}}{\\frac{b_k}{b_{k+1 } } - 1},y_j \\bigg ] ,",
    "\\quad j = 1,\\dots,\\frac{b_k}{b_{k+1 } } - 2,\\ ] ] the level sets of @xmath2010 are straight lines @xmath2021 , and the same for the strips @xmath2034 \\times \\bigg[y_j , y_j + \\frac{1}{2 } \\cdot \\frac{b_{k+1}}{\\frac{b_k}{b_{k+1 } } - 1 } \\bigg ] , \\quad j = 0,\\dots,\\frac{b_k}{b_{k+1 } } - 2,\\ ] ] @xmath2035 \\times \\bigg[y_j - \\frac{b_{k+1}}{\\frac{b_k}{b_{k+1 } } - 1 } , y_j - \\frac{1}{2 } \\cdot \\frac{(b_{k+1})^2}{\\frac{b_k}{b_{k+1 } } - 1 } \\bigg ] , \\quad j = 1,\\dots,\\frac{b_k}{b_{k+1 } } - 1.\\ ] ]    similarly as done in step 1 , we just show how to define the level sets connecting the segments @xmath2036 \\quad \\text{and } \\quad \\{a_{k+1 } + c_{k+1}\\ } \\times [ 0,b_{k+1}].\\ ] ] one just defines the level sets of @xmath2010 to be @xmath2037 \\bigg\\ } , \\quad   y \\in \\bigg [ 0,\\frac{1}{2 } \\cdot \\frac{b_{k+1}}{\\frac{b_k}{b_{k+1 } } - 1 } \\bigg].\\ ] ]    _ step 3 .",
    "_ we show that the level sets are @xmath397 .",
    "in fact , by the estimate @xmath2038 it follows that the curves have a uniform bound in @xmath2039 , for every fixed @xmath258 , and thus they belongs to @xmath397 .",
    "moreover , it is fairly easy to see that the intersection of each level set with the line @xmath2040 $ ] determines completely the curve , so that the function @xmath2010 can be defined as the @xmath309-coordinate of this intersection . with a slight variation of this construction one",
    "can obtain @xmath2010 to be regular .",
    "_ let @xmath501 be the compact cantor set obtained by intersecting all the squares @xmath2041 : @xmath2042 it is standard to see that the function @xmath2010 is single valued on @xmath501",
    ". moreover , a simple area estimate yields @xmath2043 and this concludes the example .",
    "in this final section we collect the proofs of the remaining main theorems stated in section [ ss_main_sud ] .      in this section",
    "we prove theorem [ t_subpart_step ] , that we recall below .",
    "[ t_subpart_step2 ] let @xmath247 be a lebesgue - regular directed locally affine partition in @xmath4 and let @xmath2 , @xmath3 be probability measures in @xmath281 such that @xmath248 and @xmath250 .",
    "then , for all fixed @xmath282 , there exists a directed locally affine subpartition @xmath283 of @xmath816 , up to a @xmath2-negligible set @xmath284 , such that @xmath285 and setting @xmath286 , where @xmath287 is the conditional probability on the partition @xmath288 , then the sets @xmath2044 form a @xmath290-cyclically connected partition .",
    "let @xmath247 be a lebesgue - regular directed locally affine partition in @xmath4 and let @xmath19 , @xmath3 be probability measures such that @xmath2045 .    _ step 1 .",
    "_ by proposition [ p_countable_partition_in_reference_directed_planes ] , we can restrict the proof of the theorem to a fixed @xmath258-directed sheaf set , which we will denote again by @xmath2046 .",
    "moreover , by proposition [ p_sub_sheaf_fol ] it is enough to prove the existence of subpartitions as in theorem [ t_subpart_step ] for the fibration @xmath2047 , @xmath2048 , given by proposition [ p_map_sheaf_set_into_fibration ] .",
    "it is indeed clear that @xmath2049-cyclically connected sets , where @xmath2050 are mapped into @xmath2051-cyclically connected sets and viceversa , being @xmath1022 obtained through . since the map @xmath2052 defined in is not a bijection of @xmath4 into @xmath2053 , then the transport problem on the fibration @xmath2047 depends on the conditional second marginals @xmath2054 of @xmath38 w.r.t .",
    "the partition @xmath2055 .",
    "let @xmath2056 .",
    "_ let @xmath2057 be the equivalence relation given by theorem [ t_cfibrcfol ] for the transport problem @xmath2058 .",
    "in particular , gives the sets that , when mapped back through the map @xmath1001 on the sheaf set , satisfy and are @xmath293-cyclically connected .    by propositions [ p_ex_fol ] and [ p_fol_char ] , the remaining sets form a @xmath146-foliation into graphs of cone - lipschitz functions .",
    "let @xmath2059 be the @xmath146-differential partition given by corollary [ c_v ] . by theorems [ t_coneappr_fol ] and [ t_fc_no_initial ]",
    "its complementary @xmath284 is @xmath2-negligible , and by corollary [ c_infinnegl ] the partition is lebesgue - regular .",
    "the only missing point is to prove that the conditional second marginals @xmath2060 are independent of the particular transference plan @xmath2061 chosen .    from corollary [ c_infinnegl ] and theorem [ t_fc_no_initial ]",
    "it follows that @xmath2062 is a disintegration , and corollary [ c_transp_graph ] implies that @xmath2063 .",
    "hence , from the uniqueness of strongly consistent disintegrations , it follows that @xmath2064 yielding the improved version of conditions ( 4)-(5 ) in theorem [ t_final_nu ] .",
    "consider a family of borel equivalence relations on @xmath414 , @xmath2065 and let @xmath2066 . by theorem [ t_disint ]",
    ", we can construct the family of disintegrations @xmath2067 where @xmath2068 , @xmath2069 , @xmath2070 are respectively the quotient space , the conditional probabilities and image measure w.r.t .",
    "@xmath2071 .",
    "[ d_clos_sigma_e ] a family of equivalence relations @xmath2072 is _ closed under countable intersections _ if @xmath2073    in @xcite , a family of equivalence relations is said to be closed under countable intersections if @xmath2074 .",
    "however , by direct inspection , also with definition [ d_clos_sigma_e ] the following theorem holds ( see theorem a.11 in @xcite ) :    [ t_minimal_equival ] if @xmath2072 is closed under countable intersections , there exists @xmath2075 such that for all @xmath2071 , the following holds :    1 .",
    "[ item : poifvojfivfi ] if @xmath2076 , @xmath2077 are the @xmath362-subalgebras of the borel sets of @xmath414 made of the saturated sets for @xmath2078 , @xmath2079 respectively , then for all @xmath2080 there is @xmath2081 s.t .",
    "@xmath2082 ; 2 .",
    "[ item : gfoaifvfffv ] if @xmath2070 , @xmath2083 are the restrictions of @xmath2 to @xmath2076 , @xmath2077 respectively , then @xmath2076 can be embedded ( as measure algebra ) in @xmath2077 by point : let @xmath2084 be the disintegration of @xmath2083 consistent with the equivalence classes of @xmath2076 in @xmath2077 .",
    "[ item : gfoaivdasvds ] if @xmath2085 are the disintegrations consistent with @xmath2078 , @xmath2079 respectively , then @xmath2086 for @xmath2070-a.e .",
    "@xmath2087 .",
    "[ r_min_contain_e ] from the proof of the above theorem one can observe that it is enough to require that for all @xmath2088 there exists @xmath2089 such that @xmath2090 .    [ d_min_equiv_def ] the equivalence relation @xmath2079 satisfying the assumptions of theorem [ t_minimal_equival ] is called the _ minimal equivalence relation _ in @xmath2072 w.r.t .",
    "@xmath2 .    in particular ,",
    "assume that each @xmath2078 is given by @xmath2091    [ c_constant_for_minimal_equivalence ] @xmath2092 , there exists a @xmath2-conegligible set @xmath714 such that @xmath2093 is constant on @xmath2094 , for all @xmath2095 .",
    "consider the function @xmath2096 : by the minimality of @xmath2097 , it follows that @xmath2098 since @xmath2099 , then also @xmath2100 and thus @xmath2101 dm_{\\bar{\\mathfrak e}}(t'').\\ ] ] this implies that for @xmath2083-a.e .",
    "@xmath2102 @xmath2103 or equivalently that @xmath2104 hence @xmath2105 is concentrated on a graph : by choosing @xmath2106 , there exists @xmath2107 borel such that @xmath2108 .",
    "this is equivalent to say that there exists a @xmath2-conegligible set @xmath130 such that @xmath2109 on @xmath130 .",
    "= @xmath399 , @xmath2110 , @xmath401 , @xmath402 natural numbers , natural numbers with @xmath175 , rational numbers , real numbers + @xmath403 , @xmath404 positive rational and real numbers + @xmath4 , @xmath151 @xmath22-dimensional real vector space and @xmath407-dimensional unit sphere + @xmath1982 , @xmath2111 norm , scalar product in @xmath4 + @xmath405 open unit ball in @xmath4 centered in @xmath62 with radius @xmath2112 + @xmath2113 power set of @xmath414 + @xmath413 first countable ordinal number + @xmath416 , @xmath417 , @xmath420 closure , interior , relative interior of a set @xmath79 + @xmath421 , @xmath422 topological boundary , relative boundary of a set @xmath79 + @xmath2114 vector sum of two sets @xmath79 , @xmath423 + @xmath2115 scalar product of @xmath425 with @xmath79 + @xmath2116 product space of the spaces @xmath429 + @xmath2117 , @xmath2118 , @xmath2119 projection of @xmath2120 on the @xmath430-coordinate + @xmath538 class of souslin sets + @xmath540 @xmath362-algebra generated by souslin sets + @xmath2121 , @xmath2122 inverse of the multifunction @xmath434 or the set @xmath2123 + @xmath437 , @xmath2124 domain of the multifunction @xmath434 or the function @xmath443 + @xmath444 graph of the function @xmath443 + @xmath448 composition of the functions @xmath443 and @xmath447 + @xmath2125 epigraph of the function @xmath443 + @xmath2126 identity map or its graph + @xmath2127 characteristic function of @xmath79 + @xmath78 indicator function + @xmath2128 polish space + @xmath460 family of linear subspaces of @xmath4 of dimension @xmath16 + @xmath2129 family of affine subspaces of @xmath462 of dimension @xmath2130 + @xmath2131 orthogonal projection on the affine space @xmath462 + @xmath2132 affine space generated by @xmath79 + @xmath469 convex envelope of @xmath467 + @xmath474 orthogonal space to @xmath465 + @xmath2133 linear dimension of @xmath2132 + @xmath488 family of closed non degenerate cones in @xmath4 of dimension @xmath16 + @xmath23 compact convex neighborhood of @xmath175 + @xmath354 convex norm with unit ball @xmath23 + @xmath2134 cones in the affine space @xmath465 + @xmath2135 cones defined in , + @xmath2136 closure of the cone @xmath2135 + @xmath2137 spherical convex envelope of @xmath521 + @xmath523 lebesgue measure on @xmath4 + @xmath164 @xmath16-dimensional hausdorff measure + @xmath530 product of the two measures @xmath528 and @xmath529 + @xmath2138 restriction of the measure @xmath534 to the set @xmath79 + @xmath2139 restriction of the function @xmath434 to the set @xmath79 + @xmath531 lebesgue points of a set @xmath79 + @xmath536 borel @xmath362-algebra on the topological space @xmath414 + @xmath537 space of borel probability measures over @xmath414 polish + @xmath543 equivalence of measures + @xmath545 push - forward of the measure @xmath534 by the function @xmath443 + @xmath2140 disintegration of a measure @xmath2 on a partition @xmath2141 , definition [ d_dis ] + @xmath2142 integration formula + @xmath2143 disintegration of @xmath523 on a partition @xmath2141 , remark [ r_disint_lebesgue ] + @xmath591 $ ] borel cost function + @xmath2144 transference plans with marginals @xmath2 , @xmath3 + @xmath366 transference plans with finite @xmath173 cost + @xmath2145 @xmath173-optimal transference plans + @xmath621 @xmath362-compact @xmath173-cyclically monotone carriage of @xmath36 + @xmath730 preorder on @xmath414 whose graph is @xmath79 + @xmath731 equivalence relation whose graph is @xmath2146 + @xmath367 preorder induced by @xmath231-axial paths + @xmath2147 , @xmath2148 superdifferential , subdifferential of the function @xmath767 , definition [ d_super_sub_diff ] + @xmath2149 convex cone cost + @xmath370 , @xmath371 push forward of @xmath2 , @xmath3 on the graph of @xmath61 + @xmath2150 push forward of @xmath36 on the set @xmath2151 + @xmath2152 , @xmath2153 super / subdifferential of @xmath2154 + @xmath2155 directed locally affine partition of @xmath4 , definition [ d_locaffpart ] + @xmath2156 cone of directions for the partition @xmath2155 , definition [ d_locaffpart ] + @xmath876 , @xmath2157 graph of a directed locally affine partition + @xmath1555 , @xmath1576 base of the partition @xmath2155 + @xmath386 quotient space of the directed locally affine partition + @xmath2158 disjoint union of the sets @xmath966 + @xmath2159 , @xmath2160 initial , final points of the set @xmath2161 , definition [ d_initial_final ] + @xmath967 , @xmath968 initial , final points of a directed locally affine partition + @xmath848 cost function associated to a directed locally affine partition + @xmath2162 disintegration of the transference plan @xmath36 on @xmath14 , proposition [ p_dispiani ] + @xmath2163 optimal transport plans with finite @xmath196-cost w.r.t .",
    "the marginals @xmath2 and @xmath875 , definition [ d_pinu ] + @xmath2164 cone generated by @xmath2165 + @xmath2166 unit cube generated by the family of vectors @xmath2165 + @xmath941 countable decomposition of @xmath876 into sheaf sets , proposition [ p_countable_partition_in_reference_directed_planes ] + @xmath942 sheaf set , definition [ d_sheaf_set ] + @xmath2167 quotient space of the sheaf set @xmath942 + @xmath1739 , @xmath1002 @xmath362-compact fibration , definition [ d_fibration ] + @xmath1001 bi - lipschitz map of a sheaf set into a fibration + @xmath2168 identification map + @xmath370 , @xmath371 , @xmath2169 , @xmath2170 push forward of @xmath2 , @xmath3 , @xmath242 , @xmath341 by @xmath1001 - + @xmath2171 subpartition of a directed fibration , proposition [ p_sub_sheaf_fol ] + @xmath1064 complete @xmath1174-lipschitz graph , definition [ d_complete_g ] + @xmath1062 @xmath354-lipschitz function whose graph is @xmath1064 + @xmath2172 , @xmath2173 super / subdifferential of @xmath1064 , definition [ d_tilde_c_diff ] + @xmath1076 extremal cone of @xmath1089 satisfying + @xmath146-lipschitz foliation definition [ d_lip_fol ] + @xmath2174 , @xmath2175 convex set and its corresponding norm whose epigraph is @xmath1195 , section [ ss_cone_lipschitz ] + @xmath2176 quotient map of a @xmath146-lipschitz foliation , definition [ d_lip_fol ] + @xmath1184 convex set defined in + @xmath2177 , @xmath2178 @xmath2175-lipschitz functions , proposition [ p_fol_char ] + @xmath1391 , @xmath1212 super / subdifferential of the @xmath146-lipschitz foliation @xmath1148 , definition [ d_partial_theta ] + @xmath1264 , @xmath1246 forward , backward transport sets + @xmath2179 set of fixed points + @xmath1265 , @xmath1249 forward / backward direction multifunction + @xmath2180 , @xmath2181 @xmath258-dimensional forward / backward regular transport set + @xmath2182 , @xmath2183 forward / backward regular transport set + @xmath1281 regular transport set + @xmath1235 residual set + @xmath2184 , @xmath1288 quotient maps defined in and + @xmath2185 super / subdifferential directed partition defined in theorem [ t_partition_e+- ] + @xmath2186 @xmath146-differential locally affine partition defined in corollary [ c_v ] + @xmath2187 , @xmath1687 @xmath362-compact graphs of the partitions @xmath2188 , @xmath2189 + @xmath2190 initial points of the superdifferential partition @xmath2191 + @xmath2192 final points of the subdifferential partition @xmath2193 + @xmath2194 set of transference plans concentrated on the superdifferential of @xmath395 + @xmath1476 directional vector field for a @xmath12-dimensional model set + @xmath2195 short notation for @xmath12-dimensional model set @xmath2196 , definition [ d_modeldire_segm ] + @xmath2197 union of the closure of the segments of @xmath1511 + @xmath1495 , @xmath2198 section of @xmath1511 , @xmath1476 , + @xmath1663 , @xmath2199 multivalued extensions of @xmath1476 to the initial , final points + @xmath1485 , @xmath1486 borel section of @xmath1663 , @xmath2199 , lemma [ l_reg_tt_d_h_pm ] + @xmath1556 , @xmath1558 extension of @xmath1485 , @xmath1486 to the set @xmath2200 + @xmath1510 , @xmath2201 maps from @xmath1494 to @xmath1495 defined by @xmath1476 , @xmath1498 , + @xmath1476 , @xmath1525 , @xmath2202 cone vector field with base @xmath1525 and vertex @xmath2203 , definition [ d_cone_vector ] + @xmath1527 , @xmath2204 , @xmath2205 finite union of cone vector fields with bases @xmath2204 , vertices @xmath2205 , definition [ d_cone_vector ] + @xmath2206 reference set defined in + @xmath2207 @xmath16-dimensional model set @xmath1576 with direction map @xmath1614 , + reference set @xmath2206 , definition [ d_k_dim_model ] + @xmath2208 reference configuration for a @xmath12-dimensional slice of @xmath1576 , definition [ d_1_sim_slice ] + @xmath1636 direction map of a 1-dimensional slice + @xmath2209 direction map of a sheaf set @xmath1576 + @xmath1618 subset of a @xmath16-dimensional sheaf set + @xmath2210 @xmath16-dimensional @xmath1614-cylinder , definition [ d_mathcal_d_cyl ] + @xmath2211 countable family of @xmath16-dimensional @xmath1614-cylinders covering a sheaf set + @xmath1747 linear preorder with minimality properties , theorem [ t_cfibrcfol ] + @xmath2057 borel function generating @xmath1747 + @xmath2212 family of @xmath362-compact carriages of @xmath1908 + @xmath2213 family of @xmath362-compact carriages of transference plans + @xmath1744 polish space of sequences with product topology + @xmath1765 linear preorder constructed for @xmath1908 , theorem [ t_order_gamma ] + @xmath2214 borel function generating @xmath1765 + @xmath2215 countable family of sections , lemma [ l_z_n_dense_selections ] + @xmath1820 sets defined in + @xmath2216 lexicographic ordering on @xmath2217 + @xmath1869 lexicographic ordering on @xmath2218 + @xmath2219 1-dimensional slice of a @xmath1614-cylinder @xmath1936 + @xmath2220 vector direction map for the 1-dimensional slice @xmath2219            l.  ambrosio and a.  pratelli . existence and",
    "stability results in the @xmath2221 theory of optimal transportation . in _ optimal transportation and applications _ , volume 1813 of _ lecture notes in mathematics _ ,",
    "pages 123160 .",
    "springer , 2001 ."
  ],
  "abstract_text": [
    "<S> we consider the original strategy proposed by sudakov for solving the monge transportation problem with norm cost @xmath0 @xmath1 with @xmath2 , @xmath3 probability measures in @xmath4 and @xmath2 absolutely continuous w.r.t . </S>",
    "<S> @xmath5 . the key idea in this approach is to decompose ( via disintegration of measures ) the kantorovich optimal transportation problem into a family of transportation problems in @xmath6 , where @xmath7 are disjoint regions such that the construction of an optimal map @xmath8 is simpler than in the original problem , and then to obtain @xmath9 by piecing together the maps @xmath10 . </S>",
    "<S> when the norm @xmath0 is strictly convex @xcite , the sets @xmath11 are a family of @xmath12-dimensional segments determined by the kantorovich potential called optimal rays , while the existence of the map @xmath10 is straightforward provided one can show that the disintegration of @xmath5 ( and thus of @xmath2 ) on such segments is absolutely continuous w.r.t . the @xmath12-dimensional hausdorff measure @xcite . </S>",
    "<S> when the norm @xmath0 is not strictly convex , the main problems in this kind of approach are two : first , to identify a suitable family of regions @xmath13 on which the transport problem decomposes into simpler ones , and then to prove the existence of optimal maps .    in this paper </S>",
    "<S> we show how these difficulties can be overcome , and that the original idea of sudakov can be successfully implemented .    </S>",
    "<S> the results yield a complete characterization of the kantorovich optimal transportation problem , whose straightforward corollary is the solution of the monge problem in each set @xmath11 and then in @xmath4 . </S>",
    "<S> the strategy is sufficiently powerful to be applied to other optimal transportation problems .    </S>",
    "<S> the analysis requires    1 .   </S>",
    "<S> the study of the transportation problem on directed locally affine partitions @xmath14 of @xmath4 , i.e. sets @xmath15 which are relatively open in their @xmath16-dimensional affine hull and on which the transport occurs only along directions belonging to a cone @xmath17 ; 2 .   </S>",
    "<S> the proof of the absolute continuity w.r.t . </S>",
    "<S> the suitable @xmath16-dimensional hausdorff measure of the disintegration of @xmath5 on these directed locally affine partitions ; 3 .   </S>",
    "<S> the definition of cyclically connected sets w.r.t . </S>",
    "<S> a family of transportation plans with finite cone costs ; 4 .   </S>",
    "<S> the proof of the existence of cyclically connected directed locally affine partitions for transport problems with cost functions which are indicator functions of cones and no potentials can be constructed .        </S>",
    "<S> preprint sissa 51/2013/mate </S>"
  ]
}