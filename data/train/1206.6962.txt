{
  "article_text": [
    "the goal of factor rotation is to find interpretable directions explaining the covariance of the variables . in the case of classical multivariate data interpretation of factors",
    "it is primarily carried out based on the grouping of factor loadings",
    ". however , these approaches are not always applicable to collections of random functions .",
    "instead , we propose an interpretable factor rotation using a naturally predefined space of functions .",
    "the motivating data set for this paper consists of roughly weekly observations of vegetation acquired from remote sensing at regular intervals for multiple years . in this case",
    ", the dominant seasonal cycle provides a natural choice for dividing the variation into nearly - periodic and nearly - aperiodic sources of variation .",
    "more generally , our approach facilitates understanding highly complex forms of functional variation by dividing the total variation into two orthogonal parts , each of which may be explained by a smaller number of components with clear interpretation . besides achieving the desired interpretability ,",
    "these components are shown to be stable over the choice of the number of factors and can be obtained through computationally inexpensive steps.=-1    while a large amount of methodological development in functional data analysis has been based on functional principal components analysis [ @xcite ] and considerable theoretical attention devoted to its properties [ @xcite , @xcite , @xcite ] , little attention has been given to finding rotations of the leading principal components to improve the interpretability of variance components in fpca . in this context , @xcite propose a varimax rotation , accomplished by evaluating derived principal components on a fine grid ; varimax rotations yield components that have either very high or very low values , effectively focusing variation on particular regions of the functional domain . in many contexts",
    ", this can be useful  their study of canadian weather data neatly picks up the four seasons , for example  but there is considerable further scope for alternative notions of interpretability to be developed . in particular , existing rotation methods designed for multivariate data generally seek to emphasize particular variables or observations , but do not attempt to account for the ordering relations between variables that exist in functional data .",
    "we generally expect the loading at one time point to be close to the loading at a nearby time point .",
    "one way to achieve this is through smoothing penalties .",
    "instead , we define a rotation toward an interpretable reference subspace of functions .",
    "in the context of multi - year time series remote sensing data , the need for methods to extract interpretable sources of variation is particularly acute .",
    "the vegetation index considered in this paper consists of a 6-year time series of remote sensing images acquired at 8-day intervals for a site in central massachusetts ( see section  [ subsecdata ] and figure  [ preproc ] ) .",
    "these data demonstrate a  highly complex functional covariance structure . to illustrate , in figure  [ pcandvarimax ] we present a scree plot of eigenvalues for the data set .",
    "this scree plot shows exponential decay in explained variance , with no evidence of the `` elbow '' that is frequently used to decide the number of eigenvalues to retain .",
    "further , if we wished to explain 90% of variation  a frequently used criterion  over 30 components would need to be retained , and examination of the first few principal components suggests that interpretation of these components is problematic ( see figure  [ pcandvarimax ] ) , consisting of both strong periodic structure as well as trends and isolated features .",
    "interpreting these sources of variation from this covariance structure is challenging and common techniques such as varimax rotations ( also shown in figure  [ pcandvarimax ] ) are clearly unhelpful in this case .",
    "there is , however , one clear and highly interpretable feature in the data : a strong periodic signal .",
    "this is naturally expected due to the strong seasonal forcing .    .",
    "the function @xmath0 has index @xmath1 and @xmath2 has index @xmath3 .",
    "the solid triangles highlight the percentage score - variance associated with the annual fourier basis which correspond to index @xmath4 . the constant basis is not included in the calculation and index . ]",
    "basing an interpretation around seasonality is both visually satisfying and scientifically useful .",
    "perhaps the most widely recognized feature of the global climate ( e.g. , temperature , precipitation ) and ecosystem ( e.g. , vegetation ) data is seasonality [ @xcite ] . this can be illustrated by spectral decomposition of our data , shown in the right plot in figure [ preproc ] , where annual variation dominates .",
    "meanwhile , because climate dynamics are produced by complex interactions among the earth s oceans , atmosphere , cryosphere , and land masses , the earth s weather and climate system , and hence indicators of ecosystem , does not behave in a strictly periodic fashion [ @xcite ] .",
    "although sophisticated models have been developed for predicting climate - ecosystem dynamics , our understanding remains incomplete .",
    "the contribution of this paper is to provide a new factor rotation technique that divides sources of variation into nearly - periodic and nearly - aperiodic components .",
    "while strictly periodic components could be obtained directly by projecting onto a basis of periodic functions , the year - to - year variation in season timing requires us to retain somewhat more flexibility so as not to overestimate the amount of nonseasonal variation .",
    "one approach to this would be to undertake a registration procedure [ @xcite , @xcite , @xcite , @xcite ] .",
    "however , the registration is ill - posed  and registration algorithms are computationally expensive , particularly for large and complex data sets .",
    "instead , we keep within the framework of factor rotation and seek a rotation that rotates the largest sources of variation toward being periodic or a - periodic ( see figure [ ppc ] ) .",
    "this is accomplished via a canonical correlations transform providing what we have labeled _ principal periodic components _ ( ppcs ) .",
    "and the dashed curves are benchmarks  @xmath5 associated with  @xmath6 .",
    "the correlation is computed as the standardized inner product between  @xmath5 and  @xmath6 .",
    "the pair index is ordered by the correlation . ]    in comparing varimax and ppc , we perform both rotations on a sequence number of fpcs and compute the change in @xmath7 sense between the first rotated components derived from two consecutive numbers of fpcs .",
    "the @xmath7 change of ppc rotation is much smaller and more stable compared to varimax rotation , suggesting ppc s robustness with respect to the number of fpcs used in rotation .",
    "simulation studies also show that ppcs perform very well in detecting periodic variation in the following two cases : ( i ) amount of periodic variation increases from 0 to a level only comparable to other source of variation where fpcs react slowly to the increasing periodic variation ; ( ii ) total variation is dominated by increasing amount of high frequency disturbances where fpcs are quickly contaminated by disturbances and ppcs still capture the periodic source of variation .",
    "to better understand the rotation and the relation between ppcs and the space of functions with strict annual cycle , we develop a heuristic test of whether the first ppc lies in that space . in the test",
    ", we create a set of curves under the null hypothesis as close to the original data as possible by either replacing the first ppc by its associated benchmark , or inflating the nearly - periodic component while controlling for kullback  leibler divergence of the sample functional covariance to the null functional covariance .",
    "the test on our motivating data set rejects the null hypothesis , suggesting that no strict annual variation is presented in the space spanned by ppcs .",
    "a further aspect of the data is that it is gridded in a regular spatial distribution .",
    "this induces both spatial correlation as well as effects due to ( unobserved ) geographic and environmental factors",
    ". our use of rotations will allow the effect of these structures to be empirically investigated in terms of both variation in cyclic ecological factors and in longer - term trends .",
    "our functional data analysis approach differs from techniques using empirical orthogonal functions ( eofs ) in spatio - temporal analysis [ e.g. , in @xcite ] in considering observations as functions of time rather than of space .",
    "we believe that this approach is appropriate to the task of separating cyclical from other trends .",
    "we note that a similar rotation of eofs toward a subspace of functions describing landscape features or other geographic gradients could be developed along similar lines to ppcs , but this is beyond the scope of the current paper .",
    "the remainder of this paper is arranged as follows . in section [ secmotivating ]",
    "we will show a motivating example in which we carry out smoothing and functional principal component analysis and demonstrate the motivation for ppcs .",
    "in section  [ secppc ] we introduce the framework of ppc and its results on our remote sensing data .",
    "results of a simulation study are presented in section  [ secsim ] that illustrate the sensitivity and robustness of ppc in identifying periodic variation .",
    "details of further simulation experiments concerning the power and size of the proposed tests are given in the supplemental article [ @xcite ] .",
    "we end with some concluding remarks and discussion of future research .",
    "the data set used for this work consists of time series of remotely sensed images acquired over a site in central massachusetts . specifically , we used surface spectral reflectance measurements from the moderate resolution imaging spectroradiometer ( modis ) onboard nasa s terra and aqua satellites .",
    "data from modis were extracted for a 25 by 25 pixel window ( covering an area of @xmath8 134 km@xmath9 ) centered over the harvard forest long term experimental research site in petersham , ma .",
    "this site is characteristic of mid - latitude temperate forests and is dominated by deciduous tree and understory species that exhibit strong seasonal variation in phenology .",
    "data are provided at 8-day intervals ( 46 data points per year ) for the period from january 1 , 2001 to december 31 , 2006 .",
    "the spatial resolution of the data is 500-m on the ground .    using modis surface spectral reflectances in the blue , red and near - infrared ( nir ) wavelengths",
    ", we computed a quantity known as the `` enhanced vegetation index '' [ evi ; @xcite ] : @xmath10 where nir , red and blue are reflectances of the corresponding bands recorded by modis and @xmath11 , @xmath12 and @xmath13 are constant coefficients .",
    "the evi exploits spectral reflectance properties of live vegetation , yielding an index that scales from @xmath141 to 1 that is widely used for monitoring seasonal dynamics in vegetation .",
    "because evi data are sensitive to the presence of snow and include noise and missing values caused by clouds , the data were preprocessed prior to analysis to remove noise and fill gaps following the procedure described by @xcite . in the supplemental article [ @xcite ]",
    ", we provide a detailed account of this preprocessing and criteria for excluding pixels with large blocks of missing observations .    the final data set consisted 276 evi time series values for each of 423 pixels ( excluding pixels with problematic observations ) , that is , 423 replicated curves , with each replication corresponding to a pixel in the area of interest . the regular spatial and temporal sampling of evi data makes functional data analysis a useful framework for exploring variation among curves and facilitating the study of change in variation .",
    "denote the discrete observation at pixel @xmath15 and time @xmath16 by @xmath17 .",
    "we consider the following additive error model : @xmath18 where @xmath19 s are the true realizations of the underlying random growing process @xmath20 and @xmath21 s are errors .",
    "to estimate @xmath19 , we choose a regularization approach based on basis expansion .",
    "specifically , we fit our data with the saturated fourier basis and explicitly penalize the total curvature .",
    "the fourier basis is numerically convenient for our purposes ; experiments with alternative b - spline bases indicated that our results are insensitive to this choice .",
    "the smoothing parameter is chosen to minimize the sum of generalized cross validation scores over all curves .",
    "this can be implemented in r [ @xcite ] using the fda package [ @xcite ] .",
    "let @xmath22 denote the fitted curve .",
    "then , we further process this raw fitting by removing from each @xmath23 its time - series average .",
    "then , we obtain the demeaned curve @xmath24 as @xmath25    this demeaning process removes vertical variation and avoids defining it as either annual or nonannual . the centering removes heterogeneity in the overall growing level and allows us to focus on nonconstant modes of variation ; see further discussion in section  [ secppc ] .",
    "the pre - smoothed and demeaned evi curves of the harvard forest data are shown in the upper left plot in figure  [ preproc ] . while many methods have been developed to analyze the features and structure of the mean shape , in this paper we are interested in changes in vegetation dynamics manifested in terms of variance .",
    "we decompose the total variation among the evi curves by projecting evi curves to the saturated fourier basis system .",
    "this decomposition shows that variation explained by the annual fourier basis function is a dominating source of variation in our example , as shown in the right plot in figure  [ preproc ] .",
    "the data here are defined on a grid of observations taken every 8 days and thus could be considered a very high - dimensional multivariate data set .",
    "we have chosen to view these data as functional due to the underlying smooth greening process that they record , and because it facilitates the definition of periodicity which we employ to define a factor rotation below .      functional principal component analysis ( fpca )",
    "is a well studied research area .",
    "it provides a way to extract the major mode of variation among curves and our proposed ppc is based on and motivated by fpca . to introduce and fix notation for description of ppc in later sections ,",
    "we give a brief review on fpca .",
    "more references on fpca can be found in @xcite , @xcite and @xcite . in particular , we look for a set of normalized and orthogonal functions @xmath26 such that the projection of all evi curves onto each specific @xmath26 has the largest variability .",
    "these @xmath26 s are called the functional principal components ( fpcs ) .",
    "formally , suppose we have @xmath27 smoothed and time - series demeaned evi curves @xmath24 , @xmath28 .",
    "the sample cross - section mean process is @xmath29 .",
    "then the cross - section demeaned curve is obtained as @xmath30 .",
    "@xmath31 is chosen to maximize @xmath32 subject to the constraints that @xmath33 where @xmath34 is the kronecker delta .",
    "given the estimated covariance kernel @xmath35 , each fpc , @xmath26 , satisfies the eigen - equation @xmath36 , where  @xmath37 is the associated eigenvalue . by writing @xmath26 in expansion of basis functions",
    ", this problem can be reduced to the computation of matrix eigenvalues and eigenvectors .",
    "here we have pre - smoothed the data and applied a  principle - components decomposition without additional penalty .",
    "fpca can also be employed along with smoothing methods [ @xcite ] or by directly smoothing the covariance surface [ @xcite ] .",
    "the methods developed below are applicable for an fpca decomposition , irrespective of the method employed to derive it .    in order to explore the variation in evi curves ,",
    "we apply the standard fpca techniques on harvard forest data .",
    "the first 4 fpcs of harvard forest are plotted in figure  [ pcandvarimax ] where each of the four fpcs contains some level of annual periodicity and pick up features of evi variation at different times of year .",
    "for example , the first pc shows that the contrast of evi between summer and winter is the most distinct feature that characterizes the vegetation growing in this area , however , with a decreasing trend suggesting the contrast between summer and winter has changed over the 6 years .",
    "the second fpc has a sharp peak roughly at the start of each growing season combined with noticeable dips during years 5 and  6 . due to the existence of the two negative bumps",
    ", it is hard to interpret the second fpc as the effect of growing season onset .",
    "a third fpc emphasizes the ending of growing season , characterizing variation in the timing of vegetation browning .",
    "however , as these fpcs are combined with nonannual signal , they are not designed to distinguish between annual and nonannual sources of variation . in section [ secppc ] we discuss the appropriate rotation of fpcs to aid interpretation by separating annual and nonannual sources of variation .",
    "but first we discuss one widely used technique of rotation for functional data  the varimax rotation .",
    "varimax is a widely used orthonormal transformation in multivariate analysis which can make multivariate principal components more interpretable .",
    "the functional varimax rotation borrows readily the concept of multivariate varimax rotation .",
    "suppose we retain the first @xmath38 fpcs and the subspace spanned by these @xmath38 fpcs is denoted by @xmath39 .",
    "we use @xmath40 to refer to the vector valued function @xmath41 .",
    "let @xmath42 be a @xmath43 evaluation matrix of @xmath44 where @xmath45 , @xmath46 .",
    "given an orthonormal matrix @xmath47 , @xmath48 gives us a new set of orthonormal functions .",
    "the evaluation matrix at the same @xmath49 s of the rotated functions  @xmath50 is given by @xmath51 .",
    "denote the @xmath52th entry of matrix a by @xmath53 .",
    "then the varimax strategy for choosing the orthonormal rotation matrix @xmath47 is to maximize the variation of @xmath54 over all values of @xmath15 and @xmath55 .",
    "the solution to the above maximization problem will encourage values @xmath53 to be either strongly positive , near zero , or strongly negative .",
    "this rotation tends to cluster information and make the components of variation easier to interpret .",
    "rotation on the first 46 fpcs and on the first 4 fpcs are shown in the two lower plots in figure  [ pcandvarimax ] .",
    "if using only 4 fpcs , we do not have sufficient flexibility to provide improved interpretation .",
    "by contrast , using 46 fpcs provides so much concentration on individual time points that any natural interpretation is lost .",
    "the rotation described here can be generalized to describe a rotation of principal components to find directions that lie close to an interpretable reference subspace . in a multivariate context , this amounts to finding a  rotation of factors @xmath56 so that the leading components lie close to a subspace spanned by the columns of a matrix @xmath57 , assumed to have interpretable relevance for the application at hand , and the mathematical development below can be read in an entirely multivariate context .",
    "it more generally applies to observations taking values on any hilbert space .",
    "while the space of periodic functions is clearly relevant for our application , the choice of subspace is context - specific .",
    "the varimax rotation does not achieve our goal of separating annual and nonannual variation since its objective function is not designed to do so . we need to explicitly define an objective function which can extract annual variation .",
    "one natural way to do this is to order the rotated fpcs by their levels of annual periodicity . to measure annual periodicity , we will first define benchmarks which have strict annual periodicity .",
    "then we compute the closeness between rotated fpcs and corresponding benchmarks and this computed closeness serves as the measure of annual periodicity of the rotated fpcs .",
    "refer to fourier basis functions with annual period as @xmath58 , @xmath59 , the vector of them as @xmath60 and the space spanned by them as @xmath61 .",
    "hence , @xmath62 is a space of functions with annual periodicity up to a certain frequency determined by @xmath63 .",
    "@xmath63 is limited to the set of periodic fourier coefficients used to smooth the data .",
    "more generally , @xmath63 can be set to @xmath27allowing the interpolation of any @xmath27 points that lie in a strictly periodic subspace .",
    "we construct our benchmarks as the linear combination of @xmath58 s",
    ". then benchmarks are in @xmath62 and thus have exactly annual periodicity .",
    "intuitively , we can consider @xmath44 and @xmath60 as two frames of their own spaces @xmath39 and @xmath62 .",
    "we can rotate the two frames and align them in the same direction as much as possible .",
    "if @xmath64 contains direction which is exactly annual , then we will align the two spaces at least in one direction .",
    "the closeness between the rotated fpc and associated benchmark is computed as their standardized inner - product .      in this section",
    "we give a  mathematical description of the ppc methodology .",
    "recall that @xmath40 is a  @xmath38 dimensional vector of fpcs obtained from time - series demeaned curves and  @xmath60 is a @xmath63 dimensional vector of fourier basis functions with annual period .",
    "define @xmath65 , where @xmath66 is the inner - product in @xmath7 space and the @xmath67th entry of @xmath68 is given by @xmath69 .",
    "we compute the singular value decomposition @xmath70 and denote the @xmath55th row of @xmath71 by @xmath72 and the @xmath55th row of  @xmath73 by  @xmath74 .",
    "the ppcs and associated benchmarks are then defined as follows , @xmath75 in the above definition , we call @xmath6 the @xmath55th ppc and @xmath5 the associated benchmark of  @xmath6 .    in order to derive these estimates , denote any rotation on @xmath76 by @xmath77 with  @xmath78 being the @xmath55th row of @xmath79 , and any rotation on @xmath60 by @xmath80 with @xmath81 being the @xmath55th row of @xmath80 .",
    "let @xmath82 and @xmath83 .",
    "then @xmath84 is the @xmath55th rotated fpc and  @xmath85 is a function with annual cycle .",
    "we define the closeness measure of the pair  @xmath84 and  @xmath85 as the angle between them , @xmath86 given this closeness measure , we solve the following optimization problem for @xmath87 , @xmath88 subject to @xmath89 , @xmath90 , @xmath91 where the @xmath67th entry of  @xmath92 , @xmath93 and @xmath94 are given by @xmath95 , @xmath96 and @xmath97 , respectively .",
    "we observe that the objective in @xmath98 has the same form as multivariate canonical correlation analysis ( cca ) where random variables are replaced by functions .",
    "however , the sampling properties of the ppc rotation differ from cca in that the frame of our reference subspace , @xmath60 , is deterministic while fpcs @xmath44 is random where randomness comes from sampling variation .",
    "see @xcite for an overview of cca ; in the functional analysis context see @xcite and @xcite . according to the cca results , we have the following solution : @xmath99 due to the orthogonality of fpcs and the fourier basis system , we have @xmath100 and @xmath101 .",
    "these two identities reduce ( [ ppcraw ] ) and ( [ bmkraw ] ) to the eigenanalysis of @xmath92 and the results in ( [ ppcbmkdef ] ) follows . in ( [ ppcbmkdef ] ) , @xmath102 and @xmath103 are two orthogonal rotation matrices on @xmath44 and @xmath60 , respectively . in a more general context ,",
    "( [ ppcraw ] ) and ( [ bmkraw ] ) can be employed if , for example , the space @xmath62 is not parameterized by an orthogonal basis .    in this context",
    ", the motivation for removing the time series mean of the observations as described in section  [ secmotivating ] becomes apparent .",
    "we have not defined variation in terms of a constant vertical shift as being either periodic or aperiodic in nature .",
    "demeaning the observations ensures that there is zero variation in this direction and , hence , all the computed fpcs will also integrate to zero .",
    "had this step not been carried out , the constant shift would have been conflated with both periodic and aperiodic sources .",
    "if this constant source of variation were defined as periodic , a constant function could be added to the space @xmath62 .",
    "we now apply our ppc methodology on the harvard forest data . in the harvard forest data ,",
    "periodicity is set to be annual and thus we have 46 fourier basis functions with annual period .",
    "thus , @xmath104 and the space spanned by these functions is @xmath105 .",
    "we set @xmath106 in our calculation in order to get pairwise match between the ppcs and benchmarks .",
    "@xmath107 accounts for 93.4% of total variation .",
    "the robustness of ppc computation with respect to the choice of @xmath38 is further discussed in section [ stability ] .",
    "a selection of four pairs of ppcs and associated benchmarks with decreasing correlations are shown in figure  [ ppc ] .    the first ppc suggests the most important annual variation is the contrast between summer and winter .",
    "the second ppc has the effect of shifting summer forward or backward in time , while the third ppc corresponds to combined effect of growing season length and summer maximum evi .",
    "these leading ppcs demonstrate modes of variation which are most likely to repeat every year . from an ecological perspective , these sources of variance are of critical importance because they reflect signatures of climate variability in ecosystem processes .",
    "thus , ppcs provide a tool for characterizing and understanding how subtle changes in climate , such as shifts in the timing of seasons , are affecting ecosystems [ @xcite , @xcite ] .",
    "note that benchmarks are always exactly annual and the correlation between ppcs and their benchmarks decreases as we extract more ppcs .",
    "we thus construct a set of orthonormal functions which are ordered by their level of annual periodicity .",
    "this shows that the amount of annual variation contained in ppcs decreases as the index increases . a trade - off in defining",
    "which components should be denoted `` periodic '' is detailed in section  [ vardecompsec ]      choosing the number of fpc components , @xmath38 is a statistically challenging task .",
    "this number depends on several factors , including strength of signals , the choice of smoothing parameter , and sampling error as well as the choice of fpca methodology .",
    "an ideal factor rotation should be insensitive to the number of factors chosen .",
    "this is particularly important when there are many small components of variation and the number of components selected can be unstable . in the varimax rotation",
    "the interpretation of rotated components is very sensitive to @xmath38 .",
    "on the other hand , the ppcs provide a natural framework to achieve this goal when the principal sources of variation are periodic in nature .",
    "this is achieved due to the use of a well - defined reference subspace , thereby stabilizing the choice of `` interesting '' directions .",
    "we explored the stability of the leading rotated component for a range of choices for @xmath38the number of fpcs we rotate  from  5 to 50 in increments of  5 . in these data ,",
    "the first varimax component was highly unstable , while the first ppc remained stable and retained most of its interpretation for the whole range of @xmath38 ( see figure  [ scree ] ) .",
    "here we define the first important varimax component in any of three ways : ( i ) the component which accounts for the most variation , ( ii ) the component of @xmath38 fpcs that is closest to the first varimax direction derived with @xmath108 fpcs in the @xmath7 sense , and ( iii ) the component closest to the first fpc . to summarize the stability of these rotations",
    ", we explored the @xmath7 difference between components rotated using  @xmath38 and @xmath109 fpcs under each of the three varimax definitions above and using the first ppc component .",
    "the @xmath7 differences on ppc rotation are highly stable , whereas the measure for all of the varimax rotations shows large change in both directions .",
    "difference between rotated components derived on consecutive values of @xmath38 .",
    "the horizontal axis represents the value of @xmath38 , the number of fpcs used in rotations . for a given @xmath38 , the corresponding value on the vertical axis measures the @xmath7 difference between components obtained by rotating @xmath38 and @xmath108 fpcs",
    "three different dashed lines correspond to three definitions of the first varimax component .",
    "the solid line corresponds to the ppc .",
    "upper right : percentage of variation explained .",
    "diamonds are the cumulative variation explained by varimax components .",
    "squares are the cumulative variation explained by fpcs .",
    "circles are the cumulative variation explained by ppcs .",
    "triangles are the cumulative variation explained by benchmarks .",
    "lower left : ppc scree plot , computed as the amount of cumulative variation explained by benchmarks as a proportion of cumulative variation explained by ppcs ; lower right : correlation between ppcs and benchmarks . ]",
    "we demonstrate the variation decomposition using two sets of rotations , one being the standard varimax rotation and the other being the ppc rotation described in this paper . for comparing the two techniques we define component scores as evi curves projected on the set of orthogonal functions in which we are interested .",
    "denote the varimax components based on 46 fpcs by @xmath110 .",
    "then we have @xmath111 s^{\\xi}_{ij } & = & \\int_t\\tilde{z}_i(t)\\xi_j(t)\\,dt \\quad\\mbox{and}\\quad \\lambda^{\\xi}_j = \\frac{1}{n-1}\\sum_{i = 1}^n(s^{\\xi}_{ij})^2,\\\\[-3pt ] s^{\\theta}_{ij } & = & \\int_t\\tilde{z}_i(t)\\theta_j(t)\\,dt \\quad\\mbox{and}\\quad \\lambda^{\\theta}_j = \\frac{1}{n-1}\\sum_{i = 1}^n(s^{\\theta } _ { ij})^2,\\\\[-3pt ] s^{\\nu}_{ij } & = & \\int_t\\tilde{z}_i(t)\\nu_j(t)\\,dt \\quad\\mbox{and}\\quad \\lambda^{\\nu}_j = \\frac{1}{n-1}\\sum_{i = 1}^n(s^{\\nu}_{ij})^2.\\vadjust{\\goodbreak}\\end{aligned}\\ ] ] the cumulative sum of @xmath112 and @xmath113 are plotted in the upper right plot in figure [ scree ] .",
    "the varimax decomposition tends to produce equal decomposition , indicated by the low curvature of its cumulative sum .",
    "the fpcs decompose the total variation by their decreasing abilities to explain variation , producing the concave feature seen in its cumulative sum .",
    "variation explained by the benchmarks goes flat , suggesting the annual variation represented by benchmarks with low correlation tends to be orthogonal to @xmath114 .",
    "the increasing gap from the left to the right between ppc decomposition and benchmark decomposition reflects the decreasing ability to line up the rotated frames of @xmath107 and @xmath105 .",
    "in this subsection we develop an ad hoc methodology of choosing ppcs as nearly - annual , in order to separate annual variation from nonannual variation . since the level of annual periodicity decreases , it suffices to find a cut - off position and include all ppcs before the cutoff as nearly - annual and all ppcs after the cutoff as nonannual . to this end",
    ", we measure the cumulative amount of variation explained by benchmarks as a proportion of cumulative variation explained by ppcs and call it annual information ( ai ) .",
    "specifically , we define @xmath115 ai scores show an elbow around 8 ppcs ( see the lower left plot in figure  [ scree ] ) . this elbow suggests a possible position to cutoff .",
    "this position is further supported by the plot of correlation between ppcs and benchmarks where a sudden drop is observed around 8 ppcs . in the supplemental article [ @xcite ]",
    "we detail a simulation study investigating the efficacy of ai as a visual diagnostic where we demonstrate that the appropriate number of ppc s is selected with high probability .",
    "ppcs are modes of variation which are ordered by their level of annual periodicity . since ppcs are generated by orthogonally rotating the fpcs , ppcs form another empirical orthogonal basis which can be used to decompose evi curves .",
    "moreover , if we project evi curves onto ppcs and fpcs , the approximation by ppcs is as good as the approximation by fpcs .",
    "however , we can further decompose evi curves into nearly - annual and nonannual components .",
    "suppose @xmath116 and thus we have @xmath38 ppcs . if we have @xmath117 fpcs in total , then we have the following decomposition : @xmath118 \\\\[-8pt ] \\eqntext{1\\leq i\\leq n.}\\end{aligned}\\ ] ]    the first term on the right - hand side of ( [ decompose ] ) is the sample mean function . the second and the third terms are the nearly - annual component and nonannual component we determined in the last subsection .",
    "note @xmath119 in ( [ decompose ] ) is the number of ppcs we determined as nearly - annual . for the harvard forest data , @xmath119 is taken as 8 based on the ai elbow and the correlation criterion described in section  [ sectradeoff ] .",
    "the last term in ( [ decompose ] ) is the contribution of fpcs associated with very small eigenvalues , which are removed when we truncate to a certain percentage of variation .",
    "these are retained in conducting the simulation studies below .",
    "the decomposition result is shown in figure  [ non - annual ] .",
    "this decomposition helps us reconstruct original evi curves with restoring annual information as our priority .",
    "recall that our motivation of proposing ppcs is to separate annual and nonannual variation in the evi curves .",
    "we expect that change in variability , if any , should be contained in the nonannual component . to uncover this information , we look into the fpcs of this nonannual component",
    ". there are distinct features in the first four nonannual fpcs ; see figure [ non - annual ] . in particular , a multiple of either the first original or nonannual fpc are added to and subtracted from the mean curve to facilitate interpretation .",
    "the plus signs represent the curves which receive positive fpc scores , while the negative signs represent the curves which receive negative fpc scores .",
    "it is observed that the first nonannual fpc is mostly positive in the first three years and mostly negative in the last three years .",
    "the real message of the first nonannual fpc is that the most dominant change of variation is the contrast of evi relative to the cross - section mean between the first three years and the last three years .",
    "this contrast is also visualized by the gradual change of relative positions of plus and minus signs , shown in the upper panel of the lower right plot in figure  [ non - annual ] .",
    "there are also large peaks during the 5th and 6th years , indicating events specific to those years .",
    "the decreasing and last - two - year feature in the first nonannual fpc strongly correspond to and enhance the features observed previously in the first and second original fpcs .",
    "further , the second to the fourth nonannual fpcs all capture information in particular years",
    ".    we can further investigate the spatial structure of the estimated aperiodic effects by plotting the scores of the first nonannual fpc on a map of pixels .",
    "the map on the right in figure  [ scoremap ] show a noticeable south - west to north - east correlation structure that may be indicative of local geographic features . in preparing score maps in figure",
    "[ scoremap ] , we imputed the pixels which had been excluded due to blocks of missing observations by using the functional covariance structure estimated from the retained pixels .",
    "the imputation procedure is discussed in detail in the supplemental article [ @xcite ] .",
    "the existence of evident spatial correlation may require new approaches to fpca .",
    "@xcite demonstrate that fpca remains consistent under mild assumptions on spatial correlation .",
    "alternatively , @xcite provide an approach to directly account for spatial correlation.=-1      the high correlation between the first few ppcs and associated benchmarks gives rise to the question of whether there is exact annual variation contained in @xmath107 , the space of leading fpcs , or ppcs ( up to an orthogonal rotation ) .",
    "note that the first ppc has the highest correlation with any linear combination of the annual basis .",
    "so the test of whether there is exactly annual variation contained in @xmath107 is equivalent to testing the following hypothesis , @xmath120 where @xmath121 is the correlation between the first ppc and its corresponding benchmark defined in ( [ rho ] ) .",
    "note we have two ways to formulate this null hypothesis in terms of how we describe the leading fpc subspace @xmath107 , either by the number of fpcs spanning it , or the percentage of variation it explains .",
    "we explore both formulations in the following analysis .",
    "this null hypothesis does not follow the classical test of correlation coefficients in a multivariate setting [ see , e.g. , @xcite ] . here",
    "we test that the leading principal components have a nontrivial intersection with a predefined subspace rather than the independence of pairs of linear combinations of two random vectors .",
    "to do so , we need to generate a null distribution for @xmath122 which is no longer invariant to the covariance under the null .",
    "we therefore seek an approximate least - favorable covariance by a minimal perturbation of the data so as to satisfy @xmath123 and then apply a  bootstrap .",
    "we first generate hypothesized curves to approximate the functional covariance under the null hypothesis based on curves @xmath124 s .",
    "we rewrite ( [ decompose ] ) as=-1 @xmath125=0 under the null hypothesis , the first ppc and the first benchmark should be identical . then we can replace the first ppc with its associated benchmark in the above equation and further write @xmath126 @xmath127 s are called hypothesized curves under replacement .",
    "the eigenstructure of the covariance contained in @xmath127 s is an approximated least - favorable eigenstructure under the null .",
    "the correlation between the first ppc and its benchmark of @xmath128 s is 0.9999984 under both formulations of the null hypothesis , which we view as sufficiently close to 1 . a distribution of the test statistic @xmath121",
    "can now be generated based on this approximated null .",
    "one approach to obtaining a null distribution is to assume a distribution on component scores @xmath129 and @xmath130 , and produce a monte carlo distribution of @xmath121 . here",
    ", we make no distributional assumptions and apply a bootstrap procedure instead .     derived from bootstrap observations which are the sum of null curves bootstrapped from @xmath127 s and bootstrap residuals .",
    "the solid line is @xmath121 corresponding to the original curves of harvard forest data .",
    "the dashed line is the lower 0.05 critical value of the bootstrap distribution . ]",
    "we first sample with replacement from @xmath127 s to form bootstrap null curves . in order to accommodate the effect of pre - smoothing ,",
    "we bootstrap residuals obtained from pre - smoothing and add them onto each bootstrapped null curve .",
    "then we re - smooth these bootstrap observations and compute ppcs and first correlations .",
    "this testing procedure follows the same framework as that described in @xcite , where the authors tested the equality of functional means and covariances .",
    "details of this procedure are provided in the supplemental article [ @xcite ] .",
    "the histogram of bootstrap correlations with fixed number of fpcs is shown in figure  [ bootcor ] .",
    "the correlation between the first ppc and its associated benchmark computed from the observed data is around 0.9965 , which lies at the left tail of the bootstrap distribution , suggesting the major sources of variation do not cover the strictly periodic functions .",
    "we can also apply this test to examine a fixed percentage of variation explained instead of number of fpcs retained .",
    "the histogram of the null distribution from this test is very similar and the null hypothesis is also rejected .",
    "readers are referred to the supplemental article [ @xcite ] for detailed results .",
    "we have viewed the null hypothesis derived by replacing the first ppc with the first benchmark as being sufficiently close to the null hypothesis for our purposes . however , when this is not the case , the empirical first ppc correlation can be brought closer to 1 by inflating the first ppc scores .",
    "this method rescales the component score @xmath129 in ( [ replacenull ] ) and keeps @xmath130 fixed .",
    "this procedure allows the strength of annual signals to be increased .",
    "rescaled curves are expected to have @xmath121 enlarged toward 1 .",
    "however , this rescaling should be done in a way that distorts @xmath127 s and the covariance kernel implied as little as possible .",
    "hence , we put a penalty on the deviation of the hypothesized covariance kernel from the covariance kernel computed from  @xmath127 s , then we solve an optimization problem which finds a balance between approximating the null hypothesis and controlling for divergence .",
    "generally , let @xmath131 be the rescaling vector . then define hypothesized curves as=-1 @xmath132=0 the covariance kernels under replacement and inflation are given by @xmath133 where @xmath134 is the kernel based on curves under replacement and @xmath135 is the hypothesized kernel based on rescaled curves @xmath136 s . under the null hypothesis , @xmath137 and @xmath138",
    "are orthogonal to each other .",
    "it can be shown that the kullback ",
    "leibler divergence of @xmath139 from  @xmath134 is given by @xmath140 given @xmath141 s which are functions of @xmath142 , we can compute ppcs and the first correlation @xmath143 .",
    "ideally , we want to minimize @xmath144 with the restriction that @xmath145 .",
    "this is achieved approximately by placing a large penalty on the difference between @xmath146 and 1 .",
    "then we solve the following optimization : @xmath147 where @xmath148 is a very large number .",
    "denote the optimizer to ( [ inflatednull ] ) by @xmath149 .",
    "then , @xmath150 s are constructed according to ( [ inflatedcurve ] ) .",
    "the eigenstructure implied by @xmath150 s is closer to the null hypothesis than that implied by @xmath127 s .",
    "this procedure is investigated in detail in the supplemental article [ @xcite ] where ( [ inflatednull ] ) is solved with a sequence of @xmath148 values .",
    "while the first correlation obtained by this method increases , there is little effect on the test results .",
    "in this section we explore the stability and accuracy of ppc under random sampling .",
    "two simulation schemes show the sensitivity and robustness of ppc in identifying annual variation .      in this simulation scheme ,",
    "we demonstrate how sensitive the ppc is in detecting annual variation . in the construction of the simulated curves ,",
    "we take the linear combination of fourier basis functions with different frequencies .",
    "we create 6 sets of simulated curves .",
    "each set contains 200 curves and incorporates a different amount of annual variation by rescaling the coefficient of fourier basis functions which are annual . in particular , denote the @xmath15th curve in the @xmath55th set by @xmath151 .",
    "these curves are generated as a linear combination of longer term components and annual components as follows : @xmath152 \\\\[-8pt]&&{}+ \\sqrt{l_j}\\bigl(\\sigma_{4ji1}{\\sin(4\\omega t ) } + \\sigma_{4ji2}{\\cos ( 4\\omega t)}\\bigr ) , \\nonumber\\end{aligned}\\ ] ] where @xmath153 , @xmath154 , @xmath155 , @xmath156 , i.i.d .",
    ", @xmath157 , @xmath158 , @xmath159 , @xmath160 , @xmath161 , @xmath162 , and @xmath163 .",
    "@xmath164 is the time span of the simulated curves .",
    "we take @xmath165 and @xmath151 spans over 4 years .",
    "thus , @xmath166 and @xmath167 are sources of annual variation .",
    "the fourier basis functions in the first two components of @xmath168 are orthogonal to annual basis functions and thus do not contribute to the annual variation .",
    "the @xmath169 s control the amount of annual variation .",
    "the larger the @xmath169 , the greater the amount of annual variation .",
    "we compute ppcs with @xmath170 of total variation cutoff in choosing how many fpcs we retain in all 6 sets . the result for @xmath161",
    "is shown in the left 3 plots of figure  [ simppc ] .",
    "the fpcs do not capture the underlying source of annual variation .    ;",
    "right : simulation scheme 2 with @xmath171 . ]",
    "how much each sinusoidal function is reflected in retained fpcs depends on both the sample variance and covariance of @xmath172 and on their interaction with other sources of variation .",
    "however , @xmath166 and @xmath173 can be identified by ppcs even when their variation are on the same level ( @xmath161 ) as other sources .",
    "the benchmarks exactly reproduce the annual signals , however , with phase shifting .",
    "the shifted phase is caused by the randomness in sampling @xmath174 and @xmath175 .",
    "to summarize the simulation results for all @xmath169 s , we compute the standardized - inner - product ( correlation ) between the ppc - benchmark pair and between the fpc - benchmark pair .",
    "since the sign is irrelevant with both fpcs and ppcs , we take the absolute values of the correlations .",
    "the boxplot of the unsigned correlations of the first and the second pairs are shown in the upper - left and lower - left plots in figure  [ simcor ] .",
    "for both the first and second pairs , fpc - benchmark correlations show an increasing trend toward 1 .",
    "as we include more annual variation , the fpcs will tend to be more nearly annual .",
    "however , the speed of fpc - benchmark correlations going to 1 is much slower compared to that of ppc - benchmark correlations .",
    "moreover , ppc - benchmark correlations are always higher than fpc - benchmark correlations for all @xmath169 s .",
    "this observation demonstrates the sensitivity of ppcs in detecting annual variation among curves .     and associated benchmarks @xmath5 .",
    "light boxes are correlations between fpcs , @xmath176 and associated benchmarks @xmath5 .",
    "upper left : simulation scheme 1 results on @xmath177 , @xmath178 and  @xmath179 ; upper right : simulation scheme 2 results on @xmath177 , @xmath178 and  @xmath179 ; lower left : simulation scheme  1 results on @xmath180 , @xmath181 and  @xmath182 ; lower right : simulation scheme 2 results on @xmath180 , @xmath181 and  @xmath182 . ]      in the second simulation scheme , we add one more source of variation which is generated by nonannual fourier basis functions with high frequency .",
    "we call it high frequency disturbance ( hfd ) . according to the definition ,",
    "the hfd is not a source of annual variation . in our simulation study",
    ", we construct 4 sets of simulated data , 200 curves each , which contain different levels of hfd .",
    "we test ppcs robustness of detecting annual variation in the presence of hfd . specifically , denote the @xmath15th curve in the @xmath55th set by @xmath183",
    ". then it is generated as @xmath184 where @xmath185 , @xmath153 , @xmath186 , @xmath187 , @xmath188 , i.i.d .",
    ", @xmath157 , @xmath189 , @xmath190 , @xmath171 , and @xmath191 .",
    "@xmath164 equals 100 , spanning over 4 years , as in the first simulation .",
    "the functions @xmath166 and @xmath192 are still the sources of annual variation which have the same amount of variation in the 4  sets of this simulation scheme .",
    "@xmath193 is the frequency of hfd and is set to be 19 in our simulation . @xmath194 and @xmath195 are hfd whose amount of variation varies and are controlled by @xmath169 s .",
    "larger @xmath169 value suggests greater amount of hfd and , hence , it is more difficult to extract annual signals for larger @xmath169 s . in this scheme , we also use @xmath170 as the cutoff to decide the number of fpcs we retain .",
    "the computed ppcs for @xmath171 is shown in figure  [ simppc ] .",
    "with amount of hfd 5 times as great as annual variation , the fpcs are dominated by hfd and thus show a clear 19-periodic pattern .",
    "however , our first two ppcs still show a reasonably good annual pattern . to summarize results for all @xmath169 s , we plot the fpc - benchmark and ppc - benchmark correlations of the first two pairs in the upper - right and lower - right plots in figure  [ simcor ] . again , for both pairs , the fpc - benchmark correlations are always lower than the ppc - benchmark correlations .",
    "further , even for large hfd contamination ( @xmath196 ) when the fpc - benchmark correlations hover near zero , the ppc - benchmark correlations display much higher values , suggesting that the ppcs provide more robust directions compared to fpcs as the amount of hfd increases .    based on these two simulations ,",
    "we find ppcs are both sensitive and robust identifiers of the source of annual variation .",
    "despite the popularity of functional principal component analysis , little attention has been paid to the problem of factor rotation to improve the interpretability of modeled principal component directions .",
    "the smoothness , or ordering , properties of functional data analysis mean that factor rotation methods that are applicable for multivariate data are not always appropriate in a functional context .",
    "conversely , new factor rotation methods may be applicable in functional data analysis that do not have analogues in multivariate statistics . as for all factor rotation methods , it is important to recall that the resulting directions are obtained as an interpretable means of representing the data , rather than independent mechanistic sources of variance .    in this paper",
    ", we have presented a factor rotation method motivated by remote sensing data and intended to improve our understanding of factors involved in ecological responses to climate change . in this data",
    "set we seek to differentiate seasonal sources of variation from both longer - term and localized effects . to do this , we present principal periodic components as a  means of extracting nearly - periodic directions in the data .",
    "this factor rotation has the advantage of being efficiently implementable via canonical correlation analysis and effective at extracting periodic information .",
    "we have developed graphical tools to assess the level of periodicity in the data and to decide on thresholds between periodic and aperiodic signals .",
    "further , a  heuristic test of exact periodicity demonstrates that the addition of some further flexibility in our periodic signals is appropriate .    at its most general",
    ", our approach can be described as a rotation toward an interpretable subspace and applies to multivariate factor rotation as well as in functional data analysis . in our application ,",
    "the set of periodic functions represents the most clearly relevant subspace for interpretation",
    ". however , alternative subspaces may be useful in other contexts ; for example , in @xcite a psychological experiment is described in which a stimulus is changed at prespecified times and a data - set of continuously - measured responses is recorded . in this case , a basis of step functions corresponding to change - times represents a relevant reference subspace with which to examine the functional response to the stimulus sequence .",
    "the choice of reference subspace depends strongly on the details of the application at hand . in our own application",
    ", we could have sought further rotations of aperiodic signals toward linear or exponential trends as a means of separating long - term effects from effects localized to individual years . beyond this approach",
    ", we expect a more general exploration of sources of variation within the context of functional data analysis to be an important source of future research directions ."
  ],
  "abstract_text": [
    "<S> we present a new approach to factor rotation for functional data . </S>",
    "<S> this is achieved by rotating the functional principal components toward a predefined space of periodic functions designed to decompose the total variation into components that are nearly - periodic and nearly - aperiodic with a predefined period . </S>",
    "<S> we show that the factor rotation can be obtained by calculation of canonical correlations between appropriate spaces which make the methodology computationally efficient . </S>",
    "<S> moreover , we demonstrate that our proposed rotations provide stable and interpretable results in the presence of highly complex covariance . </S>",
    "<S> this work is motivated by the goal of finding interpretable sources of variability in gridded time series of vegetation index measurements obtained from remote sensing , and we demonstrate our methodology through an application of factor rotation of this data .    ,    ,    . </S>"
  ]
}