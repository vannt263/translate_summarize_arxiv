{
  "article_text": [
    "the plinth of cryptography is built upon the properties of confusion and diffusion as stated by shannon in 1949 @xcite , which can be linked to the main characteristics of chaotic systems : ergodicity and sensitivity to control parameters and initial conditions .",
    "the connection between the basic coordinates of cryptography and chaotic systems has paved the research on chaotic cryptography @xcite .",
    "a lot of different methods have been proposed in the field of chaos - based cryptography , but most of them show very serious security flaws ( * ? ? ?",
    "* chapters 8 and 9 ) .",
    "a very important family of chaotic cryptosystems is the one inheriting the characteristics of the substitution - permutation networks ( spns ) , as it is explained in @xcite .",
    "this kind of architecture is not secure unless the avalanche criterion is satisfied @xcite . as matter of fact",
    ", the inclusion of chaotic systems in this kind of architecture does not guarantee security and the assessment of the avalanche property should be thoroughly carried out @xcite . in @xcite",
    "a chaotic cryptosystem is proposed to encrypt colour images through the permutation of their columns and rows , along with a substitution procedure based on the logistic map . from a general point of view , this cryptosystem can be interpreted as one round of a spn .",
    "this kind of architecture present a very low level of confusion and security pitfalls if the substitution stage can be rewritten as a way to change the plaintext according to a keystream which is independent of the plaintext . as we will discuss along this paper",
    ", this is the case of the cryptosystem described in @xcite .",
    "the rest of the paper is organized as follows . in sec .",
    "[ sec : description ] it is described the cryptosystem under examination . with the aim of underlining the shortcomings of this encryption scheme , we discuss in sec .  [",
    "sec : weaknesses ] some limitations with respect to the dynamical system bearing encryption , to the key space and , finally , in regards to the diffusion property of the cryptosystem .",
    "the analysis is complemented by remarking the vulnerability of the cryptosystem against a chosen - plaintext attack . in this concern , we explain along sec .  [",
    "sec : probl - deriv - from ] how to elude the security laying on the encryption architecture selected in @xcite . finally , in sec .",
    "[ sec : conclusions ] we summarize and discuss the results of the cryptanalysis .",
    "the encryption procedure defined in @xcite is applied on colour plain - images of size @xmath0 and coded in rgb format .",
    "the plain colour image is treated as a matrix @xmath1 of size @xmath2 , whereas the cipher - image is given by @xmath3 also of size @xmath2 . for the sake of clarity ,",
    "we have first modified the notation used in @xcite and second divided the encryption method into four stages ( see fig .",
    "[ fig : encryption ] ) :    1 .",
    "_ rows permutations_. + the colour plain - image @xmath1 is transformed into a gray - scale image @xmath4 of size @xmath5 , just by incorporating the rows of the green and blue components after the rows of the red one .",
    "let @xmath6 be a permutation matrix that transforms @xmath4 into @xmath7 by shuffling its rows in a pseudo - random way , through the iteration of the logistic map for control parameter equals to @xmath8 and initial condition given by @xmath9 .",
    "the logistic map is defined by the iteration function @xmath10 and the orbit @xmath11 can be generated from a given initial condition @xmath12 by doing @xmath13 .",
    "columns permutations_. + the matrix @xmath7 is converted into a matrix @xmath14 of size @xmath15 , by combining horizontally ( one after the other ) the three groups of @xmath16 rows that define @xmath7 . for each row of @xmath14",
    ", the pixels are permuted according to the corresponding row of a permutation matrix @xmath17 .",
    "the resulting matrix is noted as @xmath18 .",
    "again , this permutation matrix is obtained by iterating the logistic map in this case with control parameter @xmath19 and initial condition @xmath20 .",
    "selection of the next pixel to encrypt_. + once pixels have been shuffled , substitution is performed using a keystream and selecting the pixel to encrypt based on a pseudo - random sequence @xmath21 , with @xmath22 .",
    "the sequence @xmath23 determines if the next pixel to encrypt proceeds from either the first n columns ( @xmath24 ) , the second group of n columns ( @xmath25 ) , or the third set of columns ( for @xmath26 ) of @xmath27 . in case",
    "all pixels of a band have been already selected , the pixel to encrypt is chosen from the next colour band ( after the blue pixels , the next ones are the red ) . consequently , a vector @xmath28 of length @xmath29 is obtained by reading each colour component of @xmath30 from the first row and from the left to the right , according to the selection vector @xmath31 .",
    "substitution stage_. + finally , the output of the previous step is masked using a keystream @xmath32 .",
    "the update rule is given by @xmath33 the resulting cipher - image @xmath3 is derived from @xmath34 using @xmath31 , i.e. , by grouping the pixels of @xmath35 into colour components in the reversed order that they were grabbed from @xmath30 to build up @xmath28 .    according to @xcite ,",
    "the secret key of the cryptosystem consists of the set of values @xmath36 , which are used to compute two orbits of the logistic map ( eq .  ) .",
    "those orbits are the core of the procedures to generate the permutation matrices @xmath6 and @xmath37 , the pseudo - random sequence @xmath31 , and the keystream @xmath38 .",
    "as we discuss below , the cryptanalysis of the cryptosystem can be carried out independently of those generation procedures . for a more detailed description of any of those procedures or other design details",
    ", please refer to sec .",
    "2.1 of @xcite .",
    "as result of our previous work on the field of chaos - based cryptography @xcite , we can conclude that the most critical problems in chaotic cryptography are linked to three aspects : the selection of the chaotic system , the choice of an encryption architecture , and the implementation of the cryptosystem . in the specific scenario depicted by @xcite ,",
    "there exist some problems that we have previously highlighted in regards to both the selection of the chaotic system and the encryption architecture @xcite .",
    "those problems inform about a non exhaustive description of the cryptosystem , but also about security breaches .",
    "the drawbacks of the cryptosystem definition are derived in sec .",
    "[ sec : non - exha - defin ] by studying the key space of the cryptosystem on account of the dynamical properties of the underlying chaotic map , and in sec .",
    "[ sec : low - sens - change ] through the discussion of the diffusion property of the encryption architecture .",
    "the security analysis is the core of sec .",
    "[ sec : probl - deriv - from ] .",
    "one major concern in chaotic cryptography is on designing cryptosystems in such a way that the underlying dynamical systems evolves chaotically ( * ? ? ?",
    "* rule 5 ) . in the case of the logistic map ( and other maps ) , this resorts to the evaluation of the lyapunov exponent in order to guarantee chaoticity ( see fig .  [",
    "fig : lyapunov ] ) . as a matter of fact , after the myrberg - feigenbaum point ( @xmath39 ) it can not be asserted that the logistic map is always chaotic due to the existence of a dense set of periodic windows ( i.e. , of values of @xmath40 implying _ regular _ and _ non stochastic _ behavior @xcite ) .    .",
    "the selection of @xmath8 and @xmath19 should be performed guaranteeing chaoticity , i.e. , positive values for the lyapunov exponent . ]    additionally , in @xcite the use of the logistic map relies not only on its positive rate of local divergence , but also on its topological properties .",
    "certainly , the permutation of columns and rows is conducted by the ordering of chaotic orbits of the logistic map of length @xmath29 and @xmath41 , respectively . in this sense",
    ", we should assess whether the number of possible permutations on the values of those orbits is at least equal to the number of possible initial conditions .",
    "the number of initial conditions is given by the inverse of the _ machine epsilon _",
    "@xcite , which is @xmath42 for double precision floating - point arithmetic . on the other hand ,",
    "the number of possible permutations on a given orbit of length @xmath43 is @xmath44 . in the case of deterministic dynamical systems",
    ", this upper value is not reached due to the existence of a set of _ forbidden _ permutations @xcite .",
    "if we restrict our discussion to dynamical systems with iteration function @xmath45 defined as a scalar , then the cardinality of the set of possible permutations of an orbit is upper bounded by @xmath46 @xcite , where @xmath47 is the topological entropy of the map @xmath45 @xcite . for unimodal maps",
    "the topological entropy can be easily computed according to the theory of applied symbolic dynamics @xcite and , in some cases , it is even possible to give a closed analytical form @xcite . in fig .",
    "[ fig : top_log ] we show the topological entropy of the logistic map with respect to the control parameter . according to the scope depicted by the permutation phases of the cryptosystem defined in @xcite , the control parameter",
    "should be selected in such a way that @xmath48 is greater than @xmath49 .",
    "if we consider that the smallest value for @xmath16 and @xmath50 is 128 , then the previous restriction is satisfied for @xmath40 above @xmath51 .",
    "this fact implies a reduction of the key space as defined in @xcite and , although it is not a large shortening , it indeed informs about the needs of using not only the lyapunov exponent but also the topological entropy as core of the selection of the keys of the cryptosystem .",
    "finally , another problem when defining the key space of the cryptosystem arises from the symmetry of the iteration function of the logistic map . as it is commented in @xcite , the fact that eq .",
    "( [ eq : logistic ] ) satisfies @xmath52 implies that @xmath9 and @xmath53 are equivalent sub - keys for decryption .",
    "the same applies to @xmath20 and @xmath54 .      in the context of cryptography",
    "a minor change in the input of a cryptosystem should imply a major change in the corresponding output ( * ? ? ?",
    "* rule 9 ) . in this respect , if we take into account two images @xmath55 and @xmath56 with only one different pixel , then the associated cipher - images should be very different . to assess this property for the cryptosystem in @xcite",
    ", we have encrypted the images in fig .",
    "[ fig : low_sensitivity ] using as key @xmath57 , @xmath58 , @xmath59 , and @xmath60 .",
    "the differential cipher - image is equal to zero for a meaningful set of pixels , which informs about the limitations of the diffusion property of the cryptosystem given in @xcite regarding changes in the plain - image .",
    "according to @xcite , the security assessment of any cryptosystem must be carried out ( at least ) with respect to four basic attacks :    * ciphertext - only attack : the cryptanalysis only knows the result of encryption . *",
    "known - plaintext attack : several pairs of plaintext and ciphertext are accessible for the cryptographer .",
    "* chosen - plaintext attack : the attacker gains access to the encryption machine and performs cryptanalysis by selecting adequate plaintexts . *",
    "chosen - ciphertext attack : the decryption machine can be used by the cryptanalyst , which chooses ciphertexts in order to extract information about the secret parameters of the cryptosystem .    in this section we show that the cryptosystem described in @xcite does not exclude the successful application of a chosen - plaintext attack .      as it has been pointed out in sec .",
    "[ sec : description ] , the encryption scheme consists of two classes of procedures : permutation and substitution of pixels .",
    "the main weakness of the proposal is a consequence of the independence between the shuffling stages and the last stage , i.e. , the one concerning the substitution of pixels .",
    "this fact can be exploited by means of the following _ divide - and - conquer attack _ , using as bottom - line chosen plain - images which are neutral elements with respect to row / column permutations @xcite . in this sense , if one encrypts a plain - image with all pixels equal to the same value , then the output of the shuffling procedures is the same plain - image .",
    "moreover , if the plain - image is selected forcing all rows / columns being equal , then encryption only shuffles columns / rows .    in correspondence to the previous comments , we can mount an attack based on a chosen plain - image with all pixels equals to zero .",
    "let @xmath1 be a colour image with all pixels equal to zero , which implies that @xmath61 for @xmath62 .",
    "taking into account eq .",
    "( [ eq:1 ] ) , we have @xmath63 for @xmath64 . from the previous equation we can find the value of @xmath65 just by subtracting @xmath66 from @xmath67 .",
    "if we want to apply the recovered @xmath38 to get any @xmath28 from the corresponding @xmath35 , then @xmath31 must be obtained .",
    "this commitment can be accomplished using a second _ constant value plain - image_. for instance , we can use a chosen plain - image with all pixels equal to one .",
    "this being the case , we have @xmath68 for @xmath62 and @xmath69 for @xmath70 .",
    "let us focus on the image given as the difference between the cipher - images obtained from @xmath71 and @xmath72 respectively .",
    "since the difference between eq .",
    "( [ eq:3 ] ) and eq .",
    "( [ eq:4 ] ) is equal to @xmath73 , the components of @xmath31 are determined by looking for the pixel with value @xmath73 in each colour band of that difference image .",
    "if that pixel belongs to the red component , then @xmath74 ; if it is one of the green pixels , then @xmath75 ; finally , @xmath76 leads to a pixel in the blue band .",
    "once the substitution keystream @xmath38 and the selection vector @xmath31 have been obtained , it is possible to reconstruct the input of the shuffling procedures according to @xcite .",
    "this new goal is going to be achieved by using @xmath77 chosen plain - images . in this paper",
    "we restrict our analysis to images of the same size as those used in @xcite , i.e. , images of size @xmath78 and , consequently , four chosen - plain images are required to elude the permutation - only phase .    in order to validate our cryptanalysis , we have configured an encryption machine by selecting the key defined by the set @xmath57 , @xmath58 , @xmath59 , and @xmath60 . upon the assumption of having access to the encryption machine , we encrypt an image equal to zero and an image with all pixels equal to 1 .",
    "the cryptanalysis described in sec .",
    "[ sec : break - conf - stage ] is applied , and thus the keystream @xmath38 and the pseudo - random sequence @xmath31 are recovered . as it is commented in similar",
    "cryptanalysis works @xcite , the recovering of those sequences is equivalent to getting the secret key .",
    "nevertheless , the complete cryptanalysis of the cryptosystem in @xcite demands to infer a permutation matrix representing the composition of the permutation procedures lead by @xmath6 and @xmath37 .",
    "this goal can be achieved by using plain - images with all rows / columns equals . to illustrate the cryptanalysis we are going to extract the original positions of the pixels of the first row of @xmath79 .",
    "first , we encrypt a plain - image with each colour component determined by @xmath80 if we consider the vector @xmath81 of length 768 given by the concatenation of the first row of red , green , and blue component of the cipher - image , it is easy to verify that it contains only three values .",
    "the values corresponding to the selected secret key are 93 , 203 , and 223 , which indicates that the first row of the cipher image comes from either the row 93 , 203 , 223 of either of the colour components of the plain image . in order to establish the colour band of each of the three candidates for row permutation",
    ", we encrypt a plain - image with red component with all pixels equal to zero , green band being 1 , and blue component being 2 .",
    "then , we look for the occurrences of 0 , 1 , and 2 in the first row of each colour component of the cipher - image . the intersection of this new vector of indexes of occurrence with the previous one enables to conclude that @xmath81 contains the row 93 of the blue band of the plain - image , the row 203 of the red component of the plain - image , and the row 223 of the red component of the plain - image . after identifying the source of the first row of @xmath79",
    ", we need to label each pixel of the rows identified as sources of that row .",
    "this aim is fulfilled if we encrypt a colour image with its three colour components equal to @xmath82 afterwards , we look for the occurrences of @xmath83 through the vector @xmath81 .",
    "the indexes of occurrence are given by the set @xmath84 .",
    "let us begin with @xmath85 , which is @xmath86 for the selected key .",
    "the set @xmath85 implies that either of the referred pixels comes from the first pixel of either the row 93 of the blue component , the red row number 203 , or the row 223 of the red band of the plain - image . to select the proper value among the three candidates for the three identified pixels , we encrypt an plain - image such that the row 93 of the blue component is @xmath87 the red row number 203 @xmath88 and the row 223 of the red band",
    "is defined as @xmath89 again , we look for @xmath90 through @xmath81 and we obtain the indexes of occurrence 235 , 356 , and 556 . only 356 is included in the previous set @xmath85 , and as a result we have that the first pixel of the row 93 of the blue component of @xmath1 goes to the pixel 100 ( @xmath91 ) of the first row of the green component of @xmath79 . if we proceed in the same fashion with @xmath84 for @xmath92 , then we obtain the permutations for all the pixels of the row 93 of the blue band of the plain - image .",
    "the same applies to the row 203 ( 223 ) of the red band , but taking into account that the first pixel of the row is now labeled by 255 ( 254 ) .",
    "if one applies the previous methodology for all the rows of the cipher - image , then the permutation matrix can be inferred . in this sense",
    ", we have applied the cryptanalysis based on the six chosen plain - images to an encryption machine with secret key @xmath57 , @xmath58 , @xmath59 , and @xmath60 .",
    "the cryptanalysis allows to get @xmath31 , @xmath38 , and the permutation matrix , which is equivalent to obtain the secret key . to verify this assertion we have encrypted an image ( the result is in fig .",
    "[ fig : chosen](a ) ) , applied the cryptanalysis , and decrypted the cipher - image using the outputs of the cryptanalysis .",
    "the decrypted image is the one in fig .",
    "[ fig : chosen](b ) , which coincides with the original plain - image .",
    "in this paper we have studied in detail a recent proposal in the area of chaos - based cryptography .",
    "we have underlined some problems related to the dynamical properties of the system sustaining encryption , and we have also pinpointed some flaws related to the encryption architecture .",
    "the goal of our work was not simply to show the problems of a given chaotic cryptosystem , but to highlight the possibility of creating secure proposals to encrypt information using chaos . in this flavour ,",
    "our recommendation is on the line of the set of rules given in @xcite .",
    "this work was supported by the uam projects of teaching innovation and the spanish government projects tin2010 - 19607 and bfu2009 - 08473 .",
    "the work of david arroyo was supported by a juan de la cierva fellowship from the ministerio de ciencia e innovacin of spain .",
    "d.  arroyo , framework for the analysis and design of encryption strategies based on discrete - time chaotic dynamical systems , ph.d .",
    "thesis , etsia of the polytechnic university of madrid , madrid , spain , avalaible online at http://digital.csic.es/handle/10261/15668 ( july 2009 ) .",
    "d.  arroyo , r.  rhouma , g.  alvarez , s.  li , v.  fernandez , on the security of a new image encryption scheme based on chaotic map lattices , chaos : an interdisciplinary journal of nonlinear science 18 ( 2008 ) 033112 , 7 pages .",
    "d.  arroyo , g.  alvarez , v.  fernandez , on the inadequacy of the logistic map for cryptographic applications , in : l.  hernandez , a.  martin ( eds . ) , x reunin espaola sobre criptologa y seguridad de la informacin ( x recsi ) , universidad de salamanca , salamanca , spain , 2008 , pp . 7782 , ( isbn 9788469151587 ) .",
    "d.  arroyo , j.  m. amig , s.  li , g.  alvarez , on the inadequacy of unimodal maps for cryptographic applications , in : j.  d. ferrer , a.  m. ballest , j.  c. roca , a.  s. gmez ( eds . ) , xi reunin espaola sobre criptologa y seguridad de la informacin ( xi recsi ) , universitat rovira i virgili , tarragona , spain , 2010 , pp . 3742 , isbn 9788469333044 .                        s.  li , c.  li , g.  chen , n.  g. bourbakis , k .-",
    "lo , a general quantitative cryptanalysis of permutation - only multimedia ciphers against plaintext attacks , signal processing : image communication 23  ( 3 ) ( 2008 ) 212  223 ."
  ],
  "abstract_text": [
    "<S> the interleaving of chaos and cryptography has been the aim of a large set of works since the beginning of the nineties . </S>",
    "<S> many encryption proposals have been introduced to improve conventional cryptography . </S>",
    "<S> however , many of those proposals possess serious problems according to the basic requirements for the secure exchange of information . in this paper </S>",
    "<S> we highlight some of the main problems of chaotic cryptography by means of the analysis of a very recent chaotic cryptosystem based on a one round substitution permutation network . </S>",
    "<S> more specifically , we show that it is not possible to avoid the security problems of that encryption architecture just by including a chaotic system as core of the derived encryption system .    </S>",
    "<S> image encryption , substitution permutation networks , permutation - only ciphers , unimodal maps , chosen - plaintext attack . </S>"
  ]
}