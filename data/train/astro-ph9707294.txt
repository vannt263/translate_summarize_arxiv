{
  "article_text": [
    "as quantitatively pioneered by those such as @xcite  ( 1953 ) , @xcite  ( 1977 ) and @xcite  ( 1978 ) and more recently noted by authors such as frenk  ( 1995 ) , hierarchical galaxy formation models in @xmath4 cold dark matter ( cdm ) universes typically combine assumptions on up to six distinct physical processes : ( 1 ) the non - linear growth phase of matter density peaks ( known as `` haloes '' ) , ( 2 ) cooling gas dynamics , ( 3 ) star formation , ( 4 ) star - to - gas energy feedback , ( 5 ) stellar evolution , ( 6 ) galaxy mergers . in principle , if there are more free parameters describing these processes than independent observational galaxy statistics , then the observations should provide little constraint on galaxy formation `` recipes '' .",
    "fortunately , the contrary is presently the case for the `` semi - analytical _ ab initio _ '' models which make various analytical estimates of process ( 1 ) , combine semi - empirical and simple scaling parametrisations to represent processes ( 2)-(4 ) and ( 6 ) and use evolutionary stellar population synthesis for process ( 5 ) . since each of these models have problems explaining at least some of the observations means , the models are better constrained than might have been hoped for .",
    "these models can be considered to be semi - analytical because rather than calculating what is possibly the most important process , the non - linear formation and merging history of collapsed objects [ process ( 1 ) ] , via n - body simulations , various statistical analytical approximations are used .",
    "the models of lacey  ( 1993 ) use an approximation developed in @xcite  ( 1991 ) from the bbks peaks formalism ( @xcite  1986 ) , kauffmann et al .",
    "( @xcite  1993 ; @xcite  1993 ) use a probabilistic method ( @xcite  1991 ) based on the press - schecter formalism ( e.g. , @xcite  1974 ; white & frenk 1991 ) and excursion set mass function calculations ( @xcite  1991 ) while @xcite  ( 1994 ) use a spatially quantised `` block '' method described in @xcite  ( 1988 ) .",
    "further semi - analytical developments include those adding spatial auto - correlation information to a press - schechter formalism ( @xcite  1996 ) or to the `` block '' model ( @xcite  1996 ; @xcite  1997 ) and a technique of separately treating global , weakly non - linear and local , strongly non - linear dynamics ( the `` peak - patch '' formalism , @xcite  1996 ) .",
    "each of the models which has been compared to observational statistics has difficulty in simultaneously explaining the flatness of the present - day ( surface - brightness limited ) galaxy luminosity function ( e.g. , loveday  1992 ) , the steepness of the faint galaxy counts ( e.g. , @xcite  1988 ; @xcite  1988 ) , the shape of the moderately faint galaxy ( @xmath5 ) spectroscopic redshift distributions ( e.g. , @xcite  1990 ; @xcite  1993 ) , the tully - fisher relation and the colour distributions of present - day galaxies , in a cdm @xmath4 universe .",
    "even though the @xcite  ( 1994 ) model is better than the previous models in allowing big @xmath6 galaxies to be at least as red as higher @xmath7 galaxies , it shares the problem of the other models in lacking big red ellipticals .",
    "it also shares with the @xcite model the problem that if the large number of small haloes predicted by cdm models at @xmath8 follow the ir tully - fisher relation ( e.g. , @xcite  1992 ) , then the slope of the faint end of the general galaxy luminosity function should be steeper than that estimated locally ( e.g. , loveday  1992 ) . changing the cosmology in the @xcite models ( @xcite  1995 : low @xmath9 , low @xmath10 , non - zero @xmath11 and chdm models ) is insufficient to match the observations .",
    "another way of allowing these models to fit the observations is to make a strong assumption for process ( 6)to suppose that galaxies can merge as fast as galaxy haloes merge , or even faster  but simple present - day constraints on the products of the mergers ( @xcite  1993 ) and the relative weakness of the faint galaxy angular auto - correlation function ( @xcite  1993 ) strongly restrict this possibility .    in order to avoid problems which may be due to the approximation of non - linear gravitational collapse and evolution by the semi - analytical techniques mentioned above , an alternative technique is to calculate both processes ( 1 ) and ( 2 ) from first principles in numerical n - body simulations , folding in the other physical processes as simple scaling formulae or using stellar population synthesis for ( 5 ) .",
    "several authors ( e.g. , @xcite 1988 ; @xcite  1991 ; @xcite  1992 ; @xcite  1993 ; @xcite  1995 ) have experimented with these techniques , but resolution limits on present - day computers make the results hard to interpret . for example , @xcite  ( 1997 ) point out that although low resolution gravito - hydrodynamic simulations suggest that a uv photoionisation background can suppress galaxy formation ( by heating the gas so that it is unable to cool and form stars ) , higher resolution simulations show that this is a numerical artefact : the higher resolution simulations show little sensitivity to either the details of photoionisation or star formation .    in this article , rather than claiming a global `` recipe '' for galaxy formation , our primary purpose is to concentrate on process ( 1 ) in a way complementary to that of other techniques .",
    "this is unlikely to be sufficient to solve all the observational conflicts . on the contrary",
    ", this method should increase the ability of modellers to verify the extent to which model predictions are sensitive to the precision of modelling of gravity .",
    "the method presented here is to derive merging history trees of dark matter haloes directly from n - body simulations",
    ". rather than just investigating virialised haloes for a particular dark matter model ( e.g. , cdm ) , ( a ) both @xmath0 and @xmath1 initial perturbation spectrum simulations ( where @xmath12 is the index of the power spectrum ) are examined , and ( b ) since the halo - to - galaxy relationship may be more complex than a simple one - to - one mapping , two significantly different density thresholds are used for halo detection .",
    "this reveals the sensitivity of halo merger history trees and halo statistics to these parameters .",
    "the n - body simulations used are presented in ",
    "[ s - n - body ] , the choice of a group - finding algorithm in  [ s - peakalg ] and the defining criterion and algorithm for calculating the merging history trees in  [ s - tree ] .",
    "properties of the haloes detected are discussed in  [ s - halostats ] . in particular , the resulting merging history trees are presented in graphical form in  [ s - mhtrees ] , enabling patterns of halo merging calculated from fully non - linear simulations to be visualised directly .    if processes ( 2)-(5 ) are simple enough , and if process ( 6 ) , galaxy merging , corresponds in a one - to - one way with halo merging , then these halo merger history trees would lead directly to galaxy merger history trees .",
    "we therefore examine an example application of the merger history trees by making minimal assumptions for processes ( 2)-(4 ) , using stellar evolutionary population synthesis for process ( 5 ) , and for process ( 6 ) , assuming maximal galaxy merging ( every halo merger corresponds to a galaxy merger ) . ",
    "[ s - bursts ] presents ( 6)+(3 ) merger - induced star formation and  [ s - geps ] explains how process ( 5 ) is modelled .    in order for these processes to have an effect on the luminosity function , an option is considered in which each merger induces a burst of star formation , scaled according to the appropriate halo and gas masses and the dynamical time scale .",
    "apart from this star formation rate option , we do not explore parameter space for non - gravitational processes in this paper ; we merely adopt simple observationally normalised scaling laws .",
    "resulting luminosity functions are presented in ",
    "[ s - galstats ] .",
    "applications of n - body derived halo merger trees with more complex assumptions for processes ( 2)-(6 ) are of course possible , and indeed to be welcomed .",
    "the galaxy formation `` recipe '' explored here is only one simple example .",
    "cosmological conventions adopted for this paper are a hubble constant of @xmath13kms@xmath14mpc@xmath14 , comoving units ( at @xmath15 ) and an @xmath16 universe is assumed , except where otherwise specified .",
    "the non - linear gravitational evolution of matter density is modelled by n - body cosmological simulations run by @xcite  ( 1992 ) .",
    "these simulations use a 128@xmath17 initial particle mesh , of side length 10  mpc .",
    "[ the simulations analysed here are for power law initial perturbation spectra ( @xmath0 and @xmath1 ) , so this is simply a default choice for the scaling of units .",
    "this default scaling is used hereafter except where otherwise specified . ]",
    "particles are placed on this mesh , making a cube of @xmath18 particles .",
    "an initial perturbation spectrum is imposed on this cube by fourier transforming the initial complex amplitudes from the perturbation spectrum and using the zeldovich growing mode method ( @xcite  1992 ) on this fourier transform and the @xmath19 particle mesh .",
    "the amplitude of the perturbation spectrum is chosen such that linear perturbation growth implies that @xmath20 at @xmath21 where @xmath22 is the r.m.s .",
    "value of the excess mass ( over uniform density ) in spheres of radius @xmath23 ( @xcite  1992 ) .",
    "this choice ensures that the haloes which collapse are about the same size for different values of @xmath24 so that the dependence on @xmath12 of properties of halo dynamics  or merging histories  can easily be studied .",
    "the absolute normalisation of the spatial correlation function of the haloes can not be directly interpreted in terms of observational quantities . the relative amount of power on different scales ( or slope of the spatial correlation function ) , and the halo detection threshold , are the parameters which may affect the rates and ways in which haloes merge with one another .",
    "the initial cube of perturbed particles is trimmed to a sphere , i.e. , particles more than @xmath25kpc from the centre of the cube are removed , resulting in a sphere of @xmath26 particles .",
    "this is then evolved forward gravitationally via a tree - code ( e.g. , see @xcite  1986 ) , initially with roughly logarithmic time steps up to @xmath27gyr , after which equal time steps of @xmath28gyr are used .",
    "every hundredth time step is stored on disk ; these are the time steps available for halo analysis ( hereafter `` time stages '' ) .",
    "a vacuum boundary condition is used and the softening parameter is 5  kpc ( proper units ) .",
    "the simulation data are searched for density peaks at each time step by an algorithm which uses the `` oct - tree '' method to find all overdense regions without overwhelming computer memory , followed by an iterative means of joining together contiguous overdense regions .",
    "alternative group - finding methods which could be used include the `` friends - of - friends '' ( fof ) algorithm ( e.g. , @xcite  1987 ) , the algorithm used by @xcite  ( 1992 ) or the denmax algorithm ( @xcite  1994 ) .",
    "the fof group - finder has the advantage of low memory requirements and an obvious relation between the mean particle separation and the group - finding resolution , but has the disadvantages that if the link parameter @xmath29 is too low , then low density haloes  or the low density envelopes of haloes  are missed , while if @xmath29 is higher , small but distinct haloes may be erroneously joined together as single objects .",
    "@xcite s ( 1992 ) method , based on the accelerations of individual particles , and the denmax algorithm , which includes a de - binding procedure to separate haloes which are only temporarily close to one another , are both more physically motivated than fof .",
    "however , for a first investigation of the use of n - body generated merging history trees in galaxy formation models , the use of the simple method outlined below seems prudent .",
    "since two different density detection thresholds are used , the implications of having either a low or a high fixed density threshold ( which are similar to the cases of high or low @xmath29 respectively in fof ) can be seen . for further development",
    ", it would certainly be useful to consider use of a more complex algorithm such as denmax .",
    "details of the method are as follows .",
    "conceptually , a cube concentric to the sphere of particles , having as side length the diameter of the sphere , is divided into eight equally sized subcubes .",
    "any of these subcubes containing more than one particle is itself subdivided into eight subcubes . by not subdividing cubes with only one or zero particles ,",
    "computer memory is not wasted on analysing `` empty '' space .",
    "the subdividing process is iterated to a depth of @xmath30 levels below the original cube , unless at some level all the cubes have one or zero particles in them , in which case subdividing stops ( this would happen at @xmath31 for this @xmath32-particle model for a uniform particle distribution ) .",
    "the side length of the smallest cube is @xmath33kpc and @xmath34kpc for @xmath35 and @xmath36 respectively at @xmath37    the `` primary '' list of density peaks is then simply the list of each cube at the deepest level ( i.e. , of size @xmath38 times the simulation sphere diameter ) whose density is at or above @xmath39 times the mean density .",
    "the list of particles in each of these peaks is recorded .",
    "the results presented here are for @xmath40 and @xmath41 for a flat rotation curve of the galaxy of @xmath42 the cumulative mass to a radius @xmath23 is @xmath43 and the density is @xmath44 for @xmath9 as above and @xmath23 in kpc .",
    "so , detection densities of @xmath40 and @xmath45 correspond to the total ( baryonic plus nonbaryonic ) matter density at galactocentric distances of about 1500  kpc and 110  kpc respectively .",
    "the latter is a reasonable value for the halo radius , but the former is several times greater than the largest radii claimed for the halo of the galaxy .",
    "the key to a simple way to join together contiguous `` primary '' peaks is to order the primary density peak list by mass , from largest to smallest , so that each `` secondary '' peak can be created by starting from its nucleus ( densest region ) and successively joining on regions of lower and lower density which are adjacent to the region which has already been aggregated .",
    "the parameters used to decide on adjacency are the radius @xmath23 ( from centre to outermost particle ) of each secondary peak and an `` incremental radius '' , @xmath46 , defined as @xmath47 times half of the largest diagonal of the small cube used in finding the primary density peaks .",
    "a primary peak is considered adjacent to a secondary peak if its centre is within @xmath48 of the secondary peak .",
    "the radius @xmath23 is re - evaluated each time a primary peak is joined to a secondary peak .",
    "the nucleus of the first secondary peak is the first ( i.e. , most massive ) primary peak ; each following secondary peak starts with the most massive primary peak not previously included in a secondary peak .",
    "the final secondary peak list , corresponding to all separated regions inside isodensity contours of @xmath39 times the mean density , is hereafter simply termed a peak list , since the list of primary peaks is not of astrophysical interest .",
    "the members of this list are considered to be dark matter haloes .",
    "a peak ( halo ) merging history tree is obtained as follows .",
    "peak lists for a series of time stages of the model are obtained by the algorithm just described , each obtained with the same values of @xmath30 and @xmath49 for each pair of successive output times , @xmath50 the peaks at the two times are compared .",
    "two arrays , @xmath51 each with as many elements as the number of particles in the simulation , are created . for each element @xmath52 of array",
    "@xmath53 the integer @xmath54 identifying the peak that particle @xmath52 is a member of is assigned to @xmath55 , where this is a peak according to the peak list for @xmath56 .",
    "the array @xmath57 is evaluated in the same way using the peak list for @xmath58 if the particle is not a member of any peak , a null value is assigned .",
    "a simultaneous sort is performed on arrays @xmath59 and @xmath57 , permuting both in the same way in order that @xmath57 is a non - decreasing arithmetical sequence .",
    "the result is that with the new ordering of @xmath59 and @xmath60 ( 1 ) a peak @xmath54 at @xmath61 is represented by a contiguous list @xmath62 to @xmath63 ( each containing the peak number @xmath54 ) and ( 2 ) @xmath64 to @xmath65 ( for the same @xmath66 @xmath67 ) represent the same particles and contain values @xmath68 indicating the peaks ( at @xmath56 ) of which the particles were members .",
    "in other words , the peak membership at @xmath56 of particles in a single peak at @xmath61 is listed in @xmath64 to @xmath69    for any peak at @xmath61 , if more than 50% of the particles in any of the peaks at @xmath56 are present in the peak at @xmath61 , then the peak at @xmath61 is considered a `` descendant '' of the peak at @xmath56 and the peak at @xmath56 is a `` progenitor '' of the peak at @xmath58 these links are represented by appropriate arrays . due to the nature of this algorithm , no peak can have more than one descendant , though it can certainly have more than one progenitor , which is allowed for by using what are , in effect , pointers .    by applying this comparison across each pair of successive times @xmath70 , a representation of the peak merging history",
    "is obtained .",
    "the method described above has been applied to both an @xmath1 and an @xmath0 power law initial perturbation spectrum n - body model ( labelled `` n0b '' , `` n-2b '' by @xcite  1992 ) .",
    "table  [ t - redsh ] shows redshifts and cosmological times for the output timesteps for these two models .",
    "the negative redshifts correspond to future times according to the default time scaling .",
    "if the time unit chosen were different to the default , then these latter time stages could be moved into the past or the present .",
    "@xmath71    haloes are detected in both of these models at thresholds of both @xmath40 and @xmath45 times the mean universe density ( for an @xmath72 universe . ) the former density threshold for detection should result in haloes which have only just turned around from following the smooth hubble flow , while the latter should result in well - virialised haloes .",
    "these thresholds should span most cases of interest .",
    "statistics of the haloes detected and comparison of these to results from other methods are presented in  [ s - peaks ] and  [ s - cfother ] ; examples of halo merging histories are displayed in ",
    "[ s - mhtrees ] ; the spatial two - point autocorrelation functions of the haloes are discussed in  [ s - nbcorr ] ; and a suggestion for further development by interpolation of merger times between time steps is outlined in  [ s - interp ] .",
    "the numbers of haloes are shown in table  [ t - npks ] . in the @xmath0 model",
    ", matter has not yet collapsed into haloes at @xmath73gyr , so the @xmath74gyr time step was used instead .",
    "@xmath75    the reality of these haloes is verified visually by rectilinear projections of a sample of the points for each halo , by radial particle count profiles and by an interactive program which plots a sampling of all the points on a computer screen .",
    "the program offers optional colouring of a range of haloes in a colour different to both the particle colour and the black background and allows real time rotation of the image in order to give an intuitive feel for the three - dimensional shape of the data .",
    "examples of haloes are given in fig .",
    "[ f - profile ] , which shows the radial particle count profiles for four of the biggest haloes ( by number ) detected using @xmath76 in the final time stage of the @xmath0 model .",
    "the profiles are simply numbers of particles per spherical shell , so the rapid decrease to zero shows that the density falls off faster than @xmath77 note that one profile has two prominent maxima , neither at @xmath78 .",
    "this is because , as a closer visual investigation of the haloes shows , a small proportion of the `` haloes '' are in fact fairly close binary haloes rather than single haloes .",
    "these binaries are usually quite uneven in size , so consideration of the halo as a single halo is still a good approximation .",
    "as noted above , use of a group - finder such as denmax ( @xcite  1994 ) would be an elegant way to avoid the adoption of `` binary '' haloes as single haloes .",
    "alternatively , a positional proximity based group - finder could separate bound overlapping bound groups of particles by requiring an additional layer of analysis , such as detection of `` haloes within haloes '' , in which either @xmath39 or @xmath29 ( for a friends - of - friends group - finder ) would have to again be specified .    as described in  [ s - tree ] , for each time stage , a halo at time @xmath56 is considered to merge into a halo at the following time stage @xmath61 ( or retain its identity ) if and only if more than @xmath79 of the particles of the halo at time @xmath56 are present in the halo at time @xmath58 table  [ t - percm ] shows the means and standard deviations of the fraction of a halo at time @xmath56 present in a halo at time @xmath58 by definition , these fractions are constrained to be greater than @xmath80    @xmath81    figs  [ f - mfn-2br5]-[f - mfn0br1000 ] show the mass functions of these haloes and comparable mass functions from various semi - analytical methods .",
    "our n - body derived mass functions are interpreted in terms of merging rates in the following paragraphs and compared with other mass function calculations in ",
    "[ s - cfother ] .",
    "the mass function figures suggest that with the detection threshold of @xmath82 for either spectral index the overall halo merging rate from @xmath83gyr ( i.e. , for @xmath84 ) , to the present is little more than about @xmath85 for galaxies below about @xmath86 while this merging goes on , the number of large haloes in the largest bin in the @xmath87 model increases somewhat until the last time step . depending on the average number of small haloes which merge into a single large one , the increase in the number of large haloes would appear at first sight to be explained by the decrease in the number of smaller ones , consistent with a merging ratio of about @xmath88 though the high mass end of the @xmath89 mass function is noisy , similar interpretation could be made .",
    "these plots show a significant dependence on detection threshold and a weak dependence on @xmath90 for the haloes detected at @xmath91 the merging is much weaker than for @xmath92 in a given simulation , objects detected at the higher threshold consist of the dense cores of the objects detected at the lower threshold .",
    "hence , a simple explanation for the weaker merging is that if the low density envelopes merge , the cores do nt necessarily do so , but if the cores merge , the large low density envelopes are almost certainly going to merge .",
    "however , some simple statistics show that the merging history is not as simple as an @xmath93:1 ratio applying equally to all haloes .",
    "table  [ t - nnodesc ] shows the fraction of the haloes at each time stage that have no descendants , i.e. , the fraction of the haloes for which no more than @xmath79 of their particles appear in any single halo at the following time stage .",
    "the fact that these are nonzero ( from about @xmath94 for @xmath95 to @xmath96 for @xmath97 ) shows that many haloes are destroyed in the sense that more than @xmath79 of their particles may have been pulled into an `` atmosphere '' of a large halo at a density lower than the threshold density or possibly thrown out of the halo or pulled into another halo .",
    "this means that the halo number density does not only decrease by merging , it also decreases by this halo destruction .",
    "for example , if the overall number ratio between two time stages is 4:1 , but one in four haloes terminates , then the underlying ratio of haloes actually merging is only 3:1 . of course ,",
    "this distinction is dependent on the definition of halo detection identity as described above .",
    "@xmath98    more direct statistics are those of the histories of the haloes detected at the final time stage .",
    "the mean ( and standard deviation ) of the overall number of haloes which collapse to above the threshold density ( either at the first time stage or at a later time stage ) and end up in a final halo is shown in table  [ t - nances ] .",
    "@xmath99    while these mean values are in the range @xmath100 estimated above , the standard deviations show that many final haloes come from as many as 20 or more original haloes . in fact , the maximum number of haloes that any final halo originates from is @xmath101 for the @xmath1 model and @xmath102 for the @xmath0 model ( for @xmath40 ) . for @xmath91 the overall rate is lower , and the maximum numbers of haloes per any final halo are @xmath103 and @xmath104 for @xmath1 and @xmath0 respectively .",
    "@xmath105    as already suggested by the number of haloes which terminate , throwing matter back out into the background , the amount of matter which `` rains '' or accretes onto haloes directly rather than first collapsing into smaller density haloes is non - negligible .",
    "typically 30% of a final halo s mass comes from matter directly accreted from the background , but this fraction varies widely between individual haloes",
    ". moreover , these fractions are little dependent on @xmath12 and @xmath106 as can be seen in the statistics listed in table  [ t - rainfrac ] .",
    "what advantages and disadvantages does this method have relative to others , e.g. , the bbks peaks formalism method used in @xcite  ( 1993 ) or the peak - patch formalism of @xcite  ( 1996 ) ?    the advantages are that the simplifications made in the semi - analytical methods are not made in the n - body simulation .",
    "for example :    ( )    most of the semi - analytical methods assume spherically symmetric collapse ( though @xcite  1996 also consider the collapse of homogeneous ellipsoids ) .",
    "@xcite  ( 1992 ) show that the haloes in the simulations analysed in this paper are in fact triaxial .",
    "only the most recent ( e.g. , @xcite  1996 ) methods include spatial two - point auto - correlation function information .",
    "again , this is automatically included in the n - body derived merging history trees ( see  [ s - nbcorr ] for halo correlation functions ) . the same applies for higher order correlation information .",
    "characteristic dynamics of halo mergers such as tidal tails and particles thrown out into low - density `` atmospheres '' (  [ s - peaks ] ) are modelled in the n - body simulation but not taken into account in semi - analytical models .",
    "disadvantages include scientific problems such as resolution limits and practical problems such as managing large data files which occupy large amounts of disk space .    a first order illustration of the similarities and differences between this method and others is obtained by examining the mass function plots ( figs .",
    "[ f - mfn-2br5]-[f - mfn0br1000 ] ) .",
    "the press - schechter ( ps ) formula derivation of @xcite  ( 1993 ) , using their eqs.(2.11 ) and ( 2.1 ) in eq.(2.1 ) of @xcite  ( 1993 ) should read @xmath107 . ] ] provides a simple analytical description of both the shape and the time evolution of the mass functions .",
    "ps functions for two early and two later time steps are shown for comparison in each mass function plot , and the values of @xmath108 are increased ( from the default @xmath109 ) in some plots in order to show ways in which the ps formula could be used to interpret the mass functions .    for the @xmath0 mass functions , our results bracket the semi - analytical model results for cdm initial fluctuation spectra , which have roughly this slope on galaxy scales .",
    "shown on these plots are @xcite s  ( 1991 ) mass function ( fig .  1 ; collapsed peaks ) and @xcite s ( 1996 , fig .",
    "12 ) mass functions .",
    "( the latter are calculated for clusters , so masses and @xmath110 are rescaled according to a length scaling @xmath111 . )    the time evolution of the ps functions , both in normalisation and shape , is similar to that of our haloes .",
    "this is best seen in fig .",
    "[ f - mfn0br5 ] , where the decrease in normalisation in proportion to @xmath112 [ expected from eq.(2.1 ) of @xcite  ( 1993 ) ] is clearly seen .",
    "the absolute normalisation of the ps functions is only about @xmath113 times that of the @xmath76 mass functions .",
    "since the ps formula is not intended to model @xmath76 or @xmath114 haloes , better agreement should not be expected .",
    "indeed , fig .",
    "[ f - mfn-2br1000 ] shows that the haloes detected at @xmath114 have a considerably lower normalisation than that of the ps formula , but similar to that of @xcite s prediction ( rescaled to galaxy scales ) for ellipsoidal internal halo dynamics . since the n - body derived haloes analysed here",
    "have a variety of triaxialities , it is not surprising that this provides the best agreement .",
    "however , as remarked upon by @xcite , their method may not be ideal for small haloes , since the low mass end `` must find the nooks and the crannies '' left over from the analysis devoted to high mass haloes , so an n - body method with sufficient resolution may be better for obtaining the low mass slope of mass functions .",
    "@xcite s  ( 1991 ) peaks formalism based mass functions are somewhat steeper than the present - day ps mass functions and do not provide the optimal fit to our mass functions .",
    "although the early epoch high - mass ends of the n - body mass functions for @xmath76 ( figs  [ f - mfn-2br5 ] , [ f - mfn0br5 ] ) are similar to the ps cutoffs ( for @xmath115 ) , the corresponding cuvres for the high density haloes ( @xmath114 ) can only be matched to ps curves by increasing @xmath116 ( figs  [ f - mfn-2br1000 ] , [ f - mfn0br1000 ] ) . since @xmath116 signifies a critical overdensity ( according to a linear growth rate ) , it is not surprising that the high density halo high - mass cutoffs can be fit .",
    "( however , this would not enable the ps formulae to fit the later time steps , since the normalisation increases in proportion to @xmath117 which would worsen the disagreement for the high density haloes relative to the ps prediction . )    of course , what is potentially most interesting for explaining the flatness in observed ( high surface brightness galaxy ) luminosity functions ( e.g. , @xcite  1988 ) is the agreement in the n - body derived ( @xmath76 ) and ps slopes for @xmath118 ( the ps function has the form @xmath119 \\log_{10}m + $ ] const , for haloes of mass @xmath120 ) .",
    "an initial fluctuation spectrum slope of @xmath1 implies a less steep low mass ( faint ) end of the mass ( luminosity ) functions than for @xmath121    more subtle merging properties , which can be compared with @xcite s  ( 1993 ) ps derived monte carlo simulations , are the mass ratios of haloes and their most massive progenitors .",
    "the statistics of these ratios can be used to constrain the relation between galaxies and haloes via implications for the survival of disk galaxies .",
    "[ f - rntn1_r5 ] shows that the mass ratios of merging haloes found in @xcite s  ( 1993 ) ps derived monte carlo simulations are similar to those found in our analysis for haloes detected at @xmath122 as for the mass functions .",
    "since the conditions of the simulations are somewhat different ( ps vs n - body , cdm vs @xmath0 ) , the agreement suggests that these ratios are quite robust with respect to different modelling techniques .",
    "comparison with fig .",
    "[ f - rntn1_r1000 ] shows that at any given time , the fraction of a high density halo which has already collapsed or accreted is statistically lower than for low density haloes .      merging history tree plots ( figs  [ f - mhn-2b.r5.1_5][f - mhn-2b.r5.400_410 ] ) are obtained by choosing a range of haloes at the final time stage and tracing back all the progenitors of these haloes . the line segments joining",
    "the circles are the key feature of the plots .",
    "these indicate that the halo at the earlier time is considered to merge into ( or be `` identical '' to ) the halo at the later time according to the 50% criterion explained in ",
    "[ s - tree ] .",
    "the aim of the plots is to show connectivity over time .",
    "so , the horizontal axis is designed to separate the haloes according to their future merging activity .",
    "it does nt directly indicate space positions , although there should be some correlation between how close two haloes are in the plot and how close they are in space ( since haloes need to be close in order to merge together later on ) .",
    "much information on the merging process is represented in these tree plots .",
    "however , they do not show the entire complexity of the merging process ( or `` graph '' in mathematical terminology ) .",
    "since the halo merger history trees presented here start with a range of final haloes and trace backwards , haloes which have no descendant at the final time stage are not shown .",
    "as summarised in table  [ t - nnodesc ] , a significant fraction of the haloes at a given time stage have no descendants at the following time stage .",
    "a simple explanation is that a large fraction of a halo can evaporate in the merging process and contribute less than 50% of the mass of the final halo , in which case the merging / identity criterion adopted fails to find a descendant . typically , about @xmath123 of a halo evaporates ( e.g. , in tails ) or forms low - density `` atmospheres '' in n - body simulations of @xmath124 interacting galaxies ( quinn , 1992 ) .",
    "these tails or atmospheres are likely to fall below the density detection threshold .",
    "figs  [ f - mhn-2b.r5.1_5 ] and [ f - mhn-2b.r1000.1_5 ] show that merging ratios of up to around 10:1 occur for many of the most massive haloes at low redshifts , while as indicated by the maximum number of original haloes for any final halo , the merging ratios between early time stages can be much higher , as high as a few hundred to one in several cases for @xmath92    the difference in detection thresholds appears clearly in the difference between the early time stages of figs  [ f - mhn-2b.r5.1_5 ] and [ f - mhn-2b.r1000.1_5 ] . at the nominal redshift @xmath125",
    ", many low mass haloes have reached the turnaround density and are thus detected above @xmath122 after which they merge rapidly .",
    "in contrast , haloes detected above @xmath114 are mostly detected at @xmath126 ; the few which form earlier do not merge in ratios as high as for the @xmath76 haloes .",
    "depending on the assumptions one wishes to make regarding the relationship between galaxies and haloes , either of these limiting cases could be interesting .    for merging history trees of the haloes having lower masses at the final time stage (",
    "figs  [ f - mhn-2b.r5.50_60 ] and [ f - mhn-2b.r5.400_410 ] ) , very little merging occurs apart from the earliest few time stages .",
    "indeed , fig .",
    "[ f - mhn-2b.r5.400_410 ] shows that many of the smallest haloes either have only recently collapsed or are unmerged objects which have formed well after the first time stage .",
    "this can be generalised by stating that the larger a galaxy halo is , the more original haloes it is likely to have been created from , and at any time in general , the more massive a galaxy halo is , the more haloes are likely to be merging into it .",
    "( this effect can also be seen in figs  [ f - rntn1_r5 ] and [ f - rntn1_r1000 ] . )",
    "that the lowest mass peaks may form fairly recently or may form early yet undergo no merging at all is to be expected in a `` hierarchical galaxy formation '' scenario .",
    "bottom - up gravitational collapse does not only imply that small haloes form first and successively merge to form more and more massive haloes , but also that some low mass haloes ( e.g. , from low amplitude short length - scale perturbations , which must exist if the initial perturbation amplitudes are part of a zero - mean gaussian distribution ) continue to form at late epochs .",
    "the recently forming small haloes in our halo merger trees could be used to model the ( observed ) existence of low mass , young , low redshift galaxies , such as the dwarf spheroidals .",
    "an interesting case is the sbs  0335 - 052(w ) pair of dwarf galaxies at a redshift of @xmath127 , which have a ( stellar ) age of not more than @xmath128  yr and have a metallicity ( o / h ) around 1/40 of the solar value ( @xcite  1997 ) .",
    "these two dwarfs are extremely hard to understand as anything other than young , low redshift , low mass galaxies . for such galaxies to provide",
    "a constraint on galaxy formation models , precise estimations of number densities and age distributions would be useful  though obviously difficult to obtain without strong observational selection effects .",
    "another important statistic of the haloes is their spatial two - point auto - correlation function , @xmath129 the natural inclusion of @xmath130 in n - body simulations is something not usually present in semi - analytical galaxy formation modelling . indeed , @xcite s ( 1996 ) application of @xcite s ( 1995 ) approach to the `` cloud - in - cloud '' problem of the press - schechter formalism ( @xcite  1974 ) shows that the mass function of the latter suffers significantly from the lack of inclusion of @xmath131 @xcite  ( 1997 ) confirm this in semi - analytical merging history tree simulations using @xcite s ( 1996 ) modification of the block model ( @xcite  1988 ) .",
    "[ f - corr.n0br5 ] shows the correlation functions for the haloes detected for @xmath132 these functions have slopes @xmath133 where @xmath134 @xmath23 and @xmath135 are expressed in comoving coordinates , and @xmath136 parametrises the growth rate of @xmath137 , deduced either from observation or theory ( @xcite  1977 ) .",
    "the slopes of @xmath130 for the other combinations of @xmath12 and @xmath39 are similar , so are consistent with that observed for galaxies , i.e. , @xmath138 ( e.g. , @xcite  1980 ; @xcite  1983 ; @xcite  1992 ) .",
    "some observations indicate that @xmath139 evolves with time ( @xcite  1995 ) , but others do not detect this ( @xcite  1996 ) .",
    "n - body simulation derived correlation function slopes vary around the same values , but are sensitive to whether the correlation is that of particles ( identified as galaxies ) , of haloes or of mass - density ( @xcite  1985 ; @xcite  1988 ; @xcite  1991 ; @xcite  1991 ; @xcite  1992 ) .    the haloes of our n - body derived merging history trees therefore have realistic correlation slopes and do not suffer from the lack of a correlation function of the traditional semi - analytical methods .",
    "another interesting property of the correlation function is the growth rate of @xmath140 parametrised by @xmath141 this is shown in fig .",
    "[ f - xi0evol ] . since the simulations used here are not normalised conventionally , the values of @xmath142 ) universe model . ]",
    "are less useful than the change of @xmath143 with redshift .    to the extent that eq .",
    "[ e - defneps ] is a good approximation , direct observational estimates of @xmath136 at varying ( median redshift ) include @xmath144 ( @xcite  1993 , @xmath145 ) , @xmath146 ( @xcite  1994 , @xmath147 ) , @xmath148 ( @xcite  1997 , @xmath149 ) and @xmath150 [ cf .",
    " 4.1(3 ) , @xcite  ( 1996 ) , adopting @xmath151  mpc and @xmath152(stromlo - apm)@xmath153 ( @xcite  1992 , 1995 ) , ( cfrs)@xmath154 . by hypothesising major changes in visible galaxy populations from low to high redshifts , these values of @xmath136 could be lowered .",
    "simple theoretical values of @xmath136 include those expected for clustering fixed in comoving coordinates ( @xmath155 , so that the index in eq .",
    "[ e - defneps ] is zero ) ; clustering fixed in proper coordinates on small scales [ `` stable clustering '' , @xmath156 ; since the numbers of `` clusters '' changes by @xmath157 and the number of galaxy pairs by @xmath158 , the factor in eq .",
    "[ e - defneps ] for @xmath23 in proper coordinates is @xmath159 ; and linear growth of initial fluctuations for an @xmath4 universe ( @xmath160 ) .",
    "@xmath161    more detailed analyses include those of @xcite  ( 1996 ) and @xcite  ( 1997 ) , who discuss departures from the power law of eq .",
    "[ e - defneps ] , bias factors and differences between the linear , quasi - linear and non - linear overdensity regimes .",
    "in particular , the transition between the linear and non - linear regimes can give rise to @xmath162 [ for @xmath163 in eq .",
    "( 29 ) of @xcite  ( 1996 ) and @xmath4 ] .",
    "by contrast to the above estimates , the values of @xmath136 for our haloes are those for which _ haloes merge between time steps_. this means that as haloes approach each other and merge , halo pairs are replaced by single haloes , so that the correlation decreases more slowly than if the haloes identities were kept separate . because of this , the values of @xmath136 derived here ( table  [ t - eps ] ) lie between those expected for clustering fixed in comoving and proper coordinates respectively , and are lower than the more precise of the observational estimates .",
    "implications of the effect of merging , in particular on the angular correlation function , have been presented in more detail in @xcite  ( 1993 ) .",
    "another property to note is that for the @xmath0 model , @xmath143 initially _ decreases _ until @xmath165 after which it increases to the present .",
    "this is because during the transition from linear perturbation amplitudes to non - linear collapse , small length - scale perturbations on top of large length - scale perturbations have their density boosted , and so can collapse well before small length - scale perturbations in low density regions . during this period , perturbations in the low - density regions",
    "are not represented by collapsed objects .",
    "hence , the mean number density of collapsed objects used to normalise the correlation function represents the numbers of haloes in only the high - density regions , but includes the volume in both low and high - density regions .",
    "the mean density is therefore biased low , so the correlation function amplitude is biased high . as a larger fraction of perturbations collapse , this initially high bias in @xmath130 decreases until normal correlation growth takes place .",
    "this effect is not seen for @xmath1 because large length - scale perturbations have relatively less power for @xmath1 than for @xmath121 possible consequences of such a `` decreasing correlation period '' ( also reported by @xcite  1993 and @xcite  1994 ) on observations of the angular correlation function are discussed in @xcite  ( 1997 ) . from fig .",
    "[ f - xi0evol ] , the rate of correlation decrease is @xmath166 \\sim 0\\.3\\pm 0\\.15 $ ] to @xmath167      the merging history trees of haloes could in principle be analysed with a higher time resolution than in the figures presented here , merely by using many more output time steps from the n - body simulation",
    ". the only drawback would be practical handling of computer disk space .",
    "a single time step for the @xcite  ( 1992 ) simulations normally occupies 32  megabytes .    here",
    "we note an alternative to using more output times .",
    "interpolation between time steps , making analytical assumptions for the trajectories of the haloes , can give interpolated merger times which are statistically consistent with the more accurate trajectories calculated in the full n - body simulation .",
    "[ f - interp ] shows that the approximation of point particles falling into isothermal potentials gives an approximately decreasing merger rate , which is consistent with the overall merging rate .",
    "a small fraction of objects have estimated merger times greater than the output time step interval , i.e. , greater than the time required for a merger according to the full n - body simulation .",
    "this is a limitation to ( at least this ) analytical interpolation , but the fraction of such cases is small enough that this interpolation technique may be a fair approximation statistically .",
    "however , n - body analyses of few - galaxy systems ( e.g. , @xcite  1992 ; @xcite  1989 ) suggest that merger times may be difficult to predict by any simple analytical method , so caution is needed .",
    "although the results should not differ significantly from those of the authors just cited , use of such interpolations for the calculation of n - body merger history trees could be verified by comparison with the intermediate time steps of the n - body systems .",
    "interpolation is not adopted for this paper .",
    "the example of a galaxy formation recipe adopted here combines ( a ) gravity : halo merging history trees are derived from density peaks detected above a given overdensity threshold in @xmath47 million particle pure gravity n - body simulations ; and ( b ) other physical processes : one galaxy is assumed to form in each halo ; we insert an observationally inspired star formation rate due to merger - induced starbursts ( and/or a quiescent star formation rate ) ; and we combine this with the initial mass function and stellar evolution modelled in bruzual s ( 1983 ) evolutionary population synthesis code .      star formation physics is represented by an initial mass function ( imf ) and a star formation rate ( sfr ) .",
    "the separability of these two functions appears to be a reasonable assumption according to both observation and theory , e.g. , the recent iso ( infrared satellite observatory ) observations of both infrared - ultra - luminous and `` normal '' star - forming galaxies are consistent with existence of a universal imf ( @xcite  1996 ; @xcite  1996 ; @xcite  1996 ) . the imf is discussed in  [ s - geps ] , while this section describes the modelling of the sfr , based on starbursts .    for the purpose of this first - order examination of the effect of merger - induced starbursts on galaxy luminosity evolution",
    ", we only use very simple models of the starbursts .",
    "observational and theoretical motivations are as follows .",
    "an early observational model of a starburst ( not necessarily caused by a merger ) , is that of rieke  ( 1980 ) .",
    "rieke  ( 1980 ) model the starburst in the nucleus of m82 via evolutionary population synthesis .",
    "they find that instantaneous ( dirac delta function ) and constant star formation rate models fail to produce the observed spectrum , but exponential decay sfr models with an imf with a low - mass cutoff well above a solar mass are necessary .",
    "their best models ( say , d and f ) have the e - folding time in the sfr @xmath168yr and @xmath169yr and run for @xmath170yr and @xmath171yr respectively . both have imf s with @xmath172 and the mass range @xmath173 the mass turned into stars is @xmath174 this being constrained to be less than the total mass in the nucleus , estimated as @xmath175 by rieke  this constraint is the major reason for the need of a high low - mass cutoff .",
    "if a normal low - mass cutoff is used , then the mass actually present in the nucleus is insufficient to generate the observed luminosity .",
    "rieke ( 1991 ) describes more recent observational constraints on the models for m82 , finding that the above conclusion still holds using more modern stellar evolutionary tracks in the models .",
    "scoville & soifer ( 1991 ) argue from iras far - infrared data that `` virtually all of the strong _ global _ starbursts occur in ... starburst - infrared galaxies , '' where the latter are defined as `` those with @xmath176 significantly higher than in normal galaxies , '' and that starburst - infrared galaxies correlate highly with `` the occurrence of a recent [ galaxy - galaxy ] interaction . ''",
    "they argue that such global starbursts require the progenitor galaxies to be of comparable mass in order to generate such activity .",
    "while this result does nt necessarily imply the converse , i.e. , that all mergers of similarly sized galaxies induce major global starbursts , the converse is a fair hypothesis . with the assumption of this converse ,",
    "scoville & soifer find that the high luminosity end of the infrared ( galaxy ) luminosity function from the iras survey is consistent with @xmath177 of all spiral galaxies undergoing global starbursts at the present with lifetimes equal to the dynamical times of large galaxies , @xmath178yr .",
    "for the most ir - luminous galaxies they find sfr s of @xmath179yr@xmath180 they do nt find a high low - mass cutoff necessary for their models to fit the observations .",
    "norman ( 1991 ) , citing the models of merging gas - rich disk galaxies of hernquist and barnes , ( @xcite  1990 , equal mass galaxies ; hernquist 1989 , differing mass galaxies ) , describes a qualitative three - phase model to take into account gas falling into the galaxy centre .",
    "the three phases essentially correspond to proportions of the gas having fallen to the centre .",
    "published star formation models following these three phases separately are not cited in the article , but would obviously be of interest .",
    "norman ( 1991 ) also argues that constant sfr models of starbursts satisfy an observed sparsity of post - starburst galaxies relative to starburst galaxies , but that instantaneous sfr models predict too many post - starbursts .",
    "hence , for this example application of an n - body derived halo merger history tree , a starburst with a constant sfr is chosen .    for pairwise mergers ,",
    "the following canonical values are chosen .",
    "we normalise the rate of the starburst for a `` typical '' large galaxy merger product to be an sfr of @xmath181yr@xmath14 as in the models of scoville & soifer ( 1991 ) .",
    "the low - mass cutoff in the imf used here ( @xmath182 , see eqn  [ e - imf ] ) is consistent with scoville & soifer s value of @xmath183    we consider the merger product to be the remnant of two large galaxies each of gas mass @xmath184 total mass @xmath185 and halo radius @xmath186kpc .",
    "this gives a dynamical time @xmath187yr , where the mean density of either galaxy to its halo radius is @xmath188kpc@xmath189 the modelling by @xcite  ( 1990 ) , hernquist ( 1989 ) or earlier non - gaseous n - body models such as those of quinn & goodman ( 1986 ) find that the merger takes place over only a few dynamical times .",
    "so the choice of progenitor galaxies here gives a @xmath190 matching scoville & soifer s burst duration of @xmath191yr , which is chosen as the canonical burst duration .    in this canonical case , @xmath79 of the total gas mass",
    "is used up in the burst . to sum up ,",
    "we have    @xmath192    the canonical values are then scaled for haloes of arbitrary mass . to first order",
    "it seems reasonable that the kinetic energy available for generating star formation should be proportional to the mass of the smaller halo and that the sfr should also be proportional to the total amount of gas available .",
    "so , the sfr is scaled by the mass of the smaller halo times the ratio of combined gas mass to @xmath193 .",
    "since we consider the duration of the starburst to be the order of a dynamical time , @xmath194 is scaled by @xmath195 where @xmath196 is the density of the larger halo .    given a coarse time resolution in the merging histories , each merger is identified by the code as a multiple merger  e.g .",
    ", seven haloes merge to one  instead of as a series of several individual pairwise mergers .",
    "if we consider the approximation that each of the pairwise mergers involves the largest progenitor halo , then a compromise can be carried out as follows .",
    "\\(a ) have a single burst with the above normalisation .",
    "scale the sfr by the sum of the masses of each of the smaller haloes ( i.e. , all but the largest ) and by the ratio of the combined gas mass from all progenitor haloes ( i.e. , including the largest ) to @xmath197 giving @xmath198 where @xmath199 is the star formation rate ( in @xmath200yr@xmath14 ) , the progenitor haloes are labelled by @xmath201 , and @xmath202 is the label of the progenitor halo of greatest mass .",
    "( for the group - finding algorithm used in this article , @xmath203 )    \\(b ) scale the starburst duration as above , by @xmath195 where @xmath196 is the density of the largest halo , giving @xmath204 two modifications may have to be applied in some situations .",
    "firstly , where the starburst at this rate uses up more gas than is actually available , it is truncated at the point of time when zero gas mass is left .",
    "secondly , if the duration of the starburst is longer than the time interval to the next time step , it is truncated at that next time step .",
    "while this modelling of multiple merger - induced starbursts with large time steps may make the luminosity evolution more temporally discrete than it should be , it does conserve physical quantities in line with the observational and theoretical constraints discussed above , and should be sufficient for this demonstration of the use of n - body based merger history trees .",
    "we use stellar evolutionary population synthesis to combine star formation and stellar evolutionary physics . a version of bruzual s stellar evolutionary population synthesis code ( bruzual 1983 ) which is essentially that of 1983 , but with some updating and conversion to unix , is the primary population synthesis code used , but the code of @xcite  ( 1987 ) and @xcite  ( 1988 ) ( 1993 version ) gives similar results . in the interactions of the programs presented above with this code , the sfr history and masses of galaxies and gas",
    "are determined outside of the bruzual routines or by amended versions of the bruzual routines .",
    "the return of gas from supernovae to a galaxy was turned off for test purposes but otherwise left on .",
    "the loss of this supernova gas from a galaxy was not invoked , neither was the option allowing infall of gas to a galaxy .",
    "the initial mass function ( imf ) used was the default imf chosen by the code , after scalo ( 1986 ) ( e.g. , fig .",
    "16 in scalo , 1986 ) . where @xmath205 is the number of stars born per unit ( linear ) mass in a given mass range , the imf slopes used are @xmath206    the bruzual code normally works by using simple analytical expressions for the sfr history , so that no numerical effects ( e.g. , rounding errors ) can be introduced at this stage .",
    "numerical effects can of course be present when the galaxy spectral energy distribution is calculated , since only finitely many points representing different stellar ages are present for each of the finitely many mass tracks .",
    "however , this has the disadvantage that one can not simply stop the code after a certain time step , save the population data , start up the program from scratch , read in the saved population data and continue on as if the program had never stopped .",
    "the population data could be stored and later read back in , but this would round each star s age to the appropriate stellar evolution track age at every time step , making cumulative errors .",
    "bruzual s code was therefore modified slightly in order to allow use of numerical sfr histories . for each time step and each halo , an array of time points from that time step to the following time step and the corresponding array of integrals of the sfr",
    "are stored .",
    "these integrals of the sfr are the total number of stars created since the first star formation in any of the progenitor peaks which end up in the present peak being worked on .",
    "because the integral of the sfr is used , the errors are not cumulative , and in the present version are @xmath207    the program which applies stellar evolutionary population synthesis to the merging histories stores an sfr history for each peak as it is evolved to the next time step , adds these together for merged peaks , and from that point on evolutionary population synthesis applies just as it would for an isolated galaxy , except that the merging history tree information is contained implicitly in the complex shape of the sfr history .    for the present model , population synthesis is applied by optionally having an exponentially decreasing sfr between mergers and optionally having starburst sfr s commencing at each merger .",
    "gas masses and total masses are by default conserved , i.e. , the gas and total masses of a galaxy are the respective sums of the gas and total masses of predecessor galaxies , except that matter accreting directly onto the density peaks is added as gaseous mass . if both exponential and burst star formation are turned on simultaneously ( probably the most realistic model ) the sfr s are simply added together , conserving the number of stars created .",
    "this combination of n - body generated merging history trees with other elements of a simple galaxy formation recipe is sufficient to generate luminosity functions which are comparable to the estimated present - day luminosity function , and so could be extended to an exploration of galaxy formation parameter space , in which the parameters are free rather than motivated by observation as in the present work .",
    "the merging history trees presented above are derived from power law initial spectrum n - body simulations intended for comparison of the relative properties of haloes of different masses , so need to be renormalised in a cosmological context . for simplicity ,",
    "an increase in the length scale by a factor of two is the renormalisation adopted .",
    "masses scale as the cube of the length in order to leave the numerical operations in the n - body simulations and the merger history tree analysis unchanged and time is not rescaled .",
    "this brings the _ number _ density of the haloes close to that of observed galaxies .",
    "a baryon fraction of 10% is adopted .",
    "nucleosynthesis results ( e.g. , @xcite  1991 ) and @xmath9 estimates ( @xcite  1995 ; @xcite  1997 ) make this a reasonable round number for a critical density universe with a null cosmological constant .",
    "[ some other estimates of similar baryon fractions include galaxy estimates of @xmath208 out to a holmberg radius , or down to possibly @xmath209 for the whole galaxy ( @xcite  1987 ) ; @xmath210 for galaxy clusters ( e.g. , @xcite  1987 ) ; and @xmath211 over the whole range of cosmological structures from dwarf spheroidals to rich clusters ( @xcite  1988 ) . ]",
    "all baryonic matter is assumed to be potentially star - forming material .",
    "an example of an sfr history ( for the galaxy resident in the most massive final halo in the @xmath212 exponential - plus - burst model ) is shown in fig .",
    "[ f-n0b.r5n6.eb.sfr ] .",
    "both the exponentially declining `` quiescent '' star formation rates and the merger - induced bursts are clearly visible .",
    "bruzual s sfr parameter has the value @xmath213 [ @xmath214 is the proportion of gas turned into stars in a ( non - merging ) galaxy within @xmath215gyr ] .",
    "mass - to - light ratios , @xmath216 ( using rest frame values of @xmath217 , i.e. , no k - corrections ) for the galaxies in this model at different time steps are shown in fig .",
    "[ f-mln0b.eb ] .",
    "these mass - to - light ratios are somewhat high relative to optical galaxy estimates ( e.g. , @xmath218 derived from the inner part of the optical / hi rotation curves of disk galaxies without bulges , @xcite  1987 ; stellar population values , @xcite  1978 ) but similar to those estimated from x - ray emission in ellipticals ( @xmath219 within a radius @xmath220  kpc , @xcite  1987 ) .",
    "the corresponding luminosity functions for the galaxies in this model are shown in fig .",
    "[ f-lfn-2b.eb ] , while luminosity functions for either exponentially decaying or burst sfr s only ( not both ) are shown in figs  [ f - lfn-2b.e ] and [ f - lfn-2br5.b ] ( for @xmath212 ) .",
    "a local luminosity function parametrised as a schechter function @xmath221 ( @xcite  1976 ) where @xmath222  mpc@xmath223 , @xmath224 and @xmath225 ( @xcite  1988 ) , is shown for comparison .",
    "[ this estimate is similar to the more recent stromlo - apm estimate of @xcite  ( 1992 ) , while the cfa2 estimate of @xcite  ( 1994 ) differs from both in having a value of @xmath226 about @xmath208  mag fainter . ]",
    "the luminosity functions for the @xmath212 exponential - plus - burst and exponential - only sfr s are similar to one another ( figs  [ f-lfn-2b.eb ] , [ f - lfn-2b.e ] ) , as the rate of the exponential sfr alone is enough to use up most of the gas , leaving little possibility for the bursts to make any difference between galaxies of differing merging histories .",
    "the luminosity function slopes are steeper than the observational faint end slopes ( for field galaxies ) , and are similar to the steep slopes expected from the mass functions ( figs  [ f - mfn-2br5 ] - [ f - mfn-2br1000 ] ) .",
    "the other three combinations of @xmath12 and @xmath39 for the exponential - plus - burst and exponential - only models give similarly steep luminosity functions .",
    "this result is similar to that of other semi - analytical models ( e.g. , @xcite  1993 ) .",
    "the `` bump '' at the bright end of some of the later luminosity functions ( particularly in fig .",
    "[ f - lfn-2b.e ] ) combined with the steep slope is suggestive of luminosity functions in clusters , but a cluster environment is one in which merger - induced star bursts could be expected to be the more important rather than the less important star formation mode , so it is not clear whether or not this is a useful characteristic of the models .    the faint end sudden drop ( at @xmath227 in these two figures ) is simply due to the resolution limit of the models .    the @xmath95 burst - only model ( fig .",
    "[ f - lfn0br5.b ] ) is quite striking in having a `` faint end '' slope almost precisely as shallow as the slope of the observational luminosity function .",
    "in addition , the bright ends of the earlier of these luminosity functions have steep drops as in the observational luminosity function , though this occurs for galaxies a few magnitudes too bright .",
    "how significant are the luminosity functions of the @xmath95 burst - only model ? for a flat rotation curve for the galaxy with density falling off as @xmath228 the detection threshold of @xmath40 corresponds to a galaxy halo radius of about @xmath229kpc , larger than any claimed value .",
    "apart from the recent observational suggestion of @xcite  ( 1996 ) that the halo is only 15  kpc in radius , a conventional estimate of @xmath230  kpc would still imply that the detection threshold used here overestimates the mass of the galaxy by an order of magnitude [ since @xmath231 .",
    "also , members of the local group would missed , since one galaxy per halo and maximal merging are assumed .",
    "these problems could conceivably be corrected by a reduction in galaxy masses , which would reduce the luminosities , and by an increase in the normalisation to account for the missing local group galaxies , whose analogues would presumably be detected ( in the model ) in isolation in other regions of space . however , while the former would improve the fit , the latter would worsen it .    the @xmath232 burst - only model does include these smaller galaxies ( `` halo substructure '' ) and results in a luminosity function which is slightly too steep ( fig .",
    "[ f - lfn0br1000.b ] ) . the @xmath0 models ( figs  [ f - lfn-2br5.b ] , [ f - lfn-2br1000.b ] ) also have slopes which are relatively shallow , but none as shallow as that for the @xmath233 model .",
    "the reason why the burst - only models have shallower slopes can be explained fairly simply : smaller mass haloes typically undergo less merging , so become relatively underluminous relative to higher mass haloes .",
    "_ star formation dominated by merger - induced bursts could therefore provide a simple way of reducing the faint - end slopes expected from the press - schechter function . _    as might be expected from the similarity in the mass functions ( figs  [ f - mfn-2br5 ] , [ f - mfn-2br1000 ] , [ f - mfn0br1000 ] ) for three of the burst - only models , the luminosity functions are also similar to one another .",
    "however , a characteristic of the mass function of the @xmath234 model appears ( marginally ) to be shared by the corresponding luminosity function : the slope seems to become shallower with time .",
    "if this were significant , it could be of considerable interest in reconciling faint galaxy counts ( e.g. , @xcite  1988 ; @xcite  1988 ) with the flatness of the locally estimated luminosity function , though it would also need to show evolution in the bright end of the luminosity function as deduced from recent redshift surveys ( @xcite  1995 , @xcite  1996 and @xcite  1996 ) .",
    "the evolution in slope could be attributed to the evolution in the press - schechter mass function shown in fig .",
    "[ f - mfn-2br5 ] , with the addition of a systematic reduction in slope induced by our burst - only sfr formalism .",
    "both the flatness of the @xmath233 burst - only luminosity functions and the decreasing slope of the @xmath234 model suggest that these parameter combinations should be interesting for future explorations of galaxy formation models using n - body derived merger history trees .",
    "the algorithms and results discussed above show that this method of deriving halo merging history trees directly from n - body simulations is feasible and easily combined with evolutionary stellar population synthesis for exploration of a simple galaxy formation model .",
    "the method has been applied to @xcite s ( 1992 ) n - body simulations with @xmath1 and @xmath0 power law initial perturbation power spectra , using @xmath40 and @xmath45 overdensity detection thresholds to detect dark matter haloes .",
    "several subsets of the merging history trees have been plotted , directly showing quantitative patterns of halo merging from fully non - linear calculations .",
    "the merging history trees were combined with simple , observationally normalised proportionality assumptions for star formation rates and stellar evolutionary population synthesis in order to demonstrate a simple galaxy formation `` recipe '' , in which star formation is either exponentially decreasing , induced by mergers , or both .",
    "in addition , interesting properties of halo formation and evolution were noted .",
    "the galaxy formation recipe adopted shows that if most star formation occurs as merger - induced bursts , then some flattening of the faint end of the galaxy luminosity function relative to that expected from the mass functions may be obtained .",
    "indeed , for the analysis using ( a ) a white noise perturbation spectrum slope ( @xmath1 ) and ( b ) a detection threshold typical of that for a perturbation just reaching the turn - around density ( @xmath40 ) , the resulting present - day luminosity function has a faint - end slope similar to @xmath235 i.e. , that estimated for local , field , high surface brightness galaxies .",
    "moreover , for the same value of @xmath39 and a perturbation slope similar to that of cdm , there marginally appears to be a steepening of the faint end slope for increasing redshift .",
    "however , since this is only a simple test application of merging history trees to galaxy formation modelling , and the n - body simulations are designed for the study of relative rather than absolute halo properties , these results should be taken as indicative of worthwhile galaxy formation `` recipes '' to explore further , rather than as a definite explanation for a luminosity function with a flat faint end",
    ".    other interesting by - products from this method of analysing non - linear gravitational collapse are properties of hierarchical halo formation .",
    "\\(1 ) individual merger rates can be very different from average merger rates and the fraction of mass coming from accretion can be quite high .",
    "for example , for @xmath95 , the mean number of haloes which collapse at any time stage and end up in a halo at the final time stage is @xmath236 the standard deviation in this quantity is @xmath237 ( table  [ t - nances ] ) and the maximum is 233 .",
    "for the same halo detection parameters , a mean fraction of 32% of the mass in the final haloes comes directly from accretion of uncollapsed matter ( table  [ t - rainfrac ] ) , but this fraction varies widely between different haloes .",
    "( for the other three parameter choices , the merger ratios are about a factor of two lower , while the accretion percentages are about the same . )",
    "\\(2 ) low mass haloes may either form at very recent cosmological epochs or may undergo no mergers at all throughout a hubble time .",
    "the former may be counter - intuitive , but can be simply understood as being due to the existence of small amplitude , small length - scale perturbations at early epochs , expected for a zero - mean gaussian amplitude distribution .",
    "some ( if not many ) perturbations have small initial amplitudes : these only become non - linear recently .",
    "thus , observations such as that of a young , low redshift , low metallicity dwarf galaxy pair ( @xcite  1997 ) can be explained naturally within a hierarchical halo formation model .",
    "\\(3 ) if there is sufficiently more power on large than small scales , e.g. , @xmath3 then the first fluctuations to collapse ( forming haloes ) are only those inside of large length - scale perturbations , so that the spatial distribution of the haloes is initially much less uniform than that of the linear ( and non - linear ) fluctuations in general .",
    "in other words , the amplitude of the spatial correlation function of the haloes may start from a highly biased value ( relative to the linear perturbation theory expectation ) , and decrease in bias until a transition redshift when `` normal '' correlation growth commences .",
    "observational consequences of such a `` decreasing correlation period '' are discussed in @xcite  ( 1997 ) .",
    "many further developments of the use of n - body derived merger history trees are obvious : different assumptions for processes ( 2)-(5 ) cited in the introduction could be adopted ; a mechanism ( e.g. , dissipation ) could be chosen to change ( 6 ) , so that galaxies would not merge every time their parent haloes merged ; or at the expense of using more computer disk space , n - body simulations with higher @xmath93 or larger numbers of output time steps could be used .",
    "use of more physically complex group - finders ( e.g. , @xcite  1994 ) should also make some differences to detailed properties of the merger histories .",
    "systematic comparisons between recent analytical predictions ( e.g. , @xcite  1996 ) , merging - cell - models models ( @xcite  1996 ) and n - body derived merger history trees could be made .",
    "an example of a different assumption for processes ( 1)-(5 ) would be to replace the observationally inspired parameters adopted here by free parameters which would be varied to see how sensitive the reduction in the slope of the faint end of the luminosity function is to these parameters .",
    "we would like to thank carlos frenk , george efstathiou , cedric lacey , tim de zeeuw , walter jaffe , simon white , gary mamon , peter thomas , masahiro nagashima and naoteru gouda for several interesting and useful comments and suggestions .",
    "thank you also to bob mann for making many constructive recommendations .",
    "this research has been carried out with support from the australian national university , from the institut dastrophysique de paris , cnrs , from an antares grant , from a pparc research fellowship , from a centre of excellence foreign visiting fellowship at the national astronomical observatory of japan , and has made use of starlink computing resources .",
    "bardeen , j.m . , bond , j.r . ,",
    "kaiser , n. , szalay , a.s .",
    ", 1986 , , 304 , 15 barnes , j. , 1990 , dynamics and interactions of galaxies , ( heidelberg , germany : springer - verlag ) barnes , j. , hut , p. , 1986;;nat.;;324;;446 blumenthal , g. , 1988 , the santa fe tasi-87 , ( singapore : world scientific publishing ) bond , j.r . ,",
    "cole , s. , efstathiou , g. , kaiser , n. , 1991 , , 379 , 440 bond , j.r . , myers , s.t .",
    ", 1996a , , 103 , 1 bower , r.g . , 1991 , , 248 , 332 brainerd , t.g . ,",
    "villumsen , j.v . , 1994 , , 425 , 403 bruzual , g. , 1983;;;;273;;105 canizares , c.r . , 1987 , iau symposium 117 , 1985 , ( dordrecht , holland : d.reidel ) , p165 cen , r.y . ,",
    "ostriker , j.p . , 1992 , , 393 , 22 cole , s.,aragon - salamanca , a. , frenk , c.s . ,",
    "navarro , j.f . ,",
    "zepf , s.e . , 1994 , , 271 , 781 cole , s. , ellis , r. , broadhurst , t. , colless , m. , 1994 , mnras , 267 , 541 cole , s. , kaiser , n. , 1988 , , 233 , 637 colless , m. m. , ellis , r. s. , taylor , k. , hook , r. n. , 1990 , , 244 , 408 colless , m. m. , ellis , r. s. , broadhurst , t. j. , taylor , k. , peterson , b. a. , 1993 , , 261 , 19      davis , m. , efstathiou , g. , frenk , c.s . ,",
    "white , s.d.m . , 1985;;;;292;;371 davis , m. , peebles , p.j.e .",
    ", 1983 , , 267 , 465 efstathiou , g. , frenk , c.s . ,",
    "white , s.d.m . ,",
    "davis , m. , 1988 , , 235 , 715 efstathiou , g. , ellis , r.s . , peterson , b.a . , 1988 , , 232 , 431 ellis , r.s . , colless , m. , broadhurst , t. , heyl , j. , glazebrook , k. , 1996 , , 280 , 235 ( astro - ph/9512057 ) evrard , a.e . , 1988 , , 235 , 911      frenk , c.s . , baugh , c.m . ,",
    "cole , s. , 1995 , astro - ph/9512088 gelb , i.m . ,",
    "bertschinger , e. , 1994 , , 436 , 467 gilmore , g. , 1996 , nat . , 384 , 211 groth , e.j . ,",
    "peebles , p.j.e . , 1977 , , 217 , 385 guiderdoni , b. , rocca - volmerange , b. , 1987 , , 186 , 1    hernquist , l. , 1989;;nat.;;340;;687 hernquist , l. , weinberg , m.d . , 1989 , , 238 , 407 heyl , j.s . ,",
    "cole , s. , frenk , c.s . ,",
    "navarro , j. , 1995 , , 274 , 755 honma , m. , sofue , y. , 1996 , , 48 , l103 hoyle , f. , 1953 , , 118 , 513 hudon , j.d . , lilly , s.j .",
    ", 1996 , , 469 , 519      jedamzik , k. , 1995 , , 448 , 1 kauffmann , g. , white , s.d.m .",
    ", 1993 , , 261 , 921 kauffmann , g. , white , s.d.m .",
    ", guiderdoni , b. , 1993 , , 264 , 201 kundi , t. et al . , 1997 , , 482 , 75 ( astro - ph/9610162 ) lacey , c . , cole , s. , 1993 , , 262 , 627 lacey , c. , guiderdoni , b. , rocca - volmerange , b. , silk , j. , 1993 , , 402 , 15 lacey , c. , silk , j. , 1991 , , 381 , 14 larson , r.b .",
    ", tinsley , b. , 1978 , , 219 , 46 le fvre , o. , hudon , d. , lilly , s.j . , crampton , d. , hammer , f. , tresse , l. , , 1996 , , 461 , 534 ( cfrs - viii ) lilly , s.j .",
    ", tresse , l. , hammer , f. , crampton , d. , le fvre , o. , 1995 , , 455 , 108 ( cfrs - vi ) loveday , j. , peterson , b. a. , efstathiou , g. , maddox , s. j. , 1992 , , 390 , 338 loveday , j. , peterson , b. a. , efstathiou , g. & maddox , s. j. , 1992 , , 390 , 338 lutz , d. et al . , 1996 , , 315 , l137    marzke , r.o .",
    ", huchra , j.p . , geller , m.j .",
    ", 1994 , , 428 , 43 matarrese , s. , coles , p. , lucchin , f. , moscardini , l. , 286 , 1151997 ( astro - ph/9608004 ) melott , a.l .",
    ", 1992 , , 393 , l45 mo , h.j . ,",
    "white , s.d.m .",
    ", 1996 , , 282 , 347 nagashima , m. , gouda , n. , 1997 , astro - ph/9608069 navarro , j.f .",
    ", benz , w . , 1991 , , 380 , 320    norman , c.a . , 1991;;massive stars in starbursts ; ; britain;;cambridge univ . press ; ; ogawa , t. , roukema , b.f . ,",
    "yamashita , k. , 1997 , , 484 , 53 ( astro - ph/9703158 ) peacock , j.a .",
    ", 1996 , mnras , 284 , 885 ( astro - ph/9608151 ) peacock , j.a . , dodds , s.j .",
    ", 1996 , mnras , 280 , l19 peebles , p.j.e .",
    ", 1980;;the large - scale structure of the universe;;princeton , n.j .",
    ", u.s.a.;;princeton university press ; ; pierce , m.j .",
    ", tully , r.b . , 1992 , , 387 , 47 press , w.h . ,",
    "schechter , p. , 1974",
    ", , 187 , 425 prugniel , ph . ,",
    "combes , f. , 1992 , , 259 , 25          rieke , g.h . ,",
    "lebofsky , m.j . ,",
    "thompson , r.i . , low , f.j . and",
    "tokunaga , a.t .",
    ", 1980;;ap.j.;;238;;24 rocca - volmerange , b. , guiderdoni , b. , 1988 , supp , 75 , 93 rodrigues , d.d.c . , thomas , p. , 1996",
    ", , 282 , 361 ( astro - ph/9511018 ) roukema , b.f .",
    ", 1993 , ph.d .",
    "thesis , australian national university , canberra roukema , b.f .",
    ", yoshii , y. , 1993 , , 418 , l1 sarazin , c.l . ,",
    "1987;;iau symposium 117 , 1985 , p183;;dordrecht , holland;;d.reidel ; ; schechter , p. , 1976 , , 203 , 297    scoville , n. , soifer , b.t .",
    ", 1991;;massive stars in starbursts;;britain;;cambridge univ . press ; ; shepherd , c.w . , carlberg , r.g . ,",
    "yee , h.k.c . ,",
    "ellingson , e. , 1997 , , 479 , 82 ( astro - ph/9601014 ) silk , j. , 1977 , , 211 , 638 steinmetz , m. , mller , e. , 1995 , , 276 , 549 suginohara , t. , suto , y. , 1991 , , 371 , 470 suto , y. , suginohara , t. , 1991 , , 370 , l15 tanvir , n.r . , shanks , t. , ferguson , h.c . ,",
    "robinson , d.r.t . , 1995 , nat . , 377 , 27 tyson , j.a . , 1988 , , 96 , 1 tyson , j.a . ,",
    "seitzer , 1988 , , 335 , 552 umemura , m. , fukushige , t. , makino , j. , ebisiuzaki , t. , sugimoto , d. , turner , e. , loeb , a. , 1993 , pasj , 45 , 311 vigroux , l. et al . , 1996 , , 315 , l93 walker , t.p . , steigman , g. , schramm , d.n . ,",
    "olive , k.a .",
    ", kang , h .- s . , 1991 , , 376 , 51 warren , m. , quinn , p.j . ,",
    "salmon , j. , zurek , w.h .",
    ", 1992 , , 399 , 405 warren , s.j .",
    ", iovino , a. , hewett , p.c . , shaver , p.a .",
    ", 1993 , observational cosmology , ed .",
    "g.  chincarini et al . , ( san francisco : astr .",
    "pac . ) , p. 163",
    "weinberg , d.h .",
    ", hernquist , l. , katz , n. , 477 , 81997 ( astro - ph/9604175 )"
  ],
  "abstract_text": [
    "<S> a method of deriving and using merging history trees of dark matter galaxy haloes directly from pure gravity n - body simulations is presented . </S>",
    "<S> this combines the full non - linearity of n - body simulations with the flexibility of the semi - analytical approach .    merging history trees derived from power - law initial perturbation spectrum simulations ( for indices @xmath0 and @xmath1 ) by @xcite  ( 1992 ) </S>",
    "<S> are shown . </S>",
    "<S> as an example of a galaxy formation model , these are combined with evolutionary stellar population synthesis , via simple scaling laws for star formation rates , showing that if most star formation occurs during merger - induced bursts , then a nearly flat faint - end slope of the galaxy luminosity function may be obtained in certain cases .    </S>",
    "<S> interesting properties of hierarchical halo formation are noted : ( 1 ) in a given model , merger rates may vary widely between individual haloes , and typically 20%@xmath230% of a halo s mass may be due to infall of uncollapsed material . </S>",
    "<S> ( 2 ) small mass haloes continue to form at recent times : as expected , the existence of young , low redshift , low metallicity galaxies ( e.g. , @xcite  1997 ) is consistent with hierarchical galaxy formation models . </S>",
    "<S> ( 3 ) for @xmath3 the halo spatial correlation function can have a very high initial bias due to the high power on large scales .    </S>",
    "<S> # 1::::#1 # 1 : : : : # 1::::#1 # 1 : : : :    .    _ tinyn _    # 1;;#2;;#3;;#4 # 1 , # 2 , # 3 , # 4 # 1;;#2;;#3;;#4;;#5 # 1 , in # 2 ( # 3 : # 4 )   # 5 # 1;;#2;;#3 ; ; # 1 . _ # 2 , _ submitted to _ </S>",
    "<S> # 3 _ # 1;;#2;;#3 # 1 . _ # 2 , _ * # 3 * # 1;;#2 ; ; # 1 . _ # 2 _ # 1;;#2;;#3;;#4;;#5 # 1 . _ # 2 , _  _ # 3 , _ * # 4 , * # 5 # 1;;#2;;#1 . _ </S>",
    "<S> # 2 _    : : : :    epsf.tex : : : :    : : : :    : : : :    : : : :    methods : numerical  galaxies : formation  cosmology : theory  galaxies : luminosity function , mass function  galaxies : interactions  galaxies : stellar content . </S>"
  ]
}