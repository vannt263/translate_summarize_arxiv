{
  "article_text": [
    "to understand the intrinsic characteristics and performance of a detector , for both detector design and physics analysis in experimental high energy particle physics , reliable monte carlo ( mc ) simulation is essential .",
    "the beijing spectrometer ( bes @xcite ) detector started to take data in 1989 at the beijing electron positron collider ( bepc ) , which operates in the center - of - mass energy range from 2 to 5 gev .",
    "the early simulation program was egs @xcite based and thus did not generate hadronic interactions of the secondary particles in the detector .",
    "some effects , like fake photons produced by hadrons , were not properly described . for the detector response ,",
    "simple parametric models for sub - detectors were used in the simulation .",
    "as the program grew , the hard - coded structure made it difficult to maintain and make improvements .    with the upgrade of the bes detector ( besii )  @xcite and bepc in 1996 ,",
    "the development of a new monte carlo program , simbes , based on the geant3 package @xcite , was begun .",
    "the decision was motivated by many reasons .",
    "first , larger data samples require better detector simulation to reduce systematic uncertainties .",
    "second , some sub - systems of besii were partly changed and some totally new , and it was difficult to make the required software changes within the old program structure . meanwhile , the geant framework had proven to be a powerful tool for detector description and particle tracking in high energy physics .",
    "geant3.21 , the last version of geant3 , is used in simbes .",
    "much effort is made to model the signal generation , since the digitization procedure is highly detector dependent .",
    "besii data is used for tuning parameters to describe the detector response .",
    "many physics channels are compared with data to check the simulation , and the agreement is reasonably good . in this paper , the general organization and features of simbes",
    "are described in section [ sect2 ] .",
    "detailed simulations of detector response , as well as comparisons with data , are presented in section [ sect3 ] .",
    "besii is a conventional solenoidal magnetic detector that is described in detail in ref .",
    "a 12-layer vertex chamber ( vc ) surrounding the beam pipe provides trigger and coordinate information .",
    "a 40-layer main drift chamber ( mdc ) , located radially outside the vc , provides trajectory and energy loss ( @xmath0 ) information for charged tracks over 85% of the total solid angle .",
    "the momentum resolution is @xmath1 ( @xmath2 in gev / c ) , and the @xmath0 resolution for hadron tracks is @xmath3 .",
    "an array of 48 scintillation counters surrounding the mdc measures the time - of - flight ( tof ) of charged tracks with a resolution of @xmath4 ps for hadrons .",
    "radially outside the tof system is a 12 radiation length , lead - gas barrel shower counter ( sc ) .",
    "this measures the energies of electrons and photons over  80% of the total solid angle with an energy resolution of @xmath5 ( @xmath6 in gev ) .",
    "outside of the solenoidal coil , which provides a 0.4 tesla magnetic field over the tracking volume , is an iron flux return that is instrumented with three double layers of counters which identify muons with momentum greater than 0.5 gev / c .",
    "the geometrical and material descriptions of the detector are given in section [ sect3 ] .",
    "the experimentally measured field map is used in the simulation .",
    "built into the design of geant is the separation of geometry , tracking , and digitization .",
    "simbes respects this feature as illustrated in fig .",
    "[ fig1 ] .    in the initialization stage ,",
    "three kinds of data files are loaded : the material and geometry configuration data used to define the detector , the digitization constants to describe the detector response , and the realization constants ( such as dead channels and wire efficiency ) to simulate the real detector performance .",
    "input values of these parameters can be easily changed by experts or users using control cards without relinking the program .",
    "the besii event generator package ( genbes ) is a stand - alone program that can be executed from within simbes to provide kinematic quantities for primary events .",
    "the generators for radiative qed processes @xcite , selected decays of @xmath7 , @xmath8 , and charmed meson pair production @xcite were taken from other experiments .",
    "the bes developed generators , lund - crm for inclusive decays of @xmath7 and @xmath8 @xcite and ppgen for some exclusive decays of the @xmath8 , as well as some standard generators like jetset , are also included in genbes .    at the end of each stage of processing ( see fig .",
    "[ fig1 ] ) , the intermediate output ( the geometry or hit information in the geant data structure ) can be saved to a disk file , and used as input for later simbes execution .",
    "simbes code structure is hierarchical and modularized",
    ". therefore , each sub - detector stands alone and can be turned on or off by the user .",
    "the besii trigger logic is also implemented in a single module ; the user has an option to switch it on or off when the digitization stage is finished .",
    "simbes is usually run in batch mode to generate raw data and `` mc - truth '' data .",
    "the interactive mode is used for graphic event display .",
    "the tracking of particles through the besii detector is essentially done according to the geant standard .",
    "tracking cutoffs and parameters are carefully tuned for each sub - detector to provide a compromise between simulation precision and computing speed . to correctly simulate electromagnetic shower development in the shower counter ,",
    "the kinetic energy cutoffs of electrons and photons have been set to geant s limit ( 10 kev ) .    when a charged particle traverses a sensitive volume ( a cell or readout channel ) , the hit information , such as the particle position , energy deposit , etc .",
    ", are saved for the digitization procedure which is discussed in the next section .      for hadronic interactions ,",
    "several models have been tried and compared with besii data ; each has advantages for specific channels .",
    "fluka @xcite and gcalor @xcite are the two hadronic models that users can choose in simbes .",
    "extra photons produced by hadronic interactions in the shower counter are studied by a very clean channel @xmath9 ( only 4 charged tracks in the final state ) .",
    "the neutral tracks observed come mainly from pion hadronic interactions in the sc material .",
    "[ fig2 ]    shows comparisons between data and mc data for different hadronic packages .",
    "gcalor reproduces the number of neutral tracks in the sc better than fluka .    in fluka ,",
    "inelastic cross sections for anti - nucleon - nucleus annihilation are set to zero if the anti - nucleon ( @xmath10 or @xmath11 ) kinetic energy is below 50 mev ( corresponding to a momentum of 310 mev / c ) ; this is , of course , not satisfactory for the bepc energy domain .",
    "therefore , the parametrization given in @xcite is used instead to approximate the cross - sections for anti - nucleons at low momentum . for other particles and for elastic cross - sections , standard fluka is used .",
    "[ fig3 ]    shows the energy deposition in the sc for low momentum ( less than 0.8 gev / c ) anti - protons for @xmath12 decays .",
    "fluka s simulation is better than gcalor s .",
    "the location of the primary event vertex is determined by the interaction point ( ip ) of the beam bunches , which varies with each beam collision .",
    "the ip location and beam size distributions are obtained from experimental data for different running periods , and they are used to sample the primary vertex in mc event generation . a @xmath13 fluctuation caused by the extended beam bunch size is taken into account in the tof simulation ( see section [ sect3.3 ] ) .    the vertex chamber ( vc ) , which is built around the beryllium beam - pipe , is composed of 12 layers of straw - tubes .",
    "its hit ( time ) information is used for the trigger .",
    "when a charged particle traverses a straw - tube , the minimum distance between the track and the wire is taken as the drift distance and smeared according to the wire space resolution .",
    "the drift time of the ionization electrons is obtained by dividing the drift distance by an effective drift velocity . the wire efficiency and the wire sag due to gravity are also taken into consideration in this calculation .",
    "the vc simulation is checked using the decay @xmath14 @xcite , which may lose events in the vc trigger because of the long decay length of the @xmath15 particles .",
    "the agreement between data and mc simulation is good when the vc trigger is applied ( fig .",
    "[ fig4 ] ) .",
    "the main drift chamber , which is used to determine trajectories and measure energy losses of charged particles , is the main tracking detector of besii .",
    "it is cylindrical with 10 super layers with 4 sense wires ( axial or stereo ) in each superlayer .",
    "the axial layer is described by geant s tube volume . for stereo layers ,",
    "the shape of the hyperbolic tube ( hype ) in geant can not reproduce the geometry . instead",
    ", the subtraction technique is used on two hypes for the stereo - layer description . in the simulation ,",
    "the wires ( sense , field and guard ) are not put into simbes individually , but an equivalent material inside the mdc , taken as a mixture of gas and wires , is used .    the energy loss calculated by geant for a thin layer is not used in simulating the energy loss by charged tracks in the mdc . instead ,",
    "the energy loss ( q ) at a sense wire is simulated according to the distribution obtained from real data , smeared with an experimentally determined landau distribution .",
    "[ fig5 ]    shows @xmath0 distributions for different particles , where @xmath16 is the truncated mean of the energy loss for each track .    using wire",
    "hit information , the minimum distance between a track and each wire is calculated including the effects of the lorentz angle ( @xmath17 ) and gravitational sagging of the wires .",
    "the drift distance of the ionization is taken as the minimum distance and is smeared by the wire space resolution ( @xmath18 ) .",
    "it is observed from data that the residual of the drift distance is dependent on q , and even for a given q , it can not be simply fitted with a single gaussian ( see fig . [ fig6 ] ) .",
    "therefore , the drift distance is smeared according to a combined distribution of two gaussians ( fit from data ) with the amount of smearing determined by the q value and tracking layer . the wire efficiency is included in the @xmath18 simulation .",
    "when there are multiple hits in a cell , the time signal is taken as the minimum drift time , while the pulse height is determined from the sum of energy losses .",
    "[ fig7 ]    shows momentum distributions ( after track reconstruction ) for data and mc data .",
    "the comparison of momentum resolutions for data and monte carlo is shown in table [ tab1 ] .",
    ".comparison of momentum resolutions for data and monte carlo data . [ cols=\"^,^,^\",options=\"header \" , ]     the pion tracking efficiency ( see fig . [ fig8 ] ) for simulated data    is also found to be consistent with data . in general ,",
    "an error of 2% per track is taken as the systematic error from the tracking efficiency .",
    "alternative algorithms for the mdc wire resolution simulation have also been tested , and their performances are slightly worse ; however , they can be used to determine the systematic uncertainties from the mdc wire resolution simulation .",
    "the tof system provides precise time measurements for particle identification and the trigger .",
    "it consists of two parts , the barrel ( btof ) and the end - caps ( etof ) .",
    "the btof , located just outside of the mdc , employs 48 scintillation counters with photo - multiplier tubes ( pmt ) at each end .",
    "each etof contains 24 scintillators with pmts at one end . in simbes ,",
    "the tof system is described simply by trapezoidal scintillator bars with small gaps between adjacent ones .",
    "after the track passes through the scintillator , the tof hit information contains the particle s position , @xmath19 , at the entry point , its energy deposition , @xmath20 , in the scintillator , and the time of flight , @xmath21 , from the ip .",
    "@xmath20 is determined using energy loss with @xmath22-ray generation and applying birk s law for saturation , while for @xmath21 , the time spread due to the sizable beam bunch is taken into account .",
    "a parameterized model is used to simulate the adc and tdc outputs ; it assumes the light produced at the entry point propagates with attenuation to the two ends .",
    "the amplitude and arrival time are obtained according to @xmath23 where f is a conversion constant , @xmath24 the attenuation length ( about 3 m ) , @xmath25 the effective light velocity in scintillator , the last term in @xmath26 is a correction for @xmath27 and @xmath19 which is obtained from the calibration .",
    "the time walk effect is included in @xmath28 .",
    "adc and tdc counts are generated by smearing @xmath27 and @xmath26 according to their resolutions , and a @xmath27 threshold is applied to the signal .",
    "the resolutions for each counter are obtained using bhabha events ; in the smearing , the time resolution dependence with amplitude and hit position is taken into account . for multiple hits in a single counter , taking",
    "the time walk effect as a good approximation , only the hits with @xmath27 over threshold contribute to the tdc count , while all pulse heights are summed to give the adc count .",
    "[ fig9 ]    shows the @xmath29 distributions for bhabha and dimuon events , and the pion particle identification ( pid ) efficiency for the btof as a function of momentum is shown in fig .",
    "[ fig10 ] .",
    "the simulation is in a good agreement with data , and an uncertainty of 1% per track is usually taken as the systematic error for pid with the tof .",
    "the shower counter consists of two parts , the barrel ( bsc ) and the end - caps ( esc ) . in this section",
    ", bsc is taken as an example to demonstrate the simulation procedure .",
    "the cylindrical bsc consists of 24 layers of gas tubes interleaved with 23 layers of lead absorbers .",
    "there are 560 cells ( tubes made of aluminum ) in each gas layer . in order to reduce the number of electronic readout channels , layers with the same @xmath30 angle",
    "are grouped into six readout layers in the @xmath31 direction . to save computation time , the absorber layer is modeled using a mixture of al - pb - al sandwiches as its material , while the sensitive layer ( cell ) is filled with gas working in self - quenching streamer ( sqs ) mode .",
    "the support ribs and some insensitive regions around them are properly described in simbes .    when a charged particle hits a gas tube , the energy deposited ( total charge ) is sampled according to the sqs spectrum which can be parameterized by a landau distribution .",
    "corrections are made to this charge for the angle dependence of the track and for different layers .",
    "the pulse heights at the two ends of the tube are derived by charge division , and the final adc outputs are obtained by smearing the pulse heights with a gaussian which accounts for the contribution from the electronics . in the case of multiple hits in a tube , if two hits are close enough , they are merged as one hit .    the simulated hit profiles ( number of hits in different layers ) of an electromagnetic shower are in close agreement with data .",
    "[ fig11 ]    shows the energy deposition ( using gcalor ) in the bsc for different particles after the energy calibration with bhabha events .",
    "[ fig12 ] @xcite    shows the ratio of photon detection efficiency in the bsc for data and mc data .",
    "the comparison indicates reasonable agreement , and 2% per photon is taken as the systematic error for the photon detection efficiency .",
    "the muon identifier is the outermost component of bes and is composed of three layers of iron absorber and three layers of proportional chambers .",
    "there are 189 chambers distributed in an octagonal structure , each chamber consists of 8 proportional gas tubes which are arranged into two sub - layers . the complex geometrical structure and magnetic field @xcite of the muon system",
    "are well described in simbes .    in the simulation , the hit position ( z ) along the tube",
    "is smeared by the resolution ( obtained from data ) , the adc signals at the two ends are obtained from charge division of the energy deposit from geant , and the wire efficiency from data is also included .",
    "[ fig13 ]    shows the comparison of the hit positions in the muon chamber for data and mc data .",
    "the agreement is satisfactory .",
    "a monte carlo program simbes has been developed for besii simulation .",
    "special efforts are made to accurately simulate the response of the detector .",
    "for each sub - detector , some key physics quantities are compared with besii data to test the simulation quality .",
    "it is shown from many checks that the overall performance of the current simbes is satisfactory and that the results from simulation are generally consistent with data .",
    "on the other hand , there is still room for further improvement .",
    "for example , the digitization of mdc should be regarded as an ` effective ' simulation where many physics mechanisms are hidden , and noise in the mdc is not considered at present .",
    "the new monte carlo package ( simbes ) has significant impact on physics results .",
    "as an example , the branching ratio of @xmath32 measured by bes is @xmath33 @xcite , which is significantly higher than the pdg value of @xmath34 @xcite . in this measurement",
    ", it is found that the efficiency using a two - gaussian resolution function in the mdc wire simulation is about 20% lower than that using a single gaussian function , and that the efficiency including hadronic interactions is about 10% lower than without them .",
    "we would like to thank dr .",
    "s. banerjee for helpful discussions and suggestions .",
    "we also acknowledge the contribution of many other past members of the bes collaboration . this work is supported in part by the national natural science foundation of china under contracts",
    "nos . 10491300 , 10225524 , 10225525 , the chinese academy of sciences under contract no .",
    "kj 95t-03 , the 100 talents program of cas under contract nos .",
    "u-11 , u-24 , u-25 , and the knowledge innovation project of cas under contract nos .",
    "u-602 , u-34 ( ihep ) ; by the national natural science foundation of china under contract no .",
    "10175060 ( ustc ) , and no .",
    "10225522 ( tsinghua university ) ; and by the department of energy under contract no .",
    "de - fg02 - 04er41291 ( u hawaii ) .",
    "bai , _ et al . _",
    "( bes collab . ) , nucl . instr . and meth . a * 344 * ( 1994 ) 319 . ding hui - liang , _",
    "( bes collab . ) , hep & np * 16 * ( 1992 ) 769 .",
    "nelson , h. hirayama and d.w.o .",
    "rogers , the egs4 code system , slac-265 , 1992 .",
    "bai , _ et al . _",
    "( bes collab . ) , nucl . instr . and meth . a * 458 * ( 2001 ) 627 .",
    "cern program library long writeup w5013 , cern , 1993 .",
    "the generators , written by f.a .",
    "et al . _ , include the processes of radiative bhabha , radiative muon pair and radiative two photons .",
    "the generators were originally developed by the markiii collaboration .",
    "chen , _ et al .",
    "d * 62 * ( 2000 ) 034003 .",
    "a. ferrari , p.r .",
    "sala , g. guaraldi and f. padoani , nucl .",
    "b * 71 * ( 1992 ) 412 . c. zeitnitz and t.a .",
    "gabriel , nucl .",
    "instr . and meth . a * 349 * ( 1994 ) 106 .",
    "m. astrua , _ et al .",
    "phys . a * 697 * ( 2002 ) 209 .",
    "x. shi , _ et al .",
    "_ , hep & np * 28 * ( 2004 ) 982 .",
    "et al . _ ,",
    "hep & np * 28 * ( 2004 ) 859 .",
    "z. wang , _ et al .",
    "_ , hep & np * 27 * ( 2003 ) 716 .",
    "bai , _ et al .",
    "_ ( bes collab . ) , phys . rev .",
    "d * 70 * ( 2004 ) 012005 .",
    "particle data group , s. eidelman,_et al .",
    "b * 592 * ( 2004 ) 60 ."
  ],
  "abstract_text": [
    "<S> a monte carlo program based on geant3 has been developed for besii detector simulation . </S>",
    "<S> the organization of the program is outlined , and the digitization procedure for simulating the response of various sub - detectors is described . </S>",
    "<S> comparisons with data show that the performance of the program is generally satisfactory .    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    monte carlo simulation , detector response 07.05.tp </S>"
  ]
}