{
  "article_text": [
    "in the last decade two important results have appeared in the context of spin - glass theory and disordered systems . in @xcite",
    "the formulation of the replica - symmetry - breaking ( rsb ) ansatz in terms of populations of fields for the bethe lattice was presented .",
    "this has led both to the possibility of obtaining new analytical predictions in the low temperature phase of the model and to the introduction of the survey - propagation ( sp ) algorithm that has been applied successfully to random @xmath0-sat instances @xcite .",
    "on the other hand it was recognized that the well - known belief - propagation algorithm corresponds to the bethe approximation @xcite , and the generalized belief propagation ( gbp ) algorithm was subsequently introduced in ref .",
    "@xcite as a message - passing algorithm to minimize the kikuchi free energy , a more complex approximation than the bethe one that goes also under the name of cluster variational method ( cvm ) @xcite .",
    "since then the idea of merging these two approaches has been around but has not been developed so far , probably due the fact that the standard understanding of the hierarchical ansatz at the bethe level comes from the cavity approximation , while a cavity - like understanding of more complex kikuchi approximations is lacking . in this paper",
    "we will show that a cavity - like understanding of cvm , although desirable , is not necessary to implement replica - symmetry ( rs ) and rsb in the cvm , everything can be worked out using the replica method .",
    "the main idea is to apply the cluster variational method to the replicated free energy and then to use the rs ansatz or the more general parisi s hierarchical ansatz in order to send the number of replicas @xmath1 to zero .",
    "we will use the message passing gbp formulation of cvm representing the messages as populations of populations of local fields and obtain a set of equations that represents the generalization of the survey - propagation equations . in principle",
    "the method can be implemented to compute thermodynamic quantities both averaged over different disorder realizations and on a single sample .",
    "the main difference with the bethe case is that the populations appear in the equations in implicit form and therefore standard iterative population dynamic algorithms can not be used to determine them . in the simplest cases the solution",
    "could be obtained iteratively using fourier transforms . in appendix",
    "[ inversion ] we will show that , in principle , the problem may be solved at any level of rsb using appropriate integral transforms . nonetheless , it turns out to be very hard the actual implementation of this scheme beyond the rs averaged case or 1rsb on a single sample .",
    "furthermore the application on specific models tells us that the messages should not be represented by populations but rather by functions that are not positive definite and this represents another technical difficulty , together with the fact that the equations are written in terms of integrals in many dimensions .",
    "in general we expect the technical difficulty of the various approximations to grow very rapidly as we increase the size of the maximal cvm regions and the number of rsb steps .",
    "we will present the approach in full generality , _ i.e. _  for any cvm approximation and for any number @xmath0 of rsb steps either with or without disorder averaging .",
    "the general presentation is somewhat formal and will be postponed to appendices [ rsbparametrization ] and [ gsp ] instead we will initially discuss the application of the method to the classic plaquette approximation of the averaged free energy of the edwards - anderson model in the paramagnetic replica - symmetric phase . in section [ plaquette ] we write down the rs message - passing equations for the model and we discuss some of their features , in particular the misleading analogy between the gbp equations on a single sample and the rs equations of the averaged system . in section [ paramagnetic ] we compute the free energy and find that the spurious spin - glass phase transition of the bethe approximation disappears and the paramagnetic phase is thermodynamically stable down to zero temperature for different kinds of random interactions .",
    "we consider also the 2d triangular and hexagonal lattices . in both cases",
    "the paramagnetic solution yields positive entropy down to zero temperature , however the triangular lattice with bimodal interactions has a spurious spin - glass transition at @xmath2 , much smaller than the bethe approximation result @xmath3 .",
    "we also show that the quantitative estimates of the free energy and of various other quantities improve those of the bethe approximation both qualitatively and quantitatively . in section [ sgtran ]",
    "we obtain the location of a possible second - order spin - glass phase transition studying the jacobian of the variational equations around the paramagnetic solution .",
    "this approach predicts no second - order phase transition on the 2d square lattice , in perfect agreement with the most reliable numerical studies @xcite .",
    "unfortunately it appears that such a good performance in 2d spoils the 3d result : the plaquette approximation fails to predict a second - order spin - glass phase transition on the cubic 3d lattice , which is well seen in numerical studies @xcite . the same plaquette approximation provides very good results in dimension four and higher . although we do not solve the equations in the spin - glass phase the analysis of the jacobian provides important information on the behaviour of the messages below the critical temperature .",
    "most importantly we find that the messages should not be represented by populations of fields but rather by functions that are not positive definite .",
    "this unexpected feature of the actual solutions pushed us to investigate the physical meanings of the various objects involved in the computation .",
    "in section [ physint ] we provide the physical interpretation of the beliefs in the replica - symmetric phase as the distributions of the local hamiltonians with respect to different realizations of the disorder .",
    "the messages instead do not admit such an interpretation and therefore need not to be represented as populations in the spin - glass phase at variance with the bethe approximation .",
    "we will also discuss the relationship between our approach and the earlier results of the tohoku group @xcite .",
    "the present approach can be used in principle to study the phase diagram of a wide range of disordered systems and it is also possible that it can be used to get quantitative predictions on single samples .",
    "these further developments present however great technical challenges and in the last section of the paper we discuss some of them .",
    "the average free energy per spin of a spin - glass system of size @xmath4 is computed through the replica method as @xcite : @xmath5 where @xmath6 label different realizations of the disorder and the angular brackets mean average over them . in recent years it has been realized that the replica - symmetry - breaking solution can be usefully applied ( through the cavity method ) to a given disorder realization , in the replica framework this corresponds to write the free energy as : @xmath7 the above expression is apparently trivial because the replicas are uncorrelated if we do not average over the disorder , however in the spin - glass phase the true thermodynamic state is the one in which the distinct replicas are actually correlated because of spontaneous rsb . in the replicated edwards - anderson model",
    "we can define the following functional : @xmath8 such that the free energy is obtained as the @xmath9 limit of the above expression . for a single sample",
    "the analogous function @xmath10 is obtained removing the averages over the couplings @xmath11 .",
    "although in the present paper we will be interested in the @xmath12 limit , it is worth noticing that the replica cluster variational method can provide an approximation to the entire function @xmath13 , which is related to free energy fluctuations from sample to sample @xcite .",
    "moreover , at the rs level of approximation , the value @xmath14 may provide a better approximation to the typical free - energy than @xmath15 ( at the cost of introducing reweighting terms in the rs integral equations ) .    in the following we will consider regions of spins @xmath16 and we will use the definition @xmath17 ( or @xmath18 on a given sample ) to make contact with the notations of ref .",
    "the difference between the two cases is that in the averaged case @xmath19 is homogeneous over space while it fluctuates on a single sample .",
    "we will refer to the region of two interacting spins as @xmath20 .    in both cases",
    "the functional @xmath13 can be regarded as the equilibrium free energy of a replicated model .",
    "the free energy can be expressed through a variational principle .",
    "the resulting expression involves an energetic and an entropic term .",
    "the problem is that the latter is usually very difficult to be treated .",
    "a standard way to treat it is kikuchi s cluster variational method . in its modern formulation",
    "this method consists in writing the entropic term as a sum of entropic cumulants and then to truncate this expansion at some order , see @xcite for a recent detailed presentation .",
    "basically the starting point of the approximation is to chose a set of regions of the graph over which the model is defined .",
    "these are called the maximal clusters and the entropic expansion is truncated assuming that the cumulants of larger regions vanish . in recent years",
    "it has been realized that the variational equations can be written in a message passing way @xcite and we will use this formulation in order to extend the cvm to replicated models , either averaged or not over the disorder .",
    "in the following we will briefly present the message - passing approach to cluster variational method of ref .",
    "we will use the same notation of ref .",
    "@xcite and we refer to it for a more detailed presentation",
    ".    we will call @xmath21 a set of connected clusters ( regions ) of nodes ( spins ) , plus their intersections , plus the intersections of the intersections and so on .",
    "then @xmath22 is the state ( configuration ) of nodes in @xmath16 and @xmath23 ( the belief ) is an estimate of the probability of configuration @xmath22 according to the gibbs measure .",
    "following @xcite we will often use the notation @xmath24 omitting the explicit dependence of the beliefs @xmath23 on @xmath22 .",
    "then the energy of region @xmath16 is @xmath25 where the products run over all links and nodes ( in presence of a field ) contained in region @xmath16 . with this definitions ,",
    "the kikuchi free energy reads : @xmath26 where the so - called moebius coefficient @xmath27 is the over - counting number of region @xmath28 defined by @xmath29 .",
    "the set @xmath30 is made of all ancestors of @xmath28 , _",
    "i.e. _  it is the set of all regions that contain @xmath28 .",
    "the condition @xmath31 holds for the largest regions .",
    "the cluster variational method amounts to extremize the free energy with respect to the beliefs , under the constraint that the beliefs are normalized and compatible one with each other in the sense that the belief of a region can be obtained marginalizing the belief of any of its ancestors .",
    "it is worth noticing that the kikuchi free energy does not provide in general an upper bound on the true free energy of the model .    the main result of ref .",
    "@xcite was to show that the variational equations for the beliefs can be written in a message - passing fashion . in order to do this",
    "we define for any given region @xmath16 : i ) the set of its ancestors @xmath32 , that is the set of regions that contain region @xmath16 ; ii ) the set of its parents @xmath33 , that is the subset of its ancestors that have no descendant that is also an ancestor of @xmath16 ; iii ) the set of its descendants @xmath34 , that is the set of regions contained in region @xmath16 ; iv ) the set of its children @xmath35 , that is the subset of its descendants that are not contained in a region that is also a descendant of @xmath16 .",
    "one introduces message @xmath36 from a region @xmath16 to any of its children @xmath28 .",
    "the messages can be thought of as going from the variable nodes ( spins ) in @xmath37 to the variable nodes in @xmath28 .",
    "they depend on the configuration of @xmath38 but for brevity this dependence is omitted .",
    "we also need the following definitions : and @xmath39 corresponds respectively to @xmath40 and @xmath39 defined in @xcite .",
    "note however that for us these are ensembles of couples of regions labels instead of ensembles of the corresponding messages as in @xcite . ]",
    "* @xmath41 is defined as the ensemble of connected ( parent - child ) pairs of regions @xmath42 such that @xmath43 is outside @xmath16 while @xmath44 coincides either with @xmath16 or with one of its descendants .",
    "* @xmath45 is the ensemble of connected pairs of regions that are in @xmath41 but not in @xmath46 .",
    "* @xmath39 is the ensemble of connected pairs of regions such that the parent is a _ descendant _ of @xmath16 and the child is either region @xmath28 or a descendant of @xmath28 .",
    "although all these definitions of sets of regions may look abstract and hard to follow , in the next section we will provide immediately an example on the 2d square lattice which should make these definitions clearer .    with the above definitions it can be shown @xcite that the beliefs can be expressed as : @xmath47 where @xmath48 is a normalization constant because they are probability distributions .",
    "the messages obey the following equations : @xmath49 where @xmath50 is some constant ( see below ) and @xmath51 is the set of interactions between the nodes of region @xmath16 without considering those that are just in region @xmath28 ,",
    "_ i.e._@xmath52 .",
    "the constants in eq .",
    "( [ yedmessage ] ) can be fixed to any positive value , indeed the messages need not to be normalized . in @xcite the constants @xmath50 are fixed to 1 , while here , for reason of convenience , _ we work with messages normalized to unity _ , and the @xmath50 have to be intended as normalization constants .",
    "two sets of messages obtained solving the equation with two different sets of values of the constants @xmath50 are simply related by positive multiplicative factors .    in general",
    "the kikuchi free energy has to be extremized with respect to the beliefs @xmath24 under the constraint that they are compatible , in the sense that the belief of one region marginalized to one of its subregion @xmath28 has to be equal to @xmath53 .",
    "this is done introducing appropriate lagrange multipliers .",
    "the results quoted above have been obtained showing that there exists an equivalent set of constraints between each parent - child couple @xmath54 such that imposing these constraints through a set of lagrange multiplier @xmath55 , extremizing with respect to the beliefs and identifying @xmath56 , one immediately gets equation ( [ belief ] ) ; equation ( [ yedmessage ] ) for the messages is obtained imposing the standard marginalization conditions for the beliefs .",
    "this makes clear why the message @xmath36 as a function of @xmath38 can be normalized to any positive constant , indeed this corresponds to a constant shift in the definition of the lagrange multipliers @xmath55 .",
    "once the beliefs are obtained the kikuchi free energy can be computed .",
    "however for our purposes we derive another expression of the free energy in terms of the messages . to do this",
    "we note that if one substitutes the expression for the beliefs in the kikuchi free energy plus the lagrange multipliers terms one obtains the following _ variational expression for the free energy _",
    "@xmath57 \\label{varf}\\ ] ] this expression for @xmath58 is stationary with respect to the messages in the sense that the equations ( [ yedmessage ] ) can be also obtained extremizing it with respect to the messages . ) along the same lines of the proof that the two sets of constraints are equivalent , see theorem 5 in @xcite ] the fact that we can choose any normalization for the messages can be also derived noticing that the variational free energy is invariant under a rescaling of the messages @xmath59 .",
    "indeed the resulting free energy would differ by a term @xmath60 as can be seen subtracting the two equations @xmath61 and @xmath62 , see eq .",
    "124 in @xcite .    for later convenience",
    "we also introduce the following messages normalized to unity : @xmath63 accordingly the tilded messages defined above obey an equation with no messages at the denominator : @xmath64 in the case of replicated models @xmath22 defines the state of the spins in regions @xmath16 where each spin is replicated @xmath1 times . for any finite integer @xmath1",
    "the above equations in principle can be solved explicitly , but in order to make the analytical continuation to real small @xmath1 we need to rephrase them in an appropriate way .",
    "this will be done using the hierarchical ansatz .",
    "the hierarchical ansatz was introduced by g. parisi in the context of fully - connected spin - glass models @xcite and later extended to spin - glasses defined on random lattices where the bethe approximation is correct @xcite .",
    "it is also called the replica - symmetry - breaking ( rsb ) ansatz and can be introduced with different levels of rsb steps @xmath0 .",
    "the value @xmath65 corresponds to the replica - symmetric case that in spin - glasses is assumed to be correct in the paramagnetic phase valid at high enough temperature or magnetic field .",
    "the rs parametrization is already non - trivial in the present general cvm context and presents some substantial differences with the bethe approximation .    in the following sections we will consider the message passing - formulation of the cvm plaquette approximation at the rs level and study its high - temperature phase quantitatively .",
    "the general rsb for a generic cvm approximation will be presented in the appendices at the end of the paper .",
    "in this section and in the following we study the plaquette approximation for the replicated edwards - anderson model on various regular lattices in dimension @xmath66 .",
    "the plaquette approximation is the oldest improvement on the bethe approximation @xcite .",
    "a detailed presentation of its message - passing formulation can be found in @xcite and @xcite . in this approximation",
    "there are three regions : the plaquette of four spins , the couple of spins and the single spin ( the point - like region ) . to make connection with the more abstract definition of regions given in the previous section",
    ", please note that @xmath67 , @xmath68 , @xmath69 , @xmath70 , @xmath71 , @xmath72 , @xmath73 , @xmath74 , and void sets are not reported .",
    "thus we deal with two types of replicated - spins messages , from plaquette to couple and from couple to point . if we do not average over the disorder the messages depends on the position of the corresponding regions on the lattice while if we average over the disorder all the replicated messages are the same and we have to deal with just two of them .",
    "we will work at the rs level , _",
    "i.e. _  with @xmath65 rsb steps",
    ". physically this corresponds to the case where on each sample there is a single thermodynamic state and the messages are just numbers that fluctuate over space .",
    "correspondingly in the averaged case the messages are functions that are spatially homogeneous as we will see below . on a single sample the equations we will obtain correspond to gbp , while in the averaged case the equations are new .",
    "as we will see in the following , looking at the equations of the averaged case as if the message functions represent the spatial distribution of the gbp messages on a single - sample is completely wrong ; we will come back on this issue several times later in the paper and finally present the correct interpretation of the various quantities in section [ physint ] .",
    "let us start with the equation for a given sample defined on a 2d square lattice .",
    "at the rs level this corresponds to work with a single replica . with reference to fig .",
    "[ fig2dindex ] and according to eq .",
    "( [ yedmessage ] ) we see that we have two types of messages .",
    "the first type of message is from a couple of spins , say @xmath75 , to a spin @xmath76 and it is a function @xmath77 of the value of the ising spin @xmath78 . as a consequence",
    "the message can be parametrized by a single field @xmath79 according to the following expression : @xmath80 / ( 2 \\cosh(\\beta u_{fg , f}^f))\\;,\\ ] ] the second type of messages is from a region of four spin , say , @xmath81 to a couple of spins @xmath82 and it is a function @xmath83 of the two ising spins @xmath84 , as a consequence it can be parametrized by three fields @xmath85 in the following way : @xmath86{\\cal      n}(u_{fglm , lm}^{lm},u_{fglm , lm}^l , u_{fglm , lm}^m)\\ ] ] where @xmath87 is a normalization constant that enforces the condition @xmath88 .",
    "now equations ( [ yedmessage ] ) can be rewritten in terms of the various @xmath89-fields and yield a closed set of equations for them . in order to write down these equations",
    "explicitly we introduce the following functions : @xmath90 and @xmath91 where @xmath92 @xmath93 \\ .\\ ] ] the equation for the field @xmath79 reads : @xmath94 where the l.h.s",
    ". corresponds to the r.h.s .",
    "of equation ( [ tm ] ) and the r.h.s . corresponds to the r.h.s .",
    "( [ tm1 ] ) .",
    "the equation for the @xmath95-field from the plaquette @xmath81 to the couple @xmath82 reads : @xmath96 where the notation @xmath97 stands for the fact that we have to substitute the arguments of the functions @xmath98,@xmath99 and @xmath99 according to : @xmath100 again the l.h.s .",
    "( [ gbp1],[gbp2],[gbp3 ] ) correspond to the r.h.s . of eq .",
    "( [ tm ] ) while the r.h.s .",
    "correspond to the r.h.s . of eq .",
    "( [ tm1 ] ) .",
    "as we already said up to this point we have just written the gbp equations of @xcite .",
    "now we turn to the replicated cvm and we study it in the average case . on each site , say @xmath76 , there are @xmath1 spins @xmath101 and the replicated spins interact with their neighbors , say @xmath102 with an interaction term of the form @xmath103 $ ] . the general rs and rsb ansatz of a function @xmath104 of @xmath1 spins was originally presented in @xcite , later its parametrization in terms of distributions of fields was suggested in @xcite and later revisited in @xcite , and we refer to those paper for an explanation of the main ideas underlying it .",
    "we have generalized it to a generic function @xmath105 where each @xmath106 is a set of @xmath1 ising spins , in this section we present the rs case while the general rsb case is presented in the appendices .",
    "let us consider the first kind of message , the couple - to - point , say @xmath107 .",
    "for each integer @xmath1 we could parametrized it through @xmath108 fields , however such a construction is not suitable to perform the @xmath9 limit .",
    "therefore following @xcite we parametrized it through a message function @xmath109 in the following way : @xmath110 ( 2\\cosh \\beta u_{fg , f}^f)^{-n}\\ ] ] where we have used the shorthand notation @xmath111 .",
    "the plaquette - to - couple message in turn is parametrized through a message function @xmath112 as : @xmath113 \\end{aligned}\\ ] ] where we have used the shorthand notation @xmath114 the above parametrization allows to rewrite the message - passing equations ( [ yedmessage ] ) as a set of equations for the message functions for any replica number @xmath1 .",
    "the derivation of these equations is conceptually straightforward and it is given in the appendix .",
    "here we just quote the results , in particular in the @xmath115 we have : @xmath116 where the arguments of the function @xmath117 are as in eq .",
    "( [ arghat ] ) , @xmath118 and @xmath119 is the disorder distribution of the quenched coupling @xmath120 .",
    "the equation for @xmath121 is obtained from eqs .",
    "( [ tm ] ) and ( [ tm1 ] ) .",
    "the l.h.s .",
    "is given by the r.h.s .",
    "( [ tm ] ) and reads : @xmath122 the r.h.s .",
    "is given by the r.h.s .",
    "( [ tm1 ] ) and reads : @xmath123 where the arguments of the functions @xmath98,@xmath99 and @xmath99 are as in eqs .",
    "( [ gbp1],[gbp2],[gbp3 ] ) . now equating the l.h.s . and r.h.s . written above for each value of the auxiliary variables @xmath124 we get the equation for @xmath121 .",
    "the cvm free energy can also be expressed in terms of the various message functions @xmath121 and @xmath125 .",
    "it is presented in full generality in appendix @xmath126 and will not be reported here .",
    "the resulting expression is variational in the sense that the above equations can be also obtained extremizing it with respect to its arguments _ i.e. _  the various functions @xmath121 and @xmath125 .",
    "the number of replicas @xmath1 appears as a parameter in the variational free energy and the analytical continuation to non - integer values can be performed . as we will see in appendix [ gsp ] , in order to derive such an expression it is crucial to start from the variational expression ( [ varf ] ) which depends on the messages and not on the beliefs as expression ( [ fbeliefs ] ) .      in the following",
    "we will briefly discuss the equations just obtained for the message functions .",
    "first of all we note that in the average case the replicated hamiltonian is spatially homogeneous and therefore it is natural to assume that all the couple - to - point message functions are described by a single function @xmath127 and all the plaquette - to - couple message functions are described by a single function @xmath128 . on the other hand ,",
    "the above equations gives us an idea of what it would look like to be working on a single sample at the 1rsb level . indeed in this case",
    "we should have message functions fluctuating in space and obeying the above equations ( obviously without the average over the couplings @xmath6 ) . as we will see in appendices",
    "[ rsbparametrization ] and [ gsp ] the above equations would corresponds to make the 1rsb on a single sample with @xmath129 while in order to treat the general case @xmath130 we should add the appropriate reweighting terms predicted by eqs .",
    "( [ itesamp1 ] ) and ( [ itesamp2 ] ) .",
    "we note two important technical difficulties that one has to face solving the above equations , also in the averaged case in which one have to deal with just two integral equations for the functions @xmath127 and @xmath128 .",
    "first of all they involve integrals in many dimensions , _",
    "e.g. _  eq .",
    "( [ rhs ] ) requires in principle the computation of integrals in a 16-dimensional space although many of the variables enters the functions @xmath98,@xmath131 and @xmath99 as sums , see eqs.([sommamessprimo][sommamessultimo ] ) , and the actual number of dimensions can be reduced to 7 . in this particular case",
    "other tricks can be used to reduce the number of integrations to 5 , but in general we expect that finding the actual solutions of the equations will be a very challenging problem .",
    "second and most important we see that the message functions @xmath128 and @xmath127 enter the equations in an implicit form and in an iterative scheme one should be able to deconvolve the l.h.s . , eq . ( [ lhs ] ) . at the rs level , or 1rsb level on a single sample",
    ", this can be done using fourier transforms .",
    "looking at the gbp equations on a single instance eq .",
    "( [ arghat ] ) and eqs .",
    "( [ gbp1],[gbp2],[gbp3 ] ) and at the equations in the average case for the functions @xmath128 and @xmath127 eqs .",
    "( [ plav1],[lhs],[rhs ] ) one could be tempted to think that the functions @xmath127 and @xmath128 represent the distributions over different disorder realizations of the corresponding gbp messages on a given sample . as we will show in sections [ sgtran ] and [ physint ] ,",
    "_ this interpretation is wrong and misleading_. it is wrong because it will corresponds to the assumptions that messages passed from the same region are uncorrelated and it is misleading because it will lead to the expectation that , being distributions , they are positive definite , which turns out to be false . the fact that the message functions are not positive definite in general represents another technical difficulty because it means that they can not be represented as populations , a fact that could have simplified the evaluation of the integral equations .",
    "we note that all these difficulties are absent at the bethe approximation level . in this case : i ) there are no convolutions in the equations and ii ) the message function itself ( and not only the beliefs , see section [ physint ] ) admits a physical interpretation as a distribution , consequently it can be represented by a population and the equations can be solved by a population dynamic algorithm .",
    "in the following we will solve the integral equations in the zero - field paramagnetic phase , where no convolutions are needed ( the same is not true even in the paramagnetic phase if we consider a maximal cluster larger than the plaquette or in presence of a field ) .",
    "then we will take the first steps into the spin - glass phase , studying the location of the critical temperature @xmath132 and finding the message functions at temperatures slightly below @xmath132 .",
    "these studies pave the way for an analysis deep in the spin - glass phase that is left for future work .",
    "in the high - temperature region we expect the system to be in a rs paramagnetic phase .",
    "we also expect that cvm is correct at least at high enough temperature because it amounts to neglect spatial correlations beyond a fixed length while the actual correlation length goes to zero at infinite temperature making the approximation more precise at higher temperature . in the paramagnetic phase",
    "the symmetry breaking fields @xmath89 vanish meaning that the spins have no local magnetization .",
    "thus in this region the variational equations admit a solution of the following kind : @xmath133 where @xmath134 satisfies the following self - consistency equation @xmath135\\\\ dp(j_l ) dp(j_u ) dp(j_r ) dq(u_l ) dq(u_u ) dq(u_r ) \\label{paraqu}\\end{gathered}\\ ] ] the corresponding _ variational _",
    "free energy is given by the following expression @xmath136 dp(j ) dq(u_1 ) dq(u_2 ) + 4 \\int \\ln\\big[\\cosh\\big(\\beta(j+u)\\big)\\big ] dp(j ) dq(u)\\\\ + \\int \\ln\\big[1+\\tanh\\big(\\beta(j_l+u_l)\\big ) \\tanh\\big(\\beta(j_u+u_u)\\big)\\tanh\\big(\\beta(j_r+u_r)\\big ) \\tanh\\big(\\beta(j_d+u_d)\\big)\\big]\\\\ dp(j_l ) dp(j_u ) dp(j_r ) dp(j_d ) dq(u_l ) dq(u_u ) dq(u_r ) dq(u_d)\\end{gathered}\\ ] ] as we can see the fact that @xmath89 s vanish simplify considerably the problem because we do not have convolutions to take and the functions @xmath134 ( that in this case _ can _ be interpreted as a probability distribution ) can be obtained either through a population dynamics algorithm or by solving iteratively a discretized version of the variational equation . for symmetry reason the solution is such that @xmath137 . in spite of its relative simplicity the paramagnetic solution in the plaquette approximation",
    "yields very interesting results .",
    "we start considering the 2d edwards - anderson model with bimodal interactions @xmath138 .",
    "although an analytical solution of the 2d edwards - anderson model is missing , numerical studies indicate that the critical temperature of the model is likely to be zero .",
    "moreover a very recent analytical study by ohzeki and nishimori @xcite finds strong evidences for the absence of a finite - temperature spin glass transition in 2d spin glass models . in the following section we will study the possibility of a second order spin - glass phase transition looking for a temperature where small non - zero fields @xmath89 develops .    before entering into the details we summarize the main results :    * the paramagnetic phase is thermodynamically stable down to zero temperature , in the sense that it predicts always a positive entropy . *",
    "@xmath134 converges to a distribution concentrated on the integers in the zero temperature limit yielding a positive zero - temperature entropy .",
    "* there is no spurious spin - glass phase transition ( see next section ) .    in fig .",
    "[ figqu ] we show @xmath134 at temperature @xmath139 , it is already clear that the solution is converging over the integers . at @xmath140",
    "the population converges to a distribution concentrated over integers values even if the starting point was a distribution concentrated on real values , in particular we have : @xmath141 , @xmath142 , @xmath143 , @xmath144 .    in the case of bimodal distribution of the couplings",
    "the fact that the distribution concentrates over integer values is usually considered an indication on the quality of the approximation , we will discuss this issue in more depth below when studying the behaviour of the specific heat .",
    "we anticipate that in 3d the function @xmath134 does not converge over the integers at low temperatures , thus indicating that the paramagnetic solution is not good down to zero temperature in agreement with the expectation that there is a finite temperature spin - glass phase transition in @xmath145",
    ".    furthermore convergence on the integers is necessary in order to recover the expected high degeneracy of the ground state energy and correspondingly a non - zero entropy at zero temperature .",
    "indeed the zero temperature entropy can be computed either studying the behaviour of the free energy at low temperatures or working directly at zero temperature .",
    "the latter approach usually yields more precise estimates and we have followed it to compute the zero - temperature entropies reported below .",
    "to work at zero temperature one needs to consider the so - called evanescent fields writing @xmath146 , where @xmath147 is an integer and @xmath148 is a real number describing the deviations from the integers at small finite temperature .",
    "then the function @xmath134 is replaced by a function @xmath149 and both the zero temperature energy and entropy can be expressed in terms of @xmath149 . when there is no convergence over the integers one can in principle study the solution that is obtained considering only integers values ( the equations are stable on the integers ) . in this case",
    "however the lack of convergence problems shows up when one tries to compute the zero temperature entropy , because the evanescent fields @xmath148 diverges and have no stable distribution .    in fig .",
    "[ figftreg ] we plot the cvm free energy as a function of the temperature . at zero temperature",
    "we find @xmath150 that has to be compared with the best numerical estimate @xmath151 @xcite .",
    "the bethe approximation result is instead @xmath152 and @xmath153 ( from a numerical study on the bethe lattice @xcite ) .",
    "note that the bethe approximations predicts also a spurious spin - glass phase transition at a temperature @xmath154 .",
    "thus we see that the estimate of the ground state energy is better than that of the bethe approximation .",
    "nevertheless the estimated zero temperature entropy @xmath155 is too low , compared to the expected value @xmath156 @xcite , the reason for this is evident from the figure : the quality of the cvm approximation decreases approaching @xmath140 where the correlation length of the actual model is expected to diverge .",
    "we recall that the bethe approximation has the peculiar property that it is correct on the bethe lattice .",
    "therefore there always exists a thermodynamically stable solution in the bethe approximation , _",
    "i.e. _ the one that yields the free energy of the bethe lattice .",
    "this is not true for a general cvm approximation and it is the so - called _ realizability _ problem in cvm theory @xcite .",
    "however it was noted in @xcite that on some models the plaquette approximation yields the exact result for the free energy .    _",
    "gaussian distributed couplings _ - we considered also the 2dea model with gaussian distribution of the couplings . again we find that the paramagnetic phase is thermodynamically stable down to zero temperature where it predicts a vanishing entropy according to what is expected . in this case",
    "the cvm estimates are even better than in the previous case . in fig .",
    "[ figftgauss ] we plot the free energy as a function of the temperature , the ground state energy reads @xmath157 to be compared with the numerical prediction @xmath158 @xcite .",
    "we studied the spin - glass with bimodal distribution of the couplings defined on the triangular lattice and on the hexagonal ( a.k.a .",
    "honeycomb , brickwork ) lattice , using respectively the triangle and the hexagon as the basic plaquette , see fig .",
    "[ figlatt ] .",
    "much as in the square lattice case , the messages are parametrized by a single function @xmath134 in the rs paramagnetic phase representing respectively the triangle - to - couple and hexagon - to - couple messages . in the average case , self - consistency equations for the messages are exactly as eq .",
    "[ paraqu ] , with the only difference being in the number of hyperbolic tangents contained in the argument of @xmath159 ; in other words messages satisfy the following equations in distribution sense @xmath160 for the triangular and hexagonal lattice , respectively . in both cases we found again that the paramagnetic phase is thermodynamically consistent down to zero temperature in the sense that the entropy of the paramagnetic solution is always positive .",
    "the function @xmath134 converges on the integers for the triangular and on the half - integers for the honeycomb lattice predicting a non - vanishing entropy at zero temperature in both cases .    in fig .",
    "[ figfttri ] we plot the free energy of the triangular lattice as a function of the temperature .",
    "the most accurate predictions for the ground state energy and entropy come from a pfaffian method @xcite , giving @xmath161 and @xmath162 .",
    "the bethe approximation predictions @xcite are @xmath163 and @xmath164 while the present cvm triangle predictions are @xmath165 and @xmath166 .",
    "we see that much as in the above cases the cvm estimate of the free energy largely improves upon the bethe one .",
    "note that the bethe approximation predicts a spurious low - temperature spin - glass phase that appears at @xmath167 .",
    "the analysis of the next section shows that the triangle approximation predicts a spurious spin - glass phase transition at @xmath2 .",
    "a detailed study of the spin - glass solution goes beyond the scope of this work but we expect that it will improve the estimate of the ground state energy and entropy .",
    "as in the square lattice case , the zero temperature entropy is less precise than the energy for the same reasons discussed above .    in fig .",
    "[ figfthex ] we plot the free energy of the hexagonal lattice as a function of the temperature .",
    "the numerical predictions for the ground state energy and entropy are respectively @xmath168 and @xmath169 @xcite .",
    "the corresponding bethe lattice predictions @xcite are @xmath170 and @xmath171 while the present hexagonal cvm predicts @xmath172 and @xmath173 . in this case",
    "also the zero temperature entropy improves over the bethe result . in the case of the hexagonal lattice",
    "both the bethe and cvm approximations are much more precise than on the square lattice , and the cvm approximation corrects @xmath174 of the error of the bethe approximation .",
    "note that the bethe approximation predicts once more a spurious low temperature spin - glass phase that appears at @xmath175 .",
    "we have not investigated the presence of a spurious low temperature spin glass phase in the hexagonal cvm approximation , since this study is computationally heavy and we strongly expect such a phase not to exist .",
    "indeed the hexagonal cvm approximation is more accurate than the square cvm approximation , and the latter does not shows any spurious spin - glass phase at low temperatures .    in the 2d square lattice spin - glass models",
    "we have found that the paramagnetic phase is thermodynamically stable down to zero temperature .",
    "this is in agreement with numerical evidence that show that the only critical point is at @xmath140 .",
    "therefore it is natural to ask whether the cvm approximation also predicts a zero - temperature critical point .",
    "one can argue that this is not the case .",
    "indeed both for models with gaussian and bimodal interactions it can be seen that a magnetic field scaling with the temperature as @xmath176 with @xmath177 small has an effect @xmath178 on the free energy , therefore the derivatives with respect to the field diverge as @xmath179 . on the other hand",
    "the fluctuation - dissipation - theorem tells us that the quartic derivative is related to the fluctuations of the overlap ( _ i.e. _  the spin - glass susceptibility ) times @xmath180 .",
    "thus we see that a quartic derivative diverging as @xmath180 does not imply a divergent spin - glass susceptibility at @xmath140 .      in random systems",
    "the free energy fluctuates from sample to sample .",
    "the scaling of the variance with the system size is rather nontrivial in mean - field spin - glass models like the sherrington - kirkpatrick model @xcite and in random graphs with fixed connectivity with bimodal interactions @xcite .",
    "on the other hand in finite dimensional systems it is known that the variance must scale as the square root of the volume @xcite . in particular",
    "at system size @xmath4 the fluctuations @xmath181 of the free energy @xmath182 of a given sample around its average value obey : @xmath183 although the mean - field prediction is @xmath184 it has been shown that the loop corrections leads to a non - zero @xmath185 @xcite .",
    "the present approach also predicts a non - zero @xmath185 and it allows to get a quantitative estimate .    in the replica framework",
    "it can be shown that @xmath185 is related to the @xmath186 term in the expansion of @xmath187 at small @xmath1 ( see @xcite ) .",
    "it has been recently noted @xcite that on the bethe lattice one can compute the @xmath186 expanding the variational expression of @xmath187 around @xmath188 . since the expression is variational the total second derivative with respect to @xmath1 coincides with the partial derivatives evaluated at @xmath188 .",
    "the same argument applies in any cvm approximation . in order to obtain the results we need the variational expression of the cvm free energy written in terms of the message functions that it is presented in full generality in appendix [ gsp ] , the following discussion is based therefore on the definitions and results of appendix [ rsbparametrization ] and [ gsp ]",
    "one has to expand the expression of the variational free energy eq .",
    "( [ e38 ] ) in powers of @xmath1 at the second order and evaluate it using the @xmath134 corresponding to @xmath188 .",
    "we immediately see that the @xmath186 is given by the sum over the different regions @xmath16 of the fluctuations of the corresponding free energy with the usual region coefficients @xmath189 .",
    "in particular we define the free - energy variance of region @xmath16 at generic number of rsb steps @xmath0 as : @xmath190 where we have used the definitions : @xmath191 we recall that the rs approximation corresponds to @xmath65 . with the previous definitions we have : @xmath192 as usual",
    "if we assume that the distribution of the couplings @xmath193 is the same for all @xmath11 we can conclude that the contributions of regions with the same form are equal and replace the above expression with a sum over types of region ( _ e.g. _  the plaquette , the couple and the point in the plaquette approximation ) each multiplied by the number of regions of a given type per spin , see discussion below eq .",
    "( [ e38 ] ) .",
    "note that the @xmath189 can be negative and therefore a wrong approximation could yield a negative @xmath194 , for instance a negative @xmath194 is predicted by the rs solution of the sk model below the critical temperature @xcite , in agreement with the fact that the correct solution is not rs .",
    "on the contrary in all the @xmath195 models considered we have found that the paramagnetic rs solution of the cvm approximation yields a positive @xmath194 down to zero temperature in agreement with the expectation that the actual model is paramagnetic at any finite temperature .    for completeness",
    "we report the expression of the free energy fluctuations @xmath196 of the plaquette approximations for the square lattice 2d model in the paramagnetic rs approximation . according to the above equations we have : @xmath197 in the paramagnetic approximation all the symmetry - breaking small fields vanish , _",
    "i.e. _ @xmath198 and @xmath199 therefore @xmath200 .",
    "for the couple we have : @xmath201 where we have neglected unimportant constant factors .",
    "the contribution of the couple reads : @xmath202 for the plaquette we have : @xmath203 where the argument @xmath97 stands for @xmath204 and : @xmath205    in particular at zero temperature we have @xmath206 , @xmath207 and @xmath208 respectively for the square , hexagon and triangle cvm approximation of the corresponding @xmath195 lattices with bimodal coupling . in the case of the square lattice with gaussian couplings",
    "we estimate @xmath209 leading to @xmath210 in very good agreement with the value @xmath211 for the actual model reported in @xcite .",
    "we note that the estimates for the @xmath195 lattices with bimodal interactions represent a critical improvement with respect to the bethe lattice where one has @xmath184 because of the spatial homogeneity of the model @xcite .",
    "another interesting prediction of the cvm approach regards the behaviour of the specific - heat at low temperatures . in the case of the square lattice",
    "it was suggested long ago by swendsen and wang @xcite that the behaviour of the specific heat at low temperature is of the form @xmath212 \\label{cv}\\ ] ] with @xmath213 .",
    "this is absolutely non - trivial because the energy of any finite - size excitation for the square lattice is a multiple of @xmath214 , and this would lead instead to @xmath215 as later claimed in @xcite . over the years",
    "the @xmath213 result has been supported by many authors @xcite ; recently another scenario has also been proposed in which @xmath216 behaves as a power law @xcite with a universal exponent that is the same of models with gaussian distributions of the couplings .",
    "the true nature of @xmath216 remains nevertheless unclear @xcite .",
    "given that @xmath134 is symmetric it follows that in both the square , hexagonal ( in agreement with @xcite ) and triangular lattice the behaviour of the specific heat at low temperature predicted by the cvm approximation is of the form ( [ cv ] ) with @xmath213 and @xmath217 .",
    "note that this is a non - trivial prediction not only for the square lattice but also for the triangular one .",
    "it must be remembered however that the cvm is intrinsically a mean - field approximation and could never give a power - law behaviour . on the other hand",
    "it clearly suggests that even if a power - law behavior is actually present there are corrections of the form ( [ cv ] ) with the non - trivial value @xmath213 .",
    "the cvm approach yields also the numerical coefficient @xmath218 of the leading term in ( [ cv ] ) that can be computed working directly at zero temperature . given that the correction is exceedingly small it is safer to work directly at zero temperature . in order to compute this coefficient one",
    "has to write the finite - temperature field @xmath219 as @xmath220 and study the joint distribution of the triplets @xmath221 whose equation was obtained considering the leading order contribution of the equation of @xmath134 .",
    "summarizing the low temperature behaviour of the specific heat according to the cvm approximation for the 2d ising spin - glass with bimodal interactions is @xmath222\\ ] ] the coefficient in the case of the square lattice is @xmath223 and does not appear to compare well with the numerical data , if we go back to fig .",
    "[ figftreg ] we can argue that the error of the cvm square approximation with respect to the actual model is not small enough to reproduce quantitatively the behaviour of the specific heat    at last , it is also interesting to note that much as in the case of @xmath186 term discussed above , the replica cvm predicts a _ qualitatively _ different behaviour than the bethe approximation . the low - temperature specific - heat behaviour has not been considered in the case of the bethe lattice",
    "; nevertheless it is known that the bethe approximation yields a spurious phase transition with non - zero symmetry - breaking fields @xmath89 concentrated over the integers . in the case of odd connectivities ( corresponding _ e.g.",
    "_  to the hexagonal lattice ) this leads naturally to a @xmath213 gap , instead in the case of even connectivities ( corresponding to the square and triangular lattices ) the fields are known to concentrate over _ odd _ integers values leading to @xmath215 , while as we saw the use of the cvm approximation reduces the gap and leads to @xmath213 for all the three 2d model considered .",
    "a typical application of the cvm @xcite is the location of the critical temperature of phase transitions .",
    "we recall that in the plaquette approximation above the critical temperature the small fields @xmath89 vanish , _",
    "i.e. _  we have : @xmath224 a spin - glass phase transition corresponds to the fact that the symmetry - breaking fields @xmath89 become non - zero .",
    "near the critical temperature of a second - order phase transition the symmetry - breaking fields @xmath89 will be no longer zero but small , and we will determine the location of the critical temperature considering the second moments of the distributions .",
    "we define : @xmath225 for symmetry reason we expect @xmath226 thus @xmath227 , furthermore @xmath228 and @xmath227 will be even function of @xmath219 , while @xmath229 will be an odd function of @xmath219 .    now to explain the basics of the method we consider the simplest case of the bethe approximation in which only the function @xmath127 is present . in this case",
    "the transition is marked by the fact that the parameter @xmath218 defined above vanishes above the critical temperature while it is different from zero below .",
    "to determine the critical temperature one expands the iterative equation at small @xmath218 and obtain something of the form : @xmath230 the critical temperature corresponds to the vanishing of the coefficient @xmath231 , or equivalently to the fact that the homogeneous linear equation @xmath232 admits a non - zero solution .",
    "the condition @xmath233 leads to the equation @xmath234 in the bethe approximation where @xmath235 is the connectivity of the model .",
    "we note that below the critical temperature the function @xmath127 is also described by higher order moments , however to determine exactly the critical temperature it is sufficient to consider the behavior of the second moment @xmath218 .",
    "we have obtained the corresponding linear homogeneous equation for the variables @xmath236 in the form : @xmath237 where the various coefficients @xmath0 depends on the temperature and on the corresponding function @xmath134 , we do not report them all but in the following we will explain how they have to be obtained .",
    "the critical temperature should be identified with the point where the above homogeneous set of equations admits a non - zero solution for the parameters @xmath238 .",
    "the corresponding eigenvector determines the behavior of the function @xmath127 and @xmath128 slightly below the critical temperature .    to see how the coefficients @xmath0 have to be obtained we consider the equation for the parameter @xmath218 .",
    "we start from the equation for @xmath127 , eq . ( [ arghat ] ) , we multiply both sides times @xmath239 and integrate over @xmath89 .",
    "we have : @xmath240 where the function @xmath117 is defined in eq .",
    "( [ arghat ] ) .",
    "now we expand the function @xmath117 at the second order in powers of the small fields @xmath89 , and express the integrals in eq .",
    "( [ a ] ) in terms of @xmath218 , @xmath228 and @xmath241 , the result is : @xmath242 the above equation corresponds to eq .",
    "( [ nuc1 ] ) .",
    "the other coefficients can be obtained similarly multiplying both sides of the equation for @xmath128 ( _ i.e. _  eqs .",
    "( [ lhs ] ) and ( [ rhs ] ) ) times @xmath243 and @xmath244 and integrating over .",
    "the resulting expressions are fairly complicated and we do not write them down here .",
    "a complete analytical treatment of the problem seems unfeasible , also because we do not have an analytical expression of @xmath134 at all temperatures .",
    "thus we have discretized the space of the @xmath219 , assuming that it can takes only a finite number @xmath245 of values in the interval @xmath246 , _",
    "i.e. _  @xmath247 with @xmath248 and @xmath249 .",
    "correspondingly we have a set of @xmath250 variables @xmath251 . at any temperature",
    "we first compute @xmath134 on the discretized range of @xmath219 and then we rewrite the set of equation ( [ nuc1],[nuc2],[nuc3 ] ) in the form @xmath252 where @xmath253 is a @xmath254 matrix , ( in the following we will refer to it as the jacobian matrix ) .",
    "the computation of the coefficients is the technical bottleneck of the computation , we have worked typically with @xmath255 and @xmath256 .",
    "the jacobian matrix is diagonalized and the critical temperature have to be identified with the point where it has a vanishing eigenvalue or correspondingly a vanishing determinant .",
    "note that we are linearizing the equations and therefore we call _ jacobian _ the matrix that we compute , as a consequence this matrix is not symmetric and can have complex eigenvalues .",
    "a symmetric matrix would be obtained had we considered the hessian of the free energy .",
    "however as far as the determination of the critical temperature is concerned the two approaches are completely equivalent .",
    "we have considered the 2dea ising model with couplings @xmath138 on the square lattice .",
    "interestingly enough _ the plaquette approximation predicts no spurious spin - glass phase transition at any finite temperature_. in other words the determinant of the jacobian remains always finite , this has to be compared with the bethe approximation that yields a spurious spin - glass transition at @xmath154 for the 2dea model with @xmath138 . in fig .",
    "[ figdetj2d ] we plot the inverse of the logarithm of the determinant of the jacobian at low temperatures .",
    "this was obtained using @xmath257 and @xmath258 therefore the jacobian is a @xmath259 matrix .",
    "the plot shows that the determinant does not vanish at least down to @xmath260 and suggest that it does not vanish at any finite temperature . a careful study of its behavior as @xmath261 goes beyond the scope of this work .",
    "a similar study on the 2dea ising model with couplings @xmath138 on the triangular lattice shows that instead the jacobian vanishes at @xmath2 that improves considerably on the bethe lattice estimate @xmath262 .",
    "it is interesting to note that also in the 2d triangular antiferromagnet ( which has again a zero temperature critical point ) the cvm approximations yields a spurious phase transition @xcite .",
    "the plaquette approximation can be also applied to regular lattices in any number of dimensions .",
    "the objects to be considered are still the messages functions @xmath127 and @xmath128 but the coefficients @xmath189 of the regions and the total number of regions changes .",
    "for instance in @xmath145 we have @xmath263 , @xmath264 and @xmath265 while the number of regions per spin are @xmath266 , @xmath267 , @xmath268 .",
    "the total number of messages entering in a given region also changes , in particular in generic dimension @xmath66 there are @xmath195 messages @xmath127 entering on the point ; on the couple of points there are @xmath269 messages @xmath128 and @xmath270 messages @xmath127 for each point , while on the plaquette there are @xmath271 messages @xmath128 on each link and @xmath269 messages @xmath127 on each point .",
    "the above formalism for the study of a second - order phase transition can be extended straightforwardly to general dimension provided some care is taken in order for the computation of the jacobian matrix to be done in reasonable time . in practice we have introduced auxiliary functions to represents the convolutions of @xmath134 with itself in order that the integrals needed to compute the elements of the jacobian remain three - dimensional as in 2d .    in dimension",
    "higher than two the ea model is largely believed to display a second - order spin - glass phase transition . in fig .",
    "[ figlam3d ] we plot the value of the smallest eigenvalue of the jacobian matrix of the 3dea ising model .",
    "we see that unfortunately it does not vanish at all , although it decreases considerably around the temperature where the actual model is believed to have a phase transition , @xmath272 .",
    "the plaquette approximation leads to a disaster in 3d : if we did not know the actual behavior of the model we could wrongly think that much as in 2d the paramagnetic phase is stable down to zero temperature ; however a clear hint that this can not be the case comes from the study of the free energy . in fig .",
    "[ figft3d ] we plot the free energy as a function of the temperature , this shows that the entropy remains positive but the free energy has the wrong convexity at low temperature and negative specific heat . another indication that the paramagnetic solution is wrong in 3d at low temperature comes from the fact that at zero temperature the solution does not converge on integers values , at variance with the 2d case studied in the previous section .",
    "we have also considered different distributions of the couplings ( gaussian and diluted ) and check that unfortunately the plaquette approximation still does not predict any phase transition in @xmath145 .",
    "the present approach is able to detect a second - order phase transition where the variables @xmath238 are small , it is also possible that the plaquette approximation makes the transition first - order but we leave the investigation of this point for future work .",
    "note that the smallest eigenvalue gets very near to zero therefore we expect that in an approximation with a basic region slightly larger than the plaquette we should be able to recover the expected phase transition .",
    "fortunately enough , the situation gets better in dimension four ( see fig .",
    "[ figlam4d ] ) where the smallest eigenvalues vanishes at @xmath273 , thus correcting around @xmath274 of the error of the bethe estimate @xmath275 of the actual value of the critical temperature @xmath276 estimated numerically @xcite . increasing the dimension the quality of the results improves systematically , in @xmath277 we have @xmath278 to be compared with high - temperature series estimates @xmath279 @xcite and @xmath280 @xcite , thus correcting almost all the error of the bethe approximation estimate @xmath281 .",
    "it is interesting to observe that according to fig .",
    "( [ figlam4d ] ) the smallest eigenvalue in dimension four of the paramagnetic solution vanishes again lowering the temperature below @xmath273 at around @xmath282 , we will discuss this unexpected feature of the solution at the end of the present section .",
    "we have seen that the plaquette approximation gives good results in @xmath195 and in general dimension greater than three , while in @xmath145 it leads to a disaster at low temperature .",
    "we note that the bethe approximation is correct at @xmath283 and at @xmath284 , thus it is natural that the plaquette approximation is a perturbative correction to bethe in high enough dimension as can be seen already in dimension five .",
    "looking at the behavior of the smallest eigenvalue of the jacobian matrix in @xmath285 we see that , although it does not vanish , it has a minimum around the true critical temperature @xmath286 and it is likely that the second - order phase transition reappears considering a basic region larger than the plaquette , _",
    "e.g. _  the cube .",
    "we note however that this approximation requires to deal with equations for the order parameters involving convolutions _ even _ in the rs paramagnetic phase , a technical difficulty that is not present for the plaquette .",
    "the study of the spin - glass phase requires to deal with non - zero fields @xmath287 and to deal with the convolutions appearing in eq .",
    "( [ lhs ] ) .",
    "thus the study of the spin - glass phase requires to tackle this technical difficulty and goes beyond the scope of this work .",
    "nevertheless the study of the jacobian gives us a _ crucial _ information on the spin - glass phase that we will discuss in the following .    slightly below the critical temperature in @xmath288",
    "the quantities @xmath238 are proportional to the vanishing eigenvector of the jacobian matrix . in other words we have : @xmath289 where @xmath290 are the components of the eigenvector corresponding to the zero eigenvalue and @xmath291 is some numerical constant that can not be determined solely from the knowledge of the jacobian but needs the computation of the quadratic terms .",
    "indeed the determination of the proportionality factor requires to include the next order terms analogous to the term @xmath292 in eq .",
    "( [ jacbethe ] ) at the bethe level . in fig .",
    "[ figa11 ] we plot the function @xmath293 ( modulo an unknown positive constant scaling as @xmath294 , _",
    "i.e. _  the non - normalized eigenvector ) at a generic temperature slightly below @xmath295 for the 4dea with bimodal interactions , the proportionality factor is such that the @xmath218 component is positive , @xmath296 .",
    "we see that @xmath293 is negative for some values of @xmath219 and this is puzzling , indeed we recall that the definition of @xmath293 is : @xmath297 thus if @xmath293 is negative below the critical temperature for some @xmath219 it follows that _ the message function @xmath128 can not be positive definite ! _",
    "the first consequence of this fact is that the function @xmath128 can not be interpreted as a distribution function of the messages @xmath298 on a given sample : had we followed that interpretation we should have concluded that the whole approach is inconsistent . in the next section",
    "we will discuss this issue in more depth and see that instead it is the naive interpretation that is actually inconsistent , in particular we will show that the message functions @xmath128 need not to be positive definite while the beliefs of the regions do .",
    "we mention that negative @xmath293 are found also if we study the response of the system to the presence of a small field @xmath299 in the high - temperature phase . in this case",
    "we find non - zero values of @xmath238 of order @xmath300 that can be determined inverting the jacobian matrix and applying it to the @xmath300 perturbation , and again we find that while @xmath218 is positive @xmath293 is negative for some values of @xmath219 .",
    "this effect survives in the infinite temperature limit . in this regime",
    "we find that at leading order the variables to be considered are @xmath218 and @xmath301 and an explicit computation shows that @xmath302 and @xmath303 in any dimension .",
    "we note that the fact that the messages are not positive definite means that they can not be simply represented as populations and this , together with the presence of convolutions in the variational equations , is a technical challenge to be overcome in order to obtain quantitative results for general cvm approximations and for all regions of the phase diagram .",
    "we also mention that the jacobian approach presented here can be also applied to study the phase diagram of models with ferromagnetically biased interactions , in this case one would be interest in the location of the ferromagnetic transition and the variables to be used should be @xmath304 and @xmath305 .",
    "we end this section with a comment on the peculiar feature displayed by the smallest eigenvalue of the jacobian in four dimension according to fig .",
    "( [ figlam4d ] ) .",
    "below @xmath273 we expect to find a rs spin - glass solution with a non - zero positive value of @xmath306 .",
    "as we already said the actual value of the proportionality factor can not be determined solely from the knowledge of the jacobian but needs the computation of the quadratic terms .",
    "however if we assume that these terms do not change too much with the temperature between the @xmath273 and @xmath282 ( _ i.e. _ where the eigenvalue vanishes again ) we easily see that the parameter @xmath218 should have the opposite behaviour of the smallest eigenvalue",
    ". in particular , lowering the temperature , it will initially increase from zero to some maximum and then decrease again to zero .",
    "this would be completely unphysical and means that probably to rs spin - glass solution becomes meaningless and has to be abandoned below some temperature greater that @xmath307 where the smallest eigenvalue reaches its minimum .",
    "it is tempting to interprete this fact as an indication that the rs spin - glass solution is physically wrong at low temperature and that a rsb solution has to be considered instead .",
    "one can further speculate that if this is the case two phenomena should be observed .",
    "first the effect should become more pronounced while increasing the size of the basic cvm region .",
    "in other words increasing the precision of the cvm approximation the region of validity of the rs spin - glass solution should shrink to zero _ i.e. _ the first two zeroes of the smallest eigenvalue should tend to coincide .",
    "second for a given cvm approximation the use of a rsb solution should increase the range of validity of the solution shifting the point where the solution becomes unphysical to lower temperatures .",
    "we think that this is a very interesting open problem .",
    "in the previous section we have seen that the messages functions @xmath128 of the plaquette cvm approximation in general dimension are not definite positive and can not be interpreted as distribution functions . in this section we will obtain the physical interpretations of the beliefs of @xmath308 of the regions of the replicated model . in particular we will show that the beliefs in the rs approximation can be interpreted as distributions over the disorder of the local hamiltonians .",
    "we consider first the belief of a point on the lattice , say @xmath309 . in the @xmath1-replicated system",
    "there are @xmath1 spins @xmath310 on that point .",
    "as we saw in section [ thereplicaapproach ] averaging over the disorder couples the different replicas and the effective hamiltonian becomes @xmath311\\rangle$ ] .",
    "the belief @xmath312 describes the marginal distribution of the replicated spins at point @xmath309 with respect to the replica hamiltonian .",
    "any correlation between any number @xmath313 of the @xmath1 spins at site @xmath309 can be expressed in terms of @xmath312 @xmath314 where @xmath315 means average with respect to the replicated hamiltonian . on the other hand",
    "such a correlation can be written as : @xmath316 where @xmath317 means average over the disorder , @xmath318 is the partition function of the non - replicated system for a given realization of the disorder @xmath6 , @xmath319 means thermodynamic average at given disorder @xmath6 and @xmath320 is the magnetization at site @xmath309 of the non - replicated system with a given disorder realization @xmath6 . the equality between the second and the third term follows from putting the disorder average outside the sum over the configurations of the replicated system and thus recovering the independence of the different replicas prior to the averaging .",
    "the above equations tells us that the correlation between @xmath313 replicated spins at the same site @xmath309 is equal to the average with respect of the disorder of the @xmath313 moment of the magnetization at site @xmath309 of the non - replicated system .",
    "note that each disorder realization is weighted with a weight proportional to the partition function to the power @xmath1 .",
    "in particular when @xmath9 we recover the standard white average over the disorder while for non - zero @xmath1 we are selecting samples with free energy different from the typical one @xcite .",
    "according to section [ rsbparametrization ] the rs parametrization of the belief @xmath312 is obtained through a function @xmath321 ( the same for each site ) in the form : @xmath322 now using eq .",
    "( [ corrbel ] ) and ( [ corrbel2 ] ) we finally arrive at the following equation : @xmath323 the above equation encodes the physical meaning of the belief function @xmath321 . on a given sample @xmath6 the magnetization @xmath320 of site @xmath309 is determined by an effective field @xmath324 on site @xmath309 generated by the rest of the system . since the above equation is valid for any @xmath313 it follows that _ the function @xmath321 is the distribution over the different samples of the effective field acting on a given site_.    the same interpretation can be obtained for the belief of the couple of points and for the plaquette . on a given sample",
    "the effect of the rest of the system on a couple of spins @xmath325 and @xmath326 generates an effective local hamiltonian of the form @xmath327 that determines completely the magnetizations and correlation of the two spin ; the belief function of the couple of points @xmath328 is the distribution over the different samples of the effective local hamiltonian .",
    "the cvm approach ( in particular eq .",
    "( [ belief ] ) ) tells us that the distributions @xmath321 and @xmath328 can be expressed in terms of the message functions @xmath127 and @xmath128 in the following way ( we specialize as before to the 2dea model on the regular lattice ) : @xmath329\\delta(u-(u_1+u_2+u_3+u_4 ) ) \\label{ppunto}\\ ] ] and @xmath330\\prod_{i=1}^3[q(v_i)dv_i ] \\prod_{a = up , down}[q(u_a , u_a , v_a)du_adu_adv_a]p(j)dj\\ ,   \\times   \\nonumber \\\\   & \\times &   \\delta(u-(u_{up}+u_{down}+j))\\,\\delta\\left(u_1-(\\sum_{i=1}^3     u_i+u_{up}+u_{down})\\right)\\,\\delta\\left(u_2-(\\sum_{i=1}^3     v_i+v_{up}+v_{down})\\right )   \\label{pcoppia}\\end{aligned}\\ ] ] in the bethe approximation the message function @xmath127 can be interpreted as the disorder distribution of the effective field @xmath89 on a given spin @xmath185 with connectivity @xmath331 when @xmath332 links connected to it are removed .",
    "this is a peculiar feature of the bethe approximation but in general the message functions do not admit an interpretation as distributions as the one derived above .",
    "indeed , as we have seen in the previous section , they are not positive definite in general .",
    "on the other hand it can be argued that the distribution @xmath333 of the effective hamiltonian of a couple of points in the absence of the link connecting them obeys the equation : @xmath334 and therefore @xmath333 is equal to ( [ pcoppia ] ) without the integration over @xmath335 : @xmath336 \\prod_{i=1}^3[q(v_i)dv_i]\\prod_{a = up , down}[q(u_a , u_a , v_a)du_adu_adv_a]\\ , \\times   \\nonumber \\\\   & \\times & \\delta(u-(u_{up}+u_{down}))\\ ,   \\delta\\left(u_1-(\\sum_{i=1}^3     u_i+u_{up}+u_{down})\\right)\\,\\delta\\left(u_2-(\\sum_{i=1}^3     v_i+v_{up}+v_{down})\\right )   \\label{pnoj}\\end{aligned}\\ ] ] a similar expression can be obtained for the distribution of the effective hamiltonian of the plaquette without the links inside it .",
    "we note that the distribution @xmath333 allows a straightforward computation of the local energy through the following expression that can be also ( consistently ) obtained in way similar to eq .",
    "( [ fund ] ) deriving explicitly the replicated free energy .",
    "@xmath337 from eqs .",
    "( [ ppunto ] ) and ( [ pcoppia ] ) we see that the message functions @xmath128 and @xmath127 need not to be positive definite but they must be such that @xmath321,@xmath328 and @xmath333 are .",
    "we will check that this is indeed the case in the following . in the last section",
    "we have argued that at the critical temperature of the spin - glass phase transition the fields @xmath89 are small and at first order in @xmath338 the message functions are described by the variables @xmath238 that represent the average of the second moments of the fields , see eq .",
    "( [ eqa ] ) and ( [ eqa1122 ] ) .",
    "consistently we noted that these variables are proportional to the eigenvector with zero eigenvalue of the jacobian matrix and checked that the eigenvector ( and thus @xmath238 ) is such that the function @xmath128 can not be positive definite , see fig .",
    "[ figa11 ] . in the following we consider the similar quantities for @xmath328 near the critical temperature : @xmath339",
    "@xmath340 given that @xmath328 _ is _ a distribution we must find @xmath341 and @xmath342 for all @xmath219 . on the other hand from eq .",
    "( [ pcoppia ] ) we see that @xmath343 and @xmath344 can be obtained from @xmath238 through a linear transformation , again modulo an unknown positive constant that scales as @xmath294 . in fig .",
    "[ figq11 ] and [ figdq2 ] we plot @xmath343 and @xmath345 for the 4dea model with bimodal interactions slightly below the critical temperature , they were obtained through a linear transformation from the corresponding @xmath238 , ( @xmath293 is shown in fig .",
    "[ figa11 ] ) .",
    "consistently we see that unlike @xmath293 , both @xmath343 and @xmath345 are positive for all @xmath219 as they should .",
    "one can check that similar quantities corresponding to @xmath333 or the plaquette are also compatible with the general fact that the beliefs have to be interpreted as a distribution functions over the disorder of the local effective hamiltonians .    in the previous section we noticed that interpreting the message function @xmath128 as a distribution of the messages @xmath298 on a given instance is wrong and misleading .",
    "we have seen why it is misleading : had we interpreted in that way we would have look for a solution in the spin - glass phase with strictly positive @xmath293 while the true @xmath293 is negative form some values of @xmath219 .",
    "we conclude this section providing some arguments to show that it is inconsistent .",
    "consider the function for the belief of the single point eq .",
    "( [ ppunto ] ) .",
    "can we interpreter it as saying that @xmath127 describes the distribution of the messages @xmath346 on a given realization of the disorder ?",
    "the answer is no because it would lead to conclude that these messages are spatially uncorrelated .",
    "this is true in the bethe approximation but not in the plaquette approximation , for instance the messages coming from the direction north and west come from regions that are both contained in the nw plaquette and can not be uncorrelated .",
    "furthermore we may notice that this equation remains the same if we consider the cvm approximation in which the basic region is a generic @xmath347 plaquette . once again",
    "on a given instance we would have four messages entering on a point but when we average over different samples these messages are correlated : thus it is crucial to understand that the function @xmath127 has nothing to do with the distribution of the messages on a single sample .",
    "actually the messages are auxiliary objects of the approach while the true physical objects are the beliefs .",
    "similarly looking at the equation for the beliefs of the couple of points eq .",
    "( [ pcoppia ] ) we see that if we interpreted @xmath128 as the distribution over different samples of the messages fields @xmath298 and @xmath127 as that of @xmath89 , we should have concluded that the corresponding messages are spatially uncorrelated and again we see that this is in contrast with the key cvm assumption that objects in the same basic region ( the plaquette ) are correlated .    finally if we go back to the definition of the messages functions we see that a generic message @xmath348 in terms of replicated spins must be positive function , instead the corresponding function @xmath128 is some kind of integral transform of @xmath348 and need not to be positive .",
    "we are now in position to discuss the relationship between the replica cvm approach and the earlier results of the tohoku group @xcite . in 1980",
    "katsura , fujiki and nagahara were the first to apply cvm ideas to spin - glasses and studied the phase diagrams of various models .",
    "they started from the cvm message - passing equations on a given sample and introduced the functions @xmath127 and @xmath128 intended to be the sample - to - sample distributions of the messages ( actually they wrote @xmath349 ) . as we discussed in section [ plaquette ] , these assumptions lead to the same set of equations for @xmath127 and @xmath128 that we have obtained through replica cvm at the rs level . however , even if the equations are the same , the starting assumptions are inconsistent and in the end the actual solutions @xmath127 and @xmath128 turn out not to be distributions .",
    "thus we think that in general replica cvm provides a more satisfactory and consistent derivation of the rs cvm equations obtained nearly thirty years ago by the tohoku group .",
    "most importantly the equations follow from a variational principle and can be generalized to include rsb .",
    "actually katsura _ et al .",
    "_  did not write down the full set of equations ( [ plav1],[lhs],[rhs ] ) but studied the paramagnetic solution in various models and considered the location of a second - order spin - glass phase transition .",
    "they solved equation ( [ paraqu ] ) approximating @xmath134 as a couple of delta functions , then in order to locate the transition temperature they studied the jacobian under the assumption that @xmath349 .",
    "this assumption is inconsistent with the equation for @xmath128 that does not admit a factorized solution but simplifies the computation of the jacobian because one has to deal with just two variables @xmath350 and @xmath351 compared to the full set of variables @xmath238 of the exact plaquette cvm . as expected their results are less precise than ours , for instance they obtained a spurious spin - glass phase transition on the 2dea on the square lattice while remarkably we find no second - order phase transition . on the other hand",
    "their treatment allows to obtain an analytical expression of the jacobian and of the phase diagrams and they could apply it to various models .",
    "the replica cvm can be used in principle to study the phase diagram of a wide range of disordered systems and it is also possible that it can be used to get quantitative predictions on single samples .",
    "however there are quantitative and qualitative technical differences with respect to standard cvm ( and the gbp algorithm ) , to the bethe approximation and to sp that represent a great challenge .",
    "in particular , integrals in many dimension , convolutions and message functions that are not positive definite conjure to make applications extremely difficult beyond the simplest cvm approximations and smallest number of rsb .    besides these technical difficulties the results of the second part of the paper show that , at least in the averaged case , the method yields sound results .",
    "this is not at all trivial given the frustrated nature of the model and the tricky continuation in replica number .    in many respects",
    "the method shares the same advantages and weak points of standard cvm .",
    "it is a good tool to obtain quantitative non - perturbative estimates in actual models and to characterize phase diagrams , _",
    "e.g. _  the stability of the paramagnetic phase down to zero temperature in 2d spin - glass models is a remarkable result and we already mentioned that the jacobian approach can be straightforwardly applied to study the ferromagnetic transition in @xmath195 ea models with ferromagnetically biased interactions .",
    "thus the method improves over perturbative schemes , say the @xmath352 expansion that on the other hand are more tractable in order to get qualitative results on systems with full - rsb @xcite .    on the other hand a standard cvm approximation",
    "is not guaranteed to be an upper bound to the true free energy and like many non - perturbative approximations can possibly give inconsistent results , in this respect we note that the plots of the free energy suggest that a good sequence of replica cvm approximations of increasing precision should approach the true free energy from below and not from above as in standard cvm .",
    "this appears to be a consequence of the replica trick much as the fact that parisi formula for the sk model has to be maximized and not minimized in order to determine the free energy @xcite .",
    "another drawback is that cvm is intrinsically a mean - field approximation . as such it will always predict mean - field critical exponents",
    "although in principle information on the true critical exponent can be obtained @xcite _ e.g. _  comparing approximations with maximal regions of increasing size . however the problem of going beyond mean - field theory ( _ i.e. _  using the loop expansion in replica field theory ) is way more important than to build more precise mean - field approximations like those yielded by replica cvm .",
    "this said quantitative estimates can be rather useful to help solve long - standing problems in spin - glass theory .",
    "for instance an estimate of the actual location of the de almeida - thouless line @xcite in finite dimensional models is highly desirable .",
    "the next step beyond the applications presented here should be the rs treatment of the spin - glass phase of the ea model in the plaquette approximation , at least in @xmath288 .",
    "this include the extension to finite small @xmath1 that can be seen as a first simplified version of 1rsb ( the so - called factorized solution ) . on the bethe lattice @xcite",
    "this improves considerably the rs result and differs little from the more precise 1rsb solution @xcite",
    ". a similar considerable improvement of the factorized solution with respect to the rs one also in the plaquette approximation , if observed , would constitute non - trivial evidence supporting the rsb nature of the spin - glass phase in finite - dimensional models below the upper critical dimension @xmath353 .",
    "a way to reduce the technical complexity of the exact replica cvm equations is to use the variational expression , eqs .",
    "( [ varf ] ) and ( [ e38 ] ) , of the free energy parametrizing the messages functions in a simplified way and solving the corresponding variational equations that will be different from the exact equations ( [ iteave1],[iteave2 ] ) and ( [ itesamp1],[itesamp2 ] ) .",
    "the number of possible parametrizations is virtually infinite , for instance it should be noted that in high - dimension the plaquette approximation can be considered a perturbative correction to the bethe approximation and the rs function @xmath128 is peaked at small values of all its arguments . therefore in that regime",
    "it is consistent to parametrize @xmath128 with few of its moments while considering the full @xmath127 , the application of this ansatz to finite dimension would be non - perturbative but could give consistent results .",
    "a different possibility is to assume that in the whole low - temperature phase , not only near @xmath132 , the small fields distributions are essentially parametrized by their second moments , this amounts to consider as variables the functions @xmath134 and the parameters @xmath238 introduced in section [ sgtran ] . to obtain the variational equations of this ansatz we should parametrize the distribution of the fields @xmath298 as delta functions plus second derivatives of delta functions , such that all moments of order higher than two vanish .",
    "the main reason to look for tractable replica cvm approximations beyond the bethe approximation is that one could then try to apply them on single samples in the spirit of the sp algorithm . on the other hand",
    "if one is just interested in the averaged properties it may be useful to consider also tree - like approximation with regions of increasing size . being tree - like they are free of the convolutions and negative message functions problems , _",
    "i.e. _  fully treatable with population dynamic algorithms .",
    "therefore although they will be less precise than cvm approximations larger regions could be treated and extrapolation to the actual finite dimensional model achieved .",
    "we thank i. nishimori , y. kabashima , j. poulter and a. pelizzola for useful comments on the first version of this work .",
    "a. lage and r. mulet thank the hospitality of i.s.i . during the completion of this work .",
    "a. lage also acknowledges support by the ec - funded strep gennetec ( `` genetics networks : emergence and copmlexity '' )",
    "in this appendix we present the hierarchical ansatz for the replicated cvm in full generality . in particular we will consider : i ) a general cvm approximation , ii ) a general number of rsb steps , iii ) both the single sample and averaged cases . in appendix [ gsp ] the variational equations and",
    "the variational free energy will be derived .    in section [ cvmmp ]",
    "we have written the free energy in terms of messages that are positive functions of the configurations @xmath22 of the variables in region @xmath16 . in the following",
    "we will parametrize the messages in order to be able to take the analytical continuation to real @xmath1 , the rsb parametrization requires the introduction of a set of @xmath0 rsb parameters @xmath354 that are numbers .",
    "unfortunately at this stage the standard notations of the message - passing formulation of cvm @xcite and of rsb @xcite overlaps and the reader should not confuse the rsb parameter @xmath355 ( that are numbers ) with the @xmath22 defined previously ( that specifies distinct configurations of the variable nodes in region @xmath16 ) . however from now on we will concentrate on the edwards - anderson model defined above , therefore the nodes are ising spins , _ e.g. _  for the region comprising spin @xmath218 and @xmath291",
    "we have @xmath356 if the system is not replicated and @xmath357 if the system is replicated @xmath1 times , such that at each site , say @xmath218 , we have @xmath1 spins @xmath358 .    the general rs and rsb ansatz of a function @xmath104 of @xmath1 spins was originally presented in @xcite , later its parametrization in terms of distributions of fields was suggested in @xcite and later revisited in @xcite , and we refer to those paper for an explanation of the main ideas underlying it . here",
    "we generalize it to a generic function @xmath105 where each @xmath106 is a set of @xmath1 ising spins .",
    "we start introducing the field @xmath219 that parametrize a probability distribution of @xmath313 ising spins , in the following we call it a @xmath313-field .",
    "@xmath219 is a set of @xmath359 real numbers @xmath360 where @xmath361 is an index that labels all the subsets of the set of indices @xmath362 , ( the empty set is excluded ) .",
    "we have then : @xmath363   \\label{uf}\\ ] ] where @xmath364 is a normalization constant .",
    "we define a probability distribution ( population ) @xmath365 of such fields a @xmath309-distribution , correspondingly a @xmath366-distribution is a probability distribution on probability distributions ( population of populations ) and so on . a @xmath147-distribution will be written as @xmath367 and it defines a measure @xmath368 over the space of @xmath369-distributions .    in order to parametrize the function @xmath105 with @xmath0 steps of rsb",
    "we need :    * a @xmath0-distribution @xmath370 of the fields @xmath219 ; * @xmath0 integers @xmath354 ( for @xmath371 they become real and the inequalities change sign ) ;    in the following we will consider the parameters @xmath372 fixed and consider just the dependency on the distributions .",
    "the construction is iterative and requires a set of functions @xmath373 where _ each @xmath106 is a set of @xmath374 spins _ with @xmath375 ( we define @xmath376 and @xmath377 ) .",
    "the normalization of @xmath378 is crucial , we choose to normalize all of them to @xmath366 .",
    "we define @xmath373 starting from @xmath379 first dividing all the @xmath380 spins in @xmath381 groups @xmath382 of @xmath383 spins labeled by an index @xmath384 .",
    "then we have : @xmath385 thus @xmath386 is defined iteratively starting from the replica - symmetric case corresponding to @xmath387 : @xmath388 we will parametrize each message @xmath389 through a population @xmath390 over a @xmath313-field where @xmath313 is the number of sites in region @xmath28 .",
    "the populations associated to the tilded messages @xmath391 defined in eq .",
    "( [ tm ] ) will be represented by @xmath392 .",
    "note that at integer values of @xmath1 , the above parametrization is redundant , and in principle we can not determine the population knowing the messages .",
    "it is standard in the replica method to assume instead that this step can be performed due to the continuation to real values of @xmath1 .    in the end",
    "we will write down the message - passing equations in terms of the message populations and thus we will be able to consider non - integer values of @xmath1 , and in particular the limit @xmath393 . we will also obtain a variational expression of the free energy in terms of the message populations .",
    "we note that in principle one could parametrize the beliefs with populations and obtain an expression of kikuchi free energy in terms of these populations .",
    "the resulting expression however is extremely complicated due to the presence of the entropic terms in the form @xmath394 , see _ e.g. _",
    "@xcite where the entropy of the point belief was computed .",
    "the main reason why we derived the variational expression ( [ varf ] ) in terms of the messages is precisely because it avoids to deal with terms of the form @xmath394 .",
    "the r.h.s . of the rescaled iteration equation ( [ tm1 ] ) defines a function @xmath395 of the messages in @xmath396 .",
    "now since the messages are parametrized by @xmath0-populations , we need to determine the corresponding function @xmath397 that yields a @xmath0-population as a function of the @xmath0-populations of the messages , such that the iteration equation translates into @xmath398 .",
    "we start introducing two @xmath6-dependent functions @xmath399 and @xmath400 such that the following equation is satisfied : @xmath401 we use bold face for indicating functions of messages , but we stress that while @xmath402 returns a normalized probability on spins in region @xmath28 , the function @xmath400 returns a number which is precisely the normalization required by equation ( [ genj ] ) .",
    "this equation can be written in terms of populations and defines a @xmath0-population @xmath403 as a function of the @xmath0-populations in @xmath45 .",
    "it turns out that the function @xmath403 can be defined in terms of the function @xmath404 that in turn can be defined through the function @xmath405 and so on .",
    "the resulting expression for a given @xmath147 is : @xmath406^{x_{k+1}/x_k } \\delta ( \\tilde{p}^{(k-1)}_{rs}-\\tilde{{\\bf p}}^{(k-1)}_{j , rs } )   \\label{defp}\\ ] ] where @xmath407 is a number that is a function of the @xmath147-populations @xmath408 in @xmath45 defined according to : @xmath409^{x_{k+1}/x_k } \\ .",
    "\\label{defn}\\ ] ] in the cavity formulation at the bethe level @xcite the quantities @xmath410 are associated to ( cluster ) free energy shifts and they appear in ( [ defp ] ) as reweighting terms . at the bethe level ,",
    "explicit expressions like ( [ defp ] ) for any @xmath147 value have been already reported in ref .",
    "@xcite .",
    "the iterative definition must be supplemented with the two functions for @xmath387 and @xmath411 .",
    "they reads : @xmath412^{x_1 } \\delta ( \\tilde{u}_{rs}-\\tilde{{\\bf      u}}_{j , rs } )   \\label{defp0}\\ ] ] and @xmath413^{x_{1 } }    \\label{defn0}\\ ] ] for @xmath414 this yields the replica - symmetric solution , note that in this case in the @xmath9 limit the reweighting term goes to @xmath366 and is irrelevant . in the above equations @xmath415 and @xmath416 are functions of the fields @xmath417 that have to be obtained solving the following single - replica equation : @xmath418 note that it is only at this stage that the actual properties of the model enter",
    "this complete the recursive definition of the function @xmath419 and @xmath420that solve equation ( [ genj ] ) at any level of @xmath147-rsb , we will not write down the proof of this statement that can be worked out iteratively generalizing a similar derivation in the bethe approximation @xcite .",
    "it is important to stress that this iterative definition is possible only if we do not average over the disorder , a passage that will be taken in the next section .    up to now",
    "we have expressed eq .",
    "( [ tm1 ] ) in terms of populations in such a way that the @xmath9 limit can be taken , in the following we consider the similar treatment for eq . ( [ tm ] ) .",
    "note the basic differences between eq .",
    "( [ tm ] ) and ( [ tm1 ] ) : the absence of the summation over the spins in region @xmath37 and the fact that we consider messages in @xmath39 and not in @xmath45 .",
    "much as above , the function @xmath421 corresponding to the r.h.s . of eq .",
    "( [ tm ] ) can be defined in an recursive way , the result being : @xmath422^{x_{k+1}/x_k } \\delta ( \\tilde{p}^{(k-1)}_{rs}-\\tilde{{\\bf q}}^{(k-1)}_{rs } )   \\label{defq}\\ ] ] where @xmath423 is defined as : @xmath424^{x_{k+1}/x_k } \\ .",
    "\\label{defm}\\ ] ] as before the previous iterative definition is completed specifying the two function at the replica - symmetric level corresponding to @xmath387 : @xmath425^{x_1 } \\delta ( \\tilde{u}_{rs}-\\tilde{{\\bf      q}}_{rs}^{(-1 ) } )   \\label{defq0}\\ ] ] and @xmath426^{x_{1 } } \\ .",
    "\\label{defm0}\\ ] ] for @xmath414 this gives back the replica - symmetric solution , note that in this case in the @xmath9 limit the reweighting term goes to @xmath366 .",
    "the two quantities @xmath427 and @xmath428 have the following form that does not depend on the hamiltonian of the problem : @xmath429 the above sum is intended in vectorial form , _",
    "i.e. _  for each possible combination of the spins in region @xmath28",
    "( @xmath430,@xmath431,@xmath432  ) we sum the corresponding fields .",
    "the normalization factor can be written as the product of terms depending on each message separately times a term depending on the sum of the fields : @xmath433 the above properties have important consequences and allow to introduce fourier - like transforms in order to write down the equations for the messages in explicit form , see appendix [ inversion ] .",
    "we are now in position to write the variational equations ( [ yedmessage ] ) in terms of @xmath0-populations .",
    "we start noticing that in the averaged case eq . ( [ tm1 ] ) can be written as : @xmath434 where @xmath435 is a normalization constant . the r.h.s .",
    "of the previous equation is a linear combination of spin probabilities and it is easy to see that the corresponding @xmath0-population is just a linear combination of the corresponding @xmath0-populations with same coefficients @xmath400 and the normalization factor is just that sum of the coefficients i.e. @xmath436 .",
    "the populations corresponding to @xmath402 are given by eq .",
    "( [ defp ] ) and we see that the coefficients @xmath400 in eq .",
    "( [ mc ] ) cancel the term at the denominator in ( [ defp ] ) , thus the resulting equation for the populations @xmath390 is : @xmath437^{x_{k+1}/x_k } \\delta ( \\tilde{p}^{(k-1)}_{rs}-\\tilde{{\\bf p}}^{(k-1)}_{j , rs } ) \\rangle_j   \\label{iteave1}\\ ] ] @xmath438 note that in the limit @xmath9 we have @xmath439 because @xmath440 .",
    "these equations are translationally invariant , meaning that the populations @xmath390 does not depends on where regions @xmath16 and @xmath28 are actually on the lattice but just on their shape and mutual positions with respect to each other .",
    "for instance in the bethe approximation we have a single @xmath0-population that does not fluctuate over the sites .",
    "the right hand sides of the above equations ( [ iteave1 ] ) and ( [ iteave2 ] ) should be thought of as respectively the r.h.s . and l.h.s .",
    "of a single equation that in general involves the messages populations @xmath390 in implicit form .",
    "this is the main difference with respect to the bethe approximation where the messages appears in explicit form and the equations can be solved iteratively , a discussion of these equations in the context of the cvm plaquette approximation will be given at the end of next section .",
    "on a single sample instead the distributions fluctuate over the sites . as a consequence",
    "the solution with @xmath0-rsb steps is parametrized by @xmath441-rsb populations fluctuating over space .",
    "the corresponding equations are : @xmath442 @xmath443 for instance the @xmath366-rsb solution on a given sample is described by populations of fields that fluctuate over different regions . again the right hand sides of the above equations ( [ itesamp1 ] ) and ( [ itesamp2 ] ) should be thought of as respectively the r.h.s . and l.h.s .",
    "of a single equation that in general involves the messages in implicit form .    when @xmath444 and the maximal region is the couple of points ( _ i.e. _  we work in the bethe approximation ) the above equations reproduce the celebrated survey propagation ( sp ) equations @xcite , hence the name generalized survey propagation equations .",
    "the sp equations were originally obtained through the cavity method , while a derivation of the sp equations on a single sample using replicas was obtained in @xcite .      the variational expression of the free energy eq . ( [ varf ] )",
    "can be written in terms of populations along the same lines of the previous sections .",
    "the results in the averaged case is : @xmath445 where @xmath446 is a @xmath6-dependent function of the @xmath0-populations corresponding to the messages in @xmath41 that can be defined iteratively in terms of the populations as : @xmath447 with @xmath448 where @xmath449 on a single instance instead we have : @xmath450 where the @xmath451 have to be evaluated in terms of the @xmath452-populations entering region @xmath16 . in order to make explicit the similarity with the cavity formulation of @xcite we define a new function @xmath453 consequently the above quantity has again a recursive definition : @xmath454 with this definition we have : @xmath455 and @xmath456 in the average case",
    "the message populations do not fluctuate over space and the contribution of each region of a given form to the free energy is the same .",
    "thus the sum over all regions can be replaced by the sum of the contributions of the basic types of regions @xmath16 each multiplied by the number @xmath457 of regions of type @xmath16 per spin .",
    "for instance in the plaquette approximation of the 2d square lattice we have @xmath263 , @xmath458 and @xmath459 , and the number of regions per spin are respectively @xmath460 , @xmath461 and @xmath268 .",
    "it is also important to determine the derivatives of the free energy with respect to the parameters @xmath354 @xcite . since the above expression is variational with respect to the populations the total derivative of the free energy with respect to @xmath462 coincides with its partial derivative with respect to @xmath462 .    clearly in order to determine the derivative of the free energy with respect to the parameters",
    "@xmath354 we only need to determine the derivatives of the function @xmath463 .",
    "the derivative of @xmath464 with respect to @xmath465 is : @xmath466 where we have defined : @xmath467 then the derivative @xmath468 can be obtained using the recursive definition .",
    "indeed we see that the derivatives of @xmath469 for @xmath470 with respect to @xmath465 parameters obey the following recursive equation : @xmath471 for instance in the 1rsb case in the @xmath9 limit we get a similar result to ref .",
    "@xcite : @xmath472      in the preceding sections we have worked under the assumption that the messages and the beliefs are both parametrized through populations of populations of fields . in section [ plaquette ] we have applied the approach to the ea model on various lattices in the cvm plaquette approximation . we made the simplest non - trivial ansatz , _",
    "i.e. _  the rs ansatz , that we expect to be good in the high - temperature paramagnetic phase . on a single sample",
    "the messages are just numbers in the rs phase , and the corresponding equations are the gbp equations of @xcite . for the replicated averaged system instead the messages according to the above parametrization should be distributions of fields .",
    "as we have seen it turns out that the actual solution requires to consider messages parametrized by functions that are not positive definite _",
    "i.e. _  that are not distributions .",
    "this tells us that in practice when solving a given model we may be forced to consider parametrization of the form ( [ itdef ] ) where instead of populations of fields we should consider functions of the fields , or instead of populations of populations we should consider functionals . at any rate , it is easily seen that the equations obeyed by these objects do not change at all depending on whether they are distributions or functions _ i.e. _  all the results of the previous subsection hold . on the other hand",
    "it can be argued that the function @xmath473 defined above should always give a positive number and this is guaranteed only if it is a function of @xmath147-populations , therefore it appears that in any case we should parametrize a message at level @xmath0 of rsb with a function of @xmath452-populations and this function may eventually be non - positive definite .",
    "in other words it seems to us that we can relax the condition to use distributions only at the last level of rsb .",
    "the generalized survey propagation equations derived previously express the tilded populations in terms of the non - tilded ones . to obtain an explicit expression for the message functions one needs to invert equations ( [ iteave2 ] ) ( or eq . ( [ itesamp2 ] ) on a given sample ) and obtain an expression for the non - tilded populations in terms of the tilded ones . at the lowest rsb levels , ( _ i.e. _  rs in the averaged case and 1rsb on a single sample ) this can be done using fourier transforms . in this appendix",
    "we will show that at any number @xmath0 of rsb steps the inversion can be achieved in principle using appropriate integral transforms of the populations .",
    "an algorithm able to go back and forth from the populations to their transforms would provide a route to the numerical solution of the generalized survey propagation equations but unfortunately an efficient implementation seems quite difficult .    basically we will work with nested fourier transform , _",
    "i.e. _  fourier transforms of fourier transforms .",
    "we will introduce the invertible integral transform @xmath474 of a @xmath147-population @xmath475 and show that eq .",
    "( [ iteave2 ] ) in terms of transform reads : @xmath476 from the previous expression we can easily compute @xmath477 from @xmath478 .",
    "again we will proceed iteratively , showing that if the previous equation is valid at level @xmath369 it is also valid at level @xmath147 . in order to do this",
    "we also assume that it exists a function @xmath479 such that the quantity @xmath480 can be written as @xmath481 where @xmath482 in the above equation is computed as the sum of the non - tilded transform .",
    "we can write eq .",
    "( [ defq ] ) in terms of the transforms at level @xmath369 : @xmath483^{x_{k+1}/x_k }    \\times   { \\nonumber}\\\\ & \\times & \\delta \\left(\\tilde{\\cal t}^{(k-1)}_{rs}-{\\cal      t}^{(k-1)}_{rs}-\\sum_{m_{r ' 's '' } \\in m(r , s)}{\\cal      t}^{(k-1)}_{r ' 's '' } \\right ) \\end{aligned}\\ ] ] now using eq .",
    "( [ eqt2 ] ) we can redistribute the reweighting term between the various populations and rewrite the previous equation as : @xmath484 in the previous equation @xmath485 defines a measure over the space of @xmath369 transform .",
    "we fourier transform the previous equation with respect to the @xmath369 transform and obtain : @xmath486 accordingly the factor @xmath487 can be obtained as the transform evaluated at a given value , _",
    "e.g. _  zero argument ; this yields : @xmath488 now we can take the logarithm of the previous equation and define : @xmath489 we see that with this definition eq .",
    "( [ eqt1 ] ) is satisfied at level @xmath147 .",
    "correspondingly eq .",
    "( [ eqt2 ] ) is also satisfied provided we identify the function @xmath490 with : @xmath491 to complete the proof we need to show that eq .",
    "( [ eqt1 ] ) and eq .",
    "( [ eqt2 ] ) are valid at @xmath387 , the replica symmetric case . to do this we easily see that eqs .",
    "( [ uuu ] ) and ( [ mmm ] ) have this structure .",
    "therefore at the rs level the transform @xmath492 is defined as : @xmath493 and we have : @xmath494 summarizing , at the rs level , the integral transform needed to solve the inversion problem is defined as the logarithm of the fourier transform of the reweighted distribution of fields . note that if the solution is purely rs we have @xmath414 and the reweighting term is absent in the @xmath9 limit . from the above rs expression one",
    "can go to 1rsb using eq .",
    "( [ deft ] ) . at 1rsb",
    "the solution is parametrized by a population of populations , and the transform is the logarithm of the fourier transform of the reweighted distribution of the logarithm of the fourier transforms of the populations .",
    "r. kikuchi , phys .",
    "rev . * 81 * , 988 ( 1951 ) .",
    "t. morita , m. suzuki , k. wada and m. kaburagi ( eds . ) : _ foundations and applications of cluster variation method and path probability method _ , prog .",
    "* 115 * ( 1994 ) ."
  ],
  "abstract_text": [
    "<S> we present a general formalism to make the replica - symmetric and replica - symmetry - breaking ansatz in the context of kikuchi s cluster variational method ( cvm ) . using replicas and the message - passing formulation of cvm we obtain a variational expression of the replicated free energy of a system with quenched disorder , both averaged and on a single sample , and make the hierarchical ansatz using functionals of functions of fields to represent the messages . </S>",
    "<S> we obtain a set of integral equations for the message functionals . the main difference with the bethe case </S>",
    "<S> is that the functionals appear in the equations in implicit form and are not positive definite , thus standard iterative population dynamic algorithms can not be used to determine them . in the simplest cases the solution could be obtained iteratively using fourier transforms .    </S>",
    "<S> we begin to study the method considering the plaquette approximation to the averaged free energy of the edwards - anderson model in the paramagnetic replica - symmetric phase . in two dimensions </S>",
    "<S> we find that the spurious spin - glass phase transition of the bethe approximation disappears and the paramagnetic phase is stable down to zero temperature on the square lattice for different random interactions . </S>",
    "<S> the quantitative estimates of the free energy and of various other quantities improve those of the bethe approximation . </S>",
    "<S> the plaquette approximation fails to predict a second - order spin - glass phase transition on the cubic 3d lattice but yields good results in dimension four and higher . </S>",
    "<S> we provide the physical interpretation of the beliefs in the replica - symmetric phase as disorder distributions of the local hamiltonian . </S>",
    "<S> the messages instead do not admit such an interpretation and indeed they can not be represented as populations in the spin - glass phase at variance with the bethe approximation .    </S>",
    "<S> the approach can be used in principle to study the phase diagram of a wide range of disordered systems and it is also possible that it can be used to get quantitative predictions on single samples . </S>",
    "<S> these further developments present however great technical challenges . </S>"
  ]
}