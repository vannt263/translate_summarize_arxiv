{
  "article_text": [
    "many of nowadays spectral unmixing techniques rely on non - negative matrix decompositions .",
    "this concerns for example hyperspectral remote sensing ( with applications in earth observation , astronomy , chemistry , etc . ) or audio signal processing .",
    "the spectral sample @xmath0 ( the spectrum of light observed at a given pixel @xmath1 , or the audio spectrum in a given time frame @xmath1 ) is decomposed onto a dictionary @xmath2 of elementary spectral templates , characteristic of pure materials or sound objects , such that @xmath3 .",
    "the composition of sample @xmath1 can be inferred from the non - negative expansion coefficients @xmath4 .",
    "this paradigm has led to state - of - the - art results for various tasks ( recognition , classification , denoising , separation ) in the aforementioned areas , and in particular in music transcription , the central application of this paper .    in state - of - the - art music transcription systems ,",
    "the spectrogram @xmath5 ( with columns @xmath6 ) of a musical signal is decomposed onto a dictionary of pure notes ( in so - called multi - pitch estimation ) or chords .",
    "@xmath5 typically consists of ( power-)magnitude values of a regular short - time fourier transform @xcite .",
    "it may also consists of an audio - specific spectral transform such as the mel - frequency transform , like in @xcite , or the q - constant based transform , like in @xcite .",
    "the success of the transcription system depends of course on the adequacy of the time - frequency transform & the dictionary to represent the data @xmath5 .",
    "in particular , the matrix @xmath2 must be able to accurately represent a diversity of real notes .",
    "it may be trained with individual notes using annotated data @xcite , have a parametric form @xcite or be learnt from the data itself using a harmonic subspace constraint @xcite .",
    "one important challenge of such methods lies in their ability to cope with the variability of real notes .",
    "a simplistic dictionary model will assume that one note characterised by fundamental frequency @xmath7 ( e.g. , @xmath8 hz for note a@xmath9 ) will be represented by a spectral template with non - zero coefficients placed at @xmath7 and at its multiples ( the _ harmonic frequencies _ ) .",
    "in reality , many instruments , such as the piano , produce musical notes with either slight frequency misalignments ( so - called _ inharmonicities _ ) with respect to the theoretical values of the fundamental and harmonic frequencies , or amplitude variations at the harmonic frequencies with respect to recording conditions or played instrument ( variations of _ timbre _ ) . handling these variabilities by increasing the dictionary with more templates is typically unrealistic and adaptive dictionaries have been considered in @xcite . in these papers , the spectral shape of the columns of @xmath2",
    "is adjusted to the data at hand , using specific time - invariant semi - parametric models .",
    "however , the note realisations may vary in time , something which is not handled by these approaches .",
    "this work presents a new spectral unmixing method based on optimal transportation ( ot ) that is fully flexible and remedies the latter difficulties .",
    "note that @xcite have previously applied ot to notated music ( e.g. , score sheets ) for search - by - query in databases while we address here music transcription from audio spectral data .",
    "before presenting our contributions , we start by introducing the plca method of @xcite which is heavily used in audio signal processing . it is based on the probabilistic latent semantic analysis ( plsa ) of @xcite ( used in text retrieval ) and is a particular form of non - negative matrix factorisation ( nmf ) . simplifying a bit , in plca the columns of @xmath5",
    "are normalised to sum to one .",
    "each vector @xmath6 is then treated as a discrete probability distribution of `` frequency quanta '' and is approximated as @xmath10 . the matrices @xmath2 and @xmath11 are of size @xmath12 and @xmath13 , respectively , and their columns are constrained to sum to one . as a result ,",
    "the columns of the approximate @xmath14 sum to one as well and each distribution vector @xmath6 is as such approximated by the counterpart distribution @xmath15 in @xmath16 . under the assumption that @xmath2 is known , the approximation is found by solving the optimisation problem defined by where @xmath17 is the kl divergence between discrete distributions , and by extension @xmath18 .",
    "an important characteristic of the kl divergence is its separability with respect to the entries of its arguments .",
    "it operates a frequency - wise comparison in the sense that , at every frame @xmath1 , the spectral coefficient @xmath19 at frequency @xmath20 is compared to its counterpart @xmath21 , and the results of the comparisons are summed over @xmath20 .",
    "in particular , a small displacement in the frequency support of one observation may disproportionally harm the divergence value .",
    "for example , if @xmath0 is a pure note with fundamental frequency @xmath7 , a small inharmonicity that shifts energy from @xmath7 to an adjacent frequency bin will unreasonably increase the divergence value , when @xmath0 is compared with a purely harmonic spectral template with fundamental frequency @xmath7 . as explained in section  [ sec : intro ] such local displacements of frequency energy are very common when dealing with real data .",
    "a measure of fit invariant to small perturbations of the frequency support would be desirable in such a setting , and this is precisely what ot can bring .",
    "given a discrete probability distribution @xmath22 ( a non - negative real - valued column vector of dimension @xmath23 and summing to one ) and a _",
    "target _ distribution @xmath24 ( with same properties ) , ot computes a _ transportation matrix _ @xmath25 belonging to the set @xmath26 .",
    "@xmath25 establishes a bi - partite graph connecting the two distributions . in simple words , an amount ( or , in typical ot parlance , a `` mass '' ) of every coefficient of vector @xmath22",
    "is transported to an entry of @xmath24 .",
    "the sum of transported amounts to the @xmath27 entry of @xmath24 must equal @xmath28 .",
    "the value of @xmath29 is the amount transported from the @xmath30 entry of @xmath22 to the @xmath27 entry of @xmath24 . in our particular setting ,",
    "the vector @xmath22 is a distribution of spectral energies @xmath31 at sampling frequencies @xmath32 .    without additional constraints ,",
    "the problem of finding a non - negative matrix @xmath33 has an infinite number of solutions .",
    "as such , ot takes into account the _ cost _ of transporting an amount from the @xmath30 entry of @xmath22 to the @xmath27 entry of @xmath24 , denoted @xmath34 ( a non - negative real - valued number ) .",
    "endorsed with this cost function , ot involves solving the optimisation problem defined by where @xmath35 is the non - negative square matrix of size @xmath23 with elements @xmath34 .",
    ".   defines a convex linear program .",
    "the value of the function @xmath36 at its minimum is denoted @xmath37 .",
    "when @xmath35 is a symmetric matrix such that @xmath38 , where we recall that @xmath39 and @xmath40 are the frequencies in hertz indexed by @xmath20 and @xmath41 , @xmath37 defines a metric ( i.e. , a symmetric divergence that satisfies the triangle inequality ) coined wasserstein distance or earth mover s distance @xcite .",
    "in other cases , in particular when the matrix @xmath35 is not even symmetric like in the next section , @xmath37 is not a metric in general , but is still a valid measure of fit . for generality",
    ", we will refer to it as the `` ot divergence '' .    by construction ,",
    "the ot divergence can explicitly embed a form of invariance to displacements of support , as defined by the transportation cost matrix @xmath35 .",
    "for example , in the spectral decomposition setting , the matrix with entries of the form @xmath42 will increasingly penalise frequency displacements as the distance between frequency bins increases .",
    "this precisely remedies the limitation of the separable kl divergence presented in section  [ sec : plca ] . as such , the next section addresses variants of spectral unmixing based on the wasserstein distance .",
    "[ [ unmixing - with - ot . ] ] unmixing with ot .",
    "+ + + + + + + + + + + + + + + + +    in light of the above discussion , a direct solution to the sensibility of plca to small frequency displacements consists in replacing the kl divergence with the ot divergence .",
    "this amounts to solving the optimisation problem given by where @xmath43 , @xmath2 is fixed and populated with pure note spectra and @xmath35 penalises large displacements of frequency support .",
    "this approach is a particular case of nmf with the wasserstein distance , which has been considered in a face recognition setting by @xcite , with subsequent developments by @xcite and @xcite .",
    "this approach is relevant to our spectral unmixing scenario but as will be discussed in section  [ sec : optim ] is on the downside computationally intensive .",
    "it also requires the columns of @xmath2 to be set to realistic note templates , which is still constraining .",
    "the next two sections describes a computationally more friendly approach which additionally removes the difficulty of choosing @xmath2 appropriately .",
    "[ [ harmonic - invariant - transportation - cost . ] ] harmonic - invariant transportation cost .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the approach above , the harmonic modelling is conveyed by the dictionary @xmath2 ( consisting of comb - like pure note spectra ) and the invariance to small frequency displacements is introduced via the matrix @xmath35 . in this section",
    "we propose to model both harmonicity and local invariance through the transportation cost matrix @xmath35 . loosely speaking , we want to define a class of equivalence between musical spectra , that takes into account their inherent harmonic nature . as such",
    ", we essentially impose that a harmonic frequency ( i.e. , a close multiple of its fundamental ) can be considered equivalent to its fundamental , the only target of multi - pitch estimation . as such",
    ", we assume that a mass at one frequency can be transported to a divisor frequency with no cost .",
    "in other words , a mass at frequency @xmath39 can be transported with no cost to @xmath44 , @xmath45 , @xmath46 , and so on until sampling resolution .",
    "one possible cost matrix that embeds this property is where @xmath47 is the ceiling of @xmath48 and @xmath49 is a small value .",
    "the term @xmath50 favours the discrimination of octaves .",
    "indeed , it penalises the transportation of a note of fundamental frequency @xmath51 or @xmath52 to the spectral template with fundamental frequency @xmath7 , which would be costless without this additive term .",
    "let us denote by @xmath53 the transportation cost matrix defined by eq .  .",
    "[ fig : transploss ] compares @xmath53 to the more standard quadratic cost @xmath54 defined by @xmath55 . with the quadratic cost , only local displacements",
    "are permissible .",
    "in contrast , the harmonic - invariant cost additionally permits larger displacements to divisor frequencies , improving robustness to variations of timbre besides to inharmonicities .    [ cols=\"^,^,^,^ \" , ]",
    "in this paper we have introduced a new paradigm for spectral dictionary - based music transcription . as compared to state - of - the - art approaches",
    ", we have proposed a _ holistic _ measure of fit which is robust to local and harmonically - related displacements of frequency energies .",
    "it is based on a new form of transportation cost matrix that takes into account the inherent harmonic structure of musical signals .",
    "the proposed transportation cost matrix allows in turn to use a simplistic dictionary composed of dirac vectors placed at the target fundamental frequencies , eliminating the problem of choosing a meaningful dictionary .",
    "experimental results have shown the robustness and accuracy of the proposed approach , which strikingly does not come at the price of computational efficiency .",
    "instead , the particular structure of the dictionary allows for a simple algorithm that is way faster than state - of - the - art nmf - like approaches .",
    "the proposed approach offers new foundations , with promising results and room for improvement .",
    "in particular , we believe exciting avenues of research concern the learning of @xmath53 from examples and extensions to other areas such as in remote sensing , using application - specific forms of @xmath35 .      this work is supported in part by the european research council ( erc ) under the european union s horizon 2020 research & innovation programme ( project factory ) and by the french anr under the jcjc programme ( project mad ) .",
    "many thanks to antony schutz for generating & providing some of the musical data .",
    "benamou , g.  carlier , m.  cuturi , l.  nenna , and g.  peyr .",
    "iterative bregman projections for regularized transportation problems .",
    "_ siam journal on scientific computing _ , 370 ( 2):0 a1111a1138 , 2015 .",
    "n.  boulanger - lewandowski , y.  bengio , and p.  vincent .",
    "discriminative non - negative matrix factorization for multiple pitch estimation . in _ proc .",
    "international society for music information retrieval conference ( ismir ) _ , 2012 .",
    "n.  courty , r.  flamary , and d.  tuia .",
    "domain adaptation with regularized optimal transport . in _ proc .",
    "european conference on machine learning and principles and practice of knowledge discovery in databases ( ecml pkdd ) _ , 2014 .",
    "a.  daniel , v.  emiya , and b.  david .",
    "perceptually - based evaluation of the errors usually made when automatically transcribing music . in _ proc .",
    "international society for music information retrieval conference ( ismir ) _ , 2008 .",
    "v.  emiya , r.  badeau , and b.  david .",
    "multipitch estimation of piano sounds using a new probabilistic spectral smoothness principle .",
    "_ ieee trans .",
    "audio , speech , and language processing _ , 180 ( 6):0 16431654 , 2010 .",
    "f.  rigaud , b.  david , and l.  daudet . a parametric model and estimation techniques for the inharmonicity and tuning of the piano . _ the journal of the acoustical society of america _ ,",
    "1330 ( 5):0 31073118 , 2013 .",
    "r.  sandler and m.  lindenbaum .",
    "nonnegative matrix factorization with earth mover s distance metric for image analysis .",
    "_ ieee trans .",
    "pattern analysis and machine intelligence _",
    ", 330 ( 8):0 15901602 , aug 2011 ."
  ],
  "abstract_text": [
    "<S> many spectral unmixing methods rely on the non - negative decomposition of spectral data onto a dictionary of spectral templates . </S>",
    "<S> in particular , state - of - the - art music transcription systems decompose the spectrogram of the input signal onto a dictionary of representative note spectra . </S>",
    "<S> the typical measures of fit used to quantify the adequacy of the decomposition compare the data and template entries frequency - wise . as such , small displacements of energy from a frequency bin to another as well as variations of timbre </S>",
    "<S> can disproportionally harm the fit . </S>",
    "<S> we address these issues by means of optimal transportation and propose a new measure of fit that treats the frequency distributions of energy holistically as opposed to frequency - wise . </S>",
    "<S> building on the harmonic nature of sound , the new measure is invariant to shifts of energy to harmonically - related frequencies , as well as to small and local displacements of energy . </S>",
    "<S> equipped with this new measure of fit , the dictionary of note templates can be considerably simplified to a set of dirac vectors located at the target fundamental frequencies ( musical pitch values ) . </S>",
    "<S> this in turns gives ground to a very fast and simple decomposition algorithm that achieves state - of - the - art performance on real musical data . </S>"
  ]
}