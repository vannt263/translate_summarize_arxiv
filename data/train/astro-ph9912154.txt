{
  "article_text": [
    "interpretation of molecular line observations requires understanding of the radiative transfer processes involved .",
    "the observed intensity is an integral over the line - of - sight and depends on various physical parameters that vary along this line .",
    "the problem is usually a non - invertible one .",
    "finite angular resolution means that conditions may vary over the beam and further complications arise e.g. in the form of incomplete beam filling .",
    "one may approach the problem from different perspective by constructing models of the density , velocity and temperature structure of the object .",
    "models can be tested by using radiative transfer methods that predict the observed spectra .",
    "eventually one can find a model that fits the observations .",
    "however , usually there is a number of possible solutions .",
    "the models can be restricted by other arguments e.g. by requiring physical self - consistency , although e.g. in massive star forming regions the situation is often too complicated for this ( e.g. juvela 1998 ) . for interstellar clouds at larger scales the situation seems to be better . there",
    "the dynamical processes are less violent and the laws of magneto - hydrodynamics can be used to simulate typical distribution and motion of gas .",
    "conversely , with radiative transfer methods the basic assumptions of the mhd calculations can be checked against observations .",
    "for radiative transfer calculations the model cloud is discretized into cells e.g. according to a three - dimensional cartesian grid .",
    "each cell is assigned density , temperature , velocity and intrinsic linewidth .",
    "the effect of the radiation field is simulated and the results are used to update estimates of the level populations in each cell .",
    "final solution is obtained by iterating these two steps .",
    "there are several methods for improving the computational efficiency of monte carlo .",
    "these include the use of a reference field ( bernes 1979 ; choi et al .",
    "1995 ) , importance sampling and the use of quasi random numbers ( juvela 1997 ) . furthermore ,",
    "if one uses the same set of random numbers on each iteration one can eliminate random noise from computed level populations .",
    "this enables the use of similar acceleration methods as used with lambda iteration e.g. ng - acceleration ( ng 1974 ) .",
    "the monte carlo method has been considered unsuitable for use with high optical depths , @xmath0 .",
    "hartstein & liseau ( 1998 ) showed , however , that with core saturation method calculations are possible even with optical depths of several thousands .",
    "the idea is to consider only photons in the line wings . in the optically thick case photons in the line centre",
    "are emitted and absorbed locally and do not contribute to the transfer of energy .",
    "we have used two simulation methods in the radiative transfer calculations .",
    "method b in juvela ( 1997 ) is based on ray - tracing .",
    "a photon package is started at the edge of the cloud and as the package moves a distance @xmath1 through a cell with optical depth @xmath2 the number of emitted photons escaping the cell , @xmath3 is added to the package while the rest of the emitted photons are absorbed in the cell ( juvela 1997 ) . in the formula @xmath4 is the population of the upper energy level and @xmath5 is the einstein coefficient of spontaneous emission .",
    "we can use this information in a way similar to the core saturation method to eliminate photons that are absorbed in the same cell from which they were emitted .",
    "the equilibrium equations must also be modified , which can be done in several ways .",
    "we store in each cell the fraction of discarded photons and use those numbers to correct the equilibrium equations .",
    "this means an increase in the memory consumption by @xmath630% .",
    "conceptually the method is identical to the accelerated lambda iteration ( olson , auer & buchler 1986 ) .    in monte carlo simulation",
    "the knowledge of the cell geometry is required only for finding the next cell boundary along the track of the photon package and for calculating the cell volumes .",
    "this makes it easy design the computational geometry according to the problem at hand .",
    "so far we have implemented the following : ( 1 ) spherically symmetric clouds divided into shells , ( 2 ) cylinder symmetric clouds divided by cylinders and orthogonal planes , ( 3 ) 3d cartesian grid with cubic cells , ( 4 ) 3d grid with embedded spherical clumps divided by spheres , longitudes and latitudes and ( 5 ) 3d cartesian grid with hierarchical subdivision according chosen criteria .",
    "the last option is promising for the mhd simulations where better resolution is usually needed only in some small sub - volume .",
    "the reduced memory requirements are , however , not complemented by equal savings in the run times although importance sampling can be used to concentrate on the regions with higher discretization .",
    "padoan & nordlund ( 1999 ) have shown that super - alfvnic random flows provide a good model for the dynamics and structure of molecular clouds .",
    "the column density maps made of mhd simulations are reminiscent of the filamentary structures observed in interstellar clouds and the results give a good starting point for the radiative transfer modelling of these clouds . with a snapshot of the mhd simulations ( i.e. density and velocity fields )",
    "the monte carlo method can be used to solve the the radiative transfer problem and the computed spectra can be compared with observations .",
    "the original mhd calculations were performed on 128@xmath7 cell grid . for radiative transfer calculations",
    "the data are resampled on a smaller grid of typically 90@xmath7 or 64@xmath7 cells .",
    "this can be done without significant loss of accuracy since individual cells are usually optically thin .",
    "however , proper sampling of the velocity field sets its own requirements on the discretization .",
    "models represent clouds with linear size @xmath610pc and average gas densities a few times 100@xmath8 . in the densest knots the density exceeds 10@xmath9@xmath8 .",
    "the results of the radiative transfer calculations are presented as synthetic molecular line maps that can be compared directly with observations ( padoan et al . 1998 ) .",
    "co spectra show typically several peaks corresponding to different high density sheets of gas along the line of sight .",
    "the average spectrum is almost gaussian .",
    "padoan et al .",
    "( 1999a ) have compared the computed spectra in detail with co observations made of the perseus molecular cloud complex .",
    "the statistical properties of the computed spectra are almost identical to the properties of the spectra observed e.g. in l1448 .",
    "this demonstrates that the main features of such clouds are correctly described by the mhd models .    the models spectra can be analyzed using the lte approximation in order to estimate the validity of the lte assumption in the interpretation of observations .",
    "even in isothermal models one can find a wide range of excitation conditions and lte analysis tends to underestimate the true column densities . in the case of our models",
    "the discrepancy can be as high as a factor @xmath65 , at the lowest values of the co column density .",
    "( padoan et al .",
    "the previous model calculations can be extended to the study of thermal balance in interstellar clouds .",
    "the mhd calculations provide the heating rates due to ambipolar diffusion and total heating rates are obtained by adding other known mechanisms ( cosmic ray heating etc . ) . these are balanced by cooling rates which in the case of molecular clouds are mainly due to line emission .",
    "the cooling rates at any point in the cloud will depend on the local escape probability of the emitted photons but also on the photon flux from the surrounding regions . since velocity and density distributions are inhomogeneous",
    "the calculation of the cooling rates requires proper solution of the full three - dimensional radiative transfer problem .    in the case of monte carlo method cooling rates",
    "are a by - product of the radiative transfer simulation and are obtained by simply counting the net flow of photons from each cell . for practical reasons each molecule",
    "is simulated separately and the kinetic temperatures , @xmath10 , can be updated only after all the main cooling species have been simulated .",
    "since the line emission depends in turn on t@xmath11 the final solution is obtained with iteration .",
    "since @xmath12co is usually the dominant coolant it is not necessary to update the cooling rate estimates from other species on every iteration .",
    "the ambipolar diffusion heating can exceed heating by cosmic rays ( padoan , zweibel & nordlund 1999c ) .",
    "computed cloud temperatures are therefore sensitive to initial assumptions and can be used to place limits on the possible range of the input parameters , especially the strength of the magnetic fields ."
  ],
  "abstract_text": [
    "<S> the high resolution and sensitivity provided by alma will reveal new small scale structures in many sources , e.g. star forming regions . </S>",
    "<S> such inhomogeneities may not have been considered in the analysis of past observations but they will be essential to the understanding of future data . </S>",
    "<S> radiative transfer methods are needed to interpret the observations and the presence of complicated source structures and small scale inhomogeneities requires 3d modelling .    </S>",
    "<S> we will describe studies of molecular line emission we have made using models of inhomogeneous molecular clouds . </S>",
    "<S> these are based on mhd models and include e.g. thermal balance calculations for molecular clouds .    </S>",
    "<S> our radiative transfer code is based on monte carlo simulation . with current computing resources </S>",
    "<S> it has already become possible to handle even large 3-d models . </S>",
    "<S> we shall show that monte carlo method can be applied also in cases of hight optical depths . </S>"
  ]
}