{
  "article_text": [
    "we prove the equality of the specialization @xmath0 of the macdonald polynomial at @xmath1 with the graded character @xmath2 of a tensor product of `` single - column '' kirillov - reshetikhin ( kr ) modules @xcite for untwisted affine lie algebras .",
    "this result follows immediately from another important result in the paper , namely the construction of two uniform combinatorial models for the crystals associated with the mentioned tensor products .",
    "the first model has its origins in the work of naito and sagaki  @xcite , who realized the tensor products of single - column kr crystals in terms of so - called projected level - zero affine lakshmibai - seshadri ( ls ) paths .",
    "we provide an explicit description of these paths ( as quantum ls paths ) , in terms of the parabolic quantum bruhat graph  @xcite , which originated from ( small ) quantum cohomology of partial flag manifolds .",
    "this part of our work is based on previous results of ours in @xcite , where we study various properties of the parabolic quantum bruhat graph , including two lifts of it : to the bruhat order on the affine weyl group , and to littelmann s level - zero weight poset  @xcite ; we also provided a precise characterization of the latter .    in the second part of the paper",
    ", we construct an explicit affine crystal isomorphism between the quantum ls path model and the quantum alcove model in @xcite .",
    "the latter is intimately related to @xmath0 by the ram - yip formula for macdonald polynomials @xcite .",
    "this leads us to our @xmath3 result .",
    "the context of this project has its origins in ion s observation  @xcite that , when the affine simple root @xmath4 is short ( which includes the duals of untwisted affine root systems ) , @xmath0 is an affine demazure character ( see  @xcite for type @xmath5 ) .",
    "on the other hand , fourier and littelmann  @xcite showed that , for simply - laced affine lie algebras , these demazure characters are graded characters of tensor products of kr modules , and hence of local weyl modules for current algebras , by results in  @xcite . combining  @xcite and  @xcite ,",
    "one deduces the equality @xmath3 in the simply - laced cases .",
    "our results go beyond this .",
    "let us note that , in the non - simply - laced untwisted affine types , @xmath6 is , in general , a positive sum of affine demazure characters , as proved in ( * ? ? ?",
    "* theorem a ) ; this means that the underlying tensor product of kr modules is larger than a corresponding demazure module .",
    "our work reveals other interesting connections , complementing some recent results in the literature .",
    "braverman and finkelberg  @xcite have shown that , for simply - laced affine root systems , the characters @xmath7 of the duals of the current algebra modules , called global weyl modules , coincide with the characters of the spaces of global sections of line bundles on quasi - maps spaces , which arise in the study of quantum cohomology and quantum @xmath8-theory of the flag manifold . in simply - laced types , the characters @xmath7 are equal to @xmath2 ( which is the graded character of a local weyl module ) times an explicit product of geometric series whose ratios are powers of @xmath9  @xcite .",
    "the characters @xmath7 are called @xmath9-whittaker functions due to their appearance in the quantum group version of the kostant - whittaker reduction of etingof  @xcite and sevostyanov  @xcite for the @xmath9-toda integrable system .",
    "the characters @xmath7 are eigenfunctions of the @xmath9-toda difference operators , and their generating function yields the @xmath8-theoretic @xmath10-function of givental and lee  @xcite .",
    "finally , the quantum alcove model arises in lenart and postnikov s conjectural description of the quantum product by a divisor in quantum @xmath8-theory  @xcite .",
    "we summarize the connections discussed above in figure  [ figure.outline ] .    ]",
    "combinatorial models for all nonexceptional kr crystals ( not just of column - shape ) were given in  @xcite .",
    "the quantum ls path model and the quantum alcove model uniformly describe tensor products of column - shape kr crystals , for all untwisted affine types .",
    "more precisely , these models realize the root operators on the aforementioned tensor products , and also give efficient formulas for the corresponding energy function ; the latter can be viewed as an affine grading on a tensor product of kr crystals  @xcite , and is used to express one - dimensional configuration sums in statistical mechanics  @xcite . given that , in large rank",
    ", certain configuration sums for classical lie types were shown to coincide with certain parabolic lusztig @xmath9-analogues of weight multiplicity @xcite , we can also use our energy formula to compute the latter .",
    "moreover , by results in  @xcite , we can calculate the energy on certain tensor products of `` single - row '' kr crystals .",
    "another application of the quantum alcove model , which was given in  @xcite , is a uniform realization of the combinatorial @xmath11-matrix ( i.e. , the unique affine crystal isomorphism commuting factors in a tensor product of kr crystals ) .",
    "the quantum ls path model and the quantum alcove model were implemented in the computer algebra system sage  @xcite . using this implementation , we verified some conjectures related to kr crystals in the exceptional types ( except for two dynkin nodes for type @xmath12 ) ; these conjectures , which had been previously proved only in the classical types in  @xcite , are concerned with the perfectness property of kr crystals  @xcite , and with their graded classical decompositions  @xcite",
    ".    there have been several developments related to the work in this paper . based on our results , an interpretation of the @xmath9-whittaker functions @xmath13 above",
    "is given in  @xcite , in terms of the crystal bases of level - zero extremal weight modules over quantum affine algebras .",
    "on another hand , our work was used in  @xcite to provide the character of a stable level - one demazure module associated to type @xmath14 as an explicit combination of suitably specialized macdonald polynomials .",
    "in addition , our results were used in a crucial way by chari and ion in  ( * ? ? ? * theorem 4.2 ) to show that macdonald polynomials at @xmath1 are characters of local weyl modules for current algebras .",
    "based on this , they prove a bernstein - gelfand - gelfand ( bgg ) reciprocity theorem for the category of representations of a current algebra . in related work ,",
    "khoroshkin  @xcite exhibits a categorification of macdonald polynomials , by realizing them as the euler characteristic of bigraded characters for certain complexes of modules over a current algebra .",
    "this realization simplifies considerably if bgg reciprocity holds ( the mentioned complexes become actual modules concentrated in homological degree zero ) .",
    "the paper is organized as follows . in sections  [ sec : ls ] and",
    "[ sec : qls ] , we review the affine lakshmibai - seshadri ( ls ) and the quantum lakshmibai - seshadri path model , respectively . theorem  [ thm : ls = qls ] shows that the set of projected level - zero affine ls paths @xmath15 is the same as the set of quantum ls paths @xmath16 , where @xmath17 is a ( level - zero ) dominant integral weight .",
    "this fact is also proven in  @xcite in a somewhat roundabout way , by providing an explicit description of the image of a quantum ls path under root operators and showing that the set of quantum ls paths is stable under the action of the root operators .",
    "( quantum ) ls paths carry a grading by a degree function ( which is closely related to the ( `` right '' ) energy function on kr crystals ) .",
    "we provide an explicit formula for the degree function of quantum ls paths in theorem  [ thm : deg - qls ] in terms of the parabolic quantum bruhat graph . for kr crystals , there exist the right and the left energy functions . in section  [ sec : degree ] , we also relate the left energy function with the degree function using the lusztig involution . in section  [ section.qalc ] the quantum alcove model and its crystal structure",
    "are defined . in section  [ section.bijection ] , we show that there is a bijection between the quantum alcove model and the quantum ls path model by exhibiting a forgetful map and its inverse .",
    "we show that up to kashiwara operators @xmath18 at the end of their strings , there is an affine crystal isomorphism between the quantum alcove model and a tensor product of kr crystals .",
    "section  [ s : energy ] contains the main application of this work : by showing that the energy / degree function under the affine crystal isomorphism maps to a height function in the quantum alcove model , we show that the graded character of a tensor product of single - column kr crystals is equal to a macdonald polynomial evaluated at @xmath1 ( see corollary  [ peqx ] ) .",
    "we conclude in section  [ sec : proofs of lemmas ] with the proof of lemmas from various sections . in appendix",
    "[ section.perfectness ] , we verify the conjectures in @xcite mentioned above , in the exceptional types .",
    "we follow the same conventions and notation as in  @xcite .",
    "we would like to thank the mathematisches forschungsinstitut oberwolfach for their support during the research in pairs program and icerm for hosting the semester program ",
    "automorphic forms , combinatorial representation theory and multiple dirichlet series \" in the spring 2013 , where some of the ideas were conceived .",
    "we thank dan orr for valuable discussions .",
    "we used sage  @xcite and sage - combinat  @xcite in our work .",
    "was partially supported by the nsf grants dms1101264 and dms1362627 .",
    "the hospitality and support of the max - planck - institut fr mathematik in bonn , where part of this work was carried out , is also gratefully acknowledged .",
    "s.n . was supported by grant - in - aid for scientific research ( c ) , no .",
    "24540010 , japan .",
    "d.s . was supported by grant - in - aid for young scientists ( b ) no.23740003 , japan .",
    "was partially supported by nsf grants dms1001256 , oci1147247 , and a grant from the simons foundation ( # 226108 to anne schilling ) .",
    "was partially supported by the nsf grant dms-1200804 .",
    "in this section we review lakshmibai - seshadri paths and the corresponding affine crystal model .",
    "as summarized in theorem  [ thm : lscl ] and remark  [ rem : lscl ] , the crystal of level - zero projected ls paths is isomorphic to kr crystals .",
    "let @xmath19 be an untwisted affine lie algebra over @xmath20 with cartan matrix @xmath21 .",
    "the index set @xmath22 of the dynkin diagram of @xmath19 is numbered as in ( * ? ? ?",
    "* section 4.8 , table aff  1 ) .",
    "take the distinguished vertex @xmath23 as in @xcite , and set @xmath24 .",
    "let @xmath25 denote the cartan subalgebra of @xmath19 , where @xmath26 is the set of simple coroots , and @xmath27 is the scaling element ( or degree operator ) . also , we denote by @xmath28 the set of simple roots , and by @xmath29 , @xmath30 , the fundamental weights ; note that @xmath31 and @xmath32 for @xmath30 .",
    "let @xmath33 and @xmath34 denote the null root and the canonical central element of @xmath19 , respectively .",
    "the dual weight lattice @xmath35 and the weight lattice @xmath36 are defined as follows : @xmath37 it is clear that @xmath36 contains @xmath38 , and that @xmath39 .",
    "we set @xmath40 .",
    "let @xmath41 be the classical subalgebra of @xmath19 and denote the finite weight lattice by @xmath42 , where @xmath43 are the fundamental weights associated to @xmath41 .",
    "the natural projection @xmath44 has kernel @xmath45 and sends @xmath46 for @xmath47 .",
    "we set @xmath48    let @xmath49 ( resp .",
    "@xmath50 ) be the affine ( resp .",
    "finite ) weyl group with simple reflections @xmath51 for @xmath52 ( resp .",
    "@xmath47 ) .",
    "@xmath49 acts on @xmath36 and @xmath35 by @xmath53 for @xmath52 , @xmath54 , and @xmath55 .",
    "we denote by @xmath56 the length function on @xmath49 ( resp .",
    "@xmath50 ) , and denote by @xmath57 the identity element of @xmath49 . note that @xmath58 ; denote by @xmath59 the image of @xmath60 in @xmath61 .",
    "the set of affine real roots ( resp .",
    "roots ) of @xmath62 ( resp .",
    "@xmath41 ) are defined by @xmath63 ( resp .",
    "@xmath64 ) .",
    "the set of positive affine real ( resp .",
    "positive ) roots are the set @xmath65 ( resp .",
    "@xmath66 ) .",
    "we have @xmath67 , where @xmath68 , and @xmath69 , where @xmath70 .",
    "we have @xmath71 , where @xmath72 is the highest root for @xmath41 , and @xmath73 for @xmath74 , let @xmath75 denote the coroot of @xmath76 , and let @xmath77 denote the associated reflection . also , we set @xmath78 .",
    "the level of a weight @xmath54 is defined by @xmath79 .",
    "since the action of @xmath49 on @xmath36 is level - preserving , the sublattice @xmath80 of level - zero elements is @xmath49-stable .",
    "there is a section @xmath81 given by @xmath82 for @xmath47 .",
    "let @xmath10 be a subset of @xmath83 . denote by @xmath84 the parabolic subgroup of @xmath50 generated by @xmath51 for @xmath85 . for @xmath86 ,",
    "we denote by @xmath87 the minimum - length coset representative in the coset @xmath88 , and set @xmath89 .",
    "we set @xmath90 , @xmath91 , and @xmath92 , @xmath93 ; note that @xmath94 .",
    "also , we set @xmath95 .",
    "finally , we briefly review the level - zero weight poset . fix a dominant weight @xmath17 in the finite weight lattice @xmath96 .",
    "we view @xmath96 as a sublattice of @xmath97 .",
    "let @xmath98 be the orbit of @xmath17 under the action of the affine weyl group @xmath49 .",
    "[ definition.level-0 weight poset ] a poset structure is defined on @xmath98 as the transitive closure of the relation @xmath99 where @xmath100 .",
    "this poset is called the _ level - zero weight poset for _ @xmath17 .      in this subsection",
    ", we fix a dominant integral weight @xmath101 .",
    "we recall the definition of lakshmibai - seshadri ( ls ) paths of shape @xmath17 from ( * ? ? ?",
    "* section 4 ) .",
    "let @xmath102 be the level - zero weight poset for @xmath17 .",
    "[ dfn : achain ] for @xmath103 with @xmath104 and @xmath105 , a @xmath106-chain for @xmath107 is , by definition , a sequence @xmath108 of covers in @xmath102 such that @xmath109 for all @xmath110 , where @xmath111 is the corresponding positive real root for @xmath112 .    [",
    "dfn : ls ] an ls path of shape @xmath17 is , by definition , a pair @xmath113 of a sequence @xmath114 of elements in @xmath102 and a sequence @xmath115 of rational numbers satisfying the condition that there exists a @xmath116-chain for @xmath117 for each @xmath118 .    denote by @xmath119 the set of all ls paths of shape @xmath17 .",
    "we identify an element @xmath120 with the following piecewise - linear , continuous map @xmath121 \\rightarrow { \\mathbb{r}}\\otimes_{{\\mathbb{z } } } x_{{\\mathrm{af}}}^{0}$ ] : @xmath122    [ rem : straight ] it follows from the definition of an ls path of shape @xmath17 that @xmath123 for every @xmath124 , which corresponds to the straight line @xmath125 , @xmath126 $ ] .    recall that @xmath127 . denote by @xmath128 the canonical projection ; remark that @xmath129 ( see ( * ? ? ? * lemma 3.1 ) ) . for @xmath130 , we define @xmath131 by : @xmath132 for @xmath126 $ ] ; note that @xmath131 is a piecewise linear , continuous map from @xmath133 $ ] to @xmath134 .",
    "then we set @xmath135 an element of this set is called a projected level - zero ls path .",
    "as in the previous subsection , let @xmath101 be a dominant integral weight .",
    "we use the following notation : @xmath136 -\\theta & \\text{if $ i = 0 $ } , \\end{cases } \\qquad s_{i}:= \\begin{cases } r_{i } & \\text{if $ i \\ne 0 $ } , \\\\[1.5 mm ] r_{\\theta } & \\text{if $ i = 0$}. \\end{cases } \\ ] ]    following @xcite , we give @xmath119 and @xmath15 crystal structures with the weight lattices @xmath137 and @xmath138 , respectively . here",
    "we focus on the crystal structure on @xmath15 ; for the crystal structure on @xmath119 , in the argument below , replace @xmath139 with @xmath130 , and then replace @xmath140 and @xmath141 with @xmath142 and @xmath143 .",
    "let @xmath139 .",
    "we see from ( * ? ? ?",
    "* lemma 4.5a ) ) that @xmath144 .",
    "so we set @xmath145 next we define root operators @xmath146 and @xmath147 for @xmath148 as follows ( see ( * ? ? ? * section 1 ) ) : set @xmath149 , \\\\[3 mm ] m = m^{\\eta}_{j }    : = \\min\\bigl\\{h^{\\eta}_{j}(t ) \\mid t \\in [ 0,1]\\bigr\\}\\;. \\end{array } \\ ] ] it follows from ( * ? ? ?",
    "* lemma 4.5d ) ) that all local minima of @xmath150 are integers ; in particular , @xmath151 . if @xmath152 , then @xmath153 , where @xmath154 is an extra element not contained in @xmath15 .",
    "if @xmath155 , then set @xmath156 \\mid          h(t)=m \\bigr\\ } , \\\\[3 mm ] t_{0}:=\\max\\bigl\\{t \\in [ 0,t_{1 } ] \\mid         h(t ) = m+1 \\bigr\\}. \\end{array } \\ ] ]    [ rem : ro ]    1 .",
    "recall that all local minima of @xmath150 are integers by ( * ? ? ?",
    "* lemma 4.5d ) ) .",
    "hence we deduce that @xmath150 is strictly decreasing on @xmath157 $ ] .",
    "because @xmath150 attains the minimum @xmath158 at @xmath159 , it follows immediately that @xmath160 for sufficiently small @xmath161 .",
    "we deduce that @xmath162 for sufficiently small @xmath161 . indeed , suppose that @xmath163 .",
    "then the minimum @xmath164 of @xmath150 on @xmath165 $ ] is less than @xmath166 . since all local minima of @xmath150 are integers",
    ", we obtain @xmath167 .",
    "however , this contradicts the definition of @xmath168 ; recall that @xmath169 .",
    "define @xmath170 for @xmath171 by : @xmath172 \\eta(t_{0})+s_{j}(\\eta(t)-\\eta(t_{0 } ) )         & \\text{if } t_{0 } \\le t \\le t_{1 } , \\\\[2 mm ] \\eta(t)+{\\widetilde{\\alpha}}_{j } & \\text{if } t_{1 } \\le t \\le 1 , \\end{cases } \\ ] ] where @xmath141 is the reflection with respect to @xmath140 .",
    "we see from ( * ? ? ?",
    "* corollary 2a ) ) that @xmath173 .",
    "the definition of @xmath174 is similar ( see also ( * ? ? ?",
    "* section 2.2 ) ) .",
    "in addition , for @xmath139 and @xmath30 , we set @xmath175 we see from ( * ? ? ?",
    "* section 2 ) that the set @xmath15 together with the map @xmath176 , the root operators @xmath146 , @xmath147 , @xmath30 , and the maps @xmath177 , @xmath30 , becomes a crystal with @xmath178 the weight lattice .",
    "it is easily verified that @xmath179    we know the following theorem from  @xcite .",
    "[ thm : lscl ]    1 .   for each @xmath180 ,",
    "the crystal @xmath181 is isomorphic to the crystal basis of @xmath182 , the level - zero fundamental representation , introduced by kashiwara @xcite .",
    "the crystal graph of @xmath15 is connected .",
    "3 .   let @xmath183 be an arbitrary sequence of elements of @xmath83 ( with repetitions allowed ) , and set @xmath184 .",
    "then , there exists an isomorphism @xmath185 of crystals .",
    "[ rem : lscl ] it is known that the fundamental representation @xmath182 of level - zero is isomorphic to the kirillov - reshetikhin ( kr ) module @xmath186 in the sense of ( * ? ? ?",
    "* section 2.3 ) ( for the drinfeld polynomials of @xmath182 , see ( * ? ? ?",
    "* remark  3.3 ) ) .",
    "also we can prove that the crystal basis of @xmath187 is unique , up to a nonzero constant multiple ( see also ( * ? ? ? * lemma 1.5.3 ) ) ; we call this crystal basis a ( one - column ) kr crystal , and denote by @xmath188 . by the theorem above",
    ", the crystal @xmath15 of projected level - zero ls paths of shape @xmath17 is a model for the corresponding tensor product of kr crystals .    in this paper",
    "we use the kashiwara convention for the tensor product . more precisely , for two ( normal ) crystals @xmath189 and @xmath190 , the tensor product @xmath191 as a set is the cartesian product of the two sets . for @xmath192 ,",
    "the weight function is simply @xmath193 . in the kashiwara convention",
    "the crystal operators are given by @xmath194 and similarly for @xmath195 , where @xmath196 and @xmath197 are defined as in .",
    "in this section , we introduce quantum lakshmibai - seshadri paths , which are defined in terms of the parabolic quantum bruhat graph .",
    "the main result of this section is theorem  [ thm : ls = qls ] , which shows that projected level - zero ls paths are qls paths . in  @xcite this",
    "is proved in a different fashion using root operators .",
    "the quantum bruhat graph was first introduced in a paper by brenti , fomin and postnikov  @xcite motivated by work of fomin , gelfand and postnikov  @xcite in type @xmath5 .",
    "it later appeared in connection with the quantum cohomology of flag varieties in a paper by fulton and woodward  @xcite .",
    "let @xmath10 be a subset of @xmath83 .",
    "we denote by @xmath198 the _ parabolic quantum bruhat graph_. its vertex set is @xmath199 .",
    "there are two kinds of directed edges .",
    "both are labeled by some @xmath200 . for @xmath201",
    ", there is a directed edge @xmath202 ( recall that @xmath203 denotes the minimum - length coset representative in the coset @xmath204 ) if @xmath205 and one of the following holds :    1 .",
    "( bruhat edge ) @xmath206 is a covering relation in bruhat order , that is , @xmath207 .",
    "( one may deduce that @xmath208 . )",
    "( quantum edge ) @xmath209    we define the _ weight _ of an edge @xmath210 in the parabolic quantum bruhat graph to be either @xmath211 or @xmath212 , depending on whether it is a quantum edge or not , respectively .",
    "then the weight of a directed path @xmath213 , denoted by @xmath214 , is defined as the sum of the weights of its edges .      in this subsection",
    ", we fix a dominant integral weight @xmath101 . set @xmath215 so that @xmath84 is the stabilizer of @xmath17 . given a rational number @xmath106 , we define @xmath216 to be the subgraph of the parabolic quantum bruhat graph @xmath217 with the same vertex set but having only the edges : @xmath218 note that @xmath219 if @xmath220 .",
    "[ dfn : qls ] a quantum lakshmibai - seshadri ( qls ) path of shape @xmath17 is a pair @xmath221 of a sequence @xmath222 of elements in @xmath223 with @xmath224 for @xmath225 and a sequence @xmath226 of rational numbers satisfying the condition that there exists a directed path from @xmath227 to @xmath228 in @xmath229 for each @xmath225 .",
    "denote by @xmath16 the set of qls paths of shape @xmath17 .",
    "we use the notation @xmath230 to indicate that there exists a directed path from @xmath231 to @xmath232 in @xmath233 ; so we can write an element @xmath234 in @xmath16 as follows : @xmath235 since @xmath199 can be identified with @xmath236 under the canonical bijection @xmath237 , we will sometimes think of the elements @xmath238 as weights .",
    "moreover , we identify @xmath239 with the following piecewise - linear , continuous map @xmath240 \\rightarrow { \\mathbb{r}}\\otimes_{{\\mathbb{z } } } x$ ] : @xmath241    [ rem : straight2 ] it follows from the definition of a qls path of shape @xmath17 that @xmath242 for every @xmath243 , which corresponds to the straight line @xmath244 , @xmath126 $ ] .",
    "we can easily see that @xmath245 for @xmath124 ; recall that @xmath129 .",
    "we now establish the correspondence between projected level - zero ls paths and qls paths .",
    "as before , @xmath246 is a fixed dominant integral weight , and @xmath247 .",
    "[ thm : ls = qls ] @xmath248 as sets of piecewise - linear , continuous maps from @xmath133 $ ] to @xmath134 ( see section  [ subsec : ls ] and .    in order to prove this theorem , we need the following lemma .    [",
    "lem : sigma ] let @xmath105 .",
    "\\(1 ) let @xmath103 .",
    "if there exists a @xmath106-chain for @xmath249 , then there exists a directed path from @xmath250 to @xmath251 in @xmath216 .",
    "\\(2 ) let @xmath252 .",
    "if there exists a directed path from @xmath253 to @xmath254 in @xmath216 , then for each @xmath255 with @xmath256 , there exists a @xmath106-chain for @xmath249 for some @xmath124 with @xmath257 .",
    "\\(1 ) it suffices to show the assertion in the case that @xmath258 is a cover of @xmath259 , i.e. , @xmath260 in @xmath102 .",
    "let @xmath74 be such that @xmath261 and @xmath262 .",
    "then , @xmath263 or @xmath264 ( see ( * ? ? ?",
    "* lemma 6.4(1 ) ) ) . set @xmath265 .",
    "if @xmath263 , then it follows from ( * ? ? ?",
    "* theorem 6.5 ) that @xmath266 and @xmath267 in @xmath217 .",
    "in addition , we see that @xmath268 , which implies that @xmath267 in @xmath216 . similarly , if @xmath264 , then it follows from ( * ? ? ?",
    "* theorem 6.5 ) that @xmath269 and @xmath267 in @xmath217 .",
    "we see that @xmath270 , which implies that @xmath267 in @xmath216 .",
    "thus we have proved part ( 1 ) .",
    "\\(2 ) fix @xmath255 such that @xmath256 .",
    "assume that @xmath271 is a directed path from @xmath253 to @xmath254 in @xmath216 .",
    "we show the assertion by induction on the length @xmath158 of the directed path above .",
    "assume first that @xmath272 ; for simplicity of notation , we set @xmath273 . set @xmath274",
    "\\delta+w\\gamma &     \\text{if $ w \\stackrel{\\gamma}{\\rightarrow } w'$ is a quantum edge}.   \\end{cases } \\ ] ] it follows from ( * ? ? ?",
    "* theorem 6.5 ) that @xmath74 and @xmath275 .",
    "also , we see that @xmath257 . in addition , @xmath276 .",
    "thus , @xmath260 is a @xmath106-chain for @xmath249 .",
    "assume that @xmath277 .",
    "by our induction hypothesis , there exists a @xmath106-chain for @xmath278 for some @xmath279 with @xmath280 .",
    "also , by our induction hypothesis , there exists a @xmath106-chain for @xmath281 for some @xmath124 with @xmath282 .",
    "concatenating these @xmath106-chains , we obtain a @xmath106-chain for @xmath249 .",
    "thus we have proved the lemma .    first , let us show that @xmath283 .",
    "let @xmath284 we show @xmath285 by induction on @xmath286 .",
    "if @xmath287 , then the assertion is obvious by remark  [ rem : straight2 ] .",
    "assume that @xmath288 .",
    "set @xmath289 then we see that @xmath290 , and hence @xmath291 by our induction hypothesis .",
    "write @xmath292 as : @xmath293 for some @xmath294 and @xmath295 ; we should remark that @xmath296 and @xmath297 .",
    "the inequality @xmath298 comes from the fact that @xmath299 for @xmath300 $ ] and @xmath301 for @xmath302 $ ] .",
    "therefore ,    1 .   if @xmath303 , then the first turning point @xmath304 of @xmath292 is equal to @xmath305 ; 2 .   if @xmath306 , then the first turning point @xmath304 of @xmath292 is greater than @xmath305 .    if @xmath307 , then it follows immediately that @xmath308 , and hence @xmath285 .",
    "assume that @xmath309 ; set @xmath310 . because there exists a @xmath311-chain for @xmath312 by the definition of an ls path",
    ", we deduce from lemma  [ lem : sigma](1 ) that there exists a directed path from @xmath297 to @xmath313 in @xmath314 . therefore , we see that @xmath315 is a qls path of shape @xmath17 , which is identical to @xmath131 .",
    "thus we obtain @xmath285 , as desired .    next , let us show the opposite inclusion , i.e. , @xmath316 .",
    "let @xmath317 we show by induction on @xmath286 that there exists @xmath130 such that @xmath318 . if @xmath287 , then the assertion is obvious by remark  [ rem : straight2 ] .",
    "assume that @xmath288 .",
    "we see that @xmath319 is contained in @xmath16 .",
    "hence , by our induction hypothesis , there exists @xmath290 such that @xmath320 .",
    "write @xmath321 as : @xmath322 for some @xmath323 and @xmath295 ; we remark that @xmath296 and @xmath324 .",
    "because there exists a directed path from @xmath325 to @xmath326 in @xmath314 , it follows from lemma  [ lem : sigma](2 ) that there exists a @xmath311-chain for @xmath327 for some @xmath328 with @xmath329 .",
    "therefore , we have @xmath330 also , it is easily seen that @xmath318 .",
    "thus we have proved the opposite inclusion , thereby completing the proof of the theorem .",
    "throughout this section , we fix a dominant integral weight @xmath101 , and set @xmath331 .",
    "we define the degree function on projected level - zero ls paths in section  [ subsec : dfn - deg ] and recall the relation with the energy function on kr crystals in theorem  [ thm : ns - deg ] . theorem  [ thm : deg - qls ] is the main result of this section and provides an explicit expression for the degree function as sums of weights of shortest paths in the parabolic quantum bruhat graph .",
    "we know the following proposition from ( * ? ? ?",
    "* proposition  8.1 ) .",
    "[ prop : weight ] let @xmath332 .",
    "let @xmath213 and @xmath333 be a shortest and an arbitrary directed path from @xmath231 to @xmath232 in @xmath217 , respectively .",
    "then there exists @xmath334 such that @xmath335 in addition , if @xmath333 is also shortest , then @xmath336 .",
    "let @xmath332 .",
    "by proposition  [ prop : weight ] , the pairing of @xmath17 and the weight of a shortest directed path from @xmath231 to @xmath232 does not depend on the choice of a shortest directed path from @xmath231 to @xmath232 in @xmath217 ; we denote this pairing by @xmath337 .",
    "the following is a corollary to ( * ? ? ?",
    "* lemma 7.7 ) ; for @xmath338 and @xmath339 , see .",
    "[ cor : weight ] let @xmath340 , and @xmath30 .",
    "\\(1 ) if @xmath341 and @xmath342 , then @xmath343    \\(2 ) if @xmath344 and @xmath345 , then @xmath346    \\(3 ) if @xmath347 and @xmath345 , then @xmath348    we give a proof only for part ( 1 ) ; the proofs for parts ( 2 ) and ( 3 ) are similar .",
    "let @xmath213 be a shortest directed path from @xmath349 to @xmath350 .",
    "then it follows from ( * ? ? ?",
    "* lemma 7.7(3 ) and ( 5 ) ) that there exists a shortest directed path @xmath351 from @xmath352 to @xmath353 such that @xmath354 hence , @xmath355 thus we have proved the corollary .",
    "let us recall from ( * ? ? ?",
    "* section 3.1 ) the definition of the degree function @xmath356 denote by @xmath357 the connected component of @xmath119 containing the straight line @xmath358 .",
    "also , for @xmath359 , we set @xmath360 , and call it the initial direction of @xmath361 ; note that @xmath362 for sufficiently small @xmath161 .",
    "we know from ( * ? ? ?",
    "* proposition 3.1.3 ) that for each @xmath139 , there exists a unique @xmath363 satisfying the conditions that @xmath364 and @xmath365 ; recall that @xmath366 .",
    "then it follows from ( * ? ? ?",
    "* lemma 3.1.1 ) that @xmath367 is of the form : @xmath368 for some @xmath369 and @xmath370 .",
    "we define the degree @xmath371 of @xmath139 by : @xmath372    [ rem : degree ] it is known ( see , e.g. , ( * ? ? ?",
    "* proposition 4.3.1 ) ) that for each @xmath139 , there exist @xmath373 such that @xmath374 ; recall from remark  [ rem : straight2 ] that @xmath375 .",
    "therefore , we deduce from ( * ? ? ?",
    "* lemma 3.2.1 ) that @xmath376 is a unique function satisfying the following conditions :    \\(i ) @xmath377 ;    \\(ii ) for @xmath139 and @xmath30 with @xmath378 , @xmath379   { \\mathop{\\rm deg}\\nolimits}(\\eta)-{\\langle { \\widetilde{\\alpha}}_{0}^{\\vee},\\,\\iota(\\eta ) \\rangle}-1     & \\text{\\rm if $ j=0 $ and       $ \\iota(e_{0}\\eta)=s_{0}(\\iota(\\eta))$ } , \\\\[1.5 mm ]   { \\mathop{\\rm deg}\\nolimits}(\\eta ) & \\text{\\rm if $ j \\ne 0 $ } ,   \\end{cases } \\ ] ] where @xmath380 for sufficiently small @xmath161 .",
    "write @xmath17 as @xmath381 , with @xmath382 . by theorem  [ thm : lscl](3 ) , there exists an isomorphism @xmath383 of crystals .",
    "here we should recall from remark  [ rem : lscl ] that @xmath181 is isomorphic to the one - column kr crystal @xmath188 .",
    "also , recall from section  [ subsec : crystal ] that we are using the kashiwara convention for tensor products in this paper .",
    "so , following ( * ? ? ?",
    "* section 3 ) and ( * ? ? ?",
    "* section 3.3 ) ( see also  @xcite and  ( * ? ? ?",
    "* section 4.1 ) ) , we define the energy function @xmath384 on @xmath385 as follows . first , for each @xmath386 , there exists a unique isomorphism ( called a combinatorial @xmath11-matrix ) @xmath387 of crystals .",
    "also , there exists a unique @xmath388-valued function ( called a local energy function ) @xmath389 satisfying the following conditions ( h1 ) and ( h2 ) :    ( h1 ) for @xmath390 and @xmath30 such that @xmath391 , @xmath392 & \\hspace*{10 mm } \\begin{cases } h_{k , l}(\\eta_{k } \\otimes \\eta_{l})+1 & \\\\[1 mm ] \\hspace*{5 mm } \\text{\\rm if $ j=0 $ , and if     $ e_{0}(\\eta_{k } \\otimes \\eta_{l})=      e_{0}\\eta_{k } \\otimes \\eta_{l}$ ,     $ e_{0}({\\widetilde{\\eta}}_{l } \\otimes { \\widetilde{\\eta}}_{k})=      e_{0}{\\widetilde{\\eta}}_{l } \\otimes { \\widetilde{\\eta}}_{k}$ , } & \\\\[3 mm ] h_{k , l}(\\eta_{k } \\otimes \\eta_{l})-1 & \\\\[1 mm ] \\hspace*{5 mm } \\text{\\rm if $ j=0 $ , and if     $ e_{0}(\\eta_{k } \\otimes \\eta_{l})=      \\eta_{k } \\otimes e_{0}\\eta_{l}$ ,      $ e_{0}({\\widetilde{\\eta}}_{l } \\otimes { \\widetilde{\\eta}}_{k})=      { \\widetilde{\\eta}}_{l }",
    "\\otimes e_{0}{\\widetilde{\\eta}}_{k}$ , } & \\\\[3 mm ] h_{k , l}(\\eta_{k } \\otimes \\eta_{l } )   \\hspace{10 mm } \\text{\\rm otherwise } , &   \\end{cases } \\ ] ] where we set @xmath393 .",
    "( h2 ) @xmath394 .",
    "now , for each @xmath395 , there exists a unique isomorphism @xmath396 of crystals , which is given by composition of combinatorial @xmath11-matrices .",
    "given @xmath397 , we define @xmath398 to be the first factor of the image of @xmath399 under the above isomorphism of crystals . for convenience , we set @xmath400 for @xmath401 , @xmath402 .",
    "in addition , for each @xmath403 , take ( and fix ) an arbitrary element @xmath404 such that @xmath405 for all @xmath406 .",
    "then we define the energy function @xmath407 by : @xmath408    we know the following theorem from ( * ? ? ?",
    "* theorem 4.1.1 ) .",
    "[ thm : ns - deg ] using the same notation as above , we have @xmath409 where @xmath410 is a constant defined by @xmath411      let @xmath139 . because @xmath248 by theorem  [ thm : ls = qls ] , we can write @xmath239 as : @xmath412 for some @xmath413 and @xmath414 ; note that @xmath415 .",
    "[ thm : deg - qls ] with the same notation as above , we have @xmath416    for @xmath417 , we define @xmath418 to be the right - hand side of .",
    "it suffices to show that @xmath419 satisfies conditions ( i ) and ( ii ) in remark  [ rem : degree ] , i.e. ,    \\(i ) @xmath420 ;    \\(ii ) for @xmath139 and @xmath30 with @xmath378 , @xmath421   f(\\eta)-{\\langle { \\widetilde{\\alpha}}_{0}^{\\vee},\\,\\iota(\\eta ) \\rangle}-1     & \\text{\\rm if $ j=0 $ and       $ \\iota(e_{0}\\eta)=s_{0}(\\iota(\\eta))$ } , \\\\[1.5 mm ]   f(\\eta ) & \\text{\\rm if $ j \\ne 0$}.   \\end{cases}\\ ] ] it is obvious that @xmath419 satisfies condition ( i ) .",
    "let us show that @xmath419 satisfies condition ( ii ) .",
    "let @xmath139 and @xmath30 be such that @xmath378 .",
    "we see that the point @xmath422",
    "\\mid          h^{\\eta}_{j}(t)=m^{\\eta}_{j}\\bigr\\}$ ] is equal to @xmath423 for some @xmath424 .",
    "let @xmath425 be such that @xmath426 ; recall that @xmath427 \\mid         h^{\\eta}_{j}(t)=m^{\\eta}_{j}+1\\bigr\\}$ ] .",
    "it follows from the definition of the root operator @xmath146 that @xmath428 can be written as follows : @xmath429 here , if @xmath430 , then we drop ( a ) from the above ; note that in this case , @xmath431 since @xmath432 and @xmath433 by remark  [ rem : ro](1 ) , ( 3 ) .",
    "also , if @xmath434 , then we replace ( b ) by @xmath435 ( or @xmath436 ) in the above .",
    "we see from the definition of the root operator @xmath146 that @xmath437 if and only if @xmath438 ; in this case , @xmath439 ( see ) since @xmath440 .",
    "now , by the definition of @xmath419 , we have @xmath441 & \\qquad + \\underbrace{(1-b_{p}){{\\mathop{\\rm wt}\\nolimits}_{\\lambda } ( x_{p+1 }   \\rightarrow   { \\lfloor s_{j}x_{p } \\rfloor } ) } } _ { = : u_3 } + \\sum_{k = p+1}^{s-1 }   ( 1-b_{k } ) { { \\mathop{\\rm wt}\\nolimits}_{\\lambda}(x_{k+1 } \\rightarrow x_{k } ) } \\biggr\\ } ,   \\end{split } \\ ] ] where @xmath442 \\hspace*{15 mm }   + ( 1-t_0){{\\mathop{\\rm wt}\\nolimits}_{\\lambda}({\\lfloor s_{j}x_{q } \\rfloor } \\rightarrow x_{q } ) } &    \\text{if $ t_{0 } \\ne b_{q-1}$ } , \\\\[3 mm ]   ( 1-b_{q-1}){{\\mathop{\\rm wt}\\nolimits}_{\\lambda}({\\lfloor s_{j}x_{q } \\rfloor } \\rightarrow x_{q-1 } ) } &    \\text{if $ q > 1 $ and $ t_{0 } = b_{q-1}$ } , \\\\[3 mm ] 0 &   \\text{if $ q=1 $ and $ t_{0 } = b_{0 } = 0 $ } ; \\end{cases } \\ ] ] if @xmath443 ( resp . , @xmath444 ) , then @xmath445 in @xmath446 ( resp .",
    ", @xmath447 in @xmath11 ) is understood to be @xmath212 ; notice that the equality is valid even when @xmath434 .",
    "also , observe that in , @xmath448    note that if @xmath449 and @xmath450 ( in the second case of ) , then @xmath451 indeed , note that @xmath432 and @xmath433 by remark  [ rem : ro](1 ) , ( 3 ) .",
    "therefore , applying corollary  [ cor : weight](1 ) to @xmath452 and @xmath453 , we see that @xmath454 as desired . by combining and ,",
    "we obtain @xmath455 0 & \\text{if $ t_{0 } = 0$}. \\end{cases } \\ ] ]    recall that the function @xmath456 is strictly decreasing on @xmath157 $ ] ( see remark  [ rem : ro](1 ) ) , which implies that @xmath457 for all @xmath458 .",
    "hence , by corollary  [ cor : weight](2 ) , we have @xmath459 for each @xmath460 . from this , we see that @xmath461 & = \\sum_{k = q}^{p-1 } ( 1-b_{k } ) { { \\mathop{\\rm wt}\\nolimits}_{\\lambda}(x_{k+1 } \\rightarrow x_{k } ) }   + \\delta_{j,\\,0 }    ( 1-b_{q}){\\langle { \\widetilde{\\alpha}}_{j}^{\\vee},\\,x_{q}\\lambda \\rangle } \\nonumber \\\\ & \\hspace*{20 mm } - \\delta_{j,\\,0}\\sum_{k = q+1}^{p-1 }    ( b_{k}-b_{k-1 } )    { \\langle { \\widetilde{\\alpha}}_{j}^{\\vee},\\,x_{k}\\lambda \\rangle } -   \\delta_{j,\\,0}(1-b_{p-1 } ) { \\langle { \\widetilde{\\alpha}}_{j}^{\\vee},\\,x_{p}\\lambda \\rangle}.   \\label{eq : u2}\\end{aligned}\\ ] ]    finally , let us show that @xmath462 where if @xmath443 , then @xmath463 is understood to be @xmath212 . if @xmath443 , then the equality obviously holds",
    "assume that @xmath464 .",
    "then , since @xmath465 and @xmath466 by remark  [ rem : ro](2 ) , the equality follows immediately from corollary  [ cor : weight](3 ) ( applied to @xmath467 and @xmath468 ) .    substituting , ,",
    "into , we conclude that @xmath469 where @xmath470 \\delta_{j,\\,0 } { \\langle { \\widetilde{\\alpha}}_{j}^{\\vee},\\,x_{1}\\lambda \\rangle}= \\delta_{j,\\,0 } { \\langle { \\widetilde{\\alpha}}_{j}^{\\vee},\\,\\iota(\\eta ) \\rangle }    & \\text{if $ t_{0 } = 0$}. \\end{cases } \\ ] ] here , observe that @xmath471 thus we have shown that @xmath419 satisfies , thereby completing the proof of theorem  [ thm : deg - qls ] .",
    "let @xmath472 be the longest element in @xmath50 , and let @xmath473 be the dynkin diagram automorphism for @xmath41 induced by @xmath474 , i.e. , @xmath475 for @xmath406 .",
    "note that @xmath476 acts as @xmath477 on the integral weight lattice @xmath96 and also on the cartan subalgebra @xmath478 of @xmath41 .",
    "then , @xmath479 , and @xmath480 on @xmath96 , and on @xmath478 for @xmath406 .",
    "there exists a group automorphism , denoted also by @xmath476 , of the weyl group @xmath50 such that @xmath481 for all @xmath406 ; notice that @xmath482 for @xmath483 , and @xmath484 for @xmath485 .",
    "[ lem : da ]    1 .   if @xmath486 , then @xmath487 .",
    "2 .   let @xmath106 be a rational number .",
    "for @xmath488 and @xmath489 , @xmath490 where @xmath491 and @xmath492 are the longest elements in @xmath493 and @xmath494 , respectively .",
    "in addition , the types ( i.e. , bruhat or quantum ) of these four edges coincide .",
    "3 .   for every @xmath488 ,",
    "@xmath495    part ( 1 ) is obvious .",
    "part ( 2 ) follows from part ( 1 ) and ( * ? ? ?",
    "* proposition  4.3 ) , together with the fact that @xmath496 for all @xmath483 . part ( 3 ) follows from part ( 2 ) since @xmath497 and @xmath498 .",
    "now , let @xmath499 with @xmath500 and rational numbers @xmath501 .",
    "then we see from lemma  [ lem : da ] that @xmath502 is a qls path of shape @xmath503 ; note that the stabilizer of the dominant integral weight @xmath503 in @xmath50 is identical to the parabolic subgroup @xmath494 . because @xmath504 for @xmath126 $ ] , it follows from ( * ? ? ?",
    "* lemma 2.1e ) ) that @xmath505 for @xmath139 and @xmath30 .",
    "next , for @xmath417 of the form , we define @xmath506 by : @xmath507 we can easily check by using lemma  [ lem : da ] that @xmath506 is a qls path of shape @xmath503 . since @xmath508 for @xmath126 $ ] , we see that @xmath509 for @xmath139 and @xmath30 .",
    "finally , we set @xmath510 for each @xmath511 ; by the argument above , we see that @xmath512 .",
    "moreover , it is easily checked that @xmath513 is an involution on @xmath15 , which we call the _ lusztig involution _",
    "( see also  @xcite for the affine version of the lusztig involution in type @xmath514 ) , such that @xmath515 for @xmath139 and @xmath30 .",
    "we remark that if @xmath239 is of the form , then @xmath516    [ cor : tail ] let @xmath517 . then , @xmath518    it follows from theorem  [ thm : deg - qls ] and   that @xmath519 also , by lemma  [ lem : da](3 ) , we have @xmath520 for all @xmath225 .",
    "this proves the corollary .    as in section [ subsec : deg - ene ] , we write @xmath17 as @xmath381 , with @xmath382 , and let @xmath521 be the isomorphism of crystals ; recall again that @xmath522 as crystals .",
    "also , let @xmath523 be the isomorphism of crystals in theorem  [ thm : lscl ] .",
    "furthermore , we define @xmath524 by : @xmath525 for @xmath526 .",
    "then we deduce that @xmath527 for @xmath528 and @xmath30 . by the connectedness of the crystals ( see theorem  [ thm : lscl](2 ) , ( 3 ) ) and , , we have the following commutative diagram : @xmath529 the next corollary follows immediately from theorem  [ thm : ns - deg ] ( applied to @xmath530 ) and the commutative diagram above .",
    "[ cor : taile ] for each @xmath139 , @xmath531    [ rem : lr ]",
    "the energy function @xmath532 in section  [ subsec : deg - ene ] corresponds to the `` right '' energy function @xmath533 in ( * ? ? ?",
    "* section 2.4 ) ; we should remark that the order of tensor products of crystals in @xcite is `` opposite '' to that in this paper .",
    "hence the composite @xmath534 corresponds to the `` left '' energy function @xmath535 in ( * ? ? ?",
    "* section 2.4 ) .",
    "now let us recall the _ quantum alcove model _  @xcite . throughout this section",
    ", we refer to roots and weights in the corresponding finite lattices .",
    "fix a dominant integral weight @xmath246 .",
    "we say that two alcoves are adjacent if they are distinct and have a common wall . given a pair of adjacent alcoves @xmath5 and @xmath536",
    ", we write @xmath537 for @xmath538 if the common wall is orthogonal to @xmath76 and @xmath76 points in the direction from @xmath5 to @xmath536 .",
    "recall that alcoves are separated by hyperplanes of the form @xmath539 where @xmath540 .",
    "we denote by @xmath541 the affine reflection in this hyperplane .",
    "an _ alcove path _ is a sequence of alcoves @xmath542 such that @xmath543 and @xmath544 are adjacent , for @xmath545 we say that @xmath542 is _ reduced _ if it has minimal length among all alcove paths from @xmath546 to @xmath547 .",
    "let @xmath548 be the translation of the fundamental alcove @xmath549 by the weight @xmath17 .",
    "the fundamental alcove is defined as @xmath550    the sequence of roots @xmath551 is called a _ @xmath17-chain _ if @xmath552 is a reduced alcove path .",
    "a reduced alcove path @xmath553 can be identified with the corresponding total order on the hyperplanes @xmath554 , to be called @xmath17-hyperplanes , which separate @xmath555 from @xmath556 ( i.e. , are subject to @xmath557 and @xmath558 ) ; we refer here to the sequence @xmath559 for @xmath560 , where @xmath559 contains the common wall of @xmath561 and @xmath562 .",
    "note also that a @xmath17-chain @xmath563 determines the corresponding reduced alcove path .",
    "indeed , we can recover the corresponding sequence @xmath564 , to be called the height sequence , by setting @xmath565 .",
    "therefore , we will sometimes refer to the sequence of @xmath17-hyperplanes considered above as a @xmath17-chain .",
    "an alcove path corresponds to the choice of a reduced word for the affine weyl group element sending @xmath555 to @xmath556 ( * ? ? ?",
    "* lemma 5.3 ) .",
    "another equivalent definition of an alcove path/@xmath17-chain , based on a root interlacing condition which generalizes a similar condition characterizing reflection orderings , can be found in  ( * ? ? ?",
    "* definition 4.1 and proposition 10.2 ) .",
    "we will work with a special choice of a @xmath17-chain in  ( * ? ? ?",
    "* section 4 ) , which we now recall .",
    "[ speciallch ] given a total order @xmath566 on the set of dynkin nodes , one may express a coroot @xmath567 in the @xmath568-basis of simple coroots . consider the total order on the set of @xmath17-hyperplanes defined by the lexicographic order on their images in @xmath569 under the map @xmath570 this map is injective , thereby endowing the set of @xmath17-hyperplanes with a total order , which is a @xmath17-chain .",
    "we call it the _ lexicographic ( lex ) @xmath17-chain_.    the objects of the quantum alcove model are defined next .",
    "[ def : admissible ] given a @xmath17-chain @xmath571 , a subset @xmath572 of @xmath573:=\\{1,\\ldots , m\\}$ ] ( possibly empty ) is an _ admissible subset _ if we have the following path in the quantum bruhat graph @xmath574 on @xmath50 : @xmath575 the weight of @xmath5 ( not necessarily admissible ) is defined by @xmath576 we let @xmath577 be the collection of all admissible subsets of @xmath573 $ ] .",
    "[ spec ] if we restrict to admissible subsets for which the path has no down steps , we recover the classical alcove model in  @xcite .      we continue to use the notation in section  [ section.qalc ] .",
    "fix a @xmath17-chain @xmath578 and the corresponding reduced alcove path @xmath542 . in this subsection",
    ", we recall from @xcite the construction of ( combinatorial ) root operators in the quantum alcove model , namely on the collection @xmath579 of admissible subsets of @xmath573 $ ] .",
    "let @xmath572 be an arbitrary subset of @xmath573 $ ] .",
    "the elements of @xmath5 are called _ folding positions_. we `` fold '' the reduced alcove path @xmath542 in the hyperplanes corresponding to these positions and obtain a `` folded alcove path '' ; this can be recorded by a sequence of roots , namely @xmath580 ; here @xmath581 with @xmath582 the largest folding position less than @xmath583 .",
    "we define @xmath584 . upon folding ,",
    "the hyperplane separating the alcoves @xmath561 and @xmath562 is mapped to @xmath585 for some @xmath586 , which is defined by this relation .",
    "here we write @xmath587 , where @xmath588 is the sign of the root @xmath589 .",
    "given @xmath590 $ ] and @xmath591 , we will use the following notation : @xmath592 \\ , | \\ , \\gamma_i = \\pm \\alpha \\right\\}\\ , , \\qquad       \\widehat{i}_\\alpha = \\widehat{i}_{\\alpha}(a):= i_{\\alpha } \\cup \\{\\infty\\}\\,,\\ ] ] and @xmath593 .",
    "the following graphical representation of the heights @xmath594 for @xmath595 and @xmath596 is useful for defining the root operators .",
    "let @xmath597 if @xmath598 , we define the continuous piecewise linear function @xmath599 \\to { \\mathbb r}$ ] by @xmath600 if @xmath601 , we define @xmath602 to be the graph obtained by reflecting @xmath603 in the @xmath231-axis . by ( * ? ? ?",
    "* propositions 5.3 and 5.5 ) , for any @xmath589 we have @xmath604    let @xmath5 now be an admissible subset , so @xmath605 .",
    "fix @xmath606 in @xmath22 , so @xmath607 is a simple root if @xmath608 , or @xmath609 if @xmath610 , see . let @xmath611 be the maximum of @xmath612 .",
    "let @xmath158 be the minimum index @xmath583 in @xmath613 for which we have @xmath614 .",
    "it was proved in @xcite that , if @xmath615 , then either @xmath616 or @xmath617 ; furthermore , if @xmath618 , then @xmath158 has a predecessor @xmath619 in @xmath613 , and we have @xmath620 .",
    "we define @xmath621 now we define @xmath622",
    ". again let @xmath623 .",
    "assuming that @xmath624 , let @xmath619 be the maximum index @xmath583 in @xmath625 for which we have @xmath614 , and let @xmath158 be the successor of @xmath619 in @xmath613 .",
    "assuming also that @xmath615 , it was proved in  @xcite that @xmath626 , and either @xmath627 or @xmath617 .",
    "define @xmath628 in the above definitions , we use the convention that @xmath629 . for an example",
    ", we refer to  ( * ? ? ?",
    "* examples 3.63.7 ) .    the following theorem about the ( combinatorial ) root operators was proved in @xcite .",
    "[ theorem : admissible ]    1 .",
    "if @xmath5 is an admissible subset and if @xmath630 , then @xmath631 is also an admissible subset .",
    "similarly for @xmath632 .",
    "moreover , @xmath633 if and only if @xmath634 .",
    "we have @xmath635 .",
    "moreover , if @xmath615 , then @xmath636 while otherwise @xmath637 .",
    "[ changepath ] let @xmath638 be an admissible subset , and @xmath639 .",
    "let @xmath640 be as in the above definition of @xmath631 , assuming @xmath641 . now assume that @xmath642 , and let @xmath643 be such that @xmath644 if @xmath645 or @xmath646 , then the corresponding indices @xmath647 , respectively @xmath648 , are missing . in the proof of theorem  [ theorem : admissible ] in @xcite , it was shown that @xmath649 has the effect of changing the path in the quantum bruhat graph @xmath650 corresponding to @xmath5 into the following path corresponding to @xmath631 : @xmath651 where @xmath652 is the simple reflection @xmath653 if @xmath608 , or @xmath654 if @xmath610 , see .",
    "the case @xmath617 is similar .",
    "the main result of this section is the crystal isomorphism between the qls paths of section  [ sec : qls ] and the quantum alcove model of section  [ section.qalc ] as stated in theorem  [ qalc2qls ] .",
    "fix a dominant integral weight @xmath17 , and set @xmath247 .",
    "recall from sections [ subsec : qls ] and [ objmod ] the notation related to qls paths and the quantum alcove model , respectively .",
    "we will now define a forgetful map from the quantum alcove model based on a lex @xmath17-chain @xmath655 ( see proposition  [ speciallch ] ) , namely from @xmath656 , to the set @xmath657 of qls paths of shape @xmath658 .",
    "given an index @xmath659 $ ] , we let @xmath660 , where @xmath661 is the height defined in section  [ section.qalc ] .",
    "note that @xmath662 , by the definition of @xmath663 .",
    "consider an admissible subset @xmath664 , and let @xmath665 let @xmath666 be such that @xmath667 if and only if @xmath668 , for @xmath669 .",
    "define weyl group elements @xmath670 for @xmath671 and @xmath672 for @xmath669 by @xmath673 , @xmath674 , and @xmath675 . for any @xmath676 ,",
    "we have the following directed path in the quantum bruhat graph @xmath574 : @xmath677 we claim that this is a directed path in @xmath678 .",
    "indeed , for @xmath679 , we have @xmath680 by the definition of @xmath681 . by lemma  [ q2ls ]",
    "below , for each edge @xmath682 in the path  , there is a directed path from @xmath683 to @xmath684 in @xmath685 . concatenating these directed paths in @xmath685 , we obtain a directed path from @xmath686 to @xmath687 in @xmath685",
    ". hence it follows from lemma  [ lem : da ] that there is a directed path from @xmath688 to @xmath689 in @xmath690 ; note that @xmath503 .",
    "thus we conclude that @xmath691 is a qls path of shape @xmath658 .",
    "we denote this qls path of shape @xmath658 by @xmath692 , and the dual qls path of shape @xmath17 defined in section  [ subsec : lusztig ] by @xmath693 ; that is , @xmath694 is of the form : @xmath695 and we have the following commutative diagram : @xmath696 we now state lemma  [ q2ls ] , which is the main ingredient in the above construction .",
    "we need the @xmath106-bruhat order on @xmath49 , denoted @xmath697 , which is defined by a condition completely similar to   applied to the covers in @xmath49 .",
    "this lemma will be proved in section  [ sq2ls ] below .",
    "[ q2ls ] let @xmath698 be an edge in @xmath699 for some rational number @xmath106 , which is viewed as a path @xmath333 .",
    "then there exists a path @xmath213 from @xmath700 to @xmath701 in @xmath233 ( possibly of length @xmath212 ) , such that @xmath702 .    1 .",
    "the special case of the lemma corresponding to the @xmath106-bruhat order on @xmath50 and @xmath199 ( i.e. , the subgraphs of @xmath699 and @xmath233 with no quantum edges ) was proved in ( * ? ? ?",
    "* lemma 4.16 ) . for @xmath703 ,",
    "i.e. , the usual bruhat order , the latter result is well - known ; see , e.g. , ( * ? ? ?",
    "* proposition 2.5.1 ) .",
    "2 .   based on the strong connectivity of the quantum bruhat graph ( cf .",
    "theorem [ thm : shell ] below ) , the lemma implies the same property for the parabolic quantum bruhat graph .",
    "note that this was proved by different methods ( and , in fact , in a slightly stronger form ) in  ( * ? ? ?",
    "* lemma 6.12 ) .",
    "next we prove that the forgetful map in section [ s : forget ] , from the quantum alcove model to quantum ls paths , is a bijection , by exhibiting the inverse map .",
    "we will use the _ shellability _ of the quantum bruhat graph @xmath574 with respect to a reflection ordering on the positive roots  @xcite , which we now recall .",
    "[ thm : shell ] fix a reflection ordering on @xmath704 .    1 .   for any pair of elements @xmath705",
    ", there is a unique path from @xmath706 to @xmath253 in the quantum bruhat graph @xmath574 such that its sequence of edge labels is strictly increasing ( resp . , decreasing ) with respect to the reflection ordering . 2 .",
    "the path in ( 1 ) has the smallest possible length @xmath707 and is lexicographically minimal ( resp .",
    ", maximal ) among all shortest paths from @xmath706 to @xmath253 .    in ( * ? ? ?",
    "* section 4.3 ) , we constructed a reflection ordering @xmath708 on @xmath704 which depends on @xmath17 .",
    "the bottom of the order @xmath708 consists of the roots in @xmath709 . for two such roots @xmath589 and @xmath76 ,",
    "define @xmath710 whenever the hyperplane @xmath711 precedes @xmath712 in the lex @xmath17-chain ( see proposition  [ speciallch ] ) .",
    "this forms an _ initial section _",
    "@xcite of @xmath708 .",
    "the top of the order @xmath708 consists of the positive roots for the weyl group @xmath84 , and we fix any reflection ordering for them .",
    "we refer to the reflection ordering @xmath708 throughout this section .    given a @xmath17-hyperplane @xmath554 , we call the first component of the vector associated with it in  , namely @xmath713 , the _ relative height _ of @xmath554",
    ". it is not hard to see that , in the lex @xmath17-chain , the order on the @xmath17-hyperplanes @xmath554 with the same relative height is given by the order @xmath708 on the corresponding roots @xmath76 .",
    "we will use this fact implicitly below .",
    "recall from  ( * ? ? ?",
    "* proposition 7.2 ) that there exists a unique element @xmath714 such that @xmath715 attains its minimum value as a function of @xmath716 , for fixed @xmath705 .",
    "we refer also to  ( * ? ? ?",
    "* theorem 7.1 ) , stating that the mentioned minimum is , in fact , attained by the minimum of the coset @xmath717 with respect to the _ @xmath706-tilted bruhat order _",
    "@xmath718 on @xmath50  @xcite ; therefore , it makes sense to denote it by @xmath719 , although we will not use this stronger result .",
    "[ l : mainb ] consider @xmath720 and @xmath721 .",
    "write @xmath722 as : @xmath723 , with @xmath724 .    1 .",
    "there is a unique path in @xmath574 from @xmath725 to some @xmath726 whose edge labels are increasing and lie in @xmath709 .",
    "this path ends at @xmath727 .",
    "2 .   assume that there is a path from @xmath728 to @xmath729 in @xmath233 for some @xmath730 .",
    "then the path in ( 1 ) from @xmath725 to @xmath727 is in @xmath699 .",
    "the first part is just the content of  ( * ? ? ?",
    "* lemmas 7.4 and 7.5 ) , based on the results recalled above . for the second part , we start by considering a second path in @xmath574 from @xmath725 to @xmath727 , beside the one given by ( 1 ) . this path is formed by concatenating the following :    * a path from @xmath725 to @xmath728 with only quantum edges and all edge labels in @xmath731 ( for instance simple roots in @xmath732 ) ; * a path from @xmath728 to @xmath729 constructed from the path in @xmath198 between the same two elements by replacing each edge @xmath733 with @xmath734 ( cf .",
    "* condition ( @xmath735 ) in section 4.2 ) ) followed by a path from @xmath736 to @xmath737 with only quantum edges and all edge labels in @xmath731 ( for instance simple roots in @xmath732 ) ; * a path from @xmath729 to @xmath727 with only bruhat edges and all edge labels in @xmath731 .    by theorem [ thm : shell ]  ( 2 ) , we know that the first of the two paths above is a shortest one ( from @xmath725 to @xmath727 ) . furthermore , by the hypothesis , the second path is in @xmath699 ( any edge in @xmath574 labeled by a root in @xmath731 is by default in @xmath699 ) .",
    "so we can apply lemma [ bqbpaths ] below and deduce that the first path is also in @xmath699 .",
    "let us now state lemma [ bqbpaths ] , which will be proved in section [ sbqbpaths ] below .",
    "[ bqbpaths ] consider two paths in @xmath574 between some @xmath706 and @xmath253 .",
    "assume that the first one is a shortest path , while the second one is in @xmath699 , for some rational number @xmath106 .",
    "then the first path is in @xmath699 as well .",
    "we now construct the inverse of the forgetful map in section [ s : forget ] .",
    "we begin with a qls path in @xmath657 , which is written in the form @xmath738 where @xmath739 , and @xmath740 .",
    "set @xmath741 ; we see from lemma  [ lem : da ] that @xmath742 we will now associate with it an admissible subset ( see definition [ def : admissible ] ) , i.e. , a lex increasing sequence of @xmath17-hyperplanes , and the corresponding path in @xmath574 defined in .",
    "we start by defining the sequence @xmath743 in @xmath50 recursively by @xmath744 , and by @xmath745 for @xmath746 .",
    "note that @xmath747 .",
    "for each @xmath746 , consider the unique path in @xmath574 with increasing edge labels ( with respect to @xmath708 , cf .",
    "theorem [ thm : shell ] ) from @xmath748 to @xmath749 .",
    "note that the path corresponding to @xmath750 is , in fact , a saturated chain in the bruhat order on @xmath199 . by and lemma [ l : mainb ] , for any @xmath583",
    ", the edges of the corresponding path are in @xmath751 and no edge label is in @xmath731 .",
    "we define the path in the quantum alcove model corresponding to the qls path by concatenating the paths constructed above , for @xmath746 .",
    "the corresponding sequence of @xmath17-hyperplanes is defined by associating with a label @xmath76 in the path from @xmath748 to @xmath749 the @xmath17-hyperplane @xmath752 ; this is indeed a @xmath17-hyperplane : @xmath753 is an integer , and we have @xmath754 , as @xmath755 and @xmath756 , so @xmath757 . the constructed sequence of @xmath17-hyperplanes is lex increasing because the sequence @xmath758 is increasing and the edge labels in the path from @xmath748 to @xmath749 increase ( with respect to @xmath708 ) .",
    "so we constructed an admissible sequence , which is now associated with the qls path in  .",
    "[ proposition.bijqls ] the forgetful map @xmath759 is a weight - preserving bijection from @xmath760 to @xmath761 .",
    "we need to show that the maps in sections  [ s : forget ] and  [ s : invmap ] are mutually inverse .",
    "the crucial fact to check is that the map @xmath762 followed by the backward one is the identity .",
    "this follows from the uniqueness part in lemma [ l : mainb ]  ( 1 ) .",
    "it remains to prove that the map @xmath763 preserves weights .",
    "we proceed by induction on the cardinality of @xmath764 .",
    "note that the assertion is obvious if @xmath765 .",
    "now , let us take @xmath766 , and set @xmath767 .",
    "then , by , the qls path @xmath768 is of the form : @xmath769 in the notation of section  [ s : forget ] , with @xmath770 instead of @xmath286 ; note that @xmath771 and @xmath772 .",
    "moreover , noting that @xmath773 , we deduce that the qls path @xmath694 is of the form : @xmath774 w_{p}r_{\\beta_{j_s } }   { \\xleftarrow{(1-t_{j_s})\\lambda } } w_{p } { \\xleftarrow{(1-b_p)\\lambda } } w_{p-1 }   { \\xleftarrow{(1-b_{p-1})\\lambda } } \\cdots   { \\xleftarrow{(1-b_1)\\lambda } } w_{0 }   & \\text{if $ t_{j_s } > b_{p}$}.   \\end{cases } \\ ] ] from this , by direct calculation using , we can show that in both cases above , @xmath775 thus obtaining a relation between @xmath776 and @xmath777 .",
    "if we set @xmath778 then we have @xmath779 for all @xmath780 , where @xmath781 and @xmath782 is an element of @xmath783 .",
    "it follows that by , @xmath784 also , we have @xmath785 therefore , again by , we see that @xmath786 since @xmath787 by the definition of @xmath788 , we conclude that @xmath789 thus obtaining the same relation between @xmath790 and @xmath791 as the one between @xmath792 and @xmath793 .",
    "this proves that @xmath794 by induction on @xmath286 .",
    "we will now prove that , up to the @xmath18 arrows at the end of a string , we can view @xmath760 as a model for the tensor product of kr crystals @xmath795 via the bijection @xmath796 , see ; @xmath797    let @xmath798 be an arrow in @xmath795 .",
    "it is called a _ demazure arrow _ if @xmath799 , or @xmath750 and @xmath800 .",
    "it is called a _ dual demazure arrow _ if @xmath799 , or @xmath750 and @xmath801 .",
    "[ perfect ] in the case when all of the tensor factors of @xmath795 are perfect crystals ( see definition [ def : perfect ] ) , the subgraph of @xmath795 consisting of the dual demazure arrows is connected .",
    "see the discussion in section  [ section.perfectness ] below about which column shape kr crystals are perfect .",
    "we now state the main result of this section , relating the crystal structures in the qls path model and the quantum alcove model .",
    "[ qalc2qls ] consider the root operator @xmath622 ( and the corresponding map @xmath802 ) for qls paths , as defined in section  [ subsec : crystal ] , and the root operator @xmath649 in the quantum alcove model defined in section  [ rootopsqalc ] .",
    "given @xmath5 in @xmath760 , we have @xmath803 if and",
    "only if @xmath804 ; in this case , we have @xmath805    the proof of the similar result for the classical alcove model , namely ( * ? ? ?",
    "* theorem 9.4 ) , carries through ( cf .",
    "remark [ spec ] ) . the main fact underlying",
    "this proof is the similarity between the definition   of @xmath622 for qls paths , and the change under @xmath649 of the relevant path in the quantum bruhat graph , which is explained in remark [ changepath ] ; note that in both cases the reflection @xmath806 is applied to a segment of the corresponding path .    to be more precise ,",
    "the proof is based on deforming the path @xmath692 to a path @xmath807 between the same endpoints ( where @xmath808 is a sufficiently small positive real number ) , such that the latter does not pass through the intersection of two or more @xmath17-hyperplanes ( here we exclude the endpoints ) .",
    "the path @xmath807 encodes the same information as the `` folded alcove path '' corresponding to @xmath5 or , equivalently , the sequence of roots @xmath809 ; see section [ rootopsqalc ] .",
    "therefore , the action of @xmath622 on @xmath807 and of @xmath649 on @xmath5 ( where the latter is based on @xmath809 ) are equivalent .",
    "the proof concludes by taking the limit @xmath810 , under which @xmath807 goes to @xmath692 .    we will now point out the additional elements in the proof .",
    "first , some results invoked in the proof of ( * ? ? ?",
    "* theorem 9.4 ) need to be replaced , as follows : ( * ? ? ?",
    "* corollary 6.11 ) with ( * ? ? ?",
    "* propositions 3.15 and 3.18 ) , ( * ? ? ?",
    "* corollary 6.12 ) with ( * ? ? ?",
    "* propositions 3.16 and 3.19 ) , and ( * ? ? ?",
    "* proposition 7.3 ) with remark [ changepath ] .",
    "other than this , there is just one notable addition to the proof , which has to do with the case @xmath610 . consider the number @xmath611 in the definition of @xmath811 , and assume for the moment that @xmath812 . by the same reasoning as in @xcite",
    ", we can see that the minimum of the function @xmath813 is @xmath814 .",
    "therefore , as discussed in ( * ? ? ?",
    "* section 2.2 ) , cf .",
    "also ( * ? ? ?",
    "* lemma 2.1 ( c ) ) , the maximum number of times @xmath815 can be applied to @xmath807 is @xmath611 .",
    "meanwhile , the maximum number of times @xmath18 can be applied to @xmath5 is @xmath816 , by theorem [ theorem : admissible ] ( 2 ) . in the remaining case , namely @xmath817 , we have @xmath818 , and the minimum of the function mentioned above is @xmath212 , so @xmath815 is not defined on @xmath807 .",
    "we conclude that @xmath819 if and only if @xmath820 .",
    "the rest of the argument is identical to the one in @xcite .",
    "[ ndd ]    \\(1 ) the forgetful map @xmath762 from the quantum alcove model to the qls path model is a very natural map . therefore , we think of the former model as a mirror image of the latter , via this bijection .",
    "if we use the mentioned identification to construct the non - dual demazure arrows in the quantum alcove model , we quickly realize that , in general , the constructions are considerably more involved than and , see  ( * ? ? ?",
    "* example 4.9 ) .",
    "\\(2 ) although the quantum alcove model so far misses the non - dual demazure arrows , it has the advantage of being a discrete model . therefore , combinatorial methods are applicable , for instance in proving the independence of the model from the choice of an initial alcove path ( or @xmath17-chain of roots ) , see below , including the application in remark [ perfectcase](2 ) .",
    "this should be compared with the subtle continuous arguments used for the similar purpose in the littelmann path model @xcite .",
    "based on , we immediately obtain the following corollary of theorems [ thm : lscl ] , [ thm : ls = qls ] , [ qalc2qls ] , and proposition [ proposition.bijqls ] .",
    "[ mainthm ] the bijection @xmath821 is a weight - preserving affine crystal isomorphism from @xmath760 to the subgraph of @xmath795 consisting of the dual demazure arrows .",
    "recall that the set @xmath822 in corollary [ mainthm ] is based on a lex @xmath17-chain @xmath823 .",
    "in fact , the following stronger version of corollary [ mainthm ] is proved in @xcite .",
    "[ mainconj]@xcite given any @xmath17-chain @xmath824 , there is a weight - preserving affine crystal isomorphism between @xmath577 and the subgraph of @xmath795 consisting of the dual demazure arrows .",
    "the proof uses corollary [ mainthm ] as the starting point . then , given two @xmath17-chains @xmath824 and @xmath825 , we construct a bijection between @xmath577 and @xmath826 preserving the dual demazure arrows , as well as the weights and heights of the vertices ( see definition  [ defht ] below ) ; this means that the quantum alcove model does not depend on the choice of a @xmath17-chain .",
    "the mentioned construction is based on generalizing to the quantum alcove model the so - called yang - baxter moves in @xcite . as a result",
    ", we obtain a collection of a priori different bijections between @xmath795 and @xmath577 .",
    "[ perfectcase ]    \\(1 ) we believe that the bijections mentioned above are identical .",
    "in fact , this is clearly the case if all the tensor factors of @xmath795 are perfect crystals . indeed , since the subgraph of @xmath795 consisting of the dual demazure arrows is connected , there is no more than one isomorphism between it and @xmath577 .",
    "\\(2 ) in the case when all the tensor factors of @xmath795 are perfect crystals , a corollary of the work in @xcite is the following application of the quantum alcove model , cf .",
    "remark [ perfectcase ] ( 1 ) . by making specific choices for the @xmath17-chains @xmath824 and @xmath825 , the bijection between @xmath579 and @xmath827 mentioned above gives a uniform realization of the combinatorial @xmath11-matrix ( i.e. , the unique affine crystal isomorphism commuting factors in a tensor product of kr crystals ) .",
    "in fact , we believe that this statement would hold in full generality , rather than just the perfect case .",
    "\\(3 ) in @xcite we proved theorem [ mainconj ] in types @xmath5 and @xmath514 , for certain @xmath17-chains different from the lex ones , via certain bijections constructed in @xcite . here",
    "we used the realization of the corresponding crystal @xmath795 in terms of kashiwara - nakashima ( kn ) columns @xcite .",
    "we use the notation in section  [ section.qalc ] . given the lex @xmath17-chain @xmath578 with height sequence @xmath564 , we define the complementary height sequence @xmath828 by @xmath829 . in other words , @xmath830 .",
    "[ defht ] given @xmath831 , we let @xmath832 ( in other words , we record the quantum steps in the path . we also define @xmath833    for examples , we refer to @xcite .",
    "our goal is to show that the bijection in section  [ s : forget ] translates the height statistic in the quantum alcove model to the energy statistic in the quantum ls path model given in section  [ subsec : deg - ene ] . for this , we need the following lemma , whose proof is given in section  [ comppaths ] .",
    "[ relwt ] let @xmath834 , and @xmath835 , @xmath836 .",
    "consider a shortest path @xmath213 from @xmath728 to @xmath729 in @xmath198 , as well as a shortest path @xmath333 from @xmath706 to @xmath253 in @xmath574 .",
    "then , @xmath837 .",
    "we can now state one of our main results .",
    "[ energy - transl ] consider an admissible subset @xmath5 in @xmath760 , and the corresponding qls path @xmath838 .",
    "write @xmath692 as : @xmath839 with @xmath739 and @xmath740 .",
    "set @xmath741 ; note that @xmath840 ( cf . and .",
    "then , we have @xmath841    recall from section [ s : invmap ] that @xmath5 ( in fact , the corresponding path in @xmath574 ) can be reconstructed from the quantum ls path by first defining recursively a sequence @xmath842 , @xmath746 ( and @xmath843 ) , and then by concatenating the unique paths @xmath844 with increasing edge labels ( with respect to @xmath708 , cf . section  [ s : invmap ] ) between @xmath748 and @xmath749 , for @xmath746 . by theorem",
    "[ thm : shell ] ( 2 ) , the paths @xmath844 are shortest ones",
    ". therefore , by lemma  [ relwt ] , we have @xmath845 we also have @xmath846 .    consider a quantum edge in some path @xmath844 , and let @xmath847 be the root in the lex @xmath17-chain labeling it ( so @xmath848 ) .",
    "as discussed in section [ s : invmap ] , we have @xmath849 by noting that @xmath850 is the sum of @xmath851 for all such @xmath847 , and by combining , , and , the statement of the theorem follows .",
    "[ dllev ] keep the notation of sections  [ subsec : lusztig ] and [ section.isom ] . for each @xmath852",
    ", we have @xmath853 namely , the following diagram commutes : @xmath854{s , l}{\\mathrm{id } } \\node{{\\mathcal{a}}(\\lambda ) }     \\arrow{w , t}{-\\mathrm{height } \\ , \\eqref{defheight } }    \\arrow{e , t}{\\pi \\ , \\text{\\rm ( \\s\\ref{s : forget } ) } }     \\arrow{se , t}{\\pi^{\\ast } }    \\arrow{s , r}{{\\widetilde{\\psi } } } \\node{{\\mathop{\\rm qls}\\nolimits}(-w_{\\circ}\\lambda ) }     \\arrow{s , r}{\\ast \\ , \\text{\\rm ( \\s\\ref{subsec : lusztig } ) } }     \\arrow{e , t}{\\mathrm{id } }   \\node{{\\mathop{\\rm qls}\\nolimits}(-w_{\\circ}\\lambda ) }     \\arrow[2]{s , r}{\\omega \\ , \\text{\\rm ( \\s\\ref{subsec : lusztig } ) } } \\\\",
    "\\node { } \\node{{\\mathbb{b } } } \\arrow{s , r}{s \\ , \\text{\\rm ( \\s\\ref{subsec : lusztig } ) } }   \\node{{\\mathop{\\rm qls}\\nolimits}(\\lambda ) } \\arrow{w , b}{\\psi \\ ,",
    "\\eqref{defpsi } }   \\arrow{s , r}{s \\ , \\text{\\rm ( \\s\\ref{subsec : lusztig } ) } } \\\\",
    "\\node { } \\node{{\\mathbb{b}}^{{\\mathrm{rev } } } } \\arrow{sw , b } {     d_{{\\mathbb{b}}^{{\\mathrm{rev}}}}(\\,\\cdot\\,)-d_{{\\mathbb{b}}^{{\\mathrm{rev}}}}^{{\\mathop{\\rm ext}\\nolimits } } \\ ,      \\text{\\rm ( \\s\\ref{subsec : deg - ene } ) } } \\node{{\\mathop{\\rm qls}\\nolimits}(\\lambda ) }   \\arrow{s , r}{{\\mathop{\\rm deg}\\nolimits}_{\\lambda } \\ , \\text{\\rm ( \\s\\ref{subsec : dfn - deg } ) } } \\arrow{w , b}{\\psi^{{\\mathrm{rev } } } \\ , \\text{\\rm ( \\s\\ref{subsec : lusztig } ) } } \\node{{\\mathop{\\rm qls}\\nolimits}(\\lambda ) }   \\arrow{w , b}{\\mathrm{id } } \\\\ \\node{{\\mathbb{z}}_{\\le 0 } } \\arrow[2]{e , b}{\\mathrm{id } } \\node { } \\node{{\\mathbb{z}}_{\\le 0 } } \\end{diagram } \\ ] ]    as in theorem  [ energy - transl ] , write @xmath838 as : @xmath839 with @xmath739 and @xmath740 , and set @xmath741 .",
    "it follows from theorem  [ thm : deg - qls ] that @xmath855 also , we see from lemma  [ lem : da](3 ) that @xmath856 therefore , we obtain @xmath857 which proves the first equality . for the second equality , observe @xmath858 using this , we deduce that @xmath859 as desired .",
    "since @xmath860 by the definitions of these maps , the third equality follows .",
    "the last equality follows from corollary  [ cor : taile ] since @xmath861 .",
    "based on theorem [ mainconj ] , cf .",
    "also the discussion following it , we have the strengthening of corollary [ dllev ] stated below .",
    "[ conjen ] corollary [ dllev ] holds for @xmath577 , where @xmath824 is an arbitrary @xmath17-chain , with @xmath862 replaced with one of the isomorphisms in theorem [ mainconj ] .    in @xcite the energy function in types @xmath5 and @xmath514",
    "was realized in terms of a statistic in the model based on kn columns , which is known as charge .",
    "furthermore , in @xcite it was shown that this statistic is the translation of the height statistic via the bijections constructed there ( also mentioned in remark  [ perfectcase ]  ( 3 ) ) , between the corresponding quantum alcove model and models based on kn columns .",
    "this should be compared with corollary  [ dllev ] and theorem  [ conjen ] , where the constant @xmath863 is @xmath212 in these cases .",
    "the following is due to ion ( * ? ? ?",
    "* theorem  4.2 ) for the dual of an untwisted affine root system .",
    "[ l : nsmac = mac ] for @xmath864 dominant , @xmath865 where @xmath866 is the nonsymmetric macdonald polynomial @xcite .",
    "applying  ( * ? ? ?",
    "* ( 5.7.8 ) ) and its notation , at @xmath867 we have @xmath868 if @xmath259 is not the unique antidominant element @xmath869 in the finite weyl group orbit of @xmath17 . indeed ,",
    "letting @xmath870 be a reduced expression of the shortest element @xmath871 in the finite weyl group such that @xmath872 is antidominant , we obtain @xmath873 where @xmath874 for @xmath875 ; here we note that @xmath876 and @xmath877 for all @xmath875 since the elements @xmath878 , @xmath875 , comprise the inversion set for @xmath871 .",
    "the following combinatorial formula for @xmath0 is based on specializing the ram - yip formula for macdonald polynomials  @xcite , which was carried out in  @xcite .",
    "[ p : macalcove ] for @xmath864 dominant , @xmath879    for simplicity of notation , we set @xmath880 , where @xmath476 is the dynkin diagram automorphism given by @xmath881 for @xmath406 . by lemma",
    "[ l : nsmac = mac ] and restating ( * ? ? ?",
    "* corollary  4.4 ) in our setting for the quantum alcove model of section  [ objmod ] , we obtain @xmath882 moreover , by proposition  [ proposition.bijqls ] applied to @xmath883 and the first equality of corollary  [ dllev ] , we deduce that @xmath884 which proves the first equality of .",
    "now , we have @xmath885 the last equality follows from the fact that @xmath886 is symmetric , i.e. , invariant under the action of the weyl group @xmath50 , in the variable @xmath231 .",
    "because @xmath887 is a weight - preserving bijection , it follows that @xmath888 also , by corollary  [ dllev ] , we get @xmath889 which proves the second equality of .",
    "[ r : anychain ] the formula holds for any @xmath17-chain .",
    "now define the graded character corresponding to the kr crystal @xmath385 ( see for example  @xcite ) by @xmath890 where @xmath891 is the weight of the crystal element @xmath106 . from theorem  [ thm : ns - deg ] and",
    "proposition  [ p : macalcove ] , we immediately derive our main result .",
    "[ peqx ] we have @xmath892    in type @xmath5 , the macdonald polynomial at @xmath1 can be expanded in terms of schur functions with kostka - foulkes polynomials as the transition matrix  ( * ? ? ?",
    "* chapter iii.6 ) .",
    "these in turn can be expressed as one - dimensional configuration sums @xmath96",
    "@xcite , which implies the @xmath893 result in type @xmath5 . in all simply - laced types",
    "it was known by combining the results in @xcite and @xcite , which equate a certain affine demazure character with @xmath894 and @xmath96 , respectively .",
    "it was also known in type @xmath514 by  @xcite .",
    "in the proof of this lemma , a dotted ( resp . , plain ) edge represents a quantum ( resp . ,",
    "bruhat ) edge in @xmath574 or @xmath198 , while a dashed edge can be of both types .",
    "define @xmath895 by @xmath896 as in the proof of one of the main results in @xcite , namely theorem 6.5 ( more precisely , the converse statement ) , we proceed by induction on the height of @xmath76 ( i.e. , the sum of the coefficients in its expansion in the basis of affine simple roots ) .",
    "the base case , when @xmath76 is an affine simple root , is treated in the following lemma .",
    "[ bc16 ] in @xmath699 we have an edge @xmath897 for a finite simple root @xmath589 with @xmath898 ( resp .",
    "@xmath899 where @xmath900 ) if and only if in @xmath233 we have @xmath901 ( resp .",
    "@xmath902 ) .",
    "let us first ignore the parameter @xmath106 ( or just assume @xmath703 ) . by the trichotomy of cosets in  ( * ? ? ?",
    "* propositions 5.10 and 5.11 ) , there is a simple way to test whether we have the mentioned edges in @xmath574 , namely @xmath903 , where @xmath904 is the simple root @xmath589 or @xmath72 , respectively ; similarly for the mentioned edges in @xmath198 , with @xmath253 replaced by @xmath905 . the proof is completed by noting that @xmath906 where @xmath904 can be any root , in fact ; indeed , writing @xmath907 , we have @xmath908 , and we know that the elements of @xmath84 permute @xmath909 . for an arbitrary @xmath106 ( and @xmath904 )",
    ", we observe that @xmath910    we need the following result from @xcite , which we recall .",
    "[ lem.covers.pqbg ] let @xmath911 , and let @xmath912 .",
    "define @xmath895 as in .",
    "there exists an affine simple root @xmath589 ( in fact , @xmath913 if @xmath914 ) such that @xmath915 , and we have the edge in @xmath198 indicated either in case ( 1 ) or ( 2 ) below , where @xmath916 is defined by @xmath917 : @xmath918    we also need the following lemma .",
    "[ bbchains ] consider any one of the diamonds in the parabolic quantum bruhat graph @xmath198 listed in ( * ? ? ?",
    "* lemma 5.14 ) .",
    "if one the two paths ( of length @xmath919 ) is in @xmath233 , for some fixed @xmath106 , then the other one is too .    by ( * ?",
    "? ? * lemma 5.14 ) , we know that , up to sign and left multiplication by elements of @xmath84 , the pairs of labels on the two paths are @xmath920 and @xmath921 , for some @xmath922 and @xmath201 , while @xmath904 is a finite simple root or @xmath72 .",
    "the equivalence of the integrality conditions with respect to @xmath106 for the two pairs follows from the simple calculation @xmath923 where @xmath924 is an integer . on another hand ,",
    "it is clear that mapping roots via elements of @xmath84 preserves the integrality condition .",
    "we can assume that @xmath925 , as otherwise the statement is obvious .",
    "as stated above , we proceed by induction on the height of the affine root @xmath76 .",
    "if @xmath76 is an affine simple root , the conclusion follows directly from lemma  [ bc16 ] .",
    "otherwise , we apply lemma  [ lem.covers.pqbg ] for @xmath198 ; this gives an affine simple root @xmath589 satisfying @xmath926 and either condition ( 1 ) or ( 2 ) in the mentioned lemma .",
    "assume that condition ( 1 ) holds , as the reasoning is completely similar if condition ( 2 ) holds .",
    "by lemma  [ bc16 ] , we have @xmath927    by lemma [ lem.covers.pqbg ] , we have one of the following three cases : @xmath928 by  ( * ? ? ?",
    "* lemma 5.14 ) , known as the `` diamond lemma '' , we have the left diamonds in  ( * ? ? ?",
    "( 5.3 ) , ( 5.4 ) , and ( 5.7 ) ) , respectively .",
    "note that all the necessary conditions for applying the diamond lemma are checked as in the proof of the converse statement of  ( * ? ? ?",
    "* theorem 6.5 ) .",
    "we can represent the diamonds in the three cases using the single diagram below , where @xmath929 if @xmath913 , and @xmath930 , otherwise .",
    "@xmath931 recall that the bottom edge is viewed as a path @xmath333 ; similarly , we view the top edge as a path @xmath932 , and we clearly have @xmath933 .",
    "define @xmath934 for the top edge of the diamond in the same way as @xmath76 was defined for the bottom one in . as in the proof of the converse statement of  (",
    "* theorem 6.5 ) , we can check in all three cases that @xmath935 . since @xmath915",
    ", this implies that the height of @xmath934 is strictly smaller than that of @xmath76 .",
    "therefore , by applying the induction hypothesis to the top edge of the diamond , which is clearly in @xmath699 , we obtain a path in @xmath233 : @xmath936 by induction , we have @xmath937 .    * case 1 . *",
    "assume for the moment that @xmath938 . by lemma [ bc16 ] , the right edge in implies that in @xmath198 we have an edge @xmath939 assuming that the diamond lemma can be successively applied based on and",
    ", we exhibit the diamonds below in @xmath198 , from right to left , where @xmath940 .",
    "@xmath941 note that the labels on the top edges are the same as those on the corresponding edges on the bottom , or at most differ from those by elements of @xmath84 ; so all the bottom edges are in @xmath233 too , and we can define @xmath213 to be the path formed by them .",
    "now let us prove that @xmath702 . by ( * ? ? ?",
    "* lemma 5.14 ) , the weights of all paths from @xmath700 to @xmath942 in are congruent mod @xmath943 . if @xmath944 , then all the vertical edges in are bruhat edges , so @xmath945 . applying the induction hypothesis and the fact that @xmath933 concludes the induction step in this case .",
    "if @xmath946 , then we are in the third case in , and so diagram is the left one in ( * ? ? ?",
    "* eq . ( 5.7 ) ) ; thus its top edge is a bruhat edge , which implies @xmath947 , and its bottom edge is a quantum one , in particular @xmath948 .",
    "moreover , all the vertical edges in   are quantum ones ; in particular , the leftmost and the rightmost ones have weights @xmath949 respectively . then , by the above observation about the paths from @xmath700 to @xmath942 in , we have mod @xmath943 : @xmath950 here we see that @xmath951 by using the well - known fact that if @xmath952 is a positive root , then @xmath953 is @xmath212 or @xmath954 ; indeed , in our case we saw that @xmath955 , while we have @xmath956 and @xmath957 by .",
    "* case 2 . *",
    "the reasoning in case 1 fails , i.e. , we can not apply the diamond lemma at some point , if we have the following situation for some @xmath958 .",
    "@xmath959 in this case , the edge @xmath960 is in @xmath233 , because it coincides with the edge @xmath961 , which has this property by the induction hypothesis , cf . .",
    "by lemma [ bbchains ] , all vertical edges are also in @xmath233 , in particular the rightmost one . by lemma [ bc16 ] ,",
    "the edge @xmath962 in is in @xmath699 . by applying lemma [ bbchains ] to this time , we conclude that the edge @xmath963 is in @xmath699 .",
    "but we showed in that @xmath964 , so by lemma [ bc16 ] the edge @xmath965 is in @xmath233 .",
    "we now define @xmath213 to be the following path in @xmath233 : @xmath966 we then prove that @xmath702 in a way completely similar to case 1 , which concludes the induction step .",
    "* case 3 . *",
    "the last case to consider is the one when @xmath967 .",
    "we still have the edge @xmath968 in @xmath699 , because @xmath969 .",
    "so we can reason as in the previous paragraph in order to prove that the edge @xmath965 is in @xmath233 .",
    "we now define @xmath213 to be the following path in @xmath233 : @xmath970 note that this is the only case when the induction step produces a path of a different length ( more precisely , longer by 1 ) based on the path in the induction hypothesis .",
    "now let us prove that @xmath702 . if @xmath944 , then the first edge of @xmath213 is a bruhat edge , so @xmath971 . applying the induction hypothesis and the fact that @xmath933 concludes the induction step in this case . if @xmath946 , then by the same reasoning as in case 1 , we deduce @xmath972 we conclude that @xmath973 ( cf .",
    "case 1 ) , so we need to prove that @xmath974 .",
    "this follows from @xmath975 here we have used the fact that @xmath976 , as in case 1 .",
    "we require some notation and results from @xcite .",
    "let @xmath977 denote the set of minimum coset representatives in @xmath978 .",
    "write @xmath979 for the covering relation in the ( strong ) bruhat order on @xmath61 . for @xmath980 , say that @xmath60 is @xmath611-superantidominant if @xmath981 for every positive root @xmath485 .",
    "we fix once and for all a sufficiently large @xmath982 ( @xmath983 is sufficient ) .",
    "[ l : affgrass ] let @xmath911 and @xmath60 .",
    "then @xmath984 if and only if @xmath985 is antidominant ( that is , @xmath986 for all @xmath47 ) and @xmath987 , where @xmath988 .",
    "[ p : affinelift ] let @xmath60 be @xmath611-superantidominant and let @xmath989 with @xmath705 . then @xmath990 if and only if one of the following conditions holds :    1 .",
    "@xmath991 and @xmath992 , giving @xmath993 ; 2 .",
    "@xmath994 and @xmath995 , giving @xmath996 ; 3 .",
    "@xmath997 and @xmath998 , giving @xmath999 ; 4 .",
    "@xmath1000 and @xmath1001 , giving @xmath1002 .",
    "we start with the following lemma .",
    "[ twoch ] assume that in @xmath1003 we have @xmath1004 and @xmath1005 are @xmath611-superantidominant .",
    "then @xmath1006 , and in fact any saturated chain between these elements is a chain in @xmath106-bruhat order .",
    "we claim that @xmath1007 using a downward chain in @xmath977 .",
    "it suffices to prove this when @xmath1008 for some @xmath47 .",
    "suppose this is the case .",
    "suppose first that @xmath1009 . by proposition",
    "[ p : affinelift ] we have @xmath1010 as required .",
    "otherwise we have @xmath1011 .",
    "then by proposition [ p : affinelift ] we have @xmath1012 as required .    knowing this , using proposition [ p : affinelift ] we pick a downward saturated chain from @xmath1013 to @xmath1014 , followed by one from @xmath1014 to @xmath1015 , all in @xmath977 . by the hypothesis",
    ", there is a downward saturated chain in @xmath106-bruhat order from @xmath1013 to @xmath1016 . by (",
    "* ? ? ? * lemma 4.15 ) , we know that the first chain is in @xmath106-bruhat order too , which concludes the proof .    by proposition [ p : affinelift ] we can lift both paths to downward saturated chains in @xmath1003 starting at @xmath1017 , where @xmath985 is a fixed @xmath611-superantidominant element in @xmath1018 .",
    "denote the endpoints of the two chains by @xmath1019 and @xmath1020 , respectively .",
    "recall that @xmath1021 and @xmath1022 are the sums of the coroots corresponding to ( the labels of ) the down steps in the paths in @xmath574 which are lifted . since the first path in @xmath574 is a shortest one , by (",
    "* lemma 1 ) , we have @xmath1023 . furthermore , by the hypothesis , the second chain in @xmath1003 is in @xmath106-bruhat order .",
    "thus the hypotheses of lemma [ twoch ] are all satisfied , so we conclude that the first chain in @xmath1003 is also in @xmath106-bruhat order , and therefore the first path in @xmath574 is in @xmath699 .",
    "let us first recall proposition  [ prop : weight ] , which is the parabolic generalization of a lemma due to postnikov  @xcite .    by lemma [ q2ls ] , we can construct a path from @xmath351 from @xmath728 to @xmath729 in @xmath198 with @xmath1024 namely , we simply concatenate the paths in @xmath198 that correspond , by the mentioned lemma , to each edge of @xmath333 , cf . the construction of the forgetful map in section [ s : forget ] . by proposition",
    "[ prop : weight ] , we have @xmath1025    we then exhibit a path @xmath932 from @xmath706 to @xmath253 like in the proof of lemma [ l : mainb ] ( on which the construction of the inverse map in section [ s : invmap ] is based ) ; we refer to this proof for the details .",
    "namely , we concatenate the following :    * a path from @xmath706 to @xmath728 with only quantum edges and all edge labels in @xmath731 ; * a path from @xmath728 to @xmath729 constructed based on @xmath213 ; * a path from @xmath729 to @xmath253 with only bruhat edges and all edge labels in @xmath731 .",
    "note that @xmath1026 since all the edges in the first segment of @xmath932 , as well as the extra edges introduced in the second segment , have labels orthogonal to @xmath17 . on another hand , by proposition  [ prop : weight ] ( in fact , we only need here the original version ( * ? ? ?",
    "* lemma 1(3 ) ) ) , we have @xmath1027 the proof is concluded by combining , , , and .",
    "the notion of perfectness plays an important role for level - zero crystals .",
    "it ensures for example that the kyoto path model is applicable , which gives a model for highest weight affine crystals as a semi - infinite tensor product of kirillov  reshetikhin crystals .",
    "let us define perfect crystals , see for example  @xcite . given a crystal @xmath1028 and @xmath1029",
    ", we need the definition @xmath1030 with @xmath1031 and @xmath1032 as defined in",
    ". furthermore , denote by @xmath1033 the set of dominant weights of level @xmath56 , where @xmath1034 .      1 .",
    "@xmath1028 is isomorphic to the crystal graph of a finite - dimensional @xmath1036-module .",
    "2 .   @xmath1037 is connected .",
    "3 .   there exists a @xmath1038 , such that @xmath1039 and there is a unique element in @xmath1028 of classical weight @xmath864 .",
    "4 .   @xmath1040 .",
    "@xmath1041 , there exist unique elements @xmath1042 , such that @xmath1043          for all nonexceptional types this conjecture was proven in  @xcite .",
    "given the explicit models for @xmath1050 for all untwisted types in this paper and their implementation into sage  @xcite , we have verified conjecture  [ conj : perfectness ] also for untwisted exceptional types when @xmath287 .",
    "for type @xmath1051 , perfectness was also treated in  @xcite .",
    "conjecture  [ conj : perfectness ] holds for @xmath1050 for types @xmath1052 for all dynkin nodes , and type @xmath12 for all nodes ( except possibly @xmath1053 in the labeling of  @xcite ) .",
    "in addition , the graded classical decompositions of  ( * ? ? ?",
    "* appendix a ) were verified ( except for type @xmath12 ) .",
    "point ( 1 ) of definition  [ def : perfect ] follows from remark  [ rem : lscl ] .",
    "point ( 2 ) can be deduced from  @xcite .",
    "points ( 3)-(5 ) were checked explicitly on the computer using the implementation of level - zero ls paths in sage  @xcite ( version sage-6.1 or higher ) , see for example    ....     sage : c = cartantype(['e',6,1 ] )        sage : r = rootsystem(c )        sage : la = r.weight_space().basis ( )        sage : ls = crystalofprojectedlevelzerolspaths(la[1 ] )        sage : ls.is_perfect ( ) ....                          p. etingof .",
    "whittaker functions on quantum groups and @xmath9-deformed toda operators .",
    "differential topology , infinite - dimensional lie algebras , and applications , pp . 925 , amer .",
    "ser . 2 , 194 , amer .",
    "soc . , providence , ri , 1999 .",
    "g. hatayama , a. kuniba , m. okado , t. takagi , and z. tsuboi .",
    "paths , crystals and fermionic formulae . in _ mathphys odyssey 2001 .",
    "integrable models and beyond _ ( m. kashiwara and t. miwa , eds . ) , prog . math .",
    "23 , pp . 205272 , birkhuser , boston , 2002 .",
    "g. hatayama , a. kuniba , m. okado , t. takagi , and y. yamada .",
    "remarks on fermionic formula . in _",
    "recent developments in quantum affine algebras and related topics _ ( n. jing and k.c .",
    "misra , eds . ) , contemp .",
    "243291 , amer .",
    "soc . , providence , ri , 1999 .",
    "a.  kirillov and n.  reshetikhin .",
    "epresentations of yangians and multiplicities of the inclusion of the irreducible components of the tensor product of representations of simple lie algebras . , 52:31563164 , 1990 .                    c.  lenart , s.  naito , d.  sagaki , a.  schilling , and m.  shimozono .",
    "quantum lakshmibai - seshadri paths and root operators .",
    "preprint arxiv:1308.3529 . to appear in _ proceedings of the 5th mathematical society of japan seasonal institute : schubert calculus _ ,",
    "osaka , japan , 2014 .",
    "h. nakajima .",
    "extremal weight modules of quantum affine algebras . in _",
    "representation theory of algebraic groups and quantum groups _",
    "( t. shoji et al . , eds . ) , adv .",
    "pure math .",
    "343369 , math . soc .",
    "japan , 2004 ."
  ],
  "abstract_text": [
    "<S> we establish the equality of the specialization @xmath0 of the macdonald polynomial at @xmath1 with the graded character @xmath2 of a tensor product of `` single - column '' kirillov - reshetikhin ( kr ) modules for untwisted affine lie algebras . </S>",
    "<S> this is achieved by constructing two uniform combinatorial models for the crystals associated with the mentioned tensor products : the quantum alcove model ( which is naturally associated to macdonald polynomials ) , and the quantum lakshmibai - seshadri path model . </S>",
    "<S> we provide an explicit affine crystal isomorphism between the two models , and realize the energy function in both models . </S>"
  ]
}