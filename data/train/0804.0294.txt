{
  "article_text": [
    "@xmath0-body simulations are becoming a more and more powerful tool for investigating the formation of structure in the universe .",
    "since this is a grand - challenge problem with a huge dynamic range , it is of basic importance to understand how significant numerical effects are in cosmological simulations .",
    "this is becoming even more important now , with the advent of precision cosmology , which aims at breaking the degeneracy of cosmological models and providing accurate determination of the cosmological parameters at the percent level .",
    "the difficult task of simulations will then be to determine error bars in the output data , taking into account not only the uncertainty of the measurements themselves but also numerical effects , which enter the simulation model and propagate during its evolution .",
    "many recent investigations have focused on the effects of particle discreteness in lambda cold dark matter ( @xmath1cdm ) simulations .",
    "in fact , the number of particles @xmath0 determines two important quantities : the mass resolution , and the wavelength of the highest - frequency mode included in the initial conditions .",
    "such quantities , together with the force resolution and other more technical factors , affect the halo mass function and the statistical properties of the cosmological density field ( e.g. , splinter et al.1998 ; knebe et al .",
    "2000 ; hamana et al .",
    "2002 ; smith et al .  2003 ; teodoro & warren 2004 ; warren et al .  2006",
    "; hansen et al .  2007 ;",
    "joyce & marcos 2007a ; baertschiger et al .  2008 ; bagla & prasad 2008 ; tinker et al .",
    "2008 ) , as well as the halo density profile and the dynamics of structure formation ( e.g. , knebe et al .  2000 ; binney & knebe 2002 ; power et al .  2003 ; binney 2004 ; diemand et al .",
    "2004 ; heitmann et al .",
    "2005 ; zhan 2006 ; joyce & marcos 2007b ; vogelsberger et al .",
    "wang & white ( 2007 ) have shown that discreteness effects are even more important in simulations of hot / warm dark matter , where the initial power spectrum has a natural high - frequency cut - off at a relatively long wavelength .",
    "so why another contribution concerning @xmath1cdm simulations ?",
    "because the topic is still hot ( melott 2007 ; joyce et al .",
    "2008 ; and references therein ) , and there is more to learn :    * _ actual significance of discreteness effects .",
    "_ as a cosmological simulation can only give one view of the local universe , it is important to run an ensemble of simulations , varying the random realization of the initial conditions or , in other words , varying the phase and amplitude of the initial random fluctuations for a given power spectrum ( knebe & domnguez 2003 ; sirko 2005 ) .",
    "the randomness of the initial conditions causes statistical scatter in the diagnostics , which competes against the systematic effects of discreteness and should therefore be evaluated .",
    "this requires running large ensembles of simulations . *",
    "_ deeper and wider view of such effects .",
    "_ wavelets are a state - of - the - art numerical technique used for extracting multiscale information from scientific data ( see , e.g. , fang & thews 1998 ; vidakovic 1999 ; press et al .",
    "2007 , chap .  13.10 ) . despite their numerous applications in cosmology",
    "( e.g. , fang & feng 2000 ; he et al .",
    "2005 ; martnez et al .  2005 ; feng 2007 ; saar et al .",
    "2007 ) , they have not yet been used in the context of discreteness effects .",
    "wavelets provide a multiresolution view of the data , which in our case represent the density field .",
    "the field is analysed first at the finest resolution consistent with the sampling , and then at coarser and coarser resolution levels . doing so , wavelets probe the structure of the field and the contributions from the various scales . besides , wavelets are sensitive to both the amplitude and the phase of the density fluctuations .",
    "thus wavelet - based statistics can offer a deeper and wider view of discreteness effects than traditional diagnostics . * _ particular aspects of the problem .",
    "_ there are several aspects of the problem that deserve particular attention : ( 1 ) what is the range of scales affected by discreteness ? ( 2 ) as already mentioned , discreteness imposes two limitations : a finite mass resolution , and a lack of initial fluctuation power on small scales .",
    "it would be interesting to study their statistical effects separately .",
    "binney ( 2004 ) himself concluded that `` it would be interesting to have a series of simulations in which the power spectrum is truncated at large wavenumbers , with the result that any increases in the particle number lead to the same structures being more and more densely populated , rather than to ever smaller - scale structures being simulated '' .",
    "although moore et al .  ( 1999 ) did not see a significant difference in the density profile of a halo simulated with a truncated power spectrum , coln et al .",
    "( 2008 ) found steeper central density profiles in a larger sample of haloes that formed with masses close to the free - streaming cutoff scale . here",
    "instead we study in detail how a truncated power spectrum affects the statistics of the density field .",
    "( 3 ) discreteness effects also arise from the grid - like particle distribution used in the initial conditions ( e.g. , hansen et al .",
    "it would be worthwhile to check whether the initial grid leaves any statistical trace at low redshifts .",
    "( 4 ) a further aspect of the problem concerns the probability distribution of the initial fluctuations , and its evolution with redshift .",
    "for this purpose , we run two large sets of simulations . in one",
    "we vary @xmath0 and the random realization of the initial conditions , while in the other we truncate the initial power spectrum and vary @xmath0 through different sampling techniques so as to further probe discreteness effects and the transfer of power from large to small scales . in both sets we keep the force resolution fixed , so as to decouple the effects of discreteness from those of force resolution ( cf .",
    "binney 2004 ) .",
    "our simulations span scales from @xmath5 to @xmath6 .",
    "we analyse the statistical properties of the cosmological density field using a large variety of diagnostics , including new and powerful wavelet statistics .",
    "we compute all the diagnostics consistent with the force resolution , so as to probe effects that are fully resolved dynamically .",
    "the rest of our paper is organized as follows .",
    "the first set of simulations is described in sect .  2 .",
    "the actual significance of discreteness effects against statistical scatter is assessed in sect.3 , where we also inquire into the nature of such scatter . in sect.4",
    ", we introduce the wavelet statistics and analyse discreteness effects .",
    "the second set of simulations is described in sect .  5 , and particular aspects of the problem are probed in sect .",
    "we draw the conclusions in sect .",
    "our cosmological @xmath0-body simulations use the particle - mesh code by klypin & holtzman ( 1997 ) , and are based on one of their runs .",
    "we have adopted the same code and basic run in an introductory study ( agertz 2004 ) .",
    "a particle - mesh code is appropriate for our purpose because it computes all the dynamical quantities , from the density field @xmath7/\\bar{\\rho}$ ] to the forces , with given spatial resolution .",
    "the code by klypin & holtzman ( 1997 ) is publicly available and well described .",
    "it can also be used for generating the initial conditions and analysing the output data .",
    "the initial conditions are set up by using the zeldovich approximation to displace particles from a regular grid .",
    "the power spectrum @xmath8 , correlation function @xmath9 and mass variance @xmath10 of the output density field are computed consistent with the spatial resolution of the code , which is twice the cell size @xmath11 .",
    "the basic run is a @xmath1cdm simulation .",
    "the cosmological parameters are : @xmath12 , @xmath13 , @xmath14 , @xmath15 , @xmath16 and @xmath17 .",
    "the simulation has @xmath18 particles , @xmath19 cells and a box of @xmath20 .",
    "it runs from redshift @xmath21 ( @xmath22 ) to @xmath23 ( @xmath24 ) in 469 steps ( @xmath25 ) .",
    "this simulation is simple and realistic enough for our purpose .",
    "the simulations of this paper have the same input parameters as the basic run , except @xmath0 and the random number seed for generating the initial conditions .",
    "we use five values of @xmath0 : @xmath26 . in other words ,",
    "the number of particles per cell ranges from @xmath27 to 8 , and the spatial resolution ranges from @xmath28 to 4 times the average interparticle distance . for each @xmath0",
    ", we generate ten random realizations of the initial conditions .",
    "such a set of 50 simulations is appropriate for exploring how their outcome depends on @xmath0 , and for evaluating the statistical scatter of the measurements .",
    "additional simulations are discussed in sect .",
    "three popular statistical diagnostics used in cosmology are the power spectrum @xmath8 , the correlation function @xmath9 and the mass variance @xmath10 ( see , e.g. , peebles 1980 ; coles & lucchin 2002 ) .",
    "@xmath8 is the average square amplitude of density fluctuations on scale @xmath29 , with proper normalization . in the code by klypin & holtzman ( 1997 ) , @xmath8 is computed as : @xmath30 where @xmath31 is the fast fourier transform of the density field @xmath32 tabulated in the mesh of the code , the sum is over all wavenumbers spanning a spherical shell of radius @xmath33 and thickness @xmath34 , @xmath35 is the number of harmonics in the shell , and @xmath36 is the box size .",
    "@xmath9 is the real - space equivalent of @xmath8 and measures the correlation strength of structures on scale @xmath37 . in the code by klypin & holtzman ( 1997 ) , @xmath9 is computed by discretizing the relation : @xmath38 the algorithm consists of several steps , which can not be translated into a single formula [ cf .",
    "routine fcorr(r ) in pmpower.f ] .",
    "similarly , we compute @xmath10 by discretizing the relation : @xmath39 where @xmath40 is the spherical top - hat window function : @xmath41 note that the only difference between @xmath9 and @xmath10 is the replacement of @xmath42 with @xmath43 .",
    "another way to compute @xmath9 and @xmath10 is by using particle - based estimators ( e.g. , knebe & domnguez 2003 ) , rather than the mesh - based estimators above .",
    "however , the computation takes an order of magnitude longer time than the simulations themselves . besides , it is more difficult to compute @xmath9 and @xmath10 consistent with the spatial resolution of the code .",
    "this results in extra spikes , which are nothing but noise of the particle - based estimation .",
    "apart from that , the results are similar .",
    "so in the following we go on discussing the mesh - based case .    another short digression . in our simulations",
    "there are two nyquist frequencies involved .",
    "one is the ` particle nyquist frequency ' @xmath44 which is associated with the grid - like particle distribution used in the initial conditions .",
    "this is the wavenumber at which the initial power spectrum is truncated .",
    "therefore @xmath45 determines the initial number of modes .",
    "the other nyquist frequency , @xmath46 , is associated with the mesh of the code ( @xmath47 is the number of cells ) .",
    "this is the largest @xmath48 that can be resolved in the mesh .",
    "harmonics with @xmath49 are aliased into the principal zone @xmath50 , but they are greatly attenuated if the mass - assignment scheme is tsc or cic , as is used in the code ( see hockney & eastwood 1988 ) . among the two nyquist frequencies ,",
    "only @xmath45 varies in our set of simulations and enters the following discussion .",
    "let us then study how the number of particles affects the standard diagnostics described above .",
    "1 shows @xmath8 , @xmath9 and @xmath10 in the range of scales spanned by the simulations , that is approximately from the cell size @xmath51 to the box size @xmath36 . at @xmath21 ,",
    "all the diagnostics manifest the peculiarity of the initial conditions for @xmath52 .",
    "such discreteness effects appear if initially the particles are distributed over a grid coarser than the dynamical mesh . at @xmath23 ,",
    "discreteness effects are hardly detectable .",
    "all the diagnostics show large statistical scatter instead .",
    "the initial and final redshifts are discussed in detail below .",
    "* _ redshift @xmath21 . _ for @xmath52 , we observe fluctuations in @xmath8 beyond the particle nyquist frequency @xmath45 . as @xmath45 increases with @xmath0 , when there are one or more particles per cell we can no longer detect the peculiar imprint of the initial conditions on @xmath8 .",
    "discreteness effects can also be observed in the other diagnostics for @xmath52 .",
    "@xmath9 fluctuates on scales smaller than a few times the average interparticle distance @xmath53 .",
    "@xmath10 changes slope on scales below @xmath53 , and approaches the @xmath54 behaviour expected for a grid - like distribution ( e.g. , hansen et al .",
    "* _ redshift @xmath23 .",
    "_ the diagnostics are unaffected by the number of particles .",
    "the only clear exception is @xmath8 for @xmath55 , which differs significantly from the other power spectra at wavenumbers larger than about five times its particle nyquist frequency ( its tail has a positive vertical offset with respect to the other tails ) .",
    "the other power spectra are similar , considering their scatter , and so are all the correlation functions and mass variances . on the other hand , the random realization of the initial conditions seems to have an important influence on all the diagnostics : their root - mean - square scatter is as large as a factor of two or more . in @xmath8 and @xmath9 the scatter is more important on large scales , while in @xmath10 it is quite uniform .",
    "this difference between @xmath10 and @xmath9 is a consequence of the large - scale behaviour of @xmath56 , which decays faster than @xmath42 and hence damps large - scale scatter more effectively .",
    "our findings reinforce those by knebe & domnguez ( 2003 ) and sirko ( 2005 ) , who observed large scatter in the standard diagnostics for a typical number of particles .",
    "the results of this analysis can be summarized as follows . at low redshifts the power spectrum ,",
    "correlation function and mass variance are dominated by statistical scatter , rather than by the systematic effects of discreteness .",
    "discreteness effects are only detectable in @xmath8 , far beyond the particle nyquist frequency ( @xmath57 ) and if there is much less than one particle per cell ( @xmath55 for @xmath19 ) . in the other diagnostics there is no clear dependence on the number of particles , even if @xmath0 varies by three and a half orders of magnitude .",
    "this is in contrast to the clear dependence on @xmath0 and the small scatter at high redshifts .",
    "2 shows the density field @xmath32 tabulated in the mesh of the code .",
    "so the spatial resolution is the same as for @xmath8 , @xmath9 and @xmath10 . here",
    "the effect of varying @xmath0 is mainly a change in granularity : @xmath32 becomes much less granular as @xmath0 increases from @xmath58 to @xmath59 or @xmath60 .",
    "in contrast , the random realization of the initial conditions turns out to influence only the spatial pattern .",
    ", the realization of the fluctuations is different .",
    "in fact , the code by klypin & holtzman ( 1997 ) does not keep the same realization of long waves while adding more and more short waves . but this phase difference does not change the granularity of the density field . ]",
    "thus the results of sect .",
    "3.1 are at odds with the visual outcome of the simulations . at low as well as at high redshifts the density field",
    "is dominated by the systematic effects of discreteness .",
    "it is peculiar , if not surprising , that standard statistics such as the power spectrum , correlation function and mass variance are insensitive to the granularity of the density field , even when this property changes as much as in fig .  2 , whereas they are sensitive to its random realization .      in order to gain insight",
    ", we consider simpler statistics of the density field , namely its standard deviation @xmath61 , skewness @xmath62 and kurtosis @xmath63 ( the mean is zero ) . @xmath62 and @xmath63 are useful for measuring departures from gaussianity ( see , e.g. , press et al .  2007 ) , which are significant at low redshifts .",
    "using numerical recipes , we compute @xmath61 , @xmath62 and @xmath63 from the density field @xmath32 tabulated in the mesh of the code .",
    "the analysis of these statistics shows that @xmath61 , @xmath62 and @xmath63 are also scatter - dominated ( see fig .",
    "3 ) .    where does the degeneracy come from ? fig .",
    "4 illustrates what the histogram of the density field looks like at redshift @xmath23 .",
    "in particular , the top panel shows the histogram for the range of values spanned by the density contrast , while the bottom panel shows a zoom of the histogram ( see figure caption).-axis logarithmically because it is the probability distribution , and not its logarithm , what enters into the definition of the statistics . ]",
    "the simplicity of this figure points out two remarkable peculiarities of the @xmath64 distribution : ( 1 ) a huge spike at @xmath65 , and ( 2 ) an extremely long tail for @xmath66 . in computing the statistics",
    ", the tail of high density peaks has much more weight than the frequent deep under - densities .",
    "this makes the statistics very sensitive to rare events , and hence scatter - dominated . but",
    "how genuine is such scatter ?",
    "we know that it is difficult to extract robust statistical information from data characterized by a long - tailed probability distribution ( see , e.g. , press et al .",
    "robust estimation requires defining appropriate statistics ( see press et al .",
    "2007 ) , or even transforming the data ( see stuart & ord 1991 ) .",
    "thus the sensitivity pointed out above means that standard statistics of the density field are not so well defined , and that their scatter can be regarded as spurious .    considering deep under - densities and high density peaks separately , in view of their distinct cosmological meaning ( voids and dark matter haloes ) ,",
    "still yields a strongly unbalanced @xmath64 distribution : clustered below @xmath67 and dispersing up to @xmath68 .",
    "what about a statistical transformation of the density field ?",
    "let us consider the @xmath69 distribution , for @xmath70 .",
    "this transformation shortens the over - density tail , and it even makes the distribution roughly normal ( cf .",
    "fig .  5 ) .",
    "in addition , this transformation is appealing because @xmath71 is a basic cosmological quantity and the @xmath69 distribution matches the @xmath64 distribution in the linear regime .",
    "lognormal models have been discussed by coles & jones ( 1991 ) and kayo et al .",
    "( 2001 ) among others .",
    "one may find better transformations considering the class of @xmath72 $ ] distributions , for @xmath70 and @xmath73 , but at the cost of a free parameter to fine - tune .",
    "we do not follow that approach .    encapsulating the singularity of the @xmath64 distribution ( @xmath65 ) in one statistic , the fraction of void cells or void probability @xmath74",
    ", we can define statistics of the transformed density field such as its mean @xmath75 , standard deviation @xmath61 , skewness @xmath62 and kurtosis @xmath63 ( we reuse old symbols for denoting the new quantities ) .",
    "note that @xmath74 is not meant to describe the distribution of voids as cosmological structures , which would require a topological approach .",
    "note also that now @xmath76 , since the transformation has a bias ( see stuart & ord 1991 ) , and @xmath62 and @xmath63 measure departures from lognormality .",
    "such statistics are discreteness - dominated , as is the density field itself : a sharp trend with @xmath0 emerges and the scatter is mostly unnoticeable , at low as well as at high redshifts ( cf .",
    "fig .  6 ) .",
    "in particular , the fact that the fraction of void cells decreases with the number of particles for a given cell size is in natural agreement with the visual outcome of the runs .",
    "summarizing , in this section we have learned that the statistical scatter can be regarded as spurious and be strongly reduced .",
    "the consideration of scale - dependent statistics adds complexity but does not change the message . in sect .  4",
    ", we will see that the method of scatter reduction can be extended to wavelet statistics , which is fundamental for an appropriate multiscale analysis .",
    "data such as the cosmological density field enclose information on various scales . in order to extract such information",
    ", we should be able to separate small - scale features from large - scale features and to understand their contributions to the overall structure of the data . in this section",
    "we describe a technique that can be used for the purpose above : the fast wavelet transform . for further reading",
    "see romeo et al .",
    "( 2003 ) , hereafter paper i , and romeo et al .",
    "( 2004 ) , hereafter paper ii .",
    "in particular , paper ii provides a reader - friendly and self - contained discussion of wavelets , from the basics to advanced aspects of the technique .",
    "the fast wavelet transform involves localized wave - like functions , which are dilated over the relevant range of scales and translated across the data .",
    "the contributions of small - scale and large - scale features are singled out with an iterative procedure .",
    "the first step consists of separating the smallest - scale features from the others .",
    "it is done by passing the data through a high - pass filter and a complementary low - pass filter .",
    "these filters are the discrete counterparts of the analysing functions of the transform , the wavelet @xmath77 and the scaling function @xmath78 , respectively , and are constructed with a mathematical technique known as multiresolution analysis .",
    "filtering produces redundant information , since each set of filtered data has the same size as the original data .",
    "redundancy is avoided by rejecting every other point of the filtered data .",
    "it is well known that down - sampling produces aliasing in the context of the fourier transform , but the filters of the wavelet transform are constructed in such a way as to eliminate it .",
    "the second step consists of separating the features that appear on a scale twice as large as in the first step .",
    "it is done by regarding the low - pass filtered and down - sampled data as new input data , and by analysing them as in the first step .",
    "the procedure continues until all features below a given ` upper scale ' are separated . in summary ,",
    "the 1d fast wavelet transform decomposes the original data into a coarse ` approximation ' and a sequence of finer and finer ` details ' , keeping the total size of the data constant ( cf .",
    "paper i , fig .  2 ) .",
    "the 2d or 3d fast wavelet transform is similar to the 1d case , except for the more complicated structure of the transformed data ( cf .",
    "paper ii , fig .  6 ) .",
    "in general , given @xmath79d data of size @xmath80 , the first step of the transform decomposes them into @xmath81 parts of size @xmath82 : 1 approximation and @xmath83 details , one for each axis and each diagonal .",
    "this is done by 1d transforming the data along each index , for all values of the other indices , consecutively .",
    "the second step decomposes the approximation into @xmath81 parts of size @xmath84 , and so on .    _ note _ that there is an important difference between the approximation and each of the details produced by the fast wavelet transform .",
    "independent of the number of dimensions , each detail is a compact piece of information concerning a single scale .",
    "in contrast , the approximation encloses ( unprocessed ) information on various scales ; it can be viewed as a smoothed miniature of the data .",
    "note , however , that there is a non - standard version of the multidimensional discrete wavelet transform where the details have mixed scale content .",
    "that is the one described in numerical recipes [ see in particular fig .",
    "13.10.4(b ) of the third edition ( 2007 ) ] .",
    "we compute the fast wavelet transform of the output density field in each simulation by using the code jofiluren ( papers i and ii ) , and refer to paper ii for a thorough discussion of the method . to do the computation , we must specify the analysing function and the upper scale of the fast wavelet transform .",
    "we choose the ` bior4.4 ' wavelet ( see paper ii , fig .  1 ) , which is the one suggested in paper ii for cold dark matter simulations .",
    "the upper scale is specified in terms of the scale parameter @xmath85 : an upper scale of @xmath81 cell sizes corresponds to @xmath86 , where @xmath47 is the number of cells .",
    "we set @xmath87 , which is the lower bound suggested in paper ii for the ` bior4.4 ' wavelet .",
    "hence the density field is wavelet - analysed at spatial scales @xmath88 , where @xmath11 is the cell size .",
    "the corresponding details @xmath89 are sets of @xmath90 data @xmath91 , , the spatial indices @xmath92 span the cube @xmath93 minus its subset @xmath94 . ] which can be used for probing the statistical properties of the density field at such spatial scales .",
    "the approximation is less useful for this purpose because of its mixed scale content , as noted in sect .",
    "wavelet statistics of the density field should not be computed directly from @xmath89 .",
    "in fact , the distribution of @xmath95 values at redshift @xmath23 shows a central singularity and a very long tail on both sides .",
    "such features are similar to those discussed in sect .  3.3 , and have similar consequences .",
    "therefore we extend the procedure followed in that case . using @xmath96 $ ] , rather than @xmath32 , does not solve the problem here because this field diverges in a significant fraction of the mesh ( the void cells ) and hence its fast wavelet transform is not defined .",
    "our solution is to consider the subsets @xmath97 and @xmath98 separately , and transform the latter : @xmath99 .",
    "we then define the void probability @xmath100 as the fraction of vanishing detail coefficients at spatial scale @xmath101 .",
    "we compute @xmath100 by counting the number of data contained in @xmath102 , and recalling that there are @xmath90 detail coefficients in total ( at scale @xmath101 ) .",
    "we also compute the mean @xmath103 , standard deviation @xmath104 , skewness @xmath105 and kurtosis @xmath106 of the data contained in @xmath107 .",
    "such wavelet statistics are a scale - dependent generalization of the statistics discussed in sect .",
    ". a generic member of this family is denoted by @xmath108 .",
    "hereafter , the subscript ` @xmath101 ' is added only when needed .",
    "7 shows the wavelet statistics as functions of the number of particles at various spatial scales .",
    "note at once that the large scatter of @xmath109 and @xmath110 is not a failure of our statistical transformation .",
    "it appears because the skewness and the kurtosis are high - order statistics , and at that spatial scale there are relatively few detail coefficients . by analysing the behaviour of @xmath111 at @xmath21",
    ", we learn that the imprint of the initial conditions on the wavelet statistics is twofold .",
    "first , there is a strong correlation between the number of particles and the spatial scale : @xmath112 behaves approximately as @xmath113 .",
    "in fact , the red curves shifted by one step to the left match the green curves , which in turn match the blue ones , and so on .",
    "this correlation appears because the effect of varying @xmath0 is , to zeroth - order approximation , a simple change of scale in the particle distribution .",
    "second , at a given spatial scale @xmath114 , there is a number of particles @xmath115 that minimizes @xmath61 and @xmath62 , and maximizes @xmath63 .",
    "this follows from the fact that the @xmath64 distribution has a transition for @xmath116 ( see sect .",
    "the behaviour of @xmath111 at @xmath23 is more difficult to understand in detail .",
    "nevertheless , we can deduce two basic facts :    1 .",
    "there is a weak trace of the initial @xmath0@xmath101 correlation , while there is no critical @xmath0 .",
    "this suggests that the average interparticle distance is still a significant scale when the particle distribution is hierarchically clustered .",
    "2 .   independent of redshift",
    ", the behaviour of @xmath111 simplifies at @xmath117 : all the wavelet statistics converge for large @xmath0 , and are possibly constant at @xmath118 . in other words , increasing @xmath0 affects smaller and smaller spatial scales ; scales larger than @xmath119 ( the average interparticle distance for @xmath120 ) are possibly unaffected .",
    "this suggests that discreteness effects are confined to scales smaller than about twice the average interparticle distance , and do not propagate bottom - up while cosmological structures form .",
    "if confirmed , this is one important aspect of the robustness of cosmological @xmath0-body simulations .",
    "to understand more , we carry out three additional sets of simulations , which are intermediate between those with @xmath120 and @xmath121 . each set is a statistical ensemble of ten simulations produced by varying the random realization of the initial conditions , as before .",
    "the number of particles and the other input parameters are the same as in the original @xmath121 simulations .",
    "what differs in each set is discussed below .    in the first set ,",
    "the initial power spectrum @xmath122 is truncated at wavenumber @xmath123 , where @xmath36 is the box size .",
    "one simulation is shown in fig .",
    "8 ( top ) .",
    "recall that the natural truncation wavenumber is the particle nyquist frequency @xmath124 , which determines the initial number of modes @xmath125 .",
    "hence @xmath126 can be regarded as an effective particle nyquist frequency that sets the initial number of modes to @xmath127 , while the number of particles is @xmath121 . comparing this set with the @xmath120 and @xmath121 simulations",
    ", we can then study the behaviour of the statistics as the mass resolution and the initial number of modes vary independently .    in the second set ,",
    "the output density field is computed by sub - sampling the particle distribution regularly , selecting @xmath58 particles ( loop over particle index and choose every 16th particle ) .",
    "one simulation is shown in fig .",
    "8 ( middle ) .",
    "sub - sampling means loss of information at scales smaller than about twice the new average interparticle distance ( sampling theorem ) .",
    "in addition , regular sub - sampling leaves the initial particle distribution grid - like .",
    "so , if this set turns out to be similar to the @xmath120 simulations , it means that discreteness effects imply a loss of information similar to sub - sampling , and hence that their spatial range is about twice the average interparticle distance .    in the third set ,",
    "the output density field is computed by sub - sampling the particle distribution randomly , selecting @xmath58 particles ( see the selection sampling technique by knuth 1998 ) .",
    "one simulation is shown in fig .",
    "8 ( bottom ) .",
    "random sub - sampling makes the initial particle distribution poisson - like . comparing this set with the regularly sub - sampled simulations",
    ", we can then check whether the initial grid leaves any statistical trace at low redshifts .",
    "fig .  9 shows the wavelet statistics as functions of the spatial scale for five sets of simulations : the original @xmath120 and @xmath121 simulations ; and the additional simulations with power - spectrum truncation , regular and random sub - sampling . recall that @xmath120 / @xmath121 represents the case in which the spatial resolution scale ( @xmath128 ) is much smaller / larger than the average interparticle distance ( @xmath119 / @xmath129 ) .",
    "our deductions are the following :    1 .",
    "the @xmath121 simulations are more basic than the others .",
    "the wavelet statistics have featureless behaviour at high redshifts .",
    "the behaviour at low redshifts is also featureless , except that the standard deviation and the kurtosis depart from monotonicity below the spatial resolution scale .",
    "another interesting aspect of the evolution with redshift is that the skewness and the kurtosis approach zero , which means that the density field becomes approximately lognormal .",
    "2 .   a comparison between the simulations with power - spectrum truncation and",
    "the @xmath121 simulations illustrates how complexity arises if the effective particle nyquist scale is spatially resolved ( @xmath130 ) : at high redshifts the standard deviation , the skewness and the kurtosis oscillate ; at low redshifts they all depart from monotonicity below the spatial resolution scale . decreasing the number of modes also yields a systematic decrease or increase in the wavelet statistics , with one exception .",
    "a further interesting aspect of the evolution with redshift is that the simulations with power - spectrum truncation become more similar to the @xmath121 simulations .",
    "this means that there is transfer of statistical information from the modes initially excited to those initially suppressed , but the loss of information is still significant at @xmath23 . if not only the effective particle nyquist scale but also the average interparticle distance is spatially resolved , then further complexity arises ( @xmath120 simulations vs. simulations with power - spectrum truncation ) .",
    "the peculiarities of the wavelet statistics are pointed out in sect .",
    "the regularly sub - sampled simulations agree rather well with the @xmath120 simulations .",
    "this confirms that discreteness effects are insignificant beyond a scale of about twice the average interparticle distance .",
    "4 .   at @xmath21 ,",
    "random sub - sampling differs significantly from regular sub - sampling .",
    "it suppresses the minimum of the standard deviation and of the skewness , and the maximum of the kurtosis and of the mean at a scale of half the effective average interparticle distance ( @xmath131 ) .",
    "it also increases the void probability at the cell - size scale by more than a factor of three . at @xmath23 , random sub - sampling is equivalent to regular sub - sampling .",
    "therefore the initial grid has a strong imprint on the wavelet statistics at high redshifts , whereas there is no memory of the initial grid at low redshifts .      in cosmological @xmath0-body simulations ,",
    "the initial conditions are generated assuming that the random density field is gaussian .",
    "gaussianity is one of the basic cosmological assumptions .",
    "it implies that the density field is entirely characterized by its power spectrum or correlation function .",
    "( see , e.g. , peacock 1999 . )",
    "but is the density field resulting from the initial conditions really gaussian ?",
    "10 illustrates what the histogram looks like when we vary the number of particles .",
    "each histogram is shown for the range of values spanned by the density contrast , and for the subrange @xmath132 .",
    "apart from the peculiarities pointed out in sect .",
    "3.3 , note that the @xmath64 distribution has a transition for @xmath116 : it is one - sided for @xmath133 and two - sided for @xmath134 .",
    "this means that , if the spatial resolution scale is smaller than twice the average interparticle distance , as usual , then the initial density field estimated by the code is markedly non - gaussian ( though the field that the point particles are sampling is gaussian ) . the same is true even when we start the simulations as early as at @xmath135 ( cf .",
    "such inconsistency arises because , at that high force resolution , the mass distribution looks granular : there is an excess of both high density peaks and deep under - densities .",
    "such initial non - gaussianity is what this or other codes actually ` see ' at that high force resolution ; and its effects will propagate dynamically . at lower resolution ,",
    "the departure from gaussianity is moderate at @xmath21 and small at @xmath135 ( cf .",
    "figs 10 and 11 ) .",
    "technical issues are discussed in sect .",
    "the significance of discreteness effects in @xmath1cdm simulations depends on two comoving spatial scales : the force resolution @xmath3 , and the average interparticle distance @xmath4 . here",
    "@xmath3 is also the resolution scale for density and statistical estimation .",
    "our wavelet analysis shows that discreteness has a strong impact if @xmath136 :    * the simulations are inconsistent with one of the basic cosmological assumptions .",
    "in fact , the initial random density field is markedly non - gaussian , even though is assumed to be gaussian in the initial conditions ( sect .",
    "* at low redshifts the density field departs significantly from lognormality and further complexity arises ( sect .",
    "* the comoving spatial scales @xmath101 affected by discreteness span the wide range @xmath137 ( sect .",
    "6.1 ; see also sect .",
    "discreteness effects become insignificant if @xmath2 .",
    "this condition guarantees that the statistical properties of the cosmological density field are modelled accurately throughout the range of scales spanned by the simulation . in particular , this is fundamental for probing the imprints of primordial non - gaussianities on large - scale structure , which is a topic of current interest ( e.g. , dalal et al .  2007 ;",
    "grossi et al .  2008 ; hikage et al .",
    "these results have two implications .",
    "one is that @xmath138 , and not @xmath3 , is the minimum scale for extracting robust statistical information from the simulation data .",
    "the other concerns the trade - off between force and mass resolution in modern cosmological codes , which is discussed below .",
    "let us consider particle - mesh ( pm ) codes using adaptive mesh refinement ( amr ) , such as art ( kravtsov et al .",
    "1997 ) , mlapm ( knebe et al .",
    "2001 ) , ramses ( teyssier 2002 ) , and others .",
    "the condition @xmath2 can be implemented adaptively by requiring that there are no less than @xmath79 particles per cell , where @xmath79 depends on the mass - assignment / force - interpolation scheme .",
    "in fact , @xmath139 for ngp , @xmath140 for cic and @xmath141 for tsc , where @xmath11 is the cell size ( for a description of these schemes see hockney & eastwood 1988 ) .",
    "in addition , @xmath142 .",
    "hence @xmath143 for ngp , @xmath144 for cic and @xmath145 for tsc .",
    "such values are comparable to those currently used .",
    "this means that our condition is easy to fulfil , and hence discreteness effects can be kept under control in amr codes .    in tree - based codes such as gadget-2 ( springel 2005 ) and pkdgrav ( stadel 2001 ) , the force resolution is equal everywhere .",
    "the criterion for resolving the small - scale dynamics of structure formation is then more demanding and imposes @xmath136 , as is currently used .",
    "this means that it may not be easy to enforce such a criterion and our condition together , although their domains of applicability are complementary .",
    "an interesting possibility would be to let the force resolution vary with redshift so as to enforce such requirements in distinct regimes of clustering , following the transfer of power from large to small scales .",
    "a more radical alternative is to have adaptive force resolution , as in the case of amr codes .",
    "a variable softening length can now be implemented in a form that conserves momentum and energy exactly ( price & monaghan 2007 ) , and its use has also been suggested in other contexts ( e.g. , bate & burkert 1997 ; dehnen 2001 ; nelson 2006 ; price & monaghan 2007 ; wetzstein et al .",
    "2008 ) .",
    "we are very grateful to anatoly klypin for making his particle - mesh code publicly available and for help ; and to elena donghia , michael joyce , alexander knebe , lucio mayer , francesco miniati , andrew nelson and volker springel for valuable discussions .",
    "we are also grateful to an anonymous referee for constructive comments and suggestions , and for encouraging future work on the discreteness topic .",
    "the first author thanks the wonderful hospitality and strong encouragement of the institute for theoretical physics at the university of zrich .",
    "he also acknowledges the financial support of the swedish research council , and the astrosim short - visit grant 1815 by the european science foundation .",
    "agertz , o. 2004 , msc thesis ( chalmers university of technology ) baertschiger , t. , joyce , m. , sylos labini , f. , & marcos , b. 2008 , phys .",
    "e , 77 , 051114 bagla , j. s. , & prasad , j. 2008 , preprint ( arxiv:0802.2796 ) bate , m. r. , & burkert , a. 1997 , mnras , 288 , 1060 binney , j. 2004 , mnras , 350 , 939 binney , j. , & knebe , a. 2002 , mnras , 333 , 378 coles , p. , & jones , b. 1991 , mnras , 248 , 1 coles , p. , & lucchin , f. 2002 , cosmology : the origin and evolution of cosmic structure ( chichester : wiley ) coln , p. , valenzuela , o. , & avila - reese , v. 2008 , apj , 673 , 203 dalal , n. , dor , o. , huterer , d. , & shirokov , a. 2007 , preprint ( arxiv:0710.4560 ) dehnen , w. 2001 , mnras , 324 , 273 diemand , j. , moore , b. , stadel , j. , & kazantzidis , s. 2004 , mnras , 348 , 977 fang , l .- z . , & feng , l .- l .",
    "2000 , apj , 539 , 5 fang , l .- z . , & thews , r. l. 1998 , wavelets in physics (",
    "singapore : world scientific ) feng ,",
    "2007 , apj , 658 , 25 grossi , m. , branchini , e. , dolag , k. , matarrese , s. , & moscardini , l. 2008 , preprint ( arxiv:0805.0276 ) hamana , t. , yoshida , n. , & suto , y. 2002 , apj , 568 , 455 hansen , s. h. , agertz , o. , joyce , m. , stadel , j. , moore , b. , & potter , d. 2007 , apj , 656 , 631 he , p. , feng , l .- l . , & fang , l .- z .",
    "2005 , apj , 628 , 14 heitmann , k. , ricker , p. m. , warren , m. s. , & habib , s. 2005 , apjs , 160 , 28 hikage , c. , coles , p. , grossi , m. , moscardini , l. , dolag , k. , branchini , e. , & matarrese , s. 2008 , mnras , 385 , 1613 hockney , r. w. , & eastwood , j. w. 1988 , computer simulation using particles ( bristol : institute of physics publishing ) joyce , m. , & marcos , b. 2007a , phys .",
    "d , 75 , 063516 joyce , m. , & marcos , b. 2007b , phys .",
    "d , 76 , 103505 joyce , m. , marcos , b. , & baertschiger , t. 2008 , preprint ( arxiv:0805.1357 ) kayo , i. , taruya , a. , & suto , y. 2001 , apj , 561 , 22 klypin , a. , & holtzman , j. 1997 , arxiv : astro - ph/9712217 knebe , a. , & domnguez , a. 2003 , publ .",
    "australia , 20 , 173 knebe , a. , green , a. , & binney , j. 2001 , mnras , 325 , 845 knebe , a. , kravtsov , a. v. , gottlber , s. , & klypin , a. a. 2000 , mnras , 317 , 630 knuth , d. e. 1998 , the art of computer programming  vol .",
    "2 : seminumerical algorithms ( boston : addison - wesley ) kravtsov , a. v. , klypin , a. a. , & khokhlov , a. m. 1997 , apjs , 111 , 73 martnez , v. j. , starck , j .- l . , saar , e. , donoho , d. l. , reynolds , s. c. , de la cruz , p. , & paredes , s. 2005 , apj , 634 , 744 melott , a. l. 2007 , preprint ( arxiv:0709.0745 ) moore , b. , quinn , t. , governato , f. , stadel , j. , & lake , g. 1999 , mnras , 310 , 1147 nelson , a. f. 2006 , mnras , 373 , 1039 peacock , j. a. 1999 , cosmological physics ( cambridge : cambridge university press ) peebles , p. j. e. 1980 , the large - scale structure of the universe ( princeton : princeton university press ) power , c. , navarro , j. f. , jenkins , a. , frenk , c. s. , white , s. d. m. , springel , v. , stadel , j. , & quinn , t. 2003 , mnras , 338 , 14 press , w. h. , teukolsky , s. a. , vetterling , w. t. , & flannery , b. p. 2007",
    ", numerical recipes : the art of scientific computing , third edition ( cambridge : cambridge university press ) price , d. j. , & monaghan , j. j. 2007 , mnras , 374 , 1347 romeo , a. b. , horellou , c. , & bergh , j. 2003 , mnras , 342 , 337 ( paper i ) romeo , a. b. , horellou , c. , & bergh , j. 2004 , mnras , 354 , 1208 ( paper ii ) saar , e. , martnez , v. j. , starck , j .- l . , & donoho , d. l. 2007 , mnras , 374 , 1030 sirko , e. 2005 , apj , 634 , 728 smith , r. e. , et al .",
    "2003 , mnras , 341 , 1311 splinter , r. j. , melott , a. l. , shandarin , s. f. , & suto , y. 1998 , apj , 497 , 38 springel , v. 2005 , mnras , 364 , 1105 stadel , j. g. 2001 , phd thesis ( university of washington ) stuart , a. , & ord , j. k. 1991 , kendall s advanced theory of statistics ",
    "2 : classical inference and relationship ( london : hodder & stoughton  arnold ) teodoro , l. , & warren , m. s. 2004 , arxiv : astro - ph/0406174 teyssier , r. 2002 , a&a , 385 , 337 tinker , j. , kravtsov , a. v. , klypin , a. , abazajian , k. , warren , m. , yepes , g. , gottlber , s. , & holz , d. e. 2008 , preprint ( arxiv:0803.2706 ) vidakovic , b. 1999 , statistical modeling by wavelets ( new york : wiley ) vogelsberger , m. , white , s. d. m. , helmi , a. , & springel , v. 2008 , mnras , 385 , 236 wang , j. , & white , s. d. m. 2007 , mnras , 380 , 93 warren , m. s. , abazajian , k. , holz , d. e. , & teodoro , l. 2006 , apj , 646 , 881 wetzstein , m. , nelson , a. f. , naab , t. , & burkert , a. 2008 , preprint ( arxiv:0802.4245 ) zhan , h. 2006 , apj , 639 , 617"
  ],
  "abstract_text": [
    "<S> the effects of particle discreteness in @xmath0-body simulations of lambda cold dark matter ( @xmath1cdm ) are still an intensively debated issue . in this paper </S>",
    "<S> we explore such effects , taking into account the scatter caused by the randomness of the initial conditions , and focusing on the statistical properties of the cosmological density field . for this purpose , </S>",
    "<S> we run large sets of @xmath1cdm simulations and analyse them using a large variety of diagnostics , including new and powerful wavelet statistics . among other facts , we point out ( 1 ) that dynamical evolution does not propagate discreteness noise up from the small scales at which it is introduced , and ( 2 ) that one should aim to satisfy the condition @xmath2 , where @xmath3 is the force resolution and @xmath4 is the interparticle distance . </S>",
    "<S> we clarify what such a condition means , and how to implement it in modern cosmological codes . </S>"
  ]
}