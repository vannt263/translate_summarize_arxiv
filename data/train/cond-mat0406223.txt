{
  "article_text": [
    "simulations of charged systems face a big computational challenge due to the long  range nature of the electrostatic interaction . if @xmath0 is the number of charges , then the computational cost of the most naive approach to evaluate the interaction energy would scale as @xmath1 , since every charge interacts with every other charge .",
    "very sophisticated algorithms have been developed to tackle this problem and to reduce the computational complexity .",
    "the most prominent ones are the so  called p@xmath2 m method ( `` particle  particle / particle  mesh '' ) , which is based on fast fourier transforms and scales as @xmath3 @xcite , and the fast multipole method @xcite which scales linearly with @xmath0 .",
    "a similar problem arises in the simulation of brownian particles which interact hydrodynamically : their stochastic displacements are highly correlated , due to fast diffusive momentum transport through the solvent . for sufficiently slow particles , a quasi ",
    "static approximation works excellently , and in this case the correlation function decays as @xmath4 ( @xmath5 interparticle distance ) @xcite , just as in electrostatics . for these systems , it has turned out that it is both much simpler and also more efficient to explicitly simulate the momentum transfer through the surrounding solvent .",
    "this makes the simulation of several ten thousands of brownian particles feasible @xcite .",
    "although most of the computational effort goes into the flow field ( for _ two _ reasons  one needs reasonable spatial resolution of the flow field , and it moves much faster than the brownian particles ) , this approach ultimately wins , because it is inherently local , and therefore scales linearly with @xmath0 .",
    "this observation raises the question if something similar could be tried for coulomb interactions .",
    "after all , electrostatics is just the quasi  static limit of full electrodynamics",
    ". the obvious approach would be to couple a system of charges to an electromagnetic field which propagates according to the maxwell equations ( me ) , and then run molecular dynamics ( md ) .",
    "a suitable acronym for such a method might be memd ( `` maxwell equations molecular dynamics '' ) .",
    "just as in the hydrodynamic case , this is an intrinsically local algorithm , and therefore scales linearly .",
    "the instantaneous @xmath6 interaction is thus replaced by some retarded interaction travelling with the speed of light @xmath7 .",
    "using the actual physical value of @xmath7 will of course not work , since then the separation of time scales between charges and fields will be prohibitive .",
    "however , there is no need to take such a large @xmath7 value .",
    "it is sufficient to just make @xmath7 large enough such that the quasi  static approximation still holds to sufficient accuracy .",
    "this is the lesson we have learned from car  parrinello ( cp ) simulations @xcite , where the electrons are assigned an unphysically large mass , precisely for the same reason .",
    "the analogy between memd and cp actually goes much further , as we will see below",
    ". this should not be too much of a surprise , since the universal applicability of the cp approach to a wide variety of problems in physics ( e.  g. classical field theories ) has already been observed in the original publication @xcite , and exploited in the context of classical density ",
    "functional theory @xcite .",
    "the memd idea has been pursued recently by a. c. maggs and collaborators @xcite , and by us , in close contact with him .",
    "he has made a couple of very important observations , which have deepened our insight into the approach significantly , and contributed to the answer of a number of very important questions :    1 .",
    "is maxwell dynamics the only possible way to propagate the fields ?",
    "the answer is no ; it is also possible to propagate them in a _ diffusive _ fashion .",
    "this has been implemented by means of a monte carlo algorithm @xcite for a lattice gas of charges .",
    "2 .   if we restrict attention to hamiltonian or quasi  hamiltonian dynamics of the system , and want wave  like propagation of the signal , is then maxwell  style dynamics the only choice ?",
    "the answer is a cautious yes ; one can show that the maxwell equations arise in a very natural way if one derives the method along the lines of cp .",
    "3 .   is there a contradiction between the lorentz covariance of the me , and the strictly nonrelativistic setup of md ?",
    "the answer is no ; the lorentz covariance actually has to do with the fact that the value of @xmath7 is the same in all reference frames .",
    "this , however , is not the case here : in our context , @xmath7 means nothing but the propagation velocity of electromagnetic waves _ relative to the discretization lattice _ which provides an absolute reference frame ( an `` ether '' ) .",
    "is it necessary to use a large value of @xmath7 to avoid violation of a quasi ",
    "static behavior ?",
    "the answer is no as long as just static properties of the system in thermal equilibrium are considered  the values of these properties turn out to be completely independent of @xmath7 .",
    "is it necessary to apply a thermostat to the system ?",
    "@xcite claims yes , in order to avoid unwanted conserved quantities .",
    "our belief is no , based upon the fact that the particle dynamics provides lots of nonlinearities into the equations of motion . for more details , see below .",
    "how is memd implemented ?",
    "the previous papers have been rather brief on this issue ; we try to provide somewhat more detail .",
    "how does memd perform , in particular in comparison with existing methods ? in this respect , there is also so far only little information available . in the present paper ,",
    "we report some benchmark results which give us some feeling for the quality of the approach  although these are quite preliminary , and still far from providing a clear and comprehensive picture .    in",
    "what follows , we will essentially re  derive the memd algorithm put forward in ref .",
    "@xcite , and discuss some details of our implementation , which differs slightly from that of ref .",
    "we will then present some benchmark results , comparing memd with p@xmath2 m for the same system . for our chosen set of parameters ,",
    "we find rather similar or even better computational efficiency .",
    "however , this comparison should not yet be considered as the final answer : firstly , memd can probably still be speeded up significantly by combining it with a direct evaluation of yukawa  like forces on short length scales , roughly along the lines as suggested in ref .",
    "secondly , the dependence on the thermodynamic state point ( in particular , on density ) has not yet been investigated .",
    "physically , it is clear that the efficiency of memd depends ( i ) on the number of operations required to propagate the system for one time step , and ( ii ) on the time needed to build up electrostatic correlations on the relevant length scale , which is , in essence , the debye screening length . for this reason",
    ", one should expect that the efficiency depends rather strongly on the speed of light , and also on the density , since the debye length decreases as a function of density .",
    "in other words , one expects memd to work particularly well for rather dense systems simulated with a large @xmath7 value  and this is precisely the regime where our preliminary comparison has been done .",
    "we start out from maxwell s equations in vacuum , using standard si units : @xmath8 where @xmath9 is the vacuum dielectric constant , @xmath7 the speed of light , @xmath10 the electric field , @xmath11 the magnetic field , @xmath12 the charge density and @xmath13 the current density , which are coupled via the continuity equation @xmath14 electrostatics is obtained by setting the current and all time derivatives to zero , implying that the magnetic field vanishes : @xmath15 note that this set of equations also results from taking the limit @xmath16 .",
    "this means that the electric field will be just an electrostatic field as long as the charges move at much slower velocity than @xmath7 .",
    "furthermore , the lorentz force on a charge @xmath17 , @xmath18 ( @xmath19 denoting the charge s velocity ) will just reduce to the electrostatic force @xmath20 in the same limit .",
    "this is the justification of the fact that md simulations of common materials usually treat interactions of charges just as electrostatics . in turn",
    "this means that one will obtain electrostatic behavior whenever @xmath7 is large compared to all particle velocities , as already stated in sec [ sec : intro ] .",
    "the conventional approach tries to find a solution to eqs .",
    "[ eq : statics1 ] and [ eq : statics2 ] , for a given charge distribution @xmath12 .",
    "note that _ both _",
    "equations must be satisfied for strict electrostatics , since eq .",
    "[ eq : statics1 ] only fixes the longitudinal component of the electric field , while the condition of vanishing transversal component is coded in eq .",
    "[ eq : statics2 ] .",
    "no _ local _ way of finding the solution directly is known .    as a first step",
    ", we re  formulate the electrostatic problem in terms of a constrained variational problem .",
    "gauss law ( eq . [ eq : statics1 ] ) is viewed as a _",
    "constraint _ which selects a certain surface out of the space of electric field configurations ; we will call this the `` constraint surface '' ( cs ) .",
    "we now minimize the electric field energy , @xmath21 under the constraint eq .",
    "[ eq : statics1 ] .",
    "this can be done as follows : suppose @xmath22 is _ some _ field on the cs , where a non  vanishing transversal component is admitted .",
    "then all fields on the cs can be written in the form @xmath23 where @xmath24 is allowed to pass through all field configurations without any restriction .",
    "we thus write @xmath25 in terms of the @xmath24 field , @xmath26 and the minimum condition as @xmath27 or @xmath28 i.  e. eq . [ eq : statics2 ] . the variational problem is thus seen to be equivalent to the original electrostatic problem .",
    "we can say that the system is on its born  oppenheimer surface ( bos ) if , for given charge distribution @xmath12 , the electric fields are on the constraint surface , and the field energy is minimal .",
    "alternatively , one may also look at the problem in fourier space : let the fourier transform of @xmath29 be defined as @xmath30 and let @xmath31 denote the unit vector in the direction of @xmath32 .",
    "then we can decompose the electric field into a longitudinal component @xmath33 and a transversal component @xmath34 , @xmath35 with @xmath36 and @xmath37 .",
    "[ eq : statics1 ] and [ eq : statics2 ] are transformed to @xmath38 and @xmath39 , or @xmath40 and @xmath41 .",
    "furthermore , the electric field energy can be written as @xmath42 again , one sees that the longitudinal component is determined by the charge distribution , while the transversal component is just minimized away .    in the spirit of cp simulations",
    ", we now wish to replace the precise solution of the minimization problem by some ( to a certain degree artificial ) dynamics which keeps the system precisely on the cs but allows fluctuations around the bos",
    ". an interesting observation by maggs @xcite is that _ arbitrarily large _",
    "deviations from the bos are permitted as long as one does statistical mechanics in the canonical ensemble , and is interested in static properties only .",
    "this is easily understood by looking at eq .",
    "[ eq : newelectricfieldenergy ] : there one sees that the total hamiltonian decomposes into two _ additive _ contributions : the first term @xmath43 is just the standard electrostatic coulomb hamiltonian , while the second term @xmath44 is the energy stored in the additional transversal degree of freedom , describing the amount of deviation from the bos .",
    "additivity , however , implies that the boltzmann factor factorizes , @xmath45 ( @xmath46 , where @xmath47 is the absolute temperature and @xmath48 boltzmann s constant ) , which in turn means that the ( artificial ) transversal degree of freedom is statistically independent from the physical longitudinal one , and hence does not affect statistical averages of observables which only depend on the charge configuration .",
    "this will be worked out in some more detail at the end of this section .",
    "having relaxed the condition eq .",
    "[ eq : statics2 ] , we now turn our attention to eq .",
    "[ eq : statics1 ] .",
    "suppose that at time @xmath49 we have found the full solution to eqs .",
    "[ eq : statics1 ] and [ eq : statics2 ] by some ( slow ) procedure ; we call this solution @xmath50 .",
    "this is obviously on the cs .",
    "the system will then stay on the cs if the _ time derivative _ of gauss law vanishes : @xmath51 now as the dynamics proceeds , the continuity equation , eq . [ eq : continuity ] , will automatically hold as long as charges are moved around in the simulation cell by a local updating scheme .",
    "this allows us to re  write eq .",
    "[ eq : timederivativeofgauss ] as @xmath52 we can therefore use the current density to straightforwardly construct an electric field which stays on the cs .",
    "one just has to integrate @xmath53 in time ; this is a manifestly local updating scheme .",
    "we thus obtain @xmath54 this solution obviously is on the cs , but unfortunately not the correct electric field ( example : for a constant ring current with vanishing charge density one would obtain an electric field which grows linearly in time ) .",
    "we therefore generalize this , as before , to @xmath55 with @xmath56 . however , we now do not minimize @xmath57 with respect to @xmath24 , but rather supply some artificial dynamics to this field .",
    "there is no unique way of doing this .",
    "one possibility is to postulate an overdamped relaxational dynamics governed by @xmath25 ; this has been explored in detail in ref .",
    "@xcite . in the present paper ,",
    "we rather study , as in ref .",
    "@xcite , a cp  style dynamics , where the equation of motion for @xmath24 is of second order in time .",
    "we thus need to supply an initial condition for @xmath58 , too ; we choose @xmath59 . the most straightforward way to generate a coupled dynamics is to add a kinetic energy term @xmath60 to the system lagrangian ; here the prefactor is a mass  like parameter , to be freely chosen in analogy to the electron mass in cp .",
    "@xmath7 will later on turn out to be the speed of light .    since @xmath22 depends on the charge distribution in a not very straightforward way , it is more convenient to rather write the lagrangian in terms of the total field @xmath10 , and to take into account the integration of @xmath61 by means of a non  holonomic constraint which keeps the system on the cs : @xmath62 i.  e. @xmath63 this is nothing but the fourth maxwell equation , eq .",
    "[ eq : maxwell4 ] , if we identify @xmath64 .",
    "we thus see that the continuity equation ( eq . [ eq : continuity ] ) as well as the first and fourth maxwell equation ( eqs .",
    "[ eq : maxwell1 ] and [ eq : maxwell4 ] ) are built into the scheme regardless of the details of the @xmath24 dynamics .    denoting the particle masses with @xmath65 , their coordinates with @xmath66 , and the interparticle potential ( of _ non_electromagnetic type ) with @xmath67 ,",
    "we can thus write the lagrangian as @xmath68 here the field @xmath69 is a lagrange multiplier ; it will later on turn out to be the vector potential .",
    "such a constrained variational problem with lagrange multipliers can be treated by arnold s so  called `` vakonomic '' ( `` variational of the axiomatic kind '' ) formalism @xcite . the recipe how to do variational calculus within that formalism",
    "is very simple : one just has to treat all occuring variables , including the lagrange multipliers , as if they were independent degrees of freedom .",
    "it is thus straightforward to obtain the equations of motion .",
    "variation with respect to @xmath69 just yields the fourth maxwell equation , eq .",
    "[ eq : newmaxwell4 ] .",
    "variation with respect to @xmath10 yields @xmath70 while from variation with respect to @xmath24 we obtain @xmath71 this is equivalent to the remaining two maxwell equations , eqs .",
    "[ eq : maxwell2 ] and [ eq : maxwell3 ] : inserting eq .",
    "[ eq : relationewitha ] , plus @xmath72 , into eq .",
    "[ eq : motionoftheta ] , we obtain directly eq .",
    "[ eq : maxwell2 ] .",
    "furthermore , we can integrate eq .",
    "[ eq : motionoftheta ] in time , which , together with @xmath73 , and the initial condition ( @xmath69 and @xmath58 both vanish at time @xmath74 ) yields @xmath75 taking the divergence of this equation , one directly obtains eq .",
    "[ eq : maxwell3 ] .",
    "the interpretation of @xmath69 as the vector potential is also obvious from eqs .",
    "[ eq : relationewitha ] and [ eq : relationhwitha ] , since these are the standard relations between the electromagnetic fields and the vector potential .",
    "it should be noted that our derivation has led us in a natural way to the so  called temporal gauge @xcite where the scalar potential vanishes identically , and there is no restriction on @xmath76 .    for deriving the equations of motion for the particles ,",
    "we first note that charge and current densities are written as @xmath77 where @xmath78 is the charge of the @xmath79th particle .",
    "hence the current term in the lagrangian is written as @xmath80 after a few lines of algebra one then finds the particle equations of motion : @xmath81 where the lorentz force @xmath82 is given by eq .",
    "[ eq : lorentzforce ] .    to summarize : the requirement of local updates , combined with treating the deviations from the bos in the cp manner , has led us in a natural way to standard electromagnetism , where the temporal gauge turns out to be the most appropriate one for our purposes .",
    "it should be stressed that this is a consistent non  relativistic setting , where the equations of motion are valid in one particular chosen frame of reference .    as it is common practice in electromagnetism @xcite , we can now simplify the lagrangian treatment by considering @xmath69 as the ( only ) field degree of freedom , while @xmath10 and @xmath11 are derived quantities according to eqs .",
    "[ eq : relationewitha ] and [ eq : relationhwitha ] .",
    "the dynamical system of charges and electromagnetic field is then completely described by ( i ) the equation of motion for the particles , eq .",
    "[ eq : motionofparticles1 ] , and ( ii ) the fourth maxwell equation , eq .",
    "[ eq : maxwell4 ] , which is the inhomogeneous wave equation for @xmath69 : @xmath83 to derive these two equations of motion , it is sufficient to consider the lagrangian @xmath84 this dynamics has a couple of very desirable properties : firstly , since the dynamics is manifestly hamiltonian ( it is derived from a lagrangian ) , it conserves the phase  space volume and the energy , the latter being given by @xmath85 furthermore , one can show that the total momentum , given by @xmath86 is conserved as well .",
    "for the proof one can employ the dynamic equations for the particles and fields , and make use of the identity @xmath87 which holds for any vector field @xmath88 as long as partial integration with vanishing boundary terms can be applied .    at this point , we modify the equations of motion by discarding the magnetic force on the particles , @xmath89 this simplifies the algorithm significantly , while the most important features still hold .",
    "of course , this modified dynamics is no longer hamiltonian . nevertheless , the energy , as given by eq .",
    "[ eq : totalenergy ] , is still conserved .",
    "furthermore , the ( properly defined ) phase space volume is also conserved . in order to see this , we first write the equations of motion in pseudo  hamiltonian style as @xmath90 where the @xmath91 are the kinematic ( and _ not _ the canonically conjugate ! ) particle momenta , and the fields @xmath69 and @xmath10 ( roughly ) play the roles of coordinates and momenta , respectively .    now , phase space volume conservation for some ( high  dimensional ) dynamical system , given by the equation @xmath92 where @xmath93 comprises the set of all phase  space variables , holds if and only if @xmath94 ( in analogy to incompressible flow in hydrodynamics )",
    ". it is trivially checked that this relation does hold for our system .",
    "however , momentum conservation does _ not _ hold for our modified dynamics .",
    "the momentum carried away by the electromagnetic waves is not completely balanced by the particle momenta .",
    "rather , we have the relation @xmath95 this is not a catastrophe , since momentum conservation is usually only important in studies of dynamics . however , for such calculations one has to use a fairly large value of @xmath7 anyways , since otherwise the electromagnetic field is not in its quasi ",
    "static limit , and the particle trajectories get too much distorted .",
    "furthermore , one must expect that momentum conservation is also violated as a result of the lattice discretization , which breaks the translational invariance of the system .",
    "we now assume that the dynamics is sufficiently nonlinear to make the system ergodic .",
    "this seems reasonable for the case of a many  charge system , in particular if the potential @xmath67 has a strongly repulsive core to facilitate `` collisions '' .",
    "we therefore assume that the system has no further important conservation law except for the fact that it stays on the cs , and that the energy @xmath96 is conserved .",
    "the additional conserved quantities mentioned in ref . @xcite probably apply only to the charge ",
    "free case , in which the system is harmonic and hence integrable",
    ". we can hence apply standard statistical physics to the system and assume that the dynamics results in an equidistribution of states in terms of the variables @xmath97 and @xmath10 ( microcanonical ensemble ) . making use of the fact that thermodynamic ensembles are equivalent in the large  system limit",
    ", we can instead employ the canonical ensemble , which is easier . with @xmath46 , where @xmath48 is boltzmann s constant and @xmath47 the absolute temperature , we may therefore write the partition function as @xmath98 where @xmath96 is given by eq .",
    "[ eq : totalenergy ] .",
    "it is now straightforward to integrate out the momenta , the @xmath69 field , and the transversal component of the @xmath10 field .",
    "the integration over the longitudinal component of @xmath10 cancels with the delta function , such that the only remaining degrees of freedom are the particle coordinates , for whose potential of mean force we hence find @xmath99 here @xmath10 is nothing but the solution of the standard electrostatic problem , eqs .",
    "[ eq : statics1 ] and [ eq : statics2 ] , i.  e. the coulomb field . inserting this field into eq .",
    "[ eq : potentialofmeanforce ] , we find the standard coulomb hamiltonian , @xmath100 this demonstrates that the particles behave statistically in the same way as if they would directly interact coulombically .",
    "this concludes the derivation .",
    "on the lattice , however , we have to take into account that the above hamiltonian includes unphysical self  interactions , which we have to subtract ( without such a subtraction the self  interaction would ultimately , i.  e. in the continuum limit of vanishing lattice spacing , completely dominate the behavior ) , and that instead of the @xmath101 coulomb field we have to insert the lattice  discretized solution of the lattice equations corresponding to eqs .",
    "[ eq : statics1 ] and [ eq : statics2 ] .",
    "this shall be discussed in the next section .",
    "for implementation on the computer , the equations need to be discretized with respect to both space and time . for the moment",
    ", we will only consider the spatial discretization , and consider time still as a continuous variable .",
    "the issue of time discretization is discussed in [ app : integrator ] .",
    "we use a spatial discretization scheme @xcite where the charges are interpolated linearly to the eight surrounding lattice sites of a simple  cubic lattice .",
    "the currents , as well as the fields @xmath10 and @xmath69 are put onto the connecting links .",
    "the curl of link variables is put onto the lattice plaquettes , and the curl of plaquette variables onto the links ( in both cases one uses the four fields which encircle the result ) .",
    "furthermore the divergence of link variables is put onto the sites , using the adjacent fields , while the gradient of a scalar variable located on the sites is a link variable . for more details , see [ app : discretization ] .",
    "let us now discuss how the coulomb potential looks on the lattice . obviously , we have to solve eqs .",
    "[ eq : statics1 ] and [ eq : statics2 ] on the lattice . as in the continuum",
    ", we can take into account the longitudinal character of the electric field by the ansatz @xmath102 where @xmath103 is the electrostatic potential on the sites , and @xmath104 is the lattice ",
    "discretized gradient .",
    "we thus obtain the poisson equation on the lattice , @xmath105 where the lattice version of the operator @xmath106 is clear from the previous definitions of gradient and divergence .",
    "a system with periodic boundary conditions is invariant with respect to lattice translations , and this allows us to write @xmath107 where @xmath108 is the lattice spacing , @xmath109 denotes the sites , and @xmath110 is the lattice green s function , obeying the equation @xmath111 where @xmath112 is the kronecker symbol , i.  e. @xmath113 for @xmath114 , and @xmath115 for all other lattice sites .    for an @xmath116 lattice with periodic boundary conditions",
    "the solution can be obtained straightforwardly via discrete fourier transformation . at the site",
    "@xmath117 one finds @xmath118 where @xmath119 indicates that @xmath120 is excluded ( for reasons of overall charge neutrality ) , and @xmath121 is given by @xmath122 a lot is known about this function , in particular in the limit @xmath123 @xcite . for our purposes , however , it is sufficient to note that ( i ) @xmath110 can be calculated at the beginning of the simulation once and for all , including the finite size effect , and that ( ii ) @xmath124 is _ finite _ , even in the limit @xmath125 ( but , of course , keeping @xmath108 fixed ) .",
    "we thus find for the potential of mean force ( cf .",
    "[ eq : potentialofmeanforcecoulomb ] ) @xmath126 where @xmath127 is the charge on site @xmath109 .",
    "now , the charges on the sites are related to the charges @xmath78 on the particles via the interpolation scheme , @xmath128 and @xmath129 , where @xmath130 is the `` smearing '' function . inserting this into eq .",
    "[ eq : potentialofmeanforcediscrete ] , we find an effective interaction between different particles @xmath131 , but also an unphysical self  energy term for @xmath132 .",
    "this is given by @xmath133 this depends explicitly on the particle coordinate @xmath134 .",
    "the physical interpretation is simply that the coulomb repulsion from the interpolated charges on the cube corners tries to drive the particle into the center of the cube . for small lattice spacings",
    ", this effect dominates over all other interactions , and therefore must be taken care of . for this reason ,",
    "we add a term @xmath135 to the interparticle potential @xmath67 , and apply the corresponding force to the particles .",
    "this is feasible since @xmath110 is known explicitly , and the smearing function @xmath130 is short  ranged , such that @xmath136 runs over eight sites only .",
    "rottler and maggs @xcite suggest another subtraction scheme which has the nice property of introducing another optimization parameter @xmath137 into the method .",
    "essentially , interactions up to the length scale @xmath138 are done in real space , while only the residual long  range part beyond @xmath138 is treated via the dynamics .",
    "the disadvantage , however , is that it does not treat the lattice effects completely rigorously .",
    "we hence believe that probably the best method consists of a combination between our lattice green s function subtraction , and their `` dynamic yukawa '' approach .    in order to understand the latter ,",
    "let us first consider the functional @xmath139 and study , for fixed @xmath12 , @xmath140 it is straightforward to see that ( i ) this variational problem is equivalent to the poisson equation for the electrostatic potential @xmath103 , and that ( ii ) insertion of the solution into @xmath141 yields @xmath142 , i.  e. the correct electrostatic energy . however , this functional is useless for dynamic simulations where one would try to simulate a coupled dynamics of @xmath12 and @xmath103 .",
    "the reason is that the @xmath143 term has the wrong sign , such that arbitrarily large variations of @xmath103 are favored and the simulation would be inherently unstable ( the partition function for integrating out the @xmath103 field would not exist ) .",
    "a well  behaved theory , however , is obtained by just turning the sign of the @xmath143 term : @xmath144 this results in @xmath145 , and insertion into the functional yields again @xmath146 .",
    "since , however , @xmath103 is just the negative of the real ( physical ) electrostatic potential , one obtains a theory which describes attraction between like charges and repulsion between unlike charges .",
    "we now introduce an additional field degree of freedom @xmath103 , and couple this to the original method ( lagrangian ) via @xmath147 here @xmath148 is another dynamical parameter of dimension velocity .",
    "it can be set identical to @xmath7 , but need not .",
    "this modified method would result in an additional potential of mean force between the charges which would _ exactly cancel _ the original coulomb potential ( including self  terms ) .",
    "this is apparently not useful .",
    "however , we can introduce a slightly modified coupling with a screening parameter @xmath149 : @xmath150 this introduces an additional potential of mean force between the charges , which , in the continuum limit , would read @xmath151 such that unlike charges repel each other with a screened coulomb interaction .",
    "this weakens the original coulomb interactions on a local scale , and can be corrected by adding @xmath152 to the standard interparticle potential . here",
    "one can use the continuum version of the potential ; this will only serve to decrease the influence of lattice artifacts .    in principle",
    ", this also alleviates the self ",
    "energy problem .",
    "however , the lattice green s functions of the unscreened and screened coulomb case are slightly different and only coincide in the limit @xmath153 . in preliminary tests we found that fairly small screening parameters are needed to overcome the self ",
    "energy problem with high accuracy .",
    "we therefore believe that one should rather try to subtract the self  energy for both the unscreened and the screened interaction separately by the respective exact lattice green s function . in this case",
    ", the yukawa subtraction would no longer serve the purpose of overcoming self ",
    "energies , but rather to resolve interparticle interactions rather faithfully on a local scale , such that ( hopefully ) larger lattice spacings are feasible .",
    "further investigations are necessary on this issue .",
    "as a simple test system , we have studied @xmath0 charged particles in a cubic box with periodic boundary conditions .",
    "they interact via a purely repulsive lennard  jones ( lj ) potential @xmath154            & \\hspace{0.5 cm } r \\le 2^{1/6}\\sigma \\\\          0 & \\hspace{0.5 cm } r \\ge 2^{1/6}\\sigma        \\end{array } \\right .   .\\ ] ] we choose a unit system where the potential parameters @xmath155 and @xmath156 , as well as the particle mass @xmath157 , are set to unity .",
    "time is thus measured in units of @xmath158 .",
    "we study systems at temperature @xmath159 and particle number density @xmath160 .",
    "the equations of motion were integrated by the algorithm outlined in [ app : integrator ] ( no yukawa subtraction ) , using a time step @xmath161 .",
    "the friction constant for the langevin thermostat was set to @xmath162 .",
    "each particle is assigned a charge @xmath163 .",
    "the strength of the electrostatic interaction is given in terms of the bjerrum length @xmath164 we first started out with the value @xmath165 ( rather strong electrostatic coupling ) .",
    "we chose this system because it had been studied previously by p@xmath2 m @xcite .",
    "however , it has turned out that this is not the best state point for a benchmark , since the coupling is so strong that it actually induces phase separation ( gas  liquid transition ) .",
    "this is in accord with the phase diagram presented in ref .",
    "@xcite ; the system studied there is not too different from ours .     and",
    "bjerrum length @xmath165 , comparing data obtained with p@xmath2 m with those from memd for different lattice spacings.,width=377 ]     and bjerrum length @xmath165 , again comparing p@xmath2 m with memd.,width=377 ]    the number of particles was set to @xmath166 .",
    "both the p@xmath2 m and the memd calculations were done within the framework of the `` espresso '' software package @xcite of the theory group at the mpi for polymer research , mainz . in both cases",
    "we used a program version which was fully parallelized , based upon domain decomposition .",
    "the p@xmath2 m parameters were optimized using an automatized routine building upon the work of refs .",
    "@xcite , where a formula for the relative error of the force per particle , @xmath167 , was derived .",
    "the routine provides optimized simulation parameters after an upper bound for @xmath167 has been supplied . for our system",
    ", we required an accuracy of @xmath168 , resulting in the following parameters : mesh size @xmath169 ; 5th order charge assignment ; real  space cutoff @xmath170 ; @xmath171 ( this parameter controls the split  up of the computational load between real and fourier space ) . for the memd calculations",
    ", we used @xmath172 and varied the lattice spacing @xmath108 .",
    "the pair correlation functions of this system are shown in figs .",
    "[ fig : corrplusplus20 ] and [ fig : corrplusminus20 ] .",
    "the runs were long enough to equilibrate the system reasonably well on the local scale .",
    "as a control , we also ran a more accurate p@xmath2 m simulation and found no visible difference from the original p@xmath2 m result . the memd results in turn",
    "confirm that the static correlations converge towards those of the real electrostatic system when the lattice spacing @xmath108 decreases .",
    "we found a value of @xmath173 acceptable , corresponding to a @xmath174 lattice for the @xmath166 system .",
    "for such a fine lattice , there is practically never more than one particle per cube .",
    "we did not study this system further , since benchmarks at this state point are severely hampered by the gas  liquid transition : on the one hand , the system needs a long time to equilibrate ( i.  e. to condense macroscopically ) , and on the other hand the particle density is very inhomogeneous in the relaxed state .",
    "this , in turn , is very detrimental to efficient geometric parallelization , since some processors have to treat very many particles , while others work on essentially none . in other words ,",
    "such a system will behave very poorly with respect to load  balancing , and will give no good hint on the parallelization efficiency under normal ( homogeneous ) conditions .     and bjerrum length @xmath175 , comparing data obtained with p@xmath2 m with those from memd for different lattice spacings.,width=377 ]     and bjerrum length @xmath175 , again comparing p@xmath2 m with memd.,width=377 ]    we hence abandoned this state point and instead systematically studied the weaker coupling @xmath175 , at first restricting the particle number to @xmath176 .",
    "furthermore , we slightly increased the particle friction coefficient to @xmath177 .",
    "all other parameters ( density , temperature ) were left unchanged .",
    "this is well in the homogeneous phase , and the pair correlation functions show much less structure , see figs .",
    "[ fig : corrplusplus5 ] and [ fig : corrplusminus5 ] .",
    "it also turns out that here a larger memd lattice spacing @xmath178 is sufficient to reasonably approximate the p@xmath2 m result .",
    "m , as a function of the accuracy parameter @xmath167.,width=377 ]    our next aim is to compare the efficiency of p@xmath2 m and memd . in order to do this in a meaningful way ,",
    "it is necessary to make sure that ( i ) both methods use parameters which yield roughly the same accuracy in the representation of the electrostatic interaction , and that ( ii ) both methods use parameters for which the results are obtained most quickly , within the accuracy constraint .",
    "the ( thermally averaged ) electrostatic energy @xmath67 is a variable which , on the one hand , is easy to evaluate , and , on the other hand , reasonably sensitive to the long  range correlations between the particles .",
    "we therefore used this observable for calibrating the accuracy of the simulations . for p@xmath2 m , we therefore calculated @xmath67 as a function of the accuracy parameter @xmath167 .",
    "the results are shown in fig .",
    "[ fig : calibrationp3 m ] .",
    "the error bars were obtained as statistical error bars , using the block average method @xcite . from these results",
    ", one sees that an accuracy parameter of @xmath179 is good enough .",
    "this corresponds to the following p@xmath2 m parameters : mesh size @xmath180 , third  order charge assignment , real  space cutoff @xmath181 , @xmath182 .",
    ".,width=377 ]    at this point , it is necessary to comment on the evaluation of @xmath67 in memd .",
    "the electric and magnetic field energies are given by @xmath183 and @xmath184 , respectively .",
    "both types of fields have one longitudinal and two transversal degrees of freedom per lattice site .",
    "the longitudinal magnetic degrees of freedom are however not excited , due to @xmath185 .",
    "furthermore , the magnetic part of the hamiltonian is strictly quadratic , and the equipartition theorem can be applied . for this reason , the thermally averaged magnetic field energy is just given by @xmath186 , where @xmath187 is the number of lattice sites .",
    "we have checked this relation , and found good agreement , except for a deviation of a few percent , which decreases with the time step , and must hence be attributed to discretization errors  the exact boltzmann distribution is only generated in the limit of vanishing time step .",
    "this finding is a strong support of our belief that , except for the obvious conservation laws for the longitudinal fields , there are no further hidden conserved quantities in the system , and a thermostatting of the magnetic field is not necessary .",
    "we can also apply the equipartition theorem to the transversal part of the electric field energy , and hence the thermally averaged coulomb energy is given by @xmath188 where @xmath189 is the self  energy , as discussed in sec .",
    "[ sec : selfenergy ] .",
    "we have measured @xmath67 as a function of the lattice spacing @xmath108 , using this recipe .",
    "while the results were in reasonable agreement with the p@xmath2 m results , we did not find convergence for @xmath190 .",
    "rather , it seems that @xmath67 diverges for small @xmath108 ( apparently like @xmath191 , though the data are not precise enough to be sure ) .",
    "it turns out that this divergence is reduced by reducing the time step , i.  e. it is again an effect of discretization errors .",
    "our explanation is that the cancellation of the self ",
    "energy is not perfect , because the subtraction term assumes the exact coulomb lattice green s function , while the simulation produces an effective lattice green s function , which is slightly distorted by discretization errors .",
    "this effect is crucial for the energy calculation ( and probably also for the evaluation of the pressure , and related quantities ) , but not for the particle configurations , which are stabilized by the repulsive lj interactions .",
    "probably that problem must be solved by combining memd with a monte carlo procedure , which can enforce strict detailed balance , and thus produce the _ exact _ boltzmann distribution . for the moment",
    ", we just solved the problem by taking the particle configurations produced by memd , and using accurate p@xmath2 m for evaluating @xmath67 .",
    "the results , which now do converge , and give good agreement with the p@xmath2 m data , are shown in fig .",
    "[ fig : calibrationmemd ] .",
    "again , we attribute the small remaining systematic deviation to discretization errors . taking all these considerations together",
    ", we took the lattice constant @xmath178 as a value which produces sufficiently accurate data , consistent with our findings from the pair correlation function .",
    ".,width=377 ]    having fixed the parameters for accuracy , we now turn to optimizing the speed . in p@xmath2 m ,",
    "this was already done by the automatic routine ( see above ) . in memd",
    ", we still have the speed of light @xmath7 at our disposal .",
    "this parameter only influences the dynamics of the system , but not the statics .",
    "we actually checked that @xmath67 does not systematiclly vary with @xmath7 within our error bars  such a dependence could still be possible as a result of discretization errors .",
    "furthermore , the cpu time necessary for one update step does not depend on @xmath7 .",
    "hence one would like to take a value of @xmath7 for which the configurations decorrelate particularly quickly . in principle , each observable and its time autocorrelation function would have to be considered separately @xcite .",
    "this is of course impractical , and hence we have taken the simpler criterion that the diffusion constant @xmath192 of the particles , obtained from their mean square displacement , should be maximized .",
    "the corresponding data are shown in fig .",
    "[ fig : diffusion ] .",
    "one sees that @xmath192 first increases as a function of @xmath7 , but then saturates at a value which is in good agreement with the p@xmath2 m value , except for some discretization errors .",
    "this nicely confirms the expectation that the dynamic properties should converge to electrostatic behavior for @xmath193 .",
    "we thus have the very favorable situation that computational efficiency for the statics and reasonable reproduction of the dynamics are not mutually exclusive , but rather congruent .",
    "however , this does not mean that one should just simply take a huge @xmath7 value .",
    "rather , @xmath7 has to be small enough such that the courant stability criterion @xcite , @xmath194 , is still satisfied . for our parameters , @xmath195 , and hence @xmath7 should be significantly smaller ( in fact , our program crashed for @xmath196 ) . therefore , we use the value @xmath197 .    for the calibrated and optimized parameters , it makes sense to look at the speed in terms of cpu time .",
    "we ran the system on an amd athlon mp 2000 + processor for 2000 md time steps .",
    "since the diffusion constants for both methods are essentially identical , we do not need to take into account different rates of decorrelation . for p@xmath2",
    "m , the run used 17 seconds of cpu time , while for memd 16 seconds were needed .",
    "this shows that memd for a system of this density is a comptetitive alternative to p@xmath2 m .     as a function of the number of processors , for both nemd and p@xmath2 m",
    ". for further details , see text.,width=377 ]    furthermore , we studied the scalability of our parallel programs at this state point . to this end",
    ", we systematically increased the particle number and the number of processors such that each processor keeps @xmath198 particles on average .",
    "the simulations were run on an ibm regatta h server , where @xmath199 time steps were used for equilibration , and another @xmath199 steps for measuring the cpu time .",
    "the p@xmath2 m parameters ( lattice constant of the mesh , real  space cutoff , @xmath200 ) were left unchanged throughout , since ( i ) one should expect that these values are reasonably close to the optimum also for larger systems , according to refs .",
    "@xcite , and ( ii ) the automated optimization routine does not work very well for a very large number of particles . for a single processor ,",
    "the timings were @xmath201 seconds for p@xmath2 m and @xmath202 seconds for memd .",
    "we do not know for sure why the relative efficiency is so much different compared to the amd processor , but speculate this might have to do with more efficient handling of memory for the regatta architecture ( note that memd is quite memory  intensive , due to all the various field variables ) .",
    "figure [ fig : scalability ] presents the scalabity factors as a function of the number of processors , for both methods .",
    "the scalability factor @xmath130 is defined as @xmath203 where @xmath0 is the number of particles on a single processor , @xmath204 the number of processors , and @xmath205 the total cpu time for a given number of steps .",
    "note that for p@xmath2 m we can produce reasonable data only for a processor number which is a power of eight , due to the fast fourier transform in each spatial direction . for eight processors , we find that the scalability of memd is slightly better than for p@xmath2 m .",
    "furthermore , for memd we find reasonably acceptable ( though not excellent ) scalability behavior up to @xmath206 processors .",
    "memd is rather easy to implement and to parallelize .",
    "the numerical results , though being far from conclusive yet , seem to indicate that the algorithm is a competitive alternative to existing schemes for sufficiently dense systems .",
    "however , in electrostatic problems one often goes to much smaller densities .",
    "if we would apply the present memd method to such a dilute system , the number of grid points would become overwhelmingly large .",
    "p@xmath2 m does not have this problem ; due to the split  up of the work between real space and fourier space it is possible to keep the number of grid points reasonably small .",
    "it is therefore clear that memd for such systems can only be competitive if it is also possible to use a reasonably coarse grid .",
    "we believe that this might be possible by introducing yukawa subtraction combined with our green s function subtraction for both the unscreened and the screened interaction .",
    "this further optimization of the method is left for future investigation .",
    "another problem which needs to be addressed is the consistent handling of the discretization errors in calculating the energy , and related quantities  as we have seen , these interact in a very unfavorable way with the self  energy problems .",
    "we believe that this can be solved by combining memd with monte carlo , such that the boltzmann distribution is reproduced exactly , and the potential of mean force is known exactly .",
    "moreover , the dynamic properties of the algorithm have to be studied in more detail .",
    "in particular , it is necessary to investigate the accuracy of momentum conservation , and how this depends on the lattice spacing and the speed of light .",
    "this latter question is particularly important when considering applications which aim at dynamic properties , like , e.  g. the dynamic behavior of charged colloidal suspensions .",
    "much remains to be done , but the existing results are reasonably encouraging .",
    "stimulating discussions with kurt kremer , christian holm , jrg rottler , and , in particular , vladimir lobaskin and tony maggs are gratefully acknowledged .",
    "we thank bernward mann for supplying some of the p@xmath2 m benchmark data .",
    "a particularly useful spatial discretization scheme @xcite works as follows : the charges are interpolated onto the vertices @xmath109 of a simple  cubic lattice with lattice spacing @xmath108 . if the charge @xmath78 is located at position @xmath134 in continuous space , then some nearby sites @xmath109 are assigned some partial charges @xmath207 ( @xmath130 denoting a `` smearing '' function ) such that @xmath208 or @xmath209 .",
    "the total charge on site @xmath109 is the sum of the contributions from all particles , @xmath210 , and the charge density is written as @xmath211 .",
    "different choices for @xmath130 are possible ; we have chosen linear interpolation to the eight vertices which form the cube in which the particle resides :    @xmath212    here @xmath213 , @xmath214 and @xmath215 denote the lattice coordinates of the vertices .",
    "now , the vector fields @xmath13 , @xmath69 and @xmath10 are put on the _ links _ which connect the vertices , in such a way that they are aligned with the links .",
    "for instance , a link oriented along the @xmath213 axis would contain a variable @xmath216 which is the electric field at the position of the link , and which is positive if @xmath10 points into the @xmath217 direction , while it is negative if it points in the @xmath218 direction .",
    "the divergence of such fields is put onto the sites , such that one just takes the differences of the field values associated with those six links which are directly connected to the site .",
    "conversely , the curl of such fields is put onto the _ plaquettes _ by taking differences from the four field values which encircle the plaquette .",
    "the result is a vector perpendicular to the plaquette ; positive ( negative ) field values are associated with a vector pointing in the @xmath217 ( @xmath218 ) direction ( for the case that the plaquette is perpendicular to the @xmath213 axis ) .",
    "obviously , the fields @xmath24 and @xmath11 must be such plaquette variables . the curl of plaquette fields is put onto the links , by taking differences from the four plaquettes adjacent to that link . finally , the divergence of a plaquette field is put into the center of the cubes , by taking differences from the six plaquettes which enclose the cube . with these definitions",
    "it is easy to see that the divergence of a curl vanishes identically , as in the continuum , both for link and for plaquette fields .",
    "furthermore , we can define the gradient of a scalar field , the latter being on the sites .",
    "the result is put on the links and obtained by just taking the difference between the field values on the adjacent sites . with this definition",
    ", one sees that the curl of a gradient vanishes , too .",
    "these identities are extremely important , since they allow us to decompose fields uniquely into longitudinal and transversal components , and to apply standard procedures of vectorial calculus also on the lattice .",
    "the particle motion generates currents on the surrounding links .",
    "we again use a linear interpolation scheme for @xmath13 , where the current is distributed onto the twelve links which surround the cube in which the particle is : for a link @xmath219 oriented in the @xmath213 direction the current contribution from particle @xmath79 is @xmath220 where @xmath221 is the @xmath213 component of the particle s velocity , while @xmath222 and @xmath223 are the charge weight factors of the two sites which are connected by the link . for the @xmath214 and @xmath215 direction , the analogous procedure is applied .",
    "it is easy to see that the space  discretized continuity equation holds exactly .",
    "similarly , the discretized version of the fourth maxwell equation ( eq . [ eq : maxwell4 ] ) implies that the discretized version of gauss law ( eq . [ eq : maxwell1 ] ) holds exactly for all times if it holds at time @xmath74 .",
    "the discretization scheme is therefore suitable to keep the system on the constraint surface .",
    "apart from interpolating the charges and currents onto the lattice , we also need to interpolate the electric field onto the particles in order to calculate the electric force . here",
    "we use the same scheme as for the current ( eq .",
    "[ eq : interpolationofcurrent ] ) , i.  e. the field in , e.  g. , the @xmath213 direction is obtained by summing the fields from the four surrounding links in @xmath213 direction , weighted by the sum of the two charge weight factors of the sites connected by that link .    using this scheme , the whole theory of sec .",
    "[ sec : theory ] is consistently discretized .",
    "the system is initialized by putting particles into the simulation cell ( which has periodic boundary conditions ) , assigning velocities and charges to them ( of course , the overall system is neutral ) , and calculating the electrostatic electric field as follows : first , we exploit the fact that the solution of eq .",
    "[ eq : maxwell1 ] is trivial in one dimension .",
    "this allows us to find a simple solution by just treating the spatial dimensions recursively : first , the field in @xmath215 direction is calculated by taking into account the differences between the mean charges of planes perpendicular to @xmath215 . within the planes",
    ", we then take into account charge differences between lines ( after subtracting the average plane charge ) to obtain the field in @xmath214 direction .",
    "finally the field in @xmath213 direction is obtained from the charge differences on the sites within a line .",
    "this solution of course violates @xmath224 . in order to bring the system onto the bos , we iteratively relax the @xmath24 field on the plaquettes until the electrostatic field energy is minimal ( cf .",
    "[ eq : electricfieldenergy ]  [ eq : solutionelectrostaticminimum ] ) . for a single plaquette ,",
    "this can be done in a single step . for the overall system ,",
    "we use a checkerboard decomposition which allows easy parallelization .",
    "the field @xmath69 is initialized as zero . then eqs .",
    "[ eq : pseudohamil1][eq : pseudohamil4 ] are integrated in time .",
    "ideally , one would like to run memd via an integrator which leaves the phase  space volume invariant and is time  reversible , such as the verlet algorithm in standard md @xcite . since the equations of motion ( even in the lattice  discretized case ) have these properties , it is indeed possible to construct such a scheme . disregarding yukawa subtraction for the time being",
    ", an analog to the verlet algorithm for memd would be the following integrator for eqs .",
    "[ eq : pseudohamil1][eq : pseudohamil4 ] , based upon a time step @xmath225 :    1 .",
    "update the particle momenta by half a time step .",
    "2 .   update the @xmath69 field by half a time step .",
    "3 .   update the particle positions by half a time step .",
    "4 .   update the electric field by a full time step .",
    "update the particle positions by half a time step .",
    "update the @xmath69 field by half a time step .",
    "update the particle momenta by half a time step .    here",
    ", `` update '' means the simple euler rule @xmath226 .",
    "the time consuming part ( update of the particle momenta , update of the electric field ) is arranged in such a way that only one `` force calculation '' per time step is necessary .",
    "this scheme does conserve the phase ",
    "space volume and is time ",
    "reversible , however , it suffers a severe disadvantage : the update of the electric field ( step 4 ) is based upon a particle configuration ( in real space and velocity space ) which has so far only progressed by half a time step . as a consequence ,",
    "gauss law is not satisfied within machine accuracy , but rather only within the accuracy of the time discretization ( to satisfy it exactly would require to know the current at the end of the time step , too ) .",
    "this is very undesirable , and hence we have adopted the elegant solution which was found by rottler and maggs @xcite and allows to conserve _ both _ time  reversibility and phase  space volume conservation , while keeping the system strictly on the cs :    1 .",
    "update the particle momenta by half a time step .",
    "2 .   update the @xmath69 field by half a time step .",
    "3 .   update the particle positions in @xmath213 direction by half a time step .",
    "4 .   update the electric field in @xmath213 direction by half a time step .",
    "update the particle positions in @xmath214 direction by half a time step .",
    "update the electric field in @xmath214 direction by half a time step .",
    "update the particle positions in @xmath215 direction by half a time step .",
    "update the electric field in @xmath215 direction by a full time step .",
    "update the particle positions in @xmath215 direction by half a time step .",
    "update the electric field in @xmath214 direction by half a time step .",
    "update the particle positions in @xmath214 direction by half a time step .",
    "update the electric field in @xmath213 direction by half a time step . 13 .",
    "update the particle positions in @xmath213 direction by half a time step .",
    "update the @xmath69 field by half a time step .",
    "update the particle momenta by half a time step .    we have added a langevin thermostat to the particles : @xmath227 where @xmath228 is the particle friction constant , and @xmath229 is a random force satisfying the standard fluctuation ",
    "dissipation theorem : @xmath230 where @xmath200 and @xmath231 denote cartesian indices .",
    "this puts the system into the canonical ensemble . for large systems",
    ", one can rely on the equivalence of ensembles , and there is no fundamental statistical  mechanical need for such a thermostat  it is just a matter of technical convenience : usually a langevin thermostat tends to stabilize the simulation due to its inherent feedback mechanism , such that larger time steps are feasible .",
    "rottler and maggs @xcite also add a langevin thermostat to the magnetic field ; we have not done this . it should be noted that such thermostatted dynamics violates time reversibility and phase  space volume conservation anyways .",
    "10 [ 1]`#1 ` [ 2][]#2"
  ],
  "abstract_text": [
    "<S> we derive and describe in detail a recently proposed method for obtaining coulomb interactions as the potential of mean force between charges which are dynamically coupled to a local electromagnetic field . </S>",
    "<S> we focus on the molecular dynamics version of the method and show that it is intimately related to the car  parrinello approach , while being equivalent to solving maxwell s equations with freely adjustable speed of light . </S>",
    "<S> unphysical self  energies arise as a result of the lattice interpolation of charges , and are corrected by a subtraction scheme based on the exact lattice green s function . </S>",
    "<S> the method can be straightforwardly parallelized using standard domain decomposition . </S>",
    "<S> some preliminary benchmark results are presented . </S>"
  ]
}