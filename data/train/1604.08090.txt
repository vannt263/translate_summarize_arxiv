{
  "article_text": [
    "the optic nom @xcite is a deployable , long - arm , non - contact profilometer consisting of a scanning pentaprism and a digital autocollimator ; this type of profilometer is also known as a deflectometer . a deflectometer can be used as a non - contact probe to provide accurate measurement of the height profile across an optical surface .",
    "the pentaprism traverses along a stiff linear guide - bar above an optical surface , relaying the autocollimator beam to provide a set of surface slope ( angle ) measurements along that path .",
    "pentaprism position information is provided via a linear encoder and so a height profile of the optical surface can be calculated .",
    "a diagram of the set - up is given in fig .",
    "[ fig : nom ] .",
    "the instrument is being used to confirm the base radius of curvature ( @xmath2 ) and conic constant ( @xmath3 ) of prototype european extremely large telescope ( e - elt ) segments that are being manufactured at optic glyndr .",
    "this profilometry technique originated in the synchrotron community @xcite to provide accurate measurements of x - ray focussing optics .",
    "these mirrors for synchrotron x - rays generally fall under two categories : ( 1 ) long ( up to 1.5 m ) and narrow ( a few 10 s of mm ) with very long focal lengths ( i.e. very large radii of curvature with @xmath2 from 100 s of metres up to a few kilometres ) and ( 2 ) nano or micro - focussing x - ray mirrors that can have higher surface curvature ( i.e. @xmath4 m ) but are only @xmath5 mm long . in both these cases the change in slope over the surface of the mirrors is usually < 10 milliradians so the limited angular measurement range of the digital autocollimator is not an issue and angular `` stitching '' techniques are not required in the data analysis .    for our purpose",
    "we do not require the extreme accuracy and precision that is needed for x - ray optics , but we need to measure large optical surfaces ( e.g. > 1 m diameter areas ) with slope variations that exceed the range of most commercially available , sub - arcsecond accuracy , digital autocollimators .",
    "also , in contrast to the x - ray optic community , the optic nom measurements are subjected to a significantly higher level of environmental noise due to the fact that the instrument is portable and used in - situ over a robotic polishing machine .",
    "this paper describes a numerical method that can be used to process sets of deflectometer line data that have been taken over an optical surface , where the individual line scans in that data set have been taken in difference coordinate frames , and fit an aspheric ( conic - section ) surface to them .",
    "simulated datasets have been used to test the fitting method in order to determine the accuracy of the method and any limiting behaviour .",
    "the software has been implemented using matlab @xcite .",
    "to @xmath6 and @xmath7 to @xmath8 ) to enable measurements over the entire surface ( e.g. dotted path ) . ]",
    "for a primary mirror ( m1 ) as large as that proposed for the e - elt , it is not feasible to manufacture the mirror in one continuous piece ; it must be constructed from many smaller mirrors that are of a size more practical to manufacture , measure and transport .",
    "the primary aperture of the e - elt at the time of this study was a 42 m diameter ellipsoid .",
    "the surface form of the primary mirror is given by the formula : @xmath9 ( ref : @xcite , p. 16",
    ", the ellipsoid formula ) . where @xmath2 is the base radius of curvature , @xmath3 is the conic constant and @xmath10 , @xmath11 , @xmath12 are the coordinates in the m1 ( primary mirror ) reference frame .",
    "the following production and measurement accuracies were specified by eso @xcite :    * the first polished segment should have a base radius of curvature and conic constant which satisfy @xmath13 mm @xmath14 mm and @xmath15 . *",
    "the accuracy of the knowledge of the nominal radius of curvature , @xmath16 shall be better or equal to 14 mm rms . * the maximum allowable surface error ( before removal of low and mid - spatial frequency terms ) over the useful area of any prototype segment is 50 nm rms ( 40 nm goal ) .",
    "the 42 m primary consists of 1148 hexagonal mirror segments of approximately 1.4 m diameter .",
    "the set of prototype segments to be manufactured and measured were a group of 7 segments towards the outer edge of the primary mirror assembly , i.e. each mirror segment is an off - axis ellipsoid .",
    "one of the challenges in manufacturing the primary mirror is that each individual segment must appear to have been `` cut - out '' from this larger ellipsoid - each segment must be made to the same @xmath2 and @xmath3 ( within tolerance ) and this surface form must be correctly aligned to the geometry of the segment ( which are slightly irregular hexagons ) .",
    "interferometric testing provides accurate surface - form maps in relation to the geometry of the segment , however it can not provide a direct measurement of @xmath2 .",
    "a more direct measure ( i.e. one not requiring a reference optic ) can be provided using a deflectometer .",
    "therefore , the primary task of the optic nom is to provide a confirmation of the base radius of curvature ( @xmath2 ) and conic constant ( @xmath3 ) of prototype e - elt mirror segments during the end stages of optical polishing .",
    "in the following discussion , reference is made to the m1 ( primary mirror ) coordinate reference frame and the segment ( denoted by the segment number : e.g. s1 , s4 etc . )",
    "coordinate reference frame .",
    "the position and surface form of the segments is defined in m1 coordinates as described by equation [ eq : ellipform ] .",
    "when measuring a segment by interferometry , the segment is supported in its gravitationally symmetric position : the mirror segment is oriented so that the normal to the surface at its centre coordinate is pointing vertically upwards ( along the z - axis ) . in comparison ,",
    "in the m1 coordinate reference frame , the normal vector of a general segment is not pointing along z ; only a segment centred at the centre of m1 would possess this property .",
    "when measuring with the deflectometer the mirror segment is , on average , oriented with its centre - normal pointed vertically upwards . however , as previously described , the range of surface slope on a segment exceeds the measurement range of the autocollimator and so the segment must be pitched and rolled ( see fig .",
    "[ fig : nom ] ) to allow scans to be taken over the entire surface .",
    "the range of these angular re - positionings is of the order of @xmath17 degrees . with",
    "the segment tilted in various orientations for different line - scans the measurement coordinate frame is no longer co - aligned with the segment coordinate frame .",
    "this makes co - locating all the separate line scans to a single surface - which needs to be a best fit to this data - non - trivial .",
    "figure [ fig : scanlines](a ) gives an example of a set of scan - lines taken over a segment surface , fig.[fig : scanlines](b ) shows the effect that the tilting method used to overcome the limited measurement range has on the data and fig.[fig : scanlines](c ) shows how the line scans appear when each scan is properly corrected for z - height offsets and rotations after the optimisation / fitting procedure .",
    "a suite of matlab programs have been written to read - in , process and find the best - fit conic surface for the nom line - scan datasets .",
    "the data flowchart for these processes is shown in fig .",
    "[ fig : dataflow ] .",
    "as previously described , the challenge with fitting this data to a surface is that due to the limited angular range of the autocollimator , each scan - line taken on the mirror surface is in an unknown different coordinate reference frame and so the fitting routine must translate and rotate the scans to correct for this .",
    "also , given that the @xmath12 ( height ) data of the surface is obtained via integration of slope data ( of the form d@xmath12/d@xmath10 = tan@xmath18 ) , the absolute @xmath12 position of each scan is unknown ( the unknown integration constant ) , so the relative @xmath12 height of all the scans with reference to each other must also be part of the optimisation routine .    .",
    "the final step ( 10 ) is beyond the scope of this work . ]    for a given set of scan - lines the parameters that require fitting are : @xmath2 and @xmath3 ( globally ) and also 6 parameters per scan ( 3 translations and 3 rotations ) .",
    "this means there are @xmath19 parameters to fit per set of line - scans ( where @xmath1 is the number of line scans in a set ) . for the line - scan pattern shown in fig .",
    "[ fig : scanlines ] , this means there are @xmath20 parameters to optimise in the conic fitting . to perform this optimisation",
    "a trust - region - reflective algorithm is used to determine the minimum of a cost - function . as expected ,",
    "a gradient minimisation over so many dimensions is computationally costly and prone to stopping in local minima . to help the optimiser , `` good '' initial values of @xmath2 and @xmath3",
    "must be provided and boundary limits applied to the individual scan - line transformations . in addition a global search strategy is used to circumvent the local - minima problem  starting the optimiser with many different sets of initial conditions and selecting the most optimal",
    ".    this fitting routine can be run on a standard desktop pc ( for this benchmark the processor is an intel^^ xeon^^ cpu e3 - 1240 v3 3.40 ghz ) . as an example of the run - time , a single run of the optimisation / fitting routine ( i.e. using only a single @xmath21 pair as an initial starting value ) on a typical dataset simulated here ( 24 scan - lines containing 2562 data points in total ) which requires 146 parameters to optimise takes @xmath22 seconds to converge .",
    "an important step in setting up this optimisation routine is the formulation of an appropriate cost function , @xmath23 .",
    "the quantity that we minimise is the sum of the squared differences between the height of each point in each line scan ( @xmath24 ) and the calculated @xmath12 of an ellipsoid surface at the same ( @xmath25 , @xmath26 ) coordinate positions for a given @xmath2 and @xmath3 ( called @xmath27 here ) .    to enable",
    "the comparison between @xmath24 and @xmath27 , either the line scans must be transformed into the m1 coordinate frame or the ellipsoid formula ( equation [ eq : ellipform ] ) transformed into the relevant segment coordinate system .",
    "the more reliable of these for the cost function is the latter - a comparison in the segment coordinate frame .",
    "one of the reasons for this is that in the segment reference frame the cost function ( @xmath24  @xmath27 ) is less weighted by the outer scan lines ( furthest from the segment centre ) for the same angular displacement , another is that the cost function is smoother since most of the different parameter values are closer to zero than in the m1 frame .",
    "figure [ fig : refframes ] presents an illustration of this issue .",
    "the transformation of the ellipsoid formula from m1 to segment reference frame uses the pre - defined centre coordinate of the segment under manufacture and the measured centre coordinate determined experimentally from the segment geometry .",
    "the @xmath12 value of the segment centre , in segment coordinates is set to be @xmath28 .",
    "the form of the conic equation used to calculate @xmath27 is : @xmath29 where @xmath2 and @xmath3 are the ellipsoid parameters , @xmath10 and @xmath11 are the coordinates in the segment frame and @xmath30 is the rotation angle around the x - axis that brings the normal vector of the segment at its centre in the m1 frame to a vertical orientation ( i.e. along the positive z - axis ) ; this is also illustrated in fig .",
    "[ fig : refframes ] . the equation can be formulated in this way because the ellipsoid formula ( equation [ eq : ellipform ] ) is symmetric about the z - axis , and for the purposes of comparing the theoretical surface with the real data the data can be transformed so that the segment centre lies on the y - axis .",
    "the optimization routine being used implicitly computes the sum of squares as part of the algorithm , so our cost function , @xmath23 , is multi - valued and creates a length @xmath31 vector of z differences , one for each measured ( @xmath32,@xmath33,@xmath34 ) value : @xmath35 \\label{eq : f } \\end{split}\\ ] ] where @xmath1 is the number of line scans and @xmath36 and where @xmath25 , @xmath26 , @xmath24 are the rotated and translated line scan measurements given by @xmath37 here @xmath38 and @xmath39 where @xmath40 , @xmath41 , and @xmath42 are the measured coordinate position and height data for point @xmath43 and @xmath44 is the line scan number which contains the point @xmath43 .",
    "@xmath45 , @xmath46 and @xmath47 are the standard rotation matrices around the @xmath10 , @xmath11 and @xmath12 axes respectively for the angle parameters @xmath48 , @xmath49 , @xmath50 for line scan number @xmath44 .",
    "a trust - region - reflective algorithm is used in the optimiser and it is set up as a bounded problem - initial values are allocated to the parameters that require fitting and limits are also defined for those parameters .",
    "the optimisation is based around a gradient minimisation ; the cost function gradient is calculated using the central finite differencing method . for this problem",
    "the upper and lower boundary limits were chosen to be symmetric around the initial value , @xmath51 , of each parameter @xmath52 : @xmath53 for the 6 degrees of freedom in positioning each scan line into a common ( the segment ) coordinate frame the @xmath54 , @xmath55 , @xmath56 limits are set at @xmath57 mm and the 3 rotations are limited to @xmath58 radians ; the initial values are set to zero .",
    "these limits have been chosen to be suitable for the measurement set - up as previously described and the expected displacements and rotations of the line scans are well within these boundary limits . for @xmath2 and @xmath3 , the global parameters across all scan lines , the initial values , @xmath59 and @xmath60 , are set to a good estimate based on other measurements ( e.g. interferometric measurements ) and the boundary limits in the program are set to @xmath61 mm and @xmath62 . section [ sec : performance ] demonstrates the method used to reach the correct solution even if good initial estimates for @xmath2 and @xmath3 are not available .",
    "( i.e. d@xmath12/d@xmath2 ) over @xmath10 and @xmath11 .",
    "both plots show the same jacobian but calculated using different forms of the quadratic equation solution - the left plot is calculated before the function calculations were optimised for numerical precision and the right plot is after the reformulations to improve numerical noise .",
    "these have been calculated for s1 ( near the outer edge of m1 ) , which is the worst case ( in terms of the numerical noise ) due to the magnitude of the y - coordinates . towards the centre of m1",
    ", the centre coordinates describing the segment positions are more moderate in magnitude resulting in a smoother jacobian . ]      in order to allow the optimisation algorithm to operate efficiently , it is important to present it with a cost function that is as smooth as possible .",
    "any noise in the cost function causes fluctuating gradient measurements which at best will cause the optimisation to take a longer path to the solution , and at worst may cause it to terminate prematurely in a false local minimum .",
    "an example of problems with numerical noise is shown in fig .",
    "[ fig : numnoise](left plot ) : the initial formulation of the problem results in such significant loss of numerical precision that there is no discernible gradient for the optimiser to follow and it terminates in an apparent local minimum very rapidly ( it hardly moves from the initial starting values ) .",
    "figure [ fig : numnoise](right plot ) shows the same gradient function after applying several improvements as described below .",
    "numerical noise in the cost function is still present , but it is now significantly below the level of the actual function evaluation values , and low enough that the derived gradients can be followed by the optimiser .",
    "a standard formulation of equations in the cost function can result in a significant loss of numerical precision due to cancellation between terms of the ellipsoid equation . by reformulating the calculation of the surface using a different form of the quadratic equation ( @xcite , ch.5 , pp.227 )",
    "the numerical accuracy of the calculation is vastly improved .",
    "the form of the cost function ( @xmath63 ) used is calculated from equation [ eq : zref ] . in addition , the order of arithmetic operations throughout the cost function was carefully analysed in the context of the expected magnitudes of the inputs and improved where possible to maximise the precision of the cost function .      the choice of how the gradient is calculated has a significant effect on the solution convergence - the central ( or symmetric ) finite differencing method has been chosen which is computationally more costly than the forward finite differencing method but the central method has higher numerical precision ( @xcite , ch.5.7 , pp.229 ) .",
    "use of the forward method results in a solution of much lower accuracy and is insufficient for the solution accuracy required here .",
    "the default step size for jacobian calculations in matlab is quite small ( 1e-8 ) , although it can be set to any value from 0 to inf .",
    "increasing the step size will sample over a size greater than the granularity of the numerical noise features and so a smoother function is produced which is then less likely to present the optimiser with false ( noise based ) local minima .",
    "however , the step size also needs to be minimised to provide an accurate estimation of the gradient function and ensure that the optimiser will converge on a solution of the required accuracy .    with the initial cost function formulation , a step size of 1e-3 ( @xmath641e9*eps(@xmath65 ) ) , where @xmath66 , was needed to produce the required smoothness , but this results in very poor gradient estimates .",
    "machine epsilon ( eps ) is the approximate relative error due to rounding in floating point arithmetic of a 64 bit double representing that value . with the improved cost function , a step size of 1e-7 ( @xmath641e4*eps(@xmath65 ) )",
    "could be chosen which provides a good balance between noise reduction and accuracy of estimation .",
    "the optimisation algorithm allows only a single value for the gradient estimation step size , @xmath67 , to be chosen to apply to all the parameters .",
    "the parameters in our problem differ by several orders of magnitude , so for the optimisation process the inputs are normalised such that their bounds map to [ -1 1 ] .",
    "a step size of 1e-7 is then suitable for the entire n - dimensional gradient space minimisation .      to guard against solutions that may have converged in a local minimum rather than the global minimum a global search strategy",
    "is used , starting the optimisation routine using many sets of different initial conditions and comparing the results .",
    "an efficient way to implement this strategy is to generate a randomised sobol sequence @xcite over the required n - dimensional search space . by using @xmath68 ( where @xmath69 is the number of sets of initial parameters ) points to generate the sobol set",
    "the points will be uniformly distributed over the required search space . for this work",
    "we have generally been using this to generate a set of @xmath21 initial values to verify the solution convergence .    , @xmath3 parameter space that occupies the same rms surface error  contours map solutions having the same rms surface error .",
    "the inner 10 contour levels are ( in nm ) : 40 , 50 , 100 , 150 , 200 , 300 , 400 , 500 , 700 and 900 . given @xmath66 mm and @xmath70 for a `` perfect '' first segment , the eso allowable surface error of 50 nm rms for subsequent segments corresponds to the plotted elliptical boundary limits in ( @xmath2 ( mm ) , @xmath3 ) of ( 83990.7 , -0.995295 ) and ( 84009.3 , -0.991291 ) . ]",
    "for the real data , sources of error such as environment noise ( vibration , dust , air turbulence ) , alignment errors , encoder errors etc . lead to measurement errors in the autocollimator slope angle . in principle",
    "these slope errors could be estimated using classical error propagation , but this alone does not give us the error on the parameters we are trying to determine : @xmath2 ( base radius of curvature ) and @xmath3 ( conic constant ) .",
    "the slope angles are converted into gradients and integrated to @xmath12 values . the cumulative integration error could be estimated and would vary depending on the numerical integration method .",
    "as previously described , the ellipsoid formula ( equation [ eq : ellipform ] ) is fitted to the set of line scans . due to the limited range of the autocollimator , line scans covering the full extent of the segment",
    "can only be obtained by tip , tilt and rotation of the segment on its support structure . due to this ,",
    "the parameters in the fitting routine include @xmath2 and @xmath3 , but also separate spatial translation and rotation parameters for each line scan , to allow for the fact that we only approximately know their relative locations . an analytical propagation of errors to the parameters @xmath2 and @xmath3 is not possible in this situation ( a non - linear iterative fitting process ) ; the error in @xmath2 and @xmath3 from this fitting process is better estimated using monte carlo methods and will depend on the optimisation algorithm and the exact cost function formulation as well as the errors in @xmath10 and @xmath12",
    ". in theory , errors in our estimates for the translations / rotations of the line scans can be corrected by the optimiser but in practice they will also affect the ability of the algorithm to fully converge .    to test the behaviour and accuracy of the fitting routine simulated nom scans are generated .",
    "as shown in fig .",
    "[ fig : scanlines](a ) , a set of scan coordinates defined in @xmath10 and @xmath11 in the segment reference frame are passed to the nom scan simulator along with the surface specification in @xmath2 and @xmath3 , the centre coordinate in the m1 reference frame and the 1-sigma level of z - noise to add to the generated @xmath12 values . based on a measurement procedure of ensuring each scan is centred within the surface slope range of the autocollimator",
    ", the data for each scan line is then rotated in the @xmath10 and @xmath11 axes around the centre point of the scan line so that the @xmath10 , @xmath11 slopes at this centre point are zero .",
    "note that the specification of the @xmath10 , @xmath11 coordinates of the scan lines are chosen to ensure that the slope measurement along its length does not exceed the total measurement range of the autocollimator .",
    "realistic levels of random noise on @xmath12 are chosen based on real data acquired with the optic nom .",
    "the simulated dataset then looks like fig .",
    "[ fig : scanlines](b ) and these data are passed to the fitting routine . in terms of the whole process shown in fig .",
    "[ fig : dataflow ] , the simulated dataset comes in at step 5 and represents the data as if it has gone through the previous steps and the data taking process ( not indicated ) .",
    "for all the performance tests presented here the simulated datasets were generated in the format as shown in fig .",
    "[ fig : scanlines](a ) ( i.e. a scan pattern consisting of a grid of 7 lines across each of the x and y axis to produce 24 scan lines that are within the measurement range of the nom autocollimator ) .",
    "the data points within a scan line are separated by 5 mm .",
    "since the data used in these tests are simulated , the @xmath2 and @xmath3 is known and the level of random noise injected into the data is known .",
    "sanity checks on the reconstructed / fitted data are made by checking that the final value of the cost function ( which is basically a sum of the residuals ) corresponds to the level of noise that was injected ( i.e. an rms of the residuals should be close to the 1-sigma level of noise that was used ) . if the residuals are higher than expected it is usually because the optimiser has terminated too early .",
    "this can happen if the initial parameters were beyond the bounds of the optimiser ( see section [ sec : outbounds ] ) , or the initial values were located unfavourably in the gradient - space so that the route taken by the optimiser needed more steps than the allocated maximum number of iterations ; it is for these reasons that a multi - start strategy is best used for unknown data . the reconstructed data ( as per fig . [",
    "fig : scanlines](c ) ) as well as the residual plot ( fig .",
    "[ fig : scanlines](d ) ) can also be plotted to double - check that the scan lines have been sensibly located on the best - fit surface and that there is nothing unexpected in the residuals ( i.e. that they are consistent with the expected noise ) .",
    "finally , in order to determine whether a solution has converged within the limits of the allowed rms surface error a contour plot of rms surface error was derived over the @xmath2 , @xmath3 parameter space .",
    "the eso allowable surface error is defined to be 50 nm rms @xcite . for segment s1",
    ", whose centre coordinate is positioned near the outer edge of the primary mirror this contour plot is given in fig .",
    "[ fig : contours ] . the rms surface error is calculated based on the 2562 data points in the line scan pattern ( fig .",
    "[ fig : scanlines](a ) ) of the typical simulated scan set used , with the minimum surface error ( injected @xmath12 noise only ) set at @xmath66 mm and @xmath70 . the rms surface error versus @xmath21 varies with position on m1 , so a different contour map must be calculated for each segment set to enable an accurate evaluation of the @xmath2 , @xmath3 solution convergence .",
    "an example of this for a segment closer to the inner edge ( named s12 here ) is given in section [ sec : innerseg ] .",
    "comparing the @xmath2 , @xmath3 limits on the 50 nm rms contour for s12 gives : rlimits = 83991.1  84008.9 mm ( diff = 17.8 mm ) and klimits = -1.009890 - -0.976677 ( diff = 0.033213 ) .",
    "the kdiff for s1 is 0.00392392 ( an order of magnitude smaller ) and the rdiff is 18.6 mm .",
    "when using this analysis method on a real data - set there are certain unknowns that the analysis must take into account and be robust to . it is assumed that approximate values are known for the key parameters that define the shape of the surface ( e.g. base radius of curvature and conic constant ) , so that these can be used as reasonable initial values in the optimisation process .",
    "however , even if there is no prior knowledge of these parameters a wider search strategy can be employed using more steps in the process ; the time taken to reach a satisfactory solution is increased accordingly .    a number of different data sets were created to test the fitting method and these are described in the following sub - sections",
    ".    the boundary box in the optimiser is set at @xmath61 mm and @xmath62 ( where @xmath59 and @xmath60 are the initial values provided to start the optimiser ) ; so if the initial values fall beyond the real solution @xmath71 the @xmath2 and @xmath3 boundary limits then the routine will fail to find the correct solution because it is beyond its search - space .",
    "it is unlikely that the user would ever have this level of uncertainty when providing a good initial value , however an example is given ( in section [ sec : outbounds ] ) of what happens in this case .     and @xmath3 ( indicated by the green star on the inset top plot ) and at the same outer segment position ( s1 ) .",
    "each dataset is analysed using the same set of 32 @xmath72 points as initial values to demonstrate the multi - start strategy .",
    "the inset plot at the top is a zoom - in on the central region of the main plot ; the median result of each group is indicated with a `` + '' marker .",
    "the main plot is shown to demonstrate that all the results converged within the inner contour ( 40 nm ) , and within the eso allowable error . ]        to investigate how the fitting routine behaves in the presence of different levels of noise , datasets were generated from a surface of a fixed base radius of curvature ( @xmath2 ) and conic constant ( @xmath3 ) ( as per equation [ eq : ellipform ] ) with only the 1-sigma level of random noise on the @xmath12 height data varying between the datasets . for these experiments : @xmath73 mm and @xmath74 and the 1-sigma level of random noise on the @xmath12 data = 1.2 nm , 3.0 nm , 6.0 nm and 12 nm .",
    "these noise levels are based around the maximum measurement error of the optic nom autocollimator which is @xmath17 arcsec and random position error of @xmath75 m for a single point measurement . for a 5 mm step size between measurements",
    ", this angle measurement error converts to a z error of 6.0 nm ( i.e. @xmath76 ) . in a real - life measurement",
    "25 autocollimator measurements are acquired in rapid succession for each data point reducing this error to 1.2 nm .",
    "the position uncertainty converts to a @xmath12 error of approximately 4 nm ( varies depending on segment and position on segment ) .",
    "setting the 1-sigma level of z - noise in the simulations to 6.0 nm is close to an expected maximum error level and using 3.0 nm represents a more modest level of noise .",
    "the lower and upper limits of noise ( 1.2 and 12 nm ) have been chosen to represent an environment / set - up of excellent stability and accuracy and a more noisy / less stable environment than we assume are typical of the optic nom .",
    "the data generated is for s1 which is positioned near the outer edge of m1 and so is the most off - axis ellipsoid .    using the scan pattern as previously described",
    ", 5 datasets were generated using each of the 4 specified levels of random noise .",
    "a randomised @xmath21 sobol set containing 32 points was generated over an r - range of 83000 to 85000 mm and a k - range of -1.1 to -0.8 .",
    "these 32 points provide the initial @xmath2 , @xmath3 values for the multi - start strategy ; the same set of initial values was used to start the fitting / optimisation process for all the datasets .",
    "every dataset is run through the fitting process 32 times , each time using a different initial value for @xmath2 and @xmath3 as provided by the sobol set .",
    "the results of the final fitted @xmath2 , @xmath3 for each of these datasets is shown in fig .",
    "[ fig : diffnoise ] , over - plotted on the contour map of @xmath2-@xmath3-rms surface error . the median result for each of the different noise groups",
    "is indicated .",
    "the best - fit @xmath2 , @xmath3 to the simulated nom data is taken as this median value .",
    "the median , rather than the mean is used as it is a better representation of the majority of the fitting results since we know that some @xmath2 , @xmath3 initial values will have been poorly placed in the gradient space and that there will be a few spurious / outlier results .",
    "using the same @xmath2 and @xmath3 ( 84000 mm and -0.993295 ) , a z - noise level of 3.0 nm and the same set of 32 @xmath21 initial values , the fitting process was repeated on 5 datasets generated at a different m1 centre coordinate in order to see if there are any differences in fitting data from the inner edge of m1 i.e. closer to the edge of the central cut - out and the least off - axis ellipsoid compared to the outer edge of m1 ( s1 ) .",
    "the centre coordinate of s1 ( outer edge ) in the m1 frame is [ 0 , 18469.942 ] mm and of this ( inner edge ) segment is [ 0 , 6393.5 ] mm . as described in section 4 , a new contour map of @xmath2-@xmath3-rms surface error was generated to compare results at this new m1 mirror position .",
    "the results are shown in fig .",
    "[ fig : innerseg ] .     and @xmath3 values ( lower cost function value indicates a better fit ) given an over - wide search space for the multi - start optimisation strategy .",
    "the square outlined points show the initial values that were passed to the optimiser for this dataset ; the green shaded rectangular area indicates the boundary limit around the correct solution  initial values outside of this boundary will not be able to converge to the correct solution .",
    "the small grey points show the end - point @xmath2,@xmath3 values of the optimiser with a light - grey line linking it to its initial value .",
    "for the 8 start values within the boundary ( filled green squares ) the optimiser reached the correct solution ( on the contour plot there are 8 almost overlapping points at ( 84000 , -0.993295 ) ) . ]      an extended range 32 point sobol set of initial @xmath21 values was generated to demonstrate the results when the routine is provided with initial values that are outside the boundary limits around the real solution .",
    "these boundary limits are set within the optimisation function to be : @xmath77 mm around @xmath59 and @xmath78 around @xmath60 .",
    "the extended sobol set was generated using a rrange of 80000 to 90000 and a krange of -1.5 to 0 .",
    "the nom dataset for testing was generated with the same fixed @xmath2 and @xmath3 as previous ( 84000 mm , -0.993295 ) , z - noise = 3.0 nm and at the s1 position .",
    "the results of fitting this dataset for each of the initial values in this extended range set is shown in fig .",
    "[ fig : extrange ] .",
    "it demonstrates the use of the multi - start strategy not only to avoid local minima issues , but also as a tool to `` zoom - in '' on the correct answer even if there is very poor knowledge of the shape of the optic from which the data was taken .",
    "firstly the results with the lowest value of the cost function will give a good indication of @xmath2 , @xmath3 values that are at or approaching the correct results .",
    "also , as in the case shown in fig .",
    "[ fig : extrange ] , there are 8 initial values that lie within the boundary box centred on the correct @xmath2 , @xmath3 value and so there is a `` point '' on fig .",
    "[ fig : extrange ] that consists of 8 almost overlapping results that started from those points and have converged on the correct solution .",
    "once an indication of the correct result is gleamed from an `` over - wide search '' , the optimisation can be repeated with a smaller range of @xmath2 and @xmath3 around the region where the correct solution is believed to lie .",
    "a 128-point set of @xmath21 pairs was generated using a randomised sobol set and used to generate 128 different nom datasets .",
    "the @xmath2 range for this sample was 60000 to 90000 mm and the @xmath3 range -1.5 to 0 .",
    "as a side - note , this range includes the current specification for the e - elt of @xmath79 mm and @xmath80 @xcite .",
    "an arbitrary off - axis position was chosen for the simulated segment data , this was fixed for all the 128 datasets at cm = [ 0 , 12000 ] mm , which is around the mid - section of a primary mirror of diameter 40000 mm .",
    "the 1-sigma level for random noise on the data - points was also fixed at 3.0 nm . given the large amount of processing time that would be required to perform a many point multi - start strategy as demonstrated in section [ sec : fixrk ] ,",
    "it was assumed for these analyses that a reasonable knowledge of the @xmath21 value of the mirror is known and so the initial values given to the optimiser was set to : @xmath81 mm and @xmath82 ; where @xmath83 and @xmath84 are the values used to generate the simulated datasets .",
    "the results of these optimisations are shown in fig . [",
    "fig : varrk ] .",
    "the average of the residual rms surface error is 2.95 nm which corresponds well to the expected noise in the data ( 3.0 nm ) .",
    "the median value of the rdiff ( fitted r value ( @xmath85 ) - r value used to generate the data ( @xmath83 ) ) is 0.202 mm ; the median value of the kdiff is 6.65e-5 .",
    "these are well within acceptable tolerances .      on a `` real '' optic ,",
    "the surface form is unlikely to be perfectly described by equation [ eq : ellipform ] with just random noise on the data points and line - scan positions .",
    "it is likely that the shape will be slightly modified by higher order terms such as astigmatism . for the manufacturing of the eso e - elt segments",
    "there is a certain amount of allowable misfigure in terms of zernikes @xcite , since the active mirror support structure can remove a certain amount of form error .    for these tests we chose two of the higher order allowable errors to add to the simulated datasets to investigate how this affected the result on fitted @xmath2 and @xmath3 ;",
    "the misfigure in zernike terms we added to this data are astigmatism ( z = 4 ) and higher order `` trefoil '' ( z = 9 ) . the misfigure terms were considered individually and were added in to the ellipsoid data either at the maximum allowed amount of error for that term or at half the allowed amount .",
    "a 32-point multi - start strategy was used to analyse each dataset , the results are plotted in fig . [",
    "fig : formerror ] .    , @xmath3 position of the generated data .",
    "only 2 ( out of 160 ) results from the maximum allowed z9 multi - start set fall outside the boundary . ]",
    "as expected the presence of form error in the data modifies the best fit @xmath2 and @xmath3 .",
    "the presence of either astigmatism or trefoil results in a fitted @xmath2 and @xmath3 that is shifted towards a higher @xmath2 and @xmath3 than the values that were used to generate the data .",
    "again , as might be expected , astigmatism had a more significant effect on the fitted results .",
    "this is partly to do with the fact that more error in astigmatism is allowed in the data but also because it can be seen how the two axes of different curvature on an astigmatic surface can add to the ellipsoid surface ( also with two axes of different curvature ) to produce a surface which closely resembles an ellipsoid surface with slightly modified @xmath2 and @xmath3 parameters .",
    "figure [ fig : formerror ] shows that the rms surface error due to the difference between the fitted @xmath2 , @xmath3 and the actual @xmath2 , @xmath3 is within allowable limits . if the maximum allowed form errors are known to be present within the data ( i.e. it is known from the interferometric data ) it is advisable to subtract these form errors from the profilometer data and fit for @xmath2 and @xmath3 again to get a result with an improved accuracy .",
    "this work has demonstrated that it is possible to converge on an @xmath2 , @xmath3 solution of sufficient accuracy for the described purpose by using a gradient minimisation optimisation over many ( 100 + ) dimensions to place scan - lines in a common coordinate frame of reference and simultaneously fit the best aspheric surface .",
    "the simulations performed here have assumed a fixed scan pattern of 7 line sections across x and y with data points taken every 5 mm along each of these lines ( divided into 24 line scans due to the limited autocollimator measurement range ) .",
    "this pattern was chosen since it represented one of the best compromises between data acquisition time and adequate sampling of the optic being measured .",
    "the number of degrees of freedom in the optimisation is altered by the number of scan lines ( 6n + 2 where n is the number of scan lines ) .",
    "the behaviour of the optimisation process with respect to number of scan lines has not been completely investigated .",
    "the optimisation process is robust to a wide range of random noise on the z ( height ) data , a 1-sigma level of 1.2 to 12 nm has been investigated here and shown to satisfy requirements .",
    "the process can cope with small ( @xmath86 m ) random offsets of entire line scan positions since x , y , z position is part of the optimisation for each line ( in order to account for line shifts when rotating the line scans into their common reference frame and the unknown integration constant ) . exact knowledge ( i.e. within the noise ) of the segment centre position in the data is assumed in order to have accurate mapping to the required segment centre coordinate in the m1 reference frame .",
    "any large or systematic errors in the coordinate system or elsewhere in the data should be corrected or removed before fitting to obtain the most accurate result ; if this is not possible their influence on the fitting process will need to be investigated .",
    "although the focus of these fitting tests were for the old e - elt specification ( @xmath73 mm , @xmath74 , 42000 mm diameter primary ) this fitting / optimisation process has also been shown to be effective for surfaces described by different @xmath2 ( 60000 to 90000 mm ) and @xmath3 ( 0 to -1.5 ) and different off - axis positions ( i.e. different segment centre coordinates in the m1 frame ) .",
    "it also performs within specification in the presence of the allowed higher - order surface error terms ( only z4 and z9 tested here ) as defined for the e - elt segment manufacturing , although for the best accuracy it is recommended to subtract those terms from the data before ( re)fitting , especially if high levels of those errors are known to be present .",
    "assuming the optic to be measured can be supported on a suitably stiff structure that allows the optic to be rotated around its x and y axes without introducing significant ( i.e. below the measurement error ) distortion on the surface form then the fitting method described provides a useful way to effectively extend the angular measurement range of an autocollimator in a non - contact profilometer and allows the line scans taken across the optic to be reconstructed to the best - fit aspheric ( conic ) surface .",
    "s.  alcock , k.  sawhney , s.  scott , u.  pedersen , r.  walton , f.  siewert , t.  zeschke , f.  senf , t.  noll , and h.  lammert , `` the diamond nom : a non - contact profiler capable of characterizing optical figure error with sub - nanometre repeatability , '' nuclear instruments and methods in physics research a * 616 * , 224 ( 2010 ) ."
  ],
  "abstract_text": [
    "<S> we present a description of our method to process a set of autocollimator - based deflectometer 1-dimensional line - scans taken over a large optical surface and reconstruct them to a best - fit conic - section surface . </S>",
    "<S> the challenge with our task is that each line - scan is in a different ( unknown ) coordinate reference frame with respect to the other line - scans in the set . </S>",
    "<S> this problem arises due to the limited angular measurement range of the autocollimator used in the deflectometer and the need to measure over a greater range ; this results in the optic under measurement being rotated ( in pitch and roll ) between each scan to bring the autocollimator back into measurement range and therefore each scan is taken in a different coordinate frame . </S>",
    "<S> we describe an approach using a @xmath0 dimension optimisation ( where @xmath1 is the number of scan lines taken across the mirror ) that uses a gradient - based non - linear least squares fitting combined with a multi - start global search strategy to find the best - fit surface . </S>",
    "<S> careful formulation of the problem is required to reduce numerical noise and allow the routine to converge on a solution of the required accuracy .    </S>",
    "<S> = 1    120.3940 metrology ; 120.6650 surface measurements , figure ; 220.1250 aspherics .    </S>",
    "<S> 2016 optical society of america . </S>",
    "<S> one print or electronic copy may be made for personal use only . </S>",
    "<S> systematic reproduction and distribution , duplication of any material in this paper for a fee or for commercial purposes , or modifications of the content of this paper are prohibited . </S>",
    "<S> the version of this paper as published in applied optics can be viewed here : http://dx.doi.org/10.1364/ao.55.002827 </S>"
  ]
}