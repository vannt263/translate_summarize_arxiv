{
  "article_text": [
    "the understanding of quantum impurity systems became one the cornerstones of condensed matter theory during the last decade .",
    "quantum impurity systems appear at the heart of a variety of different physical problems .",
    "traditionally , they were used to describe the interaction of magnetic impurities with a metallic host.@xcite nowadays , quantum impurity systems play a fundamental role in our understanding of the low temperature properties of single - electron transistors@xcite and the tunneling spectroscopy of adatoms on metal surfaces.@xcite the basic structure common to all such systems is a mesoscopic subsystem or device  such as a quantum dot , an organic donor - acceptor molecule or an adatom  coupled to a continuum of states that can be represented by non - interacting particles of either fermionic or bosonic nature .",
    "typical realizations are models like the single impurity anderson model,@xcite where the continuum of states is described by free fermions , or the spin - boson model,@xcite where the discrete orbitals interact with a bosonic bath . in addition , within the dynamical mean - field theory@xcite or its cluster extensions@xcite lattice models for strongly correlated fermions have been mapped onto quantum impurity problems embedded in a fictitious , self - consistent bath .",
    "obtaining a self - consistent solution for these theories requires very accurate determination of local green s functions .",
    "wilson s numerical renormalization group ( nrg ) approach@xcite to quantum impurity problems is one of the most powerful and flexible ways for accurately calculating thermodynamic properties of quantum impurity systems .",
    "in addition , it provides a deep insight into the underlying physics through the analysis of the fixed point hamiltonians.@xcite the key ingredient is a logarithmic discretization of the bath continuum , resulting in a well defined hierarchy of energy or temperature scales .",
    "the discretized model is then iteratively diagonalized and the basis set truncated , retaining only those states with low lying energies after each step .",
    "each iteration represents a certain temperature @xmath0 , and all thermodynamic properties are determined for that particular @xmath0.@xcite for calculating dynamical properties@xcite three fundamental problems arise : ( i ) how to recover the continuum limit from a discretized spectrum , ( ii ) how to obtain dynamical information on all energies scale at arbitrarily low temperature in such away that ( iii ) spectral sum rules are always fulfilled and thermodynamics expectation values are reproduced _",
    "exactly _ independent of how many states are kept after each nrg step .    in this paper , we will derive an exact analytical expression for arbitrary dynamical correlation functions which solves this problems .",
    "it is based upon the recent identification of a _ complete basis set _ of the wilson chain , which is also an approximate eigenbasis of the nrg hamiltonian.@xcite we will show that this complete basis set automatically ensures that spectral sum rules are fulfilled exactly and thermodynamic expectation values reproduced accurately by the spectral functions .",
    "we furthermore explicitly demonstrate that our novel approach yields spectral functions which are largely insensitive to the number of eigenstates kept in each nrg iteration , thus improving the applicability of the nrg to multi - orbital and multi - site impurity problems and consequently also to multi - band and cluster dmft problems , because the number of nrg states needed can be significantly reduced without loosing accuracy . in addition , phenomenological patching algorithms typically employed to combine excitations from different nrg iterations@xcite become obsolete , since we rigorously identify which excitations actually contribute at which wilson shell .",
    "the paper is organized as follows . in the next section",
    "we will briefly review the basic theoretical concepts and derive the complete basis set .",
    "we furthermore show how this complete basis set can be used to calculate dynamical correlation functions .",
    "section iii is devoted to a detailed discussion of results for the simplest and most important quantum impurity model , the single impurity anderson model .",
    "we will explicitly compare our new method to the standard implementations .",
    "a summary and outlook in section iv will conclude the paper .",
    "proofs for our claim that sum rules and spectral averages are automatically respected within this formulation are given in the appendix .",
    "the nrg is a very powerful tool for accurately calculating equilibrium properties of quantum impurity models .",
    "originally developed for treating the single - channel , single - impurity kondo hamiltonian,@xcite this non - perturbative approach was successfully extended to the anderson impurity model,@xcite the two - channel anderson@xcite and kondo hamiltonian ,  @xcite different two - impurity clusters ,  @xcite and a host of related zero - dimensional problems .",
    "recently , it was extended to equilibrium properties of impurity models with a _",
    "bosonic _ bath @xcite or even combinations of both fermionic and bosonic baths.@xcite    the hamiltonian of a quantum impurity system is generally given by @xmath1 where @xmath2 models the continuous bath , @xmath3 represents the decoupled impurity , and @xmath4 describes the coupling between the two subsystems .",
    "thermodynamic properties of such a quantum impurity system are very accurately obtained using the nrg . at the heart of this approach",
    "is a logarithmic discretization of the continuous bath , controlled by the discretization parameter @xmath5 ;  @xcite the continuum limit is recovered for @xmath6 . using an appropriate unitary transformation,@xcite",
    "the hamiltonian is mapped onto a semi - infinite chain , with the impurity coupled to the open end . by construction",
    ", the @xmath7 site of this chain couples only to its immediate neighbors , which allows to write the hamiltonian of the infinite chain as limit for @xmath8 of a sequence of finite chains , denoted by @xmath9 , with a unique prescription @xmath10 , the rg equation of the nrg .",
    "the @xmath7 link along the chain represents an exponentially decreasing energy scale @xmath11 for a fermionic@xcite and @xmath12 for a bosonic bath.@xcite using this hierarchy of scales , the sequence of finite - size hamiltonians @xmath13 for the @xmath14-site chain - site chain contains the impurity degrees of freedom , as well as the first @xmath15 wilson shells ( labelled by @xmath16 . ) ] is solved iteratively , i.e.  starting with @xmath17 one constructs the hamiltonian @xmath18 , diagonalizes it , adds the next site to obtain @xmath19 , diagonalizes it etc .",
    "the problem of an exponentially increasing hilbert space is resolved by observing , that , due to the exponential decrease of the energy scales , only low - energy states actually contribute in the step @xmath20 ; one thus discards the high - energy states before moving on to the next step to maintain a manageable number of states , we denote with @xmath21 in the following .",
    "the reduced basis set of @xmath13 obtained that way is expected to faithfully describe the spectrum of the full hamiltonian on a scale of the order of @xmath22 , corresponding to a temperature @xmath23.@xcite note that even from this brief discussion it is evident that for a given step @xmath14 all information about energies @xmath24 has been lost , while no information about energy scales @xmath25 is available yet .",
    "thus , to calculate dynamical quantities with a similar accuracy as thermodynamic , one has to tackle the problem of correctly mixing information from earlier and later nrg steps .      in a recent extension of the nrg to real - time dynamics out of equilibrium@xcite a _ complete basis set _ for such a wilson chain of length",
    "@xmath14 has been identified .",
    "furthermore , this complete basis set also forms an approximate eigenbasis of the hamiltonian @xmath26 .",
    "since this complete basis set plays a crucial role in the derivation of the analytical expression for spectral functions , we summarize briefly the main ideas@xcite of the proof of completeness discussed extensively in ref .  .",
    "at first sight the claim that the nrg automatically generates a complete basis set , which is also an approximate eigenbasis of the chain hamiltonian @xmath9 , might appear contradictory .",
    "a renormalization procedure is usually viewed as a clever way to identify the relevant degrees of freedom by reducing the dimensionally of the underlying fock space . in order to excavate the optimally adapted complete basis set",
    ", we have to shift perspectives how to view the nrg algorithm .",
    "there are two possible ways to interpret the iterative nrg solution of the @xmath14-site chain . in the traditional picture",
    "one starts from a core cluster that consists of the impurity degrees of freedom and the @xmath27 site , and enlarges the chain by one site at each nrg step .",
    "alternatively , one can view the nrg procedure as starting from the full chain of length @xmath14 , but with the hopping matrix elements set to zero along the chain . at each successive step",
    "another hopping matrix element is switched on , until the full hamiltonian @xmath13 is recovered . in this latter picture , to be adopted below , the entire sequence of hamiltonians @xmath28 with @xmath29 act on the fock space of the @xmath14-site chain .",
    "accordingly , each nrg eigen - energy of @xmath28 has an extra degeneracy of @xmath30 , where @xmath31 is the number of distinct states at each site along the chain .",
    "the extra degeneracy stems from the @xmath32 `` environment '' sites at the end of the chain , depicted in     is divided into a sub - chain of length @xmath33 and the `` environment '' @xmath34 .",
    "the hamiltonian @xmath28 can be viewed either as acting only on the sub - chain of length @xmath33 , or as acting on the full chain of length @xmath14 , but with the hopping matrix elements @xmath35 all set to zero .",
    "the former picture is the traditional one . in this paper",
    "we adopt the latter point of view.,width=302 ]    fig .",
    "[ fig:1 ] .",
    "the set of eigenstates of @xmath28 , conventionally denoted as @xmath36 , can be formally constructed from the complete basis set @xmath37 of the nrg chain of length @xmath14 where the @xmath38 label the configurations on each chain link @xmath39 . since @xmath28 does not act on the chain links @xmath40 , @xmath41 can be written as @xmath42 where the `` environment '' variable @xmath43 encodes the @xmath44 site labels @xmath45 . the index @xmath33 is used in this notation to record where the chain is partitioned into a `` subsystem '' and an `` environment '' ( see fig .",
    "[ fig:1 ] ) .",
    "consider now the first iteration @xmath46 at which states are discarded . in order to keep track of the complete basis set of the @xmath14-site chain",
    ", we formally divide the eigenstates @xmath42 into two distinct subsets : the discarded high - energy states @xmath47 and the retained low - energy states @xmath48 .",
    "in the course of the nrg , only the latter states are used to construct the next hamilton matrix @xmath49 within the reduced subspace @xmath50 .",
    "note , however , that the sum of both subsets still constitutes a complete basis set for the @xmath14-site chain . repeating this procedure at each subsequent iteration , we recursively divide the retained subset into a discarded part and a retained part . then , the collection of _ all discarded _",
    "eigenstates @xmath51 together with the eigenstates of the final nrg iteration @xmath14 combine to form a complete basis set for the entire fock space @xmath52 . regarding all eigenstates of the final nrg iteration as discarded , one can formally write the fock space of the @xmath14-site chain in the form @xmath53 .",
    "since _ all states _ are retained in the course of this construct , the following completeness relation obviously holds : @xmath54 here the summation over @xmath33 starts from the first iteration @xmath46 at which a basis - set reduction is imposed . all traces below",
    "will be carried out with respect to this basis set .",
    "hence , _ the evaluation of the spectral functions will not involve any truncation error_. note also that we made no reference to a particular hamiltonian @xmath55 in constructing the basis set @xmath56 .",
    "another useful identity to be used below pertains to the subspace retained at iteration @xmath33 , @xmath57 . to this end",
    ", we note that the sum in eq .",
    "( [ equ : complete - basis ] ) can always be divided into two complementary parts @xmath58 and @xmath59 : @xmath60 with the completeness relation @xmath61 note that for @xmath62 only @xmath58 exists .",
    "the textbook definition of the retarded green s function is given by @xmath63_{-s}}\\ ] ] where @xmath64_s = ab - sba$ ] with @xmath65 for bosonic operators @xmath66 and @xmath67 for fermionic operators .",
    "in our investigation , we restrict ourselves to local operators @xmath68 and @xmath69.@xcite    as already mentioned , the fundamental philosophy of the nrg is that a chain of length @xmath14 corresponds to a temperature scale @xmath70 , hence @xmath71 for all @xmath72 , where @xmath73 denotes the eigen energies of @xmath28 . in the nrg , the thermodynamic density operator @xmath74 is therefore represented only by the states of the last iteration @xmath14 @xmath75 and @xmath76 .",
    "if we were able to solve the nrg chain of length @xmath14 without any truncation , the green s function @xmath77 would be given by the textbook lehmann representation @xmath78      let us start from the retarded green s function looking only at the first term from the commutator and insert two completeness relations ( [ eqn : completness ] ) .",
    "we then obtain    @xmath79    for the second term from the commutator in ( [ eqn:6 ] ) one obtains a similar expression . here and in the following we use the convention that an index @xmath80 labels a discarded state , while an index @xmath81 represents a state kept at a certain chain length @xmath33 .",
    "the first term in ( [ eqn : gf - three - terms ] ) arises from @xmath82 , the second from @xmath83 and the third from @xmath84 , where we made use of eq .",
    "( [ eqn : partition - fock - space ] ) .",
    "this trick@xcite allows to express the green s function as sum over equal shell contributions only .",
    "note that this is an exact formula : _ no approximations _ have been made so far !",
    "since the state @xmath85 is an eigenstate of @xmath86 , i.e.  @xmath87 , we will now use the approximation @xmath88 .",
    "this approximation , justified due to the energy hierarchy implied by the logarithmic discretization , as dimensionfull hamiltonian in order to kept the notation as simple as possible .",
    "] is completely in the spirit of the nrg and in fact used in the calculation of thermodynamics properties.@xcite note , that this will be the only approximation made , which is of energetic nature and unrelated to any truncation error .",
    "we thus evaluate @xmath89 and laplace transform all contributions .",
    "the first term from ( [ eqn : gf - three - terms ] ) and the corresponding expression for the second term from the commutator contains only discarded states and reduces , therefore , to the last iteration @xmath90 due to the representation of the density operator in nrg by eq.([eqn : rho - nrg ] ) .",
    "it yields as contribution to @xmath91 @xmath92 in the next two terms the summation over all energy shells has to be evaluated , because the states @xmath93 are not orthogonal to @xmath94 .",
    "we obtain , using @xmath95 for @xmath72,@xcite    @xmath96    and @xmath97    since in the last iteration there are no kept states , all are considered discarded , @xmath90 does not contribute to @xmath98 and @xmath99 .",
    "now we insert a completeness relation @xmath100 between @xmath68 and the density operator in @xmath101 and @xmath69 and the density operator in @xmath102 and make use of @xmath103 for all @xmath72.@xcite because @xmath68 and @xmath69 are local operators , .",
    "see a detailed discussion in refs . .",
    "] the matrix elements @xmath104 are diagonal and independent of the environment variables @xmath105 .",
    "@xmath106 denotes the number of fermions in the environment times the total number of fermions created by @xmath107 .",
    "since the matrix elements of @xmath68 and @xmath69 are evaluated simultaneously , the total phase factor is given by @xmath108 ^ 2 = 1 $ ] for operator @xmath68 and @xmath109 imposing the same change of the total particle number .",
    "therefore , the trace over the environment only acts on the density operator @xmath74 and the final result @xmath110 and @xmath111 is formulated in terms of the reduced density matrix@xcite @xmath112 first introduced to the calculations of nrg spectral functions by hofstetter.@xcite the part @xmath113 describes negative frequency excitations , while @xmath114 accounts for positive frequency excitations for all @xmath72 because @xmath115 by construction .",
    "@xmath116 sums all excitations of the last iteration @xmath14 and has the form of the usual lehmann representation eq .",
    "( [ eqn : lehmann - representation ] ) .",
    "a few words are in place to pinpoint the difference to the hofstetter approach@xcite to calculate spectral functions with nrg . although our reduced density matrix @xmath117 is identical to the one given in eq .",
    "( 7 ) in ref .",
    ", our rigorous derivation differs in the summation of excitations contributing to the green s function .",
    "( [ eqn : green - ii ] ) and ( [ eqn : green - iii ] ) state clearly that one _ must _ only include excitations between a _ discarded _ and _ kept _ state while in the hofstetter approach@xcite the summation index @xmath80 runs over all states present at iteration @xmath33 .",
    "this leads to an overcounting of contributions , by the way inherent to all previous approaches to nrg spectral functions , see for details refs . and references therein .",
    "the origin of the restriction of summation in eqs.([eqn : green - ii ] ) and ( [ eqn : green - ii ] ) is quite obvious : all kept states in iteration @xmath33 span the fock - space of hamiltonian @xmath118 and , therefore , will contribute to the excitations at a latter iteration @xmath83 .",
    "they _ must not _ be included at iteration @xmath33 .",
    "in addition , the phenomenological patching algorithms,@xcite where spectral information from different energy shells are `` merged '' become obsolete in our approach .",
    "equations ( [ eqn : green - i]-[eqn : green - iii ] ) state exactly which excitations contribute at which wilson shell . obeying this summation restriction ensures the fulfillment of the spectral sum rules independent of the number @xmath21 of nrg states kept at each iteration . with a little algebra and the completeness relations ( [ eqn : completness ] )",
    ", we show in appendix [ sec : a1 ] that the spectral sum rule @xmath119_{s } } \\label{eqn : contour})\\end{aligned}\\ ] ] is always fulfilled _",
    "exactly_.    therefore , the spectral function will be correctly normalized independent of the number of states @xmath21 kept after each nrg iteration .",
    "note that the nrg truncation only influences the partitioning of the states , but never the completeness of the basis .",
    "hence , the spectral functions become more robust to truncation errors , as will be shown in section [ sec : results ] by using an extremely low number of kept nrg states .",
    "the spectral sum rule is a consequence of an operator identity and independent of approximations made in the dynamics as long as _ no states _ are discarded in the calculation .",
    "let us specialize to the local spin - dependent fermionic spectral function , i.e.  @xmath120 and @xmath121 .",
    "the local occupation @xmath122 can be expressed with the spectral integral as @xmath123 where @xmath124 is the fermi function . by substituting eqs.([eqn : green - i]-[eqn : green - iii ] ) for @xmath125 and evaluating the contour integration ,",
    "we show in appendix [ app : occ - sum - rule ] explicitly that our expressions approximately  at @xmath126 even exactly  reproduce the expectation value @xmath122 calculated directly with the nrg .",
    "in contrast to the spectral sum rule , however , which is _ exact _ and , therefore , reproduced in our numerics with machine accuracy , the accuracy of the occupation numbers calculated from the spectra depends on the validity of the assumption of vanishing boltzmann factors .",
    "therefore , we expect it to show a certain error at finite temperatures .",
    "nevertheless , we find that the deviation between the nrg values and the ones obtained by the numeric evaluation of ( [ equ : occupation - sum - rule ] ) remains less than @xmath127 .",
    "this implies also that the nrg value for quantities like the local magnetization @xmath128 is _ accurately _ reproduced by our formulation of the green s function .",
    "this is a significant improvement over the hofstetter approach , where deviations on the percent level between @xmath129 and @xmath130 have been reported.@xcite",
    "the general scheme for the calculation of spectral functions presented in section [ sec : theory ] did not make any reference to a certain model or bath statistics .",
    "therefore , our algorithm is suitable for any quantum impurity system . in order to demonstrate the virtue of the new approach",
    ", we will present in this section as an important example calculations for the spin - dependent single - particle spectral functions of the single impurity anderson model ( siam ) with and without an external magnetic field at @xmath126 and finite @xmath0 .",
    "the hamiltonian of the siam@xcite @xmath131 consists of a single local state , which we will denote with @xmath132 , with energy @xmath133 and coulomb repulsion @xmath134 , coupled to a bath of conduction electrons with creation operators @xmath135 and energies @xmath136 .",
    "the local level is subject to a zeemann splitting in an external magnetic field @xmath69 .",
    "note that we denote with @xmath137 the zeeman energy and the total splitting @xmath138 .",
    "we employ wilson s nrg@xcite to generate the eigen - energies , the matrix elements and basis set needed for the green s function .",
    "so far , all analytical calculations were performed using the discrete nrg spectrum . to obtain a continuous spectral function from the set of discrete @xmath139-functions occurring in @xmath91",
    ", we have to introduce a coarse - graining . due to the exponentially decreasing energy scales , a broadening on a logarithmic mesh by a gaussian @xmath140 is typically used.@xcite since this broadening function is properly normalized to one , the spectral weight is conserved and no principle inaccuracies are introduced by this procedure .",
    "in the following , we specialize to @xmath120 and @xmath121 . for comparison we calculated the raw nrg spectral",
    "function in three different ways : ( i ) by the conventional way as described in refs .",
    "labelled as ( con ) in the following , ( ii ) by the hofstetter approach@xcite ( ha ) and by our method defined by eqs.([eqn : green - i])-([eqn : green - tot ] ) labelled _ complete fock space _ approach ( cfs ) .",
    "as long as not stated otherwise , all energies are measured in units of the half band width @xmath141 , and for simplicity only a symmetric conduction band is considered with a constant density of states @xmath142.@xcite    .",
    "the inset on the left side emphasizes the broad charge excitation at @xmath133 , the inset on the right side zooms in at the abrikosov - suhl resonance ( asr ) .",
    "nrg parameters : @xmath143,width=302 ]    in fig [ fig:2 ] we show a comparison of spectral functions calculated by the three different methods using identical nrg input data and broadening parameters .",
    "all three methods agree on the shape and the height of the many - body resonance ( asr ) at the fermi energy and all methods do not reach the unitary limit of @xmath144 as predicted by the density of states rule.@xcite the spectral functions , however , differ in their high energy features .",
    "the conventional spectral function underestimates the charge excitations and only reaches a total spectral weight of @xmath145 .",
    "the hofstetter approach@xcite yields a somewhat improved value of @xmath146 because the high energy part of its spectrum , which carries most of the spectral weight , lies between our and the conventional curve .",
    "the spectral function based upon our new approach , however , reaches the spectral weight @xmath147 .",
    "it deviates from the exact value of @xmath148 only by the error introduced by the numerical @xmath149 integration . to verify this , we add all spectral weights from eqs .",
    "( [ eqn : green - i])-([eqn : green - iii ] ) directly and obtain @xmath150 , i.e.  the norm is @xmath148 within machine accuracy . and finite temperature ! ] for this symmetric case , its obvious that our approach also yields the _ exact _ occupation number of @xmath151 for each spin direction while the other two approaches have a @xmath152 ( con ) or @xmath153 ( ha ) error .",
    "note , however , that the latter two still give the correct value @xmath154 with respect to their respective norm .    at this point a comment on the violation of the density of states rule @xmath144 for @xmath155 seems in order .",
    "since the nrg itself does only provide the weight of @xmath139-peaks , the height of the coarse - grained spectrum will depend on the density of these peaks , i.e.  the number of states available in the calculation , and the choosen broadening function .",
    "this _ does not _ imply the violation of friedel sum rule@xcite , too , which relates the _ scattering phases _ to the number of displaced electrons in each spin channel .",
    "since the nrg fixed point spectrum contains the correct scattering phases , it is accurately fulfilled .",
    "however , the relation between the phase shift and the local spectral function is in general not very accurately reproduced due to the aforementioned reasons . nevertheless , the density of states sum rule can be satisfied with an error of less than @xmath156 using small values of @xmath157 , more nrg states and a smaller broadening@xcite as used in fig [ fig:2 ] .    to our knowledge , only the indirect calculation of the physical green s function by expressing its self - energy by the ratio of two correlation functions@xcite yields values which are accurate enough to reproduce the correct height of @xmath158 nearly independent of the broadening parameters . in particular",
    ", this is of importance to prove the pinning of the spectral function for the two - channel anderson model at half the unitary limit.@xcite     but with only @xmath159 states kept in each nrg iteration .",
    "the inset zooms in onto the asr .",
    "[ fig:3 ] , width=302 ]    we have put our method to an extreme test by reducing the number of states @xmath21 kept after each nrg step to @xmath159 for the same @xmath160 as before .",
    "this is definitely stretching the limit of the conventional nrg beyond its accuracy .",
    "the results for the spectral functions are plotted in fig .",
    "[ fig:3 ] .",
    "only data for frequency @xmath161 are included , which , however , is much smaller than the kondo temperature @xmath162 as estimated from the width of the asr .",
    "the inaccuracy of the matrix elements for extremely small frequencies @xmath163 yields erratic results in this interval which , therefore , are omitted here .",
    "while the conventional and the ha methods significantly loose spectral weight , the spectral weight of cfs spectral function remains at the exact value @xmath148 .",
    "since the discretization of the energy mesh was the same in all figures , the deviation from the sum rule of @xmath164 again stems only from the numerical integration . for comparison",
    "we also added the cfs curve from fig .",
    "[ fig:2 ] , calculated with @xmath165 nrg states .",
    "both cfs curves agree extremely well .",
    "in particular , the weight under the charge peak is only slightly redistributed and the shape of the asr remains unaltered . only at very low frequency , the inaccuracy of the underlying nrg input data takes its toll : the asr peak height is further reduced .",
    "the other two methods , however , exhibit strong dependence on @xmath21 in all energy regimes .",
    "we must report an error in the spectral weight and the occupancy @xmath166 of @xmath167 for both the conventional and the ha method . in all cases",
    "the same broadening parameter @xmath168 was used .     and ( b ) @xmath169 .",
    "the full curves represent spin up , the dashed ones spin down .",
    "the inset in ( a ) is a zoom into the region around the fermi level showing the splitting and suppression of the kondo resonance .",
    "model and nrg parameters as in fig .",
    "[ fig:3 ] .",
    "the norm and occupancies obtained are compared in tab .",
    "[ tab : symm_with_b ] , width=302 ]    while the conventional method yields quite reliable spectral information for small @xmath157 and large number of states in the absence of a magnetic field , it fails for finite magnetic field , where the fixed point for @xmath155 yields a complete redistribution of spectral weight on all energy scales compared to the spectral function@xcite at @xmath170 .",
    "therefore , it is omitted in fig .",
    "[ fig:4 ] , where we compare spectral functions for two magnetic fields , @xmath171 ( fig .",
    "[ fig:4]a ) and @xmath172 ( fig .  [ fig:4]b ) ; the results for the majority spin are plotted as solid lines , the ones for the minority spin as dashed lines . for @xmath173 the asr",
    "is split and already reduced to half its original height , while for @xmath174 it has vanished completely , as expected .",
    "again , we display the data for @xmath159 to highlight the differences in the methods . while our method and the ha approach exhibit the same overall features , i.e.  splitting and reduction respectively complete lack of the asr and a major redistribution of spectral weight , the charge excitation peak contains much more spectral weight in the cfs as the ha curve .",
    "as before , the cfs spectral function    .norm and occupancies for the calculations with finite magnetic field in fig .  [ fig:4 ] .",
    "the last columns contain the occupancies obtained from the thermodynamic expectation values.[tab : symm_with_b ] [ cols= \" < , < , > , > , > , > , > \" , ]     tab .",
    "[ tab : symm_with_b_finite_t ] for @xmath175 and @xmath159 . to avoid additional inaccuracies introduced by the broadening ( [ eqn : lorentian_broadening ] ) we have listed in tab .",
    "[ tab : symm_with_b_finite_t ] the sum of the weights of the raw nrg spectra multiplied with the fermi function .",
    "as for @xmath126 , the deviations to the thermodynamic values stay always less than @xmath176% .",
    "numerical integration of the broadened spectra , on the other hand , will lead to stronger deviations , in particular for higher temperatures . for example , we find @xmath177 for @xmath178 and @xmath175 , i.e.  an error in the percent range .",
    "the value of @xmath179 with @xmath180 smoothened by the described combination of gaussian and lorentzian broadening deviates from the sum over the spectral weights of the poles of the discrete spectrum times the fermi function at the pole energy , since the lorentzian part extends in an uncontrolled manner to positive and negative frequencies .",
    "this systematic error , however , is still small even in these extreme cases .",
    "we presented a novel approach for the calculation of local green s functions for quantum impurity systems using wilson s numerical renormalization group .",
    "since it is based on the usage of a _ complete basis set _ for the wilson nrg chain , recently introduced in the context of the time - dependent nrg,@xcite quantities written as spectral sum rules are _ always exactly _ fulfilled , regardless of the size @xmath21 of the hilbert space kept in each nrg iteration . moreover , spectral averages like occupation numbers etc .  are at least reproduced with unprecedented accuracy .",
    "we have demonstrated the quality of the approach by presenting results for the fermionic single - particle spectral function @xmath181 of the single impurity anderson model .",
    "we have shown explicitly the validity of our claim , that the resulting spectral functions are very insensitive to the number of nrg states kept in the iteration .",
    "this is a consequence of using a complete basis set in the derivation of the lehmann representation .",
    "equations ( [ eqn : green - i])-([eqn : green - iii ] ) precisely account for which excitation contributes at which energy shell @xmath33 , thus manifestly solving the double counting problem of excitations responsible for the violation of the sum rules in all previous nrg spectral function approaches : the conventionally employed `` patching '' algorithms thus have become obsolete . also , no even - odd oscillations can be observed .",
    "we believe that our novel approach provides the most accurate representation of local spectral functions for a given nrg input . it can be used in quantum impurity systems , at finite temperature as well as @xmath155 .",
    "it is particular suitable for symmetry broken phases , for instance in an external magnetic field .",
    "this significant improvement can have a major impact on the usage of the nrg as impurity solver for the dynamical mean field theory ( dmft).@xcite in particular , for the description of symmetry broken phases such as the ferromagnetic hubbard model@xcite as well as orbital order in the two - band hubbard model , the discrepancy between the local nrg order parameter and the one obtained from the spectral function often yields instabilities in iterating the dmft equations .",
    "moreover , very accurate spectral functions are needed for the application of the nrg to cluster dmft approaches,@xcite or periodic anderson models which include crystal field effects@xcite . up to now such an accuracy",
    "could only be achieved with immense cpu time.@xcite    we acknowledge stimulating discussions with a.   which helped us clarifying that cfs can be applied to the evaluation of correlation functions rigorously such that inter - shell contributions are absent . after completion of this work we learned that weichselbaum and von delft independently had followed up on the same idea@xcite with a slightly different focus and a more generalized treatment of the density matrix .",
    "we further thank t.  a.   costi for stimulating discussions , as well as a.  schiller for collaborations on related work .",
    "this research was supported by the dfg through collaborative research grant sfb 602 ( rp and tp ) and project an 275/5 - 1 ( fba ) .",
    "we acknowledge supercomputer support by the gesellschaft fr wissenschaftliche datenverarbeitung gttingen and the norddeutsche verbund fr hoch- und hchstleistungsrechnen under project nip00015 ( rp and tp ) , as well as the nic , forschungszentrum jlich under project no .  hhb000 ( fba ) .",
    "by inserting the analytical expression ( [ eqn : green - tot ] ) for the discrete spectral function into the integral ( [ eqn : contour ] ) @xmath182 yields the following three contributions @xmath183 by formally defining the `` reduced density matrix '' for the last wilson shell as @xmath184 the first term in ( [ eqn : a2-contour ] ) can be included into the second and third .",
    "then the second reads @xmath185 in this step , we used the definition of the reduced density matrix and made use of the fact that the local operators @xmath68 and @xmath69 are independent of the environment variables @xmath186 . due to the form of the density operator , @xmath187 holds for @xmath72 . for @xmath188 ,",
    "@xmath189 spans the complete fock space and the projection @xmath190 contains all contributions at @xmath90 .",
    "therefore , the contribution @xmath191 yields @xmath192 we can perform the same calculation for the third term in ( [ eqn : a2-contour ] ) and the contribution stemming from the @xmath193 part of the first term at @xmath90 to derive @xmath194 to this end , the total contribution is given by @xmath195_{s}}\\ ] ] we thus have proven that our green s function fulfills the spectral sum rule _",
    "exactly_. thus , any deviations for this sum rule in the broaden spectral function stems solemnly from the accuracy of the numerical @xmath149 integration .",
    "we now want to discuss the accuracy of our approach for the generalized occupancy @xmath196 defined as @xmath197 where @xmath198^{-1}$ ] . as always throughout the paper",
    ", this definition comprises bosonic and fermionic green s functions .",
    "specializing to the local spin - dependent fermionic spectral function , i.e.  @xmath120 and @xmath121 , yields the occupational sum rule ( [ equ : occupation - sum - rule ] ) as presented in section [ sec : occ ] .    inserting the green s function ( [ eqn : green - tot ] ) into the expression ( [ eq : aa1 ] ) and performing the contour integration yields the following three contributions : @xmath199 adding and subtracting @xmath200 leads to @xmath201 using the same identities as in appendix [ sec : a1 ] .",
    "finally , the error @xmath202 of the occupation sum rule is given by @xmath203 to estimate the size of this error , let us note that the excitation energies @xmath204 appearing in @xmath202 are positive , because @xmath80 labels a discarded and @xmath81 a kept state .",
    "excitations between two discarded states never contribute as well as excitations between to kept states .",
    "the smallest energy difference possible is given by the energy of the first discarded minus the energy of the last kept state .",
    "even though this energy difference might be small , the smallness of the matrix element of the reduced density matrix suppresses this contribution .",
    "we are thus left with energy differences which are of the order @xmath205 for @xmath72 .",
    "the density matrix @xmath206 , on the other hand , is restricted to the last iteration , i.e. , to be consistent with the fundamental assumption of the nrg , @xmath207 \\gg1 $ ] for @xmath72 .",
    "thus , the denominator in @xmath202 becomes exponentially large and hence @xmath202 exponentially suppressed with decreasing temperature .",
    "note that this also means , that for @xmath208 the occupation sum rule will be obeyed exactly , too . for finite @xmath0",
    "we must expect , and indeed find ( see section [ sec : finite_t ] ) , deviations from this sum rule with increasing temperature .",
    "our numerical results show , however , that even for high temperatures these deviations stay below the per mille level .",
    "the textbook definition of the imaginary time green s function is given by @xmath209 where again @xmath65 for bosonic operators @xmath66 and @xmath67 for fermionic operators .",
    "it is straight forward to show that the analytic continuation @xmath77 of the _ exact _ matsubara green s function @xmath210 @xmath211 where @xmath212 for fermionic and @xmath213 for bosonic green s functions , is identical to the laplace transformed _ exact _ retarded green s function ( [ eqn : lehmann - representation ] ) with @xmath214 .",
    "we can perform the same steps for @xmath215 as in section [ sec : ii.c ] . in this case , however , the terms @xmath216^{-1}$ ] in @xmath113 and @xmath217^{-1}$ ] in @xmath114 must be replaced by @xmath218 and @xmath219}{i\\omega   + e^m_{k}-e^m_{l}}\\;.\\ ] ] at first sight , the two green s functions are not equal in our approach .",
    "however , as discussed in appendix [ app : occ - sum - rule ] , the boltzmann factors @xmath220 $ ] can be neglected for @xmath72 .",
    "this is justified by the nrg assumption that the density operator is well approximated by its contribution of the last wilson shell , i.e. eq.([eqn : rho - nrg ] ) .",
    "therefore , both green s functions are identical within the nrg approximation .",
    "a.  weichselbaum and j.  von delft , cond - mat/0607497 ( 2006 ) .",
    "we recommend this paper for a discussion of detailed balance and possible extensions of the nrg density operator as well as broading procedures ."
  ],
  "abstract_text": [
    "<S> we present a novel technique for the calculation of dynamical correlation functions of quantum impurity systems in equilibrium with wilson s numerical renormalization group . </S>",
    "<S> our formulation is based on a complete basis set of the wilson chain . </S>",
    "<S> in contrast to all previous methods , it does not suffer from overcounting of excitation . by construction </S>",
    "<S> , it always fulfills sum rules for spectral functions . </S>",
    "<S> furthermore , it accurately reproduces local thermodynamic expectation values , such as occupancy and magnetization , obtained directly from the numerical renormalization group calculations . </S>"
  ]
}