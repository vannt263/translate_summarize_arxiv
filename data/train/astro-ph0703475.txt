{
  "article_text": [
    "the next generation of wide - field sky surveys will be capable of discovering as many solar system objects in one lunation as are currently known .",
    "their unprecedented discovery rate coupled with their deep limiting magnitudes will make targeted astrometric and photometric followup observations impossible for the vast majority of objects .",
    "thus , it is necessary that the new search programs employ survey strategies that reacquire multiple observations of the same objects within a lunation ( a lunar synodic period ) . furthermore , these facilities would tax the current capability of the international astronomical union s minor planet center ( mpc ) , the clearing house for observations of the solar system s small bodies , for linking the detections and orbit determination .",
    "the only solution is that the surveys must provide the capability themselves and then provide the mpc with pre - linked , vetted detections over multiple nights .",
    "simplistic linking algorithms for those detections scale like the square of the sky - plane density ( @xmath0 ) and , at the high densities expected for the next generation surveys , the linking procedure could dominate the processing time .",
    "this work presents algorithms to solve the problem that are fast , efficient , accurate and scale as @xmath1 .",
    "we test our algorithms on pseudo - realistic simulations .",
    "the history of asteroid orbit determination is mathematically rich .",
    "it all began with the visual discovery of ceres by giuseppe piazzi in 1801 and subsequent theory of orbit determination by @xcite . at that time",
    "new techniques were developed to handle the orbit determination from a short arc of observations and the ephemeris errors on the observations of ceres were many arcseconds .",
    "two hundred years later absolute astrometric residuals are about an order of magnitude better and the next generation surveys promise to reduce those residuals for bright asteroids another order of magnitude .    as of 2006",
    "august 6 there were a total of 338,470 asteroids in the astorb database @xcite and over 20k asteroid observations are reported daily to the minor planet center .",
    "as new observations of previously known asteroids are identified their orbital elements are automatically updated .",
    "furthermore , new observations of asteroids that were unknown are linked together and their orbits are calculated quickly and automatically by digital computers .",
    "the discovery rate of asteroids and comets has climbed dramatically in the past decade ( for an overview of current asteroid search programs see @xcite ) due to the advent of new technologies like the ccd camera and because of nasa s congressional mandate to search for near earth objects ( neo ) larger than 1 km in diameter @xcite .",
    "the mandate to identify 90% of neos in this size range will most likely be achieved shortly after the 2008 deadline @xcite .",
    "asteroids ( and often comets ) are usually identified by their apparent motion against background stars in an image during the time between three or more exposures separated in time by tens of minutes .",
    "all existant surveys have relied on the nearly linear motion of the objects on the sky during the short time between exposures to distinguish between real objects and random alignments of false detections ( noise ) .",
    "some historical and contemporary surveys identify or check their observations of moving objects by eye .",
    "as the discovery rate and the limiting magnitude of the surveys has increased the sky - plane density of asteroids has increased and , with it , the opportunity for false identifications and linkages .",
    "this explosion in the number of reported observations to the mpc has generated a corresponding theoretical examination of the techniques used in linking new observations and fitting orbits ( _ e.g. _   * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "these problems , as well as that of attribution ( identifying observations with known objects ) , orbit identification ( realizing that multiple instances of an object s orbit appear in a database ) , and precovering observations ( identifying earlier detections of an object in a database ) , are described by milani _",
    "_  in a series of articles @xcite .",
    "this work describes new algorithms , and the testing framework developed to measure their efficiency and accuracy , for intra and inter - night linking of asteroid detections .",
    "the algorithms work well in simulations of the performance of the next generation sky surveys .",
    "spurred by the 2001 decadal review @xcite a new generation of all - sky surveys are expected to commence operations within the next ten years .",
    "these new surveys will take advantage of the latest developments in optical designs ( _ e.g. _  to produce large , flat fields of view ) and ccd technology ( _ e.g. _  extremely fast readout ) to survey the sky faster and deeper than ever before .",
    "the first of the next generation surveys to image the sky will be the panoramic survey telescope and rapid response system ( ps .",
    "* ) located in hawaii .",
    ".  will be composed of four 1.8 m diameter telescopes each with its own 1.44 gpix camera ( 0.3/pixel ) .",
    "images from each of the four cameras will be combined together electronically .",
    "the cameras will use an innovative new ccd technology composed of orthogonal transfer arrays ( ota , * ? ? ?",
    "* ) that allow charge to be moved on the ccd in both the @xmath2 and @xmath3 directions in real time at @xmath430 hz to compensate for image motion due to the atmosphere or any tracking problems . in effect",
    ", the system produces a tip - tilt corrective optics on - chip rather than with the secondary _ and _ it is able to achieve superior seeing over the entire @xmath47 deg@xmath5 field - of - view rather than just within the small isoplanatic angle in the center of the field . a prototype system ( ps1 ) located on the summit of haleakala",
    ", hi , saw first light in the summer of 2006 and will begin science operations in the summer of 2007 .",
    "one of the primary scientific goals of the ps .",
    "survey is to identify 90% of all potentially hazardous objects",
    "larger than 300 m diameter within its ten year operational lifetime . in the process it will identify about 10 million other solar system objects .",
    "it is expected to reach @xmath6 at 5-sigma in 30sec exposures at which level the sky - plane density of asteroids will be about 250/deg@xmath5 on the ecliptic .",
    "this is also the predicted density of false 5-sigma detections in the image .",
    "thus , the ratio of false : real detections at 5-sigma is equal to unity on the ecliptic and increases dramatically off the ecliptic . given enough computing power and/or time it is , in principle , possible to link individual detections together on separate nights of observation .",
    "_ a priori _ distributions of asteroid velocities and accelerations at any sky location could be used to intelligently link detections on separate nights and then fit orbits to them to select those that represent observations of objects .",
    "( note that we distinguish between a detection , which is a set of pixels on an image with elevated signal relative to the background , and an observation which is a detection associated with a real object . )",
    "this method has not yet been used in practice because of the combinatorics of the problem as the limiting magnitude of the system is approached and the number of real and false detections increases dramatically .",
    "it is almost certain that this technique will require 4 nights on which each object was detected in order to determine orbits with good fidelity .    as mentioned above , the typical contemporary asteroid survey obtains @xmath73 observations of an asteroid within a short period of time on a night . when these observations are submitted to the mpc",
    "there is high probability that each set of detections corresponds to a real object .",
    "the mpc s responsibility is to link these detections to known objects or to other new detections of the same object .",
    "many of the contemporary and all the historical asteroid surveys identified neos through their anomalous rates of motion relative to other objects in or near the field of view @xcite .",
    "there are two main problems with this mode of operation for the next generation surveys .",
    "first , in order to guarantee that reported sets of detections correspond to real objects , surveys require @xmath73 detections on a night which dramatically limits the system s sky coverage ; _ e.g. _  a system that obtains only 2 detections / night can cover 50% more sky , and obtain 50% more detections than a survey requiring 3 detections / night .",
    "second , follow - up of neo detections for the contemporary surveys is typically accomplished by the survey itself or by other professional surveying systems . since the first next generation survey ( at least ) will not have the luxury of any other existing system being able to recover newly discovered objects , the survey must obtain its own follow - up .",
    "system will most likely obtain just 2 images per night of each solar system survey field but re - image the field 3 or 4 times within a lunation .",
    "two images are used each night in order to distinguish between false and real detections and separate stationary and moving transient objects .",
    "it also has the benefit of providing a small motion vector for each possible observation .",
    "obtaining the same object a few more times within the next two weeks provides both recovery of the objects and more nights of observations with which to calculate an orbit and verify the reality of each set of detections . since it is ( currently ) required that detections reported to the mpc have a high probability of being legitimate observations , ps .",
    "will only report those detections to the mpc that are linked across nights into real orbits .",
    "thus , ps .  must develop the capability of linking detections across nights into real orbits .",
    "if the mpc relaxes the condition on the accuracy of linked detections then ps .  will report everything that is available .    the responsibility for intra - night ( within a night ) and inter - night ( between many nights ) linking of detections ( as well as attributing , precovering , orbit determination and identificationm , etc . )",
    "rests with ps .",
    "s moving object processing system ( mops ) .",
    "images from the cameras on each of the four ps .  telescopes",
    "( for the ps",
    ". -1 system only a single camera and telescope will be in operation ) are first passed through the image processing pipeline ( ipp ) that aligns , warps , removes cosmic rays , etc . , and digitally combines them into a single master image .",
    "many master images are combined together to create a high s / n static - sky images that is subtracted from the current master image to obtain a difference image containing only transient sources ( stationary and moving ) and noise ( false detections ) .",
    "the difference image is then searched for sources consistent with being asteroids ( both nearly stationary and moving fast enough to trail ) and also for comets .",
    "pairs of difference images separated by a transient time interval ( tti ) of about 15 - 30 minutes ( the time separation is still to be determined and may vary with sky - plane location ) are analyzed in the same manner . a list of all the identified sources in both images along with their characteristics ( time , trail length , axis orientation , flux , etc .",
    ") is then passed to the mops .",
    "the software and algorithms described herein are expected to be applicable to both ps . -4 and ps . -1 and the tests described",
    "herein are performed at asteroid sky - plane densities ( _ i.e. _  limiting magnitude ) expected for the four telescope system .",
    "the mops will ;    * link intra - night detections into probable observations ( tracklets ) , * attribute tracklets to known objects , * link inter - night detections into possible objects ( tracks ) , * perform an initial orbit determination ( iod ) to select tracks that are likely to be real objects , * perform a differential correction to the orbit determination ( od ) to obtain a derived orbit for the track , * identify whether an earlier derived orbit is identical to the current orbit , * seek precoveries in all earlier images of the derived object , * and determine its operational efficiency and accuracy in nearly real time using a synthetic solar system model .",
    "the results described herein only describe the algorithms and efficiency for the first and third steps , the intra - night and inter - night linking of detections .",
    "the performance of the mops for the other aspects of its operation will be described in future papers .",
    "at 5-sigma ( or @xmath8mag ) we expect about 250 false detections / deg@xmath5 @xcite or about 1750 false detections per image at any position on the sky . to the same s /",
    "n we also expect a maximum sky - plane density of asteroids on the ecliptic of about 250/deg@xmath5 @xcite but this number decreases dramatically off the ecliptic . at 3-sigma",
    "the false detection rate will be about 100@xmath9 higher with only an increase of about 1.4@xmath9 in the number of real detections .",
    "it is clear from these ratios that the difficulty of identifying asteroid observations increases substantially as we push the limiting operational s / n into the noise .",
    "the s / n at which the ps .",
    "mops will operate will be determined when the actual operational characteristics of the system are known . for this work",
    "we assume a 5-sigma cutoff corresponding to @xmath10mag for the four telescope ps .  facility .",
    "the first step in the mops is to identify sets of detections in images within a night that are spatially close and therefore likely to be observations of a real object .",
    "we call these sets of detections _ tracklets_. the mops also uses trailing information in the form of the length and orientation of each detection to further constrain the intra - night linking problem - only those detections that have the expected trail length and orientation given their separation in time and space are combined into tracklets .",
    "we will demonstrate below that our process is almost 100% efficient at identifying tracklets with an accuracy in the range of 85 - 90% ( see table [ tab.standardtrackletperformance ] ) .",
    "the second mops step is the inter - night linking of tracklets into sets that we call _ tracks_. in operations this step is followed by iod and od to select only those tracks that are valid orbits",
    ". we will show below that at the expected sky - plane density of real and false detections the set of realized tracks are mostly false .",
    "but after iod and od we are left with a nearly pure sample of actual orbits .",
    "the key is to use the track formation process to reduce the number of false tracks to a sufficiently small number that it is feasible to calculate orbits for all tracks within the required time frame .",
    "the difficulty in intra- and inter - night linking of detections is combinatoric and increases like @xmath11 , where @xmath0 is the number of detections / deg@xmath5 , if a brute - force approach is taken in linking the detections .",
    "a few sophisticated techniques have been proposed ( _ e.g. _   * ? ? ?",
    "* ; * ? ? ?",
    "* ) to deal with these problems .",
    "we report here on our success with a linking algorithm that makes use of a clever data structure ( known as a kd - tree ) to convert the combinatoric problem in both cases into one that increases instead like @xmath12 . in this manner",
    "we can explore and reject many possible linkages without resorting to sophisticated and time consuming orbit determination techniques and thereby increase the speed with which we can manage the large number of detections ( false and real ) from the next generation surveys .",
    "to verify that our linking algorithms are efficient we require a model of the various populations of small bodies in our solar system that could possibly reach @xmath13 .",
    "this simulation requires realistic orbits rather than simply the objects spatial distribution .",
    "these requirements forced us into developing our own solar system model ( ssm ) rather than adopting @xcite s statistical asteroid model ( sam ) for main belt asteroids , though we were motivated by some of the techniques developed for the sam .",
    "our ssm will be discussed in detail by @xcite and only briefly here ( also * ? ? ?",
    "for the purpose of testing the mops we have developed a preliminary model of many populations of objects in our solar system and beyond including nearly 11 million small bodies :    * near earth objects ( neo ) ( including objects entirely interior to the earth s orbit ) * main belt objects ( mbo ) * jupiter trojans and trojans of all other planets * centaurs ( cen ) * jupiter family , halley - type and oort cloud comets ( com ) * trans - neptunian objects ( tno ) - classical , resonant , scattered and extended scattered disk .",
    "the details of the model are not critical to interpreting the work reported here . in general",
    ", we have a preliminary model of different small body populations in the solar system ( and some populations that have not been discovered ) that mimic the real objects at different levels of fidelity in each of the following properties :    * orbit distribution * absolute magnitude ( h ) , size and albedo distribution * shapes modelled as tri - axial ellipsoids * rotation rates * pole orientations    for the simulations described here we simply used the absolute magnitude and standard formulae @xcite for converting to apparent magnitudes rather than incorporating the shape , rotation rate and pole orientation .",
    "the input orbit distributions for the neos @xcite and cens @xcite have a pedigree traceable to published studies while the mbos mimic the large statistics of the nearly complete mbo population ( for @xmath14 ) @xcite . for the moment ,",
    "the input orbit distributions for the other populations are based only on the observed rather than the debiased populations . in all cases we generated a full suite of objects that might achieve @xmath15 ( the expected ps . -4 limiting magnitude ) at some time in the next ten years .",
    "the absolute magnitude distributions were generated according to corrected @xmath16 distributions where available ( neo - @xcite , mbo - @xcite , cen - @xcite , tro - @xcite , tno - @xcite , sdo - @xcite ) .",
    "for all types of comets the absolute magnitude distribution was simply the observed distribution extended to smaller sizes in a natural manner .",
    "it is our intention to improve this model for comets in the final solar system model implement for mops .",
    "many researchers have modelled asteroid surveys in an attempt to predict the performance of a particular system ( _ e.g. _   * ? ? ? * ; * ? ? ?",
    "others have modelled generic survey systems in order to elucidate more general principles ( _ e.g. _   * ? ? ?",
    "* ; * ? ? ?",
    "for instance , in the case of discovering neos , @xcite and @xcite showed that it is more important to cover more sky than it is to go to fainter limiting magnitudes in a smaller area .",
    "these earlier simulations had a wide range of fidelity to realism with some merely postulating that the entire sky would be covered in a night .",
    "the final mode of solar system surveying for ps .  will be under study until regular asteroid surveying begins in earnest .",
    "even then , we believe that a regular review of the survey strategy will be necessary in an attempt to maximize the system efficiency .",
    "the simulation of the survey implemented here is our first - order vision that incorporates many of the most important aspects of an efficient and realistic survey that has as its highest priority the identification of sub - km potentially hazardous objects ( pho ) .",
    "a full discussion of the survey simulation and its impact on the mops asteroid discovery rates is in preparation @xcite .",
    "with phos in mind we place a high emphasis on covering the ` sweet - spots ' , the sky at small solar elongation and small ecliptic latitude where the sky - plane density of phos at ps . s limiting magnitude is expected to be highest @xcite .",
    "we take advantage of the fact that asteroids tend to be brighter near the anti - solar point and attempt to identify high inclination or nearby objects surveying a wide area in both longitude and latitude near opposition .    for the purpose of this work",
    "consider an ecliptic longitude ( @xmath17 , opposition longitude ) and latitude ( @xmath18 ) system centered on the opposition point .",
    "_ e.g. _  opposition is always at @xmath19 . in this reference frame",
    "the solar system survey is defined by the two sweet spots with @xmath20 , @xmath21 or @xmath22 and also the opposition region with @xmath23 and @xmath24 totaling about 5500 deg@xmath5 . to simplify our simulation we assumed that the ps .",
    "fields are square and of an area about equal to the final expected camera field . figure [ fig.hammer-aitoff.sss ] shows the distribution of equal area field centers on the sky in the sweet - spots and opposition regions",
    ". there are 660 fields in the opposition region and 84 in each of the sweet - spots corresponding to field coverage of about 4,356 deg@xmath5 and 1108 deg@xmath5 ( in both sweet - spots ) respectively .",
    "each ps .",
    "field covers about 7 deg@xmath5 so this simulation allows for some moderate overlap between adjacent fields .",
    "it is important to note that this scanning pattern ( and the one likely to be adopted for pan - starrs solar system survey operations ) avoids the ( main belt ) stationary spots about 3.5 hours ( @xmath25 ) from opposition .",
    "the stationary spots are regions where apparent asteroid motion along the ecliptic may briefly drop to zero .",
    "the more distant the asteroid population the greater the distance from opposition at which the objects become stationary. for intance , tnos are stationary fully 80@xmath26 from opposition - nearly in what we refer to as the sweet - spots .",
    "asteroid paths on the sky can even form closed loops far from opposition that might cause difficulty for the linking algorithm desribed herein .",
    "moving objects will drift out of any fixed region on the sky .",
    "even a fixed - size region that moves at the mean rate of motion of moving objects in the field will lose objects near its edge .",
    "one solution is to expand the size of the region with time .",
    "another solution is to ensure that the region translates at a rate equal to the mean rate of motion of the objects of primary interest in the region .",
    "we have used our solar system model (  [ s.solarsystemmodel ] ) to determine the apparent rate of motion of neos with @xmath27mag in the three survey regions .",
    "the sweet spots are small enough in ecliptic longitude extent ( 30@xmath26 ) that we included all neos in those regions and found that they are moving at mean rates of @xmath28/day ( as expected from symmetry ) and prograde at @xmath29/day .",
    "the opposition region covers a much wider range in ecliptic longitude and we are only in danger of losing objects that are near its eastern and western edges .",
    "thus , only those neos within 15@xmath26 of the eastern or western edge of the region were used to determine that they are moving retrograde at a mean rate of @xmath30/day .    for the purpose of this work",
    "we have assumed that the solar system survey requires imaging of each field within a region three ( 3 ) times per lunation with a mininum spacing of four ( 4 ) nights between any successive visit to each field .",
    "while this scenario is suitable for this simulation we have evidence that another night of observation , especially in the sweet - spots , will be necessary to resolve degenerate multiple orbit solutions . when running the simulation we have assumed that a random 25% of nights are entirely clouded out while the remaining 75% are entirely clear .",
    "this results in a variable number of nights between visits in a lunation .",
    "the algorithm for scheduling the fields within the regions is described below . for the purpose of developing the inter - night field scheduler it was convenient to think in terms of scheduling nights with respect to full moon ( @xmath31 = full moon plus @xmath32 nights ) .",
    "evening and morning sweet spots may be acquired on the same night but the opposition region was impossible to schedule in its entirety on a single night .",
    "we divided the opposition region into northern and southern ecliptic latitudes that need to be acquired on separate nights and may not be imaged on nights on which a sweet spot is acquired ( sweet spots also have higher priority ) .",
    "objects in the evening sweet spot are being overtaken by the sun .",
    "first _ opportunity to visit the ess is just after full moon ( @xmath33 days ) , when the waning moon is no longer in the bright sky after astronomical twilight ends .",
    "last _ opportunity to catch the ess is a few days after new moon ( @xmath34 days ) before the young moon enters the evening sweet spot .    when scheduling surveying in the ess it is impossible ( due to weather or the other ps .",
    "science survey requirements ) to predict what night will be the actual last night of observation .",
    "thus , on the first possible night of surveying in the ess we assume the worst case scenario that the last possible night will be the last opportunity to survey the same region at @xmath34 days .",
    "the last night then defines the ess region and we then work backwards from that location at a rate of @xmath35/day to determine the location of the ess on any of the previous nights on which it is actually acquired .",
    "scheduling of the opposition regions is constrained by the moon appearing in those regions when it is full . for both regions",
    "we have assumed that the first day it is possible to acquire these regions is at @xmath36 days and the last is at @xmath37 days .    when scheduling the opposition regions we assume that the second night will be acquired at new moon and define the actual field locations on a specific night by translating the region at a rate of @xmath38/day .",
    "objects in the morning sweet spot are also heading towards the sun but they have many months until they pass behind it because the sun is moving away from them faster than they approach it .",
    "thus , the location of neos in the area of the mss move away from the horizon with time and the sky - plane location of neos improves with time as a lunation progresses .",
    "surveying in the mss may start just before new moon ( @xmath39 days ) and is possible until the just - before - full moon enters the morning sky ( @xmath40 ) .",
    "for scheduling the mss region we simply survey the optimal mss region on the first possible day that it can actually be surveyed and translate the region by @xmath35/day to determine the location of the mss on subsequent nights on which it is acquired .",
    "once the fields for a specific night have been selected they need to be scheduled for that night taking into account a wide range of system parameters and other factors .",
    "ps .  will eventually employ a dynamic telescope scheduler that takes into account hundreds of relevant factors . while the ps .",
    "telescope scheduler is being developed , for testing purposes the mops has adopted tao ( tools for automated observing , paulo holvorcem , http://pan-starrs.ifa.hawaii.edu/project/mops/tao/html/readme.html ) .",
    "tao is a macro - scheduler and as such it attempts to schedule all fields on a single night as efficiently as possible .",
    "there are far too many tao configuration parameters to discuss each in detail here .",
    "several important configuration parameters are :    * * number of images of each target * = 2 * * sky - plane location * + preferring low air mass due to poorer seeing , higher extinction and increased sky background at lower elevations .. * * field priority * * * intra - night cadence requirements * + 15min between visits to the same field on each night .",
    "the standard time between exposures on the same night is known as a transient time interval or tti .",
    "there is a 50% tolerance on the actual scheduling . *",
    "* inter - night cadence requirements * + no less than 3 nights between visits in a lunation . *",
    "* exposure time * = 30sec * * read out time * = 5sec * * telescope slew rate * = 5@xmath26/sec * * time of night * = 5@xmath26/sec * * azimuthally dependent altitude limits",
    "* = 20@xmath26 ( @xmath42.85 airmasses ) * * cloud cover * * * seeing conditions * * * moon avoidance angle at full moon * = 45@xmath26 ( scales with phase ) * * min / max sun altitude * = -15@xmath26 + intermediate between nautical and astronomical twilight .",
    "we ran the scheduler for ten years of synthetic surveying .",
    "the scheduling efficiency for the solar system fields is essentially 100% for those fields that are well above the minimum altitude ( some of the most southern opposition fields are always below the altitude limit and some of the sweet spot fields may also be unavailable at certain times of the year ) . due to ` weather '",
    "some of the regions were not covered 3 times in a lunation .",
    "figure [ fig.altaz ] shows the distribution of field locations in altitude vs. azimuth separately for the sweet spots and opposition regions over the ten year survey .",
    "the sweet spots are typically obtained between 20@xmath26 and 70@xmath26 altitude and @xmath41 @xmath42azimuth@xmath42 @xmath43 .",
    "the most likely altitude is near 40@xmath26 or about 1.7 airmasses . for the opposition regions",
    "note the predominance of fields scheduled near @xmath44 and close to @xmath45 - on or near the meridian when the fields are at their highest possible altitude ( lowest possible airmass ) .",
    "given the survey simulation (  [ s.surveysimulation ] ) we generate accurate n - body ephemerides and photometry for the synthetic solar system objects (  [ s.solarsystemmodel ] ) that appear in each field of view .",
    "the astrometric and photometric accuracy expected by ps .  is better than existing asteroid surveys . at @xmath8mag",
    "we expect astrometric error to be about 0.1  and a photometric error of about 0.35mag .",
    "for brighter objects these errors will be considerably smaller .",
    "the linking method described herein is independent of the detection s apparent magnitude except for the requirement that the detection be above the limiting magnitude of the system ( to simulate the expected sky - plane density of asteroids ) .",
    "however , in the interest of completeness , and since modern orbit determination software can utilize an estimate of the @xmath46 , we generate a pseudo - realistic magnitude and @xmath46 for synthetic detections .    the signal from a source of total apparent magnitude @xmath47 in an exposure of time @xmath48 seconds and assuming psf fitting photometry is @xmath49 . assuming that the exposure is sky - background limited , the variance from the sky is given by @xmath50 where @xmath51 is the fwhm of the psf in arc seconds and @xmath52 is the sky brightness in magnitudes per square arcsecond .",
    "the signal - to - noise ( @xmath46 ) at magnitude @xmath47 is than given by @xmath53 \\biggl [ { fwhm \\over 1\\arcsec } \\biggr]^{-2 } } \\ ] ] where @xmath54 1 for ps1 and 2 for ps .  while @xmath55 ( @xmath445.6 for a @xmath56 filter in these simulations ) .",
    "all the simulations described herein involve the more difficult problem of linking ps .  rather than ps1 detections .",
    "the astrometric error is assumed to be a symmetric 2-d gaussian with width given by : @xmath57     \\bigg [ { 5 \\over s / n } \\bigg]\\ ] ] in median seeing ( with ota correction in operation ) and at @xmath58mag we eventually expect an absolute astrometric accuracy of @xmath59 with a minimum of about 0.01@xmath60 for bright , unsaturated detections .    in order to automatically identify as many objects as possible the mops will have to work in the presence of a substantial number of false detections .",
    "@xcite estimates that at 5-@xmath61 there will be roughly 250 false detections / deg@xmath5 - roughly the _ maximum _ number of actual objects in the same area . to simulate the presence of false detections in each image we generated random locations in each field for each detection with a number density per deg@xmath5 given by : @xmath62\\ ] ]    most of the populations of objects in this work (  [ s.solarsystemmodel ] ) are moving slowly when detected in the opposition and sweet spot regions but the neos may be moving fast enough to leave small trails on the images .",
    "we simulate this effect by determining each object s rate and direction of motion and using this information to determine the length and position angle of the synthetic trail .",
    "it is important to note some of the effects that we are not taking into account in this simulation .",
    "we believe that these effects are not important in quantifying the efficiency of linking intra- and inter - night detections . by definition , an algorithm can only be efficient at linking those detections that were identified .",
    "so this simulation implements a hard cutoff at @xmath63mag with 100% detection efficiency to that magnitude limit .",
    "we do not account for the camera ccd fill factor of @xmath486% , the fact that almost 5% of ota ` cells ' on each camera will be used for image guiding and lost to detecting moving objects , or a pre - processing step implemented by air force space surveillance that will remove a few percent of image pixels .",
    "the fraction of pixels removed in the last step will be a function of the time of night and sky - plane location since more satellites will be visible towards sunset and sunrise than at midnight .",
    "we also do not account for astrometric and photometric effects as a function of air mass .",
    "_ e.g. _  reduced astrometric and photometric accuracy .",
    "figure [ fig.field.detections ] shows a single field of synthetic ps",
    ".  detections .",
    "the preceding sections have outlined the input to the mops - a set of transient detections of which a large fraction are false .",
    "it is the mops s responsibility to identify those detections corresponding to observations of real objects .",
    "the first step in this process is identifying sets of detections that are nearby to each other spatially and temporally and for which the distance between sequential detections is consistent with an object moving at fixed speed .",
    "we call these sets of detections ` tracklets ' .",
    "the second step is to link tracklets together on multiple nights into ` tracks ' .",
    "the brute force approach to each of these steps would lead to prohibitively cpu - intensive processing .",
    "instead , we have developed new techniques using kd - trees to handle both these problems . in the following three sub - sections we introduce the concept of kd - trees and explain how those data structures were applied to the mops requirements for intra- and inter - night linking of detections .",
    "kd - trees are hierarchical data structures that can be used to efficiently answer a variety of spatial queries @xcite . a kd - tree recursively partitions both the set of data points and the corresponding space into progressively finer subsets and subregions .",
    "each node in the tree represents a region of the entire space and ( either explicitly or implicitly ) a set of data points .",
    "a kd - tree is created in a top - down fashion as shown in figure  [ fig : kdbuild ] . at each level",
    "the current data is used to calculate a bounding box for that node .",
    "these bounds are saved and stored at that node .",
    "the data points are then partitioned into two disjoint sets by splitting the data at the midpoint of the node s widest dimension .",
    "each of these two sets is then used to recursively create _ children _ nodes .",
    "we halt this process when the current node owns fewer than a pre - established minimum number of points and mark this node a _",
    "leaf node_. by the hierarchal structure of the tree , the set of data points owned by a non - leaf node is the union of its childrens data points .",
    "thus we only need to explicitly store pointers to the individual data points at the leaf nodes .",
    "the hierarchical structure of the tree - based data structures can make spatial queries very efficient .",
    "consider the _ range search _ query shown in figure  [ fig : kdrangesearch ] , where the goal is to find all points that fall within some radius @xmath56 of a given query point @xmath64 .",
    "we simply descend the tree in a depth first search and look for data points within @xmath56 of @xmath64 .",
    "if we reach a leaf node , we explicitly test the points owned by that node to determine if their distance from @xmath64 is less than @xmath56 .",
    "if so , we add them to our list of results .",
    "however , we can exploit the spatial structure to stop exploring a branch of the tree if we find that no point contained in that branch could fall within our search radius .",
    "for example , in figure  [ fig : kdtree]c we can prune the sub - tree at node 8 because the entire node falls outside of our search radius .",
    "thus , we do not have to explore any of node 8 s children or test their associated points .",
    "the ability to prune unfeasible regions of the search space provides significant computational savings .",
    "we can extend the spatial query described above to look for simple intra - night associations by incorporating the temporal aspect of the data into the search . specifically , we do this using a form of sequential track initiation .",
    "( for a good introduction see * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "we start with an initial trajectory estimate for the tracklet at some time step and sequentially consider the subsequent time steps , looking for later detections to confirm , extend , and refine the tracklet . in the case of intra - night linkages",
    ", we are starting from individual point detections and thus an incomplete estimate of the tracklet .",
    "formally , we consider each individual detection as the start of a potential tracklet and look for detections at subsequent time steps to confirm and estimate the tracklet .",
    "we can limit the valid initial pairings by placing a reasonable restriction on velocities based on our estimate of _ a priori _ velocity distributions or trailing information .",
    "for each valid match",
    "we use the pair of detections to define the tracklet and then search later time steps for other consistent detections .",
    "this allows us to confirm the tracklet and effectively find all detections that belong to a given tracklet .",
    "the sequential intra - night linkage algorithm is given in figure  [ fig : sequentialalg ] .    in order to perform the linking efficiently in large scale domains",
    ", we employ the kd - tree with both spatial and temporal structure in the search .",
    "as shown in figure  [ fig : movingobjrange]a , we can do this by constructing a single 3-dimensional kd - tree on all of the points by including time as a dimension . given this tree we can then efficiently search for both the first pairing and the later confirming detections , by extracting only those detections that are reachable given our query point and velocity bounds .",
    "as shown in figure  [ fig : movingobjrange]b , this query effectively searches a cone projecting out from the query point @xmath64 .",
    "the algorithm for finding the feasible points , shown in figure  [ fig : movingobjsearchalg ] , is a range search centered on @xmath64 s position . unlike the standard kd - tree range search",
    ", we define the range with respect to the current node s time bounds [ @xmath65 , @xmath66 and the overall velocity bounds [ @xmath67 , @xmath68 .",
    "we can prune the search if no point in the current node is reachable from @xmath64 given the velocity bounds .    given a query point @xmath64 at time @xmath69 such that @xmath70 , we can prune if : @xmath71 or @xmath72 where @xmath73 represents the distance between the points @xmath74 and @xmath75 .",
    "an analogous pruning rule applies for cases where @xmath76 . in the above tests",
    ", @xmath77 does not have to be an actual data point .",
    "rather @xmath77 can be any point within the node s bounding box .",
    "we also incorporate trailing information , if available , into the algorithm both to limit the search for associations and to filter the proposed tracklets .",
    "first , we use information about the length of the detection and the exposure time to estimate the object s angular velocity . this estimate , along with its associated error , is used to define the object s minimum and maximum possible velocity , allowing us to adapt the search to each individual detection .",
    "second , we use the trail s orientation ( and its associated error ) to filter the proposed tracklets by requiring that all detections in the tracklet have similar orientations . when the length of a trail is sufficiently small the trail s length and angle become unreliable and the trail is ignored ; i.e. the trail is treated as a point - source detection .",
    "the intra - night linking algorithm described here did not use photometric information when creating tracklets .",
    "this is due to the fact that the vast majority of all detections will be close to the system s limiting magnitude and therefore in a photometric regime where large statistical errors are present . the constraints offered by checking the photometry are weak and , we will show below , our simulations suggest that it is unnecessary - we obtain high efficiency and sufficient accuracy to allow the system to operate well without taking photometry into account",
    ". it will be trivial to implement a constraint on consistent photometry between detections if we find it necessary to do so after further study .",
    "the primary benefit of spatial data structures is the ability to prune and thus ignore regions that are `` obviously '' infeasible given our query .",
    "we can extend this notion to finding associations , and thus new tracklets or tracks , by explicitly searching for entire sets of points that are mutually compatible @xcite .",
    "the primary benefit of searching for entire sets of points is that we can often avoid many early dead - ends that may result from trying to establish the first few associations in a track .",
    "specifically , many pairs of tracklets may look like promising matches , but be left unconfirmed by later supporting detections .",
    "in fact , the problem of many good initial pairings becomes significantly worse as the gap in time between observations of the same object increases .",
    "this process can be summarized as : given two or more regions ( bounding both position and possibly velocity ) at different times is there a track that can pass through them ?",
    "if so , are there other points that would confirm this track ?",
    "we can identify potential tracks by searching over all sets of tracklets that _",
    "could _ define the track . in the case of inter - night linking with quadratic tracks ( in motion in both right ascension and declination ) we can search over all pairs of tracklets that could be used to define a quadratic and then check for additional supporting tracklets to confirm these proposed tracks .",
    "the benefit of such an approach is that we can quickly search the models defined by the data and efficiently test whether these models are supported .",
    "again , we can do this search efficiently by using spatial data structures such as kd - trees .",
    "in order to efficiently search over all sets of points or tracklets that could define a valid model , we want to be able to use spatial structure from all the points , including those at different time steps . we can do this by building _ multiple _",
    "kd - trees over detections ( one for each time step ) and searching combinations of tree nodes . at each level of the search ,",
    "our current search state consists of a _ set _ of tree nodes that define areas in which the track could be at those time steps .",
    "thus we are effectively saying : `` one of the points in the set could be owned by the first tree node , another could be owned by the second tree node , etc . ''",
    "as the search descends , each of the nodes bounding boxes shrink , limiting the areas in which the track could occur and thus zeroing in on track positions at each time . at the limit",
    ", the search reaches a set of individual detections ( from different time steps ) that are all mutually compatible with a single track .",
    "we can also use the same approach for linking tracklets by treating the tracklet s velocity as two additional dimensions .",
    "for example , in the simple linear case the model is defined by only 2 points , thus we can efficiently search through all possible models using 2 _ model _ nodes to represent the current search state . at each stage in the search we are effectively considering all possible models that could be formed with a point in each of our two tree nodes .",
    "in addition , as shown in figure  [ fig : pointlist ] , the spatial bounds of our current model nodes immediately limit the set of feasible support points for _ all _ line segments compatible with these nodes .",
    "thus it may be possible to track which support points are feasible and use this information to prune the search due to a lack of support for _ any _ model defined by the points in those nodes .",
    "the variable - tree algorithm works by searching over all sets of points that could define a model while tracking which points could support the current set of models . as described above",
    ", the algorithm uses a multiple tree search over model defining points to close in on valid models .",
    "in addition , throughout the search we track which points could support our current set of models using an adaptive , dynamic representation of the points in the support space .    the key idea behind",
    "the variable - tree search is that we can use a _ dynamic _ representation of the potential support .",
    "specifically , we can place the support points in trees and maintain a dynamic _ list _ of currently valid support nodes .",
    "as shown in figure  [ fig : nodelist ] , by only testing entire nodes ( instead of individual points ) , we are using spatial coherence of the support points to remove the expense of testing each support point at each step in the search . and",
    "by maintaining a list of support tree nodes , we are no longer branching the search over these trees .",
    "thus we remove the need to make a hard `` left or right '' decision .",
    "further , using a combination of a list and a tree for our representation allows us to refine our support representation on the fly .",
    "if we reach a point in the search where a support node is no longer valid , we can simply drop it off the list . and",
    "if we reach a point where a support node provides too coarse a representation of the current support space , we can simply remove it and add both of its children to the list .",
    "the primary advantage of this search approach is that it allows us to use structure from all aspects of the problem .",
    "we are able to test entire sets of supporting points against entire sets of models , removing the need to test a huge number of individual combinations .",
    "however , we still maintain the ability to use the information provided by the support points , pruning the search if a model is not supported by a sufficient number of additional detections .",
    "further , by adaptively changing our representation , we can balance the testing cost and the pruning power of the search .",
    "the full variable - tree algorithm is given in figure  [ fig : multtreealg ] .",
    "a simple example of finding _ linear _ tracks while using the track s endpoints ( earliest and latest in time ) as model points and using all other points for support is illustrated in figure  [ fig : vtreesearch ] .",
    "the first column shows all the tree nodes that are currently part of the search .",
    "the second and third columns show the search s position on the two model trees and the current set of valid support nodes respectively .",
    "again , it is important to note that by testing the support points as we search , we are both incorporating support information into the pruning decisions and `` pruning '' the support points for entire sets of models at once .    in the case of linking tracklets",
    "we are also interested in using bounds on the tracklet s velocity .",
    "the algorithm does this by treating the tracklets as 5-dimensional points with two angular positions , two angular velocities , and a time .",
    "these dimensions are used in constructing and pruning the kd - trees but otherwise do not affect the algorithm .",
    "our mops implementation strategy has been to quickly develop a prototype system framework for testing purposes that roughly implements all features of a fully functional system .",
    "once the prototype was developed we could examine the efficiency of each mops subsystem and identify bottlenecks in the processing of moving object detections .",
    "the algorithms described in  [ ss.intranightlinking ] and  [ ss.internightlinking ] for tracklet and track creation have been implemented and tested on many synthetic models and some real asteroid survey data .",
    "the tracklet identification algorithm is known as ` findtracklets ` .",
    "it is called after all fields have been acquired on a night and operates on all detections from the difference images ( _ i.e. _  after static - sky subtraction ) .",
    "it might be argued that ` findtracklets ` should be invoked for each pair of images separated by a transient time interval ( tti ) but this would create separate tracklets for detections of objects in the overlapping areas of adjacent fields .    as described above , ` findtracklets ` accumulates detections from a single night into tracklets consistent with linear motion through the night .",
    "it is a ` greedy ' algorithm in that it always tries to group the maximum number of detections into a tracklet consistent with the limits on motion and astrometric position . in practice",
    ", we have found that we need to limit the algorithm to accumulating detections into tracklets to those that are separated by less than a critical threshold time set to a few times the tti typical of the re - visit time for a field on a single night ( we are using a one hour limit for the formation of tracklets at the moment ) .",
    "the upper limit to the time difference between the detections in a tracklet means that ` intra - night ' linking does not necessarily link together all available observations of an object within a single night .",
    "this situation might occur , for instance , for an object that appears in a part of the image that overlaps with an adjacent field that , for one reason or another , is not acquired within the hour after the first field is imaged . in this case",
    "our system would generate two separate tracklets for the night .    as the sky - plane density of real and false detections increases",
    "we expect that both the efficiency ( percentage of synthetic tracklets identified ) and accuracy ( percentage of identified tracklets that are synthetic ) will decrease .",
    "we have found that the performance of the standard ` findtracklets ` algorithm is so close to 100% under all circumstances and for all types of synthetic solar system objects that it makes no sense to discuss the results other than gross totals .",
    "the standard algorithm implements the option described at the end of  [ ss.intranightlinking ] of using trailing information for each detection in order to prune the number of feasible intra - night links .",
    "table [ tab.standardtrackletperformance ] shows the results we have achieved in both the opposition and sweet spot regions .",
    "the efficiency could be increased to 100% by extending the search radius for linking detections but this comes at the cost of decreasing the linking accuracy and increasing the fraction of discordant , mixed and spurious tracklets ( see the table [ tab.standardtrackletperformance ] caption for the definition of these terms ) .",
    "the final choice of all ` findtracklets ` parameters will be made when the entire mops is fully functional .",
    "the values will be set in order to optimize the overall system rather than the efficiency of accuracy of the intra - night linking .",
    "i.e. it may appear advantageous to achieve very high operational efficiency for tracklet formation but it is not clear how the corresponding decreased accuracy and increase in false tracklets will affect the track formation process ( described in  [ ss.trackidentification ] ) .",
    "of course , under realistic operating conditions the realized intra - night linking efficiency will be limited by the fill factor and other operational constraints .    the modest decrease in accuracy and",
    "increase in discordant , mixed and spurious tracklets in the sweet - spots is due to the increase in the mean speed of objects at small solar elongations .",
    "since they move faster , the search radius for intra - night linking needs to be increased and this has the side effect of increasing the false tracklet rate .    note that the total number of tracklets available in a lunation is in excess of 1.3 million corresponding to almost 450,000 different objects .",
    "thus , in a single lunation ps .  may identify and obtain orbits and colors for more solar system objects than are currently known .",
    "the ps1 proto - type system with only a single telescope will not perform as well but will still identify on the order of as many objects as are currently known in a single lunation .",
    "table [ tab.nonstandardtrackletperformance ] shows the effect of not using each detection s trailing information when performing ` findtracklets ` ( see  [ ss.intranightlinking ] for a brief discussion of the use of trailing information when creating tracklets ) .",
    "as expected , the efficiency can remain high only at the expense of realizing one - third the accuracy and nearly an order of magnitude more false tracklets .      the algorithm for inter - night linking of tracklets",
    "is called ` linktracklets ` .",
    "once a night of detections has been processed by ` findtracklets ` (  [ ss.trackletidentification ] ) blocks of ( usually contiguous ) images in the same region of sky are grouped together for processing by ` linktracklets ` in a ` pass ' ( see table [ tab.trackidentificationperformance ] ) .",
    "a database query identifies all other tracklets obtained in the surrounding area ( increasing sky - plane distance with time ) within the last 14 days and if there are three available nights for linking within that time frame then ` linktracklets ` attempts to link those tracklets together .",
    "the number of images that may be grouped together depends on the density of tracklets and the length of time over which inter - night linking is attempted . in general",
    ", we find that beyond the 14 day limit the linking algorithm becomes inefficient and inaccurate . traversing",
    "a large gap in time to look for linkages is prohibitive because there are too many potential linkages that satisfy the requirement of quadratic motion and too many real objects are non - quadratic over the same time period and will not be identified .",
    "we limit the range of acceptable speeds from 0.0@xmath26/day to 10.0@xmath26/day where the lower limit allows us to detect extremely slow moving distant objects and the upper limit is set by our funding agency .",
    "the maximum acceleration was set to 0.02@xmath26/day@xmath5 in both ra and declination .",
    "note that the term ` inter - night ' linking is strictly not correct due to the time limit on the spacing of intra - night tracklets as described in  [ ss.trackletidentification ] .",
    "inter - night linking actually links together all tracklets between _ and _ within nights when available .",
    "table [ tab.trackidentificationperformance ] gives various performance statistics for the ` linktracklets ` algorithm . to test the performance as a function of the sky - plane density of objects we generated four different models as described in the table caption .",
    "the realized sky - plane density of synthetic objects in the field varies over two orders of magnitude while the tracks that were available for linking ranged over more than three orders . in each case",
    "the false detections were kept at the expected density of 250 @xmath78 for ps .",
    "operations .",
    "inter - night linking efficiency decreases slowly with the realized sky - plane density of synthetic tracks as shown in table [ tab.trackidentificationperformance ] . even at densities expected for the full four telescope pan - starrs system with a limiting magnitude of @xmath10mag",
    "the track creation efficiency is currently above 98% .    of more concern",
    "is the effect of sky - plane density on the accuracy of track creation - the fraction of synthetic tracks compared to all identified tracks .",
    "when there are no false detections the accuracy of track creation is nearly 100% because even with a full density solar system model ( for ps .",
    "-4 ) the sky - plane density of tracklets is low enough to make confusion unimportant .",
    "since the next step in the mops after track creation is to attempt an initial orbit determination ( iod ) on each identified track , the accuracy needs to be high in order to not waste too many cpu cycles on attempting orbits on tracks that are not valid .",
    "however , calculating an iod for tracks is trivially parallelizable .",
    "note that the accuracy increases in table [ tab.trackidentificationperformance ] in the first three steps of increasing asteroid sky - plane density but drops precipitously on the last jump .",
    "this is due to the fact that we used a constant false detection rate equal to the expected density of false detections in all four simulations .",
    "thus , in the first three runs the noise is dominated by the false detections but in the last run the density of synthetic detections becomes high enough to add extra confusion into the linking process .    at this point",
    "we have not put much effort into increasing the accuracy of the ` linktracklets ` algorithm but there are many opportunities to do so .",
    "one such possibility is a multiple pass scenario in which we first attempt to link the ` easy ' tracklets ( _ i.e. _  everything from the main belt outwards ) with relatively tight constraints on their night - to - night motion , remove the tracklets that survive orbit determination in good tracks , and then loosen the constraints in order to identify difficult objects ( neos ) .",
    "we tested this technique on a simulation involving over 22,000 tracklets in over 352,000 tracks . removing",
    "the properly linked tracklets , and all false tracks containing any of those tracklets , left only about 6,700 tracks .",
    "thus , this could be a powerful technique for increasing the effectiveness of the inter - night linking process .",
    "the decrease in accuracy of ` linktracklets ` at full density is accompanied by a dramatic increase in the run time .",
    "increasing the sky - plane density by a factor of about six increases the runtime by a factor of almost thirty .",
    "this is also not of particular concern because the linking algorithm is easily parallelizable .",
    "the parallelization of ` linktracklets ` is easily implemented by running each ` pass ' ( described above ) on a different processor . the sky - plane density of tracklets becomes high enough in the final simulation of table [ tab.trackidentificationperformance ] to require tripling the number of passes .",
    "tables [ tab.ssm250tracks ] through [ tab.ssmtracks ] show the progression of linking efficiency as a function of both the sky - plane density and the solar system object type .",
    "the efficiency is high for all classes of objects and for all densities as would be expected after table [ tab.trackidentificationperformance ] .",
    "there is a very slight decrease in linking efficiency for each object class as their sky - plane density increases . within each model",
    "( each table ) there is a slight increase in linking efficiency with increasing mean heliocentric distance of the object class .",
    "the high efficiency for neos and distant objects should not be surprising . while their sky - plane density is low compared to the mb objects ,",
    "their rates of motion are often anomalous .",
    "even though the distant objects do not move very far in a transient time interval and therefore provide little motion vector information , the sky - plane density of slow moving objects is low enough to make the linking efficiency very high .    in  [ s.surveysimulation ]",
    "it was pointed out that the survey pattern avoids the stationary spots and thus it must be remembered that the results quoted herein do not provide results for all - sky inter - night linking efficiency .",
    "the intra - night linking efficiency should be much better in the stationary spots because the detections will be much closer together than at other points along the objects orbits .",
    "however , it is reasonable to expect that the inter - night linking efficiency will decrease in the stationary spots due to the unusual apparent acceleration of the objects in this region .",
    "as mentioned earlier in this section , the mops has restricted its requirements to linking only those objects with tracklets on three nights within a lunation .",
    "the more difficult problem of linking and confirming just two nights of tracklets in one lunation or linking three tracklets across two lunations is not handled with the algorithms described here . to extend the discovery phase space into this realm we have teamed with andrea milani who will provide us software capable of making these links .",
    "the theoretical framework for his work has been described elsewhere @xcite and the realized efficiencies in pan - starrs simulations will be discussed in a future paper .",
    "contemporary wide - field asteroid surveys only perform the intra - night linking step .",
    "they identify asteroids by their linear motion in a single night on three or more images . the intra - night",
    "linking efficiency has been measured by some of the major neo surveys by attempting to identify known asteroids in their fields . the measured peak efficiency for asteroids well above",
    "the limiting magnitude varies from about 65% ( spacewatch ; @xcite ) , @xmath79% ( catalina sky survey , observatory 703 ; beshore personal communication ) , @xmath80% ( catalina sky survey , observatory g96 ; beshore personal communication ) , and about 90% for the latest and reprocessed spacewatch data @xcite . in both",
    "these survey s the intra - night linkings proposed by their algorithms are checked by a human observer .",
    "this is clearly an impossible task at the pan - starrs discovery rate .",
    "some of the targeted ( pencil - beam or narrow field ) surveys have determined their intra - night detection efficiency by injecting synthetic asteroid images directly into the images before running their source detection and linking algorithms ( _ e.g. _   * ? ? ?",
    "* ; * ? ? ?",
    "they realize efficiencies of @xmath490% .",
    "inter - night linking is mostly performed by the minor planet center and there has been no report on their efficiency for this process .    to test the mops on real data before the onset of pan - starrs we have obtained raw source detection lists from the spacewatch @xcite asteroid survey .",
    "we have passed their data through the mops and have identified apparently realistic asteroids . in order to reduce the number of clearly false orbits identified by mops we needed to run two pre - filters on the set of detections they provide .",
    "the first eliminates regions on the sky with unusual over - densities of detections .",
    "the over - densities are a problem in the spacewatch automated reduction process due to mis - estimating the background level .",
    "the second pre - filter reduces the prevalence of anomalous sets of detections in linear features . the spacewatch source finding algorithm identifies many false detections in the linear features associated with bright star diffraction spikes , ccd edge effects and artifical satellite streaks .",
    "figure [ fig.spacewatch.e.vs.a ] shows the distribution of ` derived ' objects - those objects for which mops formed tracklets , tracks , initial orbit determination and differentially corrected orbits . since the figure shows final orbital elements for the derived objects it goes beyond the purview of merely intra and inter - night linking as discussed in the rest of this work .",
    "this is done for two reasons : 1 ) because most of the spacewatch detections are previously unknown objects it would be difficult for us to establish which tracklets and tracks were false and real and 2 ) to show that the mops is operational on real data .",
    "the system efficiency through initial and differential orbit determination will be described in a future paper .",
    "the pan - starrs project has developed the first integrated asteroid detection , intra and inter - night linking , attribution , precovery , orbit identification and orbit determination system in the world .",
    "it is known as the moving object processing system ( mops ) . for testing and monitoring purposes during operations",
    "we have developed a peudo - realistic simulation of the system including a realistic survey strategy incorporating simple weather factors , s / n - dependent astrometric noise and false detections at a sky - plane density expected for the four telescope pan - starrs system",
    ". the simulation does not include additional important factors such as the camera fill factor or probabilistic detections near the detection threshold .",
    "we have developed new algorithms based on kd - tree and variable - trees to link detections within and between nights that dramatically improve the speed of identification and that scale as @xmath81 where @xmath0 is the sky - plane density of objects .",
    "the implementation of the algorithms is trivially parallelizable on a set of cpu nodes .    using these algorithms",
    "we have demonstrated nearly 100% efficiency for intra - night linking of synthetic detections with realistic properties into ` tracklets ' .",
    "furthermore , we have demonstrated the ability to obtain nearly 100% efficiency for linking those tracklets over many nights into ` tracks ' .",
    "the accuracy of the algorithm , the fraction of identified tracks that are actually synthetic in the presence of noise , depends on and decreases with the sky - plane density of detections .",
    "tests of the mops intra and inter - night linking algorithms on real data provided by the spacewatch facility show that the system is capable of handling real data with all its inherent systematic problems that are otherwise not explored in our synthetic surveying model .",
    "the design and construction of the panoramic survey telescope and rapid response system by the university of hawaii institute for astronomy is funded by the united states air force research laboratory ( afrl , albuquerque , nm ) through grant number f29601 - 02 - 1 - 0268 .",
    "the mops is currently being developed in association with the large synoptic survey telescope ( lsst ) .",
    "jeremy kubica s work was funded in part by the lsst and by a grant from the fannie and john hertz foundation .",
    "the lsst s research and development effort is funded in part by the national science foundation under scientific program order no .",
    "9 ( ast-0551161 ) through cooperative agreement ast-0132798 . additional funding comes from private donations , in - kind support at department of energy laboratories and other lsstc institutional members .",
    "spacewatch ( robert mcmillan ) provided source detections for testing the mops procedures .",
    "paulo holvorcem provided timely assistance for creating synthetic surveys .",
    "bottke , w.  f. , morbidelli , a. , jedicke , r. , petit , j .-",
    "m . , levison , h.  f. , michel , p. , and metcalfe , t.  s.  2002 .",
    "debiased orbital and absolute magnitude distribution of the near - earth objects .",
    "icarus 156 , 399 - 433 .",
    "elliot , j.  l. , and 10 colleagues 2005 .",
    "the deep ecliptic survey : a search for kuiper belt objects and centaurs .",
    "ii . dynamical classification , the kuiper belt plane , and the core population.129 , 1117 - 1162 .",
    "kaiser ,  n.   2004 .  .",
    "the likelihood of point sources in pixellated images .",
    "pan - starrs internal document psdc-200 - 010 - 00 available upon request .",
    "kristensen , l.  k.  2004 .",
    "initial orbit determination for distant objects .",
    "127 , 2424 - 2435 .",
    "kubica ,  j. , moore ,  a. , connolly , r. , and jedicke ,  r.  2005 .  a multiple tree algorithm for the efficient association of asteroid observations .  the eleventh acm sigkdd international conference on knowledge discovery and data mining ( 2005 ) , acm press , eds . robert l. grossman and roberto bayardo and kristin bennett and jaideep vaidya , p. 138 - 146 .",
    "kubica ,  j. , masiero ,  j. , moore ,  a. , jedicke ,  r. , and connolly , r.2005 .",
    "variable kd - tree algorithms for spatial pattern search and discovery .",
    "advances in neural information processing systems , mit press , eds . y. weiss and b. schlkopf and j. platt , p. 691",
    "larsen , j.  a. , gleason , a.  e. , danzl , n.  m. , descour , a.  s. , mcmillan , r.  s. , gehrels , t. , jedicke , r. , montani , j.  l. , scotti , j.  v.  2001.the spacewatch wide - area survey for bright centaurs and trans - neptunian objects .",
    "astronomical journal 121 , 562 - 579 .",
    "milani , a. , gronchi , g.  f. , kneevic , z. , sansaturio , m.  e. , arratia , o. , denneau , l. , grav , t. , heasley , j. , jedicke , r. , kubica , j.  2006 .",
    "unbiased orbit determination for the next generation asteroid / comet surveys .",
    "iau symposium 229 , 367 - 380 .",
    "cccccccccccccc ssm/250 & 43445 & 0.4 & 680 & 679 & 99.9 & 94041 & 0.7 & 138.5 & 112 & 342 & 127 + mb/100 & 960758 & 8.8 & 7658 & 7644 & 99.8 & 138646 & 5.5 & 18.1 & 112 & 387 & 2483 + mb/10 & 1860758 & 17.1 & 21828 & 21766 & 99.7 & 295529 & 7.4 & 13.6 & 112 & 465 & 4002 + ssm & 10860758 & 100.0 & 156693 & 154109 & 98.4 & 44814287 & 0.3 & 290.8 & 361 & 13642 & 796 +      crrr neo & 351 & 342 & 97.4% + mb & 1626 & 1624 & 99.9% + tro & 4425 & 4423 & 100.0% + cen & 99 & 99 & 100.0% + tno & 818 & 818 & 100.0% + tno & 307 & 307 & 100.0% + com & 32 & 31 & 96.9% + total & 7658 & 7644 & 99.8% +    crrr neo & 351 & 343 & 97.7% + mb & 15769 & 15723 & 99.7% + tro & 4465 & 4460 & 99.9% + cen & 106 & 105 & 99.1% + tro & 818 & 818 & 100.0% + tno & 287 & 286 & 99.7% + com & 32 & 31 & 96.9% + total & 21828 & 21766 & 99.7% +    crrr neo & 350 & 340 & 97.1% + mb & 151084 & 148526 & 98.3% + tro & 4161 & 4148 & 99.7% + cen & 99 & 99 & 100.0% + tro & 695 & 693 & 99.7% + tno & 275 & 274 & 99.6% + com & 29 & 29 & 100.0% + total & 156693 & 154109 & 98.4% +     symbols ) and false detections ( green @xmath9 symbols ) .",
    "the density of detections is about 250/deg@xmath5 on the ecliptic for each type .",
    "the final ps .",
    "field will be in the shape of square chessboard with the four corner spots removed . ]"
  ],
  "abstract_text": [
    "<S> the panoramic survey telescope and rapid response system ( pan - starrs ) under development at the university of hawaii s institute for astronomy is creating the first fully automated end - to - end moving object processing system ( mops ) in the world </S>",
    "<S> . it will be capable of identifying detections of moving objects in our solar system and linking those detections within and between nights , attributing those detections to known objects , calculating initial and differentially - corrected orbits for linked detections , precovering detections when they exist , and orbit identification . </S>",
    "<S> here we describe new kd - tree and variable - tree algorithms that allow fast , efficient , scalable linking of intra and inter - night detections . using a pseudo - realistic simulation of the pan - starrs survey strategy incorporating weather , astrometric accuracy and false detections </S>",
    "<S> we have achieved nearly 100% efficiency and accuracy for intra - night linking and nearly 100% efficiency for inter - night linking within a lunation . at realistic sky - plane densities for both real and false detections </S>",
    "<S> the intra - night linking of detections into ` tracks ' currently has an accuracy of 0.3% . </S>",
    "<S> successful tests of the mops on real source detections from the spacewatch asteroid survey indicate that the mops is capable of identifying asteroids in real data .    27 manuscript pages + 14 figures + 7 tables    keywords : : :    asteroids    * running head : + * efficient linking of asteroid detections + * editorial correspondence and proofs : + * robert jedicke + institute for astronomy + university of hawaii + honolulu , hi , 96822 </S>",
    "<S> +   + tel : 808.956.9841 + fax : 808.988.8972 + e - mail : jedicke@ifa.hawaii.edu </S>"
  ]
}