{
  "article_text": [
    "sum - product algorithm @xcite , also known as loopy belief propagation , which we will henceforth abbreviate as lbp , is a popular algorithm for approximate inference on graphical models .",
    "applications can be found in diverse areas such as error correcting codes ( iterative channel decoding algorithms for turbo codes and low density parity check codes @xcite ) , combinatorial optimization ( satisfiability problems such as 3-sat and graph coloring @xcite ) and computer vision ( stereo matching @xcite and image restoration @xcite ) .",
    "lbp can be regarded as the most elementary one in a family of related algorithms , consisting of double - loop algorithms @xcite , gbp @xcite , ep @xcite , ec @xcite , the max - product algorithm @xcite , the survey propagation algorithm @xcite and fractional bp @xcite .",
    "a good understanding of lbp may therefore be beneficial to understanding these other algorithms as well .    in practice , there are two major obstacles in the application of lbp to concrete problems : ( i ) if lbp converges , it is not clear whether the results are a good approximation of the exact marginals ; ( ii ) lbp does not always converge , and in these cases gives no approximations at all .",
    "these two issues might actually be interrelated : the `` folklore '' is that failure of lbp to converge often indicates low quality of the bethe approximation on which it is based .",
    "this would mean that if one has to `` force '' lbp to converge ( e.g.  by using damping or double - loop approaches ) , one may expect the results to be of low quality .",
    "although lbp is an old algorithm that has been reinvented in many fields , a thorough theoretical understanding of the two aforementioned issues and their relation is still lacking .",
    "significant progress has been made in recent years regarding the question under what conditions lbp converges ( e.g. @xcite , @xcite , @xcite ) ) .",
    "] , on the uniqueness of fixed points @xcite , and on the accuracy of the marginals @xcite , but the theoretical understanding is still incomplete . for the special case of a graphical model consisting of a single loop , it has been shown that convergence rate and accuracy are indeed related @xcite .    in this work",
    ", we study the question of convergence of lbp and derive new sufficient conditions for lbp to converge to a unique fixed point .",
    "our results are more general and in some cases stronger than previously known sufficient conditions .",
    "to introduce our notation , we give a short treatment of factorizing probability distributions , the corresponding visualizations called factor graphs , and the lbp algorithm on factor graphs . for an excellent , extensive treatment of these topics",
    "we refer the reader to @xcite .",
    "consider @xmath0 discrete random variables @xmath1 , for @xmath2 ; we write @xmath3 .",
    "we are interested in the class of probability measures on @xmath4 that can be written as a product of _ factors _ ( also called _ potentials _ ) : @xmath5 the factors @xmath6 are indexed by subsets of @xmath7 , i.e.  @xmath8 .",
    "if @xmath9 is the subset @xmath10 , we write @xmath11 .",
    "each factor @xmath6 is a positive function we will loosen this assumption and allow for factors containing zeros . ]",
    "@xmath13 is a normalizing constant ensuring that @xmath14 .",
    "the class of probability measures described by ( [ eq : probability_measure ] ) contains markov random fields as well as bayesian networks .",
    "we will use uppercase letters for indices of factors ( @xmath15 ) and lowercase letters for indices of variables ( @xmath16 ) .",
    "the _ factor graph _ that corresponds to the probability distribution ( [ eq : probability_measure ] ) is a bipartite graph with vertex set @xmath17 . in the factor graph",
    "( see also fig .",
    "[ fig : factor_graph ] ) , each _ variable node _",
    "@xmath18 is connected with all the factors @xmath19 that contain the variable , i.e.the neighbors of @xmath20 are the factor nodes @xmath21 .",
    "similarly , each _ factor node _",
    "@xmath19 is connected with all the variable nodes @xmath18 that it contains and we will simply denote the neighbors of @xmath22 by @xmath23 . for each variable node @xmath18",
    ", we define the set of its neighboring variable nodes by @xmath24 , i.e.  @xmath25 is the set of indices of those variables that interact directly with @xmath26 .",
    "loopy belief propagation is an algorithm that calculates approximations to the marginals @xmath27 and @xmath28 of the probability measure ( [ eq : probability_measure ] ) .",
    "the calculation is done by message - passing on the factor graph : each node passes messages to its neighbors .",
    "one usually discriminates between two types of messages : messages @xmath29 from factors to variables and messages @xmath30 from variables to factors ( where @xmath31 ) .",
    "both messages are positive functions on @xmath32 , or , equivalently , vectors in @xmath33 ( with positive components ) .",
    "the messages that are sent by a node depend on the incoming messages ; the new messages , designated by @xmath34 , are given in terms of the incoming messages by the following _ _ lbp update rules _ _ instead of @xmath35 for sets @xmath36 . ]",
    "@xmath37 usually , one normalizes the messages in the @xmath38-sense ( i.e.  such that @xmath39 ) .",
    "if all messages have converged to some fixed point @xmath40 , one calculates the approximate marginals or _ beliefs _ @xmath41 where the @xmath42 s and @xmath43 s are normalization constants , chosen such that the approximate marginals are normalized in @xmath38-sense .",
    "a fixed point always exists if all factors are strictly positive @xcite .",
    "however , the existence of a fixed point does not necessarily imply convergence towards the fixed point , and fixed points may be unstable .",
    "note that the beliefs are invariant under rescaling of the messages @xmath44 for positive constants @xmath45 , which shows that the precise way of normalization in ( [ eq : mevf_update ] ) and ( [ eq : mefv_update ] ) is irrelevant . for numerical stability",
    "however , some way of normalization ( not necessarily in @xmath38-sense ) is desired to ensure that the messages stay in some compact domain .",
    "( -2.0,-2.0)(4.7,2.0 ) ( -1.8,-1.8)(-1.2,-1.2 ) ( -1.5,-1.6)@xmath46 ( -1.8,1.8)(-1.2,1.2 ) ( -1.5,1.4)@xmath47 ( -1.2,-1.2)(-0.21,-0.21 ) ( -1.2,-0.75)@xmath48 ( -1.2,1.2)(-0.21,0.21 ) ( -1.4,0.5)@xmath49 ( 0.0,0)0.3 ( 0.0,-0.1)@xmath50 ( 0.3,0.0)(1.8,0.0 ) ( 1.0,0.2)@xmath51 ( 1.8,0.3)(2.4,-0.3 ) ( 2.1,-0.1)@xmath22 ( 2.4,0.0)(3.9,0.0 ) ( 3.1,0.2)@xmath52 ( 4.2,0.0)0.3 ( 4.2,-0.1)@xmath20 ( 2.1,-1.5)0.3 ( 2.1,-1.6)@xmath53 ( 2.1,-0.3)(2.1,-1.2 ) ( 2.2,-0.9)@xmath54 ( 2.1,1.5)0.3 ( 2.1,1.4)@xmath55 ( 2.1,0.3)(2.1,1.2 ) ( 2.2,0.8)@xmath56    in the following , we will formulate everything in terms of the messages @xmath29 from factors to variables ; the update equations are then obtained by substituting ( [ eq : mevf_update ] ) in ( [ eq : mefv_update ] ) : @xmath57 with @xmath58 such that @xmath59 .",
    "we consider here lbp with a _",
    "parallel _ update scheme , which means that all message updates ( [ eq : me_update ] ) are done in parallel .",
    "in this section we investigate the simple special case of binary variables ( i.e.  @xmath60 for all @xmath18 ) , and in addition we assume that all potentials consist of at most two variables ( `` pairwise interactions '' ) .",
    "although this is a special case of the more general theory to be presented later on , we start with this simple case because it illustrates most of the underlying ideas without getting involved with the additional technicalities of the general case .",
    "we will assume that all variables are @xmath61-valued , i.e.@xmath62 for all @xmath18 .",
    "we take the factor index set as @xmath63 with @xmath64 ( the `` local evidence '' ) and @xmath65 ( the `` pair - potentials '' ) .",
    "the probability measure ( [ eq : probability_measure ] ) can then be written as @xmath66 for some choice of the parameters @xmath67 ( `` couplings '' ) and @xmath68 ( `` local fields '' ) , with @xmath69 for @xmath70 and @xmath71 for @xmath72 .    note from ( [ eq : me_update ] ) that the messages sent from single - variable factors @xmath73 to variables are constant .",
    "thus the question whether messages converge can be decided by studying only the messages sent from pair - potentials @xmath74 to variables .",
    "we will thus ignore messages that are sent from single - variable factors .",
    "it turns out to be advantageous to use the following `` natural '' parameterization of the messages @xmath75 where @xmath76 is now interpreted as a message sent from variable @xmath20 to variable @xmath50 ( instead of a message sent from the factor @xmath77 to variable @xmath50 ) .",
    "note that in the pairwise case , the product over @xmath78 in ( [ eq : me_update ] ) becomes trivial .",
    "some additional elementary algebraic manipulations show that the lbp update equations ( [ eq : me_update ] ) become particularly simple in this parameterization and can be written as : @xmath79 where @xmath80 are the variables that interact with @xmath20 via a pair - potential .    defining the set of ordered pairs @xmath81 , we see that the parallel lbp update is a mapping @xmath82 ; ( [ eq : bme_update ] ) specifies the component @xmath83 in terms of the components of @xmath84 .",
    "our goal is now to derive sufficient conditions under which the mapping @xmath85 is a contraction . for this",
    "we need some elementary but powerful mathematical theorems .",
    "in this subsection we introduce some ( standard ) notation and remember the reader of some elementary but important properties of vector norms , matrix norms , contractions and the mean value theorem in arbitrary normed vector spaces , which are the main mathematical ingredients for our basic tool , lemma [ lemm : sc_general ] .",
    "the reader familiar with these topics can skip this subsection and proceed directly to lemma [ lemm : sc_general ] in section [ sec : basic_tool ] .",
    "let @xmath86 be a normed finite - dimensional real vector space .",
    "examples of norms that will be important later on are the @xmath38-norm on @xmath87 , defined by @xmath88 and the @xmath89-norm on @xmath87 , defined by @xmath90    a norm on a vector space @xmath91 induces a metric on @xmath91 by the definition @xmath92 .",
    "the resulting metric space is complete .. ]    let @xmath93 be a metric space .",
    "a mapping @xmath94 is called a _",
    "contraction with respect to @xmath95 _ if there exists @xmath96 such that @xmath97 in case @xmath95 is induced by a norm @xmath98 , we will call a contraction with respect to @xmath95 a @xmath98-contraction .",
    "if @xmath93 is complete , we can apply the following celebrated theorem , due to banach :    [ theo : contracting_mapping_principle ] let @xmath94 be a contraction of a complete metric space @xmath93 .",
    "then @xmath85 has a unique fixed point @xmath99 and for any @xmath100 , the sequence @xmath101 obtained by iterating @xmath85 converges to @xmath102 .",
    "the rate of convergence is at least linear , since @xmath103 for all @xmath100 .",
    "can be found in many textbooks on analysis .",
    "note that linear convergence means that the error decreases exponentially , indeed @xmath104 for some @xmath105 .",
    "let ( @xmath106 be a normed space .",
    "the norm induces a _ matrix norm _ ( also called _ operator norm _ ) on linear mappings @xmath107 , defined as follows : @xmath108 the @xmath38-norm on @xmath87 induces the following matrix norm : @xmath109 where @xmath110 with @xmath111 the @xmath112 canonical basis vector .",
    "the @xmath89-norm on @xmath87 induces the following matrix norm : @xmath113 in the following consequence of the well - known mean value theorem , the matrix norm of the derivative ( `` jacobian '' ) @xmath114 at @xmath115 of a differentiable mapping @xmath116 is used to bound the distance of the @xmath85-images of two vectors :    [ lemm : mean_value_coro ] let @xmath86 be a normed space and @xmath116 a differentiable mapping .",
    "then , for @xmath117 : @xmath118 } { \\,\\left\\vert { f'(z ) } \\right\\vert\\,}\\ ] ] where we wrote @xmath119 $ ] for the segment @xmath120\\}$ ] joining @xmath121 and @xmath122 .",
    "see ( * ? ? ?",
    "8.5.4 ) .",
    "combining theorem [ theo : contracting_mapping_principle ] and lemma [ lemm : mean_value_coro ] immediately yields our basic tool :    [ lemm : sc_general ] let @xmath86 be a normed space , @xmath116 differentiable and suppose that @xmath123 then @xmath85 is a @xmath98-contraction by lemma [ lemm : mean_value_coro ] .",
    "hence , for any @xmath115 , the sequence @xmath124 converges to a unique fixed point @xmath125 with a convergence rate that is at least linear by theorem [ theo : contracting_mapping_principle ] .",
    "we apply lemma [ lemm : sc_general ] to the case at hand : the parallel lbp update mapping @xmath126 , written out in components in ( [ eq : bme_update ] ) .",
    "different choices of the vector norm on @xmath127 will yield different sufficient conditions for whether iterating @xmath85 will converge to a unique fixed point .",
    "we will study two examples : the @xmath38 norm and the @xmath89 norm .",
    "the derivative of @xmath85 is easily calculated from ( [ eq : bme_update ] ) and is given by @xmath128 where , we define the indicator function @xmath129 of @xmath36 by @xmath130 if @xmath100 and @xmath131 if @xmath132 . ] @xmath133 note that we have absorbed all @xmath84-dependence in the factor @xmath134 ; the reason for this will become apparent later on .",
    "the factor @xmath135 is nonnegative and independent of @xmath84 and captures the structure of the graphical model .",
    "note that @xmath136 , implying that @xmath137 everywhere on @xmath138 .",
    "the @xmath89-norm on @xmath127 yields the following condition :    [ coro : sc_linfty_binary ] for binary variables with pairwise interactions : if @xmath139 lbp is an @xmath89-contraction and converges to a unique fixed point , irrespective of the initial messages .    using ( [ eq : linfty_mnorm ] ) , ( [ eq : bme_deriv_a ] ) and ( [ eq : bme_deriv_bound ] ) : @xmath140 and now simply apply lemma [ lemm : sc_general ] .      using the @xmath38-norm instead",
    ", we find :    [ coro : sc_l1_binary ] for binary variables with pairwise interactions : @xmath141 lbp is an @xmath38-contraction and converges to a unique fixed point , irrespective of the initial messages .",
    "similar to the proof of corollary [ coro : sc_linfty_binary ] , now using ( [ eq : l1_mnorm ] ) instead of ( [ eq : linfty_mnorm ] ) : @xmath142    it is easy to see that condition ( [ eq : sc_l1_binary ] ) is implied by ( [ eq : sc_linfty_binary ] ) , but not conversely ; thus in this case the @xmath38-norm yields a tighter bound than the @xmath89-norm .      instead of pursuing a search for the optimal norm , we will derive a criterion for convergence based on the spectral radius of the matrix ( [ eq : bme_deriv_a ] ) .",
    "the key idea is to look at several iterations of lbp at once .",
    "this will yield a significantly stronger condition for convergence of lbp to a unique fixed point .",
    "for a square matrix @xmath143 , we denote by @xmath144 its _ spectrum _ , i.e.the set of eigenvalues of @xmath143 . by @xmath145",
    "we denote its _ spectral radius _ , which is defined as @xmath146 , i.e.  the largest modulus of eigenvalues of @xmath143 . with the spectral _ norm _ @xmath147 of @xmath143 , the matrix norm induced by the @xmath148-norm . ]",
    "[ lemm : pow_contract_conv ] let @xmath94 be a mapping , @xmath95 a metric on @xmath36 and suppose that @xmath149 is a @xmath95-contraction for some @xmath150",
    ". then @xmath85 has a unique fixed point @xmath102 and for any @xmath100 , the sequence @xmath151 obtained by iterating @xmath85 converges to @xmath102 .",
    "take any @xmath100 .",
    "consider the @xmath152 sequences obtained by iterating @xmath149 , starting respectively in @xmath121 , @xmath153 , ",
    ", @xmath154 : @xmath155 each sequence converges to @xmath102 since @xmath149 is a @xmath95-contraction with fixed point @xmath102 .",
    "but then the sequence @xmath101 must converge to @xmath102 .",
    "[ theo : almost_jacobi_binary ] let @xmath156 be differentiable and suppose that @xmath157 , where @xmath143 has nonnegative entries and @xmath158 is diagonal with bounded entries @xmath159 .",
    "if @xmath160 then for any @xmath161 , the sequence @xmath162 obtained by iterating @xmath85 converges to a fixed point @xmath102 , which does not depend on @xmath121 .    for a matrix @xmath158 , we will denote by @xmath163 the matrix with entries @xmath164 . for two matrices",
    "@xmath165 we will write @xmath166 if @xmath167 for all entries @xmath168 .",
    "note that if @xmath169 , then @xmath170 .",
    "also note that @xmath171 . finally , if @xmath172 and @xmath166 , then @xmath173 and @xmath174 .    using these observations and the chain rule",
    ", we have for any @xmath175 and any @xmath161 : @xmath176 hence @xmath177 .    by the gelfand spectral radius theorem ,",
    "@xmath178 choose @xmath179 such that @xmath180 .",
    "for some @xmath152 , @xmath181 .",
    "hence for all @xmath161 , @xmath182 .",
    "applying lemma [ lemm : sc_general ] , we conclude that @xmath149 is a @xmath38-contraction .",
    "now apply lemma [ lemm : pow_contract_conv ] .",
    "using ( [ eq : bme_deriv ] ) , ( [ eq : bme_deriv_b ] ) and ( [ eq : bme_deriv_a ] ) , this immediately yields :    [ coro : sc_spectral_binary ] for binary variables with pairwise interactions , lbp converges to a unique fixed point , irrespective of the initial messages , if the spectral radius of the @xmath183-matrix @xmath184 is strictly smaller than 1 .",
    "the calculation of the spectral norm of the ( sparse ) matrix @xmath143 can be done using standard numerical techniques in linear algebra .",
    "any matrix norm of @xmath143 is actually an upper bound on the spectral radius @xmath145 , since for any eigenvalue @xmath185 of @xmath143 with eigenvector @xmath121 we have @xmath186 , hence @xmath187 .",
    "this implies that no norm in lemma [ lemm : sc_general ] will result in a sharper condition than corollary [ coro : sc_spectral_binary ] , hence the title of this section .",
    "further , for a given matrix @xmath143 and some @xmath188 , there exists a vector norm @xmath98 such that the induced matrix norm of @xmath143 satisfies @xmath189 ; see @xcite for a constructive proof .",
    "thus _ for given @xmath143 _ one can approximate @xmath145 arbitrarily close by induced matrix norms .",
    "this immediately gives a result on the convergence rate of lbp ( in case @xmath160 ) : for any @xmath188 , there exists a norm - induced metric such that the linear rate of contraction of lbp with respect to that metric is bounded from above by @xmath190 .",
    "one might think that there is a shorter proof of corollary [ coro : sc_spectral_binary ] : it seems quite plausible intuitively that in general , for a continuously differentiable @xmath156 , iterating @xmath85 will converge to a unique fixed point if @xmath191 .",
    "however , this conjecture ( which has been open for a long time ) has been shown to be true in two dimensions but false in higher dimensions @xcite .",
    "empirically , it is known that the presence of strong local fields ( i.e.  single variable factors which are far from uniform ) often improves the convergence of lbp",
    ". however , our results so far are completely independent of the parameters @xmath192 that measure the strength of the local evidence . by proceeding more carefully than we have done above , the results can easily be improved in such a way that local evidence is taken into account .",
    "consider the quantity @xmath193 defined in ( [ eq : bme_deriv_b ] ) .",
    "we have bounded this quantity by noting that @xmath136 .",
    "note that for all lbp updates ( except for the first one ) , the argument @xmath84 ( the incoming messages ) is in @xmath194 , which can be considerably smaller than the complete vector space @xmath138 .",
    "thus , after the first lbp update , we can use @xmath195 where we used ( [ eq : bme_update ] ) and defined the _ cavity field _",
    "@xmath196 the function @xmath197 is strictly decreasing for @xmath198 and symmetric around @xmath199 , thus , defining @xmath200 we obtain @xmath201    now , from ( [ eq : bme_update ] ) we derive that @xmath202 hence @xmath203 where we defined @xmath204 we conclude that @xmath205 is simply the distance between 0 and the interval @xmath206 , i.e.@xmath207 thus the element @xmath208 ( for @xmath209 ) of the matrix @xmath143 defined in corollary [ coro : sc_spectral_binary ] can be replaced by @xmath210 which is generally smaller than @xmath211 and thus gives a tighter bound .",
    "this trick can be repeated arbitrarily often : assume that lbp updates have been done already , which means that it suffices to take the supremum of @xmath212 over @xmath213 .",
    "define for all @xmath214 and all @xmath215 : @xmath216 and define the intervals @xmath217.\\ ] ] specifically , for @xmath218 we have @xmath219 and @xmath220 , which means that @xmath221 using ( [ eq : bme_update ] ) and ( [ eq : def_bcf ] ) , we obtain the following recursive relations for the intervals ( where we use interval arithmetic defined in the obvious way ) : @xmath222 using this recursion relation , one can calculate @xmath223 and define @xmath205 as the distance ( in absolute value ) of the interval @xmath223 to 0 : @xmath224 thus by replacing the matrix @xmath143 in corollary [ coro : sc_spectral_binary ] by @xmath225 we obtain stronger results that improve as @xmath226 increases :    [ coro : sc_spectral_improved_binary ] let @xmath227 . for binary variables with pairwise interactions",
    ", lbp converges to a unique fixed point , irrespective of the initial messages , if the spectral radius of the @xmath183-matrix defined in ( [ eq : bme_deriv_a_improved ] ) ( with @xmath205 defined in equations ( [ eq : bcfs])([eq : bcfs ] ) ) is strictly smaller than 1 .",
    "in the general case , when the domains @xmath32 are arbitrarily large ( but finite ) , we do not know of a natural parameterization of the messages that automatically takes care of the invariance of the messages @xmath228 under scaling ( like ( [ eq : def_bme ] ) does in the binary case ) . instead of handling the scale invariance by the parameterization and using standard norms and metrics",
    ", it seems easier to take a simple parameterization and to change the norms and metrics in such a way that they are insensitive to the ( irrelevant ) extra degrees of freedom arising from the scale invariance .",
    "this is actually the key insight in extending the previous results beyond the binary case : once one sees how to do this , the rest follows in a ( more or less ) straightforward way .",
    "another important point is to reparameterize the messages : a natural parameterization for our analysis is now in terms of logarithms of messages @xmath229 .",
    "the lbp update equations ( [ eq : me_update ] ) can be written in terms of the log - messages as : @xmath230 where we dropped the normalization and defined @xmath231    each log - message @xmath232 is a vector in the vector space @xmath233 ; we will use greek letters as indices for the components , e.g.  @xmath234 with @xmath235 .",
    "we will call everything that concerns individual vector spaces @xmath236 _ local _ and define the _ global _ vector space @xmath237 as the direct sum of the local vector spaces : @xmath238 the parallel lbp update is the mapping @xmath239 , written out in components in ( [ eq : lme_update ] ) and ( [ eq : def_cf ] ) .",
    "note that the invariance of the messages @xmath52 under scaling amounts to invariance of the log - messages @xmath232 under translation .",
    "more formally , defining linear subspaces @xmath240 and their direct sum @xmath241 the invariance amounts to the observation that @xmath242 since @xmath243 and @xmath244 are equivalent for our purposes , we want our measures of distance in @xmath237 to reflect this equivalence .",
    "therefore we will `` divide out '' the equivalence relation and work in the quotient space @xmath245 , which is the topic of the next subsection .",
    "let @xmath91 be a finite - dimensional vector space .",
    "let @xmath246 be a linear subspace of @xmath91 .",
    "we can consider the _ quotient space _ @xmath247 , where @xmath248 .",
    "defining addition and scalar multiplication on the quotient space in the natural way , the quotient space is again a vector space .",
    ", addition ( @xmath249 for @xmath250 ) and scalar multiplication ( @xmath251 for @xmath252 ) . ]",
    "we will denote its elements as @xmath253 .",
    "note that the projection @xmath254 is linear .",
    "let @xmath98 be any vector norm on @xmath91 .",
    "it induces a _ quotient norm _ on @xmath255 , defined by @xmath256 which is indeed a norm , as one easily checks .",
    "the quotient norm in turn induces the _ quotient metric _",
    "@xmath257 on @xmath255 .",
    "the metric space @xmath258 is complete ( since any finite - dimensional normed vector space is complete ) .",
    "let @xmath116 be a ( possibly non - linear ) mapping with the following symmetry : @xmath259 we can then unambiguously define the quotient mapping @xmath260 which yields the following commutative diagram : @xmath261    for a linear mapping @xmath107 , condition ( [ eq : f_symmetry ] ) amounts to @xmath262 , i.e.  @xmath143 should leave @xmath246 invariant ; we can then unambiguously define the quotient mapping @xmath263 .    if @xmath116 is differentiable and satisfies ( [ eq : f_symmetry ] ) , the symmetry property ( [ eq : f_symmetry ] )",
    "implies that @xmath264 , hence we can define @xmath265 .",
    "the operation of taking derivatives is compatible with projecting onto the quotient space .",
    "indeed , by using the chain rule and the identity @xmath266 , one finds that the derivative of the induced mapping @xmath267 at @xmath268 equals the induced derivative of @xmath85 at @xmath121 : @xmath269    by lemma [ lemm : sc_general ] , @xmath270 is a contraction with respect to the quotient norm if @xmath271 using ( [ eq : def_qnorm ] ) and ( [ eq : deriv_quo ] ) , this condition can be written more explicitly as : @xmath272      whereas in the binary case , each message @xmath273 was parameterized by a single real number , the messages are now @xmath274-dimensional vectors @xmath232 ( with components @xmath275 indexed by @xmath235 ) . in extending the @xmath38-norm",
    "that provided useful in the binary case to the more general case , we have the freedom to choose the `` local '' part of the generalized @xmath38-norm . here",
    "we show how to construct such a generalization of the @xmath38-norm and its properties ; for a more detailed account of the construction , see appendix [ app : quotients ] .",
    "the `` global '' vector space @xmath237 is the direct sum of the `` local '' subspaces @xmath236 .",
    "suppose that for each subspace @xmath236 , we have a local norm @xmath276 .",
    "a natural generalization of the @xmath38-norm in the binary case is the following global norm on @xmath237 : @xmath277 it is easy to check that this is indeed a norm on @xmath237 .",
    "each subspace @xmath236 has a 1-dimensional subspace @xmath278 defined in ( [ eq : def_lwl ] ) and the local norm on @xmath236 induces a local quotient norm on the quotient space @xmath279 . the global norm ( [ eq : logbp_l1_norm ] ) on @xmath237 induces a global quotient norm on @xmath245 , which is simply the sum of the local quotient norms ( c.f .",
    "( [ eq : gen_l1_qnorm ] ) ) : @xmath280    let @xmath281 . the derivative @xmath282 of @xmath239 at @xmath244 is a linear mapping @xmath283 satisfying @xmath284 .",
    "it projects down to a linear mapping @xmath285 .",
    "the matrix norm of @xmath286 induced by the quotient norm ( [ eq : logbp_l1_qnorm ] ) is given by ( c.f .",
    "( [ eq : gen_l1_qmnorm ] ) ) : @xmath287 where the local quotient matrix norm of the `` block '' @xmath288 is given by ( c.f .",
    "( [ eq : gen_l1_lmqnorm ] ) ) : @xmath289    the derivative of the ( unnormalized ) parallel lbp update ( [ eq : lme_update ] ) is easily calculated : @xmath290 to lighten the notation , we will use greek subscripts instead of arguments : let @xmath45 correspond to @xmath26 , @xmath291 to @xmath292 , @xmath293 to @xmath294 and @xmath295 to @xmath296 ; for example , we write @xmath297 as @xmath298 . taking the global quotient norm ( [ eq : logbp_l1_qmnorm ] ) of ( [ eq : me_deriv ] ) yields : @xmath299 where @xmath300 note that @xmath301 depends on @xmath244 via the dependence of @xmath302 on @xmath244 ( c.f .",
    "( [ eq : def_cf ] ) )",
    ". we will for the moment simplify matters by assuming that @xmath244 can be any vector in @xmath237 , and later discuss the more careful estimate ( where @xmath303 ) : @xmath304 defining the matrix @xmath143 by the expression on the r.h.s .  and",
    "using ( [ eq : logbp_l1_lmqnorm ] ) and ( [ eq : def_qnorm ] ) , we obtain : @xmath305 for @xmath306 and @xmath307 such that @xmath78 and @xmath308 .",
    "surprisingly , it turns out that we can calculate ( [ eq : me_deriv_a_expl ] ) analytically if we take all local norms to be @xmath89 norms .",
    "we have also tried the @xmath148 norm and the @xmath38 norm as local norms , but were unable to calculate expression ( [ eq : me_deriv_a_expl ] ) analytically in these cases .",
    "numerical calculations turned out to be difficult because of the nested suprema .",
    "take for all local norms @xmath276 the @xmath89 norm on @xmath309 .",
    "the local subspace @xmath278 is spanned by the vector @xmath310 .",
    "the local quotient norm of a vector @xmath311 is thus given by @xmath312 for a linear mapping @xmath313 that satisfies @xmath314 , the induced quotient matrix norm ( [ eq : logbp_l1_lmqnorm ] ) is given by @xmath315    fixing for the moment @xmath306 and @xmath307 ( such that @xmath316 and @xmath308 ) and dropping the superscripts from the notation , using ( [ eq : linfty_lmqnorm ] ) , we can write ( [ eq : me_deriv_a_expl ] ) as @xmath317 interchanging the two suprema , fixing ( for the moment ) @xmath45 and @xmath318 , defining @xmath319 and @xmath320 , noting that we can without loss of generality assume that @xmath321 is normalized in @xmath38 sense , the previous expression ( apart from the @xmath322 ) simplifies to @xmath323 in appendix [ app : sup_h ] we show that this equals @xmath324 we conclude that if we take all local norms to be the @xmath89 norms , then @xmath325 equals @xmath326 which is defined for @xmath327 with @xmath328 and where @xmath329 is shorthand for @xmath330 ; see fig .",
    "[ fig : pot_strength ] for an illustration .",
    "( -0.6,-2.6)(5,0.8 ) ( 0.0,0)0.3 ( 0.0,0.0)@xmath20 ( 0.0,0.5)@xmath331 ( 1.5,0.0)@xmath22 ( 1.5,0.5)@xmath6 ( 3.0,0.0)@xmath50 ( 3.0,0.5)@xmath332 ( 4.5,0.0)@xmath46 ( 1.5,-1.7)@xmath333 ( 2.7,-1.4)@xmath334 ( 0.3,0.0)(1.2,0.0 ) ( 0.6,0.0)(1.2,0.0 ) ( 1.2,0.3)(1.8,-0.3 ) ( 1.8,0.0)(2.7,0.0 ) ( 3.0,0.0)0.3 ( 4.2,0.3)(4.8,-0.3 ) ( 3.3,0.0)(4.2,0.0 ) ( 3.6,0.0)(4.2,0.0 ) ( 1.4,-0.3)(0.8,-1.2 ) ( 1.5,-0.3)(1.5,-1.2 ) ( 1.6,-0.3)(2.2,-1.2 ) ( 0.8,-1.5)0.3 ( 1.5,-1.5)0.3 ( 2.2,-1.5)0.3    now combining ( [ eq : me_deriv_qmnorm ] ) , ( [ eq : me_deriv_a ] ) and ( [ eq : pot_strength_linfty ] ) , we finally obtain : @xmath335 applying lemma [ lemm : sc_general ] now yields that @xmath270 is a contraction with respect to the quotient norm on @xmath336 if the right - hand side is strictly smaller than 1 .    consider the mapping @xmath337 that maps @xmath338 to the _ normalized _ @xmath281 , i.e.  such that @xmath339 for all components @xmath306 .",
    "if we take for @xmath85 the @xmath38-normalized lbp update ( in the log - domain ) , the following diagram commutes : @xmath340 since both @xmath341 and @xmath342 are continuous , we can translate convergence results for @xmath270 back to similar results for @xmath85 .",
    "we have proved :    [ theo : sc_l1_linfty ] if @xmath343 lbp converges to a unique fixed point irrespective of the initial messages .",
    "now we can also generalize corollary [ coro : sc_spectral_binary ] :    [ theo : sc_spectral_linfty ] if the spectral radius of the matrix @xmath344 is strictly smaller than 1 , lbp converges to a unique fixed point irrespective of the initial messages .",
    "similar to the binary pairwise case ; see theorem [ theo : almost_jacobi ] in appendix [ app : quotients ] for details .",
    "note that theorem [ theo : sc_l1_linfty ] is a trivial consequence of theorem [ theo : sc_spectral_linfty ] , since the @xmath38-norm is an upper bound on the spectral radius .",
    "however , to prove the latter , it seems that we have to go through all the work ( and some more ) needed to prove the former .      in this subsection",
    "we study the implications for two special cases , namely factor graphs that contain no cycles and the case of pairwise interactions .",
    "theorem [ theo : sc_spectral_linfty ] gives us a proof of the well - known fact that lbp converges on trees ( whereas theorem [ theo : sc_l1_linfty ] is not strong enough to prove that result ) :    [ coro : sc_tree ] if the factor graph is a tree , lbp converges to a unique fixed point irrespective of the initial messages .    the spectral radius of ( [ eq : sc_spectral_linfty ] ) is easily shown to be zero in this special case , for any choice of the potentials .",
    "we formulate theorems [ theo : sc_l1_linfty ] and [ theo : sc_spectral_linfty ] for the special case of pairwise interactions ( which corresponds to @xmath295 taking on only one value ) , i.e.  all factors consists of either one or two variables . for a pair - potential @xmath345 , expression ( [ eq : pot_strength_linfty ] )",
    "simplifies to ( see also fig .",
    "[ fig : pairwise ] ) @xmath346 note that this quantity is invariant to `` reallocation '' of single variable factors @xmath347 or @xmath348 to the pair factor @xmath349 ( i.e.  @xmath350 ) .",
    "@xmath351 can be regarded as a measure of the strength of the potential @xmath349 .",
    "( -0.5,-1.8)(5.5,0.7 ) ( 0.0,0)0.3 ( 0.0,0.0)@xmath352 ( 0.0,-1.5)@xmath352 ( 0.7,-1.5)@xmath353 ( 1.5,0.7)@xmath354 ( 1.5,0.0)@xmath355 ( 3.0,0.0)@xmath20 ( 3.0,-1.5)@xmath20 ( 3.7,-1.5)@xmath347 ( 4.5,0.7)@xmath349 ( 4.5,0.0)@xmath356 ( 6.0,0.0)@xmath50 ( 6.0,-1.5)@xmath50 ( 6.7,-1.5)@xmath348 ( 0.0,-0.3)(0.0,-1.2 ) ( -0.3,-1.2)(0.3,-1.8 ) ( 0.3,0.0)(1.2,0.0 ) ( 1.2,-0.3)(1.8,0.3 ) ( 1.8,0.0)(2.7,0.0 ) ( 1.8,0.0)(2.4,0.0 ) ( 3.0,0.0)0.3 ( 3.0,-0.3)(3.0,-1.2 ) ( 2.7,-1.2)(3.3,-1.8 ) ( 3.3,0.0)(4.2,0.0 ) ( 4.2,-0.3)(4.8,0.3 ) ( 4.8,0.0)(5.7,0.0 ) ( 4.8,0.0)(5.4,0.0 ) ( 6.0,0.0)0.3 ( 6.0,-0.3)(6.0,-1.2 ) ( 5.7,-1.2)(6.3,-1.8 )    the @xmath38-norm based condition ( [ eq : sc_l1_linfty ] ) can be written in the pairwise case as : @xmath357 the matrix defined in ( [ eq : sc_spectral_linfty ] ) , relevant for the spectral radius condition , can be replaced by the following @xmath183-matrix in the pairwise case : @xmath358    for the binary case , we reobtain our earlier results , since @xmath359 .      until now , we have assumed that all factors are strictly positive . in many interesting applications of the sum - product algorithm ,",
    "this assumption is violated : the factors may contain zeros .",
    "it is thus interesting to see if and how our results can be extended towards this more general case .",
    "the easiest way to extend the results is by assuming that  although the factors may contain zeros ",
    "the messages are guaranteed to remain strictly positive ( i.e.  the log - messages remain finite ) after each update .",
    "even more general extensions with milder conditions may exist , but we believe that considerably more work would be required to overcome the technical problems that arise due to messages containing zeros .",
    "assume that each factor @xmath6 is a nonnegative function @xmath360 .",
    "in addition , assume that all factors involving only a single variable are strictly positive .",
    "this can be assumed without loss of generality , since the single variable factors that contain one or more zeros can simply be absorbed into multi - variable factors involving the same variable .",
    "additionally , for each @xmath19 consisting of more than one variable , assume that @xmath361 these conditions guarantee that strictly positive messages remain strictly positive under the update equations ( [ eq : me_update ] ) , as one easily checks , implying that we can still use the logarithmic parameterization of the messages and that the derivative ( [ eq : me_deriv ] ) is still well - defined .",
    "the expression for the potential strength ( [ eq : pot_strength_linfty ] ) can be written in a way that is also well - defined if the potential @xmath6 contains zeros : @xmath362 which is defined for @xmath327 with @xmath328 and where @xmath329 is shorthand for @xmath330 .",
    "the immediate generalization of corollary [ theo : sc_spectral_linfty ] is then as follows :    [ theo : sc_spectral_linfty_zeros ] under the assumptions on the potentials described above ( strict positivity of single variable factors and ( [ eq : condition_factors_zeros ] ) for the other factors ) : if the spectral radius of the matrix @xmath363 ( with @xmath364 defined in ( [ eq : pot_strength_linfty_zeros ] ) ) is strictly smaller than 1 , lbp converges to a unique fixed point irrespective of the initial messages .",
    "similar to the strictly positive case .",
    "the only slight subtlety occurs in appendix [ app : sup_h ] where one has to take a limit of strictly positive factors converging to the desired nonnegative factor and use the continuity of the relevant expressions with respect to the factor entries to prove that the bound also holds in this limit .",
    "define , for @xmath365 , the ( `` ferromagnetic '' ) pair factor @xmath366 by the following matrix : @xmath367 now consider a binary pairwise factor graph , consisting of a single loop of @xmath152 binary variables , i.e.  the network topology is that of a circle .",
    "take for the @xmath368 pair interactions @xmath369",
    "( for @xmath370 ) the identity matrices ( i.e.  the above pair factors for @xmath371 ) and take for the remaining one @xmath372 for some @xmath365 .",
    "note that the potential strength @xmath373 converges to 1 as @xmath374 .",
    "the spectral radius of the corresponding matrix @xmath325 can be shown to be equal to @xmath375 which is strictly smaller than 1 if and only if @xmath188 .",
    "hence lbp converges to a unique fixed point if @xmath188 .",
    "this result is sharp , since for @xmath371 , lbp simply `` rotates '' the messages around without changing them and hence no convergence occurs ( except , obviously , if the initial messages already correspond to the fixed point of uniform messages ) .",
    "in this section we explore the relations of our results with previously existing work .      in @xcite , a connection is made between two seemingly different topics , namely the sum - product algorithm on the one hand and the theory of gibbs measures @xcite on the other hand .",
    "the main result of @xcite states that lbp converges uniformly ( to a unique fixed point ) if the gibbs measure on the corresponding computation tree consists of all paths starting at @xmath20 that never backtrack . ] is unique .",
    "this is a remarkable and beautiful result ; however , the question of convergence of lbp is replaced by the question of uniqueness of the gibbs measure , which is not trivial .",
    "fortunately , sufficient conditions for the uniqueness of the gibbs measure exist ; the most well - known are _",
    "dobrushin s condition _ and a weaker ( but easier verifiable ) condition known as _",
    "simon s condition_. in combination with the main result of @xcite , they yield directly testable sufficient conditions for convergence of lbp to a unique fixed point . for reference , we will state both results in our notation below . for details , see @xcite and @xcite . note that the results are valid for the case of positive factors consisting of at most two variables and that it is not obvious whether they can be generalized .",
    "dobrushin s interdependence matrix _ as the @xmath376 matrix @xmath105 with entries @xmath377 for @xmath378 and 0 otherwise .",
    "[ theo : dobrushin ] for pairwise ( positive ) factors , lbp converges to a unique fixed point if @xmath379    for a proof sketch , see @xcite . for the proof of dobrushin",
    "s condition see chapter 8 in @xcite .",
    "we can rewrite the conditional probabilities in terms of factors : @xmath380 note that the complexity of the calculation of this quantity is generally exponential in the size of the neighborhood @xmath381 , which may prohibit practical application of dobrushin s condition .",
    "for the case of binary @xmath61-valued variables , some elementary algebraic manipulations yield @xmath382 with @xmath383      simon s condition is a sufficient condition for dobrushin s condition ( see proposition 8.8 in @xcite ) .",
    "this leads to a looser , but more easily verifiable , bound :    [ theo : simon ] for pairwise ( positive ) factors , lbp converges to a unique fixed point if @xmath384    it is not difficult to show that this bound is weaker than ( [ eq : sc_l1_linfty_pairwise ] )",
    ". furthermore , unlike dobrushin s condition and corollary [ coro : sc_spectral_improved_binary ] , it does not take into account single variable factors .",
    "in the recent and independent work @xcite of ihler _ et al .",
    "_ , a methodology was used which is very similar to the one used in this work . in particular ,",
    "the same local @xmath89 quotient metric is used to derive sufficient conditions for lbp to be a contraction . in the work presented here , the mean value theorem ( in the form of lemma [ lemm : mean_value_coro ] ) is used in combination with a bound on the derivative in order to obtain a bound on the convergence rate @xmath385 in ( [ eq : contraction ] ) .",
    "in contrast , in @xcite a direct bound on the distance of two outgoing messages is derived in terms of the distance of two different products of incoming messages ( equation ( 13 ) in @xcite ) .",
    "this bound becomes relatively stronger as the distance of the products of incoming messages increases .",
    "this has the advantage that it can lead to stronger conclusions about the effect of finite message perturbations than would be possible with our bound , based on the mean value theorem .",
    "however , for the question of _ convergence _ , the relevant limit turns out to be that of _ infinitesimal _ message perturbations , i.e.  it suffices to study the derivative of the lbp updates as we have done here .    in the limit of infinitesimal message perturbations",
    ", the fundamental bound ( 13 ) in @xcite leads to the following measure of potential strength : @xmath386 using this measure , ihler _ et .",
    "al _ derive two different conditions for convergence of lbp .",
    "the first one is similar to our ( [ eq : sc_l1_linfty_pairwise ] ) and the second condition is equivalent to our spectral radius result ( [ eq : sc_spectral_linfty_pairwise ] ) , except that in both conditions , @xmath351 is used instead of @xmath387 .",
    "the latter condition is formulated in @xcite in terms of the convergence properties of an iterative bp - like algorithm .",
    "the equivalence of this formulation with a formulation in terms of the spectral radius of a matrix can be seen from the fact that for any square matrix @xmath143 , @xmath160 if and only if @xmath388 . however",
    ", our result also gives a contraction rate , unlike the iterative formulation in @xcite .",
    "thus , the results in @xcite are similar to ours in the pairwise case , except for the occurrence of @xmath387 instead of @xmath351 .",
    "it is not difficult to see that @xmath389 for any pair factor @xmath349 ; indeed , for any choice of @xmath390 : @xmath391 thus the convergence results in @xcite are similar to , but weaker than the results derived in the present work .",
    "after initial submission of this work , @xcite was published , which improves upon @xcite by exploiting the freedom of choice of the single node factors ( which can be `` absorbed '' to an arbitrary amount by corresponding pair factors ) .",
    "this leads to an improved measure of potential strength , which turns out to be identical to our measure @xmath351 .",
    "thus , for pairwise , strictly positive potentials , the results in @xcite are equivalent to the results ( [ eq : sc_l1_linfty_pairwise ] ) and ( [ eq : sc_spectral_linfty_pairwise ] ) presented here . our most general results , theorems [ theo : sc_l1_linfty ] , [ theo : sc_spectral_linfty ] and [ theo : sc_spectral_linfty_zeros ] and corollary [ coro : sc_spectral_improved_binary ] , are not present in @xcite .",
    "a completely different methodology to obtain sufficient conditions for the uniqueness of the lbp fixed point is used in @xcite . by studying the bethe free energy and exploiting the relationship between properties of the bethe free energy and the lbp algorithm ,",
    "conclusions are drawn about the uniqueness of the lbp fixed point ; however , whether uniqueness of the fixed point also implies convergence of lbp seems to be an open question .",
    "we state the main result of @xcite in our notation below .",
    "the following measure of potential strength is used in @xcite . for @xmath19 ,",
    "let @xmath392 the potential strength is then defined as @xmath393 .",
    "[ theo : heskes ] lbp has a unique fixed point if there exists an `` allocation matrix '' @xmath394 between factors @xmath19 and variables @xmath18 such that    1 .",
    "@xmath395 for all @xmath396 ; 2 .",
    "@xmath397 for all @xmath19 ; 3 .",
    "@xmath398 for all @xmath18 .",
    "see theorem 8.1 in @xcite .",
    "the ( non)existence of such a matrix can be determined using standard linear programming techniques .",
    "in this subsection , we compare various bounds on binary pairwise graphical models , defined in ( [ eq : probability_measure_binary ] ) , for various choices of the parameters .",
    "first we study the case of a completely uniform model ( i.e.full connectivity , uniform couplings and uniform local fields ) .",
    "then we study non - uniform couplings @xmath399 , in the absence of local fields . finally , we take fully random models in various parameter regimes ( weak / strong local fields , strong / weak ferromagnetic / spin - glass / anti - ferromagnetic couplings ) .",
    "the fully connected ising model consisting of @xmath152 binary @xmath400-valued variables with uniform couplings @xmath46 and uniform local field @xmath401 is special in the sense that an exact description of the parameter region for which the gibbs measure on the computation tree is unique , is available .",
    "using the results of tatikonda and jordan , this yields a strong bound on the parameter region for which lbp converges to a unique fixed point . indeed , the corresponding computation tree is a uniform ising model on a cayley tree of degree @xmath402 , for which analytical expressions for the paramagnetic ",
    "ferromagnetic and paramagnetic  anti - ferromagnetic phase transition boundaries are known ( see section 12.2 in @xcite ) .",
    "since the gibbs measure is known to be unique in the paramagnetic phase , this gives an exact description of the @xmath403 region for which the gibbs measure on the computation tree is unique , and hence a bound on lbp convergence on the original model .",
    "comparison of various lbp convergence bounds for the fully connected @xmath404 binary ising model with uniform coupling @xmath46 and uniform local field @xmath401 .",
    "( a ) heskes condition ( b ) simon s condition ( c ) spectral radius condition ( d ) dobrushin s condition ( e ) improved spectral radius condition for @xmath405 ( f ) improved spectral radius condition for @xmath406 ( g ) uniqueness of gibbs measure condition .",
    "see the main text ( section [ sec : compare ] ) for more explanation . ]    in fig .",
    "[ fig : compare ] we have plotted various bounds on lbp convergence in the @xmath403 plane for @xmath404 ( other values of @xmath152 yield qualitatively similar results ) .",
    "the gray area ( g ) marks regions where the gibbs measure on the computation tree is not unique ; in the white area , the gibbs measure is unique and hence lbp is guaranteed to converge .",
    "note that this bound is only available due to the high symmetry of the model .",
    "in @xcite it is shown that parallel lbp does not converge in the lower ( anti - ferromagnetic ) gray region . in the upper ( ferromagnetic ) region on the other hand , parallel lbp does converge , but it may be that the fixed point is no longer unique .",
    "the various lines correspond to different sufficient conditions for lbp convergence ; the regions enclosed by two lines of the same type ( i.e.  the inner regions for which @xmath46 is small ) mark the regions of guaranteed convergence .",
    "the lightly dotted lines ( a ) correspond with heskes condition , theorem [ theo : heskes ] .",
    "the dash - dotted lines ( b ) correspond with simon s condition , theorem [ theo : simon ] .",
    "the dashed lines ( d ) correspond with dobrushin s condition ( theorem [ theo : dobrushin ] ) , which is seen to improve upon simon s condition for @xmath407 , but is nowhere sharp .",
    "the solid lines ( c ) correspond with the spectral radius condition corollary [ coro : sc_spectral_binary ] ( which coincides with the @xmath38-norm based condition corollary [ coro : sc_l1_binary ] in this case and is also equivalent to the result of @xcite ) , which is independent of @xmath401 but is actually sharp for @xmath408 .",
    "the heavily dotted lines ( e ) correspond to corollary [ coro : sc_spectral_improved_binary ] with @xmath409 , the @xmath410-shaped lines ( f ) to the same corollary with @xmath411 .",
    "both ( e ) and ( f ) are seen to coincide with ( c ) for small @xmath401 , but improve for large @xmath401 .",
    "we conclude that the presence of local fields makes it more difficult to obtain sharp bounds on lbp convergence ; only dobrushin s condition ( theorem [ theo : dobrushin ] ) and corollary [ coro : sc_spectral_improved_binary ] take into account local fields .",
    "furthermore , in this case , our result corollary [ coro : sc_spectral_improved_binary ] is stronger than the other bounds .",
    "note that the calculation of dobrushin s condition is exponential in the number of variables @xmath0 , whereas the time complexity of our bound is polynomial in @xmath0 .",
    "similar results are obtained for higher values of @xmath152 .",
    "comparison of various bounds for lbp convergence for toroidal ising model of size @xmath412 with normally distributed couplings @xmath413 and zero local fields .",
    "( a ) heskes condition ( b ) dobrushin s condition ( c ) @xmath38-norm condition ( d ) spectral radius condition ( e ) empirical convergence .",
    "see the main text ( section [ sec : compare2 ] ) for more explanation . ]",
    "we have investigated in more detail the influence of the distribution of the couplings @xmath67 , in the absence of local fields , and have also compared with the empirical convergence behavior of lbp .",
    "we have taken a binary ising model on a rectangular toroidal grid ( i.e.  with periodic boundary conditions ) of size @xmath412 .",
    "the couplings were random independent normally distributed nearest - neighbor couplings @xmath413 , the local fields were @xmath414 .",
    "let @xmath415 be the polar coordinates corresponding to the cartesian coordinates @xmath416 . for various angles",
    "@xmath417 $ ] , we have determined the critical radius @xmath418 for each bound .",
    "the results have been averaged over 40 instances of the model and can be found in fig .  [",
    "fig : compare2 ] .",
    "the lines correspond to the mean bounds , the gray areas are `` error bars '' of one standard deviation .",
    "the inner area ( for which the couplings are small ) bounded by each line means `` convergence '' , either guaranteed or empirical ( thus the larger the enclosed area , the tighter the bound ) . from bottom to top : the thin solid line ( a ) corresponds with heskes result ( theorem [ theo : heskes ] ) , the dash - dotted line ( b ) with dobrushin s condition ( theorem [ theo : dobrushin ] ) , the dotted line ( c ) corresponds with the @xmath38-norm based condition corollary [ coro : sc_l1_binary ] , the dashed line ( d ) with the spectral radius condition corollary [ coro : sc_spectral_binary ] and the thick solid line ( e ) with the empirical convergence behavior of lbp .",
    "we conclude from fig .",
    "[ fig : compare2 ] that the spectral radius condition improves upon the @xmath38-norm based condition for non - uniform couplings and that the improvement can be quite substantial . for uniform couplings ( and zero local fields ) , both conditions coincide and it can be proved that they are sharp @xcite .      finally , we have considered fully connected binary pairwise graphical models with completely random couplings and local fields ( in various parameter regimes ) .",
    "we drew random couplings and local fields as follows :",
    "first , we drew i.i.d .",
    "random parameters @xmath419 from a normal distribution with mean 0 and variance 1 .",
    "then , for each variable @xmath20 we independently drew a local field parameter @xmath420 , and for each pair @xmath77 we independently drew a coupling parameter @xmath421 .",
    "for the resulting graphical model , we have verified whether various sufficient conditions for lbp convergence hold .",
    "if condition a holds whereas condition b does not hold , we say that a wins from b. we have counted for each ordered pair @xmath422 of conditions how often a wins from b. the results ( for 50000 random models consisting of @xmath423 variables ) can be found in table [ tab : comparison ] : the number at row @xmath143 , column @xmath158 is the number of trials for which bound @xmath143 wins from bound @xmath158 . on the diagonal ( @xmath424 )",
    "is the total number of trials for which bound @xmath143 predicts convergence .",
    "theorem [ theo : dobrushin ] is due to @xcite , corollary [ coro : sc_spectral_binary ] was first published ( for the binary case ) in @xcite and theorem [ theo : heskes ] is due to @xcite .",
    ".comparison of bounds ( 50000 trials , for @xmath404 and @xmath425 ) [ cols= \" < , > , > , > , > \" , ]     our result corollary [ coro : sc_spectral_improved_binary ] ( for @xmath405 ) outperforms the other bounds in each trial . for other values of @xmath152",
    ", we obtain similar results .",
    "in this paper we have derived sufficient conditions for convergence of lbp to a unique fixed point . our conditions are directly applicable to arbitrary graphical models with discrete variables and nonnegative factors .",
    "this is in contrast with the sufficient conditions of tatikonda and jordan and with the results of ihler , fisher and willsky , which were only formulated for pairwise , positive factors .",
    "we have shown cases where our results are stronger than previously known sufficient conditions .    our numerical experiments",
    "lead us to conjecture that corollary [ coro : sc_spectral_improved_binary ] is stronger than the other bounds .",
    "we have no proof for this conjecture at the moment , apart from the obvious fact that corollary [ coro : sc_spectral_binary ] is weaker than corollary [ coro : sc_spectral_improved_binary ] . to prove that corollary",
    "[ coro : sc_spectral_improved_binary ] is stronger than theorem [ theo : dobrushin ] seems subtle , since it is generally not the case that @xmath426 , although it seems that the weaker relation @xmath427 does hold in general .",
    "the relation with the condition in theorem [ theo : heskes ] is not evident as well .    in the binary pairwise case , it turned out to be possible to derive sufficient conditions that take into account local evidence ( corollary [ coro : sc_spectral_improved_binary ] ) . in the general case ,",
    "such an improvement is possible in principle but seems to be more involved .",
    "the resulting optimization problem ( essentially ( [ eq : sup_h ] ) with additional assumptions on @xmath428 ) looks difficult in general . if the variables cardinalities and connectivies are small , the resulting optimization problem can be solved , but writing down a general solution does not appear to be trivial .",
    "the question of finding an efficient solution in the general case is left for future investigation .",
    "the work reported here raises new questions , some of which have been ( partially ) answered elsewhere after the initial submission of this paper .",
    "the influence of damping the lbp update equations has been considered for the binary pairwise case in @xcite , where it was shown that damping has the most effect for anti - ferromagnetic interactions .",
    "furthermore , it has been proved in @xcite that the bounds for lbp convergence derived in the present work are sharp in the case of binary variables with ferromagnetic pairwise interactions and zero local fields , as suggested by fig .",
    "[ fig : compare2 ] .",
    "an extension of the results towards sequential update schemes has been given in @xcite ; it is shown that for each reasonable sequential update scheme , the same conditions for convergence to a unique fixed point as derived in this work apply .",
    "likewise , in @xcite it is shown that dobrushin s condition is also valid for sequential lbp .",
    "let @xmath429 be a collection of normed vector spaces and let @xmath430 be the direct sum of the @xmath431 s .",
    "the function @xmath432 defined by @xmath433 is a norm on @xmath91 , as one easily checks .",
    "let @xmath434 be a linear mapping with `` blocks '' @xmath435 defined by @xmath436 for all @xmath50 .",
    "the matrix norm of @xmath143 induced by the vector norm @xmath98 is given by : @xmath437 where @xmath438    let @xmath439 such that @xmath440 .",
    "then @xmath441 now let @xmath115 such that @xmath442 .",
    "then @xmath443 can be written as the convex combination @xmath444 , where @xmath445 hence : @xmath446 it is evident that this value is also achieved for some @xmath115 with @xmath447 .",
    "an illustrative example is obtained by considering @xmath448 to be the direct sum of @xmath152 copies of @xmath449 with the absolute value as norm ; then the norm ( [ eq : gen_l1_norm ] ) on @xmath87 is simply the @xmath38-norm and the induced matrix norm ( [ eq : gen_l1_mnorm ] ) reduces to ( [ eq : l1_mnorm ] ) .",
    "suppose that each @xmath431 has a linear subspace @xmath450 .",
    "we can consider the quotient spaces @xmath451 with quotient norms @xmath452 .",
    "the direct sum @xmath453 is itself a subspace of @xmath91 , yielding a quotient space @xmath255 .",
    "for @xmath115 we have @xmath454 and hence @xmath455 .",
    "the quotient norm on @xmath255 is simply the sum of the quotient norms on the @xmath451 : @xmath456    let @xmath107 be a linear mapping such that @xmath262 . then @xmath143 induces a linear @xmath457 ; since @xmath458 , each block @xmath459 induces a linear @xmath460 , and @xmath461 can be regarded as consisting of the blocks @xmath462 .",
    "the matrix norm of @xmath457 induced by the quotient norm @xmath463 on @xmath255 is : @xmath464 where @xmath465    we can directly apply the previous theorem to the quotient spaces to obtain ( [ eq : gen_l1_qmnorm ] ) ; because @xmath466 we have : @xmath467    for a linear @xmath107 such that @xmath468 , we define the matrix @xmath469 with entries @xmath470 .",
    "let @xmath471 be two such linear mappings ; then @xmath472 hence @xmath473 .",
    "note that @xmath474 . we can generalize theorem [ theo : almost_jacobi_binary ] :    [ theo : almost_jacobi ] let @xmath116 be differentiable and suppose that it satisfies ( [ eq : f_symmetry ] ) .",
    "suppose further that @xmath475 for some matrix @xmath476 ( which does not depend on @xmath443 ) with @xmath160 .",
    "then for any @xmath477 , the sequence @xmath478 obtained by iterating @xmath270 converges to a unique fixed point @xmath479 .    using the chain rule",
    ", we have for any @xmath175 and any @xmath115 : @xmath480 by the gelfand spectral radius theorem , @xmath481 for @xmath482 .",
    "choose @xmath179 such that @xmath180 .",
    "for some @xmath152 , @xmath181 .",
    "hence @xmath483 for all @xmath484 . by lemma [ lemm : sc_general ]",
    ", @xmath485 is a contraction with respect to the quotient norm on @xmath486",
    ". now apply lemma [ lemm : pow_contract_conv ] .",
    "let @xmath487 be a matrix of positive numbers .",
    "let @xmath488 define the function @xmath489 by @xmath490    @xmath491    first note that we can assume without loss of generality that all @xmath487 are different , because of continuity .",
    "define @xmath492 , \\qquad     x ' : = x \\setminus \\{{{\\tilde{{\\psi}}^{}}_{\\beta\\gamma } } : \\beta,\\gamma\\}.    \\end{aligned}\\ ] ] for @xmath493 , define @xmath494 which is evidently a closed convex set .",
    "the function @xmath495 obtained by restricting @xmath496 to @xmath497 is convex .",
    "hence it achieves its maximum on an extremal point of its domain .",
    "define @xmath498 as those @xmath499 with exactly two non - zero components . for @xmath500 , define @xmath501 and @xmath502 .",
    "because of continuity , we can restrict ourselves to the @xmath503 , in which case the extremal points of @xmath497 are precisely @xmath504 ( i.e.  the extremal points have exactly two non - zero components ) .",
    "now @xmath505    for those @xmath500 with components with different @xmath291 , we can use the lemma below .",
    "the @xmath500 with components with equal @xmath291 are suboptimal , since the two contributions in the sum over @xmath295 in @xmath506 have opposite sign .",
    "hence @xmath507    let @xmath508",
    ". then @xmath509    elementary .",
    "the easiest way to see this is to reparameterize @xmath510 with @xmath511 .",
    "the research reported here is part of the interactive collaborative information systems ( icis ) project ( supported by the dutch ministry of economic affairs , grant bsik03024 ) and was also sponsored in part by the dutch technology foundation ( stw ) .",
    "we thank martijn leisink for stimulating discussions .",
    "j.  m. mooij and h.  j. kappen , `` sufficient conditions for convergence of loopy belief propagation , '' in _ proc . of the 21st annual conf . on uncertainty in artificial intelligence ( uai-05)_.1em plus 0.5em minus 0.4em corvallis , oregon : auai press , 2005 , pp .",
    "396403 .",
    "a.  braunstein and r.  zecchina , `` survey propagation as local equilibrium equations , '' _ journal of statistical mechanics : theory and experiment _ , vol .",
    "2004 , no .  06 , p. p06007 , 2004 .",
    "[ online ] .",
    "available : http://stacks.iop.org/1742-5468/2004/p06007      k.  tanaka , `` statistical - mechanical approach to image processing , '' _ journal of physics a : mathematical and general _ , vol .",
    "35 , no .",
    "r81r150 , 2002 .",
    "[ online ] .",
    "available : http://stacks.iop.org/0305-4470/35/r81    t.  heskes , c.  albers , and h.  j. kappen , `` approximate inference and constrained optimization , '' in _ proc .",
    "of the 19th annual conf . on uncertainty in artificial intelligence ( uai-03)_.1em plus 0.5em minus 0.4emsan francisco , ca : morgan kaufmann publishers , 2003 , pp . 313320 .",
    "j.  s. yedidia , w.  t. freeman , and y.  weiss , `` constructing free - energy approximations and generalized belief propagation algorithms , '' _ ieee transactions on information theory _ ,",
    "51 , no .  7 , pp .",
    "22822312 , july 2005 .",
    "t.  minka , `` expectation propagation for approximate bayesian inference , '' in _ proc . of the 17th annual conf . on uncertainty in artificial intelligence ( uai-01)_.1em plus 0.5em minus 0.4emsan francisco , ca : morgan kaufmann publishers , 2001 , pp .",
    "362369 .",
    "y.  weiss and w.  t. freeman , `` on the optimality of solutions of the max - product belief - propagation algorithm in arbitrary graphs , '' _ ieee transactions on information theory _ , vol .",
    "47 , no .  2 ,",
    "736744 , feb .",
    "a.  braunstein , m.  mzard , and r.  zecchina , `` survey propagation : an algorithm for satisfiability , '' _ random structures and algorithms _",
    "27 , no .  2 ,",
    "pp . 201226 , 2005 .",
    "[ online ] .",
    "available : http://dx.doi.org/10.1002/rsa.20057    w.  wiegerinck and t.  heskes , `` fractional belief propagation , '' in _ advances in neural information processing systems 15 _ , s.  t. s.  becker and k.  obermayer , eds.1em plus 0.5em minus 0.4emcambridge , ma : mit press , 2003 , pp .",
    "438445 .    s.  c. tatikonda and m.  i. jordan , `` loopy belief propogation and gibbs measures , '' in _ proc .",
    "of the 18th annual conf . on uncertainty in artificial intelligence ( uai-02)_.1em plus 0.5em minus 0.4emsan francisco , ca : morgan kaufmann publishers , 2002 , pp .",
    "493500 .",
    "a.  t. ihler , j.  w. fisher , and a.  s. willsky , `` message errors in belief propagation , '' in _ advances in neural information processing systems 17 ( nips*2004 ) _ , l.  k. saul , y.  weiss , and l.  bottou , eds.1em plus 0.5em minus 0.4emcambridge , ma : mit press , 2005 , pp . 609616 .",
    "j.  m. mooij and h.  j. kappen , `` on the properties of the bethe approximation and loopy belief propagation on binary networks , '' _ journal of statistical mechanics : theory and experiment _ , vol .",
    "2005 , no .  11 , p. p11012 , 2005 .",
    "[ online ] .",
    "available : http://stacks.iop.org/1742-5468/2005/p11012    g.  elidan , i.  mcgraw , and d.  koller , `` residual belief propagation : informed scheduling for asynchronous message passing , '' in _ proceedings of the twenty - second conference on uncertainty in ai ( uai ) _ , boston , massachussetts , july 2006 ."
  ],
  "abstract_text": [
    "<S> we derive novel conditions that guarantee convergence of the sum - product algorithm ( also known as loopy belief propagation or simply belief propagation ) to a unique fixed point , irrespective of the initial messages . </S>",
    "<S> the computational complexity of the conditions is polynomial in the number of variables . </S>",
    "<S> in contrast with previously existing conditions , our results are directly applicable to arbitrary factor graphs ( with discrete variables ) and are shown to be valid also in the case of factors containing zeros , under some additional conditions . </S>",
    "<S> we compare our bounds with existing ones , numerically and , if possible , analytically . for binary variables with pairwise interactions , </S>",
    "<S> we derive sufficient conditions that take into account local evidence ( i.e.  single variable factors ) and the type of pair interactions ( attractive or repulsive ) . </S>",
    "<S> it is shown empirically that this bound outperforms existing bounds .    </S>",
    "<S> sum - product algorithm , loopy belief propagation , graphical models , factor graphs , marginalization , convergence , contraction , message passing </S>"
  ]
}