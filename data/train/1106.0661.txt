{
  "article_text": [
    "cryptosystems based on curves of genus @xmath0 offer per - bit security and efficiency comparable with elliptic curve cryptosystems .",
    "however , many of the computational problems related to creating secure instances of genus  @xmath0 cryptosystems are considerably more difficult than their elliptic curve analogues .",
    "point counting  or , from a cryptographic point of view , computing the cardinality of a cryptographic group  offers a good example of this disparity , at least for curves defined over large prime fields .",
    "indeed , while computing the order of a cryptographic - sized elliptic curve with the schoof  elkies  atkin algorithm is now routine , computing the order of a comparable genus @xmath0 jacobian requires a significant computational effort  @xcite .    in this article",
    "we describe a number of improvements to the classical schoof ",
    "pila algorithm for genus @xmath0 curves with explicit and efficient real multiplication ( rm ) .",
    "for explicit rm curves over @xmath6 , we reduce the complexity of schoof  pila from @xmath7 to @xmath8 .",
    "we applied a first implementation of our algorithms to find prime - order jacobians over 128-bit fields ( comparable to prime - order elliptic curves over 256-bit fields , and therefore suitable for contemporary cryptographic applications ) .",
    "going further , we were able to compute the order of an rm jacobian defined over a 512-bit prime field , far beyond the cryptographic range .",
    "( for comparison , the previous record computation in genus @xmath0 was over a 128-bit field . )",
    "while these rm curves are special , they are not `` too special '' : every ordinary genus @xmath0 jacobian over a finite field has rm ; our special requirement is that this rm be known in advance and be efficiently computable .",
    "the moduli of curves with rm by a fixed ring form @xmath0-dimensional subvarieties ( humbert surfaces ) in the @xmath9-dimensional moduli space of all genus  @xmath0 curves .",
    "we can generate random curves with the specified rm by choosing random points on an explicit model of the corresponding humbert surface  @xcite . in comparison with elliptic curves ,",
    "for which the moduli space is one - dimensional , this still gives an additional degree of freedom in the random curve selection .",
    "to generate random curves with efficiently computable rm , we choose random curves from some known one and two - parameter families ( see   [ sec : families ] ) .",
    "curves with efficiently computable rm have an additional benefit in cryptography : the efficient endomorphism can be used to accelerate scalar multiplication on the jacobian , yielding faster encryption and decryption  @xcite .",
    "the rm formul are also compatible with fast arithmetic based on theta functions  @xcite .",
    "let @xmath10 be a curve of genus 2 over a finite field @xmath11 , of odd characteristic , defined by an affine model @xmath12 , where @xmath13 is a squarefree polynomial of degree @xmath14 or @xmath15 over @xmath11 .",
    "let @xmath16 be the jacobian of @xmath10 ; we assume @xmath16 is ordinary and absolutely simple .",
    "points on @xmath16 correspond to degree-@xmath17 divisor classes on @xmath10 ; we use the mumford representation for divisor classes together with the usual cantor - style composition and reduction algorithms for divisor class arithmetic  @xcite .",
    "multiplication by @xmath18 on @xmath16 is denoted by @xmath19 $ ] , and its kernel by @xmath20 $ ] .",
    "more generally , if @xmath21 is an endomorphism of @xmath16 then @xmath22 = \\ker(\\phi)$ ] , and if @xmath23 is a set of endomorphisms then @xmath24 $ ] denotes the intersection of @xmath25 for @xmath21 in @xmath23 .",
    "we let @xmath26 denote the frobenius endomorphism of @xmath16 , with rosati dual @xmath27 ( so @xmath28 $ ] ) .",
    "the characteristic polynomial of @xmath26 has the form @xmath29 where @xmath30 and @xmath31 are integers , and @xmath31 is a translation of the standard definition .",
    "the polynomial @xmath32 determines the cardinality of @xmath33 for all @xmath34 : in particular , @xmath35 . we refer to the determination of @xmath32 as the _ point counting problem_.    the polynomial @xmath32 is a _",
    "weil polynomial _ : all of its complex roots lie on the circle @xmath36 .",
    "this implies the weil bounds @xmath37 however , the possible values of @xmath38 do not fill the whole rectangle specified by the weil bounds .",
    "rck  ( * ? ? ?",
    "* theorem 1.1 ) shows that in fact @xmath30 and @xmath31 satisfy @xmath39 so the possible values of @xmath38 are in the following domain :      the objective of point counting is to compute @xmath32 , or equivalently the tuple of integers @xmath38 .",
    "when the characteristic of @xmath1 is large , the conventional approach is to apply the schoof ",
    "pila algorithm as far as is practical , before passing to a baby - step giant - step algorithm if necessary ( see   [ sec : bsgs ] ) .",
    "the strategy of schoof s algorithm and its generalizations is to compute the polynomials @xmath40 for sufficiently many primes ( or prime powers ) @xmath18 to reconstruct @xmath32 using the chinese remainder theorem .    since @xmath41 is the characteristic polynomial of @xmath26 restricted to @xmath20 $ ] ( see  ( * ? ? ?",
    "* proposition 2.1 ) ) , we have @xmath42.\\ ] ]    conversely , to compute @xmath41 we let @xmath43 be a generic element of @xmath20 $ ] ( as in   [ sec : kernel - ideal ] below ) , compute the three points @xmath44)^2(d),\\ \\       ( \\pi^2 + [ \\bar{q}])\\pi(d),\\ \\text{and}\\ \\         \\pi^2(d),\\ ] ] and then search for the coefficients @xmath45 of @xmath41 in @xmath46 , for which the linear relation @xmath47)^2(d )       - [ \\bar{s}_1]\\,(\\pi^2 + [ \\bar{q}])\\pi(d )       + [ \\bar{s}_2]\\,\\pi^2(d ) = 0\\ ] ] holds .",
    "if the minimal polynomial of @xmath26 on @xmath20 $ ] is a proper divisor of @xmath41which occurs for at most a finite number of @xmath18 dividing @xmath48then the polynomial so determined is not unique , but @xmath41 can be determined by deducing the correct multiplicities of its factors .",
    "once we have computed @xmath41 for sufficiently many @xmath18 , we reconstruct  @xmath32 using the chinese remainder theorem .",
    "the weil and rck bounds together with a weak version of the prime number theorem tell us how many @xmath18 are required : pila notes in  @xcite that the set of @xmath49 primes @xmath50 will suffice .",
    "we analyse the complexity of the classical schoof ",
    "pila algorithm in   [ sec : schoof  pila - complexity ] .",
    "we now recall how to contruct an effective version of a generic @xmath18-torsion element .",
    "we present it in a slightly more general setting , so that we can use this ingredient in the subsequent rm - specific algorithm .",
    "therefore , we show how to compute with a generic element of the kernel of some endomorphism @xmath21 of @xmath16 , whereas @xmath21 is just @xmath19 $ ] in the classical algorithm .",
    "[ def : explicit ] fix an embedding @xmath51 of @xmath10 in @xmath16 .",
    "we say that an endomorphism @xmath21 of  @xmath16 is _ explicit _ if we can effectively compute polynomials @xmath52 and @xmath53 such that if @xmath54 is a generic point of @xmath10 , then the mumford representation of @xmath55 is given by @xmath56 the @xmath57 , @xmath58 , @xmath59 , @xmath60 , @xmath61 , and @xmath53 are called the _",
    "@xmath21-division polynomials_.    if @xmath21 is an explicit endomorphism , then we can use ( extending @xmath62-linearly ) to evaluate @xmath63 for general divisor classes @xmath43 in @xmath16 . in the case",
    "@xmath64 $ ] , the @xmath19$]-division polynomials are the @xmath18-division polynomials of cantor  @xcite .",
    "the @xmath21-division polynomials depend on the choice of embedding @xmath65 ; we will make this choice explicit when computing the @xmath21-division polynomials for each of our families in   [ sec : families ] .    to compute a generic element of @xmath22 $ ]",
    ", we generalize the approach of  @xcite ( which computes generic elements of @xmath20 $ ] ) .",
    "the resulting algorithm is essentially the same as in  @xcite ( except for the parasite computation step , which we omit ) with @xmath21-division polynomials replacing @xmath18-division polynomials , so we will only briefly sketch it here .",
    "let @xmath66 be ( the mumford representation of ) a generic point of @xmath16 .",
    "we want to compute a triangular ideal @xmath67 in @xmath68 $ ] vanishing on the nonzero elements of @xmath22 $ ] .",
    "the element  @xmath43 equals @xmath69 , where @xmath70 and @xmath71 are generic points of @xmath10 . to find a triangular system of relations on the @xmath72 and @xmath73 such that @xmath43 is in @xmath22 $ ] we solve for @xmath74 , @xmath75 , @xmath76 , and @xmath77 in @xmath78 applying and using resultants computed with the evaluation",
    "interpolation technique of  @xcite .",
    "we then resymmetrize as in  @xcite to express the result in terms of the  @xmath72 and  @xmath73 .",
    "we can now compute with a `` generic '' element @xmath79 of  @xmath22 $ ] by reducing the coefficients modulo  @xmath67 after each operation .",
    "following the complexity analysis of  @xcite , we can compute a triangular representation for @xmath67 in @xmath80 field operations , where @xmath81 is the maximum among the degrees of the @xmath21-division polynomials , and @xmath82 is the number of operations required to multiply polynomials of degree @xmath83 over @xmath1 . using asymptotically fast multiplication algorithms , we can therefore compute  @xmath67 in  @xmath84 field operations .",
    "the degree of @xmath67 is in @xmath85 ; with this triangular representation , each multiplication modulo @xmath67 costs @xmath86 field operations .      the complexity of the classical schoof  pila algorithm for a curve of genus @xmath0 over @xmath1 is in @xmath87 .    to determine @xmath32",
    ", we need to compute @xmath41 for @xmath49 primes @xmath18 in @xmath49 .",
    "to compute @xmath41 , we must first compute the @xmath18-division polynomials , which have degrees in @xmath88 .",
    "we then compute the kernel ideal @xmath89 ; according to the previous subsection , the total cost is in @xmath90 field operations .",
    "the cost of checking against a generic element of @xmath20 $ ] decomposes into the cost of computing frobenius images of the generic element in @xmath91 and of finding the matching pair @xmath92 in @xmath93 field operations .",
    "so the total complexity for computing @xmath41 is in @xmath94 field operations . in terms of bit operations , for each @xmath18 bounded by @xmath49 , we compute @xmath41 in time @xmath95 , and the result follows from the addition of these costs for all the different @xmath18 s .      in practice ,",
    "computing @xmath41 with classical schoof ",
    "pila becomes impractical for large values of @xmath18 .",
    "the usual approach is to carry out the schoof ",
    "pila algorithm to the extent possible , obtaining congruences for @xmath30 and @xmath31 modulo some integer @xmath96 , before completing the calculation using a generic group algorithm such as baby - step giant - step ( bsgs ) .",
    "our bsgs algorithm of choice is the low - memory parallelized variant of the matsuo ",
    "chao  tsuji algorithm  @xcite .    the bounds in imply that the search space of candidates for @xmath38 is in @xmath97 , and a pure bsgs approach finds @xmath38 in time and space @xmath98 .",
    "however , when we apply bsgs after a partial schoof  pila computation , we obtain a congruence for @xmath38 modulo  @xmath96 .",
    "if @xmath99 , then the size of the search space is reduced to @xmath100 , and the complexity for finding @xmath38 is reduced to @xmath101 . for larger @xmath96",
    ", the value of @xmath30 is fully determined , and the problem is reduced to a one - dimensional search space of size @xmath102 for which the complexity becomes @xmath103 .",
    "by assumption , @xmath16 is ordinary and simple , so @xmath32 is an irreducible polynomial defining a quartic cm - field with real quadratic subfield @xmath104 .",
    "we say that @xmath16 ( and  @xmath10 ) has _ real multiplication _",
    "( rm ) by @xmath105 . for a randomly selected curve ,",
    "@xmath106 is in @xmath107 ; but in the sequel we consider families of curves with rm by @xmath104 for small @xmath106 (= @xmath14 or @xmath108 ) , admitting an explicit ( in the sense of definition  [ def : explicit ] ) endomorphism @xmath21 such that @xmath109 = { \\mathbb{q}}(\\sqrt{{\\delta } } ) \\cap { \\ensuremath{\\mathrm{end}}}({\\ensuremath{j_{{\\mathcal{c}}}}})\\ ] ] ( that is , @xmath110 $ ] is the full real subring of @xmath111 ) , and @xmath112\\right ) = { \\delta}.\\ ] ] we presume that the trace @xmath113 and norm @xmath114 , such that @xmath115 , are known .",
    "we also suppose that @xmath21 is _ efficient _ , in the following sense :    we say that an explicit endomorphism @xmath21 is _ efficiently computable _ if the cost of evaluating @xmath21 at points of @xmath116 requires only @xmath117 field operations ( comparable to a few group operations in @xmath16 ) . in practice , this means that the @xmath21-division polynomials have small degree .",
    "the existence of an efficiently computable @xmath21 and knowledge of @xmath106 allows us to make significant improvements to each stage of the schoof  pila algorithm . briefly : in   [ sec : rm - char - poly ] we use  @xmath21 to simplify the testing procedure for each  @xmath18 ; in   [ sec : split - prime ] we show that when  @xmath18 splits in  @xmath110 $ ] , we can use @xmath21 to obtain a radical reduction in complexity for computing @xmath41 ; and in   [ sec : search - space ] we show that knowing an effective @xmath21 allows us to use many fewer primes @xmath18 .",
    "let @xmath118 ; we consider @xmath119 $ ] , a subring of the real quadratic subring of @xmath111 .",
    "the characteristic polynomial of @xmath120 is the _ real weil polynomial _ @xmath121",
    "the discriminant of @xmath119 $ ] is @xmath122 .",
    "the analogue for @xmath123 of rck s bounds is @xmath124 equation implies that @xmath119 $ ] is contained in @xmath110 $ ] , so there exist integers @xmath125 and @xmath126 such that @xmath127 both @xmath30 and @xmath31 are determined by @xmath125 and @xmath126 : we have @xmath128 in fact @xmath126 is the conductor of @xmath119 $ ] in @xmath110 $ ] up to sign : @xmath129:{\\mathbb{z}}[\\psi ] ] $ ] , and hence @xmath130 ) = s_1 ^ 2 - 4 s_2 = n^2 { \\delta}.\\ ] ] the square root of the bounds in gives bounds on @xmath30 and  @xmath126 : @xmath131 in particular , @xmath132 and @xmath133 .",
    "applying the relation in  , we have the bounds @xmath134 both @xmath135 and @xmath136 are in @xmath137 .",
    "we can use our efficiently computable endomorphism @xmath21 to replace the relation of with a more efficiently computable alternative . multiplying through by @xmath26 ,",
    "we have @xmath138 = m\\pi + n\\phi\\pi.\\ ] ] we can therefore compute @xmath139 and @xmath140 by letting @xmath43 be a generic @xmath18-torsion point , computing the three points @xmath44)(d ) ,      \\ \\",
    "\\pi(d ) ,      \\ \\ \\text{and } \\ \\",
    "\\phi\\pi(d ) , \\ ] ] and then searching for the @xmath141 and @xmath142 in @xmath143 such that @xmath144)(d ) - [ \\bar{m}]\\pi(d ) - [ \\bar{n}]\\phi\\pi(d ) = 0\\ ] ] holds ; we can find such an @xmath141 and @xmath142 in @xmath145 group operations .",
    "solving rather than has several advantages .",
    "first , computing @xmath146)(d)$ ] , @xmath147 , and @xmath148 requires only two applications of frobenius , instead of the four required to compute @xmath146)^2(d)$ ] , @xmath146)\\pi(d)$ ] , and @xmath149 ( and frobenius applications are costly in practice ) .",
    "moreover , either @xmath31 needs to be determined in @xmath107 , or else the value of @xmath126 in leaves a sign ambiguity for each prime @xmath18 , because only @xmath150 can be deduced from @xmath151 .",
    "in contrast , determines @xmath126 directly .",
    "let @xmath110 \\subset { \\ensuremath{\\mathrm{end}}}({\\ensuremath{j_{{\\mathcal{c}}}}})$ ] be an rm order in @xmath152 .",
    "asymptotically , half of all primes @xmath18 split : @xmath153 in @xmath110 $ ] , where @xmath154 ( and this carries over to prime powers @xmath18 ) .",
    "this factorization gives a decomposition of the @xmath18-torsion @xmath155 = { \\ensuremath{j_{{\\mathcal{c}}}}}[{\\mathfrak{p}}_1 ] \\oplus { \\ensuremath{j_{{\\mathcal{c}}}}}[{\\mathfrak{p}}_2].\\ ] ] in particular , any @xmath18-torsion point @xmath43 can be uniquely expressed as a sum @xmath156 where @xmath157 is in @xmath158 $ ] .",
    "according to the cohen ",
    "lenstra heuristics  @xcite , more than 75% of rm fields have class number 1 ; in each of the explicit rm families in  [ sec : families ] , the order @xmath110 $ ] has class number 1 .",
    "all ideals are principal in such an order , so we may find a generator for each of the ideals @xmath159 .",
    "furthermore , the following lemma shows that we can find a generator which is not too large .",
    "[ lemma : generator - reduction ] if @xmath160 is a principal ideal of norm @xmath18 in a real quadratic order @xmath110 $ ] , then there exists an effectively computable generator of @xmath160 with coefficients in @xmath161 .",
    "let @xmath162 be a generator of @xmath160 , and @xmath163 a fundamental unit of @xmath110 $ ] .",
    "let @xmath164 and @xmath165 be the two embeddings of @xmath110 $ ] in @xmath166 , indexed so that @xmath167 and @xmath168 ( replacing @xmath163 with @xmath169 if necessary )",
    ". then @xmath170 is the regulator of @xmath110 $ ] .",
    "set @xmath171 , where @xmath172 $ ] ; then @xmath173 is a new generator for @xmath160 such that @xmath174 from the preceding bounds , @xmath175 and @xmath176 are bounded by @xmath177 . since @xmath113 , @xmath106 and @xmath178 are fixed constants , @xmath179 and @xmath180 are in @xmath161 .",
    "the `` effective '' part of the result follows from classical algorithms for quadratic fields .",
    "[ lemma : alpha - division - polynomials ]",
    "let @xmath16 be the jacobian of a genus @xmath0 curve over a finite field @xmath11 with an efficiently computable rm endomorphism @xmath21 .",
    "there exists an algorithm which , given a principal ideal @xmath160 of norm @xmath18 in @xmath110 $ ] , computes an explicit generator @xmath162 of @xmath160 and the @xmath162-division polynomials in @xmath145 field operations .    by lemma  [ lemma : generator - reduction ] , we can compute a generator @xmath181 + [ b]\\phi$ ] with @xmath182 and @xmath183 in @xmath161 .",
    "the @xmath184$]- and @xmath185$]-division polynomials have degrees in @xmath145 , and can be determined in @xmath145 field operations .",
    "the division polynomials for the sum @xmath181 + [ b]\\phi$ ] require one sum and one application of @xmath21 ; and since @xmath21 is efficiently computable , this increases the division polynomial degrees and computing time by at most a constant factor .",
    "we can now state the main theorem for rm point counting .",
    "[ theorem : rm - ptc - complexity ] there exists an algorithm for the point counting problem in a family of genus  2 curves with efficiently computable rm of class number 1 , whose complexity is in @xmath186 .",
    "let @xmath16 be a jacobian in a family with efficiently computable rm by @xmath110 $ ] .",
    "suppose that @xmath18 is prime , @xmath153 in @xmath110 $ ] , and that the @xmath159 are principal .",
    "by lemma  [ lemma : alpha - division - polynomials ] we can compute representative @xmath162-division polynomials for @xmath16 for each @xmath160 in @xmath187 in time @xmath188 , hence generic points @xmath157 in @xmath158 $ ] .",
    "we recall that is the homomorphic image under @xmath26 of the equation @xmath189(d ) - [ \\bar{n}]\\phi(d ) = 0.\\ ] ] when applied to @xmath157 in @xmath158 $ ] , both @xmath120 and @xmath21 act as elements of @xmath110/{\\mathfrak{p}}_i { \\cong}{\\mathbb{z}}/\\ell{\\mathbb{z}}$ ]",
    ". moreover @xmath190 is known , and it remains to determine @xmath191 by means of the discrete logarithm @xmath192(d_i ) = [ \\bar{m}+\\bar{n}\\bar{x}_i](d_i)\\ ] ] in the cyclic group @xmath193 .",
    "the application of @xmath26 transports this discrete logarithm problem to that of solving for @xmath194 in @xmath195d',\\ ] ] where @xmath196 and @xmath197)(d_i)$ ] . by the crt , from @xmath198 in @xmath46 we recover @xmath199 in @xmath110/(\\ell)$ ] , from which we solve for @xmath200 in @xmath46 such that @xmath201/(\\ell).\\ ] ] the values of @xmath45 are then recovered from .",
    "the ring @xmath110 $ ] is fixed , so as @xmath202 goes to infinity we find that 50% of all primes @xmath18 split in @xmath110 $ ] by the chebotarev density theorem .",
    "it therefore suffices to consider split primes in @xmath49 . in comparison with the conventional algorithm presented in  [",
    "sec : schoof  pila ] , we reduce from computation modulo the ideal for @xmath20 $ ] of degree in @xmath203 , to computation modulo the ideals for @xmath158 $ ] of degree in @xmath88 .",
    "this means a reduction from @xmath94 to @xmath204 field operations for the determination of each @xmath205 , giving the stated reduction in total complexity from @xmath87 to @xmath186 .",
    "[ remark : rm - schoof - pila - reduction ] computing @xmath206 instead of @xmath38 allows us to reduce the number of primes  @xmath18 to be considered by about a half , since by   their product needs to be in @xmath137 instead of @xmath107 .",
    "while this changes only the constant in the asymptotic complexity of the algorithm , it yields a significant improvement in practice .",
    "[ remark : rm - class - number - not-1 ] if @xmath110 $ ] does not have class number @xmath207 , and if @xmath208 where the @xmath159 are not principal , then we may use a small complementary ideal @xmath209 such that @xmath210 are principal in order to apply lemma  [ lemma : alpha - division - polynomials ] to a larger proportion of small ideals . moreover , if @xmath200 is known modulo @xmath211 , this can be used to reduce the discrete log problem modulo @xmath18 . again , since a fixed positive density @xmath212 of primes are both split and principal , where @xmath213 is the class number of @xmath110 $ ] , this does not affect the asymptotic complexity .",
    "moreover , the first occurrence of a nontrivial class group is for @xmath214 , beyond the current range for which an explicit rm construction is currently known .      in the context of the conventional schoof - pila algorithm",
    ", we need to find @xmath30 in @xmath137 and @xmath31 in @xmath107 .",
    "however , , and the effective form of ( valid for all points @xmath43 of @xmath16 ) , replaces the determination of @xmath38 with the tuple @xmath206 of integers in @xmath137 . as a result ,",
    "the search space is reduced from @xmath97 to @xmath107 .",
    "thus the bsgs strategy can find @xmath206 ( which determines @xmath38 ) in time and space @xmath137 , compared with @xmath215 when searching directly for @xmath38 .",
    "as in the general case , if one knows @xmath206 modulo an integer @xmath96 , then the area of the search rectangle is reduced by a factor of @xmath216 , so we find the tuple @xmath206 in @xmath217 group operations .",
    "contrary to the general case of  [ sec : bsgs ] , since @xmath125 and @xmath126 have the same order of magnitude , the speed - up is always by a factor of @xmath96 .",
    "we now exhibit some families of curves and efficient rm endomorphisms that can be used as sources of inputs to our algorithm .",
    "to give a concrete representation for endomorphisms of @xmath16 , we use _ correspondences _ : that is , divisors on the surface @xmath218 .",
    "suppose that @xmath219 is a curve on @xmath218 , and let @xmath220 and @xmath221 be the restrictions to @xmath219 of the natural projections from @xmath218 onto its first and second factors .",
    "we have a pullback homomorphism @xmath222 , defined by @xmath223\\big )      =      \\big [          \\sum_{p \\in { \\ensuremath{\\mathcal{c}}}({\\overline{\\mathbb{f}}}_{q})}\\!\\!\\ !",
    "n_p\\!\\!\\ !          \\sum_{q",
    "\\in \\pi_{1}^{-1}(p)}\\!\\!\\ ! q\\       \\big ]      , \\ ] ] where the preimages @xmath224 are counted with the appropriate multiplicities .",
    "( a standard moving lemma shows that we can always choose divisor class representatives so that each @xmath225 is zero - dimensional . )",
    "we also have a pushforward homomorphism @xmath226 , defined by @xmath227\\big )      =        \\big [ \\sum_{q \\in { \\ensuremath{\\mathcal{r}}}({\\overline{\\mathbb{f}}}_{q})}\\!\\!\\ ! n_q \\pi_2(q)\\",
    "\\big ]      .\\ ] ] note that @xmath228 maps @xmath229 into @xmath230 and @xmath231 maps @xmath232 into @xmath229 for all @xmath126 .",
    "hence @xmath233 maps @xmath234 into @xmath234 , so we have an _ induced endomorphism _ @xmath235    we write @xmath236 and @xmath237 for the coordinates on the first and second factors of @xmath218 , respectively ( so @xmath238 ) . in our examples ,",
    "the correspondence @xmath219 will be defined by two equations : @xmath239 on the level of divisors , the image of a generic point @xmath54 of @xmath240 ( that is , a generic prime divisor ) under the endomorphism @xmath21 is given by @xmath241 using the relations @xmath242 and @xmath12 ( and the fact that correspondences cut out by principal ideals induce the zero homomorphism ) , we can easily replace @xmath243 and @xmath244 with cantor - reducible generators to derive the mumford representation of @xmath245 , and thus the @xmath21-division polynomials .",
    "let @xmath247 be a free parameter , and suppose that @xmath248 is not a power of @xmath14 .",
    "let @xmath249 be the family of curves of genus @xmath0 over @xmath1 considered by tautz , top , and verberkmoes in  ( * ? ? ?",
    "* example 3.5 ) , defined by @xmath250 let @xmath251 , where @xmath252 is a @xmath14th root of unity in @xmath253 .",
    "let @xmath254 be the endomorphism induced by the ( constant ) family of correspondences @xmath255 ( note that @xmath256 and @xmath254 are defined over @xmath257 , which is equal to @xmath1 if and only if @xmath258 . )",
    "the family @xmath249 has an unique point @xmath259 at infinity , which we can use to define an embedding @xmath260      \\leftrightarrow       ( x - x_p , y - y_p)\\ ] ] of @xmath249 in @xmath261 .",
    "with respect to this embedding , the @xmath254-division polynomials are @xmath262    [ proposition : ttv ] the minimal polynomial of @xmath254 is @xmath263 : that is , @xmath254 acts as multiplication by @xmath264 on  @xmath261 . a prime @xmath18 splits into two principal ideals in",
    "@xmath265 $ ] if and only if @xmath266 .",
    "the first claim is proven in  @xcite . more directly ,",
    "if @xmath267 and @xmath224 are generic points of @xmath249 , then on the level of divisors we find @xmath268 hence @xmath265 $ ] is isomorphic to the ring of integers of @xmath269 .",
    "the primes  @xmath18 splitting in @xmath269 are precisely those congruent to @xmath270 modulo @xmath14 ; and @xmath269 has class number @xmath207 , so the primes over @xmath18 are principal .",
    "the igusa invariants of @xmath249 , viewed as a point in weighted projective space , are @xmath271 ; in particular , @xmath249 has a one - dimensional image in the moduli space of curves of genus  @xmath0 .",
    "the jacobian of the curve with the same defining equation over @xmath272 is absolutely simple ( cf .",
    "* remark 15 ) ) .",
    "let @xmath273 and @xmath247 be free parameters , and consider the family of curves @xmath274 , where @xmath275 this family is essentially due to humbert ; it is equal to the family of mestre  @xcite with @xmath276 , and the family of wilson  ( * ? ? ?",
    "* proposition 3.4.1 ) with @xmath277 .",
    "the family has a full @xmath0-dimensional image in the moduli space of genus @xmath0 curves .",
    "let @xmath278 be the family of correspondences on @xmath279 defined by @xmath280 let @xmath281 be the induced endomorphism .",
    "the family @xmath282 has a unique point @xmath259 at infinity , which we can use to define an embedding @xmath260      \\leftrightarrow       ( x - x_p , y - y_p)\\ ] ] of @xmath282 in @xmath283 .",
    "with respect to this embedding , the @xmath281-division polynomials are @xmath284    [ proposition : mestrefive ] the minimal polynomial of @xmath281 is @xmath263 : that is , @xmath281 acts as multipliction by @xmath264 on",
    "@xmath283 . a prime @xmath18 splits into two principal ideals in @xmath285 $ ] if and only if @xmath286 .    the first assertion is  ( * ? ? ?",
    "* proposition 2 ) with @xmath287 ; the rest of the proof is exactly as in proposition  [ proposition : ttv ] .      for an example with @xmath289 , we present a twisted and reparametrized version of a construction due to mestre  @xcite .",
    "let @xmath273 and @xmath247 be free parameters , let @xmath290 and @xmath291 be the rational functions @xmath292 and let @xmath293 be the family of curves defined by @xmath294 the family of correspondences on @xmath295 defined by @xmath296 induces an endomorphism @xmath297 of @xmath298 .",
    "the family @xmath293 has two points at infinity , @xmath299 and @xmath300 . which are generically only defined over a quadratic extension of @xmath301 .",
    "let @xmath302 denote the divisor at infinity .",
    "we can use the rational weierstrass point @xmath303 on @xmath293 to define an embedding @xmath304      \\leftrightarrow      \\big((x - x_p)(x - v ) , y - \\frac{y_p}{x_p - v}(x - v)\\big)\\ ] ] of @xmath293 in @xmath298 ( the appropriate composition and reduction algorithms for divisor class arithmetic on genus 2 curves with an even - degree model , such as @xmath298 , appear in  @xcite . ) with respect to this embedding , the @xmath305-division polynomials are @xmath306    [ proposition : mestretwo ] the minimal polynomial of @xmath305 is @xmath307 : that is , @xmath305 acts as multiplication by @xmath308 on @xmath298 .",
    "a prime @xmath18 splits into two principal ideals in @xmath309 $ ] if and only if @xmath310 .",
    "let @xmath267 and @xmath224 be generic points of @xmath311 .",
    "an elementary but lengthy calculation shows that on the level of divisors , @xmath312 so @xmath313 ) = 2[d]$ ] for all @xmath314 $ ] in @xmath315 .",
    "hence @xmath316 $ ] , and @xmath309 $ ] is isomorphic to the maximal order of @xmath317 .",
    "the primes @xmath18 splitting in @xmath317 are precisely those congruent to @xmath270 modulo @xmath108 ; further , @xmath317 has class number 1 , so the primes over @xmath18 are principal .    as noted above",
    ", this construction is a twisted reparametrization of a family of isogenies described by mestre in  @xcite .",
    "let @xmath318 and @xmath319 be the roots of @xmath320 in @xmath321 .",
    "curves @xmath322 and @xmath323 are equal ( over @xmath324 ) to our @xmath293 and its quadratic twist by @xmath325 , respectively .",
    "we may specialize the proofs in  @xcite to show that @xmath293 has a two - dimensional image in the moduli space of curves of genus @xmath0 , and that the jacobian of the curve with the same defining equation over @xmath326 is absolutely simple .",
    "constructions of curves with rm by @xmath288 $ ] are further investigated in bending s thesis  @xcite .",
    "the algorithms described here should be readily adaptable to work with kummer surfaces instead of jacobians . in the notation of  @xcite",
    ", the kummers with parameters @xmath327 satisfying @xmath328 have rm by @xmath288 $ ] , which can be made explicit as follows : the doubling algorithm decomposes into two identical steps , since @xmath329 , and the components after one step are the coordinates of a kummer point .",
    "the step therefore defines an efficiently computable endomorphism which squares to give multiplication by 2 .",
    "we implemented our algorithm in c++ using the ntl library . for non - critical steps , including computations in quadratic fields , we used magma for simplicity . with this implementation ,",
    "the determination of @xmath32 for a curve over a 128-bit prime field takes approximately 3 hours on one core of a core2 processor at 2.83 ghz .",
    "this provides a proof of concept rather than an optimized implementation .",
    "when looking for a cryptographic curve , we used an early - abort strategy , where we switch to another curve as soon as either the order of the jacobian order or its twist can not be prime .",
    "using our adapted version of schoof algorithm , we guarantee that the group orders are not divisible by any prime that splits in the real field up to the crt bound used .    in fact",
    ", any prime that divides the group order of a curve having rm by the maximal order of @xmath104 must either be a split ( or ramified ) prime , or divide it with multiplicity 2 . as a consequence ,",
    "the early abort strategy works much better than in the classical schoof algorithm , because , it suffices to test half the number of primes up to our crt bound .",
    "we ran a search for a secure curve over a prime field of 128 bits , using a crt bound of 131 .",
    "our series of computations frequently aborted early , and resulted in 245 curves for which @xmath32 was fully determined , and for which neither the group order nor its twist was divisible by a prime less than 131 .",
    "considering these twists , this provided 490 group orders , of which 27 were prime , and therefore suitable for cryptographic use .",
    "we give here the data for one of these curves , that was furthermore twist - secure : both the jacobian and the twist jacobian order are prime .",
    "let @xmath330 , where @xmath331 , be the curve in the family @xmath249 of  [ sec : ctfamily ] specialized to @xmath332 .",
    "the characteristic polynomial @xmath32 is determined by @xmath333 giving prime group orders for the jacobian : @xmath334 and for its twist : @xmath335 we note that correctness of the orders is easily verified on random points in the jacobians .",
    "let @xmath248 be the prime @xmath336 , and consider the curve over @xmath1 from the family @xmath249 of  [ sec : ctfamily ] specialized at @xmath337 this value of @xmath247 was randomly chosen , and carries no special structure .",
    "we computed the values of the pair @xmath338 for this curve for each split prime @xmath18 up to @xmath339 ; this was enough to uniquely determine the true value of @xmath340 using the chinese remainder theorem .",
    "the numerical data for the curve follows : @xmath341 the order of the jacobian is therefore @xmath342 the total runtime for this computation was about 80 days on a single core of a core 2 clocked at 2.83 ghz . in practice",
    ", we use the inherent parallelism of the algorithm , running one prime  @xmath18 on each available core .",
    "we did not compute the characteristic polynomial modulo small prime powers ( as in  @xcite ) , nor did we use bsgs to deduce the result from partial modular information as in  [ sec : search - space ] ( indeed , we were more interested in measuring the behaviour of our algorithm for large values of  @xmath18 ) . these improvements with an exponential - complexity nature bring much less than in the classical point counting algorithms , since they have to be balanced with a polynomial - time algorithm with a lower degree . for this example",
    ", we estimate that bsgs and small prime powers could have saved a factor of about 2 in the total runtime .      for each prime @xmath18 splitting in",
    "@xmath265 $ ] , we report the degree of the @xmath162-division polynomial @xmath59 ( where @xmath162 is the endomorphism of norm @xmath18 that was used ) . by lemma  [ lemma : generator - reduction ] , @xmath343 is in @xmath145 ; the table below gives the ratio @xmath344 , thus measuring the hidden constant in the @xmath345 notation .",
    "s.  d.  galbraith , m.  c.  harrison , and d.  j.  mireles morales , ` efficient hyperelliptic arithmetic using balanced representation for divisors ' , in _ algorithmic number theory : ants - ix _ , lncs  5011 ( 2008 ) 342356                k.  matsuo , j.  chao , and s.  tsuji , ` an improved baby step giant step algorithm for point counting of hyperelliptic curves over finite fields ' , in _ algorithmic number theory : ants - v _ , lncs  2369 ( 2002 ) 46174        y.h .",
    "park , s.  jeong and j.  lim , ` speeding up point multiplication on hyperelliptic curves with efficiently - computable endomorphisms ' , in _ advances in cryptology ",
    "eurocrypt 2002 _ , lncs  2332 ( 2002 ) , 197208 ."
  ],
  "abstract_text": [
    "<S> we present an accelerated schoof - type point - counting algorithm for curves of genus  @xmath0 equipped with an efficiently computable real multiplication endomorphism . </S>",
    "<S> our new algorithm reduces the complexity of genus  @xmath0 point counting over a finite field @xmath1 of large characteristic from  @xmath2 to  @xmath3 . using our algorithm </S>",
    "<S> we compute a @xmath4-bit prime - order jacobian , suitable for cryptographic applications , and also the order of a @xmath5-bit jacobian . </S>"
  ]
}