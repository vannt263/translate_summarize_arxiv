{
  "article_text": [
    "understanding of the electronic structure of extended systems with a local perturbation , e.g. point defects in the crystal bulk @xcite or adsorption of molecules at crystal surfaces @xcite is of fundamental importance in solid state physics and chemistry .",
    "one way of calculating the electronic structure of the mentioned systems is based on the usage of so - called cluster methods in which a finite fragment of an extended system ( a quantum cluster ) is considered in detail while the rest of the system is treated at a lower level of theory @xcite .",
    "the main problem of any existing cluster based scheme is in choosing an appropriate termination of the cluster . usually , the quantum cluster is surrounded by point charges @xcite , pseudoatoms ( see , e.g. @xcite ) , link atoms @xcite or pseudopotentials @xcite . in more sophisticated methods the environment region",
    "is described by an electronic wavefunction which could be either frozen @xcite or recalculated self - consistently with that of the quantum cluster region @xcite ( a general theory of cluster embedding which comprises most of the existing cluster schemes is considered in @xcite ) .    a rather general cluster method based on overlapping ( not orthogonal ) localised orbitals",
    "is presently being developed in our laboratory .",
    "our method which is similar in spirit to some one - electron methods @xcite is based on a construction of strongly localised orbitals which are designed to represent the true electronic density of the entire system via a combination of elementary densities associated in simple cases with atoms , ions and/or bonds ; these are called _ regions _ @xcite .",
    "our intention is to create a rather general technique which can be valid for systems of different chemical character , ranging from purely ionic to strongly covalent ( excluding metals ) .",
    "therefore , the proper choice of the localisation technique as well as a general method of calculating electron density out of strongly localised non - orthogonal orbitals localised within corresponding regions are crucial for our method to work for a wide range of systems .",
    "the issue of calculating orbitals localised in appropriate regions for extreme cases of strongly ionic and covalent crystals has been considered separately @xcite .",
    "it is the main objective of this paper to discuss methods of calculating the electron density of periodic systems described via localised non - orthogonal orbitals .",
    "it should be mentioned that the literature on this topic is quite scarce which is probably explained by the lack of interest ( until recently ) to non - orthogonal ( non - canonical ) molecular orbitals : in most techniques used in the solid state community orthogonal bloch functions are employed in practical calculations .",
    "there are only a few exceptions ( see e.g. @xcite ) .",
    "if a set of non - orthogonal orbitals is used , the expression for the electron density is much more complicated since it contains an inverse of an infinite overlap matrix constructed out of the non - orthogonal orbitals of the whole system under consideration @xcite .",
    "as far as we are aware , there have only been two methods developed which enable calculation of the electron density of a periodic system from non - orthogonal orbitals .",
    "both methods are based on a series expansion of the density : while the first method @xcite relies on the so - called cluster expansion of the density , the second one @xcite is based on the power expansion of the inverse overlap matrix . in this paper",
    "we analyse only the second of the methods in detail since the first one is very complicated and much more difficult to implement . in section 2",
    "we reexamine the second method from the point of view of the correct density normalisation .",
    "then , in section 3 we suggest an alternative technique which does not require any series expansion .",
    "both methods are compared in section 4 using a very simple model system .",
    "the paper is finished with a short discussion and conclusions in section 5 .",
    "let capital letters @xmath0 , @xmath1 , etc . be used to indicate regions , while the corresponding small letters @xmath2 , @xmath3 , etc . -",
    "localised orbitals associated with them , i.e. @xmath4 , @xmath5 , etc . , see fig .",
    "[ cap : regions ] .",
    "each region may have several localised orbitals .",
    "we assume that the orbitals are real .",
    "they are expanded over atomic orbitals centred only on atoms which are inside the region border .",
    "two localised orbitals belonging to different regions are not orthogonal either because they have common atomic orbitals or , if they do not , then due to their exponential tails .",
    "each region @xmath0 is prescribed with an even number of @xmath6 electrons .",
    "thus , there is a finite number @xmath7 of double occupied orbitals associated with the given region @xmath0 .",
    "the localised orbitals @xmath8 belonging to the same region are assumed to be orthonormal ; orbitals belonging to different regions are not orthogonal , i.e the corresponding overlap integral @xmath9 is assumed to be not zero in general .",
    "note that there might be several regions within every primitive unit cell in the crystal .",
    "localised orbitals belonging to physically equivalent regions in different unit cells are obtained by appropriate lattice translations , i.e. @xmath10 , where physically equivalent regions @xmath1 and @xmath0 are separated by the translation vector @xmath11 .    in general , the spinless electron density takes on the following general form @xmath12 which contains the inverse of the overlap matrix , @xmath13 .",
    "the overlap matrix can also be written as a set of finite matrix blocks @xmath14 associated with every pair of regions .",
    "note that for an infinite crystal the matrix @xmath15 has an infinite size . as usual ,",
    "the factor of two is due to the fact that each orbital is occupied by two electrons with opposite spins .    in both summations above localised orbitals from all unit cells",
    "are taken into account . to stress the periodic symmetry of the crystal , it is useful to rewrite the density in a slightly different form:@xmath16 where we introduced a",
    "_ periodic image _ of the density ( `` density image '' for short ) :    @xmath17    where in the first sum ( indicated by a prime ) the summation is run only over localised orbitals within the single primitive cell associated with the zero lattice translation ; the other summation runs over all orbitals in the whole infinite system .",
    "note that the density image is normalised on the number of electrons in the unit cell only : @xmath18      following the original prescription by lwdin @xcite , we present the overlap matrix as @xmath19 , where the matrix @xmath20 is the same as the original overlap matrix except for its elements when @xmath21 which are all equal to zero , @xmath22 .",
    "then , one can formally write a matrix expansion : @xmath23 one can show ( using diagonalisation of the matrix @xmath15 or its expansion over the eigenstates ) that the expansion ( [ eq : expansion - for - s^(-1 ) ] ) can only be used if absolute values of _ all _ eigenvalues of the matrix @xmath24 are less than unity .    using expansion of eq .",
    "( [ eq : expansion - for - s^(-1 ) ] ) , one obtains the following expansion for the image density ( [ eq : image - density]):@xmath25\\label{eq : image - density - expansion}\\ ] ] note that a general @xmath26-th order term ( for @xmath27 ) contains additional @xmath28 summations over all regions due to matrix multiplications in @xmath29 .    in principle , formulae ( [ eq : ro - via - translations ] ) and ( [ eq : image - density - expansion ] ) allow an approximate calculation of the electron density by terminating the infinite expansion .",
    "care should be taken , however , in doing so in order to preserve the correct normalisation of the density .",
    "the zero order contribution , @xmath30 does not contain overlap integrals at all and is normalised to the total number of electrons in the unit cell . therefore , if any higher order terms are kept in the terminated expansion ( [ eq : image - density - expansion ] ) , they should be integrated ( normalised ) to zero . consider this point in more detail .",
    "the first order contribution to the image density,@xmath31 contains different regions @xmath32 and thus its contribution to the charge ( or normalisation ) becomes : @xmath33 where the trace @xmath34 here is calculated with respect to the localised orbitals belonging to region @xmath0 only . we see that the first order term has a finite nonzero charge ( in fact , it is negative ) .    any higher order contributions in eq .",
    "( [ eq : image - density - expansion ] ) for @xmath27 contains additional summations over regions so that equal regions @xmath21 in the double summation there are also possible .",
    "therefore , every such contribution , @xmath35 , will be split into two terms : a diagonal term , @xmath36 in which @xmath21 , and a non - diagonal term , @xmath37 associated with @xmath32 in eq .",
    "( [ eq : image - density - expansion ] ) .",
    "correspondingly , we obtain the following contributions to the charge : @xmath38 @xmath39    thus , we see that in any order @xmath27 we have @xmath40 .",
    "this means that the non - diagonal contribution to the density ( [ eq : n - order - nondiag ] ) is compensated exactly by the diagonal one ( [ eq : n - order - diag ] ) of the next order .",
    "for instance , the non - zero charge ( [ eq : charge-1 ] ) is to be exactly eliminated by a charge due to the diagonal second order density ; in turn , a nonzero charge due to non - diagonal second order density is compensated exactly by the diagonal third order density contribution , and so on .",
    "this result is very useful since it allows one to balance properly a terminated expansion for the image density so that it would correspond ( in any order ! ) to the correct total charge . to do this , the final expression for",
    "the density of any @xmath26-th order should also include the diagonal ( @xmath21 ) term from the contribution of the next order .",
    "we stress that this fact was ignored in the previous applications of this method @xcite .",
    "we obtain , that the correct @xmath41th order expansion for the image density in the notations of eqs .",
    "( [ eq : n - order - diag ] ) , ( [ eq : n - order - nondiag ] ) should have the form : @xmath42}(\\mathbf{r},\\mathbf{r^{\\prime}})\\equiv\\sum_{i=0}^{n}\\left[\\rho_{d}^{(i)}(\\mathbf{r},\\mathbf{r^{\\prime}})+\\rho_{nd}^{(i)}(\\mathbf{r},\\mathbf{r^{\\prime}})\\right]+\\rho_{d}^{(n+1)}(\\mathbf{r},\\mathbf{r^{\\prime}})\\label{eq : final - n - order - density}\\ ] ] by employing this termination of the series , the normalisation condition ( [ eq : image - normalisation ] ) is satisfied exactly .",
    "thus , in order to calculate the density up to the @xmath41th order , one has to calculate the matrix elements @xmath43 of the matrix @xmath44 for all powers @xmath45 ; in addition , one also need diagonal @xmath21 elements of @xmath46 .",
    "then , the contributions from all density images corresponding to all lattice translations , eq . ( [ eq : ro - via - translations ] ) , are to be added together to get the final electron density .",
    "the method described here relies on the convergence of the density expansion ( [ eq : image - density - expansion ] ) .",
    "the better localisation of the orbitals @xmath8 , the faster convergence and thus smaller number of terms is needed .",
    "we shall demonstrate in section [ sec : results ] that in some cases of not very well localised orbitals one has to consider the density expansion up to a very high order which makes the calculation extremely time - consuming .",
    "moreover , if the orbitals localisation becomes worse than a certain criteria ( to be also discussed in section [ sec : results ] ) , then this method fails altogether as the expansion diverges .",
    "a general and an extremely efficient technique which is not based on a perturbative expansion of any kind and can be used for localised orbitals of practically any degree of localisation is suggested in the next subsection .      in eq .",
    "( [ eq : density - via - non - othg ] ) for the electron density , regions @xmath0 and @xmath1 are to be chosen from all unit cells of the infinite periodic system .",
    "it is convenient in this section to identify explicitly the lattice vector for every localised orbital in its index . therefore ,",
    "in the following we shall use letters @xmath0 , @xmath1 , etc . only for regions within the zeroth unit cell ; in particular , the orbital @xmath8 is assumed to be from the zeroth cell .",
    "localised orbitals from other cells are characterised by the combined index @xmath47 , i.e. @xmath48 is the @xmath2-th localised orbital from region @xmath0 in the unit cell separated from the zeroth cell by the lattice translation @xmath11 .",
    "correspondingly , eq . ( [ eq : density - via - non - othg ] ) is rewritten in the following way : @xmath49 where @xmath11 and @xmath50 are two lattice translations .",
    "a further transformation is possible here since the overlap integral @xmath51 depends in fact only on the difference @xmath52 of the lattice translations .",
    "this allows expansion of the overlap integral into the fourier integral    @xmath53    where the summation is performed over @xmath54 points @xmath55 in the first brillouin zone ( bz ) and @xmath56 is the corresponding fourier image .",
    "the direct lattice summation in the last formula is easily terminated due to ( usually ) exponential decay of the overlap integrals between localised orbitals .    using the fourier representation of the overlap matrix",
    ", one can exactly calculate its inverse as follows : @xmath57_{aa , bb}e^{-\\textrm{i}\\mathbf{k}(\\mathbf{l}-\\mathbf{m})}\\label{eq : inv - overl - via - k - sum}\\ ] ] note that the matrix @xmath58 has a finite size of the number of localised orbitals per unit cell .",
    "therefore , in order to calculate the inverse of the overlap matrix in direct space , one has to perform the calculation of @xmath59 for finite size matrices for every @xmath55 point necessary to sample the bz . substituting eq .",
    "( [ eq : inv - overl - via - k - sum ] ) into eq .",
    "( [ eq : density - via - transl ] ) , we arrive at the following final expression for the electron density : @xmath60_{aa , bb}\\varphi_{bb}^{*}(\\mathbf{r^{\\prime}},\\mathbf{k})\\right\\ } \\label{eq : final - density}\\ ] ] where @xmath61 is the fourier expansion of the localised orbital . due to exponential decay of the localised orbitals , the summation over lattice vectors @xmath11 in the last expression",
    "is in fact finite .",
    "the obtained formula for the density is exact . in particular",
    ", it contains the periodicity of the lattice built in .",
    "it is also extremely convenient for numerical implementation .",
    "indeed , what is needed is the calculation of the fourier images , according to eq .",
    "( [ eq : orbital - fourier - exp ] ) , of every localised orbital in the primitive unit cell for every @xmath55 point .",
    "the summations in the curly brackets in eq .",
    "( [ eq : final - density ] ) are finite ( limited to the orbitals within the zeroth cell only ) and are thus easily performed .",
    "the extend to which the orbitals @xmath8 are localised is reflected by the number of cells to be taken into account while performing the lattice summations in eqs .",
    "( [ eq : k - overlap - via - direct - sum ] ) and ( [ eq : orbital - fourier - exp ] ) . even for orbitals which are not very well localised ,",
    "the amount of work needed to perform these lattice summations is incomparable with the cost of the first method ( section [ sub : s^(-1)_method ] ) which requires including more terms in the perturbation expansion if the localisation is not good enough .",
    "atomic units are used throughout this section .",
    "the application of the two methods considered in the previous sections is illustrated here on a simple cubic lattice model containing a single region in every unit cell .",
    "the lattice constant @xmath2 will be assumed to be equal to 1 a.u . for simplicity .",
    "each region is represented by a single localised orbital in a form of a normalised @xmath62 type gaussian    @xmath63    by choosing various values for the exponent @xmath64 , one can vary the degree of localisation of the orbitals .",
    "indeed , the size of the _ spatial extent _ of the orbital can be measured in terms of @xmath65 , which corresponds to @xmath660.1 .",
    "we found this approach more convenient in our particular case than the application of the existing localisation criteria ( see , e.g. @xcite ) .    for this model system",
    "it is possible to do some preliminary analytical estimates of the convergence of the series ( [ eq : expansion - for - s^(-1 ) ] ) .",
    "we know from section [ sub : s^(-1)_method ] that the series will converge if _ all _ eigenvalues @xmath67 of the matrix @xmath68 are between -1 and 1 .",
    "it is easy to notice that the eigenvalues are in fact given by the fourier transforms @xmath69 of the matrix @xmath24 which is introduced much in the same way as @xmath70 in eq .",
    "( [ eq : k - overlap - via - direct - sum ] ) . indeed , because @xmath71 , one can write :    @xmath72    this is nothing but the eigenproblem for the matrix @xmath24 with @xmath69 being its eigenvalues ( numbered by vectors @xmath55 from the bz ) and @xmath73 - eigenvectors .",
    "therefore , the convergence criteria for the series ( [ eq : expansion - for - s^(-1 ) ] ) reduces to the inequalities @xmath74 which should be valid for _ any _ @xmath55 . taking into account the overlap only between nearest neighbours ,",
    "we obtain :    @xmath75 with the overlap between neighbouring orbitals being @xmath76 .",
    "this results in the following criterion for the convergence of the lwdin expansion ( for @xmath771 a.u . ) :    @xmath78    similar analysis which takes into account the next nearest neighbours gives a very similar estimate of @xmath79 .",
    "these estimates correspond to the maximum spatial extent of the orbitals ( [ eq : psi_loc ] ) of the order of @xmath800.76 a.u .",
    ", i.e. there is very small overlap between neighbouring orbitals which , we recall , are separated by 1 a.u . in the lattice .    the other method based on the fourier transform of the orbitals",
    "has also its limits which are hidden in the formulae ( [ eq : k - overlap - via - direct - sum ] ) and ( [ eq : orbital - fourier - exp ] ) : if a certain cut - off @xmath81 for the direct lattice summation @xmath11 is assumed in the calculation of @xmath82 and @xmath83 , then there will be some limitations on the allowed degree of localisation of the orbitals .",
    "the required criterion can be worked out e.g. by analysing the fourier transform ( [ eq : orbital - fourier - exp ] ) of the orbital at its maximum in the centre of the bz ( i.e. of @xmath84 ) as follows:@xmath85 replacing the sums by the corresponding volume integrals , we obtain the following criterion : @xmath86 where @xmath87 .",
    "the inequality above is satisfied if @xmath88 , i.e. @xmath89 .",
    "assuming that @xmath90 is equal to 4@xmath915 lattice constants , we obtain the necessary condition for the exponent of the localised orbitals ,    @xmath92    for which our fourier transform method should work . the obtained critical value of @xmath93 results in the maximum spatial extent of the orbitals of the order of @xmath803.4 a.u . which corresponds to very diffuse orbitals spreading over more than six unit cells .",
    "similar criteria is obtained for the ovelrap integrals as well .",
    "thus , the method we suggest should have a much wider range of applicability than the lwdin method as far as the degree of localisation of the non - orthogonal orbitals is concerned since @xmath94 .",
    "this conclusion is also supported by our numerical calculations which we now describe .",
    "numerical calculations of the necessary powers of the @xmath24 matrix needed for the lwdin method were done in the following way . since",
    "the density is calculated in the same point @xmath95 in eqs .",
    "( [ eq : n - order - diag ] ) , ( [ eq : n - order - nondiag ] ) and ( [ eq : final - n - order - density ] ) , the regions @xmath0 and @xmath1 in these equations are either the same or not far away from each other . therefore , to calculate @xmath96 one can simply choose a sufficiently big finite cluster of atoms ( in fact , the cluster radius should be at least of the order of @xmath97 , where @xmath98 is the decay length of the overlap integral ) with regions @xmath0 and @xmath1 somewhere in its centre and then calculate the complete ovelrap matrix for it , @xmath99 . then , by performing the necessary @xmath28 matrix multiplications , one can calculate @xmath96 as @xmath100 .",
    "when using the fourier transform method , we employed the monkhorst - pack ( mp ) method @xcite for the @xmath55 point sampling and the same cut - off distance for the direct lattice summations in eqs .",
    "( [ eq : k - overlap - via - direct - sum ] ) and ( [ eq : orbital - fourier - exp ] ) as in the previous method . in all our calculations we used the 4x4x4 mp set which was found to be sufficient in all cases .",
    "results of our calculations for a large value of the exponent ( @xmath101 ) are shown in fig.[fig : alpha_10 ] .",
    "this case corresponds to strongly localised orbitals as is the case in ionic systems such as mgo and nacl .",
    "overlap between orbitals is negligible and even zero order approximation lwdin method , eq .",
    "( [ eq:0-order - density ] ) , was found sufficient to give the correct density .",
    "density curves for both methods are indistinguishable from each other .",
    "the calculated densities in the intermediate case ( @xmath102 ) are shown in fig .",
    "[ fig : alpha_4 ] .",
    "this value of @xmath64 may correspond to ion - covalent and covalent systems .",
    "one can see that high order approximations ( up to @xmath1038 ) of the lwdin method , eq .",
    "( [ eq : final - n - order - density ] ) , are needed here to converge the density and thus the calculation is quite time consuming .    finally , we show in fig .",
    "[ fig : alpha_2 ] the densities calculated using both methods for orbitals which are least localised when @xmath104 .",
    "the density , obtained using the fourier transform method , eq .",
    "( [ eq : final - density ] ) , is spread almost uniformly in the crystal volume and thus may correspond to a metallic band . at the same time , the lwdin expansion method , eq .",
    "( [ eq : final - n - order - density ] ) , does not converge at all and the density is clearly diverges .    one can expect that the latter situation can happen only for metallic systems .",
    "interestingly , our calculations ( not reported here ) for such a realistic covalent system as a crystalline si show that the lwdin approach also fails in some cases when the orbitals are not sufficiently localised . note that various degree of localisation of the orbitals can be obtained using different localisation techniques and different choice of regions , see @xcite for more details .",
    "in summary , we have considered two numerical methods which allow calculation of the electron density of a 3d periodic system constructed via a set of non - orthogonal localised orbitals .",
    "the first , so - called lwdin , method based on the power expansion of the inverse of the overlap matrix has been found to be efficient only for strongly localised orbitals . for an intermediate degree of orbitals localisation",
    "this method has been found to be quite computationally demanding since many terms in the series are to be retained .",
    "however , if orbitals are not sufficiently localised ( the exact criterion has also been suggested ) , the method fails altogether and the power expansion has been shown to be divergent .",
    "then , we have suggested another method based on the fourier transform of the localised orbitals which involves calculations of inverse of only finite matrices and a @xmath55 point summation over the brillouin zone .",
    "this method is computationally much less demanding and does not have any convergency problems . using a simple model for the crystal electron density represented via a set of gaussian @xmath62 type orbitals in a simple cubic lattice ( one orbital per unit cell ) , we have shown that our method works equally well within a rather wide range of orbitals having different localisation , whereas the first method fails for a relatively weakly localised orbitals .",
    "the application of the fourier transform method to realistic systems such as mgo and si perfect crystals is published elsewhere @xcite .",
    "we are extremely grateful to i. v. abarenkov and i. tupitsin for useful and stimulating discussions .",
    "o.d . would also like to acknowledge the financial support from the leverhulme trust ( grant f/07134/s ) which made this work possible ."
  ],
  "abstract_text": [
    "<S> methods for calculating an electron density of a periodic crystal constructed using non - orthogonal localised orbitals are discussed . </S>",
    "<S> we demonstrate that an existing method based on the matrix expansion of the inverse of the overlap matrix into a power series can only be used when the orbitals are highly localised ( e.g. ionic systems ) . </S>",
    "<S> in other cases including covalent crystals or those with an intermediate type of chemical bonding this method may be either numerically inefficient or fail altogether . instead , we suggest an exact and numerically efficient method which can be used for orbitals of practically arbitrary localisation . </S>",
    "<S> theory is illustrated by numerical calculations on a model system . </S>"
  ]
}