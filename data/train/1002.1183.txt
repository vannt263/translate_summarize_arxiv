{
  "article_text": [
    "lattice paths arise in several areas in probability and combinatorics , either in their own interest ( as realizations of random walks , or because of their interesting combinatorial properties : see @xcite for the latter ) or because of fruitful bijections with various families of trees , tilings , words .",
    "the problem we discuss here is to efficiently sample uniform ( or _ almost _ uniform ) paths in a family of paths with constraints .",
    "there are several reasons for which one may want to generate uniform samples of lattice paths : to make and try conjectures on the behaviour of a large `` typical '' path , test algorithms running on paths ( or words , trees , ... ) . in view of random sampling ,",
    "it is often very efficient to make use of the combinatorial structure of the family of paths under study . in some cases , this yields linear - time ( in the length of the path ) _ ad - hoc _ algorithms @xcite .",
    "however , the nature of the constraints makes sometimes impossible such an approach , and there is a need for robust algorithms that work in lack of combinatorial knowledge .",
    "luby , randall and sinclair @xcite design a markov chain that generate sets of non - intersecting lattice paths .",
    "this was motivated by a classical ( and simple , see illustrations in @xcite ) correspondence between dimer configurations on an hexagon , rhombae tilings of this hexagon and families of non - intersecting lattice paths . as the first step for the analysis of this chain , wilson @xcite introduces a peak / valley markov chain ( see details below ) over some simple lattice paths and obtain sharp bounds for its mixing time .",
    "we present in this paper a variant of this markov chain , which is valid for various constraints and whose analysis is simple .",
    "it generates an `` almost '' uniform path of length @xmath0 in @xmath1 steps , this bound makes use of a certain _ contraction property _ of the chain .",
    "appart from the algorithmic aspect , the peak / valley process seems to have a physical relevancy as a simplified model for the evolution of _ quasicrystals _ ( see a discussion on a related process in the introduction of @xcite ) . in particular",
    ", the mixing time of this markov seems to have some importance .       associated with the word @xmath2.,width=151 ]    we fix three integers @xmath3 , and consider the paths of length @xmath0 , with steps @xmath4 , that is , the words of @xmath0 letters taken in the alphabet @xmath5 .",
    "such a word @xmath6 is identified to the path @xmath7 .    to illustrate the methods and the results , we focus on some particular sub - families @xmath8 :    1 .",
    "discrete _ meanders _ , denoted by @xmath9 , which are simply the non - negative paths : @xmath10 if for any @xmath11 we have @xmath12 .",
    "this example is mainly illustrative because the combinatorial properties of meanders make it possible to perform exact sampling very efficiently ( an algorithm running in @xmath13 steps is given in @xcite , an order that we can not get in the present paper ) .",
    "2 .   paths with _",
    "walls_. a path with a wall of height @xmath14 between @xmath15 and @xmath16 is a path such that @xmath17 for any @xmath18 ( see fig .",
    "[ fig : cheminmur ] for an example ) .",
    "these are denoted by @xmath19 , they appear in statistical mechanics as toy models for the analysis of random interfaces and polymers ( see examples in @xcite ) .",
    "excursions _ , denoted by @xmath20 , which are non - negative paths such that @xmath21 . in the case @xmath22 , these correspond to well - parenthesed words and are usually called dyck words . in the general case ,",
    "duchon @xcite proposes a rejection algorithm which generates excursions in linear time .",
    "_ culminating paths _ of size @xmath0 , denoted further by @xmath23 , which are non - negative paths whose maximum is attained at the last step : for any @xmath24 we have @xmath25 .",
    "they have been introduced in @xcite , motivated in particular by the analysis of some algorithms in bioinformatics .    , with a wall of height @xmath26 between @xmath27 and @xmath28.,width=245 ]",
    "we will consider markov chains in a family @xmath29 , where all the probability transitions are symmetric .",
    "for a modern introduction to markov chains , we refer to @xcite .",
    "hence we are given a transition matrix @xmath30 of size @xmath31 with @xmath32    [ lem : unif ] if such a markov chain is irreducible , then it admits as unique stationary distribution the uniform distribution @xmath33 on @xmath29 .    the equality @xmath34 holds for any two vertices @xmath35 .",
    "this shows that the probability distribution @xmath36 is reversible for @xmath30 , and hence stationary .",
    "it is unique if the chain is irreducible .",
    "this lemma already provides us with a scheme for sampling an almost uniform path in @xmath29 , without knowing much about @xmath29 . to do so",
    ", we define a `` flip '' operator on paths , this is an operator @xmath37 when @xmath38 the path @xmath39 is defined as follows : if @xmath40   then these two steps are changed into @xmath41 .",
    "the @xmath42 other steps remain unchanged . if @xmath43 then @xmath44 .",
    "note that in the case @xmath38 the value of @xmath45 does not depend on @xmath46 .    for the case",
    "@xmath47 , if @xmath48 , we define @xmath49 as before as if there would be a @xmath50 as the end if the path .",
    "for instance , in the case where @xmath51 , the path @xmath52 , the @xmath0-th step is turned into @xmath53 .",
    "the path @xmath54 is defined equally : if @xmath55 and @xmath56 , it turns into .",
    "when @xmath57 , one flips as if there would be a @xmath58 at the end of the path .    for culminating paths , we have to take another definition of @xmath59 , see section [ sec : analysis ] .",
    "we are also given a probability distribution @xmath60 , and we assume that @xmath61 for each @xmath24 .",
    "we will consider a particular sequence @xmath62 later on , but at this point we can take the uniform distribution in @xmath63 .",
    "we describe the algorithm below in algorithm [ algo : cm ] .",
    "initialize @xmath64 @xmath65",
    "r.v . with law @xmath62",
    "@xmath66 i.i.d .",
    "uniform r.v . in @xmath67 @xmath68 i.i.d .",
    "uniform r.v . in @xmath69 @xmath70    in words ,",
    "this algorithm performs the markov chain in @xmath29 with transition matrix @xmath71 defined as follows : @xmath72    denote by @xmath73 the random path obtained after the @xmath74-th run of the loop in algorithm [ algo : cm ] .",
    "when @xmath75 , the sequence @xmath73 converges in law to the uniform distribution in @xmath29 .",
    "moreover , the execution of algorithm [ algo : cm ] until time @xmath76 is linear in @xmath76 .",
    "for the first claim , we have to check that the chain is aperiodic and irreducible .",
    "aperiodicity comes from the ( many ) loops .",
    "irreducibility will follow from lemma [ lem : geodesique ] .",
    "for the second claim , notice that the time needed for the test `` @xmath77 is in @xmath29 '' can be considered as constant , since for the families @xmath9 and @xmath20 we only have to compare @xmath78 while for the family @xmath79 we only have to compare @xmath80 with the height of the wall at @xmath24 . for the case of the culminating paths ,",
    "see below in section [ sec : analysis ] .",
    "we now choose the distribution @xmath81 . instead of @xmath82",
    ", we will use the probability distribution defined by@xmath83 where @xmath84 we let the reader check that @xmath85 is indeed a probability distribution .",
    "the reason for which we use this particular distribution will appear in the proof of proposition [ lem : courbure ] .",
    "we will then need the following relation : for each @xmath86 , @xmath87 for algorithm [ algo : cm ] to be efficient , we need to know how @xmath88 is close in law to @xmath36 .",
    "this question is related to the spectral properties of the matrix @xmath89 .",
    "in particular , the speed of convergence is governed by the spectral gap ( _ i.e. _  @xmath90 , where @xmath91 is the largest of the modulus of the eigenvalues different from one , see @xcite for example ) , but this quantity is not known in general .",
    "some geometrical methods @xcite allow to bound from below @xmath90 , but they assume a precise knowledge of the structure of the graph defined by the chain @xmath89 .",
    "it seems that such results do not apply here .",
    "instead , we will study the metric properties of the chain @xmath89 with respect to a natural distance on @xmath29 , and show that it satisfies a certain _ contraction property_.      unchanged , our markov chain @xmath89 can not generate culminating paths since the path @xmath92 would then be isolated : it has no peak / valley and @xmath93 which is not culminating .",
    "thus we propose a slight modification for the family @xmath23 .",
    "we only change the definition of @xmath94 when @xmath47 ( it wo nt depend on @xmath46 ) .",
    "since the maximum is reached at @xmath0 , the @xmath95 last steps are necessarily @xmath96 we thus define @xmath97 as the path obtained by changing the @xmath95 last steps into @xmath98 ( regardless of their initial values in @xmath99 ) and @xmath100 as the path obtained by changing the @xmath95 last steps into @xmath101 .    notice that despite this change the execution time of each loop of algorithm [ algo : cm ] is still a @xmath102 :    * if @xmath103 , the time needed for the test `` @xmath104 is in @xmath29 '' can be considered as constant , since we only have to compare @xmath105 . *",
    "if @xmath106 , the new value @xmath107 is compared with the maximum of @xmath108 , which can be done in @xmath109 . fortunately , this occurs with probability @xmath110 , so that the time - complexity of each loop is , on average , a @xmath102 .",
    "going back to a more general setting , we consider a markov chain in a finite set @xmath111 , endowed with a metric @xmath112 . for a vertice @xmath113 and a transition matrix @xmath89 ,",
    "we denote by @xmath114 ( resp .",
    "@xmath115 ) the law of the markov chain associated with @xmath89 at time @xmath116 ( resp .",
    "@xmath74 ) , when starting from @xmath117 . for @xmath118 , the main assumption made on @xmath89",
    "is that there is a coupling between @xmath119 ( that is , a random variable @xmath120 with @xmath121 ) such that @xmath122\\leq ( 1-\\kappa)d(x , y),\\ ] ] for some @xmath123 , which is called the _",
    "ricci curvature _ of the chain , by analogy with the ricci curvature in differential geometry ; here we should rather say that ricci curvature is larger than @xmath124 . ] . if the inequality holds , then it implies ( @xcite , p.189 ) that @xmath89 admits a unique stationary measure @xmath36 and that , for any @xmath117 , @xmath125 where @xmath126 is the diameter of the graph with vertices @xmath111 induced by the markov chain . the notation @xmath127 stands , as usual , for the _ total variation _ distance over the probability distributions on @xmath111 defined by @xmath128 hence , a positive ricci curvature gives the exponential convergence to the stationary measure , with an exact ( _ i.e. _   is non - asymptotic in @xmath74 ) bound .",
    "in many situations , a smart choice for the coupling between @xmath129 gives a sharp rate of convergence in eq .",
    "( see some striking examples in @xcite ) .      to apply the ricci curvature machinery",
    ", we endow each @xmath29 with the @xmath130-distance @xmath131 ( notice that @xmath132 is always a multiple of @xmath133 . ) for our purpose , it is fundamental that this metric space is _",
    "geodesic_.    a markov chain @xmath89 in a finite set @xmath111 is said to be _ geodesic _ with respect to the distance @xmath112 on @xmath111 if for any two @xmath118 with @xmath134 , there exist @xmath135 vertices @xmath136 in @xmath111 such that for each @xmath24    * @xmath137 ; * @xmath138 and @xmath139 are neighbours in the markov chain @xmath89 ( _ i.e. _  @xmath140 ) .",
    "this implies in particular that @xmath89 is irreducible and that the diameter of @xmath89 is smaller than @xmath141 .",
    "[ lem : geodesique ] for each family @xmath23,@xmath79,@xmath20,@xmath9 the markov chain of algorithm [ algo : cm ] is geodesic with respect to @xmath142 .",
    "the proof goes by induction on @xmath143 .",
    "we fix @xmath144 ( and denote by @xmath145 the corresponding words ) ; we want to decrease @xmath146 by one , by applying the operator @xmath45 with proper @xmath147 .",
    "we denote by @xmath148 the first index for which @xmath144 .",
    "for instance we have @xmath149 .",
    "let @xmath150 be the position of the left - most peak in @xmath76 in @xmath151 , if such a peak exists .",
    "then @xmath152 is also in @xmath29 : it is immediate for the families @xmath153 .",
    "we have @xmath154 .    if there is no peak in @xmath76 after @xmath155 , then @xmath156 .",
    "hence we try to increase the final steps of @xmath108 by one . to do so",
    ", we choose @xmath157 if @xmath158 , or @xmath159 where @xmath150 is the position of the right - most @xmath58 otherwise ( we choose the right - most one to ensure that @xmath160 remains culminating in the case where @xmath161 . ) .    for meanders , excursions and walls",
    ", we will show that the ricci curvature of @xmath89 with respect to the distance @xmath142 is ( at least ) of order @xmath162 .",
    "[ lem : courbure ] for the three families @xmath163 , the ricci curvature of the associated markov chain , with weights @xmath81 defined as in , is larger than @xmath164 .",
    "fix @xmath165 in @xmath166 , we first assume that @xmath165 are neighbours , for instance @xmath167 for some @xmath24 .",
    "let @xmath168 be the random variable in @xmath169 whose law is defined by @xmath170 where @xmath171 is a r.v .",
    "taking values in @xmath63 with distribution @xmath62 and @xmath172 is uniform in @xmath67 . in other words",
    ", we run one loop of algorithm [ algo : cm ] simultaneously on both paths .",
    "we want to show that @xmath173 are , on average , closer than @xmath165 .",
    "different cases may occur , depending on @xmath171 and on the index @xmath24 where @xmath165 differ .",
    "*  *    *  * this occurs with probability @xmath174 and , no matter the value of @xmath172 , we have @xmath175 .",
    "*  * we consider the case @xmath176 .",
    "since @xmath99 and @xmath177 coincide everywhere but in @xmath24 , we necessarily have one of these two cases :    * there is a peak in @xmath99 at @xmath176 and neither a peak nor a valley in @xmath177 at @xmath176 ( as in the figure on the right ) ; * there is a valley in @xmath177 at @xmath176 and neither a peak nor a valley in @xmath99 at @xmath176 .    in the first case for instance , then we may have @xmath178 if @xmath179 , while the distance remains unchanged if @xmath180 .",
    "the case @xmath181 is identical .",
    "this shows that with a probability smaller than @xmath182 we have @xmath178 .",
    "*  * in this case , @xmath99 and @xmath177 are possibly modified in @xmath171 , but if there is a modification it occurs in both paths .",
    "it is immediate since for the families @xmath9,@xmath79 and @xmath20 since the constraints are local .",
    "*  * in this case , it is easy to check that , because of our definition of @xmath49 , we have @xmath183 \\leq 1-p_{n-1}+p_{n-2}/2+p_{n}/2 = 1-\\kappa_0.\\ ] ]    *  * we have @xmath183 \\leq 1+p_{n-1}/2-p_{n}/2=1-\\kappa_0.\\ ] ]    thus , we have proven that when @xmath165 only differ at @xmath24 @xmath184 & \\leq 2\\times(p_{i-1}/2+p_{i+1}/2 ) + 0\\times",
    "p_i+1\\times(1-p_i - p_{i-1}/2-p_{i+1}/2)\\label{eq : accroissement}\\\\ & \\leq ( 1-\\kappa_0)\\times 1=(1-\\kappa_0)d_1(s , t)\\notag.\\end{aligned}\\ ] ] what makes ricci curvature very useful is that if this inequality holds for pairs of neighbours then it holds for any pair , as noticed in @xcite .",
    "indeed , take @xmath135 paths @xmath185 as in lemma [ lem : geodesique ] and apply the triangular inequality for @xmath142 : @xmath186 & \\leq \\sum_{i=0}^{k-1 } \\mathbb{e}\\left[d_1(\\phi(s_i,\\mathcal{i},{e}),\\phi(s_{i+1},\\mathcal{i},e))\\right]\\\\ & \\leq ( 1-\\kappa_0)k=(1-\\kappa_0)d_1(s , t).\\end{aligned}\\ ] ]    it is easy to exhibit some @xmath187 such that ineq .",
    "is in fact an equality . in the case where @xmath82 , this equality reads @xmath188=d_1(s , t)$ ] , and we can not obtain a positive ricci curvature ( though this does not prove that there is not another coupling or another distance for which we could get a @xmath123 in the case @xmath82 . ) .",
    "we recall that for each family @xmath29 , @xmath189 . hence , combining proposition [ lem : courbure]with eq .",
    "gives our main result :    [ th : mix ] for meanders , excursions and path with walls , algorithm [ algo : cm ] returns an almost uniform sample of @xmath36 , as soon as @xmath190 .",
    "precisely , for any itinialization of algorithm [ algo : cm ] , @xmath191    another formulation of this result is that the mixing time of the associated markov chain , defined as usual by @xmath192 ( @xmath193 is here by convention ) , is smaller than @xmath194 . for culminating paths ,",
    "the argument of case 1c fails and does not hold , we are not able to prove such a result as theorem [ th : mix ] .",
    "however , it seems empirically that the mixing time is also of order @xmath195 ( with a constant strongly dependent on @xmath196 ) . a way to prove",
    "this could be the following observation : take @xmath197 two any culminating paths , and define @xmath198 where @xmath199 are those in algorithm [ algo : cm ] .",
    "the sequence @xmath200 is decreasing throughout the process . unfortunately we can not get a satisfactory bound for the time needed for this quantity to decrease by one .",
    "bounding mixing times via a contraction property over the transportation metric is quite a standard technique , the main ideas dating back to dobrushin ( 1950 s ) .",
    "a modern introduction is made in @xcite . for geodesic spaces",
    ", this technique has been developped in @xcite under the name _",
    "path coupling_.    as mentioned in the introduction , the markov chain @xmath89 on lattice paths with uniform weights @xmath82 has in fact already been introduced for paths starting and ending at zero ( sometimes called _ bridges _ ) in @xcite , and its mixing time has been estimated in @xcite .",
    "wilson also proves a mixing time of order @xmath195 , by showing that holds with a different distance ( namely , a kind of fourier transform of the heights of the paths ) do not have the same meaning in wilson s paper : @xmath53 ( resp .",
    "@xmath201 ) stands for the number of positive ( resp .",
    "negative ) steps . ] .",
    "this is the concavity of this fourier transform which gives a good mixing time , exactly as the concavity of our @xmath174 s speeds up the convergence of our chain .",
    "wilson s method is developped only for bridges in @xcite and it is not completely straightforward to use it when the endpoints are not fixed .",
    "for instance , take @xmath202 and @xmath22 , and consider the paths @xmath203 and @xmath204 .",
    "there are more `` bad moves '' ( moves that take away these paths ) than `` good moves '' .",
    "propp - wilson s coupling from the past ( cftp ) @xcite is a very general procedure for the exact sampling of the stationary distribution of a markov chain .",
    "it is efficient if the chain is monotonous with respect to a certain order relation @xmath205 on the set @xmath111 of vertices , with two extremal points denoted @xmath206 ( _ i.e. _  such that @xmath207 for any vertex @xmath117 ) .",
    "this is the case here for each family @xmath23,@xmath79,@xmath20,@xmath9 , with the partial order @xmath208 for the family @xmath209 with @xmath210 for instance , we have @xmath211    we describe cftp , with our notations , in algorithm [ algo : cftp ] .",
    "@xmath213 @xmath214 i.i.d .",
    "r.v . with law @xmath62 @xmath215 i.i.d .",
    "uniform r.v . in @xmath67 @xmath216 i.i.d .",
    "uniform r.v . in @xmath69 @xmath217 @xmath212 ,",
    "@xmath213 @xmath77 is in @xmath29 * then * @xmath218 @xmath219 is in @xmath29 * then * @xmath220 @xmath221    we refer to ( @xcite , chap.10 ) for a very clear introduction to cftp , and we only outline here the reasons why this indeed gives an exact sampling of the stationary distribution .    * the output of the algorithm ( if it ever ends ! )",
    "is the state of the chain @xmath89 that has been running `` since time @xmath222 '' , and thus has reached stationnarity . *",
    "the exit condition @xmath223 ensures that it is not worth running the chain from @xmath76 steps earlier , since the trajectory of any lattice path @xmath224 is `` sandwiched '' between those of @xmath206 , and therefore ends at the same value .     at time",
    "@xmath225 do nt meet before time zero , while those starting at time @xmath226 do.,width=245 ]    [ prop : cftp ] algorithm [ algo : cftp ] ends with probability @xmath116 and returns an exact sample of the uniform distribution over @xmath29 .",
    "for the families @xmath79,@xmath20,@xmath9 , this takes on average @xmath227 time units .",
    "let us mention that in the case where the mixing time is not rigorously known , algorithm [ algo : cftp ] ( when it ends ) outputs an exact uniform sample and therefore is of main practical interest compared to mcmc .",
    "it is shown in @xcite that algorithm [ algo : cftp ] returns an exact sampling in @xmath228 runs of the chain , where @xmath229 is defined in and @xmath230 is the length of the longest chain of states between @xmath231 and @xmath232 .",
    "it is a consequence of the proof of lemma [ lem : geodesique ] that @xmath233 .",
    "we have seen that @xmath234 .",
    "( recall that each test in algorithm [ algo : cftp ] takes , on average , @xmath102 time units . )",
    "we recall that cftp has a major drawback compared to mcmc . for the algorithm to be correct",
    ", we have to reuse the same random variables @xmath199 , so that space - complexity is in fact linear in @xmath235 .",
    "this may become an issue when @xmath0 is large .",
    "* 1 . * in fig.[fig : simus ] , we show simulations of the three kinds of paths , for @xmath236 . we observe that the final height of the culminating path is very low ( about @xmath237 ) , it would be interesting to use our algorithm to investigate the behaviour of this height when @xmath238 ; this question was left open in @xcite .    , with @xmath239 . from top to bottom : a culminating path , a meander , a path with wall ( shown by an arch).,title=\"fig:\",width=529 ] + , with @xmath239 . from top to bottom : a culminating path , a meander , a path with wall ( shown by an arch).,title=\"fig:\",width=529 ] + , with @xmath239 . from top to bottom : a culminating path , a meander , a path with wall ( shown by an arch).,title=\"fig:\",width=529 ] +    * 2 .",
    "* one may wonder to what extent this work applies to other families @xmath29 of paths .",
    "the main assumption is that the family of paths should be a geodesic space w.r.t .",
    "distance @xmath142 .",
    "this is true for example if the following condition on @xmath29 is fulfilled : @xmath240 notice however that this is quite a strong requirement , and it is not verified for culminating paths for instance .",
    "a motivation to sample random paths is to make and test guesses for some functionals of these paths , taken on average over @xmath29 .",
    "consider a function @xmath241 , we want an approximate value of @xmath242 , if the exact value is out of reach by calculation .",
    "we estimate this quantity by @xmath243 ( recall that @xmath73 is the value of the chain at time @xmath74 ) . for algorithm [ algo : cm ] to be efficient in practice , we have to bound @xmath244 for any fixed @xmath245 , by a non - asymptotic ( in @xmath76 ) quantity .",
    "this can be done with ( @xcite , th.4 - 5 ) , in which one can find concentration inequalities for .",
    "the sharpness of these inequalities depends on @xmath124 and on the geometrical structure of @xmath29 .",
    "* aknowledgements .",
    "* many thanks to frdrique bassino and the other members of anr gamma for the support ; i also would like to thank lie ruderman for the english corrections .",
    "a referee raised a serious error in the first version of this paper , i am grateful to them ."
  ],
  "abstract_text": [
    "<S> we investigate monte carlo markov chain ( mcmc ) procedures for the random sampling of some one - dimensional lattice paths with constraints , for various constraints . </S>",
    "<S> we will see that an approach inspired by _ </S>",
    "<S> optimal transport _ allows us to efficiently bound the mixing time of the associated markov chain . </S>",
    "<S> the algorithm is robust and easy to implement , and samples an `` almost '' uniform path of length @xmath0 in @xmath1 steps . </S>",
    "<S> this bound makes use of a certain _ contraction property _ of the markov chain , and is also used to derive a bound for the running time of propp - wilson s _ coupling from the past _ algorithm . </S>"
  ]
}