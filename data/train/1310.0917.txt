{
  "article_text": [
    "in the 17th century , robert hooke discovered how dielectric structures with size features comparable to the wavelength of light were an important part of the color and appearance that was found in certain animals he studied under a microscope @xcite .",
    "however , the theory of light was not well developed at the time , there were no computers , and the quality of microscopes was not good either so the field of structural colors remained rather untouched . in recent decades , the invention of electron microscopes and the computer and the wave theory of light in the last century have made it possible to do more in - depth investigation of this field that has more than 500 million years of history in nature @xcite .",
    "controlling light reflection by interaction with structures is crucial for many applications .",
    "retro - reflectors , aluminum foil , solar cells and security holograms are just few examples encountered frequently in everyday life that would not work well without . these examples also show that there are many motivations for controlling color appearance of an object besides the visual appearance , and that improving the understanding of light s interaction with surfaces can improve a wide range of engineering applications and possibly initiate new inventions .",
    "many important contributions to the understanding of structural colors have been discovered during the study of the nanostructure of the wing of the morpho rhetenor butterfly .",
    "the results range from what is presented in @xcite and up until present day , where it is possible to make a computer model of the wing s color appearance and reflection based on measurements of the structure of the wing @xcite . on the morpho type in general ,",
    "excellent works have been published dating longer back , see e.g. @xcite .",
    "the reasons for why especially this structure has become so central in the analysis of structural colors are probably ( 1 ) the fact that its structure is more or less invariant along one axis , leaving it possible to simulate only a cross section of the model ; ( 2 ) and the rather simple shape of the structure , making it possible at an early stage to obtain good results just by analyzing it as a multilayer structure and then elaborate more and more on that model .",
    "one of the properties which still needs investigation is how to model the random displacements of the individual , repetitive structures present in the morpho rhetenor s wing , see figure 3.45 in @xcite and the following description in @xcite . by numerical as well as practical experiments",
    "it has been shown how these random displacements of a periodic structure seem to smooth out the otherwise strong diffractive effects which are expected from reflections of periodic structures",
    ". a good mathematical explanation for this  that can also be used in a wider setting  is missing . in this paper we will present a mathematical framework for analysing repeated structures with ( or without ) random translations of the elements . as a benchmark , previously published results on the random behaviour related to the morpho rhetenor butterfly will be used , but the framework has a much broader aim than this : it should make it possible to design structures with new color effects , and also it should help giving a better intuitive understanding of the influence of different kinds of randomization of structures ( e.g. in - plane vs. height displacements ) .",
    "the theory treated here will focus on the visible light , but can be applied to all parts of the electromagnetic spectrum .",
    "the rest of the paper is organized as follows .",
    "section [ sec : observations ] motivates the work in this paper by showing examples in the literature where it can be used , section [ sec : framework ] deals with the mathematical background needed to analyze the random effects , section [ sec : analysis ] applies this theory in a general setting to results obtained in earlier studies and shows how these could have been predicted by this framework , section [ sec : colors ] gives some examples on what influence the randomness would have on the color appearance of a surface for some specific cases , and finally section [ sec : conclusion ] concludes on the the presented results .",
    "in this paper we will focus on surfaces comprised of repeated unit structures in the @xmath0-plane with some per unit height displacement in the @xmath1-direction . see figure [ fig : cellstructure ] for an example of a repeated structure .",
    "this is because structures fitting to this description are found many places in the literature of optics and within many different fields .",
    "partly where the translations of the copied structures are deterministic and also where the description contains random parameters . to motivate the introduction of the following framework , some of the publications relying on one unit structure repeated throughout a domain are listed :    * firstly ,",
    "several publications exist considering the influence of randomness on binary gratings : in @xcite an experimental study of in - plane randomness is conducted with results that can be seen as a special case of the following framework ; and in @xcite some binary height variations of gratings are studied that also can be considered a special case of the framework .",
    "* secondly , phase gratings using the properties of randomness for concrete products like e.g. a surface giving _ controlled angular redirection of light _ for windows to improve indoor lighting environment has been presented in @xcite . here",
    "the effect of in - plane randomness is observed , but no mathematical explanation is given .",
    "* thirdly , designing random disorder is also seen in photovoltaic solar cell applications as presented in e.g. @xcite . in this article",
    "the following framework could have been used to investigate the effect of different randomization algorithms and parameters related to that before utilizing full wave simulations for a detailed study .    for testing the usefulness of the framework ,",
    "studies of the nanostructure of the morpho butterfly s wing will be used , since it has undergone many studies the last decades with focus on different aspects of randomness .",
    "the works to be used are :    * _ detailed electromagnetic simulation for the structural color of butterfly wings _ , @xcite , which shows numerically how the far - field response of one lit morpho butterfly ridge ( which is the `` unit structure '' of this butterfly s wing ) almost corresponds to the response of many random height translated elemenents ; * _ reproduction , mass - production , and control of the morpho - butterfly s blue _ , @xcite , which shows by experiment how a binary random pattern with a structure on top can be used to generate a smooth color effect compared to no randomization ; * _ numerical analysis on the optical role of nano - randomness on the morpho butterfly s scale _ , @xcite , which conducts several numerical experiments with different kinds of randomization parameters to investigate the effect of these , and ; * _ detailed simulation of structural color generation inspired by the morpho butterfly _ , @xcite , which  among other numerical experiments ",
    "contains an analysis of the effect of different maximum heights chosen for randomization .    in this paper",
    "we confirm these observations by mathematical derivations of a simple framework and numerical experiments performed using that framework .",
    "in this section a framework is presented which can be used for analysis of ( random ) translations of structures .",
    "it is presented for a 3d general case , even though the examples later on will be two - dimensional .",
    "the analysis is performed for time harmonic waves using the time factor @xmath2 .",
    "consider an electromagnetic structure with its volumes divided into different cells  which in this article will be referred to as units when all cells contain the same structure  as seen in figure [ fig : cellstructure ] . by huygens principle and the image principle , @xcite , it is possible to calculate the ( near - field as well as ) far - field contribution in the upper hemisphere from any structure by considering the so - called equivalent surface currents , @xmath3 , calculated on an infinite plane above the structure .",
    "an example of this could be the structure seen in figure [ fig : cellstructure ] if the plane @xmath4 is extended to infinity . due to the linearity of maxwell s equations ,",
    "the plane can be split into parts with each their far - field contribution , and by summing them we still arrive at the same total far - field contribution .        now , by defining a plane above the structure in figure [ fig : cellstructure ] and splitting it into parts such that each part follows the projection of the cell on the plane ",
    "like @xmath4 in figure [ fig : cellstructure ]  the magnetic far - field contribution for the @xmath5-field , @xmath6 can be found as ( see e.g. chapter 6 in @xcite ) @xmath7 where @xmath8 where @xmath9 is the wavenumber , the @xmath4 s ( @xmath10 ) are all unique parts making up the total surface @xmath11 , @xmath12 is the distance from an arbitrarily located origin on @xmath4 to the evaluation point ( since @xmath12 is used in places where phase information is not important , it is assumed constant ) , @xmath13 is the direction towards the far - field evaluation point , and @xmath14 is the position vector ( as measured from the origin ) to a point on @xmath4 .",
    "the variables @xmath15 are all defined as in figure [ fig : cellstructure ] .    in far - field and free space ,",
    "the radiated wave locally approaches a tem ( transverse electromagnetic ) wave , and we can therefore make use of the relation between the electric and magnetic field due to this behavior , @xmath16 where @xmath17 is the free - space impedance , to calculate the irradiance @xmath18  which equals the magnitude of poynting s vector  as @xmath19 which will be used later on in the analysis .",
    "we want to manipulate such that it includes ( random ) height / length translations of structures in all three spatial directions , @xmath20 , see figure [ fig : translation_example ] for a planar example .",
    "considering one of these structures , it is lit by a plane wave with propagation direction @xmath21 as also indicated in the figure .",
    "this means , first of all , that by translating it , we introduce a phase lag , @xmath22 , on the phase that the incoming wave meets the structure with , which can be described as        @xmath23    in relation to the evaluation of the far field there is also a difference , since the vector @xmath24 has changed so that it now is represented by @xmath25 and this influences the far - field transformation in",
    ". we do not need to update the distance , @xmath12 , since the change in contribution to the distance is negligible  which is in agreement with the assumptions made in the derivation of far - field radiation in the first place .",
    "modifying then gives @xmath26 where the superscript @xmath27 indicates that it is the translated response , and @xmath28 is still the equivalent surface current of the untranslated structure .",
    "this result simply describes the angular dependent change in phase to the contribution that is seen in an observation point when moving the structure around in a lit domain .      in this paper",
    "we will focus on one basic structure that will exist in several translated instances in the domain ( that is , the structure itself will not be pertubed ) .",
    "this structure will be referred to as the _ unit structure_. due to superposition there can in principle be several unit structures as long as they do not overlap .    if we assume that we can find the far field radiance of this structure  or at least an adequate approximation of that  we can then sum over this response with the correct translations to find how a system of these structures will reflect light .",
    "the caveat in this assumption is that the structures can be small and placed so close that they couple strongly with each other , or shadow for each other , or in any other way obstruct the simple response of the structure itself . for many problems",
    "this need not be an issue : in the design of reflectarray antennas the coupling between neighboring elements have been taken into account by applying periodic boundary conditions to the single element simulation and by that obtaining adequate results for simulations , @xcite ; and in the analysis of the morpho butterfly s wing s nanostructure s interaction with light it has been found that a radiation boundary conditions is sufficient , @xcite .",
    "this makes it possible to define the far - field response of this unit structure as @xmath29 , and we can then obtain a new expressions for the irradiance as @xmath30 in this formulation the response of the unit structure is isolated such that the total irradiance is just the response of the unit structure multiplied with the magnitude of some function squared .",
    "this function we denote the array factor ( af ) , since it plays the same role as an af does in antenna theory , @xcite .",
    "note how the exponent inside the array factor has an angular dependent term ( @xmath31 ) and a term dependent on the direction of the incoming wave ( @xmath21 ) .",
    "the response of the eye is not proportional to irradiance , but to radiance @xcite , meaning that for appearance and color purposes , we need to convert irradiance to radiance .",
    "from @xcite it is shown that the irradiance only having a component normal to the observation surface ( which is true for a detector in the far field ) is related to the radiant intensity , @xmath32 , by @xmath33 and also from @xcite the relation between radiant intensity and radiance , @xmath34 , is given as @xmath35 where @xmath36 is the area of the surface of the lit structure .",
    "this means that we can write the total radiance for a lit surface with repeated structures as @xmath37 where @xmath38 is the surface of @xmath39 and @xmath40 is the number of summations in the sum  which means that @xmath41 .",
    "the peculiarity of having @xmath40 present twice is to scale the last product such that it peaks at unity . in case of @xmath42 ,",
    "the limit value has to be found .",
    "since the array factor is now scaled by the number of units , we will refer to it as the scaled array factor ( saf ) .",
    "the expression in will be the foundation for all following analyses , as it shows how a prediction of the reflection from the unit structure ( this we denote _ unit response _ ) and a knowledge of the position of its copies ( the @xmath43 s ) can give a complete description of the reflected radiance .",
    "furthermore it decouples the positioning of the structures from the response of the structure , which means that when designing e.g. the angular pattern of a given structure it is not necessary to take the shape of the structure into account and vice versa ( as long as the assumptions are not violated ) .      in section [ sec : irradiance ] and",
    "[ sec : radiance ] we have assumed that all structures on a surface have the same response ( except for the translation part ) , and it is important to clarify when these assumptions can be expected to hold and where one should be cautious .",
    "there are two basic problems to be cautious about : ( 1 ) the geometry surrounding the element and ( 2 ) if the surface for the far - field transformation contains the needed response of the structure .",
    "if an element is simulated sitting in a periodic structure like in figure [ fig : structures](a ) , and then in reality is sitting in some random structure like in figure [ fig : structures](b ) it is clear that the actual far - field response is somewhat different , since the electromagnetic coupling to the neighboring elements has changed .",
    "it is therefore necessary that the resulting change in far - field response is small or averages out over many elements , and it is also necessary that the displaced unit structures do not shadow each other .",
    "this will in general become less important for large unit structures , since the interelemental coupling in most cases will be negligible .",
    "it should also be noted that all practical structures have finite sizes , and the unit structures at the edges probably will have another far - field response due to the difference in the surrounding geometry .",
    "if the surface is large compared to the area occupied by the outer unit structures , this effect should be negligible .",
    "we have assumed that there exists a plane surface , @xmath44 , above the unit structure on which we can calculate the equivalent surface current , @xmath28 , and then find the needed unit response from here .",
    "furthermore , we assume that we can calculate the total response from some configuration of unit structures by stitching a plane surface , @xmath11 , together by these surface currents with a first order phase correction term taking their translation into account .    for the above assumptions to work",
    "well we recommend to put the far - field transformation surface as close to the electromagnetic structure as possible for two reasons : the first is to take as much energy as possible into account and thereby catching the behavior the best way possible ; and the second is that it will minimize unwanted contributions from the surroundings through the surface ( e.g. if there are periodic boundary conditions ) so that only coupling is taken into account  and not some of the far - field from structures which in reality are not translated .      in the rest of this paper",
    ", we will consider structures only with variation in the @xmath45- and @xmath1-directions and lit by waves directed in the @xmath46-plane to keep the examples simple .",
    "this means that the results will be invariant in the @xmath47-plane , and we therefore put @xmath48 , @xcite . to indicate this , we will apply the following notation in the rest of this paper : @xmath49 where @xmath50 is the length of the unit structure instead of the area .      from and it is seen how the total radiance is the product of a unit radiance and the absoulte squared saf .",
    "this means that they can be treated independently of each other , and in this paper we will focus only on the saf and not consider a specific unit response , but instead pose the problem : _ if we have designed a structure , in which way should it be distributed to give the reflection we want ? _ the effect of different choices of translations ( that is , different saf s ) of the same structure and its influence is exemplified in figure [ fig : af ] .    [ cols=\"^,^,^,^,^ \" , ]     ( a )  but for _ double _ the interval width of the distribution used in [ fig : triangularrandom](a ) ! ]      in @xcite a blue surface without specular reflections is produced to mimic the behavior of the morpho butterfly wing . for easy fabrication purposes ,",
    "the randomization of the unit structure is made up by only two heights .",
    "that is , @xmath51 in can only take on two values : @xmath52 and @xmath53 . repeating the setup from before , but now with this binary randomness , we obtain the results presented in figure [ fig : binrandom ] . here",
    "it is seen how a height difference of a quarter of a wavelength at the target frequency is needed to get a flat @xmath54 .",
    "this is in perfect agreement with the height choosen in @xcite .",
    "choosing a height difference on half a wavelength gives strong grating modes , though .",
    "the reason for this is that at a height difference of @xmath55 the reflected light is sent back @xmath56 out of phase and therefore interferes destructively , leaving no preferred directions for the reflected light , whereas if the light travels @xmath57 extra back and forth it corresponds to @xmath58 , which gives constructive interference and modes like seen in figure [ fig : fullrandom](a ) . since the reflected light travels a bit longer than @xmath59 when reflected back in off specular directions ( taken care of in the equation by the @xmath60 term ) , the effect of constructive interference wears off more and more for larger and larger angles , which is also seen on the plot when comparing @xmath61 with @xmath62 .",
    "all in all , this clearly shows the need for analyzing the random design for specific situations , as here @xmath53 has to be chosen differently , and also the effect here can only be expected to work well for a smaller range of wavelengths than the uniform randomness . in the design in @xcite ,",
    "the wavelengths far from the blue region around @xmath63 are suppressed by the unit structure , thus hiding the diffraction effects that would otherwise have been present .",
    "( a ) , but now with @xmath51 only taking the values @xmath52 and @xmath53 . ]    ( a ) , but with in - plane movement as specified in . ]      in @xcite they also consider in - plane movement  that is , movement in the @xmath45-direction of a repeated structure . in doing this , we would need the following definitions for the saf : @xmath64 where the @xmath65 s is a a sequence of random variables drawn uniformly from the range @xmath66 $ ] .",
    "this gives rise to the following saf : @xmath67 by simulating , we get the results shown in figure [ fig : xrandom ] . comparing this with it can be seen that in - plane translation will never affect the specular mode response ( mode 0 ) since @xmath68 in that direction which means that @xmath69 no matter the randomization . for larger angles the effect will be more and more prominent , though , since @xmath70 is larger and the preferred phase will be less prominent in the phase distribution .",
    "this is a huge limitation with respect to creating an effect with no visible diffraction , but could add some randomness to large angles .",
    "this is also what is observed in @xcite .",
    "it should be noted that the displacements in figure [ fig : xrandom ] are quite large , and it would require a structure with lots of air in between as for the structure in this example not to overlap or couple significantly .",
    "to give an idea of the interpretation of the obtained results in term of color effects for a surface , this section will present some of the saf s converted to rgb - values for given sizes .",
    "the examples used all have a period of @xmath71 , and differ by ( 1 ) a random height variation drawn from a uniform distribution between @xmath52 and @xmath72 ; ( 2 ) a random height variation drawn from a uniform distribution between @xmath52 and @xmath73 ; ( 3 ) a random height variation drawn from a uniform distribution between @xmath52 and @xmath74 ; ( 4 ) and a uniform binary height displacement with the values @xmath52 and @xmath75 , which corresponds to the parameters chosen in @xcite .",
    "the results are presented in figure [ fig : color_analysis ] .    what can be seen from these color plots",
    "is that if a uniform random distribution is chosen , and we are designing for a color around a certain wavelength , @xmath76 , then @xmath57 should be chosen as the upper limit for the uniform distribution ( blue has a wavelength around @xmath63 ) , whereas a binary random distribution will require only @xmath55 , and as shown earlier , choosing @xmath57 will give a strong diffraction pattern .",
    "furthermore it is seen , that chosing a large upper limit of the uniform distribution makes a good choice for giving a flat distribution of all colors .",
    "this could have some practical issues , though , since the translation may be large compared to the unit structure and possibly violate the assumptions stated earlier .",
    "all in all , this suggests that when designing random patterns for a given color , it may be beneficial to use binary randomness if possible , since this gives the smallest translation of the structures and in many cases will be easier to produce by e.g. an etching process as in @xcite .",
    "not all colors can be represented by just one relatively small band in the visible range like e.g. magenta or white , and if that is not possible other means are needed",
    ". this could for example be large uniform randomness or possibly the concept of binary randomness but expanded to more levels which are chosen such that they provide destructive interference at several wavelengths .",
    "the method will be dependent on the target color , and further investigations are therefore left for the concrete cases that a scientist or a designer may have .",
    "for the first time , a framework for describing randomness of repeated structures has been presented and it has been shown how earlier observations in the literature all can be explained by this framework .",
    "the results presented are intented to push forward the understanding of these randomization phenomena  for example it explains why height randomization removes diffraction patterns much better than in - plane randomization , and how to test the effect of different height distributions .",
    "this saves time and gives more insight in the analysis of random phenomena compared to the more expensive full - wave simulation of repeated structures as has been seen earlier in the investigation of random effects .",
    "even more important , the framework makes it possible to apply a systematic approach for chosing randomization characteristics when designing surfaces with new color effects based on a unit structure .",
    "this , in turn , makes it easy to ellaborate on the produced surfaces in e.g. @xcite for different color effects .",
    "the author would like to thank professors olav breinbjerg and ole sigmund for discussions and excellent feedback regarding this paper .",
    "the author is grateful for the support from the danish national technology foundation through the odaas project ."
  ],
  "abstract_text": [
    "<S> it has been known for years how random height variations of a repeated nano - scale structure can give rise to smooth angular color variations instead of the well - known diffraction pattern experienced if no randomization is present . </S>",
    "<S> however , until now there has not been published any papers giving an in - depth mathematical explanation on the mechanisms behind and how to design the randomness for a given application . this paper presents a mathematical framework for analyzing these random variations  </S>",
    "<S> rigorously as well as intuitively . </S>"
  ]
}