{
  "article_text": [
    "extracting the network structure among neurons in animal brain has gained substantial attention lately in the field of neuroscience .",
    "rapid advances in imaging technology , in particular electron microscopy ( em ) techniques , have enabled us to trace neural bodies in unprecedented level of details . however , recording in such high resolution ( at nanometer scale ) generates massive amount of data that is too large to annotate manually .",
    "automated region labeling or segmentation is considered to be the most viable strategy for generating a dense reconstruction of neural anatomy .",
    "some recent efforts of such reconstruction yielded impressive results utilizing machine learning / computer vision tools such as image segmentation , and offered valuable biological insights to the neuroscience community  @xcite@xcite .",
    "image segmentation for natural scenes has a long history in computer vision literature  @xcite@xcite@xcite . in recent years",
    ", there have also been many fruitful attempts to automatically identify meaningful regions in em images using segmentation techniques  @xcite@xcite@xcite@xcite@xcite@xcite .",
    "most of these studies initially apply a pixelwise classifier to determine whether or not any particular pixel belongs to the cell boundary .",
    "the quantified confidence values of the pixelwise classifier are utilized to produce an initial ( over- ) segmentation through methods such as watershed  @xcite .",
    "different approaches resort to different methods to generate the final segmentation by merging or clustering the over - segmented bodies to corresponding neuronal cells .",
    "andres et.al .",
    "@xcite addresses this problem by searching the optimal subset of superpixel borders that form closed surfaces .",
    "several studies work with the watershed merge tree in order to identify the regions to be combined for the final segmentation  @xcite@xcite . some approaches applied agglomerative or hierarchical clustering  @xcite@xcite@xcite for this purpose . for anisotropic datasets , where the depth resolution ( @xmath0-dimension ) is coarser than the planar resolution ( @xmath1 dimensions ) , segmented bodies on one section overlap with multiple regions in the adjacent sections .",
    "therefore , a complete 3d reconstruction need to establish the correct correspondence , through an alignment or co - segmentation technique  @xcite@xcite , among segmented regions across multiple planes . in this study , we restrict ourselves only to segmentation on images for anisotropic data  the subsequent alignment is out of the scope of this paper . for both isotropic and anisotropic reconstruction ,",
    "the outputs of segmentation algorithms need to be corrected afterwards , either manually@xcite or by combining with a manually traced skeletonized representation  @xcite .",
    "biologically , the interior of a neuron cell comprises several distinct sub - structures ( or sub - categories ) such as cytoplasm , mitochondria , vesicles etc .",
    "an ideal binary pixel classifier  which assigns a pixel to one of the two categories : cell boundary and cell interior  should label all locations within these sub - categories to cell - interior class .",
    "several past studies  @xcite@xcite@xcite@xcite recommend increasingly complex pixelwise detector models to attain a binary prediction output .",
    "in contrast , some recent works  @xcite@xcite represent the sub - categories ( cytoplasm , mitochondria etc . ) of cell body by multiple classes and apply relatively simpler classifiers ( in terms of model size , learning time and convenience ) for this multiclass classification problem .",
    "the results of  @xcite@xcite suggest that using prior domain knowledge to divide a problem into multiple components can achieve high segmentation quality with simpler classifier models requiring less computation .",
    "however , we believe the methods of  @xcite@xcite do not exploit the full benefit of multiclass predictions on em data . regardless of the quality of multiclass pixel classifier output , the algorithms in  @xcite@xcite do not distinguish between regions of one sub - structure ( e.g. , cytoplasm ) from those of another ( e.g. , mitochondria ) at the superpixel level .",
    "that is , the classification is divided into multiple sub - classes in pixel - level , but the subsequent fusion or superpixel clustering step does not utilize this additional information to compute the final segmentation .",
    "this often leads to sub - optimal performances by these methods .",
    "for example , figure  [ f : intro_mito ] shows an em image ( plane in a 3d volume ) and the corresponding pixel predictions for the mitochondria sub - class . by not using this sub - class prediction explicitly in the clustering step ,",
    "the final output of  @xcite failed to merge many regions into the correct cell ( marked by s ) and connected some of them to wrong cells ( marked by m ) .",
    "+    this paper introduces a context - aware scheme for combining over - segmented regions by utilizing the prior knowledge of sub - classes .",
    "we adopt an agglomerative or hierarchical clustering framework  @xcite@xcite due to its advantages such as low space , time complexity and flexibility to tune for over / under segmentation .",
    "we develop a two - pass agglomeration policy where the ( estimated ) cytoplasm regions are grouped together in the first phase and then the remaining mitochondria bodies are absorbed into the cell cytoplasm . in these two stages ,",
    "the superpixels are agglomerated based on different merge criteria that are defined by different contexts , which is why we call it context - aware agglomeration .",
    "our proposed context aware approach significantly reduces the false split and merge errors ( example shown in figure  [ f : intro_mito ] ) provided fairly accurate sub - structure detection .",
    "in addition , this strategy substantially reduces the training data requirement , as well as the predictor model complexity , which in turn offers significant increase in learning speed .",
    "the findings of this study further inspired us to design an interactive training algorithm  @xcite for region boundary predictor that does not require exhaustively labeled groundtruth .",
    "generating such an exhaustive annotation is considered to be a bottleneck for neural reconstruction  @xcite .",
    "we also propose a modified version of the hierarchical clustering algorithm to cluster the superpixels in both phases of the context - aware framework .",
    "the proposed clustering method emphasizes on minimizing under - segmentation errors since these errors are conventionally costlier to correct than the over - segmentation errors  @xcite . in order to minimize the number of false merges , we delay   the merge decisions on a certain type of boundaries to be resolved at a later time .",
    "compared to the traditional agglomerative scheme of  @xcite , the proposed modification reduces the number of false merges significantly .",
    "we also attempt to analyze why our agglomeration approach performs better than the global multicut scheme  @xcite on the dataset used for our experiments .",
    "the paper is organized as follows .",
    "we define the problem in section  [ s : methods ] and briefly describe the existing clustering segmentation algorithms in section  [ s : prior ]",
    ". then we explain the proposed delayed agglomeration scheme in section  [ s : delayed ] .",
    "this delayed strategy is employed in both the stages of our context - aware algorithm discussed in section  [ s : twostage ] . section  [ s : result ] reports our experimental setup , both quantitative and qualitative results and their analyses .",
    "we conclude and discuss our findings further in section  [ s : discussion ] .",
    "a formal definition of the problem we are addressing assumes an initial over - segmentation , comprising @xmath2 superpixels @xmath3 , of an em image or volume with @xmath4 neurites ( neuronal regions ) where @xmath5 .",
    "let @xmath6 be the neurite region that @xmath7 actually belongs to .",
    "our goal is to correctly assign these @xmath2 superpixels such that each @xmath8 is assigned to its corresponding @xmath9 .",
    "we denote a boundary between two superpixels ( i.e. , oversegmented regions ) by a pair of regions @xmath10 and the set of all such boundaries by @xmath11 . in a graph representation ,",
    "each of the regions @xmath12 is considered to be a node and the boundary or face between two regions is regarded as an edge  a notation we will be using throughout the paper .",
    "also , let the boundary label map @xmath13 assign a 1 to a boundary that actually separates one neurite region from another and a 0 to the boundary incorrectly generated due to over - segmentation .",
    "the problem of correctly merging @xmath12 to its corresponding @xmath9 is similar to a clustering problem where the number of clusters can not be computed a priori .",
    "following@xcite@xcite@xcite , we adopt an agglomerative approach for superpixel clustering .    in our context - aware scheme ,",
    "the set of superpixels is divided into two subsets : 1 ) the @xmath14 of potential cytoplasm superpixels , and 2 ) the set @xmath15 of potential mitochondria superpixels .",
    "the set of cytoplasm superpixels is clustered first with the proposed delayed agglomeration algorithm .",
    "agglomeration of the mitochondria superpixels is also performed by the proposed delayed method , but with a different merge criterion . in order to assist the reader to comprehend the novelty of the proposed approach",
    ", we introduce the prior studies on agglomerative clustering for em segmentation  @xcite@xcite@xcite in section  [ s : prior ] .",
    "afterwards , sections  [ s : delayed ] and  [ s : twostage ] discuss the delayed agglomeration and the context- aware framework respectively .",
    "several existing em segmentation approaches  @xcite@xcite@xcite tackled the problem of superpixel clustering by agglomerative hierarchical clustering , as described in algorithm  [ a : agglo_prev ] .",
    "these methods assume a superpixel boundary estimator @xmath16 that assigns real valued confidences to all edges in @xmath11 .",
    "this boundary estimator may represent the real - valued prediction of a classifier distinguishing true boundaries from the false ones  @xcite , or compute the mean value of boundary pixel probabilities  @xcite or return the overlap percentage between borders of two adjacent superpixels .",
    "the value of @xmath17 $ ] indicates how confident the estimator is about the existence of a true boundary between @xmath12 and @xmath18 : a large @xmath19 implies the estimator is very confident that the boundary @xmath20 is correct while a small value implies the boundary was probably generated as an artifact of over - segmentation and therefore is false .",
    "given such a function @xmath21 , the hierarchical clustering algorithm iteratively merges cell boundaries in the increasing order of confidence values @xmath22 ( line  [ line : start ] in algorithm  [ a : agglo_prev ] ) until a stopping criterion is satisfied , e.g. , @xmath23 where @xmath24 is a pre - defined threshold .",
    "after each merge , it also updates the neighborhood structure of the merged superpixel , i.e. , the neighbors of the absorbed region become the neighbors of the ( newly ) merged cell .    each time a superpixel border is dissolved in standard agglomerative clustering , it modifies the characteristic representations of the pixels within the superpixels and on the boundary .",
    "this demands the confidences of the estimator function @xmath22 on these boundaries be recomputed ( line  [ line : update ] in algorithm  [ a : agglo_prev ] ) .",
    "the edges , for which @xmath22 decreases due to a merge , receive higher priority to be dissolved than it had before .",
    "the proposed delayed agglomeration strategy modifies this step and postpones merging these edges for a later time .",
    "our adaption of segmentation also starts with the boundary with lowest estimator confidence and repeatedly dissolve edges with in ascending order of @xmath22 .",
    "recall that , @xmath22 may measure the prediction of a superpixel boundary classifier , or the mean probability values on boundary pixels , or the fraction of overlap between the borders of two superpixels .",
    "after two regions have been joined due to a merge , the boundaries of the combined region is updated and the estimator function @xmath21 is applied to recompute the new confidences .",
    "the edges for which @xmath22 decreases are set aside to be considered at a later stage .",
    "they are reexamined after all the borders , initially generated by over - segmentation process , have been checked .",
    "this method is described in algorithm  [ a : agglo_delayed ] .",
    "after region @xmath25 is absorbed into @xmath26 , we do not _ immediately _ consider all the new boundaries @xmath27 between the recently merged @xmath26 is now the union of previous @xmath26 and @xmath25 ] and its updated neighbors @xmath29 .",
    "we maintain a set of edges @xmath30 and insert the new edge @xmath27 only if its confidence increases from that of @xmath31 after @xmath25 is absorbed into @xmath26 ( line  [ line : update_new ] in algorithm  [ a : agglo_delayed ] ) .",
    "the faces , for which @xmath32 decreases from previous value , are kept aside until there are no members left in @xmath30 and the modified confidence on @xmath27 is less than the agglomeration threshold ( line  [ line : put_off ] in algorithm  [ a : agglo_delayed ] ) . once all @xmath33 have been considered for merge and @xmath30",
    "is empty , these boundaries repopulate the list @xmath30 ( line  [ line : reenter ] in algorithm  [ a : agglo_delayed ] ) and renew the agglomeration process which continues until there exists no @xmath34 such that @xmath35 .    effectively , the proposed strategy delays   the merging of new edges @xmath27 resulting from a merge : either due to an increase in @xmath32 or deliberately if @xmath32 decreases .",
    "this design postpones the merge decisions on the newly formed bodies for a later time to avoid propagating wrong decisions , made on smaller superpixels , to the larger ones .",
    "our analyses support that deferring decisions on these edges significantly reduces false merges during agglomeration .",
    "asymptotically , the running time of the delayed algorithm remains the same as the traditional agglomerative clustering in the worst case .",
    "in a priority queue implementation , instead of adding the adjacent boundaries to the queue , the delayed algorithm stores them in a separate list . later",
    ", building a queue from this list would require @xmath36 time where the length @xmath37 of new list must be smaller than that of the previous one ( which contains all edges ) : @xmath38 .",
    "in fact , our implementation is tuned to reduce the running time of delayed agglomeration .",
    "notice that , a subset of adjacent boundaries are not pushed back or updated into the queue ( line 13 of algorithm  [ a : agglo_delayed ] ) .",
    "we may as well apply a simple trick to avoid updates at each merge altogether : instead of increasing key of the edges with increased @xmath21 value ( line 11 of algorithm  [ a : agglo_delayed ] ) , we can postpone the check and increase the key until it becomes a candidate for merge ( line 7 of algorithm  [ a : agglo_delayed ] ) or in line 6 when it being considered to be inserted into @xmath30 .",
    "thus , we can reduce the computation by @xmath39 where @xmath40 is the degree of @xmath41 and @xmath42 is the queue size .",
    "the proposed context - aware agglomeration has two different phases .",
    "we separate the set @xmath15 of potential mitochondria superpixels from the set @xmath14 of potential cytoplasm superpixels assuming the existence of an effective mitochondria superpixel detector ( e.g. ,  @xcite ) .",
    "the regions in @xmath14 are agglomerated first by the proposed delayed policy . motivated by  @xcite@xcite@xcite , a random forest ( rf )  @xcite classifier @xmath43",
    "is trained to act as the boundary predictor function for clustering the set @xmath14 of cytoplasm superpixels . during @xmath43 training , mitochondria - cytoplasm borders",
    "are treated the same way as cell membrane .    in the second step ,",
    "the mitochondria - cytoplasm edges are merged in the same delayed scheme as explained in section  [ s : delayed ] , but with a different estimator function @xmath44 . in order to absorb mitochondria into corresponding cells ,",
    "we apply the delayed - agglomeration algorithm with a small alteration .",
    "the _ set of candidate edges @xmath30 only contains the edges between mitochondria and cytoplasm _ , that is , @xmath45 ; _ mitochondria - mitochondria edges are not considered for agglomeration_. biologically , each mitochondrion should reside within a cell body .",
    "therefore , boundary confidence for mitochondria merging should reflect how much a mitochondrion is contained within a cytoplasm . in order to quantify this",
    ", we define the overlap ratio @xmath46 to be the fraction of the total boundary of @xmath47 which separates @xmath47 from @xmath48 : @xmath49 .",
    "for any edge @xmath50 with a mitochondria superpixel @xmath47 and a cytoplasm superpixel @xmath48 , the confidence is defined as @xmath51 .    in effect , the mitochondria superpixels are combined with the cytoplasm superpixels in the descending order of the overlap ratio between these two types of regions .",
    "that is , a mitochondria superpixel is merged into the adjacent cytoplasm region with the largest overlap between their boundaries .",
    "the combined cytoplasm - mitochondria superpixel created by such merge then identifies the next mitochondria superpixel with the largest overlap to absorb in the next step .",
    "we show snapshots of this process , at different values of @xmath52 in figure  [ f : mito_merge ] .",
    "it is worth noting that , for 3d segmentation , the overlap is computed across many different planes on which the two cells are neighbors to each other .",
    "we have applied the proposed method to em images of two different modalities : isotropic focused ion beam scanning electron microscope ( fibsem ) data and anisotropic serial section transmission electron microscopy ( sstem ) data . for both types of input data ,",
    "the image ( volume for the isotropic data ) is first over - segmented for the agglomeration to be applied on . in the following sections , we explain our over - segmentation process and the error measures used to evaluate segmentation performance before reporting the results on fibsem and sstem data in sections  [ s : result_fibsem ] and  [ s : result_tem ] respectively .",
    "we learn a classifier to assign each individual pixel into multiple categories such as cell boundary , cytoplasm , mitochondria and mitochondria boundary etc . using the interactive tool ilastik  @xcite .",
    "our pixelwise detector is a random forest ( rf ) classifier  @xcite trained on a few sparse samples from the dataset . the locations with lowest pixelwise cell boundary prediction are utilized as markers for the watershed algorithm  @xcite to produce an over - segmentation of the image / volume .",
    "unless otherwise specified , the same pixel prediction and watershed regions are provided as input to all ( competing ) methods .",
    "the set @xmath15 of probable mitochondria superpixels is populated with all regions having mean mitochondria probability ( estimated by our pixelwise rf classifier trained by ilastik ) above a certain threshold .",
    "the rest of the superpixels constitute the set @xmath14 of possible cytoplasm regions . the training set for superpixel boundary classifier @xmath43 consists of all boundaries among members of @xmath14 as well as the mitochondria - cytoplasm borders .",
    "similar to  @xcite@xcite , each superpixel edge is represented by the statistical properties of the multiclass probabilities estimated by ilastik .",
    "the statistical properties include mean , standard deviation , 4 quartiles of the predictions generated for the data locations on the boundary , two regions it separates as well as the differences of these region statistics .",
    "all of these features can be updated in constant time after a merge ",
    "a property which improves the efficiency of the segmentation algorithm substantially .",
    "the code and example dataset are publicly available at https://github.com/janelia-flyem/neuroproof.git .",
    "we report segmentation error of both types , namely under- and over - segmentation , separately because one of these errors ( under - segmentation ) is costlier than the other .",
    "split versions of variance of information ( vi )  @xcite and rand error ( re )  @xcite were selected to evaluate segmentation errors . given a groundtruth ( gt ) , @xmath53 , and a segmentation ( sg ) , @xmath54 , we compute the over - segmentation ( oe ) and under - segmentation ( ue ) errors by splitting the terms in vi and re .",
    "for split - vi , the over and under - segmentation are quantified as follows .",
    "@xmath55    in these equations , @xmath56 denotes the size , @xmath57 denotes the intersection between two regions and @xmath58 is a normalizing constant . from information theoretic perspective , these two terms are conditional entropies defined over a set gt given sg , and vice versa .",
    "we also quantify segmentation error by average percentage ( @xmath59 ) of pairs of voxels falsely merged and split by any method .",
    "formally , the over - segmentation ( oe ) and under - segmentation ( ue ) is computed based on the following formula .",
    "@xmath60      * dataset : * the first set of experiments was conducted on isotropic datasets from fruit fly visual system imaged at 10 nm isotropic resolution using fibsem technology .",
    "this data is segmented as a volume ( i.e. , 3d segmentation ) and both the voxelwise multi - class predictor and the supervoxel boundary classifier are learned on one @xmath61 volume and applied on two @xmath62 test volumes .",
    "* competing methods : * we have compared the following algorithms in this study : 1 ) lash : standard agglomeration with an rf supervoxel classifier learned based on the iterative procedure of  @xcite .",
    "2 ) lash - d : lash classifier with delayed agglomeration ( proposed extension ) .",
    "3)gala  @xcite : an agglomerative method with repetitive learning phases like lash , except it accumulates the training sets of multiple phases .",
    "4 ) cada - f : proposed two stage delayed agglomeration with standard rf learned using training set accumulation similar to gala .",
    "5 ) cada - l : proposed delayed agglomeration with a depth - limited rf ( depth = 20 ) learned _ without _ training set accumulation .",
    "6 ) global multicut : the optimization framework for finding a closed - surface segmentation proposed in  @xcite . for  @xcite ,",
    "the boundary confidences were generated by the cada - l predictor .",
    "+    * performance evaluation : * in order to compare different supervoxel clustering schemes , we trained ( on one @xmath61 volume ) and segmented two @xmath62 volumes 5 times and averaged their scores .",
    "we plot the average ( over 5 trials ) @xmath63 and @xmath64 respectively on x and y - axis respectively in plots on the left column of figure  [ f : result_q ] and for test volumes 1 and 2 .",
    "similarly , we show the average @xmath65 and @xmath66 errors on x and y - axis respectively on right columns of figure  [ f : result_q ] . in these figures ,",
    "an ideal algorithm should achieve a zero value for both over and under - segmentation .",
    "for all algorithms except the global multicut method , each point in a plot refers to the boundary confidence threshold @xmath67 $ ] which was used as stopping criterion for cytoplasm merging . for  @xcite , we instead changed the value of the bias parameter in weight calculation within the range @xmath68 $ ] .",
    "as the plots show , both the delayed agglomeration and two - phase segmentation process attained significant improvement over past methods : compare the performance of lash ( red + ) with lash - d ( black x ) and that of gala ( cyan * ) with cada variants ( green square and blue circle ) .",
    "compared to the rest of the techniques , the two variants of proposed methods , namely cada - l and cada - f , appear to achieve the most favorable segmentations by reducing the over - segmentation steeply without increasing the false merge numbers much . during segmentation ,",
    "the delayed version decreases the time needed for segmentation approximately 5 times among the agglomerative approaches .",
    "it is also worth mentioning that , in a two stage segmentation scheme , the performance of a depth limited rf ( i.e. , cada - l , green square ) , learned without accumulating training set over multiple passes , is very similar to that of the standard rf ( cada - f , blue circle ) trained over cumulative learning passes .",
    "training full - depth rf ( cada - f ) with multiple passes needed several hours whereas training a depth limited single iteration ( cada - l ) required @xmath69 minutes .        in figure",
    "[ f : result_img ] , we show example outputs from the methods lash - d , gala  @xcite , global multicut  @xcite and cada - l on three planes from the test volume 1 as depicted in figure  [ f : input_img ]  ( the algorithms were applied on 3d volume , we are showing three slices of the volume for demonstration ) .",
    "three columns correspond to three planes , and each row presents the outputs of the aforementioned methods .",
    "the segmentation labeling is overlaid with artificial ( randomly selected ) colors .",
    "we have selected the parameter that results in the lowest false merges ( under - segmentation ) with a false split ( over - segmentation ) error below @xmath70 for all except the proposed cada - l for which we selected the lowest over - segmentation ( error value approx 0.56 ) .",
    "the results are largely compatible with the quantitative ones , with all three methods , especially global method , leaving many false boundaries intact .",
    "the false - splits are not limited to cytoplasm mitochondria borders , both global and gala over - segmented some cytoplasm regions as well . by separating these two sub - classes within cell bodies ,",
    "the proposed method cada - l was able to eliminate the false merges between them .",
    "* runtime comparison : * in table  [ t : runtime ] , we report the running times of the context oblivious standard agglomerative clustering used in lash  @xcite ; the context - oblivious delayed agglomerated clustering used in lash - d , gala  @xcite ; the context - aware delayed agglomeration used in cada - l , cada - f ; and the global multicut  @xcite method .",
    "both the standard and delayed agglomeration were executed up to the same threshold @xmath71 .",
    "the context - aware method executes two phases of agglomeration , which is why cada required more time than lash - d .",
    "the global multicut algorithm utilizes the solution of an optimization problem ( requires optimization packages like cplex or gurobi ) in order to find the edges to merge for producing the final segmentation .",
    ".runtime for different algorithms . [ cols=\"^,^\",options=\"header \" , ]     during the training of superpixel boundary classifier , all the algorithms except cada - l and global multicut performs standard agglomeration multiple times ( we repeated 5 times ) in order to obtain extensive training sets .",
    "both cada - l and global method exploited the same classifier learned from the initial set of boundaries existed in the over - segmented data ( without training set augmentation ) .    in the following subsections ,",
    "we attempt to analyze why ( or how ) the proposed strategies improve the segmentation performance over the existing approaches .",
    "it is perhaps intuitive that traditional context - oblivious agglomeration will result in higher degree of over - segmentation than the context - aware method .",
    "the mitochondria - cytoplasm borders indeed have strong feature similarity with cell membranes and consequently superpixel boundary predictors can not distinguish between these two types of borders perfectly .",
    "recall that , for segmentation , we need to dissolve the mitochondria - cytoplasm border but retain the cell boundaries . in order to substantiate our claim ,",
    "we trained a superpixel boundary classifier in context - oblivious fashion ( 0 : false cell membrane , 1:true cell membrane ) and computed its confidences on these two types of boundaries . figure  [ f : intro_mito ] shows the histogram of confidence levels for actual cell boundaries and mitochondria - cytoplasm borders in red and blue respectively .",
    "if we wish to minimize false merges among neurons , we have to stop agglomeration at a lower value ( @xmath72 ) .",
    "the overlap between the two distributions in the range @xmath73 suggests that many of the mitochondria borders will not be merged and will lead to over - segmentation .",
    "in addition , due to appearance dissimilarity , the distribution of same features computed on cytoplasm and mitochondria will be substantially different from each other . combining these two types of feature value distribution",
    "will impede the identification of false boundaries between cytoplasm superpixels such as the one in the lower left corner of the output of gala in figure  [ f : intro_mito ] .    in practice ,",
    "mitochondria from two different cells could also lead to false merges .",
    "often the mitochondria regions from two cells are closely located to the cell membrane , or other mitochondria regions from neighboring cells , blurring the boundary .",
    "figure  [ f : intro_mito ] and  [ f : result_img ] show several such locations where the existing techniques failed to avoid false merge .      the split - vi plot in figures  [ f : result_q_cyto ]",
    "show that both variants of the proposed cada algorithm generates significantly low under and over - segmentation errors than those of global  @xcite method in clustering _",
    "cytoplasm regions only ( mitochondria not merged)_. in order to analyze why this happens , we save the initial confidences ( predictor confidence at the beginning of agglomeration ) of @xmath74 on all @xmath34 that    * were incorrectly split ( over - segmented ) by the global method , * were correctly merged by proposed algorithm .",
    "these boundary predictions were plotted on x - axis of figure  [ f : result_analyze ] .",
    "the y - axis of figure  [ f : result_analyze ] corresponds to confidences @xmath74 at the time @xmath34 was correctly merged by the proposed method .",
    "the threshold on boundary confidences to stop agglomeration was @xmath75 .",
    "notice that , the agglomerative process correctly reduced the confidences of many false boundaries that received a high score by the predictor at the beginning ( high x value but low y value ) .",
    "this refinement is possible through the evolution of the superpixels in the agglomerative process ",
    "an advantage the global method of  @xcite can not benefit from .",
    "the global method  @xcite , in comparison , generated many more false positive boundaries as depicted by the rectangular enclosed region of figure  [ f : result_analyze ] ( left ) .",
    "if several boundaries within a chain of supervoxel faces receive very high predictor confidences , by construction , the global method tends to retain the another boundary @xmath34 within the same chain with a low @xmath74 . such tendency may be the reason behind the high concentration of false splits with low @xmath43 within the rectangular region in figure  [ f : result_analyze ] ( left ) .      in order to illustrate the improved accuracy attained by the delayed agglomeration over the standard one , we collected all _ faces that were incorrectly dissolved by standard agglomeration algorithm _ ( lash ) and examine their confidences under a delayed scheme ( lash - d ) operating at @xmath76 the confidences ( clipped to 0.25 ) of these 534 edges generated by standard and delayed agglomeration are plotted in figure  [ f : result_analyze ] ( right ) in blue square and red @xmath77 respectively .",
    "the proposed delayed agglomeration accurately increased the confidences @xmath43 of many of these faces , among which , 41 exceeded the threshold of @xmath78 ( green line ) and avoided a false merge .",
    "in addition to these common supervoxel edges , the standard and delayed algorithms independently generated 163 and 4 more incorrect merges respectively .",
    "this section reports the 2d segmentation results our method and others produced on a different data modality , namely sstem images .",
    "these images were part of those generated for the work of  @xcite and were collected from the authors .",
    "fifteen @xmath79 images were used for training both the pixel and superpixel boundaries .",
    "we follow the techniques and 2d versions of features described in section  [ s : overseg ] for sstem data . the same pixel prediction and watershed regions",
    "are provided as input to all competing methods .",
    "the segmentation is performed on each image ( without connecting them across planes ) and figures  [ f : result_tem ] plots the average of split - vi and split - re errors over 15 images of size @xmath80 of the proposed cada - l and gala  @xcite methods .",
    "our method cada - l seems to produce less over - segmentation in almost all threshold values than that results of gala  @xcite .",
    "the result of the global method  @xcite were too poor to show on this plot ",
    "lowest over - segmentation error at 4.11 with 0.13 under - segmentation average .    in figure",
    "[ f : result_tem_qual ] , we show input images and the segmentation results ( overlaid on the image ) of gala and our methods at the same under - segmentation error . examining the qualitative output in figure  [ f : result_tem_qual ]",
    ", gala seems to struggle to absorb the mitochondria regions despite multiple learning iterations and even merges two cells in one occasion . while a more accurate mitochondria predictor could potentially reduce the segmentation errors of the proposed method , context - invariant algorithms such as gala",
    "would be less effective around mitochondria regions .",
    "it is worth mentioning here that , compared to gala , cada - l used less than half of the training examples ( @xmath81 ) collected without training iterations ( i.e. , significantly more efficient in training ) .",
    "we argue that , due to considerable ambiguity in appearances , it is only rational for an em segmentation algorithm to be context - aware in each of its stages , i.e. , in both pixel and superpixel levels ( and in alignment for anisotropic data ) .",
    "the results reported in this paper support our claim that a context - aware clustering of sub - classes such as cytoplasm and mitochondria can improve segmentation accuracy significantly given fairly accurate sub - class detection .",
    "our examination of both isotropic and anisotropic data suggests cell structures can not be meaningfully identified without mitochondria regions and it is non - trivial to combine detection with a segmentation that ignores it ( e.g. ,  @xcite ) in order to produce the final segmentation .",
    "our analysis also illustrates how a delayed agglomerative procedure benefits from the intermediate boundary probabilities and improves the efficiency of the segmentation process significantly .",
    "in addition to reducing the over- and under - segmentation errors , one of the variants of our classifier , namely cada - l , demands substantially fewer training examples ( and no training iterations ) than others , i.e. , its training is significantly faster than others . a context - oblivious strategy gain significantly ( compare lash - d with gala in figure  [ f : result_q ] ) by accumulating training set over multiple iterations .",
    "however , in context - aware approach , one does not benefit much by accumulating the training set ( cada - f in figure  [ f : result_q ] ) over a classifier trained from a single iteration ( cada - l ) .",
    "one possible explanation is that previous context oblivious strategies require the extra iterations to mitigate the impact of the noise introduced by mitochondria superpixels .",
    "this explanation implies that detecting the sub - classes , and considering them separately as necessary , is perhaps the key to train a boundary classifier accurately and efficiently .",
    "we further investigated this conjecture and developed a semi - supervised active learning algorithm ( interactive ) to train the supevoxel boundary classifier with as few as @xmath82 of the total examples  @xcite .",
    "the requirement of exhaustive labels is a critical bottleneck for automatic em segmentation , especially for reconstructing larger brain regions , or whole animal brain , where one may anticipate the necessity to train several different classifiers  @xcite .",
    "the interactive training of both pixels ( using ilastik  @xcite for example ) and superpixel boundaries ( using  @xcite ) holds the promise of removing the need for such complete groundtruth and paves the for scaling up the em reconstruction algorithms .    we have applied our context aware algorithm to segment 216 fibsem volumes of @xmath62 voxels each , with a 10 nm isotropic resolution , from the medulla region of fly retina . as far as we know , this is an attempt to reconstruct one of the largest volumes for such animal . compared to the result of  @xcite on two of the @xmath62 blocks , our segmentation resulted in an estimated @xmath83 reduction in subsequent manual correction time .",
    "in addition , our segmentation were sufficiently accurate for regions that pertains to post - synaptic densities ( psd ) , i.e. , the synaptic partners of a cell . during the manual annotation of these psds , the output of our segmentation method assisted the experts to improve their performances  @xcite .",
    "the authors wish to thank stuart berg and bill katz for their contributions in software development ; pat rivlin and shinye takemura for providing the annotated dataset of  @xcite and for the discussion on the neurobilogical properties of our dataset ; matt saunders and lei - ann chnag for their effort in generating pixel classification ilps and groundtruth annotation ; don olbris for his assistance with the visualization software raveler .",
    "10    andres , b. , kthe , u. , helmstaedter , m. , denk , w. , hamprecht , f. : .",
    "pattern recognition * 5096*(15 ) ( 2008 ) 142152    andres , b. , kroeger , t. , briggman , k. , denk , w. , korogod , n. , knott , g. , koethe , u. , hamprecht , f. : globally optimal closed - surface segmentation for connectomics . in : eccv .",
    "( 2012 )    arbelaez , p. , maire , m. , fowlkes , c. , malik , j. : contour detection and hierarchical image segmentation .",
    "pami , ieee transactions on * 33*(5 ) ( 2011 ) 898916    beucher , s. , meyer , f. : the morphological approach to segmentation : the watershed transformation .",
    "mathematical morphology in image processing ( 1993 ) 433481    breiman , l. : random forests .",
    "machine learning * 45*(1 ) ( october 2001 ) 532    chklovskii , d.b . ,",
    "vitaladevuni , s. , scheffer , l.k . : semi - automated reconstruction of neural circuits using electron microscopy .",
    "current opinion in neurobiology * 20*(5 ) ( 2010 ) 667  675    ciresan , d.c .",
    ", giusti , a. , gambardella , l.m . , schmidhuber , j. : deep neural networks segment neuronal membranes in electron microscopy images . in : nips .",
    "( 2012 )    funke , j. , andres , b. , hamprecht , f. , cardona , a. , cook , m. : efficient automatic 3d - reconstruction of branching neurons from em data . in : cvpr .",
    "( 2012 )    helmstaedter , m. , et  al . : connectomics reconstruction of the inner plexiform layer in the mouse retina .",
    "500*(7461 ) ( 2013 ) 168174    helmstaedter , m. : cellular - resolution connectomics : challenges of dense neural circuit reconstruction .",
    "nat methods * 10*(6 ) ( 2013 ) 5017    jain , v. , bollmann , b. , richardson , m. , berger , d. , helmstaedter , m. , briggman , k. , denk , w. , bowden , j. , mendenhall , j. , abraham , w. , harris , k. , kasthuri , n. , hayworth , k. , schalek , r. , tapia , j. , lichtman , j. , seung , h. : boundary learning by optimization with topological constraints . in : cvpr .",
    "( 2010 )    jain , v. , turaga , s.c .",
    ", briggman , k. , helmstaedter , m.n . ,",
    "denk , w. , seung , h.s . : learning to agglomerate superpixel hierarchies . in :",
    "( 2011 ) 648656    jurrus , e. , paiva , a. , watanabe , s. , anderson , j. , jones , b. , whitaker , r. , jorgensen , e. , marc , r. , tasdizen .",
    "t. : detection of neuron membranes in electron microscopy images using a serial neural network architecture .",
    "medical image analysis * 14*(6 ) ( 2010 ) 770783    krahenbuhl , p. , koltun , v. : efficient inference in fully connected crfs with gaussian edge potentials . in : nips .",
    "( 2011 )    ladicky , l. , russell , c. , kohli , p. , torr , p.h.s .",
    ": associative hierarchical crfs for object class image segmentation . in : iccv .",
    "( 2009 )    liu , t. , jurrus , e. , seyedhosseini , m. , ellisman , m. , tasdizen , t. : watershed merge tree classification for electron microscopy image segmentation . in : icpr .",
    "( 2012 )    liu , t. , jones , c. , seyedhosseini , m. , tasdizen .",
    "t. : a modular hierarchical approach to 3d electron microscopy image segmentation .",
    "journal of neuroscience methods * 226*(15 ) ( 2014 ) 88102 .",
    "lucchi , a. , smith , k. , achanta , r. , knott , g. , fua , p. : supervoxel - based segmentation of mitochondria in em image stacks with learned shape features . medical imaging , ieee transactions on * 31*(2 ) ( 2012 ) 474486    meila , m. : comparing clusterings by the variation of information . in : colt03 .",
    "( 2003 ) 173187    nunez - iglesias , j. , kennedy , r. , parag , t. , shi , j. , chklovskii , d.b .",
    ": machine learning of hierarchical clustering to segment 2d and 3d images .",
    "plos one * 8*(8 ) ( 2013 ) .",
    "parag , t. , plaza , s. , scheffer , l. : small smaple learning of superpixel classifiers for em segmentation . in : miccai .",
    "( 2014 )    plaza , s. , parag , t. , huang , g. , olbris , d. , saunders , m. , rivlin , p. : annotating synapses in large em datasets .",
    "( 2014 )    rand , w.m . : .",
    "journal of the american statistical association * 66*(336 ) ( 1971 ) 846850    sommer , c. , straehle , c. , koethe , u. , hamprecht , f.a .",
    ": `` ilastik : interactive learning and segmentation toolkit '' . in : isbi .",
    "( 2011 )    takemura , s.y .",
    ", et  al . : a visual motion detection circuit suggested by drosophila connectomics .",
    "500*(7461 ) ( 2013 ) 175181    uzunbas , m. , chen , c. , metaxsas .",
    "d. : optree : a learning - based adaptive watershed algorithm for neuron segmentation . in : miccai .",
    "( 2014 )    vazquez - reina , a. , gelbart , m. , huang , d. , lichtman , j. , miller , e. , pfister , h. : segmentation fusion for connectomics . in : iccv .",
    "* code : * https://github.com/janelia-flyem/neuroproof.git .",
    "there is also a python code to visualize the results .",
    "the format for calling the code is : python showseq.py _ output - label - path.h5 _  stack  _ path - to - input - images_/grayscale - maps/*.png .",
    "in addition to pushbuttons , the following keys also work : u -up , d - down , f - toggle the color overlay ."
  ],
  "abstract_text": [
    "<S> electron microscopy ( em ) image ( or volume ) segmentation has become significantly important in recent years as an instrument for connectomics . this paper proposes a novel agglomerative framework for em segmentation . </S>",
    "<S> in particular , given an over - segmented image or volume , we propose a novel framework for accurately clustering regions of the same neuron . </S>",
    "<S> unlike existing agglomerative methods , the proposed context - aware algorithm divides superpixels ( over - segmented regions ) of different biological entities into different subsets and agglomerates them separately . </S>",
    "<S> in addition , this paper describes a delayed   scheme for agglomerative clustering that postpones some of the merge decisions , pertaining to newly formed bodies , in order to generate a more confident boundary prediction . </S>",
    "<S> we report significant improvements attained by the proposed approach in segmentation accuracy over existing standard methods on 2d and 3d datasets . </S>"
  ]
}